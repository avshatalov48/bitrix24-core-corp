{"version":3,"file":"timeline.bundle.js","sources":["../src/editor.js","../src/tools/wait-configuration-dialog.js","../src/editors/wait.js","../src/editors/sms.js","../src/editors/rest.js","../src/editors/comment.js","../src/editors/todo.js","../src/types.js","../src/items/compatible-item.js","../src/animations/fasten.js","../src/items/history.js","../src/items/scheduled.js","../src/action.js","../src/actions/activity.js","../src/actions/email.js","../src/items/history-activity.js","../src/items/document.js","../src/animations/item.js","../src/animations/shift.js","../src/animations/item-new.js","../src/stream.js","../src/streams/entitychat.js","../src/tools/menubar.js","../src/tools/audio-playback-rate-selector.js","../src/tools/schedule-postpone-controller.js","../src/items/scheduled/activity.js","../src/items/scheduled/email.js","../src/items/scheduled/call.js","../src/items/scheduled/call-tracker.js","../src/items/scheduled/meeting.js","../src/items/scheduled/task.js","../src/items/scheduled/webform.js","../src/items/scheduled/wait.js","../src/items/scheduled/request.js","../src/items/scheduled/rest.js","../src/actions/openline.js","../src/items/scheduled/openline.js","../src/items/scheduled/zoom.js","../src/streams/schedule.js","../src/items/modification.js","../src/items/conversion.js","../src/items/email.js","../src/actions/call.js","../src/items/call.js","../src/items/meeting.js","../src/items/task.js","../src/items/webform.js","../src/items/request.js","../src/items/openline.js","../src/items/rest.js","../src/items/visit.js","../src/items/zoom.js","../src/items/order-modification.js","../src/items/external-notice-modification.js","../src/items/external-notice-status-modification.js","../src/items/creation.js","../src/items/restoration.js","../src/items/relation.js","../src/items/link.js","../src/items/unlink.js","../src/items/mark.js","../src/items/comment.js","../src/items/wait.js","../src/items/sender.js","../src/items/bizproc.js","../src/items/scoring.js","../src/animations/expand.js","../src/streams/history.js","../src/streams/fixedhistory.js","../src/pull-action-processor.js","../src/manager.js","../src/actions/schedule-postpone.js","../src/animations/comment.js","../src/index.js"],"sourcesContent":["import {Dom} from \"main.core\";\nimport Manager from \"./manager\";\n\n/** @memberof BX.Crm.Timeline */\nexport default class Editor\n{\n\tconstructor()\n\t{\n\t\tthis._id = \"\";\n\t\tthis._settings = {};\n\t\tthis._manager = null;\n\n\t\tthis._ownerTypeId = 0;\n\t\tthis._ownerId = 0;\n\n\t\tthis._container = null;\n\t\tthis._input = null;\n\t\tthis._saveButton = null;\n\t\tthis._cancelButton = null;\n\t\tthis._ghostInput = null;\n\n\t\tthis._saveButtonHandler = BX.delegate(this.onSaveButtonClick, this);\n\t\tthis._cancelButtonHandler = BX.delegate(this.onCancelButtonClick, this);\n\t\tthis._focusHandler = BX.delegate(this.onFocus, this);\n\t\tthis._blurHandler = BX.delegate(this.onBlur, this);\n\t\tthis._keyupHandler = BX.delegate(this.resizeForm, this);\n\t\tthis._delayedKeyupHandler = BX.delegate(\n\t\t\tfunction()\n\t\t\t{\n\t\t\t\tsetTimeout(this.resizeForm.bind(this), 0);\n\t\t\t},\n\t\t\tthis\n\t\t);\n\n\t\tthis._isVisible = true;\n\t\tthis._hideButtonsOnBlur = true;\n\t}\n\n\tinitialize(id, settings)\n\t{\n\t\tthis._id = BX.type.isNotEmptyString(id) ? id : BX.util.getRandomString(4);\n\t\tthis._settings = settings ? settings : {};\n\n\t\tthis._manager = this.getSetting(\"manager\");\n\t\tif(!(this._manager instanceof Manager))\n\t\t{\n\t\t\tthrow \"Editor. Manager instance is not found.\";\n\t\t}\n\n\t\tthis._ownerTypeId = this.getSetting(\"ownerTypeId\", 0);\n\t\tthis._ownerId = this.getSetting(\"ownerId\", 0);\n\n\t\tthis._container = BX(this.getSetting(\"container\"));\n\t\tthis._input = BX(this.getSetting(\"input\"));\n\t\tthis._saveButton = BX(this.getSetting(\"button\"));\n\t\tthis._cancelButton = BX(this.getSetting(\"cancelButton\"));\n\n\t\tBX.bind(this._saveButton, \"click\", this._saveButtonHandler);\n\t\tif(this._cancelButton)\n\t\t{\n\t\t\tBX.bind(this._cancelButton, \"click\", this._cancelButtonHandler);\n\t\t}\n\n\t\tthis.bindInputHandlers();\n\t\tthis.doInitialize();\n\t}\n\n\tdoInitialize()\n\t{\n\t}\n\n\tbindInputHandlers()\n\t{\n\t\tBX.bind(this._input, \"focus\", this._focusHandler);\n\t\tBX.bind(this._input, \"blur\", this._blurHandler);\n\t\tBX.bind(this._input, \"keyup\", this._keyupHandler);\n\t\tBX.bind(this._input, \"cut\", this._delayedKeyupHandler);\n\t\tBX.bind(this._input, \"paste\", this._delayedKeyupHandler);\n\t}\n\n\tgetId()\n\t{\n\t\treturn this._id;\n\t}\n\n\tgetSetting(name, defaultval)\n\t{\n\t\treturn this._settings.hasOwnProperty(name) ? this._settings[name] : defaultval;\n\t}\n\n\tsetVisible(visible)\n\t{\n\t\tvisible = !!visible;\n\t\tif(this._isVisible === visible)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis._isVisible = visible;\n\t\tif (this._container)\n\t\t{\n\t\t\tthis._container.style.display = visible ? \"\" : \"none\";\n\t\t}\n\t}\n\n\tisVisible()\n\t{\n\t\treturn this._isVisible;\n\t}\n\n\tonFocus(e)\n\t{\n\t\tBX.addClass(this._container, \"focus\");\n\t}\n\n\tonBlur(e)\n\t{\n\t\tif(!this._hideButtonsOnBlur)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif(this._input.value === \"\")\n\t\t{\n\t\t\twindow.setTimeout(\n\t\t\t\tBX.delegate(function() {\n\t\t\t\t\tBX.removeClass(this._container, \"focus\");\n\t\t\t\t\tthis._input.style.minHeight = \"\";\n\t\t\t\t}, this),\n\t\t\t\t200\n\t\t\t);\n\t\t}\n\t}\n\n\tonSaveButtonClick(e)\n\t{\n\t\tDom.addClass(this._saveButton, 'ui-btn-wait');\n\t\tconst removeButtonWaitClass = () => Dom.removeClass(this._saveButton, 'ui-btn-wait');\n\n\t\tconst saveResult = this.save();\n\t\tif (saveResult instanceof BX.Promise || saveResult instanceof Promise)\n\t\t{\n\t\t\tsaveResult.then(\n\t\t\t\t() => removeButtonWaitClass(),\n\t\t\t\t() => removeButtonWaitClass()\n\t\t\t);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tremoveButtonWaitClass();\n\t\t}\n\t}\n\n\tonCancelButtonClick()\n\t{\n\t\tthis.cancel();\n\t\tthis._manager.processEditingCancellation(this);\n\t}\n\n\tsave()\n\t{\n\t}\n\n\tcancel()\n\t{\n\t}\n\n\trelease()\n\t{\n\t\tif(this._ghostInput)\n\t\t{\n\t\t\tthis._ghostInput = BX.remove(this._ghostInput);\n\t\t}\n\t}\n\n\tensureGhostCreated()\n\t{\n\t\tif(this._ghostInput)\n\t\t{\n\t\t\treturn this._ghostInput;\n\t\t}\n\n\t\tthis._ghostInput = BX.create('div', {\n\t\t\tprops: { className: 'crm-entity-stream-content-new-comment-textarea-shadow' },\n\t\t\ttext: this._input.value\n\t\t});\n\n\t\tthis._ghostInput.style.width = this._input.offsetWidth + 'px';\n\t\tdocument.body.appendChild(this._ghostInput);\n\t\treturn this._ghostInput;\n\t}\n\n\tresizeForm()\n\t{\n\t\tconst ghost = this.ensureGhostCreated();\n\t\tconst computedStyle = getComputedStyle(this._input);\n\t\tconst diff = parseInt(computedStyle.paddingBottom) +\n\t\t\tparseInt(computedStyle.paddingTop) +\n\t\t\tparseInt(computedStyle.borderTopWidth) +\n\t\t\tparseInt(computedStyle.borderBottomWidth) || 0;\n\n\t\tghost.innerHTML = BX.util.htmlspecialchars(this._input.value.replace(/[\\r\\n]{1}/g, '<br>'));\n\t\tthis._input.style.minHeight = ghost.scrollHeight + diff + 'px'\n\t}\n}\n","import Wait from \"../editors/wait\";\n\n/** @memberof BX.Crm.Timeline.Tools */\nexport default class WaitConfigurationDialog\n{\n\tconstructor()\n\t{\n\t\tthis._id = \"\";\n\t\tthis._settings = {};\n\t\tthis._type = Wait.WaitingType.undefined;\n\t\tthis._duration = 0;\n\t\tthis._target = \"\";\n\t\tthis._targetDates = null;\n\t\tthis._container = null;\n\t\tthis._durationMeasureNode = null;\n\t\tthis._durationInput = null;\n\t\tthis._targetDateNode = null;\n\t\tthis._popup = null;\n\t}\n\n\tinitialize(id, settings)\n\t{\n\t\tthis._id = BX.type.isNotEmptyString(id) ? id : BX.util.getRandomString(4);\n\t\tthis._settings = settings ? settings : {};\n\t\tthis._type = BX.prop.getInteger(this._settings, \"type\", Wait.WaitingType.after);\n\t\tthis._duration = BX.prop.getInteger(this._settings, \"duration\", 1);\n\t\tthis._target = BX.prop.getString(this._settings, \"target\", \"\");\n\t\tthis._targetDates = BX.prop.getArray(this._settings, \"targetDates\", []);\n\n\t\tthis._menuId = this._id + \"_target_date_sel\";\n\t}\n\n\tgetId()\n\t{\n\t\treturn this._id;\n\t}\n\n\tgetType()\n\t{\n\t\treturn this._type;\n\t}\n\n\tsetType(type)\n\t{\n\t\tthis._type = type;\n\t}\n\n\tgetDuration()\n\t{\n\t\treturn this._duration;\n\t}\n\n\tsetDuration(duration)\n\t{\n\t\tthis._duration = duration;\n\t}\n\n\tgetTarget()\n\t{\n\t\treturn this._target;\n\t}\n\n\tsetTarget(target)\n\t{\n\t\tthis._target = target;\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = WaitConfigurationDialog.messages;\n\t\treturn m.hasOwnProperty(name) ? m[name] : name;\n\t}\n\n\tgetDurationText(duration, enableNumber)\n\t{\n\t\treturn Wait.Helper.getDurationText(duration, enableNumber);\n\t}\n\n\tgetTargetDateCaption(name)\n\t{\n\t\tconst length = this._targetDates.length;\n\t\tfor(let i = 0; i < length; i++)\n\t\t{\n\t\t\tconst info = this._targetDates[i];\n\t\t\tif(info[\"name\"] === name)\n\t\t\t{\n\t\t\t\treturn info[\"caption\"];\n\t\t\t}\n\t\t}\n\n\t\treturn \"\";\n\t}\n\n\topen()\n\t{\n\t\tthis._popup = new BX.PopupWindow(\n\t\t\tthis._id,\n\t\t\tnull, //this._configSelector,\n\t\t\t{\n\t\t\t\tautoHide: true,\n\t\t\t\tdraggable: false,\n\t\t\t\tbindOptions: { forceBindPosition: false },\n\t\t\t\tcloseByEsc: true,\n\t\t\t\tzIndex: 0,\n\t\t\t\tcontent: this.prepareDialogContent(),\n\t\t\t\tevents:\n\t\t\t\t\t{\n\t\t\t\t\t\tonPopupShow: BX.delegate(this.onPopupShow, this),\n\t\t\t\t\t\tonPopupClose: BX.delegate(this.onPopupClose, this),\n\t\t\t\t\t\tonPopupDestroy: BX.delegate(this.onPopupDestroy, this)\n\t\t\t\t\t},\n\t\t\t\tbuttons:\n\t\t\t\t\t[\n\t\t\t\t\t\tnew BX.PopupWindowButton(\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttext: this.getMessage(\"select\"),\n\t\t\t\t\t\t\t\tclassName: \"popup-window-button-accept\" ,\n\t\t\t\t\t\t\t\tevents: { click: BX.delegate(this.onSaveButtonClick, this) }\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t),\n\t\t\t\t\t\tnew BX.PopupWindowButtonLink(\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttext : BX.message(\"JS_CORE_WINDOW_CANCEL\"),\n\t\t\t\t\t\t\t\tevents: { click: BX.delegate(this.onCancelButtonClick, this) }\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t)\n\t\t\t\t\t]\n\t\t\t}\n\t\t);\n\t\tthis._popup.show();\n\t}\n\n\tclose()\n\t{\n\t\tif(this._popup)\n\t\t{\n\t\t\tthis._popup.close();\n\t\t}\n\t}\n\n\tprepareDialogContent()\n\t{\n\t\tconst container = BX.create(\"div\", {attrs: {className: \"crm-wait-popup-select-block\"}});\n\t\tconst wrapper = BX.create(\"div\", {attrs: {className: \"crm-wait-popup-select-wrapper\"}});\n\t\tcontainer.appendChild(wrapper);\n\n\t\tthis._durationInput = BX.create(\n\t\t\t\"input\",\n\t\t\t{\n\t\t\t\tattrs: { type: \"text\", className: \"crm-wait-popup-settings-input\", value: this._duration },\n\t\t\t\tevents: { keyup: BX.delegate(this.onDurationChange, this) }\n\t\t\t}\n\t\t);\n\n\t\tthis._durationMeasureNode = BX.create(\n\t\t\t\"span\",\n\t\t\t{ attrs: { className: \"crm-wait-popup-settings-title\" }, text: this.getDurationText(this._duration, false) }\n\t\t);\n\n\t\tif(this._type === Wait.WaitingType.after)\n\t\t{\n\t\t\twrapper.appendChild(\n\t\t\t\tBX.create(\"span\", { attrs: { className: \"crm-wait-popup-settings-title\" }, text: this.getMessage(\"prefixTypeAfter\") })\n\t\t\t);\n\t\t\twrapper.appendChild(this._durationInput);\n\t\t\twrapper.appendChild(this._durationMeasureNode);\n\t\t}\n\t\telse\n\t\t{\n\t\t\twrapper.appendChild(\n\t\t\t\tBX.create(\"span\", { attrs: { className: \"crm-wait-popup-settings-title\" }, text: this.getMessage(\"prefixTypeBefore\") })\n\t\t\t);\n\t\t\twrapper.appendChild(this._durationInput);\n\t\t\twrapper.appendChild(this._durationMeasureNode);\n\t\t\twrapper.appendChild(\n\t\t\t\tBX.create(\"span\", { attrs: { className: \"crm-wait-popup-settings-title\" }, text: \" \" + this.getMessage(\"targetPrefixTypeBefore\") })\n\t\t\t);\n\n\t\t\tthis._targetDateNode = BX.create(\n\t\t\t\t\"span\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-automation-popup-settings-link\" },\n\t\t\t\t\ttext: this.getTargetDateCaption(this._target),\n\t\t\t\t\tevents: { click: BX.delegate(this.toggleTargetMenu, this) }\n\t\t\t\t}\n\t\t\t);\n\t\t\twrapper.appendChild(this._targetDateNode);\n\t\t}\n\t\treturn container;\n\t}\n\n\tonDurationChange()\n\t{\n\t\tlet duration = parseInt(this._durationInput.value);\n\t\tif(isNaN(duration) || duration <= 0)\n\t\t{\n\t\t\tduration = 1;\n\t\t}\n\t\tthis._duration = duration;\n\t\tthis._durationMeasureNode.innerHTML = BX.util.htmlspecialchars(this.getDurationText(duration, false));\n\n\t}\n\n\ttoggleTargetMenu()\n\t{\n\t\tif(this.isTargetMenuOpened())\n\t\t{\n\t\t\tthis.closeTargetMenu();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.openTargetMenu();\n\t\t}\n\t}\n\n\tisTargetMenuOpened()\n\t{\n\t\treturn !!BX.PopupMenu.getMenuById(this._menuId);\n\t}\n\n\topenTargetMenu()\n\t{\n\t\tconst menuItems = [];\n\t\tlet i = 0;\n\t\tconst length = this._targetDates.length;\n\t\tfor(; i < length; i++)\n\t\t{\n\t\t\tconst info = this._targetDates[i];\n\n\t\t\tmenuItems.push(\n\t\t\t\t{\n\t\t\t\t\ttext: info[\"caption\"],\n\t\t\t\t\ttitle: info[\"caption\"],\n\t\t\t\t\tvalue: info[\"name\"],\n\t\t\t\t\tonclick: BX.delegate(this.onTargetSelect, this)\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\tBX.PopupMenu.show(\n\t\t\tthis._menuId,\n\t\t\tthis._targetDateNode,\n\t\t\tmenuItems,\n\t\t\t{\n\t\t\t\tzIndex: 200,\n\t\t\t\tautoHide: true,\n\t\t\t\toffsetLeft: BX.pos(this._targetDateNode)[\"width\"] / 2,\n\t\t\t\tangle: { position: 'top', offset: 0 }\n\t\t\t}\n\t\t);\n\t}\n\n\tcloseTargetMenu()\n\t{\n\t\tBX.PopupMenu.destroy(this._menuId);\n\t}\n\n\tonPopupShow(e, item)\n\t{\n\t}\n\n\tonPopupClose()\n\t{\n\t\tif(this._popup)\n\t\t{\n\t\t\tthis._popup.destroy();\n\t\t}\n\n\t\tthis.closeTargetMenu();\n\t}\n\n\tonPopupDestroy()\n\t{\n\t\tif(this._popup)\n\t\t{\n\t\t\tthis._popup = null;\n\t\t}\n\t}\n\n\tonSaveButtonClick(e)\n\t{\n\t\tconst callback = BX.prop.getFunction(this._settings, \"onSave\", null);\n\t\tif(!callback)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst params = {type: this._type};\n\t\tparams[\"duration\"] = this._duration;\n\t\tparams[\"target\"] = this._type === Wait.WaitingType.before ? this._target : \"\";\n\t\tcallback(this, params);\n\t}\n\n\tonCancelButtonClick(e)\n\t{\n\t\tconst callback = BX.prop.getFunction(this._settings, \"onCancel\", null);\n\t\tif(callback)\n\t\t{\n\t\t\tcallback(this);\n\t\t}\n\t}\n\n\tonTargetSelect(e, item)\n\t{\n\t\tconst fieldName = BX.prop.getString(item, \"value\", \"\");\n\t\tif(fieldName !== \"\")\n\t\t{\n\t\t\tthis._target = fieldName;\n\t\t\tthis._targetDateNode.innerHTML = BX.util.htmlspecialchars(this.getTargetDateCaption(fieldName));\n\t\t}\n\n\t\tthis.closeTargetMenu();\n\t\te.preventDefault ? e.preventDefault() : (e.returnValue = false);\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new WaitConfigurationDialog();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n\n\tstatic messages = {};\n}\n","import Editor from \"../editor.js\";\nimport WaitConfigurationDialog from \"../tools/wait-configuration-dialog\";\n\n/** @memberof BX.Crm.Timeline.Editors */\nexport default class Wait extends Editor\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._serviceUrl = \"\";\n\t\tthis._isRequestRunning = false;\n\t\tthis._isLocked = false;\n\n\t\tthis._hideButtonsOnBlur = false;\n\t\t//region Config\n\t\tthis._type = Wait.WaitingType.after;\n\t\tthis._duration = 1;\n\t\tthis._target = \"\";\n\t\tthis._configContainer = null;\n\t\tthis._configSelector = null;\n\t\t//endregion\n\n\t\tthis._isMenuShown = false;\n\t\tthis._menu = null;\n\t\tthis._configDialog = null;\n\t}\n\n\tdoInitialize()\n\t{\n\t\tthis._configContainer = BX(this.getSetting(\"configContainer\"));\n\t\tthis._serviceUrl = this.getSetting(\"serviceUrl\", \"\");\n\n\t\tconst config = BX.prop.getObject(this._settings, \"config\", {});\n\t\tthis._type = Wait.WaitingType.resolveTypeId(\n\t\t\tBX.prop.getString(\n\t\t\t\tconfig,\n\t\t\t\t\"type\",\n\t\t\t\tWait.WaitingType.names.after\n\t\t\t)\n\t\t);\n\t\tthis._duration = BX.prop.getInteger(config, \"duration\", 1);\n\t\tthis._target = BX.prop.getString(config, \"target\", \"\");\n\t\tthis._targetDates = BX.prop.getArray(this._settings, \"targetDates\", []);\n\t\tthis.layoutConfigurationSummary();\n\t}\n\n\tgetDurationText(duration, enableNumber)\n\t{\n\t\treturn Wait.Helper.getDurationText(duration, enableNumber);\n\t}\n\n\tgetTargetDateCaption(name)\n\t{\n\t\tlet i = 0;\n\t\tconst length = this._targetDates.length;\n\t\tfor(; i < length; i++)\n\t\t{\n\t\t\tconst info = this._targetDates[i];\n\t\t\tif(info[\"name\"] === name)\n\t\t\t{\n\t\t\t\treturn info[\"caption\"];\n\t\t\t}\n\t\t}\n\n\t\treturn \"\";\n\t}\n\n\tonSelectorClick(e)\n\t{\n\t\tif(!this._isMenuShown)\n\t\t{\n\t\t\tthis.openMenu();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.closeMenu();\n\t\t}\n\t\te.preventDefault ? e.preventDefault() : (e.returnValue = false);\n\t}\n\n\topenMenu()\n\t{\n\t\tif(this._isMenuShown)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst handler = BX.delegate(this.onMenuItemClick, this);\n\n\t\tconst menuItems =\n\t\t\t[\n\t\t\t\t{id: \"day_1\", text: this.getMessage(\"oneDay\"), onclick: handler},\n\t\t\t\t{id: \"day_2\", text: this.getMessage(\"twoDays\"), onclick: handler},\n\t\t\t\t{id: \"day_3\", text: this.getMessage(\"threeDays\"), onclick: handler},\n\t\t\t\t{id: \"week_1\", text: this.getMessage(\"oneWeek\"), onclick: handler},\n\t\t\t\t{id: \"week_2\", text: this.getMessage(\"twoWeek\"), onclick: handler},\n\t\t\t\t{id: \"week_3\", text: this.getMessage(\"threeWeeks\"), onclick: handler}\n\t\t\t];\n\n\t\tconst customMenu = {id: \"custom\", text: this.getMessage(\"custom\"), items: []};\n\t\tcustomMenu[\"items\"].push({ id: \"afterDays\", text: this.getMessage(\"afterDays\"), onclick: handler });\n\t\tif(this._targetDates.length > 0)\n\t\t{\n\t\t\tcustomMenu[\"items\"].push({ id: \"beforeDate\", text: this.getMessage(\"beforeDate\"), onclick: handler });\n\t\t}\n\t\tmenuItems.push(customMenu);\n\n\t\tBX.PopupMenu.show(\n\t\t\tthis._id,\n\t\t\tthis._configSelector,\n\t\t\tmenuItems,\n\t\t\t{\n\t\t\t\toffsetTop: 0,\n\t\t\t\toffsetLeft: 36,\n\t\t\t\tangle: { position: \"top\", offset: 0 },\n\t\t\t\tevents:\n\t\t\t\t\t{\n\t\t\t\t\t\tonPopupShow: BX.delegate(this.onMenuShow, this),\n\t\t\t\t\t\tonPopupClose: BX.delegate(this.onMenuClose, this),\n\t\t\t\t\t\tonPopupDestroy: BX.delegate(this.onMenuDestroy, this)\n\t\t\t\t\t}\n\t\t\t}\n\t\t);\n\n\t\tthis._menu = BX.PopupMenu.currentItem;\n\t}\n\n\tcloseMenu()\n\t{\n\t\tif(!this._isMenuShown)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif(this._menu)\n\t\t{\n\t\t\tthis._menu.close();\n\t\t}\n\t}\n\n\tonMenuItemClick(e, item)\n\t{\n\t\tthis.closeMenu();\n\n\t\tif(item.id === \"afterDays\" || item.id === \"beforeDate\")\n\t\t{\n\t\t\tthis.openConfigDialog(\n\t\t\t\titem.id === \"afterDays\" ? Wait.WaitingType.after : Wait.WaitingType.before\n\t\t\t);\n\t\t\treturn;\n\t\t}\n\n\t\tconst params = {type: Wait.WaitingType.after};\n\t\tif(item.id === \"day_1\")\n\t\t{\n\t\t\tparams[\"duration\"] = 1;\n\t\t}\n\t\telse if(item.id === \"day_2\")\n\t\t{\n\t\t\tparams[\"duration\"] = 2;\n\t\t}\n\t\telse if(item.id === \"day_3\")\n\t\t{\n\t\t\tparams[\"duration\"] = 3;\n\t\t}\n\t\tif(item.id === \"week_1\")\n\t\t{\n\t\t\tparams[\"duration\"] = 7;\n\t\t}\n\t\telse if(item.id === \"week_2\")\n\t\t{\n\t\t\tparams[\"duration\"] = 14;\n\t\t}\n\t\telse if(item.id === \"week_3\")\n\t\t{\n\t\t\tparams[\"duration\"] = 21;\n\t\t}\n\t\tthis.saveConfiguration(params);\n\t}\n\n\topenConfigDialog(type)\n\t{\n\t\tif(!this._configDialog)\n\t\t{\n\t\t\tthis._configDialog = WaitConfigurationDialog.create(\n\t\t\t\t\"\",\n\t\t\t\t{\n\t\t\t\t\ttargetDates: this._targetDates,\n\t\t\t\t\tonSave: BX.delegate(this.onConfigDialogSave, this),\n\t\t\t\t\tonCancel: BX.delegate(this.onConfigDialogCancel, this)\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\tthis._configDialog.setType(type);\n\t\tthis._configDialog.setDuration(this._duration);\n\n\t\tlet target = this._target;\n\t\tif(target === \"\" && this._targetDates.length > 0)\n\t\t{\n\t\t\ttarget = this._targetDates[0][\"name\"];\n\t\t}\n\t\tthis._configDialog.setTarget(target);\n\t\tthis._configDialog.open();\n\t}\n\n\tonConfigDialogSave(sender, params)\n\t{\n\t\tthis.saveConfiguration(params);\n\t\tthis._configDialog.close();\n\t}\n\n\tonConfigDialogCancel(sender)\n\t{\n\t\tthis._configDialog.close();\n\t}\n\n\tonMenuShow()\n\t{\n\t\tthis._isMenuShown = true;\n\t}\n\n\tonMenuClose()\n\t{\n\t\tif(this._menu && this._menu.popupWindow)\n\t\t{\n\t\t\tthis._menu.popupWindow.destroy();\n\t\t}\n\t}\n\n\tonMenuDestroy()\n\t{\n\t\tthis._isMenuShown = false;\n\t\tthis._menu = null;\n\n\t\tif(typeof(BX.PopupMenu.Data[this._id]) !== \"undefined\")\n\t\t{\n\t\t\tdelete(BX.PopupMenu.Data[this._id]);\n\t\t}\n\t}\n\n\tsaveConfiguration(params)\n\t{\n\t\t//region Parse params\n\t\tthis._type = BX.prop.getInteger(params, \"type\", Wait.WaitingType.after);\n\t\tthis._duration = BX.prop.getInteger(params, \"duration\", 0);\n\t\tif(this._duration <= 0)\n\t\t{\n\t\t\tthis._duration = 1;\n\t\t}\n\t\tthis._target = this._type === Wait.WaitingType.before\n\t\t\t? BX.prop.getString(params, \"target\", \"\") : \"\";\n\t\t//endregion\n\t\t//region Save settings\n\t\tconst optionName = this._manager.getId().toLowerCase();\n\t\tBX.userOptions.save(\n\t\t\t\"crm.timeline.wait\",\n\t\t\toptionName,\n\t\t\t\"type\",\n\t\t\tthis._type === Wait.WaitingType.after ? \"after\" : \"before\"\n\t\t);\n\n\t\tBX.userOptions.save(\n\t\t\t\"crm.timeline.wait\",\n\t\t\toptionName,\n\t\t\t\"duration\",\n\t\t\tthis._duration\n\t\t);\n\n\t\tBX.userOptions.save(\n\t\t\t\"crm.timeline.wait\",\n\t\t\toptionName,\n\t\t\t\"target\",\n\t\t\tthis._target\n\t\t);\n\t\t//endregion\n\t\tthis.layoutConfigurationSummary();\n\t}\n\n\tgetSummaryHtml()\n\t{\n\t\tif(this._type === Wait.WaitingType.before)\n\t\t{\n\t\t\treturn (\n\t\t\t\tthis.getMessage(\"completionTypeBefore\")\n\t\t\t\t\t.replace(\"#DURATION#\", this.getDurationText(this._duration, true))\n\t\t\t\t\t.replace(\"#TARGET_DATE#\", this.getTargetDateCaption(this._target))\n\t\t\t);\n\t\t}\n\n\t\treturn (\n\t\t\tthis.getMessage(\"completionTypeAfter\")\n\t\t\t\t.replace(\"#DURATION#\", this.getDurationText(this._duration, true))\n\t\t);\n\t}\n\n\tgetSummaryText()\n\t{\n\t\treturn BX.util.strip_tags(this.getSummaryHtml());\n\t}\n\n\tlayoutConfigurationSummary()\n\t{\n\t\tthis._configContainer.innerHTML = this.getSummaryHtml();\n\t\tthis._configSelector = this._configContainer.querySelector(\"a\");\n\t\tif(this._configSelector)\n\t\t{\n\t\t\tBX.bind(this._configSelector, \"click\", BX.delegate(this.onSelectorClick, this));\n\t\t}\n\t}\n\n\tpostpone(id, offset, callback)\n\t{\n\t\tBX.ajax(\n\t\t\t{\n\t\t\t\turl: this._serviceUrl,\n\t\t\t\tmethod: \"POST\",\n\t\t\t\tdataType: \"json\",\n\t\t\t\tdata:\n\t\t\t\t\t{\n\t\t\t\t\t\t\"ACTION\": \"POSTPONE_WAIT\",\n\t\t\t\t\t\t\"DATA\": { \"ID\": id, \"OFFSET\": offset }\n\t\t\t\t\t},\n\t\t\t\tonsuccess: callback\n\t\t\t}\n\t\t);\n\t}\n\n\tcomplete(id, completed, callback)\n\t{\n\t\tBX.ajax(\n\t\t\t{\n\t\t\t\turl: this._serviceUrl,\n\t\t\t\tmethod: \"POST\",\n\t\t\t\tdataType: \"json\",\n\t\t\t\tdata:\n\t\t\t\t\t{\n\t\t\t\t\t\t\"ACTION\": \"COMPLETE_WAIT\",\n\t\t\t\t\t\t\"DATA\": { \"ID\": id, \"COMPLETED\": completed ? 'Y' : 'N' }\n\t\t\t\t\t},\n\t\t\t\tonsuccess: callback\n\t\t\t}\n\t\t);\n\t}\n\n\tsave()\n\t{\n\t\tif(this._isRequestRunning || this._isLocked)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet description = this.getSummaryText();\n\t\tconst comment = BX.util.trim(this._input.value);\n\t\tif(comment !== \"\")\n\t\t{\n\t\t\tdescription += \"\\n\" + comment;\n\t\t}\n\n\t\tconst data =\n\t\t\t{\n\t\t\t\tID: 0,\n\t\t\t\ttypeId: this._type,\n\t\t\t\tduration: this._duration,\n\t\t\t\ttargetFieldName: this._target,\n\t\t\t\tsubject: \"\",\n\t\t\t\tdescription: description,\n\t\t\t\tcompleted: 0,\n\t\t\t\townerType: BX.CrmEntityType.resolveName(this._ownerTypeId),\n\t\t\t\townerID: this._ownerId\n\t\t\t};\n\n\t\tBX.ajax(\n\t\t\t{\n\t\t\t\turl: this._serviceUrl,\n\t\t\t\tmethod: \"POST\",\n\t\t\t\tdataType: \"json\",\n\t\t\t\tdata:\n\t\t\t\t\t{\n\t\t\t\t\t\t\"ACTION\": \"SAVE_WAIT\",\n\t\t\t\t\t\t\"DATA\": data\n\t\t\t\t\t},\n\t\t\t\tonsuccess: BX.delegate(this.onSaveSuccess, this),\n\t\t\t\tonfailure: BX.delegate(this.onSaveFailure, this)\n\t\t\t}\n\t\t);\n\t\tthis._isRequestRunning = this._isLocked = true;\n\t}\n\n\tcancel()\n\t{\n\t\tthis._input.value = \"\";\n\t\tthis._input.style.minHeight = \"\";\n\t\tthis.release();\n\t}\n\n\tonSaveSuccess(data)\n\t{\n\t\tthis._isRequestRunning = this._isLocked = false;\n\n\t\tconst error = BX.prop.getString(data, \"ERROR\", \"\");\n\t\tif(error !== \"\")\n\t\t{\n\t\t\talert(error);\n\t\t\treturn;\n\t\t}\n\n\t\tthis._input.value = \"\";\n\t\tthis._input.style.minHeight = \"\";\n\t\tthis._manager.processEditingCompletion(this);\n\t\tthis.release();\n\t}\n\n\tonSaveFailure()\n\t{\n\t\tthis._isRequestRunning = this._isLocked = false;\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = Wait.messages;\n\t\treturn m.hasOwnProperty(name) ? m[name] : name;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Wait();\n\t\tself.initialize(id, settings);\n\t\tthis.items[self.getId()] = self;\n\t\treturn self;\n\t}\n\n\tstatic WaitingType = {\n\t\tundefined: 0,\n\t\tafter: 1,\n\t\tbefore: 2,\n\n\t\tnames:\n\t\t\t{\n\t\t\t\tafter: \"after\",\n\t\t\t\tbefore: \"before\"\n\t\t\t},\n\t\tresolveTypeId: function(name)\n\t\t{\n\t\t\tif(name === this.names.after)\n\t\t\t{\n\t\t\t\treturn this.after;\n\t\t\t}\n\t\t\telse if(name === this.names.before)\n\t\t\t{\n\t\t\t\treturn this.before;\n\t\t\t}\n\n\t\t\treturn this.undefined;\n\t\t}\n\t};\n\n\tstatic messages = {};\n\tstatic items = {};\n\n\tstatic Helper =\n\t{\n\t\tgetDurationText: function(duration, enableNumber)\n\t\t{\n\t\t\tenableNumber = !!enableNumber;\n\n\t\t\tlet result = \"\";\n\t\t\tlet type = \"D\";\n\t\t\tif(enableNumber)\n\t\t\t{\n\t\t\t\tif((duration % 7) === 0)\n\t\t\t\t{\n\t\t\t\t\tduration = duration / 7;\n\t\t\t\t\ttype = \"W\";\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (type === \"W\")\n\t\t\t{\n\t\t\t\tresult = BX.Loc.getMessagePlural('CRM_TIMELINE_WAIT_WEEK', duration);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresult = BX.Loc.getMessagePlural('CRM_TIMELINE_WAIT_DAY', duration);\n\t\t\t}\n\n\t\t\tif(enableNumber)\n\t\t\t{\n\t\t\t\tresult = duration.toString() + \" \" + result;\n\t\t\t}\n\t\t\treturn result;\n\t\t},\n\t\tgetMessage: function(name)\n\t\t{\n\t\t\treturn Wait.Helper.messages.hasOwnProperty(name) ? Wait.Helper.messages[name] : name;\n\t\t},\n\t\tmessages: {},\n\t}\n}\n","import Editor from \"../editor\";\n\n/** @memberof BX.Crm.Timeline.Editors */\nexport default class Sms extends Editor\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._history = null;\n\t\tthis._serviceUrl = \"\";\n\n\t\tthis._isRequestRunning = false;\n\t\tthis._isLocked = false;\n\n\t\tthis._senderId = null;\n\t\tthis._from = null;\n\t\tthis._commEntityTypeId = null;\n\t\tthis._commEntityId = null;\n\t\tthis._to = null;\n\n\t\tthis._canUse = null;\n\t\tthis._canSendMessage = null;\n\t\tthis._manageUrl = '';\n\t\tthis._senders = [];\n\t\tthis._fromList = [];\n\t\tthis._toList = [];\n\t\tthis._defaults = {};\n\t\tthis._communications = [];\n\n\t\tthis._menu = null;\n\t\tthis._isMenuShown = false;\n\t\tthis._shownMenuId = null;\n\t\tthis._documentSelector = null;\n\t\tthis._source = null;\n\n\t\tthis._paymentId = null;\n\t\tthis._shipmentId = null;\n\n\t\tthis._compilationProductIds = [];\n\n\t\tthis._templateId = null;\n\t\tthis._templatesContainer = null;\n\t\tthis._templateFieldHintNode = null;\n\t\tthis._templateSelectorNode = null;\n\t\tthis._templateTemplateTitleNode = null;\n\t\tthis._templatePreviewNode = null;\n\t\tthis._templateSelectorMenuId = 'CrmTimelineSmsEditorTemplateSelector';\n\t\tthis._templateFieldHintHandler = BX.delegate(this.onTemplateHintIconClick, this);\n\t\tthis._templateSeletorClickHandler = BX.delegate(this.onTemplateSelectClick, this);\n\t\tthis._selectTemplateHandler = BX.delegate(this.onSelectTemplate, this);\n\t}\n\n\tdoInitialize()\n\t{\n\t\tthis._serviceUrl = BX.util.remove_url_param(\n\t\t\tthis.getSetting(\"serviceUrl\", \"\"),\n\t\t\t['sessid', 'site']\n\t\t);\n\n\t\tconst config = BX.prop.getObject(this._settings, \"config\", {});\n\n\t\tthis._canUse = BX.prop.getBoolean(config, \"canUse\", false);\n\t\tthis._canSendMessage = BX.prop.getBoolean(config, \"canSendMessage\", false);\n\t\tthis._manageUrl = BX.prop.getString(config, \"manageUrl\", '');\n\t\tthis._senders = BX.prop.getArray(config, \"senders\", []);\n\t\tthis._defaults = BX.prop.getObject(config, \"defaults\", {senderId:null,from:null});\n\t\tthis._communications = BX.prop.getArray(config, \"communications\", []);\n\t\tthis._isSalescenterEnabled = BX.prop.getBoolean(config, \"isSalescenterEnabled\", false);\n\t\tthis._isDocumentsEnabled = BX.prop.getBoolean(config, \"isDocumentsEnabled\", false);\n\t\tif(this._isDocumentsEnabled)\n\t\t{\n\t\t\tthis._documentsProvider = BX.prop.getString(config, \"documentsProvider\", '');\n\t\t\tthis._documentsValue = BX.prop.getString(config, \"documentsValue\", '');\n\t\t}\n\t\tthis._isFilesEnabled = BX.prop.getBoolean(config, \"isFilesEnabled\", false);\n\t\tif(this._isFilesEnabled)\n\t\t{\n\t\t\tthis._diskUrls = BX.prop.getObject(config, \"diskUrls\");\n\t\t\tthis._isFilesExternalLinkEnabled = BX.prop.getBoolean(config, \"isFilesExternalLinkEnabled\", true);\n\t\t}\n\n\t\tthis._senderSelectorNode = this._container.querySelector('[data-role=\"sender-selector\"]');\n\t\tthis._fromContainerNode = this._container.querySelector('[data-role=\"from-container\"]');\n\t\tthis._fromSelectorNode = this._container.querySelector('[data-role=\"from-selector\"]');\n\t\tthis._clientContainerNode = this._container.querySelector('[data-role=\"client-container\"]');\n\t\tthis._clientSelectorNode = this._container.querySelector('[data-role=\"client-selector\"]');\n\t\tthis._toSelectorNode = this._container.querySelector('[data-role=\"to-selector\"]');\n\t\tthis._messageLengthCounterWrapperNode = this._container.querySelector('[data-role=\"message-length-counter-wrap\"]');\n\t\tthis._messageLengthCounterNode = this._container.querySelector('[data-role=\"message-length-counter\"]');\n\t\tthis._salescenterStarter = this._container.querySelector('[data-role=\"salescenter-starter\"]');\n\t\tthis._smsDetailSwitcher = this._container.querySelector('[data-role=\"sms-detail-switcher\"]');\n\t\tthis._smsDetail = this._container.querySelector('[data-role=\"sms-detail\"]');\n\t\tthis._documentSelectorButton = this._container.querySelector('[data-role=\"sms-document-selector\"]');\n\t\tthis._fileSelectorButton = this._container.querySelector('[data-role=\"sms-file-selector\"]');\n\t\tthis._fileUploadZone = this._container.querySelector('[data-role=\"sms-file-upload-zone\"]');\n\t\tthis._fileUploadLabel = this._container.querySelector('[data-role=\"sms-file-upload-label\"]');\n\t\tthis._fileSelectorBitrix = this._container.querySelector('[data-role=\"sms-file-selector-bitrix\"]');\n\t\tthis._fileExternalLinkDisabledContent = this._container.querySelector('[data-role=\"sms-file-external-link-disabled\"]');\n\n\t\tthis._templatesContainer = BX(this.getSetting(\"templatesContainer\"));\n\t\tif (this._templatesContainer)\n\t\t{\n\t\t\tthis._templateFieldHintNode = this._templatesContainer.querySelector('[data-role=\"hint\"]');\n\t\t\tthis._templateSelectorNode = this._templatesContainer.querySelector('[data-role=\"template-selector\"]');\n\t\t\tthis._templateTemplateTitleNode = this._templatesContainer.querySelector('[data-role=\"template-title\"]');\n\t\t\tthis._templatePreviewNode = this._templatesContainer.querySelector('[data-role=\"preview\"]');\n\t\t}\n\t\tif (this._templateFieldHintNode)\n\t\t{\n\t\t\tBX.bind(this._templateFieldHintNode, \"click\", this._templateFieldHintHandler);\n\t\t}\n\t\tif (this._templateSelectorNode)\n\t\t{\n\t\t\tBX.bind(this._templateSelectorNode, \"click\", this._templateSeletorClickHandler);\n\t\t}\n\n\t\tif (this._canUse && this._senders.length > 0)\n\t\t{\n\t\t\tthis.initSenderSelector();\n\t\t}\n\t\tif (this._canUse && this._canSendMessage)\n\t\t{\n\t\t\tthis.initDetailSwitcher();\n\t\t\tthis.initFromSelector();\n\t\t\tthis.initClientContainer();\n\t\t\tthis.initClientSelector();\n\t\t\tthis.initToSelector();\n\t\t\tthis.initMessageLengthCounter();\n\t\t\tthis.setMessageLengthCounter();\n\t\t\tif(this._isDocumentsEnabled)\n\t\t\t{\n\t\t\t\tthis.initDocumentSelector();\n\t\t\t}\n\t\t\tif(this._isFilesEnabled)\n\t\t\t{\n\t\t\t\tthis.initFileSelector();\n\t\t\t}\n\t\t}\n\n\t\tif(this._isSalescenterEnabled)\n\t\t{\n\t\t\tthis.initSalescenterApplication();\n\t\t}\n\t}\n\n\tinitDetailSwitcher()\n\t{\n\t\tBX.bind(this._smsDetailSwitcher, 'click', function()\n\t\t{\n\t\t\tif(this._smsDetail.classList.contains('hidden'))\n\t\t\t{\n\t\t\t\tthis._smsDetail.classList.remove('hidden');\n\t\t\t\tthis._smsDetailSwitcher.innerText = BX.message('CRM_TIMELINE_COLLAPSE');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis._smsDetail.classList.add('hidden');\n\t\t\t\tthis._smsDetailSwitcher.innerText = BX.message('CRM_TIMELINE_DETAILS');\n\t\t\t}\n\t\t}.bind(this));\n\t}\n\n\tinitSenderSelector()\n\t{\n\t\tconst defaultSenderId = this._defaults.senderId;\n\t\tlet defaultSender = this._senders[0].canUse ? this._senders[0] : null;\n\t\tlet restSender = null;\n\t\tconst menuItems = [];\n\t\tconst handler = this.onSenderSelectorClick.bind(this);\n\n\t\tfor (let i = 0; i < this._senders.length; ++i)\n\t\t{\n\t\t\tif (this._senders[i].canUse && this._senders[i].fromList.length && (this._senders[i].id === defaultSenderId || !defaultSender))\n\t\t\t{\n\t\t\t\tdefaultSender = this._senders[i];\n\t\t\t}\n\n\t\t\tif (this._senders[i].id === 'rest')\n\t\t\t{\n\t\t\t\trestSender = this._senders[i];\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tmenuItems.push({\n\t\t\t\ttext: this._senders[i].name,\n\t\t\t\tsender: this._senders[i],\n\t\t\t\tonclick: handler,\n\t\t\t\tclassName: (!this._senders[i].canUse || !this._senders[i].fromList.length)\n\t\t\t\t\t? 'crm-timeline-popup-menu-item-disabled menu-popup-no-icon' : ''\n\t\t\t});\n\t\t}\n\n\t\tif (restSender)\n\t\t{\n\t\t\tif (restSender.fromList.length > 0)\n\t\t\t{\n\t\t\t\tmenuItems.push({delimiter: true});\n\t\t\t\tfor (let i = 0; i < restSender.fromList.length; ++i)\n\t\t\t\t{\n\t\t\t\t\tmenuItems.push({\n\t\t\t\t\t\ttext: restSender.fromList[i].name,\n\t\t\t\t\t\tsender: restSender,\n\t\t\t\t\t\tfrom: restSender.fromList[i],\n\t\t\t\t\t\tonclick: handler\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t\tmenuItems.push({delimiter: true}, {\n\t\t\t\ttext: BX.message('CRM_TIMELINE_SMS_REST_MARKETPLACE'),\n\t\t\t\thref: '/marketplace/category/crm_robot_sms/',\n\t\t\t\ttarget: '_blank'\n\t\t\t});\n\t\t}\n\n\t\tif (defaultSender)\n\t\t{\n\t\t\tthis.setSender(defaultSender);\n\t\t}\n\n\t\tBX.bind(this._senderSelectorNode, 'click', this.openMenu.bind(this, 'sender', this._senderSelectorNode, menuItems));\n\t}\n\n\tonSenderSelectorClick(e, item)\n\t{\n\t\tif (item.sender)\n\t\t{\n\t\t\tif (!item.sender.canUse || !item.sender.fromList.length)\n\t\t\t{\n\t\t\t\tconst url = BX.Uri.addParam(item.sender.manageUrl, {'IFRAME': 'Y'});\n\t\t\t\tconst slider = BX.SidePanel.Instance.getTopSlider();\n\t\t\t\tconst options = {\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tonClose: function () {\n\t\t\t\t\t\t\tif (slider)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tslider.reload();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonCloseComplete: function () {\n\t\t\t\t\t\t\tif (!slider)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tdocument.location.reload();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\tif (item.sender.id === 'ednaru')\n\t\t\t\t{\n\t\t\t\t\toptions.width = 700;\n\t\t\t\t}\n\t\t\t\tBX.SidePanel.Instance.open(url, options);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.setSender(item.sender, true);\n\t\t\tconst from = item.from ? item.from : item.sender.fromList[0];\n\t\t\tthis.setFrom(from, true);\n\t\t}\n\t\tthis._menu.close();\n\t}\n\n\tsetSender(sender, setAsDefault)\n\t{\n\t\tthis._senderId = sender.id;\n\t\tthis._fromList = sender.fromList;\n\t\tthis._senderSelectorNode.textContent = sender.shortName ? sender.shortName : sender.name;\n\n\t\tthis._templateId = null;\n\t\tif (sender.isTemplatesBased)\n\t\t{\n\t\t\tthis.showNode(this._templatesContainer);\n\t\t\tthis.hideNode(this._messageLengthCounterWrapperNode);\n\t\t\tthis.hideNode(this._fileSelectorButton);\n\t\t\tthis.hideNode(this._documentSelectorButton);\n\t\t\tthis.hideNode(this._input);\n\t\t\tthis.toggleTemplateSelectAvailability();\n\t\t\tthis.toggleSaveButton();\n\t\t\tthis._hideButtonsOnBlur = false;\n\t\t\tthis.onFocus();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.hideNode(this._templatesContainer);\n\t\t\tthis.showNode(this._messageLengthCounterWrapperNode);\n\t\t\tthis.showNode(this._fileSelectorButton);\n\t\t\tthis.showNode(this._documentSelectorButton);\n\t\t\tthis.showNode(this._input);\n\t\t\tthis.setMessageLengthCounter();\n\t\t\tthis._hideButtonsOnBlur = true;\n\t\t}\n\n\t\tconst visualFn = sender.id === 'rest' ? 'hide' : 'show';\n\t\tBX[visualFn](this._fromContainerNode);\n\n\t\tif (setAsDefault)\n\t\t{\n\t\t\tBX.userOptions.save(\"crm\", \"sms_manager_editor\", \"senderId\", this._senderId);\n\t\t}\n\t}\n\n\tshowNode(node)\n\t{\n\t\tif (node)\n\t\t{\n\t\t\tnode.style.display = \"\";\n\t\t}\n\t}\n\n\thideNode(node)\n\t{\n\t\tif (node)\n\t\t{\n\t\t\tnode.style.display = \"none\";\n\t\t}\n\t}\n\n\tinitFromSelector()\n\t{\n\t\tif (this._fromList.length > 0)\n\t\t{\n\t\t\tconst defaultFromId = this._defaults.from || this._fromList[0].id;\n\t\t\tlet defaultFrom = null;\n\t\t\tfor (let i = 0; i < this._fromList.length; ++i)\n\t\t\t{\n\t\t\t\tif (this._fromList[i].id === defaultFromId || !defaultFrom)\n\t\t\t\t{\n\t\t\t\t\tdefaultFrom = this._fromList[i];\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (defaultFrom)\n\t\t\t{\n\t\t\t\tthis.setFrom(defaultFrom);\n\t\t\t}\n\t\t}\n\n\t\tBX.bind(this._fromSelectorNode, 'click', this.onFromSelectorClick.bind(this));\n\t}\n\n\tonFromSelectorClick(e)\n\t{\n\t\tconst menuItems = [];\n\t\tconst handler = this.onFromSelectorItemClick.bind(this);\n\n\t\tfor (let i = 0; i < this._fromList.length; ++i)\n\t\t{\n\t\t\tmenuItems.push({\n\t\t\t\ttext: this._fromList[i].name,\n\t\t\t\tfrom: this._fromList[i],\n\t\t\t\tonclick: handler\n\t\t\t});\n\t\t}\n\n\t\tthis.openMenu('from_'+this._senderId, this._fromSelectorNode, menuItems, e);\n\t}\n\n\tonFromSelectorItemClick(e, item)\n\t{\n\t\tif (item.from)\n\t\t{\n\t\t\tthis.setFrom(item.from, true);\n\t\t}\n\t\tthis._menu.close();\n\t}\n\n\tsetFrom(from, setAsDefault)\n\t{\n\t\tthis._from = from.id;\n\n\t\tif (this._senderId === 'rest')\n\t\t{\n\t\t\tthis._senderSelectorNode.textContent = from.name;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis._fromSelectorNode.textContent = from.name;\n\t\t}\n\n\t\tif (setAsDefault)\n\t\t{\n\t\t\tBX.userOptions.save(\"crm\", \"sms_manager_editor\", \"from\", this._from);\n\t\t}\n\t}\n\n\tinitClientContainer()\n\t{\n\t\tif (this._communications.length === 0)\n\t\t{\n\t\t\tBX.hide(this._clientContainerNode);\n\t\t}\n\t}\n\n\tinitClientSelector()\n\t{\n\t\tconst menuItems = [];\n\t\tconst handler = this.onClientSelectorClick.bind(this);\n\n\t\tfor (let i = 0; i < this._communications.length; ++i)\n\t\t{\n\t\t\tmenuItems.push({\n\t\t\t\ttext: this._communications[i].caption,\n\t\t\t\tclient: this._communications[i],\n\t\t\t\tonclick: handler\n\t\t\t});\n\t\t\tif (i === 0)\n\t\t\t{\n\t\t\t\tthis.setClient(this._communications[i]);\n\t\t\t}\n\t\t}\n\n\t\tBX.bind(this._clientSelectorNode, 'click', this.openMenu.bind(this, 'comm', this._clientSelectorNode, menuItems));\n\t}\n\n\tonClientSelectorClick(e, item)\n\t{\n\t\tif (item.client)\n\t\t{\n\t\t\tthis.setClient(item.client);\n\t\t}\n\t\tthis._menu.close();\n\t}\n\n\tsetClient(client)\n\t{\n\t\tthis._commEntityTypeId = client.entityTypeId;\n\t\tthis._commEntityId = client.entityId;\n\t\tthis._clientSelectorNode.textContent = client.caption;\n\t\tthis._toList = client.phones;\n\t\tthis.setTo(client.phones[0]);\n\t}\n\n\tinitToSelector()\n\t{\n\t\tBX.bind(this._toSelectorNode, 'click', this.onToSelectorClick.bind(this));\n\t}\n\n\tonToSelectorClick(e)\n\t{\n\t\tconst menuItems = [];\n\t\tconst handler = this.onToSelectorItemClick.bind(this);\n\n\t\tfor (let i = 0; i < this._toList.length; ++i)\n\t\t{\n\t\t\tmenuItems.push({\n\t\t\t\ttext: this._toList[i].valueFormatted || this._toList[i].value,\n\t\t\t\tto: this._toList[i],\n\t\t\t\tonclick: handler\n\t\t\t});\n\t\t}\n\n\t\tthis.openMenu('to_'+this._commEntityTypeId+'_'+this._commEntityId, this._toSelectorNode, menuItems, e);\n\t}\n\n\tonToSelectorItemClick(e, item)\n\t{\n\t\tif (item.to)\n\t\t{\n\t\t\tthis.setTo(item.to);\n\t\t}\n\t\tthis._menu.close();\n\t}\n\n\tsetTo(to)\n\t{\n\t\tthis._to = to.value;\n\t\tthis._toSelectorNode.textContent = to.valueFormatted || to.value;\n\t}\n\n\topenMenu(menuId, bindElement, menuItems, e)\n\t{\n\t\tif (this._shownMenuId === menuId)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif(this._shownMenuId !== null && this._menu)\n\t\t{\n\t\t\tthis._menu.close();\n\t\t\tthis._shownMenuId = null;\n\t\t}\n\n\t\tBX.PopupMenu.show(\n\t\t\tthis._id + menuId,\n\t\t\tbindElement,\n\t\t\tmenuItems,\n\t\t\t{\n\t\t\t\toffsetTop: 0,\n\t\t\t\toffsetLeft: 36,\n\t\t\t\tangle: { position: \"top\", offset: 0 },\n\t\t\t\tevents:\n\t\t\t\t\t{\n\t\t\t\t\t\tonPopupClose: BX.delegate(this.onMenuClose, this)\n\t\t\t\t\t}\n\t\t\t}\n\t\t);\n\n\t\tthis._menu = BX.PopupMenu.currentItem;\n\t\te.preventDefault();\n\t}\n\n\tonMenuClose()\n\t{\n\t\tthis._shownMenuId = null;\n\t\tthis._menu = null;\n\t}\n\n\tinitMessageLengthCounter()\n\t{\n\t\tthis._messageLengthMax = parseInt(this._messageLengthCounterNode.getAttribute('data-length-max'));\n\t\tBX.bind(this._input, 'keyup', this.setMessageLengthCounter.bind(this));\n\t\tBX.bind(this._input, 'cut', this.setMessageLengthCounterDelayed.bind(this));\n\t\tBX.bind(this._input, 'paste', this.setMessageLengthCounterDelayed.bind(this));\n\t}\n\n\tsetMessageLengthCounterDelayed()\n\t{\n\t\tsetTimeout(this.setMessageLengthCounter.bind(this), 0);\n\t}\n\n\tsetMessageLengthCounter()\n\t{\n\t\tconst length = this._input.value.length;\n\t\tthis._messageLengthCounterNode.textContent = length;\n\n\t\tconst classFn = length >= this._messageLengthMax ? 'addClass' : 'removeClass';\n\t\tBX[classFn](this._messageLengthCounterNode, 'crm-entity-stream-content-sms-symbol-counter-number-overhead');\n\n\t\tthis.toggleSaveButton();\n\t}\n\n\ttoggleSaveButton()\n\t{\n\t\tconst sender = this.getSelectedSender();\n\t\tlet enabled;\n\t\tif (!sender || !sender.isTemplatesBased)\n\t\t{\n\t\t\tenabled = this._input.value.length > 0;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tenabled = !!this._templateId;\n\t\t}\n\t\tif (enabled)\n\t\t{\n\t\t\tBX.removeClass(this._saveButton, 'ui-btn-disabled');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tBX.addClass(this._saveButton, 'ui-btn-disabled');\n\t\t}\n\t}\n\n\tsave()\n\t{\n\t\tconst sender = this.getSelectedSender();\n\n\t\tlet text = '';\n\t\tlet templateId = '';\n\n\t\tif (!sender || !sender.isTemplatesBased)\n\t\t{\n\t\t\ttext = this._input.value;\n\t\t\tif (text === '')\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst template = this.getSelectedTemplate();\n\t\t\tif (!template)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\ttext = template.PREVIEW;\n\t\t\ttemplateId = template.ID;\n\t\t}\n\n\t\tif (!this._communications.length)\n\t\t{\n\t\t\talert(BX.message('CRM_TIMELINE_SMS_ERROR_NO_COMMUNICATIONS'));\n\t\t\treturn;\n\t\t}\n\n\t\tif(this._isRequestRunning || this._isLocked)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis._isRequestRunning = this._isLocked = true;\n\t\tBX.ajax(\n\t\t\t{\n\t\t\t\turl: BX.util.add_url_param(this._serviceUrl, {\n\t\t\t\t\t\"action\": \"save_sms_message\",\n\t\t\t\t\t\"sender\": this._senderId\n\t\t\t\t}),\n\t\t\t\tmethod: \"POST\",\n\t\t\t\tdataType: \"json\",\n\t\t\t\tdata:\n\t\t\t\t\t{\n\t\t\t\t\t\t'site': BX.message('SITE_ID'),\n\t\t\t\t\t\t'sessid': BX.bitrix_sessid(),\n\t\t\t\t\t\t'source': this._source,\n\t\t\t\t\t\t\"ACTION\": \"SAVE_SMS_MESSAGE\",\n\t\t\t\t\t\t\"SENDER_ID\": this._senderId,\n\t\t\t\t\t\t\"MESSAGE_FROM\": this._from,\n\t\t\t\t\t\t\"MESSAGE_TO\": this._to,\n\t\t\t\t\t\t\"MESSAGE_BODY\": text,\n\t\t\t\t\t\t\"MESSAGE_TEMPLATE\": templateId,\n\t\t\t\t\t\t\"OWNER_TYPE_ID\": this._ownerTypeId,\n\t\t\t\t\t\t\"OWNER_ID\": this._ownerId,\n\t\t\t\t\t\t\"TO_ENTITY_TYPE_ID\": this._commEntityTypeId,\n\t\t\t\t\t\t\"TO_ENTITY_ID\": this._commEntityId,\n\t\t\t\t\t\t\"PAYMENT_ID\": this._paymentId,\n\t\t\t\t\t\t\"SHIPMENT_ID\": this._shipmentId,\n\t\t\t\t\t\t\"COMPILATION_PRODUCT_IDS\": this._compilationProductIds,\n\t\t\t\t\t},\n\t\t\t\tonsuccess: BX.delegate(this.onSaveSuccess, this),\n\t\t\t\tonfailure: BX.delegate(this.onSaveFailure, this)\n\t\t\t}\n\t\t);\n\t}\n\n\tcancel()\n\t{\n\t\tthis._input.value = \"\";\n\t\tthis.setMessageLengthCounter();\n\t\tthis._input.style.minHeight = \"\";\n\t\tthis.release();\n\t}\n\n\tonSaveSuccess(data)\n\t{\n\t\tthis._isRequestRunning = this._isLocked = false;\n\n\t\tconst error = BX.prop.getString(data, \"ERROR\", \"\");\n\t\tif(error !== \"\")\n\t\t{\n\t\t\talert(error);\n\t\t\treturn;\n\t\t}\n\n\t\tthis._input.value = \"\";\n\t\tthis.setMessageLengthCounter();\n\t\tthis._input.style.minHeight = \"\";\n\t\tthis._manager.processEditingCompletion(this);\n\t\tthis.release();\n\t}\n\n\tonSaveFailure()\n\t{\n\t\tthis._isRequestRunning = this._isLocked = false;\n\t}\n\n\tinitSalescenterApplication()\n\t{\n\t\tBX.bind(this._salescenterStarter, 'click', this.startSalescenterApplication.bind(this));\n\t}\n\n\tstartSalescenterApplication()\n\t{\n\t\tBX.loadExt('salescenter.manager').then(function()\n\t\t{\n\t\t\tBX.Salescenter.Manager.openApplication({\n\t\t\t\tdisableSendButton: this._canSendMessage ? '' : 'y',\n\t\t\t\tcontext: 'sms',\n\t\t\t\townerTypeId: this._ownerTypeId,\n\t\t\t\townerId: this._ownerId,\n\t\t\t\tmode: this._ownerTypeId === BX.CrmEntityType.enumeration.deal ? 'payment_delivery' : 'payment',\n\t\t\t}).then(function(result)\n\t\t\t{\n\t\t\t\tif(result && result.get('action'))\n\t\t\t\t{\n\t\t\t\t\tif(result.get('action') === 'sendPage' && result.get('page') && result.get('page').url)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis._input.focus();\n\t\t\t\t\t\tthis._input.value = this._input.value + result.get('page').name + ' ' + result.get('page').url;\n\t\t\t\t\t\tthis.setMessageLengthCounter();\n\t\t\t\t\t}\n\t\t\t\t\telse if (result.get('action') === 'sendPayment' && result.get('order'))\n\t\t\t\t\t{\n\t\t\t\t\t\tthis._input.focus();\n\t\t\t\t\t\tthis._input.value = this._input.value + result.get('order').title;\n\t\t\t\t\t\tthis.setMessageLengthCounter();\n\t\t\t\t\t\tthis._source = 'order';\n\t\t\t\t\t\tthis._paymentId = result.get('order').paymentId;\n\t\t\t\t\t\tthis._shipmentId = result.get('order').shipmentId;\n\t\t\t\t\t}\n\t\t\t\t\telse if(result.get('action') === 'sendCompilation' && result.get('compilation'))\n\t\t\t\t\t{\n\t\t\t\t\t\tthis._input.focus();\n\t\t\t\t\t\tthis._input.value = this._input.value + result.get('compilation').title;\n\t\t\t\t\t\tthis.setMessageLengthCounter();\n\t\t\t\t\t\tthis._source = 'deal';\n\t\t\t\t\t\tthis._compilationProductIds = result.get('compilation').productIds;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}.bind(this));\n\t\t}.bind(this));\n\t}\n\n\tinitDocumentSelector()\n\t{\n\t\tBX.bind(this._documentSelectorButton, 'click', this.onDocumentSelectorClick.bind(this));\n\t}\n\n\tonDocumentSelectorClick()\n\t{\n\t\tif(!this._documentSelector)\n\t\t{\n\t\t\tBX.loadExt('documentgenerator.selector').then(function()\n\t\t\t{\n\t\t\t\tthis._documentSelector = new BX.DocumentGenerator.Selector.Menu({\n\t\t\t\t\tnode: this._documentSelectorButton,\n\t\t\t\t\tmoduleId: 'crm',\n\t\t\t\t\tprovider: this._documentsProvider,\n\t\t\t\t\tvalue: this._documentsValue,\n\t\t\t\t\tanalyticsLabelPrefix: 'crmTimelineSmsEditor'\n\t\t\t\t});\n\t\t\t\tthis.selectPublicUrl();\n\t\t\t}.bind(this));\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.selectPublicUrl();\n\t\t}\n\t}\n\n\tselectPublicUrl()\n\t{\n\t\tif(!this._documentSelector)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tthis._documentSelector.show().then(function(object)\n\t\t{\n\t\t\tif(object instanceof BX.DocumentGenerator.Selector.Template)\n\t\t\t{\n\t\t\t\tthis._documentSelector.createDocument(object).then(function(document)\n\t\t\t\t{\n\t\t\t\t\tthis.pasteDocumentUrl(document);\n\t\t\t\t}.bind(this)).catch(function(error)\n\t\t\t\t{\n\t\t\t\t\tconsole.error(error);\n\t\t\t\t}.bind(this));\n\t\t\t}\n\t\t\telse if(object instanceof BX.DocumentGenerator.Selector.Document)\n\t\t\t{\n\t\t\t\tthis.pasteDocumentUrl(object);\n\t\t\t}\n\t\t}.bind(this)).catch(function(error)\n\t\t{\n\t\t\tconsole.error(error);\n\t\t}.bind(this));\n\t}\n\n\tpasteDocumentUrl(document)\n\t{\n\t\tthis._documentSelector.getDocumentPublicUrl(document).then(function(publicUrl)\n\t\t{\n\t\t\tthis._input.focus();\n\t\t\tthis._input.value = this._input.value + ' ' + document.getTitle() + ' ' + publicUrl;\n\t\t\tthis.setMessageLengthCounter();\n\t\t\tthis._source = 'document';\n\t\t}.bind(this)).catch(function(error)\n\t\t{\n\t\t\tconsole.error(error);\n\t\t}.bind(this));\n\t}\n\n\tinitFileSelector()\n\t{\n\t\tBX.bind(this._fileSelectorButton, 'click', this.onFileSelectorClick.bind(this));\n\t}\n\n\tcloseFileSelector()\n\t{\n\t\tBX.PopupMenu.destroy('sms-file-selector');\n\t}\n\n\tonFileSelectorClick()\n\t{\n\t\tBX.PopupMenu.show('sms-file-selector', this._fileSelectorButton, [\n\t\t\t{\n\t\t\t\ttext: BX.message('CRM_TIMELINE_SMS_UPLOAD_FILE'),\n\t\t\t\tonclick: this.uploadFile.bind(this),\n\t\t\t\tclassName: this._isFilesExternalLinkEnabled ? '' : 'crm-entity-stream-content-sms-menu-item-with-lock'\n\t\t\t},\n\t\t\t{\n\t\t\t\ttext: BX.message('CRM_TIMELINE_SMS_FIND_FILE'),\n\t\t\t\tonclick: this.findFile.bind(this),\n\t\t\t\tclassName: this._isFilesExternalLinkEnabled ? '' : 'crm-entity-stream-content-sms-menu-item-with-lock'\n\t\t\t}\n\t\t])\n\t}\n\n\tgetFileUploadInput()\n\t{\n\t\treturn document.getElementById(this._fileUploadLabel.getAttribute('for'));\n\t}\n\n\tuploadFile()\n\t{\n\t\tthis.closeFileSelector();\n\t\tif(this._isFilesExternalLinkEnabled)\n\t\t{\n\t\t\tthis.initDiskUF();\n\t\t\tBX.fireEvent(this.getFileUploadInput(), 'click');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.showFilesExternalLinkFeaturePopup();\n\t\t}\n\t}\n\n\tfindFile()\n\t{\n\t\tthis.closeFileSelector();\n\t\tif(this._isFilesExternalLinkEnabled)\n\t\t{\n\t\t\tthis.initDiskUF();\n\t\t\tBX.fireEvent(this._fileSelectorBitrix, 'click');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.showFilesExternalLinkFeaturePopup();\n\t\t}\n\t}\n\n\tgetLoader()\n\t{\n\t\tif(!this.loader)\n\t\t{\n\t\t\tthis.loader = new BX.Loader(\n\t\t\t\t{\n\t\t\t\t\tsize: 50\n\t\t\t\t});\n\t\t}\n\n\t\treturn this.loader;\n\t}\n\n\tshowLoader(node)\n\t{\n\t\tif(node && !this.getLoader().isShown())\n\t\t{\n\t\t\tthis.getLoader().show(node);\n\t\t}\n\t}\n\n\thideLoader()\n\t{\n\t\tif(this.getLoader().isShown())\n\t\t{\n\t\t\tthis.getLoader().hide();\n\t\t}\n\t}\n\n\tinitDiskUF()\n\t{\n\t\tif(this.isDiskFileUploaderInited || !this._isFilesEnabled)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tthis.isDiskFileUploaderInited = true;\n\t\tBX.addCustomEvent(this._fileUploadZone, 'OnFileUploadSuccess', this.OnFileUploadSuccess.bind(this));\n\t\tBX.addCustomEvent(this._fileUploadZone, 'DiskDLoadFormControllerInit', function(uf)\n\t\t{\n\t\t\tuf._onUploadProgress = function()\n\t\t\t{\n\t\t\t\tthis.showLoader(this._fileSelectorButton.parentNode.parentNode);\n\t\t\t}.bind(this);\n\t\t}.bind(this));\n\n\t\tBX.Disk.UF.add({\n\t\t\tUID: this._fileUploadZone.getAttribute('data-node-id'),\n\t\t\tcontrolName: this._fileUploadLabel.getAttribute('for'),\n\t\t\thideSelectDialog: false,\n\t\t\turlSelect: this._diskUrls.urlSelect,\n\t\t\turlRenameFile: this._diskUrls.urlRenameFile,\n\t\t\turlDeleteFile: this._diskUrls.urlDeleteFile,\n\t\t\turlUpload: this._diskUrls.urlUpload\n\t\t});\n\n\t\tBX.onCustomEvent(\n\t\t\tthis._fileUploadZone,\n\t\t\t'DiskLoadFormController',\n\t\t\t['show']\n\t\t);\n\t}\n\n\tOnFileUploadSuccess(fileResult, uf, file, uploaderFile)\n\t{\n\t\tthis.hideLoader();\n\t\tconst diskFileId = parseInt(fileResult.element_id.replace('n', ''));\n\t\tconst fileName = fileResult.element_name;\n\t\tthis.pasteFileUrl(diskFileId, fileName);\n\t}\n\n\tpasteFileUrl(diskFileId, fileName)\n\t{\n\t\tthis.showLoader(this._fileSelectorButton.parentNode.parentNode);\n\t\tBX.ajax.runAction('disk.file.generateExternalLink', {\n\t\t\tanalyticsLabel: 'crmTimelineSmsEditorGetFilePublicUrl',\n\t\t\tdata: {\n\t\t\t\tfileId: diskFileId\n\t\t\t}\n\t\t}).then(function(response)\n\t\t{\n\t\t\tthis.hideLoader();\n\t\t\tif(response.data.externalLink && response.data.externalLink.link)\n\t\t\t{\n\t\t\t\tthis._input.focus();\n\t\t\t\tthis._input.value = this._input.value + ' ' + fileName + ' ' + response.data.externalLink.link;\n\t\t\t\tthis.setMessageLengthCounter();\n\t\t\t\tthis._source = 'file';\n\t\t\t}\n\t\t}.bind(this)).catch(function(response)\n\t\t{\n\t\t\tconsole.error(response.errors.pop().message);\n\t\t});\n\t}\n\n\tgetFeaturePopup(content)\n\t{\n\t\tif(this.featurePopup != null)\n\t\t{\n\t\t\treturn this.featurePopup;\n\t\t}\n\t\tthis.featurePopup = new BX.PopupWindow('bx-popup-crm-sms-editor-feature-popup', null, {\n\t\t\tzIndex: 200,\n\t\t\tautoHide: true,\n\t\t\tcloseByEsc: true,\n\t\t\tcloseIcon: true,\n\t\t\toverlay : true,\n\t\t\tevents : {\n\t\t\t\tonPopupDestroy : function()\n\t\t\t\t{\n\t\t\t\t\tthis.featurePopup = null;\n\t\t\t\t}.bind(this)\n\t\t\t},\n\t\t\tcontent : content,\n\t\t\tcontentColor: 'white'\n\t\t});\n\n\t\treturn this.featurePopup;\n\t}\n\n\tshowFilesExternalLinkFeaturePopup()\n\t{\n\t\tthis.getFeaturePopup(this._fileExternalLinkDisabledContent).show();\n\t}\n\n\tonTemplateHintIconClick()\n\t{\n\t\tif (this._senderId === 'ednaru')\n\t\t{\n\t\t\ttop.BX.Helper.show(\"redirect=detail&code=14214014\");\n\t\t}\n\t}\n\n\tshowTemplateSelectDropdown(items)\n\t{\n\t\tconst menuItems = [];\n\t\tif (BX.Type.isArray(items))\n\t\t{\n\t\t\tif (items.length)\n\t\t\t{\n\t\t\t\titems.forEach(function(item)\n\t\t\t\t{\n\t\t\t\t\tmenuItems.push({\n\t\t\t\t\t\tvalue: item.ID,\n\t\t\t\t\t\ttext: item.TITLE,\n\t\t\t\t\t\tonclick: this._selectTemplateHandler\n\t\t\t\t\t})\n\t\t\t\t}.bind(this));\n\n\t\t\t\tBX.PopupMenu.show({\n\t\t\t\t\tid: this._templateSelectorMenuId,\n\t\t\t\t\tbindElement: this._templateSelectorNode,\n\t\t\t\t\titems: menuItems,\n\t\t\t\t\tangle: false,\n\t\t\t\t\twidth: this._templateSelectorNode.offsetWidth,\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\telse if (this._senderId)\n\t\t{\n\t\t\tconst loaderMenuId = this._templateSelectorMenuId + 'loader';\n\t\t\tconst loaderMenuLoaderId = this._templateSelectorMenuId + 'loader';\n\n\t\t\tBX.PopupMenu.show({\n\t\t\t\tid: loaderMenuId,\n\t\t\t\tbindElement: this._templateSelectorNode,\n\t\t\t\titems: [{\n\t\t\t\t\thtml: '<div id=\"' + loaderMenuLoaderId + '\"></div>',\n\t\t\t\t}],\n\t\t\t\tangle: false,\n\t\t\t\twidth: this._templateSelectorNode.offsetWidth,\n\t\t\t\theight: 60,\n\t\t\t\tevents: {\n\t\t\t\t\tonDestroy: function() {\n\t\t\t\t\t\tthis.hideLoader();\n\t\t\t\t\t}.bind(this)\n\t\t\t\t}\n\t\t\t});\n\t\t\tthis.showLoader(BX(loaderMenuLoaderId));\n\n\t\t\tif (!this._isRequestRunning)\n\t\t\t{\n\t\t\t\tthis._isRequestRunning = true;\n\t\t\t\tconst senderId = this._senderId;\n\t\t\t\tBX.ajax.runAction(\n\t\t\t\t\t'messageservice.Sender.getTemplates',\n\t\t\t\t\t{\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\tid: senderId,\n\t\t\t\t\t\t\tcontext: {\n\t\t\t\t\t\t\t\tmodule: 'crm',\n\t\t\t\t\t\t\t\tentityTypeId: this._manager._ownerTypeId,\n\t\t\t\t\t\t\t\tentityId: this._manager._ownerId,\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t\t\t.then(function(response)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis._isRequestRunning = false;\n\t\t\t\t\t\tconst sender = this._senders.find(function (sender) {\n\t\t\t\t\t\t\treturn (sender.id === senderId);\n\t\t\t\t\t\t}.bind(this));\n\n\t\t\t\t\t\tif (sender)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tsender.templates = response.data.templates;\n\t\t\t\t\t\t\tthis.toggleTemplateSelectAvailability();\n\t\t\t\t\t\t\tif (BX.PopupMenu.getMenuById(loaderMenuId))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tBX.PopupMenu.getMenuById(loaderMenuId).close();\n\t\t\t\t\t\t\t\tthis.showTemplateSelectDropdown(sender.templates);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}.bind(this))\n\t\t\t\t\t.catch(function(response)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis._isRequestRunning = false;\n\t\t\t\t\t\tif (BX.PopupMenu.getMenuById(loaderMenuId))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (response && response.errors && response.errors[0] && response.errors[0].message)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\talert(response.errors[0].message);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tBX.PopupMenu.getMenuById(loaderMenuId).close();\n\t\t\t\t\t\t}\n\t\t\t\t\t}.bind(this))\n\t\t\t\t;\n\t\t\t}\n\t\t}\n\n\t}\n\n\tgetSelectedSender()\n\t{\n\t\treturn this._senders.find(function(sender) {\n\t\t\treturn (sender.id === this._senderId);\n\t\t}.bind(this));\n\t}\n\n\tgetSelectedTemplate()\n\t{\n\t\tconst sender = this.getSelectedSender();\n\t\tif (!this._templateId || !sender || !sender.templates)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst template = sender.templates.find(function (template) {\n\t\t\treturn template.ID == this._templateId;\n\t\t}.bind(this));\n\n\t\treturn template ? template : null;\n\t}\n\n\tonTemplateSelectClick()\n\t{\n\t\tconst sender = this.getSelectedSender();\n\n\t\tif (sender)\n\t\t{\n\t\t\tthis.showTemplateSelectDropdown(sender.templates);\n\t\t}\n\t}\n\n\tonSelectTemplate(e, item)\n\t{\n\t\tthis._templateId = item.value;\n\t\tthis.applySelectedTemplate();\n\t\tthis.toggleSaveButton();\n\t\tconst menu = BX.PopupMenu.getMenuById(this._templateSelectorMenuId);\n\t\tif (menu)\n\t\t{\n\t\t\tmenu.close();\n\t\t}\n\t}\n\n\ttoggleTemplateSelectAvailability()\n\t{\n\t\tconst sender = this.getSelectedSender();\n\t\tif (sender && BX.Type.isArray(sender.templates) && !sender.templates.length)\n\t\t{\n\t\t\tBX.addClass(this._templateSelectorNode, 'ui-ctl-disabled');\n\t\t\tthis._templateTemplateTitleNode.textContent = BX.message('CRM_TIMELINE_SMS_TEMPLATES_NOT_FOUND');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tBX.removeClass(this._templateSelectorNode, 'ui-ctl-disabled');\n\t\t\tthis.applySelectedTemplate();\n\t\t}\n\t}\n\n\tapplySelectedTemplate()\n\t{\n\t\tconst sender = this.getSelectedSender();\n\t\tif (!this._templateId || !sender || !sender.templates)\n\t\t{\n\t\t\tthis.hideNode(this._templatePreviewNode);\n\t\t\tthis._templateTemplateTitleNode.textContent = '';\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst template = this.getSelectedTemplate();\n\t\t\tif (template)\n\t\t\t{\n\t\t\t\tconst preview = BX.Text.encode(template.PREVIEW).replace(/\\n/g, '<br>');\n\n\t\t\t\tthis.showNode(this._templatePreviewNode);\n\t\t\t\tthis._templatePreviewNode.innerHTML = preview;\n\t\t\t\tthis._templateTemplateTitleNode.textContent = template.TITLE;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.hideNode(this._templatePreviewNode);\n\t\t\t\tthis._templateTemplateTitleNode.textContent = '';\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Sms();\n\t\tself.initialize(id, settings);\n\t\tSms.items[self.getId()] = self;\n\t\treturn self;\n\t}\n\n\tstatic items = {};\n}\n","import Editor from \"../editor\";\n\n/** @memberof BX.Crm.Timeline.Editors */\nexport default class Rest extends Editor\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._interfaceInitialized = false;\n\t}\n\n\taction(action)\n\t{\n\t\tif(!this._interfaceInitialized)\n\t\t{\n\t\t\tthis._interfaceInitialized = true;\n\t\t\tthis.initializeInterface();\n\t\t}\n\n\t\tif(action === 'activity_rest_applist')\n\t\t{\n\t\t\tBX.rest.Marketplace.open({\n\t\t\t\tPLACEMENT: this.getSetting(\"placement\", '')\n\t\t\t});\n\n\t\t\ttop.BX.addCustomEvent(top, 'Rest:AppLayout:ApplicationInstall', BX.proxy(this.fireUpdateEvent, this));\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst appId = action.replace('activity_rest_', '');\n\t\t\tconst appData = appId.split('_');\n\n\t\t\tBX.rest.AppLayout.openApplication(\n\t\t\t\tappData[0],\n\t\t\t\t{\n\t\t\t\t\tID: this._ownerId\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tPLACEMENT: this.getSetting(\"placement\", ''),\n\t\t\t\t\tPLACEMENT_ID: appData[1]\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t}\n\n\tinitializeInterface()\n\t{\n\t\tif(!!top.BX.rest && !!top.BX.rest.AppLayout)\n\t\t{\n\t\t\tconst entityTypeId = this._manager._ownerTypeId, entityId = this._manager._ownerId;\n\n\t\t\tconst PlacementInterface = top.BX.rest.AppLayout.initializePlacement(this.getSetting(\"placement\", ''));\n\n\t\t\tPlacementInterface.prototype.reloadData = function(params, cb)\n\t\t\t{\n\t\t\t\tBX.Crm.EntityEvent.fireUpdate(entityTypeId, entityId, '');\n\t\t\t\tcb();\n\t\t\t};\n\t\t}\n\t}\n\n\tfireUpdateEvent()\n\t{\n\t\tconst entityTypeId = this._manager._ownerTypeId, entityId = this._manager._ownerId;\n\t\tsetTimeout(function(){\n\t\t\tconsole.log('fireUpdate', entityId, entityTypeId);\n\t\t\tBX.Crm.EntityEvent.fire(BX.Crm.EntityEvent.names.invalidate, entityTypeId, entityId, '');\n\t\t}, 3000);\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Rest();\n\t\tself.initialize(id, settings);\n\t\tRest.items[self.getId()] = self;\n\t\treturn self;\n\t}\n\n\tstatic items = {};\n}\n","import Editor from \"../editor\";\n\n/** @memberof BX.Crm.Timeline.Editors */\nexport default class Comment extends Editor\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._history = null;\n\t\tthis._serviceUrl = \"\";\n\t\tthis._postForm = null;\n\t\tthis._editor = null;\n\t\tthis._isRequestRunning = false;\n\t\tthis._isLocked = false;\n\t}\n\n\tdoInitialize()\n\t{\n\t\tthis._serviceUrl = this.getSetting(\"serviceUrl\", \"\");\n\t\tBX.unbind(this._input, \"blur\", this._blurHandler);\n\t\tBX.unbind(this._input, \"keyup\", this._keyupHandler);\n\t}\n\n\tloadEditor()\n\t{\n\t\tthis._editorName = 'CrmTimeLineComment0';\n\n\t\tif (this._postForm)\n\t\t\treturn;\n\n\t\tBX.ajax.runAction(\n\t\t\t\"crm.api.timeline.loadEditor\",\n\t\t\t{ data: { name: this._editorName } }\n\t\t).then(this.onLoadEditorSuccess.bind(this));\n\t}\n\n\tonLoadEditorSuccess(result)\n\t{\n\t\tconst html = BX.prop.getString(BX.prop.getObject(result, \"data\", {}), \"html\", '');\n\t\tBX.html(this._editorContainer, html)\n\t\t\t.then(BX.delegate(this.showEditor,this))\n\t\t\t.then(BX.delegate(this.addEvents,this));\n\t}\n\n\taddEvents()\n\t{\n\t\tBX.addCustomEvent(\n\t\t\tthis._editorContainer.firstElementChild,\n\t\t\t'onFileIsAppended',\n\t\t\tBX.delegate(function(id, item) {\n\t\t\t\tBX.addClass(this._saveButton, 'ui-btn-disabled');\n\t\t\t\tBX.addClass(this._saveButton, 'ui-btn-clock');\n\t\t\t\tthis._saveButton.removeEventListener(\"click\", this._saveButtonHandler);\n\t\t\t}, this)\n\t\t);\n\n\t\tBX.addCustomEvent(\n\t\t\tthis._editorContainer.firstElementChild,\n\t\t\t'onFileIsAdded',\n\t\t\tBX.delegate(function(file, controller, obj, blob) {\n\t\t\t\tBX.removeClass(this._saveButton, 'ui-btn-clock');\n\t\t\t\tBX.removeClass(this._saveButton, 'ui-btn-disabled');\n\t\t\t\tthis._saveButton.addEventListener(\"click\", this._saveButtonHandler);\n\t\t\t}, this)\n\t\t);\n\t}\n\n\tshowEditor()\n\t{\n\t\tif (LHEPostForm)\n\t\t{\n\t\t\twindow.setTimeout(BX.delegate(function(){\n\t\t\t\tthis._postForm = LHEPostForm.getHandler(this._editorName);\n\t\t\t\tthis._editor = BXHtmlEditor.Get(this._editorName);\n\t\t\t\tBX.onCustomEvent(this._postForm.eventNode, 'OnShowLHE', [true]);\n\t\t\t} ,this), 100);\n\t\t}\n\t}\n\n\tgetHistory()\n\t{\n\t\treturn this._history;\n\t}\n\n\tsetHistory(history)\n\t{\n\t\tthis._history = history;\n\t}\n\n\tonFocus(e)\n\t{\n\t\tthis._input.style.display = 'none';\n\t\tif (this._editor && this._postForm)\n\t\t{\n\t\t\tthis._postForm.eventNode.style.display = 'block';\n\t\t\tthis._editor.Focus();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (!BX.type.isDomNode(this._editorContainer))\n\t\t\t{\n\t\t\t\tthis._editorContainer = BX.create(\"div\", {attrs: {className: \"crm-entity-stream-section-comment-editor\"}});\n\t\t\t\tthis._editorContainer.appendChild(\n\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tattrs: { className: \"crm-timeline-wait\" }\n\t\t\t\t\t\t})\n\t\t\t\t);\n\t\t\t\tthis._container.appendChild(this._editorContainer);\n\t\t\t}\n\n\t\t\twindow.setTimeout(BX.delegate(function(){\n\t\t\t\tthis.loadEditor();\n\t\t\t} ,this), 100);\n\t\t}\n\n\t\tBX.addClass(this._container, \"focus\");\n\t}\n\n\tsave()\n\t{\n\t\tlet text = \"\";\n\t\tconst attachmentList = [];\n\t\tif (this._postForm)\n\t\t{\n\t\t\ttext = this._postForm.oEditor.GetContent();\n\t\t\tthis._postForm.eventNode\n\t\t\t\t.querySelectorAll('input[name=\"UF_CRM_COMMENT_FILES[]\"]')\n\t\t\t\t.forEach(function(input) {\n\t\t\t\t\tattachmentList.push(input.value)\n\t\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\ttext = this._input.value;\n\t\t}\n\n\t\tif(text === \"\")\n\t\t{\n\t\t\tif (!this.emptyCommentMessage)\n\t\t\t{\n\t\t\t\tthis.emptyCommentMessage = new BX.PopupWindow(\n\t\t\t\t\t'timeline_empty_new_comment_' + this._ownerId,\n\t\t\t\t\tthis._saveButton,\n\t\t\t\t\t{\n\t\t\t\t\t\tcontent: BX.message('CRM_TIMELINE_EMPTY_COMMENT_MESSAGE'),\n\t\t\t\t\t\tdarkMode: true,\n\t\t\t\t\t\tautoHide: true,\n\t\t\t\t\t\tzIndex: 990,\n\t\t\t\t\t\tangle: {position: 'top', offset: 77},\n\t\t\t\t\t\tcloseByEsc: true,\n\t\t\t\t\t\tbindOptions: { forceBindPosition: true}\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tthis.emptyCommentMessage.show();\n\t\t\treturn;\n\t\t}\n\n\t\tif(this._isRequestRunning || this._isLocked)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis._isRequestRunning = this._isLocked = true;\n\t\tBX.ajax(\n\t\t\t{\n\t\t\t\turl: this._serviceUrl,\n\t\t\t\tmethod: \"POST\",\n\t\t\t\tdataType: \"json\",\n\t\t\t\tdata:\n\t\t\t\t\t{\n\t\t\t\t\t\t\"ACTION\": \"SAVE_COMMENT\",\n\t\t\t\t\t\t\"TEXT\": text,\n\t\t\t\t\t\t\"OWNER_TYPE_ID\": this._ownerTypeId,\n\t\t\t\t\t\t\"OWNER_ID\": this._ownerId,\n\t\t\t\t\t\t\"ATTACHMENTS\": attachmentList\n\t\t\t\t\t},\n\t\t\t\tonsuccess: BX.delegate(this.onSaveSuccess, this),\n\t\t\t\tonfailure: BX.delegate(this.onSaveFailure, this)\n\t\t\t}\n\t\t);\n\t}\n\n\tcancel()\n\t{\n\t\tthis._input.value = \"\";\n\t\tthis._input.style.minHeight = \"\";\n\t\tif (BX.type.isDomNode(this._editorContainer))\n\t\t\tthis._postForm.eventNode.style.display = 'none';\n\n\t\tthis._input.style.display = 'block';\n\t\tBX.removeClass(this._container, \"focus\");\n\t\tthis.release();\n\t}\n\n\tonSaveSuccess(data)\n\t{\n\t\tthis._isRequestRunning = false;\n\t\tif (this._postForm)\n\t\t{\n\t\t\tthis._postForm.reinit('', {});\n\t\t}\n\n\t\tthis.cancel();\n\t\tconst itemData = BX.prop.getObject(data, \"HISTORY_ITEM\");\n\t\tconst historyItem = this._history.createItem(itemData);\n\t\tthis._history.addItem(historyItem, 0);\n\n\t\tconst anchor = this._history.createAnchor();\n\t\thistoryItem.layout({ anchor: anchor });\n\n\t\tconst move = BX.CrmCommentAnimation.create(\n\t\t\thistoryItem.getWrapper(),\n\t\t\tanchor,\n\t\t\tBX.pos(this._input),\n\t\t\t{\n\t\t\t\tstart: BX.delegate(this.onAnimationStart, this),\n\t\t\t\tcomplete: BX.delegate(this.onAnimationComplete, this)\n\t\t\t}\n\t\t);\n\t\tmove.run();\n\t}\n\n\tonSaveFailure()\n\t{\n\t\tthis._isRequestRunning = this._isLocked = false;\n\t}\n\n\tonAnimationStart()\n\t{\n\t\tthis._input.value = \"\";\n\t}\n\n\tonAnimationComplete()\n\t{\n\t\tthis._isLocked = false;\n\t\tBX.removeClass(this._container, \"focus\");\n\n\t\tthis._input.style.minHeight = \"\";\n\t\tthis._manager.processEditingCompletion(this);\n\n\t\tthis.release();\n\n\t\tthis._history._anchor = null;\n\t\tthis._history.refreshLayout();\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Comment();\n\t\tself.initialize(id, settings);\n\t\tComment.items[self.getId()] = self;\n\t\treturn self;\n\t}\n\n\tstatic items = {};\n}\n","import Editor from \"../editor.js\";\nimport {Dom, Type} from \"main.core\";\nimport {TodoEditor} from \"crm.activity.todo-editor\";\nimport {BaseEvent} from \"main.core.events\";\n\n/** @memberof BX.Crm.Timeline.Editors */\nexport default class ToDo extends Editor\n{\n\t#toDoEditor = null;\n\n\tinitialize(id, settings): void\n\t{\n\t\tsuper.initialize(id, settings);\n\t\tthis.#createEditor();\n\t}\n\n\t#createEditor(): void\n\t{\n\t\tconst editorContainer = Dom.create('div');\n\t\tDom.prepend(editorContainer, this._container);\n\t\tthis.#toDoEditor = new TodoEditor({\n\t\t\tcontainer: editorContainer,\n\t\t\tdefaultDescription: '',\n\t\t\townerTypeId: this._ownerTypeId,\n\t\t\townerId: this._ownerId,\n\t\t\tevents: {\n\t\t\t\tonFocus: this._focusHandler,\n\t\t\t\tonChangeDescription: this.#onChangeDescription.bind(this),\n\t\t\t}\n\t\t});\n\n\t\tthis.#toDoEditor.show();\n\t}\n\n\tsave(): Promise\n\t{\n\t\tif (Dom.hasClass(this._saveButton, 'ui-btn-disabled'))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\t\treturn this.#toDoEditor.save().then((response) => {\n\t\t\tif (Type.isArray(response.errors) && response.errors.length)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tthis.cancel();\n\t\t\tthis._manager.processEditingCompletion(this);\n\n\t\t\treturn true;\n\t\t});\n\t}\n\n\tcancel(): void\n\t{\n\t\tthis.#toDoEditor.clearValue();\n\t\tDom.removeClass(this._container, 'focus');\n\t\tthis.release();\n\t}\n\n\tbindInputHandlers(): void\n\t{\n\t\t// do nothing\n\t}\n\n\tsetParentActivityId(activityId: Number): void\n\t{\n\t\tthis.#toDoEditor.setParentActivityId(activityId);\n\t}\n\n\tsetDeadLine(deadLine: String): void\n\t{\n\t\tthis.#toDoEditor.setDeadLine(deadLine);\n\t}\n\n\tsetFocused(): void\n\t{\n\t\tthis.#toDoEditor.setFocused();\n\t}\n\n\t#onChangeDescription(event: BaseEvent): void\n\t{\n\t\tconst {description} = event.getData();\n\n\t\tif (!description.length && !Dom.hasClass(this._saveButton, 'ui-btn-disabled'))\n\t\t{\n\t\t\tDom.addClass(this._saveButton, 'ui-btn-disabled');\n\t\t}\n\t\telse if (description.length && Dom.hasClass(this._saveButton, 'ui-btn-disabled'))\n\t\t{\n\t\t\tDom.removeClass(this._saveButton, 'ui-btn-disabled')\n\t\t}\n\t}\n\n\tstatic create(id, settings): ToDo\n\t{\n\t\tconst self = new ToDo();\n\t\tself.initialize(id, settings);\n\t\tToDo.items[self.getId()] = self;\n\t\treturn self;\n\t}\n\n\tstatic items = {};\n}\n","/** @memberof BX.Crm.Timeline.Types */\nexport const Item = {\n\tundefined: 0,\n\tactivity: 1,\n\tcreation: 2,\n\tmodification: 3,\n\tlink: 4,\n\tunlink: 5,\n\tmark: 6,\n\tcomment: 7,\n\twait: 8,\n\tbizproc: 9,\n\tconversion: 10,\n\tsender: 11,\n\tdocument: 12,\n\trestoration: 13,\n\torder: 14,\n\torderCheck: 15,\n\tscoring: 16,\n\texternalNotification: 17,\n\tfinalSummary: 18,\n\tdelivery: 19,\n\tfinalSummaryDocuments: 20,\n\tstoreDocument: 21,\n\tproductCompilation: 22,\n\tsignDocument: 23,\n};\n\n/** @memberof BX.Crm.Timeline.Types */\nexport const Mark = {\n\tundefined: 0,\n\twaiting: 1,\n\tsuccess: 2,\n\trenew: 3,\n\tignored: 4,\n\tfailed: 5\n};\n\n/** @memberof BX.Crm.Timeline.Types */\n\n/** @memberof BX.Crm.Timeline.Types */\nexport const Order = {\n\tencourageBuyProducts: 100,\n};\n\n/** @memberof BX.Crm.Timeline.Types */\nexport const EditorMode = {\n\tview: 1,\n\tedit: 2\n};\n","import {Item as ItemType} from \"../types\";\nimport {Item} from \"crm.timeline.item\";\nimport {Type} from \"main.core\";\nimport {TimezoneOffset} from \"crm.datetime\";\n\n/** @memberof BX.Crm.Timeline */\nexport default class CompatibleItem extends Item\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._id = \"\";\n\t\tthis._settings = {};\n\t\tthis._data = {};\n\t\tthis._container = null;\n\n\t\tthis._typeCategoryId = null;\n\t\tthis._associatedEntityData = null;\n\t\tthis._associatedEntityTypeId = null;\n\t\tthis._associatedEntityId = null;\n\t\tthis._isContextMenuShown = false;\n\t\tthis._contextMenuButton = null;\n\n\t\tthis._activityEditor = null;\n\t\tthis._actions = [];\n\t\tthis._actionContainer = null;\n\n\t\tthis._existedStreamItemDeadLine = null;\n\t}\n\n\tinitialize(id, settings)\n\t{\n\t\tthis._setId(id);\n\t\tthis._settings = settings ? settings : {};\n\n\t\tthis._container = this.getSetting(\"container\");\n\n\t\tif(!BX.type.isPlainObject(settings['data']))\n\t\t{\n\t\t\tthrow \"Item. A required parameter 'data' is missing.\";\n\t\t}\n\t\tthis._data = settings['data'];\n\n\t\tthis._activityEditor = this.getSetting(\"activityEditor\");\n\n\t\tthis.doInitialize();\n\t}\n\n\tdoInitialize()\n\t{\n\t}\n\n\tgetId()\n\t{\n\t\treturn this._id;\n\t}\n\n\tgetSetting(name, defaultval)\n\t{\n\t\treturn this._settings.hasOwnProperty(name) ? this._settings[name] : defaultval;\n\t}\n\n\tgetData()\n\t{\n\t\treturn this._data;\n\t}\n\n\tsetData(data)\n\t{\n\t\tif(BX.type.isPlainObject(data))\n\t\t{\n\t\t\tthis._data = data;\n\t\t\tthis.clearCachedData();\n\t\t}\n\t}\n\n\tgetSort(): Array\n\t{\n\t\treturn this._data['sort'] ?? [];\n\t}\n\n\tgetAssociatedEntityData()\n\t{\n\t\tif(this._associatedEntityData === null)\n\t\t{\n\t\t\tthis._associatedEntityData = BX.type.isPlainObject(this._data[\"ASSOCIATED_ENTITY\"])\n\t\t\t\t? this._data[\"ASSOCIATED_ENTITY\"] : {};\n\t\t}\n\n\t\treturn this._associatedEntityData;\n\t}\n\n\tgetAssociatedEntityTypeId()\n\t{\n\t\tif(this._associatedEntityTypeId === null)\n\t\t{\n\t\t\tthis._associatedEntityTypeId = BX.prop.getInteger(this._data, \"ASSOCIATED_ENTITY_TYPE_ID\", 0)\n\t\t}\n\t\treturn this._associatedEntityTypeId;\n\t}\n\n\tgetAssociatedEntityId()\n\t{\n\t\tif(this._associatedEntityId === null)\n\t\t{\n\t\t\tthis._associatedEntityId = BX.prop.getInteger(this._data, \"ASSOCIATED_ENTITY_ID\", 0)\n\t\t}\n\t\treturn this._associatedEntityId;\n\t}\n\n\tsetAssociatedEntityData(associatedEntityData)\n\t{\n\t\tif(!BX.type.isPlainObject(associatedEntityData))\n\t\t{\n\t\t\tassociatedEntityData = {};\n\t\t}\n\n\t\tconst data = this._data;\n\t\tdata.ASSOCIATED_ENTITY = associatedEntityData;\n\n\t\tthis.setData(data);\n\t}\n\n\thasPermissions()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\treturn BX.type.isPlainObject(entityData[\"PERMISSIONS\"]);\n\t}\n\n\tgetPermissions()\n\t{\n\t\treturn BX.prop.getObject(this.getAssociatedEntityData(), \"PERMISSIONS\", {});\n\t}\n\n\tsetPermissions(permissions)\n\t{\n\t\tconst data = this._data;\n\n\t\tif(!Type.isPlainObject(data.ASSOCIATED_ENTITY))\n\t\t{\n\t\t\tdata.ASSOCIATED_ENTITY = {};\n\t\t}\n\n\t\tdata.ASSOCIATED_ENTITY.PERMISSIONS = permissions;\n\n\t\tthis.setData(data);\n\t}\n\n\tgetTextDataParam(name)\n\t{\n\t\treturn BX.prop.getString(this._data, name, \"\");\n\t}\n\n\tgetObjectDataParam(name)\n\t{\n\t\treturn BX.prop.getObject(this._data, name, {});\n\t}\n\n\tgetArrayDataParam(name)\n\t{\n\t\treturn BX.prop.getArray(this._data, name, []);\n\t}\n\n\tgetTypeId()\n\t{\n\t\treturn ItemType.undefined;\n\t}\n\n\tgetTypeCategoryId()\n\t{\n\t\tif(this._typeCategoryId === null)\n\t\t{\n\t\t\tthis._typeCategoryId = BX.prop.getInteger(this._data, \"TYPE_CATEGORY_ID\", 0);\n\t\t}\n\t\treturn this._typeCategoryId;\n\t}\n\n\tgetContainer()\n\t{\n\t\treturn this._container;\n\t}\n\n\tsetContainer(container)\n\t{\n\t\tthis._container = BX.type.isElementNode(container) ? container : null;\n\t}\n\n\tlayout(options)\n\t{\n\t\tif(!BX.type.isElementNode(this._container))\n\t\t{\n\t\t\tthrow \"Item. Container is not assigned.\";\n\t\t}\n\n\t\tthis.prepareLayout(options);\n\t\t//region Actions\n\t\t/**/\n\t\tthis.prepareActions();\n\t\tconst actionQty = this._actions.length;\n\t\tfor(let i = 0; i < actionQty; i++)\n\t\t{\n\t\t\tthis._actions[i].layout();\n\t\t}\n\t\tthis.showActions(actionQty > 0);\n\t\t/**/\n\t\t//endregion\n\t}\n\n\tprepareLayout(options)\n\t{\n\t}\n\n\tprepareActions()\n\t{\n\t}\n\n\tshowActions(show)\n\t{\n\t}\n\n\tclearCachedData()\n\t{\n\t\tthis._typeCategoryId = null;\n\t\tthis._associatedEntityData = null;\n\t\tthis._associatedEntityTypeId = null;\n\t\tthis._associatedEntityId = null;\n\t}\n\n\tisDone()\n\t{\n\t\treturn false;\n\t}\n\n\tmarkAsDone(isDone)\n\t{\n\t}\n\n\tview()\n\t{\n\t}\n\n\tedit()\n\t{\n\t}\n\n\tfasten()\n\t{\n\t}\n\n\tunfasten()\n\t{\n\t}\n\n\tremove()\n\t{\n\t}\n\n\tcutOffText(text, length)\n\t{\n\t\tif(!BX.type.isNumber(length))\n\t\t{\n\t\t\tlength = 0;\n\t\t}\n\n\t\tif(length <= 0 || text.length <= length)\n\t\t{\n\t\t\treturn text;\n\t\t}\n\n\t\tlet offset = length - 1;\n\t\tconst whilespaceOffset = text.substring(offset).search(/\\s/i);\n\t\tif(whilespaceOffset > 0)\n\t\t{\n\t\t\toffset += whilespaceOffset;\n\t\t}\n\t\treturn text.substring(0, offset);\n\t}\n\n\tprepareMultilineCutOffElements(text, length, clickHandler)\n\t{\n\t\tif(!BX.type.isNumber(length))\n\t\t{\n\t\t\tlength = 0;\n\t\t}\n\n\t\tif(length <= 0 || text.length <= length)\n\t\t{\n\t\t\treturn [BX.util.htmlspecialchars(text).replace(/(?:\\r\\n|\\r|\\n)/g, '<br>')];\n\t\t}\n\n\t\tlet offset = length - 1;\n\t\tconst whilespaceOffset = text.substring(offset).search(/\\s/i);\n\t\tif(whilespaceOffset > 0)\n\t\t{\n\t\t\toffset += whilespaceOffset;\n\t\t}\n\t\treturn(\n\t\t\t[\n\t\t\t\tBX.util.htmlspecialchars(text.substring(0, offset)).replace(/(?:\\r\\n|\\r|\\n)/g, '<br>') + \"&hellip;&nbsp;\" ,\n\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-letter-more\", href: \"#\" },\n\t\t\t\t\t\tevents: { click: clickHandler },\n\t\t\t\t\t\ttext: this.getMessage(\"details\")\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t]\n\t\t);\n\t}\n\n\tprepareCutOffElements(text, length, clickHandler)\n\t{\n\t\tif(!BX.type.isNumber(length))\n\t\t{\n\t\t\tlength = 0;\n\t\t}\n\n\t\tif(length <= 0 || text.length <= length)\n\t\t{\n\t\t\treturn [BX.util.htmlspecialchars(text)];\n\t\t}\n\n\t\tlet offset = length - 1;\n\t\tconst whilespaceOffset = text.substring(offset).search(/\\s/i);\n\t\tif(whilespaceOffset > 0)\n\t\t{\n\t\t\toffset += whilespaceOffset;\n\t\t}\n\t\treturn(\n\t\t\t[\n\t\t\t\tBX.util.htmlspecialchars(text.substring(0, offset)) + \"&hellip;&nbsp;\" ,\n\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-letter-more\", href: \"#\" },\n\t\t\t\t\t\tevents: { click: clickHandler },\n\t\t\t\t\t\ttext: this.getMessage(\"details\")\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t]\n\t\t);\n\t}\n\n\tprepareAuthorLayout()\n\t{\n\t\tconst authorInfo = this.getObjectDataParam(\"AUTHOR\", null);\n\t\tif(!authorInfo)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst showUrl = BX.prop.getString(authorInfo, \"SHOW_URL\", \"\");\n\t\tif(showUrl === \"\")\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst link = BX.create(\"A\",\n\t\t\t{\n\t\t\t\tattrs:\n\t\t\t\t\t{\n\t\t\t\t\t\tclassName: \"ui-icon ui-icon-common-user crm-entity-stream-content-detail-employee\",\n\t\t\t\t\t\thref: showUrl,\n\t\t\t\t\t\ttarget: \"_blank\",\n\t\t\t\t\t\ttitle: BX.prop.getString(authorInfo, \"FORMATTED_NAME\", \"\")\n\t\t\t\t\t},\n\t\t\t\tchildren: [\n\t\t\t\t\tBX.create('i', {})\n\t\t\t\t]\n\t\t\t}\n\t\t);\n\t\tconst imageUrl = BX.prop.getString(authorInfo, \"IMAGE_URL\", \"\");\n\t\tif(imageUrl !== \"\")\n\t\t{\n\t\t\tlink.children[0].style.backgroundImage = \"url('\" + encodeURI(imageUrl) + \"')\";\n\t\t\tlink.children[0].style.backgroundSize = \"21px\";\n\t\t}\n\n\t\treturn link;\n\t}\n\n\tonActivityCreate(activity, data)\n\t{\n\t}\n\n\tisContextMenuEnabled()\n\t{\n\t\treturn false;\n\t}\n\n\tprepareContextMenuButton()\n\t{\n\t\tthis._contextMenuButton = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: { className: \"crm-entity-stream-section-context-menu\" },\n\t\t\t\tevents: { click: BX.delegate(this.onContextMenuButtonClick, this) }\n\t\t\t}\n\t\t);\n\t\treturn this._contextMenuButton;\n\t}\n\n\tonContextMenuButtonClick(e)\n\t{\n\t\tif(!this._isContextMenuShown)\n\t\t{\n\t\t\tthis.openContextMenu();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.closeContextMenu();\n\t\t}\n\t}\n\n\topenContextMenu()\n\t{\n\t\tconst menuItems = this.prepareContextMenuItems();\n\n\t\tif (typeof IntranetExtensions !== \"undefined\")\n\t\t{\n\t\t\tmenuItems.push(IntranetExtensions);\n\t\t}\n\n\t\tif(menuItems.length === 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tBX.PopupMenu.show(\n\t\t\tthis._id,\n\t\t\tthis._contextMenuButton,\n\t\t\tmenuItems,\n\t\t\t{\n\t\t\t\toffsetTop: 0,\n\t\t\t\toffsetLeft: 16,\n\t\t\t\tangle: { position: \"top\", offset: 0 },\n\t\t\t\tevents:\n\t\t\t\t\t{\n\t\t\t\t\t\tonPopupShow: BX.delegate(this.onContextMenuShow, this),\n\t\t\t\t\t\tonPopupClose: BX.delegate(this.onContextMenuClose, this),\n\t\t\t\t\t\tonPopupDestroy: BX.delegate(this.onContextMenuDestroy, this)\n\t\t\t\t\t}\n\t\t\t}\n\t\t);\n\t\tthis._contextMenu = BX.PopupMenu.currentItem;\n\t}\n\n\tcloseContextMenu()\n\t{\n\t\tif(this._contextMenu)\n\t\t{\n\t\t\tthis._contextMenu.close();\n\t\t}\n\t}\n\n\tprepareContextMenuItems()\n\t{\n\t\treturn [];\n\t}\n\n\tonContextMenuShow()\n\t{\n\t\tthis._isContextMenuShown = true;\n\t\tBX.addClass(this._contextMenuButton, \"active\");\n\t}\n\n\tonContextMenuClose()\n\t{\n\t\tif(this._contextMenu)\n\t\t{\n\t\t\tthis._contextMenu.popupWindow.destroy();\n\t\t}\n\t}\n\n\tonContextMenuDestroy()\n\t{\n\t\tthis._isContextMenuShown = false;\n\t\tBX.removeClass(this._contextMenuButton, \"active\");\n\t\tthis._contextMenu = null;\n\n\t\tif(typeof(BX.PopupMenu.Data[this._id]) !== \"undefined\")\n\t\t{\n\t\t\tdelete(BX.PopupMenu.Data[this._id]);\n\t\t}\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = CompatibleItem.messages;\n\t\treturn m.hasOwnProperty(name) ? m[name] : name;\n\t}\n\n\tstatic getUserTimezoneOffset()\n\t{\n\t\treturn TimezoneOffset.USER_TO_SERVER;\n\t}\n\n\tstatic messages = {};\n}\n","/** @memberof BX.Crm.Timeline.Animation */\nexport default class Fasten\n{\n\tconstructor()\n\t{\n\t\tthis._id = \"\";\n\t\tthis._settings = {};\n\t\tthis._initialItem = null;\n\t\tthis._finalItem = null;\n\t\tthis._events = null;\n\t}\n\n\tinitialize(id, settings)\n\t{\n\t\tthis._id = BX.type.isNotEmptyString(id) ? id : BX.util.getRandomString(4);\n\t\tthis._settings = settings ? settings : {};\n\n\t\tthis._initialItem = this.getSetting(\"initialItem\");\n\t\tthis._finalItem = this.getSetting(\"finalItem\");\n\n\t\tthis._anchor = this.getSetting(\"anchor\");\n\t\tthis._events = this.getSetting(\"events\", {});\n\t}\n\n\tgetId()\n\t{\n\t\treturn this._id;\n\t}\n\n\tgetSetting(name, defaultValue)\n\t{\n\t\treturn this._settings.hasOwnProperty(name) ? this._settings[name] : defaultValue;\n\t}\n\n\taddFixedHistoryItem()\n\t{\n\t\tconst node = this._finalItem.getWrapper();\n\t\tBX.addClass(node, 'crm-entity-stream-section-animate-start');\n\t\tif (this._anchor.parentNode && node)\n\t\t{\n\t\t\tthis._anchor.parentNode.insertBefore(node, this._anchor.nextSibling);\n\t\t}\n\t\tsetTimeout( BX.delegate(\n\t\t\tfunction() {\n\t\t\t\tBX.removeClass(node, 'crm-entity-stream-section-animate-start');\n\t\t\t},\n\t\t\tthis\n\t\t), 0);\n\t}\n\n\trun()\n\t{\n\t\tconst node = this._initialItem.getWrapper();\n\t\tthis._clone = node.cloneNode(true);\n\n\t\tBX.addClass(this._clone, 'crm-entity-stream-section-animate-start crm-entity-stream-section-top-fixed');\n\n\t\tthis._startPosition = BX.pos(node);\n\t\tthis._clone.style.position = \"absolute\";\n\t\tthis._clone.style.width = this._startPosition.width + \"px\";\n\n\t\tlet _cloneHeight = this._startPosition.height;\n\t\tconst _minHeight = 65;\n\t\tconst _sumPaddingContent = 18;\n\t\tif (_cloneHeight < _sumPaddingContent + _minHeight)\n\t\t\t_cloneHeight = _sumPaddingContent + _minHeight;\n\n\t\tthis._clone.style.height = _cloneHeight + \"px\";\n\t\tthis._clone.style.top = this._startPosition.top + \"px\";\n\t\tthis._clone.style.left = this._startPosition.left + \"px\";\n\t\tthis._clone.style.zIndex = 960;\n\n\t\tdocument.body.appendChild(this._clone);\n\n\t\tsetTimeout(\n\t\t\tBX.proxy(\n\t\t\t\tfunction (){\n\t\t\t\t\tBX.addClass(this._clone, \"crm-entity-stream-section-casper\" )\n\t\t\t\t},\n\t\t\t\tthis\n\t\t\t),\n\t\t\t0\n\t\t);\n\n\t\tthis._anchorPosition = BX.pos(this._anchor);\n\t\tconst finish = {\n\t\t\ttop: this._anchorPosition.top,\n\t\t\theight: _cloneHeight + 15,\n\t\t\topacity: 1\n\t\t};\n\n\t\tconst _difference = this._startPosition.top - this._anchorPosition.bottom;\n\t\tconst _deepHistoryLimit = 2 * (document.body.clientHeight + this._startPosition.height);\n\n\t\tif (_difference > _deepHistoryLimit)\n\t\t{\n\t\t\tfinish.top = this._startPosition.top - _deepHistoryLimit;\n\t\t\tfinish.opacity = 0;\n\t\t}\n\n\t\tlet _duration = Math.abs(finish.top - this._startPosition.top) * 2;\n\t\t_duration = (_duration < 1500) ? 1500 : _duration;\n\n\t\tconst movingEvent = new BX.easing({\n\t\t\tduration: _duration,\n\t\t\tstart: {top: this._startPosition.top, height: 0, opacity: 1},\n\t\t\tfinish: finish,\n\t\t\ttransition: BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\tstep: BX.proxy(function (state) {\n\t\t\t\tthis._clone.style.top = state.top + \"px\";\n\t\t\t\tthis._clone.style.opacity = state.opacity;\n\t\t\t\tthis._anchor.style.height = state.height + \"px\";\n\t\t\t}, this),\n\t\t\tcomplete: BX.proxy(function () {\n\t\t\t\tthis.finish();\n\t\t\t}, this)\n\t\t});\n\t\tmovingEvent.animate();\n\t}\n\n\tfinish()\n\t{\n\t\tthis._anchor.style.height = 0;\n\t\tthis.addFixedHistoryItem();\n\t\tBX.remove(this._clone);\n\n\t\tif(BX.type.isFunction(this._events[\"complete\"]))\n\t\t{\n\t\t\tthis._events[\"complete\"]();\n\t\t}\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Fasten();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import CompatibleItem from \"./compatible-item\";\nimport {Item as ItemType} from \"../types\";\nimport Fasten from \"../animations/fasten\";\nimport {DatetimeConverter} from \"crm.timeline.tools\";\nimport {Type, Dom} from \"main.core\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class History extends CompatibleItem\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._history = null;\n\t\tthis._fixedHistory = null;\n\t\tthis._typeId = null;\n\t\tthis._createdTime = null;\n\t\tthis._isFixed = false;\n\t\tthis._headerClickHandler = BX.delegate(this.onHeaderClick, this);\n\t}\n\n\tdoInitialize()\n\t{\n\t\tthis._history = this.getSetting(\"history\");\n\t\tthis._fixedHistory = this.getSetting(\"fixedHistory\");\n\t}\n\n\tgetTypeId()\n\t{\n\t\tif(this._typeId === null)\n\t\t{\n\t\t\tthis._typeId = BX.prop.getInteger(this._data, \"TYPE_ID\", ItemType.undefined);\n\t\t}\n\t\treturn this._typeId;\n\t}\n\n\tgetTitle()\n\t{\n\t\treturn \"\";\n\t}\n\n\tisContextMenuEnabled()\n\t{\n\t\treturn !(this.isReadOnly());\n\t}\n\n\tgetCreatedTimestamp()\n\t{\n\t\treturn this.getTextDataParam(\"CREATED_SERVER\");\n\t}\n\n\tgetCreatedTime()\n\t{\n\t\tif(this._createdTime === null)\n\t\t{\n\t\t\tconst time = BX.parseDate(\n\t\t\t\tthis.getCreatedTimestamp(),\n\t\t\t\tfalse,\n\t\t\t\t\"YYYY-MM-DD\",\n\t\t\t\t\"YYYY-MM-DD HH:MI:SS\"\n\t\t\t);\n\n\t\t\tthis._createdTime = (new DatetimeConverter(time)).toUserTime().getValue();\n\t\t}\n\t\treturn this._createdTime;\n\t}\n\n\tgetCreatedDate()\n\t{\n\t\treturn BX.prop.extractDate(new Date(this.getCreatedTime().getTime()));\n\t}\n\n\tgetOwnerInfo()\n\t{\n\t\treturn this._history ? this._history.getOwnerInfo() : null;\n\t}\n\n\tgetOwnerTypeId()\n\t{\n\t\treturn BX.prop.getInteger(this.getOwnerInfo(), \"ENTITY_TYPE_ID\", BX.CrmEntityType.enumeration.undefined);\n\t}\n\n\tgetOwnerId()\n\t{\n\t\treturn BX.prop.getInteger(this.getOwnerInfo(), \"ENTITY_ID\", 0);\n\t}\n\n\tisReadOnly()\n\t{\n\t\treturn this._history.isReadOnly();\n\t}\n\n\tisEditable()\n\t{\n\t\treturn !this.isReadOnly();\n\t}\n\n\tisDone()\n\t{\n\t\tconst typeId = this.getTypeId();\n\t\tif(typeId === ItemType.activity)\n\t\t{\n\t\t\tconst entityData = this.getAssociatedEntityData();\n\t\t\treturn BX.CrmActivityStatus.isFinal(BX.prop.getInteger(entityData, \"STATUS\", 0));\n\t\t}\n\t\treturn false;\n\t}\n\n\tisFixed()\n\t{\n\t\treturn this._isFixed;\n\t}\n\n\t/**\n\t * deprecated\n\t */\n\tfasten(e)\n\t{\n\t\tif (this._fixedHistory._items.length >= 3)\n\t\t{\n\t\t\tif (!this.fastenLimitPopup)\n\t\t\t{\n\t\t\t\tthis.fastenLimitPopup = new BX.PopupWindow(\n\t\t\t\t\t'timeline_fasten_limit_popup_' + this._id,\n\t\t\t\t\tthis._switcher,\n\t\t\t\t\t{\n\t\t\t\t\t\tcontent: BX.message('CRM_TIMELINE_FASTEN_LIMIT_MESSAGE'),\n\t\t\t\t\t\tdarkMode: true,\n\t\t\t\t\t\tautoHide: true,\n\t\t\t\t\t\tzIndex: 990,\n\t\t\t\t\t\tangle: true,\n\t\t\t\t\t\tcloseByEsc: true,\n\t\t\t\t\t\tbindOptions: { forceBindPosition: true}\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tthis.fastenLimitPopup.show();\n\t\t\tthis.closeContextMenu();\n\t\t\treturn;\n\t\t}\n\t\tBX.ajax(\n\t\t\t{\n\t\t\t\turl: this._history._serviceUrl,\n\t\t\t\tmethod: \"POST\",\n\t\t\t\tdataType: \"json\",\n\t\t\t\tdata:\n\t\t\t\t\t{\n\t\t\t\t\t\t\"ACTION\": \"CHANGE_FASTEN_ITEM\",\n\t\t\t\t\t\t\"VALUE\": 'Y',\n\t\t\t\t\t\t\"OWNER_TYPE_ID\":  this.getOwnerTypeId(),\n\t\t\t\t\t\t\"OWNER_ID\": this.getOwnerId(),\n\t\t\t\t\t\t\"ID\": this._id\n\t\t\t\t\t},\n\t\t\t}\n\t\t);\n\n\t\tthis.closeContextMenu();\n\t}\n\n\t/**\n\t * deprecated\n\t */\n\tonSuccessFasten(result)\n\t{\n\t\tif (result && BX.type.isNotEmptyString(result.ERROR))\n\t\t\treturn;\n\n\t\tif (!this.isFixed())\n\t\t{\n\t\t\tthis._data.IS_FIXED = 'Y';\n\t\t\tconst fixedItem = this._fixedHistory.createItem(this._data);\n\t\t\tfixedItem._isFixed = true;\n\t\t\tthis._fixedHistory.addItem(fixedItem, 0);\n\t\t\tfixedItem.layout({ add: false });\n\t\t\tthis.refreshLayout();\n\t\t\tconst animation = Fasten.create(\n\t\t\t\t\"\",\n\t\t\t\t{\n\t\t\t\t\tinitialItem: this,\n\t\t\t\t\tfinalItem: fixedItem,\n\t\t\t\t\tanchor: this._fixedHistory._anchor\n\t\t\t\t}\n\t\t\t);\n\t\t\tanimation.run();\n\t\t}\n\n\t\tthis.closeContextMenu();\n\t}\n\n\t/**\n\t * deprecated\n\t */\n\tunfasten(e)\n\t{\n\t\tBX.ajax(\n\t\t\t{\n\t\t\t\turl: this._history._serviceUrl,\n\t\t\t\tmethod: \"POST\",\n\t\t\t\tdataType: \"json\",\n\t\t\t\tdata:\n\t\t\t\t\t{\n\t\t\t\t\t\t\"ACTION\": \"CHANGE_FASTEN_ITEM\",\n\t\t\t\t\t\t\"VALUE\": 'N',\n\t\t\t\t\t\t\"OWNER_TYPE_ID\": this.getOwnerTypeId(),\n\t\t\t\t\t\t\"OWNER_ID\": this.getOwnerId(),\n\t\t\t\t\t\t\"ID\": this._id\n\t\t\t\t\t},\n\t\t\t}\n\t\t);\n\n\t\tthis.closeContextMenu();\n\t}\n\n\t/**\n\t * deprecated\n\t */\n\tonSuccessUnfasten(result)\n\t{\n\t\tif (result && BX.type.isNotEmptyString(result.ERROR))\n\t\t\treturn;\n\n\t\tlet item;\n\t\tlet historyItem;\n\n\t\tif (this.isFixed())\n\t\t{\n\t\t\titem = this;\n\t\t\thistoryItem = this._history.findItemById(this._id);\n\t\t}\n\t\telse\n\t\t{\n\t\t\titem = this._fixedHistory.findItemById(this._id);\n\t\t\thistoryItem = this;\n\t\t}\n\n\t\tif (item)\n\t\t{\n\t\t\tconst index = this._fixedHistory.getItemIndex(item);\n\t\t\titem.clearAnimate();\n\t\t\tthis._fixedHistory.removeItemByIndex(index);\n\t\t\tif (historyItem)\n\t\t\t{\n\t\t\t\thistoryItem._data.IS_FIXED = 'N';\n\t\t\t\thistoryItem.refreshLayout();\n\t\t\t\tBX.LazyLoad.showImages();\n\t\t\t}\n\t\t}\n\t}\n\n\tclearAnimate()\n\t{\n\t\tif (!BX.type.isDomNode(this._wrapper))\n\t\t\treturn ;\n\n\t\tconst wrapperPosition = BX.pos(this._wrapper);\n\t\tconst hideEvent = new BX.easing({\n\t\t\tduration: 1000,\n\t\t\tstart: {height: wrapperPosition.height, opacity: 1, marginBottom: 15},\n\t\t\tfinish: {height: 0, opacity: 0, marginBottom: 0},\n\t\t\ttransition: BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\tstep: BX.proxy(function (state) {\n\t\t\t\tthis._wrapper.style.height = state.height + \"px\";\n\t\t\t\tthis._wrapper.style.opacity = state.opacity;\n\t\t\t\tthis._wrapper.style.marginBottom = state.marginBottom;\n\t\t\t}, this),\n\t\t\tcomplete: BX.proxy(function () {\n\t\t\t\tthis.clearLayout();\n\t\t\t}, this)\n\t\t});\n\n\t\thideEvent.animate();\n\t}\n\n\tgetWrapperClassName()\n\t{\n\t\treturn \"\";\n\t}\n\n\tgetIconClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-icon crm-entity-stream-section-icon-info\";\n\t}\n\n\tprepareContentDetails()\n\t{\n\t\treturn [];\n\t}\n\n\tprepareContent()\n\t{\n\t\tlet wrapperClassName = this.getWrapperClassName();\n\t\tif(wrapperClassName !== \"\")\n\t\t{\n\t\t\twrapperClassName = \"crm-entity-stream-section crm-entity-stream-section-history\" + \" \" + wrapperClassName;\n\t\t}\n\t\telse\n\t\t{\n\t\t\twrapperClassName = \"crm-entity-stream-section crm-entity-stream-section-history\";\n\t\t}\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: wrapperClassName}});\n\t\twrapper.appendChild(BX.create(\"DIV\", { attrs: { className: this.getIconClassName() } }));\n\n\t\tif (this.isContextMenuEnabled())\n\t\t{\n\t\t\tDom.append(this.prepareContextMenuButton(), wrapper);\n\t\t}\n\n\t\tconst contentWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{ attrs: { className: \"crm-entity-stream-section-content\" }, children: [ contentWrapper ] }\n\t\t\t)\n\t\t);\n\n\t\tconst header = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-header\"},\n\t\t\t\tchildren:\n\t\t\t\t\t[\n\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-event-title\"},\n\t\t\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tattrs: {href: \"#\"},\n\t\t\t\t\t\t\t\t\t\t\t\tevents: {click: this._headerClickHandler},\n\t\t\t\t\t\t\t\t\t\t\t\ttext: this.getTitle()\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t),\n\t\t\t\t\t\tBX.create(\"SPAN\",\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-event-time\"},\n\t\t\t\t\t\t\t\ttext: this.formatTime(this.getCreatedTime())\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t)\n\t\t\t\t\t]\n\t\t\t}\n\t\t);\n\n\t\tcontentWrapper.appendChild(header);\n\n\t\tcontentWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail\" },\n\t\t\t\t\tchildren: this.prepareContentDetails()\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontentWrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\treturn wrapper;\n\t}\n\n\tprepareLayout(options)\n\t{\n\t\tthis._wrapper = this.prepareContent();\n\t\tif(this._wrapper)\n\t\t{\n\t\t\tconst enableAdd = BX.type.isPlainObject(options) ? BX.prop.getBoolean(options, \"add\", true) : true;\n\t\t\tif(enableAdd)\n\t\t\t{\n\t\t\t\tconst anchor = BX.type.isPlainObject(options) && BX.type.isElementNode(options[\"anchor\"]) ? options[\"anchor\"] : null;\n\t\t\t\tif(anchor && anchor.nextSibling)\n\t\t\t\t{\n\t\t\t\t\tthis._container.insertBefore(this._wrapper,  anchor.nextSibling);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis._container.appendChild(this._wrapper);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.markAsTerminated(this._history.checkItemForTermination(this));\n\t\t}\n\t}\n\n\tonHeaderClick(e)\n\t{\n\t\tthis.view();\n\t\te.preventDefault ? e.preventDefault() : (e.returnValue = false);\n\t}\n\n\tprepareTitleLayout()\n\t{\n\t\treturn BX.create(\"SPAN\", { attrs: { className: \"crm-entity-stream-content-event-title\" }, text: this.getTitle() });\n\t}\n\n\tprepareFixedSwitcherLayout()\n\t{\n\t\tconst isFixed = (this.getTextDataParam(\"IS_FIXED\") === 'Y');\n\t\tthis._switcher = BX.create(\"span\",\n\t\t\t{\n\t\t\t\tattrs: { className: \"crm-entity-stream-section-top-fixed-btn\" },\n\t\t\t\tevents: {\n\t\t\t\t\tclick: isFixed ? BX.delegate(this.unfasten, this) : BX.delegate(this.fasten, this)\n\t\t\t\t}\n\t\t\t});\n\t\tif (isFixed)\n\t\t\tBX.addClass(this._switcher, \"crm-entity-stream-section-top-fixed-btn-active\");\n\n\t\tif (!this.isReadOnly() && !isFixed)\n\t\t{\n\t\t\tconst manager = this._history.getManager();\n\t\t\tif (!manager.isSpotlightShowed())\n\t\t\t{\n\t\t\t\tmanager.setSpotlightShowed();\n\t\t\t\tBX.addClass(this._switcher, \"crm-entity-stream-section-top-fixed-btn-spotlight\");\n\t\t\t\tconst spotlight = new BX.SpotLight({\n\t\t\t\t\ttargetElement: this._switcher,\n\t\t\t\t\ttargetVertex: \"middle-center\",\n\t\t\t\t\tlightMode: false,\n\t\t\t\t\tid: \"CRM_TIMELINE_FASTEN_SWITCHER\",\n\t\t\t\t\tzIndex: 900,\n\t\t\t\t\ttop: -3,\n\t\t\t\t\tleft: -1,\n\t\t\t\t\tautoSave: true,\n\t\t\t\t\tcontent: BX.message('CRM_TIMELINE_SPOTLIGHT_FASTEN_MESSAGE')\n\t\t\t\t});\n\t\t\t\tspotlight.show();\n\t\t\t}\n\t\t}\n\n\t\treturn this._switcher;\n\t}\n\n\tprepareHeaderLayout()\n\t{\n\t\tconst header = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-header\"}});\n\t\theader.appendChild(this.prepareTitleLayout());\n\n\t\tconst statusNode = this.getStatusNode();\n\t\tif (Type.isDomNode(statusNode))\n\t\t{\n\t\t\tDom.append(statusNode, header);\n\t\t}\n\n\t\theader.appendChild(\n\t\t\tBX.create(\"SPAN\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-event-time\" },\n\t\t\t\t\ttext: this.formatTime(this.getCreatedTime())\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\treturn header;\n\t}\n\n\tgetStatusNode(): ?HTMLElement\n\t{\n\t\treturn null;\n\t}\n\n\tonActivityCreate(activity, data)\n\t{\n\t\tthis._history.getManager().onActivityCreated(activity, data);\n\t}\n\n\tformatTime(time)\n\t{\n\t\tif (this.isFixed())\n\t\t{\n\t\t\treturn this._fixedHistory.formatTime(time);\n\t\t}\n\n\t\treturn this._history.formatTime(time);\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new History();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n\n\tstatic isCounterEnabled(deadline)\n\t{\n\t\tif(!BX.type.isDate(deadline))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tlet start = new Date();\n\t\tstart.setHours(0);\n\t\tstart.setMinutes(0);\n\t\tstart.setSeconds(0);\n\t\tstart.setMilliseconds(0);\n\t\tstart = start.getTime();\n\n\t\tlet end = new Date();\n\t\tend.setHours(23);\n\t\tend.setMinutes(59);\n\t\tend.setSeconds(59);\n\t\tend.setMilliseconds(999);\n\t\tend = end.getTime();\n\n\t\tconst time = deadline.getTime();\n\t\treturn time < start || (time >= start && time <= end);\n\t}\n}\n","import CompatibleItem from \"./compatible-item\";\nimport History from \"./history\";\nimport {Item as ItemType} from \"../types\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Scheduled extends CompatibleItem\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._schedule = null;\n\t\tthis._deadlineNode = null;\n\n\t\tthis._headerClickHandler = BX.delegate(this.onHeaderClick, this);\n\t\tthis._setAsDoneButtonHandler = BX.delegate(this.onSetAsDoneButtonClick, this);\n\t}\n\n\tdoInitialize()\n\t{\n\t\tthis._schedule = this.getSetting(\"schedule\");\n\t\tif(!(this._activityEditor instanceof BX.CrmActivityEditor))\n\t\t{\n\t\t\tthrow \"Scheduled. The field 'activityEditor' is not assigned.\";\n\t\t}\n\n\t\tif(this.hasPermissions() && !this.verifyPermissions())\n\t\t{\n\t\t\tthis.loadPermissions();\n\t\t}\n\t}\n\n\tgetTypeId()\n\t{\n\t\treturn ItemType.undefined;\n\t}\n\n\tverifyPermissions()\n\t{\n\t\tconst userId = BX.prop.getInteger(this.getPermissions(), \"USER_ID\", 0);\n\t\treturn userId <= 0 || userId === this._schedule.getUserId();\n\t}\n\n\tloadPermissions()\n\t{\n\t\tBX.ajax(\n\t\t\t{\n\t\t\t\turl: this._schedule.getServiceUrl(),\n\t\t\t\tmethod: \"POST\",\n\t\t\t\tdataType: \"json\",\n\t\t\t\tdata: { \"ACTION\": \"GET_PERMISSIONS\", \"TYPE_ID\": this.getTypeId(), \"ID\": this.getAssociatedEntityId() },\n\t\t\t\tonsuccess: this.onPermissionsLoad.bind(this)\n\t\t\t}\n\t\t);\n\t}\n\n\tonPermissionsLoad(result)\n\t{\n\t\tconst permissions = BX.prop.getObject(result, \"PERMISSIONS\", null);\n\t\tif(!permissions)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.setPermissions(permissions);\n\t\twindow.setTimeout(function(){ this.refreshLayout(); }.bind(this), 0);\n\t}\n\n\tgetDeadline()\n\t{\n\t\treturn null;\n\t}\n\n\thasDeadline()\n\t{\n\t\treturn BX.type.isDate(this.getDeadline());\n\t}\n\n\tisCounterEnabled()\n\t{\n\t\tif (this.isDone())\n\t\t{\n\t\t\treturn this._existedStreamItemDeadLine && History.isCounterEnabled(this._existedStreamItemDeadLine);\n\t\t}\n\n\t\tconst deadline = this.getDeadline();\n\n\t\treturn deadline && History.isCounterEnabled(deadline);\n\t}\n\n\tisIncomingChannel()\n\t{\n\t\treturn false;\n\t}\n\n\tgetSourceId()\n\t{\n\t\treturn BX.prop.getInteger(this.getAssociatedEntityData(), \"ID\", 0);\n\t}\n\n\tonSetAsDoneCompleted(data)\n\t{\n\t\tif(!BX.prop.getBoolean(data, \"COMPLETED\"))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.markAsDone(true);\n\t\tthis._schedule.onItemMarkedAsDone(\n\t\t\tthis,\n\t\t\t{ 'historyItemData': BX.prop.getObject(data, \"HISTORY_ITEM\") }\n\t\t);\n\t}\n\n\tonPosponeCompleted(data)\n\t{\n\t}\n\n\trefreshDeadline()\n\t{\n\t\tthis._deadlineNode.innerHTML = this.formatDateTime(this.getDeadline());\n\t}\n\n\tformatDateTime(time)\n\t{\n\t\treturn this._schedule.formatDateTime(time);\n\t}\n\n\tgetWrapperClassName()\n\t{\n\t\treturn \"\";\n\t}\n\n\tgetIconClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-icon\";\n\t}\n\n\tisReadOnly()\n\t{\n\t\treturn this._schedule.isReadOnly();\n\t}\n\n\tisEditable()\n\t{\n\t\treturn !this.isReadOnly();\n\t}\n\n\tcanPostpone()\n\t{\n\t\tif(this.isReadOnly())\n\t\t{\n\t\t\treturn false;\n\t\t}\n\t\tif (this.isIncomingChannel())\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst perms = BX.prop.getObject(this.getAssociatedEntityData(), \"PERMISSIONS\", {});\n\t\treturn BX.prop.getBoolean(perms, \"POSTPONE\", false);\n\t}\n\n\tisDone()\n\t{\n\t\treturn BX.CrmActivityStatus.isFinal(\n\t\t\tBX.prop.getInteger(this.getAssociatedEntityData(), \"STATUS\", 0)\n\t\t);\n\t}\n\n\tcanComplete()\n\t{\n\t\tif(this.isReadOnly())\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst perms = BX.prop.getObject(this.getAssociatedEntityData(), \"PERMISSIONS\", {});\n\t\treturn BX.prop.getBoolean(perms, \"COMPLETE\", false);\n\t}\n\n\tsetAsDone(isDone)\n\t{\n\t}\n\n\tprepareContent(options)\n\t{\n\t\treturn null;\n\t}\n\n\tprepareLayout(options)\n\t{\n\t\tthis._wrapper = this.prepareContent();\n\t\tif(this._wrapper)\n\t\t{\n\t\t\tconst enableAdd = BX.type.isPlainObject(options) ? BX.prop.getBoolean(options, \"add\", true) : true;\n\t\t\tif(enableAdd)\n\t\t\t{\n\t\t\t\tconst anchor = BX.type.isPlainObject(options) && BX.type.isElementNode(options[\"anchor\"]) ? options[\"anchor\"] : null;\n\t\t\t\tif(anchor && anchor.nextSibling)\n\t\t\t\t{\n\t\t\t\t\tthis._container.insertBefore(this._wrapper, anchor.nextSibling);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis._container.appendChild(this._wrapper);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.markAsTerminated(this._schedule.checkItemForTermination(this));\n\t\t}\n\t}\n\n\tonHeaderClick(e)\n\t{\n\t\tthis.view();\n\t\te.preventDefault ? e.preventDefault() : (e.returnValue = false);\n\t}\n\n\tonSetAsDoneButtonClick(e)\n\t{\n\t\tif(this.canComplete())\n\t\t{\n\t\t\tthis.setAsDone(!this.isDone());\n\t\t}\n\t}\n\n\tonActivityCreate(activity, data)\n\t{\n\t\tthis._schedule.getManager().onActivityCreated(activity, data);\n\t}\n\n\tstatic isDone(data)\n\t{\n\t\tconst entityData = BX.prop.getObject(data, \"ASSOCIATED_ENTITY\", {});\n\t\treturn BX.CrmActivityStatus.isFinal(BX.prop.getInteger(entityData, \"STATUS\", 0));\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Scheduled();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","/** @memberof BX.Crm.Timeline */\nexport default class Action\n{\n\tconstructor()\n\t{\n\t\tthis._id = \"\";\n\t\tthis._settings = {};\n\t\tthis._container = null;\n\t}\n\n\tinitialize(id, settings)\n\t{\n\t\tthis._id = BX.type.isNotEmptyString(id) ? id : BX.util.getRandomString(4);\n\t\tthis._settings = settings ? settings : {};\n\n\t\tthis._container = this.getSetting(\"container\");\n\t\tif(!BX.type.isElementNode(this._container))\n\t\t{\n\t\t\tthrow \"BX.CrmTimelineAction: Could not find container.\";\n\t\t}\n\n\t\tthis.doInitialize();\n\t}\n\n\tdoInitialize()\n\t{\n\t}\n\n\tgetId()\n\t{\n\t\treturn this._id;\n\t}\n\n\tgetSetting(name, defaultval)\n\t{\n\t\treturn this._settings.hasOwnProperty(name) ? this._settings[name] : defaultval;\n\t}\n\n\tlayout()\n\t{\n\t\tthis.doLayout();\n\t}\n\n\tdoLayout()\n\t{\n\t}\n}\n","import Action from \"../action\";\n\n/** @memberof BX.Crm.Timeline.Actions */\nexport default class Activity extends Action\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._activityEditor = null;\n\t\tthis._entityData = null;\n\t\tthis._item = null;\n\t\tthis._isEnabled = true;\n\t}\n\n\tdoInitialize()\n\t{\n\t\tthis._entityData = this.getSetting(\"entityData\");\n\t\tif(!BX.type.isPlainObject(this._entityData))\n\t\t{\n\t\t\tthrow \"BX.Crm.Timeline.Actions.Activity. A required parameter 'entityData' is missing.\";\n\t\t}\n\n\t\tthis._activityEditor = this.getSetting(\"activityEditor\");\n\t\tif(!(this._activityEditor instanceof BX.CrmActivityEditor))\n\t\t{\n\t\t\tthrow \"BX.Crm.Timeline.Actions.Activity. A required parameter 'activityEditor' is missing.\";\n\t\t}\n\n\t\tthis._item = this.getSetting(\"item\");\n\t\tthis._isEnabled = this.getSetting(\"enabled\", true);\n\t}\n\n\tgetActivityId()\n\t{\n\t\treturn BX.prop.getInteger(this._entityData, \"ID\", 0);\n\t}\n\n\tloadActivityCommunications(callback)\n\t{\n\t\tthis._activityEditor.getActivityCommunications(\n\t\t\tthis.getActivityId(),\n\t\t\tfunction(communications)\n\t\t\t{\n\t\t\t\tif(BX.type.isFunction(callback))\n\t\t\t\t{\n\t\t\t\t\tcallback(communications);\n\t\t\t\t}\n\t\t\t},\n\t\t\ttrue\n\t\t);\n\t}\n\n\tgetItemData()\n\t{\n\t\treturn this._item ?  this._item.getData() : null;\n\t}\n}\n","import Activity from \".//activity\";\n\n/** @memberof BX.Crm.Timeline.Actions */\nexport class Email extends Activity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._clickHandler = BX.delegate(this.onClick, this);\n\t\tthis._saveHandler = BX.delegate(this.onSave, this);\n\t}\n\n\tonClick(e)\n\t{\n\t\tconst settings =\n\t\t\t{\n\t\t\t\t\"ownerType\": BX.CrmEntityType.resolveName(BX.prop.getInteger(this._entityData, \"OWNER_TYPE_ID\", 0)),\n\t\t\t\t\"ownerID\": BX.prop.getInteger(this._entityData, \"OWNER_ID\", 0),\n\t\t\t\t\"ownerUrl\": BX.prop.getString(this._entityData, \"OWNER_URL\", \"\"),\n\t\t\t\t\"ownerTitle\": BX.prop.getString(this._entityData, \"OWNER_TITLE\", \"\"),\n\t\t\t\t\"originalMessageID\": BX.prop.getInteger(this._entityData, \"ID\", 0),\n\t\t\t\t\"messageType\": \"RE\"\n\t\t\t};\n\n\t\tif (BX.CrmActivityProvider && top.BX.Bitrix24 && top.BX.Bitrix24.Slider)\n\t\t{\n\t\t\tconst activity = this._activityEditor.addEmail(settings);\n\t\t\tactivity.addOnSave(this._saveHandler);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.loadActivityCommunications(\n\t\t\t\tBX.delegate(\n\t\t\t\t\tfunction(communications)\n\t\t\t\t\t{\n\t\t\t\t\t\tsettings['communications'] = BX.type.isArray(communications) ? communications : [];\n\t\t\t\t\t\tsettings['communicationsLoaded'] = true;\n\n\t\t\t\t\t\tBX.CrmActivityEmail.prepareReply(settings);\n\n\t\t\t\t\t\tconst activity = this._activityEditor.addEmail(settings);\n\t\t\t\t\t\tactivity.addOnSave(this._saveHandler);\n\t\t\t\t\t},\n\t\t\t\t\tthis\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\t\treturn BX.PreventDefault(e);\n\t}\n\n\tonSave(activity, data)\n\t{\n\t\tif(BX.type.isFunction(this._item.onActivityCreate))\n\t\t{\n\t\t\tthis._item.onActivityCreate(activity, data);\n\t\t}\n\t}\n}\n\n/** @memberof BX.Crm.Timeline.Actions */\nexport class HistoryEmail extends Email\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tdoLayout()\n\t{\n\t\tthis._container.appendChild(\n\t\t\tBX.create(\"A\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-action-reply-btn\" },\n\t\t\t\t\tevents: { \"click\": this._clickHandler }\n\t\t\t\t})\n\t\t);\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new HistoryEmail();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n\n/** @memberof BX.Crm.Timeline.Actions */\nexport class ScheduleEmail extends Email\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tdoLayout()\n\t{\n\t\tthis._container.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-action-reply-btn\" },\n\t\t\t\t\tevents: { \"click\": this._clickHandler }\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new ScheduleEmail();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import History from \"./history\";\nimport {Mark} from \"../types\";\nimport {HistoryEmail} from \"../actions/email\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class HistoryActivity extends History\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tdoInitialize()\n\t{\n\t\tsuper.doInitialize();\n\t\tif(!(this._activityEditor instanceof BX.CrmActivityEditor))\n\t\t{\n\t\t\tthrow \"HistoryActivity. The field 'activityEditor' is not assigned.\";\n\t\t}\n\t}\n\n\tgetTitle()\n\t{\n\t\treturn BX.prop.getString(this.getAssociatedEntityData(), \"SUBJECT\", \"\");\n\t}\n\n\tgetTypeDescription()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst direction = BX.prop.getInteger(entityData, \"DIRECTION\", 0);\n\n\t\tconst typeCategoryId = this.getTypeCategoryId();\n\t\tif(typeCategoryId === BX.CrmActivityType.email)\n\t\t{\n\t\t\treturn this.getMessage(direction === BX.CrmActivityDirection.incoming ? \"incomingEmail\" : \"outgoingEmail\");\n\t\t}\n\t\telse if(typeCategoryId === BX.CrmActivityType.call)\n\t\t{\n\t\t\treturn this.getMessage(direction === BX.CrmActivityDirection.incoming ? \"incomingCall\" : \"outgoingCall\");\n\t\t}\n\t\telse if(typeCategoryId === BX.CrmActivityType.meeting)\n\t\t{\n\t\t\treturn this.getMessage(\"meeting\");\n\t\t}\n\t\telse if(typeCategoryId === BX.CrmActivityType.task)\n\t\t{\n\t\t\treturn this.getMessage(\"task\");\n\t\t}\n\t\telse if(typeCategoryId === BX.CrmActivityType.provider)\n\t\t{\n\t\t\tconst providerId = BX.prop.getString(entityData, \"PROVIDER_ID\", \"\");\n\n\t\t\tif(providerId === \"CRM_WEBFORM\")\n\t\t\t{\n\t\t\t\treturn this.getMessage(\"webform\");\n\t\t\t}\n\t\t\telse if (providerId === \"CRM_SMS\")\n\t\t\t{\n\t\t\t\treturn this.getMessage(\"sms\");\n\t\t\t}\n\t\t\telse if (providerId === \"CRM_REQUEST\")\n\t\t\t{\n\t\t\t\treturn this.getMessage(\"activityRequest\");\n\t\t\t}\n\t\t\telse if (providerId === \"IMOPENLINES_SESSION\")\n\t\t\t{\n\t\t\t\treturn this.getMessage(\"openLine\");\n\t\t\t}\n\t\t\telse if (providerId === \"REST_APP\")\n\t\t\t{\n\t\t\t\treturn this.getMessage(\"restApplication\");\n\t\t\t}\n\t\t\telse if (providerId === \"VISIT_TRACKER\")\n\t\t\t{\n\t\t\t\treturn this.getMessage(\"visit\");\n\t\t\t}\n\t\t\telse if (providerId === \"ZOOM\")\n\t\t\t{\n\t\t\t\treturn this.getMessage(\"zoom\");\n\t\t\t}\n\t\t}\n\n\t\treturn \"\";\n\t}\n\n\tprepareTitleLayout()\n\t{\n\t\treturn BX.create(\"A\",\n\t\t\t{\n\t\t\t\tattrs: { href: \"#\",  className: \"crm-entity-stream-content-event-title\" },\n\t\t\t\tevents: { \"click\": this._headerClickHandler },\n\t\t\t\ttext: this.getTypeDescription()\n\t\t\t}\n\t\t);\n\t}\n\n\tprepareTimeLayout()\n\t{\n\t\treturn BX.create(\"SPAN\",\n\t\t\t{\n\t\t\t\tattrs: { className: \"crm-entity-stream-content-event-time\" },\n\t\t\t\ttext: this.formatTime(this.getCreatedTime())\n\t\t\t}\n\t\t);\n\t}\n\n\tprepareMarkLayout()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst markTypeId = BX.prop.getInteger(entityData, \"MARK_TYPE_ID\", 0);\n\t\tif(markTypeId <= 0)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tlet messageName = \"\";\n\t\tif(markTypeId === Mark.success)\n\t\t{\n\t\t\tmessageName = \"SuccessMark\";\n\t\t}\n\t\telse if(markTypeId === Mark.renew)\n\t\t{\n\t\t\tmessageName = \"RenewMark\";\n\t\t}\n\n\t\tif(messageName === \"\")\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tlet markText = \"\";\n\t\tconst typeCategoryId = this.getTypeCategoryId();\n\t\tif(typeCategoryId === BX.CrmActivityType.email)\n\t\t{\n\t\t\tmarkText = this.getMessage(\"email\" + messageName);\n\t\t}\n\t\telse if(typeCategoryId === BX.CrmActivityType.call)\n\t\t{\n\t\t\tmarkText = this.getMessage(\"call\" + messageName);\n\t\t}\n\t\telse if(typeCategoryId === BX.CrmActivityType.meeting)\n\t\t{\n\t\t\tmarkText = this.getMessage(\"meeting\" + messageName);\n\t\t}\n\t\telse if(typeCategoryId === BX.CrmActivityType.task)\n\t\t{\n\t\t\tmarkText = this.getMessage(\"task\" + messageName);\n\t\t}\n\n\t\tif(markText === \"\")\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn(\n\t\t\tBX.create(\n\t\t\t\t\"SPAN\",\n\t\t\t\t{\n\t\t\t\t\tprops: { className: \"crm-entity-stream-content-event-skipped\" },\n\t\t\t\t\ttext: markText\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t}\n\n\tprepareActions()\n\t{\n\t\tif(this.isReadOnly())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst typeCategoryId = this.getTypeCategoryId();\n\t\tif(typeCategoryId === BX.CrmActivityType.email)\n\t\t{\n\t\t\tthis._actions.push(\n\t\t\t\tHistoryEmail.create(\n\t\t\t\t\t\"email\",\n\t\t\t\t\t{\n\t\t\t\t\t\titem: this,\n\t\t\t\t\t\tcontainer: this._actionContainer,\n\t\t\t\t\t\tentityData: this.getAssociatedEntityData(),\n\t\t\t\t\t\tactivityEditor: this._activityEditor\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\t}\n\n\tprepareContextMenuItems()\n\t{\n\t\tif(this._isMenuShown)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst menuItems = [];\n\n\t\tif (!this.isReadOnly())\n\t\t{\n\t\t\tif (this.isEditable())\n\t\t\t{\n\t\t\t\tmenuItems.push({ id: \"edit\", text: this.getMessage(\"menuEdit\"), onclick: BX.delegate(this.edit, this)});\n\t\t\t}\n\t\t\tmenuItems.push({ id: \"remove\", text: this.getMessage(\"menuDelete\"), onclick: BX.delegate(this.processRemoval, this)});\n\n\t\t\tif (this.isFixed() || this._fixedHistory.findItemById(this._id))\n\t\t\t\tmenuItems.push({ id: \"unfasten\", text: this.getMessage(\"menuUnfasten\"), onclick: BX.delegate(this.unfasten, this)});\n\t\t\telse\n\t\t\t\tmenuItems.push({ id: \"fasten\", text: this.getMessage(\"menuFasten\"), onclick: BX.delegate(this.fasten, this)});\n\t\t}\n\t\treturn menuItems;\n\t}\n\n\tview()\n\t{\n\t\tthis.closeContextMenu();\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst id = BX.prop.getInteger(entityData, \"ID\", 0);\n\t\tif(id > 0)\n\t\t{\n\t\t\tthis._activityEditor.viewActivity(id);\n\t\t}\n\t}\n\n\tedit()\n\t{\n\t\tthis.closeContextMenu();\n\t\tconst associatedEntityTypeId = this.getAssociatedEntityTypeId();\n\t\tif(associatedEntityTypeId === BX.CrmEntityType.enumeration.activity)\n\t\t{\n\t\t\tconst entityData = this.getAssociatedEntityData();\n\t\t\tconst id = BX.prop.getInteger(entityData, \"ID\", 0);\n\t\t\tif(id > 0)\n\t\t\t{\n\t\t\t\tthis._activityEditor.editActivity(id);\n\t\t\t}\n\t\t}\n\t}\n\n\tprocessRemoval()\n\t{\n\t\tthis.closeContextMenu();\n\t\tthis._detetionConfirmDlgId = \"entity_timeline_deletion_\" + this.getId() + \"_confirm\";\n\t\tlet dlg = BX.Crm.ConfirmationDialog.get(this._detetionConfirmDlgId);\n\t\tif(!dlg)\n\t\t{\n\t\t\tdlg = BX.Crm.ConfirmationDialog.create(\n\t\t\t\tthis._detetionConfirmDlgId,\n\t\t\t\t{\n\t\t\t\t\ttitle: this.getMessage(\"removeConfirmTitle\"),\n\t\t\t\t\tcontent: this.getRemoveMessage()\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\tdlg.open().then(BX.delegate(this.onRemovalConfirm, this), BX.delegate(this.onRemovalCancel, this));\n\t}\n\n\tgetRemoveMessage()\n\t{\n\t\treturn this.getMessage('removeConfirm');\n\t}\n\n\tonRemovalConfirm(result)\n\t{\n\t\tif(BX.prop.getBoolean(result, \"cancel\", true))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.remove();\n\t}\n\n\tonRemovalCancel()\n\t{\n\t}\n\n\tremove()\n\t{\n\t\tconst associatedEntityTypeId = this.getAssociatedEntityTypeId();\n\n\t\tif(associatedEntityTypeId === BX.CrmEntityType.enumeration.activity)\n\t\t{\n\t\t\tconst entityData = this.getAssociatedEntityData();\n\n\t\t\tconst id = BX.prop.getInteger(entityData, \"ID\", 0);\n\n\t\t\tif(id > 0)\n\t\t\t{\n\t\t\t\tconst activityEditor = this._activityEditor;\n\t\t\t\tconst item = activityEditor.getItemById(id);\n\t\t\t\tif (item)\n\t\t\t\t{\n\t\t\t\t\tactivityEditor.deleteActivity(id, true);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tconst serviceUrl = BX.util.add_url_param(activityEditor.getSetting('serviceUrl', ''),\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tid: id,\n\t\t\t\t\t\t\taction: 'get_activity',\n\t\t\t\t\t\t\townertype: activityEditor.getSetting('ownerType', ''),\n\t\t\t\t\t\t\townerid: activityEditor.getSetting('ownerID', '')\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t\tBX.ajax({\n\t\t\t\t\t\t'url': serviceUrl,\n\t\t\t\t\t\t'method': 'POST',\n\t\t\t\t\t\t'dataType': 'json',\n\t\t\t\t\t\t'data':\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t'ACTION' : 'GET_ACTIVITY',\n\t\t\t\t\t\t\t\t'ID': id,\n\t\t\t\t\t\t\t\t'OWNER_TYPE': activityEditor.getSetting('ownerType', ''),\n\t\t\t\t\t\t\t\t'OWNER_ID': activityEditor.getSetting('ownerID', '')\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\tonsuccess: BX.delegate(\n\t\t\t\t\t\t\tfunction(data)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tif(typeof(data['ACTIVITY']) !== 'undefined')\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tactivityEditor._handleActivityChange(data['ACTIVITY']);\n\t\t\t\t\t\t\t\t\twindow.setTimeout(BX.delegate(this.remove ,this), 500);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tthis\n\t\t\t\t\t\t),\n\t\t\t\t\t\tonfailure: function(data){}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new HistoryActivity();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n\n\tstatic messages = {};\n}\n","import HistoryActivity from \"./history-activity\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Document extends HistoryActivity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetTitle()\n\t{\n\t\tconst typeCategoryId = BX.prop.getInteger(this._data, \"TYPE_CATEGORY_ID\", 0);\n\t\tif(typeCategoryId === 3)\n\t\t{\n\t\t\treturn BX.Loc.getMessage('CRM_TIMELINE_DOCUMENT_VIEWED');\n\t\t}\n\n\t\treturn this.getMessage(\"document\");\n\t}\n\n\tprepareTitleLayout()\n\t{\n\t\treturn BX.create(\"SPAN\", {\n\t\t\tattrs:{ className: \"crm-entity-stream-content-event-title\"},\n\t\t\tchildren: [\n\t\t\t\tBX.create(\"A\", {\n\t\t\t\t\tattrs: { href: \"#\" },\n\t\t\t\t\tevents: { \"click\": BX.delegate(this.editDocument, this) },\n\t\t\t\t\ttext: this.getTitle()\n\t\t\t\t})\n\t\t\t]\n\t\t});\n\t}\n\n\tprepareTitleStatusLayout()\n\t{\n\t\tconst typeCategoryId = BX.prop.getInteger(this._data, \"TYPE_CATEGORY_ID\", 0);\n\t\tif(typeCategoryId === 3)\n\t\t{\n\t\t\treturn BX.create(\"SPAN\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-event-done\" },\n\t\t\t\t\ttext: BX.Loc.getMessage('CRM_TIMELINE_DOCUMENT_VIEWED_STATUS')\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\tif(typeCategoryId === 2)\n\t\t{\n\t\t\treturn BX.create(\"SPAN\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-event-sent\" },\n\t\t\t\t\ttext: BX.Loc.getMessage('CRM_TIMELINE_DOCUMENT_CREATED_STATUS')\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tprepareTimeLayout()\n\t{\n\t\treturn BX.create(\"SPAN\",\n\t\t\t{\n\t\t\t\tattrs: { className: \"crm-entity-stream-content-event-time\" },\n\t\t\t\ttext: this.formatTime(this.getCreatedTime())\n\t\t\t}\n\t\t);\n\t}\n\n\tisContextMenuEnabled()\n\t{\n\t\tconst typeCategoryId = BX.prop.getInteger(this._data, \"TYPE_CATEGORY_ID\", 0);\n\n\t\treturn typeCategoryId !== 3;\n\t}\n\n\tprepareHeaderLayout()\n\t{\n\t\tconst header = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-header\"}});\n\t\theader.appendChild(this.prepareTitleLayout());\n\t\tconst statusLayout = this.prepareTitleStatusLayout();\n\t\tif(statusLayout)\n\t\t{\n\t\t\theader.appendChild(statusLayout);\n\t\t}\n\t\theader.appendChild(this.prepareTimeLayout());\n\n\t\treturn header;\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst text = this.getTextDataParam(\"COMMENT\", \"\");\n\n\t\tconst wrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-section crm-entity-stream-section-history crm-entity-stream-section-document\"}\n\t\t\t}\n\t\t);\n\n\t\tif(this.isFixed())\n\t\t{\n\t\t\tBX.addClass(wrapper, 'crm-entity-stream-section-top-fixed');\n\t\t}\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-document\" }\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tif(this.isContextMenuEnabled())\n\t\t{\n\t\t\twrapper.appendChild(this.prepareContextMenuButton());\n\t\t}\n\n\t\tif(!this.isReadOnly())\n\t\t{\n\t\t\twrapper.appendChild(this.prepareFixedSwitcherLayout());\n\t\t}\n\n\t\tconst contentWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\tchildren: [contentWrapper]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst header = this.prepareHeaderLayout();\n\t\tcontentWrapper.appendChild(header);\n\n\t\tconst detailWrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail\"},\n\t\t\t\thtml: text\n\t\t\t}\n\t\t);\n\t\tconst title = BX.findChildByClassName(detailWrapper, 'document-title-link');\n\t\tif(title)\n\t\t{\n\t\t\tBX.bind(title, 'click', BX.proxy(this.editDocument, this));\n\t\t}\n\t\tcontentWrapper.appendChild(detailWrapper);\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontentWrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\t//region  Actions\n\t\tthis._actionContainer = BX.create(\"SPAN\", { attrs: { className: \"crm-entity-stream-content-detail-action\" } });\n\t\tcontentWrapper.appendChild(this._actionContainer);\n\t\t//endregion\n\n\t\treturn wrapper;\n\t}\n\n\tprepareActions()\n\t{\n\t}\n\n\tshowActions(show)\n\t{\n\t\tif(this._actionContainer)\n\t\t{\n\t\t\tthis._actionContainer.style.display = show ? \"\" : \"none\";\n\t\t}\n\t}\n\n\tprepareContextMenuItems()\n\t{\n\t\tconst menuItems = [];\n\n\t\tif(!this.isReadOnly())\n\t\t{\n\t\t\tmenuItems.push({ id: \"edit\", text: this.getMessage(\"menuEdit\"), onclick: BX.delegate(this.editDocument, this)});\n\t\t\tmenuItems.push({ id: \"remove\", text: this.getMessage(\"menuDelete\"), onclick: BX.delegate(this.confirmDelete, this)});\n\n\t\t\tif (this.isFixed() || this._fixedHistory.findItemById(this._id))\n\t\t\t{\n\t\t\t\tmenuItems.push({ id: \"unfasten\", text: this.getMessage(\"menuUnfasten\"), onclick: BX.delegate(this.unfasten, this)});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tmenuItems.push({ id: \"fasten\", text: this.getMessage(\"menuFasten\"), onclick: BX.delegate(this.fasten, this)});\n\t\t\t}\n\t\t}\n\n\t\treturn menuItems;\n\t}\n\n\tconfirmDelete()\n\t{\n\t\tthis.closeContextMenu();\n\t\tthis._detetionConfirmDlgId = \"entity_timeline_deletion_\" + this.getId() + \"_confirm\";\n\t\tlet dlg = BX.Crm.ConfirmationDialog.get(this._detetionConfirmDlgId);\n\t\tif(!dlg)\n\t\t{\n\t\t\tdlg = BX.Crm.ConfirmationDialog.create(\n\t\t\t\tthis._detetionConfirmDlgId,\n\t\t\t\t{\n\t\t\t\t\ttitle: this.getMessage(\"removeConfirmTitle\"),\n\t\t\t\t\tcontent: this.getMessage('documentRemove')\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\tdlg.open().then(BX.delegate(this.onConfirmDelete, this), BX.DoNothing);\n\t}\n\n\tonConfirmDelete(result)\n\t{\n\t\tif(BX.prop.getBoolean(result, \"cancel\", true))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.deleteDocument();\n\t}\n\n\tdeleteDocument()\n\t{\n\t\tif(this._isRequestRunning)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tthis._isRequestRunning = true;\n\t\tBX.ajax(\n\t\t\t{\n\t\t\t\turl: this._history._serviceUrl,\n\t\t\t\tmethod: \"POST\",\n\t\t\t\tdataType: \"json\",\n\t\t\t\tdata:\n\t\t\t\t\t{\n\t\t\t\t\t\t\"ACTION\": \"DELETE_DOCUMENT\",\n\t\t\t\t\t\t\"OWNER_TYPE_ID\":  this.getOwnerTypeId(),\n\t\t\t\t\t\t\"OWNER_ID\": this.getOwnerId(),\n\t\t\t\t\t\t\"ID\": this.getId()\n\t\t\t\t\t},\n\t\t\t\tonsuccess: BX.delegate(function(result)\n\t\t\t\t{\n\t\t\t\t\tthis._isRequestRunning = false;\n\t\t\t\t\tif(BX.type.isNotEmptyString(result.ERROR))\n\t\t\t\t\t{\n\t\t\t\t\t\talert(result.ERROR);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tconst deleteItem = this._history.findItemById(this._id);\n\t\t\t\t\t\tif (deleteItem instanceof Document)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tdeleteItem.clearAnimate();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst deleteFixedItem = this._fixedHistory.findItemById(this._id);\n\t\t\t\t\t\tif (deleteFixedItem instanceof Document)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tdeleteFixedItem.clearAnimate();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}, this),\n\t\t\t\tonfailure: BX.delegate(function()\n\t\t\t\t{\n\t\t\t\t\tthis._isRequestRunning = false;\n\t\t\t\t}, this)\n\t\t\t}\n\t\t);\n\t}\n\n\teditDocument()\n\t{\n\t\tconst documentId = this.getData().DOCUMENT_ID || 0;\n\t\tif(documentId > 0)\n\t\t{\n\t\t\tlet url = '/bitrix/components/bitrix/crm.document.view/slider.php';\n\t\t\turl = BX.util.add_url_param(url, {documentId: documentId});\n\t\t\tif(BX.SidePanel)\n\t\t\t{\n\t\t\t\tBX.SidePanel.Instance.open(url, {width: 1060});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\ttop.location.href = url;\n\t\t\t}\n\t\t}\n\t}\n\n\tupdateWrapper()\n\t{\n\t\tconst wrapper = this.getWrapper();\n\t\tif(wrapper)\n\t\t{\n\t\t\tconst detailWrapper = BX.findChildByClassName(wrapper, 'crm-entity-stream-content-detail');\n\t\t\tif(detailWrapper)\n\t\t\t{\n\t\t\t\tBX.adjust(detailWrapper, {html: this.getTextDataParam(\"COMMENT\", \"\")});\n\t\t\t\tconst title = BX.findChildByClassName(detailWrapper, 'document-title-link');\n\t\t\t\tif(title)\n\t\t\t\t{\n\t\t\t\t\tBX.bind(title, 'click', BX.proxy(this.editDocument, this));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Document();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","/** @memberof BX.Crm.Timeline.Animation */\nexport default class Item\n{\n\tconstructor()\n\t{\n\t\tthis._id = \"\";\n\t\tthis._settings = {};\n\t\tthis._initialItem = null;\n\t\tthis._finalItem = null;\n\t\tthis._events = null;\n\t}\n\n\tinitialize(id, settings)\n\t{\n\t\tthis._id = BX.type.isNotEmptyString(id) ? id : BX.util.getRandomString(4);\n\t\tthis._settings = settings ? settings : {};\n\n\t\tthis._initialItem = this.getSetting(\"initialItem\");\n\t\tthis._finalItem = this.getSetting(\"finalItem\");\n\n\t\tthis._anchor = this.getSetting(\"anchor\");\n\t\tthis._events = this.getSetting(\"events\", {});\n\t}\n\n\tgetId()\n\t{\n\t\treturn this._id;\n\t}\n\n\tgetSetting(name, defaultval)\n\t{\n\t\treturn this._settings.hasOwnProperty(name) ? this._settings[name] : defaultval;\n\t}\n\n\trun()\n\t{\n\t\tthis._node = this._initialItem.getWrapper();\n\t\tconst originalPosition = BX.pos(this._node);\n\t\tthis._initialYPosition = originalPosition.top;\n\t\tthis._initialXPosition = originalPosition.left;\n\t\tthis._initialWidth = this._node.offsetWidth;\n\t\tthis._initialHeight = this._node.offsetHeight;\n\n\t\tthis._anchorYPosition = BX.pos(this._anchor).top;\n\n\t\tthis.createStub();\n\t\tthis.createGhost();\n\t\tthis.moveGhost();\n\t}\n\n\tcreateStub()\n\t{\n\t\tthis._stub = BX.create(\n\t\t\t\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: { className: \"crm-entity-stream-section crm-entity-stream-section-planned crm-entity-stream-section-shadow\" },\n\t\t\t\tchildren :\n\t\t\t\t\t[\n\t\t\t\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-icon\" } }),\n\t\t\t\t\t\tBX.create(\n\t\t\t\t\t\t\t\"DIV\",\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tprops: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\t\t\t\tstyle: { height: this._initialHeight + \"px\" }\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t)\n\t\t\t\t\t]\n\t\t\t}\n\t\t);\n\n\t\tthis._node.parentNode.insertBefore(this._stub, this._node);\n\t}\n\n\tcreateGhost()\n\t{\n\t\tthis._ghostNode = this._node;\n\t\tthis._ghostNode.style.position = \"absolute\";\n\t\tthis._ghostNode.style.width = this._initialWidth + \"px\";\n\t\tthis._ghostNode.style.height = this._initialHeight + \"px\";\n\t\tthis._ghostNode.style.top = this._initialYPosition + \"px\";\n\t\tthis._ghostNode.style.left = this._initialXPosition + \"px\";\n\t\tdocument.body.appendChild(this._ghostNode);\n\t\tsetTimeout(BX.proxy(function (){BX.addClass(this._ghostNode, \"crm-entity-stream-section-casper\" )}, this), 20);\n\t}\n\n\tmoveGhost()\n\t{\n\t\tconst node = this._ghostNode;\n\t\tconst movingEvent = new BX.easing({\n\t\t\tduration: 500,\n\t\t\tstart: {top: this._initialYPosition},\n\t\t\tfinish: {top: this._anchorYPosition},\n\t\t\ttransition: BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\tstep: BX.proxy(function (state) {\n\t\t\t\tnode.style.top = state.top + \"px\";\n\t\t\t}, this)\n\t\t});\n\t\tsetTimeout( BX.proxy(function () {\n\t\t\tmovingEvent.animate();\n\t\t\tnode.style.boxShadow = \"\";\n\t\t}, this), 500);\n\n\t\tconst placeEventAnim = new BX.easing({\n\t\t\tduration: 500,\n\t\t\tstart: {height: 0},\n\t\t\tfinish: {height: this._initialHeight + 20},\n\t\t\ttransition: BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\tstep: BX.proxy(function (state) {\n\t\t\t\tthis._anchor.style.height = state.height + \"px\";\n\t\t\t}, this),\n\t\t\tcomplete: BX.proxy(function () {\n\t\t\t\tif (BX.type.isFunction(this._events[\"complete\"]))\n\t\t\t\t{\n\t\t\t\t\tthis._events[\"complete\"]();\n\t\t\t\t}\n\n\t\t\t\tthis.addHistoryItem();\n\t\t\t\tthis.removeGhost();\n\t\t\t}, this)\n\t\t});\n\t\tsetTimeout(function (){placeEventAnim.animate()}, 500);\n\t}\n\n\taddHistoryItem()\n\t{\n\t\tconst node = this._finalItem.getWrapper();\n\n\t\tthis._anchor.parentNode.insertBefore(node, this._anchor.nextSibling);\n\n\t\tthis._finalItemHeight = this._anchor.offsetHeight - node.offsetHeight;\n\t\tthis._anchor.style.height = 0;\n\t\tnode.style.marginBottom = this._finalItemHeight + \"px\";\n\t}\n\n\tremoveGhost()\n\t{\n\t\tconst ghostNode = this._ghostNode;\n\t\tconst finalNode = this._finalItem.getWrapper();\n\n\t\tghostNode.style.overflow = \"hidden\";\n\t\tconst hideCasperItem = new BX.easing({\n\t\t\tduration: 70,\n\t\t\tstart: {opacity: 100, height: ghostNode.offsetHeight, marginBottom: this._finalItemHeight},\n\t\t\tfinish: {opacity: 0, height: finalNode.offsetHeight, marginBottom: 20},\n\t\t\t// transition : BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\tstep: BX.proxy(function (state) {\n\t\t\t\tghostNode.style.opacity = state.opacity / 100;\n\t\t\t\tghostNode.style.height = state.height + \"px\";\n\t\t\t\tfinalNode.style.marginBottom = state.marginBottom + \"px\";\n\t\t\t}, this),\n\t\t\tcomplete: BX.proxy(function () {\n\t\t\t\tghostNode.remove();\n\t\t\t\tfinalNode.style.marginBottom = \"\";\n\t\t\t\tthis.collapseStub();\n\n\t\t\t}, this)\n\t\t});\n\t\thideCasperItem.animate();\n\t}\n\n\tcollapseStub()\n\t{\n\t\tconst removePlannedEvent = new BX.easing({\n\t\t\tduration: 500,\n\t\t\tstart: {opacity: 100, height: this._initialHeight, marginBottom: 15},\n\t\t\tfinish: {opacity: 0, height: 0, marginBottom: 0},\n\t\t\ttransition: BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\tstep: BX.proxy(function (state) {\n\t\t\t\tthis._stub.style.height = state.height + \"px\";\n\t\t\t\tthis._stub.style.marginBottom = state.marginBottom + \"px\";\n\t\t\t\tthis._stub.style.opacity = state.opacity / 100;\n\t\t\t}, this),\n\t\t\tcomplete: BX.proxy(function () {\n\t\t\t\tthis.inited = false\n\t\t\t}, this)\n\n\t\t});\n\t\tremovePlannedEvent.animate();\n\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Item();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","/** @memberof BX.Crm.Timeline.Animation */\nexport default class Shift\n{\n\tconstructor()\n\t{\n\t\tthis._node = null;\n\t\tthis._anchor = null;\n\t\tthis._nodeParent  = null;\n\t\tthis._startPosition = null;\n\t\tthis._events = null;\n\t}\n\n\tinitialize(node, anchor, startPosition, shadowNode, events)\n\t{\n\t\tthis._node = node;\n\t\tthis._shadowNode = shadowNode;\n\t\tthis._anchor = anchor;\n\t\tthis._nodeParent  = node.parentNode;\n\t\tthis._startPosition = startPosition;\n\t\tthis._events = BX.type.isPlainObject(events) ? events : {};\n\n\t}\n\n\trun()\n\t{\n\t\tthis._anchorPosition = BX.pos(this._anchor);\n\n\t\tsetTimeout(\n\t\t\tBX.proxy(\n\t\t\t\tfunction (){\n\t\t\t\t\tBX.addClass(this._node, \"crm-entity-stream-section-casper\" )\n\t\t\t\t},\n\t\t\t\tthis\n\t\t\t),\n\t\t\t0\n\t\t);\n\n\t\tconst movingEvent = new BX.easing({\n\t\t\tduration: 1500,\n\t\t\tstart: {top: this._startPosition.top, height: 0},\n\t\t\tfinish: {top: this._anchorPosition.top, height: this._startPosition.height + 20},\n\t\t\ttransition: BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\tstep: BX.proxy(function (state) {\n\t\t\t\tthis._node.style.top = state.top + \"px\";\n\t\t\t\tthis._anchor.style.height = state.height + \"px\";\n\t\t\t}, this),\n\t\t\tcomplete: BX.proxy(function () {\n\t\t\t\tthis.finish();\n\t\t\t}, this)\n\t\t});\n\t\tmovingEvent.animate();\n\t}\n\n\tfinish()\n\t{\n\t\tif(BX.type.isFunction(this._events[\"complete\"]))\n\t\t{\n\t\t\tthis._events[\"complete\"]();\n\t\t}\n\t\tif( this._shadowNode !== false )\n\t\t{\n\t\t\t// this._stub.height = 0;\n\t\t}\n\t}\n\n\tstatic create(node, anchor, startPosition, shadowNode, events)\n\t{\n\t\tconst self = new Shift();\n\t\tself.initialize(node, anchor, startPosition, shadowNode, events);\n\t\treturn self;\n\t}\n}\n","import Shift from \"./shift\";\n\n/** @memberof BX.Crm.Timeline.Animation */\nexport default class ItemNew\n{\n\tconstructor()\n\t{\n\t\tthis._id = \"\";\n\t\tthis._settings = {};\n\t\tthis._initialItem = null;\n\t\tthis._finalItem = null;\n\t\tthis._events = null;\n\t\tthis._areAnimatedItemsVisible = null;\n\t}\n\n\tinitialize(id, settings)\n\t{\n\t\tthis._id = BX.type.isNotEmptyString(id) ? id : BX.util.getRandomString(4);\n\t\tthis._settings = settings ? settings : {};\n\n\t\tthis._initialItem = this.getSetting(\"initialItem\");\n\t\tthis._finalItem = this.getSetting(\"finalItem\");\n\n\t\tthis._anchor = this.getSetting(\"anchor\");\n\t\tthis._events = this.getSetting(\"events\", {});\n\t}\n\n\tgetId()\n\t{\n\t\treturn this._id;\n\t}\n\n\tgetSetting(name, defaultval)\n\t{\n\t\treturn this._settings.hasOwnProperty(name) ? this._settings[name] : defaultval;\n\t}\n\n\taddHistoryItem()\n\t{\n\t\tconst node = this._finalItem.getWrapper();\n\n\t\tthis._anchor.parentNode.insertBefore(node, this._anchor.nextSibling);\n\n\t}\n\n\trun()\n\t{\n\t\tthis._node = this._initialItem.getWrapper();\n\t\tthis._areAnimatedItemsVisible = this._node.offsetParent !== null;\n\t\tif (this._areAnimatedItemsVisible)\n\t\t{\n\t\t\tthis.createStub();\n\n\t\t\tBX.addClass(this._node, 'crm-entity-stream-section-animate-start');\n\n\t\t\tthis._startPosition = BX.pos(this._stub);\n\n\t\t\tthis._node.style.position = \"absolute\";\n\t\t\tthis._node.style.width = this._startPosition.width + \"px\";\n\t\t\tthis._node.style.height = this._startPosition.height + \"px\";\n\t\t\tthis._node.style.top = this._startPosition.top + \"px\";\n\t\t\tthis._node.style.left = this._startPosition.left + \"px\";\n\t\t\tthis._node.style.zIndex = 960;\n\n\n\t\t\tdocument.body.appendChild(this._node);\n\n\t\t\tconst shift = Shift.create(\n\t\t\t\tthis._node,\n\t\t\t\tthis._anchor,\n\t\t\t\tthis._startPosition,\n\t\t\t\tthis._stub,\n\t\t\t\t{complete: BX.delegate(this.finish, this)}\n\t\t\t);\n\t\t\tshift.run();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.finish();\n\t\t}\n\t}\n\n\tcreateStub()\n\t{\n\t\tthis._stub = BX.create(\n\t\t\t\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: { className: \"crm-entity-stream-section crm-entity-stream-section-planned crm-entity-stream-section-shadow\" },\n\t\t\t\tchildren :\n\t\t\t\t\t[\n\t\t\t\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-icon\" } }),\n\t\t\t\t\t\tBX.create(\n\t\t\t\t\t\t\t\"DIV\",\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tprops: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\t\t\t\tstyle: { height: this._initialItem._wrapper.clientHeight + \"px\" }\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t)\n\t\t\t\t\t]\n\t\t\t}\n\t\t);\n\n\t\tthis._node.parentNode.insertBefore(this._stub, this._node);\n\t}\n\n\tfinish()\n\t{\n\t\tthis._anchor.style.height = 0;\n\t\t//this._anchor.parentNode.insertBefore(this._node, this._anchor.nextSibling);\n\n\t\tif (this._areAnimatedItemsVisible)\n\t\t{\n\t\t\tconst stubContainer = this._stub.querySelector('.crm-entity-stream-section-content');\n\t\t\tsetTimeout(\n\t\t\t\tBX.delegate(function()\n\t\t\t\t{\n\t\t\t\t\tBX.removeClass(this._node, 'crm-entity-stream-section-animate-start');\n\t\t\t\t}, this),\n\t\t\t\t0\n\t\t\t);\n\n\t\t\tthis._node.style.opacity = 0;\n\n\t\t\tsetTimeout(BX.delegate(\n\t\t\t\tfunction()\n\t\t\t\t{\n\t\t\t\t\tstubContainer.style.height = 0;\n\t\t\t\t\tstubContainer.style.opacity = 0;\n\t\t\t\t\tstubContainer.style.paddingTop = 0;\n\t\t\t\t\tstubContainer.style.paddingBottom = 0;\n\t\t\t\t},\n\t\t\t\tthis\n\t\t\t), 120);\n\t\t}\n\t\tsetTimeout( BX.delegate(\n\t\t\tfunction() {\n\t\t\t\tif (this._areAnimatedItemsVisible)\n\t\t\t\t{\n\t\t\t\t\tBX.remove(this._stub);\n\t\t\t\t}\n\t\t\t\tBX.remove(this._node);\n\t\t\t\tthis.addHistoryItem();\n\n\t\t\t\tif(BX.type.isFunction(this._events[\"complete\"]))\n\t\t\t\t{\n\t\t\t\t\tthis._events[\"complete\"]();\n\t\t\t\t}\n\t\t\t},\n\t\t\tthis\n\t\t), 420 );\n\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new ItemNew();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import {Type, Dom} from 'main.core';\nimport Manager from \"./manager\";\nimport {Item, ConfigurableItem, StreamType} from 'crm.timeline.item';\nimport ItemAnimation from \"./animations/item\";\nimport ItemNew from \"./animations/item-new\";\nimport {TimezoneOffset, Format} from \"crm.datetime\"\n\n/** @memberof BX.Crm.Timeline */\nexport default class Steam\n{\n\tconstructor()\n\t{\n\t\tthis._id = \"\";\n\t\tthis._settings = {};\n\t\tthis._container = null;\n\t\tthis._manager = null;\n\t\tthis._activityEditor = null;\n\n\t\tthis._timeFormat = \"\";\n\t\tthis._year = 0;\n\n\t\tthis._isStubMode = false;\n\t\tthis._userId = 0;\n\t\tthis._readOnly = false;\n\t\tthis._streamType = StreamType.history;\n\t\tthis._anchor = null;\n\n\t\tthis._serviceUrl = \"\";\n\t}\n\n\tinitialize(id, settings)\n\t{\n\t\tthis._id = BX.type.isNotEmptyString(id) ? id : BX.util.getRandomString(4);\n\t\tthis._settings = settings ? settings : {};\n\n\t\tthis._container = BX(this.getSetting(\"container\"));\n\t\tif (!BX.type.isElementNode(this._container))\n\t\t{\n\t\t\tthrow \"Timeline. Container node is not found.\";\n\t\t}\n\t\tthis._editorContainer = BX(this.getSetting(\"editorContainer\"));\n\t\tthis._manager = this.getSetting(\"manager\");\n\t\tif (!(this._manager instanceof Manager))\n\t\t{\n\t\t\tthrow \"Timeline. Manager instance is not found.\";\n\t\t}\n\n\t\t//\n\t\tconst datetimeFormat = BX.message(\"FORMAT_DATETIME\").replace(/:SS/, \"\");\n\t\tconst dateFormat = BX.message(\"FORMAT_DATE\");\n\t\tthis._timeFormat = BX.date.convertBitrixFormat(BX.util.trim(datetimeFormat.replace(dateFormat, \"\")));\n\t\t//\n\t\tthis._year = (new Date()).getFullYear();\n\n\t\tthis._activityEditor = this.getSetting(\"activityEditor\");\n\n\t\tthis._isStubMode = BX.prop.getBoolean(this._settings, \"isStubMode\", false);\n\t\tthis._readOnly = BX.prop.getBoolean(this._settings, \"readOnly\", false);\n\t\tthis._userId = BX.prop.getInteger(this._settings, \"userId\", 0);\n\t\tthis._serviceUrl = BX.prop.getString(this._settings, \"serviceUrl\", \"\");\n\n\t\tthis.doInitialize();\n\t}\n\n\tgetId()\n\t{\n\t\treturn this._id;\n\t}\n\n\tisScheduleStream(): boolean\n\t{\n\t\treturn this.getStreamType() === StreamType.scheduled;\n\t}\n\n\tisFixedHistoryStream(): boolean\n\t{\n\t\treturn this.getStreamType() === StreamType.pinned;\n\t}\n\n\tisHistoryStream(): boolean\n\t{\n\t\treturn this.getStreamType() === StreamType.history;\n\t}\n\n\tgetSetting(name, defaultval)\n\t{\n\t\treturn this._settings.hasOwnProperty(name) ? this._settings[name] : defaultval;\n\t}\n\n\tdoInitialize()\n\t{\n\t}\n\n\tlayout()\n\t{\n\t}\n\n\tisStubMode()\n\t{\n\t\treturn this._isStubMode;\n\t}\n\n\tisReadOnly()\n\t{\n\t\treturn this._readOnly;\n\t}\n\n\tgetUserId()\n\t{\n\t\treturn this._userId;\n\t}\n\n\tgetServiceUrl()\n\t{\n\t\treturn this._serviceUrl;\n\t}\n\n\tgetAnchor(): ?HTMLElement\n\t{\n\t\treturn this._anchor;\n\t}\n\n\tgetStreamType() {\n\t\treturn this._streamType;\n\t}\n\n\trefreshLayout()\n\t{\n\t}\n\n\tgetManager()\n\t{\n\t\treturn this._manager;\n\t}\n\n\tgetOwnerInfo()\n\t{\n\t\treturn this._manager.getOwnerInfo();\n\t}\n\n\treload()\n\t{\n\t\tconst currentUrl = this.getSetting(\"currentUrl\");\n\t\tconst ajaxId = this.getSetting(\"ajaxId\");\n\t\tif (ajaxId !== \"\")\n\t\t{\n\t\t\tBX.ajax.insertToNode(BX.util.add_url_param(currentUrl, {bxajaxid: ajaxId}), \"comp_\" + ajaxId);\n\t\t}\n\t\telse\n\t\t{\n\t\t\twindow.location = currentUrl;\n\t\t}\n\t}\n\n\tgetUserTimezoneOffset()\n\t{\n\t\treturn TimezoneOffset.USER_TO_SERVER;\n\t}\n\n\tgetServerTimezoneOffset()\n\t{\n\t\treturn TimezoneOffset.SERVER_TO_UTC;\n\t}\n\n\t// @todo replace by DatetimeConverter\n\tformatTime(time, now, utc)\n\t{\n\t\treturn BX.date.format(this._timeFormat, time, now, utc);\n\t}\n\n\t// @todo replace by DatetimeConverter\n\tformatDate(date)\n\t{\n\t\treturn (\n\t\t\tBX.date.format(\n\t\t\t\t[\n\t\t\t\t\t[\"today\", \"today\"],\n\t\t\t\t\t[\"tommorow\", \"tommorow\"],\n\t\t\t\t\t[\"yesterday\", \"yesterday\"],\n\t\t\t\t\t[\"\", (date.getFullYear() === this._year) ? Format.DAY_MONTH_FORMAT : Format.LONG_DATE_FORMAT],\n\t\t\t\t],\n\t\t\t\tdate\n\t\t\t)\n\t\t);\n\t}\n\n\tcutOffText(text, length): string\n\t{\n\t\tif (!BX.type.isNumber(length))\n\t\t{\n\t\t\tlength = 0;\n\t\t}\n\n\t\tif (length <= 0 || text.length <= length)\n\t\t{\n\t\t\treturn text;\n\t\t}\n\n\t\tlet offset = length - 1;\n\t\tconst whitespaceOffset = text.substring(offset).search(/\\s/i);\n\t\tif (whitespaceOffset > 0)\n\t\t{\n\t\t\toffset += whitespaceOffset;\n\t\t}\n\t\treturn text.substring(0, offset) + \"...\";\n\t}\n\n\tgetItems(): Array\n\t{\n\t\treturn [];\n\t}\n\n\t/**\n\t * @abstract\n\t */\n\tsetItems(items: Array): void\n\t{\n\t\tthrow new Error('Stream.setItems() must be overridden');\n\t}\n\n\tgetLastItem(): ?Item\n\t{\n\t\tconst items = this.getItems();\n\n\t\treturn items.length > 0 ? items[items.length - 1] : null;\n\t}\n\n\tfindItemById(id): ?Item\n\t{\n\t\tid = id.toString();\n\n\t\treturn this.getItems().find(item => item.getId() === id) || null;\n\t}\n\n\tgetItemIndex(item: Item): number\n\t{\n\t\treturn this.getItems().findIndex((currentItem) => (currentItem === item));\n\t}\n\n\tremoveItemByIndex(index): void\n\t{\n\t\tconst items = this.getItems();\n\t\tif (index < items.length)\n\t\t{\n\t\t\titems.splice(index, 1);\n\t\t\tthis.setItems(items);\n\t\t}\n\t}\n\n\t/**\n\t * @abstract\n\t */\n\tcreateItem(data): Item\n\t{\n\t\tthrow new Error('Stream.createItem() must be overridden');\n\t}\n\n\tcreateItemCopy(item: Item): Item\n\t{\n\t\tif (item instanceof ConfigurableItem)\n\t\t{\n\t\t\treturn item.clone();\n\t\t}\n\n\t\treturn this.createItem(item.getData());\n\t}\n\n\trefreshItem(item: Item, animateUpdate: boolean = true, animateMove: true): Promise\n\t{\n\t\tconst index = this.getItemIndex(item);\n\t\tif(index < 0)\n\t\t{\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\tthis.removeItemByIndex(index);\n\n\t\tlet itemPositionChanged = false;\n\t\tlet newIndex = 0;\n\t\tlet newItem;\n\t\tif (this.isScheduleStream())\n\t\t{\n\t\t\tnewItem = this.createItemCopy(item);\n\t\t\tnewIndex = this.calculateItemIndex(newItem);\n\n\t\t\titemPositionChanged = newIndex !== index;\n\t\t}\n\n\t\tif(!itemPositionChanged)\n\t\t{\n\t\t\tthis.addItem(item, newIndex);\n\t\t\titem.refreshLayout();\n\t\t\tif (animateUpdate)\n\t\t\t{\n\t\t\t\treturn this.animateItemAdding(item);\n\t\t\t}\n\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\tconst anchor = this.createAnchor(newIndex);\n\t\tthis.addItem(newItem, newIndex);\n\t\tif (animateMove)\n\t\t{\n\t\t\tnewItem.layout({add: false});\n\n\t\t\treturn new Promise((resolve) => {\n\t\t\t\tconst animation = ItemAnimation.create(\n\t\t\t\t\t'',\n\t\t\t\t\t{\n\t\t\t\t\t\tinitialItem: item,\n\t\t\t\t\t\tfinalItem: newItem,\n\t\t\t\t\t\tanchor: anchor,\n\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\tcomplete: () => {\n\t\t\t\t\t\t\t\titem.destroy();\n\t\t\t\t\t\t\t\tresolve();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t\tanimation.run();\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tnewItem.layout({anchor: anchor});\n\t\t\titem.destroy();\n\n\t\t\treturn Promise.resolve();\n\t\t}\n\t}\n\n\tcalculateItemIndex(item: Item): Number\n\t{\n\t\treturn 0;\n\t}\n\n\tcreateAnchor(index): HTMLElement\n\t{\n\t\treturn null;\n\t}\n\n\t/**\n\t * @abstract\n\t */\n\taddItem(item: Item, index): void\n\t{\n\t\tthrow new Error('Stream.addItem() must be overridden');\n\t}\n\n\t/**\n\t * @abstract\n\t */\n\tdeleteItem(item: Item): void\n\t{\n\t\tthrow new Error('Stream.deleteItem() must be overridden');\n\t}\n\n\tdeleteItemAnimated(item: Item): void\n\t{\n\t\tif (!Type.isDomNode(item.getWrapper()))\n\t\t{\n\t\t\tthis.deleteItem(item);\n\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\treturn new Promise((resolve) => {\n\t\t\tconst wrapperPosition = Dom.getPosition(item.getWrapper());\n\n\t\t\tconst hideEvent = new BX.easing({\n\t\t\t\tduration: 1000,\n\t\t\t\tstart: {height: wrapperPosition.height, opacity: 1, marginBottom: 15},\n\t\t\t\tfinish: {height: 0, opacity: 0, marginBottom: 0},\n\t\t\t\ttransition: BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\t\tstep: (state) => {\n\t\t\t\t\tDom.style(item.getWrapper(), {\n\t\t\t\t\t\theight:  state.height + 'px',\n\t\t\t\t\t\topacity:  state.opacity,\n\t\t\t\t\t\tmarginBottom:  state.marginBottom,\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tcomplete: () => {\n\t\t\t\t\tthis.deleteItem(item)\n\t\t\t\t\tresolve();\n\t\t\t\t}\n\t\t\t});\n\n\t\t\thideEvent.animate();\n\t\t});\n\t}\n\n\tmoveItemToStream(item: Item, destinationStream: Steam, destinationItem: Item): void\n\t{\n\t\tthis.removeItemByIndex(this.getItemIndex(item));\n\t\tif (this.getItems().length > 0)\n\t\t{\n\t\t\tthis.refreshLayout();\n\t\t}\n\n\t\treturn new Promise((resolve) => {\n\t\t\tconst animation = ItemNew.create(\n\t\t\t\t'',\n\t\t\t\t{\n\t\t\t\t\tinitialItem: item,\n\t\t\t\t\tfinalItem: destinationItem,\n\t\t\t\t\tanchor: destinationStream.createAnchor(),\n\t\t\t\t\tevents: {complete: () => {\n\t\t\t\t\t\t\tthis.refreshLayout();\n\t\t\t\t\t\t\tdestinationStream.refreshLayout();\n\t\t\t\t\t\t\tresolve();\n\t\t\t\t\t\t}}\n\t\t\t\t}\n\t\t\t);\n\t\t\tanimation.run();\n\t\t});\n\t}\n\n\tanimateItemAdding(item): Promise\n\t{\n\t\treturn Promise.resolve();\n\t}\n}\n","import Stream from \"../stream\";\n\n/** @memberof BX.Crm.Timeline.Streams */\nexport default class EntityChat extends Stream\n{\n\tstatic LayoutType = {\n\t\tnone: 0,\n\t\tinvitation:  1,\n\t\tsummary: 2,\n\t}\n\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._data = null;\n\t\tthis._layoutType = EntityChat.LayoutType.none;\n\n\t\tthis._wrapper = null;\n\t\tthis._contentWrapper = null;\n\t\tthis._messageWrapper = null;\n\t\tthis._messageDateNode = null;\n\t\tthis._messageTexWrapper = null;\n\t\tthis._messageTextNode = null;\n\t\tthis._userWrapper = null;\n\t\tthis._extraUserCounter = null;\n\n\t\tthis._openChatHandler = BX.delegate(this.onOpenChat, this);\n\t}\n\n\tdoInitialize()\n\t{\n\t\tthis._data = BX.prop.getObject(this._settings, \"data\", {});\n\t}\n\n\tgetData()\n\t{\n\t\treturn this._data;\n\t}\n\n\tsetData(data)\n\t{\n\t\tthis._data = BX.type.isPlainObject(data) ? data : {};\n\t}\n\n\tisEnabled()\n\t{\n\t\treturn BX.prop.getBoolean(this._data, \"ENABLED\", true);\n\t}\n\n\t/**\n\t * @private\n\t * @return {boolean}\n\t */\n\tisRestricted()\n\t{\n\t\treturn BX.prop.getBoolean(this._data, \"IS_RESTRICTED\", false);\n\t}\n\n\t/**\n\t * @private\n\t * @return {void}\n\t */\n\tapplyLockScript()\n\t{\n\t\tconst lockScript = BX.prop.getString(this._data, \"LOCK_SCRIPT\", null);\n\t\tif (BX.Type.isString(lockScript) && lockScript !== '')\n\t\t{\n\t\t\teval(lockScript);\n\t\t}\n\t}\n\n\tgetChatId()\n\t{\n\t\treturn BX.prop.getInteger(this._data, \"CHAT_ID\", 0);\n\t}\n\n\tgetUserId()\n\t{\n\t\tconst userId = parseInt(top.BX.message(\"USER_ID\"));\n\t\treturn !isNaN(userId) ? userId : 0;\n\t}\n\n\tgetMessageData()\n\t{\n\t\treturn BX.prop.getObject(this._data, \"MESSAGE\", {});\n\t}\n\n\tsetMessageData(data)\n\t{\n\t\tthis._data[\"MESSAGE\"] = BX.type.isPlainObject(data) ? data : {};\n\t}\n\n\tgetUserInfoData()\n\t{\n\t\treturn BX.prop.getObject(this._data, \"USER_INFOS\", {});\n\t}\n\n\tsetUserInfoData(data)\n\t{\n\t\tthis._data[\"USER_INFOS\"] = BX.type.isPlainObject(data) ? data : {};\n\t}\n\n\thasUserInfo(userId)\n\t{\n\t\treturn userId > 0 && BX.type.isPlainObject(this.getUserInfoData()[userId]);\n\t}\n\n\tgetUserInfo(userId)\n\t{\n\t\tconst userInfos = this.getUserInfoData();\n\t\treturn userId > 0 && BX.type.isPlainObject(userInfos[userId]) ? userInfos[userId] : null;\n\t}\n\n\tremoveUserInfo(userId)\n\t{\n\t\tconst userInfos = this.getUserInfoData();\n\t\tif(userId > 0 && BX.type.isPlainObject(userInfos[userId]))\n\t\t{\n\t\t\tdelete userInfos[userId];\n\t\t}\n\t}\n\n\tsetUnreadMessageCounter(userId, counter)\n\t{\n\t\tconst userInfos = this.getUserInfoData();\n\t\tif(userId > 0 && BX.type.isPlainObject(userInfos[userId]))\n\t\t{\n\t\t\tuserInfos[userId][\"counter\"] = counter;\n\t\t}\n\t}\n\n\tlayout()\n\t{\n\t\tif(!this.isEnabled() || this.isStubMode())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis._wrapper = BX.create(\"div\", { props: { className: \"crm-entity-stream-section crm-entity-stream-section-live-im\" } });\n\t\tthis._container.appendChild(this._wrapper);\n\n\t\tthis._wrapper.appendChild(\n\t\t\tBX.create(\"div\", { props: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-live-im\" } })\n\t\t);\n\n\t\tthis._contentWrapper = BX.create(\"div\", { props: { className: \"crm-entity-stream-content-live-im-detail\" } });\n\n\t\tthis._wrapper.appendChild(\n\t\t\tBX.create(\"div\",\n\t\t\t\t{\n\t\t\t\t\tprops: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"div\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tprops: { className: \"crm-entity-stream-content-event\" },\n\t\t\t\t\t\t\t\t\tchildren: [ this._contentWrapper ]\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tthis._userWrapper = BX.create(\"div\", { props: { className: \"crm-entity-stream-live-im-user-avatars\" } });\n\t\tthis._contentWrapper.appendChild(\n\t\t\tBX.create(\"div\",\n\t\t\t\t{\n\t\t\t\t\tprops: { className: \"crm-entity-stream-live-im-users\" },\n\t\t\t\t\tchildren: [ this._userWrapper ]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tthis._extraUserCounter = BX.create(\"div\",{ props: { className: \"crm-entity-stream-live-im-user-counter\" } });\n\t\tthis._contentWrapper.appendChild(this._extraUserCounter);\n\n\t\tthis._layoutType = EntityChat.LayoutType.none;\n\t\tif(this.getChatId() > 0)\n\t\t{\n\t\t\tthis.renderSummary();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.renderInvitation();\n\t\t}\n\n\t\tBX.bind(this._contentWrapper, \"click\", this._openChatHandler);\n\t\tBX.addCustomEvent(\"onPullEvent-im\", this.onChatEvent.bind(this));\n\t}\n\n\trefreshLayout()\n\t{\n\t\tBX.cleanNode(this._contentWrapper);\n\t\tthis._userWrapper = BX.create(\"div\", { props: { className: \"crm-entity-stream-live-im-user-avatars\" } });\n\t\tthis._contentWrapper.appendChild(\n\t\t\tBX.create(\"div\",\n\t\t\t\t{\n\t\t\t\t\tprops: { className: \"crm-entity-stream-live-im-users\" },\n\t\t\t\t\tchildren: [ this._userWrapper ]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tthis._extraUserCounter = BX.create(\"div\",{ props: { className: \"crm-entity-stream-live-im-user-counter\" } });\n\t\tthis._contentWrapper.appendChild(this._extraUserCounter);\n\n\t\tthis._layoutType = EntityChat.LayoutType.none;\n\t\tif(this.getChatId() > 0)\n\t\t{\n\t\t\tthis.renderSummary();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.renderInvitation();\n\t\t}\n\t}\n\n\trenderInvitation()\n\t{\n\t\tthis._layoutType = EntityChat.LayoutType.invitation;\n\t\tthis.refreshUsers();\n\n\t\tthis._messageTextNode = BX.create(\"div\", { props: { className: \"crm-entity-stream-live-im-user-invite-text\" } });\n\t\tthis._contentWrapper.appendChild(this._messageTextNode);\n\n\t\tthis._messageTextNode.innerHTML = this.getMessage(\"invite\");\n\t}\n\n\trenderSummary()\n\t{\n\t\tthis._layoutType = EntityChat.LayoutType.summary;\n\t\tthis.refreshUsers();\n\n\t\tthis._contentWrapper.appendChild(\n\t\t\tBX.create(\"div\", { props: { className: \"crm-entity-stream-live-im-separator\" } })\n\t\t);\n\n\t\tthis._messageWrapper = BX.create(\"div\", { props: { className: \"crm-entity-stream-live-im-messanger\" } });\n\t\tthis._contentWrapper.appendChild(this._messageWrapper);\n\n\t\tthis._messageDateNode = BX.create(\"div\", { props: { className: \"crm-entity-stream-live-im-time\" } });\n\t\tthis._messageWrapper.appendChild(this._messageDateNode);\n\n\t\tthis._messageTexWraper = BX.create(\"div\", { props: { className: \"crm-entity-stream-live-im-message\" } });\n\t\tthis._messageWrapper.appendChild(this._messageTexWraper);\n\n\t\tthis._messageTextNode = BX.create(\"div\", { props: { className: \"crm-entity-stream-live-im-message-text\" } });\n\t\tthis._messageTexWraper.appendChild(this._messageTextNode);\n\n\t\tthis._messageCounterNode = BX.create(\"div\", { props: { className: \"crm-entity-stream-live-im-message-counter\" } });\n\t\tthis._messageWrapper.appendChild(this._messageCounterNode);\n\n\t\tthis.refreshSummary();\n\t}\n\n\trefreshUsers()\n\t{\n\t\tBX.cleanNode(this._userWrapper);\n\n\t\tconst infos = this.getUserInfoData();\n\t\tconst list = Object.values(infos);\n\n\t\tif(list.length === 0)\n\t\t{\n\t\t\tthis._userWrapper.appendChild(\n\t\t\t\tBX.create(\"span\",\n\t\t\t\t\t{\n\t\t\t\t\t\tprops: { className: \"crm-entity-stream-live-im-user-avatar ui-icon ui-icon-common-user\" },\n\t\t\t\t\t\tchildren: [ BX.create(\"i\") ]\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst count = list.length >= 3 ? 3 : list.length;\n\t\t\tfor(let i = 0; i < count; i++)\n\t\t\t{\n\t\t\t\tconst info = list[i];\n\n\t\t\t\tconst icon = BX.create(\"i\");\n\t\t\t\tconst imageUrl = BX.prop.getString(info, \"avatar\", \"\");\n\t\t\t\tif(imageUrl !== \"\")\n\t\t\t\t{\n\t\t\t\t\ticon.style.backgroundImage = \"url(\" +  encodeURI(imageUrl) + \")\";\n\t\t\t\t}\n\n\t\t\t\tthis._userWrapper.appendChild(\n\t\t\t\t\tBX.create(\"span\",\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tprops: { className: \"crm-entity-stream-live-im-user-avatar ui-icon ui-icon-common-user\" },\n\t\t\t\t\t\t\tchildren: [ icon ]\n\t\t\t\t\t\t}\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\tif(this._layoutType === EntityChat.LayoutType.summary)\n\t\t{\n\t\t\tif(list.length > 3)\n\t\t\t{\n\t\t\t\tthis._extraUserCounter.display = \"\";\n\t\t\t\tthis._extraUserCounter.innerHTML = \"+\" + (list.length - 3).toString();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif(this._extraUserCounter.innerHTML !== \"\")\n\t\t\t\t{\n\t\t\t\t\tthis._extraUserCounter.innerHTML = \"\";\n\t\t\t\t}\n\t\t\t\tthis._extraUserCounter.display = \"none\";\n\t\t\t}\n\t\t}\n\t\telse //if(this._layoutType === EntityChat.LayoutType.invitation)\n\t\t{\n\t\t\tif(this._extraUserCounter.innerHTML !== \"\")\n\t\t\t{\n\t\t\t\tthis._extraUserCounter.innerHTML = \"\";\n\t\t\t}\n\t\t\tthis._extraUserCounter.display = \"none\";\n\n\t\t\tthis._userWrapper.appendChild(\n\t\t\t\tBX.create(\"span\", { props: { className: \"crm-entity-stream-live-im-user-invite-btn\" } })\n\t\t\t);\n\t\t}\n\t}\n\n\trefreshSummary()\n\t{\n\t\tif(this._layoutType !== EntityChat.LayoutType.summary)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst message = this.getMessageData();\n\n\t\t//region Message Date\n\t\tconst isoDate = BX.prop.getString(message, \"date\", \"\");\n\t\tif(isoDate === \"\")\n\t\t{\n\t\t\tthis._messageDateNode.innerHTML = \"\";\n\t\t}\n\t\telse\n\t\t{\n\t\t\t// @todo replace by DatetimeConverter\n\t\t\tconst remoteDate = (new Date(isoDate)).getTime() / 1000 + this.getServerTimezoneOffset() + this.getUserTimezoneOffset();\n\t\t\tconst localTime = (new Date).getTime() / 1000 + this.getServerTimezoneOffset() + this.getUserTimezoneOffset();\n\t\t\tthis._messageDateNode.innerHTML = this.formatTime(remoteDate, localTime, true);\n\t\t}\n\t\t//endregion\n\n\t\t//region Message Text\n\t\tlet text = BX.prop.getString(message, \"text\", \"\");\n\t\tconst params = BX.prop.getObject(message, \"params\", {});\n\t\tif(text === \"\")\n\t\t{\n\t\t\tthis._messageTextNode.innerHTML = \"\";\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif(typeof(top.BX.MessengerCommon) !== \"undefined\")\n\t\t\t{\n\t\t\t\ttext = top.BX.MessengerCommon.purifyText(text, params);\n\t\t\t}\n\t\t\tthis._messageTextNode.innerHTML = text;\n\t\t}\n\t\t//endregion\n\n\t\t//region Unread Message Counter\n\t\tlet counter = 0;\n\t\tconst userId = this.getUserId();\n\t\tif(userId > 0)\n\t\t{\n\t\t\tcounter = BX.prop.getInteger(\n\t\t\t\tBX.prop.getObject(\n\t\t\t\t\tBX.prop.getObject(this._data, \"USER_INFOS\", {}),\n\t\t\t\t\tuserId,\n\t\t\t\t\tnull\n\t\t\t\t),\n\t\t\t\t\"counter\",\n\t\t\t\t0\n\t\t\t);\n\t\t}\n\n\t\tthis._messageCounterNode.innerHTML = counter.toString();\n\t\tthis._messageCounterNode.style.display = counter > 0 ? \"\" : \"none\";\n\t\t//endregion\n\t}\n\n\trefreshUsersAnimated()\n\t{\n\t\tBX.removeClass(this._userWrapper, 'crm-entity-stream-live-im-message-show');\n\t\tBX.addClass(this._userWrapper, 'crm-entity-stream-live-im-message-hide');\n\n\t\twindow.setTimeout(\n\t\t\tfunction()\n\t\t\t{\n\t\t\t\tthis.refreshUsers();\n\t\t\t\twindow.setTimeout(\n\t\t\t\t\tfunction()\n\t\t\t\t\t{\n\t\t\t\t\t\tBX.removeClass(this._userWrapper, 'crm-entity-stream-live-im-message-hide');\n\t\t\t\t\t\tBX.addClass(this._userWrapper, 'crm-entity-stream-live-im-message-show');\n\t\t\t\t\t}.bind(this),\n\t\t\t\t\t50\n\t\t\t\t);\n\t\t\t}.bind(this),\n\t\t\t500\n\t\t);\n\t}\n\n\trefreshSummaryAnimated()\n\t{\n\t\tBX.removeClass(this._messageWrapper, 'crm-entity-stream-live-im-message-show');\n\t\tBX.addClass(this._messageWrapper, 'crm-entity-stream-live-im-message-hide');\n\n\t\twindow.setTimeout(\n\t\t\tfunction()\n\t\t\t{\n\t\t\t\tthis.refreshSummary();\n\t\t\t\twindow.setTimeout(\n\t\t\t\t\tfunction()\n\t\t\t\t\t{\n\t\t\t\t\t\tBX.removeClass(this._messageWrapper, 'crm-entity-stream-live-im-message-hide');\n\t\t\t\t\t\tBX.addClass(this._messageWrapper, 'crm-entity-stream-live-im-message-show');\n\t\t\t\t\t}.bind(this),\n\t\t\t\t\t50\n\t\t\t\t);\n\t\t\t}.bind(this),\n\t\t\t500\n\t\t);\n\t}\n\n\tonOpenChat(e)\n\t{\n\t\tif(typeof(top.BXIM) === \"undefined\")\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.isRestricted())\n\t\t{\n\t\t\tthis.applyLockScript();\n\n\t\t\treturn;\n\t\t}\n\n\t\tlet slug = \"\";\n\n\t\tconst chatId = this.getChatId();\n\t\tif(chatId > 0 && this.hasUserInfo(this.getUserId()))\n\t\t{\n\t\t\tslug = \"chat\" + chatId.toString();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst ownerInfo = this.getOwnerInfo();\n\t\t\tconst entityId = BX.prop.getInteger(ownerInfo, \"ENTITY_ID\", 0);\n\t\t\tconst entityTypeName = BX.prop.getString(ownerInfo, \"ENTITY_TYPE_NAME\", \"\");\n\n\t\t\tif(entityTypeName !== \"\" && entityId > 0)\n\t\t\t{\n\t\t\t\tslug = \"crm|\" + entityTypeName + \"|\" + entityId.toString();\n\t\t\t}\n\t\t}\n\n\t\tif(slug !== \"\")\n\t\t{\n\t\t\ttop.BXIM.openMessengerSlider(slug, { RECENT: \"N\", MENU: \"N\" });\n\t\t}\n\t}\n\n\tonChatEvent(command, params, extras)\n\t{\n\t\tconst chatId = this.getChatId();\n\t\tif(chatId <= 0 || chatId !== BX.prop.getInteger(params, \"chatId\", 0))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif(command === \"chatUserAdd\")\n\t\t{\n\t\t\tthis.setUserInfoData(BX.mergeEx(this.getUserInfoData(), BX.prop.getObject(params, \"users\", {})));\n\t\t\tthis.refreshUsersAnimated();\n\t\t}\n\t\telse if(command === \"chatUserLeave\")\n\t\t{\n\t\t\tthis.removeUserInfo(BX.prop.getInteger(params, \"userId\", 0));\n\t\t\tthis.refreshUsersAnimated();\n\t\t}\n\t\telse if(command === \"messageChat\")\n\t\t{\n\t\t\t//Message was added.\n\t\t\tthis.setMessageData(BX.prop.getObject(params, \"message\", {}));\n\t\t\tthis.setUnreadMessageCounter(this.getUserId(), BX.prop.getInteger(params, \"counter\", 0));\n\t\t\tthis.refreshSummaryAnimated();\n\t\t}\n\t\telse if(command === \"messageUpdate\" || command === \"messageDelete\")\n\t\t{\n\t\t\t//Message was modified or removed.\n\t\t\tif(command === \"messageDelete\")\n\t\t\t{\n\t\t\t\t//HACK: date is not in ISO format\n\t\t\t\tdelete params[\"date\"];\n\t\t\t}\n\n\t\t\tconst message = this.getMessageData();\n\t\t\tif(BX.prop.getInteger(message, \"id\", 0) === BX.prop.getInteger(params, \"id\", 0))\n\t\t\t{\n\t\t\t\tthis.setMessageData(BX.mergeEx(message, params));\n\t\t\t\tthis.refreshSummaryAnimated();\n\t\t\t}\n\t\t}\n\t\telse if(command === \"readMessageChat\")\n\t\t{\n\t\t\tthis.setUnreadMessageCounter(this.getUserId(), 0);\n\t\t\tthis.refreshSummaryAnimated();\n\t\t}\n\t\telse if(command === \"unreadMessageChat\")\n\t\t{\n\t\t\tthis.setUnreadMessageCounter(this.getUserId(), BX.prop.getInteger(params, \"counter\", 0));\n\t\t\tthis.refreshSummaryAnimated();\n\t\t}\n\t}\n\n\tgetMessage(name)\n\t{\n\t\treturn BX.prop.getString(EntityChat.messages, name, name);\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new EntityChat();\n\t\tself.initialize(id, settings);\n\t\tEntityChat.items[self.getId()] = self;\n\t\treturn self;\n\t}\n\n\tstatic items = {};\n\tstatic messages = {};\n}\n","import Manager from \"../manager\";\n\n/** @memberof BX.Crm.Timeline.Tools */\nexport default class MenuBar\n{\n\tconstructor()\n\t{\n\t\tthis._id = \"\";\n\t\tthis._ownerInfo = null;\n\t\tthis._container = null;\n\t\tthis._activityEditor = null;\n\t\tthis._commentEditor = null;\n\t\tthis._todoEditor = null;\n\t\tthis._waitEditor = null;\n\t\tthis._smsEditor = null;\n\t\tthis._zoomEditor = null;\n\t\tthis._readOnly = false;\n\n\t\tthis._menu = null;\n\t\tthis._manager = null;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new MenuBar();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n\n\tinitialize(id, settings)\n\t{\n\t\tthis._id = BX.type.isNotEmptyString(id) ? id : BX.util.getRandomString(4);\n\t\tthis._settings = settings ? settings : {};\n\n\t\tthis._ownerInfo = BX.prop.getObject(this._settings, \"ownerInfo\");\n\t\tif (!this._ownerInfo)\n\t\t{\n\t\t\tthrow \"MenuBar. A required parameter 'ownerInfo' is missing.\";\n\t\t}\n\n\t\tthis._activityEditor = BX.prop.get(this._settings, \"activityEditor\", null);\n\n\t\tthis._commentEditor = BX.prop.get(this._settings, \"commentEditor\");\n\t\tthis._todoEditor = BX.prop.get(this._settings, \"todoEditor\");\n\t\tthis._waitEditor = BX.prop.get(this._settings, \"waitEditor\");\n\t\tthis._smsEditor = BX.prop.get(this._settings, \"smsEditor\");\n\t\tthis._zoomEditor = BX.prop.get(this._settings, \"zoomEditor\");\n\t\tthis._restEditor = BX.prop.get(this._settings, \"restEditor\");\n\t\tthis._manager = BX.prop.get(this._settings, \"manager\");\n\n\t\tif (!(this._manager instanceof Manager))\n\t\t{\n\t\t\tthrow \"BX.CrmTimeline. Manager instance is not found.\";\n\t\t}\n\n\t\tthis._readOnly = BX.prop.getBoolean(this._settings, \"readOnly\", false);\n\t\tthis._menu = BX.Main.interfaceButtonsManager.getById(\n\t\t\tBX.prop.getString(this._settings, \"menuId\", (this._ownerInfo['ENTITY_TYPE_NAME'] + \"_menu\").toLowerCase())\n\t\t);\n\n\t\tBX.addCustomEvent(this._manager.getId() + \"_menu\", function (id) {\n\t\t\tthis.setActiveItemById(id);\n\t\t}.bind(this));\n\t\tthis._activeItem = this._menu.getActive();\n\t}\n\n\treset()\n\t{\n\t\tlet firstId = null;\n\t\tthis._menu.getAllItems().forEach(function (item) {\n\t\t\tif (firstId === null)\n\t\t\t{\n\t\t\t\tconst id = item.dataset.id;\n\t\t\t\tif (['comment', 'wait', 'sms', 'zoom', 'todo'].indexOf(id) >= 0 && this[(\"_\" + id + \"Editor\")])\n\t\t\t\t{\n\t\t\t\t\tfirstId = id;\n\t\t\t\t}\n\t\t\t}\n\t\t}.bind(this));\n\t\tthis.setActiveItemById(firstId || 'todo');\n\t}\n\n\tgetId()\n\t{\n\t\treturn this._id;\n\t}\n\n\tgetActiveItem()\n\t{\n\t\treturn this._activeItem;\n\t}\n\n\tgetTodoEditor()\n\t{\n\t\treturn this._todoEditor;\n\t}\n\n\tsetActiveItemById(id)\n\t{\n\t\tif (this.processItemSelection(id) === true)\n\t\t{\n\t\t\tconst currentDiv = this._menu.getItemById(id);\n\t\t\tif (currentDiv && this._activeItem !== currentDiv)\n\t\t\t{\n\t\t\t\tconst wasActiveInMoreMenu = this._menu.isActiveInMoreMenu();\n\t\t\t\tBX.addClass(currentDiv, this._menu.classes.itemActive);\n\n\t\t\t\tif (this._menu.getItemData)\n\t\t\t\t{\n\t\t\t\t\tconst currentDivData = this._menu.getItemData(currentDiv);\n\t\t\t\t\tcurrentDivData['IS_ACTIVE'] = true;\n\t\t\t\t\tif (BX.type.isDomNode(this._activeItem))\n\t\t\t\t\t{\n\t\t\t\t\t\tBX.removeClass(this._activeItem, this._menu.classes.itemActive);\n\t\t\t\t\t\tconst activeItemData = this._menu.getItemData(this._activeItem);\n\t\t\t\t\t\tactiveItemData['IS_ACTIVE'] = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\t// Old approach\n\t\t\t\t\tlet isActiveData = {};\n\t\t\t\t\ttry\n\t\t\t\t\t{\n\t\t\t\t\t\tisActiveData = JSON.parse(currentDiv.dataset.item);\n\t\t\t\t\t}\n\t\t\t\t\tcatch (err)\n\t\t\t\t\t{\n\t\t\t\t\t\tisActiveData = {};\n\t\t\t\t\t}\n\t\t\t\t\tisActiveData.IS_ACTIVE = true;\n\t\t\t\t\tcurrentDiv.dataset.item = JSON.stringify(isActiveData);\n\t\t\t\t\tlet wasActiveData = {};\n\t\t\t\t\tif (BX.type.isDomNode(this._activeItem))\n\t\t\t\t\t{\n\t\t\t\t\t\tBX.removeClass(this._activeItem, this._menu.classes.itemActive);\n\t\t\t\t\t\ttry\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\twasActiveData = JSON.parse(this._activeItem.dataset.item);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcatch (err)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\twasActiveData = {};\n\t\t\t\t\t\t}\n\t\t\t\t\t\twasActiveData.IS_ACTIVE = false;\n\t\t\t\t\t\tthis._activeItem.dataset.item = JSON.stringify(wasActiveData);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tconst isActiveInMoreMenu = this._menu.isActiveInMoreMenu();\n\t\t\t\tif (isActiveInMoreMenu || wasActiveInMoreMenu)\n\t\t\t\t{\n\t\t\t\t\tconst submenu = this._menu[\"getSubmenu\"] ? this._menu.getSubmenu() :\n\t\t\t\t\t\tBX.PopupMenu.getMenuById(\"main_buttons_popup_\" +\n\t\t\t\t\t\t\tString(this._ownerInfo['ENTITY_TYPE_NAME']).toLowerCase() + \"_menu\");\n\t\t\t\t\tif (submenu)\n\t\t\t\t\t{\n\t\t\t\t\t\tsubmenu.getMenuItems().forEach(function (menuItem) {\n\t\t\t\t\t\t\tconst container = menuItem.getContainer();\n\t\t\t\t\t\t\tif (isActiveInMoreMenu && container.title === currentDiv.title)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tBX.addClass(container, this._menu.classes.itemActive);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse if (wasActiveInMoreMenu && container.title === this._activeItem.title)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tBX.removeClass(container, this._menu.classes.itemActive);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}.bind(this));\n\t\t\t\t\t}\n\n\t\t\t\t\tif (isActiveInMoreMenu)\n\t\t\t\t\t{\n\t\t\t\t\t\tBX.addClass(this._menu.getMoreButton(), this._menu.classes.itemActive);\n\t\t\t\t\t}\n\t\t\t\t\telse if (wasActiveInMoreMenu)\n\t\t\t\t\t{\n\t\t\t\t\t\tBX.removeClass(this._menu.getMoreButton(), this._menu.classes.itemActive);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis._activeItem = currentDiv;\n\t\t\t}\n\t\t}\n\t\tthis._menu.closeSubmenu();\n\t}\n\n\tprocessItemSelection(menuId)\n\t{\n\t\tif (this._readOnly)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tlet planner = null;\n\t\tconst action = menuId;\n\t\tif (action === \"call\")\n\t\t{\n\t\t\tplanner = new BX.Crm.Activity.Planner();\n\t\t\tplanner.showEdit(\n\t\t\t\t{\n\t\t\t\t\t\"TYPE_ID\": BX.CrmActivityType.call,\n\t\t\t\t\t\"OWNER_TYPE_ID\": this._ownerInfo['ENTITY_TYPE_ID'],\n\t\t\t\t\t\"OWNER_ID\": this._ownerInfo['ENTITY_ID']\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\tif (action === \"meeting\")\n\t\t{\n\t\t\tplanner = new BX.Crm.Activity.Planner();\n\t\t\tplanner.showEdit(\n\t\t\t\t{\n\t\t\t\t\t\"TYPE_ID\": BX.CrmActivityType.meeting,\n\t\t\t\t\t\"OWNER_TYPE_ID\": this._ownerInfo['ENTITY_TYPE_ID'],\n\t\t\t\t\t\"OWNER_ID\": this._ownerInfo['ENTITY_ID']\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (action === \"email\")\n\t\t{\n\t\t\tthis._activityEditor.addEmail(\n\t\t\t\t{\n\t\t\t\t\t\"ownerType\": this._ownerInfo['ENTITY_TYPE_NAME'],\n\t\t\t\t\t\"ownerID\": this._ownerInfo['ENTITY_ID'],\n\t\t\t\t\t\"ownerUrl\": this._ownerInfo['SHOW_URL'],\n\t\t\t\t\t\"ownerTitle\": this._ownerInfo['TITLE'],\n\t\t\t\t\t\"subject\": \"\"\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (action === \"delivery\")\n\t\t{\n\t\t\tthis._activityEditor.addDelivery(\n\t\t\t\t{\n\t\t\t\t\t\"ownerType\": this._ownerInfo['ENTITY_TYPE_NAME'],\n\t\t\t\t\t\"ownerID\": this._ownerInfo['ENTITY_ID'],\n\t\t\t\t\t\"orderList\": this._ownerInfo['ORDER_LIST']\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (action === \"task\")\n\t\t{\n\t\t\tthis._activityEditor.addTask(\n\t\t\t\t{\n\t\t\t\t\t\"ownerType\": this._ownerInfo['ENTITY_TYPE_NAME'],\n\t\t\t\t\t\"ownerID\": this._ownerInfo['ENTITY_ID']\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (['comment', 'wait', 'sms', 'zoom', 'todo'].indexOf(action) >= 0 && this[(\"_\" + action + \"Editor\")])\n\t\t{\n\t\t\tif (this._commentEditor)\n\t\t\t{\n\t\t\t\tthis._commentEditor.setVisible(action === \"comment\");\n\t\t\t}\n\t\t\tif (this._todoEditor)\n\t\t\t{\n\t\t\t\tthis._todoEditor.setVisible(action === 'todo');\n\t\t\t}\n\t\t\tif (this._waitEditor)\n\t\t\t{\n\t\t\t\tthis._waitEditor.setVisible(action === \"wait\");\n\t\t\t}\n\t\t\tif (this._smsEditor)\n\t\t\t{\n\t\t\t\tthis._smsEditor.setVisible(action === \"sms\");\n\t\t\t}\n\t\t\tif (this._zoomEditor)\n\t\t\t{\n\t\t\t\tthis._zoomEditor.setVisible(action === \"zoom\");\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\t\telse if (action === \"visit\")\n\t\t{\n\t\t\tconst visitParameters = this._manager.getSetting(\"visitParameters\");\n\t\t\tvisitParameters['OWNER_TYPE'] = this._ownerInfo['ENTITY_TYPE_NAME'];\n\t\t\tvisitParameters['OWNER_ID'] = this._ownerInfo['ENTITY_ID'];\n\t\t\tBX.CrmActivityVisit.create(visitParameters).showEdit();\n\t\t}\n\t\telse if (action.match(/^activity_rest_/))\n\t\t{\n\t\t\tif (this._restEditor)\n\t\t\t{\n\t\t\t\tthis._restEditor.action(action);\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tgetMenuItems()\n\t{\n\t\treturn this._menu.getAllItems();\n\t}\n}\n","/** @memberof BX.Crm.Timeline.Tools */\nexport default class AudioPlaybackRateSelector\n{\n\tconstructor(params)\n\t{\n\t\tthis.name = params.name || 'crm-timeline-audio-playback-rate-selector';\n\t\tthis.menuId = this.name + '-menu';\n\t\tif(BX.Type.isArray(params.availableRates))\n\t\t{\n\t\t\tthis.availableRates = params.availableRates;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.availableRates = [1, 1.5, 2, 3];\n\t\t}\n\t\tthis.currentRate = this.normalizeRate(params.currentRate);\n\t\tthis.textMessageCode = params.textMessageCode;\n\t\tthis.renderedItems = [];\n\t\tthis.players = [];\n\t}\n\n\tisRateCurrent(rateDescription, rate)\n\t{\n\t\treturn ((rateDescription.rate && rate === rateDescription.rate) || rate === rateDescription);\n\t}\n\n\tnormalizeRate(rate)\n\t{\n\t\trate = parseFloat(rate);\n\t\tlet i = 0;\n\t\tconst length = this.availableRates.length;\n\t\tfor(; i < length; i++)\n\t\t{\n\t\t\tif(this.isRateCurrent(this.availableRates[i], rate))\n\t\t\t{\n\t\t\t\treturn rate;\n\t\t\t}\n\t\t}\n\n\t\treturn (this.availableRates[0].rate || this.availableRates[0]);\n\t}\n\n\tgetMenuItems()\n\t{\n\t\tconst selectedRate = this.getRate();\n\n\t\treturn this.availableRates.map(function(item) {\n\t\t\treturn {\n\t\t\t\ttext: (item.text || item) + '',\n\t\t\t\thtml: (item.html || item) + '',\n\t\t\t\tclassName: (this.isRateCurrent(item, selectedRate)) ? 'menu-popup-item-text-active' : null,\n\t\t\t\tonclick: function() {\n\t\t\t\t\tthis.setRate(item.rate || item)\n\t\t\t\t}.bind(this)\n\t\t\t}\n\t\t}.bind(this))\n\t}\n\n\tgetPopup(node)\n\t{\n\t\tlet popupMenu = BX.Main.MenuManager.getMenuById(this.menuId);\n\t\tif(popupMenu)\n\t\t{\n\t\t\tconst popupWindow = popupMenu.getPopupWindow();\n\t\t\tif (popupWindow)\n\t\t\t{\n\t\t\t\tpopupWindow.setBindElement(node);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tpopupMenu = BX.Main.MenuManager.create({\n\t\t\t\tid: this.menuId,\n\t\t\t\tbindElement: node,\n\t\t\t\titems: this.getMenuItems(),\n\t\t\t\tclassName: 'crm-audio-cap-speed-popup'\n\t\t\t});\n\t\t}\n\n\t\treturn popupMenu;\n\t}\n\n\tgetRate()\n\t{\n\t\treturn this.normalizeRate(this.currentRate);\n\t}\n\n\tsetRate(rate)\n\t{\n\t\tthis.getPopup().destroy();\n\n\t\trate = this.normalizeRate(rate);\n\t\tif(this.currentRate === rate)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tthis.currentRate = rate;\n\t\tBX.userOptions.save(\"crm\", this.name, 'rate', rate);\n\n\t\tfor(let i = 0, length = this.renderedItems.length; i < length; i++)\n\t\t{\n\t\t\tconst textNode = this.renderedItems[i].querySelector('.crm-audio-cap-speed-text');\n\t\t\tif(textNode)\n\t\t\t{\n\t\t\t\ttextNode.innerHTML = this.getText();\n\t\t\t}\n\t\t}\n\n\t\tfor(let i = 0, length = this.players.length; i < length; i++)\n\t\t{\n\t\t\tthis.players[i].vjsPlayer.playbackRate(this.getRate());\n\t\t}\n\t}\n\n\tgetText()\n\t{\n\t\tlet text;\n\n\t\tif(this.textMessageCode)\n\t\t{\n\t\t\ttext = BX.Loc.getMessage(this.textMessageCode);\n\t\t}\n\t\tif(!text)\n\t\t{\n\t\t\ttext = '#RATE#';\n\t\t}\n\n\t\treturn text.replace('#RATE#', '<span>' + this.getRate() + 'x</span>');\n\t}\n\n\trender()\n\t{\n\t\tconst item = BX.Dom.create('div', {\n\t\t\tattrs: {\n\t\t\t\tclassName: 'crm-audio-cap-speed-wrapper'\n\t\t\t},\n\t\t\tchildren: [\n\t\t\t\tBX.Dom.create('div', {\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\tclassName: 'crm-audio-cap-speed',\n\t\t\t\t\t},\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tBX.Dom.create('div', {\n\t\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\t\tclassName: 'crm-audio-cap-speed-text'\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\thtml: this.getText()\n\t\t\t\t\t\t})\n\t\t\t\t\t],\n\t\t\t\t})\n\t\t\t],\n\t\t\tevents: {\n\t\t\t\tclick: function (event) {\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tthis.getPopup(event.target).show()\n\t\t\t\t}.bind(this)\n\t\t\t}\n\t\t});\n\t\tthis.renderedItems.push(item);\n\n\t\treturn item;\n\t}\n\n\taddPlayer(player)\n\t{\n\t\tif(BX.Fileman.Player && player instanceof BX.Fileman.Player)\n\t\t{\n\t\t\tthis.players.push(player);\n\t\t}\n\t}\n}\n","/** @memberof BX.Crm.Timeline.Tools */\nexport default class SchedulePostponeController\n{\n\tconstructor()\n\t{\n\t\tthis._item = null;\n\t}\n\n\tinitialize(id, settings)\n\t{\n\t\tthis._id = BX.type.isNotEmptyString(id) ? id : BX.util.getRandomString(4);\n\t\tthis._settings = settings ? settings : {};\n\t\tthis._item = BX.prop.get(this._settings, \"item\", null);\n\t}\n\n\tgetTitle()\n\t{\n\t\treturn this.getMessage(\"title\");\n\t}\n\n\tgetCommandList()\n\t{\n\t\treturn(\n\t\t\t[\n\t\t\t\t{ name: \"postpone_hour_1\", title: this.getMessage(\"forOneHour\") },\n\t\t\t\t{ name: \"postpone_hour_2\", title: this.getMessage(\"forTwoHours\") },\n\t\t\t\t{ name: \"postpone_hour_3\", title: this.getMessage(\"forThreeHours\") },\n\t\t\t\t{ name: \"postpone_day_1\", title: this.getMessage(\"forOneDay\") },\n\t\t\t\t{ name: \"postpone_day_2\", title: this.getMessage(\"forTwoDays\") },\n\t\t\t\t{ name: \"postpone_day_3\", title: this.getMessage(\"forThreeDays\") }\n\t\t\t]\n\t\t);\n\t}\n\n\tprocessCommand(command)\n\t{\n\t\tif(command.indexOf(\"postpone\") !== 0)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tlet offset = 0;\n\t\tif(command === \"postpone_hour_1\")\n\t\t{\n\t\t\toffset = 3600;\n\t\t}\n\t\telse if(command === \"postpone_hour_2\")\n\t\t{\n\t\t\toffset = 7200;\n\t\t}\n\t\telse if(command === \"postpone_hour_3\")\n\t\t{\n\t\t\toffset = 10800;\n\t\t}\n\t\telse if(command === \"postpone_day_1\")\n\t\t{\n\t\t\toffset = 86400;\n\t\t}\n\t\telse if(command === \"postpone_day_2\")\n\t\t{\n\t\t\toffset = 172800;\n\t\t}\n\t\telse if(command === \"postpone_day_3\")\n\t\t{\n\t\t\toffset = 259200;\n\t\t}\n\n\t\tif(offset > 0 && this._item)\n\t\t{\n\t\t\tthis._item.postpone(offset);\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = SchedulePostponeController.messages;\n\t\treturn m.hasOwnProperty(name) ? m[name] : name;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new SchedulePostponeController();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n\n\tstatic messages = {};\n}\n","import Scheduled from \"../scheduled\";\nimport {Item as ItemType} from \"../../types\";\nimport SchedulePostponeController from \"../../tools/schedule-postpone-controller\";\nimport {DatetimeConverter} from \"crm.timeline.tools\";\n\n/** @memberof BX.Crm.Timeline.Items.Scheduled */\nexport default class Activity extends Scheduled\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._postponeController = null;\n\t}\n\n\tgetTypeId()\n\t{\n\t\treturn ItemType.activity;\n\t}\n\n\tisDone()\n\t{\n\t\tconst status = BX.prop.getInteger(this.getAssociatedEntityData(), \"STATUS\");\n\t\treturn (status ===  BX.CrmActivityStatus.completed || status ===  BX.CrmActivityStatus.autoCompleted);\n\t}\n\n\tsetAsDone(isDone)\n\t{\n\t\tisDone = !!isDone;\n\t\tif(this.isDone() === isDone)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst id = BX.prop.getInteger(this.getAssociatedEntityData(), \"ID\", 0);\n\t\tif(id > 0)\n\t\t{\n\t\t\tthis._activityEditor.setActivityCompleted(\n\t\t\t\tid,\n\t\t\t\tisDone,\n\t\t\t\tBX.delegate(this.onSetAsDoneCompleted, this)\n\t\t\t);\n\t\t}\n\t}\n\n\tpostpone(offset)\n\t{\n\t\tconst id = this.getSourceId();\n\t\tif(id > 0 && offset > 0)\n\t\t{\n\t\t\tthis._activityEditor.postponeActivity(\n\t\t\t\tid,\n\t\t\t\toffset,\n\t\t\t\tBX.delegate(this.onPosponeCompleted, this)\n\t\t\t);\n\t\t}\n\t}\n\n\tview()\n\t{\n\t\tconst id = BX.prop.getInteger(this.getAssociatedEntityData(), \"ID\", 0);\n\t\tif(id > 0)\n\t\t{\n\t\t\tthis._activityEditor.viewActivity(id);\n\t\t}\n\t}\n\n\tedit()\n\t{\n\t\tthis.closeContextMenu();\n\t\tconst associatedEntityTypeId = this.getAssociatedEntityTypeId();\n\t\tif(associatedEntityTypeId === BX.CrmEntityType.enumeration.activity)\n\t\t{\n\t\t\tconst entityData = this.getAssociatedEntityData();\n\t\t\tconst id = BX.prop.getInteger(entityData, \"ID\", 0);\n\t\t\tif(id > 0)\n\t\t\t{\n\t\t\t\tthis._activityEditor.editActivity(id);\n\t\t\t}\n\t\t}\n\t}\n\n\tprocessRemoval()\n\t{\n\t\tthis.closeContextMenu();\n\t\tthis._detetionConfirmDlgId = \"entity_timeline_deletion_\" + this.getId() + \"_confirm\";\n\t\tlet dlg = BX.Crm.ConfirmationDialog.get(this._detetionConfirmDlgId);\n\t\tif(!dlg)\n\t\t{\n\t\t\tdlg = BX.Crm.ConfirmationDialog.create(\n\t\t\t\tthis._detetionConfirmDlgId,\n\t\t\t\t{\n\t\t\t\t\ttitle: this.getMessage(\"removeConfirmTitle\"),\n\t\t\t\t\tcontent: this.getRemoveMessage()\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\tdlg.open().then(BX.delegate(this.onRemovalConfirm, this), BX.delegate(this.onRemovalCancel, this));\n\t}\n\n\tgetRemoveMessage()\n\t{\n\t\treturn this.getMessage('removeConfirm');\n\t}\n\n\tonRemovalConfirm(result)\n\t{\n\t\tif(BX.prop.getBoolean(result, \"cancel\", true))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.remove();\n\t}\n\n\tonRemovalCancel()\n\t{\n\t}\n\n\tremove()\n\t{\n\t\tconst associatedEntityTypeId = this.getAssociatedEntityTypeId();\n\n\t\tif(associatedEntityTypeId === BX.CrmEntityType.enumeration.activity)\n\t\t{\n\t\t\tconst entityData = this.getAssociatedEntityData();\n\n\t\t\tconst id = BX.prop.getInteger(entityData, \"ID\", 0);\n\n\t\t\tif(id > 0)\n\t\t\t{\n\t\t\t\tconst activityEditor = this._activityEditor;\n\t\t\t\tconst item = activityEditor.getItemById(id);\n\t\t\t\tif (item)\n\t\t\t\t{\n\t\t\t\t\tactivityEditor.deleteActivity(id, true);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tconst activityType = activityEditor.getSetting('ownerType', '');\n\t\t\t\t\tconst activityId = activityEditor.getSetting('ownerID', '');\n\n\t\t\t\t\tconst serviceUrl = BX.util.add_url_param(activityEditor.getSetting('serviceUrl', ''),\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tid: id,\n\t\t\t\t\t\t\taction: 'get_activity',\n\t\t\t\t\t\t\townertype: activityType,\n\t\t\t\t\t\t\townerid: activityId\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t\tBX.ajax({\n\t\t\t\t\t\t'url': serviceUrl,\n\t\t\t\t\t\t'method': 'POST',\n\t\t\t\t\t\t'dataType': 'json',\n\t\t\t\t\t\t'data':\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t'ACTION' : 'GET_ACTIVITY',\n\t\t\t\t\t\t\t\t'ID': id,\n\t\t\t\t\t\t\t\t'OWNER_TYPE': activityType,\n\t\t\t\t\t\t\t\t'OWNER_ID': activityId\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\tonsuccess: BX.delegate(\n\t\t\t\t\t\t\tfunction(data)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tif(typeof(data['ACTIVITY']) !== 'undefined')\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tactivityEditor._handleActivityChange(data['ACTIVITY']);\n\t\t\t\t\t\t\t\t\twindow.setTimeout(BX.delegate(this.remove ,this), 500);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tthis\n\t\t\t\t\t\t),\n\t\t\t\t\t\tonfailure: function(data){}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tgetDeadline()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst time = BX.parseDate(\n\t\t\tentityData[\"DEADLINE_SERVER\"],\n\t\t\tfalse,\n\t\t\t\"YYYY-MM-DD\",\n\t\t\t\"YYYY-MM-DD HH:MI:SS\"\n\t\t);\n\n\t\tif(!time)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn (new DatetimeConverter(time)).toUserTime().getValue();\n\t}\n\n\tgetCreatedDate()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst time = BX.parseDate(\n\t\t\tentityData[\"CREATED_SERVER\"],\n\t\t\tfalse,\n\t\t\t\"YYYY-MM-DD\",\n\t\t\t\"YYYY-MM-DD HH:MI:SS\"\n\t\t);\n\n\t\tif(!time)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn (new DatetimeConverter(time)).toUserTime().getValue();\n\t}\n\n\tisIncomingChannel()\n\t{\n\t\tif (this.isDone())\n\t\t{\n\t\t\treturn false;\n\t\t}\n\t\tconst entityData = this.getAssociatedEntityData();\n\n\t\treturn entityData.hasOwnProperty('IS_INCOMING_CHANNEL') && entityData.IS_INCOMING_CHANNEL === 'Y';\n\t}\n\n\tmarkAsDone(isDone)\n\t{\n\t\tisDone = !!isDone;\n\t\tthis.getAssociatedEntityData()[\"STATUS\"] = isDone ? BX.CrmActivityStatus.completed : BX.CrmActivityStatus.waiting;\n\t}\n\n\tgetPrepositionText(direction)\n\t{\n\t\treturn this.getMessage(direction === BX.CrmActivityDirection.incoming ? \"from\" : \"to\");\n\t}\n\n\tgetTypeDescription(direction)\n\t{\n\t\treturn \"\";\n\t}\n\n\tisContextMenuEnabled()\n\t{\n\t\treturn ((!!this.getDeadline() && this.canPostpone()) || this.canComplete());\n\t}\n\n\tprepareContent(options)\n\t{\n\t\tlet timeText = '';\n\t\tconst isIncomingChannel = this.isIncomingChannel();\n\t\tif (isIncomingChannel)\n\t\t{\n\t\t\ttimeText = this.formatDateTime(this.getCreatedDate());\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst deadline = this.getDeadline();\n\t\t\ttimeText = deadline ? this.formatDateTime(deadline) : this.getMessage(\"termless\");\n\t\t}\n\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst direction = BX.prop.getInteger(entityData, \"DIRECTION\", 0);\n\t\tconst isDone = this.isDone();\n\t\tconst subject = BX.prop.getString(entityData, \"SUBJECT\", \"\");\n\t\tlet description = BX.prop.getString(entityData, \"DESCRIPTION_RAW\", \"\");\n\n\t\tconst communication = BX.prop.getObject(entityData, \"COMMUNICATION\", {});\n\t\tconst title = BX.prop.getString(communication, \"TITLE\", \"\");\n\t\tconst showUrl = BX.prop.getString(communication, \"SHOW_URL\", \"\");\n\t\tconst communicationValue = BX.prop.getString(communication, \"TYPE\", \"\") !== \"\"\n\t\t\t? BX.prop.getString(communication, \"VALUE\", \"\") : \"\";\n\n\t\tlet wrapperClassName = this.getWrapperClassName();\n\t\tif(wrapperClassName !== \"\")\n\t\t{\n\t\t\twrapperClassName = this._schedule.getItemClassName() + \" \" + wrapperClassName;\n\t\t}\n\t\telse\n\t\t{\n\t\t\twrapperClassName = this._schedule.getItemClassName();\n\t\t}\n\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: wrapperClassName}});\n\n\t\tlet iconClassName = this.getIconClassName();\n\t\tif(this.isCounterEnabled())\n\t\t{\n\t\t\ticonClassName += \" crm-entity-stream-section-counter\";\n\t\t}\n\t\tif(isIncomingChannel)\n\t\t{\n\t\t\ticonClassName += \" crm-entity-stream-section-counter --incoming-counter\";\n\t\t}\n\t\twrapper.appendChild(BX.create(\"DIV\", { attrs: { className: iconClassName } }));\n\n\t\t//region Context Menu\n\t\tif(this.isContextMenuEnabled())\n\t\t{\n\t\t\twrapper.appendChild(this.prepareContextMenuButton());\n\t\t}\n\t\t//endregion\n\n\t\tconst contentWrapper = BX.create(\"DIV\",\n\t\t\t{attrs: {className: \"crm-entity-stream-section-content\"}}\n\t\t);\n\t\twrapper.appendChild(contentWrapper);\n\n\t\t//region Details\n\t\tif(description !== \"\")\n\t\t{\n\t\t\t//trim leading spaces\n\t\t\tdescription = description.replace(/^\\s+/,'');\n\t\t}\n\n\t\tconst contentInnerWrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-event\"}\n\t\t\t}\n\t\t);\n\t\tcontentWrapper.appendChild(contentInnerWrapper);\n\n\t\tthis._deadlineNode = BX.create(\"SPAN\",\n\t\t\t{ attrs: { className: \"crm-entity-stream-content-event-time\" }, text: timeText }\n\t\t);\n\n\t\tconst headerWrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-header\"}\n\t\t\t}\n\t\t);\n\t\theaderWrapper.appendChild(BX.create(\"SPAN\",\n\t\t\t{\n\t\t\t\tattrs:\n\t\t\t\t\t{\n\t\t\t\t\t\tclassName: \"crm-entity-stream-content-event-title\"\n\t\t\t\t\t},\n\t\t\t\ttext: this.getTypeDescription(direction)\n\t\t\t}\n\t\t));\n\n\t\tconst statusNode = this.getStatusNode();\n\t\tif (statusNode)\n\t\t{\n\t\t\theaderWrapper.appendChild(statusNode);\n\t\t}\n\t\theaderWrapper.appendChild(this._deadlineNode);\n\n\t\tcontentInnerWrapper.appendChild(headerWrapper);\n\n\t\tconst detailWrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail\"}\n\t\t\t}\n\t\t);\n\t\tcontentInnerWrapper.appendChild(detailWrapper);\n\n\t\tdetailWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail-title\"},\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattrs: { href: \"#\" },\n\t\t\t\t\t\t\t\t\tevents: { \"click\": this._headerClickHandler },\n\t\t\t\t\t\t\t\t\ttext: subject\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tdetailWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-description\" },\n\t\t\t\t\ttext: this.cutOffText(description, 128)\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst additionalDetails = this.prepareDetailNodes();\n\t\tif(BX.type.isArray(additionalDetails))\n\t\t{\n\t\t\tlet i = 0;\n\t\t\tconst length = additionalDetails.length;\n\t\t\tfor(; i < length; i++)\n\t\t\t{\n\t\t\t\tdetailWrapper.appendChild(additionalDetails[i]);\n\t\t\t}\n\t\t}\n\n\t\tconst members = BX.create(\"DIV\",\n\t\t\t{attrs: {className: \"crm-entity-stream-content-detail-contact-info\"}}\n\t\t);\n\n\t\tif(title !== '')\n\t\t{\n\t\t\tmembers.appendChild(\n\t\t\t\tBX.create(\"SPAN\",\n\t\t\t\t\t{ text: this.getPrepositionText(direction) + \": \" }\n\t\t\t\t)\n\t\t\t);\n\n\t\t\tif(showUrl !== '')\n\t\t\t{\n\t\t\t\tmembers.appendChild(\n\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tattrs: { href: showUrl },\n\t\t\t\t\t\t\ttext: title\n\t\t\t\t\t\t}\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tmembers.appendChild(BX.create(\"SPAN\", { text: title }));\n\t\t\t}\n\t\t}\n\n\t\tif(communicationValue !== '')\n\t\t{\n\t\t\tconst communicationNode = this.prepareCommunicationNode(communicationValue);\n\t\t\tif(communicationNode)\n\t\t\t{\n\t\t\t\tmembers.appendChild(communicationNode);\n\t\t\t}\n\t\t}\n\n\t\tdetailWrapper.appendChild(members);\n\t\t//endregion\n\t\t//region Set as Done Button\n\t\tconst setAsDoneButton = BX.create(\"INPUT\",\n\t\t\t{\n\t\t\t\tattrs:\n\t\t\t\t\t{\n\t\t\t\t\t\ttype: \"checkbox\",\n\t\t\t\t\t\tclassName: \"crm-entity-stream-planned-apply-btn\",\n\t\t\t\t\t\tchecked: isDone\n\t\t\t\t\t},\n\t\t\t\tevents: {change: this._setAsDoneButtonHandler}\n\t\t\t}\n\t\t);\n\n\t\tif(!this.canComplete())\n\t\t{\n\t\t\tsetAsDoneButton.disabled = true;\n\t\t}\n\n\t\tconst buttonContainer = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail-planned-action\"},\n\t\t\t\tchildren: [setAsDoneButton]\n\t\t\t}\n\t\t);\n\t\tcontentInnerWrapper.appendChild(buttonContainer);\n\t\t//endregion\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontentInnerWrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\t//region  Actions\n\t\tthis._actionContainer = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-action\" }\n\t\t\t}\n\t\t);\n\t\tcontentInnerWrapper.appendChild(this._actionContainer);\n\t\t//endregion\n\n\t\treturn wrapper;\n\t}\n\n\tgetStatusNode()\n\t{\n\t\treturn null;\n\t}\n\n\tprepareCommunicationNode(communicationValue)\n\t{\n\t\treturn BX.create(\"SPAN\", { text: \" \" + communicationValue });\n\t}\n\n\tprepareDetailNodes()\n\t{\n\t\treturn [];\n\t}\n\n\tprepareContextMenuItems()\n\t{\n\t\tconst menuItems = [];\n\n\t\tif (!this.isReadOnly())\n\t\t{\n\t\t\tif (this.isEditable())\n\t\t\t{\n\t\t\t\tmenuItems.push({ id: \"edit\", text: this.getMessage(\"menuEdit\"), onclick: BX.delegate(this.edit, this)});\n\t\t\t}\n\n\t\t\tmenuItems.push({ id: \"remove\", text: this.getMessage(\"menuDelete\"), onclick: BX.delegate(this.processRemoval, this)});\n\t\t}\n\n\t\tif (this.canPostpone())\n\t\t{\n\t\t\tconst handler = BX.delegate(this.onContextMenuItemSelect, this);\n\n\t\t\tif(!this._postponeController)\n\t\t\t{\n\t\t\t\tthis._postponeController = SchedulePostponeController.create(\"\", { item: this });\n\t\t\t}\n\n\t\t\tconst postponeMenu =\n\t\t\t\t{\n\t\t\t\t\tid: \"postpone\",\n\t\t\t\t\ttext: this._postponeController.getTitle(),\n\t\t\t\t\titems: []\n\t\t\t\t};\n\n\t\t\tconst commands = this._postponeController.getCommandList();\n\t\t\tlet i = 0;\n\t\t\tconst length = commands.length;\n\t\t\tfor(; i < length; i++)\n\t\t\t{\n\t\t\t\tconst command = commands[i];\n\t\t\t\tpostponeMenu.items.push(\n\t\t\t\t\t{\n\t\t\t\t\t\tid: command[\"name\"],\n\t\t\t\t\t\ttext: command[\"title\"],\n\t\t\t\t\t\tonclick: handler\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t\tmenuItems.push(postponeMenu);\n\t\t}\n\n\t\treturn menuItems;\n\t}\n\n\tonContextMenuItemSelect(e, item)\n\t{\n\t\tthis.closeContextMenu();\n\t\tif(this._postponeController)\n\t\t{\n\t\t\tthis._postponeController.processCommand(item.id);\n\t\t}\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Activity();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import Activity from \"./activity\";\n\n/** @memberof BX.Crm.Timeline.Items.Scheduled */\nexport default class Email extends Activity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetWrapperClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-email\";\n\t}\n\n\tgetIconClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-icon crm-entity-stream-section-icon-email\";\n\t}\n\n\tprepareActions()\n\t{\n\t\tif(this.isReadOnly())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis._actions.push(\n\t\t\tBX.CrmScheduleEmailAction.create(\n\t\t\t\t\"email\",\n\t\t\t\t{\n\t\t\t\t\titem: this,\n\t\t\t\t\tcontainer: this._actionContainer,\n\t\t\t\t\tentityData: this.getAssociatedEntityData(),\n\t\t\t\t\tactivityEditor: this._activityEditor\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t}\n\n\tgetTypeDescription(direction)\n\t{\n\t\treturn this.getMessage(direction === BX.CrmActivityDirection.incoming ? \"incomingEmail\" : \"outgoingEmail\");\n\t}\n\n\tgetRemoveMessage()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tlet title = BX.prop.getString(entityData, \"SUBJECT\", \"\");\n\t\ttitle = BX.util.htmlspecialchars(title);\n\t\treturn this.getMessage('emailRemove').replace(\"#TITLE#\", title);\n\t}\n\n\tisEditable()\n\t{\n\t\treturn false;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Email();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import Activity from \"./activity\";\n\n/** @memberof BX.Crm.Timeline.Items.Scheduled */\nexport default class Call extends Activity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetWrapperClassName()\n\t{\n\t\treturn 'crm-entity-stream-section-call';\n\t}\n\n\tgetIconClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-icon crm-entity-stream-section-icon-call\";\n\t}\n\n\tprepareActions()\n\t{\n\t\tif(this.isReadOnly())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis._actions.push(\n\t\t\tBX.CrmScheduleCallAction.create(\n\t\t\t\t\"call\",\n\t\t\t\t{\n\t\t\t\t\titem: this,\n\t\t\t\t\tcontainer: this._actionContainer,\n\t\t\t\t\tentityData: this.getAssociatedEntityData(),\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\townerInfo: this._schedule.getOwnerInfo()\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t}\n\n\tgetTypeDescription(direction)\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst callInfo = BX.prop.getObject(entityData, \"CALL_INFO\", null);\n\t\tconst callTypeText = callInfo !== null ? BX.prop.getString(callInfo, \"CALL_TYPE_TEXT\", \"\") : \"\";\n\t\tif(callTypeText !== \"\")\n\t\t{\n\t\t\treturn callTypeText;\n\t\t}\n\n\t\treturn this.getMessage(direction === BX.CrmActivityDirection.incoming ? \"incomingCall\" : \"outgoingCall\");\n\t}\n\n\tgetRemoveMessage()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst direction = BX.prop.getInteger(entityData, \"DIRECTION\", 0);\n\t\tlet title = BX.prop.getString(entityData, \"SUBJECT\", \"\");\n\t\tconst messageName = (direction === BX.CrmActivityDirection.incoming) ? 'incomingCallRemove' : 'outgoingCallRemove';\n\t\ttitle = BX.util.htmlspecialchars(title);\n\t\treturn this.getMessage(messageName).replace(\"#TITLE#\", title);\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Call();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import Call from \"./call\";\n\n/** @memberof BX.Crm.Timeline.Items.Scheduled */\nexport default class CallTracker extends Call\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetStatusNode()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst callInfo = BX.prop.getObject(entityData, \"CALL_INFO\", null);\n\n\t\tif (!callInfo)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\t\tif (!BX.prop.getBoolean(callInfo, \"HAS_STATUS\", false))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst isSuccessfull = BX.prop.getBoolean(callInfo, \"SUCCESSFUL\", false);\n\t\tconst statusText = BX.prop.getString(callInfo, \"STATUS_TEXT\", \"\");\n\n\t\treturn BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs:\n\t\t\t\t\t{\n\t\t\t\t\t\tclassName: isSuccessfull\n\t\t\t\t\t\t\t? \"crm-entity-stream-content-event-successful\"\n\t\t\t\t\t\t\t: \"crm-entity-stream-content-event-missing\"\n\t\t\t\t\t},\n\t\t\t\ttext: statusText\n\t\t\t}\n\t\t)\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new CallTracker();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import Activity from \"./activity\";\n\n/** @memberof BX.Crm.Timeline.Items.Scheduled */\nexport default class Meeting extends Activity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetWrapperClassName()\n\t{\n\t\treturn \"\";\n\t}\n\n\tgetIconClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-icon crm-entity-stream-section-icon-meeting\";\n\t}\n\n\tprepareActions()\n\t{\n\t}\n\n\tgetPrepositionText()\n\t{\n\t\treturn this.getMessage(\"reciprocal\");\n\t}\n\n\tgetRemoveMessage()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tlet title = BX.prop.getString(entityData, \"SUBJECT\", \"\");\n\t\ttitle = BX.util.htmlspecialchars(title);\n\t\treturn this.getMessage('meetingRemove').replace(\"#TITLE#\", title);\n\t}\n\n\tgetTypeDescription()\n\t{\n\t\treturn this.getMessage(\"meeting\");\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Meeting();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import Activity from \"./activity\";\n\n/** @memberof BX.Crm.Timeline.Items.Scheduled */\nexport default class Task extends Activity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetWrapperClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-planned-task\";\n\t}\n\n\tgetIconClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-icon crm-entity-stream-section-icon-task\";\n\t}\n\n\tgetTypeDescription()\n\t{\n\t\treturn this.getMessage(\"task\");\n\t}\n\n\tgetPrepositionText(direction)\n\t{\n\t\treturn this.getMessage(\"reciprocal\");\n\t}\n\n\tgetRemoveMessage()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tlet title = BX.prop.getString(entityData, \"SUBJECT\", \"\");\n\t\ttitle = BX.util.htmlspecialchars(title);\n\t\treturn this.getMessage('taskRemove').replace(\"#TITLE#\", title);\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Task();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import Activity from \"./activity\";\n\n/** @memberof BX.Crm.Timeline.Items.Scheduled */\nexport default class WebForm extends Activity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetWrapperClassName()\n\t{\n\t\treturn \"\";\n\t}\n\n\tgetIconClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-icon crm-entity-stream-section-icon-crmForm\";\n\t}\n\n\tprepareActions()\n\t{\n\t}\n\n\tgetPrepositionText()\n\t{\n\t\treturn this.getMessage(\"from\");\n\t}\n\n\tgetTypeDescription()\n\t{\n\t\treturn this.getMessage(\"webform\");\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new WebForm();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import Scheduled from \"../scheduled\";\nimport {Item as ItemType} from \"../../types\";\nimport SchedulePostponeController from \"../../tools/schedule-postpone-controller\";\nimport {DatetimeConverter} from \"crm.timeline.tools\";\n\n/** @memberof BX.Crm.Timeline.Items.Scheduled */\nexport default class Wait extends Scheduled\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._postponeController = null;\n\t}\n\n\tgetTypeId()\n\t{\n\t\treturn ItemType.wait;\n\t}\n\n\tgetWrapperClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-wait\";\n\t}\n\n\tgetIconClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-icon crm-entity-stream-section-icon-wait\";\n\t}\n\n\tprepareActions()\n\t{\n\t}\n\n\tisCounterEnabled()\n\t{\n\t\treturn false;\n\t}\n\n\tgetDeadline()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst time = BX.parseDate(\n\t\t\tentityData[\"DEADLINE_SERVER\"],\n\t\t\tfalse,\n\t\t\t\"YYYY-MM-DD\",\n\t\t\t\"YYYY-MM-DD HH:MI:SS\"\n\t\t);\n\n\t\tif(!time)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn (new DatetimeConverter(time)).toUserTime().getValue();\n\t}\n\n\tisDone()\n\t{\n\t\treturn (BX.prop.getString(this.getAssociatedEntityData(), \"COMPLETED\", \"N\") ===  \"Y\");\n\t}\n\n\tsetAsDone(isDone)\n\t{\n\t\tisDone = !!isDone;\n\t\tif(this.isDone() === isDone)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst id = this.getAssociatedEntityId();\n\t\tif(id > 0)\n\t\t{\n\t\t\tconst editor = this._schedule.getManager().getWaitEditor();\n\t\t\tif(editor)\n\t\t\t{\n\t\t\t\teditor.complete(\n\t\t\t\t\tid,\n\t\t\t\t\tisDone,\n\t\t\t\t\tBX.delegate(this.onSetAsDoneCompleted, this)\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n\n\tpostpone(offset)\n\t{\n\t\tconst id = this.getAssociatedEntityId();\n\t\tif(id > 0 && offset > 0)\n\t\t{\n\t\t\tconst editor = this._schedule.getManager().getWaitEditor();\n\t\t\tif(editor)\n\t\t\t{\n\t\t\t\teditor.postpone(\n\t\t\t\t\tid,\n\t\t\t\t\toffset,\n\t\t\t\t\tBX.delegate(this.onPosponeCompleted, this)\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n\n\tisContextMenuEnabled()\n\t{\n\t\treturn !!this.getDeadline() && this.canPostpone();\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst deadline = this.getDeadline();\n\t\tconst timeText = deadline ? this.formatDateTime(deadline) : this.getMessage(\"termless\");\n\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst isDone = this.isDone();\n\t\tlet description = BX.prop.getString(entityData, \"DESCRIPTION_RAW\", \"\");\n\n\t\tlet wrapperClassName = this.getWrapperClassName();\n\t\tif(wrapperClassName !== \"\")\n\t\t{\n\t\t\twrapperClassName = \"crm-entity-stream-section crm-entity-stream-section-planned\" + \" \" + wrapperClassName;\n\t\t}\n\t\telse\n\t\t{\n\t\t\twrapperClassName = \"crm-entity-stream-section crm-entity-stream-section-planned\";\n\t\t}\n\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: wrapperClassName}});\n\n\t\tlet iconClassName = this.getIconClassName();\n\t\tif(this.isCounterEnabled())\n\t\t{\n\t\t\ticonClassName += \" crm-entity-stream-section-counter\";\n\t\t}\n\n\t\twrapper.appendChild(BX.create(\"DIV\", { attrs: { className: iconClassName } }));\n\n\t\t//region Context Menu\n\t\tif(this.isContextMenuEnabled())\n\t\t{\n\t\t\twrapper.appendChild(this.prepareContextMenuButton());\n\t\t}\n\t\t//endregion\n\n\t\tconst contentWrapper = BX.create(\"DIV\",\n\t\t\t{attrs: {className: \"crm-entity-stream-section-content\"}}\n\t\t);\n\t\twrapper.appendChild(contentWrapper);\n\n\t\t//region Details\n\t\tif(description !== \"\")\n\t\t{\n\t\t\tdescription = BX.util.trim(description);\n\t\t\tdescription = BX.util.strip_tags(description);\n\t\t\tdescription = this.cutOffText(description, 512);\n\t\t\tdescription = BX.util.nl2br(description);\n\t\t}\n\n\t\tconst contentInnerWrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-event\"}\n\t\t\t}\n\t\t);\n\t\tcontentWrapper.appendChild(contentInnerWrapper);\n\n\t\tthis._deadlineNode = BX.create(\"SPAN\",\n\t\t\t{ attrs: { className: \"crm-entity-stream-content-event-time\" }, text: timeText }\n\t\t);\n\n\t\tconst headerWrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-header\"},\n\t\t\t\tchildren:\n\t\t\t\t\t[\n\t\t\t\t\t\tBX.create(\"SPAN\",\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-event-title\"},\n\t\t\t\t\t\t\t\ttext: this.getMessage(\"wait\")\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t),\n\t\t\t\t\t\tthis._deadlineNode\n\t\t\t\t\t]\n\t\t\t}\n\t\t);\n\t\tcontentInnerWrapper.appendChild(headerWrapper);\n\n\t\tconst detailWrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail\"}\n\t\t\t}\n\t\t);\n\t\tcontentInnerWrapper.appendChild(detailWrapper);\n\n\t\tdetailWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-description\" },\n\t\t\t\t\thtml: description\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst members = BX.create(\"DIV\",\n\t\t\t{attrs: {className: \"crm-entity-stream-content-detail-contact-info\"}}\n\t\t);\n\n\t\tdetailWrapper.appendChild(members);\n\t\t//endregion\n\n\t\t//region Set as Done Button\n\t\tconst setAsDoneButton = BX.create(\"INPUT\",\n\t\t\t{\n\t\t\t\tattrs:\n\t\t\t\t\t{\n\t\t\t\t\t\ttype: \"checkbox\",\n\t\t\t\t\t\tclassName: \"crm-entity-stream-planned-apply-btn\",\n\t\t\t\t\t\tchecked: isDone\n\t\t\t\t\t},\n\t\t\t\tevents: {change: this._setAsDoneButtonHandler}\n\t\t\t}\n\t\t);\n\n\t\tif(!this.canComplete())\n\t\t{\n\t\t\tsetAsDoneButton.disabled = true;\n\t\t}\n\n\t\tconst buttonContainer = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail-planned-action\"},\n\t\t\t\tchildren: [setAsDoneButton]\n\t\t\t}\n\t\t);\n\t\tcontentInnerWrapper.appendChild(buttonContainer);\n\t\t//endregion\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontentInnerWrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\t//region  Actions\n\t\tthis._actionContainer = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-action\" }\n\t\t\t}\n\t\t);\n\t\tcontentInnerWrapper.appendChild(this._actionContainer);\n\t\t//endregion\n\n\t\treturn wrapper;\n\t}\n\n\tprepareContextMenuItems()\n\t{\n\t\tconst menuItems = [];\n\t\tconst handler = BX.delegate(this.onContextMenuItemSelect, this);\n\n\t\tif(!this._postponeController)\n\t\t{\n\t\t\tthis._postponeController = SchedulePostponeController.create(\"\", { item: this });\n\t\t}\n\n\t\tconst postponeMenu =\n\t\t\t{\n\t\t\t\tid: \"postpone\",\n\t\t\t\ttext: this._postponeController.getTitle(),\n\t\t\t\titems: []\n\t\t\t};\n\n\t\tconst commands = this._postponeController.getCommandList();\n\t\tlet i = 0;\n\t\tconst length = commands.length;\n\t\tfor(; i < length; i++)\n\t\t{\n\t\t\tconst command = commands[i];\n\t\t\tpostponeMenu.items.push(\n\t\t\t\t{\n\t\t\t\t\tid: command[\"name\"],\n\t\t\t\t\ttext: command[\"title\"],\n\t\t\t\t\tonclick: handler\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\tmenuItems.push(postponeMenu);\n\t\treturn menuItems;\n\t}\n\n\tonContextMenuItemSelect(e, item)\n\t{\n\t\tthis.closeContextMenu();\n\t\tif(this._postponeController)\n\t\t{\n\t\t\tthis._postponeController.processCommand(item.id);\n\t\t}\n\t}\n\n\tgetTypeDescription()\n\t{\n\t\treturn this.getMessage(\"wait\");\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Wait();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import Activity from \"./activity\";\n\n/** @memberof BX.Crm.Timeline.Items.Scheduled */\nexport default class Request extends Activity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetWrapperClassName()\n\t{\n\t\treturn \"\";\n\t}\n\n\tgetIconClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-icon crm-entity-stream-section-icon-robot\";\n\t}\n\n\tgetTypeDescription()\n\t{\n\t\treturn this.getMessage(\"activityRequest\");\n\t}\n\n\tisEditable()\n\t{\n\t\treturn false;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Request();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import Activity from \"./activity\";\n\n/** @memberof BX.Crm.Timeline.Items.Scheduled */\nexport default class Rest extends Activity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetWrapperClassName()\n\t{\n\t\treturn \"\";\n\t}\n\n\tgetIconClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-icon crm-entity-stream-section-icon-rest\";\n\t}\n\n\tprepareContent(options)\n\t{\n\t\tconst wrapper = super.prepareContent(options);\n\t\tconst data = this.getAssociatedEntityData();\n\n\t\tif (data['APP_TYPE'] && data['APP_TYPE']['ICON_SRC'])\n\t\t{\n\t\t\tconst iconNode = wrapper.querySelector('.' + this.getIconClassName().replace(/\\s+/g, '.'));\n\t\t\tif (iconNode)\n\t\t\t{\n\t\t\t\ticonNode.style.backgroundImage = \"url('\" +  data['APP_TYPE']['ICON_SRC'] + \"')\";\n\t\t\t\ticonNode.style.backgroundPosition = \"center center\";\n\t\t\t\ticonNode.style.backgroundSize = \"cover\";\n\t\t\t\ticonNode.style.backgroundColor = \"transparent\";\n\t\t\t}\n\t\t}\n\n\t\treturn wrapper;\n\t}\n\n\tgetTypeDescription()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tif (entityData['APP_TYPE'] && entityData['APP_TYPE']['NAME'])\n\t\t{\n\t\t\treturn entityData['APP_TYPE']['NAME'];\n\t\t}\n\n\t\treturn this.getMessage(\"restApplication\");\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Rest();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import Activity from \".//activity\";\n\n/** @memberof BX.Crm.Timeline.Actions */\nexport class OpenLine extends Activity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._clickHandler = BX.delegate(this.onClick, this);\n\t\tthis._button = null;\n\t}\n\n\tgetButton()\n\t{\n\t\treturn this._button;\n\t}\n\n\tonClick()\n\t{\n\t\tif(typeof(window.top['BXIM']) === 'undefined')\n\t\t{\n\t\t\twindow.alert(this.getMessage(\"openLineNotSupported\"));\n\t\t\treturn;\n\t\t}\n\n\t\tlet slug = \"\";\n\t\tconst communication = BX.prop.getObject(this._entityData, \"COMMUNICATION\", null);\n\t\tif(communication)\n\t\t{\n\t\t\tif(BX.prop.getString(communication, \"TYPE\") === \"IM\")\n\t\t\t{\n\t\t\t\tslug = BX.prop.getString(communication, \"VALUE\");\n\t\t\t}\n\t\t}\n\n\t\tif(slug !== \"\")\n\t\t{\n\t\t\twindow.top['BXIM'].openMessengerSlider(slug, {RECENT: 'N', MENU: 'N'});\n\t\t}\n\t}\n\n\tdoLayout()\n\t{\n\t\tthis._button = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: { className: \"crm-entity-stream-content-action-reply-btn\" },\n\t\t\t\tevents: { \"click\": this._clickHandler }\n\t\t\t}\n\t\t);\n\t\tthis._container.appendChild(this._button);\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = OpenLine.messages;\n\t\treturn m.hasOwnProperty(name) ? m[name] : name;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new OpenLine();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n\n\tstatic messages = {};\n}\n","import Activity from \"./activity\";\nimport {OpenLine as OpenLineAction} from \"../../actions/openline\";\n\n/** @memberof BX.Crm.Timeline.Items.Scheduled */\nexport default class OpenLine extends Activity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetWrapperClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-IM\";\n\t}\n\n\tgetIconClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-icon crm-entity-stream-section-icon-IM\";\n\t}\n\n\tprepareActions()\n\t{\n\t\tif(this.isReadOnly())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis._actions.push(\n\t\t\tOpenLineAction.create(\n\t\t\t\t\"openline\",\n\t\t\t\t{\n\t\t\t\t\titem: this,\n\t\t\t\t\tcontainer: this._actionContainer,\n\t\t\t\t\tentityData: this.getAssociatedEntityData(),\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\townerInfo: this._schedule.getOwnerInfo()\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t}\n\n\tgetTypeDescription()\n\t{\n\t\treturn this.getMessage(\"openLine\");\n\t}\n\n\tgetPrepositionText(direction)\n\t{\n\t\treturn this.getMessage(\"reciprocal\");\n\t}\n\n\tprepareCommunicationNode(communicationValue)\n\t{\n\t\treturn null;\n\t}\n\n\tprepareDetailNodes()\n\t{\n\t\tconst wrapper = BX.create(\"DIV\",\n\t\t\t{attrs: {className: \"crm-entity-stream-content-detail-IM\"}}\n\t\t);\n\n\t\tconst messageWrapper = BX.create(\"DIV\",\n\t\t\t{attrs: {className: \"crm-entity-stream-content-detail-IM-messages\"}}\n\t\t);\n\t\twrapper.appendChild(messageWrapper);\n\n\t\tconst openLineData = BX.prop.getObject(this.getAssociatedEntityData(), \"OPENLINE_INFO\", null);\n\t\tif(openLineData)\n\t\t{\n\t\t\tconst messages = BX.prop.getArray(openLineData, \"MESSAGES\", []);\n\t\t\tlet i = 0;\n\t\t\tconst length = messages.length;\n\t\t\tfor(; i < length; i++)\n\t\t\t{\n\t\t\t\tconst message = messages[i];\n\t\t\t\tconst isExternal = BX.prop.getBoolean(message, \"IS_EXTERNAL\", true);\n\n\t\t\t\tmessageWrapper.appendChild(\n\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tattrs:\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tclassName: isExternal\n\t\t\t\t\t\t\t\t\t\t? \"crm-entity-stream-content-detail-IM-message-incoming\"\n\t\t\t\t\t\t\t\t\t\t: \"crm-entity-stream-content-detail-IM-message-outgoing\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\thtml: BX.prop.getString(message, \"MESSAGE\", \"\")\n\t\t\t\t\t\t}\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\treturn [ wrapper ];\n\t}\n\n\tview()\n\t{\n\t\tif(typeof(window.top['BXIM']) === 'undefined')\n\t\t{\n\t\t\twindow.alert(this.getMessage(\"openLineNotSupported\"));\n\t\t\treturn;\n\t\t}\n\n\t\tlet slug = \"\";\n\t\tconst communication = BX.prop.getObject(this.getAssociatedEntityData(), \"COMMUNICATION\", null);\n\t\tif(communication)\n\t\t{\n\t\t\tif(BX.prop.getString(communication, \"TYPE\") === \"IM\")\n\t\t\t{\n\t\t\t\tslug = BX.prop.getString(communication, \"VALUE\");\n\t\t\t}\n\t\t}\n\n\t\tif(slug !== \"\")\n\t\t{\n\t\t\twindow.top['BXIM'].openMessengerSlider(slug, {RECENT: 'N', MENU: 'N'});\n\t\t}\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new OpenLine();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import Activity from \"./activity\";\nimport {DatetimeConverter} from \"crm.timeline.tools\";\n\n/** @memberof BX.Crm.Timeline.Items.Scheduled */\nexport default class Zoom extends Activity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetWrapperClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-zoom\";\n\t}\n\n\tgetIconClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-icon crm-entity-stream-section-icon-zoom\";\n\t}\n\n\tgetTypeDescription()\n\t{\n\t\treturn this.getMessage(\"zoom\");\n\t}\n\n\tgetPrepositionText(direction)\n\t{\n\t}\n\n\tprepareCommunicationNode(communicationValue)\n\t{\n\t\treturn null;\n\t}\n\n\tprepareContent(options)\n\t{\n\t\tconst deadline = this.getDeadline();\n\t\tconst timeText = deadline ? this.formatDateTime(deadline) : this.getMessage(\"termless\");\n\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst direction = BX.prop.getInteger(entityData, \"DIRECTION\", 0);\n\t\tconst isDone = this.isDone();\n\t\tconst subject = BX.prop.getString(entityData, \"SUBJECT\", \"\");\n\t\tlet description = BX.prop.getString(entityData, \"DESCRIPTION_RAW\", \"\");\n\n\t\tconst communication = BX.prop.getObject(entityData, \"COMMUNICATION\", {});\n\t\tconst title = BX.prop.getString(communication, \"TITLE\", \"\");\n\t\tconst showUrl = BX.prop.getString(communication, \"SHOW_URL\", \"\");\n\t\tconst communicationValue = BX.prop.getString(communication, \"TYPE\", \"\") !== \"\"\n\t\t\t? BX.prop.getString(communication, \"VALUE\", \"\") : \"\";\n\n\t\tlet wrapperClassName = this.getWrapperClassName();\n\t\tif(wrapperClassName !== \"\")\n\t\t{\n\t\t\twrapperClassName = \"crm-entity-stream-section crm-entity-stream-section-planned\" + \" \" + wrapperClassName;\n\t\t}\n\t\telse\n\t\t{\n\t\t\twrapperClassName = \"crm-entity-stream-section crm-entity-stream-section-planned\";\n\t\t}\n\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: wrapperClassName}});\n\n\t\tlet iconClassName = this.getIconClassName();\n\t\tif(this.isCounterEnabled())\n\t\t{\n\t\t\ticonClassName += \" crm-entity-stream-section-counter\";\n\t\t}\n\t\twrapper.appendChild(BX.create(\"DIV\", { attrs: { className: iconClassName } }));\n\n\t\t//region Context Menu\n\t\tif(this.isContextMenuEnabled())\n\t\t{\n\t\t\twrapper.appendChild(this.prepareContextMenuButton());\n\t\t}\n\t\t//endregion\n\n\t\tconst contentWrapper = BX.create(\"DIV\",\n\t\t\t{attrs: {className: \"crm-entity-stream-section-content\"}}\n\t\t);\n\t\twrapper.appendChild(contentWrapper);\n\n\t\t//region Details\n\t\tif(description !== \"\")\n\t\t{\n\t\t\t//trim leading spaces\n\t\t\tdescription = description.replace(/^\\s+/,'');\n\t\t}\n\n\t\tconst contentInnerWrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-event\"}\n\t\t\t}\n\t\t);\n\t\tcontentWrapper.appendChild(contentInnerWrapper);\n\n\t\tthis._deadlineNode = BX.create(\"SPAN\",\n\t\t\t{ attrs: { className: \"crm-entity-stream-content-event-time\" }, text: timeText }\n\t\t);\n\n\t\tconst headerWrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-header\"},\n\t\t\t\tchildren:\n\t\t\t\t\t[\n\t\t\t\t\t\tBX.create(\"SPAN\",\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tattrs:\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tclassName: \"crm-entity-stream-content-event-title\"\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\ttext: this.getTypeDescription(direction)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t),\n\t\t\t\t\t\tthis._deadlineNode\n\t\t\t\t\t]\n\t\t\t}\n\t\t);\n\t\tcontentInnerWrapper.appendChild(headerWrapper);\n\n\t\tconst detailWrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail\"}\n\t\t\t}\n\t\t);\n\t\tcontentInnerWrapper.appendChild(detailWrapper);\n\n\t\tif (entityData['ZOOM_INFO'])\n\t\t{\n\t\t\tconst topic = entityData['ZOOM_INFO']['TOPIC'];\n\t\t\tconst duration = entityData['ZOOM_INFO']['DURATION'];\n\t\t\tconst startTime = BX.parseDate(\n\t\t\t\tentityData['ZOOM_INFO']['CONF_START_TIME'],\n\t\t\t\tfalse,\n\t\t\t\t\"YYYY-MM-DD\",\n\t\t\t\t\"YYYY-MM-DD HH:MI:SS\"\n\t\t\t);\n\t\t\tconst date = (new DatetimeConverter(startTime)).toUserTime().toDatetimeString({delimiter: ', '});\n\t\t\tconst detailZoomMessage = BX.create(\"span\",\n\t\t\t\t{\n\t\t\t\t\ttext: this.getMessage(\"zoomCreatedMessage\")\n\t\t\t\t\t\t.replace(\"#CONFERENCE_TITLE#\", topic)\n\t\t\t\t\t\t.replace(\"#DATE_TIME#\", date)\n\t\t\t\t\t\t.replace(\"#DURATION#\", duration)\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tconst detailZoomInfoLink = BX.create(\"A\",\n\t\t\t\t{\n\t\t\t\t\tattrs:\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\thref: entityData['ZOOM_INFO']['CONF_URL'],\n\t\t\t\t\t\t\ttarget: \"_blank\",\n\t\t\t\t\t\t},\n\t\t\t\t\ttext: entityData['ZOOM_INFO']['CONF_URL']\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tconst detailZoomInfo = BX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail-zoom-info\"},\n\t\t\t\t\tchildren: [detailZoomMessage, detailZoomInfoLink]\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tdetailWrapper.appendChild(detailZoomInfo);\n\n\t\t\tconst detailZoomCopyInviteLink = BX.create(\"A\",\n\t\t\t\t{\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\tclassName: 'ui-link ui-link-dashed',\n\t\t\t\t\t\t\"data-url\": entityData['ZOOM_INFO']['CONF_URL']\n\t\t\t\t\t},\n\t\t\t\t\ttext: this.getMessage(\"zoomCreatedCopyInviteLink\"),\n\t\t\t\t}\n\t\t\t);\n\t\t\tBX.clipboard.bindCopyClick(detailZoomCopyInviteLink, {\n\t\t\t\ttext: entityData['ZOOM_INFO']['CONF_URL'],\n\t\t\t});\n\n\t\t\tconst detailZoomStartConferenceButton = BX.create(\"BUTTON\",\n\t\t\t\t{\n\t\t\t\t\tattrs: {className: 'ui-btn ui-btn-sm ui-btn-primary'},\n\t\t\t\t\ttext: this.getMessage(\"zoomCreatedStartConference\"),\n\t\t\t\t\tevents: {\n\t\t\t\t\t\t\"click\": function () {\n\t\t\t\t\t\t\twindow.open(entityData['ZOOM_INFO']['CONF_URL']);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tconst detailZoomCopyInviteLinkWrapper = BX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail-zoom-link-wrapper\"},\n\t\t\t\t\tchildren: [detailZoomCopyInviteLink]\n\t\t\t\t}\n\t\t\t);\n\t\t\tdetailWrapper.appendChild(detailZoomCopyInviteLinkWrapper);\n\t\t\tdetailWrapper.appendChild(detailZoomStartConferenceButton);\n\t\t}\n\n\t\tconst additionalDetails = this.prepareDetailNodes();\n\t\tif(BX.type.isArray(additionalDetails))\n\t\t{\n\t\t\tlet i = 0;\n\t\t\tconst length = additionalDetails.length;\n\t\t\tfor(; i < length; i++)\n\t\t\t{\n\t\t\t\tdetailWrapper.appendChild(additionalDetails[i]);\n\t\t\t}\n\t\t}\n\n\t\t//endregion\n\t\t//region Set as Done Button\n\t\tconst setAsDoneButton = BX.create(\"INPUT\",\n\t\t\t{\n\t\t\t\tattrs:\n\t\t\t\t\t{\n\t\t\t\t\t\ttype: \"checkbox\",\n\t\t\t\t\t\tclassName: \"crm-entity-stream-planned-apply-btn\",\n\t\t\t\t\t\tchecked: isDone\n\t\t\t\t\t},\n\t\t\t\tevents: {change: this._setAsDoneButtonHandler}\n\t\t\t}\n\t\t);\n\n\t\tif(!this.canComplete())\n\t\t{\n\t\t\tsetAsDoneButton.disabled = true;\n\t\t}\n\n\t\tconst buttonContainer = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail-planned-action\"},\n\t\t\t\tchildren: [setAsDoneButton]\n\t\t\t}\n\t\t);\n\t\tcontentInnerWrapper.appendChild(buttonContainer);\n\t\t//endregion\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontentInnerWrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\t//region  Actions\n\t\tthis._actionContainer = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-action\" }\n\t\t\t}\n\t\t);\n\t\tcontentInnerWrapper.appendChild(this._actionContainer);\n\t\t//endregion\n\n\t\treturn wrapper;\n\t}\n\n\tprepareDetailNodes()\n\t{\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Zoom();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import Stream from \"../stream\";\nimport Activity from \"../items/scheduled/activity\";\nimport Email from \"../items/scheduled/email\";\nimport Call from \"../items/scheduled/call\";\nimport CallTracker from \"../items/scheduled/call-tracker\";\nimport Meeting from \"../items/scheduled/meeting\";\nimport Task from \"../items/scheduled/task\";\nimport WebForm from \"../items/scheduled/webform\";\nimport Wait from \"../items/scheduled/wait\";\nimport Request from \"../items/scheduled/request\";\nimport Rest from \"../items/scheduled/rest\";\nimport OpenLine from \"../items/scheduled/openline\";\nimport Zoom from \"../items/scheduled/zoom\";\nimport ItemNew from \"../animations/item-new\";\nimport {ConfigurableItem} from \"crm.timeline.item\";\nimport {StreamType} from 'crm.timeline.item';\nimport {DatetimeConverter} from \"crm.timeline.tools\";\n\n/** @memberof BX.Crm.Timeline.Streams */\nexport default class Schedule extends Stream\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._items = [];\n\t\tthis._history = null;\n\t\tthis._wrapper = null;\n\t\tthis._anchor = null;\n\t\tthis._stub = null;\n\t}\n\n\tdoInitialize()\n\t{\n\t\tif(!this.isStubMode())\n\t\t{\n\t\t\tlet itemData = this.getSetting(\"itemData\");\n\t\t\tif(!BX.type.isArray(itemData))\n\t\t\t{\n\t\t\t\titemData = [];\n\t\t\t}\n\n\t\t\tlet i, length, item;\n\t\t\tfor(i = 0, length = itemData.length; i < length; i++)\n\t\t\t{\n\t\t\t\titem = this.createItem(itemData[i]);\n\t\t\t\tif(item)\n\t\t\t\t{\n\t\t\t\t\tthis._items.push(item);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tlayout()\n\t{\n\t\tthis._wrapper = BX.create(\"DIV\", {});\n\t\tthis._container.appendChild(this._wrapper);\n\n\t\tconst label = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-planned-label\"},\n\t\t\t\ttext: this.getMessage(\"planned\")\n\t\t\t}\n\t\t);\n\n\t\tconst wrapperClassName = \"crm-entity-stream-section crm-entity-stream-section-planned-label\";\n\t\tthis._wrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: wrapperClassName },\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\t\t\t\t\tchildren: [ label ]\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tif(this.isStubMode())\n\t\t{\n\t\t\tthis.addStub();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst length = this._items.length;\n\t\t\tif(length === 0)\n\t\t\t{\n\t\t\t\tthis.addStub();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tfor(let i = 0; i < length; i++)\n\t\t\t\t{\n\t\t\t\t\tconst item = this._items[i];\n\t\t\t\t\titem.setContainer(this._wrapper);\n\t\t\t\t\titem.layout();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.refreshLayout();\n\t\tthis._manager.processSheduleLayoutChange();\n\t}\n\n\trefreshLayout()\n\t{\n\t\tBX.onCustomEvent('Schedule:onBeforeRefreshLayout', [this]);\n\t\tconst length = this._items.length;\n\t\tif(length === 0)\n\t\t{\n\t\t\tthis.addStub();\n\t\t\tif(this._history && this._history.hasContent())\n\t\t\t{\n\t\t\t\tBX.removeClass(this._stub, \"crm-entity-stream-section-last\");\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tBX.addClass(this._stub, \"crm-entity-stream-section-last\");\n\t\t\t}\n\n\t\t\tconst stubIcon = this._stub.querySelector(\".crm-entity-stream-section-icon\");\n\t\t\tif(stubIcon)\n\t\t\t{\n\t\t\t\tif(this._manager.isStubCounterEnabled())\n\t\t\t\t{\n\t\t\t\t\tBX.addClass(stubIcon, \"crm-entity-stream-section-counter\");\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tBX.removeClass(stubIcon, \"crm-entity-stream-section-counter\");\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\n\t\tlet i, item;\n\t\tif(this._history && this._history.hasContent())\n\t\t{\n\t\t\tfor(i = 0;  i < length; i++)\n\t\t\t{\n\t\t\t\titem = this._items[i];\n\t\t\t\tif(item.isTerminated())\n\t\t\t\t{\n\t\t\t\t\titem.markAsTerminated(false);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif(length > 1)\n\t\t\t{\n\t\t\t\tfor(i = 0;  i < (length - 1); i++)\n\t\t\t\t{\n\t\t\t\t\titem = this._items[i];\n\t\t\t\t\tif(item.isTerminated())\n\t\t\t\t\t{\n\t\t\t\t\t\titem.markAsTerminated(false);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis._items[length - 1].markAsTerminated(true);\n\t\t}\n\t}\n\n\tformatDateTime(time)\n\t{\n\t\treturn (new DatetimeConverter(time)).toDatetimeString({delimiter: ', '});\n\t}\n\n\tcheckItemForTermination(item)\n\t{\n\t\tif(this._history && this._history.getItemCount() > 0)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\t\treturn this.getLastItem() === item;\n\t}\n\n\tgetItems(): Array\n\t{\n\t\treturn this._items;\n\t}\n\n\tsetItems(items: Array): void\n\t{\n\t\tthis._items = items;\n\t}\n\n\tcalculateItemIndex(item)\n\t{\n\t\tconst sort = item.getSort();\n\n\t\tfor(let i =0; i < this._items.length; i++)\n\t\t{\n\t\t\tconst curSort = this._items[i].getSort();\n\t\t\tfor (let j = 0; j < curSort.length; j++)\n\t\t\t{\n\t\t\t\tif (sort.length <= j || sort[j] !== curSort[j])\n\t\t\t\t{\n\t\t\t\t\tif (sort[j] < curSort[j])\n\t\t\t\t\t{\n\t\t\t\t\t\treturn i;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn this._items.length;\n\t}\n\n\tgetItemCount()\n\t{\n\t\treturn this._items.length;\n\t}\n\n\tgetItemByAssociatedEntity($entityTypeId, entityId)\n\t{\n\t\tif(!BX.type.isNumber($entityTypeId))\n\t\t{\n\t\t\t$entityTypeId = parseInt($entityTypeId);\n\t\t}\n\n\t\tif(!BX.type.isNumber(entityId))\n\t\t{\n\t\t\tentityId = parseInt(entityId);\n\t\t}\n\n\t\tif(isNaN($entityTypeId) || $entityTypeId <= 0 || isNaN(entityId) || entityId <= 0)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tfor(let i = 0, length = this._items.length; i < length; i++)\n\t\t{\n\t\t\tconst item = this._items[i];\n\t\t\tif(item.getAssociatedEntityTypeId() === $entityTypeId && item.getAssociatedEntityId() === entityId)\n\t\t\t{\n\t\t\t\treturn item;\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tgetItemByData(itemData)\n\t{\n\t\tif(!BX.type.isPlainObject(itemData))\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn this.getItemByAssociatedEntity(\n\t\t\tBX.prop.getInteger(itemData, \"ASSOCIATED_ENTITY_TYPE_ID\", 0),\n\t\t\tBX.prop.getInteger(itemData, \"ASSOCIATED_ENTITY_ID\", 0)\n\t\t);\n\t}\n\n\n\tgetItemByIndex(index)\n\t{\n\t\treturn index < this._items.length ? this._items[index] : null;\n\t}\n\n\tcreateItem(data)\n\t{\n\t\tconst entityTypeID = BX.prop.getInteger(data, \"ASSOCIATED_ENTITY_TYPE_ID\", 0);\n\t\tconst entityID = BX.prop.getInteger(data, \"ASSOCIATED_ENTITY_ID\", 0);\n\t\tconst entityData = BX.prop.getObject(data, \"ASSOCIATED_ENTITY\", {});\n\t\tlet itemId = BX.CrmEntityType.resolveName(entityTypeID) + \"_\" + entityID.toString();\n\n\t\tif (data.hasOwnProperty('type'))\n\t\t{\n\t\t\titemId = data.id;\n\n\t\t\treturn ConfigurableItem.create(itemId, {\n\t\t\t\ttimelineId: this.getId(),\n\t\t\t\tcontainer: this.getWrapper(),\n\t\t\t\titemClassName: this.getItemClassName(),\n\t\t\t\tisReadOnly: this.isReadOnly(),\n\t\t\t\tcurrentUser: this._manager.getCurrentUser(),\n\t\t\t\townerTypeId: this._manager.getOwnerTypeId(),\n\t\t\t\townerId: this._manager.getOwnerId(),\n\t\t\t\tstreamType: this.getStreamType(),\n\t\t\t\tdata: data,\n\t\t\t})\n\t\t}\n\n\t\tif(entityTypeID === BX.CrmEntityType.enumeration.wait)\n\t\t{\n\t\t\treturn Wait.create(\n\t\t\t\titemId,\n\t\t\t\t{\n\t\t\t\t\tschedule: this,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse// if(entityTypeID === BX.CrmEntityType.enumeration.activity)\n\t\t{\n\t\t\tconst typeId = BX.prop.getInteger(entityData, \"TYPE_ID\", 0);\n\t\t\tconst providerId = BX.prop.getString(entityData, \"PROVIDER_ID\", \"\");\n\n\t\t\tif(typeId === BX.CrmActivityType.email)\n\t\t\t{\n\t\t\t\treturn Email.create(\n\t\t\t\t\titemId,\n\t\t\t\t\t{\n\t\t\t\t\t\tschedule: this,\n\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\tdata: data\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t\telse if(typeId === BX.CrmActivityType.call)\n\t\t\t{\n\t\t\t\treturn Call.create(\n\t\t\t\t\titemId,\n\t\t\t\t\t{\n\t\t\t\t\t\tschedule: this,\n\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\tdata: data\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t\telse if(typeId === BX.CrmActivityType.meeting)\n\t\t\t{\n\t\t\t\treturn Meeting.create(\n\t\t\t\t\titemId,\n\t\t\t\t\t{\n\t\t\t\t\t\tschedule: this,\n\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\tdata: data\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t\telse if(typeId === BX.CrmActivityType.task)\n\t\t\t{\n\t\t\t\treturn Task.create(\n\t\t\t\t\titemId,\n\t\t\t\t\t{\n\t\t\t\t\t\tschedule: this,\n\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\tdata: data\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t\telse if(typeId === BX.CrmActivityType.provider)\n\t\t\t{\n\t\t\t\tif(providerId === \"CRM_WEBFORM\")\n\t\t\t\t{\n\t\t\t\t\treturn WebForm.create(\n\t\t\t\t\t\titemId,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tschedule: this,\n\t\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\t\tdata: data\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\telse if(providerId === \"CRM_REQUEST\")\n\t\t\t\t{\n\t\t\t\t\treturn Request.create(\n\t\t\t\t\t\titemId,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tschedule: this,\n\t\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\t\tdata: data\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\telse if(providerId === \"IMOPENLINES_SESSION\")\n\t\t\t\t{\n\t\t\t\t\treturn OpenLine.create(\n\t\t\t\t\t\titemId,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tschedule: this,\n\t\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\t\tdata: data\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\telse if(providerId === \"ZOOM\")\n\t\t\t\t{\n\t\t\t\t\treturn Zoom.create(\n\t\t\t\t\t\titemId,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tschedule: this,\n\t\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\t\tdata: data\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\telse if(providerId === \"REST_APP\")\n\t\t\t\t{\n\t\t\t\t\treturn Rest.create(\n\t\t\t\t\t\titemId,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tschedule: this,\n\t\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\t\tdata: data\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\telse if(providerId === 'CRM_CALL_TRACKER')\n\t\t\t\t{\n\t\t\t\t\treturn CallTracker.create(\n\t\t\t\t\t\titemId,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tschedule: this,\n\t\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\t\tdata: data,\n\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tgetWrapper()\n\t{\n\t\treturn this._wrapper;\n\t}\n\n\tgetItemClassName()\n\t{\n\t\treturn 'crm-entity-stream-section crm-entity-stream-section-planned';\n\t}\n\n\tgetStreamType(): number\n\t{\n\t\treturn StreamType.scheduled;\n\t}\n\n\taddItem(item, index)\n\t{\n\t\tif(!BX.type.isNumber(index) || index < 0)\n\t\t{\n\t\t\tindex = this.calculateItemIndex(item);\n\t\t}\n\n\t\tif(index < this._items.length)\n\t\t{\n\t\t\tthis._items.splice(index, 0, item);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis._items.push(item);\n\t\t}\n\n\t\tthis.removeStub();\n\n\t\tthis.refreshLayout();\n\t\tthis._manager.processSheduleLayoutChange();\n\t}\n\n\tgetHistory()\n\t{\n\t\treturn this._history;\n\t}\n\n\tsetHistory(history)\n\t{\n\t\tthis._history = history;\n\t}\n\n\tcreateAnchor(index)\n\t{\n\t\tthis._anchor = BX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section crm-entity-stream-section-shadow\" } });\n\t\tif(index >= 0 && index < this._items.length)\n\t\t{\n\t\t\tthis._wrapper.insertBefore(this._anchor, this._items[index].getWrapper());\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis._wrapper.appendChild(this._anchor);\n\t\t}\n\t\treturn this._anchor;\n\t}\n\n\tdeleteItem(item)\n\t{\n\t\tconst index = this.getItemIndex(item);\n\t\tif(index < 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\titem.clearLayout();\n\t\tthis.removeItemByIndex(index);\n\n\t\tthis.refreshLayout();\n\t\tthis._manager.processSheduleLayoutChange();\n\t}\n\n\ttransferItemToHistory(item, historyItemData)\n\t{\n\t\tconst index = this.getItemIndex(item);\n\t\tif(index < 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.removeItemByIndex(index);\n\n\t\tthis.refreshLayout();\n\t\tthis._manager.processSheduleLayoutChange();\n\n\t\tconst historyItem = this._history.createItem(historyItemData);\n\t\tthis._history.addItem(historyItem, 0);\n\t\thistoryItem.layout({ add: false });\n\n\t\tconst animation = ItemNew.create(\n\t\t\t\"\",\n\t\t\t{\n\t\t\t\tinitialItem: item,\n\t\t\t\tfinalItem: historyItem,\n\t\t\t\tanchor: this._history.createAnchor(),\n\t\t\t\tevents: {complete: BX.delegate(this.onTransferComplete, this)}\n\t\t\t}\n\t\t);\n\t\tanimation.run();\n\t}\n\n\tonTransferComplete()\n\t{\n\t\tthis._history.refreshLayout();\n\n\t\tif(this._items.length === 0)\n\t\t{\n\t\t\tthis.addStub();\n\t\t}\n\t}\n\n\tonItemMarkedAsDone(item, params)\n\t{\n\t}\n\n\taddStub()\n\t{\n\t\tif(!this._stub)\n\t\t{\n\t\t\tlet stubClassName = \"crm-entity-stream-section crm-entity-stream-section-planned crm-entity-stream-section-notTask\";\n\t\t\tlet stubIconClassName = \"crm-entity-stream-section-icon crm-entity-stream-section-icon-info\";\n\t\t\tconst canAddTodo = this.getManager().getSetting('enableTodo', false);\n\t\t\tif (canAddTodo && !this.isReadOnly())\n\t\t\t{\n\t\t\t\tstubClassName += ' --active';\n\t\t\t}\n\n\t\t\tlet stubMessage = this.getMessage(\"stub\");\n\n\t\t\tconst ownerTypeId = this._manager.getOwnerTypeId();\n\t\t\tif(ownerTypeId === BX.CrmEntityType.enumeration.lead)\n\t\t\t{\n\t\t\t\tstubMessage = this.getMessage(\"leadStub\");\n\t\t\t}\n\t\t\telse if(ownerTypeId === BX.CrmEntityType.enumeration.deal)\n\t\t\t{\n\t\t\t\tstubMessage = this.getMessage(\"dealStub\");\n\t\t\t}\n\n\t\t\tif(this._manager.isStubCounterEnabled())\n\t\t\t{\n\t\t\t\tstubIconClassName += \" crm-entity-stream-section-counter\";\n\t\t\t}\n\n\t\t\tthis._stub = BX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: stubClassName },\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"DIV\", { attrs: { className: stubIconClassName } }),\n\t\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-event\" },\n\t\t\t\t\t\t\t\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-title\" },\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttext: this.getMessage(\"stubTitle\"),\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail\" },\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttext: stubMessage\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t);\n\t\t\tif (canAddTodo && !this.isReadOnly())\n\t\t\t{\n\t\t\t\tBX.bind(this._stub, \"click\", BX.delegate(this.focusOnTodoEditor, this));\n\t\t\t}\n\t\t\tthis._wrapper.appendChild(this._stub);\n\t\t}\n\n\t\tif(this._history && this._history.getItemCount() > 0)\n\t\t{\n\t\t\tBX.removeClass(this._stub, \"crm-entity-stream-section-last\");\n\t\t}\n\t\telse\n\t\t{\n\t\t\tBX.addClass(this._stub, \"crm-entity-stream-section-last\");\n\t\t}\n\t}\n\n\tremoveStub()\n\t{\n\t\tif(this._stub)\n\t\t{\n\t\t\tthis._stub = BX.remove(this._stub);\n\t\t}\n\n\t}\n\n\tfocusOnTodoEditor()\n\t{\n\t\tconst menuBar = this.getManager().getMenuBar();\n\t\tmenuBar.setActiveItemById('todo');\n\n\t\tconst todoEditor = menuBar.getTodoEditor();\n\t\ttodoEditor.setFocused();\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = Schedule.messages;\n\t\treturn m.hasOwnProperty(name) ? m[name] : name;\n\t}\n\n\tanimateItemAdding(item): Promise\n\t{\n\t\titem.addWrapperClass('crm-entity-stream-section-updated', 1000);\n\t\treturn Promise.resolve();\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Schedule();\n\t\tself.initialize(id, settings);\n\t\tSchedule.items[self.getId()] = self;\n\t\treturn self;\n\t}\n\n\tstatic items = {};\n\tstatic messages = {};\n}\n","import History from \"./history\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Modification extends History\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = Modification.messages;\n\t\treturn m.hasOwnProperty(name) ? m[name] : name;\n\t}\n\n\tgetTitle()\n\t{\n\t\treturn this.getTextDataParam(\"TITLE\");\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-section crm-entity-stream-section-info\"}});\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-info\" } })\n\t\t);\n\n\t\tconst content = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\tconst header = this.prepareHeaderLayout();\n\n\t\tconst contentChildren = [];\n\t\tif (BX.type.isNotEmptyString(this.getTextDataParam(\"START_NAME\")))\n\t\t{\n\t\t\tcontentChildren.push(\n\t\t\t\tBX.create(\"SPAN\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-detain-info-status\"},\n\t\t\t\t\t\ttext: this.getTextDataParam(\"START_NAME\")\n\t\t\t\t\t})\n\t\t\t);\n\t\t\tcontentChildren.push(\n\t\t\t\tBX.create(\"SPAN\",{ attrs: { className: \"crm-entity-stream-content-detail-info-separator-icon\" } })\n\t\t\t);\n\t\t}\n\n\t\tif (BX.type.isNotEmptyString(this.getTextDataParam(\"FINISH_NAME\")))\n\t\t{\n\t\t\tcontentChildren.push(\n\t\t\t\tBX.create(\"SPAN\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detain-info-status\" },\n\t\t\t\t\t\ttext: this.getTextDataParam(\"FINISH_NAME\")\n\t\t\t\t\t})\n\t\t\t);\n\t\t}\n\n\n\t\tcontent.appendChild(header);\n\t\tcontent.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail\" },\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-info\" },\n\t\t\t\t\t\t\t\t\tchildren: contentChildren\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t]\n\t\t\t\t})\n\t\t);\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontent.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-content\" }, children: [ content ] })\n\t\t);\n\n\t\treturn wrapper;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Modification();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n\n\tstatic messages = {};\n}\n","import History from \"./history\";\n\n/** @memberof BX.Crm.Timeline.Actions */\nexport default class Conversion extends History\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = Conversion.messages;\n\t\treturn m.hasOwnProperty(name) ? m[name] : name;\n\t}\n\n\tgetTitle()\n\t{\n\t\treturn this.getTextDataParam(\"TITLE\");\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-section crm-entity-stream-section-convert crm-entity-stream-section-history\"}});\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-convert\" } })\n\t\t);\n\n\t\tconst content = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\tconst header = this.prepareHeaderLayout();\n\n\t\tcontent.appendChild(header);\n\n\t\tconst entityNodes = [];\n\t\tconst entityInfos = this.getArrayDataParam(\"ENTITIES\");\n\t\tlet i = 0;\n\t\tconst length = entityInfos.length;\n\t\tfor(; i < length; i++)\n\t\t{\n\t\t\tconst entityInfo = entityInfos[i];\n\n\t\t\tlet entityNode;\n\t\t\tif(BX.prop.getString(entityInfo, 'SHOW_URL', \"\") === \"\")\n\t\t\t{\n\t\t\t\tentityNode = BX.create(\"DIV\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-convert\" },\n\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detain-convert-status\" },\n\t\t\t\t\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t\t\t\t\tBX.create(\"SPAN\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-status-text\" },\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttext: BX.CrmEntityType.getNotFoundMessage(entityInfo['ENTITY_TYPE_ID'])\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tentityNode = BX.create(\"DIV\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-convert\" },\n\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detain-convert-status\" },\n\t\t\t\t\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t\t\t\t\tBX.create(\"SPAN\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-status-text\" },\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttext: entityInfo['ENTITY_TYPE_CAPTION']\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\tBX.create(\"SPAN\", { attrs: { className: \"crm-entity-stream-content-detail-convert-separator-icon\" } }),\n\t\t\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detain-convert-status\" },\n\t\t\t\t\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tattrs:\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName: \"crm-entity-stream-content-detail-target\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\thref: entityInfo['SHOW_URL']\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttext: entityInfo['TITLE']\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t\tentityNodes.push(entityNode);\n\t\t}\n\n\t\tcontent.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail\" },\n\t\t\t\t\tchildren: entityNodes\n\t\t\t\t})\n\t\t);\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontent.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-content\" }, children: [ content ] })\n\t\t);\n\n\t\treturn wrapper;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Conversion();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n\n\tstatic messages = {};\n}\n","import HistoryActivity from \"./history-activity\";\nimport {HistoryEmail} from \"../actions/email\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Email extends HistoryActivity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tprepareHeaderLayout()\n\t{\n\t\tconst header = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-header\"}});\n\t\theader.appendChild(this.prepareTitleLayout());\n\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst emailInfo = BX.prop.getObject(entityData, \"EMAIL_INFO\", null);\n\t\tconst statusText = emailInfo !== null ? BX.prop.getString(emailInfo, \"STATUS_TEXT\", \"\") : \"\";\n\t\tconst error = emailInfo !== null ? BX.prop.getBoolean(emailInfo, \"STATUS_ERROR\", false) : false;\n\t\tconst className = !error ? \"crm-entity-stream-content-event-skipped\" : \"crm-entity-stream-content-event-missing\";\n\t\tif(statusText !== \"\")\n\t\t{\n\t\t\theader.appendChild(\n\t\t\t\tBX.create(\n\t\t\t\t\t\"SPAN\",\n\t\t\t\t\t{\n\t\t\t\t\t\tprops: { className: className},\n\t\t\t\t\t\ttext: statusText\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\n\t\tconst markNode = this.prepareMarkLayout();\n\t\tif(markNode)\n\t\t{\n\t\t\theader.appendChild(markNode);\n\t\t}\n\n\t\theader.appendChild(this.prepareTimeLayout());\n\t\treturn header;\n\t}\n\n\tprepareContextMenuItems()\n\t{\n\t\tconst menuItems = [];\n\n\t\tif (!this.isReadOnly())\n\t\t{\n\t\t\tmenuItems.push({id: \"view\", text: this.getMessage(\"menuView\"), onclick: BX.delegate(this.view, this)});\n\n\t\t\tmenuItems.push({ id: \"remove\", text: this.getMessage(\"menuDelete\"), onclick: BX.delegate(this.processRemoval, this)});\n\n\t\t\tif (this.isFixed() || this._fixedHistory.findItemById(this._id))\n\t\t\t\tmenuItems.push({ id: \"unfasten\", text: this.getMessage(\"menuUnfasten\"), onclick: BX.delegate(this.unfasten, this)});\n\t\t\telse\n\t\t\t\tmenuItems.push({ id: \"fasten\", text: this.getMessage(\"menuFasten\"), onclick: BX.delegate(this.fasten, this)});\n\t\t}\n\n\t\treturn menuItems;\n\t}\n\n\treply()\n\t{\n\t}\n\n\treplyAll()\n\t{\n\t}\n\n\tforward()\n\t{\n\t}\n\n\tgetRemoveMessage()\n\t{\n\t\tconst title = BX.util.htmlspecialchars(this.getTitle());\n\t\treturn this.getMessage('emailRemove').replace(\"#TITLE#\", title);\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\n\t\tlet description = BX.prop.getString(entityData, \"DESCRIPTION_RAW\", \"\");\n\t\tif(description !== \"\")\n\t\t{\n\t\t\t//trim leading spaces\n\t\t\tdescription = description.replace(/^\\s+/,'');\n\t\t}\n\n\t\tconst communication = BX.prop.getObject(entityData, \"COMMUNICATION\", {});\n\t\tconst communicationTitle = BX.prop.getString(communication, \"TITLE\", \"\");\n\t\tconst communicationShowUrl = BX.prop.getString(communication, \"SHOW_URL\", \"\");\n\t\tconst communicationValue = BX.prop.getString(communication, \"VALUE\", \"\");\n\n\t\tconst outerWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-section crm-entity-stream-section-history crm-entity-stream-section-email\"}});\n\t\touterWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-email\" }\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tif (this.isFixed())\n\t\t\tBX.addClass(outerWrapper, 'crm-entity-stream-section-top-fixed');\n\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\touterWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\tchildren: [ wrapper ]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\t//Header\n\t\tconst header = this.prepareHeaderLayout();\n\t\twrapper.appendChild(header);\n\n\t\t//region Context Menu\n\t\tif(this.isContextMenuEnabled())\n\t\t{\n\t\t\twrapper.appendChild(this.prepareContextMenuButton());\n\t\t}\n\t\t//endregion\n\n\t\t//Details\n\t\tconst detailWrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail-email\"}\n\t\t\t}\n\t\t);\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail\" },\n\t\t\t\t\tchildren: [ detailWrapper ]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\t//TODO: Add status text\n\t\t/*\n\t\tdetailWrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-content-detail-email-read-status\" } })\n\t\t);\n\t\t*/\n\n\t\tdetailWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-email-title\" },\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattrs: { href: \"#\" },\n\t\t\t\t\t\t\t\t\tevents: { \"click\": this._headerClickHandler },\n\t\t\t\t\t\t\t\t\ttext: this.getTitle()\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst communicationWrapper = BX.create(\"DIV\",\n\t\t\t{attrs: {className: \"crm-entity-stream-content-detail-email-to\"}}\n\t\t);\n\t\tdetailWrapper.appendChild(communicationWrapper);\n\n\t\t//Communications\n\t\tif(communicationTitle !== \"\")\n\t\t{\n\t\t\tif(communicationShowUrl !== \"\")\n\t\t\t{\n\t\t\t\tcommunicationWrapper.appendChild(\n\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tattrs: { href: communicationShowUrl },\n\t\t\t\t\t\t\ttext: communicationTitle\n\t\t\t\t\t\t}\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tcommunicationWrapper.appendChild(BX.create(\"SPAN\", { text: communicationTitle }));\n\t\t\t}\n\t\t}\n\n\t\tif(communicationValue !== \"\")\n\t\t{\n\t\t\tif(communicationTitle !== \"\")\n\t\t\t{\n\t\t\t\tcommunicationWrapper.appendChild(BX.create(\"SPAN\", { text: \" \" }));\n\t\t\t}\n\t\t\tcommunicationWrapper.appendChild(\n\t\t\t\tBX.create(\n\t\t\t\t\t\"SPAN\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-email-address\" },\n\t\t\t\t\t\ttext: communicationValue\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\n\t\t//Content\n\t\tdetailWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-email-fragment\" },\n\t\t\t\t\tchildren: this.prepareCutOffElements(description, 128, this._headerClickHandler)\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\twrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\t//region  Actions\n\t\tthis._actionContainer = BX.create(\"SPAN\", { attrs: { className: \"crm-entity-stream-content-detail-action\" } });\n\t\twrapper.appendChild(this._actionContainer);\n\t\t//endregion\n\n\t\tif (!this.isReadOnly())\n\t\t\twrapper.appendChild(this.prepareFixedSwitcherLayout());\n\n\t\treturn outerWrapper;\n\t}\n\n\tprepareActions()\n\t{\n\t\tif(this.isReadOnly())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis._actions.push(\n\t\t\tHistoryEmail.create(\n\t\t\t\t\"email\",\n\t\t\t\t{\n\t\t\t\t\titem: this,\n\t\t\t\t\tcontainer: this._actionContainer,\n\t\t\t\t\tentityData: this.getAssociatedEntityData(),\n\t\t\t\t\tactivityEditor: this._activityEditor\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t}\n\n\tshowActions(show)\n\t{\n\t\tif(this._actionContainer)\n\t\t{\n\t\t\tthis._actionContainer.style.display = show ? \"\" : \"none\";\n\t\t}\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Email();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import Activity from \"./activity\";\n\n/** @memberof BX.Crm.Timeline.Actions */\nexport class Call extends Activity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._clickHandler = BX.delegate(this.onClick, this);\n\t\tthis._menu = null;\n\t\tthis._isMenuShown = false;\n\t\tthis._menuItems = null;\n\t}\n\n\tgetButton()\n\t{\n\t\treturn null;\n\t}\n\n\tonClick(e)\n\t{\n\t\tif(typeof(window.top['BXIM']) === 'undefined')\n\t\t{\n\t\t\twindow.alert(this.getMessage(\"telephonyNotSupported\"));\n\t\t\treturn;\n\t\t}\n\n\t\tlet phone = \"\";\n\t\tconst itemData = this.getItemData();\n\t\tconst phones = BX.prop.getArray(itemData, \"PHONE\", []);\n\n\t\tif(phones.length === 1)\n\t\t{\n\t\t\tthis.addCall(phones[0]['VALUE']);\n\t\t}\n\t\telse if(phones.length > 1)\n\t\t{\n\t\t\tthis.showMenu();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst communication = BX.prop.getObject(this._entityData, \"COMMUNICATION\", null);\n\t\t\tif(communication)\n\t\t\t{\n\t\t\t\tif(BX.prop.getString(communication, \"TYPE\") === \"PHONE\")\n\t\t\t\t{\n\t\t\t\t\tphone = BX.prop.getString(communication, \"VALUE\");\n\t\t\t\t\tif(phone)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.addCall(phone);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn BX.PreventDefault(e);\n\t}\n\n\tshowMenu()\n\t{\n\t\tif(this._isMenuShown)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.prepareMenuItems();\n\n\t\tif(!this._menuItems || this._menuItems.length === 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\n\t\tthis._menu = new BX.PopupMenuWindow(\n\t\t\tthis._id,\n\t\t\tthis._container,\n\t\t\tthis._menuItems,\n\t\t\t{\n\t\t\t\toffsetTop: 0,\n\t\t\t\toffsetLeft: 16,\n\t\t\t\tevents:\n\t\t\t\t\t{\n\t\t\t\t\t\tonPopupShow: BX.delegate(this.onMenuShow, this),\n\t\t\t\t\t\tonPopupClose: BX.delegate(this.onMenuClose, this),\n\t\t\t\t\t\tonPopupDestroy: BX.delegate(this.onMenuDestroy, this)\n\t\t\t\t\t}\n\t\t\t}\n\t\t);\n\n\t\tthis._menu.popupWindow.show();\n\t}\n\n\tcloseMenu()\n\t{\n\t\tif(!this._isMenuShown)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif(this._menu)\n\t\t{\n\t\t\tthis._menu.close();\n\t\t}\n\t}\n\n\tprepareMenuItems()\n\t{\n\t\tif(this._menuItems)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst itemData = this.getItemData();\n\t\tconst phones = BX.prop.getArray(itemData, \"PHONE\", []);\n\t\tconst handler = BX.delegate(this.onMenuItemClick, this);\n\t\tthis._menuItems = [];\n\n\t\tif(phones.length === 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet i = 0;\n\t\tconst l = phones.length;\n\t\tfor(; i < l; i++)\n\t\t{\n\t\t\tconst value = BX.prop.getString(phones[i], \"VALUE\");\n\t\t\tconst formattedValue = BX.prop.getString(phones[i], \"VALUE_FORMATTED\");\n\t\t\tconst complexName = BX.prop.getString(phones[i], \"COMPLEX_NAME\");\n\t\t\tconst itemText = (complexName ? complexName + ': ' : '') + (formattedValue ? formattedValue : value);\n\n\t\t\tif(value !== \"\")\n\t\t\t{\n\t\t\t\tthis._menuItems.push({ id: value, text:  itemText, onclick: handler});\n\t\t\t}\n\t\t}\n\t}\n\n\tonMenuItemClick(e, item)\n\t{\n\t\tthis.closeMenu();\n\t\tthis.addCall(item.id);\n\t}\n\n\tonMenuShow()\n\t{\n\t\tthis._isMenuShown = true;\n\t}\n\n\tonMenuClose()\n\t{\n\t\tthis._isMenuShown = false;\n\t\tthis._menu.popupWindow.destroy();\n\t}\n\n\tonMenuDestroy()\n\t{\n\t\tthis._menu = null;\n\t}\n\n\taddCall(phone)\n\t{\n\t\tconst communication = BX.prop.getObject(this._entityData, \"COMMUNICATION\", null);\n\t\tlet entityTypeId = parseInt(BX.prop.getString(communication, \"ENTITY_TYPE_ID\", \"0\"));\n\t\tif(isNaN(entityTypeId))\n\t\t{\n\t\t\tentityTypeId = 0;\n\t\t}\n\n\t\tlet entityId = parseInt(BX.prop.getString(communication, \"ENTITY_ID\", \"0\"));\n\t\tif(isNaN(entityId))\n\t\t{\n\t\t\tentityId = 0;\n\t\t}\n\n\t\tlet ownerTypeId = 0;\n\t\tlet ownerId = 0;\n\n\t\tconst ownerInfo = BX.prop.getObject(this._settings, \"ownerInfo\");\n\t\tif(ownerInfo)\n\t\t{\n\t\t\townerTypeId = BX.prop.getInteger(ownerInfo, \"ENTITY_TYPE_ID\", 0);\n\t\t\townerId = BX.prop.getInteger(ownerInfo, \"ENTITY_ID\", 0);\n\t\t}\n\n\t\tif(ownerTypeId <= 0 || ownerId <= 0)\n\t\t{\n\t\t\townerTypeId = BX.prop.getInteger(this._entityData, \"OWNER_TYPE_ID\", 0);\n\t\t\townerId = BX.prop.getInteger(this._entityData, \"OWNER_ID\", \"0\");\n\t\t}\n\n\t\tif(ownerTypeId <= 0 || ownerId <= 0)\n\t\t{\n\t\t\townerTypeId = entityTypeId;\n\t\t\townerId = entityId;\n\t\t}\n\n\t\tlet activityId = parseInt(BX.prop.getString(this._entityData, \"ID\", \"0\"));\n\t\tif(isNaN(activityId))\n\t\t{\n\t\t\tactivityId = 0;\n\t\t}\n\n\t\tconst params =\n\t\t\t{\n\t\t\t\t\"ENTITY_TYPE_NAME\": BX.CrmEntityType.resolveName(entityTypeId),\n\t\t\t\t\"ENTITY_ID\": entityId,\n\t\t\t\t\"AUTO_FOLD\": true\n\t\t\t};\n\t\tif(ownerTypeId !== entityTypeId || ownerId !== entityId)\n\t\t{\n\t\t\tparams[\"BINDINGS\"] = [ { \"OWNER_TYPE_NAME\": BX.CrmEntityType.resolveName(ownerTypeId), \"OWNER_ID\": ownerId } ];\n\t\t}\n\n\t\tif(activityId > 0)\n\t\t{\n\t\t\tparams[\"SRC_ACTIVITY_ID\"] = activityId;\n\t\t}\n\n\t\twindow.top['BXIM'].phoneTo(phone, params);\n\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = Call.messages;\n\t\treturn m.hasOwnProperty(name) ? m[name] : name;\n\t}\n\n\tstatic messages = {};\n}\n\n/** @memberof BX.Crm.Timeline.Actions */\nexport class HistoryCall extends Call\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._button = null;\n\t}\n\n\tgetButton()\n\t{\n\t\treturn this._button;\n\t}\n\n\tdoLayout()\n\t{\n\t\tthis._button = BX.create(\"A\",\n\t\t\t{\n\t\t\t\tattrs: { className: \"crm-entity-stream-content-action-reply-btn\" },\n\t\t\t\tevents: { \"click\": this._clickHandler }\n\t\t\t}\n\t\t);\n\t\tthis._container.appendChild(this._button);\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new HistoryCall();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n\nexport class ScheduleCall extends Call\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tdoLayout()\n\t{\n\t\tthis._container.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-action-reply-btn\" },\n\t\t\t\t\tevents: { \"click\": this._clickHandler }\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new ScheduleCall();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import {HistoryCall} from \"../actions/call\";\nimport HistoryActivity from \"./history-activity\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Call extends HistoryActivity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._playerDummyClickHandler = BX.delegate(this.onPlayerDummyClick, this);\n\t\tthis._playerWrapper = null;\n\t\tthis._transcriptWrapper = null;\n\t\tthis._mediaFileInfo = null;\n\t}\n\n\tgetTypeDescription()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst callInfo = BX.prop.getObject(entityData, \"CALL_INFO\", null);\n\t\tconst callTypeText = callInfo !== null ? BX.prop.getString(callInfo, \"CALL_TYPE_TEXT\", \"\") : \"\";\n\t\tif(callTypeText !== \"\")\n\t\t{\n\t\t\treturn callTypeText;\n\t\t}\n\n\t\tconst direction = BX.prop.getInteger(entityData, \"DIRECTION\", 0);\n\t\treturn this.getMessage(direction === BX.CrmActivityDirection.incoming ? \"incomingCall\" : \"outgoingCall\");\n\t}\n\n\tprepareHeaderLayout()\n\t{\n\t\tconst header = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-header\"}});\n\t\theader.appendChild(this.prepareTitleLayout());\n\n\t\t//Position is important\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst callInfo = BX.prop.getObject(entityData, \"CALL_INFO\", null);\n\t\tconst hasCallInfo = callInfo !== null;\n\t\tconst isSuccessfull = hasCallInfo ? BX.prop.getBoolean(callInfo, \"SUCCESSFUL\", false) : false;\n\t\tconst statusText = hasCallInfo ? BX.prop.getString(callInfo, \"STATUS_TEXT\", \"\") : \"\";\n\n\t\tif(hasCallInfo && statusText.length)\n\t\t{\n\t\t\theader.appendChild(\n\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs:\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tclassName: isSuccessfull\n\t\t\t\t\t\t\t\t\t? \"crm-entity-stream-content-event-successful\"\n\t\t\t\t\t\t\t\t\t: \"crm-entity-stream-content-event-missing\"\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\ttext: statusText\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\n\t\theader.appendChild(\n\t\t\tBX.create(\"SPAN\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-event-time\" },\n\t\t\t\t\ttext: this.formatTime(this.getCreatedTime())\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\treturn header;\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\n\t\tlet description = BX.prop.getString(entityData, \"DESCRIPTION_RAW\", \"\");\n\t\tif(description !== \"\")\n\t\t{\n\t\t\t//trim leading spaces\n\t\t\tdescription = description.replace(/^\\s+/,'');\n\t\t}\n\n\t\tconst communication = BX.prop.getObject(entityData, \"COMMUNICATION\", {});\n\t\tconst communicationTitle = BX.prop.getString(communication, \"TITLE\", \"\");\n\t\tconst communicationShowUrl = BX.prop.getString(communication, \"SHOW_URL\", \"\");\n\t\tconst communicationValue = BX.prop.getString(communication, \"VALUE\", \"\");\n\t\tconst communicationValueFormatted = BX.prop.getString(communication, \"FORMATTED_VALUE\", communicationValue);\n\n\t\tconst callInfo = BX.prop.getObject(entityData, \"CALL_INFO\", null);\n\t\tconst hasCallInfo = callInfo !== null;\n\t\tconst durationText = hasCallInfo ? BX.prop.getString(callInfo, \"DURATION_TEXT\", \"\") : \"\";\n\t\tconst hasTranscript = hasCallInfo ? BX.prop.getBoolean(callInfo, \"HAS_TRANSCRIPT\", \"\") : \"\";\n\t\tconst isTranscriptPending = hasCallInfo ? BX.prop.getBoolean(callInfo, \"TRANSCRIPT_PENDING\", \"\") : \"\";\n\t\tconst callId = hasCallInfo ? BX.prop.getString(callInfo, \"CALL_ID\", \"\") : \"\";\n\t\tconst callComment = hasCallInfo ? BX.prop.getString(callInfo, \"COMMENT\", \"\") : \"\";\n\n\t\tconst outerWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-section crm-entity-stream-section-history crm-entity-stream-section-call\"}});\n\t\touterWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-call\" }\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tif (this.isFixed())\n\t\t\tBX.addClass(outerWrapper, 'crm-entity-stream-section-top-fixed');\n\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\touterWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\tchildren: [ wrapper ]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\t//Header\n\t\tconst header = this.prepareHeaderLayout();\n\t\twrapper.appendChild(header);\n\n\t\t//region Context Menu\n\t\tif(this.isContextMenuEnabled())\n\t\t{\n\t\t\twrapper.appendChild(this.prepareContextMenuButton());\n\t\t}\n\t\t//endregion\n\n\t\t//Details\n\t\tconst detailWrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail\"}\n\t\t\t}\n\t\t);\n\t\twrapper.appendChild(detailWrapper);\n\n\t\tdetailWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-title\" },\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattrs: { href: \"#\" },\n\t\t\t\t\t\t\t\t\tevents: { \"click\": this._headerClickHandler },\n\t\t\t\t\t\t\t\t\ttext: this.getTitle()\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\t//Content\n\t\tdetailWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-description\" },\n\t\t\t\t\tchildren: this.prepareMultilineCutOffElements(description, 128, this._headerClickHandler)\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tif(hasCallInfo)\n\t\t{\n\t\t\tconst callInfoWrapper = BX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail-call crm-entity-stream-content-detail-call-inline\"}\n\t\t\t\t}\n\t\t\t);\n\t\t\tdetailWrapper.appendChild(callInfoWrapper);\n\n\t\t\tthis._mediaFileInfo = BX.prop.getObject(entityData, \"MEDIA_FILE_INFO\", null);\n\t\t\tif(this._mediaFileInfo !== null)\n\t\t\t{\n\t\t\t\tthis._playerWrapper = this._history.getManager().renderAudioDummy(durationText, this._playerDummyClickHandler);\n\t\t\t\tcallInfoWrapper.appendChild(\n\t\t\t\t\tthis._playerWrapper\n\t\t\t\t);\n\t\t\t\tcallInfoWrapper.appendChild(this._history.getManager().getAudioPlaybackRateSelector().render());\n\t\t\t}\n\n\t\t\tif(hasTranscript)\n\t\t\t{\n\t\t\t\tthis._transcriptWrapper = BX.create(\"DIV\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: \"crm-audio-transcript-wrap-container\"},\n\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\tclick: function(e)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tif(BX.Voximplant && BX.Voximplant.Transcript)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tBX.Voximplant.Transcript.create({\n\t\t\t\t\t\t\t\t\t\tcallId: callId\n\t\t\t\t\t\t\t\t\t}).show();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tchildren: [\n\t\t\t\t\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-audio-transcript-icon\"}\t}),\n\t\t\t\t\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-audio-transcript-conversation\"}, text: BX.message(\"CRM_TIMELINE_CALL_TRANSCRIPT\") } )\n\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t\tcallInfoWrapper.appendChild(this._transcriptWrapper);\n\t\t\t}\n\t\t\telse if(isTranscriptPending)\n\t\t\t{\n\t\t\t\tthis._transcriptWrapper = BX.create(\"DIV\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: \"crm-audio-transcript-wrap-container-pending\"},\n\t\t\t\t\t\tchildren: [\n\t\t\t\t\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-audio-transcript-icon-pending\"}, html: '<svg class=\"crm-transcript-loader-circular\" viewBox=\"25 25 50 50\"><circle class=\"crm-transcript-loader-path\" cx=\"50\" cy=\"50\" r=\"20\" fill=\"none\" stroke-miterlimit=\"10\"></circle></svg>'}),\n\t\t\t\t\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-audio-transcript-conversation\"}, text: BX.message(\"CRM_TIMELINE_CALL_TRANSCRIPT_PENDING\") } )\n\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t\tcallInfoWrapper.appendChild(this._transcriptWrapper);\n\t\t\t}\n\n\t\t\tif(callComment)\n\t\t\t{\n\t\t\t\tdetailWrapper.appendChild(BX.create(\"DIV\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-description\"},\n\t\t\t\t\t\ttext: callComment\n\t\t\t\t\t}\n\t\t\t\t));\n\t\t\t}\n\t\t}\n\t\tconst communicationWrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail-contact-info\"}\n\t\t\t}\n\t\t);\n\t\tdetailWrapper.appendChild(communicationWrapper);\n\n\t\t//Communications\n\t\tif(communicationTitle !== \"\")\n\t\t{\n\t\t\tif(communicationShowUrl !== \"\")\n\t\t\t{\n\t\t\t\tcommunicationWrapper.appendChild(\n\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tattrs: { href: communicationShowUrl },\n\t\t\t\t\t\t\ttext: communicationTitle\n\t\t\t\t\t\t}\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tcommunicationWrapper.appendChild(BX.create(\"SPAN\", { text: communicationTitle }));\n\t\t\t}\n\t\t}\n\n\t\tif(communicationValueFormatted !== \"\")\n\t\t{\n\t\t\tif(communicationTitle !== \"\")\n\t\t\t{\n\t\t\t\tcommunicationWrapper.appendChild(BX.create(\"SPAN\", { text: \" \" }));\n\t\t\t}\n\t\t\tcommunicationWrapper.appendChild(\n\t\t\t\tBX.create(\n\t\t\t\t\t\"SPAN\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-email-address\" },\n\t\t\t\t\t\ttext: communicationValueFormatted\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\twrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\t//region  Actions\n\t\tthis._actionContainer = BX.create(\"SPAN\", { attrs: { className: \"crm-entity-stream-content-detail-action\" } });\n\t\twrapper.appendChild(this._actionContainer);\n\t\t//endregion\n\n\t\tif (!this.isReadOnly()) {\n\n\t\t\twrapper.appendChild(this.prepareFixedSwitcherLayout());\n\t\t}\n\n\n\t\treturn outerWrapper;\n\t}\n\n\tprepareActions()\n\t{\n\t\tif(this.isReadOnly())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis._actions.push(\n\t\t\tHistoryCall.create(\n\t\t\t\t\"call\",\n\t\t\t\t{\n\t\t\t\t\titem: this,\n\t\t\t\t\tcontainer: this._actionContainer,\n\t\t\t\t\tentityData: this.getAssociatedEntityData(),\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\townerInfo: this._history.getOwnerInfo()\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t}\n\n\tgetRemoveMessage()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst direction = BX.prop.getInteger(entityData, \"DIRECTION\", 0);\n\t\tconst messageName = (direction === BX.CrmActivityDirection.incoming) ? 'incomingCallRemove' : 'outgoingCallRemove';\n\t\tconst title = BX.util.htmlspecialchars(this.getTitle());\n\t\treturn this.getMessage(messageName).replace(\"#TITLE#\", title);\n\t}\n\n\tonPlayerDummyClick(e)\n\t{\n\t\tconst stubNode = this._playerWrapper.querySelector(\".crm-audio-cap-wrap\");\n\t\tif(stubNode)\n\t\t{\n\t\t\tBX.addClass(stubNode, \"crm-audio-cap-wrap-loader\");\n\t\t}\n\n\t\tthis._history.getManager().getAudioPlaybackRateSelector().addPlayer(this._history.getManager().loadMediaPlayer(\n\t\t\t\"history_\" + this.getId(),\n\t\t\tthis._mediaFileInfo[\"URL\"],\n\t\t\tthis._mediaFileInfo[\"TYPE\"],\n\t\t\tthis._playerWrapper,\n\t\t\tthis._mediaFileInfo[\"DURATION\"],\n\t\t\t{\n\t\t\t\tplaybackRate: this._history.getManager().getAudioPlaybackRateSelector().getRate()\n\t\t\t}\n\t\t));\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Call();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import HistoryActivity from \"./history-activity\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Meeting extends HistoryActivity\n{\n\tconstructor()\n\t{\n\t\tsuper()\n\t}\n\n\tprepareHeaderLayout()\n\t{\n\t\tconst header = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-header\"}});\n\t\theader.appendChild(this.prepareTitleLayout());\n\n\t\tconst markNode = this.prepareMarkLayout();\n\t\tif(markNode)\n\t\t{\n\t\t\theader.appendChild(markNode);\n\t\t}\n\n\t\theader.appendChild(this.prepareTimeLayout());\n\n\t\treturn header;\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\n\t\tlet description = BX.prop.getString(entityData, \"DESCRIPTION_RAW\", \"\");\n\t\tif(description !== \"\")\n\t\t{\n\t\t\t//trim leading spaces\n\t\t\tdescription = description.replace(/^\\s+/,'');\n\t\t}\n\n\t\tconst communication = BX.prop.getObject(entityData, \"COMMUNICATION\", {});\n\t\tconst communicationTitle = BX.prop.getString(communication, \"TITLE\", \"\");\n\t\tconst communicationShowUrl = BX.prop.getString(communication, \"SHOW_URL\", \"\");\n\t\tconst communicationValue = BX.prop.getString(communication, \"VALUE\", \"\");\n\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-section crm-entity-stream-section-history crm-entity-stream-section-meeting\"}});\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-meeting\" } })\n\t\t);\n\n\t\tif(this.isContextMenuEnabled())\n\t\t{\n\t\t\twrapper.appendChild(this.prepareContextMenuButton());\n\t\t}\n\n\t\tif (this.isFixed())\n\t\t\tBX.addClass(wrapper, 'crm-entity-stream-section-top-fixed');\n\n\t\tconst contentWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\tchildren: [contentWrapper]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst header = this.prepareHeaderLayout();\n\t\tcontentWrapper.appendChild(header);\n\n\t\tconst detailWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-detail\"}});\n\t\tcontentWrapper.appendChild(detailWrapper);\n\n\t\tdetailWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-title\" },\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattrs: { href: \"#\" },\n\t\t\t\t\t\t\t\t\tevents: { \"click\": this._headerClickHandler },\n\t\t\t\t\t\t\t\t\ttext: this.getTitle()\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\t//Content\n\t\tdetailWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-description\" },\n\t\t\t\t\tchildren: this.prepareCutOffElements(description, 128, this._headerClickHandler)\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst communicationWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-detail-contact-info\"}});\n\t\tdetailWrapper.appendChild(communicationWrapper);\n\n\t\tif(communicationTitle !== '')\n\t\t{\n\t\t\tcommunicationWrapper.appendChild(\n\t\t\t\tBX.create(\"SPAN\",\n\t\t\t\t\t{ text: this.getMessage(\"reciprocal\") + \": \" }\n\t\t\t\t)\n\t\t\t);\n\n\t\t\tif(communicationShowUrl !== '')\n\t\t\t{\n\t\t\t\tcommunicationWrapper.appendChild(BX.create(\"A\", { attrs: { href: communicationShowUrl }, text: communicationTitle }));\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tcommunicationWrapper.appendChild(BX.create(\"SPAN\", { text: communicationTitle }));\n\t\t\t}\n\t\t}\n\n\t\tcommunicationWrapper.appendChild(BX.create(\"SPAN\", { text: \" \" + communicationValue }));\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontentWrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\t//region  Actions\n\t\tthis._actionContainer = BX.create(\"SPAN\", { attrs: { className: \"crm-entity-stream-content-detail-action\" } });\n\t\tcontentWrapper.appendChild(this._actionContainer);\n\t\t//endregion\n\n\t\tif (!this.isReadOnly())\n\t\t\tcontentWrapper.appendChild(this.prepareFixedSwitcherLayout());\n\n\t\treturn wrapper;\n\t}\n\n\tgetRemoveMessage()\n\t{\n\t\tconst title = BX.util.htmlspecialchars(this.getTitle());\n\t\treturn this.getMessage('meetingRemove').replace(\"#TITLE#\", title);\n\t}\n\n\tprepareActions()\n\t{\n\t}\n\n\tshowActions(show)\n\t{\n\t\tif(this._actionContainer)\n\t\t{\n\t\t\tthis._actionContainer.style.display = show ? \"\" : \"none\";\n\t\t}\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Meeting();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import HistoryActivity from \"./history-activity\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Task extends HistoryActivity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tprepareHeaderLayout()\n\t{\n\t\tconst header = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-header\"}});\n\t\theader.appendChild(this.prepareTitleLayout());\n\n\t\tconst markNode = this.prepareMarkLayout();\n\t\tif(markNode)\n\t\t{\n\t\t\theader.appendChild(markNode);\n\t\t}\n\n\t\theader.appendChild(this.prepareTimeLayout());\n\n\t\treturn header;\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\n\t\tlet description = BX.prop.getString(entityData, \"DESCRIPTION_RAW\", \"\");\n\t\tif(description !== \"\")\n\t\t{\n\t\t\t//trim leading spaces\n\t\t\tdescription = description.replace(/^\\s+/,'');\n\t\t}\n\n\t\tconst communication = BX.prop.getObject(entityData, \"COMMUNICATION\", {});\n\t\tconst communicationTitle = BX.prop.getString(communication, \"TITLE\", \"\");\n\t\tconst communicationShowUrl = BX.prop.getString(communication, \"SHOW_URL\", \"\");\n\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-section crm-entity-stream-section-history crm-entity-stream-section-task\"}});\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-task\" } })\n\t\t);\n\n\t\tif(this.isContextMenuEnabled())\n\t\t{\n\t\t\twrapper.appendChild(this.prepareContextMenuButton());\n\t\t}\n\n\t\tif (this.isFixed())\n\t\t\tBX.addClass(wrapper, 'crm-entity-stream-section-top-fixed');\n\n\t\tconst contentWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\tchildren: [contentWrapper]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst header = this.prepareHeaderLayout();\n\t\tcontentWrapper.appendChild(header);\n\n\t\tconst detailWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-detail\"}});\n\t\tcontentWrapper.appendChild(detailWrapper);\n\n\t\tdetailWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-title\" },\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattrs: { href: \"#\" },\n\t\t\t\t\t\t\t\t\tevents: { \"click\": this._headerClickHandler },\n\t\t\t\t\t\t\t\t\ttext: this.getTitle()\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\t//Content\n\t\tdetailWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-description\" },\n\t\t\t\t\tchildren: this.prepareCutOffElements(description, 128, this._headerClickHandler)\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst communicationWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-detail-contact-info\"}});\n\t\tdetailWrapper.appendChild(communicationWrapper);\n\n\t\tif(communicationTitle !== '')\n\t\t{\n\t\t\tcommunicationWrapper.appendChild(\n\t\t\t\tBX.create(\"SPAN\",\n\t\t\t\t\t{ text: this.getMessage(\"reciprocal\") + \": \" }\n\t\t\t\t)\n\t\t\t);\n\n\t\t\tif(communicationShowUrl !== '')\n\t\t\t{\n\t\t\t\tcommunicationWrapper.appendChild(BX.create(\"A\", { attrs: { href: communicationShowUrl }, text: communicationTitle }));\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tcommunicationWrapper.appendChild(BX.create(\"SPAN\", { text: communicationTitle }));\n\t\t\t}\n\t\t}\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontentWrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\t//region  Actions\n\t\tthis._actionContainer = BX.create(\"SPAN\", { attrs: { className: \"crm-entity-stream-content-detail-action\" } });\n\t\tcontentWrapper.appendChild(this._actionContainer);\n\t\t//endregion\n\n\t\tif (!this.isReadOnly())\n\t\t\tcontentWrapper.appendChild(this.prepareFixedSwitcherLayout());\n\n\t\treturn wrapper;\n\t}\n\n\tprepareActions()\n\t{\n\t}\n\n\tgetRemoveMessage()\n\t{\n\t\tconst title = BX.util.htmlspecialchars(this.getTitle());\n\t\treturn this.getMessage('taskRemove').replace(\"#TITLE#\", title);\n\t}\n\n\tshowActions(show)\n\t{\n\t\tif(this._actionContainer)\n\t\t{\n\t\t\tthis._actionContainer.style.display = show ? \"\" : \"none\";\n\t\t}\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Task();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import HistoryActivity from \"./history-activity\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class WebForm extends HistoryActivity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tprepareHeaderLayout()\n\t{\n\t\tconst header = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-header\"}});\n\t\theader.appendChild(this.prepareTitleLayout());\n\t\theader.appendChild(this.prepareTimeLayout());\n\n\t\treturn header;\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-section crm-entity-stream-section-history crm-entity-stream-section-crmForm\"}});\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-crmForm\" } })\n\t\t);\n\n\t\tconst contentWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\tchildren: [contentWrapper]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tif (this.isFixed())\n\t\t\tBX.addClass(wrapper, 'crm-entity-stream-section-top-fixed');\n\n\t\tconst header = this.prepareHeaderLayout();\n\t\tcontentWrapper.appendChild(header);\n\n\t\tconst detailWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-detail\"}});\n\t\tcontentWrapper.appendChild(detailWrapper);\n\n\t\tdetailWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-title\" },\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattrs: { href: \"#\" },\n\t\t\t\t\t\t\t\t\tevents: { \"click\": this._headerClickHandler },\n\t\t\t\t\t\t\t\t\ttext: this.getTitle()\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontentWrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\t//region  Actions\n\t\tthis._actionContainer = BX.create(\"SPAN\", { attrs: { className: \"crm-entity-stream-content-detail-action\" } });\n\t\tcontentWrapper.appendChild(this._actionContainer);\n\t\t//endregion\n\n\t\tif (!this.isReadOnly())\n\t\t\tcontentWrapper.appendChild(this.prepareFixedSwitcherLayout());\n\n\t\treturn wrapper;\n\t}\n\n\tprepareActions()\n\t{\n\t}\n\n\tshowActions(show)\n\t{\n\t\tif(this._actionContainer)\n\t\t{\n\t\t\tthis._actionContainer.style.display = show ? \"\" : \"none\";\n\t\t}\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new WebForm();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import HistoryActivity from \"./history-activity\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Request extends HistoryActivity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tprepareHeaderLayout()\n\t{\n\t\tconst header = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-header\"}});\n\t\theader.appendChild(this.prepareTitleLayout());\n\t\theader.appendChild(this.prepareTimeLayout());\n\n\t\treturn header;\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\n\t\tlet description = BX.prop.getString(entityData, \"DESCRIPTION_RAW\", \"\");\n\t\tif(description !== \"\")\n\t\t{\n\t\t\t//trim leading spaces\n\t\t\tdescription = description.replace(/^\\s+/,'');\n\t\t}\n\n\t\t//var entityData = this.getAssociatedEntityData();\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-section crm-entity-stream-section-today crm-entity-stream-section-robot\"}});\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-robot\" } })\n\t\t);\n\t\tif(this.isContextMenuEnabled())\n\t\t{\n\t\t\twrapper.appendChild(this.prepareContextMenuButton());\n\t\t}\n\n\t\tif (this.isFixed())\n\t\t\tBX.addClass(wrapper, 'crm-entity-stream-section-top-fixed');\n\n\t\tconst contentWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\tchildren: [contentWrapper]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst header = this.prepareHeaderLayout();\n\t\tcontentWrapper.appendChild(header);\n\n\t\tconst detailWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-detail\"}});\n\t\tcontentWrapper.appendChild(detailWrapper);\n\n\t\tdetailWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-title\" },\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattrs: { href: \"#\" },\n\t\t\t\t\t\t\t\t\tevents: { \"click\": this._headerClickHandler },\n\t\t\t\t\t\t\t\t\ttext: this.getTitle()\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\t//Content\n\t\tdetailWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-description\" },\n\t\t\t\t\tchildren: this.prepareCutOffElements(description, 128, this._headerClickHandler)\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontentWrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\t//region  Actions\n\t\tthis._actionContainer = BX.create(\"SPAN\", { attrs: { className: \"crm-entity-stream-content-detail-action\" } });\n\t\tcontentWrapper.appendChild(this._actionContainer);\n\t\t//endregion\n\n\t\tif (!this.isReadOnly())\n\t\t\tcontentWrapper.appendChild(this.prepareFixedSwitcherLayout());\n\n\t\treturn wrapper;\n\t}\n\n\tprepareActions()\n\t{\n\t}\n\n\tshowActions(show)\n\t{\n\t\tif(this._actionContainer)\n\t\t{\n\t\t\tthis._actionContainer.style.display = show ? \"\" : \"none\";\n\t\t}\n\t}\n\n\tisEditable()\n\t{\n\t\treturn false;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Request();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import HistoryActivity from \"./history-activity\";\nimport {OpenLine as OpenLineAction} from \"../actions/openline\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class OpenLine extends HistoryActivity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tprepareHeaderLayout()\n\t{\n\t\tconst header = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-header\"}});\n\t\theader.appendChild(this.prepareTitleLayout());\n\t\theader.appendChild(this.prepareTimeLayout());\n\n\t\treturn header;\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\n\t\tlet description = BX.prop.getString(entityData, \"DESCRIPTION_RAW\", \"\");\n\t\tif(description !== \"\")\n\t\t{\n\t\t\t//trim leading spaces\n\t\t\tdescription = description.replace(/^\\s+/,'');\n\t\t}\n\n\t\tconst communication = BX.prop.getObject(entityData, \"COMMUNICATION\", {});\n\t\tconst communicationTitle = BX.prop.getString(communication, \"TITLE\", \"\");\n\t\tconst communicationShowUrl = BX.prop.getString(communication, \"SHOW_URL\", \"\");\n\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-section crm-entity-stream-section-history crm-entity-stream-section-IM\"}});\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-IM\" } })\n\t\t);\n\n\t\tif(this.isContextMenuEnabled())\n\t\t{\n\t\t\twrapper.appendChild(this.prepareContextMenuButton());\n\t\t}\n\n\t\tif (this.isFixed())\n\t\t\tBX.addClass(wrapper, 'crm-entity-stream-section-top-fixed');\n\n\t\tconst contentWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\tchildren: [contentWrapper]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst header = this.prepareHeaderLayout();\n\t\tcontentWrapper.appendChild(header);\n\n\t\tconst detailWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-detail\"}});\n\t\tcontentWrapper.appendChild(detailWrapper);\n\n\t\tdetailWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-title\" },\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattrs: { href: \"#\" },\n\t\t\t\t\t\t\t\t\tevents: { \"click\": this._headerClickHandler },\n\t\t\t\t\t\t\t\t\ttext: this.getTitle()\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\t//Content\n\t\tconst entityDetailWrapper = BX.create(\"DIV\",\n\t\t\t{attrs: {className: \"crm-entity-stream-content-detail-IM\"}}\n\t\t);\n\t\tdetailWrapper.appendChild(entityDetailWrapper);\n\n\t\tconst messageWrapper = BX.create(\"DIV\",\n\t\t\t{attrs: {className: \"crm-entity-stream-content-detail-IM-messages\"}}\n\t\t);\n\t\tentityDetailWrapper.appendChild(messageWrapper);\n\n\t\tconst openLineData = BX.prop.getObject(this.getAssociatedEntityData(), \"OPENLINE_INFO\", null);\n\t\tif(openLineData)\n\t\t{\n\t\t\tconst messages = BX.prop.getArray(openLineData, \"MESSAGES\", []);\n\t\t\tlet i = 0;\n\t\t\tconst length = messages.length;\n\t\t\tfor(; i < length; i++)\n\t\t\t{\n\t\t\t\tconst message = messages[i];\n\t\t\t\tconst isExternal = BX.prop.getBoolean(message, \"IS_EXTERNAL\", true);\n\n\t\t\t\tmessageWrapper.appendChild(\n\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tattrs:\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tclassName: isExternal\n\t\t\t\t\t\t\t\t\t\t? \"crm-entity-stream-content-detail-IM-message-incoming\"\n\t\t\t\t\t\t\t\t\t\t: \"crm-entity-stream-content-detail-IM-message-outgoing\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\thtml: BX.prop.getString(message, \"MESSAGE\", \"\")\n\t\t\t\t\t\t}\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\n\t\tconst communicationWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-detail-contact-info\"}});\n\t\tdetailWrapper.appendChild(communicationWrapper);\n\n\t\tif(communicationTitle !== '')\n\t\t{\n\t\t\tcommunicationWrapper.appendChild(\n\t\t\t\tBX.create(\"SPAN\",\n\t\t\t\t\t{ text: this.getMessage(\"reciprocal\") + \": \" }\n\t\t\t\t)\n\t\t\t);\n\n\t\t\tif(communicationShowUrl !== '')\n\t\t\t{\n\t\t\t\tcommunicationWrapper.appendChild(BX.create(\"A\", { attrs: { href: communicationShowUrl }, text: communicationTitle }));\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tcommunicationWrapper.appendChild(BX.create(\"SPAN\", { text: communicationTitle }));\n\t\t\t}\n\t\t}\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontentWrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\t//region  Actions\n\t\tthis._actionContainer = BX.create(\"SPAN\", { attrs: { className: \"crm-entity-stream-content-detail-action\" } });\n\t\tcontentWrapper.appendChild(this._actionContainer);\n\t\t//endregion\n\n\t\tif (!this.isReadOnly())\n\t\t\tcontentWrapper.appendChild(this.prepareFixedSwitcherLayout());\n\n\t\treturn wrapper;\n\t}\n\n\tprepareActions()\n\t{\n\t\tif(this.isReadOnly())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis._actions.push(\n\t\t\tOpenLineAction.create(\n\t\t\t\t\"openline\",\n\t\t\t\t{\n\t\t\t\t\titem: this,\n\t\t\t\t\tcontainer: this._actionContainer,\n\t\t\t\t\tentityData: this.getAssociatedEntityData(),\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\townerInfo: this._history.getOwnerInfo()\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t}\n\n\tview()\n\t{\n\t\tif(typeof(window.top['BXIM']) === 'undefined')\n\t\t{\n\t\t\twindow.alert(this.getMessage(\"openLineNotSupported\"));\n\t\t\treturn;\n\t\t}\n\n\t\tlet slug = \"\";\n\t\tconst communication = BX.prop.getObject(this.getAssociatedEntityData(), \"COMMUNICATION\", null);\n\t\tif(communication)\n\t\t{\n\t\t\tif(BX.prop.getString(communication, \"TYPE\") === \"IM\")\n\t\t\t{\n\t\t\t\tslug = BX.prop.getString(communication, \"VALUE\");\n\t\t\t}\n\t\t}\n\n\t\tif(slug !== \"\")\n\t\t{\n\t\t\twindow.top['BXIM'].openMessengerSlider(slug, {RECENT: 'N', MENU: 'N'});\n\t\t}\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new OpenLine();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import HistoryActivity from \"./history-activity\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Rest extends HistoryActivity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tprepareHeaderLayout()\n\t{\n\t\tconst header = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-header\"}});\n\t\theader.appendChild(this.prepareTitleLayout());\n\t\theader.appendChild(this.prepareTimeLayout());\n\n\t\treturn header;\n\t}\n\n\tgetTypeDescription()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tif (entityData['APP_TYPE'] && entityData['APP_TYPE']['NAME'])\n\t\t{\n\t\t\treturn entityData['APP_TYPE']['NAME'];\n\t\t}\n\n\t\treturn super.getTypeDescription();\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\n\t\tlet description = BX.prop.getString(entityData, \"DESCRIPTION_RAW\", \"\");\n\t\tif(description !== \"\")\n\t\t{\n\t\t\t//trim leading spaces\n\t\t\tdescription = description.replace(/^\\s+/,'');\n\t\t}\n\n\t\t//var entityData = this.getAssociatedEntityData();\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-section crm-entity-stream-section-today crm-entity-stream-section-rest\"}});\n\n\t\tconst iconNode = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-rest\"}});\n\n\t\twrapper.appendChild(iconNode);\n\n\t\tif (entityData['APP_TYPE'] && entityData['APP_TYPE']['ICON_SRC'])\n\t\t{\n\t\t\tif (iconNode)\n\t\t\t{\n\t\t\t\ticonNode.style.backgroundImage = \"url('\" +  entityData['APP_TYPE']['ICON_SRC'] + \"')\";\n\t\t\t\ticonNode.style.backgroundPosition = \"center center\";\n\t\t\t\ticonNode.style.backgroundSize = \"cover\";\n\t\t\t\ticonNode.style.backgroundColor = \"transparent\";\n\t\t\t}\n\t\t}\n\n\t\tif (this.isFixed())\n\t\t\tBX.addClass(wrapper, 'crm-entity-stream-section-top-fixed');\n\n\t\tconst contentWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\tchildren: [contentWrapper]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst header = this.prepareHeaderLayout();\n\t\tcontentWrapper.appendChild(header);\n\n\t\tconst detailWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-detail\"}});\n\t\tcontentWrapper.appendChild(detailWrapper);\n\n\t\tdetailWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-title\" },\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattrs: { href: \"#\" },\n\t\t\t\t\t\t\t\t\tevents: { \"click\": this._headerClickHandler },\n\t\t\t\t\t\t\t\t\ttext: this.getTitle()\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\t//Content\n\t\tdetailWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-description\" },\n\t\t\t\t\tchildren: this.prepareCutOffElements(description, 128, this._headerClickHandler)\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontentWrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\t//region  Actions\n\t\tthis._actionContainer = BX.create(\"SPAN\", { attrs: { className: \"crm-entity-stream-content-detail-action\" } });\n\t\tcontentWrapper.appendChild(this._actionContainer);\n\t\t//endregion\n\n\t\tif (!this.isReadOnly())\n\t\t\tcontentWrapper.appendChild(this.prepareFixedSwitcherLayout());\n\n\t\treturn wrapper;\n\t}\n\n\tprepareActions()\n\t{\n\t}\n\n\tshowActions(show)\n\t{\n\t\tif(this._actionContainer)\n\t\t{\n\t\t\tthis._actionContainer.style.display = show ? \"\" : \"none\";\n\t\t}\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Rest();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import HistoryActivity from \"./history-activity\";\n\n/** @memberof BX.Crm.Timeline.Actions */\nexport default class Visit extends HistoryActivity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._playerDummyClickHandler = BX.delegate(this.onPlayerDummyClick, this);\n\t\tthis._playerWrapper = null;\n\t\tthis._transcriptWrapper = null;\n\t\tthis._mediaFileInfo = null;\n\t}\n\n\tprepareHeaderLayout()\n\t{\n\t\tconst header = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-header\"}});\n\t\theader.appendChild(this.prepareTitleLayout());\n\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst visitInfo = BX.prop.getObject(entityData, \"VISIT_INFO\", {});\n\t\tconst recordLength = BX.prop.getInteger(visitInfo, \"RECORD_LENGTH\", 0);\n\t\tconst recordLengthFormatted = BX.prop.getString(visitInfo, \"RECORD_LENGTH_FORMATTED_FULL\", \"\");\n\n\t\theader.appendChild(\n\t\t\tBX.create(\"SPAN\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-event-time\" },\n\t\t\t\t\ttext: (recordLength > 0 ? recordLengthFormatted + ', ' + BX.message('CRM_TIMELINE_VISIT_AT') + ' ' : '') + this.formatTime(this.getCreatedTime())\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\treturn header;\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\n\t\tconst communication = BX.prop.getObject(entityData, \"COMMUNICATION\", {});\n\t\tconst communicationTitle = BX.prop.getString(communication, \"TITLE\", \"\");\n\t\tconst communicationShowUrl = BX.prop.getString(communication, \"SHOW_URL\", \"\");\n\n\t\tconst visitInfo = BX.prop.getObject(entityData, \"VISIT_INFO\", {});\n\t\tconst recordLength = BX.prop.getInteger(visitInfo, \"RECORD_LENGTH\", 0);\n\t\tconst recordLengthFormatted = BX.prop.getString(visitInfo, \"RECORD_LENGTH_FORMATTED_SHORT\", \"\");\n\t\tconst vkProfile = BX.prop.getString(visitInfo, \"VK_PROFILE\", \"\");\n\n\t\tconst outerWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-section crm-entity-stream-section-history crm-entity-stream-section-visit\"}});\n\t\touterWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-visit\" }\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\touterWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\tchildren: [ wrapper ]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\t//Header\n\t\tconst header = this.prepareHeaderLayout();\n\t\twrapper.appendChild(header);\n\n\t\t//region Context Menu\n\t\tif(this.isContextMenuEnabled())\n\t\t{\n\t\t\twrapper.appendChild(this.prepareContextMenuButton());\n\t\t}\n\t\t//endregion\n\n\t\t//Details\n\t\tconst detailWrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail crm-entity-stream-content-detail-call-inline\"}\n\t\t\t}\n\t\t);\n\t\twrapper.appendChild(detailWrapper);\n\n\t\tthis._mediaFileInfo = BX.prop.getObject(entityData, \"MEDIA_FILE_INFO\", null);\n\t\tif(this._mediaFileInfo !== null && recordLength > 0)\n\t\t{\n\t\t\tthis._playerWrapper = this._history.getManager().renderAudioDummy(recordLengthFormatted, this._playerDummyClickHandler);\n\t\t\tdetailWrapper.appendChild(\n\t\t\t\t//crm-entity-stream-content-detail-call\n\t\t\t\tthis._playerWrapper\n\t\t\t);\n\t\t\tdetailWrapper.appendChild(this._history.getManager().getAudioPlaybackRateSelector().render());\n\t\t}\n\n\t\tconst communicationWrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail-contact-info\"}\n\t\t\t}\n\t\t);\n\t\twrapper.appendChild(communicationWrapper);\n\n\t\t//Communications\n\t\tif(communicationTitle !== \"\")\n\t\t{\n\t\t\tcommunicationWrapper.appendChild(document.createTextNode(BX.message(\"CRM_TIMELINE_VISIT_WITH\") + ' '));\n\t\t\tif(communicationShowUrl !== \"\")\n\t\t\t{\n\t\t\t\tcommunicationWrapper.appendChild(\n\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tattrs: { href: communicationShowUrl },\n\t\t\t\t\t\t\ttext: communicationTitle\n\t\t\t\t\t\t}\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tcommunicationWrapper.appendChild(BX.create(\"SPAN\", { text: communicationTitle }));\n\t\t\t}\n\t\t}\n\n\t\tif(BX.type.isNotEmptyString(vkProfile))\n\t\t{\n\t\t\tcommunicationWrapper.appendChild(document.createTextNode(\" \"));\n\t\t\tcommunicationWrapper.appendChild(\n\t\t\t\tBX.create(\n\t\t\t\t\t\"a\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs:\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tclassName: \"crm-entity-stream-content-detail-additional\",\n\t\t\t\t\t\t\t\ttarget: \"_blank\",\n\t\t\t\t\t\t\t\thref: this.getVkProfileUrl(vkProfile)\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\ttext: BX.message('CRM_TIMELINE_VISIT_VKONTAKTE_PROFILE')\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t)\n\n\t\t}\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\twrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\treturn outerWrapper;\n\t}\n\n\tonPlayerDummyClick(e)\n\t{\n\t\tconst stubNode = this._playerWrapper.querySelector(\".crm-audio-cap-wrap\");\n\t\tif(stubNode)\n\t\t{\n\t\t\tBX.addClass(stubNode, \"crm-audio-cap-wrap-loader\");\n\t\t}\n\n\t\tthis._history.getManager().getAudioPlaybackRateSelector().addPlayer(this._history.getManager().loadMediaPlayer(\n\t\t\t\"history_\" + this.getId(),\n\t\t\tthis._mediaFileInfo[\"URL\"],\n\t\t\tthis._mediaFileInfo[\"TYPE\"],\n\t\t\tthis._playerWrapper,\n\t\t\tthis._mediaFileInfo[\"DURATION\"],\n\t\t\t{\n\t\t\t\tplaybackRate: this._history.getManager().getAudioPlaybackRateSelector().getRate()\n\t\t\t}\n\t\t));\n\t}\n\n\tgetVkProfileUrl(profile)\n\t{\n\t\treturn 'https://vk.com/' + BX.util.htmlspecialchars(profile);\n\t}\n\n\tview()\n\t{\n\t\tif (BX.getClass('BX.Crm.Restriction.Bitrix24') && BX.Crm.Restriction.Bitrix24.isRestricted('visit'))\n\t\t{\n\t\t\treturn BX.Crm.Restriction.Bitrix24.getHandler('visit').call();\n\t\t}\n\t\tsuper.view();\n\t}\n\n\tedit()\n\t{\n\t\tif (BX.getClass('BX.Crm.Restriction.Bitrix24') && BX.Crm.Restriction.Bitrix24.isRestricted('visit'))\n\t\t{\n\t\t\treturn BX.Crm.Restriction.Bitrix24.getHandler('visit').call();\n\t\t}\n\t\tsuper.edit();\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Visit();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import HistoryActivity from \"./history-activity\";\n\n/** @memberof BX.Crm.Timeline.Actions */\nexport default class Zoom extends HistoryActivity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis._videoDummy = null;\n\t\tthis._audioDummy = null;\n\t\tthis._videoPlayer = null;\n\t\tthis._audioPlayer = null;\n\t\tthis._audioLengthElement = null;\n\t\tthis._recordings = [];\n\t\tthis._currentRecordingIndex = 0;\n\t\tthis.zoomActivitySubject = null;\n\n\t\tthis._downloadWrapper = null;\n\t\tthis._downloadSubject = null;\n\t\tthis._downloadSubjectDetail = null;\n\t\tthis._downloadVideoLink = null;\n\t\tthis._downloadSeparator = null;\n\t\tthis._downloadAudioLink = null;\n\t\tthis._playVideoLink = null;\n\t\tthis.detailZoomCopyVideoLink = null;\n\t}\n\n\tprepareHeaderLayout()\n\t{\n\t\tconst header = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-header\"}});\n\t\theader.appendChild(this.prepareTitleLayout());\n\t\tif (!this._data.hasOwnProperty('PROVIDER_DATA') || this._data[\"PROVIDER_DATA\"][\"ZOOM_EVENT_TYPE\"] !== 'ZOOM_CONF_JOINED')\n\t\t{\n\t\t\theader.appendChild(this.prepareSuccessfulLayout());\n\t\t}\n\t\theader.appendChild(this.prepareTimeLayout());\n\n\t\treturn header;\n\t}\n\n\tprepareSuccessfulLayout()\n\t{\n\t\treturn BX.create(\"SPAN\", {\n\t\t\tattrs:{ className: \"crm-entity-stream-content-event-successful\"},\n\t\t\ttext: BX.message('CRM_TIMELINE_ZOOM_SUCCESSFUL_ACTIVITY')\n\t\t});\n\t}\n\n\tprepareTitleLayout()\n\t{\n\t\tif (this._data.hasOwnProperty('PROVIDER_DATA') && this._data[\"PROVIDER_DATA\"][\"ZOOM_EVENT_TYPE\"] === 'ZOOM_CONF_JOINED')\n\t\t{\n\t\t\treturn BX.create(\"SPAN\", {\n\t\t\t\tattrs:{ className: \"crm-entity-stream-content-event-title\"},\n\t\t\t\ttext: BX.message('CRM_TIMELINE_ZOOM_JOINED_CONFERENCE')\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn BX.create(\"SPAN\", {\n\t\t\t\tattrs:{ className: \"crm-entity-stream-content-event-title\"},\n\t\t\t\ttext: BX.message('CRM_TIMELINE_ZOOM_CONFERENCE_END')\n\t\t\t});\n\t\t}\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-section crm-entity-stream-section-history\"}});\n\t\tlet entityDetailWrapper;\n\t\tconst zoomData = BX.prop.getObject(this.getAssociatedEntityData(), \"ZOOM_INFO\", null);\n\t\tconst subject = BX.prop.getString(this.getAssociatedEntityData(), \"SUBJECT\", null);\n\n\t\tthis._recordings = BX.prop.getArray(zoomData, \"RECORDINGS\", []);\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-zoom\" } })\n\t\t);\n\n\t\tif (this.isFixed())\n\t\t\tBX.addClass(wrapper, 'crm-entity-stream-section-top-fixed');\n\n\t\tconst contentWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\tchildren: [contentWrapper]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst header = this.prepareHeaderLayout();\n\t\tcontentWrapper.appendChild(header);\n\n\t\tconst detailWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-detail\"}});\n\t\tcontentWrapper.appendChild(detailWrapper);\n\n\t\tif (this._data.hasOwnProperty('PROVIDER_DATA') && this._data[\"PROVIDER_DATA\"][\"ZOOM_EVENT_TYPE\"] === 'ZOOM_CONF_JOINED')\n\t\t{\n\t\t\tentityDetailWrapper = BX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-description\" },\n\t\t\t\t\ttext: zoomData['CONF_URL']\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tentityDetailWrapper = BX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-description\" },\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tif (this._recordings.length > 0)\n\t\t\t{\n\t\t\t\tif (this._recordings.length > 1)\n\t\t\t\t{\n\t\t\t\t\t//render video parts header\n\n\t\t\t\t\tconst tabs = this._recordings.map(function (recording, index) {\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tid: index,\n\t\t\t\t\t\t\ttitle: BX.message(\"CRM_TIMELINE_ZOOM_MEETING_RECORD_PART\").replace(\"#NUMBER#\", index + 1),\n\t\t\t\t\t\t\ttime: recording[\"AUDIO\"] ? recording[\"AUDIO\"][\"LENGTH_FORMATTED\"] : \"\",\n\t\t\t\t\t\t\tactive: index === 0\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tconst tabsComponent = new Zoom.TabsComponent({\n\t\t\t\t\t\ttabs: tabs,\n\t\t\t\t\t});\n\t\t\t\t\ttabsComponent.eventEmitter.subscribe(\"onTabChange\", this._onTabChange.bind(this));\n\t\t\t\t\tdetailWrapper.appendChild(tabsComponent.render());\n\t\t\t\t}\n\n\t\t\t\tthis._videoDummy = BX.create(\"DIV\",\n\t\t\t\t\t{\n\t\t\t\t\t\tprops: { className: \"crm-entity-stream-content-detail-zoom-video-wrap\"},\n\t\t\t\t\t\tchildren: [\n\t\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tprops: { className: \"crm-entity-stream-content-detail-zoom-video\" },\n\t\t\t\t\t\t\t\t\tevents:\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\tclick: this._onVideoDummyClick.bind(this)\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tchildren: [\n\t\t\t\t\t\t\t\t\t\tBX.create(\"DIV\", {\n\t\t\t\t\t\t\t\t\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-video-inner\"},\n\t\t\t\t\t\t\t\t\t\t\tchildren: [\n\t\t\t\t\t\t\t\t\t\t\t\tBX.create(\"DIV\", {\n\t\t\t\t\t\t\t\t\t\t\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-video-btn\"},\n\t\t\t\t\t\t\t\t\t\t\t\t\tdataset: {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\thint: BX.message(\"CRM_TIMELINE_ZOOM_LOGIN_REQUIRED\"),\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t'hintNoIcon': 'Y'\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\t\t\t\t\tBX.create(\"SPAN\", {\n\t\t\t\t\t\t\t\t\t\t\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-video-text\"},\n\t\t\t\t\t\t\t\t\t\t\t\t\ttext: BX.message(\"CRM_TIMELINE_ZOOM_CLICK_TO_WATCH\")\n\t\t\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t]\n\t\t\t\t\t});\n\n\t\t\t\tBX.UI.Hint.init(this._videoDummy);\n\n\t\t\t\tthis._audioDummy = this._history.getManager().renderAudioDummy(\"00:15\", this._onAudioDummyClick.bind(this));\n\t\t\t\tthis._audioLengthElement = this._audioDummy.querySelector('.crm-audio-cap-time');\n\n\t\t\t\tif (zoomData['RECORDINGS'][0]['VIDEO'])\n\t\t\t\t{\n\t\t\t\t\t//video download link with token valid for 24h\n\t\t\t\t\tconst videoLinkExpireTS = (zoomData['RECORDINGS'][0]['VIDEO']['END_DATE_TS'] * 1000) + (60 * 60 * 23 * 1000);\n\t\t\t\t\tif (videoLinkExpireTS < Date.now())\n\t\t\t\t\t{\n\t\t\t\t\t\tconst videoLinkContainer = BX.create(\"DIV\", {\n\t\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\t\tclassName: \"crm-entity-stream-content-detail-zoom-desc\",\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tthis._playVideoLink = BX.create(\"DIV\", {\n\t\t\t\t\t\t\thtml: BX.message(\"CRM_TIMELINE_ZOOM_PLAY_LINK_VIDEO\"),\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tthis._detailZoomCopyVideoLink = BX.create(\"A\",\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\t\t\tclassName: 'ui-link ui-link-dashed',\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\ttext: BX.message(\"CRM_TIMELINE_ZOOM_COPY_PASSWORD\")\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\tvideoLinkContainer.appendChild(this._playVideoLink);\n\t\t\t\t\t\tvideoLinkContainer.appendChild(this._detailZoomCopyVideoLink);\n\t\t\t\t\t\tentityDetailWrapper.appendChild(videoLinkContainer);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tentityDetailWrapper.appendChild(this._videoDummy);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (zoomData['RECORDINGS'][0]['AUDIO'])\n\t\t\t\t{\n\t\t\t\t\tconst zoomAudioDetailWrapper = BX.create(\"DIV\",\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail-call crm-entity-stream-content-detail-call-inline\"},\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\n\t\t\t\t\tzoomAudioDetailWrapper.appendChild(this._audioDummy);\n\t\t\t\t\tzoomAudioDetailWrapper.appendChild(this._history.getManager().getAudioPlaybackRateSelector().render());\n\t\t\t\t\tentityDetailWrapper.appendChild(zoomAudioDetailWrapper);\n\t\t\t\t}\n\n\t\t\t\tthis._downloadWrapper = BX.create(\"DIV\", {\n\t\t\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-desc\"},\n\t\t\t\t});\n\n\t\t\t\tentityDetailWrapper.appendChild(this._downloadWrapper);\n\n\t\t\t\tthis._downloadSubject = BX.create(\"SPAN\", {\n\t\t\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-desc-subject\"},\n\t\t\t\t});\n\t\t\t\tthis._downloadSubjectDetail = BX.create(\"SPAN\", {\n\t\t\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-desc-detail\"},\n\t\t\t\t});\n\t\t\t\tthis._downloadVideoLink = BX.create(\"A\", {\n\t\t\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-desc-link\"},\n\t\t\t\t\ttext: BX.message(\"CRM_TIMELINE_ZOOM_DOWNLOAD_VIDEO\")\n\t\t\t\t});\n\t\t\t\tthis._downloadSeparator = BX.create(\"SPAN\", {\n\t\t\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-desc-separate\"},\n\t\t\t\t\thtml: \"&mdash;\"\n\t\t\t\t});\n\t\t\t\tthis._downloadAudioLink = BX.create(\"A\", {\n\t\t\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-desc-link\"},\n\t\t\t\t\ttext: BX.message(\"CRM_TIMELINE_ZOOM_DOWNLOAD_AUDIO\")\n\t\t\t\t});\n\t\t\t\tthis.setCurrentRecording(0);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.zoomActivitySubject = BX.create(\"DIV\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-title\" },\n\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tattrs: { href: \"#\" },\n\t\t\t\t\t\t\t\t\t\tevents: { \"click\": this._headerClickHandler },\n\t\t\t\t\t\t\t\t\t\ttext: subject\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t);\n\n\t\t\t\tentityDetailWrapper.appendChild(this.zoomActivitySubject);\n\n\t\t\t\tif (zoomData['HAS_RECORDING'] === 'Y')\n\t\t\t\t{\n\t\t\t\t\tentityDetailWrapper.appendChild(BX.create(\"DIV\", {\n\t\t\t\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-video\"},\n\t\t\t\t\t\tchildren: [\n\t\t\t\t\t\t\tBX.create(\"DIV\", {\n\t\t\t\t\t\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-video-inner\"},\n\t\t\t\t\t\t\t\tchildren: [\n\t\t\t\t\t\t\t\t\tBX.create(\"DIV\", {\n\t\t\t\t\t\t\t\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-video-img\"},\n\t\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\t\tBX.create(\"SPAN\", {\n\t\t\t\t\t\t\t\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-video-text\"},\n\t\t\t\t\t\t\t\t\t\ttext: BX.message(\"CRM_TIMELINE_ZOOM_MEETING_RECORD_IN_PROCESS\")\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t]\n\t\t\t\t\t}));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t/*else\n\t\t{\n\t\t\tdetailWrapper.appendChild(BX.create(\"span\", {text: \"456\"}));\n\n\t\t\tvar entityDetailWrapper = BX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-description\" },\n\t\t\t\t\ttext: BX.prop.getString(zoomData, \"CONF_URL\", \"\")\n\t\t\t\t}\n\t\t\t);\n\t\t}*/\n\t\t//Content //todo\n\n\n\t\tif(entityDetailWrapper)\n\t\t{\n\t\t\tdetailWrapper.appendChild(entityDetailWrapper);\n\t\t}\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontentWrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\treturn wrapper;\n\t}\n\n\t_onVideoDummyClick()\n\t{\n\t\tBX.UI.Hint.hide();\n\t\tconst recording = this._recordings[this._currentRecordingIndex][\"VIDEO\"];\n\t\tif(!recording)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tthis._videoPlayer = this._history.getManager().loadMediaPlayer(\n\t\t\t\"zoom_video_\" + this.getId(),\n\t\t\trecording[\"DOWNLOAD_URL\"],\n\t\t\t\"video/mp4\",\n\t\t\tthis._videoDummy,\n\t\t\trecording[\"LENGTH\"],\n\t\t\t{\n\t\t\t\tvideo: true,\n\t\t\t\tskin: \"\",\n\t\t\t\twidth: 480,\n\t\t\t\theight: 270\n\t\t\t}\n\t\t);\n\t}\n\n\t_onAudioDummyClick()\n\t{\n\t\tconst recording = this._recordings[this._currentRecordingIndex][\"AUDIO\"];\n\t\tif(!recording)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tthis._history.getManager().getAudioPlaybackRateSelector().addPlayer(this._audioPlayer = this._history.getManager().loadMediaPlayer(\n\t\t\t\"zoom_audio_\" + this.getId(),\n\t\t\trecording[\"DOWNLOAD_URL\"],\n\t\t\t\"audio/mp4\",\n\t\t\tthis._audioDummy,\n\t\t\trecording[\"LENGTH\"],\n\t\t\t{\n\t\t\t\tplaybackRate: this._history.getManager().getAudioPlaybackRateSelector().getRate()\n\t\t\t}\n\t\t));\n\t}\n\n\t_onTabChange(event)\n\t{\n\t\tthis.setCurrentRecording(event.data.tabId);\n\t}\n\n\tsetCurrentRecording(recordingIndex)\n\t{\n\t\tthis._currentRecordingIndex = recordingIndex;\n\t\tconst videoRecording = this._recordings[this._currentRecordingIndex][\"VIDEO\"];\n\t\tconst audioRecording = this._recordings[this._currentRecordingIndex][\"AUDIO\"];\n\n\t\tif(videoRecording)\n\t\t{\n\t\t\tthis._videoDummy.hidden = false;\n\t\t\tif(this._videoPlayer)\n\t\t\t{\n\t\t\t\tthis._videoPlayer.pause();\n\t\t\t\tthis._videoPlayer.setSource(videoRecording[\"DOWNLOAD_URL\"]);\n\t\t\t\tthis._downloadVideoLink.href = videoRecording[\"DOWNLOAD_URL\"];\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis._videoDummy.hidden = true;\n\t\t}\n\n\t\tif(audioRecording)\n\t\t{\n\t\t\tthis._audioDummy.hidden = false;\n\t\t\tif(this._audioPlayer)\n\t\t\t{\n\t\t\t\tthis._audioPlayer.pause();\n\t\t\t\tthis._audioPlayer.setSource(audioRecording[\"DOWNLOAD_URL\"]);\n\t\t\t}\n\t\t\tthis._downloadAudioLink.href = audioRecording[\"DOWNLOAD_URL\"];\n\t\t\tthis._audioLengthElement.innerText = audioRecording[\"LENGTH_FORMATTED\"];\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis._audioDummy.hidden = true;\n\t\t}\n\n\t\tBX.clean(this._downloadWrapper);\n\t\tif(audioRecording || videoRecording)\n\t\t{\n\t\t\tconst lengthHuman = audioRecording ? audioRecording[\"LENGTH_HUMAN\"] : videoRecording[\"LENGTH_HUMAN\"];\n\t\t\tthis._downloadWrapper.appendChild(this._downloadSubject);\n\t\t\tthis._downloadSubject.innerHTML = BX.util.htmlspecialchars(BX.message(\"CRM_TIMELINE_ZOOM_MEETING_RECORD\").replace(\"#DURATION#\", lengthHuman)) + \" &mdash; \"\n\t\t\tthis._downloadWrapper.appendChild(this._downloadSubjectDetail);\n\t\t}\n\t\tif (videoRecording)\n\t\t{\n\t\t\tthis._downloadSubjectDetail.appendChild(this._downloadVideoLink);\n\t\t\tthis._downloadVideoLink.href = videoRecording['DOWNLOAD_URL'];\n\t\t\tif (audioRecording)\n\t\t\t{\n\t\t\t\tthis._downloadSubjectDetail.appendChild(this._downloadSeparator);\n\t\t\t}\n\n\t\t\tif (this._playVideoLink)\n\t\t\t{\n\t\t\t\tthis._playVideoLink.lastElementChild.href = videoRecording[\"PLAY_URL\"];\n\t\t\t\tthis._downloadVideoLink.href = videoRecording[\"PLAY_URL\"];\n\t\t\t}\n\t\t\tif (this._detailZoomCopyVideoLink)\n\t\t\t{\n\t\t\t\tBX.clipboard.bindCopyClick(this._detailZoomCopyVideoLink, {\n\t\t\t\t\ttext: videoRecording['PASSWORD'],\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\tif (audioRecording)\n\t\t{\n\t\t\tthis._downloadSubjectDetail.appendChild(this._downloadAudioLink);\n\t\t\tthis._downloadAudioLink.href = audioRecording['DOWNLOAD_URL'];\n\t\t}\n\t}\n\n\tprepareActions()\n\t{\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Zoom();\n\t\tself.initialize(id, settings);\n\n\t\t//todo: remove debug\n\t\tif(!window['zoom'])\n\t\t{\n\t\t\twindow['zoom'] = [];\n\t\t}\n\t\twindow['zoom'].push(self);\n\t\treturn self;\n\t}\n}\n\nZoom.TabsComponent = class\n{\n\tconstructor(config)\n\t{\n\t\tthis.tabs = BX.prop.getArray(config, \"tabs\", []);\n\t\tthis.elements = {\n\t\t\tcontainer: null,\n\t\t\ttabs: {}\n\t\t};\n\t\tthis.eventEmitter = new BX.Event.EventEmitter(this, 'Zoom.TabsComponent');\n\t}\n\n\trender()\n\t{\n\t\tif(this.elements.container)\n\t\t{\n\t\t\treturn this.elements.container;\n\t\t}\n\n\t\tthis.elements.container = BX.create(\"DIV\", {\n\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-section-wrapper\"},\n\t\t\tchildren: [\n\t\t\t\tBX.create(\"DIV\", {\n\t\t\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-section-list\"},\n\t\t\t\t\tchildren: this.tabs.map(this._renderTab, this)\n\t\t\t\t})\n\t\t\t]\n\t\t});\n\t\treturn this.elements.container;\n\t}\n\n\t_renderTab(tabDescription)\n\t{\n\t\tconst tabId = tabDescription.id;\n\t\tthis.elements.tabs[tabId] = BX.create(\"DIV\", {\n\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-section\" + (tabDescription.active ? \" crm-entity-stream-content-detail-zoom-section-active\": \"\")},\n\t\t\tchildren: [\n\t\t\t\tBX.create(\"DIV\", {\n\t\t\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-section-inner\"},\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tBX.create(\"DIV\", {\n\t\t\t\t\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-section-title\"},\n\t\t\t\t\t\t\ttext: tabDescription.title\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tBX.create(\"DIV\", {\n\t\t\t\t\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-section-time\"},\n\t\t\t\t\t\t\ttext: tabDescription.time\n\t\t\t\t\t\t})\n\t\t\t\t\t]\n\t\t\t\t})\n\t\t\t],\n\t\t\tevents: {\n\t\t\t\tclick: function()\n\t\t\t\t{\n\t\t\t\t\tthis.setActiveTab(tabDescription.id)\n\t\t\t\t}.bind(this)\n\t\t\t}\n\t\t});\n\t\treturn this.elements.tabs[tabId];\n\t}\n\n\tsetActiveTab(tabId)\n\t{\n\t\tif(!this.elements.tabs[tabId])\n\t\t{\n\t\t\tthrow new Error (\"Tab \" + tabId + \" is not found\");\n\t\t}\n\t\tfor (let id in this.elements.tabs)\n\t\t{\n\t\t\tif(!this.elements.tabs.hasOwnProperty(id))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tid = Number.parseInt(id, 10);\n\t\t\tif (id === tabId)\n\t\t\t{\n\t\t\t\tthis.elements.tabs[id].classList.add(\"crm-entity-stream-content-detail-zoom-section-active\");\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.elements.tabs[id].classList.remove(\"crm-entity-stream-content-detail-zoom-section-active\");\n\t\t\t}\n\t\t}\n\t\tthis.eventEmitter.emit(\"onTabChange\", {\n\t\t\ttabId: tabId\n\t\t});\n\t}\n};\n","import History from \"./history\";\n\n/** @memberof BX.Crm.Timeline.Actions */\nexport default class OrderModification extends History\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = OrderModification.messages;\n\t\treturn m.hasOwnProperty(name) ? m[name] : name;\n\t}\n\n\tgetTitle()\n\t{\n\t\treturn this.getTextDataParam(\"TITLE\");\n\t}\n\n\tgetStatusInfo()\n\t{\n\t\tconst statusInfo = {};\n\t\tlet value = null;\n\t\tlet classCode = null;\n\t\tconst fieldName = this.getTextDataParam(\"CHANGED_ENTITY\");\n\t\tconst fields = this.getObjectDataParam('FIELDS');\n\t\tconst entityData = this.getAssociatedEntityData();\n\n\t\tif (fieldName === BX.CrmEntityType.names.order)\n\t\t{\n\t\t\tif (BX.prop.get(fields, 'ORDER_CANCELED') === 'Y')\n\t\t\t{\n\t\t\t\tvalue = \"canceled\";\n\t\t\t\tclassCode  = \"not-paid\";\n\t\t\t}\n\t\t\telse if (BX.prop.get(fields, 'ORDER_DONE') === 'Y')\n\t\t\t{\n\t\t\t\tvalue = \"done\";\n\t\t\t\tclassCode  = \"done\";\n\t\t\t}\n\t\t\telse if (BX.prop.getString(entityData, \"VIEWED\", '') === 'Y')\n\t\t\t{\n\t\t\t\tvalue = \"viewed\";\n\t\t\t\tclassCode  = \"done\";\n\t\t\t}\n\t\t\telse if (BX.prop.getString(entityData, \"SENT\", '') === 'Y')\n\t\t\t{\n\t\t\t\tvalue = \"sent\";\n\t\t\t\tclassCode  = \"sent\";\n\t\t\t}\n\t\t}\n\t\tif (fieldName === BX.CrmEntityType.names.orderpayment)\n\t\t{\n\t\t\tconst psStatusCode = BX.prop.get(fields, 'STATUS_CODE', false);\n\t\t\tif (psStatusCode)\n\t\t\t{\n\t\t\t\tif (psStatusCode === 'ERROR')\n\t\t\t\t{\n\t\t\t\t\tvalue = \"orderPaymentError\";\n\t\t\t\t\tclassCode = \"payment-error\";\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (BX.prop.getString(entityData, \"VIEWED\", '') === 'Y')\n\t\t\t{\n\t\t\t\tvalue = \"viewed\";\n\t\t\t\tclassCode  = \"done\";\n\t\t\t}\n\t\t\telse if (BX.prop.getString(entityData, \"SENT\", '') === 'Y')\n\t\t\t{\n\t\t\t\tvalue = \"sent\";\n\t\t\t\tclassCode  = \"sent\";\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tvalue = BX.prop.get(fields, 'ORDER_PAID') === 'Y' ? \"paid\" : \"unpaid\";\n\t\t\t\tclassCode  = BX.prop.get(fields, 'ORDER_PAID') === 'Y' ? \"paid\" : \"not-paid\";\n\t\t\t}\n\t\t}\n\t\telse if (fieldName === BX.CrmEntityType.names.ordershipment && BX.prop.get(fields, 'ORDER_DEDUCTED', false))\n\t\t{\n\t\t\tvalue = BX.prop.get(fields, 'ORDER_DEDUCTED') === 'Y' ? \"deducted\" : \"unshipped\";\n\t\t\tclassCode  = BX.prop.get(fields, 'ORDER_DEDUCTED') === 'Y' ? \"shipped\" : \"not-shipped\";\n\t\t}\n\t\telse if (fieldName === BX.CrmEntityType.names.ordershipment && BX.prop.get(fields, 'ORDER_ALLOW_DELIVERY', false))\n\t\t{\n\t\t\tvalue = BX.prop.get(fields, 'ORDER_ALLOW_DELIVERY') === 'Y' ? \"allowedDelivery\" : \"disallowedDelivery\";\n\t\t\tclassCode  = BX.prop.get(fields, 'ORDER_ALLOW_DELIVERY') === 'Y' ? \"allowed-delivery\" : \"disallowed-delivery\";\n\t\t}\n\n\t\tif (value)\n\t\t{\n\t\t\tstatusInfo.className = \"crm-entity-stream-content-event-\" + classCode;\n\t\t\tstatusInfo.message = this.getMessage(value);\n\t\t}\n\n\t\treturn statusInfo;\n\t}\n\n\tgetHeaderChildren()\n\t{\n\t\tconst children = [\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-event-title\"},\n\t\t\t\t\tevents: {click: this._headerClickHandler},\n\t\t\t\t\ttext: this.getTitle(),\n\t\t\t\t}\n\t\t\t)\n\t\t];\n\t\tconst statusInfo = this.getStatusInfo();\n\t\tif (BX.type.isNotEmptyObject(statusInfo))\n\t\t{\n\t\t\tchildren.push(\n\t\t\t\tBX.create(\"SPAN\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: statusInfo.className },\n\t\t\t\t\t\ttext: statusInfo.message\n\t\t\t\t\t}\n\t\t\t\t));\n\t\t}\n\t\tchildren.push(\n\t\t\tBX.create(\"SPAN\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-event-time\" },\n\t\t\t\t\ttext: this.formatTime(this.getCreatedTime())\n\t\t\t\t}\n\t\t\t));\n\t\treturn children;\n\t}\n\n\tprepareContentDetails()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst entityTypeId = this.getAssociatedEntityTypeId();\n\t\tconst entityId = this.getAssociatedEntityId();\n\t\tconst title = BX.prop.getString(entityData, \"TITLE\");\n\t\tconst htmlTitle = BX.prop.getString(entityData, \"HTML_TITLE\", \"\");\n\t\tconst showUrl = BX.prop.getString(entityData, \"SHOW_URL\", \"\");\n\t\tconst nodes = [];\n\t\tif(title !== \"\")\n\t\t{\n\t\t\tconst descriptionNode = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-detail-description\"}});\n\n\t\t\tif(showUrl === \"\" || (entityTypeId === this.getOwnerTypeId() && entityId === this.getOwnerId()))\n\t\t\t{\n\t\t\t\tdescriptionNode.appendChild(BX.create(\"SPAN\", { text: title + \" \" + htmlTitle}));\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (htmlTitle === \"\")\n\t\t\t\t{\n\t\t\t\t\tdescriptionNode.appendChild(BX.create(\"A\", {attrs: {href: showUrl}, text: title}));\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tdescriptionNode.appendChild(BX.create(\"SPAN\", { text: title + \" \"}));\n\t\t\t\t\tdescriptionNode.appendChild(BX.create(\"A\", {attrs: {href: showUrl}, text: htmlTitle}));\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst legend = BX.prop.getString(entityData, \"LEGEND\");\n\t\t\tif(legend !== \"\")\n\t\t\t{\n\t\t\t\tdescriptionNode.appendChild(BX.create(\"SPAN\", { html: \" \" + legend }));\n\t\t\t}\n\n\t\t\tconst sublegend = BX.prop.getString(entityData, \"SUBLEGEND\", '');\n\t\t\tif (sublegend !== '')\n\t\t\t{\n\t\t\t\tdescriptionNode.appendChild(BX.create(\"BR\"));\n\t\t\t\tdescriptionNode.appendChild(BX.create(\"SPAN\", { text: \" \" + sublegend}));\n\t\t\t}\n\t\t\tnodes.push(descriptionNode);\n\t\t}\n\n\t\treturn nodes;\n\t}\n\n\tprepareViewedContentDetails()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst entityTypeId = this.getAssociatedEntityTypeId();\n\t\tconst entityId = this.getAssociatedEntityId();\n\t\tconst title = BX.prop.getString(entityData, \"TITLE\");\n\t\tconst showUrl = BX.prop.getString(entityData, \"SHOW_URL\", \"\");\n\t\tconst nodes = [];\n\n\t\tif (title !== \"\")\n\t\t{\n\t\t\tconst sublegend = BX.prop.getString(entityData, \"SUBLEGEND\", '');\n\t\t\tif (sublegend !== \"\")\n\t\t\t{\n\t\t\t\tconst descriptionNode = BX.create(\"DIV\", {\n\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail-description\"},\n\t\t\t\t\ttext: sublegend,\n\t\t\t\t});\n\t\t\t\tnodes.push(descriptionNode);\n\t\t\t}\n\n\n\t\t\tif(entityTypeId === this.getOwnerTypeId() && entityId === this.getOwnerId())\n\t\t\t{\n\t\t\t\tnodes.push(BX.create(\"SPAN\", { text: title }));\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tnodes.push(BX.create(\"A\", { attrs: { href: showUrl }, text: title }));\n\t\t\t}\n\n\t\t\tconst legend = BX.prop.getString(entityData, \"LEGEND\");\n\t\t\tif(legend !== \"\")\n\t\t\t{\n\t\t\t\tnodes.push(BX.create(\"SPAN\", { html: \" \" + legend }));\n\t\t\t}\n\t\t}\n\n\t\treturn nodes;\n\t}\n\n\tprepareSentContentDetails()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst entityTypeId = this.getAssociatedEntityTypeId();\n\t\tconst entityId = this.getAssociatedEntityId();\n\t\tconst title = BX.prop.getString(entityData, \"TITLE\");\n\t\tconst showUrl = BX.prop.getString(entityData, 'SHOW_URL', '');\n\t\tconst destination = BX.prop.getString(entityData, 'DESTINATION_TITLE', '');\n\t\tconst nodes = [];\n\n\t\tif (title !== \"\")\n\t\t{\n\t\t\tconst detailNode = BX.create('DIV', {attrs: {className: 'crm-entity-stream-content-detail-description'}});\n\t\t\tif(showUrl === \"\" || (entityTypeId === this.getOwnerTypeId() && entityId === this.getOwnerId()))\n\t\t\t{\n\t\t\t\tdetailNode.appendChild(BX.create(\"SPAN\", { text: title }));\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tdetailNode.appendChild(BX.create('A', { attrs: { href: showUrl }, text: title }));\n\t\t\t}\n\n\t\t\tconst legend = BX.prop.getString(entityData, \"LEGEND\");\n\t\t\tif(legend !== \"\")\n\t\t\t{\n\t\t\t\tdetailNode.appendChild(BX.create(\"SPAN\", { html: \" \" + legend }));\n\t\t\t}\n\n\t\t\tif (destination)\n\t\t\t{\n\t\t\t\tdetailNode.appendChild(BX.create('SPAN', {\n\t\t\t\t\tattrs: { className: 'crm-entity-stream-content-detail-order-destination' },\n\t\t\t\t\ttext: destination,\n\t\t\t\t}));\n\t\t\t}\n\n\t\t\tnodes.push(detailNode);\n\n\t\t\tconst sliderLinkNode = BX.create('A', {\n\t\t\t\tattrs: {href: \"#\"},\n\t\t\t\ttext: this.getMessage('orderPaymentProcess'),\n\t\t\t\tevents: {\n\t\t\t\t\tclick: BX.proxy(this.startSalescenterApplication, this),\n\t\t\t\t},\n\t\t\t});\n\t\t\tnodes.push(sliderLinkNode);\n\t\t}\n\n\t\treturn nodes;\n\t}\n\n\tstartSalescenterApplication()\n\t{\n\t\tBX.loadExt('salescenter.manager').then(function()\n\t\t{\n\t\t\tconst fields = this.getObjectDataParam('FIELDS'),\n\t\t\t\townerTypeId = BX.prop.get(fields, 'OWNER_TYPE_ID', BX.CrmEntityType.enumeration.deal);\n\t\t\tlet ownerId = BX.prop.get(fields, 'OWNER_ID', 0);\n\t\t\tconst paymentId = BX.prop.get(fields, 'PAYMENT_ID', 0),\n\t\t\t\tshipmentId = BX.prop.get(fields, 'SHIPMENT_ID', 0),\n\t\t\t\torderId = BX.prop.get(fields, 'ORDER_ID', 0)\n\t\t\t;\n\n\t\t\t// compatibility\n\t\t\tif (!ownerId)\n\t\t\t{\n\t\t\t\townerId = BX.prop.get(fields, 'DEAL_ID', 0);\n\t\t\t}\n\n\t\t\tBX.Salescenter.Manager.openApplication({\n\t\t\t\tdisableSendButton: '',\n\t\t\t\tcontext: 'deal',\n\t\t\t\townerTypeId: ownerTypeId,\n\t\t\t\townerId: ownerId,\n\t\t\t\tmode: ownerTypeId === BX.CrmEntityType.enumeration.deal ? 'payment_delivery' : 'payment',\n\t\t\t\ttemplateMode: 'view',\n\t\t\t\torderId: orderId,\n\t\t\t\tpaymentId: paymentId,\n\t\t\t\tshipmentId: shipmentId,\n\t\t\t});\n\t\t}.bind(this));\n\t}\n\n\tpreparePaidPaymentContentDetails()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData(),\n\t\t\ttitle = BX.prop.getString(entityData, \"TITLE\"),\n\t\t\tdate = BX.prop.getString(entityData, \"DATE\", \"\"),\n\t\t\tpaySystemName = BX.prop.getString(entityData, \"PAY_SYSTEM_NAME\", \"\"),\n\t\t\tsum = BX.prop.getString(entityData, 'SUM', ''),\n\t\t\tcurrency = BX.prop.getString(entityData, 'CURRENCY', ''),\n\t\t\tnodes = [];\n\n\t\tif(title !== \"\")\n\t\t{\n\t\t\tconst paymentDetail = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-detail-payment\"}});\n\t\t\tpaymentDetail.appendChild(\n\t\t\t\tBX.create(\"DIV\", {\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-payment-value\"},\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tBX.create('SPAN', {\n\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-payment-text\"},\n\t\t\t\t\t\t\thtml: sum,\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tBX.create('SPAN', {\n\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-payment-currency\"},\n\t\t\t\t\t\t\thtml: currency,\n\t\t\t\t\t\t}),\n\t\t\t\t\t]\n\t\t\t\t})\n\t\t\t);\n\n\t\t\tconst logotip = BX.prop.getString(entityData, \"LOGOTIP\", null);\n\t\t\tif (logotip)\n\t\t\t{\n\t\t\t\tpaymentDetail.appendChild(\n\t\t\t\t\tBX.create(\"DIV\", {\n\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-payment-logo\"},\n\t\t\t\t\t\tstyle: {\n\t\t\t\t\t\t\tbackgroundImage: \"url(\" + encodeURI(logotip) + \")\",\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t);\n\t\t\t}\n\t\t\tnodes.push(paymentDetail);\n\n\t\t\tconst descriptionNode = BX.create(\"DIV\", {\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail-description\"},\n\t\t\t\tchildren: [\n\t\t\t\t\tBX.create('SPAN', {\n\t\t\t\t\t\ttext: date\n\t\t\t\t\t}),\n\t\t\t\t\tBX.create('SPAN', {\n\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail-description-info\"},\n\t\t\t\t\t\ttext: this.getMessage('orderPaySystemTitle')\n\t\t\t\t\t}),\n\t\t\t\t\tBX.create('SPAN', {\n\t\t\t\t\t\ttext: paySystemName\n\t\t\t\t\t}),\n\t\t\t\t]\n\t\t\t});\n\t\t\tnodes.push(descriptionNode);\n\t\t}\n\n\t\treturn nodes;\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst fields = this.getObjectDataParam('FIELDS'),\n\t\t\tisPaid = BX.prop.get(fields, 'ORDER_PAID') === 'Y',\n\t\t\tisClick = BX.prop.get(fields, 'PAY_SYSTEM_CLICK') === 'Y',\n\t\t\tisManualContinuePay = BX.prop.get(fields, 'MANUAL_CONTINUE_PAY') === 'Y',\n\t\t\tisManualAddCheck = BX.prop.get(fields, 'NEED_MANUAL_ADD_CHECK') === 'Y',\n\t\t\tentityId = this.getAssociatedEntityTypeId();\n\n\t\tif (entityId === BX.CrmEntityType.enumeration.orderpayment && isPaid)\n\t\t{\n\t\t\treturn this.preparePaidPaymentContent();\n\t\t}\n\t\telse if (entityId === BX.CrmEntityType.enumeration.orderpayment && isClick)\n\t\t{\n\t\t\treturn this.prepareClickedPaymentContent();\n\t\t}\n\t\telse if (entityId === BX.CrmEntityType.enumeration.order && isManualContinuePay)\n\t\t{\n\t\t\treturn this.prepareManualContinuePayContent();\n\t\t}\n\t\telse if (entityId === BX.CrmEntityType.enumeration.orderpayment && isManualAddCheck)\n\t\t{\n\t\t\treturn this.prepareManualAddCheck();\n\t\t}\n\n\t\treturn this.prepareItemOrderContent();\n\t}\n\n\tprepareItemOrderContent()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst isViewed = BX.prop.getString(entityData, \"VIEWED\", '') === 'Y';\n\t\tconst isSent = BX.prop.getString(entityData, \"SENT\", '') === 'Y';\n\t\tconst fields = this.getObjectDataParam('FIELDS');\n\t\tconst psStatusCode = BX.prop.get(fields, 'STATUS_CODE', false);\n\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: 'crm-entity-stream-section crm-entity-stream-section-history'}});\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: 'crm-entity-stream-section-icon ' + this.getIconClassName() } })\n\t\t);\n\n\t\tconst content = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\tconst header = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-header\"},\n\t\t\t\tchildren: this.getHeaderChildren()\n\t\t\t});\n\n\t\tlet contentChildren = null;\n\t\tif (isViewed)\n\t\t{\n\t\t\tcontentChildren = this.prepareViewedContentDetails();\n\t\t}\n\t\telse if (isSent)\n\t\t{\n\t\t\tcontentChildren = this.prepareSentContentDetails();\n\t\t}\n\t\telse if (psStatusCode === 'ERROR')\n\t\t{\n\t\t\tcontentChildren = this.prepareErrorPaymentContentDetails();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tcontentChildren = this.prepareContentDetails();\n\t\t}\n\n\t\tcontent.appendChild(header);\n\t\tcontent.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail\" },\n\t\t\t\t\tchildren: contentChildren\n\t\t\t\t})\n\t\t);\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontent.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-content\" }, children: [ content ] })\n\t\t);\n\n\t\treturn wrapper;\n\t}\n\n\tpreparePaidPaymentContent()\n\t{\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: 'crm-entity-stream-section'}});\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: 'crm-entity-stream-section-icon crm-entity-stream-section-icon-wallet' } })\n\t\t);\n\n\t\tconst header = [\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-event-title\"},\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattrs: {href: \"#\"},\n\t\t\t\t\t\t\t\t\tevents: {click: this._headerClickHandler},\n\t\t\t\t\t\t\t\t\ttext: this.getMessage('orderPaymentSuccessTitle')\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t];\n\t\theader.push(\n\t\t\tBX.create(\"SPAN\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-event-time\" },\n\t\t\t\t\ttext: this.formatTime(this.getCreatedTime())\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst content = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\tconst headerWrap = BX.create(\"DIV\", {\n\t\t\tattrs: {className: \"crm-entity-stream-content-header\"},\n\t\t\tchildren: header\n\t\t});\n\n\t\tconst contentChildren = this.preparePaidPaymentContentDetails();\n\t\tcontent.appendChild(headerWrap);\n\t\tcontent.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail\" },\n\t\t\t\t\tchildren: contentChildren\n\t\t\t\t})\n\t\t);\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontent.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-content\" }, children: [ content ] })\n\t\t);\n\n\t\treturn wrapper;\n\t}\n\n\tprepareErrorPaymentContentDetails()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData(),\n\t\t\tdate = BX.prop.getString(entityData, 'DATE', ''),\n\t\t\tfields = this.getObjectDataParam('FIELDS'),\n\t\t\tpaySystemName = BX.prop.getString(fields, 'PAY_SYSTEM_NAME', ''),\n\t\t\tpaySystemError = BX.prop.getString(fields, 'STATUS_DESCRIPTION', ''),\n\t\t\tnodes = [];\n\n\t\tconst descriptionNode = BX.create('DIV', {\n\t\t\tattrs: {className: 'crm-entity-stream-content-detail-description'},\n\t\t\tchildren: [\n\t\t\t\tBX.create('SPAN', {\n\t\t\t\t\ttext: date\n\t\t\t\t}),\n\t\t\t\tBX.create('SPAN', {\n\t\t\t\t\tattrs: {className: 'crm-entity-stream-content-detail-description-info'},\n\t\t\t\t\ttext: this.getMessage('orderPaySystemTitle')\n\t\t\t\t}),\n\t\t\t\tBX.create('SPAN', {\n\t\t\t\t\ttext: paySystemName\n\t\t\t\t}),\n\t\t\t]\n\t\t});\n\t\tnodes.push(descriptionNode);\n\n\t\tconst errorDetailNode = BX.create('DIV', {\n\t\t\tattrs: {className: 'crm-entity-stream-content-event-payment-initiate-pay-error'},\n\t\t\ttext: this.getMessage('orderPaymentStatusErrorReason').replace(\"#PAYSYSTEM_ERROR#\", paySystemError),\n\t\t});\n\n\t\tnodes.push(errorDetailNode);\n\n\t\treturn nodes;\n\t}\n\n\tprepareClickedPaymentContent()\n\t{\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: 'crm-entity-stream-section crm-entity-stream-section-history'}});\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: 'crm-entity-stream-section-icon ' + this.getIconClassName() } })\n\t\t);\n\n\t\tconst header = [\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-event-title\"},\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattrs: {href: \"#\"},\n\t\t\t\t\t\t\t\t\tevents: {click: this._headerClickHandler},\n\t\t\t\t\t\t\t\t\ttext: this.getTitle(),\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t];\n\t\theader.push(\n\t\t\tBX.create(\"SPAN\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-event-time\" },\n\t\t\t\t\ttext: this.formatTime(this.getCreatedTime())\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst content = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\tconst headerWrap = BX.create(\"DIV\", {\n\t\t\tattrs: {className: \"crm-entity-stream-content-header\"},\n\t\t\tchildren: header\n\t\t});\n\n\t\tconst contentChildren = this.prepareClickedPaymentContentDetails();\n\t\tcontent.appendChild(headerWrap);\n\t\tcontent.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail\" },\n\t\t\t\t\tchildren: contentChildren\n\t\t\t\t})\n\t\t);\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontent.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-content\" }, children: [ content ] })\n\t\t);\n\n\t\treturn wrapper;\n\t}\n\n\tprepareClickedPaymentContentDetails()\n\t{\n\t\tconst fields = this.getObjectDataParam('FIELDS'),\n\t\t\tpaySystemName = BX.prop.getString(fields, 'PAY_SYSTEM_NAME', ''),\n\t\t\tnodes = [];\n\n\t\tif(paySystemName !== '')\n\t\t{\n\t\t\tconst descriptionNode = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-detail-description\"}});\n\t\t\tdescriptionNode.appendChild(\n\t\t\t\tBX.create('SPAN', {\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-clicked-description-info\" },\n\t\t\t\t\ttext: this.getMessage('orderPaymentPaySystemClick')\n\t\t\t\t})\n\t\t\t);\n\t\t\tdescriptionNode.appendChild(\n\t\t\t\tBX.create('SPAN', {\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-clicked-description-name\" },\n\t\t\t\t\ttext: paySystemName\n\t\t\t\t})\n\t\t\t);\n\n\t\t\tnodes.push(descriptionNode);\n\t\t}\n\n\t\treturn nodes;\n\t}\n\n\tprepareManualContinuePayContent()\n\t{\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: 'crm-entity-stream-section crm-entity-stream-section-history crm-entity-stream-section-advice'}});\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", {\n\t\t\t\tattrs: { className: 'crm-entity-stream-section-icon crm-entity-stream-section-icon-advice' },\n\t\t\t\tchildren: [BX.create('i')],\n\t\t\t})\n\t\t);\n\n\t\tconst content = BX.create(\"DIV\", {\n\t\t\tattrs: {className: \"crm-entity-stream-advice-info\"},\n\t\t\ttext: this.getMessage('orderManualContinuePay'),\n\t\t});\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-advice-content\" }, children: [ content ] })\n\t\t);\n\n\t\treturn wrapper;\n\t}\n\n\tprepareManualAddCheck()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst showUrl = BX.prop.getString(entityData, \"SHOW_URL\", \"\");\n\n\t\tconst wrapper = BX.create(\n\t\t\t\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {\n\t\t\t\t\tclassName: 'crm-entity-stream-section crm-entity-stream-section-history crm-entity-stream-section-advice'\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t\twrapper.appendChild(\n\t\t\tBX.create(\n\t\t\t\t\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\tclassName: 'crm-entity-stream-section-icon crm-entity-stream-section-icon-advice'\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst htmlTitle = this.getMessage('orderManualAddCheck').replace(\"#HREF#\", showUrl);\n\t\tconst content = BX.create(\n\t\t\t\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {\n\t\t\t\t\tclassName: \"crm-entity-stream-advice-info\",\n\t\t\t\t},\n\t\t\t\thtml: htmlTitle,\n\t\t\t}\n\t\t);\n\n\t\tconst link = BX.create(\n\t\t\t\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {\n\t\t\t\t\tclassName: \"crm-entity-stream-advice-info\",\n\t\t\t\t},\n\t\t\t\tchildren: [\n\t\t\t\t\tBX.create(\n\t\t\t\t\t\t\"A\",\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\t\tclassName: \"crm-entity-stream-content-detail-target\",\n\t\t\t\t\t\t\t\thref: \"#\",\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\t\tclick: BX.delegate(function (e) {\n\t\t\t\t\t\t\t\t\ttop.BX.Helper.show('redirect=detail&code=13742126');\n\t\t\t\t\t\t\t\t\te.preventDefault ? e.preventDefault() : (e.returnValue = false);\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\thtml: this.getMessage('orderManualAddCheckHelpLink'),\n\t\t\t\t\t\t}\n\t\t\t\t\t)\n\t\t\t\t]\n\t\t\t}\n\t\t);\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\n\t\t\t\t\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\tclassName: \"crm-entity-stream-advice-content\"\n\t\t\t\t\t},\n\t\t\t\t\tchildren: [ content, link ]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\treturn wrapper;\n\t}\n\n\tgetIconClassName()\n\t{\n\t\treturn 'crm-entity-stream-section-icon-store';\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new OrderModification();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n\n\tstatic messages = {};\n}\n","import OrderModification from \"./order-modification\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class ExternalNoticeModification extends OrderModification\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetIconClassName()\n\t{\n\t\treturn 'crm-entity-stream-section-icon-restApp';\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new ExternalNoticeModification();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import ExternalNoticeModification from \"./external-notice-modification\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class ExternalNoticeStatusModification extends ExternalNoticeModification\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tprepareContentDetails()\n\t{\n\t\tconst nodes = [];\n\t\tconst contentChildren = [];\n\n\t\tif (BX.type.isNotEmptyString(this.getTextDataParam(\"START_NAME\")))\n\t\t{\n\t\t\tcontentChildren.push(\n\t\t\t\tBX.create(\"SPAN\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-detain-info-status\"},\n\t\t\t\t\t\ttext: this.getTextDataParam(\"START_NAME\")\n\t\t\t\t\t})\n\t\t\t);\n\t\t\tcontentChildren.push(\n\t\t\t\tBX.create(\"SPAN\",{ attrs: { className: \"crm-entity-stream-content-detail-info-separator-icon\" } })\n\t\t\t);\n\t\t}\n\n\t\tif (BX.type.isNotEmptyString(this.getTextDataParam(\"FINISH_NAME\")))\n\t\t{\n\t\t\tcontentChildren.push(\n\t\t\t\tBX.create(\"SPAN\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detain-info-status\" },\n\t\t\t\t\t\ttext: this.getTextDataParam(\"FINISH_NAME\")\n\t\t\t\t\t})\n\t\t\t);\n\t\t}\n\n\t\tnodes.push(BX.create(\"DIV\",\t{\n\t\t\tattrs: { className: \"crm-entity-stream-content-detail-info\" },\n\t\t\tchildren: contentChildren\n\t\t}));\n\n\t\treturn nodes;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new ExternalNoticeStatusModification();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import HistoryItem from \"./history\";\nimport {Item as ItemType} from \"../types\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Creation extends HistoryItem\n{\n\tstatic messages = {};\n\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Creation();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n\n\tdoInitialize()\n\t{\n\t\tsuper.doInitialize();\n\t\tif (!(this._activityEditor instanceof BX.CrmActivityEditor))\n\t\t{\n\t\t\tthrow \"Creation. The field 'activityEditor' is not assigned.\";\n\t\t}\n\t}\n\n\tgetTitle()\n\t{\n\t\tconst entityTypeId = this.getAssociatedEntityTypeId();\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tif (entityTypeId === BX.CrmEntityType.enumeration.activity)\n\t\t{\n\t\t\tconst typeId = BX.prop.getInteger(entityData, \"TYPE_ID\");\n\t\t\tconst title = this.getMessage(typeId === BX.CrmActivityType.task ? \"task\" : \"activity\");\n\t\t\treturn title.replace(/#TITLE#/gi, this.cutOffText(BX.prop.getString(entityData, \"SUBJECT\")), 64);\n\t\t}\n\n\t\tif (entityTypeId === BX.CrmEntityType.enumeration.storeDocument)\n\t\t{\n\t\t\tconst docType = BX.prop.getString(entityData, \"DOC_TYPE\");\n\t\t\tif (docType === 'A')\n\t\t\t{\n\t\t\t\treturn this.getMessage('arrivalDocument');\n\t\t\t}\n\t\t\tif (docType === 'S')\n\t\t\t{\n\t\t\t\treturn this.getMessage('storeAdjustmentDocument');\n\t\t\t}\n\t\t\tif (docType === 'M')\n\t\t\t{\n\t\t\t\treturn this.getMessage('movingDocument');\n\t\t\t}\n\t\t\tif (docType === 'D')\n\t\t\t{\n\t\t\t\treturn this.getMessage('deductDocument');\n\t\t\t}\n\t\t\tif (docType === 'W')\n\t\t\t{\n\t\t\t\treturn this.getMessage('shipmentDocument');\n\t\t\t}\n\n\t\t\treturn '';\n\t\t}\n\n\t\tconst entityTypeName = BX.CrmEntityType.resolveName(this.getAssociatedEntityTypeId()).toLowerCase();\n\t\tlet msg = this.getMessage(entityTypeName);\n\t\tconst isMessageNotFound = (msg === entityTypeName);\n\t\tif (!BX.type.isNotEmptyString(msg) || isMessageNotFound)\n\t\t{\n\t\t\tmsg = this.getTextDataParam(\"TITLE\");\n\t\t}\n\n\t\treturn msg;\n\t}\n\n\tgetWrapperClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-createEntity\";\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst entityTypeId = this.getAssociatedEntityTypeId();\n\n\t\tif (\n\t\t\tentityTypeId === BX.CrmEntityType.enumeration.ordershipment\n\t\t\t|| entityTypeId === BX.CrmEntityType.enumeration.orderpayment\n\t\t)\n\t\t{\n\t\t\tconst data = this.getData();\n\t\t\tdata.TYPE_CATEGORY_ID = ItemType.modification;\n\t\t\tif (data.hasOwnProperty('ASSOCIATED_ENTITY'))\n\t\t\t{\n\t\t\t\tdata.ASSOCIATED_ENTITY.HTML_TITLE = '';\n\t\t\t}\n\n\t\t\tconst createOrderEntityItem = this._history.createOrderEntityItem(data);\n\t\t\treturn createOrderEntityItem.prepareContent();\n\t\t}\n\n\t\treturn super.prepareContent();\n\t}\n\n\tprepareContentDetails()\n\t{\n\t\tconst entityTypeId = this.getAssociatedEntityTypeId();\n\t\tconst entityId = this.getAssociatedEntityId();\n\t\tconst entityData = this.getAssociatedEntityData();\n\n\t\tif (entityTypeId === BX.CrmEntityType.enumeration.activity)\n\t\t{\n\t\t\tconst link = BX.create(\"A\",\n\t\t\t\t{\n\t\t\t\t\tattrs: {href: \"#\"},\n\t\t\t\t\thtml: this.cutOffText(BX.prop.getString(entityData, \"DESCRIPTION_RAW\"), 128)\n\t\t\t\t}\n\t\t\t);\n\t\t\tBX.bind(link, \"click\", this._headerClickHandler);\n\n\t\t\treturn [link];\n\t\t}\n\n\t\tconst title = BX.prop.getString(entityData, \"TITLE\", \"\");\n\t\tlet htmlTitle = BX.prop.getString(entityData, \"HTML_TITLE\", \"\");\n\t\tconst showUrl = BX.prop.getString(entityData, \"SHOW_URL\", \"\");\n\n\t\tif (\n\t\t\tentityTypeId === BX.CrmEntityType.enumeration.deal\n\t\t\t&& BX.prop.getObject(entityData, \"ORDER\", null)\n\t\t)\n\t\t{\n\t\t\tconst orderData = BX.prop.getObject(entityData, \"ORDER\", null);\n\t\t\thtmlTitle = this.getMessage('dealOrderTitle')\n\t\t\t\t.replace(\"#ORDER_ID#\", orderData.ID)\n\t\t\t\t.replace(\"#DATE_TIME#\", orderData.ORDER_DATE)\n\t\t\t\t.replace(\"#HREF#\", orderData.SHOW_URL)\n\t\t\t\t.replace(\"#PRICE_WITH_CURRENCY#\", orderData.SUM)\n\t\t\t;\n\t\t}\n\n\t\tif (title !== \"\" || htmlTitle !== \"\")\n\t\t{\n\t\t\tconst nodes = [];\n\t\t\tif (showUrl === \"\" || (entityTypeId === this.getOwnerTypeId() && entityId === this.getOwnerId()))\n\t\t\t{\n\t\t\t\tconst spanAttrs = (htmlTitle !== \"\") ? {html: htmlTitle} : {text: title};\n\t\t\t\tnodes.push(BX.create(\"SPAN\", spanAttrs));\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tlet linkAttrs = {attrs: {href: showUrl}, text: title};\n\t\t\t\tif (htmlTitle !== \"\")\n\t\t\t\t{\n\t\t\t\t\tlinkAttrs = {attrs: {href: showUrl}, html: htmlTitle};\n\t\t\t\t}\n\t\t\t\tnodes.push(BX.create(\"A\", linkAttrs));\n\t\t\t}\n\n\t\t\tconst legend = this.getTextDataParam(\"LEGEND\");\n\t\t\tif (legend !== \"\")\n\t\t\t{\n\t\t\t\tnodes.push(BX.create(\"BR\"));\n\t\t\t\tnodes.push(BX.create(\"SPAN\", {text: legend}));\n\t\t\t}\n\n\t\t\tconst baseEntityData = this.getObjectDataParam(\"BASE\");\n\t\t\tconst baseEntityInfo = BX.prop.getObject(baseEntityData, \"ENTITY_INFO\");\n\t\t\tif (baseEntityInfo)\n\t\t\t{\n\t\t\t\tnodes.push(BX.create(\"BR\"));\n\t\t\t\tnodes.push(BX.create(\"SPAN\", {text: BX.prop.getString(baseEntityData, \"CAPTION\") + \": \"}));\n\t\t\t\tnodes.push(\n\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tattrs: {href: BX.prop.getString(baseEntityInfo, \"SHOW_URL\", \"#\")},\n\t\t\t\t\t\t\ttext: BX.prop.getString(baseEntityInfo, \"TITLE\", \"\")\n\t\t\t\t\t\t}\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\t\t\treturn nodes;\n\t\t}\n\t\treturn [];\n\t}\n\n\tview()\n\t{\n\t\tconst entityTypeId = this.getAssociatedEntityTypeId();\n\t\tif (entityTypeId === BX.CrmEntityType.enumeration.activity)\n\t\t{\n\t\t\tconst entityData = this.getAssociatedEntityData();\n\t\t\tconst id = BX.prop.getInteger(entityData, \"ID\", 0);\n\t\t\tif (id > 0)\n\t\t\t{\n\t\t\t\tthis._activityEditor.viewActivity(id);\n\t\t\t}\n\t\t}\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = Creation.messages;\n\n\t\treturn m.hasOwnProperty(name) ? m[name] : name;\n\t}\n}\n","import History from \"./history\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Restoration extends History\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetTitle()\n\t{\n\t\treturn this.getTextDataParam(\"TITLE\");\n\t}\n\n\tgetWrapperClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-restoreEntity\";\n\t}\n\n\tprepareContentDetails()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst title = BX.prop.getString(entityData, \"TITLE\");\n\t\treturn title !== \"\" ?  [ BX.create(\"SPAN\", { text: title }) ] : [];\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = Restoration.messages;\n\t\treturn m.hasOwnProperty(name) ? m[name] : name;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Restoration();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n\n\tstatic messages = {};\n}\n","import History from \"./history\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Relation extends History\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetTitle()\n\t{\n\t\treturn this.getMessage('title');\n\t}\n\n\tgetWrapperClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-createEntity\";\n\t}\n\n\tprepareContentDetails()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\n\t\tlet link = BX.prop.getString(entityData, \"SHOW_URL\", \"\");\n\t\tif (link.indexOf('/') !== 0)\n\t\t{\n\t\t\tlink = '#';\n\t\t}\n\n\t\tconst content =\n\t\t\tthis.getMessage('contentTemplate')\n\t\t\t\t.replace('#ENTITY_TYPE_CAPTION#', BX.Text.encode(BX.prop.getString(entityData, 'ENTITY_TYPE_CAPTION', '')))\n\t\t\t\t.replace('#LEGEND#', '')\n\t\t\t\t.replace('#LINK#', BX.Text.encode(link))\n\t\t\t\t.replace('#LINK_TITLE#', BX.Text.encode(BX.prop.getString(entityData, \"TITLE\", '')))\n\t\t;\n\n\t\tconst nodes = [];\n\t\tnodes.push(\n\t\t\tBX.create('SPAN', { html: content })\n\t\t);\n\n\t\treturn nodes;\n\t}\n}\n","import Relation from \"./relation\"\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Link extends Relation\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetIconClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-icon crm-entity-stream-section-icon-link\";\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = Link.messages;\n\t\treturn m.hasOwnProperty(name) ? m[name] : name;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Link();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n\n\tstatic messages = {};\n}\n","import Relation from \"./relation\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Unlink extends Relation\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetIconClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-icon crm-entity-stream-section-icon-unlink\";\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = Unlink.messages;\n\t\treturn m.hasOwnProperty(name) ? m[name] : name;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Unlink();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n\n\tstatic messages = {};\n}\n","import History from \"./history\";\nimport {Mark as MarkType} from \"../types\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Mark extends History\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tdoInitialize()\n\t{\n\t\tsuper.doInitialize();\n\t\tif(!(this._activityEditor instanceof BX.CrmActivityEditor))\n\t\t{\n\t\t\tthrow \"Mark. The field 'activityEditor' is not assigned.\";\n\t\t}\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = Mark.messages;\n\t\tif (m.hasOwnProperty(name))\n\t\t{\n\t\t\treturn m[name];\n\t\t}\n\n\t\treturn super.getMessage(name);\n\t}\n\n\tgetTitle()\n\t{\n\t\tlet title = \"\";\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst associatedEntityTypeId = this.getAssociatedEntityTypeId();\n\t\tconst typeCategoryId = this.getTypeCategoryId();\n\t\tif(associatedEntityTypeId === BX.CrmEntityType.enumeration.activity)\n\t\t{\n\t\t\tconst entityTypeId = BX.prop.getInteger(entityData, \"TYPE_ID\", 0);\n\t\t\tconst direction = BX.prop.getInteger(entityData, \"DIRECTION\", 0);\n\t\t\tconst activityProviderId = BX.prop.getString(entityData, \"PROVIDER_ID\", '');\n\n\t\t\tif(entityTypeId === BX.CrmActivityType.email)\n\t\t\t{\n\t\t\t\tif(typeCategoryId === MarkType.success)\n\t\t\t\t{\n\t\t\t\t\ttitle = this.getMessage(\n\t\t\t\t\t\t(direction === BX.CrmActivityDirection.incoming ? \"incomingEmail\" : \"outgoingEmail\") +\n\t\t\t\t\t\t\"SuccessMark\"\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\telse if(typeCategoryId === MarkType.renew)\n\t\t\t\t{\n\t\t\t\t\ttitle = this.getMessage(\n\t\t\t\t\t\t(direction === BX.CrmActivityDirection.incoming ? \"incomingEmail\" : \"outgoingEmail\") +\n\t\t\t\t\t\t\"RenewMark\"\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if(entityTypeId === BX.CrmActivityType.call)\n\t\t\t{\n\t\t\t\tif(typeCategoryId === MarkType.success)\n\t\t\t\t{\n\t\t\t\t\ttitle = this.getMessage(\n\t\t\t\t\t\t(direction === BX.CrmActivityDirection.incoming ? \"incomingCall\" : \"outgoingCall\") +\n\t\t\t\t\t\t\"SuccessMark\"\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\telse if(typeCategoryId === MarkType.renew)\n\t\t\t\t{\n\t\t\t\t\ttitle = this.getMessage(\n\t\t\t\t\t\t(direction === BX.CrmActivityDirection.incoming ? \"incomingCall\" : \"outgoingCall\") +\n\t\t\t\t\t\t\"RenewMark\"\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if(entityTypeId === BX.CrmActivityType.meeting)\n\t\t\t{\n\t\t\t\tif(typeCategoryId === MarkType.success)\n\t\t\t\t{\n\t\t\t\t\ttitle = this.getMessage(\"meetingSuccessMark\");\n\t\t\t\t}\n\t\t\t\telse if(typeCategoryId === MarkType.renew)\n\t\t\t\t{\n\t\t\t\t\ttitle = this.getMessage(\"meetingRenewMark\");\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if(entityTypeId === BX.CrmActivityType.task)\n\t\t\t{\n\t\t\t\tif(typeCategoryId === MarkType.success)\n\t\t\t\t{\n\t\t\t\t\ttitle = this.getMessage(\"taskSuccessMark\");\n\t\t\t\t}\n\t\t\t\telse if(typeCategoryId === MarkType.renew)\n\t\t\t\t{\n\t\t\t\t\ttitle = this.getMessage(\"taskRenewMark\");\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if(entityTypeId === BX.CrmActivityType.provider)\n\t\t\t{\n\t\t\t\tif (activityProviderId === 'CRM_REQUEST')\n\t\t\t\t{\n\t\t\t\t\tif(typeCategoryId === MarkType.success)\n\t\t\t\t\t{\n\t\t\t\t\t\ttitle = this.getMessage(\"requestSuccessMark\");\n\t\t\t\t\t}\n\t\t\t\t\telse if(typeCategoryId === MarkType.renew)\n\t\t\t\t\t{\n\t\t\t\t\t\ttitle = this.getMessage(\"requestRenewMark\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if(typeCategoryId === MarkType.success)\n\t\t\t\t{\n\t\t\t\t\ttitle = this.getMessage(\"webformSuccessMark\");\n\t\t\t\t}\n\t\t\t\telse if(typeCategoryId === MarkType.renew)\n\t\t\t\t{\n\t\t\t\t\ttitle = this.getMessage(\"webformRenewMark\");\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse if(associatedEntityTypeId === BX.CrmEntityType.enumeration.deal)\n\t\t{\n\t\t\tif(typeCategoryId === MarkType.success)\n\t\t\t{\n\t\t\t\ttitle = this.getMessage(\"dealSuccessMark\");\n\t\t\t}\n\t\t\telse if(typeCategoryId === MarkType.failed)\n\t\t\t{\n\t\t\t\ttitle = this.getMessage(\"dealFailedMark\");\n\t\t\t}\n\t\t}\n\t\telse if(associatedEntityTypeId === BX.CrmEntityType.enumeration.order)\n\t\t{\n\t\t\tif(typeCategoryId === MarkType.success)\n\t\t\t{\n\t\t\t\ttitle = this.getMessage(\"orderSuccessMark\");\n\t\t\t}\n\t\t\telse if(typeCategoryId === MarkType.failed)\n\t\t\t{\n\t\t\t\ttitle = this.getMessage(\"orderFailedMark\");\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (BX.CrmEntityType.isDefined(associatedEntityTypeId))\n\t\t\t{\n\t\t\t\tif (typeCategoryId === MarkType.success)\n\t\t\t\t{\n\t\t\t\t\ttitle = this.getMessage('entitySuccessMark');\n\t\t\t\t}\n\t\t\t\telse if (typeCategoryId === MarkType.failed)\n\t\t\t\t{\n\t\t\t\t\ttitle = this.getMessage('entityFailedMark');\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn title;\n\t}\n\n\tprepareTitleLayout()\n\t{\n\t\tconst associatedEntityTypeId = this.getAssociatedEntityTypeId();\n\n\t\tif(associatedEntityTypeId === BX.CrmEntityType.enumeration.order)\n\t\t{\n\t\t\treturn BX.create(\"SPAN\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-event-title\" },\n\t\t\t\t\ttext: this.getTitle()\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn BX.create(\"A\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { href: \"#\", className: \"crm-entity-stream-content-event-title\" },\n\t\t\t\t\tevents: { \"click\": this._headerClickHandler },\n\t\t\t\t\ttext: this.getTitle()\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst associatedEntityTypeId = this.getAssociatedEntityTypeId();\n\n\t\tconst wrapper = BX.create(\n\t\t\t\"DIV\",\n\t\t\t{attrs: {className: \"crm-entity-stream-section crm-entity-stream-section-completed\"}}\n\t\t);\n\n\t\tif (this.isFixed())\n\t\t\tBX.addClass(wrapper, 'crm-entity-stream-section-top-fixed');\n\n\t\t//region Context Menu\n\t\tif(this.isContextMenuEnabled())\n\t\t{\n\t\t\twrapper.appendChild(this.prepareContextMenuButton());\n\t\t}\n\t\t//endregion\n\n\t\tconst content = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\tconst header = this.prepareHeaderLayout();\n\t\tif(associatedEntityTypeId === BX.CrmEntityType.enumeration.activity)\n\t\t{\n\t\t\tconst entityTypeId = BX.prop.getInteger(entityData, \"TYPE_ID\", 0);\n\t\t\tlet iconClassName = \"crm-entity-stream-section-icon\";\n\t\t\tif(entityTypeId === BX.CrmActivityType.email)\n\t\t\t{\n\t\t\t\ticonClassName += \" crm-entity-stream-section-icon-email\";\n\t\t\t}\n\t\t\telse if(entityTypeId === BX.CrmActivityType.call)\n\t\t\t{\n\t\t\t\ticonClassName += \" crm-entity-stream-section-icon-call\";\n\t\t\t}\n\t\t\telse if(entityTypeId === BX.CrmActivityType.meeting)\n\t\t\t{\n\t\t\t\ticonClassName += \" crm-entity-stream-section-icon-meeting\";\n\t\t\t}\n\t\t\telse if(entityTypeId === BX.CrmActivityType.task)\n\t\t\t{\n\t\t\t\ticonClassName += \" crm-entity-stream-section-icon-task\";\n\t\t\t}\n\t\t\telse if(entityTypeId === BX.CrmActivityType.provider)\n\t\t\t{\n\t\t\t\tconst providerId = BX.prop.getString(entityData, \"PROVIDER_ID\", \"\");\n\t\t\t\tif(providerId === \"CRM_WEBFORM\")\n\t\t\t\t{\n\t\t\t\t\ticonClassName += \" crm-entity-stream-section-icon-crmForm\";\n\t\t\t\t}\n\t\t\t}\n\n\t\t\twrapper.appendChild(BX.create(\"DIV\", { attrs: { className: iconClassName } }));\n\t\t\tcontent.appendChild(header);\n\n\n\t\t\tconst detailWrapper = BX.create(\"DIV\",\n\t\t\t\t{attrs: {className: \"crm-entity-stream-content-detail\"}}\n\t\t\t);\n\t\t\tcontent.appendChild(detailWrapper);\n\n\t\t\tdetailWrapper.appendChild(\n\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-title\" },\n\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tattrs: { href: \"#\" },\n\t\t\t\t\t\t\t\t\t\tevents: { \"click\": this._headerClickHandler },\n\t\t\t\t\t\t\t\t\t\ttext: this.cutOffText(BX.prop.getString(entityData, \"SUBJECT\", \"\"), 128)\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t);\n\n\t\t\tconst summary = this.getTextDataParam(\"SUMMARY\");\n\t\t\tif(summary !== \"\")\n\t\t\t{\n\t\t\t\tdetailWrapper.appendChild(\n\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-description\" },\n\t\t\t\t\t\t\ttext: summary\n\t\t\t\t\t\t}\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t\telse if(associatedEntityTypeId === BX.CrmEntityType.enumeration.order)\n\t\t{\n\t\t\twrapper.appendChild(BX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-info\" } }));\n\t\t\tcontent.appendChild(header);\n\t\t\tcontent.appendChild(\n\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail\" },\n\t\t\t\t\t\ttext: this.cutOffText(this.getTextDataParam(\"MESSAGE\"), 128)\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\t\telse\n\t\t{\n\t\t\twrapper.appendChild(BX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-info\" } }));\n\t\t\tcontent.appendChild(header);\n\n\t\t\tconst innerWrapper = BX.create(\n\t\t\t\t\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail\"}\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tconst associatedEntityTitle = this.cutOffText(BX.prop.getString(entityData, \"TITLE\", \"\"), 128);\n\n\t\t\tif (BX.CrmEntityType.isDefined(associatedEntityTypeId))\n\t\t\t{\n\t\t\t\tlet link = BX.prop.getString(entityData, 'SHOW_URL', '');\n\t\t\t\tif (link.indexOf('/') !== 0)\n\t\t\t\t{\n\t\t\t\t\tlink = '#';\n\t\t\t\t}\n\n\t\t\t\tconst contentTemplate =\n\t\t\t\t\tthis.getMessage('entityContentTemplate')\n\t\t\t\t\t\t.replace('#ENTITY_TYPE_CAPTION#', BX.Text.encode(BX.prop.getString(entityData, 'ENTITY_TYPE_CAPTION', '')))\n\t\t\t\t\t\t.replace('#LINK#', BX.Text.encode(link))\n\t\t\t\t\t\t.replace('#LINK_TITLE#', BX.Text.encode(associatedEntityTitle))\n\t\t\t\t;\n\n\t\t\t\tinnerWrapper.appendChild(\n\t\t\t\t\tBX.create(\n\t\t\t\t\t\t'SPAN',\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\thtml: contentTemplate\n\t\t\t\t\t\t}\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tinnerWrapper.innerText = associatedEntityTitle;\n\t\t\t}\n\n\t\t\tcontent.appendChild(innerWrapper);\n\t\t}\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontent.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-content\" }, children: [ content ] })\n\t\t);\n\n\t\tif (!this.isReadOnly())\n\t\t\twrapper.appendChild(this.prepareFixedSwitcherLayout());\n\n\t\treturn wrapper;\n\t}\n\n\tprepareContextMenuItems()\n\t{\n\t\tconst menuItems = [];\n\n\t\tif (!this.isReadOnly())\n\t\t{\n\t\t\tif (this.isFixed() || this._fixedHistory.findItemById(this._id))\n\t\t\t\tmenuItems.push({ id: \"unfasten\", text: this.getMessage(\"menuUnfasten\"), onclick: BX.delegate(this.unfasten, this)});\n\t\t\telse\n\t\t\t\tmenuItems.push({ id: \"fasten\", text: this.getMessage(\"menuFasten\"), onclick: BX.delegate(this.fasten, this)});\n\t\t}\n\n\t\treturn menuItems;\n\t}\n\n\tview()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst associatedEntityTypeId = this.getAssociatedEntityTypeId();\n\t\tif(associatedEntityTypeId === BX.CrmEntityType.enumeration.activity)\n\t\t{\n\t\t\tconst id = BX.prop.getInteger(entityData, \"ID\", 0);\n\t\t\tif(id > 0)\n\t\t\t{\n\t\t\t\tthis._activityEditor.viewActivity(id);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst showUrl = BX.prop.getString(entityData, \"SHOW_URL\", \"\");\n\t\t\tif(showUrl !== \"\")\n\t\t\t{\n\t\t\t\tBX.Crm.Page.open(showUrl);\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Mark();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n\n\tstatic messages = {};\n}\n","import History from \"./history\";\nimport {EditorMode} from \"../types\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Comment extends History\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._isCollapsed = false;\n\t\tthis._isMenuShown = false;\n\t\tthis._isFixed = false;\n\t\tthis._hasFiles = false;\n\t\tthis._postForm = null;\n\t\tthis._editor = null;\n\t\tthis._commentMessage = '';\n\t\tthis._mode = EditorMode.view;\n\t\tthis._streamContentEventBlock = '';\n\t\tthis._playerWrappers = {};\n\t\tBX.Event.EventEmitter.subscribe(\n\t\t\t\"BX.Disk.Files:onShowFiles\",\n\t\t\tBX.delegate(this.addPlayer, this)\n\t\t);\n\t}\n\n\tdoInitialize()\n\t{\n\t\tsuper.doInitialize();\n\t\tthis._hasFiles = (this.getTextDataParam(\"HAS_FILES\") === 'Y');\n\t}\n\n\tgetTitle()\n\t{\n\t\treturn this.getMessage(\"comment\");\n\t}\n\n\tonPlayerDummyClick(file)\n\t{\n\t\tconst playerWrapper = this._playerWrappers[file.id];\n\t\tconst stubNode = playerWrapper.querySelector(\".crm-audio-cap-wrap\");\n\t\tif (stubNode)\n\t\t{\n\t\t\tBX.addClass(stubNode, \"crm-audio-cap-wrap-loader\");\n\t\t}\n\t\tthis._history.getManager().getAudioPlaybackRateSelector().addPlayer(\n\t\t\tthis._history.getManager().loadMediaPlayer(\n\t\t\t\t\"history_\" + this.getId() + '_' + file.id,\n\t\t\t\tfile.url,\n\t\t\t\t'audio/mp3',\n\t\t\t\tplayerWrapper,\n\t\t\t\tnull,\n\t\t\t\t{\n\t\t\t\t\tplaybackRate: this._history.getManager().getAudioPlaybackRateSelector().getRate()\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t}\n\n\taddPlayer(event)\n\t{\n\t\tif (event.data.entityValueId === parseInt(this.getId(), 10))\n\t\t{\n\t\t\tthis.files = event.data.files;\n\t\t\tevent.data.files.forEach(function(file){\n\t\t\t\tif (file.extension === 'mp3')\n\t\t\t\t{\n\t\t\t\t\tif (this._playerWrappers[file.id])\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tconst callInfoWrapper = BX.create(\"DIV\",\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\t\tclassName: \"crm-entity-stream-content-detail-call crm-entity-stream-content-detail-call-inline\"\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t\tthis._streamContentEventBlock.appendChild(callInfoWrapper);\n\t\t\t\t\tthis._playerWrappers[file.id] = this._history.getManager().renderAudioDummy(\n\t\t\t\t\t\tnull,\n\t\t\t\t\t\tthis.onPlayerDummyClick.bind(this, file)\n\t\t\t\t\t);\n\n\t\t\t\t\tthis._playerWrappers[file.id].firstElementChild.classList.add(\"crm-audio-cap-wrap-without-duration-text\");\n\n\t\t\t\t\tcallInfoWrapper.appendChild(\n\t\t\t\t\t\tthis._playerWrappers[file.id]\n\t\t\t\t\t);\n\t\t\t\t\tcallInfoWrapper.appendChild(\n\t\t\t\t\t\tthis._history.getManager().getAudioPlaybackRateSelector().render()\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}.bind(this));\n\t\t}\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst wrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-section crm-entity-stream-section-history crm-entity-stream-section-comment\"}\n\t\t\t}\n\t\t);\n\n\t\tif (this.isReadOnly())\n\t\t{\n\t\t\tBX.addClass(wrapper, \"crm-entity-stream-section-comment-read-only\");\n\t\t}\n\n\t\tif (this.isFixed())\n\t\t\tBX.addClass(wrapper, 'crm-entity-stream-section-top-fixed');\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{ attrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-comment\" } }\n\t\t\t)\n\t\t);\n\n\t\t//region Context Menu\n\t\tif(this.isContextMenuEnabled())\n\t\t{\n\t\t\twrapper.appendChild(this.prepareContextMenuButton());\n\t\t}\n\t\t//endregion\n\n\t\tthis._streamContentEventBlock = BX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-content-event\" } });\n\t\tconst header = this.prepareHeaderLayout();\n\n\t\tthis._streamContentEventBlock.appendChild(header);\n\n\t\tif (!this.isReadOnly())\n\t\t\twrapper.appendChild(this.prepareFixedSwitcherLayout());\n\n\t\tconst detailChildren = [];\n\t\tif (this._mode !== EditorMode.edit)\n\t\t{\n\t\t\tthis._commentWrapper = BX.create(\"DIV\", {\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-description\" }\n\t\t\t\t}\n\t\t\t);\n\t\t\tBX.html(this._commentWrapper, this.getTextDataParam(\"COMMENT\", \"\"));\n\t\t\tdetailChildren.push(this._commentWrapper);\n\n\t\t\tif (!this.isReadOnly())\n\t\t\t{\n\t\t\t\tBX.bind(this._commentWrapper, \"click\", BX.delegate(this.switchToEditMode, this));\n\t\t\t\tBX.bind(header, \"click\", BX.delegate(this.switchToEditMode, this));\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (!BX.type.isDomNode(this._editorContainer))\n\t\t\t\tthis._editorContainer = BX.create(\"div\", {attrs: {className: \"crm-entity-stream-section-comment-editor\"}});\n\n\t\t\tdetailChildren.push(this._editorContainer);\n\n\t\t\tconst buttons = BX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail-comment-edit-btn-container\"},\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"button\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattrs: {className: \"ui-btn ui-btn-xs ui-btn-primary\"},\n\t\t\t\t\t\t\t\t\thtml: this.getMessage(\"send\"),\n\t\t\t\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\t\t\t\tclick: BX.delegate(this.save, this)\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\tBX.create(\"a\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattrs: {className: \"ui-btn ui-btn-xs ui-btn-link\"},\n\t\t\t\t\t\t\t\t\thtml: this.getMessage(\"cancel\"),\n\t\t\t\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\t\t\t\tclick: BX.delegate(this.switchToViewMode, this)\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tdetailChildren.push(buttons);\n\t\t}\n\n\t\tthis._streamContentEventBlock.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail\" },\n\t\t\t\t\tchildren: detailChildren\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tthis._streamContentEventBlock.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\t\tconst cleanText = this.getTextDataParam(\"TEXT\", \"\");\n\t\tconst _hasInlineAttachment = (this.getTextDataParam(\"HAS_INLINE_ATTACHMENT\", \"\") === 'Y');\n\t\tif ((cleanText.length <= 128 && !_hasInlineAttachment) || this._mode === EditorMode.edit)\n\t\t{\n\t\t\tthis._isCollapsed = false;\n\n\t\t\twrapper.appendChild(\n\t\t\t\tBX.create(\"DIV\", {\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\tclassName: \"crm-entity-stream-section-content\"\n\t\t\t\t\t},\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tthis._streamContentEventBlock\n\t\t\t\t\t]\n\t\t\t\t})\n\t\t\t);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis._isCollapsed = true;\n\n\t\t\twrapper.appendChild(\n\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-content crm-entity-stream-section-content-collapsed\" },\n\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\tthis._streamContentEventBlock\n\t\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t);\n\n\t\t\twrapper.querySelector(\".crm-entity-stream-content-event\").appendChild(\n\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-content-expand-btn-container\" },\n\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tattrs:\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tclassName: \"crm-entity-stream-section-content-expand-btn\",\n\t\t\t\t\t\t\t\t\t\t\t\thref: \"#\"\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\tevents:\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tclick: BX.delegate(this.onExpandButtonClick, this)\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\ttext: this.getMessage(\"expand\")\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\n\t\tif (this._mode === EditorMode.view && this._hasFiles)\n\t\t{\n\t\t\tthis._textLoaded = false;\n\t\t\tthis._fileBlock = BX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-files-inner\" },\n\t\t\t\t\tchildren: [BX.create(\"DIV\", { attrs: { className: \"crm-timeline-wait\" }})]\n\t\t\t\t});\n\t\t\twrapper.querySelector(\".crm-entity-stream-section-content\").appendChild(\n\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-files\" },\n\t\t\t\t\t\tchildren: [this._fileBlock]\n\t\t\t\t\t})\n\t\t\t);\n\t\t\tBX.ready(BX.delegate(function() {\n\t\t\t\twindow.setTimeout(BX.delegate(function(){\n\t\t\t\t\tthis.loadContent(this._fileBlock, \"GET_FILE_BLOCK\")\n\t\t\t\t} ,this), 100);\n\t\t\t},this));\n\t\t}\n\n\t\treturn wrapper;\n\t}\n\n\tprepareActions()\n\t{\n\t\tif (this._mode === EditorMode.view && BX.type.isDomNode(this._commentWrapper))\n\t\t{\n\t\t\tthis.registerImages(this._commentWrapper);\n\t\t\tif (!BX.getClass('BX.Disk.apiVersion'))\n\t\t\t{\n\t\t\t\tBX.viewElementBind(\n\t\t\t\t\tthis._commentWrapper,\n\t\t\t\t\t{showTitle: true},\n\t\t\t\t\tfunction(node){\n\t\t\t\t\t\treturn BX.type.isElementNode(node) && (node.getAttribute('data-bx-viewer') || node.getAttribute('data-bx-image'));\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n\n\tloadContent(node, type)\n\t{\n\t\tif (!BX.type.isDomNode(node))\n\t\t\treturn;\n\n\t\tBX.ajax(\n\t\t\t{\n\t\t\t\turl: this._history._serviceUrl,\n\t\t\t\tmethod: \"POST\",\n\t\t\t\tdataType: \"json\",\n\t\t\t\tdata:\n\t\t\t\t\t{\n\t\t\t\t\t\t\"ACTION\": \"GET_COMMENT_CONTENT\",\n\t\t\t\t\t\t\"ID\": this.getId(),\n\t\t\t\t\t\t\"ENTITY_TYPE_ID\": this.getOwnerTypeId(),\n\t\t\t\t\t\t\"ENTITY_ID\": this.getOwnerId(),\n\t\t\t\t\t\t\"TYPE\": type\n\t\t\t\t\t},\n\t\t\t\tonsuccess: BX.delegate(function(result)\n\t\t\t\t{\n\t\t\t\t\tif (BX.type.isNotEmptyString(result.ERROR) && type === 'GET_FILE_BLOCK')\n\t\t\t\t\t{\n\t\t\t\t\t\tBX.remove(node);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (BX.type.isNotEmptyString(result.BLOCK))\n\t\t\t\t\t{\n\t\t\t\t\t\tconst promise = BX.html(node, result.BLOCK);\n\t\t\t\t\t\tpromise.then(\n\t\t\t\t\t\t\tBX.delegate(function(){\n\t\t\t\t\t\t\t\tthis.registerImages(node);\n\t\t\t\t\t\t\t\tBX.LazyLoad.showImages();\n\t\t\t\t\t\t\t}, this)\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}, this)\n\t\t\t}\n\t\t);\n\t}\n\n\tloadEditor()\n\t{\n\t\tthis._editorName = 'CrmTimeLineComment'+this._id + BX.util.getRandomString(4);\n\t\tif (this._postForm)\n\t\t{\n\t\t\tthis._postForm.oEditor.SetContent(this._commentMessage);\n\t\t\tthis._editor.ReInitIframe();\n\t\t\treturn;\n\t\t}\n\n\t\tconst actionData = {\n\t\t\tdata: {\n\t\t\t\tid: this._id,\n\t\t\t\tname: this._editorName\n\t\t\t}\n\t\t};\n\t\tBX.ajax.runAction(\"crm.api.timeline.loadEditor\", actionData)\n\t\t\t.then(this.onLoadEditorSuccess.bind(this))\n\t\t\t.catch(\tthis.switchToViewMode.bind(this));\n\t}\n\n\tonLoadEditorSuccess(result)\n\t{\n\t\tif (!BX.type.isDomNode(this._editorContainer))\n\t\t\tthis._editorContainer = BX.create(\"div\", {attrs: {className: \"crm-entity-stream-section-comment-editor\"}});\n\n\t\tconst html = BX.prop.getString(BX.prop.getObject(result, \"data\", {}), \"html\", '');\n\t\tBX.html(this._editorContainer, html).then(BX.delegate(this.showEditor,this));\n\t}\n\n\tshowEditor()\n\t{\n\t\tif (LHEPostForm)\n\t\t{\n\t\t\twindow.setTimeout(BX.delegate(function(){\n\t\t\t\tthis._postForm = LHEPostForm.getHandler(this._editorName);\n\t\t\t\tthis._editor = BXHtmlEditor.Get(this._editorName);\n\t\t\t\tBX.onCustomEvent(this._postForm.eventNode, 'OnShowLHE', [true]);\n\t\t\t\tthis._commentMessage = this._postForm.oEditor.GetContent();\n\t\t\t} ,this), 0);\n\t\t}\n\t}\n\n\tregisterImages(node)\n\t{\n\t\tconst commentImages = node.querySelectorAll('[data-bx-viewer=\"image\"]');\n\t\tconst commentImagesLength = commentImages.length;\n\t\tconst idsList = [];\n\t\tif (commentImagesLength > 0)\n\t\t{\n\t\t\tfor (let i = 0; i < commentImagesLength; ++i)\n\t\t\t{\n\t\t\t\tif (BX.type.isDomNode(commentImages[i]))\n\t\t\t\t{\n\t\t\t\t\tcommentImages[i].id += BX.util.getRandomString(4);\n\t\t\t\t\tidsList.push(commentImages[i].id);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (idsList.length > 0)\n\t\t\t{\n\t\t\t\tBX.LazyLoad.registerImages(idsList);\n\t\t\t}\n\t\t}\n\t\tBX.LazyLoad.registerImages(idsList);\n\t}\n\n\ttoggleMode(type)\n\t{\n\t\tthis._mode = parseInt(type);\n\t\tthis._hasFiles = (this.getTextDataParam(\"HAS_FILES\") === 'Y');\n\t\tthis.refreshLayout();\n\t\tthis.closeContextMenu();\n\t}\n\n\tswitchToViewMode(e)\n\t{\n\t\t// if (LHEPostForm)\n\t\t// \tLHEPostForm.unsetHandler(this._editorName);\n\t\tthis.toggleMode(EditorMode.view);\n\t}\n\n\tswitchToEditMode(e)\n\t{\n\t\tconst tagName = e.target.tagName.toLowerCase();\n\t\tif (tagName === 'a'\n\t\t\t|| tagName === 'img'\n\t\t\t|| BX.hasClass(e.target, \"feed-con-file-changes-link-more\")\n\t\t\t|| BX.hasClass(e.target, \"feed-com-file-inline\")\n\t\t\t|| BX.type.isNotEmptyString(document.getSelection().toString())\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.toggleMode(EditorMode.edit);\n\t\twindow.setTimeout(BX.delegate(function(){\n\t\t\tthis.loadEditor();\n\t\t} ,this), 100);\n\t}\n\n\tprepareContextMenuItems()\n\t{\n\t\tif(this._isMenuShown)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst menuItems = [];\n\n\t\tif (!this.isReadOnly())\n\t\t{\n\t\t\tif (this._mode !== EditorMode.edit)\n\t\t\t{\n\t\t\t\tmenuItems.push({ id: \"edit\", text: this.getMessage(\"menuEdit\"), onclick: BX.delegate(this.switchToEditMode, this)});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tmenuItems.push({ id: \"cancel\", text: this.getMessage(\"menuCancel\"), onclick: BX.delegate(this.switchToViewMode, this)});\n\t\t\t}\n\n\t\t\tmenuItems.push({ id: \"remove\", text: this.getMessage(\"menuDelete\"), onclick: BX.delegate(this.processRemoval, this)});\n\n\t\t\tif (this.isFixed() || this._fixedHistory.findItemById(this._id))\n\t\t\t\tmenuItems.push({ id: \"unfasten\", text: this.getMessage(\"menuUnfasten\"), onclick: BX.delegate(this.unfasten, this)});\n\t\t\telse\n\t\t\t\tmenuItems.push({ id: \"fasten\", text: this.getMessage(\"menuFasten\"), onclick: BX.delegate(this.fasten, this)});\n\t\t}\n\n\t\treturn menuItems;\n\t}\n\n\tsave(e)\n\t{\n\t\tconst attachmentList = [];\n\t\tlet text = \"\";\n\t\tif (this._postForm)\n\t\t{\n\t\t\ttext = this._postForm.oEditor.GetContent();\n\t\t\tthis._commentMessage = text;\n\t\t\tthis._postForm.eventNode\n\t\t\t\t.querySelectorAll('input[name=\"UF_CRM_COMMENT_FILES[]\"]')\n\t\t\t\t.forEach(function(input) {\n\t\t\t\t\tattachmentList.push(input.value)\n\t\t\t\t});\n\t\t}\n\n\t\tif (!BX.type.isNotEmptyString(text))\n\t\t{\n\t\t\tif (!this.emptyCommentMessage)\n\t\t\t{\n\t\t\t\tthis.emptyCommentMessage = new BX.PopupWindow(\n\t\t\t\t\t'timeline_empty_comment_' + this._id,\n\t\t\t\t\te.target,\n\t\t\t\t\t{\n\t\t\t\t\t\tcontent: BX.message('CRM_TIMELINE_EMPTY_COMMENT_MESSAGE'),\n\t\t\t\t\t\tdarkMode: true,\n\t\t\t\t\t\tautoHide: true,\n\t\t\t\t\t\tzIndex: 990,\n\t\t\t\t\t\tangle: {position: 'top', offset: 77},\n\t\t\t\t\t\tcloseByEsc: true,\n\t\t\t\t\t\tbindOptions: { forceBindPosition: true}\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tthis.emptyCommentMessage.show();\n\t\t\treturn;\n\t\t}\n\n\t\tif(this._isRequestRunning && BX.type.isNotEmptyString(text))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis._isRequestRunning = true;\n\t\tBX.ajax(\n\t\t\t{\n\t\t\t\turl: this._history._serviceUrl,\n\t\t\t\tmethod: \"POST\",\n\t\t\t\tdataType: \"json\",\n\t\t\t\tdata:\n\t\t\t\t\t{\n\t\t\t\t\t\t\"ACTION\": \"UPDATE_COMMENT\",\n\t\t\t\t\t\t\"ID\": this.getId(),\n\t\t\t\t\t\t\"TEXT\": text,\n\t\t\t\t\t\t\"OWNER_TYPE_ID\":  this.getOwnerTypeId(),\n\t\t\t\t\t\t\"OWNER_ID\": this.getOwnerId(),\n\t\t\t\t\t\t\"ATTACHMENTS\": attachmentList\n\t\t\t\t\t},\n\t\t\t\tonsuccess: BX.delegate(this.onSaveSuccess, this),\n\t\t\t\tonfailure: BX.delegate(this.onRequestFailure, this)\n\t\t\t}\n\t\t);\n\t}\n\n\tprocessRemoval()\n\t{\n\t\tthis.closeContextMenu();\n\t\tthis._detetionConfirmDlgId = \"entity_timeline_deletion_\" + this.getId() + \"_confirm\";\n\t\tlet dlg = BX.Crm.ConfirmationDialog.get(this._detetionConfirmDlgId);\n\t\tif(!dlg)\n\t\t{\n\t\t\tdlg = BX.Crm.ConfirmationDialog.create(\n\t\t\t\tthis._detetionConfirmDlgId,\n\t\t\t\t{\n\t\t\t\t\ttitle: this.getMessage(\"removeConfirmTitle\"),\n\t\t\t\t\tcontent: this.getMessage('commentRemove')\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\tdlg.open().then(BX.delegate(this.onRemovalConfirm, this), BX.delegate(this.onRemovalCancel, this));\n\t}\n\n\tonRemovalConfirm(result)\n\t{\n\t\tif(BX.prop.getBoolean(result, \"cancel\", true))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.remove();\n\t}\n\n\tonRemovalCancel()\n\t{\n\t}\n\n\tremove(e)\n\t{\n\t\tif(this._isRequestRunning)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst history = this._history._manager.getHistory();\n\t\tconst deleteItem = history.findItemById(this._id);\n\t\tif (deleteItem instanceof Comment)\n\t\t\tdeleteItem.clearAnimate();\n\n\t\tconst fixedHistory = this._history._manager.getFixedHistory();\n\t\tconst deleteFixedItem = fixedHistory.findItemById(this._id);\n\t\tif (deleteFixedItem instanceof Comment)\n\t\t\tdeleteFixedItem.clearAnimate();\n\n\t\tthis._isRequestRunning = true;\n\t\tBX.ajax(\n\t\t\t{\n\t\t\t\turl: this._history._serviceUrl,\n\t\t\t\tmethod: \"POST\",\n\t\t\t\tdataType: \"json\",\n\t\t\t\tdata:\n\t\t\t\t\t{\n\t\t\t\t\t\t\"ACTION\": \"DELETE_COMMENT\",\n\t\t\t\t\t\t\"OWNER_TYPE_ID\":  this.getOwnerTypeId(),\n\t\t\t\t\t\t\"OWNER_ID\": this.getOwnerId(),\n\t\t\t\t\t\t\"ID\": this.getId()\n\t\t\t\t\t},\n\t\t\t\tonsuccess: BX.delegate(this.onRemoveSuccess, this),\n\t\t\t\tonfailure: BX.delegate(this.onRequestFailure, this)\n\t\t\t}\n\t\t);\n\t}\n\n\trefreshLayout()\n\t{\n\t\tthis._playerWrappers = {};\n\t\tsuper.refreshLayout();\n\t}\n\n\tonSaveSuccess(data)\n\t{\n\t\tthis._isRequestRunning = false;\n\t\tconst itemData = BX.prop.getObject(data, \"HISTORY_ITEM\");\n\n\t\tconst updateFixedItem = this._fixedHistory.findItemById(this._id);\n\t\tif (updateFixedItem instanceof Comment)\n\t\t{\n\t\t\tif (!BX.type.isNotEmptyString(itemData['IS_FIXED']))\n\t\t\t\titemData['IS_FIXED'] = 'Y';\n\n\t\t\tupdateFixedItem.setData(itemData);\n\t\t\tupdateFixedItem._id = BX.prop.getString(itemData, \"ID\");\n\t\t\tupdateFixedItem.switchToViewMode();\n\t\t}\n\n\t\tconst updateItem = this._history.findItemById(this._id);\n\t\tif (updateItem instanceof Comment)\n\t\t{\n\t\t\tupdateItem.setData(itemData);\n\t\t\tupdateItem._id = BX.prop.getString(itemData, \"ID\");\n\t\t\tupdateItem.switchToViewMode();\n\t\t}\n\n\t\tthis._postForm = null;\n\t}\n\n\tonRemoveSuccess(data)\n\t{\n\t}\n\n\tonRequestFailure(data)\n\t{\n\t\tthis._isRequestRunning = this._isLocked = false;\n\t}\n\n\tonExpandButtonClick(e)\n\t{\n\t\tif(!this._wrapper)\n\t\t{\n\t\t\treturn BX.PreventDefault(e);\n\t\t}\n\n\t\tconst contentWrapper = this._wrapper.querySelector(\"div.crm-entity-stream-section-content\");\n\t\tif(!contentWrapper)\n\t\t{\n\t\t\treturn BX.PreventDefault(e);\n\t\t}\n\n\t\tif (this._hasFiles && BX.type.isDomNode(this._commentWrapper) && !this._textLoaded)\n\t\t{\n\t\t\tthis._textLoaded = true;\n\t\t\tthis.loadContent(this._commentWrapper, \"GET_TEXT\")\n\t\t}\n\t\tconst eventWrapper = contentWrapper.querySelector(\".crm-entity-stream-content-event\");\n\t\tif(this._isCollapsed)\n\t\t{\n\t\t\teventWrapper.style.maxHeight = eventWrapper.scrollHeight + 130 + \"px\";\n\t\t\tBX.removeClass(contentWrapper, \"crm-entity-stream-section-content-collapsed\");\n\t\t\tBX.addClass(contentWrapper, \"crm-entity-stream-section-content-expand\");\n\t\t\tsetTimeout(\n\t\t\t\tBX.delegate(function() {\n\t\t\t\t\teventWrapper.style.maxHeight = \"\";\n\t\t\t\t}, this),\n\t\t\t\t300\n\t\t\t);\n\t\t}\n\t\telse\n\t\t{\n\t\t\teventWrapper.style.maxHeight = eventWrapper.clientHeight + \"px\";\n\t\t\tBX.removeClass(contentWrapper, \"crm-entity-stream-section-content-expand\");\n\t\t\tBX.addClass(contentWrapper, \"crm-entity-stream-section-content-collapsed\");\n\t\t\tsetTimeout(\n\t\t\t\tBX.delegate(function() {\n\t\t\t\t\teventWrapper.style.maxHeight = \"\";\n\t\t\t\t}, this),\n\t\t\t\t0\n\t\t\t);\n\t\t}\n\n\t\tthis._isCollapsed = !this._isCollapsed;\n\n\t\tconst button = contentWrapper.querySelector(\"a.crm-entity-stream-section-content-expand-btn\");\n\t\tif(button)\n\t\t{\n\t\t\tbutton.innerHTML = this.getMessage(this._isCollapsed ? \"expand\" : \"collapse\");\n\t\t}\n\t\treturn BX.PreventDefault(e);\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Comment();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import HistoryActivity from \"./history-activity\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Wait extends HistoryActivity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetTitle()\n\t{\n\t\treturn this.getMessage(\"wait\");\n\t}\n\n\tprepareTitleLayout()\n\t{\n\t\treturn BX.create(\"SPAN\", {\n\t\t\tattrs:{ className: \"crm-entity-stream-content-event-title\"},\n\t\t\tchildren: [\n\t\t\t\tBX.create(\"A\", {\n\t\t\t\t\tattrs: { href: \"#\" },\n\t\t\t\t\tevents: { \"click\": this._headerClickHandler },\n\t\t\t\t\ttext: this.getTitle()\n\t\t\t\t})\n\t\t\t]\n\t\t});\n\n\n\t}\n\n\tprepareTimeLayout()\n\t{\n\t\treturn BX.create(\"SPAN\",\n\t\t\t{\n\t\t\t\tattrs: { className: \"crm-entity-stream-content-event-time\" },\n\t\t\t\ttext: this.formatTime(this.getCreatedTime())\n\t\t\t}\n\t\t);\n\t}\n\n\tprepareHeaderLayout()\n\t{\n\t\tconst header = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-header\"}});\n\t\theader.appendChild(this.prepareTitleLayout());\n\t\theader.appendChild(this.prepareTimeLayout());\n\n\t\treturn header;\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tlet description = BX.prop.getString(entityData, \"DESCRIPTION_RAW\", \"\");\n\t\tif(description !== \"\")\n\t\t{\n\t\t\tdescription = BX.util.trim(description);\n\t\t\tdescription = BX.util.strip_tags(description);\n\t\t\tdescription = BX.util.nl2br(description);\n\t\t}\n\n\t\tconst wrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-section crm-entity-stream-section-history crm-entity-stream-section-wait\"}\n\t\t\t}\n\t\t);\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-complete\" }\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst contentWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\tchildren: [contentWrapper]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst header = this.prepareHeaderLayout();\n\t\tcontentWrapper.appendChild(header);\n\n\t\tconst detailWrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail\"},\n\t\t\t\thtml: description\n\t\t\t}\n\t\t);\n\t\tcontentWrapper.appendChild(detailWrapper);\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontentWrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\t//region  Actions\n\t\tthis._actionContainer = BX.create(\"SPAN\", { attrs: { className: \"crm-entity-stream-content-detail-action\" } });\n\t\tcontentWrapper.appendChild(this._actionContainer);\n\t\t//endregion\n\n\t\treturn wrapper;\n\t}\n\n\tprepareActions()\n\t{\n\t}\n\n\tshowActions(show)\n\t{\n\t\tif(this._actionContainer)\n\t\t{\n\t\t\tthis._actionContainer.style.display = show ? \"\" : \"none\";\n\t\t}\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Wait();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import HistoryActivity from \"./history-activity\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Sender extends HistoryActivity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetDataSetting(name)\n\t{\n\t\tconst settings = this.getObjectDataParam('SETTINGS') || {};\n\t\treturn settings[name] || null;\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = Sender.messages;\n\t\treturn m.hasOwnProperty(name) ? m[name] : name;\n\t}\n\n\tgetTitle()\n\t{\n\t\treturn this.getDataSetting('messageName');\n\t}\n\n\tprepareTitleLayout()\n\t{\n\t\tconst self = this;\n\t\treturn BX.create(\"SPAN\", {\n\t\t\tattrs:{ className: \"crm-entity-stream-content-event-title\"},\n\t\t\tchildren: [\n\t\t\t\tthis.isRemoved()\n\t\t\t\t\t?\n\t\t\t\t\tBX.create(\"SPAN\", {text: this.getTitle()})\n\t\t\t\t\t:\n\t\t\t\t\tBX.create(\"A\", {\n\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\thref: \"\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\t\"click\": function (e)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tif (BX.SidePanel)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tBX.SidePanel.Instance.open(self.getDataSetting('path'));\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\ttop.location.href = self.getDataSetting('path');\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\ttext: this.getTitle()\n\t\t\t\t\t})\n\t\t\t]\n\t\t});\n\n\n\t}\n\n\tprepareTimeLayout()\n\t{\n\t\treturn BX.create(\"SPAN\",\n\t\t\t{\n\t\t\t\tattrs: { className: \"crm-entity-stream-content-event-time\" },\n\t\t\t\ttext: this.formatTime(this.getCreatedTime())\n\t\t\t}\n\t\t);\n\t}\n\n\tprepareStatusLayout()\n\t{\n\t\tlet layoutClassName, textCaption;\n\t\tif (this.getDataSetting('isError'))\n\t\t{\n\t\t\ttextCaption = this.getMessage('error');\n\t\t\tlayoutClassName = \"crm-entity-stream-content-event-missing\";\n\t\t}\n\t\telse if (this.getDataSetting('isUnsub'))\n\t\t{\n\t\t\ttextCaption = this.getMessage('unsub');\n\t\t\tlayoutClassName = \"crm-entity-stream-content-event-missing\";\n\t\t}\n\t\telse if (this.getDataSetting('isClick'))\n\t\t{\n\t\t\ttextCaption = this.getMessage('click');\n\t\t\tlayoutClassName = \"crm-entity-stream-content-event-successful\";\n\t\t}\n\t\telse\n\t\t{\n\t\t\ttextCaption = this.getMessage('read');\n\t\t\tlayoutClassName = \"crm-entity-stream-content-event-skipped\";\n\t\t}\n\n\t\treturn BX.create(\"SPAN\", {attrs: {className: layoutClassName}, text: textCaption});\n\t}\n\n\tprepareHeaderLayout()\n\t{\n\t\tconst header = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-header\"}});\n\t\theader.appendChild(this.prepareTitleLayout());\n\t\tif (this.getDataSetting('isError') || this.getDataSetting('isRead') || this.getDataSetting('isUnsub'))\n\t\t{\n\t\t\theader.appendChild(this.prepareStatusLayout());\n\t\t}\n\t\theader.appendChild(this.prepareTimeLayout());\n\n\t\treturn header;\n\t}\n\n\tisRemoved()\n\t{\n\t\treturn !this.getDataSetting('letterTitle');\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst description = this.isRemoved() ? this.getMessage('removed') : this.getMessage('title') + ': ' + this.getDataSetting('letterTitle');\n\n\t\tconst wrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-section crm-entity-stream-section-history crm-entity-stream-section-wait\"}\n\t\t\t}\n\t\t);\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-complete\" }\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst contentWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\tchildren: [contentWrapper]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst header = this.prepareHeaderLayout();\n\t\tcontentWrapper.appendChild(header);\n\n\t\tconst detailWrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail\"},\n\t\t\t\thtml: description\n\t\t\t}\n\t\t);\n\t\tcontentWrapper.appendChild(detailWrapper);\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontentWrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\treturn wrapper;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Sender();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import History from \"./history\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Bizproc extends History\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetTitle()\n\t{\n\t\tconst type = this.getTextDataParam(\"TYPE\");\n\t\tif (type === 'AUTOMATION_DEBUG_INFORMATION')\n\t\t{\n\t\t\treturn this.getMessage('automationDebugger');\n\t\t}\n\n\t\treturn this.getMessage(\"bizproc\");\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst wrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-section crm-entity-stream-section-history crm-entity-stream-section-bp\"}\n\t\t\t}\n\t\t);\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{ attrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-bp\" } }\n\t\t\t)\n\t\t);\n\n\t\tconst content = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\tconst header = this.prepareHeaderLayout();\n\n\t\tcontent.appendChild(header);\n\t\tcontent.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail\" },\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-description\" },\n\t\t\t\t\t\t\t\t\thtml: this.prepareContentTextHtml()\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontent.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-content\" }, children: [ content ] })\n\t\t);\n\n\t\treturn wrapper;\n\t}\n\n\tprepareContentTextHtml()\n\t{\n\t\tconst type = this.getTextDataParam(\"TYPE\");\n\t\tif (type === 'ACTIVITY_ERROR')\n\t\t{\n\t\t\treturn '<strong>#TITLE#</strong>: #ERROR_TEXT#'\n\t\t\t\t.replace('#TITLE#', BX.util.htmlspecialchars(this.getTextDataParam(\"ACTIVITY_TITLE\")))\n\t\t\t\t.replace('#ERROR_TEXT#', BX.util.htmlspecialchars(this.getTextDataParam(\"ERROR_TEXT\")))\n\t\t}\n\t\telse if (type === 'AUTOMATION_DEBUG_INFORMATION')\n\t\t{\n\t\t\treturn BX.Text.encode(this.getTextDataParam('AUTOMATION_DEBUG_TEXT'));\n\t\t}\n\n\t\tconst workflowName = this.getTextDataParam(\"WORKFLOW_TEMPLATE_NAME\");\n\t\tconst workflowStatus = this.getTextDataParam(\"WORKFLOW_STATUS_NAME\");\n\t\tif (!workflowName\n\t\t\t|| workflowStatus !== 'Created' && workflowStatus !== 'Completed' && workflowStatus !== 'Terminated'\n\t\t)\n\t\t{\n\t\t\treturn BX.util.htmlspecialchars(this.getTextDataParam(\"COMMENT\"));\n\t\t}\n\n\t\tlet label = BX.message('CRM_TIMELINE_BIZPROC_CREATED');\n\t\tif (workflowStatus === 'Completed')\n\t\t{\n\t\t\tlabel = BX.message('CRM_TIMELINE_BIZPROC_COMPLETED');\n\t\t}\n\t\telse if (workflowStatus === 'Terminated')\n\t\t{\n\t\t\tlabel = BX.message('CRM_TIMELINE_BIZPROC_TERMINATED');\n\t\t}\n\n\t\treturn BX.util.htmlspecialchars(label)\n\t\t\t.replace('#NAME#', '<strong>' + BX.util.htmlspecialchars(workflowName) + '</strong>');\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Bizproc();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import History from \"./history\";\n\n/** @memberof BX.Crm.Timeline.Actions */\nexport default class Scoring extends History\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst outerWrapper = BX.create(\"DIV\", {\n\t\t\tattrs: {\n\t\t\t\tclassName: \"crm-entity-stream-section crm-entity-stream-section-history crm-entity-stream-section-scoring\"\n\t\t\t},\n\t\t\tevents: {\n\t\t\t\tclick: function () {\n\t\t\t\t\tlet url = \"/crm/ml/#entity#/#id#/detail\";\n\t\t\t\t\tconst ownerTypeId = this.getOwnerTypeId();\n\t\t\t\t\tconst ownerId = this.getOwnerId();\n\n\t\t\t\t\tlet ownerType;\n\t\t\t\t\tif (ownerTypeId === 1)\n\t\t\t\t\t{\n\t\t\t\t\t\townerType = \"lead\";\n\t\t\t\t\t}\n\t\t\t\t\telse if (ownerTypeId === 2)\n\t\t\t\t\t{\n\t\t\t\t\t\townerType = \"deal\";\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\turl = url.replace(\"#entity#\", ownerType);\n\t\t\t\t\turl = url.replace(\"#id#\", ownerId);\n\n\t\t\t\t\tif (BX.SidePanel)\n\t\t\t\t\t{\n\t\t\t\t\t\tBX.SidePanel.Instance.open(url, {width: 840});\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\ttop.location.href = url;\n\t\t\t\t\t}\n\t\t\t\t}.bind(this)\n\t\t\t}\n\t\t});\n\n\t\tconst scoringInfo = BX.prop.getObject(this._data, \"SCORING_INFO\", null);\n\t\tif(!scoringInfo)\n\t\t{\n\t\t\treturn outerWrapper;\n\t\t}\n\n\t\tlet score = BX.prop.getNumber(scoringInfo, \"SCORE\", 0);\n\t\tlet scoreDelta = BX.prop.getNumber(scoringInfo, \"SCORE_DELTA\", 0);\n\t\tscore = Math.round(score * 100);\n\t\tscoreDelta = Math.round(scoreDelta * 100);\n\n\t\tconst result = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-scoring-total-result\"},\n\t\t\t\ttext: score + \"%\"\n\t\t\t});\n\n\t\tlet iconClass = \"crm-entity-stream-content-scoring-total-icon\";\n\t\tif (score < 50)\n\t\t{\n\t\t\ticonClass += \" crm-entity-stream-content-scoring-total-icon-fail\";\n\t\t}\n\t\telse if (score < 75)\n\t\t{\n\t\t\ticonClass += \" crm-entity-stream-content-scoring-total-icon-middle\";\n\t\t}\n\t\telse\n\t\t{\n\t\t\ticonClass += \" crm-entity-stream-content-scoring-total-icon-success\";\n\t\t}\n\n\t\tconst icon = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: iconClass}\n\t\t\t}\n\t\t);\n\n\t\touterWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-scoring-total\" },\n\t\t\t\t\t\t\t\tchildren: [\n\t\t\t\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-scoring-total-text\" },\n\t\t\t\t\t\t\t\t\t\t\ttext: BX.message(\"CRM_TIMELINE_SCORING_TITLE_2\")\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t\tresult,\n\t\t\t\t\t\t\t\t\ticon\n\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t),\n\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-scoring-event\" },\n\t\t\t\t\t\t\t\tchildren: [\n\t\t\t\t\t\t\t\t\t(\n\t\t\t\t\t\t\t\t\t\tscoreDelta !== 0 ?\n\t\t\t\t\t\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-scoring-event-offset\" },\n\t\t\t\t\t\t\t\t\t\t\t\t\ttext: (scoreDelta > 0 ? \"+\" : \"\") + scoreDelta + \"%\"\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t:\n\t\t\t\t\t\t\t\t\t\t\tnull\n\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t\t/*BX.create(\"DIV\",\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-scoring-event-detail\" },\n\t\t\t\t\t\t\t\t\t\t\ttext: \"<activity subject>\"\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t)*/\n\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t)\n\t\t\t\t\t]\n\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\treturn outerWrapper;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Scoring();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","/** @memberof BX.Crm.Timeline.Animation */\nexport default class Expand\n{\n\tconstructor()\n\t{\n\t\tthis._node = null;\n\t\tthis._callback = null;\n\t}\n\n\tinitialize(node, callback)\n\t{\n\t\tthis._node = node;\n\t\tthis._callback = BX.type.isFunction(callback) ? callback : null;\n\t}\n\n\trun()\n\t{\n\t\tconst position = BX.pos(this._node);\n\n\t\tthis._node.style.height = 0;\n\t\tthis._node.style.opacity = 0;\n\t\tthis._node.style.overflow = \"hidden\";\n\n\t\t(new BX.easing(\n\t\t\t\t{\n\t\t\t\t\tduration : 150,\n\t\t\t\t\tstart : { height: 0 },\n\t\t\t\t\tfinish: { height: position.height },\n\t\t\t\t\ttransition : BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\t\t\tstep: BX.delegate(this.onNodeHeightStep, this),\n\t\t\t\t\tcomplete: BX.delegate(this.onNodeHeightComplete, this)\n\t\t\t\t}\n\t\t\t)\n\t\t).animate();\n\t}\n\n\tonNodeHeightStep(state)\n\t{\n\t\tthis._node.style.height = state.height + \"px\";\n\t}\n\n\tonNodeHeightComplete()\n\t{\n\t\tthis._node.style.overflow = \"\";\n\t\t(new BX.easing(\n\t\t\t\t{\n\t\t\t\t\tduration : 150,\n\t\t\t\t\tstart : { opacity: 0 },\n\t\t\t\t\tfinish: { opacity: 100 },\n\t\t\t\t\ttransition : BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\t\t\tstep: BX.delegate(this.onNodeOpacityStep, this),\n\t\t\t\t\tcomplete: BX.delegate(this.onNodeOpacityComplete, this)\n\t\t\t\t}\n\t\t\t)\n\t\t).animate();\n\t}\n\n\tonNodeOpacityStep(state)\n\t{\n\t\tthis._node.style.opacity = state.opacity / 100;\n\t}\n\n\tonNodeOpacityComplete()\n\t{\n\t\tthis._node.style.height = \"\";\n\t\tthis._node.style.opacity = \"\";\n\t\tif(this._callback)\n\t\t{\n\t\t\tthis._callback();\n\t\t}\n\t}\n\n\tstatic create(node, callback)\n\t{\n\t\tconst self = new Expand();\n\t\tself.initialize(node, callback);\n\t\treturn self;\n\t}\n}\n","import Stream from \"../stream\";\nimport {Item as ItemType, Order as OrderType} from \"../types\";\nimport HistoryItem from \"../items/history\";\nimport Modification from \"../items/modification\";\nimport Conversion from \"../items/conversion\";\nimport HistoryActivity from \"../items/history-activity\";\nimport Email from \"../items/email\";\nimport Call from \"../items/call\";\nimport Meeting from \"../items/meeting\";\nimport Task from \"../items/task\";\nimport WebForm from \"../items/webform\";\nimport Request from \"../items/request\";\nimport OpenLine from \"../items/openline\";\nimport Rest from \"../items/rest\";\nimport Visit from \"../items/visit\";\nimport Zoom from \"../items/zoom\";\nimport ExternalNoticeStatusModification from \"../items/external-notice-status-modification\";\nimport ExternalNoticeModification from \"../items/external-notice-modification\";\nimport Creation from \"../items/creation\";\nimport Restoration from \"../items/restoration\";\nimport Link from \"../items/link\";\nimport Unlink from \"../items/unlink\";\nimport Mark from \"../items/mark\";\nimport Comment from \"../items/comment\";\nimport Wait from \"../items/wait\";\nimport Document from \"../items/document\";\nimport Sender from \"../items/sender\";\nimport Bizproc from \"../items/bizproc\";\nimport Scoring from \"../items/scoring\";\nimport {ConfigurableItem, StreamType} from \"crm.timeline.item\";\nimport Expand from \"../animations/expand\";\n\n/** @memberof BX.Crm.Timeline.Streams */\nexport default class History extends Stream\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._items = [];\n\t\tthis._wrapper = null;\n\t\tthis._fixedHistory = null;\n\t\tthis._emptySection = null;\n\t\tthis._currentDaySection = null;\n\t\tthis._lastDaySection = null;\n\t\tthis._lastDate = null;\n\t\tthis._anchor = null;\n\t\tthis._history = this;\n\t\tthis._enableLoading = false;\n\t\tthis._navigation = null;\n\t\tthis._scrollHandler = null;\n\t\tthis._loadingWaiter = null;\n\n\t\tthis._filterId = \"\";\n\t\tthis._isFilterApplied = false;\n\t\tthis._isFilterShown = false;\n\n\t\tthis._isRequestRunning = false;\n\n\t\tthis._filterButton = null;\n\t\tthis._filterWrapper = null;\n\t\tthis._filterResultStub = null;\n\t}\n\n\tdoInitialize()\n\t{\n\t\tthis._fixedHistory = this.getSetting(\"fixedHistory\");\n\t\tthis._ownerTypeId = this.getSetting(\"ownerTypeId\");\n\t\tthis._ownerId = this.getSetting(\"ownerId\");\n\t\tthis._serviceUrl = this.getSetting(\"serviceUrl\", \"\");\n\t\tif (!this.isStubMode())\n\t\t{\n\t\t\tlet itemData = this.getSetting(\"itemData\");\n\t\t\tif (!BX.type.isArray(itemData))\n\t\t\t{\n\t\t\t\titemData = [];\n\t\t\t}\n\n\t\t\tlet i, length, item;\n\t\t\tfor (i = 0, length = itemData.length; i < length; i++)\n\t\t\t{\n\t\t\t\titem = this.createItem(itemData[i]);\n\t\t\t\tif (item)\n\t\t\t\t{\n\t\t\t\t\tthis._items.push(item);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis._navigation = this.getSetting(\"navigation\", {});\n\n\t\t\tthis._filterWrapper = BX(\"timeline-filter\");\n\t\t\tthis._filterId = BX.prop.getString(this._settings, \"filterId\", this._id);\n\t\t\tthis._isFilterShown = this._filterWrapper\n\t\t\t\t&& BX.hasClass(this._filterWrapper, \"crm-entity-stream-section-filter-show\");\n\t\t\tthis._isFilterApplied = BX.prop.getBoolean(this._settings, \"isFilterApplied\", false);\n\n\t\t\tBX.addCustomEvent(\"BX.Main.Filter:apply\", this.onFilterApply.bind(this));\n\t\t}\n\t}\n\n\tlayout()\n\t{\n\t\tthis._wrapper = BX.create(\"DIV\", {});\n\t\tthis._container.appendChild(this._wrapper);\n\n\t\tconst now = BX.prop.extractDate(new Date());\n\t\tlet i, length, item;\n\n\t\tif (!this.isStubMode())\n\t\t{\n\t\t\tif (this._filterWrapper)\n\t\t\t{\n\t\t\t\tconst closeFilterButton = this._filterWrapper.querySelector(\".crm-entity-stream-filter-close\");\n\t\t\t\tif (closeFilterButton)\n\t\t\t\t{\n\t\t\t\t\tBX.bind(closeFilterButton, \"click\", this.onFilterClose.bind(this));\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfor (i = 0, length = this._items.length; i < length; i++)\n\t\t\t{\n\t\t\t\titem = this._items[i];\n\t\t\t\titem.setContainer(this._wrapper);\n\n\t\t\t\tconst created = item.getCreatedDate();\n\t\t\t\tif (this._lastDate === null || this._lastDate.getTime() !== created.getTime())\n\t\t\t\t{\n\t\t\t\t\tthis._lastDate = created;\n\t\t\t\t\tif (now.getTime() === created.getTime())\n\t\t\t\t\t{\n\t\t\t\t\t\tthis._currentDaySection = this._lastDaySection = this.createCurrentDaySection();\n\t\t\t\t\t\tthis._wrapper.appendChild(this._currentDaySection);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis._lastDaySection = this.createDaySection(this._lastDate);\n\t\t\t\t\t\tthis._wrapper.appendChild(this._lastDaySection);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\titem._lastDate = this._lastDate;\n\n\t\t\t\titem.layout();\n\t\t\t}\n\n\t\t\tthis.enableLoading(this._items.length > 0);\n\t\t\tthis.refreshLayout();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis._currentDaySection = this._lastDaySection = this.createCurrentDaySection();\n\t\t\tthis._wrapper.appendChild(this._currentDaySection);\n\n\t\t\tthis._wrapper.appendChild(\n\t\t\t\tBX.create(\n\t\t\t\t\t\"DIV\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-section crm-entity-stream-section-createEntity crm-entity-stream-section-last\"},\n\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\tBX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-info\"}}),\n\t\t\t\t\t\t\t\tBX.create(\n\t\t\t\t\t\t\t\t\t\"DIV\",\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-section-content\"},\n\t\t\t\t\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t\t\t\t\tBX.create(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\"DIV\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-event\"},\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tBX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-header\"}}),\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tBX.create(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\"DIV\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail\"},\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttext: BX.message(\"CRM_TIMELINE_HISTORY_STUB\")\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\n\t\tthis._manager.processHistoryLayoutChange();\n\t}\n\n\trefreshLayout()\n\t{\n\t\tif (this._filterWrapper)\n\t\t{\n\t\t\tif (this._wrapper.firstChild && this._filterWrapper !== this._wrapper.firstChild)\n\t\t\t{\n\t\t\t\tthis._wrapper.insertBefore(this._filterWrapper, this._wrapper.firstChild);\n\t\t\t}\n\t\t\telse if (!this._wrapper.firstChild && this._filterWrapper.parentNode !== this._wrapper)\n\t\t\t{\n\t\t\t\tthis._wrapper.appendChild(this._filterWrapper);\n\t\t\t}\n\t\t}\n\n\t\tthis.adjustFilterButton();\n\n\t\tconst length = this._items.length;\n\t\tif (length === 0 && this._isFilterApplied)\n\t\t{\n\t\t\tif (!this._filterEmptyResultSection)\n\t\t\t{\n\t\t\t\tthis._filterEmptyResultSection = this.createFilterEmptyResultSection();\n\t\t\t}\n\t\t\tthis._wrapper.appendChild(this._filterEmptyResultSection);\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (this._filterEmptyResultSection)\n\t\t{\n\t\t\tthis._filterEmptyResultSection = BX.remove(this._filterEmptyResultSection);\n\t\t}\n\n\t\tif (length === 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tfor (let i = 0; i < (length - 1); i++)\n\t\t{\n\t\t\tconst item = this._items[i];\n\t\t\tif (item.isTerminated())\n\t\t\t{\n\t\t\t\titem.markAsTerminated(false);\n\t\t\t}\n\t\t}\n\n\t\tthis._items[length - 1].markAsTerminated(true);\n\t}\n\n\tcalculateItemIndex(item)\n\t{\n\t\treturn 0;\n\t}\n\n\tcheckItemForTermination(item)\n\t{\n\t\treturn this.getLastItem() === item;\n\t}\n\n\thasContent()\n\t{\n\t\treturn (this._items.length > 0 || this._isFilterApplied || this._isStubMode);\n\t}\n\n\tgetItems(): Array\n\t{\n\t\treturn this._items;\n\t}\n\n\tsetItems(items: Array): void\n\t{\n\t\tthis._items = items;\n\t}\n\n\tgetItemByIndex(index)\n\t{\n\t\treturn index < this._items.length ? this._items[index] : null;\n\t}\n\n\tgetItemCount()\n\t{\n\t\treturn this._items.length;\n\t}\n\n\tgetItemsByAssociatedEntity($entityTypeId, entityId)\n\t{\n\t\tif (!BX.type.isNumber($entityTypeId))\n\t\t{\n\t\t\t$entityTypeId = parseInt($entityTypeId);\n\t\t}\n\n\t\tif (!BX.type.isNumber(entityId))\n\t\t{\n\t\t\tentityId = parseInt(entityId);\n\t\t}\n\n\t\tif (isNaN($entityTypeId) || $entityTypeId <= 0 || isNaN(entityId) || entityId <= 0)\n\t\t{\n\t\t\treturn [];\n\t\t}\n\n\t\tconst results = [];\n\t\tfor (let i = 0, l = this._items.length; i < l; i++)\n\t\t{\n\t\t\tconst item = this._items[i];\n\t\t\tif (item.getAssociatedEntityTypeId() === $entityTypeId && item.getAssociatedEntityId() === entityId)\n\t\t\t{\n\t\t\t\tresults.push(item);\n\t\t\t}\n\t\t}\n\t\treturn results;\n\t}\n\n\tcreateFilterEmptyResultSection()\n\t{\n\t\treturn BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-section crm-entity-stream-section-filter-empty\"},\n\t\t\t\tchildren:\n\t\t\t\t\t[\n\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-section-content\"},\n\t\t\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-filter-empty\"},\n\t\t\t\t\t\t\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-filter-empty-img\"}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-filter-empty-text\"},\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttext: this.getMessage(\"filterEmptyResultStub\")\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t)\n\t\t\t\t\t]\n\t\t\t}\n\t\t);\n\t}\n\n\tadjustFilterButton()\n\t{\n\t\tif (!this._filterWrapper)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this._isFilterShown && this._items.length === 0)\n\t\t{\n\t\t\tif (!this._emptySection)\n\t\t\t{\n\t\t\t\tthis._emptySection = this.createEmptySection();\n\t\t\t}\n\t\t\tthis._wrapper.insertBefore(this._emptySection, this._filterWrapper);\n\t\t}\n\t\telse if (this._emptySection)\n\t\t{\n\t\t\tthis._emptySection = BX.remove(this._emptySection);\n\t\t}\n\n\t\tif (!this._filterButton)\n\t\t{\n\t\t\tthis._filterButton = BX.create(\"BUTTON\",\n\t\t\t\t{\n\t\t\t\t\tattrs: {className: \"crm-entity-stream-filter-label\"},\n\t\t\t\t\ttext: this.getMessage(\"filterButtonCaption\")\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tBX.bind(this._filterButton, \"click\", function (e) {\n\t\t\t\tthis.showFilter();\n\t\t\t}.bind(this));\n\t\t}\n\n\t\tconst section = this._wrapper.querySelector(\".crm-entity-stream-section-today-label, .crm-entity-stream-section-planned-label, .crm-entity-stream-section-history-label\");\n\t\tif (section)\n\t\t{\n\t\t\tconst sectionWrapper = section.querySelector(\".crm-entity-stream-section-content\");\n\t\t\tif (sectionWrapper)\n\t\t\t{\n\t\t\t\tif (this._filterButton.parentNode !== sectionWrapper)\n\t\t\t\t{\n\t\t\t\t\tsectionWrapper.appendChild(this._filterButton);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (this._isFilterApplied)\n\t\t{\n\t\t\tBX.addClass(this._filterButton, \"crm-entity-stream-filter-label-active\");\n\t\t}\n\t\telse\n\t\t{\n\t\t\tBX.removeClass(this._filterButton, \"crm-entity-stream-filter-label-active\");\n\t\t}\n\t}\n\n\tshowFilter(params)\n\t{\n\t\tif (!this._filterWrapper)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tBX.removeClass(this._filterWrapper, \"crm-entity-stream-section-filter-hide\");\n\t\tBX.addClass(this._filterWrapper, \"crm-entity-stream-section-filter-show\");\n\n\t\tthis._isFilterShown = true;\n\n\t\tif (BX.prop.getBoolean(params, \"enableAdjust\", true))\n\t\t{\n\t\t\tthis.adjustFilterButton();\n\t\t}\n\t}\n\n\thideFilter(params)\n\t{\n\t\tif (!this._filterWrapper)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tBX.removeClass(this._filterWrapper, \"crm-entity-stream-section-filter-show\");\n\t\tBX.addClass(this._filterWrapper, \"crm-entity-stream-section-filter-hide\");\n\n\t\tthis._isFilterShown = false;\n\n\t\tif (BX.prop.getBoolean(params, \"enableAdjust\", true))\n\t\t{\n\t\t\tthis.adjustFilterButton();\n\t\t}\n\t}\n\n\tonFilterClose(e)\n\t{\n\t\tthis.hideFilter();\n\n\t\twindow.setTimeout(\n\t\t\tfunction () {\n\t\t\t\tconst filter = BX.Main.filterManager.getById(this._filterId);\n\t\t\t\tif (filter)\n\t\t\t\t{\n\t\t\t\t\tfilter.resetFilter();\n\t\t\t\t}\n\t\t\t}.bind(this),\n\t\t\t500\n\t\t);\n\t}\n\n\tcreateEmptySection()\n\t{\n\t\treturn BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-section crm-entity-stream-section-planned-label\"},\n\t\t\t\tchildren: [BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-section-content\"}})]\n\t\t\t}\n\t\t);\n\t}\n\n\tcreateCurrentDaySection()\n\t{\n\t\tlet formattedDate = this.formatDate(BX.prop.extractDate(new Date()));\n\t\tformattedDate = formattedDate[0].toUpperCase() + formattedDate.substring(1);\n\n\t\treturn BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-section crm-entity-stream-section-today-label\"},\n\t\t\t\tchildren:\n\t\t\t\t\t[\n\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-section-content\"},\n\t\t\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-today-label\"},\n\t\t\t\t\t\t\t\t\t\t\t\ttext: formattedDate\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t)\n\t\t\t\t\t]\n\t\t\t}\n\t\t);\n\t}\n\n\tcreateDaySection(date)\n\t{\n\t\tlet formattedDate = this.formatDate(date);\n\t\tformattedDate = formattedDate[0].toUpperCase() + formattedDate.substring(1);\n\n\t\treturn BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-section crm-entity-stream-section-history-label\"},\n\t\t\t\tchildren:\n\t\t\t\t\t[\n\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-section-content\"},\n\t\t\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-history-label\"},\n\t\t\t\t\t\t\t\t\t\t\t\ttext: formattedDate\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t)\n\t\t\t\t\t]\n\t\t\t}\n\t\t);\n\t}\n\n\tcreateAnchor(index)\n\t{\n\t\tif (this._emptySection)\n\t\t{\n\t\t\tthis._emptySection = BX.remove(this._emptySection);\n\t\t}\n\n\t\tif (this._currentDaySection === null)\n\t\t{\n\t\t\tthis._currentDaySection = this.createCurrentDaySection();\n\t\t\tif (this._wrapper.firstChild)\n\t\t\t{\n\t\t\t\tthis._wrapper.insertBefore(this._currentDaySection, this._wrapper.firstChild);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis._wrapper.appendChild(this._currentDaySection);\n\t\t\t}\n\t\t}\n\n\t\tif (this._anchor === null)\n\t\t{\n\t\t\tthis._anchor = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-section crm-entity-stream-section-shadow\"}});\n\t\t\tif (this._currentDaySection.nextSibling)\n\t\t\t{\n\t\t\t\tthis._wrapper.insertBefore(this._anchor, this._currentDaySection.nextSibling);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis._wrapper.appendChild(this._anchor);\n\t\t\t}\n\t\t}\n\t\treturn this._anchor;\n\t}\n\n\tcreateActivityItem(data)\n\t{\n\t\tconst typeId = BX.prop.getInteger(data, \"TYPE_ID\", ItemType.undefined);\n\t\tconst typeCategoryId = BX.prop.getInteger(data, \"TYPE_CATEGORY_ID\", 0);\n\t\tconst providerId = BX.prop.getString(\n\t\t\tBX.prop.getObject(data, \"ASSOCIATED_ENTITY\", {}),\n\t\t\t\"PROVIDER_ID\",\n\t\t\t\"\"\n\t\t);\n\n\t\tif (typeId !== ItemType.activity)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tif (typeCategoryId === BX.CrmActivityType.email)\n\t\t{\n\t\t\treturn Email.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this._history,\n\t\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\tif (typeCategoryId === BX.CrmActivityType.call)\n\t\t{\n\t\t\treturn Call.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this._history,\n\t\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (typeCategoryId === BX.CrmActivityType.meeting)\n\t\t{\n\t\t\treturn Meeting.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this._history,\n\t\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (typeCategoryId === BX.CrmActivityType.task)\n\t\t{\n\t\t\treturn Task.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this._history,\n\t\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (typeCategoryId === BX.CrmActivityType.provider)\n\t\t{\n\t\t\tif (providerId === \"CRM_WEBFORM\")\n\t\t\t{\n\t\t\t\treturn WebForm.create(\n\t\t\t\t\tdata[\"ID\"],\n\t\t\t\t\t{\n\t\t\t\t\t\thistory: this._history,\n\t\t\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\tdata: data\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t\telse if (providerId === 'CRM_REQUEST')\n\t\t\t{\n\t\t\t\treturn Request.create(\n\t\t\t\t\tdata[\"ID\"],\n\t\t\t\t\t{\n\t\t\t\t\t\thistory: this._history,\n\t\t\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\tdata: data\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t\telse if (providerId === \"IMOPENLINES_SESSION\")\n\t\t\t{\n\t\t\t\treturn OpenLine.create(\n\t\t\t\t\tdata[\"ID\"],\n\t\t\t\t\t{\n\t\t\t\t\t\thistory: this._history,\n\t\t\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\tdata: data\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t\telse if (providerId === 'REST_APP')\n\t\t\t{\n\t\t\t\treturn Rest.create(\n\t\t\t\t\tdata[\"ID\"],\n\t\t\t\t\t{\n\t\t\t\t\t\thistory: this._history,\n\t\t\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\tdata: data\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t\telse if (providerId === 'VISIT_TRACKER')\n\t\t\t{\n\t\t\t\treturn Visit.create(\n\t\t\t\t\tdata[\"ID\"],\n\t\t\t\t\t{\n\t\t\t\t\t\thistory: this,\n\t\t\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\tdata: data\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t\telse if (providerId === 'ZOOM')\n\t\t\t{\n\t\t\t\treturn Zoom.create(\n\t\t\t\t\tdata[\"ID\"],\n\t\t\t\t\t{\n\t\t\t\t\t\thistory: this,\n\t\t\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\tdata: data\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t\telse if (providerId === 'CRM_CALL_TRACKER')\n\t\t\t{\n\t\t\t\treturn Call.create(\n\t\t\t\t\tdata[\"ID\"],\n\t\t\t\t\t{\n\t\t\t\t\t\thistory: this,\n\t\t\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\tdata: data\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\treturn HistoryActivity.create(\n\t\t\tdata[\"ID\"],\n\t\t\t{\n\t\t\t\thistory: this._history,\n\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\tcontainer: this._wrapper,\n\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\tdata: data,\n\t\t\t}\n\t\t);\n\t}\n\n\tcreateExternalNotificationItem(data)\n\t{\n\t\tconst typeId = BX.prop.getInteger(data, \"TYPE_CATEGORY_ID\", 0);\n\t\tconst changedFieldName = BX.prop.getString(data, 'CHANGED_FIELD_NAME', '');\n\n\t\tif (typeId === ItemType.modification && changedFieldName === 'STATUS_ID')\n\t\t{\n\t\t\treturn ExternalNoticeStatusModification.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this._history,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\treturn ExternalNoticeModification.create(\n\t\t\tdata[\"ID\"],\n\t\t\t{\n\t\t\t\thistory: this._history,\n\t\t\t\tcontainer: this._wrapper,\n\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\tdata: data\n\t\t\t}\n\t\t);\n\t}\n\n\tcreateItem(data)\n\t{\n\t\tif (data.hasOwnProperty('type'))\n\t\t{\n\t\t\treturn ConfigurableItem.create(data.id, {\n\t\t\t\ttimelineId: this.getId(),\n\t\t\t\tcontainer: this.getWrapper(),\n\t\t\t\titemClassName: this.getItemClassName(),\n\t\t\t\tuseShortTimeFormat: this.getStreamType() === StreamType.history,\n\t\t\t\tisReadOnly: this.isReadOnly(),\n\t\t\t\tcurrentUser: this._manager.getCurrentUser(),\n\t\t\t\townerTypeId: this._manager.getOwnerTypeId(),\n\t\t\t\townerId: this._manager.getOwnerId(),\n\t\t\t\tstreamType: this.getStreamType(),\n\t\t\t\tdata: data,\n\t\t\t})\n\t\t}\n\n\t\tconst typeId = BX.prop.getInteger(data, \"TYPE_ID\", ItemType.undefined);\n\t\tconst typeCategoryId = BX.prop.getInteger(data, \"TYPE_CATEGORY_ID\", 0);\n\n\t\tif (typeId === ItemType.activity)\n\t\t{\n\t\t\treturn this.createActivityItem(data);\n\t\t}\n\t\telse if (typeId === ItemType.externalNotification)\n\t\t{\n\t\t\treturn this.createExternalNotificationItem(data);\n\t\t}\n\t\telse if (typeId === ItemType.creation)\n\t\t{\n\t\t\treturn Creation.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this._history,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (typeId === ItemType.restoration)\n\t\t{\n\t\t\treturn Restoration.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this._history,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (typeId === ItemType.link)\n\t\t{\n\t\t\treturn Link.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (typeId === ItemType.unlink)\n\t\t{\n\t\t\treturn Unlink.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (typeId === ItemType.mark)\n\t\t{\n\t\t\treturn Mark.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this._history,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (typeId === ItemType.comment)\n\t\t{\n\t\t\treturn Comment.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this._history,\n\t\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (typeId === ItemType.wait)\n\t\t{\n\t\t\treturn Wait.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this._history,\n\t\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (typeId === ItemType.document)\n\t\t{\n\t\t\treturn Document.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this._history,\n\t\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (typeId === ItemType.sender)\n\t\t{\n\t\t\treturn Sender.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (typeId === ItemType.modification)\n\t\t{\n\t\t\treturn Modification.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this._history,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (typeId === ItemType.conversion)\n\t\t{\n\t\t\treturn Conversion.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this._history,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (typeId === ItemType.bizproc)\n\t\t{\n\t\t\treturn Bizproc.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this._history,\n\t\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (typeId === ItemType.scoring)\n\t\t{\n\t\t\treturn Scoring.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this._history,\n\t\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\treturn HistoryItem.create(\n\t\t\tdata[\"ID\"],\n\t\t\t{\n\t\t\t\thistory: this._history,\n\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\tcontainer: this._wrapper,\n\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\tdata: data\n\t\t\t}\n\t\t);\n\t}\n\n\tgetWrapper()\n\t{\n\t\treturn this._wrapper;\n\t}\n\n\tgetItemClassName()\n\t{\n\t\treturn 'crm-entity-stream-section crm-entity-stream-section-history';\n\t}\n\n\taddItem(item, index)\n\t{\n\t\tif (!BX.type.isNumber(index) || index < 0)\n\t\t{\n\t\t\tindex = this.calculateItemIndex(item);\n\t\t}\n\n\t\tif (index < this._items.length)\n\t\t{\n\t\t\tthis._items.splice(index, 0, item);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis._items.push(item);\n\t\t}\n\n\t\tthis.refreshLayout();\n\t\tthis._manager.processHistoryLayoutChange();\n\t}\n\n\tdeleteItem(item)\n\t{\n\t\tconst index = this.getItemIndex(item);\n\t\tif (index < 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\titem.clearLayout();\n\t\tthis.removeItemByIndex(index);\n\n\t\tthis.refreshLayout();\n\t\tthis._manager.processHistoryLayoutChange();\n\t}\n\n\tresetLayout()\n\t{\n\t\tlet i;\n\n\t\tfor (i = (this._items.length - 1); i >= 0; i--)\n\t\t{\n\t\t\tthis._items[i].clearLayout();\n\t\t}\n\n\t\tthis._items = [];\n\n\t\tthis._currentDaySection = this._lastDaySection = this._emptySection = this._filterEmptyResultSection = null;\n\t\tthis._anchor = null;\n\t\tthis._lastDate = null;\n\n\t\t//Clean wrapper. Skip filter for prevent trembling.\n\t\tconst children = [];\n\t\tlet child;\n\t\tfor (i = 0; child = this._wrapper.children[i]; i++)\n\t\t{\n\t\t\tif (child !== this._filterWrapper)\n\t\t\t{\n\t\t\t\tchildren.push(child);\n\t\t\t}\n\t\t}\n\n\t\tfor (i = 0; child = children[i]; i++)\n\t\t{\n\t\t\tthis._wrapper.removeChild(child);\n\t\t}\n\t}\n\n\tonWindowScroll(e)\n\t{\n\t\tif (!this._loadingWaiter || !this._enableLoading || this._isRequestRunning)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst pos = this._loadingWaiter.getBoundingClientRect();\n\t\tif (pos.top <= document.documentElement.clientHeight)\n\t\t{\n\t\t\tthis.loadItems();\n\t\t}\n\t}\n\n\tonFilterApply(id, data, ctx, promise, params)\n\t{\n\t\tif (id !== this._filterId)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tparams.autoResolve = false;\n\t\tthis._isFilterApplied = BX.prop.getString(data, \"action\", \"\") === \"apply\";\n\t\tthis._isRequestRunning = true;\n\n\t\tBX.CrmDataLoader.create(\n\t\t\tthis._id,\n\t\t\t{\n\t\t\t\tserviceUrl: this.getSetting(\"serviceUrl\", \"\"),\n\t\t\t\taction: \"GET_HISTORY_ITEMS\",\n\t\t\t\tparams:\n\t\t\t\t\t{\n\t\t\t\t\t\t\"GUID\": this._id,\n\t\t\t\t\t\t\"OWNER_TYPE_ID\": this._manager.getOwnerTypeId(),\n\t\t\t\t\t\t\"OWNER_ID\": this._manager.getOwnerId()\n\t\t\t\t\t}\n\t\t\t}\n\t\t).load(\n\t\t\tfunction (sender, result) {\n\t\t\t\tthis.resetLayout();\n\t\t\t\tthis.bulkCreateItems(BX.prop.getArray(result, \"HISTORY_ITEMS\", []));\n\t\t\t\tthis.setNavigation(BX.prop.getObject(result, \"HISTORY_NAVIGATION\", {}));\n\n\t\t\t\tthis.refreshLayout();\n\t\t\t\tif (this._items.length > 0)\n\t\t\t\t{\n\t\t\t\t\tthis._manager.processHistoryLayoutChange();\n\t\t\t\t}\n\n\t\t\t\tpromise.fulfill();\n\t\t\t\tthis._isRequestRunning = false;\n\t\t\t}.bind(this)\n\t\t);\n\t}\n\n\tbulkCreateItems(itemData)\n\t{\n\t\tconst length = itemData.length;\n\t\tif (length === 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this._filterEmptyResultSection)\n\t\t{\n\t\t\tthis._filterEmptyResultSection = BX.remove(this._filterEmptyResultSection);\n\t\t}\n\n\t\tconst now = BX.prop.extractDate(new Date());\n\t\tlet i, item;\n\t\tfor (i = 0; i < length; i++)\n\t\t{\n\t\t\tconst itemId = BX.prop.getInteger(\n\t\t\t\titemData[i],\n\t\t\t\t'id',\n\t\t\t\tBX.prop.getInteger(itemData[i], 'ID', 0)\n\t\t\t);\n\n\t\t\tif (itemId <= 0)\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (this.findItemById(itemId) !== null)\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\titem = this.createItem(itemData[i]);\n\t\t\tthis._items.push(item);\n\n\t\t\tconst created = item.getCreatedDate();\n\t\t\tif (this._lastDate === null || this._lastDate.getTime() !== created.getTime())\n\t\t\t{\n\t\t\t\tthis._lastDate = created;\n\t\t\t\tif (now.getTime() === created.getTime())\n\t\t\t\t{\n\t\t\t\t\tthis._currentDaySection = this._lastDaySection = this.createCurrentDaySection();\n\t\t\t\t\tthis._wrapper.appendChild(this._currentDaySection);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis._lastDaySection = this.createDaySection(this._lastDate);\n\t\t\t\t\tthis._wrapper.appendChild(this._lastDaySection);\n\t\t\t\t}\n\t\t\t}\n\t\t\titem.layout();\n\t\t}\n\t}\n\n\tloadItems()\n\t{\n\t\tthis._isRequestRunning = true;\n\t\tBX.CrmDataLoader.create(\n\t\t\tthis._id,\n\t\t\t{\n\t\t\t\tserviceUrl: this.getSetting(\"serviceUrl\", \"\"),\n\t\t\t\taction: \"GET_HISTORY_ITEMS\",\n\t\t\t\tparams:\n\t\t\t\t\t{\n\t\t\t\t\t\t\"GUID\": this._id,\n\t\t\t\t\t\t\"OWNER_TYPE_ID\": this._manager.getOwnerTypeId(),\n\t\t\t\t\t\t\"OWNER_ID\": this._manager.getOwnerId(),\n\t\t\t\t\t\t\"NAVIGATION\": this._navigation\n\t\t\t\t\t}\n\t\t\t}\n\t\t).load(\n\t\t\tfunction (sender, result) {\n\t\t\t\tthis.bulkCreateItems(BX.prop.getArray(result, \"HISTORY_ITEMS\", []));\n\t\t\t\tthis.setNavigation(BX.prop.getObject(result, \"HISTORY_NAVIGATION\", {}));\n\n\t\t\t\tthis.refreshLayout();\n\t\t\t\tif (this._items.length > 0)\n\t\t\t\t{\n\t\t\t\t\tthis._manager.processHistoryLayoutChange();\n\t\t\t\t}\n\n\t\t\t\tthis._isRequestRunning = false;\n\t\t\t}.bind(this)\n\t\t);\n\t}\n\n\tgetNavigation()\n\t{\n\t\treturn this._navigation;\n\t}\n\n\tsetNavigation(navigation)\n\t{\n\t\tif (!BX.type.isPlainObject(navigation))\n\t\t{\n\t\t\tnavigation = {};\n\t\t}\n\n\t\tthis._navigation = navigation;\n\t\tthis.enableLoading(\n\t\t\tBX.prop.getString(this._navigation, \"OFFSET_TIMESTAMP\", \"\") !== \"\"\n\t\t);\n\t}\n\n\tisLoadingEnabled()\n\t{\n\t\treturn this._enableLoading;\n\t}\n\n\tenableLoading(enable)\n\t{\n\t\tenable = !!enable;\n\n\t\tif (this._enableLoading === enable)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis._enableLoading = enable;\n\n\t\tif (this._enableLoading)\n\t\t{\n\t\t\tif (this._items.length > 0)\n\t\t\t{\n\t\t\t\tthis._loadingWaiter = this._items[this._items.length - 1].getWrapper();\n\t\t\t}\n\n\t\t\tif (!this._scrollHandler)\n\t\t\t{\n\t\t\t\tthis._scrollHandler = BX.delegate(this.onWindowScroll, this);\n\t\t\t\tBX.bind(window, \"scroll\", this._scrollHandler);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis._loadingWaiter = null;\n\n\t\t\tif (this._scrollHandler)\n\t\t\t{\n\t\t\t\tBX.unbind(window, \"scroll\", this._scrollHandler);\n\t\t\t\tthis._scrollHandler = null;\n\t\t\t}\n\t\t}\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = History.messages;\n\t\treturn m.hasOwnProperty(name) ? m[name] : name;\n\t}\n\n\tanimateItemAdding(item): Promise\n\t{\n\t\treturn new Promise((resolve) => {\n\t\t\tExpand.create(item.getWrapper(), resolve).run();\n\t\t});\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new History();\n\t\tself.initialize(id, settings);\n\t\tHistory.instances[self.getId()] = self;\n\t\treturn self;\n\t}\n\n\tstatic messages = {};\n\tstatic instances = {};\n}\n","import History from \"./history\";\nimport {Item} from 'crm.timeline.item';\nimport CompatibleItem from \"../items/compatible-item\";\nimport {StreamType} from 'crm.timeline.item';\n\n/** @memberof BX.Crm.Timeline.Streams */\nexport default class FixedHistory extends History\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._items = [];\n\t\tthis._wrapper = null;\n\t\tthis._fixedHistory = this;\n\t\tthis._history = this;\n\t\tthis._isRequestRunning = false;\n\t}\n\n\tdoInitialize()\n\t{\n\t\tconst datetimeFormat = BX.message(\"FORMAT_DATETIME\").replace(/:SS/, \"\");\n\t\tthis._timeFormat = BX.date.convertBitrixFormat(datetimeFormat);\n\n\t\tlet itemData = this.getSetting(\"itemData\");\n\t\tif(!BX.type.isArray(itemData))\n\t\t{\n\t\t\titemData = [];\n\t\t}\n\n\t\tlet i, length, item;\n\t\tfor(i = 0, length = itemData.length; i < length; i++)\n\t\t{\n\t\t\titem = this.createItem(itemData[i]);\n\t\t\titem._isFixed = true;\n\t\t\tthis._items.push(item);\n\t\t}\n\t}\n\n\tsetHistory(history)\n\t{\n\t\tthis._history = history;\n\t}\n\n\tcheckItemForTermination(item)\n\t{\n\t\treturn false;\n\t}\n\n\tlayout()\n\t{\n\t\tthis._wrapper = BX.create(\"DIV\", {});\n\t\tthis.createAnchor();\n\t\tthis._container.insertBefore(this._wrapper,  this._editorContainer.nextElementSibling);\n\n\t\tfor (let i = 0; i < this._items.length; i++)\n\t\t{\n\t\t\tthis._items[i].setContainer(this._wrapper);\n\t\t\tthis._items[i].layout();\n\t\t}\n\n\t\tthis.refreshLayout();\n\n\t\tthis._manager.processHistoryLayoutChange();\n\t}\n\n\trefreshLayout()\n\t{\n\t}\n\n\tformatDate(date)\n\t{\n\t}\n\n\tcreateCurrentDaySection()\n\t{\n\t}\n\n\tcreateDaySection(date)\n\t{\n\t}\n\n\tcreateAnchor(index)\n\t{\n\t\tthis._anchor = BX.create(\"DIV\", { attrs:{className: \"crm-entity-stream-section-fixed-anchor\"} });\n\t\tthis._wrapper.appendChild(this._anchor);\n\t}\n\n\tonWindowScroll(e)\n\t{\n\t}\n\n\tonItemsLoad(sender, result)\n\t{\n\t}\n\n\tloadItems()\n\t{\n\t\tthis._isRequestRunning = true;\n\n\t\tBX.CrmDataLoader.create(\n\t\t\tthis._id,\n\t\t\t{\n\t\t\t\tserviceUrl: this.getSetting(\"serviceUrl\", \"\"),\n\t\t\t\taction: \"GET_FIXED_HISTORY_ITEMS\",\n\t\t\t\tparams:\n\t\t\t\t\t{\n\t\t\t\t\t\t\"OWNER_TYPE_ID\" : this._manager.getOwnerTypeId(),\n\t\t\t\t\t\t\"OWNER_ID\": this._manager.getOwnerId(),\n\t\t\t\t\t}\n\t\t\t}\n\t\t).load(BX.delegate(this.onItemsLoad, this));\n\t}\n\n\taddItem(item: Item, index): void\n\t{\n\t\tsuper.addItem(item, index);\n\n\t\tif (item instanceof CompatibleItem)\n\t\t{\n\t\t\titem._isFixed = true;\n\t\t}\n\t}\n\n\tgetItemClassName()\n\t{\n\t\treturn 'crm-entity-stream-section crm-entity-stream-section-history crm-entity-stream-section-top-fixed';\n\t}\n\n\tgetStreamType(): number\n\t{\n\t\treturn StreamType.pinned;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tlet self = new FixedHistory();\n\t\tself.initialize(id, settings);\n\t\tthis.instances[self.getId()] = self;\n\t\treturn self;\n\t}\n}\n\nFixedHistory.instances = {};\n","import {Type, Loc, clone, ajax} from 'main.core';\nimport Stream from './stream';\nimport Fasten from \"./animations/fasten\";\nimport CompatibleItem from \"./items/compatible-item\";\n\ndeclare type PullActionProcessorMessage = {\n\taction: string,\n\titem: Object,\n\tstream: string,\n\tid: string,\n\tparams: Object | null,\n};\n\ndeclare type PullActionProcessorProps = {\n\tscheduleStream: Stream,\n\tfixedHistoryStream: Stream,\n\thistoryStream: Stream,\n\townerTypeId: number,\n\townerId: number,\n};\n\nexport default class PullActionProcessor\n{\n\t#scheduleStream: Stream = null;\n\t#fixedHistoryStream: Stream = null;\n\t#historyStream: Stream = null;\n\n\t#itemsQueue = [];\n\t#itemsQueueProcessing = false;\n\n\t#reloadingMessagesQueue: PullActionProcessorMessage[] = [];\n\n\t#ownerTypeId: number;\n\t#ownerId: number;\n\n\tconstructor(params: PullActionProcessorProps)\n\t{\n\t\tif (\n\t\t\t!Type.isObject(params.scheduleStream)\n\t\t\t|| !Type.isObject(params.fixedHistoryStream)\n\t\t\t|| !Type.isObject(params.historyStream)\n\t\t)\n\t\t{\n\t\t\tthrow new Error(`params scheduleStream, fixedHistoryStream and historyStream are required`);\n\t\t}\n\n\t\tif (!Type.isNumber(params.ownerTypeId) || !Type.isNumber(params.ownerId))\n\t\t{\n\t\t\tthrow new Error('params ownerTypeId and ownerId are required');\n\t\t}\n\n\t\tthis.#scheduleStream = params.scheduleStream;\n\t\tthis.#fixedHistoryStream = params.fixedHistoryStream;\n\t\tthis.#historyStream = params.historyStream;\n\t\tthis.#ownerTypeId = params.ownerTypeId;\n\t\tthis.#ownerId = params.ownerId;\n\t}\n\n\tprocessAction(actionParams: PullActionProcessorMessage): void\n\t{\n\t\tif (this.#itemDataShouldBeReloaded(actionParams))\n\t\t{\n\t\t\tthis.#reloadingMessagesQueue.push(actionParams);\n\t\t\tthis.#fetchItems();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.#addToQueue(actionParams);\n\t\t}\n\t}\n\n\t#itemDataShouldBeReloaded(actionParams: PullActionProcessorMessage)\n\t{\n\t\tconst { item } = actionParams;\n\n\t\tif (!item)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst appLanguage = Loc.getMessage('LANGUAGE_ID').toLowerCase();\n\t\tconst languageId = BX.prop.getString(item, 'languageId', appLanguage).toLowerCase();\n\t\tconst canBeReloaded = BX.prop.getBoolean(item, 'canBeReloaded', true);\n\n\t\treturn (languageId !== appLanguage) && canBeReloaded;\n\t}\n\n\t#addToQueue(actionParams: PullActionProcessorMessage)\n\t{\n\t\tthis.#itemsQueue.push(actionParams);\n\t\tif (!this.#itemsQueueProcessing)\n\t\t{\n\t\t\tthis.#processQueueItem();\n\t\t}\n\t}\n\n\t#processQueueItem(): void\n\t{\n\t\tif (!this.#itemsQueue.length)\n\t\t{\n\t\t\tthis.#itemsQueueProcessing = false;\n\n\t\t\treturn;\n\t\t}\n\t\tthis.#itemsQueueProcessing = true;\n\t\tconst actionParams = this.#itemsQueue.shift();\n\n\t\tconst stream = this.#getStreamByName(actionParams.stream);\n\n\t\tconst promises = [];\n\t\tswitch (actionParams.action)\n\t\t{\n\t\t\tcase 'add':\n\t\t\t\tpromises.push(this.#addItem(actionParams.id, actionParams.item, stream));\n\t\t\t\tbreak;\n\t\t\tcase 'update':\n\t\t\t\tpromises.push(this.#updateItem(actionParams.id, actionParams.item, stream, false, true));\n\t\t\t\tif (stream.isHistoryStream())\n\t\t\t\t{\n\t\t\t\t\t// fixed history stream can contain the same item as a history stream, so both should be updated:\n\t\t\t\t\tpromises.push(this.#updateItem(actionParams.id, actionParams.item, this.#fixedHistoryStream, false, true));\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'delete':\n\t\t\t\tpromises.push(this.#deleteItem(actionParams.id, stream));\n\t\t\t\tif (stream.isHistoryStream())\n\t\t\t\t{\n\t\t\t\t\t// fixed history stream can contain the same item as a history stream, so both should be updated:\n\t\t\t\t\tpromises.push(this.#deleteItem(actionParams.id, this.#fixedHistoryStream));\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'move':\n\t\t\t\t// move item from one stream to another one:\n\t\t\t\tconst sourceStream = this.#getStreamByName(actionParams.params.fromStream);\n\t\t\t\tpromises.push(this.#moveItem(actionParams.params.fromId, sourceStream, actionParams.id, stream, actionParams.item));\n\t\t\t\tbreak;\n\t\t\tcase 'changePinned':\n\t\t\t\t// pin or unpin item\n\t\t\t\tif (this.#getStreamByName(actionParams.params.fromStream).isHistoryStream())\n\t\t\t\t{\n\t\t\t\t\tpromises.push(this.#pinItem(actionParams.id, actionParams.item));\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tpromises.push(this.#unpinItem(actionParams.id, actionParams.item));\n\t\t\t\t}\n\t\t}\n\n\t\tPromise.all(promises).then(() => {\n\t\t\tthis.#processQueueItem();\n\t\t})\n\t}\n\n\t#addItem(id: number, itemData: Object, stream: Stream): Promise\n\t{\n\t\tconst existedStreamItem = stream.findItemById(id);\n\t\tif (existedStreamItem)\n\t\t{\n\t\t\treturn Promise.resolve();\n\t\t}\n\t\tconst streamItem = stream.createItem(itemData);\n\t\tif (!streamItem)\n\t\t{\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\tconst index = stream.calculateItemIndex(streamItem);\n\t\tconst anchor = stream.createAnchor(index);\n\t\tstream.addItem(streamItem, index);\n\t\tstreamItem.layout({anchor: anchor});\n\t\treturn stream.animateItemAdding(streamItem);\n\t}\n\n\t#updateItem(id: number, itemData: Object, stream: Stream, animateUpdate: boolean = true, animateMove: true): Promise\n\t{\n\t\tconst isDone = BX.prop.getString(itemData['ASSOCIATED_ENTITY'], 'COMPLETED') === 'Y';\n\t\tconst existedStreamItem = stream.findItemById(id);\n\t\tif (!existedStreamItem)\n\t\t{\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\tif (existedStreamItem instanceof CompatibleItem && isDone)\n\t\t{\n\t\t\texistedStreamItem._existedStreamItemDeadLine = existedStreamItem.getDeadline();\n\t\t}\n\n\t\texistedStreamItem.setData(itemData);\n\t\treturn stream.refreshItem(existedStreamItem, animateUpdate, animateMove);\n\t}\n\n\t#deleteItem(id: number, stream: Stream): Promise\n\t{\n\t\tconst item = stream.findItemById(id);\n\t\tif (item)\n\t\t{\n\t\t\treturn stream.deleteItemAnimated(item);\n\t\t}\n\n\t\treturn Promise.resolve();\n\t}\n\n\t#moveItem(sourceId: string, sourceStream: Stream, destinationId: string, destinationStream: Stream, destinationItemData: Object): Promise\n\t{\n\t\tconst sourceItem = sourceStream.findItemById(sourceId);\n\t\tif (!sourceItem)\n\t\t{\n\t\t\treturn this.#addItem(destinationId, destinationItemData, destinationStream);\n\t\t}\n\n\t\tconst existedDestinationItem = destinationStream.findItemById(destinationId);\n\t\tif (sourceItem && existedDestinationItem)\n\t\t{\n\t\t\treturn this.#deleteItem(sourceId, sourceStream);\n\t\t}\n\n\t\tconst destinationItem = destinationStream.createItem(destinationItemData);\n\t\tdestinationStream.addItem(destinationItem, destinationStream.calculateItemIndex(destinationItem));\n\t\tdestinationItem.layout({ add: false });\n\n\t\treturn sourceStream.moveItemToStream(sourceItem, destinationStream, destinationItem);\n\t}\n\n\t#pinItem(id: number, itemData: Object): Promise\n\t{\n\t\tif (this.#fixedHistoryStream.findItemById(id))\n\t\t{\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\tconst historyItem = this.#historyStream.findItemById(id);\n\t\tif (!historyItem) // fixed history item does not exist into history items stream, so just add to fixed history stream\n\t\t{\n\t\t\treturn this.#addItem(id, itemData, this.#fixedHistoryStream);\n\t\t}\n\t\tif (historyItem instanceof CompatibleItem)\n\t\t{\n\t\t\thistoryItem.onSuccessFasten();\n\n\t\t\treturn Promise.resolve();\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn this.#updateItem(id, itemData, this.#historyStream, false, false).then(() => {\n\t\t\t\tconst fixedHistoryItem = this.#fixedHistoryStream.createItem(itemData);\n\t\t\t\tthis.#fixedHistoryStream.addItem(fixedHistoryItem, 0);\n\t\t\t\tfixedHistoryItem.layout({ add: false });\n\n\t\t\t\treturn new Promise((resolve) => {\n\t\t\t\t\tconst animation = Fasten.create(\n\t\t\t\t\t\t'',\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tinitialItem: historyItem,\n\t\t\t\t\t\t\tfinalItem: fixedHistoryItem,\n\t\t\t\t\t\t\tanchor: this.#fixedHistoryStream.getAnchor(),\n\t\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\t\tcomplete: resolve,\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t\tanimation.run();\n\t\t\t\t})\n\t\t\t});\n\t\t}\n\t}\n\n\t#unpinItem(id: number, itemData: Object): Promise\n\t{\n\t\tconst fixedHistoryItem = this.#fixedHistoryStream.findItemById(id);\n\t\tif (fixedHistoryItem instanceof CompatibleItem)\n\t\t{\n\t\t\tfixedHistoryItem.onSuccessUnfasten();\n\n\t\t\treturn Promise.resolve();\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn this.#updateItem(id, itemData, this.#historyStream, false, false).then(() => {\n\t\t\t\treturn this.#deleteItem(id, this.#fixedHistoryStream);\n\t\t\t});\n\t\t}\n\t}\n\n\t#getStreamByName(streamName): Stream\n\t{\n\t\tswitch (streamName)\n\t\t{\n\t\t\tcase 'scheduled':\n\t\t\t\treturn this.#scheduleStream;\n\t\t\tcase 'fixedHistory':\n\t\t\t\treturn this.#fixedHistoryStream;\n\t\t\tcase 'history':\n\t\t\t\treturn this.#historyStream;\n\t\t}\n\n\t\tthrow new Error(`Stream \"${streamName}\" not found`);\n\t}\n\n\t#fetchItems()\n\t{\n\t\tsetTimeout(() => {\n\n\t\t\tconst messages = clone(this.#reloadingMessagesQueue);\n\t\t\tthis.#reloadingMessagesQueue = [];\n\n\t\t\tconst activityIds = [];\n\t\t\tconst historyIds = [];\n\n\t\t\tmessages.forEach(message => {\n\t\t\t\tconst container = message.stream === 'scheduled' ? activityIds : historyIds;\n\t\t\t\tcontainer.push(message.id);\n\t\t\t});\n\n\t\t\tif (messages.length)\n\t\t\t{\n\t\t\t\tconst data = {\n\t\t\t\t\tactivityIds,\n\t\t\t\t\thistoryIds,\n\t\t\t\t\townerTypeId: this.#ownerTypeId,\n\t\t\t\t\townerId: this.#ownerId,\n\t\t\t\t};\n\n\t\t\t\tajax.runAction('crm.timeline.item.load', { data })\n\t\t\t\t\t.then(response => {\n\t\t\t\t\t\tmessages.forEach(message => {\n\t\t\t\t\t\t\tif (response.data[message.id])\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tmessage.item = response.data[message.id];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tthis.#addToQueue(message);\n\t\t\t\t\t\t})\n\t\t\t\t\t})\n\t\t\t\t\t.catch(err => {\n\t\t\t\t\t\tconsole.error(err);\n\t\t\t\t\t\tmessages.forEach(message => this.#addToQueue(message));\n\t\t\t\t\t});\n\t\t\t}\n\n\t\t}, 1500);\n\t}\n}\n","import Wait from \"./editors/wait\";\nimport Sms from \"./editors/sms\";\nimport Rest from \"./editors/rest\";\nimport Comment from \"./editors/comment\";\nimport ToDo from \"./editors/todo\";\nimport Scheduled from \"./items/scheduled\";\nimport {Item} from \"crm.timeline.item\";\nimport Document from \"./items/document\";\nimport EntityChat from \"./streams/entitychat\";\nimport MenuBar from \"./tools/menubar\";\nimport AudioPlaybackRateSelector from \"./tools/audio-playback-rate-selector\";\nimport Schedule from \"./streams/schedule\";\nimport FixedHistory from \"./streams/fixedhistory\";\nimport History from \"./streams/history\";\nimport Expand from \"./animations/expand\";\nimport PullActionProcessor from './pull-action-processor'\n\n/** @memberof BX.Crm.Timeline */\nexport default class Manager\n{\n\t#itemPullActionProcessor: PullActionProcessor = null;\n\n\tconstructor()\n\t{\n\t\tthis._id = \"\";\n\t\tthis._settings = {};\n\t\tthis._container = null;\n\t\tthis._ownerTypeId = 0;\n\t\tthis._ownerId = 0;\n\t\tthis._ownerInfo = null;\n\t\tthis._progressSemantics = \"\";\n\n\t\tthis._commentEditor = null;\n\t\tthis._todoEditor = null;\n\t\tthis._waitEditor = null;\n\t\tthis._smsEditor = null;\n\t\tthis._zoomEditor = null;\n\t\tthis._chat = null;\n\t\tthis._schedule = null;\n\t\tthis._history = null;\n\t\tthis._fixedHistory = null;\n\t\tthis._activityEditor = null;\n\t\tthis._menuBar = null;\n\n\t\tthis._userId = 0;\n\t\tthis._readOnly = false;\n\t\tthis._currentUser = null;\n\t\tthis._pullTagName = \"\";\n\t}\n\n\tinitialize(id, settings)\n\t{\n\t\tthis._id = BX.type.isNotEmptyString(id) ? id : BX.util.getRandomString(4);\n\t\tthis._settings = settings ? settings : {};\n\n\t\tthis._ownerTypeId = parseInt(this.getSetting(\"ownerTypeId\"));\n\t\tthis._ownerId = parseInt(this.getSetting(\"ownerId\"));\n\t\tthis._ownerInfo = this.getSetting(\"ownerInfo\");\n\t\tthis._progressSemantics = BX.prop.getString(this._settings, \"progressSemantics\", \"\");\n\t\tthis._spotlightFastenShowed = this.getSetting(\"spotlightFastenShowed\", true);\n\t\tthis._audioPlaybackRate = parseFloat(this.getSetting(\"audioPlaybackRate\", 1));\n\t\tconst containerId = this.getSetting(\"containerId\");\n\t\tif (!BX.type.isNotEmptyString(containerId))\n\t\t{\n\t\t\tthrow \"Manager. A required parameter 'containerId' is missing.\";\n\t\t}\n\n\t\tthis._container = BX(containerId);\n\t\tif (!BX.type.isElementNode(this._container))\n\t\t{\n\t\t\tthrow \"Manager. Container node is not found.\";\n\t\t}\n\t\tthis._editorContainer = BX(this.getSetting(\"editorContainer\"));\n\n\t\tthis._userId = BX.prop.getInteger(this._settings, \"userId\", 0);\n\t\tthis._readOnly = BX.prop.getBoolean(this._settings, \"readOnly\", false);\n\t\tthis._currentUser = BX.prop.getObject(this._settings, \"currentUser\", null);\n\n\t\tconst activityEditorId = this.getSetting(\"activityEditorId\");\n\t\tif (BX.type.isNotEmptyString(activityEditorId))\n\t\t{\n\t\t\tthis._activityEditor = BX.CrmActivityEditor.items[activityEditorId];\n\t\t\tif (!(this._activityEditor instanceof BX.CrmActivityEditor))\n\t\t\t{\n\t\t\t\tthrow \"BX.CrmTimeline. Activity editor instance is not found.\";\n\t\t\t}\n\t\t}\n\n\t\tconst ajaxId = this.getSetting(\"ajaxId\");\n\t\tconst currentUrl = this.getSetting(\"currentUrl\");\n\t\tconst serviceUrl = this.getSetting(\"serviceUrl\");\n\n\t\tthis._chat = EntityChat.create(\n\t\t\tthis._id,\n\t\t\t{\n\t\t\t\tmanager: this,\n\t\t\t\tcontainer: this._container,\n\t\t\t\tdata: this.getSetting(\"chatData\"),\n\t\t\t\tisStubMode: this._ownerId <= 0,\n\t\t\t\treadOnly: this._readOnly\n\t\t\t}\n\t\t);\n\n\t\tthis._schedule = Schedule.create(\n\t\t\tthis._id,\n\t\t\t{\n\t\t\t\tmanager: this,\n\t\t\t\tcontainer: this._container,\n\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\titemData: this.getSetting(\"scheduleData\"),\n\t\t\t\ttemplates: this.getSetting(\"templates\"),\n\t\t\t\tisStubMode: this._ownerId <= 0,\n\t\t\t\tajaxId: ajaxId,\n\t\t\t\tserviceUrl: serviceUrl,\n\t\t\t\tcurrentUrl: currentUrl,\n\t\t\t\tuserId: this._userId,\n\t\t\t\treadOnly: this._readOnly\n\t\t\t}\n\t\t);\n\n\t\tthis._fixedHistory = FixedHistory.create(\n\t\t\tthis._id,\n\t\t\t{\n\t\t\t\tmanager: this,\n\t\t\t\tcontainer: this._container,\n\t\t\t\teditorContainer: this._editorContainer,\n\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\titemData: this.getSetting(\"fixedData\"),\n\t\t\t\ttemplates: this.getSetting(\"templates\"),\n\t\t\t\tisStubMode: this._ownerId <= 0,\n\t\t\t\tajaxId: ajaxId,\n\t\t\t\tserviceUrl: serviceUrl,\n\t\t\t\tcurrentUrl: currentUrl,\n\t\t\t\tuserId: this._userId,\n\t\t\t\treadOnly: this._readOnly\n\t\t\t}\n\t\t);\n\n\t\tthis._history = History.create(\n\t\t\tthis._id,\n\t\t\t{\n\t\t\t\tmanager: this,\n\t\t\t\tcontainer: this._container,\n\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\titemData: this.getSetting(\"historyData\"),\n\t\t\t\ttemplates: this.getSetting(\"templates\"),\n\t\t\t\tnavigation: this.getSetting(\"historyNavigation\", {}),\n\t\t\t\tfilterId: BX.prop.getString(this._settings, \"historyFilterId\", this._id),\n\t\t\t\tisFilterApplied: BX.prop.getBoolean(this._settings, \"isHistoryFilterApplied\", false),\n\t\t\t\tisStubMode: this._ownerId <= 0,\n\t\t\t\tajaxId: ajaxId,\n\t\t\t\tserviceUrl: serviceUrl,\n\t\t\t\tcurrentUrl: currentUrl,\n\t\t\t\tuserId: this._userId,\n\t\t\t\treadOnly: this._readOnly\n\t\t\t}\n\t\t);\n\t\tthis._schedule.setHistory(this._history);\n\t\tthis._fixedHistory.setHistory(this._history);\n\n\t\tvar isTodoEnabled = BX.prop.getBoolean(this._settings, 'enableTodo', false);\n\t\tthis._commentEditor = Comment.create(\n\t\t\tthis._id,\n\t\t\t{\n\t\t\t\tmanager: this,\n\t\t\t\townerTypeId: this._ownerTypeId,\n\t\t\t\townerId: this._ownerId,\n\t\t\t\tserviceUrl: this.getSetting(\"serviceUrl\"),\n\t\t\t\tcontainer: this.getSetting(\"editorCommentContainer\"),\n\t\t\t\tinput: this.getSetting(\"editorCommentInput\"),\n\t\t\t\teditorName: this.getSetting(\"editorCommentEditorName\"),\n\t\t\t\tbutton: this.getSetting(\"editorCommentButton\"),\n\t\t\t\tcancelButton: this.getSetting(\"editorCommentCancelButton\")\n\t\t\t}\n\t\t);\n\t\tthis._commentEditor.setVisible(!isTodoEnabled && !this._readOnly);\n\t\tthis._commentEditor.setHistory(this._history);\n\n\t\tif (isTodoEnabled)\n\t\t{\n\t\t\tthis._todoEditor = ToDo.create(\n\t\t\t\tthis._id,\n\t\t\t\t{\n\t\t\t\t\tmanager: this,\n\t\t\t\t\townerTypeId: this._ownerTypeId,\n\t\t\t\t\townerId: this._ownerId,\n\t\t\t\t\tcontainer: this.getSetting(\"editorTodoContainer\"),\n\t\t\t\t\tbutton: this.getSetting(\"editorTodoButton\"),\n\t\t\t\t\tcancelButton: this.getSetting(\"editorTodoCancelButton\")\n\t\t\t\t}\n\t\t\t);\n\t\t\tthis._todoEditor.setVisible(!this._readOnly);\n\t\t}\n\n\t\tif (BX.prop.getBoolean(this._settings, \"enableWait\", false))\n\t\t{\n\t\t\tthis._waitEditor = Wait.create(\n\t\t\t\tthis._id,\n\t\t\t\t{\n\t\t\t\t\tmanager: this,\n\t\t\t\t\townerTypeId: this._ownerTypeId,\n\t\t\t\t\townerId: this._ownerId,\n\t\t\t\t\tserviceUrl: this.getSetting(\"serviceUrl\"),\n\t\t\t\t\tconfig: this.getSetting(\"editorWaitConfig\", {}),\n\t\t\t\t\ttargetDates: this.getSetting(\"editorWaitTargetDates\", []),\n\t\t\t\t\tcontainer: this.getSetting(\"editorWaitContainer\"),\n\t\t\t\t\tconfigContainer: this.getSetting(\"editorWaitConfigContainer\"),\n\t\t\t\t\tinput: this.getSetting(\"editorWaitInput\"),\n\t\t\t\t\tbutton: this.getSetting(\"editorWaitButton\"),\n\t\t\t\t\tcancelButton: this.getSetting(\"editorWaitCancelButton\")\n\t\t\t\t}\n\t\t\t);\n\t\t\tthis._waitEditor.setVisible(false);\n\t\t}\n\n\t\tif (BX.prop.getBoolean(this._settings, \"enableSms\", false))\n\t\t{\n\t\t\tthis._smsEditor = Sms.create(\n\t\t\t\tthis._id,\n\t\t\t\t{\n\t\t\t\t\tmanager: this,\n\t\t\t\t\townerTypeId: this._ownerTypeId,\n\t\t\t\t\townerId: this._ownerId,\n\t\t\t\t\tserviceUrl: this.getSetting(\"serviceUrl\"),\n\t\t\t\t\tconfig: this.getSetting(\"editorSmsConfig\", {}),\n\t\t\t\t\tcontainer: this.getSetting(\"editorSmsContainer\"),\n\t\t\t\t\tinput: this.getSetting(\"editorSmsInput\"),\n\t\t\t\t\ttemplatesContainer: this.getSetting(\"editorSmsTemplatesContainer\"),\n\t\t\t\t\tbutton: this.getSetting(\"editorSmsButton\"),\n\t\t\t\t\tcancelButton: this.getSetting(\"editorSmsCancelButton\")\n\t\t\t\t}\n\t\t\t);\n\t\t\tthis._smsEditor.setVisible(false);\n\t\t}\n\n\t\tif (BX.prop.getBoolean(this._settings, \"enableZoom\", false) && BX.prop.getBoolean(this._settings, \"statusZoom\", false))\n\t\t{\n\t\t\tthis._zoomEditor = new BX.Crm.Zoom(\n\t\t\t\t{\n\t\t\t\t\tid: this._id,\n\t\t\t\t\tmanager: this,\n\t\t\t\t\townerTypeId: this._ownerTypeId,\n\t\t\t\t\townerId: this._ownerId,\n\t\t\t\t\tcontainer: this.getSetting(\"editorZoomContainer\"),\n\t\t\t\t\tuserId: this._userId\n\t\t\t\t}\n\t\t\t);\n\t\t\tthis._zoomEditor.setVisible(false);\n\t\t}\n\n\t\tif (BX.prop.getBoolean(this._settings, \"enableRest\", false))\n\t\t{\n\t\t\tthis._restEditor = Rest.create(\n\t\t\t\tthis._id,\n\t\t\t\t{\n\t\t\t\t\tmanager: this,\n\t\t\t\t\townerTypeId: this._ownerTypeId,\n\t\t\t\t\townerId: this._ownerId,\n\t\t\t\t\tplacement: BX.prop.getString(this._settings, \"restPlacement\", '')\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\tthis._chat.layout();\n\t\tthis._schedule.layout();\n\t\tthis._fixedHistory.layout();\n\t\tthis._history.layout();\n\n\t\tthis._pullTagName = BX.prop.getString(this._settings, \"pullTagName\", \"\");\n\t\tif (this._pullTagName !== \"\")\n\t\t{\n\t\t\tBX.addCustomEvent(\"onPullEvent-crm\", BX.delegate(this.onPullEvent, this));\n\t\t\tthis.extendWatch();\n\t\t\tthis.#itemPullActionProcessor = new PullActionProcessor({\n\t\t\t\tscheduleStream: this._schedule,\n\t\t\t\tfixedHistoryStream: this._fixedHistory,\n\t\t\t\thistoryStream: this._history,\n\t\t\t\townerTypeId: this._ownerTypeId,\n\t\t\t\townerId: this._ownerId,\n\t\t\t});\n\t\t}\n\t\tthis._menuBar = MenuBar.create(\n\t\t\tthis._id,\n\t\t\t{\n\t\t\t\tcontainer: BX(this.getSetting(\"menuBarContainer\")),\n\t\t\t\tmenuId: this.getSetting(\"menuBarObjectId\"),\n\t\t\t\townerInfo: this._ownerInfo,\n\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\tcommentEditor: this._commentEditor,\n\t\t\t\ttodoEditor: this._todoEditor,\n\t\t\t\twaitEditor: this._waitEditor,\n\t\t\t\tsmsEditor: this._smsEditor,\n\t\t\t\tzoomEditor: this._zoomEditor,\n\t\t\t\trestEditor: this._restEditor,\n\t\t\t\treadOnly: this._readOnly,\n\t\t\t\tmanager: this\n\t\t\t}\n\t\t);\n\n\t\tif (!this._readOnly)\n\t\t{\n\t\t\tthis._menuBar.reset();\n\t\t}\n\n\t\tBX.addCustomEvent(window, \"Crm.EntityProgress.Change\", BX.delegate(this.onEntityProgressChange, this));\n\t\tBX.ready(function () {\n\t\t\twindow.addEventListener(\"scroll\", BX.throttle(function () {\n\t\t\t\tBX.LazyLoad.onScroll();\n\t\t\t}, 80));\n\t\t});\n\t}\n\n\textendWatch()\n\t{\n\t\tif (BX.type.isFunction(BX.PULL) && this._pullTagName !== \"\")\n\t\t{\n\t\t\tBX.PULL.extendWatch(this._pullTagName);\n\t\t\twindow.setTimeout(BX.delegate(this.extendWatch, this), 60000);\n\t\t}\n\t}\n\n\tonPullEvent(command, params)\n\t{\n\t\tif (this._pullTagName !== BX.prop.getString(params, \"TAG\", \"\"))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (command === 'timeline_item_action')\n\t\t{\n\t\t\tthis.#itemPullActionProcessor.processAction(params);\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (command === \"timeline_chat_create\")\n\t\t{\n\t\t\tthis.processChatCreate(params);\n\t\t}\n\t\telse if (command === \"timeline_activity_add\")\n\t\t{\n\t\t\tthis.processActivityExternalAdd(params);\n\t\t}\n\t\telse if (command === \"timeline_activity_update\")\n\t\t{\n\t\t\tthis.processActivityExternalUpdate(params);\n\t\t}\n\t\telse if (command === \"timeline_activity_delete\")\n\t\t{\n\t\t\tthis.processActivityExternalDelete(params);\n\t\t}\n\t\telse if (command === \"timeline_comment_add\")\n\t\t{\n\t\t\tthis.processCommentExternalAdd(params);\n\t\t}\n\t\telse if (command === \"timeline_comment_update\")\n\t\t{\n\t\t\tthis.processCommentExternalUpdate(params);\n\t\t}\n\t\telse if (command === \"timeline_comment_delete\")\n\t\t{\n\t\t\tthis.processCommentExternalDelete(params);\n\t\t}\n\t\telse if (command === \"timeline_changed_binding\")\n\t\t{\n\t\t\tthis.processChangeBinding(params);\n\t\t}\n\t\telse if (command === \"timeline_item_update\")\n\t\t{\n\t\t\tthis.processItemExternalUpdate(params);\n\t\t}\n\t\telse if (command === \"timeline_wait_add\")\n\t\t{\n\t\t\tthis.processWaitExternalAdd(params);\n\t\t}\n\t\telse if (command === \"timeline_wait_update\")\n\t\t{\n\t\t\tthis.processWaitExternalUpdate(params);\n\t\t}\n\t\telse if (command === \"timeline_wait_delete\")\n\t\t{\n\t\t\tthis.processWaitExternalDelete(params);\n\t\t}\n\t\telse if (command === \"timeline_bizproc_status\")\n\t\t{\n\t\t\tthis.processBizprocStatus(params);\n\t\t}\n\t\telse if (command === \"timeline_scoring_add\")\n\t\t{\n\t\t\tthis.processScoringExternalAdd(params);\n\t\t}\n\t}\n\n\tprocessChatCreate(params)\n\t{\n\t\tif (this._chat)\n\t\t{\n\t\t\tthis._chat.setData(BX.prop.getObject(params, \"CHAT_DATA\", {}));\n\t\t\tthis._chat.refreshLayout();\n\t\t}\n\t}\n\n\tprocessActivityExternalAdd(params)\n\t{\n\t\tlet entityData, scheduleItemData, historyItemData, scheduleItem, historyItem;\n\n\t\tentityData = BX.prop.getObject(params, \"ENTITY\", null);\n\t\tscheduleItemData = BX.prop.getObject(params, \"SCHEDULE_ITEM\", null);\n\t\thistoryItemData = BX.prop.getObject(params, \"HISTORY_ITEM\", null);\n\n\n\t\tif (entityData && historyItemData && !BX.type.isPlainObject(historyItemData[\"ASSOCIATED_ENTITY\"]))\n\t\t{\n\t\t\thistoryItemData[\"ASSOCIATED_ENTITY\"] = entityData;\n\t\t}\n\n\t\tif (scheduleItemData !== null && this._schedule.getItemByData(scheduleItemData) === null)\n\t\t{\n\t\t\tscheduleItem = this.addScheduleItem(scheduleItemData);\n\t\t\tscheduleItem.addWrapperClass(\"crm-entity-stream-section-updated\", 1000);\n\t\t}\n\n\t\tif (historyItemData !== null)\n\t\t{\n\t\t\thistoryItem = this._history.findItemById(BX.prop.getString(historyItemData, \"ID\"));\n\t\t\tif (!historyItem)\n\t\t\t{\n\t\t\t\thistoryItem = this.addHistoryItem(historyItemData);\n\t\t\t\tExpand.create(historyItem.getWrapper(), null).run();\n\t\t\t}\n\t\t}\n\t}\n\n\tprocessActivityExternalUpdate(params)\n\t{\n\t\tlet entityData, scheduleItemData, scheduleItem, historyItemData, historyItem, fixedHistoryItem;\n\n\t\tentityData = BX.prop.getObject(params, \"ENTITY\", null);\n\t\tscheduleItemData = BX.prop.getObject(params, \"SCHEDULE_ITEM\", null);\n\t\thistoryItemData = BX.prop.getObject(params, \"HISTORY_ITEM\", null);\n\n\t\tif (entityData)\n\t\t{\n\t\t\tif (historyItemData && !BX.type.isPlainObject(historyItemData[\"ASSOCIATED_ENTITY\"]))\n\t\t\t{\n\t\t\t\thistoryItemData[\"ASSOCIATED_ENTITY\"] = entityData;\n\t\t\t}\n\n\t\t\tconst entityId = BX.prop.getInteger(entityData, \"ID\", 0);\n\t\t\tconst historyItems = this._history.getItemsByAssociatedEntity(BX.CrmEntityType.enumeration.activity, entityId);\n\t\t\tfor (let i = 0, length = historyItems.length; i < length; i++)\n\t\t\t{\n\t\t\t\thistoryItem = historyItems[i];\n\t\t\t\thistoryItem.setAssociatedEntityData(entityData);\n\t\t\t\thistoryItem.refreshLayout();\n\t\t\t}\n\t\t\tconst fixedHistoryItems = this._fixedHistory.getItemsByAssociatedEntity(BX.CrmEntityType.enumeration.activity, entityId);\n\t\t\tfor (let i = 0, length = fixedHistoryItems.length; i < length; i++)\n\t\t\t{\n\t\t\t\tfixedHistoryItem = fixedHistoryItems[i];\n\t\t\t\tfixedHistoryItem.setAssociatedEntityData(entityData);\n\t\t\t\tfixedHistoryItem.refreshLayout();\n\t\t\t}\n\t\t}\n\n\t\tif (scheduleItemData !== null)\n\t\t{\n\t\t\tscheduleItem = this._schedule.getItemByAssociatedEntity(\n\t\t\t\tBX.CrmEntityType.enumeration.activity,\n\t\t\t\tBX.prop.getInteger(scheduleItemData, \"ASSOCIATED_ENTITY_ID\")\n\t\t\t);\n\n\t\t\tif (scheduleItem)\n\t\t\t{\n\t\t\t\tscheduleItem.setData(scheduleItemData);\n\t\t\t\tif (!scheduleItem.isDone())\n\t\t\t\t{\n\t\t\t\t\tthis._schedule.refreshItem(scheduleItem);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tif (historyItemData)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis._schedule.transferItemToHistory(\n\t\t\t\t\t\t\tscheduleItem,\n\t\t\t\t\t\t\thistoryItemData\n\t\t\t\t\t\t);\n\t\t\t\t\t\t//History data are already processed\n\t\t\t\t\t\thistoryItemData = null;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis._schedule.deleteItem(scheduleItem);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (!Scheduled.isDone(scheduleItemData))\n\t\t\t{\n\t\t\t\tscheduleItem = this.addScheduleItem(scheduleItemData);\n\t\t\t\tscheduleItem.addWrapperClass(\"crm-entity-stream-section-updated\", 1000);\n\t\t\t}\n\t\t}\n\n\t\tif (historyItemData !== null)\n\t\t{\n\t\t\thistoryItem = this._history.findItemById(BX.prop.getString(historyItemData, \"ID\"));\n\t\t\tif (!historyItem)\n\t\t\t{\n\t\t\t\thistoryItem = this.addHistoryItem(historyItemData);\n\t\t\t\tExpand.create(historyItem.getWrapper(), null).run();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\thistoryItem.setData(historyItemData);\n\t\t\t\thistoryItem.refreshLayout();\n\t\t\t\tfixedHistoryItem = this._fixedHistory.findItemById(BX.prop.getString(historyItemData, \"ID\"));\n\t\t\t\tif (fixedHistoryItem)\n\t\t\t\t{\n\t\t\t\t\tfixedHistoryItem.setData(historyItemData);\n\t\t\t\t\tfixedHistoryItem.refreshLayout()\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprocessActivityExternalDelete(params)\n\t{\n\t\tconst entityId = BX.prop.getInteger(params, \"ENTITY_ID\", 0);\n\t\tconst historyItems = this._history.getItemsByAssociatedEntity(BX.CrmEntityType.enumeration.activity, entityId);\n\t\tfor (let i = 0, length = historyItems.length; i < length; i++)\n\t\t{\n\t\t\tthis._history.deleteItem(historyItems[i]);\n\t\t}\n\n\t\tconst fixedHistoryItems = this._fixedHistory.getItemsByAssociatedEntity(BX.CrmEntityType.enumeration.activity, entityId);\n\t\tfor (let i = 0, length = fixedHistoryItems.length; i < length; i++)\n\t\t{\n\t\t\tthis._fixedHistory.deleteItem(fixedHistoryItems[i]);\n\t\t}\n\n\t\tconst scheduleItem = this._schedule.getItemByAssociatedEntity(BX.CrmEntityType.enumeration.activity, entityId);\n\t\tif (scheduleItem)\n\t\t{\n\t\t\tthis._schedule.deleteItem(scheduleItem);\n\t\t}\n\t}\n\n\tprocessCommentExternalAdd(params)\n\t{\n\t\tlet historyItemData, historyItem;\n\t\thistoryItemData = BX.prop.getObject(params, \"HISTORY_ITEM\", null);\n\t\tif (historyItemData !== null)\n\t\t{\n\t\t\twindow.setTimeout(\n\t\t\t\tBX.delegate(function () {\n\t\t\t\t\tif (!this._history.findItemById(historyItemData['ID']))\n\t\t\t\t\t{\n\t\t\t\t\t\thistoryItem = this.addHistoryItem(historyItemData);\n\t\t\t\t\t\tExpand.create(historyItem.getWrapper(), null).run();\n\t\t\t\t\t}\n\t\t\t\t}, this),\n\t\t\t\t1500\n\t\t\t);\n\t\t}\n\t}\n\n\tprocessCommentExternalUpdate(params)\n\t{\n\t\tconst entityId = BX.prop.getInteger(params, \"ENTITY_ID\", 0);\n\t\tconst historyItemData = BX.prop.getObject(params, \"HISTORY_ITEM\", null);\n\t\tconst updateItem = this._history.findItemById(entityId);\n\t\tif (updateItem instanceof Comment && historyItemData !== null)\n\t\t{\n\t\t\tupdateItem.setData(historyItemData);\n\t\t\tupdateItem.switchToViewMode();\n\t\t}\n\t\tconst updateFixedItem = this._fixedHistory.findItemById(entityId);\n\t\tif (updateFixedItem instanceof Comment && historyItemData !== null)\n\t\t{\n\t\t\tupdateFixedItem.setData(historyItemData);\n\t\t\tupdateFixedItem.switchToViewMode();\n\t\t}\n\t}\n\n\tprocessCommentExternalDelete(params)\n\t{\n\t\tconst entityId = BX.prop.getInteger(params, \"ENTITY_ID\", 0);\n\t\twindow.setTimeout(\n\t\t\tBX.delegate(function () {\n\t\t\t\tconst deleteItem = this._history.findItemById(entityId);\n\t\t\t\tif (deleteItem instanceof Comment)\n\t\t\t\t{\n\t\t\t\t\tthis._history.deleteItem(deleteItem);\n\t\t\t\t}\n\t\t\t\tconst deleteFixedItem = this._fixedHistory.findItemById(entityId);\n\t\t\t\tif (deleteFixedItem instanceof Comment)\n\t\t\t\t{\n\t\t\t\t\tthis._fixedHistory.deleteItem(deleteFixedItem);\n\t\t\t\t}\n\t\t\t}, this),\n\t\t\t1200\n\t\t);\n\t}\n\n\tprocessChangeBinding(params)\n\t{\n\t\tconst entityId = BX.prop.getString(params, \"OLD_ID\", 0);\n\t\tconst entityNewId = BX.prop.getString(params, \"NEW_ID\", 0);\n\t\tconst item = this._history.findItemById(entityId);\n\t\tif (item instanceof Item)\n\t\t{\n\t\t\titem._id = entityNewId;\n\t\t\tconst itemData = item.getData();\n\t\t\titemData.ID = entityNewId;\n\t\t\titem.setData(itemData);\n\t\t}\n\n\t\tconst fixedItem = this._fixedHistory.findItemById(entityId);\n\t\tif (fixedItem instanceof Item)\n\t\t{\n\t\t\tfixedItem._id = entityNewId;\n\t\t\tconst fixedItemData = fixedItem.getData();\n\t\t\tfixedItemData.ID = entityNewId;\n\t\t\tfixedItem.setData(fixedItemData);\n\t\t}\n\t}\n\n\tprocessItemExternalUpdate(params)\n\t{\n\t\tconst entityId = BX.prop.getInteger(params, \"ENTITY_ID\", 0);\n\t\tconst historyItemData = BX.prop.getObject(params, \"HISTORY_ITEM\", null);\n\t\tconst historyItem = this._history.findItemById(entityId);\n\t\tif (historyItem && historyItemData !== null)\n\t\t{\n\t\t\thistoryItem.setData(historyItemData);\n\t\t\thistoryItem.markAsTerminated(this._history.checkItemForTermination(historyItem));\n\t\t\thistoryItem.refreshLayout();\n\t\t\tif (historyItem.isTerminated())\n\t\t\t{\n\t\t\t\tBX.addClass(historyItem._wrapper, \"crm-entity-stream-section-last\");\n\t\t\t}\n\t\t}\n\t}\n\n\tprocessWaitExternalAdd(params)\n\t{\n\t\tconst scheduleItemData = BX.prop.getObject(params, \"SCHEDULE_ITEM\", null);\n\t\tif (scheduleItemData !== null)\n\t\t{\n\t\t\tthis.addScheduleItem(scheduleItemData);\n\t\t}\n\t}\n\n\tprocessWaitExternalUpdate(params)\n\t{\n\t\tlet entityData, scheduleItemData, scheduleItem, historyItemData, historyItem;\n\n\t\tentityData = BX.prop.getObject(params, \"ENTITY\", null);\n\t\tscheduleItemData = BX.prop.getObject(params, \"SCHEDULE_ITEM\", null);\n\t\thistoryItemData = BX.prop.getObject(params, \"HISTORY_ITEM\", null);\n\n\t\tif (entityData)\n\t\t{\n\t\t\tif (historyItemData && !BX.type.isPlainObject(historyItemData[\"ASSOCIATED_ENTITY\"]))\n\t\t\t{\n\t\t\t\thistoryItemData[\"ASSOCIATED_ENTITY\"] = entityData;\n\t\t\t}\n\n\t\t\tconst entityId = BX.prop.getInteger(entityData, \"ID\", 0);\n\t\t\tconst historyItems = this._history.getItemsByAssociatedEntity(BX.CrmEntityType.enumeration.wait, entityId);\n\t\t\tlet i = 0;\n\t\t\tconst length = historyItems.length;\n\t\t\tfor (; i < length; i++)\n\t\t\t{\n\t\t\t\thistoryItem = historyItems[i];\n\t\t\t\thistoryItem.setAssociatedEntityData(entityData);\n\t\t\t\thistoryItem.refreshLayout();\n\t\t\t}\n\t\t}\n\n\t\tif (scheduleItemData !== null)\n\t\t{\n\t\t\tscheduleItem = this._schedule.getItemByAssociatedEntity(\n\t\t\t\tBX.CrmEntityType.enumeration.wait,\n\t\t\t\tBX.prop.getInteger(scheduleItemData, \"ASSOCIATED_ENTITY_ID\")\n\t\t\t);\n\t\t\tif (!scheduleItem)\n\t\t\t{\n\t\t\t\tthis.addScheduleItem(scheduleItemData);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tscheduleItem.setData(scheduleItemData);\n\t\t\t\tif (!scheduleItem.isDone())\n\t\t\t\t{\n\t\t\t\t\tthis._schedule.refreshItem(scheduleItem);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tif (historyItemData)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis._schedule.transferItemToHistory(\n\t\t\t\t\t\t\tscheduleItem,\n\t\t\t\t\t\t\thistoryItemData\n\t\t\t\t\t\t);\n\t\t\t\t\t\t//History data are already processed\n\t\t\t\t\t\thistoryItemData = null;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis._schedule.deleteItem(scheduleItem);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (historyItemData !== null)\n\t\t{\n\t\t\thistoryItem = this._history.findItemById(BX.prop.getString(historyItemData, \"ID\"));\n\t\t\tif (!historyItem)\n\t\t\t{\n\t\t\t\thistoryItem = this.addHistoryItem(historyItemData);\n\t\t\t\tExpand.create(historyItem.getWrapper(), null).run();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\thistoryItem.setData(historyItemData);\n\t\t\t\thistoryItem.refreshLayout();\n\t\t\t}\n\t\t}\n\t}\n\n\tprocessWaitExternalDelete(params)\n\t{\n\t\tconst entityId = BX.prop.getInteger(params, \"ENTITY_ID\", 0);\n\t\tconst historyItems = this._history.getItemsByAssociatedEntity(BX.CrmEntityType.enumeration.wait, entityId);\n\t\tlet i = 0;\n\t\tconst length = historyItems.length;\n\t\tfor (; i < length; i++)\n\t\t{\n\t\t\tthis._history.deleteItem(historyItems[i]);\n\t\t}\n\n\t\tconst scheduleItem = this._schedule.getItemByAssociatedEntity(BX.CrmEntityType.enumeration.wait, entityId);\n\t\tif (scheduleItem)\n\t\t{\n\t\t\tthis._schedule.deleteItem(scheduleItem);\n\t\t}\n\t}\n\n\tprocessBizprocStatus(params)\n\t{\n\t\tlet historyItemData, historyItem;\n\n\t\thistoryItemData = BX.prop.getObject(params, \"HISTORY_ITEM\", null);\n\n\t\tif (historyItemData !== null)\n\t\t{\n\t\t\thistoryItem = this.addHistoryItem(historyItemData);\n\t\t\tExpand.create(historyItem.getWrapper(), null).run();\n\t\t}\n\t}\n\n\tprocessScoringExternalAdd(params)\n\t{\n\t\tlet historyItemData, historyItem;\n\t\thistoryItemData = BX.prop.getObject(params, \"HISTORY_ITEM\", null);\n\t\tif (historyItemData !== null)\n\t\t{\n\t\t\thistoryItem = this.addHistoryItem(historyItemData);\n\t\t\tExpand.create(historyItem.getWrapper(), null).run();\n\t\t}\n\t}\n\n\tonEntityProgressChange(sender, eventArgs)\n\t{\n\t\tif (BX.prop.getInteger(eventArgs, \"entityTypeId\", 0) !== this._ownerTypeId\n\t\t\t|| BX.prop.getInteger(eventArgs, \"entityId\", 0) !== this._ownerId\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst semantics = BX.prop.getString(eventArgs, \"semantics\", \"\");\n\t\tif (semantics === this._progressSemantics)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis._progressSemantics = semantics;\n\t\tthis._schedule.refreshLayout();\n\t}\n\n\tgetId()\n\t{\n\t\treturn this._id;\n\t}\n\n\tgetSetting(name, defaultval)\n\t{\n\t\treturn this._settings.hasOwnProperty(name) ? this._settings[name] : defaultval;\n\t}\n\n\tgetOwnerTypeId()\n\t{\n\t\treturn this._ownerTypeId;\n\t}\n\n\tgetOwnerId()\n\t{\n\t\treturn this._ownerId;\n\t}\n\n\tgetOwnerInfo()\n\t{\n\t\treturn this._ownerInfo;\n\t}\n\n\tisStubCounterEnabled()\n\t{\n\t\tif (this.getSetting('enableTodo', false))\n\t\t{\n\t\t\treturn false; // do not show counter for new scenarios\n\t\t}\n\t\tif (this._ownerId <= 0)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\treturn (\n\t\t\t(this._ownerTypeId === BX.CrmEntityType.enumeration.deal || this._ownerTypeId === BX.CrmEntityType.enumeration.lead)\n\t\t\t&& this._progressSemantics === \"process\"\n\t\t);\n\t}\n\n\tgetSchedule()\n\t{\n\t\treturn this._schedule;\n\t}\n\n\tgetHistory()\n\t{\n\t\treturn this._history;\n\t}\n\n\tgetFixedHistory()\n\t{\n\t\treturn this._fixedHistory;\n\t}\n\n\tgetWaitEditor()\n\t{\n\t\treturn this._waitEditor;\n\t}\n\n\tgetSmsEditor()\n\t{\n\t\treturn this._smsEditor;\n\t}\n\n\tgetTodoEditor()\n\t{\n\t\treturn this._todoEditor;\n\t}\n\n\tgetMenuBar(): ?MenuBar\n\t{\n\t\treturn this._menuBar;\n\t}\n\n\tprocessSheduleLayoutChange()\n\t{\n\t}\n\n\tprocessHistoryLayoutChange()\n\t{\n\t\tthis._schedule.refreshLayout();\n\t}\n\n\tswitchToDefaultEditor(editor)\n\t{\n\t\tlet firstSuitableMenuItem = Array.from(this._menuBar.getMenuItems()).reduce(\n\t\t\t(prev, item) => {\n\t\t\t\tif (prev)\n\t\t\t\t{\n\t\t\t\t\treturn prev;\n\t\t\t\t}\n\t\t\t\tconst id = item.dataset.id;\n\t\t\t\tif (['comment', 'wait', 'sms', 'zoom', 'todo'].indexOf(id) >= 0)\n\t\t\t\t{\n\t\t\t\t\treturn id;\n\t\t\t\t}\n\n\t\t\t\treturn null;\n\t\t\t},\n\t\t\tnull\n\t\t);\n\n\t\tconst editorsMap = {\n\t\t\t'comment': this._commentEditor,\n\t\t\t'wait': this._waitEditor,\n\t\t\t'sms': this._smsEditor,\n\t\t\t'zoom': this._zoomEditor,\n\t\t\t'todo': this._todoEditor\n\t\t};\n\t\tlet firstSuitableEditor;\n\t\tif(editorsMap.hasOwnProperty(firstSuitableMenuItem) && editorsMap[firstSuitableMenuItem] && editorsMap[firstSuitableMenuItem].setVisible)\n\t\t{\n\t\t\tfirstSuitableEditor = editorsMap[firstSuitableMenuItem];\n\t\t}\n\t\telse if (this._todoEditor)\n\t\t{\n\t\t\tfirstSuitableEditor = this._todoEditor;\n\t\t\tfirstSuitableMenuItem = 'todo'\n\t\t}\n\t\telse\n\t\t{\n\t\t\tfirstSuitableEditor = this._commentEditor;\n\t\t\tfirstSuitableMenuItem = 'comment'\n\t\t}\n\t\tif (editor !== firstSuitableEditor && editor.setVisible)\n\t\t{\n\t\t\teditor.setVisible(false);\n\t\t}\n\t\tfirstSuitableEditor.setVisible(true);\n\t\tthis._menuBar.setActiveItemById(firstSuitableMenuItem);\n\t}\n\n\tprocessEditingCompletion(editor)\n\t{\n\t\tthis.switchToDefaultEditor(editor);\n\t}\n\n\tprocessEditingCancellation(editor)\n\t{\n\t\tthis.switchToDefaultEditor(editor);\n\t}\n\n\taddScheduleItem(data)\n\t{\n\t\tconst item = this._schedule.createItem(data);\n\t\tconst index = this._schedule.calculateItemIndex(item);\n\t\tconst anchor = this._schedule.createAnchor(index);\n\t\tthis._schedule.addItem(item, index);\n\t\titem.layout({anchor: anchor});\n\n\t\treturn item;\n\t}\n\n\taddHistoryItem(data)\n\t{\n\t\tconst item = this._history.createItem(data);\n\t\tconst index = this._history.calculateItemIndex(item);\n\t\tconst historyAnchor = this._history.createAnchor(index);\n\t\tthis._history.addItem(item, index);\n\t\titem.layout({anchor: historyAnchor});\n\n\t\treturn item;\n\t}\n\n\trenderAudioDummy(durationText, onClick)\n\t{\n\t\treturn BX.create(\"DIV\", {\n\t\t\tattrs: {className: \"crm-audio-cap-wrap-container\"},\n\t\t\tchildren: [\n\t\t\t\tBX.create(\"DIV\", {\n\t\t\t\t\tattrs: {className: \"crm-audio-cap-wrap\"},\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"DIV\", {\n\t\t\t\t\t\t\t\tattrs: {className: \"crm-audio-cap-time\"},\n\t\t\t\t\t\t\t\ttext: durationText\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t],\n\t\t\t\t\tevents: {click: onClick}\n\t\t\t\t})\n\t\t\t]\n\t\t});\n\t}\n\n\tloadMediaPlayer(id, filePath, mediaType, node, duration, options)\n\t{\n\t\tif (!duration)\n\t\t{\n\t\t\tduration = 0;\n\t\t}\n\t\tif (!options)\n\t\t{\n\t\t\toptions = {};\n\t\t}\n\t\tconst player = new BX.Fileman.Player(id, {\n\t\t\tsources: [\n\t\t\t\t{\n\t\t\t\t\tsrc: filePath,\n\t\t\t\t\ttype: mediaType\n\t\t\t\t}\n\t\t\t],\n\t\t\tisAudio: !options.video,\n\t\t\tskin: options.hasOwnProperty('skin') ? options.skin : 'vjs-timeline_player-skin',\n\t\t\twidth: options.width || 350,\n\t\t\theight: options.height || 30,\n\t\t\tduration: duration,\n\t\t\tplaybackRate: options.playbackRate || null,\n\t\t\tonInit: function (player) {\n\t\t\t\tplayer.vjsPlayer.controlBar.removeChild('timeDivider');\n\t\t\t\tplayer.vjsPlayer.controlBar.removeChild('durationDisplay');\n\t\t\t\tplayer.vjsPlayer.controlBar.removeChild('fullscreenToggle');\n\t\t\t\tplayer.vjsPlayer.controlBar.addChild('timeDivider');\n\t\t\t\tplayer.vjsPlayer.controlBar.addChild('durationDisplay');\n\t\t\t\tif (!player.isPlaying())\n\t\t\t\t{\n\t\t\t\t\tplayer.play();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tBX.cleanNode(node, false);\n\t\tnode.appendChild(player.createElement());\n\t\tplayer.init();\n\t\t// todo remove this after player will be able to get float playbackRate\n\t\tif (options.playbackRate > 1)\n\t\t{\n\t\t\tplayer.vjsPlayer.playbackRate(options.playbackRate);\n\t\t}\n\t\treturn player;\n\t}\n\n\tonActivityCreated(activity, data)\n\t{\n\t\t//Already processed in onPullEvent\n\t}\n\n\tisSpotlightShowed()\n\t{\n\t\treturn this._spotlightFastenShowed;\n\t}\n\n\tsetSpotlightShowed()\n\t{\n\t\tthis._spotlightFastenShowed = true;\n\t}\n\n\tgetCurrentUser(): ?Object\n\t{\n\t\treturn this._currentUser;\n\t}\n\n\tgetAudioPlaybackRateSelector()\n\t{\n\t\tif (!this.audioPlaybackRateSelector)\n\t\t{\n\t\t\tthis.audioPlaybackRateSelector = new AudioPlaybackRateSelector({\n\t\t\t\tname: 'timeline_audio_playback',\n\t\t\t\tcurrentRate: this._audioPlaybackRate,\n\t\t\t\tavailableRates: [\n\t\t\t\t\t{\n\t\t\t\t\t\trate: 1,\n\t\t\t\t\t\thtml: BX.Loc.getMessage('CRM_TIMELINE_PLAYBACK_RATE_SELECTOR_RATE_1')\n\t\t\t\t\t\t\t.replace('#RATE#', '<span class=\"crm-audio-cap-speed-param\">1x</span>')\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\trate: 1.5,\n\t\t\t\t\t\thtml: BX.Loc.getMessage('CRM_TIMELINE_PLAYBACK_RATE_SELECTOR_RATE_1.5')\n\t\t\t\t\t\t\t.replace('#RATE#', '<span class=\"crm-audio-cap-speed-param\">1.5x</span>')\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\trate: 2,\n\t\t\t\t\t\thtml: BX.Loc.getMessage('CRM_TIMELINE_PLAYBACK_RATE_SELECTOR_RATE_2')\n\t\t\t\t\t\t\t.replace('#RATE#', '<span class=\"crm-audio-cap-speed-param\">2x</span>')\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\trate: 3,\n\t\t\t\t\t\thtml: BX.Loc.getMessage('CRM_TIMELINE_PLAYBACK_RATE_SELECTOR_RATE_3')\n\t\t\t\t\t\t\t.replace('#RATE#', '<span class=\"crm-audio-cap-speed-param\">3x</span>')\n\t\t\t\t\t}\n\t\t\t\t],\n\t\t\t\ttextMessageCode: 'CRM_TIMELINE_PLAYBACK_RATE_SELECTOR_TEXT'\n\t\t\t});\n\t\t}\n\n\t\treturn this.audioPlaybackRateSelector;\n\t}\n\n\thasScheduledItems(): boolean\n\t{\n\t\treturn this._schedule.getItems().length > 0;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Manager();\n\t\tself.initialize(id, settings);\n\t\tManager.instances[self.getId()] = self;\n\t\treturn self;\n\t}\n\n\tstatic getDefault(): ?Manager\n\t{\n\t\treturn Manager.#defaultInstance;\n\t}\n\tstatic setDefault(instance): void\n\t{\n\t\tManager.#defaultInstance = instance;\n\t}\n\n\tstatic getById(id): ?Manager\n\t{\n\t\treturn Manager.instances[id] || null;\n\t}\n\n\tstatic #defaultInstance = null;\n\tstatic instances = {};\n}\n","import Activity from \"./activity\";\n\n/** @memberof BX.Crm.Timeline.Actions */\nexport default class SchedulePostpone extends Activity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._button = null;\n\t\tthis._clickHandler = BX.delegate(this.onClick, this);\n\t\tthis._isMenuShown = false;\n\n\t\tthis._menu = false;\n\t}\n\n\tdoLayout()\n\t{\n\t\tthis._button = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs:\n\t\t\t\t\t{\n\t\t\t\t\t\tclassName: this._isEnabled\n\t\t\t\t\t\t\t? \"crm-entity-stream-planned-action-aside\"\n\t\t\t\t\t\t\t: \"crm-entity-stream-planned-action-aside-disabled\"\n\t\t\t\t\t},\n\t\t\t\ttext: this.getMessage(\"postpone\")\n\t\t\t}\n\t\t);\n\n\t\tif(this._isEnabled)\n\t\t{\n\t\t\tBX.bind(this._button, \"click\", this._clickHandler)\n\t\t}\n\n\t\tthis._container.appendChild(this._button);\n\t}\n\n\topenMenu()\n\t{\n\t\tif(this._isMenuShown)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst handler = BX.delegate(this.onMenuItemClick, this);\n\t\tconst menuItems =\n\t\t\t[\n\t\t\t\t{id: \"hour_1\", text: this.getMessage(\"forOneHour\"), onclick: handler},\n\t\t\t\t{id: \"hour_2\", text: this.getMessage(\"forTwoHours\"), onclick: handler},\n\t\t\t\t{id: \"hour_3\", text: this.getMessage(\"forThreeHours\"), onclick: handler},\n\t\t\t\t{id: \"day_1\", text: this.getMessage(\"forOneDay\"), onclick: handler},\n\t\t\t\t{id: \"day_2\", text: this.getMessage(\"forTwoDays\"), onclick: handler},\n\t\t\t\t{id: \"day_3\", text: this.getMessage(\"forThreeDays\"), onclick: handler}\n\t\t\t];\n\n\t\tBX.PopupMenu.show(\n\t\t\tthis._id,\n\t\t\tthis._button,\n\t\t\tmenuItems,\n\t\t\t{\n\t\t\t\toffsetTop: 0,\n\t\t\t\toffsetLeft: 16,\n\t\t\t\tevents:\n\t\t\t\t\t{\n\t\t\t\t\t\tonPopupShow: BX.delegate(this.onMenuShow, this),\n\t\t\t\t\t\tonPopupClose: BX.delegate(this.onMenuClose, this),\n\t\t\t\t\t\tonPopupDestroy: BX.delegate(this.onMenuDestroy, this)\n\t\t\t\t\t}\n\t\t\t}\n\t\t);\n\n\t\tthis._menu = BX.PopupMenu.currentItem;\n\t}\n\n\tcloseMenu()\n\t{\n\t\tif(!this._isMenuShown)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif(this._menu)\n\t\t{\n\t\t\tthis._menu.close();\n\t\t}\n\t}\n\n\tonClick()\n\t{\n\t\tif(!this._isEnabled)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif(this._isMenuShown)\n\t\t{\n\t\t\tthis.closeMenu();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.openMenu();\n\t\t}\n\t}\n\n\tonMenuItemClick(e, item)\n\t{\n\t\tthis.closeMenu();\n\n\t\tlet offset = 0;\n\t\tif(item.id === \"hour_1\")\n\t\t{\n\t\t\toffset = 3600;\n\t\t}\n\t\telse if(item.id === \"hour_2\")\n\t\t{\n\t\t\toffset = 7200;\n\t\t}\n\t\telse if(item.id === \"hour_3\")\n\t\t{\n\t\t\toffset = 10800;\n\t\t}\n\t\telse if(item.id === \"day_1\")\n\t\t{\n\t\t\toffset = 86400;\n\t\t}\n\t\telse if(item.id === \"day_2\")\n\t\t{\n\t\t\toffset = 172800;\n\t\t}\n\t\telse if(item.id === \"day_3\")\n\t\t{\n\t\t\toffset = 259200;\n\t\t}\n\n\t\tif(offset > 0 && this._item)\n\t\t{\n\t\t\tthis._item.postpone(offset);\n\t\t}\n\t}\n\n\tonMenuShow()\n\t{\n\t\tthis._isMenuShown = true;\n\t}\n\n\tonMenuClose()\n\t{\n\t\tif(this._menu && this._menu.popupWindow)\n\t\t{\n\t\t\tthis._menu.popupWindow.destroy();\n\t\t}\n\t}\n\n\tonMenuDestroy()\n\t{\n\t\tthis._isMenuShown = false;\n\t\tthis._menu = null;\n\n\t\tif(typeof(BX.PopupMenu.Data[this._id]) !== \"undefined\")\n\t\t{\n\t\t\tdelete(BX.PopupMenu.Data[this._id]);\n\t\t}\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = SchedulePostpone.messages;\n\t\treturn m.hasOwnProperty(name) ? m[name] : name;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new SchedulePostpone();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n\n\tstatic messages = {};\n}\n","import Shift from \"./shift\";\n\n/** @memberof BX.Crm.Timeline.Animation */\nexport default class Comment\n{\n\tconstructor()\n\t{\n\t\tthis._node = null;\n\t\tthis._anchor = null;\n\t\tthis._nodeParent  = null;\n\t\tthis._startPosition = null;\n\t\tthis._events = null;\n\t}\n\n\tinitialize(node, anchor, startPosition, events)\n\t{\n\t\tthis._node = node;\n\t\tthis._anchor = anchor;\n\t\tthis._nodeParent  = node.parentNode;\n\t\tthis._startPosition = startPosition;\n\t\tthis._events = BX.type.isPlainObject(events) ? events : {};\n\n\t}\n\n\trun()\n\t{\n\t\tBX.addClass(this._node, 'crm-entity-stream-section-animate-start');\n\n\t\tthis._node.style.position = \"absolute\";\n\t\tthis._node.style.width = this._startPosition.width + \"px\";\n\t\tthis._node.style.height = this._startPosition.height + \"px\";\n\t\tthis._node.style.top = this._startPosition.top - 30 + \"px\";\n\t\tthis._node.style.left = this._startPosition.left + \"px\";\n\t\tthis._node.style.opacity = 0;\n\t\tthis._node.style.zIndex = 960;\n\n\t\tdocument.body.appendChild(this._node);\n\n\t\tconst nodeOpacityAnim = new BX.easing({\n\t\t\tduration: 350,\n\t\t\tstart: {opacity: 0},\n\t\t\tfinish: {opacity: 100},\n\t\t\ttransition: BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\tstep: BX.proxy(function (state) {\n\t\t\t\tthis._node.style.opacity = state.opacity / 100;\n\t\t\t}, this),\n\t\t\tcomplete: BX.proxy(function () {\n\t\t\t\tif (BX.type.isFunction(this._events[\"start\"]))\n\t\t\t\t{\n\t\t\t\t\tthis._events[\"start\"]();\n\t\t\t\t}\n\t\t\t\tconst shift = Shift.create(\n\t\t\t\t\tthis._node,\n\t\t\t\t\tthis._anchor,\n\t\t\t\t\tthis._startPosition,\n\t\t\t\t\tfalse,\n\t\t\t\t\t{complete: BX.delegate(this.finish, this)}\n\t\t\t\t);\n\t\t\t\tshift.run();\n\t\t\t}, this)\n\t\t});\n\t\tnodeOpacityAnim.animate();\n\n\n\t\tif(BX.type.isFunction(this._events[\"complete\"]))\n\t\t{\n\t\t\tthis._events[\"complete\"]();\n\t\t}\n\t}\n\n\tfinish()\n\t{\n\t\tthis._node.style.position = \"\";\n\t\tthis._node.style.width = \"\";\n\t\tthis._node.style.height = \"\";\n\t\tthis._node.style.top = \"\";\n\t\tthis._node.style.left = \"\";\n\t\tthis._node.style.opacity = \"\";\n\t\tthis._node.style.zIndex = \"\";\n\t\tthis._anchor.style.height = \"\";\n\t\tthis._anchor.parentNode.insertBefore(this._node, this._anchor.nextSibling);\n\t\tsetTimeout(\n\t\t\tBX.delegate(function() {\n\t\t\t\tBX.removeClass(this._node, 'crm-entity-stream-section-animate-start');\n\t\t\t\tBX.remove(this._anchor);\n\t\t\t}, this),\n\t\t\t0\n\t\t);\n\t}\n\n\tstatic create(node, anchor, startPosition, events)\n\t{\n\t\tconst self = new Comment();\n\t\tself.initialize(node, anchor, startPosition, events);\n\t\treturn self;\n\t}\n}\n","import Manager from \"./manager\";\nimport Stream from \"./stream\";\nimport Editor from \"./editor\";\nimport History from \"./streams/history\";\nimport FixedHistory from \"./streams/fixedhistory\";\nimport EntityChat from \"./streams/entitychat\";\nimport Schedule from \"./streams/schedule\";\nimport Comment from \"./editors/comment\";\nimport Wait from \"./editors/wait\";\nimport Rest from \"./editors/rest\";\nimport Sms from \"./editors/sms\";\nimport WaitConfigurationDialog from \"./tools/wait-configuration-dialog\";\nimport SchedulePostponeController from \"./tools/schedule-postpone-controller\";\nimport MenuBar from \"./tools/menubar\";\nimport AudioPlaybackRateSelector from \"./tools/audio-playback-rate-selector\";\nimport * as Types from \"./types\";\nimport Action from \"./action\";\nimport Activity from \"./actions/activity\";\nimport {Call, HistoryCall, ScheduleCall} from \"./actions/call\";\nimport {Email, HistoryEmail, ScheduleEmail} from \"./actions/email\";\nimport {OpenLine} from \"./actions/openline\";\nimport SchedulePostpone from \"./actions/schedule-postpone\";\nimport CompatibleItem from \"./items/compatible-item\";\nimport HistoryItem from \"./items/history\";\nimport HistoryActivity from \"./items/history-activity\";\nimport CommentItem from \"./items/comment\";\nimport Modification from \"./items/modification\";\nimport Mark from \"./items/mark\";\nimport Creation from \"./items/creation\";\nimport Restoration from \"./items/restoration\";\nimport Relation from \"./items/relation\";\nimport Link from \"./items/link\";\nimport Unlink from \"./items/unlink\";\nimport EmailItem from \"./items/email\";\nimport CallItem from \"./items/call\";\nimport Meeting from \"./items/meeting\";\nimport Task from \"./items/task\";\nimport WebForm from \"./items/webform\";\nimport WaitItem from \"./items/wait\";\nimport Document from \"./items/document\";\nimport Sender from \"./items/sender\";\nimport Bizproc from \"./items/bizproc\";\nimport Request from \"./items/request\";\nimport RestItem from \"./items/rest\";\nimport OpenLineItem from \"./items/openline\";\nimport Zoom from \"./items/zoom\";\nimport Conversion from \"./items/conversion\";\nimport Visit from \"./items/visit\";\nimport Scoring from \"./items/scoring\";\nimport ExternalNoticeModification from \"./items/external-notice-modification\";\nimport ExternalNoticeStatusModification from \"./items/external-notice-status-modification\";\nimport Scheduled from \"./items/scheduled\";\nimport ScheduledActivity from \"./items/scheduled/activity\";\nimport ScheduledEmail from \"./items/scheduled/email\";\nimport ScheduledCall from \"./items/scheduled/call\";\nimport CallTracker from \"./items/scheduled/call-tracker\";\nimport ScheduledMeeting from \"./items/scheduled/meeting\";\nimport ScheduledTask from \"./items/scheduled/task\";\nimport ScheduledWebForm from \"./items/scheduled/webform\";\nimport ScheduledWait from \"./items/scheduled/wait\";\nimport ScheduledRequest from \"./items/scheduled/request\";\nimport ScheduledRest from \"./items/scheduled/rest\";\nimport ScheduledOpenLine from \"./items/scheduled/openline\";\nimport ScheduledZoom from \"./items/scheduled/zoom\";\nimport AnimationItem from \"./animations/item\";\nimport ItemNew from \"./animations/item-new\";\nimport Expand from \"./animations/expand\";\nimport Shift from \"./animations/shift\";\nimport AnimationComment from \"./animations/comment\";\nimport Fasten from \"./animations/fasten\";\n\nconst Streams = {\n\tHistory,\n\tFixedHistory,\n\tEntityChat,\n\tSchedule,\n}\n\nconst Editors = {\n\tComment,\n\tWait,\n\tRest,\n\tSms\n}\n\nconst Tools = {\n\tWaitConfigurationDialog,\n\tSchedulePostponeController,\n\tMenuBar,\n\tAudioPlaybackRateSelector,\n}\n\nconst Actions = {\n\tActivity,\n\tCall,\n\tHistoryCall,\n\tScheduleCall,\n\tEmail,\n\tHistoryEmail,\n\tScheduleEmail,\n\tOpenLine,\n\tSchedulePostpone,\n}\n\nconst ScheduledItems = {\n\tActivity: ScheduledActivity,\n\tEmail: ScheduledEmail,\n\tCall: ScheduledCall,\n\tCallTracker,\n\tMeeting: ScheduledMeeting,\n\tTask: ScheduledTask,\n\tWebForm: ScheduledWebForm,\n\tWait: ScheduledWait,\n\tRequest: ScheduledRequest,\n\tRest: ScheduledRest,\n\tOpenLine: ScheduledOpenLine,\n\tZoom: ScheduledZoom,\n}\n\nconst Items = {\n\tHistory: HistoryItem,\n\tHistoryActivity,\n\tComment: CommentItem,\n\tModification,\n\tMark,\n\tCreation,\n\tRestoration,\n\tRelation,\n\tLink,\n\tUnlink,\n\tEmail: EmailItem,\n\tCall: CallItem,\n\tMeeting,\n\tTask,\n\tWebForm,\n\tWait: WaitItem,\n\tDocument,\n\tSender,\n\tBizproc,\n\tRequest,\n\tRest: RestItem,\n\tOpenLine: OpenLineItem,\n\tZoom,\n\tConversion,\n\tVisit,\n\tScoring,\n\tExternalNoticeModification,\n\tExternalNoticeStatusModification,\n\tScheduledBase: Scheduled,\n\tScheduled: ScheduledItems,\n}\n\nconst Animations = {\n\tItem: AnimationItem,\n\tItemNew,\n\tExpand,\n\tShift,\n\tComment: AnimationComment,\n\tFasten,\n};\n\nexport {\n\tManager,\n\tStream,\n\tStreams,\n\tEditor,\n\tEditors,\n\tTools,\n\tTypes,\n\tAction,\n\tActions,\n\tItems,\n\tAnimations,\n\tCompatibleItem,\n};\n"],"names":["Editor","_id","_settings","_manager","_ownerTypeId","_ownerId","_container","_input","_saveButton","_cancelButton","_ghostInput","_saveButtonHandler","BX","delegate","onSaveButtonClick","_cancelButtonHandler","onCancelButtonClick","_focusHandler","onFocus","_blurHandler","onBlur","_keyupHandler","resizeForm","_delayedKeyupHandler","setTimeout","bind","_isVisible","_hideButtonsOnBlur","id","settings","type","isNotEmptyString","util","getRandomString","getSetting","Manager","bindInputHandlers","doInitialize","name","defaultval","hasOwnProperty","visible","style","display","e","addClass","value","window","removeClass","minHeight","Dom","removeButtonWaitClass","saveResult","save","Promise","then","cancel","processEditingCancellation","remove","create","props","className","text","width","offsetWidth","document","body","appendChild","ghost","ensureGhostCreated","computedStyle","getComputedStyle","diff","parseInt","paddingBottom","paddingTop","borderTopWidth","borderBottomWidth","innerHTML","htmlspecialchars","replace","scrollHeight","WaitConfigurationDialog","_type","Wait","WaitingType","undefined","_duration","_target","_targetDates","_durationMeasureNode","_durationInput","_targetDateNode","_popup","prop","getInteger","after","getString","getArray","_menuId","duration","target","m","messages","enableNumber","Helper","getDurationText","length","i","info","PopupWindow","autoHide","draggable","bindOptions","forceBindPosition","closeByEsc","zIndex","content","prepareDialogContent","events","onPopupShow","onPopupClose","onPopupDestroy","buttons","PopupWindowButton","getMessage","click","PopupWindowButtonLink","message","show","close","container","attrs","wrapper","keyup","onDurationChange","getTargetDateCaption","toggleTargetMenu","isNaN","isTargetMenuOpened","closeTargetMenu","openTargetMenu","PopupMenu","getMenuById","menuItems","push","title","onclick","onTargetSelect","offsetLeft","pos","angle","position","offset","destroy","item","callback","getFunction","params","before","fieldName","preventDefault","returnValue","self","initialize","_serviceUrl","_isRequestRunning","_isLocked","_configContainer","_configSelector","_isMenuShown","_menu","_configDialog","config","getObject","resolveTypeId","names","layoutConfigurationSummary","openMenu","closeMenu","handler","onMenuItemClick","customMenu","items","offsetTop","onMenuShow","onMenuClose","onMenuDestroy","currentItem","openConfigDialog","saveConfiguration","targetDates","onSave","onConfigDialogSave","onCancel","onConfigDialogCancel","setType","setDuration","setTarget","open","sender","popupWindow","Data","optionName","getId","toLowerCase","userOptions","strip_tags","getSummaryHtml","querySelector","onSelectorClick","ajax","url","method","dataType","data","onsuccess","completed","description","getSummaryText","comment","trim","ID","typeId","targetFieldName","subject","ownerType","CrmEntityType","resolveName","ownerID","onSaveSuccess","onfailure","onSaveFailure","release","error","alert","processEditingCompletion","result","Loc","getMessagePlural","toString","Sms","_history","_senderId","_from","_commEntityTypeId","_commEntityId","_to","_canUse","_canSendMessage","_manageUrl","_senders","_fromList","_toList","_defaults","_communications","_shownMenuId","_documentSelector","_source","_paymentId","_shipmentId","_compilationProductIds","_templateId","_templatesContainer","_templateFieldHintNode","_templateSelectorNode","_templateTemplateTitleNode","_templatePreviewNode","_templateSelectorMenuId","_templateFieldHintHandler","onTemplateHintIconClick","_templateSeletorClickHandler","onTemplateSelectClick","_selectTemplateHandler","onSelectTemplate","remove_url_param","getBoolean","senderId","from","_isSalescenterEnabled","_isDocumentsEnabled","_documentsProvider","_documentsValue","_isFilesEnabled","_diskUrls","_isFilesExternalLinkEnabled","_senderSelectorNode","_fromContainerNode","_fromSelectorNode","_clientContainerNode","_clientSelectorNode","_toSelectorNode","_messageLengthCounterWrapperNode","_messageLengthCounterNode","_salescenterStarter","_smsDetailSwitcher","_smsDetail","_documentSelectorButton","_fileSelectorButton","_fileUploadZone","_fileUploadLabel","_fileSelectorBitrix","_fileExternalLinkDisabledContent","initSenderSelector","initDetailSwitcher","initFromSelector","initClientContainer","initClientSelector","initToSelector","initMessageLengthCounter","setMessageLengthCounter","initDocumentSelector","initFileSelector","initSalescenterApplication","classList","contains","innerText","add","defaultSenderId","defaultSender","canUse","restSender","onSenderSelectorClick","fromList","delimiter","href","setSender","Uri","addParam","manageUrl","slider","SidePanel","Instance","getTopSlider","options","onClose","reload","onCloseComplete","location","setFrom","setAsDefault","textContent","shortName","isTemplatesBased","showNode","hideNode","toggleTemplateSelectAvailability","toggleSaveButton","visualFn","node","defaultFromId","defaultFrom","onFromSelectorClick","onFromSelectorItemClick","hide","onClientSelectorClick","caption","client","setClient","entityTypeId","entityId","phones","setTo","onToSelectorClick","onToSelectorItemClick","valueFormatted","to","menuId","bindElement","_messageLengthMax","getAttribute","setMessageLengthCounterDelayed","classFn","getSelectedSender","enabled","templateId","template","getSelectedTemplate","PREVIEW","add_url_param","bitrix_sessid","startSalescenterApplication","loadExt","Salescenter","openApplication","disableSendButton","context","ownerTypeId","ownerId","mode","enumeration","deal","get","focus","paymentId","shipmentId","productIds","onDocumentSelectorClick","DocumentGenerator","Selector","Menu","moduleId","provider","analyticsLabelPrefix","selectPublicUrl","object","Template","createDocument","pasteDocumentUrl","catch","console","Document","getDocumentPublicUrl","publicUrl","getTitle","onFileSelectorClick","uploadFile","findFile","getElementById","closeFileSelector","initDiskUF","fireEvent","getFileUploadInput","showFilesExternalLinkFeaturePopup","loader","Loader","size","getLoader","isShown","isDiskFileUploaderInited","addCustomEvent","OnFileUploadSuccess","uf","_onUploadProgress","showLoader","parentNode","Disk","UF","UID","controlName","hideSelectDialog","urlSelect","urlRenameFile","urlDeleteFile","urlUpload","onCustomEvent","fileResult","file","uploaderFile","hideLoader","diskFileId","element_id","fileName","element_name","pasteFileUrl","runAction","analyticsLabel","fileId","response","externalLink","link","errors","pop","featurePopup","closeIcon","overlay","contentColor","getFeaturePopup","top","Type","isArray","forEach","TITLE","loaderMenuId","loaderMenuLoaderId","html","height","onDestroy","module","find","templates","showTemplateSelectDropdown","applySelectedTemplate","menu","preview","Text","encode","Rest","_interfaceInitialized","action","initializeInterface","rest","Marketplace","PLACEMENT","proxy","fireUpdateEvent","appId","appData","split","AppLayout","PLACEMENT_ID","PlacementInterface","initializePlacement","prototype","reloadData","cb","Crm","EntityEvent","fireUpdate","log","fire","invalidate","Comment","_postForm","_editor","unbind","_editorName","onLoadEditorSuccess","_editorContainer","showEditor","addEvents","firstElementChild","removeEventListener","controller","obj","blob","addEventListener","LHEPostForm","getHandler","BXHtmlEditor","Get","eventNode","history","Focus","isDomNode","loadEditor","attachmentList","oEditor","GetContent","querySelectorAll","input","emptyCommentMessage","darkMode","reinit","itemData","historyItem","createItem","addItem","anchor","createAnchor","layout","move","CrmCommentAnimation","getWrapper","start","onAnimationStart","complete","onAnimationComplete","run","_anchor","refreshLayout","ToDo","hasClass","clearValue","activityId","setParentActivityId","deadLine","setDeadLine","setFocused","editorContainer","prepend","TodoEditor","defaultDescription","onChangeDescription","event","getData","Item","activity","creation","modification","unlink","mark","wait","bizproc","conversion","restoration","order","orderCheck","scoring","externalNotification","finalSummary","delivery","finalSummaryDocuments","storeDocument","productCompilation","signDocument","Mark","waiting","success","renew","ignored","failed","Order","encourageBuyProducts","EditorMode","view","edit","CompatibleItem","_data","_typeCategoryId","_associatedEntityData","_associatedEntityTypeId","_associatedEntityId","_isContextMenuShown","_contextMenuButton","_activityEditor","_actions","_actionContainer","_existedStreamItemDeadLine","_setId","isPlainObject","clearCachedData","associatedEntityData","ASSOCIATED_ENTITY","setData","entityData","getAssociatedEntityData","permissions","PERMISSIONS","ItemType","isElementNode","prepareLayout","prepareActions","actionQty","showActions","isDone","isNumber","whilespaceOffset","substring","search","clickHandler","authorInfo","getObjectDataParam","showUrl","children","imageUrl","backgroundImage","encodeURI","backgroundSize","onContextMenuButtonClick","openContextMenu","closeContextMenu","prepareContextMenuItems","IntranetExtensions","onContextMenuShow","onContextMenuClose","onContextMenuDestroy","_contextMenu","TimezoneOffset","USER_TO_SERVER","Fasten","_initialItem","_finalItem","_events","defaultValue","insertBefore","nextSibling","_clone","cloneNode","_startPosition","_cloneHeight","_minHeight","_sumPaddingContent","left","_anchorPosition","finish","opacity","_difference","bottom","_deepHistoryLimit","clientHeight","Math","abs","movingEvent","easing","transition","makeEaseOut","transitions","quart","step","state","animate","addFixedHistoryItem","isFunction","History","_fixedHistory","_typeId","_createdTime","_isFixed","_headerClickHandler","onHeaderClick","isReadOnly","getTextDataParam","time","parseDate","getCreatedTimestamp","DatetimeConverter","toUserTime","getValue","extractDate","Date","getCreatedTime","getTime","getOwnerInfo","getTypeId","CrmActivityStatus","isFinal","_items","fastenLimitPopup","_switcher","getOwnerTypeId","getOwnerId","ERROR","isFixed","IS_FIXED","fixedItem","animation","initialItem","finalItem","findItemById","index","getItemIndex","clearAnimate","removeItemByIndex","LazyLoad","showImages","_wrapper","wrapperPosition","hideEvent","marginBottom","clearLayout","wrapperClassName","getWrapperClassName","getIconClassName","isContextMenuEnabled","append","prepareContextMenuButton","contentWrapper","header","formatTime","prepareContentDetails","authorNode","prepareAuthorLayout","prepareContent","enableAdd","markAsTerminated","checkItemForTermination","unfasten","fasten","manager","getManager","isSpotlightShowed","setSpotlightShowed","spotlight","SpotLight","targetElement","targetVertex","lightMode","autoSave","prepareTitleLayout","statusNode","getStatusNode","onActivityCreated","deadline","isDate","setHours","setMinutes","setSeconds","setMilliseconds","end","Scheduled","_schedule","_deadlineNode","_setAsDoneButtonHandler","onSetAsDoneButtonClick","CrmActivityEditor","hasPermissions","verifyPermissions","loadPermissions","userId","getPermissions","getUserId","getServiceUrl","getAssociatedEntityId","onPermissionsLoad","setPermissions","getDeadline","isCounterEnabled","markAsDone","onItemMarkedAsDone","formatDateTime","isIncomingChannel","perms","canComplete","setAsDone","Action","doLayout","Activity","_entityData","_item","_isEnabled","getActivityCommunications","getActivityId","communications","Email","_clickHandler","onClick","_saveHandler","CrmActivityProvider","Bitrix24","Slider","addEmail","addOnSave","loadActivityCommunications","CrmActivityEmail","prepareReply","PreventDefault","onActivityCreate","HistoryEmail","ScheduleEmail","HistoryActivity","direction","typeCategoryId","getTypeCategoryId","CrmActivityType","email","CrmActivityDirection","incoming","call","meeting","task","providerId","getTypeDescription","markTypeId","messageName","markText","activityEditor","isEditable","processRemoval","viewActivity","associatedEntityTypeId","getAssociatedEntityTypeId","editActivity","_detetionConfirmDlgId","dlg","ConfirmationDialog","getRemoveMessage","onRemovalConfirm","onRemovalCancel","getItemById","deleteActivity","serviceUrl","ownertype","ownerid","_handleActivityChange","editDocument","statusLayout","prepareTitleStatusLayout","prepareTimeLayout","prepareFixedSwitcherLayout","prepareHeaderLayout","detailWrapper","findChildByClassName","confirmDelete","onConfirmDelete","DoNothing","deleteDocument","deleteItem","deleteFixedItem","documentId","DOCUMENT_ID","adjust","_node","originalPosition","_initialYPosition","_initialXPosition","_initialWidth","_initialHeight","offsetHeight","_anchorYPosition","createStub","createGhost","moveGhost","_stub","_ghostNode","boxShadow","placeEventAnim","addHistoryItem","removeGhost","_finalItemHeight","ghostNode","finalNode","overflow","hideCasperItem","collapseStub","removePlannedEvent","inited","Shift","_nodeParent","startPosition","shadowNode","_shadowNode","ItemNew","_areAnimatedItemsVisible","offsetParent","shift","stubContainer","Steam","_timeFormat","_year","_isStubMode","_userId","_readOnly","_streamType","StreamType","datetimeFormat","dateFormat","date","convertBitrixFormat","getFullYear","getStreamType","scheduled","pinned","currentUrl","ajaxId","insertToNode","bxajaxid","SERVER_TO_UTC","now","utc","format","Format","DAY_MONTH_FORMAT","LONG_DATE_FORMAT","whitespaceOffset","Error","getItems","findIndex","splice","setItems","ConfigurableItem","clone","animateUpdate","animateMove","resolve","itemPositionChanged","newIndex","newItem","isScheduleStream","createItemCopy","calculateItemIndex","animateItemAdding","ItemAnimation","getPosition","destinationStream","destinationItem","EntityChat","_layoutType","LayoutType","none","_contentWrapper","_messageWrapper","_messageDateNode","_messageTexWrapper","_messageTextNode","_userWrapper","_extraUserCounter","_openChatHandler","onOpenChat","lockScript","isString","eval","getUserInfoData","userInfos","counter","isEnabled","isStubMode","getChatId","renderSummary","renderInvitation","onChatEvent","cleanNode","invitation","refreshUsers","summary","_messageTexWraper","_messageCounterNode","refreshSummary","infos","list","Object","values","count","icon","getMessageData","isoDate","remoteDate","getServerTimezoneOffset","getUserTimezoneOffset","localTime","MessengerCommon","purifyText","BXIM","isRestricted","applyLockScript","slug","chatId","hasUserInfo","ownerInfo","entityTypeName","openMessengerSlider","RECENT","MENU","command","extras","setUserInfoData","mergeEx","refreshUsersAnimated","removeUserInfo","setMessageData","setUnreadMessageCounter","refreshSummaryAnimated","Stream","MenuBar","_ownerInfo","_commentEditor","_todoEditor","_waitEditor","_smsEditor","_zoomEditor","_restEditor","Main","interfaceButtonsManager","getById","setActiveItemById","_activeItem","getActive","firstId","getAllItems","dataset","indexOf","processItemSelection","currentDiv","wasActiveInMoreMenu","isActiveInMoreMenu","classes","itemActive","getItemData","currentDivData","activeItemData","isActiveData","JSON","parse","err","IS_ACTIVE","stringify","wasActiveData","submenu","getSubmenu","String","getMenuItems","menuItem","getContainer","getMoreButton","closeSubmenu","planner","Planner","showEdit","addDelivery","addTask","setVisible","visitParameters","CrmActivityVisit","match","AudioPlaybackRateSelector","availableRates","currentRate","normalizeRate","textMessageCode","renderedItems","players","rateDescription","rate","parseFloat","isRateCurrent","selectedRate","getRate","map","setRate","popupMenu","MenuManager","getPopupWindow","setBindElement","getPopup","textNode","getText","vjsPlayer","playbackRate","player","Fileman","Player","SchedulePostponeController","postpone","_postponeController","status","autoCompleted","setActivityCompleted","onSetAsDoneCompleted","getSourceId","postponeActivity","onPosponeCompleted","activityType","IS_INCOMING_CHANNEL","canPostpone","timeText","getCreatedDate","communication","communicationValue","getItemClassName","iconClassName","contentInnerWrapper","headerWrapper","cutOffText","additionalDetails","prepareDetailNodes","members","getPrepositionText","communicationNode","prepareCommunicationNode","setAsDoneButton","checked","change","disabled","buttonContainer","onContextMenuItemSelect","postponeMenu","commands","getCommandList","processCommand","CrmScheduleEmailAction","Call","CrmScheduleCallAction","callInfo","callTypeText","CallTracker","isSuccessfull","statusText","Meeting","Task","WebForm","editor","getWaitEditor","nl2br","Request","iconNode","backgroundPosition","backgroundColor","OpenLine","_button","OpenLineAction","messageWrapper","openLineData","isExternal","Zoom","topic","startTime","toDatetimeString","detailZoomMessage","detailZoomInfoLink","detailZoomInfo","detailZoomCopyInviteLink","clipboard","bindCopyClick","detailZoomStartConferenceButton","detailZoomCopyInviteLinkWrapper","Schedule","label","addStub","setContainer","processSheduleLayoutChange","hasContent","stubIcon","isStubCounterEnabled","isTerminated","getItemCount","getLastItem","sort","getSort","curSort","j","$entityTypeId","getItemByAssociatedEntity","entityTypeID","entityID","itemId","timelineId","itemClassName","currentUser","getCurrentUser","streamType","schedule","removeStub","historyItemData","onTransferComplete","stubClassName","stubIconClassName","canAddTodo","stubMessage","lead","focusOnTodoEditor","menuBar","getMenuBar","todoEditor","getTodoEditor","addWrapperClass","Modification","contentChildren","Conversion","entityNodes","entityInfos","getArrayDataParam","entityInfo","entityNode","getNotFoundMessage","emailInfo","markNode","prepareMarkLayout","communicationTitle","communicationShowUrl","outerWrapper","communicationWrapper","prepareCutOffElements","_menuItems","phone","addCall","showMenu","prepareMenuItems","PopupMenuWindow","l","formattedValue","complexName","itemText","phoneTo","HistoryCall","ScheduleCall","_playerDummyClickHandler","onPlayerDummyClick","_playerWrapper","_transcriptWrapper","_mediaFileInfo","hasCallInfo","communicationValueFormatted","durationText","hasTranscript","isTranscriptPending","callId","callComment","prepareMultilineCutOffElements","callInfoWrapper","renderAudioDummy","getAudioPlaybackRateSelector","render","Voximplant","Transcript","stubNode","addPlayer","loadMediaPlayer","entityDetailWrapper","Visit","visitInfo","recordLength","recordLengthFormatted","vkProfile","createTextNode","getVkProfileUrl","profile","getClass","Restriction","_videoDummy","_audioDummy","_videoPlayer","_audioPlayer","_audioLengthElement","_recordings","_currentRecordingIndex","zoomActivitySubject","_downloadWrapper","_downloadSubject","_downloadSubjectDetail","_downloadVideoLink","_downloadSeparator","_downloadAudioLink","_playVideoLink","detailZoomCopyVideoLink","prepareSuccessfulLayout","zoomData","tabs","recording","active","tabsComponent","TabsComponent","eventEmitter","subscribe","_onTabChange","_onVideoDummyClick","hint","UI","Hint","init","_onAudioDummyClick","videoLinkExpireTS","videoLinkContainer","_detailZoomCopyVideoLink","zoomAudioDetailWrapper","setCurrentRecording","video","skin","tabId","recordingIndex","videoRecording","audioRecording","hidden","pause","setSource","clean","lengthHuman","lastElementChild","elements","Event","EventEmitter","_renderTab","tabDescription","setActiveTab","Number","emit","OrderModification","statusInfo","classCode","fields","orderpayment","psStatusCode","ordershipment","getStatusInfo","isNotEmptyObject","htmlTitle","nodes","descriptionNode","legend","sublegend","destination","detailNode","sliderLinkNode","orderId","templateMode","paySystemName","sum","currency","paymentDetail","logotip","isPaid","isClick","isManualContinuePay","isManualAddCheck","preparePaidPaymentContent","prepareClickedPaymentContent","prepareManualContinuePayContent","prepareManualAddCheck","prepareItemOrderContent","isViewed","isSent","getHeaderChildren","prepareViewedContentDetails","prepareSentContentDetails","prepareErrorPaymentContentDetails","headerWrap","preparePaidPaymentContentDetails","paySystemError","errorDetailNode","prepareClickedPaymentContentDetails","ExternalNoticeModification","ExternalNoticeStatusModification","Creation","docType","msg","isMessageNotFound","TYPE_CATEGORY_ID","HTML_TITLE","createOrderEntityItem","orderData","ORDER_DATE","SHOW_URL","SUM","spanAttrs","linkAttrs","baseEntityData","baseEntityInfo","HistoryItem","Restoration","Relation","Link","Unlink","activityProviderId","MarkType","isDefined","innerWrapper","associatedEntityTitle","contentTemplate","Page","_isCollapsed","_hasFiles","_commentMessage","_mode","_streamContentEventBlock","_playerWrappers","playerWrapper","entityValueId","files","extension","detailChildren","_commentWrapper","switchToEditMode","switchToViewMode","cleanText","_hasInlineAttachment","onExpandButtonClick","_textLoaded","_fileBlock","ready","loadContent","registerImages","viewElementBind","showTitle","BLOCK","promise","SetContent","ReInitIframe","actionData","commentImages","commentImagesLength","idsList","toggleMode","tagName","getSelection","onRequestFailure","getHistory","fixedHistory","getFixedHistory","onRemoveSuccess","updateFixedItem","updateItem","eventWrapper","maxHeight","button","Sender","getDataSetting","isRemoved","stopPropagation","layoutClassName","textCaption","prepareStatusLayout","Bizproc","prepareContentTextHtml","workflowName","workflowStatus","Scoring","scoringInfo","score","getNumber","scoreDelta","round","iconClass","Expand","_callback","onNodeHeightStep","onNodeHeightComplete","onNodeOpacityStep","onNodeOpacityComplete","_emptySection","_currentDaySection","_lastDaySection","_lastDate","_enableLoading","_navigation","_scrollHandler","_loadingWaiter","_filterId","_isFilterApplied","_isFilterShown","_filterButton","_filterWrapper","_filterResultStub","onFilterApply","closeFilterButton","onFilterClose","created","createCurrentDaySection","createDaySection","enableLoading","processHistoryLayoutChange","firstChild","adjustFilterButton","_filterEmptyResultSection","createFilterEmptyResultSection","results","createEmptySection","showFilter","section","sectionWrapper","hideFilter","filter","filterManager","resetFilter","formattedDate","formatDate","toUpperCase","changedFieldName","useShortTimeFormat","createActivityItem","createExternalNotificationItem","child","removeChild","getBoundingClientRect","documentElement","loadItems","ctx","autoResolve","CrmDataLoader","load","resetLayout","bulkCreateItems","setNavigation","fulfill","navigation","enable","onWindowScroll","instances","FixedHistory","nextElementSibling","onItemsLoad","PullActionProcessor","_classPrivateMethodInitSpec","_classPrivateFieldInitSpec","isObject","scheduleStream","fixedHistoryStream","historyStream","actionParams","_classPrivateMethodGet","appLanguage","languageId","canBeReloaded","stream","promises","isHistoryStream","sourceStream","fromStream","fromId","all","existedStreamItem","streamItem","refreshItem","deleteItemAnimated","sourceId","destinationId","destinationItemData","sourceItem","existedDestinationItem","moveItemToStream","onSuccessFasten","fixedHistoryItem","getAnchor","onSuccessUnfasten","streamName","activityIds","historyIds","_progressSemantics","_chat","_menuBar","_currentUser","_pullTagName","_spotlightFastenShowed","_audioPlaybackRate","containerId","activityEditorId","readOnly","filterId","isFilterApplied","setHistory","isTodoEnabled","editorName","cancelButton","configContainer","templatesContainer","placement","onPullEvent","extendWatch","commentEditor","waitEditor","smsEditor","zoomEditor","restEditor","reset","onEntityProgressChange","throttle","onScroll","PULL","processAction","processChatCreate","processActivityExternalAdd","processActivityExternalUpdate","processActivityExternalDelete","processCommentExternalAdd","processCommentExternalUpdate","processCommentExternalDelete","processChangeBinding","processItemExternalUpdate","processWaitExternalAdd","processWaitExternalUpdate","processWaitExternalDelete","processBizprocStatus","processScoringExternalAdd","scheduleItemData","scheduleItem","getItemByData","addScheduleItem","historyItems","getItemsByAssociatedEntity","setAssociatedEntityData","fixedHistoryItems","transferItemToHistory","entityNewId","fixedItemData","eventArgs","semantics","firstSuitableMenuItem","Array","reduce","prev","editorsMap","firstSuitableEditor","switchToDefaultEditor","historyAnchor","filePath","mediaType","sources","src","isAudio","onInit","controlBar","addChild","isPlaying","play","createElement","audioPlaybackRateSelector","instance","SchedulePostpone","nodeOpacityAnim","Streams","Editors","Tools","Actions","ScheduledItems","ScheduledActivity","ScheduledEmail","ScheduledCall","ScheduledMeeting","ScheduledTask","ScheduledWebForm","ScheduledWait","ScheduledRequest","ScheduledRest","ScheduledOpenLine","ScheduledZoom","Items","CommentItem","EmailItem","CallItem","WaitItem","RestItem","OpenLineItem","ScheduledBase","Animations","AnimationItem","AnimationComment"],"mappings":"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"}