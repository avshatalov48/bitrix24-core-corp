{"version":3,"file":"timeline.bundle.js","sources":["../src/types.js","../src/items/compatible-item.js","../src/animations/fasten.js","../src/items/history.js","../src/items/scheduled.js","../src/animations/item.js","../src/animations/shift.js","../src/animations/item-new.js","../src/stream.js","../src/streams/entitychat.js","../src/tools/audio-playback-rate-selector.js","../src/tools/schedule-postpone-controller.js","../src/items/scheduled/activity.js","../src/items/scheduled/email.js","../src/items/scheduled/call.js","../src/items/scheduled/call-tracker.js","../src/items/scheduled/meeting.js","../src/items/scheduled/task.js","../src/items/scheduled/webform.js","../src/items/scheduled/wait.js","../src/items/scheduled/request.js","../src/items/scheduled/rest.js","../src/action.js","../src/actions/activity.js","../src/actions/openline.js","../src/items/scheduled/openline.js","../src/items/scheduled/zoom.js","../src/streams/schedule.js","../src/items/modification.js","../src/items/conversion.js","../src/actions/email.js","../src/items/history-activity.js","../src/items/email.js","../src/actions/call.js","../src/items/call.js","../src/items/meeting.js","../src/items/task.js","../src/items/webform.js","../src/items/request.js","../src/items/openline.js","../src/items/rest.js","../src/items/visit.js","../src/items/zoom.js","../src/items/order-modification.js","../src/items/external-notice-modification.js","../src/items/external-notice-status-modification.js","../src/items/creation.js","../src/items/restoration.js","../src/items/relation.js","../src/items/link.js","../src/items/unlink.js","../src/items/mark.js","../src/items/comment.js","../src/items/wait.js","../src/items/document.js","../src/items/sender.js","../src/items/bizproc.js","../src/items/scoring.js","../src/animations/expand.js","../src/streams/history.js","../src/streams/fixedhistory.js","../src/pull-action-processor.js","../src/manager.js","../src/actions/schedule-postpone.js","../src/animations/comment.js","../src/index.js"],"sourcesContent":["/** @memberof BX.Crm.Timeline.Types */\nexport const Item = {\n\tundefined: 0,\n\tactivity: 1,\n\tcreation: 2,\n\tmodification: 3,\n\tlink: 4,\n\tunlink: 5,\n\tmark: 6,\n\tcomment: 7,\n\twait: 8,\n\tbizproc: 9,\n\tconversion: 10,\n\tsender: 11,\n\tdocument: 12,\n\trestoration: 13,\n\torder: 14,\n\torderCheck: 15,\n\tscoring: 16,\n\texternalNotification: 17,\n\tfinalSummary: 18,\n\tdelivery: 19,\n\tfinalSummaryDocuments: 20,\n\tstoreDocument: 21,\n\tproductCompilation: 22,\n\tsignDocument: 23,\n};\n\n/** @memberof BX.Crm.Timeline.Types */\nexport const Mark = {\n\tundefined: 0,\n\twaiting: 1,\n\tsuccess: 2,\n\trenew: 3,\n\tignored: 4,\n\tfailed: 5\n};\n\n/** @memberof BX.Crm.Timeline.Types */\n\n/** @memberof BX.Crm.Timeline.Types */\nexport const Order = {\n\tencourageBuyProducts: 100,\n};\n\n/** @memberof BX.Crm.Timeline.Types */\nexport const EditorMode = {\n\tview: 1,\n\tedit: 2\n};\n","import {Item as ItemType} from \"../types\";\nimport {Item} from \"crm.timeline.item\";\nimport {Type} from \"main.core\";\nimport {TimezoneOffset} from \"crm.datetime\";\n\n/** @memberof BX.Crm.Timeline */\nexport default class CompatibleItem extends Item\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._id = \"\";\n\t\tthis._settings = {};\n\t\tthis._data = {};\n\t\tthis._container = null;\n\n\t\tthis._typeCategoryId = null;\n\t\tthis._associatedEntityData = null;\n\t\tthis._associatedEntityTypeId = null;\n\t\tthis._associatedEntityId = null;\n\t\tthis._isContextMenuShown = false;\n\t\tthis._contextMenuButton = null;\n\n\t\tthis._activityEditor = null;\n\t\tthis._actions = [];\n\t\tthis._actionContainer = null;\n\n\t\tthis._existedStreamItemDeadLine = null;\n\t}\n\n\tinitialize(id, settings)\n\t{\n\t\tthis._setId(id);\n\t\tthis._settings = settings ? settings : {};\n\n\t\tthis._container = this.getSetting(\"container\");\n\n\t\tif(!BX.type.isPlainObject(settings['data']))\n\t\t{\n\t\t\tthrow \"Item. A required parameter 'data' is missing.\";\n\t\t}\n\t\tthis._data = settings['data'];\n\n\t\tthis._activityEditor = this.getSetting(\"activityEditor\");\n\n\t\tthis.doInitialize();\n\t}\n\n\tdoInitialize()\n\t{\n\t}\n\n\tgetId()\n\t{\n\t\treturn this._id;\n\t}\n\n\tgetSetting(name, defaultval)\n\t{\n\t\treturn this._settings.hasOwnProperty(name) ? this._settings[name] : defaultval;\n\t}\n\n\tgetData()\n\t{\n\t\treturn this._data;\n\t}\n\n\tsetData(data)\n\t{\n\t\tif(BX.type.isPlainObject(data))\n\t\t{\n\t\t\tthis._data = data;\n\t\t\tthis.clearCachedData();\n\t\t}\n\t}\n\n\tgetSort(): Array\n\t{\n\t\treturn this._data['sort'] ?? [];\n\t}\n\n\tgetAssociatedEntityData()\n\t{\n\t\tif(this._associatedEntityData === null)\n\t\t{\n\t\t\tthis._associatedEntityData = BX.type.isPlainObject(this._data[\"ASSOCIATED_ENTITY\"])\n\t\t\t\t? this._data[\"ASSOCIATED_ENTITY\"] : {};\n\t\t}\n\n\t\treturn this._associatedEntityData;\n\t}\n\n\tgetAssociatedEntityTypeId()\n\t{\n\t\tif(this._associatedEntityTypeId === null)\n\t\t{\n\t\t\tthis._associatedEntityTypeId = BX.prop.getInteger(this._data, \"ASSOCIATED_ENTITY_TYPE_ID\", 0)\n\t\t}\n\t\treturn this._associatedEntityTypeId;\n\t}\n\n\tgetAssociatedEntityId()\n\t{\n\t\tif(this._associatedEntityId === null)\n\t\t{\n\t\t\tthis._associatedEntityId = BX.prop.getInteger(this._data, \"ASSOCIATED_ENTITY_ID\", 0)\n\t\t}\n\t\treturn this._associatedEntityId;\n\t}\n\n\tsetAssociatedEntityData(associatedEntityData)\n\t{\n\t\tif(!BX.type.isPlainObject(associatedEntityData))\n\t\t{\n\t\t\tassociatedEntityData = {};\n\t\t}\n\n\t\tconst data = this._data;\n\t\tdata.ASSOCIATED_ENTITY = associatedEntityData;\n\n\t\tthis.setData(data);\n\t}\n\n\thasPermissions()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\treturn BX.type.isPlainObject(entityData[\"PERMISSIONS\"]);\n\t}\n\n\tgetPermissions()\n\t{\n\t\treturn BX.prop.getObject(this.getAssociatedEntityData(), \"PERMISSIONS\", {});\n\t}\n\n\tsetPermissions(permissions)\n\t{\n\t\tconst data = this._data;\n\n\t\tif(!Type.isPlainObject(data.ASSOCIATED_ENTITY))\n\t\t{\n\t\t\tdata.ASSOCIATED_ENTITY = {};\n\t\t}\n\n\t\tdata.ASSOCIATED_ENTITY.PERMISSIONS = permissions;\n\n\t\tthis.setData(data);\n\t}\n\n\tgetTextDataParam(name)\n\t{\n\t\treturn BX.prop.getString(this._data, name, \"\");\n\t}\n\n\tgetObjectDataParam(name)\n\t{\n\t\treturn BX.prop.getObject(this._data, name, {});\n\t}\n\n\tgetArrayDataParam(name)\n\t{\n\t\treturn BX.prop.getArray(this._data, name, []);\n\t}\n\n\tgetTypeId()\n\t{\n\t\treturn ItemType.undefined;\n\t}\n\n\tgetTypeCategoryId()\n\t{\n\t\tif(this._typeCategoryId === null)\n\t\t{\n\t\t\tthis._typeCategoryId = BX.prop.getInteger(this._data, \"TYPE_CATEGORY_ID\", 0);\n\t\t}\n\t\treturn this._typeCategoryId;\n\t}\n\n\tgetContainer()\n\t{\n\t\treturn this._container;\n\t}\n\n\tsetContainer(container)\n\t{\n\t\tthis._container = BX.type.isElementNode(container) ? container : null;\n\t}\n\n\tlayout(options)\n\t{\n\t\tif(!BX.type.isElementNode(this._container))\n\t\t{\n\t\t\tthrow \"Item. Container is not assigned.\";\n\t\t}\n\n\t\tthis.prepareLayout(options);\n\t\t//region Actions\n\t\t/**/\n\t\tthis.prepareActions();\n\t\tconst actionQty = this._actions.length;\n\t\tfor(let i = 0; i < actionQty; i++)\n\t\t{\n\t\t\tthis._actions[i].layout();\n\t\t}\n\t\tthis.showActions(actionQty > 0);\n\t\t/**/\n\t\t//endregion\n\t}\n\n\tprepareLayout(options)\n\t{\n\t}\n\n\tprepareActions()\n\t{\n\t}\n\n\tshowActions(show)\n\t{\n\t}\n\n\tclearCachedData()\n\t{\n\t\tthis._typeCategoryId = null;\n\t\tthis._associatedEntityData = null;\n\t\tthis._associatedEntityTypeId = null;\n\t\tthis._associatedEntityId = null;\n\t}\n\n\tisDone()\n\t{\n\t\treturn false;\n\t}\n\n\tmarkAsDone(isDone)\n\t{\n\t}\n\n\tview()\n\t{\n\t}\n\n\tedit()\n\t{\n\t}\n\n\tfasten()\n\t{\n\t}\n\n\tunfasten()\n\t{\n\t}\n\n\tremove()\n\t{\n\t}\n\n\tcutOffText(text, length)\n\t{\n\t\tif(!BX.type.isNumber(length))\n\t\t{\n\t\t\tlength = 0;\n\t\t}\n\n\t\tif(length <= 0 || text.length <= length)\n\t\t{\n\t\t\treturn text;\n\t\t}\n\n\t\tlet offset = length - 1;\n\t\tconst whilespaceOffset = text.substring(offset).search(/\\s/i);\n\t\tif(whilespaceOffset > 0)\n\t\t{\n\t\t\toffset += whilespaceOffset;\n\t\t}\n\t\treturn text.substring(0, offset);\n\t}\n\n\tprepareMultilineCutOffElements(text, length, clickHandler)\n\t{\n\t\tif(!BX.type.isNumber(length))\n\t\t{\n\t\t\tlength = 0;\n\t\t}\n\n\t\tif(length <= 0 || text.length <= length)\n\t\t{\n\t\t\treturn [BX.util.htmlspecialchars(text).replace(/(?:\\r\\n|\\r|\\n)/g, '<br>')];\n\t\t}\n\n\t\tlet offset = length - 1;\n\t\tconst whilespaceOffset = text.substring(offset).search(/\\s/i);\n\t\tif(whilespaceOffset > 0)\n\t\t{\n\t\t\toffset += whilespaceOffset;\n\t\t}\n\t\treturn(\n\t\t\t[\n\t\t\t\tBX.util.htmlspecialchars(text.substring(0, offset)).replace(/(?:\\r\\n|\\r|\\n)/g, '<br>') + \"&hellip;&nbsp;\" ,\n\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-letter-more\", href: \"#\" },\n\t\t\t\t\t\tevents: { click: clickHandler },\n\t\t\t\t\t\ttext: this.getMessage(\"details\")\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t]\n\t\t);\n\t}\n\n\tprepareCutOffElements(text, length, clickHandler)\n\t{\n\t\tif(!BX.type.isNumber(length))\n\t\t{\n\t\t\tlength = 0;\n\t\t}\n\n\t\tif(length <= 0 || text.length <= length)\n\t\t{\n\t\t\treturn [BX.util.htmlspecialchars(text)];\n\t\t}\n\n\t\tlet offset = length - 1;\n\t\tconst whilespaceOffset = text.substring(offset).search(/\\s/i);\n\t\tif(whilespaceOffset > 0)\n\t\t{\n\t\t\toffset += whilespaceOffset;\n\t\t}\n\t\treturn(\n\t\t\t[\n\t\t\t\tBX.util.htmlspecialchars(text.substring(0, offset)) + \"&hellip;&nbsp;\" ,\n\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-letter-more\", href: \"#\" },\n\t\t\t\t\t\tevents: { click: clickHandler },\n\t\t\t\t\t\ttext: this.getMessage(\"details\")\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t]\n\t\t);\n\t}\n\n\tprepareAuthorLayout()\n\t{\n\t\tconst authorInfo = this.getObjectDataParam(\"AUTHOR\", null);\n\t\tif(!authorInfo)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst showUrl = BX.prop.getString(authorInfo, \"SHOW_URL\", \"\");\n\t\tif(showUrl === \"\")\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst link = BX.create(\"A\",\n\t\t\t{\n\t\t\t\tattrs:\n\t\t\t\t\t{\n\t\t\t\t\t\tclassName: \"ui-icon ui-icon-common-user crm-entity-stream-content-detail-employee\",\n\t\t\t\t\t\thref: showUrl,\n\t\t\t\t\t\ttarget: \"_blank\",\n\t\t\t\t\t\ttitle: BX.prop.getString(authorInfo, \"FORMATTED_NAME\", \"\")\n\t\t\t\t\t},\n\t\t\t\tchildren: [\n\t\t\t\t\tBX.create('i', {})\n\t\t\t\t]\n\t\t\t}\n\t\t);\n\t\tconst imageUrl = BX.prop.getString(authorInfo, \"IMAGE_URL\", \"\");\n\t\tif(imageUrl !== \"\")\n\t\t{\n\t\t\tlink.children[0].style.backgroundImage = \"url('\" + encodeURI(imageUrl) + \"')\";\n\t\t\tlink.children[0].style.backgroundSize = \"21px\";\n\t\t}\n\n\t\treturn link;\n\t}\n\n\tonActivityCreate(activity, data)\n\t{\n\t}\n\n\tisContextMenuEnabled()\n\t{\n\t\treturn false;\n\t}\n\n\tprepareContextMenuButton()\n\t{\n\t\tthis._contextMenuButton = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: { className: \"crm-entity-stream-section-context-menu\" },\n\t\t\t\tevents: { click: BX.delegate(this.onContextMenuButtonClick, this) }\n\t\t\t}\n\t\t);\n\t\treturn this._contextMenuButton;\n\t}\n\n\tonContextMenuButtonClick(e)\n\t{\n\t\tif(!this._isContextMenuShown)\n\t\t{\n\t\t\tthis.openContextMenu();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.closeContextMenu();\n\t\t}\n\t}\n\n\topenContextMenu()\n\t{\n\t\tconst menuItems = this.prepareContextMenuItems();\n\n\t\tif (typeof IntranetExtensions !== \"undefined\")\n\t\t{\n\t\t\tmenuItems.push(IntranetExtensions);\n\t\t}\n\n\t\tif(menuItems.length === 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tBX.PopupMenu.show(\n\t\t\tthis._id,\n\t\t\tthis._contextMenuButton,\n\t\t\tmenuItems,\n\t\t\t{\n\t\t\t\toffsetTop: 0,\n\t\t\t\toffsetLeft: 16,\n\t\t\t\tangle: { position: \"top\", offset: 0 },\n\t\t\t\tevents:\n\t\t\t\t\t{\n\t\t\t\t\t\tonPopupShow: BX.delegate(this.onContextMenuShow, this),\n\t\t\t\t\t\tonPopupClose: BX.delegate(this.onContextMenuClose, this),\n\t\t\t\t\t\tonPopupDestroy: BX.delegate(this.onContextMenuDestroy, this)\n\t\t\t\t\t}\n\t\t\t}\n\t\t);\n\t\tthis._contextMenu = BX.PopupMenu.currentItem;\n\t}\n\n\tcloseContextMenu()\n\t{\n\t\tif(this._contextMenu)\n\t\t{\n\t\t\tthis._contextMenu.close();\n\t\t}\n\t}\n\n\tprepareContextMenuItems()\n\t{\n\t\treturn [];\n\t}\n\n\tonContextMenuShow()\n\t{\n\t\tthis._isContextMenuShown = true;\n\t\tBX.addClass(this._contextMenuButton, \"active\");\n\t}\n\n\tonContextMenuClose()\n\t{\n\t\tif(this._contextMenu)\n\t\t{\n\t\t\tthis._contextMenu.popupWindow.destroy();\n\t\t}\n\t}\n\n\tonContextMenuDestroy()\n\t{\n\t\tthis._isContextMenuShown = false;\n\t\tBX.removeClass(this._contextMenuButton, \"active\");\n\t\tthis._contextMenu = null;\n\n\t\tif(typeof(BX.PopupMenu.Data[this._id]) !== \"undefined\")\n\t\t{\n\t\t\tdelete(BX.PopupMenu.Data[this._id]);\n\t\t}\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = CompatibleItem.messages;\n\t\treturn m.hasOwnProperty(name) ? m[name] : name;\n\t}\n\n\tstatic getUserTimezoneOffset()\n\t{\n\t\treturn TimezoneOffset.USER_TO_SERVER;\n\t}\n\n\tstatic messages = {};\n}\n","/** @memberof BX.Crm.Timeline.Animation */\nexport default class Fasten\n{\n\tconstructor()\n\t{\n\t\tthis._id = \"\";\n\t\tthis._settings = {};\n\t\tthis._initialItem = null;\n\t\tthis._finalItem = null;\n\t\tthis._events = null;\n\t}\n\n\tinitialize(id, settings)\n\t{\n\t\tthis._id = BX.type.isNotEmptyString(id) ? id : BX.util.getRandomString(4);\n\t\tthis._settings = settings ? settings : {};\n\n\t\tthis._initialItem = this.getSetting(\"initialItem\");\n\t\tthis._finalItem = this.getSetting(\"finalItem\");\n\n\t\tthis._anchor = this.getSetting(\"anchor\");\n\t\tthis._events = this.getSetting(\"events\", {});\n\t}\n\n\tgetId()\n\t{\n\t\treturn this._id;\n\t}\n\n\tgetSetting(name, defaultValue)\n\t{\n\t\treturn this._settings.hasOwnProperty(name) ? this._settings[name] : defaultValue;\n\t}\n\n\taddFixedHistoryItem()\n\t{\n\t\tconst node = this._finalItem.getWrapper();\n\t\tBX.addClass(node, 'crm-entity-stream-section-animate-start');\n\t\tif (this._anchor.parentNode && node)\n\t\t{\n\t\t\tthis._anchor.parentNode.insertBefore(node, this._anchor.nextSibling);\n\t\t}\n\t\tsetTimeout( BX.delegate(\n\t\t\tfunction() {\n\t\t\t\tBX.removeClass(node, 'crm-entity-stream-section-animate-start');\n\t\t\t},\n\t\t\tthis\n\t\t), 0);\n\t}\n\n\trun()\n\t{\n\t\tconst node = this._initialItem.getWrapper();\n\t\tthis._clone = node.cloneNode(true);\n\n\t\tBX.addClass(this._clone, 'crm-entity-stream-section-animate-start crm-entity-stream-section-top-fixed');\n\n\t\tthis._startPosition = BX.pos(node);\n\t\tthis._clone.style.position = \"absolute\";\n\t\tthis._clone.style.width = this._startPosition.width + \"px\";\n\n\t\tlet _cloneHeight = this._startPosition.height;\n\t\tconst _minHeight = 65;\n\t\tconst _sumPaddingContent = 18;\n\t\tif (_cloneHeight < _sumPaddingContent + _minHeight)\n\t\t\t_cloneHeight = _sumPaddingContent + _minHeight;\n\n\t\tthis._clone.style.height = _cloneHeight + \"px\";\n\t\tthis._clone.style.top = this._startPosition.top + \"px\";\n\t\tthis._clone.style.left = this._startPosition.left + \"px\";\n\t\tthis._clone.style.zIndex = 960;\n\n\t\tdocument.body.appendChild(this._clone);\n\n\t\tsetTimeout(\n\t\t\tBX.proxy(\n\t\t\t\tfunction (){\n\t\t\t\t\tBX.addClass(this._clone, \"crm-entity-stream-section-casper\" )\n\t\t\t\t},\n\t\t\t\tthis\n\t\t\t),\n\t\t\t0\n\t\t);\n\n\t\tthis._anchorPosition = BX.pos(this._anchor);\n\t\tconst finish = {\n\t\t\ttop: this._anchorPosition.top,\n\t\t\theight: _cloneHeight + 15,\n\t\t\topacity: 1\n\t\t};\n\n\t\tconst _difference = this._startPosition.top - this._anchorPosition.bottom;\n\t\tconst _deepHistoryLimit = 2 * (document.body.clientHeight + this._startPosition.height);\n\n\t\tif (_difference > _deepHistoryLimit)\n\t\t{\n\t\t\tfinish.top = this._startPosition.top - _deepHistoryLimit;\n\t\t\tfinish.opacity = 0;\n\t\t}\n\n\t\tlet _duration = Math.abs(finish.top - this._startPosition.top) * 2;\n\t\t_duration = (_duration < 1500) ? 1500 : _duration;\n\n\t\tconst movingEvent = new BX.easing({\n\t\t\tduration: _duration,\n\t\t\tstart: {top: this._startPosition.top, height: 0, opacity: 1},\n\t\t\tfinish: finish,\n\t\t\ttransition: BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\tstep: BX.proxy(function (state) {\n\t\t\t\tthis._clone.style.top = state.top + \"px\";\n\t\t\t\tthis._clone.style.opacity = state.opacity;\n\t\t\t\tthis._anchor.style.height = state.height + \"px\";\n\t\t\t}, this),\n\t\t\tcomplete: BX.proxy(function () {\n\t\t\t\tthis.finish();\n\t\t\t}, this)\n\t\t});\n\t\tmovingEvent.animate();\n\t}\n\n\tfinish()\n\t{\n\t\tthis._anchor.style.height = 0;\n\t\tthis.addFixedHistoryItem();\n\t\tBX.remove(this._clone);\n\n\t\tif(BX.type.isFunction(this._events[\"complete\"]))\n\t\t{\n\t\t\tthis._events[\"complete\"]();\n\t\t}\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Fasten();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import CompatibleItem from \"./compatible-item\";\nimport {Item as ItemType} from \"../types\";\nimport Fasten from \"../animations/fasten\";\nimport {DatetimeConverter} from \"crm.timeline.tools\";\nimport {Type, Dom} from \"main.core\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class History extends CompatibleItem\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._history = null;\n\t\tthis._fixedHistory = null;\n\t\tthis._typeId = null;\n\t\tthis._createdTime = null;\n\t\tthis._isFixed = false;\n\t\tthis._headerClickHandler = BX.delegate(this.onHeaderClick, this);\n\t}\n\n\tdoInitialize()\n\t{\n\t\tthis._history = this.getSetting(\"history\");\n\t\tthis._fixedHistory = this.getSetting(\"fixedHistory\");\n\t}\n\n\tgetTypeId()\n\t{\n\t\tif(this._typeId === null)\n\t\t{\n\t\t\tthis._typeId = BX.prop.getInteger(this._data, \"TYPE_ID\", ItemType.undefined);\n\t\t}\n\t\treturn this._typeId;\n\t}\n\n\tgetTitle()\n\t{\n\t\treturn \"\";\n\t}\n\n\tisContextMenuEnabled()\n\t{\n\t\treturn !(this.isReadOnly());\n\t}\n\n\tgetCreatedTimestamp()\n\t{\n\t\treturn this.getTextDataParam(\"CREATED_SERVER\");\n\t}\n\n\tgetCreatedTime()\n\t{\n\t\tif(this._createdTime === null)\n\t\t{\n\t\t\tconst time = BX.parseDate(\n\t\t\t\tthis.getCreatedTimestamp(),\n\t\t\t\tfalse,\n\t\t\t\t\"YYYY-MM-DD\",\n\t\t\t\t\"YYYY-MM-DD HH:MI:SS\"\n\t\t\t);\n\n\t\t\tthis._createdTime = (new DatetimeConverter(time)).toUserTime().getValue();\n\t\t}\n\t\treturn this._createdTime;\n\t}\n\n\tgetCreatedDate()\n\t{\n\t\treturn BX.prop.extractDate(new Date(this.getCreatedTime().getTime()));\n\t}\n\n\tgetOwnerInfo()\n\t{\n\t\treturn this._history ? this._history.getOwnerInfo() : null;\n\t}\n\n\tgetOwnerTypeId()\n\t{\n\t\treturn BX.prop.getInteger(this.getOwnerInfo(), \"ENTITY_TYPE_ID\", BX.CrmEntityType.enumeration.undefined);\n\t}\n\n\tgetOwnerId()\n\t{\n\t\treturn BX.prop.getInteger(this.getOwnerInfo(), \"ENTITY_ID\", 0);\n\t}\n\n\tisReadOnly()\n\t{\n\t\treturn this._history.isReadOnly();\n\t}\n\n\tisEditable()\n\t{\n\t\treturn !this.isReadOnly();\n\t}\n\n\tisDone()\n\t{\n\t\tconst typeId = this.getTypeId();\n\t\tif(typeId === ItemType.activity)\n\t\t{\n\t\t\tconst entityData = this.getAssociatedEntityData();\n\t\t\treturn BX.CrmActivityStatus.isFinal(BX.prop.getInteger(entityData, \"STATUS\", 0));\n\t\t}\n\t\treturn false;\n\t}\n\n\tisFixed()\n\t{\n\t\treturn this._isFixed;\n\t}\n\n\t/**\n\t * deprecated\n\t */\n\tfasten(e)\n\t{\n\t\tif (this._fixedHistory._items.length >= 3)\n\t\t{\n\t\t\tif (!this.fastenLimitPopup)\n\t\t\t{\n\t\t\t\tthis.fastenLimitPopup = new BX.PopupWindow(\n\t\t\t\t\t'timeline_fasten_limit_popup_' + this._id,\n\t\t\t\t\tthis._switcher,\n\t\t\t\t\t{\n\t\t\t\t\t\tcontent: BX.message('CRM_TIMELINE_FASTEN_LIMIT_MESSAGE'),\n\t\t\t\t\t\tdarkMode: true,\n\t\t\t\t\t\tautoHide: true,\n\t\t\t\t\t\tzIndex: 990,\n\t\t\t\t\t\tangle: true,\n\t\t\t\t\t\tcloseByEsc: true,\n\t\t\t\t\t\tbindOptions: { forceBindPosition: true}\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tthis.fastenLimitPopup.show();\n\t\t\tthis.closeContextMenu();\n\t\t\treturn;\n\t\t}\n\t\tBX.ajax(\n\t\t\t{\n\t\t\t\turl: this._history._serviceUrl,\n\t\t\t\tmethod: \"POST\",\n\t\t\t\tdataType: \"json\",\n\t\t\t\tdata:\n\t\t\t\t\t{\n\t\t\t\t\t\t\"ACTION\": \"CHANGE_FASTEN_ITEM\",\n\t\t\t\t\t\t\"VALUE\": 'Y',\n\t\t\t\t\t\t\"OWNER_TYPE_ID\":  this.getOwnerTypeId(),\n\t\t\t\t\t\t\"OWNER_ID\": this.getOwnerId(),\n\t\t\t\t\t\t\"ID\": this._id\n\t\t\t\t\t},\n\t\t\t}\n\t\t);\n\n\t\tthis.closeContextMenu();\n\t}\n\n\t/**\n\t * deprecated\n\t */\n\tonSuccessFasten(result)\n\t{\n\t\tif (result && BX.type.isNotEmptyString(result.ERROR))\n\t\t\treturn;\n\n\t\tif (!this.isFixed())\n\t\t{\n\t\t\tthis._data.IS_FIXED = 'Y';\n\t\t\tconst fixedItem = this._fixedHistory.createItem(this._data);\n\t\t\tfixedItem._isFixed = true;\n\t\t\tthis._fixedHistory.addItem(fixedItem, 0);\n\t\t\tfixedItem.layout({ add: false });\n\t\t\tthis.refreshLayout();\n\t\t\tconst animation = Fasten.create(\n\t\t\t\t\"\",\n\t\t\t\t{\n\t\t\t\t\tinitialItem: this,\n\t\t\t\t\tfinalItem: fixedItem,\n\t\t\t\t\tanchor: this._fixedHistory._anchor\n\t\t\t\t}\n\t\t\t);\n\t\t\tanimation.run();\n\t\t}\n\n\t\tthis.closeContextMenu();\n\t}\n\n\t/**\n\t * deprecated\n\t */\n\tunfasten(e)\n\t{\n\t\tBX.ajax(\n\t\t\t{\n\t\t\t\turl: this._history._serviceUrl,\n\t\t\t\tmethod: \"POST\",\n\t\t\t\tdataType: \"json\",\n\t\t\t\tdata:\n\t\t\t\t\t{\n\t\t\t\t\t\t\"ACTION\": \"CHANGE_FASTEN_ITEM\",\n\t\t\t\t\t\t\"VALUE\": 'N',\n\t\t\t\t\t\t\"OWNER_TYPE_ID\": this.getOwnerTypeId(),\n\t\t\t\t\t\t\"OWNER_ID\": this.getOwnerId(),\n\t\t\t\t\t\t\"ID\": this._id\n\t\t\t\t\t},\n\t\t\t}\n\t\t);\n\n\t\tthis.closeContextMenu();\n\t}\n\n\t/**\n\t * deprecated\n\t */\n\tonSuccessUnfasten(result)\n\t{\n\t\tif (result && BX.type.isNotEmptyString(result.ERROR))\n\t\t\treturn;\n\n\t\tlet item;\n\t\tlet historyItem;\n\n\t\tif (this.isFixed())\n\t\t{\n\t\t\titem = this;\n\t\t\thistoryItem = this._history.findItemById(this._id);\n\t\t}\n\t\telse\n\t\t{\n\t\t\titem = this._fixedHistory.findItemById(this._id);\n\t\t\thistoryItem = this;\n\t\t}\n\n\t\tif (item)\n\t\t{\n\t\t\tconst index = this._fixedHistory.getItemIndex(item);\n\t\t\titem.clearAnimate();\n\t\t\tthis._fixedHistory.removeItemByIndex(index);\n\t\t\tif (historyItem)\n\t\t\t{\n\t\t\t\thistoryItem._data.IS_FIXED = 'N';\n\t\t\t\thistoryItem.refreshLayout();\n\t\t\t\tBX.LazyLoad.showImages();\n\t\t\t}\n\t\t}\n\t}\n\n\tclearAnimate()\n\t{\n\t\tif (!BX.type.isDomNode(this._wrapper))\n\t\t\treturn ;\n\n\t\tconst wrapperPosition = BX.pos(this._wrapper);\n\t\tconst hideEvent = new BX.easing({\n\t\t\tduration: 1000,\n\t\t\tstart: {height: wrapperPosition.height, opacity: 1, marginBottom: 15},\n\t\t\tfinish: {height: 0, opacity: 0, marginBottom: 0},\n\t\t\ttransition: BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\tstep: BX.proxy(function (state) {\n\t\t\t\tthis._wrapper.style.height = state.height + \"px\";\n\t\t\t\tthis._wrapper.style.opacity = state.opacity;\n\t\t\t\tthis._wrapper.style.marginBottom = state.marginBottom;\n\t\t\t}, this),\n\t\t\tcomplete: BX.proxy(function () {\n\t\t\t\tthis.clearLayout();\n\t\t\t}, this)\n\t\t});\n\n\t\thideEvent.animate();\n\t}\n\n\tgetWrapperClassName()\n\t{\n\t\treturn \"\";\n\t}\n\n\tgetIconClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-icon crm-entity-stream-section-icon-info\";\n\t}\n\n\tprepareContentDetails()\n\t{\n\t\treturn [];\n\t}\n\n\tprepareContent()\n\t{\n\t\tlet wrapperClassName = this.getWrapperClassName();\n\t\tif(wrapperClassName !== \"\")\n\t\t{\n\t\t\twrapperClassName = \"crm-entity-stream-section crm-entity-stream-section-history\" + \" \" + wrapperClassName;\n\t\t}\n\t\telse\n\t\t{\n\t\t\twrapperClassName = \"crm-entity-stream-section crm-entity-stream-section-history\";\n\t\t}\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: wrapperClassName}});\n\t\twrapper.appendChild(BX.create(\"DIV\", { attrs: { className: this.getIconClassName() } }));\n\n\t\tif (this.isContextMenuEnabled())\n\t\t{\n\t\t\tDom.append(this.prepareContextMenuButton(), wrapper);\n\t\t}\n\n\t\tconst contentWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{ attrs: { className: \"crm-entity-stream-section-content\" }, children: [ contentWrapper ] }\n\t\t\t)\n\t\t);\n\n\t\tconst header = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-header\"},\n\t\t\t\tchildren:\n\t\t\t\t\t[\n\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-event-title\"},\n\t\t\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tattrs: {href: \"#\"},\n\t\t\t\t\t\t\t\t\t\t\t\tevents: {click: this._headerClickHandler},\n\t\t\t\t\t\t\t\t\t\t\t\ttext: this.getTitle()\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t),\n\t\t\t\t\t\tBX.create(\"SPAN\",\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-event-time\"},\n\t\t\t\t\t\t\t\ttext: this.formatTime(this.getCreatedTime())\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t)\n\t\t\t\t\t]\n\t\t\t}\n\t\t);\n\n\t\tcontentWrapper.appendChild(header);\n\n\t\tcontentWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail\" },\n\t\t\t\t\tchildren: this.prepareContentDetails()\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontentWrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\treturn wrapper;\n\t}\n\n\tprepareLayout(options)\n\t{\n\t\tthis._wrapper = this.prepareContent();\n\t\tif(this._wrapper)\n\t\t{\n\t\t\tconst enableAdd = BX.type.isPlainObject(options) ? BX.prop.getBoolean(options, \"add\", true) : true;\n\t\t\tif(enableAdd)\n\t\t\t{\n\t\t\t\tconst anchor = BX.type.isPlainObject(options) && BX.type.isElementNode(options[\"anchor\"]) ? options[\"anchor\"] : null;\n\t\t\t\tif(anchor && anchor.nextSibling)\n\t\t\t\t{\n\t\t\t\t\tthis._container.insertBefore(this._wrapper,  anchor.nextSibling);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis._container.appendChild(this._wrapper);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.markAsTerminated(this._history.checkItemForTermination(this));\n\t\t}\n\t}\n\n\tonHeaderClick(e)\n\t{\n\t\tthis.view();\n\t\te.preventDefault ? e.preventDefault() : (e.returnValue = false);\n\t}\n\n\tprepareTitleLayout()\n\t{\n\t\treturn BX.create(\"SPAN\", { attrs: { className: \"crm-entity-stream-content-event-title\" }, text: this.getTitle() });\n\t}\n\n\tprepareFixedSwitcherLayout()\n\t{\n\t\tconst isFixed = (this.getTextDataParam(\"IS_FIXED\") === 'Y');\n\t\tthis._switcher = BX.create(\"span\",\n\t\t\t{\n\t\t\t\tattrs: { className: \"crm-entity-stream-section-top-fixed-btn\" },\n\t\t\t\tevents: {\n\t\t\t\t\tclick: isFixed ? BX.delegate(this.unfasten, this) : BX.delegate(this.fasten, this)\n\t\t\t\t}\n\t\t\t});\n\t\tif (isFixed)\n\t\t\tBX.addClass(this._switcher, \"crm-entity-stream-section-top-fixed-btn-active\");\n\n\t\tif (!this.isReadOnly() && !isFixed)\n\t\t{\n\t\t\tconst manager = this._history.getManager();\n\t\t\tif (!manager.isSpotlightShowed())\n\t\t\t{\n\t\t\t\tmanager.setSpotlightShowed();\n\t\t\t\tBX.addClass(this._switcher, \"crm-entity-stream-section-top-fixed-btn-spotlight\");\n\t\t\t\tconst spotlight = new BX.SpotLight({\n\t\t\t\t\ttargetElement: this._switcher,\n\t\t\t\t\ttargetVertex: \"middle-center\",\n\t\t\t\t\tlightMode: false,\n\t\t\t\t\tid: \"CRM_TIMELINE_FASTEN_SWITCHER\",\n\t\t\t\t\tzIndex: 900,\n\t\t\t\t\ttop: -3,\n\t\t\t\t\tleft: -1,\n\t\t\t\t\tautoSave: true,\n\t\t\t\t\tcontent: BX.message('CRM_TIMELINE_SPOTLIGHT_FASTEN_MESSAGE')\n\t\t\t\t});\n\t\t\t\tspotlight.show();\n\t\t\t}\n\t\t}\n\n\t\treturn this._switcher;\n\t}\n\n\tprepareHeaderLayout()\n\t{\n\t\tconst header = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-header\"}});\n\t\theader.appendChild(this.prepareTitleLayout());\n\n\t\tconst statusNode = this.getStatusNode();\n\t\tif (Type.isDomNode(statusNode))\n\t\t{\n\t\t\tDom.append(statusNode, header);\n\t\t}\n\n\t\theader.appendChild(\n\t\t\tBX.create(\"SPAN\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-event-time\" },\n\t\t\t\t\ttext: this.formatTime(this.getCreatedTime())\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\treturn header;\n\t}\n\n\tgetStatusNode(): ?HTMLElement\n\t{\n\t\treturn null;\n\t}\n\n\tonActivityCreate(activity, data)\n\t{\n\t\tthis._history.getManager().onActivityCreated(activity, data);\n\t}\n\n\tformatTime(time)\n\t{\n\t\tif (this.isFixed())\n\t\t{\n\t\t\treturn this._fixedHistory.formatTime(time);\n\t\t}\n\n\t\treturn this._history.formatTime(time);\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new History();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n\n\tstatic isCounterEnabled(deadline)\n\t{\n\t\tif(!BX.type.isDate(deadline))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tlet start = new Date();\n\t\tstart.setHours(0);\n\t\tstart.setMinutes(0);\n\t\tstart.setSeconds(0);\n\t\tstart.setMilliseconds(0);\n\t\tstart = start.getTime();\n\n\t\tlet end = new Date();\n\t\tend.setHours(23);\n\t\tend.setMinutes(59);\n\t\tend.setSeconds(59);\n\t\tend.setMilliseconds(999);\n\t\tend = end.getTime();\n\n\t\tconst time = deadline.getTime();\n\t\treturn time < start || (time >= start && time <= end);\n\t}\n\n\tstatic isCounterEnabledByLightTime(lightTime)\n\t{\n\t\tif(!BX.type.isDate(lightTime))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst now = (new Date()).getTime();\n\n\t\tconst time = lightTime.getTime();\n\t\treturn time < now;\n\t}\n}\n","import CompatibleItem from \"./compatible-item\";\nimport History from \"./history\";\nimport {Item as ItemType} from \"../types\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Scheduled extends CompatibleItem\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._schedule = null;\n\t\tthis._deadlineNode = null;\n\n\t\tthis._headerClickHandler = BX.delegate(this.onHeaderClick, this);\n\t\tthis._setAsDoneButtonHandler = BX.delegate(this.onSetAsDoneButtonClick, this);\n\t}\n\n\tdoInitialize()\n\t{\n\t\tthis._schedule = this.getSetting(\"schedule\");\n\t\tif(!(this._activityEditor instanceof BX.CrmActivityEditor))\n\t\t{\n\t\t\tthrow \"Scheduled. The field 'activityEditor' is not assigned.\";\n\t\t}\n\n\t\tif(this.hasPermissions() && !this.verifyPermissions())\n\t\t{\n\t\t\tthis.loadPermissions();\n\t\t}\n\t}\n\n\tgetTypeId()\n\t{\n\t\treturn ItemType.undefined;\n\t}\n\n\tverifyPermissions()\n\t{\n\t\tconst userId = BX.prop.getInteger(this.getPermissions(), \"USER_ID\", 0);\n\t\treturn userId <= 0 || userId === this._schedule.getUserId();\n\t}\n\n\tloadPermissions()\n\t{\n\t\tBX.ajax(\n\t\t\t{\n\t\t\t\turl: this._schedule.getServiceUrl(),\n\t\t\t\tmethod: \"POST\",\n\t\t\t\tdataType: \"json\",\n\t\t\t\tdata: { \"ACTION\": \"GET_PERMISSIONS\", \"TYPE_ID\": this.getTypeId(), \"ID\": this.getAssociatedEntityId() },\n\t\t\t\tonsuccess: this.onPermissionsLoad.bind(this)\n\t\t\t}\n\t\t);\n\t}\n\n\tonPermissionsLoad(result)\n\t{\n\t\tconst permissions = BX.prop.getObject(result, \"PERMISSIONS\", null);\n\t\tif(!permissions)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.setPermissions(permissions);\n\t\twindow.setTimeout(function(){ this.refreshLayout(); }.bind(this), 0);\n\t}\n\n\tgetDeadline()\n\t{\n\t\treturn null;\n\t}\n\n\tgetLightTime()\n\t{\n\t\treturn null;\n\t}\n\n\thasDeadline()\n\t{\n\t\treturn BX.type.isDate(this.getDeadline());\n\t}\n\n\tisCounterEnabled()\n\t{\n\t\tif (this.isDone())\n\t\t{\n\t\t\treturn this._existedStreamItemDeadLine && History.isCounterEnabledByLightTime(this._existedStreamItemDeadLine);\n\t\t}\n\n\t\tconst lightTime = this.getLightTime();\n\n\t\treturn lightTime && History.isCounterEnabledByLightTime(lightTime);\n\t}\n\n\tisIncomingChannel()\n\t{\n\t\treturn false;\n\t}\n\n\tgetSourceId()\n\t{\n\t\treturn BX.prop.getInteger(this.getAssociatedEntityData(), \"ID\", 0);\n\t}\n\n\tonSetAsDoneCompleted(data)\n\t{\n\t\tif(!BX.prop.getBoolean(data, \"COMPLETED\"))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.markAsDone(true);\n\t\tthis._schedule.onItemMarkedAsDone(\n\t\t\tthis,\n\t\t\t{ 'historyItemData': BX.prop.getObject(data, \"HISTORY_ITEM\") }\n\t\t);\n\t}\n\n\tonPosponeCompleted(data)\n\t{\n\t}\n\n\trefreshDeadline()\n\t{\n\t\tthis._deadlineNode.innerHTML = this.formatDateTime(this.getDeadline());\n\t}\n\n\tformatDateTime(time)\n\t{\n\t\treturn this._schedule.formatDateTime(time);\n\t}\n\n\tgetWrapperClassName()\n\t{\n\t\treturn \"\";\n\t}\n\n\tgetIconClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-icon\";\n\t}\n\n\tisReadOnly()\n\t{\n\t\treturn this._schedule.isReadOnly();\n\t}\n\n\tisEditable()\n\t{\n\t\treturn !this.isReadOnly();\n\t}\n\n\tcanPostpone()\n\t{\n\t\tif(this.isReadOnly())\n\t\t{\n\t\t\treturn false;\n\t\t}\n\t\tif (this.isIncomingChannel())\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst perms = BX.prop.getObject(this.getAssociatedEntityData(), \"PERMISSIONS\", {});\n\t\treturn BX.prop.getBoolean(perms, \"POSTPONE\", false);\n\t}\n\n\tisDone()\n\t{\n\t\treturn BX.CrmActivityStatus.isFinal(\n\t\t\tBX.prop.getInteger(this.getAssociatedEntityData(), \"STATUS\", 0)\n\t\t);\n\t}\n\n\tcanComplete()\n\t{\n\t\tif(this.isReadOnly())\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst perms = BX.prop.getObject(this.getAssociatedEntityData(), \"PERMISSIONS\", {});\n\t\treturn BX.prop.getBoolean(perms, \"COMPLETE\", false);\n\t}\n\n\tsetAsDone(isDone)\n\t{\n\t}\n\n\tprepareContent(options)\n\t{\n\t\treturn null;\n\t}\n\n\tprepareLayout(options)\n\t{\n\t\tthis._wrapper = this.prepareContent();\n\t\tif(this._wrapper)\n\t\t{\n\t\t\tconst enableAdd = BX.type.isPlainObject(options) ? BX.prop.getBoolean(options, \"add\", true) : true;\n\t\t\tif(enableAdd)\n\t\t\t{\n\t\t\t\tconst anchor = BX.type.isPlainObject(options) && BX.type.isElementNode(options[\"anchor\"]) ? options[\"anchor\"] : null;\n\t\t\t\tif(anchor && anchor.nextSibling)\n\t\t\t\t{\n\t\t\t\t\tthis._container.insertBefore(this._wrapper, anchor.nextSibling);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis._container.appendChild(this._wrapper);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.markAsTerminated(this._schedule.checkItemForTermination(this));\n\t\t}\n\t}\n\n\tonHeaderClick(e)\n\t{\n\t\tthis.view();\n\t\te.preventDefault ? e.preventDefault() : (e.returnValue = false);\n\t}\n\n\tonSetAsDoneButtonClick(e)\n\t{\n\t\tif(this.canComplete())\n\t\t{\n\t\t\tthis.setAsDone(!this.isDone());\n\t\t}\n\t}\n\n\tonActivityCreate(activity, data)\n\t{\n\t\tthis._schedule.getManager().onActivityCreated(activity, data);\n\t}\n\n\tstatic isDone(data)\n\t{\n\t\tconst entityData = BX.prop.getObject(data, \"ASSOCIATED_ENTITY\", {});\n\t\treturn BX.CrmActivityStatus.isFinal(BX.prop.getInteger(entityData, \"STATUS\", 0));\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Scheduled();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","/** @memberof BX.Crm.Timeline.Animation */\nexport default class Item\n{\n\tconstructor()\n\t{\n\t\tthis._id = \"\";\n\t\tthis._settings = {};\n\t\tthis._initialItem = null;\n\t\tthis._finalItem = null;\n\t\tthis._events = null;\n\t}\n\n\tinitialize(id, settings)\n\t{\n\t\tthis._id = BX.type.isNotEmptyString(id) ? id : BX.util.getRandomString(4);\n\t\tthis._settings = settings ? settings : {};\n\n\t\tthis._initialItem = this.getSetting(\"initialItem\");\n\t\tthis._finalItem = this.getSetting(\"finalItem\");\n\n\t\tthis._anchor = this.getSetting(\"anchor\");\n\t\tthis._events = this.getSetting(\"events\", {});\n\t}\n\n\tgetId()\n\t{\n\t\treturn this._id;\n\t}\n\n\tgetSetting(name, defaultval)\n\t{\n\t\treturn this._settings.hasOwnProperty(name) ? this._settings[name] : defaultval;\n\t}\n\n\trun()\n\t{\n\t\tthis._node = this._initialItem.getWrapper();\n\t\tconst originalPosition = BX.pos(this._node);\n\t\tthis._initialYPosition = originalPosition.top;\n\t\tthis._initialXPosition = originalPosition.left;\n\t\tthis._initialWidth = this._node.offsetWidth;\n\t\tthis._initialHeight = this._node.offsetHeight;\n\n\t\tthis._anchorYPosition = BX.pos(this._anchor).top;\n\n\t\tthis.createStub();\n\t\tthis.createGhost();\n\t\tthis.moveGhost();\n\t}\n\n\tcreateStub()\n\t{\n\t\tthis._stub = BX.create(\n\t\t\t\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: { className: \"crm-entity-stream-section crm-entity-stream-section-planned crm-entity-stream-section-shadow\" },\n\t\t\t\tchildren :\n\t\t\t\t\t[\n\t\t\t\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-icon\" } }),\n\t\t\t\t\t\tBX.create(\n\t\t\t\t\t\t\t\"DIV\",\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tprops: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\t\t\t\tstyle: { height: this._initialHeight + \"px\" }\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t)\n\t\t\t\t\t]\n\t\t\t}\n\t\t);\n\n\t\tthis._node.parentNode.insertBefore(this._stub, this._node);\n\t}\n\n\tcreateGhost()\n\t{\n\t\tthis._ghostNode = this._node;\n\t\tthis._ghostNode.style.position = \"absolute\";\n\t\tthis._ghostNode.style.width = this._initialWidth + \"px\";\n\t\tthis._ghostNode.style.height = this._initialHeight + \"px\";\n\t\tthis._ghostNode.style.top = this._initialYPosition + \"px\";\n\t\tthis._ghostNode.style.left = this._initialXPosition + \"px\";\n\t\tdocument.body.appendChild(this._ghostNode);\n\t\tsetTimeout(BX.proxy(function (){BX.addClass(this._ghostNode, \"crm-entity-stream-section-casper\" )}, this), 20);\n\t}\n\n\tmoveGhost()\n\t{\n\t\tconst node = this._ghostNode;\n\t\tconst movingEvent = new BX.easing({\n\t\t\tduration: 500,\n\t\t\tstart: {top: this._initialYPosition},\n\t\t\tfinish: {top: this._anchorYPosition},\n\t\t\ttransition: BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\tstep: BX.proxy(function (state) {\n\t\t\t\tnode.style.top = state.top + \"px\";\n\t\t\t}, this)\n\t\t});\n\t\tsetTimeout( BX.proxy(function () {\n\t\t\tmovingEvent.animate();\n\t\t\tnode.style.boxShadow = \"\";\n\t\t}, this), 500);\n\n\t\tconst placeEventAnim = new BX.easing({\n\t\t\tduration: 500,\n\t\t\tstart: {height: 0},\n\t\t\tfinish: {height: this._initialHeight + 20},\n\t\t\ttransition: BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\tstep: BX.proxy(function (state) {\n\t\t\t\tthis._anchor.style.height = state.height + \"px\";\n\t\t\t}, this),\n\t\t\tcomplete: BX.proxy(function () {\n\t\t\t\tif (BX.type.isFunction(this._events[\"complete\"]))\n\t\t\t\t{\n\t\t\t\t\tthis._events[\"complete\"]();\n\t\t\t\t}\n\n\t\t\t\tthis.addHistoryItem();\n\t\t\t\tthis.removeGhost();\n\t\t\t}, this)\n\t\t});\n\t\tsetTimeout(function (){placeEventAnim.animate()}, 500);\n\t}\n\n\taddHistoryItem()\n\t{\n\t\tconst node = this._finalItem.getWrapper();\n\n\t\tthis._anchor.parentNode.insertBefore(node, this._anchor.nextSibling);\n\n\t\tthis._finalItemHeight = this._anchor.offsetHeight - node.offsetHeight;\n\t\tthis._anchor.style.height = 0;\n\t\tnode.style.marginBottom = this._finalItemHeight + \"px\";\n\t}\n\n\tremoveGhost()\n\t{\n\t\tconst ghostNode = this._ghostNode;\n\t\tconst finalNode = this._finalItem.getWrapper();\n\n\t\tghostNode.style.overflow = \"hidden\";\n\t\tconst hideCasperItem = new BX.easing({\n\t\t\tduration: 70,\n\t\t\tstart: {opacity: 100, height: ghostNode.offsetHeight, marginBottom: this._finalItemHeight},\n\t\t\tfinish: {opacity: 0, height: finalNode.offsetHeight, marginBottom: 20},\n\t\t\t// transition : BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\tstep: BX.proxy(function (state) {\n\t\t\t\tghostNode.style.opacity = state.opacity / 100;\n\t\t\t\tghostNode.style.height = state.height + \"px\";\n\t\t\t\tfinalNode.style.marginBottom = state.marginBottom + \"px\";\n\t\t\t}, this),\n\t\t\tcomplete: BX.proxy(function () {\n\t\t\t\tghostNode.remove();\n\t\t\t\tfinalNode.style.marginBottom = \"\";\n\t\t\t\tthis.collapseStub();\n\n\t\t\t}, this)\n\t\t});\n\t\thideCasperItem.animate();\n\t}\n\n\tcollapseStub()\n\t{\n\t\tconst removePlannedEvent = new BX.easing({\n\t\t\tduration: 500,\n\t\t\tstart: {opacity: 100, height: this._initialHeight, marginBottom: 15},\n\t\t\tfinish: {opacity: 0, height: 0, marginBottom: 0},\n\t\t\ttransition: BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\tstep: BX.proxy(function (state) {\n\t\t\t\tthis._stub.style.height = state.height + \"px\";\n\t\t\t\tthis._stub.style.marginBottom = state.marginBottom + \"px\";\n\t\t\t\tthis._stub.style.opacity = state.opacity / 100;\n\t\t\t}, this),\n\t\t\tcomplete: BX.proxy(function () {\n\t\t\t\tthis.inited = false\n\t\t\t}, this)\n\n\t\t});\n\t\tremovePlannedEvent.animate();\n\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Item();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","/** @memberof BX.Crm.Timeline.Animation */\nexport default class Shift\n{\n\tconstructor()\n\t{\n\t\tthis._node = null;\n\t\tthis._anchor = null;\n\t\tthis._nodeParent  = null;\n\t\tthis._startPosition = null;\n\t\tthis._events = null;\n\t}\n\n\tinitialize(node, anchor, startPosition, shadowNode, events)\n\t{\n\t\tthis._node = node;\n\t\tthis._shadowNode = shadowNode;\n\t\tthis._anchor = anchor;\n\t\tthis._nodeParent  = node.parentNode;\n\t\tthis._startPosition = startPosition;\n\t\tthis._events = BX.type.isPlainObject(events) ? events : {};\n\n\t}\n\n\trun()\n\t{\n\t\tthis._anchorPosition = BX.pos(this._anchor);\n\n\t\tsetTimeout(\n\t\t\tBX.proxy(\n\t\t\t\tfunction (){\n\t\t\t\t\tBX.addClass(this._node, \"crm-entity-stream-section-casper\" )\n\t\t\t\t},\n\t\t\t\tthis\n\t\t\t),\n\t\t\t0\n\t\t);\n\n\t\tconst movingEvent = new BX.easing({\n\t\t\tduration: 1500,\n\t\t\tstart: {top: this._startPosition.top, height: 0},\n\t\t\tfinish: {top: this._anchorPosition.top, height: this._startPosition.height + 20},\n\t\t\ttransition: BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\tstep: BX.proxy(function (state) {\n\t\t\t\tthis._node.style.top = state.top + \"px\";\n\t\t\t\tthis._anchor.style.height = state.height + \"px\";\n\t\t\t}, this),\n\t\t\tcomplete: BX.proxy(function () {\n\t\t\t\tthis.finish();\n\t\t\t}, this)\n\t\t});\n\t\tmovingEvent.animate();\n\t}\n\n\tfinish()\n\t{\n\t\tif(BX.type.isFunction(this._events[\"complete\"]))\n\t\t{\n\t\t\tthis._events[\"complete\"]();\n\t\t}\n\t\tif( this._shadowNode !== false )\n\t\t{\n\t\t\t// this._stub.height = 0;\n\t\t}\n\t}\n\n\tstatic create(node, anchor, startPosition, shadowNode, events)\n\t{\n\t\tconst self = new Shift();\n\t\tself.initialize(node, anchor, startPosition, shadowNode, events);\n\t\treturn self;\n\t}\n}\n","import Shift from \"./shift\";\nimport {Dom} from 'main.core';\nimport CompatibleItem from \"../items/compatible-item\";\n\n/** @memberof BX.Crm.Timeline.Animation */\nexport default class ItemNew\n{\n\tconstructor()\n\t{\n\t\tthis._id = \"\";\n\t\tthis._settings = {};\n\t\tthis._initialItem = null;\n\t\tthis._finalItem = null;\n\t\tthis._events = null;\n\t\tthis._areAnimatedItemsVisible = null;\n\t}\n\n\tinitialize(id, settings)\n\t{\n\t\tthis._id = BX.type.isNotEmptyString(id) ? id : BX.util.getRandomString(4);\n\t\tthis._settings = settings ? settings : {};\n\n\t\tthis._initialItem = this.getSetting(\"initialItem\");\n\t\tthis._finalItem = this.getSetting(\"finalItem\");\n\n\t\tthis._anchor = this.getSetting(\"anchor\");\n\t\tthis._events = this.getSetting(\"events\", {});\n\t}\n\n\tgetId()\n\t{\n\t\treturn this._id;\n\t}\n\n\tgetSetting(name, defaultval)\n\t{\n\t\treturn this._settings.hasOwnProperty(name) ? this._settings[name] : defaultval;\n\t}\n\n\taddHistoryItem()\n\t{\n\t\tif (this._finalItem instanceof CompatibleItem)\n\t\t{\n\t\t\tconst node = this._finalItem.getWrapper();\n\t\t\tthis._anchor.parentNode.insertBefore(node, this._anchor.nextSibling);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis._finalItem.initWrapper();\n\t\t\tDom.insertBefore(this._finalItem.getWrapper(), this._anchor.nextSibling);\n\t\t\tthis._finalItem.initLayoutApp({ add: false });\n\t\t}\n\t}\n\n\trun()\n\t{\n\t\tthis._node = this._initialItem.getWrapper();\n\t\tthis._areAnimatedItemsVisible = this._node.offsetParent !== null;\n\t\tif (this._areAnimatedItemsVisible)\n\t\t{\n\t\t\tthis.createStub();\n\n\t\t\tBX.addClass(this._node, 'crm-entity-stream-section-animate-start');\n\n\t\t\tthis._startPosition = BX.pos(this._stub);\n\n\t\t\tthis._node.style.position = \"absolute\";\n\t\t\tthis._node.style.width = this._startPosition.width + \"px\";\n\t\t\tthis._node.style.height = this._startPosition.height + \"px\";\n\t\t\tthis._node.style.top = this._startPosition.top + \"px\";\n\t\t\tthis._node.style.left = this._startPosition.left + \"px\";\n\t\t\tthis._node.style.zIndex = 960;\n\n\n\t\t\tdocument.body.appendChild(this._node);\n\n\t\t\tconst shift = Shift.create(\n\t\t\t\tthis._node,\n\t\t\t\tthis._anchor,\n\t\t\t\tthis._startPosition,\n\t\t\t\tthis._stub,\n\t\t\t\t{complete: BX.delegate(this.finish, this)}\n\t\t\t);\n\t\t\tshift.run();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.finish();\n\t\t}\n\t}\n\n\tcreateStub()\n\t{\n\t\tthis._stub = BX.create(\n\t\t\t\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: { className: \"crm-entity-stream-section crm-entity-stream-section-planned crm-entity-stream-section-shadow\" },\n\t\t\t\tchildren :\n\t\t\t\t\t[\n\t\t\t\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-icon\" } }),\n\t\t\t\t\t\tBX.create(\n\t\t\t\t\t\t\t\"DIV\",\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tprops: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\t\t\t\tstyle: { height: this._initialItem._wrapper.clientHeight + \"px\" }\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t)\n\t\t\t\t\t]\n\t\t\t}\n\t\t);\n\n\t\tthis._node.parentNode.insertBefore(this._stub, this._node);\n\t}\n\n\tfinish()\n\t{\n\t\tthis._anchor.style.height = 0;\n\t\t//this._anchor.parentNode.insertBefore(this._node, this._anchor.nextSibling);\n\n\t\tif (this._areAnimatedItemsVisible)\n\t\t{\n\t\t\tconst stubContainer = this._stub.querySelector('.crm-entity-stream-section-content');\n\t\t\tsetTimeout(\n\t\t\t\tBX.delegate(function()\n\t\t\t\t{\n\t\t\t\t\tBX.removeClass(this._node, 'crm-entity-stream-section-animate-start');\n\t\t\t\t}, this),\n\t\t\t\t0\n\t\t\t);\n\n\t\t\tthis._node.style.opacity = 0;\n\n\t\t\tsetTimeout(BX.delegate(\n\t\t\t\tfunction()\n\t\t\t\t{\n\t\t\t\t\tstubContainer.style.height = 0;\n\t\t\t\t\tstubContainer.style.opacity = 0;\n\t\t\t\t\tstubContainer.style.paddingTop = 0;\n\t\t\t\t\tstubContainer.style.paddingBottom = 0;\n\t\t\t\t},\n\t\t\t\tthis\n\t\t\t), 120);\n\t\t}\n\t\tsetTimeout( BX.delegate(\n\t\t\tfunction() {\n\t\t\t\tif (this._areAnimatedItemsVisible)\n\t\t\t\t{\n\t\t\t\t\tBX.remove(this._stub);\n\t\t\t\t}\n\t\t\t\tBX.remove(this._node);\n\t\t\t\tthis.addHistoryItem();\n\n\t\t\t\tif(BX.type.isFunction(this._events[\"complete\"]))\n\t\t\t\t{\n\t\t\t\t\tthis._events[\"complete\"]();\n\t\t\t\t}\n\t\t\t},\n\t\t\tthis\n\t\t), 420 );\n\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new ItemNew();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import {Type, Dom} from 'main.core';\nimport Manager from \"./manager\";\nimport {Item, ConfigurableItem, StreamType} from 'crm.timeline.item';\nimport ItemAnimation from \"./animations/item\";\nimport ItemNew from \"./animations/item-new\";\nimport {TimezoneOffset, Format} from \"crm.datetime\"\n\n/** @memberof BX.Crm.Timeline */\nexport default class Steam\n{\n\tconstructor()\n\t{\n\t\tthis._id = \"\";\n\t\tthis._settings = {};\n\t\tthis._container = null;\n\t\tthis._manager = null;\n\t\tthis._activityEditor = null;\n\n\t\tthis._timeFormat = \"\";\n\t\tthis._year = 0;\n\n\t\tthis._isStubMode = false;\n\t\tthis._userId = 0;\n\t\tthis._readOnly = false;\n\t\tthis._streamType = StreamType.history;\n\t\tthis._anchor = null;\n\n\t\tthis._serviceUrl = \"\";\n\t}\n\n\tinitialize(id, settings)\n\t{\n\t\tthis._id = BX.type.isNotEmptyString(id) ? id : BX.util.getRandomString(4);\n\t\tthis._settings = settings ? settings : {};\n\n\t\tthis._container = BX(this.getSetting(\"container\"));\n\t\tif (!BX.type.isElementNode(this._container))\n\t\t{\n\t\t\tthrow \"Timeline. Container node is not found.\";\n\t\t}\n\t\tthis._editorContainer = BX(this.getSetting(\"editorContainer\"));\n\t\tthis._manager = this.getSetting(\"manager\");\n\t\tif (!(this._manager instanceof Manager))\n\t\t{\n\t\t\tthrow \"Timeline. Manager instance is not found.\";\n\t\t}\n\n\t\t//\n\t\tconst datetimeFormat = BX.message(\"FORMAT_DATETIME\").replace(/:SS/, \"\");\n\t\tconst dateFormat = BX.message(\"FORMAT_DATE\");\n\t\tthis._timeFormat = BX.date.convertBitrixFormat(BX.util.trim(datetimeFormat.replace(dateFormat, \"\")));\n\t\t//\n\t\tthis._year = (new Date()).getFullYear();\n\n\t\tthis._activityEditor = this.getSetting(\"activityEditor\");\n\n\t\tthis._isStubMode = BX.prop.getBoolean(this._settings, \"isStubMode\", false);\n\t\tthis._readOnly = BX.prop.getBoolean(this._settings, \"readOnly\", false);\n\t\tthis._userId = BX.prop.getInteger(this._settings, \"userId\", 0);\n\t\tthis._serviceUrl = BX.prop.getString(this._settings, \"serviceUrl\", \"\");\n\n\t\tthis.doInitialize();\n\t}\n\n\tgetId()\n\t{\n\t\treturn this._id;\n\t}\n\n\tisScheduleStream(): boolean\n\t{\n\t\treturn this.getStreamType() === StreamType.scheduled;\n\t}\n\n\tisFixedHistoryStream(): boolean\n\t{\n\t\treturn this.getStreamType() === StreamType.pinned;\n\t}\n\n\tisHistoryStream(): boolean\n\t{\n\t\treturn this.getStreamType() === StreamType.history;\n\t}\n\n\tgetSetting(name, defaultval)\n\t{\n\t\treturn this._settings.hasOwnProperty(name) ? this._settings[name] : defaultval;\n\t}\n\n\tdoInitialize()\n\t{\n\t}\n\n\tlayout()\n\t{\n\t}\n\n\tisStubMode()\n\t{\n\t\treturn this._isStubMode;\n\t}\n\n\tisReadOnly()\n\t{\n\t\treturn this._readOnly;\n\t}\n\n\tgetUserId()\n\t{\n\t\treturn this._userId;\n\t}\n\n\tgetServiceUrl()\n\t{\n\t\treturn this._serviceUrl;\n\t}\n\n\tgetAnchor(): ?HTMLElement\n\t{\n\t\treturn this._anchor;\n\t}\n\n\tgetStreamType() {\n\t\treturn this._streamType;\n\t}\n\n\trefreshLayout()\n\t{\n\t}\n\n\tgetManager()\n\t{\n\t\treturn this._manager;\n\t}\n\n\tgetOwnerInfo()\n\t{\n\t\treturn this._manager.getOwnerInfo();\n\t}\n\n\treload()\n\t{\n\t\tconst currentUrl = this.getSetting(\"currentUrl\");\n\t\tconst ajaxId = this.getSetting(\"ajaxId\");\n\t\tif (ajaxId !== \"\")\n\t\t{\n\t\t\tBX.ajax.insertToNode(BX.util.add_url_param(currentUrl, {bxajaxid: ajaxId}), \"comp_\" + ajaxId);\n\t\t}\n\t\telse\n\t\t{\n\t\t\twindow.location = currentUrl;\n\t\t}\n\t}\n\n\tgetUserTimezoneOffset()\n\t{\n\t\treturn TimezoneOffset.USER_TO_SERVER;\n\t}\n\n\tgetServerTimezoneOffset()\n\t{\n\t\treturn TimezoneOffset.SERVER_TO_UTC;\n\t}\n\n\t// @todo replace by DatetimeConverter\n\tformatTime(time, now, utc)\n\t{\n\t\treturn BX.date.format(this._timeFormat, time, now, utc);\n\t}\n\n\t// @todo replace by DatetimeConverter\n\tformatDate(date)\n\t{\n\t\treturn (\n\t\t\tBX.date.format(\n\t\t\t\t[\n\t\t\t\t\t[\"today\", \"today\"],\n\t\t\t\t\t[\"tommorow\", \"tommorow\"],\n\t\t\t\t\t[\"yesterday\", \"yesterday\"],\n\t\t\t\t\t[\"\", (date.getFullYear() === this._year) ? Format.DAY_MONTH_FORMAT : Format.LONG_DATE_FORMAT],\n\t\t\t\t],\n\t\t\t\tdate\n\t\t\t)\n\t\t);\n\t}\n\n\tcutOffText(text, length): string\n\t{\n\t\tif (!BX.type.isNumber(length))\n\t\t{\n\t\t\tlength = 0;\n\t\t}\n\n\t\tif (length <= 0 || text.length <= length)\n\t\t{\n\t\t\treturn text;\n\t\t}\n\n\t\tlet offset = length - 1;\n\t\tconst whitespaceOffset = text.substring(offset).search(/\\s/i);\n\t\tif (whitespaceOffset > 0)\n\t\t{\n\t\t\toffset += whitespaceOffset;\n\t\t}\n\t\treturn text.substring(0, offset) + \"...\";\n\t}\n\n\tgetItems(): Array\n\t{\n\t\treturn [];\n\t}\n\n\t/**\n\t * @abstract\n\t */\n\tsetItems(items: Array): void\n\t{\n\t\tthrow new Error('Stream.setItems() must be overridden');\n\t}\n\n\tgetLastItem(): ?Item\n\t{\n\t\tconst items = this.getItems();\n\n\t\treturn items.length > 0 ? items[items.length - 1] : null;\n\t}\n\n\tfindItemById(id): ?Item\n\t{\n\t\tid = id.toString();\n\n\t\treturn this.getItems().find(item => item.getId() === id) || null;\n\t}\n\n\tgetItemIndex(item: Item): number\n\t{\n\t\treturn this.getItems().findIndex((currentItem) => (currentItem === item));\n\t}\n\n\tremoveItemByIndex(index): void\n\t{\n\t\tconst items = this.getItems();\n\t\tif (index < items.length)\n\t\t{\n\t\t\titems.splice(index, 1);\n\t\t\tthis.setItems(items);\n\t\t}\n\t}\n\n\t/**\n\t * @abstract\n\t */\n\tcreateItem(data): Item\n\t{\n\t\tthrow new Error('Stream.createItem() must be overridden');\n\t}\n\n\tcreateItemCopy(item: Item): Item\n\t{\n\t\tif (item instanceof ConfigurableItem)\n\t\t{\n\t\t\treturn item.clone();\n\t\t}\n\n\t\treturn this.createItem(item.getData());\n\t}\n\n\trefreshItem(item: Item, animateUpdate: boolean = true, animateMove: true): Promise\n\t{\n\t\tconst index = this.getItemIndex(item);\n\t\tif(index < 0)\n\t\t{\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\tthis.removeItemByIndex(index);\n\n\t\tlet itemPositionChanged = false;\n\t\tlet newIndex = 0;\n\t\tlet newItem;\n\t\tif (this.isScheduleStream())\n\t\t{\n\t\t\tnewItem = this.createItemCopy(item);\n\t\t\tnewIndex = this.calculateItemIndex(newItem);\n\n\t\t\titemPositionChanged = newIndex !== index;\n\t\t}\n\n\t\tif(!itemPositionChanged)\n\t\t{\n\t\t\tthis.addItem(item, newIndex);\n\t\t\titem.refreshLayout();\n\t\t\tif (animateUpdate)\n\t\t\t{\n\t\t\t\treturn this.animateItemAdding(item);\n\t\t\t}\n\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\tconst anchor = this.createAnchor(newIndex);\n\t\tthis.addItem(newItem, newIndex);\n\t\tif (animateMove)\n\t\t{\n\t\t\tnewItem.layout({add: false});\n\n\t\t\treturn new Promise((resolve) => {\n\t\t\t\tconst animation = ItemAnimation.create(\n\t\t\t\t\t'',\n\t\t\t\t\t{\n\t\t\t\t\t\tinitialItem: item,\n\t\t\t\t\t\tfinalItem: newItem,\n\t\t\t\t\t\tanchor: anchor,\n\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\tcomplete: () => {\n\t\t\t\t\t\t\t\titem.destroy();\n\t\t\t\t\t\t\t\tresolve();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t\tanimation.run();\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tnewItem.layout({anchor: anchor});\n\t\t\titem.destroy();\n\n\t\t\treturn Promise.resolve();\n\t\t}\n\t}\n\n\tcalculateItemIndex(item: Item): Number\n\t{\n\t\treturn 0;\n\t}\n\n\tcreateAnchor(index): HTMLElement\n\t{\n\t\treturn null;\n\t}\n\n\t/**\n\t * @abstract\n\t */\n\taddItem(item: Item, index): void\n\t{\n\t\tthrow new Error('Stream.addItem() must be overridden');\n\t}\n\n\t/**\n\t * @abstract\n\t */\n\tdeleteItem(item: Item): void\n\t{\n\t\tthrow new Error('Stream.deleteItem() must be overridden');\n\t}\n\n\tdeleteItemAnimated(item: Item): void\n\t{\n\t\tif (!Type.isDomNode(item.getWrapper()))\n\t\t{\n\t\t\tthis.deleteItem(item);\n\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\treturn new Promise((resolve) => {\n\t\t\tconst wrapperPosition = Dom.getPosition(item.getWrapper());\n\n\t\t\tconst hideEvent = new BX.easing({\n\t\t\t\tduration: 1000,\n\t\t\t\tstart: {height: wrapperPosition.height, opacity: 1, marginBottom: 15},\n\t\t\t\tfinish: {height: 0, opacity: 0, marginBottom: 0},\n\t\t\t\ttransition: BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\t\tstep: (state) => {\n\t\t\t\t\tDom.style(item.getWrapper(), {\n\t\t\t\t\t\theight:  state.height + 'px',\n\t\t\t\t\t\topacity:  state.opacity,\n\t\t\t\t\t\tmarginBottom:  state.marginBottom,\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tcomplete: () => {\n\t\t\t\t\tthis.deleteItem(item)\n\t\t\t\t\tresolve();\n\t\t\t\t}\n\t\t\t});\n\n\t\t\thideEvent.animate();\n\t\t});\n\t}\n\n\tmoveItemToStream(item: Item, destinationStream: Steam, destinationItem: Item): void\n\t{\n\t\tthis.removeItemByIndex(this.getItemIndex(item));\n\t\tif (this.getItems().length > 0)\n\t\t{\n\t\t\tthis.refreshLayout();\n\t\t}\n\n\t\treturn new Promise((resolve) => {\n\t\t\tconst animation = ItemNew.create(\n\t\t\t\t'',\n\t\t\t\t{\n\t\t\t\t\tinitialItem: item,\n\t\t\t\t\tfinalItem: destinationItem,\n\t\t\t\t\tanchor: destinationStream.createAnchor(),\n\t\t\t\t\tevents: {complete: () => {\n\t\t\t\t\t\t\tthis.refreshLayout();\n\t\t\t\t\t\t\tdestinationStream.refreshLayout();\n\t\t\t\t\t\t\tresolve();\n\t\t\t\t\t\t}}\n\t\t\t\t}\n\t\t\t);\n\t\t\tanimation.run();\n\t\t});\n\t}\n\n\tanimateItemAdding(item): Promise\n\t{\n\t\treturn Promise.resolve();\n\t}\n}\n","import Stream from \"../stream\";\nimport { Dom, Reflection, Type } from 'main.core';\n\n/** @memberof BX.Crm.Timeline.Streams */\nexport default class EntityChat extends Stream\n{\n\tstatic LayoutType = {\n\t\tnone: 0,\n\t\tinvitation:  1,\n\t\tsummary: 2,\n\t}\n\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._data = null;\n\t\tthis._layoutType = EntityChat.LayoutType.none;\n\n\t\tthis._wrapper = null;\n\t\tthis._contentWrapper = null;\n\t\tthis._messageWrapper = null;\n\t\tthis._messageDateNode = null;\n\t\tthis._messageTexWrapper = null;\n\t\tthis._messageTextNode = null;\n\t\tthis._userWrapper = null;\n\t\tthis._extraUserCounter = null;\n\t\tthis.isLoading = false;\n\n\t\tthis._openChatHandler = BX.delegate(this.onOpenChat, this);\n\t}\n\n\tdoInitialize()\n\t{\n\t\tthis._data = BX.prop.getObject(this._settings, \"data\", {});\n\t}\n\n\tgetData()\n\t{\n\t\treturn this._data;\n\t}\n\n\tsetData(data)\n\t{\n\t\tthis._data = BX.type.isPlainObject(data) ? data : {};\n\t}\n\n\tisEnabled()\n\t{\n\t\treturn BX.prop.getBoolean(this._data, \"ENABLED\", true);\n\t}\n\n\t/**\n\t * @private\n\t * @return {boolean}\n\t */\n\tisRestricted()\n\t{\n\t\treturn BX.prop.getBoolean(this._data, \"IS_RESTRICTED\", false);\n\t}\n\n\t/**\n\t * @private\n\t * @return {void}\n\t */\n\tapplyLockScript()\n\t{\n\t\tconst lockScript = BX.prop.getString(this._data, \"LOCK_SCRIPT\", null);\n\t\tif (BX.Type.isString(lockScript) && lockScript !== '')\n\t\t{\n\t\t\teval(lockScript);\n\t\t}\n\t}\n\n\tgetChatId()\n\t{\n\t\treturn BX.prop.getInteger(this._data, \"CHAT_ID\", 0);\n\t}\n\n\tgetUserId()\n\t{\n\t\tconst userId = parseInt(top.BX.message(\"USER_ID\"));\n\t\treturn !isNaN(userId) ? userId : 0;\n\t}\n\n\tgetMessageData()\n\t{\n\t\treturn BX.prop.getObject(this._data, \"MESSAGE\", {});\n\t}\n\n\tsetMessageData(data)\n\t{\n\t\tthis._data[\"MESSAGE\"] = BX.type.isPlainObject(data) ? data : {};\n\t}\n\n\tgetUserInfoData()\n\t{\n\t\treturn BX.prop.getObject(this._data, \"USER_INFOS\", {});\n\t}\n\n\tsetUserInfoData(data)\n\t{\n\t\tthis._data[\"USER_INFOS\"] = BX.type.isPlainObject(data) ? data : {};\n\t}\n\n\thasUserInfo(userId)\n\t{\n\t\treturn userId > 0 && BX.type.isPlainObject(this.getUserInfoData()[userId]);\n\t}\n\n\tgetUserInfo(userId)\n\t{\n\t\tconst userInfos = this.getUserInfoData();\n\t\treturn userId > 0 && BX.type.isPlainObject(userInfos[userId]) ? userInfos[userId] : null;\n\t}\n\n\tremoveUserInfo(userId)\n\t{\n\t\tconst userInfos = this.getUserInfoData();\n\t\tif(userId > 0 && BX.type.isPlainObject(userInfos[userId]))\n\t\t{\n\t\t\tdelete userInfos[userId];\n\t\t}\n\t}\n\n\tsetUnreadMessageCounter(userId, counter)\n\t{\n\t\tconst userInfos = this.getUserInfoData();\n\t\tif(userId > 0 && BX.type.isPlainObject(userInfos[userId]))\n\t\t{\n\t\t\tuserInfos[userId][\"counter\"] = counter;\n\t\t}\n\t}\n\n\tlayout()\n\t{\n\t\tif(!this.isEnabled() || this.isStubMode())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis._wrapper = BX.create(\"div\", { props: { className: \"crm-entity-stream-section crm-entity-stream-section-live-im\" } });\n\t\tthis._container.appendChild(this._wrapper);\n\n\t\tthis._wrapper.appendChild(\n\t\t\tBX.create(\"div\", { props: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-live-im\" } })\n\t\t);\n\n\t\tthis._contentWrapper = BX.create(\"div\", { props: { className: \"crm-entity-stream-content-live-im-detail\" } });\n\n\t\tthis._wrapper.appendChild(\n\t\t\tBX.create(\"div\",\n\t\t\t\t{\n\t\t\t\t\tprops: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"div\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tprops: { className: \"crm-entity-stream-content-event\" },\n\t\t\t\t\t\t\t\t\tchildren: [ this._contentWrapper ]\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tthis._userWrapper = BX.create(\"div\", { props: { className: \"crm-entity-stream-live-im-user-avatars\" } });\n\t\tthis._contentWrapper.appendChild(\n\t\t\tBX.create(\"div\",\n\t\t\t\t{\n\t\t\t\t\tprops: { className: \"crm-entity-stream-live-im-users\" },\n\t\t\t\t\tchildren: [ this._userWrapper ]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tthis._extraUserCounter = BX.create(\"div\",{ props: { className: \"crm-entity-stream-live-im-user-counter\" } });\n\t\tthis._contentWrapper.appendChild(this._extraUserCounter);\n\n\t\tthis._layoutType = EntityChat.LayoutType.none;\n\t\tif(this.getChatId() > 0)\n\t\t{\n\t\t\tthis.renderSummary();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.renderInvitation();\n\t\t}\n\n\t\tBX.bind(this._contentWrapper, \"click\", this._openChatHandler);\n\t\tBX.addCustomEvent(\"onPullEvent-im\", this.onChatEvent.bind(this));\n\t}\n\n\trefreshLayout()\n\t{\n\t\tBX.cleanNode(this._contentWrapper);\n\t\tthis._userWrapper = BX.create(\"div\", { props: { className: \"crm-entity-stream-live-im-user-avatars\" } });\n\t\tthis._contentWrapper.appendChild(\n\t\t\tBX.create(\"div\",\n\t\t\t\t{\n\t\t\t\t\tprops: { className: \"crm-entity-stream-live-im-users\" },\n\t\t\t\t\tchildren: [ this._userWrapper ]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tthis._extraUserCounter = BX.create(\"div\",{ props: { className: \"crm-entity-stream-live-im-user-counter\" } });\n\t\tthis._contentWrapper.appendChild(this._extraUserCounter);\n\n\t\tthis._layoutType = EntityChat.LayoutType.none;\n\t\tif(this.getChatId() > 0)\n\t\t{\n\t\t\tthis.renderSummary();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.renderInvitation();\n\t\t}\n\t}\n\n\trenderInvitation()\n\t{\n\t\tthis._layoutType = EntityChat.LayoutType.invitation;\n\t\tthis.refreshUsers();\n\n\t\tthis._messageTextNode = BX.create(\"div\", { props: { className: \"crm-entity-stream-live-im-user-invite-text\" } });\n\t\tthis._contentWrapper.appendChild(this._messageTextNode);\n\n\t\tthis._messageTextNode.innerHTML = this.getMessage(\"invite\");\n\t}\n\n\trenderSummary()\n\t{\n\t\tthis._layoutType = EntityChat.LayoutType.summary;\n\t\tthis.refreshUsers();\n\n\t\tthis._contentWrapper.appendChild(\n\t\t\tBX.create(\"div\", { props: { className: \"crm-entity-stream-live-im-separator\" } })\n\t\t);\n\n\t\tthis._messageWrapper = BX.create(\"div\", { props: { className: \"crm-entity-stream-live-im-messanger\" } });\n\t\tthis._contentWrapper.appendChild(this._messageWrapper);\n\n\t\tthis._messageDateNode = BX.create(\"div\", { props: { className: \"crm-entity-stream-live-im-time\" } });\n\t\tthis._messageWrapper.appendChild(this._messageDateNode);\n\n\t\tthis._messageTexWraper = BX.create(\"div\", { props: { className: \"crm-entity-stream-live-im-message\" } });\n\t\tthis._messageWrapper.appendChild(this._messageTexWraper);\n\n\t\tthis._messageTextNode = BX.create(\"div\", { props: { className: \"crm-entity-stream-live-im-message-text\" } });\n\t\tthis._messageTexWraper.appendChild(this._messageTextNode);\n\n\t\tthis._messageCounterNode = BX.create(\"div\", { props: { className: \"crm-entity-stream-live-im-message-counter\" } });\n\t\tthis._messageWrapper.appendChild(this._messageCounterNode);\n\n\t\tthis.refreshSummary();\n\t}\n\n\trefreshUsers()\n\t{\n\t\tBX.cleanNode(this._userWrapper);\n\n\t\tconst infos = this.getUserInfoData();\n\t\tconst list = Object.values(infos);\n\n\t\tif(list.length === 0)\n\t\t{\n\t\t\tthis._userWrapper.appendChild(\n\t\t\t\tBX.create(\"span\",\n\t\t\t\t\t{\n\t\t\t\t\t\tprops: { className: \"crm-entity-stream-live-im-user-avatar ui-icon ui-icon-common-user\" },\n\t\t\t\t\t\tchildren: [ BX.create(\"i\") ]\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst count = list.length >= 3 ? 3 : list.length;\n\t\t\tfor(let i = 0; i < count; i++)\n\t\t\t{\n\t\t\t\tconst info = list[i];\n\n\t\t\t\tconst icon = BX.create(\"i\");\n\t\t\t\tconst imageUrl = BX.prop.getString(info, \"avatar\", \"\");\n\t\t\t\tif(imageUrl !== \"\")\n\t\t\t\t{\n\t\t\t\t\ticon.style.backgroundImage = \"url(\" +  encodeURI(imageUrl) + \")\";\n\t\t\t\t}\n\n\t\t\t\tthis._userWrapper.appendChild(\n\t\t\t\t\tBX.create(\"span\",\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tprops: { className: \"crm-entity-stream-live-im-user-avatar ui-icon ui-icon-common-user\" },\n\t\t\t\t\t\t\tchildren: [ icon ]\n\t\t\t\t\t\t}\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\tif(this._layoutType === EntityChat.LayoutType.summary)\n\t\t{\n\t\t\tif(list.length > 3)\n\t\t\t{\n\t\t\t\tthis._extraUserCounter.display = \"\";\n\t\t\t\tthis._extraUserCounter.innerHTML = \"+\" + (list.length - 3).toString();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif(this._extraUserCounter.innerHTML !== \"\")\n\t\t\t\t{\n\t\t\t\t\tthis._extraUserCounter.innerHTML = \"\";\n\t\t\t\t}\n\t\t\t\tthis._extraUserCounter.display = \"none\";\n\t\t\t}\n\t\t}\n\t\telse //if(this._layoutType === EntityChat.LayoutType.invitation)\n\t\t{\n\t\t\tif(this._extraUserCounter.innerHTML !== \"\")\n\t\t\t{\n\t\t\t\tthis._extraUserCounter.innerHTML = \"\";\n\t\t\t}\n\t\t\tthis._extraUserCounter.display = \"none\";\n\n\t\t\tthis._userWrapper.appendChild(\n\t\t\t\tBX.create(\"span\", { props: { className: \"crm-entity-stream-live-im-user-invite-btn\" } })\n\t\t\t);\n\t\t}\n\t}\n\n\trefreshSummary()\n\t{\n\t\tif(this._layoutType !== EntityChat.LayoutType.summary)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst message = this.getMessageData();\n\n\t\t//region Message Date\n\t\tconst isoDate = BX.prop.getString(message, \"date\", \"\");\n\t\tif(isoDate === \"\")\n\t\t{\n\t\t\tthis._messageDateNode.innerHTML = \"\";\n\t\t}\n\t\telse\n\t\t{\n\t\t\t// @todo replace by DatetimeConverter\n\t\t\tconst remoteDate = (new Date(isoDate)).getTime() / 1000 + this.getServerTimezoneOffset() + this.getUserTimezoneOffset();\n\t\t\tconst localTime = (new Date).getTime() / 1000 + this.getServerTimezoneOffset() + this.getUserTimezoneOffset();\n\t\t\tthis._messageDateNode.innerHTML = this.formatTime(remoteDate, localTime, true);\n\t\t}\n\t\t//endregion\n\n\t\t//region Message Text\n\t\tlet text = BX.prop.getString(message, \"text\", \"\");\n\t\tconst params = BX.prop.getObject(message, \"params\", {});\n\t\tif(text === \"\" && !params.ATTACH && !params.FILE_ID)\n\t\t{\n\t\t\tthis._messageTextNode.innerHTML = \"\";\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst MessengerCommon = Reflection.getClass('top.BX.MessengerCommon');\n\t\t\tconst MessengerParser = Reflection.getClass('top.BX.Messenger.v2.Lib.Parser');\n\t\t\tif (MessengerCommon)\n\t\t\t{\n\t\t\t\ttext = MessengerCommon.purifyText(text, params);\n\t\t\t}\n\t\t\telse if (MessengerParser)\n\t\t\t{\n\t\t\t\ttext = MessengerParser.purify({\n\t\t\t\t\ttext,\n\t\t\t\t\tattach: params.ATTACH,\n\t\t\t\t\tfiles: typeof params.FILE_ID === 'object' && params.FILE_ID.length > 0,\n\t\t\t\t});\n\t\t\t}\n\t\t\tthis._messageTextNode.innerHTML = text;\n\t\t}\n\t\t//endregion\n\n\t\t//region Unread Message Counter\n\t\tlet counter = 0;\n\t\tconst userId = this.getUserId();\n\t\tif(userId > 0)\n\t\t{\n\t\t\tcounter = BX.prop.getInteger(\n\t\t\t\tBX.prop.getObject(\n\t\t\t\t\tBX.prop.getObject(this._data, \"USER_INFOS\", {}),\n\t\t\t\t\tuserId,\n\t\t\t\t\tnull\n\t\t\t\t),\n\t\t\t\t\"counter\",\n\t\t\t\t0\n\t\t\t);\n\t\t}\n\n\t\tthis._messageCounterNode.innerHTML = counter.toString();\n\t\tthis._messageCounterNode.style.display = counter > 0 ? \"\" : \"none\";\n\t\t//endregion\n\t}\n\n\trefreshUsersAnimated()\n\t{\n\t\tBX.removeClass(this._userWrapper, 'crm-entity-stream-live-im-message-show');\n\t\tBX.addClass(this._userWrapper, 'crm-entity-stream-live-im-message-hide');\n\n\t\twindow.setTimeout(\n\t\t\tfunction()\n\t\t\t{\n\t\t\t\tthis.refreshUsers();\n\t\t\t\twindow.setTimeout(\n\t\t\t\t\tfunction()\n\t\t\t\t\t{\n\t\t\t\t\t\tBX.removeClass(this._userWrapper, 'crm-entity-stream-live-im-message-hide');\n\t\t\t\t\t\tBX.addClass(this._userWrapper, 'crm-entity-stream-live-im-message-show');\n\t\t\t\t\t}.bind(this),\n\t\t\t\t\t50\n\t\t\t\t);\n\t\t\t}.bind(this),\n\t\t\t500\n\t\t);\n\t}\n\n\trefreshSummaryAnimated()\n\t{\n\t\tBX.removeClass(this._messageWrapper, 'crm-entity-stream-live-im-message-show');\n\t\tBX.addClass(this._messageWrapper, 'crm-entity-stream-live-im-message-hide');\n\n\t\twindow.setTimeout(\n\t\t\tfunction()\n\t\t\t{\n\t\t\t\tthis.refreshSummary();\n\t\t\t\twindow.setTimeout(\n\t\t\t\t\tfunction()\n\t\t\t\t\t{\n\t\t\t\t\t\tBX.removeClass(this._messageWrapper, 'crm-entity-stream-live-im-message-hide');\n\t\t\t\t\t\tBX.addClass(this._messageWrapper, 'crm-entity-stream-live-im-message-show');\n\t\t\t\t\t}.bind(this),\n\t\t\t\t\t50\n\t\t\t\t);\n\t\t\t}.bind(this),\n\t\t\t500\n\t\t);\n\t}\n\n\tloading(isLoading: boolean)\n\t{\n\t\tif (this._contentWrapper && this._contentWrapper.classList)\n\t\t{\n\t\t\tif (isLoading)\n\t\t\t{\n\t\t\t\tDom.addClass(this._contentWrapper, 'crm-entity-chat-loading');\n\t\t\t\tthis.isLoading = true;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tDom.removeClass(this._contentWrapper, 'crm-entity-chat-loading');\n\t\t\t\tthis.isLoading = false;\n\t\t\t}\n\t\t}\n\t}\n\n\tonOpenChat(e)\n\t{\n\t\tif (Type.isUndefined(top.BX.Messenger.Public) || this.isLoading)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.isRestricted())\n\t\t{\n\t\t\tthis.applyLockScript();\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst ownerInfo = this.getOwnerInfo();\n\t\tconst entityId = BX.prop.getInteger(ownerInfo, 'ENTITY_ID', 0);\n\t\tconst entityTypeId = BX.prop.getInteger(ownerInfo, 'ENTITY_TYPE_ID', 0);\n\n\t\tconst data = {\n\t\t\tdata: {\n\t\t\t\tentityId,\n\t\t\t\tentityTypeId,\n\t\t\t},\n\t\t};\n\n\t\tconst successCallback = (response) => {\n\t\t\tthis.loading(false);\n\t\t\tconst chatId = response.data.chatId;\n\t\t\ttop.BX.Messenger.Public.openChat(`chat${chatId}`);\n\t\t};\n\n\t\tconst errorCallback = (error) => {\n\t\t\tthis.loading(false);\n\t\t\tconst errorMessage = error.errors[0].message;\n\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\tcontent: errorMessage,\n\t\t\t\tautoHideDelay: 5000,\n\t\t\t});\n\t\t};\n\n\t\tthis.loading(true);\n\t\tBX.ajax.runAction('crm.timeline.chat.get', data).then(successCallback, errorCallback);\n\t}\n\n\tonChatEvent(command, params, extras)\n\t{\n\t\tconst chatId = this.getChatId();\n\t\tif(chatId <= 0 || chatId !== BX.prop.getInteger(params, \"chatId\", 0))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif(command === \"chatUserAdd\")\n\t\t{\n\t\t\tthis.setUserInfoData(BX.mergeEx(this.getUserInfoData(), BX.prop.getObject(params, \"users\", {})));\n\t\t\tthis.refreshUsersAnimated();\n\t\t}\n\t\telse if(command === \"chatUserLeave\")\n\t\t{\n\t\t\tthis.removeUserInfo(BX.prop.getInteger(params, \"userId\", 0));\n\t\t\tthis.refreshUsersAnimated();\n\t\t}\n\t\telse if(command === \"messageChat\")\n\t\t{\n\t\t\t//Message was added.\n\t\t\tthis.setMessageData(BX.prop.getObject(params, \"message\", {}));\n\t\t\tthis.setUnreadMessageCounter(this.getUserId(), BX.prop.getInteger(params, \"counter\", 0));\n\t\t\tthis.refreshSummaryAnimated();\n\t\t}\n\t\telse if(command === \"messageUpdate\" || command === \"messageDelete\")\n\t\t{\n\t\t\t//Message was modified or removed.\n\t\t\tif(command === \"messageDelete\")\n\t\t\t{\n\t\t\t\t//HACK: date is not in ISO format\n\t\t\t\tdelete params[\"date\"];\n\t\t\t}\n\n\t\t\tconst message = this.getMessageData();\n\t\t\tif(BX.prop.getInteger(message, \"id\", 0) === BX.prop.getInteger(params, \"id\", 0))\n\t\t\t{\n\t\t\t\tthis.setMessageData(BX.mergeEx(message, params));\n\t\t\t\tthis.refreshSummaryAnimated();\n\t\t\t}\n\t\t}\n\t\telse if(command === \"readMessageChat\")\n\t\t{\n\t\t\tthis.setUnreadMessageCounter(this.getUserId(), 0);\n\t\t\tthis.refreshSummaryAnimated();\n\t\t}\n\t\telse if(command === \"unreadMessageChat\")\n\t\t{\n\t\t\tthis.setUnreadMessageCounter(this.getUserId(), BX.prop.getInteger(params, \"counter\", 0));\n\t\t\tthis.refreshSummaryAnimated();\n\t\t}\n\t}\n\n\tgetMessage(name)\n\t{\n\t\treturn BX.prop.getString(EntityChat.messages, name, name);\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new EntityChat();\n\t\tself.initialize(id, settings);\n\t\tEntityChat.items[self.getId()] = self;\n\t\treturn self;\n\t}\n\n\tstatic items = {};\n\tstatic messages = {};\n}\n","/** @memberof BX.Crm.Timeline.Tools */\nexport default class AudioPlaybackRateSelector\n{\n\tconstructor(params)\n\t{\n\t\tthis.name = params.name || 'crm-timeline-audio-playback-rate-selector';\n\t\tthis.menuId = this.name + '-menu';\n\t\tif(BX.Type.isArray(params.availableRates))\n\t\t{\n\t\t\tthis.availableRates = params.availableRates;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.availableRates = [1, 1.5, 2, 3];\n\t\t}\n\t\tthis.currentRate = this.normalizeRate(params.currentRate);\n\t\tthis.textMessageCode = params.textMessageCode;\n\t\tthis.renderedItems = [];\n\t\tthis.players = [];\n\t}\n\n\tisRateCurrent(rateDescription, rate)\n\t{\n\t\treturn ((rateDescription.rate && rate === rateDescription.rate) || rate === rateDescription);\n\t}\n\n\tnormalizeRate(rate)\n\t{\n\t\trate = parseFloat(rate);\n\t\tlet i = 0;\n\t\tconst length = this.availableRates.length;\n\t\tfor(; i < length; i++)\n\t\t{\n\t\t\tif(this.isRateCurrent(this.availableRates[i], rate))\n\t\t\t{\n\t\t\t\treturn rate;\n\t\t\t}\n\t\t}\n\n\t\treturn (this.availableRates[0].rate || this.availableRates[0]);\n\t}\n\n\tgetMenuItems()\n\t{\n\t\tconst selectedRate = this.getRate();\n\n\t\treturn this.availableRates.map(function(item) {\n\t\t\treturn {\n\t\t\t\ttext: (item.text || item) + '',\n\t\t\t\thtml: (item.html || item) + '',\n\t\t\t\tclassName: (this.isRateCurrent(item, selectedRate)) ? 'menu-popup-item-text-active' : null,\n\t\t\t\tonclick: function() {\n\t\t\t\t\tthis.setRate(item.rate || item)\n\t\t\t\t}.bind(this)\n\t\t\t}\n\t\t}.bind(this))\n\t}\n\n\tgetPopup(node)\n\t{\n\t\tlet popupMenu = BX.Main.MenuManager.getMenuById(this.menuId);\n\t\tif(popupMenu)\n\t\t{\n\t\t\tconst popupWindow = popupMenu.getPopupWindow();\n\t\t\tif (popupWindow)\n\t\t\t{\n\t\t\t\tpopupWindow.setBindElement(node);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tpopupMenu = BX.Main.MenuManager.create({\n\t\t\t\tid: this.menuId,\n\t\t\t\tbindElement: node,\n\t\t\t\titems: this.getMenuItems(),\n\t\t\t\tclassName: 'crm-audio-cap-speed-popup'\n\t\t\t});\n\t\t}\n\n\t\treturn popupMenu;\n\t}\n\n\tgetRate()\n\t{\n\t\treturn this.normalizeRate(this.currentRate);\n\t}\n\n\tsetRate(rate)\n\t{\n\t\tthis.getPopup().destroy();\n\n\t\trate = this.normalizeRate(rate);\n\t\tif(this.currentRate === rate)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tthis.currentRate = rate;\n\t\tBX.userOptions.save(\"crm\", this.name, 'rate', rate);\n\n\t\tfor(let i = 0, length = this.renderedItems.length; i < length; i++)\n\t\t{\n\t\t\tconst textNode = this.renderedItems[i].querySelector('.crm-audio-cap-speed-text');\n\t\t\tif(textNode)\n\t\t\t{\n\t\t\t\ttextNode.innerHTML = this.getText();\n\t\t\t}\n\t\t}\n\n\t\tfor(let i = 0, length = this.players.length; i < length; i++)\n\t\t{\n\t\t\tthis.players[i].vjsPlayer.playbackRate(this.getRate());\n\t\t}\n\t}\n\n\tgetText()\n\t{\n\t\tlet text;\n\n\t\tif(this.textMessageCode)\n\t\t{\n\t\t\ttext = BX.Loc.getMessage(this.textMessageCode);\n\t\t}\n\t\tif(!text)\n\t\t{\n\t\t\ttext = '#RATE#';\n\t\t}\n\n\t\treturn text.replace('#RATE#', '<span>' + this.getRate() + 'x</span>');\n\t}\n\n\trender()\n\t{\n\t\tconst item = BX.Dom.create('div', {\n\t\t\tattrs: {\n\t\t\t\tclassName: 'crm-audio-cap-speed-wrapper'\n\t\t\t},\n\t\t\tchildren: [\n\t\t\t\tBX.Dom.create('div', {\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\tclassName: 'crm-audio-cap-speed',\n\t\t\t\t\t},\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tBX.Dom.create('div', {\n\t\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\t\tclassName: 'crm-audio-cap-speed-text'\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\thtml: this.getText()\n\t\t\t\t\t\t})\n\t\t\t\t\t],\n\t\t\t\t})\n\t\t\t],\n\t\t\tevents: {\n\t\t\t\tclick: function (event) {\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tthis.getPopup(event.target).show()\n\t\t\t\t}.bind(this)\n\t\t\t}\n\t\t});\n\t\tthis.renderedItems.push(item);\n\n\t\treturn item;\n\t}\n\n\taddPlayer(player)\n\t{\n\t\tif(BX.Fileman.Player && player instanceof BX.Fileman.Player)\n\t\t{\n\t\t\tthis.players.push(player);\n\t\t}\n\t}\n}\n","/** @memberof BX.Crm.Timeline.Tools */\nexport default class SchedulePostponeController\n{\n\tconstructor()\n\t{\n\t\tthis._item = null;\n\t}\n\n\tinitialize(id, settings)\n\t{\n\t\tthis._id = BX.type.isNotEmptyString(id) ? id : BX.util.getRandomString(4);\n\t\tthis._settings = settings ? settings : {};\n\t\tthis._item = BX.prop.get(this._settings, \"item\", null);\n\t}\n\n\tgetTitle()\n\t{\n\t\treturn this.getMessage(\"title\");\n\t}\n\n\tgetCommandList()\n\t{\n\t\treturn(\n\t\t\t[\n\t\t\t\t{ name: \"postpone_hour_1\", title: this.getMessage(\"forOneHour\") },\n\t\t\t\t{ name: \"postpone_hour_2\", title: this.getMessage(\"forTwoHours\") },\n\t\t\t\t{ name: \"postpone_hour_3\", title: this.getMessage(\"forThreeHours\") },\n\t\t\t\t{ name: \"postpone_day_1\", title: this.getMessage(\"forOneDay\") },\n\t\t\t\t{ name: \"postpone_day_2\", title: this.getMessage(\"forTwoDays\") },\n\t\t\t\t{ name: \"postpone_day_3\", title: this.getMessage(\"forThreeDays\") }\n\t\t\t]\n\t\t);\n\t}\n\n\tprocessCommand(command)\n\t{\n\t\tif(command.indexOf(\"postpone\") !== 0)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tlet offset = 0;\n\t\tif(command === \"postpone_hour_1\")\n\t\t{\n\t\t\toffset = 3600;\n\t\t}\n\t\telse if(command === \"postpone_hour_2\")\n\t\t{\n\t\t\toffset = 7200;\n\t\t}\n\t\telse if(command === \"postpone_hour_3\")\n\t\t{\n\t\t\toffset = 10800;\n\t\t}\n\t\telse if(command === \"postpone_day_1\")\n\t\t{\n\t\t\toffset = 86400;\n\t\t}\n\t\telse if(command === \"postpone_day_2\")\n\t\t{\n\t\t\toffset = 172800;\n\t\t}\n\t\telse if(command === \"postpone_day_3\")\n\t\t{\n\t\t\toffset = 259200;\n\t\t}\n\n\t\tif(offset > 0 && this._item)\n\t\t{\n\t\t\tthis._item.postpone(offset);\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = SchedulePostponeController.messages;\n\t\treturn m.hasOwnProperty(name) ? m[name] : name;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new SchedulePostponeController();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n\n\tstatic messages = {};\n}\n","import Scheduled from \"../scheduled\";\nimport {Item as ItemType} from \"../../types\";\nimport SchedulePostponeController from \"../../tools/schedule-postpone-controller\";\nimport {DatetimeConverter} from \"crm.timeline.tools\";\n\n/** @memberof BX.Crm.Timeline.Items.Scheduled */\nexport default class Activity extends Scheduled\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._postponeController = null;\n\t}\n\n\tgetTypeId()\n\t{\n\t\treturn ItemType.activity;\n\t}\n\n\tisDone()\n\t{\n\t\tconst status = BX.prop.getInteger(this.getAssociatedEntityData(), \"STATUS\");\n\t\treturn (status ===  BX.CrmActivityStatus.completed || status ===  BX.CrmActivityStatus.autoCompleted);\n\t}\n\n\tsetAsDone(isDone)\n\t{\n\t\tisDone = !!isDone;\n\t\tif(this.isDone() === isDone)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst id = BX.prop.getInteger(this.getAssociatedEntityData(), \"ID\", 0);\n\t\tif(id > 0)\n\t\t{\n\t\t\tthis._activityEditor.setActivityCompleted(\n\t\t\t\tid,\n\t\t\t\tisDone,\n\t\t\t\tBX.delegate(this.onSetAsDoneCompleted, this)\n\t\t\t);\n\t\t}\n\t}\n\n\tpostpone(offset)\n\t{\n\t\tconst id = this.getSourceId();\n\t\tif(id > 0 && offset > 0)\n\t\t{\n\t\t\tthis._activityEditor.postponeActivity(\n\t\t\t\tid,\n\t\t\t\toffset,\n\t\t\t\tBX.delegate(this.onPosponeCompleted, this)\n\t\t\t);\n\t\t}\n\t}\n\n\tview()\n\t{\n\t\tconst id = BX.prop.getInteger(this.getAssociatedEntityData(), \"ID\", 0);\n\t\tif(id > 0)\n\t\t{\n\t\t\tthis._activityEditor.viewActivity(id);\n\t\t}\n\t}\n\n\tedit()\n\t{\n\t\tthis.closeContextMenu();\n\t\tconst associatedEntityTypeId = this.getAssociatedEntityTypeId();\n\t\tif(associatedEntityTypeId === BX.CrmEntityType.enumeration.activity)\n\t\t{\n\t\t\tconst entityData = this.getAssociatedEntityData();\n\t\t\tconst id = BX.prop.getInteger(entityData, \"ID\", 0);\n\t\t\tif(id > 0)\n\t\t\t{\n\t\t\t\tthis._activityEditor.editActivity(id);\n\t\t\t}\n\t\t}\n\t}\n\n\tprocessRemoval()\n\t{\n\t\tthis.closeContextMenu();\n\t\tthis._detetionConfirmDlgId = \"entity_timeline_deletion_\" + this.getId() + \"_confirm\";\n\t\tlet dlg = BX.Crm.ConfirmationDialog.get(this._detetionConfirmDlgId);\n\t\tif(!dlg)\n\t\t{\n\t\t\tdlg = BX.Crm.ConfirmationDialog.create(\n\t\t\t\tthis._detetionConfirmDlgId,\n\t\t\t\t{\n\t\t\t\t\ttitle: this.getMessage(\"removeConfirmTitle\"),\n\t\t\t\t\tcontent: this.getRemoveMessage()\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\tdlg.open().then(BX.delegate(this.onRemovalConfirm, this), BX.delegate(this.onRemovalCancel, this));\n\t}\n\n\tgetRemoveMessage()\n\t{\n\t\treturn this.getMessage('removeConfirm');\n\t}\n\n\tonRemovalConfirm(result)\n\t{\n\t\tif(BX.prop.getBoolean(result, \"cancel\", true))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.remove();\n\t}\n\n\tonRemovalCancel()\n\t{\n\t}\n\n\tremove()\n\t{\n\t\tconst associatedEntityTypeId = this.getAssociatedEntityTypeId();\n\n\t\tif(associatedEntityTypeId === BX.CrmEntityType.enumeration.activity)\n\t\t{\n\t\t\tconst entityData = this.getAssociatedEntityData();\n\n\t\t\tconst id = BX.prop.getInteger(entityData, \"ID\", 0);\n\n\t\t\tif(id > 0)\n\t\t\t{\n\t\t\t\tconst activityEditor = this._activityEditor;\n\t\t\t\tconst item = activityEditor.getItemById(id);\n\t\t\t\tif (item)\n\t\t\t\t{\n\t\t\t\t\tactivityEditor.deleteActivity(id, true);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tconst activityType = activityEditor.getSetting('ownerType', '');\n\t\t\t\t\tconst activityId = activityEditor.getSetting('ownerID', '');\n\n\t\t\t\t\tconst serviceUrl = BX.util.add_url_param(activityEditor.getSetting('serviceUrl', ''),\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tid: id,\n\t\t\t\t\t\t\taction: 'get_activity',\n\t\t\t\t\t\t\townertype: activityType,\n\t\t\t\t\t\t\townerid: activityId\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t\tBX.ajax({\n\t\t\t\t\t\t'url': serviceUrl,\n\t\t\t\t\t\t'method': 'POST',\n\t\t\t\t\t\t'dataType': 'json',\n\t\t\t\t\t\t'data':\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t'ACTION' : 'GET_ACTIVITY',\n\t\t\t\t\t\t\t\t'ID': id,\n\t\t\t\t\t\t\t\t'OWNER_TYPE': activityType,\n\t\t\t\t\t\t\t\t'OWNER_ID': activityId\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\tonsuccess: BX.delegate(\n\t\t\t\t\t\t\tfunction(data)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tif(typeof(data['ACTIVITY']) !== 'undefined')\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tactivityEditor._handleActivityChange(data['ACTIVITY']);\n\t\t\t\t\t\t\t\t\twindow.setTimeout(BX.delegate(this.remove ,this), 500);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tthis\n\t\t\t\t\t\t),\n\t\t\t\t\t\tonfailure: function(data){}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tgetDeadline()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst time = BX.parseDate(\n\t\t\tentityData[\"DEADLINE_SERVER\"],\n\t\t\tfalse,\n\t\t\t\"YYYY-MM-DD\",\n\t\t\t\"YYYY-MM-DD HH:MI:SS\"\n\t\t);\n\n\t\tif(!time)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn (new DatetimeConverter(time)).toUserTime().getValue();\n\t}\n\n\tgetLightTime()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst time = BX.parseDate(\n\t\t\tentityData[\"LIGHT_TIME_SERVER\"],\n\t\t\tfalse,\n\t\t\t\"YYYY-MM-DD\",\n\t\t\t\"YYYY-MM-DD HH:MI:SS\"\n\t\t);\n\n\t\tif(!time)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn (new DatetimeConverter(time)).toUserTime().getValue();\n\t}\n\n\tgetCreatedDate()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst time = BX.parseDate(\n\t\t\tentityData[\"CREATED_SERVER\"],\n\t\t\tfalse,\n\t\t\t\"YYYY-MM-DD\",\n\t\t\t\"YYYY-MM-DD HH:MI:SS\"\n\t\t);\n\n\t\tif(!time)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn (new DatetimeConverter(time)).toUserTime().getValue();\n\t}\n\n\tisIncomingChannel()\n\t{\n\t\tif (this.isDone())\n\t\t{\n\t\t\treturn false;\n\t\t}\n\t\tconst entityData = this.getAssociatedEntityData();\n\n\t\treturn entityData.hasOwnProperty('IS_INCOMING_CHANNEL') && entityData.IS_INCOMING_CHANNEL === 'Y';\n\t}\n\n\tmarkAsDone(isDone)\n\t{\n\t\tisDone = !!isDone;\n\t\tthis.getAssociatedEntityData()[\"STATUS\"] = isDone ? BX.CrmActivityStatus.completed : BX.CrmActivityStatus.waiting;\n\t}\n\n\tgetPrepositionText(direction)\n\t{\n\t\treturn this.getMessage(direction === BX.CrmActivityDirection.incoming ? \"from\" : \"to\");\n\t}\n\n\tgetTypeDescription(direction)\n\t{\n\t\treturn \"\";\n\t}\n\n\tisContextMenuEnabled()\n\t{\n\t\treturn ((!!this.getDeadline() && this.canPostpone()) || this.canComplete());\n\t}\n\n\tprepareContent(options)\n\t{\n\t\tlet timeText = '';\n\t\tconst isIncomingChannel = this.isIncomingChannel();\n\t\tif (isIncomingChannel)\n\t\t{\n\t\t\ttimeText = this.formatDateTime(this.getCreatedDate());\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst deadline = this.getDeadline();\n\t\t\ttimeText = deadline ? this.formatDateTime(deadline) : this.getMessage(\"termless\");\n\t\t}\n\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst direction = BX.prop.getInteger(entityData, \"DIRECTION\", 0);\n\t\tconst isDone = this.isDone();\n\t\tconst subject = BX.prop.getString(entityData, \"SUBJECT\", \"\");\n\t\tlet description = BX.prop.getString(entityData, \"DESCRIPTION_RAW\", \"\");\n\n\t\tconst communication = BX.prop.getObject(entityData, \"COMMUNICATION\", {});\n\t\tconst title = BX.prop.getString(communication, \"TITLE\", \"\");\n\t\tconst showUrl = BX.prop.getString(communication, \"SHOW_URL\", \"\");\n\t\tconst communicationValue = BX.prop.getString(communication, \"TYPE\", \"\") !== \"\"\n\t\t\t? BX.prop.getString(communication, \"VALUE\", \"\") : \"\";\n\n\t\tlet wrapperClassName = this.getWrapperClassName();\n\t\tif(wrapperClassName !== \"\")\n\t\t{\n\t\t\twrapperClassName = this._schedule.getItemClassName() + \" \" + wrapperClassName;\n\t\t}\n\t\telse\n\t\t{\n\t\t\twrapperClassName = this._schedule.getItemClassName();\n\t\t}\n\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: wrapperClassName}});\n\n\t\tlet iconClassName = this.getIconClassName();\n\t\tif(this.isCounterEnabled())\n\t\t{\n\t\t\ticonClassName += \" crm-entity-stream-section-counter\";\n\t\t}\n\t\tif(isIncomingChannel)\n\t\t{\n\t\t\ticonClassName += \" crm-entity-stream-section-counter --incoming-counter\";\n\t\t}\n\t\twrapper.appendChild(BX.create(\"DIV\", { attrs: { className: iconClassName } }));\n\n\t\t//region Context Menu\n\t\tif(this.isContextMenuEnabled())\n\t\t{\n\t\t\twrapper.appendChild(this.prepareContextMenuButton());\n\t\t}\n\t\t//endregion\n\n\t\tconst contentWrapper = BX.create(\"DIV\",\n\t\t\t{attrs: {className: \"crm-entity-stream-section-content\"}}\n\t\t);\n\t\twrapper.appendChild(contentWrapper);\n\n\t\t//region Details\n\t\tif(description !== \"\")\n\t\t{\n\t\t\t//trim leading spaces\n\t\t\tdescription = description.replace(/^\\s+/,'');\n\t\t}\n\n\t\tconst contentInnerWrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-event\"}\n\t\t\t}\n\t\t);\n\t\tcontentWrapper.appendChild(contentInnerWrapper);\n\n\t\tthis._deadlineNode = BX.create(\"SPAN\",\n\t\t\t{ attrs: { className: \"crm-entity-stream-content-event-time\" }, text: timeText }\n\t\t);\n\n\t\tconst headerWrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-header\"}\n\t\t\t}\n\t\t);\n\t\theaderWrapper.appendChild(BX.create(\"SPAN\",\n\t\t\t{\n\t\t\t\tattrs:\n\t\t\t\t\t{\n\t\t\t\t\t\tclassName: \"crm-entity-stream-content-event-title\"\n\t\t\t\t\t},\n\t\t\t\ttext: this.getTypeDescription(direction)\n\t\t\t}\n\t\t));\n\n\t\tconst statusNode = this.getStatusNode();\n\t\tif (statusNode)\n\t\t{\n\t\t\theaderWrapper.appendChild(statusNode);\n\t\t}\n\t\theaderWrapper.appendChild(this._deadlineNode);\n\n\t\tcontentInnerWrapper.appendChild(headerWrapper);\n\n\t\tconst detailWrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail\"}\n\t\t\t}\n\t\t);\n\t\tcontentInnerWrapper.appendChild(detailWrapper);\n\n\t\tdetailWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail-title\"},\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattrs: { href: \"#\" },\n\t\t\t\t\t\t\t\t\tevents: { \"click\": this._headerClickHandler },\n\t\t\t\t\t\t\t\t\ttext: subject\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tdetailWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-description\" },\n\t\t\t\t\ttext: this.cutOffText(description, 128)\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst additionalDetails = this.prepareDetailNodes();\n\t\tif(BX.type.isArray(additionalDetails))\n\t\t{\n\t\t\tlet i = 0;\n\t\t\tconst length = additionalDetails.length;\n\t\t\tfor(; i < length; i++)\n\t\t\t{\n\t\t\t\tdetailWrapper.appendChild(additionalDetails[i]);\n\t\t\t}\n\t\t}\n\n\t\tconst members = BX.create(\"DIV\",\n\t\t\t{attrs: {className: \"crm-entity-stream-content-detail-contact-info\"}}\n\t\t);\n\n\t\tif(title !== '')\n\t\t{\n\t\t\tmembers.appendChild(\n\t\t\t\tBX.create(\"SPAN\",\n\t\t\t\t\t{ text: this.getPrepositionText(direction) + \": \" }\n\t\t\t\t)\n\t\t\t);\n\n\t\t\tif(showUrl !== '')\n\t\t\t{\n\t\t\t\tmembers.appendChild(\n\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tattrs: { href: showUrl },\n\t\t\t\t\t\t\ttext: title\n\t\t\t\t\t\t}\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tmembers.appendChild(BX.create(\"SPAN\", { text: title }));\n\t\t\t}\n\t\t}\n\n\t\tif(communicationValue !== '')\n\t\t{\n\t\t\tconst communicationNode = this.prepareCommunicationNode(communicationValue);\n\t\t\tif(communicationNode)\n\t\t\t{\n\t\t\t\tmembers.appendChild(communicationNode);\n\t\t\t}\n\t\t}\n\n\t\tdetailWrapper.appendChild(members);\n\t\t//endregion\n\t\t//region Set as Done Button\n\t\tconst setAsDoneButton = BX.create(\"INPUT\",\n\t\t\t{\n\t\t\t\tattrs:\n\t\t\t\t\t{\n\t\t\t\t\t\ttype: \"checkbox\",\n\t\t\t\t\t\tclassName: \"crm-entity-stream-planned-apply-btn\",\n\t\t\t\t\t\tchecked: isDone\n\t\t\t\t\t},\n\t\t\t\tevents: {change: this._setAsDoneButtonHandler}\n\t\t\t}\n\t\t);\n\n\t\tif(!this.canComplete())\n\t\t{\n\t\t\tsetAsDoneButton.disabled = true;\n\t\t}\n\n\t\tconst buttonContainer = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail-planned-action\"},\n\t\t\t\tchildren: [setAsDoneButton]\n\t\t\t}\n\t\t);\n\t\tcontentInnerWrapper.appendChild(buttonContainer);\n\t\t//endregion\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontentInnerWrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\t//region  Actions\n\t\tthis._actionContainer = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-action\" }\n\t\t\t}\n\t\t);\n\t\tcontentInnerWrapper.appendChild(this._actionContainer);\n\t\t//endregion\n\n\t\treturn wrapper;\n\t}\n\n\tgetStatusNode()\n\t{\n\t\treturn null;\n\t}\n\n\tprepareCommunicationNode(communicationValue)\n\t{\n\t\treturn BX.create(\"SPAN\", { text: \" \" + communicationValue });\n\t}\n\n\tprepareDetailNodes()\n\t{\n\t\treturn [];\n\t}\n\n\tprepareContextMenuItems()\n\t{\n\t\tconst menuItems = [];\n\n\t\tif (!this.isReadOnly())\n\t\t{\n\t\t\tif (this.isEditable())\n\t\t\t{\n\t\t\t\tmenuItems.push({ id: \"edit\", text: this.getMessage(\"menuEdit\"), onclick: BX.delegate(this.edit, this)});\n\t\t\t}\n\n\t\t\tmenuItems.push({ id: \"remove\", text: this.getMessage(\"menuDelete\"), onclick: BX.delegate(this.processRemoval, this)});\n\t\t}\n\n\t\tif (this.canPostpone())\n\t\t{\n\t\t\tconst handler = BX.delegate(this.onContextMenuItemSelect, this);\n\n\t\t\tif(!this._postponeController)\n\t\t\t{\n\t\t\t\tthis._postponeController = SchedulePostponeController.create(\"\", { item: this });\n\t\t\t}\n\n\t\t\tconst postponeMenu =\n\t\t\t\t{\n\t\t\t\t\tid: \"postpone\",\n\t\t\t\t\ttext: this._postponeController.getTitle(),\n\t\t\t\t\titems: []\n\t\t\t\t};\n\n\t\t\tconst commands = this._postponeController.getCommandList();\n\t\t\tlet i = 0;\n\t\t\tconst length = commands.length;\n\t\t\tfor(; i < length; i++)\n\t\t\t{\n\t\t\t\tconst command = commands[i];\n\t\t\t\tpostponeMenu.items.push(\n\t\t\t\t\t{\n\t\t\t\t\t\tid: command[\"name\"],\n\t\t\t\t\t\ttext: command[\"title\"],\n\t\t\t\t\t\tonclick: handler\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t\tmenuItems.push(postponeMenu);\n\t\t}\n\n\t\treturn menuItems;\n\t}\n\n\tonContextMenuItemSelect(e, item)\n\t{\n\t\tthis.closeContextMenu();\n\t\tif(this._postponeController)\n\t\t{\n\t\t\tthis._postponeController.processCommand(item.id);\n\t\t}\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Activity();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import Activity from \"./activity\";\n\n/** @memberof BX.Crm.Timeline.Items.Scheduled */\nexport default class Email extends Activity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetWrapperClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-email\";\n\t}\n\n\tgetIconClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-icon crm-entity-stream-section-icon-email\";\n\t}\n\n\tprepareActions()\n\t{\n\t\tif(this.isReadOnly())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis._actions.push(\n\t\t\tBX.CrmScheduleEmailAction.create(\n\t\t\t\t\"email\",\n\t\t\t\t{\n\t\t\t\t\titem: this,\n\t\t\t\t\tcontainer: this._actionContainer,\n\t\t\t\t\tentityData: this.getAssociatedEntityData(),\n\t\t\t\t\tactivityEditor: this._activityEditor\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t}\n\n\tgetTypeDescription(direction)\n\t{\n\t\treturn this.getMessage(direction === BX.CrmActivityDirection.incoming ? \"incomingEmail\" : \"outgoingEmail\");\n\t}\n\n\tgetRemoveMessage()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tlet title = BX.prop.getString(entityData, \"SUBJECT\", \"\");\n\t\ttitle = BX.util.htmlspecialchars(title);\n\t\treturn this.getMessage('emailRemove').replace(\"#TITLE#\", title);\n\t}\n\n\tisEditable()\n\t{\n\t\treturn false;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Email();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import Activity from \"./activity\";\n\n/** @memberof BX.Crm.Timeline.Items.Scheduled */\nexport default class Call extends Activity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetWrapperClassName()\n\t{\n\t\treturn 'crm-entity-stream-section-call';\n\t}\n\n\tgetIconClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-icon crm-entity-stream-section-icon-call\";\n\t}\n\n\tprepareActions()\n\t{\n\t\tif(this.isReadOnly())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis._actions.push(\n\t\t\tBX.CrmScheduleCallAction.create(\n\t\t\t\t\"call\",\n\t\t\t\t{\n\t\t\t\t\titem: this,\n\t\t\t\t\tcontainer: this._actionContainer,\n\t\t\t\t\tentityData: this.getAssociatedEntityData(),\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\townerInfo: this._schedule.getOwnerInfo()\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t}\n\n\tgetTypeDescription(direction)\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst callInfo = BX.prop.getObject(entityData, \"CALL_INFO\", null);\n\t\tconst callTypeText = callInfo !== null ? BX.prop.getString(callInfo, \"CALL_TYPE_TEXT\", \"\") : \"\";\n\t\tif(callTypeText !== \"\")\n\t\t{\n\t\t\treturn callTypeText;\n\t\t}\n\n\t\treturn this.getMessage(direction === BX.CrmActivityDirection.incoming ? \"incomingCall\" : \"outgoingCall\");\n\t}\n\n\tgetRemoveMessage()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst direction = BX.prop.getInteger(entityData, \"DIRECTION\", 0);\n\t\tlet title = BX.prop.getString(entityData, \"SUBJECT\", \"\");\n\t\tconst messageName = (direction === BX.CrmActivityDirection.incoming) ? 'incomingCallRemove' : 'outgoingCallRemove';\n\t\ttitle = BX.util.htmlspecialchars(title);\n\t\treturn this.getMessage(messageName).replace(\"#TITLE#\", title);\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Call();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import Call from \"./call\";\n\n/** @memberof BX.Crm.Timeline.Items.Scheduled */\nexport default class CallTracker extends Call\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetStatusNode()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst callInfo = BX.prop.getObject(entityData, \"CALL_INFO\", null);\n\n\t\tif (!callInfo)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\t\tif (!BX.prop.getBoolean(callInfo, \"HAS_STATUS\", false))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst isSuccessfull = BX.prop.getBoolean(callInfo, \"SUCCESSFUL\", false);\n\t\tconst statusText = BX.prop.getString(callInfo, \"STATUS_TEXT\", \"\");\n\n\t\treturn BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs:\n\t\t\t\t\t{\n\t\t\t\t\t\tclassName: isSuccessfull\n\t\t\t\t\t\t\t? \"crm-entity-stream-content-event-successful\"\n\t\t\t\t\t\t\t: \"crm-entity-stream-content-event-missing\"\n\t\t\t\t\t},\n\t\t\t\ttext: statusText\n\t\t\t}\n\t\t)\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new CallTracker();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import Activity from \"./activity\";\n\n/** @memberof BX.Crm.Timeline.Items.Scheduled */\nexport default class Meeting extends Activity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetWrapperClassName()\n\t{\n\t\treturn \"\";\n\t}\n\n\tgetIconClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-icon crm-entity-stream-section-icon-meeting\";\n\t}\n\n\tprepareActions()\n\t{\n\t}\n\n\tgetPrepositionText()\n\t{\n\t\treturn this.getMessage(\"reciprocal\");\n\t}\n\n\tgetRemoveMessage()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tlet title = BX.prop.getString(entityData, \"SUBJECT\", \"\");\n\t\ttitle = BX.util.htmlspecialchars(title);\n\t\treturn this.getMessage('meetingRemove').replace(\"#TITLE#\", title);\n\t}\n\n\tgetTypeDescription()\n\t{\n\t\treturn this.getMessage(\"meeting\");\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Meeting();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import Activity from \"./activity\";\n\n/** @memberof BX.Crm.Timeline.Items.Scheduled */\nexport default class Task extends Activity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetWrapperClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-planned-task\";\n\t}\n\n\tgetIconClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-icon crm-entity-stream-section-icon-task\";\n\t}\n\n\tgetTypeDescription()\n\t{\n\t\treturn this.getMessage(\"task\");\n\t}\n\n\tgetPrepositionText(direction)\n\t{\n\t\treturn this.getMessage(\"reciprocal\");\n\t}\n\n\tgetRemoveMessage()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tlet title = BX.prop.getString(entityData, \"SUBJECT\", \"\");\n\t\ttitle = BX.util.htmlspecialchars(title);\n\t\treturn this.getMessage('taskRemove').replace(\"#TITLE#\", title);\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Task();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import Activity from \"./activity\";\n\n/** @memberof BX.Crm.Timeline.Items.Scheduled */\nexport default class WebForm extends Activity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetWrapperClassName()\n\t{\n\t\treturn \"\";\n\t}\n\n\tgetIconClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-icon crm-entity-stream-section-icon-crmForm\";\n\t}\n\n\tprepareActions()\n\t{\n\t}\n\n\tgetPrepositionText()\n\t{\n\t\treturn this.getMessage(\"from\");\n\t}\n\n\tgetTypeDescription()\n\t{\n\t\treturn this.getMessage(\"webform\");\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new WebForm();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import Scheduled from \"../scheduled\";\nimport {Item as ItemType} from \"../../types\";\nimport SchedulePostponeController from \"../../tools/schedule-postpone-controller\";\nimport {DatetimeConverter} from \"crm.timeline.tools\";\n\n/** @memberof BX.Crm.Timeline.Items.Scheduled */\nexport default class Wait extends Scheduled\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._postponeController = null;\n\t}\n\n\tgetTypeId()\n\t{\n\t\treturn ItemType.wait;\n\t}\n\n\tgetWrapperClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-wait\";\n\t}\n\n\tgetIconClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-icon crm-entity-stream-section-icon-wait\";\n\t}\n\n\tprepareActions()\n\t{\n\t}\n\n\tisCounterEnabled()\n\t{\n\t\treturn false;\n\t}\n\n\tgetDeadline()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst time = BX.parseDate(\n\t\t\tentityData[\"DEADLINE_SERVER\"],\n\t\t\tfalse,\n\t\t\t\"YYYY-MM-DD\",\n\t\t\t\"YYYY-MM-DD HH:MI:SS\"\n\t\t);\n\n\t\tif(!time)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn (new DatetimeConverter(time)).toUserTime().getValue();\n\t}\n\n\tisDone()\n\t{\n\t\treturn (BX.prop.getString(this.getAssociatedEntityData(), \"COMPLETED\", \"N\") ===  \"Y\");\n\t}\n\n\tsetAsDone(isDone)\n\t{\n\t\tisDone = !!isDone;\n\t\tif(this.isDone() === isDone)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst id = this.getAssociatedEntityId();\n\t\tif(id > 0)\n\t\t{\n\t\t\tconst editor = BX.Crm.Timeline?.MenuBar?.getDefault()?.getItemById('wait');\n\t\t\tif(editor)\n\t\t\t{\n\t\t\t\teditor.complete(\n\t\t\t\t\tid,\n\t\t\t\t\tisDone,\n\t\t\t\t\tBX.delegate(this.onSetAsDoneCompleted, this)\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n\n\tpostpone(offset)\n\t{\n\t\tconst id = this.getAssociatedEntityId();\n\t\tif(id > 0 && offset > 0)\n\t\t{\n\t\t\tconst editor = BX.Crm.Timeline?.MenuBar?.getDefault()?.getItemById('wait');\n\t\t\tif(editor)\n\t\t\t{\n\t\t\t\teditor.postpone(\n\t\t\t\t\tid,\n\t\t\t\t\toffset,\n\t\t\t\t\tBX.delegate(this.onPosponeCompleted, this)\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n\n\tisContextMenuEnabled()\n\t{\n\t\treturn !!this.getDeadline() && this.canPostpone();\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst deadline = this.getDeadline();\n\t\tconst timeText = deadline ? this.formatDateTime(deadline) : this.getMessage(\"termless\");\n\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst isDone = this.isDone();\n\t\tlet description = BX.prop.getString(entityData, \"DESCRIPTION_RAW\", \"\");\n\n\t\tlet wrapperClassName = this.getWrapperClassName();\n\t\tif(wrapperClassName !== \"\")\n\t\t{\n\t\t\twrapperClassName = \"crm-entity-stream-section crm-entity-stream-section-planned\" + \" \" + wrapperClassName;\n\t\t}\n\t\telse\n\t\t{\n\t\t\twrapperClassName = \"crm-entity-stream-section crm-entity-stream-section-planned\";\n\t\t}\n\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: wrapperClassName}});\n\n\t\tlet iconClassName = this.getIconClassName();\n\t\tif(this.isCounterEnabled())\n\t\t{\n\t\t\ticonClassName += \" crm-entity-stream-section-counter\";\n\t\t}\n\n\t\twrapper.appendChild(BX.create(\"DIV\", { attrs: { className: iconClassName } }));\n\n\t\t//region Context Menu\n\t\tif(this.isContextMenuEnabled())\n\t\t{\n\t\t\twrapper.appendChild(this.prepareContextMenuButton());\n\t\t}\n\t\t//endregion\n\n\t\tconst contentWrapper = BX.create(\"DIV\",\n\t\t\t{attrs: {className: \"crm-entity-stream-section-content\"}}\n\t\t);\n\t\twrapper.appendChild(contentWrapper);\n\n\t\t//region Details\n\t\tif(description !== \"\")\n\t\t{\n\t\t\tdescription = BX.util.trim(description);\n\t\t\tdescription = BX.util.strip_tags(description);\n\t\t\tdescription = this.cutOffText(description, 512);\n\t\t\tdescription = BX.util.nl2br(description);\n\t\t}\n\n\t\tconst contentInnerWrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-event\"}\n\t\t\t}\n\t\t);\n\t\tcontentWrapper.appendChild(contentInnerWrapper);\n\n\t\tthis._deadlineNode = BX.create(\"SPAN\",\n\t\t\t{ attrs: { className: \"crm-entity-stream-content-event-time\" }, text: timeText }\n\t\t);\n\n\t\tconst headerWrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-header\"},\n\t\t\t\tchildren:\n\t\t\t\t\t[\n\t\t\t\t\t\tBX.create(\"SPAN\",\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-event-title\"},\n\t\t\t\t\t\t\t\ttext: this.getMessage(\"wait\")\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t),\n\t\t\t\t\t\tthis._deadlineNode\n\t\t\t\t\t]\n\t\t\t}\n\t\t);\n\t\tcontentInnerWrapper.appendChild(headerWrapper);\n\n\t\tconst detailWrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail\"}\n\t\t\t}\n\t\t);\n\t\tcontentInnerWrapper.appendChild(detailWrapper);\n\n\t\tdetailWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-description\" },\n\t\t\t\t\thtml: description\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst members = BX.create(\"DIV\",\n\t\t\t{attrs: {className: \"crm-entity-stream-content-detail-contact-info\"}}\n\t\t);\n\n\t\tdetailWrapper.appendChild(members);\n\t\t//endregion\n\n\t\t//region Set as Done Button\n\t\tconst setAsDoneButton = BX.create(\"INPUT\",\n\t\t\t{\n\t\t\t\tattrs:\n\t\t\t\t\t{\n\t\t\t\t\t\ttype: \"checkbox\",\n\t\t\t\t\t\tclassName: \"crm-entity-stream-planned-apply-btn\",\n\t\t\t\t\t\tchecked: isDone\n\t\t\t\t\t},\n\t\t\t\tevents: {change: this._setAsDoneButtonHandler}\n\t\t\t}\n\t\t);\n\n\t\tif(!this.canComplete())\n\t\t{\n\t\t\tsetAsDoneButton.disabled = true;\n\t\t}\n\n\t\tconst buttonContainer = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail-planned-action\"},\n\t\t\t\tchildren: [setAsDoneButton]\n\t\t\t}\n\t\t);\n\t\tcontentInnerWrapper.appendChild(buttonContainer);\n\t\t//endregion\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontentInnerWrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\t//region  Actions\n\t\tthis._actionContainer = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-action\" }\n\t\t\t}\n\t\t);\n\t\tcontentInnerWrapper.appendChild(this._actionContainer);\n\t\t//endregion\n\n\t\treturn wrapper;\n\t}\n\n\tprepareContextMenuItems()\n\t{\n\t\tconst menuItems = [];\n\t\tconst handler = BX.delegate(this.onContextMenuItemSelect, this);\n\n\t\tif(!this._postponeController)\n\t\t{\n\t\t\tthis._postponeController = SchedulePostponeController.create(\"\", { item: this });\n\t\t}\n\n\t\tconst postponeMenu =\n\t\t\t{\n\t\t\t\tid: \"postpone\",\n\t\t\t\ttext: this._postponeController.getTitle(),\n\t\t\t\titems: []\n\t\t\t};\n\n\t\tconst commands = this._postponeController.getCommandList();\n\t\tlet i = 0;\n\t\tconst length = commands.length;\n\t\tfor(; i < length; i++)\n\t\t{\n\t\t\tconst command = commands[i];\n\t\t\tpostponeMenu.items.push(\n\t\t\t\t{\n\t\t\t\t\tid: command[\"name\"],\n\t\t\t\t\ttext: command[\"title\"],\n\t\t\t\t\tonclick: handler\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\tmenuItems.push(postponeMenu);\n\t\treturn menuItems;\n\t}\n\n\tonContextMenuItemSelect(e, item)\n\t{\n\t\tthis.closeContextMenu();\n\t\tif(this._postponeController)\n\t\t{\n\t\t\tthis._postponeController.processCommand(item.id);\n\t\t}\n\t}\n\n\tgetTypeDescription()\n\t{\n\t\treturn this.getMessage(\"wait\");\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Wait();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import Activity from \"./activity\";\n\n/** @memberof BX.Crm.Timeline.Items.Scheduled */\nexport default class Request extends Activity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetWrapperClassName()\n\t{\n\t\treturn \"\";\n\t}\n\n\tgetIconClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-icon crm-entity-stream-section-icon-robot\";\n\t}\n\n\tgetTypeDescription()\n\t{\n\t\treturn this.getMessage(\"activityRequest\");\n\t}\n\n\tisEditable()\n\t{\n\t\treturn false;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Request();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import Activity from \"./activity\";\n\n/** @memberof BX.Crm.Timeline.Items.Scheduled */\nexport default class Rest extends Activity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetWrapperClassName()\n\t{\n\t\treturn \"\";\n\t}\n\n\tgetIconClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-icon crm-entity-stream-section-icon-rest\";\n\t}\n\n\tprepareContent(options)\n\t{\n\t\tconst wrapper = super.prepareContent(options);\n\t\tconst data = this.getAssociatedEntityData();\n\n\t\tif (data['APP_TYPE'] && data['APP_TYPE']['ICON_SRC'])\n\t\t{\n\t\t\tconst iconNode = wrapper.querySelector('.' + this.getIconClassName().replace(/\\s+/g, '.'));\n\t\t\tif (iconNode)\n\t\t\t{\n\t\t\t\ticonNode.style.backgroundImage = \"url('\" +  data['APP_TYPE']['ICON_SRC'] + \"')\";\n\t\t\t\ticonNode.style.backgroundPosition = \"center center\";\n\t\t\t\ticonNode.style.backgroundSize = \"cover\";\n\t\t\t\ticonNode.style.backgroundColor = \"transparent\";\n\t\t\t}\n\t\t}\n\n\t\treturn wrapper;\n\t}\n\n\tgetTypeDescription()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tif (entityData['APP_TYPE'] && entityData['APP_TYPE']['NAME'])\n\t\t{\n\t\t\treturn entityData['APP_TYPE']['NAME'];\n\t\t}\n\n\t\treturn this.getMessage(\"restApplication\");\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Rest();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","/** @memberof BX.Crm.Timeline */\nexport default class Action\n{\n\tconstructor()\n\t{\n\t\tthis._id = \"\";\n\t\tthis._settings = {};\n\t\tthis._container = null;\n\t}\n\n\tinitialize(id, settings)\n\t{\n\t\tthis._id = BX.type.isNotEmptyString(id) ? id : BX.util.getRandomString(4);\n\t\tthis._settings = settings ? settings : {};\n\n\t\tthis._container = this.getSetting(\"container\");\n\t\tif(!BX.type.isElementNode(this._container))\n\t\t{\n\t\t\tthrow \"BX.CrmTimelineAction: Could not find container.\";\n\t\t}\n\n\t\tthis.doInitialize();\n\t}\n\n\tdoInitialize()\n\t{\n\t}\n\n\tgetId()\n\t{\n\t\treturn this._id;\n\t}\n\n\tgetSetting(name, defaultval)\n\t{\n\t\treturn this._settings.hasOwnProperty(name) ? this._settings[name] : defaultval;\n\t}\n\n\tlayout()\n\t{\n\t\tthis.doLayout();\n\t}\n\n\tdoLayout()\n\t{\n\t}\n}\n","import Action from \"../action\";\n\n/** @memberof BX.Crm.Timeline.Actions */\nexport default class Activity extends Action\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._activityEditor = null;\n\t\tthis._entityData = null;\n\t\tthis._item = null;\n\t\tthis._isEnabled = true;\n\t}\n\n\tdoInitialize()\n\t{\n\t\tthis._entityData = this.getSetting(\"entityData\");\n\t\tif(!BX.type.isPlainObject(this._entityData))\n\t\t{\n\t\t\tthrow \"BX.Crm.Timeline.Actions.Activity. A required parameter 'entityData' is missing.\";\n\t\t}\n\n\t\tthis._activityEditor = this.getSetting(\"activityEditor\");\n\t\tif(!(this._activityEditor instanceof BX.CrmActivityEditor))\n\t\t{\n\t\t\tthrow \"BX.Crm.Timeline.Actions.Activity. A required parameter 'activityEditor' is missing.\";\n\t\t}\n\n\t\tthis._item = this.getSetting(\"item\");\n\t\tthis._isEnabled = this.getSetting(\"enabled\", true);\n\t}\n\n\tgetActivityId()\n\t{\n\t\treturn BX.prop.getInteger(this._entityData, \"ID\", 0);\n\t}\n\n\tloadActivityCommunications(callback)\n\t{\n\t\tthis._activityEditor.getActivityCommunications(\n\t\t\tthis.getActivityId(),\n\t\t\tfunction(communications)\n\t\t\t{\n\t\t\t\tif(BX.type.isFunction(callback))\n\t\t\t\t{\n\t\t\t\t\tcallback(communications);\n\t\t\t\t}\n\t\t\t},\n\t\t\ttrue\n\t\t);\n\t}\n\n\tgetItemData()\n\t{\n\t\treturn this._item ?  this._item.getData() : null;\n\t}\n}\n","import Activity from \".//activity\";\n\n/** @memberof BX.Crm.Timeline.Actions */\nexport class OpenLine extends Activity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._clickHandler = BX.delegate(this.onClick, this);\n\t\tthis._button = null;\n\t}\n\n\tgetButton()\n\t{\n\t\treturn this._button;\n\t}\n\n\tonClick()\n\t{\n\t\tif(typeof(window.top['BXIM']) === 'undefined')\n\t\t{\n\t\t\twindow.alert(this.getMessage(\"openLineNotSupported\"));\n\t\t\treturn;\n\t\t}\n\n\t\tlet slug = \"\";\n\t\tconst communication = BX.prop.getObject(this._entityData, \"COMMUNICATION\", null);\n\t\tif(communication)\n\t\t{\n\t\t\tif(BX.prop.getString(communication, \"TYPE\") === \"IM\")\n\t\t\t{\n\t\t\t\tslug = BX.prop.getString(communication, \"VALUE\");\n\t\t\t}\n\t\t}\n\n\t\tif(slug !== \"\")\n\t\t{\n\t\t\twindow.top['BXIM'].openMessengerSlider(slug, {RECENT: 'N', MENU: 'N'});\n\t\t}\n\t}\n\n\tdoLayout()\n\t{\n\t\tthis._button = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: { className: \"crm-entity-stream-content-action-reply-btn\" },\n\t\t\t\tevents: { \"click\": this._clickHandler }\n\t\t\t}\n\t\t);\n\t\tthis._container.appendChild(this._button);\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = OpenLine.messages;\n\t\treturn m.hasOwnProperty(name) ? m[name] : name;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new OpenLine();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n\n\tstatic messages = {};\n}\n","import Activity from \"./activity\";\nimport {OpenLine as OpenLineAction} from \"../../actions/openline\";\n\n/** @memberof BX.Crm.Timeline.Items.Scheduled */\nexport default class OpenLine extends Activity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetWrapperClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-IM\";\n\t}\n\n\tgetIconClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-icon crm-entity-stream-section-icon-IM\";\n\t}\n\n\tprepareActions()\n\t{\n\t\tif(this.isReadOnly())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis._actions.push(\n\t\t\tOpenLineAction.create(\n\t\t\t\t\"openline\",\n\t\t\t\t{\n\t\t\t\t\titem: this,\n\t\t\t\t\tcontainer: this._actionContainer,\n\t\t\t\t\tentityData: this.getAssociatedEntityData(),\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\townerInfo: this._schedule.getOwnerInfo()\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t}\n\n\tgetTypeDescription()\n\t{\n\t\treturn this.getMessage(\"openLine\");\n\t}\n\n\tgetPrepositionText(direction)\n\t{\n\t\treturn this.getMessage(\"reciprocal\");\n\t}\n\n\tprepareCommunicationNode(communicationValue)\n\t{\n\t\treturn null;\n\t}\n\n\tprepareDetailNodes()\n\t{\n\t\tconst wrapper = BX.create(\"DIV\",\n\t\t\t{attrs: {className: \"crm-entity-stream-content-detail-IM\"}}\n\t\t);\n\n\t\tconst messageWrapper = BX.create(\"DIV\",\n\t\t\t{attrs: {className: \"crm-entity-stream-content-detail-IM-messages\"}}\n\t\t);\n\t\twrapper.appendChild(messageWrapper);\n\n\t\tconst openLineData = BX.prop.getObject(this.getAssociatedEntityData(), \"OPENLINE_INFO\", null);\n\t\tif(openLineData)\n\t\t{\n\t\t\tconst messages = BX.prop.getArray(openLineData, \"MESSAGES\", []);\n\t\t\tlet i = 0;\n\t\t\tconst length = messages.length;\n\t\t\tfor(; i < length; i++)\n\t\t\t{\n\t\t\t\tconst message = messages[i];\n\t\t\t\tconst isExternal = BX.prop.getBoolean(message, \"IS_EXTERNAL\", true);\n\n\t\t\t\tmessageWrapper.appendChild(\n\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tattrs:\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tclassName: isExternal\n\t\t\t\t\t\t\t\t\t\t? \"crm-entity-stream-content-detail-IM-message-incoming\"\n\t\t\t\t\t\t\t\t\t\t: \"crm-entity-stream-content-detail-IM-message-outgoing\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\thtml: BX.prop.getString(message, \"MESSAGE\", \"\")\n\t\t\t\t\t\t}\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\treturn [ wrapper ];\n\t}\n\n\tview()\n\t{\n\t\tif(typeof(window.top['BXIM']) === 'undefined')\n\t\t{\n\t\t\twindow.alert(this.getMessage(\"openLineNotSupported\"));\n\t\t\treturn;\n\t\t}\n\n\t\tlet slug = \"\";\n\t\tconst communication = BX.prop.getObject(this.getAssociatedEntityData(), \"COMMUNICATION\", null);\n\t\tif(communication)\n\t\t{\n\t\t\tif(BX.prop.getString(communication, \"TYPE\") === \"IM\")\n\t\t\t{\n\t\t\t\tslug = BX.prop.getString(communication, \"VALUE\");\n\t\t\t}\n\t\t}\n\n\t\tif(slug !== \"\")\n\t\t{\n\t\t\twindow.top['BXIM'].openMessengerSlider(slug, {RECENT: 'N', MENU: 'N'});\n\t\t}\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new OpenLine();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import Activity from \"./activity\";\nimport {DatetimeConverter} from \"crm.timeline.tools\";\n\n/** @memberof BX.Crm.Timeline.Items.Scheduled */\nexport default class Zoom extends Activity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetWrapperClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-zoom\";\n\t}\n\n\tgetIconClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-icon crm-entity-stream-section-icon-zoom\";\n\t}\n\n\tgetTypeDescription()\n\t{\n\t\treturn this.getMessage(\"zoom\");\n\t}\n\n\tgetPrepositionText(direction)\n\t{\n\t}\n\n\tprepareCommunicationNode(communicationValue)\n\t{\n\t\treturn null;\n\t}\n\n\tprepareContent(options)\n\t{\n\t\tconst deadline = this.getDeadline();\n\t\tconst timeText = deadline ? this.formatDateTime(deadline) : this.getMessage(\"termless\");\n\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst direction = BX.prop.getInteger(entityData, \"DIRECTION\", 0);\n\t\tconst isDone = this.isDone();\n\t\tconst subject = BX.prop.getString(entityData, \"SUBJECT\", \"\");\n\t\tlet description = BX.prop.getString(entityData, \"DESCRIPTION_RAW\", \"\");\n\n\t\tconst communication = BX.prop.getObject(entityData, \"COMMUNICATION\", {});\n\t\tconst title = BX.prop.getString(communication, \"TITLE\", \"\");\n\t\tconst showUrl = BX.prop.getString(communication, \"SHOW_URL\", \"\");\n\t\tconst communicationValue = BX.prop.getString(communication, \"TYPE\", \"\") !== \"\"\n\t\t\t? BX.prop.getString(communication, \"VALUE\", \"\") : \"\";\n\n\t\tlet wrapperClassName = this.getWrapperClassName();\n\t\tif(wrapperClassName !== \"\")\n\t\t{\n\t\t\twrapperClassName = \"crm-entity-stream-section crm-entity-stream-section-planned\" + \" \" + wrapperClassName;\n\t\t}\n\t\telse\n\t\t{\n\t\t\twrapperClassName = \"crm-entity-stream-section crm-entity-stream-section-planned\";\n\t\t}\n\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: wrapperClassName}});\n\n\t\tlet iconClassName = this.getIconClassName();\n\t\tif(this.isCounterEnabled())\n\t\t{\n\t\t\ticonClassName += \" crm-entity-stream-section-counter\";\n\t\t}\n\t\twrapper.appendChild(BX.create(\"DIV\", { attrs: { className: iconClassName } }));\n\n\t\t//region Context Menu\n\t\tif(this.isContextMenuEnabled())\n\t\t{\n\t\t\twrapper.appendChild(this.prepareContextMenuButton());\n\t\t}\n\t\t//endregion\n\n\t\tconst contentWrapper = BX.create(\"DIV\",\n\t\t\t{attrs: {className: \"crm-entity-stream-section-content\"}}\n\t\t);\n\t\twrapper.appendChild(contentWrapper);\n\n\t\t//region Details\n\t\tif(description !== \"\")\n\t\t{\n\t\t\t//trim leading spaces\n\t\t\tdescription = description.replace(/^\\s+/,'');\n\t\t}\n\n\t\tconst contentInnerWrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-event\"}\n\t\t\t}\n\t\t);\n\t\tcontentWrapper.appendChild(contentInnerWrapper);\n\n\t\tthis._deadlineNode = BX.create(\"SPAN\",\n\t\t\t{ attrs: { className: \"crm-entity-stream-content-event-time\" }, text: timeText }\n\t\t);\n\n\t\tconst headerWrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-header\"},\n\t\t\t\tchildren:\n\t\t\t\t\t[\n\t\t\t\t\t\tBX.create(\"SPAN\",\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tattrs:\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tclassName: \"crm-entity-stream-content-event-title\"\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\ttext: this.getTypeDescription(direction)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t),\n\t\t\t\t\t\tthis._deadlineNode\n\t\t\t\t\t]\n\t\t\t}\n\t\t);\n\t\tcontentInnerWrapper.appendChild(headerWrapper);\n\n\t\tconst detailWrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail\"}\n\t\t\t}\n\t\t);\n\t\tcontentInnerWrapper.appendChild(detailWrapper);\n\n\t\tif (entityData['ZOOM_INFO'])\n\t\t{\n\t\t\tconst topic = entityData['ZOOM_INFO']['TOPIC'];\n\t\t\tconst duration = entityData['ZOOM_INFO']['DURATION'];\n\t\t\tconst startTime = BX.parseDate(\n\t\t\t\tentityData['ZOOM_INFO']['CONF_START_TIME'],\n\t\t\t\tfalse,\n\t\t\t\t\"YYYY-MM-DD\",\n\t\t\t\t\"YYYY-MM-DD HH:MI:SS\"\n\t\t\t);\n\t\t\tconst date = (new DatetimeConverter(startTime)).toUserTime().toDatetimeString({delimiter: ', '});\n\t\t\tconst detailZoomMessage = BX.create(\"span\",\n\t\t\t\t{\n\t\t\t\t\ttext: this.getMessage(\"zoomCreatedMessage\")\n\t\t\t\t\t\t.replace(\"#CONFERENCE_TITLE#\", topic)\n\t\t\t\t\t\t.replace(\"#DATE_TIME#\", date)\n\t\t\t\t\t\t.replace(\"#DURATION#\", duration)\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tconst detailZoomInfoLink = BX.create(\"A\",\n\t\t\t\t{\n\t\t\t\t\tattrs:\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\thref: entityData['ZOOM_INFO']['CONF_URL'],\n\t\t\t\t\t\t\ttarget: \"_blank\",\n\t\t\t\t\t\t},\n\t\t\t\t\ttext: entityData['ZOOM_INFO']['CONF_URL']\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tconst detailZoomInfo = BX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail-zoom-info\"},\n\t\t\t\t\tchildren: [detailZoomMessage, detailZoomInfoLink]\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tdetailWrapper.appendChild(detailZoomInfo);\n\n\t\t\tconst detailZoomCopyInviteLink = BX.create(\"A\",\n\t\t\t\t{\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\tclassName: 'ui-link ui-link-dashed',\n\t\t\t\t\t\t\"data-url\": entityData['ZOOM_INFO']['CONF_URL']\n\t\t\t\t\t},\n\t\t\t\t\ttext: this.getMessage(\"zoomCreatedCopyInviteLink\"),\n\t\t\t\t}\n\t\t\t);\n\t\t\tBX.clipboard.bindCopyClick(detailZoomCopyInviteLink, {\n\t\t\t\ttext: entityData['ZOOM_INFO']['CONF_URL'],\n\t\t\t});\n\n\t\t\tconst detailZoomStartConferenceButton = BX.create(\"BUTTON\",\n\t\t\t\t{\n\t\t\t\t\tattrs: {className: 'ui-btn ui-btn-sm ui-btn-primary'},\n\t\t\t\t\ttext: this.getMessage(\"zoomCreatedStartConference\"),\n\t\t\t\t\tevents: {\n\t\t\t\t\t\t\"click\": function () {\n\t\t\t\t\t\t\twindow.open(entityData['ZOOM_INFO']['CONF_URL']);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tconst detailZoomCopyInviteLinkWrapper = BX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail-zoom-link-wrapper\"},\n\t\t\t\t\tchildren: [detailZoomCopyInviteLink]\n\t\t\t\t}\n\t\t\t);\n\t\t\tdetailWrapper.appendChild(detailZoomCopyInviteLinkWrapper);\n\t\t\tdetailWrapper.appendChild(detailZoomStartConferenceButton);\n\t\t}\n\n\t\tconst additionalDetails = this.prepareDetailNodes();\n\t\tif(BX.type.isArray(additionalDetails))\n\t\t{\n\t\t\tlet i = 0;\n\t\t\tconst length = additionalDetails.length;\n\t\t\tfor(; i < length; i++)\n\t\t\t{\n\t\t\t\tdetailWrapper.appendChild(additionalDetails[i]);\n\t\t\t}\n\t\t}\n\n\t\t//endregion\n\t\t//region Set as Done Button\n\t\tconst setAsDoneButton = BX.create(\"INPUT\",\n\t\t\t{\n\t\t\t\tattrs:\n\t\t\t\t\t{\n\t\t\t\t\t\ttype: \"checkbox\",\n\t\t\t\t\t\tclassName: \"crm-entity-stream-planned-apply-btn\",\n\t\t\t\t\t\tchecked: isDone\n\t\t\t\t\t},\n\t\t\t\tevents: {change: this._setAsDoneButtonHandler}\n\t\t\t}\n\t\t);\n\n\t\tif(!this.canComplete())\n\t\t{\n\t\t\tsetAsDoneButton.disabled = true;\n\t\t}\n\n\t\tconst buttonContainer = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail-planned-action\"},\n\t\t\t\tchildren: [setAsDoneButton]\n\t\t\t}\n\t\t);\n\t\tcontentInnerWrapper.appendChild(buttonContainer);\n\t\t//endregion\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontentInnerWrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\t//region  Actions\n\t\tthis._actionContainer = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-action\" }\n\t\t\t}\n\t\t);\n\t\tcontentInnerWrapper.appendChild(this._actionContainer);\n\t\t//endregion\n\n\t\treturn wrapper;\n\t}\n\n\tprepareDetailNodes()\n\t{\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Zoom();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import Stream from \"../stream\";\nimport Activity from \"../items/scheduled/activity\";\nimport Email from \"../items/scheduled/email\";\nimport Call from \"../items/scheduled/call\";\nimport CallTracker from \"../items/scheduled/call-tracker\";\nimport Meeting from \"../items/scheduled/meeting\";\nimport Task from \"../items/scheduled/task\";\nimport WebForm from \"../items/scheduled/webform\";\nimport Wait from \"../items/scheduled/wait\";\nimport Request from \"../items/scheduled/request\";\nimport Rest from \"../items/scheduled/rest\";\nimport OpenLine from \"../items/scheduled/openline\";\nimport Zoom from \"../items/scheduled/zoom\";\nimport ItemNew from \"../animations/item-new\";\nimport {ConfigurableItem} from \"crm.timeline.item\";\nimport {StreamType} from 'crm.timeline.item';\nimport {DatetimeConverter} from \"crm.timeline.tools\";\n\n/** @memberof BX.Crm.Timeline.Streams */\nexport default class Schedule extends Stream\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._items = [];\n\t\tthis._history = null;\n\t\tthis._wrapper = null;\n\t\tthis._anchor = null;\n\t\tthis._stub = null;\n\t}\n\n\tdoInitialize()\n\t{\n\t\tif(!this.isStubMode())\n\t\t{\n\t\t\tlet itemData = this.getSetting(\"itemData\");\n\t\t\tif(!BX.type.isArray(itemData))\n\t\t\t{\n\t\t\t\titemData = [];\n\t\t\t}\n\n\t\t\tlet i, length, item;\n\t\t\tfor(i = 0, length = itemData.length; i < length; i++)\n\t\t\t{\n\t\t\t\titem = this.createItem(itemData[i]);\n\t\t\t\tif(item)\n\t\t\t\t{\n\t\t\t\t\tthis._items.push(item);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tlayout()\n\t{\n\t\tthis._wrapper = BX.create(\"DIV\", {});\n\t\tthis._container.appendChild(this._wrapper);\n\n\t\tconst label = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-planned-label\"},\n\t\t\t\ttext: this.getMessage(\"planned\")\n\t\t\t}\n\t\t);\n\n\t\tconst wrapperClassName = \"crm-entity-stream-section crm-entity-stream-section-planned-label\";\n\t\tthis._wrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: wrapperClassName },\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\t\t\t\t\tchildren: [ label ]\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tif(this.isStubMode())\n\t\t{\n\t\t\tthis.addStub();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst length = this._items.length;\n\t\t\tif(length === 0)\n\t\t\t{\n\t\t\t\tthis.addStub();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tfor(let i = 0; i < length; i++)\n\t\t\t\t{\n\t\t\t\t\tconst item = this._items[i];\n\t\t\t\t\titem.setContainer(this._wrapper);\n\t\t\t\t\titem.layout();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.refreshLayout();\n\t\tthis._manager.processSheduleLayoutChange();\n\t}\n\n\trefreshLayout()\n\t{\n\t\tBX.onCustomEvent('Schedule:onBeforeRefreshLayout', [this]);\n\t\tconst length = this._items.length;\n\t\tif(length === 0)\n\t\t{\n\t\t\tthis.addStub();\n\t\t\tif(this._history && this._history.hasContent())\n\t\t\t{\n\t\t\t\tBX.removeClass(this._stub, \"crm-entity-stream-section-last\");\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tBX.addClass(this._stub, \"crm-entity-stream-section-last\");\n\t\t\t}\n\n\t\t\tconst stubIcon = this._stub.querySelector(\".crm-entity-stream-section-icon\");\n\t\t\tif(stubIcon)\n\t\t\t{\n\t\t\t\tif(this._manager.isStubCounterEnabled())\n\t\t\t\t{\n\t\t\t\t\tBX.addClass(stubIcon, \"crm-entity-stream-section-counter\");\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tBX.removeClass(stubIcon, \"crm-entity-stream-section-counter\");\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\n\t\tlet i, item;\n\t\tif(this._history && this._history.hasContent())\n\t\t{\n\t\t\tfor(i = 0;  i < length; i++)\n\t\t\t{\n\t\t\t\titem = this._items[i];\n\t\t\t\tif(item.isTerminated())\n\t\t\t\t{\n\t\t\t\t\titem.markAsTerminated(false);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif(length > 1)\n\t\t\t{\n\t\t\t\tfor(i = 0;  i < (length - 1); i++)\n\t\t\t\t{\n\t\t\t\t\titem = this._items[i];\n\t\t\t\t\tif(item.isTerminated())\n\t\t\t\t\t{\n\t\t\t\t\t\titem.markAsTerminated(false);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis._items[length - 1].markAsTerminated(true);\n\t\t}\n\t}\n\n\tformatDateTime(time)\n\t{\n\t\treturn (new DatetimeConverter(time)).toDatetimeString({delimiter: ', '});\n\t}\n\n\tcheckItemForTermination(item)\n\t{\n\t\tif(this._history && this._history.getItemCount() > 0)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\t\treturn this.getLastItem() === item;\n\t}\n\n\tgetItems(): Array\n\t{\n\t\treturn this._items;\n\t}\n\n\tsetItems(items: Array): void\n\t{\n\t\tthis._items = items;\n\t}\n\n\tcalculateItemIndex(item)\n\t{\n\t\tconst sort = item.getSort();\n\n\t\tfor(let i =0; i < this._items.length; i++)\n\t\t{\n\t\t\tconst curSort = this._items[i].getSort();\n\t\t\tfor (let j = 0; j < curSort.length; j++)\n\t\t\t{\n\t\t\t\tif (sort.length <= j || sort[j] !== curSort[j])\n\t\t\t\t{\n\t\t\t\t\tif (sort[j] < curSort[j])\n\t\t\t\t\t{\n\t\t\t\t\t\treturn i;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn this._items.length;\n\t}\n\n\tgetItemCount()\n\t{\n\t\treturn this._items.length;\n\t}\n\n\tgetItemByAssociatedEntity($entityTypeId, entityId)\n\t{\n\t\tif(!BX.type.isNumber($entityTypeId))\n\t\t{\n\t\t\t$entityTypeId = parseInt($entityTypeId);\n\t\t}\n\n\t\tif(!BX.type.isNumber(entityId))\n\t\t{\n\t\t\tentityId = parseInt(entityId);\n\t\t}\n\n\t\tif(isNaN($entityTypeId) || $entityTypeId <= 0 || isNaN(entityId) || entityId <= 0)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tfor(let i = 0, length = this._items.length; i < length; i++)\n\t\t{\n\t\t\tconst item = this._items[i];\n\t\t\tif(item.getAssociatedEntityTypeId() === $entityTypeId && item.getAssociatedEntityId() === entityId)\n\t\t\t{\n\t\t\t\treturn item;\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tgetItemByData(itemData)\n\t{\n\t\tif(!BX.type.isPlainObject(itemData))\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn this.getItemByAssociatedEntity(\n\t\t\tBX.prop.getInteger(itemData, \"ASSOCIATED_ENTITY_TYPE_ID\", 0),\n\t\t\tBX.prop.getInteger(itemData, \"ASSOCIATED_ENTITY_ID\", 0)\n\t\t);\n\t}\n\n\n\tgetItemByIndex(index)\n\t{\n\t\treturn index < this._items.length ? this._items[index] : null;\n\t}\n\n\tcreateItem(data)\n\t{\n\t\tconst entityTypeID = BX.prop.getInteger(data, \"ASSOCIATED_ENTITY_TYPE_ID\", 0);\n\t\tconst entityID = BX.prop.getInteger(data, \"ASSOCIATED_ENTITY_ID\", 0);\n\t\tconst entityData = BX.prop.getObject(data, \"ASSOCIATED_ENTITY\", {});\n\t\tlet itemId = BX.CrmEntityType.resolveName(entityTypeID) + \"_\" + entityID.toString();\n\n\t\tif (data.hasOwnProperty('type'))\n\t\t{\n\t\t\titemId = data.id;\n\n\t\t\treturn ConfigurableItem.create(itemId, {\n\t\t\t\ttimelineId: this.getId(),\n\t\t\t\tcontainer: this.getWrapper(),\n\t\t\t\titemClassName: this.getItemClassName(),\n\t\t\t\tisReadOnly: this.isReadOnly(),\n\t\t\t\tcurrentUser: this._manager.getCurrentUser(),\n\t\t\t\townerTypeId: this._manager.getOwnerTypeId(),\n\t\t\t\townerId: this._manager.getOwnerId(),\n\t\t\t\tstreamType: this.getStreamType(),\n\t\t\t\tdata: data,\n\t\t\t})\n\t\t}\n\n\t\tif(entityTypeID === BX.CrmEntityType.enumeration.wait)\n\t\t{\n\t\t\treturn Wait.create(\n\t\t\t\titemId,\n\t\t\t\t{\n\t\t\t\t\tschedule: this,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse// if(entityTypeID === BX.CrmEntityType.enumeration.activity)\n\t\t{\n\t\t\tconst typeId = BX.prop.getInteger(entityData, \"TYPE_ID\", 0);\n\t\t\tconst providerId = BX.prop.getString(entityData, \"PROVIDER_ID\", \"\");\n\n\t\t\tif(typeId === BX.CrmActivityType.email)\n\t\t\t{\n\t\t\t\treturn Email.create(\n\t\t\t\t\titemId,\n\t\t\t\t\t{\n\t\t\t\t\t\tschedule: this,\n\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\tdata: data\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t\telse if(typeId === BX.CrmActivityType.call)\n\t\t\t{\n\t\t\t\treturn Call.create(\n\t\t\t\t\titemId,\n\t\t\t\t\t{\n\t\t\t\t\t\tschedule: this,\n\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\tdata: data\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t\telse if(typeId === BX.CrmActivityType.meeting)\n\t\t\t{\n\t\t\t\treturn Meeting.create(\n\t\t\t\t\titemId,\n\t\t\t\t\t{\n\t\t\t\t\t\tschedule: this,\n\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\tdata: data\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t\telse if(typeId === BX.CrmActivityType.task)\n\t\t\t{\n\t\t\t\treturn Task.create(\n\t\t\t\t\titemId,\n\t\t\t\t\t{\n\t\t\t\t\t\tschedule: this,\n\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\tdata: data\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t\telse if(typeId === BX.CrmActivityType.provider)\n\t\t\t{\n\t\t\t\tif(providerId === \"CRM_WEBFORM\")\n\t\t\t\t{\n\t\t\t\t\treturn WebForm.create(\n\t\t\t\t\t\titemId,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tschedule: this,\n\t\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\t\tdata: data\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\telse if(providerId === \"CRM_REQUEST\")\n\t\t\t\t{\n\t\t\t\t\treturn Request.create(\n\t\t\t\t\t\titemId,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tschedule: this,\n\t\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\t\tdata: data\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\telse if(providerId === \"IMOPENLINES_SESSION\")\n\t\t\t\t{\n\t\t\t\t\treturn OpenLine.create(\n\t\t\t\t\t\titemId,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tschedule: this,\n\t\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\t\tdata: data\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\telse if(providerId === \"ZOOM\")\n\t\t\t\t{\n\t\t\t\t\treturn Zoom.create(\n\t\t\t\t\t\titemId,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tschedule: this,\n\t\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\t\tdata: data\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\telse if(providerId === \"REST_APP\")\n\t\t\t\t{\n\t\t\t\t\treturn Rest.create(\n\t\t\t\t\t\titemId,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tschedule: this,\n\t\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\t\tdata: data\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\telse if(providerId === 'CRM_CALL_TRACKER')\n\t\t\t\t{\n\t\t\t\t\treturn CallTracker.create(\n\t\t\t\t\t\titemId,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tschedule: this,\n\t\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\t\tdata: data,\n\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tgetWrapper()\n\t{\n\t\treturn this._wrapper;\n\t}\n\n\tgetItemClassName()\n\t{\n\t\treturn 'crm-entity-stream-section crm-entity-stream-section-planned';\n\t}\n\n\tgetStreamType(): number\n\t{\n\t\treturn StreamType.scheduled;\n\t}\n\n\taddItem(item, index)\n\t{\n\t\tif(!BX.type.isNumber(index) || index < 0)\n\t\t{\n\t\t\tindex = this.calculateItemIndex(item);\n\t\t}\n\n\t\tif(index < this._items.length)\n\t\t{\n\t\t\tthis._items.splice(index, 0, item);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis._items.push(item);\n\t\t}\n\n\t\tthis.removeStub();\n\n\t\tthis.refreshLayout();\n\t\tthis._manager.processSheduleLayoutChange();\n\t}\n\n\tgetHistory()\n\t{\n\t\treturn this._history;\n\t}\n\n\tsetHistory(history)\n\t{\n\t\tthis._history = history;\n\t}\n\n\tcreateAnchor(index)\n\t{\n\t\tthis._anchor = BX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section crm-entity-stream-section-shadow\" } });\n\t\tif(index >= 0 && index < this._items.length)\n\t\t{\n\t\t\tthis._wrapper.insertBefore(this._anchor, this._items[index].getWrapper());\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis._wrapper.appendChild(this._anchor);\n\t\t}\n\t\treturn this._anchor;\n\t}\n\n\tdeleteItem(item)\n\t{\n\t\tconst index = this.getItemIndex(item);\n\t\tif(index < 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\titem.clearLayout();\n\t\tthis.removeItemByIndex(index);\n\n\t\tthis.refreshLayout();\n\t\tthis._manager.processSheduleLayoutChange();\n\t}\n\n\ttransferItemToHistory(item, historyItemData)\n\t{\n\t\tconst index = this.getItemIndex(item);\n\t\tif(index < 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.removeItemByIndex(index);\n\n\t\tthis.refreshLayout();\n\t\tthis._manager.processSheduleLayoutChange();\n\n\t\tconst historyItem = this._history.createItem(historyItemData);\n\t\tthis._history.addItem(historyItem, 0);\n\t\thistoryItem.layout({ add: false });\n\n\t\tconst animation = ItemNew.create(\n\t\t\t\"\",\n\t\t\t{\n\t\t\t\tinitialItem: item,\n\t\t\t\tfinalItem: historyItem,\n\t\t\t\tanchor: this._history.createAnchor(),\n\t\t\t\tevents: {complete: BX.delegate(this.onTransferComplete, this)}\n\t\t\t}\n\t\t);\n\t\tanimation.run();\n\t}\n\n\tonTransferComplete()\n\t{\n\t\tthis._history.refreshLayout();\n\n\t\tif(this._items.length === 0)\n\t\t{\n\t\t\tthis.addStub();\n\t\t}\n\t}\n\n\tonItemMarkedAsDone(item, params)\n\t{\n\t}\n\n\taddStub()\n\t{\n\t\tif(!this._stub)\n\t\t{\n\t\t\tlet stubClassName = \"crm-entity-stream-section crm-entity-stream-section-planned crm-entity-stream-section-notTask\";\n\t\t\tlet stubIconClassName = \"crm-entity-stream-section-icon crm-entity-stream-section-icon-info\";\n\t\t\tconst canAddTodo = !!BX.Crm.Timeline?.MenuBar?.getDefault()?.getItemById('todo');\n\t\t\tif (canAddTodo && !this.isReadOnly())\n\t\t\t{\n\t\t\t\tstubClassName += ' --active';\n\t\t\t}\n\n\t\t\tlet stubMessage = this.getMessage(\"stub\");\n\n\t\t\tconst ownerTypeId = this._manager.getOwnerTypeId();\n\t\t\tif(ownerTypeId === BX.CrmEntityType.enumeration.lead)\n\t\t\t{\n\t\t\t\tstubMessage = this.getMessage(\"leadStub\");\n\t\t\t}\n\t\t\telse if(ownerTypeId === BX.CrmEntityType.enumeration.deal)\n\t\t\t{\n\t\t\t\tstubMessage = this.getMessage(\"dealStub\");\n\t\t\t}\n\n\t\t\tif(this._manager.isStubCounterEnabled())\n\t\t\t{\n\t\t\t\tstubIconClassName += \" crm-entity-stream-section-counter\";\n\t\t\t}\n\n\t\t\tthis._stub = BX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: stubClassName },\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"DIV\", { attrs: { className: stubIconClassName } }),\n\t\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-event\" },\n\t\t\t\t\t\t\t\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-title\" },\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttext: this.getMessage(\"stubTitle\"),\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail\" },\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttext: stubMessage\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t);\n\t\t\tif (canAddTodo && !this.isReadOnly())\n\t\t\t{\n\t\t\t\tBX.bind(this._stub, \"click\", BX.delegate(this.focusOnTodoEditor, this));\n\t\t\t}\n\t\t\tthis._wrapper.appendChild(this._stub);\n\t\t}\n\n\t\tif(this._history && this._history.getItemCount() > 0)\n\t\t{\n\t\t\tBX.removeClass(this._stub, \"crm-entity-stream-section-last\");\n\t\t}\n\t\telse\n\t\t{\n\t\t\tBX.addClass(this._stub, \"crm-entity-stream-section-last\");\n\t\t}\n\t}\n\n\tremoveStub()\n\t{\n\t\tif(this._stub)\n\t\t{\n\t\t\tthis._stub = BX.remove(this._stub);\n\t\t}\n\n\t}\n\n\tfocusOnTodoEditor()\n\t{\n\t\tconst menuBar = BX.Crm.Timeline.MenuBar.getDefault();\n\t\tif (menuBar)\n\t\t{\n\t\t\tmenuBar.setActiveItemById('todo');\n\n\t\t\tconst todoEditor = menuBar.getItemById('todo');\n\t\t\ttodoEditor?.focus();\n\t\t}\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = Schedule.messages;\n\t\treturn m.hasOwnProperty(name) ? m[name] : name;\n\t}\n\n\tanimateItemAdding(item): Promise\n\t{\n\t\titem.addWrapperClass('crm-entity-stream-section-updated', 1000);\n\t\treturn Promise.resolve();\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Schedule();\n\t\tself.initialize(id, settings);\n\t\tSchedule.items[self.getId()] = self;\n\t\treturn self;\n\t}\n\n\tstatic items = {};\n\tstatic messages = {};\n}\n","import History from \"./history\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Modification extends History\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = Modification.messages;\n\t\treturn m.hasOwnProperty(name) ? m[name] : name;\n\t}\n\n\tgetTitle()\n\t{\n\t\treturn this.getTextDataParam(\"TITLE\");\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-section crm-entity-stream-section-info\"}});\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-info\" } })\n\t\t);\n\n\t\tconst content = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\tconst header = this.prepareHeaderLayout();\n\n\t\tconst contentChildren = [];\n\t\tif (BX.type.isNotEmptyString(this.getTextDataParam(\"START_NAME\")))\n\t\t{\n\t\t\tcontentChildren.push(\n\t\t\t\tBX.create(\"SPAN\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-detain-info-status\"},\n\t\t\t\t\t\ttext: this.getTextDataParam(\"START_NAME\")\n\t\t\t\t\t})\n\t\t\t);\n\t\t\tcontentChildren.push(\n\t\t\t\tBX.create(\"SPAN\",{ attrs: { className: \"crm-entity-stream-content-detail-info-separator-icon\" } })\n\t\t\t);\n\t\t}\n\n\t\tif (BX.type.isNotEmptyString(this.getTextDataParam(\"FINISH_NAME\")))\n\t\t{\n\t\t\tcontentChildren.push(\n\t\t\t\tBX.create(\"SPAN\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detain-info-status\" },\n\t\t\t\t\t\ttext: this.getTextDataParam(\"FINISH_NAME\")\n\t\t\t\t\t})\n\t\t\t);\n\t\t}\n\n\n\t\tcontent.appendChild(header);\n\t\tcontent.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail\" },\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-info\" },\n\t\t\t\t\t\t\t\t\tchildren: contentChildren\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t]\n\t\t\t\t})\n\t\t);\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontent.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-content\" }, children: [ content ] })\n\t\t);\n\n\t\treturn wrapper;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Modification();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n\n\tstatic messages = {};\n}\n","import History from \"./history\";\n\n/** @memberof BX.Crm.Timeline.Actions */\nexport default class Conversion extends History\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = Conversion.messages;\n\t\treturn m.hasOwnProperty(name) ? m[name] : name;\n\t}\n\n\tgetTitle()\n\t{\n\t\treturn this.getTextDataParam(\"TITLE\");\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-section crm-entity-stream-section-convert crm-entity-stream-section-history\"}});\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-convert\" } })\n\t\t);\n\n\t\tconst content = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\tconst header = this.prepareHeaderLayout();\n\n\t\tcontent.appendChild(header);\n\n\t\tconst entityNodes = [];\n\t\tconst entityInfos = this.getArrayDataParam(\"ENTITIES\");\n\t\tlet i = 0;\n\t\tconst length = entityInfos.length;\n\t\tfor(; i < length; i++)\n\t\t{\n\t\t\tconst entityInfo = entityInfos[i];\n\n\t\t\tlet entityNode;\n\t\t\tif(BX.prop.getString(entityInfo, 'SHOW_URL', \"\") === \"\")\n\t\t\t{\n\t\t\t\tentityNode = BX.create(\"DIV\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-convert\" },\n\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detain-convert-status\" },\n\t\t\t\t\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t\t\t\t\tBX.create(\"SPAN\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-status-text\" },\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttext: BX.CrmEntityType.getNotFoundMessage(entityInfo['ENTITY_TYPE_ID'])\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tentityNode = BX.create(\"DIV\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-convert\" },\n\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detain-convert-status\" },\n\t\t\t\t\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t\t\t\t\tBX.create(\"SPAN\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-status-text\" },\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttext: entityInfo['ENTITY_TYPE_CAPTION']\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\tBX.create(\"SPAN\", { attrs: { className: \"crm-entity-stream-content-detail-convert-separator-icon\" } }),\n\t\t\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detain-convert-status\" },\n\t\t\t\t\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tattrs:\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName: \"crm-entity-stream-content-detail-target\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\thref: entityInfo['SHOW_URL']\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttext: entityInfo['TITLE']\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t\tentityNodes.push(entityNode);\n\t\t}\n\n\t\tcontent.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail\" },\n\t\t\t\t\tchildren: entityNodes\n\t\t\t\t})\n\t\t);\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontent.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-content\" }, children: [ content ] })\n\t\t);\n\n\t\treturn wrapper;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Conversion();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n\n\tstatic messages = {};\n}\n","import Activity from \".//activity\";\n\n/** @memberof BX.Crm.Timeline.Actions */\nexport class Email extends Activity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._clickHandler = BX.delegate(this.onClick, this);\n\t\tthis._saveHandler = BX.delegate(this.onSave, this);\n\t}\n\n\tonClick(e)\n\t{\n\t\tconst settings =\n\t\t\t{\n\t\t\t\t\"ownerType\": BX.CrmEntityType.resolveName(BX.prop.getInteger(this._entityData, \"OWNER_TYPE_ID\", 0)),\n\t\t\t\t\"ownerID\": BX.prop.getInteger(this._entityData, \"OWNER_ID\", 0),\n\t\t\t\t\"ownerUrl\": BX.prop.getString(this._entityData, \"OWNER_URL\", \"\"),\n\t\t\t\t\"ownerTitle\": BX.prop.getString(this._entityData, \"OWNER_TITLE\", \"\"),\n\t\t\t\t\"originalMessageID\": BX.prop.getInteger(this._entityData, \"ID\", 0),\n\t\t\t\t\"messageType\": \"RE\"\n\t\t\t};\n\n\t\tif (BX.CrmActivityProvider && top.BX.Bitrix24 && top.BX.Bitrix24.Slider)\n\t\t{\n\t\t\tconst activity = this._activityEditor.addEmail(settings);\n\t\t\tactivity.addOnSave(this._saveHandler);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.loadActivityCommunications(\n\t\t\t\tBX.delegate(\n\t\t\t\t\tfunction(communications)\n\t\t\t\t\t{\n\t\t\t\t\t\tsettings['communications'] = BX.type.isArray(communications) ? communications : [];\n\t\t\t\t\t\tsettings['communicationsLoaded'] = true;\n\n\t\t\t\t\t\tBX.CrmActivityEmail.prepareReply(settings);\n\n\t\t\t\t\t\tconst activity = this._activityEditor.addEmail(settings);\n\t\t\t\t\t\tactivity.addOnSave(this._saveHandler);\n\t\t\t\t\t},\n\t\t\t\t\tthis\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\t\treturn BX.PreventDefault(e);\n\t}\n\n\tonSave(activity, data)\n\t{\n\t\tif(BX.type.isFunction(this._item.onActivityCreate))\n\t\t{\n\t\t\tthis._item.onActivityCreate(activity, data);\n\t\t}\n\t}\n}\n\n/** @memberof BX.Crm.Timeline.Actions */\nexport class HistoryEmail extends Email\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tdoLayout()\n\t{\n\t\tthis._container.appendChild(\n\t\t\tBX.create(\"A\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-action-reply-btn\" },\n\t\t\t\t\tevents: { \"click\": this._clickHandler }\n\t\t\t\t})\n\t\t);\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new HistoryEmail();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n\n/** @memberof BX.Crm.Timeline.Actions */\nexport class ScheduleEmail extends Email\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tdoLayout()\n\t{\n\t\tthis._container.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-action-reply-btn\" },\n\t\t\t\t\tevents: { \"click\": this._clickHandler }\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new ScheduleEmail();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import History from \"./history\";\nimport {Mark} from \"../types\";\nimport {HistoryEmail} from \"../actions/email\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class HistoryActivity extends History\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tdoInitialize()\n\t{\n\t\tsuper.doInitialize();\n\t\tif(!(this._activityEditor instanceof BX.CrmActivityEditor))\n\t\t{\n\t\t\tthrow \"HistoryActivity. The field 'activityEditor' is not assigned.\";\n\t\t}\n\t}\n\n\tgetTitle()\n\t{\n\t\treturn BX.prop.getString(this.getAssociatedEntityData(), \"SUBJECT\", \"\");\n\t}\n\n\tgetTypeDescription()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst direction = BX.prop.getInteger(entityData, \"DIRECTION\", 0);\n\n\t\tconst typeCategoryId = this.getTypeCategoryId();\n\t\tif(typeCategoryId === BX.CrmActivityType.email)\n\t\t{\n\t\t\treturn this.getMessage(direction === BX.CrmActivityDirection.incoming ? \"incomingEmail\" : \"outgoingEmail\");\n\t\t}\n\t\telse if(typeCategoryId === BX.CrmActivityType.call)\n\t\t{\n\t\t\treturn this.getMessage(direction === BX.CrmActivityDirection.incoming ? \"incomingCall\" : \"outgoingCall\");\n\t\t}\n\t\telse if(typeCategoryId === BX.CrmActivityType.meeting)\n\t\t{\n\t\t\treturn this.getMessage(\"meeting\");\n\t\t}\n\t\telse if(typeCategoryId === BX.CrmActivityType.task)\n\t\t{\n\t\t\treturn this.getMessage(\"task\");\n\t\t}\n\t\telse if(typeCategoryId === BX.CrmActivityType.provider)\n\t\t{\n\t\t\tconst providerId = BX.prop.getString(entityData, \"PROVIDER_ID\", \"\");\n\n\t\t\tif(providerId === \"CRM_WEBFORM\")\n\t\t\t{\n\t\t\t\treturn this.getMessage(\"webform\");\n\t\t\t}\n\t\t\telse if (providerId === \"CRM_SMS\")\n\t\t\t{\n\t\t\t\treturn this.getMessage(\"sms\");\n\t\t\t}\n\t\t\telse if (providerId === \"CRM_REQUEST\")\n\t\t\t{\n\t\t\t\treturn this.getMessage(\"activityRequest\");\n\t\t\t}\n\t\t\telse if (providerId === \"IMOPENLINES_SESSION\")\n\t\t\t{\n\t\t\t\treturn this.getMessage(\"openLine\");\n\t\t\t}\n\t\t\telse if (providerId === \"REST_APP\")\n\t\t\t{\n\t\t\t\treturn this.getMessage(\"restApplication\");\n\t\t\t}\n\t\t\telse if (providerId === \"VISIT_TRACKER\")\n\t\t\t{\n\t\t\t\treturn this.getMessage(\"visit\");\n\t\t\t}\n\t\t\telse if (providerId === \"ZOOM\")\n\t\t\t{\n\t\t\t\treturn this.getMessage(\"zoom\");\n\t\t\t}\n\t\t}\n\n\t\treturn \"\";\n\t}\n\n\tprepareTitleLayout()\n\t{\n\t\treturn BX.create(\"A\",\n\t\t\t{\n\t\t\t\tattrs: { href: \"#\",  className: \"crm-entity-stream-content-event-title\" },\n\t\t\t\tevents: { \"click\": this._headerClickHandler },\n\t\t\t\ttext: this.getTypeDescription()\n\t\t\t}\n\t\t);\n\t}\n\n\tprepareTimeLayout()\n\t{\n\t\treturn BX.create(\"SPAN\",\n\t\t\t{\n\t\t\t\tattrs: { className: \"crm-entity-stream-content-event-time\" },\n\t\t\t\ttext: this.formatTime(this.getCreatedTime())\n\t\t\t}\n\t\t);\n\t}\n\n\tprepareMarkLayout()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst markTypeId = BX.prop.getInteger(entityData, \"MARK_TYPE_ID\", 0);\n\t\tif(markTypeId <= 0)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tlet messageName = \"\";\n\t\tif(markTypeId === Mark.success)\n\t\t{\n\t\t\tmessageName = \"SuccessMark\";\n\t\t}\n\t\telse if(markTypeId === Mark.renew)\n\t\t{\n\t\t\tmessageName = \"RenewMark\";\n\t\t}\n\n\t\tif(messageName === \"\")\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tlet markText = \"\";\n\t\tconst typeCategoryId = this.getTypeCategoryId();\n\t\tif(typeCategoryId === BX.CrmActivityType.email)\n\t\t{\n\t\t\tmarkText = this.getMessage(\"email\" + messageName);\n\t\t}\n\t\telse if(typeCategoryId === BX.CrmActivityType.call)\n\t\t{\n\t\t\tmarkText = this.getMessage(\"call\" + messageName);\n\t\t}\n\t\telse if(typeCategoryId === BX.CrmActivityType.meeting)\n\t\t{\n\t\t\tmarkText = this.getMessage(\"meeting\" + messageName);\n\t\t}\n\t\telse if(typeCategoryId === BX.CrmActivityType.task)\n\t\t{\n\t\t\tmarkText = this.getMessage(\"task\" + messageName);\n\t\t}\n\n\t\tif(markText === \"\")\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn(\n\t\t\tBX.create(\n\t\t\t\t\"SPAN\",\n\t\t\t\t{\n\t\t\t\t\tprops: { className: \"crm-entity-stream-content-event-skipped\" },\n\t\t\t\t\ttext: markText\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t}\n\n\tprepareActions()\n\t{\n\t\tif(this.isReadOnly())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst typeCategoryId = this.getTypeCategoryId();\n\t\tif(typeCategoryId === BX.CrmActivityType.email)\n\t\t{\n\t\t\tthis._actions.push(\n\t\t\t\tHistoryEmail.create(\n\t\t\t\t\t\"email\",\n\t\t\t\t\t{\n\t\t\t\t\t\titem: this,\n\t\t\t\t\t\tcontainer: this._actionContainer,\n\t\t\t\t\t\tentityData: this.getAssociatedEntityData(),\n\t\t\t\t\t\tactivityEditor: this._activityEditor\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\t}\n\n\tprepareContextMenuItems()\n\t{\n\t\tif(this._isMenuShown)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst menuItems = [];\n\n\t\tif (!this.isReadOnly())\n\t\t{\n\t\t\tif (this.isEditable())\n\t\t\t{\n\t\t\t\tmenuItems.push({ id: \"edit\", text: this.getMessage(\"menuEdit\"), onclick: BX.delegate(this.edit, this)});\n\t\t\t}\n\t\t\tmenuItems.push({ id: \"remove\", text: this.getMessage(\"menuDelete\"), onclick: BX.delegate(this.processRemoval, this)});\n\n\t\t\tif (this.isFixed() || this._fixedHistory.findItemById(this._id))\n\t\t\t\tmenuItems.push({ id: \"unfasten\", text: this.getMessage(\"menuUnfasten\"), onclick: BX.delegate(this.unfasten, this)});\n\t\t\telse\n\t\t\t\tmenuItems.push({ id: \"fasten\", text: this.getMessage(\"menuFasten\"), onclick: BX.delegate(this.fasten, this)});\n\t\t}\n\t\treturn menuItems;\n\t}\n\n\tview()\n\t{\n\t\tthis.closeContextMenu();\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst id = BX.prop.getInteger(entityData, \"ID\", 0);\n\t\tif(id > 0)\n\t\t{\n\t\t\tthis._activityEditor.viewActivity(id);\n\t\t}\n\t}\n\n\tedit()\n\t{\n\t\tthis.closeContextMenu();\n\t\tconst associatedEntityTypeId = this.getAssociatedEntityTypeId();\n\t\tif(associatedEntityTypeId === BX.CrmEntityType.enumeration.activity)\n\t\t{\n\t\t\tconst entityData = this.getAssociatedEntityData();\n\t\t\tconst id = BX.prop.getInteger(entityData, \"ID\", 0);\n\t\t\tif(id > 0)\n\t\t\t{\n\t\t\t\tthis._activityEditor.editActivity(id);\n\t\t\t}\n\t\t}\n\t}\n\n\tprocessRemoval()\n\t{\n\t\tthis.closeContextMenu();\n\t\tthis._detetionConfirmDlgId = \"entity_timeline_deletion_\" + this.getId() + \"_confirm\";\n\t\tlet dlg = BX.Crm.ConfirmationDialog.get(this._detetionConfirmDlgId);\n\t\tif(!dlg)\n\t\t{\n\t\t\tdlg = BX.Crm.ConfirmationDialog.create(\n\t\t\t\tthis._detetionConfirmDlgId,\n\t\t\t\t{\n\t\t\t\t\ttitle: this.getMessage(\"removeConfirmTitle\"),\n\t\t\t\t\tcontent: this.getRemoveMessage()\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\tdlg.open().then(BX.delegate(this.onRemovalConfirm, this), BX.delegate(this.onRemovalCancel, this));\n\t}\n\n\tgetRemoveMessage()\n\t{\n\t\treturn this.getMessage('removeConfirm');\n\t}\n\n\tonRemovalConfirm(result)\n\t{\n\t\tif(BX.prop.getBoolean(result, \"cancel\", true))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.remove();\n\t}\n\n\tonRemovalCancel()\n\t{\n\t}\n\n\tremove()\n\t{\n\t\tconst associatedEntityTypeId = this.getAssociatedEntityTypeId();\n\n\t\tif(associatedEntityTypeId === BX.CrmEntityType.enumeration.activity)\n\t\t{\n\t\t\tconst entityData = this.getAssociatedEntityData();\n\n\t\t\tconst id = BX.prop.getInteger(entityData, \"ID\", 0);\n\n\t\t\tif(id > 0)\n\t\t\t{\n\t\t\t\tconst activityEditor = this._activityEditor;\n\t\t\t\tconst item = activityEditor.getItemById(id);\n\t\t\t\tif (item)\n\t\t\t\t{\n\t\t\t\t\tactivityEditor.deleteActivity(id, true);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tconst serviceUrl = BX.util.add_url_param(activityEditor.getSetting('serviceUrl', ''),\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tid: id,\n\t\t\t\t\t\t\taction: 'get_activity',\n\t\t\t\t\t\t\townertype: activityEditor.getSetting('ownerType', ''),\n\t\t\t\t\t\t\townerid: activityEditor.getSetting('ownerID', '')\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t\tBX.ajax({\n\t\t\t\t\t\t'url': serviceUrl,\n\t\t\t\t\t\t'method': 'POST',\n\t\t\t\t\t\t'dataType': 'json',\n\t\t\t\t\t\t'data':\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t'ACTION' : 'GET_ACTIVITY',\n\t\t\t\t\t\t\t\t'ID': id,\n\t\t\t\t\t\t\t\t'OWNER_TYPE': activityEditor.getSetting('ownerType', ''),\n\t\t\t\t\t\t\t\t'OWNER_ID': activityEditor.getSetting('ownerID', '')\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\tonsuccess: BX.delegate(\n\t\t\t\t\t\t\tfunction(data)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tif(typeof(data['ACTIVITY']) !== 'undefined')\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tactivityEditor._handleActivityChange(data['ACTIVITY']);\n\t\t\t\t\t\t\t\t\twindow.setTimeout(BX.delegate(this.remove ,this), 500);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tthis\n\t\t\t\t\t\t),\n\t\t\t\t\t\tonfailure: function(data){}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new HistoryActivity();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n\n\tstatic messages = {};\n}\n","import HistoryActivity from \"./history-activity\";\nimport {HistoryEmail} from \"../actions/email\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Email extends HistoryActivity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tprepareHeaderLayout()\n\t{\n\t\tconst header = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-header\"}});\n\t\theader.appendChild(this.prepareTitleLayout());\n\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst emailInfo = BX.prop.getObject(entityData, \"EMAIL_INFO\", null);\n\t\tconst statusText = emailInfo !== null ? BX.prop.getString(emailInfo, \"STATUS_TEXT\", \"\") : \"\";\n\t\tconst error = emailInfo !== null ? BX.prop.getBoolean(emailInfo, \"STATUS_ERROR\", false) : false;\n\t\tconst className = !error ? \"crm-entity-stream-content-event-skipped\" : \"crm-entity-stream-content-event-missing\";\n\t\tif(statusText !== \"\")\n\t\t{\n\t\t\theader.appendChild(\n\t\t\t\tBX.create(\n\t\t\t\t\t\"SPAN\",\n\t\t\t\t\t{\n\t\t\t\t\t\tprops: { className: className},\n\t\t\t\t\t\ttext: statusText\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\n\t\tconst markNode = this.prepareMarkLayout();\n\t\tif(markNode)\n\t\t{\n\t\t\theader.appendChild(markNode);\n\t\t}\n\n\t\theader.appendChild(this.prepareTimeLayout());\n\t\treturn header;\n\t}\n\n\tprepareContextMenuItems()\n\t{\n\t\tconst menuItems = [];\n\n\t\tif (!this.isReadOnly())\n\t\t{\n\t\t\tmenuItems.push({id: \"view\", text: this.getMessage(\"menuView\"), onclick: BX.delegate(this.view, this)});\n\n\t\t\tmenuItems.push({ id: \"remove\", text: this.getMessage(\"menuDelete\"), onclick: BX.delegate(this.processRemoval, this)});\n\n\t\t\tif (this.isFixed() || this._fixedHistory.findItemById(this._id))\n\t\t\t\tmenuItems.push({ id: \"unfasten\", text: this.getMessage(\"menuUnfasten\"), onclick: BX.delegate(this.unfasten, this)});\n\t\t\telse\n\t\t\t\tmenuItems.push({ id: \"fasten\", text: this.getMessage(\"menuFasten\"), onclick: BX.delegate(this.fasten, this)});\n\t\t}\n\n\t\treturn menuItems;\n\t}\n\n\treply()\n\t{\n\t}\n\n\treplyAll()\n\t{\n\t}\n\n\tforward()\n\t{\n\t}\n\n\tgetRemoveMessage()\n\t{\n\t\tconst title = BX.util.htmlspecialchars(this.getTitle());\n\t\treturn this.getMessage('emailRemove').replace(\"#TITLE#\", title);\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\n\t\tlet description = BX.prop.getString(entityData, \"DESCRIPTION_RAW\", \"\");\n\t\tif(description !== \"\")\n\t\t{\n\t\t\t//trim leading spaces\n\t\t\tdescription = description.replace(/^\\s+/,'');\n\t\t}\n\n\t\tconst communication = BX.prop.getObject(entityData, \"COMMUNICATION\", {});\n\t\tconst communicationTitle = BX.prop.getString(communication, \"TITLE\", \"\");\n\t\tconst communicationShowUrl = BX.prop.getString(communication, \"SHOW_URL\", \"\");\n\t\tconst communicationValue = BX.prop.getString(communication, \"VALUE\", \"\");\n\n\t\tconst outerWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-section crm-entity-stream-section-history crm-entity-stream-section-email\"}});\n\t\touterWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-email\" }\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tif (this.isFixed())\n\t\t\tBX.addClass(outerWrapper, 'crm-entity-stream-section-top-fixed');\n\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\touterWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\tchildren: [ wrapper ]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\t//Header\n\t\tconst header = this.prepareHeaderLayout();\n\t\twrapper.appendChild(header);\n\n\t\t//region Context Menu\n\t\tif(this.isContextMenuEnabled())\n\t\t{\n\t\t\twrapper.appendChild(this.prepareContextMenuButton());\n\t\t}\n\t\t//endregion\n\n\t\t//Details\n\t\tconst detailWrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail-email\"}\n\t\t\t}\n\t\t);\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail\" },\n\t\t\t\t\tchildren: [ detailWrapper ]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\t//TODO: Add status text\n\t\t/*\n\t\tdetailWrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-content-detail-email-read-status\" } })\n\t\t);\n\t\t*/\n\n\t\tdetailWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-email-title\" },\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattrs: { href: \"#\" },\n\t\t\t\t\t\t\t\t\tevents: { \"click\": this._headerClickHandler },\n\t\t\t\t\t\t\t\t\ttext: this.getTitle()\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst communicationWrapper = BX.create(\"DIV\",\n\t\t\t{attrs: {className: \"crm-entity-stream-content-detail-email-to\"}}\n\t\t);\n\t\tdetailWrapper.appendChild(communicationWrapper);\n\n\t\t//Communications\n\t\tif(communicationTitle !== \"\")\n\t\t{\n\t\t\tif(communicationShowUrl !== \"\")\n\t\t\t{\n\t\t\t\tcommunicationWrapper.appendChild(\n\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tattrs: { href: communicationShowUrl },\n\t\t\t\t\t\t\ttext: communicationTitle\n\t\t\t\t\t\t}\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tcommunicationWrapper.appendChild(BX.create(\"SPAN\", { text: communicationTitle }));\n\t\t\t}\n\t\t}\n\n\t\tif(communicationValue !== \"\")\n\t\t{\n\t\t\tif(communicationTitle !== \"\")\n\t\t\t{\n\t\t\t\tcommunicationWrapper.appendChild(BX.create(\"SPAN\", { text: \" \" }));\n\t\t\t}\n\t\t\tcommunicationWrapper.appendChild(\n\t\t\t\tBX.create(\n\t\t\t\t\t\"SPAN\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-email-address\" },\n\t\t\t\t\t\ttext: communicationValue\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\n\t\t//Content\n\t\tdetailWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-email-fragment\" },\n\t\t\t\t\tchildren: this.prepareCutOffElements(description, 128, this._headerClickHandler)\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\twrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\t//region  Actions\n\t\tthis._actionContainer = BX.create(\"SPAN\", { attrs: { className: \"crm-entity-stream-content-detail-action\" } });\n\t\twrapper.appendChild(this._actionContainer);\n\t\t//endregion\n\n\t\tif (!this.isReadOnly())\n\t\t\twrapper.appendChild(this.prepareFixedSwitcherLayout());\n\n\t\treturn outerWrapper;\n\t}\n\n\tprepareActions()\n\t{\n\t\tif(this.isReadOnly())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis._actions.push(\n\t\t\tHistoryEmail.create(\n\t\t\t\t\"email\",\n\t\t\t\t{\n\t\t\t\t\titem: this,\n\t\t\t\t\tcontainer: this._actionContainer,\n\t\t\t\t\tentityData: this.getAssociatedEntityData(),\n\t\t\t\t\tactivityEditor: this._activityEditor\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t}\n\n\tshowActions(show)\n\t{\n\t\tif(this._actionContainer)\n\t\t{\n\t\t\tthis._actionContainer.style.display = show ? \"\" : \"none\";\n\t\t}\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Email();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import Activity from \"./activity\";\n\n/** @memberof BX.Crm.Timeline.Actions */\nexport class Call extends Activity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._clickHandler = BX.delegate(this.onClick, this);\n\t\tthis._menu = null;\n\t\tthis._isMenuShown = false;\n\t\tthis._menuItems = null;\n\t}\n\n\tgetButton()\n\t{\n\t\treturn null;\n\t}\n\n\tonClick(e)\n\t{\n\t\tif(typeof(window.top['BXIM']) === 'undefined')\n\t\t{\n\t\t\twindow.alert(this.getMessage(\"telephonyNotSupported\"));\n\t\t\treturn;\n\t\t}\n\n\t\tlet phone = \"\";\n\t\tconst itemData = this.getItemData();\n\t\tconst phones = BX.prop.getArray(itemData, \"PHONE\", []);\n\n\t\tif(phones.length === 1)\n\t\t{\n\t\t\tthis.addCall(phones[0]['VALUE']);\n\t\t}\n\t\telse if(phones.length > 1)\n\t\t{\n\t\t\tthis.showMenu();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst communication = BX.prop.getObject(this._entityData, \"COMMUNICATION\", null);\n\t\t\tif(communication)\n\t\t\t{\n\t\t\t\tif(BX.prop.getString(communication, \"TYPE\") === \"PHONE\")\n\t\t\t\t{\n\t\t\t\t\tphone = BX.prop.getString(communication, \"VALUE\");\n\t\t\t\t\tif(phone)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.addCall(phone);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn BX.PreventDefault(e);\n\t}\n\n\tshowMenu()\n\t{\n\t\tif(this._isMenuShown)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.prepareMenuItems();\n\n\t\tif(!this._menuItems || this._menuItems.length === 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\n\t\tthis._menu = new BX.PopupMenuWindow(\n\t\t\tthis._id,\n\t\t\tthis._container,\n\t\t\tthis._menuItems,\n\t\t\t{\n\t\t\t\toffsetTop: 0,\n\t\t\t\toffsetLeft: 16,\n\t\t\t\tevents:\n\t\t\t\t\t{\n\t\t\t\t\t\tonPopupShow: BX.delegate(this.onMenuShow, this),\n\t\t\t\t\t\tonPopupClose: BX.delegate(this.onMenuClose, this),\n\t\t\t\t\t\tonPopupDestroy: BX.delegate(this.onMenuDestroy, this)\n\t\t\t\t\t}\n\t\t\t}\n\t\t);\n\n\t\tthis._menu.popupWindow.show();\n\t}\n\n\tcloseMenu()\n\t{\n\t\tif(!this._isMenuShown)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif(this._menu)\n\t\t{\n\t\t\tthis._menu.close();\n\t\t}\n\t}\n\n\tprepareMenuItems()\n\t{\n\t\tif(this._menuItems)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst itemData = this.getItemData();\n\t\tconst phones = BX.prop.getArray(itemData, \"PHONE\", []);\n\t\tconst handler = BX.delegate(this.onMenuItemClick, this);\n\t\tthis._menuItems = [];\n\n\t\tif(phones.length === 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet i = 0;\n\t\tconst l = phones.length;\n\t\tfor(; i < l; i++)\n\t\t{\n\t\t\tconst value = BX.prop.getString(phones[i], \"VALUE\");\n\t\t\tconst formattedValue = BX.prop.getString(phones[i], \"VALUE_FORMATTED\");\n\t\t\tconst complexName = BX.prop.getString(phones[i], \"COMPLEX_NAME\");\n\t\t\tconst itemText = (complexName ? complexName + ': ' : '') + (formattedValue ? formattedValue : value);\n\n\t\t\tif(value !== \"\")\n\t\t\t{\n\t\t\t\tthis._menuItems.push({ id: value, text:  itemText, onclick: handler});\n\t\t\t}\n\t\t}\n\t}\n\n\tonMenuItemClick(e, item)\n\t{\n\t\tthis.closeMenu();\n\t\tthis.addCall(item.id);\n\t}\n\n\tonMenuShow()\n\t{\n\t\tthis._isMenuShown = true;\n\t}\n\n\tonMenuClose()\n\t{\n\t\tthis._isMenuShown = false;\n\t\tthis._menu.popupWindow.destroy();\n\t}\n\n\tonMenuDestroy()\n\t{\n\t\tthis._menu = null;\n\t}\n\n\taddCall(phone)\n\t{\n\t\tconst communication = BX.prop.getObject(this._entityData, \"COMMUNICATION\", null);\n\t\tlet entityTypeId = parseInt(BX.prop.getString(communication, \"ENTITY_TYPE_ID\", \"0\"));\n\t\tif(isNaN(entityTypeId))\n\t\t{\n\t\t\tentityTypeId = 0;\n\t\t}\n\n\t\tlet entityId = parseInt(BX.prop.getString(communication, \"ENTITY_ID\", \"0\"));\n\t\tif(isNaN(entityId))\n\t\t{\n\t\t\tentityId = 0;\n\t\t}\n\n\t\tlet ownerTypeId = 0;\n\t\tlet ownerId = 0;\n\n\t\tconst ownerInfo = BX.prop.getObject(this._settings, \"ownerInfo\");\n\t\tif(ownerInfo)\n\t\t{\n\t\t\townerTypeId = BX.prop.getInteger(ownerInfo, \"ENTITY_TYPE_ID\", 0);\n\t\t\townerId = BX.prop.getInteger(ownerInfo, \"ENTITY_ID\", 0);\n\t\t}\n\n\t\tif(ownerTypeId <= 0 || ownerId <= 0)\n\t\t{\n\t\t\townerTypeId = BX.prop.getInteger(this._entityData, \"OWNER_TYPE_ID\", 0);\n\t\t\townerId = BX.prop.getInteger(this._entityData, \"OWNER_ID\", \"0\");\n\t\t}\n\n\t\tif(ownerTypeId <= 0 || ownerId <= 0)\n\t\t{\n\t\t\townerTypeId = entityTypeId;\n\t\t\townerId = entityId;\n\t\t}\n\n\t\tlet activityId = parseInt(BX.prop.getString(this._entityData, \"ID\", \"0\"));\n\t\tif(isNaN(activityId))\n\t\t{\n\t\t\tactivityId = 0;\n\t\t}\n\n\t\tconst params =\n\t\t\t{\n\t\t\t\t\"ENTITY_TYPE_NAME\": BX.CrmEntityType.resolveName(entityTypeId),\n\t\t\t\t\"ENTITY_ID\": entityId,\n\t\t\t\t\"AUTO_FOLD\": true\n\t\t\t};\n\t\tif(ownerTypeId !== entityTypeId || ownerId !== entityId)\n\t\t{\n\t\t\tparams[\"BINDINGS\"] = [ { \"OWNER_TYPE_NAME\": BX.CrmEntityType.resolveName(ownerTypeId), \"OWNER_ID\": ownerId } ];\n\t\t}\n\n\t\tif(activityId > 0)\n\t\t{\n\t\t\tparams[\"SRC_ACTIVITY_ID\"] = activityId;\n\t\t}\n\n\t\twindow.top['BXIM'].phoneTo(phone, params);\n\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = Call.messages;\n\t\treturn m.hasOwnProperty(name) ? m[name] : name;\n\t}\n\n\tstatic messages = {};\n}\n\n/** @memberof BX.Crm.Timeline.Actions */\nexport class HistoryCall extends Call\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._button = null;\n\t}\n\n\tgetButton()\n\t{\n\t\treturn this._button;\n\t}\n\n\tdoLayout()\n\t{\n\t\tthis._button = BX.create(\"A\",\n\t\t\t{\n\t\t\t\tattrs: { className: \"crm-entity-stream-content-action-reply-btn\" },\n\t\t\t\tevents: { \"click\": this._clickHandler }\n\t\t\t}\n\t\t);\n\t\tthis._container.appendChild(this._button);\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new HistoryCall();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n\nexport class ScheduleCall extends Call\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tdoLayout()\n\t{\n\t\tthis._container.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-action-reply-btn\" },\n\t\t\t\t\tevents: { \"click\": this._clickHandler }\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new ScheduleCall();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import {HistoryCall} from \"../actions/call\";\nimport HistoryActivity from \"./history-activity\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Call extends HistoryActivity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._playerDummyClickHandler = BX.delegate(this.onPlayerDummyClick, this);\n\t\tthis._playerWrapper = null;\n\t\tthis._transcriptWrapper = null;\n\t\tthis._mediaFileInfo = null;\n\t}\n\n\tgetTypeDescription()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst callInfo = BX.prop.getObject(entityData, \"CALL_INFO\", null);\n\t\tconst callTypeText = callInfo !== null ? BX.prop.getString(callInfo, \"CALL_TYPE_TEXT\", \"\") : \"\";\n\t\tif(callTypeText !== \"\")\n\t\t{\n\t\t\treturn callTypeText;\n\t\t}\n\n\t\tconst direction = BX.prop.getInteger(entityData, \"DIRECTION\", 0);\n\t\treturn this.getMessage(direction === BX.CrmActivityDirection.incoming ? \"incomingCall\" : \"outgoingCall\");\n\t}\n\n\tprepareHeaderLayout()\n\t{\n\t\tconst header = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-header\"}});\n\t\theader.appendChild(this.prepareTitleLayout());\n\n\t\t//Position is important\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst callInfo = BX.prop.getObject(entityData, \"CALL_INFO\", null);\n\t\tconst hasCallInfo = callInfo !== null;\n\t\tconst isSuccessfull = hasCallInfo ? BX.prop.getBoolean(callInfo, \"SUCCESSFUL\", false) : false;\n\t\tconst statusText = hasCallInfo ? BX.prop.getString(callInfo, \"STATUS_TEXT\", \"\") : \"\";\n\n\t\tif(hasCallInfo && statusText.length)\n\t\t{\n\t\t\theader.appendChild(\n\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs:\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tclassName: isSuccessfull\n\t\t\t\t\t\t\t\t\t? \"crm-entity-stream-content-event-successful\"\n\t\t\t\t\t\t\t\t\t: \"crm-entity-stream-content-event-missing\"\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\ttext: statusText\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\n\t\theader.appendChild(\n\t\t\tBX.create(\"SPAN\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-event-time\" },\n\t\t\t\t\ttext: this.formatTime(this.getCreatedTime())\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\treturn header;\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\n\t\tlet description = BX.prop.getString(entityData, \"DESCRIPTION_RAW\", \"\");\n\t\tif(description !== \"\")\n\t\t{\n\t\t\t//trim leading spaces\n\t\t\tdescription = description.replace(/^\\s+/,'');\n\t\t}\n\n\t\tconst communication = BX.prop.getObject(entityData, \"COMMUNICATION\", {});\n\t\tconst communicationTitle = BX.prop.getString(communication, \"TITLE\", \"\");\n\t\tconst communicationShowUrl = BX.prop.getString(communication, \"SHOW_URL\", \"\");\n\t\tconst communicationValue = BX.prop.getString(communication, \"VALUE\", \"\");\n\t\tconst communicationValueFormatted = BX.prop.getString(communication, \"FORMATTED_VALUE\", communicationValue);\n\n\t\tconst callInfo = BX.prop.getObject(entityData, \"CALL_INFO\", null);\n\t\tconst hasCallInfo = callInfo !== null;\n\t\tconst durationText = hasCallInfo ? BX.prop.getString(callInfo, \"DURATION_TEXT\", \"\") : \"\";\n\t\tconst hasTranscript = hasCallInfo ? BX.prop.getBoolean(callInfo, \"HAS_TRANSCRIPT\", \"\") : \"\";\n\t\tconst isTranscriptPending = hasCallInfo ? BX.prop.getBoolean(callInfo, \"TRANSCRIPT_PENDING\", \"\") : \"\";\n\t\tconst callId = hasCallInfo ? BX.prop.getString(callInfo, \"CALL_ID\", \"\") : \"\";\n\t\tconst callComment = hasCallInfo ? BX.prop.getString(callInfo, \"COMMENT\", \"\") : \"\";\n\n\t\tconst outerWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-section crm-entity-stream-section-history crm-entity-stream-section-call\"}});\n\t\touterWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-call\" }\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tif (this.isFixed())\n\t\t\tBX.addClass(outerWrapper, 'crm-entity-stream-section-top-fixed');\n\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\touterWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\tchildren: [ wrapper ]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\t//Header\n\t\tconst header = this.prepareHeaderLayout();\n\t\twrapper.appendChild(header);\n\n\t\t//region Context Menu\n\t\tif(this.isContextMenuEnabled())\n\t\t{\n\t\t\twrapper.appendChild(this.prepareContextMenuButton());\n\t\t}\n\t\t//endregion\n\n\t\t//Details\n\t\tconst detailWrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail\"}\n\t\t\t}\n\t\t);\n\t\twrapper.appendChild(detailWrapper);\n\n\t\tdetailWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-title\" },\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattrs: { href: \"#\" },\n\t\t\t\t\t\t\t\t\tevents: { \"click\": this._headerClickHandler },\n\t\t\t\t\t\t\t\t\ttext: this.getTitle()\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\t//Content\n\t\tdetailWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-description\" },\n\t\t\t\t\tchildren: this.prepareMultilineCutOffElements(description, 128, this._headerClickHandler)\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tif(hasCallInfo)\n\t\t{\n\t\t\tconst callInfoWrapper = BX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail-call crm-entity-stream-content-detail-call-inline\"}\n\t\t\t\t}\n\t\t\t);\n\t\t\tdetailWrapper.appendChild(callInfoWrapper);\n\n\t\t\tthis._mediaFileInfo = BX.prop.getObject(entityData, \"MEDIA_FILE_INFO\", null);\n\t\t\tif(this._mediaFileInfo !== null)\n\t\t\t{\n\t\t\t\tthis._playerWrapper = this._history.getManager().renderAudioDummy(durationText, this._playerDummyClickHandler);\n\t\t\t\tcallInfoWrapper.appendChild(\n\t\t\t\t\tthis._playerWrapper\n\t\t\t\t);\n\t\t\t\tcallInfoWrapper.appendChild(this._history.getManager().getAudioPlaybackRateSelector().render());\n\t\t\t}\n\n\t\t\tif(hasTranscript)\n\t\t\t{\n\t\t\t\tthis._transcriptWrapper = BX.create(\"DIV\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: \"crm-audio-transcript-wrap-container\"},\n\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\tclick: function(e)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tif(BX.Voximplant && BX.Voximplant.Transcript)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tBX.Voximplant.Transcript.create({\n\t\t\t\t\t\t\t\t\t\tcallId: callId\n\t\t\t\t\t\t\t\t\t}).show();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tchildren: [\n\t\t\t\t\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-audio-transcript-icon\"}\t}),\n\t\t\t\t\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-audio-transcript-conversation\"}, text: BX.message(\"CRM_TIMELINE_CALL_TRANSCRIPT\") } )\n\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t\tcallInfoWrapper.appendChild(this._transcriptWrapper);\n\t\t\t}\n\t\t\telse if(isTranscriptPending)\n\t\t\t{\n\t\t\t\tthis._transcriptWrapper = BX.create(\"DIV\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: \"crm-audio-transcript-wrap-container-pending\"},\n\t\t\t\t\t\tchildren: [\n\t\t\t\t\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-audio-transcript-icon-pending\"}, html: '<svg class=\"crm-transcript-loader-circular\" viewBox=\"25 25 50 50\"><circle class=\"crm-transcript-loader-path\" cx=\"50\" cy=\"50\" r=\"20\" fill=\"none\" stroke-miterlimit=\"10\"></circle></svg>'}),\n\t\t\t\t\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-audio-transcript-conversation\"}, text: BX.message(\"CRM_TIMELINE_CALL_TRANSCRIPT_PENDING\") } )\n\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t\tcallInfoWrapper.appendChild(this._transcriptWrapper);\n\t\t\t}\n\n\t\t\tif(callComment)\n\t\t\t{\n\t\t\t\tdetailWrapper.appendChild(BX.create(\"DIV\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-description\"},\n\t\t\t\t\t\ttext: callComment\n\t\t\t\t\t}\n\t\t\t\t));\n\t\t\t}\n\t\t}\n\t\tconst communicationWrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail-contact-info\"}\n\t\t\t}\n\t\t);\n\t\tdetailWrapper.appendChild(communicationWrapper);\n\n\t\t//Communications\n\t\tif(communicationTitle !== \"\")\n\t\t{\n\t\t\tif(communicationShowUrl !== \"\")\n\t\t\t{\n\t\t\t\tcommunicationWrapper.appendChild(\n\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tattrs: { href: communicationShowUrl },\n\t\t\t\t\t\t\ttext: communicationTitle\n\t\t\t\t\t\t}\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tcommunicationWrapper.appendChild(BX.create(\"SPAN\", { text: communicationTitle }));\n\t\t\t}\n\t\t}\n\n\t\tif(communicationValueFormatted !== \"\")\n\t\t{\n\t\t\tif(communicationTitle !== \"\")\n\t\t\t{\n\t\t\t\tcommunicationWrapper.appendChild(BX.create(\"SPAN\", { text: \" \" }));\n\t\t\t}\n\t\t\tcommunicationWrapper.appendChild(\n\t\t\t\tBX.create(\n\t\t\t\t\t\"SPAN\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-email-address\" },\n\t\t\t\t\t\ttext: communicationValueFormatted\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\twrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\t//region  Actions\n\t\tthis._actionContainer = BX.create(\"SPAN\", { attrs: { className: \"crm-entity-stream-content-detail-action\" } });\n\t\twrapper.appendChild(this._actionContainer);\n\t\t//endregion\n\n\t\tif (!this.isReadOnly()) {\n\n\t\t\twrapper.appendChild(this.prepareFixedSwitcherLayout());\n\t\t}\n\n\n\t\treturn outerWrapper;\n\t}\n\n\tprepareActions()\n\t{\n\t\tif(this.isReadOnly())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis._actions.push(\n\t\t\tHistoryCall.create(\n\t\t\t\t\"call\",\n\t\t\t\t{\n\t\t\t\t\titem: this,\n\t\t\t\t\tcontainer: this._actionContainer,\n\t\t\t\t\tentityData: this.getAssociatedEntityData(),\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\townerInfo: this._history.getOwnerInfo()\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t}\n\n\tgetRemoveMessage()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst direction = BX.prop.getInteger(entityData, \"DIRECTION\", 0);\n\t\tconst messageName = (direction === BX.CrmActivityDirection.incoming) ? 'incomingCallRemove' : 'outgoingCallRemove';\n\t\tconst title = BX.util.htmlspecialchars(this.getTitle());\n\t\treturn this.getMessage(messageName).replace(\"#TITLE#\", title);\n\t}\n\n\tonPlayerDummyClick(e)\n\t{\n\t\tconst stubNode = this._playerWrapper.querySelector(\".crm-audio-cap-wrap\");\n\t\tif(stubNode)\n\t\t{\n\t\t\tBX.addClass(stubNode, \"crm-audio-cap-wrap-loader\");\n\t\t}\n\n\t\tthis._history.getManager().getAudioPlaybackRateSelector().addPlayer(this._history.getManager().loadMediaPlayer(\n\t\t\t\"history_\" + this.getId(),\n\t\t\tthis._mediaFileInfo[\"URL\"],\n\t\t\tthis._mediaFileInfo[\"TYPE\"],\n\t\t\tthis._playerWrapper,\n\t\t\tthis._mediaFileInfo[\"DURATION\"],\n\t\t\t{\n\t\t\t\tplaybackRate: this._history.getManager().getAudioPlaybackRateSelector().getRate()\n\t\t\t}\n\t\t));\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Call();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import HistoryActivity from \"./history-activity\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Meeting extends HistoryActivity\n{\n\tconstructor()\n\t{\n\t\tsuper()\n\t}\n\n\tprepareHeaderLayout()\n\t{\n\t\tconst header = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-header\"}});\n\t\theader.appendChild(this.prepareTitleLayout());\n\n\t\tconst markNode = this.prepareMarkLayout();\n\t\tif(markNode)\n\t\t{\n\t\t\theader.appendChild(markNode);\n\t\t}\n\n\t\theader.appendChild(this.prepareTimeLayout());\n\n\t\treturn header;\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\n\t\tlet description = BX.prop.getString(entityData, \"DESCRIPTION_RAW\", \"\");\n\t\tif(description !== \"\")\n\t\t{\n\t\t\t//trim leading spaces\n\t\t\tdescription = description.replace(/^\\s+/,'');\n\t\t}\n\n\t\tconst communication = BX.prop.getObject(entityData, \"COMMUNICATION\", {});\n\t\tconst communicationTitle = BX.prop.getString(communication, \"TITLE\", \"\");\n\t\tconst communicationShowUrl = BX.prop.getString(communication, \"SHOW_URL\", \"\");\n\t\tconst communicationValue = BX.prop.getString(communication, \"VALUE\", \"\");\n\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-section crm-entity-stream-section-history crm-entity-stream-section-meeting\"}});\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-meeting\" } })\n\t\t);\n\n\t\tif(this.isContextMenuEnabled())\n\t\t{\n\t\t\twrapper.appendChild(this.prepareContextMenuButton());\n\t\t}\n\n\t\tif (this.isFixed())\n\t\t\tBX.addClass(wrapper, 'crm-entity-stream-section-top-fixed');\n\n\t\tconst contentWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\tchildren: [contentWrapper]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst header = this.prepareHeaderLayout();\n\t\tcontentWrapper.appendChild(header);\n\n\t\tconst detailWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-detail\"}});\n\t\tcontentWrapper.appendChild(detailWrapper);\n\n\t\tdetailWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-title\" },\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattrs: { href: \"#\" },\n\t\t\t\t\t\t\t\t\tevents: { \"click\": this._headerClickHandler },\n\t\t\t\t\t\t\t\t\ttext: this.getTitle()\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\t//Content\n\t\tdetailWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-description\" },\n\t\t\t\t\tchildren: this.prepareCutOffElements(description, 128, this._headerClickHandler)\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst communicationWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-detail-contact-info\"}});\n\t\tdetailWrapper.appendChild(communicationWrapper);\n\n\t\tif(communicationTitle !== '')\n\t\t{\n\t\t\tcommunicationWrapper.appendChild(\n\t\t\t\tBX.create(\"SPAN\",\n\t\t\t\t\t{ text: this.getMessage(\"reciprocal\") + \": \" }\n\t\t\t\t)\n\t\t\t);\n\n\t\t\tif(communicationShowUrl !== '')\n\t\t\t{\n\t\t\t\tcommunicationWrapper.appendChild(BX.create(\"A\", { attrs: { href: communicationShowUrl }, text: communicationTitle }));\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tcommunicationWrapper.appendChild(BX.create(\"SPAN\", { text: communicationTitle }));\n\t\t\t}\n\t\t}\n\n\t\tcommunicationWrapper.appendChild(BX.create(\"SPAN\", { text: \" \" + communicationValue }));\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontentWrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\t//region  Actions\n\t\tthis._actionContainer = BX.create(\"SPAN\", { attrs: { className: \"crm-entity-stream-content-detail-action\" } });\n\t\tcontentWrapper.appendChild(this._actionContainer);\n\t\t//endregion\n\n\t\tif (!this.isReadOnly())\n\t\t\tcontentWrapper.appendChild(this.prepareFixedSwitcherLayout());\n\n\t\treturn wrapper;\n\t}\n\n\tgetRemoveMessage()\n\t{\n\t\tconst title = BX.util.htmlspecialchars(this.getTitle());\n\t\treturn this.getMessage('meetingRemove').replace(\"#TITLE#\", title);\n\t}\n\n\tprepareActions()\n\t{\n\t}\n\n\tshowActions(show)\n\t{\n\t\tif(this._actionContainer)\n\t\t{\n\t\t\tthis._actionContainer.style.display = show ? \"\" : \"none\";\n\t\t}\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Meeting();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import HistoryActivity from \"./history-activity\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Task extends HistoryActivity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tprepareHeaderLayout()\n\t{\n\t\tconst header = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-header\"}});\n\t\theader.appendChild(this.prepareTitleLayout());\n\n\t\tconst markNode = this.prepareMarkLayout();\n\t\tif(markNode)\n\t\t{\n\t\t\theader.appendChild(markNode);\n\t\t}\n\n\t\theader.appendChild(this.prepareTimeLayout());\n\n\t\treturn header;\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\n\t\tlet description = BX.prop.getString(entityData, \"DESCRIPTION_RAW\", \"\");\n\t\tif(description !== \"\")\n\t\t{\n\t\t\t//trim leading spaces\n\t\t\tdescription = description.replace(/^\\s+/,'');\n\t\t}\n\n\t\tconst communication = BX.prop.getObject(entityData, \"COMMUNICATION\", {});\n\t\tconst communicationTitle = BX.prop.getString(communication, \"TITLE\", \"\");\n\t\tconst communicationShowUrl = BX.prop.getString(communication, \"SHOW_URL\", \"\");\n\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-section crm-entity-stream-section-history crm-entity-stream-section-task\"}});\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-task\" } })\n\t\t);\n\n\t\tif(this.isContextMenuEnabled())\n\t\t{\n\t\t\twrapper.appendChild(this.prepareContextMenuButton());\n\t\t}\n\n\t\tif (this.isFixed())\n\t\t\tBX.addClass(wrapper, 'crm-entity-stream-section-top-fixed');\n\n\t\tconst contentWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\tchildren: [contentWrapper]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst header = this.prepareHeaderLayout();\n\t\tcontentWrapper.appendChild(header);\n\n\t\tconst detailWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-detail\"}});\n\t\tcontentWrapper.appendChild(detailWrapper);\n\n\t\tdetailWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-title\" },\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattrs: { href: \"#\" },\n\t\t\t\t\t\t\t\t\tevents: { \"click\": this._headerClickHandler },\n\t\t\t\t\t\t\t\t\ttext: this.getTitle()\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\t//Content\n\t\tdetailWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-description\" },\n\t\t\t\t\tchildren: this.prepareCutOffElements(description, 128, this._headerClickHandler)\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst communicationWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-detail-contact-info\"}});\n\t\tdetailWrapper.appendChild(communicationWrapper);\n\n\t\tif(communicationTitle !== '')\n\t\t{\n\t\t\tcommunicationWrapper.appendChild(\n\t\t\t\tBX.create(\"SPAN\",\n\t\t\t\t\t{ text: this.getMessage(\"reciprocal\") + \": \" }\n\t\t\t\t)\n\t\t\t);\n\n\t\t\tif(communicationShowUrl !== '')\n\t\t\t{\n\t\t\t\tcommunicationWrapper.appendChild(BX.create(\"A\", { attrs: { href: communicationShowUrl }, text: communicationTitle }));\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tcommunicationWrapper.appendChild(BX.create(\"SPAN\", { text: communicationTitle }));\n\t\t\t}\n\t\t}\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontentWrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\t//region  Actions\n\t\tthis._actionContainer = BX.create(\"SPAN\", { attrs: { className: \"crm-entity-stream-content-detail-action\" } });\n\t\tcontentWrapper.appendChild(this._actionContainer);\n\t\t//endregion\n\n\t\tif (!this.isReadOnly())\n\t\t\tcontentWrapper.appendChild(this.prepareFixedSwitcherLayout());\n\n\t\treturn wrapper;\n\t}\n\n\tprepareActions()\n\t{\n\t}\n\n\tgetRemoveMessage()\n\t{\n\t\tconst title = BX.util.htmlspecialchars(this.getTitle());\n\t\treturn this.getMessage('taskRemove').replace(\"#TITLE#\", title);\n\t}\n\n\tshowActions(show)\n\t{\n\t\tif(this._actionContainer)\n\t\t{\n\t\t\tthis._actionContainer.style.display = show ? \"\" : \"none\";\n\t\t}\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Task();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import HistoryActivity from \"./history-activity\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class WebForm extends HistoryActivity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tprepareHeaderLayout()\n\t{\n\t\tconst header = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-header\"}});\n\t\theader.appendChild(this.prepareTitleLayout());\n\t\theader.appendChild(this.prepareTimeLayout());\n\n\t\treturn header;\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-section crm-entity-stream-section-history crm-entity-stream-section-crmForm\"}});\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-crmForm\" } })\n\t\t);\n\n\t\tconst contentWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\tchildren: [contentWrapper]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tif (this.isFixed())\n\t\t\tBX.addClass(wrapper, 'crm-entity-stream-section-top-fixed');\n\n\t\tconst header = this.prepareHeaderLayout();\n\t\tcontentWrapper.appendChild(header);\n\n\t\tconst detailWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-detail\"}});\n\t\tcontentWrapper.appendChild(detailWrapper);\n\n\t\tdetailWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-title\" },\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattrs: { href: \"#\" },\n\t\t\t\t\t\t\t\t\tevents: { \"click\": this._headerClickHandler },\n\t\t\t\t\t\t\t\t\ttext: this.getTitle()\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontentWrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\t//region  Actions\n\t\tthis._actionContainer = BX.create(\"SPAN\", { attrs: { className: \"crm-entity-stream-content-detail-action\" } });\n\t\tcontentWrapper.appendChild(this._actionContainer);\n\t\t//endregion\n\n\t\tif (!this.isReadOnly())\n\t\t\tcontentWrapper.appendChild(this.prepareFixedSwitcherLayout());\n\n\t\treturn wrapper;\n\t}\n\n\tprepareActions()\n\t{\n\t}\n\n\tshowActions(show)\n\t{\n\t\tif(this._actionContainer)\n\t\t{\n\t\t\tthis._actionContainer.style.display = show ? \"\" : \"none\";\n\t\t}\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new WebForm();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import HistoryActivity from \"./history-activity\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Request extends HistoryActivity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tprepareHeaderLayout()\n\t{\n\t\tconst header = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-header\"}});\n\t\theader.appendChild(this.prepareTitleLayout());\n\t\theader.appendChild(this.prepareTimeLayout());\n\n\t\treturn header;\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\n\t\tlet description = BX.prop.getString(entityData, \"DESCRIPTION_RAW\", \"\");\n\t\tif(description !== \"\")\n\t\t{\n\t\t\t//trim leading spaces\n\t\t\tdescription = description.replace(/^\\s+/,'');\n\t\t}\n\n\t\t//var entityData = this.getAssociatedEntityData();\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-section crm-entity-stream-section-today crm-entity-stream-section-robot\"}});\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-robot\" } })\n\t\t);\n\t\tif(this.isContextMenuEnabled())\n\t\t{\n\t\t\twrapper.appendChild(this.prepareContextMenuButton());\n\t\t}\n\n\t\tif (this.isFixed())\n\t\t\tBX.addClass(wrapper, 'crm-entity-stream-section-top-fixed');\n\n\t\tconst contentWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\tchildren: [contentWrapper]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst header = this.prepareHeaderLayout();\n\t\tcontentWrapper.appendChild(header);\n\n\t\tconst detailWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-detail\"}});\n\t\tcontentWrapper.appendChild(detailWrapper);\n\n\t\tdetailWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-title\" },\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattrs: { href: \"#\" },\n\t\t\t\t\t\t\t\t\tevents: { \"click\": this._headerClickHandler },\n\t\t\t\t\t\t\t\t\ttext: this.getTitle()\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\t//Content\n\t\tdetailWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-description\" },\n\t\t\t\t\tchildren: this.prepareCutOffElements(description, 128, this._headerClickHandler)\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontentWrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\t//region  Actions\n\t\tthis._actionContainer = BX.create(\"SPAN\", { attrs: { className: \"crm-entity-stream-content-detail-action\" } });\n\t\tcontentWrapper.appendChild(this._actionContainer);\n\t\t//endregion\n\n\t\tif (!this.isReadOnly())\n\t\t\tcontentWrapper.appendChild(this.prepareFixedSwitcherLayout());\n\n\t\treturn wrapper;\n\t}\n\n\tprepareActions()\n\t{\n\t}\n\n\tshowActions(show)\n\t{\n\t\tif(this._actionContainer)\n\t\t{\n\t\t\tthis._actionContainer.style.display = show ? \"\" : \"none\";\n\t\t}\n\t}\n\n\tisEditable()\n\t{\n\t\treturn false;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Request();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import HistoryActivity from \"./history-activity\";\nimport {OpenLine as OpenLineAction} from \"../actions/openline\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class OpenLine extends HistoryActivity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tprepareHeaderLayout()\n\t{\n\t\tconst header = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-header\"}});\n\t\theader.appendChild(this.prepareTitleLayout());\n\t\theader.appendChild(this.prepareTimeLayout());\n\n\t\treturn header;\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\n\t\tlet description = BX.prop.getString(entityData, \"DESCRIPTION_RAW\", \"\");\n\t\tif(description !== \"\")\n\t\t{\n\t\t\t//trim leading spaces\n\t\t\tdescription = description.replace(/^\\s+/,'');\n\t\t}\n\n\t\tconst communication = BX.prop.getObject(entityData, \"COMMUNICATION\", {});\n\t\tconst communicationTitle = BX.prop.getString(communication, \"TITLE\", \"\");\n\t\tconst communicationShowUrl = BX.prop.getString(communication, \"SHOW_URL\", \"\");\n\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-section crm-entity-stream-section-history crm-entity-stream-section-IM\"}});\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-IM\" } })\n\t\t);\n\n\t\tif(this.isContextMenuEnabled())\n\t\t{\n\t\t\twrapper.appendChild(this.prepareContextMenuButton());\n\t\t}\n\n\t\tif (this.isFixed())\n\t\t\tBX.addClass(wrapper, 'crm-entity-stream-section-top-fixed');\n\n\t\tconst contentWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\tchildren: [contentWrapper]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst header = this.prepareHeaderLayout();\n\t\tcontentWrapper.appendChild(header);\n\n\t\tconst detailWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-detail\"}});\n\t\tcontentWrapper.appendChild(detailWrapper);\n\n\t\tdetailWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-title\" },\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattrs: { href: \"#\" },\n\t\t\t\t\t\t\t\t\tevents: { \"click\": this._headerClickHandler },\n\t\t\t\t\t\t\t\t\ttext: this.getTitle()\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\t//Content\n\t\tconst entityDetailWrapper = BX.create(\"DIV\",\n\t\t\t{attrs: {className: \"crm-entity-stream-content-detail-IM\"}}\n\t\t);\n\t\tdetailWrapper.appendChild(entityDetailWrapper);\n\n\t\tconst messageWrapper = BX.create(\"DIV\",\n\t\t\t{attrs: {className: \"crm-entity-stream-content-detail-IM-messages\"}}\n\t\t);\n\t\tentityDetailWrapper.appendChild(messageWrapper);\n\n\t\tconst openLineData = BX.prop.getObject(this.getAssociatedEntityData(), \"OPENLINE_INFO\", null);\n\t\tif(openLineData)\n\t\t{\n\t\t\tconst messages = BX.prop.getArray(openLineData, \"MESSAGES\", []);\n\t\t\tlet i = 0;\n\t\t\tconst length = messages.length;\n\t\t\tfor(; i < length; i++)\n\t\t\t{\n\t\t\t\tconst message = messages[i];\n\t\t\t\tconst isExternal = BX.prop.getBoolean(message, \"IS_EXTERNAL\", true);\n\n\t\t\t\tmessageWrapper.appendChild(\n\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tattrs:\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tclassName: isExternal\n\t\t\t\t\t\t\t\t\t\t? \"crm-entity-stream-content-detail-IM-message-incoming\"\n\t\t\t\t\t\t\t\t\t\t: \"crm-entity-stream-content-detail-IM-message-outgoing\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\thtml: BX.prop.getString(message, \"MESSAGE\", \"\")\n\t\t\t\t\t\t}\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\n\t\tconst communicationWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-detail-contact-info\"}});\n\t\tdetailWrapper.appendChild(communicationWrapper);\n\n\t\tif(communicationTitle !== '')\n\t\t{\n\t\t\tcommunicationWrapper.appendChild(\n\t\t\t\tBX.create(\"SPAN\",\n\t\t\t\t\t{ text: this.getMessage(\"reciprocal\") + \": \" }\n\t\t\t\t)\n\t\t\t);\n\n\t\t\tif(communicationShowUrl !== '')\n\t\t\t{\n\t\t\t\tcommunicationWrapper.appendChild(BX.create(\"A\", { attrs: { href: communicationShowUrl }, text: communicationTitle }));\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tcommunicationWrapper.appendChild(BX.create(\"SPAN\", { text: communicationTitle }));\n\t\t\t}\n\t\t}\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontentWrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\t//region  Actions\n\t\tthis._actionContainer = BX.create(\"SPAN\", { attrs: { className: \"crm-entity-stream-content-detail-action\" } });\n\t\tcontentWrapper.appendChild(this._actionContainer);\n\t\t//endregion\n\n\t\tif (!this.isReadOnly())\n\t\t\tcontentWrapper.appendChild(this.prepareFixedSwitcherLayout());\n\n\t\treturn wrapper;\n\t}\n\n\tprepareActions()\n\t{\n\t\tif(this.isReadOnly())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis._actions.push(\n\t\t\tOpenLineAction.create(\n\t\t\t\t\"openline\",\n\t\t\t\t{\n\t\t\t\t\titem: this,\n\t\t\t\t\tcontainer: this._actionContainer,\n\t\t\t\t\tentityData: this.getAssociatedEntityData(),\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\townerInfo: this._history.getOwnerInfo()\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t}\n\n\tview()\n\t{\n\t\tif(typeof(window.top['BXIM']) === 'undefined')\n\t\t{\n\t\t\twindow.alert(this.getMessage(\"openLineNotSupported\"));\n\t\t\treturn;\n\t\t}\n\n\t\tlet slug = \"\";\n\t\tconst communication = BX.prop.getObject(this.getAssociatedEntityData(), \"COMMUNICATION\", null);\n\t\tif(communication)\n\t\t{\n\t\t\tif(BX.prop.getString(communication, \"TYPE\") === \"IM\")\n\t\t\t{\n\t\t\t\tslug = BX.prop.getString(communication, \"VALUE\");\n\t\t\t}\n\t\t}\n\n\t\tif(slug !== \"\")\n\t\t{\n\t\t\twindow.top['BXIM'].openMessengerSlider(slug, {RECENT: 'N', MENU: 'N'});\n\t\t}\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new OpenLine();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import HistoryActivity from \"./history-activity\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Rest extends HistoryActivity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tprepareHeaderLayout()\n\t{\n\t\tconst header = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-header\"}});\n\t\theader.appendChild(this.prepareTitleLayout());\n\t\theader.appendChild(this.prepareTimeLayout());\n\n\t\treturn header;\n\t}\n\n\tgetTypeDescription()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tif (entityData['APP_TYPE'] && entityData['APP_TYPE']['NAME'])\n\t\t{\n\t\t\treturn entityData['APP_TYPE']['NAME'];\n\t\t}\n\n\t\treturn super.getTypeDescription();\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\n\t\tlet description = BX.prop.getString(entityData, \"DESCRIPTION_RAW\", \"\");\n\t\tif(description !== \"\")\n\t\t{\n\t\t\t//trim leading spaces\n\t\t\tdescription = description.replace(/^\\s+/,'');\n\t\t}\n\n\t\t//var entityData = this.getAssociatedEntityData();\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-section crm-entity-stream-section-today crm-entity-stream-section-rest\"}});\n\n\t\tconst iconNode = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-rest\"}});\n\n\t\twrapper.appendChild(iconNode);\n\n\t\tif (entityData['APP_TYPE'] && entityData['APP_TYPE']['ICON_SRC'])\n\t\t{\n\t\t\tif (iconNode)\n\t\t\t{\n\t\t\t\ticonNode.style.backgroundImage = \"url('\" +  entityData['APP_TYPE']['ICON_SRC'] + \"')\";\n\t\t\t\ticonNode.style.backgroundPosition = \"center center\";\n\t\t\t\ticonNode.style.backgroundSize = \"cover\";\n\t\t\t\ticonNode.style.backgroundColor = \"transparent\";\n\t\t\t}\n\t\t}\n\n\t\tif (this.isFixed())\n\t\t\tBX.addClass(wrapper, 'crm-entity-stream-section-top-fixed');\n\n\t\tconst contentWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\tchildren: [contentWrapper]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst header = this.prepareHeaderLayout();\n\t\tcontentWrapper.appendChild(header);\n\n\t\tconst detailWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-detail\"}});\n\t\tcontentWrapper.appendChild(detailWrapper);\n\n\t\tdetailWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-title\" },\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattrs: { href: \"#\" },\n\t\t\t\t\t\t\t\t\tevents: { \"click\": this._headerClickHandler },\n\t\t\t\t\t\t\t\t\ttext: this.getTitle()\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\t//Content\n\t\tdetailWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-description\" },\n\t\t\t\t\tchildren: this.prepareCutOffElements(description, 128, this._headerClickHandler)\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontentWrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\t//region  Actions\n\t\tthis._actionContainer = BX.create(\"SPAN\", { attrs: { className: \"crm-entity-stream-content-detail-action\" } });\n\t\tcontentWrapper.appendChild(this._actionContainer);\n\t\t//endregion\n\n\t\tif (!this.isReadOnly())\n\t\t\tcontentWrapper.appendChild(this.prepareFixedSwitcherLayout());\n\n\t\treturn wrapper;\n\t}\n\n\tprepareActions()\n\t{\n\t}\n\n\tshowActions(show)\n\t{\n\t\tif(this._actionContainer)\n\t\t{\n\t\t\tthis._actionContainer.style.display = show ? \"\" : \"none\";\n\t\t}\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Rest();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import HistoryActivity from \"./history-activity\";\n\n/** @memberof BX.Crm.Timeline.Actions */\nexport default class Visit extends HistoryActivity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._playerDummyClickHandler = BX.delegate(this.onPlayerDummyClick, this);\n\t\tthis._playerWrapper = null;\n\t\tthis._transcriptWrapper = null;\n\t\tthis._mediaFileInfo = null;\n\t}\n\n\tprepareHeaderLayout()\n\t{\n\t\tconst header = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-header\"}});\n\t\theader.appendChild(this.prepareTitleLayout());\n\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst visitInfo = BX.prop.getObject(entityData, \"VISIT_INFO\", {});\n\t\tconst recordLength = BX.prop.getInteger(visitInfo, \"RECORD_LENGTH\", 0);\n\t\tconst recordLengthFormatted = BX.prop.getString(visitInfo, \"RECORD_LENGTH_FORMATTED_FULL\", \"\");\n\n\t\theader.appendChild(\n\t\t\tBX.create(\"SPAN\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-event-time\" },\n\t\t\t\t\ttext: (recordLength > 0 ? recordLengthFormatted + ', ' + BX.message('CRM_TIMELINE_VISIT_AT') + ' ' : '') + this.formatTime(this.getCreatedTime())\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\treturn header;\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\n\t\tconst communication = BX.prop.getObject(entityData, \"COMMUNICATION\", {});\n\t\tconst communicationTitle = BX.prop.getString(communication, \"TITLE\", \"\");\n\t\tconst communicationShowUrl = BX.prop.getString(communication, \"SHOW_URL\", \"\");\n\n\t\tconst visitInfo = BX.prop.getObject(entityData, \"VISIT_INFO\", {});\n\t\tconst recordLength = BX.prop.getInteger(visitInfo, \"RECORD_LENGTH\", 0);\n\t\tconst recordLengthFormatted = BX.prop.getString(visitInfo, \"RECORD_LENGTH_FORMATTED_SHORT\", \"\");\n\t\tconst vkProfile = BX.prop.getString(visitInfo, \"VK_PROFILE\", \"\");\n\n\t\tconst outerWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-section crm-entity-stream-section-history crm-entity-stream-section-visit\"}});\n\t\touterWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-visit\" }\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\touterWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\tchildren: [ wrapper ]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\t//Header\n\t\tconst header = this.prepareHeaderLayout();\n\t\twrapper.appendChild(header);\n\n\t\t//region Context Menu\n\t\tif(this.isContextMenuEnabled())\n\t\t{\n\t\t\twrapper.appendChild(this.prepareContextMenuButton());\n\t\t}\n\t\t//endregion\n\n\t\t//Details\n\t\tconst detailWrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail crm-entity-stream-content-detail-call-inline\"}\n\t\t\t}\n\t\t);\n\t\twrapper.appendChild(detailWrapper);\n\n\t\tthis._mediaFileInfo = BX.prop.getObject(entityData, \"MEDIA_FILE_INFO\", null);\n\t\tif(this._mediaFileInfo !== null && recordLength > 0)\n\t\t{\n\t\t\tthis._playerWrapper = this._history.getManager().renderAudioDummy(recordLengthFormatted, this._playerDummyClickHandler);\n\t\t\tdetailWrapper.appendChild(\n\t\t\t\t//crm-entity-stream-content-detail-call\n\t\t\t\tthis._playerWrapper\n\t\t\t);\n\t\t\tdetailWrapper.appendChild(this._history.getManager().getAudioPlaybackRateSelector().render());\n\t\t}\n\n\t\tconst communicationWrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail-contact-info\"}\n\t\t\t}\n\t\t);\n\t\twrapper.appendChild(communicationWrapper);\n\n\t\t//Communications\n\t\tif(communicationTitle !== \"\")\n\t\t{\n\t\t\tcommunicationWrapper.appendChild(document.createTextNode(BX.message(\"CRM_TIMELINE_VISIT_WITH\") + ' '));\n\t\t\tif(communicationShowUrl !== \"\")\n\t\t\t{\n\t\t\t\tcommunicationWrapper.appendChild(\n\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tattrs: { href: communicationShowUrl },\n\t\t\t\t\t\t\ttext: communicationTitle\n\t\t\t\t\t\t}\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tcommunicationWrapper.appendChild(BX.create(\"SPAN\", { text: communicationTitle }));\n\t\t\t}\n\t\t}\n\n\t\tif(BX.type.isNotEmptyString(vkProfile))\n\t\t{\n\t\t\tcommunicationWrapper.appendChild(document.createTextNode(\" \"));\n\t\t\tcommunicationWrapper.appendChild(\n\t\t\t\tBX.create(\n\t\t\t\t\t\"a\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs:\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tclassName: \"crm-entity-stream-content-detail-additional\",\n\t\t\t\t\t\t\t\ttarget: \"_blank\",\n\t\t\t\t\t\t\t\thref: this.getVkProfileUrl(vkProfile)\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\ttext: BX.message('CRM_TIMELINE_VISIT_VKONTAKTE_PROFILE')\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t)\n\n\t\t}\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\twrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\treturn outerWrapper;\n\t}\n\n\tonPlayerDummyClick(e)\n\t{\n\t\tconst stubNode = this._playerWrapper.querySelector(\".crm-audio-cap-wrap\");\n\t\tif(stubNode)\n\t\t{\n\t\t\tBX.addClass(stubNode, \"crm-audio-cap-wrap-loader\");\n\t\t}\n\n\t\tthis._history.getManager().getAudioPlaybackRateSelector().addPlayer(this._history.getManager().loadMediaPlayer(\n\t\t\t\"history_\" + this.getId(),\n\t\t\tthis._mediaFileInfo[\"URL\"],\n\t\t\tthis._mediaFileInfo[\"TYPE\"],\n\t\t\tthis._playerWrapper,\n\t\t\tthis._mediaFileInfo[\"DURATION\"],\n\t\t\t{\n\t\t\t\tplaybackRate: this._history.getManager().getAudioPlaybackRateSelector().getRate()\n\t\t\t}\n\t\t));\n\t}\n\n\tgetVkProfileUrl(profile)\n\t{\n\t\treturn 'https://vk.com/' + BX.util.htmlspecialchars(profile);\n\t}\n\n\tview()\n\t{\n\t\tif (BX.getClass('BX.Crm.Restriction.Bitrix24') && BX.Crm.Restriction.Bitrix24.isRestricted('visit'))\n\t\t{\n\t\t\treturn BX.Crm.Restriction.Bitrix24.getHandler('visit').call();\n\t\t}\n\t\tsuper.view();\n\t}\n\n\tedit()\n\t{\n\t\tif (BX.getClass('BX.Crm.Restriction.Bitrix24') && BX.Crm.Restriction.Bitrix24.isRestricted('visit'))\n\t\t{\n\t\t\treturn BX.Crm.Restriction.Bitrix24.getHandler('visit').call();\n\t\t}\n\t\tsuper.edit();\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Visit();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import HistoryActivity from \"./history-activity\";\n\n/** @memberof BX.Crm.Timeline.Actions */\nexport default class Zoom extends HistoryActivity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis._videoDummy = null;\n\t\tthis._audioDummy = null;\n\t\tthis._videoPlayer = null;\n\t\tthis._audioPlayer = null;\n\t\tthis._audioLengthElement = null;\n\t\tthis._recordings = [];\n\t\tthis._currentRecordingIndex = 0;\n\t\tthis.zoomActivitySubject = null;\n\n\t\tthis._downloadWrapper = null;\n\t\tthis._downloadSubject = null;\n\t\tthis._downloadSubjectDetail = null;\n\t\tthis._downloadVideoLink = null;\n\t\tthis._downloadSeparator = null;\n\t\tthis._downloadAudioLink = null;\n\t\tthis._playVideoLink = null;\n\t\tthis.detailZoomCopyVideoLink = null;\n\t}\n\n\tprepareHeaderLayout()\n\t{\n\t\tconst header = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-header\"}});\n\t\theader.appendChild(this.prepareTitleLayout());\n\t\tif (!this._data.hasOwnProperty('PROVIDER_DATA') || this._data[\"PROVIDER_DATA\"][\"ZOOM_EVENT_TYPE\"] !== 'ZOOM_CONF_JOINED')\n\t\t{\n\t\t\theader.appendChild(this.prepareSuccessfulLayout());\n\t\t}\n\t\theader.appendChild(this.prepareTimeLayout());\n\n\t\treturn header;\n\t}\n\n\tprepareSuccessfulLayout()\n\t{\n\t\treturn BX.create(\"SPAN\", {\n\t\t\tattrs:{ className: \"crm-entity-stream-content-event-successful\"},\n\t\t\ttext: BX.message('CRM_TIMELINE_ZOOM_SUCCESSFUL_ACTIVITY')\n\t\t});\n\t}\n\n\tprepareTitleLayout()\n\t{\n\t\tif (this._data.hasOwnProperty('PROVIDER_DATA') && this._data[\"PROVIDER_DATA\"][\"ZOOM_EVENT_TYPE\"] === 'ZOOM_CONF_JOINED')\n\t\t{\n\t\t\treturn BX.create(\"SPAN\", {\n\t\t\t\tattrs:{ className: \"crm-entity-stream-content-event-title\"},\n\t\t\t\ttext: BX.message('CRM_TIMELINE_ZOOM_JOINED_CONFERENCE')\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn BX.create(\"SPAN\", {\n\t\t\t\tattrs:{ className: \"crm-entity-stream-content-event-title\"},\n\t\t\t\ttext: BX.message('CRM_TIMELINE_ZOOM_CONFERENCE_END')\n\t\t\t});\n\t\t}\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-section crm-entity-stream-section-history\"}});\n\t\tlet entityDetailWrapper;\n\t\tconst zoomData = BX.prop.getObject(this.getAssociatedEntityData(), \"ZOOM_INFO\", null);\n\t\tconst subject = BX.prop.getString(this.getAssociatedEntityData(), \"SUBJECT\", null);\n\n\t\tthis._recordings = BX.prop.getArray(zoomData, \"RECORDINGS\", []);\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-zoom\" } })\n\t\t);\n\n\t\tif (this.isFixed())\n\t\t\tBX.addClass(wrapper, 'crm-entity-stream-section-top-fixed');\n\n\t\tconst contentWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\tchildren: [contentWrapper]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst header = this.prepareHeaderLayout();\n\t\tcontentWrapper.appendChild(header);\n\n\t\tconst detailWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-detail\"}});\n\t\tcontentWrapper.appendChild(detailWrapper);\n\n\t\tif (this._data.hasOwnProperty('PROVIDER_DATA') && this._data[\"PROVIDER_DATA\"][\"ZOOM_EVENT_TYPE\"] === 'ZOOM_CONF_JOINED')\n\t\t{\n\t\t\tentityDetailWrapper = BX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-description\" },\n\t\t\t\t\ttext: zoomData['CONF_URL']\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tentityDetailWrapper = BX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-description\" },\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tif (this._recordings.length > 0)\n\t\t\t{\n\t\t\t\tif (this._recordings.length > 1)\n\t\t\t\t{\n\t\t\t\t\t//render video parts header\n\n\t\t\t\t\tconst tabs = this._recordings.map(function (recording, index) {\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tid: index,\n\t\t\t\t\t\t\ttitle: BX.message(\"CRM_TIMELINE_ZOOM_MEETING_RECORD_PART\").replace(\"#NUMBER#\", index + 1),\n\t\t\t\t\t\t\ttime: recording[\"AUDIO\"] ? recording[\"AUDIO\"][\"LENGTH_FORMATTED\"] : \"\",\n\t\t\t\t\t\t\tactive: index === 0\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tconst tabsComponent = new Zoom.TabsComponent({\n\t\t\t\t\t\ttabs: tabs,\n\t\t\t\t\t});\n\t\t\t\t\ttabsComponent.eventEmitter.subscribe(\"onTabChange\", this._onTabChange.bind(this));\n\t\t\t\t\tdetailWrapper.appendChild(tabsComponent.render());\n\t\t\t\t}\n\n\t\t\t\tthis._videoDummy = BX.create(\"DIV\",\n\t\t\t\t\t{\n\t\t\t\t\t\tprops: { className: \"crm-entity-stream-content-detail-zoom-video-wrap\"},\n\t\t\t\t\t\tchildren: [\n\t\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tprops: { className: \"crm-entity-stream-content-detail-zoom-video\" },\n\t\t\t\t\t\t\t\t\tevents:\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\tclick: this._onVideoDummyClick.bind(this)\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tchildren: [\n\t\t\t\t\t\t\t\t\t\tBX.create(\"DIV\", {\n\t\t\t\t\t\t\t\t\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-video-inner\"},\n\t\t\t\t\t\t\t\t\t\t\tchildren: [\n\t\t\t\t\t\t\t\t\t\t\t\tBX.create(\"DIV\", {\n\t\t\t\t\t\t\t\t\t\t\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-video-btn\"},\n\t\t\t\t\t\t\t\t\t\t\t\t\tdataset: {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\thint: BX.message(\"CRM_TIMELINE_ZOOM_LOGIN_REQUIRED\"),\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t'hintNoIcon': 'Y'\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\t\t\t\t\tBX.create(\"SPAN\", {\n\t\t\t\t\t\t\t\t\t\t\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-video-text\"},\n\t\t\t\t\t\t\t\t\t\t\t\t\ttext: BX.message(\"CRM_TIMELINE_ZOOM_CLICK_TO_WATCH\")\n\t\t\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t]\n\t\t\t\t\t});\n\n\t\t\t\tBX.UI.Hint.init(this._videoDummy);\n\n\t\t\t\tthis._audioDummy = this._history.getManager().renderAudioDummy(\"00:15\", this._onAudioDummyClick.bind(this));\n\t\t\t\tthis._audioLengthElement = this._audioDummy.querySelector('.crm-audio-cap-time');\n\n\t\t\t\tif (zoomData['RECORDINGS'][0]['VIDEO'])\n\t\t\t\t{\n\t\t\t\t\t//video download link with token valid for 24h\n\t\t\t\t\tconst videoLinkExpireTS = (zoomData['RECORDINGS'][0]['VIDEO']['END_DATE_TS'] * 1000) + (60 * 60 * 23 * 1000);\n\t\t\t\t\tif (videoLinkExpireTS < Date.now())\n\t\t\t\t\t{\n\t\t\t\t\t\tconst videoLinkContainer = BX.create(\"DIV\", {\n\t\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\t\tclassName: \"crm-entity-stream-content-detail-zoom-desc\",\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tthis._playVideoLink = BX.create(\"DIV\", {\n\t\t\t\t\t\t\thtml: BX.message(\"CRM_TIMELINE_ZOOM_PLAY_LINK_VIDEO\"),\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tthis._detailZoomCopyVideoLink = BX.create(\"A\",\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\t\t\tclassName: 'ui-link ui-link-dashed',\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\ttext: BX.message(\"CRM_TIMELINE_ZOOM_COPY_PASSWORD\")\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\tvideoLinkContainer.appendChild(this._playVideoLink);\n\t\t\t\t\t\tvideoLinkContainer.appendChild(this._detailZoomCopyVideoLink);\n\t\t\t\t\t\tentityDetailWrapper.appendChild(videoLinkContainer);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tentityDetailWrapper.appendChild(this._videoDummy);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (zoomData['RECORDINGS'][0]['AUDIO'])\n\t\t\t\t{\n\t\t\t\t\tconst zoomAudioDetailWrapper = BX.create(\"DIV\",\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail-call crm-entity-stream-content-detail-call-inline\"},\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\n\t\t\t\t\tzoomAudioDetailWrapper.appendChild(this._audioDummy);\n\t\t\t\t\tzoomAudioDetailWrapper.appendChild(this._history.getManager().getAudioPlaybackRateSelector().render());\n\t\t\t\t\tentityDetailWrapper.appendChild(zoomAudioDetailWrapper);\n\t\t\t\t}\n\n\t\t\t\tthis._downloadWrapper = BX.create(\"DIV\", {\n\t\t\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-desc\"},\n\t\t\t\t});\n\n\t\t\t\tentityDetailWrapper.appendChild(this._downloadWrapper);\n\n\t\t\t\tthis._downloadSubject = BX.create(\"SPAN\", {\n\t\t\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-desc-subject\"},\n\t\t\t\t});\n\t\t\t\tthis._downloadSubjectDetail = BX.create(\"SPAN\", {\n\t\t\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-desc-detail\"},\n\t\t\t\t});\n\t\t\t\tthis._downloadVideoLink = BX.create(\"A\", {\n\t\t\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-desc-link\"},\n\t\t\t\t\ttext: BX.message(\"CRM_TIMELINE_ZOOM_DOWNLOAD_VIDEO\")\n\t\t\t\t});\n\t\t\t\tthis._downloadSeparator = BX.create(\"SPAN\", {\n\t\t\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-desc-separate\"},\n\t\t\t\t\thtml: \"&mdash;\"\n\t\t\t\t});\n\t\t\t\tthis._downloadAudioLink = BX.create(\"A\", {\n\t\t\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-desc-link\"},\n\t\t\t\t\ttext: BX.message(\"CRM_TIMELINE_ZOOM_DOWNLOAD_AUDIO\")\n\t\t\t\t});\n\t\t\t\tthis.setCurrentRecording(0);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.zoomActivitySubject = BX.create(\"DIV\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-title\" },\n\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tattrs: { href: \"#\" },\n\t\t\t\t\t\t\t\t\t\tevents: { \"click\": this._headerClickHandler },\n\t\t\t\t\t\t\t\t\t\ttext: subject\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t);\n\n\t\t\t\tentityDetailWrapper.appendChild(this.zoomActivitySubject);\n\n\t\t\t\tif (zoomData['HAS_RECORDING'] === 'Y')\n\t\t\t\t{\n\t\t\t\t\tentityDetailWrapper.appendChild(BX.create(\"DIV\", {\n\t\t\t\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-video\"},\n\t\t\t\t\t\tchildren: [\n\t\t\t\t\t\t\tBX.create(\"DIV\", {\n\t\t\t\t\t\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-video-inner\"},\n\t\t\t\t\t\t\t\tchildren: [\n\t\t\t\t\t\t\t\t\tBX.create(\"DIV\", {\n\t\t\t\t\t\t\t\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-video-img\"},\n\t\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\t\tBX.create(\"SPAN\", {\n\t\t\t\t\t\t\t\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-video-text\"},\n\t\t\t\t\t\t\t\t\t\ttext: BX.message(\"CRM_TIMELINE_ZOOM_MEETING_RECORD_IN_PROCESS\")\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t]\n\t\t\t\t\t}));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t/*else\n\t\t{\n\t\t\tdetailWrapper.appendChild(BX.create(\"span\", {text: \"456\"}));\n\n\t\t\tvar entityDetailWrapper = BX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-description\" },\n\t\t\t\t\ttext: BX.prop.getString(zoomData, \"CONF_URL\", \"\")\n\t\t\t\t}\n\t\t\t);\n\t\t}*/\n\t\t//Content //todo\n\n\n\t\tif(entityDetailWrapper)\n\t\t{\n\t\t\tdetailWrapper.appendChild(entityDetailWrapper);\n\t\t}\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontentWrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\treturn wrapper;\n\t}\n\n\t_onVideoDummyClick()\n\t{\n\t\tBX.UI.Hint.hide();\n\t\tconst recording = this._recordings[this._currentRecordingIndex][\"VIDEO\"];\n\t\tif(!recording)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tthis._videoPlayer = this._history.getManager().loadMediaPlayer(\n\t\t\t\"zoom_video_\" + this.getId(),\n\t\t\trecording[\"DOWNLOAD_URL\"],\n\t\t\t\"video/mp4\",\n\t\t\tthis._videoDummy,\n\t\t\trecording[\"LENGTH\"],\n\t\t\t{\n\t\t\t\tvideo: true,\n\t\t\t\tskin: \"\",\n\t\t\t\twidth: 480,\n\t\t\t\theight: 270\n\t\t\t}\n\t\t);\n\t}\n\n\t_onAudioDummyClick()\n\t{\n\t\tconst recording = this._recordings[this._currentRecordingIndex][\"AUDIO\"];\n\t\tif(!recording)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tthis._history.getManager().getAudioPlaybackRateSelector().addPlayer(this._audioPlayer = this._history.getManager().loadMediaPlayer(\n\t\t\t\"zoom_audio_\" + this.getId(),\n\t\t\trecording[\"DOWNLOAD_URL\"],\n\t\t\t\"audio/mp4\",\n\t\t\tthis._audioDummy,\n\t\t\trecording[\"LENGTH\"],\n\t\t\t{\n\t\t\t\tplaybackRate: this._history.getManager().getAudioPlaybackRateSelector().getRate()\n\t\t\t}\n\t\t));\n\t}\n\n\t_onTabChange(event)\n\t{\n\t\tthis.setCurrentRecording(event.data.tabId);\n\t}\n\n\tsetCurrentRecording(recordingIndex)\n\t{\n\t\tthis._currentRecordingIndex = recordingIndex;\n\t\tconst videoRecording = this._recordings[this._currentRecordingIndex][\"VIDEO\"];\n\t\tconst audioRecording = this._recordings[this._currentRecordingIndex][\"AUDIO\"];\n\n\t\tif(videoRecording)\n\t\t{\n\t\t\tthis._videoDummy.hidden = false;\n\t\t\tif(this._videoPlayer)\n\t\t\t{\n\t\t\t\tthis._videoPlayer.pause();\n\t\t\t\tthis._videoPlayer.setSource(videoRecording[\"DOWNLOAD_URL\"]);\n\t\t\t\tthis._downloadVideoLink.href = videoRecording[\"DOWNLOAD_URL\"];\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis._videoDummy.hidden = true;\n\t\t}\n\n\t\tif(audioRecording)\n\t\t{\n\t\t\tthis._audioDummy.hidden = false;\n\t\t\tif(this._audioPlayer)\n\t\t\t{\n\t\t\t\tthis._audioPlayer.pause();\n\t\t\t\tthis._audioPlayer.setSource(audioRecording[\"DOWNLOAD_URL\"]);\n\t\t\t}\n\t\t\tthis._downloadAudioLink.href = audioRecording[\"DOWNLOAD_URL\"];\n\t\t\tthis._audioLengthElement.innerText = audioRecording[\"LENGTH_FORMATTED\"];\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis._audioDummy.hidden = true;\n\t\t}\n\n\t\tBX.clean(this._downloadWrapper);\n\t\tif(audioRecording || videoRecording)\n\t\t{\n\t\t\tconst lengthHuman = audioRecording ? audioRecording[\"LENGTH_HUMAN\"] : videoRecording[\"LENGTH_HUMAN\"];\n\t\t\tthis._downloadWrapper.appendChild(this._downloadSubject);\n\t\t\tthis._downloadSubject.innerHTML = BX.util.htmlspecialchars(BX.message(\"CRM_TIMELINE_ZOOM_MEETING_RECORD\").replace(\"#DURATION#\", lengthHuman)) + \" &mdash; \"\n\t\t\tthis._downloadWrapper.appendChild(this._downloadSubjectDetail);\n\t\t}\n\t\tif (videoRecording)\n\t\t{\n\t\t\tthis._downloadSubjectDetail.appendChild(this._downloadVideoLink);\n\t\t\tthis._downloadVideoLink.href = videoRecording['DOWNLOAD_URL'];\n\t\t\tif (audioRecording)\n\t\t\t{\n\t\t\t\tthis._downloadSubjectDetail.appendChild(this._downloadSeparator);\n\t\t\t}\n\n\t\t\tif (this._playVideoLink)\n\t\t\t{\n\t\t\t\tthis._playVideoLink.lastElementChild.href = videoRecording[\"PLAY_URL\"];\n\t\t\t\tthis._downloadVideoLink.href = videoRecording[\"PLAY_URL\"];\n\t\t\t}\n\t\t\tif (this._detailZoomCopyVideoLink)\n\t\t\t{\n\t\t\t\tBX.clipboard.bindCopyClick(this._detailZoomCopyVideoLink, {\n\t\t\t\t\ttext: videoRecording['PASSWORD'],\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\tif (audioRecording)\n\t\t{\n\t\t\tthis._downloadSubjectDetail.appendChild(this._downloadAudioLink);\n\t\t\tthis._downloadAudioLink.href = audioRecording['DOWNLOAD_URL'];\n\t\t}\n\t}\n\n\tprepareActions()\n\t{\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Zoom();\n\t\tself.initialize(id, settings);\n\n\t\t//todo: remove debug\n\t\tif(!window['zoom'])\n\t\t{\n\t\t\twindow['zoom'] = [];\n\t\t}\n\t\twindow['zoom'].push(self);\n\t\treturn self;\n\t}\n}\n\nZoom.TabsComponent = class\n{\n\tconstructor(config)\n\t{\n\t\tthis.tabs = BX.prop.getArray(config, \"tabs\", []);\n\t\tthis.elements = {\n\t\t\tcontainer: null,\n\t\t\ttabs: {}\n\t\t};\n\t\tthis.eventEmitter = new BX.Event.EventEmitter(this, 'Zoom.TabsComponent');\n\t}\n\n\trender()\n\t{\n\t\tif(this.elements.container)\n\t\t{\n\t\t\treturn this.elements.container;\n\t\t}\n\n\t\tthis.elements.container = BX.create(\"DIV\", {\n\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-section-wrapper\"},\n\t\t\tchildren: [\n\t\t\t\tBX.create(\"DIV\", {\n\t\t\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-section-list\"},\n\t\t\t\t\tchildren: this.tabs.map(this._renderTab, this)\n\t\t\t\t})\n\t\t\t]\n\t\t});\n\t\treturn this.elements.container;\n\t}\n\n\t_renderTab(tabDescription)\n\t{\n\t\tconst tabId = tabDescription.id;\n\t\tthis.elements.tabs[tabId] = BX.create(\"DIV\", {\n\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-section\" + (tabDescription.active ? \" crm-entity-stream-content-detail-zoom-section-active\": \"\")},\n\t\t\tchildren: [\n\t\t\t\tBX.create(\"DIV\", {\n\t\t\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-section-inner\"},\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tBX.create(\"DIV\", {\n\t\t\t\t\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-section-title\"},\n\t\t\t\t\t\t\ttext: tabDescription.title\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tBX.create(\"DIV\", {\n\t\t\t\t\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-section-time\"},\n\t\t\t\t\t\t\ttext: tabDescription.time\n\t\t\t\t\t\t})\n\t\t\t\t\t]\n\t\t\t\t})\n\t\t\t],\n\t\t\tevents: {\n\t\t\t\tclick: function()\n\t\t\t\t{\n\t\t\t\t\tthis.setActiveTab(tabDescription.id)\n\t\t\t\t}.bind(this)\n\t\t\t}\n\t\t});\n\t\treturn this.elements.tabs[tabId];\n\t}\n\n\tsetActiveTab(tabId)\n\t{\n\t\tif(!this.elements.tabs[tabId])\n\t\t{\n\t\t\tthrow new Error (\"Tab \" + tabId + \" is not found\");\n\t\t}\n\t\tfor (let id in this.elements.tabs)\n\t\t{\n\t\t\tif(!this.elements.tabs.hasOwnProperty(id))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tid = Number.parseInt(id, 10);\n\t\t\tif (id === tabId)\n\t\t\t{\n\t\t\t\tthis.elements.tabs[id].classList.add(\"crm-entity-stream-content-detail-zoom-section-active\");\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.elements.tabs[id].classList.remove(\"crm-entity-stream-content-detail-zoom-section-active\");\n\t\t\t}\n\t\t}\n\t\tthis.eventEmitter.emit(\"onTabChange\", {\n\t\t\ttabId: tabId\n\t\t});\n\t}\n};\n","import History from \"./history\";\n\n/** @memberof BX.Crm.Timeline.Actions */\nexport default class OrderModification extends History\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = OrderModification.messages;\n\t\treturn m.hasOwnProperty(name) ? m[name] : name;\n\t}\n\n\tgetTitle()\n\t{\n\t\treturn this.getTextDataParam(\"TITLE\");\n\t}\n\n\tgetStatusInfo()\n\t{\n\t\tconst statusInfo = {};\n\t\tlet value = null;\n\t\tlet classCode = null;\n\t\tconst fieldName = this.getTextDataParam(\"CHANGED_ENTITY\");\n\t\tconst fields = this.getObjectDataParam('FIELDS');\n\t\tconst entityData = this.getAssociatedEntityData();\n\n\t\tif (fieldName === BX.CrmEntityType.names.order)\n\t\t{\n\t\t\tif (BX.prop.get(fields, 'ORDER_CANCELED') === 'Y')\n\t\t\t{\n\t\t\t\tvalue = \"canceled\";\n\t\t\t\tclassCode  = \"not-paid\";\n\t\t\t}\n\t\t\telse if (BX.prop.get(fields, 'ORDER_DONE') === 'Y')\n\t\t\t{\n\t\t\t\tvalue = \"done\";\n\t\t\t\tclassCode  = \"done\";\n\t\t\t}\n\t\t\telse if (BX.prop.getString(entityData, \"VIEWED\", '') === 'Y')\n\t\t\t{\n\t\t\t\tvalue = \"viewed\";\n\t\t\t\tclassCode  = \"done\";\n\t\t\t}\n\t\t\telse if (BX.prop.getString(entityData, \"SENT\", '') === 'Y')\n\t\t\t{\n\t\t\t\tvalue = \"sent\";\n\t\t\t\tclassCode  = \"sent\";\n\t\t\t}\n\t\t}\n\t\tif (fieldName === BX.CrmEntityType.names.orderpayment)\n\t\t{\n\t\t\tconst psStatusCode = BX.prop.get(fields, 'STATUS_CODE', false);\n\t\t\tif (psStatusCode)\n\t\t\t{\n\t\t\t\tif (psStatusCode === 'ERROR')\n\t\t\t\t{\n\t\t\t\t\tvalue = \"orderPaymentError\";\n\t\t\t\t\tclassCode = \"payment-error\";\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (BX.prop.getString(entityData, \"VIEWED\", '') === 'Y')\n\t\t\t{\n\t\t\t\tvalue = \"viewed\";\n\t\t\t\tclassCode  = \"done\";\n\t\t\t}\n\t\t\telse if (BX.prop.getString(entityData, \"SENT\", '') === 'Y')\n\t\t\t{\n\t\t\t\tvalue = \"sent\";\n\t\t\t\tclassCode  = \"sent\";\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tvalue = BX.prop.get(fields, 'ORDER_PAID') === 'Y' ? \"paid\" : \"unpaid\";\n\t\t\t\tclassCode  = BX.prop.get(fields, 'ORDER_PAID') === 'Y' ? \"paid\" : \"not-paid\";\n\t\t\t}\n\t\t}\n\t\telse if (fieldName === BX.CrmEntityType.names.ordershipment && BX.prop.get(fields, 'ORDER_DEDUCTED', false))\n\t\t{\n\t\t\tvalue = BX.prop.get(fields, 'ORDER_DEDUCTED') === 'Y' ? \"deducted\" : \"unshipped\";\n\t\t\tclassCode  = BX.prop.get(fields, 'ORDER_DEDUCTED') === 'Y' ? \"shipped\" : \"not-shipped\";\n\t\t}\n\t\telse if (fieldName === BX.CrmEntityType.names.ordershipment && BX.prop.get(fields, 'ORDER_ALLOW_DELIVERY', false))\n\t\t{\n\t\t\tvalue = BX.prop.get(fields, 'ORDER_ALLOW_DELIVERY') === 'Y' ? \"allowedDelivery\" : \"disallowedDelivery\";\n\t\t\tclassCode  = BX.prop.get(fields, 'ORDER_ALLOW_DELIVERY') === 'Y' ? \"allowed-delivery\" : \"disallowed-delivery\";\n\t\t}\n\n\t\tif (value)\n\t\t{\n\t\t\tstatusInfo.className = \"crm-entity-stream-content-event-\" + classCode;\n\t\t\tstatusInfo.message = this.getMessage(value);\n\t\t}\n\n\t\treturn statusInfo;\n\t}\n\n\tgetHeaderChildren()\n\t{\n\t\tconst children = [\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-event-title\"},\n\t\t\t\t\tevents: {click: this._headerClickHandler},\n\t\t\t\t\ttext: this.getTitle(),\n\t\t\t\t}\n\t\t\t)\n\t\t];\n\t\tconst statusInfo = this.getStatusInfo();\n\t\tif (BX.type.isNotEmptyObject(statusInfo))\n\t\t{\n\t\t\tchildren.push(\n\t\t\t\tBX.create(\"SPAN\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: statusInfo.className },\n\t\t\t\t\t\ttext: statusInfo.message\n\t\t\t\t\t}\n\t\t\t\t));\n\t\t}\n\t\tchildren.push(\n\t\t\tBX.create(\"SPAN\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-event-time\" },\n\t\t\t\t\ttext: this.formatTime(this.getCreatedTime())\n\t\t\t\t}\n\t\t\t));\n\t\treturn children;\n\t}\n\n\tprepareContentDetails()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst entityTypeId = this.getAssociatedEntityTypeId();\n\t\tconst entityId = this.getAssociatedEntityId();\n\t\tconst title = BX.prop.getString(entityData, \"TITLE\");\n\t\tconst htmlTitle = BX.prop.getString(entityData, \"HTML_TITLE\", \"\");\n\t\tconst showUrl = BX.prop.getString(entityData, \"SHOW_URL\", \"\");\n\t\tconst nodes = [];\n\t\tif(title !== \"\")\n\t\t{\n\t\t\tconst descriptionNode = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-detail-description\"}});\n\n\t\t\tif(showUrl === \"\" || (entityTypeId === this.getOwnerTypeId() && entityId === this.getOwnerId()))\n\t\t\t{\n\t\t\t\tdescriptionNode.appendChild(BX.create(\"SPAN\", { text: title + \" \" + htmlTitle}));\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (htmlTitle === \"\")\n\t\t\t\t{\n\t\t\t\t\tdescriptionNode.appendChild(BX.create(\"A\", {attrs: {href: showUrl}, text: title}));\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tdescriptionNode.appendChild(BX.create(\"SPAN\", { text: title + \" \"}));\n\t\t\t\t\tdescriptionNode.appendChild(BX.create(\"A\", {attrs: {href: showUrl}, text: htmlTitle}));\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst legend = BX.prop.getString(entityData, \"LEGEND\");\n\t\t\tif(legend !== \"\")\n\t\t\t{\n\t\t\t\tdescriptionNode.appendChild(BX.create(\"SPAN\", { html: \" \" + legend }));\n\t\t\t}\n\n\t\t\tconst sublegend = BX.prop.getString(entityData, \"SUBLEGEND\", '');\n\t\t\tif (sublegend !== '')\n\t\t\t{\n\t\t\t\tdescriptionNode.appendChild(BX.create(\"BR\"));\n\t\t\t\tdescriptionNode.appendChild(BX.create(\"SPAN\", { text: \" \" + sublegend}));\n\t\t\t}\n\t\t\tnodes.push(descriptionNode);\n\t\t}\n\n\t\treturn nodes;\n\t}\n\n\tprepareViewedContentDetails()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst entityTypeId = this.getAssociatedEntityTypeId();\n\t\tconst entityId = this.getAssociatedEntityId();\n\t\tconst title = BX.prop.getString(entityData, \"TITLE\");\n\t\tconst showUrl = BX.prop.getString(entityData, \"SHOW_URL\", \"\");\n\t\tconst nodes = [];\n\n\t\tif (title !== \"\")\n\t\t{\n\t\t\tconst sublegend = BX.prop.getString(entityData, \"SUBLEGEND\", '');\n\t\t\tif (sublegend !== \"\")\n\t\t\t{\n\t\t\t\tconst descriptionNode = BX.create(\"DIV\", {\n\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail-description\"},\n\t\t\t\t\ttext: sublegend,\n\t\t\t\t});\n\t\t\t\tnodes.push(descriptionNode);\n\t\t\t}\n\n\n\t\t\tif(entityTypeId === this.getOwnerTypeId() && entityId === this.getOwnerId())\n\t\t\t{\n\t\t\t\tnodes.push(BX.create(\"SPAN\", { text: title }));\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tnodes.push(BX.create(\"A\", { attrs: { href: showUrl }, text: title }));\n\t\t\t}\n\n\t\t\tconst legend = BX.prop.getString(entityData, \"LEGEND\");\n\t\t\tif(legend !== \"\")\n\t\t\t{\n\t\t\t\tnodes.push(BX.create(\"SPAN\", { html: \" \" + legend }));\n\t\t\t}\n\t\t}\n\n\t\treturn nodes;\n\t}\n\n\tprepareSentContentDetails()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst entityTypeId = this.getAssociatedEntityTypeId();\n\t\tconst entityId = this.getAssociatedEntityId();\n\t\tconst title = BX.prop.getString(entityData, \"TITLE\");\n\t\tconst showUrl = BX.prop.getString(entityData, 'SHOW_URL', '');\n\t\tconst destination = BX.prop.getString(entityData, 'DESTINATION_TITLE', '');\n\t\tconst nodes = [];\n\n\t\tif (title !== \"\")\n\t\t{\n\t\t\tconst detailNode = BX.create('DIV', {attrs: {className: 'crm-entity-stream-content-detail-description'}});\n\t\t\tif(showUrl === \"\" || (entityTypeId === this.getOwnerTypeId() && entityId === this.getOwnerId()))\n\t\t\t{\n\t\t\t\tdetailNode.appendChild(BX.create(\"SPAN\", { text: title }));\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tdetailNode.appendChild(BX.create('A', { attrs: { href: showUrl }, text: title }));\n\t\t\t}\n\n\t\t\tconst legend = BX.prop.getString(entityData, \"LEGEND\");\n\t\t\tif(legend !== \"\")\n\t\t\t{\n\t\t\t\tdetailNode.appendChild(BX.create(\"SPAN\", { html: \" \" + legend }));\n\t\t\t}\n\n\t\t\tif (destination)\n\t\t\t{\n\t\t\t\tdetailNode.appendChild(BX.create('SPAN', {\n\t\t\t\t\tattrs: { className: 'crm-entity-stream-content-detail-order-destination' },\n\t\t\t\t\ttext: destination,\n\t\t\t\t}));\n\t\t\t}\n\n\t\t\tnodes.push(detailNode);\n\n\t\t\tconst sliderLinkNode = BX.create('A', {\n\t\t\t\tattrs: {href: \"#\"},\n\t\t\t\ttext: this.getMessage('orderPaymentProcess'),\n\t\t\t\tevents: {\n\t\t\t\t\tclick: BX.proxy(this.startSalescenterApplication, this),\n\t\t\t\t},\n\t\t\t});\n\t\t\tnodes.push(sliderLinkNode);\n\t\t}\n\n\t\treturn nodes;\n\t}\n\n\tstartSalescenterApplication()\n\t{\n\t\tBX.loadExt('salescenter.manager').then(function()\n\t\t{\n\t\t\tconst fields = this.getObjectDataParam('FIELDS'),\n\t\t\t\townerTypeId = BX.prop.get(fields, 'OWNER_TYPE_ID', BX.CrmEntityType.enumeration.deal);\n\t\t\tlet ownerId = BX.prop.get(fields, 'OWNER_ID', 0);\n\t\t\tconst paymentId = BX.prop.get(fields, 'PAYMENT_ID', 0),\n\t\t\t\tshipmentId = BX.prop.get(fields, 'SHIPMENT_ID', 0),\n\t\t\t\torderId = BX.prop.get(fields, 'ORDER_ID', 0)\n\t\t\t;\n\n\t\t\t// compatibility\n\t\t\tif (!ownerId)\n\t\t\t{\n\t\t\t\townerId = BX.prop.get(fields, 'DEAL_ID', 0);\n\t\t\t}\n\n\t\t\tBX.Salescenter.Manager.openApplication({\n\t\t\t\tdisableSendButton: '',\n\t\t\t\tcontext: 'deal',\n\t\t\t\townerTypeId: ownerTypeId,\n\t\t\t\townerId: ownerId,\n\t\t\t\tmode: ownerTypeId === BX.CrmEntityType.enumeration.deal ? 'payment_delivery' : 'payment',\n\t\t\t\ttemplateMode: 'view',\n\t\t\t\torderId: orderId,\n\t\t\t\tpaymentId: paymentId,\n\t\t\t\tshipmentId: shipmentId,\n\t\t\t});\n\t\t}.bind(this));\n\t}\n\n\tpreparePaidPaymentContentDetails()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData(),\n\t\t\ttitle = BX.prop.getString(entityData, \"TITLE\"),\n\t\t\tdate = BX.prop.getString(entityData, \"DATE\", \"\"),\n\t\t\tpaySystemName = BX.prop.getString(entityData, \"PAY_SYSTEM_NAME\", \"\"),\n\t\t\tsum = BX.prop.getString(entityData, 'SUM', ''),\n\t\t\tcurrency = BX.prop.getString(entityData, 'CURRENCY', ''),\n\t\t\tnodes = [];\n\n\t\tif(title !== \"\")\n\t\t{\n\t\t\tconst paymentDetail = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-detail-payment\"}});\n\t\t\tpaymentDetail.appendChild(\n\t\t\t\tBX.create(\"DIV\", {\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-payment-value\"},\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tBX.create('SPAN', {\n\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-payment-text\"},\n\t\t\t\t\t\t\thtml: sum,\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tBX.create('SPAN', {\n\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-payment-currency\"},\n\t\t\t\t\t\t\thtml: currency,\n\t\t\t\t\t\t}),\n\t\t\t\t\t]\n\t\t\t\t})\n\t\t\t);\n\n\t\t\tconst logotip = BX.prop.getString(entityData, \"LOGOTIP\", null);\n\t\t\tif (logotip)\n\t\t\t{\n\t\t\t\tpaymentDetail.appendChild(\n\t\t\t\t\tBX.create(\"DIV\", {\n\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-payment-logo\"},\n\t\t\t\t\t\tstyle: {\n\t\t\t\t\t\t\tbackgroundImage: \"url(\" + encodeURI(logotip) + \")\",\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t);\n\t\t\t}\n\t\t\tnodes.push(paymentDetail);\n\n\t\t\tconst descriptionNode = BX.create(\"DIV\", {\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail-description\"},\n\t\t\t\tchildren: [\n\t\t\t\t\tBX.create('SPAN', {\n\t\t\t\t\t\ttext: date\n\t\t\t\t\t}),\n\t\t\t\t\tBX.create('SPAN', {\n\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail-description-info\"},\n\t\t\t\t\t\ttext: this.getMessage('orderPaySystemTitle')\n\t\t\t\t\t}),\n\t\t\t\t\tBX.create('SPAN', {\n\t\t\t\t\t\ttext: paySystemName\n\t\t\t\t\t}),\n\t\t\t\t]\n\t\t\t});\n\t\t\tnodes.push(descriptionNode);\n\t\t}\n\n\t\treturn nodes;\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst fields = this.getObjectDataParam('FIELDS'),\n\t\t\tisPaid = BX.prop.get(fields, 'ORDER_PAID') === 'Y',\n\t\t\tisClick = BX.prop.get(fields, 'PAY_SYSTEM_CLICK') === 'Y',\n\t\t\tisManualContinuePay = BX.prop.get(fields, 'MANUAL_CONTINUE_PAY') === 'Y',\n\t\t\tisManualAddCheck = BX.prop.get(fields, 'NEED_MANUAL_ADD_CHECK') === 'Y',\n\t\t\tentityId = this.getAssociatedEntityTypeId();\n\n\t\tif (entityId === BX.CrmEntityType.enumeration.orderpayment && isPaid)\n\t\t{\n\t\t\treturn this.preparePaidPaymentContent();\n\t\t}\n\t\telse if (entityId === BX.CrmEntityType.enumeration.orderpayment && isClick)\n\t\t{\n\t\t\treturn this.prepareClickedPaymentContent();\n\t\t}\n\t\telse if (entityId === BX.CrmEntityType.enumeration.order && isManualContinuePay)\n\t\t{\n\t\t\treturn this.prepareManualContinuePayContent();\n\t\t}\n\t\telse if (entityId === BX.CrmEntityType.enumeration.orderpayment && isManualAddCheck)\n\t\t{\n\t\t\treturn this.prepareManualAddCheck();\n\t\t}\n\n\t\treturn this.prepareItemOrderContent();\n\t}\n\n\tprepareItemOrderContent()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst isViewed = BX.prop.getString(entityData, \"VIEWED\", '') === 'Y';\n\t\tconst isSent = BX.prop.getString(entityData, \"SENT\", '') === 'Y';\n\t\tconst fields = this.getObjectDataParam('FIELDS');\n\t\tconst psStatusCode = BX.prop.get(fields, 'STATUS_CODE', false);\n\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: 'crm-entity-stream-section crm-entity-stream-section-history'}});\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: 'crm-entity-stream-section-icon ' + this.getIconClassName() } })\n\t\t);\n\n\t\tconst content = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\tconst header = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-header\"},\n\t\t\t\tchildren: this.getHeaderChildren()\n\t\t\t});\n\n\t\tlet contentChildren = null;\n\t\tif (isViewed)\n\t\t{\n\t\t\tcontentChildren = this.prepareViewedContentDetails();\n\t\t}\n\t\telse if (isSent)\n\t\t{\n\t\t\tcontentChildren = this.prepareSentContentDetails();\n\t\t}\n\t\telse if (psStatusCode === 'ERROR')\n\t\t{\n\t\t\tcontentChildren = this.prepareErrorPaymentContentDetails();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tcontentChildren = this.prepareContentDetails();\n\t\t}\n\n\t\tcontent.appendChild(header);\n\t\tcontent.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail\" },\n\t\t\t\t\tchildren: contentChildren\n\t\t\t\t})\n\t\t);\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontent.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-content\" }, children: [ content ] })\n\t\t);\n\n\t\treturn wrapper;\n\t}\n\n\tpreparePaidPaymentContent()\n\t{\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: 'crm-entity-stream-section'}});\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: 'crm-entity-stream-section-icon crm-entity-stream-section-icon-wallet' } })\n\t\t);\n\n\t\tconst header = [\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-event-title\"},\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattrs: {href: \"#\"},\n\t\t\t\t\t\t\t\t\tevents: {click: this._headerClickHandler},\n\t\t\t\t\t\t\t\t\ttext: this.getMessage('orderPaymentSuccessTitle')\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t];\n\t\theader.push(\n\t\t\tBX.create(\"SPAN\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-event-time\" },\n\t\t\t\t\ttext: this.formatTime(this.getCreatedTime())\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst content = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\tconst headerWrap = BX.create(\"DIV\", {\n\t\t\tattrs: {className: \"crm-entity-stream-content-header\"},\n\t\t\tchildren: header\n\t\t});\n\n\t\tconst contentChildren = this.preparePaidPaymentContentDetails();\n\t\tcontent.appendChild(headerWrap);\n\t\tcontent.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail\" },\n\t\t\t\t\tchildren: contentChildren\n\t\t\t\t})\n\t\t);\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontent.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-content\" }, children: [ content ] })\n\t\t);\n\n\t\treturn wrapper;\n\t}\n\n\tprepareErrorPaymentContentDetails()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData(),\n\t\t\tdate = BX.prop.getString(entityData, 'DATE', ''),\n\t\t\tfields = this.getObjectDataParam('FIELDS'),\n\t\t\tpaySystemName = BX.prop.getString(fields, 'PAY_SYSTEM_NAME', ''),\n\t\t\tpaySystemError = BX.prop.getString(fields, 'STATUS_DESCRIPTION', ''),\n\t\t\tnodes = [];\n\n\t\tconst descriptionNode = BX.create('DIV', {\n\t\t\tattrs: {className: 'crm-entity-stream-content-detail-description'},\n\t\t\tchildren: [\n\t\t\t\tBX.create('SPAN', {\n\t\t\t\t\ttext: date\n\t\t\t\t}),\n\t\t\t\tBX.create('SPAN', {\n\t\t\t\t\tattrs: {className: 'crm-entity-stream-content-detail-description-info'},\n\t\t\t\t\ttext: this.getMessage('orderPaySystemTitle')\n\t\t\t\t}),\n\t\t\t\tBX.create('SPAN', {\n\t\t\t\t\ttext: paySystemName\n\t\t\t\t}),\n\t\t\t]\n\t\t});\n\t\tnodes.push(descriptionNode);\n\n\t\tconst errorDetailNode = BX.create('DIV', {\n\t\t\tattrs: {className: 'crm-entity-stream-content-event-payment-initiate-pay-error'},\n\t\t\ttext: this.getMessage('orderPaymentStatusErrorReason').replace(\"#PAYSYSTEM_ERROR#\", paySystemError),\n\t\t});\n\n\t\tnodes.push(errorDetailNode);\n\n\t\treturn nodes;\n\t}\n\n\tprepareClickedPaymentContent()\n\t{\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: 'crm-entity-stream-section crm-entity-stream-section-history'}});\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: 'crm-entity-stream-section-icon ' + this.getIconClassName() } })\n\t\t);\n\n\t\tconst header = [\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-event-title\"},\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattrs: {href: \"#\"},\n\t\t\t\t\t\t\t\t\tevents: {click: this._headerClickHandler},\n\t\t\t\t\t\t\t\t\ttext: this.getTitle(),\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t];\n\t\theader.push(\n\t\t\tBX.create(\"SPAN\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-event-time\" },\n\t\t\t\t\ttext: this.formatTime(this.getCreatedTime())\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst content = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\tconst headerWrap = BX.create(\"DIV\", {\n\t\t\tattrs: {className: \"crm-entity-stream-content-header\"},\n\t\t\tchildren: header\n\t\t});\n\n\t\tconst contentChildren = this.prepareClickedPaymentContentDetails();\n\t\tcontent.appendChild(headerWrap);\n\t\tcontent.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail\" },\n\t\t\t\t\tchildren: contentChildren\n\t\t\t\t})\n\t\t);\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontent.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-content\" }, children: [ content ] })\n\t\t);\n\n\t\treturn wrapper;\n\t}\n\n\tprepareClickedPaymentContentDetails()\n\t{\n\t\tconst fields = this.getObjectDataParam('FIELDS'),\n\t\t\tpaySystemName = BX.prop.getString(fields, 'PAY_SYSTEM_NAME', ''),\n\t\t\tnodes = [];\n\n\t\tif(paySystemName !== '')\n\t\t{\n\t\t\tconst descriptionNode = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-detail-description\"}});\n\t\t\tdescriptionNode.appendChild(\n\t\t\t\tBX.create('SPAN', {\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-clicked-description-info\" },\n\t\t\t\t\ttext: this.getMessage('orderPaymentPaySystemClick')\n\t\t\t\t})\n\t\t\t);\n\t\t\tdescriptionNode.appendChild(\n\t\t\t\tBX.create('SPAN', {\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-clicked-description-name\" },\n\t\t\t\t\ttext: paySystemName\n\t\t\t\t})\n\t\t\t);\n\n\t\t\tnodes.push(descriptionNode);\n\t\t}\n\n\t\treturn nodes;\n\t}\n\n\tprepareManualContinuePayContent()\n\t{\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: 'crm-entity-stream-section crm-entity-stream-section-history crm-entity-stream-section-advice'}});\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", {\n\t\t\t\tattrs: { className: 'crm-entity-stream-section-icon crm-entity-stream-section-icon-advice' },\n\t\t\t\tchildren: [BX.create('i')],\n\t\t\t})\n\t\t);\n\n\t\tconst content = BX.create(\"DIV\", {\n\t\t\tattrs: {className: \"crm-entity-stream-advice-info\"},\n\t\t\ttext: this.getMessage('orderManualContinuePay'),\n\t\t});\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-advice-content\" }, children: [ content ] })\n\t\t);\n\n\t\treturn wrapper;\n\t}\n\n\tprepareManualAddCheck()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst showUrl = BX.prop.getString(entityData, \"SHOW_URL\", \"\");\n\n\t\tconst wrapper = BX.create(\n\t\t\t\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {\n\t\t\t\t\tclassName: 'crm-entity-stream-section crm-entity-stream-section-history crm-entity-stream-section-advice'\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t\twrapper.appendChild(\n\t\t\tBX.create(\n\t\t\t\t\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\tclassName: 'crm-entity-stream-section-icon crm-entity-stream-section-icon-advice'\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst htmlTitle = this.getMessage('orderManualAddCheck').replace(\"#HREF#\", showUrl);\n\t\tconst content = BX.create(\n\t\t\t\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {\n\t\t\t\t\tclassName: \"crm-entity-stream-advice-info\",\n\t\t\t\t},\n\t\t\t\thtml: htmlTitle,\n\t\t\t}\n\t\t);\n\n\t\tconst link = BX.create(\n\t\t\t\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {\n\t\t\t\t\tclassName: \"crm-entity-stream-advice-info\",\n\t\t\t\t},\n\t\t\t\tchildren: [\n\t\t\t\t\tBX.create(\n\t\t\t\t\t\t\"A\",\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\t\tclassName: \"crm-entity-stream-content-detail-target\",\n\t\t\t\t\t\t\t\thref: \"#\",\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\t\tclick: BX.delegate(function (e) {\n\t\t\t\t\t\t\t\t\ttop.BX.Helper.show('redirect=detail&code=13742126');\n\t\t\t\t\t\t\t\t\te.preventDefault ? e.preventDefault() : (e.returnValue = false);\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\thtml: this.getMessage('orderManualAddCheckHelpLink'),\n\t\t\t\t\t\t}\n\t\t\t\t\t)\n\t\t\t\t]\n\t\t\t}\n\t\t);\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\n\t\t\t\t\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\tclassName: \"crm-entity-stream-advice-content\"\n\t\t\t\t\t},\n\t\t\t\t\tchildren: [ content, link ]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\treturn wrapper;\n\t}\n\n\tgetIconClassName()\n\t{\n\t\treturn 'crm-entity-stream-section-icon-store';\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new OrderModification();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n\n\tstatic messages = {};\n}\n","import OrderModification from \"./order-modification\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class ExternalNoticeModification extends OrderModification\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetIconClassName()\n\t{\n\t\treturn 'crm-entity-stream-section-icon-restApp';\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new ExternalNoticeModification();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import ExternalNoticeModification from \"./external-notice-modification\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class ExternalNoticeStatusModification extends ExternalNoticeModification\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tprepareContentDetails()\n\t{\n\t\tconst nodes = [];\n\t\tconst contentChildren = [];\n\n\t\tif (BX.type.isNotEmptyString(this.getTextDataParam(\"START_NAME\")))\n\t\t{\n\t\t\tcontentChildren.push(\n\t\t\t\tBX.create(\"SPAN\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-detain-info-status\"},\n\t\t\t\t\t\ttext: this.getTextDataParam(\"START_NAME\")\n\t\t\t\t\t})\n\t\t\t);\n\t\t\tcontentChildren.push(\n\t\t\t\tBX.create(\"SPAN\",{ attrs: { className: \"crm-entity-stream-content-detail-info-separator-icon\" } })\n\t\t\t);\n\t\t}\n\n\t\tif (BX.type.isNotEmptyString(this.getTextDataParam(\"FINISH_NAME\")))\n\t\t{\n\t\t\tcontentChildren.push(\n\t\t\t\tBX.create(\"SPAN\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detain-info-status\" },\n\t\t\t\t\t\ttext: this.getTextDataParam(\"FINISH_NAME\")\n\t\t\t\t\t})\n\t\t\t);\n\t\t}\n\n\t\tnodes.push(BX.create(\"DIV\",\t{\n\t\t\tattrs: { className: \"crm-entity-stream-content-detail-info\" },\n\t\t\tchildren: contentChildren\n\t\t}));\n\n\t\treturn nodes;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new ExternalNoticeStatusModification();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import HistoryItem from \"./history\";\nimport {Item as ItemType} from \"../types\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Creation extends HistoryItem\n{\n\tstatic messages = {};\n\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Creation();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n\n\tdoInitialize()\n\t{\n\t\tsuper.doInitialize();\n\t\tif (!(this._activityEditor instanceof BX.CrmActivityEditor))\n\t\t{\n\t\t\tthrow \"Creation. The field 'activityEditor' is not assigned.\";\n\t\t}\n\t}\n\n\tgetTitle()\n\t{\n\t\tconst entityTypeId = this.getAssociatedEntityTypeId();\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tif (entityTypeId === BX.CrmEntityType.enumeration.activity)\n\t\t{\n\t\t\tconst typeId = BX.prop.getInteger(entityData, \"TYPE_ID\");\n\t\t\tconst title = this.getMessage(typeId === BX.CrmActivityType.task ? \"task\" : \"activity\");\n\t\t\treturn title.replace(/#TITLE#/gi, this.cutOffText(BX.prop.getString(entityData, \"SUBJECT\")), 64);\n\t\t}\n\n\t\tif (entityTypeId === BX.CrmEntityType.enumeration.storeDocument)\n\t\t{\n\t\t\tconst docType = BX.prop.getString(entityData, \"DOC_TYPE\");\n\t\t\tif (docType === 'A')\n\t\t\t{\n\t\t\t\treturn this.getMessage('arrivalDocument');\n\t\t\t}\n\t\t\tif (docType === 'S')\n\t\t\t{\n\t\t\t\treturn this.getMessage('storeAdjustmentDocument');\n\t\t\t}\n\t\t\tif (docType === 'M')\n\t\t\t{\n\t\t\t\treturn this.getMessage('movingDocument');\n\t\t\t}\n\t\t\tif (docType === 'D')\n\t\t\t{\n\t\t\t\treturn this.getMessage('deductDocument');\n\t\t\t}\n\t\t\tif (docType === 'W')\n\t\t\t{\n\t\t\t\treturn this.getMessage('shipmentDocument');\n\t\t\t}\n\n\t\t\treturn '';\n\t\t}\n\n\t\tconst entityTypeName = BX.CrmEntityType.resolveName(this.getAssociatedEntityTypeId()).toLowerCase();\n\t\tlet msg = this.getMessage(entityTypeName);\n\t\tconst isMessageNotFound = (msg === entityTypeName);\n\t\tif (!BX.type.isNotEmptyString(msg) || isMessageNotFound)\n\t\t{\n\t\t\tmsg = this.getTextDataParam(\"TITLE\");\n\t\t}\n\n\t\treturn msg;\n\t}\n\n\tgetWrapperClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-createEntity\";\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst entityTypeId = this.getAssociatedEntityTypeId();\n\n\t\tif (\n\t\t\tentityTypeId === BX.CrmEntityType.enumeration.ordershipment\n\t\t\t|| entityTypeId === BX.CrmEntityType.enumeration.orderpayment\n\t\t)\n\t\t{\n\t\t\tconst data = this.getData();\n\t\t\tdata.TYPE_CATEGORY_ID = ItemType.modification;\n\t\t\tif (data.hasOwnProperty('ASSOCIATED_ENTITY'))\n\t\t\t{\n\t\t\t\tdata.ASSOCIATED_ENTITY.HTML_TITLE = '';\n\t\t\t}\n\n\t\t\tconst createOrderEntityItem = this._history.createOrderEntityItem(data);\n\t\t\treturn createOrderEntityItem.prepareContent();\n\t\t}\n\n\t\treturn super.prepareContent();\n\t}\n\n\tprepareContentDetails()\n\t{\n\t\tconst entityTypeId = this.getAssociatedEntityTypeId();\n\t\tconst entityId = this.getAssociatedEntityId();\n\t\tconst entityData = this.getAssociatedEntityData();\n\n\t\tif (entityTypeId === BX.CrmEntityType.enumeration.activity)\n\t\t{\n\t\t\tconst link = BX.create(\"A\",\n\t\t\t\t{\n\t\t\t\t\tattrs: {href: \"#\"},\n\t\t\t\t\thtml: this.cutOffText(BX.prop.getString(entityData, \"DESCRIPTION_RAW\"), 128)\n\t\t\t\t}\n\t\t\t);\n\t\t\tBX.bind(link, \"click\", this._headerClickHandler);\n\n\t\t\treturn [link];\n\t\t}\n\n\t\tconst title = BX.prop.getString(entityData, \"TITLE\", \"\");\n\t\tlet htmlTitle = BX.prop.getString(entityData, \"HTML_TITLE\", \"\");\n\t\tconst showUrl = BX.prop.getString(entityData, \"SHOW_URL\", \"\");\n\n\t\tif (\n\t\t\tentityTypeId === BX.CrmEntityType.enumeration.deal\n\t\t\t&& BX.prop.getObject(entityData, \"ORDER\", null)\n\t\t)\n\t\t{\n\t\t\tconst orderData = BX.prop.getObject(entityData, \"ORDER\", null);\n\t\t\thtmlTitle = this.getMessage('dealOrderTitle')\n\t\t\t\t.replace(\"#ORDER_ID#\", orderData.ID)\n\t\t\t\t.replace(\"#DATE_TIME#\", orderData.ORDER_DATE)\n\t\t\t\t.replace(\"#HREF#\", orderData.SHOW_URL)\n\t\t\t\t.replace(\"#PRICE_WITH_CURRENCY#\", orderData.SUM)\n\t\t\t;\n\t\t}\n\n\t\tif (title !== \"\" || htmlTitle !== \"\")\n\t\t{\n\t\t\tconst nodes = [];\n\t\t\tif (showUrl === \"\" || (entityTypeId === this.getOwnerTypeId() && entityId === this.getOwnerId()))\n\t\t\t{\n\t\t\t\tconst spanAttrs = (htmlTitle !== \"\") ? {html: htmlTitle} : {text: title};\n\t\t\t\tnodes.push(BX.create(\"SPAN\", spanAttrs));\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tlet linkAttrs = {attrs: {href: showUrl}, text: title};\n\t\t\t\tif (htmlTitle !== \"\")\n\t\t\t\t{\n\t\t\t\t\tlinkAttrs = {attrs: {href: showUrl}, html: htmlTitle};\n\t\t\t\t}\n\t\t\t\tnodes.push(BX.create(\"A\", linkAttrs));\n\t\t\t}\n\n\t\t\tconst legend = this.getTextDataParam(\"LEGEND\");\n\t\t\tif (legend !== \"\")\n\t\t\t{\n\t\t\t\tnodes.push(BX.create(\"BR\"));\n\t\t\t\tnodes.push(BX.create(\"SPAN\", {text: legend}));\n\t\t\t}\n\n\t\t\tconst baseEntityData = this.getObjectDataParam(\"BASE\");\n\t\t\tconst baseEntityInfo = BX.prop.getObject(baseEntityData, \"ENTITY_INFO\");\n\t\t\tif (baseEntityInfo)\n\t\t\t{\n\t\t\t\tnodes.push(BX.create(\"BR\"));\n\t\t\t\tnodes.push(BX.create(\"SPAN\", {text: BX.prop.getString(baseEntityData, \"CAPTION\") + \": \"}));\n\t\t\t\tnodes.push(\n\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tattrs: {href: BX.prop.getString(baseEntityInfo, \"SHOW_URL\", \"#\")},\n\t\t\t\t\t\t\ttext: BX.prop.getString(baseEntityInfo, \"TITLE\", \"\")\n\t\t\t\t\t\t}\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\t\t\treturn nodes;\n\t\t}\n\t\treturn [];\n\t}\n\n\tview()\n\t{\n\t\tconst entityTypeId = this.getAssociatedEntityTypeId();\n\t\tif (entityTypeId === BX.CrmEntityType.enumeration.activity)\n\t\t{\n\t\t\tconst entityData = this.getAssociatedEntityData();\n\t\t\tconst id = BX.prop.getInteger(entityData, \"ID\", 0);\n\t\t\tif (id > 0)\n\t\t\t{\n\t\t\t\tthis._activityEditor.viewActivity(id);\n\t\t\t}\n\t\t}\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = Creation.messages;\n\n\t\treturn m.hasOwnProperty(name) ? m[name] : name;\n\t}\n}\n","import History from \"./history\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Restoration extends History\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetTitle()\n\t{\n\t\treturn this.getTextDataParam(\"TITLE\");\n\t}\n\n\tgetWrapperClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-restoreEntity\";\n\t}\n\n\tprepareContentDetails()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst title = BX.prop.getString(entityData, \"TITLE\");\n\t\treturn title !== \"\" ?  [ BX.create(\"SPAN\", { text: title }) ] : [];\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = Restoration.messages;\n\t\treturn m.hasOwnProperty(name) ? m[name] : name;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Restoration();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n\n\tstatic messages = {};\n}\n","import History from \"./history\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Relation extends History\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetTitle()\n\t{\n\t\treturn this.getMessage('title');\n\t}\n\n\tgetWrapperClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-createEntity\";\n\t}\n\n\tprepareContentDetails()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\n\t\tlet link = BX.prop.getString(entityData, \"SHOW_URL\", \"\");\n\t\tif (link.indexOf('/') !== 0)\n\t\t{\n\t\t\tlink = '#';\n\t\t}\n\n\t\tconst content =\n\t\t\tthis.getMessage('contentTemplate')\n\t\t\t\t.replace('#ENTITY_TYPE_CAPTION#', BX.Text.encode(BX.prop.getString(entityData, 'ENTITY_TYPE_CAPTION', '')))\n\t\t\t\t.replace('#LEGEND#', '')\n\t\t\t\t.replace('#LINK#', BX.Text.encode(link))\n\t\t\t\t.replace('#LINK_TITLE#', BX.Text.encode(BX.prop.getString(entityData, \"TITLE\", '')))\n\t\t;\n\n\t\tconst nodes = [];\n\t\tnodes.push(\n\t\t\tBX.create('SPAN', { html: content })\n\t\t);\n\n\t\treturn nodes;\n\t}\n}\n","import Relation from \"./relation\"\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Link extends Relation\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetIconClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-icon crm-entity-stream-section-icon-link\";\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = Link.messages;\n\t\treturn m.hasOwnProperty(name) ? m[name] : name;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Link();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n\n\tstatic messages = {};\n}\n","import Relation from \"./relation\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Unlink extends Relation\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetIconClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-icon crm-entity-stream-section-icon-unlink\";\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = Unlink.messages;\n\t\treturn m.hasOwnProperty(name) ? m[name] : name;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Unlink();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n\n\tstatic messages = {};\n}\n","import History from \"./history\";\nimport {Mark as MarkType} from \"../types\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Mark extends History\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tdoInitialize()\n\t{\n\t\tsuper.doInitialize();\n\t\tif(!(this._activityEditor instanceof BX.CrmActivityEditor))\n\t\t{\n\t\t\tthrow \"Mark. The field 'activityEditor' is not assigned.\";\n\t\t}\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = Mark.messages;\n\t\tif (m.hasOwnProperty(name))\n\t\t{\n\t\t\treturn m[name];\n\t\t}\n\n\t\treturn super.getMessage(name);\n\t}\n\n\tgetTitle()\n\t{\n\t\tlet title = \"\";\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst associatedEntityTypeId = this.getAssociatedEntityTypeId();\n\t\tconst typeCategoryId = this.getTypeCategoryId();\n\t\tif(associatedEntityTypeId === BX.CrmEntityType.enumeration.activity)\n\t\t{\n\t\t\tconst entityTypeId = BX.prop.getInteger(entityData, \"TYPE_ID\", 0);\n\t\t\tconst direction = BX.prop.getInteger(entityData, \"DIRECTION\", 0);\n\t\t\tconst activityProviderId = BX.prop.getString(entityData, \"PROVIDER_ID\", '');\n\n\t\t\tif(entityTypeId === BX.CrmActivityType.email)\n\t\t\t{\n\t\t\t\tif(typeCategoryId === MarkType.success)\n\t\t\t\t{\n\t\t\t\t\ttitle = this.getMessage(\n\t\t\t\t\t\t(direction === BX.CrmActivityDirection.incoming ? \"incomingEmail\" : \"outgoingEmail\") +\n\t\t\t\t\t\t\"SuccessMark\"\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\telse if(typeCategoryId === MarkType.renew)\n\t\t\t\t{\n\t\t\t\t\ttitle = this.getMessage(\n\t\t\t\t\t\t(direction === BX.CrmActivityDirection.incoming ? \"incomingEmail\" : \"outgoingEmail\") +\n\t\t\t\t\t\t\"RenewMark\"\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if(entityTypeId === BX.CrmActivityType.call)\n\t\t\t{\n\t\t\t\tif(typeCategoryId === MarkType.success)\n\t\t\t\t{\n\t\t\t\t\ttitle = this.getMessage(\n\t\t\t\t\t\t(direction === BX.CrmActivityDirection.incoming ? \"incomingCall\" : \"outgoingCall\") +\n\t\t\t\t\t\t\"SuccessMark\"\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\telse if(typeCategoryId === MarkType.renew)\n\t\t\t\t{\n\t\t\t\t\ttitle = this.getMessage(\n\t\t\t\t\t\t(direction === BX.CrmActivityDirection.incoming ? \"incomingCall\" : \"outgoingCall\") +\n\t\t\t\t\t\t\"RenewMark\"\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if(entityTypeId === BX.CrmActivityType.meeting)\n\t\t\t{\n\t\t\t\tif(typeCategoryId === MarkType.success)\n\t\t\t\t{\n\t\t\t\t\ttitle = this.getMessage(\"meetingSuccessMark\");\n\t\t\t\t}\n\t\t\t\telse if(typeCategoryId === MarkType.renew)\n\t\t\t\t{\n\t\t\t\t\ttitle = this.getMessage(\"meetingRenewMark\");\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if(entityTypeId === BX.CrmActivityType.task)\n\t\t\t{\n\t\t\t\tif(typeCategoryId === MarkType.success)\n\t\t\t\t{\n\t\t\t\t\ttitle = this.getMessage(\"taskSuccessMark\");\n\t\t\t\t}\n\t\t\t\telse if(typeCategoryId === MarkType.renew)\n\t\t\t\t{\n\t\t\t\t\ttitle = this.getMessage(\"taskRenewMark\");\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if(entityTypeId === BX.CrmActivityType.provider)\n\t\t\t{\n\t\t\t\tif (activityProviderId === 'CRM_REQUEST')\n\t\t\t\t{\n\t\t\t\t\tif(typeCategoryId === MarkType.success)\n\t\t\t\t\t{\n\t\t\t\t\t\ttitle = this.getMessage(\"requestSuccessMark\");\n\t\t\t\t\t}\n\t\t\t\t\telse if(typeCategoryId === MarkType.renew)\n\t\t\t\t\t{\n\t\t\t\t\t\ttitle = this.getMessage(\"requestRenewMark\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if(typeCategoryId === MarkType.success)\n\t\t\t\t{\n\t\t\t\t\ttitle = this.getMessage(\"webformSuccessMark\");\n\t\t\t\t}\n\t\t\t\telse if(typeCategoryId === MarkType.renew)\n\t\t\t\t{\n\t\t\t\t\ttitle = this.getMessage(\"webformRenewMark\");\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse if(associatedEntityTypeId === BX.CrmEntityType.enumeration.deal)\n\t\t{\n\t\t\tif(typeCategoryId === MarkType.success)\n\t\t\t{\n\t\t\t\ttitle = this.getMessage(\"dealSuccessMark\");\n\t\t\t}\n\t\t\telse if(typeCategoryId === MarkType.failed)\n\t\t\t{\n\t\t\t\ttitle = this.getMessage(\"dealFailedMark\");\n\t\t\t}\n\t\t}\n\t\telse if(associatedEntityTypeId === BX.CrmEntityType.enumeration.order)\n\t\t{\n\t\t\tif(typeCategoryId === MarkType.success)\n\t\t\t{\n\t\t\t\ttitle = this.getMessage(\"orderSuccessMark\");\n\t\t\t}\n\t\t\telse if(typeCategoryId === MarkType.failed)\n\t\t\t{\n\t\t\t\ttitle = this.getMessage(\"orderFailedMark\");\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (BX.CrmEntityType.isDefined(associatedEntityTypeId))\n\t\t\t{\n\t\t\t\tif (typeCategoryId === MarkType.success)\n\t\t\t\t{\n\t\t\t\t\ttitle = this.getMessage('entitySuccessMark');\n\t\t\t\t}\n\t\t\t\telse if (typeCategoryId === MarkType.failed)\n\t\t\t\t{\n\t\t\t\t\ttitle = this.getMessage('entityFailedMark');\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn title;\n\t}\n\n\tprepareTitleLayout()\n\t{\n\t\tconst associatedEntityTypeId = this.getAssociatedEntityTypeId();\n\n\t\tif(associatedEntityTypeId === BX.CrmEntityType.enumeration.order)\n\t\t{\n\t\t\treturn BX.create(\"SPAN\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-event-title\" },\n\t\t\t\t\ttext: this.getTitle()\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn BX.create(\"A\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { href: \"#\", className: \"crm-entity-stream-content-event-title\" },\n\t\t\t\t\tevents: { \"click\": this._headerClickHandler },\n\t\t\t\t\ttext: this.getTitle()\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst associatedEntityTypeId = this.getAssociatedEntityTypeId();\n\n\t\tconst wrapper = BX.create(\n\t\t\t\"DIV\",\n\t\t\t{attrs: {className: \"crm-entity-stream-section crm-entity-stream-section-completed\"}}\n\t\t);\n\n\t\tif (this.isFixed())\n\t\t\tBX.addClass(wrapper, 'crm-entity-stream-section-top-fixed');\n\n\t\t//region Context Menu\n\t\tif(this.isContextMenuEnabled())\n\t\t{\n\t\t\twrapper.appendChild(this.prepareContextMenuButton());\n\t\t}\n\t\t//endregion\n\n\t\tconst content = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\tconst header = this.prepareHeaderLayout();\n\t\tif(associatedEntityTypeId === BX.CrmEntityType.enumeration.activity)\n\t\t{\n\t\t\tconst entityTypeId = BX.prop.getInteger(entityData, \"TYPE_ID\", 0);\n\t\t\tlet iconClassName = \"crm-entity-stream-section-icon\";\n\t\t\tif(entityTypeId === BX.CrmActivityType.email)\n\t\t\t{\n\t\t\t\ticonClassName += \" crm-entity-stream-section-icon-email\";\n\t\t\t}\n\t\t\telse if(entityTypeId === BX.CrmActivityType.call)\n\t\t\t{\n\t\t\t\ticonClassName += \" crm-entity-stream-section-icon-call\";\n\t\t\t}\n\t\t\telse if(entityTypeId === BX.CrmActivityType.meeting)\n\t\t\t{\n\t\t\t\ticonClassName += \" crm-entity-stream-section-icon-meeting\";\n\t\t\t}\n\t\t\telse if(entityTypeId === BX.CrmActivityType.task)\n\t\t\t{\n\t\t\t\ticonClassName += \" crm-entity-stream-section-icon-task\";\n\t\t\t}\n\t\t\telse if(entityTypeId === BX.CrmActivityType.provider)\n\t\t\t{\n\t\t\t\tconst providerId = BX.prop.getString(entityData, \"PROVIDER_ID\", \"\");\n\t\t\t\tif(providerId === \"CRM_WEBFORM\")\n\t\t\t\t{\n\t\t\t\t\ticonClassName += \" crm-entity-stream-section-icon-crmForm\";\n\t\t\t\t}\n\t\t\t}\n\n\t\t\twrapper.appendChild(BX.create(\"DIV\", { attrs: { className: iconClassName } }));\n\t\t\tcontent.appendChild(header);\n\n\n\t\t\tconst detailWrapper = BX.create(\"DIV\",\n\t\t\t\t{attrs: {className: \"crm-entity-stream-content-detail\"}}\n\t\t\t);\n\t\t\tcontent.appendChild(detailWrapper);\n\n\t\t\tdetailWrapper.appendChild(\n\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-title\" },\n\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tattrs: { href: \"#\" },\n\t\t\t\t\t\t\t\t\t\tevents: { \"click\": this._headerClickHandler },\n\t\t\t\t\t\t\t\t\t\ttext: this.cutOffText(BX.prop.getString(entityData, \"SUBJECT\", \"\"), 128)\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t);\n\n\t\t\tconst summary = this.getTextDataParam(\"SUMMARY\");\n\t\t\tif(summary !== \"\")\n\t\t\t{\n\t\t\t\tdetailWrapper.appendChild(\n\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-description\" },\n\t\t\t\t\t\t\ttext: summary\n\t\t\t\t\t\t}\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t\telse if(associatedEntityTypeId === BX.CrmEntityType.enumeration.order)\n\t\t{\n\t\t\twrapper.appendChild(BX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-info\" } }));\n\t\t\tcontent.appendChild(header);\n\t\t\tcontent.appendChild(\n\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail\" },\n\t\t\t\t\t\ttext: this.cutOffText(this.getTextDataParam(\"MESSAGE\"), 128)\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\t\telse\n\t\t{\n\t\t\twrapper.appendChild(BX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-info\" } }));\n\t\t\tcontent.appendChild(header);\n\n\t\t\tconst innerWrapper = BX.create(\n\t\t\t\t\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail\"}\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tconst associatedEntityTitle = this.cutOffText(BX.prop.getString(entityData, \"TITLE\", \"\"), 128);\n\n\t\t\tif (BX.CrmEntityType.isDefined(associatedEntityTypeId))\n\t\t\t{\n\t\t\t\tlet link = BX.prop.getString(entityData, 'SHOW_URL', '');\n\t\t\t\tif (link.indexOf('/') !== 0)\n\t\t\t\t{\n\t\t\t\t\tlink = '#';\n\t\t\t\t}\n\n\t\t\t\tconst contentTemplate =\n\t\t\t\t\tthis.getMessage('entityContentTemplate')\n\t\t\t\t\t\t.replace('#ENTITY_TYPE_CAPTION#', BX.Text.encode(BX.prop.getString(entityData, 'ENTITY_TYPE_CAPTION', '')))\n\t\t\t\t\t\t.replace('#LINK#', BX.Text.encode(link))\n\t\t\t\t\t\t.replace('#LINK_TITLE#', BX.Text.encode(associatedEntityTitle))\n\t\t\t\t;\n\n\t\t\t\tinnerWrapper.appendChild(\n\t\t\t\t\tBX.create(\n\t\t\t\t\t\t'SPAN',\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\thtml: contentTemplate\n\t\t\t\t\t\t}\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tinnerWrapper.innerText = associatedEntityTitle;\n\t\t\t}\n\n\t\t\tcontent.appendChild(innerWrapper);\n\t\t}\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontent.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-content\" }, children: [ content ] })\n\t\t);\n\n\t\tif (!this.isReadOnly())\n\t\t\twrapper.appendChild(this.prepareFixedSwitcherLayout());\n\n\t\treturn wrapper;\n\t}\n\n\tprepareContextMenuItems()\n\t{\n\t\tconst menuItems = [];\n\n\t\tif (!this.isReadOnly())\n\t\t{\n\t\t\tif (this.isFixed() || this._fixedHistory.findItemById(this._id))\n\t\t\t\tmenuItems.push({ id: \"unfasten\", text: this.getMessage(\"menuUnfasten\"), onclick: BX.delegate(this.unfasten, this)});\n\t\t\telse\n\t\t\t\tmenuItems.push({ id: \"fasten\", text: this.getMessage(\"menuFasten\"), onclick: BX.delegate(this.fasten, this)});\n\t\t}\n\n\t\treturn menuItems;\n\t}\n\n\tview()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst associatedEntityTypeId = this.getAssociatedEntityTypeId();\n\t\tif(associatedEntityTypeId === BX.CrmEntityType.enumeration.activity)\n\t\t{\n\t\t\tconst id = BX.prop.getInteger(entityData, \"ID\", 0);\n\t\t\tif(id > 0)\n\t\t\t{\n\t\t\t\tthis._activityEditor.viewActivity(id);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst showUrl = BX.prop.getString(entityData, \"SHOW_URL\", \"\");\n\t\t\tif(showUrl !== \"\")\n\t\t\t{\n\t\t\t\tBX.Crm.Page.open(showUrl);\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Mark();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n\n\tstatic messages = {};\n}\n","import History from \"./history\";\nimport {EditorMode} from \"../types\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Comment extends History\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._isCollapsed = false;\n\t\tthis._isMenuShown = false;\n\t\tthis._isFixed = false;\n\t\tthis._hasFiles = false;\n\t\tthis._postForm = null;\n\t\tthis._editor = null;\n\t\tthis._commentMessage = '';\n\t\tthis._mode = EditorMode.view;\n\t\tthis._streamContentEventBlock = '';\n\t\tthis._playerWrappers = {};\n\t\tBX.Event.EventEmitter.subscribe(\n\t\t\t\"BX.Disk.Files:onShowFiles\",\n\t\t\tBX.delegate(this.addPlayer, this)\n\t\t);\n\t}\n\n\tdoInitialize()\n\t{\n\t\tsuper.doInitialize();\n\t\tthis._hasFiles = (this.getTextDataParam(\"HAS_FILES\") === 'Y');\n\t}\n\n\tgetTitle()\n\t{\n\t\treturn this.getMessage(\"comment\");\n\t}\n\n\tonPlayerDummyClick(file)\n\t{\n\t\tconst playerWrapper = this._playerWrappers[file.id];\n\t\tconst stubNode = playerWrapper.querySelector(\".crm-audio-cap-wrap\");\n\t\tif (stubNode)\n\t\t{\n\t\t\tBX.addClass(stubNode, \"crm-audio-cap-wrap-loader\");\n\t\t}\n\t\tthis._history.getManager().getAudioPlaybackRateSelector().addPlayer(\n\t\t\tthis._history.getManager().loadMediaPlayer(\n\t\t\t\t\"history_\" + this.getId() + '_' + file.id,\n\t\t\t\tfile.url,\n\t\t\t\t'audio/mp3',\n\t\t\t\tplayerWrapper,\n\t\t\t\tnull,\n\t\t\t\t{\n\t\t\t\t\tplaybackRate: this._history.getManager().getAudioPlaybackRateSelector().getRate()\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t}\n\n\taddPlayer(event)\n\t{\n\t\tif (event.data.entityValueId === parseInt(this.getId(), 10))\n\t\t{\n\t\t\tthis.files = event.data.files;\n\t\t\tevent.data.files.forEach(function(file){\n\t\t\t\tif (file.extension === 'mp3')\n\t\t\t\t{\n\t\t\t\t\tif (this._playerWrappers[file.id])\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tconst callInfoWrapper = BX.create(\"DIV\",\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\t\tclassName: \"crm-entity-stream-content-detail-call crm-entity-stream-content-detail-call-inline\"\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t\tthis._streamContentEventBlock.appendChild(callInfoWrapper);\n\t\t\t\t\tthis._playerWrappers[file.id] = this._history.getManager().renderAudioDummy(\n\t\t\t\t\t\tnull,\n\t\t\t\t\t\tthis.onPlayerDummyClick.bind(this, file)\n\t\t\t\t\t);\n\n\t\t\t\t\tthis._playerWrappers[file.id].firstElementChild.classList.add(\"crm-audio-cap-wrap-without-duration-text\");\n\n\t\t\t\t\tcallInfoWrapper.appendChild(\n\t\t\t\t\t\tthis._playerWrappers[file.id]\n\t\t\t\t\t);\n\t\t\t\t\tcallInfoWrapper.appendChild(\n\t\t\t\t\t\tthis._history.getManager().getAudioPlaybackRateSelector().render()\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}.bind(this));\n\t\t}\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst wrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-section crm-entity-stream-section-history crm-entity-stream-section-comment\"}\n\t\t\t}\n\t\t);\n\n\t\tif (this.isReadOnly())\n\t\t{\n\t\t\tBX.addClass(wrapper, \"crm-entity-stream-section-comment-read-only\");\n\t\t}\n\n\t\tif (this.isFixed())\n\t\t\tBX.addClass(wrapper, 'crm-entity-stream-section-top-fixed');\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{ attrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-comment\" } }\n\t\t\t)\n\t\t);\n\n\t\t//region Context Menu\n\t\tif(this.isContextMenuEnabled())\n\t\t{\n\t\t\twrapper.appendChild(this.prepareContextMenuButton());\n\t\t}\n\t\t//endregion\n\n\t\tthis._streamContentEventBlock = BX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-content-event\" } });\n\t\tconst header = this.prepareHeaderLayout();\n\n\t\tthis._streamContentEventBlock.appendChild(header);\n\n\t\tif (!this.isReadOnly())\n\t\t\twrapper.appendChild(this.prepareFixedSwitcherLayout());\n\n\t\tconst detailChildren = [];\n\t\tif (this._mode !== EditorMode.edit)\n\t\t{\n\t\t\tthis._commentWrapper = BX.create(\"DIV\", {\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-description\" }\n\t\t\t\t}\n\t\t\t);\n\t\t\tBX.html(this._commentWrapper, this.getTextDataParam(\"COMMENT\", \"\"));\n\t\t\tdetailChildren.push(this._commentWrapper);\n\n\t\t\tif (!this.isReadOnly())\n\t\t\t{\n\t\t\t\tBX.bind(this._commentWrapper, \"click\", BX.delegate(this.switchToEditMode, this));\n\t\t\t\tBX.bind(header, \"click\", BX.delegate(this.switchToEditMode, this));\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (!BX.type.isDomNode(this._editorContainer))\n\t\t\t\tthis._editorContainer = BX.create(\"div\", {attrs: {className: \"crm-entity-stream-section-comment-editor\"}});\n\n\t\t\tdetailChildren.push(this._editorContainer);\n\n\t\t\tconst buttons = BX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail-comment-edit-btn-container\"},\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"button\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattrs: {className: \"ui-btn ui-btn-xs ui-btn-primary\"},\n\t\t\t\t\t\t\t\t\thtml: this.getMessage(\"send\"),\n\t\t\t\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\t\t\t\tclick: BX.delegate(this.save, this)\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\tBX.create(\"a\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattrs: {className: \"ui-btn ui-btn-xs ui-btn-link\"},\n\t\t\t\t\t\t\t\t\thtml: this.getMessage(\"cancel\"),\n\t\t\t\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\t\t\t\tclick: BX.delegate(this.switchToViewMode, this)\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tdetailChildren.push(buttons);\n\t\t}\n\n\t\tthis._streamContentEventBlock.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail\" },\n\t\t\t\t\tchildren: detailChildren\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tthis._streamContentEventBlock.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\t\tconst cleanText = this.getTextDataParam(\"TEXT\", \"\");\n\t\tconst _hasInlineAttachment = (this.getTextDataParam(\"HAS_INLINE_ATTACHMENT\", \"\") === 'Y');\n\t\tif ((cleanText.length <= 128 && !_hasInlineAttachment) || this._mode === EditorMode.edit)\n\t\t{\n\t\t\tthis._isCollapsed = false;\n\n\t\t\twrapper.appendChild(\n\t\t\t\tBX.create(\"DIV\", {\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\tclassName: \"crm-entity-stream-section-content\"\n\t\t\t\t\t},\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tthis._streamContentEventBlock\n\t\t\t\t\t]\n\t\t\t\t})\n\t\t\t);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis._isCollapsed = true;\n\n\t\t\twrapper.appendChild(\n\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-content crm-entity-stream-section-content-collapsed\" },\n\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\tthis._streamContentEventBlock\n\t\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t);\n\n\t\t\twrapper.querySelector(\".crm-entity-stream-content-event\").appendChild(\n\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-content-expand-btn-container\" },\n\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tattrs:\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tclassName: \"crm-entity-stream-section-content-expand-btn\",\n\t\t\t\t\t\t\t\t\t\t\t\thref: \"#\"\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\tevents:\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tclick: BX.delegate(this.onExpandButtonClick, this)\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\ttext: this.getMessage(\"expand\")\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\n\t\tif (this._mode === EditorMode.view && this._hasFiles)\n\t\t{\n\t\t\tthis._textLoaded = false;\n\t\t\tthis._fileBlock = BX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-files-inner\" },\n\t\t\t\t\tchildren: [BX.create(\"DIV\", { attrs: { className: \"crm-timeline-wait\" }})]\n\t\t\t\t});\n\t\t\twrapper.querySelector(\".crm-entity-stream-section-content\").appendChild(\n\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-files\" },\n\t\t\t\t\t\tchildren: [this._fileBlock]\n\t\t\t\t\t})\n\t\t\t);\n\t\t\tBX.ready(BX.delegate(function() {\n\t\t\t\twindow.setTimeout(BX.delegate(function(){\n\t\t\t\t\tthis.loadContent(this._fileBlock, \"GET_FILE_BLOCK\")\n\t\t\t\t} ,this), 100);\n\t\t\t},this));\n\t\t}\n\n\t\treturn wrapper;\n\t}\n\n\tprepareActions()\n\t{\n\t\tif (this._mode === EditorMode.view && BX.type.isDomNode(this._commentWrapper))\n\t\t{\n\t\t\tthis.registerImages(this._commentWrapper);\n\t\t\tif (!BX.getClass('BX.Disk.apiVersion'))\n\t\t\t{\n\t\t\t\tBX.viewElementBind(\n\t\t\t\t\tthis._commentWrapper,\n\t\t\t\t\t{showTitle: true},\n\t\t\t\t\tfunction(node){\n\t\t\t\t\t\treturn BX.type.isElementNode(node) && (node.getAttribute('data-bx-viewer') || node.getAttribute('data-bx-image'));\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n\n\tloadContent(node, type)\n\t{\n\t\tif (!BX.type.isDomNode(node))\n\t\t\treturn;\n\n\t\tBX.ajax(\n\t\t\t{\n\t\t\t\turl: this._history._serviceUrl,\n\t\t\t\tmethod: \"POST\",\n\t\t\t\tdataType: \"json\",\n\t\t\t\tdata:\n\t\t\t\t\t{\n\t\t\t\t\t\t\"ACTION\": \"GET_COMMENT_CONTENT\",\n\t\t\t\t\t\t\"ID\": this.getId(),\n\t\t\t\t\t\t\"ENTITY_TYPE_ID\": this.getOwnerTypeId(),\n\t\t\t\t\t\t\"ENTITY_ID\": this.getOwnerId(),\n\t\t\t\t\t\t\"TYPE\": type\n\t\t\t\t\t},\n\t\t\t\tonsuccess: BX.delegate(function(result)\n\t\t\t\t{\n\t\t\t\t\tif (BX.type.isNotEmptyString(result.ERROR) && type === 'GET_FILE_BLOCK')\n\t\t\t\t\t{\n\t\t\t\t\t\tBX.remove(node);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (BX.type.isNotEmptyString(result.BLOCK))\n\t\t\t\t\t{\n\t\t\t\t\t\tconst promise = BX.html(node, result.BLOCK);\n\t\t\t\t\t\tpromise.then(\n\t\t\t\t\t\t\tBX.delegate(function(){\n\t\t\t\t\t\t\t\tthis.registerImages(node);\n\t\t\t\t\t\t\t\tBX.LazyLoad.showImages();\n\t\t\t\t\t\t\t}, this)\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}, this)\n\t\t\t}\n\t\t);\n\t}\n\n\tloadEditor()\n\t{\n\t\tthis._editorName = 'CrmTimeLineComment'+this._id + BX.util.getRandomString(4);\n\t\tif (this._postForm)\n\t\t{\n\t\t\tthis._postForm.oEditor.SetContent(this._commentMessage);\n\t\t\tthis._editor.ReInitIframe();\n\t\t\treturn;\n\t\t}\n\n\t\tconst actionData = {\n\t\t\tdata: {\n\t\t\t\tid: this._id,\n\t\t\t\tname: this._editorName\n\t\t\t}\n\t\t};\n\t\tBX.ajax.runAction(\"crm.api.timeline.loadEditor\", actionData)\n\t\t\t.then(this.onLoadEditorSuccess.bind(this))\n\t\t\t.catch(\tthis.switchToViewMode.bind(this));\n\t}\n\n\tonLoadEditorSuccess(result)\n\t{\n\t\tif (!BX.type.isDomNode(this._editorContainer))\n\t\t\tthis._editorContainer = BX.create(\"div\", {attrs: {className: \"crm-entity-stream-section-comment-editor\"}});\n\n\t\tconst html = BX.prop.getString(BX.prop.getObject(result, \"data\", {}), \"html\", '');\n\t\tBX.html(this._editorContainer, html).then(BX.delegate(this.showEditor,this));\n\t}\n\n\tshowEditor()\n\t{\n\t\tif (LHEPostForm)\n\t\t{\n\t\t\twindow.setTimeout(BX.delegate(function(){\n\t\t\t\tthis._postForm = LHEPostForm.getHandler(this._editorName);\n\t\t\t\tthis._editor = BXHtmlEditor.Get(this._editorName);\n\t\t\t\tBX.onCustomEvent(this._postForm.eventNode, 'OnShowLHE', [true]);\n\t\t\t\tthis._commentMessage = this._postForm.oEditor.GetContent();\n\t\t\t} ,this), 0);\n\t\t}\n\t}\n\n\tregisterImages(node)\n\t{\n\t\tconst commentImages = node.querySelectorAll('[data-bx-viewer=\"image\"]');\n\t\tconst commentImagesLength = commentImages.length;\n\t\tconst idsList = [];\n\t\tif (commentImagesLength > 0)\n\t\t{\n\t\t\tfor (let i = 0; i < commentImagesLength; ++i)\n\t\t\t{\n\t\t\t\tif (BX.type.isDomNode(commentImages[i]))\n\t\t\t\t{\n\t\t\t\t\tcommentImages[i].id += BX.util.getRandomString(4);\n\t\t\t\t\tidsList.push(commentImages[i].id);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (idsList.length > 0)\n\t\t\t{\n\t\t\t\tBX.LazyLoad.registerImages(idsList);\n\t\t\t}\n\t\t}\n\t\tBX.LazyLoad.registerImages(idsList);\n\t}\n\n\ttoggleMode(type)\n\t{\n\t\tthis._mode = parseInt(type);\n\t\tthis._hasFiles = (this.getTextDataParam(\"HAS_FILES\") === 'Y');\n\t\tthis.refreshLayout();\n\t\tthis.closeContextMenu();\n\t}\n\n\tswitchToViewMode(e)\n\t{\n\t\t// if (LHEPostForm)\n\t\t// \tLHEPostForm.unsetHandler(this._editorName);\n\t\tthis.toggleMode(EditorMode.view);\n\t}\n\n\tswitchToEditMode(e)\n\t{\n\t\tconst tagName = e.target.tagName.toLowerCase();\n\t\tif (tagName === 'a'\n\t\t\t|| tagName === 'img'\n\t\t\t|| BX.hasClass(e.target, \"feed-con-file-changes-link-more\")\n\t\t\t|| BX.hasClass(e.target, \"feed-com-file-inline\")\n\t\t\t|| BX.type.isNotEmptyString(document.getSelection().toString())\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.toggleMode(EditorMode.edit);\n\t\twindow.setTimeout(BX.delegate(function(){\n\t\t\tthis.loadEditor();\n\t\t} ,this), 100);\n\t}\n\n\tprepareContextMenuItems()\n\t{\n\t\tif(this._isMenuShown)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst menuItems = [];\n\n\t\tif (!this.isReadOnly())\n\t\t{\n\t\t\tif (this._mode !== EditorMode.edit)\n\t\t\t{\n\t\t\t\tmenuItems.push({ id: \"edit\", text: this.getMessage(\"menuEdit\"), onclick: BX.delegate(this.switchToEditMode, this)});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tmenuItems.push({ id: \"cancel\", text: this.getMessage(\"menuCancel\"), onclick: BX.delegate(this.switchToViewMode, this)});\n\t\t\t}\n\n\t\t\tmenuItems.push({ id: \"remove\", text: this.getMessage(\"menuDelete\"), onclick: BX.delegate(this.processRemoval, this)});\n\n\t\t\tif (this.isFixed() || this._fixedHistory.findItemById(this._id))\n\t\t\t\tmenuItems.push({ id: \"unfasten\", text: this.getMessage(\"menuUnfasten\"), onclick: BX.delegate(this.unfasten, this)});\n\t\t\telse\n\t\t\t\tmenuItems.push({ id: \"fasten\", text: this.getMessage(\"menuFasten\"), onclick: BX.delegate(this.fasten, this)});\n\t\t}\n\n\t\treturn menuItems;\n\t}\n\n\tsave(e)\n\t{\n\t\tconst attachmentList = [];\n\t\tlet text = \"\";\n\t\tif (this._postForm)\n\t\t{\n\t\t\ttext = this._postForm.oEditor.GetContent();\n\t\t\tthis._commentMessage = text;\n\t\t\tthis._postForm.eventNode\n\t\t\t\t.querySelectorAll('input[name=\"UF_CRM_COMMENT_FILES[]\"]')\n\t\t\t\t.forEach(function(input) {\n\t\t\t\t\tattachmentList.push(input.value)\n\t\t\t\t});\n\t\t}\n\n\t\tif (!BX.type.isNotEmptyString(text))\n\t\t{\n\t\t\tif (!this.emptyCommentMessage)\n\t\t\t{\n\t\t\t\tthis.emptyCommentMessage = new BX.PopupWindow(\n\t\t\t\t\t'timeline_empty_comment_' + this._id,\n\t\t\t\t\te.target,\n\t\t\t\t\t{\n\t\t\t\t\t\tcontent: BX.message('CRM_TIMELINE_EMPTY_COMMENT_MESSAGE'),\n\t\t\t\t\t\tdarkMode: true,\n\t\t\t\t\t\tautoHide: true,\n\t\t\t\t\t\tzIndex: 990,\n\t\t\t\t\t\tangle: {position: 'top', offset: 77},\n\t\t\t\t\t\tcloseByEsc: true,\n\t\t\t\t\t\tbindOptions: { forceBindPosition: true}\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tthis.emptyCommentMessage.show();\n\t\t\treturn;\n\t\t}\n\n\t\tif(this._isRequestRunning && BX.type.isNotEmptyString(text))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis._isRequestRunning = true;\n\t\tBX.ajax(\n\t\t\t{\n\t\t\t\turl: this._history._serviceUrl,\n\t\t\t\tmethod: \"POST\",\n\t\t\t\tdataType: \"json\",\n\t\t\t\tdata:\n\t\t\t\t\t{\n\t\t\t\t\t\t\"ACTION\": \"UPDATE_COMMENT\",\n\t\t\t\t\t\t\"ID\": this.getId(),\n\t\t\t\t\t\t\"TEXT\": text,\n\t\t\t\t\t\t\"OWNER_TYPE_ID\":  this.getOwnerTypeId(),\n\t\t\t\t\t\t\"OWNER_ID\": this.getOwnerId(),\n\t\t\t\t\t\t\"ATTACHMENTS\": attachmentList\n\t\t\t\t\t},\n\t\t\t\tonsuccess: BX.delegate(this.onSaveSuccess, this),\n\t\t\t\tonfailure: BX.delegate(this.onRequestFailure, this)\n\t\t\t}\n\t\t);\n\t}\n\n\tprocessRemoval()\n\t{\n\t\tthis.closeContextMenu();\n\t\tthis._detetionConfirmDlgId = \"entity_timeline_deletion_\" + this.getId() + \"_confirm\";\n\t\tlet dlg = BX.Crm.ConfirmationDialog.get(this._detetionConfirmDlgId);\n\t\tif(!dlg)\n\t\t{\n\t\t\tdlg = BX.Crm.ConfirmationDialog.create(\n\t\t\t\tthis._detetionConfirmDlgId,\n\t\t\t\t{\n\t\t\t\t\ttitle: this.getMessage(\"removeConfirmTitle\"),\n\t\t\t\t\tcontent: this.getMessage('commentRemove')\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\tdlg.open().then(BX.delegate(this.onRemovalConfirm, this), BX.delegate(this.onRemovalCancel, this));\n\t}\n\n\tonRemovalConfirm(result)\n\t{\n\t\tif(BX.prop.getBoolean(result, \"cancel\", true))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.remove();\n\t}\n\n\tonRemovalCancel()\n\t{\n\t}\n\n\tremove(e)\n\t{\n\t\tif(this._isRequestRunning)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst history = this._history._manager.getHistory();\n\t\tconst deleteItem = history.findItemById(this._id);\n\t\tif (deleteItem instanceof Comment)\n\t\t\tdeleteItem.clearAnimate();\n\n\t\tconst fixedHistory = this._history._manager.getFixedHistory();\n\t\tconst deleteFixedItem = fixedHistory.findItemById(this._id);\n\t\tif (deleteFixedItem instanceof Comment)\n\t\t\tdeleteFixedItem.clearAnimate();\n\n\t\tthis._isRequestRunning = true;\n\t\tBX.ajax(\n\t\t\t{\n\t\t\t\turl: this._history._serviceUrl,\n\t\t\t\tmethod: \"POST\",\n\t\t\t\tdataType: \"json\",\n\t\t\t\tdata:\n\t\t\t\t\t{\n\t\t\t\t\t\t\"ACTION\": \"DELETE_COMMENT\",\n\t\t\t\t\t\t\"OWNER_TYPE_ID\":  this.getOwnerTypeId(),\n\t\t\t\t\t\t\"OWNER_ID\": this.getOwnerId(),\n\t\t\t\t\t\t\"ID\": this.getId()\n\t\t\t\t\t},\n\t\t\t\tonsuccess: BX.delegate(this.onRemoveSuccess, this),\n\t\t\t\tonfailure: BX.delegate(this.onRequestFailure, this)\n\t\t\t}\n\t\t);\n\t}\n\n\trefreshLayout()\n\t{\n\t\tthis._playerWrappers = {};\n\t\tsuper.refreshLayout();\n\t}\n\n\tonSaveSuccess(data)\n\t{\n\t\tthis._isRequestRunning = false;\n\t\tconst itemData = BX.prop.getObject(data, \"HISTORY_ITEM\");\n\n\t\tconst updateFixedItem = this._fixedHistory.findItemById(this._id);\n\t\tif (updateFixedItem instanceof Comment)\n\t\t{\n\t\t\tif (!BX.type.isNotEmptyString(itemData['IS_FIXED']))\n\t\t\t\titemData['IS_FIXED'] = 'Y';\n\n\t\t\tupdateFixedItem.setData(itemData);\n\t\t\tupdateFixedItem._id = BX.prop.getString(itemData, \"ID\");\n\t\t\tupdateFixedItem.switchToViewMode();\n\t\t}\n\n\t\tconst updateItem = this._history.findItemById(this._id);\n\t\tif (updateItem instanceof Comment)\n\t\t{\n\t\t\tupdateItem.setData(itemData);\n\t\t\tupdateItem._id = BX.prop.getString(itemData, \"ID\");\n\t\t\tupdateItem.switchToViewMode();\n\t\t}\n\n\t\tthis._postForm = null;\n\t}\n\n\tonRemoveSuccess(data)\n\t{\n\t}\n\n\tonRequestFailure(data)\n\t{\n\t\tthis._isRequestRunning = this._isLocked = false;\n\t}\n\n\tonExpandButtonClick(e)\n\t{\n\t\tif(!this._wrapper)\n\t\t{\n\t\t\treturn BX.PreventDefault(e);\n\t\t}\n\n\t\tconst contentWrapper = this._wrapper.querySelector(\"div.crm-entity-stream-section-content\");\n\t\tif(!contentWrapper)\n\t\t{\n\t\t\treturn BX.PreventDefault(e);\n\t\t}\n\n\t\tif (this._hasFiles && BX.type.isDomNode(this._commentWrapper) && !this._textLoaded)\n\t\t{\n\t\t\tthis._textLoaded = true;\n\t\t\tthis.loadContent(this._commentWrapper, \"GET_TEXT\")\n\t\t}\n\t\tconst eventWrapper = contentWrapper.querySelector(\".crm-entity-stream-content-event\");\n\t\tif(this._isCollapsed)\n\t\t{\n\t\t\teventWrapper.style.maxHeight = eventWrapper.scrollHeight + 130 + \"px\";\n\t\t\tBX.removeClass(contentWrapper, \"crm-entity-stream-section-content-collapsed\");\n\t\t\tBX.addClass(contentWrapper, \"crm-entity-stream-section-content-expand\");\n\t\t\tsetTimeout(\n\t\t\t\tBX.delegate(function() {\n\t\t\t\t\teventWrapper.style.maxHeight = \"\";\n\t\t\t\t}, this),\n\t\t\t\t300\n\t\t\t);\n\t\t}\n\t\telse\n\t\t{\n\t\t\teventWrapper.style.maxHeight = eventWrapper.clientHeight + \"px\";\n\t\t\tBX.removeClass(contentWrapper, \"crm-entity-stream-section-content-expand\");\n\t\t\tBX.addClass(contentWrapper, \"crm-entity-stream-section-content-collapsed\");\n\t\t\tsetTimeout(\n\t\t\t\tBX.delegate(function() {\n\t\t\t\t\teventWrapper.style.maxHeight = \"\";\n\t\t\t\t}, this),\n\t\t\t\t0\n\t\t\t);\n\t\t}\n\n\t\tthis._isCollapsed = !this._isCollapsed;\n\n\t\tconst button = contentWrapper.querySelector(\"a.crm-entity-stream-section-content-expand-btn\");\n\t\tif(button)\n\t\t{\n\t\t\tbutton.innerHTML = this.getMessage(this._isCollapsed ? \"expand\" : \"collapse\");\n\t\t}\n\t\treturn BX.PreventDefault(e);\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Comment();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import HistoryActivity from \"./history-activity\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Wait extends HistoryActivity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetTitle()\n\t{\n\t\treturn this.getMessage(\"wait\");\n\t}\n\n\tprepareTitleLayout()\n\t{\n\t\treturn BX.create(\"SPAN\", {\n\t\t\tattrs:{ className: \"crm-entity-stream-content-event-title\"},\n\t\t\tchildren: [\n\t\t\t\tBX.create(\"A\", {\n\t\t\t\t\tattrs: { href: \"#\" },\n\t\t\t\t\tevents: { \"click\": this._headerClickHandler },\n\t\t\t\t\ttext: this.getTitle()\n\t\t\t\t})\n\t\t\t]\n\t\t});\n\n\n\t}\n\n\tprepareTimeLayout()\n\t{\n\t\treturn BX.create(\"SPAN\",\n\t\t\t{\n\t\t\t\tattrs: { className: \"crm-entity-stream-content-event-time\" },\n\t\t\t\ttext: this.formatTime(this.getCreatedTime())\n\t\t\t}\n\t\t);\n\t}\n\n\tprepareHeaderLayout()\n\t{\n\t\tconst header = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-header\"}});\n\t\theader.appendChild(this.prepareTitleLayout());\n\t\theader.appendChild(this.prepareTimeLayout());\n\n\t\treturn header;\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tlet description = BX.prop.getString(entityData, \"DESCRIPTION_RAW\", \"\");\n\t\tif(description !== \"\")\n\t\t{\n\t\t\tdescription = BX.util.trim(description);\n\t\t\tdescription = BX.util.strip_tags(description);\n\t\t\tdescription = BX.util.nl2br(description);\n\t\t}\n\n\t\tconst wrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-section crm-entity-stream-section-history crm-entity-stream-section-wait\"}\n\t\t\t}\n\t\t);\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-complete\" }\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst contentWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\tchildren: [contentWrapper]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst header = this.prepareHeaderLayout();\n\t\tcontentWrapper.appendChild(header);\n\n\t\tconst detailWrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail\"},\n\t\t\t\thtml: description\n\t\t\t}\n\t\t);\n\t\tcontentWrapper.appendChild(detailWrapper);\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontentWrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\t//region  Actions\n\t\tthis._actionContainer = BX.create(\"SPAN\", { attrs: { className: \"crm-entity-stream-content-detail-action\" } });\n\t\tcontentWrapper.appendChild(this._actionContainer);\n\t\t//endregion\n\n\t\treturn wrapper;\n\t}\n\n\tprepareActions()\n\t{\n\t}\n\n\tshowActions(show)\n\t{\n\t\tif(this._actionContainer)\n\t\t{\n\t\t\tthis._actionContainer.style.display = show ? \"\" : \"none\";\n\t\t}\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Wait();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import HistoryActivity from \"./history-activity\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Document extends HistoryActivity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetTitle()\n\t{\n\t\tconst typeCategoryId = BX.prop.getInteger(this._data, \"TYPE_CATEGORY_ID\", 0);\n\t\tif(typeCategoryId === 3)\n\t\t{\n\t\t\treturn BX.Loc.getMessage('CRM_TIMELINE_DOCUMENT_VIEWED');\n\t\t}\n\n\t\treturn this.getMessage(\"document\");\n\t}\n\n\tprepareTitleLayout()\n\t{\n\t\treturn BX.create(\"SPAN\", {\n\t\t\tattrs:{ className: \"crm-entity-stream-content-event-title\"},\n\t\t\tchildren: [\n\t\t\t\tBX.create(\"A\", {\n\t\t\t\t\tattrs: { href: \"#\" },\n\t\t\t\t\tevents: { \"click\": BX.delegate(this.editDocument, this) },\n\t\t\t\t\ttext: this.getTitle()\n\t\t\t\t})\n\t\t\t]\n\t\t});\n\t}\n\n\tprepareTitleStatusLayout()\n\t{\n\t\tconst typeCategoryId = BX.prop.getInteger(this._data, \"TYPE_CATEGORY_ID\", 0);\n\t\tif(typeCategoryId === 3)\n\t\t{\n\t\t\treturn BX.create(\"SPAN\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-event-done\" },\n\t\t\t\t\ttext: BX.Loc.getMessage('CRM_TIMELINE_DOCUMENT_VIEWED_STATUS')\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\tif(typeCategoryId === 2)\n\t\t{\n\t\t\treturn BX.create(\"SPAN\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-event-sent\" },\n\t\t\t\t\ttext: BX.Loc.getMessage('CRM_TIMELINE_DOCUMENT_CREATED_STATUS')\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tprepareTimeLayout()\n\t{\n\t\treturn BX.create(\"SPAN\",\n\t\t\t{\n\t\t\t\tattrs: { className: \"crm-entity-stream-content-event-time\" },\n\t\t\t\ttext: this.formatTime(this.getCreatedTime())\n\t\t\t}\n\t\t);\n\t}\n\n\tisContextMenuEnabled()\n\t{\n\t\tconst typeCategoryId = BX.prop.getInteger(this._data, \"TYPE_CATEGORY_ID\", 0);\n\n\t\treturn typeCategoryId !== 3;\n\t}\n\n\tprepareHeaderLayout()\n\t{\n\t\tconst header = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-header\"}});\n\t\theader.appendChild(this.prepareTitleLayout());\n\t\tconst statusLayout = this.prepareTitleStatusLayout();\n\t\tif(statusLayout)\n\t\t{\n\t\t\theader.appendChild(statusLayout);\n\t\t}\n\t\theader.appendChild(this.prepareTimeLayout());\n\n\t\treturn header;\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst text = this.getTextDataParam(\"COMMENT\", \"\");\n\n\t\tconst wrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-section crm-entity-stream-section-history crm-entity-stream-section-document\"}\n\t\t\t}\n\t\t);\n\n\t\tif(this.isFixed())\n\t\t{\n\t\t\tBX.addClass(wrapper, 'crm-entity-stream-section-top-fixed');\n\t\t}\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-document\" }\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tif(this.isContextMenuEnabled())\n\t\t{\n\t\t\twrapper.appendChild(this.prepareContextMenuButton());\n\t\t}\n\n\t\tif(!this.isReadOnly())\n\t\t{\n\t\t\twrapper.appendChild(this.prepareFixedSwitcherLayout());\n\t\t}\n\n\t\tconst contentWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\tchildren: [contentWrapper]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst header = this.prepareHeaderLayout();\n\t\tcontentWrapper.appendChild(header);\n\n\t\tconst detailWrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail\"},\n\t\t\t\thtml: text\n\t\t\t}\n\t\t);\n\t\tconst title = BX.findChildByClassName(detailWrapper, 'document-title-link');\n\t\tif(title)\n\t\t{\n\t\t\tBX.bind(title, 'click', BX.proxy(this.editDocument, this));\n\t\t}\n\t\tcontentWrapper.appendChild(detailWrapper);\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontentWrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\t//region  Actions\n\t\tthis._actionContainer = BX.create(\"SPAN\", { attrs: { className: \"crm-entity-stream-content-detail-action\" } });\n\t\tcontentWrapper.appendChild(this._actionContainer);\n\t\t//endregion\n\n\t\treturn wrapper;\n\t}\n\n\tprepareActions()\n\t{\n\t}\n\n\tshowActions(show)\n\t{\n\t\tif(this._actionContainer)\n\t\t{\n\t\t\tthis._actionContainer.style.display = show ? \"\" : \"none\";\n\t\t}\n\t}\n\n\tprepareContextMenuItems()\n\t{\n\t\tconst menuItems = [];\n\n\t\tif(!this.isReadOnly())\n\t\t{\n\t\t\tmenuItems.push({ id: \"edit\", text: this.getMessage(\"menuEdit\"), onclick: BX.delegate(this.editDocument, this)});\n\t\t\tmenuItems.push({ id: \"remove\", text: this.getMessage(\"menuDelete\"), onclick: BX.delegate(this.confirmDelete, this)});\n\n\t\t\tif (this.isFixed() || this._fixedHistory.findItemById(this._id))\n\t\t\t{\n\t\t\t\tmenuItems.push({ id: \"unfasten\", text: this.getMessage(\"menuUnfasten\"), onclick: BX.delegate(this.unfasten, this)});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tmenuItems.push({ id: \"fasten\", text: this.getMessage(\"menuFasten\"), onclick: BX.delegate(this.fasten, this)});\n\t\t\t}\n\t\t}\n\n\t\treturn menuItems;\n\t}\n\n\tconfirmDelete()\n\t{\n\t\tthis.closeContextMenu();\n\t\tthis._detetionConfirmDlgId = \"entity_timeline_deletion_\" + this.getId() + \"_confirm\";\n\t\tlet dlg = BX.Crm.ConfirmationDialog.get(this._detetionConfirmDlgId);\n\t\tif(!dlg)\n\t\t{\n\t\t\tdlg = BX.Crm.ConfirmationDialog.create(\n\t\t\t\tthis._detetionConfirmDlgId,\n\t\t\t\t{\n\t\t\t\t\ttitle: this.getMessage(\"removeConfirmTitle\"),\n\t\t\t\t\tcontent: this.getMessage('documentRemove')\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\tdlg.open().then(BX.delegate(this.onConfirmDelete, this), BX.DoNothing);\n\t}\n\n\tonConfirmDelete(result)\n\t{\n\t\tif(BX.prop.getBoolean(result, \"cancel\", true))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.deleteDocument();\n\t}\n\n\tdeleteDocument()\n\t{\n\t\tif(this._isRequestRunning)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tthis._isRequestRunning = true;\n\t\tBX.ajax(\n\t\t\t{\n\t\t\t\turl: this._history._serviceUrl,\n\t\t\t\tmethod: \"POST\",\n\t\t\t\tdataType: \"json\",\n\t\t\t\tdata:\n\t\t\t\t\t{\n\t\t\t\t\t\t\"ACTION\": \"DELETE_DOCUMENT\",\n\t\t\t\t\t\t\"OWNER_TYPE_ID\":  this.getOwnerTypeId(),\n\t\t\t\t\t\t\"OWNER_ID\": this.getOwnerId(),\n\t\t\t\t\t\t\"ID\": this.getId()\n\t\t\t\t\t},\n\t\t\t\tonsuccess: BX.delegate(function(result)\n\t\t\t\t{\n\t\t\t\t\tthis._isRequestRunning = false;\n\t\t\t\t\tif(BX.type.isNotEmptyString(result.ERROR))\n\t\t\t\t\t{\n\t\t\t\t\t\talert(result.ERROR);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tconst deleteItem = this._history.findItemById(this._id);\n\t\t\t\t\t\tif (deleteItem instanceof Document)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tdeleteItem.clearAnimate();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst deleteFixedItem = this._fixedHistory.findItemById(this._id);\n\t\t\t\t\t\tif (deleteFixedItem instanceof Document)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tdeleteFixedItem.clearAnimate();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}, this),\n\t\t\t\tonfailure: BX.delegate(function()\n\t\t\t\t{\n\t\t\t\t\tthis._isRequestRunning = false;\n\t\t\t\t}, this)\n\t\t\t}\n\t\t);\n\t}\n\n\teditDocument()\n\t{\n\t\tconst documentId = this.getData().DOCUMENT_ID || 0;\n\t\tif(documentId > 0)\n\t\t{\n\t\t\tlet url = '/bitrix/components/bitrix/crm.document.view/slider.php';\n\t\t\turl = BX.util.add_url_param(url, {documentId: documentId});\n\t\t\tif(BX.SidePanel)\n\t\t\t{\n\t\t\t\tBX.SidePanel.Instance.open(url, {width: 1060});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\ttop.location.href = url;\n\t\t\t}\n\t\t}\n\t}\n\n\tupdateWrapper()\n\t{\n\t\tconst wrapper = this.getWrapper();\n\t\tif(wrapper)\n\t\t{\n\t\t\tconst detailWrapper = BX.findChildByClassName(wrapper, 'crm-entity-stream-content-detail');\n\t\t\tif(detailWrapper)\n\t\t\t{\n\t\t\t\tBX.adjust(detailWrapper, {html: this.getTextDataParam(\"COMMENT\", \"\")});\n\t\t\t\tconst title = BX.findChildByClassName(detailWrapper, 'document-title-link');\n\t\t\t\tif(title)\n\t\t\t\t{\n\t\t\t\t\tBX.bind(title, 'click', BX.proxy(this.editDocument, this));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Document();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import HistoryActivity from \"./history-activity\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Sender extends HistoryActivity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetDataSetting(name)\n\t{\n\t\tconst settings = this.getObjectDataParam('SETTINGS') || {};\n\t\treturn settings[name] || null;\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = Sender.messages;\n\t\treturn m.hasOwnProperty(name) ? m[name] : name;\n\t}\n\n\tgetTitle()\n\t{\n\t\treturn this.getDataSetting('messageName');\n\t}\n\n\tprepareTitleLayout()\n\t{\n\t\tconst self = this;\n\t\treturn BX.create(\"SPAN\", {\n\t\t\tattrs:{ className: \"crm-entity-stream-content-event-title\"},\n\t\t\tchildren: [\n\t\t\t\tthis.isRemoved()\n\t\t\t\t\t?\n\t\t\t\t\tBX.create(\"SPAN\", {text: this.getTitle()})\n\t\t\t\t\t:\n\t\t\t\t\tBX.create(\"A\", {\n\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\thref: \"\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\t\"click\": function (e)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tif (BX.SidePanel)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tBX.SidePanel.Instance.open(self.getDataSetting('path'));\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\ttop.location.href = self.getDataSetting('path');\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\ttext: this.getTitle()\n\t\t\t\t\t})\n\t\t\t]\n\t\t});\n\n\n\t}\n\n\tprepareTimeLayout()\n\t{\n\t\treturn BX.create(\"SPAN\",\n\t\t\t{\n\t\t\t\tattrs: { className: \"crm-entity-stream-content-event-time\" },\n\t\t\t\ttext: this.formatTime(this.getCreatedTime())\n\t\t\t}\n\t\t);\n\t}\n\n\tprepareStatusLayout()\n\t{\n\t\tlet layoutClassName, textCaption;\n\t\tif (this.getDataSetting('isError'))\n\t\t{\n\t\t\ttextCaption = this.getMessage('error');\n\t\t\tlayoutClassName = \"crm-entity-stream-content-event-missing\";\n\t\t}\n\t\telse if (this.getDataSetting('isUnsub'))\n\t\t{\n\t\t\ttextCaption = this.getMessage('unsub');\n\t\t\tlayoutClassName = \"crm-entity-stream-content-event-missing\";\n\t\t}\n\t\telse if (this.getDataSetting('isClick'))\n\t\t{\n\t\t\ttextCaption = this.getMessage('click');\n\t\t\tlayoutClassName = \"crm-entity-stream-content-event-successful\";\n\t\t}\n\t\telse\n\t\t{\n\t\t\ttextCaption = this.getMessage('read');\n\t\t\tlayoutClassName = \"crm-entity-stream-content-event-skipped\";\n\t\t}\n\n\t\treturn BX.create(\"SPAN\", {attrs: {className: layoutClassName}, text: textCaption});\n\t}\n\n\tprepareHeaderLayout()\n\t{\n\t\tconst header = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-header\"}});\n\t\theader.appendChild(this.prepareTitleLayout());\n\t\tif (this.getDataSetting('isError') || this.getDataSetting('isRead') || this.getDataSetting('isUnsub'))\n\t\t{\n\t\t\theader.appendChild(this.prepareStatusLayout());\n\t\t}\n\t\theader.appendChild(this.prepareTimeLayout());\n\n\t\treturn header;\n\t}\n\n\tisRemoved()\n\t{\n\t\treturn !this.getDataSetting('letterTitle');\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst description = this.isRemoved() ? this.getMessage('removed') : this.getMessage('title') + ': ' + this.getDataSetting('letterTitle');\n\n\t\tconst wrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-section crm-entity-stream-section-history crm-entity-stream-section-wait\"}\n\t\t\t}\n\t\t);\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-complete\" }\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst contentWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\tchildren: [contentWrapper]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst header = this.prepareHeaderLayout();\n\t\tcontentWrapper.appendChild(header);\n\n\t\tconst detailWrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail\"},\n\t\t\t\thtml: description\n\t\t\t}\n\t\t);\n\t\tcontentWrapper.appendChild(detailWrapper);\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontentWrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\treturn wrapper;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Sender();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import History from \"./history\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Bizproc extends History\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetTitle()\n\t{\n\t\tconst type = this.getTextDataParam(\"TYPE\");\n\t\tif (type === 'AUTOMATION_DEBUG_INFORMATION')\n\t\t{\n\t\t\treturn this.getMessage('automationDebugger');\n\t\t}\n\n\t\treturn this.getMessage(\"bizproc\");\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst wrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-section crm-entity-stream-section-history crm-entity-stream-section-bp\"}\n\t\t\t}\n\t\t);\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{ attrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-bp\" } }\n\t\t\t)\n\t\t);\n\n\t\tconst content = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\tconst header = this.prepareHeaderLayout();\n\n\t\tcontent.appendChild(header);\n\t\tcontent.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail\" },\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-description\" },\n\t\t\t\t\t\t\t\t\thtml: this.prepareContentTextHtml()\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontent.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-content\" }, children: [ content ] })\n\t\t);\n\n\t\treturn wrapper;\n\t}\n\n\tprepareContentTextHtml()\n\t{\n\t\tconst type = this.getTextDataParam(\"TYPE\");\n\t\tif (type === 'ACTIVITY_ERROR')\n\t\t{\n\t\t\treturn '<strong>#TITLE#</strong>: #ERROR_TEXT#'\n\t\t\t\t.replace('#TITLE#', BX.util.htmlspecialchars(this.getTextDataParam(\"ACTIVITY_TITLE\")))\n\t\t\t\t.replace('#ERROR_TEXT#', BX.util.htmlspecialchars(this.getTextDataParam(\"ERROR_TEXT\")))\n\t\t}\n\t\telse if (type === 'AUTOMATION_DEBUG_INFORMATION')\n\t\t{\n\t\t\treturn BX.Text.encode(this.getTextDataParam('AUTOMATION_DEBUG_TEXT'));\n\t\t}\n\n\t\tconst workflowName = this.getTextDataParam(\"WORKFLOW_TEMPLATE_NAME\");\n\t\tconst workflowStatus = this.getTextDataParam(\"WORKFLOW_STATUS_NAME\");\n\t\tif (!workflowName\n\t\t\t|| workflowStatus !== 'Created' && workflowStatus !== 'Completed' && workflowStatus !== 'Terminated'\n\t\t)\n\t\t{\n\t\t\treturn BX.util.htmlspecialchars(this.getTextDataParam(\"COMMENT\"));\n\t\t}\n\n\t\tlet label = BX.message('CRM_TIMELINE_BIZPROC_CREATED');\n\t\tif (workflowStatus === 'Completed')\n\t\t{\n\t\t\tlabel = BX.message('CRM_TIMELINE_BIZPROC_COMPLETED');\n\t\t}\n\t\telse if (workflowStatus === 'Terminated')\n\t\t{\n\t\t\tlabel = BX.message('CRM_TIMELINE_BIZPROC_TERMINATED');\n\t\t}\n\n\t\treturn BX.util.htmlspecialchars(label)\n\t\t\t.replace('#NAME#', '<strong>' + BX.util.htmlspecialchars(workflowName) + '</strong>');\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Bizproc();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import History from \"./history\";\n\n/** @memberof BX.Crm.Timeline.Actions */\nexport default class Scoring extends History\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst outerWrapper = BX.create(\"DIV\", {\n\t\t\tattrs: {\n\t\t\t\tclassName: \"crm-entity-stream-section crm-entity-stream-section-history crm-entity-stream-section-scoring\"\n\t\t\t},\n\t\t\tevents: {\n\t\t\t\tclick: function () {\n\t\t\t\t\tlet url = \"/crm/ml/#entity#/#id#/detail\";\n\t\t\t\t\tconst ownerTypeId = this.getOwnerTypeId();\n\t\t\t\t\tconst ownerId = this.getOwnerId();\n\n\t\t\t\t\tlet ownerType;\n\t\t\t\t\tif (ownerTypeId === 1)\n\t\t\t\t\t{\n\t\t\t\t\t\townerType = \"lead\";\n\t\t\t\t\t}\n\t\t\t\t\telse if (ownerTypeId === 2)\n\t\t\t\t\t{\n\t\t\t\t\t\townerType = \"deal\";\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\turl = url.replace(\"#entity#\", ownerType);\n\t\t\t\t\turl = url.replace(\"#id#\", ownerId);\n\n\t\t\t\t\tif (BX.SidePanel)\n\t\t\t\t\t{\n\t\t\t\t\t\tBX.SidePanel.Instance.open(url, {width: 840});\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\ttop.location.href = url;\n\t\t\t\t\t}\n\t\t\t\t}.bind(this)\n\t\t\t}\n\t\t});\n\n\t\tconst scoringInfo = BX.prop.getObject(this._data, \"SCORING_INFO\", null);\n\t\tif(!scoringInfo)\n\t\t{\n\t\t\treturn outerWrapper;\n\t\t}\n\n\t\tlet score = BX.prop.getNumber(scoringInfo, \"SCORE\", 0);\n\t\tlet scoreDelta = BX.prop.getNumber(scoringInfo, \"SCORE_DELTA\", 0);\n\t\tscore = Math.round(score * 100);\n\t\tscoreDelta = Math.round(scoreDelta * 100);\n\n\t\tconst result = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-scoring-total-result\"},\n\t\t\t\ttext: score + \"%\"\n\t\t\t});\n\n\t\tlet iconClass = \"crm-entity-stream-content-scoring-total-icon\";\n\t\tif (score < 50)\n\t\t{\n\t\t\ticonClass += \" crm-entity-stream-content-scoring-total-icon-fail\";\n\t\t}\n\t\telse if (score < 75)\n\t\t{\n\t\t\ticonClass += \" crm-entity-stream-content-scoring-total-icon-middle\";\n\t\t}\n\t\telse\n\t\t{\n\t\t\ticonClass += \" crm-entity-stream-content-scoring-total-icon-success\";\n\t\t}\n\n\t\tconst icon = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: iconClass}\n\t\t\t}\n\t\t);\n\n\t\touterWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-scoring-total\" },\n\t\t\t\t\t\t\t\tchildren: [\n\t\t\t\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-scoring-total-text\" },\n\t\t\t\t\t\t\t\t\t\t\ttext: BX.message(\"CRM_TIMELINE_SCORING_TITLE_2\")\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t\tresult,\n\t\t\t\t\t\t\t\t\ticon\n\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t),\n\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-scoring-event\" },\n\t\t\t\t\t\t\t\tchildren: [\n\t\t\t\t\t\t\t\t\t(\n\t\t\t\t\t\t\t\t\t\tscoreDelta !== 0 ?\n\t\t\t\t\t\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-scoring-event-offset\" },\n\t\t\t\t\t\t\t\t\t\t\t\t\ttext: (scoreDelta > 0 ? \"+\" : \"\") + scoreDelta + \"%\"\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t:\n\t\t\t\t\t\t\t\t\t\t\tnull\n\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t\t/*BX.create(\"DIV\",\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-scoring-event-detail\" },\n\t\t\t\t\t\t\t\t\t\t\ttext: \"<activity subject>\"\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t)*/\n\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t)\n\t\t\t\t\t]\n\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\treturn outerWrapper;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Scoring();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","/** @memberof BX.Crm.Timeline.Animation */\nexport default class Expand\n{\n\tconstructor()\n\t{\n\t\tthis._node = null;\n\t\tthis._callback = null;\n\t}\n\n\tinitialize(node, callback)\n\t{\n\t\tthis._node = node;\n\t\tthis._callback = BX.type.isFunction(callback) ? callback : null;\n\t}\n\n\trun()\n\t{\n\t\tconst position = BX.pos(this._node);\n\n\t\tthis._node.style.height = 0;\n\t\tthis._node.style.opacity = 0;\n\t\tthis._node.style.overflow = \"hidden\";\n\n\t\t(new BX.easing(\n\t\t\t\t{\n\t\t\t\t\tduration : 150,\n\t\t\t\t\tstart : { height: 0 },\n\t\t\t\t\tfinish: { height: position.height },\n\t\t\t\t\ttransition : BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\t\t\tstep: BX.delegate(this.onNodeHeightStep, this),\n\t\t\t\t\tcomplete: BX.delegate(this.onNodeHeightComplete, this)\n\t\t\t\t}\n\t\t\t)\n\t\t).animate();\n\t}\n\n\tonNodeHeightStep(state)\n\t{\n\t\tthis._node.style.height = state.height + \"px\";\n\t}\n\n\tonNodeHeightComplete()\n\t{\n\t\tthis._node.style.overflow = \"\";\n\t\t(new BX.easing(\n\t\t\t\t{\n\t\t\t\t\tduration : 150,\n\t\t\t\t\tstart : { opacity: 0 },\n\t\t\t\t\tfinish: { opacity: 100 },\n\t\t\t\t\ttransition : BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\t\t\tstep: BX.delegate(this.onNodeOpacityStep, this),\n\t\t\t\t\tcomplete: BX.delegate(this.onNodeOpacityComplete, this)\n\t\t\t\t}\n\t\t\t)\n\t\t).animate();\n\t}\n\n\tonNodeOpacityStep(state)\n\t{\n\t\tthis._node.style.opacity = state.opacity / 100;\n\t}\n\n\tonNodeOpacityComplete()\n\t{\n\t\tthis._node.style.height = \"\";\n\t\tthis._node.style.opacity = \"\";\n\t\tif(this._callback)\n\t\t{\n\t\t\tthis._callback();\n\t\t}\n\t}\n\n\tstatic create(node, callback)\n\t{\n\t\tconst self = new Expand();\n\t\tself.initialize(node, callback);\n\t\treturn self;\n\t}\n}\n","import Stream from \"../stream\";\nimport {Item as ItemType, Order as OrderType} from \"../types\";\nimport HistoryItem from \"../items/history\";\nimport Modification from \"../items/modification\";\nimport Conversion from \"../items/conversion\";\nimport HistoryActivity from \"../items/history-activity\";\nimport Email from \"../items/email\";\nimport Call from \"../items/call\";\nimport Meeting from \"../items/meeting\";\nimport Task from \"../items/task\";\nimport WebForm from \"../items/webform\";\nimport Request from \"../items/request\";\nimport OpenLine from \"../items/openline\";\nimport Rest from \"../items/rest\";\nimport Visit from \"../items/visit\";\nimport Zoom from \"../items/zoom\";\nimport ExternalNoticeStatusModification from \"../items/external-notice-status-modification\";\nimport ExternalNoticeModification from \"../items/external-notice-modification\";\nimport Creation from \"../items/creation\";\nimport Restoration from \"../items/restoration\";\nimport Link from \"../items/link\";\nimport Unlink from \"../items/unlink\";\nimport Mark from \"../items/mark\";\nimport Comment from \"../items/comment\";\nimport Wait from \"../items/wait\";\nimport Document from \"../items/document\";\nimport Sender from \"../items/sender\";\nimport Bizproc from \"../items/bizproc\";\nimport Scoring from \"../items/scoring\";\nimport {ConfigurableItem, StreamType} from \"crm.timeline.item\";\nimport Expand from \"../animations/expand\";\n\n/** @memberof BX.Crm.Timeline.Streams */\nexport default class History extends Stream\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._items = [];\n\t\tthis._wrapper = null;\n\t\tthis._fixedHistory = null;\n\t\tthis._emptySection = null;\n\t\tthis._currentDaySection = null;\n\t\tthis._lastDaySection = null;\n\t\tthis._lastDate = null;\n\t\tthis._anchor = null;\n\t\tthis._history = this;\n\t\tthis._enableLoading = false;\n\t\tthis._navigation = null;\n\t\tthis._scrollHandler = null;\n\t\tthis._loadingWaiter = null;\n\n\t\tthis._filterId = \"\";\n\t\tthis._isFilterApplied = false;\n\t\tthis._isFilterShown = false;\n\n\t\tthis._isRequestRunning = false;\n\n\t\tthis._filterButton = null;\n\t\tthis._filterWrapper = null;\n\t\tthis._filterResultStub = null;\n\t}\n\n\tdoInitialize()\n\t{\n\t\tthis._fixedHistory = this.getSetting(\"fixedHistory\");\n\t\tthis._ownerTypeId = this.getSetting(\"ownerTypeId\");\n\t\tthis._ownerId = this.getSetting(\"ownerId\");\n\t\tthis._serviceUrl = this.getSetting(\"serviceUrl\", \"\");\n\t\tif (!this.isStubMode())\n\t\t{\n\t\t\tlet itemData = this.getSetting(\"itemData\");\n\t\t\tif (!BX.type.isArray(itemData))\n\t\t\t{\n\t\t\t\titemData = [];\n\t\t\t}\n\n\t\t\tlet i, length, item;\n\t\t\tfor (i = 0, length = itemData.length; i < length; i++)\n\t\t\t{\n\t\t\t\titem = this.createItem(itemData[i]);\n\t\t\t\tif (item)\n\t\t\t\t{\n\t\t\t\t\tthis._items.push(item);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis._navigation = this.getSetting(\"navigation\", {});\n\n\t\t\tthis._filterWrapper = BX(\"timeline-filter\");\n\t\t\tthis._filterId = BX.prop.getString(this._settings, \"filterId\", this._id);\n\t\t\tthis._isFilterShown = this._filterWrapper\n\t\t\t\t&& BX.hasClass(this._filterWrapper, \"crm-entity-stream-section-filter-show\");\n\t\t\tthis._isFilterApplied = BX.prop.getBoolean(this._settings, \"isFilterApplied\", false);\n\n\t\t\tBX.addCustomEvent(\"BX.Main.Filter:apply\", this.onFilterApply.bind(this));\n\t\t}\n\t}\n\n\tlayout()\n\t{\n\t\tthis._wrapper = BX.create(\"DIV\", {});\n\t\tthis._container.appendChild(this._wrapper);\n\n\t\tconst now = BX.prop.extractDate(new Date());\n\t\tlet i, length, item;\n\n\t\tif (!this.isStubMode())\n\t\t{\n\t\t\tif (this._filterWrapper)\n\t\t\t{\n\t\t\t\tconst closeFilterButton = this._filterWrapper.querySelector(\".crm-entity-stream-filter-close\");\n\t\t\t\tif (closeFilterButton)\n\t\t\t\t{\n\t\t\t\t\tBX.bind(closeFilterButton, \"click\", this.onFilterClose.bind(this));\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfor (i = 0, length = this._items.length; i < length; i++)\n\t\t\t{\n\t\t\t\titem = this._items[i];\n\t\t\t\titem.setContainer(this._wrapper);\n\n\t\t\t\tconst created = item.getCreatedDate();\n\t\t\t\tif (this._lastDate === null || this._lastDate.getTime() !== created.getTime())\n\t\t\t\t{\n\t\t\t\t\tthis._lastDate = created;\n\t\t\t\t\tif (now.getTime() === created.getTime())\n\t\t\t\t\t{\n\t\t\t\t\t\tthis._currentDaySection = this._lastDaySection = this.createCurrentDaySection();\n\t\t\t\t\t\tthis._wrapper.appendChild(this._currentDaySection);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis._lastDaySection = this.createDaySection(this._lastDate);\n\t\t\t\t\t\tthis._wrapper.appendChild(this._lastDaySection);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\titem._lastDate = this._lastDate;\n\n\t\t\t\titem.layout();\n\t\t\t}\n\n\t\t\tthis.enableLoading(this._items.length > 0);\n\t\t\tthis.refreshLayout();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis._currentDaySection = this._lastDaySection = this.createCurrentDaySection();\n\t\t\tthis._wrapper.appendChild(this._currentDaySection);\n\n\t\t\tthis._wrapper.appendChild(\n\t\t\t\tBX.create(\n\t\t\t\t\t\"DIV\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-section crm-entity-stream-section-createEntity crm-entity-stream-section-last\"},\n\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\tBX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-info\"}}),\n\t\t\t\t\t\t\t\tBX.create(\n\t\t\t\t\t\t\t\t\t\"DIV\",\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-section-content\"},\n\t\t\t\t\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t\t\t\t\tBX.create(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\"DIV\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-event\"},\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tBX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-header\"}}),\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tBX.create(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\"DIV\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail\"},\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttext: BX.message(\"CRM_TIMELINE_HISTORY_STUB\")\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\n\t\tthis._manager.processHistoryLayoutChange();\n\t}\n\n\trefreshLayout()\n\t{\n\t\tif (this._filterWrapper)\n\t\t{\n\t\t\tif (this._wrapper.firstChild && this._filterWrapper !== this._wrapper.firstChild)\n\t\t\t{\n\t\t\t\tthis._wrapper.insertBefore(this._filterWrapper, this._wrapper.firstChild);\n\t\t\t}\n\t\t\telse if (!this._wrapper.firstChild && this._filterWrapper.parentNode !== this._wrapper)\n\t\t\t{\n\t\t\t\tthis._wrapper.appendChild(this._filterWrapper);\n\t\t\t}\n\t\t}\n\n\t\tthis.adjustFilterButton();\n\n\t\tconst length = this._items.length;\n\t\tif (length === 0 && this._isFilterApplied)\n\t\t{\n\t\t\tif (!this._filterEmptyResultSection)\n\t\t\t{\n\t\t\t\tthis._filterEmptyResultSection = this.createFilterEmptyResultSection();\n\t\t\t}\n\t\t\tthis._wrapper.appendChild(this._filterEmptyResultSection);\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (this._filterEmptyResultSection)\n\t\t{\n\t\t\tthis._filterEmptyResultSection = BX.remove(this._filterEmptyResultSection);\n\t\t}\n\n\t\tif (length === 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tfor (let i = 0; i < (length - 1); i++)\n\t\t{\n\t\t\tconst item = this._items[i];\n\t\t\tif (item.isTerminated())\n\t\t\t{\n\t\t\t\titem.markAsTerminated(false);\n\t\t\t}\n\t\t}\n\n\t\tthis._items[length - 1].markAsTerminated(true);\n\t}\n\n\tcalculateItemIndex(item)\n\t{\n\t\treturn 0;\n\t}\n\n\tcheckItemForTermination(item)\n\t{\n\t\treturn this.getLastItem() === item;\n\t}\n\n\thasContent()\n\t{\n\t\treturn (this._items.length > 0 || this._isFilterApplied || this._isStubMode);\n\t}\n\n\tgetItems(): Array\n\t{\n\t\treturn this._items;\n\t}\n\n\tsetItems(items: Array): void\n\t{\n\t\tthis._items = items;\n\t}\n\n\tgetItemByIndex(index)\n\t{\n\t\treturn index < this._items.length ? this._items[index] : null;\n\t}\n\n\tgetItemCount()\n\t{\n\t\treturn this._items.length;\n\t}\n\n\tgetItemsByAssociatedEntity($entityTypeId, entityId)\n\t{\n\t\tif (!BX.type.isNumber($entityTypeId))\n\t\t{\n\t\t\t$entityTypeId = parseInt($entityTypeId);\n\t\t}\n\n\t\tif (!BX.type.isNumber(entityId))\n\t\t{\n\t\t\tentityId = parseInt(entityId);\n\t\t}\n\n\t\tif (isNaN($entityTypeId) || $entityTypeId <= 0 || isNaN(entityId) || entityId <= 0)\n\t\t{\n\t\t\treturn [];\n\t\t}\n\n\t\tconst results = [];\n\t\tfor (let i = 0, l = this._items.length; i < l; i++)\n\t\t{\n\t\t\tconst item = this._items[i];\n\t\t\tif (item.getAssociatedEntityTypeId() === $entityTypeId && item.getAssociatedEntityId() === entityId)\n\t\t\t{\n\t\t\t\tresults.push(item);\n\t\t\t}\n\t\t}\n\t\treturn results;\n\t}\n\n\tcreateFilterEmptyResultSection()\n\t{\n\t\treturn BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-section crm-entity-stream-section-filter-empty\"},\n\t\t\t\tchildren:\n\t\t\t\t\t[\n\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-section-content\"},\n\t\t\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-filter-empty\"},\n\t\t\t\t\t\t\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-filter-empty-img\"}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-filter-empty-text\"},\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttext: this.getMessage(\"filterEmptyResultStub\")\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t)\n\t\t\t\t\t]\n\t\t\t}\n\t\t);\n\t}\n\n\tadjustFilterButton()\n\t{\n\t\tif (!this._filterWrapper)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this._isFilterShown && this._items.length === 0)\n\t\t{\n\t\t\tif (!this._emptySection)\n\t\t\t{\n\t\t\t\tthis._emptySection = this.createEmptySection();\n\t\t\t}\n\t\t\tthis._wrapper.insertBefore(this._emptySection, this._filterWrapper);\n\t\t}\n\t\telse if (this._emptySection)\n\t\t{\n\t\t\tthis._emptySection = BX.remove(this._emptySection);\n\t\t}\n\n\t\tif (!this._filterButton)\n\t\t{\n\t\t\tthis._filterButton = BX.create(\"BUTTON\",\n\t\t\t\t{\n\t\t\t\t\tattrs: {className: \"crm-entity-stream-filter-label\"},\n\t\t\t\t\ttext: this.getMessage(\"filterButtonCaption\")\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tBX.bind(this._filterButton, \"click\", function (e) {\n\t\t\t\tthis.showFilter();\n\t\t\t}.bind(this));\n\t\t}\n\n\t\tconst section = this._wrapper.querySelector(\".crm-entity-stream-section-today-label, .crm-entity-stream-section-planned-label, .crm-entity-stream-section-history-label\");\n\t\tif (section)\n\t\t{\n\t\t\tconst sectionWrapper = section.querySelector(\".crm-entity-stream-section-content\");\n\t\t\tif (sectionWrapper)\n\t\t\t{\n\t\t\t\tif (this._filterButton.parentNode !== sectionWrapper)\n\t\t\t\t{\n\t\t\t\t\tsectionWrapper.appendChild(this._filterButton);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (this._isFilterApplied)\n\t\t{\n\t\t\tBX.addClass(this._filterButton, \"crm-entity-stream-filter-label-active\");\n\t\t}\n\t\telse\n\t\t{\n\t\t\tBX.removeClass(this._filterButton, \"crm-entity-stream-filter-label-active\");\n\t\t}\n\t}\n\n\tshowFilter(params)\n\t{\n\t\tif (!this._filterWrapper)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tBX.removeClass(this._filterWrapper, \"crm-entity-stream-section-filter-hide\");\n\t\tBX.addClass(this._filterWrapper, \"crm-entity-stream-section-filter-show\");\n\n\t\tthis._isFilterShown = true;\n\n\t\tif (BX.prop.getBoolean(params, \"enableAdjust\", true))\n\t\t{\n\t\t\tthis.adjustFilterButton();\n\t\t}\n\t}\n\n\thideFilter(params)\n\t{\n\t\tif (!this._filterWrapper)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tBX.removeClass(this._filterWrapper, \"crm-entity-stream-section-filter-show\");\n\t\tBX.addClass(this._filterWrapper, \"crm-entity-stream-section-filter-hide\");\n\n\t\tthis._isFilterShown = false;\n\n\t\tif (BX.prop.getBoolean(params, \"enableAdjust\", true))\n\t\t{\n\t\t\tthis.adjustFilterButton();\n\t\t}\n\t}\n\n\tonFilterClose(e)\n\t{\n\t\tthis.hideFilter();\n\n\t\twindow.setTimeout(\n\t\t\tfunction () {\n\t\t\t\tconst filter = BX.Main.filterManager.getById(this._filterId);\n\t\t\t\tif (filter)\n\t\t\t\t{\n\t\t\t\t\tfilter.resetFilter();\n\t\t\t\t}\n\t\t\t}.bind(this),\n\t\t\t500\n\t\t);\n\t}\n\n\tcreateEmptySection()\n\t{\n\t\treturn BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-section crm-entity-stream-section-planned-label\"},\n\t\t\t\tchildren: [BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-section-content\"}})]\n\t\t\t}\n\t\t);\n\t}\n\n\tcreateCurrentDaySection()\n\t{\n\t\tlet formattedDate = this.formatDate(BX.prop.extractDate(new Date()));\n\t\tformattedDate = formattedDate[0].toUpperCase() + formattedDate.substring(1);\n\n\t\treturn BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-section crm-entity-stream-section-today-label\"},\n\t\t\t\tchildren:\n\t\t\t\t\t[\n\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-section-content\"},\n\t\t\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-today-label\"},\n\t\t\t\t\t\t\t\t\t\t\t\ttext: formattedDate\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t)\n\t\t\t\t\t]\n\t\t\t}\n\t\t);\n\t}\n\n\tcreateDaySection(date)\n\t{\n\t\tlet formattedDate = this.formatDate(date);\n\t\tformattedDate = formattedDate[0].toUpperCase() + formattedDate.substring(1);\n\n\t\treturn BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-section crm-entity-stream-section-history-label\"},\n\t\t\t\tchildren:\n\t\t\t\t\t[\n\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-section-content\"},\n\t\t\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-history-label\"},\n\t\t\t\t\t\t\t\t\t\t\t\ttext: formattedDate\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t)\n\t\t\t\t\t]\n\t\t\t}\n\t\t);\n\t}\n\n\tcreateAnchor(index)\n\t{\n\t\tif (this._emptySection)\n\t\t{\n\t\t\tthis._emptySection = BX.remove(this._emptySection);\n\t\t}\n\n\t\tif (this._currentDaySection === null)\n\t\t{\n\t\t\tthis._currentDaySection = this.createCurrentDaySection();\n\t\t\tif (this._wrapper.firstChild)\n\t\t\t{\n\t\t\t\tthis._wrapper.insertBefore(this._currentDaySection, this._wrapper.firstChild);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis._wrapper.appendChild(this._currentDaySection);\n\t\t\t}\n\t\t}\n\n\t\tif (this._anchor === null)\n\t\t{\n\t\t\tthis._anchor = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-section crm-entity-stream-section-shadow\"}});\n\t\t\tif (this._currentDaySection.nextSibling)\n\t\t\t{\n\t\t\t\tthis._wrapper.insertBefore(this._anchor, this._currentDaySection.nextSibling);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis._wrapper.appendChild(this._anchor);\n\t\t\t}\n\t\t}\n\t\treturn this._anchor;\n\t}\n\n\tcreateActivityItem(data)\n\t{\n\t\tconst typeId = BX.prop.getInteger(data, \"TYPE_ID\", ItemType.undefined);\n\t\tconst typeCategoryId = BX.prop.getInteger(data, \"TYPE_CATEGORY_ID\", 0);\n\t\tconst providerId = BX.prop.getString(\n\t\t\tBX.prop.getObject(data, \"ASSOCIATED_ENTITY\", {}),\n\t\t\t\"PROVIDER_ID\",\n\t\t\t\"\"\n\t\t);\n\n\t\tif (typeId !== ItemType.activity)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tif (typeCategoryId === BX.CrmActivityType.email)\n\t\t{\n\t\t\treturn Email.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this._history,\n\t\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\tif (typeCategoryId === BX.CrmActivityType.call)\n\t\t{\n\t\t\treturn Call.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this._history,\n\t\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (typeCategoryId === BX.CrmActivityType.meeting)\n\t\t{\n\t\t\treturn Meeting.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this._history,\n\t\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (typeCategoryId === BX.CrmActivityType.task)\n\t\t{\n\t\t\treturn Task.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this._history,\n\t\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (typeCategoryId === BX.CrmActivityType.provider)\n\t\t{\n\t\t\tif (providerId === \"CRM_WEBFORM\")\n\t\t\t{\n\t\t\t\treturn WebForm.create(\n\t\t\t\t\tdata[\"ID\"],\n\t\t\t\t\t{\n\t\t\t\t\t\thistory: this._history,\n\t\t\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\tdata: data\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t\telse if (providerId === 'CRM_REQUEST')\n\t\t\t{\n\t\t\t\treturn Request.create(\n\t\t\t\t\tdata[\"ID\"],\n\t\t\t\t\t{\n\t\t\t\t\t\thistory: this._history,\n\t\t\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\tdata: data\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t\telse if (providerId === \"IMOPENLINES_SESSION\")\n\t\t\t{\n\t\t\t\treturn OpenLine.create(\n\t\t\t\t\tdata[\"ID\"],\n\t\t\t\t\t{\n\t\t\t\t\t\thistory: this._history,\n\t\t\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\tdata: data\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t\telse if (providerId === 'REST_APP')\n\t\t\t{\n\t\t\t\treturn Rest.create(\n\t\t\t\t\tdata[\"ID\"],\n\t\t\t\t\t{\n\t\t\t\t\t\thistory: this._history,\n\t\t\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\tdata: data\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t\telse if (providerId === 'VISIT_TRACKER')\n\t\t\t{\n\t\t\t\treturn Visit.create(\n\t\t\t\t\tdata[\"ID\"],\n\t\t\t\t\t{\n\t\t\t\t\t\thistory: this,\n\t\t\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\tdata: data\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t\telse if (providerId === 'ZOOM')\n\t\t\t{\n\t\t\t\treturn Zoom.create(\n\t\t\t\t\tdata[\"ID\"],\n\t\t\t\t\t{\n\t\t\t\t\t\thistory: this,\n\t\t\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\tdata: data\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t\telse if (providerId === 'CRM_CALL_TRACKER')\n\t\t\t{\n\t\t\t\treturn Call.create(\n\t\t\t\t\tdata[\"ID\"],\n\t\t\t\t\t{\n\t\t\t\t\t\thistory: this,\n\t\t\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\tdata: data\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\treturn HistoryActivity.create(\n\t\t\tdata[\"ID\"],\n\t\t\t{\n\t\t\t\thistory: this._history,\n\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\tcontainer: this._wrapper,\n\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\tdata: data,\n\t\t\t}\n\t\t);\n\t}\n\n\tcreateExternalNotificationItem(data)\n\t{\n\t\tconst typeId = BX.prop.getInteger(data, \"TYPE_CATEGORY_ID\", 0);\n\t\tconst changedFieldName = BX.prop.getString(data, 'CHANGED_FIELD_NAME', '');\n\n\t\tif (typeId === ItemType.modification && changedFieldName === 'STATUS_ID')\n\t\t{\n\t\t\treturn ExternalNoticeStatusModification.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this._history,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\treturn ExternalNoticeModification.create(\n\t\t\tdata[\"ID\"],\n\t\t\t{\n\t\t\t\thistory: this._history,\n\t\t\t\tcontainer: this._wrapper,\n\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\tdata: data\n\t\t\t}\n\t\t);\n\t}\n\n\tcreateItem(data)\n\t{\n\t\tif (data.hasOwnProperty('type'))\n\t\t{\n\t\t\treturn ConfigurableItem.create(data.id, {\n\t\t\t\ttimelineId: this.getId(),\n\t\t\t\tcontainer: this.getWrapper(),\n\t\t\t\titemClassName: this.getItemClassName(),\n\t\t\t\tuseShortTimeFormat: this.getStreamType() === StreamType.history,\n\t\t\t\tisReadOnly: this.isReadOnly(),\n\t\t\t\tcurrentUser: this._manager.getCurrentUser(),\n\t\t\t\townerTypeId: this._manager.getOwnerTypeId(),\n\t\t\t\townerId: this._manager.getOwnerId(),\n\t\t\t\tstreamType: this.getStreamType(),\n\t\t\t\tdata: data,\n\t\t\t})\n\t\t}\n\n\t\tconst typeId = BX.prop.getInteger(data, \"TYPE_ID\", ItemType.undefined);\n\t\tconst typeCategoryId = BX.prop.getInteger(data, \"TYPE_CATEGORY_ID\", 0);\n\n\t\tif (typeId === ItemType.activity)\n\t\t{\n\t\t\treturn this.createActivityItem(data);\n\t\t}\n\t\telse if (typeId === ItemType.externalNotification)\n\t\t{\n\t\t\treturn this.createExternalNotificationItem(data);\n\t\t}\n\t\telse if (typeId === ItemType.creation)\n\t\t{\n\t\t\treturn Creation.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this._history,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (typeId === ItemType.restoration)\n\t\t{\n\t\t\treturn Restoration.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this._history,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (typeId === ItemType.link)\n\t\t{\n\t\t\treturn Link.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (typeId === ItemType.unlink)\n\t\t{\n\t\t\treturn Unlink.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (typeId === ItemType.mark)\n\t\t{\n\t\t\treturn Mark.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this._history,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (typeId === ItemType.comment)\n\t\t{\n\t\t\treturn Comment.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this._history,\n\t\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (typeId === ItemType.wait)\n\t\t{\n\t\t\treturn Wait.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this._history,\n\t\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (typeId === ItemType.document)\n\t\t{\n\t\t\treturn Document.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this._history,\n\t\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (typeId === ItemType.sender)\n\t\t{\n\t\t\treturn Sender.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (typeId === ItemType.modification)\n\t\t{\n\t\t\treturn Modification.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this._history,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (typeId === ItemType.conversion)\n\t\t{\n\t\t\treturn Conversion.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this._history,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (typeId === ItemType.bizproc)\n\t\t{\n\t\t\treturn Bizproc.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this._history,\n\t\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (typeId === ItemType.scoring)\n\t\t{\n\t\t\treturn Scoring.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this._history,\n\t\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\treturn HistoryItem.create(\n\t\t\tdata[\"ID\"],\n\t\t\t{\n\t\t\t\thistory: this._history,\n\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\tcontainer: this._wrapper,\n\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\tdata: data\n\t\t\t}\n\t\t);\n\t}\n\n\tgetWrapper()\n\t{\n\t\treturn this._wrapper;\n\t}\n\n\tgetItemClassName()\n\t{\n\t\treturn 'crm-entity-stream-section crm-entity-stream-section-history';\n\t}\n\n\taddItem(item, index)\n\t{\n\t\tif (!BX.type.isNumber(index) || index < 0)\n\t\t{\n\t\t\tindex = this.calculateItemIndex(item);\n\t\t}\n\n\t\tif (index < this._items.length)\n\t\t{\n\t\t\tthis._items.splice(index, 0, item);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis._items.push(item);\n\t\t}\n\n\t\tthis.refreshLayout();\n\t\tthis._manager.processHistoryLayoutChange();\n\t}\n\n\tdeleteItem(item)\n\t{\n\t\tconst index = this.getItemIndex(item);\n\t\tif (index < 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\titem.clearLayout();\n\t\tthis.removeItemByIndex(index);\n\n\t\tthis.refreshLayout();\n\t\tthis._manager.processHistoryLayoutChange();\n\t}\n\n\tresetLayout()\n\t{\n\t\tlet i;\n\n\t\tfor (i = (this._items.length - 1); i >= 0; i--)\n\t\t{\n\t\t\tthis._items[i].clearLayout();\n\t\t}\n\n\t\tthis._items = [];\n\n\t\tthis._currentDaySection = this._lastDaySection = this._emptySection = this._filterEmptyResultSection = null;\n\t\tthis._anchor = null;\n\t\tthis._lastDate = null;\n\n\t\t//Clean wrapper. Skip filter for prevent trembling.\n\t\tconst children = [];\n\t\tlet child;\n\t\tfor (i = 0; child = this._wrapper.children[i]; i++)\n\t\t{\n\t\t\tif (child !== this._filterWrapper)\n\t\t\t{\n\t\t\t\tchildren.push(child);\n\t\t\t}\n\t\t}\n\n\t\tfor (i = 0; child = children[i]; i++)\n\t\t{\n\t\t\tthis._wrapper.removeChild(child);\n\t\t}\n\t}\n\n\tonWindowScroll(e)\n\t{\n\t\tif (!this._loadingWaiter || !this._enableLoading || this._isRequestRunning)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst pos = this._loadingWaiter.getBoundingClientRect();\n\t\tif (pos.top <= document.documentElement.clientHeight)\n\t\t{\n\t\t\tthis.loadItems();\n\t\t}\n\t}\n\n\tonFilterApply(id, data, ctx, promise, params)\n\t{\n\t\tif (id !== this._filterId)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tparams.autoResolve = false;\n\t\tthis._isFilterApplied = BX.prop.getString(data, \"action\", \"\") === \"apply\";\n\t\tthis._isRequestRunning = true;\n\n\t\tBX.CrmDataLoader.create(\n\t\t\tthis._id,\n\t\t\t{\n\t\t\t\tserviceUrl: this.getSetting(\"serviceUrl\", \"\"),\n\t\t\t\taction: \"GET_HISTORY_ITEMS\",\n\t\t\t\tparams:\n\t\t\t\t\t{\n\t\t\t\t\t\t\"GUID\": this._id,\n\t\t\t\t\t\t\"OWNER_TYPE_ID\": this._manager.getOwnerTypeId(),\n\t\t\t\t\t\t\"OWNER_ID\": this._manager.getOwnerId()\n\t\t\t\t\t}\n\t\t\t}\n\t\t).load(\n\t\t\tfunction (sender, result) {\n\t\t\t\tthis.resetLayout();\n\t\t\t\tthis.bulkCreateItems(BX.prop.getArray(result, \"HISTORY_ITEMS\", []));\n\t\t\t\tthis.setNavigation(BX.prop.getObject(result, \"HISTORY_NAVIGATION\", {}));\n\n\t\t\t\tthis.refreshLayout();\n\t\t\t\tif (this._items.length > 0)\n\t\t\t\t{\n\t\t\t\t\tthis._manager.processHistoryLayoutChange();\n\t\t\t\t}\n\n\t\t\t\tpromise.fulfill();\n\t\t\t\tthis._isRequestRunning = false;\n\t\t\t}.bind(this)\n\t\t);\n\t}\n\n\tbulkCreateItems(itemData)\n\t{\n\t\tconst length = itemData.length;\n\t\tif (length === 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this._filterEmptyResultSection)\n\t\t{\n\t\t\tthis._filterEmptyResultSection = BX.remove(this._filterEmptyResultSection);\n\t\t}\n\n\t\tconst now = BX.prop.extractDate(new Date());\n\t\tlet i, item;\n\t\tfor (i = 0; i < length; i++)\n\t\t{\n\t\t\tconst itemId = BX.prop.getInteger(\n\t\t\t\titemData[i],\n\t\t\t\t'id',\n\t\t\t\tBX.prop.getInteger(itemData[i], 'ID', 0)\n\t\t\t);\n\n\t\t\tif (itemId <= 0)\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (this.findItemById(itemId) !== null)\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\titem = this.createItem(itemData[i]);\n\t\t\tthis._items.push(item);\n\n\t\t\tconst created = item.getCreatedDate();\n\t\t\tif (this._lastDate === null || this._lastDate.getTime() !== created.getTime())\n\t\t\t{\n\t\t\t\tthis._lastDate = created;\n\t\t\t\tif (now.getTime() === created.getTime())\n\t\t\t\t{\n\t\t\t\t\tthis._currentDaySection = this._lastDaySection = this.createCurrentDaySection();\n\t\t\t\t\tthis._wrapper.appendChild(this._currentDaySection);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis._lastDaySection = this.createDaySection(this._lastDate);\n\t\t\t\t\tthis._wrapper.appendChild(this._lastDaySection);\n\t\t\t\t}\n\t\t\t}\n\t\t\titem.layout();\n\t\t}\n\t}\n\n\tloadItems()\n\t{\n\t\tthis._isRequestRunning = true;\n\t\tBX.CrmDataLoader.create(\n\t\t\tthis._id,\n\t\t\t{\n\t\t\t\tserviceUrl: this.getSetting(\"serviceUrl\", \"\"),\n\t\t\t\taction: \"GET_HISTORY_ITEMS\",\n\t\t\t\tparams:\n\t\t\t\t\t{\n\t\t\t\t\t\t\"GUID\": this._id,\n\t\t\t\t\t\t\"OWNER_TYPE_ID\": this._manager.getOwnerTypeId(),\n\t\t\t\t\t\t\"OWNER_ID\": this._manager.getOwnerId(),\n\t\t\t\t\t\t\"NAVIGATION\": this._navigation\n\t\t\t\t\t}\n\t\t\t}\n\t\t).load(\n\t\t\tfunction (sender, result) {\n\t\t\t\tthis.bulkCreateItems(BX.prop.getArray(result, \"HISTORY_ITEMS\", []));\n\t\t\t\tthis.setNavigation(BX.prop.getObject(result, \"HISTORY_NAVIGATION\", {}));\n\n\t\t\t\tthis.refreshLayout();\n\t\t\t\tif (this._items.length > 0)\n\t\t\t\t{\n\t\t\t\t\tthis._manager.processHistoryLayoutChange();\n\t\t\t\t}\n\n\t\t\t\tthis._isRequestRunning = false;\n\t\t\t}.bind(this)\n\t\t);\n\t}\n\n\tgetNavigation()\n\t{\n\t\treturn this._navigation;\n\t}\n\n\tsetNavigation(navigation)\n\t{\n\t\tif (!BX.type.isPlainObject(navigation))\n\t\t{\n\t\t\tnavigation = {};\n\t\t}\n\n\t\tthis._navigation = navigation;\n\t\tthis.enableLoading(\n\t\t\tBX.prop.getString(this._navigation, \"OFFSET_TIMESTAMP\", \"\") !== \"\"\n\t\t);\n\t}\n\n\tisLoadingEnabled()\n\t{\n\t\treturn this._enableLoading;\n\t}\n\n\tenableLoading(enable)\n\t{\n\t\tenable = !!enable;\n\n\t\tif (this._enableLoading === enable)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis._enableLoading = enable;\n\n\t\tif (this._enableLoading)\n\t\t{\n\t\t\tif (this._items.length > 0)\n\t\t\t{\n\t\t\t\tthis._loadingWaiter = this._items[this._items.length - 1].getWrapper();\n\t\t\t}\n\n\t\t\tif (!this._scrollHandler)\n\t\t\t{\n\t\t\t\tthis._scrollHandler = BX.delegate(this.onWindowScroll, this);\n\t\t\t\tBX.bind(window, \"scroll\", this._scrollHandler);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis._loadingWaiter = null;\n\n\t\t\tif (this._scrollHandler)\n\t\t\t{\n\t\t\t\tBX.unbind(window, \"scroll\", this._scrollHandler);\n\t\t\t\tthis._scrollHandler = null;\n\t\t\t}\n\t\t}\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = History.messages;\n\t\treturn m.hasOwnProperty(name) ? m[name] : name;\n\t}\n\n\tanimateItemAdding(item): Promise\n\t{\n\t\treturn new Promise((resolve) => {\n\t\t\tExpand.create(item.getWrapper(), resolve).run();\n\t\t});\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new History();\n\t\tself.initialize(id, settings);\n\t\tHistory.instances[self.getId()] = self;\n\t\treturn self;\n\t}\n\n\tstatic messages = {};\n\tstatic instances = {};\n}\n","import History from \"./history\";\nimport {Item} from 'crm.timeline.item';\nimport CompatibleItem from \"../items/compatible-item\";\nimport {StreamType} from 'crm.timeline.item';\n\n/** @memberof BX.Crm.Timeline.Streams */\nexport default class FixedHistory extends History\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._items = [];\n\t\tthis._wrapper = null;\n\t\tthis._fixedHistory = this;\n\t\tthis._history = this;\n\t\tthis._isRequestRunning = false;\n\t}\n\n\tdoInitialize()\n\t{\n\t\tconst datetimeFormat = BX.message(\"FORMAT_DATETIME\").replace(/:SS/, \"\");\n\t\tthis._timeFormat = BX.date.convertBitrixFormat(datetimeFormat);\n\n\t\tlet itemData = this.getSetting(\"itemData\");\n\t\tif(!BX.type.isArray(itemData))\n\t\t{\n\t\t\titemData = [];\n\t\t}\n\n\t\tlet i, length, item;\n\t\tfor(i = 0, length = itemData.length; i < length; i++)\n\t\t{\n\t\t\titem = this.createItem(itemData[i]);\n\t\t\titem._isFixed = true;\n\t\t\tthis._items.push(item);\n\t\t}\n\t}\n\n\tsetHistory(history)\n\t{\n\t\tthis._history = history;\n\t}\n\n\tcheckItemForTermination(item)\n\t{\n\t\treturn false;\n\t}\n\n\tlayout()\n\t{\n\t\tthis._wrapper = BX.create(\"DIV\", {});\n\t\tthis.createAnchor();\n\t\tthis._container.insertBefore(this._wrapper,  this._editorContainer.nextElementSibling);\n\n\t\tfor (let i = 0; i < this._items.length; i++)\n\t\t{\n\t\t\tthis._items[i].setContainer(this._wrapper);\n\t\t\tthis._items[i].layout();\n\t\t}\n\n\t\tthis.refreshLayout();\n\n\t\tthis._manager.processHistoryLayoutChange();\n\t}\n\n\trefreshLayout()\n\t{\n\t}\n\n\tformatDate(date)\n\t{\n\t}\n\n\tcreateCurrentDaySection()\n\t{\n\t}\n\n\tcreateDaySection(date)\n\t{\n\t}\n\n\tcreateAnchor(index)\n\t{\n\t\tthis._anchor = BX.create(\"DIV\", { attrs:{className: \"crm-entity-stream-section-fixed-anchor\"} });\n\t\tthis._wrapper.appendChild(this._anchor);\n\t}\n\n\tonWindowScroll(e)\n\t{\n\t}\n\n\tonItemsLoad(sender, result)\n\t{\n\t}\n\n\tloadItems()\n\t{\n\t\tthis._isRequestRunning = true;\n\n\t\tBX.CrmDataLoader.create(\n\t\t\tthis._id,\n\t\t\t{\n\t\t\t\tserviceUrl: this.getSetting(\"serviceUrl\", \"\"),\n\t\t\t\taction: \"GET_FIXED_HISTORY_ITEMS\",\n\t\t\t\tparams:\n\t\t\t\t\t{\n\t\t\t\t\t\t\"OWNER_TYPE_ID\" : this._manager.getOwnerTypeId(),\n\t\t\t\t\t\t\"OWNER_ID\": this._manager.getOwnerId(),\n\t\t\t\t\t}\n\t\t\t}\n\t\t).load(BX.delegate(this.onItemsLoad, this));\n\t}\n\n\taddItem(item: Item, index): void\n\t{\n\t\tsuper.addItem(item, index);\n\n\t\tif (item instanceof CompatibleItem)\n\t\t{\n\t\t\titem._isFixed = true;\n\t\t}\n\t}\n\n\tgetItemClassName()\n\t{\n\t\treturn 'crm-entity-stream-section crm-entity-stream-section-history crm-entity-stream-section-top-fixed';\n\t}\n\n\tgetStreamType(): number\n\t{\n\t\treturn StreamType.pinned;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tlet self = new FixedHistory();\n\t\tself.initialize(id, settings);\n\t\tthis.instances[self.getId()] = self;\n\t\treturn self;\n\t}\n}\n\nFixedHistory.instances = {};\n","import { ajax, clone, Loc, Type } from 'main.core';\nimport Stream from './stream';\nimport Fasten from \"./animations/fasten\";\nimport CompatibleItem from \"./items/compatible-item\";\n\ndeclare type PullActionProcessorMessage = {\n\taction: string,\n\titem: Object,\n\tstream: string,\n\tid: string,\n\tparams: Object | null,\n};\n\ndeclare type PullActionProcessorProps = {\n\tscheduleStream: Stream,\n\tfixedHistoryStream: Stream,\n\thistoryStream: Stream,\n\townerTypeId: number,\n\townerId: number,\n};\n\nexport default class PullActionProcessor\n{\n\t#scheduleStream: Stream = null;\n\t#fixedHistoryStream: Stream = null;\n\t#historyStream: Stream = null;\n\n\t#itemsQueue = [];\n\t#itemsQueueProcessing = false;\n\n\t#reloadingMessagesQueue: PullActionProcessorMessage[] = [];\n\n\t#ownerTypeId: number;\n\t#ownerId: number;\n\n\tconstructor(params: PullActionProcessorProps)\n\t{\n\t\tif (\n\t\t\t!Type.isObject(params.scheduleStream)\n\t\t\t|| !Type.isObject(params.fixedHistoryStream)\n\t\t\t|| !Type.isObject(params.historyStream)\n\t\t)\n\t\t{\n\t\t\tthrow new Error(`params scheduleStream, fixedHistoryStream and historyStream are required`);\n\t\t}\n\n\t\tif (!Type.isNumber(params.ownerTypeId) || !Type.isNumber(params.ownerId))\n\t\t{\n\t\t\tthrow new Error('params ownerTypeId and ownerId are required');\n\t\t}\n\n\t\tthis.#scheduleStream = params.scheduleStream;\n\t\tthis.#fixedHistoryStream = params.fixedHistoryStream;\n\t\tthis.#historyStream = params.historyStream;\n\t\tthis.#ownerTypeId = params.ownerTypeId;\n\t\tthis.#ownerId = params.ownerId;\n\t}\n\n\tprocessAction(actionParams: PullActionProcessorMessage): void\n\t{\n\t\tif (this.#itemDataShouldBeReloaded(actionParams))\n\t\t{\n\t\t\tthis.#reloadingMessagesQueue.push(actionParams);\n\t\t\tthis.#fetchItems();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.#addToQueue(actionParams);\n\t\t}\n\t}\n\n\t#itemDataShouldBeReloaded(actionParams: PullActionProcessorMessage)\n\t{\n\t\tconst { item } = actionParams;\n\n\t\tif (!item)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst appLanguage = Loc.getMessage('LANGUAGE_ID').toLowerCase();\n\t\tconst languageId = BX.prop.getString(item, 'languageId', appLanguage).toLowerCase();\n\t\tconst canBeReloaded = BX.prop.getBoolean(item, 'canBeReloaded', true);\n\n\t\treturn (languageId !== appLanguage) && canBeReloaded;\n\t}\n\n\t#addToQueue(actionParams: PullActionProcessorMessage)\n\t{\n\t\tthis.#itemsQueue.push(actionParams);\n\t\tif (!this.#itemsQueueProcessing)\n\t\t{\n\t\t\tthis.#processQueueItem();\n\t\t}\n\t}\n\n\t#processQueueItem(): void\n\t{\n\t\tif (!this.#itemsQueue.length)\n\t\t{\n\t\t\tthis.#itemsQueueProcessing = false;\n\n\t\t\treturn;\n\t\t}\n\t\tthis.#itemsQueueProcessing = true;\n\t\tconst actionParams = this.#itemsQueue.shift();\n\n\t\tconst stream = this.#getStreamByName(actionParams.stream);\n\n\t\tconst promises = [];\n\t\tswitch (actionParams.action)\n\t\t{\n\t\t\tcase 'add':\n\t\t\t\tpromises.push(this.#addItem(actionParams.id, actionParams.item, stream));\n\t\t\t\tbreak;\n\t\t\tcase 'update':\n\t\t\t\tpromises.push(this.#updateItem(actionParams.id, actionParams.item, stream, false, true));\n\t\t\t\tif (stream.isHistoryStream())\n\t\t\t\t{\n\t\t\t\t\t// fixed history stream can contain the same item as a history stream, so both should be updated:\n\t\t\t\t\tpromises.push(this.#updateItem(actionParams.id, actionParams.item, this.#fixedHistoryStream, false, true));\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'delete':\n\t\t\t\tpromises.push(this.#deleteItem(actionParams.id, stream));\n\t\t\t\tif (stream.isHistoryStream())\n\t\t\t\t{\n\t\t\t\t\t// fixed history stream can contain the same item as a history stream, so both should be updated:\n\t\t\t\t\tpromises.push(this.#deleteItem(actionParams.id, this.#fixedHistoryStream));\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'move':\n\t\t\t\t// move item from one stream to another one:\n\t\t\t\tconst sourceStream = this.#getStreamByName(actionParams.params.fromStream);\n\t\t\t\tpromises.push(this.#moveItem(actionParams.params.fromId, sourceStream, actionParams.id, stream, actionParams.item));\n\t\t\t\tbreak;\n\t\t\tcase 'changePinned':\n\t\t\t\t// pin or unpin item\n\t\t\t\tif (this.#getStreamByName(actionParams.params.fromStream).isHistoryStream())\n\t\t\t\t{\n\t\t\t\t\tpromises.push(this.#pinItem(actionParams.id, actionParams.item));\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tpromises.push(this.#unpinItem(actionParams.id, actionParams.item));\n\t\t\t\t}\n\t\t}\n\n\t\tPromise.all(promises).then(() => {\n\t\t\tthis.#processQueueItem();\n\t\t})\n\t}\n\n\t#addItem(id: number, itemData: Object, stream: Stream): Promise\n\t{\n\t\tconst existedStreamItem = stream.findItemById(id);\n\t\tif (existedStreamItem)\n\t\t{\n\t\t\treturn Promise.resolve();\n\t\t}\n\t\tconst streamItem = stream.createItem(itemData);\n\t\tif (!streamItem)\n\t\t{\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\tconst index = stream.calculateItemIndex(streamItem);\n\t\tconst anchor = stream.createAnchor(index);\n\t\tstream.addItem(streamItem, index);\n\t\tstreamItem.layout({anchor: anchor});\n\t\treturn stream.animateItemAdding(streamItem);\n\t}\n\n\t#updateItem(id: number, itemData: Object, stream: Stream, animateUpdate: boolean = true, animateMove: true): Promise\n\t{\n\t\tconst isDone = BX.prop.getString(itemData['ASSOCIATED_ENTITY'], 'COMPLETED') === 'Y';\n\t\tconst existedStreamItem = stream.findItemById(id);\n\t\tif (!existedStreamItem)\n\t\t{\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\tif (existedStreamItem instanceof CompatibleItem && isDone)\n\t\t{\n\t\t\texistedStreamItem._existedStreamItemDeadLine = existedStreamItem.getLightTime();\n\t\t}\n\n\t\texistedStreamItem.setData(itemData);\n\t\treturn stream.refreshItem(existedStreamItem, animateUpdate, animateMove);\n\t}\n\n\t#deleteItem(id: number, stream: Stream): Promise\n\t{\n\t\tconst item = stream.findItemById(id);\n\t\tif (item)\n\t\t{\n\t\t\treturn stream.deleteItemAnimated(item);\n\t\t}\n\n\t\treturn Promise.resolve();\n\t}\n\n\t#moveItem(sourceId: string, sourceStream: Stream, destinationId: string, destinationStream: Stream, destinationItemData: Object): Promise\n\t{\n\t\tconst sourceItem = sourceStream.findItemById(sourceId);\n\t\tif (!sourceItem)\n\t\t{\n\t\t\treturn this.#addItem(destinationId, destinationItemData, destinationStream);\n\t\t}\n\n\t\tconst existedDestinationItem = destinationStream.findItemById(destinationId);\n\t\tif (sourceItem && existedDestinationItem)\n\t\t{\n\t\t\treturn this.#deleteItem(sourceId, sourceStream);\n\t\t}\n\n\t\tconst destinationItem = destinationStream.createItem(destinationItemData);\n\t\tdestinationStream.addItem(destinationItem, destinationStream.calculateItemIndex(destinationItem));\n\n\t\tif (destinationItem instanceof CompatibleItem)\n\t\t{\n\t\t\tdestinationItem.layout({ add: false });\n\t\t}\n\n\t\treturn sourceStream.moveItemToStream(sourceItem, destinationStream, destinationItem);\n\t}\n\n\t#pinItem(id: number, itemData: Object): Promise\n\t{\n\t\tif (this.#fixedHistoryStream.findItemById(id))\n\t\t{\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\tconst historyItem = this.#historyStream.findItemById(id);\n\t\tif (!historyItem) // fixed history item does not exist into history items stream, so just add to fixed history stream\n\t\t{\n\t\t\treturn this.#addItem(id, itemData, this.#fixedHistoryStream);\n\t\t}\n\t\tif (historyItem instanceof CompatibleItem)\n\t\t{\n\t\t\thistoryItem.onSuccessFasten();\n\n\t\t\treturn Promise.resolve();\n\t\t}\n\t\telse\n\t\t{\n\t\t\t// hide files block in comment content before pin\n\t\t\tconst historyCommentBlock = historyItem.getLayoutContentBlockById('commentContentWeb');\n\t\t\tif (historyCommentBlock)\n\t\t\t{\n\t\t\t\thistoryCommentBlock.setIsFilesBlockDisplayed(false);\n\t\t\t\thistoryCommentBlock.setIsMoving();\n\t\t\t}\n\n\t\t\treturn this.#updateItem(id, itemData, this.#historyStream, false, false).then(() => {\n\t\t\t\tconst fixedHistoryItem = this.#fixedHistoryStream.createItem(itemData);\n\t\t\t\tfixedHistoryItem.initWrapper();\n\t\t\t\tthis.#fixedHistoryStream.addItem(fixedHistoryItem, 0);\n\n\t\t\t\treturn new Promise((resolve) => {\n\t\t\t\t\tconst animation = Fasten.create(\n\t\t\t\t\t\t'',\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tinitialItem: historyItem,\n\t\t\t\t\t\t\tfinalItem: fixedHistoryItem,\n\t\t\t\t\t\t\tanchor: this.#fixedHistoryStream.getAnchor(),\n\t\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\t\tcomplete: () => {\n\t\t\t\t\t\t\t\t\tfixedHistoryItem.initLayoutApp({ add: false });\n\n\t\t\t\t\t\t\t\t\t// show files block in comment content after pin record\n\t\t\t\t\t\t\t\t\tif (historyCommentBlock)\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\thistoryCommentBlock.setIsFilesBlockDisplayed();\n\t\t\t\t\t\t\t\t\t\thistoryCommentBlock.setIsMoving(false);\n\n\t\t\t\t\t\t\t\t\t\tconst fixedHistoryCommentBlock = fixedHistoryItem.getLayoutContentBlockById('commentContentWeb');\n\t\t\t\t\t\t\t\t\t\tif (fixedHistoryCommentBlock)\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\tfixedHistoryCommentBlock.setIsFilesBlockDisplayed();\n\t\t\t\t\t\t\t\t\t\t\tfixedHistoryCommentBlock.setIsMoving(false);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\tresolve();\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t\tanimation.run();\n\t\t\t\t})\n\t\t\t});\n\t\t}\n\t}\n\n\t#unpinItem(id: number, itemData: Object): Promise\n\t{\n\t\tconst fixedHistoryItem = this.#fixedHistoryStream.findItemById(id);\n\t\tif (fixedHistoryItem instanceof CompatibleItem)\n\t\t{\n\t\t\tfixedHistoryItem.onSuccessUnfasten();\n\n\t\t\treturn Promise.resolve();\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn this.#updateItem(id, itemData, this.#historyStream, false, false).then(() => {\n\t\t\t\treturn this.#deleteItem(id, this.#fixedHistoryStream);\n\t\t\t});\n\t\t}\n\t}\n\n\t#getStreamByName(streamName): Stream\n\t{\n\t\tswitch (streamName)\n\t\t{\n\t\t\tcase 'scheduled':\n\t\t\t\treturn this.#scheduleStream;\n\t\t\tcase 'fixedHistory':\n\t\t\t\treturn this.#fixedHistoryStream;\n\t\t\tcase 'history':\n\t\t\t\treturn this.#historyStream;\n\t\t}\n\n\t\tthrow new Error(`Stream \"${streamName}\" not found`);\n\t}\n\n\t#fetchItems()\n\t{\n\t\tsetTimeout(() => {\n\n\t\t\tconst messages = clone(this.#reloadingMessagesQueue);\n\t\t\tthis.#reloadingMessagesQueue = [];\n\n\t\t\tconst activityIds = [];\n\t\t\tconst historyIds = [];\n\n\t\t\tmessages.forEach(message => {\n\t\t\t\tconst container = message.stream === 'scheduled' ? activityIds : historyIds;\n\t\t\t\tcontainer.push(message.id);\n\t\t\t});\n\n\t\t\tif (messages.length)\n\t\t\t{\n\t\t\t\tconst data = {\n\t\t\t\t\tactivityIds,\n\t\t\t\t\thistoryIds,\n\t\t\t\t\townerTypeId: this.#ownerTypeId,\n\t\t\t\t\townerId: this.#ownerId,\n\t\t\t\t};\n\n\t\t\t\tajax.runAction('crm.timeline.item.load', { data })\n\t\t\t\t\t.then(response => {\n\t\t\t\t\t\tmessages.forEach(message => {\n\t\t\t\t\t\t\tif (response.data[message.id])\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tmessage.item = response.data[message.id];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tthis.#addToQueue(message);\n\t\t\t\t\t\t})\n\t\t\t\t\t})\n\t\t\t\t\t.catch(err => {\n\t\t\t\t\t\tconsole.error(err);\n\t\t\t\t\t\tmessages.forEach(message => this.#addToQueue(message));\n\t\t\t\t\t});\n\t\t\t}\n\n\t\t}, 1500);\n\t}\n}\n","import Scheduled from \"./items/scheduled\";\nimport {Item} from \"crm.timeline.item\";\nimport EntityChat from \"./streams/entitychat\";\nimport AudioPlaybackRateSelector from \"./tools/audio-playback-rate-selector\";\nimport Schedule from \"./streams/schedule\";\nimport FixedHistory from \"./streams/fixedhistory\";\nimport History from \"./streams/history\";\nimport Expand from \"./animations/expand\";\nimport PullActionProcessor from './pull-action-processor'\n\n/** @memberof BX.Crm.Timeline */\nexport default class Manager\n{\n\t#itemPullActionProcessor: PullActionProcessor = null;\n\n\tconstructor()\n\t{\n\t\tthis._id = \"\";\n\t\tthis._settings = {};\n\t\tthis._container = null;\n\t\tthis._ownerTypeId = 0;\n\t\tthis._ownerId = 0;\n\t\tthis._ownerInfo = null;\n\t\tthis._progressSemantics = \"\";\n\n\t\tthis._chat = null;\n\t\tthis._schedule = null;\n\t\tthis._history = null;\n\t\tthis._fixedHistory = null;\n\t\tthis._activityEditor = null;\n\n\t\tthis._userId = 0;\n\t\tthis._readOnly = false;\n\t\tthis._currentUser = null;\n\t\tthis._pullTagName = \"\";\n\t}\n\n\tinitialize(id, settings)\n\t{\n\t\tthis._id = BX.type.isNotEmptyString(id) ? id : BX.util.getRandomString(4);\n\t\tthis._settings = settings ? settings : {};\n\n\t\tthis._ownerTypeId = parseInt(this.getSetting(\"ownerTypeId\"));\n\t\tthis._ownerId = parseInt(this.getSetting(\"ownerId\"));\n\t\tthis._ownerInfo = this.getSetting(\"ownerInfo\");\n\t\tthis._progressSemantics = BX.prop.getString(this._settings, \"progressSemantics\", \"\");\n\t\tthis._spotlightFastenShowed = this.getSetting(\"spotlightFastenShowed\", true);\n\t\tthis._audioPlaybackRate = parseFloat(this.getSetting(\"audioPlaybackRate\", 1));\n\t\tconst containerId = this.getSetting(\"containerId\");\n\t\tif (!BX.type.isNotEmptyString(containerId))\n\t\t{\n\t\t\tthrow \"Manager. A required parameter 'containerId' is missing.\";\n\t\t}\n\n\t\tthis._container = BX(containerId);\n\t\tif (!BX.type.isElementNode(this._container))\n\t\t{\n\t\t\tthrow \"Manager. Container node is not found.\";\n\t\t}\n\t\tthis._editorContainer = BX(this.getSetting(\"editorContainer\"));\n\n\t\tthis._userId = BX.prop.getInteger(this._settings, \"userId\", 0);\n\t\tthis._readOnly = BX.prop.getBoolean(this._settings, \"readOnly\", false);\n\t\tthis._currentUser = BX.prop.getObject(this._settings, \"currentUser\", null);\n\n\t\tconst activityEditorId = this.getSetting(\"activityEditorId\");\n\t\tif (BX.type.isNotEmptyString(activityEditorId))\n\t\t{\n\t\t\tthis._activityEditor = BX.CrmActivityEditor.items[activityEditorId];\n\t\t\tif (!(this._activityEditor instanceof BX.CrmActivityEditor))\n\t\t\t{\n\t\t\t\tthrow \"BX.CrmTimeline. Activity editor instance is not found.\";\n\t\t\t}\n\t\t}\n\n\t\tconst ajaxId = this.getSetting(\"ajaxId\");\n\t\tconst currentUrl = this.getSetting(\"currentUrl\");\n\t\tconst serviceUrl = this.getSetting(\"serviceUrl\");\n\n\t\tthis._chat = EntityChat.create(\n\t\t\tthis._id,\n\t\t\t{\n\t\t\t\tmanager: this,\n\t\t\t\tcontainer: this._container,\n\t\t\t\tdata: this.getSetting(\"chatData\"),\n\t\t\t\tisStubMode: this._ownerId <= 0,\n\t\t\t\treadOnly: this._readOnly\n\t\t\t}\n\t\t);\n\n\t\tthis._schedule = Schedule.create(\n\t\t\tthis._id,\n\t\t\t{\n\t\t\t\tmanager: this,\n\t\t\t\tcontainer: this._container,\n\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\titemData: this.getSetting(\"scheduleData\"),\n\t\t\t\ttemplates: this.getSetting(\"templates\"),\n\t\t\t\tisStubMode: this._ownerId <= 0,\n\t\t\t\tajaxId: ajaxId,\n\t\t\t\tserviceUrl: serviceUrl,\n\t\t\t\tcurrentUrl: currentUrl,\n\t\t\t\tuserId: this._userId,\n\t\t\t\treadOnly: this._readOnly\n\t\t\t}\n\t\t);\n\n\t\tthis._fixedHistory = FixedHistory.create(\n\t\t\tthis._id,\n\t\t\t{\n\t\t\t\tmanager: this,\n\t\t\t\tcontainer: this._container,\n\t\t\t\teditorContainer: this._editorContainer,\n\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\titemData: this.getSetting(\"fixedData\"),\n\t\t\t\ttemplates: this.getSetting(\"templates\"),\n\t\t\t\tisStubMode: this._ownerId <= 0,\n\t\t\t\tajaxId: ajaxId,\n\t\t\t\tserviceUrl: serviceUrl,\n\t\t\t\tcurrentUrl: currentUrl,\n\t\t\t\tuserId: this._userId,\n\t\t\t\treadOnly: this._readOnly\n\t\t\t}\n\t\t);\n\n\t\tthis._history = History.create(\n\t\t\tthis._id,\n\t\t\t{\n\t\t\t\tmanager: this,\n\t\t\t\tcontainer: this._container,\n\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\titemData: this.getSetting(\"historyData\"),\n\t\t\t\ttemplates: this.getSetting(\"templates\"),\n\t\t\t\tnavigation: this.getSetting(\"historyNavigation\", {}),\n\t\t\t\tfilterId: BX.prop.getString(this._settings, \"historyFilterId\", this._id),\n\t\t\t\tisFilterApplied: BX.prop.getBoolean(this._settings, \"isHistoryFilterApplied\", false),\n\t\t\t\tisStubMode: this._ownerId <= 0,\n\t\t\t\tajaxId: ajaxId,\n\t\t\t\tserviceUrl: serviceUrl,\n\t\t\t\tcurrentUrl: currentUrl,\n\t\t\t\tuserId: this._userId,\n\t\t\t\treadOnly: this._readOnly\n\t\t\t}\n\t\t);\n\t\tthis._schedule.setHistory(this._history);\n\t\tthis._fixedHistory.setHistory(this._history);\n\n\t\tthis._chat.layout();\n\t\tthis._schedule.layout();\n\t\tthis._fixedHistory.layout();\n\t\tthis._history.layout();\n\n\t\tthis._pullTagName = BX.prop.getString(this._settings, \"pullTagName\", \"\");\n\t\tif (this._pullTagName !== \"\")\n\t\t{\n\t\t\tBX.addCustomEvent(\"onPullEvent-crm\", BX.delegate(this.onPullEvent, this));\n\t\t\tthis.extendWatch();\n\t\t\tthis.#itemPullActionProcessor = new PullActionProcessor({\n\t\t\t\tscheduleStream: this._schedule,\n\t\t\t\tfixedHistoryStream: this._fixedHistory,\n\t\t\t\thistoryStream: this._history,\n\t\t\t\townerTypeId: this._ownerTypeId,\n\t\t\t\townerId: this._ownerId,\n\t\t\t});\n\t\t}\n\n\t\tBX.addCustomEvent(window, \"Crm.EntityProgress.Change\", BX.delegate(this.onEntityProgressChange, this));\n\t\tBX.ready(function () {\n\t\t\twindow.addEventListener(\"scroll\", BX.throttle(function () {\n\t\t\t\tBX.LazyLoad.onScroll();\n\t\t\t}, 80));\n\t\t});\n\t}\n\n\textendWatch()\n\t{\n\t\tif (BX.type.isFunction(BX.PULL) && this._pullTagName !== \"\")\n\t\t{\n\t\t\tBX.PULL.extendWatch(this._pullTagName);\n\t\t\twindow.setTimeout(BX.delegate(this.extendWatch, this), 60000);\n\t\t}\n\t}\n\n\tonPullEvent(command, params)\n\t{\n\t\tif (this._pullTagName !== BX.prop.getString(params, \"TAG\", \"\"))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (command === 'timeline_item_action')\n\t\t{\n\t\t\tthis.#itemPullActionProcessor.processAction(params);\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (command === \"timeline_chat_create\")\n\t\t{\n\t\t\tthis.processChatCreate(params);\n\t\t}\n\t\telse if (command === \"timeline_activity_add\")\n\t\t{\n\t\t\tthis.processActivityExternalAdd(params);\n\t\t}\n\t\telse if (command === \"timeline_activity_update\")\n\t\t{\n\t\t\tthis.processActivityExternalUpdate(params);\n\t\t}\n\t\telse if (command === \"timeline_activity_delete\")\n\t\t{\n\t\t\tthis.processActivityExternalDelete(params);\n\t\t}\n\t\telse if (command === \"timeline_comment_add\")\n\t\t{\n\t\t\tthis.processCommentExternalAdd(params);\n\t\t}\n\t\telse if (command === \"timeline_comment_update\")\n\t\t{\n\t\t\tthis.processCommentExternalUpdate(params);\n\t\t}\n\t\telse if (command === \"timeline_comment_delete\")\n\t\t{\n\t\t\tthis.processCommentExternalDelete(params);\n\t\t}\n\t\telse if (command === \"timeline_changed_binding\")\n\t\t{\n\t\t\tthis.processChangeBinding(params);\n\t\t}\n\t\telse if (command === \"timeline_item_update\")\n\t\t{\n\t\t\tthis.processItemExternalUpdate(params);\n\t\t}\n\t\telse if (command === \"timeline_wait_add\")\n\t\t{\n\t\t\tthis.processWaitExternalAdd(params);\n\t\t}\n\t\telse if (command === \"timeline_wait_update\")\n\t\t{\n\t\t\tthis.processWaitExternalUpdate(params);\n\t\t}\n\t\telse if (command === \"timeline_wait_delete\")\n\t\t{\n\t\t\tthis.processWaitExternalDelete(params);\n\t\t}\n\t\telse if (command === \"timeline_bizproc_status\")\n\t\t{\n\t\t\tthis.processBizprocStatus(params);\n\t\t}\n\t\telse if (command === \"timeline_scoring_add\")\n\t\t{\n\t\t\tthis.processScoringExternalAdd(params);\n\t\t}\n\t}\n\n\tprocessChatCreate(params)\n\t{\n\t\tif (this._chat)\n\t\t{\n\t\t\tthis._chat.setData(BX.prop.getObject(params, \"CHAT_DATA\", {}));\n\t\t\tthis._chat.refreshLayout();\n\t\t}\n\t}\n\n\tprocessActivityExternalAdd(params)\n\t{\n\t\tlet entityData, scheduleItemData, historyItemData, scheduleItem, historyItem;\n\n\t\tentityData = BX.prop.getObject(params, \"ENTITY\", null);\n\t\tscheduleItemData = BX.prop.getObject(params, \"SCHEDULE_ITEM\", null);\n\t\thistoryItemData = BX.prop.getObject(params, \"HISTORY_ITEM\", null);\n\n\n\t\tif (entityData && historyItemData && !BX.type.isPlainObject(historyItemData[\"ASSOCIATED_ENTITY\"]))\n\t\t{\n\t\t\thistoryItemData[\"ASSOCIATED_ENTITY\"] = entityData;\n\t\t}\n\n\t\tif (scheduleItemData !== null && this._schedule.getItemByData(scheduleItemData) === null)\n\t\t{\n\t\t\tscheduleItem = this.addScheduleItem(scheduleItemData);\n\t\t\tscheduleItem.addWrapperClass(\"crm-entity-stream-section-updated\", 1000);\n\t\t}\n\n\t\tif (historyItemData !== null)\n\t\t{\n\t\t\thistoryItem = this._history.findItemById(BX.prop.getString(historyItemData, \"ID\"));\n\t\t\tif (!historyItem)\n\t\t\t{\n\t\t\t\thistoryItem = this.addHistoryItem(historyItemData);\n\t\t\t\tExpand.create(historyItem.getWrapper(), null).run();\n\t\t\t}\n\t\t}\n\t}\n\n\tprocessActivityExternalUpdate(params)\n\t{\n\t\tlet entityData, scheduleItemData, scheduleItem, historyItemData, historyItem, fixedHistoryItem;\n\n\t\tentityData = BX.prop.getObject(params, \"ENTITY\", null);\n\t\tscheduleItemData = BX.prop.getObject(params, \"SCHEDULE_ITEM\", null);\n\t\thistoryItemData = BX.prop.getObject(params, \"HISTORY_ITEM\", null);\n\n\t\tif (entityData)\n\t\t{\n\t\t\tif (historyItemData && !BX.type.isPlainObject(historyItemData[\"ASSOCIATED_ENTITY\"]))\n\t\t\t{\n\t\t\t\thistoryItemData[\"ASSOCIATED_ENTITY\"] = entityData;\n\t\t\t}\n\n\t\t\tconst entityId = BX.prop.getInteger(entityData, \"ID\", 0);\n\t\t\tconst historyItems = this._history.getItemsByAssociatedEntity(BX.CrmEntityType.enumeration.activity, entityId);\n\t\t\tfor (let i = 0, length = historyItems.length; i < length; i++)\n\t\t\t{\n\t\t\t\thistoryItem = historyItems[i];\n\t\t\t\thistoryItem.setAssociatedEntityData(entityData);\n\t\t\t\thistoryItem.refreshLayout();\n\t\t\t}\n\t\t\tconst fixedHistoryItems = this._fixedHistory.getItemsByAssociatedEntity(BX.CrmEntityType.enumeration.activity, entityId);\n\t\t\tfor (let i = 0, length = fixedHistoryItems.length; i < length; i++)\n\t\t\t{\n\t\t\t\tfixedHistoryItem = fixedHistoryItems[i];\n\t\t\t\tfixedHistoryItem.setAssociatedEntityData(entityData);\n\t\t\t\tfixedHistoryItem.refreshLayout();\n\t\t\t}\n\t\t}\n\n\t\tif (scheduleItemData !== null)\n\t\t{\n\t\t\tscheduleItem = this._schedule.getItemByAssociatedEntity(\n\t\t\t\tBX.CrmEntityType.enumeration.activity,\n\t\t\t\tBX.prop.getInteger(scheduleItemData, \"ASSOCIATED_ENTITY_ID\")\n\t\t\t);\n\n\t\t\tif (scheduleItem)\n\t\t\t{\n\t\t\t\tscheduleItem.setData(scheduleItemData);\n\t\t\t\tif (!scheduleItem.isDone())\n\t\t\t\t{\n\t\t\t\t\tthis._schedule.refreshItem(scheduleItem);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tif (historyItemData)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis._schedule.transferItemToHistory(\n\t\t\t\t\t\t\tscheduleItem,\n\t\t\t\t\t\t\thistoryItemData\n\t\t\t\t\t\t);\n\t\t\t\t\t\t//History data are already processed\n\t\t\t\t\t\thistoryItemData = null;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis._schedule.deleteItem(scheduleItem);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (!Scheduled.isDone(scheduleItemData))\n\t\t\t{\n\t\t\t\tscheduleItem = this.addScheduleItem(scheduleItemData);\n\t\t\t\tscheduleItem.addWrapperClass(\"crm-entity-stream-section-updated\", 1000);\n\t\t\t}\n\t\t}\n\n\t\tif (historyItemData !== null)\n\t\t{\n\t\t\thistoryItem = this._history.findItemById(BX.prop.getString(historyItemData, \"ID\"));\n\t\t\tif (!historyItem)\n\t\t\t{\n\t\t\t\thistoryItem = this.addHistoryItem(historyItemData);\n\t\t\t\tExpand.create(historyItem.getWrapper(), null).run();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\thistoryItem.setData(historyItemData);\n\t\t\t\thistoryItem.refreshLayout();\n\t\t\t\tfixedHistoryItem = this._fixedHistory.findItemById(BX.prop.getString(historyItemData, \"ID\"));\n\t\t\t\tif (fixedHistoryItem)\n\t\t\t\t{\n\t\t\t\t\tfixedHistoryItem.setData(historyItemData);\n\t\t\t\t\tfixedHistoryItem.refreshLayout()\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprocessActivityExternalDelete(params)\n\t{\n\t\tconst entityId = BX.prop.getInteger(params, \"ENTITY_ID\", 0);\n\t\tconst historyItems = this._history.getItemsByAssociatedEntity(BX.CrmEntityType.enumeration.activity, entityId);\n\t\tfor (let i = 0, length = historyItems.length; i < length; i++)\n\t\t{\n\t\t\tthis._history.deleteItem(historyItems[i]);\n\t\t}\n\n\t\tconst fixedHistoryItems = this._fixedHistory.getItemsByAssociatedEntity(BX.CrmEntityType.enumeration.activity, entityId);\n\t\tfor (let i = 0, length = fixedHistoryItems.length; i < length; i++)\n\t\t{\n\t\t\tthis._fixedHistory.deleteItem(fixedHistoryItems[i]);\n\t\t}\n\n\t\tconst scheduleItem = this._schedule.getItemByAssociatedEntity(BX.CrmEntityType.enumeration.activity, entityId);\n\t\tif (scheduleItem)\n\t\t{\n\t\t\tthis._schedule.deleteItem(scheduleItem);\n\t\t}\n\t}\n\n\tprocessCommentExternalAdd(params)\n\t{\n\t\tlet historyItemData, historyItem;\n\t\thistoryItemData = BX.prop.getObject(params, \"HISTORY_ITEM\", null);\n\t\tif (historyItemData !== null)\n\t\t{\n\t\t\twindow.setTimeout(\n\t\t\t\tBX.delegate(function () {\n\t\t\t\t\tif (!this._history.findItemById(historyItemData['ID']))\n\t\t\t\t\t{\n\t\t\t\t\t\thistoryItem = this.addHistoryItem(historyItemData);\n\t\t\t\t\t\tExpand.create(historyItem.getWrapper(), null).run();\n\t\t\t\t\t}\n\t\t\t\t}, this),\n\t\t\t\t1500\n\t\t\t);\n\t\t}\n\t}\n\n\tprocessCommentExternalUpdate(params)\n\t{\n\t\tconst entityId = BX.prop.getInteger(params, \"ENTITY_ID\", 0);\n\t\tconst historyItemData = BX.prop.getObject(params, \"HISTORY_ITEM\", null);\n\t\tconst updateItem = this._history.findItemById(entityId);\n\t\tif (updateItem instanceof Comment && historyItemData !== null)\n\t\t{\n\t\t\tupdateItem.setData(historyItemData);\n\t\t\tupdateItem.switchToViewMode();\n\t\t}\n\t\tconst updateFixedItem = this._fixedHistory.findItemById(entityId);\n\t\tif (updateFixedItem instanceof Comment && historyItemData !== null)\n\t\t{\n\t\t\tupdateFixedItem.setData(historyItemData);\n\t\t\tupdateFixedItem.switchToViewMode();\n\t\t}\n\t}\n\n\tprocessCommentExternalDelete(params)\n\t{\n\t\tconst entityId = BX.prop.getInteger(params, \"ENTITY_ID\", 0);\n\t\twindow.setTimeout(\n\t\t\tBX.delegate(function () {\n\t\t\t\tconst deleteItem = this._history.findItemById(entityId);\n\t\t\t\tif (deleteItem instanceof Comment)\n\t\t\t\t{\n\t\t\t\t\tthis._history.deleteItem(deleteItem);\n\t\t\t\t}\n\t\t\t\tconst deleteFixedItem = this._fixedHistory.findItemById(entityId);\n\t\t\t\tif (deleteFixedItem instanceof Comment)\n\t\t\t\t{\n\t\t\t\t\tthis._fixedHistory.deleteItem(deleteFixedItem);\n\t\t\t\t}\n\t\t\t}, this),\n\t\t\t1200\n\t\t);\n\t}\n\n\tprocessChangeBinding(params)\n\t{\n\t\tconst entityId = BX.prop.getString(params, \"OLD_ID\", 0);\n\t\tconst entityNewId = BX.prop.getString(params, \"NEW_ID\", 0);\n\t\tconst item = this._history.findItemById(entityId);\n\t\tif (item instanceof Item)\n\t\t{\n\t\t\titem._id = entityNewId;\n\t\t\tconst itemData = item.getData();\n\t\t\titemData.ID = entityNewId;\n\t\t\titem.setData(itemData);\n\t\t}\n\n\t\tconst fixedItem = this._fixedHistory.findItemById(entityId);\n\t\tif (fixedItem instanceof Item)\n\t\t{\n\t\t\tfixedItem._id = entityNewId;\n\t\t\tconst fixedItemData = fixedItem.getData();\n\t\t\tfixedItemData.ID = entityNewId;\n\t\t\tfixedItem.setData(fixedItemData);\n\t\t}\n\t}\n\n\tprocessItemExternalUpdate(params)\n\t{\n\t\tconst entityId = BX.prop.getInteger(params, \"ENTITY_ID\", 0);\n\t\tconst historyItemData = BX.prop.getObject(params, \"HISTORY_ITEM\", null);\n\t\tconst historyItem = this._history.findItemById(entityId);\n\t\tif (historyItem && historyItemData !== null)\n\t\t{\n\t\t\thistoryItem.setData(historyItemData);\n\t\t\thistoryItem.markAsTerminated(this._history.checkItemForTermination(historyItem));\n\t\t\thistoryItem.refreshLayout();\n\t\t\tif (historyItem.isTerminated())\n\t\t\t{\n\t\t\t\tBX.addClass(historyItem._wrapper, \"crm-entity-stream-section-last\");\n\t\t\t}\n\t\t}\n\t}\n\n\tprocessWaitExternalAdd(params)\n\t{\n\t\tconst scheduleItemData = BX.prop.getObject(params, \"SCHEDULE_ITEM\", null);\n\t\tif (scheduleItemData !== null)\n\t\t{\n\t\t\tthis.addScheduleItem(scheduleItemData);\n\t\t}\n\t}\n\n\tprocessWaitExternalUpdate(params)\n\t{\n\t\tlet entityData, scheduleItemData, scheduleItem, historyItemData, historyItem;\n\n\t\tentityData = BX.prop.getObject(params, \"ENTITY\", null);\n\t\tscheduleItemData = BX.prop.getObject(params, \"SCHEDULE_ITEM\", null);\n\t\thistoryItemData = BX.prop.getObject(params, \"HISTORY_ITEM\", null);\n\n\t\tif (entityData)\n\t\t{\n\t\t\tif (historyItemData && !BX.type.isPlainObject(historyItemData[\"ASSOCIATED_ENTITY\"]))\n\t\t\t{\n\t\t\t\thistoryItemData[\"ASSOCIATED_ENTITY\"] = entityData;\n\t\t\t}\n\n\t\t\tconst entityId = BX.prop.getInteger(entityData, \"ID\", 0);\n\t\t\tconst historyItems = this._history.getItemsByAssociatedEntity(BX.CrmEntityType.enumeration.wait, entityId);\n\t\t\tlet i = 0;\n\t\t\tconst length = historyItems.length;\n\t\t\tfor (; i < length; i++)\n\t\t\t{\n\t\t\t\thistoryItem = historyItems[i];\n\t\t\t\thistoryItem.setAssociatedEntityData(entityData);\n\t\t\t\thistoryItem.refreshLayout();\n\t\t\t}\n\t\t}\n\n\t\tif (scheduleItemData !== null)\n\t\t{\n\t\t\tscheduleItem = this._schedule.getItemByAssociatedEntity(\n\t\t\t\tBX.CrmEntityType.enumeration.wait,\n\t\t\t\tBX.prop.getInteger(scheduleItemData, \"ASSOCIATED_ENTITY_ID\")\n\t\t\t);\n\t\t\tif (!scheduleItem)\n\t\t\t{\n\t\t\t\tthis.addScheduleItem(scheduleItemData);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tscheduleItem.setData(scheduleItemData);\n\t\t\t\tif (!scheduleItem.isDone())\n\t\t\t\t{\n\t\t\t\t\tthis._schedule.refreshItem(scheduleItem);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tif (historyItemData)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis._schedule.transferItemToHistory(\n\t\t\t\t\t\t\tscheduleItem,\n\t\t\t\t\t\t\thistoryItemData\n\t\t\t\t\t\t);\n\t\t\t\t\t\t//History data are already processed\n\t\t\t\t\t\thistoryItemData = null;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis._schedule.deleteItem(scheduleItem);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (historyItemData !== null)\n\t\t{\n\t\t\thistoryItem = this._history.findItemById(BX.prop.getString(historyItemData, \"ID\"));\n\t\t\tif (!historyItem)\n\t\t\t{\n\t\t\t\thistoryItem = this.addHistoryItem(historyItemData);\n\t\t\t\tExpand.create(historyItem.getWrapper(), null).run();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\thistoryItem.setData(historyItemData);\n\t\t\t\thistoryItem.refreshLayout();\n\t\t\t}\n\t\t}\n\t}\n\n\tprocessWaitExternalDelete(params)\n\t{\n\t\tconst entityId = BX.prop.getInteger(params, \"ENTITY_ID\", 0);\n\t\tconst historyItems = this._history.getItemsByAssociatedEntity(BX.CrmEntityType.enumeration.wait, entityId);\n\t\tlet i = 0;\n\t\tconst length = historyItems.length;\n\t\tfor (; i < length; i++)\n\t\t{\n\t\t\tthis._history.deleteItem(historyItems[i]);\n\t\t}\n\n\t\tconst scheduleItem = this._schedule.getItemByAssociatedEntity(BX.CrmEntityType.enumeration.wait, entityId);\n\t\tif (scheduleItem)\n\t\t{\n\t\t\tthis._schedule.deleteItem(scheduleItem);\n\t\t}\n\t}\n\n\tprocessBizprocStatus(params)\n\t{\n\t\tlet historyItemData, historyItem;\n\n\t\thistoryItemData = BX.prop.getObject(params, \"HISTORY_ITEM\", null);\n\n\t\tif (historyItemData !== null)\n\t\t{\n\t\t\thistoryItem = this.addHistoryItem(historyItemData);\n\t\t\tExpand.create(historyItem.getWrapper(), null).run();\n\t\t}\n\t}\n\n\tprocessScoringExternalAdd(params)\n\t{\n\t\tlet historyItemData, historyItem;\n\t\thistoryItemData = BX.prop.getObject(params, \"HISTORY_ITEM\", null);\n\t\tif (historyItemData !== null)\n\t\t{\n\t\t\thistoryItem = this.addHistoryItem(historyItemData);\n\t\t\tExpand.create(historyItem.getWrapper(), null).run();\n\t\t}\n\t}\n\n\tonEntityProgressChange(sender, eventArgs)\n\t{\n\t\tif (BX.prop.getInteger(eventArgs, \"entityTypeId\", 0) !== this._ownerTypeId\n\t\t\t|| BX.prop.getInteger(eventArgs, \"entityId\", 0) !== this._ownerId\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst semantics = BX.prop.getString(eventArgs, \"semantics\", \"\");\n\t\tif (semantics === this._progressSemantics)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis._progressSemantics = semantics;\n\t\tthis._schedule.refreshLayout();\n\t}\n\n\tgetId()\n\t{\n\t\treturn this._id;\n\t}\n\n\tgetSetting(name, defaultval)\n\t{\n\t\treturn this._settings.hasOwnProperty(name) ? this._settings[name] : defaultval;\n\t}\n\n\tgetOwnerTypeId()\n\t{\n\t\treturn this._ownerTypeId;\n\t}\n\n\tgetOwnerId()\n\t{\n\t\treturn this._ownerId;\n\t}\n\n\tgetOwnerInfo()\n\t{\n\t\treturn this._ownerInfo;\n\t}\n\n\tisStubCounterEnabled()\n\t{\n\t\treturn false;\n\t}\n\n\tgetSchedule()\n\t{\n\t\treturn this._schedule;\n\t}\n\n\tgetHistory()\n\t{\n\t\treturn this._history;\n\t}\n\n\tgetFixedHistory()\n\t{\n\t\treturn this._fixedHistory;\n\t}\n\n\tprocessSheduleLayoutChange()\n\t{\n\t}\n\n\tprocessHistoryLayoutChange()\n\t{\n\t\tthis._schedule.refreshLayout();\n\t}\n\n\taddScheduleItem(data)\n\t{\n\t\tconst item = this._schedule.createItem(data);\n\t\tconst index = this._schedule.calculateItemIndex(item);\n\t\tconst anchor = this._schedule.createAnchor(index);\n\t\tthis._schedule.addItem(item, index);\n\t\titem.layout({anchor: anchor});\n\n\t\treturn item;\n\t}\n\n\taddHistoryItem(data)\n\t{\n\t\tconst item = this._history.createItem(data);\n\t\tconst index = this._history.calculateItemIndex(item);\n\t\tconst historyAnchor = this._history.createAnchor(index);\n\t\tthis._history.addItem(item, index);\n\t\titem.layout({anchor: historyAnchor});\n\n\t\treturn item;\n\t}\n\n\trenderAudioDummy(durationText, onClick)\n\t{\n\t\treturn BX.create(\"DIV\", {\n\t\t\tattrs: {className: \"crm-audio-cap-wrap-container\"},\n\t\t\tchildren: [\n\t\t\t\tBX.create(\"DIV\", {\n\t\t\t\t\tattrs: {className: \"crm-audio-cap-wrap\"},\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"DIV\", {\n\t\t\t\t\t\t\t\tattrs: {className: \"crm-audio-cap-time\"},\n\t\t\t\t\t\t\t\ttext: durationText\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t],\n\t\t\t\t\tevents: {click: onClick}\n\t\t\t\t})\n\t\t\t]\n\t\t});\n\t}\n\n\tloadMediaPlayer(id, filePath, mediaType, node, duration, options)\n\t{\n\t\tif (!duration)\n\t\t{\n\t\t\tduration = 0;\n\t\t}\n\t\tif (!options)\n\t\t{\n\t\t\toptions = {};\n\t\t}\n\t\tconst player = new BX.Fileman.Player(id, {\n\t\t\tsources: [\n\t\t\t\t{\n\t\t\t\t\tsrc: filePath,\n\t\t\t\t\ttype: mediaType\n\t\t\t\t}\n\t\t\t],\n\t\t\tisAudio: !options.video,\n\t\t\tskin: options.hasOwnProperty('skin') ? options.skin : 'vjs-timeline_player-skin',\n\t\t\twidth: options.width || 350,\n\t\t\theight: options.height || 30,\n\t\t\tduration: duration,\n\t\t\tplaybackRate: options.playbackRate || null,\n\t\t\tonInit: function (player) {\n\t\t\t\tplayer.vjsPlayer.controlBar.removeChild('timeDivider');\n\t\t\t\tplayer.vjsPlayer.controlBar.removeChild('durationDisplay');\n\t\t\t\tplayer.vjsPlayer.controlBar.removeChild('fullscreenToggle');\n\t\t\t\tplayer.vjsPlayer.controlBar.addChild('timeDivider');\n\t\t\t\tplayer.vjsPlayer.controlBar.addChild('durationDisplay');\n\t\t\t\tif (!player.isPlaying())\n\t\t\t\t{\n\t\t\t\t\tplayer.play();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tBX.cleanNode(node, false);\n\t\tnode.appendChild(player.createElement());\n\t\tplayer.init();\n\t\t// todo remove this after player will be able to get float playbackRate\n\t\tif (options.playbackRate > 1)\n\t\t{\n\t\t\tplayer.vjsPlayer.playbackRate(options.playbackRate);\n\t\t}\n\t\treturn player;\n\t}\n\n\tonActivityCreated(activity, data)\n\t{\n\t\t//Already processed in onPullEvent\n\t}\n\n\tisSpotlightShowed()\n\t{\n\t\treturn this._spotlightFastenShowed;\n\t}\n\n\tsetSpotlightShowed()\n\t{\n\t\tthis._spotlightFastenShowed = true;\n\t}\n\n\tgetCurrentUser(): ?Object\n\t{\n\t\tif (BX.type.isObject(this._currentUser) && this._userId > 0)\n\t\t{\n\t\t\tthis._currentUser.userId = this._userId;\n\t\t}\n\t\t\n\t\treturn this._currentUser;\n\t}\n\n\tgetAudioPlaybackRateSelector()\n\t{\n\t\tif (!this.audioPlaybackRateSelector)\n\t\t{\n\t\t\tthis.audioPlaybackRateSelector = new AudioPlaybackRateSelector({\n\t\t\t\tname: 'timeline_audio_playback',\n\t\t\t\tcurrentRate: this._audioPlaybackRate,\n\t\t\t\tavailableRates: [\n\t\t\t\t\t{\n\t\t\t\t\t\trate: 1,\n\t\t\t\t\t\thtml: BX.Loc.getMessage('CRM_TIMELINE_PLAYBACK_RATE_SELECTOR_RATE_1')\n\t\t\t\t\t\t\t.replace('#RATE#', '<span class=\"crm-audio-cap-speed-param\">1x</span>')\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\trate: 1.5,\n\t\t\t\t\t\thtml: BX.Loc.getMessage('CRM_TIMELINE_PLAYBACK_RATE_SELECTOR_RATE_1.5')\n\t\t\t\t\t\t\t.replace('#RATE#', '<span class=\"crm-audio-cap-speed-param\">1.5x</span>')\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\trate: 2,\n\t\t\t\t\t\thtml: BX.Loc.getMessage('CRM_TIMELINE_PLAYBACK_RATE_SELECTOR_RATE_2')\n\t\t\t\t\t\t\t.replace('#RATE#', '<span class=\"crm-audio-cap-speed-param\">2x</span>')\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\trate: 3,\n\t\t\t\t\t\thtml: BX.Loc.getMessage('CRM_TIMELINE_PLAYBACK_RATE_SELECTOR_RATE_3')\n\t\t\t\t\t\t\t.replace('#RATE#', '<span class=\"crm-audio-cap-speed-param\">3x</span>')\n\t\t\t\t\t}\n\t\t\t\t],\n\t\t\t\ttextMessageCode: 'CRM_TIMELINE_PLAYBACK_RATE_SELECTOR_TEXT'\n\t\t\t});\n\t\t}\n\n\t\treturn this.audioPlaybackRateSelector;\n\t}\n\n\thasScheduledItems(): boolean\n\t{\n\t\treturn this._schedule.getItems().length > 0;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Manager();\n\t\tself.initialize(id, settings);\n\t\tManager.instances[self.getId()] = self;\n\t\treturn self;\n\t}\n\n\tstatic getDefault(): ?Manager\n\t{\n\t\treturn Manager.#defaultInstance;\n\t}\n\tstatic setDefault(instance): void\n\t{\n\t\tManager.#defaultInstance = instance;\n\t}\n\n\tstatic getById(id): ?Manager\n\t{\n\t\treturn Manager.instances[id] || null;\n\t}\n\n\tstatic #defaultInstance = null;\n\tstatic instances = {};\n}\n","import Activity from \"./activity\";\n\n/** @memberof BX.Crm.Timeline.Actions */\nexport default class SchedulePostpone extends Activity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._button = null;\n\t\tthis._clickHandler = BX.delegate(this.onClick, this);\n\t\tthis._isMenuShown = false;\n\n\t\tthis._menu = false;\n\t}\n\n\tdoLayout()\n\t{\n\t\tthis._button = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs:\n\t\t\t\t\t{\n\t\t\t\t\t\tclassName: this._isEnabled\n\t\t\t\t\t\t\t? \"crm-entity-stream-planned-action-aside\"\n\t\t\t\t\t\t\t: \"crm-entity-stream-planned-action-aside-disabled\"\n\t\t\t\t\t},\n\t\t\t\ttext: this.getMessage(\"postpone\")\n\t\t\t}\n\t\t);\n\n\t\tif(this._isEnabled)\n\t\t{\n\t\t\tBX.bind(this._button, \"click\", this._clickHandler)\n\t\t}\n\n\t\tthis._container.appendChild(this._button);\n\t}\n\n\topenMenu()\n\t{\n\t\tif(this._isMenuShown)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst handler = BX.delegate(this.onMenuItemClick, this);\n\t\tconst menuItems =\n\t\t\t[\n\t\t\t\t{id: \"hour_1\", text: this.getMessage(\"forOneHour\"), onclick: handler},\n\t\t\t\t{id: \"hour_2\", text: this.getMessage(\"forTwoHours\"), onclick: handler},\n\t\t\t\t{id: \"hour_3\", text: this.getMessage(\"forThreeHours\"), onclick: handler},\n\t\t\t\t{id: \"day_1\", text: this.getMessage(\"forOneDay\"), onclick: handler},\n\t\t\t\t{id: \"day_2\", text: this.getMessage(\"forTwoDays\"), onclick: handler},\n\t\t\t\t{id: \"day_3\", text: this.getMessage(\"forThreeDays\"), onclick: handler}\n\t\t\t];\n\n\t\tBX.PopupMenu.show(\n\t\t\tthis._id,\n\t\t\tthis._button,\n\t\t\tmenuItems,\n\t\t\t{\n\t\t\t\toffsetTop: 0,\n\t\t\t\toffsetLeft: 16,\n\t\t\t\tevents:\n\t\t\t\t\t{\n\t\t\t\t\t\tonPopupShow: BX.delegate(this.onMenuShow, this),\n\t\t\t\t\t\tonPopupClose: BX.delegate(this.onMenuClose, this),\n\t\t\t\t\t\tonPopupDestroy: BX.delegate(this.onMenuDestroy, this)\n\t\t\t\t\t}\n\t\t\t}\n\t\t);\n\n\t\tthis._menu = BX.PopupMenu.currentItem;\n\t}\n\n\tcloseMenu()\n\t{\n\t\tif(!this._isMenuShown)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif(this._menu)\n\t\t{\n\t\t\tthis._menu.close();\n\t\t}\n\t}\n\n\tonClick()\n\t{\n\t\tif(!this._isEnabled)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif(this._isMenuShown)\n\t\t{\n\t\t\tthis.closeMenu();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.openMenu();\n\t\t}\n\t}\n\n\tonMenuItemClick(e, item)\n\t{\n\t\tthis.closeMenu();\n\n\t\tlet offset = 0;\n\t\tif(item.id === \"hour_1\")\n\t\t{\n\t\t\toffset = 3600;\n\t\t}\n\t\telse if(item.id === \"hour_2\")\n\t\t{\n\t\t\toffset = 7200;\n\t\t}\n\t\telse if(item.id === \"hour_3\")\n\t\t{\n\t\t\toffset = 10800;\n\t\t}\n\t\telse if(item.id === \"day_1\")\n\t\t{\n\t\t\toffset = 86400;\n\t\t}\n\t\telse if(item.id === \"day_2\")\n\t\t{\n\t\t\toffset = 172800;\n\t\t}\n\t\telse if(item.id === \"day_3\")\n\t\t{\n\t\t\toffset = 259200;\n\t\t}\n\n\t\tif(offset > 0 && this._item)\n\t\t{\n\t\t\tthis._item.postpone(offset);\n\t\t}\n\t}\n\n\tonMenuShow()\n\t{\n\t\tthis._isMenuShown = true;\n\t}\n\n\tonMenuClose()\n\t{\n\t\tif(this._menu && this._menu.popupWindow)\n\t\t{\n\t\t\tthis._menu.popupWindow.destroy();\n\t\t}\n\t}\n\n\tonMenuDestroy()\n\t{\n\t\tthis._isMenuShown = false;\n\t\tthis._menu = null;\n\n\t\tif(typeof(BX.PopupMenu.Data[this._id]) !== \"undefined\")\n\t\t{\n\t\t\tdelete(BX.PopupMenu.Data[this._id]);\n\t\t}\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = SchedulePostpone.messages;\n\t\treturn m.hasOwnProperty(name) ? m[name] : name;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new SchedulePostpone();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n\n\tstatic messages = {};\n}\n","import Shift from \"./shift\";\n\n/** @memberof BX.Crm.Timeline.Animation */\nexport default class Comment\n{\n\tconstructor()\n\t{\n\t\tthis._node = null;\n\t\tthis._anchor = null;\n\t\tthis._nodeParent  = null;\n\t\tthis._startPosition = null;\n\t\tthis._events = null;\n\t}\n\n\tinitialize(node, anchor, startPosition, events)\n\t{\n\t\tthis._node = node;\n\t\tthis._anchor = anchor;\n\t\tthis._nodeParent  = node.parentNode;\n\t\tthis._startPosition = startPosition;\n\t\tthis._events = BX.type.isPlainObject(events) ? events : {};\n\n\t}\n\n\trun()\n\t{\n\t\tBX.addClass(this._node, 'crm-entity-stream-section-animate-start');\n\n\t\tthis._node.style.position = \"absolute\";\n\t\tthis._node.style.width = this._startPosition.width + \"px\";\n\t\tthis._node.style.height = this._startPosition.height + \"px\";\n\t\tthis._node.style.top = this._startPosition.top - 30 + \"px\";\n\t\tthis._node.style.left = this._startPosition.left + \"px\";\n\t\tthis._node.style.opacity = 0;\n\t\tthis._node.style.zIndex = 960;\n\n\t\tdocument.body.appendChild(this._node);\n\n\t\tconst nodeOpacityAnim = new BX.easing({\n\t\t\tduration: 350,\n\t\t\tstart: {opacity: 0},\n\t\t\tfinish: {opacity: 100},\n\t\t\ttransition: BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\tstep: BX.proxy(function (state) {\n\t\t\t\tthis._node.style.opacity = state.opacity / 100;\n\t\t\t}, this),\n\t\t\tcomplete: BX.proxy(function () {\n\t\t\t\tif (BX.type.isFunction(this._events[\"start\"]))\n\t\t\t\t{\n\t\t\t\t\tthis._events[\"start\"]();\n\t\t\t\t}\n\t\t\t\tconst shift = Shift.create(\n\t\t\t\t\tthis._node,\n\t\t\t\t\tthis._anchor,\n\t\t\t\t\tthis._startPosition,\n\t\t\t\t\tfalse,\n\t\t\t\t\t{complete: BX.delegate(this.finish, this)}\n\t\t\t\t);\n\t\t\t\tshift.run();\n\t\t\t}, this)\n\t\t});\n\t\tnodeOpacityAnim.animate();\n\n\n\t\tif(BX.type.isFunction(this._events[\"complete\"]))\n\t\t{\n\t\t\tthis._events[\"complete\"]();\n\t\t}\n\t}\n\n\tfinish()\n\t{\n\t\tthis._node.style.position = \"\";\n\t\tthis._node.style.width = \"\";\n\t\tthis._node.style.height = \"\";\n\t\tthis._node.style.top = \"\";\n\t\tthis._node.style.left = \"\";\n\t\tthis._node.style.opacity = \"\";\n\t\tthis._node.style.zIndex = \"\";\n\t\tthis._anchor.style.height = \"\";\n\t\tthis._anchor.parentNode.insertBefore(this._node, this._anchor.nextSibling);\n\t\tsetTimeout(\n\t\t\tBX.delegate(function() {\n\t\t\t\tBX.removeClass(this._node, 'crm-entity-stream-section-animate-start');\n\t\t\t\tBX.remove(this._anchor);\n\t\t\t}, this),\n\t\t\t0\n\t\t);\n\t}\n\n\tstatic create(node, anchor, startPosition, events)\n\t{\n\t\tconst self = new Comment();\n\t\tself.initialize(node, anchor, startPosition, events);\n\t\treturn self;\n\t}\n}\n","import Manager from \"./manager\";\nimport Stream from \"./stream\";\nimport History from \"./streams/history\";\nimport FixedHistory from \"./streams/fixedhistory\";\nimport EntityChat from \"./streams/entitychat\";\nimport Schedule from \"./streams/schedule\";\nimport SchedulePostponeController from \"./tools/schedule-postpone-controller\";\nimport AudioPlaybackRateSelector from \"./tools/audio-playback-rate-selector\";\nimport * as Types from \"./types\";\nimport Action from \"./action\";\nimport Activity from \"./actions/activity\";\nimport {Call, HistoryCall, ScheduleCall} from \"./actions/call\";\nimport {Email, HistoryEmail, ScheduleEmail} from \"./actions/email\";\nimport {OpenLine} from \"./actions/openline\";\nimport SchedulePostpone from \"./actions/schedule-postpone\";\nimport CompatibleItem from \"./items/compatible-item\";\nimport HistoryItem from \"./items/history\";\nimport HistoryActivity from \"./items/history-activity\";\nimport CommentItem from \"./items/comment\";\nimport Modification from \"./items/modification\";\nimport Mark from \"./items/mark\";\nimport Creation from \"./items/creation\";\nimport Restoration from \"./items/restoration\";\nimport Relation from \"./items/relation\";\nimport Link from \"./items/link\";\nimport Unlink from \"./items/unlink\";\nimport EmailItem from \"./items/email\";\nimport CallItem from \"./items/call\";\nimport Meeting from \"./items/meeting\";\nimport Task from \"./items/task\";\nimport WebForm from \"./items/webform\";\nimport WaitItem from \"./items/wait\";\nimport Document from \"./items/document\";\nimport Sender from \"./items/sender\";\nimport Bizproc from \"./items/bizproc\";\nimport Request from \"./items/request\";\nimport RestItem from \"./items/rest\";\nimport OpenLineItem from \"./items/openline\";\nimport Zoom from \"./items/zoom\";\nimport Conversion from \"./items/conversion\";\nimport Visit from \"./items/visit\";\nimport Scoring from \"./items/scoring\";\nimport ExternalNoticeModification from \"./items/external-notice-modification\";\nimport ExternalNoticeStatusModification from \"./items/external-notice-status-modification\";\nimport Scheduled from \"./items/scheduled\";\nimport ScheduledActivity from \"./items/scheduled/activity\";\nimport ScheduledEmail from \"./items/scheduled/email\";\nimport ScheduledCall from \"./items/scheduled/call\";\nimport CallTracker from \"./items/scheduled/call-tracker\";\nimport ScheduledMeeting from \"./items/scheduled/meeting\";\nimport ScheduledTask from \"./items/scheduled/task\";\nimport ScheduledWebForm from \"./items/scheduled/webform\";\nimport ScheduledWait from \"./items/scheduled/wait\";\nimport ScheduledRequest from \"./items/scheduled/request\";\nimport ScheduledRest from \"./items/scheduled/rest\";\nimport ScheduledOpenLine from \"./items/scheduled/openline\";\nimport ScheduledZoom from \"./items/scheduled/zoom\";\nimport AnimationItem from \"./animations/item\";\nimport ItemNew from \"./animations/item-new\";\nimport Expand from \"./animations/expand\";\nimport Shift from \"./animations/shift\";\nimport AnimationComment from \"./animations/comment\";\nimport Fasten from \"./animations/fasten\";\n\nconst Streams = {\n\tHistory,\n\tFixedHistory,\n\tEntityChat,\n\tSchedule,\n}\n\nconst Tools = {\n\tSchedulePostponeController,\n\tAudioPlaybackRateSelector,\n}\n\nconst Actions = {\n\tActivity,\n\tCall,\n\tHistoryCall,\n\tScheduleCall,\n\tEmail,\n\tHistoryEmail,\n\tScheduleEmail,\n\tOpenLine,\n\tSchedulePostpone,\n}\n\nconst ScheduledItems = {\n\tActivity: ScheduledActivity,\n\tEmail: ScheduledEmail,\n\tCall: ScheduledCall,\n\tCallTracker,\n\tMeeting: ScheduledMeeting,\n\tTask: ScheduledTask,\n\tWebForm: ScheduledWebForm,\n\tWait: ScheduledWait,\n\tRequest: ScheduledRequest,\n\tRest: ScheduledRest,\n\tOpenLine: ScheduledOpenLine,\n\tZoom: ScheduledZoom,\n}\n\nconst Items = {\n\tHistory: HistoryItem,\n\tHistoryActivity,\n\tComment: CommentItem,\n\tModification,\n\tMark,\n\tCreation,\n\tRestoration,\n\tRelation,\n\tLink,\n\tUnlink,\n\tEmail: EmailItem,\n\tCall: CallItem,\n\tMeeting,\n\tTask,\n\tWebForm,\n\tWait: WaitItem,\n\tDocument,\n\tSender,\n\tBizproc,\n\tRequest,\n\tRest: RestItem,\n\tOpenLine: OpenLineItem,\n\tZoom,\n\tConversion,\n\tVisit,\n\tScoring,\n\tExternalNoticeModification,\n\tExternalNoticeStatusModification,\n\tScheduledBase: Scheduled,\n\tScheduled: ScheduledItems,\n}\n\nconst Animations = {\n\tItem: AnimationItem,\n\tItemNew,\n\tExpand,\n\tShift,\n\tComment: AnimationComment,\n\tFasten,\n};\n\nexport {\n\tManager,\n\tStream,\n\tStreams,\n\tTools,\n\tTypes,\n\tAction,\n\tActions,\n\tItems,\n\tAnimations,\n\tCompatibleItem,\n};\n"],"names":["Item","undefined","activity","creation","modification","link","unlink","mark","comment","wait","bizproc","conversion","sender","document","restoration","order","orderCheck","scoring","externalNotification","finalSummary","delivery","finalSummaryDocuments","storeDocument","productCompilation","signDocument","Mark","waiting","success","renew","ignored","failed","Order","encourageBuyProducts","EditorMode","view","edit","CompatibleItem","_id","_settings","_data","_container","_typeCategoryId","_associatedEntityData","_associatedEntityTypeId","_associatedEntityId","_isContextMenuShown","_contextMenuButton","_activityEditor","_actions","_actionContainer","_existedStreamItemDeadLine","id","settings","_setId","getSetting","BX","type","isPlainObject","doInitialize","name","defaultval","hasOwnProperty","data","clearCachedData","prop","getInteger","associatedEntityData","ASSOCIATED_ENTITY","setData","entityData","getAssociatedEntityData","getObject","permissions","Type","PERMISSIONS","getString","getArray","ItemType","container","isElementNode","options","prepareLayout","prepareActions","actionQty","length","i","layout","showActions","show","isDone","text","isNumber","offset","whilespaceOffset","substring","search","clickHandler","util","htmlspecialchars","replace","create","attrs","className","href","events","click","getMessage","authorInfo","getObjectDataParam","showUrl","target","title","children","imageUrl","style","backgroundImage","encodeURI","backgroundSize","delegate","onContextMenuButtonClick","e","openContextMenu","closeContextMenu","menuItems","prepareContextMenuItems","IntranetExtensions","push","PopupMenu","offsetTop","offsetLeft","angle","position","onPopupShow","onContextMenuShow","onPopupClose","onContextMenuClose","onPopupDestroy","onContextMenuDestroy","_contextMenu","currentItem","close","addClass","popupWindow","destroy","removeClass","Data","m","messages","TimezoneOffset","USER_TO_SERVER","Fasten","_initialItem","_finalItem","_events","isNotEmptyString","getRandomString","_anchor","defaultValue","node","getWrapper","parentNode","insertBefore","nextSibling","setTimeout","_clone","cloneNode","_startPosition","pos","width","_cloneHeight","height","_minHeight","_sumPaddingContent","top","left","zIndex","body","appendChild","proxy","_anchorPosition","finish","opacity","_difference","bottom","_deepHistoryLimit","clientHeight","_duration","Math","abs","movingEvent","easing","duration","start","transition","makeEaseOut","transitions","quart","step","state","complete","animate","addFixedHistoryItem","remove","isFunction","self","initialize","History","_history","_fixedHistory","_typeId","_createdTime","_isFixed","_headerClickHandler","onHeaderClick","isReadOnly","getTextDataParam","time","parseDate","getCreatedTimestamp","DatetimeConverter","toUserTime","getValue","extractDate","Date","getCreatedTime","getTime","getOwnerInfo","CrmEntityType","enumeration","typeId","getTypeId","CrmActivityStatus","isFinal","_items","fastenLimitPopup","PopupWindow","_switcher","content","message","darkMode","autoHide","closeByEsc","bindOptions","forceBindPosition","ajax","url","_serviceUrl","method","dataType","getOwnerTypeId","getOwnerId","result","ERROR","isFixed","IS_FIXED","fixedItem","createItem","addItem","add","refreshLayout","animation","initialItem","finalItem","anchor","run","item","historyItem","findItemById","index","getItemIndex","clearAnimate","removeItemByIndex","LazyLoad","showImages","isDomNode","_wrapper","wrapperPosition","hideEvent","marginBottom","clearLayout","wrapperClassName","getWrapperClassName","wrapper","getIconClassName","isContextMenuEnabled","Dom","append","prepareContextMenuButton","contentWrapper","header","getTitle","formatTime","prepareContentDetails","authorNode","prepareAuthorLayout","prepareContent","enableAdd","getBoolean","markAsTerminated","checkItemForTermination","preventDefault","returnValue","unfasten","fasten","manager","getManager","isSpotlightShowed","setSpotlightShowed","spotlight","SpotLight","targetElement","targetVertex","lightMode","autoSave","prepareTitleLayout","statusNode","getStatusNode","onActivityCreated","deadline","isDate","setHours","setMinutes","setSeconds","setMilliseconds","end","lightTime","now","Scheduled","_schedule","_deadlineNode","_setAsDoneButtonHandler","onSetAsDoneButtonClick","CrmActivityEditor","hasPermissions","verifyPermissions","loadPermissions","userId","getPermissions","getUserId","getServiceUrl","getAssociatedEntityId","onsuccess","onPermissionsLoad","bind","setPermissions","window","getDeadline","isCounterEnabledByLightTime","getLightTime","markAsDone","onItemMarkedAsDone","innerHTML","formatDateTime","isIncomingChannel","perms","canComplete","setAsDone","_node","originalPosition","_initialYPosition","_initialXPosition","_initialWidth","offsetWidth","_initialHeight","offsetHeight","_anchorYPosition","createStub","createGhost","moveGhost","_stub","props","_ghostNode","boxShadow","placeEventAnim","addHistoryItem","removeGhost","_finalItemHeight","ghostNode","finalNode","overflow","hideCasperItem","collapseStub","removePlannedEvent","inited","Shift","_nodeParent","startPosition","shadowNode","_shadowNode","ItemNew","_areAnimatedItemsVisible","initWrapper","initLayoutApp","offsetParent","shift","stubContainer","querySelector","paddingTop","paddingBottom","Steam","_manager","_timeFormat","_year","_isStubMode","_userId","_readOnly","_streamType","StreamType","history","_editorContainer","Manager","datetimeFormat","dateFormat","date","convertBitrixFormat","trim","getFullYear","getStreamType","scheduled","pinned","currentUrl","ajaxId","insertToNode","add_url_param","bxajaxid","location","SERVER_TO_UTC","utc","format","Format","DAY_MONTH_FORMAT","LONG_DATE_FORMAT","whitespaceOffset","items","Error","getItems","toString","find","getId","findIndex","splice","setItems","ConfigurableItem","clone","getData","animateUpdate","animateMove","Promise","resolve","itemPositionChanged","newIndex","newItem","isScheduleStream","createItemCopy","calculateItemIndex","animateItemAdding","createAnchor","ItemAnimation","deleteItem","getPosition","destinationStream","destinationItem","EntityChat","_layoutType","LayoutType","none","_contentWrapper","_messageWrapper","_messageDateNode","_messageTexWrapper","_messageTextNode","_userWrapper","_extraUserCounter","isLoading","_openChatHandler","onOpenChat","lockScript","isString","eval","parseInt","isNaN","getUserInfoData","userInfos","counter","isEnabled","isStubMode","getChatId","renderSummary","renderInvitation","addCustomEvent","onChatEvent","cleanNode","invitation","refreshUsers","summary","_messageTexWraper","_messageCounterNode","refreshSummary","infos","list","Object","values","count","info","icon","display","getMessageData","isoDate","remoteDate","getServerTimezoneOffset","getUserTimezoneOffset","localTime","params","ATTACH","FILE_ID","MessengerCommon","Reflection","getClass","MessengerParser","purifyText","purify","attach","files","classList","isUndefined","Messenger","Public","isRestricted","applyLockScript","ownerInfo","entityId","entityTypeId","successCallback","response","loading","chatId","openChat","errorCallback","error","errorMessage","errors","UI","Notification","Center","notify","autoHideDelay","runAction","then","command","extras","setUserInfoData","mergeEx","refreshUsersAnimated","removeUserInfo","setMessageData","setUnreadMessageCounter","refreshSummaryAnimated","Stream","AudioPlaybackRateSelector","menuId","isArray","availableRates","currentRate","normalizeRate","textMessageCode","renderedItems","players","rateDescription","rate","parseFloat","isRateCurrent","selectedRate","getRate","map","html","onclick","setRate","popupMenu","Main","MenuManager","getMenuById","getPopupWindow","setBindElement","bindElement","getMenuItems","getPopup","userOptions","save","textNode","getText","vjsPlayer","playbackRate","Loc","event","player","Fileman","Player","SchedulePostponeController","_item","get","indexOf","postpone","Activity","_postponeController","status","completed","autoCompleted","setActivityCompleted","onSetAsDoneCompleted","getSourceId","postponeActivity","onPosponeCompleted","viewActivity","associatedEntityTypeId","getAssociatedEntityTypeId","editActivity","_detetionConfirmDlgId","dlg","Crm","ConfirmationDialog","getRemoveMessage","open","onRemovalConfirm","onRemovalCancel","activityEditor","getItemById","deleteActivity","activityType","activityId","serviceUrl","action","ownertype","ownerid","_handleActivityChange","onfailure","IS_INCOMING_CHANNEL","direction","CrmActivityDirection","incoming","canPostpone","timeText","getCreatedDate","subject","description","communication","communicationValue","getItemClassName","iconClassName","isCounterEnabled","contentInnerWrapper","headerWrapper","getTypeDescription","detailWrapper","cutOffText","additionalDetails","prepareDetailNodes","members","getPrepositionText","communicationNode","prepareCommunicationNode","setAsDoneButton","checked","change","disabled","buttonContainer","isEditable","processRemoval","handler","onContextMenuItemSelect","postponeMenu","commands","getCommandList","processCommand","Email","CrmScheduleEmailAction","Call","CrmScheduleCallAction","callInfo","callTypeText","messageName","CallTracker","isSuccessfull","statusText","Meeting","Task","WebForm","Wait","editor","Timeline","MenuBar","getDefault","strip_tags","nl2br","Request","Rest","iconNode","backgroundPosition","backgroundColor","Action","doLayout","_entityData","_isEnabled","callback","getActivityCommunications","getActivityId","communications","OpenLine","_clickHandler","onClick","_button","alert","slug","openMessengerSlider","RECENT","MENU","OpenLineAction","messageWrapper","openLineData","isExternal","Zoom","topic","startTime","toDatetimeString","delimiter","detailZoomMessage","detailZoomInfoLink","detailZoomInfo","detailZoomCopyInviteLink","clipboard","bindCopyClick","detailZoomStartConferenceButton","detailZoomCopyInviteLinkWrapper","Schedule","itemData","label","addStub","setContainer","processSheduleLayoutChange","onCustomEvent","hasContent","stubIcon","isStubCounterEnabled","isTerminated","getItemCount","getLastItem","sort","getSort","curSort","j","$entityTypeId","getItemByAssociatedEntity","entityTypeID","entityID","itemId","resolveName","timelineId","itemClassName","currentUser","getCurrentUser","ownerTypeId","ownerId","streamType","schedule","providerId","CrmActivityType","email","call","meeting","task","provider","removeStub","historyItemData","onTransferComplete","stubClassName","stubIconClassName","canAddTodo","stubMessage","lead","deal","focusOnTodoEditor","menuBar","setActiveItemById","todoEditor","focus","addWrapperClass","Modification","prepareHeaderLayout","contentChildren","Conversion","entityNodes","entityInfos","getArrayDataParam","entityInfo","entityNode","getNotFoundMessage","_saveHandler","onSave","CrmActivityProvider","Bitrix24","Slider","addEmail","addOnSave","loadActivityCommunications","CrmActivityEmail","prepareReply","PreventDefault","onActivityCreate","HistoryEmail","ScheduleEmail","HistoryActivity","typeCategoryId","getTypeCategoryId","markTypeId","markText","_isMenuShown","emailInfo","markNode","prepareMarkLayout","prepareTimeLayout","communicationTitle","communicationShowUrl","outerWrapper","communicationWrapper","prepareCutOffElements","prepareFixedSwitcherLayout","_menu","_menuItems","phone","getItemData","phones","addCall","showMenu","prepareMenuItems","PopupMenuWindow","onMenuShow","onMenuClose","onMenuDestroy","onMenuItemClick","l","value","formattedValue","complexName","itemText","closeMenu","phoneTo","HistoryCall","ScheduleCall","_playerDummyClickHandler","onPlayerDummyClick","_playerWrapper","_transcriptWrapper","_mediaFileInfo","hasCallInfo","communicationValueFormatted","durationText","hasTranscript","isTranscriptPending","callId","callComment","prepareMultilineCutOffElements","callInfoWrapper","renderAudioDummy","getAudioPlaybackRateSelector","render","Voximplant","Transcript","stubNode","addPlayer","loadMediaPlayer","entityDetailWrapper","Visit","visitInfo","recordLength","recordLengthFormatted","vkProfile","createTextNode","getVkProfileUrl","profile","Restriction","getHandler","_videoDummy","_audioDummy","_videoPlayer","_audioPlayer","_audioLengthElement","_recordings","_currentRecordingIndex","zoomActivitySubject","_downloadWrapper","_downloadSubject","_downloadSubjectDetail","_downloadVideoLink","_downloadSeparator","_downloadAudioLink","_playVideoLink","detailZoomCopyVideoLink","prepareSuccessfulLayout","zoomData","tabs","recording","active","tabsComponent","TabsComponent","eventEmitter","subscribe","_onTabChange","_onVideoDummyClick","dataset","hint","Hint","init","_onAudioDummyClick","videoLinkExpireTS","videoLinkContainer","_detailZoomCopyVideoLink","zoomAudioDetailWrapper","setCurrentRecording","hide","video","skin","tabId","recordingIndex","videoRecording","audioRecording","hidden","pause","setSource","innerText","clean","lengthHuman","lastElementChild","config","elements","Event","EventEmitter","_renderTab","tabDescription","setActiveTab","Number","emit","OrderModification","statusInfo","classCode","fieldName","fields","names","orderpayment","psStatusCode","ordershipment","getStatusInfo","isNotEmptyObject","htmlTitle","nodes","descriptionNode","legend","sublegend","destination","detailNode","sliderLinkNode","startSalescenterApplication","loadExt","paymentId","shipmentId","orderId","Salescenter","openApplication","disableSendButton","context","mode","templateMode","paySystemName","sum","currency","paymentDetail","logotip","isPaid","isClick","isManualContinuePay","isManualAddCheck","preparePaidPaymentContent","prepareClickedPaymentContent","prepareManualContinuePayContent","prepareManualAddCheck","prepareItemOrderContent","isViewed","isSent","getHeaderChildren","prepareViewedContentDetails","prepareSentContentDetails","prepareErrorPaymentContentDetails","headerWrap","preparePaidPaymentContentDetails","paySystemError","errorDetailNode","prepareClickedPaymentContentDetails","Helper","ExternalNoticeModification","ExternalNoticeStatusModification","Creation","docType","entityTypeName","toLowerCase","msg","isMessageNotFound","TYPE_CATEGORY_ID","HTML_TITLE","createOrderEntityItem","orderData","ID","ORDER_DATE","SHOW_URL","SUM","spanAttrs","linkAttrs","baseEntityData","baseEntityInfo","HistoryItem","Restoration","Relation","Text","encode","Link","Unlink","activityProviderId","MarkType","isDefined","innerWrapper","associatedEntityTitle","contentTemplate","Page","Comment","_isCollapsed","_hasFiles","_postForm","_editor","_commentMessage","_mode","_streamContentEventBlock","_playerWrappers","file","playerWrapper","entityValueId","forEach","extension","firstElementChild","detailChildren","_commentWrapper","switchToEditMode","buttons","switchToViewMode","cleanText","_hasInlineAttachment","onExpandButtonClick","_textLoaded","_fileBlock","ready","loadContent","registerImages","viewElementBind","showTitle","getAttribute","BLOCK","promise","_editorName","oEditor","SetContent","ReInitIframe","actionData","onLoadEditorSuccess","catch","showEditor","LHEPostForm","BXHtmlEditor","Get","eventNode","GetContent","commentImages","querySelectorAll","commentImagesLength","idsList","toggleMode","tagName","hasClass","getSelection","loadEditor","attachmentList","input","emptyCommentMessage","_isRequestRunning","onSaveSuccess","onRequestFailure","getHistory","fixedHistory","getFixedHistory","deleteFixedItem","onRemoveSuccess","updateFixedItem","updateItem","_isLocked","eventWrapper","maxHeight","scrollHeight","button","Document","editDocument","statusLayout","prepareTitleStatusLayout","findChildByClassName","confirmDelete","onConfirmDelete","DoNothing","deleteDocument","documentId","DOCUMENT_ID","SidePanel","Instance","adjust","Sender","getDataSetting","isRemoved","stopPropagation","layoutClassName","textCaption","prepareStatusLayout","Bizproc","prepareContentTextHtml","workflowName","workflowStatus","Scoring","ownerType","scoringInfo","score","getNumber","scoreDelta","round","iconClass","Expand","_callback","onNodeHeightStep","onNodeHeightComplete","onNodeOpacityStep","onNodeOpacityComplete","_emptySection","_currentDaySection","_lastDaySection","_lastDate","_enableLoading","_navigation","_scrollHandler","_loadingWaiter","_filterId","_isFilterApplied","_isFilterShown","_filterButton","_filterWrapper","_filterResultStub","_ownerTypeId","_ownerId","onFilterApply","closeFilterButton","onFilterClose","created","createCurrentDaySection","createDaySection","enableLoading","processHistoryLayoutChange","firstChild","adjustFilterButton","_filterEmptyResultSection","createFilterEmptyResultSection","results","createEmptySection","showFilter","section","sectionWrapper","hideFilter","filter","filterManager","getById","resetFilter","formattedDate","formatDate","toUpperCase","changedFieldName","useShortTimeFormat","createActivityItem","createExternalNotificationItem","child","removeChild","getBoundingClientRect","documentElement","loadItems","ctx","autoResolve","CrmDataLoader","load","resetLayout","bulkCreateItems","setNavigation","fulfill","navigation","enable","onWindowScroll","unbind","instances","FixedHistory","nextElementSibling","onItemsLoad","PullActionProcessor","isObject","scheduleStream","fixedHistoryStream","historyStream","actionParams","appLanguage","languageId","canBeReloaded","stream","promises","isHistoryStream","sourceStream","fromStream","fromId","all","existedStreamItem","streamItem","refreshItem","deleteItemAnimated","sourceId","destinationId","destinationItemData","sourceItem","existedDestinationItem","moveItemToStream","onSuccessFasten","historyCommentBlock","getLayoutContentBlockById","setIsFilesBlockDisplayed","setIsMoving","fixedHistoryItem","getAnchor","fixedHistoryCommentBlock","onSuccessUnfasten","streamName","activityIds","historyIds","err","console","_classPrivateFieldInitSpec","_ownerInfo","_progressSemantics","_chat","_currentUser","_pullTagName","_spotlightFastenShowed","_audioPlaybackRate","containerId","activityEditorId","readOnly","templates","editorContainer","filterId","isFilterApplied","setHistory","onPullEvent","extendWatch","onEntityProgressChange","addEventListener","throttle","onScroll","PULL","processAction","processChatCreate","processActivityExternalAdd","processActivityExternalUpdate","processActivityExternalDelete","processCommentExternalAdd","processCommentExternalUpdate","processCommentExternalDelete","processChangeBinding","processItemExternalUpdate","processWaitExternalAdd","processWaitExternalUpdate","processWaitExternalDelete","processBizprocStatus","processScoringExternalAdd","scheduleItemData","scheduleItem","getItemByData","addScheduleItem","historyItems","getItemsByAssociatedEntity","setAssociatedEntityData","fixedHistoryItems","transferItemToHistory","entityNewId","fixedItemData","eventArgs","semantics","historyAnchor","filePath","mediaType","sources","src","isAudio","onInit","controlBar","addChild","isPlaying","play","createElement","audioPlaybackRateSelector","instance","SchedulePostpone","openMenu","nodeOpacityAnim","Streams","Tools","Actions","ScheduledItems","ScheduledActivity","ScheduledEmail","ScheduledCall","ScheduledMeeting","ScheduledTask","ScheduledWebForm","ScheduledWait","ScheduledRequest","ScheduledRest","ScheduledOpenLine","ScheduledZoom","Items","CommentItem","EmailItem","CallItem","WaitItem","RestItem","OpenLineItem","ScheduledBase","Animations","AnimationItem","AnimationComment"],"mappings":"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"}