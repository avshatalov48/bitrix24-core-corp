{"version":3,"file":"timeline.bundle.js","sources":["../src/types.js","../src/items/compatible-item.js","../src/animations/fasten.js","../src/items/history.js","../src/mixins/history-item.js","../src/mixins/product-list.js","../src/components/product/product.js","../src/components/product/product-list.js","../src/encourage-buy-products/component.js","../src/components/author.js","../src/notification/component.js","../src/components/delivery/delivery-service-info.js","../src/delivery-activity/component.js","../src/delivery-message/component.js","../src/delivery-calculation/component.js","../src/editor.js","../src/tools/wait-configuration-dialog.js","../src/editors/wait.js","../src/editors/sms.js","../src/editors/rest.js","../src/editors/comment.js","../src/editors/todo.js","../src/items/scheduled.js","../src/action.js","../src/actions/activity.js","../src/actions/email.js","../src/items/history-activity.js","../src/items/document.js","../src/animations/item.js","../src/animations/shift.js","../src/animations/item-new.js","../src/stream.js","../src/streams/entitychat.js","../src/tools/menubar.js","../src/tools/audio-playback-rate-selector.js","../src/tools/schedule-postpone-controller.js","../src/items/scheduled/activity.js","../src/items/scheduled/email.js","../src/items/scheduled/call.js","../src/items/scheduled/call-tracker.js","../src/items/scheduled/meeting.js","../src/items/scheduled/task.js","../src/items/scheduled/store-document.js","../src/items/scheduled/webform.js","../src/items/scheduled/wait.js","../src/items/scheduled/request.js","../src/items/scheduled/rest.js","../src/actions/openline.js","../src/items/scheduled/openline.js","../src/items/scheduled/zoom.js","../src/streams/schedule.js","../src/items/modification.js","../src/items/conversion.js","../src/items/email.js","../src/actions/call.js","../src/items/call.js","../src/items/meeting.js","../src/items/task.js","../src/items/webform.js","../src/items/sms.js","../src/items/request.js","../src/items/openline.js","../src/items/rest.js","../src/items/visit.js","../src/items/zoom.js","../src/items/order-creation.js","../src/items/order-modification.js","../src/items/store-document-creation.js","../src/items/store-document-modification.js","../src/items/external-notice-modification.js","../src/items/external-notice-status-modification.js","../src/items/order-check.js","../src/items/final-summary-documents.js","../src/items/final-summary.js","../src/items/creation.js","../src/items/restoration.js","../src/items/relation.js","../src/items/link.js","../src/items/unlink.js","../src/items/mark.js","../src/items/comment.js","../src/items/wait.js","../src/items/sender.js","../src/items/bizproc.js","../src/items/scoring.js","../src/animations/expand.js","../src/streams/history.js","../src/streams/fixedhistory.js","../src/pull-action-processor.js","../src/manager.js","../src/tools/sms-watcher.js","../src/actions/schedule-postpone.js","../src/animations/comment.js","../src/product-compilation/compilation-product-list/component.js","../src/product-compilation/order-notice/component.js","../src/product-compilation/compilation-viewed/component.js","../src/product-compilation/deal-created/component.js","../src/index.js"],"sourcesContent":["/** @memberof BX.Crm.Timeline.Types */\nexport const Item = {\n\tundefined: 0,\n\tactivity: 1,\n\tcreation: 2,\n\tmodification: 3,\n\tlink: 4,\n\tunlink: 5,\n\tmark: 6,\n\tcomment: 7,\n\twait: 8,\n\tbizproc: 9,\n\tconversion: 10,\n\tsender: 11,\n\tdocument: 12,\n\trestoration: 13,\n\torder: 14,\n\torderCheck: 15,\n\tscoring: 16,\n\texternalNotification: 17,\n\tfinalSummary: 18,\n\tdelivery: 19,\n\tfinalSummaryDocuments: 20,\n\tstoreDocument: 21,\n\tproductCompilation: 22,\n\tsignDocument: 23,\n};\n\n/** @memberof BX.Crm.Timeline.Types */\nexport const Mark = {\n\tundefined: 0,\n\twaiting: 1,\n\tsuccess: 2,\n\trenew: 3,\n\tignored: 4,\n\tfailed: 5\n};\n\n/** @memberof BX.Crm.Timeline.Types */\nexport const Delivery = {\n\tundefined: 0,\n\ttaxiEstimationRequest: 1,\n\ttaxiCallRequest: 2,\n\ttaxiCancelledByManager: 3,\n\ttaxiCancelledByDriver: 4,\n\ttaxiPerformerNotFound: 5,\n\ttaxiSmsProviderIssue: 6,\n\ttaxiReturnedFinish: 7,\n\tdeliveryMessage: 101,\n\tdeliveryCalculation: 102,\n};\n\n/** @memberof BX.Crm.Timeline.Types */\nexport const Order = {\n\tencourageBuyProducts: 100,\n};\n\n/** @memberof BX.Crm.Timeline.Types */\nexport const EditorMode = {\n\tview: 1,\n\tedit: 2\n};\n\n/** @memberof BX.Crm.Timeline.Types */\nexport const Compilation = {\n\tproductList: 1,\n\torderExists: 2,\n\tcompilationViewed: 3,\n\tnewDealCreated: 4,\n};\n","import {Item as ItemType} from \"../types\";\nimport {Item} from \"crm.timeline.item\";\nimport {Type} from \"main.core\";\nimport {TimezoneOffset} from \"crm.datetime\";\n\n/** @memberof BX.Crm.Timeline */\nexport default class CompatibleItem extends Item\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._id = \"\";\n\t\tthis._settings = {};\n\t\tthis._data = {};\n\t\tthis._container = null;\n\n\t\tthis._typeCategoryId = null;\n\t\tthis._associatedEntityData = null;\n\t\tthis._associatedEntityTypeId = null;\n\t\tthis._associatedEntityId = null;\n\t\tthis._isContextMenuShown = false;\n\t\tthis._contextMenuButton = null;\n\n\t\tthis._activityEditor = null;\n\t\tthis._actions = [];\n\t\tthis._actionContainer = null;\n\n\t\tthis._vueComponent = null;\n\t\tthis._vueComponentMountedNode = null;\n\n\t\tthis._existedStreamItemDeadLine = null;\n\t}\n\n\tinitialize(id, settings)\n\t{\n\t\tthis._setId(id);\n\t\tthis._settings = settings ? settings : {};\n\n\t\tthis._container = this.getSetting(\"container\");\n\n\t\tif(!BX.type.isPlainObject(settings['data']))\n\t\t{\n\t\t\tthrow \"Item. A required parameter 'data' is missing.\";\n\t\t}\n\t\tthis._data = settings['data'];\n\n\t\tthis._activityEditor = this.getSetting(\"activityEditor\");\n\n\t\tthis._vueComponent = this.getSetting(\"vueComponent\");\n\n\t\tthis.doInitialize();\n\t}\n\n\tdoInitialize()\n\t{\n\t}\n\n\tgetId()\n\t{\n\t\treturn this._id;\n\t}\n\n\tgetSetting(name, defaultval)\n\t{\n\t\treturn this._settings.hasOwnProperty(name) ? this._settings[name] : defaultval;\n\t}\n\n\tgetData()\n\t{\n\t\treturn this._data;\n\t}\n\n\tsetData(data)\n\t{\n\t\tif(BX.type.isPlainObject(data))\n\t\t{\n\t\t\tthis._data = data;\n\t\t\tthis.clearCachedData();\n\t\t}\n\t}\n\n\tgetSort(): Array\n\t{\n\t\treturn this._data['sort'] ?? [];\n\t}\n\n\tgetAssociatedEntityData()\n\t{\n\t\tif(this._associatedEntityData === null)\n\t\t{\n\t\t\tthis._associatedEntityData = BX.type.isPlainObject(this._data[\"ASSOCIATED_ENTITY\"])\n\t\t\t\t? this._data[\"ASSOCIATED_ENTITY\"] : {};\n\t\t}\n\n\t\treturn this._associatedEntityData;\n\t}\n\n\tgetAssociatedEntityTypeId()\n\t{\n\t\tif(this._associatedEntityTypeId === null)\n\t\t{\n\t\t\tthis._associatedEntityTypeId = BX.prop.getInteger(this._data, \"ASSOCIATED_ENTITY_TYPE_ID\", 0)\n\t\t}\n\t\treturn this._associatedEntityTypeId;\n\t}\n\n\tgetAssociatedEntityId()\n\t{\n\t\tif(this._associatedEntityId === null)\n\t\t{\n\t\t\tthis._associatedEntityId = BX.prop.getInteger(this._data, \"ASSOCIATED_ENTITY_ID\", 0)\n\t\t}\n\t\treturn this._associatedEntityId;\n\t}\n\n\tsetAssociatedEntityData(associatedEntityData)\n\t{\n\t\tif(!BX.type.isPlainObject(associatedEntityData))\n\t\t{\n\t\t\tassociatedEntityData = {};\n\t\t}\n\n\t\tconst data = this._data;\n\t\tdata.ASSOCIATED_ENTITY = associatedEntityData;\n\n\t\tthis.setData(data);\n\t}\n\n\thasPermissions()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\treturn BX.type.isPlainObject(entityData[\"PERMISSIONS\"]);\n\t}\n\n\tgetPermissions()\n\t{\n\t\treturn BX.prop.getObject(this.getAssociatedEntityData(), \"PERMISSIONS\", {});\n\t}\n\n\tsetPermissions(permissions)\n\t{\n\t\tconst data = this._data;\n\n\t\tif(!Type.isPlainObject(data.ASSOCIATED_ENTITY))\n\t\t{\n\t\t\tdata.ASSOCIATED_ENTITY = {};\n\t\t}\n\n\t\tdata.ASSOCIATED_ENTITY.PERMISSIONS = permissions;\n\n\t\tthis.setData(data);\n\t}\n\n\tgetTextDataParam(name)\n\t{\n\t\treturn BX.prop.getString(this._data, name, \"\");\n\t}\n\n\tgetObjectDataParam(name)\n\t{\n\t\treturn BX.prop.getObject(this._data, name, {});\n\t}\n\n\tgetArrayDataParam(name)\n\t{\n\t\treturn BX.prop.getArray(this._data, name, []);\n\t}\n\n\tgetTypeId()\n\t{\n\t\treturn ItemType.undefined;\n\t}\n\n\tgetTypeCategoryId()\n\t{\n\t\tif(this._typeCategoryId === null)\n\t\t{\n\t\t\tthis._typeCategoryId = BX.prop.getInteger(this._data, \"TYPE_CATEGORY_ID\", 0);\n\t\t}\n\t\treturn this._typeCategoryId;\n\t}\n\n\tgetContainer()\n\t{\n\t\treturn this._container;\n\t}\n\n\tsetContainer(container)\n\t{\n\t\tthis._container = BX.type.isElementNode(container) ? container : null;\n\t}\n\n\tlayout(options)\n\t{\n\t\tif(!BX.type.isElementNode(this._container))\n\t\t{\n\t\t\tthrow \"Item. Container is not assigned.\";\n\t\t}\n\n\t\tthis.prepareLayout(options);\n\t\t//region Actions\n\t\t/**/\n\t\tthis.prepareActions();\n\t\tconst actionQty = this._actions.length;\n\t\tfor(let i = 0; i < actionQty; i++)\n\t\t{\n\t\t\tthis._actions[i].layout();\n\t\t}\n\t\tthis.showActions(actionQty > 0);\n\t\t/**/\n\t\t//endregion\n\t}\n\n\tmakeVueComponent(options, mode)\n\t{\n\t\tif (this._vueComponentMountedNode)\n\t\t{\n\t\t\treturn this._vueComponentMountedNode;\n\t\t}\n\n\t\tif (!this._vueComponent)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst app = new this._vueComponent(\n\t\t\t{\n\t\t\t\tpropsData: {\n\t\t\t\t\tself: this,\n\t\t\t\t\tlangMessages: CompatibleItem.messages,\n\t\t\t\t\tmode: mode\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\n\t\tapp.$mount();\n\n\t\tthis._vueComponentMountedNode = app.$el;\n\t\treturn this._vueComponentMountedNode;\n\t}\n\n\tprepareLayout(options)\n\t{\n\t}\n\n\tprepareActions()\n\t{\n\t}\n\n\tshowActions(show)\n\t{\n\t}\n\n\tclearCachedData()\n\t{\n\t\tthis._typeCategoryId = null;\n\t\tthis._associatedEntityData = null;\n\t\tthis._associatedEntityTypeId = null;\n\t\tthis._associatedEntityId = null;\n\t}\n\n\tisDone()\n\t{\n\t\treturn false;\n\t}\n\n\tmarkAsDone(isDone)\n\t{\n\t}\n\n\tview()\n\t{\n\t}\n\n\tedit()\n\t{\n\t}\n\n\tfasten()\n\t{\n\t}\n\n\tunfasten()\n\t{\n\t}\n\n\tremove()\n\t{\n\t}\n\n\tcutOffText(text, length)\n\t{\n\t\tif(!BX.type.isNumber(length))\n\t\t{\n\t\t\tlength = 0;\n\t\t}\n\n\t\tif(length <= 0 || text.length <= length)\n\t\t{\n\t\t\treturn text;\n\t\t}\n\n\t\tlet offset = length - 1;\n\t\tconst whilespaceOffset = text.substring(offset).search(/\\s/i);\n\t\tif(whilespaceOffset > 0)\n\t\t{\n\t\t\toffset += whilespaceOffset;\n\t\t}\n\t\treturn text.substring(0, offset);\n\t}\n\n\tprepareMultilineCutOffElements(text, length, clickHandler)\n\t{\n\t\tif(!BX.type.isNumber(length))\n\t\t{\n\t\t\tlength = 0;\n\t\t}\n\n\t\tif(length <= 0 || text.length <= length)\n\t\t{\n\t\t\treturn [BX.util.htmlspecialchars(text).replace(/(?:\\r\\n|\\r|\\n)/g, '<br>')];\n\t\t}\n\n\t\tlet offset = length - 1;\n\t\tconst whilespaceOffset = text.substring(offset).search(/\\s/i);\n\t\tif(whilespaceOffset > 0)\n\t\t{\n\t\t\toffset += whilespaceOffset;\n\t\t}\n\t\treturn(\n\t\t\t[\n\t\t\t\tBX.util.htmlspecialchars(text.substring(0, offset)).replace(/(?:\\r\\n|\\r|\\n)/g, '<br>') + \"&hellip;&nbsp;\" ,\n\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-letter-more\", href: \"#\" },\n\t\t\t\t\t\tevents: { click: clickHandler },\n\t\t\t\t\t\ttext: this.getMessage(\"details\")\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t]\n\t\t);\n\t}\n\n\tprepareCutOffElements(text, length, clickHandler)\n\t{\n\t\tif(!BX.type.isNumber(length))\n\t\t{\n\t\t\tlength = 0;\n\t\t}\n\n\t\tif(length <= 0 || text.length <= length)\n\t\t{\n\t\t\treturn [BX.util.htmlspecialchars(text)];\n\t\t}\n\n\t\tlet offset = length - 1;\n\t\tconst whilespaceOffset = text.substring(offset).search(/\\s/i);\n\t\tif(whilespaceOffset > 0)\n\t\t{\n\t\t\toffset += whilespaceOffset;\n\t\t}\n\t\treturn(\n\t\t\t[\n\t\t\t\tBX.util.htmlspecialchars(text.substring(0, offset)) + \"&hellip;&nbsp;\" ,\n\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-letter-more\", href: \"#\" },\n\t\t\t\t\t\tevents: { click: clickHandler },\n\t\t\t\t\t\ttext: this.getMessage(\"details\")\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t]\n\t\t);\n\t}\n\n\tprepareAuthorLayout()\n\t{\n\t\tconst authorInfo = this.getObjectDataParam(\"AUTHOR\", null);\n\t\tif(!authorInfo)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst showUrl = BX.prop.getString(authorInfo, \"SHOW_URL\", \"\");\n\t\tif(showUrl === \"\")\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst link = BX.create(\"A\",\n\t\t\t{\n\t\t\t\tattrs:\n\t\t\t\t\t{\n\t\t\t\t\t\tclassName: \"ui-icon ui-icon-common-user crm-entity-stream-content-detail-employee\",\n\t\t\t\t\t\thref: showUrl,\n\t\t\t\t\t\ttarget: \"_blank\",\n\t\t\t\t\t\ttitle: BX.prop.getString(authorInfo, \"FORMATTED_NAME\", \"\")\n\t\t\t\t\t},\n\t\t\t\tchildren: [\n\t\t\t\t\tBX.create('i', {})\n\t\t\t\t]\n\t\t\t}\n\t\t);\n\t\tconst imageUrl = BX.prop.getString(authorInfo, \"IMAGE_URL\", \"\");\n\t\tif(imageUrl !== \"\")\n\t\t{\n\t\t\tlink.children[0].style.backgroundImage = \"url('\" + encodeURI(imageUrl) + \"')\";\n\t\t\tlink.children[0].style.backgroundSize = \"21px\";\n\t\t}\n\n\t\treturn link;\n\t}\n\n\tonActivityCreate(activity, data)\n\t{\n\t}\n\n\tisContextMenuEnabled()\n\t{\n\t\treturn false;\n\t}\n\n\tprepareContextMenuButton()\n\t{\n\t\tthis._contextMenuButton = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: { className: \"crm-entity-stream-section-context-menu\" },\n\t\t\t\tevents: { click: BX.delegate(this.onContextMenuButtonClick, this) }\n\t\t\t}\n\t\t);\n\t\treturn this._contextMenuButton;\n\t}\n\n\tonContextMenuButtonClick(e)\n\t{\n\t\tif(!this._isContextMenuShown)\n\t\t{\n\t\t\tthis.openContextMenu();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.closeContextMenu();\n\t\t}\n\t}\n\n\topenContextMenu()\n\t{\n\t\tconst menuItems = this.prepareContextMenuItems();\n\n\t\tif (typeof IntranetExtensions !== \"undefined\")\n\t\t{\n\t\t\tmenuItems.push(IntranetExtensions);\n\t\t}\n\n\t\tif(menuItems.length === 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tBX.PopupMenu.show(\n\t\t\tthis._id,\n\t\t\tthis._contextMenuButton,\n\t\t\tmenuItems,\n\t\t\t{\n\t\t\t\toffsetTop: 0,\n\t\t\t\toffsetLeft: 16,\n\t\t\t\tangle: { position: \"top\", offset: 0 },\n\t\t\t\tevents:\n\t\t\t\t\t{\n\t\t\t\t\t\tonPopupShow: BX.delegate(this.onContextMenuShow, this),\n\t\t\t\t\t\tonPopupClose: BX.delegate(this.onContextMenuClose, this),\n\t\t\t\t\t\tonPopupDestroy: BX.delegate(this.onContextMenuDestroy, this)\n\t\t\t\t\t}\n\t\t\t}\n\t\t);\n\t\tthis._contextMenu = BX.PopupMenu.currentItem;\n\t}\n\n\tcloseContextMenu()\n\t{\n\t\tif(this._contextMenu)\n\t\t{\n\t\t\tthis._contextMenu.close();\n\t\t}\n\t}\n\n\tprepareContextMenuItems()\n\t{\n\t\treturn [];\n\t}\n\n\tonContextMenuShow()\n\t{\n\t\tthis._isContextMenuShown = true;\n\t\tBX.addClass(this._contextMenuButton, \"active\");\n\t}\n\n\tonContextMenuClose()\n\t{\n\t\tif(this._contextMenu)\n\t\t{\n\t\t\tthis._contextMenu.popupWindow.destroy();\n\t\t}\n\t}\n\n\tonContextMenuDestroy()\n\t{\n\t\tthis._isContextMenuShown = false;\n\t\tBX.removeClass(this._contextMenuButton, \"active\");\n\t\tthis._contextMenu = null;\n\n\t\tif(typeof(BX.PopupMenu.Data[this._id]) !== \"undefined\")\n\t\t{\n\t\t\tdelete(BX.PopupMenu.Data[this._id]);\n\t\t}\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = CompatibleItem.messages;\n\t\treturn m.hasOwnProperty(name) ? m[name] : name;\n\t}\n\n\tstatic getUserTimezoneOffset()\n\t{\n\t\treturn TimezoneOffset.USER_TO_SERVER;\n\t}\n\n\tstatic messages = {};\n}\n","/** @memberof BX.Crm.Timeline.Animation */\nexport default class Fasten\n{\n\tconstructor()\n\t{\n\t\tthis._id = \"\";\n\t\tthis._settings = {};\n\t\tthis._initialItem = null;\n\t\tthis._finalItem = null;\n\t\tthis._events = null;\n\t}\n\n\tinitialize(id, settings)\n\t{\n\t\tthis._id = BX.type.isNotEmptyString(id) ? id : BX.util.getRandomString(4);\n\t\tthis._settings = settings ? settings : {};\n\n\t\tthis._initialItem = this.getSetting(\"initialItem\");\n\t\tthis._finalItem = this.getSetting(\"finalItem\");\n\n\t\tthis._anchor = this.getSetting(\"anchor\");\n\t\tthis._events = this.getSetting(\"events\", {});\n\t}\n\n\tgetId()\n\t{\n\t\treturn this._id;\n\t}\n\n\tgetSetting(name, defaultValue)\n\t{\n\t\treturn this._settings.hasOwnProperty(name) ? this._settings[name] : defaultValue;\n\t}\n\n\taddFixedHistoryItem()\n\t{\n\t\tconst node = this._finalItem.getWrapper();\n\t\tBX.addClass(node, 'crm-entity-stream-section-animate-start');\n\t\tif (this._anchor.parentNode && node)\n\t\t{\n\t\t\tthis._anchor.parentNode.insertBefore(node, this._anchor.nextSibling);\n\t\t}\n\t\tsetTimeout( BX.delegate(\n\t\t\tfunction() {\n\t\t\t\tBX.removeClass(node, 'crm-entity-stream-section-animate-start');\n\t\t\t},\n\t\t\tthis\n\t\t), 0);\n\t}\n\n\trun()\n\t{\n\t\tconst node = this._initialItem.getWrapper();\n\t\tthis._clone = node.cloneNode(true);\n\n\t\tBX.addClass(this._clone, 'crm-entity-stream-section-animate-start crm-entity-stream-section-top-fixed');\n\n\t\tthis._startPosition = BX.pos(node);\n\t\tthis._clone.style.position = \"absolute\";\n\t\tthis._clone.style.width = this._startPosition.width + \"px\";\n\n\t\tlet _cloneHeight = this._startPosition.height;\n\t\tconst _minHeight = 65;\n\t\tconst _sumPaddingContent = 18;\n\t\tif (_cloneHeight < _sumPaddingContent + _minHeight)\n\t\t\t_cloneHeight = _sumPaddingContent + _minHeight;\n\n\t\tthis._clone.style.height = _cloneHeight + \"px\";\n\t\tthis._clone.style.top = this._startPosition.top + \"px\";\n\t\tthis._clone.style.left = this._startPosition.left + \"px\";\n\t\tthis._clone.style.zIndex = 960;\n\n\t\tdocument.body.appendChild(this._clone);\n\n\t\tsetTimeout(\n\t\t\tBX.proxy(\n\t\t\t\tfunction (){\n\t\t\t\t\tBX.addClass(this._clone, \"crm-entity-stream-section-casper\" )\n\t\t\t\t},\n\t\t\t\tthis\n\t\t\t),\n\t\t\t0\n\t\t);\n\n\t\tthis._anchorPosition = BX.pos(this._anchor);\n\t\tconst finish = {\n\t\t\ttop: this._anchorPosition.top,\n\t\t\theight: _cloneHeight + 15,\n\t\t\topacity: 1\n\t\t};\n\n\t\tconst _difference = this._startPosition.top - this._anchorPosition.bottom;\n\t\tconst _deepHistoryLimit = 2 * (document.body.clientHeight + this._startPosition.height);\n\n\t\tif (_difference > _deepHistoryLimit)\n\t\t{\n\t\t\tfinish.top = this._startPosition.top - _deepHistoryLimit;\n\t\t\tfinish.opacity = 0;\n\t\t}\n\n\t\tlet _duration = Math.abs(finish.top - this._startPosition.top) * 2;\n\t\t_duration = (_duration < 1500) ? 1500 : _duration;\n\n\t\tconst movingEvent = new BX.easing({\n\t\t\tduration: _duration,\n\t\t\tstart: {top: this._startPosition.top, height: 0, opacity: 1},\n\t\t\tfinish: finish,\n\t\t\ttransition: BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\tstep: BX.proxy(function (state) {\n\t\t\t\tthis._clone.style.top = state.top + \"px\";\n\t\t\t\tthis._clone.style.opacity = state.opacity;\n\t\t\t\tthis._anchor.style.height = state.height + \"px\";\n\t\t\t}, this),\n\t\t\tcomplete: BX.proxy(function () {\n\t\t\t\tthis.finish();\n\t\t\t}, this)\n\t\t});\n\t\tmovingEvent.animate();\n\t}\n\n\tfinish()\n\t{\n\t\tthis._anchor.style.height = 0;\n\t\tthis.addFixedHistoryItem();\n\t\tBX.remove(this._clone);\n\n\t\tif(BX.type.isFunction(this._events[\"complete\"]))\n\t\t{\n\t\t\tthis._events[\"complete\"]();\n\t\t}\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Fasten();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import CompatibleItem from \"./compatible-item\";\nimport {Item as ItemType} from \"../types\";\nimport Fasten from \"../animations/fasten\";\nimport {DatetimeConverter} from \"crm.timeline.tools\";\nimport {Type, Dom} from \"main.core\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class History extends CompatibleItem\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._history = null;\n\t\tthis._fixedHistory = null;\n\t\tthis._typeId = null;\n\t\tthis._createdTime = null;\n\t\tthis._isFixed = false;\n\t\tthis._headerClickHandler = BX.delegate(this.onHeaderClick, this);\n\t}\n\n\tdoInitialize()\n\t{\n\t\tthis._history = this.getSetting(\"history\");\n\t\tthis._fixedHistory = this.getSetting(\"fixedHistory\");\n\t}\n\n\tgetTypeId()\n\t{\n\t\tif(this._typeId === null)\n\t\t{\n\t\t\tthis._typeId = BX.prop.getInteger(this._data, \"TYPE_ID\", ItemType.undefined);\n\t\t}\n\t\treturn this._typeId;\n\t}\n\n\tgetTitle()\n\t{\n\t\treturn \"\";\n\t}\n\n\tisContextMenuEnabled()\n\t{\n\t\treturn !(this.isReadOnly());\n\t}\n\n\tgetCreatedTimestamp()\n\t{\n\t\treturn this.getTextDataParam(\"CREATED_SERVER\");\n\t}\n\n\tgetCreatedTime()\n\t{\n\t\tif(this._createdTime === null)\n\t\t{\n\t\t\tconst time = BX.parseDate(\n\t\t\t\tthis.getCreatedTimestamp(),\n\t\t\t\tfalse,\n\t\t\t\t\"YYYY-MM-DD\",\n\t\t\t\t\"YYYY-MM-DD HH:MI:SS\"\n\t\t\t);\n\n\t\t\tthis._createdTime = (new DatetimeConverter(time)).toUserTime().getValue();\n\t\t}\n\t\treturn this._createdTime;\n\t}\n\n\tgetCreatedDate()\n\t{\n\t\treturn BX.prop.extractDate(new Date(this.getCreatedTime().getTime()));\n\t}\n\n\tgetOwnerInfo()\n\t{\n\t\treturn this._history ? this._history.getOwnerInfo() : null;\n\t}\n\n\tgetOwnerTypeId()\n\t{\n\t\treturn BX.prop.getInteger(this.getOwnerInfo(), \"ENTITY_TYPE_ID\", BX.CrmEntityType.enumeration.undefined);\n\t}\n\n\tgetOwnerId()\n\t{\n\t\treturn BX.prop.getInteger(this.getOwnerInfo(), \"ENTITY_ID\", 0);\n\t}\n\n\tisReadOnly()\n\t{\n\t\treturn this._history.isReadOnly();\n\t}\n\n\tisEditable()\n\t{\n\t\treturn !this.isReadOnly();\n\t}\n\n\tisDone()\n\t{\n\t\tconst typeId = this.getTypeId();\n\t\tif(typeId === ItemType.activity)\n\t\t{\n\t\t\tconst entityData = this.getAssociatedEntityData();\n\t\t\treturn BX.CrmActivityStatus.isFinal(BX.prop.getInteger(entityData, \"STATUS\", 0));\n\t\t}\n\t\treturn false;\n\t}\n\n\tisFixed()\n\t{\n\t\treturn this._isFixed;\n\t}\n\n\t/**\n\t * deprecated\n\t */\n\tfasten(e)\n\t{\n\t\tif (this._fixedHistory._items.length >= 3)\n\t\t{\n\t\t\tif (!this.fastenLimitPopup)\n\t\t\t{\n\t\t\t\tthis.fastenLimitPopup = new BX.PopupWindow(\n\t\t\t\t\t'timeline_fasten_limit_popup_' + this._id,\n\t\t\t\t\tthis._switcher,\n\t\t\t\t\t{\n\t\t\t\t\t\tcontent: BX.message('CRM_TIMELINE_FASTEN_LIMIT_MESSAGE'),\n\t\t\t\t\t\tdarkMode: true,\n\t\t\t\t\t\tautoHide: true,\n\t\t\t\t\t\tzIndex: 990,\n\t\t\t\t\t\tangle: true,\n\t\t\t\t\t\tcloseByEsc: true,\n\t\t\t\t\t\tbindOptions: { forceBindPosition: true}\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tthis.fastenLimitPopup.show();\n\t\t\tthis.closeContextMenu();\n\t\t\treturn;\n\t\t}\n\t\tBX.ajax(\n\t\t\t{\n\t\t\t\turl: this._history._serviceUrl,\n\t\t\t\tmethod: \"POST\",\n\t\t\t\tdataType: \"json\",\n\t\t\t\tdata:\n\t\t\t\t\t{\n\t\t\t\t\t\t\"ACTION\": \"CHANGE_FASTEN_ITEM\",\n\t\t\t\t\t\t\"VALUE\": 'Y',\n\t\t\t\t\t\t\"OWNER_TYPE_ID\":  this.getOwnerTypeId(),\n\t\t\t\t\t\t\"OWNER_ID\": this.getOwnerId(),\n\t\t\t\t\t\t\"ID\": this._id\n\t\t\t\t\t},\n\t\t\t}\n\t\t);\n\n\t\tthis.closeContextMenu();\n\t}\n\n\t/**\n\t * deprecated\n\t */\n\tonSuccessFasten(result)\n\t{\n\t\tif (result && BX.type.isNotEmptyString(result.ERROR))\n\t\t\treturn;\n\n\t\tif (!this.isFixed())\n\t\t{\n\t\t\tthis._data.IS_FIXED = 'Y';\n\t\t\tconst fixedItem = this._fixedHistory.createItem(this._data);\n\t\t\tfixedItem._isFixed = true;\n\t\t\tthis._fixedHistory.addItem(fixedItem, 0);\n\t\t\tfixedItem.layout({ add: false });\n\t\t\tthis.refreshLayout();\n\t\t\tconst animation = Fasten.create(\n\t\t\t\t\"\",\n\t\t\t\t{\n\t\t\t\t\tinitialItem: this,\n\t\t\t\t\tfinalItem: fixedItem,\n\t\t\t\t\tanchor: this._fixedHistory._anchor\n\t\t\t\t}\n\t\t\t);\n\t\t\tanimation.run();\n\t\t}\n\n\t\tthis.closeContextMenu();\n\t}\n\n\t/**\n\t * deprecated\n\t */\n\tunfasten(e)\n\t{\n\t\tBX.ajax(\n\t\t\t{\n\t\t\t\turl: this._history._serviceUrl,\n\t\t\t\tmethod: \"POST\",\n\t\t\t\tdataType: \"json\",\n\t\t\t\tdata:\n\t\t\t\t\t{\n\t\t\t\t\t\t\"ACTION\": \"CHANGE_FASTEN_ITEM\",\n\t\t\t\t\t\t\"VALUE\": 'N',\n\t\t\t\t\t\t\"OWNER_TYPE_ID\": this.getOwnerTypeId(),\n\t\t\t\t\t\t\"OWNER_ID\": this.getOwnerId(),\n\t\t\t\t\t\t\"ID\": this._id\n\t\t\t\t\t},\n\t\t\t}\n\t\t);\n\n\t\tthis.closeContextMenu();\n\t}\n\n\t/**\n\t * deprecated\n\t */\n\tonSuccessUnfasten(result)\n\t{\n\t\tif (result && BX.type.isNotEmptyString(result.ERROR))\n\t\t\treturn;\n\n\t\tlet item;\n\t\tlet historyItem;\n\n\t\tif (this.isFixed())\n\t\t{\n\t\t\titem = this;\n\t\t\thistoryItem = this._history.findItemById(this._id);\n\t\t}\n\t\telse\n\t\t{\n\t\t\titem = this._fixedHistory.findItemById(this._id);\n\t\t\thistoryItem = this;\n\t\t}\n\n\t\tif (item)\n\t\t{\n\t\t\tconst index = this._fixedHistory.getItemIndex(item);\n\t\t\titem.clearAnimate();\n\t\t\tthis._fixedHistory.removeItemByIndex(index);\n\t\t\tif (historyItem)\n\t\t\t{\n\t\t\t\thistoryItem._data.IS_FIXED = 'N';\n\t\t\t\thistoryItem.refreshLayout();\n\t\t\t\tBX.LazyLoad.showImages();\n\t\t\t}\n\t\t}\n\t}\n\n\tclearAnimate()\n\t{\n\t\tif (!BX.type.isDomNode(this._wrapper))\n\t\t\treturn ;\n\n\t\tconst wrapperPosition = BX.pos(this._wrapper);\n\t\tconst hideEvent = new BX.easing({\n\t\t\tduration: 1000,\n\t\t\tstart: {height: wrapperPosition.height, opacity: 1, marginBottom: 15},\n\t\t\tfinish: {height: 0, opacity: 0, marginBottom: 0},\n\t\t\ttransition: BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\tstep: BX.proxy(function (state) {\n\t\t\t\tthis._wrapper.style.height = state.height + \"px\";\n\t\t\t\tthis._wrapper.style.opacity = state.opacity;\n\t\t\t\tthis._wrapper.style.marginBottom = state.marginBottom;\n\t\t\t}, this),\n\t\t\tcomplete: BX.proxy(function () {\n\t\t\t\tthis.clearLayout();\n\t\t\t}, this)\n\t\t});\n\n\t\thideEvent.animate();\n\t}\n\n\tgetWrapperClassName()\n\t{\n\t\treturn \"\";\n\t}\n\n\tgetIconClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-icon crm-entity-stream-section-icon-info\";\n\t}\n\n\tprepareContentDetails()\n\t{\n\t\treturn [];\n\t}\n\n\tprepareContent()\n\t{\n\t\tlet wrapperClassName = this.getWrapperClassName();\n\t\tif(wrapperClassName !== \"\")\n\t\t{\n\t\t\twrapperClassName = \"crm-entity-stream-section crm-entity-stream-section-history\" + \" \" + wrapperClassName;\n\t\t}\n\t\telse\n\t\t{\n\t\t\twrapperClassName = \"crm-entity-stream-section crm-entity-stream-section-history\";\n\t\t}\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: wrapperClassName}});\n\t\twrapper.appendChild(BX.create(\"DIV\", { attrs: { className: this.getIconClassName() } }));\n\n\t\tif (this.isContextMenuEnabled())\n\t\t{\n\t\t\tDom.append(this.prepareContextMenuButton(), wrapper);\n\t\t}\n\n\t\tconst contentWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{ attrs: { className: \"crm-entity-stream-section-content\" }, children: [ contentWrapper ] }\n\t\t\t)\n\t\t);\n\n\t\tconst header = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-header\"},\n\t\t\t\tchildren:\n\t\t\t\t\t[\n\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-event-title\"},\n\t\t\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tattrs: {href: \"#\"},\n\t\t\t\t\t\t\t\t\t\t\t\tevents: {click: this._headerClickHandler},\n\t\t\t\t\t\t\t\t\t\t\t\ttext: this.getTitle()\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t),\n\t\t\t\t\t\tBX.create(\"SPAN\",\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-event-time\"},\n\t\t\t\t\t\t\t\ttext: this.formatTime(this.getCreatedTime())\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t)\n\t\t\t\t\t]\n\t\t\t}\n\t\t);\n\n\t\tcontentWrapper.appendChild(header);\n\n\t\tcontentWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail\" },\n\t\t\t\t\tchildren: this.prepareContentDetails()\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontentWrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\treturn wrapper;\n\t}\n\n\tprepareLayout(options)\n\t{\n\t\tconst vueComponent = this.makeVueComponent(options, 'history');\n\t\tthis._wrapper = vueComponent ? vueComponent : this.prepareContent();\n\t\tif(this._wrapper)\n\t\t{\n\t\t\tconst enableAdd = BX.type.isPlainObject(options) ? BX.prop.getBoolean(options, \"add\", true) : true;\n\t\t\tif(enableAdd)\n\t\t\t{\n\t\t\t\tconst anchor = BX.type.isPlainObject(options) && BX.type.isElementNode(options[\"anchor\"]) ? options[\"anchor\"] : null;\n\t\t\t\tif(anchor && anchor.nextSibling)\n\t\t\t\t{\n\t\t\t\t\tthis._container.insertBefore(this._wrapper,  anchor.nextSibling);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis._container.appendChild(this._wrapper);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.markAsTerminated(this._history.checkItemForTermination(this));\n\t\t}\n\t}\n\n\tonHeaderClick(e)\n\t{\n\t\tthis.view();\n\t\te.preventDefault ? e.preventDefault() : (e.returnValue = false);\n\t}\n\n\tprepareTitleLayout()\n\t{\n\t\treturn BX.create(\"SPAN\", { attrs: { className: \"crm-entity-stream-content-event-title\" }, text: this.getTitle() });\n\t}\n\n\tprepareFixedSwitcherLayout()\n\t{\n\t\tconst isFixed = (this.getTextDataParam(\"IS_FIXED\") === 'Y');\n\t\tthis._switcher = BX.create(\"span\",\n\t\t\t{\n\t\t\t\tattrs: { className: \"crm-entity-stream-section-top-fixed-btn\" },\n\t\t\t\tevents: {\n\t\t\t\t\tclick: isFixed ? BX.delegate(this.unfasten, this) : BX.delegate(this.fasten, this)\n\t\t\t\t}\n\t\t\t});\n\t\tif (isFixed)\n\t\t\tBX.addClass(this._switcher, \"crm-entity-stream-section-top-fixed-btn-active\");\n\n\t\tif (!this.isReadOnly() && !isFixed)\n\t\t{\n\t\t\tconst manager = this._history.getManager();\n\t\t\tif (!manager.isSpotlightShowed())\n\t\t\t{\n\t\t\t\tmanager.setSpotlightShowed();\n\t\t\t\tBX.addClass(this._switcher, \"crm-entity-stream-section-top-fixed-btn-spotlight\");\n\t\t\t\tconst spotlight = new BX.SpotLight({\n\t\t\t\t\ttargetElement: this._switcher,\n\t\t\t\t\ttargetVertex: \"middle-center\",\n\t\t\t\t\tlightMode: false,\n\t\t\t\t\tid: \"CRM_TIMELINE_FASTEN_SWITCHER\",\n\t\t\t\t\tzIndex: 900,\n\t\t\t\t\ttop: -3,\n\t\t\t\t\tleft: -1,\n\t\t\t\t\tautoSave: true,\n\t\t\t\t\tcontent: BX.message('CRM_TIMELINE_SPOTLIGHT_FASTEN_MESSAGE')\n\t\t\t\t});\n\t\t\t\tspotlight.show();\n\t\t\t}\n\t\t}\n\n\t\treturn this._switcher;\n\t}\n\n\tprepareHeaderLayout()\n\t{\n\t\tconst header = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-header\"}});\n\t\theader.appendChild(this.prepareTitleLayout());\n\n\t\tconst statusNode = this.getStatusNode();\n\t\tif (Type.isDomNode(statusNode))\n\t\t{\n\t\t\tDom.append(statusNode, header);\n\t\t}\n\n\t\theader.appendChild(\n\t\t\tBX.create(\"SPAN\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-event-time\" },\n\t\t\t\t\ttext: this.formatTime(this.getCreatedTime())\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\treturn header;\n\t}\n\n\tgetStatusNode(): ?HTMLElement\n\t{\n\t\treturn null;\n\t}\n\n\tonActivityCreate(activity, data)\n\t{\n\t\tthis._history.getManager().onActivityCreated(activity, data);\n\t}\n\n\tformatTime(time)\n\t{\n\t\tif (this.isFixed())\n\t\t{\n\t\t\treturn this._fixedHistory.formatTime(time);\n\t\t}\n\n\t\treturn this._history.formatTime(time);\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new History();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n\n\tstatic isCounterEnabled(deadline)\n\t{\n\t\tif(!BX.type.isDate(deadline))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tlet start = new Date();\n\t\tstart.setHours(0);\n\t\tstart.setMinutes(0);\n\t\tstart.setSeconds(0);\n\t\tstart.setMilliseconds(0);\n\t\tstart = start.getTime();\n\n\t\tlet end = new Date();\n\t\tend.setHours(23);\n\t\tend.setMinutes(59);\n\t\tend.setSeconds(59);\n\t\tend.setMilliseconds(999);\n\t\tend = end.getTime();\n\n\t\tconst time = deadline.getTime();\n\t\treturn time < start || (time >= start && time <= end);\n\t}\n}\n","import HistoryItem from \"../items/history\";\n\nexport default {\n\tprops: {\n\t\tself: {\n\t\t\trequired: true,\n\t\t\ttype: Object\n\t\t},\n\t\tlangMessages: {\n\t\t\trequired: false,\n\t\t\ttype: Object\n\t\t},\n\t},\n\tcomputed: {\n\t\tdata()\n\t\t{\n\t\t\treturn this.self._data;\n\t\t},\n\t\tfields()\n\t\t{\n\t\t\treturn this.data.FIELDS ? this.data.FIELDS : null;\n\t\t},\n\t\tauthor()\n\t\t{\n\t\t\treturn this.data.AUTHOR ? this.data.AUTHOR : null;\n\t\t},\n\t\tcreatedAt()\n\t\t{\n\t\t\treturn (this.self instanceof HistoryItem) ? this.self.formatTime(this.self.getCreatedTime()) : '';\n\t\t},\n\t},\n\tmethods: {\n\t\tgetLangMessage(key)\n\t\t{\n\t\t\treturn this.langMessages.hasOwnProperty(key) ? this.langMessages[key] : key;\n\t\t}\n\t}\n};\n","import {UI} from 'ui.notification';\nimport {Loc} from 'main.core';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\nimport {Vue} from 'ui.vue';\n\nexport default {\n\tdata()\n\t{\n\t\treturn {\n\t\t\tnotificationBalloon: false,\n\t\t\tactiveRequestsCnt: 0,\n\t\t\tdealId: null,\n\t\t\tproducts: [],\n\t\t};\n\t},\n\n\tmethods: {\n\t\tisProductsGridAvailable()\n\t\t{\n\t\t\treturn !!this.productsGrid;\n\t\t},\n\t\tsetProductsGrid(productsGrid)\n\t\t{\n\t\t\tthis.productsGrid = productsGrid;\n\t\t\tif (this.productsGrid)\n\t\t\t{\n\t\t\t\tthis.onProductsGridChanged();\n\t\t\t}\n\t\t},\n\t\t// region event handlers\n\t\thandleProductAddingToDeal()\n\t\t{\n\t\t\tthis.activeRequestsCnt += 1;\n\t\t},\n\t\thandleProductAddedToDeal()\n\t\t{\n\t\t\tif (this.activeRequestsCnt > 0)\n\t\t\t{\n\t\t\t\tthis.activeRequestsCnt -= 1;\n\t\t\t}\n\n\t\t\tif (!(this.activeRequestsCnt === 0 && this.productsGrid))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tBX.Crm.EntityEditor.getDefault().reload();\n\t\t\tthis.productsGrid.reloadGrid(false);\n\n\t\t\tif (!this.notificationBalloon || this.notificationBalloon.getState() !== BX.UI.Notification.State.OPEN)\n\t\t\t{\n\t\t\t\tthis.notificationBalloon = UI.Notification.Center.notify({\n\t\t\t\t\tcontent: Loc.getMessage('CRM_TIMELINE_ENCOURAGE_BUY_PRODUCTS_PRODUCTS_ADDED_TO_DEAL'),\n\t\t\t\t\tactions: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttitle: Loc.getMessage('CRM_TIMELINE_ENCOURAGE_BUY_PRODUCTS_EDIT_PRODUCTS'),\n\t\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\t\tclick: (event, balloon, action) => {\n\t\t\t\t\t\t\t\t\tBX.onCustomEvent(window, 'OpenEntityDetailTab', ['tab_products']);\n\t\t\t\t\t\t\t\t\tballoon.close();\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\t// endregion\n\t\t// region custom events\n\t\tsubscribeCustomEvents()\n\t\t{\n\t\t\tEventEmitter.subscribe('EntityProductListController', this.onProductsGridCreated);\n\t\t\tEventEmitter.subscribe('BX.Crm.EntityEditor:onSave', this.onProductsGridChanged);\n\t\t},\n\t\tunsubscribeCustomEvents()\n\t\t{\n\t\t\tEventEmitter.unsubscribe('EntityProductListController', this.onProductsGridCreated);\n\t\t\tEventEmitter.unsubscribe('BX.Crm.EntityEditor:onSave', this.onProductsGridChanged);\n\t\t},\n\t\tonProductsGridCreated(event: BaseEvent)\n\t\t{\n\t\t\tthis.setProductsGrid(event.getData()[0]);\n\t\t},\n\t\tonProductsGridChanged(event: BaseEvent)\n\t\t{\n\t\t\tif (!this.productsGrid)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tlet dealOfferIds = this.productsGrid.products.map((product, index) => {\n\t\t\t\tif (!(product.hasOwnProperty('fields') && product.fields.hasOwnProperty('OFFER_ID')))\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\treturn product.fields.OFFER_ID;\n\t\t\t});\n\n\t\t\tfor (const [i, product] of this.products.entries())\n\t\t\t{\n\t\t\t\tlet isInDeal = dealOfferIds.some(id => parseInt(id) === parseInt(product.offerId));\n\n\t\t\t\tif (product.isInDeal === isInDeal)\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tVue.set(this.products, i, Object.assign({}, product, {isInDeal}));\n\t\t\t}\n\t\t},\n\t\t// endregion\n\t\tbeforeDestroy()\n\t\t{\n\t\t\tthis.unsubscribeCustomEvents();\n\t\t}\n\t},\n}","import {ajax, Loc} from 'main.core';\nimport 'currency';\nimport 'ui.design-tokens';\nimport './styles.css';\n\nexport default {\n\tprops: {\n\t\tproduct: {\n\t\t\trequired: true,\n\t\t\ttype: Object,\n\t\t},\n\t\tdealId: {\n\t\t\trequired: true,\n\t\t\ttype: Number,\n\t\t},\n\t\tisAddToDealVisible: {\n\t\t\trequired: true,\n\t\t\ttype: Boolean,\n\t\t},\n\t\tshowProductLink: {\n\t\t\tdefault: true,\n\t\t\ttype: Boolean,\n\t\t},\n\t},\n\tmethods: {\n\t\taddProductToDeal()\n\t\t{\n\t\t\tif (this.product.isInDeal)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.$emit('product-adding-to-deal');\n\t\t\tthis.product.isInDeal = true;\n\n\t\t\tajax.runAction(\n\t\t\t\t'crm.timeline.encouragebuyproducts.addproducttodeal',\n\t\t\t\t{\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tdealId: this.dealId,\n\t\t\t\t\t\tproductId: this.product.offerId,\n\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\tprice: this.product.price\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t).then((result) => {\n\t\t\t\tthis.$emit('product-added-to-deal');\n\t\t\t\tthis.product.isInDeal = true;\n\t\t\t}).catch((result) => {\n\t\t\t\tthis.product.isInDeal = false;\n\t\t\t});\n\t\t},\n\t\topenDetailPage()\n\t\t{\n\t\t\tif (BX.type.isNotEmptyString(this.product.adminLink))\n\t\t\t{\n\t\t\t\tif (this.product?.slider === 'N')\n\t\t\t\t{\n\t\t\t\t\twindow.open(this.product.adminLink, '_blank');\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tBX.SidePanel.Instance.open(this.product.adminLink);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\tcomputed: {\n\t\tisBottomAreaVisible()\n\t\t{\n\t\t\treturn this.isVariationInfoVisible || this.isPriceVisible;\n\t\t},\n\t\tisVariationInfoVisible()\n\t\t{\n\t\t\treturn (\n\t\t\t\tthis.product.hasOwnProperty('variationInfo')\n\t\t\t\t&& this.product.variationInfo\n\t\t\t);\n\t\t},\n\t\tisPriceVisible()\n\t\t{\n\t\t\treturn (\n\t\t\t\tthis.product.hasOwnProperty('price')\n\t\t\t\t&& this.product.hasOwnProperty('currency')\n\t\t\t\t&& this.product.price\n\t\t\t\t&& this.product.currency\n\t\t\t);\n\t\t},\n\t\tprice()\n\t\t{\n\t\t\treturn BX.Currency.currencyFormat(this.product.price, this.product.currency, true);\n\t\t},\n\t\timageStyle()\n\t\t{\n\t\t\tif (!this.product.image)\n\t\t\t{\n\t\t\t\treturn {};\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tbackgroundImage: 'url(' + this.product.image + ')'\n\t\t\t};\n\t\t},\n\t\tbuttonText()\n\t\t{\n\t\t\treturn Loc.getMessage(\n\t\t\t\tthis.product.isInDeal\n\t\t\t\t\t? 'CRM_TIMELINE_ENCOURAGE_BUY_PRODUCTS_PRODUCT_IN_DEAL'\n\t\t\t\t\t: 'CRM_TIMELINE_ENCOURAGE_BUY_PRODUCTS_ADD_PRODUCT_TO_DEAL'\n\t\t\t);\n\t\t},\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<li\n\t\t\t:class=\"{'crm-entity-stream-advice-list-item--active': product.isInDeal}\"\n\t\t\tclass=\"crm-entity-stream-advice-list-item\"\n\t\t>\n\t\t\t<div class=\"crm-entity-stream-advice-list-content\">\n\t\t\t\t<div\n\t\t\t\t\t:style=\"imageStyle\"\n\t\t\t\t\tclass=\"crm-entity-stream-advice-list-icon\"\n\t\t\t\t>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"crm-entity-stream-advice-list-inner\">\n\t\t\t\t\t<a\n\t\t\t\t\t\tv-if=\"showProductLink\"\n\t\t\t\t\t\t@click.prevent=\"openDetailPage\"\n\t\t\t\t\t\thref=\"#\"\n\t\t\t\t\t\tclass=\"crm-entity-stream-advice-list-name\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{{product.name}}\n\t\t\t\t\t</a>\n\t\t\t\t\t<span\n\t\t\t\t\t\tv-else\n\t\t\t\t\t\tclass=\"crm-entity-stream-advice-list-name\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{{product.name}}\n\t\t\t\t\t</span>\n\n\t\t\t\t\t<div\n\t\t\t\t\t\tv-if=\"isBottomAreaVisible\"\n\t\t\t\t\t\tclass=\"crm-entity-stream-advice-list-desc-box\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<span\n\t\t\t\t\t\t\tv-if=\"isVariationInfoVisible\"\n\t\t\t\t\t\t\tclass=\"crm-entity-stream-advice-list-desc-name\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{{product.variationInfo}}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<span\n\t\t\t\t\t\t\tv-if=\"isPriceVisible\"\n\t\t\t\t\t\t\tv-html=\"price\"\n\t\t\t\t\t\t\tclass=\"crm-entity-stream-advice-list-desc-value\"\n\t\t\t\t\t\t>\n\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div v-if=\"isAddToDealVisible\" class=\"crm-entity-stream-advice-list-btn-box\">\n\t\t\t\t<button\n\t\t\t\t\t@click=\"addProductToDeal\"\n\t\t\t\t\tclass=\"ui-btn ui-btn-round ui-btn-xs crm-entity-stream-advice-list-btn\"\n\t\t\t\t>\n\t\t\t\t\t{{buttonText}}\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t</li>\n\t`\n}\n","import {Loc} from 'main.core';\nimport Product from './product';\nimport './styles.css';\n\nexport default {\n\tprops: {\n\t\tproducts: [],\n\t\tdealId: null,\n\t\tisAddToDealVisible: false,\n\t\tshowProductLink: true,\n\t},\n\n\tdata()\n\t{\n\t\treturn {\n\t\t\tisShortList: true,\n\t\t\tshortListProductsCnt: 3,\n\t\t};\n\t},\n\n\tcomponents: {\n\t\t'product': Product,\n\t},\n\n\tmethods: {\n\t\tonProductAddedToDeal()\n\t\t{\n\t\t\tthis.$emit('product-added-to-deal');\n\t\t},\n\n\t\tonProductAddingToDeal()\n\t\t{\n\t\t\tthis.$emit('product-adding-to-deal');\n\t\t},\n\n\t\tshowMore()\n\t\t{\n\t\t\tthis.isShortList = false;\n\t\t\tconst listWrap = this.$refs.adviceList;\n\t\t\tlistWrap.style.maxHeight = 950 + 'px';\n\t\t},\n\t},\n\n\tcomputed: {\n\t\tisShowMoreVisible()\n\t\t{\n\t\t\treturn this.isShortList && this.products.length > this.shortListProductsCnt;\n\t\t},\n\n\t\tvisibleProducts()\n\t\t{\n\t\t\tlet result = [];\n\n\t\t\tconst length =\n\t\t\t\tthis.isShortList && this.shortListProductsCnt < this.products.length\n\t\t\t\t\t? this.shortListProductsCnt\n\t\t\t\t\t: this.products.length\n\t\t\t;\n\t\t\tfor (let productIndex = 0; productIndex < length; productIndex++)\n\t\t\t{\n\t\t\t\tresult.push(this.products[productIndex]);\n\t\t\t}\n\n\t\t\treturn result;\n\t\t},\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div>\n\t\t\t<transition-group ref=\"adviceList\" class=\"crm-entity-stream-advice-list\" name=\"list\" tag=\"ul\">\n\t\t\t\t<product\n\t\t\t\t\tv-for=\"product in visibleProducts\"\n\t\t\t\t\tv-bind:key=\"product.offerId\"\n\t\t\t\t\t:product=\"product\"\n\t\t\t\t\t:dealId=\"dealId\"\n\t\t\t\t\t:isAddToDealVisible=\"isAddToDealVisible\"\n\t\t\t\t\t:showProductLink=\"showProductLink\"\n\t\t\t\t\t@product-added-to-deal=\"onProductAddedToDeal\"\n\t\t\t\t\t@product-adding-to-deal=\"onProductAddingToDeal\"\n\t\t\t\t></product>\n\t\t\t</transition-group>\n\t\t\t<!--</ul>-->\n\t\t\t<a\n\t\t\t\tv-if=\"isShowMoreVisible\"\n\t\t\t\t@click.prevent=\"showMore\"\n\t\t\t\tclass=\"crm-entity-stream-advice-link\"\n\t\t\t\thref=\"#\"\n\t\t\t>\n\t\t\t\t${Loc.getMessage('CRM_TIMELINE_ENCOURAGE_BUY_PRODUCTS_SHOW_MORE')}\n\t\t\t</a>\n\t\t</div>\n\t`\n}\n","import {Vue} from 'ui.vue';\nimport {Loc} from 'main.core';\nimport HistoryItemMixin from '../mixins/history-item';\nimport ProductListMixin from '../mixins/product-list';\nimport ProductList from '../components/product/product-list';\n\nexport default Vue.extend({\n\tmixins: [HistoryItemMixin, ProductListMixin],\n\tcomponents: {\n\t\t'product-list': ProductList,\n\t},\n\tcreated() {\n\t\tthis.products = this.data.VIEWED_PRODUCTS;\n\t\tthis.dealId = this.data.DEAL_ID;\n\t\tthis.productsGrid = null;\n\t\tthis.subscribeCustomEvents();\n\t\tBX.Crm.EntityEditor.getDefault().tapController('PRODUCT_LIST', (controller) => {\n\t\t\tthis.setProductsGrid(controller.getProductList());\n\t\t});\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"crm-entity-stream-section crm-entity-stream-section-history crm-entity-stream-section-advice\">\n\t\t\t<div class=\"crm-entity-stream-section-icon crm-entity-stream-section-icon-advice\"></div>\n\t\t\t<div class=\"crm-entity-stream-advice-content\">\n\t\t\t\t<div class=\"crm-entity-stream-advice-info\">\n\t\t\t\t\t${Loc.getMessage('CRM_TIMELINE_ENCOURAGE_BUY_PRODUCTS_LOOK_AT_CLIENT_PRODUCTS')}\n\t\t\t\t\t${Loc.getMessage('CRM_TIMELINE_ENCOURAGE_BUY_PRODUCTS_ENCOURAGE_CLIENT_BUY_PRODUCTS_2')}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"crm-entity-stream-advice-inner\">\n\t\t\t\t\t<h3 class=\"crm-entity-stream-advice-subtitle\">\n\t\t\t\t\t\t${Loc.getMessage('CRM_TIMELINE_ENCOURAGE_BUY_PRODUCTS_VIEWED_PRODUCTS')}\n\t\t\t\t\t</h3>\n\t\t\t\t\t<!--<ul class=\"crm-entity-stream-advice-list\">-->\n\t\t\t\t\t<product-list\n\t\t\t\t\t\t:products=\"products\"\n\t\t\t\t\t\t:dealId=\"dealId\"\n\t\t\t\t\t\t:isAddToDealVisible=\"isProductsGridAvailable\"\n\t\t\t\t\t\t@product-added-to-deal=\"handleProductAddedToDeal\"\n\t\t\t\t\t\t@product-adding-to-deal=\"handleProductAddingToDeal\"\n\t\t\t\t\t></product-list>\n\t\t\t\t\t<!--</ul>-->\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`\n});\n","export default {\n\tprops: {\n\t\tauthor: {\n\t\t\trequired: true,\n\t\t\ttype: Object\n\t\t},\n\t},\n\tcomputed: {\n\t\tiStyle()\n\t\t{\n\t\t\tif (!this.author.IMAGE_URL)\n\t\t\t{\n\t\t\t\treturn {};\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\t'background-image': 'url(' + encodeURI(this.author.IMAGE_URL) + ')',\n\t\t\t\t'background-size': '21px',\n\t\t\t};\n\t\t},\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<a\n\t\t\tv-if=\"author.SHOW_URL\"\n\t\t\t:href=\"author.SHOW_URL\"\n\t\t\ttarget=\"_blank\"\n\t\t\t:title=\"author.FORMATTED_NAME\"\n\t\t\tclass=\"ui-icon ui-icon-common-user crm-entity-stream-content-detail-employee\"\n\t\t>\n\t\t\t<i :style=\"iStyle\"></i>\t\n\t\t</a>\n\t`\n};\n","import {Vue} from 'ui.vue';\nimport HistoryItemMixin from '../mixins/history-item';\nimport Author from '../components/author';\nimport {ajax, Loc} from 'main.core';\nimport {PULL} from 'pull.client';\n\nexport default Vue.extend({\n\tmixins: [HistoryItemMixin],\n\tcomponents: {\n\t\t'author': Author,\n\t},\n\tdata()\n\t{\n\t\treturn {\n\t\t\tentityData: null,\n\t\t\tmessageId: null,\n\t\t\ttext: null,\n\t\t\ttitle: null,\n\t\t\tstatus: {\n\t\t\t\tname: null,\n\t\t\t\tsemantics: null,\n\t\t\t\tdescription: null,\n\t\t\t},\n\t\t\tprovider: null,\n\t\t\tisRefreshing: false,\n\t\t};\n\t},\n\tcreated()\n\t{\n\t\tthis.entityData = this.self.getAssociatedEntityData();\n\n\t\tif (this.entityData['MESSAGE_INFO'])\n\t\t{\n\t\t\tthis.setMessageInfo(this.entityData['MESSAGE_INFO']);\n\t\t}\n\n\t\tPULL.subscribe({\n\t\t\tmoduleId: 'notifications',\n\t\t\tcommand: 'message_update',\n\t\t\tcallback: (params) => {\n\t\t\t\tif (params.message.ID == this.messageId)\n\t\t\t\t{\n\t\t\t\t\tthis.refresh();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tif (this.entityData['PULL_TAG_NAME'])\n\t\t{\n\t\t\tPULL.extendWatch(this.entityData['PULL_TAG_NAME']);\n\t\t}\n\t},\n\tmethods: {\n\t\tsetMessageInfo(messageInfo)\n\t\t{\n\t\t\tthis.messageId = messageInfo['MESSAGE']['ID'];\n\n\t\t\tif (\n\t\t\t\tmessageInfo['HISTORY_ITEMS']\n\t\t\t\t&& Array.isArray(messageInfo['HISTORY_ITEMS'])\n\t\t\t\t&& messageInfo['HISTORY_ITEMS'].length > 0\n\t\t\t\t&& messageInfo['HISTORY_ITEMS'][0]\n\t\t\t\t&& messageInfo['HISTORY_ITEMS'][0]['PROVIDER_DATA']\n\t\t\t\t&& messageInfo['HISTORY_ITEMS'][0]['PROVIDER_DATA']['DESCRIPTION']\n\t\t\t)\n\t\t\t{\n\t\t\t\tthis.provider = messageInfo['HISTORY_ITEMS'][0]['PROVIDER_DATA']['DESCRIPTION'];\n\t\t\t\tthis.title = this.provider + ' ' + Loc.getMessage('CRM_TIMELINE_NOTIFICATION_MESSAGE');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.title = this.capitalizeFirstLetter(Loc.getMessage('CRM_TIMELINE_NOTIFICATION_MESSAGE'));\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\tmessageInfo['HISTORY_ITEMS']\n\t\t\t\t&& Array.isArray(messageInfo['HISTORY_ITEMS'])\n\t\t\t\t&& messageInfo['HISTORY_ITEMS'].length > 0\n\t\t\t\t&& messageInfo['HISTORY_ITEMS'][0]\n\t\t\t\t&& messageInfo['HISTORY_ITEMS'][0]['STATUS_DATA']\n\t\t\t\t&& messageInfo['HISTORY_ITEMS'][0]['STATUS_DATA']['DESCRIPTION']\n\t\t\t)\n\t\t\t{\n\t\t\t\tthis.status.name = messageInfo['HISTORY_ITEMS'][0]['STATUS_DATA']['DESCRIPTION'];\n\t\t\t\tthis.status.semantics = messageInfo['HISTORY_ITEMS'][0]['STATUS_DATA']['SEMANTICS'];\n\t\t\t\tthis.status.description = messageInfo['HISTORY_ITEMS'][0]['ERROR_MESSAGE'];\n\t\t\t}\n\n\t\t\tthis.text = messageInfo['MESSAGE']['TEXT']\n\t\t\t\t? messageInfo['MESSAGE']['TEXT']\n\t\t\t\t: Loc.getMessage('CRM_TIMELINE_NOTIFICATION_NO_MESSAGE_TEXT_2');\n\t\t},\n\t\trefresh()\n\t\t{\n\t\t\tif (this.isRefreshing)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.isRefreshing = true;\n\n\t\t\tajax.runAction(\n\t\t\t\t'crm.timeline.notification.getmessageinfo',\n\t\t\t\t{\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tmessageId: this.messageId\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t).then((result) => {\n\t\t\t\tthis.setMessageInfo(result.data);\n\t\t\t\tthis.isRefreshing = false;\n\t\t\t}).catch((result) => {\n\t\t\t\tthis.isRefreshing = false;\n\t\t\t});\n\t\t},\n\t\tviewActivity()\n\t\t{\n\t\t\tthis.self.view();\n\t\t},\n\t\tcapitalizeFirstLetter(str, locale= navigator.language)\n\t\t{\n\t\t\treturn str.replace(/^\\p{CWU}/u, char => char.toLocaleUpperCase(locale));\n\t\t}\n\t},\n\tcomputed: {\n\t\tcommunication()\n\t\t{\n\t\t\treturn this.entityData['COMMUNICATION'] ? this.entityData['COMMUNICATION'] : null;\n\t\t},\n\t\tstatusClass()\n\t\t{\n\t\t\treturn {\n\t\t\t\t'crm-entity-stream-content-event-process': this.status.semantics === 'process',\n\t\t\t\t'crm-entity-stream-content-event-successful': this.status.semantics === 'success',\n\t\t\t\t'crm-entity-stream-content-event-missing': this.status.semantics === 'failure',\n\t\t\t\t'crm-entity-stream-content-event-error-tip': this.isStatusError,\n\t\t\t};\n\t\t},\n\t\tisStatusError()\n\t\t{\n\t\t\treturn (this.status.semantics === 'failure' && !!this.status.description);\n\t\t},\n\t\tstatusErrorDescription()\n\t\t{\n\t\t\treturn this.isStatusError ? this.status.description : '';\n\t\t},\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"crm-entity-stream-section crm-entity-stream-section-history crm-entity-stream-section-sms\">\n\t\t\t<div class=\"crm-entity-stream-section-icon crm-entity-stream-section-icon-sms\"></div>\n\t\t\t<div class=\"crm-entity-stream-section-content\">\n\t\t\t\t<div class=\"crm-entity-stream-content-event\">\n\t\t\t\t\t<div class=\"crm-entity-stream-content-header\">\n\t\t\t\t\t\t<a\n\t\t\t\t\t\t\t@click.prevent=\"viewActivity\"\n\t\t\t\t\t\t\thref=\"#\"\n\t\t\t\t\t\t\tclass=\"crm-entity-stream-content-event-title\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{{title}}\n\t\t\t\t\t\t</a>\n\t\t\t\t\t\t<span\n\t\t\t\t\t\t\tv-if=\"status\"\n\t\t\t\t\t\t\t:class=\"statusClass\"\n\t\t\t\t\t\t\t:title=\"statusErrorDescription\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{{status.name}}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<span class=\"crm-entity-stream-content-event-time\">{{createdAt}}</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"crm-entity-stream-content-detail\">\n\t\t\t\t\t\t<div class=\"crm-entity-stream-content-detail-sms\">\n\t\t\t\t\t\t\t<div class=\"crm-entity-stream-content-detail-sms-status\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('CRM_TIMELINE_NOTIFICATION_VIA')} \n\t\t\t\t\t\t\t\t<strong>\n\t\t\t\t\t\t\t\t\t${Loc.getMessage('CRM_TIMELINE_NOTIFICATION_BITRIX24')}\n\t\t\t\t\t\t\t\t</strong>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"crm-entity-stream-content-detail-sms-fragment\">\n\t\t\t\t\t\t\t\t<span>{{text}}</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tv-if=\"communication\"\n\t\t\t\t\t\t\tclass=\"crm-entity-stream-content-detail-contact-info\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{{BX.message('CRM_TIMELINE_SMS_TO')}}\n\t\t\t\t\t\t\t<a v-if=\"communication.SHOW_URL\" :href=\"communication.SHOW_URL\">\n\t\t\t\t\t\t\t\t{{communication.TITLE}}\n\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t\t\t{{communication.TITLE}}\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t<span v-if=\"communication.VALUE\">{{communication.VALUE}}</span>\n\t\t\t\t\t\t\t<template v-if=\"provider\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('CRM_TIMELINE_NOTIFICATION_IN_MESSENGER')} {{provider}}\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<author v-if=\"author\" :author=\"author\"></author>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\t\n\t`\n});\n","export default {\n\tprops: {\n\t\tdeliveryService: {\n\t\t\trequired: true,\n\t\t\ttype: Object\n\t\t},\n\t},\n\tcomputed: {\n\t\tisDeliveryServiceProfile()\n\t\t{\n\t\t\treturn this.deliveryService.IS_PROFILE;\n\t\t},\n\t\tdeliveryServiceName()\n\t\t{\n\t\t\treturn this.isDeliveryServiceProfile ? this.deliveryService.PARENT_NAME : this.deliveryService.NAME;\n\t\t},\n\t\tdeliveryProfileServiceName()\n\t\t{\n\t\t\treturn this.deliveryService.NAME;\n\t\t},\n\t\tdeliveryServiceLogoBackgroundUrl()\n\t\t{\n\t\t\treturn this.isDeliveryServiceProfile ? this.deliveryService.PARENT_LOGO : this.deliveryService.LOGO;\n\n\t\t\treturn logo\n\t\t\t\t? {\n\t\t\t\t\t'background-image': 'url(' + logo + ')'\n\t\t\t\t}\n\t\t\t\t: {};\n\t\t},\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"crm-entity-stream-content-delivery-title\">\n\t\t\t<div\n\t\t\t\tv-if=\"isDeliveryServiceProfile && deliveryService.LOGO\"\n\t\t\t\tclass=\"crm-entity-stream-content-delivery-icon\"\n\t\t\t\t:style=\"{'background-image': 'url(' + deliveryService.LOGO + ')'}\"\n\t\t\t>\n\t\t\t</div>\n\t\t\t<div class=\"crm-entity-stream-content-delivery-title-contnet\">\n\t\t\t\t<div\n\t\t\t\t\tv-if=\"deliveryServiceLogoBackgroundUrl\"\n\t\t\t\t\tclass=\"crm-entity-stream-content-delivery-title-logo\"\n\t\t\t\t\t:style=\"{'background-image': 'url(' + deliveryServiceLogoBackgroundUrl + ')'}\"\n\t\t\t\t></div>\n\t\t\t\t<div class=\"crm-entity-stream-content-delivery-title-info\">\n\t\t\t\t\t<div class=\"crm-entity-stream-content-delivery-title-name\">\n\t\t\t\t\t\t{{deliveryServiceName}}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div\n\t\t\t\t\t\tv-if=\"isDeliveryServiceProfile\"\n\t\t\t\t\t\tclass=\"crm-entity-stream-content-delivery-title-param\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{{deliveryProfileServiceName}}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`\n};\n","import {Vue} from 'ui.vue';\nimport {ajax, Loc} from 'main.core';\nimport Author from '../components/author';\nimport DeliveryServiceInfo from '../components/delivery/delivery-service-info';\nimport {PULL} from 'pull.client';\nimport HistoryItemMixin from '../mixins/history-item';\n\nexport default Vue.extend({\n\tmixins: [HistoryItemMixin],\n\tcomponents: {\n\t\t'author': Author,\n\t\t'delivery-service-info': DeliveryServiceInfo,\n\t},\n\tprops: {\n\t\tmode: {\n\t\t\trequired: true,\n\t\t\ttype: String\n\t\t},\n\t},\n\tdata()\n\t{\n\t\treturn {\n\t\t\tentityData: null,\n\t\t\tdeliveryInfo: null,\n\t\t\tisRefreshing: false,\n\t\t\tisCreatingRequest: false,\n\t\t\tisCancellingRequest: false,\n\t\t};\n\t},\n\tmethods: {\n\t\t// region common activity methods\n\t\tcompleteActivity()\n\t\t{\n\t\t\tif(this.self.canComplete())\n\t\t\t{\n\t\t\t\tthis.self.setAsDone(!this.self.isDone());\n\t\t\t}\n\t\t},\n\t\tshowContextMenu(event)\n\t\t{\n\t\t\tlet popup = BX.PopupMenu.create(\n\t\t\t\t'taxi_activity_context_menu_' + this.self.getId(),\n\t\t\t\tevent.target,\n\t\t\t\t[\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'delete',\n\t\t\t\t\t\ttext: this.getLangMessage('menuDelete'),\n\t\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\t\tpopup.close();\n\n\t\t\t\t\t\t\tlet deletionDlgId = 'entity_timeline_deletion_' + this.self.getId() + '_confirm';\n\t\t\t\t\t\t\tlet dlg = BX.Crm.ConfirmationDialog.get(deletionDlgId);\n\n\t\t\t\t\t\t\tif (!dlg)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tdlg = BX.Crm.ConfirmationDialog.create(\n\t\t\t\t\t\t\t\t\tdeletionDlgId,\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\ttitle: this.getLangMessage('removeConfirmTitle'),\n\t\t\t\t\t\t\t\t\t\tcontent: this.getLangMessage('deliveryRemove')\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tdlg.open().then(\n\t\t\t\t\t\t\t\t(result) => {\n\t\t\t\t\t\t\t\t\tif (result.cancel)\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\tthis.self.remove();\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t(result) => {},\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t],\n\t\t\t\t{\n\t\t\t\t\tautoHide: true,\n\t\t\t\t\toffsetTop: 0,\n\t\t\t\t\toffsetLeft: 16,\n\t\t\t\t\tangle: { position: \"top\", offset: 0 },\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tonPopupShow: () =>  BX.addClass(event.target, 'active'),\n\t\t\t\t\t\tonPopupClose: () => BX.removeClass(event.target, 'active'),\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tpopup.show();\n\t\t},\n\t\t// endregion\n\t\t// region delivery request methods\n\t\tcreateDeliveryRequest()\n\t\t{\n\t\t\tif (this.isLocked)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.isCreatingRequest = true;\n\t\t\tBX.ajax.runAction(\n\t\t\t\t'sale.deliveryrequest.create',\n\t\t\t\t{\n\t\t\t\t\tanalyticsLabel: 'saleDeliveryTaxiCall',\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tshipmentIds: this.shipmentIds,\n\t\t\t\t\t\tadditional: {\n\t\t\t\t\t\t\tACTIVITY_ID: this.activityId,\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t).then((result) => {\n\t\t\t\tthis.refresh(() => {\n\t\t\t\t\tthis.isCreatingRequest = false;\n\t\t\t\t});\n\t\t\t}).catch((result) => {\n\t\t\t\tthis.isCreatingRequest = false;\n\t\t\t\tthis.showError(result.errors.map((item) => item.message).join());\n\t\t\t});\n\t\t},\n\t\tcancelDeliveryRequest()\n\t\t{\n\t\t\tif (this.isLocked || !this.deliveryRequest)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.isCancellingRequest = true;\n\t\t\tBX.ajax.runAction(\n\t\t\t\t'sale.deliveryrequest.execute',\n\t\t\t\t{\n\t\t\t\t\tdata: {\n\t\t\t\t\t\trequestId: this.deliveryRequest['ID'],\n\t\t\t\t\t\tactionType: this.deliveryService['CANCEL_ACTION_CODE'],\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.then((result) => {\n\t\t\t\t\tconst data = result.data;\n\n\t\t\t\t\tBX.ajax.runAction(\n\t\t\t\t\t\t'crm.timeline.deliveryactivity.createcanceldeliveryrequestmessage',\n\t\t\t\t\t\t{data: {\n\t\t\t\t\t\t\trequestId: this.deliveryRequest['ID'],\n\t\t\t\t\t\t\tmessage: data.message\n\t\t\t\t\t\t}}\n\t\t\t\t\t).then((result) => {\n\t\t\t\t\t\tBX.ajax.runAction(\n\t\t\t\t\t\t\t'sale.deliveryrequest.delete',\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\t\trequestId: this.deliveryRequest['ID'],\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t.then((result) => {\n\t\t\t\t\t\t\t\tthis.refresh(() => {\n\t\t\t\t\t\t\t\t\tthis.isCancellingRequest = false;\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}).catch((result) => {\n\t\t\t\t\t\t\tthis.isCancellingRequest = false;\n\t\t\t\t\t\t\tthis.showError(result.errors.map((item) => item.message).join());\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t}).catch((result) => {\n\t\t\t\t\tthis.isCancellingRequest = false;\n\t\t\t\t\tthis.showError(result.errors.map((item) => item.message).join());\n\t\t\t\t});\n\t\t},\n\t\tcheckRequestStatus()\n\t\t{\n\t\t\tBX.ajax.runAction('crm.timeline.deliveryactivity.checkrequeststatus');\n\t\t},\n\t\tstartCheckingRequestStatus()\n\t\t{\n\t\t\tclearTimeout(this._checkRequestStatusTimeoutId);\n\t\t\tthis._checkRequestStatusTimeoutId = setInterval(\n\t\t\t\t() => this.checkRequestStatus(), 30 * 1000\n\t\t\t);\n\t\t},\n\t\tstopCheckingRequestStatus()\n\t\t{\n\t\t\tclearTimeout(this._checkRequestStatusTimeoutId);\n\t\t},\n\t\t// endregion\n\t\t// region refresh methods\n\t\tsetDeliveryInfo(deliveryInfo)\n\t\t{\n\t\t\tthis.deliveryInfo = deliveryInfo;\n\t\t},\n\t\trefresh(callback = null)\n\t\t{\n\t\t\tif (this.isRefreshing)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.isRefreshing = true;\n\n\t\t\tconst finallyCallback = () => {\n\t\t\t\tthis.isRefreshing = false;\n\t\t\t\tif (callback)\n\t\t\t\t{\n\t\t\t\t\tcallback();\n\t\t\t\t}\n\t\t\t};\n\t\t\tajax.runAction(\n\t\t\t\t'crm.timeline.deliveryactivity.getdeliveryinfo',\n\t\t\t\t{\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tactivityId: this.activityId\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t).then((result) => {\n\t\t\t\tthis.setDeliveryInfo(result.data);\n\t\t\t\tfinallyCallback();\n\t\t\t}).catch((result) => {\n\t\t\t\tfinallyCallback();\n\t\t\t});\n\t\t},\n\t\tsubscribePullEvents()\n\t\t{\n\t\t\tif (this._isPullSubscribed)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tPULL.subscribe({\n\t\t\t\tmoduleId: 'crm',\n\t\t\t\tcommand: 'onOrderShipmentSave',\n\t\t\t\tcallback: (params) => {\n\t\t\t\t\tif (this.shipmentIds.some(id => id == params.FIELDS.ID))\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.refresh();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\tPULL.subscribe({\n\t\t\t\tmoduleId: 'sale',\n\t\t\t\tcommand: 'onDeliveryServiceSave',\n\t\t\t\tcallback: (params) => {\n\t\t\t\t\tif (this.deliveryServiceIds.some(id => id == params.ID))\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.refresh();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\tPULL.subscribe({\n\t\t\t\tmoduleId: 'sale',\n\t\t\t\tcommand: 'onDeliveryRequestUpdate',\n\t\t\t\tcallback: (params) => {\n\t\t\t\t\tif (this.deliveryRequestId == params.ID)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.refresh();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\tPULL.subscribe({\n\t\t\t\tmoduleId: 'sale',\n\t\t\t\tcommand: 'onDeliveryRequestDelete',\n\t\t\t\tcallback: (params) => {\n\t\t\t\t\tif (this.deliveryRequestId == params.ID)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.refresh();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\tPULL.extendWatch('SALE_DELIVERY_SERVICE');\n\t\t\tPULL.extendWatch('CRM_ENTITY_ORDER_SHIPMENT');\n\t\t\tPULL.extendWatch('SALE_DELIVERY_REQUEST');\n\n\t\t\tthis._isPullSubscribed = true;\n\t\t},\n\t\t//endregion\n\t\t// region miscellaneous\n\t\tcallPhone(phone)\n\t\t{\n\t\t\tif (this.canUseTelephony && typeof(top.BXIM)!=='undefined')\n\t\t\t{\n\t\t\t\ttop.BXIM.phoneTo(phone);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\twindow.location.href='tel:' + phone;\n\t\t\t}\n\t\t},\n\t\tisPhone(property)\n\t\t{\n\t\t\treturn (\n\t\t\t\tproperty.hasOwnProperty('TAGS')\n\t\t\t\t&& Array.isArray(property['TAGS'])\n\t\t\t\t&& property['TAGS'].includes('phone')\n\t\t\t);\n\t\t},\n\t\tshowError(message)\n\t\t{\n\t\t\tBX.loadExt('ui.notification').then(() => { BX.UI.Notification.Center.notify({content: message}); });\n\t\t},\n\t\t// endregion\n\t},\n\tcreated()\n\t{\n\t\tthis.entityData = this.self.getAssociatedEntityData();\n\t\tif (this.entityData['DELIVERY_INFO'])\n\t\t{\n\t\t\tthis.setDeliveryInfo(this.entityData['DELIVERY_INFO']);\n\t\t}\n\n\t\tthis.subscribePullEvents();\n\n\t\tthis._checkRequestStatusTimeoutId = null;\n\t\tif (this.needCheckRequestStatus)\n\t\t{\n\t\t\tthis.startCheckingRequestStatus();\n\t\t}\n\t},\n\tcomputed: {\n\t\tactivityId()\n\t\t{\n\t\t\treturn this.data.ASSOCIATED_ENTITY.ID;\n\t\t},\n\t\t// region shipments\n\t\tshipments()\n\t\t{\n\t\t\tif (\n\t\t\t\tthis.deliveryInfo\n\t\t\t\t&& this.deliveryInfo.hasOwnProperty('SHIPMENTS')\n\t\t\t\t&& Array.isArray(this.deliveryInfo['SHIPMENTS'])\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn this.deliveryInfo['SHIPMENTS'];\n\t\t\t}\n\n\t\t\treturn null;\n\t\t},\n\t\tshipmentIds()\n\t\t{\n\t\t\treturn this.shipments ? this.shipments.map((shipment) => shipment['ID']) : [];\n\t\t},\n\t\tshipment()\n\t\t{\n\t\t\tif (\n\t\t\t\tthis.shipments\n\t\t\t\t&& Array.isArray(this.shipments)\n\t\t\t\t&& this.shipments.length > 0\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn this.shipments[0];\n\t\t\t}\n\n\t\t\treturn null;\n\t\t},\n\t\texpectedDeliveryPriceFormatted()\n\t\t{\n\t\t\treturn (this.shipment && this.shipment.hasOwnProperty('BASE_PRICE_DELIVERY'))\n\t\t\t\t? this.shipment['BASE_PRICE_DELIVERY_FORMATTED']\n\t\t\t\t: this.shipment['PRICE_DELIVERY_FORMATTED'];\n\t\t},\n\t\t// endregion\n\t\t// region delivery service\n\t\tdeliveryService()\n\t\t{\n\t\t\tif (\n\t\t\t\tthis.deliveryInfo\n\t\t\t\t&& this.deliveryInfo.hasOwnProperty('DELIVERY_SERVICE')\n\t\t\t\t&& typeof this.deliveryInfo['DELIVERY_SERVICE'] === 'object'\n\t\t\t\t&& this.deliveryInfo['DELIVERY_SERVICE'] !== null\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn this.deliveryInfo['DELIVERY_SERVICE'];\n\t\t\t}\n\n\t\t\treturn null;\n\t\t},\n\t\tdeliveryServiceIds()\n\t\t{\n\t\t\t// @TODO\n\t\t\tif (!this.deliveryService)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn this.deliveryService.IDS;\n\t\t},\n\t\t// endregion\n\t\t// region delivery request\n\t\tdeliveryRequest()\n\t\t{\n\t\t\tif (\n\t\t\t\tthis.deliveryInfo\n\t\t\t\t&& this.deliveryInfo.hasOwnProperty('DELIVERY_REQUEST')\n\t\t\t\t&& typeof this.deliveryInfo['DELIVERY_REQUEST'] === 'object'\n\t\t\t\t&& this.deliveryInfo['DELIVERY_REQUEST'] !== null\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn this.deliveryInfo['DELIVERY_REQUEST'];\n\t\t\t}\n\n\t\t\treturn null;\n\t\t},\n\t\tdeliveryRequestId()\n\t\t{\n\t\t\tif (this.deliveryRequest && this.deliveryRequest.hasOwnProperty('ID'))\n\t\t\t{\n\t\t\t\treturn this.deliveryRequest['ID'];\n\t\t\t}\n\n\t\t\treturn null;\n\t\t},\n\t\tdeliveryRequestProperties()\n\t\t{\n\t\t\tif (\n\t\t\t\tthis.deliveryRequest\n\t\t\t\t&& this.deliveryRequest.hasOwnProperty('EXTERNAL_PROPERTIES')\n\t\t\t\t&& typeof this.deliveryRequest['EXTERNAL_PROPERTIES'] === 'object'\n\t\t\t\t&& this.deliveryRequest['EXTERNAL_PROPERTIES'] !== null\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn this.deliveryRequest['EXTERNAL_PROPERTIES'];\n\t\t\t}\n\n\t\t\treturn null;\n\t\t},\n\t\tdeliveryRequestStatus()\n\t\t{\n\t\t\tif (!this.deliveryRequest)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn this.deliveryRequest['EXTERNAL_STATUS'];\n\t\t},\n\t\tdeliveryRequestStatusSemantic()\n\t\t{\n\t\t\tif (!this.deliveryRequest)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn this.deliveryRequest['EXTERNAL_STATUS_SEMANTIC'];\n\t\t},\n\t\tisConnectedWithDeliveryRequest()\n\t\t{\n\t\t\treturn !!this.deliveryRequest;\n\t\t},\n\t\tneedCheckRequestStatus()\n\t\t{\n\t\t\treturn this.isConnectedWithDeliveryRequest && this.mode === 'schedule';\n\t\t},\n\t\tisSendRequestButtonVisible()\n\t\t{\n\t\t\treturn (!this.isCreatingRequest && !this.isConnectedWithDeliveryRequest);\n\t\t},\n\t\t// endregion\n\t\t//region miscellaneous\n\t\tmiscellaneous()\n\t\t{\n\t\t\tif (\n\t\t\t\tthis.deliveryInfo\n\t\t\t\t&& this.deliveryInfo.hasOwnProperty('MISCELLANEOUS')\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn this.deliveryInfo['MISCELLANEOUS'];\n\t\t\t}\n\n\t\t\treturn null;\n\t\t},\n\t\tcanUseTelephony()\n\t\t{\n\t\t\treturn (\n\t\t\t\tthis.miscellaneous\n\t\t\t\t&& this.miscellaneous.hasOwnProperty('CAN_USE_TELEPHONY')\n\t\t\t\t&& this.miscellaneous['CAN_USE_TELEPHONY']\n\t\t\t);\n\t\t},\n\t\ttemplate()\n\t\t{\n\t\t\tif (!this.miscellaneous || !this.miscellaneous.hasOwnProperty('TEMPLATE'))\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn this.miscellaneous['TEMPLATE'];\n\t\t},\n\t\t// endregion\n\t\t// region classes\n\t\tcancelRequestButtonStyle()\n\t\t{\n\t\t\treturn {\n\t\t\t\t'ui-btn': true,\n\t\t\t\t'ui-btn-sm': true,\n\t\t\t\t'ui-btn-light-border': true,\n\t\t\t\t'ui-btn-wait': this.isCancellingRequest\n\t\t\t};\n\t\t},\n\t\tstatusClass()\n\t\t{\n\t\t\treturn {\n\t\t\t\t'crm-entity-stream-content-event-process': this.deliveryRequestStatusSemantic === 'process',\n\t\t\t\t'crm-entity-stream-content-event-missing': this.deliveryRequestStatusSemantic === 'error',\n\t\t\t\t'crm-entity-stream-content-event-done': this.deliveryRequestStatusSemantic === 'success',\n\t\t\t};\n\t\t},\n\t\twrapperContainerClass()\n\t\t{\n\t\t\treturn {\n\t\t\t\t'crm-entity-stream-section-planned': this.mode === 'schedule'\n\t\t\t};\n\t\t},\n\t\tinnerWrapperContainerClass()\n\t\t{\n\t\t\treturn {\n\t\t\t\t'crm-entity-stream-content-event--delivery': this.mode !== 'schedule'\n\t\t\t};\n\t\t},\n\t\t// endregion\n\t\tisLocked()\n\t\t{\n\t\t\treturn this.isRefreshing || this.isCreatingRequest || this.isCancellingRequest;\n\t\t},\n\t},\n\twatch: {\n\t\tneedCheckRequestStatus: function (value)\n\t\t{\n\t\t\tif (value)\n\t\t\t{\n\t\t\t\tthis.startCheckingRequestStatus();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.stopCheckingRequestStatus();\n\t\t\t}\n\t\t},\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div\n\t\t\tclass=\"crm-entity-stream-section crm-entity-stream-section-new\"\n\t\t\t:class=\"wrapperContainerClass\"\n\t\t>\n\t\t\t<div class=\"crm-entity-stream-section-icon crm-entity-stream-section-icon-new crm-entity-stream-section-icon-taxi\"></div>\n\t\t\t<div\n\t\t\t\tv-if=\"mode === 'schedule'\"\n\t\t\t\t@click=\"showContextMenu\"\n\t\t\t\tclass=\"crm-entity-stream-section-context-menu\"\n\t\t\t></div>\n\t\t\t<div class=\"crm-entity-stream-section-content\">\n\t\t\t\t<div\n\t\t\t\t\tclass=\"crm-entity-stream-content-event\"\n\t\t\t\t\t:class=\"innerWrapperContainerClass\"\n\t\t\t\t>\n\t\t\t\t\t<div class=\"crm-entity-stream-content-header\">\n\t\t\t\t\t\t<span class=\"crm-entity-stream-content-event-title\">\n\t\t\t\t\t\t\t${Loc.getMessage('TIMELINE_DELIVERY_TAXI_SERVICE')}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<span\n\t\t\t\t\t\t\tv-if=\"deliveryRequestStatus && deliveryRequestStatusSemantic\"\n\t\t\t\t\t\t\t:class=\"statusClass\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{{deliveryRequestStatus}}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<span class=\"crm-entity-stream-content-event-time\">{{createdAt}}</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"crm-entity-stream-content-detail crm-entity-stream-content-delivery\">\n\t\t\t\t\t\t<div class=\"crm-entity-stream-content-delivery-row crm-entity-stream-content-delivery-row--flex\">\n\t\t\t\t\t\t\t<template v-if=\"mode === 'schedule'\">\n\t\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t\tv-if=\"isSendRequestButtonVisible\"\n\t\t\t\t\t\t\t\t\t@click=\"createDeliveryRequest\"\n\t\t\t\t\t\t\t\t\tclass=\"ui-btn ui-btn-sm ui-btn-primary\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t${Loc.getMessage('TIMELINE_DELIVERY_CREATE_DELIVERY_REQUEST')}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t<span v-if=\"isCreatingRequest\" class=\"crm-entity-stream-content-delivery-status\">\n\t\t\t\t\t\t\t\t\t${Loc.getMessage('TIMELINE_DELIVERY_CREATING_REQUEST')}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t\tv-if=\"isConnectedWithDeliveryRequest && deliveryService && deliveryService.IS_CANCELLABLE\"\n\t\t\t\t\t\t\t\t\t@click=\"cancelDeliveryRequest\"\n\t\t\t\t\t\t\t\t\t:class=\"cancelRequestButtonStyle\"\n\t\t\t\t\t\t\t\t>\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t{{deliveryService.CANCEL_ACTION_NAME}}\n\t\t\t\t\t\t\t\t</span>\t\t\t\t\t\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t<delivery-service-info\n\t\t\t\t\t\t\t\tv-if=\"deliveryService\"\n\t\t\t\t\t\t\t\t:deliveryService=\"deliveryService\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t</delivery-service-info>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"crm-entity-stream-content-delivery-row\">\n\t\t\t\t\t\t\t<table class=\"crm-entity-stream-content-delivery-order\">\n\t\t\t\t\t\t\t\t<tr v-if=\"shipment && shipment.ADDRESS_FROM_FORMATTED && shipment.ADDRESS_TO_FORMATTED\">\n\t\t\t\t\t\t\t\t\t<td colspan=\"2\">\n\t\t\t\t\t\t\t\t\t\t<div class=\"crm-entity-stream-content-delivery-order-item\">\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"crm-entity-stream-content-delivery-order-value crm-entity-stream-content-delivery-order-value--sm\">\n\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"crm-entity-stream-content-delivery-order-box\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"crm-entity-stream-content-delivery-order-box-label\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t${Loc.getMessage('TIMELINE_DELIVERY_TAXI_ADDRESS_FROM')}\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span v-html=\"shipment.ADDRESS_FROM_FORMATTED\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"crm-entity-stream-content-delivery-order-box\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"crm-entity-stream-content-delivery-order-box-label\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t${Loc.getMessage('TIMELINE_DELIVERY_TAXI_ADDRESS_TO')}\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span v-html=\"shipment.ADDRESS_TO_FORMATTED\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t<tr v-if=\"shipment\">\n\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t<div class=\"crm-entity-stream-content-delivery-order-item\">\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"crm-entity-stream-content-delivery-order-label\">\n\t\t\t\t\t\t\t\t\t\t\t\t${Loc.getMessage('TIMELINE_DELIVERY_TAXI_CLIENT_DELIVERY_PRICE')}\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"crm-entity-stream-content-delivery-order-value crm-entity-stream-content-delivery-order-value--sm\">\n\t\t\t\t\t\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t\t\t\t\t\tv-html=\"shipment.PRICE_DELIVERY_FORMATTED\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t style=\"font-size: 14px; color: #333;\"\n\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t<div class=\"crm-entity-stream-content-delivery-order-item\">\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"crm-entity-stream-content-delivery-order-label\">\n\t\t\t\t\t\t\t\t\t\t\t\t${Loc.getMessage('TIMELINE_DELIVERY_TAXI_EXPECTED_DELIVERY_PRICE')}\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"crm-entity-stream-content-delivery-order-value crm-entity-stream-content-delivery-order-value--sm\">\n\t\t\t\t\t\t\t\t\t\t\t\t<span style=\"font-size: 14px; color: #333; opacity: .5;\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tv-html=\"expectedDeliveryPriceFormatted\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\t<span v-else>\n\t\t\t\t\t\t\t\t\t\t\t\t\t${Loc.getMessage('TIMELINE_DELIVERY_TAXI_EXPECTED_PRICE_NOT_RECEIVED')}\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t<!-- Properties --->\n\t\t\t\t\t\t\t\t<tr v-for=\"property in deliveryRequestProperties\">\n\t\t\t\t\t\t\t\t\t<td colspan=\"2\">\n\t\t\t\t\t\t\t\t\t\t<div class=\"crm-entity-stream-content-delivery-order-item\">\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"crm-entity-stream-content-delivery-order-label\">\n\t\t\t\t\t\t\t\t\t\t\t\t{{property.NAME}}\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"crm-entity-stream-content-delivery-order-value crm-entity-stream-content-delivery-order-value--sm\">\n\t\t\t\t\t\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t\t\t\t\t\tv-if=\"isPhone(property)\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t@click=\"callPhone(property.VALUE)\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"crm-entity-stream-content-delivery-link\"\n\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t{{property.VALUE}}\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\t<span v-else>\n\t\t\t\t\t\t\t\t\t\t\t\t\t{{property.VALUE}}\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t<!-- end Properties --->\n\t\t\t\t\t\t\t</table>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div v-if=\"mode === 'schedule'\" class=\"crm-entity-stream-content-detail-planned-action\">\n\t\t\t\t\t\t<input @click=\"completeActivity\" type=\"checkbox\" class=\"crm-entity-stream-planned-apply-btn\">\n\t\t\t\t\t</div>\n\t\t\t\t\t<author v-if=\"author\" :author=\"author\">\n\t\t\t\t\t</author>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`\n});\n","import {Vue} from 'ui.vue';\nimport HistoryItemMixin from '../mixins/history-item';\nimport Author from '../components/author';\nimport DeliveryServiceInfo from '../components/delivery/delivery-service-info';\n\nexport default Vue.extend({\n\tmixins: [HistoryItemMixin],\n\tcomponents: {\n\t\t'author': Author,\n\t\t'delivery-service-info': DeliveryServiceInfo,\n\t},\n\tcomputed: {\n\t\tdeliveryService()\n\t\t{\n\t\t\tif (!this.data.FIELDS.hasOwnProperty('DELIVERY_SERVICE'))\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn this.data.FIELDS.DELIVERY_SERVICE;\n\t\t},\n\t\tmessageData()\n\t\t{\n\t\t\tif (!this.data.FIELDS.hasOwnProperty('MESSAGE_DATA'))\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn this.data.FIELDS.MESSAGE_DATA;\n\t\t},\n\t\tmessageTitle()\n\t\t{\n\t\t\tif (!this.messageData)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn this.messageData['TITLE'];\n\t\t},\n\t\tmessageDescription()\n\t\t{\n\t\t\tif (!this.messageData)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn this.messageData['DESCRIPTION'];\n\t\t},\n\t\tmessageStatus()\n\t\t{\n\t\t\tif (!this.messageData)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn this.messageData['STATUS'];\n\t\t},\n\t\tmessageStatusSemantics()\n\t\t{\n\t\t\tif (!this.messageData)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn this.messageData['STATUS_SEMANTIC'];\n\t\t},\n\t\tmessageStatusSemanticsClass()\n\t\t{\n\t\t\treturn {\n\t\t\t\t'crm-entity-stream-content-event-process': this.messageStatusSemantics === 'process',\n\t\t\t\t'crm-entity-stream-content-event-missing': this.messageStatusSemantics === 'error',\n\t\t\t\t'crm-entity-stream-content-event-done': this.messageStatusSemantics === 'success',\n\t\t\t};\n\t\t},\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"crm-entity-stream-section crm-entity-stream-section-new\">\n\t\t\t<div class=\"crm-entity-stream-section-icon crm-entity-stream-section-icon-new crm-entity-stream-section-icon-taxi\"></div>\n\t\t\t<div class=\"crm-entity-stream-section-content\">\n\t\t\t\t<div class=\"crm-entity-stream-content-event\">\n\t\t\t\t\t<div class=\"crm-entity-stream-content-header\">\n\t\t\t\t\t\t<span\n\t\t\t\t\t\t\tv-if=\"messageTitle\"\n\t\t\t\t\t\t\tclass=\"crm-entity-stream-content-event-title\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{{messageTitle}}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<span\n\t\t\t\t\t\t\tv-if=\"messageStatus && messageStatusSemantics\"\n\t\t\t\t\t\t\t:class=\"messageStatusSemanticsClass\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{{messageStatus}}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<span class=\"crm-entity-stream-content-event-time\">\n\t\t\t\t\t\t\t<span v-html=\"createdAt\">\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"crm-entity-stream-content-detail\">\n\t\t\t\t\t\t<div class=\"crm-entity-stream-content-delivery-row crm-entity-stream-content-delivery-row--flex\">\n\t\t\t\t\t\t\t<delivery-service-info\n\t\t\t\t\t\t\t\tv-if=\"deliveryService\"\n\t\t\t\t\t\t\t\t:deliveryService=\"deliveryService\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t</delivery-service-info>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tv-if=\"messageDescription\"\n\t\t\t\t\t\t\tclass=\"crm-entity-stream-content-delivery-description\"\n\t\t\t\t\t\t\tv-html=\"messageDescription\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<author v-if=\"author\" :author=\"author\">\n\t\t\t\t\t</author>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`\n});\n","import {Vue} from 'ui.vue';\nimport {Loc} from 'main.core';\nimport HistoryItemMixin from '../mixins/history-item';\nimport Author from '../components/author';\nimport DeliveryServiceInfo from '../components/delivery/delivery-service-info';\n\nexport default Vue.extend({\n\tmixins: [HistoryItemMixin],\n\tcomponents: {\n\t\t'author': Author,\n\t\t'delivery-service-info': DeliveryServiceInfo,\n\t},\n\tcomputed: {\n\t\tdeliveryService()\n\t\t{\n\t\t\tif (!this.data.FIELDS.hasOwnProperty('DELIVERY_SERVICE'))\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn this.data.FIELDS.DELIVERY_SERVICE;\n\t\t},\n\t\tmessageData()\n\t\t{\n\t\t\tif (!this.data.FIELDS.hasOwnProperty('MESSAGE_DATA'))\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn this.data.FIELDS.MESSAGE_DATA;\n\t\t},\n\t\tmessageTitle()\n\t\t{\n\t\t\tif (!this.messageData)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn this.messageData['TITLE'];\n\t\t},\n\t\tmessageDescription()\n\t\t{\n\t\t\tif (!this.messageData)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn this.messageData['DESCRIPTION'];\n\t\t},\n\t\tmessageStatus()\n\t\t{\n\t\t\tif (!this.messageData)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn this.messageData['STATUS'];\n\t\t},\n\t\tmessageStatusSemantics()\n\t\t{\n\t\t\tif (!this.messageData)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn this.messageData['STATUS_SEMANTIC'];\n\t\t},\n\t\tmessageStatusSemanticsClass()\n\t\t{\n\t\t\treturn {\n\t\t\t\t'crm-entity-stream-content-event-process': this.messageStatusSemantics === 'process',\n\t\t\t\t'crm-entity-stream-content-event-missing': this.messageStatusSemantics === 'error',\n\t\t\t\t'crm-entity-stream-content-event-done': this.messageStatusSemantics === 'success',\n\t\t\t};\n\t\t},\n\t\taddressFrom()\n\t\t{\n\t\t\tif (!this.data.FIELDS.hasOwnProperty('ADDRESS_FROM_FORMATTED'))\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn this.data.FIELDS.ADDRESS_FROM_FORMATTED;\n\t\t},\n\t\taddressTo()\n\t\t{\n\t\t\tif (!this.data.FIELDS.hasOwnProperty('ADDRESS_TO_FORMATTED'))\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn this.data.FIELDS.ADDRESS_TO_FORMATTED;\n\t\t},\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"crm-entity-stream-section crm-entity-stream-section-new\">\n\t\t\t<div class=\"crm-entity-stream-section-icon crm-entity-stream-section-icon-new crm-entity-stream-section-icon-taxi\"></div>\n\t\t\t\n\t\t\t<div class=\"crm-entity-stream-section-content\">\n\t\t\t\t<div class=\"crm-entity-stream-content-event\">\n\t\t\t\t\t<div class=\"crm-entity-stream-content-header\">\n\t\t\t\t\t\t<span\n\t\t\t\t\t\t\tv-if=\"messageTitle\"\n\t\t\t\t\t\t\tclass=\"crm-entity-stream-content-event-title\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{{messageTitle}}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<span\n\t\t\t\t\t\t\tv-if=\"messageStatus && messageStatusSemantics\"\n\t\t\t\t\t\t\t:class=\"messageStatusSemanticsClass\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{{messageStatus}}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<span class=\"crm-entity-stream-content-event-time\">\n\t\t\t\t\t\t\t<span v-html=\"createdAt\">\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"crm-entity-stream-content-detail\">\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tv-html=\"messageDescription\"\n\t\t\t\t\t\t\tclass=\"crm-entity-stream-content-detail-description crm-delivery-taxi-caption\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"crm-entity-stream-content-detail-description\">\n\t\t\t\t\t\t\t<div v-if=\"addressFrom\" class=\"crm-entity-stream-content-delivery-order-box\">\n\t\t\t\t\t\t\t\t<div class=\"crm-entity-stream-content-delivery-order-box-label\">\n\t\t\t\t\t\t\t\t\t${Loc.getMessage('TIMELINE_DELIVERY_TAXI_ADDRESS_FROM')}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<span>{{addressFrom}}</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div v-if=\"addressTo\" class=\"crm-entity-stream-content-delivery-order-box\">\n\t\t\t\t\t\t\t\t<div class=\"crm-entity-stream-content-delivery-order-box-label\">\n\t\t\t\t\t\t\t\t\t${Loc.getMessage('TIMELINE_DELIVERY_TAXI_ADDRESS_TO')}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<span>{{addressTo}}</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<author v-if=\"author\" :author=\"author\">\n\t\t\t\t\t</author>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`\n});\n","import {Dom} from \"main.core\";\nimport Manager from \"./manager\";\n\n/** @memberof BX.Crm.Timeline */\nexport default class Editor\n{\n\tconstructor()\n\t{\n\t\tthis._id = \"\";\n\t\tthis._settings = {};\n\t\tthis._manager = null;\n\n\t\tthis._ownerTypeId = 0;\n\t\tthis._ownerId = 0;\n\n\t\tthis._container = null;\n\t\tthis._input = null;\n\t\tthis._saveButton = null;\n\t\tthis._cancelButton = null;\n\t\tthis._ghostInput = null;\n\n\t\tthis._saveButtonHandler = BX.delegate(this.onSaveButtonClick, this);\n\t\tthis._cancelButtonHandler = BX.delegate(this.onCancelButtonClick, this);\n\t\tthis._focusHandler = BX.delegate(this.onFocus, this);\n\t\tthis._blurHandler = BX.delegate(this.onBlur, this);\n\t\tthis._keyupHandler = BX.delegate(this.resizeForm, this);\n\t\tthis._delayedKeyupHandler = BX.delegate(\n\t\t\tfunction()\n\t\t\t{\n\t\t\t\tsetTimeout(this.resizeForm.bind(this), 0);\n\t\t\t},\n\t\t\tthis\n\t\t);\n\n\t\tthis._isVisible = true;\n\t\tthis._hideButtonsOnBlur = true;\n\t}\n\n\tinitialize(id, settings)\n\t{\n\t\tthis._id = BX.type.isNotEmptyString(id) ? id : BX.util.getRandomString(4);\n\t\tthis._settings = settings ? settings : {};\n\n\t\tthis._manager = this.getSetting(\"manager\");\n\t\tif(!(this._manager instanceof Manager))\n\t\t{\n\t\t\tthrow \"Editor. Manager instance is not found.\";\n\t\t}\n\n\t\tthis._ownerTypeId = this.getSetting(\"ownerTypeId\", 0);\n\t\tthis._ownerId = this.getSetting(\"ownerId\", 0);\n\n\t\tthis._container = BX(this.getSetting(\"container\"));\n\t\tthis._input = BX(this.getSetting(\"input\"));\n\t\tthis._saveButton = BX(this.getSetting(\"button\"));\n\t\tthis._cancelButton = BX(this.getSetting(\"cancelButton\"));\n\n\t\tBX.bind(this._saveButton, \"click\", this._saveButtonHandler);\n\t\tif(this._cancelButton)\n\t\t{\n\t\t\tBX.bind(this._cancelButton, \"click\", this._cancelButtonHandler);\n\t\t}\n\n\t\tthis.bindInputHandlers();\n\t\tthis.doInitialize();\n\t}\n\n\tdoInitialize()\n\t{\n\t}\n\n\tbindInputHandlers()\n\t{\n\t\tBX.bind(this._input, \"focus\", this._focusHandler);\n\t\tBX.bind(this._input, \"blur\", this._blurHandler);\n\t\tBX.bind(this._input, \"keyup\", this._keyupHandler);\n\t\tBX.bind(this._input, \"cut\", this._delayedKeyupHandler);\n\t\tBX.bind(this._input, \"paste\", this._delayedKeyupHandler);\n\t}\n\n\tgetId()\n\t{\n\t\treturn this._id;\n\t}\n\n\tgetSetting(name, defaultval)\n\t{\n\t\treturn this._settings.hasOwnProperty(name) ? this._settings[name] : defaultval;\n\t}\n\n\tsetVisible(visible)\n\t{\n\t\tvisible = !!visible;\n\t\tif(this._isVisible === visible)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis._isVisible = visible;\n\t\tif (this._container)\n\t\t{\n\t\t\tthis._container.style.display = visible ? \"\" : \"none\";\n\t\t}\n\t}\n\n\tisVisible()\n\t{\n\t\treturn this._isVisible;\n\t}\n\n\tonFocus(e)\n\t{\n\t\tBX.addClass(this._container, \"focus\");\n\t}\n\n\tonBlur(e)\n\t{\n\t\tif(!this._hideButtonsOnBlur)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif(this._input.value === \"\")\n\t\t{\n\t\t\twindow.setTimeout(\n\t\t\t\tBX.delegate(function() {\n\t\t\t\t\tBX.removeClass(this._container, \"focus\");\n\t\t\t\t\tthis._input.style.minHeight = \"\";\n\t\t\t\t}, this),\n\t\t\t\t200\n\t\t\t);\n\t\t}\n\t}\n\n\tonSaveButtonClick(e)\n\t{\n\t\tDom.addClass(this._saveButton, 'ui-btn-wait');\n\t\tconst removeButtonWaitClass = () => Dom.removeClass(this._saveButton, 'ui-btn-wait');\n\n\t\tconst saveResult = this.save();\n\t\tif (saveResult instanceof BX.Promise || saveResult instanceof Promise)\n\t\t{\n\t\t\tsaveResult.then(\n\t\t\t\t() => removeButtonWaitClass(),\n\t\t\t\t() => removeButtonWaitClass()\n\t\t\t);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tremoveButtonWaitClass();\n\t\t}\n\t}\n\n\tonCancelButtonClick()\n\t{\n\t\tthis.cancel();\n\t\tthis._manager.processEditingCancellation(this);\n\t}\n\n\tsave()\n\t{\n\t}\n\n\tcancel()\n\t{\n\t}\n\n\trelease()\n\t{\n\t\tif(this._ghostInput)\n\t\t{\n\t\t\tthis._ghostInput = BX.remove(this._ghostInput);\n\t\t}\n\t}\n\n\tensureGhostCreated()\n\t{\n\t\tif(this._ghostInput)\n\t\t{\n\t\t\treturn this._ghostInput;\n\t\t}\n\n\t\tthis._ghostInput = BX.create('div', {\n\t\t\tprops: { className: 'crm-entity-stream-content-new-comment-textarea-shadow' },\n\t\t\ttext: this._input.value\n\t\t});\n\n\t\tthis._ghostInput.style.width = this._input.offsetWidth + 'px';\n\t\tdocument.body.appendChild(this._ghostInput);\n\t\treturn this._ghostInput;\n\t}\n\n\tresizeForm()\n\t{\n\t\tconst ghost = this.ensureGhostCreated();\n\t\tconst computedStyle = getComputedStyle(this._input);\n\t\tconst diff = parseInt(computedStyle.paddingBottom) +\n\t\t\tparseInt(computedStyle.paddingTop) +\n\t\t\tparseInt(computedStyle.borderTopWidth) +\n\t\t\tparseInt(computedStyle.borderBottomWidth) || 0;\n\n\t\tghost.innerHTML = BX.util.htmlspecialchars(this._input.value.replace(/[\\r\\n]{1}/g, '<br>'));\n\t\tthis._input.style.minHeight = ghost.scrollHeight + diff + 'px'\n\t}\n}\n","import Wait from \"../editors/wait\";\n\n/** @memberof BX.Crm.Timeline.Tools */\nexport default class WaitConfigurationDialog\n{\n\tconstructor()\n\t{\n\t\tthis._id = \"\";\n\t\tthis._settings = {};\n\t\tthis._type = Wait.WaitingType.undefined;\n\t\tthis._duration = 0;\n\t\tthis._target = \"\";\n\t\tthis._targetDates = null;\n\t\tthis._container = null;\n\t\tthis._durationMeasureNode = null;\n\t\tthis._durationInput = null;\n\t\tthis._targetDateNode = null;\n\t\tthis._popup = null;\n\t}\n\n\tinitialize(id, settings)\n\t{\n\t\tthis._id = BX.type.isNotEmptyString(id) ? id : BX.util.getRandomString(4);\n\t\tthis._settings = settings ? settings : {};\n\t\tthis._type = BX.prop.getInteger(this._settings, \"type\", Wait.WaitingType.after);\n\t\tthis._duration = BX.prop.getInteger(this._settings, \"duration\", 1);\n\t\tthis._target = BX.prop.getString(this._settings, \"target\", \"\");\n\t\tthis._targetDates = BX.prop.getArray(this._settings, \"targetDates\", []);\n\n\t\tthis._menuId = this._id + \"_target_date_sel\";\n\t}\n\n\tgetId()\n\t{\n\t\treturn this._id;\n\t}\n\n\tgetType()\n\t{\n\t\treturn this._type;\n\t}\n\n\tsetType(type)\n\t{\n\t\tthis._type = type;\n\t}\n\n\tgetDuration()\n\t{\n\t\treturn this._duration;\n\t}\n\n\tsetDuration(duration)\n\t{\n\t\tthis._duration = duration;\n\t}\n\n\tgetTarget()\n\t{\n\t\treturn this._target;\n\t}\n\n\tsetTarget(target)\n\t{\n\t\tthis._target = target;\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = WaitConfigurationDialog.messages;\n\t\treturn m.hasOwnProperty(name) ? m[name] : name;\n\t}\n\n\tgetDurationText(duration, enableNumber)\n\t{\n\t\treturn Wait.Helper.getDurationText(duration, enableNumber);\n\t}\n\n\tgetTargetDateCaption(name)\n\t{\n\t\tconst length = this._targetDates.length;\n\t\tfor(let i = 0; i < length; i++)\n\t\t{\n\t\t\tconst info = this._targetDates[i];\n\t\t\tif(info[\"name\"] === name)\n\t\t\t{\n\t\t\t\treturn info[\"caption\"];\n\t\t\t}\n\t\t}\n\n\t\treturn \"\";\n\t}\n\n\topen()\n\t{\n\t\tthis._popup = new BX.PopupWindow(\n\t\t\tthis._id,\n\t\t\tnull, //this._configSelector,\n\t\t\t{\n\t\t\t\tautoHide: true,\n\t\t\t\tdraggable: false,\n\t\t\t\tbindOptions: { forceBindPosition: false },\n\t\t\t\tcloseByEsc: true,\n\t\t\t\tzIndex: 0,\n\t\t\t\tcontent: this.prepareDialogContent(),\n\t\t\t\tevents:\n\t\t\t\t\t{\n\t\t\t\t\t\tonPopupShow: BX.delegate(this.onPopupShow, this),\n\t\t\t\t\t\tonPopupClose: BX.delegate(this.onPopupClose, this),\n\t\t\t\t\t\tonPopupDestroy: BX.delegate(this.onPopupDestroy, this)\n\t\t\t\t\t},\n\t\t\t\tbuttons:\n\t\t\t\t\t[\n\t\t\t\t\t\tnew BX.PopupWindowButton(\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttext: this.getMessage(\"select\"),\n\t\t\t\t\t\t\t\tclassName: \"popup-window-button-accept\" ,\n\t\t\t\t\t\t\t\tevents: { click: BX.delegate(this.onSaveButtonClick, this) }\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t),\n\t\t\t\t\t\tnew BX.PopupWindowButtonLink(\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttext : BX.message(\"JS_CORE_WINDOW_CANCEL\"),\n\t\t\t\t\t\t\t\tevents: { click: BX.delegate(this.onCancelButtonClick, this) }\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t)\n\t\t\t\t\t]\n\t\t\t}\n\t\t);\n\t\tthis._popup.show();\n\t}\n\n\tclose()\n\t{\n\t\tif(this._popup)\n\t\t{\n\t\t\tthis._popup.close();\n\t\t}\n\t}\n\n\tprepareDialogContent()\n\t{\n\t\tconst container = BX.create(\"div\", {attrs: {className: \"crm-wait-popup-select-block\"}});\n\t\tconst wrapper = BX.create(\"div\", {attrs: {className: \"crm-wait-popup-select-wrapper\"}});\n\t\tcontainer.appendChild(wrapper);\n\n\t\tthis._durationInput = BX.create(\n\t\t\t\"input\",\n\t\t\t{\n\t\t\t\tattrs: { type: \"text\", className: \"crm-wait-popup-settings-input\", value: this._duration },\n\t\t\t\tevents: { keyup: BX.delegate(this.onDurationChange, this) }\n\t\t\t}\n\t\t);\n\n\t\tthis._durationMeasureNode = BX.create(\n\t\t\t\"span\",\n\t\t\t{ attrs: { className: \"crm-wait-popup-settings-title\" }, text: this.getDurationText(this._duration, false) }\n\t\t);\n\n\t\tif(this._type === Wait.WaitingType.after)\n\t\t{\n\t\t\twrapper.appendChild(\n\t\t\t\tBX.create(\"span\", { attrs: { className: \"crm-wait-popup-settings-title\" }, text: this.getMessage(\"prefixTypeAfter\") })\n\t\t\t);\n\t\t\twrapper.appendChild(this._durationInput);\n\t\t\twrapper.appendChild(this._durationMeasureNode);\n\t\t}\n\t\telse\n\t\t{\n\t\t\twrapper.appendChild(\n\t\t\t\tBX.create(\"span\", { attrs: { className: \"crm-wait-popup-settings-title\" }, text: this.getMessage(\"prefixTypeBefore\") })\n\t\t\t);\n\t\t\twrapper.appendChild(this._durationInput);\n\t\t\twrapper.appendChild(this._durationMeasureNode);\n\t\t\twrapper.appendChild(\n\t\t\t\tBX.create(\"span\", { attrs: { className: \"crm-wait-popup-settings-title\" }, text: \" \" + this.getMessage(\"targetPrefixTypeBefore\") })\n\t\t\t);\n\n\t\t\tthis._targetDateNode = BX.create(\n\t\t\t\t\"span\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-automation-popup-settings-link\" },\n\t\t\t\t\ttext: this.getTargetDateCaption(this._target),\n\t\t\t\t\tevents: { click: BX.delegate(this.toggleTargetMenu, this) }\n\t\t\t\t}\n\t\t\t);\n\t\t\twrapper.appendChild(this._targetDateNode);\n\t\t}\n\t\treturn container;\n\t}\n\n\tonDurationChange()\n\t{\n\t\tlet duration = parseInt(this._durationInput.value);\n\t\tif(isNaN(duration) || duration <= 0)\n\t\t{\n\t\t\tduration = 1;\n\t\t}\n\t\tthis._duration = duration;\n\t\tthis._durationMeasureNode.innerHTML = BX.util.htmlspecialchars(this.getDurationText(duration, false));\n\n\t}\n\n\ttoggleTargetMenu()\n\t{\n\t\tif(this.isTargetMenuOpened())\n\t\t{\n\t\t\tthis.closeTargetMenu();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.openTargetMenu();\n\t\t}\n\t}\n\n\tisTargetMenuOpened()\n\t{\n\t\treturn !!BX.PopupMenu.getMenuById(this._menuId);\n\t}\n\n\topenTargetMenu()\n\t{\n\t\tconst menuItems = [];\n\t\tlet i = 0;\n\t\tconst length = this._targetDates.length;\n\t\tfor(; i < length; i++)\n\t\t{\n\t\t\tconst info = this._targetDates[i];\n\n\t\t\tmenuItems.push(\n\t\t\t\t{\n\t\t\t\t\ttext: info[\"caption\"],\n\t\t\t\t\ttitle: info[\"caption\"],\n\t\t\t\t\tvalue: info[\"name\"],\n\t\t\t\t\tonclick: BX.delegate(this.onTargetSelect, this)\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\tBX.PopupMenu.show(\n\t\t\tthis._menuId,\n\t\t\tthis._targetDateNode,\n\t\t\tmenuItems,\n\t\t\t{\n\t\t\t\tzIndex: 200,\n\t\t\t\tautoHide: true,\n\t\t\t\toffsetLeft: BX.pos(this._targetDateNode)[\"width\"] / 2,\n\t\t\t\tangle: { position: 'top', offset: 0 }\n\t\t\t}\n\t\t);\n\t}\n\n\tcloseTargetMenu()\n\t{\n\t\tBX.PopupMenu.destroy(this._menuId);\n\t}\n\n\tonPopupShow(e, item)\n\t{\n\t}\n\n\tonPopupClose()\n\t{\n\t\tif(this._popup)\n\t\t{\n\t\t\tthis._popup.destroy();\n\t\t}\n\n\t\tthis.closeTargetMenu();\n\t}\n\n\tonPopupDestroy()\n\t{\n\t\tif(this._popup)\n\t\t{\n\t\t\tthis._popup = null;\n\t\t}\n\t}\n\n\tonSaveButtonClick(e)\n\t{\n\t\tconst callback = BX.prop.getFunction(this._settings, \"onSave\", null);\n\t\tif(!callback)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst params = {type: this._type};\n\t\tparams[\"duration\"] = this._duration;\n\t\tparams[\"target\"] = this._type === Wait.WaitingType.before ? this._target : \"\";\n\t\tcallback(this, params);\n\t}\n\n\tonCancelButtonClick(e)\n\t{\n\t\tconst callback = BX.prop.getFunction(this._settings, \"onCancel\", null);\n\t\tif(callback)\n\t\t{\n\t\t\tcallback(this);\n\t\t}\n\t}\n\n\tonTargetSelect(e, item)\n\t{\n\t\tconst fieldName = BX.prop.getString(item, \"value\", \"\");\n\t\tif(fieldName !== \"\")\n\t\t{\n\t\t\tthis._target = fieldName;\n\t\t\tthis._targetDateNode.innerHTML = BX.util.htmlspecialchars(this.getTargetDateCaption(fieldName));\n\t\t}\n\n\t\tthis.closeTargetMenu();\n\t\te.preventDefault ? e.preventDefault() : (e.returnValue = false);\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new WaitConfigurationDialog();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n\n\tstatic messages = {};\n}\n","import Editor from \"../editor.js\";\nimport WaitConfigurationDialog from \"../tools/wait-configuration-dialog\";\n\n/** @memberof BX.Crm.Timeline.Editors */\nexport default class Wait extends Editor\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._serviceUrl = \"\";\n\t\tthis._isRequestRunning = false;\n\t\tthis._isLocked = false;\n\n\t\tthis._hideButtonsOnBlur = false;\n\t\t//region Config\n\t\tthis._type = Wait.WaitingType.after;\n\t\tthis._duration = 1;\n\t\tthis._target = \"\";\n\t\tthis._configContainer = null;\n\t\tthis._configSelector = null;\n\t\t//endregion\n\n\t\tthis._isMenuShown = false;\n\t\tthis._menu = null;\n\t\tthis._configDialog = null;\n\t}\n\n\tdoInitialize()\n\t{\n\t\tthis._configContainer = BX(this.getSetting(\"configContainer\"));\n\t\tthis._serviceUrl = this.getSetting(\"serviceUrl\", \"\");\n\n\t\tconst config = BX.prop.getObject(this._settings, \"config\", {});\n\t\tthis._type = Wait.WaitingType.resolveTypeId(\n\t\t\tBX.prop.getString(\n\t\t\t\tconfig,\n\t\t\t\t\"type\",\n\t\t\t\tWait.WaitingType.names.after\n\t\t\t)\n\t\t);\n\t\tthis._duration = BX.prop.getInteger(config, \"duration\", 1);\n\t\tthis._target = BX.prop.getString(config, \"target\", \"\");\n\t\tthis._targetDates = BX.prop.getArray(this._settings, \"targetDates\", []);\n\t\tthis.layoutConfigurationSummary();\n\t}\n\n\tgetDurationText(duration, enableNumber)\n\t{\n\t\treturn Wait.Helper.getDurationText(duration, enableNumber);\n\t}\n\n\tgetTargetDateCaption(name)\n\t{\n\t\tlet i = 0;\n\t\tconst length = this._targetDates.length;\n\t\tfor(; i < length; i++)\n\t\t{\n\t\t\tconst info = this._targetDates[i];\n\t\t\tif(info[\"name\"] === name)\n\t\t\t{\n\t\t\t\treturn info[\"caption\"];\n\t\t\t}\n\t\t}\n\n\t\treturn \"\";\n\t}\n\n\tonSelectorClick(e)\n\t{\n\t\tif(!this._isMenuShown)\n\t\t{\n\t\t\tthis.openMenu();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.closeMenu();\n\t\t}\n\t\te.preventDefault ? e.preventDefault() : (e.returnValue = false);\n\t}\n\n\topenMenu()\n\t{\n\t\tif(this._isMenuShown)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst handler = BX.delegate(this.onMenuItemClick, this);\n\n\t\tconst menuItems =\n\t\t\t[\n\t\t\t\t{id: \"day_1\", text: this.getMessage(\"oneDay\"), onclick: handler},\n\t\t\t\t{id: \"day_2\", text: this.getMessage(\"twoDays\"), onclick: handler},\n\t\t\t\t{id: \"day_3\", text: this.getMessage(\"threeDays\"), onclick: handler},\n\t\t\t\t{id: \"week_1\", text: this.getMessage(\"oneWeek\"), onclick: handler},\n\t\t\t\t{id: \"week_2\", text: this.getMessage(\"twoWeek\"), onclick: handler},\n\t\t\t\t{id: \"week_3\", text: this.getMessage(\"threeWeeks\"), onclick: handler}\n\t\t\t];\n\n\t\tconst customMenu = {id: \"custom\", text: this.getMessage(\"custom\"), items: []};\n\t\tcustomMenu[\"items\"].push({ id: \"afterDays\", text: this.getMessage(\"afterDays\"), onclick: handler });\n\t\tif(this._targetDates.length > 0)\n\t\t{\n\t\t\tcustomMenu[\"items\"].push({ id: \"beforeDate\", text: this.getMessage(\"beforeDate\"), onclick: handler });\n\t\t}\n\t\tmenuItems.push(customMenu);\n\n\t\tBX.PopupMenu.show(\n\t\t\tthis._id,\n\t\t\tthis._configSelector,\n\t\t\tmenuItems,\n\t\t\t{\n\t\t\t\toffsetTop: 0,\n\t\t\t\toffsetLeft: 36,\n\t\t\t\tangle: { position: \"top\", offset: 0 },\n\t\t\t\tevents:\n\t\t\t\t\t{\n\t\t\t\t\t\tonPopupShow: BX.delegate(this.onMenuShow, this),\n\t\t\t\t\t\tonPopupClose: BX.delegate(this.onMenuClose, this),\n\t\t\t\t\t\tonPopupDestroy: BX.delegate(this.onMenuDestroy, this)\n\t\t\t\t\t}\n\t\t\t}\n\t\t);\n\n\t\tthis._menu = BX.PopupMenu.currentItem;\n\t}\n\n\tcloseMenu()\n\t{\n\t\tif(!this._isMenuShown)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif(this._menu)\n\t\t{\n\t\t\tthis._menu.close();\n\t\t}\n\t}\n\n\tonMenuItemClick(e, item)\n\t{\n\t\tthis.closeMenu();\n\n\t\tif(item.id === \"afterDays\" || item.id === \"beforeDate\")\n\t\t{\n\t\t\tthis.openConfigDialog(\n\t\t\t\titem.id === \"afterDays\" ? Wait.WaitingType.after : Wait.WaitingType.before\n\t\t\t);\n\t\t\treturn;\n\t\t}\n\n\t\tconst params = {type: Wait.WaitingType.after};\n\t\tif(item.id === \"day_1\")\n\t\t{\n\t\t\tparams[\"duration\"] = 1;\n\t\t}\n\t\telse if(item.id === \"day_2\")\n\t\t{\n\t\t\tparams[\"duration\"] = 2;\n\t\t}\n\t\telse if(item.id === \"day_3\")\n\t\t{\n\t\t\tparams[\"duration\"] = 3;\n\t\t}\n\t\tif(item.id === \"week_1\")\n\t\t{\n\t\t\tparams[\"duration\"] = 7;\n\t\t}\n\t\telse if(item.id === \"week_2\")\n\t\t{\n\t\t\tparams[\"duration\"] = 14;\n\t\t}\n\t\telse if(item.id === \"week_3\")\n\t\t{\n\t\t\tparams[\"duration\"] = 21;\n\t\t}\n\t\tthis.saveConfiguration(params);\n\t}\n\n\topenConfigDialog(type)\n\t{\n\t\tif(!this._configDialog)\n\t\t{\n\t\t\tthis._configDialog = WaitConfigurationDialog.create(\n\t\t\t\t\"\",\n\t\t\t\t{\n\t\t\t\t\ttargetDates: this._targetDates,\n\t\t\t\t\tonSave: BX.delegate(this.onConfigDialogSave, this),\n\t\t\t\t\tonCancel: BX.delegate(this.onConfigDialogCancel, this)\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\tthis._configDialog.setType(type);\n\t\tthis._configDialog.setDuration(this._duration);\n\n\t\tlet target = this._target;\n\t\tif(target === \"\" && this._targetDates.length > 0)\n\t\t{\n\t\t\ttarget = this._targetDates[0][\"name\"];\n\t\t}\n\t\tthis._configDialog.setTarget(target);\n\t\tthis._configDialog.open();\n\t}\n\n\tonConfigDialogSave(sender, params)\n\t{\n\t\tthis.saveConfiguration(params);\n\t\tthis._configDialog.close();\n\t}\n\n\tonConfigDialogCancel(sender)\n\t{\n\t\tthis._configDialog.close();\n\t}\n\n\tonMenuShow()\n\t{\n\t\tthis._isMenuShown = true;\n\t}\n\n\tonMenuClose()\n\t{\n\t\tif(this._menu && this._menu.popupWindow)\n\t\t{\n\t\t\tthis._menu.popupWindow.destroy();\n\t\t}\n\t}\n\n\tonMenuDestroy()\n\t{\n\t\tthis._isMenuShown = false;\n\t\tthis._menu = null;\n\n\t\tif(typeof(BX.PopupMenu.Data[this._id]) !== \"undefined\")\n\t\t{\n\t\t\tdelete(BX.PopupMenu.Data[this._id]);\n\t\t}\n\t}\n\n\tsaveConfiguration(params)\n\t{\n\t\t//region Parse params\n\t\tthis._type = BX.prop.getInteger(params, \"type\", Wait.WaitingType.after);\n\t\tthis._duration = BX.prop.getInteger(params, \"duration\", 0);\n\t\tif(this._duration <= 0)\n\t\t{\n\t\t\tthis._duration = 1;\n\t\t}\n\t\tthis._target = this._type === Wait.WaitingType.before\n\t\t\t? BX.prop.getString(params, \"target\", \"\") : \"\";\n\t\t//endregion\n\t\t//region Save settings\n\t\tconst optionName = this._manager.getId().toLowerCase();\n\t\tBX.userOptions.save(\n\t\t\t\"crm.timeline.wait\",\n\t\t\toptionName,\n\t\t\t\"type\",\n\t\t\tthis._type === Wait.WaitingType.after ? \"after\" : \"before\"\n\t\t);\n\n\t\tBX.userOptions.save(\n\t\t\t\"crm.timeline.wait\",\n\t\t\toptionName,\n\t\t\t\"duration\",\n\t\t\tthis._duration\n\t\t);\n\n\t\tBX.userOptions.save(\n\t\t\t\"crm.timeline.wait\",\n\t\t\toptionName,\n\t\t\t\"target\",\n\t\t\tthis._target\n\t\t);\n\t\t//endregion\n\t\tthis.layoutConfigurationSummary();\n\t}\n\n\tgetSummaryHtml()\n\t{\n\t\tif(this._type === Wait.WaitingType.before)\n\t\t{\n\t\t\treturn (\n\t\t\t\tthis.getMessage(\"completionTypeBefore\")\n\t\t\t\t\t.replace(\"#DURATION#\", this.getDurationText(this._duration, true))\n\t\t\t\t\t.replace(\"#TARGET_DATE#\", this.getTargetDateCaption(this._target))\n\t\t\t);\n\t\t}\n\n\t\treturn (\n\t\t\tthis.getMessage(\"completionTypeAfter\")\n\t\t\t\t.replace(\"#DURATION#\", this.getDurationText(this._duration, true))\n\t\t);\n\t}\n\n\tgetSummaryText()\n\t{\n\t\treturn BX.util.strip_tags(this.getSummaryHtml());\n\t}\n\n\tlayoutConfigurationSummary()\n\t{\n\t\tthis._configContainer.innerHTML = this.getSummaryHtml();\n\t\tthis._configSelector = this._configContainer.querySelector(\"a\");\n\t\tif(this._configSelector)\n\t\t{\n\t\t\tBX.bind(this._configSelector, \"click\", BX.delegate(this.onSelectorClick, this));\n\t\t}\n\t}\n\n\tpostpone(id, offset, callback)\n\t{\n\t\tBX.ajax(\n\t\t\t{\n\t\t\t\turl: this._serviceUrl,\n\t\t\t\tmethod: \"POST\",\n\t\t\t\tdataType: \"json\",\n\t\t\t\tdata:\n\t\t\t\t\t{\n\t\t\t\t\t\t\"ACTION\": \"POSTPONE_WAIT\",\n\t\t\t\t\t\t\"DATA\": { \"ID\": id, \"OFFSET\": offset }\n\t\t\t\t\t},\n\t\t\t\tonsuccess: callback\n\t\t\t}\n\t\t);\n\t}\n\n\tcomplete(id, completed, callback)\n\t{\n\t\tBX.ajax(\n\t\t\t{\n\t\t\t\turl: this._serviceUrl,\n\t\t\t\tmethod: \"POST\",\n\t\t\t\tdataType: \"json\",\n\t\t\t\tdata:\n\t\t\t\t\t{\n\t\t\t\t\t\t\"ACTION\": \"COMPLETE_WAIT\",\n\t\t\t\t\t\t\"DATA\": { \"ID\": id, \"COMPLETED\": completed ? 'Y' : 'N' }\n\t\t\t\t\t},\n\t\t\t\tonsuccess: callback\n\t\t\t}\n\t\t);\n\t}\n\n\tsave()\n\t{\n\t\tif(this._isRequestRunning || this._isLocked)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet description = this.getSummaryText();\n\t\tconst comment = BX.util.trim(this._input.value);\n\t\tif(comment !== \"\")\n\t\t{\n\t\t\tdescription += \"\\n\" + comment;\n\t\t}\n\n\t\tconst data =\n\t\t\t{\n\t\t\t\tID: 0,\n\t\t\t\ttypeId: this._type,\n\t\t\t\tduration: this._duration,\n\t\t\t\ttargetFieldName: this._target,\n\t\t\t\tsubject: \"\",\n\t\t\t\tdescription: description,\n\t\t\t\tcompleted: 0,\n\t\t\t\townerType: BX.CrmEntityType.resolveName(this._ownerTypeId),\n\t\t\t\townerID: this._ownerId\n\t\t\t};\n\n\t\tBX.ajax(\n\t\t\t{\n\t\t\t\turl: this._serviceUrl,\n\t\t\t\tmethod: \"POST\",\n\t\t\t\tdataType: \"json\",\n\t\t\t\tdata:\n\t\t\t\t\t{\n\t\t\t\t\t\t\"ACTION\": \"SAVE_WAIT\",\n\t\t\t\t\t\t\"DATA\": data\n\t\t\t\t\t},\n\t\t\t\tonsuccess: BX.delegate(this.onSaveSuccess, this),\n\t\t\t\tonfailure: BX.delegate(this.onSaveFailure, this)\n\t\t\t}\n\t\t);\n\t\tthis._isRequestRunning = this._isLocked = true;\n\t}\n\n\tcancel()\n\t{\n\t\tthis._input.value = \"\";\n\t\tthis._input.style.minHeight = \"\";\n\t\tthis.release();\n\t}\n\n\tonSaveSuccess(data)\n\t{\n\t\tthis._isRequestRunning = this._isLocked = false;\n\n\t\tconst error = BX.prop.getString(data, \"ERROR\", \"\");\n\t\tif(error !== \"\")\n\t\t{\n\t\t\talert(error);\n\t\t\treturn;\n\t\t}\n\n\t\tthis._input.value = \"\";\n\t\tthis._input.style.minHeight = \"\";\n\t\tthis._manager.processEditingCompletion(this);\n\t\tthis.release();\n\t}\n\n\tonSaveFailure()\n\t{\n\t\tthis._isRequestRunning = this._isLocked = false;\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = Wait.messages;\n\t\treturn m.hasOwnProperty(name) ? m[name] : name;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Wait();\n\t\tself.initialize(id, settings);\n\t\tthis.items[self.getId()] = self;\n\t\treturn self;\n\t}\n\n\tstatic WaitingType = {\n\t\tundefined: 0,\n\t\tafter: 1,\n\t\tbefore: 2,\n\n\t\tnames:\n\t\t\t{\n\t\t\t\tafter: \"after\",\n\t\t\t\tbefore: \"before\"\n\t\t\t},\n\t\tresolveTypeId: function(name)\n\t\t{\n\t\t\tif(name === this.names.after)\n\t\t\t{\n\t\t\t\treturn this.after;\n\t\t\t}\n\t\t\telse if(name === this.names.before)\n\t\t\t{\n\t\t\t\treturn this.before;\n\t\t\t}\n\n\t\t\treturn this.undefined;\n\t\t}\n\t};\n\n\tstatic messages = {};\n\tstatic items = {};\n\n\tstatic Helper =\n\t{\n\t\tgetDurationText: function(duration, enableNumber)\n\t\t{\n\t\t\tenableNumber = !!enableNumber;\n\n\t\t\tlet result = \"\";\n\t\t\tlet type = \"D\";\n\t\t\tif(enableNumber)\n\t\t\t{\n\t\t\t\tif((duration % 7) === 0)\n\t\t\t\t{\n\t\t\t\t\tduration = duration / 7;\n\t\t\t\t\ttype = \"W\";\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (type === \"W\")\n\t\t\t{\n\t\t\t\tresult = BX.Loc.getMessagePlural('CRM_TIMELINE_WAIT_WEEK', duration);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresult = BX.Loc.getMessagePlural('CRM_TIMELINE_WAIT_DAY', duration);\n\t\t\t}\n\n\t\t\tif(enableNumber)\n\t\t\t{\n\t\t\t\tresult = duration.toString() + \" \" + result;\n\t\t\t}\n\t\t\treturn result;\n\t\t},\n\t\tgetMessage: function(name)\n\t\t{\n\t\t\treturn Wait.Helper.messages.hasOwnProperty(name) ? Wait.Helper.messages[name] : name;\n\t\t},\n\t\tmessages: {},\n\t}\n}\n","import Editor from \"../editor\";\n\n/** @memberof BX.Crm.Timeline.Editors */\nexport default class Sms extends Editor\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._history = null;\n\t\tthis._serviceUrl = \"\";\n\n\t\tthis._isRequestRunning = false;\n\t\tthis._isLocked = false;\n\n\t\tthis._senderId = null;\n\t\tthis._from = null;\n\t\tthis._commEntityTypeId = null;\n\t\tthis._commEntityId = null;\n\t\tthis._to = null;\n\n\t\tthis._canUse = null;\n\t\tthis._canSendMessage = null;\n\t\tthis._manageUrl = '';\n\t\tthis._senders = [];\n\t\tthis._fromList = [];\n\t\tthis._toList = [];\n\t\tthis._defaults = {};\n\t\tthis._communications = [];\n\n\t\tthis._menu = null;\n\t\tthis._isMenuShown = false;\n\t\tthis._shownMenuId = null;\n\t\tthis._documentSelector = null;\n\t\tthis._source = null;\n\n\t\tthis._paymentId = null;\n\t\tthis._shipmentId = null;\n\n\t\tthis._compilationProductIds = [];\n\n\t\tthis._templateId = null;\n\t\tthis._templatesContainer = null;\n\t\tthis._templateFieldHintNode = null;\n\t\tthis._templateSelectorNode = null;\n\t\tthis._templateTemplateTitleNode = null;\n\t\tthis._templatePreviewNode = null;\n\t\tthis._templateSelectorMenuId = 'CrmTimelineSmsEditorTemplateSelector';\n\t\tthis._templateFieldHintHandler = BX.delegate(this.onTemplateHintIconClick, this);\n\t\tthis._templateSeletorClickHandler = BX.delegate(this.onTemplateSelectClick, this);\n\t\tthis._selectTemplateHandler = BX.delegate(this.onSelectTemplate, this);\n\t}\n\n\tdoInitialize()\n\t{\n\t\tthis._serviceUrl = BX.util.remove_url_param(\n\t\t\tthis.getSetting(\"serviceUrl\", \"\"),\n\t\t\t['sessid', 'site']\n\t\t);\n\n\t\tconst config = BX.prop.getObject(this._settings, \"config\", {});\n\n\t\tthis._canUse = BX.prop.getBoolean(config, \"canUse\", false);\n\t\tthis._canSendMessage = BX.prop.getBoolean(config, \"canSendMessage\", false);\n\t\tthis._manageUrl = BX.prop.getString(config, \"manageUrl\", '');\n\t\tthis._senders = BX.prop.getArray(config, \"senders\", []);\n\t\tthis._defaults = BX.prop.getObject(config, \"defaults\", {senderId:null,from:null});\n\t\tthis._communications = BX.prop.getArray(config, \"communications\", []);\n\t\tthis._isSalescenterEnabled = BX.prop.getBoolean(config, \"isSalescenterEnabled\", false);\n\t\tthis._isDocumentsEnabled = BX.prop.getBoolean(config, \"isDocumentsEnabled\", false);\n\t\tif(this._isDocumentsEnabled)\n\t\t{\n\t\t\tthis._documentsProvider = BX.prop.getString(config, \"documentsProvider\", '');\n\t\t\tthis._documentsValue = BX.prop.getString(config, \"documentsValue\", '');\n\t\t}\n\t\tthis._isFilesEnabled = BX.prop.getBoolean(config, \"isFilesEnabled\", false);\n\t\tif(this._isFilesEnabled)\n\t\t{\n\t\t\tthis._diskUrls = BX.prop.getObject(config, \"diskUrls\");\n\t\t\tthis._isFilesExternalLinkEnabled = BX.prop.getBoolean(config, \"isFilesExternalLinkEnabled\", true);\n\t\t}\n\n\t\tthis._senderSelectorNode = this._container.querySelector('[data-role=\"sender-selector\"]');\n\t\tthis._fromContainerNode = this._container.querySelector('[data-role=\"from-container\"]');\n\t\tthis._fromSelectorNode = this._container.querySelector('[data-role=\"from-selector\"]');\n\t\tthis._clientContainerNode = this._container.querySelector('[data-role=\"client-container\"]');\n\t\tthis._clientSelectorNode = this._container.querySelector('[data-role=\"client-selector\"]');\n\t\tthis._toSelectorNode = this._container.querySelector('[data-role=\"to-selector\"]');\n\t\tthis._messageLengthCounterWrapperNode = this._container.querySelector('[data-role=\"message-length-counter-wrap\"]');\n\t\tthis._messageLengthCounterNode = this._container.querySelector('[data-role=\"message-length-counter\"]');\n\t\tthis._salescenterStarter = this._container.querySelector('[data-role=\"salescenter-starter\"]');\n\t\tthis._smsDetailSwitcher = this._container.querySelector('[data-role=\"sms-detail-switcher\"]');\n\t\tthis._smsDetail = this._container.querySelector('[data-role=\"sms-detail\"]');\n\t\tthis._documentSelectorButton = this._container.querySelector('[data-role=\"sms-document-selector\"]');\n\t\tthis._fileSelectorButton = this._container.querySelector('[data-role=\"sms-file-selector\"]');\n\t\tthis._fileUploadZone = this._container.querySelector('[data-role=\"sms-file-upload-zone\"]');\n\t\tthis._fileUploadLabel = this._container.querySelector('[data-role=\"sms-file-upload-label\"]');\n\t\tthis._fileSelectorBitrix = this._container.querySelector('[data-role=\"sms-file-selector-bitrix\"]');\n\t\tthis._fileExternalLinkDisabledContent = this._container.querySelector('[data-role=\"sms-file-external-link-disabled\"]');\n\n\t\tthis._templatesContainer = BX(this.getSetting(\"templatesContainer\"));\n\t\tif (this._templatesContainer)\n\t\t{\n\t\t\tthis._templateFieldHintNode = this._templatesContainer.querySelector('[data-role=\"hint\"]');\n\t\t\tthis._templateSelectorNode = this._templatesContainer.querySelector('[data-role=\"template-selector\"]');\n\t\t\tthis._templateTemplateTitleNode = this._templatesContainer.querySelector('[data-role=\"template-title\"]');\n\t\t\tthis._templatePreviewNode = this._templatesContainer.querySelector('[data-role=\"preview\"]');\n\t\t}\n\t\tif (this._templateFieldHintNode)\n\t\t{\n\t\t\tBX.bind(this._templateFieldHintNode, \"click\", this._templateFieldHintHandler);\n\t\t}\n\t\tif (this._templateSelectorNode)\n\t\t{\n\t\t\tBX.bind(this._templateSelectorNode, \"click\", this._templateSeletorClickHandler);\n\t\t}\n\n\t\tif (this._canUse && this._senders.length > 0)\n\t\t{\n\t\t\tthis.initSenderSelector();\n\t\t}\n\t\tif (this._canUse && this._canSendMessage)\n\t\t{\n\t\t\tthis.initDetailSwitcher();\n\t\t\tthis.initFromSelector();\n\t\t\tthis.initClientContainer();\n\t\t\tthis.initClientSelector();\n\t\t\tthis.initToSelector();\n\t\t\tthis.initMessageLengthCounter();\n\t\t\tthis.setMessageLengthCounter();\n\t\t\tif(this._isDocumentsEnabled)\n\t\t\t{\n\t\t\t\tthis.initDocumentSelector();\n\t\t\t}\n\t\t\tif(this._isFilesEnabled)\n\t\t\t{\n\t\t\t\tthis.initFileSelector();\n\t\t\t}\n\t\t}\n\n\t\tif(this._isSalescenterEnabled)\n\t\t{\n\t\t\tthis.initSalescenterApplication();\n\t\t}\n\t}\n\n\tinitDetailSwitcher()\n\t{\n\t\tBX.bind(this._smsDetailSwitcher, 'click', function()\n\t\t{\n\t\t\tif(this._smsDetail.classList.contains('hidden'))\n\t\t\t{\n\t\t\t\tthis._smsDetail.classList.remove('hidden');\n\t\t\t\tthis._smsDetailSwitcher.innerText = BX.message('CRM_TIMELINE_COLLAPSE');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis._smsDetail.classList.add('hidden');\n\t\t\t\tthis._smsDetailSwitcher.innerText = BX.message('CRM_TIMELINE_DETAILS');\n\t\t\t}\n\t\t}.bind(this));\n\t}\n\n\tinitSenderSelector()\n\t{\n\t\tconst defaultSenderId = this._defaults.senderId;\n\t\tlet defaultSender = this._senders[0].canUse ? this._senders[0] : null;\n\t\tlet restSender = null;\n\t\tconst menuItems = [];\n\t\tconst handler = this.onSenderSelectorClick.bind(this);\n\n\t\tfor (let i = 0; i < this._senders.length; ++i)\n\t\t{\n\t\t\tif (this._senders[i].canUse && this._senders[i].fromList.length && (this._senders[i].id === defaultSenderId || !defaultSender))\n\t\t\t{\n\t\t\t\tdefaultSender = this._senders[i];\n\t\t\t}\n\n\t\t\tif (this._senders[i].id === 'rest')\n\t\t\t{\n\t\t\t\trestSender = this._senders[i];\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tmenuItems.push({\n\t\t\t\ttext: this._senders[i].name,\n\t\t\t\tsender: this._senders[i],\n\t\t\t\tonclick: handler,\n\t\t\t\tclassName: (!this._senders[i].canUse || !this._senders[i].fromList.length)\n\t\t\t\t\t? 'crm-timeline-popup-menu-item-disabled menu-popup-no-icon' : ''\n\t\t\t});\n\t\t}\n\n\t\tif (restSender)\n\t\t{\n\t\t\tif (restSender.fromList.length > 0)\n\t\t\t{\n\t\t\t\tmenuItems.push({delimiter: true});\n\t\t\t\tfor (let i = 0; i < restSender.fromList.length; ++i)\n\t\t\t\t{\n\t\t\t\t\tmenuItems.push({\n\t\t\t\t\t\ttext: restSender.fromList[i].name,\n\t\t\t\t\t\tsender: restSender,\n\t\t\t\t\t\tfrom: restSender.fromList[i],\n\t\t\t\t\t\tonclick: handler\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t\tmenuItems.push({delimiter: true}, {\n\t\t\t\ttext: BX.message('CRM_TIMELINE_SMS_REST_MARKETPLACE'),\n\t\t\t\thref: '/marketplace/category/crm_robot_sms/',\n\t\t\t\ttarget: '_blank'\n\t\t\t});\n\t\t}\n\n\t\tif (defaultSender)\n\t\t{\n\t\t\tthis.setSender(defaultSender);\n\t\t}\n\n\t\tBX.bind(this._senderSelectorNode, 'click', this.openMenu.bind(this, 'sender', this._senderSelectorNode, menuItems));\n\t}\n\n\tonSenderSelectorClick(e, item)\n\t{\n\t\tif (item.sender)\n\t\t{\n\t\t\tif (!item.sender.canUse || !item.sender.fromList.length)\n\t\t\t{\n\t\t\t\tconst url = BX.Uri.addParam(item.sender.manageUrl, {'IFRAME': 'Y'});\n\t\t\t\tconst slider = BX.SidePanel.Instance.getTopSlider();\n\t\t\t\tconst options = {\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tonClose: function () {\n\t\t\t\t\t\t\tif (slider)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tslider.reload();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonCloseComplete: function () {\n\t\t\t\t\t\t\tif (!slider)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tdocument.location.reload();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\tif (item.sender.id === 'ednaru')\n\t\t\t\t{\n\t\t\t\t\toptions.width = 700;\n\t\t\t\t}\n\t\t\t\tBX.SidePanel.Instance.open(url, options);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.setSender(item.sender, true);\n\t\t\tconst from = item.from ? item.from : item.sender.fromList[0];\n\t\t\tthis.setFrom(from, true);\n\t\t}\n\t\tthis._menu.close();\n\t}\n\n\tsetSender(sender, setAsDefault)\n\t{\n\t\tthis._senderId = sender.id;\n\t\tthis._fromList = sender.fromList;\n\t\tthis._senderSelectorNode.textContent = sender.shortName ? sender.shortName : sender.name;\n\n\t\tthis._templateId = null;\n\t\tif (sender.isTemplatesBased)\n\t\t{\n\t\t\tthis.showNode(this._templatesContainer);\n\t\t\tthis.hideNode(this._messageLengthCounterWrapperNode);\n\t\t\tthis.hideNode(this._fileSelectorButton);\n\t\t\tthis.hideNode(this._documentSelectorButton);\n\t\t\tthis.hideNode(this._input);\n\t\t\tthis.toggleTemplateSelectAvailability();\n\t\t\tthis.toggleSaveButton();\n\t\t\tthis._hideButtonsOnBlur = false;\n\t\t\tthis.onFocus();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.hideNode(this._templatesContainer);\n\t\t\tthis.showNode(this._messageLengthCounterWrapperNode);\n\t\t\tthis.showNode(this._fileSelectorButton);\n\t\t\tthis.showNode(this._documentSelectorButton);\n\t\t\tthis.showNode(this._input);\n\t\t\tthis.setMessageLengthCounter();\n\t\t\tthis._hideButtonsOnBlur = true;\n\t\t}\n\n\t\tconst visualFn = sender.id === 'rest' ? 'hide' : 'show';\n\t\tBX[visualFn](this._fromContainerNode);\n\n\t\tif (setAsDefault)\n\t\t{\n\t\t\tBX.userOptions.save(\"crm\", \"sms_manager_editor\", \"senderId\", this._senderId);\n\t\t}\n\t}\n\n\tshowNode(node)\n\t{\n\t\tif (node)\n\t\t{\n\t\t\tnode.style.display = \"\";\n\t\t}\n\t}\n\n\thideNode(node)\n\t{\n\t\tif (node)\n\t\t{\n\t\t\tnode.style.display = \"none\";\n\t\t}\n\t}\n\n\tinitFromSelector()\n\t{\n\t\tif (this._fromList.length > 0)\n\t\t{\n\t\t\tconst defaultFromId = this._defaults.from || this._fromList[0].id;\n\t\t\tlet defaultFrom = null;\n\t\t\tfor (let i = 0; i < this._fromList.length; ++i)\n\t\t\t{\n\t\t\t\tif (this._fromList[i].id === defaultFromId || !defaultFrom)\n\t\t\t\t{\n\t\t\t\t\tdefaultFrom = this._fromList[i];\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (defaultFrom)\n\t\t\t{\n\t\t\t\tthis.setFrom(defaultFrom);\n\t\t\t}\n\t\t}\n\n\t\tBX.bind(this._fromSelectorNode, 'click', this.onFromSelectorClick.bind(this));\n\t}\n\n\tonFromSelectorClick(e)\n\t{\n\t\tconst menuItems = [];\n\t\tconst handler = this.onFromSelectorItemClick.bind(this);\n\n\t\tfor (let i = 0; i < this._fromList.length; ++i)\n\t\t{\n\t\t\tmenuItems.push({\n\t\t\t\ttext: this._fromList[i].name,\n\t\t\t\tfrom: this._fromList[i],\n\t\t\t\tonclick: handler\n\t\t\t});\n\t\t}\n\n\t\tthis.openMenu('from_'+this._senderId, this._fromSelectorNode, menuItems, e);\n\t}\n\n\tonFromSelectorItemClick(e, item)\n\t{\n\t\tif (item.from)\n\t\t{\n\t\t\tthis.setFrom(item.from, true);\n\t\t}\n\t\tthis._menu.close();\n\t}\n\n\tsetFrom(from, setAsDefault)\n\t{\n\t\tthis._from = from.id;\n\n\t\tif (this._senderId === 'rest')\n\t\t{\n\t\t\tthis._senderSelectorNode.textContent = from.name;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis._fromSelectorNode.textContent = from.name;\n\t\t}\n\n\t\tif (setAsDefault)\n\t\t{\n\t\t\tBX.userOptions.save(\"crm\", \"sms_manager_editor\", \"from\", this._from);\n\t\t}\n\t}\n\n\tinitClientContainer()\n\t{\n\t\tif (this._communications.length === 0)\n\t\t{\n\t\t\tBX.hide(this._clientContainerNode);\n\t\t}\n\t}\n\n\tinitClientSelector()\n\t{\n\t\tconst menuItems = [];\n\t\tconst handler = this.onClientSelectorClick.bind(this);\n\n\t\tfor (let i = 0; i < this._communications.length; ++i)\n\t\t{\n\t\t\tmenuItems.push({\n\t\t\t\ttext: this._communications[i].caption,\n\t\t\t\tclient: this._communications[i],\n\t\t\t\tonclick: handler\n\t\t\t});\n\t\t\tif (i === 0)\n\t\t\t{\n\t\t\t\tthis.setClient(this._communications[i]);\n\t\t\t}\n\t\t}\n\n\t\tBX.bind(this._clientSelectorNode, 'click', this.openMenu.bind(this, 'comm', this._clientSelectorNode, menuItems));\n\t}\n\n\tonClientSelectorClick(e, item)\n\t{\n\t\tif (item.client)\n\t\t{\n\t\t\tthis.setClient(item.client);\n\t\t}\n\t\tthis._menu.close();\n\t}\n\n\tsetClient(client)\n\t{\n\t\tthis._commEntityTypeId = client.entityTypeId;\n\t\tthis._commEntityId = client.entityId;\n\t\tthis._clientSelectorNode.textContent = client.caption;\n\t\tthis._toList = client.phones;\n\t\tthis.setTo(client.phones[0]);\n\t}\n\n\tinitToSelector()\n\t{\n\t\tBX.bind(this._toSelectorNode, 'click', this.onToSelectorClick.bind(this));\n\t}\n\n\tonToSelectorClick(e)\n\t{\n\t\tconst menuItems = [];\n\t\tconst handler = this.onToSelectorItemClick.bind(this);\n\n\t\tfor (let i = 0; i < this._toList.length; ++i)\n\t\t{\n\t\t\tmenuItems.push({\n\t\t\t\ttext: this._toList[i].valueFormatted || this._toList[i].value,\n\t\t\t\tto: this._toList[i],\n\t\t\t\tonclick: handler\n\t\t\t});\n\t\t}\n\n\t\tthis.openMenu('to_'+this._commEntityTypeId+'_'+this._commEntityId, this._toSelectorNode, menuItems, e);\n\t}\n\n\tonToSelectorItemClick(e, item)\n\t{\n\t\tif (item.to)\n\t\t{\n\t\t\tthis.setTo(item.to);\n\t\t}\n\t\tthis._menu.close();\n\t}\n\n\tsetTo(to)\n\t{\n\t\tthis._to = to.value;\n\t\tthis._toSelectorNode.textContent = to.valueFormatted || to.value;\n\t}\n\n\topenMenu(menuId, bindElement, menuItems, e)\n\t{\n\t\tif (this._shownMenuId === menuId)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif(this._shownMenuId !== null && this._menu)\n\t\t{\n\t\t\tthis._menu.close();\n\t\t\tthis._shownMenuId = null;\n\t\t}\n\n\t\tBX.PopupMenu.show(\n\t\t\tthis._id + menuId,\n\t\t\tbindElement,\n\t\t\tmenuItems,\n\t\t\t{\n\t\t\t\toffsetTop: 0,\n\t\t\t\toffsetLeft: 36,\n\t\t\t\tangle: { position: \"top\", offset: 0 },\n\t\t\t\tevents:\n\t\t\t\t\t{\n\t\t\t\t\t\tonPopupClose: BX.delegate(this.onMenuClose, this)\n\t\t\t\t\t}\n\t\t\t}\n\t\t);\n\n\t\tthis._menu = BX.PopupMenu.currentItem;\n\t\te.preventDefault();\n\t}\n\n\tonMenuClose()\n\t{\n\t\tthis._shownMenuId = null;\n\t\tthis._menu = null;\n\t}\n\n\tinitMessageLengthCounter()\n\t{\n\t\tthis._messageLengthMax = parseInt(this._messageLengthCounterNode.getAttribute('data-length-max'));\n\t\tBX.bind(this._input, 'keyup', this.setMessageLengthCounter.bind(this));\n\t\tBX.bind(this._input, 'cut', this.setMessageLengthCounterDelayed.bind(this));\n\t\tBX.bind(this._input, 'paste', this.setMessageLengthCounterDelayed.bind(this));\n\t}\n\n\tsetMessageLengthCounterDelayed()\n\t{\n\t\tsetTimeout(this.setMessageLengthCounter.bind(this), 0);\n\t}\n\n\tsetMessageLengthCounter()\n\t{\n\t\tconst length = this._input.value.length;\n\t\tthis._messageLengthCounterNode.textContent = length;\n\n\t\tconst classFn = length >= this._messageLengthMax ? 'addClass' : 'removeClass';\n\t\tBX[classFn](this._messageLengthCounterNode, 'crm-entity-stream-content-sms-symbol-counter-number-overhead');\n\n\t\tthis.toggleSaveButton();\n\t}\n\n\ttoggleSaveButton()\n\t{\n\t\tconst sender = this.getSelectedSender();\n\t\tlet enabled;\n\t\tif (!sender || !sender.isTemplatesBased)\n\t\t{\n\t\t\tenabled = this._input.value.length > 0;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tenabled = !!this._templateId;\n\t\t}\n\t\tif (enabled)\n\t\t{\n\t\t\tBX.removeClass(this._saveButton, 'ui-btn-disabled');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tBX.addClass(this._saveButton, 'ui-btn-disabled');\n\t\t}\n\t}\n\n\tsave()\n\t{\n\t\tconst sender = this.getSelectedSender();\n\n\t\tlet text = '';\n\t\tlet templateId = '';\n\n\t\tif (!sender || !sender.isTemplatesBased)\n\t\t{\n\t\t\ttext = this._input.value;\n\t\t\tif (text === '')\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst template = this.getSelectedTemplate();\n\t\t\tif (!template)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\ttext = template.PREVIEW;\n\t\t\ttemplateId = template.ID;\n\t\t}\n\n\t\tif (!this._communications.length)\n\t\t{\n\t\t\talert(BX.message('CRM_TIMELINE_SMS_ERROR_NO_COMMUNICATIONS'));\n\t\t\treturn;\n\t\t}\n\n\t\tif(this._isRequestRunning || this._isLocked)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis._isRequestRunning = this._isLocked = true;\n\t\tBX.ajax(\n\t\t\t{\n\t\t\t\turl: BX.util.add_url_param(this._serviceUrl, {\n\t\t\t\t\t\"action\": \"save_sms_message\",\n\t\t\t\t\t\"sender\": this._senderId\n\t\t\t\t}),\n\t\t\t\tmethod: \"POST\",\n\t\t\t\tdataType: \"json\",\n\t\t\t\tdata:\n\t\t\t\t\t{\n\t\t\t\t\t\t'site': BX.message('SITE_ID'),\n\t\t\t\t\t\t'sessid': BX.bitrix_sessid(),\n\t\t\t\t\t\t'source': this._source,\n\t\t\t\t\t\t\"ACTION\": \"SAVE_SMS_MESSAGE\",\n\t\t\t\t\t\t\"SENDER_ID\": this._senderId,\n\t\t\t\t\t\t\"MESSAGE_FROM\": this._from,\n\t\t\t\t\t\t\"MESSAGE_TO\": this._to,\n\t\t\t\t\t\t\"MESSAGE_BODY\": text,\n\t\t\t\t\t\t\"MESSAGE_TEMPLATE\": templateId,\n\t\t\t\t\t\t\"OWNER_TYPE_ID\": this._ownerTypeId,\n\t\t\t\t\t\t\"OWNER_ID\": this._ownerId,\n\t\t\t\t\t\t\"TO_ENTITY_TYPE_ID\": this._commEntityTypeId,\n\t\t\t\t\t\t\"TO_ENTITY_ID\": this._commEntityId,\n\t\t\t\t\t\t\"PAYMENT_ID\": this._paymentId,\n\t\t\t\t\t\t\"SHIPMENT_ID\": this._shipmentId,\n\t\t\t\t\t\t\"COMPILATION_PRODUCT_IDS\": this._compilationProductIds,\n\t\t\t\t\t},\n\t\t\t\tonsuccess: BX.delegate(this.onSaveSuccess, this),\n\t\t\t\tonfailure: BX.delegate(this.onSaveFailure, this)\n\t\t\t}\n\t\t);\n\t}\n\n\tcancel()\n\t{\n\t\tthis._input.value = \"\";\n\t\tthis.setMessageLengthCounter();\n\t\tthis._input.style.minHeight = \"\";\n\t\tthis.release();\n\t}\n\n\tonSaveSuccess(data)\n\t{\n\t\tthis._isRequestRunning = this._isLocked = false;\n\n\t\tconst error = BX.prop.getString(data, \"ERROR\", \"\");\n\t\tif(error !== \"\")\n\t\t{\n\t\t\talert(error);\n\t\t\treturn;\n\t\t}\n\n\t\tthis._input.value = \"\";\n\t\tthis.setMessageLengthCounter();\n\t\tthis._input.style.minHeight = \"\";\n\t\tthis._manager.processEditingCompletion(this);\n\t\tthis.release();\n\t}\n\n\tonSaveFailure()\n\t{\n\t\tthis._isRequestRunning = this._isLocked = false;\n\t}\n\n\tinitSalescenterApplication()\n\t{\n\t\tBX.bind(this._salescenterStarter, 'click', this.startSalescenterApplication.bind(this));\n\t}\n\n\tstartSalescenterApplication()\n\t{\n\t\tBX.loadExt('salescenter.manager').then(function()\n\t\t{\n\t\t\tBX.Salescenter.Manager.openApplication({\n\t\t\t\tdisableSendButton: this._canSendMessage ? '' : 'y',\n\t\t\t\tcontext: 'sms',\n\t\t\t\townerTypeId: this._ownerTypeId,\n\t\t\t\townerId: this._ownerId,\n\t\t\t\tmode: this._ownerTypeId === BX.CrmEntityType.enumeration.deal ? 'payment_delivery' : 'payment',\n\t\t\t}).then(function(result)\n\t\t\t{\n\t\t\t\tif(result && result.get('action'))\n\t\t\t\t{\n\t\t\t\t\tif(result.get('action') === 'sendPage' && result.get('page') && result.get('page').url)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis._input.focus();\n\t\t\t\t\t\tthis._input.value = this._input.value + result.get('page').name + ' ' + result.get('page').url;\n\t\t\t\t\t\tthis.setMessageLengthCounter();\n\t\t\t\t\t}\n\t\t\t\t\telse if (result.get('action') === 'sendPayment' && result.get('order'))\n\t\t\t\t\t{\n\t\t\t\t\t\tthis._input.focus();\n\t\t\t\t\t\tthis._input.value = this._input.value + result.get('order').title;\n\t\t\t\t\t\tthis.setMessageLengthCounter();\n\t\t\t\t\t\tthis._source = 'order';\n\t\t\t\t\t\tthis._paymentId = result.get('order').paymentId;\n\t\t\t\t\t\tthis._shipmentId = result.get('order').shipmentId;\n\t\t\t\t\t}\n\t\t\t\t\telse if(result.get('action') === 'sendCompilation' && result.get('compilation'))\n\t\t\t\t\t{\n\t\t\t\t\t\tthis._input.focus();\n\t\t\t\t\t\tthis._input.value = this._input.value + result.get('compilation').title;\n\t\t\t\t\t\tthis.setMessageLengthCounter();\n\t\t\t\t\t\tthis._source = 'deal';\n\t\t\t\t\t\tthis._compilationProductIds = result.get('compilation').productIds;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}.bind(this));\n\t\t}.bind(this));\n\t}\n\n\tinitDocumentSelector()\n\t{\n\t\tBX.bind(this._documentSelectorButton, 'click', this.onDocumentSelectorClick.bind(this));\n\t}\n\n\tonDocumentSelectorClick()\n\t{\n\t\tif(!this._documentSelector)\n\t\t{\n\t\t\tBX.loadExt('documentgenerator.selector').then(function()\n\t\t\t{\n\t\t\t\tthis._documentSelector = new BX.DocumentGenerator.Selector.Menu({\n\t\t\t\t\tnode: this._documentSelectorButton,\n\t\t\t\t\tmoduleId: 'crm',\n\t\t\t\t\tprovider: this._documentsProvider,\n\t\t\t\t\tvalue: this._documentsValue,\n\t\t\t\t\tanalyticsLabelPrefix: 'crmTimelineSmsEditor'\n\t\t\t\t});\n\t\t\t\tthis.selectPublicUrl();\n\t\t\t}.bind(this));\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.selectPublicUrl();\n\t\t}\n\t}\n\n\tselectPublicUrl()\n\t{\n\t\tif(!this._documentSelector)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tthis._documentSelector.show().then(function(object)\n\t\t{\n\t\t\tif(object instanceof BX.DocumentGenerator.Selector.Template)\n\t\t\t{\n\t\t\t\tthis._documentSelector.createDocument(object).then(function(document)\n\t\t\t\t{\n\t\t\t\t\tthis.pasteDocumentUrl(document);\n\t\t\t\t}.bind(this)).catch(function(error)\n\t\t\t\t{\n\t\t\t\t\tconsole.error(error);\n\t\t\t\t}.bind(this));\n\t\t\t}\n\t\t\telse if(object instanceof BX.DocumentGenerator.Selector.Document)\n\t\t\t{\n\t\t\t\tthis.pasteDocumentUrl(object);\n\t\t\t}\n\t\t}.bind(this)).catch(function(error)\n\t\t{\n\t\t\tconsole.error(error);\n\t\t}.bind(this));\n\t}\n\n\tpasteDocumentUrl(document)\n\t{\n\t\tthis._documentSelector.getDocumentPublicUrl(document).then(function(publicUrl)\n\t\t{\n\t\t\tthis._input.focus();\n\t\t\tthis._input.value = this._input.value + ' ' + document.getTitle() + ' ' + publicUrl;\n\t\t\tthis.setMessageLengthCounter();\n\t\t\tthis._source = 'document';\n\t\t}.bind(this)).catch(function(error)\n\t\t{\n\t\t\tconsole.error(error);\n\t\t}.bind(this));\n\t}\n\n\tinitFileSelector()\n\t{\n\t\tBX.bind(this._fileSelectorButton, 'click', this.onFileSelectorClick.bind(this));\n\t}\n\n\tcloseFileSelector()\n\t{\n\t\tBX.PopupMenu.destroy('sms-file-selector');\n\t}\n\n\tonFileSelectorClick()\n\t{\n\t\tBX.PopupMenu.show('sms-file-selector', this._fileSelectorButton, [\n\t\t\t{\n\t\t\t\ttext: BX.message('CRM_TIMELINE_SMS_UPLOAD_FILE'),\n\t\t\t\tonclick: this.uploadFile.bind(this),\n\t\t\t\tclassName: this._isFilesExternalLinkEnabled ? '' : 'crm-entity-stream-content-sms-menu-item-with-lock'\n\t\t\t},\n\t\t\t{\n\t\t\t\ttext: BX.message('CRM_TIMELINE_SMS_FIND_FILE'),\n\t\t\t\tonclick: this.findFile.bind(this),\n\t\t\t\tclassName: this._isFilesExternalLinkEnabled ? '' : 'crm-entity-stream-content-sms-menu-item-with-lock'\n\t\t\t}\n\t\t])\n\t}\n\n\tgetFileUploadInput()\n\t{\n\t\treturn document.getElementById(this._fileUploadLabel.getAttribute('for'));\n\t}\n\n\tuploadFile()\n\t{\n\t\tthis.closeFileSelector();\n\t\tif(this._isFilesExternalLinkEnabled)\n\t\t{\n\t\t\tthis.initDiskUF();\n\t\t\tBX.fireEvent(this.getFileUploadInput(), 'click');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.showFilesExternalLinkFeaturePopup();\n\t\t}\n\t}\n\n\tfindFile()\n\t{\n\t\tthis.closeFileSelector();\n\t\tif(this._isFilesExternalLinkEnabled)\n\t\t{\n\t\t\tthis.initDiskUF();\n\t\t\tBX.fireEvent(this._fileSelectorBitrix, 'click');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.showFilesExternalLinkFeaturePopup();\n\t\t}\n\t}\n\n\tgetLoader()\n\t{\n\t\tif(!this.loader)\n\t\t{\n\t\t\tthis.loader = new BX.Loader(\n\t\t\t\t{\n\t\t\t\t\tsize: 50\n\t\t\t\t});\n\t\t}\n\n\t\treturn this.loader;\n\t}\n\n\tshowLoader(node)\n\t{\n\t\tif(node && !this.getLoader().isShown())\n\t\t{\n\t\t\tthis.getLoader().show(node);\n\t\t}\n\t}\n\n\thideLoader()\n\t{\n\t\tif(this.getLoader().isShown())\n\t\t{\n\t\t\tthis.getLoader().hide();\n\t\t}\n\t}\n\n\tinitDiskUF()\n\t{\n\t\tif(this.isDiskFileUploaderInited || !this._isFilesEnabled)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tthis.isDiskFileUploaderInited = true;\n\t\tBX.addCustomEvent(this._fileUploadZone, 'OnFileUploadSuccess', this.OnFileUploadSuccess.bind(this));\n\t\tBX.addCustomEvent(this._fileUploadZone, 'DiskDLoadFormControllerInit', function(uf)\n\t\t{\n\t\t\tuf._onUploadProgress = function()\n\t\t\t{\n\t\t\t\tthis.showLoader(this._fileSelectorButton.parentNode.parentNode);\n\t\t\t}.bind(this);\n\t\t}.bind(this));\n\n\t\tBX.Disk.UF.add({\n\t\t\tUID: this._fileUploadZone.getAttribute('data-node-id'),\n\t\t\tcontrolName: this._fileUploadLabel.getAttribute('for'),\n\t\t\thideSelectDialog: false,\n\t\t\turlSelect: this._diskUrls.urlSelect,\n\t\t\turlRenameFile: this._diskUrls.urlRenameFile,\n\t\t\turlDeleteFile: this._diskUrls.urlDeleteFile,\n\t\t\turlUpload: this._diskUrls.urlUpload\n\t\t});\n\n\t\tBX.onCustomEvent(\n\t\t\tthis._fileUploadZone,\n\t\t\t'DiskLoadFormController',\n\t\t\t['show']\n\t\t);\n\t}\n\n\tOnFileUploadSuccess(fileResult, uf, file, uploaderFile)\n\t{\n\t\tthis.hideLoader();\n\t\tconst diskFileId = parseInt(fileResult.element_id.replace('n', ''));\n\t\tconst fileName = fileResult.element_name;\n\t\tthis.pasteFileUrl(diskFileId, fileName);\n\t}\n\n\tpasteFileUrl(diskFileId, fileName)\n\t{\n\t\tthis.showLoader(this._fileSelectorButton.parentNode.parentNode);\n\t\tBX.ajax.runAction('disk.file.generateExternalLink', {\n\t\t\tanalyticsLabel: 'crmTimelineSmsEditorGetFilePublicUrl',\n\t\t\tdata: {\n\t\t\t\tfileId: diskFileId\n\t\t\t}\n\t\t}).then(function(response)\n\t\t{\n\t\t\tthis.hideLoader();\n\t\t\tif(response.data.externalLink && response.data.externalLink.link)\n\t\t\t{\n\t\t\t\tthis._input.focus();\n\t\t\t\tthis._input.value = this._input.value + ' ' + fileName + ' ' + response.data.externalLink.link;\n\t\t\t\tthis.setMessageLengthCounter();\n\t\t\t\tthis._source = 'file';\n\t\t\t}\n\t\t}.bind(this)).catch(function(response)\n\t\t{\n\t\t\tconsole.error(response.errors.pop().message);\n\t\t});\n\t}\n\n\tgetFeaturePopup(content)\n\t{\n\t\tif(this.featurePopup != null)\n\t\t{\n\t\t\treturn this.featurePopup;\n\t\t}\n\t\tthis.featurePopup = new BX.PopupWindow('bx-popup-crm-sms-editor-feature-popup', null, {\n\t\t\tzIndex: 200,\n\t\t\tautoHide: true,\n\t\t\tcloseByEsc: true,\n\t\t\tcloseIcon: true,\n\t\t\toverlay : true,\n\t\t\tevents : {\n\t\t\t\tonPopupDestroy : function()\n\t\t\t\t{\n\t\t\t\t\tthis.featurePopup = null;\n\t\t\t\t}.bind(this)\n\t\t\t},\n\t\t\tcontent : content,\n\t\t\tcontentColor: 'white'\n\t\t});\n\n\t\treturn this.featurePopup;\n\t}\n\n\tshowFilesExternalLinkFeaturePopup()\n\t{\n\t\tthis.getFeaturePopup(this._fileExternalLinkDisabledContent).show();\n\t}\n\n\tonTemplateHintIconClick()\n\t{\n\t\tif (this._senderId === 'ednaru')\n\t\t{\n\t\t\ttop.BX.Helper.show(\"redirect=detail&code=14214014\");\n\t\t}\n\t}\n\n\tshowTemplateSelectDropdown(items)\n\t{\n\t\tconst menuItems = [];\n\t\tif (BX.Type.isArray(items))\n\t\t{\n\t\t\tif (items.length)\n\t\t\t{\n\t\t\t\titems.forEach(function(item)\n\t\t\t\t{\n\t\t\t\t\tmenuItems.push({\n\t\t\t\t\t\tvalue: item.ID,\n\t\t\t\t\t\ttext: item.TITLE,\n\t\t\t\t\t\tonclick: this._selectTemplateHandler\n\t\t\t\t\t})\n\t\t\t\t}.bind(this));\n\n\t\t\t\tBX.PopupMenu.show({\n\t\t\t\t\tid: this._templateSelectorMenuId,\n\t\t\t\t\tbindElement: this._templateSelectorNode,\n\t\t\t\t\titems: menuItems,\n\t\t\t\t\tangle: false,\n\t\t\t\t\twidth: this._templateSelectorNode.offsetWidth,\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\telse if (this._senderId)\n\t\t{\n\t\t\tconst loaderMenuId = this._templateSelectorMenuId + 'loader';\n\t\t\tconst loaderMenuLoaderId = this._templateSelectorMenuId + 'loader';\n\n\t\t\tBX.PopupMenu.show({\n\t\t\t\tid: loaderMenuId,\n\t\t\t\tbindElement: this._templateSelectorNode,\n\t\t\t\titems: [{\n\t\t\t\t\thtml: '<div id=\"' + loaderMenuLoaderId + '\"></div>',\n\t\t\t\t}],\n\t\t\t\tangle: false,\n\t\t\t\twidth: this._templateSelectorNode.offsetWidth,\n\t\t\t\theight: 60,\n\t\t\t\tevents: {\n\t\t\t\t\tonDestroy: function() {\n\t\t\t\t\t\tthis.hideLoader();\n\t\t\t\t\t}.bind(this)\n\t\t\t\t}\n\t\t\t});\n\t\t\tthis.showLoader(BX(loaderMenuLoaderId));\n\n\t\t\tif (!this._isRequestRunning)\n\t\t\t{\n\t\t\t\tthis._isRequestRunning = true;\n\t\t\t\tconst senderId = this._senderId;\n\t\t\t\tBX.ajax.runAction(\n\t\t\t\t\t'messageservice.Sender.getTemplates',\n\t\t\t\t\t{\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\tid: senderId,\n\t\t\t\t\t\t\tcontext: {\n\t\t\t\t\t\t\t\tmodule: 'crm',\n\t\t\t\t\t\t\t\tentityTypeId: this._manager._ownerTypeId,\n\t\t\t\t\t\t\t\tentityId: this._manager._ownerId,\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t\t\t.then(function(response)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis._isRequestRunning = false;\n\t\t\t\t\t\tconst sender = this._senders.find(function (sender) {\n\t\t\t\t\t\t\treturn (sender.id === senderId);\n\t\t\t\t\t\t}.bind(this));\n\n\t\t\t\t\t\tif (sender)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tsender.templates = response.data.templates;\n\t\t\t\t\t\t\tthis.toggleTemplateSelectAvailability();\n\t\t\t\t\t\t\tif (BX.PopupMenu.getMenuById(loaderMenuId))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tBX.PopupMenu.getMenuById(loaderMenuId).close();\n\t\t\t\t\t\t\t\tthis.showTemplateSelectDropdown(sender.templates);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}.bind(this))\n\t\t\t\t\t.catch(function(response)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis._isRequestRunning = false;\n\t\t\t\t\t\tif (BX.PopupMenu.getMenuById(loaderMenuId))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (response && response.errors && response.errors[0] && response.errors[0].message)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\talert(response.errors[0].message);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tBX.PopupMenu.getMenuById(loaderMenuId).close();\n\t\t\t\t\t\t}\n\t\t\t\t\t}.bind(this))\n\t\t\t\t;\n\t\t\t}\n\t\t}\n\n\t}\n\n\tgetSelectedSender()\n\t{\n\t\treturn this._senders.find(function(sender) {\n\t\t\treturn (sender.id === this._senderId);\n\t\t}.bind(this));\n\t}\n\n\tgetSelectedTemplate()\n\t{\n\t\tconst sender = this.getSelectedSender();\n\t\tif (!this._templateId || !sender || !sender.templates)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst template = sender.templates.find(function (template) {\n\t\t\treturn template.ID == this._templateId;\n\t\t}.bind(this));\n\n\t\treturn template ? template : null;\n\t}\n\n\tonTemplateSelectClick()\n\t{\n\t\tconst sender = this.getSelectedSender();\n\n\t\tif (sender)\n\t\t{\n\t\t\tthis.showTemplateSelectDropdown(sender.templates);\n\t\t}\n\t}\n\n\tonSelectTemplate(e, item)\n\t{\n\t\tthis._templateId = item.value;\n\t\tthis.applySelectedTemplate();\n\t\tthis.toggleSaveButton();\n\t\tconst menu = BX.PopupMenu.getMenuById(this._templateSelectorMenuId);\n\t\tif (menu)\n\t\t{\n\t\t\tmenu.close();\n\t\t}\n\t}\n\n\ttoggleTemplateSelectAvailability()\n\t{\n\t\tconst sender = this.getSelectedSender();\n\t\tif (sender && BX.Type.isArray(sender.templates) && !sender.templates.length)\n\t\t{\n\t\t\tBX.addClass(this._templateSelectorNode, 'ui-ctl-disabled');\n\t\t\tthis._templateTemplateTitleNode.textContent = BX.message('CRM_TIMELINE_SMS_TEMPLATES_NOT_FOUND');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tBX.removeClass(this._templateSelectorNode, 'ui-ctl-disabled');\n\t\t\tthis.applySelectedTemplate();\n\t\t}\n\t}\n\n\tapplySelectedTemplate()\n\t{\n\t\tconst sender = this.getSelectedSender();\n\t\tif (!this._templateId || !sender || !sender.templates)\n\t\t{\n\t\t\tthis.hideNode(this._templatePreviewNode);\n\t\t\tthis._templateTemplateTitleNode.textContent = '';\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst template = this.getSelectedTemplate();\n\t\t\tif (template)\n\t\t\t{\n\t\t\t\tconst preview = BX.Text.encode(template.PREVIEW).replace(/\\n/g, '<br>');\n\n\t\t\t\tthis.showNode(this._templatePreviewNode);\n\t\t\t\tthis._templatePreviewNode.innerHTML = preview;\n\t\t\t\tthis._templateTemplateTitleNode.textContent = template.TITLE;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.hideNode(this._templatePreviewNode);\n\t\t\t\tthis._templateTemplateTitleNode.textContent = '';\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Sms();\n\t\tself.initialize(id, settings);\n\t\tSms.items[self.getId()] = self;\n\t\treturn self;\n\t}\n\n\tstatic items = {};\n}\n","import Editor from \"../editor\";\n\n/** @memberof BX.Crm.Timeline.Editors */\nexport default class Rest extends Editor\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._interfaceInitialized = false;\n\t}\n\n\taction(action)\n\t{\n\t\tif(!this._interfaceInitialized)\n\t\t{\n\t\t\tthis._interfaceInitialized = true;\n\t\t\tthis.initializeInterface();\n\t\t}\n\n\t\tif(action === 'activity_rest_applist')\n\t\t{\n\t\t\tBX.rest.Marketplace.open({\n\t\t\t\tPLACEMENT: this.getSetting(\"placement\", '')\n\t\t\t});\n\n\t\t\ttop.BX.addCustomEvent(top, 'Rest:AppLayout:ApplicationInstall', BX.proxy(this.fireUpdateEvent, this));\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst appId = action.replace('activity_rest_', '');\n\t\t\tconst appData = appId.split('_');\n\n\t\t\tBX.rest.AppLayout.openApplication(\n\t\t\t\tappData[0],\n\t\t\t\t{\n\t\t\t\t\tID: this._ownerId\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tPLACEMENT: this.getSetting(\"placement\", ''),\n\t\t\t\t\tPLACEMENT_ID: appData[1]\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t}\n\n\tinitializeInterface()\n\t{\n\t\tif(!!top.BX.rest && !!top.BX.rest.AppLayout)\n\t\t{\n\t\t\tconst entityTypeId = this._manager._ownerTypeId, entityId = this._manager._ownerId;\n\n\t\t\tconst PlacementInterface = top.BX.rest.AppLayout.initializePlacement(this.getSetting(\"placement\", ''));\n\n\t\t\tPlacementInterface.prototype.reloadData = function(params, cb)\n\t\t\t{\n\t\t\t\tBX.Crm.EntityEvent.fireUpdate(entityTypeId, entityId, '');\n\t\t\t\tcb();\n\t\t\t};\n\t\t}\n\t}\n\n\tfireUpdateEvent()\n\t{\n\t\tconst entityTypeId = this._manager._ownerTypeId, entityId = this._manager._ownerId;\n\t\tsetTimeout(function(){\n\t\t\tconsole.log('fireUpdate', entityId, entityTypeId);\n\t\t\tBX.Crm.EntityEvent.fire(BX.Crm.EntityEvent.names.invalidate, entityTypeId, entityId, '');\n\t\t}, 3000);\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Rest();\n\t\tself.initialize(id, settings);\n\t\tRest.items[self.getId()] = self;\n\t\treturn self;\n\t}\n\n\tstatic items = {};\n}\n","import Editor from \"../editor\";\n\n/** @memberof BX.Crm.Timeline.Editors */\nexport default class Comment extends Editor\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._history = null;\n\t\tthis._serviceUrl = \"\";\n\t\tthis._postForm = null;\n\t\tthis._editor = null;\n\t\tthis._isRequestRunning = false;\n\t\tthis._isLocked = false;\n\t}\n\n\tdoInitialize()\n\t{\n\t\tthis._serviceUrl = this.getSetting(\"serviceUrl\", \"\");\n\t\tBX.unbind(this._input, \"blur\", this._blurHandler);\n\t\tBX.unbind(this._input, \"keyup\", this._keyupHandler);\n\t}\n\n\tloadEditor()\n\t{\n\t\tthis._editorName = 'CrmTimeLineComment0';\n\n\t\tif (this._postForm)\n\t\t\treturn;\n\n\t\tBX.ajax.runAction(\n\t\t\t\"crm.api.timeline.loadEditor\",\n\t\t\t{ data: { name: this._editorName } }\n\t\t).then(this.onLoadEditorSuccess.bind(this));\n\t}\n\n\tonLoadEditorSuccess(result)\n\t{\n\t\tconst html = BX.prop.getString(BX.prop.getObject(result, \"data\", {}), \"html\", '');\n\t\tBX.html(this._editorContainer, html)\n\t\t\t.then(BX.delegate(this.showEditor,this))\n\t\t\t.then(BX.delegate(this.addEvents,this));\n\t}\n\n\taddEvents()\n\t{\n\t\tBX.addCustomEvent(\n\t\t\tthis._editorContainer.firstElementChild,\n\t\t\t'onFileIsAppended',\n\t\t\tBX.delegate(function(id, item) {\n\t\t\t\tBX.addClass(this._saveButton, 'ui-btn-disabled');\n\t\t\t\tBX.addClass(this._saveButton, 'ui-btn-clock');\n\t\t\t\tthis._saveButton.removeEventListener(\"click\", this._saveButtonHandler);\n\t\t\t}, this)\n\t\t);\n\n\t\tBX.addCustomEvent(\n\t\t\tthis._editorContainer.firstElementChild,\n\t\t\t'onFileIsAdded',\n\t\t\tBX.delegate(function(file, controller, obj, blob) {\n\t\t\t\tBX.removeClass(this._saveButton, 'ui-btn-clock');\n\t\t\t\tBX.removeClass(this._saveButton, 'ui-btn-disabled');\n\t\t\t\tthis._saveButton.addEventListener(\"click\", this._saveButtonHandler);\n\t\t\t}, this)\n\t\t);\n\t}\n\n\tshowEditor()\n\t{\n\t\tif (LHEPostForm)\n\t\t{\n\t\t\twindow.setTimeout(BX.delegate(function(){\n\t\t\t\tthis._postForm = LHEPostForm.getHandler(this._editorName);\n\t\t\t\tthis._editor = BXHtmlEditor.Get(this._editorName);\n\t\t\t\tBX.onCustomEvent(this._postForm.eventNode, 'OnShowLHE', [true]);\n\t\t\t} ,this), 100);\n\t\t}\n\t}\n\n\tgetHistory()\n\t{\n\t\treturn this._history;\n\t}\n\n\tsetHistory(history)\n\t{\n\t\tthis._history = history;\n\t}\n\n\tonFocus(e)\n\t{\n\t\tthis._input.style.display = 'none';\n\t\tif (this._editor && this._postForm)\n\t\t{\n\t\t\tthis._postForm.eventNode.style.display = 'block';\n\t\t\tthis._editor.Focus();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (!BX.type.isDomNode(this._editorContainer))\n\t\t\t{\n\t\t\t\tthis._editorContainer = BX.create(\"div\", {attrs: {className: \"crm-entity-stream-section-comment-editor\"}});\n\t\t\t\tthis._editorContainer.appendChild(\n\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tattrs: { className: \"crm-timeline-wait\" }\n\t\t\t\t\t\t})\n\t\t\t\t);\n\t\t\t\tthis._container.appendChild(this._editorContainer);\n\t\t\t}\n\n\t\t\twindow.setTimeout(BX.delegate(function(){\n\t\t\t\tthis.loadEditor();\n\t\t\t} ,this), 100);\n\t\t}\n\n\t\tBX.addClass(this._container, \"focus\");\n\t}\n\n\tsave()\n\t{\n\t\tlet text = \"\";\n\t\tconst attachmentList = [];\n\t\tif (this._postForm)\n\t\t{\n\t\t\ttext = this._postForm.oEditor.GetContent();\n\t\t\tthis._postForm.eventNode\n\t\t\t\t.querySelectorAll('input[name=\"UF_CRM_COMMENT_FILES[]\"]')\n\t\t\t\t.forEach(function(input) {\n\t\t\t\t\tattachmentList.push(input.value)\n\t\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\ttext = this._input.value;\n\t\t}\n\n\t\tif(text === \"\")\n\t\t{\n\t\t\tif (!this.emptyCommentMessage)\n\t\t\t{\n\t\t\t\tthis.emptyCommentMessage = new BX.PopupWindow(\n\t\t\t\t\t'timeline_empty_new_comment_' + this._ownerId,\n\t\t\t\t\tthis._saveButton,\n\t\t\t\t\t{\n\t\t\t\t\t\tcontent: BX.message('CRM_TIMELINE_EMPTY_COMMENT_MESSAGE'),\n\t\t\t\t\t\tdarkMode: true,\n\t\t\t\t\t\tautoHide: true,\n\t\t\t\t\t\tzIndex: 990,\n\t\t\t\t\t\tangle: {position: 'top', offset: 77},\n\t\t\t\t\t\tcloseByEsc: true,\n\t\t\t\t\t\tbindOptions: { forceBindPosition: true}\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tthis.emptyCommentMessage.show();\n\t\t\treturn;\n\t\t}\n\n\t\tif(this._isRequestRunning || this._isLocked)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis._isRequestRunning = this._isLocked = true;\n\t\tBX.ajax(\n\t\t\t{\n\t\t\t\turl: this._serviceUrl,\n\t\t\t\tmethod: \"POST\",\n\t\t\t\tdataType: \"json\",\n\t\t\t\tdata:\n\t\t\t\t\t{\n\t\t\t\t\t\t\"ACTION\": \"SAVE_COMMENT\",\n\t\t\t\t\t\t\"TEXT\": text,\n\t\t\t\t\t\t\"OWNER_TYPE_ID\": this._ownerTypeId,\n\t\t\t\t\t\t\"OWNER_ID\": this._ownerId,\n\t\t\t\t\t\t\"ATTACHMENTS\": attachmentList\n\t\t\t\t\t},\n\t\t\t\tonsuccess: BX.delegate(this.onSaveSuccess, this),\n\t\t\t\tonfailure: BX.delegate(this.onSaveFailure, this)\n\t\t\t}\n\t\t);\n\t}\n\n\tcancel()\n\t{\n\t\tthis._input.value = \"\";\n\t\tthis._input.style.minHeight = \"\";\n\t\tif (BX.type.isDomNode(this._editorContainer))\n\t\t\tthis._postForm.eventNode.style.display = 'none';\n\n\t\tthis._input.style.display = 'block';\n\t\tBX.removeClass(this._container, \"focus\");\n\t\tthis.release();\n\t}\n\n\tonSaveSuccess(data)\n\t{\n\t\tthis._isRequestRunning = false;\n\t\tif (this._postForm)\n\t\t{\n\t\t\tthis._postForm.reinit('', {});\n\t\t}\n\n\t\tthis.cancel();\n\t\tconst itemData = BX.prop.getObject(data, \"HISTORY_ITEM\");\n\t\tconst historyItem = this._history.createItem(itemData);\n\t\tthis._history.addItem(historyItem, 0);\n\n\t\tconst anchor = this._history.createAnchor();\n\t\thistoryItem.layout({ anchor: anchor });\n\n\t\tconst move = BX.CrmCommentAnimation.create(\n\t\t\thistoryItem.getWrapper(),\n\t\t\tanchor,\n\t\t\tBX.pos(this._input),\n\t\t\t{\n\t\t\t\tstart: BX.delegate(this.onAnimationStart, this),\n\t\t\t\tcomplete: BX.delegate(this.onAnimationComplete, this)\n\t\t\t}\n\t\t);\n\t\tmove.run();\n\t}\n\n\tonSaveFailure()\n\t{\n\t\tthis._isRequestRunning = this._isLocked = false;\n\t}\n\n\tonAnimationStart()\n\t{\n\t\tthis._input.value = \"\";\n\t}\n\n\tonAnimationComplete()\n\t{\n\t\tthis._isLocked = false;\n\t\tBX.removeClass(this._container, \"focus\");\n\n\t\tthis._input.style.minHeight = \"\";\n\t\tthis._manager.processEditingCompletion(this);\n\n\t\tthis.release();\n\n\t\tthis._history._anchor = null;\n\t\tthis._history.refreshLayout();\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Comment();\n\t\tself.initialize(id, settings);\n\t\tComment.items[self.getId()] = self;\n\t\treturn self;\n\t}\n\n\tstatic items = {};\n}\n","import Editor from \"../editor.js\";\nimport {Dom, Type} from \"main.core\";\nimport {TodoEditor} from \"crm.activity.todo-editor\";\nimport {BaseEvent} from \"main.core.events\";\n\n/** @memberof BX.Crm.Timeline.Editors */\nexport default class ToDo extends Editor\n{\n\t#toDoEditor = null;\n\n\tinitialize(id, settings): void\n\t{\n\t\tsuper.initialize(id, settings);\n\t\tthis.#createEditor();\n\t}\n\n\t#createEditor(): void\n\t{\n\t\tconst editorContainer = Dom.create('div');\n\t\tDom.prepend(editorContainer, this._container);\n\t\tthis.#toDoEditor = new TodoEditor({\n\t\t\tcontainer: editorContainer,\n\t\t\tdefaultDescription: '',\n\t\t\townerTypeId: this._ownerTypeId,\n\t\t\townerId: this._ownerId,\n\t\t\tevents: {\n\t\t\t\tonFocus: this._focusHandler,\n\t\t\t\tonChangeDescription: this.#onChangeDescription.bind(this),\n\t\t\t}\n\t\t});\n\n\t\tthis.#toDoEditor.show();\n\t}\n\n\tsave(): Promise\n\t{\n\t\tif (Dom.hasClass(this._saveButton, 'ui-btn-disabled'))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\t\treturn this.#toDoEditor.save().then((response) => {\n\t\t\tif (Type.isArray(response.errors) && response.errors.length)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tthis.cancel();\n\n\t\t\treturn true;\n\t\t});\n\t}\n\n\tcancel(): void\n\t{\n\t\tthis.#toDoEditor.clearValue();\n\t\tDom.removeClass(this._container, 'focus');\n\t\tthis.release();\n\t}\n\n\tbindInputHandlers(): void\n\t{\n\t\t// do nothing\n\t}\n\n\tsetParentActivityId(activityId: Number): void\n\t{\n\t\tthis.#toDoEditor.setParentActivityId(activityId);\n\t}\n\n\tsetDeadLine(deadLine: String): void\n\t{\n\t\tthis.#toDoEditor.setDeadLine(deadLine);\n\t}\n\n\tsetFocused(): void\n\t{\n\t\tthis.#toDoEditor.setFocused();\n\t}\n\n\t#onChangeDescription(event: BaseEvent): void\n\t{\n\t\tconst {description} = event.getData();\n\n\t\tif (!description.length && !Dom.hasClass(this._saveButton, 'ui-btn-disabled'))\n\t\t{\n\t\t\tDom.addClass(this._saveButton, 'ui-btn-disabled');\n\t\t}\n\t\telse if (description.length && Dom.hasClass(this._saveButton, 'ui-btn-disabled'))\n\t\t{\n\t\t\tDom.removeClass(this._saveButton, 'ui-btn-disabled')\n\t\t}\n\t}\n\n\tstatic create(id, settings): ToDo\n\t{\n\t\tconst self = new ToDo();\n\t\tself.initialize(id, settings);\n\t\tToDo.items[self.getId()] = self;\n\t\treturn self;\n\t}\n\n\tstatic items = {};\n}\n","import CompatibleItem from \"./compatible-item\";\nimport History from \"./history\";\nimport {Item as ItemType} from \"../types\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Scheduled extends CompatibleItem\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._schedule = null;\n\t\tthis._deadlineNode = null;\n\n\t\tthis._headerClickHandler = BX.delegate(this.onHeaderClick, this);\n\t\tthis._setAsDoneButtonHandler = BX.delegate(this.onSetAsDoneButtonClick, this);\n\t}\n\n\tdoInitialize()\n\t{\n\t\tthis._schedule = this.getSetting(\"schedule\");\n\t\tif(!(this._activityEditor instanceof BX.CrmActivityEditor))\n\t\t{\n\t\t\tthrow \"Scheduled. The field 'activityEditor' is not assigned.\";\n\t\t}\n\n\t\tif(this.hasPermissions() && !this.verifyPermissions())\n\t\t{\n\t\t\tthis.loadPermissions();\n\t\t}\n\t}\n\n\tgetTypeId()\n\t{\n\t\treturn ItemType.undefined;\n\t}\n\n\tverifyPermissions()\n\t{\n\t\tconst userId = BX.prop.getInteger(this.getPermissions(), \"USER_ID\", 0);\n\t\treturn userId <= 0 || userId === this._schedule.getUserId();\n\t}\n\n\tloadPermissions()\n\t{\n\t\tBX.ajax(\n\t\t\t{\n\t\t\t\turl: this._schedule.getServiceUrl(),\n\t\t\t\tmethod: \"POST\",\n\t\t\t\tdataType: \"json\",\n\t\t\t\tdata: { \"ACTION\": \"GET_PERMISSIONS\", \"TYPE_ID\": this.getTypeId(), \"ID\": this.getAssociatedEntityId() },\n\t\t\t\tonsuccess: this.onPermissionsLoad.bind(this)\n\t\t\t}\n\t\t);\n\t}\n\n\tonPermissionsLoad(result)\n\t{\n\t\tconst permissions = BX.prop.getObject(result, \"PERMISSIONS\", null);\n\t\tif(!permissions)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.setPermissions(permissions);\n\t\twindow.setTimeout(function(){ this.refreshLayout(); }.bind(this), 0);\n\t}\n\n\tgetDeadline()\n\t{\n\t\treturn null;\n\t}\n\n\thasDeadline()\n\t{\n\t\treturn BX.type.isDate(this.getDeadline());\n\t}\n\n\tisCounterEnabled()\n\t{\n\t\tif (this.isDone())\n\t\t{\n\t\t\treturn this._existedStreamItemDeadLine && History.isCounterEnabled(this._existedStreamItemDeadLine);\n\t\t}\n\n\t\tconst deadline = this.getDeadline();\n\n\t\treturn deadline && History.isCounterEnabled(deadline);\n\t}\n\n\tisIncomingChannel()\n\t{\n\t\treturn false;\n\t}\n\n\tgetSourceId()\n\t{\n\t\treturn BX.prop.getInteger(this.getAssociatedEntityData(), \"ID\", 0);\n\t}\n\n\tonSetAsDoneCompleted(data)\n\t{\n\t\tif(!BX.prop.getBoolean(data, \"COMPLETED\"))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.markAsDone(true);\n\t\tthis._schedule.onItemMarkedAsDone(\n\t\t\tthis,\n\t\t\t{ 'historyItemData': BX.prop.getObject(data, \"HISTORY_ITEM\") }\n\t\t);\n\t}\n\n\tonPosponeCompleted(data)\n\t{\n\t}\n\n\trefreshDeadline()\n\t{\n\t\tthis._deadlineNode.innerHTML = this.formatDateTime(this.getDeadline());\n\t}\n\n\tformatDateTime(time)\n\t{\n\t\treturn this._schedule.formatDateTime(time);\n\t}\n\n\tgetWrapperClassName()\n\t{\n\t\treturn \"\";\n\t}\n\n\tgetIconClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-icon\";\n\t}\n\n\tisReadOnly()\n\t{\n\t\treturn this._schedule.isReadOnly();\n\t}\n\n\tisEditable()\n\t{\n\t\treturn !this.isReadOnly();\n\t}\n\n\tcanPostpone()\n\t{\n\t\tif(this.isReadOnly())\n\t\t{\n\t\t\treturn false;\n\t\t}\n\t\tif (this.isIncomingChannel())\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst perms = BX.prop.getObject(this.getAssociatedEntityData(), \"PERMISSIONS\", {});\n\t\treturn BX.prop.getBoolean(perms, \"POSTPONE\", false);\n\t}\n\n\tisDone()\n\t{\n\t\treturn BX.CrmActivityStatus.isFinal(\n\t\t\tBX.prop.getInteger(this.getAssociatedEntityData(), \"STATUS\", 0)\n\t\t);\n\t}\n\n\tcanComplete()\n\t{\n\t\tif(this.isReadOnly())\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst perms = BX.prop.getObject(this.getAssociatedEntityData(), \"PERMISSIONS\", {});\n\t\treturn BX.prop.getBoolean(perms, \"COMPLETE\", false);\n\t}\n\n\tsetAsDone(isDone)\n\t{\n\t}\n\n\tprepareContent(options)\n\t{\n\t\treturn null;\n\t}\n\n\tprepareLayout(options)\n\t{\n\t\tconst vueComponent = this.makeVueComponent(options, 'schedule');\n\t\tthis._wrapper = vueComponent ? vueComponent : this.prepareContent();\n\t\tif(this._wrapper)\n\t\t{\n\t\t\tconst enableAdd = BX.type.isPlainObject(options) ? BX.prop.getBoolean(options, \"add\", true) : true;\n\t\t\tif(enableAdd)\n\t\t\t{\n\t\t\t\tconst anchor = BX.type.isPlainObject(options) && BX.type.isElementNode(options[\"anchor\"]) ? options[\"anchor\"] : null;\n\t\t\t\tif(anchor && anchor.nextSibling)\n\t\t\t\t{\n\t\t\t\t\tthis._container.insertBefore(this._wrapper, anchor.nextSibling);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis._container.appendChild(this._wrapper);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.markAsTerminated(this._schedule.checkItemForTermination(this));\n\t\t}\n\t}\n\n\tonHeaderClick(e)\n\t{\n\t\tthis.view();\n\t\te.preventDefault ? e.preventDefault() : (e.returnValue = false);\n\t}\n\n\tonSetAsDoneButtonClick(e)\n\t{\n\t\tif(this.canComplete())\n\t\t{\n\t\t\tthis.setAsDone(!this.isDone());\n\t\t}\n\t}\n\n\tonActivityCreate(activity, data)\n\t{\n\t\tthis._schedule.getManager().onActivityCreated(activity, data);\n\t}\n\n\tstatic isDone(data)\n\t{\n\t\tconst entityData = BX.prop.getObject(data, \"ASSOCIATED_ENTITY\", {});\n\t\treturn BX.CrmActivityStatus.isFinal(BX.prop.getInteger(entityData, \"STATUS\", 0));\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Scheduled();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","/** @memberof BX.Crm.Timeline */\nexport default class Action\n{\n\tconstructor()\n\t{\n\t\tthis._id = \"\";\n\t\tthis._settings = {};\n\t\tthis._container = null;\n\t}\n\n\tinitialize(id, settings)\n\t{\n\t\tthis._id = BX.type.isNotEmptyString(id) ? id : BX.util.getRandomString(4);\n\t\tthis._settings = settings ? settings : {};\n\n\t\tthis._container = this.getSetting(\"container\");\n\t\tif(!BX.type.isElementNode(this._container))\n\t\t{\n\t\t\tthrow \"BX.CrmTimelineAction: Could not find container.\";\n\t\t}\n\n\t\tthis.doInitialize();\n\t}\n\n\tdoInitialize()\n\t{\n\t}\n\n\tgetId()\n\t{\n\t\treturn this._id;\n\t}\n\n\tgetSetting(name, defaultval)\n\t{\n\t\treturn this._settings.hasOwnProperty(name) ? this._settings[name] : defaultval;\n\t}\n\n\tlayout()\n\t{\n\t\tthis.doLayout();\n\t}\n\n\tdoLayout()\n\t{\n\t}\n}\n","import Action from \"../action\";\n\n/** @memberof BX.Crm.Timeline.Actions */\nexport default class Activity extends Action\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._activityEditor = null;\n\t\tthis._entityData = null;\n\t\tthis._item = null;\n\t\tthis._isEnabled = true;\n\t}\n\n\tdoInitialize()\n\t{\n\t\tthis._entityData = this.getSetting(\"entityData\");\n\t\tif(!BX.type.isPlainObject(this._entityData))\n\t\t{\n\t\t\tthrow \"BX.Crm.Timeline.Actions.Activity. A required parameter 'entityData' is missing.\";\n\t\t}\n\n\t\tthis._activityEditor = this.getSetting(\"activityEditor\");\n\t\tif(!(this._activityEditor instanceof BX.CrmActivityEditor))\n\t\t{\n\t\t\tthrow \"BX.Crm.Timeline.Actions.Activity. A required parameter 'activityEditor' is missing.\";\n\t\t}\n\n\t\tthis._item = this.getSetting(\"item\");\n\t\tthis._isEnabled = this.getSetting(\"enabled\", true);\n\t}\n\n\tgetActivityId()\n\t{\n\t\treturn BX.prop.getInteger(this._entityData, \"ID\", 0);\n\t}\n\n\tloadActivityCommunications(callback)\n\t{\n\t\tthis._activityEditor.getActivityCommunications(\n\t\t\tthis.getActivityId(),\n\t\t\tfunction(communications)\n\t\t\t{\n\t\t\t\tif(BX.type.isFunction(callback))\n\t\t\t\t{\n\t\t\t\t\tcallback(communications);\n\t\t\t\t}\n\t\t\t},\n\t\t\ttrue\n\t\t);\n\t}\n\n\tgetItemData()\n\t{\n\t\treturn this._item ?  this._item.getData() : null;\n\t}\n}\n","import Activity from \".//activity\";\n\n/** @memberof BX.Crm.Timeline.Actions */\nexport class Email extends Activity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._clickHandler = BX.delegate(this.onClick, this);\n\t\tthis._saveHandler = BX.delegate(this.onSave, this);\n\t}\n\n\tonClick(e)\n\t{\n\t\tconst settings =\n\t\t\t{\n\t\t\t\t\"ownerType\": BX.CrmEntityType.resolveName(BX.prop.getInteger(this._entityData, \"OWNER_TYPE_ID\", 0)),\n\t\t\t\t\"ownerID\": BX.prop.getInteger(this._entityData, \"OWNER_ID\", 0),\n\t\t\t\t\"ownerUrl\": BX.prop.getString(this._entityData, \"OWNER_URL\", \"\"),\n\t\t\t\t\"ownerTitle\": BX.prop.getString(this._entityData, \"OWNER_TITLE\", \"\"),\n\t\t\t\t\"originalMessageID\": BX.prop.getInteger(this._entityData, \"ID\", 0),\n\t\t\t\t\"messageType\": \"RE\"\n\t\t\t};\n\n\t\tif (BX.CrmActivityProvider && top.BX.Bitrix24 && top.BX.Bitrix24.Slider)\n\t\t{\n\t\t\tconst activity = this._activityEditor.addEmail(settings);\n\t\t\tactivity.addOnSave(this._saveHandler);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.loadActivityCommunications(\n\t\t\t\tBX.delegate(\n\t\t\t\t\tfunction(communications)\n\t\t\t\t\t{\n\t\t\t\t\t\tsettings['communications'] = BX.type.isArray(communications) ? communications : [];\n\t\t\t\t\t\tsettings['communicationsLoaded'] = true;\n\n\t\t\t\t\t\tBX.CrmActivityEmail.prepareReply(settings);\n\n\t\t\t\t\t\tconst activity = this._activityEditor.addEmail(settings);\n\t\t\t\t\t\tactivity.addOnSave(this._saveHandler);\n\t\t\t\t\t},\n\t\t\t\t\tthis\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\t\treturn BX.PreventDefault(e);\n\t}\n\n\tonSave(activity, data)\n\t{\n\t\tif(BX.type.isFunction(this._item.onActivityCreate))\n\t\t{\n\t\t\tthis._item.onActivityCreate(activity, data);\n\t\t}\n\t}\n}\n\n/** @memberof BX.Crm.Timeline.Actions */\nexport class HistoryEmail extends Email\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tdoLayout()\n\t{\n\t\tthis._container.appendChild(\n\t\t\tBX.create(\"A\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-action-reply-btn\" },\n\t\t\t\t\tevents: { \"click\": this._clickHandler }\n\t\t\t\t})\n\t\t);\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new HistoryEmail();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n\n/** @memberof BX.Crm.Timeline.Actions */\nexport class ScheduleEmail extends Email\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tdoLayout()\n\t{\n\t\tthis._container.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-action-reply-btn\" },\n\t\t\t\t\tevents: { \"click\": this._clickHandler }\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new ScheduleEmail();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import History from \"./history\";\nimport {Mark} from \"../types\";\nimport {HistoryEmail} from \"../actions/email\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class HistoryActivity extends History\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tdoInitialize()\n\t{\n\t\tsuper.doInitialize();\n\t\tif(!(this._activityEditor instanceof BX.CrmActivityEditor))\n\t\t{\n\t\t\tthrow \"HistoryActivity. The field 'activityEditor' is not assigned.\";\n\t\t}\n\t}\n\n\tgetTitle()\n\t{\n\t\treturn BX.prop.getString(this.getAssociatedEntityData(), \"SUBJECT\", \"\");\n\t}\n\n\tgetTypeDescription()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst direction = BX.prop.getInteger(entityData, \"DIRECTION\", 0);\n\n\t\tconst typeCategoryId = this.getTypeCategoryId();\n\t\tif(typeCategoryId === BX.CrmActivityType.email)\n\t\t{\n\t\t\treturn this.getMessage(direction === BX.CrmActivityDirection.incoming ? \"incomingEmail\" : \"outgoingEmail\");\n\t\t}\n\t\telse if(typeCategoryId === BX.CrmActivityType.call)\n\t\t{\n\t\t\treturn this.getMessage(direction === BX.CrmActivityDirection.incoming ? \"incomingCall\" : \"outgoingCall\");\n\t\t}\n\t\telse if(typeCategoryId === BX.CrmActivityType.meeting)\n\t\t{\n\t\t\treturn this.getMessage(\"meeting\");\n\t\t}\n\t\telse if(typeCategoryId === BX.CrmActivityType.task)\n\t\t{\n\t\t\treturn this.getMessage(\"task\");\n\t\t}\n\t\telse if(typeCategoryId === BX.CrmActivityType.provider)\n\t\t{\n\t\t\tconst providerId = BX.prop.getString(entityData, \"PROVIDER_ID\", \"\");\n\n\t\t\tif(providerId === \"CRM_WEBFORM\")\n\t\t\t{\n\t\t\t\treturn this.getMessage(\"webform\");\n\t\t\t}\n\t\t\telse if (providerId === \"CRM_SMS\")\n\t\t\t{\n\t\t\t\treturn this.getMessage(\"sms\");\n\t\t\t}\n\t\t\telse if (providerId === \"CRM_REQUEST\")\n\t\t\t{\n\t\t\t\treturn this.getMessage(\"activityRequest\");\n\t\t\t}\n\t\t\telse if (providerId === \"IMOPENLINES_SESSION\")\n\t\t\t{\n\t\t\t\treturn this.getMessage(\"openLine\");\n\t\t\t}\n\t\t\telse if (providerId === \"REST_APP\")\n\t\t\t{\n\t\t\t\treturn this.getMessage(\"restApplication\");\n\t\t\t}\n\t\t\telse if (providerId === \"VISIT_TRACKER\")\n\t\t\t{\n\t\t\t\treturn this.getMessage(\"visit\");\n\t\t\t}\n\t\t\telse if (providerId === \"ZOOM\")\n\t\t\t{\n\t\t\t\treturn this.getMessage(\"zoom\");\n\t\t\t}\n\t\t}\n\n\t\treturn \"\";\n\t}\n\n\tprepareTitleLayout()\n\t{\n\t\treturn BX.create(\"A\",\n\t\t\t{\n\t\t\t\tattrs: { href: \"#\",  className: \"crm-entity-stream-content-event-title\" },\n\t\t\t\tevents: { \"click\": this._headerClickHandler },\n\t\t\t\ttext: this.getTypeDescription()\n\t\t\t}\n\t\t);\n\t}\n\n\tprepareTimeLayout()\n\t{\n\t\treturn BX.create(\"SPAN\",\n\t\t\t{\n\t\t\t\tattrs: { className: \"crm-entity-stream-content-event-time\" },\n\t\t\t\ttext: this.formatTime(this.getCreatedTime())\n\t\t\t}\n\t\t);\n\t}\n\n\tprepareMarkLayout()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst markTypeId = BX.prop.getInteger(entityData, \"MARK_TYPE_ID\", 0);\n\t\tif(markTypeId <= 0)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tlet messageName = \"\";\n\t\tif(markTypeId === Mark.success)\n\t\t{\n\t\t\tmessageName = \"SuccessMark\";\n\t\t}\n\t\telse if(markTypeId === Mark.renew)\n\t\t{\n\t\t\tmessageName = \"RenewMark\";\n\t\t}\n\n\t\tif(messageName === \"\")\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tlet markText = \"\";\n\t\tconst typeCategoryId = this.getTypeCategoryId();\n\t\tif(typeCategoryId === BX.CrmActivityType.email)\n\t\t{\n\t\t\tmarkText = this.getMessage(\"email\" + messageName);\n\t\t}\n\t\telse if(typeCategoryId === BX.CrmActivityType.call)\n\t\t{\n\t\t\tmarkText = this.getMessage(\"call\" + messageName);\n\t\t}\n\t\telse if(typeCategoryId === BX.CrmActivityType.meeting)\n\t\t{\n\t\t\tmarkText = this.getMessage(\"meeting\" + messageName);\n\t\t}\n\t\telse if(typeCategoryId === BX.CrmActivityType.task)\n\t\t{\n\t\t\tmarkText = this.getMessage(\"task\" + messageName);\n\t\t}\n\n\t\tif(markText === \"\")\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn(\n\t\t\tBX.create(\n\t\t\t\t\"SPAN\",\n\t\t\t\t{\n\t\t\t\t\tprops: { className: \"crm-entity-stream-content-event-skipped\" },\n\t\t\t\t\ttext: markText\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t}\n\n\tprepareActions()\n\t{\n\t\tif(this.isReadOnly())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst typeCategoryId = this.getTypeCategoryId();\n\t\tif(typeCategoryId === BX.CrmActivityType.email)\n\t\t{\n\t\t\tthis._actions.push(\n\t\t\t\tHistoryEmail.create(\n\t\t\t\t\t\"email\",\n\t\t\t\t\t{\n\t\t\t\t\t\titem: this,\n\t\t\t\t\t\tcontainer: this._actionContainer,\n\t\t\t\t\t\tentityData: this.getAssociatedEntityData(),\n\t\t\t\t\t\tactivityEditor: this._activityEditor\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\t}\n\n\tprepareContextMenuItems()\n\t{\n\t\tif(this._isMenuShown)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst menuItems = [];\n\n\t\tif (!this.isReadOnly())\n\t\t{\n\t\t\tif (this.isEditable())\n\t\t\t{\n\t\t\t\tmenuItems.push({ id: \"edit\", text: this.getMessage(\"menuEdit\"), onclick: BX.delegate(this.edit, this)});\n\t\t\t}\n\t\t\tmenuItems.push({ id: \"remove\", text: this.getMessage(\"menuDelete\"), onclick: BX.delegate(this.processRemoval, this)});\n\n\t\t\tif (this.isFixed() || this._fixedHistory.findItemById(this._id))\n\t\t\t\tmenuItems.push({ id: \"unfasten\", text: this.getMessage(\"menuUnfasten\"), onclick: BX.delegate(this.unfasten, this)});\n\t\t\telse\n\t\t\t\tmenuItems.push({ id: \"fasten\", text: this.getMessage(\"menuFasten\"), onclick: BX.delegate(this.fasten, this)});\n\t\t}\n\t\treturn menuItems;\n\t}\n\n\tview()\n\t{\n\t\tthis.closeContextMenu();\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst id = BX.prop.getInteger(entityData, \"ID\", 0);\n\t\tif(id > 0)\n\t\t{\n\t\t\tthis._activityEditor.viewActivity(id);\n\t\t}\n\t}\n\n\tedit()\n\t{\n\t\tthis.closeContextMenu();\n\t\tconst associatedEntityTypeId = this.getAssociatedEntityTypeId();\n\t\tif(associatedEntityTypeId === BX.CrmEntityType.enumeration.activity)\n\t\t{\n\t\t\tconst entityData = this.getAssociatedEntityData();\n\t\t\tconst id = BX.prop.getInteger(entityData, \"ID\", 0);\n\t\t\tif(id > 0)\n\t\t\t{\n\t\t\t\tthis._activityEditor.editActivity(id);\n\t\t\t}\n\t\t}\n\t}\n\n\tprocessRemoval()\n\t{\n\t\tthis.closeContextMenu();\n\t\tthis._detetionConfirmDlgId = \"entity_timeline_deletion_\" + this.getId() + \"_confirm\";\n\t\tlet dlg = BX.Crm.ConfirmationDialog.get(this._detetionConfirmDlgId);\n\t\tif(!dlg)\n\t\t{\n\t\t\tdlg = BX.Crm.ConfirmationDialog.create(\n\t\t\t\tthis._detetionConfirmDlgId,\n\t\t\t\t{\n\t\t\t\t\ttitle: this.getMessage(\"removeConfirmTitle\"),\n\t\t\t\t\tcontent: this.getRemoveMessage()\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\tdlg.open().then(BX.delegate(this.onRemovalConfirm, this), BX.delegate(this.onRemovalCancel, this));\n\t}\n\n\tgetRemoveMessage()\n\t{\n\t\treturn this.getMessage('removeConfirm');\n\t}\n\n\tonRemovalConfirm(result)\n\t{\n\t\tif(BX.prop.getBoolean(result, \"cancel\", true))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.remove();\n\t}\n\n\tonRemovalCancel()\n\t{\n\t}\n\n\tremove()\n\t{\n\t\tconst associatedEntityTypeId = this.getAssociatedEntityTypeId();\n\n\t\tif(associatedEntityTypeId === BX.CrmEntityType.enumeration.activity)\n\t\t{\n\t\t\tconst entityData = this.getAssociatedEntityData();\n\n\t\t\tconst id = BX.prop.getInteger(entityData, \"ID\", 0);\n\n\t\t\tif(id > 0)\n\t\t\t{\n\t\t\t\tconst activityEditor = this._activityEditor;\n\t\t\t\tconst item = activityEditor.getItemById(id);\n\t\t\t\tif (item)\n\t\t\t\t{\n\t\t\t\t\tactivityEditor.deleteActivity(id, true);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tconst serviceUrl = BX.util.add_url_param(activityEditor.getSetting('serviceUrl', ''),\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tid: id,\n\t\t\t\t\t\t\taction: 'get_activity',\n\t\t\t\t\t\t\townertype: activityEditor.getSetting('ownerType', ''),\n\t\t\t\t\t\t\townerid: activityEditor.getSetting('ownerID', '')\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t\tBX.ajax({\n\t\t\t\t\t\t'url': serviceUrl,\n\t\t\t\t\t\t'method': 'POST',\n\t\t\t\t\t\t'dataType': 'json',\n\t\t\t\t\t\t'data':\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t'ACTION' : 'GET_ACTIVITY',\n\t\t\t\t\t\t\t\t'ID': id,\n\t\t\t\t\t\t\t\t'OWNER_TYPE': activityEditor.getSetting('ownerType', ''),\n\t\t\t\t\t\t\t\t'OWNER_ID': activityEditor.getSetting('ownerID', '')\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\tonsuccess: BX.delegate(\n\t\t\t\t\t\t\tfunction(data)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tif(typeof(data['ACTIVITY']) !== 'undefined')\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tactivityEditor._handleActivityChange(data['ACTIVITY']);\n\t\t\t\t\t\t\t\t\twindow.setTimeout(BX.delegate(this.remove ,this), 500);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tthis\n\t\t\t\t\t\t),\n\t\t\t\t\t\tonfailure: function(data){}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new HistoryActivity();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n\n\tstatic messages = {};\n}\n","import HistoryActivity from \"./history-activity\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Document extends HistoryActivity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetTitle()\n\t{\n\t\tconst typeCategoryId = BX.prop.getInteger(this._data, \"TYPE_CATEGORY_ID\", 0);\n\t\tif(typeCategoryId === 3)\n\t\t{\n\t\t\treturn BX.Loc.getMessage('CRM_TIMELINE_DOCUMENT_VIEWED');\n\t\t}\n\n\t\treturn this.getMessage(\"document\");\n\t}\n\n\tprepareTitleLayout()\n\t{\n\t\treturn BX.create(\"SPAN\", {\n\t\t\tattrs:{ className: \"crm-entity-stream-content-event-title\"},\n\t\t\tchildren: [\n\t\t\t\tBX.create(\"A\", {\n\t\t\t\t\tattrs: { href: \"#\" },\n\t\t\t\t\tevents: { \"click\": BX.delegate(this.editDocument, this) },\n\t\t\t\t\ttext: this.getTitle()\n\t\t\t\t})\n\t\t\t]\n\t\t});\n\t}\n\n\tprepareTitleStatusLayout()\n\t{\n\t\tconst typeCategoryId = BX.prop.getInteger(this._data, \"TYPE_CATEGORY_ID\", 0);\n\t\tif(typeCategoryId === 3)\n\t\t{\n\t\t\treturn BX.create(\"SPAN\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-event-done\" },\n\t\t\t\t\ttext: BX.Loc.getMessage('CRM_TIMELINE_DOCUMENT_VIEWED_STATUS')\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\tif(typeCategoryId === 2)\n\t\t{\n\t\t\treturn BX.create(\"SPAN\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-event-sent\" },\n\t\t\t\t\ttext: BX.Loc.getMessage('CRM_TIMELINE_DOCUMENT_CREATED_STATUS')\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tprepareTimeLayout()\n\t{\n\t\treturn BX.create(\"SPAN\",\n\t\t\t{\n\t\t\t\tattrs: { className: \"crm-entity-stream-content-event-time\" },\n\t\t\t\ttext: this.formatTime(this.getCreatedTime())\n\t\t\t}\n\t\t);\n\t}\n\n\tisContextMenuEnabled()\n\t{\n\t\tconst typeCategoryId = BX.prop.getInteger(this._data, \"TYPE_CATEGORY_ID\", 0);\n\n\t\treturn typeCategoryId !== 3;\n\t}\n\n\tprepareHeaderLayout()\n\t{\n\t\tconst header = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-header\"}});\n\t\theader.appendChild(this.prepareTitleLayout());\n\t\tconst statusLayout = this.prepareTitleStatusLayout();\n\t\tif(statusLayout)\n\t\t{\n\t\t\theader.appendChild(statusLayout);\n\t\t}\n\t\theader.appendChild(this.prepareTimeLayout());\n\n\t\treturn header;\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst text = this.getTextDataParam(\"COMMENT\", \"\");\n\n\t\tconst wrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-section crm-entity-stream-section-history crm-entity-stream-section-document\"}\n\t\t\t}\n\t\t);\n\n\t\tif(this.isFixed())\n\t\t{\n\t\t\tBX.addClass(wrapper, 'crm-entity-stream-section-top-fixed');\n\t\t}\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-document\" }\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tif(this.isContextMenuEnabled())\n\t\t{\n\t\t\twrapper.appendChild(this.prepareContextMenuButton());\n\t\t}\n\n\t\tif(!this.isReadOnly())\n\t\t{\n\t\t\twrapper.appendChild(this.prepareFixedSwitcherLayout());\n\t\t}\n\n\t\tconst contentWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\tchildren: [contentWrapper]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst header = this.prepareHeaderLayout();\n\t\tcontentWrapper.appendChild(header);\n\n\t\tconst detailWrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail\"},\n\t\t\t\thtml: text\n\t\t\t}\n\t\t);\n\t\tconst title = BX.findChildByClassName(detailWrapper, 'document-title-link');\n\t\tif(title)\n\t\t{\n\t\t\tBX.bind(title, 'click', BX.proxy(this.editDocument, this));\n\t\t}\n\t\tcontentWrapper.appendChild(detailWrapper);\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontentWrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\t//region  Actions\n\t\tthis._actionContainer = BX.create(\"SPAN\", { attrs: { className: \"crm-entity-stream-content-detail-action\" } });\n\t\tcontentWrapper.appendChild(this._actionContainer);\n\t\t//endregion\n\n\t\treturn wrapper;\n\t}\n\n\tprepareActions()\n\t{\n\t}\n\n\tshowActions(show)\n\t{\n\t\tif(this._actionContainer)\n\t\t{\n\t\t\tthis._actionContainer.style.display = show ? \"\" : \"none\";\n\t\t}\n\t}\n\n\tprepareContextMenuItems()\n\t{\n\t\tconst menuItems = [];\n\n\t\tif(!this.isReadOnly())\n\t\t{\n\t\t\tmenuItems.push({ id: \"edit\", text: this.getMessage(\"menuEdit\"), onclick: BX.delegate(this.editDocument, this)});\n\t\t\tmenuItems.push({ id: \"remove\", text: this.getMessage(\"menuDelete\"), onclick: BX.delegate(this.confirmDelete, this)});\n\n\t\t\tif (this.isFixed() || this._fixedHistory.findItemById(this._id))\n\t\t\t{\n\t\t\t\tmenuItems.push({ id: \"unfasten\", text: this.getMessage(\"menuUnfasten\"), onclick: BX.delegate(this.unfasten, this)});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tmenuItems.push({ id: \"fasten\", text: this.getMessage(\"menuFasten\"), onclick: BX.delegate(this.fasten, this)});\n\t\t\t}\n\t\t}\n\n\t\treturn menuItems;\n\t}\n\n\tconfirmDelete()\n\t{\n\t\tthis.closeContextMenu();\n\t\tthis._detetionConfirmDlgId = \"entity_timeline_deletion_\" + this.getId() + \"_confirm\";\n\t\tlet dlg = BX.Crm.ConfirmationDialog.get(this._detetionConfirmDlgId);\n\t\tif(!dlg)\n\t\t{\n\t\t\tdlg = BX.Crm.ConfirmationDialog.create(\n\t\t\t\tthis._detetionConfirmDlgId,\n\t\t\t\t{\n\t\t\t\t\ttitle: this.getMessage(\"removeConfirmTitle\"),\n\t\t\t\t\tcontent: this.getMessage('documentRemove')\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\tdlg.open().then(BX.delegate(this.onConfirmDelete, this), BX.DoNothing);\n\t}\n\n\tonConfirmDelete(result)\n\t{\n\t\tif(BX.prop.getBoolean(result, \"cancel\", true))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.deleteDocument();\n\t}\n\n\tdeleteDocument()\n\t{\n\t\tif(this._isRequestRunning)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tthis._isRequestRunning = true;\n\t\tBX.ajax(\n\t\t\t{\n\t\t\t\turl: this._history._serviceUrl,\n\t\t\t\tmethod: \"POST\",\n\t\t\t\tdataType: \"json\",\n\t\t\t\tdata:\n\t\t\t\t\t{\n\t\t\t\t\t\t\"ACTION\": \"DELETE_DOCUMENT\",\n\t\t\t\t\t\t\"OWNER_TYPE_ID\":  this.getOwnerTypeId(),\n\t\t\t\t\t\t\"OWNER_ID\": this.getOwnerId(),\n\t\t\t\t\t\t\"ID\": this.getId()\n\t\t\t\t\t},\n\t\t\t\tonsuccess: BX.delegate(function(result)\n\t\t\t\t{\n\t\t\t\t\tthis._isRequestRunning = false;\n\t\t\t\t\tif(BX.type.isNotEmptyString(result.ERROR))\n\t\t\t\t\t{\n\t\t\t\t\t\talert(result.ERROR);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tconst deleteItem = this._history.findItemById(this._id);\n\t\t\t\t\t\tif (deleteItem instanceof Document)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tdeleteItem.clearAnimate();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst deleteFixedItem = this._fixedHistory.findItemById(this._id);\n\t\t\t\t\t\tif (deleteFixedItem instanceof Document)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tdeleteFixedItem.clearAnimate();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}, this),\n\t\t\t\tonfailure: BX.delegate(function()\n\t\t\t\t{\n\t\t\t\t\tthis._isRequestRunning = false;\n\t\t\t\t}, this)\n\t\t\t}\n\t\t);\n\t}\n\n\teditDocument()\n\t{\n\t\tconst documentId = this.getData().DOCUMENT_ID || 0;\n\t\tif(documentId > 0)\n\t\t{\n\t\t\tlet url = '/bitrix/components/bitrix/crm.document.view/slider.php';\n\t\t\turl = BX.util.add_url_param(url, {documentId: documentId});\n\t\t\tif(BX.SidePanel)\n\t\t\t{\n\t\t\t\tBX.SidePanel.Instance.open(url, {width: 1060});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\ttop.location.href = url;\n\t\t\t}\n\t\t}\n\t}\n\n\tupdateWrapper()\n\t{\n\t\tconst wrapper = this.getWrapper();\n\t\tif(wrapper)\n\t\t{\n\t\t\tconst detailWrapper = BX.findChildByClassName(wrapper, 'crm-entity-stream-content-detail');\n\t\t\tif(detailWrapper)\n\t\t\t{\n\t\t\t\tBX.adjust(detailWrapper, {html: this.getTextDataParam(\"COMMENT\", \"\")});\n\t\t\t\tconst title = BX.findChildByClassName(detailWrapper, 'document-title-link');\n\t\t\t\tif(title)\n\t\t\t\t{\n\t\t\t\t\tBX.bind(title, 'click', BX.proxy(this.editDocument, this));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Document();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","/** @memberof BX.Crm.Timeline.Animation */\nexport default class Item\n{\n\tconstructor()\n\t{\n\t\tthis._id = \"\";\n\t\tthis._settings = {};\n\t\tthis._initialItem = null;\n\t\tthis._finalItem = null;\n\t\tthis._events = null;\n\t}\n\n\tinitialize(id, settings)\n\t{\n\t\tthis._id = BX.type.isNotEmptyString(id) ? id : BX.util.getRandomString(4);\n\t\tthis._settings = settings ? settings : {};\n\n\t\tthis._initialItem = this.getSetting(\"initialItem\");\n\t\tthis._finalItem = this.getSetting(\"finalItem\");\n\n\t\tthis._anchor = this.getSetting(\"anchor\");\n\t\tthis._events = this.getSetting(\"events\", {});\n\t}\n\n\tgetId()\n\t{\n\t\treturn this._id;\n\t}\n\n\tgetSetting(name, defaultval)\n\t{\n\t\treturn this._settings.hasOwnProperty(name) ? this._settings[name] : defaultval;\n\t}\n\n\trun()\n\t{\n\t\tthis._node = this._initialItem.getWrapper();\n\t\tconst originalPosition = BX.pos(this._node);\n\t\tthis._initialYPosition = originalPosition.top;\n\t\tthis._initialXPosition = originalPosition.left;\n\t\tthis._initialWidth = this._node.offsetWidth;\n\t\tthis._initialHeight = this._node.offsetHeight;\n\n\t\tthis._anchorYPosition = BX.pos(this._anchor).top;\n\n\t\tthis.createStub();\n\t\tthis.createGhost();\n\t\tthis.moveGhost();\n\t}\n\n\tcreateStub()\n\t{\n\t\tthis._stub = BX.create(\n\t\t\t\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: { className: \"crm-entity-stream-section crm-entity-stream-section-planned crm-entity-stream-section-shadow\" },\n\t\t\t\tchildren :\n\t\t\t\t\t[\n\t\t\t\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-icon\" } }),\n\t\t\t\t\t\tBX.create(\n\t\t\t\t\t\t\t\"DIV\",\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tprops: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\t\t\t\tstyle: { height: this._initialHeight + \"px\" }\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t)\n\t\t\t\t\t]\n\t\t\t}\n\t\t);\n\n\t\tthis._node.parentNode.insertBefore(this._stub, this._node);\n\t}\n\n\tcreateGhost()\n\t{\n\t\tthis._ghostNode = this._node;\n\t\tthis._ghostNode.style.position = \"absolute\";\n\t\tthis._ghostNode.style.width = this._initialWidth + \"px\";\n\t\tthis._ghostNode.style.height = this._initialHeight + \"px\";\n\t\tthis._ghostNode.style.top = this._initialYPosition + \"px\";\n\t\tthis._ghostNode.style.left = this._initialXPosition + \"px\";\n\t\tdocument.body.appendChild(this._ghostNode);\n\t\tsetTimeout(BX.proxy(function (){BX.addClass(this._ghostNode, \"crm-entity-stream-section-casper\" )}, this), 20);\n\t}\n\n\tmoveGhost()\n\t{\n\t\tconst node = this._ghostNode;\n\t\tconst movingEvent = new BX.easing({\n\t\t\tduration: 500,\n\t\t\tstart: {top: this._initialYPosition},\n\t\t\tfinish: {top: this._anchorYPosition},\n\t\t\ttransition: BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\tstep: BX.proxy(function (state) {\n\t\t\t\tnode.style.top = state.top + \"px\";\n\t\t\t}, this)\n\t\t});\n\t\tsetTimeout( BX.proxy(function () {\n\t\t\tmovingEvent.animate();\n\t\t\tnode.style.boxShadow = \"\";\n\t\t}, this), 500);\n\n\t\tconst placeEventAnim = new BX.easing({\n\t\t\tduration: 500,\n\t\t\tstart: {height: 0},\n\t\t\tfinish: {height: this._initialHeight + 20},\n\t\t\ttransition: BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\tstep: BX.proxy(function (state) {\n\t\t\t\tthis._anchor.style.height = state.height + \"px\";\n\t\t\t}, this),\n\t\t\tcomplete: BX.proxy(function () {\n\t\t\t\tif (BX.type.isFunction(this._events[\"complete\"]))\n\t\t\t\t{\n\t\t\t\t\tthis._events[\"complete\"]();\n\t\t\t\t}\n\n\t\t\t\tthis.addHistoryItem();\n\t\t\t\tthis.removeGhost();\n\t\t\t}, this)\n\t\t});\n\t\tsetTimeout(function (){placeEventAnim.animate()}, 500);\n\t}\n\n\taddHistoryItem()\n\t{\n\t\tconst node = this._finalItem.getWrapper();\n\n\t\tthis._anchor.parentNode.insertBefore(node, this._anchor.nextSibling);\n\n\t\tthis._finalItemHeight = this._anchor.offsetHeight - node.offsetHeight;\n\t\tthis._anchor.style.height = 0;\n\t\tnode.style.marginBottom = this._finalItemHeight + \"px\";\n\t}\n\n\tremoveGhost()\n\t{\n\t\tconst ghostNode = this._ghostNode;\n\t\tconst finalNode = this._finalItem.getWrapper();\n\n\t\tghostNode.style.overflow = \"hidden\";\n\t\tconst hideCasperItem = new BX.easing({\n\t\t\tduration: 70,\n\t\t\tstart: {opacity: 100, height: ghostNode.offsetHeight, marginBottom: this._finalItemHeight},\n\t\t\tfinish: {opacity: 0, height: finalNode.offsetHeight, marginBottom: 20},\n\t\t\t// transition : BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\tstep: BX.proxy(function (state) {\n\t\t\t\tghostNode.style.opacity = state.opacity / 100;\n\t\t\t\tghostNode.style.height = state.height + \"px\";\n\t\t\t\tfinalNode.style.marginBottom = state.marginBottom + \"px\";\n\t\t\t}, this),\n\t\t\tcomplete: BX.proxy(function () {\n\t\t\t\tghostNode.remove();\n\t\t\t\tfinalNode.style.marginBottom = \"\";\n\t\t\t\tthis.collapseStub();\n\n\t\t\t}, this)\n\t\t});\n\t\thideCasperItem.animate();\n\t}\n\n\tcollapseStub()\n\t{\n\t\tconst removePlannedEvent = new BX.easing({\n\t\t\tduration: 500,\n\t\t\tstart: {opacity: 100, height: this._initialHeight, marginBottom: 15},\n\t\t\tfinish: {opacity: 0, height: 0, marginBottom: 0},\n\t\t\ttransition: BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\tstep: BX.proxy(function (state) {\n\t\t\t\tthis._stub.style.height = state.height + \"px\";\n\t\t\t\tthis._stub.style.marginBottom = state.marginBottom + \"px\";\n\t\t\t\tthis._stub.style.opacity = state.opacity / 100;\n\t\t\t}, this),\n\t\t\tcomplete: BX.proxy(function () {\n\t\t\t\tthis.inited = false\n\t\t\t}, this)\n\n\t\t});\n\t\tremovePlannedEvent.animate();\n\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Item();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","/** @memberof BX.Crm.Timeline.Animation */\nexport default class Shift\n{\n\tconstructor()\n\t{\n\t\tthis._node = null;\n\t\tthis._anchor = null;\n\t\tthis._nodeParent  = null;\n\t\tthis._startPosition = null;\n\t\tthis._events = null;\n\t}\n\n\tinitialize(node, anchor, startPosition, shadowNode, events)\n\t{\n\t\tthis._node = node;\n\t\tthis._shadowNode = shadowNode;\n\t\tthis._anchor = anchor;\n\t\tthis._nodeParent  = node.parentNode;\n\t\tthis._startPosition = startPosition;\n\t\tthis._events = BX.type.isPlainObject(events) ? events : {};\n\n\t}\n\n\trun()\n\t{\n\t\tthis._anchorPosition = BX.pos(this._anchor);\n\n\t\tsetTimeout(\n\t\t\tBX.proxy(\n\t\t\t\tfunction (){\n\t\t\t\t\tBX.addClass(this._node, \"crm-entity-stream-section-casper\" )\n\t\t\t\t},\n\t\t\t\tthis\n\t\t\t),\n\t\t\t0\n\t\t);\n\n\t\tconst movingEvent = new BX.easing({\n\t\t\tduration: 1500,\n\t\t\tstart: {top: this._startPosition.top, height: 0},\n\t\t\tfinish: {top: this._anchorPosition.top, height: this._startPosition.height + 20},\n\t\t\ttransition: BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\tstep: BX.proxy(function (state) {\n\t\t\t\tthis._node.style.top = state.top + \"px\";\n\t\t\t\tthis._anchor.style.height = state.height + \"px\";\n\t\t\t}, this),\n\t\t\tcomplete: BX.proxy(function () {\n\t\t\t\tthis.finish();\n\t\t\t}, this)\n\t\t});\n\t\tmovingEvent.animate();\n\t}\n\n\tfinish()\n\t{\n\t\tif(BX.type.isFunction(this._events[\"complete\"]))\n\t\t{\n\t\t\tthis._events[\"complete\"]();\n\t\t}\n\t\tif( this._shadowNode !== false )\n\t\t{\n\t\t\t// this._stub.height = 0;\n\t\t}\n\t}\n\n\tstatic create(node, anchor, startPosition, shadowNode, events)\n\t{\n\t\tconst self = new Shift();\n\t\tself.initialize(node, anchor, startPosition, shadowNode, events);\n\t\treturn self;\n\t}\n}\n","import Shift from \"./shift\";\n\n/** @memberof BX.Crm.Timeline.Animation */\nexport default class ItemNew\n{\n\tconstructor()\n\t{\n\t\tthis._id = \"\";\n\t\tthis._settings = {};\n\t\tthis._initialItem = null;\n\t\tthis._finalItem = null;\n\t\tthis._events = null;\n\t\tthis._areAnimatedItemsVisible = null;\n\t}\n\n\tinitialize(id, settings)\n\t{\n\t\tthis._id = BX.type.isNotEmptyString(id) ? id : BX.util.getRandomString(4);\n\t\tthis._settings = settings ? settings : {};\n\n\t\tthis._initialItem = this.getSetting(\"initialItem\");\n\t\tthis._finalItem = this.getSetting(\"finalItem\");\n\n\t\tthis._anchor = this.getSetting(\"anchor\");\n\t\tthis._events = this.getSetting(\"events\", {});\n\t}\n\n\tgetId()\n\t{\n\t\treturn this._id;\n\t}\n\n\tgetSetting(name, defaultval)\n\t{\n\t\treturn this._settings.hasOwnProperty(name) ? this._settings[name] : defaultval;\n\t}\n\n\taddHistoryItem()\n\t{\n\t\tconst node = this._finalItem.getWrapper();\n\n\t\tthis._anchor.parentNode.insertBefore(node, this._anchor.nextSibling);\n\n\t}\n\n\trun()\n\t{\n\t\tthis._node = this._initialItem.getWrapper();\n\t\tthis._areAnimatedItemsVisible = this._node.offsetParent !== null;\n\t\tif (this._areAnimatedItemsVisible)\n\t\t{\n\t\t\tthis.createStub();\n\n\t\t\tBX.addClass(this._node, 'crm-entity-stream-section-animate-start');\n\n\t\t\tthis._startPosition = BX.pos(this._stub);\n\n\t\t\tthis._node.style.position = \"absolute\";\n\t\t\tthis._node.style.width = this._startPosition.width + \"px\";\n\t\t\tthis._node.style.height = this._startPosition.height + \"px\";\n\t\t\tthis._node.style.top = this._startPosition.top + \"px\";\n\t\t\tthis._node.style.left = this._startPosition.left + \"px\";\n\t\t\tthis._node.style.zIndex = 960;\n\n\n\t\t\tdocument.body.appendChild(this._node);\n\n\t\t\tconst shift = Shift.create(\n\t\t\t\tthis._node,\n\t\t\t\tthis._anchor,\n\t\t\t\tthis._startPosition,\n\t\t\t\tthis._stub,\n\t\t\t\t{complete: BX.delegate(this.finish, this)}\n\t\t\t);\n\t\t\tshift.run();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.finish();\n\t\t}\n\t}\n\n\tcreateStub()\n\t{\n\t\tthis._stub = BX.create(\n\t\t\t\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: { className: \"crm-entity-stream-section crm-entity-stream-section-planned crm-entity-stream-section-shadow\" },\n\t\t\t\tchildren :\n\t\t\t\t\t[\n\t\t\t\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-icon\" } }),\n\t\t\t\t\t\tBX.create(\n\t\t\t\t\t\t\t\"DIV\",\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tprops: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\t\t\t\tstyle: { height: this._initialItem._wrapper.clientHeight + \"px\" }\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t)\n\t\t\t\t\t]\n\t\t\t}\n\t\t);\n\n\t\tthis._node.parentNode.insertBefore(this._stub, this._node);\n\t}\n\n\tfinish()\n\t{\n\t\tthis._anchor.style.height = 0;\n\t\t//this._anchor.parentNode.insertBefore(this._node, this._anchor.nextSibling);\n\n\t\tif (this._areAnimatedItemsVisible)\n\t\t{\n\t\t\tconst stubContainer = this._stub.querySelector('.crm-entity-stream-section-content');\n\t\t\tsetTimeout(\n\t\t\t\tBX.delegate(function()\n\t\t\t\t{\n\t\t\t\t\tBX.removeClass(this._node, 'crm-entity-stream-section-animate-start');\n\t\t\t\t}, this),\n\t\t\t\t0\n\t\t\t);\n\n\t\t\tthis._node.style.opacity = 0;\n\n\t\t\tsetTimeout(BX.delegate(\n\t\t\t\tfunction()\n\t\t\t\t{\n\t\t\t\t\tstubContainer.style.height = 0;\n\t\t\t\t\tstubContainer.style.opacity = 0;\n\t\t\t\t\tstubContainer.style.paddingTop = 0;\n\t\t\t\t\tstubContainer.style.paddingBottom = 0;\n\t\t\t\t},\n\t\t\t\tthis\n\t\t\t), 120);\n\t\t}\n\t\tsetTimeout( BX.delegate(\n\t\t\tfunction() {\n\t\t\t\tif (this._areAnimatedItemsVisible)\n\t\t\t\t{\n\t\t\t\t\tBX.remove(this._stub);\n\t\t\t\t}\n\t\t\t\tBX.remove(this._node);\n\t\t\t\tthis.addHistoryItem();\n\n\t\t\t\tif(BX.type.isFunction(this._events[\"complete\"]))\n\t\t\t\t{\n\t\t\t\t\tthis._events[\"complete\"]();\n\t\t\t\t}\n\t\t\t},\n\t\t\tthis\n\t\t), 420 );\n\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new ItemNew();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import {Type, Dom} from 'main.core';\nimport Manager from \"./manager\";\nimport {Item, ConfigurableItem, StreamType} from 'crm.timeline.item';\nimport ItemAnimation from \"./animations/item\";\nimport ItemNew from \"./animations/item-new\";\nimport {TimezoneOffset} from \"crm.datetime\";\n\n/** @memberof BX.Crm.Timeline */\nexport default class Steam\n{\n\tconstructor()\n\t{\n\t\tthis._id = \"\";\n\t\tthis._settings = {};\n\t\tthis._container = null;\n\t\tthis._manager = null;\n\t\tthis._activityEditor = null;\n\n\t\tthis._timeFormat = \"\";\n\t\tthis._year = 0;\n\n\t\tthis._isStubMode = false;\n\t\tthis._userId = 0;\n\t\tthis._readOnly = false;\n\t\tthis._streamType = StreamType.history;\n\t\tthis._anchor = null;\n\n\t\tthis._serviceUrl = \"\";\n\t}\n\n\tinitialize(id, settings)\n\t{\n\t\tthis._id = BX.type.isNotEmptyString(id) ? id : BX.util.getRandomString(4);\n\t\tthis._settings = settings ? settings : {};\n\n\t\tthis._container = BX(this.getSetting(\"container\"));\n\t\tif (!BX.type.isElementNode(this._container))\n\t\t{\n\t\t\tthrow \"Timeline. Container node is not found.\";\n\t\t}\n\t\tthis._editorContainer = BX(this.getSetting(\"editorContainer\"));\n\t\tthis._manager = this.getSetting(\"manager\");\n\t\tif (!(this._manager instanceof Manager))\n\t\t{\n\t\t\tthrow \"Timeline. Manager instance is not found.\";\n\t\t}\n\n\t\t//\n\t\tconst datetimeFormat = BX.message(\"FORMAT_DATETIME\").replace(/:SS/, \"\");\n\t\tconst dateFormat = BX.message(\"FORMAT_DATE\");\n\t\tthis._timeFormat = BX.date.convertBitrixFormat(BX.util.trim(datetimeFormat.replace(dateFormat, \"\")));\n\t\t//\n\t\tthis._year = (new Date()).getFullYear();\n\n\t\tthis._activityEditor = this.getSetting(\"activityEditor\");\n\n\t\tthis._isStubMode = BX.prop.getBoolean(this._settings, \"isStubMode\", false);\n\t\tthis._readOnly = BX.prop.getBoolean(this._settings, \"readOnly\", false);\n\t\tthis._userId = BX.prop.getInteger(this._settings, \"userId\", 0);\n\t\tthis._serviceUrl = BX.prop.getString(this._settings, \"serviceUrl\", \"\");\n\n\t\tthis.doInitialize();\n\t}\n\n\tgetId()\n\t{\n\t\treturn this._id;\n\t}\n\n\tisScheduleStream(): boolean\n\t{\n\t\treturn this.getStreamType() === StreamType.scheduled;\n\t}\n\n\tisFixedHistoryStream(): boolean\n\t{\n\t\treturn this.getStreamType() === StreamType.pinned;\n\t}\n\n\tisHistoryStream(): boolean\n\t{\n\t\treturn this.getStreamType() === StreamType.history;\n\t}\n\n\tgetSetting(name, defaultval)\n\t{\n\t\treturn this._settings.hasOwnProperty(name) ? this._settings[name] : defaultval;\n\t}\n\n\tdoInitialize()\n\t{\n\t}\n\n\tlayout()\n\t{\n\t}\n\n\tisStubMode()\n\t{\n\t\treturn this._isStubMode;\n\t}\n\n\tisReadOnly()\n\t{\n\t\treturn this._readOnly;\n\t}\n\n\tgetUserId()\n\t{\n\t\treturn this._userId;\n\t}\n\n\tgetServiceUrl()\n\t{\n\t\treturn this._serviceUrl;\n\t}\n\n\tgetAnchor(): ?HTMLElement\n\t{\n\t\treturn this._anchor;\n\t}\n\n\tgetStreamType() {\n\t\treturn this._streamType;\n\t}\n\n\trefreshLayout()\n\t{\n\t}\n\n\tgetManager()\n\t{\n\t\treturn this._manager;\n\t}\n\n\tgetOwnerInfo()\n\t{\n\t\treturn this._manager.getOwnerInfo();\n\t}\n\n\treload()\n\t{\n\t\tconst currentUrl = this.getSetting(\"currentUrl\");\n\t\tconst ajaxId = this.getSetting(\"ajaxId\");\n\t\tif (ajaxId !== \"\")\n\t\t{\n\t\t\tBX.ajax.insertToNode(BX.util.add_url_param(currentUrl, {bxajaxid: ajaxId}), \"comp_\" + ajaxId);\n\t\t}\n\t\telse\n\t\t{\n\t\t\twindow.location = currentUrl;\n\t\t}\n\t}\n\n\tgetUserTimezoneOffset()\n\t{\n\t\treturn TimezoneOffset.USER_TO_SERVER;\n\t}\n\n\tgetServerTimezoneOffset()\n\t{\n\t\treturn TimezoneOffset.SERVER_TO_UTC;\n\t}\n\n\t// @todo replace by DatetimeConverter\n\tformatTime(time, now, utc)\n\t{\n\t\treturn BX.date.format(this._timeFormat, time, now, utc);\n\t}\n\n\t// @todo replace by DatetimeConverter\n\tformatDate(date)\n\t{\n\t\treturn (\n\t\t\tBX.date.format(\n\t\t\t\t[\n\t\t\t\t\t[\"today\", \"today\"],\n\t\t\t\t\t[\"tommorow\", \"tommorow\"],\n\t\t\t\t\t[\"yesterday\", \"yesterday\"],\n\t\t\t\t\t[\"\", (date.getFullYear() === this._year) ? \"j F\" : \"j F Y\"]\n\t\t\t\t],\n\t\t\t\tdate\n\t\t\t)\n\t\t);\n\t}\n\n\tcutOffText(text, length): string\n\t{\n\t\tif (!BX.type.isNumber(length))\n\t\t{\n\t\t\tlength = 0;\n\t\t}\n\n\t\tif (length <= 0 || text.length <= length)\n\t\t{\n\t\t\treturn text;\n\t\t}\n\n\t\tlet offset = length - 1;\n\t\tconst whitespaceOffset = text.substring(offset).search(/\\s/i);\n\t\tif (whitespaceOffset > 0)\n\t\t{\n\t\t\toffset += whitespaceOffset;\n\t\t}\n\t\treturn text.substring(0, offset) + \"...\";\n\t}\n\n\tgetItems(): Array\n\t{\n\t\treturn [];\n\t}\n\n\t/**\n\t * @abstract\n\t */\n\tsetItems(items: Array): void\n\t{\n\t\tthrow new Error('Stream.setItems() must be overridden');\n\t}\n\n\tgetLastItem(): ?Item\n\t{\n\t\tconst items = this.getItems();\n\n\t\treturn items.length > 0 ? items[items.length - 1] : null;\n\t}\n\n\tfindItemById(id): ?Item\n\t{\n\t\tid = id.toString();\n\n\t\treturn this.getItems().find(item => item.getId() === id) || null;\n\t}\n\n\tgetItemIndex(item: Item): number\n\t{\n\t\treturn this.getItems().findIndex((currentItem) => (currentItem === item));\n\t}\n\n\tremoveItemByIndex(index): void\n\t{\n\t\tconst items = this.getItems();\n\t\tif (index < items.length)\n\t\t{\n\t\t\titems.splice(index, 1);\n\t\t\tthis.setItems(items);\n\t\t}\n\t}\n\n\t/**\n\t * @abstract\n\t */\n\tcreateItem(data): Item\n\t{\n\t\tthrow new Error('Stream.createItem() must be overridden');\n\t}\n\n\tcreateItemCopy(item: Item): Item\n\t{\n\t\tif (item instanceof ConfigurableItem)\n\t\t{\n\t\t\treturn item.clone();\n\t\t}\n\n\t\treturn this.createItem(item.getData());\n\t}\n\n\trefreshItem(item: Item, animateUpdate: boolean = true, animateMove: true): Promise\n\t{\n\t\tconst index = this.getItemIndex(item);\n\t\tif(index < 0)\n\t\t{\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\tthis.removeItemByIndex(index);\n\n\t\tlet itemPositionChanged = false;\n\t\tlet newIndex = 0;\n\t\tlet newItem;\n\t\tif (this.isScheduleStream())\n\t\t{\n\t\t\tnewItem = this.createItemCopy(item);\n\t\t\tnewIndex = this.calculateItemIndex(newItem);\n\n\t\t\titemPositionChanged = newIndex !== index;\n\t\t}\n\n\t\tif(!itemPositionChanged)\n\t\t{\n\t\t\tthis.addItem(item, newIndex);\n\t\t\titem.refreshLayout();\n\t\t\tif (animateUpdate)\n\t\t\t{\n\t\t\t\treturn this.animateItemAdding(item);\n\t\t\t}\n\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\tconst anchor = this.createAnchor(newIndex);\n\t\tthis.addItem(newItem, newIndex);\n\t\tif (animateMove)\n\t\t{\n\t\t\tnewItem.layout({add: false});\n\n\t\t\treturn new Promise((resolve) => {\n\t\t\t\tconst animation = ItemAnimation.create(\n\t\t\t\t\t'',\n\t\t\t\t\t{\n\t\t\t\t\t\tinitialItem: item,\n\t\t\t\t\t\tfinalItem: newItem,\n\t\t\t\t\t\tanchor: anchor,\n\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\tcomplete: () => {\n\t\t\t\t\t\t\t\titem.destroy();\n\t\t\t\t\t\t\t\tresolve();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t\tanimation.run();\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tnewItem.layout({anchor: anchor});\n\t\t\titem.destroy();\n\n\t\t\treturn Promise.resolve();\n\t\t}\n\t}\n\n\tcalculateItemIndex(item: Item): Number\n\t{\n\t\treturn 0;\n\t}\n\n\tcreateAnchor(index): HTMLElement\n\t{\n\t\treturn null;\n\t}\n\n\t/**\n\t * @abstract\n\t */\n\taddItem(item: Item, index): void\n\t{\n\t\tthrow new Error('Stream.addItem() must be overridden');\n\t}\n\n\t/**\n\t * @abstract\n\t */\n\tdeleteItem(item: Item): void\n\t{\n\t\tthrow new Error('Stream.deleteItem() must be overridden');\n\t}\n\n\tdeleteItemAnimated(item: Item): void\n\t{\n\t\tif (!Type.isDomNode(item.getWrapper()))\n\t\t{\n\t\t\tthis.deleteItem(item);\n\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\treturn new Promise((resolve) => {\n\t\t\tconst wrapperPosition = Dom.getPosition(item.getWrapper());\n\n\t\t\tconst hideEvent = new BX.easing({\n\t\t\t\tduration: 1000,\n\t\t\t\tstart: {height: wrapperPosition.height, opacity: 1, marginBottom: 15},\n\t\t\t\tfinish: {height: 0, opacity: 0, marginBottom: 0},\n\t\t\t\ttransition: BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\t\tstep: (state) => {\n\t\t\t\t\tDom.style(item.getWrapper(), {\n\t\t\t\t\t\theight:  state.height + 'px',\n\t\t\t\t\t\topacity:  state.opacity,\n\t\t\t\t\t\tmarginBottom:  state.marginBottom,\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tcomplete: () => {\n\t\t\t\t\tthis.deleteItem(item)\n\t\t\t\t\tresolve();\n\t\t\t\t}\n\t\t\t});\n\n\t\t\thideEvent.animate();\n\t\t});\n\t}\n\n\tmoveItemToStream(item: Item, destinationStream: Steam, destinationItem: Item): void\n\t{\n\t\tthis.removeItemByIndex(this.getItemIndex(item));\n\t\tif (this.getItems().length > 0)\n\t\t{\n\t\t\tthis.refreshLayout();\n\t\t}\n\n\t\treturn new Promise((resolve) => {\n\t\t\tconst animation = ItemNew.create(\n\t\t\t\t'',\n\t\t\t\t{\n\t\t\t\t\tinitialItem: item,\n\t\t\t\t\tfinalItem: destinationItem,\n\t\t\t\t\tanchor: destinationStream.createAnchor(),\n\t\t\t\t\tevents: {complete: () => {\n\t\t\t\t\t\t\tthis.refreshLayout();\n\t\t\t\t\t\t\tdestinationStream.refreshLayout();\n\t\t\t\t\t\t\tresolve();\n\t\t\t\t\t\t}}\n\t\t\t\t}\n\t\t\t);\n\t\t\tanimation.run();\n\t\t});\n\t}\n\n\tanimateItemAdding(item): Promise\n\t{\n\t\treturn Promise.resolve();\n\t}\n}\n","import Stream from \"../stream\";\n\n/** @memberof BX.Crm.Timeline.Streams */\nexport default class EntityChat extends Stream\n{\n\tstatic LayoutType = {\n\t\tnone: 0,\n\t\tinvitation:  1,\n\t\tsummary: 2,\n\t}\n\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._data = null;\n\t\tthis._layoutType = EntityChat.LayoutType.none;\n\n\t\tthis._wrapper = null;\n\t\tthis._contentWrapper = null;\n\t\tthis._messageWrapper = null;\n\t\tthis._messageDateNode = null;\n\t\tthis._messageTexWrapper = null;\n\t\tthis._messageTextNode = null;\n\t\tthis._userWrapper = null;\n\t\tthis._extraUserCounter = null;\n\n\t\tthis._openChatHandler = BX.delegate(this.onOpenChat, this);\n\t}\n\n\tdoInitialize()\n\t{\n\t\tthis._data = BX.prop.getObject(this._settings, \"data\", {});\n\t}\n\n\tgetData()\n\t{\n\t\treturn this._data;\n\t}\n\n\tsetData(data)\n\t{\n\t\tthis._data = BX.type.isPlainObject(data) ? data : {};\n\t}\n\n\tisEnabled()\n\t{\n\t\treturn BX.prop.getBoolean(this._data, \"ENABLED\", true);\n\t}\n\n\t/**\n\t * @private\n\t * @return {boolean}\n\t */\n\tisRestricted()\n\t{\n\t\treturn BX.prop.getBoolean(this._data, \"IS_RESTRICTED\", false);\n\t}\n\n\t/**\n\t * @private\n\t * @return {void}\n\t */\n\tapplyLockScript()\n\t{\n\t\tconst lockScript = BX.prop.getString(this._data, \"LOCK_SCRIPT\", null);\n\t\tif (BX.Type.isString(lockScript) && lockScript !== '')\n\t\t{\n\t\t\teval(lockScript);\n\t\t}\n\t}\n\n\tgetChatId()\n\t{\n\t\treturn BX.prop.getInteger(this._data, \"CHAT_ID\", 0);\n\t}\n\n\tgetUserId()\n\t{\n\t\tconst userId = parseInt(top.BX.message(\"USER_ID\"));\n\t\treturn !isNaN(userId) ? userId : 0;\n\t}\n\n\tgetMessageData()\n\t{\n\t\treturn BX.prop.getObject(this._data, \"MESSAGE\", {});\n\t}\n\n\tsetMessageData(data)\n\t{\n\t\tthis._data[\"MESSAGE\"] = BX.type.isPlainObject(data) ? data : {};\n\t}\n\n\tgetUserInfoData()\n\t{\n\t\treturn BX.prop.getObject(this._data, \"USER_INFOS\", {});\n\t}\n\n\tsetUserInfoData(data)\n\t{\n\t\tthis._data[\"USER_INFOS\"] = BX.type.isPlainObject(data) ? data : {};\n\t}\n\n\thasUserInfo(userId)\n\t{\n\t\treturn userId > 0 && BX.type.isPlainObject(this.getUserInfoData()[userId]);\n\t}\n\n\tgetUserInfo(userId)\n\t{\n\t\tconst userInfos = this.getUserInfoData();\n\t\treturn userId > 0 && BX.type.isPlainObject(userInfos[userId]) ? userInfos[userId] : null;\n\t}\n\n\tremoveUserInfo(userId)\n\t{\n\t\tconst userInfos = this.getUserInfoData();\n\t\tif(userId > 0 && BX.type.isPlainObject(userInfos[userId]))\n\t\t{\n\t\t\tdelete userInfos[userId];\n\t\t}\n\t}\n\n\tsetUnreadMessageCounter(userId, counter)\n\t{\n\t\tconst userInfos = this.getUserInfoData();\n\t\tif(userId > 0 && BX.type.isPlainObject(userInfos[userId]))\n\t\t{\n\t\t\tuserInfos[userId][\"counter\"] = counter;\n\t\t}\n\t}\n\n\tlayout()\n\t{\n\t\tif(!this.isEnabled() || this.isStubMode())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis._wrapper = BX.create(\"div\", { props: { className: \"crm-entity-stream-section crm-entity-stream-section-live-im\" } });\n\t\tthis._container.appendChild(this._wrapper);\n\n\t\tthis._wrapper.appendChild(\n\t\t\tBX.create(\"div\", { props: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-live-im\" } })\n\t\t);\n\n\t\tthis._contentWrapper = BX.create(\"div\", { props: { className: \"crm-entity-stream-content-live-im-detail\" } });\n\n\t\tthis._wrapper.appendChild(\n\t\t\tBX.create(\"div\",\n\t\t\t\t{\n\t\t\t\t\tprops: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"div\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tprops: { className: \"crm-entity-stream-content-event\" },\n\t\t\t\t\t\t\t\t\tchildren: [ this._contentWrapper ]\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tthis._userWrapper = BX.create(\"div\", { props: { className: \"crm-entity-stream-live-im-user-avatars\" } });\n\t\tthis._contentWrapper.appendChild(\n\t\t\tBX.create(\"div\",\n\t\t\t\t{\n\t\t\t\t\tprops: { className: \"crm-entity-stream-live-im-users\" },\n\t\t\t\t\tchildren: [ this._userWrapper ]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tthis._extraUserCounter = BX.create(\"div\",{ props: { className: \"crm-entity-stream-live-im-user-counter\" } });\n\t\tthis._contentWrapper.appendChild(this._extraUserCounter);\n\n\t\tthis._layoutType = EntityChat.LayoutType.none;\n\t\tif(this.getChatId() > 0)\n\t\t{\n\t\t\tthis.renderSummary();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.renderInvitation();\n\t\t}\n\n\t\tBX.bind(this._contentWrapper, \"click\", this._openChatHandler);\n\t\tBX.addCustomEvent(\"onPullEvent-im\", this.onChatEvent.bind(this));\n\t}\n\n\trefreshLayout()\n\t{\n\t\tBX.cleanNode(this._contentWrapper);\n\t\tthis._userWrapper = BX.create(\"div\", { props: { className: \"crm-entity-stream-live-im-user-avatars\" } });\n\t\tthis._contentWrapper.appendChild(\n\t\t\tBX.create(\"div\",\n\t\t\t\t{\n\t\t\t\t\tprops: { className: \"crm-entity-stream-live-im-users\" },\n\t\t\t\t\tchildren: [ this._userWrapper ]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tthis._extraUserCounter = BX.create(\"div\",{ props: { className: \"crm-entity-stream-live-im-user-counter\" } });\n\t\tthis._contentWrapper.appendChild(this._extraUserCounter);\n\n\t\tthis._layoutType = EntityChat.LayoutType.none;\n\t\tif(this.getChatId() > 0)\n\t\t{\n\t\t\tthis.renderSummary();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.renderInvitation();\n\t\t}\n\t}\n\n\trenderInvitation()\n\t{\n\t\tthis._layoutType = EntityChat.LayoutType.invitation;\n\t\tthis.refreshUsers();\n\n\t\tthis._messageTextNode = BX.create(\"div\", { props: { className: \"crm-entity-stream-live-im-user-invite-text\" } });\n\t\tthis._contentWrapper.appendChild(this._messageTextNode);\n\n\t\tthis._messageTextNode.innerHTML = this.getMessage(\"invite\");\n\t}\n\n\trenderSummary()\n\t{\n\t\tthis._layoutType = EntityChat.LayoutType.summary;\n\t\tthis.refreshUsers();\n\n\t\tthis._contentWrapper.appendChild(\n\t\t\tBX.create(\"div\", { props: { className: \"crm-entity-stream-live-im-separator\" } })\n\t\t);\n\n\t\tthis._messageWrapper = BX.create(\"div\", { props: { className: \"crm-entity-stream-live-im-messanger\" } });\n\t\tthis._contentWrapper.appendChild(this._messageWrapper);\n\n\t\tthis._messageDateNode = BX.create(\"div\", { props: { className: \"crm-entity-stream-live-im-time\" } });\n\t\tthis._messageWrapper.appendChild(this._messageDateNode);\n\n\t\tthis._messageTexWraper = BX.create(\"div\", { props: { className: \"crm-entity-stream-live-im-message\" } });\n\t\tthis._messageWrapper.appendChild(this._messageTexWraper);\n\n\t\tthis._messageTextNode = BX.create(\"div\", { props: { className: \"crm-entity-stream-live-im-message-text\" } });\n\t\tthis._messageTexWraper.appendChild(this._messageTextNode);\n\n\t\tthis._messageCounterNode = BX.create(\"div\", { props: { className: \"crm-entity-stream-live-im-message-counter\" } });\n\t\tthis._messageWrapper.appendChild(this._messageCounterNode);\n\n\t\tthis.refreshSummary();\n\t}\n\n\trefreshUsers()\n\t{\n\t\tBX.cleanNode(this._userWrapper);\n\n\t\tconst infos = this.getUserInfoData();\n\t\tconst list = Object.values(infos);\n\n\t\tif(list.length === 0)\n\t\t{\n\t\t\tthis._userWrapper.appendChild(\n\t\t\t\tBX.create(\"span\",\n\t\t\t\t\t{\n\t\t\t\t\t\tprops: { className: \"crm-entity-stream-live-im-user-avatar ui-icon ui-icon-common-user\" },\n\t\t\t\t\t\tchildren: [ BX.create(\"i\") ]\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst count = list.length >= 3 ? 3 : list.length;\n\t\t\tfor(let i = 0; i < count; i++)\n\t\t\t{\n\t\t\t\tconst info = list[i];\n\n\t\t\t\tconst icon = BX.create(\"i\");\n\t\t\t\tconst imageUrl = BX.prop.getString(info, \"avatar\", \"\");\n\t\t\t\tif(imageUrl !== \"\")\n\t\t\t\t{\n\t\t\t\t\ticon.style.backgroundImage = \"url(\" +  encodeURI(imageUrl) + \")\";\n\t\t\t\t}\n\n\t\t\t\tthis._userWrapper.appendChild(\n\t\t\t\t\tBX.create(\"span\",\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tprops: { className: \"crm-entity-stream-live-im-user-avatar ui-icon ui-icon-common-user\" },\n\t\t\t\t\t\t\tchildren: [ icon ]\n\t\t\t\t\t\t}\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\tif(this._layoutType === EntityChat.LayoutType.summary)\n\t\t{\n\t\t\tif(list.length > 3)\n\t\t\t{\n\t\t\t\tthis._extraUserCounter.display = \"\";\n\t\t\t\tthis._extraUserCounter.innerHTML = \"+\" + (list.length - 3).toString();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif(this._extraUserCounter.innerHTML !== \"\")\n\t\t\t\t{\n\t\t\t\t\tthis._extraUserCounter.innerHTML = \"\";\n\t\t\t\t}\n\t\t\t\tthis._extraUserCounter.display = \"none\";\n\t\t\t}\n\t\t}\n\t\telse //if(this._layoutType === EntityChat.LayoutType.invitation)\n\t\t{\n\t\t\tif(this._extraUserCounter.innerHTML !== \"\")\n\t\t\t{\n\t\t\t\tthis._extraUserCounter.innerHTML = \"\";\n\t\t\t}\n\t\t\tthis._extraUserCounter.display = \"none\";\n\n\t\t\tthis._userWrapper.appendChild(\n\t\t\t\tBX.create(\"span\", { props: { className: \"crm-entity-stream-live-im-user-invite-btn\" } })\n\t\t\t);\n\t\t}\n\t}\n\n\trefreshSummary()\n\t{\n\t\tif(this._layoutType !== EntityChat.LayoutType.summary)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst message = this.getMessageData();\n\n\t\t//region Message Date\n\t\tconst isoDate = BX.prop.getString(message, \"date\", \"\");\n\t\tif(isoDate === \"\")\n\t\t{\n\t\t\tthis._messageDateNode.innerHTML = \"\";\n\t\t}\n\t\telse\n\t\t{\n\t\t\t// @todo replace by DatetimeConverter\n\t\t\tconst remoteDate = (new Date(isoDate)).getTime() / 1000 + this.getServerTimezoneOffset() + this.getUserTimezoneOffset();\n\t\t\tconst localTime = (new Date).getTime() / 1000 + this.getServerTimezoneOffset() + this.getUserTimezoneOffset();\n\t\t\tthis._messageDateNode.innerHTML = this.formatTime(remoteDate, localTime, true);\n\t\t}\n\t\t//endregion\n\n\t\t//region Message Text\n\t\tlet text = BX.prop.getString(message, \"text\", \"\");\n\t\tconst params = BX.prop.getObject(message, \"params\", {});\n\t\tif(text === \"\")\n\t\t{\n\t\t\tthis._messageTextNode.innerHTML = \"\";\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif(typeof(top.BX.MessengerCommon) !== \"undefined\")\n\t\t\t{\n\t\t\t\ttext = top.BX.MessengerCommon.purifyText(text, params);\n\t\t\t}\n\t\t\tthis._messageTextNode.innerHTML = text;\n\t\t}\n\t\t//endregion\n\n\t\t//region Unread Message Counter\n\t\tlet counter = 0;\n\t\tconst userId = this.getUserId();\n\t\tif(userId > 0)\n\t\t{\n\t\t\tcounter = BX.prop.getInteger(\n\t\t\t\tBX.prop.getObject(\n\t\t\t\t\tBX.prop.getObject(this._data, \"USER_INFOS\", {}),\n\t\t\t\t\tuserId,\n\t\t\t\t\tnull\n\t\t\t\t),\n\t\t\t\t\"counter\",\n\t\t\t\t0\n\t\t\t);\n\t\t}\n\n\t\tthis._messageCounterNode.innerHTML = counter.toString();\n\t\tthis._messageCounterNode.style.display = counter > 0 ? \"\" : \"none\";\n\t\t//endregion\n\t}\n\n\trefreshUsersAnimated()\n\t{\n\t\tBX.removeClass(this._userWrapper, 'crm-entity-stream-live-im-message-show');\n\t\tBX.addClass(this._userWrapper, 'crm-entity-stream-live-im-message-hide');\n\n\t\twindow.setTimeout(\n\t\t\tfunction()\n\t\t\t{\n\t\t\t\tthis.refreshUsers();\n\t\t\t\twindow.setTimeout(\n\t\t\t\t\tfunction()\n\t\t\t\t\t{\n\t\t\t\t\t\tBX.removeClass(this._userWrapper, 'crm-entity-stream-live-im-message-hide');\n\t\t\t\t\t\tBX.addClass(this._userWrapper, 'crm-entity-stream-live-im-message-show');\n\t\t\t\t\t}.bind(this),\n\t\t\t\t\t50\n\t\t\t\t);\n\t\t\t}.bind(this),\n\t\t\t500\n\t\t);\n\t}\n\n\trefreshSummaryAnimated()\n\t{\n\t\tBX.removeClass(this._messageWrapper, 'crm-entity-stream-live-im-message-show');\n\t\tBX.addClass(this._messageWrapper, 'crm-entity-stream-live-im-message-hide');\n\n\t\twindow.setTimeout(\n\t\t\tfunction()\n\t\t\t{\n\t\t\t\tthis.refreshSummary();\n\t\t\t\twindow.setTimeout(\n\t\t\t\t\tfunction()\n\t\t\t\t\t{\n\t\t\t\t\t\tBX.removeClass(this._messageWrapper, 'crm-entity-stream-live-im-message-hide');\n\t\t\t\t\t\tBX.addClass(this._messageWrapper, 'crm-entity-stream-live-im-message-show');\n\t\t\t\t\t}.bind(this),\n\t\t\t\t\t50\n\t\t\t\t);\n\t\t\t}.bind(this),\n\t\t\t500\n\t\t);\n\t}\n\n\tonOpenChat(e)\n\t{\n\t\tif(typeof(top.BXIM) === \"undefined\")\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.isRestricted())\n\t\t{\n\t\t\tthis.applyLockScript();\n\n\t\t\treturn;\n\t\t}\n\n\t\tlet slug = \"\";\n\n\t\tconst chatId = this.getChatId();\n\t\tif(chatId > 0 && this.hasUserInfo(this.getUserId()))\n\t\t{\n\t\t\tslug = \"chat\" + chatId.toString();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst ownerInfo = this.getOwnerInfo();\n\t\t\tconst entityId = BX.prop.getInteger(ownerInfo, \"ENTITY_ID\", 0);\n\t\t\tconst entityTypeName = BX.prop.getString(ownerInfo, \"ENTITY_TYPE_NAME\", \"\");\n\n\t\t\tif(entityTypeName !== \"\" && entityId > 0)\n\t\t\t{\n\t\t\t\tslug = \"crm|\" + entityTypeName + \"|\" + entityId.toString();\n\t\t\t}\n\t\t}\n\n\t\tif(slug !== \"\")\n\t\t{\n\t\t\ttop.BXIM.openMessengerSlider(slug, { RECENT: \"N\", MENU: \"N\" });\n\t\t}\n\t}\n\n\tonChatEvent(command, params, extras)\n\t{\n\t\tconst chatId = this.getChatId();\n\t\tif(chatId <= 0 || chatId !== BX.prop.getInteger(params, \"chatId\", 0))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif(command === \"chatUserAdd\")\n\t\t{\n\t\t\tthis.setUserInfoData(BX.mergeEx(this.getUserInfoData(), BX.prop.getObject(params, \"users\", {})));\n\t\t\tthis.refreshUsersAnimated();\n\t\t}\n\t\telse if(command === \"chatUserLeave\")\n\t\t{\n\t\t\tthis.removeUserInfo(BX.prop.getInteger(params, \"userId\", 0));\n\t\t\tthis.refreshUsersAnimated();\n\t\t}\n\t\telse if(command === \"messageChat\")\n\t\t{\n\t\t\t//Message was added.\n\t\t\tthis.setMessageData(BX.prop.getObject(params, \"message\", {}));\n\t\t\tthis.setUnreadMessageCounter(this.getUserId(), BX.prop.getInteger(params, \"counter\", 0));\n\t\t\tthis.refreshSummaryAnimated();\n\t\t}\n\t\telse if(command === \"messageUpdate\" || command === \"messageDelete\")\n\t\t{\n\t\t\t//Message was modified or removed.\n\t\t\tif(command === \"messageDelete\")\n\t\t\t{\n\t\t\t\t//HACK: date is not in ISO format\n\t\t\t\tdelete params[\"date\"];\n\t\t\t}\n\n\t\t\tconst message = this.getMessageData();\n\t\t\tif(BX.prop.getInteger(message, \"id\", 0) === BX.prop.getInteger(params, \"id\", 0))\n\t\t\t{\n\t\t\t\tthis.setMessageData(BX.mergeEx(message, params));\n\t\t\t\tthis.refreshSummaryAnimated();\n\t\t\t}\n\t\t}\n\t\telse if(command === \"readMessageChat\")\n\t\t{\n\t\t\tthis.setUnreadMessageCounter(this.getUserId(), 0);\n\t\t\tthis.refreshSummaryAnimated();\n\t\t}\n\t\telse if(command === \"unreadMessageChat\")\n\t\t{\n\t\t\tthis.setUnreadMessageCounter(this.getUserId(), BX.prop.getInteger(params, \"counter\", 0));\n\t\t\tthis.refreshSummaryAnimated();\n\t\t}\n\t}\n\n\tgetMessage(name)\n\t{\n\t\treturn BX.prop.getString(EntityChat.messages, name, name);\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new EntityChat();\n\t\tself.initialize(id, settings);\n\t\tEntityChat.items[self.getId()] = self;\n\t\treturn self;\n\t}\n\n\tstatic items = {};\n\tstatic messages = {};\n}\n","import Manager from \"../manager\";\n\n/** @memberof BX.Crm.Timeline.Tools */\nexport default class MenuBar\n{\n\tconstructor()\n\t{\n\t\tthis._id = \"\";\n\t\tthis._ownerInfo = null;\n\t\tthis._container = null;\n\t\tthis._activityEditor = null;\n\t\tthis._commentEditor = null;\n\t\tthis._todoEditor = null;\n\t\tthis._waitEditor = null;\n\t\tthis._smsEditor = null;\n\t\tthis._zoomEditor = null;\n\t\tthis._readOnly = false;\n\n\t\tthis._menu = null;\n\t\tthis._manager = null;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new MenuBar();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n\n\tinitialize(id, settings)\n\t{\n\t\tthis._id = BX.type.isNotEmptyString(id) ? id : BX.util.getRandomString(4);\n\t\tthis._settings = settings ? settings : {};\n\n\t\tthis._ownerInfo = BX.prop.getObject(this._settings, \"ownerInfo\");\n\t\tif (!this._ownerInfo)\n\t\t{\n\t\t\tthrow \"MenuBar. A required parameter 'ownerInfo' is missing.\";\n\t\t}\n\n\t\tthis._activityEditor = BX.prop.get(this._settings, \"activityEditor\", null);\n\n\t\tthis._commentEditor = BX.prop.get(this._settings, \"commentEditor\");\n\t\tthis._todoEditor = BX.prop.get(this._settings, \"todoEditor\");\n\t\tthis._waitEditor = BX.prop.get(this._settings, \"waitEditor\");\n\t\tthis._smsEditor = BX.prop.get(this._settings, \"smsEditor\");\n\t\tthis._zoomEditor = BX.prop.get(this._settings, \"zoomEditor\");\n\t\tthis._restEditor = BX.prop.get(this._settings, \"restEditor\");\n\t\tthis._manager = BX.prop.get(this._settings, \"manager\");\n\n\t\tif (!(this._manager instanceof Manager))\n\t\t{\n\t\t\tthrow \"BX.CrmTimeline. Manager instance is not found.\";\n\t\t}\n\n\t\tthis._readOnly = BX.prop.getBoolean(this._settings, \"readOnly\", false);\n\t\tthis._menu = BX.Main.interfaceButtonsManager.getById(\n\t\t\tBX.prop.getString(this._settings, \"menuId\", (this._ownerInfo['ENTITY_TYPE_NAME'] + \"_menu\").toLowerCase())\n\t\t);\n\n\t\tBX.addCustomEvent(this._manager.getId() + \"_menu\", function (id) {\n\t\t\tthis.setActiveItemById(id);\n\t\t}.bind(this));\n\t\tthis._activeItem = this._menu.getActive();\n\t}\n\n\treset()\n\t{\n\t\tlet firstId = null;\n\t\tthis._menu.getAllItems().forEach(function (item) {\n\t\t\tif (firstId === null)\n\t\t\t{\n\t\t\t\tconst id = item.dataset.id;\n\t\t\t\tif (['comment', 'wait', 'sms', 'zoom', 'todo'].indexOf(id) >= 0 && this[(\"_\" + id + \"Editor\")])\n\t\t\t\t{\n\t\t\t\t\tfirstId = id;\n\t\t\t\t}\n\t\t\t}\n\t\t}.bind(this));\n\t\tthis.setActiveItemById(firstId || 'todo');\n\t}\n\n\tgetId()\n\t{\n\t\treturn this._id;\n\t}\n\n\tgetActiveItem()\n\t{\n\t\treturn this._activeItem;\n\t}\n\n\tgetTodoEditor()\n\t{\n\t\treturn this._todoEditor;\n\t}\n\n\tsetActiveItemById(id)\n\t{\n\t\tif (this.processItemSelection(id) === true)\n\t\t{\n\t\t\tconst currentDiv = this._menu.getItemById(id);\n\t\t\tif (currentDiv && this._activeItem !== currentDiv)\n\t\t\t{\n\t\t\t\tconst wasActiveInMoreMenu = this._menu.isActiveInMoreMenu();\n\t\t\t\tBX.addClass(currentDiv, this._menu.classes.itemActive);\n\n\t\t\t\tif (this._menu.getItemData)\n\t\t\t\t{\n\t\t\t\t\tconst currentDivData = this._menu.getItemData(currentDiv);\n\t\t\t\t\tcurrentDivData['IS_ACTIVE'] = true;\n\t\t\t\t\tif (BX.type.isDomNode(this._activeItem))\n\t\t\t\t\t{\n\t\t\t\t\t\tBX.removeClass(this._activeItem, this._menu.classes.itemActive);\n\t\t\t\t\t\tconst activeItemData = this._menu.getItemData(this._activeItem);\n\t\t\t\t\t\tactiveItemData['IS_ACTIVE'] = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\t// Old approach\n\t\t\t\t\tlet isActiveData = {};\n\t\t\t\t\ttry\n\t\t\t\t\t{\n\t\t\t\t\t\tisActiveData = JSON.parse(currentDiv.dataset.item);\n\t\t\t\t\t}\n\t\t\t\t\tcatch (err)\n\t\t\t\t\t{\n\t\t\t\t\t\tisActiveData = {};\n\t\t\t\t\t}\n\t\t\t\t\tisActiveData.IS_ACTIVE = true;\n\t\t\t\t\tcurrentDiv.dataset.item = JSON.stringify(isActiveData);\n\t\t\t\t\tlet wasActiveData = {};\n\t\t\t\t\tif (BX.type.isDomNode(this._activeItem))\n\t\t\t\t\t{\n\t\t\t\t\t\tBX.removeClass(this._activeItem, this._menu.classes.itemActive);\n\t\t\t\t\t\ttry\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\twasActiveData = JSON.parse(this._activeItem.dataset.item);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcatch (err)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\twasActiveData = {};\n\t\t\t\t\t\t}\n\t\t\t\t\t\twasActiveData.IS_ACTIVE = false;\n\t\t\t\t\t\tthis._activeItem.dataset.item = JSON.stringify(wasActiveData);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tconst isActiveInMoreMenu = this._menu.isActiveInMoreMenu();\n\t\t\t\tif (isActiveInMoreMenu || wasActiveInMoreMenu)\n\t\t\t\t{\n\t\t\t\t\tconst submenu = this._menu[\"getSubmenu\"] ? this._menu.getSubmenu() :\n\t\t\t\t\t\tBX.PopupMenu.getMenuById(\"main_buttons_popup_\" +\n\t\t\t\t\t\t\tString(this._ownerInfo['ENTITY_TYPE_NAME']).toLowerCase() + \"_menu\");\n\t\t\t\t\tif (submenu)\n\t\t\t\t\t{\n\t\t\t\t\t\tsubmenu.getMenuItems().forEach(function (menuItem) {\n\t\t\t\t\t\t\tconst container = menuItem.getContainer();\n\t\t\t\t\t\t\tif (isActiveInMoreMenu && container.title === currentDiv.title)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tBX.addClass(container, this._menu.classes.itemActive);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse if (wasActiveInMoreMenu && container.title === this._activeItem.title)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tBX.removeClass(container, this._menu.classes.itemActive);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}.bind(this));\n\t\t\t\t\t}\n\n\t\t\t\t\tif (isActiveInMoreMenu)\n\t\t\t\t\t{\n\t\t\t\t\t\tBX.addClass(this._menu.getMoreButton(), this._menu.classes.itemActive);\n\t\t\t\t\t}\n\t\t\t\t\telse if (wasActiveInMoreMenu)\n\t\t\t\t\t{\n\t\t\t\t\t\tBX.removeClass(this._menu.getMoreButton(), this._menu.classes.itemActive);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis._activeItem = currentDiv;\n\t\t\t}\n\t\t}\n\t\tthis._menu.closeSubmenu();\n\t}\n\n\tprocessItemSelection(menuId)\n\t{\n\t\tif (this._readOnly)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tlet planner = null;\n\t\tconst action = menuId;\n\t\tif (action === \"call\")\n\t\t{\n\t\t\tplanner = new BX.Crm.Activity.Planner();\n\t\t\tplanner.showEdit(\n\t\t\t\t{\n\t\t\t\t\t\"TYPE_ID\": BX.CrmActivityType.call,\n\t\t\t\t\t\"OWNER_TYPE_ID\": this._ownerInfo['ENTITY_TYPE_ID'],\n\t\t\t\t\t\"OWNER_ID\": this._ownerInfo['ENTITY_ID']\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\tif (action === \"meeting\")\n\t\t{\n\t\t\tplanner = new BX.Crm.Activity.Planner();\n\t\t\tplanner.showEdit(\n\t\t\t\t{\n\t\t\t\t\t\"TYPE_ID\": BX.CrmActivityType.meeting,\n\t\t\t\t\t\"OWNER_TYPE_ID\": this._ownerInfo['ENTITY_TYPE_ID'],\n\t\t\t\t\t\"OWNER_ID\": this._ownerInfo['ENTITY_ID']\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (action === \"email\")\n\t\t{\n\t\t\tthis._activityEditor.addEmail(\n\t\t\t\t{\n\t\t\t\t\t\"ownerType\": this._ownerInfo['ENTITY_TYPE_NAME'],\n\t\t\t\t\t\"ownerID\": this._ownerInfo['ENTITY_ID'],\n\t\t\t\t\t\"ownerUrl\": this._ownerInfo['SHOW_URL'],\n\t\t\t\t\t\"ownerTitle\": this._ownerInfo['TITLE'],\n\t\t\t\t\t\"subject\": \"\"\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (action === \"delivery\")\n\t\t{\n\t\t\tthis._activityEditor.addDelivery(\n\t\t\t\t{\n\t\t\t\t\t\"ownerType\": this._ownerInfo['ENTITY_TYPE_NAME'],\n\t\t\t\t\t\"ownerID\": this._ownerInfo['ENTITY_ID'],\n\t\t\t\t\t\"orderList\": this._ownerInfo['ORDER_LIST']\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (action === \"task\")\n\t\t{\n\t\t\tthis._activityEditor.addTask(\n\t\t\t\t{\n\t\t\t\t\t\"ownerType\": this._ownerInfo['ENTITY_TYPE_NAME'],\n\t\t\t\t\t\"ownerID\": this._ownerInfo['ENTITY_ID']\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (['comment', 'wait', 'sms', 'zoom', 'todo'].indexOf(action) >= 0 && this[(\"_\" + action + \"Editor\")])\n\t\t{\n\t\t\tif (this._commentEditor)\n\t\t\t{\n\t\t\t\tthis._commentEditor.setVisible(action === \"comment\");\n\t\t\t}\n\t\t\tif (this._todoEditor)\n\t\t\t{\n\t\t\t\tthis._todoEditor.setVisible(action === 'todo');\n\t\t\t}\n\t\t\tif (this._waitEditor)\n\t\t\t{\n\t\t\t\tthis._waitEditor.setVisible(action === \"wait\");\n\t\t\t}\n\t\t\tif (this._smsEditor)\n\t\t\t{\n\t\t\t\tthis._smsEditor.setVisible(action === \"sms\");\n\t\t\t}\n\t\t\tif (this._zoomEditor)\n\t\t\t{\n\t\t\t\tthis._zoomEditor.setVisible(action === \"zoom\");\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\t\telse if (action === \"visit\")\n\t\t{\n\t\t\tconst visitParameters = this._manager.getSetting(\"visitParameters\");\n\t\t\tvisitParameters['OWNER_TYPE'] = this._ownerInfo['ENTITY_TYPE_NAME'];\n\t\t\tvisitParameters['OWNER_ID'] = this._ownerInfo['ENTITY_ID'];\n\t\t\tBX.CrmActivityVisit.create(visitParameters).showEdit();\n\t\t}\n\t\telse if (action.match(/^activity_rest_/))\n\t\t{\n\t\t\tif (this._restEditor)\n\t\t\t{\n\t\t\t\tthis._restEditor.action(action);\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n}\n","/** @memberof BX.Crm.Timeline.Tools */\nexport default class AudioPlaybackRateSelector\n{\n\tconstructor(params)\n\t{\n\t\tthis.name = params.name || 'crm-timeline-audio-playback-rate-selector';\n\t\tthis.menuId = this.name + '-menu';\n\t\tif(BX.Type.isArray(params.availableRates))\n\t\t{\n\t\t\tthis.availableRates = params.availableRates;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.availableRates = [1, 1.5, 2, 3];\n\t\t}\n\t\tthis.currentRate = this.normalizeRate(params.currentRate);\n\t\tthis.textMessageCode = params.textMessageCode;\n\t\tthis.renderedItems = [];\n\t\tthis.players = [];\n\t}\n\n\tisRateCurrent(rateDescription, rate)\n\t{\n\t\treturn ((rateDescription.rate && rate === rateDescription.rate) || rate === rateDescription);\n\t}\n\n\tnormalizeRate(rate)\n\t{\n\t\trate = parseFloat(rate);\n\t\tlet i = 0;\n\t\tconst length = this.availableRates.length;\n\t\tfor(; i < length; i++)\n\t\t{\n\t\t\tif(this.isRateCurrent(this.availableRates[i], rate))\n\t\t\t{\n\t\t\t\treturn rate;\n\t\t\t}\n\t\t}\n\n\t\treturn (this.availableRates[0].rate || this.availableRates[0]);\n\t}\n\n\tgetMenuItems()\n\t{\n\t\tconst selectedRate = this.getRate();\n\n\t\treturn this.availableRates.map(function(item) {\n\t\t\treturn {\n\t\t\t\ttext: (item.text || item) + '',\n\t\t\t\thtml: (item.html || item) + '',\n\t\t\t\tclassName: (this.isRateCurrent(item, selectedRate)) ? 'menu-popup-item-text-active' : null,\n\t\t\t\tonclick: function() {\n\t\t\t\t\tthis.setRate(item.rate || item)\n\t\t\t\t}.bind(this)\n\t\t\t}\n\t\t}.bind(this))\n\t}\n\n\tgetPopup(node)\n\t{\n\t\tlet popupMenu = BX.Main.MenuManager.getMenuById(this.menuId);\n\t\tif(popupMenu)\n\t\t{\n\t\t\tconst popupWindow = popupMenu.getPopupWindow();\n\t\t\tif (popupWindow)\n\t\t\t{\n\t\t\t\tpopupWindow.setBindElement(node);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tpopupMenu = BX.Main.MenuManager.create({\n\t\t\t\tid: this.menuId,\n\t\t\t\tbindElement: node,\n\t\t\t\titems: this.getMenuItems(),\n\t\t\t\tclassName: 'crm-audio-cap-speed-popup'\n\t\t\t});\n\t\t}\n\n\t\treturn popupMenu;\n\t}\n\n\tgetRate()\n\t{\n\t\treturn this.normalizeRate(this.currentRate);\n\t}\n\n\tsetRate(rate)\n\t{\n\t\tthis.getPopup().destroy();\n\n\t\trate = this.normalizeRate(rate);\n\t\tif(this.currentRate === rate)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tthis.currentRate = rate;\n\t\tBX.userOptions.save(\"crm\", this.name, 'rate', rate);\n\n\t\tfor(let i = 0, length = this.renderedItems.length; i < length; i++)\n\t\t{\n\t\t\tconst textNode = this.renderedItems[i].querySelector('.crm-audio-cap-speed-text');\n\t\t\tif(textNode)\n\t\t\t{\n\t\t\t\ttextNode.innerHTML = this.getText();\n\t\t\t}\n\t\t}\n\n\t\tfor(let i = 0, length = this.players.length; i < length; i++)\n\t\t{\n\t\t\tthis.players[i].vjsPlayer.playbackRate(this.getRate());\n\t\t}\n\t}\n\n\tgetText()\n\t{\n\t\tlet text;\n\n\t\tif(this.textMessageCode)\n\t\t{\n\t\t\ttext = BX.Loc.getMessage(this.textMessageCode);\n\t\t}\n\t\tif(!text)\n\t\t{\n\t\t\ttext = '#RATE#';\n\t\t}\n\n\t\treturn text.replace('#RATE#', '<span>' + this.getRate() + 'x</span>');\n\t}\n\n\trender()\n\t{\n\t\tconst item = BX.Dom.create('div', {\n\t\t\tattrs: {\n\t\t\t\tclassName: 'crm-audio-cap-speed-wrapper'\n\t\t\t},\n\t\t\tchildren: [\n\t\t\t\tBX.Dom.create('div', {\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\tclassName: 'crm-audio-cap-speed',\n\t\t\t\t\t},\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tBX.Dom.create('div', {\n\t\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\t\tclassName: 'crm-audio-cap-speed-text'\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\thtml: this.getText()\n\t\t\t\t\t\t})\n\t\t\t\t\t],\n\t\t\t\t})\n\t\t\t],\n\t\t\tevents: {\n\t\t\t\tclick: function (event) {\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tthis.getPopup(event.target).show()\n\t\t\t\t}.bind(this)\n\t\t\t}\n\t\t});\n\t\tthis.renderedItems.push(item);\n\n\t\treturn item;\n\t}\n\n\taddPlayer(player)\n\t{\n\t\tif(BX.Fileman.Player && player instanceof BX.Fileman.Player)\n\t\t{\n\t\t\tthis.players.push(player);\n\t\t}\n\t}\n}\n","/** @memberof BX.Crm.Timeline.Tools */\nexport default class SchedulePostponeController\n{\n\tconstructor()\n\t{\n\t\tthis._item = null;\n\t}\n\n\tinitialize(id, settings)\n\t{\n\t\tthis._id = BX.type.isNotEmptyString(id) ? id : BX.util.getRandomString(4);\n\t\tthis._settings = settings ? settings : {};\n\t\tthis._item = BX.prop.get(this._settings, \"item\", null);\n\t}\n\n\tgetTitle()\n\t{\n\t\treturn this.getMessage(\"title\");\n\t}\n\n\tgetCommandList()\n\t{\n\t\treturn(\n\t\t\t[\n\t\t\t\t{ name: \"postpone_hour_1\", title: this.getMessage(\"forOneHour\") },\n\t\t\t\t{ name: \"postpone_hour_2\", title: this.getMessage(\"forTwoHours\") },\n\t\t\t\t{ name: \"postpone_hour_3\", title: this.getMessage(\"forThreeHours\") },\n\t\t\t\t{ name: \"postpone_day_1\", title: this.getMessage(\"forOneDay\") },\n\t\t\t\t{ name: \"postpone_day_2\", title: this.getMessage(\"forTwoDays\") },\n\t\t\t\t{ name: \"postpone_day_3\", title: this.getMessage(\"forThreeDays\") }\n\t\t\t]\n\t\t);\n\t}\n\n\tprocessCommand(command)\n\t{\n\t\tif(command.indexOf(\"postpone\") !== 0)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tlet offset = 0;\n\t\tif(command === \"postpone_hour_1\")\n\t\t{\n\t\t\toffset = 3600;\n\t\t}\n\t\telse if(command === \"postpone_hour_2\")\n\t\t{\n\t\t\toffset = 7200;\n\t\t}\n\t\telse if(command === \"postpone_hour_3\")\n\t\t{\n\t\t\toffset = 10800;\n\t\t}\n\t\telse if(command === \"postpone_day_1\")\n\t\t{\n\t\t\toffset = 86400;\n\t\t}\n\t\telse if(command === \"postpone_day_2\")\n\t\t{\n\t\t\toffset = 172800;\n\t\t}\n\t\telse if(command === \"postpone_day_3\")\n\t\t{\n\t\t\toffset = 259200;\n\t\t}\n\n\t\tif(offset > 0 && this._item)\n\t\t{\n\t\t\tthis._item.postpone(offset);\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = SchedulePostponeController.messages;\n\t\treturn m.hasOwnProperty(name) ? m[name] : name;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new SchedulePostponeController();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n\n\tstatic messages = {};\n}\n","import Scheduled from \"../scheduled\";\nimport {Item as ItemType} from \"../../types\";\nimport SchedulePostponeController from \"../../tools/schedule-postpone-controller\";\nimport {DatetimeConverter} from \"crm.timeline.tools\";\n\n/** @memberof BX.Crm.Timeline.Items.Scheduled */\nexport default class Activity extends Scheduled\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._postponeController = null;\n\t}\n\n\tgetTypeId()\n\t{\n\t\treturn ItemType.activity;\n\t}\n\n\tisDone()\n\t{\n\t\tconst status = BX.prop.getInteger(this.getAssociatedEntityData(), \"STATUS\");\n\t\treturn (status ===  BX.CrmActivityStatus.completed || status ===  BX.CrmActivityStatus.autoCompleted);\n\t}\n\n\tsetAsDone(isDone)\n\t{\n\t\tisDone = !!isDone;\n\t\tif(this.isDone() === isDone)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst id = BX.prop.getInteger(this.getAssociatedEntityData(), \"ID\", 0);\n\t\tif(id > 0)\n\t\t{\n\t\t\tthis._activityEditor.setActivityCompleted(\n\t\t\t\tid,\n\t\t\t\tisDone,\n\t\t\t\tBX.delegate(this.onSetAsDoneCompleted, this)\n\t\t\t);\n\t\t}\n\t}\n\n\tpostpone(offset)\n\t{\n\t\tconst id = this.getSourceId();\n\t\tif(id > 0 && offset > 0)\n\t\t{\n\t\t\tthis._activityEditor.postponeActivity(\n\t\t\t\tid,\n\t\t\t\toffset,\n\t\t\t\tBX.delegate(this.onPosponeCompleted, this)\n\t\t\t);\n\t\t}\n\t}\n\n\tview()\n\t{\n\t\tconst id = BX.prop.getInteger(this.getAssociatedEntityData(), \"ID\", 0);\n\t\tif(id > 0)\n\t\t{\n\t\t\tthis._activityEditor.viewActivity(id);\n\t\t}\n\t}\n\n\tedit()\n\t{\n\t\tthis.closeContextMenu();\n\t\tconst associatedEntityTypeId = this.getAssociatedEntityTypeId();\n\t\tif(associatedEntityTypeId === BX.CrmEntityType.enumeration.activity)\n\t\t{\n\t\t\tconst entityData = this.getAssociatedEntityData();\n\t\t\tconst id = BX.prop.getInteger(entityData, \"ID\", 0);\n\t\t\tif(id > 0)\n\t\t\t{\n\t\t\t\tthis._activityEditor.editActivity(id);\n\t\t\t}\n\t\t}\n\t}\n\n\tprocessRemoval()\n\t{\n\t\tthis.closeContextMenu();\n\t\tthis._detetionConfirmDlgId = \"entity_timeline_deletion_\" + this.getId() + \"_confirm\";\n\t\tlet dlg = BX.Crm.ConfirmationDialog.get(this._detetionConfirmDlgId);\n\t\tif(!dlg)\n\t\t{\n\t\t\tdlg = BX.Crm.ConfirmationDialog.create(\n\t\t\t\tthis._detetionConfirmDlgId,\n\t\t\t\t{\n\t\t\t\t\ttitle: this.getMessage(\"removeConfirmTitle\"),\n\t\t\t\t\tcontent: this.getRemoveMessage()\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\tdlg.open().then(BX.delegate(this.onRemovalConfirm, this), BX.delegate(this.onRemovalCancel, this));\n\t}\n\n\tgetRemoveMessage()\n\t{\n\t\treturn this.getMessage('removeConfirm');\n\t}\n\n\tonRemovalConfirm(result)\n\t{\n\t\tif(BX.prop.getBoolean(result, \"cancel\", true))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.remove();\n\t}\n\n\tonRemovalCancel()\n\t{\n\t}\n\n\tremove()\n\t{\n\t\tconst associatedEntityTypeId = this.getAssociatedEntityTypeId();\n\n\t\tif(associatedEntityTypeId === BX.CrmEntityType.enumeration.activity)\n\t\t{\n\t\t\tconst entityData = this.getAssociatedEntityData();\n\n\t\t\tconst id = BX.prop.getInteger(entityData, \"ID\", 0);\n\n\t\t\tif(id > 0)\n\t\t\t{\n\t\t\t\tconst activityEditor = this._activityEditor;\n\t\t\t\tconst item = activityEditor.getItemById(id);\n\t\t\t\tif (item)\n\t\t\t\t{\n\t\t\t\t\tactivityEditor.deleteActivity(id, true);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tconst activityType = activityEditor.getSetting('ownerType', '');\n\t\t\t\t\tconst activityId = activityEditor.getSetting('ownerID', '');\n\n\t\t\t\t\tconst serviceUrl = BX.util.add_url_param(activityEditor.getSetting('serviceUrl', ''),\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tid: id,\n\t\t\t\t\t\t\taction: 'get_activity',\n\t\t\t\t\t\t\townertype: activityType,\n\t\t\t\t\t\t\townerid: activityId\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t\tBX.ajax({\n\t\t\t\t\t\t'url': serviceUrl,\n\t\t\t\t\t\t'method': 'POST',\n\t\t\t\t\t\t'dataType': 'json',\n\t\t\t\t\t\t'data':\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t'ACTION' : 'GET_ACTIVITY',\n\t\t\t\t\t\t\t\t'ID': id,\n\t\t\t\t\t\t\t\t'OWNER_TYPE': activityType,\n\t\t\t\t\t\t\t\t'OWNER_ID': activityId\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\tonsuccess: BX.delegate(\n\t\t\t\t\t\t\tfunction(data)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tif(typeof(data['ACTIVITY']) !== 'undefined')\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tactivityEditor._handleActivityChange(data['ACTIVITY']);\n\t\t\t\t\t\t\t\t\twindow.setTimeout(BX.delegate(this.remove ,this), 500);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tthis\n\t\t\t\t\t\t),\n\t\t\t\t\t\tonfailure: function(data){}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tgetDeadline()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst time = BX.parseDate(\n\t\t\tentityData[\"DEADLINE_SERVER\"],\n\t\t\tfalse,\n\t\t\t\"YYYY-MM-DD\",\n\t\t\t\"YYYY-MM-DD HH:MI:SS\"\n\t\t);\n\n\t\tif(!time)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn (new DatetimeConverter(time)).toUserTime().getValue();\n\t}\n\n\tgetCreatedDate()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst time = BX.parseDate(\n\t\t\tentityData[\"CREATED_SERVER\"],\n\t\t\tfalse,\n\t\t\t\"YYYY-MM-DD\",\n\t\t\t\"YYYY-MM-DD HH:MI:SS\"\n\t\t);\n\n\t\tif(!time)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn (new DatetimeConverter(time)).toUserTime().getValue();\n\t}\n\n\tisIncomingChannel()\n\t{\n\t\tif (this.isDone())\n\t\t{\n\t\t\treturn false;\n\t\t}\n\t\tconst entityData = this.getAssociatedEntityData();\n\n\t\treturn entityData.hasOwnProperty('IS_INCOMING_CHANNEL') && entityData.IS_INCOMING_CHANNEL === 'Y';\n\t}\n\n\tmarkAsDone(isDone)\n\t{\n\t\tisDone = !!isDone;\n\t\tthis.getAssociatedEntityData()[\"STATUS\"] = isDone ? BX.CrmActivityStatus.completed : BX.CrmActivityStatus.waiting;\n\t}\n\n\tgetPrepositionText(direction)\n\t{\n\t\treturn this.getMessage(direction === BX.CrmActivityDirection.incoming ? \"from\" : \"to\");\n\t}\n\n\tgetTypeDescription(direction)\n\t{\n\t\treturn \"\";\n\t}\n\n\tisContextMenuEnabled()\n\t{\n\t\treturn ((!!this.getDeadline() && this.canPostpone()) || this.canComplete());\n\t}\n\n\tprepareContent(options)\n\t{\n\t\tlet timeText = '';\n\t\tconst isIncomingChannel = this.isIncomingChannel();\n\t\tif (isIncomingChannel)\n\t\t{\n\t\t\ttimeText = this.formatDateTime(this.getCreatedDate());\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst deadline = this.getDeadline();\n\t\t\ttimeText = deadline ? this.formatDateTime(deadline) : this.getMessage(\"termless\");\n\t\t}\n\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst direction = BX.prop.getInteger(entityData, \"DIRECTION\", 0);\n\t\tconst isDone = this.isDone();\n\t\tconst subject = BX.prop.getString(entityData, \"SUBJECT\", \"\");\n\t\tlet description = BX.prop.getString(entityData, \"DESCRIPTION_RAW\", \"\");\n\n\t\tconst communication = BX.prop.getObject(entityData, \"COMMUNICATION\", {});\n\t\tconst title = BX.prop.getString(communication, \"TITLE\", \"\");\n\t\tconst showUrl = BX.prop.getString(communication, \"SHOW_URL\", \"\");\n\t\tconst communicationValue = BX.prop.getString(communication, \"TYPE\", \"\") !== \"\"\n\t\t\t? BX.prop.getString(communication, \"VALUE\", \"\") : \"\";\n\n\t\tlet wrapperClassName = this.getWrapperClassName();\n\t\tif(wrapperClassName !== \"\")\n\t\t{\n\t\t\twrapperClassName = this._schedule.getItemClassName() + \" \" + wrapperClassName;\n\t\t}\n\t\telse\n\t\t{\n\t\t\twrapperClassName = this._schedule.getItemClassName();\n\t\t}\n\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: wrapperClassName}});\n\n\t\tlet iconClassName = this.getIconClassName();\n\t\tif(this.isCounterEnabled())\n\t\t{\n\t\t\ticonClassName += \" crm-entity-stream-section-counter\";\n\t\t}\n\t\tif(isIncomingChannel)\n\t\t{\n\t\t\ticonClassName += \" crm-entity-stream-section-counter --incoming-counter\";\n\t\t}\n\t\twrapper.appendChild(BX.create(\"DIV\", { attrs: { className: iconClassName } }));\n\n\t\t//region Context Menu\n\t\tif(this.isContextMenuEnabled())\n\t\t{\n\t\t\twrapper.appendChild(this.prepareContextMenuButton());\n\t\t}\n\t\t//endregion\n\n\t\tconst contentWrapper = BX.create(\"DIV\",\n\t\t\t{attrs: {className: \"crm-entity-stream-section-content\"}}\n\t\t);\n\t\twrapper.appendChild(contentWrapper);\n\n\t\t//region Details\n\t\tif(description !== \"\")\n\t\t{\n\t\t\t//trim leading spaces\n\t\t\tdescription = description.replace(/^\\s+/,'');\n\t\t}\n\n\t\tconst contentInnerWrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-event\"}\n\t\t\t}\n\t\t);\n\t\tcontentWrapper.appendChild(contentInnerWrapper);\n\n\t\tthis._deadlineNode = BX.create(\"SPAN\",\n\t\t\t{ attrs: { className: \"crm-entity-stream-content-event-time\" }, text: timeText }\n\t\t);\n\n\t\tconst headerWrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-header\"}\n\t\t\t}\n\t\t);\n\t\theaderWrapper.appendChild(BX.create(\"SPAN\",\n\t\t\t{\n\t\t\t\tattrs:\n\t\t\t\t\t{\n\t\t\t\t\t\tclassName: \"crm-entity-stream-content-event-title\"\n\t\t\t\t\t},\n\t\t\t\ttext: this.getTypeDescription(direction)\n\t\t\t}\n\t\t));\n\n\t\tconst statusNode = this.getStatusNode();\n\t\tif (statusNode)\n\t\t{\n\t\t\theaderWrapper.appendChild(statusNode);\n\t\t}\n\t\theaderWrapper.appendChild(this._deadlineNode);\n\n\t\tcontentInnerWrapper.appendChild(headerWrapper);\n\n\t\tconst detailWrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail\"}\n\t\t\t}\n\t\t);\n\t\tcontentInnerWrapper.appendChild(detailWrapper);\n\n\t\tdetailWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail-title\"},\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattrs: { href: \"#\" },\n\t\t\t\t\t\t\t\t\tevents: { \"click\": this._headerClickHandler },\n\t\t\t\t\t\t\t\t\ttext: subject\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tdetailWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-description\" },\n\t\t\t\t\ttext: this.cutOffText(description, 128)\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst additionalDetails = this.prepareDetailNodes();\n\t\tif(BX.type.isArray(additionalDetails))\n\t\t{\n\t\t\tlet i = 0;\n\t\t\tconst length = additionalDetails.length;\n\t\t\tfor(; i < length; i++)\n\t\t\t{\n\t\t\t\tdetailWrapper.appendChild(additionalDetails[i]);\n\t\t\t}\n\t\t}\n\n\t\tconst members = BX.create(\"DIV\",\n\t\t\t{attrs: {className: \"crm-entity-stream-content-detail-contact-info\"}}\n\t\t);\n\n\t\tif(title !== '')\n\t\t{\n\t\t\tmembers.appendChild(\n\t\t\t\tBX.create(\"SPAN\",\n\t\t\t\t\t{ text: this.getPrepositionText(direction) + \": \" }\n\t\t\t\t)\n\t\t\t);\n\n\t\t\tif(showUrl !== '')\n\t\t\t{\n\t\t\t\tmembers.appendChild(\n\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tattrs: { href: showUrl },\n\t\t\t\t\t\t\ttext: title\n\t\t\t\t\t\t}\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tmembers.appendChild(BX.create(\"SPAN\", { text: title }));\n\t\t\t}\n\t\t}\n\n\t\tif(communicationValue !== '')\n\t\t{\n\t\t\tconst communicationNode = this.prepareCommunicationNode(communicationValue);\n\t\t\tif(communicationNode)\n\t\t\t{\n\t\t\t\tmembers.appendChild(communicationNode);\n\t\t\t}\n\t\t}\n\n\t\tdetailWrapper.appendChild(members);\n\t\t//endregion\n\t\t//region Set as Done Button\n\t\tconst setAsDoneButton = BX.create(\"INPUT\",\n\t\t\t{\n\t\t\t\tattrs:\n\t\t\t\t\t{\n\t\t\t\t\t\ttype: \"checkbox\",\n\t\t\t\t\t\tclassName: \"crm-entity-stream-planned-apply-btn\",\n\t\t\t\t\t\tchecked: isDone\n\t\t\t\t\t},\n\t\t\t\tevents: {change: this._setAsDoneButtonHandler}\n\t\t\t}\n\t\t);\n\n\t\tif(!this.canComplete())\n\t\t{\n\t\t\tsetAsDoneButton.disabled = true;\n\t\t}\n\n\t\tconst buttonContainer = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail-planned-action\"},\n\t\t\t\tchildren: [setAsDoneButton]\n\t\t\t}\n\t\t);\n\t\tcontentInnerWrapper.appendChild(buttonContainer);\n\t\t//endregion\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontentInnerWrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\t//region  Actions\n\t\tthis._actionContainer = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-action\" }\n\t\t\t}\n\t\t);\n\t\tcontentInnerWrapper.appendChild(this._actionContainer);\n\t\t//endregion\n\n\t\treturn wrapper;\n\t}\n\n\tgetStatusNode()\n\t{\n\t\treturn null;\n\t}\n\n\tprepareCommunicationNode(communicationValue)\n\t{\n\t\treturn BX.create(\"SPAN\", { text: \" \" + communicationValue });\n\t}\n\n\tprepareDetailNodes()\n\t{\n\t\treturn [];\n\t}\n\n\tprepareContextMenuItems()\n\t{\n\t\tconst menuItems = [];\n\n\t\tif (!this.isReadOnly())\n\t\t{\n\t\t\tif (this.isEditable())\n\t\t\t{\n\t\t\t\tmenuItems.push({ id: \"edit\", text: this.getMessage(\"menuEdit\"), onclick: BX.delegate(this.edit, this)});\n\t\t\t}\n\n\t\t\tmenuItems.push({ id: \"remove\", text: this.getMessage(\"menuDelete\"), onclick: BX.delegate(this.processRemoval, this)});\n\t\t}\n\n\t\tif (this.canPostpone())\n\t\t{\n\t\t\tconst handler = BX.delegate(this.onContextMenuItemSelect, this);\n\n\t\t\tif(!this._postponeController)\n\t\t\t{\n\t\t\t\tthis._postponeController = SchedulePostponeController.create(\"\", { item: this });\n\t\t\t}\n\n\t\t\tconst postponeMenu =\n\t\t\t\t{\n\t\t\t\t\tid: \"postpone\",\n\t\t\t\t\ttext: this._postponeController.getTitle(),\n\t\t\t\t\titems: []\n\t\t\t\t};\n\n\t\t\tconst commands = this._postponeController.getCommandList();\n\t\t\tlet i = 0;\n\t\t\tconst length = commands.length;\n\t\t\tfor(; i < length; i++)\n\t\t\t{\n\t\t\t\tconst command = commands[i];\n\t\t\t\tpostponeMenu.items.push(\n\t\t\t\t\t{\n\t\t\t\t\t\tid: command[\"name\"],\n\t\t\t\t\t\ttext: command[\"title\"],\n\t\t\t\t\t\tonclick: handler\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t\tmenuItems.push(postponeMenu);\n\t\t}\n\n\t\treturn menuItems;\n\t}\n\n\tonContextMenuItemSelect(e, item)\n\t{\n\t\tthis.closeContextMenu();\n\t\tif(this._postponeController)\n\t\t{\n\t\t\tthis._postponeController.processCommand(item.id);\n\t\t}\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Activity();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import Activity from \"./activity\";\n\n/** @memberof BX.Crm.Timeline.Items.Scheduled */\nexport default class Email extends Activity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetWrapperClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-email\";\n\t}\n\n\tgetIconClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-icon crm-entity-stream-section-icon-email\";\n\t}\n\n\tprepareActions()\n\t{\n\t\tif(this.isReadOnly())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis._actions.push(\n\t\t\tBX.CrmScheduleEmailAction.create(\n\t\t\t\t\"email\",\n\t\t\t\t{\n\t\t\t\t\titem: this,\n\t\t\t\t\tcontainer: this._actionContainer,\n\t\t\t\t\tentityData: this.getAssociatedEntityData(),\n\t\t\t\t\tactivityEditor: this._activityEditor\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t}\n\n\tgetTypeDescription(direction)\n\t{\n\t\treturn this.getMessage(direction === BX.CrmActivityDirection.incoming ? \"incomingEmail\" : \"outgoingEmail\");\n\t}\n\n\tgetRemoveMessage()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tlet title = BX.prop.getString(entityData, \"SUBJECT\", \"\");\n\t\ttitle = BX.util.htmlspecialchars(title);\n\t\treturn this.getMessage('emailRemove').replace(\"#TITLE#\", title);\n\t}\n\n\tisEditable()\n\t{\n\t\treturn false;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Email();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import Activity from \"./activity\";\n\n/** @memberof BX.Crm.Timeline.Items.Scheduled */\nexport default class Call extends Activity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetWrapperClassName()\n\t{\n\t\treturn 'crm-entity-stream-section-call';\n\t}\n\n\tgetIconClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-icon crm-entity-stream-section-icon-call\";\n\t}\n\n\tprepareActions()\n\t{\n\t\tif(this.isReadOnly())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis._actions.push(\n\t\t\tBX.CrmScheduleCallAction.create(\n\t\t\t\t\"call\",\n\t\t\t\t{\n\t\t\t\t\titem: this,\n\t\t\t\t\tcontainer: this._actionContainer,\n\t\t\t\t\tentityData: this.getAssociatedEntityData(),\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\townerInfo: this._schedule.getOwnerInfo()\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t}\n\n\tgetTypeDescription(direction)\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst callInfo = BX.prop.getObject(entityData, \"CALL_INFO\", null);\n\t\tconst callTypeText = callInfo !== null ? BX.prop.getString(callInfo, \"CALL_TYPE_TEXT\", \"\") : \"\";\n\t\tif(callTypeText !== \"\")\n\t\t{\n\t\t\treturn callTypeText;\n\t\t}\n\n\t\treturn this.getMessage(direction === BX.CrmActivityDirection.incoming ? \"incomingCall\" : \"outgoingCall\");\n\t}\n\n\tgetRemoveMessage()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst direction = BX.prop.getInteger(entityData, \"DIRECTION\", 0);\n\t\tlet title = BX.prop.getString(entityData, \"SUBJECT\", \"\");\n\t\tconst messageName = (direction === BX.CrmActivityDirection.incoming) ? 'incomingCallRemove' : 'outgoingCallRemove';\n\t\ttitle = BX.util.htmlspecialchars(title);\n\t\treturn this.getMessage(messageName).replace(\"#TITLE#\", title);\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Call();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import Call from \"./call\";\n\n/** @memberof BX.Crm.Timeline.Items.Scheduled */\nexport default class CallTracker extends Call\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetStatusNode()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst callInfo = BX.prop.getObject(entityData, \"CALL_INFO\", null);\n\n\t\tif (!callInfo)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\t\tif (!BX.prop.getBoolean(callInfo, \"HAS_STATUS\", false))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst isSuccessfull = BX.prop.getBoolean(callInfo, \"SUCCESSFUL\", false);\n\t\tconst statusText = BX.prop.getString(callInfo, \"STATUS_TEXT\", \"\");\n\n\t\treturn BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs:\n\t\t\t\t\t{\n\t\t\t\t\t\tclassName: isSuccessfull\n\t\t\t\t\t\t\t? \"crm-entity-stream-content-event-successful\"\n\t\t\t\t\t\t\t: \"crm-entity-stream-content-event-missing\"\n\t\t\t\t\t},\n\t\t\t\ttext: statusText\n\t\t\t}\n\t\t)\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new CallTracker();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import Activity from \"./activity\";\n\n/** @memberof BX.Crm.Timeline.Items.Scheduled */\nexport default class Meeting extends Activity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetWrapperClassName()\n\t{\n\t\treturn \"\";\n\t}\n\n\tgetIconClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-icon crm-entity-stream-section-icon-meeting\";\n\t}\n\n\tprepareActions()\n\t{\n\t}\n\n\tgetPrepositionText()\n\t{\n\t\treturn this.getMessage(\"reciprocal\");\n\t}\n\n\tgetRemoveMessage()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tlet title = BX.prop.getString(entityData, \"SUBJECT\", \"\");\n\t\ttitle = BX.util.htmlspecialchars(title);\n\t\treturn this.getMessage('meetingRemove').replace(\"#TITLE#\", title);\n\t}\n\n\tgetTypeDescription()\n\t{\n\t\treturn this.getMessage(\"meeting\");\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Meeting();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import Activity from \"./activity\";\n\n/** @memberof BX.Crm.Timeline.Items.Scheduled */\nexport default class Task extends Activity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetWrapperClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-planned-task\";\n\t}\n\n\tgetIconClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-icon crm-entity-stream-section-icon-task\";\n\t}\n\n\tgetTypeDescription()\n\t{\n\t\treturn this.getMessage(\"task\");\n\t}\n\n\tgetPrepositionText(direction)\n\t{\n\t\treturn this.getMessage(\"reciprocal\");\n\t}\n\n\tgetRemoveMessage()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tlet title = BX.prop.getString(entityData, \"SUBJECT\", \"\");\n\t\ttitle = BX.util.htmlspecialchars(title);\n\t\treturn this.getMessage('taskRemove').replace(\"#TITLE#\", title);\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Task();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import Activity from \"./activity\";\n\n/** @memberof BX.Crm.Timeline.Items.Scheduled */\nexport default class StoreDocument extends Activity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetWrapperClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-planned-store-document\";\n\t}\n\n\tgetIconClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-icon crm-entity-stream-section-icon-store-document\";\n\t}\n\n\tgetTypeDescription()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst providerType = BX.prop.getString(entityData, \"PROVIDER_TYPE_ID\", 0);\n\n\t\tif (this.#isProductProvider(providerType))\n\t\t{\n\t\t\treturn this.getMessage(\"storeDocumentProduct\");\n\t\t}\n\n\t\tif (this.#isServiceProvider(providerType))\n\t\t{\n\t\t\treturn this.getMessage(\"storeDocumentService\");\n\t\t}\n\n\t\treturn \"\";\n\t}\n\n\tgetPrepositionText(direction)\n\t{\n\t\treturn this.getMessage(\"reciprocal\");\n\t}\n\n\tgetRemoveMessage()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tlet title = BX.prop.getString(entityData, \"SUBJECT\", \"\");\n\t\ttitle = BX.util.htmlspecialchars(title);\n\t\treturn this.getMessage('taskRemove').replace(\"#TITLE#\", title);\n\t}\n\n\tisEditable()\n\t{\n\t\treturn false;\n\t}\n\n\tprepareContent(options)\n\t{\n\t\tconst deadline = this.getDeadline();\n\t\tconst timeText = deadline ? this.formatDateTime(deadline) : this.getMessage(\"termless\");\n\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst direction = BX.prop.getInteger(entityData, \"DIRECTION\", 0);\n\t\tconst providerType = BX.prop.getString(entityData, \"PROVIDER_TYPE_ID\", 0);\n\n\t\tconst isDone = this.isDone();\n\n\t\tlet wrapperClassName = this.getWrapperClassName();\n\t\tif(wrapperClassName !== \"\")\n\t\t{\n\t\t\twrapperClassName = \"crm-entity-stream-section crm-entity-stream-section-planned\" + \" \" + wrapperClassName;\n\t\t}\n\t\telse\n\t\t{\n\t\t\twrapperClassName = \"crm-entity-stream-section crm-entity-stream-section-planned\";\n\t\t}\n\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: wrapperClassName}});\n\n\t\tlet iconClassName = this.getIconClassName();\n\t\tif(this.isCounterEnabled())\n\t\t{\n\t\t\ticonClassName += \" crm-entity-stream-section-counter\";\n\t\t}\n\t\twrapper.appendChild(BX.create(\"DIV\", { attrs: { className: iconClassName } }));\n\n\t\t//region Context Menu\n\t\tif(this.isContextMenuEnabled())\n\t\t{\n\t\t\twrapper.appendChild(this.prepareContextMenuButton());\n\t\t}\n\t\t//endregion\n\n\t\tconst contentWrapper = BX.create(\"DIV\",\n\t\t\t{attrs: {className: \"crm-entity-stream-section-content\"}}\n\t\t);\n\t\twrapper.appendChild(contentWrapper);\n\n\t\t//region Details\n\t\tconst contentInnerWrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-event\"}\n\t\t\t}\n\t\t);\n\t\tcontentWrapper.appendChild(contentInnerWrapper);\n\n\t\tthis._deadlineNode = BX.create(\"SPAN\",\n\t\t\t{ attrs: { className: \"crm-entity-stream-content-event-time\" }, text: timeText }\n\t\t);\n\n\t\tconst headerWrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-header\"}\n\t\t\t}\n\t\t);\n\t\theaderWrapper.appendChild(BX.create(\"SPAN\",\n\t\t\t{\n\t\t\t\tattrs:\n\t\t\t\t\t{\n\t\t\t\t\t\tclassName: \"crm-entity-stream-content-event-title\"\n\t\t\t\t\t},\n\t\t\t\ttext: this.getTypeDescription(direction)\n\t\t\t}\n\t\t));\n\n\t\tconst statusNode = this.getStatusNode();\n\t\tif (statusNode)\n\t\t{\n\t\t\theaderWrapper.appendChild(statusNode);\n\t\t}\n\t\theaderWrapper.appendChild(this._deadlineNode);\n\n\t\tcontentInnerWrapper.appendChild(headerWrapper);\n\n\t\tconst detailWrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail\"}\n\t\t\t}\n\t\t);\n\t\tcontentInnerWrapper.appendChild(detailWrapper);\n\n\t\tif (this.#isProductProvider(providerType))\n\t\t{\n\t\t\tdetailWrapper.appendChild(this.#prepareProduct());\n\t\t}\n\t\telse if (this.#isServiceProvider(providerType))\n\t\t{\n\t\t\tdetailWrapper.appendChild(this.#prepareService());\n\t\t}\n\n\t\tconst additionalDetails = this.prepareDetailNodes();\n\t\tif(BX.type.isArray(additionalDetails))\n\t\t{\n\t\t\tlet i = 0;\n\t\t\tconst length = additionalDetails.length;\n\t\t\tfor(; i < length; i++)\n\t\t\t{\n\t\t\t\tdetailWrapper.appendChild(additionalDetails[i]);\n\t\t\t}\n\t\t}\n\t\t//endregion\n\t\t//region Set as Done Button\n\t\tconst setAsDoneButton = BX.create(\"INPUT\",\n\t\t\t{\n\t\t\t\tattrs:\n\t\t\t\t\t{\n\t\t\t\t\t\ttype: \"checkbox\",\n\t\t\t\t\t\tclassName: \"crm-entity-stream-planned-apply-btn\",\n\t\t\t\t\t\tchecked: isDone\n\t\t\t\t\t},\n\t\t\t\tevents: {change: this._setAsDoneButtonHandler}\n\t\t\t}\n\t\t);\n\n\t\tif(!this.canComplete())\n\t\t{\n\t\t\tsetAsDoneButton.disabled = true;\n\t\t}\n\n\t\tconst buttonContainer = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail-planned-action\"},\n\t\t\t\tchildren: [setAsDoneButton]\n\t\t\t}\n\t\t);\n\t\tcontentInnerWrapper.appendChild(buttonContainer);\n\t\t//endregion\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontentInnerWrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\t//region  Actions\n\t\tthis._actionContainer = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-action\" }\n\t\t\t}\n\t\t);\n\t\tcontentInnerWrapper.appendChild(this._actionContainer);\n\t\t//endregion\n\n\t\treturn wrapper;\n\t}\n\n\t#prepareProduct()\n\t{\n\t\treturn BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail-description\"},\n\t\t\t\tchildren: [\n\t\t\t\t\tBX.create(\"SPAN\", { text: this.getMessage(\"storeDocumentProductDescription\") }),\n\t\t\t\t\tBX.create(\"A\", {\n\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\tclassName: \"crm-entity-stream-content-detail-target\",\n\t\t\t\t\t\t\thref: \"#\",\n\t\t\t\t\t\t},\n\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\tclick: BX.delegate(function (e) {\n\t\t\t\t\t\t\t\ttop.BX.Helper.show('redirect=detail&code=14828480');\n\t\t\t\t\t\t\t\te.preventDefault ? e.preventDefault() : (e.returnValue = false);\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t},\n\t\t\t\t\t\ttext: \" \" + BX.message('CRM_TIMELINE_DETAILS'),\n\t\t\t\t\t})\n\t\t\t\t]\n\t\t\t}\n\t\t)\n\t}\n\n\t#prepareService()\n\t{\n\t\treturn BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail-description\"},\n\t\t\t\tchildren: [\n\t\t\t\t\tBX.create(\"SPAN\", { text: this.getMessage(\"storeDocumentServiceDescription\") }),\n\t\t\t\t\tBX.create(\"A\", {\n\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\tclassName: \"crm-entity-stream-content-detail-target\",\n\t\t\t\t\t\t\thref: \"#\",\n\t\t\t\t\t\t},\n\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\tclick: BX.delegate(function (e) {\n\t\t\t\t\t\t\t\ttop.BX.Helper.show('redirect=detail&code=16592066');\n\t\t\t\t\t\t\t\te.preventDefault ? e.preventDefault() : (e.returnValue = false);\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t},\n\t\t\t\t\t\ttext: \" \" + BX.message('CRM_TIMELINE_DETAILS'),\n\t\t\t\t\t})\n\t\t\t\t]\n\t\t\t}\n\t\t)\n\t}\n\n\t#isProductProvider(providerType): boolean\n\t{\n\t\treturn providerType === 'STORE_DOCUMENT_PRODUCT';\n\t}\n\n\t#isServiceProvider(providerType): boolean\n\t{\n\t\treturn providerType === 'STORE_DOCUMENT_SERVICE';\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new StoreDocument();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import Activity from \"./activity\";\n\n/** @memberof BX.Crm.Timeline.Items.Scheduled */\nexport default class WebForm extends Activity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetWrapperClassName()\n\t{\n\t\treturn \"\";\n\t}\n\n\tgetIconClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-icon crm-entity-stream-section-icon-crmForm\";\n\t}\n\n\tprepareActions()\n\t{\n\t}\n\n\tgetPrepositionText()\n\t{\n\t\treturn this.getMessage(\"from\");\n\t}\n\n\tgetTypeDescription()\n\t{\n\t\treturn this.getMessage(\"webform\");\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new WebForm();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import Scheduled from \"../scheduled\";\nimport {Item as ItemType} from \"../../types\";\nimport SchedulePostponeController from \"../../tools/schedule-postpone-controller\";\nimport {DatetimeConverter} from \"crm.timeline.tools\";\n\n/** @memberof BX.Crm.Timeline.Items.Scheduled */\nexport default class Wait extends Scheduled\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._postponeController = null;\n\t}\n\n\tgetTypeId()\n\t{\n\t\treturn ItemType.wait;\n\t}\n\n\tgetWrapperClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-wait\";\n\t}\n\n\tgetIconClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-icon crm-entity-stream-section-icon-wait\";\n\t}\n\n\tprepareActions()\n\t{\n\t}\n\n\tisCounterEnabled()\n\t{\n\t\treturn false;\n\t}\n\n\tgetDeadline()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst time = BX.parseDate(\n\t\t\tentityData[\"DEADLINE_SERVER\"],\n\t\t\tfalse,\n\t\t\t\"YYYY-MM-DD\",\n\t\t\t\"YYYY-MM-DD HH:MI:SS\"\n\t\t);\n\n\t\tif(!time)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn (new DatetimeConverter(time)).toUserTime().getValue();\n\t}\n\n\tisDone()\n\t{\n\t\treturn (BX.prop.getString(this.getAssociatedEntityData(), \"COMPLETED\", \"N\") ===  \"Y\");\n\t}\n\n\tsetAsDone(isDone)\n\t{\n\t\tisDone = !!isDone;\n\t\tif(this.isDone() === isDone)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst id = this.getAssociatedEntityId();\n\t\tif(id > 0)\n\t\t{\n\t\t\tconst editor = this._schedule.getManager().getWaitEditor();\n\t\t\tif(editor)\n\t\t\t{\n\t\t\t\teditor.complete(\n\t\t\t\t\tid,\n\t\t\t\t\tisDone,\n\t\t\t\t\tBX.delegate(this.onSetAsDoneCompleted, this)\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n\n\tpostpone(offset)\n\t{\n\t\tconst id = this.getAssociatedEntityId();\n\t\tif(id > 0 && offset > 0)\n\t\t{\n\t\t\tconst editor = this._schedule.getManager().getWaitEditor();\n\t\t\tif(editor)\n\t\t\t{\n\t\t\t\teditor.postpone(\n\t\t\t\t\tid,\n\t\t\t\t\toffset,\n\t\t\t\t\tBX.delegate(this.onPosponeCompleted, this)\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n\n\tisContextMenuEnabled()\n\t{\n\t\treturn !!this.getDeadline() && this.canPostpone();\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst deadline = this.getDeadline();\n\t\tconst timeText = deadline ? this.formatDateTime(deadline) : this.getMessage(\"termless\");\n\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst isDone = this.isDone();\n\t\tlet description = BX.prop.getString(entityData, \"DESCRIPTION_RAW\", \"\");\n\n\t\tlet wrapperClassName = this.getWrapperClassName();\n\t\tif(wrapperClassName !== \"\")\n\t\t{\n\t\t\twrapperClassName = \"crm-entity-stream-section crm-entity-stream-section-planned\" + \" \" + wrapperClassName;\n\t\t}\n\t\telse\n\t\t{\n\t\t\twrapperClassName = \"crm-entity-stream-section crm-entity-stream-section-planned\";\n\t\t}\n\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: wrapperClassName}});\n\n\t\tlet iconClassName = this.getIconClassName();\n\t\tif(this.isCounterEnabled())\n\t\t{\n\t\t\ticonClassName += \" crm-entity-stream-section-counter\";\n\t\t}\n\n\t\twrapper.appendChild(BX.create(\"DIV\", { attrs: { className: iconClassName } }));\n\n\t\t//region Context Menu\n\t\tif(this.isContextMenuEnabled())\n\t\t{\n\t\t\twrapper.appendChild(this.prepareContextMenuButton());\n\t\t}\n\t\t//endregion\n\n\t\tconst contentWrapper = BX.create(\"DIV\",\n\t\t\t{attrs: {className: \"crm-entity-stream-section-content\"}}\n\t\t);\n\t\twrapper.appendChild(contentWrapper);\n\n\t\t//region Details\n\t\tif(description !== \"\")\n\t\t{\n\t\t\tdescription = BX.util.trim(description);\n\t\t\tdescription = BX.util.strip_tags(description);\n\t\t\tdescription = this.cutOffText(description, 512);\n\t\t\tdescription = BX.util.nl2br(description);\n\t\t}\n\n\t\tconst contentInnerWrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-event\"}\n\t\t\t}\n\t\t);\n\t\tcontentWrapper.appendChild(contentInnerWrapper);\n\n\t\tthis._deadlineNode = BX.create(\"SPAN\",\n\t\t\t{ attrs: { className: \"crm-entity-stream-content-event-time\" }, text: timeText }\n\t\t);\n\n\t\tconst headerWrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-header\"},\n\t\t\t\tchildren:\n\t\t\t\t\t[\n\t\t\t\t\t\tBX.create(\"SPAN\",\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-event-title\"},\n\t\t\t\t\t\t\t\ttext: this.getMessage(\"wait\")\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t),\n\t\t\t\t\t\tthis._deadlineNode\n\t\t\t\t\t]\n\t\t\t}\n\t\t);\n\t\tcontentInnerWrapper.appendChild(headerWrapper);\n\n\t\tconst detailWrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail\"}\n\t\t\t}\n\t\t);\n\t\tcontentInnerWrapper.appendChild(detailWrapper);\n\n\t\tdetailWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-description\" },\n\t\t\t\t\thtml: description\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst members = BX.create(\"DIV\",\n\t\t\t{attrs: {className: \"crm-entity-stream-content-detail-contact-info\"}}\n\t\t);\n\n\t\tdetailWrapper.appendChild(members);\n\t\t//endregion\n\n\t\t//region Set as Done Button\n\t\tconst setAsDoneButton = BX.create(\"INPUT\",\n\t\t\t{\n\t\t\t\tattrs:\n\t\t\t\t\t{\n\t\t\t\t\t\ttype: \"checkbox\",\n\t\t\t\t\t\tclassName: \"crm-entity-stream-planned-apply-btn\",\n\t\t\t\t\t\tchecked: isDone\n\t\t\t\t\t},\n\t\t\t\tevents: {change: this._setAsDoneButtonHandler}\n\t\t\t}\n\t\t);\n\n\t\tif(!this.canComplete())\n\t\t{\n\t\t\tsetAsDoneButton.disabled = true;\n\t\t}\n\n\t\tconst buttonContainer = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail-planned-action\"},\n\t\t\t\tchildren: [setAsDoneButton]\n\t\t\t}\n\t\t);\n\t\tcontentInnerWrapper.appendChild(buttonContainer);\n\t\t//endregion\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontentInnerWrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\t//region  Actions\n\t\tthis._actionContainer = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-action\" }\n\t\t\t}\n\t\t);\n\t\tcontentInnerWrapper.appendChild(this._actionContainer);\n\t\t//endregion\n\n\t\treturn wrapper;\n\t}\n\n\tprepareContextMenuItems()\n\t{\n\t\tconst menuItems = [];\n\t\tconst handler = BX.delegate(this.onContextMenuItemSelect, this);\n\n\t\tif(!this._postponeController)\n\t\t{\n\t\t\tthis._postponeController = SchedulePostponeController.create(\"\", { item: this });\n\t\t}\n\n\t\tconst postponeMenu =\n\t\t\t{\n\t\t\t\tid: \"postpone\",\n\t\t\t\ttext: this._postponeController.getTitle(),\n\t\t\t\titems: []\n\t\t\t};\n\n\t\tconst commands = this._postponeController.getCommandList();\n\t\tlet i = 0;\n\t\tconst length = commands.length;\n\t\tfor(; i < length; i++)\n\t\t{\n\t\t\tconst command = commands[i];\n\t\t\tpostponeMenu.items.push(\n\t\t\t\t{\n\t\t\t\t\tid: command[\"name\"],\n\t\t\t\t\ttext: command[\"title\"],\n\t\t\t\t\tonclick: handler\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\tmenuItems.push(postponeMenu);\n\t\treturn menuItems;\n\t}\n\n\tonContextMenuItemSelect(e, item)\n\t{\n\t\tthis.closeContextMenu();\n\t\tif(this._postponeController)\n\t\t{\n\t\t\tthis._postponeController.processCommand(item.id);\n\t\t}\n\t}\n\n\tgetTypeDescription()\n\t{\n\t\treturn this.getMessage(\"wait\");\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Wait();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import Activity from \"./activity\";\n\n/** @memberof BX.Crm.Timeline.Items.Scheduled */\nexport default class Request extends Activity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetWrapperClassName()\n\t{\n\t\treturn \"\";\n\t}\n\n\tgetIconClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-icon crm-entity-stream-section-icon-robot\";\n\t}\n\n\tgetTypeDescription()\n\t{\n\t\treturn this.getMessage(\"activityRequest\");\n\t}\n\n\tisEditable()\n\t{\n\t\treturn false;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Request();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import Activity from \"./activity\";\n\n/** @memberof BX.Crm.Timeline.Items.Scheduled */\nexport default class Rest extends Activity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetWrapperClassName()\n\t{\n\t\treturn \"\";\n\t}\n\n\tgetIconClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-icon crm-entity-stream-section-icon-rest\";\n\t}\n\n\tprepareContent(options)\n\t{\n\t\tconst wrapper = super.prepareContent(options);\n\t\tconst data = this.getAssociatedEntityData();\n\n\t\tif (data['APP_TYPE'] && data['APP_TYPE']['ICON_SRC'])\n\t\t{\n\t\t\tconst iconNode = wrapper.querySelector('.' + this.getIconClassName().replace(/\\s+/g, '.'));\n\t\t\tif (iconNode)\n\t\t\t{\n\t\t\t\ticonNode.style.backgroundImage = \"url('\" +  data['APP_TYPE']['ICON_SRC'] + \"')\";\n\t\t\t\ticonNode.style.backgroundPosition = \"center center\";\n\t\t\t\ticonNode.style.backgroundSize = \"cover\";\n\t\t\t\ticonNode.style.backgroundColor = \"transparent\";\n\t\t\t}\n\t\t}\n\n\t\treturn wrapper;\n\t}\n\n\tgetTypeDescription()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tif (entityData['APP_TYPE'] && entityData['APP_TYPE']['NAME'])\n\t\t{\n\t\t\treturn entityData['APP_TYPE']['NAME'];\n\t\t}\n\n\t\treturn this.getMessage(\"restApplication\");\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Rest();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import Activity from \".//activity\";\n\n/** @memberof BX.Crm.Timeline.Actions */\nexport class OpenLine extends Activity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._clickHandler = BX.delegate(this.onClick, this);\n\t\tthis._button = null;\n\t}\n\n\tgetButton()\n\t{\n\t\treturn this._button;\n\t}\n\n\tonClick()\n\t{\n\t\tif(typeof(window.top['BXIM']) === 'undefined')\n\t\t{\n\t\t\twindow.alert(this.getMessage(\"openLineNotSupported\"));\n\t\t\treturn;\n\t\t}\n\n\t\tlet slug = \"\";\n\t\tconst communication = BX.prop.getObject(this._entityData, \"COMMUNICATION\", null);\n\t\tif(communication)\n\t\t{\n\t\t\tif(BX.prop.getString(communication, \"TYPE\") === \"IM\")\n\t\t\t{\n\t\t\t\tslug = BX.prop.getString(communication, \"VALUE\");\n\t\t\t}\n\t\t}\n\n\t\tif(slug !== \"\")\n\t\t{\n\t\t\twindow.top['BXIM'].openMessengerSlider(slug, {RECENT: 'N', MENU: 'N'});\n\t\t}\n\t}\n\n\tdoLayout()\n\t{\n\t\tthis._button = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: { className: \"crm-entity-stream-content-action-reply-btn\" },\n\t\t\t\tevents: { \"click\": this._clickHandler }\n\t\t\t}\n\t\t);\n\t\tthis._container.appendChild(this._button);\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = OpenLine.messages;\n\t\treturn m.hasOwnProperty(name) ? m[name] : name;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new OpenLine();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n\n\tstatic messages = {};\n}\n","import Activity from \"./activity\";\nimport {OpenLine as OpenLineAction} from \"../../actions/openline\";\n\n/** @memberof BX.Crm.Timeline.Items.Scheduled */\nexport default class OpenLine extends Activity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetWrapperClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-IM\";\n\t}\n\n\tgetIconClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-icon crm-entity-stream-section-icon-IM\";\n\t}\n\n\tprepareActions()\n\t{\n\t\tif(this.isReadOnly())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis._actions.push(\n\t\t\tOpenLineAction.create(\n\t\t\t\t\"openline\",\n\t\t\t\t{\n\t\t\t\t\titem: this,\n\t\t\t\t\tcontainer: this._actionContainer,\n\t\t\t\t\tentityData: this.getAssociatedEntityData(),\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\townerInfo: this._schedule.getOwnerInfo()\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t}\n\n\tgetTypeDescription()\n\t{\n\t\treturn this.getMessage(\"openLine\");\n\t}\n\n\tgetPrepositionText(direction)\n\t{\n\t\treturn this.getMessage(\"reciprocal\");\n\t}\n\n\tprepareCommunicationNode(communicationValue)\n\t{\n\t\treturn null;\n\t}\n\n\tprepareDetailNodes()\n\t{\n\t\tconst wrapper = BX.create(\"DIV\",\n\t\t\t{attrs: {className: \"crm-entity-stream-content-detail-IM\"}}\n\t\t);\n\n\t\tconst messageWrapper = BX.create(\"DIV\",\n\t\t\t{attrs: {className: \"crm-entity-stream-content-detail-IM-messages\"}}\n\t\t);\n\t\twrapper.appendChild(messageWrapper);\n\n\t\tconst openLineData = BX.prop.getObject(this.getAssociatedEntityData(), \"OPENLINE_INFO\", null);\n\t\tif(openLineData)\n\t\t{\n\t\t\tconst messages = BX.prop.getArray(openLineData, \"MESSAGES\", []);\n\t\t\tlet i = 0;\n\t\t\tconst length = messages.length;\n\t\t\tfor(; i < length; i++)\n\t\t\t{\n\t\t\t\tconst message = messages[i];\n\t\t\t\tconst isExternal = BX.prop.getBoolean(message, \"IS_EXTERNAL\", true);\n\n\t\t\t\tmessageWrapper.appendChild(\n\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tattrs:\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tclassName: isExternal\n\t\t\t\t\t\t\t\t\t\t? \"crm-entity-stream-content-detail-IM-message-incoming\"\n\t\t\t\t\t\t\t\t\t\t: \"crm-entity-stream-content-detail-IM-message-outgoing\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\thtml: BX.prop.getString(message, \"MESSAGE\", \"\")\n\t\t\t\t\t\t}\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\treturn [ wrapper ];\n\t}\n\n\tview()\n\t{\n\t\tif(typeof(window.top['BXIM']) === 'undefined')\n\t\t{\n\t\t\twindow.alert(this.getMessage(\"openLineNotSupported\"));\n\t\t\treturn;\n\t\t}\n\n\t\tlet slug = \"\";\n\t\tconst communication = BX.prop.getObject(this.getAssociatedEntityData(), \"COMMUNICATION\", null);\n\t\tif(communication)\n\t\t{\n\t\t\tif(BX.prop.getString(communication, \"TYPE\") === \"IM\")\n\t\t\t{\n\t\t\t\tslug = BX.prop.getString(communication, \"VALUE\");\n\t\t\t}\n\t\t}\n\n\t\tif(slug !== \"\")\n\t\t{\n\t\t\twindow.top['BXIM'].openMessengerSlider(slug, {RECENT: 'N', MENU: 'N'});\n\t\t}\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new OpenLine();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import Activity from \"./activity\";\nimport {DatetimeConverter} from \"crm.timeline.tools\";\n\n/** @memberof BX.Crm.Timeline.Items.Scheduled */\nexport default class Zoom extends Activity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetWrapperClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-zoom\";\n\t}\n\n\tgetIconClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-icon crm-entity-stream-section-icon-zoom\";\n\t}\n\n\tgetTypeDescription()\n\t{\n\t\treturn this.getMessage(\"zoom\");\n\t}\n\n\tgetPrepositionText(direction)\n\t{\n\t}\n\n\tprepareCommunicationNode(communicationValue)\n\t{\n\t\treturn null;\n\t}\n\n\tprepareContent(options)\n\t{\n\t\tconst deadline = this.getDeadline();\n\t\tconst timeText = deadline ? this.formatDateTime(deadline) : this.getMessage(\"termless\");\n\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst direction = BX.prop.getInteger(entityData, \"DIRECTION\", 0);\n\t\tconst isDone = this.isDone();\n\t\tconst subject = BX.prop.getString(entityData, \"SUBJECT\", \"\");\n\t\tlet description = BX.prop.getString(entityData, \"DESCRIPTION_RAW\", \"\");\n\n\t\tconst communication = BX.prop.getObject(entityData, \"COMMUNICATION\", {});\n\t\tconst title = BX.prop.getString(communication, \"TITLE\", \"\");\n\t\tconst showUrl = BX.prop.getString(communication, \"SHOW_URL\", \"\");\n\t\tconst communicationValue = BX.prop.getString(communication, \"TYPE\", \"\") !== \"\"\n\t\t\t? BX.prop.getString(communication, \"VALUE\", \"\") : \"\";\n\n\t\tlet wrapperClassName = this.getWrapperClassName();\n\t\tif(wrapperClassName !== \"\")\n\t\t{\n\t\t\twrapperClassName = \"crm-entity-stream-section crm-entity-stream-section-planned\" + \" \" + wrapperClassName;\n\t\t}\n\t\telse\n\t\t{\n\t\t\twrapperClassName = \"crm-entity-stream-section crm-entity-stream-section-planned\";\n\t\t}\n\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: wrapperClassName}});\n\n\t\tlet iconClassName = this.getIconClassName();\n\t\tif(this.isCounterEnabled())\n\t\t{\n\t\t\ticonClassName += \" crm-entity-stream-section-counter\";\n\t\t}\n\t\twrapper.appendChild(BX.create(\"DIV\", { attrs: { className: iconClassName } }));\n\n\t\t//region Context Menu\n\t\tif(this.isContextMenuEnabled())\n\t\t{\n\t\t\twrapper.appendChild(this.prepareContextMenuButton());\n\t\t}\n\t\t//endregion\n\n\t\tconst contentWrapper = BX.create(\"DIV\",\n\t\t\t{attrs: {className: \"crm-entity-stream-section-content\"}}\n\t\t);\n\t\twrapper.appendChild(contentWrapper);\n\n\t\t//region Details\n\t\tif(description !== \"\")\n\t\t{\n\t\t\t//trim leading spaces\n\t\t\tdescription = description.replace(/^\\s+/,'');\n\t\t}\n\n\t\tconst contentInnerWrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-event\"}\n\t\t\t}\n\t\t);\n\t\tcontentWrapper.appendChild(contentInnerWrapper);\n\n\t\tthis._deadlineNode = BX.create(\"SPAN\",\n\t\t\t{ attrs: { className: \"crm-entity-stream-content-event-time\" }, text: timeText }\n\t\t);\n\n\t\tconst headerWrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-header\"},\n\t\t\t\tchildren:\n\t\t\t\t\t[\n\t\t\t\t\t\tBX.create(\"SPAN\",\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tattrs:\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tclassName: \"crm-entity-stream-content-event-title\"\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\ttext: this.getTypeDescription(direction)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t),\n\t\t\t\t\t\tthis._deadlineNode\n\t\t\t\t\t]\n\t\t\t}\n\t\t);\n\t\tcontentInnerWrapper.appendChild(headerWrapper);\n\n\t\tconst detailWrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail\"}\n\t\t\t}\n\t\t);\n\t\tcontentInnerWrapper.appendChild(detailWrapper);\n\n\t\tif (entityData['ZOOM_INFO'])\n\t\t{\n\t\t\tconst topic = entityData['ZOOM_INFO']['TOPIC'];\n\t\t\tconst duration = entityData['ZOOM_INFO']['DURATION'];\n\t\t\tconst startTime = BX.parseDate(\n\t\t\t\tentityData['ZOOM_INFO']['CONF_START_TIME'],\n\t\t\t\tfalse,\n\t\t\t\t\"YYYY-MM-DD\",\n\t\t\t\t\"YYYY-MM-DD HH:MI:SS\"\n\t\t\t);\n\t\t\tconst date = (new DatetimeConverter(startTime)).toUserTime().toDatetimeString({delimiter: ', '});\n\t\t\tconst detailZoomMessage = BX.create(\"span\",\n\t\t\t\t{\n\t\t\t\t\ttext: this.getMessage(\"zoomCreatedMessage\")\n\t\t\t\t\t\t.replace(\"#CONFERENCE_TITLE#\", topic)\n\t\t\t\t\t\t.replace(\"#DATE_TIME#\", date)\n\t\t\t\t\t\t.replace(\"#DURATION#\", duration)\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tconst detailZoomInfoLink = BX.create(\"A\",\n\t\t\t\t{\n\t\t\t\t\tattrs:\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\thref: entityData['ZOOM_INFO']['CONF_URL'],\n\t\t\t\t\t\t\ttarget: \"_blank\",\n\t\t\t\t\t\t},\n\t\t\t\t\ttext: entityData['ZOOM_INFO']['CONF_URL']\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tconst detailZoomInfo = BX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail-zoom-info\"},\n\t\t\t\t\tchildren: [detailZoomMessage, detailZoomInfoLink]\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tdetailWrapper.appendChild(detailZoomInfo);\n\n\t\t\tconst detailZoomCopyInviteLink = BX.create(\"A\",\n\t\t\t\t{\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\tclassName: 'ui-link ui-link-dashed',\n\t\t\t\t\t\t\"data-url\": entityData['ZOOM_INFO']['CONF_URL']\n\t\t\t\t\t},\n\t\t\t\t\ttext: this.getMessage(\"zoomCreatedCopyInviteLink\"),\n\t\t\t\t}\n\t\t\t);\n\t\t\tBX.clipboard.bindCopyClick(detailZoomCopyInviteLink, {\n\t\t\t\ttext: entityData['ZOOM_INFO']['CONF_URL'],\n\t\t\t});\n\n\t\t\tconst detailZoomStartConferenceButton = BX.create(\"BUTTON\",\n\t\t\t\t{\n\t\t\t\t\tattrs: {className: 'ui-btn ui-btn-sm ui-btn-primary'},\n\t\t\t\t\ttext: this.getMessage(\"zoomCreatedStartConference\"),\n\t\t\t\t\tevents: {\n\t\t\t\t\t\t\"click\": function () {\n\t\t\t\t\t\t\twindow.open(entityData['ZOOM_INFO']['CONF_URL']);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tconst detailZoomCopyInviteLinkWrapper = BX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail-zoom-link-wrapper\"},\n\t\t\t\t\tchildren: [detailZoomCopyInviteLink]\n\t\t\t\t}\n\t\t\t);\n\t\t\tdetailWrapper.appendChild(detailZoomCopyInviteLinkWrapper);\n\t\t\tdetailWrapper.appendChild(detailZoomStartConferenceButton);\n\t\t}\n\n\t\tconst additionalDetails = this.prepareDetailNodes();\n\t\tif(BX.type.isArray(additionalDetails))\n\t\t{\n\t\t\tlet i = 0;\n\t\t\tconst length = additionalDetails.length;\n\t\t\tfor(; i < length; i++)\n\t\t\t{\n\t\t\t\tdetailWrapper.appendChild(additionalDetails[i]);\n\t\t\t}\n\t\t}\n\n\t\t//endregion\n\t\t//region Set as Done Button\n\t\tconst setAsDoneButton = BX.create(\"INPUT\",\n\t\t\t{\n\t\t\t\tattrs:\n\t\t\t\t\t{\n\t\t\t\t\t\ttype: \"checkbox\",\n\t\t\t\t\t\tclassName: \"crm-entity-stream-planned-apply-btn\",\n\t\t\t\t\t\tchecked: isDone\n\t\t\t\t\t},\n\t\t\t\tevents: {change: this._setAsDoneButtonHandler}\n\t\t\t}\n\t\t);\n\n\t\tif(!this.canComplete())\n\t\t{\n\t\t\tsetAsDoneButton.disabled = true;\n\t\t}\n\n\t\tconst buttonContainer = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail-planned-action\"},\n\t\t\t\tchildren: [setAsDoneButton]\n\t\t\t}\n\t\t);\n\t\tcontentInnerWrapper.appendChild(buttonContainer);\n\t\t//endregion\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontentInnerWrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\t//region  Actions\n\t\tthis._actionContainer = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-action\" }\n\t\t\t}\n\t\t);\n\t\tcontentInnerWrapper.appendChild(this._actionContainer);\n\t\t//endregion\n\n\t\treturn wrapper;\n\t}\n\n\tprepareDetailNodes()\n\t{\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Zoom();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import Stream from \"../stream\";\nimport Activity from \"../items/scheduled/activity\";\nimport Email from \"../items/scheduled/email\";\nimport Call from \"../items/scheduled/call\";\nimport CallTracker from \"../items/scheduled/call-tracker\";\nimport Meeting from \"../items/scheduled/meeting\";\nimport Task from \"../items/scheduled/task\";\nimport StoreDocument from \"../items/scheduled/store-document\";\nimport WebForm from \"../items/scheduled/webform\";\nimport Wait from \"../items/scheduled/wait\";\nimport Request from \"../items/scheduled/request\";\nimport Rest from \"../items/scheduled/rest\";\nimport OpenLine from \"../items/scheduled/openline\";\nimport Zoom from \"../items/scheduled/zoom\";\nimport ItemNew from \"../animations/item-new\";\nimport {ConfigurableItem} from \"crm.timeline.item\";\nimport {StreamType} from 'crm.timeline.item';\nimport {DatetimeConverter} from \"crm.timeline.tools\";\n\n/** @memberof BX.Crm.Timeline.Streams */\nexport default class Schedule extends Stream\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._items = [];\n\t\tthis._history = null;\n\t\tthis._wrapper = null;\n\t\tthis._anchor = null;\n\t\tthis._stub = null;\n\t}\n\n\tdoInitialize()\n\t{\n\t\tif(!this.isStubMode())\n\t\t{\n\t\t\tlet itemData = this.getSetting(\"itemData\");\n\t\t\tif(!BX.type.isArray(itemData))\n\t\t\t{\n\t\t\t\titemData = [];\n\t\t\t}\n\n\t\t\tlet i, length, item;\n\t\t\tfor(i = 0, length = itemData.length; i < length; i++)\n\t\t\t{\n\t\t\t\titem = this.createItem(itemData[i]);\n\t\t\t\tif(item)\n\t\t\t\t{\n\t\t\t\t\tthis._items.push(item);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tlayout()\n\t{\n\t\tthis._wrapper = BX.create(\"DIV\", {});\n\t\tthis._container.appendChild(this._wrapper);\n\n\t\tconst label = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-planned-label\"},\n\t\t\t\ttext: this.getMessage(\"planned\")\n\t\t\t}\n\t\t);\n\n\t\tconst wrapperClassName = \"crm-entity-stream-section crm-entity-stream-section-planned-label\";\n\t\tthis._wrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: wrapperClassName },\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\t\t\t\t\tchildren: [ label ]\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tif(this.isStubMode())\n\t\t{\n\t\t\tthis.addStub();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst length = this._items.length;\n\t\t\tif(length === 0)\n\t\t\t{\n\t\t\t\tthis.addStub();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tfor(let i = 0; i < length; i++)\n\t\t\t\t{\n\t\t\t\t\tconst item = this._items[i];\n\t\t\t\t\titem.setContainer(this._wrapper);\n\t\t\t\t\titem.layout();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.refreshLayout();\n\t\tthis._manager.processSheduleLayoutChange();\n\t}\n\n\trefreshLayout()\n\t{\n\t\tBX.onCustomEvent('Schedule:onBeforeRefreshLayout', [this]);\n\t\tconst length = this._items.length;\n\t\tif(length === 0)\n\t\t{\n\t\t\tthis.addStub();\n\t\t\tif(this._history && this._history.hasContent())\n\t\t\t{\n\t\t\t\tBX.removeClass(this._stub, \"crm-entity-stream-section-last\");\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tBX.addClass(this._stub, \"crm-entity-stream-section-last\");\n\t\t\t}\n\n\t\t\tconst stubIcon = this._stub.querySelector(\".crm-entity-stream-section-icon\");\n\t\t\tif(stubIcon)\n\t\t\t{\n\t\t\t\tif(this._manager.isStubCounterEnabled())\n\t\t\t\t{\n\t\t\t\t\tBX.addClass(stubIcon, \"crm-entity-stream-section-counter\");\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tBX.removeClass(stubIcon, \"crm-entity-stream-section-counter\");\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\n\t\tlet i, item;\n\t\tif(this._history && this._history.hasContent())\n\t\t{\n\t\t\tfor(i = 0;  i < length; i++)\n\t\t\t{\n\t\t\t\titem = this._items[i];\n\t\t\t\tif(item.isTerminated())\n\t\t\t\t{\n\t\t\t\t\titem.markAsTerminated(false);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif(length > 1)\n\t\t\t{\n\t\t\t\tfor(i = 0;  i < (length - 1); i++)\n\t\t\t\t{\n\t\t\t\t\titem = this._items[i];\n\t\t\t\t\tif(item.isTerminated())\n\t\t\t\t\t{\n\t\t\t\t\t\titem.markAsTerminated(false);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis._items[length - 1].markAsTerminated(true);\n\t\t}\n\t}\n\n\tformatDateTime(time)\n\t{\n\t\treturn (new DatetimeConverter(time)).toDatetimeString({delimiter: ', '});\n\t}\n\n\tcheckItemForTermination(item)\n\t{\n\t\tif(this._history && this._history.getItemCount() > 0)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\t\treturn this.getLastItem() === item;\n\t}\n\n\tgetItems(): Array\n\t{\n\t\treturn this._items;\n\t}\n\n\tsetItems(items: Array): void\n\t{\n\t\tthis._items = items;\n\t}\n\n\tcalculateItemIndex(item)\n\t{\n\t\tconst sort = item.getSort();\n\n\t\tfor(let i =0; i < this._items.length; i++)\n\t\t{\n\t\t\tconst curSort = this._items[i].getSort();\n\t\t\tfor (let j = 0; j < curSort.length; j++)\n\t\t\t{\n\t\t\t\tif (sort.length <= j || sort[j] !== curSort[j])\n\t\t\t\t{\n\t\t\t\t\tif (sort[j] < curSort[j])\n\t\t\t\t\t{\n\t\t\t\t\t\treturn i;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn this._items.length;\n\t}\n\n\tgetItemCount()\n\t{\n\t\treturn this._items.length;\n\t}\n\n\tgetItemByAssociatedEntity($entityTypeId, entityId)\n\t{\n\t\tif(!BX.type.isNumber($entityTypeId))\n\t\t{\n\t\t\t$entityTypeId = parseInt($entityTypeId);\n\t\t}\n\n\t\tif(!BX.type.isNumber(entityId))\n\t\t{\n\t\t\tentityId = parseInt(entityId);\n\t\t}\n\n\t\tif(isNaN($entityTypeId) || $entityTypeId <= 0 || isNaN(entityId) || entityId <= 0)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tfor(let i = 0, length = this._items.length; i < length; i++)\n\t\t{\n\t\t\tconst item = this._items[i];\n\t\t\tif(item.getAssociatedEntityTypeId() === $entityTypeId && item.getAssociatedEntityId() === entityId)\n\t\t\t{\n\t\t\t\treturn item;\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tgetItemByData(itemData)\n\t{\n\t\tif(!BX.type.isPlainObject(itemData))\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn this.getItemByAssociatedEntity(\n\t\t\tBX.prop.getInteger(itemData, \"ASSOCIATED_ENTITY_TYPE_ID\", 0),\n\t\t\tBX.prop.getInteger(itemData, \"ASSOCIATED_ENTITY_ID\", 0)\n\t\t);\n\t}\n\n\n\tgetItemByIndex(index)\n\t{\n\t\treturn index < this._items.length ? this._items[index] : null;\n\t}\n\n\tcreateItem(data)\n\t{\n\t\tconst entityTypeID = BX.prop.getInteger(data, \"ASSOCIATED_ENTITY_TYPE_ID\", 0);\n\t\tconst entityID = BX.prop.getInteger(data, \"ASSOCIATED_ENTITY_ID\", 0);\n\t\tconst entityData = BX.prop.getObject(data, \"ASSOCIATED_ENTITY\", {});\n\t\tlet itemId = BX.CrmEntityType.resolveName(entityTypeID) + \"_\" + entityID.toString();\n\n\t\tif (data.hasOwnProperty('type'))\n\t\t{\n\t\t\titemId = data.id;\n\n\t\t\treturn ConfigurableItem.create(itemId, {\n\t\t\t\ttimelineId: this.getId(),\n\t\t\t\tcontainer: this.getWrapper(),\n\t\t\t\titemClassName: this.getItemClassName(),\n\t\t\t\tisReadOnly: this.isReadOnly(),\n\t\t\t\tcurrentUser: this._manager.getCurrentUser(),\n\t\t\t\townerTypeId: this._manager.getOwnerTypeId(),\n\t\t\t\townerId: this._manager.getOwnerId(),\n\t\t\t\tstreamType: this.getStreamType(),\n\t\t\t\tdata: data,\n\t\t\t})\n\t\t}\n\n\t\tif(entityTypeID === BX.CrmEntityType.enumeration.wait)\n\t\t{\n\t\t\treturn Wait.create(\n\t\t\t\titemId,\n\t\t\t\t{\n\t\t\t\t\tschedule: this,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse// if(entityTypeID === BX.CrmEntityType.enumeration.activity)\n\t\t{\n\t\t\tconst typeId = BX.prop.getInteger(entityData, \"TYPE_ID\", 0);\n\t\t\tconst providerId = BX.prop.getString(entityData, \"PROVIDER_ID\", \"\");\n\n\t\t\tif(typeId === BX.CrmActivityType.email)\n\t\t\t{\n\t\t\t\treturn Email.create(\n\t\t\t\t\titemId,\n\t\t\t\t\t{\n\t\t\t\t\t\tschedule: this,\n\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\tdata: data\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t\telse if(typeId === BX.CrmActivityType.call)\n\t\t\t{\n\t\t\t\treturn Call.create(\n\t\t\t\t\titemId,\n\t\t\t\t\t{\n\t\t\t\t\t\tschedule: this,\n\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\tdata: data\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t\telse if(typeId === BX.CrmActivityType.meeting)\n\t\t\t{\n\t\t\t\treturn Meeting.create(\n\t\t\t\t\titemId,\n\t\t\t\t\t{\n\t\t\t\t\t\tschedule: this,\n\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\tdata: data\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t\telse if(typeId === BX.CrmActivityType.task)\n\t\t\t{\n\t\t\t\treturn Task.create(\n\t\t\t\t\titemId,\n\t\t\t\t\t{\n\t\t\t\t\t\tschedule: this,\n\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\tdata: data\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t\telse if(typeId === BX.CrmActivityType.provider)\n\t\t\t{\n\t\t\t\tif(providerId === \"CRM_WEBFORM\")\n\t\t\t\t{\n\t\t\t\t\treturn WebForm.create(\n\t\t\t\t\t\titemId,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tschedule: this,\n\t\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\t\tdata: data\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\telse if(providerId === \"CRM_REQUEST\")\n\t\t\t\t{\n\t\t\t\t\treturn Request.create(\n\t\t\t\t\t\titemId,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tschedule: this,\n\t\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\t\tdata: data\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\telse if(providerId === \"IMOPENLINES_SESSION\")\n\t\t\t\t{\n\t\t\t\t\treturn OpenLine.create(\n\t\t\t\t\t\titemId,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tschedule: this,\n\t\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\t\tdata: data\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\telse if(providerId === \"ZOOM\")\n\t\t\t\t{\n\t\t\t\t\treturn Zoom.create(\n\t\t\t\t\t\titemId,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tschedule: this,\n\t\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\t\tdata: data\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\telse if(providerId === \"REST_APP\")\n\t\t\t\t{\n\t\t\t\t\treturn Rest.create(\n\t\t\t\t\t\titemId,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tschedule: this,\n\t\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\t\tdata: data\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\telse if(providerId === 'CRM_DELIVERY')\n\t\t\t\t{\n\t\t\t\t\treturn Activity.create(\n\t\t\t\t\t\titemId,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tschedule: this,\n\t\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\t\tdata: data,\n\t\t\t\t\t\t\tvueComponent: BX.Crm.Timeline.DeliveryActivity,\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\telse if(providerId === 'CRM_CALL_TRACKER')\n\t\t\t\t{\n\t\t\t\t\treturn CallTracker.create(\n\t\t\t\t\t\titemId,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tschedule: this,\n\t\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\t\tdata: data,\n\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\telse if(providerId === 'STORE_DOCUMENT')\n\t\t\t\t{\n\t\t\t\t\treturn StoreDocument.create(\n\t\t\t\t\t\titemId,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tschedule: this,\n\t\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\t\tdata: data\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tgetWrapper()\n\t{\n\t\treturn this._wrapper;\n\t}\n\n\tgetItemClassName()\n\t{\n\t\treturn 'crm-entity-stream-section crm-entity-stream-section-planned';\n\t}\n\n\tgetStreamType(): number\n\t{\n\t\treturn StreamType.scheduled;\n\t}\n\n\taddItem(item, index)\n\t{\n\t\tif(!BX.type.isNumber(index) || index < 0)\n\t\t{\n\t\t\tindex = this.calculateItemIndex(item);\n\t\t}\n\n\t\tif(index < this._items.length)\n\t\t{\n\t\t\tthis._items.splice(index, 0, item);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis._items.push(item);\n\t\t}\n\n\t\tthis.removeStub();\n\n\t\tthis.refreshLayout();\n\t\tthis._manager.processSheduleLayoutChange();\n\t}\n\n\tgetHistory()\n\t{\n\t\treturn this._history;\n\t}\n\n\tsetHistory(history)\n\t{\n\t\tthis._history = history;\n\t}\n\n\tcreateAnchor(index)\n\t{\n\t\tthis._anchor = BX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section crm-entity-stream-section-shadow\" } });\n\t\tif(index >= 0 && index < this._items.length)\n\t\t{\n\t\t\tthis._wrapper.insertBefore(this._anchor, this._items[index].getWrapper());\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis._wrapper.appendChild(this._anchor);\n\t\t}\n\t\treturn this._anchor;\n\t}\n\n\tdeleteItem(item)\n\t{\n\t\tconst index = this.getItemIndex(item);\n\t\tif(index < 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\titem.clearLayout();\n\t\tthis.removeItemByIndex(index);\n\n\t\tthis.refreshLayout();\n\t\tthis._manager.processSheduleLayoutChange();\n\t}\n\n\ttransferItemToHistory(item, historyItemData)\n\t{\n\t\tconst index = this.getItemIndex(item);\n\t\tif(index < 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.removeItemByIndex(index);\n\n\t\tthis.refreshLayout();\n\t\tthis._manager.processSheduleLayoutChange();\n\n\t\tconst historyItem = this._history.createItem(historyItemData);\n\t\tthis._history.addItem(historyItem, 0);\n\t\thistoryItem.layout({ add: false });\n\n\t\tconst animation = ItemNew.create(\n\t\t\t\"\",\n\t\t\t{\n\t\t\t\tinitialItem: item,\n\t\t\t\tfinalItem: historyItem,\n\t\t\t\tanchor: this._history.createAnchor(),\n\t\t\t\tevents: {complete: BX.delegate(this.onTransferComplete, this)}\n\t\t\t}\n\t\t);\n\t\tanimation.run();\n\t}\n\n\tonTransferComplete()\n\t{\n\t\tthis._history.refreshLayout();\n\n\t\tif(this._items.length === 0)\n\t\t{\n\t\t\tthis.addStub();\n\t\t}\n\t}\n\n\tonItemMarkedAsDone(item, params)\n\t{\n\t}\n\n\taddStub()\n\t{\n\t\tif(!this._stub)\n\t\t{\n\t\t\tlet stubClassName = \"crm-entity-stream-section crm-entity-stream-section-planned crm-entity-stream-section-notTask\";\n\t\t\tlet stubIconClassName = \"crm-entity-stream-section-icon crm-entity-stream-section-icon-info\";\n\t\t\tconst canAddTodo = this.getManager().getSetting('enableTodo', false);\n\t\t\tif (canAddTodo && !this.isReadOnly())\n\t\t\t{\n\t\t\t\tstubClassName += ' --active';\n\t\t\t}\n\n\t\t\tlet stubMessage = this.getMessage(\"stub\");\n\n\t\t\tconst ownerTypeId = this._manager.getOwnerTypeId();\n\t\t\tif(ownerTypeId === BX.CrmEntityType.enumeration.lead)\n\t\t\t{\n\t\t\t\tstubMessage = this.getMessage(\"leadStub\");\n\t\t\t}\n\t\t\telse if(ownerTypeId === BX.CrmEntityType.enumeration.deal)\n\t\t\t{\n\t\t\t\tstubMessage = this.getMessage(\"dealStub\");\n\t\t\t}\n\n\t\t\tif(this._manager.isStubCounterEnabled())\n\t\t\t{\n\t\t\t\tstubIconClassName += \" crm-entity-stream-section-counter\";\n\t\t\t}\n\n\t\t\tthis._stub = BX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: stubClassName },\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"DIV\", { attrs: { className: stubIconClassName } }),\n\t\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-event\" },\n\t\t\t\t\t\t\t\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-title\" },\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttext: this.getMessage(\"stubTitle\"),\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail\" },\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttext: stubMessage\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t);\n\t\t\tif (canAddTodo && !this.isReadOnly())\n\t\t\t{\n\t\t\t\tBX.bind(this._stub, \"click\", BX.delegate(this.focusOnTodoEditor, this));\n\t\t\t}\n\t\t\tthis._wrapper.appendChild(this._stub);\n\t\t}\n\n\t\tif(this._history && this._history.getItemCount() > 0)\n\t\t{\n\t\t\tBX.removeClass(this._stub, \"crm-entity-stream-section-last\");\n\t\t}\n\t\telse\n\t\t{\n\t\t\tBX.addClass(this._stub, \"crm-entity-stream-section-last\");\n\t\t}\n\t}\n\n\tremoveStub()\n\t{\n\t\tif(this._stub)\n\t\t{\n\t\t\tthis._stub = BX.remove(this._stub);\n\t\t}\n\n\t}\n\n\tfocusOnTodoEditor()\n\t{\n\t\tconst menuBar = this.getManager().getMenuBar();\n\t\tmenuBar.setActiveItemById('todo');\n\n\t\tconst todoEditor = menuBar.getTodoEditor();\n\t\ttodoEditor.setFocused();\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = Schedule.messages;\n\t\treturn m.hasOwnProperty(name) ? m[name] : name;\n\t}\n\n\tanimateItemAdding(item): Promise\n\t{\n\t\titem.addWrapperClass('crm-entity-stream-section-updated', 1000);\n\t\treturn Promise.resolve();\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Schedule();\n\t\tself.initialize(id, settings);\n\t\tSchedule.items[self.getId()] = self;\n\t\treturn self;\n\t}\n\n\tstatic items = {};\n\tstatic messages = {};\n}\n","import History from \"./history\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Modification extends History\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = Modification.messages;\n\t\treturn m.hasOwnProperty(name) ? m[name] : name;\n\t}\n\n\tgetTitle()\n\t{\n\t\treturn this.getTextDataParam(\"TITLE\");\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-section crm-entity-stream-section-info\"}});\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-info\" } })\n\t\t);\n\n\t\tconst content = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\tconst header = this.prepareHeaderLayout();\n\n\t\tconst contentChildren = [];\n\t\tif (BX.type.isNotEmptyString(this.getTextDataParam(\"START_NAME\")))\n\t\t{\n\t\t\tcontentChildren.push(\n\t\t\t\tBX.create(\"SPAN\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-detain-info-status\"},\n\t\t\t\t\t\ttext: this.getTextDataParam(\"START_NAME\")\n\t\t\t\t\t})\n\t\t\t);\n\t\t\tcontentChildren.push(\n\t\t\t\tBX.create(\"SPAN\",{ attrs: { className: \"crm-entity-stream-content-detail-info-separator-icon\" } })\n\t\t\t);\n\t\t}\n\n\t\tif (BX.type.isNotEmptyString(this.getTextDataParam(\"FINISH_NAME\")))\n\t\t{\n\t\t\tcontentChildren.push(\n\t\t\t\tBX.create(\"SPAN\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detain-info-status\" },\n\t\t\t\t\t\ttext: this.getTextDataParam(\"FINISH_NAME\")\n\t\t\t\t\t})\n\t\t\t);\n\t\t}\n\n\n\t\tcontent.appendChild(header);\n\t\tcontent.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail\" },\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-info\" },\n\t\t\t\t\t\t\t\t\tchildren: contentChildren\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t]\n\t\t\t\t})\n\t\t);\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontent.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-content\" }, children: [ content ] })\n\t\t);\n\n\t\treturn wrapper;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Modification();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n\n\tstatic messages = {};\n}\n","import History from \"./history\";\n\n/** @memberof BX.Crm.Timeline.Actions */\nexport default class Conversion extends History\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = Conversion.messages;\n\t\treturn m.hasOwnProperty(name) ? m[name] : name;\n\t}\n\n\tgetTitle()\n\t{\n\t\treturn this.getTextDataParam(\"TITLE\");\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-section crm-entity-stream-section-convert crm-entity-stream-section-history\"}});\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-convert\" } })\n\t\t);\n\n\t\tconst content = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\tconst header = this.prepareHeaderLayout();\n\n\t\tcontent.appendChild(header);\n\n\t\tconst entityNodes = [];\n\t\tconst entityInfos = this.getArrayDataParam(\"ENTITIES\");\n\t\tlet i = 0;\n\t\tconst length = entityInfos.length;\n\t\tfor(; i < length; i++)\n\t\t{\n\t\t\tconst entityInfo = entityInfos[i];\n\n\t\t\tlet entityNode;\n\t\t\tif(BX.prop.getString(entityInfo, 'SHOW_URL', \"\") === \"\")\n\t\t\t{\n\t\t\t\tentityNode = BX.create(\"DIV\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-convert\" },\n\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detain-convert-status\" },\n\t\t\t\t\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t\t\t\t\tBX.create(\"SPAN\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-status-text\" },\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttext: BX.CrmEntityType.getNotFoundMessage(entityInfo['ENTITY_TYPE_ID'])\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tentityNode = BX.create(\"DIV\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-convert\" },\n\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detain-convert-status\" },\n\t\t\t\t\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t\t\t\t\tBX.create(\"SPAN\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-status-text\" },\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttext: entityInfo['ENTITY_TYPE_CAPTION']\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\tBX.create(\"SPAN\", { attrs: { className: \"crm-entity-stream-content-detail-convert-separator-icon\" } }),\n\t\t\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detain-convert-status\" },\n\t\t\t\t\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tattrs:\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName: \"crm-entity-stream-content-detail-target\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\thref: entityInfo['SHOW_URL']\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttext: entityInfo['TITLE']\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t\tentityNodes.push(entityNode);\n\t\t}\n\n\t\tcontent.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail\" },\n\t\t\t\t\tchildren: entityNodes\n\t\t\t\t})\n\t\t);\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontent.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-content\" }, children: [ content ] })\n\t\t);\n\n\t\treturn wrapper;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Conversion();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n\n\tstatic messages = {};\n}\n","import HistoryActivity from \"./history-activity\";\nimport {HistoryEmail} from \"../actions/email\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Email extends HistoryActivity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tprepareHeaderLayout()\n\t{\n\t\tconst header = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-header\"}});\n\t\theader.appendChild(this.prepareTitleLayout());\n\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst emailInfo = BX.prop.getObject(entityData, \"EMAIL_INFO\", null);\n\t\tconst statusText = emailInfo !== null ? BX.prop.getString(emailInfo, \"STATUS_TEXT\", \"\") : \"\";\n\t\tconst error = emailInfo !== null ? BX.prop.getBoolean(emailInfo, \"STATUS_ERROR\", false) : false;\n\t\tconst className = !error ? \"crm-entity-stream-content-event-skipped\" : \"crm-entity-stream-content-event-missing\";\n\t\tif(statusText !== \"\")\n\t\t{\n\t\t\theader.appendChild(\n\t\t\t\tBX.create(\n\t\t\t\t\t\"SPAN\",\n\t\t\t\t\t{\n\t\t\t\t\t\tprops: { className: className},\n\t\t\t\t\t\ttext: statusText\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\n\t\tconst markNode = this.prepareMarkLayout();\n\t\tif(markNode)\n\t\t{\n\t\t\theader.appendChild(markNode);\n\t\t}\n\n\t\theader.appendChild(this.prepareTimeLayout());\n\t\treturn header;\n\t}\n\n\tprepareContextMenuItems()\n\t{\n\t\tconst menuItems = [];\n\n\t\tif (!this.isReadOnly())\n\t\t{\n\t\t\tmenuItems.push({id: \"view\", text: this.getMessage(\"menuView\"), onclick: BX.delegate(this.view, this)});\n\n\t\t\tmenuItems.push({ id: \"remove\", text: this.getMessage(\"menuDelete\"), onclick: BX.delegate(this.processRemoval, this)});\n\n\t\t\tif (this.isFixed() || this._fixedHistory.findItemById(this._id))\n\t\t\t\tmenuItems.push({ id: \"unfasten\", text: this.getMessage(\"menuUnfasten\"), onclick: BX.delegate(this.unfasten, this)});\n\t\t\telse\n\t\t\t\tmenuItems.push({ id: \"fasten\", text: this.getMessage(\"menuFasten\"), onclick: BX.delegate(this.fasten, this)});\n\t\t}\n\n\t\treturn menuItems;\n\t}\n\n\treply()\n\t{\n\t}\n\n\treplyAll()\n\t{\n\t}\n\n\tforward()\n\t{\n\t}\n\n\tgetRemoveMessage()\n\t{\n\t\tconst title = BX.util.htmlspecialchars(this.getTitle());\n\t\treturn this.getMessage('emailRemove').replace(\"#TITLE#\", title);\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\n\t\tlet description = BX.prop.getString(entityData, \"DESCRIPTION_RAW\", \"\");\n\t\tif(description !== \"\")\n\t\t{\n\t\t\t//trim leading spaces\n\t\t\tdescription = description.replace(/^\\s+/,'');\n\t\t}\n\n\t\tconst communication = BX.prop.getObject(entityData, \"COMMUNICATION\", {});\n\t\tconst communicationTitle = BX.prop.getString(communication, \"TITLE\", \"\");\n\t\tconst communicationShowUrl = BX.prop.getString(communication, \"SHOW_URL\", \"\");\n\t\tconst communicationValue = BX.prop.getString(communication, \"VALUE\", \"\");\n\n\t\tconst outerWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-section crm-entity-stream-section-history crm-entity-stream-section-email\"}});\n\t\touterWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-email\" }\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tif (this.isFixed())\n\t\t\tBX.addClass(outerWrapper, 'crm-entity-stream-section-top-fixed');\n\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\touterWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\tchildren: [ wrapper ]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\t//Header\n\t\tconst header = this.prepareHeaderLayout();\n\t\twrapper.appendChild(header);\n\n\t\t//region Context Menu\n\t\tif(this.isContextMenuEnabled())\n\t\t{\n\t\t\twrapper.appendChild(this.prepareContextMenuButton());\n\t\t}\n\t\t//endregion\n\n\t\t//Details\n\t\tconst detailWrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail-email\"}\n\t\t\t}\n\t\t);\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail\" },\n\t\t\t\t\tchildren: [ detailWrapper ]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\t//TODO: Add status text\n\t\t/*\n\t\tdetailWrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-content-detail-email-read-status\" } })\n\t\t);\n\t\t*/\n\n\t\tdetailWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-email-title\" },\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattrs: { href: \"#\" },\n\t\t\t\t\t\t\t\t\tevents: { \"click\": this._headerClickHandler },\n\t\t\t\t\t\t\t\t\ttext: this.getTitle()\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst communicationWrapper = BX.create(\"DIV\",\n\t\t\t{attrs: {className: \"crm-entity-stream-content-detail-email-to\"}}\n\t\t);\n\t\tdetailWrapper.appendChild(communicationWrapper);\n\n\t\t//Communications\n\t\tif(communicationTitle !== \"\")\n\t\t{\n\t\t\tif(communicationShowUrl !== \"\")\n\t\t\t{\n\t\t\t\tcommunicationWrapper.appendChild(\n\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tattrs: { href: communicationShowUrl },\n\t\t\t\t\t\t\ttext: communicationTitle\n\t\t\t\t\t\t}\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tcommunicationWrapper.appendChild(BX.create(\"SPAN\", { text: communicationTitle }));\n\t\t\t}\n\t\t}\n\n\t\tif(communicationValue !== \"\")\n\t\t{\n\t\t\tif(communicationTitle !== \"\")\n\t\t\t{\n\t\t\t\tcommunicationWrapper.appendChild(BX.create(\"SPAN\", { text: \" \" }));\n\t\t\t}\n\t\t\tcommunicationWrapper.appendChild(\n\t\t\t\tBX.create(\n\t\t\t\t\t\"SPAN\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-email-address\" },\n\t\t\t\t\t\ttext: communicationValue\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\n\t\t//Content\n\t\tdetailWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-email-fragment\" },\n\t\t\t\t\tchildren: this.prepareCutOffElements(description, 128, this._headerClickHandler)\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\twrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\t//region  Actions\n\t\tthis._actionContainer = BX.create(\"SPAN\", { attrs: { className: \"crm-entity-stream-content-detail-action\" } });\n\t\twrapper.appendChild(this._actionContainer);\n\t\t//endregion\n\n\t\tif (!this.isReadOnly())\n\t\t\twrapper.appendChild(this.prepareFixedSwitcherLayout());\n\n\t\treturn outerWrapper;\n\t}\n\n\tprepareActions()\n\t{\n\t\tif(this.isReadOnly())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis._actions.push(\n\t\t\tHistoryEmail.create(\n\t\t\t\t\"email\",\n\t\t\t\t{\n\t\t\t\t\titem: this,\n\t\t\t\t\tcontainer: this._actionContainer,\n\t\t\t\t\tentityData: this.getAssociatedEntityData(),\n\t\t\t\t\tactivityEditor: this._activityEditor\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t}\n\n\tshowActions(show)\n\t{\n\t\tif(this._actionContainer)\n\t\t{\n\t\t\tthis._actionContainer.style.display = show ? \"\" : \"none\";\n\t\t}\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Email();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import Activity from \"./activity\";\n\n/** @memberof BX.Crm.Timeline.Actions */\nexport class Call extends Activity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._clickHandler = BX.delegate(this.onClick, this);\n\t\tthis._menu = null;\n\t\tthis._isMenuShown = false;\n\t\tthis._menuItems = null;\n\t}\n\n\tgetButton()\n\t{\n\t\treturn null;\n\t}\n\n\tonClick(e)\n\t{\n\t\tif(typeof(window.top['BXIM']) === 'undefined')\n\t\t{\n\t\t\twindow.alert(this.getMessage(\"telephonyNotSupported\"));\n\t\t\treturn;\n\t\t}\n\n\t\tlet phone = \"\";\n\t\tconst itemData = this.getItemData();\n\t\tconst phones = BX.prop.getArray(itemData, \"PHONE\", []);\n\n\t\tif(phones.length === 1)\n\t\t{\n\t\t\tthis.addCall(phones[0]['VALUE']);\n\t\t}\n\t\telse if(phones.length > 1)\n\t\t{\n\t\t\tthis.showMenu();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst communication = BX.prop.getObject(this._entityData, \"COMMUNICATION\", null);\n\t\t\tif(communication)\n\t\t\t{\n\t\t\t\tif(BX.prop.getString(communication, \"TYPE\") === \"PHONE\")\n\t\t\t\t{\n\t\t\t\t\tphone = BX.prop.getString(communication, \"VALUE\");\n\t\t\t\t\tif(phone)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.addCall(phone);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn BX.PreventDefault(e);\n\t}\n\n\tshowMenu()\n\t{\n\t\tif(this._isMenuShown)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.prepareMenuItems();\n\n\t\tif(!this._menuItems || this._menuItems.length === 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\n\t\tthis._menu = new BX.PopupMenuWindow(\n\t\t\tthis._id,\n\t\t\tthis._container,\n\t\t\tthis._menuItems,\n\t\t\t{\n\t\t\t\toffsetTop: 0,\n\t\t\t\toffsetLeft: 16,\n\t\t\t\tevents:\n\t\t\t\t\t{\n\t\t\t\t\t\tonPopupShow: BX.delegate(this.onMenuShow, this),\n\t\t\t\t\t\tonPopupClose: BX.delegate(this.onMenuClose, this),\n\t\t\t\t\t\tonPopupDestroy: BX.delegate(this.onMenuDestroy, this)\n\t\t\t\t\t}\n\t\t\t}\n\t\t);\n\n\t\tthis._menu.popupWindow.show();\n\t}\n\n\tcloseMenu()\n\t{\n\t\tif(!this._isMenuShown)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif(this._menu)\n\t\t{\n\t\t\tthis._menu.close();\n\t\t}\n\t}\n\n\tprepareMenuItems()\n\t{\n\t\tif(this._menuItems)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst itemData = this.getItemData();\n\t\tconst phones = BX.prop.getArray(itemData, \"PHONE\", []);\n\t\tconst handler = BX.delegate(this.onMenuItemClick, this);\n\t\tthis._menuItems = [];\n\n\t\tif(phones.length === 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet i = 0;\n\t\tconst l = phones.length;\n\t\tfor(; i < l; i++)\n\t\t{\n\t\t\tconst value = BX.prop.getString(phones[i], \"VALUE\");\n\t\t\tconst formattedValue = BX.prop.getString(phones[i], \"VALUE_FORMATTED\");\n\t\t\tconst complexName = BX.prop.getString(phones[i], \"COMPLEX_NAME\");\n\t\t\tconst itemText = (complexName ? complexName + ': ' : '') + (formattedValue ? formattedValue : value);\n\n\t\t\tif(value !== \"\")\n\t\t\t{\n\t\t\t\tthis._menuItems.push({ id: value, text:  itemText, onclick: handler});\n\t\t\t}\n\t\t}\n\t}\n\n\tonMenuItemClick(e, item)\n\t{\n\t\tthis.closeMenu();\n\t\tthis.addCall(item.id);\n\t}\n\n\tonMenuShow()\n\t{\n\t\tthis._isMenuShown = true;\n\t}\n\n\tonMenuClose()\n\t{\n\t\tthis._isMenuShown = false;\n\t\tthis._menu.popupWindow.destroy();\n\t}\n\n\tonMenuDestroy()\n\t{\n\t\tthis._menu = null;\n\t}\n\n\taddCall(phone)\n\t{\n\t\tconst communication = BX.prop.getObject(this._entityData, \"COMMUNICATION\", null);\n\t\tlet entityTypeId = parseInt(BX.prop.getString(communication, \"ENTITY_TYPE_ID\", \"0\"));\n\t\tif(isNaN(entityTypeId))\n\t\t{\n\t\t\tentityTypeId = 0;\n\t\t}\n\n\t\tlet entityId = parseInt(BX.prop.getString(communication, \"ENTITY_ID\", \"0\"));\n\t\tif(isNaN(entityId))\n\t\t{\n\t\t\tentityId = 0;\n\t\t}\n\n\t\tlet ownerTypeId = 0;\n\t\tlet ownerId = 0;\n\n\t\tconst ownerInfo = BX.prop.getObject(this._settings, \"ownerInfo\");\n\t\tif(ownerInfo)\n\t\t{\n\t\t\townerTypeId = BX.prop.getInteger(ownerInfo, \"ENTITY_TYPE_ID\", 0);\n\t\t\townerId = BX.prop.getInteger(ownerInfo, \"ENTITY_ID\", 0);\n\t\t}\n\n\t\tif(ownerTypeId <= 0 || ownerId <= 0)\n\t\t{\n\t\t\townerTypeId = BX.prop.getInteger(this._entityData, \"OWNER_TYPE_ID\", 0);\n\t\t\townerId = BX.prop.getInteger(this._entityData, \"OWNER_ID\", \"0\");\n\t\t}\n\n\t\tif(ownerTypeId <= 0 || ownerId <= 0)\n\t\t{\n\t\t\townerTypeId = entityTypeId;\n\t\t\townerId = entityId;\n\t\t}\n\n\t\tlet activityId = parseInt(BX.prop.getString(this._entityData, \"ID\", \"0\"));\n\t\tif(isNaN(activityId))\n\t\t{\n\t\t\tactivityId = 0;\n\t\t}\n\n\t\tconst params =\n\t\t\t{\n\t\t\t\t\"ENTITY_TYPE_NAME\": BX.CrmEntityType.resolveName(entityTypeId),\n\t\t\t\t\"ENTITY_ID\": entityId,\n\t\t\t\t\"AUTO_FOLD\": true\n\t\t\t};\n\t\tif(ownerTypeId !== entityTypeId || ownerId !== entityId)\n\t\t{\n\t\t\tparams[\"BINDINGS\"] = [ { \"OWNER_TYPE_NAME\": BX.CrmEntityType.resolveName(ownerTypeId), \"OWNER_ID\": ownerId } ];\n\t\t}\n\n\t\tif(activityId > 0)\n\t\t{\n\t\t\tparams[\"SRC_ACTIVITY_ID\"] = activityId;\n\t\t}\n\n\t\twindow.top['BXIM'].phoneTo(phone, params);\n\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = Call.messages;\n\t\treturn m.hasOwnProperty(name) ? m[name] : name;\n\t}\n\n\tstatic messages = {};\n}\n\n/** @memberof BX.Crm.Timeline.Actions */\nexport class HistoryCall extends Call\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._button = null;\n\t}\n\n\tgetButton()\n\t{\n\t\treturn this._button;\n\t}\n\n\tdoLayout()\n\t{\n\t\tthis._button = BX.create(\"A\",\n\t\t\t{\n\t\t\t\tattrs: { className: \"crm-entity-stream-content-action-reply-btn\" },\n\t\t\t\tevents: { \"click\": this._clickHandler }\n\t\t\t}\n\t\t);\n\t\tthis._container.appendChild(this._button);\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new HistoryCall();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n\nexport class ScheduleCall extends Call\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tdoLayout()\n\t{\n\t\tthis._container.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-action-reply-btn\" },\n\t\t\t\t\tevents: { \"click\": this._clickHandler }\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new ScheduleCall();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import {HistoryCall} from \"../actions/call\";\nimport HistoryActivity from \"./history-activity\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Call extends HistoryActivity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._playerDummyClickHandler = BX.delegate(this.onPlayerDummyClick, this);\n\t\tthis._playerWrapper = null;\n\t\tthis._transcriptWrapper = null;\n\t\tthis._mediaFileInfo = null;\n\t}\n\n\tgetTypeDescription()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst callInfo = BX.prop.getObject(entityData, \"CALL_INFO\", null);\n\t\tconst callTypeText = callInfo !== null ? BX.prop.getString(callInfo, \"CALL_TYPE_TEXT\", \"\") : \"\";\n\t\tif(callTypeText !== \"\")\n\t\t{\n\t\t\treturn callTypeText;\n\t\t}\n\n\t\tconst direction = BX.prop.getInteger(entityData, \"DIRECTION\", 0);\n\t\treturn this.getMessage(direction === BX.CrmActivityDirection.incoming ? \"incomingCall\" : \"outgoingCall\");\n\t}\n\n\tprepareHeaderLayout()\n\t{\n\t\tconst header = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-header\"}});\n\t\theader.appendChild(this.prepareTitleLayout());\n\n\t\t//Position is important\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst callInfo = BX.prop.getObject(entityData, \"CALL_INFO\", null);\n\t\tconst hasCallInfo = callInfo !== null;\n\t\tconst isSuccessfull = hasCallInfo ? BX.prop.getBoolean(callInfo, \"SUCCESSFUL\", false) : false;\n\t\tconst statusText = hasCallInfo ? BX.prop.getString(callInfo, \"STATUS_TEXT\", \"\") : \"\";\n\n\t\tif(hasCallInfo && statusText.length)\n\t\t{\n\t\t\theader.appendChild(\n\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs:\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tclassName: isSuccessfull\n\t\t\t\t\t\t\t\t\t? \"crm-entity-stream-content-event-successful\"\n\t\t\t\t\t\t\t\t\t: \"crm-entity-stream-content-event-missing\"\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\ttext: statusText\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\n\t\theader.appendChild(\n\t\t\tBX.create(\"SPAN\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-event-time\" },\n\t\t\t\t\ttext: this.formatTime(this.getCreatedTime())\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\treturn header;\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\n\t\tlet description = BX.prop.getString(entityData, \"DESCRIPTION_RAW\", \"\");\n\t\tif(description !== \"\")\n\t\t{\n\t\t\t//trim leading spaces\n\t\t\tdescription = description.replace(/^\\s+/,'');\n\t\t}\n\n\t\tconst communication = BX.prop.getObject(entityData, \"COMMUNICATION\", {});\n\t\tconst communicationTitle = BX.prop.getString(communication, \"TITLE\", \"\");\n\t\tconst communicationShowUrl = BX.prop.getString(communication, \"SHOW_URL\", \"\");\n\t\tconst communicationValue = BX.prop.getString(communication, \"VALUE\", \"\");\n\t\tconst communicationValueFormatted = BX.prop.getString(communication, \"FORMATTED_VALUE\", communicationValue);\n\n\t\tconst callInfo = BX.prop.getObject(entityData, \"CALL_INFO\", null);\n\t\tconst hasCallInfo = callInfo !== null;\n\t\tconst durationText = hasCallInfo ? BX.prop.getString(callInfo, \"DURATION_TEXT\", \"\") : \"\";\n\t\tconst hasTranscript = hasCallInfo ? BX.prop.getBoolean(callInfo, \"HAS_TRANSCRIPT\", \"\") : \"\";\n\t\tconst isTranscriptPending = hasCallInfo ? BX.prop.getBoolean(callInfo, \"TRANSCRIPT_PENDING\", \"\") : \"\";\n\t\tconst callId = hasCallInfo ? BX.prop.getString(callInfo, \"CALL_ID\", \"\") : \"\";\n\t\tconst callComment = hasCallInfo ? BX.prop.getString(callInfo, \"COMMENT\", \"\") : \"\";\n\n\t\tconst outerWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-section crm-entity-stream-section-history crm-entity-stream-section-call\"}});\n\t\touterWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-call\" }\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tif (this.isFixed())\n\t\t\tBX.addClass(outerWrapper, 'crm-entity-stream-section-top-fixed');\n\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\touterWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\tchildren: [ wrapper ]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\t//Header\n\t\tconst header = this.prepareHeaderLayout();\n\t\twrapper.appendChild(header);\n\n\t\t//region Context Menu\n\t\tif(this.isContextMenuEnabled())\n\t\t{\n\t\t\twrapper.appendChild(this.prepareContextMenuButton());\n\t\t}\n\t\t//endregion\n\n\t\t//Details\n\t\tconst detailWrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail\"}\n\t\t\t}\n\t\t);\n\t\twrapper.appendChild(detailWrapper);\n\n\t\tdetailWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-title\" },\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattrs: { href: \"#\" },\n\t\t\t\t\t\t\t\t\tevents: { \"click\": this._headerClickHandler },\n\t\t\t\t\t\t\t\t\ttext: this.getTitle()\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\t//Content\n\t\tdetailWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-description\" },\n\t\t\t\t\tchildren: this.prepareMultilineCutOffElements(description, 128, this._headerClickHandler)\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tif(hasCallInfo)\n\t\t{\n\t\t\tconst callInfoWrapper = BX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail-call crm-entity-stream-content-detail-call-inline\"}\n\t\t\t\t}\n\t\t\t);\n\t\t\tdetailWrapper.appendChild(callInfoWrapper);\n\n\t\t\tthis._mediaFileInfo = BX.prop.getObject(entityData, \"MEDIA_FILE_INFO\", null);\n\t\t\tif(this._mediaFileInfo !== null)\n\t\t\t{\n\t\t\t\tthis._playerWrapper = this._history.getManager().renderAudioDummy(durationText, this._playerDummyClickHandler);\n\t\t\t\tcallInfoWrapper.appendChild(\n\t\t\t\t\tthis._playerWrapper\n\t\t\t\t);\n\t\t\t\tcallInfoWrapper.appendChild(this._history.getManager().getAudioPlaybackRateSelector().render());\n\t\t\t}\n\n\t\t\tif(hasTranscript)\n\t\t\t{\n\t\t\t\tthis._transcriptWrapper = BX.create(\"DIV\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: \"crm-audio-transcript-wrap-container\"},\n\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\tclick: function(e)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tif(BX.Voximplant && BX.Voximplant.Transcript)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tBX.Voximplant.Transcript.create({\n\t\t\t\t\t\t\t\t\t\tcallId: callId\n\t\t\t\t\t\t\t\t\t}).show();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tchildren: [\n\t\t\t\t\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-audio-transcript-icon\"}\t}),\n\t\t\t\t\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-audio-transcript-conversation\"}, text: BX.message(\"CRM_TIMELINE_CALL_TRANSCRIPT\") } )\n\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t\tcallInfoWrapper.appendChild(this._transcriptWrapper);\n\t\t\t}\n\t\t\telse if(isTranscriptPending)\n\t\t\t{\n\t\t\t\tthis._transcriptWrapper = BX.create(\"DIV\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: \"crm-audio-transcript-wrap-container-pending\"},\n\t\t\t\t\t\tchildren: [\n\t\t\t\t\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-audio-transcript-icon-pending\"}, html: '<svg class=\"crm-transcript-loader-circular\" viewBox=\"25 25 50 50\"><circle class=\"crm-transcript-loader-path\" cx=\"50\" cy=\"50\" r=\"20\" fill=\"none\" stroke-miterlimit=\"10\"></circle></svg>'}),\n\t\t\t\t\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-audio-transcript-conversation\"}, text: BX.message(\"CRM_TIMELINE_CALL_TRANSCRIPT_PENDING\") } )\n\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t\tcallInfoWrapper.appendChild(this._transcriptWrapper);\n\t\t\t}\n\n\t\t\tif(callComment)\n\t\t\t{\n\t\t\t\tdetailWrapper.appendChild(BX.create(\"DIV\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-description\"},\n\t\t\t\t\t\ttext: callComment\n\t\t\t\t\t}\n\t\t\t\t));\n\t\t\t}\n\t\t}\n\t\tconst communicationWrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail-contact-info\"}\n\t\t\t}\n\t\t);\n\t\tdetailWrapper.appendChild(communicationWrapper);\n\n\t\t//Communications\n\t\tif(communicationTitle !== \"\")\n\t\t{\n\t\t\tif(communicationShowUrl !== \"\")\n\t\t\t{\n\t\t\t\tcommunicationWrapper.appendChild(\n\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tattrs: { href: communicationShowUrl },\n\t\t\t\t\t\t\ttext: communicationTitle\n\t\t\t\t\t\t}\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tcommunicationWrapper.appendChild(BX.create(\"SPAN\", { text: communicationTitle }));\n\t\t\t}\n\t\t}\n\n\t\tif(communicationValueFormatted !== \"\")\n\t\t{\n\t\t\tif(communicationTitle !== \"\")\n\t\t\t{\n\t\t\t\tcommunicationWrapper.appendChild(BX.create(\"SPAN\", { text: \" \" }));\n\t\t\t}\n\t\t\tcommunicationWrapper.appendChild(\n\t\t\t\tBX.create(\n\t\t\t\t\t\"SPAN\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-email-address\" },\n\t\t\t\t\t\ttext: communicationValueFormatted\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\twrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\t//region  Actions\n\t\tthis._actionContainer = BX.create(\"SPAN\", { attrs: { className: \"crm-entity-stream-content-detail-action\" } });\n\t\twrapper.appendChild(this._actionContainer);\n\t\t//endregion\n\n\t\tif (!this.isReadOnly()) {\n\n\t\t\twrapper.appendChild(this.prepareFixedSwitcherLayout());\n\t\t}\n\n\n\t\treturn outerWrapper;\n\t}\n\n\tprepareActions()\n\t{\n\t\tif(this.isReadOnly())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis._actions.push(\n\t\t\tHistoryCall.create(\n\t\t\t\t\"call\",\n\t\t\t\t{\n\t\t\t\t\titem: this,\n\t\t\t\t\tcontainer: this._actionContainer,\n\t\t\t\t\tentityData: this.getAssociatedEntityData(),\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\townerInfo: this._history.getOwnerInfo()\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t}\n\n\tgetRemoveMessage()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst direction = BX.prop.getInteger(entityData, \"DIRECTION\", 0);\n\t\tconst messageName = (direction === BX.CrmActivityDirection.incoming) ? 'incomingCallRemove' : 'outgoingCallRemove';\n\t\tconst title = BX.util.htmlspecialchars(this.getTitle());\n\t\treturn this.getMessage(messageName).replace(\"#TITLE#\", title);\n\t}\n\n\tonPlayerDummyClick(e)\n\t{\n\t\tconst stubNode = this._playerWrapper.querySelector(\".crm-audio-cap-wrap\");\n\t\tif(stubNode)\n\t\t{\n\t\t\tBX.addClass(stubNode, \"crm-audio-cap-wrap-loader\");\n\t\t}\n\n\t\tthis._history.getManager().getAudioPlaybackRateSelector().addPlayer(this._history.getManager().loadMediaPlayer(\n\t\t\t\"history_\" + this.getId(),\n\t\t\tthis._mediaFileInfo[\"URL\"],\n\t\t\tthis._mediaFileInfo[\"TYPE\"],\n\t\t\tthis._playerWrapper,\n\t\t\tthis._mediaFileInfo[\"DURATION\"],\n\t\t\t{\n\t\t\t\tplaybackRate: this._history.getManager().getAudioPlaybackRateSelector().getRate()\n\t\t\t}\n\t\t));\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Call();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import HistoryActivity from \"./history-activity\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Meeting extends HistoryActivity\n{\n\tconstructor()\n\t{\n\t\tsuper()\n\t}\n\n\tprepareHeaderLayout()\n\t{\n\t\tconst header = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-header\"}});\n\t\theader.appendChild(this.prepareTitleLayout());\n\n\t\tconst markNode = this.prepareMarkLayout();\n\t\tif(markNode)\n\t\t{\n\t\t\theader.appendChild(markNode);\n\t\t}\n\n\t\theader.appendChild(this.prepareTimeLayout());\n\n\t\treturn header;\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\n\t\tlet description = BX.prop.getString(entityData, \"DESCRIPTION_RAW\", \"\");\n\t\tif(description !== \"\")\n\t\t{\n\t\t\t//trim leading spaces\n\t\t\tdescription = description.replace(/^\\s+/,'');\n\t\t}\n\n\t\tconst communication = BX.prop.getObject(entityData, \"COMMUNICATION\", {});\n\t\tconst communicationTitle = BX.prop.getString(communication, \"TITLE\", \"\");\n\t\tconst communicationShowUrl = BX.prop.getString(communication, \"SHOW_URL\", \"\");\n\t\tconst communicationValue = BX.prop.getString(communication, \"VALUE\", \"\");\n\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-section crm-entity-stream-section-history crm-entity-stream-section-meeting\"}});\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-meeting\" } })\n\t\t);\n\n\t\tif(this.isContextMenuEnabled())\n\t\t{\n\t\t\twrapper.appendChild(this.prepareContextMenuButton());\n\t\t}\n\n\t\tif (this.isFixed())\n\t\t\tBX.addClass(wrapper, 'crm-entity-stream-section-top-fixed');\n\n\t\tconst contentWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\tchildren: [contentWrapper]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst header = this.prepareHeaderLayout();\n\t\tcontentWrapper.appendChild(header);\n\n\t\tconst detailWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-detail\"}});\n\t\tcontentWrapper.appendChild(detailWrapper);\n\n\t\tdetailWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-title\" },\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattrs: { href: \"#\" },\n\t\t\t\t\t\t\t\t\tevents: { \"click\": this._headerClickHandler },\n\t\t\t\t\t\t\t\t\ttext: this.getTitle()\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\t//Content\n\t\tdetailWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-description\" },\n\t\t\t\t\tchildren: this.prepareCutOffElements(description, 128, this._headerClickHandler)\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst communicationWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-detail-contact-info\"}});\n\t\tdetailWrapper.appendChild(communicationWrapper);\n\n\t\tif(communicationTitle !== '')\n\t\t{\n\t\t\tcommunicationWrapper.appendChild(\n\t\t\t\tBX.create(\"SPAN\",\n\t\t\t\t\t{ text: this.getMessage(\"reciprocal\") + \": \" }\n\t\t\t\t)\n\t\t\t);\n\n\t\t\tif(communicationShowUrl !== '')\n\t\t\t{\n\t\t\t\tcommunicationWrapper.appendChild(BX.create(\"A\", { attrs: { href: communicationShowUrl }, text: communicationTitle }));\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tcommunicationWrapper.appendChild(BX.create(\"SPAN\", { text: communicationTitle }));\n\t\t\t}\n\t\t}\n\n\t\tcommunicationWrapper.appendChild(BX.create(\"SPAN\", { text: \" \" + communicationValue }));\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontentWrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\t//region  Actions\n\t\tthis._actionContainer = BX.create(\"SPAN\", { attrs: { className: \"crm-entity-stream-content-detail-action\" } });\n\t\tcontentWrapper.appendChild(this._actionContainer);\n\t\t//endregion\n\n\t\tif (!this.isReadOnly())\n\t\t\tcontentWrapper.appendChild(this.prepareFixedSwitcherLayout());\n\n\t\treturn wrapper;\n\t}\n\n\tgetRemoveMessage()\n\t{\n\t\tconst title = BX.util.htmlspecialchars(this.getTitle());\n\t\treturn this.getMessage('meetingRemove').replace(\"#TITLE#\", title);\n\t}\n\n\tprepareActions()\n\t{\n\t}\n\n\tshowActions(show)\n\t{\n\t\tif(this._actionContainer)\n\t\t{\n\t\t\tthis._actionContainer.style.display = show ? \"\" : \"none\";\n\t\t}\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Meeting();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import HistoryActivity from \"./history-activity\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Task extends HistoryActivity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tprepareHeaderLayout()\n\t{\n\t\tconst header = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-header\"}});\n\t\theader.appendChild(this.prepareTitleLayout());\n\n\t\tconst markNode = this.prepareMarkLayout();\n\t\tif(markNode)\n\t\t{\n\t\t\theader.appendChild(markNode);\n\t\t}\n\n\t\theader.appendChild(this.prepareTimeLayout());\n\n\t\treturn header;\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\n\t\tlet description = BX.prop.getString(entityData, \"DESCRIPTION_RAW\", \"\");\n\t\tif(description !== \"\")\n\t\t{\n\t\t\t//trim leading spaces\n\t\t\tdescription = description.replace(/^\\s+/,'');\n\t\t}\n\n\t\tconst communication = BX.prop.getObject(entityData, \"COMMUNICATION\", {});\n\t\tconst communicationTitle = BX.prop.getString(communication, \"TITLE\", \"\");\n\t\tconst communicationShowUrl = BX.prop.getString(communication, \"SHOW_URL\", \"\");\n\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-section crm-entity-stream-section-history crm-entity-stream-section-task\"}});\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-task\" } })\n\t\t);\n\n\t\tif(this.isContextMenuEnabled())\n\t\t{\n\t\t\twrapper.appendChild(this.prepareContextMenuButton());\n\t\t}\n\n\t\tif (this.isFixed())\n\t\t\tBX.addClass(wrapper, 'crm-entity-stream-section-top-fixed');\n\n\t\tconst contentWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\tchildren: [contentWrapper]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst header = this.prepareHeaderLayout();\n\t\tcontentWrapper.appendChild(header);\n\n\t\tconst detailWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-detail\"}});\n\t\tcontentWrapper.appendChild(detailWrapper);\n\n\t\tdetailWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-title\" },\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattrs: { href: \"#\" },\n\t\t\t\t\t\t\t\t\tevents: { \"click\": this._headerClickHandler },\n\t\t\t\t\t\t\t\t\ttext: this.getTitle()\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\t//Content\n\t\tdetailWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-description\" },\n\t\t\t\t\tchildren: this.prepareCutOffElements(description, 128, this._headerClickHandler)\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst communicationWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-detail-contact-info\"}});\n\t\tdetailWrapper.appendChild(communicationWrapper);\n\n\t\tif(communicationTitle !== '')\n\t\t{\n\t\t\tcommunicationWrapper.appendChild(\n\t\t\t\tBX.create(\"SPAN\",\n\t\t\t\t\t{ text: this.getMessage(\"reciprocal\") + \": \" }\n\t\t\t\t)\n\t\t\t);\n\n\t\t\tif(communicationShowUrl !== '')\n\t\t\t{\n\t\t\t\tcommunicationWrapper.appendChild(BX.create(\"A\", { attrs: { href: communicationShowUrl }, text: communicationTitle }));\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tcommunicationWrapper.appendChild(BX.create(\"SPAN\", { text: communicationTitle }));\n\t\t\t}\n\t\t}\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontentWrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\t//region  Actions\n\t\tthis._actionContainer = BX.create(\"SPAN\", { attrs: { className: \"crm-entity-stream-content-detail-action\" } });\n\t\tcontentWrapper.appendChild(this._actionContainer);\n\t\t//endregion\n\n\t\tif (!this.isReadOnly())\n\t\t\tcontentWrapper.appendChild(this.prepareFixedSwitcherLayout());\n\n\t\treturn wrapper;\n\t}\n\n\tprepareActions()\n\t{\n\t}\n\n\tgetRemoveMessage()\n\t{\n\t\tconst title = BX.util.htmlspecialchars(this.getTitle());\n\t\treturn this.getMessage('taskRemove').replace(\"#TITLE#\", title);\n\t}\n\n\tshowActions(show)\n\t{\n\t\tif(this._actionContainer)\n\t\t{\n\t\t\tthis._actionContainer.style.display = show ? \"\" : \"none\";\n\t\t}\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Task();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import HistoryActivity from \"./history-activity\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class WebForm extends HistoryActivity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tprepareHeaderLayout()\n\t{\n\t\tconst header = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-header\"}});\n\t\theader.appendChild(this.prepareTitleLayout());\n\t\theader.appendChild(this.prepareTimeLayout());\n\n\t\treturn header;\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-section crm-entity-stream-section-history crm-entity-stream-section-crmForm\"}});\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-crmForm\" } })\n\t\t);\n\n\t\tconst contentWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\tchildren: [contentWrapper]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tif (this.isFixed())\n\t\t\tBX.addClass(wrapper, 'crm-entity-stream-section-top-fixed');\n\n\t\tconst header = this.prepareHeaderLayout();\n\t\tcontentWrapper.appendChild(header);\n\n\t\tconst detailWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-detail\"}});\n\t\tcontentWrapper.appendChild(detailWrapper);\n\n\t\tdetailWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-title\" },\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattrs: { href: \"#\" },\n\t\t\t\t\t\t\t\t\tevents: { \"click\": this._headerClickHandler },\n\t\t\t\t\t\t\t\t\ttext: this.getTitle()\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontentWrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\t//region  Actions\n\t\tthis._actionContainer = BX.create(\"SPAN\", { attrs: { className: \"crm-entity-stream-content-detail-action\" } });\n\t\tcontentWrapper.appendChild(this._actionContainer);\n\t\t//endregion\n\n\t\tif (!this.isReadOnly())\n\t\t\tcontentWrapper.appendChild(this.prepareFixedSwitcherLayout());\n\n\t\treturn wrapper;\n\t}\n\n\tprepareActions()\n\t{\n\t}\n\n\tshowActions(show)\n\t{\n\t\tif(this._actionContainer)\n\t\t{\n\t\t\tthis._actionContainer.style.display = show ? \"\" : \"none\";\n\t\t}\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new WebForm();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import HistoryActivity from \"./history-activity\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Sms extends HistoryActivity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tprepareHeaderLayout()\n\t{\n\t\tconst header = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-header\"}});\n\t\theader.appendChild(this.prepareTitleLayout());\n\t\theader.appendChild(this.prepareMessageStatusLayout());\n\t\theader.appendChild(this.prepareTimeLayout());\n\n\t\treturn header;\n\t}\n\n\tprepareMessageStatusLayout()\n\t{\n\t\treturn this._messageStatusNode = BX.create(\"SPAN\");\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\n\t\tconst communication = BX.prop.getObject(entityData, \"COMMUNICATION\", {});\n\t\tconst communicationTitle = BX.prop.getString(communication, \"TITLE\", \"\");\n\t\tconst communicationShowUrl = BX.prop.getString(communication, \"SHOW_URL\", \"\");\n\t\tconst communicationValue = BX.prop.getString(communication, \"VALUE\", \"\");\n\t\tconst smsInfo = BX.prop.getObject(entityData, \"SMS_INFO\", {});\n\n\t\tconst wrapperClassName = \"crm-entity-stream-section-sms\";\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-section crm-entity-stream-section-history\" + \" \" + wrapperClassName}});\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-sms\" } })\n\t\t);\n\n\t\tif (this.isFixed())\n\t\t\tBX.addClass(wrapper, 'crm-entity-stream-section-top-fixed');\n\n\t\tconst contentWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\tchildren: [contentWrapper]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst header = this.prepareHeaderLayout();\n\t\tcontentWrapper.appendChild(header);\n\n\t\tconst detailWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-detail\"}});\n\t\tcontentWrapper.appendChild(detailWrapper);\n\n\t\tconst messageWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-detail-sms\"}});\n\n\t\tif (smsInfo.senderId)\n\t\t{\n\t\t\tconst senderId = smsInfo.senderId;\n\t\t\tlet senderName = smsInfo.senderShortName;\n\t\t\tif (senderId === 'rest' && smsInfo.fromName)\n\t\t\t{\n\t\t\t\tsenderName = smsInfo.fromName;\n\t\t\t}\n\n\t\t\tconst messageSenderWrapper = BX.create(\"DIV\", {\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail-sms-status\"},\n\t\t\t\tchildren: [\n\t\t\t\t\tBX.message('CRM_TIMELINE_SMS_SENDER') + ' ',\n\t\t\t\t\tBX.create('STRONG', {text: senderName})\n\t\t\t\t]\n\t\t\t});\n\t\t\tif (senderId !== 'rest' && smsInfo.fromName)\n\t\t\t{\n\t\t\t\tmessageSenderWrapper.innerHTML += ' '+BX.message('CRM_TIMELINE_SMS_FROM')+' ';\n\t\t\t\tmessageSenderWrapper.appendChild(BX.create('STRONG', {text: smsInfo.fromName}));\n\t\t\t}\n\t\t\tmessageWrapper.appendChild(messageSenderWrapper);\n\t\t}\n\n\t\tif (smsInfo.statusId !== '')\n\t\t{\n\t\t\tthis.setMessageStatus(smsInfo.statusId, smsInfo.errorText);\n\t\t}\n\n\t\tconst bodyText = BX.util.htmlspecialchars(entityData['DESCRIPTION_RAW']).replace(/\\r\\n|\\r|\\n/g, \"<br/>\");\n\t\tconst messageBodyWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-detail-sms-fragment\"}});\n\t\tmessageBodyWrapper.appendChild(BX.create('SPAN', {html: bodyText}));\n\n\t\tmessageWrapper.appendChild(messageBodyWrapper);\n\t\tdetailWrapper.appendChild(messageWrapper);\n\n\t\tconst communicationWrapper = BX.create(\"DIV\", {\n\t\t\tattrs: {className: \"crm-entity-stream-content-detail-contact-info\"},\n\t\t\ttext: BX.message('CRM_TIMELINE_SMS_TO') + ' '\n\t\t});\n\t\tdetailWrapper.appendChild(communicationWrapper);\n\n\t\tif(communicationTitle !== '')\n\t\t{\n\t\t\tif(communicationShowUrl !== '')\n\t\t\t{\n\t\t\t\tcommunicationWrapper.appendChild(BX.create(\"A\", { attrs: { href: communicationShowUrl }, text: communicationTitle }));\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tcommunicationWrapper.appendChild(BX.create(\"SPAN\", { text: communicationTitle }));\n\t\t\t}\n\t\t}\n\n\t\tcommunicationWrapper.appendChild(BX.create(\"SPAN\", { text: \" \" + communicationValue }));\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontentWrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\t//region  Actions\n\t\tthis._actionContainer = BX.create(\"SPAN\", { attrs: { className: \"crm-entity-stream-content-detail-action\" } });\n\t\tcontentWrapper.appendChild(this._actionContainer);\n\t\t//endregion\n\n\t\tif (!this.isReadOnly())\n\t\t\tcontentWrapper.appendChild(this.prepareFixedSwitcherLayout());\n\n\t\treturn wrapper;\n\t}\n\n\tprepareActions()\n\t{\n\t}\n\n\tshowActions(show)\n\t{\n\t\tif(this._actionContainer)\n\t\t{\n\t\t\tthis._actionContainer.style.display = show ? \"\" : \"none\";\n\t\t}\n\t}\n\n\tsetMessageStatus(status, errorText)\n\t{\n\t\tstatus = parseInt(status);\n\t\tif (isNaN(status) || !this._messageStatusNode)\n\t\t\treturn;\n\n\t\tconst statuses = this.getSetting('smsStatusDescriptions', {});\n\t\tif (statuses.hasOwnProperty(status))\n\t\t{\n\t\t\tthis._messageStatusNode.textContent = statuses[status];\n\t\t\tthis.setMessageStatusErrorText(errorText);\n\n\t\t\tconst statusSemantic = this.getMessageStatusSemantic(status);\n\t\t\tthis.setMessageStatusSemantic(statusSemantic);\n\t\t}\n\t}\n\n\tsetMessageStatusSemantic(semantic)\n\t{\n\t\tconst classMap =\n\t\t\t{\n\t\t\t\tprocess: 'crm-entity-stream-content-event-process',\n\t\t\t\tsuccess: 'crm-entity-stream-content-event-successful',\n\t\t\t\tfailure: 'crm-entity-stream-content-event-missing'\n\t\t\t};\n\n\t\tfor (let checkSemantic in classMap)\n\t\t{\n\t\t\tconst fn = (checkSemantic === semantic) ? 'addClass' : 'removeClass';\n\t\t\tBX[fn](this._messageStatusNode, classMap[checkSemantic]);\n\t\t}\n\t}\n\n\tsetMessageStatusErrorText(errorText)\n\t{\n\t\tif (!errorText)\n\t\t{\n\t\t\tthis._messageStatusNode.removeAttribute('title');\n\t\t\tBX.removeClass(this._messageStatusNode,'crm-entity-stream-content-event-error-tip');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis._messageStatusNode.setAttribute('title', errorText);\n\t\t\tBX.addClass(this._messageStatusNode,'crm-entity-stream-content-event-error-tip');\n\t\t}\n\t}\n\n\tgetMessageStatusSemantic(status)\n\t{\n\t\tconst semantics = this.getSetting('smsStatusSemantics', {});\n\t\treturn semantics.hasOwnProperty(status) ? semantics[status] : 'failure';\n\t}\n\n\tsubscribe()\n\t{\n\t\tif (!BX.CrmSmsWatcher)\n\t\t\treturn;\n\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst smsInfo = BX.prop.getObject(entityData, \"SMS_INFO\", {});\n\n\t\tif (smsInfo.id)\n\t\t{\n\t\t\tBX.CrmSmsWatcher.subscribeOnMessageUpdate(\n\t\t\t\tsmsInfo.id,\n\t\t\t\tthis.onMessageUpdate.bind(this)\n\t\t\t);\n\t\t}\n\t}\n\n\tonMessageUpdate(message)\n\t{\n\t\tif (message.STATUS_ID)\n\t\t{\n\t\t\tthis.setMessageStatus(message.STATUS_ID, message.EXEC_ERROR);\n\t\t}\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Sms();\n\t\tself.initialize(id, settings);\n\t\tself.subscribe();\n\t\treturn self;\n\t}\n}\n","import HistoryActivity from \"./history-activity\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Request extends HistoryActivity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tprepareHeaderLayout()\n\t{\n\t\tconst header = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-header\"}});\n\t\theader.appendChild(this.prepareTitleLayout());\n\t\theader.appendChild(this.prepareTimeLayout());\n\n\t\treturn header;\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\n\t\tlet description = BX.prop.getString(entityData, \"DESCRIPTION_RAW\", \"\");\n\t\tif(description !== \"\")\n\t\t{\n\t\t\t//trim leading spaces\n\t\t\tdescription = description.replace(/^\\s+/,'');\n\t\t}\n\n\t\t//var entityData = this.getAssociatedEntityData();\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-section crm-entity-stream-section-today crm-entity-stream-section-robot\"}});\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-robot\" } })\n\t\t);\n\t\tif(this.isContextMenuEnabled())\n\t\t{\n\t\t\twrapper.appendChild(this.prepareContextMenuButton());\n\t\t}\n\n\t\tif (this.isFixed())\n\t\t\tBX.addClass(wrapper, 'crm-entity-stream-section-top-fixed');\n\n\t\tconst contentWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\tchildren: [contentWrapper]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst header = this.prepareHeaderLayout();\n\t\tcontentWrapper.appendChild(header);\n\n\t\tconst detailWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-detail\"}});\n\t\tcontentWrapper.appendChild(detailWrapper);\n\n\t\tdetailWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-title\" },\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattrs: { href: \"#\" },\n\t\t\t\t\t\t\t\t\tevents: { \"click\": this._headerClickHandler },\n\t\t\t\t\t\t\t\t\ttext: this.getTitle()\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\t//Content\n\t\tdetailWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-description\" },\n\t\t\t\t\tchildren: this.prepareCutOffElements(description, 128, this._headerClickHandler)\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontentWrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\t//region  Actions\n\t\tthis._actionContainer = BX.create(\"SPAN\", { attrs: { className: \"crm-entity-stream-content-detail-action\" } });\n\t\tcontentWrapper.appendChild(this._actionContainer);\n\t\t//endregion\n\n\t\tif (!this.isReadOnly())\n\t\t\tcontentWrapper.appendChild(this.prepareFixedSwitcherLayout());\n\n\t\treturn wrapper;\n\t}\n\n\tprepareActions()\n\t{\n\t}\n\n\tshowActions(show)\n\t{\n\t\tif(this._actionContainer)\n\t\t{\n\t\t\tthis._actionContainer.style.display = show ? \"\" : \"none\";\n\t\t}\n\t}\n\n\tisEditable()\n\t{\n\t\treturn false;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Request();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import HistoryActivity from \"./history-activity\";\nimport {OpenLine as OpenLineAction} from \"../actions/openline\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class OpenLine extends HistoryActivity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tprepareHeaderLayout()\n\t{\n\t\tconst header = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-header\"}});\n\t\theader.appendChild(this.prepareTitleLayout());\n\t\theader.appendChild(this.prepareTimeLayout());\n\n\t\treturn header;\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\n\t\tlet description = BX.prop.getString(entityData, \"DESCRIPTION_RAW\", \"\");\n\t\tif(description !== \"\")\n\t\t{\n\t\t\t//trim leading spaces\n\t\t\tdescription = description.replace(/^\\s+/,'');\n\t\t}\n\n\t\tconst communication = BX.prop.getObject(entityData, \"COMMUNICATION\", {});\n\t\tconst communicationTitle = BX.prop.getString(communication, \"TITLE\", \"\");\n\t\tconst communicationShowUrl = BX.prop.getString(communication, \"SHOW_URL\", \"\");\n\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-section crm-entity-stream-section-history crm-entity-stream-section-IM\"}});\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-IM\" } })\n\t\t);\n\n\t\tif(this.isContextMenuEnabled())\n\t\t{\n\t\t\twrapper.appendChild(this.prepareContextMenuButton());\n\t\t}\n\n\t\tif (this.isFixed())\n\t\t\tBX.addClass(wrapper, 'crm-entity-stream-section-top-fixed');\n\n\t\tconst contentWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\tchildren: [contentWrapper]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst header = this.prepareHeaderLayout();\n\t\tcontentWrapper.appendChild(header);\n\n\t\tconst detailWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-detail\"}});\n\t\tcontentWrapper.appendChild(detailWrapper);\n\n\t\tdetailWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-title\" },\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattrs: { href: \"#\" },\n\t\t\t\t\t\t\t\t\tevents: { \"click\": this._headerClickHandler },\n\t\t\t\t\t\t\t\t\ttext: this.getTitle()\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\t//Content\n\t\tconst entityDetailWrapper = BX.create(\"DIV\",\n\t\t\t{attrs: {className: \"crm-entity-stream-content-detail-IM\"}}\n\t\t);\n\t\tdetailWrapper.appendChild(entityDetailWrapper);\n\n\t\tconst messageWrapper = BX.create(\"DIV\",\n\t\t\t{attrs: {className: \"crm-entity-stream-content-detail-IM-messages\"}}\n\t\t);\n\t\tentityDetailWrapper.appendChild(messageWrapper);\n\n\t\tconst openLineData = BX.prop.getObject(this.getAssociatedEntityData(), \"OPENLINE_INFO\", null);\n\t\tif(openLineData)\n\t\t{\n\t\t\tconst messages = BX.prop.getArray(openLineData, \"MESSAGES\", []);\n\t\t\tlet i = 0;\n\t\t\tconst length = messages.length;\n\t\t\tfor(; i < length; i++)\n\t\t\t{\n\t\t\t\tconst message = messages[i];\n\t\t\t\tconst isExternal = BX.prop.getBoolean(message, \"IS_EXTERNAL\", true);\n\n\t\t\t\tmessageWrapper.appendChild(\n\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tattrs:\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tclassName: isExternal\n\t\t\t\t\t\t\t\t\t\t? \"crm-entity-stream-content-detail-IM-message-incoming\"\n\t\t\t\t\t\t\t\t\t\t: \"crm-entity-stream-content-detail-IM-message-outgoing\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\thtml: BX.prop.getString(message, \"MESSAGE\", \"\")\n\t\t\t\t\t\t}\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\n\t\tconst communicationWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-detail-contact-info\"}});\n\t\tdetailWrapper.appendChild(communicationWrapper);\n\n\t\tif(communicationTitle !== '')\n\t\t{\n\t\t\tcommunicationWrapper.appendChild(\n\t\t\t\tBX.create(\"SPAN\",\n\t\t\t\t\t{ text: this.getMessage(\"reciprocal\") + \": \" }\n\t\t\t\t)\n\t\t\t);\n\n\t\t\tif(communicationShowUrl !== '')\n\t\t\t{\n\t\t\t\tcommunicationWrapper.appendChild(BX.create(\"A\", { attrs: { href: communicationShowUrl }, text: communicationTitle }));\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tcommunicationWrapper.appendChild(BX.create(\"SPAN\", { text: communicationTitle }));\n\t\t\t}\n\t\t}\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontentWrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\t//region  Actions\n\t\tthis._actionContainer = BX.create(\"SPAN\", { attrs: { className: \"crm-entity-stream-content-detail-action\" } });\n\t\tcontentWrapper.appendChild(this._actionContainer);\n\t\t//endregion\n\n\t\tif (!this.isReadOnly())\n\t\t\tcontentWrapper.appendChild(this.prepareFixedSwitcherLayout());\n\n\t\treturn wrapper;\n\t}\n\n\tprepareActions()\n\t{\n\t\tif(this.isReadOnly())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis._actions.push(\n\t\t\tOpenLineAction.create(\n\t\t\t\t\"openline\",\n\t\t\t\t{\n\t\t\t\t\titem: this,\n\t\t\t\t\tcontainer: this._actionContainer,\n\t\t\t\t\tentityData: this.getAssociatedEntityData(),\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\townerInfo: this._history.getOwnerInfo()\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t}\n\n\tview()\n\t{\n\t\tif(typeof(window.top['BXIM']) === 'undefined')\n\t\t{\n\t\t\twindow.alert(this.getMessage(\"openLineNotSupported\"));\n\t\t\treturn;\n\t\t}\n\n\t\tlet slug = \"\";\n\t\tconst communication = BX.prop.getObject(this.getAssociatedEntityData(), \"COMMUNICATION\", null);\n\t\tif(communication)\n\t\t{\n\t\t\tif(BX.prop.getString(communication, \"TYPE\") === \"IM\")\n\t\t\t{\n\t\t\t\tslug = BX.prop.getString(communication, \"VALUE\");\n\t\t\t}\n\t\t}\n\n\t\tif(slug !== \"\")\n\t\t{\n\t\t\twindow.top['BXIM'].openMessengerSlider(slug, {RECENT: 'N', MENU: 'N'});\n\t\t}\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new OpenLine();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import HistoryActivity from \"./history-activity\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Rest extends HistoryActivity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tprepareHeaderLayout()\n\t{\n\t\tconst header = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-header\"}});\n\t\theader.appendChild(this.prepareTitleLayout());\n\t\theader.appendChild(this.prepareTimeLayout());\n\n\t\treturn header;\n\t}\n\n\tgetTypeDescription()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tif (entityData['APP_TYPE'] && entityData['APP_TYPE']['NAME'])\n\t\t{\n\t\t\treturn entityData['APP_TYPE']['NAME'];\n\t\t}\n\n\t\treturn super.getTypeDescription();\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\n\t\tlet description = BX.prop.getString(entityData, \"DESCRIPTION_RAW\", \"\");\n\t\tif(description !== \"\")\n\t\t{\n\t\t\t//trim leading spaces\n\t\t\tdescription = description.replace(/^\\s+/,'');\n\t\t}\n\n\t\t//var entityData = this.getAssociatedEntityData();\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-section crm-entity-stream-section-today crm-entity-stream-section-rest\"}});\n\n\t\tconst iconNode = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-rest\"}});\n\n\t\twrapper.appendChild(iconNode);\n\n\t\tif (entityData['APP_TYPE'] && entityData['APP_TYPE']['ICON_SRC'])\n\t\t{\n\t\t\tif (iconNode)\n\t\t\t{\n\t\t\t\ticonNode.style.backgroundImage = \"url('\" +  entityData['APP_TYPE']['ICON_SRC'] + \"')\";\n\t\t\t\ticonNode.style.backgroundPosition = \"center center\";\n\t\t\t\ticonNode.style.backgroundSize = \"cover\";\n\t\t\t\ticonNode.style.backgroundColor = \"transparent\";\n\t\t\t}\n\t\t}\n\n\t\tif (this.isFixed())\n\t\t\tBX.addClass(wrapper, 'crm-entity-stream-section-top-fixed');\n\n\t\tconst contentWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\tchildren: [contentWrapper]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst header = this.prepareHeaderLayout();\n\t\tcontentWrapper.appendChild(header);\n\n\t\tconst detailWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-detail\"}});\n\t\tcontentWrapper.appendChild(detailWrapper);\n\n\t\tdetailWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-title\" },\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattrs: { href: \"#\" },\n\t\t\t\t\t\t\t\t\tevents: { \"click\": this._headerClickHandler },\n\t\t\t\t\t\t\t\t\ttext: this.getTitle()\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\t//Content\n\t\tdetailWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-description\" },\n\t\t\t\t\tchildren: this.prepareCutOffElements(description, 128, this._headerClickHandler)\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontentWrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\t//region  Actions\n\t\tthis._actionContainer = BX.create(\"SPAN\", { attrs: { className: \"crm-entity-stream-content-detail-action\" } });\n\t\tcontentWrapper.appendChild(this._actionContainer);\n\t\t//endregion\n\n\t\tif (!this.isReadOnly())\n\t\t\tcontentWrapper.appendChild(this.prepareFixedSwitcherLayout());\n\n\t\treturn wrapper;\n\t}\n\n\tprepareActions()\n\t{\n\t}\n\n\tshowActions(show)\n\t{\n\t\tif(this._actionContainer)\n\t\t{\n\t\t\tthis._actionContainer.style.display = show ? \"\" : \"none\";\n\t\t}\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Rest();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import HistoryActivity from \"./history-activity\";\n\n/** @memberof BX.Crm.Timeline.Actions */\nexport default class Visit extends HistoryActivity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._playerDummyClickHandler = BX.delegate(this.onPlayerDummyClick, this);\n\t\tthis._playerWrapper = null;\n\t\tthis._transcriptWrapper = null;\n\t\tthis._mediaFileInfo = null;\n\t}\n\n\tprepareHeaderLayout()\n\t{\n\t\tconst header = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-header\"}});\n\t\theader.appendChild(this.prepareTitleLayout());\n\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst visitInfo = BX.prop.getObject(entityData, \"VISIT_INFO\", {});\n\t\tconst recordLength = BX.prop.getInteger(visitInfo, \"RECORD_LENGTH\", 0);\n\t\tconst recordLengthFormatted = BX.prop.getString(visitInfo, \"RECORD_LENGTH_FORMATTED_FULL\", \"\");\n\n\t\theader.appendChild(\n\t\t\tBX.create(\"SPAN\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-event-time\" },\n\t\t\t\t\ttext: (recordLength > 0 ? recordLengthFormatted + ', ' + BX.message('CRM_TIMELINE_VISIT_AT') + ' ' : '') + this.formatTime(this.getCreatedTime())\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\treturn header;\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\n\t\tconst communication = BX.prop.getObject(entityData, \"COMMUNICATION\", {});\n\t\tconst communicationTitle = BX.prop.getString(communication, \"TITLE\", \"\");\n\t\tconst communicationShowUrl = BX.prop.getString(communication, \"SHOW_URL\", \"\");\n\n\t\tconst visitInfo = BX.prop.getObject(entityData, \"VISIT_INFO\", {});\n\t\tconst recordLength = BX.prop.getInteger(visitInfo, \"RECORD_LENGTH\", 0);\n\t\tconst recordLengthFormatted = BX.prop.getString(visitInfo, \"RECORD_LENGTH_FORMATTED_SHORT\", \"\");\n\t\tconst vkProfile = BX.prop.getString(visitInfo, \"VK_PROFILE\", \"\");\n\n\t\tconst outerWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-section crm-entity-stream-section-history crm-entity-stream-section-visit\"}});\n\t\touterWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-visit\" }\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\touterWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\tchildren: [ wrapper ]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\t//Header\n\t\tconst header = this.prepareHeaderLayout();\n\t\twrapper.appendChild(header);\n\n\t\t//region Context Menu\n\t\tif(this.isContextMenuEnabled())\n\t\t{\n\t\t\twrapper.appendChild(this.prepareContextMenuButton());\n\t\t}\n\t\t//endregion\n\n\t\t//Details\n\t\tconst detailWrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail crm-entity-stream-content-detail-call-inline\"}\n\t\t\t}\n\t\t);\n\t\twrapper.appendChild(detailWrapper);\n\n\t\tthis._mediaFileInfo = BX.prop.getObject(entityData, \"MEDIA_FILE_INFO\", null);\n\t\tif(this._mediaFileInfo !== null && recordLength > 0)\n\t\t{\n\t\t\tthis._playerWrapper = this._history.getManager().renderAudioDummy(recordLengthFormatted, this._playerDummyClickHandler);\n\t\t\tdetailWrapper.appendChild(\n\t\t\t\t//crm-entity-stream-content-detail-call\n\t\t\t\tthis._playerWrapper\n\t\t\t);\n\t\t\tdetailWrapper.appendChild(this._history.getManager().getAudioPlaybackRateSelector().render());\n\t\t}\n\n\t\tconst communicationWrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail-contact-info\"}\n\t\t\t}\n\t\t);\n\t\twrapper.appendChild(communicationWrapper);\n\n\t\t//Communications\n\t\tif(communicationTitle !== \"\")\n\t\t{\n\t\t\tcommunicationWrapper.appendChild(document.createTextNode(BX.message(\"CRM_TIMELINE_VISIT_WITH\") + ' '));\n\t\t\tif(communicationShowUrl !== \"\")\n\t\t\t{\n\t\t\t\tcommunicationWrapper.appendChild(\n\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tattrs: { href: communicationShowUrl },\n\t\t\t\t\t\t\ttext: communicationTitle\n\t\t\t\t\t\t}\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tcommunicationWrapper.appendChild(BX.create(\"SPAN\", { text: communicationTitle }));\n\t\t\t}\n\t\t}\n\n\t\tif(BX.type.isNotEmptyString(vkProfile))\n\t\t{\n\t\t\tcommunicationWrapper.appendChild(document.createTextNode(\" \"));\n\t\t\tcommunicationWrapper.appendChild(\n\t\t\t\tBX.create(\n\t\t\t\t\t\"a\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs:\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tclassName: \"crm-entity-stream-content-detail-additional\",\n\t\t\t\t\t\t\t\ttarget: \"_blank\",\n\t\t\t\t\t\t\t\thref: this.getVkProfileUrl(vkProfile)\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\ttext: BX.message('CRM_TIMELINE_VISIT_VKONTAKTE_PROFILE')\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t)\n\n\t\t}\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\twrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\treturn outerWrapper;\n\t}\n\n\tonPlayerDummyClick(e)\n\t{\n\t\tconst stubNode = this._playerWrapper.querySelector(\".crm-audio-cap-wrap\");\n\t\tif(stubNode)\n\t\t{\n\t\t\tBX.addClass(stubNode, \"crm-audio-cap-wrap-loader\");\n\t\t}\n\n\t\tthis._history.getManager().getAudioPlaybackRateSelector().addPlayer(this._history.getManager().loadMediaPlayer(\n\t\t\t\"history_\" + this.getId(),\n\t\t\tthis._mediaFileInfo[\"URL\"],\n\t\t\tthis._mediaFileInfo[\"TYPE\"],\n\t\t\tthis._playerWrapper,\n\t\t\tthis._mediaFileInfo[\"DURATION\"],\n\t\t\t{\n\t\t\t\tplaybackRate: this._history.getManager().getAudioPlaybackRateSelector().getRate()\n\t\t\t}\n\t\t));\n\t}\n\n\tgetVkProfileUrl(profile)\n\t{\n\t\treturn 'https://vk.com/' + BX.util.htmlspecialchars(profile);\n\t}\n\n\tview()\n\t{\n\t\tif (BX.getClass('BX.Crm.Restriction.Bitrix24') && BX.Crm.Restriction.Bitrix24.isRestricted('visit'))\n\t\t{\n\t\t\treturn BX.Crm.Restriction.Bitrix24.getHandler('visit').call();\n\t\t}\n\t\tsuper.view();\n\t}\n\n\tedit()\n\t{\n\t\tif (BX.getClass('BX.Crm.Restriction.Bitrix24') && BX.Crm.Restriction.Bitrix24.isRestricted('visit'))\n\t\t{\n\t\t\treturn BX.Crm.Restriction.Bitrix24.getHandler('visit').call();\n\t\t}\n\t\tsuper.edit();\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Visit();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import HistoryActivity from \"./history-activity\";\n\n/** @memberof BX.Crm.Timeline.Actions */\nexport default class Zoom extends HistoryActivity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis._videoDummy = null;\n\t\tthis._audioDummy = null;\n\t\tthis._videoPlayer = null;\n\t\tthis._audioPlayer = null;\n\t\tthis._audioLengthElement = null;\n\t\tthis._recordings = [];\n\t\tthis._currentRecordingIndex = 0;\n\t\tthis.zoomActivitySubject = null;\n\n\t\tthis._downloadWrapper = null;\n\t\tthis._downloadSubject = null;\n\t\tthis._downloadSubjectDetail = null;\n\t\tthis._downloadVideoLink = null;\n\t\tthis._downloadSeparator = null;\n\t\tthis._downloadAudioLink = null;\n\t\tthis._playVideoLink = null;\n\t\tthis.detailZoomCopyVideoLink = null;\n\t}\n\n\tprepareHeaderLayout()\n\t{\n\t\tconst header = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-header\"}});\n\t\theader.appendChild(this.prepareTitleLayout());\n\t\tif (!this._data.hasOwnProperty('PROVIDER_DATA') || this._data[\"PROVIDER_DATA\"][\"ZOOM_EVENT_TYPE\"] !== 'ZOOM_CONF_JOINED')\n\t\t{\n\t\t\theader.appendChild(this.prepareSuccessfulLayout());\n\t\t}\n\t\theader.appendChild(this.prepareTimeLayout());\n\n\t\treturn header;\n\t}\n\n\tprepareSuccessfulLayout()\n\t{\n\t\treturn BX.create(\"SPAN\", {\n\t\t\tattrs:{ className: \"crm-entity-stream-content-event-successful\"},\n\t\t\ttext: BX.message('CRM_TIMELINE_ZOOM_SUCCESSFUL_ACTIVITY')\n\t\t});\n\t}\n\n\tprepareTitleLayout()\n\t{\n\t\tif (this._data.hasOwnProperty('PROVIDER_DATA') && this._data[\"PROVIDER_DATA\"][\"ZOOM_EVENT_TYPE\"] === 'ZOOM_CONF_JOINED')\n\t\t{\n\t\t\treturn BX.create(\"SPAN\", {\n\t\t\t\tattrs:{ className: \"crm-entity-stream-content-event-title\"},\n\t\t\t\ttext: BX.message('CRM_TIMELINE_ZOOM_JOINED_CONFERENCE')\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn BX.create(\"SPAN\", {\n\t\t\t\tattrs:{ className: \"crm-entity-stream-content-event-title\"},\n\t\t\t\ttext: BX.message('CRM_TIMELINE_ZOOM_CONFERENCE_END')\n\t\t\t});\n\t\t}\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-section crm-entity-stream-section-history\"}});\n\t\tlet entityDetailWrapper;\n\t\tconst zoomData = BX.prop.getObject(this.getAssociatedEntityData(), \"ZOOM_INFO\", null);\n\t\tconst subject = BX.prop.getString(this.getAssociatedEntityData(), \"SUBJECT\", null);\n\n\t\tthis._recordings = BX.prop.getArray(zoomData, \"RECORDINGS\", []);\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-zoom\" } })\n\t\t);\n\n\t\tif (this.isFixed())\n\t\t\tBX.addClass(wrapper, 'crm-entity-stream-section-top-fixed');\n\n\t\tconst contentWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\tchildren: [contentWrapper]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst header = this.prepareHeaderLayout();\n\t\tcontentWrapper.appendChild(header);\n\n\t\tconst detailWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-detail\"}});\n\t\tcontentWrapper.appendChild(detailWrapper);\n\n\t\tif (this._data.hasOwnProperty('PROVIDER_DATA') && this._data[\"PROVIDER_DATA\"][\"ZOOM_EVENT_TYPE\"] === 'ZOOM_CONF_JOINED')\n\t\t{\n\t\t\tentityDetailWrapper = BX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-description\" },\n\t\t\t\t\ttext: zoomData['CONF_URL']\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tentityDetailWrapper = BX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-description\" },\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tif (this._recordings.length > 0)\n\t\t\t{\n\t\t\t\tif (this._recordings.length > 1)\n\t\t\t\t{\n\t\t\t\t\t//render video parts header\n\n\t\t\t\t\tconst tabs = this._recordings.map(function (recording, index) {\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tid: index,\n\t\t\t\t\t\t\ttitle: BX.message(\"CRM_TIMELINE_ZOOM_MEETING_RECORD_PART\").replace(\"#NUMBER#\", index + 1),\n\t\t\t\t\t\t\ttime: recording[\"AUDIO\"] ? recording[\"AUDIO\"][\"LENGTH_FORMATTED\"] : \"\",\n\t\t\t\t\t\t\tactive: index === 0\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tconst tabsComponent = new Zoom.TabsComponent({\n\t\t\t\t\t\ttabs: tabs,\n\t\t\t\t\t});\n\t\t\t\t\ttabsComponent.eventEmitter.subscribe(\"onTabChange\", this._onTabChange.bind(this));\n\t\t\t\t\tdetailWrapper.appendChild(tabsComponent.render());\n\t\t\t\t}\n\n\t\t\t\tthis._videoDummy = BX.create(\"DIV\",\n\t\t\t\t\t{\n\t\t\t\t\t\tprops: { className: \"crm-entity-stream-content-detail-zoom-video-wrap\"},\n\t\t\t\t\t\tchildren: [\n\t\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tprops: { className: \"crm-entity-stream-content-detail-zoom-video\" },\n\t\t\t\t\t\t\t\t\tevents:\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\tclick: this._onVideoDummyClick.bind(this)\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tchildren: [\n\t\t\t\t\t\t\t\t\t\tBX.create(\"DIV\", {\n\t\t\t\t\t\t\t\t\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-video-inner\"},\n\t\t\t\t\t\t\t\t\t\t\tchildren: [\n\t\t\t\t\t\t\t\t\t\t\t\tBX.create(\"DIV\", {\n\t\t\t\t\t\t\t\t\t\t\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-video-btn\"},\n\t\t\t\t\t\t\t\t\t\t\t\t\tdataset: {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\thint: BX.message(\"CRM_TIMELINE_ZOOM_LOGIN_REQUIRED\"),\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t'hintNoIcon': 'Y'\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\t\t\t\t\tBX.create(\"SPAN\", {\n\t\t\t\t\t\t\t\t\t\t\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-video-text\"},\n\t\t\t\t\t\t\t\t\t\t\t\t\ttext: BX.message(\"CRM_TIMELINE_ZOOM_CLICK_TO_WATCH\")\n\t\t\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t]\n\t\t\t\t\t});\n\n\t\t\t\tBX.UI.Hint.init(this._videoDummy);\n\n\t\t\t\tthis._audioDummy = this._history.getManager().renderAudioDummy(\"00:15\", this._onAudioDummyClick.bind(this));\n\t\t\t\tthis._audioLengthElement = this._audioDummy.querySelector('.crm-audio-cap-time');\n\n\t\t\t\tif (zoomData['RECORDINGS'][0]['VIDEO'])\n\t\t\t\t{\n\t\t\t\t\t//video download link with token valid for 24h\n\t\t\t\t\tconst videoLinkExpireTS = (zoomData['RECORDINGS'][0]['VIDEO']['END_DATE_TS'] * 1000) + (60 * 60 * 23 * 1000);\n\t\t\t\t\tif (videoLinkExpireTS < Date.now())\n\t\t\t\t\t{\n\t\t\t\t\t\tconst videoLinkContainer = BX.create(\"DIV\", {\n\t\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\t\tclassName: \"crm-entity-stream-content-detail-zoom-desc\",\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tthis._playVideoLink = BX.create(\"DIV\", {\n\t\t\t\t\t\t\thtml: BX.message(\"CRM_TIMELINE_ZOOM_PLAY_LINK_VIDEO\"),\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tthis._detailZoomCopyVideoLink = BX.create(\"A\",\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\t\t\tclassName: 'ui-link ui-link-dashed',\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\ttext: BX.message(\"CRM_TIMELINE_ZOOM_COPY_PASSWORD\")\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\tvideoLinkContainer.appendChild(this._playVideoLink);\n\t\t\t\t\t\tvideoLinkContainer.appendChild(this._detailZoomCopyVideoLink);\n\t\t\t\t\t\tentityDetailWrapper.appendChild(videoLinkContainer);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tentityDetailWrapper.appendChild(this._videoDummy);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (zoomData['RECORDINGS'][0]['AUDIO'])\n\t\t\t\t{\n\t\t\t\t\tconst zoomAudioDetailWrapper = BX.create(\"DIV\",\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail-call crm-entity-stream-content-detail-call-inline\"},\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\n\t\t\t\t\tzoomAudioDetailWrapper.appendChild(this._audioDummy);\n\t\t\t\t\tzoomAudioDetailWrapper.appendChild(this._history.getManager().getAudioPlaybackRateSelector().render());\n\t\t\t\t\tentityDetailWrapper.appendChild(zoomAudioDetailWrapper);\n\t\t\t\t}\n\n\t\t\t\tthis._downloadWrapper = BX.create(\"DIV\", {\n\t\t\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-desc\"},\n\t\t\t\t});\n\n\t\t\t\tentityDetailWrapper.appendChild(this._downloadWrapper);\n\n\t\t\t\tthis._downloadSubject = BX.create(\"SPAN\", {\n\t\t\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-desc-subject\"},\n\t\t\t\t});\n\t\t\t\tthis._downloadSubjectDetail = BX.create(\"SPAN\", {\n\t\t\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-desc-detail\"},\n\t\t\t\t});\n\t\t\t\tthis._downloadVideoLink = BX.create(\"A\", {\n\t\t\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-desc-link\"},\n\t\t\t\t\ttext: BX.message(\"CRM_TIMELINE_ZOOM_DOWNLOAD_VIDEO\")\n\t\t\t\t});\n\t\t\t\tthis._downloadSeparator = BX.create(\"SPAN\", {\n\t\t\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-desc-separate\"},\n\t\t\t\t\thtml: \"&mdash;\"\n\t\t\t\t});\n\t\t\t\tthis._downloadAudioLink = BX.create(\"A\", {\n\t\t\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-desc-link\"},\n\t\t\t\t\ttext: BX.message(\"CRM_TIMELINE_ZOOM_DOWNLOAD_AUDIO\")\n\t\t\t\t});\n\t\t\t\tthis.setCurrentRecording(0);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.zoomActivitySubject = BX.create(\"DIV\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-title\" },\n\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tattrs: { href: \"#\" },\n\t\t\t\t\t\t\t\t\t\tevents: { \"click\": this._headerClickHandler },\n\t\t\t\t\t\t\t\t\t\ttext: subject\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t);\n\n\t\t\t\tentityDetailWrapper.appendChild(this.zoomActivitySubject);\n\n\t\t\t\tif (zoomData['HAS_RECORDING'] === 'Y')\n\t\t\t\t{\n\t\t\t\t\tentityDetailWrapper.appendChild(BX.create(\"DIV\", {\n\t\t\t\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-video\"},\n\t\t\t\t\t\tchildren: [\n\t\t\t\t\t\t\tBX.create(\"DIV\", {\n\t\t\t\t\t\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-video-inner\"},\n\t\t\t\t\t\t\t\tchildren: [\n\t\t\t\t\t\t\t\t\tBX.create(\"DIV\", {\n\t\t\t\t\t\t\t\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-video-img\"},\n\t\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\t\tBX.create(\"SPAN\", {\n\t\t\t\t\t\t\t\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-video-text\"},\n\t\t\t\t\t\t\t\t\t\ttext: BX.message(\"CRM_TIMELINE_ZOOM_MEETING_RECORD_IN_PROCESS\")\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t]\n\t\t\t\t\t}));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t/*else\n\t\t{\n\t\t\tdetailWrapper.appendChild(BX.create(\"span\", {text: \"456\"}));\n\n\t\t\tvar entityDetailWrapper = BX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-description\" },\n\t\t\t\t\ttext: BX.prop.getString(zoomData, \"CONF_URL\", \"\")\n\t\t\t\t}\n\t\t\t);\n\t\t}*/\n\t\t//Content //todo\n\n\n\t\tif(entityDetailWrapper)\n\t\t{\n\t\t\tdetailWrapper.appendChild(entityDetailWrapper);\n\t\t}\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontentWrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\treturn wrapper;\n\t}\n\n\t_onVideoDummyClick()\n\t{\n\t\tBX.UI.Hint.hide();\n\t\tconst recording = this._recordings[this._currentRecordingIndex][\"VIDEO\"];\n\t\tif(!recording)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tthis._videoPlayer = this._history.getManager().loadMediaPlayer(\n\t\t\t\"zoom_video_\" + this.getId(),\n\t\t\trecording[\"DOWNLOAD_URL\"],\n\t\t\t\"video/mp4\",\n\t\t\tthis._videoDummy,\n\t\t\trecording[\"LENGTH\"],\n\t\t\t{\n\t\t\t\tvideo: true,\n\t\t\t\tskin: \"\",\n\t\t\t\twidth: 480,\n\t\t\t\theight: 270\n\t\t\t}\n\t\t);\n\t}\n\n\t_onAudioDummyClick()\n\t{\n\t\tconst recording = this._recordings[this._currentRecordingIndex][\"AUDIO\"];\n\t\tif(!recording)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tthis._history.getManager().getAudioPlaybackRateSelector().addPlayer(this._audioPlayer = this._history.getManager().loadMediaPlayer(\n\t\t\t\"zoom_audio_\" + this.getId(),\n\t\t\trecording[\"DOWNLOAD_URL\"],\n\t\t\t\"audio/mp4\",\n\t\t\tthis._audioDummy,\n\t\t\trecording[\"LENGTH\"],\n\t\t\t{\n\t\t\t\tplaybackRate: this._history.getManager().getAudioPlaybackRateSelector().getRate()\n\t\t\t}\n\t\t));\n\t}\n\n\t_onTabChange(event)\n\t{\n\t\tthis.setCurrentRecording(event.data.tabId);\n\t}\n\n\tsetCurrentRecording(recordingIndex)\n\t{\n\t\tthis._currentRecordingIndex = recordingIndex;\n\t\tconst videoRecording = this._recordings[this._currentRecordingIndex][\"VIDEO\"];\n\t\tconst audioRecording = this._recordings[this._currentRecordingIndex][\"AUDIO\"];\n\n\t\tif(videoRecording)\n\t\t{\n\t\t\tthis._videoDummy.hidden = false;\n\t\t\tif(this._videoPlayer)\n\t\t\t{\n\t\t\t\tthis._videoPlayer.pause();\n\t\t\t\tthis._videoPlayer.setSource(videoRecording[\"DOWNLOAD_URL\"]);\n\t\t\t\tthis._downloadVideoLink.href = videoRecording[\"DOWNLOAD_URL\"];\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis._videoDummy.hidden = true;\n\t\t}\n\n\t\tif(audioRecording)\n\t\t{\n\t\t\tthis._audioDummy.hidden = false;\n\t\t\tif(this._audioPlayer)\n\t\t\t{\n\t\t\t\tthis._audioPlayer.pause();\n\t\t\t\tthis._audioPlayer.setSource(audioRecording[\"DOWNLOAD_URL\"]);\n\t\t\t}\n\t\t\tthis._downloadAudioLink.href = audioRecording[\"DOWNLOAD_URL\"];\n\t\t\tthis._audioLengthElement.innerText = audioRecording[\"LENGTH_FORMATTED\"];\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis._audioDummy.hidden = true;\n\t\t}\n\n\t\tBX.clean(this._downloadWrapper);\n\t\tif(audioRecording || videoRecording)\n\t\t{\n\t\t\tconst lengthHuman = audioRecording ? audioRecording[\"LENGTH_HUMAN\"] : videoRecording[\"LENGTH_HUMAN\"];\n\t\t\tthis._downloadWrapper.appendChild(this._downloadSubject);\n\t\t\tthis._downloadSubject.innerHTML = BX.util.htmlspecialchars(BX.message(\"CRM_TIMELINE_ZOOM_MEETING_RECORD\").replace(\"#DURATION#\", lengthHuman)) + \" &mdash; \"\n\t\t\tthis._downloadWrapper.appendChild(this._downloadSubjectDetail);\n\t\t}\n\t\tif (videoRecording)\n\t\t{\n\t\t\tthis._downloadSubjectDetail.appendChild(this._downloadVideoLink);\n\t\t\tthis._downloadVideoLink.href = videoRecording['DOWNLOAD_URL'];\n\t\t\tif (audioRecording)\n\t\t\t{\n\t\t\t\tthis._downloadSubjectDetail.appendChild(this._downloadSeparator);\n\t\t\t}\n\n\t\t\tif (this._playVideoLink)\n\t\t\t{\n\t\t\t\tthis._playVideoLink.lastElementChild.href = videoRecording[\"PLAY_URL\"];\n\t\t\t\tthis._downloadVideoLink.href = videoRecording[\"PLAY_URL\"];\n\t\t\t}\n\t\t\tif (this._detailZoomCopyVideoLink)\n\t\t\t{\n\t\t\t\tBX.clipboard.bindCopyClick(this._detailZoomCopyVideoLink, {\n\t\t\t\t\ttext: videoRecording['PASSWORD'],\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\tif (audioRecording)\n\t\t{\n\t\t\tthis._downloadSubjectDetail.appendChild(this._downloadAudioLink);\n\t\t\tthis._downloadAudioLink.href = audioRecording['DOWNLOAD_URL'];\n\t\t}\n\t}\n\n\tprepareActions()\n\t{\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Zoom();\n\t\tself.initialize(id, settings);\n\n\t\t//todo: remove debug\n\t\tif(!window['zoom'])\n\t\t{\n\t\t\twindow['zoom'] = [];\n\t\t}\n\t\twindow['zoom'].push(self);\n\t\treturn self;\n\t}\n}\n\nZoom.TabsComponent = class\n{\n\tconstructor(config)\n\t{\n\t\tthis.tabs = BX.prop.getArray(config, \"tabs\", []);\n\t\tthis.elements = {\n\t\t\tcontainer: null,\n\t\t\ttabs: {}\n\t\t};\n\t\tthis.eventEmitter = new BX.Event.EventEmitter(this, 'Zoom.TabsComponent');\n\t}\n\n\trender()\n\t{\n\t\tif(this.elements.container)\n\t\t{\n\t\t\treturn this.elements.container;\n\t\t}\n\n\t\tthis.elements.container = BX.create(\"DIV\", {\n\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-section-wrapper\"},\n\t\t\tchildren: [\n\t\t\t\tBX.create(\"DIV\", {\n\t\t\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-section-list\"},\n\t\t\t\t\tchildren: this.tabs.map(this._renderTab, this)\n\t\t\t\t})\n\t\t\t]\n\t\t});\n\t\treturn this.elements.container;\n\t}\n\n\t_renderTab(tabDescription)\n\t{\n\t\tconst tabId = tabDescription.id;\n\t\tthis.elements.tabs[tabId] = BX.create(\"DIV\", {\n\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-section\" + (tabDescription.active ? \" crm-entity-stream-content-detail-zoom-section-active\": \"\")},\n\t\t\tchildren: [\n\t\t\t\tBX.create(\"DIV\", {\n\t\t\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-section-inner\"},\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tBX.create(\"DIV\", {\n\t\t\t\t\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-section-title\"},\n\t\t\t\t\t\t\ttext: tabDescription.title\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tBX.create(\"DIV\", {\n\t\t\t\t\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-section-time\"},\n\t\t\t\t\t\t\ttext: tabDescription.time\n\t\t\t\t\t\t})\n\t\t\t\t\t]\n\t\t\t\t})\n\t\t\t],\n\t\t\tevents: {\n\t\t\t\tclick: function()\n\t\t\t\t{\n\t\t\t\t\tthis.setActiveTab(tabDescription.id)\n\t\t\t\t}.bind(this)\n\t\t\t}\n\t\t});\n\t\treturn this.elements.tabs[tabId];\n\t}\n\n\tsetActiveTab(tabId)\n\t{\n\t\tif(!this.elements.tabs[tabId])\n\t\t{\n\t\t\tthrow new Error (\"Tab \" + tabId + \" is not found\");\n\t\t}\n\t\tfor (let id in this.elements.tabs)\n\t\t{\n\t\t\tif(!this.elements.tabs.hasOwnProperty(id))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tid = Number.parseInt(id, 10);\n\t\t\tif (id === tabId)\n\t\t\t{\n\t\t\t\tthis.elements.tabs[id].classList.add(\"crm-entity-stream-content-detail-zoom-section-active\");\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.elements.tabs[id].classList.remove(\"crm-entity-stream-content-detail-zoom-section-active\");\n\t\t\t}\n\t\t}\n\t\tthis.eventEmitter.emit(\"onTabChange\", {\n\t\t\ttabId: tabId\n\t\t});\n\t}\n};\n","import History from \"./history\";\n\n/** @memberof BX.Crm.Timeline.Actions */\nexport default class OrderCreation extends History\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tdoInitialize()\n\t{\n\t\tsuper.doInitialize();\n\t\tif(!(this._activityEditor instanceof BX.CrmActivityEditor))\n\t\t{\n\t\t\tthrow \"OrderCreation. The field 'activityEditor' is not assigned.\";\n\t\t}\n\t}\n\n\tgetTitle()\n\t{\n\t\tlet msg = this.getMessage(BX.CrmEntityType.resolveName(this.getAssociatedEntityTypeId()).toLowerCase());\n\t\tif(!BX.type.isNotEmptyString(msg))\n\t\t{\n\t\t\tmsg = this.getTextDataParam(\"TITLE\");\n\t\t}\n\n\t\treturn msg;\n\t}\n\n\tgetWrapperClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-createOrderEntity\";\n\t}\n\n\tgetHeaderChildren()\n\t{\n\t\tlet statusMessage = '';\n\t\tlet statusClass = '';\n\t\tconst fields = this.getObjectDataParam('FIELDS');\n\n\t\tif (BX.prop.get(fields, 'DONE') === 'Y')\n\t\t{\n\t\t\tstatusMessage = this.getMessage(\"done\");\n\t\t\tstatusClass = \"crm-entity-stream-content-event-done\";\n\t\t}\n\t\telse if (BX.prop.get(fields, 'CANCELED') === 'Y')\n\t\t{\n\t\t\tstatusMessage = this.getMessage(\"canceled\");\n\t\t\tstatusClass = \"crm-entity-stream-content-event-canceled\";\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (BX.prop.get(fields, 'PAID') === 'Y')\n\t\t\t{\n\t\t\t\tstatusMessage = this.getMessage(\"paid\");\n\t\t\t\tstatusClass = \"crm-entity-stream-content-event-paid\";\n\t\t\t}\n\t\t\telse if (BX.prop.get(fields, 'PAID') === 'N')\n\t\t\t{\n\t\t\t\tstatusMessage = this.getMessage(\"unpaid\");\n\t\t\t\tstatusClass = \"crm-entity-stream-content-event-not-paid\";\n\t\t\t}\n\t\t}\n\n\t\treturn [\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-event-title\" },\n\t\t\t\t\tevents: { click: this._headerClickHandler },\n\t\t\t\t\ttext: this.getTitle(),\n\t\t\t\t}\n\t\t\t),\n\t\t\tBX.create(\"SPAN\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: statusClass },\n\t\t\t\t\ttext: statusMessage\n\t\t\t\t}\n\t\t\t),\n\t\t\tBX.create(\"SPAN\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-event-time\" },\n\t\t\t\t\ttext: this.formatTime(this.getCreatedTime())\n\t\t\t\t}\n\t\t\t)\n\t\t];\n\t}\n\n\tprepareContentDetails()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst entityTypeId = this.getAssociatedEntityTypeId();\n\t\tconst entityId = this.getAssociatedEntityId();\n\t\tlet title = BX.util.htmlspecialchars(BX.prop.getString(entityData, \"TITLE\", \"\"));\n\t\tconst showUrl = BX.prop.getString(entityData, \"SHOW_URL\", \"\");\n\t\tconst legend = BX.prop.getString(entityData, \"LEGEND\", \"\");\n\t\tif(legend !== \"\")\n\t\t{\n\t\t\ttitle += \" \" + legend;\n\t\t}\n\t\tconst nodes = [];\n\n\t\tif(title !== \"\")\n\t\t{\n\t\t\tif(showUrl === \"\" || (entityTypeId === this.getOwnerTypeId() && entityId === this.getOwnerId()))\n\t\t\t{\n\t\t\t\tnodes.push(BX.create(\"DIV\", {\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-description\" },\n\t\t\t\t\thtml: title\n\t\t\t\t}));\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tnodes.push(BX.create(\"DIV\", {\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-description\" },\n\t\t\t\t\thtml: title\n\t\t\t\t}));\n\t\t\t\tnodes.push(BX.create(\"A\", { attrs: { href: showUrl }, text: this.getMessage('urlOrderLink') }));\n\t\t\t}\n\t\t}\n\t\treturn nodes;\n\t}\n\n\tgetIconClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-icon crm-entity-stream-section-icon-store\";\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst wrapperClassName = \"crm-entity-stream-section crm-entity-stream-section-history\";\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: wrapperClassName}});\n\t\twrapper.appendChild(BX.create(\"DIV\", { attrs: { className: this.getIconClassName() } }));\n\n\t\tconst contentWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{ attrs: { className: \"crm-entity-stream-section-content\" }, children: [ contentWrapper ] }\n\t\t\t)\n\t\t);\n\n\t\tconst header = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-header\"},\n\t\t\t\tchildren: this.getHeaderChildren()\n\t\t\t}\n\t\t);\n\t\tcontentWrapper.appendChild(header);\n\n\t\tcontentWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail\" },\n\t\t\t\t\tchildren: this.prepareContentDetails()\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontentWrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\treturn wrapper;\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = OrderCreation.messages;\n\t\treturn m.hasOwnProperty(name) ? m[name] : name;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new OrderCreation();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n\n\tstatic messages = {};\n}\n","import History from \"./history\";\n\n/** @memberof BX.Crm.Timeline.Actions */\nexport default class OrderModification extends History\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = OrderModification.messages;\n\t\treturn m.hasOwnProperty(name) ? m[name] : name;\n\t}\n\n\tgetTitle()\n\t{\n\t\treturn this.getTextDataParam(\"TITLE\");\n\t}\n\n\tgetStatusInfo()\n\t{\n\t\tconst statusInfo = {};\n\t\tlet value = null;\n\t\tlet classCode = null;\n\t\tconst fieldName = this.getTextDataParam(\"CHANGED_ENTITY\");\n\t\tconst fields = this.getObjectDataParam('FIELDS');\n\t\tconst entityData = this.getAssociatedEntityData();\n\n\t\tif (fieldName === BX.CrmEntityType.names.order)\n\t\t{\n\t\t\tif (BX.prop.get(fields, 'ORDER_CANCELED') === 'Y')\n\t\t\t{\n\t\t\t\tvalue = \"canceled\";\n\t\t\t\tclassCode  = \"not-paid\";\n\t\t\t}\n\t\t\telse if (BX.prop.get(fields, 'ORDER_DONE') === 'Y')\n\t\t\t{\n\t\t\t\tvalue = \"done\";\n\t\t\t\tclassCode  = \"done\";\n\t\t\t}\n\t\t\telse if (BX.prop.getString(entityData, \"VIEWED\", '') === 'Y')\n\t\t\t{\n\t\t\t\tvalue = \"viewed\";\n\t\t\t\tclassCode  = \"done\";\n\t\t\t}\n\t\t\telse if (BX.prop.getString(entityData, \"SENT\", '') === 'Y')\n\t\t\t{\n\t\t\t\tvalue = \"sent\";\n\t\t\t\tclassCode  = \"sent\";\n\t\t\t}\n\t\t}\n\t\tif (fieldName === BX.CrmEntityType.names.orderpayment)\n\t\t{\n\t\t\tconst psStatusCode = BX.prop.get(fields, 'STATUS_CODE', false);\n\t\t\tif (psStatusCode)\n\t\t\t{\n\t\t\t\tif (psStatusCode === 'ERROR')\n\t\t\t\t{\n\t\t\t\t\tvalue = \"orderPaymentError\";\n\t\t\t\t\tclassCode = \"payment-error\";\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (BX.prop.getString(entityData, \"VIEWED\", '') === 'Y')\n\t\t\t{\n\t\t\t\tvalue = \"viewed\";\n\t\t\t\tclassCode  = \"done\";\n\t\t\t}\n\t\t\telse if (BX.prop.getString(entityData, \"SENT\", '') === 'Y')\n\t\t\t{\n\t\t\t\tvalue = \"sent\";\n\t\t\t\tclassCode  = \"sent\";\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tvalue = BX.prop.get(fields, 'ORDER_PAID') === 'Y' ? \"paid\" : \"unpaid\";\n\t\t\t\tclassCode  = BX.prop.get(fields, 'ORDER_PAID') === 'Y' ? \"paid\" : \"not-paid\";\n\t\t\t}\n\t\t}\n\t\telse if (fieldName === BX.CrmEntityType.names.ordershipment && BX.prop.get(fields, 'ORDER_DEDUCTED', false))\n\t\t{\n\t\t\tvalue = BX.prop.get(fields, 'ORDER_DEDUCTED') === 'Y' ? \"deducted\" : \"unshipped\";\n\t\t\tclassCode  = BX.prop.get(fields, 'ORDER_DEDUCTED') === 'Y' ? \"shipped\" : \"not-shipped\";\n\t\t}\n\t\telse if (fieldName === BX.CrmEntityType.names.ordershipment && BX.prop.get(fields, 'ORDER_ALLOW_DELIVERY', false))\n\t\t{\n\t\t\tvalue = BX.prop.get(fields, 'ORDER_ALLOW_DELIVERY') === 'Y' ? \"allowedDelivery\" : \"disallowedDelivery\";\n\t\t\tclassCode  = BX.prop.get(fields, 'ORDER_ALLOW_DELIVERY') === 'Y' ? \"allowed-delivery\" : \"disallowed-delivery\";\n\t\t}\n\n\t\tif (value)\n\t\t{\n\t\t\tstatusInfo.className = \"crm-entity-stream-content-event-\" + classCode;\n\t\t\tstatusInfo.message = this.getMessage(value);\n\t\t}\n\n\t\treturn statusInfo;\n\t}\n\n\tgetHeaderChildren()\n\t{\n\t\tconst children = [\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-event-title\"},\n\t\t\t\t\tevents: {click: this._headerClickHandler},\n\t\t\t\t\ttext: this.getTitle(),\n\t\t\t\t}\n\t\t\t)\n\t\t];\n\t\tconst statusInfo = this.getStatusInfo();\n\t\tif (BX.type.isNotEmptyObject(statusInfo))\n\t\t{\n\t\t\tchildren.push(\n\t\t\t\tBX.create(\"SPAN\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: statusInfo.className },\n\t\t\t\t\t\ttext: statusInfo.message\n\t\t\t\t\t}\n\t\t\t\t));\n\t\t}\n\t\tchildren.push(\n\t\t\tBX.create(\"SPAN\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-event-time\" },\n\t\t\t\t\ttext: this.formatTime(this.getCreatedTime())\n\t\t\t\t}\n\t\t\t));\n\t\treturn children;\n\t}\n\n\tprepareContentDetails()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst entityTypeId = this.getAssociatedEntityTypeId();\n\t\tconst entityId = this.getAssociatedEntityId();\n\t\tconst title = BX.prop.getString(entityData, \"TITLE\");\n\t\tconst htmlTitle = BX.prop.getString(entityData, \"HTML_TITLE\", \"\");\n\t\tconst showUrl = BX.prop.getString(entityData, \"SHOW_URL\", \"\");\n\t\tconst nodes = [];\n\t\tif(title !== \"\")\n\t\t{\n\t\t\tconst descriptionNode = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-detail-description\"}});\n\n\t\t\tif(showUrl === \"\" || (entityTypeId === this.getOwnerTypeId() && entityId === this.getOwnerId()))\n\t\t\t{\n\t\t\t\tdescriptionNode.appendChild(BX.create(\"SPAN\", { text: title + \" \" + htmlTitle}));\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (htmlTitle === \"\")\n\t\t\t\t{\n\t\t\t\t\tdescriptionNode.appendChild(BX.create(\"A\", {attrs: {href: showUrl}, text: title}));\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tdescriptionNode.appendChild(BX.create(\"SPAN\", { text: title + \" \"}));\n\t\t\t\t\tdescriptionNode.appendChild(BX.create(\"A\", {attrs: {href: showUrl}, text: htmlTitle}));\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst legend = BX.prop.getString(entityData, \"LEGEND\");\n\t\t\tif(legend !== \"\")\n\t\t\t{\n\t\t\t\tdescriptionNode.appendChild(BX.create(\"SPAN\", { html: \" \" + legend }));\n\t\t\t}\n\n\t\t\tconst sublegend = BX.prop.getString(entityData, \"SUBLEGEND\", '');\n\t\t\tif (sublegend !== '')\n\t\t\t{\n\t\t\t\tdescriptionNode.appendChild(BX.create(\"BR\"));\n\t\t\t\tdescriptionNode.appendChild(BX.create(\"SPAN\", { text: \" \" + sublegend}));\n\t\t\t}\n\t\t\tnodes.push(descriptionNode);\n\t\t}\n\n\t\treturn nodes;\n\t}\n\n\tprepareViewedContentDetails()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst entityTypeId = this.getAssociatedEntityTypeId();\n\t\tconst entityId = this.getAssociatedEntityId();\n\t\tconst title = BX.prop.getString(entityData, \"TITLE\");\n\t\tconst showUrl = BX.prop.getString(entityData, \"SHOW_URL\", \"\");\n\t\tconst nodes = [];\n\n\t\tif (title !== \"\")\n\t\t{\n\t\t\tconst sublegend = BX.prop.getString(entityData, \"SUBLEGEND\", '');\n\t\t\tif (sublegend !== \"\")\n\t\t\t{\n\t\t\t\tconst descriptionNode = BX.create(\"DIV\", {\n\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail-description\"},\n\t\t\t\t\ttext: sublegend,\n\t\t\t\t});\n\t\t\t\tnodes.push(descriptionNode);\n\t\t\t}\n\n\n\t\t\tif(entityTypeId === this.getOwnerTypeId() && entityId === this.getOwnerId())\n\t\t\t{\n\t\t\t\tnodes.push(BX.create(\"SPAN\", { text: title }));\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tnodes.push(BX.create(\"A\", { attrs: { href: showUrl }, text: title }));\n\t\t\t}\n\n\t\t\tconst legend = BX.prop.getString(entityData, \"LEGEND\");\n\t\t\tif(legend !== \"\")\n\t\t\t{\n\t\t\t\tnodes.push(BX.create(\"SPAN\", { html: \" \" + legend }));\n\t\t\t}\n\t\t}\n\n\t\treturn nodes;\n\t}\n\n\tprepareSentContentDetails()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst entityTypeId = this.getAssociatedEntityTypeId();\n\t\tconst entityId = this.getAssociatedEntityId();\n\t\tconst title = BX.prop.getString(entityData, \"TITLE\");\n\t\tconst showUrl = BX.prop.getString(entityData, 'SHOW_URL', '');\n\t\tconst destination = BX.prop.getString(entityData, 'DESTINATION_TITLE', '');\n\t\tconst nodes = [];\n\n\t\tif (title !== \"\")\n\t\t{\n\t\t\tconst detailNode = BX.create('DIV', {attrs: {className: 'crm-entity-stream-content-detail-description'}});\n\t\t\tif(showUrl === \"\" || (entityTypeId === this.getOwnerTypeId() && entityId === this.getOwnerId()))\n\t\t\t{\n\t\t\t\tdetailNode.appendChild(BX.create(\"SPAN\", { text: title }));\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tdetailNode.appendChild(BX.create('A', { attrs: { href: showUrl }, text: title }));\n\t\t\t}\n\n\t\t\tconst legend = BX.prop.getString(entityData, \"LEGEND\");\n\t\t\tif(legend !== \"\")\n\t\t\t{\n\t\t\t\tdetailNode.appendChild(BX.create(\"SPAN\", { html: \" \" + legend }));\n\t\t\t}\n\n\t\t\tif (destination)\n\t\t\t{\n\t\t\t\tdetailNode.appendChild(BX.create('SPAN', {\n\t\t\t\t\tattrs: { className: 'crm-entity-stream-content-detail-order-destination' },\n\t\t\t\t\ttext: destination,\n\t\t\t\t}));\n\t\t\t}\n\n\t\t\tnodes.push(detailNode);\n\n\t\t\tconst sliderLinkNode = BX.create('A', {\n\t\t\t\tattrs: {href: \"#\"},\n\t\t\t\ttext: this.getMessage('orderPaymentProcess'),\n\t\t\t\tevents: {\n\t\t\t\t\tclick: BX.proxy(this.startSalescenterApplication, this),\n\t\t\t\t},\n\t\t\t});\n\t\t\tnodes.push(sliderLinkNode);\n\t\t}\n\n\t\treturn nodes;\n\t}\n\n\tstartSalescenterApplication()\n\t{\n\t\tBX.loadExt('salescenter.manager').then(function()\n\t\t{\n\t\t\tconst fields = this.getObjectDataParam('FIELDS'),\n\t\t\t\townerTypeId = BX.prop.get(fields, 'OWNER_TYPE_ID', BX.CrmEntityType.enumeration.deal);\n\t\t\tlet ownerId = BX.prop.get(fields, 'OWNER_ID', 0);\n\t\t\tconst paymentId = BX.prop.get(fields, 'PAYMENT_ID', 0),\n\t\t\t\tshipmentId = BX.prop.get(fields, 'SHIPMENT_ID', 0),\n\t\t\t\torderId = BX.prop.get(fields, 'ORDER_ID', 0)\n\t\t\t;\n\n\t\t\t// compatibility\n\t\t\tif (!ownerId)\n\t\t\t{\n\t\t\t\townerId = BX.prop.get(fields, 'DEAL_ID', 0);\n\t\t\t}\n\n\t\t\tBX.Salescenter.Manager.openApplication({\n\t\t\t\tdisableSendButton: '',\n\t\t\t\tcontext: 'deal',\n\t\t\t\townerTypeId: ownerTypeId,\n\t\t\t\townerId: ownerId,\n\t\t\t\tmode: ownerTypeId === BX.CrmEntityType.enumeration.deal ? 'payment_delivery' : 'payment',\n\t\t\t\ttemplateMode: 'view',\n\t\t\t\torderId: orderId,\n\t\t\t\tpaymentId: paymentId,\n\t\t\t\tshipmentId: shipmentId,\n\t\t\t});\n\t\t}.bind(this));\n\t}\n\n\tpreparePaidPaymentContentDetails()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData(),\n\t\t\ttitle = BX.prop.getString(entityData, \"TITLE\"),\n\t\t\tdate = BX.prop.getString(entityData, \"DATE\", \"\"),\n\t\t\tpaySystemName = BX.prop.getString(entityData, \"PAY_SYSTEM_NAME\", \"\"),\n\t\t\tsum = BX.prop.getString(entityData, 'SUM', ''),\n\t\t\tcurrency = BX.prop.getString(entityData, 'CURRENCY', ''),\n\t\t\tnodes = [];\n\n\t\tif(title !== \"\")\n\t\t{\n\t\t\tconst paymentDetail = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-detail-payment\"}});\n\t\t\tpaymentDetail.appendChild(\n\t\t\t\tBX.create(\"DIV\", {\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-payment-value\"},\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tBX.create('SPAN', {\n\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-payment-text\"},\n\t\t\t\t\t\t\thtml: sum,\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tBX.create('SPAN', {\n\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-payment-currency\"},\n\t\t\t\t\t\t\thtml: currency,\n\t\t\t\t\t\t}),\n\t\t\t\t\t]\n\t\t\t\t})\n\t\t\t);\n\n\t\t\tconst logotip = BX.prop.getString(entityData, \"LOGOTIP\", null);\n\t\t\tif (logotip)\n\t\t\t{\n\t\t\t\tpaymentDetail.appendChild(\n\t\t\t\t\tBX.create(\"DIV\", {\n\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-payment-logo\"},\n\t\t\t\t\t\tstyle: {\n\t\t\t\t\t\t\tbackgroundImage: \"url(\" + encodeURI(logotip) + \")\",\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t);\n\t\t\t}\n\t\t\tnodes.push(paymentDetail);\n\n\t\t\tconst descriptionNode = BX.create(\"DIV\", {\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail-description\"},\n\t\t\t\tchildren: [\n\t\t\t\t\tBX.create('SPAN', {\n\t\t\t\t\t\ttext: date\n\t\t\t\t\t}),\n\t\t\t\t\tBX.create('SPAN', {\n\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail-description-info\"},\n\t\t\t\t\t\ttext: this.getMessage('orderPaySystemTitle')\n\t\t\t\t\t}),\n\t\t\t\t\tBX.create('SPAN', {\n\t\t\t\t\t\ttext: paySystemName\n\t\t\t\t\t}),\n\t\t\t\t]\n\t\t\t});\n\t\t\tnodes.push(descriptionNode);\n\t\t}\n\n\t\treturn nodes;\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst fields = this.getObjectDataParam('FIELDS'),\n\t\t\tisPaid = BX.prop.get(fields, 'ORDER_PAID') === 'Y',\n\t\t\tisClick = BX.prop.get(fields, 'PAY_SYSTEM_CLICK') === 'Y',\n\t\t\tisManualContinuePay = BX.prop.get(fields, 'MANUAL_CONTINUE_PAY') === 'Y',\n\t\t\tisManualAddCheck = BX.prop.get(fields, 'NEED_MANUAL_ADD_CHECK') === 'Y',\n\t\t\tentityId = this.getAssociatedEntityTypeId();\n\n\t\tif (entityId === BX.CrmEntityType.enumeration.orderpayment && isPaid)\n\t\t{\n\t\t\treturn this.preparePaidPaymentContent();\n\t\t}\n\t\telse if (entityId === BX.CrmEntityType.enumeration.orderpayment && isClick)\n\t\t{\n\t\t\treturn this.prepareClickedPaymentContent();\n\t\t}\n\t\telse if (entityId === BX.CrmEntityType.enumeration.order && isManualContinuePay)\n\t\t{\n\t\t\treturn this.prepareManualContinuePayContent();\n\t\t}\n\t\telse if (entityId === BX.CrmEntityType.enumeration.orderpayment && isManualAddCheck)\n\t\t{\n\t\t\treturn this.prepareManualAddCheck();\n\t\t}\n\n\t\treturn this.prepareItemOrderContent();\n\t}\n\n\tprepareItemOrderContent()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst isViewed = BX.prop.getString(entityData, \"VIEWED\", '') === 'Y';\n\t\tconst isSent = BX.prop.getString(entityData, \"SENT\", '') === 'Y';\n\t\tconst fields = this.getObjectDataParam('FIELDS');\n\t\tconst psStatusCode = BX.prop.get(fields, 'STATUS_CODE', false);\n\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: 'crm-entity-stream-section crm-entity-stream-section-history'}});\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: 'crm-entity-stream-section-icon ' + this.getIconClassName() } })\n\t\t);\n\n\t\tconst content = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\tconst header = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-header\"},\n\t\t\t\tchildren: this.getHeaderChildren()\n\t\t\t});\n\n\t\tlet contentChildren = null;\n\t\tif (isViewed)\n\t\t{\n\t\t\tcontentChildren = this.prepareViewedContentDetails();\n\t\t}\n\t\telse if (isSent)\n\t\t{\n\t\t\tcontentChildren = this.prepareSentContentDetails();\n\t\t}\n\t\telse if (psStatusCode === 'ERROR')\n\t\t{\n\t\t\tcontentChildren = this.prepareErrorPaymentContentDetails();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tcontentChildren = this.prepareContentDetails();\n\t\t}\n\n\t\tcontent.appendChild(header);\n\t\tcontent.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail\" },\n\t\t\t\t\tchildren: contentChildren\n\t\t\t\t})\n\t\t);\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontent.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-content\" }, children: [ content ] })\n\t\t);\n\n\t\treturn wrapper;\n\t}\n\n\tpreparePaidPaymentContent()\n\t{\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: 'crm-entity-stream-section'}});\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: 'crm-entity-stream-section-icon crm-entity-stream-section-icon-wallet' } })\n\t\t);\n\n\t\tconst header = [\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-event-title\"},\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattrs: {href: \"#\"},\n\t\t\t\t\t\t\t\t\tevents: {click: this._headerClickHandler},\n\t\t\t\t\t\t\t\t\ttext: this.getMessage('orderPaymentSuccessTitle')\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t];\n\t\theader.push(\n\t\t\tBX.create(\"SPAN\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-event-time\" },\n\t\t\t\t\ttext: this.formatTime(this.getCreatedTime())\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst content = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\tconst headerWrap = BX.create(\"DIV\", {\n\t\t\tattrs: {className: \"crm-entity-stream-content-header\"},\n\t\t\tchildren: header\n\t\t});\n\n\t\tconst contentChildren = this.preparePaidPaymentContentDetails();\n\t\tcontent.appendChild(headerWrap);\n\t\tcontent.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail\" },\n\t\t\t\t\tchildren: contentChildren\n\t\t\t\t})\n\t\t);\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontent.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-content\" }, children: [ content ] })\n\t\t);\n\n\t\treturn wrapper;\n\t}\n\n\tprepareErrorPaymentContentDetails()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData(),\n\t\t\tdate = BX.prop.getString(entityData, 'DATE', ''),\n\t\t\tfields = this.getObjectDataParam('FIELDS'),\n\t\t\tpaySystemName = BX.prop.getString(fields, 'PAY_SYSTEM_NAME', ''),\n\t\t\tpaySystemError = BX.prop.getString(fields, 'STATUS_DESCRIPTION', ''),\n\t\t\tnodes = [];\n\n\t\tconst descriptionNode = BX.create('DIV', {\n\t\t\tattrs: {className: 'crm-entity-stream-content-detail-description'},\n\t\t\tchildren: [\n\t\t\t\tBX.create('SPAN', {\n\t\t\t\t\ttext: date\n\t\t\t\t}),\n\t\t\t\tBX.create('SPAN', {\n\t\t\t\t\tattrs: {className: 'crm-entity-stream-content-detail-description-info'},\n\t\t\t\t\ttext: this.getMessage('orderPaySystemTitle')\n\t\t\t\t}),\n\t\t\t\tBX.create('SPAN', {\n\t\t\t\t\ttext: paySystemName\n\t\t\t\t}),\n\t\t\t]\n\t\t});\n\t\tnodes.push(descriptionNode);\n\n\t\tconst errorDetailNode = BX.create('DIV', {\n\t\t\tattrs: {className: 'crm-entity-stream-content-event-payment-initiate-pay-error'},\n\t\t\ttext: this.getMessage('orderPaymentStatusErrorReason').replace(\"#PAYSYSTEM_ERROR#\", paySystemError),\n\t\t});\n\n\t\tnodes.push(errorDetailNode);\n\n\t\treturn nodes;\n\t}\n\n\tprepareClickedPaymentContent()\n\t{\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: 'crm-entity-stream-section crm-entity-stream-section-history'}});\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: 'crm-entity-stream-section-icon ' + this.getIconClassName() } })\n\t\t);\n\n\t\tconst header = [\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-event-title\"},\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattrs: {href: \"#\"},\n\t\t\t\t\t\t\t\t\tevents: {click: this._headerClickHandler},\n\t\t\t\t\t\t\t\t\ttext: this.getTitle(),\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t];\n\t\theader.push(\n\t\t\tBX.create(\"SPAN\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-event-time\" },\n\t\t\t\t\ttext: this.formatTime(this.getCreatedTime())\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst content = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\tconst headerWrap = BX.create(\"DIV\", {\n\t\t\tattrs: {className: \"crm-entity-stream-content-header\"},\n\t\t\tchildren: header\n\t\t});\n\n\t\tconst contentChildren = this.prepareClickedPaymentContentDetails();\n\t\tcontent.appendChild(headerWrap);\n\t\tcontent.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail\" },\n\t\t\t\t\tchildren: contentChildren\n\t\t\t\t})\n\t\t);\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontent.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-content\" }, children: [ content ] })\n\t\t);\n\n\t\treturn wrapper;\n\t}\n\n\tprepareClickedPaymentContentDetails()\n\t{\n\t\tconst fields = this.getObjectDataParam('FIELDS'),\n\t\t\tpaySystemName = BX.prop.getString(fields, 'PAY_SYSTEM_NAME', ''),\n\t\t\tnodes = [];\n\n\t\tif(paySystemName !== '')\n\t\t{\n\t\t\tconst descriptionNode = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-detail-description\"}});\n\t\t\tdescriptionNode.appendChild(\n\t\t\t\tBX.create('SPAN', {\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-clicked-description-info\" },\n\t\t\t\t\ttext: this.getMessage('orderPaymentPaySystemClick')\n\t\t\t\t})\n\t\t\t);\n\t\t\tdescriptionNode.appendChild(\n\t\t\t\tBX.create('SPAN', {\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-clicked-description-name\" },\n\t\t\t\t\ttext: paySystemName\n\t\t\t\t})\n\t\t\t);\n\n\t\t\tnodes.push(descriptionNode);\n\t\t}\n\n\t\treturn nodes;\n\t}\n\n\tprepareManualContinuePayContent()\n\t{\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: 'crm-entity-stream-section crm-entity-stream-section-history crm-entity-stream-section-advice'}});\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", {\n\t\t\t\tattrs: { className: 'crm-entity-stream-section-icon crm-entity-stream-section-icon-advice' },\n\t\t\t\tchildren: [BX.create('i')],\n\t\t\t})\n\t\t);\n\n\t\tconst content = BX.create(\"DIV\", {\n\t\t\tattrs: {className: \"crm-entity-stream-advice-info\"},\n\t\t\ttext: this.getMessage('orderManualContinuePay'),\n\t\t});\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-advice-content\" }, children: [ content ] })\n\t\t);\n\n\t\treturn wrapper;\n\t}\n\n\tprepareManualAddCheck()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst showUrl = BX.prop.getString(entityData, \"SHOW_URL\", \"\");\n\n\t\tconst wrapper = BX.create(\n\t\t\t\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {\n\t\t\t\t\tclassName: 'crm-entity-stream-section crm-entity-stream-section-history crm-entity-stream-section-advice'\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t\twrapper.appendChild(\n\t\t\tBX.create(\n\t\t\t\t\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\tclassName: 'crm-entity-stream-section-icon crm-entity-stream-section-icon-advice'\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst htmlTitle = this.getMessage('orderManualAddCheck').replace(\"#HREF#\", showUrl);\n\t\tconst content = BX.create(\n\t\t\t\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {\n\t\t\t\t\tclassName: \"crm-entity-stream-advice-info\",\n\t\t\t\t},\n\t\t\t\thtml: htmlTitle,\n\t\t\t}\n\t\t);\n\n\t\tconst link = BX.create(\n\t\t\t\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {\n\t\t\t\t\tclassName: \"crm-entity-stream-advice-info\",\n\t\t\t\t},\n\t\t\t\tchildren: [\n\t\t\t\t\tBX.create(\n\t\t\t\t\t\t\"A\",\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\t\tclassName: \"crm-entity-stream-content-detail-target\",\n\t\t\t\t\t\t\t\thref: \"#\",\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\t\tclick: BX.delegate(function (e) {\n\t\t\t\t\t\t\t\t\ttop.BX.Helper.show('redirect=detail&code=13742126');\n\t\t\t\t\t\t\t\t\te.preventDefault ? e.preventDefault() : (e.returnValue = false);\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\thtml: this.getMessage('orderManualAddCheckHelpLink'),\n\t\t\t\t\t\t}\n\t\t\t\t\t)\n\t\t\t\t]\n\t\t\t}\n\t\t);\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\n\t\t\t\t\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\tclassName: \"crm-entity-stream-advice-content\"\n\t\t\t\t\t},\n\t\t\t\t\tchildren: [ content, link ]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\treturn wrapper;\n\t}\n\n\tgetIconClassName()\n\t{\n\t\treturn 'crm-entity-stream-section-icon-store';\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new OrderModification();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n\n\tstatic messages = {};\n}\n","import OrderCreation from \"./order-creation\";\n\n/** @memberof BX.Crm.Timeline.Actions */\nexport default class StoreDocumentCreation extends OrderCreation\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tdoInitialize()\n\t{\n\t\tsuper.doInitialize();\n\t\tif(!(this._activityEditor instanceof BX.CrmActivityEditor))\n\t\t{\n\t\t\tthrow \"StoreDocumentCreation. The field 'activityEditor' is not assigned.\";\n\t\t}\n\t}\n\n\tgetIconClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-icon crm-entity-stream-section-icon-info\";\n\t}\n\n\tgetTitle()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst docType = BX.prop.getString(entityData, \"DOC_TYPE\");\n\t\tif (docType === 'A')\n\t\t{\n\t\t\treturn this.getMessage('arrivalDocument');\n\t\t}\n\t\tif (docType === 'S')\n\t\t{\n\t\t\treturn this.getMessage('storeAdjustmentDocument');\n\t\t}\n\t\tif (docType === 'M')\n\t\t{\n\t\t\treturn this.getMessage('movingDocument');\n\t\t}\n\t\tif (docType === 'D')\n\t\t{\n\t\t\treturn this.getMessage('deductDocument');\n\t\t}\n\t\tif (docType === 'W')\n\t\t{\n\t\t\treturn this.getMessage('shipmentDocument');\n\t\t}\n\n\t\treturn '';\n\t}\n\n\tgetWrapperClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-createStoreDocumentEntity\";\n\t}\n\n\tprepareContentDetails()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst title = BX.prop.getString(entityData, \"TITLE\", \"\");\n\t\tconst nodes = [];\n\n\t\tif(title === '')\n\t\t{\n\t\t\treturn nodes;\n\t\t}\n\n\t\tconst titleNode = BX.create('span', {text: title});\n\t\tconst nodeText = title;\n\n\t\tconst titleTemplate = BX.prop.getString(this._data, 'TITLE_TEMPLATE', '');\n\t\tif (titleTemplate)\n\t\t{\n\t\t\tconst docType = BX.prop.getString(entityData, \"DOC_TYPE\");\n\t\t\tif (docType === 'W')\n\t\t\t{\n\t\t\t\tif (this.getOwnerTypeId() === BX.CrmEntityType.enumeration.deal)\n\t\t\t\t{\n\t\t\t\t\tconst documentDetailUrl = BX.prop.getString(this._data, 'DETAIL_LINK', '');\n\t\t\t\t\tconst documentLinkTag = '<a href=\"' + documentDetailUrl + '\">' + title + '</a>';\n\t\t\t\t\ttitleNode.innerHTML = titleTemplate.replace('#TITLE#', documentLinkTag);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\ttitleNode.innerHTML = titleTemplate.replace('#TITLE#', title);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\ttitleNode.innerHTML = titleTemplate.replace('#TITLE#', title);\n\t\t\t}\n\t\t}\n\n\t\tnodes.push(BX.create(\"DIV\", {\n\t\t\tattrs: { className: \"crm-entity-stream-content-detail-description\" },\n\t\t\tchildren: [titleNode],\n\t\t}));\n\n\t\treturn nodes;\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = StoreDocumentCreation.messages;\n\t\treturn m.hasOwnProperty(name) ? m[name] : name;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new StoreDocumentCreation();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n\n\tstatic messages = {};\n}\n","import Modification from \"./modification\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class StoreDocumentModification extends Modification\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tdoInitialize()\n\t{\n\t\tsuper.doInitialize();\n\t\tif(!(this._activityEditor instanceof BX.CrmActivityEditor))\n\t\t{\n\t\t\tthrow \"StoreDocumentModification. The field 'activityEditor' is not assigned.\";\n\t\t}\n\t}\n\n\tgetIconClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-icon crm-entity-stream-section-icon-info\";\n\t}\n\n\tgetTitle()\n\t{\n\t\tconst error = this.getTextDataParam(\"ERROR\");\n\t\tif (error === 'CONDUCT')\n\t\t{\n\t\t\treturn this.getMessage('conductError');\n\t\t}\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst field = this.getTextDataParam(\"FIELD\");\n\t\tconst docType = BX.prop.getString(entityData, \"DOC_TYPE\");\n\t\tif (docType === 'A')\n\t\t{\n\t\t\tif (field === 'STATUS')\n\t\t\t{\n\t\t\t\treturn this.getMessage('arrivalDocument');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\treturn this.getMessage('arrivalModification');\n\t\t\t}\n\t\t}\n\t\tif (docType === 'S')\n\t\t{\n\t\t\tif (field === 'STATUS')\n\t\t\t{\n\t\t\t\treturn this.getMessage('storeAdjustmentDocument');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\treturn this.getMessage('storeAdjustmentModification');\n\t\t\t}\n\t\t}\n\t\tif (docType === 'M')\n\t\t{\n\t\t\tif (field === 'STATUS')\n\t\t\t{\n\t\t\t\treturn this.getMessage('movingDocument');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\treturn this.getMessage('movingModification');\n\t\t\t}\n\t\t}\n\t\tif (docType === 'D')\n\t\t{\n\t\t\tif (field === 'STATUS')\n\t\t\t{\n\t\t\t\treturn this.getMessage('deductDocument');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\treturn this.getMessage('deductModification');\n\t\t\t}\n\t\t}\n\t\tif (docType === 'W')\n\t\t{\n\t\t\tif (field === 'STATUS')\n\t\t\t{\n\t\t\t\treturn this.getMessage('shipmentDocument');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\treturn this.getMessage('shipmentModification');\n\t\t\t}\n\t\t}\n\n\t\treturn '';\n\t}\n\n\tgetStatusInfo()\n\t{\n\t\tconst statusInfo = {};\n\t\tconst statusName = this.getTextDataParam('STATUS_TITLE');\n\t\tconst classCode = this.getTextDataParam('STATUS_CLASS');\n\t\t{\n\t\t\tstatusInfo.message = statusName;\n\t\t\tstatusInfo.className = \"crm-entity-stream-content-event-\" + classCode;\n\t\t}\n\n\t\treturn statusInfo;\n\t}\n\n\tgetHeaderChildren()\n\t{\n\t\tconst children = [\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-event-title\"},\n\t\t\t\t\tevents: {click: this._headerClickHandler},\n\t\t\t\t\ttext: this.getTitle(),\n\t\t\t\t}\n\t\t\t)\n\t\t];\n\t\tconst statusInfo = this.getStatusInfo();\n\t\tif (BX.type.isNotEmptyObject(statusInfo))\n\t\t{\n\t\t\tchildren.push(\n\t\t\t\tBX.create(\"SPAN\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: statusInfo.className },\n\t\t\t\t\t\ttext: statusInfo.message\n\t\t\t\t\t}\n\t\t\t\t));\n\t\t}\n\t\tchildren.push(\n\t\t\tBX.create(\"SPAN\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-event-time\" },\n\t\t\t\t\ttext: this.formatTime(this.getCreatedTime())\n\t\t\t\t}\n\t\t\t));\n\t\treturn children;\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-section crm-entity-stream-section-history\"}});\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-info\" } })\n\t\t);\n\n\t\tconst content = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\tconst header = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-header\"},\n\t\t\t\tchildren: this.getHeaderChildren()\n\t\t\t}\n\t\t);\n\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst title = BX.prop.getString(entityData, \"TITLE\", \"\");\n\t\tconst error = this.getTextDataParam(\"ERROR\");\n\t\tconst contentChildren = [];\n\n\t\tif(error)\n\t\t{\n\t\t\tconst errorMessage = this.getTextDataParam(\"ERROR_MESSAGE\");\n\t\t\tcontentChildren.push(BX.create(\"DIV\", {\n\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-description\" },\n\t\t\t\tchildren: errorMessage\n\t\t\t}));\n\t\t}\n\t\telse if(title !== \"\")\n\t\t{\n\t\t\tconst titleNode = BX.create('span', {text: title});\n\t\t\tconst nodeText = title;\n\n\t\t\tconst titleTemplate = BX.prop.getString(this._data, 'TITLE_TEMPLATE', '');\n\t\t\tif (titleTemplate)\n\t\t\t{\n\t\t\t\tconst docType = BX.prop.getString(entityData, \"DOC_TYPE\");\n\t\t\t\tif (docType === 'W')\n\t\t\t\t{\n\t\t\t\t\tif (this.getOwnerTypeId() === BX.CrmEntityType.enumeration.deal)\n\t\t\t\t\t{\n\t\t\t\t\t\tconst documentDetailUrl = BX.prop.getString(this._data, 'DETAIL_LINK', '');\n\t\t\t\t\t\tconst documentLinkTag = '<a href=\"' + documentDetailUrl + '\">' + title + '</a>';\n\t\t\t\t\t\ttitleNode.innerHTML = titleTemplate.replace('#TITLE#', documentLinkTag);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\ttitleNode.innerHTML = titleTemplate.replace('#TITLE#', title);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\ttitleNode.innerHTML = titleTemplate.replace('#TITLE#', title);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tcontentChildren.push(BX.create(\"DIV\", {\n\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-description\" },\n\t\t\t\tchildren: [titleNode],\n\t\t\t}));\n\t\t}\n\n\t\tcontent.appendChild(header);\n\t\tcontent.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail\" },\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-info\" },\n\t\t\t\t\t\t\t\t\tchildren: contentChildren\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t]\n\t\t\t\t})\n\t\t);\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontent.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-content\" }, children: [ content ] })\n\t\t);\n\n\t\treturn wrapper;\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = StoreDocumentModification.messages;\n\t\treturn m.hasOwnProperty(name) ? m[name] : name;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new StoreDocumentModification();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n\n\tstatic messages = {};\n}\n","import OrderModification from \"./order-modification\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class ExternalNoticeModification extends OrderModification\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetIconClassName()\n\t{\n\t\treturn 'crm-entity-stream-section-icon-restApp';\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new ExternalNoticeModification();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import ExternalNoticeModification from \"./external-notice-modification\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class ExternalNoticeStatusModification extends ExternalNoticeModification\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tprepareContentDetails()\n\t{\n\t\tconst nodes = [];\n\t\tconst contentChildren = [];\n\n\t\tif (BX.type.isNotEmptyString(this.getTextDataParam(\"START_NAME\")))\n\t\t{\n\t\t\tcontentChildren.push(\n\t\t\t\tBX.create(\"SPAN\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-detain-info-status\"},\n\t\t\t\t\t\ttext: this.getTextDataParam(\"START_NAME\")\n\t\t\t\t\t})\n\t\t\t);\n\t\t\tcontentChildren.push(\n\t\t\t\tBX.create(\"SPAN\",{ attrs: { className: \"crm-entity-stream-content-detail-info-separator-icon\" } })\n\t\t\t);\n\t\t}\n\n\t\tif (BX.type.isNotEmptyString(this.getTextDataParam(\"FINISH_NAME\")))\n\t\t{\n\t\t\tcontentChildren.push(\n\t\t\t\tBX.create(\"SPAN\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detain-info-status\" },\n\t\t\t\t\t\ttext: this.getTextDataParam(\"FINISH_NAME\")\n\t\t\t\t\t})\n\t\t\t);\n\t\t}\n\n\t\tnodes.push(BX.create(\"DIV\",\t{\n\t\t\tattrs: { className: \"crm-entity-stream-content-detail-info\" },\n\t\t\tchildren: contentChildren\n\t\t}));\n\n\t\treturn nodes;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new ExternalNoticeStatusModification();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import History from \"./history\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class OrderCheck extends History\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tdoInitialize()\n\t{\n\t\tsuper.doInitialize();\n\t\tif(!(this._activityEditor instanceof BX.CrmActivityEditor))\n\t\t{\n\t\t\tthrow \"OrderCheck. The field 'activityEditor' is not assigned.\";\n\t\t}\n\t}\n\n\tgetTitle()\n\t{\n\t\tlet result = this.getMessage('orderCheck');\n\n\t\tconst checkName = this.getTextDataParam('CHECK_NAME');\n\t\tif (checkName !== '')\n\t\t{\n\t\t\tresult += ' \"' + checkName + '\"';\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tgetWrapperClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-createOrderEntity\";\n\t}\n\n\tgetHeaderChildren()\n\t{\n\t\tlet statusMessage = '';\n\t\tlet statusClass = '';\n\t\tlet title = this.getTitle();\n\n\t\tif (this.getTextDataParam(\"SENDED\") !== '')\n\t\t{\n\t\t\ttitle = this.getMessage('sendedTitle');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tstatusMessage = this.getMessage(\"printed\");\n\t\t\tstatusClass = \"crm-entity-stream-content-event-successful\";\n\t\t\tif (this.getTextDataParam(\"PRINTED\") !== 'Y')\n\t\t\t{\n\t\t\t\tstatusMessage = this.getMessage(\"unprinted\");\n\t\t\t\tstatusClass = \"crm-entity-stream-content-event-missing\";\n\t\t\t}\n\t\t}\n\n\t\treturn [\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-event-title\" },\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattrs: { href: \"#\" },\n\t\t\t\t\t\t\t\t\tevents: { click: this._headerClickHandler },\n\t\t\t\t\t\t\t\t\ttext: title\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t),\n\t\t\tBX.create(\"SPAN\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: statusClass },\n\t\t\t\t\ttext: statusMessage\n\t\t\t\t}\n\t\t\t),\n\t\t\tBX.create(\"SPAN\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-event-time\" },\n\t\t\t\t\ttext: this.formatTime(this.getCreatedTime())\n\t\t\t\t}\n\t\t\t)\n\t\t];\n\t}\n\n\tprepareContentDetails()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst title = this.getTextDataParam(\"TITLE\");\n\t\tconst showUrl = BX.prop.getString(entityData, \"SHOW_URL\", '');\n\t\tconst nodes = [];\n\t\tif(title !== \"\")\n\t\t{\n\t\t\tconst isSended = this.getTextDataParam(\"SENDED\") !== '';\n\t\t\tconst className = isSended\n\t\t\t\t? 'crm-entity-stream-content-detail-order'\n\t\t\t\t: 'crm-entity-stream-content-detail-description'\n\t\t\t;\n\n\t\t\tconst descriptionNode = BX.create(\"DIV\", {attrs: {className: className}});\n\t\t\tif (showUrl !== \"\")\n\t\t\t{\n\t\t\t\tdescriptionNode.appendChild(BX.create(\"A\", {\n\t\t\t\t\tattrs: { href: showUrl},\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tclick: BX.delegate(function(e) {\n\t\t\t\t\t\t\tBX.Crm.Page.openSlider(showUrl, { width: 500 });\n\t\t\t\t\t\t\te.preventDefault ? e.preventDefault() : (e.returnValue = false);\n\t\t\t\t\t\t}, this)\n\t\t\t\t\t},\n\t\t\t\t\ttext: title\n\t\t\t\t}));\n\t\t\t}\n\n\t\t\tconst legend = this.getTextDataParam(\"LEGEND\");\n\t\t\tlet legendNode;\n\t\t\tif(legend !== \"\")\n\t\t\t{\n\t\t\t\tlegendNode = BX.create(\"SPAN\", { html: \" \" + legend });\n\t\t\t}\n\n\t\t\tif (isSended)\n\t\t\t{\n\t\t\t\tnodes.push(descriptionNode);\n\t\t\t\tif (legendNode)\n\t\t\t\t{\n\t\t\t\t\tnodes.push(legendNode);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (legendNode)\n\t\t\t\t{\n\t\t\t\t\tdescriptionNode.appendChild(legendNode);\n\t\t\t\t}\n\t\t\t\tnodes.push(descriptionNode);\n\t\t\t}\n\t\t}\n\n\t\tconst checkUrl = this.getTextDataParam(\"CHECK_URL\");\n\t\tif (checkUrl)\n\t\t{\n\t\t\tnodes.push(\n\t\t\t\tBX.create(\"DIV\", {\n\t\t\t\t\tattrs: { className: 'crm-entity-stream-content-detail-payment-info' },\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tBX.create(\"A\", { attrs: { href: checkUrl, target: '_blank'}, text: this.getMessage('urlLink') })\n\t\t\t\t\t]\n\t\t\t\t})\n\t\t\t);\n\t\t}\n\n\t\treturn nodes;\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst wrapperClassName = \"crm-entity-stream-section crm-entity-stream-section-history crm-entity-stream-section-createOrderEntity\";\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: wrapperClassName}});\n\t\twrapper.appendChild(BX.create(\"DIV\", { attrs: { className: this.getIconClassName() } }));\n\n\t\tconst contentWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{ attrs: { className: \"crm-entity-stream-section-content\" }, children: [ contentWrapper ] }\n\t\t\t)\n\t\t);\n\n\t\tconst header = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-header\"},\n\t\t\t\tchildren: this.getHeaderChildren()\n\t\t\t}\n\t\t);\n\t\tcontentWrapper.appendChild(header);\n\n\t\tcontentWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail\" },\n\t\t\t\t\tchildren: this.prepareContentDetails()\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontentWrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\treturn wrapper;\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = OrderCheck.messages;\n\t\treturn m.hasOwnProperty(name) ? m[name] : name;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new OrderCheck();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n\n\tstatic messages = {};\n}\n","import History from \"./history\";\nimport {EventEmitter} from \"main.core.events\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class FinalSummaryDocuments extends History\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = FinalSummaryDocuments.messages;\n\t\treturn m.hasOwnProperty(name) ? m[name] : name;\n\t}\n\n\tgetTitle()\n\t{\n\t\treturn this.getMessage('title');\n\t}\n\n\tgetHeaderChildren()\n\t{\n\t\tconst children = [\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-event-title\"},\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattrs: {href: \"#\"},\n\t\t\t\t\t\t\t\t\tevents: {click: this._headerClickHandler},\n\t\t\t\t\t\t\t\t\ttext: this.getTitle()\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t];\n\t\tchildren.push(\n\t\t\tBX.create(\"SPAN\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-event-time\" },\n\t\t\t\t\ttext: this.formatTime(this.getCreatedTime())\n\t\t\t\t}\n\t\t\t));\n\n\t\treturn children;\n\t}\n\n\tcreateCheckBlock(check)\n\t{\n\t\tconst blockNode = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-detail-notice\"}});\n\t\tblockNode.appendChild(\n\t\t\tBX.create(\n\t\t\t\t\"a\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { href: check.URL, target: '_blank' },\n\t\t\t\t\ttext: check.TITLE\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\treturn blockNode;\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-section crm-entity-stream-section-payment\"}});\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: 'crm-entity-stream-section-icon ' + this.getIconClassName() } })\n\t\t);\n\n\t\tconst content = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-section-content\"}});\n\n\t\tconst contentItem = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\n\t\tconst header = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-header\"},\n\t\t\t\tchildren: this.getHeaderChildren()\n\t\t\t});\n\t\tcontentItem.appendChild(header);\n\n\t\tconst data = this.getData();\n\n\t\tif (data.RESULT)\n\t\t{\n\t\t\tconst summaryOptions = {\n\t\t\t\t'OWNER_ID': data.ASSOCIATED_ENTITY_ID,\n\t\t\t\t'OWNER_TYPE_ID': data.ASSOCIATED_ENTITY_TYPE_ID,\n\t\t\t\t'PARENT_CONTEXT': this,\n\t\t\t\t'CONTEXT': BX.CrmEntityType.resolveName(data.ASSOCIATED_ENTITY_TYPE_ID).toLowerCase(),\n\t\t\t\t'IS_WITH_ORDERS_MODE': false,\n\t\t\t};\n\t\t\tconst timelineSummaryDocuments = new BX.Crm.TimelineSummaryDocuments(summaryOptions);\n\n\t\t\tconst options = data.RESULT.TIMELINE_SUMMARY_OPTIONS;\n\t\t\ttimelineSummaryDocuments.setOptions(options);\n\t\t\tconst nodes = [\n\t\t\t\ttimelineSummaryDocuments.render(),\n\t\t\t];\n\n\t\t\tcontentItem.appendChild(\n\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail\"},\n\t\t\t\t\t\tchildren: nodes\n\t\t\t\t\t})\n\t\t\t);\n\n\t\t\tcontent.appendChild(contentItem);\n\t\t}\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontent.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-content\" }, children: [ content ] })\n\t\t);\n\n\t\treturn wrapper;\n\t}\n\n\tprepareLayout(options)\n\t{\n\t\tsuper.prepareLayout(options);\n\t\tconst enableAdd = BX.type.isPlainObject(options) ? BX.prop.getBoolean(options, \"add\", true) : true;\n\t\tif (enableAdd)\n\t\t{\n\t\t\tEventEmitter.emit('BX.Crm.Timeline.Items.FinalSummaryDocuments:onHistoryNodeAdded', [this._wrapper]);\n\t\t}\n\t}\n\n\tgetIconClassName()\n\t{\n\t\treturn 'crm-entity-stream-section-icon-complete';\n\t}\n\n\tstartSalescenterApplication(orderId, options)\n\t{\n\t\tif (options === undefined)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tBX.loadExt('salescenter.manager').then(function()\n\t\t{\n\t\t\tBX.Salescenter.Manager.openApplication(options);\n\t\t}.bind(this));\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new FinalSummaryDocuments();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n\n\tstatic messages = {};\n}\n","import FinalSummaryDocuments from \"./final-summary-documents\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class FinalSummary extends FinalSummaryDocuments\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-section crm-entity-stream-section-payment\"}});\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: 'crm-entity-stream-section-icon ' + this.getIconClassName() } })\n\t\t);\n\n\t\tconst content = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-section-content\"}});\n\n\t\tconst contentItem = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\n\t\tconst header = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-header\"},\n\t\t\t\tchildren: this.getHeaderChildren()\n\t\t\t});\n\t\tcontentItem.appendChild(header);\n\n\t\tconst data = this.getData();\n\n\t\tif (data.RESULT)\n\t\t{\n\t\t\tconst summaryOptions = {\n\t\t\t\t'OWNER_ID': data.ASSOCIATED_ENTITY_ID,\n\t\t\t\t'OWNER_TYPE_ID': data.ASSOCIATED_ENTITY_TYPE_ID,\n\t\t\t\t'PARENT_CONTEXT': this,\n\t\t\t\t'CONTEXT': BX.CrmEntityType.resolveName(data.ASSOCIATED_ENTITY_TYPE_ID).toLowerCase(),\n\t\t\t\t'IS_WITH_ORDERS_MODE': true,\n\t\t\t};\n\t\t\tconst timelineSummaryDocuments = new BX.Crm.TimelineSummaryDocuments(summaryOptions);\n\n\t\t\tconst options = data.RESULT.TIMELINE_SUMMARY_OPTIONS;\n\t\t\ttimelineSummaryDocuments.setOptions(options);\n\t\t\tconst nodes = [\n\t\t\t\ttimelineSummaryDocuments.render(),\n\t\t\t];\n\n\t\t\tcontentItem.appendChild(\n\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail\"},\n\t\t\t\t\t\tchildren: nodes\n\t\t\t\t\t})\n\t\t\t);\n\n\t\t\tcontent.appendChild(contentItem);\n\t\t}\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontent.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-content\" }, children: [ content ] })\n\t\t);\n\n\t\treturn wrapper;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new FinalSummary();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import HistoryItem from \"./history\";\nimport {Item as ItemType} from \"../types\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Creation extends HistoryItem\n{\n\tstatic messages = {};\n\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Creation();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n\n\tdoInitialize()\n\t{\n\t\tsuper.doInitialize();\n\t\tif (!(this._activityEditor instanceof BX.CrmActivityEditor))\n\t\t{\n\t\t\tthrow \"Creation. The field 'activityEditor' is not assigned.\";\n\t\t}\n\t}\n\n\tgetTitle()\n\t{\n\t\tconst entityTypeId = this.getAssociatedEntityTypeId();\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tif (entityTypeId === BX.CrmEntityType.enumeration.activity)\n\t\t{\n\t\t\tconst typeId = BX.prop.getInteger(entityData, \"TYPE_ID\");\n\t\t\tconst title = this.getMessage(typeId === BX.CrmActivityType.task ? \"task\" : \"activity\");\n\t\t\treturn title.replace(/#TITLE#/gi, this.cutOffText(BX.prop.getString(entityData, \"SUBJECT\")), 64);\n\t\t}\n\n\t\tif (entityTypeId === BX.CrmEntityType.enumeration.storeDocument)\n\t\t{\n\t\t\tconst docType = BX.prop.getString(entityData, \"DOC_TYPE\");\n\t\t\tif (docType === 'A')\n\t\t\t{\n\t\t\t\treturn this.getMessage('arrivalDocument');\n\t\t\t}\n\t\t\tif (docType === 'S')\n\t\t\t{\n\t\t\t\treturn this.getMessage('storeAdjustmentDocument');\n\t\t\t}\n\t\t\tif (docType === 'M')\n\t\t\t{\n\t\t\t\treturn this.getMessage('movingDocument');\n\t\t\t}\n\t\t\tif (docType === 'D')\n\t\t\t{\n\t\t\t\treturn this.getMessage('deductDocument');\n\t\t\t}\n\t\t\tif (docType === 'W')\n\t\t\t{\n\t\t\t\treturn this.getMessage('shipmentDocument');\n\t\t\t}\n\n\t\t\treturn '';\n\t\t}\n\n\t\tconst entityTypeName = BX.CrmEntityType.resolveName(this.getAssociatedEntityTypeId()).toLowerCase();\n\t\tlet msg = this.getMessage(entityTypeName);\n\t\tconst isMessageNotFound = (msg === entityTypeName);\n\t\tif (!BX.type.isNotEmptyString(msg) || isMessageNotFound)\n\t\t{\n\t\t\tmsg = this.getTextDataParam(\"TITLE\");\n\t\t}\n\n\t\treturn msg;\n\t}\n\n\tgetWrapperClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-createEntity\";\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst entityTypeId = this.getAssociatedEntityTypeId();\n\n\t\tif (\n\t\t\tentityTypeId === BX.CrmEntityType.enumeration.ordershipment\n\t\t\t|| entityTypeId === BX.CrmEntityType.enumeration.orderpayment\n\t\t)\n\t\t{\n\t\t\tconst data = this.getData();\n\t\t\tdata.TYPE_CATEGORY_ID = ItemType.modification;\n\t\t\tif (data.hasOwnProperty('ASSOCIATED_ENTITY'))\n\t\t\t{\n\t\t\t\tdata.ASSOCIATED_ENTITY.HTML_TITLE = '';\n\t\t\t}\n\n\t\t\tconst createOrderEntityItem = this._history.createOrderEntityItem(data);\n\t\t\treturn createOrderEntityItem.prepareContent();\n\t\t}\n\n\t\treturn super.prepareContent();\n\t}\n\n\tprepareContentDetails()\n\t{\n\t\tconst entityTypeId = this.getAssociatedEntityTypeId();\n\t\tconst entityId = this.getAssociatedEntityId();\n\t\tconst entityData = this.getAssociatedEntityData();\n\n\t\tif (entityTypeId === BX.CrmEntityType.enumeration.activity)\n\t\t{\n\t\t\tconst link = BX.create(\"A\",\n\t\t\t\t{\n\t\t\t\t\tattrs: {href: \"#\"},\n\t\t\t\t\thtml: this.cutOffText(BX.prop.getString(entityData, \"DESCRIPTION_RAW\"), 128)\n\t\t\t\t}\n\t\t\t);\n\t\t\tBX.bind(link, \"click\", this._headerClickHandler);\n\n\t\t\treturn [link];\n\t\t}\n\n\t\tconst title = BX.prop.getString(entityData, \"TITLE\", \"\");\n\t\tlet htmlTitle = BX.prop.getString(entityData, \"HTML_TITLE\", \"\");\n\t\tconst showUrl = BX.prop.getString(entityData, \"SHOW_URL\", \"\");\n\n\t\tif (\n\t\t\tentityTypeId === BX.CrmEntityType.enumeration.deal\n\t\t\t&& BX.prop.getObject(entityData, \"ORDER\", null)\n\t\t)\n\t\t{\n\t\t\tconst orderData = BX.prop.getObject(entityData, \"ORDER\", null);\n\t\t\thtmlTitle = this.getMessage('dealOrderTitle')\n\t\t\t\t.replace(\"#ORDER_ID#\", orderData.ID)\n\t\t\t\t.replace(\"#DATE_TIME#\", orderData.ORDER_DATE)\n\t\t\t\t.replace(\"#HREF#\", orderData.SHOW_URL)\n\t\t\t\t.replace(\"#PRICE_WITH_CURRENCY#\", orderData.SUM)\n\t\t\t;\n\t\t}\n\n\t\tif (title !== \"\" || htmlTitle !== \"\")\n\t\t{\n\t\t\tconst nodes = [];\n\t\t\tif (showUrl === \"\" || (entityTypeId === this.getOwnerTypeId() && entityId === this.getOwnerId()))\n\t\t\t{\n\t\t\t\tconst spanAttrs = (htmlTitle !== \"\") ? {html: htmlTitle} : {text: title};\n\t\t\t\tnodes.push(BX.create(\"SPAN\", spanAttrs));\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tlet linkAttrs = {attrs: {href: showUrl}, text: title};\n\t\t\t\tif (htmlTitle !== \"\")\n\t\t\t\t{\n\t\t\t\t\tlinkAttrs = {attrs: {href: showUrl}, html: htmlTitle};\n\t\t\t\t}\n\t\t\t\tnodes.push(BX.create(\"A\", linkAttrs));\n\t\t\t}\n\n\t\t\tconst legend = this.getTextDataParam(\"LEGEND\");\n\t\t\tif (legend !== \"\")\n\t\t\t{\n\t\t\t\tnodes.push(BX.create(\"BR\"));\n\t\t\t\tnodes.push(BX.create(\"SPAN\", {text: legend}));\n\t\t\t}\n\n\t\t\tconst baseEntityData = this.getObjectDataParam(\"BASE\");\n\t\t\tconst baseEntityInfo = BX.prop.getObject(baseEntityData, \"ENTITY_INFO\");\n\t\t\tif (baseEntityInfo)\n\t\t\t{\n\t\t\t\tnodes.push(BX.create(\"BR\"));\n\t\t\t\tnodes.push(BX.create(\"SPAN\", {text: BX.prop.getString(baseEntityData, \"CAPTION\") + \": \"}));\n\t\t\t\tnodes.push(\n\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tattrs: {href: BX.prop.getString(baseEntityInfo, \"SHOW_URL\", \"#\")},\n\t\t\t\t\t\t\ttext: BX.prop.getString(baseEntityInfo, \"TITLE\", \"\")\n\t\t\t\t\t\t}\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\t\t\treturn nodes;\n\t\t}\n\t\treturn [];\n\t}\n\n\tview()\n\t{\n\t\tconst entityTypeId = this.getAssociatedEntityTypeId();\n\t\tif (entityTypeId === BX.CrmEntityType.enumeration.activity)\n\t\t{\n\t\t\tconst entityData = this.getAssociatedEntityData();\n\t\t\tconst id = BX.prop.getInteger(entityData, \"ID\", 0);\n\t\t\tif (id > 0)\n\t\t\t{\n\t\t\t\tthis._activityEditor.viewActivity(id);\n\t\t\t}\n\t\t}\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = Creation.messages;\n\n\t\treturn m.hasOwnProperty(name) ? m[name] : name;\n\t}\n}\n","import History from \"./history\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Restoration extends History\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetTitle()\n\t{\n\t\treturn this.getTextDataParam(\"TITLE\");\n\t}\n\n\tgetWrapperClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-restoreEntity\";\n\t}\n\n\tprepareContentDetails()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst title = BX.prop.getString(entityData, \"TITLE\");\n\t\treturn title !== \"\" ?  [ BX.create(\"SPAN\", { text: title }) ] : [];\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = Restoration.messages;\n\t\treturn m.hasOwnProperty(name) ? m[name] : name;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Restoration();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n\n\tstatic messages = {};\n}\n","import History from \"./history\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Relation extends History\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetTitle()\n\t{\n\t\treturn this.getMessage('title');\n\t}\n\n\tgetWrapperClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-createEntity\";\n\t}\n\n\tprepareContentDetails()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\n\t\tlet link = BX.prop.getString(entityData, \"SHOW_URL\", \"\");\n\t\tif (link.indexOf('/') !== 0)\n\t\t{\n\t\t\tlink = '#';\n\t\t}\n\n\t\tconst content =\n\t\t\tthis.getMessage('contentTemplate')\n\t\t\t\t.replace('#ENTITY_TYPE_CAPTION#', BX.Text.encode(BX.prop.getString(entityData, 'ENTITY_TYPE_CAPTION', '')))\n\t\t\t\t.replace('#LEGEND#', '')\n\t\t\t\t.replace('#LINK#', BX.Text.encode(link))\n\t\t\t\t.replace('#LINK_TITLE#', BX.Text.encode(BX.prop.getString(entityData, \"TITLE\", '')))\n\t\t;\n\n\t\tconst nodes = [];\n\t\tnodes.push(\n\t\t\tBX.create('SPAN', { html: content })\n\t\t);\n\n\t\treturn nodes;\n\t}\n}\n","import Relation from \"./relation\"\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Link extends Relation\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetIconClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-icon crm-entity-stream-section-icon-link\";\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = Link.messages;\n\t\treturn m.hasOwnProperty(name) ? m[name] : name;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Link();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n\n\tstatic messages = {};\n}\n","import Relation from \"./relation\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Unlink extends Relation\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetIconClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-icon crm-entity-stream-section-icon-unlink\";\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = Unlink.messages;\n\t\treturn m.hasOwnProperty(name) ? m[name] : name;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Unlink();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n\n\tstatic messages = {};\n}\n","import History from \"./history\";\nimport {Mark as MarkType} from \"../types\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Mark extends History\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tdoInitialize()\n\t{\n\t\tsuper.doInitialize();\n\t\tif(!(this._activityEditor instanceof BX.CrmActivityEditor))\n\t\t{\n\t\t\tthrow \"Mark. The field 'activityEditor' is not assigned.\";\n\t\t}\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = Mark.messages;\n\t\tif (m.hasOwnProperty(name))\n\t\t{\n\t\t\treturn m[name];\n\t\t}\n\n\t\treturn super.getMessage(name);\n\t}\n\n\tgetTitle()\n\t{\n\t\tlet title = \"\";\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst associatedEntityTypeId = this.getAssociatedEntityTypeId();\n\t\tconst typeCategoryId = this.getTypeCategoryId();\n\t\tif(associatedEntityTypeId === BX.CrmEntityType.enumeration.activity)\n\t\t{\n\t\t\tconst entityTypeId = BX.prop.getInteger(entityData, \"TYPE_ID\", 0);\n\t\t\tconst direction = BX.prop.getInteger(entityData, \"DIRECTION\", 0);\n\t\t\tconst activityProviderId = BX.prop.getString(entityData, \"PROVIDER_ID\", '');\n\n\t\t\tif(entityTypeId === BX.CrmActivityType.email)\n\t\t\t{\n\t\t\t\tif(typeCategoryId === MarkType.success)\n\t\t\t\t{\n\t\t\t\t\ttitle = this.getMessage(\n\t\t\t\t\t\t(direction === BX.CrmActivityDirection.incoming ? \"incomingEmail\" : \"outgoingEmail\") +\n\t\t\t\t\t\t\"SuccessMark\"\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\telse if(typeCategoryId === MarkType.renew)\n\t\t\t\t{\n\t\t\t\t\ttitle = this.getMessage(\n\t\t\t\t\t\t(direction === BX.CrmActivityDirection.incoming ? \"incomingEmail\" : \"outgoingEmail\") +\n\t\t\t\t\t\t\"RenewMark\"\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if(entityTypeId === BX.CrmActivityType.call)\n\t\t\t{\n\t\t\t\tif(typeCategoryId === MarkType.success)\n\t\t\t\t{\n\t\t\t\t\ttitle = this.getMessage(\n\t\t\t\t\t\t(direction === BX.CrmActivityDirection.incoming ? \"incomingCall\" : \"outgoingCall\") +\n\t\t\t\t\t\t\"SuccessMark\"\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\telse if(typeCategoryId === MarkType.renew)\n\t\t\t\t{\n\t\t\t\t\ttitle = this.getMessage(\n\t\t\t\t\t\t(direction === BX.CrmActivityDirection.incoming ? \"incomingCall\" : \"outgoingCall\") +\n\t\t\t\t\t\t\"RenewMark\"\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if(entityTypeId === BX.CrmActivityType.meeting)\n\t\t\t{\n\t\t\t\tif(typeCategoryId === MarkType.success)\n\t\t\t\t{\n\t\t\t\t\ttitle = this.getMessage(\"meetingSuccessMark\");\n\t\t\t\t}\n\t\t\t\telse if(typeCategoryId === MarkType.renew)\n\t\t\t\t{\n\t\t\t\t\ttitle = this.getMessage(\"meetingRenewMark\");\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if(entityTypeId === BX.CrmActivityType.task)\n\t\t\t{\n\t\t\t\tif(typeCategoryId === MarkType.success)\n\t\t\t\t{\n\t\t\t\t\ttitle = this.getMessage(\"taskSuccessMark\");\n\t\t\t\t}\n\t\t\t\telse if(typeCategoryId === MarkType.renew)\n\t\t\t\t{\n\t\t\t\t\ttitle = this.getMessage(\"taskRenewMark\");\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if(entityTypeId === BX.CrmActivityType.provider)\n\t\t\t{\n\t\t\t\tif (activityProviderId === 'CRM_REQUEST')\n\t\t\t\t{\n\t\t\t\t\tif(typeCategoryId === MarkType.success)\n\t\t\t\t\t{\n\t\t\t\t\t\ttitle = this.getMessage(\"requestSuccessMark\");\n\t\t\t\t\t}\n\t\t\t\t\telse if(typeCategoryId === MarkType.renew)\n\t\t\t\t\t{\n\t\t\t\t\t\ttitle = this.getMessage(\"requestRenewMark\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if(typeCategoryId === MarkType.success)\n\t\t\t\t{\n\t\t\t\t\ttitle = this.getMessage(\"webformSuccessMark\");\n\t\t\t\t}\n\t\t\t\telse if(typeCategoryId === MarkType.renew)\n\t\t\t\t{\n\t\t\t\t\ttitle = this.getMessage(\"webformRenewMark\");\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse if(associatedEntityTypeId === BX.CrmEntityType.enumeration.deal)\n\t\t{\n\t\t\tif(typeCategoryId === MarkType.success)\n\t\t\t{\n\t\t\t\ttitle = this.getMessage(\"dealSuccessMark\");\n\t\t\t}\n\t\t\telse if(typeCategoryId === MarkType.failed)\n\t\t\t{\n\t\t\t\ttitle = this.getMessage(\"dealFailedMark\");\n\t\t\t}\n\t\t}\n\t\telse if(associatedEntityTypeId === BX.CrmEntityType.enumeration.order)\n\t\t{\n\t\t\tif(typeCategoryId === MarkType.success)\n\t\t\t{\n\t\t\t\ttitle = this.getMessage(\"orderSuccessMark\");\n\t\t\t}\n\t\t\telse if(typeCategoryId === MarkType.failed)\n\t\t\t{\n\t\t\t\ttitle = this.getMessage(\"orderFailedMark\");\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (BX.CrmEntityType.isDefined(associatedEntityTypeId))\n\t\t\t{\n\t\t\t\tif (typeCategoryId === MarkType.success)\n\t\t\t\t{\n\t\t\t\t\ttitle = this.getMessage('entitySuccessMark');\n\t\t\t\t}\n\t\t\t\telse if (typeCategoryId === MarkType.failed)\n\t\t\t\t{\n\t\t\t\t\ttitle = this.getMessage('entityFailedMark');\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn title;\n\t}\n\n\tprepareTitleLayout()\n\t{\n\t\tconst associatedEntityTypeId = this.getAssociatedEntityTypeId();\n\n\t\tif(associatedEntityTypeId === BX.CrmEntityType.enumeration.order)\n\t\t{\n\t\t\treturn BX.create(\"SPAN\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-event-title\" },\n\t\t\t\t\ttext: this.getTitle()\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn BX.create(\"A\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { href: \"#\", className: \"crm-entity-stream-content-event-title\" },\n\t\t\t\t\tevents: { \"click\": this._headerClickHandler },\n\t\t\t\t\ttext: this.getTitle()\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst associatedEntityTypeId = this.getAssociatedEntityTypeId();\n\n\t\tconst wrapper = BX.create(\n\t\t\t\"DIV\",\n\t\t\t{attrs: {className: \"crm-entity-stream-section crm-entity-stream-section-completed\"}}\n\t\t);\n\n\t\tif (this.isFixed())\n\t\t\tBX.addClass(wrapper, 'crm-entity-stream-section-top-fixed');\n\n\t\t//region Context Menu\n\t\tif(this.isContextMenuEnabled())\n\t\t{\n\t\t\twrapper.appendChild(this.prepareContextMenuButton());\n\t\t}\n\t\t//endregion\n\n\t\tconst content = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\tconst header = this.prepareHeaderLayout();\n\t\tif(associatedEntityTypeId === BX.CrmEntityType.enumeration.activity)\n\t\t{\n\t\t\tconst entityTypeId = BX.prop.getInteger(entityData, \"TYPE_ID\", 0);\n\t\t\tlet iconClassName = \"crm-entity-stream-section-icon\";\n\t\t\tif(entityTypeId === BX.CrmActivityType.email)\n\t\t\t{\n\t\t\t\ticonClassName += \" crm-entity-stream-section-icon-email\";\n\t\t\t}\n\t\t\telse if(entityTypeId === BX.CrmActivityType.call)\n\t\t\t{\n\t\t\t\ticonClassName += \" crm-entity-stream-section-icon-call\";\n\t\t\t}\n\t\t\telse if(entityTypeId === BX.CrmActivityType.meeting)\n\t\t\t{\n\t\t\t\ticonClassName += \" crm-entity-stream-section-icon-meeting\";\n\t\t\t}\n\t\t\telse if(entityTypeId === BX.CrmActivityType.task)\n\t\t\t{\n\t\t\t\ticonClassName += \" crm-entity-stream-section-icon-task\";\n\t\t\t}\n\t\t\telse if(entityTypeId === BX.CrmActivityType.provider)\n\t\t\t{\n\t\t\t\tconst providerId = BX.prop.getString(entityData, \"PROVIDER_ID\", \"\");\n\t\t\t\tif(providerId === \"CRM_WEBFORM\")\n\t\t\t\t{\n\t\t\t\t\ticonClassName += \" crm-entity-stream-section-icon-crmForm\";\n\t\t\t\t}\n\t\t\t}\n\n\t\t\twrapper.appendChild(BX.create(\"DIV\", { attrs: { className: iconClassName } }));\n\t\t\tcontent.appendChild(header);\n\n\n\t\t\tconst detailWrapper = BX.create(\"DIV\",\n\t\t\t\t{attrs: {className: \"crm-entity-stream-content-detail\"}}\n\t\t\t);\n\t\t\tcontent.appendChild(detailWrapper);\n\n\t\t\tdetailWrapper.appendChild(\n\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-title\" },\n\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tattrs: { href: \"#\" },\n\t\t\t\t\t\t\t\t\t\tevents: { \"click\": this._headerClickHandler },\n\t\t\t\t\t\t\t\t\t\ttext: this.cutOffText(BX.prop.getString(entityData, \"SUBJECT\", \"\"), 128)\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t);\n\n\t\t\tconst summary = this.getTextDataParam(\"SUMMARY\");\n\t\t\tif(summary !== \"\")\n\t\t\t{\n\t\t\t\tdetailWrapper.appendChild(\n\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-description\" },\n\t\t\t\t\t\t\ttext: summary\n\t\t\t\t\t\t}\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t\telse if(associatedEntityTypeId === BX.CrmEntityType.enumeration.order)\n\t\t{\n\t\t\twrapper.appendChild(BX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-info\" } }));\n\t\t\tcontent.appendChild(header);\n\t\t\tcontent.appendChild(\n\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail\" },\n\t\t\t\t\t\ttext: this.cutOffText(this.getTextDataParam(\"MESSAGE\"), 128)\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\t\telse\n\t\t{\n\t\t\twrapper.appendChild(BX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-info\" } }));\n\t\t\tcontent.appendChild(header);\n\n\t\t\tconst innerWrapper = BX.create(\n\t\t\t\t\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail\"}\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tconst associatedEntityTitle = this.cutOffText(BX.prop.getString(entityData, \"TITLE\", \"\"), 128);\n\n\t\t\tif (BX.CrmEntityType.isDefined(associatedEntityTypeId))\n\t\t\t{\n\t\t\t\tlet link = BX.prop.getString(entityData, 'SHOW_URL', '');\n\t\t\t\tif (link.indexOf('/') !== 0)\n\t\t\t\t{\n\t\t\t\t\tlink = '#';\n\t\t\t\t}\n\n\t\t\t\tconst contentTemplate =\n\t\t\t\t\tthis.getMessage('entityContentTemplate')\n\t\t\t\t\t\t.replace('#ENTITY_TYPE_CAPTION#', BX.Text.encode(BX.prop.getString(entityData, 'ENTITY_TYPE_CAPTION', '')))\n\t\t\t\t\t\t.replace('#LINK#', BX.Text.encode(link))\n\t\t\t\t\t\t.replace('#LINK_TITLE#', BX.Text.encode(associatedEntityTitle))\n\t\t\t\t;\n\n\t\t\t\tinnerWrapper.appendChild(\n\t\t\t\t\tBX.create(\n\t\t\t\t\t\t'SPAN',\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\thtml: contentTemplate\n\t\t\t\t\t\t}\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tinnerWrapper.innerText = associatedEntityTitle;\n\t\t\t}\n\n\t\t\tcontent.appendChild(innerWrapper);\n\t\t}\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontent.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-content\" }, children: [ content ] })\n\t\t);\n\n\t\tif (!this.isReadOnly())\n\t\t\twrapper.appendChild(this.prepareFixedSwitcherLayout());\n\n\t\treturn wrapper;\n\t}\n\n\tprepareContextMenuItems()\n\t{\n\t\tconst menuItems = [];\n\n\t\tif (!this.isReadOnly())\n\t\t{\n\t\t\tif (this.isFixed() || this._fixedHistory.findItemById(this._id))\n\t\t\t\tmenuItems.push({ id: \"unfasten\", text: this.getMessage(\"menuUnfasten\"), onclick: BX.delegate(this.unfasten, this)});\n\t\t\telse\n\t\t\t\tmenuItems.push({ id: \"fasten\", text: this.getMessage(\"menuFasten\"), onclick: BX.delegate(this.fasten, this)});\n\t\t}\n\n\t\treturn menuItems;\n\t}\n\n\tview()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst associatedEntityTypeId = this.getAssociatedEntityTypeId();\n\t\tif(associatedEntityTypeId === BX.CrmEntityType.enumeration.activity)\n\t\t{\n\t\t\tconst id = BX.prop.getInteger(entityData, \"ID\", 0);\n\t\t\tif(id > 0)\n\t\t\t{\n\t\t\t\tthis._activityEditor.viewActivity(id);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst showUrl = BX.prop.getString(entityData, \"SHOW_URL\", \"\");\n\t\t\tif(showUrl !== \"\")\n\t\t\t{\n\t\t\t\tBX.Crm.Page.open(showUrl);\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Mark();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n\n\tstatic messages = {};\n}\n","import History from \"./history\";\nimport {EditorMode} from \"../types\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Comment extends History\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._isCollapsed = false;\n\t\tthis._isMenuShown = false;\n\t\tthis._isFixed = false;\n\t\tthis._hasFiles = false;\n\t\tthis._postForm = null;\n\t\tthis._editor = null;\n\t\tthis._commentMessage = '';\n\t\tthis._mode = EditorMode.view;\n\t\tthis._streamContentEventBlock = '';\n\t\tthis._playerWrappers = {};\n\t\tBX.Event.EventEmitter.subscribe(\n\t\t\t\"BX.Disk.Files:onShowFiles\",\n\t\t\tBX.delegate(this.addPlayer, this)\n\t\t);\n\t}\n\n\tdoInitialize()\n\t{\n\t\tsuper.doInitialize();\n\t\tthis._hasFiles = (this.getTextDataParam(\"HAS_FILES\") === 'Y');\n\t}\n\n\tgetTitle()\n\t{\n\t\treturn this.getMessage(\"comment\");\n\t}\n\n\tonPlayerDummyClick(file)\n\t{\n\t\tconst playerWrapper = this._playerWrappers[file.id];\n\t\tconst stubNode = playerWrapper.querySelector(\".crm-audio-cap-wrap\");\n\t\tif (stubNode)\n\t\t{\n\t\t\tBX.addClass(stubNode, \"crm-audio-cap-wrap-loader\");\n\t\t}\n\t\tthis._history.getManager().getAudioPlaybackRateSelector().addPlayer(\n\t\t\tthis._history.getManager().loadMediaPlayer(\n\t\t\t\t\"history_\" + this.getId() + '_' + file.id,\n\t\t\t\tfile.url,\n\t\t\t\t'audio/mp3',\n\t\t\t\tplayerWrapper,\n\t\t\t\tnull,\n\t\t\t\t{\n\t\t\t\t\tplaybackRate: this._history.getManager().getAudioPlaybackRateSelector().getRate()\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t}\n\n\taddPlayer(event)\n\t{\n\t\tif (event.data.entityValueId === parseInt(this.getId(), 10))\n\t\t{\n\t\t\tthis.files = event.data.files;\n\t\t\tevent.data.files.forEach(function(file){\n\t\t\t\tif (file.extension === 'mp3')\n\t\t\t\t{\n\t\t\t\t\tif (this._playerWrappers[file.id])\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tconst callInfoWrapper = BX.create(\"DIV\",\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\t\tclassName: \"crm-entity-stream-content-detail-call crm-entity-stream-content-detail-call-inline\"\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t\tthis._streamContentEventBlock.appendChild(callInfoWrapper);\n\t\t\t\t\tthis._playerWrappers[file.id] = this._history.getManager().renderAudioDummy(\n\t\t\t\t\t\tnull,\n\t\t\t\t\t\tthis.onPlayerDummyClick.bind(this, file)\n\t\t\t\t\t);\n\n\t\t\t\t\tthis._playerWrappers[file.id].firstElementChild.classList.add(\"crm-audio-cap-wrap-without-duration-text\");\n\n\t\t\t\t\tcallInfoWrapper.appendChild(\n\t\t\t\t\t\tthis._playerWrappers[file.id]\n\t\t\t\t\t);\n\t\t\t\t\tcallInfoWrapper.appendChild(\n\t\t\t\t\t\tthis._history.getManager().getAudioPlaybackRateSelector().render()\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}.bind(this));\n\t\t}\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst wrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-section crm-entity-stream-section-history crm-entity-stream-section-comment\"}\n\t\t\t}\n\t\t);\n\n\t\tif (this.isReadOnly())\n\t\t{\n\t\t\tBX.addClass(wrapper, \"crm-entity-stream-section-comment-read-only\");\n\t\t}\n\n\t\tif (this.isFixed())\n\t\t\tBX.addClass(wrapper, 'crm-entity-stream-section-top-fixed');\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{ attrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-comment\" } }\n\t\t\t)\n\t\t);\n\n\t\t//region Context Menu\n\t\tif(this.isContextMenuEnabled())\n\t\t{\n\t\t\twrapper.appendChild(this.prepareContextMenuButton());\n\t\t}\n\t\t//endregion\n\n\t\tthis._streamContentEventBlock = BX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-content-event\" } });\n\t\tconst header = this.prepareHeaderLayout();\n\n\t\tthis._streamContentEventBlock.appendChild(header);\n\n\t\tif (!this.isReadOnly())\n\t\t\twrapper.appendChild(this.prepareFixedSwitcherLayout());\n\n\t\tconst detailChildren = [];\n\t\tif (this._mode !== EditorMode.edit)\n\t\t{\n\t\t\tthis._commentWrapper = BX.create(\"DIV\", {\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-description\" }\n\t\t\t\t}\n\t\t\t);\n\t\t\tBX.html(this._commentWrapper, this.getTextDataParam(\"COMMENT\", \"\"));\n\t\t\tdetailChildren.push(this._commentWrapper);\n\n\t\t\tif (!this.isReadOnly())\n\t\t\t{\n\t\t\t\tBX.bind(this._commentWrapper, \"click\", BX.delegate(this.switchToEditMode, this));\n\t\t\t\tBX.bind(header, \"click\", BX.delegate(this.switchToEditMode, this));\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (!BX.type.isDomNode(this._editorContainer))\n\t\t\t\tthis._editorContainer = BX.create(\"div\", {attrs: {className: \"crm-entity-stream-section-comment-editor\"}});\n\n\t\t\tdetailChildren.push(this._editorContainer);\n\n\t\t\tconst buttons = BX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail-comment-edit-btn-container\"},\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"button\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattrs: {className: \"ui-btn ui-btn-xs ui-btn-primary\"},\n\t\t\t\t\t\t\t\t\thtml: this.getMessage(\"send\"),\n\t\t\t\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\t\t\t\tclick: BX.delegate(this.save, this)\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\tBX.create(\"a\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattrs: {className: \"ui-btn ui-btn-xs ui-btn-link\"},\n\t\t\t\t\t\t\t\t\thtml: this.getMessage(\"cancel\"),\n\t\t\t\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\t\t\t\tclick: BX.delegate(this.switchToViewMode, this)\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tdetailChildren.push(buttons);\n\t\t}\n\n\t\tthis._streamContentEventBlock.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail\" },\n\t\t\t\t\tchildren: detailChildren\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tthis._streamContentEventBlock.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\t\tconst cleanText = this.getTextDataParam(\"TEXT\", \"\");\n\t\tconst _hasInlineAttachment = (this.getTextDataParam(\"HAS_INLINE_ATTACHMENT\", \"\") === 'Y');\n\t\tif ((cleanText.length <= 128 && !_hasInlineAttachment) || this._mode === EditorMode.edit)\n\t\t{\n\t\t\tthis._isCollapsed = false;\n\n\t\t\twrapper.appendChild(\n\t\t\t\tBX.create(\"DIV\", {\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\tclassName: \"crm-entity-stream-section-content\"\n\t\t\t\t\t},\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tthis._streamContentEventBlock\n\t\t\t\t\t]\n\t\t\t\t})\n\t\t\t);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis._isCollapsed = true;\n\n\t\t\twrapper.appendChild(\n\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-content crm-entity-stream-section-content-collapsed\" },\n\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\tthis._streamContentEventBlock\n\t\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t);\n\n\t\t\twrapper.querySelector(\".crm-entity-stream-content-event\").appendChild(\n\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-content-expand-btn-container\" },\n\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tattrs:\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tclassName: \"crm-entity-stream-section-content-expand-btn\",\n\t\t\t\t\t\t\t\t\t\t\t\thref: \"#\"\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\tevents:\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tclick: BX.delegate(this.onExpandButtonClick, this)\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\ttext: this.getMessage(\"expand\")\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\n\t\tif (this._mode === EditorMode.view && this._hasFiles)\n\t\t{\n\t\t\tthis._textLoaded = false;\n\t\t\tthis._fileBlock = BX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-files-inner\" },\n\t\t\t\t\tchildren: [BX.create(\"DIV\", { attrs: { className: \"crm-timeline-wait\" }})]\n\t\t\t\t});\n\t\t\twrapper.querySelector(\".crm-entity-stream-section-content\").appendChild(\n\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-files\" },\n\t\t\t\t\t\tchildren: [this._fileBlock]\n\t\t\t\t\t})\n\t\t\t);\n\t\t\tBX.ready(BX.delegate(function() {\n\t\t\t\twindow.setTimeout(BX.delegate(function(){\n\t\t\t\t\tthis.loadContent(this._fileBlock, \"GET_FILE_BLOCK\")\n\t\t\t\t} ,this), 100);\n\t\t\t},this));\n\t\t}\n\n\t\treturn wrapper;\n\t}\n\n\tprepareActions()\n\t{\n\t\tif (this._mode === EditorMode.view && BX.type.isDomNode(this._commentWrapper))\n\t\t{\n\t\t\tthis.registerImages(this._commentWrapper);\n\t\t\tif (!BX.getClass('BX.Disk.apiVersion'))\n\t\t\t{\n\t\t\t\tBX.viewElementBind(\n\t\t\t\t\tthis._commentWrapper,\n\t\t\t\t\t{showTitle: true},\n\t\t\t\t\tfunction(node){\n\t\t\t\t\t\treturn BX.type.isElementNode(node) && (node.getAttribute('data-bx-viewer') || node.getAttribute('data-bx-image'));\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n\n\tloadContent(node, type)\n\t{\n\t\tif (!BX.type.isDomNode(node))\n\t\t\treturn;\n\n\t\tBX.ajax(\n\t\t\t{\n\t\t\t\turl: this._history._serviceUrl,\n\t\t\t\tmethod: \"POST\",\n\t\t\t\tdataType: \"json\",\n\t\t\t\tdata:\n\t\t\t\t\t{\n\t\t\t\t\t\t\"ACTION\": \"GET_COMMENT_CONTENT\",\n\t\t\t\t\t\t\"ID\": this.getId(),\n\t\t\t\t\t\t\"ENTITY_TYPE_ID\": this.getOwnerTypeId(),\n\t\t\t\t\t\t\"ENTITY_ID\": this.getOwnerId(),\n\t\t\t\t\t\t\"TYPE\": type\n\t\t\t\t\t},\n\t\t\t\tonsuccess: BX.delegate(function(result)\n\t\t\t\t{\n\t\t\t\t\tif (BX.type.isNotEmptyString(result.ERROR) && type === 'GET_FILE_BLOCK')\n\t\t\t\t\t{\n\t\t\t\t\t\tBX.remove(node);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (BX.type.isNotEmptyString(result.BLOCK))\n\t\t\t\t\t{\n\t\t\t\t\t\tconst promise = BX.html(node, result.BLOCK);\n\t\t\t\t\t\tpromise.then(\n\t\t\t\t\t\t\tBX.delegate(function(){\n\t\t\t\t\t\t\t\tthis.registerImages(node);\n\t\t\t\t\t\t\t\tBX.LazyLoad.showImages();\n\t\t\t\t\t\t\t}, this)\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}, this)\n\t\t\t}\n\t\t);\n\t}\n\n\tloadEditor()\n\t{\n\t\tthis._editorName = 'CrmTimeLineComment'+this._id + BX.util.getRandomString(4);\n\t\tif (this._postForm)\n\t\t{\n\t\t\tthis._postForm.oEditor.SetContent(this._commentMessage);\n\t\t\tthis._editor.ReInitIframe();\n\t\t\treturn;\n\t\t}\n\n\t\tconst actionData = {\n\t\t\tdata: {\n\t\t\t\tid: this._id,\n\t\t\t\tname: this._editorName\n\t\t\t}\n\t\t};\n\t\tBX.ajax.runAction(\"crm.api.timeline.loadEditor\", actionData)\n\t\t\t.then(this.onLoadEditorSuccess.bind(this))\n\t\t\t.catch(\tthis.switchToViewMode.bind(this));\n\t}\n\n\tonLoadEditorSuccess(result)\n\t{\n\t\tif (!BX.type.isDomNode(this._editorContainer))\n\t\t\tthis._editorContainer = BX.create(\"div\", {attrs: {className: \"crm-entity-stream-section-comment-editor\"}});\n\n\t\tconst html = BX.prop.getString(BX.prop.getObject(result, \"data\", {}), \"html\", '');\n\t\tBX.html(this._editorContainer, html).then(BX.delegate(this.showEditor,this));\n\t}\n\n\tshowEditor()\n\t{\n\t\tif (LHEPostForm)\n\t\t{\n\t\t\twindow.setTimeout(BX.delegate(function(){\n\t\t\t\tthis._postForm = LHEPostForm.getHandler(this._editorName);\n\t\t\t\tthis._editor = BXHtmlEditor.Get(this._editorName);\n\t\t\t\tBX.onCustomEvent(this._postForm.eventNode, 'OnShowLHE', [true]);\n\t\t\t\tthis._commentMessage = this._postForm.oEditor.GetContent();\n\t\t\t} ,this), 0);\n\t\t}\n\t}\n\n\tregisterImages(node)\n\t{\n\t\tconst commentImages = node.querySelectorAll('[data-bx-viewer=\"image\"]');\n\t\tconst commentImagesLength = commentImages.length;\n\t\tconst idsList = [];\n\t\tif (commentImagesLength > 0)\n\t\t{\n\t\t\tfor (let i = 0; i < commentImagesLength; ++i)\n\t\t\t{\n\t\t\t\tif (BX.type.isDomNode(commentImages[i]))\n\t\t\t\t{\n\t\t\t\t\tcommentImages[i].id += BX.util.getRandomString(4);\n\t\t\t\t\tidsList.push(commentImages[i].id);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (idsList.length > 0)\n\t\t\t{\n\t\t\t\tBX.LazyLoad.registerImages(idsList);\n\t\t\t}\n\t\t}\n\t\tBX.LazyLoad.registerImages(idsList);\n\t}\n\n\ttoggleMode(type)\n\t{\n\t\tthis._mode = parseInt(type);\n\t\tthis._hasFiles = (this.getTextDataParam(\"HAS_FILES\") === 'Y');\n\t\tthis.refreshLayout();\n\t\tthis.closeContextMenu();\n\t}\n\n\tswitchToViewMode(e)\n\t{\n\t\t// if (LHEPostForm)\n\t\t// \tLHEPostForm.unsetHandler(this._editorName);\n\t\tthis.toggleMode(EditorMode.view);\n\t}\n\n\tswitchToEditMode(e)\n\t{\n\t\tconst tagName = e.target.tagName.toLowerCase();\n\t\tif (tagName === 'a'\n\t\t\t|| tagName === 'img'\n\t\t\t|| BX.hasClass(e.target, \"feed-con-file-changes-link-more\")\n\t\t\t|| BX.hasClass(e.target, \"feed-com-file-inline\")\n\t\t\t|| BX.type.isNotEmptyString(document.getSelection().toString())\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.toggleMode(EditorMode.edit);\n\t\twindow.setTimeout(BX.delegate(function(){\n\t\t\tthis.loadEditor();\n\t\t} ,this), 100);\n\t}\n\n\tprepareContextMenuItems()\n\t{\n\t\tif(this._isMenuShown)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst menuItems = [];\n\n\t\tif (!this.isReadOnly())\n\t\t{\n\t\t\tif (this._mode !== EditorMode.edit)\n\t\t\t{\n\t\t\t\tmenuItems.push({ id: \"edit\", text: this.getMessage(\"menuEdit\"), onclick: BX.delegate(this.switchToEditMode, this)});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tmenuItems.push({ id: \"cancel\", text: this.getMessage(\"menuCancel\"), onclick: BX.delegate(this.switchToViewMode, this)});\n\t\t\t}\n\n\t\t\tmenuItems.push({ id: \"remove\", text: this.getMessage(\"menuDelete\"), onclick: BX.delegate(this.processRemoval, this)});\n\n\t\t\tif (this.isFixed() || this._fixedHistory.findItemById(this._id))\n\t\t\t\tmenuItems.push({ id: \"unfasten\", text: this.getMessage(\"menuUnfasten\"), onclick: BX.delegate(this.unfasten, this)});\n\t\t\telse\n\t\t\t\tmenuItems.push({ id: \"fasten\", text: this.getMessage(\"menuFasten\"), onclick: BX.delegate(this.fasten, this)});\n\t\t}\n\n\t\treturn menuItems;\n\t}\n\n\tsave(e)\n\t{\n\t\tconst attachmentList = [];\n\t\tlet text = \"\";\n\t\tif (this._postForm)\n\t\t{\n\t\t\ttext = this._postForm.oEditor.GetContent();\n\t\t\tthis._commentMessage = text;\n\t\t\tthis._postForm.eventNode\n\t\t\t\t.querySelectorAll('input[name=\"UF_CRM_COMMENT_FILES[]\"]')\n\t\t\t\t.forEach(function(input) {\n\t\t\t\t\tattachmentList.push(input.value)\n\t\t\t\t});\n\t\t}\n\n\t\tif (!BX.type.isNotEmptyString(text))\n\t\t{\n\t\t\tif (!this.emptyCommentMessage)\n\t\t\t{\n\t\t\t\tthis.emptyCommentMessage = new BX.PopupWindow(\n\t\t\t\t\t'timeline_empty_comment_' + this._id,\n\t\t\t\t\te.target,\n\t\t\t\t\t{\n\t\t\t\t\t\tcontent: BX.message('CRM_TIMELINE_EMPTY_COMMENT_MESSAGE'),\n\t\t\t\t\t\tdarkMode: true,\n\t\t\t\t\t\tautoHide: true,\n\t\t\t\t\t\tzIndex: 990,\n\t\t\t\t\t\tangle: {position: 'top', offset: 77},\n\t\t\t\t\t\tcloseByEsc: true,\n\t\t\t\t\t\tbindOptions: { forceBindPosition: true}\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tthis.emptyCommentMessage.show();\n\t\t\treturn;\n\t\t}\n\n\t\tif(this._isRequestRunning && BX.type.isNotEmptyString(text))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis._isRequestRunning = true;\n\t\tBX.ajax(\n\t\t\t{\n\t\t\t\turl: this._history._serviceUrl,\n\t\t\t\tmethod: \"POST\",\n\t\t\t\tdataType: \"json\",\n\t\t\t\tdata:\n\t\t\t\t\t{\n\t\t\t\t\t\t\"ACTION\": \"UPDATE_COMMENT\",\n\t\t\t\t\t\t\"ID\": this.getId(),\n\t\t\t\t\t\t\"TEXT\": text,\n\t\t\t\t\t\t\"OWNER_TYPE_ID\":  this.getOwnerTypeId(),\n\t\t\t\t\t\t\"OWNER_ID\": this.getOwnerId(),\n\t\t\t\t\t\t\"ATTACHMENTS\": attachmentList\n\t\t\t\t\t},\n\t\t\t\tonsuccess: BX.delegate(this.onSaveSuccess, this),\n\t\t\t\tonfailure: BX.delegate(this.onRequestFailure, this)\n\t\t\t}\n\t\t);\n\t}\n\n\tprocessRemoval()\n\t{\n\t\tthis.closeContextMenu();\n\t\tthis._detetionConfirmDlgId = \"entity_timeline_deletion_\" + this.getId() + \"_confirm\";\n\t\tlet dlg = BX.Crm.ConfirmationDialog.get(this._detetionConfirmDlgId);\n\t\tif(!dlg)\n\t\t{\n\t\t\tdlg = BX.Crm.ConfirmationDialog.create(\n\t\t\t\tthis._detetionConfirmDlgId,\n\t\t\t\t{\n\t\t\t\t\ttitle: this.getMessage(\"removeConfirmTitle\"),\n\t\t\t\t\tcontent: this.getMessage('commentRemove')\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\tdlg.open().then(BX.delegate(this.onRemovalConfirm, this), BX.delegate(this.onRemovalCancel, this));\n\t}\n\n\tonRemovalConfirm(result)\n\t{\n\t\tif(BX.prop.getBoolean(result, \"cancel\", true))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.remove();\n\t}\n\n\tonRemovalCancel()\n\t{\n\t}\n\n\tremove(e)\n\t{\n\t\tif(this._isRequestRunning)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst history = this._history._manager.getHistory();\n\t\tconst deleteItem = history.findItemById(this._id);\n\t\tif (deleteItem instanceof Comment)\n\t\t\tdeleteItem.clearAnimate();\n\n\t\tconst fixedHistory = this._history._manager.getFixedHistory();\n\t\tconst deleteFixedItem = fixedHistory.findItemById(this._id);\n\t\tif (deleteFixedItem instanceof Comment)\n\t\t\tdeleteFixedItem.clearAnimate();\n\n\t\tthis._isRequestRunning = true;\n\t\tBX.ajax(\n\t\t\t{\n\t\t\t\turl: this._history._serviceUrl,\n\t\t\t\tmethod: \"POST\",\n\t\t\t\tdataType: \"json\",\n\t\t\t\tdata:\n\t\t\t\t\t{\n\t\t\t\t\t\t\"ACTION\": \"DELETE_COMMENT\",\n\t\t\t\t\t\t\"OWNER_TYPE_ID\":  this.getOwnerTypeId(),\n\t\t\t\t\t\t\"OWNER_ID\": this.getOwnerId(),\n\t\t\t\t\t\t\"ID\": this.getId()\n\t\t\t\t\t},\n\t\t\t\tonsuccess: BX.delegate(this.onRemoveSuccess, this),\n\t\t\t\tonfailure: BX.delegate(this.onRequestFailure, this)\n\t\t\t}\n\t\t);\n\t}\n\n\trefreshLayout()\n\t{\n\t\tthis._playerWrappers = {};\n\t\tsuper.refreshLayout();\n\t}\n\n\tonSaveSuccess(data)\n\t{\n\t\tthis._isRequestRunning = false;\n\t\tconst itemData = BX.prop.getObject(data, \"HISTORY_ITEM\");\n\n\t\tconst updateFixedItem = this._fixedHistory.findItemById(this._id);\n\t\tif (updateFixedItem instanceof Comment)\n\t\t{\n\t\t\tif (!BX.type.isNotEmptyString(itemData['IS_FIXED']))\n\t\t\t\titemData['IS_FIXED'] = 'Y';\n\n\t\t\tupdateFixedItem.setData(itemData);\n\t\t\tupdateFixedItem._id = BX.prop.getString(itemData, \"ID\");\n\t\t\tupdateFixedItem.switchToViewMode();\n\t\t}\n\n\t\tconst updateItem = this._history.findItemById(this._id);\n\t\tif (updateItem instanceof Comment)\n\t\t{\n\t\t\tupdateItem.setData(itemData);\n\t\t\tupdateItem._id = BX.prop.getString(itemData, \"ID\");\n\t\t\tupdateItem.switchToViewMode();\n\t\t}\n\n\t\tthis._postForm = null;\n\t}\n\n\tonRemoveSuccess(data)\n\t{\n\t}\n\n\tonRequestFailure(data)\n\t{\n\t\tthis._isRequestRunning = this._isLocked = false;\n\t}\n\n\tonExpandButtonClick(e)\n\t{\n\t\tif(!this._wrapper)\n\t\t{\n\t\t\treturn BX.PreventDefault(e);\n\t\t}\n\n\t\tconst contentWrapper = this._wrapper.querySelector(\"div.crm-entity-stream-section-content\");\n\t\tif(!contentWrapper)\n\t\t{\n\t\t\treturn BX.PreventDefault(e);\n\t\t}\n\n\t\tif (this._hasFiles && BX.type.isDomNode(this._commentWrapper) && !this._textLoaded)\n\t\t{\n\t\t\tthis._textLoaded = true;\n\t\t\tthis.loadContent(this._commentWrapper, \"GET_TEXT\")\n\t\t}\n\t\tconst eventWrapper = contentWrapper.querySelector(\".crm-entity-stream-content-event\");\n\t\tif(this._isCollapsed)\n\t\t{\n\t\t\teventWrapper.style.maxHeight = eventWrapper.scrollHeight + 130 + \"px\";\n\t\t\tBX.removeClass(contentWrapper, \"crm-entity-stream-section-content-collapsed\");\n\t\t\tBX.addClass(contentWrapper, \"crm-entity-stream-section-content-expand\");\n\t\t\tsetTimeout(\n\t\t\t\tBX.delegate(function() {\n\t\t\t\t\teventWrapper.style.maxHeight = \"\";\n\t\t\t\t}, this),\n\t\t\t\t300\n\t\t\t);\n\t\t}\n\t\telse\n\t\t{\n\t\t\teventWrapper.style.maxHeight = eventWrapper.clientHeight + \"px\";\n\t\t\tBX.removeClass(contentWrapper, \"crm-entity-stream-section-content-expand\");\n\t\t\tBX.addClass(contentWrapper, \"crm-entity-stream-section-content-collapsed\");\n\t\t\tsetTimeout(\n\t\t\t\tBX.delegate(function() {\n\t\t\t\t\teventWrapper.style.maxHeight = \"\";\n\t\t\t\t}, this),\n\t\t\t\t0\n\t\t\t);\n\t\t}\n\n\t\tthis._isCollapsed = !this._isCollapsed;\n\n\t\tconst button = contentWrapper.querySelector(\"a.crm-entity-stream-section-content-expand-btn\");\n\t\tif(button)\n\t\t{\n\t\t\tbutton.innerHTML = this.getMessage(this._isCollapsed ? \"expand\" : \"collapse\");\n\t\t}\n\t\treturn BX.PreventDefault(e);\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Comment();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import HistoryActivity from \"./history-activity\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Wait extends HistoryActivity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetTitle()\n\t{\n\t\treturn this.getMessage(\"wait\");\n\t}\n\n\tprepareTitleLayout()\n\t{\n\t\treturn BX.create(\"SPAN\", {\n\t\t\tattrs:{ className: \"crm-entity-stream-content-event-title\"},\n\t\t\tchildren: [\n\t\t\t\tBX.create(\"A\", {\n\t\t\t\t\tattrs: { href: \"#\" },\n\t\t\t\t\tevents: { \"click\": this._headerClickHandler },\n\t\t\t\t\ttext: this.getTitle()\n\t\t\t\t})\n\t\t\t]\n\t\t});\n\n\n\t}\n\n\tprepareTimeLayout()\n\t{\n\t\treturn BX.create(\"SPAN\",\n\t\t\t{\n\t\t\t\tattrs: { className: \"crm-entity-stream-content-event-time\" },\n\t\t\t\ttext: this.formatTime(this.getCreatedTime())\n\t\t\t}\n\t\t);\n\t}\n\n\tprepareHeaderLayout()\n\t{\n\t\tconst header = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-header\"}});\n\t\theader.appendChild(this.prepareTitleLayout());\n\t\theader.appendChild(this.prepareTimeLayout());\n\n\t\treturn header;\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tlet description = BX.prop.getString(entityData, \"DESCRIPTION_RAW\", \"\");\n\t\tif(description !== \"\")\n\t\t{\n\t\t\tdescription = BX.util.trim(description);\n\t\t\tdescription = BX.util.strip_tags(description);\n\t\t\tdescription = BX.util.nl2br(description);\n\t\t}\n\n\t\tconst wrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-section crm-entity-stream-section-history crm-entity-stream-section-wait\"}\n\t\t\t}\n\t\t);\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-complete\" }\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst contentWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\tchildren: [contentWrapper]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst header = this.prepareHeaderLayout();\n\t\tcontentWrapper.appendChild(header);\n\n\t\tconst detailWrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail\"},\n\t\t\t\thtml: description\n\t\t\t}\n\t\t);\n\t\tcontentWrapper.appendChild(detailWrapper);\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontentWrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\t//region  Actions\n\t\tthis._actionContainer = BX.create(\"SPAN\", { attrs: { className: \"crm-entity-stream-content-detail-action\" } });\n\t\tcontentWrapper.appendChild(this._actionContainer);\n\t\t//endregion\n\n\t\treturn wrapper;\n\t}\n\n\tprepareActions()\n\t{\n\t}\n\n\tshowActions(show)\n\t{\n\t\tif(this._actionContainer)\n\t\t{\n\t\t\tthis._actionContainer.style.display = show ? \"\" : \"none\";\n\t\t}\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Wait();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import HistoryActivity from \"./history-activity\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Sender extends HistoryActivity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetDataSetting(name)\n\t{\n\t\tconst settings = this.getObjectDataParam('SETTINGS') || {};\n\t\treturn settings[name] || null;\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = Sender.messages;\n\t\treturn m.hasOwnProperty(name) ? m[name] : name;\n\t}\n\n\tgetTitle()\n\t{\n\t\treturn this.getDataSetting('messageName');\n\t}\n\n\tprepareTitleLayout()\n\t{\n\t\tconst self = this;\n\t\treturn BX.create(\"SPAN\", {\n\t\t\tattrs:{ className: \"crm-entity-stream-content-event-title\"},\n\t\t\tchildren: [\n\t\t\t\tthis.isRemoved()\n\t\t\t\t\t?\n\t\t\t\t\tBX.create(\"SPAN\", {text: this.getTitle()})\n\t\t\t\t\t:\n\t\t\t\t\tBX.create(\"A\", {\n\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\thref: \"\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\t\"click\": function (e)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tif (BX.SidePanel)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tBX.SidePanel.Instance.open(self.getDataSetting('path'));\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\ttop.location.href = self.getDataSetting('path');\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\ttext: this.getTitle()\n\t\t\t\t\t})\n\t\t\t]\n\t\t});\n\n\n\t}\n\n\tprepareTimeLayout()\n\t{\n\t\treturn BX.create(\"SPAN\",\n\t\t\t{\n\t\t\t\tattrs: { className: \"crm-entity-stream-content-event-time\" },\n\t\t\t\ttext: this.formatTime(this.getCreatedTime())\n\t\t\t}\n\t\t);\n\t}\n\n\tprepareStatusLayout()\n\t{\n\t\tlet layoutClassName, textCaption;\n\t\tif (this.getDataSetting('isError'))\n\t\t{\n\t\t\ttextCaption = this.getMessage('error');\n\t\t\tlayoutClassName = \"crm-entity-stream-content-event-missing\";\n\t\t}\n\t\telse if (this.getDataSetting('isUnsub'))\n\t\t{\n\t\t\ttextCaption = this.getMessage('unsub');\n\t\t\tlayoutClassName = \"crm-entity-stream-content-event-missing\";\n\t\t}\n\t\telse if (this.getDataSetting('isClick'))\n\t\t{\n\t\t\ttextCaption = this.getMessage('click');\n\t\t\tlayoutClassName = \"crm-entity-stream-content-event-successful\";\n\t\t}\n\t\telse\n\t\t{\n\t\t\ttextCaption = this.getMessage('read');\n\t\t\tlayoutClassName = \"crm-entity-stream-content-event-skipped\";\n\t\t}\n\n\t\treturn BX.create(\"SPAN\", {attrs: {className: layoutClassName}, text: textCaption});\n\t}\n\n\tprepareHeaderLayout()\n\t{\n\t\tconst header = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-header\"}});\n\t\theader.appendChild(this.prepareTitleLayout());\n\t\tif (this.getDataSetting('isError') || this.getDataSetting('isRead') || this.getDataSetting('isUnsub'))\n\t\t{\n\t\t\theader.appendChild(this.prepareStatusLayout());\n\t\t}\n\t\theader.appendChild(this.prepareTimeLayout());\n\n\t\treturn header;\n\t}\n\n\tisRemoved()\n\t{\n\t\treturn !this.getDataSetting('letterTitle');\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst description = this.isRemoved() ? this.getMessage('removed') : this.getMessage('title') + ': ' + this.getDataSetting('letterTitle');\n\n\t\tconst wrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-section crm-entity-stream-section-history crm-entity-stream-section-wait\"}\n\t\t\t}\n\t\t);\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-complete\" }\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst contentWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\tchildren: [contentWrapper]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst header = this.prepareHeaderLayout();\n\t\tcontentWrapper.appendChild(header);\n\n\t\tconst detailWrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail\"},\n\t\t\t\thtml: description\n\t\t\t}\n\t\t);\n\t\tcontentWrapper.appendChild(detailWrapper);\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontentWrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\treturn wrapper;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Sender();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import History from \"./history\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Bizproc extends History\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetTitle()\n\t{\n\t\tconst type = this.getTextDataParam(\"TYPE\");\n\t\tif (type === 'AUTOMATION_DEBUG_INFORMATION')\n\t\t{\n\t\t\treturn this.getMessage('automationDebugger');\n\t\t}\n\n\t\treturn this.getMessage(\"bizproc\");\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst wrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-section crm-entity-stream-section-history crm-entity-stream-section-bp\"}\n\t\t\t}\n\t\t);\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{ attrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-bp\" } }\n\t\t\t)\n\t\t);\n\n\t\tconst content = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\tconst header = this.prepareHeaderLayout();\n\n\t\tcontent.appendChild(header);\n\t\tcontent.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail\" },\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-description\" },\n\t\t\t\t\t\t\t\t\thtml: this.prepareContentTextHtml()\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontent.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-content\" }, children: [ content ] })\n\t\t);\n\n\t\treturn wrapper;\n\t}\n\n\tprepareContentTextHtml()\n\t{\n\t\tconst type = this.getTextDataParam(\"TYPE\");\n\t\tif (type === 'ACTIVITY_ERROR')\n\t\t{\n\t\t\treturn '<strong>#TITLE#</strong>: #ERROR_TEXT#'\n\t\t\t\t.replace('#TITLE#', BX.util.htmlspecialchars(this.getTextDataParam(\"ACTIVITY_TITLE\")))\n\t\t\t\t.replace('#ERROR_TEXT#', BX.util.htmlspecialchars(this.getTextDataParam(\"ERROR_TEXT\")))\n\t\t}\n\t\telse if (type === 'AUTOMATION_DEBUG_INFORMATION')\n\t\t{\n\t\t\treturn BX.Text.encode(this.getTextDataParam('AUTOMATION_DEBUG_TEXT'));\n\t\t}\n\n\t\tconst workflowName = this.getTextDataParam(\"WORKFLOW_TEMPLATE_NAME\");\n\t\tconst workflowStatus = this.getTextDataParam(\"WORKFLOW_STATUS_NAME\");\n\t\tif (!workflowName\n\t\t\t|| workflowStatus !== 'Created' && workflowStatus !== 'Completed' && workflowStatus !== 'Terminated'\n\t\t)\n\t\t{\n\t\t\treturn BX.util.htmlspecialchars(this.getTextDataParam(\"COMMENT\"));\n\t\t}\n\n\t\tlet label = BX.message('CRM_TIMELINE_BIZPROC_CREATED');\n\t\tif (workflowStatus === 'Completed')\n\t\t{\n\t\t\tlabel = BX.message('CRM_TIMELINE_BIZPROC_COMPLETED');\n\t\t}\n\t\telse if (workflowStatus === 'Terminated')\n\t\t{\n\t\t\tlabel = BX.message('CRM_TIMELINE_BIZPROC_TERMINATED');\n\t\t}\n\n\t\treturn BX.util.htmlspecialchars(label)\n\t\t\t.replace('#NAME#', '<strong>' + BX.util.htmlspecialchars(workflowName) + '</strong>');\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Bizproc();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import History from \"./history\";\n\n/** @memberof BX.Crm.Timeline.Actions */\nexport default class Scoring extends History\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst outerWrapper = BX.create(\"DIV\", {\n\t\t\tattrs: {\n\t\t\t\tclassName: \"crm-entity-stream-section crm-entity-stream-section-history crm-entity-stream-section-scoring\"\n\t\t\t},\n\t\t\tevents: {\n\t\t\t\tclick: function () {\n\t\t\t\t\tlet url = \"/crm/ml/#entity#/#id#/detail\";\n\t\t\t\t\tconst ownerTypeId = this.getOwnerTypeId();\n\t\t\t\t\tconst ownerId = this.getOwnerId();\n\n\t\t\t\t\tlet ownerType;\n\t\t\t\t\tif (ownerTypeId === 1)\n\t\t\t\t\t{\n\t\t\t\t\t\townerType = \"lead\";\n\t\t\t\t\t}\n\t\t\t\t\telse if (ownerTypeId === 2)\n\t\t\t\t\t{\n\t\t\t\t\t\townerType = \"deal\";\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\turl = url.replace(\"#entity#\", ownerType);\n\t\t\t\t\turl = url.replace(\"#id#\", ownerId);\n\n\t\t\t\t\tif (BX.SidePanel)\n\t\t\t\t\t{\n\t\t\t\t\t\tBX.SidePanel.Instance.open(url, {width: 840});\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\ttop.location.href = url;\n\t\t\t\t\t}\n\t\t\t\t}.bind(this)\n\t\t\t}\n\t\t});\n\n\t\tconst scoringInfo = BX.prop.getObject(this._data, \"SCORING_INFO\", null);\n\t\tif(!scoringInfo)\n\t\t{\n\t\t\treturn outerWrapper;\n\t\t}\n\n\t\tlet score = BX.prop.getNumber(scoringInfo, \"SCORE\", 0);\n\t\tlet scoreDelta = BX.prop.getNumber(scoringInfo, \"SCORE_DELTA\", 0);\n\t\tscore = Math.round(score * 100);\n\t\tscoreDelta = Math.round(scoreDelta * 100);\n\n\t\tconst result = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-scoring-total-result\"},\n\t\t\t\ttext: score + \"%\"\n\t\t\t});\n\n\t\tlet iconClass = \"crm-entity-stream-content-scoring-total-icon\";\n\t\tif (score < 50)\n\t\t{\n\t\t\ticonClass += \" crm-entity-stream-content-scoring-total-icon-fail\";\n\t\t}\n\t\telse if (score < 75)\n\t\t{\n\t\t\ticonClass += \" crm-entity-stream-content-scoring-total-icon-middle\";\n\t\t}\n\t\telse\n\t\t{\n\t\t\ticonClass += \" crm-entity-stream-content-scoring-total-icon-success\";\n\t\t}\n\n\t\tconst icon = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: iconClass}\n\t\t\t}\n\t\t);\n\n\t\touterWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-scoring-total\" },\n\t\t\t\t\t\t\t\tchildren: [\n\t\t\t\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-scoring-total-text\" },\n\t\t\t\t\t\t\t\t\t\t\ttext: BX.message(\"CRM_TIMELINE_SCORING_TITLE_2\")\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t\tresult,\n\t\t\t\t\t\t\t\t\ticon\n\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t),\n\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-scoring-event\" },\n\t\t\t\t\t\t\t\tchildren: [\n\t\t\t\t\t\t\t\t\t(\n\t\t\t\t\t\t\t\t\t\tscoreDelta !== 0 ?\n\t\t\t\t\t\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-scoring-event-offset\" },\n\t\t\t\t\t\t\t\t\t\t\t\t\ttext: (scoreDelta > 0 ? \"+\" : \"\") + scoreDelta + \"%\"\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t:\n\t\t\t\t\t\t\t\t\t\t\tnull\n\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t\t/*BX.create(\"DIV\",\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-scoring-event-detail\" },\n\t\t\t\t\t\t\t\t\t\t\ttext: \"<activity subject>\"\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t)*/\n\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t)\n\t\t\t\t\t]\n\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\treturn outerWrapper;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Scoring();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","/** @memberof BX.Crm.Timeline.Animation */\nexport default class Expand\n{\n\tconstructor()\n\t{\n\t\tthis._node = null;\n\t\tthis._callback = null;\n\t}\n\n\tinitialize(node, callback)\n\t{\n\t\tthis._node = node;\n\t\tthis._callback = BX.type.isFunction(callback) ? callback : null;\n\t}\n\n\trun()\n\t{\n\t\tconst position = BX.pos(this._node);\n\n\t\tthis._node.style.height = 0;\n\t\tthis._node.style.opacity = 0;\n\t\tthis._node.style.overflow = \"hidden\";\n\n\t\t(new BX.easing(\n\t\t\t\t{\n\t\t\t\t\tduration : 150,\n\t\t\t\t\tstart : { height: 0 },\n\t\t\t\t\tfinish: { height: position.height },\n\t\t\t\t\ttransition : BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\t\t\tstep: BX.delegate(this.onNodeHeightStep, this),\n\t\t\t\t\tcomplete: BX.delegate(this.onNodeHeightComplete, this)\n\t\t\t\t}\n\t\t\t)\n\t\t).animate();\n\t}\n\n\tonNodeHeightStep(state)\n\t{\n\t\tthis._node.style.height = state.height + \"px\";\n\t}\n\n\tonNodeHeightComplete()\n\t{\n\t\tthis._node.style.overflow = \"\";\n\t\t(new BX.easing(\n\t\t\t\t{\n\t\t\t\t\tduration : 150,\n\t\t\t\t\tstart : { opacity: 0 },\n\t\t\t\t\tfinish: { opacity: 100 },\n\t\t\t\t\ttransition : BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\t\t\tstep: BX.delegate(this.onNodeOpacityStep, this),\n\t\t\t\t\tcomplete: BX.delegate(this.onNodeOpacityComplete, this)\n\t\t\t\t}\n\t\t\t)\n\t\t).animate();\n\t}\n\n\tonNodeOpacityStep(state)\n\t{\n\t\tthis._node.style.opacity = state.opacity / 100;\n\t}\n\n\tonNodeOpacityComplete()\n\t{\n\t\tthis._node.style.height = \"\";\n\t\tthis._node.style.opacity = \"\";\n\t\tif(this._callback)\n\t\t{\n\t\t\tthis._callback();\n\t\t}\n\t}\n\n\tstatic create(node, callback)\n\t{\n\t\tconst self = new Expand();\n\t\tself.initialize(node, callback);\n\t\treturn self;\n\t}\n}\n","import Stream from \"../stream\";\nimport {Item as ItemType, Order as OrderType, Delivery as DeliveryType, Compilation as CompilationType} from \"../types\";\nimport HistoryItem from \"../items/history\";\nimport Modification from \"../items/modification\";\nimport Conversion from \"../items/conversion\";\nimport HistoryActivity from \"../items/history-activity\";\nimport Email from \"../items/email\";\nimport Call from \"../items/call\";\nimport Meeting from \"../items/meeting\";\nimport Task from \"../items/task\";\nimport WebForm from \"../items/webform\";\nimport Sms from \"../items/sms\";\nimport Request from \"../items/request\";\nimport OpenLine from \"../items/openline\";\nimport Rest from \"../items/rest\";\nimport Visit from \"../items/visit\";\nimport Zoom from \"../items/zoom\";\nimport OrderCreation from \"../items/order-creation\";\nimport OrderModification from \"../items/order-modification\";\nimport StoreDocumentCreation from \"../items/store-document-creation\";\nimport StoreDocumentModification from \"../items/store-document-modification\";\nimport ExternalNoticeStatusModification from \"../items/external-notice-status-modification\";\nimport ExternalNoticeModification from \"../items/external-notice-modification\";\nimport OrderCheck from \"../items/order-check\";\nimport FinalSummary from \"../items/final-summary\";\nimport FinalSummaryDocuments from \"../items/final-summary-documents\";\nimport Creation from \"../items/creation\";\nimport Restoration from \"../items/restoration\";\nimport Link from \"../items/link\";\nimport Unlink from \"../items/unlink\";\nimport Mark from \"../items/mark\";\nimport Comment from \"../items/comment\";\nimport Wait from \"../items/wait\";\nimport Document from \"../items/document\";\nimport Sender from \"../items/sender\";\nimport Bizproc from \"../items/bizproc\";\nimport Scoring from \"../items/scoring\";\nimport {ConfigurableItem, StreamType} from \"crm.timeline.item\";\nimport Expand from \"../animations/expand\";\n\n/** @memberof BX.Crm.Timeline.Streams */\nexport default class History extends Stream\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._items = [];\n\t\tthis._wrapper = null;\n\t\tthis._fixedHistory = null;\n\t\tthis._emptySection = null;\n\t\tthis._currentDaySection = null;\n\t\tthis._lastDaySection = null;\n\t\tthis._lastDate = null;\n\t\tthis._anchor = null;\n\t\tthis._history = this;\n\t\tthis._enableLoading = false;\n\t\tthis._navigation = null;\n\t\tthis._scrollHandler = null;\n\t\tthis._loadingWaiter = null;\n\n\t\tthis._filterId = \"\";\n\t\tthis._isFilterApplied = false;\n\t\tthis._isFilterShown = false;\n\n\t\tthis._isRequestRunning = false;\n\n\t\tthis._filterButton = null;\n\t\tthis._filterWrapper = null;\n\t\tthis._filterResultStub = null;\n\t}\n\n\tdoInitialize()\n\t{\n\t\tthis._fixedHistory = this.getSetting(\"fixedHistory\");\n\t\tthis._ownerTypeId = this.getSetting(\"ownerTypeId\");\n\t\tthis._ownerId = this.getSetting(\"ownerId\");\n\t\tthis._serviceUrl = this.getSetting(\"serviceUrl\", \"\");\n\t\tif (!this.isStubMode())\n\t\t{\n\t\t\tlet itemData = this.getSetting(\"itemData\");\n\t\t\tif (!BX.type.isArray(itemData))\n\t\t\t{\n\t\t\t\titemData = [];\n\t\t\t}\n\n\t\t\tlet i, length, item;\n\t\t\tfor (i = 0, length = itemData.length; i < length; i++)\n\t\t\t{\n\t\t\t\titem = this.createItem(itemData[i]);\n\t\t\t\tif (item)\n\t\t\t\t{\n\t\t\t\t\tthis._items.push(item);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis._navigation = this.getSetting(\"navigation\", {});\n\n\t\t\tthis._filterWrapper = BX(\"timeline-filter\");\n\t\t\tthis._filterId = BX.prop.getString(this._settings, \"filterId\", this._id);\n\t\t\tthis._isFilterShown = this._filterWrapper\n\t\t\t\t&& BX.hasClass(this._filterWrapper, \"crm-entity-stream-section-filter-show\");\n\t\t\tthis._isFilterApplied = BX.prop.getBoolean(this._settings, \"isFilterApplied\", false);\n\n\t\t\tBX.addCustomEvent(\"BX.Main.Filter:apply\", this.onFilterApply.bind(this));\n\t\t}\n\t}\n\n\tlayout()\n\t{\n\t\tthis._wrapper = BX.create(\"DIV\", {});\n\t\tthis._container.appendChild(this._wrapper);\n\n\t\tconst now = BX.prop.extractDate(new Date());\n\t\tlet i, length, item;\n\n\t\tif (!this.isStubMode())\n\t\t{\n\t\t\tif (this._filterWrapper)\n\t\t\t{\n\t\t\t\tconst closeFilterButton = this._filterWrapper.querySelector(\".crm-entity-stream-filter-close\");\n\t\t\t\tif (closeFilterButton)\n\t\t\t\t{\n\t\t\t\t\tBX.bind(closeFilterButton, \"click\", this.onFilterClose.bind(this));\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfor (i = 0, length = this._items.length; i < length; i++)\n\t\t\t{\n\t\t\t\titem = this._items[i];\n\t\t\t\titem.setContainer(this._wrapper);\n\n\t\t\t\tconst created = item.getCreatedDate();\n\t\t\t\tif (this._lastDate === null || this._lastDate.getTime() !== created.getTime())\n\t\t\t\t{\n\t\t\t\t\tthis._lastDate = created;\n\t\t\t\t\tif (now.getTime() === created.getTime())\n\t\t\t\t\t{\n\t\t\t\t\t\tthis._currentDaySection = this._lastDaySection = this.createCurrentDaySection();\n\t\t\t\t\t\tthis._wrapper.appendChild(this._currentDaySection);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis._lastDaySection = this.createDaySection(this._lastDate);\n\t\t\t\t\t\tthis._wrapper.appendChild(this._lastDaySection);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\titem._lastDate = this._lastDate;\n\n\t\t\t\titem.layout();\n\t\t\t}\n\n\t\t\tthis.enableLoading(this._items.length > 0);\n\t\t\tthis.refreshLayout();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis._currentDaySection = this._lastDaySection = this.createCurrentDaySection();\n\t\t\tthis._wrapper.appendChild(this._currentDaySection);\n\n\t\t\tthis._wrapper.appendChild(\n\t\t\t\tBX.create(\n\t\t\t\t\t\"DIV\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-section crm-entity-stream-section-createEntity crm-entity-stream-section-last\"},\n\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\tBX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-info\"}}),\n\t\t\t\t\t\t\t\tBX.create(\n\t\t\t\t\t\t\t\t\t\"DIV\",\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-section-content\"},\n\t\t\t\t\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t\t\t\t\tBX.create(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\"DIV\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-event\"},\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tBX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-header\"}}),\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tBX.create(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\"DIV\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail\"},\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttext: BX.message(\"CRM_TIMELINE_HISTORY_STUB\")\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\n\t\tthis._manager.processHistoryLayoutChange();\n\t}\n\n\trefreshLayout()\n\t{\n\t\tif (this._filterWrapper)\n\t\t{\n\t\t\tif (this._wrapper.firstChild && this._filterWrapper !== this._wrapper.firstChild)\n\t\t\t{\n\t\t\t\tthis._wrapper.insertBefore(this._filterWrapper, this._wrapper.firstChild);\n\t\t\t}\n\t\t\telse if (!this._wrapper.firstChild && this._filterWrapper.parentNode !== this._wrapper)\n\t\t\t{\n\t\t\t\tthis._wrapper.appendChild(this._filterWrapper);\n\t\t\t}\n\t\t}\n\n\t\tthis.adjustFilterButton();\n\n\t\tconst length = this._items.length;\n\t\tif (length === 0 && this._isFilterApplied)\n\t\t{\n\t\t\tif (!this._filterEmptyResultSection)\n\t\t\t{\n\t\t\t\tthis._filterEmptyResultSection = this.createFilterEmptyResultSection();\n\t\t\t}\n\t\t\tthis._wrapper.appendChild(this._filterEmptyResultSection);\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (this._filterEmptyResultSection)\n\t\t{\n\t\t\tthis._filterEmptyResultSection = BX.remove(this._filterEmptyResultSection);\n\t\t}\n\n\t\tif (length === 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tfor (let i = 0; i < (length - 1); i++)\n\t\t{\n\t\t\tconst item = this._items[i];\n\t\t\tif (item.isTerminated())\n\t\t\t{\n\t\t\t\titem.markAsTerminated(false);\n\t\t\t}\n\t\t}\n\n\t\tthis._items[length - 1].markAsTerminated(true);\n\t}\n\n\tcalculateItemIndex(item)\n\t{\n\t\treturn 0;\n\t}\n\n\tcheckItemForTermination(item)\n\t{\n\t\treturn this.getLastItem() === item;\n\t}\n\n\thasContent()\n\t{\n\t\treturn (this._items.length > 0 || this._isFilterApplied || this._isStubMode);\n\t}\n\n\tgetItems(): Array\n\t{\n\t\treturn this._items;\n\t}\n\n\tsetItems(items: Array): void\n\t{\n\t\tthis._items = items;\n\t}\n\n\tgetItemByIndex(index)\n\t{\n\t\treturn index < this._items.length ? this._items[index] : null;\n\t}\n\n\tgetItemCount()\n\t{\n\t\treturn this._items.length;\n\t}\n\n\tgetItemsByAssociatedEntity($entityTypeId, entityId)\n\t{\n\t\tif (!BX.type.isNumber($entityTypeId))\n\t\t{\n\t\t\t$entityTypeId = parseInt($entityTypeId);\n\t\t}\n\n\t\tif (!BX.type.isNumber(entityId))\n\t\t{\n\t\t\tentityId = parseInt(entityId);\n\t\t}\n\n\t\tif (isNaN($entityTypeId) || $entityTypeId <= 0 || isNaN(entityId) || entityId <= 0)\n\t\t{\n\t\t\treturn [];\n\t\t}\n\n\t\tconst results = [];\n\t\tfor (let i = 0, l = this._items.length; i < l; i++)\n\t\t{\n\t\t\tconst item = this._items[i];\n\t\t\tif (item.getAssociatedEntityTypeId() === $entityTypeId && item.getAssociatedEntityId() === entityId)\n\t\t\t{\n\t\t\t\tresults.push(item);\n\t\t\t}\n\t\t}\n\t\treturn results;\n\t}\n\n\tcreateFilterEmptyResultSection()\n\t{\n\t\treturn BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-section crm-entity-stream-section-filter-empty\"},\n\t\t\t\tchildren:\n\t\t\t\t\t[\n\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-section-content\"},\n\t\t\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-filter-empty\"},\n\t\t\t\t\t\t\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-filter-empty-img\"}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-filter-empty-text\"},\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttext: this.getMessage(\"filterEmptyResultStub\")\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t)\n\t\t\t\t\t]\n\t\t\t}\n\t\t);\n\t}\n\n\tadjustFilterButton()\n\t{\n\t\tif (!this._filterWrapper)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this._isFilterShown && this._items.length === 0)\n\t\t{\n\t\t\tif (!this._emptySection)\n\t\t\t{\n\t\t\t\tthis._emptySection = this.createEmptySection();\n\t\t\t}\n\t\t\tthis._wrapper.insertBefore(this._emptySection, this._filterWrapper);\n\t\t}\n\t\telse if (this._emptySection)\n\t\t{\n\t\t\tthis._emptySection = BX.remove(this._emptySection);\n\t\t}\n\n\t\tif (!this._filterButton)\n\t\t{\n\t\t\tthis._filterButton = BX.create(\"BUTTON\",\n\t\t\t\t{\n\t\t\t\t\tattrs: {className: \"crm-entity-stream-filter-label\"},\n\t\t\t\t\ttext: this.getMessage(\"filterButtonCaption\")\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tBX.bind(this._filterButton, \"click\", function (e) {\n\t\t\t\tthis.showFilter();\n\t\t\t}.bind(this));\n\t\t}\n\n\t\tconst section = this._wrapper.querySelector(\".crm-entity-stream-section-today-label, .crm-entity-stream-section-planned-label, .crm-entity-stream-section-history-label\");\n\t\tif (section)\n\t\t{\n\t\t\tconst sectionWrapper = section.querySelector(\".crm-entity-stream-section-content\");\n\t\t\tif (sectionWrapper)\n\t\t\t{\n\t\t\t\tif (this._filterButton.parentNode !== sectionWrapper)\n\t\t\t\t{\n\t\t\t\t\tsectionWrapper.appendChild(this._filterButton);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (this._isFilterApplied)\n\t\t{\n\t\t\tBX.addClass(this._filterButton, \"crm-entity-stream-filter-label-active\");\n\t\t}\n\t\telse\n\t\t{\n\t\t\tBX.removeClass(this._filterButton, \"crm-entity-stream-filter-label-active\");\n\t\t}\n\t}\n\n\tshowFilter(params)\n\t{\n\t\tif (!this._filterWrapper)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tBX.removeClass(this._filterWrapper, \"crm-entity-stream-section-filter-hide\");\n\t\tBX.addClass(this._filterWrapper, \"crm-entity-stream-section-filter-show\");\n\n\t\tthis._isFilterShown = true;\n\n\t\tif (BX.prop.getBoolean(params, \"enableAdjust\", true))\n\t\t{\n\t\t\tthis.adjustFilterButton();\n\t\t}\n\t}\n\n\thideFilter(params)\n\t{\n\t\tif (!this._filterWrapper)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tBX.removeClass(this._filterWrapper, \"crm-entity-stream-section-filter-show\");\n\t\tBX.addClass(this._filterWrapper, \"crm-entity-stream-section-filter-hide\");\n\n\t\tthis._isFilterShown = false;\n\n\t\tif (BX.prop.getBoolean(params, \"enableAdjust\", true))\n\t\t{\n\t\t\tthis.adjustFilterButton();\n\t\t}\n\t}\n\n\tonFilterClose(e)\n\t{\n\t\tthis.hideFilter();\n\n\t\twindow.setTimeout(\n\t\t\tfunction () {\n\t\t\t\tconst filter = BX.Main.filterManager.getById(this._filterId);\n\t\t\t\tif (filter)\n\t\t\t\t{\n\t\t\t\t\tfilter.resetFilter();\n\t\t\t\t}\n\t\t\t}.bind(this),\n\t\t\t500\n\t\t);\n\t}\n\n\tcreateEmptySection()\n\t{\n\t\treturn BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-section crm-entity-stream-section-planned-label\"},\n\t\t\t\tchildren: [BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-section-content\"}})]\n\t\t\t}\n\t\t);\n\t}\n\n\tcreateCurrentDaySection()\n\t{\n\t\tlet formattedDate = this.formatDate(BX.prop.extractDate(new Date()));\n\t\tformattedDate = formattedDate[0].toUpperCase() + formattedDate.substring(1);\n\n\t\treturn BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-section crm-entity-stream-section-today-label\"},\n\t\t\t\tchildren:\n\t\t\t\t\t[\n\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-section-content\"},\n\t\t\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-today-label\"},\n\t\t\t\t\t\t\t\t\t\t\t\ttext: formattedDate\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t)\n\t\t\t\t\t]\n\t\t\t}\n\t\t);\n\t}\n\n\tcreateDaySection(date)\n\t{\n\t\tlet formattedDate = this.formatDate(date);\n\t\tformattedDate = formattedDate[0].toUpperCase() + formattedDate.substring(1);\n\n\t\treturn BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-section crm-entity-stream-section-history-label\"},\n\t\t\t\tchildren:\n\t\t\t\t\t[\n\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-section-content\"},\n\t\t\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-history-label\"},\n\t\t\t\t\t\t\t\t\t\t\t\ttext: formattedDate\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t)\n\t\t\t\t\t]\n\t\t\t}\n\t\t);\n\t}\n\n\tcreateAnchor(index)\n\t{\n\t\tif (this._emptySection)\n\t\t{\n\t\t\tthis._emptySection = BX.remove(this._emptySection);\n\t\t}\n\n\t\tif (this._currentDaySection === null)\n\t\t{\n\t\t\tthis._currentDaySection = this.createCurrentDaySection();\n\t\t\tif (this._wrapper.firstChild)\n\t\t\t{\n\t\t\t\tthis._wrapper.insertBefore(this._currentDaySection, this._wrapper.firstChild);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis._wrapper.appendChild(this._currentDaySection);\n\t\t\t}\n\t\t}\n\n\t\tif (this._anchor === null)\n\t\t{\n\t\t\tthis._anchor = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-section crm-entity-stream-section-shadow\"}});\n\t\t\tif (this._currentDaySection.nextSibling)\n\t\t\t{\n\t\t\t\tthis._wrapper.insertBefore(this._anchor, this._currentDaySection.nextSibling);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis._wrapper.appendChild(this._anchor);\n\t\t\t}\n\t\t}\n\t\treturn this._anchor;\n\t}\n\n\tcreateActivityItem(data)\n\t{\n\t\tconst typeId = BX.prop.getInteger(data, \"TYPE_ID\", ItemType.undefined);\n\t\tconst typeCategoryId = BX.prop.getInteger(data, \"TYPE_CATEGORY_ID\", 0);\n\t\tconst providerId = BX.prop.getString(\n\t\t\tBX.prop.getObject(data, \"ASSOCIATED_ENTITY\", {}),\n\t\t\t\"PROVIDER_ID\",\n\t\t\t\"\"\n\t\t);\n\t\tconst vueComponentId = 'TYPE_' + typeCategoryId + (providerId ? '_' + providerId : '');\n\t\tconst vueComponentsMap = new Map([\n\t\t\t['TYPE_' + BX.CrmActivityType.provider + '_CRM_NOTIFICATION', BX.Crm.Timeline.Notification],\n\t\t\t['TYPE_' + BX.CrmActivityType.provider + '_CRM_DELIVERY', BX.Crm.Timeline.DeliveryActivity],\n\t\t]);\n\t\tconst vueComponent = vueComponentsMap.has(vueComponentId) ? vueComponentsMap.get(vueComponentId) : null;\n\n\t\tif (typeId !== ItemType.activity)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tif (typeCategoryId === BX.CrmActivityType.email)\n\t\t{\n\t\t\treturn Email.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this._history,\n\t\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\tif (typeCategoryId === BX.CrmActivityType.call)\n\t\t{\n\t\t\treturn Call.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this._history,\n\t\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (typeCategoryId === BX.CrmActivityType.meeting)\n\t\t{\n\t\t\treturn Meeting.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this._history,\n\t\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (typeCategoryId === BX.CrmActivityType.task)\n\t\t{\n\t\t\treturn Task.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this._history,\n\t\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (typeCategoryId === BX.CrmActivityType.provider)\n\t\t{\n\t\t\tif (providerId === \"CRM_WEBFORM\")\n\t\t\t{\n\t\t\t\treturn WebForm.create(\n\t\t\t\t\tdata[\"ID\"],\n\t\t\t\t\t{\n\t\t\t\t\t\thistory: this._history,\n\t\t\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\tdata: data\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t\telse if (providerId === 'CRM_SMS')\n\t\t\t{\n\t\t\t\treturn Sms.create(\n\t\t\t\t\tdata[\"ID\"],\n\t\t\t\t\t{\n\t\t\t\t\t\thistory: this._history,\n\t\t\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\tdata: data,\n\t\t\t\t\t\tsmsStatusDescriptions: this._manager.getSetting('smsStatusDescriptions', {}),\n\t\t\t\t\t\tsmsStatusSemantics: this._manager.getSetting('smsStatusSemantics', {}),\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t\telse if (providerId === 'CRM_REQUEST')\n\t\t\t{\n\t\t\t\treturn Request.create(\n\t\t\t\t\tdata[\"ID\"],\n\t\t\t\t\t{\n\t\t\t\t\t\thistory: this._history,\n\t\t\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\tdata: data\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t\telse if (providerId === \"IMOPENLINES_SESSION\")\n\t\t\t{\n\t\t\t\treturn OpenLine.create(\n\t\t\t\t\tdata[\"ID\"],\n\t\t\t\t\t{\n\t\t\t\t\t\thistory: this._history,\n\t\t\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\tdata: data\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t\telse if (providerId === 'REST_APP')\n\t\t\t{\n\t\t\t\treturn Rest.create(\n\t\t\t\t\tdata[\"ID\"],\n\t\t\t\t\t{\n\t\t\t\t\t\thistory: this._history,\n\t\t\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\tdata: data\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t\telse if (providerId === 'VISIT_TRACKER')\n\t\t\t{\n\t\t\t\treturn Visit.create(\n\t\t\t\t\tdata[\"ID\"],\n\t\t\t\t\t{\n\t\t\t\t\t\thistory: this,\n\t\t\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\tdata: data\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t\telse if (providerId === 'CRM_DELIVERY')\n\t\t\t{\n\t\t\t\treturn HistoryActivity.create(\n\t\t\t\t\tdata[\"ID\"],\n\t\t\t\t\t{\n\t\t\t\t\t\thistory: this._history,\n\t\t\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\tdata: data,\n\t\t\t\t\t\tvueComponent: vueComponent,\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t\telse if (providerId === 'ZOOM')\n\t\t\t{\n\t\t\t\treturn Zoom.create(\n\t\t\t\t\tdata[\"ID\"],\n\t\t\t\t\t{\n\t\t\t\t\t\thistory: this,\n\t\t\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\tdata: data\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t\telse if (providerId === 'CRM_CALL_TRACKER')\n\t\t\t{\n\t\t\t\treturn Call.create(\n\t\t\t\t\tdata[\"ID\"],\n\t\t\t\t\t{\n\t\t\t\t\t\thistory: this,\n\t\t\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\tdata: data\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\treturn HistoryActivity.create(\n\t\t\tdata[\"ID\"],\n\t\t\t{\n\t\t\t\thistory: this._history,\n\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\tcontainer: this._wrapper,\n\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\tdata: data,\n\t\t\t\tvueComponent: vueComponent,\n\t\t\t}\n\t\t);\n\t}\n\n\tcreateOrderEntityItem(data)\n\t{\n\t\tconst entityId = BX.prop.getInteger(data, \"ASSOCIATED_ENTITY_TYPE_ID\", 0);\n\t\tconst typeId = BX.prop.getInteger(data, \"TYPE_CATEGORY_ID\", 0);\n\t\tif (entityId !== BX.CrmEntityType.enumeration.order\n\t\t\t&& entityId !== BX.CrmEntityType.enumeration.orderpayment\n\t\t\t&& entityId !== BX.CrmEntityType.enumeration.ordershipment)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst settings = {\n\t\t\thistory: this._history,\n\t\t\tfixedHistory: this._fixedHistory,\n\t\t\tcontainer: this._wrapper,\n\t\t\tactivityEditor: this._activityEditor,\n\t\t\tdata: data\n\t\t};\n\n\t\tif (typeId === ItemType.creation)\n\t\t{\n\t\t\treturn OrderCreation.create(data[\"ID\"], settings);\n\t\t}\n\t\telse if (typeId === ItemType.modification)\n\t\t{\n\t\t\treturn OrderModification.create(data[\"ID\"], settings);\n\t\t}\n\t\telse if (typeId === OrderType.encourageBuyProducts)\n\t\t{\n\t\t\tsettings.vueComponent = BX.Crm.Timeline.EncourageBuyProducts;\n\t\t\treturn HistoryItem.create(data[\"ID\"], settings);\n\t\t}\n\t}\n\n\tcreateStoreDocumentItem(data)\n\t{\n\t\tconst entityId = BX.prop.getInteger(data, \"ASSOCIATED_ENTITY_TYPE_ID\", 0);\n\t\tconst typeId = BX.prop.getInteger(data, \"TYPE_CATEGORY_ID\", 0);\n\t\tif (entityId !== BX.CrmEntityType.enumeration.storeDocument && entityId !== BX.CrmEntityType.enumeration.shipmentDocument)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst settings = {\n\t\t\thistory: this._history,\n\t\t\tfixedHistory: this._fixedHistory,\n\t\t\tcontainer: this._wrapper,\n\t\t\tactivityEditor: this._activityEditor,\n\t\t\tdata: data\n\t\t};\n\n\t\tif (typeId === ItemType.creation)\n\t\t{\n\t\t\treturn StoreDocumentCreation.create(data[\"ID\"], settings);\n\t\t}\n\t\telse if (typeId === ItemType.modification)\n\t\t{\n\t\t\treturn StoreDocumentModification.create(data[\"ID\"], settings);\n\t\t}\n\t}\n\n\tcreateProductCompilationItem(data)\n\t{\n\t\tvar typeId = BX.prop.getInteger(data, \"TYPE_CATEGORY_ID\", 0);\n\t\tvar entityId = BX.prop.getInteger(data, \"ASSOCIATED_ENTITY_TYPE_ID\", 0);\n\t\tif(entityId !== BX.CrmEntityType.enumeration.deal)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tvar settings = {\n\t\t\thistory: this._history,\n\t\t\tfixedHistory: this._fixedHistory,\n\t\t\tcontainer: this._wrapper,\n\t\t\tactivityEditor: this._activityEditor,\n\t\t\tdata: data\n\t\t};\n\n\t\tif (typeId === CompilationType.productList)\n\t\t{\n\t\t\tsettings.vueComponent = BX.Crm.Timeline.ProductCompilationList;\n\t\t}\n\t\telse if (typeId === CompilationType.orderExists)\n\t\t{\n\t\t\tsettings.vueComponent = BX.Crm.Timeline.CompilationOrderNotice;\n\t\t}\n\t\telse if (typeId === CompilationType.compilationViewed)\n\t\t{\n\t\t\tsettings.vueComponent = BX.Crm.Timeline.ProductCompilationViewed;\n\t\t}\n\t\telse if (typeId === CompilationType.newDealCreated)\n\t\t{\n\t\t\tsettings.vueComponent = BX.Crm.Timeline.NewDealCreated;\n\t\t}\n\n\t\treturn BX.CrmHistoryItem.create(data[\"ID\"], settings);\n\t}\n\n\tcreateExternalNotificationItem(data)\n\t{\n\t\tconst typeId = BX.prop.getInteger(data, \"TYPE_CATEGORY_ID\", 0);\n\t\tconst changedFieldName = BX.prop.getString(data, 'CHANGED_FIELD_NAME', '');\n\n\t\tif (typeId === ItemType.modification && changedFieldName === 'STATUS_ID')\n\t\t{\n\t\t\treturn ExternalNoticeStatusModification.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this._history,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\treturn ExternalNoticeModification.create(\n\t\t\tdata[\"ID\"],\n\t\t\t{\n\t\t\t\thistory: this._history,\n\t\t\t\tcontainer: this._wrapper,\n\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\tdata: data\n\t\t\t}\n\t\t);\n\t}\n\n\tcreateDeliveryItem(data)\n\t{\n\t\tconst typeId = BX.prop.getInteger(data, \"TYPE_ID\", ItemType.undefined);\n\t\tconst typeCategoryId = BX.prop.getInteger(data, \"TYPE_CATEGORY_ID\", 0);\n\n\t\tif (typeId !== ItemType.delivery)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst vueComponentsMap = new Map([\n\t\t\t[DeliveryType.taxiEstimationRequest, BX.Crm.Delivery.Taxi.EstimationRequest],\n\t\t\t[DeliveryType.taxiCallRequest, BX.Crm.Delivery.Taxi.CallRequest],\n\t\t\t[DeliveryType.taxiCancelledByManager, BX.Crm.Delivery.Taxi.CancelledByManager],\n\t\t\t[DeliveryType.taxiCancelledByDriver, BX.Crm.Delivery.Taxi.CancelledByDriver],\n\t\t\t[DeliveryType.taxiPerformerNotFound, BX.Crm.Delivery.Taxi.PerformerNotFound],\n\t\t\t[DeliveryType.taxiSmsProviderIssue, BX.Crm.Delivery.Taxi.SmsProviderIssue],\n\t\t\t[DeliveryType.taxiReturnedFinish, BX.Crm.Delivery.Taxi.ReturnedFinish],\n\t\t\t[DeliveryType.deliveryMessage, BX.Crm.Timeline.DeliveryMessage],\n\t\t\t[DeliveryType.deliveryCalculation, BX.Crm.Timeline.DeliveryCalculation]\n\t\t]);\n\n\t\tif (vueComponentsMap.has(typeCategoryId))\n\t\t{\n\t\t\treturn HistoryItem.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this._history,\n\t\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data,\n\t\t\t\t\tvueComponent: vueComponentsMap.get(typeCategoryId),\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t}\n\n\tcreateItem(data)\n\t{\n\t\tif (data.hasOwnProperty('type'))\n\t\t{\n\t\t\treturn ConfigurableItem.create(data.id, {\n\t\t\t\ttimelineId: this.getId(),\n\t\t\t\tcontainer: this.getWrapper(),\n\t\t\t\titemClassName: this.getItemClassName(),\n\t\t\t\tuseShortTimeFormat: this.getStreamType() === StreamType.history,\n\t\t\t\tisReadOnly: this.isReadOnly(),\n\t\t\t\tcurrentUser: this._manager.getCurrentUser(),\n\t\t\t\townerTypeId: this._manager.getOwnerTypeId(),\n\t\t\t\townerId: this._manager.getOwnerId(),\n\t\t\t\tstreamType: this.getStreamType(),\n\t\t\t\tdata: data,\n\t\t\t})\n\t\t}\n\n\t\tconst typeId = BX.prop.getInteger(data, \"TYPE_ID\", ItemType.undefined);\n\t\tconst typeCategoryId = BX.prop.getInteger(data, \"TYPE_CATEGORY_ID\", 0);\n\n\t\tif (typeId === ItemType.activity)\n\t\t{\n\t\t\treturn this.createActivityItem(data);\n\t\t}\n\t\telse if (typeId === ItemType.order)\n\t\t{\n\t\t\treturn this.createOrderEntityItem(data);\n\t\t}\n\t\telse if(typeId === ItemType.productCompilation)\n\t\t{\n\t\t\treturn this.createProductCompilationItem(data);\n\t\t}\n\t\telse if (typeId === ItemType.storeDocument)\n\t\t{\n\t\t\treturn this.createStoreDocumentItem(data);\n\t\t}\n\t\telse if (typeId === ItemType.externalNotification)\n\t\t{\n\t\t\treturn this.createExternalNotificationItem(data);\n\t\t}\n\t\telse if (typeId === ItemType.orderCheck)\n\t\t{\n\t\t\treturn OrderCheck.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this._history,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (typeId === ItemType.finalSummary)\n\t\t{\n\t\t\treturn FinalSummary.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this._history,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (typeId === ItemType.finalSummaryDocuments)\n\t\t{\n\t\t\treturn FinalSummaryDocuments.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this._history,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (typeId === ItemType.creation)\n\t\t{\n\t\t\treturn Creation.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this._history,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (typeId === ItemType.restoration)\n\t\t{\n\t\t\treturn Restoration.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this._history,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (typeId === ItemType.link)\n\t\t{\n\t\t\treturn Link.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (typeId === ItemType.unlink)\n\t\t{\n\t\t\treturn Unlink.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (typeId === ItemType.mark)\n\t\t{\n\t\t\treturn Mark.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this._history,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (typeId === ItemType.comment)\n\t\t{\n\t\t\treturn Comment.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this._history,\n\t\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (typeId === ItemType.wait)\n\t\t{\n\t\t\treturn Wait.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this._history,\n\t\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (typeId === ItemType.document)\n\t\t{\n\t\t\treturn Document.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this._history,\n\t\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (typeId === ItemType.sender)\n\t\t{\n\t\t\treturn Sender.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (typeId === ItemType.modification)\n\t\t{\n\t\t\treturn Modification.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this._history,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (typeId === ItemType.conversion)\n\t\t{\n\t\t\treturn Conversion.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this._history,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (typeId === ItemType.bizproc)\n\t\t{\n\t\t\treturn Bizproc.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this._history,\n\t\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (typeId === ItemType.scoring)\n\t\t{\n\t\t\treturn Scoring.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this._history,\n\t\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (typeId === ItemType.delivery)\n\t\t{\n\t\t\treturn this.createDeliveryItem(data);\n\t\t}\n\n\t\treturn HistoryItem.create(\n\t\t\tdata[\"ID\"],\n\t\t\t{\n\t\t\t\thistory: this._history,\n\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\tcontainer: this._wrapper,\n\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\tdata: data\n\t\t\t}\n\t\t);\n\t}\n\n\tgetWrapper()\n\t{\n\t\treturn this._wrapper;\n\t}\n\n\tgetItemClassName()\n\t{\n\t\treturn 'crm-entity-stream-section crm-entity-stream-section-history';\n\t}\n\n\taddItem(item, index)\n\t{\n\t\tif (!BX.type.isNumber(index) || index < 0)\n\t\t{\n\t\t\tindex = this.calculateItemIndex(item);\n\t\t}\n\n\t\tif (index < this._items.length)\n\t\t{\n\t\t\tthis._items.splice(index, 0, item);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis._items.push(item);\n\t\t}\n\n\t\tthis.refreshLayout();\n\t\tthis._manager.processHistoryLayoutChange();\n\t}\n\n\tdeleteItem(item)\n\t{\n\t\tconst index = this.getItemIndex(item);\n\t\tif (index < 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\titem.clearLayout();\n\t\tthis.removeItemByIndex(index);\n\n\t\tthis.refreshLayout();\n\t\tthis._manager.processHistoryLayoutChange();\n\t}\n\n\tresetLayout()\n\t{\n\t\tlet i;\n\n\t\tfor (i = (this._items.length - 1); i >= 0; i--)\n\t\t{\n\t\t\tthis._items[i].clearLayout();\n\t\t}\n\n\t\tthis._items = [];\n\n\t\tthis._currentDaySection = this._lastDaySection = this._emptySection = this._filterEmptyResultSection = null;\n\t\tthis._anchor = null;\n\t\tthis._lastDate = null;\n\n\t\t//Clean wrapper. Skip filter for prevent trembling.\n\t\tconst children = [];\n\t\tlet child;\n\t\tfor (i = 0; child = this._wrapper.children[i]; i++)\n\t\t{\n\t\t\tif (child !== this._filterWrapper)\n\t\t\t{\n\t\t\t\tchildren.push(child);\n\t\t\t}\n\t\t}\n\n\t\tfor (i = 0; child = children[i]; i++)\n\t\t{\n\t\t\tthis._wrapper.removeChild(child);\n\t\t}\n\t}\n\n\tonWindowScroll(e)\n\t{\n\t\tif (!this._loadingWaiter || !this._enableLoading || this._isRequestRunning)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst pos = this._loadingWaiter.getBoundingClientRect();\n\t\tif (pos.top <= document.documentElement.clientHeight)\n\t\t{\n\t\t\tthis.loadItems();\n\t\t}\n\t}\n\n\tonFilterApply(id, data, ctx, promise, params)\n\t{\n\t\tif (id !== this._filterId)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tparams.autoResolve = false;\n\t\tthis._isFilterApplied = BX.prop.getString(data, \"action\", \"\") === \"apply\";\n\t\tthis._isRequestRunning = true;\n\n\t\tBX.CrmDataLoader.create(\n\t\t\tthis._id,\n\t\t\t{\n\t\t\t\tserviceUrl: this.getSetting(\"serviceUrl\", \"\"),\n\t\t\t\taction: \"GET_HISTORY_ITEMS\",\n\t\t\t\tparams:\n\t\t\t\t\t{\n\t\t\t\t\t\t\"GUID\": this._id,\n\t\t\t\t\t\t\"OWNER_TYPE_ID\": this._manager.getOwnerTypeId(),\n\t\t\t\t\t\t\"OWNER_ID\": this._manager.getOwnerId()\n\t\t\t\t\t}\n\t\t\t}\n\t\t).load(\n\t\t\tfunction (sender, result) {\n\t\t\t\tthis.resetLayout();\n\t\t\t\tthis.bulkCreateItems(BX.prop.getArray(result, \"HISTORY_ITEMS\", []));\n\t\t\t\tthis.setNavigation(BX.prop.getObject(result, \"HISTORY_NAVIGATION\", {}));\n\n\t\t\t\tthis.refreshLayout();\n\t\t\t\tif (this._items.length > 0)\n\t\t\t\t{\n\t\t\t\t\tthis._manager.processHistoryLayoutChange();\n\t\t\t\t}\n\n\t\t\t\tpromise.fulfill();\n\t\t\t\tthis._isRequestRunning = false;\n\t\t\t}.bind(this)\n\t\t);\n\t}\n\n\tbulkCreateItems(itemData)\n\t{\n\t\tconst length = itemData.length;\n\t\tif (length === 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this._filterEmptyResultSection)\n\t\t{\n\t\t\tthis._filterEmptyResultSection = BX.remove(this._filterEmptyResultSection);\n\t\t}\n\n\t\tconst now = BX.prop.extractDate(new Date());\n\t\tlet i, item;\n\t\tfor (i = 0; i < length; i++)\n\t\t{\n\t\t\tconst itemId = BX.prop.getInteger(\n\t\t\t\titemData[i],\n\t\t\t\t'id',\n\t\t\t\tBX.prop.getInteger(itemData[i], 'ID', 0)\n\t\t\t);\n\n\t\t\tif (itemId <= 0)\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (this.findItemById(itemId) !== null)\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\titem = this.createItem(itemData[i]);\n\t\t\tthis._items.push(item);\n\n\t\t\tconst created = item.getCreatedDate();\n\t\t\tif (this._lastDate === null || this._lastDate.getTime() !== created.getTime())\n\t\t\t{\n\t\t\t\tthis._lastDate = created;\n\t\t\t\tif (now.getTime() === created.getTime())\n\t\t\t\t{\n\t\t\t\t\tthis._currentDaySection = this._lastDaySection = this.createCurrentDaySection();\n\t\t\t\t\tthis._wrapper.appendChild(this._currentDaySection);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis._lastDaySection = this.createDaySection(this._lastDate);\n\t\t\t\t\tthis._wrapper.appendChild(this._lastDaySection);\n\t\t\t\t}\n\t\t\t}\n\t\t\titem.layout();\n\t\t}\n\t}\n\n\tloadItems()\n\t{\n\t\tthis._isRequestRunning = true;\n\t\tBX.CrmDataLoader.create(\n\t\t\tthis._id,\n\t\t\t{\n\t\t\t\tserviceUrl: this.getSetting(\"serviceUrl\", \"\"),\n\t\t\t\taction: \"GET_HISTORY_ITEMS\",\n\t\t\t\tparams:\n\t\t\t\t\t{\n\t\t\t\t\t\t\"GUID\": this._id,\n\t\t\t\t\t\t\"OWNER_TYPE_ID\": this._manager.getOwnerTypeId(),\n\t\t\t\t\t\t\"OWNER_ID\": this._manager.getOwnerId(),\n\t\t\t\t\t\t\"NAVIGATION\": this._navigation\n\t\t\t\t\t}\n\t\t\t}\n\t\t).load(\n\t\t\tfunction (sender, result) {\n\t\t\t\tthis.bulkCreateItems(BX.prop.getArray(result, \"HISTORY_ITEMS\", []));\n\t\t\t\tthis.setNavigation(BX.prop.getObject(result, \"HISTORY_NAVIGATION\", {}));\n\n\t\t\t\tthis.refreshLayout();\n\t\t\t\tif (this._items.length > 0)\n\t\t\t\t{\n\t\t\t\t\tthis._manager.processHistoryLayoutChange();\n\t\t\t\t}\n\n\t\t\t\tthis._isRequestRunning = false;\n\t\t\t}.bind(this)\n\t\t);\n\t}\n\n\tgetNavigation()\n\t{\n\t\treturn this._navigation;\n\t}\n\n\tsetNavigation(navigation)\n\t{\n\t\tif (!BX.type.isPlainObject(navigation))\n\t\t{\n\t\t\tnavigation = {};\n\t\t}\n\n\t\tthis._navigation = navigation;\n\t\tthis.enableLoading(\n\t\t\tBX.prop.getString(this._navigation, \"OFFSET_TIMESTAMP\", \"\") !== \"\"\n\t\t);\n\t}\n\n\tisLoadingEnabled()\n\t{\n\t\treturn this._enableLoading;\n\t}\n\n\tenableLoading(enable)\n\t{\n\t\tenable = !!enable;\n\n\t\tif (this._enableLoading === enable)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis._enableLoading = enable;\n\n\t\tif (this._enableLoading)\n\t\t{\n\t\t\tif (this._items.length > 0)\n\t\t\t{\n\t\t\t\tthis._loadingWaiter = this._items[this._items.length - 1].getWrapper();\n\t\t\t}\n\n\t\t\tif (!this._scrollHandler)\n\t\t\t{\n\t\t\t\tthis._scrollHandler = BX.delegate(this.onWindowScroll, this);\n\t\t\t\tBX.bind(window, \"scroll\", this._scrollHandler);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis._loadingWaiter = null;\n\n\t\t\tif (this._scrollHandler)\n\t\t\t{\n\t\t\t\tBX.unbind(window, \"scroll\", this._scrollHandler);\n\t\t\t\tthis._scrollHandler = null;\n\t\t\t}\n\t\t}\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = History.messages;\n\t\treturn m.hasOwnProperty(name) ? m[name] : name;\n\t}\n\n\tanimateItemAdding(item): Promise\n\t{\n\t\treturn new Promise((resolve) => {\n\t\t\tExpand.create(item.getWrapper(), resolve).run();\n\t\t});\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new History();\n\t\tself.initialize(id, settings);\n\t\tHistory.instances[self.getId()] = self;\n\t\treturn self;\n\t}\n\n\tstatic messages = {};\n\tstatic instances = {};\n}\n","import History from \"./history\";\nimport {Item} from 'crm.timeline.item';\nimport CompatibleItem from \"../items/compatible-item\";\nimport {StreamType} from 'crm.timeline.item';\n\n/** @memberof BX.Crm.Timeline.Streams */\nexport default class FixedHistory extends History\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._items = [];\n\t\tthis._wrapper = null;\n\t\tthis._fixedHistory = this;\n\t\tthis._history = this;\n\t\tthis._isRequestRunning = false;\n\t}\n\n\tdoInitialize()\n\t{\n\t\tconst datetimeFormat = BX.message(\"FORMAT_DATETIME\").replace(/:SS/, \"\");\n\t\tthis._timeFormat = BX.date.convertBitrixFormat(datetimeFormat);\n\n\t\tlet itemData = this.getSetting(\"itemData\");\n\t\tif(!BX.type.isArray(itemData))\n\t\t{\n\t\t\titemData = [];\n\t\t}\n\n\t\tlet i, length, item;\n\t\tfor(i = 0, length = itemData.length; i < length; i++)\n\t\t{\n\t\t\titem = this.createItem(itemData[i]);\n\t\t\titem._isFixed = true;\n\t\t\tthis._items.push(item);\n\t\t}\n\t}\n\n\tsetHistory(history)\n\t{\n\t\tthis._history = history;\n\t}\n\n\tcheckItemForTermination(item)\n\t{\n\t\treturn false;\n\t}\n\n\tlayout()\n\t{\n\t\tthis._wrapper = BX.create(\"DIV\", {});\n\t\tthis.createAnchor();\n\t\tthis._container.insertBefore(this._wrapper,  this._editorContainer.nextElementSibling);\n\n\t\tfor (let i = 0; i < this._items.length; i++)\n\t\t{\n\t\t\tthis._items[i].setContainer(this._wrapper);\n\t\t\tthis._items[i].layout();\n\t\t}\n\n\t\tthis.refreshLayout();\n\n\t\tthis._manager.processHistoryLayoutChange();\n\t}\n\n\trefreshLayout()\n\t{\n\t}\n\n\tformatDate(date)\n\t{\n\t}\n\n\tcreateCurrentDaySection()\n\t{\n\t}\n\n\tcreateDaySection(date)\n\t{\n\t}\n\n\tcreateAnchor(index)\n\t{\n\t\tthis._anchor = BX.create(\"DIV\", { attrs:{className: \"crm-entity-stream-section-fixed-anchor\"} });\n\t\tthis._wrapper.appendChild(this._anchor);\n\t}\n\n\tonWindowScroll(e)\n\t{\n\t}\n\n\tonItemsLoad(sender, result)\n\t{\n\t}\n\n\tloadItems()\n\t{\n\t\tthis._isRequestRunning = true;\n\n\t\tBX.CrmDataLoader.create(\n\t\t\tthis._id,\n\t\t\t{\n\t\t\t\tserviceUrl: this.getSetting(\"serviceUrl\", \"\"),\n\t\t\t\taction: \"GET_FIXED_HISTORY_ITEMS\",\n\t\t\t\tparams:\n\t\t\t\t\t{\n\t\t\t\t\t\t\"OWNER_TYPE_ID\" : this._manager.getOwnerTypeId(),\n\t\t\t\t\t\t\"OWNER_ID\": this._manager.getOwnerId(),\n\t\t\t\t\t}\n\t\t\t}\n\t\t).load(BX.delegate(this.onItemsLoad, this));\n\t}\n\n\taddItem(item: Item, index): void\n\t{\n\t\tsuper.addItem(item, index);\n\n\t\tif (item instanceof CompatibleItem)\n\t\t{\n\t\t\titem._isFixed = true;\n\t\t}\n\t}\n\n\tgetItemClassName()\n\t{\n\t\treturn 'crm-entity-stream-section crm-entity-stream-section-history crm-entity-stream-section-top-fixed';\n\t}\n\n\tgetStreamType(): number\n\t{\n\t\treturn StreamType.pinned;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tlet self = new FixedHistory();\n\t\tself.initialize(id, settings);\n\t\tthis.instances[self.getId()] = self;\n\t\treturn self;\n\t}\n}\n\nFixedHistory.instances = {};\n","import {Type, Loc, clone, ajax} from 'main.core';\nimport Stream from './stream';\nimport Fasten from \"./animations/fasten\";\nimport CompatibleItem from \"./items/compatible-item\";\n\ndeclare type PullActionProcessorMessage = {\n\taction: string,\n\titem: Object,\n\tstream: string,\n\tid: string,\n\tparams: Object | null,\n};\n\ndeclare type PullActionProcessorProps = {\n\tscheduleStream: Stream,\n\tfixedHistoryStream: Stream,\n\thistoryStream: Stream,\n\townerTypeId: number,\n\townerId: number,\n};\n\nexport default class PullActionProcessor\n{\n\t#scheduleStream: Stream = null;\n\t#fixedHistoryStream: Stream = null;\n\t#historyStream: Stream = null;\n\n\t#itemsQueue = [];\n\t#itemsQueueProcessing = false;\n\n\t#reloadingMessagesQueue: PullActionProcessorMessage[] = [];\n\n\t#ownerTypeId: number;\n\t#ownerId: number;\n\n\tconstructor(params: PullActionProcessorProps)\n\t{\n\t\tif (\n\t\t\t!Type.isObject(params.scheduleStream)\n\t\t\t|| !Type.isObject(params.fixedHistoryStream)\n\t\t\t|| !Type.isObject(params.historyStream)\n\t\t)\n\t\t{\n\t\t\tthrow new Error(`params scheduleStream, fixedHistoryStream and historyStream are required`);\n\t\t}\n\n\t\tif (!Type.isNumber(params.ownerTypeId) || !Type.isNumber(params.ownerId))\n\t\t{\n\t\t\tthrow new Error('params ownerTypeId and ownerId are required');\n\t\t}\n\n\t\tthis.#scheduleStream = params.scheduleStream;\n\t\tthis.#fixedHistoryStream = params.fixedHistoryStream;\n\t\tthis.#historyStream = params.historyStream;\n\t\tthis.#ownerTypeId = params.ownerTypeId;\n\t\tthis.#ownerId = params.ownerId;\n\t}\n\n\tprocessAction(actionParams: PullActionProcessorMessage): void\n\t{\n\t\tif (this.#itemDataShouldBeReloaded(actionParams))\n\t\t{\n\t\t\tthis.#reloadingMessagesQueue.push(actionParams);\n\t\t\tthis.#fetchItems();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.#addToQueue(actionParams);\n\t\t}\n\t}\n\n\t#itemDataShouldBeReloaded(actionParams: PullActionProcessorMessage)\n\t{\n\t\tconst { item } = actionParams;\n\n\t\tif (!item)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst appLanguage = Loc.getMessage('LANGUAGE_ID').toLowerCase();\n\t\tconst languageId = BX.prop.getString(item, 'languageId', appLanguage).toLowerCase();\n\t\tconst canBeReloaded = BX.prop.getBoolean(item, 'canBeReloaded', true);\n\n\t\treturn (languageId !== appLanguage) && canBeReloaded;\n\t}\n\n\t#addToQueue(actionParams: PullActionProcessorMessage)\n\t{\n\t\tthis.#itemsQueue.push(actionParams);\n\t\tif (!this.#itemsQueueProcessing)\n\t\t{\n\t\t\tthis.#processQueueItem();\n\t\t}\n\t}\n\n\t#processQueueItem(): void\n\t{\n\t\tif (!this.#itemsQueue.length)\n\t\t{\n\t\t\tthis.#itemsQueueProcessing = false;\n\n\t\t\treturn;\n\t\t}\n\t\tthis.#itemsQueueProcessing = true;\n\t\tconst actionParams = this.#itemsQueue.shift();\n\n\t\tconst stream = this.#getStreamByName(actionParams.stream);\n\n\t\tconst promises = [];\n\t\tswitch (actionParams.action)\n\t\t{\n\t\t\tcase 'add':\n\t\t\t\tpromises.push(this.#addItem(actionParams.id, actionParams.item, stream));\n\t\t\t\tbreak;\n\t\t\tcase 'update':\n\t\t\t\tpromises.push(this.#updateItem(actionParams.id, actionParams.item, stream, false, true));\n\t\t\t\tif (stream.isHistoryStream())\n\t\t\t\t{\n\t\t\t\t\t// fixed history stream can contain the same item as a history stream, so both should be updated:\n\t\t\t\t\tpromises.push(this.#updateItem(actionParams.id, actionParams.item, this.#fixedHistoryStream, false, true));\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'delete':\n\t\t\t\tpromises.push(this.#deleteItem(actionParams.id, stream));\n\t\t\t\tif (stream.isHistoryStream())\n\t\t\t\t{\n\t\t\t\t\t// fixed history stream can contain the same item as a history stream, so both should be updated:\n\t\t\t\t\tpromises.push(this.#deleteItem(actionParams.id, this.#fixedHistoryStream));\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'move':\n\t\t\t\t// move item from one stream to another one:\n\t\t\t\tconst sourceStream = this.#getStreamByName(actionParams.params.fromStream);\n\t\t\t\tpromises.push(this.#moveItem(actionParams.params.fromId, sourceStream, actionParams.id, stream, actionParams.item));\n\t\t\t\tbreak;\n\t\t\tcase 'changePinned':\n\t\t\t\t// pin or unpin item\n\t\t\t\tif (this.#getStreamByName(actionParams.params.fromStream).isHistoryStream())\n\t\t\t\t{\n\t\t\t\t\tpromises.push(this.#pinItem(actionParams.id, actionParams.item));\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tpromises.push(this.#unpinItem(actionParams.id, actionParams.item));\n\t\t\t\t}\n\t\t}\n\n\t\tPromise.all(promises).then(() => {\n\t\t\tthis.#processQueueItem();\n\t\t})\n\t}\n\n\t#addItem(id: number, itemData: Object, stream: Stream): Promise\n\t{\n\t\tconst existedStreamItem = stream.findItemById(id);\n\t\tif (existedStreamItem)\n\t\t{\n\t\t\treturn Promise.resolve();\n\t\t}\n\t\tconst streamItem = stream.createItem(itemData);\n\t\tif (!streamItem)\n\t\t{\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\tconst index = stream.calculateItemIndex(streamItem);\n\t\tconst anchor = stream.createAnchor(index);\n\t\tstream.addItem(streamItem, index);\n\t\tstreamItem.layout({anchor: anchor});\n\t\treturn stream.animateItemAdding(streamItem);\n\t}\n\n\t#updateItem(id: number, itemData: Object, stream: Stream, animateUpdate: boolean = true, animateMove: true): Promise\n\t{\n\t\tconst isDone = BX.prop.getString(itemData['ASSOCIATED_ENTITY'], 'COMPLETED') === 'Y';\n\t\tconst existedStreamItem = stream.findItemById(id);\n\t\tif (!existedStreamItem)\n\t\t{\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\tif (existedStreamItem instanceof CompatibleItem && isDone)\n\t\t{\n\t\t\texistedStreamItem._existedStreamItemDeadLine = existedStreamItem.getDeadline();\n\t\t}\n\n\t\texistedStreamItem.setData(itemData);\n\t\treturn stream.refreshItem(existedStreamItem, animateUpdate, animateMove);\n\t}\n\n\t#deleteItem(id: number, stream: Stream): Promise\n\t{\n\t\tconst item = stream.findItemById(id);\n\t\tif (item)\n\t\t{\n\t\t\treturn stream.deleteItemAnimated(item);\n\t\t}\n\n\t\treturn Promise.resolve();\n\t}\n\n\t#moveItem(sourceId: string, sourceStream: Stream, destinationId: string, destinationStream: Stream, destinationItemData: Object): Promise\n\t{\n\t\tconst sourceItem = sourceStream.findItemById(sourceId);\n\t\tif (!sourceItem)\n\t\t{\n\t\t\treturn this.#addItem(destinationId, destinationItemData, destinationStream);\n\t\t}\n\n\t\tconst existedDestinationItem = destinationStream.findItemById(destinationId);\n\t\tif (sourceItem && existedDestinationItem)\n\t\t{\n\t\t\treturn this.#deleteItem(sourceId, sourceStream);\n\t\t}\n\n\t\tconst destinationItem = destinationStream.createItem(destinationItemData);\n\t\tdestinationStream.addItem(destinationItem, destinationStream.calculateItemIndex(destinationItem));\n\t\tdestinationItem.layout({ add: false });\n\n\t\treturn sourceStream.moveItemToStream(sourceItem, destinationStream, destinationItem);\n\t}\n\n\t#pinItem(id: number, itemData: Object): Promise\n\t{\n\t\tif (this.#fixedHistoryStream.findItemById(id))\n\t\t{\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\tconst historyItem = this.#historyStream.findItemById(id);\n\t\tif (!historyItem) // fixed history item does not exist into history items stream, so just add to fixed history stream\n\t\t{\n\t\t\treturn this.#addItem(id, itemData, this.#fixedHistoryStream);\n\t\t}\n\t\tif (historyItem instanceof CompatibleItem)\n\t\t{\n\t\t\thistoryItem.onSuccessFasten();\n\n\t\t\treturn Promise.resolve();\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn this.#updateItem(id, itemData, this.#historyStream, false, false).then(() => {\n\t\t\t\tconst fixedHistoryItem = this.#fixedHistoryStream.createItem(itemData);\n\t\t\t\tthis.#fixedHistoryStream.addItem(fixedHistoryItem, 0);\n\t\t\t\tfixedHistoryItem.layout({ add: false });\n\n\t\t\t\treturn new Promise((resolve) => {\n\t\t\t\t\tconst animation = Fasten.create(\n\t\t\t\t\t\t'',\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tinitialItem: historyItem,\n\t\t\t\t\t\t\tfinalItem: fixedHistoryItem,\n\t\t\t\t\t\t\tanchor: this.#fixedHistoryStream.getAnchor(),\n\t\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\t\tcomplete: resolve,\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t\tanimation.run();\n\t\t\t\t})\n\t\t\t});\n\t\t}\n\t}\n\n\t#unpinItem(id: number, itemData: Object): Promise\n\t{\n\t\tconst fixedHistoryItem = this.#fixedHistoryStream.findItemById(id);\n\t\tif (fixedHistoryItem instanceof CompatibleItem)\n\t\t{\n\t\t\tfixedHistoryItem.onSuccessUnfasten();\n\n\t\t\treturn Promise.resolve();\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn this.#updateItem(id, itemData, this.#historyStream, false, false).then(() => {\n\t\t\t\treturn this.#deleteItem(id, this.#fixedHistoryStream);\n\t\t\t});\n\t\t}\n\t}\n\n\t#getStreamByName(streamName): Stream\n\t{\n\t\tswitch (streamName)\n\t\t{\n\t\t\tcase 'scheduled':\n\t\t\t\treturn this.#scheduleStream;\n\t\t\tcase 'fixedHistory':\n\t\t\t\treturn this.#fixedHistoryStream;\n\t\t\tcase 'history':\n\t\t\t\treturn this.#historyStream;\n\t\t}\n\n\t\tthrow new Error(`Stream \"${streamName}\" not found`);\n\t}\n\n\t#fetchItems()\n\t{\n\t\tsetTimeout(() => {\n\n\t\t\tconst messages = clone(this.#reloadingMessagesQueue);\n\t\t\tthis.#reloadingMessagesQueue = [];\n\n\t\t\tconst activityIds = [];\n\t\t\tconst historyIds = [];\n\n\t\t\tmessages.forEach(message => {\n\t\t\t\tconst container = message.stream === 'scheduled' ? activityIds : historyIds;\n\t\t\t\tcontainer.push(message.id);\n\t\t\t});\n\n\t\t\tif (messages.length)\n\t\t\t{\n\t\t\t\tconst data = {\n\t\t\t\t\tactivityIds,\n\t\t\t\t\thistoryIds,\n\t\t\t\t\townerTypeId: this.#ownerTypeId,\n\t\t\t\t\townerId: this.#ownerId,\n\t\t\t\t};\n\n\t\t\t\tajax.runAction('crm.timeline.item.load', { data })\n\t\t\t\t\t.then(response => {\n\t\t\t\t\t\tmessages.forEach(message => {\n\t\t\t\t\t\t\tif (response.data[message.id])\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tmessage.item = response.data[message.id];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tthis.#addToQueue(message);\n\t\t\t\t\t\t})\n\t\t\t\t\t})\n\t\t\t\t\t.catch(err => {\n\t\t\t\t\t\tconsole.error(err);\n\t\t\t\t\t\tmessages.forEach(message => this.#addToQueue(message));\n\t\t\t\t\t});\n\t\t\t}\n\n\t\t}, 1500);\n\t}\n}\n","import Wait from \"./editors/wait\";\nimport Sms from \"./editors/sms\";\nimport Rest from \"./editors/rest\";\nimport Comment from \"./editors/comment\";\nimport ToDo from \"./editors/todo\";\nimport Scheduled from \"./items/scheduled\";\nimport {Item} from \"crm.timeline.item\";\nimport Document from \"./items/document\";\nimport EntityChat from \"./streams/entitychat\";\nimport MenuBar from \"./tools/menubar\";\nimport AudioPlaybackRateSelector from \"./tools/audio-playback-rate-selector\";\nimport Schedule from \"./streams/schedule\";\nimport FixedHistory from \"./streams/fixedhistory\";\nimport History from \"./streams/history\";\nimport Expand from \"./animations/expand\";\nimport PullActionProcessor from './pull-action-processor'\n\n/** @memberof BX.Crm.Timeline */\nexport default class Manager\n{\n\t#itemPullActionProcessor: PullActionProcessor = null;\n\n\tconstructor()\n\t{\n\t\tthis._id = \"\";\n\t\tthis._settings = {};\n\t\tthis._container = null;\n\t\tthis._ownerTypeId = 0;\n\t\tthis._ownerId = 0;\n\t\tthis._ownerInfo = null;\n\t\tthis._progressSemantics = \"\";\n\n\t\tthis._commentEditor = null;\n\t\tthis._todoEditor = null;\n\t\tthis._waitEditor = null;\n\t\tthis._smsEditor = null;\n\t\tthis._zoomEditor = null;\n\t\tthis._chat = null;\n\t\tthis._schedule = null;\n\t\tthis._history = null;\n\t\tthis._fixedHistory = null;\n\t\tthis._activityEditor = null;\n\t\tthis._menuBar = null;\n\n\t\tthis._userId = 0;\n\t\tthis._readOnly = false;\n\t\tthis._currentUser = null;\n\t\tthis._pullTagName = \"\";\n\t}\n\n\tinitialize(id, settings)\n\t{\n\t\tthis._id = BX.type.isNotEmptyString(id) ? id : BX.util.getRandomString(4);\n\t\tthis._settings = settings ? settings : {};\n\n\t\tthis._ownerTypeId = parseInt(this.getSetting(\"ownerTypeId\"));\n\t\tthis._ownerId = parseInt(this.getSetting(\"ownerId\"));\n\t\tthis._ownerInfo = this.getSetting(\"ownerInfo\");\n\t\tthis._progressSemantics = BX.prop.getString(this._settings, \"progressSemantics\", \"\");\n\t\tthis._spotlightFastenShowed = this.getSetting(\"spotlightFastenShowed\", true);\n\t\tthis._audioPlaybackRate = parseFloat(this.getSetting(\"audioPlaybackRate\", 1));\n\t\tconst containerId = this.getSetting(\"containerId\");\n\t\tif (!BX.type.isNotEmptyString(containerId))\n\t\t{\n\t\t\tthrow \"Manager. A required parameter 'containerId' is missing.\";\n\t\t}\n\n\t\tthis._container = BX(containerId);\n\t\tif (!BX.type.isElementNode(this._container))\n\t\t{\n\t\t\tthrow \"Manager. Container node is not found.\";\n\t\t}\n\t\tthis._editorContainer = BX(this.getSetting(\"editorContainer\"));\n\n\t\tthis._userId = BX.prop.getInteger(this._settings, \"userId\", 0);\n\t\tthis._readOnly = BX.prop.getBoolean(this._settings, \"readOnly\", false);\n\t\tthis._currentUser = BX.prop.getObject(this._settings, \"currentUser\", null);\n\n\t\tconst activityEditorId = this.getSetting(\"activityEditorId\");\n\t\tif (BX.type.isNotEmptyString(activityEditorId))\n\t\t{\n\t\t\tthis._activityEditor = BX.CrmActivityEditor.items[activityEditorId];\n\t\t\tif (!(this._activityEditor instanceof BX.CrmActivityEditor))\n\t\t\t{\n\t\t\t\tthrow \"BX.CrmTimeline. Activity editor instance is not found.\";\n\t\t\t}\n\t\t}\n\n\t\tconst ajaxId = this.getSetting(\"ajaxId\");\n\t\tconst currentUrl = this.getSetting(\"currentUrl\");\n\t\tconst serviceUrl = this.getSetting(\"serviceUrl\");\n\n\t\tthis._chat = EntityChat.create(\n\t\t\tthis._id,\n\t\t\t{\n\t\t\t\tmanager: this,\n\t\t\t\tcontainer: this._container,\n\t\t\t\tdata: this.getSetting(\"chatData\"),\n\t\t\t\tisStubMode: this._ownerId <= 0,\n\t\t\t\treadOnly: this._readOnly\n\t\t\t}\n\t\t);\n\n\t\tthis._schedule = Schedule.create(\n\t\t\tthis._id,\n\t\t\t{\n\t\t\t\tmanager: this,\n\t\t\t\tcontainer: this._container,\n\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\titemData: this.getSetting(\"scheduleData\"),\n\t\t\t\ttemplates: this.getSetting(\"templates\"),\n\t\t\t\tisStubMode: this._ownerId <= 0,\n\t\t\t\tajaxId: ajaxId,\n\t\t\t\tserviceUrl: serviceUrl,\n\t\t\t\tcurrentUrl: currentUrl,\n\t\t\t\tuserId: this._userId,\n\t\t\t\treadOnly: this._readOnly\n\t\t\t}\n\t\t);\n\n\t\tthis._fixedHistory = FixedHistory.create(\n\t\t\tthis._id,\n\t\t\t{\n\t\t\t\tmanager: this,\n\t\t\t\tcontainer: this._container,\n\t\t\t\teditorContainer: this._editorContainer,\n\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\titemData: this.getSetting(\"fixedData\"),\n\t\t\t\ttemplates: this.getSetting(\"templates\"),\n\t\t\t\tisStubMode: this._ownerId <= 0,\n\t\t\t\tajaxId: ajaxId,\n\t\t\t\tserviceUrl: serviceUrl,\n\t\t\t\tcurrentUrl: currentUrl,\n\t\t\t\tuserId: this._userId,\n\t\t\t\treadOnly: this._readOnly\n\t\t\t}\n\t\t);\n\n\t\tthis._history = History.create(\n\t\t\tthis._id,\n\t\t\t{\n\t\t\t\tmanager: this,\n\t\t\t\tcontainer: this._container,\n\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\titemData: this.getSetting(\"historyData\"),\n\t\t\t\ttemplates: this.getSetting(\"templates\"),\n\t\t\t\tnavigation: this.getSetting(\"historyNavigation\", {}),\n\t\t\t\tfilterId: BX.prop.getString(this._settings, \"historyFilterId\", this._id),\n\t\t\t\tisFilterApplied: BX.prop.getBoolean(this._settings, \"isHistoryFilterApplied\", false),\n\t\t\t\tisStubMode: this._ownerId <= 0,\n\t\t\t\tajaxId: ajaxId,\n\t\t\t\tserviceUrl: serviceUrl,\n\t\t\t\tcurrentUrl: currentUrl,\n\t\t\t\tuserId: this._userId,\n\t\t\t\treadOnly: this._readOnly\n\t\t\t}\n\t\t);\n\t\tthis._schedule.setHistory(this._history);\n\t\tthis._fixedHistory.setHistory(this._history);\n\n\t\tvar isTodoEnabled = BX.prop.getBoolean(this._settings, 'enableTodo', false);\n\t\tthis._commentEditor = Comment.create(\n\t\t\tthis._id,\n\t\t\t{\n\t\t\t\tmanager: this,\n\t\t\t\townerTypeId: this._ownerTypeId,\n\t\t\t\townerId: this._ownerId,\n\t\t\t\tserviceUrl: this.getSetting(\"serviceUrl\"),\n\t\t\t\tcontainer: this.getSetting(\"editorCommentContainer\"),\n\t\t\t\tinput: this.getSetting(\"editorCommentInput\"),\n\t\t\t\teditorName: this.getSetting(\"editorCommentEditorName\"),\n\t\t\t\tbutton: this.getSetting(\"editorCommentButton\"),\n\t\t\t\tcancelButton: this.getSetting(\"editorCommentCancelButton\")\n\t\t\t}\n\t\t);\n\t\tthis._commentEditor.setVisible(!isTodoEnabled && !this._readOnly);\n\t\tthis._commentEditor.setHistory(this._history);\n\n\t\tif (isTodoEnabled)\n\t\t{\n\t\t\tthis._todoEditor = ToDo.create(\n\t\t\t\tthis._id,\n\t\t\t\t{\n\t\t\t\t\tmanager: this,\n\t\t\t\t\townerTypeId: this._ownerTypeId,\n\t\t\t\t\townerId: this._ownerId,\n\t\t\t\t\tcontainer: this.getSetting(\"editorTodoContainer\"),\n\t\t\t\t\tbutton: this.getSetting(\"editorTodoButton\"),\n\t\t\t\t\tcancelButton: this.getSetting(\"editorTodoCancelButton\")\n\t\t\t\t}\n\t\t\t);\n\t\t\tthis._todoEditor.setVisible(!this._readOnly);\n\t\t}\n\n\t\tif (BX.prop.getBoolean(this._settings, \"enableWait\", false))\n\t\t{\n\t\t\tthis._waitEditor = Wait.create(\n\t\t\t\tthis._id,\n\t\t\t\t{\n\t\t\t\t\tmanager: this,\n\t\t\t\t\townerTypeId: this._ownerTypeId,\n\t\t\t\t\townerId: this._ownerId,\n\t\t\t\t\tserviceUrl: this.getSetting(\"serviceUrl\"),\n\t\t\t\t\tconfig: this.getSetting(\"editorWaitConfig\", {}),\n\t\t\t\t\ttargetDates: this.getSetting(\"editorWaitTargetDates\", []),\n\t\t\t\t\tcontainer: this.getSetting(\"editorWaitContainer\"),\n\t\t\t\t\tconfigContainer: this.getSetting(\"editorWaitConfigContainer\"),\n\t\t\t\t\tinput: this.getSetting(\"editorWaitInput\"),\n\t\t\t\t\tbutton: this.getSetting(\"editorWaitButton\"),\n\t\t\t\t\tcancelButton: this.getSetting(\"editorWaitCancelButton\")\n\t\t\t\t}\n\t\t\t);\n\t\t\tthis._waitEditor.setVisible(false);\n\t\t}\n\n\t\tif (BX.prop.getBoolean(this._settings, \"enableSms\", false))\n\t\t{\n\t\t\tthis._smsEditor = Sms.create(\n\t\t\t\tthis._id,\n\t\t\t\t{\n\t\t\t\t\tmanager: this,\n\t\t\t\t\townerTypeId: this._ownerTypeId,\n\t\t\t\t\townerId: this._ownerId,\n\t\t\t\t\tserviceUrl: this.getSetting(\"serviceUrl\"),\n\t\t\t\t\tconfig: this.getSetting(\"editorSmsConfig\", {}),\n\t\t\t\t\tcontainer: this.getSetting(\"editorSmsContainer\"),\n\t\t\t\t\tinput: this.getSetting(\"editorSmsInput\"),\n\t\t\t\t\ttemplatesContainer: this.getSetting(\"editorSmsTemplatesContainer\"),\n\t\t\t\t\tbutton: this.getSetting(\"editorSmsButton\"),\n\t\t\t\t\tcancelButton: this.getSetting(\"editorSmsCancelButton\")\n\t\t\t\t}\n\t\t\t);\n\t\t\tthis._smsEditor.setVisible(false);\n\t\t}\n\n\t\tif (BX.prop.getBoolean(this._settings, \"enableZoom\", false) && BX.prop.getBoolean(this._settings, \"statusZoom\", false))\n\t\t{\n\t\t\tthis._zoomEditor = new BX.Crm.Zoom(\n\t\t\t\t{\n\t\t\t\t\tid: this._id,\n\t\t\t\t\tmanager: this,\n\t\t\t\t\townerTypeId: this._ownerTypeId,\n\t\t\t\t\townerId: this._ownerId,\n\t\t\t\t\tcontainer: this.getSetting(\"editorZoomContainer\"),\n\t\t\t\t\tuserId: this._userId\n\t\t\t\t}\n\t\t\t);\n\t\t\tthis._zoomEditor.setVisible(false);\n\t\t}\n\n\t\tif (BX.prop.getBoolean(this._settings, \"enableRest\", false))\n\t\t{\n\t\t\tthis._restEditor = Rest.create(\n\t\t\t\tthis._id,\n\t\t\t\t{\n\t\t\t\t\tmanager: this,\n\t\t\t\t\townerTypeId: this._ownerTypeId,\n\t\t\t\t\townerId: this._ownerId,\n\t\t\t\t\tplacement: BX.prop.getString(this._settings, \"restPlacement\", '')\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\tthis._chat.layout();\n\t\tthis._schedule.layout();\n\t\tthis._fixedHistory.layout();\n\t\tthis._history.layout();\n\n\t\tthis._pullTagName = BX.prop.getString(this._settings, \"pullTagName\", \"\");\n\t\tif (this._pullTagName !== \"\")\n\t\t{\n\t\t\tBX.addCustomEvent(\"onPullEvent-crm\", BX.delegate(this.onPullEvent, this));\n\t\t\tthis.extendWatch();\n\t\t\tthis.#itemPullActionProcessor = new PullActionProcessor({\n\t\t\t\tscheduleStream: this._schedule,\n\t\t\t\tfixedHistoryStream: this._fixedHistory,\n\t\t\t\thistoryStream: this._history,\n\t\t\t\townerTypeId: this._ownerTypeId,\n\t\t\t\townerId: this._ownerId,\n\t\t\t});\n\t\t}\n\t\tthis._menuBar = MenuBar.create(\n\t\t\tthis._id,\n\t\t\t{\n\t\t\t\tcontainer: BX(this.getSetting(\"menuBarContainer\")),\n\t\t\t\tmenuId: this.getSetting(\"menuBarObjectId\"),\n\t\t\t\townerInfo: this._ownerInfo,\n\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\tcommentEditor: this._commentEditor,\n\t\t\t\ttodoEditor: this._todoEditor,\n\t\t\t\twaitEditor: this._waitEditor,\n\t\t\t\tsmsEditor: this._smsEditor,\n\t\t\t\tzoomEditor: this._zoomEditor,\n\t\t\t\trestEditor: this._restEditor,\n\t\t\t\treadOnly: this._readOnly,\n\t\t\t\tmanager: this\n\t\t\t}\n\t\t);\n\n\t\tif (!this._readOnly)\n\t\t{\n\t\t\tthis._menuBar.reset();\n\t\t}\n\n\t\tBX.addCustomEvent(window, \"Crm.EntityProgress.Change\", BX.delegate(this.onEntityProgressChange, this));\n\t\tBX.ready(function () {\n\t\t\twindow.addEventListener(\"scroll\", BX.throttle(function () {\n\t\t\t\tBX.LazyLoad.onScroll();\n\t\t\t}, 80));\n\t\t});\n\t}\n\n\textendWatch()\n\t{\n\t\tif (BX.type.isFunction(BX.PULL) && this._pullTagName !== \"\")\n\t\t{\n\t\t\tBX.PULL.extendWatch(this._pullTagName);\n\t\t\twindow.setTimeout(BX.delegate(this.extendWatch, this), 60000);\n\t\t}\n\t}\n\n\tonPullEvent(command, params)\n\t{\n\t\tif (this._pullTagName !== BX.prop.getString(params, \"TAG\", \"\"))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (command === 'timeline_item_action')\n\t\t{\n\t\t\tthis.#itemPullActionProcessor.processAction(params);\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (command === \"timeline_chat_create\")\n\t\t{\n\t\t\tthis.processChatCreate(params);\n\t\t}\n\t\telse if (command === \"timeline_activity_add\")\n\t\t{\n\t\t\tthis.processActivityExternalAdd(params);\n\t\t}\n\t\telse if (command === \"timeline_activity_update\")\n\t\t{\n\t\t\tthis.processActivityExternalUpdate(params);\n\t\t}\n\t\telse if (command === \"timeline_activity_delete\")\n\t\t{\n\t\t\tthis.processActivityExternalDelete(params);\n\t\t}\n\t\telse if (command === \"timeline_comment_add\")\n\t\t{\n\t\t\tthis.processCommentExternalAdd(params);\n\t\t}\n\t\telse if (command === \"timeline_comment_update\")\n\t\t{\n\t\t\tthis.processCommentExternalUpdate(params);\n\t\t}\n\t\telse if (command === \"timeline_comment_delete\")\n\t\t{\n\t\t\tthis.processCommentExternalDelete(params);\n\t\t}\n\t\telse if (command === \"timeline_changed_binding\")\n\t\t{\n\t\t\tthis.processChangeBinding(params);\n\t\t}\n\t\telse if (command === \"timeline_item_update\")\n\t\t{\n\t\t\tthis.processItemExternalUpdate(params);\n\t\t}\n\t\telse if (command === \"timeline_wait_add\")\n\t\t{\n\t\t\tthis.processWaitExternalAdd(params);\n\t\t}\n\t\telse if (command === \"timeline_wait_update\")\n\t\t{\n\t\t\tthis.processWaitExternalUpdate(params);\n\t\t}\n\t\telse if (command === \"timeline_wait_delete\")\n\t\t{\n\t\t\tthis.processWaitExternalDelete(params);\n\t\t}\n\t\telse if (command === \"timeline_bizproc_status\")\n\t\t{\n\t\t\tthis.processBizprocStatus(params);\n\t\t}\n\t\telse if (command === \"timeline_scoring_add\")\n\t\t{\n\t\t\tthis.processScoringExternalAdd(params);\n\t\t}\n\t}\n\n\tprocessChatCreate(params)\n\t{\n\t\tif (this._chat)\n\t\t{\n\t\t\tthis._chat.setData(BX.prop.getObject(params, \"CHAT_DATA\", {}));\n\t\t\tthis._chat.refreshLayout();\n\t\t}\n\t}\n\n\tprocessActivityExternalAdd(params)\n\t{\n\t\tlet entityData, scheduleItemData, historyItemData, scheduleItem, historyItem;\n\n\t\tentityData = BX.prop.getObject(params, \"ENTITY\", null);\n\t\tscheduleItemData = BX.prop.getObject(params, \"SCHEDULE_ITEM\", null);\n\t\thistoryItemData = BX.prop.getObject(params, \"HISTORY_ITEM\", null);\n\n\n\t\tif (entityData && historyItemData && !BX.type.isPlainObject(historyItemData[\"ASSOCIATED_ENTITY\"]))\n\t\t{\n\t\t\thistoryItemData[\"ASSOCIATED_ENTITY\"] = entityData;\n\t\t}\n\n\t\tif (scheduleItemData !== null && this._schedule.getItemByData(scheduleItemData) === null)\n\t\t{\n\t\t\tscheduleItem = this.addScheduleItem(scheduleItemData);\n\t\t\tscheduleItem.addWrapperClass(\"crm-entity-stream-section-updated\", 1000);\n\t\t}\n\n\t\tif (historyItemData !== null)\n\t\t{\n\t\t\thistoryItem = this._history.findItemById(BX.prop.getString(historyItemData, \"ID\"));\n\t\t\tif (!historyItem)\n\t\t\t{\n\t\t\t\thistoryItem = this.addHistoryItem(historyItemData);\n\t\t\t\tExpand.create(historyItem.getWrapper(), null).run();\n\t\t\t}\n\t\t}\n\t}\n\n\tprocessActivityExternalUpdate(params)\n\t{\n\t\tlet entityData, scheduleItemData, scheduleItem, historyItemData, historyItem, fixedHistoryItem;\n\n\t\tentityData = BX.prop.getObject(params, \"ENTITY\", null);\n\t\tscheduleItemData = BX.prop.getObject(params, \"SCHEDULE_ITEM\", null);\n\t\thistoryItemData = BX.prop.getObject(params, \"HISTORY_ITEM\", null);\n\n\t\tif (entityData)\n\t\t{\n\t\t\tif (historyItemData && !BX.type.isPlainObject(historyItemData[\"ASSOCIATED_ENTITY\"]))\n\t\t\t{\n\t\t\t\thistoryItemData[\"ASSOCIATED_ENTITY\"] = entityData;\n\t\t\t}\n\n\t\t\tconst entityId = BX.prop.getInteger(entityData, \"ID\", 0);\n\t\t\tconst historyItems = this._history.getItemsByAssociatedEntity(BX.CrmEntityType.enumeration.activity, entityId);\n\t\t\tfor (let i = 0, length = historyItems.length; i < length; i++)\n\t\t\t{\n\t\t\t\thistoryItem = historyItems[i];\n\t\t\t\thistoryItem.setAssociatedEntityData(entityData);\n\t\t\t\thistoryItem.refreshLayout();\n\t\t\t}\n\t\t\tconst fixedHistoryItems = this._fixedHistory.getItemsByAssociatedEntity(BX.CrmEntityType.enumeration.activity, entityId);\n\t\t\tfor (let i = 0, length = fixedHistoryItems.length; i < length; i++)\n\t\t\t{\n\t\t\t\tfixedHistoryItem = fixedHistoryItems[i];\n\t\t\t\tfixedHistoryItem.setAssociatedEntityData(entityData);\n\t\t\t\tfixedHistoryItem.refreshLayout();\n\t\t\t}\n\t\t}\n\n\t\tif (scheduleItemData !== null)\n\t\t{\n\t\t\tscheduleItem = this._schedule.getItemByAssociatedEntity(\n\t\t\t\tBX.CrmEntityType.enumeration.activity,\n\t\t\t\tBX.prop.getInteger(scheduleItemData, \"ASSOCIATED_ENTITY_ID\")\n\t\t\t);\n\n\t\t\tif (scheduleItem)\n\t\t\t{\n\t\t\t\tscheduleItem.setData(scheduleItemData);\n\t\t\t\tif (!scheduleItem.isDone())\n\t\t\t\t{\n\t\t\t\t\tthis._schedule.refreshItem(scheduleItem);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tif (historyItemData)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis._schedule.transferItemToHistory(\n\t\t\t\t\t\t\tscheduleItem,\n\t\t\t\t\t\t\thistoryItemData\n\t\t\t\t\t\t);\n\t\t\t\t\t\t//History data are already processed\n\t\t\t\t\t\thistoryItemData = null;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis._schedule.deleteItem(scheduleItem);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (!Scheduled.isDone(scheduleItemData))\n\t\t\t{\n\t\t\t\tscheduleItem = this.addScheduleItem(scheduleItemData);\n\t\t\t\tscheduleItem.addWrapperClass(\"crm-entity-stream-section-updated\", 1000);\n\t\t\t}\n\t\t}\n\n\t\tif (historyItemData !== null)\n\t\t{\n\t\t\thistoryItem = this._history.findItemById(BX.prop.getString(historyItemData, \"ID\"));\n\t\t\tif (!historyItem)\n\t\t\t{\n\t\t\t\thistoryItem = this.addHistoryItem(historyItemData);\n\t\t\t\tExpand.create(historyItem.getWrapper(), null).run();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\thistoryItem.setData(historyItemData);\n\t\t\t\thistoryItem.refreshLayout();\n\t\t\t\tfixedHistoryItem = this._fixedHistory.findItemById(BX.prop.getString(historyItemData, \"ID\"));\n\t\t\t\tif (fixedHistoryItem)\n\t\t\t\t{\n\t\t\t\t\tfixedHistoryItem.setData(historyItemData);\n\t\t\t\t\tfixedHistoryItem.refreshLayout()\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprocessActivityExternalDelete(params)\n\t{\n\t\tconst entityId = BX.prop.getInteger(params, \"ENTITY_ID\", 0);\n\t\tconst historyItems = this._history.getItemsByAssociatedEntity(BX.CrmEntityType.enumeration.activity, entityId);\n\t\tfor (let i = 0, length = historyItems.length; i < length; i++)\n\t\t{\n\t\t\tthis._history.deleteItem(historyItems[i]);\n\t\t}\n\n\t\tconst fixedHistoryItems = this._fixedHistory.getItemsByAssociatedEntity(BX.CrmEntityType.enumeration.activity, entityId);\n\t\tfor (let i = 0, length = fixedHistoryItems.length; i < length; i++)\n\t\t{\n\t\t\tthis._fixedHistory.deleteItem(fixedHistoryItems[i]);\n\t\t}\n\n\t\tconst scheduleItem = this._schedule.getItemByAssociatedEntity(BX.CrmEntityType.enumeration.activity, entityId);\n\t\tif (scheduleItem)\n\t\t{\n\t\t\tthis._schedule.deleteItem(scheduleItem);\n\t\t}\n\t}\n\n\tprocessCommentExternalAdd(params)\n\t{\n\t\tlet historyItemData, historyItem;\n\t\thistoryItemData = BX.prop.getObject(params, \"HISTORY_ITEM\", null);\n\t\tif (historyItemData !== null)\n\t\t{\n\t\t\twindow.setTimeout(\n\t\t\t\tBX.delegate(function () {\n\t\t\t\t\tif (!this._history.findItemById(historyItemData['ID']))\n\t\t\t\t\t{\n\t\t\t\t\t\thistoryItem = this.addHistoryItem(historyItemData);\n\t\t\t\t\t\tExpand.create(historyItem.getWrapper(), null).run();\n\t\t\t\t\t}\n\t\t\t\t}, this),\n\t\t\t\t1500\n\t\t\t);\n\t\t}\n\t}\n\n\tprocessCommentExternalUpdate(params)\n\t{\n\t\tconst entityId = BX.prop.getInteger(params, \"ENTITY_ID\", 0);\n\t\tconst historyItemData = BX.prop.getObject(params, \"HISTORY_ITEM\", null);\n\t\tconst updateItem = this._history.findItemById(entityId);\n\t\tif (updateItem instanceof Comment && historyItemData !== null)\n\t\t{\n\t\t\tupdateItem.setData(historyItemData);\n\t\t\tupdateItem.switchToViewMode();\n\t\t}\n\t\tconst updateFixedItem = this._fixedHistory.findItemById(entityId);\n\t\tif (updateFixedItem instanceof Comment && historyItemData !== null)\n\t\t{\n\t\t\tupdateFixedItem.setData(historyItemData);\n\t\t\tupdateFixedItem.switchToViewMode();\n\t\t}\n\t}\n\n\tprocessCommentExternalDelete(params)\n\t{\n\t\tconst entityId = BX.prop.getInteger(params, \"ENTITY_ID\", 0);\n\t\twindow.setTimeout(\n\t\t\tBX.delegate(function () {\n\t\t\t\tconst deleteItem = this._history.findItemById(entityId);\n\t\t\t\tif (deleteItem instanceof Comment)\n\t\t\t\t{\n\t\t\t\t\tthis._history.deleteItem(deleteItem);\n\t\t\t\t}\n\t\t\t\tconst deleteFixedItem = this._fixedHistory.findItemById(entityId);\n\t\t\t\tif (deleteFixedItem instanceof Comment)\n\t\t\t\t{\n\t\t\t\t\tthis._fixedHistory.deleteItem(deleteFixedItem);\n\t\t\t\t}\n\t\t\t}, this),\n\t\t\t1200\n\t\t);\n\t}\n\n\tprocessChangeBinding(params)\n\t{\n\t\tconst entityId = BX.prop.getString(params, \"OLD_ID\", 0);\n\t\tconst entityNewId = BX.prop.getString(params, \"NEW_ID\", 0);\n\t\tconst item = this._history.findItemById(entityId);\n\t\tif (item instanceof Item)\n\t\t{\n\t\t\titem._id = entityNewId;\n\t\t\tconst itemData = item.getData();\n\t\t\titemData.ID = entityNewId;\n\t\t\titem.setData(itemData);\n\t\t}\n\n\t\tconst fixedItem = this._fixedHistory.findItemById(entityId);\n\t\tif (fixedItem instanceof Item)\n\t\t{\n\t\t\tfixedItem._id = entityNewId;\n\t\t\tconst fixedItemData = fixedItem.getData();\n\t\t\tfixedItemData.ID = entityNewId;\n\t\t\tfixedItem.setData(fixedItemData);\n\t\t}\n\t}\n\n\tprocessItemExternalUpdate(params)\n\t{\n\t\tconst entityId = BX.prop.getInteger(params, \"ENTITY_ID\", 0);\n\t\tconst historyItemData = BX.prop.getObject(params, \"HISTORY_ITEM\", null);\n\t\tconst historyItem = this._history.findItemById(entityId);\n\t\tif (historyItem && historyItemData !== null)\n\t\t{\n\t\t\thistoryItem.setData(historyItemData);\n\t\t\thistoryItem.markAsTerminated(this._history.checkItemForTermination(historyItem));\n\t\t\thistoryItem.refreshLayout();\n\t\t\tif (historyItem.isTerminated())\n\t\t\t{\n\t\t\t\tBX.addClass(historyItem._wrapper, \"crm-entity-stream-section-last\");\n\t\t\t}\n\t\t}\n\t}\n\n\tprocessWaitExternalAdd(params)\n\t{\n\t\tconst scheduleItemData = BX.prop.getObject(params, \"SCHEDULE_ITEM\", null);\n\t\tif (scheduleItemData !== null)\n\t\t{\n\t\t\tthis.addScheduleItem(scheduleItemData);\n\t\t}\n\t}\n\n\tprocessWaitExternalUpdate(params)\n\t{\n\t\tlet entityData, scheduleItemData, scheduleItem, historyItemData, historyItem;\n\n\t\tentityData = BX.prop.getObject(params, \"ENTITY\", null);\n\t\tscheduleItemData = BX.prop.getObject(params, \"SCHEDULE_ITEM\", null);\n\t\thistoryItemData = BX.prop.getObject(params, \"HISTORY_ITEM\", null);\n\n\t\tif (entityData)\n\t\t{\n\t\t\tif (historyItemData && !BX.type.isPlainObject(historyItemData[\"ASSOCIATED_ENTITY\"]))\n\t\t\t{\n\t\t\t\thistoryItemData[\"ASSOCIATED_ENTITY\"] = entityData;\n\t\t\t}\n\n\t\t\tconst entityId = BX.prop.getInteger(entityData, \"ID\", 0);\n\t\t\tconst historyItems = this._history.getItemsByAssociatedEntity(BX.CrmEntityType.enumeration.wait, entityId);\n\t\t\tlet i = 0;\n\t\t\tconst length = historyItems.length;\n\t\t\tfor (; i < length; i++)\n\t\t\t{\n\t\t\t\thistoryItem = historyItems[i];\n\t\t\t\thistoryItem.setAssociatedEntityData(entityData);\n\t\t\t\thistoryItem.refreshLayout();\n\t\t\t}\n\t\t}\n\n\t\tif (scheduleItemData !== null)\n\t\t{\n\t\t\tscheduleItem = this._schedule.getItemByAssociatedEntity(\n\t\t\t\tBX.CrmEntityType.enumeration.wait,\n\t\t\t\tBX.prop.getInteger(scheduleItemData, \"ASSOCIATED_ENTITY_ID\")\n\t\t\t);\n\t\t\tif (!scheduleItem)\n\t\t\t{\n\t\t\t\tthis.addScheduleItem(scheduleItemData);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tscheduleItem.setData(scheduleItemData);\n\t\t\t\tif (!scheduleItem.isDone())\n\t\t\t\t{\n\t\t\t\t\tthis._schedule.refreshItem(scheduleItem);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tif (historyItemData)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis._schedule.transferItemToHistory(\n\t\t\t\t\t\t\tscheduleItem,\n\t\t\t\t\t\t\thistoryItemData\n\t\t\t\t\t\t);\n\t\t\t\t\t\t//History data are already processed\n\t\t\t\t\t\thistoryItemData = null;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis._schedule.deleteItem(scheduleItem);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (historyItemData !== null)\n\t\t{\n\t\t\thistoryItem = this._history.findItemById(BX.prop.getString(historyItemData, \"ID\"));\n\t\t\tif (!historyItem)\n\t\t\t{\n\t\t\t\thistoryItem = this.addHistoryItem(historyItemData);\n\t\t\t\tExpand.create(historyItem.getWrapper(), null).run();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\thistoryItem.setData(historyItemData);\n\t\t\t\thistoryItem.refreshLayout();\n\t\t\t}\n\t\t}\n\t}\n\n\tprocessWaitExternalDelete(params)\n\t{\n\t\tconst entityId = BX.prop.getInteger(params, \"ENTITY_ID\", 0);\n\t\tconst historyItems = this._history.getItemsByAssociatedEntity(BX.CrmEntityType.enumeration.wait, entityId);\n\t\tlet i = 0;\n\t\tconst length = historyItems.length;\n\t\tfor (; i < length; i++)\n\t\t{\n\t\t\tthis._history.deleteItem(historyItems[i]);\n\t\t}\n\n\t\tconst scheduleItem = this._schedule.getItemByAssociatedEntity(BX.CrmEntityType.enumeration.wait, entityId);\n\t\tif (scheduleItem)\n\t\t{\n\t\t\tthis._schedule.deleteItem(scheduleItem);\n\t\t}\n\t}\n\n\tprocessBizprocStatus(params)\n\t{\n\t\tlet historyItemData, historyItem;\n\n\t\thistoryItemData = BX.prop.getObject(params, \"HISTORY_ITEM\", null);\n\n\t\tif (historyItemData !== null)\n\t\t{\n\t\t\thistoryItem = this.addHistoryItem(historyItemData);\n\t\t\tExpand.create(historyItem.getWrapper(), null).run();\n\t\t}\n\t}\n\n\tprocessScoringExternalAdd(params)\n\t{\n\t\tlet historyItemData, historyItem;\n\t\thistoryItemData = BX.prop.getObject(params, \"HISTORY_ITEM\", null);\n\t\tif (historyItemData !== null)\n\t\t{\n\t\t\thistoryItem = this.addHistoryItem(historyItemData);\n\t\t\tExpand.create(historyItem.getWrapper(), null).run();\n\t\t}\n\t}\n\n\tonEntityProgressChange(sender, eventArgs)\n\t{\n\t\tif (BX.prop.getInteger(eventArgs, \"entityTypeId\", 0) !== this._ownerTypeId\n\t\t\t|| BX.prop.getInteger(eventArgs, \"entityId\", 0) !== this._ownerId\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst semantics = BX.prop.getString(eventArgs, \"semantics\", \"\");\n\t\tif (semantics === this._progressSemantics)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis._progressSemantics = semantics;\n\t\tthis._schedule.refreshLayout();\n\t}\n\n\tgetId()\n\t{\n\t\treturn this._id;\n\t}\n\n\tgetSetting(name, defaultval)\n\t{\n\t\treturn this._settings.hasOwnProperty(name) ? this._settings[name] : defaultval;\n\t}\n\n\tgetOwnerTypeId()\n\t{\n\t\treturn this._ownerTypeId;\n\t}\n\n\tgetOwnerId()\n\t{\n\t\treturn this._ownerId;\n\t}\n\n\tgetOwnerInfo()\n\t{\n\t\treturn this._ownerInfo;\n\t}\n\n\tisStubCounterEnabled()\n\t{\n\t\tif (this.getSetting('enableTodo', false))\n\t\t{\n\t\t\treturn false; // do not show counter for new scenarios\n\t\t}\n\t\tif (this._ownerId <= 0)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\treturn (\n\t\t\t(this._ownerTypeId === BX.CrmEntityType.enumeration.deal || this._ownerTypeId === BX.CrmEntityType.enumeration.lead)\n\t\t\t&& this._progressSemantics === \"process\"\n\t\t);\n\t}\n\n\tgetSchedule()\n\t{\n\t\treturn this._schedule;\n\t}\n\n\tgetHistory()\n\t{\n\t\treturn this._history;\n\t}\n\n\tgetFixedHistory()\n\t{\n\t\treturn this._fixedHistory;\n\t}\n\n\tgetWaitEditor()\n\t{\n\t\treturn this._waitEditor;\n\t}\n\n\tgetSmsEditor()\n\t{\n\t\treturn this._smsEditor;\n\t}\n\n\tgetTodoEditor()\n\t{\n\t\treturn this._todoEditor;\n\t}\n\n\tgetMenuBar(): ?MenuBar\n\t{\n\t\treturn this._menuBar;\n\t}\n\n\tprocessSheduleLayoutChange()\n\t{\n\t}\n\n\tprocessHistoryLayoutChange()\n\t{\n\t\tthis._schedule.refreshLayout();\n\t}\n\n\tprocessEditingCompletion(editor)\n\t{\n\t\tif (this._waitEditor && editor === this._waitEditor)\n\t\t{\n\t\t\tthis._waitEditor.setVisible(false);\n\t\t}\n\t\tif (this._smsEditor && editor === this._smsEditor)\n\t\t{\n\t\t\tthis._smsEditor.setVisible(false);\n\t\t}\n\t\tif (this._commentEditor && editor === this._commentEditor && this._todoEditor)\n\t\t{\n\t\t\tthis._commentEditor.setVisible(false);\n\t\t}\n\n\t\tif (this._todoEditor)\n\t\t{\n\t\t\tthis._todoEditor.setVisible(true);\n\t\t\tthis._menuBar.setActiveItemById('todo');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis._commentEditor.setVisible(true);\n\t\t\tthis._menuBar.setActiveItemById('comment');\n\t\t}\n\t}\n\n\tprocessEditingCancellation(editor)\n\t{\n\t\tif (this._waitEditor && editor === this._waitEditor)\n\t\t{\n\t\t\tthis._waitEditor.setVisible(false);\n\t\t}\n\t\tif (this._smsEditor && editor === this._smsEditor)\n\t\t{\n\t\t\tthis._smsEditor.setVisible(false);\n\t\t}\n\t\tif (this._commentEditor && editor === this._commentEditor && this._todoEditor)\n\t\t{\n\t\t\tthis._commentEditor.setVisible(false);\n\t\t}\n\n\t\tif (this._todoEditor)\n\t\t{\n\t\t\tthis._todoEditor.setVisible(true);\n\t\t\tthis._menuBar.setActiveItemById('todo');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis._commentEditor.setVisible(true);\n\t\t\tthis._menuBar.setActiveItemById('comment');\n\t\t}\n\t}\n\n\taddScheduleItem(data)\n\t{\n\t\tconst item = this._schedule.createItem(data);\n\t\tconst index = this._schedule.calculateItemIndex(item);\n\t\tconst anchor = this._schedule.createAnchor(index);\n\t\tthis._schedule.addItem(item, index);\n\t\titem.layout({anchor: anchor});\n\n\t\treturn item;\n\t}\n\n\taddHistoryItem(data)\n\t{\n\t\tconst item = this._history.createItem(data);\n\t\tconst index = this._history.calculateItemIndex(item);\n\t\tconst historyAnchor = this._history.createAnchor(index);\n\t\tthis._history.addItem(item, index);\n\t\titem.layout({anchor: historyAnchor});\n\n\t\treturn item;\n\t}\n\n\trenderAudioDummy(durationText, onClick)\n\t{\n\t\treturn BX.create(\"DIV\", {\n\t\t\tattrs: {className: \"crm-audio-cap-wrap-container\"},\n\t\t\tchildren: [\n\t\t\t\tBX.create(\"DIV\", {\n\t\t\t\t\tattrs: {className: \"crm-audio-cap-wrap\"},\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"DIV\", {\n\t\t\t\t\t\t\t\tattrs: {className: \"crm-audio-cap-time\"},\n\t\t\t\t\t\t\t\ttext: durationText\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t],\n\t\t\t\t\tevents: {click: onClick}\n\t\t\t\t})\n\t\t\t]\n\t\t});\n\t}\n\n\tloadMediaPlayer(id, filePath, mediaType, node, duration, options)\n\t{\n\t\tif (!duration)\n\t\t{\n\t\t\tduration = 0;\n\t\t}\n\t\tif (!options)\n\t\t{\n\t\t\toptions = {};\n\t\t}\n\t\tconst player = new BX.Fileman.Player(id, {\n\t\t\tsources: [\n\t\t\t\t{\n\t\t\t\t\tsrc: filePath,\n\t\t\t\t\ttype: mediaType\n\t\t\t\t}\n\t\t\t],\n\t\t\tisAudio: !options.video,\n\t\t\tskin: options.hasOwnProperty('skin') ? options.skin : 'vjs-timeline_player-skin',\n\t\t\twidth: options.width || 350,\n\t\t\theight: options.height || 30,\n\t\t\tduration: duration,\n\t\t\tplaybackRate: options.playbackRate || null,\n\t\t\tonInit: function (player) {\n\t\t\t\tplayer.vjsPlayer.controlBar.removeChild('timeDivider');\n\t\t\t\tplayer.vjsPlayer.controlBar.removeChild('durationDisplay');\n\t\t\t\tplayer.vjsPlayer.controlBar.removeChild('fullscreenToggle');\n\t\t\t\tplayer.vjsPlayer.controlBar.addChild('timeDivider');\n\t\t\t\tplayer.vjsPlayer.controlBar.addChild('durationDisplay');\n\t\t\t\tif (!player.isPlaying())\n\t\t\t\t{\n\t\t\t\t\tplayer.play();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tBX.cleanNode(node, false);\n\t\tnode.appendChild(player.createElement());\n\t\tplayer.init();\n\t\t// todo remove this after player will be able to get float playbackRate\n\t\tif (options.playbackRate > 1)\n\t\t{\n\t\t\tplayer.vjsPlayer.playbackRate(options.playbackRate);\n\t\t}\n\t\treturn player;\n\t}\n\n\tonActivityCreated(activity, data)\n\t{\n\t\t//Already processed in onPullEvent\n\t}\n\n\tisSpotlightShowed()\n\t{\n\t\treturn this._spotlightFastenShowed;\n\t}\n\n\tsetSpotlightShowed()\n\t{\n\t\tthis._spotlightFastenShowed = true;\n\t}\n\n\tgetCurrentUser(): ?Object\n\t{\n\t\treturn this._currentUser;\n\t}\n\n\tgetAudioPlaybackRateSelector()\n\t{\n\t\tif (!this.audioPlaybackRateSelector)\n\t\t{\n\t\t\tthis.audioPlaybackRateSelector = new AudioPlaybackRateSelector({\n\t\t\t\tname: 'timeline_audio_playback',\n\t\t\t\tcurrentRate: this._audioPlaybackRate,\n\t\t\t\tavailableRates: [\n\t\t\t\t\t{\n\t\t\t\t\t\trate: 1,\n\t\t\t\t\t\thtml: BX.Loc.getMessage('CRM_TIMELINE_PLAYBACK_RATE_SELECTOR_RATE_1')\n\t\t\t\t\t\t\t.replace('#RATE#', '<span class=\"crm-audio-cap-speed-param\">1x</span>')\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\trate: 1.5,\n\t\t\t\t\t\thtml: BX.Loc.getMessage('CRM_TIMELINE_PLAYBACK_RATE_SELECTOR_RATE_1.5')\n\t\t\t\t\t\t\t.replace('#RATE#', '<span class=\"crm-audio-cap-speed-param\">1.5x</span>')\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\trate: 2,\n\t\t\t\t\t\thtml: BX.Loc.getMessage('CRM_TIMELINE_PLAYBACK_RATE_SELECTOR_RATE_2')\n\t\t\t\t\t\t\t.replace('#RATE#', '<span class=\"crm-audio-cap-speed-param\">2x</span>')\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\trate: 3,\n\t\t\t\t\t\thtml: BX.Loc.getMessage('CRM_TIMELINE_PLAYBACK_RATE_SELECTOR_RATE_3')\n\t\t\t\t\t\t\t.replace('#RATE#', '<span class=\"crm-audio-cap-speed-param\">3x</span>')\n\t\t\t\t\t}\n\t\t\t\t],\n\t\t\t\ttextMessageCode: 'CRM_TIMELINE_PLAYBACK_RATE_SELECTOR_TEXT'\n\t\t\t});\n\t\t}\n\n\t\treturn this.audioPlaybackRateSelector;\n\t}\n\n\thasScheduledItems(): boolean\n\t{\n\t\treturn this._schedule.getItems().length > 0;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Manager();\n\t\tself.initialize(id, settings);\n\t\tManager.instances[self.getId()] = self;\n\t\treturn self;\n\t}\n\n\tstatic getDefault(): ?Manager\n\t{\n\t\treturn Manager.#defaultInstance;\n\t}\n\tstatic setDefault(instance): void\n\t{\n\t\tManager.#defaultInstance = instance;\n\t}\n\n\tstatic getById(id): ?Manager\n\t{\n\t\treturn Manager.instances[id] || null;\n\t}\n\n\tstatic #defaultInstance = null;\n\tstatic instances = {};\n}\n","/** @memberof BX.Crm.Timeline.Tools */\nexport const SmsWatcher =\n{\n\t_pullTagName: 'MESSAGESERVICE',\n\t_pullInited: false,\n\t_listeners: {},\n\tinitPull: function()\n\t{\n\t\tif (this._pullInited)\n\t\t\treturn;\n\n\t\tBX.addCustomEvent(\"onPullEvent-messageservice\", this.onPullEvent.bind(this));\n\t\tthis.extendWatch();\n\n\t\tthis._pullInited = true;\n\t},\n\tsubscribeOnMessageUpdate: function(messageId, callback)\n\t{\n\t\tthis.initPull();\n\t\tthis._listeners[messageId] = callback;\n\t},\n\tfireExternalStatusUpdate: function(messageId, message)\n\t{\n\t\tconst listener = this._listeners[messageId];\n\t\tif (listener)\n\t\t{\n\t\t\tlistener(message);\n\t\t}\n\t},\n\tonPullEvent: function(command, params)\n\t{\n\t\t// console.log(command, params);\n\t\tif (command === 'message_update')\n\t\t{\n\t\t\tfor (let i = 0; i < params.messages.length; ++i)\n\t\t\t{\n\t\t\t\tconst message = params.messages[i];\n\t\t\t\tthis.fireExternalStatusUpdate(message['ID'], message);\n\t\t\t}\n\t\t}\n\t},\n\textendWatch: function()\n\t{\n\t\tif(BX.type.isFunction(BX.PULL))\n\t\t{\n\t\t\tBX.PULL.extendWatch(this._pullTagName);\n\t\t\twindow.setTimeout(this.extendWatch.bind(this), 60000);\n\t\t}\n\t}\n};","import Activity from \"./activity\";\n\n/** @memberof BX.Crm.Timeline.Actions */\nexport default class SchedulePostpone extends Activity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._button = null;\n\t\tthis._clickHandler = BX.delegate(this.onClick, this);\n\t\tthis._isMenuShown = false;\n\n\t\tthis._menu = false;\n\t}\n\n\tdoLayout()\n\t{\n\t\tthis._button = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs:\n\t\t\t\t\t{\n\t\t\t\t\t\tclassName: this._isEnabled\n\t\t\t\t\t\t\t? \"crm-entity-stream-planned-action-aside\"\n\t\t\t\t\t\t\t: \"crm-entity-stream-planned-action-aside-disabled\"\n\t\t\t\t\t},\n\t\t\t\ttext: this.getMessage(\"postpone\")\n\t\t\t}\n\t\t);\n\n\t\tif(this._isEnabled)\n\t\t{\n\t\t\tBX.bind(this._button, \"click\", this._clickHandler)\n\t\t}\n\n\t\tthis._container.appendChild(this._button);\n\t}\n\n\topenMenu()\n\t{\n\t\tif(this._isMenuShown)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst handler = BX.delegate(this.onMenuItemClick, this);\n\t\tconst menuItems =\n\t\t\t[\n\t\t\t\t{id: \"hour_1\", text: this.getMessage(\"forOneHour\"), onclick: handler},\n\t\t\t\t{id: \"hour_2\", text: this.getMessage(\"forTwoHours\"), onclick: handler},\n\t\t\t\t{id: \"hour_3\", text: this.getMessage(\"forThreeHours\"), onclick: handler},\n\t\t\t\t{id: \"day_1\", text: this.getMessage(\"forOneDay\"), onclick: handler},\n\t\t\t\t{id: \"day_2\", text: this.getMessage(\"forTwoDays\"), onclick: handler},\n\t\t\t\t{id: \"day_3\", text: this.getMessage(\"forThreeDays\"), onclick: handler}\n\t\t\t];\n\n\t\tBX.PopupMenu.show(\n\t\t\tthis._id,\n\t\t\tthis._button,\n\t\t\tmenuItems,\n\t\t\t{\n\t\t\t\toffsetTop: 0,\n\t\t\t\toffsetLeft: 16,\n\t\t\t\tevents:\n\t\t\t\t\t{\n\t\t\t\t\t\tonPopupShow: BX.delegate(this.onMenuShow, this),\n\t\t\t\t\t\tonPopupClose: BX.delegate(this.onMenuClose, this),\n\t\t\t\t\t\tonPopupDestroy: BX.delegate(this.onMenuDestroy, this)\n\t\t\t\t\t}\n\t\t\t}\n\t\t);\n\n\t\tthis._menu = BX.PopupMenu.currentItem;\n\t}\n\n\tcloseMenu()\n\t{\n\t\tif(!this._isMenuShown)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif(this._menu)\n\t\t{\n\t\t\tthis._menu.close();\n\t\t}\n\t}\n\n\tonClick()\n\t{\n\t\tif(!this._isEnabled)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif(this._isMenuShown)\n\t\t{\n\t\t\tthis.closeMenu();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.openMenu();\n\t\t}\n\t}\n\n\tonMenuItemClick(e, item)\n\t{\n\t\tthis.closeMenu();\n\n\t\tlet offset = 0;\n\t\tif(item.id === \"hour_1\")\n\t\t{\n\t\t\toffset = 3600;\n\t\t}\n\t\telse if(item.id === \"hour_2\")\n\t\t{\n\t\t\toffset = 7200;\n\t\t}\n\t\telse if(item.id === \"hour_3\")\n\t\t{\n\t\t\toffset = 10800;\n\t\t}\n\t\telse if(item.id === \"day_1\")\n\t\t{\n\t\t\toffset = 86400;\n\t\t}\n\t\telse if(item.id === \"day_2\")\n\t\t{\n\t\t\toffset = 172800;\n\t\t}\n\t\telse if(item.id === \"day_3\")\n\t\t{\n\t\t\toffset = 259200;\n\t\t}\n\n\t\tif(offset > 0 && this._item)\n\t\t{\n\t\t\tthis._item.postpone(offset);\n\t\t}\n\t}\n\n\tonMenuShow()\n\t{\n\t\tthis._isMenuShown = true;\n\t}\n\n\tonMenuClose()\n\t{\n\t\tif(this._menu && this._menu.popupWindow)\n\t\t{\n\t\t\tthis._menu.popupWindow.destroy();\n\t\t}\n\t}\n\n\tonMenuDestroy()\n\t{\n\t\tthis._isMenuShown = false;\n\t\tthis._menu = null;\n\n\t\tif(typeof(BX.PopupMenu.Data[this._id]) !== \"undefined\")\n\t\t{\n\t\t\tdelete(BX.PopupMenu.Data[this._id]);\n\t\t}\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = SchedulePostpone.messages;\n\t\treturn m.hasOwnProperty(name) ? m[name] : name;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new SchedulePostpone();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n\n\tstatic messages = {};\n}\n","import Shift from \"./shift\";\n\n/** @memberof BX.Crm.Timeline.Animation */\nexport default class Comment\n{\n\tconstructor()\n\t{\n\t\tthis._node = null;\n\t\tthis._anchor = null;\n\t\tthis._nodeParent  = null;\n\t\tthis._startPosition = null;\n\t\tthis._events = null;\n\t}\n\n\tinitialize(node, anchor, startPosition, events)\n\t{\n\t\tthis._node = node;\n\t\tthis._anchor = anchor;\n\t\tthis._nodeParent  = node.parentNode;\n\t\tthis._startPosition = startPosition;\n\t\tthis._events = BX.type.isPlainObject(events) ? events : {};\n\n\t}\n\n\trun()\n\t{\n\t\tBX.addClass(this._node, 'crm-entity-stream-section-animate-start');\n\n\t\tthis._node.style.position = \"absolute\";\n\t\tthis._node.style.width = this._startPosition.width + \"px\";\n\t\tthis._node.style.height = this._startPosition.height + \"px\";\n\t\tthis._node.style.top = this._startPosition.top - 30 + \"px\";\n\t\tthis._node.style.left = this._startPosition.left + \"px\";\n\t\tthis._node.style.opacity = 0;\n\t\tthis._node.style.zIndex = 960;\n\n\t\tdocument.body.appendChild(this._node);\n\n\t\tconst nodeOpacityAnim = new BX.easing({\n\t\t\tduration: 350,\n\t\t\tstart: {opacity: 0},\n\t\t\tfinish: {opacity: 100},\n\t\t\ttransition: BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\tstep: BX.proxy(function (state) {\n\t\t\t\tthis._node.style.opacity = state.opacity / 100;\n\t\t\t}, this),\n\t\t\tcomplete: BX.proxy(function () {\n\t\t\t\tif (BX.type.isFunction(this._events[\"start\"]))\n\t\t\t\t{\n\t\t\t\t\tthis._events[\"start\"]();\n\t\t\t\t}\n\t\t\t\tconst shift = Shift.create(\n\t\t\t\t\tthis._node,\n\t\t\t\t\tthis._anchor,\n\t\t\t\t\tthis._startPosition,\n\t\t\t\t\tfalse,\n\t\t\t\t\t{complete: BX.delegate(this.finish, this)}\n\t\t\t\t);\n\t\t\t\tshift.run();\n\t\t\t}, this)\n\t\t});\n\t\tnodeOpacityAnim.animate();\n\n\n\t\tif(BX.type.isFunction(this._events[\"complete\"]))\n\t\t{\n\t\t\tthis._events[\"complete\"]();\n\t\t}\n\t}\n\n\tfinish()\n\t{\n\t\tthis._node.style.position = \"\";\n\t\tthis._node.style.width = \"\";\n\t\tthis._node.style.height = \"\";\n\t\tthis._node.style.top = \"\";\n\t\tthis._node.style.left = \"\";\n\t\tthis._node.style.opacity = \"\";\n\t\tthis._node.style.zIndex = \"\";\n\t\tthis._anchor.style.height = \"\";\n\t\tthis._anchor.parentNode.insertBefore(this._node, this._anchor.nextSibling);\n\t\tsetTimeout(\n\t\t\tBX.delegate(function() {\n\t\t\t\tBX.removeClass(this._node, 'crm-entity-stream-section-animate-start');\n\t\t\t\tBX.remove(this._anchor);\n\t\t\t}, this),\n\t\t\t0\n\t\t);\n\t}\n\n\tstatic create(node, anchor, startPosition, events)\n\t{\n\t\tconst self = new Comment();\n\t\tself.initialize(node, anchor, startPosition, events);\n\t\treturn self;\n\t}\n}\n","import {Vue} from 'ui.vue';\nimport {Loc} from 'main.core';\nimport HistoryItemMixin from '../../mixins/history-item';\nimport ProductListMixin from '../../mixins/product-list';\nimport ProductList from '../../components/product/product-list';\n\nexport default Vue.extend({\n\tmixins: [HistoryItemMixin, ProductListMixin],\n\tcomponents: {\n\t\t'product-list': ProductList,\n\t},\n\tcreated() {\n\t\tthis.products = this.data.SENT_PRODUCTS;\n\t\tthis.dealId = this.data.DEAL_ID;\n\t\tthis.productsGrid = null;\n\t\tthis.subscribeCustomEvents();\n\t\tBX.Crm.EntityEditor.getDefault().tapController('PRODUCT_LIST', (controller) => {\n\t\t\tthis.setProductsGrid(controller.getProductList());\n\t\t});\n\t},\n\tcomputed: {\n\t\tshowProductLink()\n\t\t{\n\t\t\treturn this.data.showProductLink === undefined || this.data.showProductLink === true;\n\t\t}\n\t},\n\tmethods: {\n\t\tisAddToDealVisible()\n\t\t{\n\t\t\treturn this.isProductsGridAvailable() && this.data.canAddProductToDeal === true;\n\t\t},\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"crm-entity-stream-section crm-entity-stream-section-history crm-entity-stream-section-history crm-entity-stream-section-advice\">\n\t\t\t<div class=\"crm-entity-stream-section-icon crm-entity-stream-section-icon-advice\"></div>\n\t\t\t<div class=\"crm-entity-stream-advice-content\">\n\t\t\t\t<div class=\"crm-entity-stream-advice-info\">\n\t\t\t\t\t${Loc.getMessage('CRM_TIMELINE_PRODUCT_COMPILATION_LIST_COMPILATION_SENT')}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"crm-entity-stream-advice-inner\">\n\t\t\t\t\t<!--<ul class=\"crm-entity-stream-advice-list\">-->\n\t\t\t\t\t<product-list\n\t\t\t\t\t\t:products=\"products\"\n\t\t\t\t\t\t:dealId=\"dealId\"\n\t\t\t\t\t\t:isAddToDealVisible=\"isAddToDealVisible()\"\n\t\t\t\t\t\t:showProductLink=\"showProductLink\"\n\t\t\t\t\t\t@product-added-to-deal=\"handleProductAddedToDeal\"\n\t\t\t\t\t\t@product-adding-to-deal=\"handleProductAddingToDeal\"\n\t\t\t\t\t></product-list>\n\t\t\t\t\t<!--</ul>-->\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`\n});\n","import {Vue} from 'ui.vue';\nimport {Loc} from 'main.core';\nimport HistoryItemMixin from '../../mixins/history-item';\n\nexport default Vue.extend({\n\tmixins: [HistoryItemMixin],\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"crm-entity-stream-section crm-entity-stream-section-history crm-entity-stream-section-advice\">\n\t\t\t<div class=\"crm-entity-stream-section-icon crm-entity-stream-section-icon-advice\"></div>\n\t\t\t<div class=\"crm-entity-stream-advice-content\">\n\t\t\t\t<div class=\"crm-entity-stream-advice-info\">\n\t\t\t\t\t${Loc.getMessage('CRM_TIMELINE_PRODUCT_COMPILATION_ORDER_EXISTS_NOTICE')}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`\n});\n","import {Vue} from 'ui.vue';\nimport {Loc} from 'main.core';\nimport HistoryItemMixin from '../../mixins/history-item';\n\nexport default Vue.extend({\n\tmixins: [HistoryItemMixin],\n\tcomputed: {\n\t\tlegend()\n\t\t{\n\t\t\tvar compilationCreationDate = BX.prop.getString(this.data, 'COMPILATION_CREATION_DATE', '');\n\t\t\tvar legendTextTemplate = Loc.getMessage('CRM_TIMELINE_PRODUCT_COMPILATION_VIEWED_LEGEND');\n\n\t\t\treturn legendTextTemplate.replace('#DATE_CREATE#', compilationCreationDate);\n\t\t},\n\t\tauthorFormattedName()\n\t\t{\n\t\t\treturn this?.data?.AUTHOR?.FORMATTED_NAME;\n\t\t},\n\t\tauthorHref()\n\t\t{\n\t\t\treturn this?.data?.AUTHOR?.SHOW_URL;\n\t\t},\n\t\tauthorImageUrl()\n\t\t{\n\t\t\treturn this?.data?.AUTHOR?.IMAGE_URL;\n\t\t},\n\t\tauthorImageStyle()\n\t\t{\n\t\t\tif (this.authorImageUrl)\n\t\t\t{\n\t\t\t\treturn {\n\t\t\t\t\tbackgroundImage: \"url('\" + encodeURI(this.authorImageUrl) + \"')\",\n\t\t\t\t\tbackgroundSize: '21px',\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn {};\n\t\t}\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"crm-entity-stream-section crm-entity-stream-section-history\">\n\t\t\t<div class=\"crm-entity-stream-section-icon crm-entity-stream-section-icon-info\"></div>\n\t\t\t<div class=\"crm-entity-stream-section-content\">\n\t\t\t\t<div class=\"crm-entity-stream-content-event\">\n\t\t\t\t\t<div class=\"crm-entity-stream-content-header\">\n\t\t\t\t\t\t<div class=\"crm-entity-stream-content-event-title\">\n\t\t\t\t\t\t\t${Loc.getMessage('CRM_TIMELINE_PRODUCT_COMPILATION_TITLE')}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<span class=\"crm-entity-stream-content-event-done\">\n\t\t\t\t\t\t\t${Loc.getMessage('CRM_TIMELINE_PRODUCT_COMPILATION_VIEWED')}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<span class=\"crm-entity-stream-content-event-time\">{{createdAt}}</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"crm-entity-stream-content-detail\">\n\t\t\t\t\t\t<div class=\"crm-entity-stream-content-detail-description\">\n\t\t\t\t\t\t\t${Loc.getMessage('CRM_TIMELINE_PRODUCT_COMPILATION_VIEWED_DESCRIPTION')}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t\t<a\n\t\t\t\t\t\t\tclass=\"ui-icon ui-icon-common-user crm-entity-stream-content-detail-employee\" \n\t\t\t\t\t\t\tv-bind:title=\"authorFormattedName\"\n\t\t\t\t\t\t\ttarget=\"_blank\"\n\t\t\t\t\t\t\tv-bind:href=\"authorHref\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<i :style=\"authorImageStyle\"></i>\n\t\t\t\t\t\t</a>\n\t\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`\n});\n","import {Vue} from 'ui.vue';\nimport {Loc} from 'main.core';\nimport HistoryItemMixin from '../../mixins/history-item';\n\nexport default Vue.extend({\n\tmixins: [HistoryItemMixin],\n\tcomputed: {\n\t\tmessage()\n\t\t{\n\t\t\tconst dealTitle = BX.util.htmlspecialchars(this?.data?.NEW_DEAL_DATA?.TITLE);\n\t\t\tconst dealLegend = this?.data?.NEW_DEAL_DATA?.LEGEND;\n\t\t\tconst dealUrl = this?.data?.NEW_DEAL_DATA?.SHOW_URL;\n\t\t\tconst dealTitleLink = `<a href=\"${dealUrl}\">${dealTitle}</a>`;\n\t\t\tlet message = Loc.getMessage('CRM_TIMELINE_PRODUCT_COMPILATION_DEAL_CREATED');\n\t\t\tmessage = message.replace('#DEAL_TITLE#', dealTitleLink);\n\t\t\tmessage = message.replace('#DEAL_LEGEND#', dealLegend);\n\n\t\t\treturn message;\n\t\t},\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"crm-entity-stream-section crm-entity-stream-section-history crm-entity-stream-section-advice\">\n\t\t\t<div class=\"crm-entity-stream-section-icon crm-entity-stream-section-icon-advice\"></div>\n\t\t\t<div class=\"crm-entity-stream-advice-content\">\n\t\t\t\t<div class=\"crm-entity-stream-advice-info\" v-html=\"message\">\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`\n});\n","import EncourageBuyProducts from './encourage-buy-products/component';\nimport Notification from './notification/component';\nimport DeliveryActivity from './delivery-activity/component';\nimport DeliveryMessage from './delivery-message/component';\nimport DeliveryCalculation from './delivery-calculation/component';\nimport Manager from \"./manager\";\nimport Stream from \"./stream\";\nimport Editor from \"./editor\";\nimport History from \"./streams/history\";\nimport FixedHistory from \"./streams/fixedhistory\";\nimport EntityChat from \"./streams/entitychat\";\nimport Schedule from \"./streams/schedule\";\nimport Comment from \"./editors/comment\";\nimport Wait from \"./editors/wait\";\nimport Rest from \"./editors/rest\";\nimport Sms from \"./editors/sms\";\nimport WaitConfigurationDialog from \"./tools/wait-configuration-dialog\";\nimport SchedulePostponeController from \"./tools/schedule-postpone-controller\";\nimport MenuBar from \"./tools/menubar\";\nimport {SmsWatcher} from \"./tools/sms-watcher\";\nimport AudioPlaybackRateSelector from \"./tools/audio-playback-rate-selector\";\nimport * as Types from \"./types\";\nimport Action from \"./action\";\nimport Activity from \"./actions/activity\";\nimport {Call, HistoryCall, ScheduleCall} from \"./actions/call\";\nimport {Email, HistoryEmail, ScheduleEmail} from \"./actions/email\";\nimport {OpenLine} from \"./actions/openline\";\nimport SchedulePostpone from \"./actions/schedule-postpone\";\nimport CompatibleItem from \"./items/compatible-item\";\nimport HistoryItem from \"./items/history\";\nimport HistoryActivity from \"./items/history-activity\";\nimport CommentItem from \"./items/comment\";\nimport Modification from \"./items/modification\";\nimport Mark from \"./items/mark\";\nimport Creation from \"./items/creation\";\nimport Restoration from \"./items/restoration\";\nimport Relation from \"./items/relation\";\nimport Link from \"./items/link\";\nimport Unlink from \"./items/unlink\";\nimport EmailItem from \"./items/email\";\nimport CallItem from \"./items/call\";\nimport Meeting from \"./items/meeting\";\nimport Task from \"./items/task\";\nimport WebForm from \"./items/webform\";\nimport WaitItem from \"./items/wait\";\nimport Document from \"./items/document\";\nimport Sender from \"./items/sender\";\nimport Bizproc from \"./items/bizproc\";\nimport SmsItem from \"./items/sms\";\nimport Request from \"./items/request\";\nimport RestItem from \"./items/rest\";\nimport OpenLineItem from \"./items/openline\";\nimport Zoom from \"./items/zoom\";\nimport Conversion from \"./items/conversion\";\nimport Visit from \"./items/visit\";\nimport Scoring from \"./items/scoring\";\nimport OrderCreation from \"./items/order-creation\";\nimport OrderModification from \"./items/order-modification\";\nimport StoreDocumentCreation from \"./items/store-document-creation\";\nimport StoreDocumentModification from \"./items/store-document-modification\";\nimport FinalSummaryDocuments from \"./items/final-summary-documents\";\nimport FinalSummary from \"./items/final-summary\";\nimport ExternalNoticeModification from \"./items/external-notice-modification\";\nimport ExternalNoticeStatusModification from \"./items/external-notice-status-modification\";\nimport OrderCheck from \"./items/order-check\";\nimport Scheduled from \"./items/scheduled\";\nimport ScheduledActivity from \"./items/scheduled/activity\";\nimport ScheduledEmail from \"./items/scheduled/email\";\nimport ScheduledCall from \"./items/scheduled/call\";\nimport CallTracker from \"./items/scheduled/call-tracker\";\nimport ScheduledMeeting from \"./items/scheduled/meeting\";\nimport ScheduledTask from \"./items/scheduled/task\";\nimport ScheduledStoreDocument from \"./items/scheduled/store-document\";\nimport ScheduledWebForm from \"./items/scheduled/webform\";\nimport ScheduledWait from \"./items/scheduled/wait\";\nimport ScheduledRequest from \"./items/scheduled/request\";\nimport ScheduledRest from \"./items/scheduled/rest\";\nimport ScheduledOpenLine from \"./items/scheduled/openline\";\nimport ScheduledZoom from \"./items/scheduled/zoom\";\nimport AnimationItem from \"./animations/item\";\nimport ItemNew from \"./animations/item-new\";\nimport Expand from \"./animations/expand\";\nimport Shift from \"./animations/shift\";\nimport AnimationComment from \"./animations/comment\";\nimport Fasten from \"./animations/fasten\";\nimport ProductCompilationList from './product-compilation/compilation-product-list/component';\nimport CompilationOrderNotice from './product-compilation/order-notice/component';\nimport ProductCompilationViewed from './product-compilation/compilation-viewed/component';\nimport NewDealCreated from './product-compilation/deal-created/component';\n\nconst Streams = {\n\tHistory,\n\tFixedHistory,\n\tEntityChat,\n\tSchedule,\n}\n\nconst Editors = {\n\tComment,\n\tWait,\n\tRest,\n\tSms\n}\n\nconst Tools = {\n\tWaitConfigurationDialog,\n\tSchedulePostponeController,\n\tMenuBar,\n\tSmsWatcher,\n\tAudioPlaybackRateSelector,\n}\n\nconst Actions = {\n\tActivity,\n\tCall,\n\tHistoryCall,\n\tScheduleCall,\n\tEmail,\n\tHistoryEmail,\n\tScheduleEmail,\n\tOpenLine,\n\tSchedulePostpone,\n}\n\nconst ScheduledItems = {\n\tActivity: ScheduledActivity,\n\tEmail: ScheduledEmail,\n\tCall: ScheduledCall,\n\tCallTracker,\n\tMeeting: ScheduledMeeting,\n\tTask: ScheduledTask,\n\tStoreDocument: ScheduledStoreDocument,\n\tWebForm: ScheduledWebForm,\n\tWait: ScheduledWait,\n\tRequest: ScheduledRequest,\n\tRest: ScheduledRest,\n\tOpenLine: ScheduledOpenLine,\n\tZoom: ScheduledZoom,\n}\n\nconst Items = {\n\tHistory: HistoryItem,\n\tHistoryActivity,\n\tComment: CommentItem,\n\tModification,\n\tMark,\n\tCreation,\n\tRestoration,\n\tRelation,\n\tLink,\n\tUnlink,\n\tEmail: EmailItem,\n\tCall: CallItem,\n\tMeeting,\n\tTask,\n\tWebForm,\n\tWait: WaitItem,\n\tDocument,\n\tSender,\n\tBizproc,\n\tSms: SmsItem,\n\tRequest,\n\tRest: RestItem,\n\tOpenLine: OpenLineItem,\n\tZoom,\n\tConversion,\n\tVisit,\n\tScoring,\n\tOrderCreation,\n\tOrderModification,\n\tStoreDocumentCreation,\n\tStoreDocumentModification,\n\tFinalSummaryDocuments,\n\tFinalSummary,\n\tExternalNoticeModification,\n\tExternalNoticeStatusModification,\n\tOrderCheck,\n\tScheduledBase: Scheduled,\n\tScheduled: ScheduledItems,\n}\n\nconst Animations = {\n\tItem: AnimationItem,\n\tItemNew,\n\tExpand,\n\tShift,\n\tComment: AnimationComment,\n\tFasten,\n};\n\nexport {\n\tEncourageBuyProducts,\n\tNotification,\n\tDeliveryActivity,\n\tDeliveryMessage,\n\tDeliveryCalculation,\n\tManager,\n\tStream,\n\tStreams,\n\tEditor,\n\tEditors,\n\tTools,\n\tTypes,\n\tAction,\n\tActions,\n\tItems,\n\tAnimations,\n\tCompatibleItem,\n\tProductCompilationList,\n\tCompilationOrderNotice,\n\tProductCompilationViewed,\n\tNewDealCreated,\n};\n"],"names":["Item","undefined","activity","creation","modification","link","unlink","mark","comment","wait","bizproc","conversion","sender","document","restoration","order","orderCheck","scoring","externalNotification","finalSummary","delivery","finalSummaryDocuments","storeDocument","productCompilation","signDocument","Mark","waiting","success","renew","ignored","failed","Delivery","taxiEstimationRequest","taxiCallRequest","taxiCancelledByManager","taxiCancelledByDriver","taxiPerformerNotFound","taxiSmsProviderIssue","taxiReturnedFinish","deliveryMessage","deliveryCalculation","Order","encourageBuyProducts","EditorMode","view","edit","Compilation","productList","orderExists","compilationViewed","newDealCreated","CompatibleItem","_id","_settings","_data","_container","_typeCategoryId","_associatedEntityData","_associatedEntityTypeId","_associatedEntityId","_isContextMenuShown","_contextMenuButton","_activityEditor","_actions","_actionContainer","_vueComponent","_vueComponentMountedNode","_existedStreamItemDeadLine","id","settings","_setId","getSetting","BX","type","isPlainObject","doInitialize","name","defaultval","hasOwnProperty","data","clearCachedData","prop","getInteger","associatedEntityData","ASSOCIATED_ENTITY","setData","entityData","getAssociatedEntityData","getObject","permissions","Type","PERMISSIONS","getString","getArray","ItemType","container","isElementNode","options","prepareLayout","prepareActions","actionQty","length","i","layout","showActions","mode","app","propsData","self","langMessages","messages","$mount","$el","show","isDone","text","isNumber","offset","whilespaceOffset","substring","search","clickHandler","util","htmlspecialchars","replace","create","attrs","className","href","events","click","getMessage","authorInfo","getObjectDataParam","showUrl","target","title","children","imageUrl","style","backgroundImage","encodeURI","backgroundSize","delegate","onContextMenuButtonClick","e","openContextMenu","closeContextMenu","menuItems","prepareContextMenuItems","IntranetExtensions","push","PopupMenu","offsetTop","offsetLeft","angle","position","onPopupShow","onContextMenuShow","onPopupClose","onContextMenuClose","onPopupDestroy","onContextMenuDestroy","_contextMenu","currentItem","close","addClass","popupWindow","destroy","removeClass","Data","m","TimezoneOffset","USER_TO_SERVER","Fasten","_initialItem","_finalItem","_events","isNotEmptyString","getRandomString","_anchor","defaultValue","node","getWrapper","parentNode","insertBefore","nextSibling","setTimeout","_clone","cloneNode","_startPosition","pos","width","_cloneHeight","height","_minHeight","_sumPaddingContent","top","left","zIndex","body","appendChild","proxy","_anchorPosition","finish","opacity","_difference","bottom","_deepHistoryLimit","clientHeight","_duration","Math","abs","movingEvent","easing","duration","start","transition","makeEaseOut","transitions","quart","step","state","complete","animate","addFixedHistoryItem","remove","isFunction","initialize","History","_history","_fixedHistory","_typeId","_createdTime","_isFixed","_headerClickHandler","onHeaderClick","isReadOnly","getTextDataParam","time","parseDate","getCreatedTimestamp","DatetimeConverter","toUserTime","getValue","extractDate","Date","getCreatedTime","getTime","getOwnerInfo","CrmEntityType","enumeration","typeId","getTypeId","CrmActivityStatus","isFinal","_items","fastenLimitPopup","PopupWindow","_switcher","content","message","darkMode","autoHide","closeByEsc","bindOptions","forceBindPosition","ajax","url","_serviceUrl","method","dataType","getOwnerTypeId","getOwnerId","result","ERROR","isFixed","IS_FIXED","fixedItem","createItem","addItem","add","refreshLayout","animation","initialItem","finalItem","anchor","run","item","historyItem","findItemById","index","getItemIndex","clearAnimate","removeItemByIndex","LazyLoad","showImages","isDomNode","_wrapper","wrapperPosition","hideEvent","marginBottom","clearLayout","wrapperClassName","getWrapperClassName","wrapper","getIconClassName","isContextMenuEnabled","Dom","append","prepareContextMenuButton","contentWrapper","header","getTitle","formatTime","prepareContentDetails","authorNode","prepareAuthorLayout","vueComponent","makeVueComponent","prepareContent","enableAdd","getBoolean","markAsTerminated","checkItemForTermination","preventDefault","returnValue","unfasten","fasten","manager","getManager","isSpotlightShowed","setSpotlightShowed","spotlight","SpotLight","targetElement","targetVertex","lightMode","autoSave","prepareTitleLayout","statusNode","getStatusNode","onActivityCreated","deadline","isDate","setHours","setMinutes","setSeconds","setMilliseconds","end","props","required","Object","computed","fields","FIELDS","author","AUTHOR","createdAt","HistoryItem","methods","getLangMessage","key","notificationBalloon","activeRequestsCnt","dealId","products","isProductsGridAvailable","productsGrid","setProductsGrid","onProductsGridChanged","handleProductAddingToDeal","handleProductAddedToDeal","Crm","EntityEditor","getDefault","reload","reloadGrid","getState","UI","Notification","State","OPEN","Center","notify","Loc","actions","event","balloon","action","onCustomEvent","window","subscribeCustomEvents","EventEmitter","subscribe","onProductsGridCreated","unsubscribeCustomEvents","unsubscribe","getData","dealOfferIds","map","product","OFFER_ID","entries","isInDeal","some","parseInt","offerId","Vue","set","assign","beforeDestroy","Number","isAddToDealVisible","Boolean","showProductLink","default","addProductToDeal","$emit","runAction","productId","price","then","catch","openDetailPage","adminLink","slider","open","SidePanel","Instance","isBottomAreaVisible","isVariationInfoVisible","isPriceVisible","variationInfo","currency","Currency","currencyFormat","imageStyle","image","buttonText","template","isShortList","shortListProductsCnt","components","Product","onProductAddedToDeal","onProductAddingToDeal","showMore","listWrap","$refs","adviceList","maxHeight","isShowMoreVisible","visibleProducts","productIndex","extend","mixins","HistoryItemMixin","ProductListMixin","ProductList","created","VIEWED_PRODUCTS","DEAL_ID","tapController","controller","getProductList","iStyle","IMAGE_URL","Author","messageId","status","semantics","description","provider","isRefreshing","setMessageInfo","PULL","moduleId","command","callback","params","ID","refresh","extendWatch","messageInfo","Array","isArray","capitalizeFirstLetter","viewActivity","str","locale","navigator","language","char","toLocaleUpperCase","communication","statusClass","isStatusError","statusErrorDescription","deliveryService","isDeliveryServiceProfile","IS_PROFILE","deliveryServiceName","PARENT_NAME","NAME","deliveryProfileServiceName","deliveryServiceLogoBackgroundUrl","PARENT_LOGO","LOGO","logo","DeliveryServiceInfo","String","deliveryInfo","isCreatingRequest","isCancellingRequest","completeActivity","canComplete","setAsDone","showContextMenu","popup","getId","onclick","deletionDlgId","dlg","ConfirmationDialog","get","cancel","createDeliveryRequest","isLocked","analyticsLabel","shipmentIds","additional","ACTIVITY_ID","activityId","showError","errors","join","cancelDeliveryRequest","deliveryRequest","requestId","actionType","checkRequestStatus","startCheckingRequestStatus","clearTimeout","_checkRequestStatusTimeoutId","setInterval","stopCheckingRequestStatus","setDeliveryInfo","finallyCallback","subscribePullEvents","_isPullSubscribed","deliveryServiceIds","deliveryRequestId","callPhone","phone","canUseTelephony","BXIM","phoneTo","location","isPhone","property","includes","loadExt","needCheckRequestStatus","shipments","shipment","expectedDeliveryPriceFormatted","IDS","deliveryRequestProperties","deliveryRequestStatus","deliveryRequestStatusSemantic","isConnectedWithDeliveryRequest","isSendRequestButtonVisible","miscellaneous","cancelRequestButtonStyle","wrapperContainerClass","innerWrapperContainerClass","watch","value","DELIVERY_SERVICE","messageData","MESSAGE_DATA","messageTitle","messageDescription","messageStatus","messageStatusSemantics","messageStatusSemanticsClass","addressFrom","ADDRESS_FROM_FORMATTED","addressTo","ADDRESS_TO_FORMATTED","Editor","_manager","_ownerTypeId","_ownerId","_input","_saveButton","_cancelButton","_ghostInput","_saveButtonHandler","onSaveButtonClick","_cancelButtonHandler","onCancelButtonClick","_focusHandler","onFocus","_blurHandler","onBlur","_keyupHandler","resizeForm","_delayedKeyupHandler","bind","_isVisible","_hideButtonsOnBlur","Manager","bindInputHandlers","visible","display","minHeight","removeButtonWaitClass","saveResult","save","Promise","processEditingCancellation","offsetWidth","ghost","ensureGhostCreated","computedStyle","getComputedStyle","diff","paddingBottom","paddingTop","borderTopWidth","borderBottomWidth","innerHTML","scrollHeight","WaitConfigurationDialog","_type","Wait","WaitingType","_target","_targetDates","_durationMeasureNode","_durationInput","_targetDateNode","_popup","after","_menuId","enableNumber","Helper","getDurationText","info","draggable","prepareDialogContent","buttons","PopupWindowButton","PopupWindowButtonLink","keyup","onDurationChange","getTargetDateCaption","toggleTargetMenu","isNaN","isTargetMenuOpened","closeTargetMenu","openTargetMenu","getMenuById","onTargetSelect","getFunction","before","fieldName","_isRequestRunning","_isLocked","_configContainer","_configSelector","_isMenuShown","_menu","_configDialog","config","resolveTypeId","names","layoutConfigurationSummary","openMenu","closeMenu","handler","onMenuItemClick","customMenu","items","onMenuShow","onMenuClose","onMenuDestroy","openConfigDialog","saveConfiguration","targetDates","onSave","onConfigDialogSave","onCancel","onConfigDialogCancel","setType","setDuration","setTarget","optionName","toLowerCase","userOptions","strip_tags","getSummaryHtml","querySelector","onSelectorClick","onsuccess","completed","getSummaryText","trim","targetFieldName","subject","ownerType","resolveName","ownerID","onSaveSuccess","onfailure","onSaveFailure","release","error","alert","processEditingCompletion","getMessagePlural","toString","Sms","_senderId","_from","_commEntityTypeId","_commEntityId","_to","_canUse","_canSendMessage","_manageUrl","_senders","_fromList","_toList","_defaults","_communications","_shownMenuId","_documentSelector","_source","_paymentId","_shipmentId","_compilationProductIds","_templateId","_templatesContainer","_templateFieldHintNode","_templateSelectorNode","_templateTemplateTitleNode","_templatePreviewNode","_templateSelectorMenuId","_templateFieldHintHandler","onTemplateHintIconClick","_templateSeletorClickHandler","onTemplateSelectClick","_selectTemplateHandler","onSelectTemplate","remove_url_param","senderId","from","_isSalescenterEnabled","_isDocumentsEnabled","_documentsProvider","_documentsValue","_isFilesEnabled","_diskUrls","_isFilesExternalLinkEnabled","_senderSelectorNode","_fromContainerNode","_fromSelectorNode","_clientContainerNode","_clientSelectorNode","_toSelectorNode","_messageLengthCounterWrapperNode","_messageLengthCounterNode","_salescenterStarter","_smsDetailSwitcher","_smsDetail","_documentSelectorButton","_fileSelectorButton","_fileUploadZone","_fileUploadLabel","_fileSelectorBitrix","_fileExternalLinkDisabledContent","initSenderSelector","initDetailSwitcher","initFromSelector","initClientContainer","initClientSelector","initToSelector","initMessageLengthCounter","setMessageLengthCounter","initDocumentSelector","initFileSelector","initSalescenterApplication","classList","contains","innerText","defaultSenderId","defaultSender","canUse","restSender","onSenderSelectorClick","fromList","delimiter","setSender","Uri","addParam","manageUrl","getTopSlider","onClose","onCloseComplete","setFrom","setAsDefault","textContent","shortName","isTemplatesBased","showNode","hideNode","toggleTemplateSelectAvailability","toggleSaveButton","visualFn","defaultFromId","defaultFrom","onFromSelectorClick","onFromSelectorItemClick","hide","onClientSelectorClick","caption","client","setClient","entityTypeId","entityId","phones","setTo","onToSelectorClick","onToSelectorItemClick","valueFormatted","to","menuId","bindElement","_messageLengthMax","getAttribute","setMessageLengthCounterDelayed","classFn","getSelectedSender","enabled","templateId","getSelectedTemplate","PREVIEW","add_url_param","bitrix_sessid","startSalescenterApplication","Salescenter","openApplication","disableSendButton","context","ownerTypeId","ownerId","deal","focus","paymentId","shipmentId","productIds","onDocumentSelectorClick","DocumentGenerator","Selector","Menu","analyticsLabelPrefix","selectPublicUrl","object","Template","createDocument","pasteDocumentUrl","console","Document","getDocumentPublicUrl","publicUrl","onFileSelectorClick","uploadFile","findFile","getElementById","closeFileSelector","initDiskUF","fireEvent","getFileUploadInput","showFilesExternalLinkFeaturePopup","loader","Loader","size","getLoader","isShown","isDiskFileUploaderInited","addCustomEvent","OnFileUploadSuccess","uf","_onUploadProgress","showLoader","Disk","UF","UID","controlName","hideSelectDialog","urlSelect","urlRenameFile","urlDeleteFile","urlUpload","fileResult","file","uploaderFile","hideLoader","diskFileId","element_id","fileName","element_name","pasteFileUrl","fileId","response","externalLink","pop","featurePopup","closeIcon","overlay","contentColor","getFeaturePopup","forEach","TITLE","loaderMenuId","loaderMenuLoaderId","html","onDestroy","module","find","templates","showTemplateSelectDropdown","applySelectedTemplate","menu","preview","Text","encode","Rest","_interfaceInitialized","initializeInterface","rest","Marketplace","PLACEMENT","fireUpdateEvent","appId","appData","split","AppLayout","PLACEMENT_ID","PlacementInterface","initializePlacement","prototype","reloadData","cb","EntityEvent","fireUpdate","log","fire","invalidate","Comment","_postForm","_editor","unbind","_editorName","onLoadEditorSuccess","_editorContainer","showEditor","addEvents","firstElementChild","removeEventListener","obj","blob","addEventListener","LHEPostForm","getHandler","BXHtmlEditor","Get","eventNode","history","Focus","loadEditor","attachmentList","oEditor","GetContent","querySelectorAll","input","emptyCommentMessage","reinit","itemData","createAnchor","move","CrmCommentAnimation","onAnimationStart","onAnimationComplete","ToDo","hasClass","clearValue","setParentActivityId","deadLine","setDeadLine","setFocused","editorContainer","prepend","TodoEditor","defaultDescription","onChangeDescription","Scheduled","_schedule","_deadlineNode","_setAsDoneButtonHandler","onSetAsDoneButtonClick","CrmActivityEditor","hasPermissions","verifyPermissions","loadPermissions","userId","getPermissions","getUserId","getServiceUrl","getAssociatedEntityId","onPermissionsLoad","setPermissions","getDeadline","isCounterEnabled","markAsDone","onItemMarkedAsDone","formatDateTime","isIncomingChannel","perms","Action","doLayout","Activity","_entityData","_item","_isEnabled","getActivityCommunications","getActivityId","communications","Email","_clickHandler","onClick","_saveHandler","CrmActivityProvider","Bitrix24","Slider","addEmail","addOnSave","loadActivityCommunications","CrmActivityEmail","prepareReply","PreventDefault","onActivityCreate","HistoryEmail","ScheduleEmail","HistoryActivity","direction","typeCategoryId","getTypeCategoryId","CrmActivityType","email","CrmActivityDirection","incoming","call","meeting","task","providerId","getTypeDescription","markTypeId","messageName","markText","activityEditor","isEditable","processRemoval","associatedEntityTypeId","getAssociatedEntityTypeId","editActivity","_detetionConfirmDlgId","getRemoveMessage","onRemovalConfirm","onRemovalCancel","getItemById","deleteActivity","serviceUrl","ownertype","ownerid","_handleActivityChange","editDocument","statusLayout","prepareTitleStatusLayout","prepareTimeLayout","prepareFixedSwitcherLayout","prepareHeaderLayout","detailWrapper","findChildByClassName","confirmDelete","onConfirmDelete","DoNothing","deleteDocument","deleteItem","deleteFixedItem","documentId","DOCUMENT_ID","adjust","_node","originalPosition","_initialYPosition","_initialXPosition","_initialWidth","_initialHeight","offsetHeight","_anchorYPosition","createStub","createGhost","moveGhost","_stub","_ghostNode","boxShadow","placeEventAnim","addHistoryItem","removeGhost","_finalItemHeight","ghostNode","finalNode","overflow","hideCasperItem","collapseStub","removePlannedEvent","inited","Shift","_nodeParent","startPosition","shadowNode","_shadowNode","ItemNew","_areAnimatedItemsVisible","offsetParent","shift","stubContainer","Steam","_timeFormat","_year","_isStubMode","_userId","_readOnly","_streamType","StreamType","datetimeFormat","dateFormat","date","convertBitrixFormat","getFullYear","getStreamType","scheduled","pinned","currentUrl","ajaxId","insertToNode","bxajaxid","SERVER_TO_UTC","now","utc","format","whitespaceOffset","Error","getItems","findIndex","splice","setItems","ConfigurableItem","clone","animateUpdate","animateMove","resolve","itemPositionChanged","newIndex","newItem","isScheduleStream","createItemCopy","calculateItemIndex","animateItemAdding","ItemAnimation","getPosition","destinationStream","destinationItem","EntityChat","_layoutType","LayoutType","none","_contentWrapper","_messageWrapper","_messageDateNode","_messageTexWrapper","_messageTextNode","_userWrapper","_extraUserCounter","_openChatHandler","onOpenChat","lockScript","isString","eval","getUserInfoData","userInfos","counter","isEnabled","isStubMode","getChatId","renderSummary","renderInvitation","onChatEvent","cleanNode","invitation","refreshUsers","summary","_messageTexWraper","_messageCounterNode","refreshSummary","infos","list","values","count","icon","getMessageData","isoDate","remoteDate","getServerTimezoneOffset","getUserTimezoneOffset","localTime","MessengerCommon","purifyText","isRestricted","applyLockScript","slug","chatId","hasUserInfo","ownerInfo","entityTypeName","openMessengerSlider","RECENT","MENU","extras","setUserInfoData","mergeEx","refreshUsersAnimated","removeUserInfo","setMessageData","setUnreadMessageCounter","refreshSummaryAnimated","Stream","MenuBar","_ownerInfo","_commentEditor","_todoEditor","_waitEditor","_smsEditor","_zoomEditor","_restEditor","Main","interfaceButtonsManager","getById","setActiveItemById","_activeItem","getActive","firstId","getAllItems","dataset","indexOf","processItemSelection","currentDiv","wasActiveInMoreMenu","isActiveInMoreMenu","classes","itemActive","getItemData","currentDivData","activeItemData","isActiveData","JSON","parse","err","IS_ACTIVE","stringify","wasActiveData","submenu","getSubmenu","getMenuItems","menuItem","getContainer","getMoreButton","closeSubmenu","planner","Planner","showEdit","addDelivery","addTask","setVisible","visitParameters","CrmActivityVisit","match","AudioPlaybackRateSelector","availableRates","currentRate","normalizeRate","textMessageCode","renderedItems","players","rateDescription","rate","parseFloat","isRateCurrent","selectedRate","getRate","setRate","popupMenu","MenuManager","getPopupWindow","setBindElement","getPopup","textNode","getText","vjsPlayer","playbackRate","player","Fileman","Player","SchedulePostponeController","postpone","_postponeController","autoCompleted","setActivityCompleted","onSetAsDoneCompleted","getSourceId","postponeActivity","onPosponeCompleted","activityType","IS_INCOMING_CHANNEL","canPostpone","timeText","getCreatedDate","communicationValue","getItemClassName","iconClassName","contentInnerWrapper","headerWrapper","cutOffText","additionalDetails","prepareDetailNodes","members","getPrepositionText","communicationNode","prepareCommunicationNode","setAsDoneButton","checked","change","disabled","buttonContainer","onContextMenuItemSelect","postponeMenu","commands","getCommandList","processCommand","CrmScheduleEmailAction","Call","CrmScheduleCallAction","callInfo","callTypeText","CallTracker","isSuccessfull","statusText","Meeting","Task","StoreDocument","_classPrivateMethodInitSpec","providerType","WebForm","editor","getWaitEditor","nl2br","Request","iconNode","backgroundPosition","backgroundColor","OpenLine","_button","OpenLineAction","messageWrapper","openLineData","isExternal","Zoom","topic","startTime","toDatetimeString","detailZoomMessage","detailZoomInfoLink","detailZoomInfo","detailZoomCopyInviteLink","clipboard","bindCopyClick","detailZoomStartConferenceButton","detailZoomCopyInviteLinkWrapper","Schedule","label","addStub","setContainer","processSheduleLayoutChange","hasContent","stubIcon","isStubCounterEnabled","isTerminated","getItemCount","getLastItem","sort","getSort","curSort","j","$entityTypeId","getItemByAssociatedEntity","entityTypeID","entityID","itemId","timelineId","itemClassName","currentUser","getCurrentUser","streamType","schedule","Timeline","DeliveryActivity","removeStub","historyItemData","onTransferComplete","stubClassName","stubIconClassName","canAddTodo","stubMessage","lead","focusOnTodoEditor","menuBar","getMenuBar","todoEditor","getTodoEditor","addWrapperClass","Modification","contentChildren","Conversion","entityNodes","entityInfos","getArrayDataParam","entityInfo","entityNode","getNotFoundMessage","emailInfo","markNode","prepareMarkLayout","communicationTitle","communicationShowUrl","outerWrapper","communicationWrapper","prepareCutOffElements","_menuItems","addCall","showMenu","prepareMenuItems","PopupMenuWindow","l","formattedValue","complexName","itemText","HistoryCall","ScheduleCall","_playerDummyClickHandler","onPlayerDummyClick","_playerWrapper","_transcriptWrapper","_mediaFileInfo","hasCallInfo","communicationValueFormatted","durationText","hasTranscript","isTranscriptPending","callId","callComment","prepareMultilineCutOffElements","callInfoWrapper","renderAudioDummy","getAudioPlaybackRateSelector","render","Voximplant","Transcript","stubNode","addPlayer","loadMediaPlayer","prepareMessageStatusLayout","_messageStatusNode","smsInfo","senderName","senderShortName","fromName","messageSenderWrapper","statusId","setMessageStatus","errorText","bodyText","messageBodyWrapper","statuses","setMessageStatusErrorText","statusSemantic","getMessageStatusSemantic","setMessageStatusSemantic","semantic","classMap","process","failure","checkSemantic","fn","removeAttribute","setAttribute","CrmSmsWatcher","subscribeOnMessageUpdate","onMessageUpdate","STATUS_ID","EXEC_ERROR","entityDetailWrapper","Visit","visitInfo","recordLength","recordLengthFormatted","vkProfile","createTextNode","getVkProfileUrl","profile","getClass","Restriction","_videoDummy","_audioDummy","_videoPlayer","_audioPlayer","_audioLengthElement","_recordings","_currentRecordingIndex","zoomActivitySubject","_downloadWrapper","_downloadSubject","_downloadSubjectDetail","_downloadVideoLink","_downloadSeparator","_downloadAudioLink","_playVideoLink","detailZoomCopyVideoLink","prepareSuccessfulLayout","zoomData","tabs","recording","active","tabsComponent","TabsComponent","eventEmitter","_onTabChange","_onVideoDummyClick","hint","Hint","init","_onAudioDummyClick","videoLinkExpireTS","videoLinkContainer","_detailZoomCopyVideoLink","zoomAudioDetailWrapper","setCurrentRecording","video","skin","tabId","recordingIndex","videoRecording","audioRecording","hidden","pause","setSource","clean","lengthHuman","lastElementChild","elements","Event","_renderTab","tabDescription","setActiveTab","emit","OrderCreation","msg","statusMessage","legend","nodes","getHeaderChildren","OrderModification","statusInfo","classCode","orderpayment","psStatusCode","ordershipment","getStatusInfo","isNotEmptyObject","htmlTitle","descriptionNode","sublegend","destination","detailNode","sliderLinkNode","orderId","templateMode","paySystemName","sum","paymentDetail","logotip","isPaid","isClick","isManualContinuePay","isManualAddCheck","preparePaidPaymentContent","prepareClickedPaymentContent","prepareManualContinuePayContent","prepareManualAddCheck","prepareItemOrderContent","isViewed","isSent","prepareViewedContentDetails","prepareSentContentDetails","prepareErrorPaymentContentDetails","headerWrap","preparePaidPaymentContentDetails","paySystemError","errorDetailNode","prepareClickedPaymentContentDetails","StoreDocumentCreation","docType","titleNode","titleTemplate","documentDetailUrl","documentLinkTag","StoreDocumentModification","field","statusName","errorMessage","ExternalNoticeModification","ExternalNoticeStatusModification","OrderCheck","checkName","isSended","Page","openSlider","legendNode","checkUrl","FinalSummaryDocuments","check","blockNode","URL","contentItem","RESULT","summaryOptions","ASSOCIATED_ENTITY_ID","ASSOCIATED_ENTITY_TYPE_ID","timelineSummaryDocuments","TimelineSummaryDocuments","TIMELINE_SUMMARY_OPTIONS","setOptions","FinalSummary","Creation","isMessageNotFound","TYPE_CATEGORY_ID","HTML_TITLE","createOrderEntityItem","orderData","ORDER_DATE","SHOW_URL","SUM","spanAttrs","linkAttrs","baseEntityData","baseEntityInfo","Restoration","Relation","Link","Unlink","activityProviderId","MarkType","isDefined","innerWrapper","associatedEntityTitle","contentTemplate","_isCollapsed","_hasFiles","_commentMessage","_mode","_streamContentEventBlock","_playerWrappers","playerWrapper","entityValueId","files","extension","detailChildren","_commentWrapper","switchToEditMode","switchToViewMode","cleanText","_hasInlineAttachment","onExpandButtonClick","_textLoaded","_fileBlock","ready","loadContent","registerImages","viewElementBind","showTitle","BLOCK","promise","SetContent","ReInitIframe","actionData","commentImages","commentImagesLength","idsList","toggleMode","tagName","getSelection","onRequestFailure","getHistory","fixedHistory","getFixedHistory","onRemoveSuccess","updateFixedItem","updateItem","eventWrapper","button","Sender","getDataSetting","isRemoved","stopPropagation","layoutClassName","textCaption","prepareStatusLayout","Bizproc","prepareContentTextHtml","workflowName","workflowStatus","Scoring","scoringInfo","score","getNumber","scoreDelta","round","iconClass","Expand","_callback","onNodeHeightStep","onNodeHeightComplete","onNodeOpacityStep","onNodeOpacityComplete","_emptySection","_currentDaySection","_lastDaySection","_lastDate","_enableLoading","_navigation","_scrollHandler","_loadingWaiter","_filterId","_isFilterApplied","_isFilterShown","_filterButton","_filterWrapper","_filterResultStub","onFilterApply","closeFilterButton","onFilterClose","createCurrentDaySection","createDaySection","enableLoading","processHistoryLayoutChange","firstChild","adjustFilterButton","_filterEmptyResultSection","createFilterEmptyResultSection","results","createEmptySection","showFilter","section","sectionWrapper","hideFilter","filter","filterManager","resetFilter","formattedDate","formatDate","toUpperCase","vueComponentId","vueComponentsMap","Map","has","smsStatusDescriptions","smsStatusSemantics","OrderType","EncourageBuyProducts","shipmentDocument","CompilationType","ProductCompilationList","CompilationOrderNotice","ProductCompilationViewed","NewDealCreated","CrmHistoryItem","changedFieldName","DeliveryType","Taxi","EstimationRequest","CallRequest","CancelledByManager","CancelledByDriver","PerformerNotFound","SmsProviderIssue","ReturnedFinish","DeliveryMessage","DeliveryCalculation","useShortTimeFormat","createActivityItem","createProductCompilationItem","createStoreDocumentItem","createExternalNotificationItem","createDeliveryItem","child","removeChild","getBoundingClientRect","documentElement","loadItems","ctx","autoResolve","CrmDataLoader","load","resetLayout","bulkCreateItems","setNavigation","fulfill","navigation","enable","onWindowScroll","instances","FixedHistory","nextElementSibling","onItemsLoad","PullActionProcessor","_classPrivateFieldInitSpec","isObject","scheduleStream","fixedHistoryStream","historyStream","actionParams","_classPrivateMethodGet","appLanguage","languageId","canBeReloaded","stream","promises","isHistoryStream","sourceStream","fromStream","fromId","all","existedStreamItem","streamItem","refreshItem","deleteItemAnimated","sourceId","destinationId","destinationItemData","sourceItem","existedDestinationItem","moveItemToStream","onSuccessFasten","fixedHistoryItem","getAnchor","onSuccessUnfasten","streamName","activityIds","historyIds","_progressSemantics","_chat","_menuBar","_currentUser","_pullTagName","_spotlightFastenShowed","_audioPlaybackRate","containerId","activityEditorId","readOnly","filterId","isFilterApplied","setHistory","isTodoEnabled","editorName","cancelButton","configContainer","templatesContainer","placement","onPullEvent","commentEditor","waitEditor","smsEditor","zoomEditor","restEditor","reset","onEntityProgressChange","throttle","onScroll","processAction","processChatCreate","processActivityExternalAdd","processActivityExternalUpdate","processActivityExternalDelete","processCommentExternalAdd","processCommentExternalUpdate","processCommentExternalDelete","processChangeBinding","processItemExternalUpdate","processWaitExternalAdd","processWaitExternalUpdate","processWaitExternalDelete","processBizprocStatus","processScoringExternalAdd","scheduleItemData","scheduleItem","getItemByData","addScheduleItem","historyItems","getItemsByAssociatedEntity","setAssociatedEntityData","fixedHistoryItems","transferItemToHistory","entityNewId","fixedItemData","eventArgs","historyAnchor","filePath","mediaType","sources","src","isAudio","onInit","controlBar","addChild","isPlaying","play","createElement","audioPlaybackRateSelector","instance","SmsWatcher","_pullInited","_listeners","initPull","fireExternalStatusUpdate","listener","SchedulePostpone","nodeOpacityAnim","SENT_PRODUCTS","canAddProductToDeal","compilationCreationDate","legendTextTemplate","authorFormattedName","FORMATTED_NAME","authorHref","authorImageUrl","authorImageStyle","dealTitle","NEW_DEAL_DATA","dealLegend","LEGEND","dealUrl","dealTitleLink","Streams","Editors","Tools","Actions","ScheduledItems","ScheduledActivity","ScheduledEmail","ScheduledCall","ScheduledMeeting","ScheduledTask","ScheduledStoreDocument","ScheduledWebForm","ScheduledWait","ScheduledRequest","ScheduledRest","ScheduledOpenLine","ScheduledZoom","Items","CommentItem","EmailItem","CallItem","WaitItem","SmsItem","RestItem","OpenLineItem","ScheduledBase","Animations","AnimationItem","AnimationComment"],"mappings":"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"}