{"version":3,"file":"list-editor.bundle.js","sources":["../src/item/item.js","../src/backend/backend.js","../src/list-editor.js"],"sourcesContent":["import {EventEmitter} from 'main.core.events';\nimport {Cache, Tag, Text, Dom, Type} from 'main.core';\nimport 'ui.forms';\nimport '\"ui.layout-form';\nimport type {ListEditorItemOptions} from '../types/list-editor-item-options';\n\nimport './css/style.css';\n\nconst {MemoryCache} = Cache;\n\nexport class Item extends EventEmitter\n{\n\t#cache = new MemoryCache();\n\n\tconstructor(options: ListEditorItemOptions)\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Crm.Field.ListEditor.Item');\n\t\tthis.subscribeFromOptions(options.events);\n\t\tthis.setOptions(options);\n\n\t\tthis.onFormChange = this.onFormChange.bind(this);\n\t}\n\n\tsetOptions(options: ListEditorItemOptions)\n\t{\n\t\tthis.#cache.set('options', {...options});\n\t}\n\n\tgetOptions(): ListEditorItemOptions\n\t{\n\t\treturn this.#cache.get('options', {});\n\t}\n\n\tgetCustomTitleLayout(): HTMLDivElement\n\t{\n\t\treturn this.#cache.remember('customTitleLayout', () => {\n\t\t\treturn this.getLayout().querySelector('.crm-field-list-editor-item-text-custom-title');\n\t\t});\n\t}\n\n\tgetLayout(): HTMLDivElement\n\t{\n\t\treturn this.#cache.remember('layout', () => {\n\t\t\tconst {data, categoryCaption} = this.getOptions();\n\t\t\tconst {sourceData} = this.getOptions();\n\t\t\tconst label = data.label || sourceData.caption;\n\n\t\t\tconst preparedCategoryCaption = (() => {\n\t\t\t\tif (Type.isStringFilled(categoryCaption))\n\t\t\t\t{\n\t\t\t\t\treturn `&middot; ${Text.encode(categoryCaption)}`;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\treturn '';\n\t\t\t})();\n\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"crm-field-list-editor-item\" data-name=\"${Text.encode(sourceData?.name || '')}\">\n\t\t\t\t\t<div class=\"crm-field-list-editor-item-header\">\n\t\t\t\t\t\t<div class=\"crm-field-list-editor-item-drag-button\"></div>\n\t\t\t\t\t\t<div class=\"crm-field-list-editor-item-text\">\n\t\t\t\t\t\t\t<div class=\"crm-field-list-editor-item-text-source-title\">\n\t\t\t\t\t\t\t\t<span class=\"crm-field-list-editor-item-text-source-title-inner\">${Text.encode(sourceData?.caption || '')}</span>\n\t\t\t\t\t\t\t\t<span class=\"crm-field-list-editor-item-text-source-title-inner\">${preparedCategoryCaption}</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"crm-field-list-editor-item-text-custom-title\">\n\t\t\t\t\t\t\t\t<div class=\"crm-field-list-editor-item-text-custom-title-inner\">${Text.encode(label)}</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"crm-field-list-editor-item-actions\">\n\t\t\t\t\t\t\t<div \n\t\t\t\t\t\t\t\tclass=\"crm-field-list-editor-item-button-edit\"\n\t\t\t\t\t\t\t\tonclick=\"${this.onEditClick.bind(this)}\"\n\t\t\t\t\t\t\t></div>\n\t\t\t\t\t\t\t<div \n\t\t\t\t\t\t\t\tclass=\"crm-field-list-editor-item-button-remove\"\n\t\t\t\t\t\t\t\tonclick=\"${this.onRemoveClick.bind(this)}\"\n\t\t\t\t\t\t\t></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"crm-field-list-editor-item-body\">\n\t\t\t\t\t\t${this.getFormLayout()}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tonEditClick(event: MouseEvent)\n\t{\n\t\tevent.preventDefault();\n\n\t\tif (!this.isOpened())\n\t\t{\n\t\t\tthis.open();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.close();\n\t\t}\n\t}\n\n\tonRemoveClick(event: MouseEvent)\n\t{\n\t\tevent.preventDefault();\n\n\t\tthis.emit('onRemove');\n\t}\n\n\topen()\n\t{\n\t\tDom.addClass(this.getLayout(), 'crm-field-list-editor-item-opened');\n\t}\n\n\tisOpened(): boolean\n\t{\n\t\treturn Dom.hasClass(this.getLayout(), 'crm-field-list-editor-item-opened');\n\t}\n\n\tclose()\n\t{\n\t\tDom.removeClass(this.getLayout(), 'crm-field-list-editor-item-opened');\n\t}\n\n\tcreateTextInput(options: {name: string, label: string, value: string}): HTMLDivElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"ui-form-row crm-field-list-editor-item-form-text-row\">\n\t\t\t\t<div class=\"ui-form-label\">\n\t\t\t\t\t<div class=\"ui-ctl-label-text\">${options.label}</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"ui-form-content\">\n\t\t\t\t\t<div class=\"ui-ctl ui-ctl-textbox ui-ctl-w100\">\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\tname=\"${options.name}\"\n\t\t\t\t\t\t\tvalue=\"${options.value}\"\n\t\t\t\t\t\t\toninput=\"${this.onFormChange}\"\n\t\t\t\t\t\t\tclass=\"ui-ctl-element\">\t\n\t\t\t\t\t</div>\t\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tcreateCheckbox(options: {name: string, label: string, checked: boolean}): HTMLLabelElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"ui-form-row crm-field-list-editor-item-form-checkbox-row\">\n\t\t\t\t<div class=\"ui-form-content\">\n\t\t\t\t\t<label class=\"ui-ctl ui-ctl-checkbox\">\n\t\t\t\t\t\t<input \n\t\t\t\t\t\t\ttype=\"checkbox\" \n\t\t\t\t\t\t\tname=\"${options.name}\"\n\t\t\t\t\t\t\tclass=\"ui-ctl-element\"\n\t\t\t\t\t\t\tonchange=\"${this.onFormChange}\"\n\t\t\t\t\t\t\t${options.checked ? 'checked': ''}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t<div class=\"ui-ctl-label-text\">${options.label}</div>\n\t\t\t\t\t</label>\t\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tgetAllInputs(): Array<HTMLInputElement>\n\t{\n\t\treturn [...this.getLayout().querySelectorAll('.ui-ctl-element')];\n\t}\n\n\tgetValue(): {[key: string]: any}\n\t{\n\t\treturn this.getAllInputs().reduce((acc, input) => {\n\t\t\tacc[input.name] = input.type === 'checkbox' ? input.checked : input.value;\n\t\t\treturn acc;\n\t\t}, {...this.getOptions().data});\n\t}\n\n\tonFormChange()\n\t{\n\t\tconst value = this.getValue();\n\t\tthis.getCustomTitleLayout().textContent = value.caption || value.label;\n\n\t\tthis.emit('onChange');\n\t}\n\n\tgetFormControls(): Array<HTMLElement>\n\t{\n\t\treturn this.#cache.remember('formControls', () => {\n\t\t\tconst editableEntries = Object.entries(this.getOptions().editable);\n\t\t\tconst {data} = this.getOptions();\n\n\t\t\treturn editableEntries.map(([name, options]) => {\n\t\t\t\tif (options.type === 'string')\n\t\t\t\t{\n\t\t\t\t\treturn this.createTextInput({\n\t\t\t\t\t\tname,\n\t\t\t\t\t\tlabel: options.label,\n\t\t\t\t\t\tvalue: data[name],\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\treturn this.createCheckbox({\n\t\t\t\t\tname,\n\t\t\t\t\tlabel: options.label,\n\t\t\t\t\tchecked: data[name],\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t}\n\n\tgetFormLayout(): HTMLDivElement\n\t{\n\t\treturn this.#cache.remember('formLayout', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"crm-field-list-editor-item-form\">\n\t\t\t\t\t<div class=\"ui-form\">\n\t\t\t\t\t\t${this.getFormControls()}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n}","import {Cache, ajax, Type} from 'main.core';\n\nconst {MemoryCache} = Cache;\n\nexport class Backend\n{\n\tstatic #instance = null;\n\t#cache = new MemoryCache();\n\n\tstatic getInstance(): Backend\n\t{\n\t\tif (!Backend.#instance)\n\t\t{\n\t\t\tBackend.#instance = new Backend();\n\t\t}\n\n\t\treturn Backend.#instance;\n\t}\n\n\tgetFieldsList(presetId: number): Promise<any>\n\t{\n\t\treturn this.#cache.remember('fieldsList', () => {\n\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\tajax\n\t\t\t\t\t.runAction('crm.api.form.field.list', {json: {presetId}})\n\t\t\t\t\t.then((result) => {\n\t\t\t\t\t\tif (Type.isPlainObject(result?.data?.tree))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tresolve(result.data.tree);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treject(result);\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t\t.catch((error) => {\n\t\t\t\t\t\treject(error);\n\t\t\t\t\t});\n\t\t\t});\n\t\t});\n\t}\n\n\tgetFieldsSet(id: number): Promise<any>\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tajax\n\t\t\t\t.runAction('crm.api.fieldset.get', {json: {id}})\n\t\t\t\t.then((result) => {\n\t\t\t\t\tif (Type.isPlainObject(result?.data))\n\t\t\t\t\t{\n\t\t\t\t\t\tresolve(result.data);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\treject(result);\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.catch((error) => {\n\t\t\t\t\treject(error);\n\t\t\t\t});\n\t\t});\n\t}\n\n\tsaveFieldsSet(options: {[key: string]: any}): Promise<any>\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tajax\n\t\t\t\t.runAction('crm.api.fieldset.set', {json: {options}})\n\t\t\t\t.then((result) => {\n\t\t\t\t\tif (Type.isPlainObject(result?.data))\n\t\t\t\t\t{\n\t\t\t\t\t\tresolve(result);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\treject(result);\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.catch((error) => {\n\t\t\t\t\treject(error);\n\t\t\t\t});\n\t\t});\n\t}\n}","import {EventEmitter, BaseEvent} from 'main.core.events';\nimport {Cache, Dom, Text, Loc, Tag, Type, Runtime, Event} from 'main.core';\nimport {FieldsPanel} from 'landing.ui.panel.fieldspanel';\nimport {Notification} from 'ui.notification';\nimport {Draggable} from 'ui.draganddrop.draggable';\nimport {Layout} from 'ui.sidepanel.layout';\nimport {SaveButton} from 'ui.buttons';\nimport {Loader} from 'main.loader';\nimport {Item} from './item/item';\nimport {Backend} from './backend/backend';\nimport 'landing.master';\n\nimport type {ListEditorOptions} from './types/list-editor-options';\nimport type {ListEditorItemOptions} from './types/list-editor-item-options';\n\nimport './css/style.css';\n\nconst {MemoryCache} = Cache;\n\nexport {\n\tBackend,\n};\n\n/**\n * @memberOf BX.Crm.Field\n */\nexport class ListEditor extends EventEmitter\n{\n\t#cache = new MemoryCache();\n\t#loadPromise: Promise;\n\n\tstatic #defaultOptions = {\n\t\tsetId: 0,\n\t\tautoSave: true,\n\t\tcacheable: true,\n\t\tfieldsPanelOptions: {},\n\t\tdebouncingDelay: 500,\n\t};\n\n\tconstructor(options: ListEditorOptions = {})\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Crm.Field.ListEditor');\n\t\tthis.subscribeFromOptions(options.events);\n\t\tthis.setTitle(options.title || '');\n\t\tthis.onWindowResize = this.onWindowResize.bind(this);\n\n\t\tthis.setOptions({\n\t\t\t...ListEditor.#defaultOptions,\n\t\t\t...options,\n\t\t});\n\n\t\tthis.onDebounceChange = Runtime.debounce(\n\t\t\tthis.onDebounceChange,\n\t\t\tthis.getOptions().debouncingDelay,\n\t\t\tthis,\n\t\t);\n\n\t\tthis.draggable = new Draggable({\n\t\t\tcontainer: this.getListContainer(),\n\t\t\tdraggable: '.crm-field-list-editor-item',\n\t\t\tdragElement: '.crm-field-list-editor-item-drag-button',\n\t\t\toffset: {\n\t\t\t\tx: -800,\n\t\t\t},\n\t\t\tcontext: window.top,\n\t\t});\n\n\t\tthis.draggable.subscribe('end', this.onSortEnd.bind(this));\n\n\t\tthis.showLoader();\n\n\t\tthis.#loadPromise = Promise\n\t\t\t.all([\n\t\t\t\tthis.loadFieldsDictionary(),\n\t\t\t\tthis.loadValue(),\n\t\t\t])\n\t\t\t.then(([fieldsDictionary, value]) => {\n\t\t\t\tif (Type.isPlainObject(fieldsDictionary))\n\t\t\t\t{\n\t\t\t\t\tthis.setFieldsDictionary(fieldsDictionary);\t\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tconsole.error('BX.Crm.Field.ListEditor: Invalid fields dictionary');\n\t\t\t\t}\n\n\t\t\t\tif (Type.isPlainObject(value))\n\t\t\t\t{\n\t\t\t\t\tthis.setClientEntityTypeId(value.clientEntityTypeId);\n\t\t\t\t\tthis.setEntityTypeId(value.entityTypeId);\n\n\t\t\t\t\tif (Type.isStringFilled(value.title) && !Type.isStringFilled(this.getTitle()))\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.setTitle(value.title);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (Type.isArrayFilled(value.fields))\n\t\t\t\t\t{\n\t\t\t\t\t\tvalue.fields.forEach((itemData) => {\n\t\t\t\t\t\t\tthis.addItem({\n\t\t\t\t\t\t\t\tsourceData: this.getFieldByName(itemData.name),\n\t\t\t\t\t\t\t\tdata: itemData,\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tconsole.error('BX.Crm.Field.ListEditor: Invalid value');\n\t\t\t\t}\n\n\t\t\t\tthis.hideLoader();\n\t\t\t});\n\t}\n\n\tsetData(data: {[key: string]: any})\n\t{\n\t\tthis.#cache.set('data', {...data});\n\t}\n\n\tgetData(): {[key: string]: any}\n\t{\n\t\treturn this.#cache.get('data', {});\n\t}\n\n\tsetTitle(title: string)\n\t{\n\t\tthis.#cache.set('title', title);\n\t}\n\n\tgetTitle(): string\n\t{\n\t\treturn this.#cache.get('title', '');\n\t}\n\n\tsetClientEntityTypeId(clientEntityTypeId)\n\t{\n\t\tthis.#cache.set('clientEntityTypeId', clientEntityTypeId);\n\t}\n\n\tgetClientEntityTypeId(): number\n\t{\n\t\treturn this.#cache.get('clientEntityTypeId');\n\t}\n\n\tsetEntityTypeId(entityTypeId)\n\t{\n\t\tthis.#cache.set('entityTypeId', entityTypeId);\n\t}\n\n\tgetEntityTypeId(): number\n\t{\n\t\treturn this.#cache.get('entityTypeId');\n\t}\n\n\tgetLoader(): Loader\n\t{\n\t\treturn this.#cache.remember('loader', () => {\n\t\t\treturn new Loader({\n\t\t\t\ttarget: this.getLayout(),\n\t\t\t});\n\t\t});\n\t}\n\n\tshowLoader()\n\t{\n\t\tDom.addClass(this.getLayout(), 'crm-field-list-editor-state-load');\n\t\tvoid this.getLoader().show();\n\t}\n\n\thideLoader()\n\t{\n\t\tDom.removeClass(this.getLayout(), 'crm-field-list-editor-state-load');\n\t\tvoid this.getLoader().hide();\n\t}\n\n\tsetOptions(options: ListEditorOptions)\n\t{\n\t\tthis.#cache.set('options', {...options});\n\t}\n\n\tgetOptions(): ListEditorOptions\n\t{\n\t\treturn this.#cache.get('options', {});\n\t}\n\n\tsetFieldsDictionary(fields: Array<any>)\n\t{\n\t\tthis.#cache.set('fieldsDictionary', fields);\n\t}\n\n\tgetFieldsDictionary(): Array<any>\n\t{\n\t\treturn this.#cache.get('fieldsDictionary', []);\n\t}\n\n\tgetListContainer(): HTMLDivElement\n\t{\n\t\treturn this.#cache.remember('listContainer', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"crm-field-list-editor-list\"></div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetLayout(): HTMLDivElement\n\t{\n\t\treturn this.#cache.remember('layout', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"crm-field-list-editor\">\n\t\t\t\t\t${this.getListContainer()}\n\t\t\t\t\t<div class=\"crm-field-list-editor-footer\">\n\t\t\t\t\t\t<span \n\t\t\t\t\t\t\tclass=\"ui-link ui-link-dashed\"\n\t\t\t\t\t\t\tonclick=\"${this.onAddFieldClick.bind(this)}\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t${Loc.getMessage('CRM_FIELD_LIST_EDITOR_ADD_FIELD_BUTTON_LABEL')}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\trenderTo(target: HTMLElement)\n\t{\n\t\tif (!Type.isDomNode(target))\n\t\t{\n\t\t\tconsole.error('target is not a DOM element');\n\t\t}\n\n\t\tDom.append(this.getLayout(), target);\n\t}\n\n\tloadFieldsDictionary(): Promise<any>\n\t{\n\t\tconst fieldsPanelOptions = {\n\t\t\t...this.getOptions().fieldsPanelOptions,\n\t\t\tdisabledFields: this.getValue().map((field) => {\n\t\t\t\treturn field.name;\n\t\t\t}),\n\t\t};\n\n\t\treturn Backend.getInstance().getFieldsList(fieldsPanelOptions?.presetId || null);\n\t}\n\n\tloadValue(): Promise<any>\n\t{\n\t\treturn Backend\n\t\t\t.getInstance()\n\t\t\t.getFieldsSet(this.getOptions().setId)\n\t\t\t.then((result) => {\n\t\t\t\treturn result.options;\n\t\t\t});\n\t}\n\n\tgetItems(): Array<Item>\n\t{\n\t\treturn this.#cache.remember('items', []);\n\t}\n\n\tsetItems(items: Array<Item>)\n\t{\n\t\tthis.#cache.set('items', items);\n\t}\n\n\taddItem(options: ListEditorItemOptions)\n\t{\n\t\tconst items = this.getItems();\n\n\t\tconst hasItem = items.some((item) => {\n\t\t\treturn item.getOptions().data.name === options.data.name;\n\t\t});\n\n\t\tif (!hasItem)\n\t\t{\n\t\t\tconst item = new Item({\n\t\t\t\t...options,\n\t\t\t\tcategoryCaption: this.getCategoryCaption(options.data.name),\n\t\t\t\teditable: this.getOptions().editable,\n\t\t\t\tevents: {\n\t\t\t\t\tonChange: () => {\n\t\t\t\t\t\tthis.onChange();\n\t\t\t\t\t},\n\t\t\t\t\tonRemove: this.onRemoveItemClick.bind(this),\n\t\t\t\t},\n\t\t\t});\n\t\t\titems.push(item);\n\t\t\tDom.append(item.getLayout(), this.getListContainer());\n\t\t}\n\t}\n\n\tonRemoveItemClick(event: BaseEvent)\n\t{\n\t\tconst target: Item = event.getTarget();\n\n\t\tDom.remove(target.getLayout());\n\n\t\tthis.setItems(\n\t\t\tthis.getItems().filter((item) => {\n\t\t\t\treturn item !== target;\n\t\t\t}),\n\t\t);\n\n\t\tthis.onChange();\n\t}\n\n\tgetFieldByName(name: string): ?{[key: string]: any}\n\t{\n\t\tconst fieldsDictionary = this.getFieldsDictionary();\n\n\t\treturn Object.values(fieldsDictionary).reduce((acc, category) => {\n\t\t\tif (!acc)\n\t\t\t{\n\t\t\t\treturn category.FIELDS.find((field) => {\n\t\t\t\t\treturn field.name === name;\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn acc;\n\t\t}, null);\n\t}\n\n\tgetCategoryCaption(fieldName: string): string\n\t{\n\t\tconst fieldsDictionary = this.getFieldsDictionary();\n\n\t\treturn Object.values(fieldsDictionary).reduce((acc, category) => {\n\t\t\tif (!acc)\n\t\t\t{\n\t\t\t\tconst hasField = category.FIELDS.some((field) => {\n\t\t\t\t\treturn field.name === fieldName;\n\t\t\t\t});\n\n\t\t\t\tif (hasField)\n\t\t\t\t{\n\t\t\t\t\treturn category.CAPTION;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn acc;\n\t\t}, '');\n\t}\n\n\tshowFieldsPanel(panelOptions): Promise<Array<string>>\n\t{\n\t\tconst fieldsPanel = FieldsPanel.getInstance();\n\t\tDom.append(fieldsPanel.layout, window.top.document.body);\n\t\treturn fieldsPanel.show(panelOptions);\n\t}\n\n\tonAddFieldClick(event: MouseEvent)\n\t{\n\t\tevent.preventDefault();\n\n\t\tconst fieldsPanelOptions = {\n\t\t\t...this.getOptions().fieldsPanelOptions,\n\t\t\tdisabledFields: this.getValue().map((field) => {\n\t\t\t\treturn field.name;\n\t\t\t}),\n\t\t};\n\n\t\tthis.showFieldsPanel(fieldsPanelOptions)\n\t\t\t.then((result) => {\n\t\t\t\tthis.setFieldsDictionary(\n\t\t\t\t\tFieldsPanel.getInstance().getCrmFields(),\n\t\t\t\t);\n\n\t\t\t\treturn result;\n\t\t\t})\n\t\t\t.then((result) => {\n\t\t\t\tresult.forEach((fieldName) => {\n\t\t\t\t\tconst fieldData = this.getFieldByName(fieldName);\n\t\t\t\t\tif (!Type.isString(fieldData.label) && Type.isString(fieldData.caption))\n\t\t\t\t\t{\n\t\t\t\t\t\tfieldData.label = fieldData.caption;\n\t\t\t\t\t}\n\t\t\t\t\tthis.addItem({\n\t\t\t\t\t\tsourceData: fieldData,\n\t\t\t\t\t\tdata: fieldData,\n\t\t\t\t\t});\n\n\t\t\t\t\tthis.onChange();\n\t\t\t\t});\n\t\t\t});\n\t}\n\n\tonChange()\n\t{\n\t\tthis.emit('onChange');\n\t\tthis.onDebounceChange();\n\t}\n\n\tonDebounceChange()\n\t{\n\t\tif (this.getOptions().autoSave)\n\t\t{\n\t\t\tvoid this.save();\n\t\t}\n\n\t\tthis.emit('onDebounceChange');\n\t}\n\n\tsave(): Promise<any>\n\t{\n\t\tconst fieldsPanelOptions = {\n\t\t\t...this.getOptions().fieldsPanelOptions,\n\t\t\tdisabledFields: this.getValue().map((field) => {\n\t\t\t\treturn field.name;\n\t\t\t}),\n\t\t};\n\n\t\treturn Backend\n\t\t\t.getInstance()\n\t\t\t.saveFieldsSet({\n\t\t\t\tid: this.getOptions().setId,\n\t\t\t\tpresetId: fieldsPanelOptions?.presetId || null,\n\t\t\t\tentityTypeId: this.getEntityTypeId(),\n\t\t\t\tclientEntityTypeId: this.getClientEntityTypeId(),\n\t\t\t\t...this.getData(),\n\t\t\t\tfields: this.getValue(),\n\t\t\t})\n\t\t\t.then(() => {\n\t\t\t\tthis.emit('onSave');\n\t\t\t});\n\t}\n\n\tgetValue(): Array<{[key: string]: any}>\n\t{\n\t\treturn this.getItems().map((item) => {\n\t\t\treturn item.getValue();\n\t\t});\n\t}\n\n\t#adjustSliderDragAndDropOffsets()\n\t{\n\t\tconst sliderLayout = this.getLayout().closest('.ui-sidepanel-layout');\n\t\tif (Type.isDomNode(sliderLayout))\n\t\t{\n\t\t\tconst offsetLeft = -(sliderLayout.getBoundingClientRect().left);\n\n\t\t\tthis.draggable.setOptions({\n\t\t\t\t...this.draggable.getOptions(),\n\t\t\t\toffset: {\n\t\t\t\t\tx: offsetLeft,\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\t}\n\n\tonWindowResize()\n\t{\n\t\tthis.#adjustSliderDragAndDropOffsets();\n\t}\n\n\tshowSlider()\n\t{\n\n\t\tconst buttons = [];\n\t\tif (!this.getOptions().autoSave)\n\t\t{\n\t\t\tbuttons.push(\n\t\t\t\tnew SaveButton({\n\t\t\t\t\tonclick: (button) => {\n\t\t\t\t\t\tbutton.setWaiting(true);\n\t\t\t\t\t\tthis.save().then(() => {\n\t\t\t\t\t\t\tbutton.setWaiting(false);\n\t\t\t\t\t\t\tBX.SidePanel.Instance.close();\n\t\t\t\t\t\t}).catch((data) => {\n\t\t\t\t\t\t\ttop.BX.UI.Notification.Center.notify({\n\t\t\t\t\t\t\t\tcontent: data.errors.map((item) => Text.encode(item.message)).join('\\n'),\n\t\t\t\t\t\t\t\tautoHide: false\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tbutton.setWaiting(false);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}),\n\t\t\t);\n\t\t}\n\n\t\tBX.SidePanel.Instance.open('crm:field-list-editor', {\n\t\t\twidth: 600,\n\t\t\tcacheable: this.getOptions().cacheable,\n\t\t\tcontentCallback: () => {\n\t\t\t\treturn this.#loadPromise\n\t\t\t\t\t.then(() => Layout.createContent({\n\t\t\t\t\t\textensions: ['crm.field.list-editor'],\n\t\t\t\t\t\ttitle: this.getTitle(),\n\t\t\t\t\t\tcontent: () => this.getLayout(),\n\t\t\t\t\t\tbuttons: ({cancelButton}) => {\n\t\t\t\t\t\t\treturn [\n\t\t\t\t\t\t\t\t...buttons,\n\t\t\t\t\t\t\t\tcancelButton,\n\t\t\t\t\t\t\t];\n\t\t\t\t\t\t},\n\t\t\t\t\t}))\n\t\t\t\t\t.catch(({errors}) => Layout.createContent({\n\t\t\t\t\t\textensions: ['ui.sidepanel-content'],\n\t\t\t\t\t\tdesign: {section: false},\n\t\t\t\t\t\tcontent: () => {\n\t\t\t\t\t\t\tconst title = Loc.getMessage('CRM_FIELD_LIST_EDITOR_ERROR_IN_LOAD');\n\t\t\t\t\t\t\tconst msg = ((errors||[])[0]||{}).message || 'Unknown error';\n\t\t\t\t\t\t\treturn Tag.render`\n\t\t\t\t\t\t\t\t<div class=\"ui-slider-no-access\">\n\t\t\t\t\t\t\t\t\t<div class=\"ui-slider-no-access-inner\">\n\t\t\t\t\t\t\t\t\t\t<div class=\"ui-slider-no-access-title\">${Text.encode(title)}</div>\n\t\t\t\t\t\t\t\t\t\t<div class=\"ui-slider-no-access-subtitle\">${Text.encode(msg)}</div>\n\t\t\t\t\t\t\t\t\t\t<div class=\"ui-slider-no-access-img\">\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"ui-slider-no-access-img-inner\"></div>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t`;\n\t\t\t\t\t\t},\n\t\t\t\t\t\tbuttons: ({closeButton}) => {\n\t\t\t\t\t\t\treturn [\n\t\t\t\t\t\t\t\tcloseButton,\n\t\t\t\t\t\t\t];\n\t\t\t\t\t\t},\n\t\t\t\t\t}))\n\t\t\t\t;\n\t\t\t},\n\t\t\tevents: {\n\t\t\t\tonOpenComplete: () => {\n\t\t\t\t\tconst timeoutId = setTimeout(() => {\n\t\t\t\t\t\tclearTimeout(timeoutId);\n\t\t\t\t\t\tthis.#adjustSliderDragAndDropOffsets();\n\t\t\t\t\t}, 500);\n\t\t\t\t\tEvent.bind(window, 'resize', this.onWindowResize);\n\t\t\t\t},\n\t\t\t\tonClose: () => {\n\t\t\t\t\tEvent.unbind(window, 'resize', this.onWindowResize);\n\t\t\t\t},\n\t\t\t}\n\t\t});\n\t}\n\n\tonSortEnd()\n\t{\n\t\tconst listNodes = [...this.getListContainer().children];\n\n\t\tthis.getItems().sort((a, b) => {\n\t\t\tconst aIndex = listNodes.findIndex((node) => {\n\t\t\t\treturn a.getLayout() === node;\n\t\t\t});\n\n\t\t\tconst bIndex = listNodes.findIndex((node) => {\n\t\t\t\treturn b.getLayout() === node;\n\t\t\t});\n\n\t\t\treturn aIndex - bIndex;\n\t\t});\n\n\t\tthis.onChange();\n\t}\n}"],"names":["MemoryCache","Cache","_cache","babelHelpers","classPrivateFieldLooseKey","Item","EventEmitter","constructor","options","Object","defineProperty","writable","value","setEventNamespace","subscribeFromOptions","events","setOptions","onFormChange","bind","classPrivateFieldLooseBase","set","getOptions","get","getCustomTitleLayout","remember","getLayout","querySelector","data","categoryCaption","sourceData","label","caption","preparedCategoryCaption","Type","isStringFilled","Text","encode","Tag","render","_t","_","name","onEditClick","onRemoveClick","getFormLayout","event","preventDefault","isOpened","open","close","emit","Dom","addClass","hasClass","removeClass","createTextInput","_t2","createCheckbox","_t3","checked","getAllInputs","querySelectorAll","getValue","reduce","acc","input","type","textContent","getFormControls","editableEntries","entries","editable","map","_t4","_instance","Backend","getInstance","getFieldsList","presetId","Promise","resolve","reject","ajax","runAction","json","then","result","_result$data","isPlainObject","tree","catch","error","getFieldsSet","id","saveFieldsSet","_loadPromise","_defaultOptions","_adjustSliderDragAndDropOffsets","ListEditor","_adjustSliderDragAndDropOffsets2","setTitle","title","onWindowResize","onDebounceChange","Runtime","debounce","debouncingDelay","draggable","Draggable","container","getListContainer","dragElement","offset","x","context","window","top","subscribe","onSortEnd","showLoader","all","loadFieldsDictionary","loadValue","fieldsDictionary","setFieldsDictionary","console","setClientEntityTypeId","clientEntityTypeId","setEntityTypeId","entityTypeId","getTitle","isArrayFilled","fields","forEach","itemData","addItem","getFieldByName","hideLoader","setData","getData","getClientEntityTypeId","getEntityTypeId","getLoader","Loader","target","show","hide","getFieldsDictionary","onAddFieldClick","Loc","getMessage","renderTo","isDomNode","append","fieldsPanelOptions","disabledFields","field","setId","getItems","setItems","items","hasItem","some","item","getCategoryCaption","onChange","onRemove","onRemoveItemClick","push","getTarget","remove","filter","values","category","FIELDS","find","fieldName","hasField","CAPTION","showFieldsPanel","panelOptions","fieldsPanel","FieldsPanel","layout","document","body","getCrmFields","fieldData","isString","autoSave","save","showSlider","buttons","SaveButton","onclick","button","setWaiting","BX","SidePanel","Instance","UI","Notification","Center","notify","content","errors","message","join","autoHide","width","cacheable","contentCallback","Layout","createContent","extensions","cancelButton","design","section","msg","closeButton","onOpenComplete","timeoutId","setTimeout","clearTimeout","Event","onClose","unbind","listNodes","children","sort","a","b","aIndex","findIndex","node","bIndex","sliderLayout","closest","offsetLeft","getBoundingClientRect","left"],"mappings":"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"}