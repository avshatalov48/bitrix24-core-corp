(function(){"use strict";BX.namespace("BX.CRM.Kanban");BX.CRM.Kanban.Actions={startCallList:function(e,t){BX.Runtime.loadExtension("crm.entity-list.panel").then((({createCallList:n})=>{if(BX.Type.isUndefined(t)){t=true}const i=e.getData();return n(i.entityTypeInt,e.getCheckedId(),t)})).then((({errorMessages:e})=>{if(BX.Type.isArrayFilled(e)){const t=e.join(". \n");BX.Kanban.Utils.showErrorDialog(t)}}))},simpleAction:function(e,t,n){return new BX.CRM.Kanban.Actions.SimpleAction(e,t).showNotify(!n).applyFilterAfterAction(!n).execute()},setAssigned:function(e,t){const n={action:"setAssigned",ids:e.getCheckedId(),assignedId:t.entityId,assignedName:t.name};void this.simpleAction(e,n,false)},merge:function(e){var t=e.getCheckedId();var n=BX.Crm.BatchMergeManager.getItem(e.getData().gridId);if(n&&!n.isRunning()&&t.length>1){n.setEntityIds(t);n.execute()}},changeCategory:function(e,t){var n="";if(t.url){n=t.url}this.simpleAction(e,{action:"changeCategory",id:e.getCheckedId(),category:t.ID,categoryName:BX.util.htmlspecialchars(t.NAME),categoryLink:n},false)},changeColumn:function(e,t){var n=e.getData();e.firstRenderComplete=false;this.simpleAction(e,{action:"status",entity_id:e.getCheckedId(),status:t.id,statusName:BX.util.htmlspecialchars(t.name),entity_type:n.entityType},false)},delete:function(e,t,n){t=t??e.getCheckedId();const i={ids:t,showNotify:false};new BX.CRM.Kanban.Actions.DeleteAction(e,i).setDropZone(n).execute()},deleteAll:function(e){this.confirm(BX.Loc.getMessage("CRM_KANBAN_PANEL_ACTION_CONFIRM"),(()=>{const t={ids:e.getCheckedId(),applyFilterAfterAction:true,showNotify:false};new BX.CRM.Kanban.Actions.DeleteAction(e,t).execute()}),{grid:e})},open:function(e,t){if(typeof t==="undefined"){t=false}this.simpleAction(e,{action:"open",id:e.getCheckedId(),flag:t?"Y":"N"},false)},ignore:function(e,t){this.confirm(BX.message("CRM_KANBAN_PANEL_ACTION_CONFIRM"),function(){e.fadeOut();BX.ajax.runComponentAction("bitrix:crm.kanban","excludeEntity",{mode:"ajax",data:{entityType:e.getData().entityType,ids:e.getCheckedId()}}).then(function(t){this.simpleAction(e,{action:"delete",ignore:"Y",id:e.getCheckedId()},false)}.bind(this),function(t){e.stopActionPanel();e.onApplyFilter();BX.UI.Notification.Center.notify({content:t.errors[0].message})}.bind(this))}.bind(this),{grid:e})},refreshaccount:function(e){this.simpleAction(e,{action:"refreshAccount",id:e.getCheckedId()},false)},email:function(e){if(BX.CrmActivityEditor&&BX.CrmActivityProvider&&BX.CrmActivityEditor.items["kanban_activity_editor"]){var t=e.getData();var n=[];var i=e.getCheckedId();for(var a=0,o=i.length;a<o;a++){n.push({type:"EMAIL",entityId:i[a],entityType:t.entityType})}BX.CrmActivityEditor.items["kanban_activity_editor"].addEmail({communications:n,communicationsLoaded:true})}},task:function(e){const t=e.getData();let n="";const i=e.getCheckedId();const a=t.entityType;for(let e=0,t=i.length;e<t;e++){n+=BX.CrmOwnerTypeAbbr.resolve(a)+"_"+i[e]+";"}const o={UF_CRM_TASK:n,TITLE:"CRM: ",TAGS:"crm",ta_sec:"crm",ta_sub:a.toLowerCase(),ta_el:"context_menu"};let s=BX.message("CRM_TASK_CREATION_PATH");s=s.replace("#user_id#",BX.message("USER_ID"));s=BX.util.add_url_param(s,o);if(BX.SidePanel){BX.SidePanel.Instance.open(s)}else{window.top.location.href=s}},confirm:function(e,t,n={}){var i=BX.PopupWindowManager.create("crm-kanban-confirm-dialog",null,{titleBar:BX.message("CRM_KANBAN_CONFIRM_TITLE"),content:"",width:400,autoHide:false,overlay:true,closeByEsc:true,closeIcon:true,draggable:{restrict:true}});i.setContent(e);i.setButtons([,new BX.PopupWindowButton({text:BX.message("CRM_KANBAN_CONFIRM_Y"),className:"popup-window-button-accept",events:{click:function(){t();this.popupWindow.close()}}}),new BX.PopupWindowButton({text:BX.message("CRM_KANBAN_CONFIRM_N"),className:"popup-window-button-cancel",events:{click:function(){if(n.grid instanceof BX.CRM.Kanban.Grid){n.grid.resetMultiSelectMode()}this.popupWindow.close()}}})]);i.show();return i}}})();
//# sourceMappingURL=actions.map.js