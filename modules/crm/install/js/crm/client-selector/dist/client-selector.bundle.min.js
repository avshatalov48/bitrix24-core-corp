this.BX=this.BX||{};(function(e,t,s){"use strict";const i="client";var n=babelHelpers.classPrivateFieldLooseKey("getEntityAvatarPath");var o=babelHelpers.classPrivateFieldLooseKey("prepareEvents");class r{static createFromCommunications({targetNode:e,context:t=null,communications:s,selected:i=[],events:n={}}){const o=new r({targetNode:e,context:t,events:n});o.items=o.getPhoneSelectorItems(s);o.setSelected(i);return o}static createFromItems({targetNode:e,context:t=null,items:s,selected:i=[],events:n={}}){const o=new r({targetNode:e,context:t,events:n});o.items=o.prepareItems(s);o.setSelected(i);return o}constructor({targetNode:e,context:s=null,events:i={}}){Object.defineProperty(this,o,{value:c});Object.defineProperty(this,n,{value:a});this.items=[];this.events={};this.targetNode=e;this.context=t.Type.isStringFilled(s)?s:`crm-client-selector-${t.Text.getRandom()}`;this.events=t.Type.isObjectLike(i)?i:{}}setSelected(e){this.items.forEach((t=>t.selected=e.includes(t.id)));return this}getPhoneSelectorItems(e){const t=[];e.forEach((e=>{const{phones:s,entityTypeName:o,entityId:r,entityTypeId:a,caption:c}=e;if(!Array.isArray(s)){return}s.forEach((e=>{const{id:s,valueFormatted:l,typeLabel:d}=e;t.push({id:s,title:c,subtitle:`${l}, ${d}`,entityId:i,tabs:i,avatar:babelHelpers.classPrivateFieldLooseBase(this,n)[n](o),customData:{entityId:r,entityTypeId:a}})}))}));return t}prepareItems(e){return e.map((e=>{var t;e.entityId=i;e.tabs=i;if((t=e.customData)!=null&&t.entityTypeId&&!e.avatar){var s;const{entityTypeId:t}=e.customData;e.avatar=(s=e.avatar)!=null?s:babelHelpers.classPrivateFieldLooseBase(this,n)[n](BX.CrmEntityType.resolveName(t))}return e}))}show(){const{targetNode:e,context:n,items:r}=this;const a=babelHelpers.classPrivateFieldLooseBase(this,o)[o]();const c=[{id:i,title:t.Loc.getMessage("CRM_CLIENT_SELECTOR_TAB_TITLE")}];this.clientSelectorDialog=new s.Dialog({targetNode:e,id:"client-phone-selector-dialog",context:n,multiple:false,dropdownMode:true,showAvatars:true,enableSearch:true,width:450,zIndex:2500,items:r,tabs:c,events:a});this.clientSelectorDialog.show()}hide(){if(this.isOpen()){this.clientSelectorDialog.hide()}}isOpen(){return this.clientSelectorDialog&&this.clientSelectorDialog.isOpen()}}function a(e){e=e.toLowerCase();const t=["contact","company","lead"];if(!t.includes(e)){return""}return`/bitrix/images/crm/entity_provider_icons/${e}.svg`}function c(){const{events:{onSelect:e,onHide:t,onShow:s}}=this;const i={};if(e){i["Item:onSelect"]=e}if(t){i.onHide=t}if(s){i.onShow=s}return i}e.ClientSelector=r})(this.BX.Crm=this.BX.Crm||{},BX,BX.UI.EntitySelector);
//# sourceMappingURL=client-selector.bundle.map.js