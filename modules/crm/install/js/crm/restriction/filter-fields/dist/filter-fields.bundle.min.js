this.BX=this.BX||{};this.BX.Crm=this.BX.Crm||{};(function(exports,main_core){"use strict";var FilterFieldsRestriction=function(){function FilterFieldsRestriction(i){babelHelpers.classCallCheck(this,FilterFieldsRestriction);this.options=i;this.bindAddFilterItemEvent();this.bindGridSortEvent();this.bindCheckboxListOptionClick()}babelHelpers.createClass(FilterFieldsRestriction,[{key:"bindAddFilterItemEvent",value:function i(){var e,t=this;var r=(e=this.options.filterId)!==null&&e!==void 0?e:null;if(r&&BX.Main.filterManager){var n=BX.Main.filterManager.getById(r);if(n){n.getEmitter().subscribe("onBeforeChangeFilterItems",(function(i){var e=i.getData();var r=e.fields,n=e.oldFields;var l=r.filter((function(i){return!n.includes(i)}));var s=l.some((function(i){return t.isRestrictedFilterField(i)}));if(s){i.preventDefault();t.callRestrictionCallback()}}))}}}},{key:"bindGridSortEvent",value:function i(){var e,t=this;var r=(e=this.options.gridId)!==null&&e!==void 0?e:null;if(r&&BX.Main.gridManager){main_core.Event.EventEmitter.subscribe("BX.Main.grid:onBeforeSort",(function(i){var e=i.getData(),n=e.grid,l=e.columnName;if(n.getId()===r&&t.isRestrictedGridField(l)){i.preventDefault();t.callRestrictionCallback()}}))}}},{key:"bindCheckboxListOptionClick",value:function i(){var e=this;main_core.Event.EventEmitter.subscribe("ui:checkbox-list:check-option",(function(i){var t=i.getData(),r=t.id,n=t.context;if(!main_core.Type.isPlainObject(n)||!main_core.Type.isStringFilled(n.parentType)){return}if(n.parentType==="filter"&&e.isRestrictedFilterField(r)){i.preventDefault();e.callRestrictionCallback()}if(n.parentType==="grid"&&e.isRestrictedGridField(r)){i.preventDefault();e.callRestrictionCallback()}}))}},{key:"isRestrictedFilterField",value:function i(e){var t;var r=(t=this.options.filterFields)!==null&&t!==void 0?t:[];return main_core.Type.isArray(r)&&r.includes(e)}},{key:"isRestrictedGridField",value:function i(e){var t;var r=(t=this.options.gridFields)!==null&&t!==void 0?t:[];return main_core.Type.isArray(r)&&r.includes(e)}},{key:"callRestrictionCallback",value:function callRestrictionCallback(){if(main_core.Type.isStringFilled(this.options.callback)){eval(this.options.callback)}}}]);return FilterFieldsRestriction}();exports.FilterFieldsRestriction=FilterFieldsRestriction})(this.BX.Crm.Restriction=this.BX.Crm.Restriction||{},BX);
//# sourceMappingURL=filter-fields.bundle.map.js