this.BX=this.BX||{};this.BX.Crm=this.BX.Crm||{};(function(e,i,t,s){"use strict";var a=babelHelpers.classPrivateFieldLooseKey("entityTypeId");var o=babelHelpers.classPrivateFieldLooseKey("onSkippedPeriodChange");var r=babelHelpers.classPrivateFieldLooseKey("bindEvents");var l=babelHelpers.classPrivateFieldLooseKey("onExternalEvent");var n=babelHelpers.classPrivateFieldLooseKey("onSetSkipPeriod");var c=babelHelpers.classPrivateFieldLooseKey("onSkippedPeriodChangeCallback");class d{constructor(e){Object.defineProperty(this,c,{value:y});Object.defineProperty(this,n,{value:v});Object.defineProperty(this,l,{value:b});Object.defineProperty(this,r,{value:p});Object.defineProperty(this,a,{writable:true,value:null});Object.defineProperty(this,o,{writable:true,value:null});babelHelpers.classPrivateFieldLooseBase(this,a)[a]=e.entityTypeId;babelHelpers.classPrivateFieldLooseBase(this,o)[o]=e.onSkippedPeriodChange;babelHelpers.classPrivateFieldLooseBase(this,r)[r]()}saveSkippedPeriod(e){BX.localStorage.set("BX.Crm.onCrmEntityTodoNotificationSkip",{entityTypeId:babelHelpers.classPrivateFieldLooseBase(this,a)[a],period:e},5);i.EventEmitter.emit("BX.Crm.Activity.TodoNotification:SetSkipPeriod",{entityTypeId:babelHelpers.classPrivateFieldLooseBase(this,a)[a],period:e});return t.ajax.runAction("crm.activity.todo.skipEntityDetailsNotification",{data:{entityTypeId:babelHelpers.classPrivateFieldLooseBase(this,a)[a],period:e}}).then((()=>e)).catch((e=>{s.UI.Notification.Center.notify({content:e.errors.map((e=>e.message)).join(", "),autoHideDelay:5e3})}))}showCancelPeriodNotification(){const e=this;s.UI.Notification.Center.notify({content:t.Loc.getMessage("CRM_ACTIVITY_TODO_NOTIFICATION_CANCELED_TEXT"),autoHideDelay:3e3,actions:[{title:t.Loc.getMessage("CRM_ACTIVITY_TODO_NOTIFICATION_CANCELED_BUTTON"),events:{click:function(i,t,s){t.close();e.saveSkippedPeriod("")}}}]})}}function p(){i.EventEmitter.subscribe("onLocalStorageSet",babelHelpers.classPrivateFieldLooseBase(this,l)[l].bind(this));i.EventEmitter.subscribe("BX.Crm.Activity.TodoNotification:SetSkipPeriod",babelHelpers.classPrivateFieldLooseBase(this,n)[n].bind(this))}function b(e){const[i]=e.getData();if(i.key==="BX.Crm.onCrmEntityTodoNotificationSkip"){const e=i.value;if(e.entityTypeId===babelHelpers.classPrivateFieldLooseBase(this,a)[a]){babelHelpers.classPrivateFieldLooseBase(this,c)[c](e.period)}}}function v(e){babelHelpers.classPrivateFieldLooseBase(this,c)[c](e.getData().period)}function y(e){if(t.Type.isFunction(babelHelpers.classPrivateFieldLooseBase(this,o)[o])){babelHelpers.classPrivateFieldLooseBase(this,o)[o](e)}}e.TodoNotificationSkip=d})(this.BX.Crm.Activity=this.BX.Crm.Activity||{},BX.Event,BX,BX);
//# sourceMappingURL=todo-notification-skip.bundle.map.js