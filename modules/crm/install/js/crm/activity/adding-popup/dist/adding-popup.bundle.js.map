{"version":3,"file":"adding-popup.bundle.js","sources":["../src/adding-popup.js"],"sourcesContent":["import { TodoEditorMode, TodoEditorV2 } from 'crm.activity.todo-editor-v2';\nimport { ajax as Ajax, Loc, Tag, Text, Type } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport type { PopupOptions } from 'main.popup';\nimport { Popup } from 'main.popup';\nimport { ButtonColor, ButtonSize, CancelButton, SaveButton } from 'ui.buttons';\nimport { UI } from 'ui.notification';\n\nimport './adding-popup.css';\n\ntype Context = {\n\tanalytics: Object;\n}\n\n/**\n * @event onSave\n * @event onClose\n */\nexport class AddingPopup\n{\n\t#entityId: Number = null;\n\t#entityTypeId: Number = null;\n\t#currentUser: Object = null;\n\t#pingSettings: Object = null;\n\t#calendarSettings: Object = null;\n\t#colorSettings: Object = null;\n\t#popup: ?Popup = null;\n\t#popupContainer: HTMLElement = null;\n\t#popupToDoEditorContainer: HTMLElement = null;\n\t#todoEditor: TodoEditorV2 | null = null;\n\t#eventEmitter: EventEmitter = null;\n\t#context: Context = {};\n\n\tconstructor(entityTypeId: Number, entityId: Number, currentUser: Object, settings: Object, params: Object)\n\t{\n\t\tthis.#entityId = Text.toInteger(entityId);\n\t\tthis.#entityTypeId = Text.toInteger(entityTypeId);\n\t\tthis.#currentUser = currentUser;\n\n\t\tthis.#eventEmitter = new EventEmitter();\n\t\tthis.#eventEmitter.setEventNamespace('Crm.Activity.AddingPopup');\n\n\t\tif (Type.isObject(settings))\n\t\t{\n\t\t\tthis.#pingSettings = settings.pingSettings ?? null;\n\t\t\tthis.#calendarSettings = settings.calendarSettings ?? null;\n\t\t\tthis.#colorSettings = settings.colorSettings ?? null;\n\t\t}\n\n\t\tif (!Type.isPlainObject(params))\n\t\t{\n\t\t\t// eslint-disable-next-line no-param-reassign\n\t\t\tparams = {};\n\t\t}\n\n\t\tif (Type.isObject(params.events))\n\t\t{\n\t\t\tfor (const eventName in params.events)\n\t\t\t{\n\t\t\t\tif (Type.isFunction(params.events[eventName]))\n\t\t\t\t{\n\t\t\t\t\tthis.#eventEmitter.subscribe(eventName, params.events[eventName]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (Type.isPlainObject(params.context))\n\t\t{\n\t\t\tthis.#context = params.context;\n\t\t}\n\t}\n\n\tasync show(mode: String = TodoEditorMode.ADD)\n\t{\n\t\tconst popup = this.#createPopupIfNotExists();\n\n\t\tif (popup.isShown())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this.#popupToDoEditorContainer.hasChildNodes())\n\t\t{\n\t\t\tawait this.#createToDoEditor();\n\n\t\t\tpopup.setButtons([\n\t\t\t\tnew SaveButton({\n\t\t\t\t\tid: 'save',\n\t\t\t\t\tcolor: ButtonColor.PRIMARY,\n\t\t\t\t\tsize: ButtonSize.EXTRA_SMALL,\n\t\t\t\t\tround: true,\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tclick: this.#saveAndClose.bind(this),\n\t\t\t\t\t},\n\t\t\t\t}),\n\t\t\t\tnew CancelButton({\n\t\t\t\t\tid: 'cancel',\n\t\t\t\t\tsize: ButtonSize.EXTRA_SMALL,\n\t\t\t\t\tround: true,\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tclick: () => popup.close(),\n\t\t\t\t\t},\n\t\t\t\t}),\n\t\t\t]);\n\n\t\t\tpopup.subscribeOnce('onFirstShow', (event) => {\n\t\t\t\tevent.target.getZIndexComponent().setZIndex(1400);\n\t\t\t\tthis.#todoEditor.show();\n\t\t\t});\n\t\t\tpopup.subscribe('onAfterShow', () => {\n\t\t\t\tthis.#actualizePopupLayout();\n\t\t\t\tthis.#todoEditor.setFocused();\n\t\t\t});\n\t\t\tpopup.subscribe('onAfterClose', () => {\n\t\t\t\tvoid this.#todoEditor.resetToDefaults().then(() => {\n\t\t\t\t\tthis.#eventEmitter.emit('onClose');\n\t\t\t\t});\n\t\t\t});\n\t\t\tpopup.subscribe('onShow', () => {\n\t\t\t\tconst { mode: todoEditorMode, activity } = popup.params;\n\t\t\t\tif (todoEditorMode === TodoEditorMode.UPDATE && activity)\n\t\t\t\t{\n\t\t\t\t\tthis.#todoEditor\n\t\t\t\t\t\t.setMode(todoEditorMode)\n\t\t\t\t\t\t.setActivityId(activity.id)\n\t\t\t\t\t\t.setDescription(activity.description)\n\t\t\t\t\t\t.setDeadline(activity.deadline)\n\t\t\t\t\t;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tthis.#prepareAndShowPopup(popup, mode);\n\t}\n\n\tasync #createToDoEditor(): TodoEditorV2\n\t{\n\t\t// just created, initialize\n\t\tconst params = {\n\t\t\tcontainer: this.#popupToDoEditorContainer,\n\t\t\townerTypeId: this.#entityTypeId,\n\t\t\townerId: this.#entityId,\n\t\t\tcurrentUser: this.#currentUser,\n\t\t\tpingSettings: this.#pingSettings,\n\t\t\tevents: {\n\t\t\t\tonSaveHotkeyPressed: this.#onEditorSaveHotkeyPressed.bind(this),\n\t\t\t\tonChangeUploaderContainerSize: this.#onChangeUploaderContainerSize.bind(this),\n\t\t\t\tonFocus: this.#onFocus.bind(this),\n\t\t\t},\n\t\t\tpopupMode: true,\n\t\t};\n\n\t\tconst analytics = this.#context?.analytics ?? {};\n\t\tconst section = analytics.c_section ?? null;\n\t\tconst subSection = analytics.c_sub_section ?? null;\n\n\t\tparams.calendarSettings = this.#calendarSettings;\n\t\tparams.colorSettings = this.#colorSettings;\n\t\tparams.defaultDescription = '';\n\t\tparams.analytics = {\n\t\t\tsection,\n\t\t\tsubSection,\n\t\t};\n\n\t\tthis.#todoEditor = new TodoEditorV2(params);\n\t}\n\n\t#prepareAndShowPopup(popup: Popup, mode: String = TodoEditorMode.ADD): void\n\t{\n\t\t// eslint-disable-next-line no-param-reassign\n\t\tpopup.params.mode = mode;\n\t\tif (mode === TodoEditorMode.ADD)\n\t\t{\n\t\t\tpopup.show();\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (mode === TodoEditorMode.UPDATE)\n\t\t{\n\t\t\tvoid this.#fetchNearActivity().then((data) => {\n\t\t\t\tif (data)\n\t\t\t\t{\n\t\t\t\t\t// eslint-disable-next-line no-param-reassign\n\t\t\t\t\tpopup.params.activity = data;\n\t\t\t\t\tpopup.show();\n\t\t\t\t}\n\t\t\t});\n\n\t\t\treturn;\n\t\t}\n\n\t\tconsole.error('Wrong TodoEditor mode');\n\t}\n\n\t#fetchNearActivity(): Promise\n\t{\n\t\tconst data = {\n\t\t\townerTypeId: this.#entityTypeId,\n\t\t\townerId: this.#entityId,\n\t\t};\n\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tAjax.runAction('crm.activity.todo.getNearest', { data })\n\t\t\t\t.then(({ data: responseData }) => resolve(responseData))\n\t\t\t\t.catch((response) => {\n\t\t\t\t\tUI.Notification.Center.notify({\n\t\t\t\t\t\tcontent: response.errors[0].message,\n\t\t\t\t\t\tautoHideDelay: 5000,\n\t\t\t\t\t});\n\t\t\t\t\treject();\n\t\t\t\t});\n\t\t});\n\t}\n\n\t#createPopupIfNotExists(): Popup\n\t{\n\t\tif (!this.#popup || this.#popup.isDestroyed())\n\t\t{\n\t\t\tthis.#popupToDoEditorContainer = Tag.render`<div></div>`;\n\t\t\tthis.#popupContainer = Tag.render`\n\t\t\t\t<div class=\"crm-activity-adding-popup-container\">\n\t\t\t\t\t${this.#getPopupTitle()}\n\t\t\t\t\t${this.#popupToDoEditorContainer}\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tthis.#popup = new Popup(this.#getPopupParams());\n\t\t}\n\n\t\treturn this.#popup;\n\t}\n\n\t#getPopupTitle(): ?HTMLDivElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"crm-activity-adding-popup-title\">\n\t\t\t\t${Loc.getMessage('CRM_ACTIVITY_ADDING_POPUP_TITLE')}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#getPopupParams(): PopupOptions\n\t{\n\t\tconst { innerWidth } = window;\n\n\t\treturn {\n\t\t\tid: `kanban_planner_menu_${this.#entityId}`,\n\t\t\tcontent: this.#popupContainer,\n\t\t\tcacheable: false,\n\t\t\tisScrollBlock: true,\n\t\t\tclassName: 'crm-activity-adding-popup',\n\t\t\tcloseByEsc: true,\n\t\t\tcloseIcon: false,\n\t\t\tpadding: 16,\n\t\t\tminWidth: 537,\n\t\t\twidth: Math.round(innerWidth * 0.45),\n\t\t\tmaxWidth: 737,\n\t\t\tminHeight: 150,\n\t\t\tmaxHeight: 482,\n\t\t\toverlay: {\n\t\t\t\topacity: 50,\n\t\t\t},\n\t\t};\n\t}\n\n\t#saveAndClose(): void\n\t{\n\t\tif (this.#popup)\n\t\t{\n\t\t\tconst saveButton = this.#popup.getButton('save');\n\t\t\tif (saveButton.getState())\n\t\t\t{\n\t\t\t\treturn; // button is disabled\n\t\t\t}\n\t\t\tsaveButton?.setWaiting(true);\n\t\t\tthis.#todoEditor.save()\n\t\t\t\t.then(() => {\n\t\t\t\t\tthis.#popup.close();\n\t\t\t\t\tthis.#eventEmitter.emit('onSave');\n\t\t\t\t})\n\t\t\t\t.catch(() => {})\n\t\t\t\t.finally(() => saveButton?.setWaiting(false))\n\t\t\t;\n\t\t}\n\t}\n\n\t#actualizePopupLayout(description): void\n\t{\n\t\tif (this.#popup && this.#popup.isShown())\n\t\t{\n\t\t\tthis.#eventEmitter.emit('onActualizePopupLayout', { entityId: this.#entityId });\n\n\t\t\tthis.#popup.adjustPosition({\n\t\t\t\tforceBindPosition: true,\n\t\t\t});\n\t\t}\n\t}\n\n\t#onEditorSaveHotkeyPressed()\n\t{\n\t\tthis.#saveAndClose();\n\t}\n\n\t#onChangeUploaderContainerSize()\n\t{\n\t\tif (this.#popup)\n\t\t{\n\t\t\tthis.#eventEmitter.emit('onActualizePopupLayout', { entityId: this.#entityId });\n\t\t\tthis.#popup.adjustPosition();\n\t\t}\n\t}\n\n\t#onFocus()\n\t{\n\t\tsetTimeout(() => {\n\t\t\tconst popup = this.#createPopupIfNotExists();\n\n\t\t\tpopup.adjustPosition({\n\t\t\t\tforceBindPosition: true,\n\t\t\t});\n\t\t}, 0);\n\t}\n}\n"],"names":["AddingPopup","entityTypeId","entityId","currentUser","settings","params","Text","toInteger","EventEmitter","setEventNamespace","Type","isObject","pingSettings","calendarSettings","colorSettings","isPlainObject","events","eventName","isFunction","subscribe","context","mode","TodoEditorMode","ADD","popup","isShown","hasChildNodes","setButtons","SaveButton","id","color","ButtonColor","PRIMARY","size","ButtonSize","EXTRA_SMALL","round","click","bind","CancelButton","close","subscribeOnce","event","target","getZIndexComponent","setZIndex","show","setFocused","resetToDefaults","then","emit","todoEditorMode","activity","UPDATE","setMode","setActivityId","setDescription","description","setDeadline","deadline","container","ownerTypeId","ownerId","onSaveHotkeyPressed","onChangeUploaderContainerSize","onFocus","popupMode","analytics","section","c_section","subSection","c_sub_section","defaultDescription","TodoEditorV2","data","console","error","Promise","resolve","reject","Ajax","runAction","responseData","catch","response","UI","Notification","Center","notify","content","errors","message","autoHideDelay","isDestroyed","Tag","render","Popup","Loc","getMessage","innerWidth","window","cacheable","isScrollBlock","className","closeByEsc","closeIcon","padding","minWidth","width","Math","maxWidth","minHeight","maxHeight","overlay","opacity","saveButton","getButton","getState","setWaiting","save","finally","adjustPosition","forceBindPosition","setTimeout"],"mappings":"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"}