{"version":3,"file":"adding-popup.bundle.js","sources":["../src/adding-popup.js"],"sourcesContent":["import { ajax as Ajax, Tag, Text, Type } from \"main.core\";\nimport { Popup } from \"main.popup\";\nimport { ButtonColor, ButtonSize, ButtonState, CancelButton, SaveButton } from \"ui.buttons\";\nimport { TodoEditor, TodoEditorMode } from \"crm.activity.todo-editor\";\nimport { BaseEvent, EventEmitter } from \"main.core.events\";\nimport { UI } from 'ui.notification';\n\nimport \"./adding-popup.css\"\n\n/**\n * @event onSave\n * @event onClose\n */\nexport class AddingPopup\n{\n\t#entityId: Number = null;\n\t#entityTypeId: Number = null;\n\t#currentUser: Object = null;\n\t#popup: ?Popup = null;\n\t#popupContainer: HTMLElement = null;\n\t#todoEditor: ?TodoEditor = null;\n\t#eventEmitter: EventEmitter = null;\n\n\tconstructor(entityTypeId: Number, entityId: Number, currentUser: Object, params: Object)\n\t{\n\t\tthis.#entityId = Text.toInteger(entityId);\n\t\tthis.#entityTypeId = Text.toInteger(entityTypeId);\n\t\tthis.#currentUser = currentUser;\n\n\t\tthis.#eventEmitter = new EventEmitter;\n\t\tthis.#eventEmitter.setEventNamespace('Crm.Activity.AddingPopup');\n\n\t\tif (!Type.isPlainObject(params))\n\t\t{\n\t\t\tparams = {};\n\t\t}\n\n\t\tif (Type.isObject(params.events))\n\t\t{\n\t\t\tfor (const eventName in params.events)\n\t\t\t{\n\t\t\t\tif (Type.isFunction(params.events[eventName]))\n\t\t\t\t{\n\t\t\t\t\tthis.#eventEmitter.subscribe(eventName, params.events[eventName]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tshow(bindElement: HTMLElement, mode: String = TodoEditorMode.ADD)\n\t{\n\t\tconst popup = this.#createPopupIfNotExists();\n\t\tpopup.setBindElement(bindElement);\n\t\tif (popup.isShown())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this.#popupContainer.hasChildNodes())\n\t\t{\n\t\t\t// just created, initialize\n\t\t\tthis.#todoEditor = new TodoEditor({\n\t\t\t\tcontainer: this.#popupContainer,\n\t\t\t\townerTypeId: this.#entityTypeId,\n\t\t\t\townerId: this.#entityId,\n\t\t\t\tcurrentUser: this.#currentUser,\n\t\t\t\tevents: {\n\t\t\t\t\tonChangeDescription: this.#onChangeEditorDescription.bind(this),\n\t\t\t\t\tonSaveHotkeyPressed: this.#onEditorSaveHotkeyPressed.bind(this),\n\t\t\t\t\tonChangeUploaderContainerSize: this.#onChangeUploaderContainerSize.bind(this),\n\t\t\t\t},\n\t\t\t\tpopupMode: true\n\t\t\t});\n\n\t\t\tpopup.setButtons([\n\t\t\t\tnew SaveButton({\n\t\t\t\t\tid: 'save',\n\t\t\t\t\tcolor: ButtonColor.PRIMARY,\n\t\t\t\t\tsize: ButtonSize.EXTRA_SMALL,\n\t\t\t\t\tround: true,\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tclick: this.#saveAndClose.bind(this),\n\t\t\t\t\t}\n\t\t\t\t}),\n\t\t\t\tnew CancelButton({\n\t\t\t\t\tid: 'cancel',\n\t\t\t\t\tsize: ButtonSize.EXTRA_SMALL,\n\t\t\t\t\tround: true,\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tclick: () => popup.close(),\n\t\t\t\t\t}\n\t\t\t\t}),\n\t\t\t]);\n\n\t\t\tpopup.subscribeOnce('onFirstShow', (event) => {\n\t\t\t\tevent.target.getZIndexComponent().setZIndex(1400);\n\t\t\t\tthis.#todoEditor.show();\n\t\t\t});\n\t\t\tpopup.subscribe('onAfterShow', () => {\n\t\t\t\tthis.#actualizePopupLayout(this.#todoEditor.getDescription());\n\t\t\t\tthis.#todoEditor.setFocused();\n\t\t\t});\n\t\t\tpopup.subscribe('onAfterClose', () => {\n\t\t\t\tthis.#todoEditor.resetToDefaults().then(()=>{\n\t\t\t\t\tthis.#eventEmitter.emit('onClose');\n\t\t\t\t});\n\t\t\t});\n\t\t\tpopup.subscribe('onShow', () => {\n\t\t\t\tconst { mode, activity } = popup.params;\n\t\t\t\tif (mode === TodoEditorMode.UPDATE && activity)\n\t\t\t\t{\n\t\t\t\t\tthis.#todoEditor\n\t\t\t\t\t\t.setMode(mode)\n\t\t\t\t\t\t.setActivityId(activity.id)\n\t\t\t\t\t\t.setDescription(activity.description)\n\t\t\t\t\t\t.setDeadline(activity.deadline)\n\t\t\t\t\t;\n\n\t\t\t\t\tif (Type.isArrayFilled(activity.storageElementIds))\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.#todoEditor.setStorageElementIds(activity.storageElementIds);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tthis.#prepareAndShowPopup(popup, mode);\n\t}\n\n\t#prepareAndShowPopup(popup: Popup, mode: String = TodoEditorMode.ADD): void\n\t{\n\t\tpopup.params.mode = mode;\n\t\tif (mode === TodoEditorMode.ADD)\n\t\t{\n\t\t\tpopup.show();\n\t\t\treturn;\n\t\t}\n\n\t\tif (mode === TodoEditorMode.UPDATE)\n\t\t{\n\t\t\tthis.#fetchNearActivity().then(data => {\n\t\t\t\tif (data)\n\t\t\t\t{\n\t\t\t\t\tpopup.params.activity = data;\n\t\t\t\t\tpopup.show();\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn;\n\t\t}\n\n\t\tconsole.error('Wrong TodoEditor mode');\n\t}\n\n\t#fetchNearActivity(): Promise\n\t{\n\t\tconst data = {\n\t\t\townerTypeId: this.#entityTypeId,\n\t\t\townerId: this.#entityId,\n\t\t};\n\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tAjax.runAction('crm.activity.todo.getNearest', {data})\n\t\t\t\t.then(({data}) => resolve(data))\n\t\t\t\t.catch(response => {\n\t\t\t\t\tUI.Notification.Center.notify({\n\t\t\t\t\t\tcontent: response.errors[0].message,\n\t\t\t\t\t\tautoHideDelay: 5000,\n\t\t\t\t\t});\n\t\t\t\t\treject();\n\t\t\t\t});\n\t\t});\n\t}\n\n\t#createPopupIfNotExists(): Popup\n\t{\n\t\tif (!this.#popup || this.#popup.isDestroyed())\n\t\t{\n\t\t\tthis.#popupContainer = Tag.render`<div class=\"crm-activity-adding-popup-container\"></div>`;\n\t\t\tthis.#popup = new Popup({\n\t\t\t\tid: `kanban_planner_menu_${this.#entityId}`,\n\t\t\t\toverlay: {\n\t\t\t\t\topacity: 0,\n\t\t\t\t},\n\t\t\t\tcontent: this.#popupContainer,\n\t\t\t\tcacheable: false,\n\t\t\t\tisScrollBlock: true,\n\t\t\t\tclassName: 'crm-activity-adding-popup',\n\t\t\t\tcloseByEsc: true,\n\t\t\t\tcloseIcon: false,\n\t\t\t\tangle: {\n\t\t\t\t\toffset: 27,\n\t\t\t\t},\n\t\t\t\tpadding: 16,\n\t\t\t\tminWidth: 500,\n\t\t\t\tmaxWidth: 550,\n\t\t\t\tminHeight: 150,\n\t\t\t\tmaxHeight: 400,\n\t\t\t});\n\t\t}\n\n\t\treturn this.#popup;\n\t}\n\n\tbindPopup(bindElement: HTMLElement): void\n\t{\n\t\tif (!this.#popup)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (bindElement !== this.#popup.bindElement)\n\t\t{\n\t\t\tthis.#popup.setBindElement(bindElement);\n\t\t}\n\t}\n\n\t#saveAndClose(): void\n\t{\n\t\tif (this.#popup)\n\t\t{\n\t\t\tconst saveButton = this.#popup.getButton('save');\n\t\t\tif (saveButton.getState())\n\t\t\t{\n\t\t\t\treturn; // button is disabled\n\t\t\t}\n\t\t\tsaveButton?.setWaiting(true);\n\t\t\tthis.#todoEditor.save()\n\t\t\t\t.then(() => {\n\t\t\t\t\tthis.#popup.close();\n\t\t\t\t\tthis.#eventEmitter.emit('onSave');\n\t\t\t\t})\n\t\t\t\t.catch(() => {})\n\t\t\t\t.finally(() => saveButton?.setWaiting(false))\n\t\t\t;\n\t\t}\n\t}\n\n\t#actualizePopupLayout(description): void{\n\t\tif (this.#popup && this.#popup.isShown())\n\t\t{\n\t\t\tthis.#eventEmitter.emit('onActualizePopupLayout', { entityId: this.#entityId });\n\n\t\t\tthis.#popup.adjustPosition({\n\t\t\t\tforceBindPosition: true,\n\t\t\t});\n\n\t\t\tconst saveButton = this.#popup.getButton('save');\n\n\t\t\tif (!description.length && saveButton && !saveButton.getState())\n\t\t\t{\n\t\t\t\tsaveButton.setState(ButtonState.DISABLED);\n\t\t\t}\n\t\t\telse if (description.length && saveButton && saveButton.getState() === ButtonState.DISABLED)\n\t\t\t{\n\t\t\t\tsaveButton.setState(null);\n\t\t\t}\n\t\t}\n\t}\n\n\t#onChangeEditorDescription(event: BaseEvent)\n\t{\n\t\tconst {description} = event.getData();\n\t\tthis.#actualizePopupLayout(description);\n\t}\n\n\t#onEditorSaveHotkeyPressed()\n\t{\n\t\tthis.#saveAndClose();\n\t}\n\n\t#onChangeUploaderContainerSize()\n\t{\n\t\tif (this.#popup)\n\t\t{\n\t\t\tthis.#eventEmitter.emit('onActualizePopupLayout', { entityId: this.#entityId });\n\t\t\tthis.#popup.adjustPosition();\n\t\t}\n\t}\n}\n"],"names":["AddingPopup","entityTypeId","entityId","currentUser","params","Text","toInteger","EventEmitter","setEventNamespace","Type","isPlainObject","isObject","events","eventName","isFunction","subscribe","bindElement","mode","TodoEditorMode","ADD","popup","setBindElement","isShown","hasChildNodes","TodoEditor","container","ownerTypeId","ownerId","onChangeDescription","bind","onSaveHotkeyPressed","onChangeUploaderContainerSize","popupMode","setButtons","SaveButton","id","color","ButtonColor","PRIMARY","size","ButtonSize","EXTRA_SMALL","round","click","CancelButton","close","subscribeOnce","event","target","getZIndexComponent","setZIndex","show","getDescription","setFocused","resetToDefaults","then","emit","activity","UPDATE","setMode","setActivityId","setDescription","description","setDeadline","deadline","isArrayFilled","storageElementIds","setStorageElementIds","data","console","error","Promise","resolve","reject","Ajax","runAction","catch","response","UI","Notification","Center","notify","content","errors","message","autoHideDelay","isDestroyed","Tag","render","Popup","overlay","opacity","cacheable","isScrollBlock","className","closeByEsc","closeIcon","angle","offset","padding","minWidth","maxWidth","minHeight","maxHeight","saveButton","getButton","getState","setWaiting","save","finally","adjustPosition","forceBindPosition","length","setState","ButtonState","DISABLED","getData"],"mappings":"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"}