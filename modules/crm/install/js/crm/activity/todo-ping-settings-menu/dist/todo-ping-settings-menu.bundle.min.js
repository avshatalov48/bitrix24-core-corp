this.BX=this.BX||{};this.BX.Crm=this.BX.Crm||{};(function(e,s,t){"use strict";const a="menu-popup-item-accept";const i="menu-popup-item-none";const l=750;var r=babelHelpers.classPrivateFieldLooseKey("entityTypeId");var o=babelHelpers.classPrivateFieldLooseKey("settings");var n=babelHelpers.classPrivateFieldLooseKey("selectedOffsets");var b=babelHelpers.classPrivateFieldLooseKey("isLoadingMenuItem");var c=babelHelpers.classPrivateFieldLooseKey("getPintSettingsMenuItems");var d=babelHelpers.classPrivateFieldLooseKey("getMenuItemClass");var p=babelHelpers.classPrivateFieldLooseKey("isLoading");var v=babelHelpers.classPrivateFieldLooseKey("onMenuItemClick");class h{constructor(e){Object.defineProperty(this,v,{value:L});Object.defineProperty(this,p,{value:f});Object.defineProperty(this,d,{value:u});Object.defineProperty(this,c,{value:P});Object.defineProperty(this,r,{writable:true,value:null});Object.defineProperty(this,o,{writable:true,value:null});Object.defineProperty(this,n,{writable:true,value:null});Object.defineProperty(this,b,{writable:true,value:false});babelHelpers.classPrivateFieldLooseBase(this,r)[r]=e.entityTypeId;babelHelpers.classPrivateFieldLooseBase(this,o)[o]=e.settings;if(!s.Type.isStringFilled(babelHelpers.classPrivateFieldLooseBase(this,o)[o].optionName)){throw new Error("Option name are not defined.")}babelHelpers.classPrivateFieldLooseBase(this,n)[n]=babelHelpers.classPrivateFieldLooseBase(this,o)[o].currentOffsets||[];babelHelpers.classPrivateFieldLooseBase(this,n)[n]=babelHelpers.classPrivateFieldLooseBase(this,n)[n].map((e=>parseInt(e,10)));if(!s.Type.isArrayFilled(babelHelpers.classPrivateFieldLooseBase(this,o)[o].currentOffsets)){throw new Error("Offsets are not defined.")}}setSelectedValues(e){babelHelpers.classPrivateFieldLooseBase(this,n)[n]=e.map((e=>parseInt(e,10)))}getItems(){const e=[];e.push({id:"askForSetupTodoPing",text:s.Loc.getMessage("CRM_ACTIVITY_TODO_PING_SETTINGS_MENU_ITEM"),className:i,items:babelHelpers.classPrivateFieldLooseBase(this,c)[c]()});return e}}function P(){if(s.Type.isNull(babelHelpers.classPrivateFieldLooseBase(this,o)[o].offsetList)||!s.Type.isArrayFilled(babelHelpers.classPrivateFieldLooseBase(this,o)[o].offsetList)){return[]}const e=[];babelHelpers.classPrivateFieldLooseBase(this,o)[o].offsetList.forEach((s=>{e.push({id:s.id,text:s.title,className:babelHelpers.classPrivateFieldLooseBase(this,d)[d](parseInt(s.offset,10)),disabled:babelHelpers.classPrivateFieldLooseBase(this,p)[p](),onclick:babelHelpers.classPrivateFieldLooseBase(this,v)[v].bind(this,parseInt(s.offset,10))})}));return e}function u(e){return babelHelpers.classPrivateFieldLooseBase(this,n)[n].includes(e)?a:i}function f(){return babelHelpers.classPrivateFieldLooseBase(this,b)[b]}function L(e,t,r){babelHelpers.classPrivateFieldLooseBase(this,b)[b]=true;if(babelHelpers.classPrivateFieldLooseBase(this,n)[n].includes(e)){if(babelHelpers.classPrivateFieldLooseBase(this,n)[n].length===1){BX.UI.Hint.show(r.getContainer(),s.Loc.getMessage("CRM_ACTIVITY_TODO_PING_SETTINGS_MENU_ITEM_TOOLTIP"));babelHelpers.classPrivateFieldLooseBase(this,b)[b]=false;return}babelHelpers.classPrivateFieldLooseBase(this,n)[n]=babelHelpers.classPrivateFieldLooseBase(this,n)[n].filter((s=>s!==e));s.Dom.removeClass(r.getContainer(),a);s.Dom.addClass(r.getContainer(),i)}else{babelHelpers.classPrivateFieldLooseBase(this,n)[n].push(e);s.Dom.removeClass(r.getContainer(),i);s.Dom.addClass(r.getContainer(),a)}if(babelHelpers.classPrivateFieldLooseBase(this,n)[n].length===0){throw new Error("Offsets are not defined.")}setTimeout((()=>{BX.userOptions.save("crm",babelHelpers.classPrivateFieldLooseBase(this,o)[o].optionName,"offsets",babelHelpers.classPrivateFieldLooseBase(this,n)[n].join(","));babelHelpers.classPrivateFieldLooseBase(this,b)[b]=false}),l)}e.TodoPingSettingsMenu=h})(this.BX.Crm.Activity=this.BX.Crm.Activity||{},BX,BX.Main);
//# sourceMappingURL=todo-ping-settings-menu.bundle.map.js