{"version":3,"file":"settings-popup.bundle.js","sources":["../src/components/section/section.js","../src/components/calendar/recall-button.js","../src/components/calendar/calendar.js","../src/components/wrapper/wrapper.js","../src/settings-popup.js"],"sourcesContent":["export const Section = {\n\tprops: {\n\t\tid: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\ttoggleTitle: {\n\t\t\ttype: String,\n\t\t\tdefault: '',\n\t\t},\n\t\ttoggleEnabled: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true,\n\t\t},\n\t\ttoggleVisible: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true,\n\t\t},\n\t},\n\n\twatch: {\n\t\tenabled() {\n\t\t\tthis.$emit('onToggle', {\n\t\t\t\tid: this.id,\n\t\t\t\tisActive: this.enabled,\n\t\t\t});\n\t\t},\n\t},\n\n\tdata() {\n\t\treturn {\n\t\t\tenabled: this.toggleEnabled,\n\t\t}\n\t},\n\n\ttemplate: `\n\t\t<section>\n\t\t\t<div class=\"ui-form-row\" v-if=\"toggleVisible\">\n\t\t\t\t<label for class=\"ui-ctl ui-ctl-checkbox\" @click=\"enabled = !enabled\">\n\t\t\t\t\t<input type=\"checkbox\" class=\"ui-ctl-element\" v-model=\"enabled\">\n\t\t\t\t\t<div class=\"ui-ctl-label-text\">{{ toggleTitle }}</div>\n\t\t\t\t</label>\n\t\t\t</div>\n\t\t\t<div class=\"ui-form-row\" v-else>\n\t\t\t\t<label>\n\t\t\t\t\t<div class=\"ui-ctl-label-text\">{{ toggleTitle }}</div>\n\t\t\t\t</label>\n\t\t\t</div>\n\t\t\t<slot v-if=\"enabled\"></slot>\n\t\t</section>\n\t`\n};\n","export const RecallButton = {\n\tprops: {\n\t\tid: String,\n\t\tactive: Boolean,\n\t\ttitle: String,\n\t},\n\tmethods: {\n\t\tonClick: function() {\n\t\t\tthis.$emit('onClick', this.id);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<button @click=\"onClick\" :class=\"['ui-btn ui-btn-secondary ui-btn-md ui-btn-no-caps', { active }]\">\n\t\t\t{{this.title}}\n\t\t</button>\n\t`\n};\n","import { Planner } from 'calendar.planner';\nimport { Events } from 'crm.activity.settings-popup';\nimport { DatetimeConverter } from 'crm.timeline.tools';\nimport { ajax as Ajax } from 'main.core';\nimport { DateTimeFormat, Timezone } from 'main.date';\n\nimport 'ui.design-tokens';\nimport './calendar.css';\n\nimport { RecallButton } from './recall-button';\n\nconst Recall = {\n\ttoday: {\n\t\tid: 'today',\n\t\tdays: 0,\n\t},\n\ttomorrow: {\n\t\tid: 'tomorrow',\n\t\tdays: 1,\n\t},\n\tafter2days: {\n\t\tid: 'after2days',\n\t\tdays: 2,\n\t},\n\tafter3days: {\n\t\tid: 'after3days',\n\t\tdays: 3,\n\t},\n}\n\nconst DurationPeriods = {\n\tminute: {\n\t\tid: 'minute',\n\t\tseconds: 60,\n\t},\n\thour: {\n\t\tid: 'hour',\n\t\tseconds: 60 * 60,\n\t},\n\tday: {\n\t\tid: 'day',\n\t\tseconds: 60 * 60 * 24,\n\t},\n}\n\nexport const Calendar = {\n\tcomponents: {\n\t\tRecallButton,\n\t},\n\tprops: {\n\t\tparams: {\n\t\t\ttype: Object,\n\t\t\tdefault: {},\n\t\t},\n\t},\n\tdata(): Object\n\t{\n\t\tconst timestamp = this.params.from || Timezone.UserTime.getTimestamp();\n\t\tconst from = Math.round(timestamp / 60) * 60; // round timestamp to minutes\n\n\t\tlet duration = 1;\n\t\tlet durationPeriodId = DurationPeriods.hour.id;\n\t\tif (this.params.duration)\n\t\t{\n\t\t\tdurationPeriodId = this.getPeriodIdBySeconds(this.params.duration);\n\t\t\tduration = this.params.duration / DurationPeriods[durationPeriodId].seconds;\n\t\t}\n\n\t\tconst to = from + duration * DurationPeriods[durationPeriodId].seconds;\n\n\t\treturn {\n\t\t\tid: this.getId(),\n\n\t\t\tfrom,\n\t\t\tto,\n\n\t\t\tduration,\n\t\t\tdurationPeriodId,\n\n\t\t\ttimeFromClockInstance: null,\n\t\t\ttimeToClockInstance: null,\n\t\t\tplannerInstance: null,\n\t\t};\n\t},\n\tcomputed: {\n\t\tDurationPeriods: () => DurationPeriods,\n\t\tRecall: () => Recall,\n\t\tfromDateFormatted: {\n\t\t\tget(): string\n\t\t\t{\n\t\t\t\treturn DateTimeFormat.format(DateTimeFormat.getFormat('SHORT_DATE_FORMAT'), this.from);\n\t\t\t},\n\t\t\tset(value: string)\n\t\t\t{\n\t\t\t\tconst date = DateTimeFormat.parse(value);\n\t\t\t\tconst currentDate = this.createDateInstance(this.from);\n\n\t\t\t\tdate.setHours(currentDate.getHours(), currentDate.getMinutes(), 0, 0);\n\n\t\t\t\tthis.from = date.getTime() / 1000;\n\t\t\t\tthis.to = this.from + this.duration;\n\t\t\t}\n\t\t},\n\t\tfromTimeFormatted: {\n\t\t\tget(): string\n\t\t\t{\n\t\t\t\treturn this.getFormattedTime('from');\n\t\t\t},\n\t\t\tset(newTime: string)\n\t\t\t{\n\t\t\t\tconst date = this.getDateInstanceWithTime(this.from, newTime);\n\n\t\t\t\tthis.from = date.getTime() / 1000;\n\t\t\t\tthis.timeFromClockInstance.closeWnd();\n\t\t\t}\n\t\t},\n\t\ttoDateFormatted: {\n\t\t\tget(): string\n\t\t\t{\n\t\t\t\tconst toTime = this.from + this.duration * DurationPeriods[this.durationPeriodId].seconds;\n\t\t\t\treturn DateTimeFormat.format(DateTimeFormat.getFormat('SHORT_DATE_FORMAT'), toTime);\n\t\t\t},\n\t\t\tset(value: string)\n\t\t\t{\n\t\t\t\tconst date = DateTimeFormat.parse(value);\n\t\t\t\tconst toTime = this.from + this.duration * DurationPeriods[this.durationPeriodId].seconds;\n\t\t\t\tconst currentDate = new Date(Timezone.BrowserTime.toUser(toTime) * 1000);\n\n\t\t\t\tdate.setHours(currentDate.getHours(), currentDate.getMinutes(), 0, 0);\n\t\t\t\tthis.calcDuration(date);\n\t\t\t}\n\t\t},\n\t\ttoTimeFormatted: {\n\t\t\tget(): string\n\t\t\t{\n\t\t\t\tconst toTime = this.from + this.duration * DurationPeriods[this.durationPeriodId].seconds;\n\t\t\t\treturn DateTimeFormat.format(DateTimeFormat.getFormat('SHORT_TIME_FORMAT'), toTime);\n\t\t\t},\n\t\t\tset(newTime: string)\n\t\t\t{\n\t\t\t\tconst date = this.getDateInstanceWithTime(this.to, newTime);\n\n\t\t\t\tthis.calcDuration(date);\n\t\t\t\tthis.timeToClockInstance.closeWnd();\n\t\t\t}\n\t\t},\n\t\tactiveRecallId(): ?string\n\t\t{\n\t\t\tconst isDatesAreEqual = (date1: Date, date2: Date): Boolean => date1.getTime() === date2.getTime();\n\t\t\tconst fromDate = this.createDateInstance(this.from, true);\n\n\t\t\tconst date = this.createDateInstance(null, true);\n\n\t\t\tif (isDatesAreEqual(fromDate, date))\n\t\t\t{\n\t\t\t\treturn Recall.today.id;\n\t\t\t}\n\n\t\t\tconst addDay = (date: Date) => date.setDate(date.getDate() + 1);\n\n\t\t\taddDay(date);\n\t\t\tif (isDatesAreEqual(fromDate, date))\n\t\t\t{\n\t\t\t\treturn Recall.tomorrow.id;\n\t\t\t}\n\n\t\t\taddDay(date);\n\t\t\tif (isDatesAreEqual(fromDate, date))\n\t\t\t{\n\t\t\t\treturn Recall.after2days.id;\n\t\t\t}\n\n\t\t\taddDay(date);\n\t\t\tif (isDatesAreEqual(fromDate, date))\n\t\t\t{\n\t\t\t\treturn Recall.after3days.id;\n\t\t\t}\n\n\t\t\treturn null;\n\t\t},\n\t},\n\tmounted(): void\n\t{\n\t\tthis.plannerInstance = new Planner({\n\t\t\twrap: this.$refs.plannerContainer,\n\t\t\tcompactMode: true,\n\t\t\tminWidth: 770,\n\t\t\tminHeight: 104,\n\t\t\theight: 104,\n\t\t\twidth: 770,\n\t\t\t//dayOfWeekMonthFormat: this.dayOfWeekMonthFormat\n\t\t});\n\n\t\tthis.plannerInstance.subscribe('onDateChange', this.handlePlannerSelectorChanges.bind(this));\n\t\tthis.plannerInstance.show();\n\n\t\tthis.getAccessibilityForUsers();\n\n\t\tthis.onDataUpdate();\n\t},\n\tunmounted(): void\n\t{\n\t\tthis.emitSettingsChange(false);\n\t},\n\twatch: {\n\t\tduration()\n\t\t{\n\t\t\tthis.onDataUpdate();\n\t\t},\n\t\tdurationPeriodId()\n\t\t{\n\t\t\tthis.onDataUpdate();\n\t\t},\n\t\tfrom()\n\t\t{\n\t\t\tthis.onDataUpdate();\n\t\t},\n\t\tto()\n\t\t{\n\t\t\tthis.onDataUpdate();\n\t\t},\n\t},\n\tmethods: {\n\t\tgetId()\n\t\t{\n\t\t\treturn 'calendar';\n\t\t},\n\t\tgetDateInstanceWithTime(timestamp: Number, time: String): Date\n\t\t{\n\t\t\tconst timeArr = time.split(':');\n\t\t\tconst date = new Date(Timezone.BrowserTime.toUser(timestamp) * 1000);\n\n\t\t\tlet hours = Number(timeArr[0]);\n\t\t\tlet minutes = timeArr[1];\n\t\t\tconst isAmPm = (minutes.includes('am') || minutes.includes('pm'));\n\t\t\tif (isAmPm)\n\t\t\t{\n\t\t\t\tif (minutes.includes('pm') && hours !== 12)\n\t\t\t\t{\n\t\t\t\t\thours += 12;\n\t\t\t\t}\n\n\t\t\t\tminutes = parseInt(minutes, 10);\n\t\t\t}\n\n\t\t\tdate.setHours(hours, minutes, 0, 0);\n\n\t\t\treturn date;\n\t\t},\n\t\tcalcDuration(date: Date): void\n\t\t{\n\t\t\tconst durationSeconds = date.getTime() / 1000 - this.from;\n\t\t\tif (durationSeconds % DurationPeriods[this.durationPeriodId].seconds === 0)\n\t\t\t{\n\t\t\t\tthis.duration = durationSeconds/DurationPeriods[this.durationPeriodId].seconds;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.duration = durationSeconds/DurationPeriods.minute.seconds;\n\t\t\t\tthis.durationPeriodId = DurationPeriods.minute.id;\n\t\t\t}\n\t\t},\n\t\tgetPeriodIdBySeconds(value: Number): string\n\t\t{\n\t\t\tif (value % DurationPeriods.day.seconds === 0)\n\t\t\t{\n\t\t\t\treturn DurationPeriods.day.id;\n\t\t\t}\n\n\t\t\tif (value % DurationPeriods.hour.seconds === 0)\n\t\t\t{\n\t\t\t\treturn DurationPeriods.hour.id;\n\t\t\t}\n\n\t\t\treturn DurationPeriods.minute.id;\n\t\t},\n\t\thandlePlannerSelectorChanges({ data: { dateFrom, dateTo } })\n\t\t{\n\t\t\tthis.from = dateFrom.getTime() / 1000;\n\t\t\tthis.calcDuration(dateTo);\n\t\t},\n\t\tonDataUpdate()\n\t\t{\n\t\t\tthis.updatePlanner();\n\t\t\tthis.emitSettingsChange();\n\t\t},\n\t\tupdatePlanner()\n\t\t{\n\t\t\tconst dateFrom = this.createDateInstance(this.from);\n\t\t\tconst durationSeconds = this.getDurationSeconds();\n\t\t\tconst dateTo = this.createDateInstance(this.from + durationSeconds);\n\n\t\t\tthis.plannerInstance.updateSelector(dateFrom, dateTo);\n\t\t},\n\t\temitSettingsChange(active: boolean = true): void\n\t\t{\n\t\t\tconst data = this.exportParams(active);\n\t\t\tif (\n\t\t\t\t(active && this.validateParams(data))\n\t\t\t\t|| !active\n\t\t\t)\n\t\t\t{\n\t\t\t\tthis.$Bitrix.eventEmitter.emit(Events.EVENT_SETTINGS_CHANGE, data);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.$Bitrix.eventEmitter.emit(Events.EVENT_SETTINGS_VALIDATION, { isValid: false });\n\t\t\t}\n\t\t},\n\t\tgetDurationSeconds(): number\n\t\t{\n\t\t\treturn this.duration * DurationPeriods[this.durationPeriodId].seconds;\n\t\t},\n\t\tgetFormattedDate(id: string): string\n\t\t{\n\t\t\treturn this.getFormattedValue(id, DateTimeFormat.getFormat('SHORT_DATE_FORMAT'));\n\t\t},\n\t\tgetFormattedTime(id: string): string\n\t\t{\n\t\t\treturn this.getFormattedValue(id, DateTimeFormat.getFormat('SHORT_TIME_FORMAT'));\n\t\t},\n\t\tgetFormattedValue(id: string, format: string): string\n\t\t{\n\t\t\tconst timestamp = (id === 'from' ? this.from : this.to);\n\t\t\treturn DateTimeFormat.format(format, timestamp);\n\t\t},\n\t\tgetSecondsFromStartOfDay(timestamp: Number): Number\n\t\t{\n\t\t\tconst startOfDay = this.createDateInstance(timestamp, true);\n\t\t\treturn timestamp - startOfDay.getTime() / 1000;\n\t\t},\n\t\tgetDurationPeriodTitle(periodId: string): string\n\t\t{\n\t\t\tconst code = `CRM_SETTINGS_POPUP_CALENDAR_DURATION_${periodId.toUpperCase()}S`;\n\t\t\treturn this.$Bitrix.Loc.getMessage(code);\n\t\t},\n\t\tonDateFromClick()\n\t\t{\n\t\t\tBX.calendar(\n\t\t\t\t{\n\t\t\t\t\tnode: this.$refs.dateFrom,\n\t\t\t\t\tfield: this.$refs.dateFrom,\n\t\t\t\t\tbTime: false,\n\t\t\t\t}\n\t\t\t);\n\t\t},\n\t\tonDateFromChange(event)\n\t\t{\n\t\t\tthis.fromDateFormatted = event.target.value;\n\t\t},\n\t\tonDateToChange(event)\n\t\t{\n\t\t\tthis.toDateFormatted = event.target.value;\n\t\t},\n\t\tonDateToClick()\n\t\t{\n\t\t\tBX.calendar(\n\t\t\t\t{\n\t\t\t\t\tnode: this.$refs.dateTo,\n\t\t\t\t\tfield: this.$refs.dateTo,\n\t\t\t\t\tbTime: false,\n\t\t\t\t}\n\t\t\t);\n\t\t},\n\t\tonTimeFromClick()\n\t\t{\n\t\t\tthis.showClockSelector(\n\t\t\t\t'timeFromClockInstance',\n\t\t\t\tthis.from,\n\t\t\t\tthis.$refs.timeFrom,\n\t\t\t\t'fromTimeFormatted'\n\t\t\t);\n\t\t},\n\t\tonTimeToClick()\n\t\t{\n\t\t\tthis.showClockSelector(\n\t\t\t\t'timeToClockInstance',\n\t\t\t\tthis.to,\n\t\t\t\tthis.$refs.timeTo,\n\t\t\t\t'toTimeFormatted'\n\t\t\t);\n\t\t},\n\t\tshowClockSelector(instanceName: String, startTimestamp: Number, node: HTMLElement, propertyName: String): void\n\t\t{\n\t\t\tif (!this[instanceName])\n\t\t\t{\n\t\t\t\tthis[instanceName] = new BX.CClockSelector({\n\t\t\t\t\tstart_time: this.getSecondsFromStartOfDay(startTimestamp),\n\t\t\t\t\tnode,\n\t\t\t\t\tcallback: (time) => {\n\t\t\t\t\t\tthis[propertyName] = time;\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis[instanceName].Show();\n\t\t},\n\t\tonDurationKeyUp()\n\t\t{\n\t\t\tthis.duration = this.duration.replace(/\\D/g,'');\n\t\t},\n\t\tonRecallClick(id)\n\t\t{\n\t\t\tconst fromDate = this.createDateInstance(this.from);\n\t\t\tconst todayDate = this.createDateInstance(null, true);\n\t\t\ttodayDate.setHours(fromDate.getHours(), fromDate.getMinutes());\n\n\t\t\tthis.from = todayDate.setDate(todayDate.getDate() + Recall[id].days) / 1000;\n\n\t\t\tconst duration = this.duration * DurationPeriods[this.durationPeriodId].seconds;\n\t\t\tthis.to = this.from + duration;\n\t\t},\n\t\tcreateDateInstance(timestamp: number | null = null, startOfDay: boolean = false): Date\n\t\t{\n\t\t\tif (!timestamp)\n\t\t\t{\n\t\t\t\ttimestamp = Date.now() / 1000;\n\t\t\t}\n\n\t\t\tconst date = new Date(timestamp * 1000);\n\t\t\tif (startOfDay)\n\t\t\t{\n\t\t\t\tdate.setHours(0, 0, 0, 0);\n\t\t\t}\n\n\t\t\treturn date;\n\t\t},\n\t\tisActiveRecall(name: string): boolean\n\t\t{\n\t\t\treturn (name === this.activeRecallId);\n\t\t},\n\t\texportParams(active: boolean = true): Object\n\t\t{\n\t\t\tconst from = this.from;\n\t\t\tconst duration = this.duration * DurationPeriods[this.durationPeriodId].seconds;\n\t\t\tconst to = this.from + duration;\n\n\t\t\treturn {\n\t\t\t\tid: this.id,\n\t\t\t\tfrom,\n\t\t\t\tduration,\n\t\t\t\tto,\n\t\t\t\tactive,\n\t\t\t\tfromText: DateTimeFormat.format(DatetimeConverter.getSiteDateTimeFormat(), from),\n\t\t\t\ttoText: DateTimeFormat.format(DatetimeConverter.getSiteDateTimeFormat(), to),\n\t\t\t}\n\t\t},\n\t\tvalidateParams(data: Object): boolean\n\t\t{\n\t\t\tif (data.duration < 0)\n\t\t\t{\n\t\t\t\tthis.$refs.durationRegion.classList.add('ui-ctl-danger');\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tthis.$refs.durationRegion.classList.remove('ui-ctl-danger');\n\t\t\treturn true;\n\t\t},\n\t\tgetAccessibilityForUsers(): Array\n\t\t{\n\t\t\tconst offset = 12 * 24 * 3600; //12 days\n\t\t\tAjax.runAction('crm.activity.settings.calendar.getAccessibilityForUsers', {\n\t\t\t\tdata: {\n\t\t\t\t\tfrom: this.from - offset,\n\t\t\t\t\tto: this.from + offset,\n\t\t\t\t\t// @todo add currentEventId\n\t\t\t\t\t//currentEventId:\n\t\t\t\t}\n\t\t\t}).then(({ data }) => this.plannerInstance.update(data.entries, data.accessibility));\n\t\t},\n\t\tupdateSettings(data: Object | null): void\n\t\t{\n\t\t\tif (!data || !data.deadline)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.from = data.deadline.getTime() / 1000;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"ui-form\">\n\t\t\t<div class=\"ui-form-row-inline\">\n\t\t\t\t<div class=\"ui-form-row\">\n\t\t\t\t\t<div class=\"ui-form-label\">\n                \t\t<div class=\"ui-ctl-label-text\">\n\t\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('CRM_SETTINGS_POPUP_CALENDAR_FROM_DATETIME') }}\n\t\t\t\t\t\t</div>\n            \t\t</div>\n            \t\t<div class=\"ui-form-content\">\n\t\t\t\t\t\t<div class=\"ui-ctl ui-ctl-after-icon ui-ctl-date\">\n\t\t\t\t\t\t\t<div class=\"ui-ctl-after ui-ctl-icon-calendar\"></div>\n\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\tref=\"dateFrom\"\n\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\tclass=\"ui-ctl-element\"\n\t\t\t\t\t\t\t\t@click=\"onDateFromClick\"\n\t\t\t\t\t\t\t\t@change=\"onDateFromChange\"\n\t\t\t\t\t\t\t\treadonly\n\t\t\t\t\t\t\t\tv-model=\"fromDateFormatted\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"ui-ctl ui-ctl-after-icon ui-ctl-time\">\n    \t\t\t\t\t\t<div class=\"ui-ctl-after ui-ctl-icon-clock\"></div>\n\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\tref=\"timeFrom\"\n\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\tclass=\"ui-ctl-element\"\n\t\t\t\t\t\t\t\t@click=\"onTimeFromClick\"\n\t\t\t\t\t\t\t\treadonly\n\t\t\t\t\t\t\t\tv-model=\"fromTimeFormatted\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"ui-form-row\">\n\t\t\t\t\t<div class=\"ui-form-label\">\n                \t\t<div class=\"ui-ctl-label-text\">\n\t\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('CRM_SETTINGS_POPUP_CALENDAR_DURATION') }}\n\t\t\t\t\t\t</div>\n            \t\t</div>\n            \t\t<div class=\"ui-form-content\">\n\t\t\t\t\t\t<div class=\"ui-ctl ui-ctl-after-icon ui-ctl-date\" ref=\"durationRegion\">\n\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\tref=\"durationValue\"\n\t\t\t\t\t\t\t\ttype=\"text\" \n\t\t\t\t\t\t\t\tv-model=\"duration\"\n\t\t\t\t\t\t\t\tclass=\"ui-ctl-element\"\n\t\t\t\t\t\t\t\t@keyup=\"onDurationKeyUp\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"ui-ctl ui-ctl-after-icon ui-ctl-dropdown\">\n    \t\t\t\t\t\t<div class=\"ui-ctl-after ui-ctl-icon-angle\"></div>\n\t\t\t\t\t\t\t<select\n\t\t\t\t\t\t\t\tref=\"durationPeriod\"\n\t\t\t\t\t\t\t\tclass=\"ui-ctl-element\"\n\t\t\t\t\t\t\t\tv-model=\"durationPeriodId\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<option\n\t\t\t\t\t\t\t\t\tv-for=\"duration in DurationPeriods\"\n\t\t\t\t\t\t\t\t\tkey=\"id\"\n\t\t\t\t\t\t\t\t\t:selected=\"duration.id === durationPeriodId\"\n\t\t\t\t\t\t\t\t\t:value=\"duration.id\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{{ getDurationPeriodTitle(duration.id) }}\n\t\t\t\t\t\t\t\t</option>\n\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"ui-form-row\">\n\t\t\t\t\t<div class=\"ui-form-label\">\n                \t\t<div class=\"ui-ctl-label-text\">\n\t\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('CRM_SETTINGS_POPUP_CALENDAR_TO_DATETIME') }}\n\t\t\t\t\t\t</div>\n            \t\t</div>\n            \t\t<div class=\"ui-form-content\">\n\t\t\t\t\t\t<div class=\"ui-ctl ui-ctl-after-icon ui-ctl-date\">\n\t\t\t\t\t\t\t<div class=\"ui-ctl-after ui-ctl-icon-calendar\"></div>\n\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\tref=\"dateTo\"\n\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\tclass=\"ui-ctl-element\"\n\t\t\t\t\t\t\t\t@click=\"onDateToClick\"\n\t\t\t\t\t\t\t\t@change=\"onDateToChange\"\n\t\t\t\t\t\t\t\treadonly\n\t\t\t\t\t\t\t\tv-model=\"toDateFormatted\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"ui-ctl ui-ctl-after-icon ui-ctl-time\">\n    \t\t\t\t\t\t<div class=\"ui-ctl-after ui-ctl-icon-clock\"></div>\n\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\tref=\"timeTo\"\n\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\tclass=\"ui-ctl-element\"\n\t\t\t\t\t\t\t\t@click=\"onTimeToClick\"\n\t\t\t\t\t\t\t\treadonly\n\t\t\t\t\t\t\t\tv-model=\"toTimeFormatted\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"ui-form-row-inline crm-activity__settings_popup__calendar__recall-container\">\n\t\t\t\t<RecallButton\n\t\t\t\t\t:id=Recall.today.id\n\t\t\t\t\t:active=isActiveRecall(Recall.today.id)\n\t\t\t\t\t@onClick=\"this.onRecallClick\"\n\t\t\t\t\t:title=\"$Bitrix.Loc.getMessage('CRM_SETTINGS_POPUP_CALENDAR_RECALL_TODAY')\"\n\t\t\t\t/>\n\t\t\t\t<RecallButton\n\t\t\t\t\t:id=Recall.tomorrow.id\n\t\t\t\t\t:active=isActiveRecall(Recall.tomorrow.id)\n\t\t\t\t\t@onClick=\"this.onRecallClick\"\n\t\t\t\t\t:title=\"$Bitrix.Loc.getMessage('CRM_SETTINGS_POPUP_CALENDAR_RECALL_TOMORROW')\"\n\t\t\t\t/>\n\t\t\t\t<RecallButton\n\t\t\t\t\t:id=Recall.after2days.id\n\t\t\t\t\t:active=isActiveRecall(Recall.after2days.id)\n\t\t\t\t\t@onClick=\"this.onRecallClick\"\n\t\t\t\t\t:title=\"$Bitrix.Loc.getMessage('CRM_SETTINGS_POPUP_CALENDAR_RECALL_AFTER_2_DAYS')\"\n\t\t\t\t/>\n\t\t\t\t<RecallButton\n\t\t\t\t\t:id=Recall.after3days.id\n\t\t\t\t\t:active=isActiveRecall(Recall.after3days.id)\n\t\t\t\t\t@onClick=\"this.onRecallClick\"\n\t\t\t\t\t:title=\"$Bitrix.Loc.getMessage('CRM_SETTINGS_POPUP_CALENDAR_RECALL_AFTER_3_DAYS')\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div ref=\"plannerContainer\" class=\"crm-activity__settings_popup__calendar__planner-container\"></div>\n\t\t</div>\n\t`\n};\n","import { Type } from 'main.core';\nimport { Events } from 'crm.activity.settings-popup';\n\nimport { Section as WrapperSection } from '../section/section';\nimport { Calendar as SettingsPopupCalendar } from '../calendar/calendar';\n\nexport const Wrapper = {\n\tcomponents: {\n\t\tWrapperSection,\n\t\tSettingsPopupCalendar\n\t},\n\tprops: {\n\t\tonSettingsChangeCallback: {\n\t\t\ttype: Function,\n\t\t\trequired: true,\n\t\t},\n\t\tonSettingsValidationCallback: {\n\t\t\ttype: Function,\n\t\t},\n\t\tsections: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t},\n\n\tdata() {\n\t\treturn {\n\t\t\tsettings: new Map(),\n\t\t}\n\t},\n\n\tcomputed: {\n\t\tactiveSettingsIds(): Object\n\t\t{\n\t\t\tconst result = {};\n\t\t\tthis.sections.forEach(section => {\n\t\t\t\tresult[section.id] = Boolean(section.active);\n\t\t\t})\n\n\t\t\treturn result;\n\t\t}\n\t},\n\n\tmethods: {\n\t\tgetSectionTitle(id: string): string\n\t\t{\n\t\t\tid = id.toUpperCase();\n\n\t\t\tconst defaultCode = 'CRM_SETTINGS_POPUP_SECTION_SWITCH';\n\t\t\tconst code = `${defaultCode}_${id}`;\n\n\t\t\treturn this.$Bitrix.Loc.getMessage(code) || this.$Bitrix.Loc.getMessage(defaultCode);\n\t\t},\n\n\t\tgetSectionToggle(showToggleSelector: boolean): boolean\n\t\t{\n\t\t\tif (Type.isBoolean(showToggleSelector))\n\t\t\t{\n\t\t\t\treturn showToggleSelector\n\t\t\t}\n\n\t\t\treturn true;\n\t\t},\n\n\t\tprepareSettings(): void\n\t\t{\n\t\t\tfor (const sectionName in this.activeSettingsIds)\n\t\t\t{\n\t\t\t\tif (!this.activeSettingsIds[sectionName])\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tconst section = this.sections.find(section => section.id === sectionName);\n\t\t\t\tif (!section)\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tconst data = {\n\t\t\t\t\tid: section.id,\n\t\t\t\t\t...section.params,\n\t\t\t\t}\n\n\t\t\t\tthis.settings.set(sectionName, data);\n\t\t\t}\n\t\t},\n\n\t\tonSettingsChange({ data }): void\n\t\t{\n\t\t\tif (data.id)\n\t\t\t{\n\t\t\t\tif (data.active)\n\t\t\t\t{\n\t\t\t\t\tthis.settings.set(data.id, data);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.settings.delete(data.id);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (this.onSettingsChangeCallback)\n\t\t\t{\n\t\t\t\tthis.onSettingsChangeCallback(this.exportParams());\n\t\t\t}\n\t\t},\n\n\t\tonSettingsValidation({ data }): void\n\t\t{\n\t\t\tif (this.onSettingsChangeCallback)\n\t\t\t{\n\t\t\t\tthis.onSettingsValidationCallback(data);\n\t\t\t}\n\t\t},\n\n\t\texportParams(): Object\n\t\t{\n\t\t\tconst settings = Object.fromEntries(this.settings);\n\n\t\t\tlet result = {};\n\n\t\t\tfor (const id in this.activeSettingsIds)\n\t\t\t{\n\t\t\t\tif (this.activeSettingsIds[id] && settings[id])\n\t\t\t\t{\n\t\t\t\t\tresult[id] = settings[id];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn result;\n\t\t},\n\n\t\tonToggleSettingsSection({ id, isActive }): void\n\t\t{\n\t\t\tif (this.activeSettingsIds.hasOwnProperty(id))\n\t\t\t{\n\t\t\t\tthis.activeSettingsIds[id] = isActive;\n\t\t\t}\n\t\t},\n\n\t\tupdateSettings(data: Object): void\n\t\t{\n\t\t\tthis.sections.forEach(section => {\n\t\t\t\tif (this.$refs['section-' + section.id] && this.$refs['section-' + section.id][0])\n\t\t\t\t{\n\t\t\t\t\tthis.$refs['section-' + section.id][0].updateSettings(data);\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t},\n\n\tmounted()\n\t{\n\t\tthis.prepareSettings();\n\t\tthis.$Bitrix.eventEmitter.subscribe(Events.EVENT_SETTINGS_CHANGE, this.onSettingsChange);\n\t\tthis.$Bitrix.eventEmitter.subscribe(Events.EVENT_SETTINGS_VALIDATION, this.onSettingsValidation);\n\t},\n\n\tbeforeUnmount()\n\t{\n\t\tthis.$Bitrix.eventEmitter.unsubscribe(Events.EVENT_SETTINGS_CHANGE, this.onSettingsChange);\n\t\tthis.$Bitrix.eventEmitter.unsubscribe(Events.EVENT_SETTINGS_VALIDATION, this.onSettingsValidation);\n\t},\n\n\ttemplate: `\n\t\t<div class=\"crm-activity__settings-popup_body\">\n\t\t\t<WrapperSection\n\t\t\t\tv-for=\"section in sections\"\n\t\t\t\t:id=\"section.id\"\n\t\t\t\t:toggle-title=\"getSectionTitle(section.id)\"\n\t\t\t\t:toggle-enabled=\"activeSettingsIds[section.id]\"\n\t\t\t\t:toggle-visible=\"getSectionToggle(section.showToggleSelector)\"\n\t\t\t\t@onToggle=\"onToggleSettingsSection\"\n\t\t\t>\n\t\t\t\t<component \n\t\t\t\t\tv-bind:is=\"section.component\"\n\t\t\t\t\t:params=\"section.params || {}\"\n\t\t\t\t\t:ref=\"'section-' + section.id\"\n\t\t\t\t></component>\n\t\t\t</WrapperSection>\n\t\t</div>\n\t`\n};\n","import { ajax as Ajax, Loc, Tag } from 'main.core';\nimport { Popup } from 'main.popup';\nimport { Button, ButtonColor, ButtonState, CancelButton, SaveButton } from 'ui.buttons';\nimport { UI } from 'ui.notification';\nimport { Wrapper as SettingsPopupWrapper } from './components/wrapper/wrapper';\nimport { BitrixVue } from 'ui.vue3';\nimport { Calendar } from './components/calendar/calendar';\n\nimport type { SettingsPopupOptions } from './settings-popup-options';\n\nimport 'ui.design-tokens';\nimport './settings-popup.css';\n\nconst SAVE_BUTTON_ID = 'save';\nconst CANCEL_BUTTON_ID = 'cancel';\n\nconst Events = {\n\tEVENT_SETTINGS_CHANGE: 'crm:settings-popup:settings-change',\n\tEVENT_SETTINGS_VALIDATION: 'crm:settings-popup:settings-validation',\n};\n\nclass SettingsPopup\n{\n\tcontainer: HTMLElement = null;\n\tlayoutApp = null;\n\tlayoutComponent = null;\n\tpopup: ?Popup = null;\n\t#onSettingsChange: ?Function = null;\n\t#onSave: ?Function = null;\n\t#settingsSections: Object[] = [];\n\t#fetchSettingsPath: ?String = null;\n\t#ownerTypeId: ?Number = null;\n\t#ownerId: ?Number = null;\n\t#id: ?Number = null;\n\t#currentSettings: ?Object = null;\n\n\tconstructor(options: SettingsPopupOptions)\n\t{\n\t\tthis.#settingsSections = options.sections || [];\n\t\tthis.#fetchSettingsPath = options.fetchSettingsPath || null;\n\t\tthis.#ownerTypeId = options.ownerTypeId || null;\n\t\tthis.#ownerId = options.ownerId || null;\n\t\tthis.#id = options.id || null;\n\t\tthis.#onSettingsChange = options.onSettingsChange || null;\n\t\tthis.#currentSettings = options.settings || null;\n\n\t\tif (options.onSave)\n\t\t{\n\t\t\tthis.#onSave = options.onSave;\n\t\t}\n\t}\n\n\t#onSettingsValidation(data)\n\t{\n\t\tif (this.popup)\n\t\t{\n\t\t\tthis.popup.buttons[0].setDisabled(!data.isValid);\n\t\t}\n\t}\n\n\tshow(): void\n\t{\n\t\tif (!this.popup || this.popup.isDestroyed())\n\t\t{\n\t\t\tconst htmlStyles = getComputedStyle(document.documentElement);\n\t\t\tconst popupPadding = htmlStyles.getPropertyValue('--ui-space-inset-sm');\n\t\t\tconst popupPaddingNumberValue = parseFloat(popupPadding) || 12;\n\t\t\tconst popupOverlayColor = htmlStyles.getPropertyValue('--ui-color-base-solid') || '#000000';\n\n\t\t\tconst content = Tag.render`\n\t\t\t\t<div class=\"crm-activity__settings\">\n\t\t\t\t\t<div class=\"crm-activity__settings_title\">${this.#getPopupTitle()}</div>\n\t\t\t\t\t<div class=\"crm-activity__todo-settings_content\"></div>\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tthis.popup = new Popup({\n\t\t\t\tcloseIcon: true,\n\t\t\t\tcloseByEsc: true,\n\t\t\t\tpadding: popupPaddingNumberValue,\n\t\t\t\toverlay: {\n\t\t\t\t\topacity: 40,\n\t\t\t\t\tbackgroundColor: popupOverlayColor,\n\t\t\t\t},\n\t\t\t\tcontent,\n\t\t\t\tbuttons: this.#getPopupButtons(),\n\t\t\t\tminWidth: 850,\n\t\t\t\twidth: 850,\n\t\t\t\tclassName: 'crm-activity__settings-popup'\n\t\t\t});\n\n\t\t\tthis.popup.subscribeOnce('onFirstShow', () => {\n\t\t\t\tthis.loadSettings()\n\t\t\t\t\t.then(\n\t\t\t\t\t\t() => {\n\t\t\t\t\t\t\tthis.#getPopupContent();\n\t\t\t\t\t\t\tthis.popup.adjustPosition();\n\t\t\t\t\t\t},\n\t\t\t\t\t\t() => {\n\t\t\t\t\t\t\tUI.Notification.Center.notify({\n\t\t\t\t\t\t\t\tcontent: Loc.getMessage('CRM_SETTINGS_POPUP_ERROR'),\n\t\t\t\t\t\t\t\tautoHideDelay: 5000,\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t});\n\n\t\t\tthis.popup.subscribe('onClose', this.#initLayoutComponent.bind(this));\n\t\t}\n\n\t\tthis.popup.show();\n\t}\n\n\t#getPopupContent(): HTMLElement\n\t{\n\t\tthis.container = this.popup\n\t\t\t.getContentContainer()\n\t\t\t.getElementsByClassName('crm-activity__todo-settings_content')\n\t\t\t.item(0)\n\t\t;\n\n\t\tthis.#initLayoutComponent();\n\n\t\treturn this.layoutComponent;\n\t}\n\n\tloadSettings(): Promise\n\t{\n\t\tif (!this.#fetchSettingsPath)\n\t\t{\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\tconst data = {\n\t\t\tid: this.#id,\n\t\t\townerTypeId: this.#ownerTypeId,\n\t\t\townerId: this.#ownerId,\n\t\t}\n\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tAjax\n\t\t\t\t.runAction(this.#fetchSettingsPath, { data })\n\t\t\t\t.then(({ data }) => {\n\t\t\t\t\tdata.forEach(item => {\n\t\t\t\t\t\tconst section = this.#settingsSections.find(settingsSection => settingsSection.id === item.id);\n\t\t\t\t\t\tif (!section)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tsection.active = item.active;\n\t\t\t\t\t\tsection.params = item.settings;\n\t\t\t\t\t});\n\n\t\t\t\t\tresolve();\n\t\t\t\t})\n\t\t\t\t.catch(reject)\n\t\t\t;\n\t\t});\n\t}\n\n\t#getPopupTitle(): string\n\t{\n\t\treturn Loc.getMessage('CRM_SETTINGS_POPUP_TITLE');\n\t}\n\n\t#getPopupButtons(): ReadonlyArray<Button>\n\t{\n\t\treturn [\n\t\t\tnew SaveButton({\n\t\t\t\tid: SAVE_BUTTON_ID,\n\t\t\t\tround: true,\n\t\t\t\tstate: ButtonState.ACTIVE,\n\t\t\t\tevents: {\n\t\t\t\t\tclick: this.save.bind(this),\n\t\t\t\t},\n\t\t\t}),\n\t\t\tnew CancelButton({\n\t\t\t\tid: CANCEL_BUTTON_ID,\n\t\t\t\tround: true,\n\t\t\t\tevents: {\n\t\t\t\t\tclick: this.#cancel.bind(this),\n\t\t\t\t},\n\t\t\t\ttext: Loc.getMessage('CRM_SETTINGS_POPUP_CANCEL'),\n\t\t\t\tcolor: ButtonColor.LIGHT_BORDER,\n\t\t\t}),\n\t\t]\n\t}\n\n\tsave(): void\n\t{\n\t\tthis.#currentSettings = this.getSettings();\n\n\t\tif (this.#onSettingsChange)\n\t\t{\n\t\t\tthis.#onSettingsChange(this.getSettings());\n\t\t}\n\n\t\tthis.#closePopup();\n\n\t\tif (this.#onSave)\n\t\t{\n\t\t\tthis.#onSave(this.#ownerTypeId, this.#ownerId, this.#id, this.getSettings());\n\t\t}\n\t}\n\n\t#cancel(): void\n\t{\n\t\tthis.#closePopup();\n\t\tthis.#initLayoutComponent();\n\t}\n\n\t#initLayoutComponent(): void\n\t{\n\t\tif (this.layoutApp && this.layoutComponent)\n\t\t{\n\t\t\tthis.layoutApp.unmount(this.container);\n\t\t}\n\n\t\tif (this.#currentSettings)\n\t\t{\n\t\t\tthis.#settingsSections.forEach(section => {\n\t\t\t\tif (this.#currentSettings[section.id])\n\t\t\t\t{\n\t\t\t\t\tsection.active = true;\n\t\t\t\t\tsection.params = this.#currentSettings[section.id];\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tthis.layoutApp = BitrixVue.createApp(SettingsPopupWrapper, {\n\t\t\tonSettingsChangeCallback: this.#adjustPopup.bind(this),\n\t\t\tonSettingsValidationCallback: this.#onSettingsValidation.bind(this),\n\t\t\tsections: this.#settingsSections,\n\t\t});\n\n\t\tthis.layoutComponent = this.layoutApp.mount(this.container);\n\t}\n\n\t#adjustPopup()\n\t{\n\t\tthis.popup.adjustPosition();\n\t\tthis.popup.buttons[0].setDisabled(false);\n\t}\n\n\t#closePopup(): void\n\t{\n\t\tthis.popup?.close();\n\t}\n\n\tgetSettings(): Object\n\t{\n\t\treturn this.layoutComponent?.exportParams();\n\t}\n\n\tsyncSettings(data: Object | null = null): void\n\t{\n\t\tif (data && this.layoutComponent)\n\t\t{\n\t\t\tthis.layoutComponent.updateSettings(data);\n\t\t}\n\t}\n}\n\nexport {\n\tCalendar,\n\tSettingsPopup,\n\tEvents,\n};\n"],"names":["Section","props","id","type","String","required","toggleTitle","default","toggleEnabled","Boolean","toggleVisible","watch","enabled","$emit","isActive","data","template","RecallButton","active","title","methods","onClick","Recall","today","days","tomorrow","after2days","after3days","DurationPeriods","minute","seconds","hour","day","Calendar","components","params","Object","timestamp","from","Timezone","UserTime","getTimestamp","Math","round","duration","durationPeriodId","getPeriodIdBySeconds","to","getId","timeFromClockInstance","timeToClockInstance","plannerInstance","computed","fromDateFormatted","get","DateTimeFormat","format","getFormat","set","value","date","parse","currentDate","createDateInstance","setHours","getHours","getMinutes","getTime","fromTimeFormatted","getFormattedTime","newTime","getDateInstanceWithTime","closeWnd","toDateFormatted","toTime","Date","BrowserTime","toUser","calcDuration","toTimeFormatted","activeRecallId","isDatesAreEqual","date1","date2","fromDate","addDay","setDate","getDate","mounted","Planner","wrap","$refs","plannerContainer","compactMode","minWidth","minHeight","height","width","subscribe","handlePlannerSelectorChanges","bind","show","getAccessibilityForUsers","onDataUpdate","unmounted","emitSettingsChange","time","timeArr","split","hours","Number","minutes","isAmPm","includes","parseInt","durationSeconds","dateFrom","dateTo","updatePlanner","getDurationSeconds","updateSelector","exportParams","validateParams","$Bitrix","eventEmitter","emit","Events","EVENT_SETTINGS_CHANGE","EVENT_SETTINGS_VALIDATION","isValid","getFormattedDate","getFormattedValue","getSecondsFromStartOfDay","startOfDay","getDurationPeriodTitle","periodId","code","toUpperCase","Loc","getMessage","onDateFromClick","BX","calendar","node","field","bTime","onDateFromChange","event","target","onDateToChange","onDateToClick","onTimeFromClick","showClockSelector","timeFrom","onTimeToClick","timeTo","instanceName","startTimestamp","propertyName","CClockSelector","start_time","callback","Show","onDurationKeyUp","replace","onRecallClick","todayDate","now","isActiveRecall","name","fromText","DatetimeConverter","getSiteDateTimeFormat","toText","durationRegion","classList","add","remove","offset","Ajax","runAction","then","update","entries","accessibility","updateSettings","deadline","Wrapper","WrapperSection","SettingsPopupCalendar","onSettingsChangeCallback","Function","onSettingsValidationCallback","sections","Array","settings","Map","activeSettingsIds","result","forEach","section","getSectionTitle","defaultCode","getSectionToggle","showToggleSelector","Type","isBoolean","prepareSettings","sectionName","find","onSettingsChange","delete","onSettingsValidation","fromEntries","onToggleSettingsSection","hasOwnProperty","beforeUnmount","unsubscribe","SAVE_BUTTON_ID","CANCEL_BUTTON_ID","SettingsPopup","constructor","options","container","layoutApp","layoutComponent","popup","fetchSettingsPath","ownerTypeId","ownerId","onSave","isDestroyed","htmlStyles","getComputedStyle","document","documentElement","popupPadding","getPropertyValue","popupPaddingNumberValue","parseFloat","popupOverlayColor","content","Tag","render","Popup","closeIcon","closeByEsc","padding","overlay","opacity","backgroundColor","buttons","className","subscribeOnce","loadSettings","adjustPosition","UI","Notification","Center","notify","autoHideDelay","Promise","resolve","reject","item","settingsSection","catch","save","getSettings","syncSettings","setDisabled","getContentContainer","getElementsByClassName","SaveButton","state","ButtonState","ACTIVE","events","click","CancelButton","text","color","ButtonColor","LIGHT_BORDER","unmount","BitrixVue","createApp","SettingsPopupWrapper","mount","close"],"mappings":"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"}