{"version":3,"file":"settings-popup.bundle.js","sources":["../src/components/section/section.js","../src/components/calendar/recall-button.js","../src/components/calendar/calendar.js","../src/components/ping/ping.js","../src/components/wrapper/wrapper.js","../src/settings-popup.js"],"sourcesContent":["export const Section = {\n\tprops: {\n\t\tid: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\ttoggleTitle: {\n\t\t\ttype: String,\n\t\t\tdefault: '',\n\t\t},\n\t\ttoggleEnabled: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true,\n\t\t},\n\t\ttoggleVisible: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true,\n\t\t},\n\t},\n\n\twatch: {\n\t\tenabled() {\n\t\t\tthis.$emit('onToggle', {\n\t\t\t\tid: this.id,\n\t\t\t\tisActive: this.enabled,\n\t\t\t});\n\t\t},\n\t},\n\n\tdata() {\n\t\treturn {\n\t\t\tenabled: this.toggleEnabled,\n\t\t}\n\t},\n\n\ttemplate: `\n\t\t<section>\n\t\t\t<div class=\"ui-form-row\" v-if=\"toggleVisible\">\n\t\t\t\t<label for class=\"ui-ctl ui-ctl-checkbox\" @click=\"enabled = !enabled\">\n\t\t\t\t\t<input type=\"checkbox\" class=\"ui-ctl-element\" v-model=\"enabled\">\n\t\t\t\t\t<div class=\"ui-ctl-label-text\">{{ toggleTitle }}</div>\n\t\t\t\t</label>\n\t\t\t</div>\n\t\t\t<div class=\"ui-form-row\" v-else>\n\t\t\t\t<label>\n\t\t\t\t\t<div class=\"ui-ctl-label-text\">{{ toggleTitle }}</div>\n\t\t\t\t</label>\n\t\t\t</div>\n\t\t\t<slot v-if=\"enabled\"></slot>\n\t\t</section>\n\t`\n};\n","export const RecallButton = {\n\tprops: {\n\t\tid: String,\n\t\tactive: Boolean,\n\t\ttitle: String,\n\t},\n\tmethods: {\n\t\tonClick: function() {\n\t\t\tthis.$emit('onClick', this.id);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<button @click=\"onClick\" :class=\"['ui-btn ui-btn-secondary ui-btn-md ui-btn-no-caps', { active }]\">\n\t\t\t{{this.title}}\n\t\t</button>\n\t`\n};\n","import { Date as DateFormatter, DateTimeFormat } from 'main.date';\nimport { Planner } from 'calendar.planner';\nimport { Factory } from 'crm.datetime';\nimport { Events } from 'crm.activity.settings-popup';\nimport { ajax as Ajax} from 'main.core';\nimport { DatetimeConverter } from 'crm.timeline.tools';\n\nimport { RecallButton } from './recall-button';\n\nimport 'ui.design-tokens';\nimport './calendar.css';\n\nconst Recall = {\n\ttoday: {\n\t\tid: 'today',\n\t\tdays: 0,\n\t},\n\ttomorrow: {\n\t\tid: 'tomorrow',\n\t\tdays: 1,\n\t},\n\tafter2days: {\n\t\tid: 'after2days',\n\t\tdays: 2,\n\t},\n\tafter3days: {\n\t\tid: 'after3days',\n\t\tdays: 3,\n\t},\n}\n\nconst DurationPeriods = {\n\tminute: {\n\t\tid: 'minute',\n\t\tseconds: 60,\n\t},\n\thour: {\n\t\tid: 'hour',\n\t\tseconds: 60 * 60,\n\t},\n\tday: {\n\t\tid: 'day',\n\t\tseconds: 60 * 60 * 24,\n\t},\n}\n\nexport const Calendar = {\n\tcomponents: {\n\t\tRecallButton,\n\t},\n\tprops: {\n\t\tparams: {\n\t\t\ttype: Object,\n\t\t\tdefault: {},\n\t\t},\n\t},\n\tdata(): Object\n\t{\n\t\tconst timestamp = this.params.from || (Factory.getUserNow().getTime() / 1000);\n\t\tconst from = Math.round(timestamp / 60) * 60; // round timestamp to minutes\n\n\t\tlet duration = 1;\n\t\tlet durationPeriodId = DurationPeriods.hour.id;\n\t\tif (this.params.duration)\n\t\t{\n\t\t\tdurationPeriodId = this.getPeriodIdBySeconds(this.params.duration);\n\t\t\tduration = this.params.duration / DurationPeriods[durationPeriodId].seconds;\n\t\t}\n\n\t\tconst to = from + duration * DurationPeriods[durationPeriodId].seconds;\n\n\t\treturn {\n\t\t\tid: this.getId(),\n\n\t\t\tfrom,\n\t\t\tto,\n\n\t\t\tduration,\n\t\t\tdurationPeriodId,\n\n\t\t\ttimeFromClockInstance: null,\n\t\t\ttimeToClockInstance: null,\n\t\t\tplannerInstance: null,\n\t\t};\n\t},\n\tcomputed: {\n\t\tDurationPeriods: () => DurationPeriods,\n\t\tRecall: () => Recall,\n\t\tfromDateFormatted: {\n\t\t\tget(): string\n\t\t\t{\n\t\t\t\treturn DateFormatter.format(BX.Crm.DateTime.Dictionary.Format.SHORT_DATE_FORMAT, this.from);\n\t\t\t},\n\t\t\tset(value: string)\n\t\t\t{\n\t\t\t\tconst date = DateFormatter.parse(value);\n\t\t\t\tconst currentDate = this.createDateInstance(this.from);\n\n\t\t\t\tdate.setHours(currentDate.getHours(), currentDate.getMinutes(), 0, 0);\n\n\t\t\t\tthis.from = date.getTime() / 1000;\n\t\t\t\tthis.to = this.from + this.duration;\n\t\t\t}\n\t\t},\n\t\tfromTimeFormatted: {\n\t\t\tget(): string\n\t\t\t{\n\t\t\t\treturn this.getFormattedTime('from');\n\t\t\t},\n\t\t\tset(newTime: string)\n\t\t\t{\n\t\t\t\tconst date = this.getDateInstanceWithTime(this.from, newTime);\n\n\t\t\t\tthis.from = date.getTime() / 1000;\n\t\t\t\tthis.timeFromClockInstance.closeWnd();\n\t\t\t}\n\t\t},\n\t\ttoDateFormatted: {\n\t\t\tget(): string\n\t\t\t{\n\t\t\t\tconst toTime = this.from + this.duration * DurationPeriods[this.durationPeriodId].seconds;\n\t\t\t\treturn DateFormatter.format(BX.Crm.DateTime.Dictionary.Format.SHORT_DATE_FORMAT, toTime);\n\t\t\t},\n\t\t\tset(value: string)\n\t\t\t{\n\t\t\t\tconst date = DateFormatter.parse(value);\n\t\t\t\tconst toTime = this.from + this.duration * DurationPeriods[this.durationPeriodId].seconds;\n\t\t\t\tconst currentDate = Factory.createFromTimestampInUserTimezone(toTime);\n\n\t\t\t\tdate.setHours(currentDate.getHours(), currentDate.getMinutes(), 0, 0);\n\t\t\t\tthis.calcDuration(date);\n\t\t\t}\n\t\t},\n\t\ttoTimeFormatted: {\n\t\t\tget(): string\n\t\t\t{\n\t\t\t\tconst toTime = this.from + this.duration * DurationPeriods[this.durationPeriodId].seconds;\n\t\t\t\treturn DateFormatter.format(BX.Crm.DateTime.Dictionary.Format.SHORT_TIME_FORMAT, toTime);\n\t\t\t},\n\t\t\tset(newTime: string)\n\t\t\t{\n\t\t\t\tconst date = this.getDateInstanceWithTime(this.to, newTime);\n\n\t\t\t\tthis.calcDuration(date);\n\t\t\t\tthis.timeToClockInstance.closeWnd();\n\t\t\t}\n\t\t},\n\t\tactiveRecallId(): ?string\n\t\t{\n\t\t\tconst isDatesAreEqual = (date1: Date, date2: Date): Boolean => date1.getTime() === date2.getTime();\n\t\t\tconst fromDate = this.createDateInstance(this.from, true);\n\n\t\t\tconst date = this.createDateInstance(null, true);\n\n\t\t\tif (isDatesAreEqual(fromDate, date))\n\t\t\t{\n\t\t\t\treturn Recall.today.id;\n\t\t\t}\n\n\t\t\tconst addDay = (date: Date) => date.setDate(date.getDate() + 1);\n\n\t\t\taddDay(date);\n\t\t\tif (isDatesAreEqual(fromDate, date))\n\t\t\t{\n\t\t\t\treturn Recall.tomorrow.id;\n\t\t\t}\n\n\t\t\taddDay(date);\n\t\t\tif (isDatesAreEqual(fromDate, date))\n\t\t\t{\n\t\t\t\treturn Recall.after2days.id;\n\t\t\t}\n\n\t\t\taddDay(date);\n\t\t\tif (isDatesAreEqual(fromDate, date))\n\t\t\t{\n\t\t\t\treturn Recall.after3days.id;\n\t\t\t}\n\n\t\t\treturn null;\n\t\t},\n\t},\n\tmounted(): void\n\t{\n\t\tthis.plannerInstance = new Planner({\n\t\t\twrap: this.$refs.plannerContainer,\n\t\t\tcompactMode: true,\n\t\t\tminWidth: 770,\n\t\t\tminHeight: 104,\n\t\t\theight: 104,\n\t\t\twidth: 770,\n\t\t\t//dayOfWeekMonthFormat: this.dayOfWeekMonthFormat\n\t\t});\n\n\t\tthis.plannerInstance.subscribe('onDateChange', this.handlePlannerSelectorChanges.bind(this));\n\t\tthis.plannerInstance.show();\n\n\t\tthis.getAccessibilityForUsers();\n\n\t\tthis.onDataUpdate();\n\t},\n\tunmounted(): void\n\t{\n\t\tthis.emitSettingsChange(false);\n\t},\n\twatch: {\n\t\tduration()\n\t\t{\n\t\t\tthis.onDataUpdate();\n\t\t},\n\t\tdurationPeriodId()\n\t\t{\n\t\t\tthis.onDataUpdate();\n\t\t},\n\t\tfrom()\n\t\t{\n\t\t\tthis.onDataUpdate();\n\t\t},\n\t\tto()\n\t\t{\n\t\t\tthis.onDataUpdate();\n\t\t},\n\t},\n\tmethods: {\n\t\tgetId()\n\t\t{\n\t\t\treturn 'calendar';\n\t\t},\n\t\tgetDateInstanceWithTime(timestamp: Number, time: String): Date\n\t\t{\n\t\t\tconst timeArr = time.split(':');\n\t\t\tconst date = Factory.createFromTimestampInUserTimezone(timestamp);\n\n\t\t\tlet hours = Number(timeArr[0]);\n\t\t\tlet minutes = timeArr[1];\n\t\t\tconst isAmPm = (minutes.includes('am') || minutes.includes('pm'));\n\t\t\tif (isAmPm)\n\t\t\t{\n\t\t\t\tif (minutes.includes('pm') && hours !== 12)\n\t\t\t\t{\n\t\t\t\t\thours += 12;\n\t\t\t\t}\n\n\t\t\t\tminutes = parseInt(minutes, 10);\n\t\t\t}\n\n\t\t\tdate.setHours(hours, minutes, 0, 0);\n\n\t\t\treturn date;\n\t\t},\n\t\tcalcDuration(date: Date): void\n\t\t{\n\t\t\tconst durationSeconds = date.getTime() / 1000 - this.from;\n\t\t\tif (durationSeconds % DurationPeriods[this.durationPeriodId].seconds === 0)\n\t\t\t{\n\t\t\t\tthis.duration = durationSeconds/DurationPeriods[this.durationPeriodId].seconds;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.duration = durationSeconds/DurationPeriods.minute.seconds;\n\t\t\t\tthis.durationPeriodId = DurationPeriods.minute.id;\n\t\t\t}\n\t\t},\n\t\tgetPeriodIdBySeconds(value: Number): string\n\t\t{\n\t\t\tif (value % DurationPeriods.day.seconds === 0)\n\t\t\t{\n\t\t\t\treturn DurationPeriods.day.id;\n\t\t\t}\n\n\t\t\tif (value % DurationPeriods.hour.seconds === 0)\n\t\t\t{\n\t\t\t\treturn DurationPeriods.hour.id;\n\t\t\t}\n\n\t\t\treturn DurationPeriods.minute.id;\n\t\t},\n\t\thandlePlannerSelectorChanges({ data: { dateFrom, dateTo } })\n\t\t{\n\t\t\tthis.from = dateFrom.getTime() / 1000;\n\t\t\tthis.calcDuration(dateTo);\n\t\t},\n\t\tonDataUpdate()\n\t\t{\n\t\t\tthis.updatePlanner();\n\t\t\tthis.emitSettingsChange();\n\t\t},\n\t\tupdatePlanner()\n\t\t{\n\t\t\tconst dateFrom = this.createDateInstance(this.from);\n\t\t\tconst durationSeconds = this.getDurationSeconds();\n\t\t\tconst dateTo = this.createDateInstance(this.from + durationSeconds);\n\n\t\t\tthis.plannerInstance.updateSelector(dateFrom, dateTo);\n\t\t},\n\t\temitSettingsChange(active: boolean = true): void\n\t\t{\n\t\t\tconst data = this.exportParams(active);\n\t\t\tif (\n\t\t\t\t(active && this.validateParams(data))\n\t\t\t\t|| !active\n\t\t\t)\n\t\t\t{\n\t\t\t\tthis.$Bitrix.eventEmitter.emit(Events.EVENT_SETTINGS_CHANGE, data);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.$Bitrix.eventEmitter.emit(Events.EVENT_SETTINGS_VALIDATION, { isValid: false });\n\t\t\t}\n\t\t},\n\t\tgetDurationSeconds(): number\n\t\t{\n\t\t\treturn this.duration * DurationPeriods[this.durationPeriodId].seconds;\n\t\t},\n\t\tgetFormattedDate(id: string): string\n\t\t{\n\t\t\treturn this.getFormattedValue(id, BX.Crm.DateTime.Dictionary.Format.SHORT_DATE_FORMAT);\n\t\t},\n\t\tgetFormattedTime(id: string): string\n\t\t{\n\t\t\treturn this.getFormattedValue(id, BX.Crm.DateTime.Dictionary.Format.SHORT_TIME_FORMAT);\n\t\t},\n\t\tgetFormattedValue(id: string, format: string): string\n\t\t{\n\t\t\tconst timestamp = (id === 'from' ? this.from : this.to);\n\t\t\treturn DateFormatter.format(format, timestamp);\n\t\t},\n\t\tgetSecondsFromStartOfDay(timestamp: Number): Number\n\t\t{\n\t\t\tconst startOfDay = this.createDateInstance(timestamp, true);\n\t\t\treturn timestamp - startOfDay.getTime() / 1000;\n\t\t},\n\t\tgetDurationPeriodTitle(periodId: string): string\n\t\t{\n\t\t\tconst code = `CRM_SETTINGS_POPUP_CALENDAR_DURATION_${periodId.toUpperCase()}S`;\n\t\t\treturn this.$Bitrix.Loc.getMessage(code);\n\t\t},\n\t\tonDateFromClick()\n\t\t{\n\t\t\tBX.calendar(\n\t\t\t\t{\n\t\t\t\t\tnode: this.$refs.dateFrom,\n\t\t\t\t\tfield: this.$refs.dateFrom,\n\t\t\t\t\tbTime: false,\n\t\t\t\t}\n\t\t\t);\n\t\t},\n\t\tonDateFromChange(event)\n\t\t{\n\t\t\tthis.fromDateFormatted = event.target.value;\n\t\t},\n\t\tonDateToChange(event)\n\t\t{\n\t\t\tthis.toDateFormatted = event.target.value;\n\t\t},\n\t\tonDateToClick()\n\t\t{\n\t\t\tBX.calendar(\n\t\t\t\t{\n\t\t\t\t\tnode: this.$refs.dateTo,\n\t\t\t\t\tfield: this.$refs.dateTo,\n\t\t\t\t\tbTime: false,\n\t\t\t\t}\n\t\t\t);\n\t\t},\n\t\tonTimeFromClick()\n\t\t{\n\t\t\tthis.showClockSelector(\n\t\t\t\t'timeFromClockInstance',\n\t\t\t\tthis.from,\n\t\t\t\tthis.$refs.timeFrom,\n\t\t\t\t'fromTimeFormatted'\n\t\t\t);\n\t\t},\n\t\tonTimeToClick()\n\t\t{\n\t\t\tthis.showClockSelector(\n\t\t\t\t'timeToClockInstance',\n\t\t\t\tthis.to,\n\t\t\t\tthis.$refs.timeTo,\n\t\t\t\t'toTimeFormatted'\n\t\t\t);\n\t\t},\n\t\tshowClockSelector(instanceName: String, startTimestamp: Number, node: HTMLElement, propertyName: String): void\n\t\t{\n\t\t\tif (!this[instanceName])\n\t\t\t{\n\t\t\t\tthis[instanceName] = new BX.CClockSelector({\n\t\t\t\t\tstart_time: this.getSecondsFromStartOfDay(startTimestamp),\n\t\t\t\t\tnode,\n\t\t\t\t\tcallback: (time) => {\n\t\t\t\t\t\tthis[propertyName] = time;\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis[instanceName].Show();\n\t\t},\n\t\tonDurationKeyUp()\n\t\t{\n\t\t\tthis.duration = this.duration.replace(/\\D/g,'');\n\t\t},\n\t\tonRecallClick(id)\n\t\t{\n\t\t\tconst fromDate = this.createDateInstance(this.from);\n\t\t\tconst todayDate = this.createDateInstance(null, true);\n\t\t\ttodayDate.setHours(fromDate.getHours(), fromDate.getMinutes());\n\n\t\t\tthis.from = todayDate.setDate(todayDate.getDate() + Recall[id].days) / 1000;\n\n\t\t\tconst duration = this.duration * DurationPeriods[this.durationPeriodId].seconds;\n\t\t\tthis.to = this.from + duration;\n\t\t},\n\t\tcreateDateInstance(timestamp: number | null = null, startOfDay: boolean = false): Date\n\t\t{\n\t\t\tif (!timestamp)\n\t\t\t{\n\t\t\t\ttimestamp = Date.now() / 1000;\n\t\t\t}\n\n\t\t\tconst date = new Date(timestamp * 1000);\n\t\t\tif (startOfDay)\n\t\t\t{\n\t\t\t\tdate.setHours(0, 0, 0, 0);\n\t\t\t}\n\n\t\t\treturn date;\n\t\t},\n\t\tisActiveRecall(name: string): boolean\n\t\t{\n\t\t\treturn (name === this.activeRecallId);\n\t\t},\n\t\texportParams(active: boolean = true): Object\n\t\t{\n\t\t\tconst from = this.from;\n\t\t\tconst duration = this.duration * DurationPeriods[this.durationPeriodId].seconds;\n\t\t\tconst to = this.from + duration;\n\n\t\t\treturn {\n\t\t\t\tid: this.id,\n\t\t\t\tfrom,\n\t\t\t\tduration,\n\t\t\t\tto,\n\t\t\t\tactive,\n\t\t\t\tfromText: DateTimeFormat.format(DatetimeConverter.getSiteDateTimeFormat(), from),\n\t\t\t\ttoText: DateTimeFormat.format(DatetimeConverter.getSiteDateTimeFormat(), to),\n\t\t\t}\n\t\t},\n\t\tvalidateParams(data: Object): boolean\n\t\t{\n\t\t\tif (data.duration < 0)\n\t\t\t{\n\t\t\t\tthis.$refs.durationRegion.classList.add('ui-ctl-danger');\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tthis.$refs.durationRegion.classList.remove('ui-ctl-danger');\n\t\t\treturn true;\n\t\t},\n\t\tgetAccessibilityForUsers(): Array\n\t\t{\n\t\t\tconst offset = 12 * 24 * 3600; //12 days\n\t\t\tAjax.runAction('crm.activity.settings.calendar.getAccessibilityForUsers', {\n\t\t\t\tdata: {\n\t\t\t\t\tfrom: this.from - offset,\n\t\t\t\t\tto: this.from + offset,\n\t\t\t\t\t// @todo add currentEventId\n\t\t\t\t\t//currentEventId:\n\t\t\t\t}\n\t\t\t}).then(({ data }) => this.plannerInstance.update(data.entries, data.accessibility));\n\t\t},\n\t\tupdateSettings(data: Object | null): void\n\t\t{\n\t\t\tif (!data || !data.deadline)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.from = data.deadline.getTime() / 1000;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"ui-form\">\n\t\t\t<div class=\"ui-form-row-inline\">\n\t\t\t\t<div class=\"ui-form-row\">\n\t\t\t\t\t<div class=\"ui-form-label\">\n                \t\t<div class=\"ui-ctl-label-text\">\n\t\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('CRM_SETTINGS_POPUP_CALENDAR_FROM_DATETIME') }}\n\t\t\t\t\t\t</div>\n            \t\t</div>\n            \t\t<div class=\"ui-form-content\">\n\t\t\t\t\t\t<div class=\"ui-ctl ui-ctl-after-icon ui-ctl-date\">\n\t\t\t\t\t\t\t<div class=\"ui-ctl-after ui-ctl-icon-calendar\"></div>\n\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\tref=\"dateFrom\"\n\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\tclass=\"ui-ctl-element\"\n\t\t\t\t\t\t\t\t@click=\"onDateFromClick\"\n\t\t\t\t\t\t\t\t@change=\"onDateFromChange\"\n\t\t\t\t\t\t\t\treadonly\n\t\t\t\t\t\t\t\tv-model=\"fromDateFormatted\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"ui-ctl ui-ctl-after-icon ui-ctl-time\">\n    \t\t\t\t\t\t<div class=\"ui-ctl-after ui-ctl-icon-clock\"></div>\n\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\tref=\"timeFrom\"\n\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\tclass=\"ui-ctl-element\"\n\t\t\t\t\t\t\t\t@click=\"onTimeFromClick\"\n\t\t\t\t\t\t\t\treadonly\n\t\t\t\t\t\t\t\tv-model=\"fromTimeFormatted\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"ui-form-row\">\n\t\t\t\t\t<div class=\"ui-form-label\">\n                \t\t<div class=\"ui-ctl-label-text\">\n\t\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('CRM_SETTINGS_POPUP_CALENDAR_DURATION') }}\n\t\t\t\t\t\t</div>\n            \t\t</div>\n            \t\t<div class=\"ui-form-content\">\n\t\t\t\t\t\t<div class=\"ui-ctl ui-ctl-after-icon ui-ctl-date\" ref=\"durationRegion\">\n\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\tref=\"durationValue\"\n\t\t\t\t\t\t\t\ttype=\"text\" \n\t\t\t\t\t\t\t\tv-model=\"duration\"\n\t\t\t\t\t\t\t\tclass=\"ui-ctl-element\"\n\t\t\t\t\t\t\t\t@keyup=\"onDurationKeyUp\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"ui-ctl ui-ctl-after-icon ui-ctl-dropdown\">\n    \t\t\t\t\t\t<div class=\"ui-ctl-after ui-ctl-icon-angle\"></div>\n\t\t\t\t\t\t\t<select\n\t\t\t\t\t\t\t\tref=\"durationPeriod\"\n\t\t\t\t\t\t\t\tclass=\"ui-ctl-element\"\n\t\t\t\t\t\t\t\tv-model=\"durationPeriodId\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<option\n\t\t\t\t\t\t\t\t\tv-for=\"duration in DurationPeriods\"\n\t\t\t\t\t\t\t\t\tkey=\"id\"\n\t\t\t\t\t\t\t\t\t:selected=\"duration.id === durationPeriodId\"\n\t\t\t\t\t\t\t\t\t:value=\"duration.id\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{{ getDurationPeriodTitle(duration.id) }}\n\t\t\t\t\t\t\t\t</option>\n\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"ui-form-row\">\n\t\t\t\t\t<div class=\"ui-form-label\">\n                \t\t<div class=\"ui-ctl-label-text\">\n\t\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('CRM_SETTINGS_POPUP_CALENDAR_TO_DATETIME') }}\n\t\t\t\t\t\t</div>\n            \t\t</div>\n            \t\t<div class=\"ui-form-content\">\n\t\t\t\t\t\t<div class=\"ui-ctl ui-ctl-after-icon ui-ctl-date\">\n\t\t\t\t\t\t\t<div class=\"ui-ctl-after ui-ctl-icon-calendar\"></div>\n\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\tref=\"dateTo\"\n\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\tclass=\"ui-ctl-element\"\n\t\t\t\t\t\t\t\t@click=\"onDateToClick\"\n\t\t\t\t\t\t\t\t@change=\"onDateToChange\"\n\t\t\t\t\t\t\t\treadonly\n\t\t\t\t\t\t\t\tv-model=\"toDateFormatted\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"ui-ctl ui-ctl-after-icon ui-ctl-time\">\n    \t\t\t\t\t\t<div class=\"ui-ctl-after ui-ctl-icon-clock\"></div>\n\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\tref=\"timeTo\"\n\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\tclass=\"ui-ctl-element\"\n\t\t\t\t\t\t\t\t@click=\"onTimeToClick\"\n\t\t\t\t\t\t\t\treadonly\n\t\t\t\t\t\t\t\tv-model=\"toTimeFormatted\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"ui-form-row-inline crm-activity__settings_popup__calendar__recall-container\">\n\t\t\t\t<RecallButton\n\t\t\t\t\t:id=Recall.today.id\n\t\t\t\t\t:active=isActiveRecall(Recall.today.id)\n\t\t\t\t\t@onClick=\"this.onRecallClick\"\n\t\t\t\t\t:title=\"$Bitrix.Loc.getMessage('CRM_SETTINGS_POPUP_CALENDAR_RECALL_TODAY')\"\n\t\t\t\t/>\n\t\t\t\t<RecallButton\n\t\t\t\t\t:id=Recall.tomorrow.id\n\t\t\t\t\t:active=isActiveRecall(Recall.tomorrow.id)\n\t\t\t\t\t@onClick=\"this.onRecallClick\"\n\t\t\t\t\t:title=\"$Bitrix.Loc.getMessage('CRM_SETTINGS_POPUP_CALENDAR_RECALL_TOMORROW')\"\n\t\t\t\t/>\n\t\t\t\t<RecallButton\n\t\t\t\t\t:id=Recall.after2days.id\n\t\t\t\t\t:active=isActiveRecall(Recall.after2days.id)\n\t\t\t\t\t@onClick=\"this.onRecallClick\"\n\t\t\t\t\t:title=\"$Bitrix.Loc.getMessage('CRM_SETTINGS_POPUP_CALENDAR_RECALL_AFTER_2_DAYS')\"\n\t\t\t\t/>\n\t\t\t\t<RecallButton\n\t\t\t\t\t:id=Recall.after3days.id\n\t\t\t\t\t:active=isActiveRecall(Recall.after3days.id)\n\t\t\t\t\t@onClick=\"this.onRecallClick\"\n\t\t\t\t\t:title=\"$Bitrix.Loc.getMessage('CRM_SETTINGS_POPUP_CALENDAR_RECALL_AFTER_3_DAYS')\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div ref=\"plannerContainer\" class=\"crm-activity__settings_popup__calendar__planner-container\"></div>\n\t\t</div>\n\t`\n};\n","import { Events } from 'crm.activity.settings-popup';\nimport { TagSelector } from 'crm.entity-selector';\n\nimport 'ui.design-tokens';\nimport './ping.css'\n\nexport const Ping = {\n\tprops: {\n\t\tparams: {\n\t\t\ttype: Object,\n\t\t\tdefault: {},\n\t\t},\n\t},\n\n\tdata(): Object\n\t{\n\t\tconst selectedItems = this.params.selectedItems || [];\n\n\t\treturn {\n\t\t\tid: this.getId(),\n\t\t\tselectedItems,\n\t\t};\n\t},\n\n\tmounted(): void\n\t{\n\t\tconst preselectedItems = [];\n\t\t\n\t\tthis.selectedItems.forEach(item => preselectedItems.push(['timeline_ping', item]));\n\n\t\tthis.pingSelector = new TagSelector({\n\t\t\ttextBoxWidth: '100%',\n\t\t\tdialogOptions: {\n\t\t\t\theight: 330,\n\t\t\t\tdropdownMode: true,\n\t\t\t\tshowAvatars: false,\n\t\t\t\tenableSearch: false,\n\t\t\t\tpreselectedItems: preselectedItems,\n\t\t\t\tentities: [{\n\t\t\t\t\tid: 'timeline_ping'\n\t\t\t\t}],\n\t\t\t\tevents: {\n\t\t\t\t\t'Item:onSelect': () => {\n\t\t\t\t\t\tthis.onChangeSelectorData()\n\t\t\t\t\t},\n\t\t\t\t\t'Item:onDeselect': () => {\n\t\t\t\t\t\tthis.onChangeSelectorData()\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t}\n\t\t});\n\n\t\tthis.pingSelector.renderTo(this.$refs.pingSel);\n\n\t\tthis.emitSettingsChange();\n\t},\n\n\tunmounted(): void\n\t{\n\t\tthis.emitSettingsChange(false);\n\t},\n\n\twatch: {\n\t\tselectedItems()\n\t\t{\n\t\t\tthis.emitSettingsChange();\n\t\t},\n\t},\n\n\tmethods: {\n\t\tgetId(): string\n\t\t{\n\t\t\treturn 'ping';\n\t\t},\n\n\t\tonChangeSelectorData()\n\t\t{\n\t\t\tif (this.pingSelector)\n\t\t\t{\n\t\t\t\tthis.selectedItems = this.pingSelector.getDialog().getSelectedItems().map(item => item.id);\n\t\t\t}\n\t\t},\n\n\t\temitSettingsChange(active: boolean = true): void\n\t\t{\n\t\t\tthis.$Bitrix.eventEmitter.emit(Events.EVENT_SETTINGS_CHANGE, this.exportParams(active));\n\t\t},\n\n\t\texportParams(active: boolean = true): Object\n\t\t{\n\t\t\tthis.pingSelector.getDialog().getSelectedItems().map(item => item.id);\n\t\t\t\n\t\t\treturn {\n\t\t\t\tid: this.id,\n\t\t\t\tselectedItems: this.selectedItems,\n\t\t\t\tactive,\n\t\t\t}\n\t\t},\n\n\t\tupdateSettings(data: Object | null): void\n\t\t{\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div class=\"ui-form\">\n\t\t\t<div ref=\"pingSel\" class=\"crm-activity__settings_popup__ping-selector-container\"></div>\n\t\t</div>\n\t`\n};\n","import { Type } from 'main.core';\nimport { Events } from 'crm.activity.settings-popup';\n\nimport { Section as WrapperSection } from '../section/section';\nimport { Calendar as SettingsPopupCalendar } from '../calendar/calendar';\nimport { Ping as SettingsPopupPing } from '../ping/ping';\n\nexport const Wrapper = {\n\tcomponents: {\n\t\tWrapperSection,\n\t\tSettingsPopupCalendar,\n\t\tSettingsPopupPing,\n\t},\n\tprops: {\n\t\tonSettingsChangeCallback: {\n\t\t\ttype: Function,\n\t\t\trequired: true,\n\t\t},\n\t\tonSettingsValidationCallback: {\n\t\t\ttype: Function,\n\t\t},\n\t\tsections: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t},\n\n\tdata() {\n\t\treturn {\n\t\t\tsettings: new Map(),\n\t\t}\n\t},\n\n\tcomputed: {\n\t\tactiveSettingsIds(): Object\n\t\t{\n\t\t\tconst result = {};\n\t\t\tthis.sections.forEach(section => {\n\t\t\t\tresult[section.id] = Boolean(section.active);\n\t\t\t})\n\n\t\t\treturn result;\n\t\t}\n\t},\n\n\tmethods: {\n\t\tgetSectionTitle(id: string): string\n\t\t{\n\t\t\tid = id.toUpperCase();\n\n\t\t\tconst defaultCode = 'CRM_SETTINGS_POPUP_SECTION_SWITCH';\n\t\t\tconst code = `${defaultCode}_${id}`;\n\n\t\t\treturn this.$Bitrix.Loc.getMessage(code) || this.$Bitrix.Loc.getMessage(defaultCode);\n\t\t},\n\n\t\tgetSectionToggle(showToggleSelector: boolean): boolean\n\t\t{\n\t\t\tif (Type.isBoolean(showToggleSelector))\n\t\t\t{\n\t\t\t\treturn showToggleSelector\n\t\t\t}\n\n\t\t\treturn true;\n\t\t},\n\n\t\tprepareSettings(): void\n\t\t{\n\t\t\tfor (const sectionName in this.activeSettingsIds)\n\t\t\t{\n\t\t\t\tif (!this.activeSettingsIds[sectionName])\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tconst section = this.sections.find(section => section.id === sectionName);\n\t\t\t\tif (!section)\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tconst data = {\n\t\t\t\t\tid: section.id,\n\t\t\t\t\t...section.params,\n\t\t\t\t}\n\n\t\t\t\tthis.settings.set(sectionName, data);\n\t\t\t}\n\t\t},\n\n\t\tonSettingsChange({ data }): void\n\t\t{\n\t\t\tif (data.id)\n\t\t\t{\n\t\t\t\tif (data.active)\n\t\t\t\t{\n\t\t\t\t\tthis.settings.set(data.id, data);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.settings.delete(data.id);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (this.onSettingsChangeCallback)\n\t\t\t{\n\t\t\t\tthis.onSettingsChangeCallback(this.exportParams());\n\t\t\t}\n\t\t},\n\n\t\tonSettingsValidation({ data }): void\n\t\t{\n\t\t\tif (this.onSettingsChangeCallback)\n\t\t\t{\n\t\t\t\tthis.onSettingsValidationCallback(data);\n\t\t\t}\n\t\t},\n\n\t\texportParams(): Object\n\t\t{\n\t\t\tconst settings = Object.fromEntries(this.settings);\n\n\t\t\tlet result = {};\n\n\t\t\tfor (const id in this.activeSettingsIds)\n\t\t\t{\n\t\t\t\tif (this.activeSettingsIds[id] && settings[id])\n\t\t\t\t{\n\t\t\t\t\tresult[id] = settings[id];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn result;\n\t\t},\n\n\t\tonToggleSettingsSection({ id, isActive }): void\n\t\t{\n\t\t\tif (this.activeSettingsIds.hasOwnProperty(id))\n\t\t\t{\n\t\t\t\tthis.activeSettingsIds[id] = isActive;\n\t\t\t}\n\t\t},\n\n\t\tupdateSettings(data: Object): void\n\t\t{\n\t\t\tthis.sections.forEach(section => {\n\t\t\t\tif (this.$refs['section-' + section.id] && this.$refs['section-' + section.id][0])\n\t\t\t\t{\n\t\t\t\t\tthis.$refs['section-' + section.id][0].updateSettings(data);\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t},\n\n\tmounted()\n\t{\n\t\tthis.prepareSettings();\n\t\tthis.$Bitrix.eventEmitter.subscribe(Events.EVENT_SETTINGS_CHANGE, this.onSettingsChange);\n\t\tthis.$Bitrix.eventEmitter.subscribe(Events.EVENT_SETTINGS_VALIDATION, this.onSettingsValidation);\n\t},\n\n\tbeforeUnmount()\n\t{\n\t\tthis.$Bitrix.eventEmitter.unsubscribe(Events.EVENT_SETTINGS_CHANGE, this.onSettingsChange);\n\t\tthis.$Bitrix.eventEmitter.unsubscribe(Events.EVENT_SETTINGS_VALIDATION, this.onSettingsValidation);\n\t},\n\n\ttemplate: `\n\t\t<div class=\"crm-activity__settings-popup_body\">\n\t\t\t<WrapperSection\n\t\t\t\tv-for=\"section in sections\"\n\t\t\t\t:id=\"section.id\"\n\t\t\t\t:toggle-title=\"getSectionTitle(section.id)\"\n\t\t\t\t:toggle-enabled=\"activeSettingsIds[section.id]\"\n\t\t\t\t:toggle-visible=\"getSectionToggle(section.showToggleSelector)\"\n\t\t\t\t@onToggle=\"onToggleSettingsSection\"\n\t\t\t>\n\t\t\t\t<component \n\t\t\t\t\tv-bind:is=\"section.component\"\n\t\t\t\t\t:params=\"section.params || {}\"\n\t\t\t\t\t:ref=\"'section-' + section.id\"\n\t\t\t\t></component>\n\t\t\t</WrapperSection>\n\t\t</div>\n\t`\n};\n","import { ajax as Ajax, Loc, Tag } from 'main.core';\nimport { Popup } from 'main.popup';\nimport { Button, ButtonColor, ButtonState, CancelButton, SaveButton } from 'ui.buttons';\nimport { UI } from 'ui.notification';\nimport { Wrapper as SettingsPopupWrapper } from './components/wrapper/wrapper';\nimport { BitrixVue } from 'ui.vue3';\nimport { Calendar } from './components/calendar/calendar';\nimport { Ping } from './components/ping/ping';\n\nimport type { SettingsPopupOptions } from './settings-popup-options';\n\nimport 'ui.design-tokens';\nimport './settings-popup.css';\n\nconst SAVE_BUTTON_ID = 'save';\nconst CANCEL_BUTTON_ID = 'cancel';\n\nconst Events = {\n\tEVENT_SETTINGS_CHANGE: 'crm:settings-popup:settings-change',\n\tEVENT_SETTINGS_VALIDATION: 'crm:settings-popup:settings-validation',\n};\n\nclass SettingsPopup\n{\n\tcontainer: HTMLElement = null;\n\tlayoutApp = null;\n\tlayoutComponent = null;\n\tpopup: ?Popup = null;\n\t#onSettingsChange: ?Function = null;\n\t#onSave: ?Function = null;\n\t#settingsSections: Object[] = [];\n\t#fetchSettingsPath: ?String = null;\n\t#ownerTypeId: ?Number = null;\n\t#ownerId: ?Number = null;\n\t#id: ?Number = null;\n\t#currentSettings: ?Object = null;\n\n\tconstructor(options: SettingsPopupOptions)\n\t{\n\t\tthis.#settingsSections = options.sections || [];\n\t\tthis.#fetchSettingsPath = options.fetchSettingsPath || null;\n\t\tthis.#ownerTypeId = options.ownerTypeId || null;\n\t\tthis.#ownerId = options.ownerId || null;\n\t\tthis.#id = options.id || null;\n\t\tthis.#onSettingsChange = options.onSettingsChange || null;\n\t\tthis.#currentSettings = options.settings || null;\n\n\t\tif (options.onSave)\n\t\t{\n\t\t\tthis.#onSave = options.onSave;\n\t\t}\n\t}\n\n\t#onSettingsValidation(data)\n\t{\n\t\tif (this.popup)\n\t\t{\n\t\t\tthis.popup.buttons[0].setDisabled(!data.isValid);\n\t\t}\n\t}\n\n\tshow(): void\n\t{\n\t\tif (!this.popup || this.popup.isDestroyed())\n\t\t{\n\t\t\tconst htmlStyles = getComputedStyle(document.documentElement);\n\t\t\tconst popupPadding = htmlStyles.getPropertyValue('--ui-space-inset-sm');\n\t\t\tconst popupPaddingNumberValue = parseFloat(popupPadding) || 12;\n\t\t\tconst popupOverlayColor = htmlStyles.getPropertyValue('--ui-color-base-solid') || '#000000';\n\n\t\t\tconst content = Tag.render`\n\t\t\t\t<div class=\"crm-activity__settings\">\n\t\t\t\t\t<div class=\"crm-activity__settings_title\">${this.#getPopupTitle()}</div>\n\t\t\t\t\t<div class=\"crm-activity__todo-settings_content\"></div>\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tthis.popup = new Popup({\n\t\t\t\tcloseIcon: true,\n\t\t\t\tcloseByEsc: true,\n\t\t\t\tpadding: popupPaddingNumberValue,\n\t\t\t\toverlay: {\n\t\t\t\t\topacity: 40,\n\t\t\t\t\tbackgroundColor: popupOverlayColor,\n\t\t\t\t},\n\t\t\t\tcontent,\n\t\t\t\tbuttons: this.#getPopupButtons(),\n\t\t\t\tminWidth: 850,\n\t\t\t\twidth: 850,\n\t\t\t\tclassName: 'crm-activity__settings-popup'\n\t\t\t});\n\n\t\t\tthis.popup.subscribeOnce('onFirstShow', () => {\n\t\t\t\tthis.loadSettings()\n\t\t\t\t\t.then(\n\t\t\t\t\t\t() => {\n\t\t\t\t\t\t\tthis.#getPopupContent();\n\t\t\t\t\t\t\tthis.popup.adjustPosition();\n\t\t\t\t\t\t},\n\t\t\t\t\t\t() => {\n\t\t\t\t\t\t\tUI.Notification.Center.notify({\n\t\t\t\t\t\t\t\tcontent: Loc.getMessage('CRM_SETTINGS_POPUP_ERROR'),\n\t\t\t\t\t\t\t\tautoHideDelay: 5000,\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t});\n\n\t\t\tthis.popup.subscribe('onClose', this.#initLayoutComponent.bind(this));\n\t\t}\n\n\t\tthis.popup.show();\n\t}\n\n\t#getPopupContent(): HTMLElement\n\t{\n\t\tthis.container = this.popup\n\t\t\t.getContentContainer()\n\t\t\t.getElementsByClassName('crm-activity__todo-settings_content')\n\t\t\t.item(0)\n\t\t;\n\n\t\tthis.#initLayoutComponent();\n\n\t\treturn this.layoutComponent;\n\t}\n\n\tloadSettings(): Promise\n\t{\n\t\tif (!this.#fetchSettingsPath)\n\t\t{\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\tconst data = {\n\t\t\tid: this.#id,\n\t\t\townerTypeId: this.#ownerTypeId,\n\t\t\townerId: this.#ownerId,\n\t\t}\n\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tAjax\n\t\t\t\t.runAction(this.#fetchSettingsPath, { data })\n\t\t\t\t.then(({ data }) => {\n\t\t\t\t\tdata.forEach(item => {\n\t\t\t\t\t\tconst section = this.#settingsSections.find(settingsSection => settingsSection.id === item.id);\n\t\t\t\t\t\tif (!section)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tsection.active = item.active;\n\t\t\t\t\t\tsection.params = item.settings;\n\t\t\t\t\t});\n\n\t\t\t\t\tresolve();\n\t\t\t\t})\n\t\t\t\t.catch(reject)\n\t\t\t;\n\t\t});\n\t}\n\n\t#getPopupTitle(): string\n\t{\n\t\treturn Loc.getMessage('CRM_SETTINGS_POPUP_TITLE');\n\t}\n\n\t#getPopupButtons(): ReadonlyArray<Button>\n\t{\n\t\treturn [\n\t\t\tnew SaveButton({\n\t\t\t\tid: SAVE_BUTTON_ID,\n\t\t\t\tround: true,\n\t\t\t\tstate: ButtonState.ACTIVE,\n\t\t\t\tevents: {\n\t\t\t\t\tclick: this.save.bind(this),\n\t\t\t\t},\n\t\t\t}),\n\t\t\tnew CancelButton({\n\t\t\t\tid: CANCEL_BUTTON_ID,\n\t\t\t\tround: true,\n\t\t\t\tevents: {\n\t\t\t\t\tclick: this.#cancel.bind(this),\n\t\t\t\t},\n\t\t\t\ttext: Loc.getMessage('CRM_SETTINGS_POPUP_CANCEL'),\n\t\t\t\tcolor: ButtonColor.LIGHT_BORDER,\n\t\t\t}),\n\t\t]\n\t}\n\n\tsave(): void\n\t{\n\t\tthis.#currentSettings = this.getSettings();\n\n\t\tif (this.#onSettingsChange)\n\t\t{\n\t\t\tthis.#onSettingsChange(this.getSettings());\n\t\t}\n\n\t\tthis.#closePopup();\n\n\t\tif (this.#onSave)\n\t\t{\n\t\t\tthis.#onSave(this.#ownerTypeId, this.#ownerId, this.#id, this.getSettings());\n\t\t}\n\t}\n\n\t#cancel(): void\n\t{\n\t\tthis.#closePopup();\n\t\tthis.#initLayoutComponent();\n\t}\n\n\t#initLayoutComponent(): void\n\t{\n\t\tif (this.layoutApp && this.layoutComponent)\n\t\t{\n\t\t\tthis.layoutApp.unmount(this.container);\n\t\t}\n\n\t\tif (this.#currentSettings)\n\t\t{\n\t\t\tthis.#settingsSections.forEach(section => {\n\t\t\t\tif (this.#currentSettings[section.id])\n\t\t\t\t{\n\t\t\t\t\tsection.active = true;\n\t\t\t\t\tsection.params = this.#currentSettings[section.id];\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tthis.layoutApp = BitrixVue.createApp(SettingsPopupWrapper, {\n\t\t\tonSettingsChangeCallback: this.#adjustPopup.bind(this),\n\t\t\tonSettingsValidationCallback: this.#onSettingsValidation.bind(this),\n\t\t\tsections: this.#settingsSections,\n\t\t});\n\n\t\tthis.layoutComponent = this.layoutApp.mount(this.container);\n\t}\n\n\t#adjustPopup()\n\t{\n\t\tthis.popup.adjustPosition();\n\t\tthis.popup.buttons[0].setDisabled(false);\n\t}\n\n\t#closePopup(): void\n\t{\n\t\tthis.popup?.close();\n\t}\n\n\tgetSettings(): Object\n\t{\n\t\treturn this.layoutComponent?.exportParams();\n\t}\n\n\tsyncSettings(data: Object | null = null): void\n\t{\n\t\tif (data && this.layoutComponent)\n\t\t{\n\t\t\tthis.layoutComponent.updateSettings(data);\n\t\t}\n\t}\n}\n\nexport {\n\tCalendar,\n\tPing,\n\tSettingsPopup,\n\tEvents,\n};\n"],"names":["Section","props","id","type","String","required","toggleTitle","default","toggleEnabled","Boolean","toggleVisible","watch","enabled","$emit","isActive","data","template","RecallButton","active","title","methods","onClick","Recall","today","days","tomorrow","after2days","after3days","DurationPeriods","minute","seconds","hour","day","Calendar","components","params","Object","timestamp","from","Factory","getUserNow","getTime","Math","round","duration","durationPeriodId","getPeriodIdBySeconds","to","getId","timeFromClockInstance","timeToClockInstance","plannerInstance","computed","fromDateFormatted","get","DateFormatter","format","BX","Crm","DateTime","Dictionary","Format","SHORT_DATE_FORMAT","set","value","date","parse","currentDate","createDateInstance","setHours","getHours","getMinutes","fromTimeFormatted","getFormattedTime","newTime","getDateInstanceWithTime","closeWnd","toDateFormatted","toTime","createFromTimestampInUserTimezone","calcDuration","toTimeFormatted","SHORT_TIME_FORMAT","activeRecallId","isDatesAreEqual","date1","date2","fromDate","addDay","setDate","getDate","mounted","Planner","wrap","$refs","plannerContainer","compactMode","minWidth","minHeight","height","width","subscribe","handlePlannerSelectorChanges","bind","show","getAccessibilityForUsers","onDataUpdate","unmounted","emitSettingsChange","time","timeArr","split","hours","Number","minutes","isAmPm","includes","parseInt","durationSeconds","dateFrom","dateTo","updatePlanner","getDurationSeconds","updateSelector","exportParams","validateParams","$Bitrix","eventEmitter","emit","Events","EVENT_SETTINGS_CHANGE","EVENT_SETTINGS_VALIDATION","isValid","getFormattedDate","getFormattedValue","getSecondsFromStartOfDay","startOfDay","getDurationPeriodTitle","periodId","code","toUpperCase","Loc","getMessage","onDateFromClick","calendar","node","field","bTime","onDateFromChange","event","target","onDateToChange","onDateToClick","onTimeFromClick","showClockSelector","timeFrom","onTimeToClick","timeTo","instanceName","startTimestamp","propertyName","CClockSelector","start_time","callback","Show","onDurationKeyUp","replace","onRecallClick","todayDate","Date","now","isActiveRecall","name","fromText","DateTimeFormat","DatetimeConverter","getSiteDateTimeFormat","toText","durationRegion","classList","add","remove","offset","Ajax","runAction","then","update","entries","accessibility","updateSettings","deadline","Ping","selectedItems","preselectedItems","forEach","item","push","pingSelector","TagSelector","textBoxWidth","dialogOptions","dropdownMode","showAvatars","enableSearch","entities","events","onChangeSelectorData","renderTo","pingSel","getDialog","getSelectedItems","map","Wrapper","WrapperSection","SettingsPopupCalendar","SettingsPopupPing","onSettingsChangeCallback","Function","onSettingsValidationCallback","sections","Array","settings","Map","activeSettingsIds","result","section","getSectionTitle","defaultCode","getSectionToggle","showToggleSelector","Type","isBoolean","prepareSettings","sectionName","find","onSettingsChange","delete","onSettingsValidation","fromEntries","onToggleSettingsSection","hasOwnProperty","beforeUnmount","unsubscribe","SAVE_BUTTON_ID","CANCEL_BUTTON_ID","SettingsPopup","constructor","options","container","layoutApp","layoutComponent","popup","fetchSettingsPath","ownerTypeId","ownerId","onSave","isDestroyed","htmlStyles","getComputedStyle","document","documentElement","popupPadding","getPropertyValue","popupPaddingNumberValue","parseFloat","popupOverlayColor","content","Tag","render","Popup","closeIcon","closeByEsc","padding","overlay","opacity","backgroundColor","buttons","className","subscribeOnce","loadSettings","adjustPosition","UI","Notification","Center","notify","autoHideDelay","Promise","resolve","reject","settingsSection","catch","save","getSettings","syncSettings","setDisabled","getContentContainer","getElementsByClassName","SaveButton","state","ButtonState","ACTIVE","click","CancelButton","text","color","ButtonColor","LIGHT_BORDER","unmount","BitrixVue","createApp","SettingsPopupWrapper","mount","close"],"mappings":";;;;;CAAO,MAAMA,OAAO,GAAG;GACtBC,KAAK,EAAE;KACNC,EAAE,EAAE;OACHC,IAAI,EAAEC,MAAM;OACZC,QAAQ,EAAE;MACV;KACDC,WAAW,EAAE;OACZH,IAAI,EAAEC,MAAM;OACZG,OAAO,EAAE;MACT;KACDC,aAAa,EAAE;OACdL,IAAI,EAAEM,OAAO;OACbF,OAAO,EAAE;MACT;KACDG,aAAa,EAAE;OACdP,IAAI,EAAEM,OAAO;OACbF,OAAO,EAAE;;IAEV;GAEDI,KAAK,EAAE;KACNC,OAAO,GAAG;OACT,IAAI,CAACC,KAAK,CAAC,UAAU,EAAE;SACtBX,EAAE,EAAE,IAAI,CAACA,EAAE;SACXY,QAAQ,EAAE,IAAI,CAACF;QACf,CAAC;;IAEH;GAEDG,IAAI,GAAG;KACN,OAAO;OACNH,OAAO,EAAE,IAAI,CAACJ;MACd;IACD;GAEDQ,QAAQ,EAAG;;;;;;;;;;;;;;;;CAgBZ,CAAC;;CCnDM,MAAMC,YAAY,GAAG;GAC3BhB,KAAK,EAAE;KACNC,EAAE,EAAEE,MAAM;KACVc,MAAM,EAAET,OAAO;KACfU,KAAK,EAAEf;IACP;GACDgB,OAAO,EAAE;KACRC,OAAO,EAAE,YAAW;OACnB,IAAI,CAACR,KAAK,CAAC,SAAS,EAAE,IAAI,CAACX,EAAE,CAAC;;IAE/B;GACDc,QAAQ,EAAG;;;;;CAKZ,CAAC;;CCJD,MAAMM,MAAM,GAAG;GACdC,KAAK,EAAE;KACNrB,EAAE,EAAE,OAAO;KACXsB,IAAI,EAAE;IACN;GACDC,QAAQ,EAAE;KACTvB,EAAE,EAAE,UAAU;KACdsB,IAAI,EAAE;IACN;GACDE,UAAU,EAAE;KACXxB,EAAE,EAAE,YAAY;KAChBsB,IAAI,EAAE;IACN;GACDG,UAAU,EAAE;KACXzB,EAAE,EAAE,YAAY;KAChBsB,IAAI,EAAE;;CAER,CAAC;CAED,MAAMI,eAAe,GAAG;GACvBC,MAAM,EAAE;KACP3B,EAAE,EAAE,QAAQ;KACZ4B,OAAO,EAAE;IACT;GACDC,IAAI,EAAE;KACL7B,EAAE,EAAE,MAAM;KACV4B,OAAO,EAAE,EAAE,GAAG;IACd;GACDE,GAAG,EAAE;KACJ9B,EAAE,EAAE,KAAK;KACT4B,OAAO,EAAE,EAAE,GAAG,EAAE,GAAG;;CAErB,CAAC;AAED,OAAaG,QAAQ,GAAG;GACvBC,UAAU,EAAE;KACXjB;IACA;GACDhB,KAAK,EAAE;KACNkC,MAAM,EAAE;OACPhC,IAAI,EAAEiC,MAAM;OACZ7B,OAAO,EAAE;;IAEV;GACDQ,IAAI,GACJ;KACC,MAAMsB,SAAS,GAAG,IAAI,CAACF,MAAM,CAACG,IAAI,IAAKC,oBAAO,CAACC,UAAU,EAAE,CAACC,OAAO,EAAE,GAAG,IAAK;KAC7E,MAAMH,IAAI,GAAGI,IAAI,CAACC,KAAK,CAACN,SAAS,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC;;KAE7C,IAAIO,QAAQ,GAAG,CAAC;KAChB,IAAIC,gBAAgB,GAAGjB,eAAe,CAACG,IAAI,CAAC7B,EAAE;KAC9C,IAAI,IAAI,CAACiC,MAAM,CAACS,QAAQ,EACxB;OACCC,gBAAgB,GAAG,IAAI,CAACC,oBAAoB,CAAC,IAAI,CAACX,MAAM,CAACS,QAAQ,CAAC;OAClEA,QAAQ,GAAG,IAAI,CAACT,MAAM,CAACS,QAAQ,GAAGhB,eAAe,CAACiB,gBAAgB,CAAC,CAACf,OAAO;;KAG5E,MAAMiB,EAAE,GAAGT,IAAI,GAAGM,QAAQ,GAAGhB,eAAe,CAACiB,gBAAgB,CAAC,CAACf,OAAO;KAEtE,OAAO;OACN5B,EAAE,EAAE,IAAI,CAAC8C,KAAK,EAAE;OAEhBV,IAAI;OACJS,EAAE;OAEFH,QAAQ;OACRC,gBAAgB;OAEhBI,qBAAqB,EAAE,IAAI;OAC3BC,mBAAmB,EAAE,IAAI;OACzBC,eAAe,EAAE;MACjB;IACD;GACDC,QAAQ,EAAE;KACTxB,eAAe,EAAE,MAAMA,eAAe;KACtCN,MAAM,EAAE,MAAMA,MAAM;KACpB+B,iBAAiB,EAAE;OAClBC,GAAG,GACH;SACC,OAAOC,cAAa,CAACC,MAAM,CAACC,EAAE,CAACC,GAAG,CAACC,QAAQ,CAACC,UAAU,CAACC,MAAM,CAACC,iBAAiB,EAAE,IAAI,CAACxB,IAAI,CAAC;QAC3F;OACDyB,GAAG,CAACC,KAAa,EACjB;SACC,MAAMC,IAAI,GAAGV,cAAa,CAACW,KAAK,CAACF,KAAK,CAAC;SACvC,MAAMG,WAAW,GAAG,IAAI,CAACC,kBAAkB,CAAC,IAAI,CAAC9B,IAAI,CAAC;SAEtD2B,IAAI,CAACI,QAAQ,CAACF,WAAW,CAACG,QAAQ,EAAE,EAAEH,WAAW,CAACI,UAAU,EAAE,EAAE,CAAC,EAAE,CAAC,CAAC;SAErE,IAAI,CAACjC,IAAI,GAAG2B,IAAI,CAACxB,OAAO,EAAE,GAAG,IAAI;SACjC,IAAI,CAACM,EAAE,GAAG,IAAI,CAACT,IAAI,GAAG,IAAI,CAACM,QAAQ;;MAEpC;KACD4B,iBAAiB,EAAE;OAClBlB,GAAG,GACH;SACC,OAAO,IAAI,CAACmB,gBAAgB,CAAC,MAAM,CAAC;QACpC;OACDV,GAAG,CAACW,OAAe,EACnB;SACC,MAAMT,IAAI,GAAG,IAAI,CAACU,uBAAuB,CAAC,IAAI,CAACrC,IAAI,EAAEoC,OAAO,CAAC;SAE7D,IAAI,CAACpC,IAAI,GAAG2B,IAAI,CAACxB,OAAO,EAAE,GAAG,IAAI;SACjC,IAAI,CAACQ,qBAAqB,CAAC2B,QAAQ,EAAE;;MAEtC;KACDC,eAAe,EAAE;OAChBvB,GAAG,GACH;SACC,MAAMwB,MAAM,GAAG,IAAI,CAACxC,IAAI,GAAG,IAAI,CAACM,QAAQ,GAAGhB,eAAe,CAAC,IAAI,CAACiB,gBAAgB,CAAC,CAACf,OAAO;SACzF,OAAOyB,cAAa,CAACC,MAAM,CAACC,EAAE,CAACC,GAAG,CAACC,QAAQ,CAACC,UAAU,CAACC,MAAM,CAACC,iBAAiB,EAAEgB,MAAM,CAAC;QACxF;OACDf,GAAG,CAACC,KAAa,EACjB;SACC,MAAMC,IAAI,GAAGV,cAAa,CAACW,KAAK,CAACF,KAAK,CAAC;SACvC,MAAMc,MAAM,GAAG,IAAI,CAACxC,IAAI,GAAG,IAAI,CAACM,QAAQ,GAAGhB,eAAe,CAAC,IAAI,CAACiB,gBAAgB,CAAC,CAACf,OAAO;SACzF,MAAMqC,WAAW,GAAG5B,oBAAO,CAACwC,iCAAiC,CAACD,MAAM,CAAC;SAErEb,IAAI,CAACI,QAAQ,CAACF,WAAW,CAACG,QAAQ,EAAE,EAAEH,WAAW,CAACI,UAAU,EAAE,EAAE,CAAC,EAAE,CAAC,CAAC;SACrE,IAAI,CAACS,YAAY,CAACf,IAAI,CAAC;;MAExB;KACDgB,eAAe,EAAE;OAChB3B,GAAG,GACH;SACC,MAAMwB,MAAM,GAAG,IAAI,CAACxC,IAAI,GAAG,IAAI,CAACM,QAAQ,GAAGhB,eAAe,CAAC,IAAI,CAACiB,gBAAgB,CAAC,CAACf,OAAO;SACzF,OAAOyB,cAAa,CAACC,MAAM,CAACC,EAAE,CAACC,GAAG,CAACC,QAAQ,CAACC,UAAU,CAACC,MAAM,CAACqB,iBAAiB,EAAEJ,MAAM,CAAC;QACxF;OACDf,GAAG,CAACW,OAAe,EACnB;SACC,MAAMT,IAAI,GAAG,IAAI,CAACU,uBAAuB,CAAC,IAAI,CAAC5B,EAAE,EAAE2B,OAAO,CAAC;SAE3D,IAAI,CAACM,YAAY,CAACf,IAAI,CAAC;SACvB,IAAI,CAACf,mBAAmB,CAAC0B,QAAQ,EAAE;;MAEpC;KACDO,cAAc,GACd;OACC,MAAMC,eAAe,GAAG,CAACC,KAAW,EAAEC,KAAW,KAAcD,KAAK,CAAC5C,OAAO,EAAE,KAAK6C,KAAK,CAAC7C,OAAO,EAAE;OAClG,MAAM8C,QAAQ,GAAG,IAAI,CAACnB,kBAAkB,CAAC,IAAI,CAAC9B,IAAI,EAAE,IAAI,CAAC;OAEzD,MAAM2B,IAAI,GAAG,IAAI,CAACG,kBAAkB,CAAC,IAAI,EAAE,IAAI,CAAC;OAEhD,IAAIgB,eAAe,CAACG,QAAQ,EAAEtB,IAAI,CAAC,EACnC;SACC,OAAO3C,MAAM,CAACC,KAAK,CAACrB,EAAE;;OAGvB,MAAMsF,MAAM,GAAIvB,IAAU,IAAKA,IAAI,CAACwB,OAAO,CAACxB,IAAI,CAACyB,OAAO,EAAE,GAAG,CAAC,CAAC;OAE/DF,MAAM,CAACvB,IAAI,CAAC;OACZ,IAAImB,eAAe,CAACG,QAAQ,EAAEtB,IAAI,CAAC,EACnC;SACC,OAAO3C,MAAM,CAACG,QAAQ,CAACvB,EAAE;;OAG1BsF,MAAM,CAACvB,IAAI,CAAC;OACZ,IAAImB,eAAe,CAACG,QAAQ,EAAEtB,IAAI,CAAC,EACnC;SACC,OAAO3C,MAAM,CAACI,UAAU,CAACxB,EAAE;;OAG5BsF,MAAM,CAACvB,IAAI,CAAC;OACZ,IAAImB,eAAe,CAACG,QAAQ,EAAEtB,IAAI,CAAC,EACnC;SACC,OAAO3C,MAAM,CAACK,UAAU,CAACzB,EAAE;;OAG5B,OAAO,IAAI;;IAEZ;GACDyF,OAAO,GACP;KACC,IAAI,CAACxC,eAAe,GAAG,IAAIyC,wBAAO,CAAC;OAClCC,IAAI,EAAE,IAAI,CAACC,KAAK,CAACC,gBAAgB;OACjCC,WAAW,EAAE,IAAI;OACjBC,QAAQ,EAAE,GAAG;OACbC,SAAS,EAAE,GAAG;OACdC,MAAM,EAAE,GAAG;OACXC,KAAK,EAAE;;MAEP,CAAC;;KAEF,IAAI,CAACjD,eAAe,CAACkD,SAAS,CAAC,cAAc,EAAE,IAAI,CAACC,4BAA4B,CAACC,IAAI,CAAC,IAAI,CAAC,CAAC;KAC5F,IAAI,CAACpD,eAAe,CAACqD,IAAI,EAAE;KAE3B,IAAI,CAACC,wBAAwB,EAAE;KAE/B,IAAI,CAACC,YAAY,EAAE;IACnB;GACDC,SAAS,GACT;KACC,IAAI,CAACC,kBAAkB,CAAC,KAAK,CAAC;IAC9B;GACDjG,KAAK,EAAE;KACNiC,QAAQ,GACR;OACC,IAAI,CAAC8D,YAAY,EAAE;MACnB;KACD7D,gBAAgB,GAChB;OACC,IAAI,CAAC6D,YAAY,EAAE;MACnB;KACDpE,IAAI,GACJ;OACC,IAAI,CAACoE,YAAY,EAAE;MACnB;KACD3D,EAAE,GACF;OACC,IAAI,CAAC2D,YAAY,EAAE;;IAEpB;GACDtF,OAAO,EAAE;KACR4B,KAAK,GACL;OACC,OAAO,UAAU;MACjB;KACD2B,uBAAuB,CAACtC,SAAiB,EAAEwE,IAAY,EACvD;OACC,MAAMC,OAAO,GAAGD,IAAI,CAACE,KAAK,CAAC,GAAG,CAAC;OAC/B,MAAM9C,IAAI,GAAG1B,oBAAO,CAACwC,iCAAiC,CAAC1C,SAAS,CAAC;OAEjE,IAAI2E,KAAK,GAAGC,MAAM,CAACH,OAAO,CAAC,CAAC,CAAC,CAAC;OAC9B,IAAII,OAAO,GAAGJ,OAAO,CAAC,CAAC,CAAC;OACxB,MAAMK,MAAM,GAAID,OAAO,CAACE,QAAQ,CAAC,IAAI,CAAC,IAAIF,OAAO,CAACE,QAAQ,CAAC,IAAI,CAAE;OACjE,IAAID,MAAM,EACV;SACC,IAAID,OAAO,CAACE,QAAQ,CAAC,IAAI,CAAC,IAAIJ,KAAK,KAAK,EAAE,EAC1C;WACCA,KAAK,IAAI,EAAE;;SAGZE,OAAO,GAAGG,QAAQ,CAACH,OAAO,EAAE,EAAE,CAAC;;OAGhCjD,IAAI,CAACI,QAAQ,CAAC2C,KAAK,EAAEE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;OAEnC,OAAOjD,IAAI;MACX;KACDe,YAAY,CAACf,IAAU,EACvB;OACC,MAAMqD,eAAe,GAAGrD,IAAI,CAACxB,OAAO,EAAE,GAAG,IAAI,GAAG,IAAI,CAACH,IAAI;OACzD,IAAIgF,eAAe,GAAG1F,eAAe,CAAC,IAAI,CAACiB,gBAAgB,CAAC,CAACf,OAAO,KAAK,CAAC,EAC1E;SACC,IAAI,CAACc,QAAQ,GAAG0E,eAAe,GAAC1F,eAAe,CAAC,IAAI,CAACiB,gBAAgB,CAAC,CAACf,OAAO;QAC9E,MAED;SACC,IAAI,CAACc,QAAQ,GAAG0E,eAAe,GAAC1F,eAAe,CAACC,MAAM,CAACC,OAAO;SAC9D,IAAI,CAACe,gBAAgB,GAAGjB,eAAe,CAACC,MAAM,CAAC3B,EAAE;;MAElD;KACD4C,oBAAoB,CAACkB,KAAa,EAClC;OACC,IAAIA,KAAK,GAAGpC,eAAe,CAACI,GAAG,CAACF,OAAO,KAAK,CAAC,EAC7C;SACC,OAAOF,eAAe,CAACI,GAAG,CAAC9B,EAAE;;OAG9B,IAAI8D,KAAK,GAAGpC,eAAe,CAACG,IAAI,CAACD,OAAO,KAAK,CAAC,EAC9C;SACC,OAAOF,eAAe,CAACG,IAAI,CAAC7B,EAAE;;OAG/B,OAAO0B,eAAe,CAACC,MAAM,CAAC3B,EAAE;MAChC;KACDoG,4BAA4B,CAAC;OAAEvF,IAAI,EAAE;SAAEwG,QAAQ;SAAEC;;MAAU,EAC3D;OACC,IAAI,CAAClF,IAAI,GAAGiF,QAAQ,CAAC9E,OAAO,EAAE,GAAG,IAAI;OACrC,IAAI,CAACuC,YAAY,CAACwC,MAAM,CAAC;MACzB;KACDd,YAAY,GACZ;OACC,IAAI,CAACe,aAAa,EAAE;OACpB,IAAI,CAACb,kBAAkB,EAAE;MACzB;KACDa,aAAa,GACb;OACC,MAAMF,QAAQ,GAAG,IAAI,CAACnD,kBAAkB,CAAC,IAAI,CAAC9B,IAAI,CAAC;OACnD,MAAMgF,eAAe,GAAG,IAAI,CAACI,kBAAkB,EAAE;OACjD,MAAMF,MAAM,GAAG,IAAI,CAACpD,kBAAkB,CAAC,IAAI,CAAC9B,IAAI,GAAGgF,eAAe,CAAC;OAEnE,IAAI,CAACnE,eAAe,CAACwE,cAAc,CAACJ,QAAQ,EAAEC,MAAM,CAAC;MACrD;KACDZ,kBAAkB,CAAC1F,MAAe,GAAG,IAAI,EACzC;OACC,MAAMH,IAAI,GAAG,IAAI,CAAC6G,YAAY,CAAC1G,MAAM,CAAC;OACtC,IACEA,MAAM,IAAI,IAAI,CAAC2G,cAAc,CAAC9G,IAAI,CAAC,IACjC,CAACG,MAAM,EAEX;SACC,IAAI,CAAC4G,OAAO,CAACC,YAAY,CAACC,IAAI,CAACC,iCAAM,CAACC,qBAAqB,EAAEnH,IAAI,CAAC;QAClE,MAED;SACC,IAAI,CAAC+G,OAAO,CAACC,YAAY,CAACC,IAAI,CAACC,iCAAM,CAACE,yBAAyB,EAAE;WAAEC,OAAO,EAAE;UAAO,CAAC;;MAErF;KACDV,kBAAkB,GAClB;OACC,OAAO,IAAI,CAAC9E,QAAQ,GAAGhB,eAAe,CAAC,IAAI,CAACiB,gBAAgB,CAAC,CAACf,OAAO;MACrE;KACDuG,gBAAgB,CAACnI,EAAU,EAC3B;OACC,OAAO,IAAI,CAACoI,iBAAiB,CAACpI,EAAE,EAAEuD,EAAE,CAACC,GAAG,CAACC,QAAQ,CAACC,UAAU,CAACC,MAAM,CAACC,iBAAiB,CAAC;MACtF;KACDW,gBAAgB,CAACvE,EAAU,EAC3B;OACC,OAAO,IAAI,CAACoI,iBAAiB,CAACpI,EAAE,EAAEuD,EAAE,CAACC,GAAG,CAACC,QAAQ,CAACC,UAAU,CAACC,MAAM,CAACqB,iBAAiB,CAAC;MACtF;KACDoD,iBAAiB,CAACpI,EAAU,EAAEsD,MAAc,EAC5C;OACC,MAAMnB,SAAS,GAAInC,EAAE,KAAK,MAAM,GAAG,IAAI,CAACoC,IAAI,GAAG,IAAI,CAACS,EAAG;OACvD,OAAOQ,cAAa,CAACC,MAAM,CAACA,MAAM,EAAEnB,SAAS,CAAC;MAC9C;KACDkG,wBAAwB,CAAClG,SAAiB,EAC1C;OACC,MAAMmG,UAAU,GAAG,IAAI,CAACpE,kBAAkB,CAAC/B,SAAS,EAAE,IAAI,CAAC;OAC3D,OAAOA,SAAS,GAAGmG,UAAU,CAAC/F,OAAO,EAAE,GAAG,IAAI;MAC9C;KACDgG,sBAAsB,CAACC,QAAgB,EACvC;OACC,MAAMC,IAAI,GAAI,wCAAuCD,QAAQ,CAACE,WAAW,EAAG,GAAE;OAC9E,OAAO,IAAI,CAACd,OAAO,CAACe,GAAG,CAACC,UAAU,CAACH,IAAI,CAAC;MACxC;KACDI,eAAe,GACf;OACCtF,EAAE,CAACuF,QAAQ,CACV;SACCC,IAAI,EAAE,IAAI,CAACnD,KAAK,CAACyB,QAAQ;SACzB2B,KAAK,EAAE,IAAI,CAACpD,KAAK,CAACyB,QAAQ;SAC1B4B,KAAK,EAAE;QACP,CACD;MACD;KACDC,gBAAgB,CAACC,KAAK,EACtB;OACC,IAAI,CAAChG,iBAAiB,GAAGgG,KAAK,CAACC,MAAM,CAACtF,KAAK;MAC3C;KACDuF,cAAc,CAACF,KAAK,EACpB;OACC,IAAI,CAACxE,eAAe,GAAGwE,KAAK,CAACC,MAAM,CAACtF,KAAK;MACzC;KACDwF,aAAa,GACb;OACC/F,EAAE,CAACuF,QAAQ,CACV;SACCC,IAAI,EAAE,IAAI,CAACnD,KAAK,CAAC0B,MAAM;SACvB0B,KAAK,EAAE,IAAI,CAACpD,KAAK,CAAC0B,MAAM;SACxB2B,KAAK,EAAE;QACP,CACD;MACD;KACDM,eAAe,GACf;OACC,IAAI,CAACC,iBAAiB,CACrB,uBAAuB,EACvB,IAAI,CAACpH,IAAI,EACT,IAAI,CAACwD,KAAK,CAAC6D,QAAQ,EACnB,mBAAmB,CACnB;MACD;KACDC,aAAa,GACb;OACC,IAAI,CAACF,iBAAiB,CACrB,qBAAqB,EACrB,IAAI,CAAC3G,EAAE,EACP,IAAI,CAAC+C,KAAK,CAAC+D,MAAM,EACjB,iBAAiB,CACjB;MACD;KACDH,iBAAiB,CAACI,YAAoB,EAAEC,cAAsB,EAAEd,IAAiB,EAAEe,YAAoB,EACvG;OACC,IAAI,CAAC,IAAI,CAACF,YAAY,CAAC,EACvB;SACC,IAAI,CAACA,YAAY,CAAC,GAAG,IAAIrG,EAAE,CAACwG,cAAc,CAAC;WAC1CC,UAAU,EAAE,IAAI,CAAC3B,wBAAwB,CAACwB,cAAc,CAAC;WACzDd,IAAI;WACJkB,QAAQ,EAAGtD,IAAI,IAAK;aACnB,IAAI,CAACmD,YAAY,CAAC,GAAGnD,IAAI;;UAE1B,CAAC;;OAGH,IAAI,CAACiD,YAAY,CAAC,CAACM,IAAI,EAAE;MACzB;KACDC,eAAe,GACf;OACC,IAAI,CAACzH,QAAQ,GAAG,IAAI,CAACA,QAAQ,CAAC0H,OAAO,CAAC,KAAK,EAAC,EAAE,CAAC;MAC/C;KACDC,aAAa,CAACrK,EAAE,EAChB;OACC,MAAMqF,QAAQ,GAAG,IAAI,CAACnB,kBAAkB,CAAC,IAAI,CAAC9B,IAAI,CAAC;OACnD,MAAMkI,SAAS,GAAG,IAAI,CAACpG,kBAAkB,CAAC,IAAI,EAAE,IAAI,CAAC;OACrDoG,SAAS,CAACnG,QAAQ,CAACkB,QAAQ,CAACjB,QAAQ,EAAE,EAAEiB,QAAQ,CAAChB,UAAU,EAAE,CAAC;OAE9D,IAAI,CAACjC,IAAI,GAAGkI,SAAS,CAAC/E,OAAO,CAAC+E,SAAS,CAAC9E,OAAO,EAAE,GAAGpE,MAAM,CAACpB,EAAE,CAAC,CAACsB,IAAI,CAAC,GAAG,IAAI;OAE3E,MAAMoB,QAAQ,GAAG,IAAI,CAACA,QAAQ,GAAGhB,eAAe,CAAC,IAAI,CAACiB,gBAAgB,CAAC,CAACf,OAAO;OAC/E,IAAI,CAACiB,EAAE,GAAG,IAAI,CAACT,IAAI,GAAGM,QAAQ;MAC9B;KACDwB,kBAAkB,CAAC/B,SAAwB,GAAG,IAAI,EAAEmG,UAAmB,GAAG,KAAK,EAC/E;OACC,IAAI,CAACnG,SAAS,EACd;SACCA,SAAS,GAAGoI,IAAI,CAACC,GAAG,EAAE,GAAG,IAAI;;OAG9B,MAAMzG,IAAI,GAAG,IAAIwG,IAAI,CAACpI,SAAS,GAAG,IAAI,CAAC;OACvC,IAAImG,UAAU,EACd;SACCvE,IAAI,CAACI,QAAQ,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;;OAG1B,OAAOJ,IAAI;MACX;KACD0G,cAAc,CAACC,IAAY,EAC3B;OACC,OAAQA,IAAI,KAAK,IAAI,CAACzF,cAAc;MACpC;KACDyC,YAAY,CAAC1G,MAAe,GAAG,IAAI,EACnC;OACC,MAAMoB,IAAI,GAAG,IAAI,CAACA,IAAI;OACtB,MAAMM,QAAQ,GAAG,IAAI,CAACA,QAAQ,GAAGhB,eAAe,CAAC,IAAI,CAACiB,gBAAgB,CAAC,CAACf,OAAO;OAC/E,MAAMiB,EAAE,GAAG,IAAI,CAACT,IAAI,GAAGM,QAAQ;OAE/B,OAAO;SACN1C,EAAE,EAAE,IAAI,CAACA,EAAE;SACXoC,IAAI;SACJM,QAAQ;SACRG,EAAE;SACF7B,MAAM;SACN2J,QAAQ,EAAEC,wBAAc,CAACtH,MAAM,CAACuH,oCAAiB,CAACC,qBAAqB,EAAE,EAAE1I,IAAI,CAAC;SAChF2I,MAAM,EAAEH,wBAAc,CAACtH,MAAM,CAACuH,oCAAiB,CAACC,qBAAqB,EAAE,EAAEjI,EAAE;QAC3E;MACD;KACD8E,cAAc,CAAC9G,IAAY,EAC3B;OACC,IAAIA,IAAI,CAAC6B,QAAQ,GAAG,CAAC,EACrB;SACC,IAAI,CAACkD,KAAK,CAACoF,cAAc,CAACC,SAAS,CAACC,GAAG,CAAC,eAAe,CAAC;SACxD,OAAO,KAAK;;OAGb,IAAI,CAACtF,KAAK,CAACoF,cAAc,CAACC,SAAS,CAACE,MAAM,CAAC,eAAe,CAAC;OAC3D,OAAO,IAAI;MACX;KACD5E,wBAAwB,GACxB;OACC,MAAM6E,MAAM,GAAG,EAAE,GAAG,EAAE,GAAG,IAAI,CAAC;OAC9BC,cAAI,CAACC,SAAS,CAAC,yDAAyD,EAAE;SACzEzK,IAAI,EAAE;WACLuB,IAAI,EAAE,IAAI,CAACA,IAAI,GAAGgJ,MAAM;WACxBvI,EAAE,EAAE,IAAI,CAACT,IAAI,GAAGgJ;;;;QAIjB,CAAC,CAACG,IAAI,CAAC,CAAC;SAAE1K;QAAM,KAAK,IAAI,CAACoC,eAAe,CAACuI,MAAM,CAAC3K,IAAI,CAAC4K,OAAO,EAAE5K,IAAI,CAAC6K,aAAa,CAAC,CAAC;MACpF;KACDC,cAAc,CAAC9K,IAAmB,EAClC;OACC,IAAI,CAACA,IAAI,IAAI,CAACA,IAAI,CAAC+K,QAAQ,EAC3B;SACC;;OAGD,IAAI,CAACxJ,IAAI,GAAGvB,IAAI,CAAC+K,QAAQ,CAACrJ,OAAO,EAAE,GAAG,IAAI;;IAE3C;GACDzB,QAAQ,EAAG;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;CAoIZ,CAAC;;OC/lBY+K,IAAI,GAAG;GACnB9L,KAAK,EAAE;KACNkC,MAAM,EAAE;OACPhC,IAAI,EAAEiC,MAAM;OACZ7B,OAAO,EAAE;;IAEV;GAEDQ,IAAI,GACJ;KACC,MAAMiL,aAAa,GAAG,IAAI,CAAC7J,MAAM,CAAC6J,aAAa,IAAI,EAAE;KAErD,OAAO;OACN9L,EAAE,EAAE,IAAI,CAAC8C,KAAK,EAAE;OAChBgJ;MACA;IACD;GAEDrG,OAAO,GACP;KACC,MAAMsG,gBAAgB,GAAG,EAAE;KAE3B,IAAI,CAACD,aAAa,CAACE,OAAO,CAACC,IAAI,IAAIF,gBAAgB,CAACG,IAAI,CAAC,CAAC,eAAe,EAAED,IAAI,CAAC,CAAC,CAAC;KAElF,IAAI,CAACE,YAAY,GAAG,IAAIC,8BAAW,CAAC;OACnCC,YAAY,EAAE,MAAM;OACpBC,aAAa,EAAE;SACdrG,MAAM,EAAE,GAAG;SACXsG,YAAY,EAAE,IAAI;SAClBC,WAAW,EAAE,KAAK;SAClBC,YAAY,EAAE,KAAK;SACnBV,gBAAgB,EAAEA,gBAAgB;SAClCW,QAAQ,EAAE,CAAC;WACV1M,EAAE,EAAE;UACJ,CAAC;SACF2M,MAAM,EAAE;WACP,eAAe,EAAE,MAAM;aACtB,IAAI,CAACC,oBAAoB,EAAE;YAC3B;WACD,iBAAiB,EAAE,MAAM;aACxB,IAAI,CAACA,oBAAoB,EAAE;;;;MAI9B,CAAC;KAEF,IAAI,CAACT,YAAY,CAACU,QAAQ,CAAC,IAAI,CAACjH,KAAK,CAACkH,OAAO,CAAC;KAE9C,IAAI,CAACpG,kBAAkB,EAAE;IACzB;GAEDD,SAAS,GACT;KACC,IAAI,CAACC,kBAAkB,CAAC,KAAK,CAAC;IAC9B;GAEDjG,KAAK,EAAE;KACNqL,aAAa,GACb;OACC,IAAI,CAACpF,kBAAkB,EAAE;;IAE1B;GAEDxF,OAAO,EAAE;KACR4B,KAAK,GACL;OACC,OAAO,MAAM;MACb;KAED8J,oBAAoB,GACpB;OACC,IAAI,IAAI,CAACT,YAAY,EACrB;SACC,IAAI,CAACL,aAAa,GAAG,IAAI,CAACK,YAAY,CAACY,SAAS,EAAE,CAACC,gBAAgB,EAAE,CAACC,GAAG,CAAChB,IAAI,IAAIA,IAAI,CAACjM,EAAE,CAAC;;MAE3F;KAED0G,kBAAkB,CAAC1F,MAAe,GAAG,IAAI,EACzC;OACC,IAAI,CAAC4G,OAAO,CAACC,YAAY,CAACC,IAAI,CAACC,iCAAM,CAACC,qBAAqB,EAAE,IAAI,CAACN,YAAY,CAAC1G,MAAM,CAAC,CAAC;MACvF;KAED0G,YAAY,CAAC1G,MAAe,GAAG,IAAI,EACnC;OACC,IAAI,CAACmL,YAAY,CAACY,SAAS,EAAE,CAACC,gBAAgB,EAAE,CAACC,GAAG,CAAChB,IAAI,IAAIA,IAAI,CAACjM,EAAE,CAAC;OAErE,OAAO;SACNA,EAAE,EAAE,IAAI,CAACA,EAAE;SACX8L,aAAa,EAAE,IAAI,CAACA,aAAa;SACjC9K;QACA;MACD;KAED2K,cAAc,CAAC9K,IAAmB,EAClC;IAEA;GAEDC,QAAQ,EAAG;;;;;CAKZ,CAAC;;CCtGM,MAAMoM,OAAO,GAAG;GACtBlL,UAAU,EAAE;qBACXmL,OAAc;4BACdC,QAAqB;wBACrBC;IACA;GACDtN,KAAK,EAAE;KACNuN,wBAAwB,EAAE;OACzBrN,IAAI,EAAEsN,QAAQ;OACdpN,QAAQ,EAAE;MACV;KACDqN,4BAA4B,EAAE;OAC7BvN,IAAI,EAAEsN;MACN;KACDE,QAAQ,EAAE;OACTxN,IAAI,EAAEyN,KAAK;OACXvN,QAAQ,EAAE;;IAEX;GAEDU,IAAI,GAAG;KACN,OAAO;OACN8M,QAAQ,EAAE,IAAIC,GAAG;MACjB;IACD;GAED1K,QAAQ,EAAE;KACT2K,iBAAiB,GACjB;OACC,MAAMC,MAAM,GAAG,EAAE;OACjB,IAAI,CAACL,QAAQ,CAACzB,OAAO,CAAC+B,OAAO,IAAI;SAChCD,MAAM,CAACC,OAAO,CAAC/N,EAAE,CAAC,GAAGO,OAAO,CAACwN,OAAO,CAAC/M,MAAM,CAAC;QAC5C,CAAC;OAEF,OAAO8M,MAAM;;IAEd;GAED5M,OAAO,EAAE;KACR8M,eAAe,CAAChO,EAAU,EAC1B;OACCA,EAAE,GAAGA,EAAE,CAAC0I,WAAW,EAAE;OAErB,MAAMuF,WAAW,GAAG,mCAAmC;OACvD,MAAMxF,IAAI,GAAI,GAAEwF,WAAY,IAAGjO,EAAG,EAAC;OAEnC,OAAO,IAAI,CAAC4H,OAAO,CAACe,GAAG,CAACC,UAAU,CAACH,IAAI,CAAC,IAAI,IAAI,CAACb,OAAO,CAACe,GAAG,CAACC,UAAU,CAACqF,WAAW,CAAC;MACpF;KAEDC,gBAAgB,CAACC,kBAA2B,EAC5C;OACC,IAAIC,cAAI,CAACC,SAAS,CAACF,kBAAkB,CAAC,EACtC;SACC,OAAOA,kBAAkB;;OAG1B,OAAO,IAAI;MACX;KAEDG,eAAe,GACf;OACC,KAAK,MAAMC,WAAW,IAAI,IAAI,CAACV,iBAAiB,EAChD;SACC,IAAI,CAAC,IAAI,CAACA,iBAAiB,CAACU,WAAW,CAAC,EACxC;WACC;;SAGD,MAAMR,OAAO,GAAG,IAAI,CAACN,QAAQ,CAACe,IAAI,CAACT,OAAO,IAAIA,OAAO,CAAC/N,EAAE,KAAKuO,WAAW,CAAC;SACzE,IAAI,CAACR,OAAO,EACZ;WACC;;SAGD,MAAMlN,IAAI,GAAG;WACZb,EAAE,EAAE+N,OAAO,CAAC/N,EAAE;WACd,GAAG+N,OAAO,CAAC9L;UACX;SAED,IAAI,CAAC0L,QAAQ,CAAC9J,GAAG,CAAC0K,WAAW,EAAE1N,IAAI,CAAC;;MAErC;KAED4N,gBAAgB,CAAC;OAAE5N;MAAM,EACzB;OACC,IAAIA,IAAI,CAACb,EAAE,EACX;SACC,IAAIa,IAAI,CAACG,MAAM,EACf;WACC,IAAI,CAAC2M,QAAQ,CAAC9J,GAAG,CAAChD,IAAI,CAACb,EAAE,EAAEa,IAAI,CAAC;UAChC,MAED;WACC,IAAI,CAAC8M,QAAQ,CAACe,MAAM,CAAC7N,IAAI,CAACb,EAAE,CAAC;;;OAI/B,IAAI,IAAI,CAACsN,wBAAwB,EACjC;SACC,IAAI,CAACA,wBAAwB,CAAC,IAAI,CAAC5F,YAAY,EAAE,CAAC;;MAEnD;KAEDiH,oBAAoB,CAAC;OAAE9N;MAAM,EAC7B;OACC,IAAI,IAAI,CAACyM,wBAAwB,EACjC;SACC,IAAI,CAACE,4BAA4B,CAAC3M,IAAI,CAAC;;MAExC;KAED6G,YAAY,GACZ;OACC,MAAMiG,QAAQ,GAAGzL,MAAM,CAAC0M,WAAW,CAAC,IAAI,CAACjB,QAAQ,CAAC;OAElD,IAAIG,MAAM,GAAG,EAAE;OAEf,KAAK,MAAM9N,EAAE,IAAI,IAAI,CAAC6N,iBAAiB,EACvC;SACC,IAAI,IAAI,CAACA,iBAAiB,CAAC7N,EAAE,CAAC,IAAI2N,QAAQ,CAAC3N,EAAE,CAAC,EAC9C;WACC8N,MAAM,CAAC9N,EAAE,CAAC,GAAG2N,QAAQ,CAAC3N,EAAE,CAAC;;;OAI3B,OAAO8N,MAAM;MACb;KAEDe,uBAAuB,CAAC;OAAE7O,EAAE;OAAEY;MAAU,EACxC;OACC,IAAI,IAAI,CAACiN,iBAAiB,CAACiB,cAAc,CAAC9O,EAAE,CAAC,EAC7C;SACC,IAAI,CAAC6N,iBAAiB,CAAC7N,EAAE,CAAC,GAAGY,QAAQ;;MAEtC;KAED+K,cAAc,CAAC9K,IAAY,EAC3B;OACC,IAAI,CAAC4M,QAAQ,CAACzB,OAAO,CAAC+B,OAAO,IAAI;SAChC,IAAI,IAAI,CAACnI,KAAK,CAAC,UAAU,GAAGmI,OAAO,CAAC/N,EAAE,CAAC,IAAI,IAAI,CAAC4F,KAAK,CAAC,UAAU,GAAGmI,OAAO,CAAC/N,EAAE,CAAC,CAAC,CAAC,CAAC,EACjF;WACC,IAAI,CAAC4F,KAAK,CAAC,UAAU,GAAGmI,OAAO,CAAC/N,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC2L,cAAc,CAAC9K,IAAI,CAAC;;QAE5D,CAAC;;IAEH;GAED4E,OAAO,GACP;KACC,IAAI,CAAC6I,eAAe,EAAE;KACtB,IAAI,CAAC1G,OAAO,CAACC,YAAY,CAAC1B,SAAS,CAAC4B,iCAAM,CAACC,qBAAqB,EAAE,IAAI,CAACyG,gBAAgB,CAAC;KACxF,IAAI,CAAC7G,OAAO,CAACC,YAAY,CAAC1B,SAAS,CAAC4B,iCAAM,CAACE,yBAAyB,EAAE,IAAI,CAAC0G,oBAAoB,CAAC;IAChG;GAEDI,aAAa,GACb;KACC,IAAI,CAACnH,OAAO,CAACC,YAAY,CAACmH,WAAW,CAACjH,iCAAM,CAACC,qBAAqB,EAAE,IAAI,CAACyG,gBAAgB,CAAC;KAC1F,IAAI,CAAC7G,OAAO,CAACC,YAAY,CAACmH,WAAW,CAACjH,iCAAM,CAACE,yBAAyB,EAAE,IAAI,CAAC0G,oBAAoB,CAAC;IAClG;GAED7N,QAAQ,EAAG;;;;;;;;;;;;;;;;;;CAkBZ,CAAC;;;;ACzLD,CAcA,MAAMmO,cAAc,GAAG,MAAM;CAC7B,MAAMC,gBAAgB,GAAG,QAAQ;AAEjC,OAAMnH,MAAM,GAAG;GACdC,qBAAqB,EAAE,oCAAoC;GAC3DC,yBAAyB,EAAE;CAC5B,CAAC;CAAC;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAEF,MAAMkH,aAAa,CACnB;GAcCC,WAAW,CAACC,OAA6B,EACzC;KAAA;OAAA;;KAAA;OAAA;;KAAA;OAAA;;KAAA;OAAA;;KAAA;OAAA;;KAAA;OAAA;;KAAA;OAAA;;KAAA;OAAA;;KAAA,KAdAC,SAAS,GAAgB,IAAI;KAAA,KAC7BC,SAAS,GAAG,IAAI;KAAA,KAChBC,eAAe,GAAG,IAAI;KAAA,KACtBC,KAAK,GAAW,IAAI;KAAA;OAAA;OAAA,OACW;;KAAI;OAAA;OAAA,OACd;;KAAI;OAAA;OAAA,OACK;;KAAE;OAAA;OAAA,OACF;;KAAI;OAAA;OAAA,OACV;;KAAI;OAAA;OAAA,OACR;;KAAI;OAAA;OAAA,OACT;;KAAI;OAAA;OAAA,OACS;;KAI3B,4CAAI,0CAAqBJ,OAAO,CAAC5B,QAAQ,IAAI,EAAE;KAC/C,4CAAI,4CAAsB4B,OAAO,CAACK,iBAAiB,IAAI,IAAI;KAC3D,4CAAI,gCAAgBL,OAAO,CAACM,WAAW,IAAI,IAAI;KAC/C,4CAAI,wBAAYN,OAAO,CAACO,OAAO,IAAI,IAAI;KACvC,4CAAI,cAAOP,OAAO,CAACrP,EAAE,IAAI,IAAI;KAC7B,4CAAI,0CAAqBqP,OAAO,CAACZ,gBAAgB,IAAI,IAAI;KACzD,4CAAI,wCAAoBY,OAAO,CAAC1B,QAAQ,IAAI,IAAI;KAEhD,IAAI0B,OAAO,CAACQ,MAAM,EAClB;OACC,4CAAI,sBAAWR,OAAO,CAACQ,MAAM;;;GAY/BvJ,IAAI,GACJ;KACC,IAAI,CAAC,IAAI,CAACmJ,KAAK,IAAI,IAAI,CAACA,KAAK,CAACK,WAAW,EAAE,EAC3C;OACC,MAAMC,UAAU,GAAGC,gBAAgB,CAACC,QAAQ,CAACC,eAAe,CAAC;OAC7D,MAAMC,YAAY,GAAGJ,UAAU,CAACK,gBAAgB,CAAC,qBAAqB,CAAC;OACvE,MAAMC,uBAAuB,GAAGC,UAAU,CAACH,YAAY,CAAC,IAAI,EAAE;OAC9D,MAAMI,iBAAiB,GAAGR,UAAU,CAACK,gBAAgB,CAAC,uBAAuB,CAAC,IAAI,SAAS;OAE3F,MAAMI,OAAO,GAAGC,aAAG,CAACC,MAAM,cAAC;;iDAEiB,CAAwB;;;IAGpE,2CAH8C,IAAI,oCAGjD;OAED,IAAI,CAACjB,KAAK,GAAG,IAAIkB,gBAAK,CAAC;SACtBC,SAAS,EAAE,IAAI;SACfC,UAAU,EAAE,IAAI;SAChBC,OAAO,EAAET,uBAAuB;SAChCU,OAAO,EAAE;WACRC,OAAO,EAAE,EAAE;WACXC,eAAe,EAAEV;UACjB;SACDC,OAAO;SACPU,OAAO,0CAAE,IAAI,uCAAmB;SAChCnL,QAAQ,EAAE,GAAG;SACbG,KAAK,EAAE,GAAG;SACViL,SAAS,EAAE;QACX,CAAC;OAEF,IAAI,CAAC1B,KAAK,CAAC2B,aAAa,CAAC,aAAa,EAAE,MAAM;SAC7C,IAAI,CAACC,YAAY,EAAE,CACjB9F,IAAI,CACJ,MAAM;WACL,4CAAI;WACJ,IAAI,CAACkE,KAAK,CAAC6B,cAAc,EAAE;UAC3B,EACD,MAAM;WACLC,kBAAE,CAACC,YAAY,CAACC,MAAM,CAACC,MAAM,CAAC;aAC7BlB,OAAO,EAAE7H,aAAG,CAACC,UAAU,CAAC,0BAA0B,CAAC;aACnD+I,aAAa,EAAE;YACf,CAAC;UACF,CACD;QACF,CAAC;OAEF,IAAI,CAAClC,KAAK,CAACtJ,SAAS,CAAC,SAAS,EAAE,4CAAI,8CAAsBE,IAAI,CAAC,IAAI,CAAC,CAAC;;KAGtE,IAAI,CAACoJ,KAAK,CAACnJ,IAAI,EAAE;;GAgBlB+K,YAAY,GACZ;KACC,IAAI,yCAAC,IAAI,yCAAmB,EAC5B;OACC,OAAOO,OAAO,CAACC,OAAO,EAAE;;KAGzB,MAAMhR,IAAI,GAAG;OACZb,EAAE,0CAAE,IAAI,WAAI;OACZ2P,WAAW,0CAAE,IAAI,6BAAa;OAC9BC,OAAO,0CAAE,IAAI;MACb;KAED,OAAO,IAAIgC,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;OACvCzG,cAAI,CACFC,SAAS,yCAAC,IAAI,2CAAqB;SAAEzK;QAAM,CAAC,CAC5C0K,IAAI,CAAC,CAAC;SAAE1K;QAAM,KAAK;SACnBA,IAAI,CAACmL,OAAO,CAACC,IAAI,IAAI;WACpB,MAAM8B,OAAO,GAAG,4CAAI,wCAAmBS,IAAI,CAACuD,eAAe,IAAIA,eAAe,CAAC/R,EAAE,KAAKiM,IAAI,CAACjM,EAAE,CAAC;WAC9F,IAAI,CAAC+N,OAAO,EACZ;aACC;;WAGDA,OAAO,CAAC/M,MAAM,GAAGiL,IAAI,CAACjL,MAAM;WAC5B+M,OAAO,CAAC9L,MAAM,GAAGgK,IAAI,CAAC0B,QAAQ;UAC9B,CAAC;SAEFkE,OAAO,EAAE;QACT,CAAC,CACDG,KAAK,CAACF,MAAM,CAAC;MAEf,CAAC;;GA+BHG,IAAI,GACJ;KACC,4CAAI,wCAAoB,IAAI,CAACC,WAAW,EAAE;KAE1C,4CAAI,IAAI,yCACR;OACC,4CAAI,wCAAmB,IAAI,CAACA,WAAW,EAAE;;KAG1C,4CAAI;KAEJ,4CAAI,IAAI,qBACR;OACC,4CAAI,4DAAS,IAAI,uEAAe,IAAI,+DAAW,IAAI,aAAM,IAAI,CAACA,WAAW,EAAE;;;GAgD7EA,WAAW,GACX;KAAA;KACC,gCAAO,IAAI,CAAC1C,eAAe,qBAApB,sBAAsB9H,YAAY,EAAE;;GAG5CyK,YAAY,CAACtR,IAAmB,GAAG,IAAI,EACvC;KACC,IAAIA,IAAI,IAAI,IAAI,CAAC2O,eAAe,EAChC;OACC,IAAI,CAACA,eAAe,CAAC7D,cAAc,CAAC9K,IAAI,CAAC;;;CAG5C;CAAC,gCAlNsBA,IAAI,EAC1B;GACC,IAAI,IAAI,CAAC4O,KAAK,EACd;KACC,IAAI,CAACA,KAAK,CAACyB,OAAO,CAAC,CAAC,CAAC,CAACkB,WAAW,CAAC,CAACvR,IAAI,CAACqH,OAAO,CAAC;;CAElD;CAAC,6BAwDD;GACC,IAAI,CAACoH,SAAS,GAAG,IAAI,CAACG,KAAK,CACzB4C,mBAAmB,EAAE,CACrBC,sBAAsB,CAAC,qCAAqC,CAAC,CAC7DrG,IAAI,CAAC,CAAC,CAAC;GAGT,4CAAI;GAEJ,OAAO,IAAI,CAACuD,eAAe;CAC5B;CAAC,2BAsCD;GACC,OAAO7G,aAAG,CAACC,UAAU,CAAC,0BAA0B,CAAC;CAClD;CAAC,6BAGD;GACC,OAAO,CACN,IAAI2J,qBAAU,CAAC;KACdvS,EAAE,EAAEiP,cAAc;KAClBxM,KAAK,EAAE,IAAI;KACX+P,KAAK,EAAEC,sBAAW,CAACC,MAAM;KACzB/F,MAAM,EAAE;OACPgG,KAAK,EAAE,IAAI,CAACV,IAAI,CAAC5L,IAAI,CAAC,IAAI;;IAE3B,CAAC,EACF,IAAIuM,uBAAY,CAAC;KAChB5S,EAAE,EAAEkP,gBAAgB;KACpBzM,KAAK,EAAE,IAAI;KACXkK,MAAM,EAAE;OACPgG,KAAK,EAAE,4CAAI,oBAAStM,IAAI,CAAC,IAAI;MAC7B;KACDwM,IAAI,EAAElK,aAAG,CAACC,UAAU,CAAC,2BAA2B,CAAC;KACjDkK,KAAK,EAAEC,sBAAW,CAACC;IACnB,CAAC,CACF;CACF;CAAC,oBAoBD;GACC,4CAAI;GACJ,4CAAI;CACL;CAAC,iCAGD;GACC,IAAI,IAAI,CAACzD,SAAS,IAAI,IAAI,CAACC,eAAe,EAC1C;KACC,IAAI,CAACD,SAAS,CAAC0D,OAAO,CAAC,IAAI,CAAC3D,SAAS,CAAC;;GAGvC,4CAAI,IAAI,uCACR;KACC,4CAAI,wCAAmBtD,OAAO,CAAC+B,OAAO,IAAI;OACzC,IAAI,4CAAI,sCAAkBA,OAAO,CAAC/N,EAAE,CAAC,EACrC;SACC+N,OAAO,CAAC/M,MAAM,GAAG,IAAI;SACrB+M,OAAO,CAAC9L,MAAM,GAAG,4CAAI,sCAAkB8L,OAAO,CAAC/N,EAAE,CAAC;;MAEnD,CAAC;;GAGH,IAAI,CAACuP,SAAS,GAAG2D,iBAAS,CAACC,SAAS,CAACC,OAAoB,EAAE;KAC1D9F,wBAAwB,EAAE,4CAAI,8BAAcjH,IAAI,CAAC,IAAI,CAAC;KACtDmH,4BAA4B,EAAE,4CAAI,gDAAuBnH,IAAI,CAAC,IAAI,CAAC;KACnEoH,QAAQ,0CAAE,IAAI;IACd,CAAC;GAEF,IAAI,CAAC+B,eAAe,GAAG,IAAI,CAACD,SAAS,CAAC8D,KAAK,CAAC,IAAI,CAAC/D,SAAS,CAAC;CAC5D;CAAC,yBAGD;GACC,IAAI,CAACG,KAAK,CAAC6B,cAAc,EAAE;GAC3B,IAAI,CAAC7B,KAAK,CAACyB,OAAO,CAAC,CAAC,CAAC,CAACkB,WAAW,CAAC,KAAK,CAAC;CACzC;CAAC,wBAGD;GAAA;GACC,mBAAI,CAAC3C,KAAK,qBAAV,YAAY6D,KAAK,EAAE;CACpB;;;;;;;;;;;"}