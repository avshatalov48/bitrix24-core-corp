this.BX=this.BX||{},this.BX.Crm=this.BX.Crm||{},function(e,s,t,i,a,r){"use strict";var l,o=babelHelpers.classPrivateFieldLooseKey("prepareDisableSemanticButton"),n=babelHelpers.classPrivateFieldLooseKey("getCurrentStage"),c=babelHelpers.classPrivateFieldLooseKey("getCurrentStatusId"),u=babelHelpers.classPrivateFieldLooseKey("getStage"),p=babelHelpers.classPrivateFieldLooseKey("isHasPermissionToMove"),b=babelHelpers.classPrivateFieldLooseKey("isHasPermissionToMoveAtLeastOneTerminationStage"),h=babelHelpers.classPrivateFieldLooseKey("isHasPermissionToMoveSuccessStage"),d=babelHelpers.classPrivateFieldLooseKey("isHasPermissionToMoveAtLeastOneFailureStages"),g=babelHelpers.classPrivateFieldLooseKey("isDisableStageFlow"),P=babelHelpers.classPrivateFieldLooseKey("adjust"),v=babelHelpers.classPrivateFieldLooseKey("adjustDisableStages"),F=babelHelpers.classPrivateFieldLooseKey("adjustSemanticsSelectorPopupButtons");class S extends(l=t.StageFlow.Chart){constructor(e,s,t,i,a=!1){super(e,s),Object.defineProperty(this,F,{value:j}),Object.defineProperty(this,v,{value:O}),Object.defineProperty(this,P,{value:M}),Object.defineProperty(this,g,{value:I}),Object.defineProperty(this,d,{value:k}),Object.defineProperty(this,h,{value:y}),Object.defineProperty(this,b,{value:f}),Object.defineProperty(this,p,{value:C}),Object.defineProperty(this,u,{value:L}),Object.defineProperty(this,c,{value:B}),Object.defineProperty(this,n,{value:H}),Object.defineProperty(this,o,{value:m}),this.isNewItem=!1,this.permissionChecker=t,this.getStageModelCallback=i,this.isNewItem=a,this.isNewItem||babelHelpers.classPrivateFieldLooseBase(this,v)[v]()}onStageMouseHover(e){this.increaseStageWidthForNameVisibility(e),e.isDisabled()||super.onStageMouseHover(e)}onStageClick(e){babelHelpers.classPrivateFieldLooseBase(this,p)[p](e.getId())?super.onStageClick(e):this.permissionChecker.showMissPermissionError()}onFinalStageClick(e){babelHelpers.classPrivateFieldLooseBase(this,b)[b]()?super.onFinalStageClick(e):this.permissionChecker.showMissPermissionError()}setCurrentStageId(e){return super.setCurrentStageId(e),babelHelpers.classPrivateFieldLooseBase(this,P)[P](),this}getSemanticPopupSuccessButton(){const e=super.getSemanticPopupSuccessButton();return babelHelpers.classPrivateFieldLooseBase(this,h)[h]()||babelHelpers.classPrivateFieldLooseBase(this,o)[o](e),e}getSemanticPopupFailureButton(){const e=super.getSemanticPopupFailureButton();return null===e?null:(babelHelpers.classPrivateFieldLooseBase(this,d)[d]()||babelHelpers.classPrivateFieldLooseBase(this,o)[o](e),e)}getFinalStagePopupFailStage(e){const t=super.getFinalStagePopupFailStage(e);return babelHelpers.classPrivateFieldLooseBase(this,p)[p](e.getId())||(t.onclick=e=>{e.preventDefault(),this.permissionChecker.showMissPermissionError()},s.Dom.addClass(t,"--disabled")),t}setCheckedStageInFailStagesWrapper(e){const t=[...this.extractFinalStagePopupFailStages(e)].map(e=>e.querySelector("input")),i=this.getFirstFailStage();if(!i)return;const a=t.find(e=>{var t;const a=null==e||null==(t=e.dataset)?void 0:t.stageId;return!!a&&i.getId()===s.Text.toInteger(a)});a&&(a.checked=!0)}getFirstFailStage(){return[...this.stages.values()].find(e=>e.isFail()&&babelHelpers.classPrivateFieldLooseBase(this,p)[p](e.getId()))}getFirstFailStageName(){var e;return null==(e=super.getFirstFailStage())?void 0:e.getName()}}function m(e){e.setDisabled().setProps({disabled:null}).bindEvent("click",this.permissionChecker.showMissPermissionError)}function H(){return this.getStageModelCallback(this.currentStage)}function B(){var e;return null==(e=babelHelpers.classPrivateFieldLooseBase(this,n)[n]())?void 0:e.getStatusId()}function L(e){return this.getStageModelCallback(e)}function C(e){const s=babelHelpers.classPrivateFieldLooseBase(this,u)[u](e);return!!s&&this.permissionChecker.isHasPermissionToMove(babelHelpers.classPrivateFieldLooseBase(this,c)[c](),s.getStatusId())}function f(){return this.permissionChecker.isHasPermissionToMoveAtLeastOneTerminationStage(babelHelpers.classPrivateFieldLooseBase(this,c)[c]())}function y(){return this.permissionChecker.isHasPermissionToMoveSuccessStage(babelHelpers.classPrivateFieldLooseBase(this,c)[c]())}function k(){return this.permissionChecker.isHasPermissionToMoveAtLeastOneFailureStage(babelHelpers.classPrivateFieldLooseBase(this,c)[c]())}function I(e){return!e.isFinal()&&(e===this.getFinalStage()?!babelHelpers.classPrivateFieldLooseBase(this,b)[b]():!babelHelpers.classPrivateFieldLooseBase(this,p)[p](e.getId()))}function M(){babelHelpers.classPrivateFieldLooseBase(this,v)[v](),babelHelpers.classPrivateFieldLooseBase(this,F)[F]()}function O(){this.stages.forEach(e=>{e.setDisable(babelHelpers.classPrivateFieldLooseBase(this,g)[g](e))})}function j(){l.prototype.getSemanticSelectorPopup.call(this).setButtons([this.getSemanticPopupSuccessButton(),this.getSemanticPopupFailureButton()])}e.Chart=S}(this.BX.Crm.ItemDetailsComponent=this.BX.Crm.ItemDetailsComponent||{},BX,BX.UI,BX.UI,BX.Crm.Stage,BX.Crm.Models);
//# sourceMappingURL=index.bundle.js.map
