{"version":3,"file":"tour-manager.bundle.js","sources":["../src/queue.js","../src/tour-manager.js"],"sourcesContent":["import { TourInterface } from './tour.js';\n\nexport default class Queue\n{\n\t#stack: Map<string, TourInterface> = new Map();\n\n\tget(id: string): TourInterface | null\n\t{\n\t\treturn this.#stack.get(id) ?? null;\n\t}\n\n\tpush(tour: TourInterface): void\n\t{\n\t\tthis.#stack.set(tour.getGuide().getId(), tour);\n\t}\n\n\tpop(): TourInterface | null\n\t{\n\t\tconst lastTour = [...this.#stack.values()].pop();\n\t\tif (!lastTour)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tthis.delete(lastTour.getGuide().getId());\n\n\t\treturn lastTour;\n\t}\n\n\tpeek(): TourInterface | null\n\t{\n\t\tconst [firstTour] = this.#stack.values();\n\t\tif (!firstTour)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tthis.delete(firstTour.getGuide().getId());\n\n\t\treturn firstTour;\n\t}\n\n\tdelete(id: string): boolean\n\t{\n\t\treturn this.#stack.delete(id);\n\t}\n\n\tsize(): number\n\t{\n\t\treturn this.#stack.size();\n\t}\n}\n","import { TourInterface } from './tour.js';\nimport Queue from './queue.js';\n\nexport class TourManager\n{\n\tstatic TOUR_FINISH_EVENT = 'UI.Tour.Guide:onFinish';\n\n\tstatic instance: ?TourManager = null;\n\t#queue: Queue = new Queue();\n\t#current: ?TourInterface = null;\n\n\tstatic getInstance(): TourManager\n\t{\n\t\tif (!TourManager.instance)\n\t\t{\n\t\t\tTourManager.instance = new TourManager();\n\t\t}\n\n\t\treturn TourManager.instance;\n\t}\n\n\tregisterWithLaunch(tour: TourInterface): void\n\t{\n\t\tthis.register(tour);\n\t\tthis.launch();\n\t}\n\n\tlaunch(): void\n\t{\n\t\tif (this.#current)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#current = this.#queue.peek();\n\t\tthis.#current?.show();\n\t}\n\n\tregister(tour: TourInterface): void\n\t{\n\t\tif (!tour.canShow())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#queue.push(tour);\n\t\tthis.#subscribeTourFinish(tour);\n\t}\n\n\t#subscribeTourFinish(tour: TourInterface): void\n\t{\n\t\ttour.getGuide().subscribe(TourManager.TOUR_FINISH_EVENT, this.showNextTour.bind(this));\n\t}\n\n\tshowNextTour(): void\n\t{\n\t\tconst nextTour = this.#queue.peek();\n\t\tif (!nextTour)\n\t\t{\n\t\t\tthis.#current = null;\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#current = nextTour;\n\t\tthis.#current.show();\n\t}\n}\n"],"names":["Queue","[object Object]","Object","writable","value","Map","get","id","babelHelpers","push","tour","set","getGuide","getId","pop","lastTour","values","this","delete","peek","firstTour","size","TourManager","instance","registerWithLaunch","register","launch","_babelHelpers$classPr","show","canShow","showNextTour","nextTour","subscribe","TOUR_FINISH_EVENT","bind"],"mappings":"+CAA0C,sDAE3B,MAAMA,EACrBC,cAAAC,8BAAAC,YAAAC,MACsC,IAAIC,MAEzCC,IAAIC,GACJ,MACC,gBAAOC,mDAAYF,IAAIC,MAAO,KAG/BE,KAAKC,GAEJF,mDAAYG,IAAID,EAAKE,WAAWC,QAASH,GAG1CI,MAEC,MAAMC,EAAW,IAAIP,mDAAYQ,UAAUF,MAC3C,OAAKC,GAKLE,KAAKC,OAAOH,EAASH,WAAWC,SAEzBE,GALC,KAQTI,OAEC,MAAOC,GAAaZ,mDAAYQ,SAChC,OAAKI,GAKLH,KAAKC,OAAOE,EAAUR,WAAWC,SAE1BO,GALC,KAQTF,OAAOX,GAEN,OAAOC,mDAAYU,OAAOX,GAG3Bc,OAEC,OAAOb,mDAAYa,kLC9Cd,MAAMC,EACbrB,cAAAC,8BAAAE,UAAAF,8BAAAC,YAAAC,MAIiB,IAAIJ,IAAOE,8BAAAC,YAAAC,MACA,OAE3BH,qBAOC,OALKqB,EAAYC,WAEhBD,EAAYC,SAAW,IAAID,GAGrBA,EAAYC,SAGpBC,mBAAmBd,GAElBO,KAAKQ,SAASf,GACdO,KAAKS,SAGNA,SACA,8CACKT,aAKJT,mDAAgBA,mDAAYW,qEAC5BQ,EAAeC,QAGhBH,SAASf,GAEHA,EAAKmB,YAKVrB,mDAAYC,KAAKC,GACjBF,mDAA0BE,IAQ3BoB,eAEC,MAAMC,EAAWvB,mDAAYW,OACxBY,GAOLvB,mDAAgBuB,EAChBvB,mDAAcoB,QANbpB,mDAAgB,MAQlB,WAlBqBE,GAEpBA,EAAKE,WAAWoB,UAAUV,EAAYW,kBAAmBhB,KAAKa,aAAaI,KAAKjB,OAhDrEK,EAELW,kBAAoB,yBAFfX,EAILC,SAAyB"}