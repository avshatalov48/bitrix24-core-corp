this.BX=this.BX||{};(function(e,t,n,i,a,o){"use strict";var r=function(){function e(){babelHelpers.classCallCheck(this,e)}babelHelpers.createClass(e,null,[{key:"getRealizationDocumentDetailUrl",value:function e(t){return new a.Uri("/shop/documents/details/sales_order/"+t+"/")}},{key:"openRealizationDetailDocument",value:function t(n){var i=e.getRealizationDocumentDetailUrl(n);return BX.SidePanel.Instance.open(i.toString())}}]);return e}();var s=function(){function e(t){babelHelpers.classCallCheck(this,e);this.gridId=t.gridId;this.filterId=t.filterId;this.grid=BX.Main.gridManager.getInstanceById(this.gridId);this.isConductDisabled=t.isConductDisabled;this.masterSliderUrl=t.masterSliderUrl;this.inventoryManagementSource=t.inventoryManagementSource;this.isInventoryManagementDisabled=t.isInventoryManagementDisabled;this.inventoryManagementFeatureCode=t.inventoryManagementFeatureCode;window.top.BX.addCustomEvent("onEntityEditorDocumentOrderShipmentControllerDocumentSave",this.reloadGrid.bind(this))}babelHelpers.createClass(e,[{key:"getSelectedIds",value:function e(){return this.grid.getRows().getSelectedIds()}},{key:"deleteDocument",value:function e(t){var n=this;if(this.isInventoryManagementDisabled&&this.inventoryManagementFeatureCode){top.BX.UI.InfoHelper.show(this.inventoryManagementFeatureCode);return}o.MessageBox.confirm(a.Loc.getMessage("DOCUMENT_GRID_DOCUMENT_DELETE_CONTENT"),(function(e,i){i.setWaiting();a.ajax.runAction("crm.api.realizationdocument.setRealization",{data:{id:t,value:"N"},analyticsLabel:{action:"delete",inventoryManagementSource:n.inventoryManagementSource}}).then((function(){e.close();n.reloadGrid()}))["catch"]((function(t){if(t.errors){BX.UI.Notification.Center.notify({content:BX.util.htmlspecialchars(t.errors[0].message)})}e.close()}))}),a.Loc.getMessage("DOCUMENT_GRID_DOCUMENT_DELETE_BUTTON_CONFIRM"),(function(e){return e.close()}),a.Loc.getMessage("DOCUMENT_GRID_BUTTON_BACK"))}},{key:"conductDocument",value:function e(t){var n=this;if(this.isInventoryManagementDisabled&&this.inventoryManagementFeatureCode){top.BX.UI.InfoHelper.show(this.inventoryManagementFeatureCode);return}if(this.isConductDisabled){this.openStoreMasterSlider();return}o.MessageBox.confirm(a.Loc.getMessage("DOCUMENT_GRID_DOCUMENT_CONDUCT_CONTENT"),(function(e,i){i.setWaiting();a.ajax.runAction("crm.api.realizationdocument.setShipped",{data:{id:t,value:"Y"},analyticsLabel:{action:"deduct",inventoryManagementSource:n.inventoryManagementSource}}).then((function(){e.close();n.reloadGrid()}))["catch"]((function(t){if(t.errors){BX.UI.Notification.Center.notify({content:BX.util.htmlspecialchars(t.errors[0].message)})}e.close()}))}),a.Loc.getMessage("DOCUMENT_GRID_DOCUMENT_CONDUCT_BUTTON_CONFIRM"),(function(e){return e.close()}),a.Loc.getMessage("DOCUMENT_GRID_BUTTON_BACK"))}},{key:"cancelDocument",value:function e(t){var n=this;if(this.isInventoryManagementDisabled&&this.inventoryManagementFeatureCode){top.BX.UI.InfoHelper.show(this.inventoryManagementFeatureCode);return}if(this.isConductDisabled){this.openStoreMasterSlider();return}o.MessageBox.confirm(a.Loc.getMessage("DOCUMENT_GRID_DOCUMENT_CANCEL_CONTENT"),(function(e,i){i.setWaiting();a.ajax.runAction("crm.api.realizationdocument.setShipped",{data:{id:t,value:"N"},analyticsLabel:{action:"cancelDeduct",inventoryManagementSource:n.inventoryManagementSource}}).then((function(){e.close();n.reloadGrid()}))["catch"]((function(t){if(t.errors){BX.UI.Notification.Center.notify({content:BX.util.htmlspecialchars(t.errors[0].message)})}e.close()}))}),a.Loc.getMessage("DOCUMENT_GRID_DOCUMENT_CANCEL_BUTTON_CONFIRM"),(function(e){return e.close()}),a.Loc.getMessage("DOCUMENT_GRID_BUTTON_BACK"))}},{key:"deleteSelectedDocuments",value:function e(){var t=this;var n=this.getSelectedIds();a.ajax.runAction("crm.api.realizationdocument.setRealizationList",{data:{ids:n,value:"N"},analyticsLabel:{action:"delete",inventoryManagementSource:this.inventoryManagementSource}}).then((function(e){t.reloadGrid()}))["catch"]((function(e){if(e.errors){e.errors.forEach((function(e){if(e.message){BX.UI.Notification.Center.notify({content:BX.util.htmlspecialchars(e.message)})}}))}t.reloadGrid()}))}},{key:"conductSelectedDocuments",value:function e(){var t=this;if(this.isInventoryManagementDisabled&&this.inventoryManagementFeatureCode){top.BX.UI.InfoHelper.show(this.inventoryManagementFeatureCode);return}if(this.isConductDisabled){this.openStoreMasterSlider();return}var n=this.getSelectedIds();a.ajax.runAction("crm.api.realizationdocument.setShippedList",{data:{ids:n,value:"Y"},analyticsLabel:{inventoryManagementSource:this.inventoryManagementSource,action:"deduct"}}).then((function(e){t.reloadGrid()}))["catch"]((function(e){if(e.errors){e.errors.forEach((function(e){if(e.message){BX.UI.Notification.Center.notify({content:BX.util.htmlspecialchars(e.message)})}}))}t.reloadGrid()}))}},{key:"cancelSelectedDocuments",value:function e(){var t=this;if(this.isInventoryManagementDisabled&&this.inventoryManagementFeatureCode){top.BX.UI.InfoHelper.show(this.inventoryManagementFeatureCode);return}if(this.isConductDisabled){this.openStoreMasterSlider();return}var n=this.getSelectedIds();a.ajax.runAction("crm.api.realizationdocument.setShippedList",{data:{ids:n,value:"N"},analyticsLabel:{inventoryManagementSource:this.inventoryManagementSource,action:"cancelDeduct"}}).then((function(e){t.reloadGrid()}))["catch"]((function(e){if(e.errors){e.errors.forEach((function(e){if(e.message){BX.UI.Notification.Center.notify({content:BX.util.htmlspecialchars(e.message)})}}))}t.reloadGrid()}))}},{key:"applyFilter",value:function e(t){var n=BX.Main.filterManager.getById(this.filterId);if(!n){return}n.getApi().extendFilter(t)}},{key:"processApplyButtonClick",value:function e(){var t=this.grid.getActionsPanel().getValues();var n=t["action_button_".concat(this.gridId)];if(n==="conduct"){this.conductSelectedDocuments()}if(n==="cancel"){this.cancelSelectedDocuments()}}},{key:"openHowToShipProducts",value:function e(){if(top.BX.Helper){top.BX.Helper.show("redirect=detail&code=14640548");event.preventDefault()}}},{key:"openStoreMasterSlider",value:function e(){BX.SidePanel.Instance.open(this.masterSliderUrl,{cacheable:false,data:{openGridOnDone:false},events:{onCloseComplete:function e(t){var n=t.getSlider();if(!n){return}if(n.getData().get("isInventoryManagementEnabled")){document.location.reload()}}}})}},{key:"reloadGrid",value:function e(){this.grid.reload()}}]);return e}();e.StoreDocumentGridManager=s})(this.BX.Crm=this.BX.Crm||{},BX.Main,BX.UI,BX.Event,BX,BX.UI.Dialogs);
//# sourceMappingURL=store-document-grid-manager.bundle.map.js