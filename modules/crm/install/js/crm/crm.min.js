if(typeof obCrm==="undefined"){obCrm={}}CRM=function(e,t,n,o,i,c,p,s,r,a,l){this.crmID=e;this.div=t;this.el=n;this.name=o;this.PopupEntityType=s;this.PopupEntityTypeAbbr=[];this.PopupTabs={};this.PopupElement=i;this.PopupPrefix=c;this.PopupMultiple=p;this.PopupBlock={};this.PopupSearch={};this.PopupSearchInput=null;this.PopupCustomSearchHandler=null;this.PopupTabsIndex=0;this.PopupTabsIndexId="";this.PopupLocalize=r;this.popup=null;this.onSaveListeners=[];this.disableMarkup=!!a;this.onBeforeSearchListeners=[];this.options={requireRequisiteData:false,searchOptions:{}};if(l&&typeof l==="object"){if(!!l["requireRequisiteData"])this.options.requireRequisiteData=true;if(BX.type.isPlainObject(l["searchOptions"])){this.options.searchOptions=l["searchOptions"]}if(BX.Type.isArray(l["entityTypeAbbr"])){for(let e in l["entityTypeAbbr"]){if(l["entityTypeAbbr"].hasOwnProperty(e)&&BX.Type.isStringFilled(l["entityTypeAbbr"][e])&&l["entityTypeAbbr"][e].length<20){this.PopupEntityTypeAbbr[e]=l["entityTypeAbbr"][e]}}}if(l.hasOwnProperty("customSearchHandler")&&BX.Type.isFunction(l["customSearchHandler"])){this.PopupCustomSearchHandler=l["customSearchHandler"]}}};CRM.prototype.Init=function(){let e;this.popupShowMarkup();this.PopupTabs=BX.findChildren(BX("crm-"+this.crmID+"_"+this.name+"-tabs"),{className:"crm-block-cont-tabs"});if(this.PopupTabs.length>0){this.PopupTabsIndex=0;this.PopupTabsIndexId=this.PopupTabs[0].id}this.PopupItem={};this.PopupItemSelected={};for(e in this.PopupElement){this.PopupAddItem(this.PopupElement[e])}this.PopupBlock=BX.findChildren(BX("crm-"+this.crmID+"_"+this.name+"-blocks"),{className:"crm-block-cont-block"});this.PopupSearch=BX.findChildren(BX("crm-"+this.crmID+"_"+this.name+"-block-cont-search"),{className:"crm-block-cont-search-tab"});this.PopupSearchInput=BX("crm-"+this.crmID+"_"+this.name+"-search-input");for(e=0;e<this.PopupTabs.length;e++){BX.bind(this.PopupTabs[e],"click",function(e){return function(t){CRM.PopupShowBlock(e,this);BX.PreventDefault(t)}}(this.crmID))}for(e=0;e<this.PopupSearch.length;e++){BX.bind(this.PopupSearch[e],"click",function(e){return function(t){CRM.PopupShowSearchBlock(e,this);BX.PreventDefault(t)}}(this.crmID))}BX.bind(this.PopupSearchInput,"keyup",function(e){return function(){CRM.SearchChange(e)}}(this.crmID));this.PopupSave();BX.onCustomEvent(window,"onCrmSelectorInit",[this.crmID,this.name,this])};CRM.prototype.Clear=function(){if(this.popup){this.popup.close();this.popup.destroy()}const e=BX("crm-"+this.crmID+"_"+this.name+"-input-box");if(e){this.div.removeChild(e);BX.remove(e)}const t=BX("crm-"+this.crmID+"_"+this.name+"-text-box");if(t){BX.remove(t)}const n=BX("crm-"+this.crmID+"_"+this.name+"-html-box");if(n){BX.remove(n)}};CRM.Set=function(e,t,n,o,i,c,p,s,r,a){let l=false;if(e&&BX.isNodeInDom(e)){l=e.id+n;if(obCrm[l]){obCrm[l].Clear();delete obCrm[l]}obCrm[l]=new CRM(l,CRM.GetWrapperDivPa(e),e,t,o,i,c,p,s,r,a);obCrm[l].Init()}return l};CRM.GetElementForm=function(e){return BX.findParent(e,{tagName:"FORM"})};CRM.GetWrapperDivPr=function(e,t){return BX.findPreviousSibling(e,{tagName:"DIV",property:{name:"crm-"+t+"-box"}})};CRM.GetWrapperDivN=function(e,t){return BX.findNextSibling(e,{tagName:"DIV",property:{name:"crm-"+t+"-box"}})};CRM.GetWrapperDivPa=function(e,t){while(e.nodeName!=="DIV"&&e.name!=="crm-"+t+"-box"){e=e.parentNode}return e.parentNode};CRM.prototype.Open=function(e){if(!BX.type.isPlainObject(e)){e={}}const t=BX.type.isPlainObject(e["titleBar"])||BX.type.isNotEmptyString(e["titleBar"])?e["titleBar"]:null;const n=BX.type.isPlainObject(e["closeIcon"])?e["closeIcon"]:null;const o=BX.type.isBoolean(e["closeByEsc"])?e["closeByEsc"]:false;const i=BX.type.isBoolean(e["autoHide"])?e["autoHide"]:!this.PopupMultiple;const c=BX.type.isElementNode(e["anchor"])?e["anchor"]:this.el;const p=BX.type.isBoolean(e["gainFocus"])?e["gainFocus"]:true;if(BX.PopupWindowManager._currentPopup!==null&&BX.PopupWindowManager._currentPopup.getId()==="CRM-"+this.crmID+"-popup"){BX.PopupWindowManager._currentPopup.close()}else{let e;if(this.PopupMultiple){e=[new BX.PopupWindowButton({text:this.PopupLocalize["ok"],className:"popup-window-button-accept",events:{click:BX.delegate(this._handleAcceptBtnClick,this)}}),new BX.PopupWindowButtonLink({text:this.PopupLocalize["cancel"],className:"popup-window-button-link-cancel",events:{click:function(){this.popupWindow.close()}}})]}else{e=[new BX.PopupWindowButton({text:this.PopupLocalize["close"],className:"popup-window-button-accept",events:{click:function(){this.popupWindow.close()}}})]}this.popup=BX.PopupWindowManager.create("CRM-"+this.crmID+"-popup",c,{content:BX("crm-"+this.crmID+"_"+this.name+"-block-content-wrap"),titleBar:t,closeIcon:n,closeByEsc:o,offsetTop:2,offsetLeft:-15,zIndex:5e3,buttons:e,autoHide:i});this.popup.show();if(p){BX.focus(this.PopupSearchInput)}}return false};CRM.PopupSave2=function(e){if(!obCrm[e])return false;obCrm[e].PopupSave()};CRM.prototype._handleAcceptBtnClick=function(){this.PopupSave();this.popup.close()};CRM.prototype.AddOnSaveListener=function(e){if(typeof e!="function"){return}const t=this.onSaveListeners;for(let n=0;n<t.length;n++){if(t[n]===e){return}}t.push(e)};CRM.prototype.RemoveOnSaveListener=function(e){let t=this.onSaveListeners;for(let n=0;n<t.length;n++){if(t[n]===e){t.splice(n,1);break}}};CRM.prototype.AddOnBeforeSearchListener=function(e){if(typeof e!="function"){return}const t=this.onBeforeSearchListeners;for(let n=0;n<t.length;n++){if(t[n]===e){return}}t.push(e)};CRM.prototype.RemoveOnBeforeSearchListener=function(e){let t=this.onBeforeSearchListeners;for(let n=0;n<t.length;n++){if(t[n]===e){t.splice(n,1);break}}};CRM.prototype.PopupSave=function(){const e={};for(let t in this.PopupEntityType){const n=BX.findChildren(BX("crm-"+this.crmID+"_"+this.name+"-block-"+this.PopupEntityType[t]+"-selected"),{className:"crm-block-cont-block-item"});if(n!==null){let o=0;e[this.PopupEntityType[t]]={};for(let i=0;i<n.length;i++){const c="selected-crm-"+this.crmID+"_"+this.name+"-block-item-";const p=n[i].id.substring(c.length);const s={id:this.PopupItem[p]["id"],type:this.PopupEntityType[t],place:this.PopupItem[p]["place"],title:this.PopupItem[p]["title"],desc:this.PopupItem[p]["desc"],url:this.PopupItem[p]["url"],image:this.PopupItem[p]["image"],largeImage:this.PopupItem[p]["largeImage"]};if(typeof this.PopupItem[p]["customData"]!="undefined"){s["customData"]=this.PopupItem[p]["customData"]}if(typeof this.PopupItem[p]["advancedInfo"]!="undefined"){s["advancedInfo"]=this.PopupItem[p]["advancedInfo"]}e[this.PopupEntityType[t]][o]=s;o++}}}const t=this.onSaveListeners;if(t.length>0){for(let n=0;n<t.length;n++){try{t[n](e)}catch(e){}}}if(!this.disableMarkup){this.PopupCreateValue(e)}};CRM.prototype.ClearSelectItems=function(){this.PopupItemSelected={}};CRM.PopupShowBlock=function(e,t,n){if(!obCrm[e]){return false}for(let n=0;n<obCrm[e].PopupTabs.length;n++){if(obCrm[e].PopupTabs[n]===t){obCrm[e].PopupTabsIndex=n;obCrm[e].PopupTabsIndexId=obCrm[e].PopupTabs[n].id}obCrm[e].PopupBlock[n].style.display="none";BX.removeClass(obCrm[e].PopupTabs[n],"selected")}if(!n){BX.addClass(t,"selected");obCrm[e].PopupSearchInput.value="";BX("crm-"+e+"_"+obCrm[e].name+"-block-search").innerHTML=""}else BX.addClass(obCrm[e].PopupTabs[obCrm[e].PopupTabsIndex],"selected");obCrm[e].PopupBlock[obCrm[e].PopupTabsIndex].style.display="block";BX("crm-"+e+"_"+obCrm[e].name+"-block-search").style.display="none";BX.removeClass(obCrm[e].PopupSearch[1],"selected");BX.addClass(obCrm[e].PopupSearch[0],"selected");BX.focus(obCrm[e].PopupSearchInput)};CRM.PopupShowSearchBlock=function(e,t){if(!obCrm[e]){return false}for(let t=0;t<obCrm[e].PopupBlock.length;t++){obCrm[e].PopupBlock[t].style.display="none"}if(t===obCrm[e].PopupSearch[0]){CRM.PopupShowBlock(e,BX(obCrm[e].PopupTabsIndexId),true);return false}BX("crm-"+obCrm[e].crmID+"_"+obCrm[e].name+"-block-search").style.display="block";BX.removeClass(obCrm[e].PopupSearch[0],"selected");BX.addClass(t,"selected");BX.focus(obCrm[e].PopupSearchInput)};CRM.PopupSelectItem=function(e,t,n,o,i){let c;if(!obCrm[e])return false;const p=t;if(p.check){if(i===undefined||!i){CRM.PopupUnselectItem(e,t.id,"selected-"+t.id)}return false}const s="crm-"+e+"_"+obCrm[e].name+"-block-item-";const r=t.id.substring(s.length);const a=document.createElement("span");a.className="crm-block-cont-block-item";a.id="selected-"+t.id;const l=document.createElement("i");const m=document.createElement("a");m.href=obCrm[e].PopupItem[r]["url"];m.target="_blank";let d=null;const u=obCrm[e].PopupTabsIndexId;const h="crm-"+e+"_"+obCrm[e].name;const b=h+"-tab-";const f=h+"-block-";const C="-selected";if(n===null){if(BX.Type.isStringFilled(u)&&u.length>b.length&&u.substring(0,b.length)===b){const e=u.substring(b.length);if(e.length<30&&/^[a-z]+(_[a-z]+)?(_[0-9]+)?$/.test(e)){d=BX(f+e+C)}}}else{d=BX(f+n+C)}if(!d||d.querySelector("[id='"+("selected-"+t.id).replace(new RegExp("search$"),n)+"']")||d.querySelector("[id='"+("selected-"+t.id).replace(new RegExp(n+"$"),"search")+"']")){return}if(obCrm[e].PopupMultiple){const e=BX.findChild(d,{className:"crm-block-cont-right-title-count"},true);e.innerHTML=parseInt(e.innerHTML)+1;BX.addClass(t,"crm-block-cont-item-selected");BX.addClass(d,"crm-added-item");p.check=1}else{const t="crm-"+e+"_"+obCrm[e].name+"-block-"+obCrm[e].PopupEntityType[c]+"-selected";for(c in obCrm[e].PopupEntityType){BX.removeClass(BX(t),"crm-added-item");const e=BX.findChildren(BX(t),{className:"crm-block-cont-block-item"});if(e!==null){for(c in e){BX.remove(e[c])}}}}d.appendChild(a).appendChild(l);d.appendChild(a).appendChild(m).innerHTML=BX.util.htmlspecialchars(obCrm[e].PopupItem[r]["title"]);BX.bind(l,"click",(n=>{CRM.PopupUnselectItem(e,t.id,"selected-"+t.id);BX.PreventDefault(n)}));obCrm[e].PopupItemSelected[r]=t;BX.onCustomEvent(window,"onCrmSelectedItem",[obCrm[e].PopupItem[r]]);if(!obCrm[e].PopupMultiple&&(o===undefined||!o)){obCrm[e].PopupSave();if(BX.PopupWindowManager._currentPopup!==null&&BX.PopupWindowManager._currentPopup.getId()==="CRM-"+e+"-popup"){BX.PopupWindowManager._currentPopup.close()}}};CRM.PopupUnselectItem=function(e,t,n){if(!obCrm[e])return false;if(obCrm[e].PopupMultiple){if(BX(n).parentNode.getElementsByTagName("span").length===3){BX.removeClass(BX(n).parentNode,"crm-added-item")}const e=BX.findChild(BX(n).parentNode,{className:"crm-block-cont-right-title-count"},true);e.innerHTML=parseInt(e.innerHTML)-1;obj=BX(t);if(obj!==null){obj.check=0;BX.removeClass(obj,"crm-block-cont-item-selected")}}const o="crm-"+e+"_"+obCrm[e].name+"-block-item-";const i=t.substring(o.length);delete obCrm[e].PopupItemSelected[i];BX.remove(BX(n));BX.onCustomEvent(window,"onCrmUnSelectedItem",[obCrm[e].PopupItem[i]])};CRM.prototype.SetPopupItems=function(e,t){this.PopupItem={};this.PopupItemSelected={};const n=BX("crm-"+this.crmID+"_"+this.name+"-block-"+e);BX.cleanNode(n);for(let n=0;n<t.length;n++){const o=t[n];o["place"]=e;this.PopupAddItem(o)}};CRM.prototype.PopupSetItem=function(e){const t=e.toString().split("_");let n;let o="";if(t[1]!==undefined){const e=t[0];n=t[1];if(this.PopupEntityTypeAbbr.length>0){for(let t in this.PopupEntityTypeAbbr){if(this.PopupEntityTypeAbbr.hasOwnProperty(t)&&e===this.PopupEntityTypeAbbr[t]){if(this.PopupEntityType.hasOwnProperty(t)){o=this.PopupEntityType[t]}break}}}if(o===""){if(e==="L"){o="lead"}else if(e==="C"){o="contact"}else if(e==="CO"){o="company"}else if(e==="D"){o="deal"}else if(e==="Q"){o="quote"}else if(e==="O"){o="order"}}}else{for(let e in this.PopupEntityType){o=this.PopupEntityType[e]}n=e}const i=this;const c={REQUIRE_REQUISITE_DATA:i.options.requireRequisiteData?"Y":"N"};if(BX.type.isPlainObject(i.options["searchOptions"])){const e=i.options["searchOptions"];for(let t in e){if(e.hasOwnProperty(t))c[t]=e[t]}}const p="/bitrix/components/bitrix/crm."+o+".list/list.ajax.php";const s={MODE:"SEARCH",VALUE:"["+n+"]",MULTI:i.PopupPrefix?"Y":"N",OPTIONS:c};const r=function(e){for(let t in e){e[t]["selected"]="Y";i.PopupAddItem(e[t])}i.PopupSave()};const a=function(e){};if(i.PopupCustomSearchHandler){s["ENTITY_TYPE"]=o;i.PopupCustomSearchHandler(s,r,a)}else{BX.ajax({url:p,method:"POST",dataType:"json",data:s,onsuccess:r,onfailure:a})}};CRM.prototype.PopupAddItem=function(e){if(!BX.Type.isStringFilled(e["place"])){e["place"]=e["type"]}let t=false;if(this.PopupItemSelected.hasOwnProperty(e["id"]+"-"+e["place"])){t=true}const n=document.createElement("span");n.id="crm-"+this.crmID+"_"+this.name+"-block-item-"+e["id"]+"-"+e["place"];n.className="crm-block-cont-item"+(t?" crm-block-cont-item-selected":"");n.check=t?1:0;if(e["type"]==="contact"||e["type"]==="company"){const t=document.createElement("span");t.className="crm-avatar";if(BX.Type.isStringFilled(e["image"])){t.style.background='url("'+e["image"]+'") no-repeat';t.style.backgroundSize="contain"}n.appendChild(t)}const o=document.createElement("ins");o.appendChild(document.createTextNode(e["title"]));const i=document.createElement("var");i.className="crm-block-cont-var-id";i.appendChild(document.createTextNode(e["id"]));const c=document.createElement("var");c.className="crm-block-cont-var-url";c.appendChild(document.createTextNode(e["url"]));const p=document.createElement("span");let s=BX.prop.getString(e,"desc_html","");if(s!==""){s=BX.util.strip_tags(s)}else{s=this.prepareDescriptionHtml(BX.prop.getString(e,"desc",""))}p.innerHTML=s;const r=document.createElement("span");r.className="crm-block-cont-contact-info";r.appendChild(o);r.appendChild(p);r.appendChild(i);r.appendChild(c);n.appendChild(r);n.appendChild(document.createElement("i"));let a=false;if(e["place"]!=="search"&&this.PopupItem[e["id"]+"-"+e["place"]]!==undefined){a=true}else{this.PopupItem[e["id"]+"-"+e["place"]]=e}const l=BX("crm-"+this.crmID+"_"+this.name+"-block-"+e["place"]);if(l!==null){if(!a)l.appendChild(n);CRM._bindPopupItem(this.crmID,n,e["type"]);if(e["selected"]!==undefined&&e["selected"]==="Y")CRM.PopupSelectItem(this.crmID,n,e["type"],true,true)}};CRM._bindPopupItem=function(e,t,n){BX.bind(t,"click",(function(o){CRM.PopupSelectItem(e,t,n);return BX.PreventDefault(o)}))};CRM.prototype.prepareDescriptionHtml=function(e){return BX.type.isNotEmptyString(e)?BX.util.htmlspecialchars(e):""};CRM.SearchChange=function(e){if(!obCrm[e])return false;const t=obCrm[e].PopupSearchInput.value;if(t===""){return false}const n=obCrm[e].PopupTabsIndexId;const o="crm-"+e+"_"+obCrm[e].name+"-tab-";const i="crm-"+e+"_"+obCrm[e].name+"-block-search";let c="";if(BX.Type.isStringFilled(n)&&n.length>o.length&&n.substring(0,o.length)===o){const e=n.substring(o.length);if(e.length<30&&/^[a-z]+(_[a-z]+)?(_[0-9]+)?$/.test(e)){c=e}}if(c===""){return false}const p={REQUIRE_REQUISITE_DATA:obCrm[e].options.requireRequisiteData?"Y":"N"};if(BX.type.isPlainObject(obCrm[e].options["searchOptions"])){const t=obCrm[e].options["searchOptions"];for(let e in t){if(t.hasOwnProperty(e))p[e]=t[e]}}let s={MODE:"SEARCH",VALUE:t,MULTI:obCrm[e].PopupPrefix?"Y":"N",OPTIONS:p};if(e==="new_invoice_product_button"){s["ENTITY_TYPE"]="INVOICE"}const r="/bitrix/components/bitrix/crm."+c+".list/list.ajax.php";const a=obCrm[e].onBeforeSearchListeners;if(a&&BX.type.isArray(a)&&a.length>0){const e={entityType:c,postData:s};for(let t=0;t<a.length;t++){try{a[t](e)}catch(e){}s=e["postData"]}}CRM.PopupShowSearchBlock(e,obCrm[e].PopupSearch[1]);setTimeout((function(){if(typeof obCrm[e]==="undefined"){return}if(BX(i).innerHTML===""&&n===o+c){const t=document.createElement("div");t.className="crm-block-cont-search-wait";t.innerHTML=obCrm[e].PopupLocalize["wait"];BX(i).appendChild(t)}}),3e3);const l=function(t){if(n!==o+c){return false}BX(i).className="crm-block-cont-block crm-block-cont-block-"+c;BX(i).innerHTML="";let p=0;for(let n in t){t[n]["place"]="search";obCrm[e].PopupAddItem(t[n]);p++}if(p===0){const t=document.createElement("div");t.className="crm-block-cont-search-no-result";t.innerHTML=obCrm[e].PopupLocalize["noresult"];BX(i).appendChild(t)}};const m=function(e){};if(obCrm[e].PopupCustomSearchHandler){s["ENTITY_TYPE"]=c;obCrm[e].PopupCustomSearchHandler(s,l,m)}else{BX.ajax({url:r,method:"POST",dataType:"json",data:s,onsuccess:l,onfailure:m})}};CRM.prototype.PopupCreateValue=function(e){let t;let n;const o=BX("crm-"+this.crmID+"_"+this.name+"-input-box");let i=BX("crm-"+this.crmID+"_"+this.name+"-text-box");if(!o||!i){return}o.innerHTML="";const c=document.createElement("DIV");c.id=i.id;i.parentNode.replaceChild(c,i);i=c;const p=document.createElement("table");p.className="field_crm";p.cellPadding="0";p.cellSpacing="0";const s=document.createElement("TBODY");let r=0;for(let i in e){const c=document.createElement("TR");c.className="crmPermTableTrHeader";if(this.PopupEntityType.length>1){t=document.createElement("TD");t.className="field_crm_entity_type";t.appendChild(document.createTextNode(this.PopupLocalize[i]+":"));c.appendChild(t)}t=document.createElement("TD");t.className="field_crm_entity";let p=0;for(let c in e[i]){n=document.createElement("input");n.type="text";n.name=this.name+(this.PopupMultiple?"[]":"");n.value=e[i][c]["id"];o.appendChild(n);const s=document.createElement("a");s.href=e[i][c]["url"];s.target="_blank";s.appendChild(document.createTextNode(e[i][c]["title"]));t.appendChild(s);const a=document.createElement("span");a.className="crm-element-item-delete";a.id="deleted-crm-"+this.crmID+"_"+this.name+"-block-item-"+e[i][c]["id"]+"-"+e[i][c]["place"];BX.bind(a,"click",function(e){return function(){CRM.PopupUnselectItem(e,this.id.substring(8),"selected-"+this.id.substring(8));CRM.PopupSave2(e)}}(this.crmID));t.appendChild(a);BX.fireEvent(n,"change");p++;r++}if(p>0){c.appendChild(t);s.appendChild(c)}}if(r===0){n=document.createElement("input");n.type="text";n.name=this.name+(this.PopupMultiple?"[]":"");n.value="";o.appendChild(n);BX.fireEvent(n,"change")}p.appendChild(s);i.appendChild(p);if(this.el){if(r>0){this.el.innerHTML=this.PopupLocalize["edit"]}else{BX.cleanNode(i,false);if(BX.browser.IsIE()){i.style.fontSize="0px";i.style.lineHeight="0px"}this.el.innerHTML=this.PopupLocalize["add"]}}};CRM.prototype.popupShowMarkup=function(){let e;let t;const n=document.createElement("div");n.id="crm-"+this.crmID+"_"+this.name+"-block-content-wrap";n.className="crm-block-content";const o=document.createElement("table");o.className="crm-box-layout";if(!this.PopupMultiple){o.className=o.className+" crm-single-column"}o.cellSpacing="0";const i=document.createElement("tbody");const c=document.createElement("TR");const p=document.createElement("TD");p.className="crm-block-cont-left";let s=document.createElement("div");s.id="crm-"+this.crmID+"_"+this.name+"-tabs";s.className="crm-block-cont-tabs-wrap";if(this.PopupEntityType.length===1){s.className=s.className+" crm-single-entity"}let r=true;for(e in this.PopupEntityType){const t=document.createElement("span");t.className="crm-block-cont-tabs"+(r?" selected":"");t.id="crm-"+this.crmID+"_"+this.name+"-tab-"+this.PopupEntityType[e];const n=document.createElement("span");const o=document.createElement("span");o.appendChild(document.createTextNode(this.PopupLocalize[this.PopupEntityType[e]]));n.appendChild(o);t.appendChild(n);s.appendChild(t);r=false}p.appendChild(s);s=document.createElement("div");s.id="crm-"+this.crmID+"_"+this.name+"-block-cont-search";s.className="crm-block-cont-search";const a=document.createElement("input");a.type="text";a.id="crm-"+this.crmID+"_"+this.name+"-search-input";s.appendChild(a);let l=document.createElement("span");l.className="crm-block-cont-search-tab selected";l.appendChild(document.createElement("span"));let m=document.createElement("a");m.href="#";m.appendChild(document.createTextNode(this.PopupLocalize["last"]));l.appendChild(m);l.appendChild(document.createElement("span"));s.appendChild(l);l=document.createElement("span");l.className="crm-block-cont-search-tab";l.appendChild(document.createElement("span"));m=document.createElement("a");m.href="#";m.appendChild(document.createTextNode(this.PopupLocalize["search"]));l.appendChild(m);l.appendChild(document.createElement("span"));s.appendChild(l);p.appendChild(s);s=document.createElement("div");s.className="popup-window-hr popup-window-buttons-hr";s.appendChild(document.createElement("b"));p.appendChild(s);s=document.createElement("div");s.id="crm-"+this.crmID+"_"+this.name+"-blocks";s.className="crm-block-cont-blocks-wrap";r=true;for(e in this.PopupEntityType){t=document.createElement("div");t.id="crm-"+this.crmID+"_"+this.name+"-block-"+this.PopupEntityType[e];t.className="crm-block-cont-block crm-block-cont-block-"+this.PopupEntityType[e];t.style.display=r?"block":"none";s.appendChild(t);r=false}t=document.createElement("div");t.id="crm-"+this.crmID+"_"+this.name+"-block-search";t.className="crm-block-cont-block";t.style.display="none";s.appendChild(t);t=document.createElement("div");t.id="crm-"+this.crmID+"_"+this.name+"-block-declared";t.className="crm-block-cont-block";t.style.display="none";s.appendChild(t);p.appendChild(s);c.appendChild(p);const d=document.createElement("TD");d.className="crm-block-cont-right";const u=document.createElement("div");u.className="crm-block-cont-right-wrap-item";for(e in this.PopupEntityType){const t=document.createElement("div");t.className="crm-block-cont-right-item";t.id="crm-"+this.crmID+"_"+this.name+"-block-"+this.PopupEntityType[e]+"-selected";const n=document.createElement("span");n.className="crm-block-cont-right-title";n.appendChild(document.createTextNode(this.PopupLocalize[this.PopupEntityType[e]]));n.appendChild(document.createTextNode(" ("));const o=document.createElement("span");o.className="crm-block-cont-right-title-count";o.appendChild(document.createTextNode("0"));n.appendChild(o);n.appendChild(document.createTextNode(")"));t.appendChild(n);u.appendChild(t)}d.appendChild(u);c.appendChild(d);i.appendChild(c);o.appendChild(i);n.appendChild(o);const h=document.createElement("div");document.body.appendChild(h);h.id="crm-"+this.crmID+"_"+this.name+"-html-box";h.className="crm-place-holder";h.appendChild(n);if(this.div){const e=document.createElement("div");e.id="crm-"+this.crmID+"_"+this.name+"-input-box";e.style.display="none";this.div.appendChild(e);const t="crm-"+this.crmID+"_"+this.name+"-text-box";if(BX(t)){throw"Already exists "+t}const n=document.createElement("div");this.div.insertBefore(n,this.div.firstChild);n.id="crm-"+this.crmID+"_"+this.name+"-text-box"}};
//# sourceMappingURL=crm.map.js