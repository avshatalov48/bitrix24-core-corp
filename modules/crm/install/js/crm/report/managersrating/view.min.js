(function(){"use strict";BX.namespace("BX.Crm.Report.Dashboard.Content");BX.Crm.Report.Dashboard.Content.ManagersRating=function(){BX.Report.VisualConstructor.Widget.Content.AmCharts4.apply(this,arguments)};BX.Crm.Report.Dashboard.Content.ManagersRating.prototype={__proto__:BX.Report.VisualConstructor.Widget.Content.AmCharts4.prototype,constructor:BX.Crm.Report.Dashboard.Content.ManagersRating,onAfterChartCreate:function(){var t=this.chart.series.getIndex(0);var a=t.columns.template;t.mainContainer.mask=undefined;var r=a.createChild(am4charts.CircleBullet);r.circle.radius=30;r.valign="bottom";r.align="center";r.isMeasured=true;r.mouseEnabled=false;r.verticalCenter="bottom";r.interactionsEnabled=false;r.dy=-40;r.visible=false;r.states.create("hover");var e=r.createChild(am4core.Circle);e.adapter.add("radius",function(t,a){var r=a.parent;return r.circle.pixelRadius+10});var n=r.createChild(am4core.Image);n.width=60;n.height=60;n.horizontalCenter="middle";n.verticalCenter="middle";n.propertyFields.href="bullet";n.adapter.add("mask",function(t,a){var r=a.parent;return r.circle});a.events.on("transitionended",this.onColumnTransitionEnded.bind(this));a.events.on("over",this.onColumnOver.bind(this));a.events.on("out",this.onColumnOut.bind(this));a.adapter.add("tooltipHTML",this.renderBalloon.bind(this))},onColumnTransitionEnded:function(t){var a=t.target.maxHeight;var r=t.target.children.getIndex(1);if(a===0){return}if(a>60){r.visible=true}else{r.visible=false;t.target.column.cornerRadius(10,10,3,3)}},onColumnOver:function(t){var a=t.target.children.getIndex(1);var r=a.states.getKey("hover");r.properties.dy=-a.parent.pixelHeight+30;a.isHover=true},onColumnOut:function(t){var a=t.target.children.getIndex(1);a.isHover=false},renderBalloon:function(t,a){var r=a.dataItem.dataContext.balloon;var e=a.fill.hex;var n=r.amountWon>=r.amountWonPrev?"crm-report-financial-rating-value-up":"crm-report-financial-rating-value-down";return'<div class="crm-report-financial-rating-modal" style="border-color: '+e+';">'+'\t\t\t<div class="crm-report-financial-rating-modal-title">'+BX.util.htmlspecialchars(r.userName)+"\t\t\t</div>"+'            <div class="crm-report-financial-rating-group-values">'+'\t\t\t\t<div class="crm-report-financial-rating-modal-line">'+'\t\t\t\t\t<div class="crm-report-financial-rating-modal-value">'+r.amountWonFormatted+"\t\t\t\t\t</div>"+"\t\t\t\t</div>"+'\t\t\t\t<div class="crm-report-financial-rating-modal-line">'+'\t\t\t\t\t<div class="crm-report-financial-rating-modal-value '+n+'">'+r.amountWonPrevFormatted+"\t\t\t\t\t</div>"+"\t\t\t\t</div>"+"            </div>"+'            <div class="crm-report-financial-rating-group-values">'+'\t\t\t\t<div class="crm-report-financial-rating-modal-line">'+'\t\t\t\t\t<div class="crm-report-financial-rating-modal-subtitle">'+BX.message("CRM_REPORT_FINANCIAL_RATING_DEALS_AVG_AMOUNT")+"\t\t\t\t\t</div>"+'\t\t\t\t\t<div class="crm-report-financial-rating-modal-value">'+r.avgWonAvgAmountFormatted+"\t\t\t\t\t</div>"+"\t\t\t\t</div>"+'\t\t\t\t<div class="crm-report-financial-rating-modal-line">'+'\t\t\t\t\t<div class="crm-report-financial-rating-modal-subtitle">'+BX.message("CRM_REPORT_FINANCIAL_RATING_DEALS_WON_COUNT")+"\t\t\t\t\t</div>"+'\t\t\t\t\t<div class="crm-report-financial-rating-modal-inner">'+'\t\t\t\t\t<div class="crm-report-financial-rating-modal-value-box">'+this.getDealCountBlock(r.countWon,r.countTotal)+"\t\t\t\t\t</div>"+'\t\t\t\t\t<div class="crm-report-financial-rating-modal-percent">'+this.getPercent(r.countWon,r.countTotal)+"\t\t\t\t\t</div>"+"\t\t\t\t\t</div>"+"\t\t\t\t</div>"+" \t\t\t</div>"+"</div>"},getDealCountBlock:function(t,a){var r='<div class="crm-report-financial-rating-modal-value">'+t+"</div>";var e='<div class="crm-report-financial-rating-modal-value">'+a+"</div>";var n=BX.message("CRM_REPORT_FINANCIAL_RATING_DEALS_WON_OF");n=n.replace("#WON_COUNT#",r);n=n.replace("#TOTAL_COUNT#",e);return n},getPercent:function(t,a){var r;if(a==0){return"&mdash;"}else{r=t/a;return Math.round(r*100).toString()+"%"}}}})();
//# sourceMappingURL=view.map.js