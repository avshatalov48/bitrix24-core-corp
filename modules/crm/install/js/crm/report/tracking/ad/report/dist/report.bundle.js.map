{"version":3,"file":"report.bundle.js","sources":["../src/report.js"],"sourcesContent":["import './report.css';\n\nimport 'sidepanel';\nimport 'ui.progressbar';\nimport { Tag, Runtime, Event, Loc, Text } from 'main.core';\nimport { EventEmitter } from 'main.core.events'\nimport { Menu, Popup, PopupOptions } from 'main.popup'\n\ntype Options = {\n\tsourceId: string;\n\tfrom: string;\n\tto: string;\n\tparentId: number;\n\tlevel: number;\n\tgridId: string;\n};\n\nclass Report\n{\n\tui: Object = {\n\t\tcontainer: null,\n\t\tloader: null,\n\t\tloaderText: null,\n\t\tloaderProgressBar: null,\n\t\tloaderActive: false,\n\t\tgrid: null,\n\t};\n\n\tconstructor(options)\n\t{\n\t\tthis.load(options);\n\t}\n\n\tstatic open(options: Options): Promise\n\t{\n\t\tif (window === top)\n\t\t{\n\t\t\treturn Promise.resolve(new Report(options));\n\t\t}\n\n\t\treturn top.BX.Runtime.loadExtension('crm.report.tracking.ad.report').then(() => {\n\t\t\treturn new top.BX.Crm.Report.Tracking.Ad.Report(options);\n\t\t});\n\t}\n\n\tload({sourceId, from, to, parentId = 0, level = 0, gridId}: Options)\n\t{\n\t\tthis.gridId = gridId = gridId || `crm-report-tracking-ad-l${level}`;\n\t\tthis.filter = {sourceId, from, to, parentId, level, gridId};\n\n\t\tBX.SidePanel.Instance.open(\n\t\t\t'crm:api.tracking.ad.report' + `-${sourceId}-${level}`,\n\t\t\t{\n\t\t\t\tcacheable: false,\n\t\t\t\tcontentCallback: () => {\n\t\t\t\t\tconst container = this.createUiContainer(level);\n\t\t\t\t\tthis.build();\n\t\t\t\t\treturn container;\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t}\n\n\tbuild ()\n\t{\n\t\tthis.showLoader();\n\t\tif (this.filter.level)\n\t\t{\n\t\t\tthis.loadGrid();\n\t\t\treturn;\n\t\t}\n\n\t\tBX.ajax.runAction(\n\t\t\t'crm.api.tracking.ad.report.build',\n\t\t\t{\n\t\t\t\tjson: {\n\t\t\t\t\t...this.filter,\n\t\t\t\t}\n\t\t\t}\n\t\t)\n\t\t\t.then(({data}) => {\n\t\t\t\tif (data.label)\n\t\t\t\t{\n\t\t\t\t\tthis.setLoaderText(data.label);\n\t\t\t\t}\n\n\t\t\t\tif (data.complete)\n\t\t\t\t{\n\t\t\t\t\tthis.loadGrid();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.build();\n\t\t\t\t}\n\t\t\t});\n\t}\n\n\tloadGrid ()\n\t{\n\t\tBX.ajax.runAction(\n\t\t\t'crm.api.tracking.ad.report.getGrid',\n\t\t\t{\n\t\t\t\tdata: {\n\t\t\t\t\t...this.filter,\n\t\t\t\t}\n\t\t\t}\n\t\t)\n\t\t\t.then(({data}) => {\n\t\t\t\t//container.innerHTML = data.html;\n\t\t\t\tEventEmitter.subscribe(\n\t\t\t\t\twindow,\n\t\t\t\t\t'Grid::beforeRequest',\n\t\t\t\t\tthis.onBeforeGridRequest.bind(this)\n\t\t\t\t);\n\n\t\t\t\tRuntime.html(this.getNode('grid'), data.html)\n\t\t\t\tthis.initActivators();\n\t\t\t\tthis.hideLoader();\n\n\t\t\t\tif (!this.filter.level)\n\t\t\t\t{\n\t\t\t\t\tconst popupOptions: PopupOptions = {\n\t\t\t\t\t\tcontent: Loc.getMessage('CRM_REPORT_TRACKING_AD_REPORT_SETTINGS_HINT'),\n\t\t\t\t\t\tzIndex: 5000,\n\t\t\t\t\t\tmaxWidth: 300,\n\t\t\t\t\t\toffsetLeft: -315,\n\t\t\t\t\t\toffsetTop: -30,\n\t\t\t\t\t\tanimation: 'fading',\n\t\t\t\t\t\tdarkMode: true,\n\t\t\t\t\t\tbindElement: this.ui.hint,\n\t\t\t\t\t};\n\t\t\t\t\tconst popup = new Popup(popupOptions);\n\t\t\t\t\tpopup.show();\n\t\t\t\t\tsetTimeout(() => popup.destroy(), 7000);\n\t\t\t\t}\n\t\t\t});\n\t}\n\n\tinitActivators ()\n\t{\n\t\tthis.getNodes('grid/activator').forEach((node) => {\n\t\t\tconst options = JSON.parse(node.dataset.options);\n\t\t\tEvent.bind(node, 'click', () => {\n\t\t\t\tnew Report({\n\t\t\t\t\t...this.filter,\n\t\t\t\t\tlevel: options.level,\n\t\t\t\t\tparentId: options.parentId,\n\t\t\t\t\tgridId: this.filter.gridId + '-lvl' + options.level,\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\n\t\tconst selectorTitle = this.getNode('grid/selector/title');\n\t\tconst selector = this.getNode('grid/selector');\n\t\tif (selector)\n\t\t{\n\t\t\tconst container = this.getNode('selector');\n\t\t\tif (container.children.length > 0)\n\t\t\t{\n\t\t\t\tselector.parentElement.removeChild(selector);\n\t\t\t\tselectorTitle.parentElement.removeChild(selectorTitle);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tselector.dataset.role = '';\n\t\t\tselectorTitle.dataset.role = '';\n\t\t\tcontainer.appendChild(selectorTitle);\n\t\t\tcontainer.appendChild(selector);\n\n\t\t\tEvent.bind(selector, 'click', () => {\n\t\t\t\tconst options = JSON.parse(selector.dataset.options);\n\t\t\t\tconst popup = new Menu({\n\t\t\t\t\tbindElement: selector,\n\t\t\t\t\tzIndex: 3010,\n\t\t\t\t\titems: options.items.map(item => {\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\ttext: Text.encode(item.title),\n\t\t\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\t\t\tpopup.close();\n\t\t\t\t\t\t\t\tselector.textContent = item.title;\n\t\t\t\t\t\t\t\tthis.filter.parentId = item.parentId;\n\t\t\t\t\t\t\t\tthis.filter.level = item.level;\n\t\t\t\t\t\t\t\tthis.filter.sourceId = item.sourceId;\n\t\t\t\t\t\t\t\tthis.build();\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t};\n\t\t\t\t\t})\n\t\t\t\t});\n\t\t\t\tpopup.show();\n\t\t\t});\n\t\t}\n\t}\n\n\tcreateUiContainer (level)\n\t{\n\t\tconst container = Tag.render`\n\t\t\t<div class=\"crm-report-tracking-panel\">\n\t\t\t\t<div class=\"crm-report-tracking-panel-title\">\n\t\t\t\t\t<div class=\"crm-report-tracking-panel-title-name\">\n\t\t\t\t\t\t<div class=\"crm-report-tracking-panel-title-line\">\n\t\t\t\t\t\t\t<div data-role=\"title\"></div>\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t${level ? '' : '<div data-role=\"hint\" class=\"ui-hint-icon crm-report-tracking-panel-hint\"></div>'}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div data-role=\"selector\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"crm-report-tracking-panel-body\">\n\t\t\t\t\t<div data-role=\"loader\" class=\"crm-report-tracking-panel-loader\">\n\t\t\t\t\t\t<div data-role=\"loader/text\" class=\"crm-report-tracking-panel-loader-text\"></div>\n\t\t\t\t\t\t<div data-role=\"loader/bar\" class=\"crm-report-tracking-panel-loader-bar\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div data-role=\"grid\"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tthis.ui.container = container;\n\t\tthis.ui.title = this.getNode('title');\n\t\tthis.ui.hint = this.getNode('hint');\n\t\tthis.ui.loader = this.getNode('loader');\n\t\tthis.ui.loaderText = this.getNode('loader/text');\n\t\tthis.ui.grid = this.getNode('grid');\n\n\t\tconst progressBar = new BX.UI.ProgressBar({\n\t\t\tvalue: 0,\n\t\t\tmaxValue: 100,\n\t\t\tstatusType: 'none',\n\t\t\tcolumn: true,\n\t\t});\n\n\t\tif (this.ui.hint)\n\t\t{\n\t\t\tthis.ui.hint.addEventListener('click', () => BX.Helper.show(\"redirect=detail&code=12526974\"));\n\t\t}\n\n\t\tthis.getNode('loader/bar').appendChild(progressBar.getContainer());\n\t\tthis.ui.loaderProgressBar = progressBar;\n\t\tthis.setLoaderText(Loc.getMessage('CRM_REPORT_TRACKING_AD_REPORT_BUILD'));\n\n\t\tthis.setTitle(Loc.getMessage('CRM_REPORT_TRACKING_AD_REPORT_TITLE_' + this.filter.level));\n\n\t\treturn container;\n\t}\n\n\tsetLoaderText (text)\n\t{\n\t\tthis.ui.loaderProgressBar.setValue(0);\n\t\tthis.ui.loaderProgressBar.setTextBefore(text);\n\t}\n\n\tanimateLoader ()\n\t{\n\t\tif (!this.ui.loaderActive)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst progressBar = this.ui.loaderProgressBar;\n\t\tconst val = parseInt(progressBar.getValue()) + 1;\n\t\tif (val <= 95)\n\t\t{\n\t\t\tprogressBar.update(val);\n\t\t}\n\n\t\tsetTimeout(() => this.animateLoader(), 100);\n\t}\n\n\tshowLoader ()\n\t{\n\t\tif (!this.ui.loaderActive)\n\t\t{\n\t\t\tsetTimeout(() => this.animateLoader(), 100);\n\t\t}\n\n\t\tthis.ui.loaderActive = true;\n\t\tthis.ui.loader.style.display = '';\n\t}\n\n\thideLoader ()\n\t{\n\t\tconst progressBar = this.ui.loaderProgressBar;\n\t\tif (progressBar)\n\t\t{\n\t\t\tprogressBar.update(0);\n\t\t}\n\t\tthis.ui.loaderActive = false;\n\t\tthis.ui.loader.style.display = 'none';\n\t}\n\n\tsetTitle (title)\n\t{\n\t\treturn this.ui.title.textContent = title;\n\t}\n\n\tgetNode (role)\n\t{\n\t\treturn this.ui.container.querySelector(`[data-role=\"${role}\"]`);\n\t}\n\n\tgetNodes (role)\n\t{\n\t\treturn Array.from(this.ui.container.querySelectorAll(`[data-role=\"${role}\"]`));\n\t}\n\n\tonBeforeGridRequest (grid, eventArgs)\n\t{\n\t\teventArgs.sessid = BX.bitrix_sessid();\n\t\teventArgs.method = 'POST';\n\n\t\tif (!eventArgs.url)\n\t\t{\n\t\t\tconst parameters = Object.keys(this.filter).forEach(key => key + '=' + this.filter[key]);\n\t\t\teventArgs.url = '/bitrix/services/main/ajax.php?action=crm.api.tracking.ad.grid.report.get&' + parameters;\n\t\t}\n\n\t\teventArgs.data = {\n\t\t\t...eventArgs.data,\n\t\t};\n\t}\n}\n\n\nexport {Report};"],"names":["Report","options","container","loader","loaderText","loaderProgressBar","loaderActive","grid","load","sourceId","from","to","parentId","level","gridId","filter","BX","SidePanel","Instance","open","cacheable","contentCallback","createUiContainer","build","showLoader","loadGrid","ajax","runAction","json","then","data","label","setLoaderText","complete","EventEmitter","subscribe","window","onBeforeGridRequest","bind","Runtime","html","getNode","initActivators","hideLoader","popupOptions","content","Loc","getMessage","zIndex","maxWidth","offsetLeft","offsetTop","animation","darkMode","bindElement","ui","hint","popup","Popup","show","setTimeout","destroy","getNodes","forEach","node","JSON","parse","dataset","Event","selectorTitle","selector","children","length","parentElement","removeChild","role","appendChild","Menu","items","map","item","text","Text","encode","title","onclick","close","textContent","Tag","render","progressBar","UI","ProgressBar","value","maxValue","statusType","column","addEventListener","Helper","getContainer","setTitle","setValue","setTextBefore","val","parseInt","getValue","update","animateLoader","style","display","querySelector","Array","querySelectorAll","eventArgs","sessid","bitrix_sessid","method","url","parameters","Object","keys","key","top","Promise","resolve","loadExtension","Crm","Tracking","Ad"],"mappings":"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"}