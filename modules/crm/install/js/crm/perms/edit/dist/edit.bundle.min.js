this.BX=this.BX||{},this.BX.Crm=this.BX.Crm||{},function(exports,ui_buttons,ui_sidepanel,ui_sidepanel_layout,ui_vue3,ui_vue3_vuex,ui_designTokens,main_core_events,ui_entitySelector,main_core,ui_loader){"use strict";var ExpandControl={name:"ExpandControl",props:{entity:Object,isExpanded:Boolean},emits:["toggle"],methods:{toggleState:function(){this.$emit("toggle")}},template:'\n\t\t<div\n\t\t\t:class="{\'--expanded\': isExpanded}"\n\t\t\tclass="bx-crm-perms-edit-expand_control"\n\t\t\t@click="toggleState">\n\t\t</div>\n\t'};function ownKeys(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(r),!0).forEach((function(e){babelHelpers.defineProperty(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var PermissionControl={name:"PermissionControl",props:{value:{type:String,required:!0},valuesMap:{type:Object,required:!0},permissionIdentifier:{type:Object,required:!0}},emits:["valueChanged"],data:function(){return{label:{inherit:main_core.Loc.getMessage("CRM_PERMS_EDIT_ENTITIES_INHERIT")},isEditMode:!1}},computed:_objectSpread(_objectSpread({},ui_vue3_vuex.mapGetters(["getAssignedAttribute"])),{},{currentPermissionName:function(){if("AUTOMATION"===this.permissionIdentifier.permissionCode&&this.isReadOnlyMode){return this.valuesMap.X}return this.isStageControl&&"-"===this.model?this.getParentName:this.valuesMap[this.value]},isInherited:function(){return this.isStageControl&&"-"===this.model},model:{get:function(){return this.value},set:function(t){this.$emit("valueChanged",{identifier:this.permissionIdentifier,value:t})}},isStageControl:function(){return Boolean(this.permissionIdentifier.stageField)},getParentName:function(){var t=this.getAssignedAttribute({permissionCode:this.permissionIdentifier.permissionCode,entityCode:this.permissionIdentifier.entityCode})||"";return this.valuesMap[t]},isReadOnlyMode:function(){return"AUTOMATION"===this.permissionIdentifier.permissionCode&&"X"===this.getAssignedAttribute({permissionCode:"WRITE",entityCode:"CONFIG"})}}),methods:{toEditMode:function(t){t.stopPropagation(),this.isReadOnlyMode||(this.isEditMode=!0,main_core.Event.bind(window,"click",this.windowClickListener))},windowClickListener:function(t){t.target===this.$refs.componentRef||t.composedPath().includes(this.$refs.componentRef)||(this.isEditMode=!1,main_core.Event.unbind(window,"click",this.windowClickListener))}},template:'\n\t\t<div \n\t\t\tclass="bx-crm-perms-edit-permission_control"\n\t\t\tref="componentRef"\n\t\t>\n\t\t\t<div \n\t\t\t\tclass="bx-crm-perms-edit-permission_control-text"\n\t\t\t\t:class="{\'--readonly\': isReadOnlyMode, \'--inherited\': isInherited}"\n\t\t\t\tv-if="!isEditMode"\n\t\t\t\t@click="toEditMode"\n\t\t\t>{{ currentPermissionName }}</div>\n\t\t\t<select \n\t\t\t\tv-model="model" \n\t\t\t\tv-if="isEditMode" \n\t\t\t\tclass="bx-crm-perms-edit-permission_control-select"\n\t\t\t>\n\t\t\t\t<option \n\t\t\t\t\tclass="bx-crm-perms-edit-permission_control-select-option__grey" \n\t\t\t\t\tv-if="isStageControl" \n\t\t\t\t\tvalue="-"\n\t\t\t\t>{{ label.inherit }}</option>\n\t\t\t\t<option v-for="val in Object.keys(valuesMap)" :value="val">\n\t\t\t\t\t{{ valuesMap[val] }}\n\t\t\t\t</option>\n\t\t\t</select>\n\t\t</div>\n\t'};function entityHash(t){return t.stageField?"".concat(t.entityCode,"__").concat(t.stageField,"__").concat(t.stageCode):t.entityCode}function hashIdentifier(t){var e="".concat(t.entityCode,"__").concat(t.permissionCode);return t.stageField&&(e="".concat(e,"__").concat(t.stageField,"__").concat(t.stageCode)),btoa(e)}function ownKeys$1(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread$1(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ownKeys$1(Object(r),!0).forEach((function(e){babelHelpers.defineProperty(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ownKeys$1(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function _createForOfIteratorHelper(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=_unsupportedIterableToArray(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return s=t.done,t},e:function(t){a=!0,o=t},f:function(){try{s||null==r.return||r.return()}finally{if(a)throw o}}}}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var getters={permissionEntities:function(t){return t.desk.permissionEntities},permissionEntitiesExpanded:function(t){return t.desk.permissionEntities.filter((function(e){return!(e.stageField&&!t.ui.expandedStageEntities[e.entityCode])}))},getMainPermissionEntityByCode:function(t){return function(e){return t.desk.permissionEntities.find((function(t){return t.entityCode===e&&!t.stageField}))}},getEntitiesGroupedByPermission:function(t,e){return function(r){var n,i=e.getMainPermissionEntityByCode(r),o=t.desk.permissionEntities.filter((function(t){return t.entityCode===i.entityCode})),s=[],a=_createForOfIteratorHelper(o);try{for(a.s();!(n=a.n()).done;)for(var c=n.value,l=function(){var e=d[u];if(!Object.hasOwn(c.permissions,e))return"continue";var r=c.permissions[e],n=t.desk.availablePermissions.find((function(t){return t.code===e}));if(n.sortOrder<=MAX_SORT_ORDER_ON_THE_DESK)return"continue";s.push({code:e,name:n.name,values:r,isEntityStageSupport:c.hasStages,isPermissionStageSupport:n.canAssignPermissionToStages,stageField:c.stageField,stageCode:c.stageCode,stateName:c.name,sortOrder:parseInt(n.sortOrder,10)})},u=0,d=Object.keys(c.permissions);u<d.length;u++)l()}catch(t){a.e(t)}finally{a.f()}return s=s.sort((function(t,e){return t.sortOrder===e.sortOrder?0:t.sortOrder<e.sortOrder?-1:1}))}},availablePermissions:function(t){return t.desk.availablePermissions},getAssignedAttribute:function(t){return function(e){var r,n,i,o=e.permissionCode,s=e.entityCode,a=e.stageField,c=e.stageCode;if(a){var l,u,d,p,f=null===(l=t.roleAssignedPermissions)||void 0===l||null===(u=l[s])||void 0===u||null===(d=u[o])||void 0===d||null===(p=d[a])||void 0===p?void 0:p[c];return main_core.Type.isUndefined(f)&&(f="-"),f}return(null===(r=t.roleAssignedPermissions)||void 0===r||null===(n=r[s])||void 0===n||null===(i=n[o])||void 0===i?void 0:i["-"])||null}},isStageEntitiesVisible:function(t){return function(e){var r=entityHash(e);return Boolean(t.ui.expandedStageEntities[r])}},permissionsOnMainView:function(t){return t.desk.availablePermissions.filter((function(t){return t.sortOrder<=MAX_SORT_ORDER_ON_THE_DESK}))},hasTariffPermission:function(t){return t.restriction.hasPermission},getRestrictionScript:function(t){return t.restriction.restrictionScript},getAvailablePermissionsOrders:function(t){return t.desk.availablePermissionsOrders},getSaveData:function(t){for(var e=[],r=[],n=0,i=Object.keys(t.touched.touchedAttributes);n<i.length;n++){var o=i[n],s=t.touched.touchedAttributes[o];s.identifier.stageField?"-"===s.value?e.push(_objectSpread$1({},s.identifier)):r.push(_objectSpread$1(_objectSpread$1({},s.identifier),{},{value:s.value})):""===s.value?e.push(_objectSpread$1({},s.identifier)):r.push(_objectSpread$1(_objectSpread$1({},s.identifier),{},{value:s.value}))}for(var a=0,c=Object.keys(t.touched.touchedTransitions);a<c.length;a++){var l=c[a],u=t.touched.touchedTransitions[l];u.identifier.stageField?"-"===u.values?e.push(_objectSpread$1({},u.identifier)):r.push(_objectSpread$1(_objectSpread$1({},u.identifier),{},{settings:u.values})):0===u.values.length||1===u.values.length&&"INHERIT"===u.values[0]?e.push(_objectSpread$1({},u.identifier)):r.push(_objectSpread$1(_objectSpread$1({},u.identifier),{},{settings:u.values}))}return 0===t.role.id&&(appendDefaultAttributesPermissionsToChange(t,r),appendDefaultTransitionPermissionsToChange(t,r)),{id:t.role.id,name:t.role.name,permissions:{toRemove:e,toChange:r}}},getRoleName:function(t){return t.role.name},getRoleId:function(t){return t.role.id},isSaveInProgress:function(t){return t.ui.isSaveInProgress},getLastErrorMessage:function(t){return t.ui.lastErrorMessage},setSaveInProgress:function(t){return t.ui.isSaveInProgress},getTransitionSettings:function(t){return function(e){e.permissionCode;var r,n,i=e.entityCode,o=e.stageField,s=e.stageCode;if(o){var a,c,l,u=null===(a=t.transitions)||void 0===a||null===(c=a[i])||void 0===c||null===(l=c[o])||void 0===l?void 0:l[s];return main_core.Type.isUndefined(u)&&(u=["INHERIT"]),u}return(null===(r=t.transitions)||void 0===r||null===(n=r[i])||void 0===n?void 0:n["-"])||["BLOCKED"]}}};function appendDefaultAttributesPermissionsToChange(t,e){Object.keys(t.roleAssignedPermissions).forEach((function(r){var n,i=null!==(n=t.roleAssignedPermissions[r])&&void 0!==n?n:{};Object.keys(i).forEach((function(t){if("TRANSITION"!==t){var n=i[t],o=null==n?void 0:n["-"];if(main_core.Type.isString(o))e.find((function(e){return e.entityCode===r&&e.permissionCode===t&&main_core.Type.isUndefined(e.stageCode)}))||e.push({entityCode:r,permissionCode:t,value:o})}}))}))}function appendDefaultTransitionPermissionsToChange(t,e){for(var r=function(){var t=babelHelpers.slicedToArray(i[n],2),r=t[0],o=t[1];return Object.hasOwn(o,["-"])?e.find((function(t){return t.entityCode===r&&"TRANSITION"===t.permissionCode&&main_core.Type.isUndefined(t.stageCode)}))?{v:void 0}:void e.push({entityCode:r,permissionCode:"TRANSITION",settings:o["-"]}):{v:void 0}},n=0,i=Object.entries(t.transitions);n<i.length;n++){var o=r();if("object"===babelHelpers.typeof(o))return o.v}}function ownKeys$2(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread$2(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ownKeys$2(Object(r),!0).forEach((function(e){babelHelpers.defineProperty(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ownKeys$2(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var mutations={setInitData:function(t,e){t.roleAssignedPermissions=e.roleAssignedPermissions,t.desk.permissionEntities=e.permissionEntities,t.restriction.hasPermission=e.restriction.hasPermission,t.restriction.restrictionScript=e.restriction.restrictionScript,t.transitions=e.roleAssignedSettings;var r={},n=e.availablePermissions.map((function(t){var e=parseInt(t.sortOrder,10);return r[t.code]=e,_objectSpread$2(_objectSpread$2({},t),{},{sortOrder:e})}));t.desk.availablePermissionsOrders=r,t.desk.availablePermissions=n,t.role.id=parseInt(e.role.id,10),t.role.name=e.role.name,t.touched.originalAttributes=structuredClone(e.roleAssignedPermissions),t.touched.originalTransitions=structuredClone(e.roleAssignedSettings)},assignPermissionAttribute:function(t,e){setAssignedAttributes(t.roleAssignedPermissions,e.identifier,e.value),this.commit("setAttributeTouched",{identifier:e.identifier,value:e.value})},assignTransitions:function(t,e){setAssignedTransitions(t.transitions,e.identifier,e.values),this.commit("setTransitionsTouched",{identifier:e.identifier,values:e.values})},setAttributeTouched:function(t,e){var r,n,i,o,s,a,c,l=e.identifier.permissionCode,u=e.identifier.entityCode,d=e.identifier.stageField,p=e.identifier.stageCode,f=e.value,h="";d?h=null===(r=t.touched.originalAttributes)||void 0===r||null===(n=r[u])||void 0===n||null===(i=n[l])||void 0===i||null===(o=i[d])||void 0===o?void 0:o[p]:h=null===(s=t.touched.originalAttributes)||void 0===s||null===(a=s[u])||void 0===a||null===(c=a[l])||void 0===c?void 0:c["-"];var m=hashIdentifier(e.identifier);if(h===f)try{delete t.touched.touchedAttributes[m]}catch(t){}else t.touched.touchedAttributes[m]={value:f,identifier:e.identifier}},setTransitionsTouched:function(t,e){var r,n,i,o,s,a=e.identifier.entityCode,c=e.identifier.stageField,l=e.identifier.stageCode,u=e.values,d=[];c&&l?d=null===(r=t.touched.originalTransitions)||void 0===r||null===(n=r[a])||void 0===n||null===(i=n[c])||void 0===i?void 0:i[l]:d=null===(o=t.touched.originalTransitions)||void 0===o||null===(s=o[a])||void 0===s?void 0:s["-"];var p=hashIdentifier(e.identifier);if(main_core.Type.isArray(d)&&isArraysEqual(d,u))try{delete t.touched.touchedTransitions[p]}catch(t){}else t.touched.touchedTransitions[p]={values:u,identifier:e.identifier}},resetTouchedAttributes:function(t){t.touched.originalAttributes=JSON.parse(JSON.stringify(t.roleAssignedPermissions)),t.touched.touchedAttributes={}},resetTouchedTransitions:function(t){t.touched.originalTransitions=JSON.parse(JSON.stringify(t.transitions)),t.touched.touchedTransitions={}},toggleStagesVisibility:function(t,e){var r=entityHash(e);t.ui.expandedStageEntities[r]?delete t.ui.expandedStageEntities[r]:t.ui.expandedStageEntities[r]=!0},setRoleName:function(t,e){t.role.name=e},setSaveInProgress:function(t,e){t.ui.isSaveInProgress=e},setLastErrorMessage:function(t,e){t.ui.lastErrorMessage=e}};function setAssignedAttributes(t,e,r){var n=e.permissionCode,i=e.entityCode,o=e.stageField,s=e.stageCode;if(t[i]||(t[i]={}),t[i][n]||(t[i][n]={}),o)return t[i][n][o]||(t[i][n][o]={}),void(t[i][n][o][s]=r);""===r?delete t[i][n]["-"]:t[i][n]["-"]=r,clearEmptyNodes(t)}function clearEmptyNodes(t,e,r){if(main_core.Type.isObject(t)){for(var n=0,i=Object.entries(t);n<i.length;n++){var o=babelHelpers.slicedToArray(i[n],2),s=o[0],a=o[1];isObjectEmpty(a)?delete t[s]:clearEmptyNodes(a,s,t)}r&&isObjectEmpty(t)&&delete r[e]}}function isObjectEmpty(t){return!t||0===Object.keys(t).length}function setAssignedTransitions(t,e,r){var n=e.entityCode,i=e.stageField,o=e.stageCode;if(t[n]||(t[n]={}),i&&o)return t[n][i]||(t[n][i]={}),void(t[n][i][o]=r);""===r?delete t[n]["-"]:t[n]["-"]=r,clearEmptyNodes(t)}function isArraysEqual(t,e){return t.sort().toString()===e.sort().toString()}function _regeneratorRuntime(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */_regeneratorRuntime=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,i){var o=e&&e.prototype instanceof p?e:p,s=Object.create(o.prototype),a=new P(i||[]);return n(s,"_invoke",{value:E(t,r,a)}),s}function u(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=l;var d={};function p(){}function f(){}function h(){}var m={};c(m,o,(function(){return this}));var v=Object.getPrototypeOf,g=v&&v(v(T([])));g&&g!==e&&r.call(g,o)&&(m=g);var y=h.prototype=p.prototype=Object.create(m);function b(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function _(t,e){var i;n(this,"_invoke",{value:function(n,o){function s(){return new e((function(i,s){!function n(i,o,s,a){var c=u(t[i],t,o);if("throw"!==c.type){var l=c.arg,d=l.value;return d&&"object"==babelHelpers.typeof(d)&&r.call(d,"__await")?e.resolve(d.__await).then((function(t){n("next",t,s,a)}),(function(t){n("throw",t,s,a)})):e.resolve(d).then((function(t){l.value=t,s(l)}),(function(t){return n("throw",t,s,a)}))}a(c.arg)}(n,o,i,s)}))}return i=i?i.then(s,s):s()}})}function E(t,e,r){var n="suspendedStart";return function(i,o){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw o;return x()}for(r.method=i,r.arg=o;;){var s=r.delegate;if(s){var a=w(s,r);if(a){if(a===d)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var c=u(t,e,r);if("normal"===c.type){if(n=r.done?"completed":"suspendedYield",c.arg===d)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n="completed",r.method="throw",r.arg=c.arg)}}}function w(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),d;var i=u(n,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,d;var o=i.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,d):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,d)}function O(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function S(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(O,this),this.reset(!0)}function T(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,i=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:x}}function x(){return{value:void 0,done:!0}}return f.prototype=h,n(y,"constructor",{value:h,configurable:!0}),n(h,"constructor",{value:f,configurable:!0}),f.displayName=c(h,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,h):(t.__proto__=h,c(t,a,"GeneratorFunction")),t.prototype=Object.create(y),t},t.awrap=function(t){return{__await:t}},b(_.prototype),c(_.prototype,s,(function(){return this})),t.AsyncIterator=_,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var s=new _(l(e,r,n,i),o);return t.isGeneratorFunction(r)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},b(y),c(y,a,"Generator"),c(y,o,(function(){return this})),c(y,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=T,P.prototype={constructor:P,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return s.type="throw",s.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],s=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var a=r.call(o,"catchLoc"),c=r.call(o,"finallyLoc");if(a&&c){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=t,s.arg=e,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),S(r),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var i=n.arg;S(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:T(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),d}},t}var actions={saveRolePermission:function(t,e){return babelHelpers.asyncToGenerator(_regeneratorRuntime().mark((function r(){var n,i,o,s,a,c,l,u,d;return _regeneratorRuntime().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n=t.commit,!(i=t.getters).setSaveInProgress){r.next=3;break}return r.abrupt("return");case 3:return n("setSaveInProgress",!0),n("setLastErrorMessage",""),r.prev=5,r.next=8,BX.ajax.runComponentAction("bitrix:crm.config.perms.role.edit.v2","save",{mode:"class",json:{values:i.getSaveData}});case 8:if(a=r.sent,c=null==a||null===(o=a.data)||void 0===o?void 0:o.redirectUrl,l=null==a||null===(s=a.data)||void 0===s?void 0:s.roleUrl,"save"!==e||!c){r.next=14;break}return window.location.href=c,r.abrupt("return");case 14:if("apply"!==e||!l||0!==i.getRoleId){r.next=17;break}return window.location.href=l,r.abrupt("return");case 17:n("resetTouchedAttributes"),n("resetTouchedTransitions"),r.next=25;break;case 21:r.prev=21,r.t0=r.catch(5),d=null===r.t0||void 0===r.t0||null===(u=r.t0.data)||void 0===u?void 0:u.message,n("setLastErrorMessage",d);case 25:return r.prev=25,n("setSaveInProgress",!1),r.finish(25);case 28:case"end":return r.stop()}}),r,null,[[5,21,25,28]])})))()},deleteRole:function(t){return babelHelpers.asyncToGenerator(_regeneratorRuntime().mark((function e(){var r,n,i,o,s,a,c,l;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.commit,!(n=t.getters).setSaveInProgress){e.next=3;break}return e.abrupt("return");case 3:if(i=n.getRoleId){e.next=6;break}return e.abrupt("return");case 6:return r("setSaveInProgress",!0),r("setLastErrorMessage",""),e.prev=8,e.next=11,BX.ajax.runComponentAction("bitrix:crm.config.perms.role.edit.v2","delete",{mode:"class",json:{values:{roleId:i}}});case 11:s=e.sent,(a=null==s||null===(o=s.data)||void 0===o?void 0:o.redirectUrl)||(a="/"),window.location.href=a,e.next=21;break;case 17:e.prev=17,e.t0=e.catch(8),l=null===e.t0||void 0===e.t0||null===(c=e.t0.data)||void 0===c?void 0:c.message,r("setLastErrorMessage",l);case 21:return e.prev=21,r("setSaveInProgress",!1),e.finish(21);case 24:case"end":return e.stop()}}),e,null,[[8,17,21,24]])})))()}},MAX_SORT_ORDER_ON_THE_DESK=7;function initState(){return{ui:{expandedStageEntities:{},isSaveInProgress:!1,lastErrorMessage:""},roleAssignedPermissions:{},restriction:{hasPermission:null,restrictionScript:""},role:{id:0,name:""},desk:{availablePermissions:[],permissionEntities:[],availablePermissionsOrders:{}},touched:{originalAttributes:{},touchedAttributes:{},originalTransitions:{},touchedTransitions:{}},transitions:{}}}var store=function(){return{state:initState(),getters:getters,mutations:mutations,actions:actions}},ANY_VALUE="ANY",BLOCKED_VALUE="BLOCKED",INHERIT_VALUE="INHERIT",EntityControl={name:"EntityControl",entitySelector:null,props:{values:{type:Array,required:!0},valuesMap:{type:Object,required:!0},permissionIdentifier:{type:Object,required:!0}},emits:["onTransitionValuesChanged"],data:function(){return{label:{any:main_core.Loc.getMessage("CRM_PERMS_EDIT_ENTITIES_ANY"),blocked:main_core.Loc.getMessage("CRM_PERMS_EDIT_ENTITIES_BLOCKED"),inherit:main_core.Loc.getMessage("CRM_PERMS_EDIT_ENTITIES_INHERIT"),stages:main_core.Loc.getMessage("CRM_PERMS_EDIT_ENTITIES_STAGES")},isEditMode:!1,valuesData:this.values}},computed:{isStageControl:function(){return Boolean(this.permissionIdentifier.stageField)},isInherited:function(){return this.isStageControl&&this.currentValues.some((function(t){return t.id===INHERIT_VALUE}))},currentValues:{get:function(){var t=this;return main_core.Type.isArray(this.valuesData)?this.availableValues.filter((function(e){return t.valuesData.includes(e.id)})):[]},set:function(t){this.valuesData=t.map((function(t){return t.id})),this.$emit("onTransitionValuesChanged",{identifier:this.permissionIdentifier,values:this.valuesData})}},availableValues:function(){for(var t=[{id:BLOCKED_VALUE,entityId:"stages",tabs:"stages_tab",title:this.label.blocked}],e=0,r=Object.entries(this.valuesMap);e<r.length;e++){var n=babelHelpers.slicedToArray(r[e],2),i=n[0],o=n[1];i===INHERIT_VALUE&&main_core.Type.isUndefined(this.permissionIdentifier.stageField)&&main_core.Type.isUndefined(this.permissionIdentifier.stageCode)||i===this.permissionIdentifier.stageCode||t.push({id:i,entityId:"stages",tabs:"stages_tab",title:o})}return t}},methods:{toEditMode:function(){this.isEditMode=!0},onHideDialogEvent:function(){if(0===this.entitySelector.getTags().length){var t={id:ANY_VALUE,entityId:"stages",tabs:"stages_tab",title:this.label.any};this.isStageControl&&(t.id=INHERIT_VALUE,t.title=this.label.inherit),this.entitySelector.addTag(t)}this.currentValues=this.entitySelector.getTags(),this.isEditMode=this.entitySelector.getDialog().isOpen()},readOnlyLabels:function(){return this.currentValues.map((function(t){return t.title})).join(", ")},clickSomewhere:function(){this.isEditMode&&!this.entitySelector.getDialog().isOpen()&&(this.isEditMode=!1,this.onHideDialogEvent())},getDialogOptions:function(){return{multiple:!0,items:this.availableValues,selectedItems:this.currentValues,dropdownMode:!1,height:300,showAvatars:!1,tabs:[{id:"stages_tab",title:this.label.stages}],recentTabOptions:{visible:!1},events:{onHide:this.onHideDialogEvent}}},selectorOnBeforeTagAdd:function(t){var e=t.getTarget(),r=t.getData().tag,n=new Set([ANY_VALUE,INHERIT_VALUE,BLOCKED_VALUE]);n.has(r.getId())?e.removeTags():e.getTags().forEach((function(t){n.has(t.getId())&&e.removeTag(t)}))}},mounted:function(){this.entitySelector=new ui_entitySelector.TagSelector({events:{onBeforeTagAdd:this.selectorOnBeforeTagAdd,onAfterTagRemove:this.onHideDialogEvent},dialogOptions:this.getDialogOptions()}),this.entitySelector.renderTo(this.$refs.entitySelectorRef)},created:function(){main_core.Event.bind(window,"click",this.clickSomewhere)},destroyed:function(){main_core.Event.unbind(window,"click",this.clickSomewhere)},template:'\n\t\t<div class="bx-crm-perms-edit-entity_control">\n\t\t\t<div\n\t\t\t\tclass="bx-crm-perms-edit-entity_control-text"\n\t\t\t\t:class="{\'--inherited\': isInherited}"\n\t\t\t\tdata-role="crm-type-relation-parent-selected-values"\n\t\t\t\t@click.stop="toEditMode"\n\t\t\t\tv-if="!isEditMode"\n\t\t\t>{{ readOnlyLabels() }}\n\t\t\t</div>\n\t\t\t<div\n\t\t\t\tref="entitySelectorRef"\n\t\t\t\tdata-role="crm-type-relation-parent-entity-selector"\n\t\t\t\tv-show="isEditMode"\n\t\t\t></div>\n\t\t</div>\n\t'};function ownKeys$3(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread$3(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ownKeys$3(Object(r),!0).forEach((function(e){babelHelpers.defineProperty(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ownKeys$3(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var SliderPermissions={name:"SliderPermissions",props:{entityCode:{required:!0,type:String}},components:{ExpandControl:ExpandControl,PermissionControl:PermissionControl,EntityControl:EntityControl},data:function(){return{ui:{stageVisibilityCodes:{}}}},computed:_objectSpread$3(_objectSpread$3({},ui_vue3_vuex.mapGetters(["getEntitiesGroupedByPermission","getAssignedAttribute","getTransitionSettings"])),{},{permissions:function(){return this.getEntitiesGroupedByPermission(this.entityCode)},displayList:function(){var t=this;return this.permissions.filter((function(e){return!e.stageField||t.ui.stageVisibilityCodes[e.code]}))},isShowExpandControl:function(){return function(t){return!t.stageField&&(!!t.isEntityStageSupport&&!!t.isPermissionStageSupport)}},getName:function(){return function(t){return t.stageField?t.stateName:t.name}},identifier:function(t){return this.getIdentifier(t.code,t.stageField,t.stageCode)}}),mounted:function(){},methods:_objectSpread$3(_objectSpread$3({},ui_vue3_vuex.mapMutations(["assignPermissionAttribute","assignTransitions"])),{},{onToggleStageVisibility:function(t){this.ui.stageVisibilityCodes[t]?delete this.ui.stageVisibilityCodes[t]:this.ui.stageVisibilityCodes[t]=!0},isExpanded:function(t){return this.ui.stageVisibilityCodes[t]||!1},isRowStageRow:function(t){return Boolean(t.stageField)},getAttributeValue:function(t){return this.getAssignedAttribute(t)||""},onAttributeValueChanged:function(t){this.assignPermissionAttribute({identifier:t.identifier,value:t.value})},getIdentifier:function(t,e,r){return{permissionCode:t,entityCode:this.entityCode,stageField:e,stageCode:r}},onTransitionValuesChanged:function(t){this.assignTransitions({identifier:t.identifier,values:t.values})}}),template:'\n\t\t<div class="bx-crm-perms-edit-entity-permissions">\n\t\t\t<div\n\t\t\t\tv-for="perm of displayList"\n\t\t\t\tclass="bx-crm-perms-edit-entity-permissions-item"\n\t\t\t\t:data-permission-code="perm.code"\n\t\t\t\t:class="{\'stage-item\': isRowStageRow(perm)}"\n\t\t\t>\n\t\t\t\t<div class="bx-crm-perms-edit-entity-permissions-item__column">\n\t\t\t\t\t<ExpandControl \n\t\t\t\t\t\tv-if="isShowExpandControl(perm)"\n\t\t\t\t\t\t:is-expanded="isExpanded(perm.code)"\n\t\t\t\t\t\t@toggle="onToggleStageVisibility(perm.code)"\n\t\t\t\t\t/>\n\t\t\t\t\t<span :class="{\'small-label\': isRowStageRow(perm)}">\n\t\t\t\t\t\t{{ getName(perm) }}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div class="bx-crm-perms-edit-entity-permissions-item__column">\n\t\t\t\t\t<PermissionControl\n\t\t\t\t\t\t:value="getAttributeValue(getIdentifier(perm.code, perm.stageField, perm.stageCode))"\n\t\t\t\t\t\t:values-map="perm.values"\n\t\t\t\t\t\t:permission-identifier="getIdentifier(perm.code, perm.stageField, perm.stageCode)"\n\t\t\t\t\t\t@value-changed="onAttributeValueChanged"\n\t\t\t\t\t\tv-if="perm.code !== \'TRANSITION\'"\n\t\t\t\t\t/>\n\t\t\t\t\t<EntityControl\n\t\t\t\t\t\tv-if="perm.code === \'TRANSITION\'"\n\t\t\t\t\t\t:values="getTransitionSettings(getIdentifier(perm.code, perm.stageField, perm.stageCode))"\n\t\t\t\t\t\t@onTransitionValuesChanged="onTransitionValuesChanged"\n\t\t\t\t\t\t:values-map="perm.values"\n\t\t\t\t\t\t:permission-identifier="getIdentifier(perm.code, perm.stageField, perm.stageCode)"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t'};function ownKeys$4(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread$4(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ownKeys$4(Object(r),!0).forEach((function(e){babelHelpers.defineProperty(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ownKeys$4(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function _regeneratorRuntime$1(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */_regeneratorRuntime$1=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,i){var o=e&&e.prototype instanceof p?e:p,s=Object.create(o.prototype),a=new P(i||[]);return n(s,"_invoke",{value:E(t,r,a)}),s}function u(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=l;var d={};function p(){}function f(){}function h(){}var m={};c(m,o,(function(){return this}));var v=Object.getPrototypeOf,g=v&&v(v(T([])));g&&g!==e&&r.call(g,o)&&(m=g);var y=h.prototype=p.prototype=Object.create(m);function b(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function _(t,e){var i;n(this,"_invoke",{value:function(n,o){function s(){return new e((function(i,s){!function n(i,o,s,a){var c=u(t[i],t,o);if("throw"!==c.type){var l=c.arg,d=l.value;return d&&"object"==babelHelpers.typeof(d)&&r.call(d,"__await")?e.resolve(d.__await).then((function(t){n("next",t,s,a)}),(function(t){n("throw",t,s,a)})):e.resolve(d).then((function(t){l.value=t,s(l)}),(function(t){return n("throw",t,s,a)}))}a(c.arg)}(n,o,i,s)}))}return i=i?i.then(s,s):s()}})}function E(t,e,r){var n="suspendedStart";return function(i,o){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw o;return x()}for(r.method=i,r.arg=o;;){var s=r.delegate;if(s){var a=w(s,r);if(a){if(a===d)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var c=u(t,e,r);if("normal"===c.type){if(n=r.done?"completed":"suspendedYield",c.arg===d)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n="completed",r.method="throw",r.arg=c.arg)}}}function w(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),d;var i=u(n,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,d;var o=i.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,d):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,d)}function O(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function S(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(O,this),this.reset(!0)}function T(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,i=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:x}}function x(){return{value:void 0,done:!0}}return f.prototype=h,n(y,"constructor",{value:h,configurable:!0}),n(h,"constructor",{value:f,configurable:!0}),f.displayName=c(h,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,h):(t.__proto__=h,c(t,a,"GeneratorFunction")),t.prototype=Object.create(y),t},t.awrap=function(t){return{__await:t}},b(_.prototype),c(_.prototype,s,(function(){return this})),t.AsyncIterator=_,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var s=new _(l(e,r,n,i),o);return t.isGeneratorFunction(r)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},b(y),c(y,a,"Generator"),c(y,o,(function(){return this})),c(y,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=T,P.prototype={constructor:P,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return s.type="throw",s.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],s=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var a=r.call(o,"catchLoc"),c=r.call(o,"finallyLoc");if(a&&c){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=t,s.arg=e,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),S(r),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var i=n.arg;S(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:T(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),d}},t}function _classPrivateMethodInitSpec(t,e){_checkPrivateRedeclaration(t,e),e.add(t)}function _classPrivateFieldInitSpec(t,e,r){_checkPrivateRedeclaration(t,e),e.set(t,r)}function _checkPrivateRedeclaration(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateMethodGet(t,e,r){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return r}var _url=new WeakMap,_containerId=new WeakMap,_sliderApplication=new WeakMap,_getOptions=new WeakSet,_closeApplication=new WeakSet,_createApplication=new WeakSet,SliderManager=function(){function t(e,r){babelHelpers.classCallCheck(this,t),_classPrivateMethodInitSpec(this,_createApplication),_classPrivateMethodInitSpec(this,_closeApplication),_classPrivateMethodInitSpec(this,_getOptions),_classPrivateFieldInitSpec(this,_url,{writable:!0,value:void 0}),_classPrivateFieldInitSpec(this,_containerId,{writable:!0,value:void 0}),_classPrivateFieldInitSpec(this,_sliderApplication,{writable:!0,value:void 0});var n=Math.round(1e4*Math.random());babelHelpers.classPrivateFieldSet(this,_url,"bx-crm-perms-role-edit-slider__".concat(Date.now())),babelHelpers.classPrivateFieldSet(this,_containerId,"bx-crm-perms-role-edit-slider-container__".concat(Date.now(),"__").concat(n)),babelHelpers.classPrivateFieldSet(this,_sliderApplication,_classPrivateMethodGet(this,_createApplication,_createApplication2).call(this,e)),babelHelpers.classPrivateFieldGet(this,_sliderApplication).use(r)}var e;return babelHelpers.createClass(t,[{key:"open",value:(e=babelHelpers.asyncToGenerator(_regeneratorRuntime$1().mark((function t(){return _regeneratorRuntime$1().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=ui_sidepanel.SidePanel.Instance,t.t1=babelHelpers.classPrivateFieldGet(this,_url),t.next=4,_classPrivateMethodGet(this,_getOptions,_getOptions2).call(this);case 4:t.t2=t.sent,t.t0.open.call(t.t0,t.t1,t.t2);case 6:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"close",value:function(){}}],[{key:"create",value:function(e,r){return new t(e,r)}}]),t}();function _getOptions2(){return _getOptions3.apply(this,arguments)}function _getOptions3(){return(_getOptions3=babelHelpers.asyncToGenerator(_regeneratorRuntime$1().mark((function t(){var e,r,n=this;return _regeneratorRuntime$1().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=[new ui_buttons.Button({text:main_core.Loc.getMessage("UI_BUTTONS_CLOSE_BTN_TEXT"),size:ui_buttons.Button.Size.MEDIUM,color:ui_buttons.Button.Color.LIGHT_BORDER,dependOnTheme:!1,onclick:function(){_classPrivateMethodGet(n,_closeApplication,_closeApplication2).call(n),ui_sidepanel.SidePanel.Instance.close()}})],t.next=3,ui_sidepanel_layout.Layout.createLayout({title:"",content:function(){return'<div id="'.concat(babelHelpers.classPrivateFieldGet(n,_containerId),'"></div>')},buttons:function(){return e},design:{section:!1}});case 3:return r=t.sent,t.abrupt("return",{contentClassName:"",allowChangeTitle:!1,width:800,cacheable:!1,allowChangeHistory:!1,label:"",contentCallback:function(t){return r.render()},events:{onOpenComplete:function(){var t=document.getElementById(babelHelpers.classPrivateFieldGet(n,_containerId));babelHelpers.classPrivateFieldGet(n,_sliderApplication).mount(t)},onClose:function(){_classPrivateMethodGet(n,_closeApplication,_closeApplication2).call(n)}}});case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function _closeApplication2(){babelHelpers.classPrivateFieldGet(this,_sliderApplication)&&(babelHelpers.classPrivateFieldGet(this,_sliderApplication).unmount(),babelHelpers.classPrivateFieldSet(this,_sliderApplication,null))}function _createApplication2(t){return ui_vue3.BitrixVue.createApp({name:"CrmConfigPermsRoleEditSlider",components:{SliderPermissions:SliderPermissions},props:{entityCode:{required:!0,type:String}},computed:_objectSpread$4(_objectSpread$4({},ui_vue3_vuex.mapGetters(["permissionEntities","getMainPermissionEntityByCode"])),{},{entity:function(){return this.getMainPermissionEntityByCode(this.entityCode)},entityName:function(){var t;return(null==this||null===(t=this.entity)||void 0===t?void 0:t.name)||""}}),methods:_objectSpread$4({},ui_vue3_vuex.mapMutations(["assignPermissionAttribute"])),template:'\n\t\t\t\t<div class="bx-crm-perms-edit-slider">\n\t\t\t\t\t<h1>{{ entityName }}</h1>\n\t\t\t\t\t<SliderPermissions\n\t\t\t\t\t\t:entity-code="entityCode"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t'},{entityCode:t})}function ownKeys$5(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread$5(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ownKeys$5(Object(r),!0).forEach((function(e){babelHelpers.defineProperty(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ownKeys$5(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var Row={name:"Row",props:{entity:Object},data:function(){return{labels:{moreName:main_core.Loc.getMessage("CRM_PERMS_EDIT_ENTITIES_MORE")},maxOrder:0}},components:{PermissionControl:PermissionControl,ExpandControl:ExpandControl},computed:_objectSpread$5(_objectSpread$5({},ui_vue3_vuex.mapGetters(["availablePermissions","isStageEntitiesVisible","getAssignedAttribute","permissionsOnMainView","groupEntityPermission","getAvailablePermissionsOrders"])),{},{isExpandedStages:function(){return this.isStageEntitiesVisible(this.entity)},isShowMore:function(){return this.maxOrder>MAX_SORT_ORDER_ON_THE_DESK}}),mounted:function(){for(var t=0,e=0,r=Object.keys(this.entity.permissions);e<r.length;e++){var n=r[e];t=Math.max(t,this.getAvailablePermissionsOrders[n]||0)}this.maxOrder=t},methods:_objectSpread$5(_objectSpread$5({},ui_vue3_vuex.mapMutations(["toggleStagesVisibility","assignPermissionAttribute","setEditMode"])),{},{expandChanged:function(){this.toggleStagesVisibility(this.entity)},openSlider:function(){SliderManager.create(this.entity.entityCode,this.$store).open()},attributeValue:function(t){var e=this.getIdentifier(t);return this.getAssignedAttribute(e)||""},onAttributeValueChanged:function(t){this.assignPermissionAttribute({identifier:t.identifier,value:t.value})},getIdentifier:function(t){return{permissionCode:t,entityCode:this.entity.entityCode,stageField:this.entity.stageField,stageCode:this.entity.stageCode}},isShowControl:function(t){return!!this.entity.permissions[t.code]&&(!this.entity.stageField||!1!==t.canAssignPermissionToStages)}}),template:'\n\t\t<tr \n\t\t\tclass="bx-crm-perms-desk-row bx-crm-perms-edit-desk__body"\n\t\t>\n\t\t\t<td class="bx-crm-perms-desk-row-item">\n\t\t\t\t<ExpandControl \n\t\t\t\t\tv-if="entity.hasStages" \n\t\t\t\t\t:is-expanded="isExpandedStages" \n\t\t\t\t\t@toggle="expandChanged" \n\t\t\t\t/> \n\t\t\t\t<span :class="{\'stage-row\': !!entity.stageField}">{{ entity.name }}</span>\n\t\t\t</td>\n\t\t\t<td\n\t\t\t\tv-for="perm of permissionsOnMainView"\n\t\t\t\tclass="bx-crm-perms-desk-row-item"\n\t\t\t\t:data-permission-code="perm.code"\n\t\t\t\t:data-permission-entity="entity.entityCode"\n\t\t\t\t:data-permission-attr-field="entity.stageField"\n\t\t\t\t:data-permission-attr-value="entity.stageCode"\n\t\t\t>\n\t\t\t\t<PermissionControl\n\t\t\t\t\tv-if="isShowControl(perm)"\n\t\t\t\t\t:value="attributeValue(perm.code)"\n\t\t\t\t\t:values-map="entity.permissions[perm.code]"\n\t\t\t\t\t:permission-identifier="getIdentifier(perm.code)"\n\t\t\t\t\t@value-changed="onAttributeValueChanged"\n\t\t\t\t></PermissionControl>\n\t\t\t</td>\n\t\t\t<td \n\t\t\t\tv-if="!entity.stageField"\n\t\t\t\tclass="bx-crm-perms-desk-row-item"\n\t\t\t\tdata-permission-code="MORE"\n\t\t\t\t:data-permission-entity="entity.entityCode"\n\t\t\t>\n\t\t\t\t<span\n\t\t\t\t\tv-if="isShowMore"\n\t\t\t\t\tclass="bx-crm-perms-edit-permission_control-text bx-crm-perms-desk-row-more"\n\t\t\t\t\t@click="openSlider"\n\t\t\t\t>\n\t\t\t\t\t{{ labels.moreName }}\n\t\t\t\t</span>\n\t\t\t</td>\n\t\t</tr>\n\t'};function ownKeys$6(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread$6(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ownKeys$6(Object(r),!0).forEach((function(e){babelHelpers.defineProperty(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ownKeys$6(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var Desk={name:"Desk",components:{PermissionControl:PermissionControl,Row:Row},data:function(){return{labels:{allowToChangeConfigName:main_core.Loc.getMessage("CRM_PERMS_EDIT_ALLOW_TO_CHANGE_CONFIG"),saveName:main_core.Loc.getMessage("CRM_PERMS_EDIT_ENTITIES_SAVE"),applyName:main_core.Loc.getMessage("CRM_PERMS_EDIT_ENTITIES_APPLY"),roleName:main_core.Loc.getMessage("CRM_PERMS_EDIT_ENTITIES_ROLE"),notAllowedByTariff:main_core.Loc.getMessage("CRM_PERMS_EDIT_RESTRICTION"),roleDelete:main_core.Loc.getMessage("CRM_PERMS_EDIT_ROLE_DELETE"),additionalName:main_core.Loc.getMessage("CRM_PERMS_EDIT_ENTITIES_ADDITIONAL")}}},computed:_objectSpread$6(_objectSpread$6({},ui_vue3_vuex.mapGetters(["permissionEntitiesExpanded","permissionsOnMainView","getAssignedAttribute"])),{},{configWrite:{get:function(){return"X"===this.getAssignedAttribute({permissionCode:"WRITE",entityCode:"CONFIG"})},set:function(t){this.assignPermissionAttribute({value:t?"X":"",identifier:{permissionCode:"WRITE",entityCode:"CONFIG"}})}},columnsCount:function(){return MAX_SORT_ORDER_ON_THE_DESK+2}}),methods:_objectSpread$6(_objectSpread$6({},ui_vue3_vuex.mapMutations(["assignPermissionAttribute"])),{},{getStages:function(t){return t.fields.STAGE_ID||{}}}),mounted:function(){},template:'\n\t\t<table class="bx-crm-perms-edit-desk">\n\t\t\t<tr class="bx-crm-perms-desk-row bx-crm-perms-edit-desk__head">\n\t\t\t\t<th class="bx-crm-perms-desk-row-item"></th>\n\t\t\t\t<th\n\t\t\t\t\tv-for="perm in permissionsOnMainView"\n\t\t\t\t\t:key="perm.code"\n\t\t\t\t\tclass="bx-crm-perms-desk-row-item"\n\t\t\t\t>\n\t\t\t\t\t{{ perm.name }}\n\t\t\t\t</th>\n\t\t\t\t<th class="bx-crm-perms-desk-row-item">\n\t\t\t\t\t{{ labels.additionalName }}\n\t\t\t\t</th>\n\t\t\t</tr>\n\n\t\t\t<Row v-for="permissionEntity of permissionEntitiesExpanded" :entity="permissionEntity" />\n\n\t\t\t<tr class="bx-crm-perms-desk-row bx-crm-perms-edit-desk__footer">\n\t\t\t\t<td class="bx-crm-perms-desk-row-item" :colspan="columnsCount">\n\t\t\t\t\t<label>\n\t\t\t\t\t\t<input name="WRITE" type="checkbox" v-model="configWrite">\n\t\t\t\t\t\t{{ labels.allowToChangeConfigName }}\n\t\t\t\t\t</label>\n\t\t\t\t</td>\n\t\t\t</tr>\n\t\t</table>\n\t'},Loader={name:"Loader",mounted:function(){var t=new ui_loader.Loader({target:this.$refs.loaderRef,type:"BULLET",size:"XL"});t.render(),t.show()},template:'\n\t\t<div>\n\t\t\t<div class="bx-crm-perms-edit-loader"></div>\n\t\t\t<div class="bx-crm-perms-edit-loader-progress" ref="loaderRef"></div>\n\t\t</div>\n\t'};function _regeneratorRuntime$2(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */_regeneratorRuntime$2=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,i){var o=e&&e.prototype instanceof p?e:p,s=Object.create(o.prototype),a=new P(i||[]);return n(s,"_invoke",{value:E(t,r,a)}),s}function u(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=l;var d={};function p(){}function f(){}function h(){}var m={};c(m,o,(function(){return this}));var v=Object.getPrototypeOf,g=v&&v(v(T([])));g&&g!==e&&r.call(g,o)&&(m=g);var y=h.prototype=p.prototype=Object.create(m);function b(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function _(t,e){var i;n(this,"_invoke",{value:function(n,o){function s(){return new e((function(i,s){!function n(i,o,s,a){var c=u(t[i],t,o);if("throw"!==c.type){var l=c.arg,d=l.value;return d&&"object"==babelHelpers.typeof(d)&&r.call(d,"__await")?e.resolve(d.__await).then((function(t){n("next",t,s,a)}),(function(t){n("throw",t,s,a)})):e.resolve(d).then((function(t){l.value=t,s(l)}),(function(t){return n("throw",t,s,a)}))}a(c.arg)}(n,o,i,s)}))}return i=i?i.then(s,s):s()}})}function E(t,e,r){var n="suspendedStart";return function(i,o){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw o;return x()}for(r.method=i,r.arg=o;;){var s=r.delegate;if(s){var a=w(s,r);if(a){if(a===d)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var c=u(t,e,r);if("normal"===c.type){if(n=r.done?"completed":"suspendedYield",c.arg===d)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n="completed",r.method="throw",r.arg=c.arg)}}}function w(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),d;var i=u(n,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,d;var o=i.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,d):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,d)}function O(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function S(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(O,this),this.reset(!0)}function T(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,i=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:x}}function x(){return{value:void 0,done:!0}}return f.prototype=h,n(y,"constructor",{value:h,configurable:!0}),n(h,"constructor",{value:f,configurable:!0}),f.displayName=c(h,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,h):(t.__proto__=h,c(t,a,"GeneratorFunction")),t.prototype=Object.create(y),t},t.awrap=function(t){return{__await:t}},b(_.prototype),c(_.prototype,s,(function(){return this})),t.AsyncIterator=_,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var s=new _(l(e,r,n,i),o);return t.isGeneratorFunction(r)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},b(y),c(y,a,"Generator"),c(y,o,(function(){return this})),c(y,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=T,P.prototype={constructor:P,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return s.type="throw",s.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],s=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var a=r.call(o,"catchLoc"),c=r.call(o,"finallyLoc");if(a&&c){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=t,s.arg=e,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),S(r),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var i=n.arg;S(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:T(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),d}},t}function ownKeys$7(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread$7(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ownKeys$7(Object(r),!0).forEach((function(e){babelHelpers.defineProperty(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ownKeys$7(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var Main={name:"Main",components:{Desk:Desk,Loader:Loader},data:function(){return{labels:{saveName:main_core.Loc.getMessage("CRM_PERMS_EDIT_ENTITIES_SAVE"),applyName:main_core.Loc.getMessage("CRM_PERMS_EDIT_ENTITIES_APPLY"),roleName:main_core.Loc.getMessage("CRM_PERMS_EDIT_ENTITIES_ROLE"),notAllowedByTariff:main_core.Loc.getMessage("CRM_PERMS_EDIT_RESTRICTION"),roleDelete:main_core.Loc.getMessage("CRM_PERMS_EDIT_ROLE_DELETE")}}},computed:_objectSpread$7(_objectSpread$7({},ui_vue3_vuex.mapGetters(["hasTariffPermission","getRoleName","getRestrictionScript","getLastErrorMessage","getRoleId","isSaveInProgress"])),{},{roleName:{get:function(){return this.getRoleName},set:function(t){this.setRoleName(t)}},isShowDeleteBtn:function(){return this.getRoleId>0}}),methods:_objectSpread$7(_objectSpread$7(_objectSpread$7({},ui_vue3_vuex.mapMutations(["setRoleName"])),ui_vue3_vuex.mapActions(["saveRolePermission","deleteRole"])),{},{onPressSave:function(){var t=this;return babelHelpers.asyncToGenerator(_regeneratorRuntime$2().mark((function e(){return _regeneratorRuntime$2().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.performSave("save");case 2:case"end":return e.stop()}}),e)})))()},onPressApply:function(){var t=this;return babelHelpers.asyncToGenerator(_regeneratorRuntime$2().mark((function e(){return _regeneratorRuntime$2().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.performSave("apply");case 2:case"end":return e.stop()}}),e)})))()},onPressDeleteRole:function(){var t=this;return babelHelpers.asyncToGenerator(_regeneratorRuntime$2().mark((function e(){return _regeneratorRuntime$2().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.hasTariffPermission||t.executeTariffRestrictionScript(),e.next=3,t.deleteRole();case 3:case"end":return e.stop()}}),e)})))()},performSave:function(t){var e=this;return babelHelpers.asyncToGenerator(_regeneratorRuntime$2().mark((function r(){return _regeneratorRuntime$2().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return e.hasTariffPermission||e.executeTariffRestrictionScript(),r.next=3,e.saveRolePermission(t);case 3:case"end":return r.stop()}}),r)})))()},executeTariffRestrictionScript:function executeTariffRestrictionScript(){var script=this.getRestrictionScript;script&&eval(script)}}),template:'\n\t\t<div class="bx-crm-perms-main">\n\t\t\t<Loader v-if="isSaveInProgress"/>\n\t\t\t<p class="bx-crm-perms-desk-error" v-if="getLastErrorMessage">\n\t\t\t\t{{ getLastErrorMessage }}\n\t\t\t</p>\n\t\n\t\t\t<label>\n\t\t\t\t{{ labels.roleName }}:\n\t\t\t\t<input name="NAME" v-model="roleName" class="bx-crm-perms-desk-input-role_name">\n\t\t\t</label>\n\t\n\t\t\t<Desk/>\n\n\t\t\t<div class="bx-crm-perms-desk-footer">\n\t\t\t\t<div class="bx-crm-perms-desk-footer-colleft">\n\t\t\t\t\t<button @click="onPressSave" class="bx-crm-perms-desk-btn" name="save">{{ labels.saveName }}</button>\n\t\t\t\t\t<button @click="onPressApply" class="bx-crm-perms-desk-btn" name="apply">{{ labels.applyName }}</button>\n\t\t\t\t</div>\n\t\t\t\t<div class="bx-crm-perms-desk-footer-colright">\n\t\t\t\t\t<span \n\t\t\t\t\t\tv-if="isShowDeleteBtn" \n\t\t\t\t\t\tclass="bx-crm-perms-desk-delete"\n\t\t\t\t\t\t@click="onPressDeleteRole"\n\t\t\t\t\t>{{ labels.roleDelete }}</span>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div\n\t\t\t\tv-if="!hasTariffPermission"\n\t\t\t\tclass="ui-alert ui-alert-warning"\n\t\t\t\tstyle="margin: 15px 0 0 0;"\n\t\t\t>\n\t\t\t\t<span class="ui-alert-message" v-html="labels.notAllowedByTariff"></span>\n\t\t\t</div>\n\n\t\t</div>\n\t'};function _classPrivateFieldInitSpec$1(t,e,r){_checkPrivateRedeclaration$1(t,e),e.set(t,r)}function _checkPrivateRedeclaration$1(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}var _options=new WeakMap,_application=new WeakMap,EditApp=function(){function t(e){babelHelpers.classCallCheck(this,t),_classPrivateFieldInitSpec$1(this,_options,{writable:!0,value:void 0}),_classPrivateFieldInitSpec$1(this,_application,{writable:!0,value:null}),babelHelpers.classPrivateFieldSet(this,_options,e)}return babelHelpers.createClass(t,[{key:"start",value:function(t){var e=ui_vue3_vuex.createStore(store());babelHelpers.classPrivateFieldSet(this,_application,ui_vue3.BitrixVue.createApp({name:"CrmConfigPermsRoleEdit",components:{Main:Main},template:"\n\t\t\t\t<Main/>\n\t\t\t"})),e.commit("setInitData",t),babelHelpers.classPrivateFieldGet(this,_application).use(e);var r=document.getElementById(babelHelpers.classPrivateFieldGet(this,_options).containerId);babelHelpers.classPrivateFieldGet(this,_application).mount(r)}}]),t}();exports.EditApp=EditApp}(this.BX.Crm.Perms=this.BX.Crm.Perms||{},BX.UI,BX,BX.UI.SidePanel,BX.Vue3,BX.Vue3.Vuex,BX,BX.Event,BX.UI.EntitySelector,BX,BX.UI);
//# sourceMappingURL=edit.bundle.map.js