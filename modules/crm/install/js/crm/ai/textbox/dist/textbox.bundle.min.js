this.BX=this.BX||{};this.BX.Crm=this.BX.Crm||{};(function(e,t){"use strict";var n,r,a,i,o,l,s,c,u;var p=function(){function e(){var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};babelHelpers.classCallCheck(this,e);babelHelpers.defineProperty(this,"textContainerID","crm-copilot-text-container");babelHelpers.defineProperty(this,"searchIcon","ui-ctl-icon-search");babelHelpers.defineProperty(this,"clearIcon","ui-ctl-icon-clear");babelHelpers.defineProperty(this,"searchInputPlaceholder",t.Loc.getMessage("CRM_COPILOT_TEXTBOX_SEARCH_PLACEHOLDER"));this.setText(n.text);this.title=t.Type.isString(n.title)?n.title:"";this.enableSearch=t.Type.isBoolean(n.enableSearch)?n.enableSearch:true;this.previousTextContent=t.Type.isElementNode(n.previousTextContent)?n.previousTextContent:null}babelHelpers.createClass(e,[{key:"setText",value:function e(n){this.text=t.Type.isString(n)?this.prepareText(n):""}},{key:"prepareText",value:function e(t){return t.replaceAll(/\r?\n/g,"<br>")}},{key:"render",value:function e(){this.rootContainer=t.Tag.render(n||(n=babelHelpers.taggedTemplateLiteral(['<div class="crm-copilot-textbox"></div>'])));t.Dom.append(this.getHeaderContainer(),this.rootContainer);t.Dom.append(this.getPreviousTextContainer(),this.rootContainer);t.Dom.append(this.getContentContainer(),this.rootContainer)}},{key:"get",value:function e(){return this.rootContainer}},{key:"getContentContainer",value:function e(){var n=t.Tag.render(r||(r=babelHelpers.taggedTemplateLiteral(['<div class="crm-copilot-textbox__content"></div>'])));var a=this.getTextContainer();t.Event.bind(a,"beforeinput",(function(e){e.preventDefault()}));t.Dom.append(a,n);return n}},{key:"getTextContainer",value:function e(){if(this.textContainer){return this.textContainer}this.textContainer=t.Tag.render(a||(a=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div \n\t\t\t\tid="','" \n\t\t\t\tclass="crm-copilot-textbox__text-container" \n\t\t\t\tcontenteditable="true" \n\t\t\t\tspellcheck="false"\n\t\t\t>\n\t\t\t\t',"\n\t\t\t</div>\n\t\t"])),this.textContainerID,this.text);return this.textContainer}},{key:"getHeaderContainer",value:function e(){return t.Tag.render(i||(i=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="crm-copilot-textbox__header">\n\t\t\t\t<div class="crm-copilot-textbox__title">',"</div>\n\t\t\t\t","\n\t\t\t</div>\n\t\t"])),t.Text.encode(this.title),this.getSearchContainer())}},{key:"getSearchContainer",value:function e(){var n=this;if(!this.enableSearch){return t.Tag.render(o||(o=babelHelpers.taggedTemplateLiteral([""])))}var r=t.Tag.render(l||(l=babelHelpers.taggedTemplateLiteral(['<div class="ui-ctl ui-ctl-after-icon ui-ctl-no-border crm-copilot-textbox__search"></div>'])));var a=t.Tag.render(s||(s=babelHelpers.taggedTemplateLiteral(['<a class="ui-ctl-after ',' crm-copilot-textbox__search-btn"></a>'])),this.searchIcon);var i=t.Tag.render(c||(c=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<input \n\t\t\t\ttype="text" \n\t\t\t\tplaceholder="','" \n\t\t\t\tclass="ui-ctl-element ui-ctl-textbox crm-copilot-textbox__search-input"\n\t\t\t>\n\t\t'])),t.Text.encode(this.searchInputPlaceholder));i.oninput=function(){n.resetTextContainer();var e=i.value;if(!e){n.switchStyle(a,n.clearIcon,n.searchIcon);return}n.switchStyle(a,n.searchIcon,n.clearIcon);var t=new RegExp("((?<!<[^>]*?)(".concat(e,")(?![^<]*?>))"),"gi");var r=n.getTextContainer();r.innerHTML=r.innerHTML.replace(t,'<span class="search-item">$&</span>')};var u=false;i.onblur=function(e){if(i.value.length===0){t.Dom.removeClass(r,"with-input-node");t.Dom.remove(i);u=false}};a.onclick=function(){if(r.contains(i)){if(i.value.length>0){i.value="";n.switchStyle(a,n.clearIcon,n.searchIcon);n.resetTextContainer()}u=true;i.focus();return}t.Dom.append(i,r);t.Dom.addClass(r,["with-input-node"]);u=true;i.focus()};a.onmousedown=function(e){if(u){e.preventDefault()}};t.Dom.append(a,r);return r}},{key:"getPreviousTextContainer",value:function e(){return t.Tag.render(u||(u=babelHelpers.taggedTemplateLiteral(['<div class="crm-copilot-textbox__previous-text">',"</div>"])),this.previousTextContent)}},{key:"resetTextContainer",value:function e(){this.getTextContainer().innerHTML=this.text}},{key:"switchStyle",value:function e(n,r,a){if(t.Dom.hasClass(n,r)&&!t.Dom.hasClass(n,a)){t.Dom.addClass(n,a);t.Dom.removeClass(n,r)}}}]);return e}();e.Textbox=p})(this.BX.Crm.AI=this.BX.Crm.AI||{},BX);
//# sourceMappingURL=textbox.bundle.map.js