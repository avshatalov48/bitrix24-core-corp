this.BX=this.BX||{};this.BX.Crm=this.BX.Crm||{};(function(e,t,n,r,a){"use strict";var i,o,s,l;function c(e,t){p(e,t);t.add(e)}function p(e,t){if(t.has(e)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}function u(e,t,n){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return n}var h={DEFAULT:{className:"--crm-textbox-attention-default",iconOptions:{icon:a.Set.INFO_1,color:"#BDC1C6",size:16}},COPILOT:{className:"--crm-textbox-attention-copilot",iconOptions:{icon:a.Set.EARTH,color:"#B6AAC8",size:16}}};var d=new WeakSet;var v=new WeakSet;var g=function(){function e(t){var n;babelHelpers.classCallCheck(this,e);c(this,v);c(this,d);this.setContent(t.content);this.setPreset((n=t.preset)!==null&&n!==void 0?n:h.DEFAULT)}babelHelpers.createClass(e,[{key:"setContent",value:function e(t){if(r.Type.isElementNode(t)){this.content=t;return}this.content=r.Tag.render(i||(i=babelHelpers.taggedTemplateLiteral(["<span>","</span>"])),t)}},{key:"setPreset",value:function e(t){this.preset=t}},{key:"render",value:function e(){this.getContainer().innerHTML="";r.Dom.append(u(this,d,b).call(this),this.getContainer());r.Dom.append(u(this,v,T).call(this),this.getContainer());return this.getContainer()}},{key:"getContainer",value:function e(){if(!this.container){this.container=r.Tag.render(o||(o=babelHelpers.taggedTemplateLiteral(['<div class="crm-textbox-attention ','"></div>'])),this.preset.className)}return this.container}}]);return e}();function b(){var e=r.Tag.render(s||(s=babelHelpers.taggedTemplateLiteral(['<span class="crm-textbox-attention__icon"></span>'])));var t=new a.Icon(this.preset.iconOptions);r.Dom.append(t.render(),e);return e}function T(){var e=r.Tag.render(l||(l=babelHelpers.taggedTemplateLiteral(['<span class="crm-textbox-attention__content"></span>'])));r.Dom.append(this.content,e);return e}var m,x,C,f,y,H,D,_,L,k,I;var S=function(){function e(){var t;var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};babelHelpers.classCallCheck(this,e);babelHelpers.defineProperty(this,"textContainerID","crm-copilot-text-container");babelHelpers.defineProperty(this,"searchIcon","ui-ctl-icon-search");babelHelpers.defineProperty(this,"clearIcon","ui-ctl-icon-clear");babelHelpers.defineProperty(this,"searchInputPlaceholder",r.Loc.getMessage("CRM_COPILOT_TEXTBOX_SEARCH_PLACEHOLDER"));this.setText(n.text);this.title=r.Type.isString(n.title)?n.title:"";this.enableSearch=r.Type.isBoolean(n.enableSearch)?n.enableSearch:true;this.previousTextContent=r.Type.isElementNode(n.previousTextContent)?n.previousTextContent:null;this.attentions=(t=n.attentions)!==null&&t!==void 0?t:[]}babelHelpers.createClass(e,[{key:"setText",value:function e(t){this.text=r.Type.isString(t)?this.prepareText(t):""}},{key:"prepareText",value:function e(t){return t.replaceAll(/\r?\n/g,"<br>")}},{key:"render",value:function e(){this.rootContainer=r.Tag.render(m||(m=babelHelpers.taggedTemplateLiteral(['<div class="crm-copilot-textbox"></div>'])));r.Dom.append(this.getHeaderContainer(),this.rootContainer);r.Dom.append(this.getPreviousTextContainer(),this.rootContainer);r.Dom.append(this.getContentContainer(),this.rootContainer);r.Dom.append(this.getAttentionsContainer(),this.rootContainer)}},{key:"get",value:function e(){return this.rootContainer}},{key:"getContentContainer",value:function e(){var t=r.Tag.render(x||(x=babelHelpers.taggedTemplateLiteral(['<div class="crm-copilot-textbox__content"></div>'])));var n=this.getTextContainer();r.Event.bind(n,"beforeinput",(function(e){e.preventDefault()}));r.Dom.append(n,t);return t}},{key:"getTextContainer",value:function e(){if(this.textContainer){return this.textContainer}this.textContainer=r.Tag.render(C||(C=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div \n\t\t\t\tid="','" \n\t\t\t\tclass="crm-copilot-textbox__text-container" \n\t\t\t\tcontenteditable="true" \n\t\t\t\tspellcheck="false"\n\t\t\t>\n\t\t\t\t',"\n\t\t\t</div>\n\t\t"])),this.textContainerID,this.text);return this.textContainer}},{key:"getHeaderContainer",value:function e(){return r.Tag.render(f||(f=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="crm-copilot-textbox__header">\n\t\t\t\t<div class="crm-copilot-textbox__title">',"</div>\n\t\t\t\t","\n\t\t\t</div>\n\t\t"])),r.Text.encode(this.title),this.getSearchContainer())}},{key:"getSearchContainer",value:function e(){var t=this;if(!this.enableSearch){return r.Tag.render(y||(y=babelHelpers.taggedTemplateLiteral([""])))}var n=r.Tag.render(H||(H=babelHelpers.taggedTemplateLiteral(['<div class="ui-ctl ui-ctl-after-icon ui-ctl-no-border crm-copilot-textbox__search"></div>'])));var a=r.Tag.render(D||(D=babelHelpers.taggedTemplateLiteral(['<a class="ui-ctl-after ',' crm-copilot-textbox__search-btn"></a>'])),this.searchIcon);var i=r.Tag.render(_||(_=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<input \n\t\t\t\ttype="text" \n\t\t\t\tplaceholder="','" \n\t\t\t\tclass="ui-ctl-element ui-ctl-textbox crm-copilot-textbox__search-input"\n\t\t\t>\n\t\t'])),r.Text.encode(this.searchInputPlaceholder));i.oninput=function(){t.resetTextContainer();var e=i.value;if(!e){t.switchStyle(a,t.clearIcon,t.searchIcon);return}t.switchStyle(a,t.searchIcon,t.clearIcon);var n=new RegExp("((?<!<[^>]*?)(".concat(e,")(?![^<]*?>))"),"gi");var r=t.getTextContainer();r.innerHTML=r.innerHTML.replace(n,'<span class="search-item">$&</span>')};var o=false;i.onblur=function(e){if(i.value.length===0){r.Dom.removeClass(n,"with-input-node");r.Dom.remove(i);o=false}};a.onclick=function(){if(n.contains(i)){if(i.value.length>0){i.value="";t.switchStyle(a,t.clearIcon,t.searchIcon);t.resetTextContainer()}o=true;i.focus();return}r.Dom.append(i,n);r.Dom.addClass(n,["with-input-node"]);o=true;i.focus()};a.onmousedown=function(e){if(o){e.preventDefault()}};r.Dom.append(a,n);return n}},{key:"getAttentionsContainer",value:function e(){if(!r.Type.isArrayFilled(this.attentions)){return r.Tag.render(L||(L=babelHelpers.taggedTemplateLiteral([""])))}var t=r.Tag.render(k||(k=babelHelpers.taggedTemplateLiteral(['<div class="crm-copilot-textbox__attentions"></div>'])));this.attentions.forEach((function(e){r.Dom.append(e.render(),t)}));return t}},{key:"getPreviousTextContainer",value:function e(){return r.Tag.render(I||(I=babelHelpers.taggedTemplateLiteral(['<div class="crm-copilot-textbox__previous-text">',"</div>"])),this.previousTextContent)}},{key:"resetTextContainer",value:function e(){this.getTextContainer().innerHTML=this.text}},{key:"switchStyle",value:function e(t,n,a){if(r.Dom.hasClass(t,n)&&!r.Dom.hasClass(t,a)){r.Dom.addClass(t,a);r.Dom.removeClass(t,n)}}}]);return e}();e.Attention=g;e.AttentionPresets=h;e.Textbox=S})(this.BX.Crm.AI=this.BX.Crm.AI||{},BX,BX,BX,BX.UI.IconSet);
//# sourceMappingURL=textbox.bundle.map.js