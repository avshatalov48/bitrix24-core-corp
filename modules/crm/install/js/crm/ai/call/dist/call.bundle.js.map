{"version":3,"file":"call.bundle.js","sources":["../src/base.js","../src/call-quality/pull.js","../src/call-quality/components/view-mode.js","../src/call-quality/components/compliance.js","../src/call-quality/components/explanation/empty-script-list-block.js","../src/call-quality/components/explanation/error-block.js","../src/call-quality/components/explanation/not-assessment-script-block.js","../src/call-quality/components/explanation/other-script-block.js","../src/call-quality/components/explanation/pending-block.js","../src/call-quality/components/explanation/recommendation-block.js","../src/call-quality/script-selector-display-strategy.js","../src/call-quality/components/script-selector.js","../src/call-quality/components/call-quality.js","../src/call-quality/rating.js","../src/call-quality/call-quality.js","../src/summary.js","../src/transcription.js","../src/index.js"],"sourcesContent":["import { Slider } from 'crm.ai.slider';\nimport { Attention, AttentionPresets, Textbox } from 'crm.ai.textbox';\nimport { AudioPlayer } from 'crm.audio-player';\nimport { Loc, Tag, Text, Type } from 'main.core';\nimport { UI } from 'ui.notification';\n\nexport type aiCallData = {\n\tactivityId: number,\n\tactivityCreated?: number,\n\townerTypeId: number,\n\townerId: number,\n\tlanguageTitle ?: string,\n\tclientDetailUrl ?: string,\n\tclientFullName ?: string,\n\tuserPhotoUrl ?: string,\n\tjobId ?: number,\n\tassessmentSettingsId ?: number,\n};\n\nexport class Base\n{\n\tactivityId: number;\n\townerTypeId: number;\n\townerId: number;\n\tlanguageTitle: ?string = null;\n\n\taudioPlayerNode: HTMLElement;\n\n\tid: string;\n\tsliderTitle: string;\n\tsliderWidth: number;\n\ttextboxTitle: string;\n\taiJobResultAndCallRecordAction: string;\n\n\twrapperSlider: Slider;\n\taudioPlayerApp: AudioPlayer;\n\ttextbox: Textbox;\n\n\tconstructor(data: aiCallData)\n\t{\n\t\tthis.initDefaultOptions();\n\n\t\tthis.activityId = data.activityId;\n\t\tthis.ownerTypeId = data.ownerTypeId;\n\t\tthis.ownerId = data.ownerId;\n\t\tthis.languageTitle = data.languageTitle ?? null;\n\n\t\tthis.audioPlayerNode = Tag.render`<div id=\"crm-textbox-audio-player\"></div>`;\n\n\t\tthis.audioPlayerApp = new AudioPlayer({\n\t\t\trootNode: this.audioPlayerNode,\n\t\t});\n\n\t\tthis.textbox = new Textbox({\n\t\t\ttitle: this.textboxTitle,\n\t\t\tpreviousTextContent: this.audioPlayerNode,\n\t\t\tattentions: this.getTextboxAttentions(),\n\t\t});\n\n\t\tthis.sliderId = `${this.id}-${Math.floor(Math.random() * 1000)}`;\n\t\tthis.wrapperSlider = new Slider({\n\t\t\turl: this.sliderId,\n\t\t\tsliderTitle: this.sliderTitle,\n\t\t\tsliderContentClass: this.getSliderContentClass(),\n\t\t\twidth: this.sliderWidth,\n\t\t\textensions: this.getExtensions(),\n\t\t\tdesign: this.getSliderDesign(),\n\t\t\tevents: this.getSliderEvents(),\n\t\t\ttoolbar: this.getSliderToolbar(),\n\t\t});\n\t}\n\n\tgetExtensions(): Array<string>\n\t{\n\t\treturn ['crm.ai.textbox', 'crm.audio-player'];\n\t}\n\n\tgetSliderContentClass(): ?string\n\t{\n\t\treturn null;\n\t}\n\n\tgetSliderDesign(): ?Object\n\t{\n\t\treturn null;\n\t}\n\n\tgetSliderToolbar(): ?Function\n\t{\n\t\treturn null;\n\t}\n\n\tgetSliderEvents(): Object\n\t{\n\t\treturn {\n\t\t\tonLoad: () => {\n\t\t\t\tthis.audioPlayerApp.attachTemplate();\n\t\t\t},\n\t\t\tonClose: () => {\n\t\t\t\tthis.audioPlayerApp.detachTemplate();\n\t\t\t},\n\t\t};\n\t}\n\n\topen()\n\t{\n\t\tconst content = new Promise((resolve, reject) => {\n\t\t\tthis.getAiJobResultAndCallRecord()\n\t\t\t\t.then((response) => {\n\t\t\t\t\tconst audioProps = this.prepareAudioProps(response);\n\t\t\t\t\tthis.audioPlayerApp.setAudioProps(audioProps);\n\n\t\t\t\t\tconst aiJobResult = this.prepareAiJobResult(response);\n\t\t\t\t\tthis.textbox.setText(aiJobResult);\n\t\t\t\t\tthis.textbox.render();\n\n\t\t\t\t\tresolve(this.textbox.get());\n\t\t\t\t})\n\t\t\t\t.catch((response) => {\n\t\t\t\t\tthis.showError(response);\n\t\t\t\t\tthis.wrapperSlider.destroy();\n\t\t\t\t})\n\t\t\t;\n\t\t});\n\n\t\tthis.wrapperSlider.setContent(content);\n\t\tthis.wrapperSlider.open();\n\t}\n\n\tgetAiJobResultAndCallRecord(): Promise\n\t{\n\t\tconst actionData = {\n\t\t\tdata: {\n\t\t\t\tactivityId: this.activityId,\n\t\t\t\townerTypeId: this.ownerTypeId,\n\t\t\t\townerId: this.ownerId,\n\t\t\t},\n\t\t};\n\n\t\treturn BX.ajax.runAction(this.aiJobResultAndCallRecordAction, actionData);\n\t}\n\n\tshowError(response)\n\t{\n\t\tUI.Notification.Center.notify({\n\t\t\tcontent: response.errors[0].message,\n\t\t\tautoHideDelay: 5000,\n\t\t});\n\t}\n\n\tprepareAiJobResult(response: Object): string\n\t{\n\t\treturn '';\n\t}\n\n\tprepareAudioProps(response: Object): Object\n\t{\n\t\tconst callRecord = response.data.callRecord;\n\n\t\treturn {\n\t\t\tid: callRecord.id,\n\t\t\tsrc: callRecord.src,\n\t\t\ttitle: callRecord.title,\n\t\t\tcontext: window.top,\n\t\t};\n\t}\n\n\tgetTextboxAttentions(): Array\n\t{\n\t\tconst attentions = [this.getNotAccurateAttention()];\n\n\t\tconst jobLanguageAttention = this.getJobLanguageAttention();\n\t\tif (jobLanguageAttention !== null)\n\t\t{\n\t\t\tattentions.push(jobLanguageAttention);\n\t\t}\n\n\t\treturn attentions;\n\t}\n\n\tgetNotAccurateAttention(): Attention\n\t{\n\t\tconst helpdeskCode = '20412666';\n\n\t\tconst content = Loc.getMessage(this.getNotAccuratePhraseCode(), {\n\t\t\t'[helpdesklink]': `<a href=\"##\" onclick=\"top.BX.Helper.show('redirect=detail&code=${helpdeskCode}');\">`,\n\t\t\t'[/helpdesklink]': '</a>',\n\t\t});\n\n\t\treturn new Attention({\n\t\t\tcontent,\n\t\t});\n\t}\n\n\tgetJobLanguageAttention(): ?Attention\n\t{\n\t\tif (!Type.isStringFilled(this.languageTitle))\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst helpdeskCode = '20423978';\n\t\tconst content = Loc.getMessage('CRM_COPILOT_CALL_JOB_LANGUAGE_ATTENTION', {\n\t\t\t'#LANGUAGE_TITLE#': `<span style=\"text-transform: lowercase\">${Text.encode(this.languageTitle)}</span>`,\n\t\t\t'[helpdesklink]': `<a href=\"##\" onclick=\"top.BX.Helper.show('redirect=detail&code=${helpdeskCode}');\">`,\n\t\t\t'[/helpdesklink]': '</a>',\n\t\t});\n\n\t\treturn new Attention({\n\t\t\tpreset: AttentionPresets.COPILOT,\n\t\t\tcontent,\n\t\t});\n\t}\n\n\tgetNotAccuratePhraseCode(): string\n\t{\n\t\treturn '';\n\t}\n\n\tgetSliderTitle(): string\n\t{\n\t\treturn '';\n\t}\n\n\tgetTextboxTitle(): string\n\t{\n\t\treturn '';\n\t}\n\n\tinitDefaultOptions(): void {}\n}\n","import { PULL } from 'pull.client';\n\nconst CALL_SCORING_ADD_COMMAND = 'call_scoring_add';\n\nexport class Pull\n{\n\t#callback: Function;\n\t#unsubscribe: ?Function = null;\n\n\tconstructor(callback: Function)\n\t{\n\t\tthis.#callback = callback;\n\t}\n\n\tinit(): void\n\t{\n\t\tif (!PULL)\n\t\t{\n\t\t\tconsole.error('pull is not initialized');\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#unsubscribe = PULL.subscribe({\n\t\t\tmoduleId: 'crm',\n\t\t\tcommand: CALL_SCORING_ADD_COMMAND,\n\t\t\tcallback: (params) => {\n\t\t\t\tthis.#callback(params);\n\t\t\t},\n\t\t});\n\n\t\tPULL.extendWatch(CALL_SCORING_ADD_COMMAND);\n\t}\n\n\tunsubscribe(): void\n\t{\n\t\tthis.#unsubscribe();\n\t}\n}\n","export type ViewModeType = ViewMode.usedNotAssessmentScript\n\t| ViewMode.usedCurrentVersionOfScript\n\t| ViewMode.usedOtherVersionOfScript\n\t| ViewMode.emptyScriptList\n\t| ViewMode.pending\n\t| ViewMode.error\n;\n\n/*\n* @readonly\n* @enum {string}\n*/\nexport const ViewMode: Object<string, string> = Object.freeze({\n\tusedNotAssessmentScript: 'usedNotAssessmentScript',\n\tusedCurrentVersionOfScript: 'usedCurrentVersionOfScript',\n\tusedOtherVersionOfScript: 'usedOtherVersionOfScript',\n\temptyScriptList: 'emptyScriptList',\n\tpending: 'pending',\n\terror: 'error',\n});\n","import { Loc } from 'main.core';\nimport { ViewMode } from './view-mode';\n\nexport const Compliance = {\n\tprops: {\n\t\ttitle: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tassessment: {\n\t\t\ttype: Number,\n\t\t\tdefault: null,\n\t\t},\n\t\tviewMode: {\n\t\t\ttype: String,\n\t\t\tdefault: null,\n\t\t},\n\t},\n\n\tmounted(): void\n\t{\n\t\tthis.startAnimate();\n\t},\n\n\tmethods: {\n\t\tstartAnimate(): void\n\t\t{\n\t\t\tif (this.$refs.assessment)\n\t\t\t{\n\t\t\t\tthis.animateCounter(this.$refs.assessment, this.assessment);\n\t\t\t}\n\t\t},\n\t\tanimateCounter(counterElement: HTMLElement, targetNumber: number): void\n\t\t{\n\t\t\tlet startNumber = 0;\n\n\t\t\tconst duration = 1500;\n\t\t\tconst increment = targetNumber / (duration / 50);\n\n\t\t\tconst interval = setInterval(() => {\n\t\t\t\tstartNumber += increment;\n\n\t\t\t\tif (startNumber >= targetNumber)\n\t\t\t\t{\n\t\t\t\t\tstartNumber = targetNumber;\n\t\t\t\t\tclearInterval(interval);\n\t\t\t\t}\n\n\t\t\t\t// eslint-disable-next-line no-param-reassign\n\t\t\t\tcounterElement.textContent = Math.floor(startNumber);\n\t\t\t}, 50);\n\t\t},\n\t},\n\n\tcomputed: {\n\t\tclassList(): Object\n\t\t{\n\t\t\treturn {\n\t\t\t\t'call-quality__compliance__container': true,\n\t\t\t\t'--empty-state': !this.isUsedCurrentVersionOfScript,\n\t\t\t\t// @todo\n\t\t\t\t// '--bad': this.assessment < 50,\n\t\t\t\t// '--normal': this.assessment >= 50 && this.assessment < 80,\n\t\t\t\t// '--good': this.assessment >= 80,\n\t\t\t};\n\t\t},\n\t\tisUsedCurrentVersionOfScript(): boolean\n\t\t{\n\t\t\treturn this.viewMode === ViewMode.usedCurrentVersionOfScript;\n\t\t},\n\t\tinfoTitle(): string\n\t\t{\n\t\t\treturn (\n\t\t\t\tthis.viewMode === ViewMode.emptyScriptList\n\t\t\t\t\t? Loc.getMessage('CRM_COPILOT_CALL_QUALITY_COMPLIANCE_EMPTY_SCRIPT_LIST_TITLE')\n\t\t\t\t\t: Loc.getMessage('CRM_COPILOT_CALL_QUALITY_COMPLIANCE_TITLE')\n\t\t\t);\n\t\t},\n\t\tvalueTitle(): string\n\t\t{\n\t\t\treturn (\n\t\t\t\tthis.viewMode === ViewMode.emptyScriptList\n\t\t\t\t\t? Loc.getMessage('CRM_COPILOT_CALL_QUALITY_COMPLIANCE_EMPTY_SCRIPT_LIST_VALUE')\n\t\t\t\t\t: this.title\n\t\t\t);\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div :class=\"classList\">\n\t\t\t<div class=\"call-quality__compliance\">\n\t\t\t\t<div\n\t\t\t\t\tv-if=\"isUsedCurrentVersionOfScript\"\n\t\t\t\t\tclass=\"call-quality__compliance__assessment\"\n\t\t\t\t>\n\t\t\t\t\t<span ref=\"assessment\" class=\"call-quality__compliance__assessment-value\">\n\t\t\t\t\t\t{{ assessment }}\n\t\t\t\t\t</span>\n\t\t\t\t\t<div class=\"call-quality__compliance__assessment-measure\">\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"call-quality__compliance__info\">\n\t\t\t\t\t<span class=\"call-quality__compliance__info-title\">\n\t\t\t\t\t\t{{ infoTitle }}\n\t\t\t\t\t</span>\n\t\t\t\t\t<span class=\"call-quality__compliance__info-value\">\n\t\t\t\t\t\t{{ valueTitle }}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Loc } from 'main.core';\n\nexport const EmptyScriptListBlock = {\n\n\tcomputed: {\n\t\ttitle(): string\n\t\t{\n\t\t\treturn Loc.getMessage('CRM_COPILOT_CALL_QUALITY_EMPTY_SCRIPT_LIST_TITLE');\n\t\t},\n\t\ttext(): string\n\t\t{\n\t\t\treturn Loc.getMessage('CRM_COPILOT_CALL_QUALITY_EMPTY_SCRIPT_LIST_TEXT');\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div class=\"call-quality__explanation\">\n\t\t\t<div class=\"call-quality__explanation__container\">\n\t\t\t\t<div class=\"call-quality__explanation-title\">\n\t\t\t\t\t{{ title }}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"call-quality__explanation-text\" v-html=\"text\">\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Loc, Type } from 'main.core';\n\nexport const ErrorBlock = {\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\terrorText: null,\n\t\t};\n\t},\n\n\tmethods: {\n\t\tsetErrorMessage(message: string): void\n\t\t{\n\t\t\tthis.errorText = message;\n\t\t},\n\t},\n\n\tcomputed: {\n\t\texplanationText(): string\n\t\t{\n\t\t\treturn (\n\t\t\t\tType.isStringFilled(this.errorText)\n\t\t\t\t\t? this.errorText\n\t\t\t\t\t: Loc.getMessage('CRM_COPILOT_CALL_QUALITY_ERROR_TEXT')\n\t\t\t);\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div class=\"call-quality__explanation\">\n\t\t\t<div class=\"call-quality__explanation__container --error\">\n\t\t\t\t<div class=\"call-quality__explanation-title\">\n\t\t\t\t\t{{ $Bitrix.Loc.getMessage('CRM_COPILOT_CALL_QUALITY_ERROR_TITLE') }}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"call-quality__explanation-text\">\n\t\t\t\t\t{{ explanationText }}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Loc } from 'main.core';\n\nexport const NotAssessmentScriptBlock = {\n\tmethods: {\n\t\tdoAssessment(): void\n\t\t{\n\t\t\tthis.$emit('doAssessment');\n\t\t},\n\t},\n\n\tcomputed: {\n\t\ttitle(): string\n\t\t{\n\t\t\treturn Loc.getMessage('CRM_COPILOT_CALL_QUALITY_NO_EXPLANATION_TITLE');\n\t\t},\n\t\ttext(): string\n\t\t{\n\t\t\treturn Loc.getMessage('CRM_COPILOT_CALL_QUALITY_NO_EXPLANATION_TEXT');\n\t\t},\n\t\tbuttonText(): string\n\t\t{\n\t\t\treturn Loc.getMessage('CRM_COPILOT_CALL_QUALITY_NO_EXPLANATION_ASSESSMENT');\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div class=\"call-quality__explanation\">\n\t\t\t<div class=\"call-quality__explanation__container \">\n\t\t\t\t<div class=\"call-quality__explanation-title\">\n\t\t\t\t\t{{ title }}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"call-quality__explanation-text\" v-html=\"text\">\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"call-quality__explanation__buttons-container\">\n\t\t\t\t<button\n\t\t\t\t\tclass=\"ui-btn ui-btn-md ui-btn-no-caps ui-btn-color-ai ui-btn-round ui-btn-active\"\n\t\t\t\t\t@click=\"doAssessment\"\n\t\t\t\t>\n\t\t\t\t\t{{ buttonText }}\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Loc } from 'main.core';\n\nexport const OtherScriptBlock = {\n\tmethods: {\n\t\tshowAssessment(): void\n\t\t{\n\t\t\tthis.$emit('showAssessment');\n\t\t},\n\t\tdoAssessment(): void\n\t\t{\n\t\t\tthis.$emit('doAssessment');\n\t\t},\n\t},\n\n\tcomputed: {\n\t\ttitle(): string\n\t\t{\n\t\t\treturn Loc.getMessage('CRM_COPILOT_CALL_QUALITY_OLD_EXPLANATION_TITLE');\n\t\t},\n\t\ttext(): string\n\t\t{\n\t\t\treturn Loc.getMessage('CRM_COPILOT_CALL_QUALITY_OLD_EXPLANATION_TEXT');\n\t\t},\n\t\tbuttonShowText(): string\n\t\t{\n\t\t\treturn Loc.getMessage('CRM_COPILOT_CALL_QUALITY_OLD_EXPLANATION_SHOW_ASSESSMENT');\n\t\t},\n\t\tbuttonDoText(): string\n\t\t{\n\t\t\treturn Loc.getMessage('CRM_COPILOT_CALL_QUALITY_OLD_EXPLANATION_ASSESSMENT');\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div class=\"call-quality__explanation\">\n\t\t\t<div class=\"call-quality__explanation__container \">\n\t\t\t\t<div class=\"call-quality__explanation-title\" v-html=\"title\">\n\t\t\t\t</div>\n\t\t\t\t<div class=\"call-quality__explanation-text\" v-html=\"text\">\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"call-quality__explanation__buttons-container\">\n\t\t\t\t<button\n\t\t\t\t\tclass=\"ui-btn ui-btn-md ui-btn-no-caps ui-btn-color-ai ui-btn-round ui-btn-active\"\n\t\t\t\t\t@click=\"doAssessment\"\n\t\t\t\t>\n\t\t\t\t\t{{ buttonDoText }}\n\t\t\t\t</button>\n\t\t\t\t<button\n\t\t\t\t\tclass=\"ui-btn ui-btn-md ui-btn-no-caps ui-btn-light-border ui-btn-round\"\n\t\t\t\t\t@click=\"showAssessment\"\n\t\t\t\t>\n\t\t\t\t\t{{ buttonShowText }}\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Lottie } from 'ui.lottie';\n\nexport const PendingBlock = {\n\tmounted()\n\t{\n\t\tthis.renderLottieAnimation();\n\t},\n\n\tmethods: {\n\t\trenderLottieAnimation(): HTMLElement\n\t\t{\n\t\t\tconst mainAnimation = Lottie.loadAnimation({\n\t\t\t\tpath: this.getAnimationPath(),\n\t\t\t\tcontainer: this.$refs.lottie,\n\t\t\t\trenderer: 'svg',\n\t\t\t\tloop: true,\n\t\t\t\tautoplay: true,\n\t\t\t});\n\n\t\t\tmainAnimation.setSpeed(0.75);\n\n\t\t\treturn this.$refs.lottie.root;\n\t\t},\n\t\tgetAnimationPath(): string\n\t\t{\n\t\t\treturn '/bitrix/js/crm/ai/call/src/call-quality/lottie/loader.json';\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div class=\"call-quality__explanation\">\n\t\t\t<div class=\"call-quality__explanation__container \">\n\t\t\t\t<div class=\"call-quality__explanation-title\">\n\t\t\t\t\t{{ $Bitrix.Loc.getMessage('CRM_COPILOT_CALL_QUALITY_PENDING_TITLE') }}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"call-quality__explanation-text\">\n\t\t\t\t\t<div class=\"call-quality__explanation-loader__container\">\n\t\t\t\t\t\t<div ref=\"lottie\" class=\"call-quality__explanation-loader__lottie\"></div>\n\t\t\t\t\t\t<div class=\"call-quality__explanation-loader__lottie-text\">{{ $Bitrix.Loc.getMessage('CRM_COPILOT_CALL_QUALITY_PENDING_TEXT') }}</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","const ARTICLE_CODE = '23240682';\n\nexport const RecommendationBlock = {\n\tprops: {\n\t\trecommendations: {\n\t\t\ttype: String,\n\t\t\tdefault: null,\n\t\t},\n\t\tsummary: {\n\t\t\ttype: String,\n\t\t\tdefault: null,\n\t\t},\n\t\tuseInRating: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\n\tmethods: {\n\t\tshowArticle(): void\n\t\t{\n\t\t\twindow.top.BX?.Helper?.show(`redirect=detail&code=${ARTICLE_CODE}`);\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div class=\"call-quality__explanation --copilot-content\">\n\t\t\t<div class=\"call-quality__explanation__container \">\n\t\t\t\t<div class=\"call-quality__explanation-title\">\n\t\t\t\t\t{{ $Bitrix.Loc.getMessage('CRM_COPILOT_CALL_QUALITY_EXPLANATION_TITLE') }}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"call-quality__explanation-text\">\n\t\t\t\t\t<div \n\t\t\t\t\t\tv-if=\"!useInRating\"\n\t\t\t\t\t\tclass=\"call-quality__explanation-badge\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('CRM_COPILOT_CALL_QUALITY_EXPLANATION_NOT_IN_RATING') }}\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclass=\"call-quality__explanation-badge-article ui-icon-set --help\"\n\t\t\t\t\t\t\t\t@click=\"showArticle\"\n\t\t\t\t\t\t\t></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<p>\n\t\t\t\t\t\t{{ summary }}\n\t\t\t\t\t</p>\n\t\t\t\t\t<p>\n\t\t\t\t\t\t{{ recommendations }}\n\t\t\t\t\t</p>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import type { DisplayStrategy } from 'crm.copilot.call-assessment-selector';\nimport { Dom, Tag } from 'main.core';\n\nexport class ScriptSelectorDisplayStrategy implements DisplayStrategy\n{\n\t#container: HTMLElement;\n\ttitleNode: HTMLElement;\n\tinnerTitleNode: HTMLElement;\n\t#isLoading: boolean = false;\n\n\tconstructor()\n\t{\n\t\tthis.#container = this.#createContainer();\n\t}\n\n\tgetTargetNode(): HTMLElement\n\t{\n\t\treturn this.titleNode;\n\t}\n\n\tupdateTitle(title: string): void\n\t{\n\t\tthis.innerTitleNode.innerText = title;\n\t\tthis.innerTitleNode.title = title;\n\t}\n\n\tsetLoading(isLoading: boolean): void\n\t{\n\t\tif (this.#isLoading === isLoading)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#isLoading = isLoading;\n\t\tDom.toggleClass(this.#container, '--loading');\n\t}\n\n\t#createContainer(): HTMLElement\n\t{\n\t\tthis.innerTitleNode = Tag.render`<span></span>`;\n\t\tthis.titleNode = Tag.render`\n\t\t\t<div class=\"call-quality__script-selector\">\n\t\t\t\t${this.innerTitleNode}\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.titleNode;\n\t}\n}\n","import { CallAssessmentSelector } from 'crm.copilot.call-assessment-selector';\nimport { DatetimeConverter } from 'crm.timeline.tools';\nimport { Dom, Loc } from 'main.core';\nimport { BaseEvent } from 'main.core.events';\nimport { HtmlFormatter } from 'ui.bbcode.formatter.html-formatter';\nimport { SidePanel } from 'ui.sidepanel';\nimport { ScriptSelectorDisplayStrategy } from '../script-selector-display-strategy';\nimport { ViewMode } from './view-mode';\n\nconst ARTICLE_CODE = '23240682';\n\nexport const ScriptSelector = {\n\tprops: {\n\t\tassessmentSettingsId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\tassessmentSettingsTitle: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tisPromptChanged: {\n\t\t\ttype: Boolean,\n\t\t\trequired: true,\n\t\t},\n\t\tpromptUpdatedAt: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tprompt: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tviewMode: {\n\t\t\ttype: String,\n\t\t\tdefault: '',\n\t\t},\n\t},\n\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tcallAssessmentSelector: this.getCallAssessmentSelector(),\n\t\t\thtmlFormatter: new HtmlFormatter(),\n\t\t};\n\t},\n\n\tmethods: {\n\t\tgetCallAssessmentSelector(): CallAssessmentSelector\n\t\t{\n\t\t\treturn new CallAssessmentSelector({\n\t\t\t\tcurrentCallAssessment: {\n\t\t\t\t\tid: this.assessmentSettingsId,\n\t\t\t\t\ttitle: (\n\t\t\t\t\t\tthis.assessmentSettingsId > 0\n\t\t\t\t\t\t\t? this.assessmentSettingsTitle\n\t\t\t\t\t\t\t: Loc.getMessage('CRM_COPILOT_CALL_QUALITY_EMPTY_SCRIPT_LIST_SCRIPT_TITLE')\n\t\t\t\t\t),\n\t\t\t\t},\n\t\t\t\temptyScriptListTitle: Loc.getMessage('CRM_COPILOT_CALL_QUALITY_EMPTY_SCRIPT_LIST_SCRIPT_TITLE'),\n\t\t\t\tdisplayStrategy: new ScriptSelectorDisplayStrategy(),\n\t\t\t\tadditionalSelectorOptions: {\n\t\t\t\t\tdialog: {\n\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\t'Item:onBeforeSelect': this.onBeforeSelect.bind(this),\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\tpopup: {\n\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\tonShow: (event) => {\n\t\t\t\t\t\t\t\t// @todo maybe there is a better solution?\n\t\t\t\t\t\t\t\tconst zIndex = SidePanel.Instance.getTopSlider().getZindex() + 1;\n\t\t\t\t\t\t\t\tevent.target.getZIndexComponent().setZIndex(zIndex);\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t});\n\t\t},\n\t\tonBeforeSelect(event: BaseEvent)\n\t\t{\n\t\t\tthis.$emit('onBeforeSelect', this.callAssessmentSelector.getCurrentCallAssessmentItem()?.id);\n\t\t},\n\t\tonEditCallAssessmentSettings({ target }): void\n\t\t{\n\t\t\ttop.BX.UI.Hint.popupParameters = {\n\t\t\t\tcloseByEsc: true,\n\t\t\t\tautoHide: true,\n\t\t\t\tangle: false,\n\t\t\t};\n\n\t\t\ttop.BX.UI.Hint.show(\n\t\t\t\ttarget,\n\t\t\t\tLoc.getMessage('CRM_COPILOT_CALL_QUALITY_SCRIPT_EDIT_HINT'),\n\t\t\t\tfalse,\n\t\t\t);\n\n\t\t\t// temporary disabled\n\t\t\t// Router.openSlider(\n\t\t\t// \t`/crm/copilot-call-assessment/details/${this.#itemIdentifier.id}/`,\n\t\t\t// \t{\n\t\t\t// \t\twidth: 700,\n\t\t\t// \t\tcacheable: false,\n\t\t\t// \t},\n\t\t\t// );\n\t\t},\n\t\tonShowActualPrompt(): void\n\t\t{\n\t\t\tthis.$emit('onShowActualPrompt');\n\t\t},\n\t\tshowArticle(): void\n\t\t{\n\t\t\twindow.top.BX?.Helper?.show(`redirect=detail&code=${ARTICLE_CODE}`);\n\t\t},\n\t\tformatHtml(source: string): string\n\t\t{\n\t\t\treturn this.htmlFormatter.format({ source });\n\t\t},\n\t\tclose(): void\n\t\t{\n\t\t\tthis.callAssessmentSelector?.close();\n\t\t},\n\t\tdisable(): void\n\t\t{\n\t\t\tthis.callAssessmentSelector?.disable();\n\t\t},\n\t\tenable(): void\n\t\t{\n\t\t\tthis.callAssessmentSelector?.enable();\n\t\t},\n\t\tdoAssessment(): void\n\t\t{\n\t\t\tthis.$emit('doAssessment');\n\t\t},\n\t},\n\n\tmounted()\n\t{\n\t\tDom.append(this.callAssessmentSelector.getContainer(), this.$refs.container);\n\n\t\tif (this.$refs.prompt)\n\t\t{\n\t\t\tDom.append(this.formattedPrompt, this.$refs.prompt);\n\t\t}\n\t},\n\n\tcomputed: {\n\t\tscriptUpdatedAt(): string\n\t\t{\n\t\t\tconst date = new Date(this.promptUpdatedAt);\n\t\t\tconst datetimeConverter = new DatetimeConverter(date);\n\n\t\t\tconst dateString = datetimeConverter.toDatetimeString({\n\t\t\t\twithDayOfWeek: false,\n\t\t\t\tdelimiter: ', ',\n\t\t\t});\n\n\t\t\treturn Loc.getMessage(\n\t\t\t\t'CRM_COPILOT_CALL_QUALITY_SCRIPT_INFO_UPDATED',\n\t\t\t\t{\n\t\t\t\t\t'#UPDATED_AT#': dateString,\n\t\t\t\t},\n\t\t\t);\n\t\t},\n\t\tformattedPrompt(): string\n\t\t{\n\t\t\treturn this.formatHtml(this.prompt);\n\t\t},\n\t\tisShowFooterButtons(): boolean\n\t\t{\n\t\t\treturn (\n\t\t\t\tthis.viewMode !== ViewMode.usedOtherVersionOfScript\n\t\t\t\t&& this.viewMode !== ViewMode.usedNotAssessmentScript\n\t\t\t\t&& this.viewMode !== ViewMode.pending\n\t\t\t\t&& this.assessmentSettingsId > 0\n\t\t\t);\n\t\t},\n\t\tfooterButtonClassList(): Object\n\t\t{\n\t\t\tconst isErrorViewMode = (this.viewMode === ViewMode.error);\n\n\t\t\treturn {\n\t\t\t\t'ui-btn': true,\n\t\t\t\t'ui-btn-xs': true,\n\t\t\t\t'ui-btn-no-caps': true,\n\t\t\t\t'ui-btn-light-border': !isErrorViewMode,\n\t\t\t\t'ui-btn-round': true,\n\t\t\t\t'ui-btn-active': !isErrorViewMode,\n\t\t\t\t'ui-btn-success': isErrorViewMode,\n\t\t\t};\n\t\t},\n\t\tisEmptyScriptListViewMode(): boolean\n\t\t{\n\t\t\treturn this.viewMode === ViewMode.emptyScriptList;\n\t\t},\n\t},\n\n\twatch: {\n\t\tprompt(): void\n\t\t{\n\t\t\tDom.clean(this.$refs.prompt);\n\t\t\tDom.append(this.formattedPrompt, this.$refs.prompt);\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div>\n\t\t\t<div class=\"call-quality__script-selector__container\">\n\t\t\t\t<div class=\"call-quality__script-selector__title\">\n\t\t\t\t\t<div>\n\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('CRM_COPILOT_CALL_QUALITY_SCRIPT_SELECTOR_TITLE') }}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"call-quality__script-selector__selector-container\" ref=\"container\"></div>\n\t\t\t\t\t<div \n\t\t\t\t\t\tclass=\"call-quality__script-selector__article ui-icon-set --help\"\n\t\t\t\t\t\t@click=\"showArticle\"\n\t\t\t\t\t></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div\n\t\t\t\tv-if=\"this.isPromptChanged && isShowFooterButtons\"\n\t\t\t\tclass=\"call-quality__script-info__container\"\n\t\t\t>\n\t\t\t\t<span>{{scriptUpdatedAt}}</span>\n\t\t\t\t<button\n\t\t\t\t\tclass=\"ui-btn ui-btn-xs ui-btn-no-caps ui-btn-round ui-btn-link ui-btn-active\"\n\t\t\t\t\t@click=\"onShowActualPrompt\"\n\t\t\t\t>\n\t\t\t\t\t{{ $Bitrix.Loc.getMessage('CRM_COPILOT_CALL_QUALITY_SCRIPT_INFO_SHOW_NEW_PROMPT') }}\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t\t<div class=\"call-quality__script-container\">\n\t\t\t\t<div\n\t\t\t\t\tv-if=\"isEmptyScriptListViewMode\"\n\t\t\t\t\tclass=\"call-quality__script-text\"\n\t\t\t\t>\n\t\t\t\t\t{{ $Bitrix.Loc.getMessage('CRM_COPILOT_CALL_QUALITY_EMPTY_SCRIPT_LIST_PROMPT_TEXT') }}\n\t\t\t\t</div>\n\t\t\t\t<div v-else class=\"call-quality__script-text\" ref=\"prompt\">\n\t\t\t\t</div>\n\t\t\t\t\n\t\t\t\t<div\n\t\t\t\t\tv-if=\"isShowFooterButtons\"\n\t\t\t\t\tclass=\"call-quality__script-footer\"\n\t\t\t\t>\n\t\t\t\t\t<button \n\t\t\t\t\t\t:class=\"footerButtonClassList\"\n\t\t\t\t\t\t@click=\"doAssessment\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('CRM_COPILOT_CALL_QUALITY_SCRIPT_ASSESSMENT_REPLY') }}\n\t\t\t\t\t</button>\n\t\t\t\t\t<button \n\t\t\t\t\t\tclass=\"ui-btn ui-btn-xs ui-btn-no-caps ui-btn-round ui-btn-light ui-btn-active edit-button\"\n\t\t\t\t\t\t@click=\"onEditCallAssessmentSettings\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('CRM_COPILOT_CALL_QUALITY_SCRIPT_EDIT') }}\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { AudioPlayerComponent } from 'crm.audio-player';\nimport { DatetimeConverter } from 'crm.timeline.tools';\nimport { ajax as Ajax, Loc, Text, Type } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { Pull } from '../pull';\nimport { Compliance as ComplianceComponent } from './compliance';\nimport { EmptyScriptListBlock } from './explanation/empty-script-list-block';\nimport { ErrorBlock } from './explanation/error-block';\nimport { NotAssessmentScriptBlock } from './explanation/not-assessment-script-block';\nimport { OtherScriptBlock } from './explanation/other-script-block';\nimport { PendingBlock } from './explanation/pending-block';\nimport { RecommendationBlock } from './explanation/recommendation-block';\nimport { ScriptSelector as ScriptSelectorComponent } from './script-selector';\nimport { ViewMode, ViewModeType } from './view-mode';\n\ntype Quality = {\n\tid: number;\n\tcreatedAt: number;\n\tassessmentSettingsId: number;\n\tassessment: number;\n\tassessmentAvg: number;\n\tprevAssessmentAvg: number;\n\tisPromptChanged: boolean;\n\tuseInRating: boolean;\n\tprompt: string;\n\tactualPrompt: string;\n\tpromptUpdatedAt: string;\n\ttitle: string;\n\trecommendations: string;\n\tsummary: string;\n}\n\ntype PullData = {\n\tassessmentSettingsId: ?number;\n\tactivityId: number;\n\tjobId: ?number;\n\tratedUserId: ?number;\n\tstatus?: string;\n}\n\nexport const CallQuality = {\n\tcomponents: {\n\t\tAudioPlayerComponent,\n\t\tScriptSelectorComponent,\n\t\tRecommendationBlock,\n\t\tOtherScriptBlock,\n\t\tNotAssessmentScriptBlock,\n\t\tPendingBlock,\n\t\tErrorBlock,\n\t\tEmptyScriptListBlock,\n\t\tComplianceComponent,\n\t},\n\n\tprops: {\n\t\tclient: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tdata: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\taudioProps: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tcontext: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\n\tdata(): Object\n\t{\n\t\tconst quality = this.getPreparedQualityProps(this.data);\n\n\t\tconst currentQualityAssessmentId = quality.id ?? null;\n\t\tlet viewMode: ?ViewModeType = null;\n\t\tif (this.data.viewMode === ViewMode.usedNotAssessmentScript)\n\t\t{\n\t\t\tviewMode = ViewMode.usedNotAssessmentScript;\n\t\t}\n\t\telse if (this.data.viewMode === ViewMode.pending)\n\t\t{\n\t\t\tviewMode = ViewMode.pending;\n\t\t}\n\t\telse if (this.data.viewMode === ViewMode.emptyScriptList)\n\t\t{\n\t\t\tviewMode = ViewMode.emptyScriptList;\n\t\t}\n\t\telse if (quality.id)\n\t\t{\n\t\t\tviewMode = this.data.viewMode ?? ViewMode.usedCurrentVersionOfScript;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tviewMode = ViewMode.error;\n\t\t}\n\n\t\treturn {\n\t\t\tquality,\n\t\t\tcurrentQualityAssessmentId,\n\t\t\tviewMode,\n\t\t\tisShowAudioPlayer: false,\n\t\t\tdirection: this.data.callDirection,\n\t\t};\n\t},\n\n\tmounted()\n\t{\n\t\tthis.pull = new Pull(this.onPullChangeScript);\n\t\tthis.pull.init();\n\t},\n\n\tmethods: {\n\t\tshowAudioPlayer(): void\n\t\t{\n\t\t\tthis.isShowAudioPlayer = true;\n\t\t},\n\t\tonShowActualPrompt(): void\n\t\t{\n\t\t\tthis.viewMode = ViewMode.usedOtherVersionOfScript;\n\t\t},\n\t\tonShowCurrentAssessment(): void\n\t\t{\n\t\t\tthis.viewMode = ViewMode.usedCurrentVersionOfScript;\n\t\t},\n\t\tonDoAssessment(): void\n\t\t{\n\t\t\tthis.viewMode = ViewMode.pending;\n\t\t\tthis.$refs.scriptSelector?.disable();\n\n\t\t\tconst config = {\n\t\t\t\tdata: {\n\t\t\t\t\t...this.context,\n\t\t\t\t\tassessmentSettingsId: this.quality.assessmentSettingsId,\n\t\t\t\t},\n\t\t\t};\n\n\t\t\tAjax\n\t\t\t\t.runAction('crm.copilot.callqualityassessment.doAssessment', config)\n\t\t\t\t.then((response) => {\n\t\t\t\t\tconst { status, data } = response;\n\t\t\t\t\tthis.$refs.scriptSelector?.enable();\n\n\t\t\t\t\tif (status !== 'success')\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.showError(response);\n\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tEventEmitter.emit('crm.ai.callQuality:doAssessment', { data });\n\t\t\t\t})\n\t\t\t\t.catch((response) => {\n\t\t\t\t\tthis.showError(response);\n\t\t\t\t\tthis.$refs.scriptSelector?.enable();\n\t\t\t\t})\n\t\t\t;\n\t\t},\n\t\tonChangeScript(assessmentSettingsId: number): void\n\t\t{\n\t\t\tconst config = {\n\t\t\t\tdata: {\n\t\t\t\t\t...this.context,\n\t\t\t\t\tassessmentSettingsId,\n\t\t\t\t},\n\t\t\t};\n\n\t\t\tAjax\n\t\t\t\t.runAction('crm.copilot.callqualityassessment.get', config)\n\t\t\t\t.then((response) => {\n\t\t\t\t\tthis.$refs.scriptSelector?.enable();\n\n\t\t\t\t\tconst { status, data } = response;\n\n\t\t\t\t\tif (status !== 'success')\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.showError(response);\n\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (Type.isObject(data))\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.quality = this.getPreparedQualityProps(data);\n\t\t\t\t\t\tthis.viewMode = data.viewMode;\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.catch((response) => {\n\t\t\t\t\tthis.$refs.scriptSelector?.enable();\n\t\t\t\t\ttop.BX.UI.Notification.Center.notify({\n\t\t\t\t\t\tcontent: response.errors[0].message,\n\t\t\t\t\t\tautoHideDelay: 5000,\n\t\t\t\t\t});\n\t\t\t\t})\n\t\t\t;\n\t\t},\n\t\tshowError(response)\n\t\t{\n\t\t\tthis.viewMode = ViewMode.error;\n\t\t\tthis.$nextTick(() => {\n\t\t\t\tthis.$refs.errorBlock?.setErrorMessage(response.errors[0]?.message);\n\t\t\t});\n\t\t},\n\t\tgetPreparedQualityProps({ callQuality: quality }): Quality\n\t\t{\n\t\t\tif (!Type.isPlainObject(quality))\n\t\t\t{\n\t\t\t\t// eslint-disable-next-line no-param-reassign\n\t\t\t\tquality = {};\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tid: Number(quality.ID ?? 0),\n\t\t\t\tcreatedAt: quality.CREATED_AT ?? null,\n\t\t\t\tassessmentSettingsId: Number(quality.ASSESSMENT_SETTING_ID ?? 0),\n\t\t\t\tassessment: Number(quality.ASSESSMENT ?? 0),\n\t\t\t\tassessmentAvg: Number(quality.ASSESSMENT_AVG ?? 0),\n\t\t\t\tprevAssessmentAvg: Number(quality.PREV_ASSESSMENT_AVG ?? 0),\n\t\t\t\tisPromptChanged: Boolean(quality.IS_PROMPT_CHANGED ?? false),\n\t\t\t\tuseInRating: Boolean(quality.USE_IN_RATING ?? false),\n\t\t\t\tprompt: quality.PROMPT ?? '',\n\t\t\t\tactualPrompt: quality.ACTUAL_PROMPT ?? '',\n\t\t\t\tpromptUpdatedAt: quality.PROMPT_UPDATED_AT ?? '',\n\t\t\t\ttitle: quality.TITLE ?? '',\n\t\t\t\trecommendations: quality.RECOMMENDATIONS ?? '',\n\t\t\t\tsummary: quality.SUMMARY ?? '',\n\t\t\t};\n\t\t},\n\t\tclose(): void\n\t\t{\n\t\t\tthis.$refs.scriptSelector?.close();\n\t\t\tthis.pull.unsubscribe();\n\t\t},\n\t\tonPullChangeScript(params: PullData): void\n\t\t{\n\t\t\tif (this.context.activityId !== params.activityId)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (params.status === 'error' || !Type.isNumber(params.assessmentSettingsId))\n\t\t\t{\n\t\t\t\tthis.viewMode = ViewMode.error;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.onChangeScript(params.assessmentSettingsId);\n\t\t\t}\n\t\t},\n\t},\n\n\tcomputed: {\n\t\tclientNameClassList(): Object\n\t\t{\n\t\t\treturn {\n\t\t\t\t'call-quality__call-client-name': true,\n\t\t\t\t'--incoming': Number(this.direction) === 1,\n\t\t\t\t'--outgoing': Number(this.direction) === 2,\n\t\t\t}\n\t\t},\n\t\tclientName(): string\n\t\t{\n\t\t\treturn Loc.getMessage('CRM_COPILOT_CALL_QUALITY_AI_CALL_TITLE', {\n\t\t\t\t'[clientname]': `<a href=\"${this.client.detailUrl}\">`,\n\t\t\t\t'[/clientname]': '</a>',\n\t\t\t\t'#CLIENT_NAME#': Text.encode(this.client.fullName),\n\t\t\t});\n\t\t},\n\t\tformattedDate(): string\n\t\t{\n\t\t\tconst datetimeConverter = DatetimeConverter.createFromServerTimestamp(this.client.activityCreated);\n\n\t\t\treturn datetimeConverter.toDatetimeString({\n\t\t\t\twithDayOfWeek: false,\n\t\t\t\tdelimiter: ', ',\n\t\t\t});\n\t\t},\n\t\tisUsedCurrentVersionOfScriptViewMode(): boolean\n\t\t{\n\t\t\treturn this.viewMode === ViewMode.usedCurrentVersionOfScript;\n\t\t},\n\t\tisUsedOtherVersionOfScriptViewMode(): boolean\n\t\t{\n\t\t\treturn this.viewMode === ViewMode.usedOtherVersionOfScript;\n\t\t},\n\t\tisUsedNotAssessmentScriptViewMode(): boolean\n\t\t{\n\t\t\treturn this.viewMode === ViewMode.usedNotAssessmentScript;\n\t\t},\n\t\tisPendingViewMode(): boolean\n\t\t{\n\t\t\treturn this.viewMode === ViewMode.pending;\n\t\t},\n\t\tisErrorViewMode(): boolean\n\t\t{\n\t\t\treturn this.viewMode === ViewMode.error;\n\t\t},\n\t\tisEmptyScriptListViewMode(): boolean\n\t\t{\n\t\t\treturn this.viewMode === ViewMode.emptyScriptList;\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div class=\"call-quality__column --info\">\n\t\t\t<div>\n\t\t\t\t<div class=\"call-quality__header\">\n\t\t\t\t\t<div class=\"call-quality__header-row --flex\">\n\t\t\t\t\t\t<div :class=\"clientNameClassList\" v-html=\"clientName\">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"call-quality__call-date\">\n\t\t\t\t\t\t\t{{ formattedDate }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"call-quality__header-row\">\n\t\t\t\t\t\t<div id=\"crm-textbox-audio-player\" ref=\"audioPlayer\">\n\t\t\t\t\t\t\t<AudioPlayerComponent v-if=\"isShowAudioPlayer\" v-bind=\"audioProps\" />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<ComplianceComponent \n\t\t\t\t\t:assessment=\"quality.assessment\"\n\t\t\t\t\t:title=\"quality.title\"\n\t\t\t\t\t:viewMode=\"viewMode\"\n\t\t\t\t/>\n\t\t\t\t<RecommendationBlock\n\t\t\t\t\tv-if=\"isUsedCurrentVersionOfScriptViewMode\"\n\t\t\t\t\t:recommendations=\"quality.recommendations\"\n\t\t\t\t\t:summary=\"quality.summary\"\n\t\t\t\t\t:use-in-rating=\"quality.useInRating\"\n\t\t\t\t/>\n\t\t\t\t<OtherScriptBlock\n\t\t\t\t\tv-if=\"isUsedOtherVersionOfScriptViewMode\"\n\t\t\t\t\t@showAssessment=\"onShowCurrentAssessment\"\n\t\t\t\t\t@doAssessment=\"onDoAssessment\"\n\t\t\t\t/>\n\t\t\t\t<NotAssessmentScriptBlock\n\t\t\t\t\tv-if=\"isUsedNotAssessmentScriptViewMode\"\n\t\t\t\t\t@doAssessment=\"onDoAssessment\"\n\t\t\t\t/>\n\t\t\t\t<PendingBlock v-if=\"isPendingViewMode\"/>\n\t\t\t\t<ErrorBlock v-if=\"isErrorViewMode\" ref=\"errorBlock\"/>\n\t\t\t\t<EmptyScriptListBlock v-if=\"isEmptyScriptListViewMode\"/>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class=\"call-quality__column --prompt\">\n\t\t\t<ScriptSelectorComponent\n\t\t\t\tref=\"scriptSelector\"\n\t\t\t\t:assessmentSettingsId=\"quality.assessmentSettingsId\"\n\t\t\t\t:assessmentSettingsTitle=\"quality.title\"\n\t\t\t\t:isPromptChanged=\"quality.isPromptChanged\"\n\t\t\t\t:promptUpdatedAt=\"quality.promptUpdatedAt\"\n\t\t\t\t:prompt=\"quality.prompt\"\n\t\t\t\t:viewMode=\"viewMode\"\n\t\t\t\t@onBeforeSelect=\"onChangeScript\"\n\t\t\t\t@onShowActualPrompt=\"onShowActualPrompt\"\n\t\t\t\t@doAssessment=\"onDoAssessment\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","import { Dom, Loc, Tag, Text, Type } from 'main.core';\n\nconst Trend = Object.freeze({\n\tup: 1,\n\tdown: -1,\n\tnoChanges: 0,\n});\n\ntype TrendValue = Trend.up | Trend.down | Trend.noChanges;\n\nconst ARTICLE_CODE = '23240682';\nconst ARTICLE_ANCHOR = 'rate';\n\nexport class Rating\n{\n\t#id: string;\n\t#rating: ?number = null;\n\t#prevRating: ?number = null;\n\t#userPhotoUrl: ?string = null;\n\t#articleCode: string = ARTICLE_CODE;\n\t#articleAnchor: string = ARTICLE_ANCHOR;\n\t#useSkeletonMode: boolean = true;\n\n\tconstructor()\n\t{\n\t\tthis.#id = `crm.ai.call.quality-rating-${Text.getRandom()}`;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tconst content = (\n\t\t\tthis.#useSkeletonMode\n\t\t\t\t? this.#getSkeleton()\n\t\t\t\t: this.#getContent()\n\t\t);\n\n\t\treturn Tag.render`\n\t\t\t<div id=\"${this.#id}\" class=\"call-quality__rating__container\">\n\t\t\t\t${content}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t// @todo\n\t#getSkeleton(): HTMLElement\n\t{\n\t\treturn Tag.render`<div></div>`;\n\t}\n\n\t#getContent(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"call-quality__rating__text-container\">\n\t\t\t\t${Loc.getMessage('CRM_COPILOT_CALL_QUALITY_RATING')}\n\t\t\t\t<div \n\t\t\t\t\tclass=\"call-quality__rating_article ui-icon-set --help\"\n\t\t\t\t\tonclick=\"${this.#showArticle.bind(this)}\"\n\t\t\t\t></div>\n\t\t\t</div>\n\t\t\t<div class=\"call-quality__rating__value-container\">\n\t\t\t\t${this.#getAvatar()}\n\t\t\t\t<div class=\"call-quality__rating__value\">\n\t\t\t\t\t${this.#rating}\n\t\t\t\t\t<span class=\"call-quality__rating__measure\">%</span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"call-quality__rating__trend ${this.#getTrendClass()}\"></div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#getAvatar(): HTMLElement\n\t{\n\t\tif (Type.isStringFilled(this.#userPhotoUrl))\n\t\t{\n\t\t\treturn Tag.render`\n\t\t\t\t<div\n\t\t\t\t\tclass=\"call-quality__rating__avatar\"\n\t\t\t\t\tstyle=\"background-image: url(${encodeURI(this.#userPhotoUrl)})\"\n\t\t\t\t></div>\n\t\t\t`;\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"call-quality__rating__avatar ui-icon ui-icon-common-user\">\n\t\t\t\t<i style=\"\"></i>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#getTrendClass(): string\n\t{\n\t\tconst trend = this.#getTrend();\n\n\t\tif (trend === Trend.up)\n\t\t{\n\t\t\treturn '--up';\n\t\t}\n\n\t\tif (trend === Trend.down)\n\t\t{\n\t\t\treturn '--down';\n\t\t}\n\n\t\treturn '--no-changes';\n\t}\n\n\t#getTrend(): TrendValue\n\t{\n\t\tif (this.#rating > this.#prevRating)\n\t\t{\n\t\t\treturn Trend.up;\n\t\t}\n\n\t\tif (this.#rating < this.#prevRating)\n\t\t{\n\t\t\treturn Trend.down;\n\t\t}\n\n\t\treturn Trend.noChanges;\n\t}\n\n\t#showArticle(): void\n\t{\n\t\twindow.top.BX?.Helper?.show(`redirect=detail&code=${this.#articleCode}&anchor=${this.#articleAnchor}`);\n\t}\n\n\tsetRating(rating: number): void\n\t{\n\t\tthis.#rating = rating;\n\t}\n\n\tsetPrevRating(rating: number): void\n\t{\n\t\tthis.#prevRating = rating;\n\t}\n\n\tsetUserPhotoUrl(userPhotoUrl: string): void\n\t{\n\t\tthis.#userPhotoUrl = userPhotoUrl;\n\t}\n\n\tsetSkeletonMode(useSkeletonMode: boolean = true): void\n\t{\n\t\tif (this.#useSkeletonMode !== useSkeletonMode)\n\t\t{\n\t\t\tthis.#useSkeletonMode = useSkeletonMode;\n\t\t\tthis.#layout();\n\t\t}\n\t}\n\n\t#layout(): void\n\t{\n\t\tconst currentContent = document.getElementById(this.#id);\n\t\tif (currentContent === null)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tDom.replace(currentContent, this.render());\n\t}\n}\n","import { Loc, Tag, Type } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { BitrixVue } from 'ui.vue3';\nimport type { aiCallData } from '../base.js';\nimport { Base } from '../base.js';\nimport './style.css';\nimport { CallQuality as CallQualityComponent } from './components/call-quality';\nimport { Rating } from './rating';\n\nimport 'ui.design-tokens';\n\n/**\n * @memberOf BX.Crm.AI.Call\n *\n */\nexport class CallQuality extends Base\n{\n\t#layoutComponent: ?Object = null;\n\t#app: ?Object = null;\n\trating: Rating;\n\t#jobId: ?number;\n\t#clientDetailUrl: ?string;\n\t#clientFullName: ?string;\n\t#activityCreated: ?number;\n\t#userPhotoUrl: ?string;\n\t#assessmentSettingsId: ?number;\n\n\tconstructor(data: aiCallData)\n\t{\n\t\tsuper(data);\n\n\t\tthis.#jobId = Type.isNumber(data.jobId) ? data.jobId : null;\n\t\tthis.#clientDetailUrl = Type.isStringFilled(data.clientDetailUrl) ? data.clientDetailUrl : null;\n\t\tthis.#clientFullName = Type.isStringFilled(data.clientFullName) ? data.clientFullName : null;\n\t\tthis.#userPhotoUrl = Type.isStringFilled(data.userPhotoUrl) ? data.userPhotoUrl : null;\n\t\tthis.#activityCreated = Type.isNumber(data.activityCreated) ? data.activityCreated : null;\n\t\tthis.#assessmentSettingsId = Type.isNumber(data.assessmentSettingsId) ? data.assessmentSettingsId : null;\n\n\t\tthis.rating = new Rating();\n\t}\n\n\tinitDefaultOptions(): void\n\t{\n\t\tthis.id = 'crm-copilot-call-quality';\n\t\tthis.sliderTitle = Loc.getMessage('CRM_COPILOT_CALL_QUALITY_SLIDER_TITLE');\n\n\t\tconst width = Math.round(BX.SidePanel.Instance.getTopSlider().getWidth() * 0.75);\n\t\tthis.sliderWidth = width > 0 ? width : Math.round(window.screen.width * 0.75);\n\n\t\tthis.textboxTitle = Loc.getMessage('CRM_COPILOT_CALL_TRANSCRIPT_TITLE');\n\n\t\tthis.aiJobResultAndCallRecordAction = 'crm.timeline.ai.getCopilotCallQuality';\n\t}\n\n\tgetExtensions(): Array<string>\n\t{\n\t\tconst extensions = super.getExtensions();\n\n\t\textensions.push('crm.ai.call');\n\n\t\treturn extensions;\n\t}\n\n\tgetSliderContentClass(): ?string\n\t{\n\t\treturn 'crm-copilot-call-quality-wrapper';\n\t}\n\n\tgetSliderDesign(): ?Object\n\t{\n\t\treturn {\n\t\t\tmargin: 0,\n\t\t};\n\t}\n\n\tgetSliderToolbar(): ?Function\n\t{\n\t\treturn () => {\n\t\t\treturn [\n\t\t\t\tthis.rating.render(),\n\t\t\t];\n\t\t};\n\t}\n\n\tgetSliderEvents(): Object\n\t{\n\t\tconst events = super.getSliderEvents();\n\n\t\tevents.onLoad = () => {\n\t\t\tthis.#layoutComponent.showAudioPlayer();\n\t\t};\n\n\t\tevents.onClose = () => {\n\t\t\tthis.#layoutComponent.close();\n\t\t};\n\n\t\treturn events;\n\t}\n\n\t/**\n\t * @override\n\t */\n\topen()\n\t{\n\t\tconst content = new Promise((resolve, reject) => {\n\t\t\tthis.getAiJobResultAndCallRecord()\n\t\t\t\t.then((response) => {\n\t\t\t\t\tconst audioProps = this.prepareAudioProps(response);\n\n\t\t\t\t\tthis.#prepareRating(response.data);\n\n\t\t\t\t\tconst context = {\n\t\t\t\t\t\tactivityId: this.activityId,\n\t\t\t\t\t\townerTypeId: this.ownerTypeId,\n\t\t\t\t\t\townerId: this.ownerId,\n\t\t\t\t\t\tjobId: this.#jobId,\n\t\t\t\t\t};\n\n\t\t\t\t\tthis.#app = BitrixVue.createApp(CallQualityComponent, {\n\t\t\t\t\t\tclient: {\n\t\t\t\t\t\t\tdetailUrl: this.#clientDetailUrl,\n\t\t\t\t\t\t\tfullName: this.#clientFullName,\n\t\t\t\t\t\t\tactivityCreated: this.#activityCreated,\n\t\t\t\t\t\t},\n\t\t\t\t\t\tdata: response.data,\n\t\t\t\t\t\taudioProps,\n\t\t\t\t\t\tcontext,\n\t\t\t\t\t});\n\n\t\t\t\t\tconst container = Tag.render`<div class=\"call-quality__container\"></div>`;\n\t\t\t\t\tthis.#layoutComponent = this.#app.mount(container);\n\n\t\t\t\t\tEventEmitter.subscribe('crm.ai.callQuality:doAssessment', () => {\n\t\t\t\t\t\t// @todo will the slider close?\n\t\t\t\t\t\t//this.wrapperSlider?.close();\n\t\t\t\t\t});\n\n\t\t\t\t\tresolve(container);\n\t\t\t\t})\n\t\t\t\t.catch((response) => {\n\t\t\t\t\tthis.showError(response);\n\t\t\t\t\tthis.wrapperSlider.destroy();\n\t\t\t\t})\n\t\t\t;\n\t\t});\n\n\t\tthis.wrapperSlider.setContent(content);\n\t\tthis.wrapperSlider.open();\n\t}\n\n\tgetAiJobResultAndCallRecord(): Promise\n\t{\n\t\tconst actionData = {\n\t\t\tdata: {\n\t\t\t\tactivityId: this.activityId,\n\t\t\t\townerTypeId: this.ownerTypeId,\n\t\t\t\townerId: this.ownerId,\n\t\t\t\tjobId: this.#jobId,\n\t\t\t\tassessmentSettingsId: this.#assessmentSettingsId,\n\t\t\t},\n\t\t};\n\n\t\treturn BX.ajax.runAction(this.aiJobResultAndCallRecordAction, actionData);\n\t}\n\n\tgetNotAccuratePhraseCode(): string\n\t{\n\t\treturn 'CRM_COPILOT_CALL_TRANSCRIPT_NOT_BE_ACCURATE';\n\t}\n\n\t#prepareRating({ callQuality }): void\n\t{\n\t\tif (!Type.isPlainObject(callQuality))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst { rating } = this;\n\n\t\tif (callQuality)\n\t\t{\n\t\t\trating.setRating(callQuality?.ASSESSMENT_AVG);\n\t\t\trating.setPrevRating(callQuality?.PREV_ASSESSMENT_AVG);\n\t\t}\n\n\t\tif (Type.isStringFilled(this.#userPhotoUrl))\n\t\t{\n\t\t\trating.setUserPhotoUrl(this.#userPhotoUrl);\n\t\t}\n\n\t\trating.setSkeletonMode(false);\n\t}\n}\n","import { Loc } from 'main.core';\nimport { Base } from './base.js';\n\n/**\n * @memberOf BX.Crm.AI.Call\n */\nexport class Summary extends Base\n{\n\tinitDefaultOptions(): void\n\t{\n\t\tthis.id = 'crm-copilot-summary';\n\t\tthis.aiJobResultAndCallRecordAction = 'crm.timeline.ai.getCopilotSummaryAndCallRecord';\n\n\t\tthis.sliderTitle = Loc.getMessage('CRM_COMMON_COPILOT');\n\t\tthis.sliderWidth = 520;\n\n\t\tthis.textboxTitle = Loc.getMessage('CRM_COPILOT_CALL_SUMMARY_TITLE');\n\t}\n\n\tgetNotAccuratePhraseCode(): string\n\t{\n\t\treturn 'CRM_COPILOT_CALL_SUMMARY_NOT_BE_ACCURATE';\n\t}\n\n\tprepareAiJobResult(response: Object): string\n\t{\n\t\treturn response.data.aiJobResult.summary;\n\t}\n}\n","import { Loc } from 'main.core';\nimport { Base } from './base.js';\n\n/**\n * @memberOf BX.Crm.AI.Call\n */\nexport class Transcription extends Base\n{\n\tinitDefaultOptions(): void\n\t{\n\t\tthis.id = 'crm-copilot-transcript';\n\t\tthis.aiJobResultAndCallRecordAction = 'crm.timeline.ai.getCopilotTranscriptAndCallRecord';\n\n\t\tthis.sliderTitle = Loc.getMessage('CRM_COMMON_COPILOT');\n\t\tthis.sliderWidth = 730;\n\n\t\tthis.textboxTitle = Loc.getMessage('CRM_COPILOT_CALL_TRANSCRIPT_TITLE');\n\t}\n\n\tgetNotAccuratePhraseCode(): string\n\t{\n\t\treturn 'CRM_COPILOT_CALL_TRANSCRIPT_NOT_BE_ACCURATE';\n\t}\n\n\tprepareAiJobResult(response: Object): string\n\t{\n\t\treturn response.data.aiJobResult.transcription;\n\t}\n}\n","import { CallQuality } from './call-quality/call-quality';\nimport { Summary } from './summary.js';\nimport { Transcription } from './transcription.js';\n\nexport const Call = {\n\tSummary,\n\tTranscription,\n\tCallQuality,\n};\n"],"names":["Base","data","initDefaultOptions","activityId","ownerTypeId","ownerId","languageTitle","audioPlayerNode","Tag","render","audioPlayerApp","AudioPlayer","rootNode","textbox","Textbox","title","textboxTitle","previousTextContent","attentions","getTextboxAttentions","sliderId","id","Math","floor","random","wrapperSlider","Slider","url","sliderTitle","sliderContentClass","getSliderContentClass","width","sliderWidth","extensions","getExtensions","design","getSliderDesign","events","getSliderEvents","toolbar","getSliderToolbar","onLoad","attachTemplate","onClose","detachTemplate","content","Promise","resolve","reject","getAiJobResultAndCallRecord","then","response","audioProps","prepareAudioProps","setAudioProps","aiJobResult","prepareAiJobResult","setText","get","showError","destroy","setContent","open","actionData","BX","ajax","runAction","aiJobResultAndCallRecordAction","UI","Notification","Center","notify","errors","message","autoHideDelay","callRecord","src","context","window","top","getNotAccurateAttention","jobLanguageAttention","getJobLanguageAttention","push","helpdeskCode","Loc","getMessage","getNotAccuratePhraseCode","Attention","Type","isStringFilled","Text","encode","preset","AttentionPresets","COPILOT","CALL_SCORING_ADD_COMMAND","Pull","callback","PULL","console","error","subscribe","moduleId","command","params","extendWatch","ViewMode","Object","freeze","usedNotAssessmentScript","usedCurrentVersionOfScript","usedOtherVersionOfScript","emptyScriptList","pending","Compliance","props","type","String","required","assessment","Number","viewMode","mounted","startAnimate","methods","$refs","animateCounter","counterElement","targetNumber","startNumber","duration","increment","interval","setInterval","clearInterval","textContent","computed","classList","isUsedCurrentVersionOfScript","infoTitle","valueTitle","template","EmptyScriptListBlock","text","ErrorBlock","errorText","setErrorMessage","explanationText","NotAssessmentScriptBlock","doAssessment","$emit","buttonText","OtherScriptBlock","showAssessment","buttonShowText","buttonDoText","PendingBlock","renderLottieAnimation","mainAnimation","Lottie","loadAnimation","path","getAnimationPath","container","lottie","renderer","loop","autoplay","setSpeed","root","ARTICLE_CODE","RecommendationBlock","recommendations","summary","useInRating","Boolean","showArticle","Helper","show","ScriptSelectorDisplayStrategy","_classPrivateFieldInitSpec","titleNode","innerTitleNode","innerText","isLoading","Dom","toggleClass","ScriptSelector","assessmentSettingsId","assessmentSettingsTitle","isPromptChanged","promptUpdatedAt","prompt","callAssessmentSelector","getCallAssessmentSelector","htmlFormatter","HtmlFormatter","CallAssessmentSelector","currentCallAssessment","emptyScriptListTitle","displayStrategy","additionalSelectorOptions","dialog","onBeforeSelect","bind","popup","onShow","event","zIndex","SidePanel","Instance","getTopSlider","getZindex","target","getZIndexComponent","setZIndex","getCurrentCallAssessmentItem","onEditCallAssessmentSettings","Hint","popupParameters","closeByEsc","autoHide","angle","onShowActualPrompt","formatHtml","source","format","close","disable","enable","append","getContainer","formattedPrompt","scriptUpdatedAt","date","Date","datetimeConverter","DatetimeConverter","dateString","toDatetimeString","withDayOfWeek","delimiter","isShowFooterButtons","footerButtonClassList","isErrorViewMode","isEmptyScriptListViewMode","watch","clean","CallQuality","components","AudioPlayerComponent","ScriptSelectorComponent","ComplianceComponent","client","quality","getPreparedQualityProps","currentQualityAssessmentId","isShowAudioPlayer","direction","callDirection","pull","onPullChangeScript","init","showAudioPlayer","onShowCurrentAssessment","onDoAssessment","scriptSelector","config","Ajax","status","EventEmitter","emit","onChangeScript","isObject","$nextTick","errorBlock","callQuality","isPlainObject","ID","createdAt","CREATED_AT","ASSESSMENT_SETTING_ID","ASSESSMENT","assessmentAvg","ASSESSMENT_AVG","prevAssessmentAvg","PREV_ASSESSMENT_AVG","IS_PROMPT_CHANGED","USE_IN_RATING","PROMPT","actualPrompt","ACTUAL_PROMPT","PROMPT_UPDATED_AT","TITLE","RECOMMENDATIONS","SUMMARY","unsubscribe","isNumber","clientNameClassList","clientName","detailUrl","fullName","formattedDate","createFromServerTimestamp","activityCreated","isUsedCurrentVersionOfScriptViewMode","isUsedOtherVersionOfScriptViewMode","isUsedNotAssessmentScriptViewMode","isPendingViewMode","Trend","up","down","noChanges","ARTICLE_ANCHOR","Rating","_classPrivateMethodInitSpec","getRandom","rating","userPhotoUrl","useSkeletonMode","_classPrivateMethodGet","encodeURI","trend","currentContent","document","getElementById","replace","jobId","clientDetailUrl","clientFullName","round","getWidth","screen","margin","BitrixVue","createApp","CallQualityComponent","mount","setRating","setPrevRating","setUserPhotoUrl","setSkeletonMode","Summary","Transcription","transcription","Call"],"mappings":"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"}