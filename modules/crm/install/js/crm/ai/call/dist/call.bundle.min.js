this.BX=this.BX||{};this.BX.Crm=this.BX.Crm||{};(function(e,t,i,r,a,o){"use strict";var s;var l=function(){function e(t){var l=this;babelHelpers.classCallCheck(this,e);this.initDefaultOptions();this.activityId=t.activityId;this.ownerTypeId=t.ownerTypeId;this.ownerId=t.ownerId;var n=o.Tag.render(s||(s=babelHelpers.taggedTemplateLiteral(['<div id="crm-textbox-audio-player"></div>'])));this.audioPlayerApp=new a.AudioPlayer({rootNode:n});this.textbox=new r.Textbox({title:this.textboxTitle,previousTextContent:n});this.sliderId="".concat(this.id,"-").concat(Math.floor(Math.random()*1e3));this.wrapperSlider=new i.Slider({url:this.sliderId,sliderTitle:this.sliderTitle,width:this.sliderWidth,extensions:["crm.ai.textbox","crm.audio-player"],events:{onLoad:function e(){l.audioPlayerApp.attachTemplate()},onClose:function e(){l.audioPlayerApp.detachTemplate()}}})}babelHelpers.createClass(e,[{key:"open",value:function e(){var t=this;var i=new Promise((function(e,i){t.getAiJobResultAndCallRecord().then((function(i){var r=t.prepareAudioProps(i);t.audioPlayerApp.setAudioProps(r);var a=t.prepareAiJobResult(i);t.textbox.setText(a);t.textbox.render();e(t.textbox.get())}))["catch"]((function(e){t.showError(e);t.wrapperSlider.destroy()}))}));this.wrapperSlider.setContent(i);this.wrapperSlider.open()}},{key:"getAiJobResultAndCallRecord",value:function e(){var t={data:{activityId:this.activityId,ownerTypeId:this.ownerTypeId,ownerId:this.ownerId}};return BX.ajax.runAction(this.aiJobResultAndCallRecordAction,t)}},{key:"showError",value:function e(i){t.UI.Notification.Center.notify({content:i.errors[0].message,autoHideDelay:5e3})}},{key:"prepareAiJobResult",value:function e(t){return""}},{key:"prepareAudioProps",value:function e(t){var i=t.data.callRecord;return{id:i.id,src:i.src,title:i.title,context:window.top}}},{key:"getSliderTitle",value:function e(){return""}},{key:"getTextboxTitle",value:function e(){return""}},{key:"initDefaultOptions",value:function e(){}}]);return e}();var n=function(e){babelHelpers.inherits(t,e);function t(){babelHelpers.classCallCheck(this,t);return babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).apply(this,arguments))}babelHelpers.createClass(t,[{key:"initDefaultOptions",value:function e(){this.id="crm-copilot-summary";this.aiJobResultAndCallRecordAction="crm.timeline.ai.getCopilotSummaryAndCallRecord";this.sliderTitle=o.Loc.getMessage("CRM_COMMON_COPILOT");this.sliderWidth=520;this.textboxTitle=o.Loc.getMessage("CRM_COPILOT_CALL_SUMMARY_TITLE")}},{key:"prepareAiJobResult",value:function e(t){return t.data.aiJobResult.summary}}]);return t}(l);var u=function(e){babelHelpers.inherits(t,e);function t(){babelHelpers.classCallCheck(this,t);return babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).apply(this,arguments))}babelHelpers.createClass(t,[{key:"initDefaultOptions",value:function e(){this.id="crm-copilot-transcript";this.aiJobResultAndCallRecordAction="crm.timeline.ai.getCopilotTranscriptAndCallRecord";this.sliderTitle=o.Loc.getMessage("CRM_COMMON_COPILOT");this.sliderWidth=730;this.textboxTitle=o.Loc.getMessage("CRM_COPILOT_CALL_TRANSCRIPT_TITLE")}},{key:"prepareAiJobResult",value:function e(t){return t.data.aiJobResult.transcription}}]);return t}(l);var c={Summary:n,Transcription:u};e.Call=c})(this.BX.Crm.AI=this.BX.Crm.AI||{},BX,BX.Crm.AI,BX.Crm.AI,BX.Crm,BX);
//# sourceMappingURL=call.bundle.map.js