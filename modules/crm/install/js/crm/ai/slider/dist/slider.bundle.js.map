{"version":3,"file":"slider.bundle.js","sources":["../src/slider.js"],"sourcesContent":["import { Dom, Loc, Type } from 'main.core';\nimport { Button } from 'ui.buttons';\nimport { SidePanel } from 'ui.sidepanel';\nimport { Layout } from 'ui.sidepanel.layout';\n\nimport './style.css';\n\nexport class Slider\n{\n\tDEFAULT_OPTIONS = {\n\t\ttitle: Loc.getMessage('CRM_COMMON_COPILOT'),\n\t\tallowChangeTitle: false,\n\t\tallowChangeHistory: false,\n\t\tcacheable: false,\n\t\ttoolbar: this.getDefaultToolbarButtons,\n\t\tbuttons: [],\n\t\twidth: 795,\n\t\textensions: [],\n\t\tevents: {},\n\t\tlabel: {},\n\t\tdesign: {},\n\t\tsliderContentClass: null,\n\t};\n\n\tisOpen = false;\n\n\t#openedLayout: ?Layout = null;\n\n\tget openedLayout(): ?Layout {\n\t\treturn this.#openedLayout;\n\t}\n\n\tconstructor(options): void\n\t{\n\t\tthis.initOptions(options);\n\t}\n\n\tinitOptions(options): void\n\t{\n\t\tthis.title = (Type.isString(options.title)) ? options.title : this.DEFAULT_OPTIONS.title;\n\t\tthis.sliderTitle = (Type.isString(options.sliderTitle)) ? options.sliderTitle : this.DEFAULT_OPTIONS.title;\n\t\tthis.sliderContentClass = (\n\t\t\tType.isStringFilled(options.sliderContentClass)\n\t\t\t\t? options.sliderContentClass\n\t\t\t\t: this.DEFAULT_OPTIONS.sliderContentClass\n\t\t);\n\t\tthis.toolbar = (Type.isFunction(options.toolbar)) ? options.toolbar : this.DEFAULT_OPTIONS.toolbar;\n\t\tthis.buttons = Type.isFunction(options.buttons) ? options.buttons : this.DEFAULT_OPTIONS.buttons;\n\t\tthis.cacheable = (Type.isBoolean(options.cacheable)) ? options.cacheable : this.DEFAULT_OPTIONS.cacheable;\n\t\tthis.width = Type.isInteger(options.width) ? options.width : this.DEFAULT_OPTIONS.width;\n\t\tthis.label = Type.isPlainObject(options.label) ? options.label : this.DEFAULT_OPTIONS.label;\n\t\tthis.extensions = Type.isArray(options.extensions) ? options.extensions : this.DEFAULT_OPTIONS.extensions;\n\t\tthis.events = Type.isPlainObject(options.events) ? options.events : this.DEFAULT_OPTIONS.events;\n\t\tthis.design = Type.isPlainObject(options.design) ? options.design : this.DEFAULT_OPTIONS.design;\n\n\t\t// Need to buttons to always be transparent-white when enable DependOnTheme in Button\n\t\tthis.enableLightThemeIntoSlider = Type.isBoolean(options.enableLightThemeIntoSlider)\n\t\t\t? options.enableLightThemeIntoSlider\n\t\t\t: true\n\t\t;\n\n\t\tthis.allowChangeTitle = (Type.isBoolean(options.allowChangeTitle))\n\t\t\t? options.allowChangeTitle\n\t\t\t: this.DEFAULT_OPTIONS.allowChangeTitle\n\t\t;\n\t\tthis.allowChangeHistory = (Type.isBoolean(options.allowChangeHistory))\n\t\t\t? options.allowChangeHistory\n\t\t\t: this.DEFAULT_OPTIONS.allowChangeHistory\n\t\t;\n\n\t\tthis.setContent(options.content);\n\t\tthis.url = Type.isString(options.url) ? options.url : this.getDefaultUrl();\n\t}\n\n\tsetContent(content): void\n\t{\n\t\tif (!Type.isFunction(content))\n\t\t{\n\t\t\tthis.content = () => {\n\t\t\t\treturn content;\n\t\t\t};\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.content = content;\n\t}\n\n\tasync open(): Boolean\n\t{\n\t\tthis.#openedLayout = await this.makeLayout();\n\t\tthis.isOpen = SidePanel.Instance.open(this.url, await this.getSliderOptions(this.#openedLayout));\n\n\t\treturn this.isOpen;\n\t}\n\n\tclose(): void\n\t{\n\t\tif (!this.isOpen)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tthis.#openedLayout = null;\n\t\tSidePanel.Instance.close();\n\t}\n\n\tdestroy(): void\n\t{\n\t\tSidePanel.Instance.destroy(this.url);\n\t}\n\n\tgetInstance(): SidePanel\n\t{\n\t\treturn SidePanel.Instance;\n\t}\n\n\tgetDefaultUrl(): String\n\t{\n\t\treturn 'crm.copilot-wrapper';\n\t}\n\n\tasync makeLayout(): Promise<Layout>\n\t{\n\t\treturn Layout.createLayout({\n\t\t\ttitle: this.sliderTitle,\n\t\t\ttoolbar: this.toolbar,\n\t\t\tcontent: this.content,\n\t\t\tbuttons: this.buttons,\n\t\t\tdesign: { section: false, ...this.design },\n\t\t\textensions: ['crm.ai.slider', ...this.extensions],\n\t\t});\n\t}\n\n\tasync getSliderOptions(layout: Layout): Object\n\t{\n\t\treturn {\n\t\t\tcontentClassName: this.getSliderContentClassName(),\n\t\t\ttitle: this.title,\n\t\t\tallowChangeTitle: this.allowChangeTitle,\n\t\t\twidth: this.width,\n\t\t\tcacheable: this.cacheable,\n\t\t\tallowChangeHistory: this.allowChangeHistory,\n\t\t\tlabel: this.label,\n\t\t\tcontentCallback: (slider) => {\n\t\t\t\treturn layout.render();\n\t\t\t},\n\t\t\tevents: this.events,\n\t\t};\n\t}\n\n\tgetSliderContentClassName(): String\n\t{\n\t\tlet className = 'crm-copilot-wrapper';\n\n\t\tif (this.enableLightThemeIntoSlider)\n\t\t{\n\t\t\tclassName += ' bitrix24-light-theme';\n\t\t}\n\n\t\tif (this.sliderContentClass)\n\t\t{\n\t\t\tclassName += ` ${this.sliderContentClass}`;\n\t\t}\n\n\t\treturn className;\n\t}\n\n\tgetDefaultToolbarButtons(): Array\n\t{\n\t\treturn Slider.makeDefaultToolbarButtons();\n\t}\n\n\tstatic makeDefaultToolbarButtons(): Array\n\t{\n\t\tconst helpdeskCode = '18799442';\n\t\tconst helpButton = new Button({\n\t\t\ttext: Loc.getMessage('CRM_COPILOT_WRAPPER_HELP_BUTTON_TITLE'),\n\t\t\tsize: Button.Size.MEDIUM,\n\t\t\tcolor: Button.Color.LIGHT_BORDER,\n\t\t\tdependOnTheme: true,\n\t\t\tonclick: () => {\n\t\t\t\tif (top.BX.Helper)\n\t\t\t\t{\n\t\t\t\t\ttop.BX.Helper.show(`redirect=detail&code=${helpdeskCode}`);\n\t\t\t\t}\n\t\t\t},\n\t\t});\n\n\t\treturn [helpButton];\n\t}\n\n\tfooterDisplay(show: boolean): void\n\t{\n\t\tif (!this.#openedLayout)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.#openedLayout.getFooterContainer())\n\t\t{\n\t\t\tDom.style(this.#openedLayout.getFooterContainer(), 'display', show ? 'block' : 'none');\n\t\t}\n\n\t\tconst footerAnchor = this.#openedLayout.getContainer()?.getElementsByClassName('ui-sidepanel-layout-footer-anchor')[0];\n\t\tif (footerAnchor)\n\t\t{\n\t\t\tDom.style(footerAnchor, 'display', show ? 'block' : 'none');\n\t\t}\n\t}\n}\n"],"names":["Slider","options","title","Loc","getMessage","allowChangeTitle","allowChangeHistory","cacheable","toolbar","getDefaultToolbarButtons","buttons","width","extensions","events","label","design","sliderContentClass","initOptions","Type","isString","DEFAULT_OPTIONS","sliderTitle","isStringFilled","isFunction","isBoolean","isInteger","isPlainObject","isArray","enableLightThemeIntoSlider","setContent","content","url","getDefaultUrl","makeLayout","SidePanel","Instance","getSliderOptions","isOpen","open","close","destroy","Layout","createLayout","section","layout","contentClassName","getSliderContentClassName","contentCallback","slider","render","className","makeDefaultToolbarButtons","show","getFooterContainer","Dom","style","footerAnchor","getContainer","getElementsByClassName","helpdeskCode","helpButton","Button","text","size","Size","MEDIUM","color","Color","LIGHT_BORDER","dependOnTheme","onclick","top","BX","Helper"],"mappings":"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"}