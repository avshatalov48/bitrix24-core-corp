this.BX=this.BX||{};this.BX.Crm=this.BX.Crm||{};this.BX.Crm.AI=this.BX.Crm.AI||{};(function(e,t,a,i,n){"use strict";function s(e,t,a,i){return c(e).then((n=>{if(!n){return o(e,t,a,i)}return Promise.resolve()}))}function c(e){return new Promise(((t,i)=>{a.ajax.runAction("crm.timeline.ai.wasFeedbackSent",{data:{mergeUuid:e}}).then((({data:e})=>{if(a.Type.isBoolean(e)){t(e)}else{t(false)}})).catch(((...e)=>i(...e)))}))}function r(e,n,s,c){a.ajax.runAction("crm.timeline.ai.sendFeedback",{data:{mergeUuid:e}}).then((()=>{i.sendData(t.Builder.AI.CallParsingEvent.createDefault(n,s,t.Dictionary.STATUS_SUCCESS).setElement(t.Dictionary.ELEMENT_FEEDBACK_SEND).setActivityDirection(c).buildData());i.sendData(t.Builder.AI.CallParsingEvent.createDefault(n,s,t.Dictionary.STATUS_SUCCESS).setTool(t.Dictionary.TOOL_CRM).setCategory(t.Dictionary.CATEGORY_AI_OPERATIONS).setElement(t.Dictionary.ELEMENT_FEEDBACK_SEND).setActivityDirection(c).buildData())})).catch((({errors:e})=>console.error("Error sending feedback",e)))}function o(e,a,n,s){return new Promise((c=>{const o=E({onOk:()=>{r(e,a,n,s);o.close();c()},onCancel:()=>{o.close();i.sendData(t.Builder.AI.CallParsingEvent.createDefault(a,n,t.Dictionary.STATUS_SUCCESS).setElement(t.Dictionary.ELEMENT_FEEDBACK_REFUSED).setActivityDirection(s).buildData());i.sendData(t.Builder.AI.CallParsingEvent.createDefault(a,n,t.Dictionary.STATUS_SUCCESS).setTool(t.Dictionary.TOOL_CRM).setCategory(t.Dictionary.CATEGORY_AI_OPERATIONS).setElement(t.Dictionary.ELEMENT_FEEDBACK_REFUSED).setActivityDirection(s).buildData());c()}});o.show()}))}function E(e){const t=`\n\t\t<div class="bx-crm-ai-feedback-popup-content">\n\t\t\t<div class="bx-crm-ai-feedback-popup-content__icon"></div>\n\t\t\t<div class="bx-crm-ai-feedback-popup-content__text">\n\t\t\t\t${a.Loc.getMessage("CRM_AI_FEEDBACK_POPUP_TEXT")}\n\t\t\t</div>\n\t\t</div>\n\t`;return n.MessageBox.create({title:a.Loc.getMessage("CRM_AI_FEEDBACK_POPUP_TITLE"),message:t,okCaption:a.Loc.getMessage("CRM_AI_FEEDBACK_POPUP_BUTTON_SHARE"),cancelCaption:a.Loc.getMessage("CRM_AI_FEEDBACK_POPUP_BUTTON_ANOTHER_TIME"),buttons:BX.UI.Dialogs.MessageBoxButtons.OK_CANCEL,...e})}e.showSendFeedbackPopupIfFeedbackWasNeverSent=s;e.wasFeedbackSent=c;e.sendFeedback=r;e.showSendFeedbackPopup=o;e.createFeedbackMessageBox=E})(this.BX.Crm.AI.Feedback=this.BX.Crm.AI.Feedback||{},BX.Crm.Integration.Analytics,BX,BX.UI.Analytics,BX.UI.Dialogs);
//# sourceMappingURL=feedback.bundle.map.js