this.BX=this.BX||{};this.BX.Crm=this.BX.Crm||{};(function(e,t,a,l,i){"use strict";var r,s,n,d,c;function o(e,t){b(e,t);t.add(e)}function p(e,t,a){b(e,t);t.set(e,a)}function b(e,t){if(t.has(e)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}function h(e,t,a){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return a}var v="crm-template-editor-element-pill";var u=new WeakMap;var m=new WeakMap;var w=new WeakMap;var T=new WeakMap;var H=new WeakMap;var y=new WeakMap;var f=new WeakMap;var g=new WeakMap;var P=new WeakMap;var F=new WeakMap;var E=new WeakMap;var S=new WeakMap;var k=new WeakMap;var M=new WeakSet;var C=new WeakSet;var D=new WeakSet;var G=new WeakSet;var B=new WeakSet;var W=function(){function e(a){babelHelpers.classCallCheck(this,e);o(this,B);o(this,G);o(this,D);o(this,C);o(this,M);p(this,u,{writable:true,value:void 0});p(this,m,{writable:true,value:null});p(this,w,{writable:true,value:null});p(this,T,{writable:true,value:null});p(this,H,{writable:true,value:null});p(this,y,{writable:true,value:null});p(this,f,{writable:true,value:null});p(this,g,{writable:true,value:null});p(this,P,{writable:true,value:null});p(this,F,{writable:true,value:null});p(this,E,{writable:true,value:null});p(this,S,{writable:true,value:null});p(this,k,{writable:true,value:null});h(this,B,A).call(this,a);babelHelpers.classPrivateFieldSet(this,u,a.id||"crm-template-editor-".concat(t.Text.getRandom()));babelHelpers.classPrivateFieldSet(this,m,a.target);babelHelpers.classPrivateFieldSet(this,w,a.entityTypeId);babelHelpers.classPrivateFieldSet(this,T,a.entityId);babelHelpers.classPrivateFieldSet(this,H,t.Type.isNumber(a.entityId)?a.entityId:null);babelHelpers.classPrivateFieldSet(this,y,t.Type.isStringFilled(a.placeHolderMaskRe)?a.placeHolderMaskRe:/{{\s+(\d+)\s+}}/g);babelHelpers.classPrivateFieldSet(this,F,{multiple:false,showAvatars:false,dropdownMode:true,compactView:true,enableSearch:true,tagSelectorOptions:{textBoxWidth:"100%"},entities:[{id:"placeholder",options:{entityTypeId:babelHelpers.classPrivateFieldGet(this,w),entityId:babelHelpers.classPrivateFieldGet(this,T),categoryId:babelHelpers.classPrivateFieldGet(this,H)}}]});h(this,M,I).call(this);h(this,G,_).call(this)}babelHelpers.createClass(e,[{key:"setHeader",value:function e(a){if(!t.Type.isStringFilled(a)){return}babelHelpers.classPrivateFieldSet(this,E,a);t.Dom.append(h(this,C,L).call(this,a),babelHelpers.classPrivateFieldGet(this,f))}},{key:"setBody",value:function e(a){if(!t.Type.isStringFilled(a)){return}babelHelpers.classPrivateFieldSet(this,S,a);t.Dom.append(h(this,C,L).call(this,a),babelHelpers.classPrivateFieldGet(this,g))}},{key:"setFooter",value:function e(a){if(!t.Type.isStringFilled(a)){return}babelHelpers.classPrivateFieldSet(this,k,a);t.Dom.append(h(this,C,L).call(this,a),babelHelpers.classPrivateFieldGet(this,P))}},{key:"getData",value:function e(){return{header:h(this,D,X).call(this,babelHelpers.classPrivateFieldGet(this,f)),body:h(this,D,X).call(this,babelHelpers.classPrivateFieldGet(this,g)),footer:h(this,D,X).call(this,babelHelpers.classPrivateFieldGet(this,P))}}},{key:"getRawData",value:function e(){return{header:babelHelpers.classPrivateFieldGet(this,E),body:babelHelpers.classPrivateFieldGet(this,S),footer:babelHelpers.classPrivateFieldGet(this,k)}}}]);return e}();function I(){if(!babelHelpers.classPrivateFieldGet(this,m)){return}var e=t.Tag.render(r||(r=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div id="','" class="crm-template-editor crm-template-editor__scope"></div>\n\t\t'])),babelHelpers.classPrivateFieldGet(this,u));babelHelpers.classPrivateFieldSet(this,f,t.Tag.render(s||(s=babelHelpers.taggedTemplateLiteral(['<div class="crm-template-editor-header"></div>']))));t.Dom.append(babelHelpers.classPrivateFieldGet(this,f),e);babelHelpers.classPrivateFieldSet(this,g,t.Tag.render(n||(n=babelHelpers.taggedTemplateLiteral(['<div class="crm-template-editor-body"></div>']))));t.Dom.append(babelHelpers.classPrivateFieldGet(this,g),e);babelHelpers.classPrivateFieldSet(this,P,t.Tag.render(d||(d=babelHelpers.taggedTemplateLiteral(['<div class="crm-template-editor-footer"></div>']))));t.Dom.append(babelHelpers.classPrivateFieldGet(this,P),e);t.Dom.append(e,babelHelpers.classPrivateFieldGet(this,m))}function L(e){var a=e.match(babelHelpers.classPrivateFieldGet(this,y));if(!a){return e}var i=e.replace(babelHelpers.classPrivateFieldGet(this,y),'<span class="'.concat(v,'">').concat(t.Loc.getMessage("CRM_TEMPLATE_EDITOR_EMPTY_PLACEHOLDER_LABEL"),"</span>"));var r=t.Tag.render(c||(c=babelHelpers.taggedTemplateLiteral(["<div>","</div>"])),i);var s=babelHelpers.classPrivateFieldGet(this,F);var n=r.querySelectorAll(".".concat(v));n.forEach((function(e){s.events={"Item:onSelect":function a(l){var i=l.getData().item;e.textContent=i.getTitle();t.Dom.attr(e,"placeholder-id",i.id);t.Dom.addClass(e,"--selected")},"Item:onDeselect":function a(l){e.textContent=t.Loc.getMessage("CRM_TEMPLATE_EDITOR_EMPTY_PLACEHOLDER_LABEL");t.Dom.attr(e,"placeholder-id","");t.Dom.removeClass(e,"--selected")}};s.targetNode=e;var a=new l.Dialog(s);t.Event.bind(e,"click",(function(){return a.show()}))}));return r}function X(e){if(!t.Type.isDomNode(e)){return null}var a=t.Runtime.clone(e);var l=a.querySelectorAll(".".concat(v));l.forEach((function(e){e.textContent=e!==null&&e!==void 0&&e.hasAttribute("placeholder-id")?"{".concat(e.getAttribute("placeholder-id"),"}"):""}));return a.textContent}function _(){}function A(e){if(!t.Type.isPlainObject(e)){throw new TypeError('BX.Crm.Template.Editor: The "params" argument must be object')}if(!t.Type.isDomNode(e.target)){throw new Error('BX.Crm.Template.Editor: The "target" argument must be DOM node')}if(!BX.CrmEntityType.isDefined(e.entityTypeId)){throw new TypeError('BX.Crm.Template.Editor: The "entityTypeId" argument is not correct')}if(!t.Type.isNumber(e.entityId)||e.entityId<=0){throw new TypeError('BX.Crm.Template.Editor: The "entityId" argument is not correct')}}e.Editor=W})(this.BX.Crm.Template=this.BX.Crm.Template||{},BX,BX.Event,BX.Crm.EntitySelectorEx,BX.UI.EntitySelector);
//# sourceMappingURL=editor.bundle.map.js