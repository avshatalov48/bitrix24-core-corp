{"version":3,"file":"call-assessment.bundle.js","sources":["../src/components/navigation/breadcrumbs.js","../src/components/navigation/button.js","../src/components/navigation/navigation.js","../src/components/common/text-editor-wrapper-component.js","../src/components/page/base-page.js","../src/validator/prompt-length.js","../src/components/page/about-page.js","../src/components/enum/client-type.js","../src/components/page/client-page.js","../src/components/page/settings-page.js","../src/components/call-assessment.js","../src/call-assessment.js"],"sourcesContent":["import { Loc } from 'main.core';\n\nexport const BreadcrumbsEvents = {\n\titemClick: 'crm:copilot:call-assessment:breadcrumb-item-click',\n};\n\nexport const Breadcrumbs = {\n\tprops: {\n\t\tactiveTabId: {\n\t\t\ttype: String,\n\t\t},\n\t},\n\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\ttabs: this.getTabsData(),\n\t\t};\n\t},\n\n\tmethods: {\n\t\titemTitleClassList(id: string, isSoon: boolean): string[]\n\t\t{\n\t\t\treturn [\n\t\t\t\t'crm-copilot__call-assessment_breadcrumbs-item-title',\n\t\t\t\t{ '--active': id === this.activeTabId },\n\t\t\t\t{ '--soon': isSoon },\n\t\t\t];\n\t\t},\n\t\tgetTab(id: string): Object {\n\t\t\treturn this.getTabsData().find((tab) => tab.id === id);\n\t\t},\n\t\tgetTabsData(): Object[]\n\t\t{\n\t\t\treturn [\n\t\t\t\t{\n\t\t\t\t\tid: 'about',\n\t\t\t\t\ttitle: Loc.getMessage('CRM_COPILOT_CALL_ASSESSMENT_PAGE_ABOUT'),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: 'client',\n\t\t\t\t\ttitle: Loc.getMessage('CRM_COPILOT_CALL_ASSESSMENT_PAGE_CLIENT'),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: 'settings',\n\t\t\t\t\ttitle: Loc.getMessage('CRM_COPILOT_CALL_ASSESSMENT_PAGE_SETTINGS'),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: 'control',\n\t\t\t\t\ttitle: Loc.getMessage('CRM_COPILOT_CALL_ASSESSMENT_PAGE_CONTROL'),\n\t\t\t\t\tsoon: true,\n\t\t\t\t},\n\t\t\t\t// {\n\t\t\t\t// \tid: 'encouragement',\n\t\t\t\t// \ttitle: Loc.getMessage('CRM_COPILOT_CALL_ASSESSMENT_PAGE_ENCOURAGEMENT'),\n\t\t\t\t// },\n\t\t\t];\n\t\t},\n\t\temitClickEvent(itemId: string): void\n\t\t{\n\t\t\tconst tab = this.getTab(itemId);\n\n\t\t\tif (!tab.soon)\n\t\t\t{\n\t\t\t\tthis.$Bitrix.eventEmitter.emit(BreadcrumbsEvents.itemClick, { itemId });\n\t\t\t}\n\t\t},\n\t},\n\n\tcomputed: {\n\t\tsoonTitle(): string\n\t\t{\n\t\t\treturn Loc.getMessage('CRM_COPILOT_CALL_ASSESSMENT_BREADCRUMBS_SOON');\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div class=\"crm-copilot__call-assessment_breadcrumbs-wrapper\">\n\t\t\t<div\n\t\t\t\tv-for=\"(tab, index) in tabs\"\n\t\t\t\t@click=\"emitClickEvent(tab.id)\"\n\t\t\t\tclass=\"crm-copilot__call-assessment_breadcrumbs-item\"\n\t\t\t>\n\t\t\t\t<span v-if=\"tab.soon\" class=\"crm-copilot__call-assessment_breadcrumbs-soon\">\n\t\t\t\t\t{{ soonTitle }}\n\t\t\t\t</span>\n\t\t\t\t<span :class=\"itemTitleClassList(tab.id, tab.soon)\">\n\t\t\t\t\t{{ tab.title }}\n\t\t\t\t</span>\n\t\t\t\t<span \n\t\t\t\t\tv-if=\"index+1 < tabs.length\"\n\t\t\t\t\tclass=\"crm-copilot__call-assessment_breadcrumbs-divider\"\n\t\t\t\t></span>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Loc } from 'main.core';\nimport { Button as UiButton, ButtonState } from 'ui.buttons';\n\nexport const ButtonEvents = {\n\tclick: 'crm:copilot:call-assessment:navigation-button-click',\n};\n\nexport const Button = {\n\tprops: {\n\t\tid: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tisEnabled: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true,\n\t\t},\n\t},\n\n\tmounted()\n\t{\n\t\tthis.initButton();\n\t},\n\n\twatch: {\n\t\tisEnabled(value: boolean): void\n\t\t{\n\t\t\tthis.button.setState(value ? ButtonState.ACTIVE : ButtonState.DISABLED);\n\t\t},\n\t},\n\n\tmethods: {\n\t\tinitButton(): void\n\t\t{\n\t\t\tthis.button = new UiButton({\n\t\t\t\ttext: Loc.getMessage(`CRM_COPILOT_CALL_ASSESSMENT_NAVIGATION_BUTTON_${this.id.toUpperCase()}`),\n\t\t\t\tcolor: this.buttonColor,\n\t\t\t\tround: true,\n\t\t\t\tsize: BX.UI.Button.Size.LARGE,\n\t\t\t\tonclick: () => {\n\t\t\t\t\tthis.emitClickEvent();\n\t\t\t\t},\n\t\t\t});\n\n\t\t\tif (this.isEnabled !== true)\n\t\t\t{\n\t\t\t\tthis.button.setState(ButtonState.DISABLED);\n\t\t\t}\n\n\t\t\tthis.button.setDataSet({\n\t\t\t\tid: `crm-copilot-call-assessment-buttons-${this.id.toLowerCase()}`,\n\t\t\t});\n\n\t\t\tif (this.$refs.button)\n\t\t\t{\n\t\t\t\tthis.button.renderTo(this.$refs.button);\n\t\t\t}\n\t\t},\n\t\temitClickEvent(): void\n\t\t{\n\t\t\tif (this.isEnabled)\n\t\t\t{\n\t\t\t\tthis.$Bitrix.eventEmitter.emit(ButtonEvents.click, { id: this.id });\n\t\t\t}\n\t\t},\n\t},\n\n\tcomputed: {\n\t\tbuttonColor(): string\n\t\t{\n\t\t\tif (this.id === 'continue' || this.id === 'submit' || this.id === 'close')\n\t\t\t{\n\t\t\t\treturn UiButton.Color.SUCCESS;\n\t\t\t}\n\n\t\t\tif (this.id === 'update')\n\t\t\t{\n\t\t\t\treturn UiButton.Color.LIGHT_BORDER;\n\t\t\t}\n\n\t\t\treturn UiButton.Color.LIGHT;\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div ref=\"button\" class=\"crm-copilot-call-assessment-button\"></div>\n\t`,\n};\n","import { Loc } from 'main.core';\n\nimport 'ui.icon-set.main';\nimport { Button } from './button';\n\nconst ARTICLE_CODE = '23240682'\n\nexport const Navigation = {\n\tcomponents: {\n\t\tButton,\n\t},\n\n\tprops: {\n\t\tactiveTabId: {\n\t\t\ttype: String,\n\t\t},\n\t\tisEnabled: {\n\t\t\ttype: Boolean,\n\t\t},\n\t\treadOnly: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\tshowSaveButton: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\n\tcomputed: {\n\t\thelp(): string\n\t\t{\n\t\t\treturn Loc.getMessage('CRM_COPILOT_CALL_ASSESSMENT_NAVIGATION_HELP');\n\t\t},\n\t\tbuttons(): string[]\n\t\t{\n\t\t\treturn [\n\t\t\t\t'cancel',\n\t\t\t\t'back',\n\t\t\t\t'continue',\n\t\t\t\t'submit',\n\t\t\t\t'close',\n\t\t\t\t'update',\n\t\t\t];\n\t\t},\n\t},\n\n\tmethods: {\n\t\tshowArticle(): void\n\t\t{\n\t\t\twindow.top.BX?.Helper?.show(`redirect=detail&code=${ARTICLE_CODE}`);\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div class=\"crm-copilot__call-assessment_navigation-container\">\n\t\t\t<div class=\"crm-copilot__call-assessment_navigation-buttons-wrapper\">\n\t\t\t\t<Button v-if=\"activeTabId !== 'settings'\" id=\"continue\" :is-enabled=\"isEnabled\" />\n\t\t\t\t<Button v-if=\"activeTabId === 'settings' && !readOnly\" id=\"submit\" />\n\t\t\t\t<Button v-if=\"activeTabId === 'settings' && readOnly\" id=\"close\" />\n\t\t\t\t<Button v-if=\"activeTabId === 'about'\" id=\"cancel\" />\n\t\t\t\t<Button v-if=\"activeTabId !== 'about'\" id=\"back\" />\n\t\t\t</div>\n\t\t\t<div v-if=\"showSaveButton && activeTabId !== 'settings'\">\n\t\t\t\t<Button id=\"update\" :is-enabled=\"isEnabled\" />\n\t\t\t</div>\n\t\t\t<div v-else class=\"crm-copilot__call-assessment_article\" @click=\"showArticle\">\n\t\t\t\t<span class=\"ui-icon-set --help\"></span>\n\t\t\t\t{{ help }}\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Runtime, Type } from 'main.core';\nimport { TextEditor, TextEditorComponent } from 'ui.text-editor';\n\nexport const TextEditorWrapperComponent = {\n\tcomponents: {\n\t\tTextEditorComponent,\n\t},\n\n\temits: [\n\t\t'change',\n\t],\n\n\tprops: {\n\t\ttextEditor: TextEditor,\n\t},\n\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\ttextEditorEvents: {\n\t\t\t\tonChange: this.emitChangeData,\n\t\t\t},\n\t\t};\n\t},\n\n\tmounted(): void\n\t{\n\t\tconst editorOffsetTop = this.$el.parentNode.offsetTop;\n\n\t\tconst navigationClassName = '.crm-copilot__call-assessment_navigation-container';\n\t\tconst navigationOffsetTop = document.querySelector(navigationClassName)?.offsetTop ?? 0;\n\n\t\tconst textEditorContainerBottomPadding = 20;\n\t\tconst availableHeight = navigationOffsetTop - editorOffsetTop - textEditorContainerBottomPadding;\n\t\tconst minHeight = Math.round(availableHeight * 0.5);\n\t\tconst maxHeight = Math.round(availableHeight * 0.8);\n\n\t\tif (minHeight < 200)\n\t\t{\n\t\t\tthis.textEditor?.setMinHeight(maxHeight);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.textEditor?.setMinHeight(minHeight);\n\t\t}\n\n\t\tthis.textEditor?.setMaxHeight(maxHeight);\n\t},\n\n\tmethods: {\n\t\temitChangeData(): void\n\t\t{\n\t\t\tif (!Type.isFunction(this.onChangeDebounce))\n\t\t\t{\n\t\t\t\tthis.onChangeDebounce = Runtime.debounce(this.onChange, 100, this);\n\t\t\t}\n\n\t\t\tthis.onChangeDebounce();\n\t\t},\n\t\tonChange(): void\n\t\t{\n\t\t\tthis.$emit('change', {\n\t\t\t\tprompt: this.textEditor.getText(),\n\t\t\t});\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<TextEditorComponent \n\t\t\t:events=\"textEditorEvents\"\n\t\t\t:editor-instance=\"textEditor\"\n\t\t/>\n\t`,\n};\n","import { Loc, Runtime, Type } from 'main.core';\nimport { Breadcrumbs } from '../navigation/breadcrumbs';\nimport { UI } from 'ui.notification';\n\nexport const BasePage = {\n\tcomponents: {\n\t\tBreadcrumbs,\n\t},\n\n\tprops: {\n\t\treadOnly: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\tisActive: {\n\t\t\ttype: Boolean,\n\t\t},\n\t\tdata: {\n\t\t\ttype: Object,\n\t\t\tdefault: {},\n\t\t},\n\t\tsettings: {\n\t\t\ttype: Object,\n\t\t\tdefault: {},\n\t\t},\n\t},\n\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tid: null, // must be defined in child class\n\t\t};\n\t},\n\n\tmethods: {\n\t\tgetId(): string\n\t\t{\n\t\t\treturn this.id;\n\t\t},\n\t\tgetData(): Object\n\t\t{\n\t\t\t// must be implement in child class\n\n\t\t\treturn {};\n\t\t},\n\t\tisReadyToMoveOn(): boolean\n\t\t{\n\t\t\treturn this.validate();\n\t\t},\n\t\tvalidate(): boolean\n\t\t{\n\t\t\t// must be implement in child class\n\n\t\t\treturn true;\n\t\t},\n\t\tonValidationFailed(): void\n\t\t{\n\t\t\tUI.Notification.Center.notify({\n\t\t\t\tcontent: Loc.getMessage('CRM_COPILOT_CALL_ASSESSMENT_PAGE_VALIDATION_ERROR'),\n\t\t\t\tautoHideDelay: 3000,\n\t\t\t});\n\t\t},\n\t\temitChangeData(): void\n\t\t{\n\t\t\tif (!Type.isFunction(this.onChangeDebounce))\n\t\t\t{\n\t\t\t\tthis.onChangeDebounce = Runtime.debounce(this.onChange, 100, this);\n\t\t\t}\n\n\t\t\tthis.onChangeDebounce();\n\t\t},\n\t\tonChange(): void\n\t\t{\n\t\t\tthis.$emit('onChange', {\n\t\t\t\tid: this.id,\n\t\t\t\tdata: this.getData(),\n\t\t\t});\n\t\t},\n\t},\n};\n","import { Loc } from 'main.core';\n\nconst LENGTH_RANGE = {\n\tMIN: 100,\n\tMAX: 5000,\n};\n\nexport class PromptLength\n{\n\t#errorMessage: ?string = null;\n\n\tvalidate(prompt: string): boolean\n\t{\n\t\tif (prompt.length < LENGTH_RANGE.MIN)\n\t\t{\n\t\t\tthis.#errorMessage = Loc.getMessage('CRM_COPILOT_CALL_ASSESSMENT_PAGE_ABOUT_PROMPT_LENGTH_MIN_ERROR', {\n\t\t\t\t'#MIN_VALUE#': LENGTH_RANGE.MIN,\n\t\t\t});\n\n\t\t\treturn false;\n\t\t}\n\n\t\tif (prompt.length > LENGTH_RANGE.MAX)\n\t\t{\n\t\t\tthis.#errorMessage = Loc.getMessage('CRM_COPILOT_CALL_ASSESSMENT_PAGE_ABOUT_PROMPT_LENGTH_MAX_ERROR', {\n\t\t\t\t'#MAX_VALUE#': LENGTH_RANGE.MAX,\n\t\t\t});\n\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.#errorMessage = null;\n\n\t\treturn true;\n\t}\n\n\tgetError(): ?string\n\t{\n\t\treturn this.#errorMessage;\n\t}\n}\n","import { Loc, Type } from 'main.core';\nimport { TextEditor, TextEditorComponent } from 'ui.text-editor';\nimport { TextEditorWrapperComponent } from '../common/text-editor-wrapper-component';\nimport { BasePage } from './base-page';\nimport { PromptLength as PromptLengthValidator } from './../../validator/prompt-length';\nimport { BBCodeParser } from 'ui.bbcode.parser';\n\nexport const AboutPage = {\n\textends: BasePage,\n\n\tcomponents: {\n\t\tTextEditorComponent,\n\t\tTextEditorWrapperComponent,\n\t},\n\n\tprops: {\n\t\ttextEditor: TextEditor,\n\t},\n\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tid: 'about',\n\t\t\tparser: new BBCodeParser(),\n\t\t\tpromptLengthValidator: new PromptLengthValidator(),\n\t\t\tpromptLengthError: null,\n\t\t};\n\t},\n\n\tmethods: {\n\t\tgetData(): Object\n\t\t{\n\t\t\treturn {\n\t\t\t\tprompt: this.textEditor.getText(),\n\t\t\t};\n\t\t},\n\t\tisReadyToMoveOn(): boolean\n\t\t{\n\t\t\treturn Type.isStringFilled(this.textEditor.getText());\n\t\t},\n\t\tvalidate(): boolean\n\t\t{\n\t\t\treturn this.promptLengthValidator.validate(this.getPlainPromptText());\n\t\t},\n\t\tonValidationFailed(): void\n\t\t{\n\t\t\tthis.promptLengthError = this.promptLengthValidator.getError();\n\t\t},\n\t\tonChange(): void\n\t\t{\n\t\t\tthis.promptLengthError = null;\n\t\t\tBasePage.methods.onChange.call(this);\n\t\t},\n\t\tgetPlainPromptText(): number\n\t\t{\n\t\t\treturn this.parser.parse(this.textEditor.getText()).toPlainText().trim();\n\t\t},\n\t},\n\n\tcomputed: {\n\t\tpageTitle(): string\n\t\t{\n\t\t\treturn Loc.getMessage('CRM_COPILOT_CALL_ASSESSMENT_PAGE_ABOUT_TITLE');\n\t\t},\n\t\tpageDescription(): string\n\t\t{\n\t\t\treturn Loc.getMessage('CRM_COPILOT_CALL_ASSESSMENT_PAGE_ABOUT_DESCRIPTION');\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div v-if=\"isActive\">\n\t\t\t<div class=\"crm-copilot__call-assessment_page-section\">\n\t\t\t\t<Breadcrumbs :active-tab-id=\"id\" />\n\t\t\t\t<header class=\"crm-copilot__call-assessment_page-section-header\">\n\t\t\t\t\t<div class=\"crm-copilot__call-assessment_page-section-header-title\">\n\t\t\t\t\t\t{{ pageTitle }}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"crm-copilot__call-assessment_page-section-header-description\">\n\t\t\t\t\t\t{{ pageDescription }}\n\t\t\t\t\t</div>\n\t\t\t\t</header>\n\t\t\t\t<div class=\"crm-copilot__call-assessment_page-section-body\">\n\t\t\t\t\t<div class=\"crm-copilot__call-assessment_page-section-body-field\">\n\t\t\t\t\t\t<TextEditorWrapperComponent\n\t\t\t\t\t\t\t:textEditor=\"textEditor\"\n\t\t\t\t\t\t\t@change=\"onChange\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<div v-if=\"promptLengthError\" class=\"crm-copilot__call-assessment_page-section-body-field-error\">\n\t\t\t\t\t\t\t{{ promptLengthError }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","export const clientType = Object.freeze({\n\tnew: 1,\n\tinWork: 2,\n\treturn: 3,\n\trepeated: 4,\n});\n","import { Loc, Type } from 'main.core';\nimport { clientType as clientTypeEnum } from '../enum/client-type';\nimport { BasePage } from './base-page';\n\nexport const ClientPage = {\n\textends: BasePage,\n\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tid: 'client',\n\t\t\tactiveClientTypeIds: this.data.activeClientTypeIds ?? [],\n\t\t};\n\t},\n\n\tmethods: {\n\t\tgetData(): Object\n\t\t{\n\t\t\treturn {\n\t\t\t\tclientTypeIds: [...this.activeClientTypeIds],\n\t\t\t};\n\t\t},\n\t\tgetClientTypeClassList(clientTypeId: string): string[]\n\t\t{\n\t\t\tconst clientType = this.clientTypes.find((client) => client.id === clientTypeId);\n\n\t\t\treturn [\n\t\t\t\t'crm-copilot__call-assessment_page-section-body-field-client-type',\n\t\t\t\t`--client-${clientType.id}`,\n\t\t\t\t{ '--active': this.activeClientTypeIds.includes(clientTypeId) },\n\t\t\t\t{ '--readonly': this.readOnly },\n\t\t\t];\n\t\t},\n\t\tonClientTypeSelect(clientTypeId: string): void\n\t\t{\n\t\t\tif (this.readOnly)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.activeClientTypeIds.includes(clientTypeId))\n\t\t\t{\n\t\t\t\tconst index = this.activeClientTypeIds.indexOf(clientTypeId);\n\t\t\t\tthis.activeClientTypeIds.splice(index, 1);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.activeClientTypeIds.push(clientTypeId);\n\t\t\t}\n\n\t\t\tthis.emitChangeData();\n\t\t},\n\t\tonCheckboxClick(): boolean\n\t\t{\n\t\t\treturn !this.readOnly;\n\t\t},\n\t\tvalidate(): boolean\n\t\t{\n\t\t\treturn Type.isArrayFilled(this.activeClientTypeIds);\n\t\t},\n\t},\n\n\tcomputed: {\n\t\tpageTitle(): string\n\t\t{\n\t\t\treturn Loc.getMessage('CRM_COPILOT_CALL_ASSESSMENT_PAGE_CLIENT_TITLE');\n\t\t},\n\t\tpageDescription(): string\n\t\t{\n\t\t\treturn Loc.getMessage('CRM_COPILOT_CALL_ASSESSMENT_PAGE_CLIENT_DESCRIPTION');\n\t\t},\n\t\tclientTypes(): Array<Object>\n\t\t{\n\t\t\treturn [\n\t\t\t\t{\n\t\t\t\t\tid: clientTypeEnum.new,\n\t\t\t\t\ttitle: Loc.getMessage('CRM_COPILOT_CALL_ASSESSMENT_PAGE_CLIENT_TYPE_NEW_TITLE'),\n\t\t\t\t\tdescription: Loc.getMessage('CRM_COPILOT_CALL_ASSESSMENT_PAGE_CLIENT_TYPE_NEW_DESCRIPTION'),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: clientTypeEnum.inWork,\n\t\t\t\t\ttitle: Loc.getMessage('CRM_COPILOT_CALL_ASSESSMENT_PAGE_CLIENT_TYPE_IN_WORK_TITLE'),\n\t\t\t\t\tdescription: Loc.getMessage('CRM_COPILOT_CALL_ASSESSMENT_PAGE_CLIENT_TYPE_IN_WORK_DESCRIPTION'),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: clientTypeEnum.return,\n\t\t\t\t\ttitle: Loc.getMessage('CRM_COPILOT_CALL_ASSESSMENT_PAGE_CLIENT_TYPE_RETURN_CUSTOMER_TITLE'),\n\t\t\t\t\tdescription: Loc.getMessage('CRM_COPILOT_CALL_ASSESSMENT_PAGE_CLIENT_TYPE_RETURN_CUSTOMER_DESCRIPTION'),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: clientTypeEnum.repeated,\n\t\t\t\t\ttitle: Loc.getMessage('CRM_COPILOT_CALL_ASSESSMENT_PAGE_CLIENT_TYPE_REPEATED_APPROACH_TITLE'),\n\t\t\t\t\tdescription: Loc.getMessage('CRM_COPILOT_CALL_ASSESSMENT_PAGE_CLIENT_TYPE_REPEATED_APPROACH_DESCRIPTION'),\n\t\t\t\t},\n\t\t\t];\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div v-if=\"isActive\">\n\t\t\t<div class=\"crm-copilot__call-assessment_page-section\">\n\t\t\t\t<Breadcrumbs :active-tab-id=\"id\" />\n\t\t\t\t<header class=\"crm-copilot__call-assessment_page-section-header\">\n\t\t\t\t\t<div class=\"crm-copilot__call-assessment_page-section-header-title\">\n\t\t\t\t\t\t{{ pageTitle }}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"crm-copilot__call-assessment_page-section-header-description\">\n\t\t\t\t\t\t{{ pageDescription }}\n\t\t\t\t\t</div>\n\t\t\t\t</header>\n\t\t\t\t<div class=\"crm-copilot__call-assessment_page-section-body\">\n\t\t\t\t\t<div class=\"crm-copilot__call-assessment_page-section-body-field\">\n\t\t\t\t\t\t<div v-for=\"(clientType, index) in clientTypes\">\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t:class=getClientTypeClassList(clientType.id)\n\t\t\t\t\t\t\t\t@click=\"onClientTypeSelect(clientType.id)\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<div class=\"crm-copilot__call-assessment_page-section-body-field-client-type-avatar\">\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class=\"crm-copilot__call-assessment_page-section-body-field-client-type-info\">\n\t\t\t\t\t\t\t\t\t<div class=\"crm-copilot__call-assessment_page-section-body-field-client-type-title\">\n\t\t\t\t\t\t\t\t\t\t{{ clientType.title }}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div class=\"crm-copilot__call-assessment_page-section-body-field-client-type-description\">\n\t\t\t\t\t\t\t\t\t\t{{ clientType.description }}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\t:class=\"(readOnly ? 'readonly' : '')\"\n\t\t\t\t\t\t\t\t\t:onclick=\"onCheckboxClick\"\n\t\t\t\t\t\t\t\t\ttype=\"checkbox\"\n\t\t\t\t\t\t\t\t\tv-model=\"activeClientTypeIds\"\n\t\t\t\t\t\t\t\t\t:value=\"clientType.id\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<hr\n\t\t\t\t\t\t\t\tv-if=\"index + 1 < clientTypes.length\"\n\t\t\t\t\t\t\t\tclass=\"crm-copilot__call-assessment_page-section-body-field-client-type-divider\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Loc } from 'main.core';\nimport { InfoHelper } from 'ui.info-helper';\nimport { BasePage } from './base-page';\nimport 'ui.forms';\n\nexport const SettingsPage = {\n\textends: BasePage,\n\n\tdata(): Object\n\t{\n\t\tlet autoCheckTypeId = 0;\n\t\tif (this.settings.baas?.hasPackage)\n\t\t{\n\t\t\tautoCheckTypeId = this.data.autoCheckTypeId ?? 1;\n\t\t}\n\n\t\treturn {\n\t\t\tid: 'settings',\n\t\t\tcallTypeId: this.data.callTypeId ?? 1,\n\t\t\tautoCheckTypeId,\n\t\t};\n\t},\n\n\tmethods: {\n\t\tgetData(): Object\n\t\t{\n\t\t\treturn {\n\t\t\t\tcallTypeId: this.callTypeId,\n\t\t\t\tautoCheckTypeId: this.autoCheckTypeId,\n\t\t\t};\n\t\t},\n\t\tonAutoCheckTypeIdChange(event): void\n\t\t{\n\t\t\tif (this.isBaasHasPackage)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst { value } = event.target;\n\t\t\tif (value !== 0)\n\t\t\t{\n\t\t\t\tif (this.packageEmptySliderCode)\n\t\t\t\t{\n\t\t\t\t\tInfoHelper.show(this.packageEmptySliderCode);\n\t\t\t\t}\n\n\t\t\t\tvoid this.$nextTick(() => {\n\t\t\t\t\tthis.autoCheckTypeId = 0;\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t},\n\n\tcomputed: {\n\t\tpageTitle(): string\n\t\t{\n\t\t\treturn Loc.getMessage('CRM_COPILOT_CALL_ASSESSMENT_PAGE_SETTINGS_TITLE');\n\t\t},\n\t\tpageDescription(): string\n\t\t{\n\t\t\treturn Loc.getMessage('CRM_COPILOT_CALL_ASSESSMENT_PAGE_SETTINGS_DESCRIPTION');\n\t\t},\n\t\tpageSectionSettingsCallType(): string\n\t\t{\n\t\t\treturn Loc.getMessage('CRM_COPILOT_CALL_ASSESSMENT_PAGE_SETTINGS_CALL_TYPE');\n\t\t},\n\t\tpageSectionSettingsCallTypeDescription(): string\n\t\t{\n\t\t\treturn Loc.getMessage('CRM_COPILOT_CALL_ASSESSMENT_PAGE_SETTINGS_CALL_TYPE_DESCRIPTION');\n\t\t},\n\t\tcallTypes(): Array<Object>\n\t\t{\n\t\t\treturn [\n\t\t\t\t{\n\t\t\t\t\tid: 1,\n\t\t\t\t\ttitle: Loc.getMessage('CRM_COPILOT_CALL_ASSESSMENT_PAGE_SETTINGS_CALL_TYPE_ALL'),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: 2,\n\t\t\t\t\ttitle: Loc.getMessage('CRM_COPILOT_CALL_ASSESSMENT_PAGE_SETTINGS_CALL_TYPE_INCOMING'),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: 3,\n\t\t\t\t\ttitle: Loc.getMessage('CRM_COPILOT_CALL_ASSESSMENT_PAGE_SETTINGS_CALL_TYPE_OUTGOING'),\n\t\t\t\t},\n\t\t\t];\n\t\t},\n\t\tpageSectionSettingsCheck(): string\n\t\t{\n\t\t\treturn Loc.getMessage('CRM_COPILOT_CALL_ASSESSMENT_PAGE_SETTINGS_CHECK');\n\t\t},\n\t\tpageSectionSettingsCheckDescription(): string\n\t\t{\n\t\t\treturn Loc.getMessage('CRM_COPILOT_CALL_ASSESSMENT_PAGE_SETTINGS_CHECK_DESCRIPTION');\n\t\t},\n\t\tcheckTypes(): Array<Object>\n\t\t{\n\t\t\treturn [\n\t\t\t\t{\n\t\t\t\t\tvalue: 1,\n\t\t\t\t\ttitle: Loc.getMessage('CRM_COPILOT_CALL_ASSESSMENT_PAGE_SETTINGS_CHECK_FIRST_INCOMING'),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tvalue: 2,\n\t\t\t\t\ttitle: Loc.getMessage('CRM_COPILOT_CALL_ASSESSMENT_PAGE_SETTINGS_CHECK_ALL_INCOMING'),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tvalue: 3,\n\t\t\t\t\ttitle: Loc.getMessage('CRM_COPILOT_CALL_ASSESSMENT_PAGE_SETTINGS_CHECK_ALL_OUTGOING'),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tvalue: 4,\n\t\t\t\t\ttitle: Loc.getMessage('CRM_COPILOT_CALL_ASSESSMENT_PAGE_SETTINGS_CHECK_ALL'),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tvalue: 0,\n\t\t\t\t\ttitle: Loc.getMessage('CRM_COPILOT_CALL_ASSESSMENT_PAGE_SETTINGS_CHECK_DISABLED'),\n\t\t\t\t},\n\t\t\t];\n\t\t},\n\t\tisBaasAvailable(): boolean\n\t\t{\n\t\t\treturn this.settings.baas?.isAvailable ?? false;\n\t\t},\n\t\tisBaasHasPackage(): boolean\n\t\t{\n\t\t\treturn this.settings.baas?.hasPackage ?? false;\n\t\t},\n\t\tpackageEmptySliderCode(): ?string\n\t\t{\n\t\t\treturn this.settings.baas?.aiPackagesEmptySliderCode ?? null;\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div v-if=\"isActive\">\n\t\t\t<div class=\"crm-copilot__call-assessment_page-section\">\n\t\t\t\t<Breadcrumbs :active-tab-id=\"id\" />\n\t\t\t\t<header class=\"crm-copilot__call-assessment_page-section-header\">\n\t\t\t\t\t<div class=\"crm-copilot__call-assessment_page-section-header-title\">\n\t\t\t\t\t\t{{ pageTitle }}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"crm-copilot__call-assessment_page-section-header-description\">\n\t\t\t\t\t\t{{ pageDescription }}\n\t\t\t\t\t</div>\n\t\t\t\t</header>\n\t\t\t\t\n\t\t\t\t<div class=\"crm-copilot__call-assessment_page-section-body\">\n\t\t\t\t\t<div class=\"crm-copilot__call-assessment_page-section-body-field ui-ctl ui-ctl-after-icon ui-ctl-dropdown ui-ctl-w100\">\n\t\t\t\t\t\t<label>{{ pageSectionSettingsCallType }}</label>\n\t\t\t\t\t\t<div class=\"ui-ctl ui-ctl-w100 ui-ctl-after-icon ui-ctl-dropdown\">\n\t\t\t\t\t\t\t<div class=\"ui-ctl-after ui-ctl-icon-angle\"></div>\n\t\t\t\t\t\t\t<select class=\"ui-ctl-element\" v-model=\"callTypeId\">\n\t\t\t\t\t\t\t\t<option \n\t\t\t\t\t\t\t\t\tv-for=\"callType in callTypes\"\n\t\t\t\t\t\t\t\t\t:value=\"callType.id\"\n\t\t\t\t\t\t\t\t\t:disabled=\"readOnly && callTypeId !== callType.id\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{{callType.title}}\n\t\t\t\t\t\t\t\t</option>\n\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"crm-copilot__call-assessment_page-section-body-field-description\">\n\t\t\t\t\t\t\t{{ pageSectionSettingsCallTypeDescription }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t\n\t\t\t\t<div v-if=\"isBaasAvailable\" class=\"crm-copilot__call-assessment_page-section-body\">\n\t\t\t\t\t<div class=\"crm-copilot__call-assessment_page-section-body-field ui-ctl ui-ctl-after-icon ui-ctl-dropdown ui-ctl-w100\">\n\t\t\t\t\t\t<label>{{ pageSectionSettingsCheck }}</label>\n\t\t\t\t\t\t<div class=\"ui-ctl ui-ctl-w100 ui-ctl-after-icon ui-ctl-dropdown\">\n\t\t\t\t\t\t\t<div class=\"ui-ctl-after ui-ctl-icon-angle\"></div>\n\t\t\t\t\t\t\t<select \n\t\t\t\t\t\t\t\tclass=\"ui-ctl-element\"\n\t\t\t\t\t\t\t\tv-model=\"autoCheckTypeId\"\n\t\t\t\t\t\t\t\t@change=\"onAutoCheckTypeIdChange\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<option \n\t\t\t\t\t\t\t\t\tv-for=\"checkType in checkTypes\"\n\t\t\t\t\t\t\t\t\t:value=\"checkType.value\"\n\t\t\t\t\t\t\t\t\t:disabled=\"readOnly && autoCheckTypeId !== checkType.value\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{{checkType.title}}\n\t\t\t\t\t\t\t\t</option>\n\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"crm-copilot__call-assessment_page-section-body-field-description\">\n\t\t\t\t\t\t\t{{ pageSectionSettingsCheckDescription }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { ajax as Ajax, Loc, Text, Type } from 'main.core';\nimport { UI } from 'ui.notification';\nimport { TextEditor } from 'ui.text-editor';\nimport { BreadcrumbsEvents } from './navigation/breadcrumbs';\nimport { ButtonEvents } from './navigation/button';\nimport { Navigation } from './navigation/navigation';\nimport type { BasePage } from './page/base-page';\nimport { AboutPage } from './page/about-page';\nimport { ClientPage } from './page/client-page';\n// import { ControlPage } from './page/control-page';\n// import { EncouragementPage } from './page/encouragement-page';\nimport { SettingsPage } from './page/settings-page';\n\n/**\n * @see BasePage\n */\ninterface Page extends BasePage\n{\n\tgetId(): string,\n\tgetData(): Object,\n\tvalidate(): boolean,\n\tonValidationFailed(): void,\n\tisReadyToMoveOn(): boolean,\n}\n\nexport const CallAssessment = {\n\tcomponents: {\n\t\tAboutPage,\n\t\tClientPage,\n\t\tSettingsPage,\n\t\t// ControlPage,\n\t\t// EncouragementPage,\n\t\tNavigation,\n\t},\n\n\tprops: {\n\t\tsettings: {\n\t\t\ttype: Object,\n\t\t\tdefault: {},\n\t\t},\n\t\tparams: {\n\t\t\ttype: Object,\n\t\t\tdefault: {},\n\t\t},\n\t\ttextEditor: TextEditor,\n\t},\n\n\tdata(): Object\n\t{\n\t\tconst { data } = this.params;\n\n\t\tlet id = null;\n\t\tif (this.settings.isCopy)\n\t\t{\n\t\t\tid = null;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tid = data?.id ?? null;\n\t\t}\n\n\t\treturn {\n\t\t\tid,\n\t\t\tpagesData: this.initPagesData(data),\n\t\t\tactivePageId: 'about',\n\t\t\ttitle: data.title ?? null,\n\t\t\tcanShowNextPage: false,\n\t\t};\n\t},\n\n\twatch: {\n\t\tactivePageId(pageId: string): void\n\t\t{\n\t\t\tthis.onPageDataChange({\n\t\t\t\tid: pageId,\n\t\t\t\tdata: this.getPageData(pageId),\n\t\t\t});\n\t\t},\n\t},\n\n\tmethods: {\n\t\tinitPagesData(data: Object): Object\n\t\t{\n\t\t\treturn {\n\t\t\t\tclient: {\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tactiveClientTypeIds: data?.clientTypeIds,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tsettings: {\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tcallTypeId: data?.callTypeId,\n\t\t\t\t\t\tautoCheckTypeId: data?.autoCheckTypeId,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t// temporary disabled\n\t\t\t\t/* control: {\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tisStrictControl: data?.controlData?.isStrictControl ?? false,\n\t\t\t\t\t\tfluidCallCount: data?.controlData?.fluidCallCount,\n\t\t\t\t\t\titems: [],\n\t\t\t\t\t\theadItems: data?.controlData?.headItems ?? null,\n\t\t\t\t\t\tuseSummary: data?.useSummary ?? false,\n\t\t\t\t\t\tusers: data?.users ?? {},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tencouragement: {\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tisAutoEncourage: data?.encouragementData?.isAutoEncourage ?? false,\n\t\t\t\t\t\tencourageCallCount: data?.encouragementData?.encourageCallCount,\n\n\t\t\t\t\t\tusers: data?.users ?? {},\n\t\t\t\t\t\theadItems: data?.controlData?.headItems ?? null, // for readonly head selector in page\n\t\t\t\t\t},\n\t\t\t\t}, */\n\t\t\t};\n\t\t},\n\t\tonNavigationButtonClick({ data }): void\n\t\t{\n\t\t\tconst { id } = data;\n\t\t\tif (id === 'cancel' || id === 'close')\n\t\t\t{\n\t\t\t\tthis.closeSlider();\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (id === 'back')\n\t\t\t{\n\t\t\t\tconst currentIndex = this.pagesList.indexOf(this.activePageId);\n\n\t\t\t\tif (currentIndex > 0)\n\t\t\t\t{\n\t\t\t\t\tthis.activePageId = this.pagesList[currentIndex - 1];\n\t\t\t\t}\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!this.isActivePageValid())\n\t\t\t{\n\t\t\t\tthis.onActivePageValidationFailed();\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (id === 'continue')\n\t\t\t{\n\t\t\t\tconst currentIndex = this.pagesList.indexOf(this.activePageId);\n\n\t\t\t\tif (currentIndex < this.pagesList.length - 1)\n\t\t\t\t{\n\t\t\t\t\tthis.activePageId = this.pagesList[currentIndex + 1];\n\t\t\t\t}\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (id === 'submit' || id === 'update')\n\t\t\t{\n\t\t\t\tthis.sendData();\n\t\t\t}\n\t\t},\n\t\tsendData(): void\n\t\t{\n\t\t\tlet data = {\n\t\t\t\ttitle: this.title,\n\t\t\t};\n\n\t\t\tthis.pagesList.forEach((pageId: string) => {\n\t\t\t\tdata = {\n\t\t\t\t\t...data,\n\t\t\t\t\t...this.$refs[pageId]?.getData(),\n\t\t\t\t};\n\t\t\t});\n\n\t\t\tAjax\n\t\t\t\t.runAction('crm.copilot.callassessment.save', {\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tid: this.id,\n\t\t\t\t\t\tdata,\n\t\t\t\t\t},\n\t\t\t\t}).then(\n\t\t\t\t\t(response) => {\n\t\t\t\t\t\tif (response?.status !== 'success')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tUI.Notification.Center.notify({\n\t\t\t\t\t\t\t\tcontent: Text.encode(response.errors[0].message),\n\t\t\t\t\t\t\t\tautoHideDelay: 6000,\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis.onSaveCallback();\n\t\t\t\t\t\tthis.closeSlider();\n\t\t\t\t\t},\n\t\t\t\t\t(response) => {\n\t\t\t\t\t\tconst messageCode = response.errors[0]?.code === 'AI_NOT_AVAILABLE'\n\t\t\t\t\t\t\t? 'CRM_COPILOT_CALL_ASSESSMENT_PAGE_COPILOT_ERROR'\n\t\t\t\t\t\t\t: 'CRM_COPILOT_CALL_ASSESSMENT_PAGE_SAVE_ERROR'\n\t\t\t\t\t\t;\n\n\t\t\t\t\t\tUI.Notification.Center.notify({\n\t\t\t\t\t\t\tcontent: Loc.getMessage(messageCode),\n\t\t\t\t\t\t\tautoHideDelay: 6000,\n\t\t\t\t\t\t});\n\t\t\t\t\t},\n\t\t\t\t)\n\t\t\t\t.catch((response) => {\n\t\t\t\t\tUI.Notification.Center.notify({\n\t\t\t\t\t\tcontent: Text.encode(response.errors[0].message),\n\t\t\t\t\t\tautoHideDelay: 6000,\n\t\t\t\t\t});\n\n\t\t\t\t\tthrow response;\n\t\t\t\t});\n\t\t},\n\t\tcloseSlider(): void\n\t\t{\n\t\t\ttop.BX.SidePanel.Instance.getSliderByWindow(window).close();\n\t\t},\n\t\tonSaveCallback(): void\n\t\t{\n\t\t\tif (Type.isFunction(this.params?.events?.onSave))\n\t\t\t{\n\t\t\t\tthis.params.events.onSave();\n\t\t\t}\n\t\t},\n\t\tsetActivePageId({ data }): void\n\t\t{\n\t\t\tconst newPageId = data.itemId;\n\t\t\tconst currentPageIndex = this.pagesList.indexOf(this.activePageId);\n\t\t\tconst newPageIndex = this.pagesList.indexOf(newPageId);\n\n\t\t\tif (currentPageIndex === newPageIndex)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (newPageIndex > currentPageIndex && !this.isActivePageValid())\n\t\t\t{\n\t\t\t\tthis.onActivePageValidationFailed();\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.activePageId = newPageId;\n\t\t},\n\t\tisPageActive(id: string): boolean\n\t\t{\n\t\t\treturn this.activePageId === id;\n\t\t},\n\t\tonPageDataChange({ id: pageId, data }): void\n\t\t{\n\t\t\tthis.pagesData[pageId] = data;\n\t\t\tthis.canShowNextPage = this.isActivePageReadyToMoveOn();\n\t\t},\n\t\tgetPageData(pageId: string): Object\n\t\t{\n\t\t\tif (Type.isObjectLike(this.pagesData[pageId]))\n\t\t\t{\n\t\t\t\treturn this.pagesData[pageId].data;\n\t\t\t}\n\n\t\t\treturn {};\n\t\t},\n\t\tgetPageSettings(pageId: string): Object\n\t\t{\n\t\t\tif (pageId === 'settings')\n\t\t\t{\n\t\t\t\treturn {\n\t\t\t\t\tbaas: this.settings.baas ?? {},\n\t\t\t\t};\n\t\t\t}\n\n\t\t\treturn {};\n\t\t},\n\t\tsetTitle(title: string): void\n\t\t{\n\t\t\tthis.title = title;\n\t\t},\n\t\tisActivePageValid(): boolean\n\t\t{\n\t\t\treturn this.getActivePage().validate();\n\t\t},\n\t\tonActivePageValidationFailed(): void\n\t\t{\n\t\t\treturn this.getActivePage().onValidationFailed();\n\t\t},\n\t\tisActivePageReadyToMoveOn(): boolean\n\t\t{\n\t\t\treturn this.getActivePage().isReadyToMoveOn();\n\t\t},\n\t\tgetActivePage(): Page\n\t\t{\n\t\t\treturn this.$refs[this.activePageId];\n\t\t},\n\t},\n\n\tcomputed: {\n\t\tpagesList(): []\n\t\t{\n\t\t\treturn [\n\t\t\t\t'about',\n\t\t\t\t'client',\n\t\t\t\t'settings',\n\t\t\t\t// 'control',\n\t\t\t\t// 'encouragement',\n\t\t\t];\n\t\t},\n\t\tisNew(): boolean\n\t\t{\n\t\t\treturn this.params.data?.id <= 0;\n\t\t},\n\t\treadOnly(): boolean\n\t\t{\n\t\t\treturn this.settings.readOnly;\n\t\t},\n\t},\n\n\tmounted()\n\t{\n\t\tthis.canShowNextPage = this.isActivePageReadyToMoveOn();\n\n\t\tthis.$Bitrix.eventEmitter.subscribe(BreadcrumbsEvents.itemClick, this.setActivePageId);\n\t\tthis.$Bitrix.eventEmitter.subscribe(ButtonEvents.click, this.onNavigationButtonClick);\n\t},\n\n\tbeforeUnmount()\n\t{\n\t\tthis.$Bitrix.eventEmitter.unsubscribe(BreadcrumbsEvents.itemClick, this.setActivePageId);\n\t\tthis.$Bitrix.eventEmitter.unsubscribe(ButtonEvents.click, this.onNavigationButtonClick);\n\t},\n\n\ttemplate: `\n\t\t<div class=\"crm-copilot__call-assessment_container\">\n\t\t\t<div class=\"crm-copilot__call-assessment_page-wrapper\">\n\t\t\t\t<AboutPage \n\t\t\t\t\t:is-active=\"isPageActive('about')\"\n\t\t\t\t\t:data=\"getPageData('about')\"\n\t\t\t\t\t:text-editor=\"textEditor\"\n\t\t\t\t\t@onChange=\"onPageDataChange\"\n\t\t\t\t\tref=\"about\"\n\t\t\t\t/>\n\t\t\t\t<ClientPage \n\t\t\t\t\t:is-active=\"isPageActive('client')\"\n\t\t\t\t\t:data=\"getPageData('client')\"\n\t\t\t\t\t:read-only=\"readOnly\"\n\t\t\t\t\t@onChange=\"onPageDataChange\"\n\t\t\t\t\tref=\"client\"\n\t\t\t\t/>\n\t\t\t\t<SettingsPage\n\t\t\t\t\t:is-active=\"isPageActive('settings')\"\n\t\t\t\t\t:data=\"getPageData('settings')\"\n\t\t\t\t\t:settings=\"getPageSettings('settings')\"\n\t\t\t\t\t:read-only=\"readOnly\"\n\t\t\t\t\t@onChange=\"onPageDataChange\"\n\t\t\t\t\tref=\"settings\"\n\t\t\t\t/>\n\t\t\t\t<!-- temporary hidden -->\n\t\t\t\t<!--<ControlPage\n\t\t\t\t\t:is-active=\"isPageActive('control')\"\n\t\t\t\t\t:data=\"getPageData('control')\"\n\t\t\t\t\t:read-only=\"readOnly\"\n\t\t\t\t\t@onChange=\"onPageDataChange\"\n\t\t\t\t\tref=\"control\"\n\t\t\t\t/>\n\t\t\t\t<EncouragementPage\n\t\t\t\t\t:is-active=\"isPageActive('encouragement')\"\n\t\t\t\t\t:data=\"getPageData('encouragement')\"\n\t\t\t\t\t:read-only=\"readOnly\"\n\t\t\t\t\t@onChange=\"onPageDataChange\"\n\t\t\t\t\tref=\"encouragement\"\n\t\t\t\t/>-->\n\t\t\t</div>\n\t\t\t<Navigation \n\t\t\t\t:active-tab-id=\"activePageId\"\n\t\t\t\t:is-enabled=\"canShowNextPage\"\n\t\t\t\t:read-only=\"readOnly\"\n\t\t\t\t:show-save-button=\"!isNew && !readOnly\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","import { Dom, Event, Loc, Tag, Text, Type } from 'main.core';\nimport { BasicEditor } from 'ui.text-editor';\nimport { BitrixVue, VueCreateAppResult } from 'ui.vue3';\nimport { CallAssessment as CallAssessmentComponent } from './components/call-assessment';\nimport 'ui.design-tokens';\nimport './call-assessment.css';\n\ntype CallAssessmentParams = {\n\tdata: Object,\n\tconfig?: Object,\n\tevents?: Object,\n}\n\nexport class CallAssessment\n{\n\t#container: HTMLElement;\n\t#app: ?VueCreateAppResult = null;\n\t#layoutComponent: ?Object = null;\n\n\t#titleId: ?string = null;\n\t#titleEditButtonId: ?string = null;\n\n\t#titleInputContainer = null;\n\t#titleNode: ?HTMLElement = null;\n\n\t#titleInput = null;\n\t#inputEditButton = null;\n\t#title: string = null;\n\n\t#textEditor: BasicEditor = null;\n\t#isReadOnly: boolean = true;\n\n\tconstructor(containerId: string, params: CallAssessmentParams = {})\n\t{\n\t\tthis.#container = document.getElementById(containerId);\n\n\t\tif (!Type.isDomNode(this.#container))\n\t\t{\n\t\t\tthrow new Error('container not found');\n\t\t}\n\n\t\tthis.#isReadOnly = params.config?.readOnly ?? true;\n\n\t\tthis.#initTitleInlineEditing(params);\n\n\t\tthis.#app = BitrixVue.createApp(CallAssessmentComponent, {\n\t\t\ttextEditor: this.#getTextEditor(params.data, params.config ?? {}),\n\t\t\tsettings: {\n\t\t\t\treadOnly: this.#isReadOnly,\n\t\t\t\tisCopy: params.config?.isCopy ?? false,\n\t\t\t\tbaas: params.config?.baasSettings ?? false,\n\t\t\t},\n\t\t\tparams: {\n\t\t\t\tdata: params.data,\n\t\t\t\tevents: params.events,\n\t\t\t},\n\t\t});\n\n\t\tthis.#layoutComponent = this.#app.mount(this.#container);\n\t}\n\n\t#initTitleInlineEditing(params: CallAssessmentParams): void\n\t{\n\t\tif (this.#isReadOnly)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.onTitleInlineEditingStart = this.onTitleInlineEditingStart.bind(this);\n\t\tthis.onTitleInlineEditingFinish = this.onTitleInlineEditingFinish.bind(this);\n\t\tthis.onTitleInputEnterPressed = this.onTitleInputEnterPressed.bind(this);\n\t\tthis.onTitleInputBlur = this.onTitleInputBlur.bind(this);\n\n\t\tconst { config, data } = params;\n\n\t\tconst { titleId, titleEditButtonId } = config ?? {};\n\n\t\tif (!Type.isStringFilled(titleId) || !Type.isStringFilled(titleEditButtonId))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#titleEditButtonId = titleEditButtonId;\n\t\tthis.#titleId = titleId;\n\n\t\tif (Type.isString(data?.title))\n\t\t{\n\t\t\tthis.#title = data.title;\n\t\t}\n\n\t\tthis.#bindTitleInlineEditingStart();\n\t}\n\n\t#bindTitleInlineEditingStart(): void\n\t{\n\t\tEvent.bind(this.#getInputEditButton(), 'click', this.onTitleInlineEditingStart);\n\t}\n\n\tonTitleInlineEditingStart(): void\n\t{\n\t\tif (this.#titleInputContainer !== null)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#appendTitleInput();\n\t\tthis.#hideTitle();\n\n\t\tthis.#bindTitleInlineEditingFinish();\n\t}\n\n\t#appendTitleInput(): void\n\t{\n\t\tthis.#titleInput = Tag.render`\n\t\t\t<input value=\"${Text.encode(this.#title)}\" type=\"text\" class=\"crm-copilot__call-assessment_title-item\" />\n\t\t`;\n\n\t\tthis.#titleInputContainer = Tag.render`\n\t\t\t<div class=\"crm-copilot__call-assessment_title-wrapper\">\n\t\t\t\t${this.#titleInput}\n\t\t\t</div>\n\t\t`;\n\n\t\tDom.append(this.#titleInputContainer, this.#getTitleNode().parentNode);\n\n\t\tthis.#titleInput.focus();\n\n\t\tconst length = this.#titleInput.value.length;\n\t\tthis.#titleInput.selectionStart = length;\n\t\tthis.#titleInput.selectionEnd = length;\n\n\t\tDom.addClass(\n\t\t\tdocument.querySelector('.copilot-call-assessment-pagetitle-description'),\n\t\t\t'--title-edit',\n\t\t);\n\t}\n\n\t#hideTitle(): void\n\t{\n\t\tDom.style(this.#getTitleNode(), { display: 'none' });\n\t\tDom.style(this.#getInputEditButton(), { display: 'none' });\n\t}\n\n\t#bindTitleInlineEditingFinish(): void\n\t{\n\t\tEvent.bind(document, 'mousedown', this.onTitleInlineEditingFinish);\n\t\tEvent.bind(this.#titleInput, 'keyup', this.onTitleInputEnterPressed);\n\t\tEvent.bind(this.#titleInput, 'blur', this.onTitleInputBlur);\n\t}\n\n\tonTitleInputBlur(event: KeyboardEvent): void\n\t{\n\t\tthis.onTitleInlineEditingFinish(event, false);\n\t}\n\n\tonTitleInputEnterPressed(event: KeyboardEvent): void\n\t{\n\t\tif (event.key === 'Enter')\n\t\t{\n\t\t\tthis.onTitleInlineEditingFinish(event, false);\n\t\t}\n\t}\n\n\tonTitleInlineEditingFinish(event: InputEvent, checkTarget: boolean = true): void\n\t{\n\t\tif (this.#titleInputContainer === null || this.#titleInput === null)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (\n\t\t\tcheckTarget\n\t\t\t&& (event.target === this.#titleInput || event.target === this.#getInputEditButton())\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst title = this.#titleInput.value;\n\t\tif (!Type.isStringFilled(title))\n\t\t{\n\t\t\tthis.#titleInput.focus();\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#title = title;\n\t\tthis.#layoutComponent.setTitle(this.#title);\n\n\t\tEvent.unbind(document, 'mousedown', this.onTitleInlineEditingFinish);\n\t\tEvent.unbind(this.#titleInput, 'keyup', this.onTitleInputEnterPressed);\n\t\tEvent.unbind(this.#titleInput, 'blur', this.onTitleInputBlur);\n\n\t\tthis.#hideInputAndShowTitle();\n\t}\n\n\t#getInputEditButton(): HTMLElement\n\t{\n\t\tif (this.#inputEditButton === null)\n\t\t{\n\t\t\tthis.#inputEditButton = document.getElementById(this.#titleEditButtonId);\n\t\t}\n\n\t\treturn this.#inputEditButton;\n\t}\n\n\t#hideInputAndShowTitle(): void\n\t{\n\t\tconst titleNode = this.#getTitleNode();\n\t\ttitleNode.innerText = this.#title;\n\n\t\tDom.style(titleNode, { display: 'inline-block' });\n\t\tDom.style(this.#getInputEditButton(), { display: 'inline-block' });\n\t\tDom.remove(this.#titleInputContainer);\n\n\t\tthis.#titleInputContainer = null;\n\n\t\tDom.removeClass(\n\t\t\tdocument.querySelector('.copilot-call-assessment-pagetitle-description'),\n\t\t\t'--title-edit',\n\t\t);\n\t}\n\n\t#getTitleNode(): HTMLElement\n\t{\n\t\tif (this.#titleNode === null)\n\t\t{\n\t\t\tthis.#titleNode = document.getElementById(this.#titleId);\n\t\t}\n\n\t\treturn this.#titleNode;\n\t}\n\n\t#getTextEditor({ prompt: content }, { copilotSettings }): BasicEditor\n\t{\n\t\tif (this.#textEditor !== null)\n\t\t{\n\t\t\treturn this.#textEditor;\n\t\t}\n\n\t\tthis.#textEditor = new BasicEditor({\n\t\t\teditable: !this.#isReadOnly,\n\t\t\tremovePlugins: ['BlockToolbar'],\n\t\t\tminHeight: 250,\n\t\t\tmaxHeight: 400,\n\t\t\tcontent,\n\t\t\tplaceholder: Loc.getMessage('CRM_COPILOT_CALL_ASSESSMENT_PLACEHOLDER'),\n\t\t\tparagraphPlaceholder: Loc.getMessage(\n\t\t\t\tType.isPlainObject(copilotSettings)\n\t\t\t\t\t? 'CRM_COPILOT_CALL_ASSESSMENT_PLACEHOLDER_WITH_COPILOT'\n\t\t\t\t\t: null,\n\t\t\t),\n\t\t\ttoolbar: [\n\t\t\t\t'bold', 'italic', 'underline', 'strikethrough',\n\t\t\t\t'|',\n\t\t\t\t'numbered-list', 'bulleted-list',\n\t\t\t\t'copilot',\n\t\t\t],\n\t\t\tfloatingToolbar: [],\n\t\t\tcollapsingMode: false,\n\t\t\tcopilot: {\n\t\t\t\tcopilotOptions: Type.isPlainObject(copilotSettings) ? copilotSettings : null,\n\t\t\t\ttriggerBySpace: true,\n\t\t\t},\n\t\t});\n\n\t\treturn this.#textEditor;\n\t}\n}\n"],"names":["BreadcrumbsEvents","itemClick","Breadcrumbs","props","activeTabId","type","String","data","tabs","getTabsData","methods","itemTitleClassList","id","isSoon","getTab","find","tab","title","Loc","getMessage","soon","emitClickEvent","itemId","$Bitrix","eventEmitter","emit","computed","soonTitle","template","ButtonEvents","click","Button","required","isEnabled","Boolean","default","mounted","initButton","watch","value","button","setState","ButtonState","ACTIVE","DISABLED","UiButton","text","toUpperCase","color","buttonColor","round","size","BX","UI","Size","LARGE","onclick","setDataSet","toLowerCase","$refs","renderTo","Color","SUCCESS","LIGHT_BORDER","LIGHT","ARTICLE_CODE","Navigation","components","readOnly","showSaveButton","help","buttons","showArticle","window","top","Helper","show","TextEditorWrapperComponent","TextEditorComponent","emits","textEditor","TextEditor","textEditorEvents","onChange","emitChangeData","editorOffsetTop","$el","parentNode","offsetTop","navigationClassName","navigationOffsetTop","document","querySelector","textEditorContainerBottomPadding","availableHeight","minHeight","Math","maxHeight","setMinHeight","setMaxHeight","Type","isFunction","onChangeDebounce","Runtime","debounce","$emit","prompt","getText","BasePage","isActive","Object","settings","getId","getData","isReadyToMoveOn","validate","onValidationFailed","Notification","Center","notify","content","autoHideDelay","LENGTH_RANGE","MIN","MAX","PromptLength","length","getError","AboutPage","extends","parser","BBCodeParser","promptLengthValidator","PromptLengthValidator","promptLengthError","isStringFilled","getPlainPromptText","call","parse","toPlainText","trim","pageTitle","pageDescription","clientType","freeze","new","inWork","return","repeated","ClientPage","activeClientTypeIds","clientTypeIds","getClientTypeClassList","clientTypeId","clientTypes","client","includes","onClientTypeSelect","index","indexOf","splice","push","onCheckboxClick","isArrayFilled","clientTypeEnum","description","SettingsPage","autoCheckTypeId","baas","hasPackage","callTypeId","onAutoCheckTypeIdChange","event","isBaasHasPackage","target","packageEmptySliderCode","InfoHelper","$nextTick","pageSectionSettingsCallType","pageSectionSettingsCallTypeDescription","callTypes","pageSectionSettingsCheck","pageSectionSettingsCheckDescription","checkTypes","isBaasAvailable","isAvailable","aiPackagesEmptySliderCode","CallAssessment","params","isCopy","pagesData","initPagesData","activePageId","canShowNextPage","pageId","onPageDataChange","getPageData","onNavigationButtonClick","closeSlider","currentIndex","pagesList","isActivePageValid","onActivePageValidationFailed","sendData","forEach","Ajax","runAction","then","response","status","Text","encode","errors","message","onSaveCallback","messageCode","code","catch","SidePanel","Instance","getSliderByWindow","close","events","onSave","setActivePageId","newPageId","currentPageIndex","newPageIndex","isPageActive","isActivePageReadyToMoveOn","isObjectLike","getPageSettings","setTitle","getActivePage","isNew","subscribe","beforeUnmount","unsubscribe","constructor","containerId","getElementById","isDomNode","Error","config","BitrixVue","createApp","CallAssessmentComponent","baasSettings","mount","onTitleInlineEditingStart","onTitleInputBlur","onTitleInlineEditingFinish","onTitleInputEnterPressed","key","checkTarget","focus","Event","unbind","bind","titleId","titleEditButtonId","isString","Tag","render","Dom","append","selectionStart","selectionEnd","addClass","style","display","titleNode","innerText","remove","removeClass","copilotSettings","BasicEditor","editable","removePlugins","placeholder","paragraphPlaceholder","isPlainObject","toolbar","floatingToolbar","collapsingMode","copilot","copilotOptions","triggerBySpace"],"mappings":"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"}