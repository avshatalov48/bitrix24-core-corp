{"version":3,"file":"terminal.bundle.js","sources":["../src/components/settings-container.js","../src/components/settings-section.js","../src/components/sms/sms.js","../src/components/sms/sms-provider-select.js","../src/components/sms/sms-settings-section.js","../src/components/sms/sms-settings.js","../src/const/required-paysystem-codes.js","../src/components/payment-systems/payment-methods-settings.js","../src/components/buttons-panel.js","../src/app.js"],"sourcesContent":["export const SettingsContainer = {\n\tprops: {\n\t\ttitle: String,\n\t\ticonStyle: String,\n\t\tcollapsed: Boolean,\n\t},\n\tmethods: {\n\t\tonTitleClicked()\n\t\t{\n\t\t\tthis.$emit('titleClick');\n\t\t},\n\t},\n\n\ttemplate: `\n\t<div class=\"settings-container\">\n\t\t<div\n\t\t\tclass=\"ui-slider-heading-4 settings-container-title\"\n\t\t\tv-bind:class=\"{ 'settings-container-title-collapsed': collapsed }\"\n\t\t\tv-on:click=\"onTitleClicked\"\n\t\t>\n\t\t\t<div :class=\"iconStyle\"></div>\n\t\t\t{{ title }}\n\t\t</div>\n\n\t\t<div class=\"settings-section-list\" v-bind:class=\"{ 'settings-section-list-collapsed': collapsed }\">\n\t\t\t<slot></slot>\n\t\t</div>\n\t</div>\n\t`,\n};\n","// @flow\n\nimport 'ui.switcher';\n\nexport const SettingsSection = {\n\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tisEnabled: this.active,\n\t\t\tswitcher: null,\n\t\t};\n\t},\n\n\tmounted()\n\t{\n\t\t(new BX.UI.Switcher({\n\t\t\tnode: this.$refs.switcher,\n\t\t\tsize: 'small',\n\t\t\tchecked: this.isEnabled,\n\t\t\thandlers: {\n\t\t\t\ttoggled: this.onSwitcherToggle.bind(this),\n\t\t\t},\n\t\t}));\n\n\t\tBX.UI.Hint.init(this.$refs.title);\n\t},\n\n\tmethods: {\n\t\tonSwitcherToggle()\n\t\t{\n\t\t\tthis.isEnabled = !this.isEnabled;\n\t\t\tthis.$emit('toggle', this.isEnabled);\n\t\t},\n\t\tonTitleClick()\n\t\t{\n\t\t\tthis.$emit('titleClick');\n\t\t},\n\t},\n\n\tprops: {\n\t\ttitle: String,\n\t\tswitchable: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\tactive: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\thint: {\n\t\t\ttype: String,\n\t\t\tdefault: '',\n\t\t},\n\t\tleftIconClass: {\n\t\t\ttype: String,\n\t\t\tdefault: '',\n\t\t},\n\t},\n\n\t// language=Vue\n\ttemplate: `\n\t\t<div>\n\t\t\t<div class=\"ui-slider-heading-4 settings-section-header\">\n\t\t\t\t<div v-if=\"switchable\" class=\"settings-setction-switcher-container\">\n\t\t\t\t\t<span ref=\"switcher\" class=\"ui-switcher\"></span>\n\t\t\t\t</div>\n\t\t\t\t<div v-if=\"leftIconClass\" :class=\"leftIconClass\"></div>\n\t\t\t\t<div\n\t\t\t\t\tstyle=\"font-size: 16px; margin-right: 0px;\"\n\t\t\t\t>\n\t\t\t\t\t{{ title }}\n\t\t\t\t</div>\n\t\t\t\t<span\n\t\t\t\t\tv-if=\"hint !== ''\"\n\t\t\t\t\tclass=\"ui-hint\"\n\t\t\t\t\tdata-hint-html\n\t\t\t\t\tdata-hint-interactivity\n\t\t\t\t\t:data-hint=\"hint\"\n\t\t\t\t>\n\t\t\t\t\t<span class=\"ui-hint-icon\"></span>\n\t\t\t\t</span>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","//@flow\n\nexport const Sms = {\n\t// language=Vue\n\ttemplate: `\n\t\t<div>\n\t\t\t<div class=\"sms-container\">\n\t\t\t\t<slot></slot>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};","// @flow\n\nimport { mapGetters, mapMutations } from 'ui.vue3.vuex';\nimport { Event } from 'main.core';\n\nexport const SmsProviderSelect = {\n\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tisListShowed: false,\n\t\t};\n\t},\n\n\tmounted() {\n\t\tEvent.bind(document, 'click', () => {\n\t\t\tthis.isListShowed = false;\n\t\t});\n\t},\n\n\tmethods: {\n\t\t...mapGetters([\n\t\t\t'getServiceLink',\n\t\t\t'getActiveSmsServices',\n\t\t]),\n\n\t\t...mapMutations([\n\t\t\t'selectSMSService',\n\t\t]),\n\n\t\tswitchService(serviceId)\n\t\t{\n\t\t\tthis.isListShowed = false;\n\t\t\tthis.selectSMSService(serviceId);\n\t\t},\n\n\t\tswitchVisibility() {\n\t\t\tthis.isListShowed = !this.isListShowed;\n\t\t},\n\n\t\topenSmsServicesSlider() {\n\t\t\tconst options = {\n\t\t\t\tcacheable: false,\n\t\t\t\tallowChangeHistory: false,\n\t\t\t\trequestMethod: 'get',\n\t\t\t\twidth: 700,\n\t\t\t\tevents: {\n\t\t\t\t\tonClose: () => {\n\t\t\t\t\t\tthis.$emit('onConnectSliderClosed');\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t};\n\n\t\t\tBX.SidePanel.Instance.open(this.getServiceLink(), options);\n\t\t},\n\t},\n\n\tcomputed: {\n\t\t...mapGetters([\n\t\t\t'getSelectedService',\n\t\t]),\n\n\t\tgetListClassname(): string\n\t\t{\n\t\t\tif (!this.isListShowed)\n\t\t\t{\n\t\t\t\treturn 'sms-provider-selector-hided-list';\n\t\t\t}\n\n\t\t\treturn 'sms-provider-selector-list';\n\t\t},\n\t},\n\n\t// language=Vue\n\ttemplate: `\n\t\t<div style=\"display: inline-block; vertical-align: top; position: relative;\">\n\t\t\t<span class=\"sms-provider-selector\" @click.stop=\"switchVisibility\">{{ $Bitrix.Loc.getMessage('CRM_CFG_TERMINAL_SETTINGS_SECTION_SMS_CHANGE_MSGVER_1') }}</span>\n\t\t\t<ul :class=\"getListClassname\" @click.stop>\n\t\t\t\t<li v-for=\"provider in getActiveSmsServices()\" @click=\"switchService(provider['ID'])\" v-show=\"provider['ID'] !== getSelectedService['ID']\">{{ provider['NAME'] }}</li>\n\t\t\t\t<li @click=\"openSmsServicesSlider\">{{ $Bitrix.Loc.getMessage('CRM_CFG_TERMINAL_SETTINGS_SECTION_SMS_SERVICE_PROVIDER_CONNECT_MORE') }}</li>\n\t\t\t</ul>\n\t\t</div>\n\t`,\n};\n","// @flow\n\nimport { SettingsSection } from '../settings-section';\nimport { NotificationLink } from '../../types';\nimport { Sms } from './sms';\nimport { ajax, Text } from 'main.core';\nimport { Popup } from 'main.popup';\nimport { SmsProviderSelect } from './sms-provider-select';\nimport { mapGetters, mapMutations } from 'ui.vue3.vuex';\n\nexport const SmsSettingsSection = {\n\n\tdata() {\n\t\treturn {\n\t\t\tpopup: null,\n\t\t};\n\t},\n\n\tcomponents: {\n\t\tSettingsSection,\n\t\tSms,\n\t\tSmsProviderSelect,\n\t},\n\n\tcomputed: {\n\t\t...mapGetters([\n\t\t\t'isSmsSendingActive',\n\t\t\t'isAnyServiceEnabled',\n\t\t\t'isNotificationsEnabled',\n\t\t\t'getSelectedService',\n\t\t]),\n\n\t\tgetSectionTitle(): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage('CRM_CFG_TERMINAL_SETTINGS_SECTION_SMS_TITLE');\n\t\t},\n\n\t\tgetSectionHint(): string\n\t\t{\n\t\t\tconst replacements = {\n\t\t\t\t'#LINK_START#': '<a onclick=\"top.BX.Helper.show(\\'redirect=detail&code=17399056\\')\" style=\"cursor: pointer\">',\n\t\t\t\t'#LINK_END#': '</a>',\n\t\t\t};\n\n\t\t\treturn this.$Bitrix.Loc.getMessage('CRM_CFG_TERMINAL_SETTINGS_SECTION_SMS_HINT_TEXT', replacements);\n\t\t},\n\t\tgetNotificationConnectHint(): string\n\t\t{\n\t\t\tconst replacements = {\n\t\t\t\t'#LINK_START#': '<span onclick=\"top.BX.Helper.show(\\'redirect=detail&code=17399068\\')\" class=\"sms-provider-selector\">',\n\t\t\t\t'#LINK_END#': '</span>',\n\t\t\t};\n\n\t\t\treturn this.$Bitrix.Loc.getMessage('CRM_CFG_TERMINAL_SETTINGS_SECTION_SMS_SERVICE_PROVIDER_UNC_CONNECTED', replacements);\n\t\t},\n\t},\n\n\tmethods: {\n\t\t...mapMutations([\n\t\t\t'setSmsSendingActive',\n\t\t\t'updateServicesList',\n\t\t\t'updateNotificationsEnabled',\n\t\t]),\n\t\t...mapGetters([\n\t\t\t'getPaymentSlipLinkScheme',\n\t\t\t'getNotificationsLink',\n\t\t\t'getServiceLink',\n\t\t]),\n\n\t\tonServiceConnectSliderClosed(): void\n\t\t{\n\t\t\tajax\n\t\t\t\t.runComponentAction('bitrix:crm.config.terminal.settings', 'updateServicesList')\n\t\t\t\t.then((response) => {\n\t\t\t\t\tif (response.status === 'success')\n\t\t\t\t\t{\n\t\t\t\t\t\tconst data = response.data;\n\t\t\t\t\t\tif (data?.isUCNEnabled)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.updateNotificationsEnabled(data.isUCNEnabled);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis.updateServicesList(data.activeSmsServices);\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.catch((error) => {\n\t\t\t\t\tconsole.error(error);\n\t\t\t\t});\n\t\t},\n\n\t\tonSectionToggled(): void\n\t\t{\n\t\t\tthis.setSmsSendingActive(!this.isSmsSendingActive);\n\t\t},\n\n\t\tgetSmsMessage(): string\n\t\t{\n\t\t\tconst link = `<br /><span class=\"sms-link-path\">${this.getPaymentSlipLinkScheme()}</span><span class=\"sms-link-plug\">xxxxx</span> `;\n\t\t\tconst text = this.$Bitrix.Loc.getMessage('CRM_CFG_TERMINAL_SETTINGS_SECTION_SMS_MESSAGE_TEMPLATE');\n\n\t\t\treturn Text.encode(text).replaceAll('#PAYMENT_SLIP_LINK#', link);\n\t\t},\n\n\t\tonSmsMouseenter(event): void\n\t\t{\n\t\t\tconst target = event.target;\n\t\t\tconst message = this.$Bitrix.Loc.getMessage('CRM_CFG_TERMINAL_SETTINGS_SECTION_SMS_MESSAGE_HINT');\n\n\t\t\tif (this.popup)\n\t\t\t{\n\t\t\t\tthis.popup.destroy();\n\t\t\t\tthis.popup = null;\n\t\t\t}\n\n\t\t\tthis.popup = new Popup(null, target, {\n\t\t\t\tevents: {\n\t\t\t\t\tonPopupClose: () => {\n\t\t\t\t\t\tthis.popup.destroy();\n\t\t\t\t\t\tthis.popup = null;\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tdarkMode: true,\n\t\t\t\tcontent: message,\n\t\t\t\toffsetLeft: target.offsetWidth,\n\t\t\t});\n\n\t\t\tthis.popup.show();\n\t\t},\n\n\t\tonSmsMouseleave(): void\n\t\t{\n\t\t\tthis.popup.destroy();\n\t\t},\n\n\t\tonNotificationsConnectLinkClick(): void\n\t\t{\n\t\t\tconst notificationLink: NotificationLink = this.getNotificationsLink();\n\t\t\tif (notificationLink === null)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (notificationLink.type === 'connect_link')\n\t\t\t{\n\t\t\t\tconst options = {\n\t\t\t\t\tcacheable: false,\n\t\t\t\t\tallowChangeHistory: false,\n\t\t\t\t\trequestMethod: 'get',\n\t\t\t\t\twidth: 700,\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tonClose: () => {\n\t\t\t\t\t\t\tthis.onServiceConnectSliderClosed();\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t};\n\n\t\t\t\tBX.SidePanel.Instance.open(notificationLink.value, options);\n\t\t\t}\n\t\t\telse if (notificationLink.type === 'ui_helper')\n\t\t\t{\n\t\t\t\ttop.BX.UI.InfoHelper.show(notificationLink.value);\n\t\t\t}\n\t\t},\n\n\t\tonProviderSmsNotificationClick(): void\n\t\t{\n\t\t\tconst options = {\n\t\t\t\tcacheable: false,\n\t\t\t\tallowChangeHistory: false,\n\t\t\t\trequestMethod: 'get',\n\t\t\t\twidth: 700,\n\t\t\t\tevents: {\n\t\t\t\t\tonClose: () => {\n\t\t\t\t\t\tthis.onServiceConnectSliderClosed();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t};\n\n\t\t\tBX.SidePanel.Instance.open(this.getServiceLink(), options);\n\t\t},\n\t},\n\n\t// language=Vue\n\ttemplate: `\n\t\t<div v-if=\"isAnyServiceEnabled\" style=\"display: flex; justify-content: space-between; margin-bottom: 24px;\">\n\t\t\t<div>\n\t\t\t\t<SettingsSection\n\t\t\t\t\t:title=\"getSectionTitle\"\n\t\t\t\t\t:switchable=\"true\"\n\t\t\t\t\tv-on:toggle=\"onSectionToggled\"\n\t\t\t\t\t:active=\"isSmsSendingActive\"\n\t\t\t\t\t:hint=\"getSectionHint\"\n\t\t\t\t/>\n\t\t\t\t<div style=\"margin-left: 53px;\">\n\t\t\t\t\t<div\n\t\t\t\t\t\tv-html=\"getNotificationConnectHint\"\n\t\t\t\t\t\tv-if=\"isNotificationsEnabled\"\n\t\t\t\t\t\tclass=\"sms-provider-name\"\n\t\t\t\t\t></div>\n\t\t\t\t\t<div v-else>\n\t\t\t\t\t\t<div class=\"sms-provider-name\" style=\"padding: 3px 0;\">\n\t\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('CRM_CFG_TERMINAL_SETTINGS_SECTION_SMS_SERVICE_SELECT_MSGVER_2', {'%PROVIDER_NAME%': getSelectedService['NAME']}) }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<SmsProviderSelect v-on:onConnectSliderClosed=\"onServiceConnectSliderClosed\"/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div>\n\t\t\t\t<div class=\"sms-provider-message-title\">\n\t\t\t\t\t{{ $Bitrix.Loc.getMessage('CRM_CFG_TERMINAL_SETTINGS_SECTION_SMS_MESSAGE_TITLE') }}\n\t\t\t\t</div>\n\t\t\t\t<div>\n\t\t\t\t\t<Sms>\n\t\t\t\t\t\t<span\n\t\t\t\t\t\t\tv-html=\"getSmsMessage()\"\n\t\t\t\t\t\t\tv-on:mouseenter=\"onSmsMouseenter($event)\"\n\t\t\t\t\t\t\tv-on:mouseleave=\"onSmsMouseleave\"\n\t\t\t\t\t\t></span>\n\t\t\t\t\t</Sms>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div style=\"margin-bottom: 24px;\" v-else>\n\t\t\t<span class=\"sms-provider-empty-provider-list-text\" v-if=\"(getNotificationsLink() !== null) && (getServiceLink() !== '')\">\n\t\t\t\t{{ $Bitrix.Loc.getMessage('CRM_CFG_TERMINAL_SETTINGS_SECTION_SMS_ONBOARDING_TEXT') }}\n\t\t\t</span>\n\t\t\t<span class=\"sms-provider-empty-provider-list-text\" v-else-if=\"(getNotificationsLink() === null) && (getServiceLink() !== '')\">\n\t\t\t\t{{ $Bitrix.Loc.getMessage('CRM_CFG_TERMINAL_SETTINGS_SECTION_SMS_ONBOARDING_ONLY_SMS_SERVICES_TEXT') }}\n\t\t\t</span>\n\t\t\t<button class=\"ui-btn ui-btn-md ui-btn-primary\" @click=\"onNotificationsConnectLinkClick\" v-if=\"getNotificationsLink() !== null\">\n\t\t\t\t{{ $Bitrix.Loc.getMessage('CRM_CFG_TERMINAL_SETTINGS_SECTION_SMS_SERVICE_UNC_CONNECT_BTN') }}\n\t\t\t</button>\n\n\t\t\t<button class=\"ui-btn ui-btn-md ui-btn-light-border\" @click=\"onProviderSmsNotificationClick\" v-if=\"(getNotificationsLink() !== null) && (getServiceLink() !== '')\">\n\t\t\t\t{{ $Bitrix.Loc.getMessage('CRM_CFG_TERMINAL_SETTINGS_SECTION_SMS_SERVICE_PROVIDER_CONNECT_BTN') }}\n\t\t\t</button>\n\t\t\t<button class=\"ui-btn ui-btn-md ui-btn-primary\" @click=\"onProviderSmsNotificationClick\" v-else-if=\"(getNotificationsLink() === null) && (getServiceLink() !== '')\">\n\t\t\t\t{{ $Bitrix.Loc.getMessage('CRM_CFG_TERMINAL_SETTINGS_SECTION_SMS_SERVICE_PROVIDER_CONNECT_BTN') }}\n\t\t\t</button>\n\t\t</div>\n\t`,\n};\n","// @flow\n\nimport { ajax } from 'main.core';\nimport { SettingsContainer } from '../settings-container';\nimport { SmsSettingsSection } from './sms-settings-section';\nimport { mapGetters, mapMutations } from 'ui.vue3.vuex';\n\nexport const SmsSettings = {\n\tcomponents: {\n\t\tSettingsContainer,\n\t\tSmsSettingsSection,\n\t},\n\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\tisSettingsChanged: 'isChanged',\n\t\t\tisSaving: 'isSaving',\n\t\t\tgetIsSmsCollapsed: 'getIsSmsCollapsed',\n\t\t}),\n\t},\n\tmethods: {\n\t\t...mapMutations([\n\t\t\t'updateIsSmsCollapsed',\n\t\t]),\n\n\t\tonTitleClick()\n\t\t{\n\t\t\tthis.updateIsSmsCollapsed(!this.getIsSmsCollapsed);\n\t\t\tajax.runComponentAction(\n\t\t\t\t'bitrix:crm.config.terminal.settings',\n\t\t\t\t'updateSmsCollapsed',\n\t\t\t\t{\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tcollapsed: this.getIsSmsCollapsed,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t);\n\t\t},\n\t},\n\n\t// language=Vue\n\ttemplate: `\n\t\t<SettingsContainer\n\t\t\t:title=\"$Bitrix.Loc.getMessage('CRM_CFG_TERMINAL_SETTINGS_SUBTITLE_NOTIFICATION')\"\n\t\t\ticonStyle=\"settings-section-icon-sms\"\n\t\t\t:collapsed=\"getIsSmsCollapsed\"\n\t\t\tv-on:titleClick=\"onTitleClick\"\n\t\t>\n\t\t\t<SmsSettingsSection />\n\t\t</SettingsContainer>\n\t`,\n};\n","export const RequiredPaysystemCodes = Object.freeze({\n\tsbp: 'sbp',\n\tsberQr: 'sberQr',\n\trest: 'rest',\n\tpaysystemPanel: 'paysystemPanel',\n});\n","import { rest as Rest } from 'rest.client';\nimport { mapGetters, mapMutations } from 'ui.vue3.vuex';\nimport { SettingsSection } from '../settings-section';\nimport { PhoneVerify } from 'bitrix24.phoneverify';\nimport { MessageBox } from 'ui.dialogs.messagebox';\nimport { SettingsContainer } from '../settings-container';\nimport { RequiredPaysystemCodes } from '../../const/required-paysystem-codes';\nimport { Label, LabelColor, LabelSize } from 'ui.label';\nimport { ajax, Type, Uri } from 'main.core';\nimport { Backend } from 'landing.backend';\nimport { PageObject } from 'landing.pageobject';\n\nexport const PaymentMethodsSettings = {\n\n\tcomponents: {\n\t\tSettingsSection,\n\t\tSettingsContainer,\n\t},\n\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\tgetAvailablePaysystems: 'getAvailablePaysystems',\n\t\t\tgetTerminalDisabledPaysystems: 'getTerminalDisabledPaysystems',\n\t\t\tgetIsLinkPaymentEnabled: 'getIsLinkPaymentEnabled',\n\t\t\tgetIsSbpEnabled: 'getIsSbpEnabled',\n\t\t\tgetIsSberQrEnabled: 'getIsSberQrEnabled',\n\t\t\tgetIsSbpConnected: 'getIsSbpConnected',\n\t\t\tgetIsSberQrConnected: 'getIsSberQrConnected',\n\t\t\tgetIsRuZone: 'getIsRuZone',\n\t\t\tgetSbpConnectPath: 'getSbpConnectPath',\n\t\t\tgetSberQrConnectPath: 'getSberQrConnectPath',\n\t\t\tgetIsAnyPaysystemActive: 'getIsAnyPaysystemActive',\n\t\t\tgetPaysystemPanelPath: 'getPaysystemPanelPath',\n\t\t\tgetIsPaysystemsCollapsed: 'getIsPaysystemsCollapsed',\n\t\t\tgetPaysystemsArticleUrl: 'getPaysystemsArticleUrl',\n\t\t\tgetIsPhoneConfirmed: 'getIsPhoneConfirmed',\n\t\t\tgetConnectedSiteId: 'getConnectedSiteId',\n\t\t\tgetIsConnectedSitePublished: 'getIsConnectedSitePublished',\n\t\t\tgetIsConnectedSiteExists: 'getIsConnectedSiteExists',\n\t\t}),\n\n\t\tgetRequiredPaysystemCodes(): void\n\t\t{\n\t\t\treturn RequiredPaysystemCodes;\n\t\t},\n\n\t\tgetLinkPaymentHint(): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage('CRM_CFG_TERMINAL_SETTINGS_SECTION_PS_LINK_PAYMENT_HINT');\n\t\t},\n\t},\n\n\tmethods: {\n\t\t...mapMutations([\n\t\t\t'setTerminalPaysystemDisabled',\n\t\t\t'setLinkPaymentEnabled',\n\t\t\t'setRequiredPaysystemDisabled',\n\t\t\t'updateSbpConnectPath',\n\t\t\t'updateSberQrConnectPath',\n\t\t\t'updateIsSbpConnected',\n\t\t\t'updateIsSberQrConnected',\n\t\t\t'updateIsPaysystemsCollapsed',\n\t\t\t'updateIsAnyPaysystemActive',\n\t\t\t'updateAvailablePaysystems',\n\t\t\t'updateIsPhoneConfirmed',\n\t\t\t'updateConnectedSiteId',\n\t\t\t'updateIsConnectedSitePublished',\n\t\t\t'updateIsConnectedSiteExists',\n\t\t]),\n\n\t\tonPaysystemToggled(paysystemId: number)\n\t\t{\n\t\t\tthis.setTerminalPaysystemDisabled(paysystemId);\n\t\t},\n\n\t\tonRequiredPaysystemToggled(paysystemCode: string)\n\t\t{\n\t\t\tthis.setRequiredPaysystemDisabled(paysystemCode);\n\t\t},\n\n\t\tonLinkPaymentToggled()\n\t\t{\n\t\t\tthis.setLinkPaymentEnabled(!this.getIsLinkPaymentEnabled);\n\t\t},\n\t\topenPaysystemSlider(psMode: string, link: string = '')\n\t\t{\n\t\t\tconst options = {\n\t\t\t\tcacheable: false,\n\t\t\t\tallowChangeHistory: false,\n\t\t\t\trequestMethod: 'get',\n\t\t\t\twidth: psMode === RequiredPaysystemCodes.paysystemPanel ? null : 1000,\n\t\t\t\tevents: {\n\t\t\t\t\tonClose: () => {\n\t\t\t\t\t\tthis.onPaysystemSliderClosed();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t};\n\t\t\tconst url = psMode === RequiredPaysystemCodes.rest ? link : this.getPaysystemUrl(psMode);\n\t\t\tBX.SidePanel.Instance.open(url, options);\n\t\t},\n\t\tgetPaysystemUrl(psMode: string): string\n\t\t{\n\t\t\tswitch (psMode)\n\t\t\t{\n\t\t\t\tcase RequiredPaysystemCodes.sbp:\n\t\t\t\t\treturn this.getSbpConnectPath;\n\t\t\t\tcase RequiredPaysystemCodes.sberQr:\n\t\t\t\t\treturn this.getSberQrConnectPath;\n\t\t\t\tcase RequiredPaysystemCodes.paysystemPanel:\n\t\t\t\t\treturn this.getPaysystemPanelPath;\n\t\t\t\tdefault:\n\t\t\t\t\treturn '';\n\t\t\t}\n\t\t},\n\t\tonPaysystemSliderClosed()\n\t\t{\n\t\t\tajax.runComponentAction('bitrix:crm.config.terminal.settings', 'updatePaysystemPaths')\n\t\t\t\t.then((response) => {\n\t\t\t\t\tthis.updateSbpConnectPath(response.data.sbp);\n\t\t\t\t\tthis.updateSberQrConnectPath(response.data.sberbankQr);\n\t\t\t\t\tthis.updateIsSbpConnected(response.data.isSbpConnected);\n\t\t\t\t\tthis.updateIsSberQrConnected(response.data.isSberQrConnected);\n\t\t\t\t\tthis.updateIsAnyPaysystemActive(response.data.isAnyPaysystemActive);\n\t\t\t\t\tthis.updateAvailablePaysystems(response.data.availablePaysystems);\n\t\t\t\t})\n\t\t\t\t.catch(() => {});\n\t\t},\n\n\t\tonSiteSliderClosed()\n\t\t{\n\t\t\tthis.loader.show(document.body);\n\n\t\t\tajax.runComponentAction('bitrix:crm.config.terminal.settings', 'updateConnectedSiteParams')\n\t\t\t\t.then((response) => {\n\t\t\t\t\tthis.loader.hide();\n\n\t\t\t\t\tthis.updateIsConnectedSiteExists(response.data.isConnectedSiteExists);\n\t\t\t\t\tthis.updateConnectedSiteId(response.data.connectedSiteId);\n\t\t\t\t\tthis.updateIsPhoneConfirmed(response.data.isPhoneConfirmed);\n\t\t\t\t\tthis.updateIsConnectedSitePublished(response.data.isConnectedSitePublished);\n\n\t\t\t\t\tthis.connectSite();\n\t\t\t\t})\n\t\t\t\t.catch(() => {});\n\t\t},\n\n\t\tgetStatusLabel(connected = false)\n\t\t{\n\t\t\tconst text = this.$Bitrix.Loc.getMessage(\n\t\t\t\tconnected\n\t\t\t\t\t? 'CRM_CFG_TERMINAL_SETTINGS_SECTION_PS_CONNECTED'\n\t\t\t\t\t: 'CRM_CFG_TERMINAL_SETTINGS_SECTION_PS_NOT_CONNECTED'\n\t\t\t).toUpperCase();\n\t\t\tconst label = new Label({\n\t\t\t\ttext,\n\t\t\t\tcolor: connected ? LabelColor.LIGHT_GREEN : LabelColor.LIGHT,\n\t\t\t\tsize: LabelSize.LG,\n\t\t\t\tfill: true,\n\t\t\t});\n\n\t\t\treturn label.render().outerHTML;\n\t\t},\n\n\t\tonTitleClick()\n\t\t{\n\t\t\tthis.updateIsPaysystemsCollapsed(!this.getIsPaysystemsCollapsed);\n\t\t\tajax.runComponentAction(\n\t\t\t\t'bitrix:crm.config.terminal.settings',\n\t\t\t\t'updatePaysystemsCollapsed',\n\t\t\t\t{\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tcollapsed: this.getIsPaysystemsCollapsed,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t);\n\t\t},\n\n\t\tconnectSite()\n\t\t{\n\t\t\tif (!this.loader)\n\t\t\t{\n\t\t\t\tthis.loader = new BX.Loader({ size: 200 });\n\t\t\t}\n\n\t\t\tif (!this.getIsConnectedSiteExists)\n\t\t\t{\n\t\t\t\tthis.createSite();\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!this.getIsConnectedSitePublished)\n\t\t\t{\n\t\t\t\tthis.publishSite();\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!this.getIsPhoneConfirmed)\n\t\t\t{\n\t\t\t\tthis.showPhoneConfirmationPopup();\n\t\t\t}\n\t\t},\n\n\t\tcreateSite(): void\n\t\t{\n\t\t\tthis.loader.show(document.body);\n\n\t\t\tRest.callMethod('salescenter.manager.getConfig').then((result) => {\n\t\t\t\tconst {\n\t\t\t\t\tconnectedSiteId,\n\t\t\t\t\tisSiteExists,\n\t\t\t\t\tisPhoneConfirmed,\n\t\t\t\t\tsiteTemplateCode,\n\t\t\t\t} = result.answer.result;\n\n\t\t\t\tthis.loader.hide();\n\n\t\t\t\tif (isSiteExists && connectedSiteId > 0)\n\t\t\t\t{\n\t\t\t\t\tthis.updateIsConnectedSiteExists(isSiteExists);\n\t\t\t\t\tthis.updateConnectedSiteId(connectedSiteId);\n\t\t\t\t\tthis.updateIsPhoneConfirmed(isPhoneConfirmed);\n\n\t\t\t\t\tif (isPhoneConfirmed)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.publishSite();\n\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.showPhoneConfirmationPopup();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tconst url = new Uri('/shop/stores/site/edit/0/');\n\t\t\t\t\tconst params = {\n\t\t\t\t\t\tcontext: 'terminal',\n\t\t\t\t\t\ttpl: siteTemplateCode,\n\t\t\t\t\t\tno_redirect: 'Y',\n\t\t\t\t\t};\n\n\t\t\t\t\turl.setQueryParams(params);\n\n\t\t\t\t\tconst options = {\n\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\tonClose: () => {\n\t\t\t\t\t\t\t\tthis.onSiteSliderClosed();\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t};\n\n\t\t\t\t\tBX.SidePanel.Instance.open(url.toString(), options);\n\t\t\t\t}\n\t\t\t}).catch(() => this.loader.hide());\n\t\t},\n\n\t\tpublishSite(): void\n\t\t{\n\t\t\tthis.loader.show(document.body);\n\n\t\t\tBackend.getInstance().action('Site::publication', {\n\t\t\t\tid: this.getConnectedSiteId,\n\t\t\t})\n\t\t\t\t.then((publishedSiteId) => {\n\t\t\t\t\tthis.loader.hide();\n\n\t\t\t\t\tif (publishedSiteId)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.updateIsConnectedSitePublished(true);\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.catch((data) => {\n\t\t\t\t\tthis.loader.hide();\n\n\t\t\t\t\tif (data.type === 'error' && !Type.isUndefined(data.result[0]))\n\t\t\t\t\t{\n\t\t\t\t\t\tconst errorCode = data.result[0].error;\n\n\t\t\t\t\t\tif (errorCode === 'PHONE_NOT_CONFIRMED')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.showPhoneConfirmationPopup();\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (errorCode === 'EMAIL_NOT_CONFIRMED')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tBX.UI.InfoHelper.show('limit_sites_confirm_email');\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tMessageBox.alert(\n\t\t\t\t\t\t\t\tdata.result[0].error_description,\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t},\n\n\t\tconfirmPhoneNumber()\n\t\t{\n\t\t\tthis.loader.show(document.body);\n\n\t\t\tPhoneVerify\n\t\t\t\t.getInstance()\n\t\t\t\t.setEntityType('landing_site')\n\t\t\t\t.setEntityId(this.getConnectedSiteId)\n\t\t\t\t.startVerify({\n\t\t\t\t\tmandatory: false,\n\t\t\t\t\tcallback: (verified) => {\n\t\t\t\t\t\tthis.loader.hide();\n\n\t\t\t\t\t\tif (!verified)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis.updateIsPhoneConfirmed(verified);\n\n\t\t\t\t\t\tif (!this.getIsConnectedSitePublished)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.publishSite();\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t})\n\t\t\t;\n\t\t},\n\n\t\tshowPhoneConfirmationPopup()\n\t\t{\n\t\t\tMessageBox.confirm(\n\t\t\t\tthis.$Bitrix.Loc.getMessage('CRM_CFG_TERMINAL_SETTINGS_SECTION_PS_PHONE_CONFIRMATION_POPUP_MESSAGE'),\n\t\t\t\tthis.$Bitrix.Loc.getMessage('CRM_CFG_TERMINAL_SETTINGS_SECTION_PS_PHONE_CONFIRMATION_POPUP_TITLE'),\n\t\t\t\t(messageBox) => {\n\t\t\t\t\tmessageBox.close();\n\t\t\t\t\tthis.confirmPhoneNumber();\n\t\t\t\t},\n\t\t\t\tthis.$Bitrix.Loc.getMessage('CRM_CFG_TERMINAL_SETTINGS_SECTION_PS_PHONE_CONFIRMATION_POPUP_OK_CAPTION'),\n\t\t\t\t(messageBox) => messageBox.close(),\n\t\t\t\tthis.$Bitrix.Loc.getMessage('CRM_CFG_TERMINAL_SETTINGS_SECTION_PS_PHONE_CONFIRMATION_POPUP_CANCEL_CAPTION'),\n\t\t\t);\n\t\t},\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<SettingsContainer\n\t\t\t:title=\"$Bitrix.Loc.getMessage('CRM_CFG_TERMINAL_SETTINGS_SECTION_PS_TITLE_MSGVER_1')\"\n\t\t\ticonStyle=\"settings-section-icon-payment-methods\"\n\t\t\t:collapsed=\"getIsPaysystemsCollapsed\"\n\t\t\tv-on:titleClick=\"onTitleClick\"\n\t\t\tv-bind:style=\"{ 'padding-bottom: 0px;' : !getIsPaysystemsCollapsed }\"\n\t\t>\n\n\t\t\t<div\n\t\t\t\tclass=\"payment-systems-subtitle\"\n\t\t\t\tv-html=\"$Bitrix.Loc.getMessage(\n\t\t\t\t\t'CRM_CFG_TERMINAL_SETTINGS_SECTION_PS_SUBTITLE_MSGVER_1',\n\t\t\t\t\t{'#MORE_INFO_LINK#': getPaysystemsArticleUrl})\"\n\t\t\t></div>\n\n\t\t\t<div class=\"payment-systems-section-container\">\n\t\t\t\t<div class=\"payment-systems-container\">\n\t\t\t\t\t<div v-if=\"getIsRuZone\" class=\"payment-system-wrapper\">\n\t\t\t\t\t\t<SettingsSection\n\t\t\t\t\t\t\t:title=\"$Bitrix.Loc.getMessage('CRM_CFG_TERMINAL_SETTINGS_SECTION_PS_SBP')\"\n\t\t\t\t\t\t\t:switchable=\"true\"\n\t\t\t\t\t\t\t:active=\"getIsSbpEnabled\"\n\t\t\t\t\t\t\tleftIconClass=\"payment-method-icon-sbp\"\n\t\t\t\t\t\t\tv-on:toggle=\"onRequiredPaysystemToggled(getRequiredPaysystemCodes.sbp)\"\n\t\t\t\t\t\t\tv-on:titleClick=\"openPaysystemSlider(getRequiredPaysystemCodes.sbp)\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<div class=\"payment-system-status-container\">\n\t\t\t\t\t\t\t<span v-html=\"getStatusLabel(this.getIsSbpConnected)\"></span>\n\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\tclass=\"payment-system-set\"\n\t\t\t\t\t\t\t\t:class=\"getIsSbpConnected ? 'payment-system-set-connected' : 'payment-system-set-not-connected'\"\n\t\t\t\t\t\t\t\tv-on:click=\"openPaysystemSlider(getRequiredPaysystemCodes.sbp)\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage(this.getIsSbpConnected\n\t\t\t\t\t\t\t\t? 'CRM_CFG_TERMINAL_SETTINGS_SECTION_PS_SET'\n\t\t\t\t\t\t\t\t: 'CRM_CFG_TERMINAL_SETTINGS_SECTION_PS_CONNECT') }}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div v-if=\"getIsRuZone\" class=\"payment-system-wrapper\">\n\t\t\t\t\t\t<SettingsSection\n\t\t\t\t\t\t\t:title=\"$Bitrix.Loc.getMessage('CRM_CFG_TERMINAL_SETTINGS_SECTION_PS_SBER_QR_MSGVER_1')\"\n\t\t\t\t\t\t\t:switchable=\"true\"\n\t\t\t\t\t\t\t:active=\"getIsSberQrEnabled\"\n\t\t\t\t\t\t\tleftIconClass=\"payment-method-icon-sber\"\n\t\t\t\t\t\t\tv-on:toggle=\"onRequiredPaysystemToggled(getRequiredPaysystemCodes.sberQr)\"\n\t\t\t\t\t\t\tv-on:titleClick=\"openPaysystemSlider(getRequiredPaysystemCodes.sberQr)\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<div class=\"payment-system-status-container\">\n\t\t\t\t\t\t\t<span v-html=\"getStatusLabel(this.getIsSberQrConnected)\"></span>\n\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\tclass=\"payment-system-set\"\n\t\t\t\t\t\t\t\t:class=\"getIsSberQrConnected ? 'payment-system-set-connected' : 'payment-system-set-not-connected'\"\n\t\t\t\t\t\t\t\tv-on:click=\"openPaysystemSlider(getRequiredPaysystemCodes.sberQr)\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage(this.getIsSberQrConnected\n\t\t\t\t\t\t\t\t? 'CRM_CFG_TERMINAL_SETTINGS_SECTION_PS_SET'\n\t\t\t\t\t\t\t\t: 'CRM_CFG_TERMINAL_SETTINGS_SECTION_PS_CONNECT') }}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div\n\t\t\t\t\t\tv-if=\"getAvailablePaysystems.length > 0\"\n\t\t\t\t\t\tv-for=\"paysystem in getAvailablePaysystems\"\n\t\t\t\t\t\tclass=\"payment-system-wrapper\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<SettingsSection\n\t\t\t\t\t\t\t:key=\"paysystem.type\"\n\t\t\t\t\t\t\t:title=\"paysystem.title\"\n\t\t\t\t\t\t\t:switchable=\"paysystem.id > 0\"\n\t\t\t\t\t\t\t:active=\"paysystem.id > 0 && !getTerminalDisabledPaysystems.includes(paysystem.id)\"\n\t\t\t\t\t\t\tv-on:toggle=\"onPaysystemToggled(paysystem.id)\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<div class=\"payment-system-status-container\">\n\t\t\t\t\t\t\t<span v-html=\"getStatusLabel(paysystem.isConnected)\"></span>\n\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\tclass=\"payment-system-set\"\n\t\t\t\t\t\t\t\t:class=\"paysystem.isConnected ? 'payment-system-set-connected' : 'payment-system-set-not-connected'\"\n\t\t\t\t\t\t\t\tv-on:click=\"openPaysystemSlider(getRequiredPaysystemCodes.rest, paysystem.path)\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage(paysystem.isConnected\n\t\t\t\t\t\t\t\t? 'CRM_CFG_TERMINAL_SETTINGS_SECTION_PS_SET'\n\t\t\t\t\t\t\t\t: 'CRM_CFG_TERMINAL_SETTINGS_SECTION_PS_CONNECT') }}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"payment-system-wrapper\">\n\t\t\t\t\t\t<SettingsSection\n\t\t\t\t\t\t\t:title=\"$Bitrix.Loc.getMessage('CRM_CFG_TERMINAL_SETTINGS_SECTION_PS_LINK_PAYMENT')\"\n\t\t\t\t\t\t\t:switchable=\"true\"\n\t\t\t\t\t\t\t:active=\"getIsLinkPaymentEnabled\"\n\t\t\t\t\t\t\tv-on:toggle=\"onLinkPaymentToggled()\"\n\t\t\t\t\t\t\t:hint=\"getLinkPaymentHint\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<div class=\"payment-system-status-container\">\n\t\t\t\t\t\t\t<span v-html=\"getStatusLabel(this.getIsAnyPaysystemActive && this.getIsConnectedSitePublished && getIsPhoneConfirmed)\"></span>\n\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\tclass=\"payment-system-set payment-system-set-connected\"\n\t\t\t\t\t\t\t\tv-on:click=\"openPaysystemSlider(getRequiredPaysystemCodes.paysystemPanel)\"\n\t\t\t\t\t\t\t\tv-if=\"getIsConnectedSitePublished && getIsPhoneConfirmed\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('CRM_CFG_TERMINAL_SETTINGS_SECTION_PS_PAYMENT_METHOD') }}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\tclass=\"payment-system-set payment-system-set-not-connected\"\n\t\t\t\t\t\t\t\tv-on:click=\"connectSite()\"\n\t\t\t\t\t\t\t\tv-else\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('CRM_CFG_TERMINAL_SETTINGS_SECTION_PS_CONNECT') }}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"terminal-image-wrapper\"></div>\n\t\t\t</div>\n\n\t\t</SettingsContainer>\n\t`,\n};\n","import { mapGetters } from 'ui.vue3.vuex';\n\nexport const ButtonsPanel = {\n\tmethods: {\n\t\tsave()\n\t\t{\n\t\t\tthis.$Bitrix.eventEmitter.emit('crm:terminal:onSettingsSave');\n\t\t},\n\t\tcancel()\n\t\t{\n\t\t\tthis.$Bitrix.eventEmitter.emit('crm:terminal:onSettingsCancel');\n\t\t},\n\t},\n\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\tisSettingsChanged: 'isChanged',\n\t\t\tisSaving: 'isSaving',\n\t\t}),\n\n\t\tbuttonsPanelClass()\n\t\t{\n\t\t\treturn {\n\t\t\t\t'ui-button-panel-wrapper': true,\n\t\t\t\t'ui-pinner': true,\n\t\t\t\t'ui-pinner-bottom': true,\n\t\t\t\t'ui-pinner-full-width': true,\n\t\t\t\t'ui-button-panel-wrapper-hide': !this.isSettingsChanged,\n\t\t\t};\n\t\t},\n\t\tsaveButtonClasses()\n\t\t{\n\t\t\treturn {\n\t\t\t\t'ui-btn': true,\n\t\t\t\t'ui-btn-success': true,\n\t\t\t\t'ui-btn-wait': this.isSaving,\n\t\t\t};\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div :class=\"buttonsPanelClass\">\n\t\t\t<div class=\"ui-button-panel ui-button-panel-align-center\">\n\t\t\t\t<button\n\t\t\t\t\t@click=\"save\"\n\t\t\t\t\t:class=\"saveButtonClasses\"\n\t\t\t\t>\n\t\t\t\t\t{{ $Bitrix.Loc.getMessage('CRM_CFG_TERMINAL_SETTINGS_SAVE_BTN') }}\n\t\t\t\t</button>\n\t\t\t\t<a\n\t\t\t\t\t@click=\"cancel\"\n\t\t\t\t\tclass=\"ui-btn ui-btn-link\"\n\t\t\t\t>\n\t\t\t\t\t{{ $Bitrix.Loc.getMessage('CRM_CFG_TERMINAL_SETTINGS_CANCEL_BTN') }}\n\t\t\t\t</a>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","// @flow\n\nimport { MessageBox } from 'ui.dialogs.messagebox';\nimport type { TerminalSettingsProps, NotificationLink, SmsService, TerminalPaysystem } from './types';\nimport { Type, ajax } from 'main.core';\nimport { BitrixVue, VueCreateAppResult } from 'ui.vue3';\nimport { SmsSettings } from './components/sms/sms-settings';\nimport { PaymentMethodsSettings } from './components/payment-systems/payment-methods-settings';\nimport { ButtonsPanel } from './components/buttons-panel';\nimport { RequiredPaysystemCodes } from './const/required-paysystem-codes';\nimport { createStore, mapGetters, mapMutations, Store } from 'ui.vue3.vuex';\nimport '../css/app.css';\nimport 'ui.notification';\n\ntype AppProps = {\n\trootNodeId: string,\n\tterminalSettings: TerminalSettingsProps,\n};\n\nexport class App\n{\n\t#application: VueCreateAppResult;\n\trootNode: HTMLElement;\n\tterminalSettings: TerminalSettingsProps;\n\n\tconstructor(props: AppProps) {\n\t\tthis.rootNode = document.getElementById(props.rootNodeId);\n\t\tthis.terminalSettings = props.terminalSettings;\n\n\t\tthis.store = this.#initStore(props.terminalSettings);\n\t}\n\n\t#initStore(terminalSettings: TerminalSettingsProps): Store\n\t{\n\t\tconst terminalSettingsStore = {\n\t\t\tstate(): Object\n\t\t\t{\n\t\t\t\treturn {\n\t\t\t\t\t...terminalSettings,\n\t\t\t\t\tisSaving: false,\n\t\t\t\t\tchangedValues: {},\n\t\t\t\t};\n\t\t\t},\n\n\t\t\tgetters: {\n\t\t\t\tisChanged(state): boolean\n\t\t\t\t{\n\t\t\t\t\treturn Object.keys(state.changedValues).length > 0;\n\t\t\t\t},\n\n\t\t\t\tisSmsSendingActive(state): boolean\n\t\t\t\t{\n\t\t\t\t\tif (state.changedValues.isSmsSendingEnabled !== undefined)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn state.changedValues.isSmsSendingEnabled;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn state.isSmsSendingEnabled;\n\t\t\t\t},\n\n\t\t\t\tisAnyServiceEnabled(state): boolean\n\t\t\t\t{\n\t\t\t\t\treturn (state.activeSmsServices.length > 0 || state.isNotificationsEnabled);\n\t\t\t\t},\n\n\t\t\t\tisNotificationsEnabled(state): boolean\n\t\t\t\t{\n\t\t\t\t\treturn state.isNotificationsEnabled;\n\t\t\t\t},\n\n\t\t\t\tgetPaymentSlipLinkScheme(state): string\n\t\t\t\t{\n\t\t\t\t\treturn state.paymentSlipLinkScheme;\n\t\t\t\t},\n\n\t\t\t\tgetNotificationsLink(state): ?NotificationLink\n\t\t\t\t{\n\t\t\t\t\tif (Type.isObject(state.connectNotificationsLink))\n\t\t\t\t\t{\n\t\t\t\t\t\treturn state.connectNotificationsLink;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn null;\n\t\t\t\t},\n\n\t\t\t\tisNotificationAvailableToConnect(state): string\n\t\t\t\t{\n\t\t\t\t\treturn this.getNotificationsLink(state) !== null;\n\t\t\t\t},\n\n\t\t\t\tgetServiceLink(state): string\n\t\t\t\t{\n\t\t\t\t\tif (Type.isString(state.connectServiceLink))\n\t\t\t\t\t{\n\t\t\t\t\t\treturn state.connectServiceLink;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn '';\n\t\t\t\t},\n\n\t\t\t\tgetSelectedService(state): SmsService\n\t\t\t\t{\n\t\t\t\t\tif (Type.isString(state.changedValues.selectedServiceId))\n\t\t\t\t\t{\n\t\t\t\t\t\treturn state.activeSmsServices.find((element) => element.ID === state.changedValues.selectedServiceId);\n\t\t\t\t\t}\n\n\t\t\t\t\treturn state.activeSmsServices.find((element) => element.SELECTED);\n\t\t\t\t},\n\n\t\t\t\tgetIsAnyPaysystemEnabled(state, getters): boolean\n\t\t\t\t{\n\t\t\t\t\tlet hasEnabledPaysystem = false;\n\t\t\t\t\tfor (const paysystem: Object of getters.getAvailablePaysystems)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (!getters.getTerminalDisabledPaysystems.includes(paysystem.id))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\thasEnabledPaysystem = true;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\treturn getters.getIsSbpEnabled\n\t\t\t\t\t\t|| getters.getIsSberQrEnabled\n\t\t\t\t\t\t|| getters.getIsLinkPaymentEnabled\n\t\t\t\t\t\t|| hasEnabledPaysystem\n\t\t\t\t\t;\n\t\t\t\t},\n\n\t\t\t\tgetActiveSmsServices(state): Array<SmsService>\n\t\t\t\t{\n\t\t\t\t\treturn state.activeSmsServices;\n\t\t\t\t},\n\n\t\t\t\tgetChangedValues(state): Object\n\t\t\t\t{\n\t\t\t\t\treturn state.changedValues;\n\t\t\t\t},\n\n\t\t\t\tisSaving(state): boolean\n\t\t\t\t{\n\t\t\t\t\treturn state.isSaving;\n\t\t\t\t},\n\n\t\t\t\tgetAvailablePaysystems(state): Array<TerminalPaysystem>\n\t\t\t\t{\n\t\t\t\t\treturn state.availablePaysystems;\n\t\t\t\t},\n\n\t\t\t\tgetTerminalDisabledPaysystems(state): Array<number>\n\t\t\t\t{\n\t\t\t\t\treturn state.terminalDisabledPaysystems;\n\t\t\t\t},\n\n\t\t\t\tgetIsLinkPaymentEnabled(state): boolean\n\t\t\t\t{\n\t\t\t\t\treturn state.isLinkPaymentEnabled;\n\t\t\t\t},\n\n\t\t\t\tgetPaysystemPanelPath(state): string\n\t\t\t\t{\n\t\t\t\t\treturn state.paysystemPanelPath;\n\t\t\t\t},\n\n\t\t\t\tgetIsAnyPaysystemActive(state): boolean\n\t\t\t\t{\n\t\t\t\t\treturn state.isAnyPaysystemActive;\n\t\t\t\t},\n\n\t\t\t\tgetIsSbpEnabled(state): boolean\n\t\t\t\t{\n\t\t\t\t\treturn state.isSbpEnabled;\n\t\t\t\t},\n\n\t\t\t\tgetSbpConnectPath(state): boolean\n\t\t\t\t{\n\t\t\t\t\treturn state.sbpConnectPath;\n\t\t\t\t},\n\n\t\t\t\tgetIsSbpConnected(state): boolean\n\t\t\t\t{\n\t\t\t\t\treturn state.isSbpConnected;\n\t\t\t\t},\n\n\t\t\t\tgetIsSberQrEnabled(state): boolean\n\t\t\t\t{\n\t\t\t\t\treturn state.isSberQrEnabled;\n\t\t\t\t},\n\n\t\t\t\tgetSberQrConnectPath(state): boolean\n\t\t\t\t{\n\t\t\t\t\treturn state.sberQrConnectPath;\n\t\t\t\t},\n\n\t\t\t\tgetIsSberQrConnected(state): boolean\n\t\t\t\t{\n\t\t\t\t\treturn state.isSberQrConnected;\n\t\t\t\t},\n\n\t\t\t\tgetIsPaysystemsCollapsed(state): boolean\n\t\t\t\t{\n\t\t\t\t\treturn state.isPaysystemsCollapsed;\n\t\t\t\t},\n\n\t\t\t\tgetPaysystemsArticleUrl(state): boolean\n\t\t\t\t{\n\t\t\t\t\treturn state.paysystemsArticleUrl;\n\t\t\t\t},\n\n\t\t\t\tgetIsSmsCollapsed(state): boolean\n\t\t\t\t{\n\t\t\t\t\treturn state.isSmsCollapsed;\n\t\t\t\t},\n\n\t\t\t\tgetIsRuZone(state): boolean\n\t\t\t\t{\n\t\t\t\t\treturn state.isRuZone;\n\t\t\t\t},\n\n\t\t\t\tgetIsPhoneConfirmed(state): boolean\n\t\t\t\t{\n\t\t\t\t\treturn state.isPhoneConfirmed;\n\t\t\t\t},\n\n\t\t\t\tgetConnectedSiteId(state)\n\t\t\t\t{\n\t\t\t\t\treturn state.connectedSiteId;\n\t\t\t\t},\n\n\t\t\t\tgetIsConnectedSitePublished(state): boolean\n\t\t\t\t{\n\t\t\t\t\treturn state.isConnectedSitePublished;\n\t\t\t\t},\n\n\t\t\t\tgetIsConnectedSiteExists(state): boolean\n\t\t\t\t{\n\t\t\t\t\treturn state.isConnectedSiteExists;\n\t\t\t\t},\n\t\t\t},\n\n\t\t\tmutations: {\n\t\t\t\tsetSmsSendingActive(state, value): void\n\t\t\t\t{\n\t\t\t\t\tif (state.changedValues.isSmsSendingEnabled !== undefined && value === state.isSmsSendingEnabled)\n\t\t\t\t\t{\n\t\t\t\t\t\tdelete state.changedValues.isSmsSendingEnabled;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.isChanged = true;\n\t\t\t\t\t\tstate.changedValues.isSmsSendingEnabled = value;\n\t\t\t\t\t}\n\t\t\t\t},\n\n\t\t\t\tselectSMSService(state, value): void\n\t\t\t\t{\n\t\t\t\t\tif (state.activeSmsServices.find((element) => element.SELECTED).ID === value)\n\t\t\t\t\t{\n\t\t\t\t\t\tdelete state.changedValues.selectedServiceId;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.changedValues.selectedServiceId = value;\n\t\t\t\t\t}\n\t\t\t\t},\n\n\t\t\t\tsetTerminalPaysystemDisabled(state, paysystemId): void\n\t\t\t\t{\n\t\t\t\t\tif (!Array.isArray(state.changedValues.terminalDisabledPaysystems))\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.changedValues.terminalDisabledPaysystems = state.terminalDisabledPaysystems;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (state.changedValues.terminalDisabledPaysystems.includes(paysystemId))\n\t\t\t\t\t{\n\t\t\t\t\t\tconst currentDisabledPs = state.changedValues.terminalDisabledPaysystems ?? [];\n\t\t\t\t\t\tstate.changedValues.terminalDisabledPaysystems = currentDisabledPs.filter((ps) => ps !== paysystemId);\n\t\t\t\t\t\tstate.terminalDisabledPaysystems = state.changedValues.terminalDisabledPaysystems;\n\t\t\t\t\t\tif (state.changedValues.terminalDisabledPaysystems.length === 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tstate.changedValues.terminalPaysystemsAllEnabled = true;\n\t\t\t\t\t\t\tstate.terminalPaysystemsAllEnabled = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tstate.isChanged = true;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.isChanged = true;\n\t\t\t\t\t\tif (state.changedValues.terminalDisabledPaysystems)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tstate.changedValues.terminalDisabledPaysystems.push(paysystemId);\n\t\t\t\t\t\t\tstate.terminalDisabledPaysystems.push(paysystemId);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tstate.changedValues.terminalDisabledPaysystems = [paysystemId];\n\t\t\t\t\t\t\tstate.terminalDisabledPaysystems = [paysystemId];\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tdelete state.changedValues.terminalPaysystemsAllEnabled;\n\t\t\t\t\t\tdelete state.terminalPaysystemsAllEnabled;\n\t\t\t\t\t}\n\t\t\t\t},\n\n\t\t\t\tsetRequiredPaysystemDisabled(state, paysystemCode): void\n\t\t\t\t{\n\t\t\t\t\tlet paysystemKey;\n\t\t\t\t\tswitch (paysystemCode)\n\t\t\t\t\t{\n\t\t\t\t\t\tcase RequiredPaysystemCodes.sbp:\n\t\t\t\t\t\t\tpaysystemKey = 'isSbpEnabled';\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase RequiredPaysystemCodes.sberQr:\n\t\t\t\t\t\t\tpaysystemKey = 'isSberQrEnabled';\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tpaysystemKey = null;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!paysystemKey)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tstate[paysystemKey] = !state[paysystemKey];\n\t\t\t\t\tstate.changedValues[paysystemKey] = state[paysystemKey];\n\t\t\t\t},\n\n\t\t\t\tsetLinkPaymentEnabled(state, value): void\n\t\t\t\t{\n\t\t\t\t\tif (state.changedValues.isLinkPaymentEnabled !== undefined && value === state.isLinkPaymentEnabled)\n\t\t\t\t\t{\n\t\t\t\t\t\tdelete state.changedValues.isLinkPaymentEnabled;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.isChanged = true;\n\t\t\t\t\t\tstate.changedValues.isLinkPaymentEnabled = value;\n\t\t\t\t\t\tstate.isLinkPaymentEnabled = value;\n\t\t\t\t\t}\n\t\t\t\t},\n\n\t\t\t\tsetSaving(state, value): void\n\t\t\t\t{\n\t\t\t\t\tif (Type.isBoolean(value))\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.isSaving = value;\n\t\t\t\t\t}\n\t\t\t\t},\n\n\t\t\t\tupdateServicesList(state, value): void\n\t\t\t\t{\n\t\t\t\t\tstate.activeSmsServices = value;\n\t\t\t\t},\n\n\t\t\t\tupdateNotificationsEnabled(state, value): void\n\t\t\t\t{\n\t\t\t\t\tstate.isNotificationsEnabled = value;\n\t\t\t\t},\n\n\t\t\t\tupdateSbpConnectPath(state, value): void\n\t\t\t\t{\n\t\t\t\t\tstate.sbpConnectPath = value;\n\t\t\t\t},\n\n\t\t\t\tupdateSberQrConnectPath(state, value): void\n\t\t\t\t{\n\t\t\t\t\tstate.sberQrConnectPath = value;\n\t\t\t\t},\n\n\t\t\t\tupdateIsSbpConnected(state, value): void\n\t\t\t\t{\n\t\t\t\t\tstate.isSbpConnected = value;\n\t\t\t\t},\n\n\t\t\t\tupdateIsSberQrConnected(state, value): void\n\t\t\t\t{\n\t\t\t\t\tstate.isSberQrConnected = value;\n\t\t\t\t},\n\n\t\t\t\tupdateIsPaysystemsCollapsed(state, value): void\n\t\t\t\t{\n\t\t\t\t\tstate.isPaysystemsCollapsed = value;\n\t\t\t\t},\n\n\t\t\t\tupdateIsSmsCollapsed(state, value): void\n\t\t\t\t{\n\t\t\t\t\tstate.isSmsCollapsed = value;\n\t\t\t\t},\n\n\t\t\t\tupdateIsAnyPaysystemActive(state, value): void\n\t\t\t\t{\n\t\t\t\t\tstate.isAnyPaysystemActive = value;\n\t\t\t\t},\n\n\t\t\t\tupdateAvailablePaysystems(state, value): void\n\t\t\t\t{\n\t\t\t\t\tstate.availablePaysystems = value;\n\t\t\t\t},\n\n\t\t\t\tupdateIsPhoneConfirmed(state, value): void\n\t\t\t\t{\n\t\t\t\t\tstate.isPhoneConfirmed = value;\n\t\t\t\t},\n\n\t\t\t\tupdateConnectedSiteId(state, value): void\n\t\t\t\t{\n\t\t\t\t\tstate.connectedSiteId = value;\n\t\t\t\t},\n\n\t\t\t\tupdateIsConnectedSitePublished(state, value): void\n\t\t\t\t{\n\t\t\t\t\tstate.isConnectedSitePublished = value;\n\t\t\t\t},\n\n\t\t\t\tupdateIsConnectedSiteExists(state, value): void\n\t\t\t\t{\n\t\t\t\t\tstate.isConnectedSiteExists = value;\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\n\t\treturn createStore(terminalSettingsStore);\n\t}\n\n\tattachTemplate(): void\n\t{\n\t\tthis.#application = BitrixVue.createApp({\n\t\t\tcomponents: {\n\t\t\t\tSmsSettings,\n\t\t\t\tPaymentMethodsSettings,\n\t\t\t\tButtonsPanel,\n\t\t\t},\n\n\t\t\tcomputed: {\n\t\t\t\t...mapGetters([\n\t\t\t\t\t'isChanged',\n\t\t\t\t\t'isSaving',\n\t\t\t\t\t'getChangedValues',\n\t\t\t\t\t'getIsPaysystemsCollapsed',\n\t\t\t\t\t'getIsSbpEnabled',\n\t\t\t\t\t'getIsSberQrEnabled',\n\t\t\t\t\t'getIsLinkPaymentEnabled',\n\t\t\t\t\t'getAvailablePaysystems',\n\t\t\t\t\t'getTerminalDisabledPaysystems',\n\t\t\t\t\t'getIsAnyPaysystemEnabled',\n\t\t\t\t]),\n\t\t\t},\n\n\t\t\tmounted()\n\t\t\t{\n\t\t\t\tthis.$Bitrix.eventEmitter.subscribe('crm:terminal:onSettingsSave', this.onSettingsSave);\n\t\t\t\tthis.$Bitrix.eventEmitter.subscribe('crm:terminal:onSettingsCancel', this.onSettingsCancel);\n\t\t\t},\n\n\t\t\tbeforeUnmount()\n\t\t\t{\n\t\t\t\tthis.$Bitrix.eventEmitter.unsubscribe('crm:terminal:onSettingsSave');\n\t\t\t\tthis.$Bitrix.eventEmitter.unsubscribe('crm:terminal:onSettingsCancel');\n\t\t\t},\n\n\t\t\tmethods: {\n\t\t\t\t...mapMutations([\n\t\t\t\t\t'setSaving',\n\t\t\t\t]),\n\n\t\t\t\tvalidateChangedValues(): Object\n\t\t\t\t{\n\t\t\t\t\tconst values = this.getChangedValues;\n\t\t\t\t\tif (values && Object.keys(values).length > 0)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn values;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn {};\n\t\t\t\t},\n\n\t\t\t\tonSettingsSave()\n\t\t\t\t{\n\t\t\t\t\tif (this.getIsAnyPaysystemEnabled)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.save();\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tMessageBox.confirm(\n\t\t\t\t\t\t\tthis.$Bitrix.Loc.getMessage('CRM_CFG_TERMINAL_SETTINGS_SAVING_CONFIRM_TITLE'),\n\t\t\t\t\t\t\t(messageBox) => messageBox.close(),\n\t\t\t\t\t\t\tthis.$Bitrix.Loc.getMessage('CRM_CFG_TERMINAL_SETTINGS_SAVING_CONFIRM_OK'),\n\t\t\t\t\t\t\t(messageBox) => {\n\t\t\t\t\t\t\t\tmessageBox.close();\n\t\t\t\t\t\t\t\tthis.save();\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tthis.$Bitrix.Loc.getMessage('CRM_CFG_TERMINAL_SETTINGS_SAVING_CONFIRM_SAVE_AND_CLOSE'),\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t},\n\n\t\t\t\tsave()\n\t\t\t\t{\n\t\t\t\t\tif (!this.isChanged || this.isSaving)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tthis.setSaving(true);\n\t\t\t\t\tajax\n\t\t\t\t\t\t.runComponentAction('bitrix:crm.config.terminal.settings', 'saveSettings', {\n\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\tchangedValues: this.validateChangedValues(),\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t}).then(\n\t\t\t\t\t\t\t() => {\n\t\t\t\t\t\t\t\tthis.setSaving(false);\n\t\t\t\t\t\t\t\tBX.SidePanel.Instance.close();\n\t\t\t\t\t\t\t\ttop.BX.UI.Notification.Center.notify({\n\t\t\t\t\t\t\t\t\tcontent: this.$Bitrix.Loc.getMessage('CRM_CFG_TERMINAL_SETTINGS_ON_SAVE_SUCCESS'),\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t() => {\n\t\t\t\t\t\t\t\tthis.setSaving(false);\n\t\t\t\t\t\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\t\t\t\t\t\tcontent: this.$Bitrix.Loc.getMessage('CRM_CFG_TERMINAL_SETTINGS_ON_SAVE_ERROR'),\n\t\t\t\t\t\t\t\t\twidth: 350,\n\t\t\t\t\t\t\t\t\tautoHideDelay: 4000,\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t);\n\t\t\t\t},\n\n\t\t\t\tonSettingsCancel()\n\t\t\t\t{\n\t\t\t\t\tBX.SidePanel.Instance.close();\n\t\t\t\t},\n\t\t\t},\n\n\t\t\t// language=Vue\n\t\t\ttemplate: `\n\t\t\t\t<div style=\"position: relative; overflow: hidden;\">\n\t\t\t\t\t<div class=\"ui-side-panel-wrap-workarea payment-methods-settings-wrapper\">\n\t\t\t\t\t\t<PaymentMethodsSettings/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass=\"terminal-image\"\n\t\t\t\t\t\tv-bind:class=\"{ 'terminal-image-collapsed': this.getIsPaysystemsCollapsed }\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<div class=\"terminal-image-title\">{{ $Bitrix.Loc.getMessage('CRM_CFG_TERMINAL_SETTINGS_IMAGE_TITLE') }}</div>\n\t\t\t\t\t\t<div class=\"terminal-image-paysystems-container\">\n\t\t\t\t\t\t\t<div v-if=\"getIsSbpEnabled\" class=\"terminal-image-paysystem terminal-image-paysystem-sbp\">\n\t\t\t\t\t\t\t\t<span>{{ $Bitrix.Loc.getMessage('CRM_CFG_TERMINAL_SETTINGS_SECTION_PS_SBP') }}</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div v-if=\"getIsSberQrEnabled\" class=\"terminal-image-paysystem terminal-image-paysystem-sber-qr\">\n\t\t\t\t\t\t\t\t<span>{{ $Bitrix.Loc.getMessage('CRM_CFG_TERMINAL_SETTINGS_SECTION_PS_SBER_QR_MSGVER_1') }}</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<template v-if=\"getAvailablePaysystems.length > 0\" v-for=\"paysystem in getAvailablePaysystems\">\n\t\t\t\t\t\t\t\t<div class=\"terminal-image-paysystem terminal-image-paysystem-wallet\" v-if=\"getTerminalDisabledPaysystems.indexOf(paysystem.id) === -1\">\n\t\t\t\t\t\t\t\t\t<span>{{ paysystem.title }}</span>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t<div v-if=\"getIsLinkPaymentEnabled\" class=\"terminal-image-paysystem terminal-image-paysystem-link\">\n\t\t\t\t\t\t\t\t<span>{{ $Bitrix.Loc.getMessage('CRM_CFG_TERMINAL_SETTINGS_SECTION_PS_LINK_PAYMENT') }}</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"terminal-image-no-paysystems-stub\" v-if=\"!getIsAnyPaysystemEnabled\">\n\t\t\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('CRM_CFG_TERMINAL_SETTINGS_SECTION_PS_NO_PAY_METHODS') }}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"ui-side-panel-wrap-workarea\" style=\"margin-bottom: 70px;\">\n\t\t\t\t\t<SmsSettings/>\n\t\t\t\t</div>\n\n\t\t\t\t<ButtonsPanel/>\n\t\t\t`,\n\t\t});\n\n\t\tthis.#application.use(this.store);\n\t\tthis.#application.mount(this.rootNode);\n\t}\n}\n"],"names":["SettingsContainer","props","title","String","iconStyle","collapsed","Boolean","methods","onTitleClicked","$emit","template","SettingsSection","data","isEnabled","active","switcher","mounted","BX","UI","Switcher","node","$refs","size","checked","handlers","toggled","onSwitcherToggle","bind","Hint","init","onTitleClick","switchable","type","hint","leftIconClass","Sms","SmsProviderSelect","isListShowed","Event","document","mapGetters","mapMutations","switchService","serviceId","selectSMSService","switchVisibility","openSmsServicesSlider","options","cacheable","allowChangeHistory","requestMethod","width","events","onClose","SidePanel","Instance","open","getServiceLink","computed","getListClassname","SmsSettingsSection","popup","components","getSectionTitle","$Bitrix","Loc","getMessage","getSectionHint","replacements","getNotificationConnectHint","onServiceConnectSliderClosed","ajax","runComponentAction","then","response","status","isUCNEnabled","updateNotificationsEnabled","updateServicesList","activeSmsServices","error","console","onSectionToggled","setSmsSendingActive","isSmsSendingActive","getSmsMessage","link","getPaymentSlipLinkScheme","text","Text","encode","replaceAll","onSmsMouseenter","event","target","message","destroy","Popup","onPopupClose","darkMode","content","offsetLeft","offsetWidth","show","onSmsMouseleave","onNotificationsConnectLinkClick","notificationLink","getNotificationsLink","value","top","InfoHelper","onProviderSmsNotificationClick","SmsSettings","isSettingsChanged","isSaving","getIsSmsCollapsed","updateIsSmsCollapsed","RequiredPaysystemCodes","Object","freeze","sbp","sberQr","rest","paysystemPanel","PaymentMethodsSettings","getAvailablePaysystems","getTerminalDisabledPaysystems","getIsLinkPaymentEnabled","getIsSbpEnabled","getIsSberQrEnabled","getIsSbpConnected","getIsSberQrConnected","getIsRuZone","getSbpConnectPath","getSberQrConnectPath","getIsAnyPaysystemActive","getPaysystemPanelPath","getIsPaysystemsCollapsed","getPaysystemsArticleUrl","getIsPhoneConfirmed","getConnectedSiteId","getIsConnectedSitePublished","getIsConnectedSiteExists","getRequiredPaysystemCodes","getLinkPaymentHint","onPaysystemToggled","paysystemId","setTerminalPaysystemDisabled","onRequiredPaysystemToggled","paysystemCode","setRequiredPaysystemDisabled","onLinkPaymentToggled","setLinkPaymentEnabled","openPaysystemSlider","psMode","onPaysystemSliderClosed","url","getPaysystemUrl","updateSbpConnectPath","updateSberQrConnectPath","sberbankQr","updateIsSbpConnected","isSbpConnected","updateIsSberQrConnected","isSberQrConnected","updateIsAnyPaysystemActive","isAnyPaysystemActive","updateAvailablePaysystems","availablePaysystems","onSiteSliderClosed","loader","body","hide","updateIsConnectedSiteExists","isConnectedSiteExists","updateConnectedSiteId","connectedSiteId","updateIsPhoneConfirmed","isPhoneConfirmed","updateIsConnectedSitePublished","isConnectedSitePublished","connectSite","getStatusLabel","connected","toUpperCase","label","Label","color","LabelColor","LIGHT_GREEN","LIGHT","LabelSize","LG","fill","render","outerHTML","updateIsPaysystemsCollapsed","Loader","createSite","publishSite","showPhoneConfirmationPopup","Rest","callMethod","result","answer","isSiteExists","siteTemplateCode","Uri","params","context","tpl","no_redirect","setQueryParams","toString","Backend","getInstance","action","id","publishedSiteId","Type","isUndefined","errorCode","MessageBox","alert","error_description","confirmPhoneNumber","PhoneVerify","setEntityType","setEntityId","startVerify","mandatory","callback","verified","confirm","messageBox","close","ButtonsPanel","save","eventEmitter","emit","cancel","buttonsPanelClass","saveButtonClasses","App","rootNode","getElementById","rootNodeId","terminalSettings","store","BitrixVue","createApp","subscribe","onSettingsSave","onSettingsCancel","beforeUnmount","unsubscribe","validateChangedValues","values","getChangedValues","keys","length","getIsAnyPaysystemEnabled","isChanged","setSaving","changedValues","Notification","Center","notify","autoHideDelay","use","mount","terminalSettingsStore","state","getters","isSmsSendingEnabled","undefined","isAnyServiceEnabled","isNotificationsEnabled","paymentSlipLinkScheme","isObject","connectNotificationsLink","isNotificationAvailableToConnect","isString","connectServiceLink","getSelectedService","selectedServiceId","find","element","ID","SELECTED","hasEnabledPaysystem","paysystem","includes","getActiveSmsServices","terminalDisabledPaysystems","isLinkPaymentEnabled","paysystemPanelPath","isSbpEnabled","sbpConnectPath","isSberQrEnabled","sberQrConnectPath","isPaysystemsCollapsed","paysystemsArticleUrl","isSmsCollapsed","isRuZone","mutations","Array","isArray","currentDisabledPs","filter","ps","terminalPaysystemsAllEnabled","push","paysystemKey","isBoolean","createStore"],"mappings":"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"}