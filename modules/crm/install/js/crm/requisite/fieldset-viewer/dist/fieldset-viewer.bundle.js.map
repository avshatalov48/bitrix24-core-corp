{"version":3,"file":"fieldset-viewer.bundle.js","sources":["../src/fieldset-viewer.js"],"sourcesContent":["import {Cache, Type, Event, Tag, Loc, Text, Dom} from 'main.core';\nimport {EventEmitter, BaseEvent} from 'main.core.events';\nimport {Popup} from 'main.popup';\nimport {Loader} from 'main.loader';\nimport {Button} from 'ui.buttons';\nimport {ListEditor} from 'crm.field.list-editor';\n\nimport './css/style.css';\n\ntype FieldsetViewerOptions = {\n\tentityTypeId: number,\n\tentityId: number,\n\tbindElement: HTMLElement,\n\tpopupOptions?: {[key: string]: any},\n\tfieldListEditorOptions?: {[key: string]: any},\n\tfieldsPanelOptions?: {[key: string]: any},\n\tevents: {\n\t\tonClose?: (BaseEvent) => void,\n\t},\n};\n\ntype RequestError = {\n\tmessage: string,\n\tcode: string | null,\n\tcustomData: any,\n};\n\n/**\n * @namespace BX.Crm.Requisite\n */\nexport class FieldsetViewer extends EventEmitter\n{\n\tcache = new Cache.MemoryCache();\n\tendpoint = 'crm.api.fieldset.load';\n\n\tconstructor(options: FieldsetViewerOptions = {})\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Crm.Requisite.FieldsetViewer');\n\t\tthis.subscribeFromOptions(options?.events || {});\n\t\tthis.setOptions(options);\n\t\tEvent.bind(options.bindElement, 'click', this.onBindElementClick.bind(this));\n\t}\n\n\tsetData(data: {[key: string]: any})\n\t{\n\t\tthis.cache.set('data', data);\n\t}\n\n\tsetEndpoint(endpoint: string): FieldsetViewer\n\t{\n\t\tthis.endpoint = endpoint;\n\n\t\treturn this;\n\t}\n\n\tgetData(): {[key: string]: any}\n\t{\n\t\treturn this.cache.get('data', {});\n\t}\n\n\tload(): Promise<any>\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tconst { entityTypeId, entityId, fieldListEditorOptions } = this.getOptions();\n\n\t\t\tconst presetId = fieldListEditorOptions?.fieldsPanelOptions?.presetId ?? null;\n\n\t\t\tBX.ajax\n\t\t\t\t.runAction(this.endpoint, { json: { entityTypeId, entityId, presetId } })\n\t\t\t\t.then((result) => {\n\t\t\t\t\tresolve(result.data);\n\t\t\t\t})\n\t\t\t\t.catch((result) => {\n\t\t\t\t\treject(result.errors);\n\t\t\t\t});\n\t\t});\n\t}\n\n\tsetOptions(options: FieldsetViewerOptions)\n\t{\n\t\tthis.cache.set('options', {...options});\n\t}\n\n\tgetOptions(): FieldsetViewerOptions\n\t{\n\t\treturn this.cache.get('options');\n\t}\n\n\tgetPopup(): Popup\n\t{\n\t\treturn this.cache.remember('popup', () => {\n\t\t\tconst options = this.getOptions();\n\t\t\treturn new Popup({\n\t\t\t\tbindElement: options.bindElement,\n\t\t\t\tautoHide: false,\n\t\t\t\twidth: 570,\n\t\t\t\theight: 478,\n\t\t\t\tclassName: 'crm-requisite-fieldset-viewer',\n\t\t\t\tnoAllPaddings: true,\n\t\t\t\t...(Type.isPlainObject(options?.popupOptions) ? options?.popupOptions : {}),\n\t\t\t\tevents: {\n\t\t\t\t\tonClose: () => {\n\t\t\t\t\t\tthis.emit('onClose', {changed: this.getIsChanged()});\n\t\t\t\t\t\tthis.setIsChanged(false);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t});\n\t\t});\n\t}\n\n\tsetIsChanged(value: boolean)\n\t{\n\t\tthis.cache.set('isChanged', Text.toBoolean(value));\n\t}\n\n\tgetIsChanged(): boolean\n\t{\n\t\treturn this.cache.get('isChanged', false);\n\t}\n\n\tgetLoader(): Loader\n\t{\n\t\treturn this.cache.remember('loader', () => {\n\t\t\treturn new Loader();\n\t\t});\n\t}\n\n\tshow()\n\t{\n\t\tconst popup: Popup = this.getPopup();\n\t\tDom.clean(popup.getContentContainer());\n\t\tvoid this.getLoader().show(popup.getContentContainer());\n\n\t\tthis.load()\n\t\t\t.then((result) => {\n\t\t\t\tthis.setData({ ...result });\n\t\t\t\tpopup.setContent(\n\t\t\t\t\tthis.createPopupContent(result),\n\t\t\t\t);\n\t\t\t})\n\t\t\t.catch((errors: Array<RequestError>) => {\n\t\t\t\tthis.emit('onFieldSetLoadError', { requestErrors: errors });\n\t\t\t});\n\n\t\tpopup.show();\n\t}\n\n\thide()\n\t{\n\t\tthis.getPopup().close();\n\t}\n\n\tonBindElementClick(event: MouseEvent)\n\t{\n\t\tevent.preventDefault();\n\t\tthis.show();\n\t}\n\n\tcreatePopupContent(data): HTMLDivElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"crm-requisite-fieldset-viewer-content\">\n\t\t\t\t${this.createBannerLayout(data)}\n\t\t\t\t${this.createListLayout(data)}\n\t\t\t\t${this.getFooterLayout()}\n\t\t\t\t${this.createCloseButton()}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tcreateBannerLayout(data): HTMLDivElement\n\t{\n\t\tconst title = (\n\t\t\tLoc\n\t\t\t\t.getMessage('CRM_REQUISITE_FIELDSET_VIEWER_BANNER_TITLE')\n\t\t\t\t.replace('{{requisite}}', ` <strong>${Text.encode(data?.title)}</strong>`)\n\t\t);\n\n\t\tconst description = (() => {\n\t\t\tlet text = Loc.getMessage('CRM_REQUISITE_FIELDSET_VIEWER_BANNER_DESCRIPTION');\n\t\t\tif (Type.isStringFilled(data?.more))\n\t\t\t{\n\t\t\t\ttext += ` <a class=\"ui-link\" href=\"${Text.encode(data?.more)}\">\n\t\t\t\t\t\t${Loc.getMessage('CRM_REQUISITE_FIELDSET_VIEWER_BANNER_MORE_LINK_LABEL')}\n\t\t\t\t\t</a>`;\n\t\t\t}\n\n\t\t\treturn text;\n\t\t})();\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"crm-requisite-fieldset-viewer-banner\">\n\t\t\t\t<div class=\"crm-requisite-fieldset-viewer-banner-text\">\n\t\t\t\t\t<div class=\"crm-requisite-fieldset-viewer-banner-text-title\">\n\t\t\t\t\t\t${title}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"crm-requisite-fieldset-viewer-banner-text-description\">\n\t\t\t\t\t\t${description}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tcreateListLayout(data): HTMLDivElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"crm-requisite-fieldset-viewer-list\">\n\t\t\t\t${this.createListContainer(data.fields)}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tcreateListContainer(fields): HTMLDivElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"crm-requisite-fieldset-viewer-list-container\">\n\t\t\t\t${fields.map((options) => {\n\t\t\t\t\treturn this.createListItem(options);\t\n\t\t\t\t})}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tcreateListItem(options: {[key: string]: any}): HTMLDivElement\n\t{\n\t\tconst editButton = (() => {\n\t\t\tif (Type.isStringFilled(options?.editing?.url))\n\t\t\t{\n\t\t\t\tconst onEditButtonClick = () => {\n\t\t\t\t\tBX.SidePanel.Instance.open(\n\t\t\t\t\t\toptions?.editing?.url,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcacheable: false,\n\t\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\t\tonClose: () => {\n\t\t\t\t\t\t\t\t\tthis.show();\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t);\n\n\t\t\t\t\tthis.setIsChanged(true);\n\t\t\t\t};\n\n\t\t\t\treturn Tag.render`\n\t\t\t\t\t<span \n\t\t\t\t\t\tclass=\"ui-btn ui-btn-link\" \n\t\t\t\t\t\tonclick=\"${onEditButtonClick}\">\n\t\t\t\t\t\t\t${Loc.getMessage('CRM_REQUISITE_FIELDSET_VIEWER_LIST_ITEM_VALUE_LINK_LABEL')}\n\t\t\t\t\t</span>\n\t\t\t\t`;\n\t\t\t}\n\n\t\t\treturn '';\n\t\t})();\n\n\t\tconst value = Type.isObject(options?.value) ? Object.values(options?.value)?.reduce((a, b) => {\n\t\t\treturn `${a}, ${b}`;\n\t\t}) : options?.value;\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"crm-requisite-fieldset-viewer-list-item\">\n\t\t\t\t<div class=\"crm-requisite-fieldset-viewer-list-item-left\">\n\t\t\t\t\t<div class=\"crm-requisite-fieldset-viewer-list-item-label\">${Text.encode(options?.label)}</div>\n\t\t\t\t\t<div class=\"crm-requisite-fieldset-viewer-list-item-value\">${Text.encode(value)}</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"crm-requisite-fieldset-viewer-list-item-right\">\n\t\t\t\t\t${editButton}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tcreateCloseButton(): HTMLDivElement\n\t{\n\t\treturn this.cache.remember('closeButton', () => {\n\t\t\tconst onCloseClick = () => {\n\t\t\t\tthis.hide();\n\t\t\t};\n\n\t\t\treturn Tag.render`\n\t\t\t\t<div \n\t\t\t\t\tclass=\"crm-requisite-fieldset-viewer-close-button\"\n\t\t\t\t\tonclick=\"${onCloseClick}\"\n\t\t\t\t></div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetFieldListEditor(): ListEditor\n\t{\n\t\treturn this.cache.remember('fieldListEditor', () => {\n\t\t\tconst options: FieldsetViewerOptions = this.getOptions();\n\t\t\treturn new ListEditor({\n\t\t\t\tsetId: this.getData().id,\n\t\t\t\ttitle: Loc.getMessage('CRM_REQUISITE_FIELDSET_VIEWER__SET_EDITOR_TITLE_MSGVER_1'),\n\t\t\t\teditable: {\n\t\t\t\t\tlabel: {\n\t\t\t\t\t\tlabel: Loc.getMessage('CRM_REQUISITE_FIELDSET_VIEWER__SET_EDITOR_NAME_LABEL'),\n\t\t\t\t\t\ttype: 'string',\n\t\t\t\t\t},\n\t\t\t\t\trequired: {\n\t\t\t\t\t\tlabel: Loc.getMessage('CRM_REQUISITE_FIELDSET_VIEWER__SET_EDITOR_REQUIRED_LABEL'),\n\t\t\t\t\t\ttype: 'checkbox',\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tautoSave: false,\n\t\t\t\tcacheable: false,\n\t\t\t\tevents: {\n\t\t\t\t\tonSave: () => this.show(),\n\t\t\t\t},\n\t\t\t\tfieldsPanelOptions: {\n\t\t\t\t\thideVirtual: 1,\n\t\t\t\t\t...(Type.isPlainObject(options.fieldsPanelOptions) ? options.fieldsPanelOptions : {}),\n\t\t\t\t},\n\t\t\t\t...(Type.isPlainObject(options.fieldListEditorOptions) ? options.fieldListEditorOptions : {}),\n\t\t\t});\n\t\t});\n\t}\n\n\tgetEditButton(): Button\n\t{\n\t\treturn this.cache.remember('editButton', () => {\n\t\t\treturn new Button({\n\t\t\t\ttext: Loc.getMessage('CRM_REQUISITE_FIELDSET_VIEWER_EDIT_BUTTON_LABEL_MSGVER_1'),\n\t\t\t\tcolor: Button.Color.LIGHT_BORDER,\n\t\t\t\ticon: Button.Icon.EDIT,\n\t\t\t\tsize: Button.Size.SMALL,\n\t\t\t\tround: true,\n\t\t\t\tevents: {\n\t\t\t\t\tclick: this.onEditButtonClick.bind(this),\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n\n\tonEditButtonClick()\n\t{\n\t\tthis.getFieldListEditor().showSlider();\n\t\tthis.setIsChanged(true);\n\t}\n\n\tgetFooterLayout(): HTMLDivElement\n\t{\n\t\treturn this.cache.remember('footerLayout', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"crm-requisite-fieldset-viewer-footer\">\n\t\t\t\t\t${this.getEditButton().render()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n}"],"names":["FieldsetViewer","EventEmitter","constructor","options","cache","Cache","MemoryCache","endpoint","setEventNamespace","subscribeFromOptions","events","setOptions","Event","bind","bindElement","onBindElementClick","setData","data","set","setEndpoint","getData","get","load","Promise","resolve","reject","entityTypeId","entityId","fieldListEditorOptions","getOptions","presetId","fieldsPanelOptions","BX","ajax","runAction","json","then","result","catch","errors","getPopup","remember","Popup","autoHide","width","height","className","noAllPaddings","Type","isPlainObject","popupOptions","onClose","emit","changed","getIsChanged","setIsChanged","value","Text","toBoolean","getLoader","Loader","show","popup","Dom","clean","getContentContainer","setContent","createPopupContent","requestErrors","hide","close","event","preventDefault","Tag","render","createBannerLayout","createListLayout","getFooterLayout","createCloseButton","title","Loc","getMessage","replace","encode","description","text","isStringFilled","more","createListContainer","fields","map","createListItem","editButton","editing","url","onEditButtonClick","SidePanel","Instance","open","cacheable","isObject","Object","values","reduce","a","b","label","onCloseClick","getFieldListEditor","ListEditor","setId","id","editable","type","required","autoSave","onSave","hideVirtual","getEditButton","Button","color","Color","LIGHT_BORDER","icon","Icon","EDIT","size","Size","SMALL","round","click","showSlider"],"mappings":"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"}