{"version":3,"file":"fieldset-viewer.bundle.js","sources":["../src/fieldset-viewer.js"],"sourcesContent":["import {Cache, Type, Event, Tag, Loc, Text, Dom} from 'main.core';\nimport {EventEmitter, BaseEvent} from 'main.core.events';\nimport {Popup} from 'main.popup';\nimport {Loader} from 'main.loader';\nimport {Button} from 'ui.buttons';\nimport {ListEditor} from 'crm.field.list-editor';\n\nimport './css/style.css';\n\ntype FieldsetViewerOptions = {\n\tentityTypeId: number,\n\tentityId: number,\n\tbindElement: HTMLElement,\n\tpopupOptions?: {[key: string]: any},\n\tfieldListEditorOptions?: {[key: string]: any},\n\tevents: {\n\t\tonClose?: (BaseEvent) => void,\n\t},\n};\n\n\n/**\n * @namespace BX.Crm.Requisite\n */\nexport class FieldsetViewer extends EventEmitter\n{\n\tcache = new Cache.MemoryCache();\n\n\tconstructor(options: FieldsetViewerOptions = {})\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Crm.Requisite.FieldsetViewer');\n\t\tthis.subscribeFromOptions(options?.events || {});\n\t\tthis.setOptions(options);\n\t\tEvent.bind(options.bindElement, 'click', this.onBindElementClick.bind(this));\n\t}\n\n\tsetData(data: {[key: string]: any})\n\t{\n\t\tthis.cache.set('data', data);\n\t}\n\n\tgetData(): {[key: string]: any}\n\t{\n\t\treturn this.cache.get('data', {});\n\t}\n\n\tload(): Promise<any>\n\t{\n\t\treturn new Promise((resolve) => {\n\t\t\tconst {entityTypeId, entityId} = this.getOptions();\n\n\t\t\tBX.ajax\n\t\t\t\t.runAction('crm.api.fieldset.load', {json: {entityTypeId, entityId}})\n\t\t\t\t.then((result) => {\n\t\t\t\t\tresolve(result.data);\n\t\t\t\t});\n\t\t});\n\t}\n\n\tsetOptions(options: FieldsetViewerOptions)\n\t{\n\t\tthis.cache.set('options', {...options});\n\t}\n\n\tgetOptions(): FieldsetViewerOptions\n\t{\n\t\treturn this.cache.get('options');\n\t}\n\n\tgetPopup(): Popup\n\t{\n\t\treturn this.cache.remember('popup', () => {\n\t\t\tconst options = this.getOptions();\n\t\t\treturn new Popup({\n\t\t\t\tbindElement: options.bindElement,\n\t\t\t\tautoHide: false,\n\t\t\t\twidth: 570,\n\t\t\t\theight: 478,\n\t\t\t\tclassName: 'crm-requisite-fieldset-viewer',\n\t\t\t\tnoAllPaddings: true,\n\t\t\t\t...(Type.isPlainObject(options?.popupOptions) ? options?.popupOptions : {}),\n\t\t\t\tevents: {\n\t\t\t\t\tonClose: () => {\n\t\t\t\t\t\tthis.emit('onClose', {changed: this.getIsChanged()});\n\t\t\t\t\t\tthis.setIsChanged(false);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t});\n\t\t});\n\t}\n\n\tsetIsChanged(value: boolean)\n\t{\n\t\tthis.cache.set('isChanged', Text.toBoolean(value));\n\t}\n\n\tgetIsChanged(): boolean\n\t{\n\t\treturn this.cache.get('isChanged', false);\n\t}\n\n\tgetLoader(): Loader\n\t{\n\t\treturn this.cache.remember('loader', () => {\n\t\t\treturn new Loader();\n\t\t});\n\t}\n\n\tshow()\n\t{\n\t\tconst popup: Popup = this.getPopup();\n\t\tDom.clean(popup.getContentContainer());\n\t\tvoid this.getLoader().show(popup.getContentContainer());\n\n\t\tthis.load().then((result) => {\n\t\t\tthis.setData({...result});\n\t\t\tpopup.setContent(\n\t\t\t\tthis.createPopupContent(result),\n\t\t\t);\n\t\t});\n\n\t\tpopup.show();\n\t}\n\n\thide()\n\t{\n\t\tthis.getPopup().close();\n\t}\n\n\tonBindElementClick(event: MouseEvent)\n\t{\n\t\tevent.preventDefault();\n\t\tthis.show();\n\t}\n\n\tcreatePopupContent(data): HTMLDivElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"crm-requisite-fieldset-viewer-content\">\n\t\t\t\t${this.createBannerLayout(data)}\n\t\t\t\t${this.createListLayout(data)}\n\t\t\t\t${this.getFooterLayout()}\n\t\t\t\t${this.createCloseButton()}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tcreateBannerLayout(data): HTMLDivElement\n\t{\n\t\tconst title = (\n\t\t\tLoc\n\t\t\t\t.getMessage('CRM_REQUISITE_FIELDSET_VIEWER_BANNER_TITLE')\n\t\t\t\t.replace('{{requisite}}', ` <strong>${data?.title}</strong>`)\n\t\t);\n\n\t\tconst description = (() => {\n\t\t\tlet text = Loc.getMessage('CRM_REQUISITE_FIELDSET_VIEWER_BANNER_DESCRIPTION');\n\t\t\tif (Type.isStringFilled(data?.more))\n\t\t\t{\n\t\t\t\ttext += ` <a class=\"ui-link\" href=\"${Text.encode(data?.more)}\">\n\t\t\t\t\t\t${Loc.getMessage('CRM_REQUISITE_FIELDSET_VIEWER_BANNER_MORE_LINK_LABEL')}\n\t\t\t\t\t</a>`;\n\t\t\t}\n\n\t\t\treturn text;\n\t\t})();\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"crm-requisite-fieldset-viewer-banner\">\n\t\t\t\t<div class=\"crm-requisite-fieldset-viewer-banner-text\">\n\t\t\t\t\t<div class=\"crm-requisite-fieldset-viewer-banner-text-title\">\n\t\t\t\t\t\t${title}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"crm-requisite-fieldset-viewer-banner-text-description\">\n\t\t\t\t\t\t${description}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tcreateListLayout(data): HTMLDivElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"crm-requisite-fieldset-viewer-list\">\n\t\t\t\t${this.createListContainer(data.fields)}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tcreateListContainer(fields): HTMLDivElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"crm-requisite-fieldset-viewer-list-container\">\n\t\t\t\t${fields.map((options) => {\n\t\t\t\t\treturn this.createListItem(options);\t\n\t\t\t\t})}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tcreateListItem(options: {[key: string]: any}): HTMLDivElement\n\t{\n\t\tconst editButton = (() => {\n\t\t\tif (Type.isStringFilled(options?.editing?.url))\n\t\t\t{\n\t\t\t\tconst onEditButtonClick = () => {\n\t\t\t\t\tBX.SidePanel.Instance.open(\n\t\t\t\t\t\toptions?.editing?.url,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\t\tonClose: () => {\n\t\t\t\t\t\t\t\t\tthis.show();\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t);\n\n\t\t\t\t\tthis.setIsChanged(true);\n\t\t\t\t};\n\n\t\t\t\treturn Tag.render`\n\t\t\t\t\t<span \n\t\t\t\t\t\tclass=\"ui-btn ui-btn-link\" \n\t\t\t\t\t\tonclick=\"${onEditButtonClick}\">\n\t\t\t\t\t\t\t${Loc.getMessage('CRM_REQUISITE_FIELDSET_VIEWER_LIST_ITEM_VALUE_LINK_LABEL')}\n\t\t\t\t\t</span>\n\t\t\t\t`;\n\t\t\t}\n\n\t\t\treturn '';\n\t\t})();\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"crm-requisite-fieldset-viewer-list-item\">\n\t\t\t\t<div class=\"crm-requisite-fieldset-viewer-list-item-left\">\n\t\t\t\t\t<div class=\"crm-requisite-fieldset-viewer-list-item-label\">${Text.encode(options?.label)}</div>\n\t\t\t\t\t<div class=\"crm-requisite-fieldset-viewer-list-item-value\">${Text.encode(options?.value)}</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"crm-requisite-fieldset-viewer-list-item-right\">\n\t\t\t\t\t${editButton}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tcreateCloseButton(): HTMLDivElement\n\t{\n\t\treturn this.cache.remember('closeButton', () => {\n\t\t\tconst onCloseClick = () => {\n\t\t\t\tthis.hide();\n\t\t\t};\n\n\t\t\treturn Tag.render`\n\t\t\t\t<div \n\t\t\t\t\tclass=\"crm-requisite-fieldset-viewer-close-button\"\n\t\t\t\t\tonclick=\"${onCloseClick}\"\n\t\t\t\t></div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetFieldListEditor(): ListEditor\n\t{\n\t\treturn this.cache.remember('fieldListEditor', () => {\n\t\t\tconst options: FieldsetViewerOptions = this.getOptions();\n\t\t\treturn new ListEditor({\n\t\t\t\tsetId: this.getData().id,\n\t\t\t\ttitle: Loc.getMessage('CRM_REQUISITE_FIELDSET_VIEWER__SET_EDITOR_TITLE'),\n\t\t\t\teditable: {\n\t\t\t\t\tlabel: {\n\t\t\t\t\t\tlabel: Loc.getMessage('CRM_REQUISITE_FIELDSET_VIEWER__SET_EDITOR_NAME_LABEL'),\n\t\t\t\t\t\ttype: 'string',\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tautoSave: false,\n\t\t\t\tevents: {\n\t\t\t\t\tonSave: () => this.show(),\n\t\t\t\t},\n\t\t\t\t...(Type.isPlainObject(options.fieldListEditorOptions) ? options.fieldListEditorOptions : {}),\n\t\t\t});\n\t\t});\n\t}\n\n\tgetEditButton(): Button\n\t{\n\t\treturn this.cache.remember('editButton', () => {\n\t\t\treturn new Button({\n\t\t\t\ttext: Loc.getMessage('CRM_REQUISITE_FIELDSET_VIEWER_EDIT_BUTTON_LABEL'),\n\t\t\t\tcolor: Button.Color.LIGHT_BORDER,\n\t\t\t\ticon: Button.Icon.EDIT,\n\t\t\t\tsize: Button.Size.SMALL,\n\t\t\t\tround: true,\n\t\t\t\tevents: {\n\t\t\t\t\tclick: this.onEditButtonClick.bind(this),\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n\n\tonEditButtonClick()\n\t{\n\t\tthis.getFieldListEditor().showSlider();\n\t\tthis.setIsChanged(true);\n\t}\n\n\tgetFooterLayout(): HTMLDivElement\n\t{\n\t\treturn this.cache.remember('footerLayout', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"crm-requisite-fieldset-viewer-footer\">\n\t\t\t\t\t${this.getEditButton().render()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n}"],"names":["FieldsetViewer","options","Cache","MemoryCache","setEventNamespace","subscribeFromOptions","events","setOptions","Event","bind","bindElement","onBindElementClick","data","cache","set","get","Promise","resolve","getOptions","entityTypeId","entityId","BX","ajax","runAction","json","then","result","remember","Popup","autoHide","width","height","className","noAllPaddings","Type","isPlainObject","popupOptions","onClose","emit","changed","getIsChanged","setIsChanged","value","Text","toBoolean","Loader","popup","getPopup","Dom","clean","getContentContainer","getLoader","show","load","setData","setContent","createPopupContent","close","event","preventDefault","Tag","render","createBannerLayout","createListLayout","getFooterLayout","createCloseButton","title","Loc","getMessage","replace","description","text","isStringFilled","more","encode","createListContainer","fields","map","createListItem","editButton","editing","url","onEditButtonClick","SidePanel","Instance","open","label","onCloseClick","hide","ListEditor","setId","getData","id","editable","type","autoSave","onSave","fieldListEditorOptions","Button","color","Color","LIGHT_BORDER","icon","Icon","EDIT","size","Size","SMALL","round","click","getFieldListEditor","showSlider","getEditButton","EventEmitter"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;CAqBA;;;AAGA,KAAaA,cAAb;CAAA;;CAIC,4BACA;CAAA;;CAAA,QADYC,OACZ,uEAD6C,EAC7C;CAAA;CACC;CADD,oFAHQ,IAAIC,eAAK,CAACC,WAAV,EAGR;;CAEC,UAAKC,iBAAL,CAAuB,iCAAvB;;CACA,UAAKC,oBAAL,CAA0B,CAAAJ,OAAO,SAAP,IAAAA,OAAO,WAAP,YAAAA,OAAO,CAAEK,MAAT,KAAmB,EAA7C;;CACA,UAAKC,UAAL,CAAgBN,OAAhB;;CACAO,IAAAA,eAAK,CAACC,IAAN,CAAWR,OAAO,CAACS,WAAnB,EAAgC,OAAhC,EAAyC,MAAKC,kBAAL,CAAwBF,IAAxB,2CAAzC;CALD;CAMC;;CAXF;CAAA;CAAA,4BAaSG,IAbT,EAcC;CACC,WAAKC,KAAL,CAAWC,GAAX,CAAe,MAAf,EAAuBF,IAAvB;CACA;CAhBF;CAAA;CAAA,8BAmBC;CACC,aAAO,KAAKC,KAAL,CAAWE,GAAX,CAAe,MAAf,EAAuB,EAAvB,CAAP;CACA;CArBF;CAAA;CAAA,2BAwBC;CAAA;;CACC,aAAO,IAAIC,OAAJ,CAAY,UAACC,OAAD,EAAa;CAAA,gCACE,MAAI,CAACC,UAAL,EADF;CAAA,YACxBC,YADwB,qBACxBA,YADwB;CAAA,YACVC,QADU,qBACVA,QADU;;CAG/BC,QAAAA,EAAE,CAACC,IAAH,CACEC,SADF,CACY,uBADZ,EACqC;CAACC,UAAAA,IAAI,EAAE;CAACL,YAAAA,YAAY,EAAZA,YAAD;CAAeC,YAAAA,QAAQ,EAARA;CAAf;CAAP,SADrC,EAEEK,IAFF,CAEO,UAACC,MAAD,EAAY;CACjBT,UAAAA,OAAO,CAACS,MAAM,CAACd,IAAR,CAAP;CACA,SAJF;CAKA,OARM,CAAP;CASA;CAlCF;CAAA;CAAA,+BAoCYX,OApCZ,EAqCC;CACC,WAAKY,KAAL,CAAWC,GAAX,CAAe,SAAf,gCAA8Bb,OAA9B;CACA;CAvCF;CAAA;CAAA,iCA0CC;CACC,aAAO,KAAKY,KAAL,CAAWE,GAAX,CAAe,SAAf,CAAP;CACA;CA5CF;CAAA;CAAA,+BA+CC;CAAA;;CACC,aAAO,KAAKF,KAAL,CAAWc,QAAX,CAAoB,OAApB,EAA6B,YAAM;CACzC,YAAM1B,OAAO,GAAG,MAAI,CAACiB,UAAL,EAAhB;;CACA,eAAO,IAAIU,gBAAJ;CACNlB,UAAAA,WAAW,EAAET,OAAO,CAACS,WADf;CAENmB,UAAAA,QAAQ,EAAE,KAFJ;CAGNC,UAAAA,KAAK,EAAE,GAHD;CAINC,UAAAA,MAAM,EAAE,GAJF;CAKNC,UAAAA,SAAS,EAAE,+BALL;CAMNC,UAAAA,aAAa,EAAE;CANT,WAOFC,cAAI,CAACC,aAAL,CAAmBlC,OAAnB,aAAmBA,OAAnB,uBAAmBA,OAAO,CAAEmC,YAA5B,IAA4CnC,OAA5C,aAA4CA,OAA5C,uBAA4CA,OAAO,CAAEmC,YAArD,GAAoE,EAPlE;CAQN9B,UAAAA,MAAM,EAAE;CACP+B,YAAAA,OAAO,EAAE,mBAAM;CACd,cAAA,MAAI,CAACC,IAAL,CAAU,SAAV,EAAqB;CAACC,gBAAAA,OAAO,EAAE,MAAI,CAACC,YAAL;CAAV,eAArB;;CACA,cAAA,MAAI,CAACC,YAAL,CAAkB,KAAlB;CACA;CAJM;CARF,WAAP;CAeA,OAjBM,CAAP;CAkBA;CAlEF;CAAA;CAAA,iCAoEcC,KApEd,EAqEC;CACC,WAAK7B,KAAL,CAAWC,GAAX,CAAe,WAAf,EAA4B6B,cAAI,CAACC,SAAL,CAAeF,KAAf,CAA5B;CACA;CAvEF;CAAA;CAAA,mCA0EC;CACC,aAAO,KAAK7B,KAAL,CAAWE,GAAX,CAAe,WAAf,EAA4B,KAA5B,CAAP;CACA;CA5EF;CAAA;CAAA,gCA+EC;CACC,aAAO,KAAKF,KAAL,CAAWc,QAAX,CAAoB,QAApB,EAA8B,YAAM;CAC1C,eAAO,IAAIkB,kBAAJ,EAAP;CACA,OAFM,CAAP;CAGA;CAnFF;CAAA;CAAA,2BAsFC;CAAA;;CACC,UAAMC,KAAY,GAAG,KAAKC,QAAL,EAArB;CACAC,MAAAA,aAAG,CAACC,KAAJ,CAAUH,KAAK,CAACI,mBAAN,EAAV;CACA,WAAK,KAAKC,SAAL,GAAiBC,IAAjB,CAAsBN,KAAK,CAACI,mBAAN,EAAtB,CAAL;CAEA,WAAKG,IAAL,GAAY5B,IAAZ,CAAiB,UAACC,MAAD,EAAY;CAC5B,QAAA,MAAI,CAAC4B,OAAL,+BAAiB5B,MAAjB;;CACAoB,QAAAA,KAAK,CAACS,UAAN,CACC,MAAI,CAACC,kBAAL,CAAwB9B,MAAxB,CADD;CAGA,OALD;CAOAoB,MAAAA,KAAK,CAACM,IAAN;CACA;CAnGF;CAAA;CAAA,2BAsGC;CACC,WAAKL,QAAL,GAAgBU,KAAhB;CACA;CAxGF;CAAA;CAAA,uCA0GoBC,KA1GpB,EA2GC;CACCA,MAAAA,KAAK,CAACC,cAAN;CACA,WAAKP,IAAL;CACA;CA9GF;CAAA;CAAA,uCAgHoBxC,IAhHpB,EAiHC;CACC,aAAOgD,aAAG,CAACC,MAAX,oBAEI,KAAKC,kBAAL,CAAwBlD,IAAxB,CAFJ,EAGI,KAAKmD,gBAAL,CAAsBnD,IAAtB,CAHJ,EAII,KAAKoD,eAAL,EAJJ,EAKI,KAAKC,iBAAL,EALJ;CAQA;CA1HF;CAAA;CAAA,uCA4HoBrD,IA5HpB,EA6HC;CACC,UAAMsD,KAAK,GACVC,aAAG,CACDC,UADF,CACa,4CADb,EAEEC,OAFF,CAEU,eAFV,qBAEuCzD,IAFvC,aAEuCA,IAFvC,uBAEuCA,IAAI,CAAEsD,KAF7C,eADD;;CAMA,UAAMI,WAAW,GAAI,YAAM;CAC1B,YAAIC,IAAI,GAAGJ,aAAG,CAACC,UAAJ,CAAe,kDAAf,CAAX;;CACA,YAAIlC,cAAI,CAACsC,cAAL,CAAoB5D,IAApB,aAAoBA,IAApB,uBAAoBA,IAAI,CAAE6D,IAA1B,CAAJ,EACA;CACCF,UAAAA,IAAI,2CAAiC5B,cAAI,CAAC+B,MAAL,CAAY9D,IAAZ,aAAYA,IAAZ,uBAAYA,IAAI,CAAE6D,IAAlB,CAAjC,8BACAN,aAAG,CAACC,UAAJ,CAAe,sDAAf,CADA,qBAAJ;CAGA;;CAED,eAAOG,IAAP;CACA,OAVmB,EAApB;;CAYA,aAAOX,aAAG,CAACC,MAAX,qBAIMK,KAJN,EAOMI,WAPN;CAYA;CA5JF;CAAA;CAAA,qCA8JkB1D,IA9JlB,EA+JC;CACC,aAAOgD,aAAG,CAACC,MAAX,qBAEI,KAAKc,mBAAL,CAAyB/D,IAAI,CAACgE,MAA9B,CAFJ;CAKA;CArKF;CAAA;CAAA,wCAuKqBA,MAvKrB,EAwKC;CAAA;;CACC,aAAOhB,aAAG,CAACC,MAAX,qBAEIe,MAAM,CAACC,GAAP,CAAW,UAAC5E,OAAD,EAAa;CACzB,eAAO,MAAI,CAAC6E,cAAL,CAAoB7E,OAApB,CAAP;CACA,OAFC,CAFJ;CAOA;CAhLF;CAAA;CAAA,mCAkLgBA,OAlLhB,EAmLC;CAAA;;CACC,UAAM8E,UAAU,GAAI,YAAM;CAAA;;CACzB,YAAI7C,cAAI,CAACsC,cAAL,CAAoBvE,OAApB,aAAoBA,OAApB,2CAAoBA,OAAO,CAAE+E,OAA7B,qDAAoB,iBAAkBC,GAAtC,CAAJ,EACA;CACC,cAAMC,iBAAiB,GAAG,SAApBA,iBAAoB,GAAM;CAAA;;CAC/B7D,YAAAA,EAAE,CAAC8D,SAAH,CAAaC,QAAb,CAAsBC,IAAtB,CACCpF,OADD,aACCA,OADD,4CACCA,OAAO,CAAE+E,OADV,sDACC,kBAAkBC,GADnB,EAEC;CACC3E,cAAAA,MAAM,EAAE;CACP+B,gBAAAA,OAAO,EAAE,mBAAM;CACd,kBAAA,MAAI,CAACe,IAAL;CACA;CAHM;CADT,aAFD;;CAWA,YAAA,MAAI,CAACX,YAAL,CAAkB,IAAlB;CACA,WAbD;;CAeA,iBAAOmB,aAAG,CAACC,MAAX,qBAGaqB,iBAHb,EAIKf,aAAG,CAACC,UAAJ,CAAe,0DAAf,CAJL;CAOA;;CAED,eAAO,EAAP;CACA,OA5BkB,EAAnB;;CA8BA,aAAOR,aAAG,CAACC,MAAX,qBAGgElB,cAAI,CAAC+B,MAAL,CAAYzE,OAAZ,aAAYA,OAAZ,uBAAYA,OAAO,CAAEqF,KAArB,CAHhE,EAIgE3C,cAAI,CAAC+B,MAAL,CAAYzE,OAAZ,aAAYA,OAAZ,uBAAYA,OAAO,CAAEyC,KAArB,CAJhE,EAOKqC,UAPL;CAWA;CA7NF;CAAA;CAAA,wCAgOC;CAAA;;CACC,aAAO,KAAKlE,KAAL,CAAWc,QAAX,CAAoB,aAApB,EAAmC,YAAM;CAC/C,YAAM4D,YAAY,GAAG,SAAfA,YAAe,GAAM;CAC1B,UAAA,MAAI,CAACC,IAAL;CACA,SAFD;;CAIA,eAAO5B,aAAG,CAACC,MAAX,qBAGa0B,YAHb;CAMA,OAXM,CAAP;CAYA;CA7OF;CAAA;CAAA,yCAgPC;CAAA;;CACC,aAAO,KAAK1E,KAAL,CAAWc,QAAX,CAAoB,iBAApB,EAAuC,YAAM;CACnD,YAAM1B,OAA8B,GAAG,MAAI,CAACiB,UAAL,EAAvC;;CACA,eAAO,IAAIuE,+BAAJ;CACNC,UAAAA,KAAK,EAAE,MAAI,CAACC,OAAL,GAAeC,EADhB;CAEN1B,UAAAA,KAAK,EAAEC,aAAG,CAACC,UAAJ,CAAe,iDAAf,CAFD;CAGNyB,UAAAA,QAAQ,EAAE;CACTP,YAAAA,KAAK,EAAE;CACNA,cAAAA,KAAK,EAAEnB,aAAG,CAACC,UAAJ,CAAe,sDAAf,CADD;CAEN0B,cAAAA,IAAI,EAAE;CAFA;CADE,WAHJ;CASNC,UAAAA,QAAQ,EAAE,KATJ;CAUNzF,UAAAA,MAAM,EAAE;CACP0F,YAAAA,MAAM,EAAE;CAAA,qBAAM,MAAI,CAAC5C,IAAL,EAAN;CAAA;CADD;CAVF,WAaFlB,cAAI,CAACC,aAAL,CAAmBlC,OAAO,CAACgG,sBAA3B,IAAqDhG,OAAO,CAACgG,sBAA7D,GAAsF,EAbpF,EAAP;CAeA,OAjBM,CAAP;CAkBA;CAnQF;CAAA;CAAA,oCAsQC;CAAA;;CACC,aAAO,KAAKpF,KAAL,CAAWc,QAAX,CAAoB,YAApB,EAAkC,YAAM;CAC9C,eAAO,IAAIuE,iBAAJ,CAAW;CACjB3B,UAAAA,IAAI,EAAEJ,aAAG,CAACC,UAAJ,CAAe,iDAAf,CADW;CAEjB+B,UAAAA,KAAK,EAAED,iBAAM,CAACE,KAAP,CAAaC,YAFH;CAGjBC,UAAAA,IAAI,EAAEJ,iBAAM,CAACK,IAAP,CAAYC,IAHD;CAIjBC,UAAAA,IAAI,EAAEP,iBAAM,CAACQ,IAAP,CAAYC,KAJD;CAKjBC,UAAAA,KAAK,EAAE,IALU;CAMjBtG,UAAAA,MAAM,EAAE;CACPuG,YAAAA,KAAK,EAAE,MAAI,CAAC3B,iBAAL,CAAuBzE,IAAvB,CAA4B,MAA5B;CADA;CANS,SAAX,CAAP;CAUA,OAXM,CAAP;CAYA;CAnRF;CAAA;CAAA,wCAsRC;CACC,WAAKqG,kBAAL,GAA0BC,UAA1B;CACA,WAAKtE,YAAL,CAAkB,IAAlB;CACA;CAzRF;CAAA;CAAA,sCA4RC;CAAA;;CACC,aAAO,KAAK5B,KAAL,CAAWc,QAAX,CAAoB,cAApB,EAAoC,YAAM;CAChD,eAAOiC,aAAG,CAACC,MAAX,qBAEI,OAAI,CAACmD,aAAL,GAAqBnD,MAArB,EAFJ;CAKA,OANM,CAAP;CAOA;CApSF;CAAA;CAAA,EAAoCoD,6BAApC;;;;;;;;"}