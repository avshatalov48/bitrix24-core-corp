{"version":3,"file":"fieldset-viewer.bundle.js","sources":["../src/fieldset-viewer.js"],"sourcesContent":["import {Cache, Type, Event, Tag, Loc, Text, Dom} from 'main.core';\nimport {EventEmitter, BaseEvent} from 'main.core.events';\nimport {Popup} from 'main.popup';\nimport {Loader} from 'main.loader';\nimport {Button} from 'ui.buttons';\nimport {ListEditor} from 'crm.field.list-editor';\n\nimport './css/style.css';\n\ntype FieldsetViewerOptions = {\n\tentityTypeId: number,\n\tentityId: number,\n\tbindElement: HTMLElement,\n\tpopupOptions?: {[key: string]: any},\n\tfieldListEditorOptions?: {[key: string]: any},\n\tfieldsPanelOptions?: {[key: string]: any},\n\tevents: {\n\t\tonClose?: (BaseEvent) => void,\n\t},\n};\n\n\n/**\n * @namespace BX.Crm.Requisite\n */\nexport class FieldsetViewer extends EventEmitter\n{\n\tcache = new Cache.MemoryCache();\n\n\tconstructor(options: FieldsetViewerOptions = {})\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Crm.Requisite.FieldsetViewer');\n\t\tthis.subscribeFromOptions(options?.events || {});\n\t\tthis.setOptions(options);\n\t\tEvent.bind(options.bindElement, 'click', this.onBindElementClick.bind(this));\n\t}\n\n\tsetData(data: {[key: string]: any})\n\t{\n\t\tthis.cache.set('data', data);\n\t}\n\n\tgetData(): {[key: string]: any}\n\t{\n\t\treturn this.cache.get('data', {});\n\t}\n\n\tload(): Promise<any>\n\t{\n\t\treturn new Promise((resolve) => {\n\t\t\tconst {entityTypeId, entityId, fieldListEditorOptions} = this.getOptions();\n\n\t\t\tconst presetId = fieldListEditorOptions?.fieldsPanelOptions?.presetId ?? null;\n\n\t\t\tBX.ajax\n\t\t\t\t.runAction('crm.api.fieldset.load', {json: {entityTypeId, entityId, presetId}})\n\t\t\t\t.then((result) => {\n\t\t\t\t\tresolve(result.data);\n\t\t\t\t});\n\t\t});\n\t}\n\n\tsetOptions(options: FieldsetViewerOptions)\n\t{\n\t\tthis.cache.set('options', {...options});\n\t}\n\n\tgetOptions(): FieldsetViewerOptions\n\t{\n\t\treturn this.cache.get('options');\n\t}\n\n\tgetPopup(): Popup\n\t{\n\t\treturn this.cache.remember('popup', () => {\n\t\t\tconst options = this.getOptions();\n\t\t\treturn new Popup({\n\t\t\t\tbindElement: options.bindElement,\n\t\t\t\tautoHide: false,\n\t\t\t\twidth: 570,\n\t\t\t\theight: 478,\n\t\t\t\tclassName: 'crm-requisite-fieldset-viewer',\n\t\t\t\tnoAllPaddings: true,\n\t\t\t\t...(Type.isPlainObject(options?.popupOptions) ? options?.popupOptions : {}),\n\t\t\t\tevents: {\n\t\t\t\t\tonClose: () => {\n\t\t\t\t\t\tthis.emit('onClose', {changed: this.getIsChanged()});\n\t\t\t\t\t\tthis.setIsChanged(false);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t});\n\t\t});\n\t}\n\n\tsetIsChanged(value: boolean)\n\t{\n\t\tthis.cache.set('isChanged', Text.toBoolean(value));\n\t}\n\n\tgetIsChanged(): boolean\n\t{\n\t\treturn this.cache.get('isChanged', false);\n\t}\n\n\tgetLoader(): Loader\n\t{\n\t\treturn this.cache.remember('loader', () => {\n\t\t\treturn new Loader();\n\t\t});\n\t}\n\n\tshow()\n\t{\n\t\tconst popup: Popup = this.getPopup();\n\t\tDom.clean(popup.getContentContainer());\n\t\tvoid this.getLoader().show(popup.getContentContainer());\n\n\t\tthis.load().then((result) => {\n\t\t\tthis.setData({...result});\n\t\t\tpopup.setContent(\n\t\t\t\tthis.createPopupContent(result),\n\t\t\t);\n\t\t});\n\n\t\tpopup.show();\n\t}\n\n\thide()\n\t{\n\t\tthis.getPopup().close();\n\t}\n\n\tonBindElementClick(event: MouseEvent)\n\t{\n\t\tevent.preventDefault();\n\t\tthis.show();\n\t}\n\n\tcreatePopupContent(data): HTMLDivElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"crm-requisite-fieldset-viewer-content\">\n\t\t\t\t${this.createBannerLayout(data)}\n\t\t\t\t${this.createListLayout(data)}\n\t\t\t\t${this.getFooterLayout()}\n\t\t\t\t${this.createCloseButton()}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tcreateBannerLayout(data): HTMLDivElement\n\t{\n\t\tconst title = (\n\t\t\tLoc\n\t\t\t\t.getMessage('CRM_REQUISITE_FIELDSET_VIEWER_BANNER_TITLE')\n\t\t\t\t.replace('{{requisite}}', ` <strong>${Text.encode(data?.title)}</strong>`)\n\t\t);\n\n\t\tconst description = (() => {\n\t\t\tlet text = Loc.getMessage('CRM_REQUISITE_FIELDSET_VIEWER_BANNER_DESCRIPTION');\n\t\t\tif (Type.isStringFilled(data?.more))\n\t\t\t{\n\t\t\t\ttext += ` <a class=\"ui-link\" href=\"${Text.encode(data?.more)}\">\n\t\t\t\t\t\t${Loc.getMessage('CRM_REQUISITE_FIELDSET_VIEWER_BANNER_MORE_LINK_LABEL')}\n\t\t\t\t\t</a>`;\n\t\t\t}\n\n\t\t\treturn text;\n\t\t})();\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"crm-requisite-fieldset-viewer-banner\">\n\t\t\t\t<div class=\"crm-requisite-fieldset-viewer-banner-text\">\n\t\t\t\t\t<div class=\"crm-requisite-fieldset-viewer-banner-text-title\">\n\t\t\t\t\t\t${title}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"crm-requisite-fieldset-viewer-banner-text-description\">\n\t\t\t\t\t\t${description}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tcreateListLayout(data): HTMLDivElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"crm-requisite-fieldset-viewer-list\">\n\t\t\t\t${this.createListContainer(data.fields)}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tcreateListContainer(fields): HTMLDivElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"crm-requisite-fieldset-viewer-list-container\">\n\t\t\t\t${fields.map((options) => {\n\t\t\t\t\treturn this.createListItem(options);\t\n\t\t\t\t})}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tcreateListItem(options: {[key: string]: any}): HTMLDivElement\n\t{\n\t\tconst editButton = (() => {\n\t\t\tif (Type.isStringFilled(options?.editing?.url))\n\t\t\t{\n\t\t\t\tconst onEditButtonClick = () => {\n\t\t\t\t\tBX.SidePanel.Instance.open(\n\t\t\t\t\t\toptions?.editing?.url,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcacheable: false,\n\t\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\t\tonClose: () => {\n\t\t\t\t\t\t\t\t\tthis.show();\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t);\n\n\t\t\t\t\tthis.setIsChanged(true);\n\t\t\t\t};\n\n\t\t\t\treturn Tag.render`\n\t\t\t\t\t<span \n\t\t\t\t\t\tclass=\"ui-btn ui-btn-link\" \n\t\t\t\t\t\tonclick=\"${onEditButtonClick}\">\n\t\t\t\t\t\t\t${Loc.getMessage('CRM_REQUISITE_FIELDSET_VIEWER_LIST_ITEM_VALUE_LINK_LABEL')}\n\t\t\t\t\t</span>\n\t\t\t\t`;\n\t\t\t}\n\n\t\t\treturn '';\n\t\t})();\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"crm-requisite-fieldset-viewer-list-item\">\n\t\t\t\t<div class=\"crm-requisite-fieldset-viewer-list-item-left\">\n\t\t\t\t\t<div class=\"crm-requisite-fieldset-viewer-list-item-label\">${Text.encode(options?.label)}</div>\n\t\t\t\t\t<div class=\"crm-requisite-fieldset-viewer-list-item-value\">${Text.encode(options?.value)}</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"crm-requisite-fieldset-viewer-list-item-right\">\n\t\t\t\t\t${editButton}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tcreateCloseButton(): HTMLDivElement\n\t{\n\t\treturn this.cache.remember('closeButton', () => {\n\t\t\tconst onCloseClick = () => {\n\t\t\t\tthis.hide();\n\t\t\t};\n\n\t\t\treturn Tag.render`\n\t\t\t\t<div \n\t\t\t\t\tclass=\"crm-requisite-fieldset-viewer-close-button\"\n\t\t\t\t\tonclick=\"${onCloseClick}\"\n\t\t\t\t></div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetFieldListEditor(): ListEditor\n\t{\n\t\treturn this.cache.remember('fieldListEditor', () => {\n\t\t\tconst options: FieldsetViewerOptions = this.getOptions();\n\t\t\treturn new ListEditor({\n\t\t\t\tsetId: this.getData().id,\n\t\t\t\ttitle: Loc.getMessage('CRM_REQUISITE_FIELDSET_VIEWER__SET_EDITOR_TITLE_MSGVER_1'),\n\t\t\t\teditable: {\n\t\t\t\t\tlabel: {\n\t\t\t\t\t\tlabel: Loc.getMessage('CRM_REQUISITE_FIELDSET_VIEWER__SET_EDITOR_NAME_LABEL'),\n\t\t\t\t\t\ttype: 'string',\n\t\t\t\t\t},\n\t\t\t\t\trequired: {\n\t\t\t\t\t\tlabel: Loc.getMessage('CRM_REQUISITE_FIELDSET_VIEWER__SET_EDITOR_REQUIRED_LABEL'),\n\t\t\t\t\t\ttype: 'checkbox',\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tautoSave: false,\n\t\t\t\tcacheable: false,\n\t\t\t\tevents: {\n\t\t\t\t\tonSave: () => this.show(),\n\t\t\t\t},\n\t\t\t\tfieldsPanelOptions: {\n\t\t\t\t\thideVirtual: 1,\n\t\t\t\t\t...(Type.isPlainObject(options.fieldsPanelOptions) ? options.fieldsPanelOptions : {}),\n\t\t\t\t},\n\t\t\t\t...(Type.isPlainObject(options.fieldListEditorOptions) ? options.fieldListEditorOptions : {}),\n\t\t\t});\n\t\t});\n\t}\n\n\tgetEditButton(): Button\n\t{\n\t\treturn this.cache.remember('editButton', () => {\n\t\t\treturn new Button({\n\t\t\t\ttext: Loc.getMessage('CRM_REQUISITE_FIELDSET_VIEWER_EDIT_BUTTON_LABEL_MSGVER_1'),\n\t\t\t\tcolor: Button.Color.LIGHT_BORDER,\n\t\t\t\ticon: Button.Icon.EDIT,\n\t\t\t\tsize: Button.Size.SMALL,\n\t\t\t\tround: true,\n\t\t\t\tevents: {\n\t\t\t\t\tclick: this.onEditButtonClick.bind(this),\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n\n\tonEditButtonClick()\n\t{\n\t\tthis.getFieldListEditor().showSlider();\n\t\tthis.setIsChanged(true);\n\t}\n\n\tgetFooterLayout(): HTMLDivElement\n\t{\n\t\treturn this.cache.remember('footerLayout', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"crm-requisite-fieldset-viewer-footer\">\n\t\t\t\t\t${this.getEditButton().render()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n}"],"names":["FieldsetViewer","EventEmitter","constructor","options","cache","Cache","MemoryCache","setEventNamespace","subscribeFromOptions","events","setOptions","Event","bind","bindElement","onBindElementClick","setData","data","set","getData","get","load","Promise","resolve","entityTypeId","entityId","fieldListEditorOptions","getOptions","presetId","fieldsPanelOptions","BX","ajax","runAction","json","then","result","getPopup","remember","Popup","autoHide","width","height","className","noAllPaddings","Type","isPlainObject","popupOptions","onClose","emit","changed","getIsChanged","setIsChanged","value","Text","toBoolean","getLoader","Loader","show","popup","Dom","clean","getContentContainer","setContent","createPopupContent","hide","close","event","preventDefault","Tag","render","createBannerLayout","createListLayout","getFooterLayout","createCloseButton","title","Loc","getMessage","replace","encode","description","text","isStringFilled","more","createListContainer","fields","map","createListItem","editButton","editing","url","onEditButtonClick","SidePanel","Instance","open","cacheable","label","onCloseClick","getFieldListEditor","ListEditor","setId","id","editable","type","required","autoSave","onSave","hideVirtual","getEditButton","Button","color","Color","LIGHT_BORDER","icon","Icon","EDIT","size","Size","SMALL","round","click","showSlider"],"mappings":"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"}