{"version":3,"file":"render-helper.bundle.js","sources":["../src/render-helper.js"],"sourcesContent":["import { Type, Dom, Event, ajax, Runtime } from 'main.core';\n\nclass DisplayAlertsSupport\n{\n\tDisableAlert = null;\n\n\tisShowAlert = null;\n\tdaysUntilDisable = null;\n\tshowAlertUserOption = null;\n\talertContainerSelector = null;\n\talertContainersStack = [];\n\n\tcanShowAlerts(): boolean\n\t{\n\t\treturn this.isShowAlert === true\n\t\t\t&& this.DisableAlert\n\t\t\t&& Type.isString(this.alertContainerSelector)\n\t\t\t&& Type.isString(this.showAlertUserOption)\n\t\t\t&& Type.isInteger(this.daysUntilDisable)\n\t\t\t&& this.daysUntilDisable > 0\n\t\t;\n\t}\n\n\trenderAlerts(): void\n\t{\n\t\tif (!this.canShowAlerts())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.alertContainersStack.forEach((alertContainer) => {\n\t\t\tthis.renderAlert(alertContainer);\n\t\t});\n\n\t\tthis.alertContainersStack = [];\n\t}\n\n\trenderAlert(container)\n\t{\n\t\tif (container.innerHTML !== '')\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst closeBtnCallback = () => {\n\t\t\tthis.isShowAlert = false;\n\n\t\t\tBX.userOptions.save('crm', this.showAlertUserOption, 'show', 'N');\n\n\t\t\tconst alertContainers = document.querySelectorAll(`.${this.alertContainerSelector}`);\n\t\t\talertContainers.forEach((alertContainer) => {\n\t\t\t\talertContainer.remove();\n\t\t\t});\n\t\t};\n\n\t\tDom.style(container, {\n\t\t\tbackground: 'white',\n\t\t\tpadding: '10px',\n\t\t\t'margin-bottom': '-10px',\n\t\t\t'border-radius': '10px 10px 0 0',\n\t\t});\n\n\t\t(new this.DisableAlert({\n\t\t\talertContainer: container,\n\t\t\tdaysUntilDisable: this.daysUntilDisable,\n\t\t\tcloseBtnCallback,\n\t\t})).render();\n\t}\n}\n\nconst isCrm = window.location.pathname.includes('/crm/');\nif (!isCrm)\n{\n\tconst alertSupport = new DisplayAlertsSupport({});\n\n\tEvent.EventEmitter.subscribe('crm:disableLFAlertContainerRendered', (event) => {\n\t\tconst alertContainer = event.data.container;\n\n\t\tif (alertSupport.canShowAlerts())\n\t\t{\n\t\t\talertSupport.renderAlert(alertContainer);\n\t\t}\n\t\telse\n\t\t{\n\t\t\talertSupport.alertContainersStack.push(alertContainer);\n\t\t}\n\t});\n\n\tRuntime.loadExtension('crm.livefeed.disable-alert')\n\t\t.then((exports) => {\n\t\t\tif (!exports.DisableAlert)\n\t\t\t{\n\t\t\t\talertSupport.isShowAlert = false;\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\talertSupport.DisableAlert = exports.DisableAlert;\n\n\t\t\tajax.runAction('crm.controller.integration.socialnetwork.livefeed.getDisablingInfo')\n\t\t\t\t.then((response) => {\n\t\t\t\t\talertSupport.isShowAlert = response.data.isShowAlert;\n\t\t\t\t\talertSupport.daysUntilDisable = response.data.daysUntilDisable;\n\t\t\t\t\talertSupport.alertContainerSelector = response.data.alertContainerSelector;\n\t\t\t\t\talertSupport.showAlertUserOption = response.data.showAlertUserOption;\n\n\t\t\t\t\talertSupport.renderAlerts();\n\t\t\t\t})\n\t\t\t\t.catch((error) => {\n\t\t\t\t\talertSupport.isShowAlert = false;\n\t\t\t\t})\n\t\t\t;\n\t\t})\n\t\t.catch((error) => {\n\t\t\talertSupport.isShowAlert = false;\n\t\t})\n\t;\n}\n"],"names":["DisplayAlertsSupport","isShowAlert","DisableAlert","Type","isString","alertContainerSelector","showAlertUserOption","isInteger","daysUntilDisable","canShowAlerts","alertContainersStack","forEach","alertContainer","renderAlert","container","innerHTML","closeBtnCallback","BX","userOptions","save","alertContainers","document","querySelectorAll","remove","Dom","style","background","padding","render","isCrm","window","location","pathname","includes","alertSupport","Event","EventEmitter","subscribe","event","data","push","Runtime","loadExtension","then","exports","ajax","runAction","response","renderAlerts","error"],"mappings":"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"}