{"version":3,"file":"audio-player.bundle.js","sources":["../src/components-props/audio-player.js","../src/audio-player.js"],"sourcesContent":["import { Menu } from 'main.popup';\nimport { Dom, bind, unbind } from 'main.core';\nimport { BitrixVueComponentProps } from 'ui.vue3';\n\nconst defaultPlaybackRateValues = [0.5, 0.7, 1.0, 1.2, 1.5, 1.7, 2.0];\n\n// @vue/component\nexport const AudioPlayerProps: BitrixVueComponentProps = {\n\tprops: {\n\t\tplaybackRateValues: {\n\t\t\ttype: Array,\n\t\t\trequired: false,\n\t\t\tdefault: () => defaultPlaybackRateValues,\n\t\t},\n\t\tisShowPlaybackRateMenu: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: true,\n\t\t},\n\t\trecordName: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t\tmini: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: false,\n\t\t},\n\t\t// eslint-disable-next-line vue/require-prop-types\n\t\tcontext: {\n\t\t\trequired: false,\n\t\t\tdefault: window,\n\t\t},\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\t...this.parentData(),\n\t\t\tplaybackRate: defaultPlaybackRateValues[2],\n\t\t\tisSeeking: true,\n\t\t};\n\t},\n\tcomputed: {\n\t\tcontainerClassname(): Array\n\t\t{\n\t\t\treturn [\n\t\t\t\t'crm-audio-player-container',\n\t\t\t\t'ui-vue-audioplayer-container', {\n\t\t\t\t\t'ui-vue-audioplayer-container-dark': this.isDark,\n\t\t\t\t\t'ui-vue-audioplayer-container-mobile': this.isMobile,\n\t\t\t\t\t'--mini': this.mini,\n\t\t\t\t}];\n\t\t},\n\t\tcontrolClassname(): Array\n\t\t{\n\t\t\treturn [\n\t\t\t\t'ui-vue-audioplayer-control',\n\t\t\t\t'ui-btn-icon-start', {\n\t\t\t\t\t'ui-vue-audioplayer-control-loader': this.loading,\n\t\t\t\t\t'ui-vue-audioplayer-control-play': !this.loading && this.state !== this.State.play,\n\t\t\t\t\t'ui-vue-audioplayer-control-pause': !this.loading && this.state === this.State.play,\n\t\t\t\t}];\n\t\t},\n\t\ttimeCurrentClassname(): Array\n\t\t{\n\t\t\treturn [\n\t\t\t\t'ui-vue-audioplayer-time',\n\t\t\t\t'ui-vue-audioplayer-time-current',\n\t\t\t\t{\n\t\t\t\t\t'--is-playing': this.state === this.State.play,\n\t\t\t\t},\n\t\t\t];\n\t\t},\n\n\t\ttotalTimeClassname(): Array\n\t\t{\n\t\t\treturn ['ui-vue-audioplayer-total-time'];\n\t\t},\n\n\t\tprogressPosition(): string\n\t\t{\n\t\t\treturn `width: ${this.progressInPixel}px;`;\n\t\t},\n\n\t\tseekPosition(): string\n\t\t{\n\t\t\tconst minSeekWidth = 20;\n\t\t\tconst seekWidth = this.$refs.seek?.offsetWidth ?? minSeekWidth;\n\n\t\t\treturn `left: ${this.progressInPixel - (seekWidth / 2)}px;`;\n\t\t},\n\n\t\tformatTimeCurrent(): string\n\t\t{\n\t\t\treturn this.formatTime(this.timeCurrent);\n\t\t},\n\n\t\tformatTimeTotal(): string\n\t\t{\n\t\t\treturn this.formatTime(this.timeTotal);\n\t\t},\n\n\t\tplaybackRateMenuItems(): Array\n\t\t{\n\t\t\treturn this.playbackRateValues.map((rate) => {\n\t\t\t\treturn this.createPlaybackRateMenuItem({\n\t\t\t\t\ttext: this.getPlaybackRateOptionText(rate),\n\t\t\t\t\trate,\n\t\t\t\t\tisActive: rate === this.playbackRate,\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\t},\n\tmethods: {\n\t\tchangePlaybackRate(playbackRate: number): void\n\t\t{\n\t\t\tthis.playbackRate = playbackRate;\n\t\t\tif (this.$refs?.source?.playbackRate)\n\t\t\t{\n\t\t\t\tthis.$refs.source.playbackRate = playbackRate;\n\t\t\t}\n\t\t},\n\n\t\tcreatePlaybackRateMenuItem(options = {}): Object\n\t\t{\n\t\t\tconst rate = options.rate || 1;\n\t\t\tconst text = options.text || '';\n\t\t\tconst isActive = options.isActive || false;\n\t\t\tconst className = `playback-speed-menu-item ${isActive ? 'menu-popup-item-accept-sm' : ''}`;\n\n\t\t\treturn {\n\t\t\t\ttext,\n\t\t\t\tclassName,\n\t\t\t\tonclick: (event, item): true => {\n\t\t\t\t\tthis.changePlaybackRate(rate);\n\t\t\t\t\titem.menuWindow.popupWindow.close();\n\n\t\t\t\t\treturn true;\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\n\t\tgetPlaybackRateOptionText(rate: number): string\n\t\t{\n\t\t\treturn this.isFloat(rate) ? `${rate}x` : `${rate}.0x`;\n\t\t},\n\n\t\tshowPlaybackRateMenu(): void {\n\t\t\tif (this.menu && this.menu.getPopupWindow().isShown())\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.menu = new this.context.BX.Main.Menu({\n\t\t\t\tid: `12xx${this.id}`,\n\t\t\t\tclassName: 'crm-audio-player__playback-speed-menu_scope',\n\t\t\t\twidth: 100,\n\t\t\t\tbindElement: this.$refs.playbackRateButtonContainer,\n\t\t\t\tevents: {\n\t\t\t\t\tonPopupShow: () => {\n\t\t\t\t\t\tconst { width: btnContainerWidth } = Dom.getPosition(this.$refs.playbackRateButtonContainer);\n\t\t\t\t\t\tconst popupWindow = this.menu.getPopupWindow();\n\n\t\t\t\t\t\tpopupWindow.setOffset({\n\t\t\t\t\t\t\toffsetLeft: btnContainerWidth / 2,\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tpopupWindow.adjustPosition();\n\t\t\t\t\t},\n\n\t\t\t\t\tonPopupClose: () => {\n\t\t\t\t\t\tthis.menu.destroy();\n\t\t\t\t\t\tthis.menu = null;\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tangle: {\n\t\t\t\t\tposition: 'top',\n\t\t\t\t},\n\t\t\t\toffsetLeft: 0,\n\t\t\t\titems: this.playbackRateMenuItems,\n\t\t\t});\n\n\t\t\tthis.menu.show();\n\t\t},\n\n\t\tisFloat(n: number): boolean\n\t\t{\n\t\t\treturn n % 1 !== 0;\n\t\t},\n\n\t\tstartSeeking(event): void\n\t\t{\n\t\t\tthis.isSeeking = true;\n\t\t\tconst { clientX } = event;\n\n\t\t\tif (this.source())\n\t\t\t{\n\t\t\t\tthis.source().pause();\n\n\t\t\t\tbind(this.context.document, 'mouseup', this.finishSeeking);\n\t\t\t\tbind(this.context.document, 'mousemove', this.seeking);\n\n\t\t\t\tthis.setSeekByCursor(clientX);\n\t\t\t}\n\t\t},\n\n\t\tseeking(event): void\n\t\t{\n\t\t\tif (!this.isSeeking)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst timeline = this.$refs.track;\n\t\t\tconst { clientX } = event;\n\n\t\t\tconst { left, right, width } = Dom.getPosition(timeline);\n\t\t\tif (clientX < left)\n\t\t\t{\n\t\t\t\tthis.seek = 0;\n\t\t\t}\n\t\t\telse if (clientX > right)\n\t\t\t{\n\t\t\t\tthis.seek = width - 1;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.seek = clientX - left;\n\t\t\t}\n\n\t\t\tthis.setPosition();\n\t\t\tevent.preventDefault();\n\t\t},\n\n\t\tfinishSeeking(): void\n\t\t{\n\t\t\tthis.isSeeking = false;\n\t\t\tthis.setPosition();\n\t\t\tif (this.source())\n\t\t\t{\n\t\t\t\tthis.source().play();\n\n\t\t\t\tunbind(this.context.document, 'mouseup', this.finishSeeking);\n\t\t\t\tunbind(this.context.document, 'mousemove', this.seeking);\n\t\t\t}\n\t\t},\n\n\t\tsetSeekByCursor(x: number): void\n\t\t{\n\t\t\tconst timeline = this.$refs.track;\n\t\t\tconst { clientX } = event;\n\n\t\t\tconst { left, right, width } = Dom.getPosition(timeline);\n\t\t\tif (clientX < left)\n\t\t\t{\n\t\t\t\tthis.seek = 0;\n\t\t\t}\n\t\t\telse if (x > right)\n\t\t\t{\n\t\t\t\tthis.seek = width;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.seek = clientX - left;\n\t\t\t}\n\t\t},\n\n\t\tsetPosition(event): void\n\t\t{\n\t\t\tif (!this.loaded)\n\t\t\t{\n\t\t\t\tthis.loadFile(true);\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst pixelPerPercent = this.$refs.track.offsetWidth / 100;\n\n\t\t\tthis.setProgress(this.seek / pixelPerPercent, this.seek);\n\n\t\t\tthis.source().currentTime = this.timeTotal / 100 * this.progress;\n\t\t},\n\n\t\tsetProgress(percent, pixel = -1): void\n\t\t{\n\t\t\tif (this.mini)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.progress = percent;\n\t\t\tthis.progressInPixel = pixel > 0 ? pixel : Math.round(this.$refs.track.offsetWidth / 100 * percent);\n\t\t},\n\n\t\taudioEventRouterWrapper(eventName: String, event): void\n\t\t{\n\t\t\tthis.audioEventRouter(eventName, event);\n\t\t},\n\t},\n\n\t// Language=Vue3\n\ttemplate: `\n\t\t<div\n\t\t\t:class=\"containerClassname\"\n\t\t\tref=\"body\"\n\t\t>\n\t\t\t<div class=\"ui-vue-audioplayer-controls-container\">\n\t\t\t\t<button :class=\"controlClassname\" @click=\"clickToButton\">\n\t\t\t\t\t<svg\n\t\t\t\t\t\tv-if=\"state !== State.play\"\n\t\t\t\t\t\tclass=\"ui-vue-audioplayer-control-icon\"\n\t\t\t\t\t\twidth=\"9\"\n\t\t\t\t\t\theight=\"12\"\n\t\t\t\t\t\tviewBox=\"0 0 9 12\"\n\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M8.52196 5.40967L1.77268 0.637568C1.61355 0.523473 1.40621 0.510554 1.23498 0.604066C1.06375 0.697578 0.957151 0.881946 0.958524 1.0822V10.6259C0.956507 10.8265 1.06301 11.0114 1.23449 11.105C1.40597 11.1987 1.61368 11.1854 1.77268 11.0706L8.52196 6.29847C8.66466 6.19871 8.75016 6.0322 8.75016 5.85407C8.75016 5.67593 8.66466 5.50942 8.52196 5.40967Z\"/>\n\t\t\t\t\t</svg>\n\t\t\t\t\t<svg\n\t\t\t\t\t\tv-else\n\t\t\t\t\t\tclass=\"ui-vue-audioplayer-control-icon\"\n\t\t\t\t\t\twidth=\"8\"\n\t\t\t\t\t\theight=\"10\"\n\t\t\t\t\t\tviewBox=\"0 0 8 10\"\n\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<rect width=\"2\" height=\"9\" x=\"0%\"></rect>\n\t\t\t\t\t\t<rect width=\"2\" height=\"9\" x=\"55%\"></rect>\n\t\t\t\t\t</svg>\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t\t<div class=\"ui-vue-audioplayer-timeline-container\">\n\t\t\t\t<div v-if=\"!mini\" class=\"ui-vue-audioplayer-record-name\">{{ recordName }}</div>\n\t\t\t\t<div v-if=\"!mini\" class=\"ui-vue-audioplayer-track-container\" @mousedown=\"startSeeking\" ref=\"track\">\n\t\t\t\t\t<div class=\"ui-vue-audioplayer-track-mask\"></div>\n\t\t\t\t\t<div class=\"ui-vue-audioplayer-track\" :style=\"progressPosition\"></div>\n\t\t\t\t\t<div @mousedown=\"startSeeking\" class=\"ui-vue-audioplayer-track-seek\" :style=\"seekPosition\">\n\t\t\t\t\t\t<div ref=\"seek\" class=\"ui-vue-audioplayer-track-seek-icon\"></div>\n\t\t\t\t\t</div>\n\t<!--\t\t\t\t\t<div class=\"ui-vue-audioplayer-track-event\" @mousemove=\"seeking\"></div>-->\n\t\t\t\t</div>\n\t\t\t\t<div :class=\"totalTimeClassname\">\n\t\t\t\t\t<div\n\t\t\t\t\t\tv-if=\"(mini && timeCurrent > 0) || !mini\"\n\t\t\t\t\t\tref=\"currentTime\"\n\t\t\t\t\t\t:class=\"timeCurrentClassname\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<span style=\"position: absolute; right: 0; top: 0;\">\n\t\t\t\t\t\t\t{{formatTimeCurrent}}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<span style=\"opacity: 0;\">{{formatTimeTotal}}</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<span class=\"ui-vue-audioplayer-time-divider\" v-if=\"mini && timeCurrent > 0\">&nbsp;/&nbsp;</span>\n\t\t\t\t\t<div ref=\"totalTime\" class=\"ui-vue-audioplayer-time\">{{formatTimeTotal}}</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div\n\t\t\t\tv-if=\"!mini\"\n\t\t\t\t@click=\"showPlaybackRateMenu\"\n\t\t\t\tref=\"playbackRateButtonContainer\"\n\t\t\t\tclass=\"ui-vue-audioplayer_playback-speed-menu-container\"\n\t\t\t\tstyle=\"user-select: none;\"\n\t\t\t>\n\t\t\t\t{{ getPlaybackRateOptionText(playbackRate) }}\n\t\t\t</div>\n\t\t\t<audio\n\t\t\t\tv-if=\"src\"\n\t\t\t\t:src=\"src\"\n\t\t\t\tclass=\"ui-vue-audioplayer-source\"\n\t\t\t\tref=\"source\"\n\t\t\t\t:preload=\"preload\"\n\t\t\t\t@abort=\"audioEventRouter('abort', $event)\"\n\t\t\t\t@error=\"audioEventRouter('error', $event)\"\n\t\t\t\t@suspend=\"audioEventRouter('suspend', $event)\"\n\t\t\t\t@canplay=\"audioEventRouter('canplay', $event)\"\n\t\t\t\t@canplaythrough=\"audioEventRouter('canplaythrough', $event)\"\n\t\t\t\t@durationchange=\"audioEventRouter('durationchange', $event)\"\n\t\t\t\t@loadeddata=\"audioEventRouter('loadeddata', $event)\"\n\t\t\t\t@loadedmetadata=\"audioEventRouter('loadedmetadata', $event)\"\n\t\t\t\t@timeupdate=\"audioEventRouter('timeupdate', $event)\"\n\t\t\t\t@play=\"audioEventRouterWrapper('play', $event)\"\n\t\t\t\t@playing=\"audioEventRouter('playing', $event)\"\n\t\t\t\t@pause=\"audioEventRouterWrapper('pause', $event)\"\n\t\t\t></audio>\n\t\t</div>\n\t`,\n};\n","import { BitrixVue, BitrixVueComponentProxy, BitrixVueComponentProps, VueCreateAppResult } from 'ui.vue3';\nimport { AudioPlayerProps } from './components-props/audio-player.js';\nimport { AudioPlayer as UIAudioPlayer } from 'ui.vue3.components.audioplayer';\nimport { Type } from 'main.core';\n\nexport class AudioPlayer\n{\n\t#application: VueCreateAppResult;\n\trootNode: HTMLElement | string;\n\taudioProps: Object;\n\n\tconstructor(options)\n\t{\n\t\tthis.setRootNode(options.rootNode);\n\t\tthis.setAudioProps(options.audioProps);\n\n\t\tconst AudioPlayerComponent = AudioPlayer.getComponent({});\n\t\tthis.#application = BitrixVue.createApp({\n\t\t\tname: 'crm-audio-player',\n\t\t\tcomponents: { AudioPlayerComponent },\n\t\t\tdata: () => {\n\t\t\t\treturn {\n\t\t\t\t\taudioProps: this.audioProps,\n\t\t\t\t};\n\t\t\t},\n\t\t\ttemplate: '<AudioPlayerComponent v-bind=\"audioProps\" />',\n\t\t});\n\t}\n\n\tattachTemplate(): void\n\t{\n\t\tthis.#application.mount(this.rootNode);\n\t}\n\n\tdetachTemplate(): void\n\t{\n\t\tthis.#application.unmount(this.rootNode);\n\t}\n\n\tstatic getComponent(mutations: BitrixVueComponentProps): BitrixVueComponentProxy\n\t{\n\t\tconst defaultMutations = AudioPlayerProps;\n\n\t\tObject.keys(mutations).forEach((mutationKey) => {\n\t\t\tdefaultMutations[mutationKey] = (defaultMutations[mutationKey])\n\t\t\t\t? BX.util.objectMerge(defaultMutations[mutationKey], mutations[mutationKey])\n\t\t\t\t: mutations[mutationKey]\n\t\t\t;\n\t\t});\n\n\t\treturn BitrixVue.cloneComponent(UIAudioPlayer, defaultMutations);\n\t}\n\n\tsetRootNode(rootNode): void\n\t{\n\t\tif (rootNode === null || rootNode === undefined)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (Type.isString(rootNode))\n\t\t{\n\t\t\tthis.rootNode = document.querySelector(`#${rootNode}`);\n\t\t\tif (!this.rootNode)\n\t\t\t{\n\t\t\t\tthrow new Error('Crm.AudioPlayer: \\'rootNode\\' not found');\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (Type.isElementNode(rootNode))\n\t\t{\n\t\t\tthis.rootNode = rootNode;\n\n\t\t\treturn;\n\t\t}\n\n\t\tthrow new Error('Crm.AudioPlayer: \\'rootNode\\' Must be either a string or an ElementNode');\n\t}\n\n\tsetAudioProps(audioProps): void\n\t{\n\t\tthis.audioProps = audioProps;\n\t}\n}\n\nexport const AudioPlayerComponent = AudioPlayer.getComponent({});\n"],"names":["defaultPlaybackRateValues","AudioPlayerProps","props","playbackRateValues","type","Array","required","isShowPlaybackRateMenu","Boolean","recordName","String","mini","context","window","data","parentData","playbackRate","isSeeking","computed","containerClassname","isDark","isMobile","controlClassname","loading","state","State","play","timeCurrentClassname","totalTimeClassname","progressPosition","progressInPixel","seekPosition","minSeekWidth","seekWidth","$refs","seek","offsetWidth","formatTimeCurrent","formatTime","timeCurrent","formatTimeTotal","timeTotal","playbackRateMenuItems","map","rate","createPlaybackRateMenuItem","text","getPlaybackRateOptionText","isActive","methods","changePlaybackRate","source","options","className","onclick","event","item","menuWindow","popupWindow","close","isFloat","showPlaybackRateMenu","menu","getPopupWindow","isShown","BX","Main","Menu","id","width","bindElement","playbackRateButtonContainer","events","onPopupShow","Dom","getPosition","btnContainerWidth","setOffset","offsetLeft","adjustPosition","onPopupClose","destroy","angle","position","items","show","n","startSeeking","clientX","pause","bind","document","finishSeeking","seeking","setSeekByCursor","timeline","track","left","right","setPosition","preventDefault","unbind","x","loaded","loadFile","pixelPerPercent","setProgress","currentTime","progress","percent","pixel","Math","round","audioEventRouterWrapper","eventName","audioEventRouter","template","AudioPlayer","setRootNode","rootNode","setAudioProps","audioProps","AudioPlayerComponent","getComponent","BitrixVue","createApp","name","components","mount","unmount","undefined","Type","isString","querySelector","Error","isElementNode","mutations","defaultMutations","Object","keys","forEach","mutationKey","util","objectMerge","cloneComponent","UIAudioPlayer"],"mappings":";;;;;;;AAAA,CAIA,IAAMA,yBAAyB,GAAG,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;;CAErE;AACA,CAAO,IAAMC,gBAAyC,GAAG;GACxDC,KAAK,EAAE;KACNC,kBAAkB,EAAE;OACnBC,IAAI,EAAEC,KAAK;OACXC,QAAQ,EAAE,KAAK;OACf,WAAS;SAAA,OAAMN,yBAAyB;;MACxC;KACDO,sBAAsB,EAAE;OACvBH,IAAI,EAAEI,OAAO;OACbF,QAAQ,EAAE,KAAK;OACf,WAAS;MACT;KACDG,UAAU,EAAE;OACXL,IAAI,EAAEM,MAAM;OACZJ,QAAQ,EAAE,KAAK;OACf,WAAS;MACT;KACDK,IAAI,EAAE;OACLP,IAAI,EAAEI,OAAO;OACbF,QAAQ,EAAE,KAAK;OACf,WAAS;MACT;;KAEDM,OAAO,EAAE;OACRN,QAAQ,EAAE,KAAK;OACf,WAASO;;IAEV;GACDC,IAAI,kBACJ;KACC,uCACI,IAAI,CAACC,UAAU,EAAE;OACpBC,YAAY,EAAEhB,yBAAyB,CAAC,CAAC,CAAC;OAC1CiB,SAAS,EAAE;;IAEZ;GACDC,QAAQ,EAAE;KACTC,kBAAkB,gCAClB;OACC,OAAO,CACN,4BAA4B,EAC5B,8BAA8B,EAAE;SAC/B,mCAAmC,EAAE,IAAI,CAACC,MAAM;SAChD,qCAAqC,EAAE,IAAI,CAACC,QAAQ;SACpD,QAAQ,EAAE,IAAI,CAACV;QACf,CAAC;MACH;KACDW,gBAAgB,8BAChB;OACC,OAAO,CACN,4BAA4B,EAC5B,mBAAmB,EAAE;SACpB,mCAAmC,EAAE,IAAI,CAACC,OAAO;SACjD,iCAAiC,EAAE,CAAC,IAAI,CAACA,OAAO,IAAI,IAAI,CAACC,KAAK,KAAK,IAAI,CAACC,KAAK,CAACC,IAAI;SAClF,kCAAkC,EAAE,CAAC,IAAI,CAACH,OAAO,IAAI,IAAI,CAACC,KAAK,KAAK,IAAI,CAACC,KAAK,CAACC;QAC/E,CAAC;MACH;KACDC,oBAAoB,kCACpB;OACC,OAAO,CACN,yBAAyB,EACzB,iCAAiC,EACjC;SACC,cAAc,EAAE,IAAI,CAACH,KAAK,KAAK,IAAI,CAACC,KAAK,CAACC;QAC1C,CACD;MACD;KAEDE,kBAAkB,gCAClB;OACC,OAAO,CAAC,+BAA+B,CAAC;MACxC;KAEDC,gBAAgB,8BAChB;OACC,wBAAiB,IAAI,CAACC,eAAe;MACrC;KAEDC,YAAY,0BACZ;OAAA;OACC,IAAMC,YAAY,GAAG,EAAE;OACvB,IAAMC,SAAS,gDAAG,IAAI,CAACC,KAAK,CAACC,IAAI,qDAAf,iBAAiBC,WAAW,yEAAIJ,YAAY;OAE9D,uBAAgB,IAAI,CAACF,eAAe,GAAIG,SAAS,GAAG,CAAE;MACtD;KAEDI,iBAAiB,+BACjB;OACC,OAAO,IAAI,CAACC,UAAU,CAAC,IAAI,CAACC,WAAW,CAAC;MACxC;KAEDC,eAAe,6BACf;OACC,OAAO,IAAI,CAACF,UAAU,CAAC,IAAI,CAACG,SAAS,CAAC;MACtC;KAEDC,qBAAqB,mCACrB;OAAA;OACC,OAAO,IAAI,CAACvC,kBAAkB,CAACwC,GAAG,CAAC,UAACC,IAAI,EAAK;SAC5C,OAAO,KAAI,CAACC,0BAA0B,CAAC;WACtCC,IAAI,EAAE,KAAI,CAACC,yBAAyB,CAACH,IAAI,CAAC;WAC1CA,IAAI,EAAJA,IAAI;WACJI,QAAQ,EAAEJ,IAAI,KAAK,KAAI,CAAC5B;UACxB,CAAC;QACF,CAAC;;IAEH;GACDiC,OAAO,EAAE;KACRC,kBAAkB,8BAAClC,YAAoB,EACvC;OAAA;OACC,IAAI,CAACA,YAAY,GAAGA,YAAY;OAChC,mBAAI,IAAI,CAACkB,KAAK,8DAAV,YAAYiB,MAAM,+CAAlB,mBAAoBnC,YAAY,EACpC;SACC,IAAI,CAACkB,KAAK,CAACiB,MAAM,CAACnC,YAAY,GAAGA,YAAY;;MAE9C;KAED6B,0BAA0B,wCAC1B;OAAA;OAAA,IAD2BO,OAAO,uEAAG,EAAE;OAEtC,IAAMR,IAAI,GAAGQ,OAAO,CAACR,IAAI,IAAI,CAAC;OAC9B,IAAME,IAAI,GAAGM,OAAO,CAACN,IAAI,IAAI,EAAE;OAC/B,IAAME,QAAQ,GAAGI,OAAO,CAACJ,QAAQ,IAAI,KAAK;OAC1C,IAAMK,SAAS,sCAA+BL,QAAQ,GAAG,2BAA2B,GAAG,EAAE,CAAE;OAE3F,OAAO;SACNF,IAAI,EAAJA,IAAI;SACJO,SAAS,EAATA,SAAS;SACTC,OAAO,EAAE,iBAACC,KAAK,EAAEC,IAAI,EAAW;WAC/B,MAAI,CAACN,kBAAkB,CAACN,IAAI,CAAC;WAC7BY,IAAI,CAACC,UAAU,CAACC,WAAW,CAACC,KAAK,EAAE;WAEnC,OAAO,IAAI;;QAEZ;MACD;KAEDZ,yBAAyB,qCAACH,IAAY,EACtC;OACC,OAAO,IAAI,CAACgB,OAAO,CAAChB,IAAI,CAAC,aAAMA,IAAI,mBAASA,IAAI,QAAK;MACrD;KAEDiB,oBAAoB,kCAAS;OAAA;OAC5B,IAAI,IAAI,CAACC,IAAI,IAAI,IAAI,CAACA,IAAI,CAACC,cAAc,EAAE,CAACC,OAAO,EAAE,EACrD;SACC;;OAGD,IAAI,CAACF,IAAI,GAAG,IAAI,IAAI,CAAClD,OAAO,CAACqD,EAAE,CAACC,IAAI,CAACC,IAAI,CAAC;SACzCC,EAAE,gBAAS,IAAI,CAACA,EAAE,CAAE;SACpBf,SAAS,EAAE,6CAA6C;SACxDgB,KAAK,EAAE,GAAG;SACVC,WAAW,EAAE,IAAI,CAACpC,KAAK,CAACqC,2BAA2B;SACnDC,MAAM,EAAE;WACPC,WAAW,EAAE,uBAAM;aAClB,uBAAqCC,aAAG,CAACC,WAAW,CAAC,MAAI,CAACzC,KAAK,CAACqC,2BAA2B,CAAC;eAA7EK,iBAAiB,oBAAxBP,KAAK;aACb,IAAMX,WAAW,GAAG,MAAI,CAACI,IAAI,CAACC,cAAc,EAAE;aAE9CL,WAAW,CAACmB,SAAS,CAAC;eACrBC,UAAU,EAAEF,iBAAiB,GAAG;cAChC,CAAC;aAEFlB,WAAW,CAACqB,cAAc,EAAE;YAC5B;WAEDC,YAAY,EAAE,wBAAM;aACnB,MAAI,CAAClB,IAAI,CAACmB,OAAO,EAAE;aACnB,MAAI,CAACnB,IAAI,GAAG,IAAI;;UAEjB;SACDoB,KAAK,EAAE;WACNC,QAAQ,EAAE;UACV;SACDL,UAAU,EAAE,CAAC;SACbM,KAAK,EAAE,IAAI,CAAC1C;QACZ,CAAC;OAEF,IAAI,CAACoB,IAAI,CAACuB,IAAI,EAAE;MAChB;KAEDzB,OAAO,mBAAC0B,CAAS,EACjB;OACC,OAAOA,CAAC,GAAG,CAAC,KAAK,CAAC;MAClB;KAEDC,YAAY,wBAAChC,KAAK,EAClB;OACC,IAAI,CAACtC,SAAS,GAAG,IAAI;OACrB,IAAQuE,OAAO,GAAKjC,KAAK,CAAjBiC,OAAO;OAEf,IAAI,IAAI,CAACrC,MAAM,EAAE,EACjB;SACC,IAAI,CAACA,MAAM,EAAE,CAACsC,KAAK,EAAE;SAErBC,cAAI,CAAC,IAAI,CAAC9E,OAAO,CAAC+E,QAAQ,EAAE,SAAS,EAAE,IAAI,CAACC,aAAa,CAAC;SAC1DF,cAAI,CAAC,IAAI,CAAC9E,OAAO,CAAC+E,QAAQ,EAAE,WAAW,EAAE,IAAI,CAACE,OAAO,CAAC;SAEtD,IAAI,CAACC,eAAe,CAACN,OAAO,CAAC;;MAE9B;KAEDK,OAAO,mBAACtC,KAAK,EACb;OACC,IAAI,CAAC,IAAI,CAACtC,SAAS,EACnB;SACC;;OAGD,IAAM8E,QAAQ,GAAG,IAAI,CAAC7D,KAAK,CAAC8D,KAAK;OACjC,IAAQR,OAAO,GAAKjC,KAAK,CAAjBiC,OAAO;OAEf,wBAA+Bd,aAAG,CAACC,WAAW,CAACoB,QAAQ,CAAC;SAAhDE,IAAI,qBAAJA,IAAI;SAAEC,KAAK,qBAALA,KAAK;SAAE7B,KAAK,qBAALA,KAAK;OAC1B,IAAImB,OAAO,GAAGS,IAAI,EAClB;SACC,IAAI,CAAC9D,IAAI,GAAG,CAAC;QACb,MACI,IAAIqD,OAAO,GAAGU,KAAK,EACxB;SACC,IAAI,CAAC/D,IAAI,GAAGkC,KAAK,GAAG,CAAC;QACrB,MAED;SACC,IAAI,CAAClC,IAAI,GAAGqD,OAAO,GAAGS,IAAI;;OAG3B,IAAI,CAACE,WAAW,EAAE;OAClB5C,KAAK,CAAC6C,cAAc,EAAE;MACtB;KAEDR,aAAa,2BACb;OACC,IAAI,CAAC3E,SAAS,GAAG,KAAK;OACtB,IAAI,CAACkF,WAAW,EAAE;OAClB,IAAI,IAAI,CAAChD,MAAM,EAAE,EACjB;SACC,IAAI,CAACA,MAAM,EAAE,CAACzB,IAAI,EAAE;SAEpB2E,gBAAM,CAAC,IAAI,CAACzF,OAAO,CAAC+E,QAAQ,EAAE,SAAS,EAAE,IAAI,CAACC,aAAa,CAAC;SAC5DS,gBAAM,CAAC,IAAI,CAACzF,OAAO,CAAC+E,QAAQ,EAAE,WAAW,EAAE,IAAI,CAACE,OAAO,CAAC;;MAEzD;KAEDC,eAAe,2BAACQ,CAAS,EACzB;OACC,IAAMP,QAAQ,GAAG,IAAI,CAAC7D,KAAK,CAAC8D,KAAK;OACjC,aAAoBzC,KAAK;SAAjBiC,OAAO,UAAPA,OAAO;OAEf,wBAA+Bd,aAAG,CAACC,WAAW,CAACoB,QAAQ,CAAC;SAAhDE,IAAI,qBAAJA,IAAI;SAAEC,KAAK,qBAALA,KAAK;SAAE7B,KAAK,qBAALA,KAAK;OAC1B,IAAImB,OAAO,GAAGS,IAAI,EAClB;SACC,IAAI,CAAC9D,IAAI,GAAG,CAAC;QACb,MACI,IAAImE,CAAC,GAAGJ,KAAK,EAClB;SACC,IAAI,CAAC/D,IAAI,GAAGkC,KAAK;QACjB,MAED;SACC,IAAI,CAAClC,IAAI,GAAGqD,OAAO,GAAGS,IAAI;;MAE3B;KAEDE,WAAW,uBAAC5C,KAAK,EACjB;OACC,IAAI,CAAC,IAAI,CAACgD,MAAM,EAChB;SACC,IAAI,CAACC,QAAQ,CAAC,IAAI,CAAC;SAEnB;;OAGD,IAAMC,eAAe,GAAG,IAAI,CAACvE,KAAK,CAAC8D,KAAK,CAAC5D,WAAW,GAAG,GAAG;OAE1D,IAAI,CAACsE,WAAW,CAAC,IAAI,CAACvE,IAAI,GAAGsE,eAAe,EAAE,IAAI,CAACtE,IAAI,CAAC;OAExD,IAAI,CAACgB,MAAM,EAAE,CAACwD,WAAW,GAAG,IAAI,CAAClE,SAAS,GAAG,GAAG,GAAG,IAAI,CAACmE,QAAQ;MAChE;KAEDF,WAAW,uBAACG,OAAO,EACnB;OAAA,IADqBC,KAAK,uEAAG,CAAC,CAAC;OAE9B,IAAI,IAAI,CAACnG,IAAI,EACb;SACC;;OAGD,IAAI,CAACiG,QAAQ,GAAGC,OAAO;OACvB,IAAI,CAAC/E,eAAe,GAAGgF,KAAK,GAAG,CAAC,GAAGA,KAAK,GAAGC,IAAI,CAACC,KAAK,CAAC,IAAI,CAAC9E,KAAK,CAAC8D,KAAK,CAAC5D,WAAW,GAAG,GAAG,GAAGyE,OAAO,CAAC;MACnG;KAEDI,uBAAuB,mCAACC,SAAiB,EAAE3D,KAAK,EAChD;OACC,IAAI,CAAC4D,gBAAgB,CAACD,SAAS,EAAE3D,KAAK,CAAC;;IAExC;;GAGD6D,QAAQ;CAsFT,CAAC;;;;ACpYD,CAGiC;AAEjC,KAAaC,WAAW;GAMvB,qBAAYjE,OAAO,EACnB;KAAA;KAAA;KAAA;OAAA;OAAA;;KACC,IAAI,CAACkE,WAAW,CAAClE,OAAO,CAACmE,QAAQ,CAAC;KAClC,IAAI,CAACC,aAAa,CAACpE,OAAO,CAACqE,UAAU,CAAC;KAEtC,IAAMC,oBAAoB,GAAGL,WAAW,CAACM,YAAY,CAAC,EAAE,CAAC;KACzD,sCAAI,gBAAgBC,iBAAS,CAACC,SAAS,CAAC;OACvCC,IAAI,EAAE,kBAAkB;OACxBC,UAAU,EAAE;SAAEL,oBAAoB,EAApBA;QAAsB;OACpC5G,IAAI,EAAE,gBAAM;SACX,OAAO;WACN2G,UAAU,EAAE,KAAI,CAACA;UACjB;QACD;OACDL,QAAQ,EAAE;MACV,CAAC;;GACF;KAAA;KAAA,iCAGD;OACC,sCAAI,gBAAcY,KAAK,CAAC,IAAI,CAACT,QAAQ,CAAC;;;KACtC;KAAA,iCAGD;OACC,sCAAI,gBAAcU,OAAO,CAAC,IAAI,CAACV,QAAQ,CAAC;;;KACxC;KAAA,4BAgBWA,QAAQ,EACpB;OACC,IAAIA,QAAQ,KAAK,IAAI,IAAIA,QAAQ,KAAKW,SAAS,EAC/C;SACC;;OAGD,IAAIC,cAAI,CAACC,QAAQ,CAACb,QAAQ,CAAC,EAC3B;SACC,IAAI,CAACA,QAAQ,GAAG5B,QAAQ,CAAC0C,aAAa,YAAKd,QAAQ,EAAG;SACtD,IAAI,CAAC,IAAI,CAACA,QAAQ,EAClB;WACC,MAAM,IAAIe,KAAK,CAAC,yCAAyC,CAAC;;SAG3D;;OAGD,IAAIH,cAAI,CAACI,aAAa,CAAChB,QAAQ,CAAC,EAChC;SACC,IAAI,CAACA,QAAQ,GAAGA,QAAQ;SAExB;;OAGD,MAAM,IAAIe,KAAK,CAAC,yEAAyE,CAAC;;;KAC1F;KAAA,8BAEab,UAAU,EACxB;OACC,IAAI,CAACA,UAAU,GAAGA,UAAU;;;KAC5B;KAAA,6BA7CmBe,SAAkC,EACtD;OACC,IAAMC,gBAAgB,GAAGxI,gBAAgB;OAEzCyI,MAAM,CAACC,IAAI,CAACH,SAAS,CAAC,CAACI,OAAO,CAAC,UAACC,WAAW,EAAK;SAC/CJ,gBAAgB,CAACI,WAAW,CAAC,GAAIJ,gBAAgB,CAACI,WAAW,CAAC,GAC3D5E,EAAE,CAAC6E,IAAI,CAACC,WAAW,CAACN,gBAAgB,CAACI,WAAW,CAAC,EAAEL,SAAS,CAACK,WAAW,CAAC,CAAC,GAC1EL,SAAS,CAACK,WAAW,CAAC;QAEzB,CAAC;OAEF,OAAOjB,iBAAS,CAACoB,cAAc,CAACC,0CAAa,EAAER,gBAAgB,CAAC;;;GAChE;CAAA;AAoCF,KAAaf,oBAAoB,GAAGL,WAAW,CAACM,YAAY,CAAC,EAAE,CAAC;;;;;;;;;"}