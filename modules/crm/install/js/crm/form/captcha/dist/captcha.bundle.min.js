this.BX=this.BX||{};this.BX.Crm=this.BX.Crm||{};(function(t,e,n){"use strict";var a,i,s;function r(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function l(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?r(Object(n),!0).forEach((function(e){babelHelpers.defineProperty(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function c(t,e){u(t,e);e.add(t)}function o(t,e,n){u(t,e);e.set(t,n)}function u(t,e){if(e.has(t)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}function d(t,e,n){if(!e.has(t)){throw new TypeError("attempted to get private field on non-instance")}return n}var v=new WeakMap;var p=new WeakMap;var b=new WeakSet;var f=function(){function t(){babelHelpers.classCallCheck(this,t);c(this,b);o(this,v,{writable:true,value:{key:null,secret:null,canChange:false,hasDefaults:false}});o(this,p,{writable:true,value:void 0})}babelHelpers.createClass(t,[{key:"hasKeys",value:function t(){var e=babelHelpers.classPrivateFieldGet(this,v);return e.hasDefaults||e.key&&e.secret}},{key:"canChange",value:function t(){return babelHelpers.classPrivateFieldGet(this,v).canChange}},{key:"load",value:function t(){var n=this;return e.ajax.runAction("crm.form.getCaptcha",{json:{}}).then((function(t){babelHelpers.classPrivateFieldSet(n,v,t.data);return d(n,b,h).call(n)}))}},{key:"save",value:function t(){var n=this;var a=babelHelpers.classPrivateFieldGet(this,p).querySelector('input[name="key"]');var i=babelHelpers.classPrivateFieldGet(this,p).querySelector('input[name="secret"]');var s=a.value||"";var r=i.value||"";a.parentElement.classList.remove("ui-ctl-danger");i.parentElement.classList.remove("ui-ctl-danger");if(e.Type.isStringFilled(s)!==e.Type.isStringFilled(r)){if(!s){a.parentElement.classList.add("ui-ctl-danger")}if(!r){i.parentElement.classList.add("ui-ctl-danger")}return Promise.reject()}return e.ajax.runAction("crm.form.setCaptcha",{json:{key:s,secret:r}}).then((function(t){babelHelpers.classPrivateFieldSet(n,v,t.data);return babelHelpers.classPrivateFieldGet(n,v)}))}},{key:"getValue",value:function t(){return babelHelpers.classPrivateFieldGet(this,v)}}],[{key:"open",value:function a(){var i;var s=new Promise((function(t){i=t}));var r=new t;BX.SidePanel.Instance.open("crm.webform:captcha",{width:700,cacheable:false,events:{onCloseComplete:function t(){i(l({},r.getValue()))}},contentCallback:function t(){return n.Layout.createContent({extensions:["crm.form.captcha","ui.forms","ui.sidepanel-content"],title:e.Loc.getMessage("CRM_FORM_CAPTCHA_JS_TITLE"),design:{section:false},content:function t(){return r.load()},buttons:function t(n){var a=n.SaveButton,i=n.closeButton;return[new a({onclick:function t(n){if(!r.canChange()){n.setDisabled(true);BX.UI.Notification.Center.notify({content:e.Loc.getMessage("CRM_FORM_CAPTCHA_JS_ACCESS_DENIED")});return}n.setWaiting(true);r.save().then((function(){n.setWaiting(false);BX.SidePanel.Instance.close()}))["catch"]((function(){n.setWaiting(false)}))}}),i]}})}});return s}}]);return t}();function h(){var t=e.Tag.safe(a||(a=babelHelpers.taggedTemplateLiteral(["",""])),babelHelpers.classPrivateFieldGet(this,v).key);var n=e.Tag.safe(i||(i=babelHelpers.taggedTemplateLiteral(["",""])),babelHelpers.classPrivateFieldGet(this,v).secret);babelHelpers.classPrivateFieldSet(this,p,e.Tag.render(s||(s=babelHelpers.taggedTemplateLiteral(['\t\t\t\t\n\t\t\t<div>\n\t\t\t\t<div class="ui-slider-section" ','>\n\t\t\t\t\t<div class="ui-slider-content-box">\n\t\t\t\t\t\t<div class="ui-slider-heading-4">','</div>\n\t\t\t\t\t\t<div class="ui-alert ui-alert-success">\n\t\t\t\t\t\t\t<span class="ui-alert-message">','</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t\n\t\t\t\t<div class="ui-slider-section">\n\t\t\t\t\t<div class="ui-slider-content-box">\n\t\t\t\t\t\t<div class="ui-slider-heading-4">','</div>\n\t\t\t\t\t\t<p class="ui-slider-paragraph-2">\n\t\t\t\t\t\t\t','\n\t\t\t\t\t\t\t<br>\n\t\t\t\t\t\t\t<a href="https://www.google.com/recaptcha/about/" target="_blank">','</a>\n\t\t\t\t\t\t</p>\n\t\t\t\t\t</div>\n\t\t\t\t\t\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<div class="ui-form-row">\n\t\t\t\t\t\t\t<div class="ui-form-label">\n\t\t\t\t\t\t\t\t<div class="ui-ctl-label-text">Key</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="ui-form-content">\n\t\t\t\t\t\t\t\t<div class="ui-ctl ui-ctl-textbox ui-ctl-w100">\n\t\t\t\t\t\t\t\t\t<input \n\t\t\t\t\t\t\t\t\t\ttype="text" \n\t\t\t\t\t\t\t\t\t\tname="key"\n\t\t\t\t\t\t\t\t\t\tvalue="','"\n\t\t\t\t\t\t\t\t\t\tclass="ui-ctl-element"\n\t\t\t\t\t\t\t\t\t\tonfocus="this.parentElement.classList.remove(\'ui-ctl-danger\')"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="ui-form-row" style="margin: 20px 0 0;">\n\t\t\t\t\t\t\t<div class="ui-form-label">\n\t\t\t\t\t\t\t\t<div class="ui-ctl-label-text">Secret</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="ui-form-content">\n\t\t\t\t\t\t\t\t<div class="ui-ctl ui-ctl-textbox ui-ctl-w100">\n\t\t\t\t\t\t\t\t\t<input \n\t\t\t\t\t\t\t\t\t\ttype="text" \n\t\t\t\t\t\t\t\t\t\tname="secret"\n\t\t\t\t\t\t\t\t\t\tvalue="','"\n\t\t\t\t\t\t\t\t\t\tclass="ui-ctl-element"\n\t\t\t\t\t\t\t\t\t\tonfocus="this.parentElement.classList.remove(\'ui-ctl-danger\')"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t'])),babelHelpers.classPrivateFieldGet(this,v).hasDefaults?"":"hidden",e.Loc.getMessage("CRM_FORM_CAPTCHA_JS_STD_TITLE"),e.Loc.getMessage("CRM_FORM_CAPTCHA_JS_STD_TEXT"),e.Loc.getMessage("CRM_FORM_CAPTCHA_JS_CUSTOM_TITLE"),e.Loc.getMessage("CRM_FORM_CAPTCHA_JS_CUSTOM_TEXT"),e.Loc.getMessage("CRM_FORM_CAPTCHA_JS_CUSTOM_HOWTO"),t,n));return babelHelpers.classPrivateFieldGet(this,p)}t.Captcha=f})(this.BX.Crm.Form=this.BX.Crm.Form||{},BX,BX.UI.SidePanel);
//# sourceMappingURL=captcha.bundle.map.js