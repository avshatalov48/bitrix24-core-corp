this.BX=this.BX||{};this.BX.Crm=this.BX.Crm||{};(function(t,e,n){"use strict";function a(){var t=babelHelpers.taggedTemplateLiteral(['\t\t\t\t\n\t\t\t<div>\n\t\t\t\t<div class="ui-slider-section" ','>\n\t\t\t\t\t<div class="ui-slider-content-box">\n\t\t\t\t\t\t<div class="ui-slider-heading-4">','</div>\n\t\t\t\t\t\t<div class="ui-alert ui-alert-success">\n\t\t\t\t\t\t\t<span class="ui-alert-message">','</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t\n\t\t\t\t<div class="ui-slider-section">\n\t\t\t\t\t<div class="ui-slider-content-box">\n\t\t\t\t\t\t<div class="ui-slider-heading-4">','</div>\n\t\t\t\t\t\t<p class="ui-slider-paragraph-2">\n\t\t\t\t\t\t\t','\n\t\t\t\t\t\t\t<br>\n\t\t\t\t\t\t\t<a href="https://www.google.com/recaptcha/about/" target="_blank">','</a>\n\t\t\t\t\t\t</p>\n\t\t\t\t\t</div>\n\t\t\t\t\t\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<div class="ui-form-row">\n\t\t\t\t\t\t\t<div class="ui-form-label">\n\t\t\t\t\t\t\t\t<div class="ui-ctl-label-text">Key</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="ui-form-content">\n\t\t\t\t\t\t\t\t<div class="ui-ctl ui-ctl-textbox ui-ctl-w100">\n\t\t\t\t\t\t\t\t\t<input \n\t\t\t\t\t\t\t\t\t\ttype="text" \n\t\t\t\t\t\t\t\t\t\tname="key"\n\t\t\t\t\t\t\t\t\t\tvalue="','"\n\t\t\t\t\t\t\t\t\t\tclass="ui-ctl-element"\n\t\t\t\t\t\t\t\t\t\tonfocus="this.parentElement.classList.remove(\'ui-ctl-danger\')"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="ui-form-row">\n\t\t\t\t\t\t\t<div class="ui-form-label">\n\t\t\t\t\t\t\t\t<div class="ui-ctl-label-text">Secret</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="ui-form-content">\n\t\t\t\t\t\t\t\t<div class="ui-ctl ui-ctl-textbox ui-ctl-w100">\n\t\t\t\t\t\t\t\t\t<input \n\t\t\t\t\t\t\t\t\t\ttype="text" \n\t\t\t\t\t\t\t\t\t\tname="secret"\n\t\t\t\t\t\t\t\t\t\tvalue="','"\n\t\t\t\t\t\t\t\t\t\tclass="ui-ctl-element"\n\t\t\t\t\t\t\t\t\t\tonfocus="this.parentElement.classList.remove(\'ui-ctl-danger\')"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t']);a=function e(){return t};return t}function s(){var t=babelHelpers.taggedTemplateLiteral(["",""]);s=function e(){return t};return t}function i(){var t=babelHelpers.taggedTemplateLiteral(["",""]);i=function e(){return t};return t}function l(t,e,n){if(!e.has(t)){throw new TypeError("attempted to get private field on non-instance")}return n}var r=function(){function t(){babelHelpers.classCallCheck(this,t);o.add(this);c.set(this,{writable:true,value:{key:null,secret:null,canChange:false,hasDefaults:false}});u.set(this,{writable:true,value:void 0})}babelHelpers.createClass(t,[{key:"hasKeys",value:function t(){var e=babelHelpers.classPrivateFieldGet(this,c);return e.hasDefaults||e.key&&e.secret}},{key:"canChange",value:function t(){return babelHelpers.classPrivateFieldGet(this,c).canChange}},{key:"load",value:function t(){var n=this;return e.ajax.runAction("crm.form.getCaptcha",{json:{}}).then(function(t){babelHelpers.classPrivateFieldSet(n,c,t.data);return l(n,o,d).call(n)})}},{key:"save",value:function t(){var n=this;var a=babelHelpers.classPrivateFieldGet(this,u).querySelector('input[name="key"]');var s=babelHelpers.classPrivateFieldGet(this,u).querySelector('input[name="secret"]');var i=a.value||"";var l=s.value||"";a.parentElement.classList.remove("ui-ctl-danger");s.parentElement.classList.remove("ui-ctl-danger");if(e.Type.isStringFilled(i)!==e.Type.isStringFilled(l)){if(!i){a.parentElement.classList.add("ui-ctl-danger")}if(!l){s.parentElement.classList.add("ui-ctl-danger")}return Promise.reject()}return e.ajax.runAction("crm.form.setCaptcha",{json:{key:i,secret:l}}).then(function(t){babelHelpers.classPrivateFieldSet(n,c,t.data);return babelHelpers.classPrivateFieldGet(n,c)})}},{key:"getValue",value:function t(){return babelHelpers.classPrivateFieldGet(this,c)}}],[{key:"open",value:function a(){var s;var i=new Promise(function(t){s=t});var l=new t;BX.SidePanel.Instance.open("crm.webform:captcha",{width:700,cacheable:false,events:{onCloseComplete:function t(){s(babelHelpers.objectSpread({},l.getValue()))}},contentCallback:function t(){return n.Layout.createContent({extensions:["crm.form.captcha","ui.forms","ui.sidepanel-content"],title:e.Loc.getMessage("CRM_FORM_CAPTCHA_JS_TITLE"),design:{section:false},content:function t(){return l.load()},buttons:function t(n){var a=n.SaveButton,s=n.closeButton;return[new a({onclick:function t(n){if(!l.canChange()){n.setDisabled(true);BX.UI.Notification.Center.notify({content:e.Loc.getMessage("CRM_FORM_CAPTCHA_JS_ACCESS_DENIED")});return}n.setWaiting(true);l.save().then(function(){n.setWaiting(false);BX.SidePanel.Instance.close()}).catch(function(){n.setWaiting(false)})}}),s]}})}});return i}}]);return t}();var c=new WeakMap;var u=new WeakMap;var o=new WeakSet;var d=function t(){var n=e.Tag.safe(i(),babelHelpers.classPrivateFieldGet(this,c).key);var l=e.Tag.safe(s(),babelHelpers.classPrivateFieldGet(this,c).secret);babelHelpers.classPrivateFieldSet(this,u,e.Tag.render(a(),babelHelpers.classPrivateFieldGet(this,c).hasDefaults?"":"hidden",e.Loc.getMessage("CRM_FORM_CAPTCHA_JS_STD_TITLE"),e.Loc.getMessage("CRM_FORM_CAPTCHA_JS_STD_TEXT"),e.Loc.getMessage("CRM_FORM_CAPTCHA_JS_CUSTOM_TITLE"),e.Loc.getMessage("CRM_FORM_CAPTCHA_JS_CUSTOM_TEXT"),e.Loc.getMessage("CRM_FORM_CAPTCHA_JS_CUSTOM_HOWTO"),n,l));return babelHelpers.classPrivateFieldGet(this,u)};t.Captcha=r})(this.BX.Crm.Form=this.BX.Crm.Form||{},BX,BX.UI.SidePanel);
//# sourceMappingURL=captcha.bundle.map.js