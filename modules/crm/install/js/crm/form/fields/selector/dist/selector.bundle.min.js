this.BX=this.BX||{};this.BX.Crm=this.BX.Crm||{};this.BX.Crm.Form=this.BX.Crm.Form||{};(function(e,s,t,l,i,a){"use strict";var r=babelHelpers.classPrivateFieldLooseKey("request");class o extends i.EventEmitter{constructor(e){super();Object.defineProperty(this,r,{value:c});this.setEventNamespace("BX.Crm.Form.Fields.Selector.Backend");this.subscribeFromOptions(e.events)}getData(e={}){return babelHelpers.classPrivateFieldLooseBase(this,r)[r]({action:"getData",data:e})}}function c(e){return new Promise(((s,t)=>{a.ajax.runAction(`crm.api.form.fields.selector.${e.action}`,{json:e.data}).then(s).catch(t)}))}let n=e=>e,b,d,p;var v=babelHelpers.classPrivateFieldLooseKey("cache");var u=babelHelpers.classPrivateFieldLooseKey("setOptions");var F=babelHelpers.classPrivateFieldLooseKey("getOptions");var P=babelHelpers.classPrivateFieldLooseKey("onInput");var h=babelHelpers.classPrivateFieldLooseKey("getDebounceWrapper");var L=babelHelpers.classPrivateFieldLooseKey("getInput");var y=babelHelpers.classPrivateFieldLooseKey("onClearClick");var f=babelHelpers.classPrivateFieldLooseKey("getClearButton");class H extends i.EventEmitter{constructor(e={}){super();Object.defineProperty(this,f,{value:j});Object.defineProperty(this,y,{value:T});Object.defineProperty(this,L,{value:C});Object.defineProperty(this,h,{value:O});Object.defineProperty(this,P,{value:g});Object.defineProperty(this,F,{value:m});Object.defineProperty(this,u,{value:B});Object.defineProperty(this,v,{writable:true,value:new a.Cache.MemoryCache});this.setEventNamespace("BX.Crm.Form.Fields.Selector.Search");this.subscribeFromOptions(e.events);babelHelpers.classPrivateFieldLooseBase(this,u)[u](e)}getValue(){return babelHelpers.classPrivateFieldLooseBase(this,L)[L]().value}setValue(e){babelHelpers.classPrivateFieldLooseBase(this,L)[L]().value=a.Text.encode(e);babelHelpers.classPrivateFieldLooseBase(this,P)[P]()}getLayout(){return babelHelpers.classPrivateFieldLooseBase(this,v)[v].remember("layout",(()=>a.Tag.render(b||(b=n`
				<div class="crm-form-fields-selector-search">
					<div class="ui-ctl ui-ctl-textbox ui-ctl-w100 ui-ctl-before-icon ui-ctl-after-icon">
						<div class="ui-ctl-before ui-ctl-icon-search"></div>
						${0}
						${0}
					</div>
				</div>
			`),babelHelpers.classPrivateFieldLooseBase(this,f)[f](),babelHelpers.classPrivateFieldLooseBase(this,L)[L]())))}}function B(e){babelHelpers.classPrivateFieldLooseBase(this,v)[v].set("options",{...e})}function m(){return babelHelpers.classPrivateFieldLooseBase(this,v)[v].get("options",{})}function g(){this.emit("onChange",{value:babelHelpers.classPrivateFieldLooseBase(this,L)[L]().value});babelHelpers.classPrivateFieldLooseBase(this,h)[h]()()}function O(){return babelHelpers.classPrivateFieldLooseBase(this,v)[v].remember("debounceWrapper",(()=>a.Runtime.debounce((()=>{this.emit("onDebouncedChange",{value:babelHelpers.classPrivateFieldLooseBase(this,L)[L]().value})}),50)))}function C(){return babelHelpers.classPrivateFieldLooseBase(this,v)[v].remember("input",(()=>{const e=(()=>{if(a.Type.isStringFilled(babelHelpers.classPrivateFieldLooseBase(this,F)[F]().initialValue)){return babelHelpers.classPrivateFieldLooseBase(this,F)[F]().initialValue}return""})();return a.Tag.render(d||(d=n`
				<input 
					type="text" 
					class="ui-ctl-element" 
					oninput="${0}"
					value="${0}"
					placeholder="${0}"
				>
			`),babelHelpers.classPrivateFieldLooseBase(this,P)[P].bind(this),a.Text.encode(e),a.Loc.getMessage("CRM_FORM_FIELDS_SELECTOR_SEARCH_PLACEHOLDER"))}))}function T(e){e.preventDefault();babelHelpers.classPrivateFieldLooseBase(this,L)[L]().value="";babelHelpers.classPrivateFieldLooseBase(this,P)[P]()}function j(){return babelHelpers.classPrivateFieldLooseBase(this,v)[v].remember("clearButton",(()=>a.Tag.render(p||(p=n`
				<button 
					class="ui-ctl-after ui-ctl-icon-clear" 
					onclick="${0}"
				></button>
			`),babelHelpers.classPrivateFieldLooseBase(this,y)[y].bind(this))))}let K=e=>e,E,S;var I=babelHelpers.classPrivateFieldLooseKey("cache");var A=babelHelpers.classPrivateFieldLooseKey("setOptions");var D=babelHelpers.classPrivateFieldLooseKey("getOptions");var R=babelHelpers.classPrivateFieldLooseKey("onChange");var _=babelHelpers.classPrivateFieldLooseKey("getCheckbox");class w extends i.EventEmitter{constructor(e){super();Object.defineProperty(this,_,{value:k});Object.defineProperty(this,R,{value:x});Object.defineProperty(this,D,{value:X});Object.defineProperty(this,A,{value:M});Object.defineProperty(this,I,{writable:true,value:new a.Cache.MemoryCache});this.setEventNamespace("BX.Crm.Form.Field.Selector.ListItem");this.subscribeFromOptions(e.events);babelHelpers.classPrivateFieldLooseBase(this,A)[A](e);const{targetContainer:s}=e;if(a.Type.isDomNode(s)){this.renderTo(s)}}getField(){return babelHelpers.classPrivateFieldLooseBase(this,D)[D]().field}isSelected(){return babelHelpers.classPrivateFieldLooseBase(this,_)[_]().checked}getLayout(){return babelHelpers.classPrivateFieldLooseBase(this,I)[I].remember("layout",(()=>a.Tag.render(E||(E=K`
				<div class="crm-form-fields-selector-field">
					<label class="ui-ctl ui-ctl-checkbox crm-form-fields-selector-field-checkbox">
						${0}
						<div class="ui-ctl-label-text">${0}</div>
					</label>
				</div>
			`),babelHelpers.classPrivateFieldLooseBase(this,_)[_](),a.Text.encode(babelHelpers.classPrivateFieldLooseBase(this,D)[D]().field.caption))))}renderTo(e){if(a.Type.isDomNode(e)){a.Dom.append(this.getLayout(),e)}}}function M(e){babelHelpers.classPrivateFieldLooseBase(this,I)[I].set("options",{type:w.Type.CHECKBOX,...e})}function X(){return babelHelpers.classPrivateFieldLooseBase(this,I)[I].get("options",{})}function x(){this.emit("onChange")}function k(){return babelHelpers.classPrivateFieldLooseBase(this,I)[I].remember("checkbox",(()=>a.Tag.render(S||(S=K`
				<input 
					type="${0}" 
					class="ui-ctl-element"
					onchange="${0}"
					name="CRM_FIELDS_SELECTOR_ITEM"
					${0}
				>
			`),a.Text.encode(babelHelpers.classPrivateFieldLooseBase(this,D)[D]().type),babelHelpers.classPrivateFieldLooseBase(this,R)[R].bind(this),babelHelpers.classPrivateFieldLooseBase(this,D)[D]().selected?"checked":"")))}w.Type={CHECKBOX:"checkbox",RADIO:"radio"};let N=e=>e,U,$;var V=babelHelpers.classPrivateFieldLooseKey("cache");var G=babelHelpers.classPrivateFieldLooseKey("defaultFilter");var Y=babelHelpers.classPrivateFieldLooseKey("defaultFieldsFactoryFilter");var W=babelHelpers.classPrivateFieldLooseKey("setOptions");var q=babelHelpers.classPrivateFieldLooseKey("getOptions");var z=babelHelpers.classPrivateFieldLooseKey("getBackend");var J=babelHelpers.classPrivateFieldLooseKey("setFieldsList");var Q=babelHelpers.classPrivateFieldLooseKey("applyCategoriesFilter");var Z=babelHelpers.classPrivateFieldLooseKey("applyFieldsFilter");var ee=babelHelpers.classPrivateFieldLooseKey("applySearchFilter");var se=babelHelpers.classPrivateFieldLooseKey("getFieldsList");var te=babelHelpers.classPrivateFieldLooseKey("load");var le=babelHelpers.classPrivateFieldLooseKey("setIsLeadEnabled");var ie=babelHelpers.classPrivateFieldLooseKey("isLeadEnabled");var ae=babelHelpers.classPrivateFieldLooseKey("setIsAllowedCreateField");var re=babelHelpers.classPrivateFieldLooseKey("isAllowedCreateField");var oe=babelHelpers.classPrivateFieldLooseKey("getSidebarItems");var ce=babelHelpers.classPrivateFieldLooseKey("getFilter");var ne=babelHelpers.classPrivateFieldLooseKey("cleanFieldsList");var be=babelHelpers.classPrivateFieldLooseKey("getSelectedFields");var de=babelHelpers.classPrivateFieldLooseKey("addSelectedField");var pe=babelHelpers.classPrivateFieldLooseKey("removeSelectedField");var ve=babelHelpers.classPrivateFieldLooseKey("setSelectedFields");var ue=babelHelpers.classPrivateFieldLooseKey("isMultiple");var Fe=babelHelpers.classPrivateFieldLooseKey("renderCategoryFields");var Pe=babelHelpers.classPrivateFieldLooseKey("onListItemChange");var he=babelHelpers.classPrivateFieldLooseKey("onSidebarItemClick");var Le=babelHelpers.classPrivateFieldLooseKey("onBackendError");var ye=babelHelpers.classPrivateFieldLooseKey("getLayout");var fe=babelHelpers.classPrivateFieldLooseKey("onSearchChange");var He=babelHelpers.classPrivateFieldLooseKey("getSearch");var Be=babelHelpers.classPrivateFieldLooseKey("getFieldsListLayout");var me=babelHelpers.classPrivateFieldLooseKey("getCreateFieldButton");var ge=babelHelpers.classPrivateFieldLooseKey("onCreateFieldClick");var Oe=babelHelpers.classPrivateFieldLooseKey("getPreparedCategoryId");var Ce=babelHelpers.classPrivateFieldLooseKey("getFieldsFactoryTypesFilter");var Te=babelHelpers.classPrivateFieldLooseKey("applyFieldsFactoryTypesFilter");var je=babelHelpers.classPrivateFieldLooseKey("getUserFieldFactory");var Ke=babelHelpers.classPrivateFieldLooseKey("getSliderLayout");var Ee=babelHelpers.classPrivateFieldLooseKey("getRenderedSliderLayout");var Se=babelHelpers.classPrivateFieldLooseKey("onSaveClick");var Ie=babelHelpers.classPrivateFieldLooseKey("setPromiseResolver");var Ae=babelHelpers.classPrivateFieldLooseKey("getPromiseResolver");var De=babelHelpers.classPrivateFieldLooseKey("selectFirstCategory");var Re=babelHelpers.classPrivateFieldLooseKey("getSliderId");class _e extends i.EventEmitter{constructor(e={}){super();Object.defineProperty(this,Re,{value:gs});Object.defineProperty(this,De,{value:ms});Object.defineProperty(this,Ae,{value:Bs});Object.defineProperty(this,Ie,{value:Hs});Object.defineProperty(this,Se,{value:fs});Object.defineProperty(this,Ee,{value:ys});Object.defineProperty(this,Ke,{value:Ls});Object.defineProperty(this,je,{value:hs});Object.defineProperty(this,Te,{value:Ps});Object.defineProperty(this,Ce,{value:Fs});Object.defineProperty(this,Oe,{value:us});Object.defineProperty(this,ge,{value:vs});Object.defineProperty(this,me,{value:ps});Object.defineProperty(this,Be,{value:ds});Object.defineProperty(this,He,{value:bs});Object.defineProperty(this,fe,{value:ns});Object.defineProperty(this,ye,{value:cs});Object.defineProperty(this,Le,{value:os});Object.defineProperty(this,he,{value:rs});Object.defineProperty(this,Pe,{value:as});Object.defineProperty(this,Fe,{value:is});Object.defineProperty(this,ue,{value:ls});Object.defineProperty(this,ve,{value:ts});Object.defineProperty(this,pe,{value:ss});Object.defineProperty(this,de,{value:es});Object.defineProperty(this,be,{value:Ze});Object.defineProperty(this,ne,{value:Qe});Object.defineProperty(this,ce,{value:Je});Object.defineProperty(this,oe,{value:ze});Object.defineProperty(this,re,{value:qe});Object.defineProperty(this,ae,{value:We});Object.defineProperty(this,ie,{value:Ye});Object.defineProperty(this,le,{value:Ge});Object.defineProperty(this,te,{value:Ve});Object.defineProperty(this,se,{value:$e});Object.defineProperty(this,ee,{value:Ue});Object.defineProperty(this,Z,{value:Ne});Object.defineProperty(this,Q,{value:ke});Object.defineProperty(this,J,{value:xe});Object.defineProperty(this,z,{value:Xe});Object.defineProperty(this,q,{value:Me});Object.defineProperty(this,W,{value:we});Object.defineProperty(this,V,{writable:true,value:new a.Cache.MemoryCache});this.setEventNamespace("BX.Crm.Form.Fields.Selector");this.subscribeFromOptions(e.events);babelHelpers.classPrivateFieldLooseBase(this,W)[W](e)}hide(){const e=a.Reflection.getClass("BX.SidePanel");if(e.Instance){e.Instance.close()}}show(){const e=a.Reflection.getClass("BX.SidePanel");if(e.Instance){const s=babelHelpers.classPrivateFieldLooseBase(this,me)[me]();s.setDisabled(!babelHelpers.classPrivateFieldLooseBase(this,re)[re]());e.Instance.open(babelHelpers.classPrivateFieldLooseBase(this,Re)[Re](),{width:740,contentCallback:()=>babelHelpers.classPrivateFieldLooseBase(this,te)[te]().then((()=>{s.setDisabled(!babelHelpers.classPrivateFieldLooseBase(this,re)[re]());babelHelpers.classPrivateFieldLooseBase(this,De)[De]();return babelHelpers.classPrivateFieldLooseBase(this,Ee)[Ee]()})),events:{onClose:()=>{babelHelpers.classPrivateFieldLooseBase(this,ve)[ve]([])}}})}return new Promise((e=>{babelHelpers.classPrivateFieldLooseBase(this,Ie)[Ie](e)}))}}function we(e){babelHelpers.classPrivateFieldLooseBase(this,V)[V].set("options",{filter:{},multiple:true,...e})}function Me(){return a.Runtime.clone(babelHelpers.classPrivateFieldLooseBase(this,V)[V].get("options",{filter:{}}))}function Xe(){return babelHelpers.classPrivateFieldLooseBase(this,V)[V].remember("backend",(()=>new o({events:{onError:babelHelpers.classPrivateFieldLooseBase(this,Le)[Le].bind(this)}})))}function xe(e){babelHelpers.classPrivateFieldLooseBase(this,V)[V].set("fieldsList",{...e})}function ke(e,s){const t=Object.entries(e);return t.reduce(((e,[t,l])=>{if((!a.Type.isArrayFilled(s["+categories"])||s["+categories"].includes(t))&&(!a.Type.isArrayFilled(s["-categories"])||!s["-categories"].includes(t))){e[t]=l}return e}),{})}function Ne(e,s){const t=Object.entries(e);return t.reduce(((e,[t,l])=>{const i=l.FIELDS.filter((e=>{const t=!a.Type.isArrayFilled(s["+fields"])||s["+fields"].some((s=>{if(a.Type.isStringFilled(s)){return e.type===s}if(a.Type.isFunction(s)){return s(e)}if(a.Type.isPlainObject(s)){return Object.entries(s).every((([s,t])=>e[s]===t))}return false}));const l=a.Type.isArrayFilled(s["-fields"])&&s["-fields"].some((s=>{if(a.Type.isStringFilled(s)){return e.type===s}if(a.Type.isFunction(s)){return s(e)}if(a.Type.isPlainObject(s)){return Object.entries(s).every((([s,t])=>e[s]===t))}return false}));return t&&!l}));if(a.Type.isArrayFilled(i)){e[t]={...l,FIELDS:i}}return e}),{})}function Ue(e,s){const t=Object.entries(e);if(a.Type.isStringFilled(s)){const e=String(s).toLowerCase();return t.reduce(((s,[t,l])=>{const i=l.FIELDS.filter((s=>a.Type.isStringFilled(s.caption)&&String(s.caption).toLowerCase().includes(e)));if(a.Type.isArrayFilled(i)){s[t]={...l,FIELDS:i}}return s}),{})}return e}function $e(){const e=babelHelpers.classPrivateFieldLooseBase(this,V)[V].get("fieldsList",{});const s=babelHelpers.classPrivateFieldLooseBase(this,ce)[ce]();if(a.Type.isPlainObject(s)){const t=babelHelpers.classPrivateFieldLooseBase(this,He)[He]().getValue();return babelHelpers.classPrivateFieldLooseBase(this,ee)[ee](babelHelpers.classPrivateFieldLooseBase(this,Z)[Z](babelHelpers.classPrivateFieldLooseBase(this,Q)[Q](e,s),s),t)}if(a.Type.isFunction(s)){const t=a.Runtime.clone(babelHelpers.classPrivateFieldLooseBase(_e,G)[G]);if(!babelHelpers.classPrivateFieldLooseBase(this,ie)[ie]()){t["-categories"].push("LEAD")}const l=babelHelpers.classPrivateFieldLooseBase(this,Z)[Z](babelHelpers.classPrivateFieldLooseBase(this,Q)[Q](e,t),s);return s(a.Runtime.clone(l))}return e}function Ve(){const{controllerOptions:e={}}=babelHelpers.classPrivateFieldLooseBase(this,q)[q]();return babelHelpers.classPrivateFieldLooseBase(this,z)[z]().getData({options:e}).then((({data:e})=>{babelHelpers.classPrivateFieldLooseBase(this,J)[J](e.fields);babelHelpers.classPrivateFieldLooseBase(this,le)[le](e.options.isLeadEnabled);babelHelpers.classPrivateFieldLooseBase(this,ae)[ae](e.options.permissions.userField.add)}))}function Ge(e){babelHelpers.classPrivateFieldLooseBase(this,V)[V].set("isLeadEnabled",e)}function Ye(){return babelHelpers.classPrivateFieldLooseBase(this,V)[V].get("isLeadEnabled")}function We(e){babelHelpers.classPrivateFieldLooseBase(this,V)[V].set("isAllowedCreateField",e)}function qe(){return babelHelpers.classPrivateFieldLooseBase(this,V)[V].get("isAllowedCreateField",false)}function ze(){return Object.entries(babelHelpers.classPrivateFieldLooseBase(this,se)[se]()).map((([e,s])=>({label:s.CAPTION,id:e,onclick:babelHelpers.classPrivateFieldLooseBase(this,he)[he].bind(this,e)})))}function Je(){const e=babelHelpers.classPrivateFieldLooseBase(this,q)[q]().filter;if(a.Type.isPlainObject(e)){const s=babelHelpers.classPrivateFieldLooseBase(_e,G)[G];if(a.Type.isArray(e["-categories"])){e["-categories"]=[...e["-categories"],...s["-categories"]]}else{e["-categories"]=[...s["-categories"]]}if(!babelHelpers.classPrivateFieldLooseBase(this,ie)[ie]()){e["-categories"].push("LEAD")}if(a.Type.isArray(e["-fields"])){e["-fields"]=[...e["-fields"],...s["-fields"]]}else{e["-fields"]=[...s["-fields"]]}}return e}function Qe(){a.Dom.clean(babelHelpers.classPrivateFieldLooseBase(this,Be)[Be]())}function Ze(){return babelHelpers.classPrivateFieldLooseBase(this,V)[V].get("selectedFields",[])}function es(e){const s=babelHelpers.classPrivateFieldLooseBase(this,be)[be]();const t=s.some((s=>s.name===e.name));if(!t){s.push(e);babelHelpers.classPrivateFieldLooseBase(this,ve)[ve](s)}}function ss(e){const s=babelHelpers.classPrivateFieldLooseBase(this,be)[be]().filter((s=>s.name!==e.name));babelHelpers.classPrivateFieldLooseBase(this,ve)[ve](s)}function ts(e){babelHelpers.classPrivateFieldLooseBase(this,V)[V].set("selectedFields",e)}function ls(){return babelHelpers.classPrivateFieldLooseBase(this,q)[q]().multiple}function is(e){babelHelpers.classPrivateFieldLooseBase(this,ne)[ne]();const s=babelHelpers.classPrivateFieldLooseBase(this,se)[se]()[e].FIELDS;if(a.Type.isArrayFilled(s)){s.forEach((e=>{void new w({field:e,targetContainer:babelHelpers.classPrivateFieldLooseBase(this,Be)[Be](),events:{onChange:babelHelpers.classPrivateFieldLooseBase(this,Pe)[Pe].bind(this)},selected:babelHelpers.classPrivateFieldLooseBase(this,be)[be]().some((s=>s.name===e.name)),type:babelHelpers.classPrivateFieldLooseBase(this,ue)[ue]()?w.Type.CHECKBOX:w.Type.RADIO})}))}}function as(e){const s=e.getTarget();if(babelHelpers.classPrivateFieldLooseBase(this,ue)[ue]()){if(s.isSelected()){babelHelpers.classPrivateFieldLooseBase(this,de)[de](s.getField())}else{babelHelpers.classPrivateFieldLooseBase(this,pe)[pe](s.getField())}}else{babelHelpers.classPrivateFieldLooseBase(this,ve)[ve]([s.getField()])}}function rs(e){babelHelpers.classPrivateFieldLooseBase(this,Fe)[Fe](e)}function os(e){console.error(e);this.emit("onError",{error:e})}function cs(){return a.Tag.render(U||(U=N`
			<div class="crm-form-fields-selector">
				${0}
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,Be)[Be]())}async function ns(){const e=await babelHelpers.classPrivateFieldLooseBase(this,Ke)[Ke]();const s=babelHelpers.classPrivateFieldLooseBase(this,oe)[oe]();e.getMenu().setItems(s);babelHelpers.classPrivateFieldLooseBase(this,ne)[ne]();const[t]=s;if(t){babelHelpers.classPrivateFieldLooseBase(this,he)[he](t.id);e.getMenu().setActiveFirstItem();if(babelHelpers.classPrivateFieldLooseBase(this,re)[re]()){babelHelpers.classPrivateFieldLooseBase(this,me)[me]().setDisabled(false)}}else{if(babelHelpers.classPrivateFieldLooseBase(this,re)[re]()){babelHelpers.classPrivateFieldLooseBase(this,me)[me]().setDisabled(true)}}}function bs(){return babelHelpers.classPrivateFieldLooseBase(this,V)[V].remember("search",(()=>new H({events:{onChange:babelHelpers.classPrivateFieldLooseBase(this,fe)[fe].bind(this)}})))}function ds(){return babelHelpers.classPrivateFieldLooseBase(this,V)[V].remember("fieldsListLayout",(()=>a.Tag.render($||($=N`
				<div class="crm-form-fields-selector-fields-list"></div>
			`))))}function ps(){return babelHelpers.classPrivateFieldLooseBase(this,V)[V].remember("createFieldButton",(()=>new l.Button({text:a.Loc.getMessage("CRM_FORM_FIELDS_SELECTOR_CREATE_BUTTON_LABEL"),color:l.Button.Color.SUCCESS,onclick:babelHelpers.classPrivateFieldLooseBase(this,ge)[ge].bind(this)})))}async function vs(){const e=await babelHelpers.classPrivateFieldLooseBase(this,Ke)[Ke]();const s=e.getMenu();if(s.hasActive()){const e=s.getActiveItem().getId();const t=babelHelpers.classPrivateFieldLooseBase(this,je)[je](e);const l=t.getMenu();l.open((s=>{const l=t.getConfigurator({userField:t.createUserField(s),onSave:s=>{a.Dom.addClass(l.saveButton,"ui-btn-wait");return s.save().then((()=>babelHelpers.classPrivateFieldLooseBase(this,te)[te]())).then((()=>{a.Dom.removeClass(l.saveButton,"ui-btn-wait");babelHelpers.classPrivateFieldLooseBase(this,he)[he](e);babelHelpers.classPrivateFieldLooseBase(this,He)[He]().setValue(s.getData().editFormLabel[a.Loc.getMessage("LANGUAGE_ID")])}))},onCancel:()=>{babelHelpers.classPrivateFieldLooseBase(this,he)[he](e)}});babelHelpers.classPrivateFieldLooseBase(this,ne)[ne]();a.Dom.append(l.render(),babelHelpers.classPrivateFieldLooseBase(this,Be)[Be]())}))}}function us(e){if(e.startsWith("DYNAMIC_")){const s=babelHelpers.classPrivateFieldLooseBase(this,se)[se]();if(a.Type.isPlainObject(s[e])){return s[e].DYNAMIC_ID}}return`CRM_${e}`}function Fs(){var e,s;const t=a.Runtime.clone(babelHelpers.classPrivateFieldLooseBase(_e,Y)[Y]);const l=(e=babelHelpers.classPrivateFieldLooseBase(this,q)[q]())==null?void 0:(s=e.fieldsFactory)==null?void 0:s.filter;if(a.Type.isPlainObject(l)){if(a.Type.isArrayFilled(l["-types"])){l["-types"]=[...t["-types"],...l["-types"]]}else{l["-types"]=[...t["-types"]]}return l}if(a.Type.isFunction(l)){return l}return t}function Ps(e,s){if(a.Type.isPlainObject(s)){return e.filter((e=>{const t=!a.Type.isArrayFilled(s["+types"])||s["+types"].some((s=>{if(a.Type.isStringFilled(s)){return e.name===s}if(a.Type.isFunction(s)){return s(e)}return false}));const l=a.Type.isArrayFilled(s["-types"])&&s["-types"].some((s=>{if(a.Type.isStringFilled(s)){return e.name===s}if(a.Type.isFunction(s)){return s(e)}return false}));return t&&!l}))}return e}function hs(e){return babelHelpers.classPrivateFieldLooseBase(this,V)[V].remember(`factory_${e}`,(()=>{const s=window.top;const t=(()=>{if(s.BX.UI.UserFieldFactory){return s.BX.UI.UserFieldFactory.Factory}return BX.UI.UserFieldFactory.Factory})();const l=new t(babelHelpers.classPrivateFieldLooseBase(this,Oe)[Oe](e),{moduleId:"crm",bindElement:babelHelpers.classPrivateFieldLooseBase(this,me)[me]().render()});const i=babelHelpers.classPrivateFieldLooseBase(this,Ce)[Ce]();if(a.Type.isFunction(i)){l.types=babelHelpers.classPrivateFieldLooseBase(this,Te)[Te](l.types,_e.defaultFieldsFactoryFilter);l.types=i(l.types)}if(a.Type.isPlainObject(i)){l.types=babelHelpers.classPrivateFieldLooseBase(this,Te)[Te](l.types,i)}return l}))}function Ls(){return babelHelpers.classPrivateFieldLooseBase(this,V)[V].remember("sliderLayout",(()=>new Promise((e=>{s.Layout.createLayout({extensions:["crm.form.fields.selector"],title:a.Loc.getMessage("CRM_FORM_FIELDS_SELECTOR_SLIDER_TITLE"),content:()=>babelHelpers.classPrivateFieldLooseBase(this,ye)[ye](),menu:{items:babelHelpers.classPrivateFieldLooseBase(this,oe)[oe]()},toolbar:()=>[babelHelpers.classPrivateFieldLooseBase(this,He)[He]().getLayout(),babelHelpers.classPrivateFieldLooseBase(this,me)[me]()],buttons:({SaveButton:e,closeButton:s})=>[new e({text:a.Loc.getMessage("CRM_FORM_FIELDS_SELECTOR_APPLY_BUTTON_LABEL"),onclick:babelHelpers.classPrivateFieldLooseBase(this,Se)[Se].bind(this)}),s]}).then((s=>{e(s)}))}))))}function ys(){return babelHelpers.classPrivateFieldLooseBase(this,V)[V].remember("renderedSliderLayout",(()=>babelHelpers.classPrivateFieldLooseBase(this,Ke)[Ke]().then((e=>e.render()))))}function fs(){const e=babelHelpers.classPrivateFieldLooseBase(this,be)[be]();const s=(()=>{const{resultModifier:s}=babelHelpers.classPrivateFieldLooseBase(this,q)[q]();if(a.Type.isFunction(s)){return s(e)}return e.map((e=>e.name))})();babelHelpers.classPrivateFieldLooseBase(this,Ae)[Ae]()(s);this.hide()}function Hs(e){babelHelpers.classPrivateFieldLooseBase(this,V)[V].set("promiseResolver",e)}function Bs(){return babelHelpers.classPrivateFieldLooseBase(this,V)[V].get("promiseResolver",(()=>{}))}function ms(){const[e]=babelHelpers.classPrivateFieldLooseBase(this,oe)[oe]();if(a.Type.isPlainObject(e)){babelHelpers.classPrivateFieldLooseBase(this,he)[he](e.id)}}function gs(){return babelHelpers.classPrivateFieldLooseBase(this,V)[V].remember("sliderId",(()=>`crm.form.fields.selector-${a.Text.getRandom()}`))}Object.defineProperty(_e,G,{writable:true,value:{"-categories":["CATALOG","ACTIVITY","INVOICE"],"-fields":[{name:"CONTACT_ORIGIN_VERSION"},{name:"CONTACT_LINK"}]}});Object.defineProperty(_e,Y,{writable:true,value:{"-types":["employee"]}});e.Selector=_e})(this.BX.Crm.Form.Fields=this.BX.Crm.Form.Fields||{},BX.UI.SidePanel,BX.UI.UserFieldFactory,BX.UI,BX.Event,BX);
//# sourceMappingURL=selector.bundle.map.js