{"version":3,"file":"embed.bundle.js","sources":["../src/embed.js"],"sourcesContent":["import {Dom, Loc, Tag, Text, Type} from 'main.core';\nimport {Layout} from 'ui.sidepanel.layout';\nimport './embed.css';\n\ntype EmbedOptions = {\n\tonCloseComplete: function;\n\twidgetsCount: number;\n\tactiveMenuItemId: ?string;\n};\n\ntype EmbedDictPhrase = {\n\tid: string,\n\tname: string,\n}\n\ntype Widget = {\n\tchecked: boolean,\n\tid: number,\n\tname: string,\n\trelatedFormIds: number[],\n\trelatedFormNames: {\n\t\t[key:number]: string,\n\t},\n}\n\ntype Line = {\n\tchecked: boolean,\n\tid: number,\n\tname: string,\n\tformEnabled: boolean,\n\tformId: number,\n\tformName: string,\n\tformDelay: boolean,\n}\n\ntype EmbedDict = {\n\tviewOptions: {\n\t\tdelays: EmbedDictPhrase[],\n\t\tpositions: EmbedDictPhrase[],\n\t\ttypes: EmbedDictPhrase[],\n\t\tverticals: EmbedDictPhrase[],\n\t},\n};\n\ntype EmbedData = {\n\tdict: EmbedDict,\n\tembed: {\n\t\tpubLink: string,\n\t\tscripts: {\n\t\t\tauto: {old: string, text: string},\n\t\t\tclick: {old: string, text: string},\n\t\t\tinline: {old: string, text: string},\n\t\t},\n\t\tviewOptions: {\n\t\t\t[key:string]: {\n\t\t\t\t[key:string]: Array,\n\t\t\t},\n\t\t},\n\t\tviewValues: {\n\t\t\t[key:string]: object,\n\t\t},\n\t},\n};\n\ntype WidgetsList = {\n\t[key:number]: Widget,\n}\n\ntype WidgetsData = {\n\tformName: string,\n\tformType: string,\n\tshowMoreLink: boolean,\n\turl: {\n\t\tallWidgets: string,\n\t},\n\twidgets: WidgetsList,\n};\n\ntype LinesList = {\n\t[key:number]: Line,\n}\n\ntype OpenlinesData = {\n\tformName: string,\n\tshowMoreLink: boolean,\n\turl: {\n\t\tallLines: string,\n\t},\n\tlines: LinesList,\n};\n\nconst DEFAULT_WIDGETS_COUNT = 10;\nconst ERROR_CODE_FORM_READ_ACCESS_DENIED = 1;\nconst ERROR_CODE_FORM_WRITE_ACCESS_DENIED = 2;\nconst ERROR_CODE_WIDGET_READ_ACCESS_DENIED = 3;\nconst ERROR_CODE_WIDGET_WRITE_ACCESS_DENIED = 4;\nconst ERROR_CODE_OPENLINES_READ_ACCESS_DENIED = 5;\nconst ERROR_CODE_OPENLINES_WRITE_ACCESS_DENIED = 6;\n\nexport class Embed\n{\n\t/**\n\t * @public\n\t * @access public\n\t */\n\tstatic open(\n\t\tformId: number,\n\t\toptions: EmbedOptions = {\n\t\t\twidgetsCount: DEFAULT_WIDGETS_COUNT,\n\t\t\tactiveMenuItemId: 'inline',\n\t\t}\n\t)\n\t{\n\t\tBX.SidePanel.Instance.open(\"crm.webform:embed\", {\n\t\t\twidth: 900,\n\t\t\tcacheable: false,\n\t\t\tevents: {\n\t\t\t\tonCloseComplete: (event) => {\n\t\t\t\t\t// const slider = event.getSlider();\n\t\t\t\t\tif (Type.isFunction(options.onCloseComplete))\n\t\t\t\t\t{\n\t\t\t\t\t\toptions.onCloseComplete();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t// onLoad: (event) => {\n\t\t\t\t// \tBX.UI.Switcher.initByClassName();\n\t\t\t\t// }\n\t\t\t},\n\t\t\tcontentCallback: () => {\n\n\t\t\t\tconst menuItems = [\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: Loc.getMessage('EMBED_SLIDER_INLINE_HEADING1'),\n\t\t\t\t\t\tid: 'inline',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: Loc.getMessage('EMBED_SLIDER_CLICK_HEADING1'),\n\t\t\t\t\t\tid: 'click',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: Loc.getMessage('EMBED_SLIDER_AUTO_HEADING1'),\n\t\t\t\t\t\tid: 'auto',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: Loc.getMessage('EMBED_SLIDER_WIDGET_HEADER'),\n\t\t\t\t\t\tid: 'widgets',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: Loc.getMessage('EMBED_SLIDER_OPENLINES_HEADER'),\n\t\t\t\t\t\tid: 'openlines',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: Loc.getMessage('EMBED_SLIDER_PUBLIC_LINK'),\n\t\t\t\t\t\tid: 'link',\n\t\t\t\t\t},\n\t\t\t\t];\n\t\t\t\tmenuItems.forEach(item => item.active = item.id === options.activeMenuItemId);\n\n\t\t\t\treturn Layout.createContent({\n\t\t\t\t\textensions: ['crm.form.embed', 'ui.forms', 'ui.sidepanel-content', 'clipboard', 'ui.switcher', 'ui.notification'],\n\t\t\t\t\ttitle: BX.Loc.getMessage('EMBED_SLIDER_TITLE'),\n\t\t\t\t\tdesign: {\n\t\t\t\t\t\tsection: false,\n\t\t\t\t\t},\n\t\t\t\t\tmenu: {\n\t\t\t\t\t\titems: menuItems,\n\t\t\t\t\t},\n\t\t\t\t\tcontent ()\n\t\t\t\t\t{\n\t\t\t\t\t\treturn BX.ajax.runAction('crm.form.getEmbed', {\n\t\t\t\t\t\t\tjson: {\n\t\t\t\t\t\t\t\tformId: formId\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}).then((response) => {\n\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\tembedData: response.data,\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t}).then((responseEmbed) => {\n\t\t\t\t\t\t\treturn BX.ajax.runAction('crm.form.getWidgetsForEmbed', {\n\t\t\t\t\t\t\t\tjson: {\n\t\t\t\t\t\t\t\t\tformId: formId,\n\t\t\t\t\t\t\t\t\tcount: options.widgetsCount,\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}).then((response) => {\n\t\t\t\t\t\t\t\tresponseEmbed.widgetsData = response.data;\n\t\t\t\t\t\t\t\treturn responseEmbed;\n\t\t\t\t\t\t\t}).catch((response) => {\n\t\t\t\t\t\t\t\tif (Type.isObject(response.data) && Type.isObject(response.data.error) && response.data.error.status === 'access denied')\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tresponseEmbed.widgetsData = null;\n\t\t\t\t\t\t\t\t\treturn responseEmbed;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tthrow new Error(BX.Loc.getMessage('EMBED_SLIDER_GENERAL_ERROR'));\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}).then((responseWidgets) => {\n\t\t\t\t\t\t\treturn BX.ajax.runAction('crm.form.getOpenlinesForEmbed', {\n\t\t\t\t\t\t\t\tjson: {\n\t\t\t\t\t\t\t\t\tformId: formId,\n\t\t\t\t\t\t\t\t\tcount: options.widgetsCount,\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}).then((response) => {\n\t\t\t\t\t\t\t\tresponseWidgets.openlinesData = response.data;\n\t\t\t\t\t\t\t\treturn responseWidgets;\n\t\t\t\t\t\t\t}).catch((response) => {\n\t\t\t\t\t\t\t\tif (Type.isObject(response.data) && Type.isObject(response.data.error) && response.data.error.status === 'access denied')\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tresponseWidgets.openlinesData = null;\n\t\t\t\t\t\t\t\t\treturn responseWidgets;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tthrow new Error(BX.Loc.getMessage('EMBED_SLIDER_GENERAL_ERROR'));\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}).then((result) => {\n\t\t\t\t\t\t\treturn Embed.#renderSliderContent(\n\t\t\t\t\t\t\t\tformId,\n\t\t\t\t\t\t\t\tresult.embedData,\n\t\t\t\t\t\t\t\tresult.widgetsData,\n\t\t\t\t\t\t\t\tresult.openlinesData,\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}).catch((response) => {\n\t\t\t\t\t\t\tlet errorMessage = BX.Loc.getMessage('EMBED_SLIDER_GENERAL_ERROR');\n\n\t\t\t\t\t\t\tif (Type.isObject(response.data) && Type.isObject(response.data.error) && response.data.error.status === 'access denied')\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tif (response.data.error.code === ERROR_CODE_FORM_READ_ACCESS_DENIED)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\terrorMessage = BX.Loc.getMessage('EMBED_SLIDER_FORM_ACCESS_DENIED');\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\treturn Tag.render`\n\t\t\t\t\t\t\t\t<div class=\"ui-alert ui-alert-warning\">\n\t\t\t\t\t\t\t\t\t<span class=\"ui-alert-message\">${errorMessage}</span>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t`;\n\t\t\t\t\t\t});\n\t\t\t\t\t},\n\t\t\t\t\tbuttons ({closeButton})\n\t\t\t\t\t{\n\t\t\t\t\t\treturn [closeButton];\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t},\n\t\t});\n\t}\n\n\t/**\n\t * @this Switcher\n\t * @param formId number\n\t * @param widgetId number\n\t * @package\n\t */\n\tstatic #handleToggledWidgetSwitcher(formId: number, widgetId: number)\n\t{\n\t\tthis.setLoading(true);\n\n\t\t// save old widget values for rollback on error\n\t\tconst dataSetOld = this.getNode().closest('.crm-form-embed-widgets-block').querySelector('.crm-form-embed-widgets-detail').dataset;\n\t\tconst formNameOld = dataSetOld.formName;\n\t\tconst formTypeOld = dataSetOld.formType;\n\n\t\t// get values for current form\n\t\tconst dataSetCurrent = this.getNode().closest('.crm-form-embed-widgets').dataset;\n\t\tconst formName = dataSetCurrent.formName;\n\t\tconst formType = dataSetCurrent.formType;\n\n\t\t// set related forms field to new values\n\t\tEmbed.#updateRelatedForms(this.isChecked(), formName, formType, this);\n\n\t\treturn BX.ajax.runAction('crm.form.assignWidgetToForm', {\n\t\t\tjson: {\n\t\t\t\tformId: formId,\n\t\t\t\tbuttonId: widgetId,\n\t\t\t\tassigned: this.isChecked() ? 'Y' : 'N',\n\t\t\t}\n\t\t}).then((response) => {\n\t\t\tthis.setLoading(false);\n\n\t\t\t// set to returned values (must match current)\n\t\t\tthis.check(response.data.assigned, false);\n\t\t\tEmbed.#updateRelatedForms(this.isChecked(), response.data.formName, response.data.formType, this);\n\n\t\t\ttop.BX.UI.Notification.Center.notify({\n\t\t\t\tcontent: BX.Loc.getMessage('EMBED_SLIDER_OPENLINES_FORM_ALERT_SETTINGS_SAVED'),\n\t\t\t});\n\t\t}).catch((response) => {\n\t\t\tthis.setLoading(false);\n\n\t\t\t// rollback on error\n\t\t\tthis.check(! this.isChecked(), false);\n\t\t\tEmbed.#updateRelatedForms(formNameOld.length > 0, formNameOld, formTypeOld, this);\n\n\t\t\tlet messageId = 'EMBED_SLIDER_WIDGET_FORM_ALERT_ERROR';\n\t\t\tif (! Type.isUndefined(response.data.error.status) && response.data.error.status === 'access denied')\n\t\t\t{\n\t\t\t\tmessageId = response.data.error.code === ERROR_CODE_WIDGET_WRITE_ACCESS_DENIED\n\t\t\t\t\t? 'EMBED_SLIDER_WIDGET_FORM_ALERT_ERROR_ACCESS_DENIED_WIDGET'\n\t\t\t\t\t: 'EMBED_SLIDER_WIDGET_FORM_ALERT_ERROR_ACCESS_DENIED_FORM';\n\t\t\t}\n\n\t\t\ttop.BX.UI.Notification.Center.notify({\n\t\t\t\tcontent: BX.Loc.getMessage(messageId),\n\t\t\t});\n\t\t});\n\t}\n\n\t/**\n\t * @this Switcher\n\t * @param formId number\n\t * @param lineId number\n\t * @package\n\t */\n\tstatic #handleToggledLineSwitcher(formId: number, lineId: number)\n\t{\n\t\tthis.setLoading(true);\n\n\t\t// save old widget values for rollback on error\n\t\tconst formNameOld = this.getNode().closest('.crm-form-embed-widgets-block').querySelector('.crm-form-embed-widgets-detail').dataset.formName;\n\t\t// get values for current form\n\t\tconst formName = this.getNode().closest('.crm-form-embed-widgets').dataset.formName;\n\t\t// set related forms field to new values\n\t\tEmbed.#updateRelatedOpenlineForms(this.isChecked() ? formName : '', this);\n\n\t\treturn BX.ajax.runAction('crm.form.assignOpenlinesToForm', {\n\t\t\tjson: {\n\t\t\t\tformId: formId,\n\t\t\t\tlineId: lineId,\n\t\t\t\tassigned: this.isChecked() ? 'Y' : 'N',\n\t\t\t\t// afterMessage: 'N',\n\t\t\t}\n\t\t}).then((response) => {\n\t\t\tthis.setLoading(false);\n\n\t\t\t// set to returned values (must match current)\n\t\t\tthis.check(response.data.assigned, false);\n\t\t\tEmbed.#updateRelatedOpenlineForms(this.isChecked() ? response.data.formName : '', this);\n\n\t\t\ttop.BX.UI.Notification.Center.notify({\n\t\t\t\tcontent: BX.Loc.getMessage('EMBED_SLIDER_OPENLINES_FORM_ALERT_SETTINGS_SAVED'),\n\t\t\t});\n\t\t}).catch((response) => {\n\t\t\tthis.setLoading(false);\n\n\t\t\t// rollback on error\n\t\t\tthis.check(! this.isChecked(), false);\n\t\t\tEmbed.#updateRelatedOpenlineForms(formNameOld.length > 0 ? formNameOld : '' , this);\n\n\t\t\tlet messageId = 'EMBED_SLIDER_OPENLINES_FORM_ALERT_ERROR';\n\t\t\tif (! Type.isUndefined(response.data.error.status) && response.data.error.status === 'access denied')\n\t\t\t{\n\t\t\t\tmessageId = response.data.error.code === ERROR_CODE_OPENLINES_WRITE_ACCESS_DENIED\n\t\t\t\t\t? 'EMBED_SLIDER_WIDGET_FORM_ALERT_ERROR_ACCESS_DENIED' // 'EMBED_SLIDER_WIDGET_FORM_ALERT_ERROR_ACCESS_DENIED_OPENLINES'\n\t\t\t\t\t: 'EMBED_SLIDER_WIDGET_FORM_ALERT_ERROR_ACCESS_DENIED_FORM';\n\t\t\t}\n\n\t\t\ttop.BX.UI.Notification.Center.notify({\n\t\t\t\tcontent: BX.Loc.getMessage(messageId),\n\t\t\t});\n\t\t});\n\t}\n\n\tstatic #updateRelatedOpenlineForms(formName: string, switcher: Switcher)\n\t{\n\t\tconst elem = switcher.getNode().closest('.crm-form-embed-widgets-block').querySelector('.crm-form-embed-widgets-detail');\n\t\telem.textContent = formName;\n\t\telem.setAttribute('data-form-name', formName);\n\t}\n\n\tstatic #updateRelatedForms(assign: boolean, formName: string, formType: string, switcher: Switcher)\n\t{\n\t\tassign\n\t\t\t? Embed.#setRelatedForms(switcher, formName, formType)\n\t\t\t: Embed.#clearRelatedForms(switcher);\n\t}\n\n\tstatic #setRelatedForms(switcher: Switcher, formName: string, formType: string)\n\t{\n\t\tconst formTypeMessage = Embed.#getFormTypeMessage(formType);\n\t\tconst elem = switcher.getNode().closest('.crm-form-embed-widgets-block').querySelector('.crm-form-embed-widgets-detail');\n\t\telem.textContent = formTypeMessage + ': ' + formName;\n\t\telem.setAttribute('data-form-name', formName);\n\t\telem.setAttribute('data-form-type', formTypeMessage);\n\t}\n\n\tstatic #clearRelatedForms(switcher: Switcher)\n\t{\n\t\tconst elem = switcher.getNode().closest('.crm-form-embed-widgets-block').querySelector('.crm-form-embed-widgets-detail');\n\t\telem.textContent = '';\n\t\telem.setAttribute('data-form-name', '');\n\t\telem.setAttribute('data-form-type', '');\n\t}\n\n\tstatic #getFormTypeMessage(formType: string)\n\t{\n\t\tconst formTypeLangKey = 'EMBED_SLIDER_WIDGET_FORM_TYPE_MESSAGE_' + formType.toUpperCase();\n\t\treturn BX.Loc.hasMessage(formTypeLangKey) ? BX.Loc.getMessage(formTypeLangKey) : formType;\n\t}\n\n\tstatic #getFormTypeName(formType: string)\n\t{\n\t\tconst formTypeLangKey = 'EMBED_SLIDER_WIDGET_FORM_TYPE_' + formType.toUpperCase();\n\t\treturn BX.Loc.hasMessage(formTypeLangKey) ? BX.Loc.getMessage(formTypeLangKey) : formType;\n\t}\n\n\tstatic #renderSliderContent(formId: number, embedData: EmbedData, widgetsData: WidgetsData, openlinesData: OpenlinesData): string\n\t{\n\t\tconst widgetBox = Embed.#renderWidgets(formId, widgetsData);\n\n\t\tconst openlinesBox = Embed.#renderOpenlines(formId, openlinesData);\n\n\t\tconst pubLinkBox = Tag.render`\n\t\t\t<div class=\"ui-slider-section\" data-menu-item-id=\"link\">\n\t\t\t\t<div class=\"ui-slider-content-box\">\n\t\t\t\t\t<div class=\"ui-slider-heading-3\">${BX.Loc.getMessage('EMBED_SLIDER_PUBLIC_LINK')}</div>\n\t\t\t\t\t<div class=\"ui-slider-inner-box\">\n\t\t\t\t\t\t<div class=\"ui-slider-paragraph\">\n\t\t\t\t\t\t\t${BX.Loc.getMessage('EMBED_SLIDER_PUBLIC_LINK_HEADER')}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"crm-form-embed-inner-section\">\n\t\t\t\t\t\t\t<div class=\"crm-form-embed-script crm-form-embed-publink\"><a href=\"${Text.encode(embedData.embed.pubLink)}\" target=\"_blank\">${Text.encode(embedData.embed.pubLink)}</a></div>\n\t\t\t\t\t\t\t<button class=\"ui-btn ui-btn-md ui-btn-primary crm-form-embed-btn-copy\">${BX.Loc.getMessage('EMBED_SLIDER_COPY_BUTTON')}</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\ttop.BX.clipboard.bindCopyClick(pubLinkBox.querySelector('.crm-form-embed-btn-copy'), {text: pubLinkBox.querySelector('.crm-form-embed-script')});\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"crm-form-embed-slider-wrapper\">\n\t\t\t\t${pubLinkBox}\n\t\t\t\t${widgetBox}\n\t\t\t\t${openlinesBox}\n\t\t\t\t${Embed.#renderCodeBlockWrapper(formId, 'inline', embedData, 'inline')}\n\t\t\t\t${Embed.#renderCodeBlockWrapper(formId, 'click', embedData, 'click')}\n\t\t\t\t${Embed.#renderCodeBlockWrapper(formId, 'auto', embedData, 'auto')}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tstatic #renderCodeBlockWrapper(formId: number, type: string, embedData: EmbedData, blockId: string)\n\t{\n\t\tconst viewOptions = Type.isObject(embedData.embed.viewOptions[type]) ? embedData.embed.viewOptions[type] : {},\n\t\t\tviewValues = Type.isObject(embedData.embed.viewValues[type]) ? embedData.embed.viewValues[type] : {};\n\n\t\treturn Embed.#renderCodeBlock(\n\t\t\tBX.Loc.getMessage('EMBED_SLIDER_' + blockId.toUpperCase() + '_HEADING1'),\n\t\t\tBX.Loc.getMessage('EMBED_SLIDER_' + blockId.toUpperCase() + '_HEADING2'),\n\t\t\tBX.Loc.getMessage('EMBED_SLIDER_' + blockId.toUpperCase() + '_DESCRIPTION'),\n\t\t\tembedData.embed.scripts[type].text,\n\t\t\tviewValues,\n\t\t\tviewOptions,\n\t\t\tembedData.dict,\n\t\t\ttype,\n\t\t\tformId,\n\t\t\tblockId\n\t\t);\n\t}\n\n\tstatic #renderWidgets(formId: number, widgetsData: WidgetsData)\n\t{\n\t\tif (Type.isNull(widgetsData))\n\t\t{\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-slider-section\" data-menu-item-id=\"widgets\">\n\t\t\t\t\t<div class=\"ui-slider-content-box\">\n\t\t\t\t\t\t<div class=\"ui-slider-heading-3\">${BX.Loc.getMessage('EMBED_SLIDER_WIDGET_HEADER')}</div>\n\t\t\t\t\t\t<div class=\"ui-slider-inner-box\">\n\t\t\t\t\t\t\t<div class=\"ui-slider-paragraph\">\n\t\t\t\t\t\t\t\t${BX.Loc.getMessage('EMBED_SLIDER_WIDGET_HEADER_INNER')}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"ui-alert ui-alert-warning\">\n\t\t\t\t\t\t\t\t<span class=\"ui-alert-message\">${BX.Loc.getMessage('EMBED_SLIDER_WIDGET_ACCESS_DENIED')}</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\tconst allIds = Object.keys(widgetsData.widgets);\n\t\tconst allWidgetsUrl = Type.isStringFilled(widgetsData.url.allWidgets) ? widgetsData.url.allWidgets : '/crm/button/';\n\n\t\tlet widgetsInner;\n\t\tif (allIds.length === 0)\n\t\t{\n\t\t\twidgetsInner = BX.Loc.getMessage('EMBED_SLIDER_WIDGET_EMPTY');\n\t\t}\n\t\telse\n\t\t{\n\t\t\twidgetsInner = Embed.#renderWidgetsList(widgetsData.widgets, formId, widgetsData.formName, widgetsData.formType);\n\t\t}\n\n\t\tconst widgetBox = Tag.render`\n\t\t\t<div class=\"ui-slider-section\" data-menu-item-id=\"widgets\">\n\t\t\t\t<div class=\"ui-slider-content-box\">\n\t\t\t\t\t<div class=\"ui-slider-heading-3\">${BX.Loc.getMessage('EMBED_SLIDER_WIDGET_HEADER')}</div>\n\t\t\t\t\t<div class=\"ui-slider-inner-box\">\n\t\t\t\t\t\t<div class=\"ui-slider-paragraph\">\n\t\t\t\t\t\t\t${BX.Loc.getMessage('EMBED_SLIDER_WIDGET_HEADER_INNER')}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<!--<p class=\"ui-slider-paragraph-2\"></p>-->\n\t\t\t\t\t\t<div class=\"crm-form-embed-inner-section\">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\twidgetBox.querySelector('.crm-form-embed-inner-section').append(widgetsInner);\n\n\t\tif (widgetsData.showMoreLink)\n\t\t{\n\t\t\tconst showMoreLink = Tag.render`\n\t\t\t\t<p class=\"crm-form-embed-widgets-all-buttons\">\n\t\t\t\t\t<a href=\"${Text.encode(allWidgetsUrl)}\" target=\"_blank\" onclick=\"BX.SidePanel.Instance.open('${Text.encode(allWidgetsUrl)}'); return false;\">\n\t\t\t\t\t\t${BX.Loc.getMessage('EMBED_SLIDER_WIDGET_FORM_ALL_WIDGETS')}\n\t\t\t\t\t</a>\n\t\t\t\t</p>\n\t\t\t`;\n\t\t\twidgetBox.querySelector('.crm-form-embed-inner-section').append(showMoreLink);\n\t\t}\n\n\t\treturn widgetBox;\n\t}\n\n\tstatic #renderOpenlines(formId: number, openlinesData: OpenlinesData)\n\t{\n\t\tif (Type.isNull(openlinesData))\n\t\t{\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-slider-section\" data-menu-item-id=\"openlines\">\n\t\t\t\t\t<div class=\"ui-slider-content-box\">\n\t\t\t\t\t\t<div class=\"ui-slider-heading-3\">${BX.Loc.getMessage('EMBED_SLIDER_OPENLINES_HEADER')}</div>\n\t\t\t\t\t\t<div class=\"ui-slider-inner-box\">\n\t\t\t\t\t\t\t<div class=\"ui-slider-paragraph\">\n\t\t\t\t\t\t\t\t${BX.Loc.getMessage('EMBED_SLIDER_OPENLINES_HEADER_INNER')}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"ui-alert ui-alert-warning\">\n\t\t\t\t\t\t\t\t<span class=\"ui-alert-message\">${BX.Loc.getMessage('EMBED_SLIDER_OPENLINES_ACCESS_DENIED')}</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\tconst allIds = Object.keys(openlinesData.lines);\n\t\tconst allLinesUrl = Type.isStringFilled(openlinesData.url.allLines) ? openlinesData.url.allLines : '/services/contact_center/openlines';\n\n\t\tlet linesInner;\n\t\tif (allIds.length === 0)\n\t\t{\n\t\t\tlinesInner = BX.Loc.getMessage('EMBED_SLIDER_OPENLINES_EMPTY');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tlinesInner = Embed.#renderLinesList(openlinesData.lines, formId, openlinesData.formName);\n\t\t}\n\n\t\tconst linesBox = Tag.render`\n\t\t\t<div class=\"ui-slider-section\" data-menu-item-id=\"openlines\">\n\t\t\t\t<div class=\"ui-slider-content-box\">\n\t\t\t\t\t<div class=\"ui-slider-heading-3\">${BX.Loc.getMessage('EMBED_SLIDER_OPENLINES_HEADER')}</div>\n\t\t\t\t\t<div class=\"ui-slider-inner-box\">\n\t\t\t\t\t\t<div class=\"ui-slider-paragraph\">\n\t\t\t\t\t\t\t${BX.Loc.getMessage('EMBED_SLIDER_OPENLINES_HEADER_INNER')}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"crm-form-embed-inner-section\">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tlinesBox.querySelector('.crm-form-embed-inner-section').append(linesInner);\n\n\t\tif (openlinesData.showMoreLink)\n\t\t{\n\t\t\tconst showMoreLink = Tag.render`\n\t\t\t\t<p class=\"crm-form-embed-widgets-all-buttons\">\n\t\t\t\t\t<a href=\"${Text.encode(allLinesUrl)}\" target=\"_blank\" onclick=\"BX.SidePanel.Instance.open('${Text.encode(allLinesUrl)}'); return false;\">\n\t\t\t\t\t\t${BX.Loc.getMessage('EMBED_SLIDER_OPENLINES_FORM_ALL_LINES')}\n\t\t\t\t\t</a>\n\t\t\t\t</p>\n\t\t\t`;\n\t\t\tlinesBox.querySelector('.crm-form-embed-inner-section').append(showMoreLink);\n\t\t}\n\n\t\treturn linesBox;\n\t}\n\n\tstatic #renderWidgetsList(widgets: WidgetsList, formId: number, currentFormName: string, currentFormType: string): HTMLElement\n\t{\n\t\tconst widgetsList = Tag.render`<div class=\"crm-form-embed-widgets\" data-form-name=\"${Text.encode(currentFormName)}\" data-form-type=\"${Text.encode(currentFormType)}\"></div>`;\n\t\tconst widgetIds = Embed.#getOrderedWidgetIds(widgets);\n\t\twidgetIds.forEach(id => {\n\t\t\tconst data = widgets[id];\n\t\t\twidgetsList.append(Embed.#renderWidgetRow(data.id, data.name, data.relatedFormNames, currentFormType, data.checked, formId));\n\t\t});\n\t\treturn widgetsList;\n\t}\n\n\tstatic #renderLinesList(lines: LinesList, formId: number, currentFormName: string): HTMLElement\n\t{\n\t\tconst linesList = Tag.render`<div class=\"crm-form-embed-widgets\" data-form-name=\"${Text.encode(currentFormName)}\"></div>`;\n\t\tconst lineIds = Embed.#getOrderedWidgetIds(lines);\n\t\tlineIds.forEach(id => {\n\t\t\tconst data = lines[id];\n\t\t\tconst checked = data.formEnabled && data.checked;\n\t\t\tconst formName = data.formEnabled ? data.formName : '';\n\t\t\tlinesList.append(Embed.#renderLineRow(data.id, data.name, formName, checked, formId));\n\t\t});\n\t\treturn linesList;\n\t}\n\n\tstatic #getOrderedWidgetIds(widgets: WidgetsList): Array\n\t{\n\t\tconst widgetIds = Object.keys(widgets);\n\t\twidgetIds.sort((a, b) => {\n\t\t\tconst aData = widgets[a];\n\t\t\tconst bData = widgets[b];\n\t\t\tswitch (true)\n\t\t\t{\n\t\t\t\tcase (aData.checked && bData.checked) || (! aData.checked && ! bData.checked):\n\t\t\t\t\treturn 0;\n\t\t\t\tcase aData.checked && ! bData.checked:\n\t\t\t\t\treturn -1;\n\t\t\t\tcase ! aData.checked && bData.checked:\n\t\t\t\t\treturn 1;\n\t\t\t}\n\t\t});\n\t\treturn widgetIds;\n\t}\n\n\tstatic #createSwitcher(checked: boolean, inputName: string)\n\t{\n\t\tconst switcherNode = document.createElement('span');\n\t\tswitcherNode.className = 'ui-switcher';\n\t\treturn new top.BX.UI.Switcher({\n\t\t\tnode: switcherNode,\n\t\t\tchecked: checked,\n\t\t\tinputName: inputName,\n\t\t});\n\t}\n\n\tstatic #renderWidgetRow(widgetId: number, widgetName: string, formNames: object, formType: string, checked: boolean, formId: number)\n\t{\n\t\tconst switcher = Embed.#createSwitcher(checked, 'crm-form-embed-widget-input-' + widgetId);\n\t\tswitcher.handlers = {\n\t\t\ttoggled: BX.Crm.Form.Embed.#handleToggledWidgetSwitcher.bind(switcher, formId, widgetId),\n\t\t};\n\n\t\tformNames = Object.values(formNames);\n\t\tconst sFormType = Embed.#getFormTypeMessage(formType);\n\t\tconst sFormNames = Type.isArray(formNames) && formNames.length > 0\n\t\t\t? formNames.join(', ')\n\t\t\t: ''\n\t\t;\n\t\tconst sFormNamesField = sFormNames.length > 0 ? sFormType + ': ' + sFormNames : '';\n\t\tconst row = Tag.render`\n\t\t\t<div class=\"crm-form-embed-widgets-block\">\n\t\t\t\t<div class=\"crm-form-embed-widgets-name-block\">\n\t\t\t\t\t<span class=\"crm-form-embed-widgets-name\">${Text.encode(widgetName)}</span>\n\t\t\t\t\t<span\n\t\t\t\t\t\tclass=\"crm-form-embed-widgets-detail\"\n\t\t\t\t\t\ttitle=\"${Text.encode(sFormNamesField)}\"\n\t\t\t\t\t\tdata-form-name=\"${Text.encode(sFormNames)}\"\n\t\t\t\t\t\tdata-form-type=\"${Text.encode(sFormType)}\"\n\t\t\t\t\t>\n\t\t\t\t\t\t${Text.encode(sFormNamesField)}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"crm-form-embed-widgets-control\">\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t\trow.querySelector('.crm-form-embed-widgets-control').append(switcher.getNode());\n\t\treturn row;\n\t}\n\n\tstatic #renderLineRow(lineId: number, lineName: string, formName: string, checked: boolean, formId: number)\n\t{\n\t\tconst switcher = Embed.#createSwitcher(checked, 'crm-form-embed-line-input-' + lineId);\n\t\tswitcher.handlers = {\n\t\t\ttoggled: BX.Crm.Form.Embed.#handleToggledLineSwitcher.bind(switcher, formId, lineId),\n\t\t};\n\n\t\tconst row = Tag.render`\n\t\t\t<div class=\"crm-form-embed-widgets-block\">\n\t\t\t\t<div class=\"crm-form-embed-widgets-name-block\">\n\t\t\t\t\t<span class=\"crm-form-embed-widgets-name\">${Text.encode(lineName)}</span>\n\t\t\t\t\t<span\n\t\t\t\t\t\tclass=\"crm-form-embed-widgets-detail\"\n\t\t\t\t\t\ttitle=\"${Text.encode(formName)}\"\n\t\t\t\t\t\tdata-form-name=\"${Text.encode(formName)}\"\n\t\t\t\t\t>\n\t\t\t\t\t\t${Text.encode(formName)}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"crm-form-embed-widgets-control\">\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t\trow.querySelector('.crm-form-embed-widgets-control').append(switcher.getNode());\n\t\treturn row;\n\t}\n\n\tstatic #renderCodeBlock(heading1: string, heading2: string, description: string, code: string, viewValues: object, viewOptions: object, dict: EmbedDict, type: string, formId: number, blockId: string)\n\t{\n\t\tconst contentBox = Tag.render`\n\t\t\t<div class=\"ui-slider-section\" data-menu-item-id=\"${Text.encode(blockId)}\">\n\t\t\t\t<div class=\"ui-slider-content-box\">\n\t\t\t\t\t<div class=\"ui-slider-heading-3\">${Text.encode(heading1)}</div>\n\t\t\t\t\t<div class=\"ui-slider-inner-box\">\n\t\t\t\t\t\t<!-- <p class=\"ui-slider-paragraph-2\">${Text.encode(heading2)}</p> -->\n\t\t\t\t\t\t<p class=\"ui-slider-paragraph\">${Text.encode(description)}</p>\n\t\t\t\t\t\t<div class=\"crm-form-embed-inner-section\">\n\t\t\t\t\t\t\t<div class=\"crm-form-embed-script\"><pre><span>${Text.encode(code)}</span></pre></div>\n\t\t\t\t\t\t\t<button class=\"ui-btn ui-btn-md ui-btn-primary crm-form-embed-btn-copy\">${BX.Loc.getMessage('EMBED_SLIDER_COPY_BUTTON')}</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t\tcontentBox.querySelector('.crm-form-embed-inner-section').prepend(\n\t\t\tEmbed.#renderViewOptions(viewValues, viewOptions, dict, type, formId)\n\t\t);\n\t\ttop.BX.clipboard.bindCopyClick(\n\t\t\tcontentBox.querySelector('.crm-form-embed-btn-copy'),\n\t\t\t{text: contentBox.querySelector('.crm-form-embed-script')}\n\t\t);\n\t\treturn contentBox;\n\t}\n\n\tstatic #renderViewOptions(values: object, options: object, dict: EmbedDict, type: string, formId: number): string\n\t{\n\t\tlet renderedOptions = Tag.render`<div></div>`;\n\t\tObject.keys(options).forEach(key => {\n\t\t\tconst keyName = Embed.#getOptionKeyName(key);\n\t\t\tconst keyOptions = Type.isArray(options[key]) ? options[key] : [];\n\t\t\tconst selected = Type.isUndefined(values[key]) ? keyOptions[0] : values[key];\n\t\t\tconst selectedName = Embed.#getOptionValueName(key, selected, dict);\n\t\t\tconst elementId = `crm-form-embed-select-${formId}-${type}-${key}`;\n\t\t\tconst wrapperId = `crm-form-embed-wrapper-${formId}-${type}-${key}`;\n\t\t\tconst optionElem = Tag.render`\n\t\t\t\t<div class=\"inline-options crm-form-embed-field-item-wrapper\" id=\"${Text.encode(wrapperId)}\">\n\t\t\t\t\t<label>${Text.encode(keyName)}:</label>\n\t\t\t\t\t<span class=\"crm-form-embed-field-item-text-button\" id=\"${Text.encode(elementId)}\">\n\t\t\t\t\t\t${Text.encode(selectedName)}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t\tDom.append(optionElem, renderedOptions);\n\n\t\t\tif (key === \"vertical\" && values[\"type\"] === \"popup\")\n\t\t\t{\n\t\t\t\tconst elem = renderedOptions.querySelector(`#${wrapperId}`);\n\t\t\t\tDom.hide(elem);\n\t\t\t}\n\n\t\t\tconst button = renderedOptions.querySelector('#'+elementId);\n\n\t\t\tlet items = [];\n\t\t\tkeyOptions.forEach(option => {\n\t\t\t\tconst valueName = Embed.#getOptionValueName(key, option, dict);\n\t\t\t\titems.push({\n\t\t\t\t\ttext: valueName,\n\t\t\t\t\tvalue: Text.encode(option),\n\t\t\t\t\tonclick: function (event, item) {\n\t\t\t\t\t\tconst elem = renderedOptions.querySelector(`#crm-form-embed-wrapper-${formId}-${type}-vertical`);\n\t\t\t\t\t\tif (key === \"type\")\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\titem.value === \"popup\" && Dom.hide(elem);\n\t\t\t\t\t\t\titem.value === \"panel\" && Dom.show(elem);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst prevValue = button.textContent\n\t\t\t\t\t\tbutton.textContent = '...';\n\t\t\t\t\t\titem.getMenuWindow().close();\n\t\t\t\t\t\treturn BX.ajax.runAction('crm.form.setViewOption', {\n\t\t\t\t\t\t\tjson: {\n\t\t\t\t\t\t\t\tformId: formId,\n\t\t\t\t\t\t\t\ttype: type,\n\t\t\t\t\t\t\t\tkey: key,\n\t\t\t\t\t\t\t\tvalue: item.value,\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}).then((response) => {\n\t\t\t\t\t\t\tbutton.textContent = valueName;\n\t\t\t\t\t\t\ttop.BX.UI.Notification.Center.notify({\n\t\t\t\t\t\t\t\tcontent: BX.Loc.getMessage('EMBED_SLIDER_OPENLINES_FORM_ALERT_SETTINGS_SAVED'),\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}).catch((response) => {\n\t\t\t\t\t\t\tif (key === \"type\")\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\titem.value === \"popup\" && Dom.show(elem);\n\t\t\t\t\t\t\t\titem.value === \"panel\" && Dom.hide(elem);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tbutton.textContent = prevValue;\n\n\t\t\t\t\t\t\tlet messageId = 'EMBED_SLIDER_FORM_SETTINGS_ALERT_ERROR';\n\t\t\t\t\t\t\tif (! Type.isUndefined(response.data.error.status) && response.data.error.status === 'access denied')\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tmessageId = 'EMBED_SLIDER_WIDGET_FORM_ALERT_ERROR_ACCESS_DENIED_FORM';\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\ttop.BX.UI.Notification.Center.notify({\n\t\t\t\t\t\t\t\tcontent: BX.Loc.getMessage(messageId),\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tconst menu = new top.BX.PopupMenuWindow({\n\t\t\t\tbindElement: button,\n\t\t\t\titems: items,\n\t\t\t});\n\t\t\tbutton.addEventListener(\"click\", function() {\n\t\t\t\tmenu.show();\n\t\t\t});\n\t\t});\n\n\t\treturn renderedOptions;\n\t}\n\n\tstatic #getOptionValueName(key: string, value: string, dict: object): object\n\t{\n\t\tconst namesForOption = Type.isArray(dict['viewOptions'][key + 's']) ? dict['viewOptions'][key + 's'] : null;\n\t\tlet result = value;\n\t\tif (namesForOption !== null)\n\t\t{\n\t\t\tnamesForOption.forEach(elem => {\n\t\t\t\tif (elem.id.toString() === value.toString())\n\t\t\t\t{\n\t\t\t\t\tresult = elem.name;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\treturn Text.encode(result);\n\t}\n\n\tstatic #getOptionKeyName(key: string)\n\t{\n\t\tconst msgKey = 'EMBED_SLIDER_KEY_' + key.toUpperCase();\n\t\treturn BX.Loc.hasMessage(msgKey) ? BX.Loc.getMessage(msgKey) : Text.encode(key);\n\t}\n}\n"],"names":["DEFAULT_WIDGETS_COUNT","ERROR_CODE_FORM_READ_ACCESS_DENIED","ERROR_CODE_WIDGET_WRITE_ACCESS_DENIED","ERROR_CODE_OPENLINES_WRITE_ACCESS_DENIED","Embed","formId","options","widgetsCount","activeMenuItemId","BX","SidePanel","Instance","open","width","cacheable","events","onCloseComplete","event","Type","isFunction","contentCallback","menuItems","label","Loc","getMessage","id","forEach","item","active","Layout","createContent","extensions","title","design","section","menu","items","content","ajax","runAction","json","then","response","embedData","data","responseEmbed","count","widgetsData","catch","isObject","error","status","Error","responseWidgets","openlinesData","result","errorMessage","code","Tag","render","buttons","closeButton","widgetId","setLoading","dataSetOld","getNode","closest","querySelector","dataset","formNameOld","formName","formTypeOld","formType","dataSetCurrent","isChecked","buttonId","assigned","check","top","UI","Notification","Center","notify","length","messageId","isUndefined","lineId","switcher","elem","textContent","setAttribute","assign","formTypeMessage","formTypeLangKey","toUpperCase","hasMessage","widgetBox","openlinesBox","pubLinkBox","Text","encode","embed","pubLink","clipboard","bindCopyClick","text","type","blockId","viewOptions","viewValues","scripts","dict","isNull","allIds","Object","keys","widgets","allWidgetsUrl","isStringFilled","url","allWidgets","widgetsInner","append","showMoreLink","lines","allLinesUrl","allLines","linesInner","linesBox","currentFormName","currentFormType","widgetsList","widgetIds","name","relatedFormNames","checked","linesList","lineIds","formEnabled","sort","a","b","aData","bData","inputName","switcherNode","document","createElement","className","Switcher","node","widgetName","formNames","handlers","toggled","Crm","Form","bind","values","sFormType","sFormNames","isArray","join","sFormNamesField","row","lineName","heading1","heading2","description","contentBox","prepend","renderedOptions","key","keyName","keyOptions","selected","selectedName","elementId","wrapperId","optionElem","Dom","hide","button","option","valueName","push","value","onclick","show","prevValue","getMenuWindow","close","PopupMenuWindow","bindElement","addEventListener","namesForOption","toString","msgKey"],"mappings":"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"}