{"version":3,"file":"autorun.bundle.js","sources":["../src/process/process-registry.js","../src/process/process-state.js","../src/process/process-panel.js","../src/process/processor.js","../src/process/summary-panel.js","../src/managers/batch-manager.js","../src/managers/batch-assignment-manager.js","../src/managers/batch-conversion-manager.js","../src/managers/batch-deletion-manager.js","../src/managers/batch-exclusion-manager.js","../src/managers/batch-observers-manager.js","../src/managers/batch-refresh-accounting-data-manager.js","../src/managers/batch-restart-automation-manager.js","../src/managers/batch-set-category-manager.js","../src/managers/batch-set-export-manager.js","../src/managers/batch-set-opened-manager.js","../src/managers/batch-set-stage-manager.js","../src/managers/batch-whatsapp-message-manager.js","../src/progress-bar-repository.js","../src/index.js"],"sourcesContent":["import { Reflection } from 'main.core';\n\nlet instance = null;\n\n/**\n * @memberOf BX.Crm.Autorun\n */\nexport class ProcessRegistry\n{\n\t#gridIdToProcessCountMap: Map<string, number> = new Map();\n\n\tstatic get Instance(): ProcessRegistry\n\t{\n\t\tif ((window.top !== window) && Reflection.getClass('top.BX.Crm.Autorun.ProcessRegistry'))\n\t\t{\n\t\t\treturn window.top.BX.Crm.Autorun.ProcessRegistry.Instance;\n\t\t}\n\n\t\tif (instance === null)\n\t\t{\n\t\t\tinstance = new ProcessRegistry();\n\t\t}\n\n\t\treturn instance;\n\t}\n\n\tisProcessRunning(gridId: string): boolean\n\t{\n\t\treturn this.getProcessCount(gridId) > 0;\n\t}\n\n\tgetProcessCount(gridId: string): number\n\t{\n\t\treturn this.#gridIdToProcessCountMap.get(gridId) ?? 0;\n\t}\n\n\tregisterProcessRun(gridId: string): void\n\t{\n\t\tconst currentCount = this.#gridIdToProcessCountMap.get(gridId) ?? 0;\n\n\t\tthis.#gridIdToProcessCountMap.set(gridId, currentCount + 1);\n\t}\n\n\tregisterProcessStop(gridId: string): void\n\t{\n\t\tconst currentCount = this.#gridIdToProcessCountMap.get(gridId) ?? 0;\n\n\t\tlet newCount = currentCount - 1;\n\t\tif (newCount < 0)\n\t\t{\n\t\t\tnewCount = 0;\n\t\t}\n\n\t\tthis.#gridIdToProcessCountMap.set(gridId, newCount);\n\t}\n\n\tstatic isProcessRunning(gridId: string): boolean\n\t{\n\t\treturn this.Instance.isProcessRunning(gridId);\n\t}\n}\n","/**\n * @memberOf BX.Crm.Autorun\n * @alias BX.AutoRunProcessState\n */\nexport const ProcessState = Object.freeze({\n\tintermediate: 0,\n\trunning: 1,\n\tcompleted: 2,\n\tstopped: 3,\n\terror: 4,\n});\n","/* eslint-disable @bitrix24/bitrix24-rules/no-pseudo-private,no-underscore-dangle,no-throw-literal */\nimport { Loc } from 'main.core';\nimport { ProcessState } from './process-state';\nimport '../css/process.css';\nimport 'ui.design-tokens';\n\n/**\n * @memberOf BX.Crm.Autorun\n * @alias BX.AutorunProcessPanel\n */\nexport class ProcessPanel\n{\n\t_id = '';\n\t_settings = {};\n\n\t_manager = null;\n\t_container = null;\n\t_wrapper = null;\n\t_stateNode = null;\n\t_progressNode = null;\n\t_hasLayout = false;\n\t_isHidden = false;\n\n\tstatic items = {};\n\n\tstatic isExists(id)\n\t{\n\t\treturn (id in ProcessPanel.items);\n\t}\n\n\tstatic create(id, settings): ProcessPanel\n\t{\n\t\tconst self = new ProcessPanel(id, settings);\n\n\t\tProcessPanel.items[self.getId()] = self;\n\n\t\treturn self;\n\t}\n\n\tconstructor(id, settings)\n\t{\n\t\tthis._id = id;\n\t\tthis._settings = settings || {};\n\n\t\tthis._container = BX(this.getSetting('container'));\n\t\tif (!BX.type.isElementNode(this._container))\n\t\t{\n\t\t\tthrow 'AutorunProcessPanel: Could not find container.';\n\t\t}\n\n\t\tthis._manager = this.getSetting('manager');\n\t\tthis._isHidden = this.getSetting('isHidden', false);\n\t}\n\n\tgetId()\n\t{\n\t\treturn this._id;\n\t}\n\n\tgetSetting(name, defaultval)\n\t{\n\t\treturn this._settings.hasOwnProperty(name) ? this._settings[name] : defaultval;\n\t}\n\n\tscrollInToView()\n\t{\n\t\tif (!this._container)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst rect = BX.pos(this._container);\n\t\tif (window.scrollY > rect.top)\n\t\t{\n\t\t\twindow.scrollTo(window.scrollX, rect.top);\n\t\t}\n\t}\n\n\tlayout()\n\t{\n\t\tif (this._hasLayout)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis._wrapper = BX.create('DIV', { attrs: { className: 'crm-view-progress' } });\n\t\tBX.addClass(\n\t\t\tthis._wrapper,\n\t\t\tthis._isHidden ? 'crm-view-progress-hide' : 'crm-view-progress-show crm-view-progress-bar-active',\n\t\t);\n\n\t\tthis._container.appendChild(this._wrapper);\n\n\t\tthis._wrapper.appendChild(\n\t\t\tBX.create(\n\t\t\t\t'DIV',\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: 'crm-view-progress-info' },\n\t\t\t\t\ttext: this.getSetting('title', 'Please wait...'),\n\t\t\t\t},\n\t\t\t),\n\t\t);\n\n\t\tthis._progressNode = BX.create('DIV', { attrs: { className: 'crm-view-progress-bar-line' } });\n\t\tthis._stateNode = BX.create('DIV', { attrs: { className: 'crm-view-progress-steps' } });\n\t\tthis._wrapper.appendChild(\n\t\t\tBX.create(\n\t\t\t\t'DIV',\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: 'crm-view-progress-inner' },\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\n\t\t\t\t\t\t\t\t'DIV',\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattrs: { className: 'crm-view-progress-bar' },\n\t\t\t\t\t\t\t\t\tchildren: [this._progressNode],\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\tthis._stateNode,\n\t\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t),\n\t\t);\n\n\t\tif (BX.prop.getBoolean(this._settings, 'enableCancellation', false))\n\t\t{\n\t\t\tthis._wrapper.appendChild(\n\t\t\t\tBX.create(\n\t\t\t\t\t'a',\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: 'crm-view-progress-link', href: '#' },\n\t\t\t\t\t\ttext: Loc.getMessage('JS_CORE_WINDOW_CANCEL'),\n\t\t\t\t\t\tevents: { click: this.onCancelButtonClick.bind(this) },\n\t\t\t\t\t},\n\t\t\t\t),\n\t\t\t);\n\t\t}\n\n\t\tthis._hasLayout = true;\n\t}\n\n\thasLayout()\n\t{\n\t\treturn this._hasLayout;\n\t}\n\n\tisHidden()\n\t{\n\t\treturn this._isHidden;\n\t}\n\n\tshow()\n\t{\n\t\tif (!this._isHidden)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this._hasLayout)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tBX.removeClass(this._wrapper, 'crm-view-progress-hide');\n\t\tBX.addClass(this._wrapper, 'crm-view-progress-show');\n\n\t\tthis._isHidden = false;\n\t}\n\n\thide()\n\t{\n\t\tif (this._isHidden)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this._hasLayout)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tBX.removeClass(this._wrapper, 'crm-view-progress-show');\n\t\tBX.addClass(this._wrapper, 'crm-view-progress-hide');\n\n\t\tthis._isHidden = true;\n\t}\n\n\tclearLayout()\n\t{\n\t\tif (!this._hasLayout)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tBX.remove(this._wrapper);\n\t\tthis._wrapper = this._stateNode = null;\n\n\t\tthis._hasLayout = false;\n\t}\n\n\tgetManager()\n\t{\n\t\treturn this._manager;\n\t}\n\n\tsetManager(manager)\n\t{\n\t\tthis._manager = manager;\n\t}\n\n\tonManagerStateChange()\n\t{\n\t\tif (!(this._hasLayout && this._manager))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst state = this._manager.getState();\n\t\tif (state !== ProcessState.error)\n\t\t{\n\t\t\tconst processed = this._manager.getProcessedItemCount();\n\t\t\tconst total = this._manager.getTotalItemCount();\n\n\t\t\tlet progress = 0;\n\t\t\tif (total !== 0)\n\t\t\t{\n\t\t\t\tprogress = Math.floor((processed / total) * 100);\n\t\t\t\tconst offset = progress % 5;\n\t\t\t\tif (offset !== 0)\n\t\t\t\t{\n\t\t\t\t\tprogress -= offset;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (processed > 0 && total > 0)\n\t\t\t{\n\t\t\t\tconst template = this.getSetting(\n\t\t\t\t\t'stateTemplate',\n\t\t\t\t\tLoc.getMessage('CRM_AUTORUN_PROCESS_PANEL_DEFAULT_STATE_TEMPLATE'),\n\t\t\t\t);\n\n\t\t\t\tthis._stateNode.innerHTML = template\n\t\t\t\t\t.replace('#processed#', processed)\n\t\t\t\t\t.replace('#total#', total)\n\t\t\t\t;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis._stateNode.innerHTML = '';\n\t\t\t}\n\n\t\t\tthis._progressNode.className = 'crm-view-progress-bar-line';\n\t\t\tif (progress > 0)\n\t\t\t{\n\t\t\t\tthis._progressNode.className += ` crm-view-progress-line-${progress.toString()}`;\n\t\t\t}\n\t\t}\n\t}\n\n\tonCancelButtonClick(e)\n\t{\n\t\tthis._manager.stop();\n\n\t\treturn BX.eventReturnFalse(e);\n\t}\n}\n","/* eslint-disable @bitrix24/bitrix24-rules/no-pseudo-private,no-underscore-dangle,no-throw-literal */\n\nimport { ajax as Ajax, Loc, Type } from 'main.core';\nimport { ProcessPanel } from './process-panel';\nimport { ProcessState } from './process-state';\n\n/**\n * @memberof BX.Crm.Autorun\n * @alias BX.AutorunProcessManager\n */\nexport class Processor\n{\n\t_id = '';\n\t_settings = {};\n\n\t_serviceUrl = '';\n\t_actionName = '';\n\n\t_controllerActionName = '';\n\n\t_params = null;\n\n\t_container = null;\n\t_panel = null;\n\t_runHandle = 0;\n\n\t_hasLayout = false;\n\n\t_state = ProcessState.intermediate;\n\t_processedItemCount = 0;\n\t_totalItemCount = 0;\n\t_errors = [];\n\n\tstatic messages = {\n\t\t// default messages, you can override them via settings.messages\n\t\trequestError: Loc.getMessage('CRM_AUTORUN_PROCESS_REQUEST_ERROR'),\n\t};\n\n\tstatic items = {};\n\n\tstatic create(id, settings): Processor\n\t{\n\t\tconst self = new Processor(id, settings);\n\n\t\tProcessor.items[self.getId()] = self;\n\n\t\treturn self;\n\t}\n\n\tstatic createIfNotExists(id, settings): Processor\n\t{\n\t\tif (id in Processor.items)\n\t\t{\n\t\t\treturn Processor.items[id];\n\t\t}\n\n\t\treturn Processor.create(id, settings);\n\t}\n\n\tconstructor(id: string, settings: Object)\n\t{\n\t\tthis._id = Type.isStringFilled(id) ? id : `crm_lrp_mgr_${Math.random().toString().slice(2)}`;\n\t\tthis._settings = settings || {};\n\n\t\tthis._serviceUrl = BX.prop.getString(this._settings, 'serviceUrl', '');\n\t\tthis._actionName = BX.prop.getString(this._settings, 'actionName', '');\n\t\tthis._controllerActionName = BX.prop.getString(this._settings, 'controllerActionName', '');\n\n\t\tif (this._serviceUrl === '' && this._controllerActionName === '')\n\t\t{\n\t\t\tthrow 'AutorunProcessManager: Either the serviceUrl or controllerActionName parameter must be specified.';\n\t\t}\n\n\t\tthis._container = BX(this.getSetting('container'));\n\t\tif (!Type.isElementNode(this._container))\n\t\t{\n\t\t\tthrow 'AutorunProcessManager: Could not find container.';\n\t\t}\n\n\t\tthis._params = BX.prop.getObject(this._settings, 'params', null);\n\t\tif (BX.prop.getBoolean(this._settings, 'enableLayout', false))\n\t\t{\n\t\t\tthis.layout();\n\t\t}\n\t}\n\n\tgetId()\n\t{\n\t\treturn this._id;\n\t}\n\n\tgetSetting(name, defaultval)\n\t{\n\t\tif (name in this._settings)\n\t\t{\n\t\t\treturn this._settings[name];\n\t\t}\n\n\t\treturn defaultval;\n\t}\n\n\tgetTimeout()\n\t{\n\t\treturn BX.prop.getInteger(this._settings, 'timeout', 2000);\n\t}\n\n\tgetMessage(name, defaultValue)\n\t{\n\t\tif (name in Processor.messages)\n\t\t{\n\t\t\treturn Processor.messages[name];\n\t\t}\n\n\t\treturn Type.isUndefined(defaultValue) ? name : defaultValue;\n\t}\n\n\tgetParams()\n\t{\n\t\treturn this._params;\n\t}\n\n\tsetParams(params)\n\t{\n\t\tthis._params = params;\n\t}\n\n\tisHidden()\n\t{\n\t\treturn !this._hasLayout || this._panel.isHidden();\n\t}\n\n\tshow()\n\t{\n\t\tif (this._hasLayout)\n\t\t{\n\t\t\tthis._panel.show();\n\t\t}\n\t}\n\n\thide()\n\t{\n\t\tif (this._hasLayout)\n\t\t{\n\t\t\tthis._panel.hide();\n\t\t}\n\t}\n\n\tscrollInToView()\n\t{\n\t\tif (this._panel)\n\t\t{\n\t\t\tthis._panel.scrollInToView();\n\t\t}\n\t}\n\n\tlayout()\n\t{\n\t\tif (this._hasLayout)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this._panel)\n\t\t{\n\t\t\tlet title = BX.prop.getString(this._settings, 'title', '');\n\t\t\tif (title === '')\n\t\t\t{\n\t\t\t\ttitle = this.getMessage('title', '');\n\t\t\t}\n\n\t\t\tlet stateTemplate = BX.prop.getString(this._settings, 'stateTemplate', '');\n\t\t\tif (stateTemplate === '')\n\t\t\t{\n\t\t\t\tstateTemplate = this.getMessage('stateTemplate', '');\n\t\t\t}\n\n\t\t\tconst panelSettings = {\n\t\t\t\tmanager: this,\n\t\t\t\tcontainer: this._container,\n\t\t\t\tenableCancellation: BX.prop.getBoolean(this._settings, 'enableCancellation', false),\n\t\t\t};\n\n\t\t\tif (Type.isStringFilled(title))\n\t\t\t{\n\t\t\t\tpanelSettings.title = title;\n\t\t\t}\n\n\t\t\tif (Type.isStringFilled(stateTemplate))\n\t\t\t{\n\t\t\t\tpanelSettings.stateTemplate = stateTemplate;\n\t\t\t}\n\n\t\t\tthis._panel = ProcessPanel.create(\n\t\t\t\tthis._id,\n\t\t\t\tpanelSettings,\n\t\t\t);\n\t\t}\n\t\tthis._panel.layout();\n\t\tthis._hasLayout = true;\n\t}\n\n\tclearLayout()\n\t{\n\t\tif (!this._hasLayout)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis._panel.clearLayout();\n\t\tthis._hasLayout = false;\n\t}\n\n\tgetPanel()\n\t{\n\t\treturn this._panel;\n\t}\n\n\tsetPanel(panel)\n\t{\n\t\tthis._panel = panel;\n\n\t\tif (this._panel)\n\t\t{\n\t\t\tthis._panel.setManager(this);\n\t\t\tthis._hasLayout = this._panel.hasLayout();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis._hasLayout = false;\n\t\t}\n\t}\n\n\trefresh()\n\t{\n\t\tif (!this._hasLayout)\n\t\t{\n\t\t\tthis.layout();\n\t\t}\n\n\t\tif (this._panel.isHidden())\n\t\t{\n\t\t\tthis._panel.show();\n\t\t}\n\t\tthis._panel.onManagerStateChange();\n\t}\n\n\tgetState()\n\t{\n\t\treturn this._state;\n\t}\n\n\tgetProcessedItemCount()\n\t{\n\t\treturn this._processedItemCount;\n\t}\n\n\tgetTotalItemCount()\n\t{\n\t\treturn this._totalItemCount;\n\t}\n\n\tgetErrorCount()\n\t{\n\t\treturn this._errors.length;\n\t}\n\n\tgetErrors()\n\t{\n\t\treturn this._errors;\n\t}\n\n\trun()\n\t{\n\t\tif (this._state === ProcessState.stopped)\n\t\t{\n\t\t\tthis._state = ProcessState.intermediate;\n\t\t}\n\t\tthis.startRequest();\n\t}\n\n\trunAfter(timeout)\n\t{\n\t\tthis._runHandle = window.setTimeout(this.run.bind(this), timeout);\n\t}\n\n\tstop()\n\t{\n\t\tthis._state = ProcessState.stopped;\n\t\tBX.onCustomEvent(this, 'ON_AUTORUN_PROCESS_STATE_CHANGE', [this]);\n\t}\n\n\treset()\n\t{\n\t\tif (this._runHandle > 0)\n\t\t{\n\t\t\twindow.clearTimeout(this._runHandle);\n\t\t\tthis._runHandle = 0;\n\t\t}\n\n\t\tif (this._panel && this._panel.isHidden())\n\t\t{\n\t\t\tthis._panel.show();\n\t\t}\n\n\t\tthis._processedItemCount = 0;\n\t\tthis._totalItemCount = 0;\n\t}\n\n\tstartRequest()\n\t{\n\t\tif (this._state === ProcessState.stopped)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this._requestIsRunning)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tthis._requestIsRunning = true;\n\n\t\tthis._state = ProcessState.running;\n\n\t\tconst data = {};\n\t\tif (this._serviceUrl === '')\n\t\t{\n\t\t\tif (this._params)\n\t\t\t{\n\t\t\t\tdata.params = this._params;\n\t\t\t}\n\n\t\t\tAjax.runAction(this._controllerActionName, { data })\n\t\t\t\t.then((result) => {\n\t\t\t\t\tthis.onRequestSuccess(BX.prop.getObject(result, 'data', {}));\n\t\t\t\t}).catch((result) => {\n\t\t\t\t\tthis.onRequestFailure(BX.prop.getObject(result, 'data', {}));\n\t\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (this._actionName !== '')\n\t\t\t{\n\t\t\t\tdata.ACTION = this._actionName;\n\t\t\t}\n\n\t\t\tif (this._params)\n\t\t\t{\n\t\t\t\tdata.PARAMS = this._params;\n\t\t\t}\n\t\t\tdata.sessid = BX.bitrix_sessid();\n\n\t\t\tAjax(\n\t\t\t\t{\n\t\t\t\t\turl: this._serviceUrl,\n\t\t\t\t\tmethod: 'POST',\n\t\t\t\t\tdataType: 'json',\n\t\t\t\t\tdata,\n\t\t\t\t\tonsuccess: this.onRequestSuccess.bind(this),\n\t\t\t\t\tonfailure: this.onRequestFailure.bind(this),\n\t\t\t\t},\n\t\t\t);\n\t\t}\n\t}\n\n\tonRequestSuccess(result)\n\t{\n\t\tthis._requestIsRunning = false;\n\t\tif (this._state === ProcessState.stopped)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this._serviceUrl === '')\n\t\t{\n\t\t\tconst status = BX.prop.getString(result, 'status', '');\n\n\t\t\tif (status === 'ERROR')\n\t\t\t{\n\t\t\t\tthis._state = ProcessState.error;\n\t\t\t}\n\t\t\telse if (status === 'COMPLETED')\n\t\t\t{\n\t\t\t\tthis._state = ProcessState.completed;\n\t\t\t}\n\n\t\t\tif (this._state === ProcessState.error)\n\t\t\t{\n\t\t\t\tthis.#setErrorsFromResponseData(result);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis._processedItemCount = BX.prop.getInteger(result, 'processedItems', 0);\n\t\t\t\tthis._totalItemCount = BX.prop.getInteger(result, 'totalItems', 0);\n\t\t\t\tthis._errors = BX.prop.getArray(result, 'errors', []);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst status = BX.prop.getString(result, 'STATUS', '');\n\n\t\t\tif (status === 'ERROR')\n\t\t\t{\n\t\t\t\tthis._state = ProcessState.error;\n\t\t\t}\n\t\t\telse if (status === 'COMPLETED')\n\t\t\t{\n\t\t\t\tthis._state = ProcessState.completed;\n\t\t\t}\n\n\t\t\tif (this._state === ProcessState.error)\n\t\t\t{\n\t\t\t\tthis.#setErrorsFromResponseData(result);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis._processedItemCount = BX.prop.getInteger(result, 'PROCESSED_ITEMS', 0);\n\t\t\t\tthis._totalItemCount = BX.prop.getInteger(result, 'TOTAL_ITEMS', 0);\n\t\t\t\tthis._errors = BX.prop.getArray(result, 'ERRORS', []);\n\t\t\t}\n\t\t}\n\n\t\tthis.refresh();\n\t\tif (this._state === ProcessState.running)\n\t\t{\n\t\t\twindow.setTimeout(this.startRequest.bind(this), this.getTimeout());\n\t\t}\n\t\telse if (this._state === ProcessState.completed\n\t\t\t&& BX.prop.getBoolean(this._settings, 'hideAfterComplete', true)\n\t\t)\n\t\t{\n\t\t\tthis.hide();\n\t\t}\n\n\t\tBX.onCustomEvent(this, 'ON_AUTORUN_PROCESS_STATE_CHANGE', [this]);\n\t}\n\n\tonRequestFailure(result)\n\t{\n\t\tthis._requestIsRunning = false;\n\n\t\tthis._state = ProcessState.error;\n\t\tthis.#setErrorsFromResponseData(result);\n\n\t\tthis.refresh();\n\t\tBX.onCustomEvent(this, 'ON_AUTORUN_PROCESS_STATE_CHANGE', [this]);\n\t}\n\n\t#setErrorsFromResponseData(responseData): void\n\t{\n\t\tconst key = this._serviceUrl === '' ? 'errors' : 'ERRORS';\n\n\t\tthis._errors = BX.prop.getArray(responseData, key, []);\n\t\tif (this._errors.length === 0)\n\t\t{\n\t\t\tthis._errors.push({ message: this.getMessage('requestError') });\n\t\t}\n\t}\n}\n","import { Loc } from 'main.core';\nimport '../css/process.css';\nimport 'ui.design-tokens';\n\n/**\n * @memberOf BX.Crm.Autorun\n * @alias BX.Crm.ProcessSummaryPanel\n */\nexport class SummaryPanel\n{\n\t_id = '';\n\t_settings = {};\n\n\t_data = null;\n\t_container = null;\n\t_wrapper = null;\n\n\tstatic messages = {};\n\n\tstatic create(id, settings): SummaryPanel\n\t{\n\t\treturn new SummaryPanel(id, settings);\n\t}\n\n\tconstructor(id, settings)\n\t{\n\t\tthis._id = id;\n\t\tthis._settings = settings || {};\n\n\t\tthis._container = BX(BX.prop.get(this._settings, 'container'));\n\t\tif (!BX.type.isElementNode(this._container))\n\t\t{\n\t\t\tthrow 'BatchConversionPanel: Could not find container.';\n\t\t}\n\t\tthis._data = BX.prop.getObject(this._settings, 'data', {});\n\t}\n\n\tgetId()\n\t{\n\t\treturn this._id;\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst messages = BX.prop.getObject(this._settings, 'messages', SummaryPanel.messages);\n\n\t\treturn BX.prop.getString(messages, name, name);\n\t}\n\n\tlayout()\n\t{\n\t\tif (this._hasLayout)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis._wrapper = BX.create('DIV', { attrs: { className: 'crm-view-progress' } });\n\t\tBX.addClass(this._wrapper, this._isHidden ? 'crm-view-progress-hide' : 'crm-view-progress-show');\n\t\tBX.addClass(this._wrapper, 'crm-view-progress-row-hidden');\n\n\t\tthis._container.appendChild(this._wrapper);\n\n\t\tconst summaryElements = [BX.create('span', { text: this.getMessage('summaryCaption') })];\n\n\t\tconst substitution = new RegExp(BX.prop.getString(this._settings, 'numberSubstitution', '#number#'), 'ig');\n\n\t\tconst succeeded = BX.prop.getInteger(this._data, 'succeededCount', 0);\n\t\tif (succeeded > 0)\n\t\t{\n\t\t\tsummaryElements.push(\n\t\t\t\tBX.create(\n\t\t\t\t\t'span',\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: 'crm-view-progress-text' },\n\t\t\t\t\t\ttext: this.getMessage('summarySucceeded').replace(substitution, succeeded),\n\t\t\t\t\t},\n\t\t\t\t),\n\t\t\t);\n\t\t}\n\n\t\tconst failed = BX.prop.getInteger(this._data, 'failedCount', 0);\n\t\tif (failed > 0)\n\t\t{\n\t\t\tsummaryElements.push(\n\t\t\t\tBX.create(\n\t\t\t\t\t'span',\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: 'crm-view-progress-link crm-view-progress-text-button' },\n\t\t\t\t\t\ttext: this.getMessage('summaryFailed').replace(substitution, failed),\n\t\t\t\t\t\tevents: { click: this.onToggleErrorButtonClick.bind(this) },\n\t\t\t\t\t},\n\t\t\t\t),\n\t\t\t);\n\t\t}\n\n\t\tconst elements = [];\n\t\telements.push(\n\t\t\tBX.create(\n\t\t\t\t'DIV',\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: 'crm-view-progress-info' },\n\t\t\t\t\tchildren: summaryElements,\n\t\t\t\t},\n\t\t\t),\n\t\t);\n\n\t\telements.push(\n\t\t\tBX.create(\n\t\t\t\t'a',\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: 'crm-view-progress-link', href: '#' },\n\t\t\t\t\ttext: Loc.getMessage('JS_CORE_WINDOW_CLOSE'),\n\t\t\t\t\tevents: { click: this.onCloseButtonClick.bind(this) },\n\t\t\t\t},\n\t\t\t),\n\t\t);\n\n\t\tthis._wrapper.appendChild(\n\t\t\tBX.create('DIV', {\n\t\t\t\tattrs: { className: 'crm-view-progress-row' },\n\t\t\t\tchildren: elements,\n\t\t\t}),\n\t\t);\n\n\t\tconst errors = BX.prop.getArray(this._data, 'errors', []);\n\t\tif (errors.length > 0)\n\t\t{\n\t\t\tfor (\n\t\t\t\tlet i = 0,\n\t\t\t\t\tlength = errors.length; i < length; i++\n\t\t\t)\n\t\t\t{\n\t\t\t\tconst error = errors[i];\n\t\t\t\tconst errorElements = [];\n\n\t\t\t\tconst info = BX.prop.getObject(\n\t\t\t\t\tBX.prop.getObject(error, 'customData', {}),\n\t\t\t\t\t'info',\n\t\t\t\t\tnull,\n\t\t\t\t);\n\n\t\t\t\tif (info)\n\t\t\t\t{\n\t\t\t\t\tconst title = BX.prop.getString(info, 'title', '');\n\t\t\t\t\tconst showUrl = BX.prop.getString(info, 'showUrl', '');\n\n\t\t\t\t\tif (title !== '' && showUrl !== '')\n\t\t\t\t\t{\n\t\t\t\t\t\terrorElements.push(\n\t\t\t\t\t\t\tBX.create(\n\t\t\t\t\t\t\t\t'a',\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tprops: { className: 'crm-view-progress-link', href: showUrl, target: '_blank' },\n\t\t\t\t\t\t\t\t\ttext: `${title}:`,\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\terrorElements.push(\n\t\t\t\t\tBX.create(\n\t\t\t\t\t\t'span',\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tattrs: { className: 'crm-view-progress-text' },\n\t\t\t\t\t\t\ttext: error.message,\n\t\t\t\t\t\t},\n\t\t\t\t\t),\n\t\t\t\t);\n\n\t\t\t\tthis._wrapper.appendChild(\n\t\t\t\t\tBX.create(\n\t\t\t\t\t\t'DIV',\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tattrs: { className: 'crm-view-progress-row' },\n\t\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t\tBX.create(\n\t\t\t\t\t\t\t\t\t\t'DIV',\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\tattrs: { className: 'crm-view-progress-info' },\n\t\t\t\t\t\t\t\t\t\t\tchildren: errorElements,\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t},\n\t\t\t\t\t),\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst timeout = this.getDisplayTimeout();\n\t\t\tif (timeout > 0)\n\t\t\t{\n\t\t\t\twindow.setTimeout(() => {\n\t\t\t\t\tthis.clearLayout();\n\t\t\t\t}, timeout);\n\t\t\t}\n\t\t}\n\t\tthis._hasLayout = true;\n\n\t\tBX.onCustomEvent(window, 'BX.Crm.ProcessSummaryPanel:onLayout', [this]);\n\t}\n\n\thasLayout()\n\t{\n\t\treturn this._hasLayout;\n\t}\n\n\tisHidden()\n\t{\n\t\treturn this._isHidden;\n\t}\n\n\tshow()\n\t{\n\t\tif (!this._isHidden)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this._hasLayout)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tBX.removeClass(this._wrapper, 'crm-view-progress-hide');\n\t\tBX.addClass(this._wrapper, 'crm-view-progress-show');\n\n\t\tthis._isHidden = false;\n\t}\n\n\thide()\n\t{\n\t\tif (this._isHidden)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this._hasLayout)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tBX.removeClass(this._wrapper, 'crm-view-progress-show');\n\t\tBX.addClass(this._wrapper, 'crm-view-progress-hide');\n\n\t\tthis._isHidden = true;\n\t}\n\n\tclearLayout()\n\t{\n\t\tif (!this._hasLayout)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tBX.remove(this._wrapper);\n\t\tthis._wrapper = null;\n\n\t\tthis._hasLayout = false;\n\n\t\tBX.onCustomEvent(window, 'BX.Crm.ProcessSummaryPanel:onClearLayout', [this]);\n\t}\n\n\tgetDisplayTimeout()\n\t{\n\t\treturn BX.prop.getInteger(this._settings, 'displayTimeout', 0);\n\t}\n\n\tonCloseButtonClick(e)\n\t{\n\t\tthis.clearLayout();\n\n\t\treturn BX.eventReturnFalse(e);\n\t}\n\n\tonToggleErrorButtonClick()\n\t{\n\t\tBX.toggleClass(this._wrapper, 'crm-view-progress-row-hidden');\n\t}\n}\n","/* eslint-disable @bitrix24/bitrix24-rules/no-pseudo-private,no-underscore-dangle,no-throw-literal */\nimport { ajax as Ajax, Type } from 'main.core';\nimport { ProcessRegistry } from '../process/process-registry';\nimport { ProcessState } from '../process/process-state';\nimport { Processor } from '../process/processor';\nimport { SummaryPanel } from '../process/summary-panel';\n\n/**\n * @abstract\n */\nexport class BatchManager\n{\n\t_id = '';\n\t_settings = {};\n\n\t_gridId = '';\n\t_entityTypeId = BX.CrmEntityType.enumeration.undefined;\n\t_entityIds = null;\n\t_filter = null;\n\t_operationHash = '';\n\n\t_containerId = '';\n\t_errors = null;\n\n\t_progress = null;\n\t_hasLayout = false;\n\n\t_isRunning = false;\n\n\t_progressChangeHandler = this.onProgress.bind(this);\n\t_documentUnloadHandler = this.onDocumentUnload.bind(this);\n\n\t_summaryLayoutHandler = this.onSummaryLayout.bind(this);\n\t_summaryClearLayoutHandler = this.onSummaryClearLayout.bind(this);\n\n\tstatic messages = {};\n\n\tconstructor(id, settings)\n\t{\n\t\tthis._id = Type.isStringFilled(id) ? id : `${this.getIdPrefix()}_${Math.random().toString().slice(2)}`;\n\t\tthis._settings = settings || {};\n\n\t\tthis._gridId = BX.prop.getString(this._settings, 'gridId', this._id);\n\t\tthis._entityTypeId = BX.prop.getInteger(\n\t\t\tthis._settings,\n\t\t\t'entityTypeId',\n\t\t\tBX.CrmEntityType.enumeration.undefined,\n\t\t);\n\n\t\tthis._containerId = BX.prop.getString(this._settings, 'container', '');\n\t\tif (this._containerId === '')\n\t\t{\n\t\t\tthrow `${this.getEventNamespace()}: Could not find container.`;\n\t\t}\n\n\t\t// region progress\n\t\tthis._progress = Processor.create(\n\t\t\t`${this.getIdPrefix()}_${this._id}`,\n\t\t\t{\n\t\t\t\tcontrollerActionName: this.getProcessActionName(),\n\t\t\t\tcontainer: this._containerId,\n\t\t\t\tenableCancellation: true,\n\t\t\t\ttitle: this.getMessage('title'),\n\t\t\t\ttimeout: 1000,\n\t\t\t\tstateTemplate: BX.prop.getString(this._settings, 'stateTemplate', null),\n\t\t\t\tenableLayout: false,\n\t\t\t},\n\t\t);\n\t\t// region\n\t\tthis._errors = [];\n\t}\n\n\tgetEventNamespace(): string\n\t{\n\t\treturn `BX.Crm.${this.getEventNamespacePostfix()}`;\n\t}\n\n\t/**\n\t * @abstract\n\t * @protected\n\t */\n\tgetEventNamespacePostfix(): string\n\t{\n\t\tthis.#throwNotImplementedError();\n\t}\n\n\t/**\n\t * @abstract\n\t * @protected\n\t */\n\tgetIdPrefix(): string\n\t{\n\t\tthis.#throwNotImplementedError();\n\t}\n\n\t/**\n\t * @abstract\n\t * @protected\n\t */\n\tgetProcessActionName(): string\n\t{\n\t\tthis.#throwNotImplementedError();\n\t}\n\n\t/**\n\t * @abstract\n\t * @protected\n\t */\n\tgetPrepareActionName(): string\n\t{\n\t\tthis.#throwNotImplementedError();\n\t}\n\n\t/**\n\t * @abstract\n\t * @protected\n\t */\n\tgetCancelActionName(): string\n\t{\n\t\tthis.#throwNotImplementedError();\n\t}\n\n\t#throwNotImplementedError(): void\n\t{\n\t\tthrow new Error('not implemented');\n\t}\n\n\tgetId(): string\n\t{\n\t\treturn this._id;\n\t}\n\n\tgetEntityIds(): null | number[]\n\t{\n\t\treturn this._entityIds;\n\t}\n\n\tsetEntityIds(entityIds: number[]): void\n\t{\n\t\tthis._entityIds = Type.isArray(entityIds) ? entityIds : [];\n\t}\n\n\tresetEntityIds(): void\n\t{\n\t\tthis._entityIds = [];\n\t}\n\n\tgetFilter(): ?Object\n\t{\n\t\treturn this._filter;\n\t}\n\n\tsetFilter(filter): void\n\t{\n\t\tthis._filter = Type.isPlainObject(filter) ? filter : null;\n\t}\n\n\tgetMessage(name: string, defaultValue: ?string = null): string\n\t{\n\t\tconst messages = BX.prop.getObject(\n\t\t\tthis._settings,\n\t\t\t'messages',\n\t\t\tthis.getDefaultMessages(),\n\t\t);\n\n\t\treturn BX.prop.getString(messages, name, defaultValue ?? name);\n\t}\n\n\t/**\n\t * @protected\n\t */\n\tgetDefaultMessages(): {[messageKey: string]: string}\n\t{\n\t\t// kinda 'late static binding'\n\t\treturn this.constructor.messages;\n\t}\n\n\tscrollInToView(): void\n\t{\n\t\tif (this._progress)\n\t\t{\n\t\t\tthis._progress.scrollInToView();\n\t\t\tthis.refreshGridHeader();\n\t\t}\n\t}\n\n\trefreshGridHeader(): void\n\t{\n\t\twindow.requestAnimationFrame(\n\t\t\t() => {\n\t\t\t\tconst grid = BX.Main.gridManager.getById(this._gridId);\n\t\t\t\tif (grid && grid.instance && grid.instance.pinHeader)\n\t\t\t\t{\n\t\t\t\t\tgrid.instance.pinHeader.refreshRect();\n\t\t\t\t\tgrid.instance.pinHeader._onScroll();\n\t\t\t\t}\n\t\t\t},\n\t\t);\n\t}\n\n\tlayout(): void\n\t{\n\t\tif (this._hasLayout)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis._progress.layout();\n\t\tthis._hasLayout = true;\n\t}\n\n\tclearLayout(): void\n\t{\n\t\tif (!this._hasLayout)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis._progress.clearLayout();\n\t\tthis._hasLayout = false;\n\t}\n\n\tgetState(): number\n\t{\n\t\treturn this._progress.getState();\n\t}\n\n\tgetProcessedItemCount(): number\n\t{\n\t\treturn this._progress.getProcessedItemCount();\n\t}\n\n\tgetTotalItemCount(): number\n\t{\n\t\treturn this._progress.getTotalItemCount();\n\t}\n\n\texecute(): void\n\t{\n\t\tthis.layout();\n\t\tthis.run();\n\n\t\twindow.setTimeout(this.scrollInToView.bind(this), 100);\n\t}\n\n\tisRunning(): boolean\n\t{\n\t\treturn this._isRunning;\n\t}\n\n\trun(): void\n\t{\n\t\tif (this._isRunning)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tthis._isRunning = true;\n\t\tProcessRegistry.Instance.registerProcessRun(this._gridId);\n\n\t\tBX.bind(window, 'beforeunload', this._documentUnloadHandler);\n\t\tthis.enableGridFilter(false);\n\n\t\tAjax.runAction(\n\t\t\tthis.getPrepareActionName(),\n\t\t\t{\n\t\t\t\tdata: {\n\t\t\t\t\tparams: this.getPrepareActionParams(),\n\t\t\t\t},\n\t\t\t},\n\t\t).then((response) => {\n\t\t\tconst hash = BX.prop.getString(\n\t\t\t\tBX.prop.getObject(response, 'data', {}),\n\t\t\t\t'hash',\n\t\t\t\t'',\n\t\t\t);\n\n\t\t\tif (hash === '')\n\t\t\t{\n\t\t\t\tthis.reset();\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis._operationHash = hash;\n\t\t\tthis._progress.setParams({ hash: this._operationHash });\n\t\t\tthis._progress.run();\n\n\t\t\tBX.addCustomEvent(this._progress, 'ON_AUTORUN_PROCESS_STATE_CHANGE', this._progressChangeHandler);\n\t\t}).catch(() => {\n\t\t\tthis.reset();\n\t\t});\n\t}\n\n\tgetPrepareActionParams(): Object\n\t{\n\t\tconst params = {\n\t\t\tgridId: this._gridId,\n\t\t\tentityTypeId: this._entityTypeId,\n\t\t\textras: BX.prop.getObject(this._settings, 'extras', {}),\n\t\t};\n\n\t\tif (Type.isArray(this._entityIds) && this._entityIds.length > 0)\n\t\t{\n\t\t\tparams.entityIds = this._entityIds;\n\t\t}\n\n\t\treturn params;\n\t}\n\n\tstop()\n\t{\n\t\tif (!this._isRunning)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tthis._isRunning = false;\n\n\t\tvoid Ajax.runAction(\n\t\t\tthis.getCancelActionName(),\n\t\t\t{ data: { params: { hash: this._operationHash } } },\n\t\t);\n\n\t\tthis.reset();\n\t}\n\n\treset()\n\t{\n\t\tBX.unbind(window, 'beforeunload', this._documentUnloadHandler);\n\t\tBX.removeCustomEvent(this._progress, 'ON_AUTORUN_PROCESS_STATE_CHANGE', this._progressChangeHandler);\n\n\t\tthis._isRunning = false;\n\t\tProcessRegistry.Instance.registerProcessStop(this._gridId);\n\t\tthis._operationHash = '';\n\t\tthis._errors = [];\n\n\t\tconst enableGridReload = this._progress.getProcessedItemCount() > 0;\n\t\tthis._progress.reset();\n\n\t\tif (this._hasLayout)\n\t\t{\n\t\t\twindow.setTimeout(this.clearLayout.bind(this), 100);\n\t\t}\n\n\t\tthis.enableGridFilter(true);\n\t\tif (enableGridReload)\n\t\t{\n\t\t\tBX.Main.gridManager.reload(this._gridId);\n\t\t}\n\t}\n\n\tenableGridFilter(enable)\n\t{\n\t\tconst container = this._gridId === '' ? null : BX(`${this._gridId}_search_container`);\n\t\tif (!container)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (enable)\n\t\t{\n\t\t\tBX.removeClass(container, 'main-ui-disable');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tBX.addClass(container, 'main-ui-disable');\n\t\t}\n\t}\n\n\tgetErrorCount(): number\n\t{\n\t\treturn this._errors ? this._errors.length : 0;\n\t}\n\n\tgetErrors(): Array\n\t{\n\t\treturn this._errors ?? [];\n\t}\n\n\t/**\n\t * Triggers a browser native warning when a user tries to close the tab that data may not be saved yet\n\t */\n\tonDocumentUnload(event): string\n\t{\n\t\t// recommended MDN way\n\t\tevent.preventDefault();\n\n\t\t// compatibility with older browsers\n\t\t// eslint-disable-next-line no-param-reassign\n\t\tevent.returnValue = true;\n\t}\n\n\tonProgress(sender): void\n\t{\n\t\tconst state = this._progress.getState();\n\t\tif (state === ProcessState.stopped)\n\t\t{\n\t\t\tthis.stop();\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst errors = this._progress.getErrors();\n\t\tif (errors.length > 0)\n\t\t{\n\t\t\tif (this._errors)\n\t\t\t{\n\t\t\t\tthis._errors = [...this._errors, ...errors];\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis._errors = errors;\n\t\t\t}\n\t\t}\n\n\t\tif (state === ProcessState.completed || state === ProcessState.error)\n\t\t{\n\t\t\tconst failed = this.getErrorCount();\n\t\t\tconst succeeded = this.getProcessedItemCount() - failed;\n\n\t\t\tBX.addCustomEvent(window, 'BX.Crm.ProcessSummaryPanel:onLayout', this._summaryLayoutHandler);\n\t\t\tSummaryPanel.create(\n\t\t\t\tthis._id,\n\t\t\t\t{\n\t\t\t\t\tcontainer: this._containerId,\n\t\t\t\t\tdata: { succeededCount: succeeded, failedCount: failed, errors: this.getErrors() },\n\t\t\t\t\tmessages: BX.prop.getObject(this._settings, 'messages', this.constructor.messages),\n\t\t\t\t\tnumberSubstitution: '#number#',\n\t\t\t\t\tdisplayTimeout: 1500,\n\t\t\t\t},\n\t\t\t).layout();\n\t\t\tthis.reset();\n\n\t\t\twindow.setTimeout(\n\t\t\t\t() => {\n\t\t\t\t\tBX.onCustomEvent(\n\t\t\t\t\t\twindow,\n\t\t\t\t\t\t`${this.getEventNamespace()}:onProcessComplete`,\n\t\t\t\t\t\t[this],\n\t\t\t\t\t);\n\t\t\t\t},\n\t\t\t\t300,\n\t\t\t);\n\t\t}\n\t}\n\n\tonSummaryLayout()\n\t{\n\t\tthis.refreshGridHeader();\n\t\tBX.removeCustomEvent(window, 'BX.Crm.ProcessSummaryPanel:onLayout', this._summaryLayoutHandler);\n\t\tBX.addCustomEvent(window, 'BX.Crm.ProcessSummaryPanel:onClearLayout', this._summaryClearLayoutHandler);\n\t}\n\n\tonSummaryClearLayout()\n\t{\n\t\tthis.refreshGridHeader();\n\t\tBX.removeCustomEvent(window, 'BX.Crm.ProcessSummaryPanel:onClearLayout', this._summaryClearLayoutHandler);\n\t}\n}\n","/* eslint-disable no-underscore-dangle */\nimport { Loc, Text } from 'main.core';\nimport { BatchManager } from './batch-manager';\n\n/**\n * @memberOf BX.Crm.Autorun\n */\nexport class BatchAssignmentManager extends BatchManager\n{\n\tstatic messages = {\n\t\t// default messages, you can override them via settings.messages\n\t\ttitle: Loc.getMessage('CRM_AUTORUN_BATCH_ASSIGN_TITLE'),\n\t\tsummaryCaption: Loc.getMessage('CRM_AUTORUN_BATCH_ASSIGN_SUMMARY_CAPTION'),\n\t\tsummarySucceeded: Loc.getMessage('CRM_AUTORUN_BATCH_ASSIGN_SUMMARY_SUCCEEDED'),\n\t\tsummaryFailed: Loc.getMessage('CRM_AUTORUN_BATCH_ASSIGN_SUMMARY_FAILED'),\n\t};\n\n\tstatic items = {};\n\n\t#assignedById: number;\n\n\tstatic getItem(id): ?BatchAssignmentManager\n\t{\n\t\treturn BX.prop.get(BatchAssignmentManager.items, id, null);\n\t}\n\n\tstatic create(id, settings): BatchAssignmentManager\n\t{\n\t\tconst self = new BatchAssignmentManager(id, settings);\n\t\tBatchAssignmentManager.items[self.getId()] = self;\n\n\t\treturn self;\n\t}\n\n\tgetIdPrefix(): string\n\t{\n\t\treturn 'crm_batch_assignment_mgr';\n\t}\n\n\tgetEventNamespacePostfix(): string\n\t{\n\t\treturn 'BatchAssignmentManager';\n\t}\n\n\tgetPrepareActionName(): string\n\t{\n\t\treturn 'crm.api.autorun.assign.prepare';\n\t}\n\n\tgetPrepareActionParams(): Object\n\t{\n\t\tconst params = super.getPrepareActionParams();\n\n\t\tparams.assignedById = this.#assignedById;\n\n\t\treturn params;\n\t}\n\n\tgetProcessActionName(): string\n\t{\n\t\treturn 'crm.api.autorun.assign.process';\n\t}\n\n\tgetCancelActionName(): string\n\t{\n\t\treturn 'crm.api.autorun.assign.cancel';\n\t}\n\n\tsetAssignedById(assignedById: number): void\n\t{\n\t\tthis.#assignedById = Text.toInteger(assignedById);\n\t}\n}\n","/* eslint-disable @bitrix24/bitrix24-rules/no-pseudo-private,no-underscore-dangle,no-throw-literal */\nimport { Builder } from 'crm.integration.analytics';\nimport { ajax as Ajax, Text, Type } from 'main.core';\nimport { sendData } from 'ui.analytics';\nimport { MessageBox } from 'ui.dialogs.messagebox';\nimport { ProcessRegistry } from '../process/process-registry';\nimport { ProcessState } from '../process/process-state';\nimport { Processor } from '../process/processor';\nimport { SummaryPanel } from '../process/summary-panel';\n\n/**\n * @memberOf BX.Crm.Autorun\n * @alias BX.Crm.BatchConversionManager\n */\nexport class BatchConversionManager\n{\n\t_id = '';\n\t_settings = {};\n\n\t_gridId = '';\n\t_config = null;\n\t_entityIds = null;\n\t_enableUserFieldCheck = true;\n\t_enableConfigCheck = true;\n\n\t_filter = null;\n\n\t_serviceUrl = '';\n\t_containerId = '';\n\t_errors = null;\n\n\t_progress = null;\n\t_hasLayout = false;\n\n\t_succeededItemCount = 0;\n\t_failedItemCount = 0;\n\t_isRunning = false;\n\t_messages = null;\n\n\t_progressChangeHandler = this.onProgress.bind(this);\n\t_documentUnloadHandler = this.onDocumentUnload.bind(this);\n\n\tstatic messages = {};\n\n\tstatic items = {};\n\n\tstatic getItem(id): ?BatchConversionManager\n\t{\n\t\treturn BX.prop.get(BatchConversionManager.items, id, null);\n\t}\n\n\tstatic create(id, settings): BatchConversionManager\n\t{\n\t\tconst self = new BatchConversionManager(id, settings);\n\t\tBatchConversionManager.items[self.getId()] = self;\n\n\t\treturn self;\n\t}\n\n\tconstructor(id, settings)\n\t{\n\t\tthis._id = Type.isStringFilled(id) ? id : `crm_batch_conversion_mgr_${Math.random().toString().slice(2)}`;\n\t\tthis._settings = settings || {};\n\n\t\tthis._gridId = BX.prop.getString(this._settings, 'gridId', this._id);\n\t\tthis._config = BX.prop.getObject(this._settings, 'config', {});\n\t\tthis._entityIds = BX.prop.getArray(this._settings, 'entityIds', []);\n\n\t\tthis._serviceUrl = BX.prop.getString(this._settings, 'serviceUrl', '');\n\t\tif (this._serviceUrl === '')\n\t\t{\n\t\t\tthrow \"BX.Crm.BatchConversionManager. Could not find 'serviceUrl' parameter in settings.\";\n\t\t}\n\n\t\tthis._containerId = BX.prop.getString(this._settings, 'container', '');\n\t\tif (this._containerId === '')\n\t\t{\n\t\t\tthrow 'BX.Crm.BatchConversionManager: Could not find container.';\n\t\t}\n\n\t\t// region progress\n\n\t\tconst processorSettings = {\n\t\t\tserviceUrl: this._serviceUrl,\n\t\t\tactionName: 'PROCESS_BATCH_CONVERSION',\n\t\t\tcontainer: this._containerId,\n\t\t\tenableCancellation: true,\n\t\t\ttitle: this.getMessage('title'),\n\t\t\tenableLayout: false,\n\t\t};\n\t\tconst stateTemplate = BX.prop.getString(this._settings, 'stateTemplate', null);\n\t\tif (Type.isStringFilled(stateTemplate))\n\t\t{\n\t\t\tprocessorSettings.stateTemplate = stateTemplate;\n\t\t}\n\n\t\tthis._progress = Processor.create(\n\t\t\tthis._id,\n\t\t\tprocessorSettings,\n\t\t);\n\t\t// region\n\t\tthis._errors = [];\n\t}\n\n\tisRunning(): boolean\n\t{\n\t\treturn this._isRunning;\n\t}\n\n\tresetEntityIds(): void\n\t{\n\t\tthis._entityIds = [];\n\t}\n\n\tgetId()\n\t{\n\t\treturn this._id;\n\t}\n\n\tgetConfig()\n\t{\n\t\treturn this._config;\n\t}\n\n\tsetConfig(config)\n\t{\n\t\tthis._config = Type.isPlainObject(config) ? config : {};\n\t}\n\n\tgetEntityIds()\n\t{\n\t\treturn this._entityIds;\n\t}\n\n\tsetEntityIds(entityIds)\n\t{\n\t\tthis._entityIds = Type.isArray(entityIds) ? entityIds : [];\n\t}\n\n\tgetFilter()\n\t{\n\t\treturn this._filter;\n\t}\n\n\tsetFilter(filter)\n\t{\n\t\tthis._filter = Type.isPlainObject(filter) ? filter : null;\n\t}\n\n\tisUserFieldCheckEnabled()\n\t{\n\t\treturn this._enableUserFieldCheck;\n\t}\n\n\tenableUserFieldCheck(enableUserFieldCheck)\n\t{\n\t\tthis._enableUserFieldCheck = enableUserFieldCheck;\n\t}\n\n\tisConfigCheckEnabled()\n\t{\n\t\treturn this._enableConfigCheck;\n\t}\n\n\tenableConfigCheck(enableConfigCheck)\n\t{\n\t\tthis._enableConfigCheck = enableConfigCheck;\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tif (this._messages && BX.prop.getString(this._messages, name, null))\n\t\t{\n\t\t\treturn BX.prop.getString(this._messages, name, name);\n\t\t}\n\n\t\tconst messages = BX.prop.getObject(this._settings, 'messages', BatchConversionManager.messages);\n\n\t\treturn BX.prop.getString(messages, name, name);\n\t}\n\n\tlayout()\n\t{\n\t\tif (this._hasLayout)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis._progress.layout();\n\t\tthis._hasLayout = true;\n\t}\n\n\tclearLayout()\n\t{\n\t\tif (!this._hasLayout)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis._progress.clearLayout();\n\t\tthis._hasLayout = false;\n\t}\n\n\tgetState()\n\t{\n\t\treturn this._progress.getState();\n\t}\n\n\tgetProcessedItemCount()\n\t{\n\t\treturn this._progress.getProcessedItemCount();\n\t}\n\n\tgetTotalItemCount()\n\t{\n\t\treturn this._progress.getTotalItemCount();\n\t}\n\n\texecute()\n\t{\n\t\tconst params = {\n\t\t\tGRID_ID: this._gridId,\n\t\t\tCONFIG: this._config,\n\t\t\tENABLE_CONFIG_CHECK: this._enableConfigCheck ? 'Y' : 'N',\n\t\t\tENABLE_USER_FIELD_CHECK: this._enableUserFieldCheck ? 'Y' : 'N',\n\t\t};\n\n\t\tif (this._filter === null)\n\t\t{\n\t\t\tparams.IDS = this._entityIds;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tparams.FILTER = this._filter;\n\t\t}\n\n\t\tconst data = {\n\t\t\tACTION: 'PREPARE_BATCH_CONVERSION',\n\t\t\tPARAMS: params,\n\t\t\tsessid: BX.bitrix_sessid(),\n\t\t};\n\n\t\tthis.#sendAnalyticsData('attempt');\n\n\t\tAjax(\n\t\t\t{\n\t\t\t\turl: this._serviceUrl,\n\t\t\t\tmethod: 'POST',\n\t\t\t\tdataType: 'json',\n\t\t\t\tdata,\n\t\t\t\tonsuccess: this.onPrepare.bind(this),\n\t\t\t},\n\t\t);\n\t}\n\n\t#sendAnalyticsData(status): void\n\t{\n\t\tif (!BX.CrmEntityType.isDefined(this._settings.entityTypeId))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tfor (const dstEntityTypeName of Object.keys(this._config))\n\t\t{\n\t\t\tif (this._config[dstEntityTypeName].active !== 'Y')\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tconst event = Builder.Entity.ConvertBatchEvent.createDefault(\n\t\t\t\tthis._settings.entityTypeId,\n\t\t\t\tBX.CrmEntityType.resolveId(dstEntityTypeName),\n\t\t\t);\n\n\t\t\tif (Type.isPlainObject(this._settings.analytics))\n\t\t\t{\n\t\t\t\tif (Type.isStringFilled(this._settings.analytics.c_section))\n\t\t\t\t{\n\t\t\t\t\tevent.setSection(this._settings.analytics.c_section);\n\t\t\t\t}\n\n\t\t\t\tif (Type.isStringFilled(this._settings.analytics.c_sub_section))\n\t\t\t\t{\n\t\t\t\t\tevent.setSubSection(this._settings.analytics.c_sub_section);\n\t\t\t\t}\n\n\t\t\t\tif (Type.isStringFilled(this._settings.analytics.c_element))\n\t\t\t\t{\n\t\t\t\t\tevent.setElement(this._settings.analytics.c_element);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tevent.setStatus(status);\n\n\t\t\tsendData(event.buildData());\n\t\t}\n\t}\n\n\tonPrepare(result)\n\t{\n\t\tconst data = Type.isPlainObject(result.DATA) ? result.DATA : {};\n\n\t\tconst status = BX.prop.getString(data, 'STATUS', '');\n\t\tthis._config = BX.prop.getObject(data, 'CONFIG', {});\n\n\t\tif (data.hasOwnProperty('messages') && Type.isPlainObject(data.messages))\n\t\t{\n\t\t\tthis._messages = data.messages;\n\t\t\tif (!BX.CrmLeadConverter.messages)\n\t\t\t{\n\t\t\t\tBX.CrmLeadConverter.messages = {};\n\t\t\t}\n\t\t\tBX.CrmLeadConverter.messages = Object.assign(BX.CrmLeadConverter.messages, data.messages);\n\t\t}\n\n\t\tif (status === 'ERROR')\n\t\t{\n\t\t\tthis.#sendAnalyticsData('error');\n\n\t\t\tconst errors = BX.prop.getArray(data, 'ERRORS', []);\n\n\t\t\tMessageBox.alert(\n\t\t\t\terrors.map((error) => Text.encode(error)).join('<br/>'),\n\t\t\t\tthis.getMessage('title'),\n\t\t\t);\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (status === 'REQUIRES_SYNCHRONIZATION')\n\t\t{\n\t\t\tconst syncEditor = BX.CrmLeadConverter.getCurrent().createSynchronizationEditor(\n\t\t\t\tthis._id,\n\t\t\t\tthis._config,\n\t\t\t\tBX.prop.getArray(data, 'FIELD_NAMES', []),\n\t\t\t);\n\t\t\tsyncEditor.addClosingListener(this.onSynchronizationEditorClose.bind(this));\n\t\t\tsyncEditor.show();\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.layout();\n\t\tthis.run();\n\t}\n\n\trun()\n\t{\n\t\tif (this._isRunning)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tthis._isRunning = true;\n\t\tProcessRegistry.Instance.registerProcessRun(this._gridId);\n\n\t\tthis._progress.setParams({ GRID_ID: this._gridId, CONFIG: this._config });\n\t\tthis._progress.run();\n\n\t\tBX.addCustomEvent(this._progress, 'ON_AUTORUN_PROCESS_STATE_CHANGE', this._progressChangeHandler);\n\t\tBX.bind(window, 'beforeunload', this._documentUnloadHandler);\n\t}\n\n\tstop()\n\t{\n\t\tif (!this._isRunning)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tthis._isRunning = false;\n\n\t\tthis.#sendAnalyticsData('cancel');\n\n\t\tAjax(\n\t\t\t{\n\t\t\t\turl: this._serviceUrl,\n\t\t\t\tmethod: 'POST',\n\t\t\t\tdataType: 'json',\n\t\t\t\tdata: { ACTION: 'STOP_BATCH_CONVERSION', PARAMS: { GRID_ID: this._gridId } },\n\t\t\t\tonsuccess: this.onStop.bind(this),\n\t\t\t},\n\t\t);\n\t}\n\n\tonStop(result)\n\t{\n\t\tthis.reset();\n\n\t\twindow.setTimeout(\n\t\t\t() => {\n\t\t\t\tBX.onCustomEvent(\n\t\t\t\t\twindow,\n\t\t\t\t\t'BX.Crm.BatchConversionManager:onStop',\n\t\t\t\t\t[this],\n\t\t\t\t);\n\t\t\t},\n\t\t\t300,\n\t\t);\n\t}\n\n\treset()\n\t{\n\t\tthis._progress.reset();\n\n\t\tBX.removeCustomEvent(this._progress, 'ON_AUTORUN_PROCESS_STATE_CHANGE', this._progressChangeHandler);\n\t\tBX.unbind(window, 'beforeunload', this._documentUnloadHandler);\n\n\t\tif ((this._succeededItemCount > 0 || this._failedItemCount > 0) && BX.getClass('BX.Main.gridManager'))\n\t\t{\n\t\t\tBX.Main.gridManager.reload(this._gridId);\n\t\t}\n\n\t\tthis._succeededItemCount = this._failedItemCount = 0;\n\t\tthis._isRunning = false;\n\t\tProcessRegistry.Instance.registerProcessStop(this._gridId);\n\n\t\tif (this._hasLayout)\n\t\t{\n\t\t\twindow.setTimeout(this.clearLayout.bind(this), 100);\n\t\t}\n\n\t\tthis._errors = [];\n\t}\n\n\tgetSucceededItemCount()\n\t{\n\t\treturn this._succeededItemCount;\n\t}\n\n\tgetFailedItemCount()\n\t{\n\t\treturn this._failedItemCount;\n\t}\n\n\tgetErrors()\n\t{\n\t\treturn this._errors;\n\t}\n\n\t/**\n\t * Triggers a browser native warning when a user tries to close the tab that data may not be saved yet\n\t */\n\tonDocumentUnload(event): string\n\t{\n\t\t// recommended MDN way\n\t\tevent.preventDefault();\n\n\t\t// compatibility with older browsers\n\t\t// eslint-disable-next-line no-param-reassign\n\t\tevent.returnValue = true;\n\t}\n\n\tonSynchronizationEditorClose(sender, args)\n\t{\n\t\tif (BX.prop.getBoolean(args, 'isCanceled', false))\n\t\t{\n\t\t\tthis.#sendAnalyticsData('cancel');\n\n\t\t\tthis.clearLayout();\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis._config = sender.getConfig();\n\t\tthis.run();\n\t}\n\n\tonProgress(sender)\n\t{\n\t\tconst state = this._progress.getState();\n\t\tif (state === ProcessState.stopped)\n\t\t{\n\t\t\tthis.stop();\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst errors = this._progress.getErrors();\n\t\tif (errors.length === 0)\n\t\t{\n\t\t\tthis._succeededItemCount++;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (this._errors)\n\t\t\t{\n\t\t\t\tthis._errors = [...this._errors, ...errors];\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis._errors = errors;\n\t\t\t}\n\n\t\t\tthis._failedItemCount++;\n\t\t\tthis.#sendAnalyticsData('error');\n\t\t}\n\n\t\tif (state === ProcessState.completed)\n\t\t{\n\t\t\tthis.#sendAnalyticsData('success');\n\n\t\t\tSummaryPanel.create(\n\t\t\t\tthis._id,\n\t\t\t\t{\n\t\t\t\t\tcontainer: this._containerId,\n\t\t\t\t\tdata:\n\t\t\t\t\t{\n\t\t\t\t\t\tsucceededCount: this.getSucceededItemCount(),\n\t\t\t\t\t\tfailedCount: this.getFailedItemCount(),\n\t\t\t\t\t\terrors: this.getErrors(),\n\t\t\t\t\t},\n\t\t\t\t\tmessages: BX.prop.getObject(this._settings, 'messages', null),\n\t\t\t\t\tnumberSubstitution: '#number_leads#',\n\t\t\t\t},\n\t\t\t).layout();\n\n\t\t\tthis.reset();\n\n\t\t\twindow.setTimeout(\n\t\t\t\t() => {\n\t\t\t\t\tBX.onCustomEvent(\n\t\t\t\t\t\twindow,\n\t\t\t\t\t\t'BX.Crm.BatchConversionManager:onProcessComplete',\n\t\t\t\t\t\t[this],\n\t\t\t\t\t);\n\t\t\t\t},\n\t\t\t\t300,\n\t\t\t);\n\t\t}\n\t}\n}\n","/* eslint-disable no-underscore-dangle */\nimport { Loc, Type } from 'main.core';\nimport { MessageBox } from 'ui.dialogs.messagebox';\nimport { BatchManager } from './batch-manager';\n\n/**\n * @memberOf BX.Crm.Autorun\n * @alias BX.Crm.BatchDeletionManager\n */\nexport class BatchDeletionManager extends BatchManager\n{\n\tstatic messages = {\n\t\t// default messages, you can override them via settings.messages\n\t\ttitle: Loc.getMessage('CRM_AUTORUN_BATCH_DELETE_TITLE'), // default message for all entity types\n\t\tconfirmation: Loc.getMessage('CRM_AUTORUN_BATCH_DELETE_CONFIRMATION'),\n\t\tconfirmationTitle: Loc.getMessage('CRM_AUTORUN_BATCH_DELETE_CONFIRMATION_TITLE'), // default message for all entity types\n\t\tconfirmationYesCaption: Loc.getMessage('CRM_AUTORUN_BATCH_DELETE_CONFIRMATION_YES_CAPTION'),\n\t\tsummaryCaption: Loc.getMessage('CRM_AUTORUN_BATCH_DELETE_SUMMARY_CAPTION'),\n\t\tsummarySucceeded: Loc.getMessage('CRM_AUTORUN_BATCH_DELETE_SUMMARY_SUCCEEDED'),\n\t\tsummaryFailed: Loc.getMessage('CRM_AUTORUN_BATCH_DELETE_SUMMARY_FAILED'),\n\t};\n\n\tstatic items = {};\n\n\tstatic getItem(id): ?BatchDeletionManager\n\t{\n\t\treturn BX.prop.get(BatchDeletionManager.items, id, null);\n\t}\n\n\tstatic create(id, settings): BatchDeletionManager\n\t{\n\t\tconst self = new BatchDeletionManager(id, settings);\n\t\tBatchDeletionManager.items[self.getId()] = self;\n\n\t\treturn self;\n\t}\n\n\tgetDefaultMessages(): { [p: string]: string }\n\t{\n\t\tconst messages = super.getDefaultMessages();\n\n\t\tconst entityTypeName = BX.CrmEntityType.resolveName(this._entityTypeId);\n\n\t\t/**\n\t\t * CRM_AUTORUN_BATCH_DELETE_TITLE_LEAD\n\t\t * CRM_AUTORUN_BATCH_DELETE_TITLE_DEAL\n\t\t * CRM_AUTORUN_BATCH_DELETE_TITLE_CONTACT\n\t\t * CRM_AUTORUN_BATCH_DELETE_TITLE_COMPANY\n\t\t *\n\t\t * CRM_AUTORUN_BATCH_DELETE_CONFIRMATION_TITLE_LEAD\n\t\t * CRM_AUTORUN_BATCH_DELETE_CONFIRMATION_TITLE_DEAL\n\t\t * CRM_AUTORUN_BATCH_DELETE_CONFIRMATION_TITLE_CONTACT\n\t\t * CRM_AUTORUN_BATCH_DELETE_CONFIRMATION_TITLE_COMPANY\n\t\t */\n\n\t\tconst specificTitle = Loc.getMessage(\n\t\t\t`CRM_AUTORUN_BATCH_DELETE_TITLE_${entityTypeName}`,\n\t\t);\n\t\tif (Type.isStringFilled(specificTitle))\n\t\t{\n\t\t\tmessages.title = specificTitle;\n\t\t}\n\n\t\tconst specificConfirmationTitle = Loc.getMessage(\n\t\t\t`CRM_AUTORUN_BATCH_DELETE_CONFIRMATION_TITLE_${entityTypeName}`,\n\t\t);\n\t\tif (Type.isStringFilled(specificConfirmationTitle))\n\t\t{\n\t\t\tmessages.confirmationTitle = specificConfirmationTitle;\n\t\t}\n\n\t\treturn messages;\n\t}\n\n\tgetIdPrefix(): string\n\t{\n\t\treturn 'crm_batch_deletion_mgr';\n\t}\n\n\tgetEventNamespacePostfix(): string\n\t{\n\t\treturn 'BatchDeletionManager';\n\t}\n\n\tgetPrepareActionName(): string\n\t{\n\t\treturn 'crm.api.autorun.delete.prepare';\n\t}\n\n\tgetProcessActionName(): string\n\t{\n\t\treturn 'crm.api.autorun.delete.process';\n\t}\n\n\tgetCancelActionName(): string\n\t{\n\t\treturn 'crm.api.autorun.delete.cancel';\n\t}\n\n\texecute()\n\t{\n\t\tMessageBox.confirm(\n\t\t\tthis.getMessage('confirmation'),\n\t\t\tthis.getMessage('confirmationTitle', '') || this.getMessage('title'),\n\t\t\t() => {\n\t\t\t\tsuper.execute();\n\n\t\t\t\t// to close messagebox\n\t\t\t\treturn true;\n\t\t\t},\n\t\t\tthis.getMessage('confirmationYesCaption'),\n\t\t);\n\t}\n}\n","/* eslint-disable no-underscore-dangle */\nimport { Loc } from 'main.core';\nimport { BatchManager } from './batch-manager';\n\n/**\n * @memberOf BX.Crm.Autorun\n */\nexport class BatchExclusionManager extends BatchManager\n{\n\tstatic messages = {\n\t\t// default messages, you can override them via settings.messages\n\t\ttitle: Loc.getMessage('CRM_AUTORUN_BATCH_EXCLUSION_TITLE'),\n\t\tsummaryCaption: Loc.getMessage('CRM_AUTORUN_BATCH_EXCLUSION_SUMMARY_CAPTION'),\n\t\tsummarySucceeded: Loc.getMessage('CRM_AUTORUN_BATCH_EXCLUSION_SUMMARY_SUCCEEDED'),\n\t\tsummaryFailed: Loc.getMessage('CRM_AUTORUN_BATCH_EXCLUSION_SUMMARY_FAILED'),\n\t};\n\n\tstatic items = {};\n\n\tstatic getItem(id): ?BatchExclusionManager\n\t{\n\t\treturn BX.prop.get(BatchExclusionManager.items, id, null);\n\t}\n\n\tstatic create(id, settings): BatchExclusionManager\n\t{\n\t\tconst self = new BatchExclusionManager(id, settings);\n\t\tBatchExclusionManager.items[self.getId()] = self;\n\n\t\treturn self;\n\t}\n\n\tgetIdPrefix(): string\n\t{\n\t\treturn 'crm_batch_exclusion_mgr';\n\t}\n\n\tgetEventNamespacePostfix(): string\n\t{\n\t\treturn 'BatchExclusionManager';\n\t}\n\n\tgetPrepareActionName(): string\n\t{\n\t\treturn 'crm.api.autorun.exclusion.prepare';\n\t}\n\n\tgetProcessActionName(): string\n\t{\n\t\treturn 'crm.api.autorun.exclusion.process';\n\t}\n\n\tgetCancelActionName(): string\n\t{\n\t\treturn 'crm.api.autorun.exclusion.cancel';\n\t}\n}\n","import { BatchManager } from './batch-manager';\nimport { Loc } from 'main.core';\n\nexport class BatchObserversManager extends BatchManager\n{\n\tstatic messages = {\n\t\ttitle: Loc.getMessage('CRM_AUTORUN_BATCH_OBSERVERS_TITLE'),\n\t\tsummaryCaption: Loc.getMessage('CRM_AUTORUN_BATCH_OBSERVERS_SUMMARY_CAPTION'),\n\t\tsummarySucceeded: Loc.getMessage('CRM_AUTORUN_BATCH_OBSERVERS_SUMMARY_SUCCEEDED'),\n\t\tsummaryFailed: Loc.getMessage('CRM_AUTORUN_BATCH_OBSERVERS_SUMMARY_FAILED'),\n\t};\n\n\tstatic items: Object = {};\n\t#observerIdList: Array<string> = [];\n\n\tstatic getItem(id): ?BatchObserversManager\n\t{\n\t\treturn BatchObserversManager.items[id] ?? null;\n\t}\n\n\tstatic create(id, settings): BatchObserversManager\n\t{\n\t\tconst self = new BatchObserversManager(id, settings);\n\t\tBatchObserversManager.items[self.getId()] = self;\n\n\t\treturn self;\n\t}\n\n\tgetCancelActionName(): string\n\t{\n\t\treturn 'crm.api.autorun.observers.cancel';\n\t}\n\n\tgetEventNamespacePostfix(): string\n\t{\n\t\treturn 'BatchObserversManager';\n\t}\n\n\tgetIdPrefix(): string\n\t{\n\t\treturn 'crm_batch_observers_mgr';\n\t}\n\n\tgetPrepareActionName(): string\n\t{\n\t\treturn 'crm.api.autorun.observers.prepare';\n\t}\n\n\tgetPrepareActionParams(): Object\n\t{\n\t\tconst params = super.getPrepareActionParams();\n\n\t\tparams.observerIdList = this.#observerIdList;\n\n\t\treturn params;\n\t}\n\n\tgetProcessActionName(): string\n\t{\n\t\treturn 'crm.api.autorun.observers.process';\n\t}\n\n\tsetObserverIdList(userIdList: Array<string>): void\n\t{\n\t\tthis.#observerIdList = userIdList;\n\t}\n}\n","import { Loc } from 'main.core';\nimport { BatchManager } from './batch-manager';\n\n/**\n * @memberOf BX.Crm.Autorun\n */\nexport class BatchRefreshAccountingDataManager extends BatchManager\n{\n\tstatic messages = {\n\t\t// default messages, you can override them via settings.messages\n\t\ttitle: Loc.getMessage('CRM_AUTORUN_BATCH_REFRESH_ACCOUNTING_DATA_TITLE'),\n\t\tsummaryCaption: Loc.getMessage('CRM_AUTORUN_BATCH_REFRESH_ACCOUNTING_DATA_SUMMARY_CAPTION'),\n\t\tsummarySucceeded: Loc.getMessage('CRM_AUTORUN_BATCH_REFRESH_ACCOUNTING_DATA_SUMMARY_SUCCEEDED'),\n\t\tsummaryFailed: Loc.getMessage('CRM_AUTORUN_BATCH_REFRESH_ACCOUNTING_DATA_SUMMARY_FAILED'),\n\t};\n\n\tstatic items = {};\n\n\tstatic getItem(id): ?BatchRefreshAccountingDataManager\n\t{\n\t\treturn BX.prop.get(BatchRefreshAccountingDataManager.items, id, null);\n\t}\n\n\tstatic create(id, settings): BatchRefreshAccountingDataManager\n\t{\n\t\tconst self = new BatchRefreshAccountingDataManager(id, settings);\n\t\tBatchRefreshAccountingDataManager.items[self.getId()] = self;\n\n\t\treturn self;\n\t}\n\n\tgetIdPrefix(): string\n\t{\n\t\treturn 'crm_batch_refresh_accounting_data_mgr';\n\t}\n\n\tgetEventNamespacePostfix(): string\n\t{\n\t\treturn 'BatchRefreshAccountingDataManager';\n\t}\n\n\tgetPrepareActionName(): string\n\t{\n\t\treturn 'crm.api.autorun.refreshaccountingdata.prepare';\n\t}\n\n\tgetProcessActionName(): string\n\t{\n\t\treturn 'crm.api.autorun.refreshaccountingdata.process';\n\t}\n\n\tgetCancelActionName(): string\n\t{\n\t\treturn 'crm.api.autorun.refreshaccountingdata.cancel';\n\t}\n}\n","/* eslint-disable no-underscore-dangle */\nimport { Loc } from 'main.core';\nimport { BatchManager } from './batch-manager';\n\n/**\n * @memberOf BX.Crm.Autorun\n */\nexport class BatchRestartAutomationManager extends BatchManager\n{\n\tstatic messages = {\n\t\t// default messages, you can override them via settings.messages\n\t\ttitle: Loc.getMessage('CRM_AUTORUN_BATCH_RESTART_AUTOMATION_TITLE'),\n\t\tsummaryCaption: Loc.getMessage('CRM_AUTORUN_BATCH_RESTART_AUTOMATION_SUMMARY_CAPTION'),\n\t\tsummarySucceeded: Loc.getMessage('CRM_AUTORUN_BATCH_RESTART_AUTOMATION_SUMMARY_SUCCEEDED'),\n\t\tsummaryFailed: Loc.getMessage('CRM_AUTORUN_BATCH_RESTART_AUTOMATION_SUMMARY_FAILED'),\n\t};\n\n\tstatic items = {};\n\n\tstatic getItem(id): ?BatchRestartAutomationManager\n\t{\n\t\treturn BX.prop.get(BatchRestartAutomationManager.items, id, null);\n\t}\n\n\tstatic create(id, settings): BatchRestartAutomationManager\n\t{\n\t\tconst self = new BatchRestartAutomationManager(id, settings);\n\t\tBatchRestartAutomationManager.items[self.getId()] = self;\n\n\t\treturn self;\n\t}\n\n\tgetIdPrefix(): string\n\t{\n\t\treturn 'crm_batch_restart_automation_mgr';\n\t}\n\n\tgetEventNamespacePostfix(): string\n\t{\n\t\treturn 'BatchRestartAutomationManager';\n\t}\n\n\tgetPrepareActionName(): string\n\t{\n\t\treturn 'crm.api.autorun.restartAutomation.prepare';\n\t}\n\n\tgetProcessActionName(): string\n\t{\n\t\treturn 'crm.api.autorun.restartAutomation.process';\n\t}\n\n\tgetCancelActionName(): string\n\t{\n\t\treturn 'crm.api.autorun.restartAutomation.cancel';\n\t}\n}\n","/* eslint-disable no-underscore-dangle */\nimport { Loc, Text } from 'main.core';\nimport { BatchManager } from './batch-manager';\n\n/**\n * @memberOf BX.Crm.Autorun\n */\nexport class BatchSetCategoryManager extends BatchManager\n{\n\tstatic messages = {\n\t\t// default messages, you can override them via settings.messages\n\t\ttitle: Loc.getMessage('CRM_AUTORUN_BATCH_SET_CATEGORY_TITLE'),\n\t\tsummaryCaption: Loc.getMessage('CRM_AUTORUN_BATCH_SET_CATEGORY_SUMMARY_CAPTION'),\n\t\tsummarySucceeded: Loc.getMessage('CRM_AUTORUN_BATCH_SET_CATEGORY_SUMMARY_SUCCEEDED'),\n\t\tsummaryFailed: Loc.getMessage('CRM_AUTORUN_BATCH_SET_CATEGORY_SUMMARY_FAILED'),\n\t};\n\n\tstatic items = {};\n\n\t#categoryId: number;\n\n\tstatic getItem(id): ?BatchSetCategoryManager\n\t{\n\t\treturn BX.prop.get(BatchSetCategoryManager.items, id, null);\n\t}\n\n\tstatic create(id, settings): BatchSetCategoryManager\n\t{\n\t\tconst self = new BatchSetCategoryManager(id, settings);\n\t\tBatchSetCategoryManager.items[self.getId()] = self;\n\n\t\treturn self;\n\t}\n\n\tgetIdPrefix(): string\n\t{\n\t\treturn 'crm_batch_set_category_mgr';\n\t}\n\n\tgetEventNamespacePostfix(): string\n\t{\n\t\treturn 'BatchSetCategoryManager';\n\t}\n\n\tgetPrepareActionName(): string\n\t{\n\t\treturn 'crm.api.autorun.setcategory.prepare';\n\t}\n\n\tgetPrepareActionParams(): Object\n\t{\n\t\tconst params = super.getPrepareActionParams();\n\n\t\tparams.categoryId = this.#categoryId;\n\n\t\treturn params;\n\t}\n\n\tgetProcessActionName(): string\n\t{\n\t\treturn 'crm.api.autorun.setcategory.process';\n\t}\n\n\tgetCancelActionName(): string\n\t{\n\t\treturn 'crm.api.autorun.setcategory.cancel';\n\t}\n\n\tsetCategoryId(categoryId: number): void\n\t{\n\t\tthis.#categoryId = Text.toInteger(categoryId);\n\t}\n}\n","/* eslint-disable no-underscore-dangle */\nimport { Loc, Type } from 'main.core';\nimport { BatchManager } from './batch-manager';\n\n/**\n * @memberOf BX.Crm.Autorun\n */\nexport class BatchSetExportManager extends BatchManager\n{\n\tstatic messages = {\n\t\t// default messages, you can override them via settings.messages\n\t\ttitle: Loc.getMessage('CRM_AUTORUN_BATCH_SET_EXPORT_TITLE'), // default message for all entity types\n\t\tsummaryCaption: Loc.getMessage('CRM_AUTORUN_BATCH_SET_EXPORT_SUMMARY_CAPTION'),\n\t\tsummarySucceeded: Loc.getMessage('CRM_AUTORUN_BATCH_SET_EXPORT_SUMMARY_SUCCEEDED'),\n\t\tsummaryFailed: Loc.getMessage('CRM_AUTORUN_BATCH_SET_EXPORT_SUMMARY_FAILED'),\n\t};\n\n\tstatic items = {};\n\n\t#export: boolean;\n\n\tstatic getItem(id): ?BatchSetExportManager\n\t{\n\t\treturn BX.prop.get(BatchSetExportManager.items, id, null);\n\t}\n\n\tstatic create(id, settings): BatchSetExportManager\n\t{\n\t\tconst self = new BatchSetExportManager(id, settings);\n\t\tBatchSetExportManager.items[self.getId()] = self;\n\n\t\treturn self;\n\t}\n\n\tgetDefaultMessages(): { [p: string]: string }\n\t{\n\t\tconst messages = super.getDefaultMessages();\n\n\t\tconst entityTypeName = BX.CrmEntityType.resolveName(this._entityTypeId);\n\n\t\t/**\n\t\t * CRM_AUTORUN_BATCH_SET_EXPORT_TITLE_CONTACT\n\t\t */\n\t\tconst specificTitle = Loc.getMessage(\n\t\t\t`CRM_AUTORUN_BATCH_SET_EXPORT_TITLE_${entityTypeName}`,\n\t\t);\n\t\tif (Type.isStringFilled(specificTitle))\n\t\t{\n\t\t\tmessages.title = specificTitle;\n\t\t}\n\n\t\treturn messages;\n\t}\n\n\tgetIdPrefix(): string\n\t{\n\t\treturn 'crm_batch_set_export_mgr';\n\t}\n\n\tgetEventNamespacePostfix(): string\n\t{\n\t\treturn 'BatchSetExportManager';\n\t}\n\n\tgetPrepareActionName(): string\n\t{\n\t\treturn 'crm.api.autorun.setexport.prepare';\n\t}\n\n\tgetPrepareActionParams(): Object\n\t{\n\t\tconst params = super.getPrepareActionParams();\n\n\t\tparams.export = this.#export ? 'Y' : 'N';\n\n\t\treturn params;\n\t}\n\n\tgetProcessActionName(): string\n\t{\n\t\treturn 'crm.api.autorun.setexport.process';\n\t}\n\n\tgetCancelActionName(): string\n\t{\n\t\treturn 'crm.api.autorun.setexport.cancel';\n\t}\n\n\tsetExport(isExport: boolean | 'Y' | 'N'): void\n\t{\n\t\tif (Type.isString(isExport))\n\t\t{\n\t\t\tthis.#export = isExport === 'Y';\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.#export = Boolean(isExport);\n\t\t}\n\t}\n}\n","/* eslint-disable no-underscore-dangle */\nimport { Loc, Type } from 'main.core';\nimport { BatchManager } from './batch-manager';\n\n/**\n * @memberOf BX.Crm.Autorun\n */\nexport class BatchSetOpenedManager extends BatchManager\n{\n\tstatic messages = {\n\t\t// default messages, you can override them via settings.messages\n\t\ttitle: Loc.getMessage('CRM_AUTORUN_BATCH_SET_OPENED_TITLE'),\n\t\tsummaryCaption: Loc.getMessage('CRM_AUTORUN_BATCH_SET_OPENED_SUMMARY_CAPTION'),\n\t\tsummarySucceeded: Loc.getMessage('CRM_AUTORUN_BATCH_SET_OPENED_SUMMARY_SUCCEEDED'),\n\t\tsummaryFailed: Loc.getMessage('CRM_AUTORUN_BATCH_SET_OPENED_SUMMARY_FAILED'),\n\t};\n\n\tstatic items = {};\n\n\t#isOpened: boolean;\n\n\tstatic getItem(id): ?BatchSetOpenedManager\n\t{\n\t\treturn BX.prop.get(BatchSetOpenedManager.items, id, null);\n\t}\n\n\tstatic create(id, settings): BatchSetOpenedManager\n\t{\n\t\tconst self = new BatchSetOpenedManager(id, settings);\n\t\tBatchSetOpenedManager.items[self.getId()] = self;\n\n\t\treturn self;\n\t}\n\n\tgetIdPrefix(): string\n\t{\n\t\treturn 'crm_batch_set_stage_mgr';\n\t}\n\n\tgetEventNamespacePostfix(): string\n\t{\n\t\treturn 'BatchSetOpenedManager';\n\t}\n\n\tgetPrepareActionName(): string\n\t{\n\t\treturn 'crm.api.autorun.setopened.prepare';\n\t}\n\n\tgetPrepareActionParams(): Object\n\t{\n\t\tconst params = super.getPrepareActionParams();\n\n\t\tparams.isOpened = this.#isOpened ? 'Y' : 'N';\n\n\t\treturn params;\n\t}\n\n\tgetProcessActionName(): string\n\t{\n\t\treturn 'crm.api.autorun.setopened.process';\n\t}\n\n\tgetCancelActionName(): string\n\t{\n\t\treturn 'crm.api.autorun.setopened.cancel';\n\t}\n\n\tsetIsOpened(isOpened: boolean | 'Y' | 'N'): void\n\t{\n\t\tif (Type.isString(isOpened))\n\t\t{\n\t\t\tthis.#isOpened = isOpened === 'Y';\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.#isOpened = Boolean(isOpened);\n\t\t}\n\t}\n}\n","/* eslint-disable no-underscore-dangle */\nimport { Loc } from 'main.core';\nimport { BatchManager } from './batch-manager';\n\n/**\n * @memberOf BX.Crm.Autorun\n */\nexport class BatchSetStageManager extends BatchManager\n{\n\tstatic messages = {\n\t\t// default messages, you can override them via settings.messages\n\t\ttitle: Loc.getMessage('CRM_AUTORUN_BATCH_SET_STAGE_TITLE'),\n\t\tsummaryCaption: Loc.getMessage('CRM_AUTORUN_BATCH_SET_STAGE_SUMMARY_CAPTION'),\n\t\tsummarySucceeded: Loc.getMessage('CRM_AUTORUN_BATCH_SET_STAGE_SUMMARY_SUCCEEDED'),\n\t\tsummaryFailed: Loc.getMessage('CRM_AUTORUN_BATCH_SET_STAGE_SUMMARY_FAILED'),\n\t};\n\n\tstatic items = {};\n\n\t#stageId: string;\n\n\tstatic getItem(id): ?BatchSetStageManager\n\t{\n\t\treturn BX.prop.get(BatchSetStageManager.items, id, null);\n\t}\n\n\tstatic create(id, settings): BatchSetStageManager\n\t{\n\t\tconst self = new BatchSetStageManager(id, settings);\n\t\tBatchSetStageManager.items[self.getId()] = self;\n\n\t\treturn self;\n\t}\n\n\tgetIdPrefix(): string\n\t{\n\t\treturn 'crm_batch_set_stage_mgr';\n\t}\n\n\tgetEventNamespacePostfix(): string\n\t{\n\t\treturn 'BatchSetStageManager';\n\t}\n\n\tgetPrepareActionName(): string\n\t{\n\t\treturn 'crm.api.autorun.setstage.prepare';\n\t}\n\n\tgetPrepareActionParams(): Object\n\t{\n\t\tconst params = super.getPrepareActionParams();\n\n\t\tparams.stageId = this.#stageId;\n\n\t\treturn params;\n\t}\n\n\tgetProcessActionName(): string\n\t{\n\t\treturn 'crm.api.autorun.setstage.process';\n\t}\n\n\tgetCancelActionName(): string\n\t{\n\t\treturn 'crm.api.autorun.setstage.cancel';\n\t}\n\n\tsetStageId(stageId: string): void\n\t{\n\t\tthis.#stageId = String(stageId);\n\t}\n}\n","/* eslint-disable no-underscore-dangle */\nimport { Loc } from 'main.core';\nimport { BatchManager } from './batch-manager';\n\ninterface TemplateParams {\n\tmessageBody: string;\n\tmessageTemplate: string;\n\tfromPhone: ?string;\n}\n\n/**\n * @memberOf BX.Crm.Autorun\n */\nexport class BatchWhatsappMessageManager extends BatchManager\n{\n\tstatic messages = {\n\t\t// default messages, you can override them via settings.messages\n\t\ttitle: Loc.getMessage('CRM_AUTORUN_BATCH_WHATSAPP_MESSAGE_TITLE'),\n\t\tsummaryCaption: Loc.getMessage('CRM_AUTORUN_BATCH_WHATSAPP_MESSAGE_SUMMARY_CAPTION'),\n\t\tsummarySucceeded: Loc.getMessage('CRM_AUTORUN_BATCH_WHATSAPP_MESSAGE_SUMMARY_SUCCEEDED'),\n\t\tsummaryFailed: Loc.getMessage('CRM_AUTORUN_BATCH_WHATSAPP_MESSAGE_SUMMARY_FAILED'),\n\t};\n\n\t#templateParams: ?TemplateParams = null;\n\n\tsetTemplateParams(templateParams: TemplateParams)\n\t{\n\t\tthis.#templateParams = templateParams;\n\t}\n\n\tstatic #instances: Map<string, BatchWhatsappMessageManager> = new Map();\n\n\tstatic getInstance(id, settings): BatchWhatsappMessageManager\n\t{\n\t\tif (BatchWhatsappMessageManager.#instances.has(id))\n\t\t{\n\t\t\treturn BatchWhatsappMessageManager.#instances.get(id);\n\t\t}\n\n\t\tconst instance = new BatchWhatsappMessageManager(id, settings);\n\t\tBatchWhatsappMessageManager.#instances.set(instance.getId(), instance);\n\n\t\treturn instance;\n\t}\n\n\tgetPrepareActionParams(): Object\n\t{\n\t\tif (!this.#templateParams)\n\t\t{\n\t\t\tthrow new Error('templateParams is required');\n\t\t}\n\n\t\tconst params = super.getPrepareActionParams();\n\n\t\treturn {\n\t\t\t...params,\n\t\t\textras: {\n\t\t\t\tmessageBody: this.#templateParams.messageBody,\n\t\t\t\tmessageTemplate: this.#templateParams.messageTemplate,\n\t\t\t\tfromPhone: this.#templateParams.fromPhone,\n\t\t\t},\n\t\t};\n\t}\n\n\tgetIdPrefix(): string\n\t{\n\t\treturn 'crm_batch_whatsappmessage_mgr';\n\t}\n\n\tgetEventNamespacePostfix(): string\n\t{\n\t\treturn 'BatchWhatsAppMessageManager';\n\t}\n\n\tgetPrepareActionName(): string\n\t{\n\t\treturn 'crm.api.autorun.whatsappmessage.prepare';\n\t}\n\n\tgetProcessActionName(): string\n\t{\n\t\treturn 'crm.api.autorun.whatsappmessage.process';\n\t}\n\n\tgetCancelActionName(): string\n\t{\n\t\treturn 'crm.api.autorun.whatsappmessage.cancel';\n\t}\n}\n","import { Dom, Tag, Type } from 'main.core';\n\n/**\n * @memberOf BX.Crm.Autorun\n */\nexport class ProgressBarRepository\n{\n\t#container: HTMLElement;\n\n\t#storage: Map<string, HTMLElement> = new Map();\n\n\tconstructor(container: HTMLElement)\n\t{\n\t\tif (!Type.isElementNode(container))\n\t\t{\n\t\t\tthrow new TypeError('expected element node');\n\t\t}\n\n\t\tthis.#container = container;\n\t}\n\n\tgetOrCreateProgressBarContainer(id: string): HTMLElement\n\t{\n\t\tconst fullId = ProgressBarRepository.getFullId(id);\n\n\t\tif (this.#storage.has(fullId))\n\t\t{\n\t\t\treturn this.#storage.get(fullId);\n\t\t}\n\n\t\tlet progressBarContainer = this.#container.querySelector(`div#${fullId}`);\n\t\tif (!progressBarContainer)\n\t\t{\n\t\t\tprogressBarContainer = Tag.render`<div id=\"${fullId}\"></div>`;\n\t\t\tDom.append(progressBarContainer, this.#container);\n\t\t}\n\n\t\tthis.#storage.set(fullId, progressBarContainer);\n\n\t\treturn progressBarContainer;\n\t}\n\n\tstatic getFullId(id: string): string\n\t{\n\t\treturn `crm-autorun-progress-bar-${id}`;\n\t}\n}\n","import { Reflection } from 'main.core';\nimport { BatchAssignmentManager } from './managers/batch-assignment-manager';\nimport { BatchConversionManager } from './managers/batch-conversion-manager';\nimport { BatchDeletionManager } from './managers/batch-deletion-manager';\nimport { BatchExclusionManager } from './managers/batch-exclusion-manager';\nimport { BatchObserversManager } from './managers/batch-observers-manager';\nimport { BatchRefreshAccountingDataManager } from './managers/batch-refresh-accounting-data-manager';\nimport { BatchRestartAutomationManager } from './managers/batch-restart-automation-manager';\nimport { BatchSetCategoryManager } from './managers/batch-set-category-manager';\nimport { BatchSetExportManager } from './managers/batch-set-export-manager';\nimport { BatchSetOpenedManager } from './managers/batch-set-opened-manager';\nimport { BatchSetStageManager } from './managers/batch-set-stage-manager';\nimport { BatchWhatsappMessageManager } from './managers/batch-whatsapp-message-manager';\nimport { ProcessPanel } from './process/process-panel';\nimport { ProcessRegistry } from './process/process-registry';\nimport { ProcessState } from './process/process-state';\nimport { Processor } from './process/processor';\nimport { SummaryPanel } from './process/summary-panel';\nimport { ProgressBarRepository } from './progress-bar-repository';\n\n// region Compatibility\nconst bxNamespace = Reflection.namespace('BX');\n\nbxNamespace.AutorunProcessManager = Processor;\nbxNamespace.AutorunProcessPanel = ProcessPanel;\nbxNamespace.AutoRunProcessState = ProcessState;\n\nconst bxCrmNamespace = Reflection.namespace('BX.Crm');\n\nbxCrmNamespace.ProcessSummaryPanel = SummaryPanel;\nbxCrmNamespace.BatchDeletionManager = BatchDeletionManager;\nbxCrmNamespace.BatchConversionManager = BatchConversionManager;\n// endregion\n\nexport {\n\tProcessRegistry,\n\tProcessor,\n\tProcessPanel,\n\tProcessState,\n\tSummaryPanel,\n\tProgressBarRepository,\n\tBatchAssignmentManager,\n\tBatchDeletionManager,\n\tBatchConversionManager,\n\tBatchSetCategoryManager,\n\tBatchSetStageManager,\n\tBatchSetOpenedManager,\n\tBatchSetExportManager,\n\tBatchExclusionManager,\n\tBatchWhatsappMessageManager,\n\tBatchRefreshAccountingDataManager,\n\tBatchRestartAutomationManager,\n\tBatchObserversManager,\n};\n"],"names":["instance","ProcessRegistry","Map","Instance","window","top","Reflection","getClass","BX","Crm","Autorun","isProcessRunning","gridId","getProcessCount","get","registerProcessRun","currentCount","set","registerProcessStop","newCount","ProcessState","Object","freeze","intermediate","running","completed","stopped","error","ProcessPanel","isExists","id","items","create","settings","self","getId","constructor","_id","_settings","_manager","_container","_wrapper","_stateNode","_progressNode","_hasLayout","_isHidden","getSetting","type","isElementNode","name","defaultval","hasOwnProperty","scrollInToView","rect","pos","scrollY","scrollTo","scrollX","layout","attrs","className","addClass","appendChild","text","children","prop","getBoolean","href","Loc","getMessage","events","click","onCancelButtonClick","bind","hasLayout","isHidden","show","removeClass","hide","clearLayout","remove","getManager","setManager","manager","onManagerStateChange","state","getState","processed","getProcessedItemCount","total","getTotalItemCount","progress","Math","floor","offset","template","innerHTML","replace","toString","e","stop","eventReturnFalse","Processor","createIfNotExists","_serviceUrl","_actionName","_controllerActionName","_params","_panel","_runHandle","_state","_processedItemCount","_totalItemCount","_errors","Type","isStringFilled","random","slice","getString","getObject","getTimeout","getInteger","defaultValue","messages","isUndefined","getParams","setParams","params","title","stateTemplate","panelSettings","container","enableCancellation","getPanel","setPanel","panel","refresh","getErrorCount","length","getErrors","run","startRequest","runAfter","timeout","setTimeout","onCustomEvent","reset","clearTimeout","_requestIsRunning","data","Ajax","runAction","then","result","onRequestSuccess","catch","onRequestFailure","ACTION","PARAMS","sessid","bitrix_sessid","url","method","dataType","onsuccess","onfailure","status","getArray","responseData","key","push","message","requestError","SummaryPanel","_data","summaryElements","substitution","RegExp","succeeded","failed","onToggleErrorButtonClick","elements","onCloseButtonClick","errors","i","errorElements","info","showUrl","props","target","getDisplayTimeout","toggleClass","BatchManager","_gridId","_entityTypeId","CrmEntityType","enumeration","undefined","_entityIds","_filter","_operationHash","_containerId","_progress","_isRunning","_progressChangeHandler","onProgress","_documentUnloadHandler","onDocumentUnload","_summaryLayoutHandler","onSummaryLayout","_summaryClearLayoutHandler","onSummaryClearLayout","getIdPrefix","getEventNamespace","controllerActionName","getProcessActionName","enableLayout","getEventNamespacePostfix","getPrepareActionName","getCancelActionName","getEntityIds","setEntityIds","entityIds","isArray","resetEntityIds","getFilter","setFilter","filter","isPlainObject","getDefaultMessages","refreshGridHeader","requestAnimationFrame","grid","Main","gridManager","getById","pinHeader","refreshRect","_onScroll","execute","isRunning","enableGridFilter","getPrepareActionParams","response","hash","addCustomEvent","entityTypeId","extras","unbind","removeCustomEvent","enableGridReload","reload","enable","event","preventDefault","returnValue","sender","succeededCount","failedCount","numberSubstitution","displayTimeout","Error","BatchAssignmentManager","getItem","assignedById","setAssignedById","Text","toInteger","summaryCaption","summarySucceeded","summaryFailed","BatchConversionManager","_config","_enableUserFieldCheck","_enableConfigCheck","_succeededItemCount","_failedItemCount","_messages","processorSettings","serviceUrl","actionName","getConfig","setConfig","config","isUserFieldCheckEnabled","enableUserFieldCheck","isConfigCheckEnabled","enableConfigCheck","GRID_ID","CONFIG","ENABLE_CONFIG_CHECK","ENABLE_USER_FIELD_CHECK","IDS","FILTER","onPrepare","DATA","CrmLeadConverter","assign","MessageBox","alert","map","encode","join","syncEditor","getCurrent","createSynchronizationEditor","addClosingListener","onSynchronizationEditorClose","onStop","getSucceededItemCount","getFailedItemCount","args","isDefined","dstEntityTypeName","keys","active","Builder","Entity","ConvertBatchEvent","createDefault","resolveId","analytics","c_section","setSection","c_sub_section","setSubSection","c_element","setElement","setStatus","sendData","buildData","BatchDeletionManager","entityTypeName","resolveName","specificTitle","specificConfirmationTitle","confirmationTitle","confirm","confirmation","confirmationYesCaption","BatchExclusionManager","BatchObserversManager","observerIdList","setObserverIdList","userIdList","BatchRefreshAccountingDataManager","BatchRestartAutomationManager","BatchSetCategoryManager","categoryId","setCategoryId","BatchSetExportManager","export","setExport","isExport","isString","Boolean","BatchSetOpenedManager","isOpened","setIsOpened","BatchSetStageManager","stageId","setStageId","String","BatchWhatsappMessageManager","setTemplateParams","templateParams","getInstance","has","messageBody","messageTemplate","fromPhone","ProgressBarRepository","TypeError","getOrCreateProgressBarContainer","fullId","getFullId","progressBarContainer","querySelector","Tag","render","Dom","append","bxNamespace","namespace","AutorunProcessManager","AutorunProcessPanel","AutoRunProcessState","bxCrmNamespace","ProcessSummaryPanel"],"mappings":"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"}