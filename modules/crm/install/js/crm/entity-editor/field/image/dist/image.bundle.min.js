this.BX=this.BX||{};(function(t,e,i){"use strict";var n=function(t){babelHelpers.inherits(e,t);function e(){babelHelpers.classCallCheck(this,e);return babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(e).apply(this,arguments))}babelHelpers.createClass(e,[{key:"loadInput",value:function t(){var e=this;i.ajax.runAction("crm.entity.renderImageInput",{data:{entityTypeName:this._editor.getEntityTypeName(),entityId:this._editor.getEntityId(),fieldName:this.getDataKey(),fieldValue:this.getValue()}}).then((function(t){var n=t.data.assets;var r=[].concat(babelHelpers.toConsumableArray(n.hasOwnProperty("css")?n.css:[]),babelHelpers.toConsumableArray(n.hasOwnProperty("js")?n.js:[]));BX.load(r,(function(){if(n.hasOwnProperty("string")){Promise.all(n.string.map((function(t){return i.Runtime.html(null,t)}))).then((function(){e.onEditorHtmlLoad(t.data.html)}))}else{e.onEditorHtmlLoad(t.data.html)}}))}),(function(t){e.onEditorHtmlLoad(t.errors[0].message)}))}},{key:"onEditorHtmlLoad",value:function t(e){var n=this;if(this._mode===BX.UI.EntityEditorMode.edit&&this._innerWrapper){i.Runtime.html(this._innerWrapper,e);BX.addCustomEvent(window,"onAfterPopupShow",this._dialogShowHandler);BX.addCustomEvent(window,"onPopupClose",this._dialogCloseHandler);setTimeout((function(){n.bindFileEvents()}),500)}}}],[{key:"create",value:function t(e,i){var n=new BX.Crm.EntityEditorImage;n.initialize(e,i);return n}}]);return e}(BX.UI.EntityEditorImage);e.EventEmitter.subscribe("BX.UI.EntityEditorControlFactory:onInitialize",(function(t){var e=t.getData();if(e[0]){e[0].methods["crm_image"]=function(t,e,i){if(t==="crm_image"){return BX.Crm.EntityEditorImage.create(e,i)}return null}}t.setData(e)}));t.EntityEditorImage=n})(this.BX.Crm=this.BX.Crm||{},BX.Event,BX);
//# sourceMappingURL=image.bundle.map.js