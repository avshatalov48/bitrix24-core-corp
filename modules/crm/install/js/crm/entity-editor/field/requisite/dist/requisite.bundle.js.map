{"version":3,"file":"requisite.bundle.js","sources":["../src/requisite-list.js","../src/requisite-editor.js","../src/requisite-controller.js","../src/preset-menu.js","../src/requisite-tooltip.js","../src/requisite-crm-field.js","../src/address-crm-field.js","../src/client-requisites.js"],"sourcesContent":["import {Type} from \"main.core\";\nimport {EventEmitter} from \"main.core.events\";\n\nexport class RequisiteList extends EventEmitter\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Crm.EntityEditorRequisiteField.RequisiteList');\n\t\tthis._items = [];\n\n\t\tthis.CHANGE_EVENT = 'onChange';\n\t}\n\n\tinitialize(value, settings)\n\t{\n\t\tif (!Type.isArray(value))\n\t\t{\n\t\t\tvalue = [];\n\t\t}\n\t\tfor (let item of value)\n\t\t{\n\t\t\tlet listItem = RequisiteListItem.create(item);\n\t\t\tthis._items.push(listItem);\n\t\t}\n\t}\n\n\tgetList()\n\t{\n\t\treturn this._items.filter((item) => !item.isDeleted());\n\t}\n\n\tgetListWithDeleted()\n\t{\n\t\treturn this._items;\n\t}\n\n\tisEmpty()\n\t{\n\t\treturn !this.getList().length;\n\t}\n\n\tgetSelected()\n\t{\n\t\tlet selectedId = this.getSelectedId();\n\t\treturn this.getById(selectedId);\n\t}\n\n\tgetSelectedId()\n\t{\n\t\tlet list = this.getList();\n\t\tif (!list.length)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\t\tfor (let index = 0; index < list.length; index++)\n\t\t{\n\t\t\tlet requisite = list[index];\n\t\t\tif (requisite.isSelected())\n\t\t\t{\n\t\t\t\treturn index;\n\t\t\t}\n\t\t}\n\t\treturn 0; // first element by default\n\t}\n\n\tgetById(id)\n\t{\n\t\tlet list = this.getList();\n\n\t\tif (null === id)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\t\tif (id >= 0 && id < list.length)\n\t\t{\n\t\t\treturn list[id];\n\t\t}\n\t\treturn null;\n\t}\n\n\tgetByRequisiteId(requisiteId)\n\t{\n\t\tlet list = this.getList();\n\t\treturn list\n\t\t\t.filter((item) => item.getRequisiteId() == requisiteId)\n\t\t\t.reduce((prev, current) => current, null);\n\t}\n\n\tsetSelected(requisiteId, bankDetailsId)\n\t{\n\t\tlet requisite = this.getById(requisiteId);\n\t\tif (requisite)\n\t\t{\n\t\t\tfor (let item of this.getList())\n\t\t\t{\n\t\t\t\tlet selected = (item === requisite);\n\t\t\t\titem.setSelected(selected);\n\n\t\t\t\tif (selected)\n\t\t\t\t{\n\t\t\t\t\titem.setSelectedBankDetails(\n\t\t\t\t\t\tType.isNull(bankDetailsId) ? requisite.getSelectedBankDetailId() : bankDetailsId);\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.notifyListChanged();\n\t\t}\n\t}\n\n\tgetNewRequisiteId()\n\t{\n\t\tlet maxExistedId = this.getList().reduce((prevId, item) =>\n\t\t{\n\t\t\tlet requisiteId = item.getRequisiteIdAsString();\n\t\t\tlet match = requisiteId ? requisiteId.match(RequisiteListItem.newRequisitePattern) : false;\n\t\t\tlet currentId = match && match[1] ? match[1] : -1;\n\t\t\treturn Math.max(prevId, currentId);\n\t\t}, -1);\n\n\t\treturn 'n' + (parseInt(maxExistedId) + 1);\n\t}\n\n\tindexOf(item)\n\t{\n\t\treturn this._items.indexOf(item);\n\t}\n\n\tadd(item)\n\t{\n\t\tthis._items.push(item);\n\t\tthis.notifyListChanged();\n\t}\n\n\tremove(item)\n\t{\n\t\tlet index = this._items.indexOf(item);\n\t\tif (index >= 0)\n\t\t{\n\t\t\tthis._items.splice(index, 1);\n\t\t}\n\t\tthis.notifyListChanged();\n\t}\n\n\tremovePostponed(item)\n\t{\n\t\tlet index = this._items.indexOf(item);\n\t\tif (index >= 0)\n\t\t{\n\t\t\titem.setDeleted(true);\n\t\t}\n\t\tthis.notifyListChanged();\n\t}\n\n\thide(item)\n\t{\n\t\tlet index = this._items.indexOf(item);\n\t\tif (index >= 0)\n\t\t{\n\t\t\titem.setAddressOnly(true);\n\t\t\titem.setChanged(true);\n\t\t}\n\t\tthis.notifyListChanged();\n\t}\n\n\tunhide(item)\n\t{\n\t\tlet index = this._items.indexOf(item);\n\t\tif (index >= 0)\n\t\t{\n\t\t\titem.setAddressOnly(false);\n\t\t\titem.setChanged(true);\n\t\t}\n\t\tthis.notifyListChanged();\n\t}\n\n\tnotifyListChanged()\n\t{\n\t\tthis.emit(this.CHANGE_EVENT);\n\t}\n\n\texportToModel()\n\t{\n\t\tlet result = [];\n\t\tfor (let item of this._items)\n\t\t{\n\t\t\tlet exportedItem = item.exportToModel();\n\t\t\tresult.push({...exportedItem});\n\t\t}\n\t\treturn result;\n\t}\n\n\tstatic create(value, settings)\n\t{\n\t\tlet self = new RequisiteList();\n\t\tself.initialize(value, settings);\n\t\treturn self;\n\t}\n}\n\nexport class RequisiteListItem\n{\n\tconstructor()\n\t{\n\n\t\tthis._data = null;\n\t}\n\n\tinitialize(value, settings)\n\t{\n\t\tif (Type.isPlainObject(value))\n\t\t{\n\t\t\tthis._data = {...value};\n\t\t\tthis._data.isNew = false;\n\t\t\tthis._data.isChanged = false;\n\t\t\tthis._data.isDeleted = false;\n\t\t\tthis._data.isAddressOnly = false;\n\t\t\tthis._data.formData = {};\n\t\t\tthis._data.addressData = {};\n\t\t\tif (!Type.isPlainObject(this._data.autocompleteState))\n\t\t\t{\n\t\t\t\tthis._data.autocompleteState = {};\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{ // new empty requisite\n\t\t\tthis._data = {\n\t\t\t\tisNew: true,\n\t\t\t\tisChanged: false,\n\t\t\t\tisDeleted: false,\n\t\t\t\tisAddressOnly: false,\n\t\t\t\tselected: false,\n\t\t\t\tpresetId: null,\n\t\t\t\trequisiteId: BX.prop.getString(settings, 'newRequisiteId', 'n0'),\n\t\t\t\trequisiteData: '',\n\t\t\t\trequisiteDataSign: '',\n\t\t\t\tbankDetails: [],\n\t\t\t\tbankDetailIdSelected: 0,\n\t\t\t\taddressList: {},\n\t\t\t\tvalue: {},\n\t\t\t\ttitle: '',\n\t\t\t\tsubtitle: '',\n\t\t\t\tautocompleteState: {},\n\t\t\t\tformData: {},\n\t\t\t\taddressData: {}\n\t\t\t};\n\t\t\tlet extraData = BX.prop.getObject(settings, 'newRequisiteExtraFields', {});\n\t\t\tthis._data = {...this._data, ...extraData};\n\t\t}\n\t\tthis._data.initialAddressDdta = null;\n\t\tthis.prepareViewData(this._data);\n\t}\n\n\tprepareViewData()\n\t{\n\t\ttry\n\t\t{\n\t\t\tthis._data.value = this._data.requisiteData ? JSON.parse(this._data.requisiteData) : {};\n\t\t}\n\t\tcatch (e)\n\t\t{\n\t\t\tthis._data.value = {};\n\t\t}\n\t\tthis._data.title = '';\n\t\tthis._data.subtitle = '';\n\t\tif (Type.isPlainObject(this._data.value) && Type.isPlainObject(this._data.value.viewData))\n\t\t{\n\t\t\tthis._data.title = this._data.value.viewData.title;\n\t\t\tthis._data.subtitle = this._data.value.viewData.subtitle;\n\t\t}\n\n\t\tif (this.getRequisiteIdAsString().match(RequisiteListItem.newRequisitePattern)) // was new requisite\n\t\t{\n\t\t\tlet newRequisiteId = BX.prop.getNumber(this.getFields(), 'ID', 0);\n\t\t\tif (newRequisiteId > 0) // if new requisite was saved\n\t\t\t{\n\t\t\t\tthis.setRequisiteId(newRequisiteId);\n\t\t\t}\n\t\t}\n\t\tthis.setAddressOnly(BX.prop.getString(this.getFields(), 'ADDRESS_ONLY', 'N') === 'Y');\n\n\t\tthis._data.bankDetails = [];\n\t\tif (Type.isPlainObject(this._data.value) && Type.isArray(this._data.value.bankDetailViewDataList))\n\t\t{\n\t\t\tthis._data.bankDetails = this.prepareBankDetailsList(this._data.value.bankDetailViewDataList);\n\t\t}\n\n\t\tthis._data.addressList = {...BX.prop.getObject(this.getFields(), 'RQ_ADDR', {})};\n\t}\n\n\tprepareBankDetailsList(bankDetails)\n\t{\n\t\tlet result = [];\n\t\tfor (let bankDetailsItem of bankDetails)\n\t\t{\n\t\t\tif (bankDetailsItem.deleted)\n\t\t\t{\n\t\t\t\tcontinue; // Deleted items should not be shown\n\t\t\t}\n\t\t\tif (Type.isPlainObject(bankDetailsItem.viewData))\n\t\t\t{\n\t\t\t\tlet item = {\n\t\t\t\t\t'title': bankDetailsItem.viewData.title,\n\t\t\t\t\t'id': bankDetailsItem.pseudoId,\n\t\t\t\t\t'value': '',\n\t\t\t\t\t'selected': !!bankDetailsItem.selected\n\t\t\t\t};\n\t\t\t\tif (Type.isArray(bankDetailsItem.viewData.fields) && bankDetailsItem.viewData.fields.length)\n\t\t\t\t{\n\t\t\t\t\titem.value = bankDetailsItem.viewData.fields\n\t\t\t\t\t\t.filter((item) => Type.isStringFilled(item.textValue))\n\t\t\t\t\t\t.map((item) => item.title + ': ' + item.textValue)\n\t\t\t\t\t\t.join(', ');\n\t\t\t\t}\n\t\t\t\tif (!item.value.length)\n\t\t\t\t{\n\t\t\t\t\titem.value = item.title;\n\t\t\t\t}\n\t\t\t\tresult.push(item);\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tisSelected()\n\t{\n\t\tif (!this._data.hasOwnProperty('justSelected'))\n\t\t{\n\t\t\treturn BX.prop.getBoolean(this._data, 'selected', false);\n\t\t}\n\t\treturn BX.prop.getBoolean(this._data, 'justSelected', false);\n\t}\n\n\tisChanged()\n\t{\n\t\treturn BX.prop.getBoolean(this._data, 'isChanged', false);\n\t}\n\n\tsetChanged(changed)\n\t{\n\t\tthis._data.isChanged = !!changed;\n\t}\n\n\tisNew()\n\t{\n\t\treturn BX.prop.getBoolean(this._data, 'isNew', false);\n\t}\n\n\tsetNew(isNew)\n\t{\n\t\tthis._data.isNew = !!isNew;\n\t}\n\n\tgetSelectedBankDetailId()\n\t{\n\t\tlet selectedBankDetailId = BX.prop.getInteger(this._data, 'selectedBankDetailId', -1);\n\t\tif (selectedBankDetailId !== -1)\n\t\t{\n\t\t\treturn selectedBankDetailId;\n\t\t}\n\t\tselectedBankDetailId = this.getBankDetails().reduce(\n\t\t\t(selected, item, index) =>\n\t\t\t{\n\t\t\t\treturn item.selected ? index : selected\n\t\t\t}, -1);\n\t\tthis._data.selectedBankDetailId = selectedBankDetailId;\n\n\t\treturn selectedBankDetailId > -1 ? selectedBankDetailId : 0;\n\t}\n\n\tgetBankDetailById(bankDetailId)\n\t{\n\t\tlet list = this.getBankDetails();\n\t\tif (null === bankDetailId)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\t\tif (bankDetailId >= 0 && bankDetailId < list.length)\n\t\t{\n\t\t\treturn list[bankDetailId];\n\t\t}\n\t\treturn null;\n\t}\n\n\tgetBankDetailByBankDetailId(bankDetailId)\n\t{\n\t\tlet list = this.getBankDetails();\n\t\tif (null === bankDetailId)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\t\treturn list\n\t\t\t.filter((item) => item.id == bankDetailId)\n\t\t\t.reduce((prev, current) => current, null);\n\t}\n\n\tgetTitle()\n\t{\n\t\treturn BX.prop.getString(this._data, 'title', \"\");\n\t}\n\n\tgetSubtitle()\n\t{\n\t\treturn BX.prop.getString(this._data, 'subtitle', \"\");\n\t}\n\n\tgetPresetId()\n\t{\n\t\treturn BX.prop.getString(this._data, 'presetId', \"0\");\n\t}\n\n\tgetPresetCountryId()\n\t{\n\t\treturn BX.prop.getString(this._data, 'presetCountryId', \"0\");\n\t}\n\n\tgetBankDetails()\n\t{\n\t\treturn BX.prop.getArray(this._data, 'bankDetails', []);\n\t}\n\n\tgetRequisiteId()\n\t{\n\t\treturn this._data.requisiteId;\n\t}\n\n\tgetRequisiteIdAsString()\n\t{\n\t\tlet requisiteId = this.getRequisiteId();\n\t\trequisiteId = Type.isNumber(requisiteId) ? String(requisiteId) : requisiteId;\n\t\treturn Type.isStringFilled(requisiteId) ? requisiteId : '';\n\t}\n\n\tgetRequisiteData()\n\t{\n\t\treturn this._data.requisiteData;\n\t}\n\n\tgetRequisiteDataSign()\n\t{\n\t\treturn this._data.requisiteDataSign;\n\t}\n\n\tgetFields()\n\t{\n\t\tif (Type.isPlainObject(this._data.value) && Type.isPlainObject(this._data.value.fields))\n\t\t{\n\t\t\treturn {...this._data.value.fields};\n\t\t}\n\t\treturn {};\n\t}\n\n\tgetAutocompleteData()\n\t{\n\t\tlet result = null;\n\n\t\tlet autocompleteState = this.getAutocompleteState();\n\t\tlet selectedAutocompleteItem = BX.prop.getObject(autocompleteState, 'currentItem', null);\n\t\tif (Type.isPlainObject(selectedAutocompleteItem))\n\t\t{\n\t\t\tresult = {\n\t\t\t\ttitle: BX.prop.getString(selectedAutocompleteItem, 'title', ''),\n\t\t\t\tsubTitle: BX.prop.getString(selectedAutocompleteItem, 'subTitle', '')\n\t\t\t}\n\t\t}\n\t\telse if (!Type.isUndefined(this._data.value.viewData)  && Type.isArray(this._data.value.viewData.fields))\n\t\t{\n\t\t\tlet fields =  this._data.value.viewData.fields;\n\t\t\tresult = {\n\t\t\t\ttitle: Type.isStringFilled(this._data.title) ? this._data.title : '',\n\t\t\t\tsubTitle: fields\n\t\t\t\t\t.filter((item) => item.name === 'RQ_INN' && item.textValue.length)\n\t\t\t\t\t.map((item) => item.title + ' ' + item.textValue)\n\t\t\t\t\t.join('')\n\t\t\t};\n\t\t}\n\t\treturn result;\n\t}\n\n\tsetAutocompleteState(state)\n\t{\n\t\tthis._data.autocompleteState = Type.isPlainObject(state) ? state : {};\n\t}\n\n\tgetAutocompleteState()\n\t{\n\t\treturn this._data.autocompleteState;\n\t}\n\n\tgetAddressList()\n\t{\n\t\treturn this._data.addressList;\n\t}\n\n\tsetAddressList(addressList)\n\t{\n\t\tthis._data.addressList = addressList;\n\t}\n\n\tsetInitialAddressData(addressData)\n\t{\n\t\tthis._data.initialAddressDdta = addressData;\n\t}\n\n\tgetAddressesForSave()\n\t{\n\t\tlet oldAddressTypes = Type.isPlainObject(this._data.initialAddressDdta) ?\n\t\t\tObject.keys(this._data.initialAddressDdta) : [];\n\n\t\tlet addresses = {};\n\t\tfor (let type of oldAddressTypes)\n\t\t{\n\t\t\taddresses[type] = \"\";\n\t\t}\n\t\tlet addressData = this.getAddressData();\n\t\tfor (let type in addressData)\n\t\t{\n\t\t\tif (addressData.hasOwnProperty(type) && addressData[type].length)\n\t\t\t{\n\t\t\t\taddresses[type] = addressData[type];\n\t\t\t}\n\t\t}\n\t\tfor (let type in addresses)\n\t\t{\n\t\t\tif (Type.isString(addresses[type]) && addresses[type] === \"\")\n\t\t\t{\n\t\t\t\taddresses[type] = {DELETED: 'Y'};\n\t\t\t}\n\t\t}\n\n\t\treturn addresses;\n\t}\n\n\tsetRequisiteId(requisiteId)\n\t{\n\t\tthis._data.requisiteId = requisiteId;\n\t}\n\n\tsetPresetId(presetId)\n\t{\n\t\tthis._data.presetId = presetId;\n\t}\n\n\tsetPresetCountryId(presetCountryId)\n\t{\n\t\tthis._data.presetCountryId = presetCountryId;\n\t}\n\n\tsetSelected(selected)\n\t{\n\t\tthis._data.selected = !!selected;\n\t\tthis._data.justSelected = !!selected;\n\t}\n\n\tsetRequisiteData(requisiteData, requisiteDataSign)\n\t{\n\t\tthis._data.requisiteData = requisiteData;\n\t\tif (Type.isStringFilled(requisiteDataSign))\n\t\t{\n\t\t\tthis._data.requisiteDataSign = requisiteDataSign;\n\t\t}\n\t\tthis.prepareViewData();\n\t}\n\n\tsetDeleted(isDeleted)\n\t{\n\t\tthis._data.isDeleted = !!isDeleted;\n\t}\n\n\tisDeleted()\n\t{\n\t\treturn this._data.isDeleted;\n\t}\n\n\tsetAddressOnly(isAddressOnly)\n\t{\n\t\tthis._data.isAddressOnly = !!isAddressOnly;\n\t\tthis.setFormData({...this.getFormData(), 'ADDRESS_ONLY': isAddressOnly ? 'Y':'N'})\n\t}\n\n\tisAddressOnly()\n\t{\n\t\treturn this._data.isAddressOnly;\n\t}\n\n\tisEmptyFormData()\n\t{\n\t\treturn Object.keys(this._data.formData).length <= 0;\n\t}\n\n\tgetFormData()\n\t{\n\t\treturn this._data.formData;\n\t}\n\n\tsetFormData(formData)\n\t{\n\t\tthis._data.formData = formData;\n\t}\n\n\tclearFormData()\n\t{\n\t\tthis.setFormData({});\n\t}\n\n\tisEmptyAddressData()\n\t{\n\t\treturn Object.keys(this._data.addressData).length <= 0;\n\t}\n\n\tgetAddressData()\n\t{\n\t\treturn this._data.addressData;\n\t}\n\n\tsetAddressData(addressData)\n\t{\n\t\tthis._data.addressData = addressData;\n\t}\n\n\tclearAddressData()\n\t{\n\t\tthis.setAddressData({});\n\t}\n\tsetSelectedBankDetails(bankDetailsId)\n\t{\n\t\tif (!Type.isArray(this._data.bankDetails))\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tif (Type.isNull(bankDetailsId))\n\t\t{\n\t\t\tbankDetailsId = 0; // first item by default\n\t\t}\n\t\tfor (let index = 0; index < this._data.bankDetails.length; index++)\n\t\t{\n\t\t\tthis._data.bankDetails[index].selected = (index === bankDetailsId);\n\t\t}\n\n\t\tthis._data.selectedBankDetailId = bankDetailsId;\n\t}\n\n\tclearSelectedBankDetails()\n\t{\n\t\tif (!Type.isArray(this._data.bankDetails))\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tfor (let index = 0; index < this._data.bankDetails.length; index++)\n\t\t{\n\t\t\tthis._data.bankDetails[index].selected = false;\n\t\t}\n\t}\n\n\texportToModel()\n\t{\n\t\tlet exportedItem = {...this._data};\n\t\tdelete (exportedItem.value);\n\t\tdelete (exportedItem.addressList);\n\t\tdelete (exportedItem.bankDetails);\n\t\tdelete (exportedItem.initialAddressDdta);\n\t\tdelete (exportedItem.isAddressOnly);\n\t\treturn exportedItem;\n\t}\n\n\tstatic create(value, settings)\n\t{\n\t\tlet self = new RequisiteListItem();\n\t\tself.initialize(value, settings);\n\t\treturn self;\n\t}\n}\n\nRequisiteListItem.newRequisitePattern = /n([0-9]+)/;","import {RequisiteListItem} from \"./requisite-list\";\nimport {EventEmitter} from \"main.core.events\";\nimport {Loc, Type} from \"main.core\";\nimport {MessageBox} from \"ui.dialogs.messagebox\";\n\nexport class EntityEditorRequisiteEditor\n{\n\tconstructor()\n\t{\n\t\tthis._requisiteList = null;\n\t\tthis._entityTypeId = null;\n\t\tthis._entityId = null;\n\t\tthis._contextId = null;\n\t\tthis._mode = BX.UI.EntityEditorMode.view;\n\n\t\tthis.currentSliderRequisiste = null;\n\t}\n\n\tinitialize(id, settings)\n\t{\n\t\tthis._entityTypeId = BX.prop.getInteger(settings, 'entityTypeId', 0);\n\t\tthis._entityId = BX.prop.getInteger(settings, 'entityId', 0);\n\t\tthis._contextId = BX.prop.getString(settings, 'contextId', \"\");\n\t\tthis._requisiteEditUrl = BX.prop.getString(settings, 'requisiteEditUrl', \"\");\n\n\t\tEventEmitter.subscribe('onLocalStorageSet', this.onExternalEvent.bind(this));\n\t}\n\n\tsetRequisiteList(requisiteList)\n\t{\n\t\tthis._requisiteList = requisiteList;\n\t}\n\n\tsetMode(mode)\n\t{\n\t\tthis._mode = mode;\n\t}\n\n\topen(requisite, options = {})\n\t{\n\t\tif (!(requisite instanceof RequisiteListItem))\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tthis.currentSliderRequisiste = requisite;\n\n\t\tlet sliderOptions = {\n\t\t\twidth: 950,\n\t\t\tcacheable: false,\n\t\t\tallowChangeHistory: false,\n\t\t\trequestMethod: 'post',\n\t\t\trequestParams: this.prepareSliderRequestParams(requisite, options)\n\t\t};\n\t\tBX.Crm.Page.openSlider(this.getSliderUrl(requisite), sliderOptions);\n\t}\n\n\tdeleteRequisite(id)\n\t{\n\t\tlet requisite = this._requisiteList.getById(id);\n\t\tif (requisite)\n\t\t{\n\t\t\tlet postData = {...this.prepareSliderRequestParams(requisite)};\n\t\t\tpostData.sessid = BX.bitrix_sessid();\n\t\t\tpostData.mode = 'delete';\n\t\t\tpostData.ACTION = 'SAVE';\n\n\t\t\tBX.ajax.post(this.getSliderUrl(requisite), postData, (data) =>\n\t\t\t{\n\t\t\t\ttry\n\t\t\t\t{\n\t\t\t\t\tlet json = JSON.parse(data);\n\t\t\t\t\tif (Type.isStringFilled(json.ERROR))\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.showError(json.ERROR);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tlet selectedRequisite = this._requisiteList.getSelected();\n\t\t\t\t\t\tlet selectedRemoved = (selectedRequisite === requisite);\n\t\t\t\t\t\tthis._requisiteList.remove(requisite);\n\n\t\t\t\t\t\tEventEmitter.emit(this, 'onAfterDeleteRequisite', {selectedRemoved});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tcatch (e)\n\t\t\t\t{\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tshowError(errorMessage)\n\t{\n\t\tMessageBox.alert(errorMessage, Loc.getMessage('REQUISITE_LIST_ITEM_ERROR_CAPTION'));\n\t}\n\n\tgetSliderUrl(requisite)\n\t{\n\t\tlet requisiteId = requisite.getRequisiteId();\n\n\t\tlet urlParams =\n\t\t\t{\n\t\t\t\tetype: this._entityTypeId,\n\t\t\t\teid: this._entityId,\n\t\t\t\texternal_context_id: this._contextId\n\t\t\t};\n\n\t\tlet presetId = requisite.getPresetId();\n\t\tif (presetId > 0)\n\t\t{\n\t\t\turlParams[\"pid\"] = presetId;\n\t\t}\n\n\t\treturn BX.util.add_url_param(\n\t\t\tthis.getRequisiteEditUrl(requisiteId),\n\t\t\turlParams\n\t\t);\n\t}\n\n\tprepareSliderRequestParams(requisite, options = {})\n\t{\n\t\tlet requestParams = {};\n\t\tlet requisiteData = requisite.getRequisiteData();\n\t\tif (requisite.isChanged() && Type.isString(requisiteData) && requisiteData.length)\n\t\t{\n\t\t\trequestParams['externalData'] = {\n\t\t\t\t'data': requisiteData,\n\t\t\t\t'sign': requisite.getRequisiteDataSign()\n\t\t\t};\n\t\t}\n\t\tif (requisite.isSelected())\n\t\t{\n\t\t\tlet autocompleteState = requisite.getAutocompleteState();\n\t\t\tif (Object.keys(autocompleteState).length)\n\t\t\t{\n\t\t\t\trequestParams['AUTOCOMPLETE'] = JSON.stringify(autocompleteState);\n\t\t\t\trequestParams['useFormData'] = 'Y';\n\t\t\t}\n\t\t}\n\t\tif (!requisite.isEmptyFormData())\n\t\t{\n\t\t\trequestParams = {...requestParams, ...requisite.getFormData()};\n\t\t}\n\t\tif (!requisite.isEmptyAddressData())\n\t\t{\n\t\t\trequestParams = {...requestParams, ...{RQ_ADDR: requisite.getAddressesForSave()}};\n\t\t}\n\t\trequestParams['mode'] = requisite.isNew() ? 'create' : 'edit';\n\t\tif (this.isViewMode())\n\t\t{\n\t\t\trequestParams['doSave'] = 'Y';\n\t\t}\n\t\tif (BX.prop.getBoolean(options, 'addBankDetailsItem', false))\n\t\t{\n\t\t\trequestParams['addBankDetailsItem'] = 'Y';\n\t\t}\n\t\tlet overriddenPresetId = BX.prop.getInteger(options, 'overriddenPresetId', 0);\n\t\tif (overriddenPresetId > 0)\n\t\t{\n\t\t\trequestParams['PRESET_ID'] = overriddenPresetId;\n\t\t\trequestParams['useFormData'] = 'Y';\n\t\t}\n\t\treturn requestParams;\n\t}\n\n\tgetRequisiteEditUrl(requisiteId)\n\t{\n\t\treturn this._requisiteEditUrl.replace(/#requisite_id#/gi, requisiteId);\n\t}\n\n\tgetSignRequisitePromise(requisite)\n\t{\n\t\tlet postData = this.prepareSliderRequestParams(requisite);\n\t\tpostData.sessid = BX.bitrix_sessid();\n\t\tpostData.PRESET_ID = requisite.getPresetId();\n\t\tpostData.useFormData = 'Y';\n\t\tpostData.ACTION = 'SAVE';\n\n\t\treturn BX.ajax.promise({\n\t\t\tmethod: 'post',\n\t\t\tdataType: 'json',\n\t\t\turl: this.getSliderUrl(requisite),\n\t\t\tdata: postData\n\t\t});\n\t}\n\n\tisViewMode()\n\t{\n\t\treturn this._mode === BX.UI.EntityEditorMode.view;\n\t}\n\n\tonExternalEvent(event)\n\t{\n\t\tlet dataArray = event.getData();\n\t\tif (!Type.isArray(dataArray))\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tlet data = dataArray[0];\n\n\t\tlet eventName = BX.prop.getString(data, \"key\", \"\");\n\n\t\tif (eventName !== \"BX.Crm.RequisiteSliderDetails:onCancelEdit\" && eventName !== \"BX.Crm.RequisiteSliderDetails:onSave\")\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tlet value = BX.prop.getObject(data, \"value\", {});\n\n\t\tlet contextId = BX.prop.getString(value, \"contextId\", \"\");\n\t\tif (contextId !== this._contextId)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (eventName === \"BX.Crm.RequisiteSliderDetails:onCancelEdit\")\n\t\t{\n\t\t\tthis.currentSliderRequisiste = null;\n\t\t}\n\t\tif (eventName === \"BX.Crm.RequisiteSliderDetails:onSave\")\n\t\t{\n\t\t\tlet requisite = this.currentSliderRequisiste;\n\t\t\tif (Type.isObject(requisite))\n\t\t\t{\n\t\t\t\tif (Type.isString(value.requisiteData))\n\t\t\t\t{\n\t\t\t\t\trequisite.setRequisiteData(value.requisiteData, value.requisiteDataSign);\n\t\t\t\t\trequisite.setAutocompleteState({});\n\t\t\t\t\trequisite.clearFormData();\n\t\t\t\t\trequisite.clearAddressData();\n\t\t\t\t}\n\n\t\t\t\tif (Type.isString(value.presetId))\n\t\t\t\t{\n\t\t\t\t\trequisite.setPresetId(value.presetId);\n\t\t\t\t}\n\t\t\t\tif (Type.isString(value.presetCountryId))\n\t\t\t\t{\n\t\t\t\t\trequisite.setPresetCountryId(value.presetCountryId);\n\t\t\t\t}\n\t\t\t\tif (this.isViewMode())\n\t\t\t\t{\n\t\t\t\t\trequisite.setNew(false);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\trequisite.setChanged(true);\n\t\t\t\t}\n\t\t\t\trequisite.setDeleted(false);\n\n\t\t\t\tif (this._requisiteList.indexOf(requisite) < 0)\n\t\t\t\t{\n\t\t\t\t\tthis._requisiteList.add(requisite);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis._requisiteList.notifyListChanged();\n\t\t\t\t}\n\n\t\t\t\tthis.currentSliderRequisiste = null;\n\n\t\t\t\tEventEmitter.emit(this, 'onAfterEditRequisite');\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tlet self = new EntityEditorRequisiteEditor();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n\n}","import {Dom, Loc, Tag, Type} from \"main.core\"\nimport {EventEmitter} from \"main.core.events\"\nimport {RequisiteList, RequisiteListItem} from \"./requisite-list\";\nimport {EntityEditorRequisiteEditor} from \"./requisite-editor\"\nimport {MessageBox} from 'ui.dialogs.messagebox';\n\nexport class EntityEditorRequisiteController extends BX.Crm.EntityEditorController\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._requisiteList = null;\n\t\tthis._requisiteEditor = null;\n\n\t\tthis._requisiteFieldId = null;\n\t\tthis._requisiteField = null;\n\t\tthis._requisiteInitData = null;\n\n\t\tthis._addressFieldId = null;\n\t\tthis._addressField = null;\n\t\tthis._isLoading = false;\n\n\t\tthis._formInputsWrapper = null;\n\t}\n\n\tdoInitialize()\n\t{\n\t\tsuper.doInitialize();\n\t\tthis._requisiteFieldId = this.getConfigStringParam(\"requisiteFieldId\", \"\");\n\t\tthis._addressFieldId = this.getConfigStringParam(\"addressFieldId\", \"\");\n\n\t\tthis.saveRequisiteInitData();\n\n\t\tEventEmitter.subscribe(this._editor, 'onFieldInit', this.onFieldInit.bind(this));\n\n\t\tthis.initRequisiteEditor();\n\t\tthis.initRequisiteList();\n\n\t\tlet selectedItem = BX.prop.getObject(this.getConfig(), \"requisiteBinding\", {});\n\t\tif (!Type.isUndefined(selectedItem.REQUISITE_ID) && !Type.isUndefined(selectedItem.BANK_DETAIL_ID))\n\t\t{\n\t\t\tlet requisite = this._requisiteList.getByRequisiteId(selectedItem.REQUISITE_ID);\n\t\t\tif (requisite)\n\t\t\t{\n\t\t\t\tlet bankDetail = selectedItem.BANK_DETAIL_ID > 0 ?\n\t\t\t\t\trequisite.getBankDetailByBankDetailId(selectedItem.BANK_DETAIL_ID) : null;\n\t\t\t\tthis._requisiteList.setSelected(\n\t\t\t\t\tthis._requisiteList.indexOf(requisite),\n\t\t\t\t\tbankDetail ? requisite.getBankDetails().indexOf(bankDetail) : null\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n\n\tinitRequisiteList()\n\t{\n\t\tthis._requisiteList = RequisiteList.create(this._requisiteInitData);\n\t\tthis._requisiteList.subscribe(this._requisiteList.CHANGE_EVENT, this.onChangeRequisites.bind(this));\n\n\t\tthis._requisiteEditor.setRequisiteList(this._requisiteList);\n\t}\n\n\tinitRequisiteEditor()\n\t{\n\t\tthis._requisiteEditor = EntityEditorRequisiteEditor.create(this._id + '_rq_editor', {\n\t\t\tentityTypeId: this._editor.getEntityTypeId(),\n\t\t\tentityId: this._editor.getEntityId(),\n\t\t\tcontextId: this._editor.getContextId(),\n\t\t\trequisiteEditUrl: this._editor.getRequisiteEditUrl('#requisite_id#')\n\t\t});\n\t\tEventEmitter.subscribe(this._requisiteEditor, 'onAfterEditRequisite', this.onRequisiteEditorAfterEdit.bind(this));\n\t\tEventEmitter.subscribe(this._requisiteEditor, 'onAfterDeleteRequisite', this.onRequisiteEditorAfterDelete.bind(this));\n\t}\n\n\tinitRequisiteField()\n\t{\n\t\tif (this._requisiteField)\n\t\t{\n\t\t\tthis._requisiteField.setRequisites(this._requisiteList);\n\t\t}\n\t}\n\n\tinitAddressField()\n\t{\n\t\tif (this._addressField)\n\t\t{\n\t\t\tlet countryId = 0;\n\t\t\tlet addressList = {};\n\t\t\tlet selectedRequisite = this._requisiteList ? this._requisiteList.getSelected() : null;\n\t\t\tif (selectedRequisite)\n\t\t\t{\n\t\t\t\tcountryId = selectedRequisite.getPresetCountryId();\n\t\t\t\tlet requisiteAddressList = selectedRequisite.getAddressList();\n\t\t\t\tfor (let type in requisiteAddressList)\n\t\t\t\t{\n\t\t\t\t\tif (\n\t\t\t\t\t\trequisiteAddressList.hasOwnProperty(type) &&\n\t\t\t\t\t\tBX.prop.getString(requisiteAddressList[type], 'DELETED', 'N') !== 'Y'\n\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\taddressList[type] = requisiteAddressList[type];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis._addressField.setCountryId(countryId);\n\t\t\tthis._addressField.setAddressList(addressList);\n\t\t}\n\t}\n\n\tsaveRequisiteInitData()\n\t{\n\t\tthis._requisiteInitData = this.getRequisiteFieldValue();\n\t}\n\n\tvalidate(result)\n\t{\n\t\tlet promises = [];\n\t\tfor (let requisite of this._requisiteList.getList())\n\t\t{\n\t\t\tif (!requisite.isChanged())\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (requisite.isEmptyFormData() && requisite.isEmptyAddressData())\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tlet signPromise = this.signRequisiteFields(requisite);\n\t\t\tsignPromise.then(\n\t\t\t\t(data) =>\n\t\t\t\t{\n\t\t\t\t\tlet error = BX.prop.getString(data, 'ERROR', '');\n\t\t\t\t\tlet entityDataObj = BX.prop.getObject(data, 'ENTITY_DATA', {});\n\t\t\t\t\tlet entityData = BX.prop.getString(entityDataObj, 'REQUISITE_DATA', \"\");\n\t\t\t\t\tlet entityDataSign = BX.prop.getString(entityDataObj, 'REQUISITE_DATA_SIGN', \"\");\n\t\t\t\t\tif (Type.isStringFilled(error))\n\t\t\t\t\t{\n\t\t\t\t\t\tresult.addError(BX.Crm.EntityValidationError.create({field: this.getFirstEditModeField()}));\n\t\t\t\t\t\tthis.showError(error);\n\t\t\t\t\t}\n\t\t\t\t\telse if (Type.isStringFilled(entityData) && Type.isStringFilled(entityDataSign))\n\t\t\t\t\t{\n\t\t\t\t\t\trequisite.setRequisiteData(entityData, entityDataSign);\n\t\t\t\t\t\trequisite.clearFormData();\n\t\t\t\t\t\trequisite.clearAddressData();\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tresult.addError(BX.Crm.EntityValidationError.create({field: this.getFirstEditModeField()}));\n\t\t\t\t\t\tthis.showError(Loc.getMessage('CRM_EDITOR_SAVE_ERROR_CONTENT'));\n\t\t\t\t\t}\n\t\t\t\t\treturn true;\n\t\t\t\t},\n\t\t\t\t() =>\n\t\t\t\t{\n\t\t\t\t\tresult.addError(BX.Crm.EntityValidationError.create({field: this.getFirstEditModeField()}));\n\t\t\t\t\tthis.showError(Loc.getMessage('CRM_EDITOR_SAVE_ERROR_CONTENT'));\n\t\t\t\t\treturn new Promise((resolve, reject) =>\n\t\t\t\t\t{\n\t\t\t\t\t\tresolve();\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t);\n\t\t\tpromises.push(signPromise);\n\t\t}\n\n\t\treturn (promises.length > 0) ? Promise.all(promises) : null;\n\t}\n\n\tsetSelectedRequisite(requisiteId, bankDetailId)\n\t{\n\t\tlet entityId = this._editor.getEntityId();\n\t\tif (!entityId)\n\t\t{\n\t\t\t// impossible situation, but...\n\t\t\treturn;\n\t\t}\n\t\tlet newSelectedRequisite = this._requisiteList.getById(requisiteId);\n\t\tif (!newSelectedRequisite || newSelectedRequisite.isNew())\n\t\t{\n\t\t\t// impossible situation too\n\t\t\treturn;\n\t\t}\n\t\tthis._requisiteList.setSelected(requisiteId, bankDetailId);\n\n\t\tlet selectedBankDetail = newSelectedRequisite.getBankDetailById(newSelectedRequisite.getSelectedBankDetailId());\n\t\tlet selectedBankDetailId = Type.isNull(selectedBankDetail) ? null : selectedBankDetail.id;\n\n\t\tthis.startLoading();\n\t\tBX.ajax.runAction(\n\t\t\t'crm.requisite.settings.setSelectedEntityRequisite',\n\t\t\t{\n\t\t\t\tdata: {\n\t\t\t\t\tentityTypeId: this._editor.getEntityTypeId(),\n\t\t\t\t\tentityId: entityId,\n\t\t\t\t\trequisiteId: newSelectedRequisite.getRequisiteId(),\n\t\t\t\t\tbankDetailId: selectedBankDetailId\n\t\t\t\t}\n\t\t\t}\n\t\t).then((response) =>\n\t\t{\n\t\t\tthis.stopLoading();\n\t\t}, () =>\n\t\t{\n\t\t\tthis.stopLoading();\n\t\t});\n\n\t}\n\n\topenEditor(requisite, options = {})\n\t{\n\t\tthis.setRequisiteInitAddrData(requisite);\n\t\tthis._requisiteEditor.setMode(this._editor.getMode());\n\t\tthis._requisiteEditor.open(requisite, options);\n\t}\n\n\tisViewMode()\n\t{\n\t\treturn this._editor.getMode() === BX.Crm.EntityEditorMode.view;\n\t}\n\n\tsetRequisiteInitAddrData(requisite)\n\t{\n\t\tlet requisiteId = requisite.getRequisiteId();\n\t\tlet rawRequisite = this._requisiteInitData\n\t\t\t.filter((item) => item.requisiteId === requisiteId)\n\t\t\t.reduce((prev, current) => current, null);\n\n\t\tif (Type.isPlainObject(rawRequisite))\n\t\t{\n\t\t\ttry\n\t\t\t{\n\t\t\t\tlet requisiteData = JSON.parse(rawRequisite.requisiteData);\n\t\t\t\tlet requisiteFields = BX.prop.getObject(requisiteData, 'fields', {});\n\t\t\t\tlet addressData = BX.prop.getObject(requisiteFields, 'RQ_ADDR', null);\n\t\t\t\trequisite.setInitialAddressData(addressData);\n\t\t\t}\n\t\t\tcatch (e)\n\t\t\t{\n\t\t\t\trequisite.setInitAddrData(null);\n\t\t\t}\n\t\t}\n\t}\n\n\tgetFirstEditModeField()\n\t{\n\t\tif (this._requisiteField && this._requisiteField._mode === BX.Crm.EntityEditorMode.edit)\n\t\t{\n\t\t\treturn this._requisiteField;\n\t\t}\n\t\tif (this._addressField && this._addressField._mode === BX.Crm.EntityEditorMode.edit)\n\t\t{\n\t\t\treturn this._addressField;\n\t\t}\n\t\treturn null;\n\t}\n\n\tupdateRequisiteFieldModel()\n\t{\n\t\tlet modelValue = this._requisiteList.exportToModel();\n\t\tif (this._requisiteField)\n\t\t{\n\t\t\tthis._model.setField(this._requisiteFieldId, modelValue);\n\t\t}\n\t\tthis.saveRequisiteInitData([...modelValue]);\n\t}\n\n\tgetRequisiteFieldValue()\n\t{\n\t\tif (!this._requisiteFieldId)\n\t\t{\n\t\t\treturn [];\n\t\t}\n\t\treturn this._model.getField(this._requisiteFieldId, []);\n\t}\n\n\taddEditorFormInputs()\n\t{\n\t\tthis._formInputsWrapper = Tag.render`<div></div>`;\n\t\tDom.append(this._formInputsWrapper, this._editor.getFormElement());\n\n\t\tfor (let requisite of this._requisiteList.getListWithDeleted())\n\t\t{\n\t\t\tif (requisite.isDeleted())\n\t\t\t{\n\t\t\t\tDom.append(Tag.render`<input type=\"hidden\" name=\"REQUISITES[${requisite.getRequisiteId()}][DELETED]\" value=\"Y\" >`, this._formInputsWrapper);\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (!requisite.isChanged())\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tlet dataInput = Tag.render`<input type=\"hidden\" name=\"REQUISITES[${requisite.getRequisiteId()}][DATA]\" value=\"${Tag.safe`${requisite.getRequisiteData()}`}\" >`;\n\t\t\tlet signInput = Tag.render`<input type=\"hidden\" name=\"REQUISITES[${requisite.getRequisiteId()}][SIGN]\" value=\"${requisite.getRequisiteDataSign()}\" >`;\n\t\t\tDom.append(dataInput, this._formInputsWrapper);\n\t\t\tDom.append(signInput, this._formInputsWrapper);\n\t\t}\n\t}\n\n\tremoveEditorFormInputs()\n\t{\n\t\tif (Type.isDomNode(this._formInputsWrapper))\n\t\t{\n\t\t\tDom.remove(this._formInputsWrapper);\n\t\t\tthis._formInputsWrapper = null;\n\t\t}\n\t}\n\n\tmarkFieldsAsChanged()\n\t{\n\t\tif (this._requisiteField)\n\t\t{\n\t\t\tthis._requisiteField.markAsChanged();\n\t\t}\n\t\tif (this._addressField)\n\t\t{\n\t\t\tthis._addressField.markAsChanged();\n\t\t}\n\t}\n\n\trollback()\n\t{\n\t\tthis.initRequisiteList();\n\t\tthis.initRequisiteField();\n\t\tthis.initAddressField();\n\t\tthis.updateRequisiteFieldModel();\n\t}\n\n\tisLoading()\n\t{\n\t\treturn !!this._isLoading;\n\t}\n\n\tstartLoading()\n\t{\n\t\tthis._isLoading = true;\n\t}\n\n\tstopLoading()\n\t{\n\t\tthis._isLoading = false;\n\t}\n\n\tshowError(errorMessage)\n\t{\n\t\tMessageBox.alert(errorMessage, Loc.getMessage('REQUISITE_LIST_ITEM_ERROR_CAPTION'));\n\t}\n\n\tprepareRequisiteByEventData(eventData)\n\t{\n\t\tlet requisite = this._requisiteList.getById(eventData.id);\n\t\tif (!requisite)\n\t\t{\n\t\t\tlet extraFields = {\n\t\t\t\tselected: this._requisiteList.isEmpty(),\n\t\t\t\tpresetId: eventData.defaultPresetId\n\t\t\t};\n\n\t\t\tif (eventData.hasOwnProperty('autocompleteState'))\n\t\t\t{\n\t\t\t\textraFields.autocompleteState = eventData.autocompleteState;\n\t\t\t}\n\n\t\t\trequisite = RequisiteListItem.create(null, {\n\t\t\t\t'newRequisiteId': this._requisiteList.getNewRequisiteId(),\n\t\t\t\t'newRequisiteExtraFields': extraFields\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (eventData.hasOwnProperty('autocompleteState'))\n\t\t\t{\n\t\t\t\trequisite.setAutocompleteState(eventData.autocompleteState);\n\t\t\t}\n\t\t}\n\t\treturn requisite;\n\t}\n\n\tgetDefaultPresetId()\n\t{\n\t\tif (this._requisiteField)\n\t\t{\n\t\t\treturn this._requisiteField.getDefaultPresetId();\n\t\t}\n\t\telse // if requisiteField is hidden\n\t\t{\n\t\t\tlet schemeElement = this._editor.getScheme().getAvailableElements()\n\t\t\t\t.filter((item) => (item.getName() === this._requisiteFieldId))\n\t\t\t\t.reduce((prev, current) => current, null);\n\n\t\t\tif (!schemeElement)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tfor (let preset of BX.prop.getArray(schemeElement.getData(), \"presets\", []))\n\t\t\t{\n\t\t\t\tif (preset.IS_DEFAULT)\n\t\t\t\t{\n\t\t\t\t\treturn preset.VALUE;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tsignRequisiteFields(requisite)\n\t{\n\t\tthis.setRequisiteInitAddrData(requisite);\n\t\tthis._requisiteEditor.setMode(this._editor.getMode());\n\t\treturn this._requisiteEditor.getSignRequisitePromise(requisite);\n\t}\n\n\tonFieldInit(event)\n\t{\n\t\tlet eventData = event.getData();\n\t\tlet field = eventData.field;\n\t\tif (field)\n\t\t{\n\t\t\tlet fieldId = field.getId();\n\t\t\tif (Type.isStringFilled(this._requisiteFieldId) && fieldId === this._requisiteFieldId)\n\t\t\t{\n\t\t\t\tthis._requisiteField = field;\n\t\t\t\tthis.initRequisiteField();\n\n\t\t\t\tEventEmitter.subscribe(this._requisiteField, 'onEditNew', this.onEditNewRequisite.bind(this));\n\t\t\t\tEventEmitter.subscribe(this._requisiteField, 'onEditExisted', this.onEditExistedRequisite.bind(this));\n\t\t\t\tEventEmitter.subscribe(this._requisiteField, 'onFinishAutocomplete', this.onFinishRequisiteAutocomplete.bind(this));\n\t\t\t\tEventEmitter.subscribe(this._requisiteField, 'onClearAutocomplete', this.onClearRequisiteAutocomplete.bind(this));\n\t\t\t\tEventEmitter.subscribe(this._requisiteField, 'onSetDefault', this.onSetDefaultRequisite.bind(this));\n\t\t\t\tEventEmitter.subscribe(this._requisiteField, 'onDelete', this.onDeleteRequisite.bind(this));\n\t\t\t\tEventEmitter.subscribe(this._requisiteField, 'onHide', this.onHideRequisite.bind(this));\n\t\t\t}\n\n\t\t\tif (Type.isStringFilled(this._addressFieldId) && fieldId === this._addressFieldId)\n\t\t\t{\n\t\t\t\tthis._addressField = field;\n\t\t\t\tthis.initAddressField();\n\n\t\t\t\tEventEmitter.subscribe(this._addressField, 'onAddressListUpdate', this.onAddressListUpdate.bind(this));\n\t\t\t}\n\t\t}\n\t}\n\n\tonEditNewRequisite(event)\n\t{\n\t\tlet params = event.getData();\n\n\t\tparams.selected = this._requisiteList.isEmpty();\n\t\tlet requisite = RequisiteListItem.create(null, {\n\t\t\t'newRequisiteId': this._requisiteList.getNewRequisiteId(),\n\t\t\t'newRequisiteExtraFields': params\n\t\t});\n\t\trequisite.setRequisiteId(this._requisiteList.getNewRequisiteId());\n\t\tthis.openEditor(requisite);\n\t}\n\n\tonEditExistedRequisite(event)\n\t{\n\t\tlet params = event.getData();\n\t\tlet requisite = this._requisiteList.getById(params.id);\n\t\tif (requisite)\n\t\t{\n\t\t\tlet options = BX.prop.getObject(params, 'options', {});\n\t\t\tif (Type.isPlainObject(options.autocompleteState))\n\t\t\t{\n\t\t\t\trequisite.setAutocompleteState(options.autocompleteState);\n\t\t\t}\n\t\t\tlet editorOptions = {};\n\t\t\tif (Type.isPlainObject(options.editorOptions))\n\t\t\t{\n\t\t\t\teditorOptions = options.editorOptions;\n\t\t\t}\n\t\t\tthis.openEditor(requisite, editorOptions);\n\t\t}\n\t}\n\n\tonClearRequisiteAutocomplete(event)\n\t{\n\t\tlet params = event.getData();\n\t\tlet requisite = this._requisiteList.getById(params.id);\n\t\tif (requisite)\n\t\t{\n\t\t\trequisite.clearFormData();\n\t\t}\n\t}\n\n\tonFinishRequisiteAutocomplete(event)\n\t{\n\t\tlet eventData = event.getData();\n\t\tlet requisite = this.prepareRequisiteByEventData(eventData);\n\t\tlet formData = BX.prop.getObject(BX.prop.getObject(eventData, 'data', {}), 'fields', {});\n\t\tif (formData.hasOwnProperty('RQ_ADDR'))\n\t\t{\n\t\t\tif (Type.isPlainObject(formData.RQ_ADDR))\n\t\t\t{\n\t\t\t\tlet oldAddr = requisite.getAddressList();\n\t\t\t\toldAddr = Type.isPlainObject(oldAddr) ? oldAddr : {};\n\n\t\t\t\tlet addr = {...oldAddr, ...formData.RQ_ADDR};\n\t\t\t\trequisite.setAddressData(addr);\n\t\t\t\trequisite.setAddressList(addr);\n\t\t\t}\n\t\t\tdelete (formData.RQ_ADDR);\n\t\t}\n\t\trequisite.setFormData(formData);\n\t\trequisite.setChanged(true);\n\t\trequisite.setDeleted(false);\n\t\tlet presetId = BX.prop.getInteger(formData, 'PRESET_ID', 0);\n\t\tif (presetId > 0)\n\t\t{\n\t\t\trequisite.setPresetId(presetId);\n\t\t}\n\t\tlet presetCountryId = BX.prop.getInteger(formData, 'PRESET_COUNTRY_ID', 0);\n\t\tif (presetCountryId > 0)\n\t\t{\n\t\t\trequisite.setPresetCountryId(presetCountryId);\n\t\t}\n\t\tif (this._requisiteList.indexOf(requisite) < 0)\n\t\t{\n\t\t\tthis._requisiteList.add(requisite);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis._requisiteList.notifyListChanged();\n\t\t}\n\t\tif (requisite.isAddressOnly())\n\t\t{\n\t\t\tthis._requisiteList.unhide(requisite);\n\t\t}\n\t}\n\n\tonSetDefaultRequisite(event)\n\t{\n\t\tlet eventData = event.getData();\n\t\tlet id = eventData.id;\n\t\tlet bankDetailId = eventData.bankDetailId;\n\n\t\tif (this._addressField && this._addressField.isChanged())\n\t\t{\n\t\t\tthis._editor.cancel();\n\t\t\treturn false; // have to save address first\n\t\t}\n\n\t\tthis.setSelectedRequisite(id, bankDetailId);\n\t\tthis.updateRequisiteFieldModel();\n\n\t\treturn true;\n\t}\n\n\tonDeleteRequisite(event)\n\t{\n\t\tlet params = event.getData();\n\t\tlet requisite = this._requisiteList.getById(params.id);\n\t\tif (requisite)\n\t\t{\n\t\t\tthis.setRequisiteInitAddrData(requisite);\n\t\t}\n\t\tif (params.postponed)\n\t\t{\n\t\t\tthis._requisiteList.removePostponed(requisite);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis._requisiteEditor.setMode(this._editor.getMode());\n\t\t\tthis._requisiteEditor.deleteRequisite(params.id);\n\t\t}\n\t}\n\n\tonHideRequisite(event)\n\t{\n\t\tlet params = event.getData();\n\t\tlet requisite = this._requisiteList.getById(params.id);\n\t\tif (requisite)\n\t\t{\n\t\t\tthis._requisiteList.hide(requisite);\n\t\t}\n\t}\n\n\tonChangeRequisites()\n\t{\n\t\tthis.initAddressField();\n\t}\n\n\tonAddressListUpdate(event)\n\t{\n\t\tlet eventData = event.getData();\n\t\teventData.id = this._requisiteList.getSelectedId();\n\n\t\teventData.defaultPresetId = this.getDefaultPresetId();\n\n\t\tlet requisite = this.prepareRequisiteByEventData(eventData);\n\n\t\tlet addresses = {};\n\t\tlet isEmptyAddress = true;\n\t\tfor (let address of eventData.value)\n\t\t{\n\t\t\taddresses[address.type] = address.value;\n\t\t\tif (Type.isStringFilled(address.value))\n\t\t\t{\n\t\t\t\tisEmptyAddress = false;\n\t\t\t}\n\t\t}\n\n\t\trequisite.setAddressData(addresses);\n\t\trequisite.setAddressList(addresses);\n\n\t\trequisite.setChanged(true);\n\t\tif (!isEmptyAddress)\n\t\t{\n\t\t\trequisite.setDeleted(false);\n\t\t}\n\n\t\tif (this._requisiteList.indexOf(requisite) < 0)\n\t\t{\n\t\t\tif (!isEmptyAddress)\n\t\t\t{\n\t\t\t\trequisite.setAddressOnly(true);\n\t\t\t\tthis._requisiteList.add(requisite);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\t//  remove requisite if address is empty and requisite contain only address\n\t\t\tif (isEmptyAddress && requisite.isAddressOnly())\n\t\t\t{\n\t\t\t\tthis._requisiteList.removePostponed(requisite);\n\t\t\t}\n\t\t\tthis._requisiteList.notifyListChanged();\n\t\t}\n\t}\n\n\tonBeforeSubmit()\n\t{\n\t\tsuper.onBeforeSubmit();\n\t\tthis.addEditorFormInputs();\n\t}\n\n\tonBeforesSaveControl(data)\n\t{\n\t\tif (!data.hasOwnProperty('REQUISITES'))\n\t\t{\n\t\t\tdata['REQUISITES'] = {};\n\t\t}\n\t\tfor (let requisite of this._requisiteList.getListWithDeleted())\n\t\t{\n\t\t\tif (!requisite.isChanged() && !requisite.isDeleted())\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tlet requisiteData = {};\n\t\t\tif (requisite.isDeleted())\n\t\t\t{\n\t\t\t\trequisiteData['DELETED'] = 'Y';\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\trequisiteData['DATA'] = requisite.getRequisiteData();\n\t\t\t\trequisiteData['SIGN'] = requisite.getRequisiteDataSign();\n\t\t\t}\n\t\t\tdata['REQUISITES'][requisite.getRequisiteId()] = requisiteData;\n\t\t}\n\t\treturn data;\n\t}\n\n\tonAfterSave()\n\t{\n\t\tsuper.onAfterSave();\n\t\tthis.saveRequisiteInitData(this.getRequisiteFieldValue());\n\n\t\tthis.initRequisiteList();\n\t\tthis.initRequisiteField();\n\t\tthis.initAddressField();\n\n\t\tthis.removeEditorFormInputs();\n\t}\n\n\tonRequisiteEditorAfterEdit()\n\t{\n\t\tif (this.isViewMode())\n\t\t{\n\t\t\tthis.updateRequisiteFieldModel();\n\t\t}\n\t\tthis.markFieldsAsChanged();\n\t}\n\n\tonRequisiteEditorAfterDelete(event)\n\t{\n\t\tlet data = event.getData();\n\t\tlet isEmptyRequisitesList = this._requisiteList.isEmpty();\n\t\tif (!isEmptyRequisitesList && data.selectedRemoved)\n\t\t{\n\t\t\t// set new default requisite\n\t\t\tthis.setSelectedRequisite(0, 0);\n\t\t}\n\t\tthis.updateRequisiteFieldModel();\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tlet self = new EntityEditorRequisiteController();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}","import {MenuManager} from \"main.popup\";\nimport {EventEmitter} from \"main.core.events\";\nimport {MessageBox} from 'ui.dialogs.messagebox';\nimport {Loc, Text} from \"main.core\";\n\nexport class PresetMenu extends EventEmitter\n{\n\tconstructor(id, presetList)\n\t{\n\t\tsuper();\n\t\tthis._isShown = false;\n\t\tthis.menuId = id;\n\t\tthis.presetList = presetList;\n\t}\n\n\ttoggle(bindElement)\n\t{\n\t\tif (this._isShown)\n\t\t{\n\t\t\tthis.close();\n\t\t}\n\t\telse if (bindElement)\n\t\t{\n\t\t\tthis.show(bindElement);\n\t\t}\n\t}\n\n\tshow(bindElement)\n\t{\n\t\tif (this._isShown)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this.presetList || !this.presetList.length)\n\t\t{\n\t\t\tMessageBox.alert(Loc.getMessage('REQUISITE_LIST_EMPTY_PRESET_LIST'), Loc.getMessage('REQUISITE_LIST_ITEM_ERROR_CAPTION'));\n\t\t\treturn;\n\t\t}\n\t\tlet menu = [];\n\t\tfor (let item of this.presetList)\n\t\t{\n\t\t\tmenu.push(\n\t\t\t\t{\n\t\t\t\t\ttext: Text.encode(item.name),\n\t\t\t\t\tvalue: item.value,\n\t\t\t\t\tonclick: this.onSelect.bind(this, item)\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\tMenuManager.show(\n\t\t\tthis.menuId,\n\t\t\tbindElement,\n\t\t\tmenu,\n\t\t\t{\n\t\t\t\tangle: false,\n\t\t\t\tcacheable: false,\n\t\t\t\tevents:\n\t\t\t\t\t{\n\t\t\t\t\t\tonPopupShow: () =>\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis._isShown = true;\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonPopupClose: () =>\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis._isShown = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t}\n\t\t);\n\t}\n\n\tclose()\n\t{\n\t\tif (!this._isShown)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet menu = MenuManager.getMenuById(this.menuId);\n\t\tif (menu)\n\t\t{\n\t\t\tmenu.popupWindow.close();\n\t\t}\n\t}\n\n\tisShown()\n\t{\n\t\treturn this._isShown;\n\t}\n\n\tonSelect(item)\n\t{\n\t\tthis.close();\n\t\tthis.emit('onSelect', item);\n\t}\n}","import {PopupManager} from \"main.popup\";\nimport {Tag, Type, Loc, Text} from \"main.core\";\nimport {EventEmitter} from \"main.core.events\";\nimport {PresetMenu} from \"./preset-menu\";\nimport {Loader} from \"main.loader\";\n\nexport class EntityEditorRequisiteTooltip\n{\n\tinitialize(id, settings)\n\t{\n\t\tthis._id = BX.type.isNotEmptyString(id) ? id : BX.util.getRandomString(4);\n\t\tthis._settings = settings ? settings : {};\n\n\t\tthis._padding = BX.prop.getInteger(this._settings, 'padding', 20);\n\t\tthis._showTimer = false;\n\t\tthis._closeTimer = false;\n\t\tthis._closeTimeout = BX.prop.getInteger(this._settings, 'closeTimeout', 700);\n\t\tthis._showTimeout = BX.prop.getInteger(this._settings, 'showTimeout', 500);\n\t\tthis._popupId = this._id + '_popup';\n\n\t\tthis._isReadonly = BX.prop.getBoolean(this._settings, 'readonly', true);\n\t\tthis._canChangeDefaultRequisite = BX.prop.getBoolean(this._settings, 'canChangeDefaultRequisite', true);\n\n\t\tthis._bindElement = null;\n\t\tthis._wrapper = null;\n\t\tthis._requisiteList = null;\n\n\t\tthis._isLoading = false;\n\t\tthis._changeRequisistesHandler = this.onChangeRequisites.bind(this);\n\n\t\tthis.presetMenu = new PresetMenu(this._id + '_preset_menu', BX.prop.getArray(this._settings, 'presets', []));\n\t\tthis.presetMenu.subscribe('onSelect', this.onAddRequisite.bind(this));\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tlet self = new EntityEditorRequisiteTooltip();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n\n\tsetRequisites(requisiteList)\n\t{\n\t\tthis._requisiteList = requisiteList;\n\t\trequisiteList.unsubscribe(requisiteList.CHANGE_EVENT, this._changeRequisistesHandler);\n\t\trequisiteList.subscribe(requisiteList.CHANGE_EVENT, this._changeRequisistesHandler);\n\t\tthis.refreshLayout();\n\t}\n\n\tsetBindElement(bindElement, wrapper)\n\t{\n\t\tthis._bindElement = bindElement;\n\t\tif (!Type.isDomNode(wrapper))\n\t\t{\n\t\t\twrapper = this._bindElement.parentNode ? this._bindElement.parentNode : null;\n\t\t}\n\t\tthis._wrapper = wrapper;\n\t}\n\n\tsetLoading(isLoading)\n\t{\n\t\tthis._isLoading = !!isLoading;\n\t\tthis.refreshLayout();\n\t}\n\n\tshow()\n\t{\n\t\tthis.cancelCloseDebounced();\n\n\t\tlet success = false;\n\t\tif (this._requisiteList && !this._requisiteList.isEmpty())\n\t\t{\n\t\t\tlet popup = PopupManager.create({\n\t\t\t\tid: this._popupId,\n\t\t\t\tcacheable: false,\n\t\t\t\tautoHide: true,\n\t\t\t\tpadding: this._padding,\n\t\t\t\tcontentPadding: 0,\n\t\t\t\tcontent: this.getLayout(),\n\t\t\t\tcloseByEsc: true\n\t\t\t});\n\t\t\tpopup.show();\n\t\t\tthis.adjustPosition();\n\t\t\tsuccess = true;\n\t\t}\n\n\t\tEventEmitter.emit(this, 'onShow', {success});\n\t}\n\n\n\tshowDebounced(delayMultiplier = false)\n\t{\n\t\tdelayMultiplier = parseInt(delayMultiplier) > 0 ? parseInt(delayMultiplier) : 1;\n\t\tthis.cancelShowDebounced();\n\t\tthis.cancelCloseDebounced();\n\t\tthis._showTimer = setTimeout(this.show.bind(this), this._showTimeout * delayMultiplier);\n\t}\n\n\tcancelShowDebounced()\n\t{\n\t\tclearTimeout(this._showTimer);\n\t}\n\n\tcloseDebounced(delayMultiplier = false)\n\t{\n\t\tthis.cancelShowDebounced();\n\t\tdelayMultiplier = parseInt(delayMultiplier) > 0 ? parseInt(delayMultiplier) : 1;\n\t\tthis.cancelCloseDebounced();\n\t\tthis._closeTimer = setTimeout(this.close.bind(this), this._closeTimeout * delayMultiplier);\n\t}\n\n\tcancelCloseDebounced()\n\t{\n\t\tclearTimeout(this._closeTimer);\n\t}\n\n\tadjustPosition()\n\t{\n\t\tlet popup = PopupManager.getPopupById(this._popupId);\n\t\tif (!popup || !popup.isShown() || !Type.isDomNode(this._bindElement)\n\t\t\t|| !Type.isDomNode(this._wrapper))\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tconst wrapperRect = this._wrapper.getBoundingClientRect();\n\t\tconst itemRect = this._bindElement.getBoundingClientRect();\n\n\t\tlet offsetLeft = wrapperRect.width - (itemRect.left - wrapperRect.left);\n\n\t\tlet offsetTop = itemRect.height / 2 + this._padding;\n\t\tlet angleOffset = itemRect.height / 2;\n\n\t\tconst popupWidth = popup.getPopupContainer().offsetWidth;\n\t\tconst popupHeight = popup.getPopupContainer().offsetHeight;\n\t\tconst popupBottom = itemRect.top + popupHeight;\n\n\t\tconst clientWidth = document.documentElement.clientWidth;\n\t\tconst clientHeight = document.documentElement.clientHeight;\n\n\t\t// let's try to fit a popup to the browser viewport\n\t\tconst exceeded = popupBottom - clientHeight;\n\t\tif (exceeded > 0)\n\t\t{\n\t\t\tlet roundOffset = Math.ceil(exceeded / itemRect.height) * itemRect.height;\n\t\t\tif (roundOffset > itemRect.top)\n\t\t\t{\n\t\t\t\t// it cannot be higher than the browser viewport.\n\t\t\t\troundOffset -= Math.ceil((roundOffset - itemRect.top) / itemRect.height) * itemRect.height;\n\t\t\t}\n\n\t\t\tif (itemRect.bottom > (popupBottom - roundOffset))\n\t\t\t{\n\t\t\t\t// let's sync bottom boundaries.\n\t\t\t\troundOffset -= itemRect.bottom - (popupBottom - roundOffset) + this._padding;\n\t\t\t}\n\n\t\t\toffsetTop += roundOffset;\n\t\t\tangleOffset += roundOffset + this._padding;\n\t\t}\n\n\t\tpopup.setBindElement(this._bindElement);\n\n\t\tif ((wrapperRect.left + offsetLeft + popupWidth) <= clientWidth)\n\t\t{\n\t\t\tpopup.setAngle({position: 'left', offset: angleOffset});\n\n\t\t\toffsetLeft += popup.angle ? popup.angle.element.offsetWidth : 0;\n\t\t\toffsetTop += popup.angle ? Math.ceil(popup.angle.element.offsetHeight / 2) : 0;\n\t\t\tpopup.setOffset({offsetLeft: offsetLeft, offsetTop: -offsetTop});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tpopup.setAngle(true);\n\t\t}\n\t\tpopup.adjustPosition();\n\t}\n\n\tclose()\n\t{\n\t\tlet popup = PopupManager.getPopupById(this._popupId);\n\t\tpopup ? popup.close() : null;\n\t\tthis.presetMenu.close();\n\t}\n\n\tremoveDebouncedEvents()\n\t{\n\t\tthis.cancelCloseDebounced();\n\t\tthis.cancelShowDebounced();\n\t}\n\n\trefreshLayout()\n\t{\n\t\tlet popup = PopupManager.getPopupById(this._popupId);\n\t\tif (popup)\n\t\t{\n\t\t\tpopup.setContent(this.getLayout());\n\t\t}\n\t}\n\n\tgetLayout()\n\t{\n\t\tif (this._isLoading)\n\t\t{\n\t\t\tlet loader = new Loader();\n\n\t\t\tlet container = Tag.render`<div class=\"crm-rq-wrapper crm-rq-wrapper-loading\"></div>`;\n\t\t\tloader.show(container);\n\t\t\treturn container;\n\t\t}\n\t\tlet requisites = Type.isNull(this._requisiteList) ? [] : this._requisiteList.getList();\n\t\tlet renderRequisiteEditButtonNode = (id) =>\n\t\t{\n\t\t\tif (this._isReadonly)\n\t\t\t{\n\t\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"crm-rq-org-requisite-btn-container\">\n\t\t\t\t\t<span class=\"ui-link ui-link-secondary\" onclick=\"${this.onEditRequisite.bind(this, id)}\">${Loc.getMessage('REQUISITE_TOOLTIP_SHOW_DETAILS')}</span>\n\t\t\t\t</div>\n\t\t\t\t`;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"crm-rq-org-requisite-btn-container\">\n\t\t\t\t\t<span class=\"ui-link ui-link-secondary\" onclick=\"${this.onEditRequisite.bind(this, id)}\">${Loc.getMessage('REQUISITE_TOOLTIP_EDIT')}</span>\n\t\t\t\t\t<span class=\"ui-link ui-link-secondary\" data-requisite-id=\"${id}\" onclick=\"${this.onDeleteRequisite.bind(this)}\">${Loc.getMessage('REQUISITE_TOOLTIP_DELETE')}</span>\n\t\t\t\t\t<span class=\"ui-link ui-link-secondary\" onclick=\"${this.onAddBankDetails.bind(this, id)}\">${Loc.getMessage('REQUISITE_TOOLTIP_ADD_BANK_DETAILS')}</span>\n\t\t\t\t</div>\n\t\t\t\t`;\n\t\t\t}\n\t\t};\n\n\t\tlet renderRequisiteBankDetails = (requisite, id) =>\n\t\t{\n\t\t\tlet bandDetails = requisite.getBankDetails();\n\t\t\tlet selectedBankDetailId = requisite.getSelectedBankDetailId();\n\t\t\treturn bandDetails.length ?\n\t\t\t\tTag.render`\n\t\t\t\t\t<div class=\"crm-rq-org-requisite-container\">\n\t\t\t\t\t\t<div class=\"crm-rq-org-requisite-title\">${Loc.getMessage('REQUISITE_TOOLTIP_BANK_DETAILS_TITLE')}</div>\n\t\t\t\t\t\t<div class=\"crm-rq-org-requisite-list\">\n\t\t\t\t\t\t\t${bandDetails.map((bankDetail, index) => Tag.render`\n\t\t\t\t\t\t\t\t<label class=\"crm-rq-org-requisite-item\" onclick=\"${this.onSetSelectedBankDetails.bind(this)}\">\n\t\t\t\t\t\t\t\t\t<input type=\"radio\" data-requisite-id=\"${id}\" data-bankdetails-id=\"${index}\" class=\"crm-rq-org-requisite-btn\" ${requisite.isSelected() && (index === selectedBankDetailId) ? ' checked' : ''} ${this._canChangeDefaultRequisite ? '': ' disabled'}>\n\t\t\t\t\t\t\t\t\t<span class=\"crm-rq-org-requisite-info\">${Text.encode(bankDetail.value)}</span>\n\t\t\t\t\t\t\t\t</label>`)}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t${renderRequisiteEditButtonNode(id)}\n\t\t\t\t\t</div>`\n\t\t\t\t:\n\t\t\t\trenderRequisiteEditButtonNode(id)\n\t\t};\n\n\t\treturn Tag.render`\n\t\t<div class=\"crm-rq-wrapper\"\n\t\t\tonmouseenter=\"${this.onMouseEnter.bind(this)}\"\n\t\t\tonmouseleave=\"${this.onMouseLeave.bind(this)}\">\n\t\t\t<div class=\"crm-rq-org-list\">\n\t\t\t\t${requisites.map((requisite, index) => Tag.render`\n\t\t\t\t\t<div class=\"crm-rq-org-item${requisite.isSelected() ? ' crm-rq-org-item-selected' : ''}\" onclick=\"${this.onSetSelectedRequisite.bind(this, index)}\">\n\t\t\t\t\t\t<div class=\"crm-rq-org-info-container\">\n\t\t\t\t\t\t\t<div class=\"crm-rq-org-name\">${Text.encode(requisite.getTitle())}</div>\n\t\t\t\t\t\t\t${requisite.getSubtitle().length ? Tag.render`<div class=\"crm-rq-org-description\">${Text.encode(requisite.getSubtitle())}</div>` : ''}\n\t\t\t\t\t\t\t${renderRequisiteBankDetails(requisite, index)}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t`)}\n\t\t\t</div>\n\t\t\t${this._isReadonly ? '' :\n\t\t\tTag.render`<div class=\"crm-rq-btn-container\">\n\t\t\t\t<span class=\"crm-rq-add-rq\" onclick=\"${this.onStartAddRequisite.bind(this)}\">\n\t\t\t\t\t<span class=\"ui-btn crm-rq-btn ui-btn-icon-custom ui-btn-primary ui-btn-round\"></span> ${Loc.getMessage('REQUISITE_TOOLTIP_ADD')}\n\t\t\t\t</span>\n\t\t\t</div>`}\n\t\t</div>`;\n\t}\n\n\tsetSelectedRequisite(id, bankDetailId)\n\t{\n\t\tlet newSelectedRequisite = this._requisiteList.getById(id);\n\t\tif (!newSelectedRequisite)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tlet selectedRequisite = this._requisiteList.getSelected();\n\t\tif (id === this._requisiteList.getSelectedId()) // selected the same requisite\n\t\t{\n\t\t\tlet selectedBankDetails = selectedRequisite.getBankDetails();\n\t\t\tif (selectedBankDetails.length)\n\t\t\t{\n\t\t\t\tfor (let index = 0; index < selectedBankDetails.length; index++)\n\t\t\t\t{\n\t\t\t\t\tlet bankDetails = selectedBankDetails[index];\n\t\t\t\t\tif (Type.isObject(bankDetails) && bankDetails.selected)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (index === bankDetailId || Type.isNull(bankDetailId))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn false; // selected same requisite and bank details\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\treturn false; // requisite already selected and hasn't bank details\n\t\t\t}\n\t\t}\n\t\tEventEmitter.emit(this, 'onSetSelectedRequisite', {id, bankDetailId});\n\n\t\treturn true;\n\t}\n\n\tonMouseEnter()\n\t{\n\t\tthis.cancelCloseDebounced();\n\t}\n\n\tonMouseLeave()\n\t{\n\t\tif (!this.presetMenu.isShown())\n\t\t{\n\t\t\tthis.closeDebounced(1.5);\n\t\t}\n\t}\n\n\tonStartAddRequisite(event)\n\t{\n\t\tevent.stopPropagation();\n\t\tthis.presetMenu.toggle(event.target);\n\n\t}\n\n\tonAddRequisite(event)\n\t{\n\t\tlet data = event.getData();\n\t\tthis.close();\n\t\tEventEmitter.emit(this, 'onAddRequisite', {\n\t\t\tpresetId: data.value\n\t\t});\n\t}\n\n\tonEditRequisite(id, event)\n\t{\n\t\tevent.stopPropagation();\n\t\tthis.close();\n\n\t\tEventEmitter.emit(this, 'onEditRequisite', {id});\n\t}\n\n\tonDeleteRequisite(event)\n\t{\n\t\tevent.stopPropagation();\n\n\t\tlet element = event.target;\n\t\tif (Type.isDomNode(element))\n\t\t{\n\t\t\tlet id = element.getAttribute('data-requisite-id');\n\t\t\tEventEmitter.emit(this, 'onDeleteRequisite', {id});\n\t\t}\n\t}\n\n\tonAddBankDetails(requisiteId, event)\n\t{\n\t\tevent.stopPropagation();\n\t\tthis.close();\n\n\t\tEventEmitter.emit(this, 'onAddBankDetails', {requisiteId});\n\t}\n\n\tonSetSelectedRequisite(id)\n\t{\n\t\tif (this._canChangeDefaultRequisite)\n\t\t{\n\t\t\tthis.setSelectedRequisite(id, null);\n\t\t}\n\t\treturn false;\n\t}\n\n\tonSetSelectedBankDetails(event)\n\t{\n\t\tevent.stopPropagation();\n\n\t\tlet element = event.target;\n\t\tif (this._canChangeDefaultRequisite && Type.isDomNode(element))\n\t\t{\n\t\t\tif (element.nodeName.toString().toLowerCase() !== 'input')\n\t\t\t{\n\t\t\t\telement = element.querySelector('input');\n\t\t\t\tif (!Type.isDomNode(element))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t\telement.checked = false;\n\t\t\tlet id = parseInt(element.getAttribute('data-requisite-id'));\n\t\t\tlet bankDetailsId = parseInt(element.getAttribute('data-bankdetails-id'));\n\t\t\tthis.setSelectedRequisite(id, bankDetailsId);\n\t\t}\n\t\treturn false;\n\t}\n\n\tonChangeRequisites(event)\n\t{\n\t\tthis.refreshLayout();\n\t}\n}","import {Loc, Tag, Dom, Type, Event} from \"main.core\";\nimport {RequisiteAutocompleteField} from \"crm.entity-editor.field.requisite.autocomplete\";\nimport {EventEmitter} from \"main.core.events\";\nimport {EntityEditorRequisiteTooltip} from './requisite-tooltip';\nimport {PresetMenu} from './preset-menu';\n\nexport class EntityEditorRequisiteField extends BX.Crm.EntityEditorField\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._domNodes = {};\n\t\tthis._requisiteList = null;\n\n\t\tthis.presetMenu = null;\n\t\tthis._autocomplete = null;\n\t\tthis._tooltip = null;\n\n\t\tthis._changeRequisistesHandler = this.onChangeRequisites.bind(this);\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tlet self = new this(id, settings);\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n\n\tdoInitialize()\n\t{\n\n\t\tthis._autocomplete = RequisiteAutocompleteField.create(this.getName(), {\n\t\t\tsearchAction: 'crm.requisite.entity.search',\n\t\t\tcanAddRequisite: true,\n\t\t\tfeedbackFormParams: BX.prop.getObject(this._schemeElement.getData(), \"feedback_form\", {}),\n\t\t\tenabled: true,\n\t\t\tshowFeedbackLink: false\n\t\t});\n\t\tthis._autocomplete.subscribe('onSelectValue', this.onSelectAutocompleteValue.bind(this));\n\t\tthis._autocomplete.subscribe('onCreateNewItem', this.onAddRequisiteFromAutocomplete.bind(this));\n\t\tthis._autocomplete.subscribe('onClear', this.onClearAutocompleteValue.bind(this));\n\n\t\tthis.presetMenu = new PresetMenu(this.getName() + '_requisite_preset_menu', this.getPresetList());\n\t\tthis.presetMenu.subscribe('onSelect', this.onAddRequisiteFromMenu.bind(this));\n\n\t\tlet isReadonly = this.getEditor().isReadOnly();\n\t\tthis._tooltip = EntityEditorRequisiteTooltip.create(this.getName() + '_requisite_details', {\n\t\t\treadonly: isReadonly,\n\t\t\tcanChangeDefaultRequisite: !isReadonly,\n\t\t\tpresets: this.getPresetList()\n\t\t});\n\n\t\tEventEmitter.subscribe(this._tooltip, 'onAddRequisite', this.onAddRequisiteFromTooltip.bind(this));\n\t\tEventEmitter.subscribe(this._tooltip, 'onEditRequisite', this.onEditRequisite.bind(this));\n\t\tEventEmitter.subscribe(this._tooltip, 'onDeleteRequisite', this.onDeleteRequisite.bind(this));\n\t\tEventEmitter.subscribe(this._tooltip, 'onAddBankDetails', this.onAddBankDetails.bind(this));\n\t\tEventEmitter.subscribe(this._tooltip, 'onSetSelectedRequisite', this.onSetSelectedRequisite.bind(this));\n\n\t\tthis.updateAutocompletePlaceholder();\n\n\t\tEventEmitter.emit(this.getEditor(), 'onFieldInit', {field: this});\n\t}\n\n\tsetRequisites(requisiteList)\n\t{\n\t\tconst hasRequisites = this.hasRequisites();\n\t\tconst vasEmpty = hasRequisites && this.getRequisites().isEmpty();\n\t\tthis._requisiteList = requisiteList;\n\t\trequisiteList.unsubscribe(requisiteList.CHANGE_EVENT, this._changeRequisistesHandler);\n\t\trequisiteList.subscribe(requisiteList.CHANGE_EVENT, this._changeRequisistesHandler);\n\t\tthis._tooltip.setRequisites(requisiteList);\n\t\tif (hasRequisites && !vasEmpty && !this.getRequisites().isEmpty())\n\t\t{\n\t\t\tthis.refreshLayoutParts();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.refreshLayout();\n\t\t}\n\t}\n\n\tgetRequisites()\n\t{\n\t\treturn this._requisiteList;\n\t}\n\n\thasRequisites()\n\t{\n\t\treturn Type.isObject(this._requisiteList);\n\t}\n\n\tisSingleMode()\n\t{\n\t\tif (!this.hasRequisites())\n\t\t{\n\t\t\treturn true;\n\t\t}\n\t\treturn (this.getRequisites().getList().length <= 1);\n\t}\n\n\tgetTitle()\n\t{\n\t\tlet title = super.getTitle();\n\t\tif (this.hasRequisites() && !this.isSingleMode())\n\t\t{\n\t\t\tlet selectedRequisite = this.hasRequisites() ? this.getRequisites().getSelected() : null;\n\t\t\tlet selectedPresetId = selectedRequisite ? selectedRequisite.getPresetId() : null;\n\t\t\tif (selectedRequisite && selectedPresetId)\n\t\t\t{\n\t\t\t\tlet selectedPresetName = this.getPresetList().reduce(\n\t\t\t\t\t(name, item) => ((item.value === selectedPresetId) ? item.name : name), '');\n\n\t\t\t\tif (selectedPresetName.length)\n\t\t\t\t{\n\t\t\t\t\ttitle += ' (' + selectedPresetName + ')';\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn title;\n\t}\n\n\tcreateTitleActionControls()\n\t{\n\t\tif (this._mode !== BX.UI.EntityEditorMode.edit)\n\t\t{\n\t\t\treturn [];\n\t\t}\n\t\tif (!this.isAutocompleteEnabled())\n\t\t{\n\t\t\treturn [];\n\t\t}\n\n\t\treturn [\n\t\t\tTag.render`\n\t\t\t\t<span class=\"ui-link ui-link-secondary ui-entity-editor-block-title-link\"\n\t\t\t\t \tonclick=\"${this.editDefaultRequisite.bind(this)}\">${Loc.getMessage('REQUISITE_LABEL_DETAILS_TEXT')}</span>`\n\t\t];\n\t}\n\n\tisNeedToDisplay(options)\n\t{\n\t\treturn this.hasRequisites() && super.isNeedToDisplay(options);\n\t}\n\n\tlayout(options)\n\t{\n\t\tif (this._hasLayout)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis._domNodes = {};\n\t\tthis.ensureWrapperCreated({classNames: [\"crm-entity-widget-content-block-field-requisites\"]});\n\t\tthis.adjustWrapper();\n\t\tthis.bindWrapperEvents();\n\n\t\tif (!this.isNeedToDisplay())\n\t\t{\n\t\t\tthis.registerLayout(options);\n\t\t\tthis._hasLayout = true;\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.isDragEnabled())\n\t\t{\n\t\t\tDom.append(this.createDragButton(), this._wrapper);\n\t\t}\n\n\t\tDom.append(this.createTitleNode(this.getTitle()), this._wrapper);\n\n\t\tif (this._mode === BX.UI.EntityEditorMode.edit)\n\t\t{\n\t\t\tif (this.isAutocompleteEnabled())\n\t\t\t{\n\t\t\t\tthis._domNodes.addButton = null;\n\t\t\t\tDom.append(this.renderAutocompleteForm(), this._wrapper);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis._domNodes.addButton = this.renderAddButton();\n\t\t\t\tDom.append(this._domNodes.addButton, this._wrapper);\n\t\t\t}\n\t\t}\n\t\telse // if(this._mode === BX.UI.EntityEditorMode.view)\n\t\t{\n\t\t\tDom.append(this.renderSelectedRequisite(), this._wrapper);\n\t\t}\n\n\t\tif (this.isContextMenuEnabled())\n\t\t{\n\t\t\tthis._wrapper.appendChild(this.createContextMenuButton());\n\t\t}\n\n\t\tif (this.isDragEnabled())\n\t\t{\n\t\t\tthis.initializeDragDropAbilities();\n\t\t}\n\n\t\tthis.registerLayout(options);\n\t\tthis._hasLayout = true;\n\t}\n\n\tbindWrapperEvents()\n\t{\n\t\tif (!this.wrapperMouseEnterHandler)\n\t\t{\n\t\t\tthis.wrapperMouseEnterHandler = this.onFieldMouseEnter.bind(this);\n\t\t}\n\t\tif (!this.wrapperMouseLeaveHandler)\n\t\t{\n\t\t\tthis.wrapperMouseLeaveHandler = this.onFieldMouseLeave.bind(this);\n\t\t}\n\n\t\tEvent.unbind(this._wrapper, 'mouseenter', this.wrapperMouseEnterHandler);\n\t\tEvent.unbind(this._wrapper, 'mouseleave', this.wrapperMouseLeaveHandler);\n\n\t\tEvent.bind(this._wrapper, 'mouseenter', this.wrapperMouseEnterHandler);\n\t\tEvent.bind(this._wrapper, 'mouseleave', this.wrapperMouseLeaveHandler);\n\t}\n\n\trefreshLayoutParts()\n\t{\n\t\tthis.updateSelectedRequisiteText();\n\t\tthis.refreshTitleLayout();\n\t\tthis.updateAutocompleteState();\n\t}\n\n\thasContentToDisplay()\n\t{\n\t\treturn this.hasValue();\n\t}\n\n\thasValue()\n\t{\n\t\tif (!this.hasRequisites())\n\t\t{\n\t\t\treturn  false;\n\t\t}\n\t\tlet list = this.getRequisites().getList();\n\t\tif (list.length > 1)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\t\t// if list contains only one item, it shouldn't be hidden:\n\t\treturn (list.length === 1 && !list[0].isAddressOnly());\n\t}\n\n\tisAutocompleteEnabled()\n\t{\n\t\tif (!this.hasRequisites() || this.getRequisites().isEmpty())\n\t\t{\n\t\t\treturn !!this.getClientResolverPropForPreset(this.getSelectedPresetId());\n\t\t}\n\t\tlet selectedRequisite = this.getRequisites().getSelected();\n\t\tif (selectedRequisite.isAddressOnly())\n\t\t{\n\t\t\treturn !!this.getClientResolverPropForPreset(this.getSelectedPresetId());\n\t\t}\n\t\treturn true;\n\t}\n\n\trenderSelectedRequisite()\n\t{\n\t\tthis._domNodes.selectedRequisiteView = Tag.render`<span></span>`;\n\t\tthis.updateSelectedRequisiteText();\n\t\tthis.updateAutocompleteState();\n\t\tlet container = Tag.render`\n\t\t\t<div class=\"ui-entity-editor-content-block\" \n\t\t\t\tonclick=\"${this.onViewStringClick.bind(this)}\"\n\t\t\t\tonmouseenter=\"${this.onViewStringMouseEnter.bind(this)}\">\n\t\t\t\t\t${this._domNodes.selectedRequisiteView}\n\t\t\t</div>`;\n\t\tthis._tooltip.setBindElement(container, this.getEditor().getFormElement());\n\t\t return container;\n\t}\n\n\tupdateSelectedRequisiteText()\n\t{\n\t\tif (!this._domNodes.selectedRequisiteView)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tlet selectedRequisite = this.hasRequisites() && this.getRequisites().getSelected();\n\t\tif (this.hasValue() && selectedRequisite && selectedRequisite.getTitle().length)\n\t\t{\n\t\t\tthis._domNodes.selectedRequisiteView.classList.add('ui-link', 'ui-link-dark', 'ui-link-dotted');\n\t\t\tthis._domNodes.selectedRequisiteView.textContent = selectedRequisite.getTitle();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis._domNodes.selectedRequisiteView.classList.remove('ui-link', 'ui-link-dark', 'ui-link-dotted');\n\t\t\tthis._domNodes.selectedRequisiteView.textContent = BX.UI.EntityEditorField.messages.isEmpty;\n\t\t}\n\t}\n\n\trenderAddButton()\n\t{\n\t\treturn Tag.render`\n\t\t<div class=\"ui-entity-editor-content-block crm-entity-widget-content-block-requisites\">\n\t\t\t<span class=\"crm-entity-widget-client-requisites-add-btn\" onclick=\"${this.toggleNewRequisitePresetMenu.bind(this)}\">${Loc.getMessage('CRM_EDITOR_ADD')}</span>\n\t\t</div>`;\n\t}\n\n\trenderAutocompleteForm()\n\t{\n\t\tlet autocompleteContainer = Tag.render`\n\t\t\t<div class=\"crm-entity-widget-content-block-field-container crm-entity-widget-content-block-field-requisites\"></div>`;\n\t\tlet hasResolvers = !!this.getClientResolverPropForPreset(this.getSelectedPresetId());\n\t\tthis._autocomplete.setEnabled(hasResolvers);\n\t\tthis._autocomplete.layout(autocompleteContainer);\n\t\tthis.updateAutocompleteState();\n\n\t\treturn Tag.render`\n\t\t<div class=\"ui-entity-editor-content-block\">\n\t\t\t${autocompleteContainer}\n\t\t\t<div class=\"crm-entity-widget-content-block-add-field\">\n\t\t\t\t<span class=\"crm-entity-widget-content-add-field\" onclick=\"${this.toggleNewRequisitePresetMenu.bind(this)}\">${Loc.getMessage('CRM_EDITOR_ADD')}</span>\n\t\t\t</div>\n\t\t</div>`;\n\t}\n\n\tupdateAutocompleteState()\n\t{\n\t\tlet autocompleteValue = null;\n\t\tlet selectedRequisite = this.hasRequisites() ? this.getRequisites().getSelected() : null;\n\t\tif (selectedRequisite && !selectedRequisite.isAddressOnly())\n\t\t{\n\t\t\tautocompleteValue = selectedRequisite.getAutocompleteData();\n\t\t}\n\t\tthis._autocomplete.setCurrentItem(autocompleteValue);\n\t\tthis._autocomplete.setContext(this.getAutocompleteContext());\n\t}\n\n\tupdateAutocompletePlaceholder()\n\t{\n\t\tlet selectedPresetId = this.getSelectedPresetId();\n\t\tlet clientResolverProp = this.getClientResolverPropForPreset(selectedPresetId);\n\n\t\tthis._autocomplete.setEnabled(!!clientResolverProp);\n\n\t\tlet title = BX.prop.getString(clientResolverProp, 'TITLE');\n\t\tthis._autocomplete.setPlaceholderText(title);\n\t}\n\n\tgetDefaultPresetId()\n\t{\n\t\tfor (let preset of BX.prop.getArray(this._schemeElement.getData(), \"presets\", []))\n\t\t{\n\t\t\tif (preset.IS_DEFAULT)\n\t\t\t{\n\t\t\t\treturn preset.VALUE;\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tgetSelectedPresetId()\n\t{\n\t\tlet selectedRequisite = this.hasRequisites() ? this.getRequisites().getSelected() : null;\n\t\tif (selectedRequisite)\n\t\t{\n\t\t\treturn selectedRequisite.getPresetId();\n\t\t}\n\t\treturn this.getDefaultPresetId();\n\t}\n\n\tgetClientResolverPropForPreset(presetId)\n\t{\n\t\tfor (let preset of BX.prop.getArray(this._schemeElement.getData(), \"presets\", []))\n\t\t{\n\t\t\tif (preset.VALUE === presetId)\n\t\t\t{\n\t\t\t\treturn BX.prop.get(preset, 'CLIENT_RESOLVER_PROP', null);\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tgetAutocompleteContext()\n\t{\n\t\treturn {\n\t\t\tpresetId: this.getSelectedPresetId()\n\t\t};\n\t}\n\n\ttoggleNewRequisitePresetMenu(e)\n\t{\n\t\tthis.presetMenu.toggle(e.target);\n\t};\n\n\tgetPresetList()\n\t{\n\t\tlet presets = [];\n\t\tfor (let item of BX.prop.getArray(this._schemeElement.getData(), \"presets\"))\n\t\t{\n\t\t\tlet value = BX.prop.getString(item, \"VALUE\", 0);\n\t\t\tlet name = BX.prop.getString(item, \"NAME\", value);\n\t\t\tpresets.push(\n\t\t\t\t{\n\t\t\t\t\tname: name,\n\t\t\t\t\tvalue: value\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\treturn presets;\n\t}\n\n\taddRequisite(params)\n\t{\n\t\tEventEmitter.emit(this, 'onEditNew', params);\n\t}\n\n\teditRequisite(id, options)\n\t{\n\t\tEventEmitter.emit(this, 'onEditExisted', {id, options});\n\t}\n\n\tdeleteRequisite(id)\n\t{\n\t\tthis._tooltip.removeDebouncedEvents();\n\t\tthis._tooltip.close();\n\t\tEventEmitter.emit(this, 'onDelete', {id, postponed: this._mode === BX.UI.EntityEditorMode.edit});\n\t}\n\n\thideRequisite(id)\n\t{\n\t\tthis.markAsChanged();\n\t\tthis._autocomplete.setCurrentItem(null);\n\t\tEventEmitter.emit(this, 'onHide', {id});\n\t}\n\n\tshowDeleteConfirmation(requisiteId)\n\t{\n\t\tBX.Crm.EditorAuxiliaryDialog.create(\n\t\t\t\"delete_requisite_confirmation\",\n\t\t\t{\n\t\t\t\ttitle: Loc.getMessage('REQUISITE_LIST_ITEM_DELETE_CONFIRMATION_TITLE'),\n\t\t\t\tcontent: Loc.getMessage('REQUISITE_LIST_ITEM_DELETE_CONFIRMATION_CONTENT'),\n\t\t\t\tbuttons:\n\t\t\t\t\t[\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tid: \"yes\",\n\t\t\t\t\t\t\ttype: BX.Crm.DialogButtonType.accept,\n\t\t\t\t\t\t\ttext: Loc.getMessage(\"CRM_EDITOR_YES\"),\n\t\t\t\t\t\t\tcallback: (button) =>\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tbutton.getDialog().close();\n\t\t\t\t\t\t\t\tthis.markAsChanged();\n\t\t\t\t\t\t\t\tthis.deleteRequisite(requisiteId);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tid: \"no\",\n\t\t\t\t\t\t\ttype: BX.Crm.DialogButtonType.cancel,\n\t\t\t\t\t\t\ttext: Loc.getMessage(\"CRM_EDITOR_NO\"),\n\t\t\t\t\t\t\tcallback: (button) =>\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tbutton.getDialog().close();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t}\n\t\t).open();\n\t}\n\n\tshowClearConfirmation(requisiteId)\n\t{\n\t\tBX.Crm.EditorAuxiliaryDialog.create(\n\t\t\t\"hide_requisite_confirmation\",\n\t\t\t{\n\t\t\t\ttitle: Loc.getMessage('REQUISITE_LIST_ITEM_HIDE_CONFIRMATION_TITLE'),\n\t\t\t\tcontent: Loc.getMessage('REQUISITE_LIST_ITEM_HIDE_CONFIRMATION_CONTENT'),\n\t\t\t\tbuttons:\n\t\t\t\t\t[\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tid: \"yes\",\n\t\t\t\t\t\t\ttype: BX.Crm.DialogButtonType.accept,\n\t\t\t\t\t\t\ttext: Loc.getMessage(\"CRM_EDITOR_YES\"),\n\t\t\t\t\t\t\tcallback: (button) =>\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tbutton.getDialog().close();\n\t\t\t\t\t\t\t\tthis.hideRequisite(requisiteId);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tid: \"no\",\n\t\t\t\t\t\t\ttype: BX.Crm.DialogButtonType.cancel,\n\t\t\t\t\t\t\ttext: Loc.getMessage(\"CRM_EDITOR_NO\"),\n\t\t\t\t\t\t\tcallback: (button) =>\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tbutton.getDialog().close();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t}\n\t\t).open();\n\t}\n\n\teditDefaultRequisite()\n\t{\n\t\tlet selectedRequisiteId = this.hasRequisites() ? this.getRequisites().getSelectedId() : null;\n\t\tif (null !== selectedRequisiteId)\n\t\t{\n\t\t\tthis.editRequisite(selectedRequisiteId, {\n\t\t\t\tautocompleteState: this._autocomplete.getState()\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.addRequisite({\n\t\t\t\tpresetId: this.getDefaultPresetId(),\n\t\t\t\tautocompleteState: this._autocomplete.getState()\n\t\t\t});\n\t\t}\n\t}\n\n\tonChangeRequisites()\n\t{\n\t\tif (\n\t\t\t(this._domNodes && Type.isDomNode(this._domNodes.addButton)) ||\n\t\t\t(this.hasRequisites() && this.getRequisites().isEmpty()) ||\n\t\t\t(this.hasRequisites() && this.getRequisites().getSelected().isAddressOnly())\n\t\t)\n\t\t{\n\t\t\tthis.refreshLayout();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.refreshLayoutParts();\n\t\t}\n\t\tthis.updateAutocompletePlaceholder();\n\t}\n\n\tonAddRequisiteFromMenu(event)\n\t{\n\t\tlet data = event.getData();\n\t\tlet selectedRequisite = this.hasRequisites() ? this.getRequisites().getSelected() : null;\n\t\t// if hidden requisite is selected, it will be used instead of new:\n\t\tif (null !== selectedRequisite && selectedRequisite.isAddressOnly())\n\t\t{\n\t\t\tthis.editRequisite(this.getRequisites().indexOf(selectedRequisite), {\n\t\t\t\teditorOptions: {\n\t\t\t\t\toverriddenPresetId: data.value\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.addRequisite({\n\t\t\t\tpresetId: data.value\n\t\t\t});\n\t\t}\n\t}\n\n\tonAddRequisiteFromTooltip(event)\n\t{\n\t\tthis.addRequisite(event.getData());\n\t}\n\n\tonAddRequisiteFromAutocomplete()\n\t{\n\t\tthis.editDefaultRequisite();\n\t}\n\n\tonEditRequisite(event)\n\t{\n\t\tlet eventData = event.getData();\n\t\tthis.editRequisite(eventData.id, {\n\t\t\tautocompleteState: this._autocomplete.getState()\n\t\t});\n\t}\n\n\tonDeleteRequisite(event)\n\t{\n\t\tlet eventData = event.getData();\n\t\tthis.showDeleteConfirmation(eventData.id);\n\t}\n\n\tonAddBankDetails(event)\n\t{\n\t\tlet eventData = event.getData();\n\t\tthis.editRequisite(eventData.requisiteId, {\n\t\t\teditorOptions: {\n\t\t\t\taddBankDetailsItem: true\n\t\t\t},\n\t\t\tautocompleteState: this._autocomplete.getState()\n\t\t});\n\t}\n\n\tonSelectAutocompleteValue(event)\n\t{\n\t\tlet data = event.getData();\n\t\tthis.markAsChanged();\n\t\tthis._autocomplete.setLoading(true);\n\n\t\tlet selectedRequisiteId = this.hasRequisites() ? this.getRequisites().getSelectedId() : null;\n\n\t\tEventEmitter.emit(this, 'onFinishAutocomplete', {\n\t\t\tid: selectedRequisiteId,\n\t\t\tdefaultPresetId: this.getDefaultPresetId(),\n\t\t\tautocompleteState: this._autocomplete.getState(),\n\t\t\tdata\n\t\t});\n\t}\n\n\tonClearAutocompleteValue()\n\t{\n\t\tlet selectedRequisiteId = this.hasRequisites() ? this.getRequisites().getSelectedId() : null;\n\n\t\tif (null !== selectedRequisiteId)\n\t\t{\n\t\t\tlet selectedRequisite = this.getRequisites().getSelected();\n\t\t\tlet hasAddresses = false;\n\t\t\tlet addresses = selectedRequisite.getAddressList();\n\t\t\tfor (let addressType in addresses)\n\t\t\t{\n\t\t\t\tif (\n\t\t\t\t\taddresses.hasOwnProperty(addressType) &&\n\t\t\t\t\tType.isStringFilled(addresses[addressType])\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\thasAddresses = true;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (hasAddresses)\n\t\t\t{\n\t\t\t\tthis.showClearConfirmation(selectedRequisiteId);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.showDeleteConfirmation(selectedRequisiteId);\n\t\t\t}\n\t\t}\n\t}\n\n\tonViewStringClick()\n\t{\n\t\tif (!this.getEditor().isReadOnly())\n\t\t{\n\t\t\tthis._tooltip.removeDebouncedEvents();\n\t\t\tthis._tooltip.close();\n\t\t\tthis.switchToSingleEditMode();\n\t\t}\n\t}\n\n\tonViewStringMouseEnter()\n\t{\n\t\tif (this._mode === BX.UI.EntityEditorMode.view && this.hasValue())\n\t\t{\n\t\t\tthis._tooltip.showDebounced();\n\t\t}\n\t}\n\n\tonSetSelectedRequisite(event)\n\t{\n\t\tlet eventData = event.getData();\n\t\tif (!this.getEditor().isReadOnly())\n\t\t{\n\t\t\tEventEmitter.emit(this, 'onSetDefault', eventData);\n\t\t}\n\t\treturn false;\n\t}\n\n\tonFieldMouseEnter()\n\t{\n\t\tif (this._mode === BX.UI.EntityEditorMode.view && this.hasValue())\n\t\t{\n\t\t\tthis._tooltip.showDebounced(5);\n\t\t}\n\t}\n\n\tonFieldMouseLeave()\n\t{\n\t\tthis._tooltip.closeDebounced();\n\t\tthis._tooltip.cancelShowDebounced();\n\t}\n}\n","import {EntityEditorAddressField} from \"crm.entity-editor.field.address\";\nimport {EventEmitter} from \"main.core.events\";\n\nexport class EntityEditorRequisiteAddressField extends EntityEditorAddressField\n{\n\tinitialize(id, settings)\n\t{\n\t\tsuper.initialize(id, settings);\n\t\tEventEmitter.emit(this.getEditor(), 'onFieldInit', {field: this});\n\t}\n\n\trollback()\n\t{\n\t\t// rollback will be executed in requisite controller\n\t}\n\n\treset()\n\t{\n\t\t// reset will be executed in requisite controller\n\t}\n\n\tonAddressListUpdate(event)\n\t{\n\t\tsuper.onAddressListUpdate(event);\n\t\tEventEmitter.emit(this, 'onAddressListUpdate', event);\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tlet self = new this(id, settings);\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import {Loc, Dom, Type, Tag} from \"main.core\";\nimport {Loader} from \"main.loader\";\nimport {EntityEditorBaseAddressField} from \"crm.entity-editor.field.address.base\";\nimport {RequisiteList, RequisiteListItem} from \"./requisite-list\";\nimport {EntityEditorRequisiteTooltip} from \"./requisite-tooltip\";\nimport {EventEmitter} from \"main.core.events\";\nimport {EntityEditorRequisiteEditor} from \"./requisite-editor\";\n\nexport class EntityEditorClientRequisites\n{\n\tconstructor()\n\t{\n\t\tthis._id = \"\";\n\t\tthis._entityInfo = null;\n\t\tthis._fieldsParams = null;\n\t\tthis._loaderConfig = null;\n\t\tthis._addressConfig = null;\n\t\tthis._requisiteList = null;\n\t\tthis._requisiteEditor = null;\n\n\t\tthis._readonly = true;\n\t\tthis._requisiteEditUrl = null;\n\t\tthis._addressContainer = null;\n\t\tthis._formElement = null;\n\t\tthis._showTooltipOnEntityLoad = false;\n\t}\n\n\tinitialize(id, settings)\n\t{\n\t\tthis._id = BX.type.isNotEmptyString(id) ? id : BX.util.getRandomString(4);\n\t\tthis.setEntity(BX.prop.get(settings, \"entityInfo\", null), false);\n\t\tif (!this._entityInfo)\n\t\t{\n\t\t\tthrow \"EntityEditorClientRequisites: EntityInfo must be instance of BX.CrmEntityInfo\";\n\t\t}\n\t\tthis._fieldsParams = BX.prop.get(settings, \"fieldsParams\", null);\n\t\tif (!this._fieldsParams)\n\t\t{\n\t\t\tthrow \"EntityEditorClientRequisites: Fields params are undefined\";\n\t\t}\n\t\tthis._addressConfig = BX.prop.getObject(this._fieldsParams, 'ADDRESS', null);\n\n\t\tthis._requisitesConfig = BX.prop.getObject(this._fieldsParams, 'REQUISITES', null);\n\n\t\tif (this._requisiteList)\n\t\t{\n\t\t\tlet selectedItem = BX.prop.getObject(settings, \"requisiteBinding\", null);\n\t\t\tif (selectedItem\n\t\t\t\t&& !Type.isUndefined(selectedItem.REQUISITE_ID) && !Type.isUndefined(selectedItem.BANK_DETAIL_ID))\n\t\t\t{\n\t\t\t\tlet requisite = this._requisiteList.getByRequisiteId(selectedItem.REQUISITE_ID);\n\t\t\t\tif (requisite)\n\t\t\t\t{\n\t\t\t\t\tlet bankDetail = selectedItem.BANK_DETAIL_ID > 0 ?\n\t\t\t\t\t\trequisite.getBankDetailByBankDetailId(selectedItem.BANK_DETAIL_ID) : null;\n\t\t\t\t\tthis._requisiteList.setSelected(\n\t\t\t\t\t\tthis._requisiteList.indexOf(requisite),\n\t\t\t\t\t\tbankDetail ? requisite.getBankDetails().indexOf(bankDetail) : null\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tthis._loaderConfig = BX.prop.getObject(settings, 'loaderConfig', null);\n\n\t\tthis._readonly = BX.prop.getBoolean(settings, \"readonly\", true);\n\t\tthis._canChangeDefaultRequisite = BX.prop.getBoolean(settings, \"canChangeDefaultRequisite\", true);\n\t\tthis._requisiteEditUrl = BX.prop.getString(settings, \"requisiteEditUrl\", null);\n\t\tthis._formElement = BX.prop.get(settings, \"formElement\", null);\n\n\t\tif (BX.prop.getBoolean(settings, \"enableTooltip\", true) && !Type.isNull(this._requisitesConfig))\n\t\t{\n\t\t\tthis._tooltip = EntityEditorRequisiteTooltip.create(this._id + '_client_requisite_details', {\n\t\t\t\treadonly: this._readonly,\n\t\t\t\tcanChangeDefaultRequisite: this._canChangeDefaultRequisite,\n\t\t\t\tpresets: this.getRequisitesPresetList()\n\t\t\t});\n\t\t}\n\n\t\tthis._requisiteEditor = EntityEditorRequisiteEditor.create(this._id + '_rq_editor', {\n\t\t\tentityTypeId: this._entityInfo.getTypeId(),\n\t\t\tentityId: this._entityInfo.getId(),\n\t\t\tcontextId: BX.prop.getString(settings, \"contextId\", \"\"),\n\t\t\trequisiteEditUrl: this._requisiteEditUrl\n\t\t});\n\t\tthis._requisiteEditor.setRequisiteList(this._requisiteList);\n\t\tEventEmitter.subscribe(this._requisiteEditor, 'onAfterEditRequisite', this.onRequisiteEditorAfterEdit.bind(this));\n\t\tEventEmitter.subscribe(this._requisiteEditor, 'onAfterDeleteRequisite', this.onRequisiteEditorAfterDelete.bind(this));\n\n\t\tif (this._tooltip)\n\t\t{\n\t\t\tEventEmitter.subscribe(this._tooltip, 'onAddRequisite', this.onEditNewRequisite.bind(this));\n\t\t\tEventEmitter.subscribe(this._tooltip, 'onEditRequisite', this.onEditExistedRequisite.bind(this));\n\t\t\tEventEmitter.subscribe(this._tooltip, 'onDeleteRequisite', this.onDeleteRequisite.bind(this));\n\t\t\tEventEmitter.subscribe(this._tooltip, 'onAddBankDetails', this.onAddBankDetails.bind(this));\n\t\t\tEventEmitter.subscribe(this._tooltip, 'onSetSelectedRequisite', this.onSetSelectedRequisite.bind(this));\n\t\t\tEventEmitter.subscribe(this._tooltip, 'onShow', this.onShowTooltip.bind(this));\n\t\t}\n\t}\n\n\tsetEntity(entityInfo, emitNotification)\n\t{\n\t\tthis._entityInfo = entityInfo;\n\n\t\tif (this._entityInfo.hasEditRequisiteData())\n\t\t{\n\t\t\tthis._requisiteList = RequisiteList.create(this._entityInfo.getRequisites());\n\t\t}\n\t\tif (emitNotification)\n\t\t{\n\t\t\tthis.onChangeRequisiteList();\n\t\t}\n\t}\n\n\taddressLayout(container)\n\t{\n\t\tif (!Type.isDomNode(container))\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tthis._addressContainer = Tag.render`<div class=\"crm-entity-widget-client-address\"></div>`;\n\t\tDom.append(this._addressContainer, container);\n\t\tthis.doAddressLayout();\n\t}\n\n\tdoAddressLayout()\n\t{\n\t\tif (!Type.isDomNode(this._addressContainer))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tDom.clean(this._addressContainer);\n\n\t\tif (!Type.isNull(this._addressConfig))\n\t\t{\n\t\t\tif (this._entityInfo.hasEditRequisiteData())\n\t\t\t{\n\t\t\t\tlet defaultRequisite = this._requisiteList.getSelected();\n\t\t\t\tlet addressValue = defaultRequisite ? defaultRequisite.getAddressList() : null;\n\n\t\t\t\tif (!Type.isNull(addressValue) && Object.keys(addressValue).length)\n\t\t\t\t{\n\t\t\t\t\tlet countryId = 0;\n\t\t\t\t\tif (defaultRequisite)\n\t\t\t\t\t{\n\t\t\t\t\t\tcountryId = parseInt(defaultRequisite.getPresetCountryId());\n\t\t\t\t\t}\n\t\t\t\t\tthis._addressField = EntityEditorBaseAddressField.create(this._entityInfo.getId(), {\n\t\t\t\t\t\tshowFirstItemOnly: true,\n\t\t\t\t\t\tshowAddressTypeInViewMode: true,\n\t\t\t\t\t\taddressZoneConfig: BX.prop.getObject(this._addressConfig, \"addressZoneConfig\", {}),\n\t\t\t\t\t\tcountryId: countryId\n\t\t\t\t\t});\n\t\t\t\t\tthis._addressField.setMultiple(true);\n\t\t\t\t\tthis._addressField.setTypesList(BX.prop.getObject(this._addressConfig, \"types\", {}));\n\t\t\t\t\tthis._addressField.setValue(addressValue);\n\t\t\t\t\tDom.append(this._addressField.layout(false), this._addressContainer);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tlet showAddressLink = Tag.render`\n\t\t\t\t<span class=\"ui-link ui-link-secondary ui-link-dotted\" onmouseup=\"${this.onLoadAddressMouseUp.bind(this)}\">\n\t\t\t\t\t${Loc.getMessage('CLIENT_REQUISITES_ADDRESS_SHOW_ADDRESS')}\n\t\t\t\t</span>`;\n\n\t\t\t\tDom.append(showAddressLink, this._addressContainer);\n\t\t\t}\n\t\t}\n\t}\n\n\tshowTooltip(bindElement)\n\t{\n\t\tif (!this._tooltip)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tif (this._entityInfo.hasEditRequisiteData())\n\t\t{\n\t\t\tthis._tooltip.setRequisites(this._requisiteList);\n\t\t\tif (this.isRequisiteAddressOnly())\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\tthis._tooltip.setBindElement(bindElement, this._formElement);\n\t\tthis._tooltip.showDebounced();\n\t}\n\n\tcloseTooltip()\n\t{\n\t\tif (!this._tooltip)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tthis._tooltip.closeDebounced();\n\t\tthis._tooltip.cancelShowDebounced();\n\t\tthis._showTooltipOnEntityLoad = false;\n\t}\n\n\trelease()\n\t{\n\t\tif (this._addressField)\n\t\t{\n\t\t\tthis._addressField.release();\n\t\t}\n\t\tif (this._tooltip)\n\t\t{\n\t\t\tthis._tooltip.close();\n\t\t\tthis._tooltip.removeDebouncedEvents();\n\t\t}\n\t}\n\n\tloadEntity()\n\t{\n\t\tif (!this._loaderConfig)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (Type.isDomNode(this._addressContainer))\n\t\t{\n\t\t\tlet loader = new Loader({size: 19, mode: 'inline'});\n\t\t\tDom.clean(this._addressContainer);\n\t\t\tloader.show(this._addressContainer);\n\t\t}\n\n\t\tBX.CrmDataLoader.create(\n\t\t\tthis._id,\n\t\t\t{\n\t\t\t\tserviceUrl: this._loaderConfig[\"url\"],\n\t\t\t\taction: this._loaderConfig[\"action\"],\n\t\t\t\tparams: {\n\t\t\t\t\t\"ENTITY_TYPE_NAME\": this._entityInfo.getTypeName(),\n\t\t\t\t\t\"ENTITY_ID\": this._entityInfo.getId(),\n\t\t\t\t\t\"NORMALIZE_MULTIFIELDS\": \"Y\"\n\t\t\t\t}\n\t\t\t}\n\t\t).load(this.onEntityInfoLoad.bind(this));\n\t}\n\n\tgetRequisitesPresetList()\n\t{\n\t\tif (Type.isNull(this._requisitesConfig))\n\t\t{\n\t\t\treturn [];\n\t\t}\n\t\tlet presets = [];\n\t\tfor (let item of BX.prop.getArray(this._requisitesConfig, \"presets\"))\n\t\t{\n\t\t\tlet value = BX.prop.getString(item, \"VALUE\", 0);\n\t\t\tlet name = BX.prop.getString(item, \"NAME\", value);\n\t\t\tpresets.push(\n\t\t\t\t{\n\t\t\t\t\tname: name,\n\t\t\t\t\tvalue: value\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\treturn presets;\n\t}\n\n\tdeleteRequisite(id)\n\t{\n\t\tif (this._tooltip)\n\t\t{\n\t\t\tthis._tooltip.removeDebouncedEvents();\n\t\t\tthis._tooltip.close();\n\t\t}\n\t\tthis._requisiteEditor.deleteRequisite(id);\n\t}\n\n\tisRequisiteAddressOnly()\n\t{\n\t\tlet list = this._requisiteList.getList();\n\t\treturn (list.length === 1 && list[0].isAddressOnly());\n\t}\n\n\tonLoadAddressMouseUp(event)\n\t{\n\t\tevent.stopPropagation(); // cancel switching client to edit mode\n\t\tthis.loadEntity();\n\t}\n\n\tonEntityInfoLoad(sender, result)\n\t{\n\t\tvar entityData = BX.prop.getObject(result, \"DATA\", null);\n\t\tif (entityData)\n\t\t{\n\t\t\tthis.setEntity(BX.CrmEntityInfo.create(entityData), true);\n\t\t\tif (this._tooltip && this._showTooltipOnEntityLoad)\n\t\t\t{\n\t\t\t\tif (!this.isRequisiteAddressOnly())\n\t\t\t\t{\n\t\t\t\t\tthis._tooltip.show();\n\t\t\t\t}\n\t\t\t\tthis._showTooltipOnEntityLoad = false;\n\t\t\t}\n\t\t}\n\t}\n\n\tonEditNewRequisite(event)\n\t{\n\t\tlet params = event.getData();\n\n\t\tparams.selected = this._requisiteList.isEmpty();\n\t\tlet requisite = RequisiteListItem.create(null, {\n\t\t\t'newRequisiteId': this._requisiteList.getNewRequisiteId(),\n\t\t\t'newRequisiteExtraFields': params\n\t\t});\n\t\trequisite.setRequisiteId(this._requisiteList.getNewRequisiteId());\n\t\tthis._requisiteEditor.open(requisite);\n\t}\n\n\tonEditExistedRequisite(event)\n\t{\n\t\tlet params = event.getData();\n\t\tlet requisite = this._requisiteList.getById(params.id);\n\t\tif (requisite)\n\t\t{\n\t\t\tthis._requisiteEditor.open(requisite, {});\n\t\t}\n\t}\n\n\tonDeleteRequisite(event)\n\t{\n\t\tlet eventData = event.getData();\n\t\tBX.Crm.EditorAuxiliaryDialog.create(\n\t\t\t\"delete_requisite_confirmation\",\n\t\t\t{\n\t\t\t\ttitle: Loc.getMessage('REQUISITE_LIST_ITEM_DELETE_CONFIRMATION_TITLE'),\n\t\t\t\tcontent: Loc.getMessage('REQUISITE_LIST_ITEM_DELETE_CONFIRMATION_CONTENT'),\n\t\t\t\tbuttons:\n\t\t\t\t\t[\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tid: \"yes\",\n\t\t\t\t\t\t\ttype: BX.Crm.DialogButtonType.accept,\n\t\t\t\t\t\t\ttext: Loc.getMessage(\"CRM_EDITOR_YES\"),\n\t\t\t\t\t\t\tcallback: (button) =>\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tbutton.getDialog().close();\n\t\t\t\t\t\t\t\tthis.deleteRequisite(eventData.id);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tid: \"no\",\n\t\t\t\t\t\t\ttype: BX.Crm.DialogButtonType.cancel,\n\t\t\t\t\t\t\ttext: Loc.getMessage(\"CRM_EDITOR_NO\"),\n\t\t\t\t\t\t\tcallback: (button) =>\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tbutton.getDialog().close();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t}\n\t\t).open();\n\t}\n\n\tonAddBankDetails(event)\n\t{\n\t\tlet eventData = event.getData();\n\t\tlet requisite = this._requisiteList.getById(eventData.requisiteId);\n\t\tif (requisite)\n\t\t{\n\t\t\tthis._requisiteEditor.open(requisite, {\n\t\t\t\taddBankDetailsItem: true\n\t\t\t});\n\t\t}\n\t}\n\n\tonSetSelectedRequisite(event)\n\t{\n\t\tlet eventData = event.getData();\n\t\tthis._requisiteList.setSelected(eventData.id, eventData.bankDetailId);\n\n\t\tthis.doAddressLayout();\n\n\t\tlet newSelectedRequisite = this._requisiteList.getSelected();\n\t\tif (newSelectedRequisite)\n\t\t{\n\t\t\tlet selectedBankDetail = newSelectedRequisite.getBankDetailById(newSelectedRequisite.getSelectedBankDetailId());\n\t\t\tlet selectedBankDetailId = Type.isNull(selectedBankDetail) ? 0 : selectedBankDetail.id;\n\n\t\t\tEventEmitter.emit(this, 'onSetSelectedRequisite', {\n\t\t\t\trequisiteId: newSelectedRequisite.getRequisiteId(),\n\t\t\t\tbankDetailId: selectedBankDetailId\n\t\t\t});\n\t\t}\n\t}\n\n\tonRequisiteEditorAfterEdit(event)\n\t{\n\t\tthis.onChangeRequisiteList();\n\t}\n\n\tonRequisiteEditorAfterDelete(event)\n\t{\n\t\tthis.onChangeRequisiteList();\n\t}\n\n\tonChangeRequisiteList()\n\t{\n\t\tthis.doAddressLayout();\n\t\tif (this._tooltip)\n\t\t{\n\t\t\tthis._tooltip.setRequisites(this._requisiteList);\n\t\t\tthis._tooltip.setLoading(false);\n\t\t}\n\n\t\tthis._requisiteEditor.setRequisiteList(this._requisiteList);\n\n\t\tlet requisiteList = this._requisiteList ? this._requisiteList.exportToModel() : null;\n\n\t\tthis._entityInfo.setRequisites(requisiteList);\n\t\tEventEmitter.emit(this, 'onChangeRequisiteList', {\n\t\t\tentityTypeName: this._entityInfo.getTypeName(),\n\t\t\tentityId: this._entityInfo.getId(),\n\t\t\trequisites: this._requisiteList.exportToModel()\n\t\t});\n\t}\n\n\tonShowTooltip()\n\t{\n\t\tif (!this._entityInfo.hasEditRequisiteData())\n\t\t{\n\t\t\tif (this._tooltip)\n\t\t\t{\n\t\t\t\tthis._tooltip.close();\n\t\t\t\tthis._showTooltipOnEntityLoad = true;\n\t\t\t}\n\t\t\tthis.loadEntity();\n\t\t}\n\t\telse if (this.isRequisiteAddressOnly())\n\t\t{\n\t\t\tthis._tooltip.close();\n\t\t}\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tlet self = new EntityEditorClientRequisites();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}"],"names":["RequisiteList","setEventNamespace","_items","CHANGE_EVENT","value","settings","Type","isArray","item","listItem","RequisiteListItem","create","push","filter","isDeleted","getList","length","selectedId","getSelectedId","getById","list","index","requisite","isSelected","id","requisiteId","getRequisiteId","reduce","prev","current","bankDetailsId","selected","setSelected","setSelectedBankDetails","isNull","getSelectedBankDetailId","notifyListChanged","maxExistedId","prevId","getRequisiteIdAsString","match","newRequisitePattern","currentId","Math","max","parseInt","indexOf","splice","setDeleted","setAddressOnly","setChanged","emit","result","exportedItem","exportToModel","self","initialize","EventEmitter","_data","isPlainObject","isNew","isChanged","isAddressOnly","formData","addressData","autocompleteState","presetId","BX","prop","getString","requisiteData","requisiteDataSign","bankDetails","bankDetailIdSelected","addressList","title","subtitle","extraData","getObject","initialAddressDdta","prepareViewData","JSON","parse","e","viewData","newRequisiteId","getNumber","getFields","setRequisiteId","bankDetailViewDataList","prepareBankDetailsList","bankDetailsItem","deleted","pseudoId","fields","isStringFilled","textValue","map","join","hasOwnProperty","getBoolean","changed","selectedBankDetailId","getInteger","getBankDetails","bankDetailId","getArray","isNumber","String","getAutocompleteState","selectedAutocompleteItem","subTitle","isUndefined","name","state","oldAddressTypes","Object","keys","addresses","type","getAddressData","isString","DELETED","presetCountryId","justSelected","setFormData","getFormData","setAddressData","EntityEditorRequisiteEditor","_requisiteList","_entityTypeId","_entityId","_contextId","_mode","UI","EntityEditorMode","view","currentSliderRequisiste","_requisiteEditUrl","subscribe","onExternalEvent","bind","requisiteList","mode","options","sliderOptions","width","cacheable","allowChangeHistory","requestMethod","requestParams","prepareSliderRequestParams","Crm","Page","openSlider","getSliderUrl","postData","sessid","bitrix_sessid","ACTION","ajax","post","data","json","ERROR","showError","selectedRequisite","getSelected","selectedRemoved","remove","errorMessage","MessageBox","alert","Loc","getMessage","urlParams","etype","eid","external_context_id","getPresetId","util","add_url_param","getRequisiteEditUrl","getRequisiteData","getRequisiteDataSign","stringify","isEmptyFormData","isEmptyAddressData","RQ_ADDR","getAddressesForSave","isViewMode","overriddenPresetId","replace","PRESET_ID","useFormData","promise","method","dataType","url","event","dataArray","getData","eventName","contextId","isObject","setRequisiteData","setAutocompleteState","clearFormData","clearAddressData","setPresetId","setPresetCountryId","setNew","add","EntityEditorRequisiteController","_requisiteEditor","_requisiteFieldId","_requisiteField","_requisiteInitData","_addressFieldId","_addressField","_isLoading","_formInputsWrapper","getConfigStringParam","saveRequisiteInitData","_editor","onFieldInit","initRequisiteEditor","initRequisiteList","selectedItem","getConfig","REQUISITE_ID","BANK_DETAIL_ID","getByRequisiteId","bankDetail","getBankDetailByBankDetailId","onChangeRequisites","setRequisiteList","_id","entityTypeId","getEntityTypeId","entityId","getEntityId","getContextId","requisiteEditUrl","onRequisiteEditorAfterEdit","onRequisiteEditorAfterDelete","setRequisites","countryId","getPresetCountryId","requisiteAddressList","getAddressList","setCountryId","setAddressList","getRequisiteFieldValue","promises","signPromise","signRequisiteFields","then","error","entityDataObj","entityData","entityDataSign","addError","EntityValidationError","field","getFirstEditModeField","Promise","resolve","reject","all","newSelectedRequisite","selectedBankDetail","getBankDetailById","startLoading","runAction","response","stopLoading","setRequisiteInitAddrData","setMode","getMode","open","rawRequisite","requisiteFields","setInitialAddressData","setInitAddrData","edit","modelValue","_model","setField","getField","Tag","render","Dom","append","getFormElement","getListWithDeleted","dataInput","safe","signInput","isDomNode","markAsChanged","initRequisiteField","initAddressField","updateRequisiteFieldModel","eventData","extraFields","isEmpty","defaultPresetId","getNewRequisiteId","getDefaultPresetId","schemeElement","getScheme","getAvailableElements","getName","preset","IS_DEFAULT","VALUE","getSignRequisitePromise","fieldId","getId","onEditNewRequisite","onEditExistedRequisite","onFinishRequisiteAutocomplete","onClearRequisiteAutocomplete","onSetDefaultRequisite","onDeleteRequisite","onHideRequisite","onAddressListUpdate","params","openEditor","editorOptions","prepareRequisiteByEventData","oldAddr","addr","unhide","cancel","setSelectedRequisite","postponed","removePostponed","deleteRequisite","hide","isEmptyAddress","address","addEditorFormInputs","removeEditorFormInputs","markFieldsAsChanged","isEmptyRequisitesList","EntityEditorController","PresetMenu","presetList","_isShown","menuId","bindElement","close","show","menu","text","Text","encode","onclick","onSelect","MenuManager","angle","events","onPopupShow","onPopupClose","getMenuById","popupWindow","EntityEditorRequisiteTooltip","isNotEmptyString","getRandomString","_settings","_padding","_showTimer","_closeTimer","_closeTimeout","_showTimeout","_popupId","_isReadonly","_canChangeDefaultRequisite","_bindElement","_wrapper","_changeRequisistesHandler","presetMenu","onAddRequisite","unsubscribe","refreshLayout","wrapper","parentNode","isLoading","cancelCloseDebounced","success","popup","PopupManager","autoHide","padding","contentPadding","content","getLayout","closeByEsc","adjustPosition","delayMultiplier","cancelShowDebounced","setTimeout","clearTimeout","getPopupById","isShown","wrapperRect","getBoundingClientRect","itemRect","offsetLeft","left","offsetTop","height","angleOffset","popupWidth","getPopupContainer","offsetWidth","popupHeight","offsetHeight","popupBottom","top","clientWidth","document","documentElement","clientHeight","exceeded","roundOffset","ceil","bottom","setBindElement","setAngle","position","offset","element","setOffset","setContent","loader","Loader","container","requisites","renderRequisiteEditButtonNode","onEditRequisite","onAddBankDetails","renderRequisiteBankDetails","bandDetails","onSetSelectedBankDetails","onMouseEnter","onMouseLeave","onSetSelectedRequisite","getTitle","getSubtitle","onStartAddRequisite","selectedBankDetails","closeDebounced","stopPropagation","toggle","target","getAttribute","nodeName","toString","toLowerCase","querySelector","checked","EntityEditorRequisiteField","_domNodes","_autocomplete","_tooltip","RequisiteAutocompleteField","searchAction","canAddRequisite","feedbackFormParams","_schemeElement","enabled","showFeedbackLink","onSelectAutocompleteValue","onAddRequisiteFromAutocomplete","onClearAutocompleteValue","getPresetList","onAddRequisiteFromMenu","isReadonly","getEditor","isReadOnly","readonly","canChangeDefaultRequisite","presets","onAddRequisiteFromTooltip","updateAutocompletePlaceholder","hasRequisites","vasEmpty","getRequisites","refreshLayoutParts","isSingleMode","selectedPresetId","selectedPresetName","isAutocompleteEnabled","editDefaultRequisite","_hasLayout","ensureWrapperCreated","classNames","adjustWrapper","bindWrapperEvents","isNeedToDisplay","registerLayout","isDragEnabled","createDragButton","createTitleNode","addButton","renderAutocompleteForm","renderAddButton","renderSelectedRequisite","isContextMenuEnabled","appendChild","createContextMenuButton","initializeDragDropAbilities","wrapperMouseEnterHandler","onFieldMouseEnter","wrapperMouseLeaveHandler","onFieldMouseLeave","Event","unbind","updateSelectedRequisiteText","refreshTitleLayout","updateAutocompleteState","hasValue","getClientResolverPropForPreset","getSelectedPresetId","selectedRequisiteView","onViewStringClick","onViewStringMouseEnter","classList","textContent","EntityEditorField","messages","toggleNewRequisitePresetMenu","autocompleteContainer","hasResolvers","setEnabled","layout","autocompleteValue","getAutocompleteData","setCurrentItem","setContext","getAutocompleteContext","clientResolverProp","setPlaceholderText","get","removeDebouncedEvents","EditorAuxiliaryDialog","buttons","DialogButtonType","accept","callback","button","getDialog","hideRequisite","selectedRequisiteId","editRequisite","getState","addRequisite","showDeleteConfirmation","addBankDetailsItem","setLoading","hasAddresses","addressType","showClearConfirmation","switchToSingleEditMode","showDebounced","EntityEditorRequisiteAddressField","EntityEditorAddressField","EntityEditorClientRequisites","_entityInfo","_fieldsParams","_loaderConfig","_addressConfig","_readonly","_addressContainer","_formElement","_showTooltipOnEntityLoad","setEntity","_requisitesConfig","getRequisitesPresetList","getTypeId","onShowTooltip","entityInfo","emitNotification","hasEditRequisiteData","onChangeRequisiteList","doAddressLayout","clean","defaultRequisite","addressValue","EntityEditorBaseAddressField","showFirstItemOnly","showAddressTypeInViewMode","addressZoneConfig","setMultiple","setTypesList","setValue","showAddressLink","onLoadAddressMouseUp","isRequisiteAddressOnly","release","size","CrmDataLoader","serviceUrl","action","getTypeName","load","onEntityInfoLoad","loadEntity","sender","CrmEntityInfo","entityTypeName"],"mappings":"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"}