this.BX=this.BX||{};(function(t,e,n,r,i,a,s){"use strict";function o(){var t=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="crm-entity-widget-payment-total">\n\t\t\t\t<span>\n\t\t\t\t\t','\n\t\t\t\t\t<span data-hint="','"></span>\n\t\t\t\t</span>\n\t\t\t\t<span class="crm-entity-widget-payment-text">',"</span>\n\t\t\t</div>\n\t\t"]);o=function e(){return t};return t}function c(){var t=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="crm-entity-widget-payment-add-box">\n\t\t\t\t<a href="#" class="crm-entity-widget-payment-add" onclick="','">\n\t\t\t\t\t+ ',"\n\t\t\t\t</a>\n\t\t\t</div>\n\t\t"]);c=function e(){return t};return t}function l(){var t=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="crm-entity-widget-payment-detail">\n\t\t\t\t<a class="ui-link" onclick="','">\n\t\t\t\t\t'," (",", ",')\n\t\t\t\t</a>\n\t\t\t\t<div class="crm-entity-widget-payment-detail-inner">\n\t\t\t\t\t<div class="ui-label ui-label-md ui-label-light crm-entity-widget-payment-action" onclick="','">\n\t\t\t\t\t\t<span class="ui-label-inner">',"</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t","\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t"]);l=function e(){return t};return t}function _(){var t=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="crm-entity-widget-payment-detail">\n\t\t\t\t<a class="ui-link" onclick="','">'," (",')</a>\n\t\t\t\t<div class="crm-entity-widget-payment-detail-inner">\n\t\t\t\t\t<div class="ui-label ui-label-md ui-label-light crm-entity-widget-payment-action" onclick="','">\n\t\t\t\t\t\t<span class="ui-label-inner">',"</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t","\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t"]);_=function e(){return t};return t}function E(){var t=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="crm-entity-widget-payment-detail">\n\t\t\t\t<div class="crm-entity-widget-payment-detail-caption">',"</div>\n\t\t\t</div>\n\t\t"]);E=function e(){return t};return t}function T(){var t=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div class="crm-entity-widget-content-block-inner-container">\n\t\t\t\t\t<div class="crm-entity-widget-payment">\n\t\t\t\t\t\t',"\n\t\t\t\t\t\t","\n\t\t\t\t\t\t","\n\t\t\t\t\t\t","\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t"]);T=function e(){return t};return t}function u(){var t=babelHelpers.taggedTemplateLiteral(['<div class="','"></div>']);u=function e(){return t};return t}var d=function(){function t(e){babelHelpers.classCallCheck(this,t);this._options=e;this._isDeliveryAvailable=this._options.IS_DELIVERY_AVAILABLE;this._parentContext=e.PARENT_CONTEXT;this._rootNode=a.Tag.render(u(),this.constructor._rootNodeClass);this._menus=[];this._subscribeToGlobalEvents()}babelHelpers.createClass(t,[{key:"hasContent",value:function t(){return this._docs().length>0}},{key:"render",value:function t(){this._menus.forEach(function(t){return t.destroy()});this._rootNode.innerHTML="";this._setupCurrencyFormat();if(this.hasContent()){this._rootNode.classList.remove("is-hidden");this._rootNode.append(a.Tag.render(T(),this._renderTitle(),this._renderDocuments(),this._renderAddDocument(),this._renderTotalSum()))}else{this._rootNode.classList.add("is-hidden")}return this._rootNode}},{key:"setOptions",value:function t(e){this._options=e}},{key:"reloadModel",value:function t(e,n){var r=this;if(!this._options.DEAL_ID){return}var i={data:{dealId:this._options.DEAL_ID}};var s=function t(i){r._loading(false);if(i.data){r.setOptions(i.data);r.render();if(e&&a.Type.isFunction(e)){e(i)}}else{r._showCommonError();if(n&&a.Type.isFunction(n)){n()}}};var o=function t(){r._loading(false);r._showCommonError();if(n&&a.Type.isFunction(n)){n()}};this._loading(true);a.ajax.runAction("crm.api.deal.fetchPaymentDocuments",i).then(s,o)}},{key:"_renderTitle",value:function t(){return a.Tag.render(E(),a.Loc.getMessage("CRM_ENTITY_ED_PAYMENT_DOCUMENTS_TITLE"))}},{key:"_renderDocuments",value:function t(){var e=this;var n=[];this._docs().forEach(function(t){if(t.TYPE==="PAYMENT"){n.push(e._renderPaymentDocument(t))}else if(t.TYPE==="SHIPMENT"){n.push(e._renderShipmentDocument(t))}});return n}},{key:"_renderPaymentDocument",value:function t(e){var r=this;var o=a.Loc.getMessage("CRM_ENTITY_ED_PAYMENT_DOCUMENTS_PAYMENT_DATE").replace(/#DATE#/gi,e.FORMATTED_DATE);var c=a.Loc.getMessage("CRM_ENTITY_ED_PAYMENT_DOCUMENTS_PAYMENT_AMOUNT").replace(/#SUM#/gi,this._renderMoney(e.SUM));var l={text:a.Loc.getMessage("CRM_ENTITY_ED_PAYMENT_DOCUMENTS_STAGE_".concat(e.STAGE)),customClass:"crm-entity-widget-payment-label",color:s.LabelColor.LIGHT,fill:true};if(e.STAGE&&e.STAGE==="PAID"){l.color=s.LabelColor.LIGHT_GREEN}else if(e.STAGE&&e.STAGE==="VIEWED_NO_PAID"){l.color=s.LabelColor.LIGHT_BLUE}if(!l.text){l.text=e.PAID==="Y"?a.Loc.getMessage("CRM_ENTITY_ED_PAYMENT_DOCUMENTS_STAGE_PAID"):a.Loc.getMessage("CRM_ENTITY_ED_PAYMENT_DOCUMENTS_STAGE_NOT_PAID")}var E;var T=[];if(this._isDeliveryAvailable){T.push({text:a.Loc.getMessage("CRM_ENTITY_ED_PAYMENT_DOCUMENTS_CHOOSE_DELIVERY"),title:a.Loc.getMessage("CRM_ENTITY_ED_PAYMENT_DOCUMENTS_CHOOSE_DELIVERY"),onclick:function t(){return r._chooseDeliverySlider(e.ORDER_ID)}})}T.push({text:a.Loc.getMessage("CRM_ENTITY_ED_PAYMENT_DOCUMENTS_RESEND"),onclick:function t(){return r._resendPaymentSlider(e.ORDER_ID,e.ID)}});T.push({text:a.Loc.getMessage("CRM_ENTITY_ED_PAYMENT_DOCUMENTS_CHANGE_PAYMENT_STATUS"),items:[{text:a.Loc.getMessage("CRM_ENTITY_ED_PAYMENT_DOCUMENTS_STATUS_PAID"),className:e.PAID==="Y"?"menu-popup-item-accept-sm":"",onclick:function t(){r._setPaymentPaidStatus(e,true);E.close()}},{text:a.Loc.getMessage("CRM_ENTITY_ED_PAYMENT_DOCUMENTS_STATUS_NOT_PAID"),className:e.PAID==="Y"?"":"menu-popup-item-accept-sm",onclick:function t(){r._setPaymentPaidStatus(e,false);E.close()}}]});T.push({text:a.Loc.getMessage("CRM_ENTITY_ED_PAYMENT_DOCUMENTS_REMOVE"),className:e.PAID==="Y"?"menu-popup-no-icon crm-entity-widget-payment-menu-item-remove":"",onclick:function t(){if(e.PAID==="Y"){return false}E.close();i.MessageBox.show({title:a.Loc.getMessage("CRM_ENTITY_ED_PAYMENT_DOCUMENTS_REMOVE_CONFIRM_TITLE"),message:a.Loc.getMessage("CRM_ENTITY_ED_PAYMENT_DOCUMENTS_REMOVE_PAYMENT_CONFIRM_TEXT"),modal:true,buttons:i.MessageBoxButtons.OK_CANCEL,onOk:function t(n){n.close();r._removeDocument(e)},onCancel:function t(e){e.close()}})}});var u=function t(){return r._resendPaymentSlider(e.ORDER_ID,e.ID)};var d=function t(i){i.preventDefault();E=n.MenuManager.create({id:"payment-documents-payment-action-"+e.ID,bindElement:i.target,items:T});E.show();var s=E.itemsContainer.querySelector(".crm-entity-widget-payment-menu-item-remove");if(s){s.setAttribute("data-hint",a.Loc.getMessage("CRM_ENTITY_ED_PAYMENT_DOCUMENTS_PAYMENT_REMOVE_TIP"));s.setAttribute("data-hint-no-icon","");BX.UI.Hint.init(E.itemsContainer)}r._menus.push(E)};return a.Tag.render(_(),u,o,c,d,a.Loc.getMessage("CRM_ENTITY_ED_PAYMENT_DOCUMENTS_ACTIONS_MENU"),new s.Label(l).render())}},{key:"_renderShipmentDocument",value:function t(e){var r=this;var o={text:a.Loc.getMessage("CRM_ENTITY_ED_PAYMENT_DOCUMENTS_STATUS_WAITING"),customClass:"crm-entity-widget-payment-label",color:s.LabelColor.LIGHT,fill:true};if(e.DEDUCTED==="Y"){o.text=a.Loc.getMessage("CRM_ENTITY_ED_PAYMENT_DOCUMENTS_STATUS_DELIVERED");o.color=s.LabelColor.LIGHT_GREEN}var c=a.Loc.getMessage("CRM_ENTITY_ED_PAYMENT_DOCUMENTS_DELIVERY_DATE").replace(/#DATE#/gi,e.FORMATTED_DATE);var _=a.Loc.getMessage("CRM_ENTITY_ED_PAYMENT_DOCUMENTS_PAYMENT_AMOUNT").replace(/#SUM#/gi,this._renderMoney(e.SUM));var E;var T=[{text:a.Loc.getMessage("CRM_ENTITY_ED_PAYMENT_DOCUMENTS_CHANGE_DELIVERY_STATUS"),items:[{text:a.Loc.getMessage("CRM_ENTITY_ED_PAYMENT_DOCUMENTS_STATUS_DELIVERED"),className:e.DEDUCTED==="Y"?"menu-popup-item-accept-sm":"",onclick:function t(){r._setShipmentShippedStatus(e,true);E.close()}},{text:a.Loc.getMessage("CRM_ENTITY_ED_PAYMENT_DOCUMENTS_STATUS_WAITING"),className:e.DEDUCTED==="Y"?"":"menu-popup-item-accept-sm",onclick:function t(){r._setShipmentShippedStatus(e,false);E.close()}}]},{text:a.Loc.getMessage("CRM_ENTITY_ED_PAYMENT_DOCUMENTS_REMOVE"),onclick:function t(){E.close();i.MessageBox.show({title:a.Loc.getMessage("CRM_ENTITY_ED_PAYMENT_DOCUMENTS_REMOVE_CONFIRM_TITLE"),message:a.Loc.getMessage("CRM_ENTITY_ED_PAYMENT_DOCUMENTS_REMOVE_DELIVERY_CONFIRM_TEXT"),modal:true,buttons:i.MessageBoxButtons.OK_CANCEL,onOk:function t(n){n.close();r._removeDocument(e)},onCancel:function t(e){e.close()}})}}];var u=function t(){return r._viewDeliverySlider(e.ORDER_ID,e.ID)};var d=function t(i){i.preventDefault();E=n.MenuManager.create({id:"payment-documents-delivery-action-"+e.ID,bindElement:i.target,items:T});E.show();r._menus.push(E)};return a.Tag.render(l(),u,c,e.DELIVERY_NAME,_,d,a.Loc.getMessage("CRM_ENTITY_ED_PAYMENT_DOCUMENTS_ACTIONS_MENU"),new s.Label(o).render())}},{key:"_renderAddDocument",value:function t(){var e=this;var r=this._latestOrderId();var i=[{text:a.Loc.getMessage("CRM_ENTITY_ED_PAYMENT_DOCUMENTS_DOCUMENT_TYPE_PAYMENT"),onclick:function t(){return e._context().startSalescenterApplication(r)}}];if(this._isDeliveryAvailable){i.push({text:a.Loc.getMessage("CRM_ENTITY_ED_PAYMENT_DOCUMENTS_DOCUMENT_TYPE_DELIVERY"),onclick:function t(){return e._createDeliverySlider(r)}})}var s=function t(r){r.preventDefault();var a=n.MenuManager.create({id:"payment-documents-create-document-action",bindElement:r.target,items:i});a.show();e._menus.push(a)};return a.Tag.render(c(),s,a.Loc.getMessage("CRM_ENTITY_ED_PAYMENT_DOCUMENTS_CREATE_DOCUMENT"))}},{key:"_calculateTotalSum",value:function t(){var e=parseFloat(this._options.DEAL_AMOUNT);this._docs().forEach(function(t){if(t.TYPE==="PAYMENT"){if(t.PAID&&t.PAID==="Y"){e-=parseFloat(t.SUM)}}});if(e<0){e=0}return e}},{key:"_renderTotalSum",value:function t(){var e=this._calculateTotalSum();var n=a.Tag.render(o(),a.Loc.getMessage("CRM_ENTITY_ED_PAYMENT_DOCUMENTS_TOTAL_SUM"),a.Loc.getMessage("CRM_ENTITY_ED_PAYMENT_DOCUMENTS_TOTAL_SUM_TOOLTIP"),this._renderMoney(e));BX.UI.Hint.init(n);return n}},{key:"_renderMoney",value:function t(e){var n=r.CurrencyCore.currencyFormat(e,this._options.CURRENCY_ID,true);var i=r.CurrencyCore.currencyFormat(e,this._options.CURRENCY_ID,false);var a=n.replace(i,"").trim();return n.replace(a,'<span class="crm-entity-widget-payment-currency">'.concat(a,"</span>"))}},{key:"_docs",value:function t(){if(this._options&&this._options.DOCUMENTS&&this._options.DOCUMENTS.length){return this._options.DOCUMENTS}return[]}},{key:"_context",value:function t(){return this._parentContext}},{key:"_orderIds",value:function t(){if(this._options&&this._options.ORDER_IDS&&this._options.ORDER_IDS.length){return this._options.ORDER_IDS.map(function(t){return parseInt(t)})}return[]}},{key:"_latestOrderId",value:function t(){return Math.max.apply(Math,babelHelpers.toConsumableArray(this._orderIds()))}},{key:"_dealEntityType",value:function t(){return BX.CrmEntityType.enumeration.deal}},{key:"_createDeliverySlider",value:function t(e){var n={context:"deal",templateMode:"create",mode:"delivery",analyticsLabel:"crmDealPaymentDocumentsCreateDeliverySlider",ownerTypeId:this._dealEntityType(),ownerId:this._options.DEAL_ID,orderId:e};this._context().startSalescenterApplication(e,n)}},{key:"_chooseDeliverySlider",value:function t(e){var n={context:"deal",templateMode:"create",mode:"delivery",analyticsLabel:"crmDealPaymentDocumentsChooseDeliverySlider",ownerTypeId:this._dealEntityType(),ownerId:this._options.DEAL_ID,orderId:e};this._context().startSalescenterApplication(e,n)}},{key:"_resendPaymentSlider",value:function t(e,n){var r={disableSendButton:"",context:"deal",mode:"payment_delivery",analyticsLabel:"crmDealPaymentDocumentsResendPaymentSlider",templateMode:"view",ownerTypeId:this._dealEntityType(),ownerId:this._options.DEAL_ID,orderId:e,paymentId:n};this._context().startSalescenterApplication(e,r)}},{key:"_viewDeliverySlider",value:function t(e,n){var r={context:"deal",templateMode:"view",mode:"delivery",analyticsLabel:"crmDealPaymentDocumentsViewDeliverySlider",ownerTypeId:this._dealEntityType(),ownerId:this._options.DEAL_ID,orderId:e,shipmentId:n};this._context().startSalescenterApplication(e,r)}},{key:"_setPaymentPaidStatus",value:function t(e,n){var r=this;var i=n?"Y":"N";var s=n?"PAID":"CANCEL";if(e.PAID&&e.PAID===i){return}this._docs().forEach(function(t){if(t.TYPE==="PAYMENT"&&t.ID===e.ID){t.PAID=i;t.STAGE=s}});this.render();var o=function t(e){};var c=function t(e){r.reloadModel();r._showCommonError()};a.ajax.runAction("sale.payment.setpaid",{data:{id:e.ID,value:i}}).then(o,c)}},{key:"_setShipmentShippedStatus",value:function t(e,n){var r=this;var i=n?"Y":"N";if(e.DEDUCTED&&e.DEDUCTED===i){return}this._docs().forEach(function(t){if(t.TYPE==="SHIPMENT"&&t.ID===e.ID){t.DEDUCTED=i}});this.render();var s=function t(e){};var o=function t(e){r.reloadModel();r._showCommonError()};a.ajax.runAction("sale.shipment.setshipped",{data:{id:e.ID,value:i}}).then(s,o)}},{key:"_removeDocument",value:function t(e){var n=this;var r;if(e.TYPE==="PAYMENT"){r="sale.payment.delete"}else if(e.TYPE==="SHIPMENT"){r="sale.shipment.delete"}else{return}this._options.DOCUMENTS=this._options.DOCUMENTS.filter(function(t){return!(t.TYPE===e.TYPE&&t.ID===e.ID)});this.render();var i=function t(e){};var s=function t(e){n.reloadModel();n._showCommonError()};a.ajax.runAction(r,{data:{id:e.ID}}).then(i,s)}},{key:"_showCommonError",value:function t(){BX.UI.Notification.Center.notify({content:a.Loc.getMessage("CRM_ENTITY_ED_PAYMENT_DOCUMENTS_COMMON_ERROR")})}},{key:"_loading",value:function t(e){if(this._rootNode&&this._rootNode.classList){if(e){this._rootNode.classList.add("is-loading")}else{this._rootNode.classList.remove("is-loading")}}}},{key:"_subscribeToGlobalEvents",value:function t(){var n=this;var r=["salescenter.app:onshipmentcreated","salescenter.app:onpaymentcreated","salescenter.app:onpaymentresend"];var i=500;var s=a.debounce(function(){n.reloadModel()},i);var o={compatMode:true};var c=false;e.EventEmitter.subscribe("SidePanel.Slider:onMessage",function(t){var e=t.getEventId();if(r.indexOf(e)>-1){s();c=true;setTimeout(function(){c=false},2e3)}},o);e.EventEmitter.subscribe("oncrmentityupdate",function(){s()},o);e.EventEmitter.subscribe("onPullEvent-crm",function(t,e){if(t!=="onOrderSave"||c){return}var r=false;var i=n._orderIds();if(e.FIELDS&&e.FIELDS.ID){r=parseInt(e.FIELDS.ID)}if(r&&i.indexOf(r)>-1){s()}},o);e.EventEmitter.subscribe("onPullEvent-salescenter",function(t,e){if(t!=="onOrderPaymentViewed"){return}var r=false;var i=n._orderIds();if(e&&e.ORDER_ID){r=parseInt(e.ORDER_ID);if(i.indexOf(r)>-1){s()}}},o)}},{key:"_setupCurrencyFormat",value:function t(){if(this._options){if(this._options.CURRENCY_ID&&this._options.CURRENCY_FORMAT){r.CurrencyCore.setCurrencyFormat(this._options.CURRENCY_ID,this._options.CURRENCY_FORMAT)}}}}]);return t}();babelHelpers.defineProperty(d,"_rootNodeClass","crm-entity-widget-inner crm-entity-widget-inner--payment");function D(){var t=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="crm-entity-stream-content-detail-table-row">\n\t\t\t\t<div class="crm-entity-stream-content-detail-description">\n\t\t\t\t\t<span>\n\t\t\t\t\t\t','\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div class="crm-entity-stream-content-detail-cost">\n\t\t\t\t\t<span>\n\t\t\t\t\t\t',"\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t"]);D=function e(){return t};return t}function M(){var t=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="crm-entity-stream-content-detail-table-row">\n\t\t\t\t<div class="crm-entity-stream-content-document-description">\n\t\t\t\t\t<a class="ui-link" onclick="','">\n\t\t\t\t\t\t'," (",")\n\t\t\t\t\t</a>\n\t\t\t\t\t",'\n\t\t\t\t</div>\n\t\t\t\t<div class="crm-entity-stream-content-detail-cost">\n\t\t\t\t\t<span>\n\t\t\t\t\t\t',"\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t"]);M=function e(){return t};return t}function m(){var t=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="crm-entity-stream-content-detail-table-row">\n\t\t\t\t<div class="crm-entity-stream-content-document-description">\n\t\t\t\t\t<a class="ui-link" onclick="','">',"</a>\n\t\t\t\t\t",'\n\t\t\t\t</div>\n\t\t\t\t<div class="crm-entity-stream-content-detail-cost">\n\t\t\t\t\t<span>\n\t\t\t\t\t\t',"\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t"]);m=function e(){return t};return t}function p(){var t=babelHelpers.taggedTemplateLiteral(["\n\t\t\t\t<div>\n\t\t\t\t\t","\n\t\t\t\t\t","\n\t\t\t\t\t","\n\t\t\t\t</div>\n\t\t\t"]);p=function e(){return t};return t}function N(){var t=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="crm-entity-stream-content-detail-table-row crm-entity-stream-content-document-table-row">\n\t\t\t\t<div class="crm-entity-stream-content-detail-description">\n\t\t\t\t\t','\n\t\t\t\t</div>\n\t\t\t\t<div class="crm-entity-stream-content-detail-cost">\n\t\t\t\t\t<span>\n\t\t\t\t\t\t',"\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t"]);N=function e(){return t};return t}var v=function(t){babelHelpers.inherits(e,t);function e(){babelHelpers.classCallCheck(this,e);return babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(e).apply(this,arguments))}babelHelpers.createClass(e,[{key:"_renderDealTotalSum",value:function t(){return a.Tag.render(N(),a.Loc.getMessage("CRM_ENTITY_ED_PAYMENT_DOCUMENTS_DEAL_SUM"),this._renderMoney(this._options.DEAL_AMOUNT))}},{key:"render",value:function t(){this._menus.forEach(function(t){return t.destroy()});this._rootNode.innerHTML="";this._setupCurrencyFormat();if(this.hasContent()){this._filterSuccessfulDocuments();this._rootNode.classList.remove("is-hidden");this._rootNode.append(a.Tag.render(p(),this._renderDealTotalSum(),this._renderDocuments(),this._renderTotalSum()))}else{this._rootNode.classList.add("is-hidden")}return this._rootNode}},{key:"_renderPaymentDocument",value:function t(e){var n=this;var r=a.Loc.getMessage("CRM_ENTITY_ED_PAYMENT_DOCUMENTS_PAYMENT_DATE").replace(/#DATE#/gi,e.FORMATTED_DATE);var i={text:a.Loc.getMessage("CRM_ENTITY_ED_PAYMENT_DOCUMENTS_STAGE_".concat(e.STAGE)),customClass:"crm-entity-widget-payment-label",color:s.LabelColor.LIGHT,fill:true};if(e.STAGE&&e.STAGE==="PAID"){i.color=s.LabelColor.LIGHT_GREEN}else if(e.STAGE&&e.STAGE==="VIEWED_NO_PAID"){i.color=s.LabelColor.LIGHT_BLUE}if(!i.text){i.text=e.PAID==="Y"?a.Loc.getMessage("CRM_ENTITY_ED_PAYMENT_DOCUMENTS_STAGE_PAID"):a.Loc.getMessage("CRM_ENTITY_ED_PAYMENT_DOCUMENTS_STAGE_NOT_PAID")}var o=function t(){return n._resendPaymentSlider(e.ORDER_ID,e.ID)};return a.Tag.render(m(),o,r,new s.Label(i).render(),this._renderMoney(e.SUM))}},{key:"_renderShipmentDocument",value:function t(e){var n=this;var r={text:a.Loc.getMessage("CRM_ENTITY_ED_PAYMENT_DOCUMENTS_STATUS_WAITING"),customClass:"crm-entity-widget-payment-label",color:s.LabelColor.LIGHT,fill:true};if(e.DEDUCTED==="Y"){r.text=a.Loc.getMessage("CRM_ENTITY_ED_PAYMENT_DOCUMENTS_STATUS_DELIVERED");r.color=s.LabelColor.LIGHT_GREEN}var i=a.Loc.getMessage("CRM_ENTITY_ED_PAYMENT_DOCUMENTS_DELIVERY_DATE").replace(/#DATE#/gi,e.FORMATTED_DATE);var o=function t(){return n._viewDeliverySlider(e.ORDER_ID,e.ID)};return a.Tag.render(M(),o,i,e.DELIVERY_NAME,new s.Label(r).render(),this._renderMoney(e.SUM))}},{key:"_renderTotalSum",value:function t(){var e=this._calculateTotalSum();return a.Tag.render(D(),a.Loc.getMessage("CRM_ENTITY_ED_PAYMENT_DOCUMENTS_TOTAL_SUM"),this._renderMoney(e))}},{key:"_filterSuccessfulDocuments",value:function t(){this._options.DOCUMENTS=this._options.DOCUMENTS.filter(function(t){return t.TYPE==="PAYMENT"&&t.PAID==="Y"||t.TYPE==="SHIPMENT"&&t.DEDUCTED==="Y"})}}]);return e}(d);babelHelpers.defineProperty(v,"_rootNodeClass","crm-entity-stream-content-detail-table crm-entity-stream-content-documents-table");t.EntityEditorPaymentDocuments=d;t.TimelineSummaryDocuments=v})(this.BX.Crm=this.BX.Crm||{},BX.Event,BX.Main,BX.Currency,BX.UI.Dialogs,BX,BX.UI);
//# sourceMappingURL=payment-documents.bundle.map.js