this.BX=this.BX||{};(function(e,t,i,a){"use strict";var r,o;var l=function(e){babelHelpers.inherits(t,e);function t(){var e;babelHelpers.classCallCheck(this,t);e=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this));e._autocomplete=null;e._autocompleteData=null;return e}babelHelpers.createClass(t,[{key:"doInitialize",value:function e(){var t=this._schemeElement.getData();var i=BX.prop.getBoolean(t,"enabled",false);this._autocomplete=a.RequisiteAutocompleteField.create(this.getName(),{placeholderText:BX.prop.getString(t,"placeholder",""),enabled:i,featureRestrictionCallback:BX.prop.getString(t,"featureRestrictionCallback",""),searchAction:"crm.requisite.entity.search",feedbackFormParams:BX.prop.getObject(t,"feedback_form",{}),showFeedbackLink:!i,clientResolverPlacementParams:BX.prop.getObject(t,"clientResolverPlacementParams",null)});this._autocomplete.subscribe("onSelectValue",this.onSelectAutocompleteValue.bind(this));this._autocomplete.subscribe("onClear",this.onClearAutocompleteValue.bind(this))}},{key:"createTitleMarker",value:function e(){if(this._mode===BX.UI.EntityEditorMode.view){return null}var a=BX.prop.getString(this._schemeElement.getData(),"featureRestrictionCallback","");if(a===""){return babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"createTitleMarker",this).call(this)}var o=i.Tag.render(r||(r=babelHelpers.taggedTemplateLiteral([' <span class="tariff-lock"></span>'])));o.setAttribute("onclick",a);return o}},{key:"layout",value:function e(t){if(this._hasLayout){return}if(this._mode===BX.UI.EntityEditorMode.view){if(!this._wrapper){this._wrapper=BX.create("div")}}else{this.ensureWrapperCreated({classNames:["ui-entity-editor-field-text"]});this.adjustWrapper()}if(!this.isNeedToDisplay()){this.registerLayout(t);this._hasLayout=true;return}if(this.isDragEnabled()){i.Dom.append(this.createDragButton(),this._wrapper)}i.Dom.append(this.createTitleNode(this.getTitle()),this._wrapper);if(this._mode===BX.UI.EntityEditorMode.edit){var a=i.Tag.render(o||(o=babelHelpers.taggedTemplateLiteral(['<div class="ui-entity-editor-content-block"></div>'])));this._autocomplete.layout(a);this.updateAutocompleteState();i.Dom.append(a,this._wrapper)}if(this.isContextMenuEnabled()){this._wrapper.appendChild(this.createContextMenuButton())}if(this.isDragEnabled()){this.initializeDragDropAbilities()}this.registerLayout(t);this._hasLayout=true}},{key:"isNeedToDisplay",value:function e(){return babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"isNeedToDisplay",this).call(this)&&this._mode===BX.UI.EntityEditorMode.edit}},{key:"updateAutocompleteState",value:function e(){var t=null;try{t=JSON.parse(this.getValue())}catch(e){}this._autocomplete.setState(t);this._autocomplete.setContext(this.getAutocompleteContext())}},{key:"onSelectAutocompleteValue",value:function e(t){this._autocompleteData=t.getData();this.markAsChanged()}},{key:"onClearAutocompleteValue",value:function e(t){this._autocomplete.setCurrentItem(null);this._autocompleteData=null}},{key:"getAutocompleteData",value:function e(){return this._autocompleteData}},{key:"getAutocompleteContext",value:function e(){return{typeId:"ITIN",presetId:this._editor.getControlById("PRESET_ID").getValue()}}}],[{key:"create",value:function e(t,i){var a=new this(t,i);a.initialize(t,i);return a}},{key:"onInitializeEditorControlFactory",value:function e(i){var a=i.getData();if(a[0]){a[0].methods["requisite_autocomplete"]=function(e,i,a){if(e==="requisite_autocomplete"){return t.create(i,a)}return null}}i.setData(a)}}]);return t}(BX.UI.EntityEditorField);t.EventEmitter.subscribe("BX.UI.EntityEditorControlFactory:onInitialize",l.onInitializeEditorControlFactory);e.EntityEditorRequisiteAutocomplete=l})(this.BX.Crm=this.BX.Crm||{},BX.Event,BX,BX.Crm);
//# sourceMappingURL=requisite-autocomplete.bundle.map.js