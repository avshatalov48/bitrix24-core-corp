{"version":3,"sources":["editor-controller.js"],"names":["BX","namespace","Crm","EditorFieldSingleEditController","UI","EditorFieldViewController","EntityEditorController","EntityEditorProductRowProxy","superclass","constructor","apply","this","_externalEditor","_editorCreateHandler","_sumTotalChangeHandler","_productAddHandler","_productChangeHandler","_productRemoveHandler","_editorModeChangeHandler","delegate","onEditorModeChange","_editorControlChangeHandler","onEditorControlChange","_currencyId","_isManualOpportunity","_prevProductCount","_curProductCount","extend","prototype","doInitialize","onSumTotalChange","onProductAdd","onProductChange","onProductRemove","externalEditor","CrmProductEditor","get","getExternalEditorId","setExternalEditor","onEditorCreate","addCustomEvent","window","_editor","addModeChangeListener","onTabShow","setTimeout","opportunityControl","getOpportunityControl","addChangeAmountEditModeListener","onchangeAmountEditMode","bind","_model","getField","getControlByIdRecursive","EntityEditorMoney","tab","getId","hasLayout","layout","getConfigStringParam","editor","setForm","removeCustomEvent","getFormElement","getProductCount","adjustLocks","isManualOpportunity","doAdjustLocks","lockField","unlockField","adjustTotals","totals","needMarkAsChanged","getManualOpportunityValue","popup","EditorAuxiliaryDialog","getById","close","create","title","messages","manualOpportunityChangeModeTitle","content","manualOpportunityChangeModeText","zIndex","overlay","buttons","id","type","DialogButtonType","accept","text","manualOpportunityChangeModeYes","callback","event","getDialog","setManualOpportunity","doAdjustTotals","markAsChanged","cancel","manualOpportunityChangeModeNo","open","setField","enableNotification","isManual","notifyOpportunityControl","setHasRelatedProducts","sender","getMode","EntityEditorMode","edit","addControlChangeListener","removeControlChangeListener","params","name","prop","getString","currencyId","setCurrencyId","product","totalSum","allTotals","FORMATTED_SUM_WITH_CURRENCY","FORMATTED_SUM","SUM","onAfterSave","_manualOpportunityHiddenInput","Dom","remove","removeFormFields","rollback","_isChanged","onBeforeSubmit","isChanged","isNew","handleFormSubmit","form","findChild","tagName","attr","attrs","value","appendChild","onBeforesSaveControl","data","handleControlSave","field","isItemOpened","manualOpportunityConfirmationTitle","manualOpportunityConfirmationText","manualOpportunityConfirmationYes","manualOpportunityConfirmationNo","calculateTotals","settings","self","initialize"],"mappings":"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","file":"editor-controller.map.js"}