BX.namespace("BX.Crm");if(typeof BX.Crm.EntityValidator==="undefined"){BX.Crm.EntityValidator=function(){this._settings={};this._editor=null;this._data=null};BX.Crm.EntityValidator.prototype={initialize:function(t){this._settings=t?t:{};this._editor=BX.prop.get(this._settings,"editor",null);this._data=BX.prop.getObject(this._settings,"data",{});this.doInitialize()},doInitialize:function(){},release:function(){},getData:function(){return this._data},getDataStringParam:function(t,i){return BX.prop.getString(this._data,t,i)},getErrorMessage:function(){return BX.prop.getString(this._settings,"message","")},validate:function(t){return true},processControlChange:function(t){}}}if(typeof BX.Crm.EntityPersonValidator==="undefined"){BX.Crm.EntityPersonValidator=function(){BX.Crm.EntityPersonValidator.superclass.constructor.apply(this)};BX.extend(BX.Crm.EntityPersonValidator,BX.Crm.EntityValidator);BX.Crm.EntityPersonValidator.prototype.doInitialize=function(){this._nameField=this._editor.getControlById(this.getDataStringParam("nameField",""));if(this._nameField){this._nameField.addValidator(this)}this._lastNameField=this._editor.getControlById(this.getDataStringParam("lastNameField",""));if(this._lastNameField){this._lastNameField.addValidator(this)}};BX.Crm.EntityPersonValidator.prototype.release=function(){if(this._nameField){this._nameField.removeValidator(this)}if(this._lastNameField){this._lastNameField.removeValidator(this)}};BX.Crm.EntityPersonValidator.prototype.validate=function(t){var i=this._nameField.isActive();var e=this._lastNameField.isActive();if(!i&&!e){return true}var r=i?this._nameField.getRuntimeValue():this._nameField.getValue();var n=e?this._lastNameField.getRuntimeValue():this._lastNameField.getValue();if(r!==""||n!==""){return true}if(r===""&&i){t.addError(BX.Crm.EntityValidationError.create({field:this._nameField}));this._nameField.showError(this.getErrorMessage())}if(n===""&&e){t.addError(BX.Crm.EntityValidationError.create({field:this._lastNameField}));this._lastNameField.showError(this.getErrorMessage())}return false};BX.Crm.EntityPersonValidator.prototype.processFieldChange=function(t){if(t!==this._nameField&&t!==this._lastNameField){return}if(this._nameField){this._nameField.clearError()}if(this._lastNameField){this._lastNameField.clearError()}};BX.Crm.EntityPersonValidator.create=function(t){var i=new BX.Crm.EntityPersonValidator;i.initialize(t);return i}}if(typeof BX.Crm.EntityValidationError==="undefined"){BX.Crm.EntityValidationError=function(){this._settings={};this._field=null;this._message=""};BX.Crm.EntityValidationError.prototype={initialize:function(t){this._settings=t?t:{};this._field=BX.prop.get(this._settings,"field",null);this._message=BX.prop.getString(this._settings,"message","")},getField:function(){return this._field},getMessage:function(){return this._message}};BX.Crm.EntityValidationError.create=function(t){var i=new BX.Crm.EntityValidationError;i.initialize(t);return i}}if(typeof BX.Crm.EntityValidationResult==="undefined"){BX.Crm.EntityValidationResult=function(){this._settings={};this._errors=[]};BX.Crm.EntityValidationResult.prototype={initialize:function(t){this._settings=t?t:{}},getStatus:function(){return this._errors.length===0},addError:function(t){this._errors.push(t)},getErrors:function(){return this._errors},addResult:function(t){var i=t.getErrors();for(var e=0,r=i.length;e<r;e++){this._errors.push(i[e])}},getTopmostField:function(){var t=null;var i=null;for(var e=0,r=this._errors.length;e<r;e++){var n=this._errors[e].getField();if(!t){t=n;i=n.getPosition()["top"];continue}var a=n.getPosition();if(!a){continue}var s=n.getPosition()["top"];if(s<i){t=n;i=s}}return t}};BX.Crm.EntityValidationResult.create=function(t){var i=new BX.Crm.EntityValidationResult;i.initialize(t);return i}}if(typeof BX.Crm.EntityAsyncValidator==="undefined"){BX.Crm.EntityAsyncValidator=function(){this.promisesList=[];this.isValid=true};BX.Crm.EntityAsyncValidator.prototype={addResult:function(t){if(t instanceof Promise||t instanceof BX.Promise){this.promisesList.push(t)}else{this.isValid=this.isValid&&t}},validate:function(){if(this.promisesList.length){return Promise.all(this.promisesList)}return this.isValid}};BX.Crm.EntityAsyncValidator.create=function(){return new BX.Crm.EntityAsyncValidator}}
//# sourceMappingURL=validator.map.js