BX.namespace("BX.Crm");if(typeof BX.Crm.EditorDialogButton==="undefined"){BX.Crm.EditorDialogButton=function(){this._id="";this._type=BX.Crm.DialogButtonType.undefined;this._settings={};this._dialog=null;this._keyPressHandler=BX.delegate(this.onKeyPress,this)};BX.Crm.EditorDialogButton.prototype={initialize:function(t,i){this._id=BX.type.isNotEmptyString(t)?t:BX.util.getRandomString(4);this._settings=i?i:{};this._type=BX.prop.getInteger(this._settings,"type",BX.Crm.DialogButtonType.undefined);this._dialog=BX.prop.get(this._settings,"dialog",null)},bind:function(){if(this._type===BX.Crm.DialogButtonType.accept){BX.bind(document,"keydown",this._keyPressHandler)}},unbind:function(){if(this._type===BX.Crm.DialogButtonType.accept){BX.unbind(document,"keydown",this._keyPressHandler)}},onKeyPress:function(t){if(this._type!==BX.Crm.DialogButtonType.accept){return}t=t||window.event;if(t.keyCode===13){this.onClick(t)}},getId:function(){return this._id},getDialog:function(){return this._dialog},prepareContent:function(){if(this._type===BX.Crm.DialogButtonType.accept){return new BX.UI.SaveButton({text:BX.prop.getString(this._settings,"text",this._id),events:{click:BX.delegate(this.onClick,this)}})}else if(this._type===BX.Crm.DialogButtonType.cancel){return new BX.UI.CancelButton({text:BX.prop.getString(this._settings,"text",this._id),events:{click:BX.delegate(this.onClick,this)}})}else{return new BX.UI.Button({text:BX.prop.getString(this._settings,"text",this._id),events:{click:BX.delegate(this.onClick,this)}})}},onClick:function(t){var i=BX.prop.getFunction(this._settings,"callback",null);if(i){i(this)}}};BX.Crm.EditorDialogButton.create=function(t,i){var e=new BX.Crm.EditorDialogButton;e.initialize(t,i);return e}}if(typeof BX.Crm.EditorAuxiliaryDialog==="undefined"){BX.Crm.EditorAuxiliaryDialog=function(){this._id="";this._settings={};this._popup=null;this._buttons=null};BX.Crm.EditorAuxiliaryDialog.prototype={initialize:function(t,i){this._id=BX.type.isNotEmptyString(t)?t:BX.util.getRandomString(4);this._settings=i?i:{}},getSetting:function(t,i){return BX.prop.get(this._settings,t,i)},getId:function(){return this._id},open:function(){this._popup=new BX.PopupWindow(this._id,BX.prop.getElementNode(this._settings,"anchor",null),{autoHide:false,draggable:false,closeByEsc:true,offsetLeft:0,offsetTop:0,zIndex:BX.prop.getInteger(this._settings,"zIndex",0),overlay:BX.prop.getBoolean(this._settings,"overlay",false),bindOptions:{forceBindPosition:true},titleBar:BX.prop.getString(this._settings,"title","No title"),content:BX.prop.getString(this._settings,"content",""),buttons:this.prepareButtons(),events:{onPopupShow:BX.delegate(this.onPopupShow,this),onPopupClose:BX.delegate(this.onPopupClose,this),onPopupDestroy:BX.delegate(this.onPopupDestroy,this)}});this._popup.show()},close:function(){if(this._popup){this._popup.close()}},isOpen:function(){return this._popup&&this._popup.isShown()},prepareButtons:function(){var t=[];this._buttons=[];var i=BX.prop.getArray(this._settings,"buttons",[]);for(var e=0,n=i.length;e<n;e++){var o=i[e];o["dialog"]=this;var s=BX.Crm.EditorDialogButton.create(BX.prop.getString(o,"id",""),o);this._buttons.push(s);t.push(s.prepareContent())}return t},bind:function(){for(var t=0,i=this._buttons.length;t<i;t++){this._buttons[t].bind()}},unbind:function(){for(var t=0,i=this._buttons.length;t<i;t++){this._buttons[t].unbind()}},onPopupShow:function(){this.bind()},onPopupClose:function(){this.unbind();if(this._popup){this._popup.destroy()}},onPopupDestroy:function(){if(this._popup){this._popup=null}delete BX.Crm.EditorAuxiliaryDialog.items[this.getId()]}};BX.Crm.EditorAuxiliaryDialog.items={};BX.Crm.EditorAuxiliaryDialog.isItemOpened=function(t){return this.items.hasOwnProperty(t)&&this.items[t].isOpen()};BX.Crm.EditorAuxiliaryDialog.hasOpenItems=function(){for(var t in this.items){if(!this.items.hasOwnProperty(t)){continue}if(this.items[t].isOpen()){return true}}return false};BX.Crm.EditorAuxiliaryDialog.getById=function(t){return this.items.hasOwnProperty(t)?this.items[t]:null};BX.Crm.EditorAuxiliaryDialog.create=function(t,i){var e=new BX.Crm.EditorAuxiliaryDialog;e.initialize(t,i);this.items[e.getId()]=e;return e}}
//# sourceMappingURL=dialog.map.js