BX.namespace("BX.Crm");if(typeof BX.Crm.EntityModel==="undefined"){BX.Crm.EntityModel=function(){this._id="";this._settings={};this._data=null;this._initData=null;this._lockedFields=null;this._changeNotifier=null;this._lockNotifier=null};BX.Crm.EntityModel.prototype={initialize:function(t,e){this._id=BX.type.isNotEmptyString(t)?t:BX.util.getRandomString(4);this._settings=e?e:{};this._data=BX.prop.getObject(this._settings,"data",{});this._initData=BX.clone(this._data);this._lockedFields={};this._changeNotifier=BX.CrmNotifier.create(this);this._lockNotifier=BX.CrmNotifier.create(this);this.doInitialize()},doInitialize:function(){},getEntityTypeId:function(){return BX.CrmEntityType.enumeration.undefined},getEntityId:function(){return BX.prop.getInteger(this._data,"ID",0)},getOwnerInfo:function(){return{ownerID:this.getEntityId(),ownerType:BX.CrmEntityType.resolveName(this.getEntityTypeId())}},getField:function(t,e){if(e===undefined){e=null}return BX.prop.get(this._data,t,e)},getStringField:function(t,e){if(e===undefined){e=null}return BX.prop.getString(this._data,t,e)},getIntegerField:function(t,e){if(e===undefined){e=null}return BX.prop.getInteger(this._data,t,e)},getNumberField:function(t,e){if(e===undefined){e=null}return BX.prop.getNumber(this._data,t,e)},getArrayField:function(t,e){if(e===undefined){e=null}return BX.prop.getArray(this._data,t,e)},registerNewField:function(t,e){this._data[t]=e;this._initData[t]=e},setField:function(t,e,i){if(this._data.hasOwnProperty(t)&&this._data[t]===e){return}this._data[t]=e;if(!BX.type.isPlainObject(i)){i={}}if(BX.prop.getBoolean(i,"enableNotification",true)){this._changeNotifier.notify([{name:t,originator:BX.prop.get(i,"originator",null)}]);BX.onCustomEvent(window,"Crm.EntityModel.Change",[this,{entityTypeId:this.getEntityTypeId(),entityId:this.getEntityId(),fieldName:t}])}},getData:function(){return this._data},setData:function(t,e){this._data=BX.type.isPlainObject(t)?t:{};this._initData=BX.clone(this._data);if(BX.prop.getBoolean(e,"enableNotification",true)){this._changeNotifier.notify([{forAll:true,originator:BX.prop.get(e,"originator",null)}]);BX.onCustomEvent(window,"Crm.EntityModel.Change",[this,{entityTypeId:this.getEntityTypeId(),entityId:this.getEntityId(),forAll:true}])}},updateData:function(t,e){if(!BX.type.isPlainObject(t)){return}this._data=BX.mergeEx(this._data,t);if(BX.prop.getBoolean(e,"enableNotification",true)){this._changeNotifier.notify([{forAll:true,originator:BX.prop.get(e,"originator",null)}]);BX.onCustomEvent(window,"Crm.EntityModel.Change",[this,{entityTypeId:this.getEntityTypeId(),entityId:this.getEntityId(),forAll:true}])}},updateDataObject:function(t,e,i){if(!this._data.hasOwnProperty(t)){this._data[t]=e}else{this._data[t]=BX.mergeEx(this._data[t],e)}if(BX.prop.getBoolean(i,"enableNotification",true)){this._changeNotifier.notify([{forAll:true,originator:BX.prop.get(i,"originator",null)}]);BX.onCustomEvent(window,"Crm.EntityModel.Change",[this,{entityTypeId:this.getEntityTypeId(),entityId:this.getEntityId(),forAll:true}])}},getSchemeField:function(t,e,i){return this.getField(t.getDataStringParam(e,""),i)},setSchemeField:function(t,e,i){var n=t.getDataStringParam(e,"");if(n!==""){this.setField(n,i)}},getMappedField:function(t,e,i){var n=BX.prop.getString(t,e,"");return n!==""?this.getField(n,i):i},setMappedField:function(t,e,i){var n=BX.prop.getString(t,e,"");if(n!==""){this.setField(n,i)}},getInitFieldValue:function(t,e){if(e===undefined){e=null}return BX.prop.get(this._initData,t,e)},setInitFieldValue:function(t,e){if(this._initData.hasOwnProperty(t)&&this._initData[t]===e){return}this._initData[t]=e},save:function(){},rollback:function(){this._data=BX.clone(this._initData)},lockField:function(t){if(this._lockedFields.hasOwnProperty(t)){return}this._lockedFields[t]=true;this._lockNotifier.notify([{name:name,isLocked:true}])},unlockField:function(t){if(!this._lockedFields.hasOwnProperty(t)){return}delete this._lockedFields[t];this._lockNotifier.notify([{name:name,isLocked:false}])},isFieldLocked:function(t){return this._lockedFields.hasOwnProperty(t)},addChangeListener:function(t){this._changeNotifier.addListener(t)},removeChangeListener:function(t){this._changeNotifier.removeListener(t)},addLockListener:function(t){this._lockNotifier.addListener(t)},removeLockListener:function(t){this._lockNotifier.removeListener(t)},isCaptionEditable:function(){return false},getCaption:function(){return""},setCaption:function(t){},prepareCaptionData:function(t){}};BX.Crm.EntityModel.create=function(t,e){var i=new BX.Crm.EntityModel;i.initialize(t,e);return i}}if(typeof BX.Crm.LeadModel==="undefined"){BX.Crm.LeadModel=function(){BX.Crm.LeadModel.superclass.constructor.apply(this)};BX.extend(BX.Crm.LeadModel,BX.Crm.EntityModel);BX.Crm.LeadModel.prototype.doInitialize=function(){BX.addCustomEvent(window,"Crm.EntityProgress.Change",BX.delegate(this.onEntityProgressChange,this))};BX.Crm.LeadModel.prototype.onEntityProgressChange=function(t,e){if(BX.prop.getInteger(e,"entityTypeId",0)!==this.getEntityTypeId()||BX.prop.getInteger(e,"entityId",0)!==this.getEntityId()){return}var i=BX.prop.getString(e,"currentStepId","");if(i!==this.getField("STATUS_ID","")){this.setField("STATUS_ID",i)}};BX.Crm.LeadModel.prototype.getEntityTypeId=function(){return BX.CrmEntityType.enumeration.lead};BX.Crm.LeadModel.prototype.isCaptionEditable=function(){return true};BX.Crm.LeadModel.prototype.getCaption=function(){var t=this.getField("TITLE");return BX.type.isString(t)?t:""};BX.Crm.LeadModel.prototype.setCaption=function(t){this.setField("TITLE",t)};BX.Crm.LeadModel.prototype.prepareCaptionData=function(t){t["TITLE"]=this.getField("TITLE","")};BX.Crm.LeadModel.create=function(t,e){var i=new BX.Crm.LeadModel;i.initialize(t,e);return i}}if(typeof BX.Crm.ContactModel==="undefined"){BX.Crm.ContactModel=function(){BX.Crm.ContactModel.superclass.constructor.apply(this)};BX.extend(BX.Crm.ContactModel,BX.Crm.EntityModel);BX.Crm.ContactModel.prototype.getEntityTypeId=function(){return BX.CrmEntityType.enumeration.contact};BX.Crm.ContactModel.prototype.getCaption=function(){return this.getField("FORMATTED_NAME","")};BX.Crm.ContactModel.create=function(t,e){var i=new BX.Crm.ContactModel;i.initialize(t,e);return i}}if(typeof BX.Crm.CompanyModel==="undefined"){BX.Crm.CompanyModel=function(){BX.Crm.CompanyModel.superclass.constructor.apply(this)};BX.extend(BX.Crm.CompanyModel,BX.Crm.EntityModel);BX.Crm.CompanyModel.prototype.isCaptionEditable=function(){return true};BX.Crm.CompanyModel.prototype.getEntityTypeId=function(){return BX.CrmEntityType.enumeration.company};BX.Crm.CompanyModel.prototype.getCaption=function(){return this.getField("TITLE","")};BX.Crm.CompanyModel.prototype.setCaption=function(t){this.setField("TITLE",t)};BX.Crm.CompanyModel.prototype.prepareCaptionData=function(t){t["TITLE"]=this.getField("TITLE","")};BX.Crm.CompanyModel.create=function(t,e){var i=new BX.Crm.CompanyModel;i.initialize(t,e);return i}}if(typeof BX.Crm.DealModel==="undefined"){BX.Crm.DealModel=function(){BX.Crm.DealModel.superclass.constructor.apply(this)};BX.extend(BX.Crm.DealModel,BX.Crm.EntityModel);BX.Crm.DealModel.prototype.doInitialize=function(){BX.addCustomEvent(window,"Crm.EntityProgress.Saved",BX.delegate(this.onEntityProgressSave,this))};BX.Crm.DealModel.prototype.onEntityProgressSave=function(t,e){if(BX.prop.getInteger(e,"entityTypeId",0)!==this.getEntityTypeId()||BX.prop.getInteger(e,"entityId",0)!==this.getEntityId()){return}var i=BX.prop.getString(e,"currentStepId","");if(i!==this.getField("STAGE_ID","")){this.setField("STAGE_ID",i)}};BX.Crm.DealModel.prototype.getEntityTypeId=function(){return BX.CrmEntityType.enumeration.deal};BX.Crm.DealModel.prototype.isCaptionEditable=function(){return true};BX.Crm.DealModel.prototype.getCaption=function(){var t=this.getField("TITLE");return BX.type.isString(t)?t:""};BX.Crm.DealModel.prototype.setCaption=function(t){this.setField("TITLE",t)};BX.Crm.DealModel.prototype.prepareCaptionData=function(t){t["TITLE"]=this.getField("TITLE","")};BX.Crm.DealModel.create=function(t,e){var i=new BX.Crm.DealModel;i.initialize(t,e);return i}}if(typeof BX.Crm.DealRecurringModel==="undefined"){BX.Crm.DealRecurringModel=function(){BX.Crm.DealRecurringModel.superclass.constructor.apply(this)};BX.extend(BX.Crm.DealRecurringModel,BX.Crm.DealModel);BX.Crm.DealRecurringModel.create=function(t,e){var i=new BX.Crm.DealRecurringModel;i.initialize(t,e);return i}}if(typeof BX.Crm.QuoteModel==="undefined"){BX.Crm.QuoteModel=function(){BX.Crm.QuoteModel.superclass.constructor.apply(this)};BX.extend(BX.Crm.QuoteModel,BX.Crm.EntityModel);BX.Crm.QuoteModel.prototype.doInitialize=function(){BX.addCustomEvent(window,"Crm.EntityProgress.Change",BX.delegate(this.onEntityProgressChange,this))};BX.Crm.QuoteModel.prototype.onEntityProgressChange=function(t,e){if(BX.prop.getInteger(e,"entityTypeId",0)!==this.getEntityTypeId()||BX.prop.getInteger(e,"entityId",0)!==this.getEntityId()){return}var i=BX.prop.getString(e,"currentStepId","");if(i!==this.getField("STATUS_ID","")){this.setField("STATUS_ID",i)}};BX.Crm.QuoteModel.prototype.getEntityTypeId=function(){return BX.CrmEntityType.enumeration.quote};BX.Crm.QuoteModel.prototype.isCaptionEditable=function(){return true};BX.Crm.QuoteModel.prototype.getCaption=function(){var t=this.getField("TITLE");return BX.type.isString(t)?t:""};BX.Crm.QuoteModel.prototype.setCaption=function(t){this.setField("TITLE",t)};BX.Crm.QuoteModel.prototype.prepareCaptionData=function(t){t["TITLE"]=this.getField("TITLE","")};BX.Crm.QuoteModel.create=function(t,e){var i=new BX.Crm.QuoteModel;i.initialize(t,e);return i}}
//# sourceMappingURL=model.map.js