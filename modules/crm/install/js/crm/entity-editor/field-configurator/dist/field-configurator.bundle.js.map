{"version":3,"file":"field-configurator.bundle.js","sources":["../src/phone-number-input-field-configurator.js","../src/entity-configuration-manager.js"],"sourcesContent":["import { Dom, Loc, Tag, Type } from 'main.core';\nimport { TagSelector } from 'crm.entity-selector';\n\nimport './phone-number-input-field-configurator.css'\n\nconst DEFAULT_COUNTRY_CODE = 'XX';\n\n/**\n * @memberOf BX.Crm\n */\nexport class PhoneNumberInputFieldConfigurator extends BX.UI.EntityEditorFieldConfigurator\n{\n\t#countrySelector: ?TagSelector = null;\n\n\tdestroy()\n\t{\n\t\tif (this.#countrySelector)\n\t\t{\n\t\t\tthis.#countrySelector.destroy();\n\t\t}\n\t}\n\n\t// region overridden methods from BX.UI.EntityEditorFieldConfigurator ----------------------------------------------\n\t/**\n\t * @override\n\t */\n\tlayoutInternal(): void\n\t{\n\t\tthis._wrapper.appendChild(this.getInputContainer());\n\t\tif (this._typeId === \"list\")\n\t\t{\n\t\t\tthis.layoutInnerConfigurator(this._field.getInnerConfig(), this._field.getItems());\n\t\t}\n\t\tthis._wrapper.appendChild(this.getOptionContainer());\n\n\t\tif (this._typeId === 'multifield' || this._typeId === 'client_light') {\n\t\t\tthis._wrapper.appendChild(this.getCountrySelectContainer()); // NEW: country selector added\n\t\t}\n\t\tDom.append(Tag.render`<hr class=\"ui-entity-editor-line\">`, this._wrapper);\n\t\tthis._wrapper.appendChild(this.getButtonContainer());\n\t};\n\n\t/**\n\t * @param event\n\t *\n\t * @returns {Object}\n\t *\n\t * @override\n\t */\n\tprepareSaveParams(event): Object\n\t{\n\t\tconst params = super.prepareSaveParams(this, arguments);\n\n\t\t// add selected value\n\t\tif (this.#countrySelector)\n\t\t{\n\t\t\tconst items = this.#countrySelector.getDialog().getSelectedItems();\n\t\t\tif (items.length <= 1)\n\t\t\t{\n\t\t\t\tparams['defaultCountry'] = items.length === 0 ? DEFAULT_COUNTRY_CODE : items[0].id;\n\n\t\t\t\tthis._field.getSchemeElement()._options['defaultCountry'] = params['defaultCountry'];\n\t\t\t}\n\t\t}\n\n\t\treturn params;\n\t}\n\t// endregion -------------------------------------------------------------------------------------------------------\n\n\tgetCountrySelectContainer()\n\t{\n\t\tconst wrapper = Tag.render`\n\t\t\t<div class=\"ui-entity-editor-content-block\">\n\t\t\t\t<div class=\"ui-entity-editor-block-title\">\n\t\t\t\t\t<span class=\"ui-entity-editor-block-title-text\">\n\t\t\t\t\t\t${Loc.getMessage('CRM_PHONE_NUMBER_INPUT_FIELD_CONFIGURATOR_TITLE')}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tconst selectContainer = Tag.render`\n\t\t\t<div class=\"ui-entity-editor-content-block crm-entity-country-tag-selector\"></div>\n\t\t`;\n\n\t\tDom.append(selectContainer, wrapper);\n\n\t\tlet defaultCountry = DEFAULT_COUNTRY_CODE;\n\n\t\tif (\n\t\t\tthis._field\n\t\t\t&& this._field.getSchemeElement()\n\t\t\t&& Type.isPlainObject(this._field.getSchemeElement()._options)\n\t\t\t&& Type.isStringFilled(this._field.getSchemeElement()._options.defaultCountry)\n\t\t)\n\t\t{\n\t\t\tdefaultCountry = this._field.getSchemeElement()._options.defaultCountry;\n\t\t}\n\n\t\tthis.#countrySelector = new TagSelector({\n\t\t\ttextBoxWidth: '100%',\n\t\t\ttagMaxWidth: 270,\n\t\t\tplaceholder: Loc.getMessage('CRM_PHONE_NUMBER_INPUT_FIELD_CONFIGURATOR_PLACEHOLDER'),\n\t\t\tmultiple: false,\n\t\t\tdialogOptions: {\n\t\t\t\twidth: 425,\n\t\t\t\tmultiple: false,\n\t\t\t\tshowAvatars: true,\n\t\t\t\tdropdownMode: true,\n\t\t\t\tpreselectedItems: [\n\t\t\t\t\t['country', defaultCountry],\n\t\t\t\t],\n\t\t\t\tentities: [{\n\t\t\t\t\tid: 'country'\n\t\t\t\t}],\n\t\t\t\tevents: {\n\t\t\t\t\t'onFirstShow': (event) => {\n\t\t\t\t\t\tconst popupContainer = event.getTarget().getPopup().getContentContainer();\n\t\t\t\t\t\tif (Type.isDomNode(popupContainer))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tDom.addClass(popupContainer, 'crm-entity-country-tag-selector-popup')\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tthis.#countrySelector.renderTo(selectContainer);\n\n\t\treturn wrapper;\n\t}\n\n\tstatic create(id, settings): PhoneNumberInputFieldConfigurator\n\t{\n\t\tconst self = new this;\n\n\t\tself.initialize(id, settings);\n\n\t\treturn self;\n\t}\n}\n","import {Type} from 'main.core';\n\nimport {PhoneNumberInputFieldConfigurator} from './phone-number-input-field-configurator';\n\n/**\n * @memberOf BX.Crm\n */\nexport default class EntityConfigurationManager extends BX.UI.EntityConfigurationManager\n{\n\t/**\n\t * @param {Object} params\n\t * @param {Object} parent\n\t *\n\t * @returns {BX.UI.EntityEditorFieldConfigurator}\n\t *\n\t * @override\n\t */\n\tgetSimpleFieldConfigurator(params: Object, parent: Object): BX.UI.EntityEditorFieldConfigurator\n\t{\n\t\tif (!Type.isPlainObject(params))\n\t\t{\n\t\t\tthrow 'EntityConfigurationManager: The \"params\" argument must be object.';\n\t\t}\n\n\t\tlet typeId = '';\n\t\tlet child = BX.prop.get(params, 'field', null);\n\t\tif (child)\n\t\t{\n\t\t\ttypeId = child.getType();\n\n\t\t\tchild.setVisible(false);\n\t\t}\n\t\telse\n\t\t{\n\t\t\ttypeId = BX.prop.get(params, 'typeId', BX.UI.EntityUserFieldType.string);\n\t\t}\n\n\t\t// override for 'PHONE', 'CLIENT', 'COMPANY', 'CONTACT' fields: add additional option to setup default country phone code\n\t\tif (['PHONE', 'CLIENT', 'COMPANY', 'CONTACT', 'MYCOMPANY_ID'].indexOf(child.getId()) >= 0)\n\t\t{\n\t\t\treturn this._fieldConfigurator = PhoneNumberInputFieldConfigurator.create(\n\t\t\t\t'',\n\t\t\t\t{\n\t\t\t\t\teditor: this._editor,\n\t\t\t\t\tschemeElement: null,\n\t\t\t\t\tmodel: parent._model,\n\t\t\t\t\tmode: BX.UI.EntityEditorMode.edit,\n\t\t\t\t\tparent: parent,\n\t\t\t\t\ttypeId: typeId,\n\t\t\t\t\tfield: child,\n\t\t\t\t\tmandatoryConfigurator: params.mandatoryConfigurator\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn this._fieldConfigurator = BX.UI.EntityEditorFieldConfigurator.create(\n\t\t\t\t'',\n\t\t\t\t{\n\t\t\t\t\teditor: this._editor,\n\t\t\t\t\tschemeElement: null,\n\t\t\t\t\tmodel: parent._model,\n\t\t\t\t\tmode: BX.UI.EntityEditorMode.edit,\n\t\t\t\t\tparent: parent,\n\t\t\t\t\ttypeId: typeId,\n\t\t\t\t\tfield: child,\n\t\t\t\t\tmandatoryConfigurator: params.mandatoryConfigurator\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t}\n\n\t/**\n\t * @param {Object} params\n\t * @param {Object} parent\n\t *\n\t * @returns { BX.UI.EntityEditorUserFieldConfigurator}\n\t *\n\t * @override\n\t */\n\tgetUserFieldConfigurator(params: Object, parent: Object): BX.UI.EntityEditorUserFieldConfigurator\n\t{\n\t\tif (!Type.isPlainObject(params))\n\t\t{\n\t\t\tthrow 'EntityConfigurationManager: The \"params\" argument must be object.';\n\t\t}\n\n\t\tlet typeId = '';\n\t\tlet field = BX.prop.get(params, 'field', null);\n\t\tif (field)\n\t\t{\n\t\t\tif (!(field instanceof BX.UI.EntityEditorUserField))\n\t\t\t{\n\t\t\t\tthrow 'EntityConfigurationManager: The \"field\" param must be EntityEditorUserField.';\n\t\t\t}\n\n\t\t\ttypeId = field.getFieldType();\n\n\t\t\tfield.setVisible(false);\n\t\t}\n\t\telse\n\t\t{\n\t\t\ttypeId = BX.prop.get(params, 'typeId', BX.UI.EntityUserFieldType.string);\n\t\t}\n\n\t\tif (typeId === 'resourcebooking')\n\t\t{\n\t\t\tlet options = {\n\t\t\t\teditor: this._editor,\n\t\t\t\tschemeElement: null,\n\t\t\t\tmodel: parent.getModel(),\n\t\t\t\tmode: BX.UI.EntityEditorMode.edit,\n\t\t\t\tparent: parent,\n\t\t\t\ttypeId: typeId,\n\t\t\t\tfield: field,\n\t\t\t\tshowAlways: true,\n\t\t\t\tenableMandatoryControl: BX.prop.getBoolean(params, 'enableMandatoryControl', true),\n\t\t\t\tmandatoryConfigurator: params.mandatoryConfigurator\n\t\t\t};\n\n\t\t\tif (BX.Calendar && BX.type.isFunction(BX.Calendar.ResourcebookingUserfield))\n\t\t\t{\n\t\t\t\treturn BX.Calendar.ResourcebookingUserfield.getCrmFieldConfigurator('', options);\n\t\t\t}\n\t\t\telse if (BX.Calendar && BX.Calendar.UserField && BX.Calendar.UserField.EntityEditorUserFieldConfigurator)\n\t\t\t{\n\t\t\t\treturn BX.Calendar.UserField.EntityEditorUserFieldConfigurator.create('', options);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn BX.Crm.EntityEditorUserFieldConfigurator.create(\n\t\t\t\t'',\n\t\t\t\t{\n\t\t\t\t\teditor: this._editor,\n\t\t\t\t\tschemeElement: null,\n\t\t\t\t\tmodel: parent.getModel(),\n\t\t\t\t\tmode: BX.UI.EntityEditorMode.edit,\n\t\t\t\t\tparent: parent,\n\t\t\t\t\ttypeId: typeId,\n\t\t\t\t\tfield: field,\n\t\t\t\t\tmandatoryConfigurator: params.mandatoryConfigurator,\n\t\t\t\t\tvisibilityConfigurator: params.visibilityConfigurator,\n\t\t\t\t\tshowAlways: true\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t};\n\n\tgetTypeInfos()\n\t{\n\t\tlet typeInfos = super.getTypeInfos();\n\t\tlet ufAddRestriction = this._editor.getRestriction('userFieldAdd');\n\t\tlet ufResourceBookingRestriction = this._editor.getRestriction('userFieldResourceBooking');\n\n\t\tif (ufAddRestriction && !ufAddRestriction['isPermitted'] && ufAddRestriction['restrictionCallback'])\n\t\t{\n\t\t\tfor (let i = 0, length = typeInfos.length; i < length; i++)\n\t\t\t{\n\t\t\t\ttypeInfos[i].callback = function()\n\t\t\t\t{\n\t\t\t\t\teval(ufAddRestriction['restrictionCallback']);\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\t\telse if (\n\t\t\tufResourceBookingRestriction\n\t\t\t&& !ufResourceBookingRestriction['isPermitted']\n\t\t\t&& ufResourceBookingRestriction['restrictionCallback']\n\t\t)\n\t\t{\n\t\t\tfor (let j = 0; j < typeInfos.length; j++)\n\t\t\t{\n\t\t\t\tif (typeInfos[j].name === 'resourcebooking')\n\t\t\t\t{\n\t\t\t\t\ttypeInfos[j].callback = function()\n\t\t\t\t\t{\n\t\t\t\t\t\teval(ufResourceBookingRestriction['restrictionCallback']);\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn typeInfos;\n\t};\n\n\tstatic create(id, settings): EntityConfigurationManager\n\t{\n\t\tconst self = new this;\n\n\t\tself.initialize(id, settings);\n\n\t\treturn self;\n\t}\n}\n"],"names":["DEFAULT_COUNTRY_CODE","PhoneNumberInputFieldConfigurator","destroy","_wrapper","appendChild","getInputContainer","_typeId","layoutInnerConfigurator","_field","getInnerConfig","getItems","getOptionContainer","getCountrySelectContainer","Dom","append","Tag","render","getButtonContainer","event","params","arguments","items","getDialog","getSelectedItems","length","id","getSchemeElement","_options","wrapper","Loc","getMessage","selectContainer","defaultCountry","Type","isPlainObject","isStringFilled","TagSelector","textBoxWidth","tagMaxWidth","placeholder","multiple","dialogOptions","width","showAvatars","dropdownMode","preselectedItems","entities","events","popupContainer","getTarget","getPopup","getContentContainer","isDomNode","addClass","renderTo","settings","self","initialize","BX","UI","EntityEditorFieldConfigurator","EntityConfigurationManager","parent","typeId","child","prop","get","getType","setVisible","EntityUserFieldType","string","indexOf","getId","_fieldConfigurator","create","editor","_editor","schemeElement","model","_model","mode","EntityEditorMode","edit","field","mandatoryConfigurator","EntityEditorUserField","getFieldType","options","getModel","showAlways","enableMandatoryControl","getBoolean","Calendar","type","isFunction","ResourcebookingUserfield","getCrmFieldConfigurator","UserField","EntityEditorUserFieldConfigurator","Crm","visibilityConfigurator","typeInfos","ufAddRestriction","getRestriction","ufResourceBookingRestriction","i","callback","eval","j","name"],"mappings":"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"}