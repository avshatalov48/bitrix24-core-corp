{"version":3,"file":"script.js","sources":["script.es6.js"],"sourcesContent":["import {Reflection, Type, Event, Dom, Loc} from 'main.core';\nimport {MenuManager} from 'main.popup';\n\nconst namespace = Reflection.namespace('BX.Crm.Activity');\n\nclass CrmUpdateDynamicActivity\n{\n\tdocumentType: Array<string>;\n\tisRobot: boolean;\n\tentityTypeIdSelect: HTMLSelectElement;\n\tfieldsListSelect: HTMLSelectElement;\n\tentitiesFieldsContainers: HTMLDivElement | HTMLTableElement;\n\n\tcurrentEntityTypeId: number;\n\tfieldsMap: Map<string, object>;\n\tcurrentValues: Map<string, object>;\n\n\tconstructor(options)\n\t{\n\t\tif (Type.isPlainObject(options))\n\t\t{\n\t\t\tthis.documentType = options.documentType;\n\t\t\tthis.isRobot = options.isRobot;\n\t\t\tconst form = document.forms[options.formName];\n\n\t\t\tif (!Type.isNil(form))\n\t\t\t{\n\t\t\t\tthis.entityTypeIdSelect = form.dynamic_type_id;\n\t\t\t\tthis.currentEntityTypeId = this.entityTypeIdSelect.value;\n\t\t\t}\n\n\t\t\tif (this.isRobot)\n\t\t\t{\n\t\t\t\tthis.fieldsListSelect = document.querySelector('[data-role=\"bca-cuda-fields-list\"]');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.addConditionButton = document.querySelector('[data-role=\"bca_cuda_add_condition\"]');\n\t\t\t}\n\t\t\tthis.entitiesFieldsContainers = document.querySelector('[data-role=\"bca-cuda-fields-container\"]');\n\t\t\tthis.conditinIdPrefix = 'id_bca_cuda_field_';\n\n\t\t\tthis.fieldsMap = new Map(Object.entries(options.fieldsMap));\n\n\t\t\tthis.currentValues = new Map();\n\t\t\tArray\n\t\t\t\t.from(this.fieldsMap.keys())\n\t\t\t\t.forEach((entityTypeId) => this.currentValues.set(entityTypeId, {}));\n\n\t\t\tif (!Type.isNil(this.currentEntityTypeId) && Type.isObject(options.currentValues))\n\t\t\t{\n\t\t\t\tthis.currentValues.set(this.currentEntityTypeId, options.currentValues);\n\t\t\t\tthis.renderEntityFields();\n\t\t\t}\n\t\t}\n\t}\n\n\tinit(): void\n\t{\n\t\tif (\n\t\t\tthis.entityTypeIdSelect\n\t\t\t&& this.fieldsMap\n\t\t\t&& this.entitiesFieldsContainers\n\t\t)\n\t\t{\n\t\t\tEvent.bind(this.entityTypeIdSelect, 'change', this.onEntityTypeIdChange.bind(this));\n\t\t}\n\n\t\tif (this.isRobot && this.fieldsListSelect)\n\t\t{\n\t\t\tEvent.bind(this.fieldsListSelect, 'click', this.onFieldsListSelectClick.bind(this));\n\t\t}\n\t\telse if (!this.isRobot && this.addConditionButton)\n\t\t{\n\t\t\tEvent.bind(this.addConditionButton, 'click', this.onAddConditionButtonClick.bind(this));\n\t\t}\n\t}\n\n\tonEntityTypeIdChange(): void\n\t{\n\t\tthis.currentEntityTypeId = this.entityTypeIdSelect.value;\n\t\tArray\n\t\t\t.from(this.entitiesFieldsContainers.children)\n\t\t\t.forEach((elem) => Dom.remove(elem));\n\t\tthis.renderEntityFields();\n\t}\n\n\trenderEntityFields(): void\n\t{\n\t\tif (!Type.isNil(this.currentEntityTypeId) && this.currentEntityTypeId !== '')\n\t\t{\n\t\t\tObject\n\t\t\t\t.keys(this.currentValues.get(this.currentEntityTypeId))\n\t\t\t\t.forEach((fieldId) => this.addCondition(fieldId));\n\t\t}\n\t}\n\n\tonFieldsListSelectClick(event)\n\t{\n\t\tconst fields = this.fieldsMap.get(this.currentEntityTypeId);\n\t\tif (Type.isNil(fields))\n\t\t{\n\t\t\treturn event.preventDefault();\n\t\t}\n\n\t\tconst activity = this;\n\t\tconst menuItems = Object.entries(fields).map(([fieldId, field]) => ({\n\t\t\tfieldId,\n\t\t\ttext: field.Name,\n\t\t\tonclick(_, item)\n\t\t\t{\n\t\t\t\tthis.popupWindow.close();\n\t\t\t\tactivity.addCondition(item.fieldId);\n\t\t\t},\n\t\t}));\n\n\t\tconst menuManagerOptions = {\n\t\t\tid: Math.random().toString(),\n\t\t\tbindElement: this.fieldsListSelect,\n\t\t\titems: Array.from(menuItems),\n\t\t\tautoHide: true,\n\t\t\toffsetLeft: Dom.getPosition(this.fieldsListSelect).width / 2,\n\t\t\tangle: {\n\t\t\t\tposition: 'top',\n\t\t\t\toffset: 0,\n\t\t\t},\n\t\t\tzIndex: 200,\n\t\t\tclassName: 'bizproc-automation-inline-selector-menu',\n\t\t\tevents: {\n\t\t\t\tonPopupClose()\n\t\t\t\t{\n\t\t\t\t\tthis.destroy();\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\t\tMenuManager.show(menuManagerOptions);\n\n\t\treturn event.preventDefault();\n\t}\n\n\tonAddConditionButtonClick(): void\n\t{\n\t\tconst defaultFieldId = Object.keys(this.fieldsMap.get(this.currentEntityTypeId))[0];\n\t\tthis.addCondition(defaultFieldId);\n\t}\n\n\taddCondition(fieldId: string): void\n\t{\n\t\tif (this.isRobot)\n\t\t{\n\t\t\tthis.addRobotCondition(fieldId);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.addBizprocCondition(fieldId);\n\t\t}\n\t}\n\n\taddRobotCondition(fieldId: string): void\n\t{\n\t\tconst conditionId = this.conditinIdPrefix + fieldId;\n\n\t\tconst titleNode = Dom.create('span', {\n\t\t\tattrs: {\n\t\t\t\tclassName: 'bizproc-automation-popup-settings-title bizproc-automation-popup-settings-title-autocomplete',\n\t\t\t},\n\t\t\ttext: this.fieldsMap.get(this.currentEntityTypeId)[fieldId].Name,\n\t\t});\n\n\t\tconst deleteButton = Dom.create('a', {\n\t\t\tattrs: {\n\t\t\t\tclassName: 'bizproc-automation-popup-settings-delete bizproc-automation-popup-settings-link bizproc-automation-popup-settings-link-light',\n\t\t\t},\n\t\t\tprops: {href: '#'},\n\t\t\ttext: Loc.getMessage('CRM_UDA_DELETE_CONDITION'),\n\t\t\tevents: {\n\t\t\t\t// eslint-disable-next-line func-names\n\t\t\t\tclick: function(event) {\n\t\t\t\t\tthis.deleteCondition(fieldId);\n\t\t\t\t\treturn event.preventDefault();\n\t\t\t\t}.bind(this),\n\t\t\t},\n\t\t});\n\n\t\tconst fieldNode = Dom.create('div', {\n\t\t\tattrs: {\n\t\t\t\tclassName: 'bizproc-automation-popup-settings',\n\t\t\t},\n\t\t\tprops: {id: conditionId},\n\t\t\tchildren: [\n\t\t\t\ttitleNode,\n\t\t\t\tthis.renderField(fieldId),\n\t\t\t\tdeleteButton,\n\t\t\t],\n\t\t});\n\n\t\tthis.entitiesFieldsContainers.appendChild(fieldNode);\n\t}\n\n\tdeleteCondition(fieldId: string): void\n\t{\n\t\tconst conditionId = this.conditinIdPrefix + fieldId;\n\t\tDom.remove(document.getElementById(conditionId));\n\t}\n\n\taddBizprocCondition(fieldId: string): void\n\t{\n\t\tconst newConditionRow = this.entitiesFieldsContainers.insertRow(-1);\n\t\tnewConditionRow.id = this.conditinIdPrefix + Math.random().toString().substr(1, 5);\n\n\t\tconst activity = this;\n\n\t\tconst entityFieldSelect = Dom.create('select', {\n\t\t\tchildren: this.getCurrentFieldsOptions(fieldId),\n\t\t\tevents: {\n\t\t\t\tchange(event) {\n\t\t\t\t\tconst fieldValueNode = newConditionRow.children[2];\n\t\t\t\t\tconst newFieldId = event.srcElement.value;\n\t\t\t\t\tnewConditionRow.replaceChild(activity.renderField(newFieldId), fieldValueNode);\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\n\t\tconst equalSignNode = Dom.create('span', {text: '='});\n\n\t\tconst entityFieldValueNode = this.renderField(fieldId);\n\n\t\tconst deleteConditionButton = Dom.create('a', {\n\t\t\tprops: {href: '#'},\n\t\t\ttext: Loc.getMessage('CRM_UDA_DELETE_CONDITION'),\n\t\t\tevents: {\n\t\t\t\tclick(event) {\n\t\t\t\t\tDom.remove(document.getElementById(newConditionRow.id));\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\n\t\t[entityFieldSelect, equalSignNode, entityFieldValueNode, deleteConditionButton].forEach(\n\t\t\t(node) => {\n\t\t\t\tnewConditionRow.insertCell(-1).appendChild(node);\n\t\t\t},\n\t\t);\n\t}\n\n\tgetCurrentFieldsOptions(selectedFieldId)\n\t{\n\t\treturn Object\n\t\t\t.entries(this.fieldsMap.get(this.currentEntityTypeId))\n\t\t\t.map(\n\t\t\t\t([fieldId, field]) => {\n\t\t\t\t\treturn Dom.create('option', {\n\t\t\t\t\t\tprops: {value: field.FieldName},\n\t\t\t\t\t\tattrs: selectedFieldId === fieldId ? {selected: 'selected'} : undefined,\n\t\t\t\t\t\ttext: field.Name,\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t);\n\t}\n\n\trenderField(fieldId: string): HTMLElement\n\t{\n\t\tlet value = this.currentValues.get(this.currentEntityTypeId)[fieldId];\n\t\tif (Type.isNil(value))\n\t\t{\n\t\t\tvalue = '';\n\t\t}\n\n\t\treturn BX.Bizproc.FieldType.renderControl(\n\t\t\tthis.documentType,\n\t\t\tthis.fieldsMap.get(this.currentEntityTypeId)[fieldId],\n\t\t\tfieldId,\n\t\t\tvalue,\n\t\t);\n\t}\n}\n\nnamespace.CrmUpdateDynamicActivity = CrmUpdateDynamicActivity;"],"names":["namespace","Reflection","CrmUpdateDynamicActivity","options","Type","isPlainObject","documentType","isRobot","form","document","forms","formName","isNil","entityTypeIdSelect","dynamic_type_id","currentEntityTypeId","value","fieldsListSelect","querySelector","addConditionButton","entitiesFieldsContainers","conditinIdPrefix","fieldsMap","Map","Object","entries","currentValues","Array","from","keys","forEach","entityTypeId","set","isObject","renderEntityFields","Event","bind","onEntityTypeIdChange","onFieldsListSelectClick","onAddConditionButtonClick","children","elem","Dom","remove","get","fieldId","addCondition","event","fields","preventDefault","activity","menuItems","map","field","text","Name","onclick","_","item","popupWindow","close","menuManagerOptions","id","Math","random","toString","bindElement","items","autoHide","offsetLeft","getPosition","width","angle","position","offset","zIndex","className","events","onPopupClose","destroy","MenuManager","show","defaultFieldId","addRobotCondition","addBizprocCondition","conditionId","titleNode","create","attrs","deleteButton","props","href","Loc","getMessage","click","deleteCondition","fieldNode","renderField","appendChild","getElementById","newConditionRow","insertRow","substr","entityFieldSelect","getCurrentFieldsOptions","change","fieldValueNode","newFieldId","srcElement","replaceChild","equalSignNode","entityFieldValueNode","deleteConditionButton","node","insertCell","selectedFieldId","FieldName","selected","undefined","BX","Bizproc","FieldType","renderControl"],"mappings":"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"}