{"version":3,"file":"script.js","sources":["script.es6.js"],"sourcesContent":["import {Reflection, Type, Event, Dom, Loc} from 'main.core';\nimport {MenuManager} from 'main.popup';\nimport {\n\tContext,\n\tConditionGroup,\n\tConditionGroupSelector,\n\tDocument,\n\tgetGlobalContext,\n\tsetGlobalContext,\n\tDesigner,\n\tInlineSelector,\n} from 'bizproc.automation';\n\nconst namespace = Reflection.namespace('BX.Crm.Activity');\n\nclass CrmUpdateDynamicActivity\n{\n\tdocumentType: Array<string>;\n\tdocument: Document;\n\tisRobot: boolean;\n\tentityTypeIdSelect: HTMLSelectElement;\n\tfieldsListSelect: HTMLSelectElement;\n\tentitiesFieldsContainers: HTMLDivElement | HTMLTableElement;\n\n\tfilterFieldsContainer: HTMLDivElement | null;\n\tfilteringFieldsPrefix: string;\n\tfilterFieldsMap: Map<string, object>;\n\tconditionGroup: ConditionGroup | undefined;\n\n\tcurrentEntityTypeId: number;\n\tfieldsMap: Map<string, object>;\n\tcurrentValues: Map<string, object>;\n\n\tonOpenFilterFieldsMenu: ?Function;\n\n\tconstructor(options)\n\t{\n\t\tif (Type.isPlainObject(options))\n\t\t{\n\t\t\tthis.documentType = options.documentType;\n\t\t\tthis.isRobot = options.isRobot;\n\t\t\tconst form = document.forms[options.formName];\n\n\t\t\tif (!Type.isNil(form))\n\t\t\t{\n\t\t\t\tthis.entityTypeIdSelect = form.dynamic_type_id;\n\t\t\t\tthis.currentEntityTypeId = this.entityTypeIdSelect.value;\n\t\t\t\tthis.entityTypeDependentElements = document.querySelectorAll(\n\t\t\t\t\t'[data-role=\"bca-cuda-entity-type-id-dependent\"]',\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tthis.document = new Document({\n\t\t\t\trawDocumentType: this.documentType,\n\t\t\t\tdocumentFields: options.documentFields,\n\t\t\t\ttitle: options.documentName,\n\t\t\t});\n\t\t\tif (this.isRobot)\n\t\t\t{\n\t\t\t\tthis.fieldsListSelect = document.querySelector('[data-role=\"bca-cuda-fields-list\"]');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.addConditionButton = document.querySelector('[data-role=\"bca_cuda_add_condition\"]');\n\t\t\t}\n\t\t\tthis.entitiesFieldsContainers = document.querySelector('[data-role=\"bca-cuda-fields-container\"]');\n\t\t\tthis.conditinIdPrefix = 'id_bca_cuda_field_';\n\n\t\t\tthis.fieldsMap = new Map(Object.entries(options.fieldsMap));\n\n\t\t\tthis.filterFieldsContainer = document.querySelector('[data-role=\"bca-cuda-filter-fields-container\"]');\n\t\t\tthis.filteringFieldsPrefix = options.filteringFieldsPrefix;\n\t\t\tthis.filterFieldsMap = new Map(Object.entries(options.filterFieldsMap));\n\n\t\t\t// issue 0158608\n\t\t\tif (!Type.isNil(options.documentType) && !this.isRobot)\n\t\t\t{\n\t\t\t\tBX.Bizproc.Automation.API.documentType = options.documentType;\n\t\t\t}\n\t\t\tthis.conditionGroup = new ConditionGroup(options.conditions);\n\n\t\t\tthis.currentValues = new Map();\n\t\t\tArray\n\t\t\t\t.from(this.fieldsMap.keys())\n\t\t\t\t.forEach((entityTypeId) => this.currentValues.set(entityTypeId, {}));\n\n\t\t\tif (!Type.isNil(this.currentEntityTypeId) && Type.isObject(options.currentValues))\n\t\t\t{\n\t\t\t\tthis.currentValues.set(this.currentEntityTypeId, options.currentValues);\n\t\t\t}\n\t\t}\n\t}\n\n\tinit(): void\n\t{\n\t\tif (\n\t\t\tthis.entityTypeIdSelect\n\t\t\t&& this.fieldsMap\n\t\t\t&& this.entitiesFieldsContainers\n\t\t)\n\t\t{\n\t\t\tEvent.bind(this.entityTypeIdSelect, 'change', this.onEntityTypeIdChange.bind(this));\n\t\t}\n\n\t\tif (this.isRobot && this.fieldsListSelect)\n\t\t{\n\t\t\tEvent.bind(this.fieldsListSelect, 'click', this.onFieldsListSelectClick.bind(this));\n\t\t}\n\t\telse if (!this.isRobot && this.addConditionButton)\n\t\t{\n\t\t\tEvent.bind(this.addConditionButton, 'click', this.onAddConditionButtonClick.bind(this));\n\t\t}\n\n\t\tthis.initAutomationContext();\n\t}\n\n\tinitAutomationContext()\n\t{\n\t\ttry\n\t\t{\n\t\t\tgetGlobalContext();\n\t\t\tif (this.isRobot)\n\t\t\t{\n\t\t\t\tthis.onOpenFilterFieldsMenu = (event) => {\n\t\t\t\t\tconst dialog = Designer.getInstance().getRobotSettingsDialog();\n\t\t\t\t\tconst template = dialog.template;\n\t\t\t\t\tconst robot = dialog.robot;\n\t\t\t\t\tif (template && robot)\n\t\t\t\t\t{\n\t\t\t\t\t\ttemplate.onOpenMenu(event, robot);\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\t\tcatch(error)\n\t\t{\n\t\t\tsetGlobalContext(new Context({document: this.document}));\n\t\t\tthis.onOpenFilterFieldsMenu = (event) => this.addBPFields(event.getData().selector);\n\t\t}\n\t}\n\n\taddBPFields(selector: InlineSelector): void\n\t{\n\t\tconst getSelectorProperties = ({properties, objectName, expressionPrefix}) => {\n\t\t\tif (Type.isObject(properties))\n\t\t\t{\n\t\t\t\treturn Object.entries(properties).map(([id, property]) => ({\n\t\t\t\t\tid,\n\t\t\t\t\ttitle: property.Name,\n\t\t\t\t\tcustomData: {\n\t\t\t\t\t\tfield: {\n\t\t\t\t\t\t\tId: id,\n\t\t\t\t\t\t\tType: property.Type,\n\t\t\t\t\t\t\tName: property.Name,\n\t\t\t\t\t\t\tObjectName: objectName,\n\t\t\t\t\t\t\tSystemExpression: `{=${objectName}:${id}}`,\n\t\t\t\t\t\t\tExpression: expressionPrefix ? `{{${expressionPrefix}:${id}}}` : `{=${objectName}:${id}}`,\n\t\t\t\t\t\t},\n\t\t\t\t\t}\n\t\t\t\t}));\n\t\t\t}\n\n\t\t\treturn [];\n\t\t}\n\t\tconst getGlobalSelectorProperties = ({properties, visibilityNames, objectName}) => {\n\t\t\tif (Type.isObject(properties))\n\t\t\t{\n\t\t\t\treturn Object.entries(properties).map(([id, property]) => {\n\t\t\t\t\tconst field = {\n\t\t\t\t\t\tid,\n\t\t\t\t\t\tType: property.Type,\n\t\t\t\t\t\ttitle: property.Name,\n\t\t\t\t\t\tObjectName: objectName,\n\t\t\t\t\t\tSystemExpression: `{=${objectName}:${id}}`,\n\t\t\t\t\t\tExpression: `{=${objectName}:${id}}`,\n\t\t\t\t\t}\n\n\t\t\t\t\tif (property.Visibility && visibilityNames[property.Visibility])\n\t\t\t\t\t{\n\t\t\t\t\t\tfield.Expression = `{{${visibilityNames[property.Visibility]}:${property.Name}}}`;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn {\n\t\t\t\t\t\tid,\n\t\t\t\t\t\ttitle: property.Name,\n\t\t\t\t\t\tsupertitle: visibilityNames[property.Visibility],\n\t\t\t\t\t\tcustomData: { field },\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t}\n\n\t\t\treturn [];\n\t\t}\n\n\t\tselector.addGroup('workflowParameters', {\n\t\t\tid: 'workflowParameters',\n\t\t\ttitle: Loc.getMessage('BIZPROC_WFEDIT_MENU_PARAMS'),\n\t\t\tchildren: [\n\t\t\t\t{\n\t\t\t\t\tid: 'parameters',\n\t\t\t\t\ttitle: Loc.getMessage('BIZPROC_AUTOMATION_CMP_PARAMETERS_LIST'),\n\t\t\t\t\tchildren: getSelectorProperties({\n\t\t\t\t\t\tproperties: window.arWorkflowParameters || {},\n\t\t\t\t\t\tobjectName: 'Template',\n\t\t\t\t\t\texpressionPrefix: '~*',\n\t\t\t\t\t}),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: 'variables',\n\t\t\t\t\ttitle: Loc.getMessage('BIZPROC_AUTOMATION_CMP_GLOB_VARIABLES_LIST_1'),\n\t\t\t\t\tchildren: getSelectorProperties({\n\t\t\t\t\t\tproperties: window.arWorkflowVariables || {},\n\t\t\t\t\t\tobjectName: 'Variable',\n\t\t\t\t\t}),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: 'constants',\n\t\t\t\t\ttitle: Loc.getMessage('BIZPROC_AUTOMATION_CMP_CONSTANTS_LIST'),\n\t\t\t\t\tchildren: getSelectorProperties({\n\t\t\t\t\t\tproperties: window.arWorkflowConstants || {},\n\t\t\t\t\t\tobjectName: 'Constant',\n\t\t\t\t\t\texpressionPrefix: '~&',\n\t\t\t\t\t}),\n\t\t\t\t},\n\t\t\t],\n\t\t});\n\t\tif (window.arWorkflowGlobalVariables && window.wfGVarVisibilityNames)\n\t\t{\n\t\t\tselector.addGroup('globalVariables', {\n\t\t\t\tid: 'globalVariables',\n\t\t\t\ttitle: Loc.getMessage('BIZPROC_AUTOMATION_CMP_GLOB_VARIABLES_LIST'),\n\t\t\t\tchildren: getGlobalSelectorProperties({\n\t\t\t\t\tproperties: window.arWorkflowGlobalVariables || {},\n\t\t\t\t\tvisibilityNames: window.wfGVarVisibilityNames || {},\n\t\t\t\t\tobjectName: 'GlobalVar',\n\t\t\t\t}),\n\t\t\t});\n\t\t}\n\t\tselector.addGroup('globalConstants', {\n\t\t\tid: 'globalConstants',\n\t\t\ttitle: Loc.getMessage('BIZPROC_AUTOMATION_CMP_GLOB_CONSTANTS_LIST'),\n\t\t\tchildren: getGlobalSelectorProperties({\n\t\t\t\tproperties: window.arWorkflowGlobalConstants || {},\n\t\t\t\tvisibilityNames: window.wfGConstVisibilityNames || {},\n\t\t\t\tobjectName: 'GlobalConst',\n\t\t\t}),\n\t\t});\n\t}\n\n\tonEntityTypeIdChange(): void\n\t{\n\t\tthis.currentEntityTypeId = this.entityTypeIdSelect.value;\n\n\t\tDom.clean(this.filterFieldsContainer);\n\t\tthis.conditionGroup = new ConditionGroup();\n\n\t\tArray\n\t\t\t.from(this.entitiesFieldsContainers.children)\n\t\t\t.forEach((elem) => Dom.remove(elem));\n\n\t\tthis.render();\n\t}\n\n\trender(): void\n\t{\n\t\tif (Type.isNil(this.currentEntityTypeId) || this.currentEntityTypeId === '')\n\t\t{\n\t\t\tthis.entityTypeDependentElements.forEach((element) => Dom.hide(element));\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.entityTypeDependentElements.forEach((element) => Dom.show(element));\n\t\t\tthis.renderFilterFields();\n\t\t\tthis.renderEntityFields();\n\t\t}\n\t}\n\n\trenderFilterFields(): void\n\t{\n\t\tif (\n\t\t\t!Type.isNil(this.conditionGroup)\n\t\t\t&& !Type.isNil(this.currentEntityTypeId)\n\t\t)\n\t\t{\n\t\t\tconst selector = new ConditionGroupSelector(this.conditionGroup, {\n\t\t\t\tfields: Object.values(this.filterFieldsMap.get(this.currentEntityTypeId)),\n\t\t\t\tfieldPrefix: this.filteringFieldsPrefix,\n\t\t\t\tonOpenMenu: this.onOpenFilterFieldsMenu,\n\t\t\t\tcaption: {\n\t\t\t\t\thead: Loc.getMessage('CRM_UDA_FILTERING_FIELDS_PROPERTY'),\n\t\t\t\t\tcollapsed: Loc.getMessage('CRM_UDA_FILTERING_FIELDS_COLLAPSED_TEXT'),\n\t\t\t\t},\n\t\t\t});\n\n\t\t\t// todo: remove 2024 with this.filterFieldsContainer.parentNode.firstElementChild\n\t\t\tif (selector.modern && this.filterFieldsContainer && this.filterFieldsContainer.parentNode)\n\t\t\t{\n\t\t\t\tconst element = (\n\t\t\t\t\tthis.filterFieldsContainer.parentNode.firstElementChild === this.filterFieldsContainer\n\t\t\t\t\t\t? this.filterFieldsContainer.parentNode.parentNode.firstElementChild\n\t\t\t\t\t\t: this.filterFieldsContainer.parentNode.firstElementChild\n\t\t\t\t);\n\n\t\t\t\tDom.clean(element);\n\t\t\t}\n\n\t\t\tDom.append(selector.createNode(), this.filterFieldsContainer);\n\t\t}\n\t}\n\n\trenderEntityFields(): void\n\t{\n\t\tObject\n\t\t\t.keys(this.currentValues.get(this.currentEntityTypeId))\n\t\t\t.forEach((fieldId) => this.addCondition(fieldId));\n\t}\n\n\tonFieldsListSelectClick(event)\n\t{\n\t\tconst fields = this.fieldsMap.get(this.currentEntityTypeId);\n\t\tif (Type.isNil(fields))\n\t\t{\n\t\t\treturn event.preventDefault();\n\t\t}\n\n\t\tconst activity = this;\n\t\tconst menuItems = Object.entries(fields).map(([fieldId, field]) => ({\n\t\t\tfieldId,\n\t\t\ttext: field.Name,\n\t\t\tonclick(_, item)\n\t\t\t{\n\t\t\t\tthis.popupWindow.close();\n\t\t\t\tactivity.addCondition(item.fieldId);\n\t\t\t},\n\t\t}));\n\n\t\tconst menuManagerOptions = {\n\t\t\tid: Math.random().toString(),\n\t\t\tbindElement: this.fieldsListSelect,\n\t\t\titems: Array.from(menuItems),\n\t\t\tautoHide: true,\n\t\t\toffsetLeft: Dom.getPosition(this.fieldsListSelect).width / 2,\n\t\t\tangle: {\n\t\t\t\tposition: 'top',\n\t\t\t\toffset: 0,\n\t\t\t},\n\t\t\tzIndex: 200,\n\t\t\tclassName: 'bizproc-automation-inline-selector-menu',\n\t\t\tevents: {\n\t\t\t\tonPopupClose()\n\t\t\t\t{\n\t\t\t\t\tthis.destroy();\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\t\tMenuManager.show(menuManagerOptions);\n\n\t\treturn event.preventDefault();\n\t}\n\n\tonAddConditionButtonClick(event): void\n\t{\n\t\tconst defaultFieldId = Object.keys(this.fieldsMap.get(this.currentEntityTypeId))[0];\n\t\tthis.addCondition(defaultFieldId);\n\n\t\treturn event.preventDefault();\n\t}\n\n\taddCondition(fieldId: string): void\n\t{\n\t\tif (this.isRobot)\n\t\t{\n\t\t\tthis.addRobotCondition(fieldId);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.addBizprocCondition(fieldId);\n\t\t}\n\t}\n\n\taddRobotCondition(fieldId: string): void\n\t{\n\t\tconst conditionId = this.conditinIdPrefix + fieldId;\n\n\t\tconst titleNode = Dom.create('span', {\n\t\t\tattrs: {\n\t\t\t\tclassName: 'bizproc-automation-popup-settings-title bizproc-automation-popup-settings-title-autocomplete',\n\t\t\t},\n\t\t\ttext: this.fieldsMap.get(this.currentEntityTypeId)[fieldId].Name,\n\t\t});\n\n\t\tconst deleteButton = Dom.create('a', {\n\t\t\tattrs: {\n\t\t\t\tclassName: 'bizproc-automation-popup-settings-delete bizproc-automation-popup-settings-link bizproc-automation-popup-settings-link-light',\n\t\t\t},\n\t\t\tprops: {href: '#'},\n\t\t\ttext: Loc.getMessage('CRM_UDA_DELETE_CONDITION'),\n\t\t\tevents: {\n\t\t\t\t// eslint-disable-next-line func-names\n\t\t\t\tclick: function(event) {\n\t\t\t\t\tthis.deleteCondition(fieldId);\n\t\t\t\t\treturn event.preventDefault();\n\t\t\t\t}.bind(this),\n\t\t\t},\n\t\t});\n\n\t\tconst fieldNode = Dom.create('div', {\n\t\t\tattrs: {\n\t\t\t\tclassName: 'bizproc-automation-popup-settings',\n\t\t\t},\n\t\t\tprops: {id: conditionId},\n\t\t\tchildren: [\n\t\t\t\ttitleNode,\n\t\t\t\tthis.renderField(fieldId),\n\t\t\t\tdeleteButton,\n\t\t\t],\n\t\t});\n\n\t\tthis.entitiesFieldsContainers.appendChild(fieldNode);\n\t}\n\n\tdeleteCondition(fieldId: string): void\n\t{\n\t\tconst conditionId = this.conditinIdPrefix + fieldId;\n\t\tDom.remove(document.getElementById(conditionId));\n\t}\n\n\taddBizprocCondition(fieldId: string): void\n\t{\n\t\tconst newConditionRow = this.entitiesFieldsContainers.insertRow(-1);\n\t\tnewConditionRow.id = this.conditinIdPrefix + Math.random().toString().substr(1, 5);\n\n\t\tconst activity = this;\n\n\t\tconst entityFieldSelect = Dom.create('select', {\n\t\t\tchildren: this.getCurrentFieldsOptions(fieldId),\n\t\t\tevents: {\n\t\t\t\tchange(event) {\n\t\t\t\t\tconst fieldValueNode = newConditionRow.children[2];\n\t\t\t\t\tconst newFieldId = event.srcElement.value;\n\t\t\t\t\tnewConditionRow.replaceChild(activity.renderField(newFieldId), fieldValueNode);\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\n\t\tconst equalSignNode = Dom.create('span', {text: '='});\n\n\t\tconst entityFieldValueNode = this.renderField(fieldId);\n\n\t\tconst deleteConditionButton = Dom.create('a', {\n\t\t\tprops: {href: '#'},\n\t\t\ttext: Loc.getMessage('CRM_UDA_DELETE_CONDITION'),\n\t\t\tevents: {\n\t\t\t\tclick(event) {\n\t\t\t\t\tDom.remove(document.getElementById(newConditionRow.id));\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\n\t\t[entityFieldSelect, equalSignNode, entityFieldValueNode, deleteConditionButton].forEach(\n\t\t\t(node) => {\n\t\t\t\tnewConditionRow.insertCell(-1).appendChild(node);\n\t\t\t},\n\t\t);\n\t}\n\n\tgetCurrentFieldsOptions(selectedFieldId)\n\t{\n\t\treturn Object\n\t\t\t.entries(this.fieldsMap.get(this.currentEntityTypeId))\n\t\t\t.map(\n\t\t\t\t([fieldId, field]) => {\n\t\t\t\t\treturn Dom.create('option', {\n\t\t\t\t\t\tprops: {value: field.FieldName},\n\t\t\t\t\t\tattrs: selectedFieldId === fieldId ? {selected: 'selected'} : undefined,\n\t\t\t\t\t\ttext: field.Name,\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t);\n\t}\n\n\trenderField(fieldId: string): HTMLElement\n\t{\n\t\tlet value = this.currentValues.get(this.currentEntityTypeId)[fieldId];\n\t\tif (Type.isNil(value))\n\t\t{\n\t\t\tvalue = '';\n\t\t}\n\n\t\treturn BX.Bizproc.FieldType.renderControl(\n\t\t\tthis.documentType,\n\t\t\tthis.fieldsMap.get(this.currentEntityTypeId)[fieldId],\n\t\t\tfieldId,\n\t\t\tvalue,\n\t\t\tthis.isRobot ? 'public' : 'designer',\n\t\t);\n\t}\n}\n\nnamespace.CrmUpdateDynamicActivity = CrmUpdateDynamicActivity;\n"],"names":["namespace","Reflection","CrmUpdateDynamicActivity","options","Type","isPlainObject","documentType","isRobot","form","document","forms","formName","isNil","entityTypeIdSelect","dynamic_type_id","currentEntityTypeId","value","entityTypeDependentElements","querySelectorAll","Document","rawDocumentType","documentFields","title","documentName","fieldsListSelect","querySelector","addConditionButton","entitiesFieldsContainers","conditinIdPrefix","fieldsMap","Map","Object","entries","filterFieldsContainer","filteringFieldsPrefix","filterFieldsMap","BX","Bizproc","Automation","API","conditionGroup","ConditionGroup","conditions","currentValues","Array","from","keys","forEach","entityTypeId","set","isObject","Event","bind","onEntityTypeIdChange","onFieldsListSelectClick","onAddConditionButtonClick","initAutomationContext","getGlobalContext","onOpenFilterFieldsMenu","event","dialog","Designer","getInstance","getRobotSettingsDialog","template","robot","onOpenMenu","error","setGlobalContext","Context","addBPFields","getData","selector","getSelectorProperties","properties","objectName","expressionPrefix","map","id","property","Name","customData","field","Id","ObjectName","SystemExpression","Expression","getGlobalSelectorProperties","visibilityNames","Visibility","supertitle","addGroup","Loc","getMessage","children","window","arWorkflowParameters","arWorkflowVariables","arWorkflowConstants","arWorkflowGlobalVariables","wfGVarVisibilityNames","arWorkflowGlobalConstants","wfGConstVisibilityNames","Dom","clean","elem","remove","render","element","hide","show","renderFilterFields","renderEntityFields","ConditionGroupSelector","fields","values","get","fieldPrefix","caption","head","collapsed","modern","parentNode","firstElementChild","append","createNode","fieldId","addCondition","preventDefault","activity","menuItems","text","onclick","_","item","popupWindow","close","menuManagerOptions","Math","random","toString","bindElement","items","autoHide","offsetLeft","getPosition","width","angle","position","offset","zIndex","className","events","onPopupClose","destroy","MenuManager","defaultFieldId","addRobotCondition","addBizprocCondition","conditionId","titleNode","create","attrs","deleteButton","props","href","click","deleteCondition","fieldNode","renderField","appendChild","getElementById","newConditionRow","insertRow","substr","entityFieldSelect","getCurrentFieldsOptions","change","fieldValueNode","newFieldId","srcElement","replaceChild","equalSignNode","entityFieldValueNode","deleteConditionButton","node","insertCell","selectedFieldId","FieldName","selected","undefined","FieldType","renderControl"],"mappings":"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"}