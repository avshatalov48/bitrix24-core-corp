(function(e,t,n,r,i){"use strict";var a=function e(t){var n=Number(t.version.split(".")[0]);if(n>=2){t.mixin({beforeCreate:i})}else{var r=t.prototype._init;t.prototype._init=function(e){if(e===void 0)e={};e.init=e.init?[i].concat(e.init):i;r.call(this,e)}}function i(){var e=this.$options;if(e.store){this.$store=typeof e.store==="function"?e.store():e.store}else if(e.parent&&e.parent.$store){this.$store=e.parent.$store}}};var o=typeof window!=="undefined"&&window.__VUE_DEVTOOLS_GLOBAL_HOOK__;function s(e){if(!o){return}e._devtoolHook=o;o.emit("vuex:init",e);o.on("vuex:travel-to-state",function(t){e.replaceState(t)});e.subscribe(function(e,t){o.emit("vuex:mutation",e,t)})}function u(e,t){Object.keys(e).forEach(function(n){return t(e[n],n)})}function c(e){return e!==null&&babelHelpers.typeof(e)==="object"}function l(e){return e&&typeof e.then==="function"}function f(e,t){if(!e){throw new Error("[vuex] "+t)}}var d=function e(t,n){this.runtime=n;this._children=Object.create(null);this._rawModule=t;var r=t.state;this.state=(typeof r==="function"?r():r)||{}};var h={namespaced:{configurable:true}};h.namespaced.get=function(){return!!this._rawModule.namespaced};d.prototype.addChild=function e(t,n){this._children[t]=n};d.prototype.removeChild=function e(t){delete this._children[t]};d.prototype.getChild=function e(t){return this._children[t]};d.prototype.update=function e(t){this._rawModule.namespaced=t.namespaced;if(t.actions){this._rawModule.actions=t.actions}if(t.mutations){this._rawModule.mutations=t.mutations}if(t.getters){this._rawModule.getters=t.getters}};d.prototype.forEachChild=function e(t){u(this._children,t)};d.prototype.forEachGetter=function e(t){if(this._rawModule.getters){u(this._rawModule.getters,t)}};d.prototype.forEachAction=function e(t){if(this._rawModule.actions){u(this._rawModule.actions,t)}};d.prototype.forEachMutation=function e(t){if(this._rawModule.mutations){u(this._rawModule.mutations,t)}};Object.defineProperties(d.prototype,h);var p=function e(t){this.register([],t,false)};p.prototype.get=function e(t){return t.reduce(function(e,t){return e.getChild(t)},this.root)};p.prototype.getNamespace=function e(t){var n=this.root;return t.reduce(function(e,t){n=n.getChild(t);return e+(n.namespaced?t+"/":"")},"")};p.prototype.update=function e(t){v([],this.root,t)};p.prototype.register=function e(t,n,r){var i=this;if(r===void 0)r=true;{b(t,n)}var a=new d(n,r);if(t.length===0){this.root=a}else{var o=this.get(t.slice(0,-1));o.addChild(t[t.length-1],a)}if(n.modules){u(n.modules,function(e,n){i.register(t.concat(n),e,r)})}};p.prototype.unregister=function e(t){var n=this.get(t.slice(0,-1));var r=t[t.length-1];if(!n.getChild(r).runtime){return}n.removeChild(r)};function v(e,t,n){{b(e,n)}t.update(n);if(n.modules){for(var r in n.modules){if(!t.getChild(r)){{console.warn("[vuex] trying to add a new module '"+r+"' on hot reloading, "+"manual reload is needed")}return}v(e.concat(r),t.getChild(r),n.modules[r])}}}var m={assert:function e(t){return typeof t==="function"},expected:"function"};var g={assert:function e(t){return typeof t==="function"||babelHelpers.typeof(t)==="object"&&typeof t.handler==="function"},expected:'function or object with "handler" function'};var y={getters:m,mutations:m,actions:g};function b(e,t){Object.keys(y).forEach(function(n){if(!t[n]){return}var r=y[n];u(t[n],function(t,i){f(r.assert(t),S(e,n,i,t,r.expected))})})}function S(e,t,n,r,i){var a=t+" should be "+i+' but "'+t+"."+n+'"';if(e.length>0){a+=' in module "'+e.join(".")+'"'}a+=" is "+JSON.stringify(r)+".";return a}var w=function e(n){var r=this;if(n===void 0)n={};{f(t.VueVendor,"must call Vue.use(Vuex) before creating a store instance.");f(typeof Promise!=="undefined","vuex requires a Promise polyfill in this browser.");f(this instanceof e,"Store must be called with the new operator.")}var i=n.plugins;if(i===void 0)i=[];var a=n.strict;if(a===void 0)a=false;var o=n.state;if(o===void 0)o={};if(typeof o==="function"){o=o()||{}}this._committing=false;this._actions=Object.create(null);this._actionSubscribers=[];this._mutations=Object.create(null);this._wrappedGetters=Object.create(null);this._modules=new p(n);this._modulesNamespaceMap=Object.create(null);this._subscribers=[];this._watcherVM=new t.VueVendor;var u=this;var c=this;var l=c.dispatch;var d=c.commit;this.dispatch=function e(t,n){return l.call(u,t,n)};this.commit=function e(t,n,r){return d.call(u,t,n,r)};this.strict=a;V(this,o,[],this._modules.root);x(this,o);i.forEach(function(e){return e(r)});if(t.VueVendor.config.devtools){s(this)}};var _={state:{configurable:true}};_.state.get=function(){return this._vm._data.$$state};_.state.set=function(e){{f(false,"Use store.replaceState() to explicit replace store state.")}};w.prototype.commit=function e(t,n,r){var i=this;var a=H(t,n,r);var o=a.type;var s=a.payload;var u=a.options;var c={type:o,payload:s};var l=this._mutations[o];if(!l){{console.error("[vuex] unknown mutation type: "+o)}return}this._withCommit(function(){l.forEach(function e(t){t(s)})});this._subscribers.forEach(function(e){return e(c,i.state)});if(u&&u.silent){console.warn("[vuex] mutation type: "+o+". Silent option has been removed. "+"Use the filter functionality in the vue-devtools")}};w.prototype.dispatch=function e(t,n){var r=this;var i=H(t,n);var a=i.type;var o=i.payload;var s={type:a,payload:o};var u=this._actions[a];if(!u){{console.error("[vuex] unknown action type: "+a)}return}this._actionSubscribers.forEach(function(e){return e(s,r.state)});return u.length>1?Promise.all(u.map(function(e){return e(o)})):u[0](o)};w.prototype.subscribe=function e(t){return k(t,this._subscribers)};w.prototype.subscribeAction=function e(t){return k(t,this._actionSubscribers)};w.prototype.watch=function e(t,n,r){var i=this;{f(typeof t==="function","store.watch only accepts a function.")}return this._watcherVM.$watch(function(){return t(i.state,i.getters)},n,r)};w.prototype.replaceState=function e(t){var n=this;this._withCommit(function(){n._vm._data.$$state=t})};w.prototype.registerModule=function e(t,n,r){if(r===void 0)r={};if(typeof t==="string"){t=[t]}{f(Array.isArray(t),"module path must be a string or an Array.");f(t.length>0,"cannot register the root module by using registerModule.")}this._modules.register(t,n);V(this,this.state,t,this._modules.get(t),r.preserveState);x(this,this.state)};w.prototype.unregisterModule=function e(n){var r=this;if(typeof n==="string"){n=[n]}{f(Array.isArray(n),"module path must be a string or an Array.")}this._modules.unregister(n);this._withCommit(function(){var e=E(r.state,n.slice(0,-1));t.VueVendor.delete(e,n[n.length-1])});C(this)};w.prototype.hotUpdate=function e(t){this._modules.update(t);C(this,true)};w.prototype._withCommit=function e(t){var n=this._committing;this._committing=true;t();this._committing=n};Object.defineProperties(w.prototype,_);function k(e,t){if(t.indexOf(e)<0){t.push(e)}return function(){var n=t.indexOf(e);if(n>-1){t.splice(n,1)}}}function C(e,t){e._actions=Object.create(null);e._mutations=Object.create(null);e._wrappedGetters=Object.create(null);e._modulesNamespaceMap=Object.create(null);var n=e.state;V(e,n,[],e._modules.root,true);x(e,n,t)}function x(e,n,r){var i=e._vm;e.getters={};var a=e._wrappedGetters;var o={};u(a,function(t,n){o[n]=function(){return t(e)};Object.defineProperty(e.getters,n,{get:function t(){return e._vm[n]},enumerable:true})});var s=t.VueVendor.config.silent;t.VueVendor.config.silent=true;e._vm=new t.VueVendor({data:{$$state:n},computed:o});t.VueVendor.config.silent=s;if(e.strict){j(e)}if(i){if(r){e._withCommit(function(){i._data.$$state=null})}t.VueVendor.nextTick(function(){return i.$destroy()})}}function V(e,n,r,i,a){var o=!r.length;var s=e._modules.getNamespace(r);if(i.namespaced){e._modulesNamespaceMap[s]=i}if(!o&&!a){var u=E(n,r.slice(0,-1));var c=r[r.length-1];e._withCommit(function(){t.VueVendor.set(u,c,i.state)})}var l=i.context=O(e,s,r);i.forEachMutation(function(t,n){var r=s+n;I(e,r,t,l)});i.forEachAction(function(t,n){var r=t.root?n:s+n;var i=t.handler||t;M(e,r,i,l)});i.forEachGetter(function(t,n){var r=s+n;N(e,r,t,l)});i.forEachChild(function(t,i){V(e,n,r.concat(i),t,a)})}function O(e,t,n){var r=t==="";var i={dispatch:r?e.dispatch:function(n,r,i){var a=H(n,r,i);var o=a.payload;var s=a.options;var u=a.type;if(!s||!s.root){u=t+u;if(!e._actions[u]){console.error("[vuex] unknown local action type: "+a.type+", global type: "+u);return}}return e.dispatch(u,o)},commit:r?e.commit:function(n,r,i){var a=H(n,r,i);var o=a.payload;var s=a.options;var u=a.type;if(!s||!s.root){u=t+u;if(!e._mutations[u]){console.error("[vuex] unknown local mutation type: "+a.type+", global type: "+u);return}}e.commit(u,o,s)}};Object.defineProperties(i,{getters:{get:r?function(){return e.getters}:function(){return A(e,t)}},state:{get:function t(){return E(e.state,n)}}});return i}function A(e,t){var n={};var r=t.length;Object.keys(e.getters).forEach(function(i){if(i.slice(0,r)!==t){return}var a=i.slice(r);Object.defineProperty(n,a,{get:function t(){return e.getters[i]},enumerable:true})});return n}function I(e,t,n,r){var i=e._mutations[t]||(e._mutations[t]=[]);i.push(function t(i){n.call(e,r.state,i)})}function M(e,t,n,r){var i=e._actions[t]||(e._actions[t]=[]);i.push(function t(i,a){var o=n.call(e,{dispatch:r.dispatch,commit:r.commit,getters:r.getters,state:r.state,rootGetters:e.getters,rootState:e.state},i,a);if(!l(o)){o=Promise.resolve(o)}if(e._devtoolHook){return o.catch(function(t){e._devtoolHook.emit("vuex:error",t);throw t})}else{return o}})}function N(e,t,n,r){if(e._wrappedGetters[t]){{console.error("[vuex] duplicate getter key: "+t)}return}e._wrappedGetters[t]=function e(t){return n(r.state,r.getters,t.state,t.getters)}}function j(e){e._vm.$watch(function(){return this._data.$$state},function(){{f(e._committing,"Do not mutate vuex store state outside mutation handlers.")}},{deep:true,sync:true})}function E(e,t){return t.length?t.reduce(function(e,t){return e[t]},e):e}function H(e,t,n){if(c(e)&&e.type){n=t;t=e;e=e.type}{f(typeof e==="string","Expects string as the type, but found "+babelHelpers.typeof(e)+".")}return{type:e,payload:t,options:n}}function P(e){a(e)}var D=X(function(e,t){var n={};L(t).forEach(function(t){var r=t.key;var i=t.val;n[r]=function t(){var n=this.$store.state;var r=this.$store.getters;if(e){var a=J(this.$store,"mapState",e);if(!a){return}n=a.context.state;r=a.context.getters}return typeof i==="function"?i.call(this,n,r):n[i]};n[r].vuex=true});return n});var B=X(function(e,t){var n={};L(t).forEach(function(t){var r=t.key;var i=t.val;n[r]=function t(){var n=[],r=arguments.length;while(r--){n[r]=arguments[r]}var a=this.$store.commit;if(e){var o=J(this.$store,"mapMutations",e);if(!o){return}a=o.context.commit}return typeof i==="function"?i.apply(this,[a].concat(n)):a.apply(this.$store,[i].concat(n))}});return n});var $=X(function(e,t){var n={};L(t).forEach(function(t){var r=t.key;var i=t.val;i=e+i;n[r]=function t(){if(e&&!J(this.$store,"mapGetters",e)){return}if(!(i in this.$store.getters)){console.error("[vuex] unknown getter: "+i);return}return this.$store.getters[i]};n[r].vuex=true});return n});var T=X(function(e,t){var n={};L(t).forEach(function(t){var r=t.key;var i=t.val;n[r]=function t(){var n=[],r=arguments.length;while(r--){n[r]=arguments[r]}var a=this.$store.dispatch;if(e){var o=J(this.$store,"mapActions",e);if(!o){return}a=o.context.dispatch}return typeof i==="function"?i.apply(this,[a].concat(n)):a.apply(this.$store,[i].concat(n))}});return n});var G=function e(t){return{mapState:D.bind(null,t),mapGetters:$.bind(null,t),mapMutations:B.bind(null,t),mapActions:T.bind(null,t)}};function L(e){return Array.isArray(e)?e.map(function(e){return{key:e,val:e}}):Object.keys(e).map(function(t){return{key:t,val:e[t]}})}function X(e){return function(t,n){if(typeof t!=="string"){n=t;t=""}else if(t.charAt(t.length-1)!=="/"){t+="/"}return e(t,n)}}function J(e,t,n){var r=e._modulesNamespaceMap[n];if(!r){console.error("[vuex] module namespace not found in "+t+"(): "+n)}return r}var R={Store:w,install:P,version:"3.0.1",mapState:D,mapMutations:B,mapGetters:$,mapActions:T,createNamespacedHelpers:G};t.VueVendor.use(R);var U=function(){function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};babelHelpers.classCallCheck(this,e);this.siteId=t.siteId||"default";this.userId=t.userId||0;this.storage=t.storage||"default";this.name=t.name||"";this.code=(window.md5||r.md5)(this.siteId+"/"+this.userId+"/"+this.storage+"/"+this.name);this.db=new n.Dexie("bx-vuex-model");this.db.version(1).stores({data:"code, value"})}babelHelpers.createClass(e,[{key:"get",value:function e(){var t=this;return new Promise(function(e,n){t.db.data.where("code").equals(t.code).first().then(function(t){e(t?t.value:null)},function(e){n(e)})})}},{key:"set",value:function e(t){var n=this;return new Promise(function(e,r){n.db.data.put({code:n.code,value:t}).then(function(t){e(true)},function(e){r(e)})})}},{key:"clear",value:function e(){var t=this;return new Promise(function(e,n){t.db.data.delete(t.code).then(function(t){e(true)},function(e){n(e)})})}}]);return e}();var W=function(){function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};babelHelpers.classCallCheck(this,e);this.siteId=t.siteId||"default";this.userId=t.userId||0;this.storage=t.storage||"default";this.name=t.name||"";this.enabled=false;if(typeof window.localStorage!=="undefined"){try{window.localStorage.setItem("__bx_test_ls_feature__","ok");if(window.localStorage.getItem("__bx_test_ls_feature__")==="ok"){window.localStorage.removeItem("__bx_test_ls_feature__");this.enabled=true}}catch(e){}}this.code="bx-vuex-"+(window.md5||r.md5)(this.siteId+"/"+this.userId+"/"+this.storage+"/"+this.name)}babelHelpers.createClass(e,[{key:"get",value:function e(){var t=this;return new Promise(function(e,n){if(!t.enabled){e(null);return true}var r=window.localStorage.getItem(t.code);if(typeof r!=="string"){e(null);return true}try{e(t.prepareValueAfterGet(JSON.parse(r)))}catch(e){n(e)}})}},{key:"set",value:function e(t){var n=this;return new Promise(function(e,r){if(n.enabled){window.localStorage.setItem(n.code,JSON.stringify(n.prepareValueBeforeSet(t)))}e(true)})}},{key:"clear",value:function e(){var t=this;return new Promise(function(e,n){if(t.enabled){window.localStorage.removeItem(t.code)}e(true)})}},{key:"prepareValueAfterGet",value:function e(t){var n=this;if(t instanceof Array){t=t.map(function(e){return n.prepareValueAfterGet(e)})}else if(t instanceof Date);else if(t&&babelHelpers.typeof(t)==="object"){for(var r in t){if(t.hasOwnProperty(r)){t[r]=this.prepareValueAfterGet(t[r])}}}else if(typeof t==="string"){if(t.startsWith("#DT#")){t=new Date(t.substring(4))}}return t}},{key:"prepareValueBeforeSet",value:function e(t){var n=this;if(t instanceof Array){t=t.map(function(e){return n.prepareValueBeforeSet(e)})}else if(t instanceof Date){t="#DT#"+t.toISOString()}else if(t&&babelHelpers.typeof(t)==="object"){for(var r in t){if(t.hasOwnProperty(r)){t[r]=this.prepareValueBeforeSet(t[r])}}}return t}}]);return e}();var q=function(){function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};babelHelpers.classCallCheck(this,e);this.siteId=t.siteId||"default";this.userId=t.userId||0;this.storage=t.storage||"default";this.name=t.name||"";this.code=(window.md5||r.md5)(this.siteId+"/"+this.userId+"/"+this.storage+"/"+this.name);if(!this.isJnContext()&&typeof ApplicationStorage==="undefined"){console.error('ApplicationStorage is not defined, load "webcomponent/storage" extension.')}}babelHelpers.createClass(e,[{key:"get",value:function e(){var t=this;return new Promise(function(e,n){if(t.isJnContext()){var r=Application.sharedStorage.get(t.code);e(r?r:null)}else if(typeof ApplicationStorage!=="undefined"){ApplicationStorage.get(t.code,null).then(function(n){return e(t.prepareValueAfterGet(JSON.parse(n)))})}else{e(null)}})}},{key:"set",value:function e(t){var n=this;return new Promise(function(e,r){if(n.isJnContext()){Application.sharedStorage().set(n.code,JSON.stringify(n.prepareValueBeforeSet(t)));e()}else if(typeof ApplicationStorage!=="undefined"){ApplicationStorage.set(n.code,JSON.stringify(n.prepareValueBeforeSet(t))).then(function(t){return e()})}else{e()}})}},{key:"clear",value:function e(){return this.set(null)}},{key:"isJnContext",value:function e(){return typeof env!=="undefined"}},{key:"prepareValueAfterGet",value:function e(t){var n=this;if(t instanceof Array){t=t.map(function(e){return n.prepareValueAfterGet(e)})}else if(t instanceof Date);else if(t&&babelHelpers.typeof(t)==="object"){for(var r in t){if(t.hasOwnProperty(r)){t[r]=this.prepareValueAfterGet(t[r])}}}else if(typeof t==="string"){if(t.startsWith("#DT#")){t=new Date(t.substring(4))}}return t}},{key:"prepareValueBeforeSet",value:function e(t){var n=this;if(t instanceof Array){t=t.map(function(e){return n.prepareValueBeforeSet(e)})}else if(t instanceof Date){t="#DT#"+t.toISOString()}else if(t&&babelHelpers.typeof(t)==="object"){for(var r in t){if(t.hasOwnProperty(r)){t[r]=this.prepareValueBeforeSet(t[r])}}}return t}}]);return e}();var F=function(){babelHelpers.createClass(e,[{key:"getName",value:function e(){return""}},{key:"getState",value:function e(){return{}}},{key:"getElementState",value:function e(){return{}}},{key:"getStateSaveException",value:function e(){return undefined}},{key:"getGetters",value:function e(){return{}}},{key:"getActions",value:function e(){return{}}},{key:"getMutations",value:function e(){return{}}},{key:"validate",value:function e(t){return{}}},{key:"setVariables",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};if(!(babelHelpers.typeof(t)==="object"&&t)){console.error("VuexBuilderModel.setVars: passed variables is not a Object",store);return this}this.variables=t;return this}},{key:"getVariable",value:function e(t){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:undefined;if(!t){return n}var r=t.toString().split(".");if(r.length===1){return this.variables[r[0]]}var i;var a=Object.assign({},this.variables);for(var o=0;o<r.length;o++){if(typeof a[r[o]]!=="undefined"){a=i=a[r[o]]}else{i=n;break}}return i}},{key:"getNamespace",value:function e(){return this.namespace?this.namespace:this.getName()}},{key:"setNamespace",value:function e(t){this.namespace=t.toString();this.databaseConfig.name=this.namespace;return this}},{key:"useDatabase",value:function e(t){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};this.databaseConfig.active=!!t;var r=this.db===null;if(n.type){this.databaseConfig.type=n.type.toString();r=true}if(n.storage){this.databaseConfig.storage=n.storage.toString()}if(n.siteId){this.databaseConfig.siteId=n.siteId.toString()}if(n.userId){this.databaseConfig.userId=n.userId}if(typeof n.timeout==="number"){this.databaseConfig.timeout=n.timeout}if(r){if(this.databaseConfig.type===K.DatabaseType.indexedDb){this.db=new U(this.databaseConfig)}else if(this.databaseConfig.type===K.DatabaseType.localStorage){this.db=new W(this.databaseConfig)}else if(this.databaseConfig.type===K.DatabaseType.jnSharedStorage){this.db=new q(this.databaseConfig)}else{this.db=null}}return this}},{key:"useNamespace",value:function e(t){this.withNamespace=!!t;return this}},{key:"getStore",value:function e(){var t=this;return new Promise(function(e,n){var r="";if(t.withNamespace){r=t.namespace?t.namespace:t.getName();if(!r&&t.withNamespace){console.error("VuexModel.getStore: current model can not be run in Vuex modules mode",t.getState());n()}}if(t.db){t._getStoreFromDatabase().then(function(n){return e(t._createStore(n,r))})}else{e(t._createStore(t.getState(),r))}})}},{key:"getSaveTimeout",value:function e(){return 150}},{key:"getLoadedState",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};return t}},{key:"saveState",value:function e(){var t=this;var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};if(!this.isSaveAvailable()){return true}this.lastSaveState=n;if(this.saveStateTimeout){console.log("wait save...",this.getName());return true}console.log("Start saving",this.getName());var r=this.getSaveTimeout();if(typeof this.databaseConfig.timeout==="number"){r=this.databaseConfig.timeout}this.saveStateTimeout=setTimeout(function(){console.log("save!",t.getName());var e=t.lastSaveState;if(typeof e==="function"){e=e();if(babelHelpers.typeof(e)!=="object"||!e){return false}}t.db.set(t.cloneState(e,t.getStateSaveException()));t.lastState=null;t.saveStateTimeout=null},r);return true}},{key:"clearState",value:function e(){if(this.store){var t="vuexBuilderModelClearState";t=this.withNamespace?this.getNamespace()+"/"+t:t;this.store.commit(t);return true}return this.saveState(this.getState())}},{key:"clearDatabase",value:function e(){if(!this.isSaveAvailable()){return true}this.db.clear();return true}},{key:"isSaveAvailable",value:function e(){return this.db&&this.databaseConfig.active}},{key:"isSaveNeeded",value:function e(t){if(!this.isSaveAvailable()){return false}var n=function e(t){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;if(!n){return true}for(var r in t){if(!t.hasOwnProperty(r)){continue}if(typeof n[r]==="undefined"){return true}else if(babelHelpers.typeof(n[r])==="object"&&n[r]){var i=e(t[r],n[r]);if(i){return true}}}return false};return n(t,this.getStateSaveException())}}],[{key:"create",value:function e(){return new this}}]);function e(){babelHelpers.classCallCheck(this,e);this.databaseConfig={type:K.DatabaseType.indexedDb,active:null,storage:"default",name:this.getName(),siteId:"default",userId:0,timeout:null};this.db=null;this.store=null;this.namespace=null;this.variables={};this.withNamespace=false}babelHelpers.createClass(e,[{key:"setStore",value:function e(t){if(!(t instanceof i.VuexVendor.Store)){console.error("VuexBuilderModel.setStore: passed store is not a Vuex.Store",t);return this}this.store=t;return this}},{key:"_getStoreFromDatabase",value:function e(){var t=this;clearTimeout(this.cacheTimeout);return new Promise(function(e){t.cacheTimeout=setTimeout(function(){console.warn("Cache loading timeout",t.getName());e(t.getState())},1e3);t.db.get().then(function(n){clearTimeout(t.cacheTimeout);n=t.getLoadedState(n?n:{});var r=t.getState();if(n){r=t._mergeState(r,n)}e(r)},function(n){clearTimeout(t.cacheTimeout);e(t.getState())})})}},{key:"_mergeState",value:function e(t,n){for(var r in t){if(!t.hasOwnProperty(r)){continue}if(typeof n[r]==="undefined"){n[r]=t[r]}else if(!(n[r]instanceof Array)&&babelHelpers.typeof(n[r])==="object"&&n[r]&&babelHelpers.typeof(t[r])==="object"&&t[r]){n[r]=Object.assign({},t[r],n[r])}}return n}},{key:"_createStore",value:function e(t){var n=this;var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"";var i={state:t,getters:this.getGetters(),actions:this.getActions(),mutations:this.getMutations()};i.mutations.vuexBuilderModelClearState=function(e){e=Object.assign(e,n.getState());n.saveState(e)};if(r){i.namespaced=true;i=babelHelpers.defineProperty({},r,i)}return i}},{key:"cloneState",value:function e(t){var n=this;var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:undefined;var i;if(t instanceof Array){i=[].concat(t.map(function(e){return n.cloneState(e)}))}else if(t instanceof Date){i=new Date(t.toISOString())}else if(babelHelpers.typeof(t)==="object"&&t){i={};for(var a in t){if(!t.hasOwnProperty(a)){continue}if(typeof r==="undefined"||typeof r[a]==="undefined"){i[a]=this.cloneState(t[a])}else if(babelHelpers.typeof(r[a])==="object"&&r[a]){i[a]=this.cloneState(t[a],r[a])}}}else{i=t}return i}}],[{key:"convertToArray",value:function e(t){var n=[];for(var r in t){if(t.hasOwnProperty(r)){n.push(t[r])}}return n}}]);return e}();var z=Object.freeze({indexedDb:"indexedDb",localStorage:"localStorage",jnSharedStorage:"jnSharedStorage"});var K=function(){babelHelpers.createClass(e,null,[{key:"create",value:function e(){return new this}}]);function e(){babelHelpers.classCallCheck(this,e);this.models=[];this.databaseConfig={name:null,type:null,siteId:null,userId:null,timeout:null};this.withNamespace=true}babelHelpers.createClass(e,[{key:"addModel",value:function e(t){if(!(t instanceof F)){console.error("BX.VuexBuilder.addModel: passed model is not a BX.VuexBuilderModel",t,name);return this}this.models.push(t);return this}},{key:"useNamespace",value:function e(t){this.withNamespace=!!t;return this}},{key:"setDatabaseConfig",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};if(!(babelHelpers.typeof(t)==="object"&&t)){return this}this.databaseConfig.active=true;this.databaseConfig.storage=t.name;this.databaseConfig.type=t.type||this.databaseConfig.type;this.databaseConfig.siteId=t.siteId||this.databaseConfig.siteId;this.databaseConfig.userId=t.userId||this.databaseConfig.userId;this.databaseConfig.timeout=typeof t.timeout!=="undefined"?t.timeout:this.databaseConfig.timeout;return this}},{key:"clearModelState",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;var n=[];this.models.forEach(function(e){n.push(e.clearState())});return new Promise(function(e,r){Promise.all(n).then(function(n){e(true);if(typeof t==="function"){t(true)}},function(e){console.error("BX.VuexBuilder.clearModelState: storage was not clear due to runtime errors.",e?e:"");if(typeof t!=="function"){r("ERROR_WHILE_CLEARING")}})})}},{key:"clearDatabase",value:function e(){this.models.forEach(function(e){return e.clearDatabase()});return new Promise(function(e,t){return e(true)})}},{key:"build",value:function e(){var t=this;var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;var r=this.models.length>1;if(!this.withNamespace&&r){return new Promise(function(e,t){console.error('BX.VuexBuilder.create: you can not use the "no namespace" mode with multiple databases.');if(typeof n!=="function"){t("MULTIPLE_MODULES_WITHOUT_NAMESPACE")}})}var i=[];this.models.forEach(function(e){if(t.databaseConfig.active&&e.databaseConfig.active!==false){e.useDatabase(true,t.databaseConfig)}if(t.withNamespace){e.useNamespace(true)}i.push(e.getStore())});return new Promise(function(e,r){Promise.all(i).then(function(r){var i={};r.forEach(function(e){Object.assign(i,e)});var a=Y.store(t.withNamespace?{modules:i}:i);t.models.forEach(function(e){return e.setStore(a)});e({store:a,models:t.models,builder:t});if(typeof n==="function"){n({store:a,models:t.models,builder:t})}},function(e){console.error("BX.VuexBuilder.create: storage was not created due to runtime errors.",e?e:"");if(typeof n!=="function"){r("ERROR_IN_MODEL")}})})}}]);return e}();K.DatabaseType=z;var Q=function(){function e(){babelHelpers.classCallCheck(this,e)}babelHelpers.createClass(e,null,[{key:"store",value:function e(t){return new R.Store(t)}},{key:"mapState",value:function e(){return R.mapState.apply(R,arguments)}},{key:"mapGetters",value:function e(){return R.mapGetters.apply(R,arguments)}},{key:"mapActions",value:function e(){return R.mapActions.apply(R,arguments)}},{key:"mapMutations",value:function e(){return R.mapMutations.apply(R,arguments)}},{key:"createNamespacedHelpers",value:function e(){return R.createNamespacedHelpers.apply(R,arguments)}},{key:"version",value:function e(){return R.version}}]);return e}();var Y=Q;e.Vuex=Y;e.VuexVendor=R;e.VuexBuilder=K;e.VuexBuilderModel=F})(this.BX=this.BX||{},BX,BX,BX,BX);
//# sourceMappingURL=vuex.bitrix.bundle.map.js