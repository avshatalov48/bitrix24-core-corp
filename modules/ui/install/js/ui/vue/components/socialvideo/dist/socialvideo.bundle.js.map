{"version":3,"file":"socialvideo.bundle.js","sources":["../src/socialvideo.js"],"sourcesContent":["/**\n * Bitrix UI\n * Social Video Vue component\n *\n * @package bitrix\n * @subpackage ui\n * @copyright 2001-2021 Bitrix\n */\n\nimport 'ui.fonts.opensans';\nimport \"./socialvideo.css\";\nimport 'ui.vue.directives.lazyload';\nimport 'main.polyfill.intersectionobserver';\n\nimport {BitrixVue} from 'ui.vue';\nimport {BaseEvent} from \"main.core.events\";\n\nconst State = Object.freeze({\n\tplay: 'play',\n\tpause: 'pause',\n\tstop: 'stop',\n\tnone: 'none',\n});\n\nBitrixVue.component('bx-socialvideo',\n{\n\tprops:\n\t{\n\t\tid: { default: 0 },\n\t\tsrc: { default: '' },\n\t\tpreview: { default: '' },\n\t\tautoplay: { default: true },\n\t\tcontainerClass: { default: null },\n\t\tcontainerStyle: { default: null },\n\t\telementStyle: { default: null },\n\t\tshowControls: { default: true }\n\t},\n\tdata()\n\t{\n\t\treturn {\n\t\t\tpreload: \"none\",\n\t\t\tpreviewLoaded: false,\n\t\t\tloaded: false,\n\t\t\tloading: false,\n\t\t\tplayAfterLoad: false,\n\t\t\tenterFullscreen: false,\n\t\t\tplayBeforeMute: 2,\n\t\t\tstate: State.none,\n\t\t\tprogress: 0,\n\t\t\ttimeCurrent: 0,\n\t\t\ttimeTotal: 0,\n\t\t\tmuteFlag: true,\n\t\t}\n\t},\n\tcreated()\n\t{\n\t\tif (!this.preview)\n\t\t{\n\t\t\tthis.previewLoaded = true;\n\t\t\tthis.preload = 'metadata';\n\t\t}\n\n\t\tthis.$Bitrix.eventEmitter.subscribe('ui:socialvideo:unmute', this.onUnmute);\n\t},\n\tmounted()\n\t{\n\t\tthis.getObserver().observe(this.$refs.body);\n\t},\n\tbeforeDestroy()\n\t{\n\t\tthis.$Bitrix.eventEmitter.unsubscribe('ui:socialvideo:unmute', this.onUnmute);\n\n\t\tthis.getObserver().unobserve(this.$refs.body);\n\t},\n\twatch:\n\t{\n\t\tid(value)\n\t\t{\n\t\t\tthis.registeredId = value;\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tloadFile(play = false)\n\t\t{\n\t\t\tif (this.loaded)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tif (this.loading)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tthis.preload = 'auto';\n\n\t\t\tthis.loading = true;\n\t\t\tthis.playAfterLoad = play;\n\n\t\t\treturn true;\n\t\t},\n\t\tclickToButton(event)\n\t\t{\n\t\t\tif (!this.src)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (this.state === State.play)\n\t\t\t{\n\t\t\t\tthis.getObserver().unobserve(this.$refs.body);\n\t\t\t\tthis.pause();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.play();\n\t\t\t}\n\n\t\t\tevent.stopPropagation();\n\t\t},\n\t\tclickToMute()\n\t\t{\n\t\t\tif (!this.src)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (!this.muteFlag)\n\t\t\t{\n\t\t\t\tthis.mute();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.unmute();\n\t\t\t}\n\n\t\t\tevent.stopPropagation();\n\t\t},\n\t\tclick(event)\n\t\t{\n\t\t\tif (this.autoPlayDisabled)\n\t\t\t{\n\t\t\t\tthis.play();\n\n\t\t\t\tevent.stopPropagation();\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (this.isMobile)\n\t\t\t{\n\t\t\t\tif (this.source().webkitEnterFullscreen)\n\t\t\t\t{\n\t\t\t\t\tthis.unmute();\n\t\t\t\t\tthis.enterFullscreen = true;\n\t\t\t\t\tthis.source().webkitEnterFullscreen();\n\t\t\t\t}\n\t\t\t\telse if (this.source().requestFullscreen)\n\t\t\t\t{\n\t\t\t\t\tthis.unmute();\n\t\t\t\t\tthis.enterFullscreen = true;\n\t\t\t\t\tthis.source().requestFullscreen();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.$emit('click', event);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.$emit('click', event);\n\t\t\t}\n\n\t\t\tevent.stopPropagation();\n\t\t},\n\t\tplay(event)\n\t\t{\n\t\t\tif (!this.loaded)\n\t\t\t{\n\t\t\t\tthis.loadFile(true);\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (!this.source())\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tthis.source().play();\n\t\t},\n\t\tpause()\n\t\t{\n\t\t\tif (!this.source())\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tthis.playAfterLoad = false;\n\n\t\t\tthis.source().pause();\n\t\t},\n\t\tstop()\n\t\t{\n\t\t\tif (!this.source())\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tthis.state = State.stop;\n\t\t\tthis.source().pause();\n\t\t},\n\t\tmute()\n\t\t{\n\t\t\tif (!this.source())\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tthis.muteFlag = true;\n\t\t\tthis.playBeforeMute = 2;\n\t\t\tthis.source().muted = true;\n\t\t},\n\t\tunmute()\n\t\t{\n\t\t\tif (!this.source())\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tthis.muteFlag = false;\n\t\t\tthis.source().muted = false;\n\n\t\t\tif (this.id > 0)\n\t\t\t{\n\t\t\t\tthis.$Bitrix.eventEmitter.emit('ui:socialvideo:unmute', {initiator: this.id});\n\t\t\t}\n\t\t},\n\t\tsetProgress(percent, pixel = -1)\n\t\t{\n\t\t\tthis.progress = percent;\n\t\t},\n\t\tformatTime(second)\n\t\t{\n\t\t\tsecond = Math.floor(second);\n\n\t\t\tconst hour = Math.floor(second/60/60);\n\t\t\tif (hour > 0)\n\t\t\t{\n\t\t\t\tsecond -= hour*60*60;\n\t\t\t}\n\n\t\t\tconst minute = Math.floor(second/60);\n\t\t\tif (minute > 0)\n\t\t\t{\n\t\t\t\tsecond -= minute*60;\n\t\t\t}\n\n\t\t\treturn (hour > 0? hour+':': '')\n\t\t\t\t\t+ (hour > 0? minute.toString().padStart(2, \"0\")+':': minute+':')\n\t\t\t\t\t+ second.toString().padStart(2, \"0\")\n\t\t},\n\t\tonUnmute(event: BaseEvent)\n\t\t{\n\t\t\tevent = event.getData();\n\n\t\t\tif (event.initiator === this.id)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tthis.mute();\n\t\t},\n\t\tsource()\n\t\t{\n\t\t\treturn this.$refs.source;\n\t\t},\n\t\tvideoEventRouter(eventName, event)\n\t\t{\n\t\t\tif (\n\t\t\t\teventName === 'durationchange'\n\t\t\t\t|| eventName === 'loadeddata'\n\t\t\t)\n\t\t\t{\n\t\t\t\tif (!this.source())\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tthis.timeTotal = this.source().duration;\n\t\t\t}\n\t\t\telse if (eventName === 'loadedmetadata')\n\t\t\t{\n\t\t\t\tif (!this.source())\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tthis.timeTotal = this.source().duration;\n\t\t\t\tthis.loaded = true;\n\n\t\t\t\tif (this.playAfterLoad)\n\t\t\t\t{\n\t\t\t\t\tthis.play();\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (\n\t\t\t\teventName === 'abort'\n\t\t\t\t|| eventName === 'error'\n\t\t\t)\n\t\t\t{\n\t\t\t\tconsole.error('BxSocialVideo: load failed', this.id, event);\n\n\t\t\t\tthis.loading = false;\n\t\t\t\tthis.state = State.none;\n\t\t\t\tthis.timeTotal = 0;\n\t\t\t\tthis.preload = 'none';\n\t\t\t}\n\t\t\telse if (\n\t\t\t\teventName === 'canplaythrough'\n\t\t\t)\n\t\t\t{\n\t\t\t\tthis.loading = false;\n\t\t\t\tthis.loaded = true;\n\n\t\t\t\tif (this.playAfterLoad)\n\t\t\t\t{\n\t\t\t\t\tthis.play();\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (eventName === 'volumechange')\n\t\t\t{\n\t\t\t\tif (!this.source())\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tif (this.source().muted)\n\t\t\t\t{\n\t\t\t\t\tthis.mute();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.unmute();\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (eventName === 'timeupdate')\n\t\t\t{\n\t\t\t\tif (!this.source())\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tthis.timeCurrent = this.source().currentTime;\n\n\t\t\t\tif (!this.muteFlag && !this.enterFullscreen && this.timeCurrent === 0)\n\t\t\t\t{\n\t\t\t\t\tif (this.playBeforeMute <= 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.mute();\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.playBeforeMute -= 1;\n\t\t\t\t}\n\n\t\t\t\tthis.setProgress(Math.round(100/this.timeTotal*this.timeCurrent));\n\t\t\t}\n\t\t\telse if (eventName === 'pause')\n\t\t\t{\n\t\t\t\tif (this.state !== State.stop)\n\t\t\t\t{\n\t\t\t\t\tthis.state = State.pause;\n\t\t\t\t}\n\n\t\t\t\tif (this.enterFullscreen)\n\t\t\t\t{\n\t\t\t\t\tthis.enterFullscreen = false;\n\t\t\t\t\tthis.mute();\n\t\t\t\t\tthis.play();\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (eventName === 'play')\n\t\t\t{\n\t\t\t\tthis.state = State.play;\n\n\t\t\t\tif (this.state === State.stop)\n\t\t\t\t{\n\t\t\t\t\tthis.progress = 0;\n\t\t\t\t\tthis.timeCurrent = 0;\n\t\t\t\t}\n\n\t\t\t\tif (this.enterFullscreen)\n\t\t\t\t{\n\t\t\t\t\tthis.enterFullscreen = false;\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tgetObserver()\n\t\t{\n\t\t\tif (this.observer)\n\t\t\t{\n\t\t\t\treturn this.observer;\n\t\t\t}\n\n\t\t\tthis.observer = new IntersectionObserver((entries, observer) =>\n\t\t\t{\n\t\t\t\tif (this.autoPlayDisabled)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tentries.forEach((entry) =>\n\t\t\t\t{\n\t\t\t\t\tif (entry.isIntersecting)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.play();\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.pause();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},{\n\t\t\t\tthreshold: [0, 1]\n\t\t\t});\n\n\t\t\treturn this.observer;\n\t\t},\n\t\tlazyLoadCallback(element)\n\t\t{\n\t\t\tthis.previewLoaded = element.state === 'success';\n\t\t}\n\t},\n\tcomputed:\n\t{\n\t\tState: () => State,\n\t\tautoPlayDisabled()\n\t\t{\n\t\t\treturn !this.autoplay && this.state === State.none;\n\t\t},\n\t\tshowStartButton()\n\t\t{\n\t\t\treturn this.autoPlayDisabled && this.previewLoaded;\n\t\t},\n\t\tshowInterface()\n\t\t{\n\t\t\treturn this.previewLoaded && !this.showStartButton;\n\t\t},\n\t\tlabelTime()\n\t\t{\n\t\t\tif (!this.loaded && !this.timeTotal)\n\t\t\t{\n\t\t\t\treturn '--:--';\n\t\t\t}\n\n\t\t\tlet time;\n\t\t\tif (this.state === State.play)\n\t\t\t{\n\t\t\t\ttime = this.timeTotal - this.timeCurrent;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\ttime = this.timeTotal;\n\t\t\t}\n\n\t\t\treturn this.formatTime(time);\n\t\t},\n\t\tisMobile()\n\t\t{\n\t\t\tconst UA = navigator.userAgent.toLowerCase();\n\n\t\t\treturn (\n\t\t\t\tUA.includes('android')\n\t\t\t\t|| UA.includes('iphone')\n\t\t\t\t|| UA.includes('ipad')\n\t\t\t\t|| UA.includes('bitrixmobile')\n\t\t\t)\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div :class=\"['ui-vue-socialvideo', containerClass, {\n\t\t\t\t'ui-vue-socialvideo-mobile': isMobile,\n\t\t\t}]\" :style=\"containerStyle\" @click=\"click\">\n\t\t\t<transition name=\"ui-vue-socialvideo-animation-fade\">\n\t\t\t\t<div v-if=\"showStartButton && showControls\" class=\"ui-vue-socialvideo-button-start\">\n\t\t\t\t\t<span class=\"ui-vue-socialvideo-button-start-icon\"></span>\n\t\t\t\t</div>\n\t\t\t</transition>\n\t\t\t<transition name=\"ui-vue-socialvideo-animation-fade\">\n\t\t\t\t<div v-if=\"showInterface && showControls\" class=\"ui-vue-socialvideo-overlay-container\">\n\t\t\t\t\t<div class=\"ui-vue-socialvideo-controls-container\" @click=\"clickToButton\">\n\t\t\t\t\t\t<button :class=\"['ui-vue-socialvideo-control', {\n\t\t\t\t\t\t\t'ui-vue-socialvideo-control-loader': loading,\n\t\t\t\t\t\t\t'ui-vue-socialvideo-control-play': !loading && state !== State.play,\n\t\t\t\t\t\t\t'ui-vue-socialvideo-control-pause': !loading && state === State.play,\n\t\t\t\t\t\t}]\"></button>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"ui-vue-socialvideo-info-container\" @click=\"clickToMute\">\n\t\t\t\t\t\t<span class=\"ui-vue-socialvideo-time-current\">{{labelTime}}</span>\n\t\t\t\t\t\t<span :class=\"['ui-vue-socialvideo-sound', {\n\t\t\t\t\t\t\t'ui-vue-socialvideo-sound-on': state !== State.none && !muteFlag,\n\t\t\t\t\t\t\t'ui-vue-socialvideo-sound-off': state !== State.none && muteFlag\n\t\t\t\t\t\t}]\"></span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</transition>\n\t\t\t<div v-if=\"!preview\" class=\"ui-vue-socialvideo-background\" :style=\"{position: (src? 'absolute': 'relative')}\"></div>\n\t\t\t<div class=\"ui-vue-socialvideo-container\" ref=\"body\">\n\t\t\t\t<img \n\t\t\t\t\tv-bx-lazyload=\"{callback: lazyLoadCallback}\"\n\t\t\t\t\tdata-lazyload-dont-hide\n\t\t\t\t\tv-if=\"preview\"\n\t\t\t\t\tclass=\"ui-vue-socialvideo-image-source\"\n\t\t\t\t\t:data-lazyload-src=\"preview\"\n\t\t\t\t\t:style=\"{position: (src? 'absolute': 'relative'), ...elementStyle}\"\n\t\t\t\t/>\n\t\t\t\t<video \n\t\t\t\t\tv-if=\"src\" :src=\"src\" \n\t\t\t\t\tclass=\"ui-vue-socialvideo-source\" \n\t\t\t\t\tref=\"source\"\n\t\t\t\t\t:preload=\"preload\" \n\t\t\t\t\tplaysinline\n\t\t\t\t\tloop \n\t\t\t\t\tmuted\n\t\t\t\t\t:style=\"{opacity: (loaded? 1: 0), ...elementStyle}\"\n\t\t\t\t\t@abort=\"videoEventRouter('abort', $event)\"\n\t\t\t\t\t@error=\"videoEventRouter('error', $event)\"\n\t\t\t\t\t@suspend=\"videoEventRouter('suspend', $event)\"\n\t\t\t\t\t@canplay=\"videoEventRouter('canplay', $event)\"\n\t\t\t\t\t@canplaythrough=\"videoEventRouter('canplaythrough', $event)\"\n\t\t\t\t\t@durationchange=\"videoEventRouter('durationchange', $event)\"\n\t\t\t\t\t@loadeddata=\"videoEventRouter('loadeddata', $event)\"\n\t\t\t\t\t@loadedmetadata=\"videoEventRouter('loadedmetadata', $event)\"\n\t\t\t\t\t@volumechange=\"videoEventRouter('volumechange', $event)\"\n\t\t\t\t\t@timeupdate=\"videoEventRouter('timeupdate', $event)\"\n\t\t\t\t\t@play=\"videoEventRouter('play', $event)\"\n\t\t\t\t\t@playing=\"videoEventRouter('playing', $event)\"\n\t\t\t\t\t@pause=\"videoEventRouter('pause', $event)\"\n\t\t\t\t></video>\n\t\t\t</div>\n\t\t</div>\t\n\t`\n});\n"],"names":["State","Object","freeze","play","pause","stop","none","BitrixVue","component","props","id","src","preview","autoplay","containerClass","containerStyle","elementStyle","showControls","data","preload","previewLoaded","loaded","loading","playAfterLoad","enterFullscreen","playBeforeMute","state","progress","timeCurrent","timeTotal","muteFlag","created","$Bitrix","eventEmitter","subscribe","onUnmute","mounted","getObserver","observe","$refs","body","beforeDestroy","unsubscribe","unobserve","watch","value","registeredId","methods","loadFile","clickToButton","event","stopPropagation","clickToMute","mute","unmute","click","autoPlayDisabled","isMobile","source","webkitEnterFullscreen","requestFullscreen","$emit","muted","emit","initiator","setProgress","percent","formatTime","second","Math","floor","hour","minute","toString","padStart","getData","videoEventRouter","eventName","duration","console","error","currentTime","round","observer","IntersectionObserver","entries","forEach","entry","isIntersecting","threshold","lazyLoadCallback","element","computed","showStartButton","showInterface","labelTime","time","UA","navigator","userAgent","toLowerCase","includes","template"],"mappings":"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"}