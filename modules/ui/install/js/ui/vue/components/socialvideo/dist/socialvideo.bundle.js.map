{"version":3,"file":"socialvideo.bundle.js","sources":["../src/socialvideo.js"],"sourcesContent":["/**\n * Bitrix UI\n * Social Video Vue component\n *\n * @package bitrix\n * @subpackage ui\n * @copyright 2001-2019 Bitrix\n */\n\nimport \"./socialvideo.css\";\nimport 'ui.vue.directives.lazyload';\nimport 'main.polyfill.intersectionobserver';\n\nimport {Vue} from 'ui.vue';\n\nconst State = Object.freeze({\n\tplay: 'play',\n\tpause: 'pause',\n\tstop: 'stop',\n\tnone: 'none',\n});\n\nVue.component('bx-socialvideo',\n{\n\tprops:\n\t{\n\t\tid: { default: 0 },\n\t\tsrc: { default: '' },\n\t\tpreview: { default: '' },\n\t\tautoplay: { default: true },\n\t\tcontainerClass: { default: null },\n\t\tcontainerStyle: { default: null },\n\t\telementStyle: { default: null },\n\t},\n\tdata()\n\t{\n\t\treturn {\n\t\t\tpreload: \"none\",\n\t\t\tpreviewLoaded: false,\n\t\t\tloaded: false,\n\t\t\tloading: false,\n\t\t\tplayAfterLoad: false,\n\t\t\tenterFullscreen: false,\n\t\t\tplayBeforeMute: 2,\n\t\t\tstate: State.none,\n\t\t\tprogress: 0,\n\t\t\ttimeCurrent: 0,\n\t\t\ttimeTotal: 0,\n\t\t\tmuteFlag: true,\n\t\t}\n\t},\n\tcreated()\n\t{\n\t\tthis.registeredId = 0;\n\n\t\tif (!this.preview)\n\t\t{\n\t\t\tthis.previewLoaded = true;\n\t\t\tthis.preload = 'metadata';\n\t\t}\n\n\t\tthis.registerPlayer(this.id);\n\n\t\tthis.$root.$on('ui:socialvideo:play', this.onPlay);\n\t\tVue.event.$on('ui:socialvideo:play', this.onPlay);\n\t\tthis.$root.$on('ui:socialvideo:stop', this.onStop);\n\t\tVue.event.$on('ui:socialvideo:stop', this.onStop);\n\t\tthis.$root.$on('ui:socialvideo:pause', this.onPause);\n\t\tVue.event.$on('ui:socialvideo:pause', this.onPause);\n\t},\n\tmounted()\n\t{\n\t\tthis.getObserver().observe(this.$refs.body);\n\t},\n\tbeforeDestroy()\n\t{\n\t\tthis.unregisterPlayer();\n\n\t\tthis.$root.$off('ui:socialvideo:play', this.onPlay);\n\t\tVue.event.$off('ui:socialvideo:play', this.onPlay);\n\t\tthis.$root.$off('ui:socialvideo:stop', this.onStop);\n\t\tVue.event.$off('ui:socialvideo:stop', this.onStop);\n\t\tthis.$root.$off('ui:socialvideo:pause', this.onPause);\n\t\tVue.event.$off('ui:socialvideo:pause', this.onPause);\n\n\t\tthis.getObserver().unobserve(this.$refs.body);\n\t},\n\twatch:\n\t{\n\t\tid(value)\n\t\t{\n\t\t\tthis.registerPlayer(value);\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tloadFile(play = false)\n\t\t{\n\t\t\tif (this.loaded)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tif (this.loading)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tthis.preload = 'auto';\n\n\t\t\tthis.loading = true;\n\t\t\tthis.playAfterLoad = play;\n\n\t\t\treturn true;\n\t\t},\n\t\tclickToButton(event)\n\t\t{\n\t\t\tif (!this.src)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (this.state === State.play)\n\t\t\t{\n\t\t\t\tthis.getObserver().unobserve(this.$refs.body);\n\t\t\t\tthis.pause();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.play();\n\t\t\t}\n\n\t\t\tevent.stopPropagation();\n\t\t},\n\t\tclickToMute()\n\t\t{\n\t\t\tif (!this.src)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (!this.muteFlag)\n\t\t\t{\n\t\t\t\tthis.mute();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.unmute();\n\t\t\t}\n\n\t\t\tevent.stopPropagation();\n\t\t},\n\t\tclick(event)\n\t\t{\n\t\t\tif (this.autoPlayDisabled)\n\t\t\t{\n\t\t\t\tthis.play();\n\n\t\t\t\tevent.stopPropagation();\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (this.isMobile)\n\t\t\t{\n\t\t\t\tif (this.source().webkitEnterFullscreen)\n\t\t\t\t{\n\t\t\t\t\tthis.unmute();\n\t\t\t\t\tthis.enterFullscreen = true;\n\t\t\t\t\tthis.source().webkitEnterFullscreen();\n\t\t\t\t}\n\t\t\t\telse if (this.source().requestFullscreen)\n\t\t\t\t{\n\t\t\t\t\tthis.unmute();\n\t\t\t\t\tthis.enterFullscreen = true;\n\t\t\t\t\tthis.source().requestFullscreen();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.$emit('click', event);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.$emit('click', event);\n\t\t\t}\n\n\t\t\tevent.stopPropagation();\n\t\t},\n\t\tplay(event)\n\t\t{\n\t\t\tif (!this.loaded)\n\t\t\t{\n\t\t\t\tthis.loadFile(true);\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (!this.source())\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tthis.source().play();\n\t\t},\n\t\tpause()\n\t\t{\n\t\t\tif (!this.source())\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tthis.playAfterLoad = false;\n\n\t\t\tthis.source().pause();\n\t\t},\n\t\tstop()\n\t\t{\n\t\t\tif (!this.source())\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tthis.state = State.stop;\n\t\t\tthis.source().pause();\n\t\t},\n\t\tmute()\n\t\t{\n\t\t\tif (!this.source())\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tthis.muteFlag = true;\n\t\t\tthis.playBeforeMute = 2;\n\t\t\tthis.source().muted = true;\n\t\t},\n\t\tunmute()\n\t\t{\n\t\t\tif (!this.source())\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tthis.muteFlag = false;\n\t\t\tthis.source().muted = false;\n\t\t},\n\t\tsetProgress(percent, pixel = -1)\n\t\t{\n\t\t\tthis.progress = percent;\n\t\t},\n\t\tformatTime(second)\n\t\t{\n\t\t\tsecond = Math.floor(second);\n\n\t\t\tconst hour = Math.floor(second/60/60);\n\t\t\tif (hour > 0)\n\t\t\t{\n\t\t\t\tsecond -= hour*60*60;\n\t\t\t}\n\n\t\t\tconst minute = Math.floor(second/60);\n\t\t\tif (minute > 0)\n\t\t\t{\n\t\t\t\tsecond -= minute*60;\n\t\t\t}\n\n\t\t\treturn (hour > 0? hour+':': '')\n\t\t\t\t\t+ (hour > 0? minute.toString().padStart(2, \"0\")+':': minute+':')\n\t\t\t\t\t+ second.toString().padStart(2, \"0\")\n\t\t},\n\t\tregisterPlayer(id)\n\t\t{\n\t\t\tif (id <= 0)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (typeof this.$root.$uiSocialVideoId === 'undefined')\n\t\t\t{\n\t\t\t\tthis.$root.$uiSocialVideoId = [];\n\t\t\t}\n\n\t\t\tthis.unregisterPlayer();\n\n\t\t\tthis.$root.$uiSocialVideoId = [...new Set([...this.$root.$uiSocialVideoId, id])].sort((a, b) => {\n\t\t\t\tif (a > b)\n\t\t\t\t\treturn 1;\n\t\t\t\telse if (a < b)\n\t\t\t\t\treturn -1;\n\t\t\t\telse\n\t\t\t\t\treturn 0;\n\t\t\t});\n\n\t\t\tthis.registeredId = id;\n\n\t\t\treturn true;\n\t\t},\n\t\tunregisterPlayer()\n\t\t{\n\t\t\tif (!this.registeredId)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tthis.$root.$uiSocialVideoId = this.$root.$uiSocialVideoId.filter(id => id !== this.registeredId);\n\n\t\t\tthis.registeredId = 0;\n\n\t\t\treturn true;\n\t\t},\n\t\tonPlay(event)\n\t\t{\n\t\t\tif (event.id !== this.id)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (event.start)\n\t\t\t{\n\t\t\t\tthis.stop();\n\t\t\t}\n\n\t\t\tthis.play();\n\t\t},\n\t\tonStop(event)\n\t\t{\n\t\t\tif (event.initiator === this.id)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tthis.stop();\n\t\t},\n\t\tonPause(event)\n\t\t{\n\t\t\tif (event.initiator === this.id)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tthis.pause();\n\t\t},\n\t\tsource()\n\t\t{\n\t\t\treturn this.$refs.source;\n\t\t},\n\t\tvideoEventRouter(eventName, event)\n\t\t{\n\t\t\tif (\n\t\t\t\teventName === 'durationchange'\n\t\t\t\t|| eventName === 'loadeddata'\n\t\t\t)\n\t\t\t{\n\t\t\t\tif (!this.source())\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tthis.timeTotal = this.source().duration;\n\t\t\t}\n\t\t\telse if (eventName === 'loadedmetadata')\n\t\t\t{\n\t\t\t\tif (!this.source())\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tthis.timeTotal = this.source().duration;\n\t\t\t\tthis.loaded = true;\n\n\t\t\t\tif (this.playAfterLoad)\n\t\t\t\t{\n\t\t\t\t\tthis.play();\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (\n\t\t\t\teventName === 'abort'\n\t\t\t\t|| eventName === 'error'\n\t\t\t)\n\t\t\t{\n\t\t\t\tconsole.error('BxSocialVideo: load failed', this.id, event);\n\n\t\t\t\tthis.loading = false;\n\t\t\t\tthis.state = State.none;\n\t\t\t\tthis.timeTotal = 0;\n\t\t\t\tthis.preload = 'none';\n\t\t\t}\n\t\t\telse if (\n\t\t\t\teventName === 'canplaythrough'\n\t\t\t)\n\t\t\t{\n\t\t\t\tthis.loading = false;\n\t\t\t\tthis.loaded = true;\n\n\t\t\t\tif (this.playAfterLoad)\n\t\t\t\t{\n\t\t\t\t\tthis.play();\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (eventName === 'volumechange')\n\t\t\t{\n\t\t\t\tif (!this.source())\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tif (this.source().muted)\n\t\t\t\t{\n\t\t\t\t\tthis.mute();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.unmute();\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (eventName === 'timeupdate')\n\t\t\t{\n\t\t\t\tif (!this.source())\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tthis.timeCurrent = this.source().currentTime;\n\n\t\t\t\tif (!this.muteFlag && !this.enterFullscreen && this.timeCurrent === 0)\n\t\t\t\t{\n\t\t\t\t\tif (this.playBeforeMute <= 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.mute();\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.playBeforeMute -= 1;\n\t\t\t\t}\n\n\t\t\t\tthis.setProgress(Math.round(100/this.timeTotal*this.timeCurrent));\n\t\t\t}\n\t\t\telse if (eventName === 'pause')\n\t\t\t{\n\t\t\t\tif (this.state !== State.stop)\n\t\t\t\t{\n\t\t\t\t\tthis.state = State.pause;\n\t\t\t\t}\n\n\t\t\t\tif (this.enterFullscreen)\n\t\t\t\t{\n\t\t\t\t\tthis.enterFullscreen = false;\n\t\t\t\t\tthis.mute();\n\t\t\t\t\tthis.play();\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (eventName === 'play')\n\t\t\t{\n\t\t\t\tthis.state = State.play;\n\n\t\t\t\tif (this.state === State.stop)\n\t\t\t\t{\n\t\t\t\t\tthis.progress = 0;\n\t\t\t\t\tthis.timeCurrent = 0;\n\t\t\t\t}\n\n\t\t\t\tif (this.enterFullscreen)\n\t\t\t\t{\n\t\t\t\t\tthis.enterFullscreen = false;\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tgetObserver()\n\t\t{\n\t\t\tif (this.observer)\n\t\t\t{\n\t\t\t\treturn this.observer;\n\t\t\t}\n\n\t\t\tthis.observer = new IntersectionObserver((entries, observer) =>\n\t\t\t{\n\t\t\t\tif (this.autoPlayDisabled)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tentries.forEach((entry) =>\n\t\t\t\t{\n\t\t\t\t\tif (entry.isIntersecting)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.play();\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.pause();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},{\n\t\t\t\tthreshold: [0, 1]\n\t\t\t});\n\n\t\t\treturn this.observer;\n\t\t},\n\t\tlazyLoadCallback(element)\n\t\t{\n\t\t\tthis.previewLoaded = element.state === 'success';\n\t\t}\n\t},\n\tcomputed:\n\t{\n\t\tState: () => State,\n\t\tautoPlayDisabled()\n\t\t{\n\t\t\treturn !this.autoplay && this.state === State.none;\n\t\t},\n\t\tshowStartButton()\n\t\t{\n\t\t\treturn this.autoPlayDisabled && this.previewLoaded;\n\t\t},\n\t\tshowInterface()\n\t\t{\n\t\t\treturn this.previewLoaded && !this.showStartButton;\n\t\t},\n\t\tlabelTime()\n\t\t{\n\t\t\tif (!this.loaded && !this.timeTotal)\n\t\t\t{\n\t\t\t\treturn '--:--';\n\t\t\t}\n\n\t\t\tlet time;\n\t\t\tif (this.state === State.play)\n\t\t\t{\n\t\t\t\ttime = this.timeTotal - this.timeCurrent;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\ttime = this.timeTotal;\n\t\t\t}\n\n\t\t\treturn this.formatTime(time);\n\t\t},\n\t\tisMobile()\n\t\t{\n\t\t\tconst UA = navigator.userAgent.toLowerCase();\n\n\t\t\treturn (\n\t\t\t\tUA.includes('android')\n\t\t\t\t|| UA.includes('iphone')\n\t\t\t\t|| UA.includes('ipad')\n\t\t\t\t|| UA.includes('bitrixmobile')\n\t\t\t)\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div :class=\"['ui-vue-socialvideo', containerClass, {\n\t\t\t\t'ui-vue-socialvideo-mobile': isMobile,\n\t\t\t}]\" :style=\"containerStyle\" @click=\"click\">\n\t\t\t<transition name=\"ui-vue-socialvideo-animation-fade\">\n\t\t\t\t<div v-if=\"showStartButton\" class=\"ui-vue-socialvideo-button-start\">\n\t\t\t\t\t<span class=\"ui-vue-socialvideo-button-start-icon\"></span>\n\t\t\t\t</div>\n\t\t\t</transition>\n\t\t\t<transition name=\"ui-vue-socialvideo-animation-fade\">\n\t\t\t\t<div v-if=\"showInterface\" class=\"ui-vue-socialvideo-overlay-container\">\n\t\t\t\t\t<div class=\"ui-vue-socialvideo-controls-container\" @click=\"clickToButton\">\n\t\t\t\t\t\t<button :class=\"['ui-vue-socialvideo-control', {\n\t\t\t\t\t\t\t'ui-vue-socialvideo-control-loader': loading,\n\t\t\t\t\t\t\t'ui-vue-socialvideo-control-play': !loading && state !== State.play,\n\t\t\t\t\t\t\t'ui-vue-socialvideo-control-pause': !loading && state === State.play,\n\t\t\t\t\t\t}]\"></button>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"ui-vue-socialvideo-info-container\" @click=\"clickToMute\">\n\t\t\t\t\t\t<span class=\"ui-vue-socialvideo-time-current\">{{labelTime}}</span>\n\t\t\t\t\t\t<span :class=\"['ui-vue-socialvideo-sound', {\n\t\t\t\t\t\t\t'ui-vue-socialvideo-sound-on': state !== State.none && !muteFlag,\n\t\t\t\t\t\t\t'ui-vue-socialvideo-sound-off': state !== State.none && muteFlag\n\t\t\t\t\t\t}]\"></span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</transition>\n\t\t\t<div v-if=\"!preview\" class=\"ui-vue-socialvideo-background\" :style=\"{position: (src? 'absolute': 'relative')}\"></div>\n\t\t\t<div class=\"ui-vue-socialvideo-container\" ref=\"body\">\n\t\t\t\t<img \n\t\t\t\t\tv-bx-lazyload=\"{callback: lazyLoadCallback}\"\n\t\t\t\t\tdata-lazyload-dont-hide\n\t\t\t\t\tv-if=\"preview\"\n\t\t\t\t\tclass=\"ui-vue-socialvideo-image-source\"\n\t\t\t\t\t:data-lazyload-src=\"preview\"\n\t\t\t\t\t:style=\"{position: (src? 'absolute': 'relative'), ...elementStyle}\"\n\t\t\t\t/>\n\t\t\t\t<video \n\t\t\t\t\tv-if=\"src\" :src=\"src\" \n\t\t\t\t\tclass=\"ui-vue-socialvideo-source\" \n\t\t\t\t\tref=\"source\"\n\t\t\t\t\t:preload=\"preload\" \n\t\t\t\t\tplaysinline\n\t\t\t\t\tloop \n\t\t\t\t\tmuted\n\t\t\t\t\t:style=\"{opacity: (loaded? 1: 0), ...elementStyle}\"\n\t\t\t\t\t@abort=\"videoEventRouter('abort', $event)\"\n\t\t\t\t\t@error=\"videoEventRouter('error', $event)\"\n\t\t\t\t\t@suspend=\"videoEventRouter('suspend', $event)\"\n\t\t\t\t\t@canplay=\"videoEventRouter('canplay', $event)\"\n\t\t\t\t\t@canplaythrough=\"videoEventRouter('canplaythrough', $event)\"\n\t\t\t\t\t@durationchange=\"videoEventRouter('durationchange', $event)\"\n\t\t\t\t\t@loadeddata=\"videoEventRouter('loadeddata', $event)\"\n\t\t\t\t\t@loadedmetadata=\"videoEventRouter('loadedmetadata', $event)\"\n\t\t\t\t\t@volumechange=\"videoEventRouter('volumechange', $event)\"\n\t\t\t\t\t@timeupdate=\"videoEventRouter('timeupdate', $event)\"\n\t\t\t\t\t@play=\"videoEventRouter('play', $event)\"\n\t\t\t\t\t@playing=\"videoEventRouter('playing', $event)\"\n\t\t\t\t\t@pause=\"videoEventRouter('pause', $event)\"\n\t\t\t\t></video>\n\t\t\t</div>\n\t\t</div>\t\n\t`\n});\n"],"names":["State","Object","freeze","play","pause","stop","none","Vue","component","props","id","default","src","preview","autoplay","containerClass","containerStyle","elementStyle","data","preload","previewLoaded","loaded","loading","playAfterLoad","enterFullscreen","playBeforeMute","state","progress","timeCurrent","timeTotal","muteFlag","created","registeredId","registerPlayer","$root","$on","onPlay","event","onStop","onPause","mounted","getObserver","observe","$refs","body","beforeDestroy","unregisterPlayer","$off","unobserve","watch","value","methods","loadFile","clickToButton","stopPropagation","clickToMute","mute","unmute","click","autoPlayDisabled","isMobile","source","webkitEnterFullscreen","requestFullscreen","$emit","muted","setProgress","percent","formatTime","second","Math","floor","hour","minute","toString","padStart","$uiSocialVideoId","Set","sort","a","b","filter","start","initiator","videoEventRouter","eventName","duration","console","error","currentTime","round","observer","IntersectionObserver","entries","forEach","entry","isIntersecting","threshold","lazyLoadCallback","element","computed","showStartButton","showInterface","labelTime","time","UA","navigator","userAgent","toLowerCase","includes","template"],"mappings":"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"}