{"version":3,"file":"audioplayer.bundle.js","sources":["../src/audioplayer.js"],"sourcesContent":["/**\n * Bitrix UI\n * Audio player Vue component\n *\n * @package bitrix\n * @subpackage ui\n * @copyright 2001-2019 Bitrix\n */\n\nimport \"./audioplayer.css\";\nimport 'main.polyfill.intersectionobserver';\n\nimport {Vue} from 'ui.vue';\n\nconst State = Object.freeze({\n\tplay: 'play',\n\tpause: 'pause',\n\tstop: 'stop',\n\tnone: 'none',\n});\n\nVue.component('bx-audioplayer',\n{\n\tprops:\n\t{\n\t\tid: { default: 0 },\n\t\tsrc: { default: '' },\n\t\tautoPlayNext: { default: true },\n\t\tbackground: { default: 'light' },\n\t},\n\tdata()\n\t{\n\t\treturn {\n\t\t\tisDark: false,\n\t\t\tpreload: \"none\",\n\t\t\tloaded: false,\n\t\t\tloading: false,\n\t\t\tplayAfterLoad: false,\n\t\t\tstate: State.none,\n\t\t\tprogress: 0,\n\t\t\tprogressInPixel: 0,\n\t\t\tseek: 0,\n\t\t\ttimeCurrent: 0,\n\t\t\ttimeTotal: 0,\n\t\t}\n\t},\n\tcreated()\n\t{\n\t\tthis.preloadRequestSent = false;\n\t\tthis.registeredId = 0;\n\n\t\tthis.registerPlayer(this.id);\n\n\t\tthis.$root.$on('ui:audioplayer:play', this.onPlay);\n\t\tVue.event.$on('ui:audioplayer:play', this.onPlay);\n\t\tthis.$root.$on('ui:audioplayer:stop', this.onStop);\n\t\tVue.event.$on('ui:audioplayer:stop', this.onStop);\n\t\tthis.$root.$on('ui:audioplayer:pause', this.onPause);\n\t\tVue.event.$on('ui:audioplayer:pause', this.onPause);\n\t\tthis.$root.$on('ui:audioplayer:preload', this.onPreload);\n\n\t\tthis.isDark = this.background === 'dark';\n\t},\n\tmounted()\n\t{\n\t\tthis.getObserver().observe(this.$refs.body);\n\t},\n\tbeforeDestroy()\n\t{\n\t\tthis.unregisterPlayer();\n\n\t\tthis.$root.$off('ui:audioplayer:play', this.onPlay);\n\t\tVue.event.$off('ui:audioplayer:play', this.onPlay);\n\t\tthis.$root.$off('ui:audioplayer:stop', this.onStop);\n\t\tVue.event.$off('ui:audioplayer:stop', this.onStop);\n\t\tthis.$root.$off('ui:audioplayer:pause', this.onPause);\n\t\tVue.event.$off('ui:audioplayer:pause', this.onPause);\n\t\tthis.$root.$off('ui:audioplayer:preload', this.onPreload);\n\n\t\tthis.getObserver().unobserve(this.$refs.body);\n\t},\n\twatch:\n\t{\n\t\tid(value)\n\t\t{\n\t\t\tthis.registerPlayer(value);\n\t\t},\n\t\tprogress(value)\n\t\t{\n\t\t\tif (value > 70)\n\t\t\t{\n\t\t\t\tthis.preloadNext();\n\t\t\t}\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tloadFile(play = false)\n\t\t{\n\t\t\tif (this.loaded)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tif (this.loading && !play)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tthis.preload = 'auto';\n\n\t\t\tif (play)\n\t\t\t{\n\t\t\t\tthis.loading = true;\n\n\t\t\t\tif (this.source())\n\t\t\t\t{\n\t\t\t\t\tthis.source().play();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn true;\n\t\t},\n\t\tclickToButton()\n\t\t{\n\t\t\tif (!this.src)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (this.state === State.play)\n\t\t\t{\n\t\t\t\tthis.pause();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.play();\n\t\t\t}\n\t\t},\n\t\tplay()\n\t\t{\n\t\t\tif (!this.loaded)\n\t\t\t{\n\t\t\t\tthis.loadFile(true);\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tthis.source().play();\n\t\t},\n\t\tpause()\n\t\t{\n\t\t\tthis.source().pause();\n\t\t},\n\t\tstop()\n\t\t{\n\t\t\tthis.state = State.stop;\n\t\t\tthis.source().pause();\n\t\t},\n\t\tsetPosition(event)\n\t\t{\n\t\t\tif (!this.loaded)\n\t\t\t{\n\t\t\t\tthis.loadFile(true);\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tlet pixelPerPercent = this.$refs.track.offsetWidth / 100;\n\n\t\t\tthis.setProgress(this.seek / pixelPerPercent, this.seek);\n\n\t\t\tif (this.state !== State.play)\n\t\t\t{\n\t\t\t\tthis.state = State.pause;\n\t\t\t}\n\n\t\t\tthis.play();\n\t\t\tthis.source().currentTime = this.timeTotal/100*this.progress;\n\t\t},\n\t\tseeking(event)\n\t\t{\n\t\t\tif (!this.loaded)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tthis.seek = event.offsetX > 0? event.offsetX: 0;\n\n\t\t\treturn true;\n\t\t},\n\t\tsetProgress(percent, pixel = -1)\n\t\t{\n\t\t\tthis.progress = percent;\n\t\t\tthis.progressInPixel = pixel > 0? pixel: Math.round(this.$refs.track.offsetWidth / 100 * percent);\n\t\t},\n\t\tformatTime(second)\n\t\t{\n\t\t\tsecond = Math.floor(second);\n\n\t\t\tconst hour = Math.floor(second/60/60);\n\t\t\tif (hour > 0)\n\t\t\t{\n\t\t\t\tsecond -= hour*60*60;\n\t\t\t}\n\n\t\t\tconst minute = Math.floor(second/60);\n\t\t\tif (minute > 0)\n\t\t\t{\n\t\t\t\tsecond -= minute*60;\n\t\t\t}\n\n\t\t\treturn (hour > 0? hour+':': '')\n\t\t\t\t\t+ (hour > 0? minute.toString().padStart(2, \"0\")+':': minute+':')\n\t\t\t\t\t+ second.toString().padStart(2, \"0\")\n\t\t},\n\t\tregisterPlayer(id)\n\t\t{\n\t\t\tif (id <= 0)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (typeof this.$root.$uiAudioPlayerId === 'undefined')\n\t\t\t{\n\t\t\t\tthis.$root.$uiAudioPlayerId = [];\n\t\t\t}\n\n\t\t\tthis.unregisterPlayer();\n\n\t\t\tthis.$root.$uiAudioPlayerId = [...new Set([...this.$root.$uiAudioPlayerId, id])].sort((a, b) => {\n\t\t\t\tif (a > b)\n\t\t\t\t\treturn 1;\n\t\t\t\telse if (a < b)\n\t\t\t\t\treturn -1;\n\t\t\t\telse\n\t\t\t\t\treturn 0;\n\t\t\t});\n\n\t\t\tthis.registeredId = id;\n\n\t\t\treturn true;\n\t\t},\n\t\tunregisterPlayer()\n\t\t{\n\t\t\tif (!this.registeredId)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tthis.$root.$uiAudioPlayerId = this.$root.$uiAudioPlayerId.filter(id => id !== this.registeredId);\n\n\t\t\tthis.registeredId = 0;\n\n\t\t\treturn true;\n\t\t},\n\t\tplayNext()\n\t\t{\n\t\t\tif (!this.registeredId || !this.autoPlayNext)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tconst nextId = this.$root.$uiAudioPlayerId.filter(id => id > this.registeredId).slice(0, 1)[0];\n\t\t\tif (nextId)\n\t\t\t{\n\t\t\t\tthis.$root.$emit('ui:audioplayer:play', {id: nextId, start: true});\n\t\t\t}\n\n\t\t\treturn true;\n\t\t},\n\t\tpreloadNext()\n\t\t{\n\t\t\tif (this.preloadRequestSent)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tif (!this.registeredId || !this.autoPlayNext)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tthis.preloadRequestSent = true;\n\n\t\t\tconst nextId = this.$root.$uiAudioPlayerId.filter(id => id > this.registeredId).slice(0, 1)[0];\n\t\t\tif (nextId)\n\t\t\t{\n\t\t\t\tthis.$root.$emit('ui:audioplayer:preload', {id: nextId});\n\t\t\t}\n\n\t\t\treturn true;\n\t\t},\n\t\tonPlay(event)\n\t\t{\n\t\t\tif (event.id !== this.id)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (event.start)\n\t\t\t{\n\t\t\t\tthis.stop();\n\t\t\t}\n\n\t\t\tthis.play();\n\t\t},\n\t\tonStop(event)\n\t\t{\n\t\t\tif (event.initiator === this.id)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tthis.stop();\n\t\t},\n\t\tonPause(event)\n\t\t{\n\t\t\tif (event.initiator === this.id)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tthis.pause();\n\t\t},\n\t\tonPreload(event)\n\t\t{\n\t\t\tif (event.id !== this.id)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tthis.loadFile();\n\t\t},\n\t\tsource()\n\t\t{\n\t\t\treturn this.$refs.source;\n\t\t},\n\t\taudioEventRouter(eventName, event)\n\t\t{\n\t\t\tif (\n\t\t\t\teventName === 'durationchange'\n\t\t\t\t|| eventName === 'loadeddata'\n\t\t\t\t|| eventName === 'loadedmetadata'\n\t\t\t)\n\t\t\t{\n\t\t\t\tthis.timeTotal = this.source().duration;\n\t\t\t}\n\t\t\telse if (\n\t\t\t\teventName === 'abort'\n\t\t\t\t|| eventName === 'error'\n\t\t\t)\n\t\t\t{\n\t\t\t\tconsole.error('BxAudioPlayer: load failed', this.id, event);\n\n\t\t\t\tthis.loading = false;\n\t\t\t\tthis.state = State.none;\n\t\t\t\tthis.timeTotal = 0;\n\t\t\t\tthis.preload = 'none';\n\t\t\t}\n\t\t\telse if (\n\t\t\t\teventName === 'canplaythrough'\n\t\t\t)\n\t\t\t{\n\t\t\t\tthis.loading = false;\n\t\t\t\tthis.loaded = true;\n\t\t\t}\n\t\t\telse if (eventName === 'timeupdate')\n\t\t\t{\n\t\t\t\tif (!this.source())\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tthis.timeCurrent = this.source().currentTime;\n\n\t\t\t\tthis.setProgress(Math.round(100/this.timeTotal*this.timeCurrent));\n\n\t\t\t\tif (\n\t\t\t\t\tthis.state === State.play\n\t\t\t\t\t&& this.timeCurrent >= this.timeTotal\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tthis.playNext();\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (eventName === 'pause')\n\t\t\t{\n\t\t\t\tif (this.state !== State.stop)\n\t\t\t\t{\n\t\t\t\t\tthis.state = State.pause;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (eventName === 'play')\n\t\t\t{\n\t\t\t\tthis.state = State.play;\n\n\t\t\t\tif (this.state === State.stop)\n\t\t\t\t{\n\t\t\t\t\tthis.progress = 0;\n\t\t\t\t\tthis.timeCurrent = 0;\n\t\t\t\t}\n\n\t\t\t\tif (this.id > 0)\n\t\t\t\t{\n\t\t\t\t\tthis.$root.$emit('ui:audioplayer:pause', {initiator: this.id});\n\t\t\t\t\tVue.event.$emit('ui:audioplayer:pause', {initiator: this.id});\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tgetObserver()\n\t\t{\n\t\t\tif (this.observer)\n\t\t\t{\n\t\t\t\treturn this.observer;\n\t\t\t}\n\n\t\t\tthis.observer = new IntersectionObserver((entries, observer) =>\n\t\t\t{\n\t\t\t\tentries.forEach((entry) =>\n\t\t\t\t{\n\t\t\t\t\tif (entry.isIntersecting)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (this.preload === \"none\")\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.preload = \"metadata\";\n\t\t\t\t\t\t\tthis.observer.unobserve(entry.target);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},{\n\t\t\t\tthreshold: [0, 1]\n\t\t\t});\n\n\t\t\treturn this.observer;\n\t\t}\n\t},\n\tcomputed:\n\t{\n\t\tState: () => State,\n\t\tseekPosition()\n\t\t{\n\t\t\tif (!this.loaded && !this.seek || this.isMobile)\n\t\t\t{\n\t\t\t\treturn 'display: none'\n\t\t\t}\n\n\t\t\treturn `left: ${this.seek}px;`;\n\t\t},\n\t\tprogressPosition()\n\t\t{\n\t\t\tif (!this.loaded || this.state === State.none)\n\t\t\t{\n\t\t\t\treturn `width: 100%;`;\n\t\t\t}\n\n\t\t\treturn `width: ${this.progressInPixel}px;`;\n\t\t},\n\t\tlabelTime()\n\t\t{\n\t\t\tif (!this.loaded && !this.timeTotal)\n\t\t\t{\n\t\t\t\treturn '--:--';\n\t\t\t}\n\n\t\t\tlet time;\n\t\t\tif (this.state === State.play)\n\t\t\t{\n\t\t\t\ttime = this.timeTotal - this.timeCurrent;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\ttime = this.timeTotal;\n\t\t\t}\n\n\t\t\treturn this.formatTime(time);\n\t\t},\n\t\tisMobile()\n\t\t{\n\t\t\tconst UA = navigator.userAgent.toLowerCase();\n\n\t\t\treturn (\n\t\t\t\tUA.includes('android')\n\t\t\t\t|| UA.includes('iphone')\n\t\t\t\t|| UA.includes('ipad')\n\t\t\t\t|| UA.includes('bitrixmobile')\n\t\t\t)\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div :class=\"['ui-vue-audioplayer-container', {\n\t\t\t\t'ui-vue-audioplayer-container-dark': isDark,\n\t\t\t\t'ui-vue-audioplayer-container-mobile': isMobile,\n\t\t\t}]\" ref=\"body\">\n\t\t\t<div class=\"ui-vue-audioplayer-controls-container\">\n\t\t\t\t<button :class=\"['ui-vue-audioplayer-control', {\n\t\t\t\t\t'ui-vue-audioplayer-control-loader': loading,\n\t\t\t\t\t'ui-vue-audioplayer-control-play': !loading && state !== State.play,\n\t\t\t\t\t'ui-vue-audioplayer-control-pause': !loading && state === State.play,\n\t\t\t\t}]\" @click=\"clickToButton\"></button>\n\t\t\t</div>\n\t\t\t<div class=\"ui-vue-audioplayer-timeline-container\">\n\t\t\t\t<div class=\"ui-vue-audioplayer-track-container\" @click=\"setPosition\" ref=\"track\">\n\t\t\t\t\t<div class=\"ui-vue-audioplayer-track-mask\"></div>\n\t\t\t\t\t<div class=\"ui-vue-audioplayer-track\" :style=\"progressPosition\"></div>\n\t\t\t\t\t<div class=\"ui-vue-audioplayer-track-seek\" :style=\"seekPosition\"></div>\n\t\t\t\t\t<div class=\"ui-vue-audioplayer-track-event\" @mousemove=\"seeking\"></div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"ui-vue-audioplayer-timers-container\">\n\t\t\t\t\t<div class=\"ui-vue-audioplayer-time-current\">{{labelTime}}</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<audio v-if=\"src\" :src=\"src\" class=\"ui-vue-audioplayer-source\" ref=\"source\" :preload=\"preload\"\n\t\t\t\t@abort=\"audioEventRouter('abort', $event)\"\n\t\t\t\t@error=\"audioEventRouter('error', $event)\"\n\t\t\t\t@suspend=\"audioEventRouter('suspend', $event)\"\n\t\t\t\t@canplay=\"audioEventRouter('canplay', $event)\"\n\t\t\t\t@canplaythrough=\"audioEventRouter('canplaythrough', $event)\"\n\t\t\t\t@durationchange=\"audioEventRouter('durationchange', $event)\"\n\t\t\t\t@loadeddata=\"audioEventRouter('loadeddata', $event)\"\n\t\t\t\t@loadedmetadata=\"audioEventRouter('loadedmetadata', $event)\"\n\t\t\t\t@timeupdate=\"audioEventRouter('timeupdate', $event)\"\n\t\t\t\t@play=\"audioEventRouter('play', $event)\"\n\t\t\t\t@playing=\"audioEventRouter('playing', $event)\"\n\t\t\t\t@pause=\"audioEventRouter('pause', $event)\"\n\t\t\t></audio>\n\t\t</div>\n\t`\n});\n"],"names":["State","Object","freeze","play","pause","stop","none","Vue","component","props","id","default","src","autoPlayNext","background","data","isDark","preload","loaded","loading","playAfterLoad","state","progress","progressInPixel","seek","timeCurrent","timeTotal","created","preloadRequestSent","registeredId","registerPlayer","$root","$on","onPlay","event","onStop","onPause","onPreload","mounted","getObserver","observe","$refs","body","beforeDestroy","unregisterPlayer","$off","unobserve","watch","value","preloadNext","methods","loadFile","source","clickToButton","setPosition","pixelPerPercent","track","offsetWidth","setProgress","currentTime","seeking","offsetX","percent","pixel","Math","round","formatTime","second","floor","hour","minute","toString","padStart","$uiAudioPlayerId","Set","sort","a","b","filter","playNext","nextId","slice","$emit","start","initiator","audioEventRouter","eventName","duration","console","error","observer","IntersectionObserver","entries","forEach","entry","isIntersecting","target","threshold","computed","seekPosition","isMobile","progressPosition","labelTime","time","UA","navigator","userAgent","toLowerCase","includes","template"],"mappings":"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"}