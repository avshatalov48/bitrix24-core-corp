{"version":3,"file":"entity-selector.bundle.js","sources":["../src/item/item-collection.js","../src/item/item-node-comparator.js","../src/search/highlighter.js","../src/item/item-badge.js","../src/search/match-field.js","../src/item/item-node.js","../src/search/search-field-index.js","../src/search/word-index.js","../src/search/unicode-words.js","../src/search/search-index.js","../src/search/search-field.js","../src/entity/entity.js","../src/item/item.js","../src/dialog/tabs/base-stub.js","../src/dialog/tabs/default-stub.js","../src/dialog/footer/base-footer.js","../src/dialog/tabs/tab.js","../src/util/animation.js","../src/tag-selector/tag-item.js","../src/tag-selector/tag-selector.js","../src/dialog/navigation.js","../src/dialog/integration/slider-integration.js","../src/dialog/footer/default-footer.js","../src/dialog/tabs/recent-tab.js","../src/search/match-result.js","../src/search/match-index.js","../src/search/search-engine.js","../src/search/search-query.js","../src/dialog/tabs/search-loader.js","../src/dialog/footer/search-tab-footer.js","../src/dialog/tabs/search-tab.js","../src/dialog/dialog.js"],"sourcesContent":["import { Type } from 'main.core';\n\nexport default class ItemCollection<T>\n{\n\tcomparator: Function = null;\n\titems: Array<T> = [];\n\n\tconstructor(comparator: Function = null)\n\t{\n\t\tthis.comparator = Type.isFunction(comparator) ? comparator : null;\n\t}\n\n\tadd(item: T): number\n\t{\n\t\tlet index = -1;\n\t\tif (this.comparator)\n\t\t{\n\t\t\tindex = this.searchIndexToInsert(item);\n\t\t\tthis.items.splice(index, 0, item);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.items.push(item);\n\t\t}\n\n\t\treturn index;\n\t}\n\n\thas(item: T): boolean\n\t{\n\t\treturn this.items.includes(item);\n\t}\n\n\tgetIndex(item: T): number\n\t{\n\t\treturn this.items.indexOf(item);\n\t}\n\n\tgetByIndex(index: number): ?T\n\t{\n\t\tif (Type.isNumber(index) && index >= 0)\n\t\t{\n\t\t\tconst item = this.items[index];\n\t\t\treturn Type.isUndefined(item) ? null : item;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tgetFirst(): ?T\n\t{\n\t\tconst first = this.items[0];\n\n\t\treturn Type.isUndefined(first) ? null : first;\n\t}\n\n\tgetLast(): ?T\n\t{\n\t\tconst last = this.items[this.count() - 1];\n\n\t\treturn Type.isUndefined(last) ? null : last;\n\t}\n\n\tcount(): number\n\t{\n\t\treturn this.items.length;\n\t}\n\n\tdelete(item: T): boolean\n\t{\n\t\tconst index = this.getIndex(item);\n\t\tif (index !== -1)\n\t\t{\n\t\t\tthis.items.splice(index, 1);\n\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tclear(): void\n\t{\n\t\tthis.items = [];\n\t}\n\n\t[Symbol.iterator]()\n\t{\n\t\treturn this.items[Symbol.iterator]();\n\t}\n\n\tforEach(callbackfn: (value: T, index: number, array: T[]) => void, thisArg?: any): void\n\t{\n\t\treturn this.items.forEach(callbackfn, thisArg);\n\t}\n\n\tgetItems(): Array<T>\n\t{\n\t\treturn this.items;\n\t}\n\n\tsearchIndexToInsert(value: T): number\n\t{\n\t\tlet low = 0;\n\t\tlet high = this.items.length;\n\t\twhile (low < high)\n\t\t{\n\t\t\tconst mid = Math.floor((low + high) / 2);\n\t\t\tif (this.comparator(this.items[mid], value) >= 0)\n\t\t\t{\n\t\t\t\tlow = mid + 1;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\thigh = mid;\n\t\t\t}\n\t\t}\n\n\t\treturn low;\n\t}\n}","import { Type } from 'main.core';\nimport type ItemNode from './item-node';\n\nexport default class ItemNodeComparator\n{\n\tstatic makeComparator(orderProperty: string, orderDirection: 'asc' | 'desc')\n\t{\n\t\tconst sortOrder = orderDirection === 'desc' ? 1 : -1;\n\n\t\treturn function(nodeA: ItemNode, nodeB: ItemNode) {\n\t\t\tconst itemA = nodeA.getItem();\n\t\t\tconst itemB = nodeB.getItem();\n\n\t\t\tconst valueA = itemA[orderProperty];\n\t\t\tconst valueB = itemB[orderProperty];\n\n\t\t\tlet result = 0;\n\t\t\tif (Type.isString(valueA))\n\t\t\t{\n\t\t\t\tresult = valueA.localeCompare(valueB);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (Type.isNull(valueA) || Type.isNull(valueB))\n\t\t\t\t{\n\t\t\t\t\tresult = valueA === valueB ? 0 : (Type.isNull(valueA) ? 1 : -1);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tresult = (valueA < valueB) ? -1 : (valueA > valueB ? 1 : 0);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn result * sortOrder;\n\t\t};\n\t}\n\n\tstatic makeMultipleComparator(order: {[key: string]: 'asc' | 'desc'})\n\t{\n\t\tconst props = Object.keys(order);\n\n\t\treturn (a, b) => {\n\t\t\tlet i = 0;\n\t\t\tlet result = 0;\n\t\t\tconst numberOfProperties = props.length;\n\n\t\t\twhile (result === 0 && i < numberOfProperties)\n\t\t\t{\n\t\t\t\tconst orderProperty = props[i];\n\t\t\t\tconst orderDirection = order[props[i]];\n\n\t\t\t\tresult = this.makeComparator(orderProperty, orderDirection)(a, b);\n\t\t\t\ti += 1;\n\t\t\t}\n\n\t\t\treturn result;\n\t\t};\n\t}\n}","import { Type, Text } from 'main.core';\nimport type MatchIndex from './match-index';\nimport ItemCollection from '../item/item-collection';\n\nexport default class Highlighter\n{\n\tstatic mark(text: string, matches: ItemCollection<MatchIndex>)\n\t{\n\t\tif (!Type.isStringFilled(text) || !matches || matches.count() === 0)\n\t\t{\n\t\t\treturn text;\n\t\t}\n\n\t\tlet result = '';\n\t\tlet offset = 0;\n\t\tmatches.forEach((match: MatchIndex) => {\n\n\t\t\tif (offset > match.getStartIndex())\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// console.log(match.getStartIndex(), match.getEndIndex(), match.getQueryWord());\n\n\t\t\tresult += Text.encode(text.substring(offset, match.getStartIndex()));\n\t\t\tresult += '<span class=\"ui-selector-highlight-mark\">';\n\t\t\tresult += Text.encode(text.substring(match.getStartIndex(), match.getEndIndex()));\n\t\t\tresult += '</span>';\n\n\t\t\toffset = match.getEndIndex();\n\n\t\t});\n\n\t\tresult += Text.encode(text.substring(offset));\n\n\t\t// console.log(result);\n\n\t\treturn result;\n\t}\n}","import { Tag, Type, Dom } from 'main.core';\nimport type { ItemBadgeOptions } from './item-badge-options';\n\nexport default class ItemBadge\n{\n\ttitle: string = '';\n\ttextColor: ?string = null;\n\tbgColor: ?string = null;\n\tcontainer: ?HTMLElement = null;\n\n\tconstructor(badgeOptions: ItemBadgeOptions)\n\t{\n\t\tconst options: ItemBadgeOptions = Type.isPlainObject(badgeOptions) ? badgeOptions : {};\n\n\t\tthis.setTitle(options.title);\n\t\tthis.setTextColor(options.textColor);\n\t\tthis.setBgColor(options.bgColor);\n\t}\n\n\tgetTitle(): string\n\t{\n\t\treturn this.title;\n\t}\n\n\tsetTitle(title: string): this\n\t{\n\t\tif (Type.isStringFilled(title))\n\t\t{\n\t\t\tthis.title = title;\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tgetTextColor(): ?string\n\t{\n\t\treturn this.textColor;\n\t}\n\n\tsetTextColor(textColor: ?string): this\n\t{\n\t\tif (Type.isString(textColor) || textColor === null)\n\t\t{\n\t\t\tthis.textColor = textColor;\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tgetBgColor(): ?string\n\t{\n\t\treturn this.bgColor;\n\t}\n\n\tsetBgColor(bgColor: ?string): this\n\t{\n\t\tif (Type.isString(bgColor) || bgColor === null)\n\t\t{\n\t\t\tthis.bgColor = bgColor;\n\t\t}\n\n\t\treturn this;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tconst container = Tag.render`<span class=\"ui-selector-item-badge\"></span>`;\n\n\t\tcontainer.textContent = this.getTitle();\n\t\tDom.style(container, 'color', this.getTextColor());\n\t\tDom.style(container, 'background-color', this.getBgColor());\n\n\t\treturn container;\n\t}\n}","import { Type } from 'main.core';\nimport ItemCollection from '../item/item-collection';\n\nimport type SearchField from './search-field';\nimport type MatchIndex from './match-index';\n\nconst comparator = (a: MatchIndex, b: MatchIndex) => {\n\n\tif (a.getStartIndex() === b.getStartIndex())\n\t{\n\t\treturn a.getEndIndex() > b.getEndIndex() ? 1 : -1;\n\t}\n\telse\n\t{\n\t\treturn a.getStartIndex() > b.getStartIndex() ? -1 : 1;\n\t}\n};\n\nexport default class MatchField\n{\n\tfield: SearchField = null;\n\tmatchIndexes: ItemCollection<MatchIndex> = new ItemCollection(comparator);\n\n\tconstructor(field: SearchField, indexes: MatchIndex[] = [])\n\t{\n\t\tthis.field = field;\n\t\tthis.addIndexes(indexes);\n\t}\n\n\tgetField()\n\t{\n\t\treturn this.field;\n\t}\n\n\tgetMatches()\n\t{\n\t\treturn this.matchIndexes;\n\t}\n\n\taddIndex(matchIndex: MatchIndex)\n\t{\n\t\tthis.matchIndexes.add(matchIndex);\n\t}\n\n\taddIndexes(matchIndexes: MatchIndex[])\n\t{\n\t\tif (Type.isArray(matchIndexes))\n\t\t{\n\t\t\tmatchIndexes.forEach(matchIndex => {\n\t\t\t\tthis.addIndex(matchIndex);\n\t\t\t});\n\t\t}\n\t}\n}","import { ajax as Ajax, Cache, Dom, Runtime, Tag, Type } from 'main.core';\nimport { Loader } from 'main.loader';\n\nimport ItemCollection from './item-collection';\nimport ItemNodeComparator from './item-node-comparator';\nimport Highlighter from '../search/highlighter';\nimport ItemBadge from './item-badge';\nimport MatchField from '../search/match-field';\n\nimport type Item from './item';\nimport type Tab from '../dialog/tabs/tab';\nimport type Dialog from '../dialog/dialog';\nimport type { ItemOptions } from './item-options';\nimport type { ItemNodeOptions } from './item-node-options';\nimport type { ItemBadgeOptions } from './item-badge-options';\n\nexport class RenderMode\n{\n\tstatic PARTIAL = 'partial';\n\tstatic OVERRIDE = 'override';\n}\n\nexport default class ItemNode\n{\n\titem: Item = null;\n\ttab: Tab = null;\n\tcache = new Cache.MemoryCache();\n\tparentNode: ItemNode = null;\n\n\tchildren: ItemCollection<ItemNode> = null;\n\tchildItems: WeakMap<Item, ItemNode> = new WeakMap(); // for the fast access\n\n\tloaded: boolean = false;\n\tdynamic: boolean = false;\n\tdynamicPromise: ?Promise = null;\n\tloader: Loader = null;\n\topen: boolean = false;\n\tautoOpen: boolean = false;\n\tfocused: boolean = false;\n\n\trenderMode: RenderMode = RenderMode.PARTIAL;\n\ttitle: ?string = null;\n\tsubtitle: ?string = null;\n\tcaption: ?string = null;\n\tsupertitle: ?string = null;\n\tavatar: ?string = null;\n\tlink: ?string = null;\n\tlinkTitle: ?string = null;\n\ttextColor: ?string = null;\n\tbadges: ItemBadgeOptions[] = null;\n\n\thighlights: MatchField[] = [];\n\n\trendered: false;\n\trenderWithDebounce = Runtime.debounce(this.render, 50, this);\n\n\tconstructor(item: Item, nodeOptions: ItemNodeOptions)\n\t{\n\t\tconst options: ItemNodeOptions = Type.isPlainObject(nodeOptions) ? nodeOptions : {};\n\n\t\tif (Type.isObject(item))\n\t\t{\n\t\t\tthis.item = item;\n\t\t}\n\n\t\tlet comparator = null;\n\t\tif (Type.isFunction(options.itemOrder))\n\t\t{\n\t\t\tcomparator = options.itemOrder;\n\t\t}\n\t\telse if (Type.isPlainObject(options.itemOrder))\n\t\t{\n\t\t\tcomparator = ItemNodeComparator.makeMultipleComparator(options.itemOrder);\n\t\t}\n\n\t\tthis.children = new ItemCollection(comparator);\n\n\t\tthis.renderMode = options.renderMode === RenderMode.OVERRIDE ? RenderMode.OVERRIDE : RenderMode.PARTIAL;\n\t\tif (this.renderMode === RenderMode.OVERRIDE)\n\t\t{\n\t\t\tthis.title = '';\n\t\t\tthis.subtitle = '';\n\t\t\tthis.caption = '';\n\t\t\tthis.supertitle = '';\n\t\t\tthis.avatar = '';\n\t\t\tthis.textColor = '';\n\t\t\tthis.link = '';\n\t\t\tthis.linkTitle = '';\n\t\t\tthis.badges = [];\n\t\t}\n\n\t\tthis.setTitle(options.title);\n\t\tthis.setSubtitle(options.subtitle);\n\t\tthis.setSupertitle(options.supertitle);\n\t\tthis.setCaption(options.caption);\n\t\tthis.setAvatar(options.avatar);\n\t\tthis.setTextColor(options.textColor);\n\t\tthis.setLink(options.link);\n\t\tthis.setLinkTitle(options.linkTitle);\n\t\tthis.setBadges(options.badges);\n\n\t\tthis.setDynamic(options.dynamic);\n\t\tthis.setOpen(options.open);\n\t}\n\n\tgetItem(): Item\n\t{\n\t\treturn this.item;\n\t}\n\n\tisRoot(): boolean\n\t{\n\t\treturn this.getParentNode() === null;\n\t}\n\n\tgetDialog(): Dialog\n\t{\n\t\treturn this.getTab().getDialog();\n\t}\n\n\tsetTab(tab: Tab): this\n\t{\n\t\tthis.tab = tab;\n\n\t\treturn this;\n\t}\n\n\tgetTab(): Tab\n\t{\n\t\treturn this.tab;\n\t}\n\n\tgetParentNode(): ?ItemNode\n\t{\n\t\treturn this.parentNode;\n\t}\n\n\tsetParentNode(parentNode: ItemNode): this\n\t{\n\t\tthis.parentNode = parentNode;\n\n\t\treturn this;\n\t}\n\n\tgetNextSibling(): ?ItemNode\n\t{\n\t\tif (!this.getParentNode())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst siblings = this.getParentNode().getChildren();\n\t\tconst index = siblings.getIndex(this);\n\n\t\treturn siblings.getByIndex(index + 1);\n\t}\n\n\tgetPreviousSibling(): ?ItemNode\n\t{\n\t\tif (!this.getParentNode())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst siblings = this.getParentNode().getChildren();\n\t\tconst index = siblings.getIndex(this);\n\n\t\treturn siblings.getByIndex(index - 1);\n\t}\n\n\taddChildren(children: ItemOptions[])\n\t{\n\t\tif (!Type.isArray(children))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tchildren.forEach((childOptions: ItemOptions) => {\n\t\t\tdelete childOptions.tabs;\n\t\t\tconst childItem = this.getDialog().addItem(childOptions);\n\n\t\t\tconst childNode = this.addItem(childItem, childOptions.nodeOptions);\n\t\t\tchildNode.addChildren(childOptions.children);\n\t\t});\n\t}\n\n\taddChild(child: ItemNode): ItemNode\n\t{\n\t\tif (!(child instanceof ItemNode))\n\t\t{\n\t\t\tthrow new Error('EntitySelector.ItemNode: an item must be an instance of EntitySelector.ItemNode.');\n\t\t}\n\n\t\tif (this.isChildOf(child) || child === this)\n\t\t{\n\t\t\tthrow new Error('EntitySelector.ItemNode: a child item cannot be a parent of current item.');\n\t\t}\n\n\t\tif (this.getChildren().has(child) || this.childItems.has(child.getItem()))\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tthis.getChildren().add(child);\n\t\tthis.childItems.set(child.getItem(), child);\n\n\t\tchild.setTab(this.getTab());\n\t\tchild.setParentNode(this);\n\n\t\tif (this.isRendered())\n\t\t{\n\t\t\tthis.renderWithDebounce();\n\t\t}\n\n\t\treturn child;\n\t}\n\n\tgetDepthLevel(): number\n\t{\n\t\treturn this.isRoot() ? 0 : this.getParentNode().getDepthLevel() + 1;\n\t}\n\n\taddItem(item: Item, nodeOptions: ItemNodeOptions): ItemNode\n\t{\n\t\tlet itemNode = this.childItems.get(item);\n\t\tif (!itemNode)\n\t\t{\n\t\t\titemNode = item.createNode(nodeOptions);\n\t\t\tthis.addChild(itemNode);\n\t\t}\n\n\t\treturn itemNode;\n\t}\n\n\thasItem(item: Item): boolean\n\t{\n\t\treturn this.childItems.has(item);\n\t}\n\n\tremoveChild(child: ItemNode): boolean\n\t{\n\t\tif (!this.getChildren().has(child))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\twhile (child.getFirstChild())\n\t\t{\n\t\t\tchild.removeChild(child.getFirstChild());\n\t\t}\n\n\t\tif (child.isFocused())\n\t\t{\n\t\t\tchild.unfocus();\n\t\t}\n\n\t\tchild.setParentNode(null);\n\t\tchild.getItem().removeNode(child);\n\t\tthis.getChildren().delete(child);\n\t\tthis.childItems.delete(child.getItem());\n\n\t\tif (this.isRendered())\n\t\t{\n\t\t\tthis.render();\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tremoveChildren(): void\n\t{\n\t\twhile (this.getFirstChild())\n\t\t{\n\t\t\tthis.removeChild(this.getFirstChild());\n\t\t}\n\t}\n\n\thasChild(child: ItemNode): boolean\n\t{\n\t\treturn this.getChildren().has(child);\n\t}\n\n\tisChildOf(parent: ItemNode): boolean\n\t{\n\t\tlet parentNode = this.getParentNode();\n\t\twhile (parentNode !== null)\n\t\t{\n\t\t\tif (parentNode === parent)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tparentNode = parentNode.getParentNode();\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tgetFirstChild(): ?ItemNode\n\t{\n\t\treturn this.children.getFirst();\n\t}\n\n\tgetLastChild(): ?ItemNode\n\t{\n\t\treturn this.children.getLast();\n\t}\n\n\tgetChildren(): ItemCollection\n\t{\n\t\treturn this.children;\n\t}\n\n\thasChildren(): boolean\n\t{\n\t\treturn this.children.count() > 0;\n\t}\n\n\tloadChildren()\n\t{\n\t\tif (!this.isDynamic())\n\t\t{\n\t\t\tthrow new Error('EntitySelector.ItemNode.loadChildren: an item node is not dynamic.');\n\t\t}\n\n\t\tif (this.dynamicPromise)\n\t\t{\n\t\t\treturn this.dynamicPromise;\n\t\t}\n\n\t\tthis.dynamicPromise = Ajax.runAction('ui.entityselector.getChildren', {\n\t\t\tjson: {\n\t\t\t\tparentItem: this.getItem(),\n\t\t\t\tdialog: this.getDialog()\n\t\t\t},\n\t\t\tgetParameters: {\n\t\t\t\tcontext: this.getDialog().getContext()\n\t\t\t}\n\t\t});\n\n\t\tthis.dynamicPromise.then((response) => {\n\t\t\tif (response && response.data && Type.isPlainObject(response.data.dialog))\n\t\t\t{\n\t\t\t\tthis.addChildren(response.data.dialog.items);\n\t\t\t\tthis.render();\n\t\t\t}\n\t\t\tthis.loaded = true;\n\t\t});\n\n\t\tthis.dynamicPromise.catch((error) => {\n\t\t\tthis.loaded = false;\n\t\t\tthis.dynamicPromise = null;\n\t\t\tconsole.error(error);\n\t\t});\n\n\t\treturn this.dynamicPromise;\n\t}\n\n\tsetOpen(open: boolean): this\n\t{\n\t\tif (Type.isBoolean(open))\n\t\t{\n\t\t\tif (open && this.isDynamic() && !this.isLoaded())\n\t\t\t{\n\t\t\t\tthis.setAutoOpen(true);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.open = open;\n\t\t\t}\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tisOpen(): boolean\n\t{\n\t\treturn this.open;\n\t}\n\n\tisAutoOpen(): boolean\n\t{\n\t\treturn this.autoOpen && this.isDynamic() && !this.isLoaded();\n\t}\n\n\tsetAutoOpen(autoOpen: boolean): this\n\t{\n\t\tif (Type.isBoolean(autoOpen))\n\t\t{\n\t\t\tthis.autoOpen = autoOpen;\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tsetDynamic(dynamic: boolean): this\n\t{\n\t\tif (Type.isBoolean(dynamic))\n\t\t{\n\t\t\tthis.dynamic = dynamic;\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tisDynamic(): boolean\n\t{\n\t\treturn this.dynamic;\n\t}\n\n\tisLoaded(): boolean\n\t{\n\t\treturn this.loaded;\n\t}\n\n\tgetLoader(): Loader\n\t{\n\t\tif (this.loader === null)\n\t\t{\n\t\t\tthis.loader = new Loader({\n\t\t\t\ttarget: this.getIndicatorContainer(),\n\t\t\t\tsize: 30\n\t\t\t});\n\t\t}\n\n\t\treturn this.loader;\n\t}\n\n\tshowLoader(): void\n\t{\n\t\tthis.getLoader().show();\n\t\tDom.addClass(this.getIndicatorContainer(), 'ui-selector-item-indicator-hidden');\n\t}\n\n\thideLoader(): void\n\t{\n\t\tthis.getLoader().hide();\n\t\tDom.removeClass(this.getIndicatorContainer(), 'ui-selector-item-indicator-hidden');\n\t}\n\n\tdestroyLoader(): void\n\t{\n\t\tthis.getLoader().destroy();\n\t\tthis.loader = null;\n\t\tDom.removeClass(this.getIndicatorContainer(), 'ui-selector-item-indicator-hidden');\n\t}\n\n\texpand(): void\n\t{\n\t\tif (this.isOpen() || (!this.hasChildren() && !this.isDynamic()))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.isDynamic() && !this.isLoaded())\n\t\t{\n\t\t\tthis.loadChildren().then(() => {\n\t\t\t\tthis.destroyLoader();\n\t\t\t\tthis.expand();\n\t\t\t});\n\n\t\t\tthis.showLoader();\n\n\t\t\treturn;\n\t\t}\n\n\t\tDom.style(this.getChildrenContainer(), 'height', `${this.getChildrenContainer().scrollHeight}px`);\n\t\tDom.addClass(this.getOuterContainer(), 'ui-selector-item-box-open');\n\t\tthis.setOpen(true);\n\t}\n\n\tcollapse(): void\n\t{\n\t\tif (!this.isOpen())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tDom.style(this.getChildrenContainer(), 'height', `${this.getChildrenContainer().offsetHeight}px`);\n\n\t\trequestAnimationFrame(() => {\n\t\t\tDom.removeClass(this.getOuterContainer(), 'ui-selector-item-box-open');\n\t\t\tDom.style(this.getChildrenContainer(), 'height', null);\n\n\t\t\tthis.setOpen(false);\n\t\t});\n\t}\n\n\trender(): void\n\t{\n\t\tif (this.isRoot())\n\t\t{\n\t\t\tthis.renderRoot();\n\t\t\treturn;\n\t\t}\n\n\t\tthis.getTitleContainer().textContent = Type.isString(this.getTitle()) ? this.getTitle() : '';\n\t\tthis.getSubtitleContainer().textContent = Type.isString(this.getSubtitle()) ? this.getSubtitle() : '';\n\t\tthis.getSupertitleContainer().textContent = Type.isString(this.getSupertitle()) ? this.getSupertitle() : '';\n\t\tthis.getCaptionContainer().textContent = Type.isString(this.getCaption()) ? this.getCaption() : '';\n\n\t\tif (Type.isStringFilled(this.getTextColor()))\n\t\t{\n\t\t\tDom.style(this.getTitleContainer(), 'color', this.getTextColor());\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.style(this.getTitleContainer(), 'color', null);\n\t\t}\n\n\t\tif (Type.isStringFilled(this.getAvatar()))\n\t\t{\n\t\t\tDom.style(this.getAvatarContainer(), 'background-image', `url('${this.getAvatar()}')`);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.style(this.getAvatarContainer(), 'background-image', null);\n\t\t}\n\n\t\tif (this.hasChildren() || this.isDynamic())\n\t\t{\n\t\t\tDom.addClass(this.getOuterContainer(), 'ui-selector-item-box-has-children');\n\t\t\tif (this.getDepthLevel() >= this.getTab().getItemMaxDepth())\n\t\t\t{\n\t\t\t\tDom.addClass(this.getOuterContainer(), 'ui-selector-item-box-max-depth');\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.removeClass(\n\t\t\t\tthis.getOuterContainer(),\n\t\t\t\t['ui-selector-item-box-has-children', 'ui-selector-item-box-max-depth']\n\t\t\t);\n\t\t}\n\n\t\tthis.highlight();\n\n\t\tif (this.isAutoOpen())\n\t\t{\n\t\t\tthis.expand();\n\t\t\tthis.setAutoOpen(false);\n\t\t}\n\n\t\tthis.renderChildren();\n\n\t\tthis.rendered = true;\n\t}\n\n\t/**\n\t * @private\n\t */\n\trenderRoot(): void\n\t{\n\t\tthis.renderChildren();\n\t\tthis.rendered = true;\n\n\t\tconst stub = this.getTab().getStub();\n\t\tif (stub && stub.isAutoShow() && (this.getDialog().isLoaded() || !this.getDialog().hasDynamicLoad()))\n\t\t{\n\t\t\tif (this.hasChildren())\n\t\t\t{\n\t\t\t\tstub.hide();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tstub.show();\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t */\n\trenderChildren(): void\n\t{\n\t\tDom.clean(this.getChildrenContainer());\n\n\t\tif (this.hasChildren())\n\t\t{\n\t\t\tthis.getChildren().forEach((child: ItemNode) => {\n\t\t\t\tchild.render();\n\t\t\t\tDom.append(child.getOuterContainer(), this.getChildrenContainer());\n\t\t\t});\n\t\t}\n\t}\n\n\tisRendered(): boolean\n\t{\n\t\treturn this.rendered && this.getDialog() && this.getDialog().isRendered();\n\t}\n\n\tenableRender(): void\n\t{\n\t\tthis.rendered = true;\n\t}\n\n\tdisableRender(): void\n\t{\n\t\tthis.rendered = false;\n\t}\n\n\tgetRenderMode(): RenderMode\n\t{\n\t\treturn this.renderMode;\n\t}\n\n\tgetTitle(): string\n\t{\n\t\treturn this.title !== null ? this.title : this.getItem().getTitle();\n\t}\n\n\tsetTitle(title: string): this\n\t{\n\t\tif (Type.isString(title) || title === null)\n\t\t{\n\t\t\tthis.title = title;\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tgetSubtitle(): string\n\t{\n\t\treturn this.subtitle !== null ? this.subtitle : this.getItem().getSubtitle();\n\t}\n\n\tsetSubtitle(subtitle: string): this\n\t{\n\t\tif (Type.isString(subtitle) || subtitle === null)\n\t\t{\n\t\t\tthis.subtitle = subtitle;\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tgetSupertitle(): string\n\t{\n\t\treturn this.supertitle !== null ? this.supertitle : this.getItem().getSupertitle();\n\t}\n\n\tsetSupertitle(supertitle: string): this\n\t{\n\t\tif (Type.isString(supertitle) || supertitle === null)\n\t\t{\n\t\t\tthis.supertitle = supertitle;\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tgetAvatar(): ?string\n\t{\n\t\treturn this.avatar !== null ? this.avatar : this.getItem().getAvatar();\n\t}\n\n\tsetAvatar(avatar: ?string): this\n\t{\n\t\tif (Type.isString(avatar) || avatar === null)\n\t\t{\n\t\t\tthis.avatar = avatar;\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tgetTextColor(): ?string\n\t{\n\t\treturn this.textColor !== null ? this.textColor : this.getItem().getTextColor();\n\t}\n\n\tsetTextColor(textColor: ?string): this\n\t{\n\t\tif (Type.isString(textColor) || textColor === null)\n\t\t{\n\t\t\tthis.textColor = textColor;\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tgetCaption(): string\n\t{\n\t\treturn this.caption !== null ? this.caption : this.getItem().getCaption();\n\t}\n\n\tsetCaption(caption: string): this\n\t{\n\t\tif (Type.isString(caption) || caption === null)\n\t\t{\n\t\t\tthis.caption = caption;\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tgetLink(): string\n\t{\n\t\treturn this.link !== null ? this.getItem().replaceMacros(this.link) : this.getItem().getLink();\n\t}\n\n\tsetLink(link: string): this\n\t{\n\t\tif (Type.isString(link) || link === null)\n\t\t{\n\t\t\tthis.link = link;\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tgetLinkTitle(): string\n\t{\n\t\treturn this.linkTitle !== null ? this.linkTitle : this.getItem().getLinkTitle();\n\t}\n\n\tsetLinkTitle(title: string): this\n\t{\n\t\tif (Type.isString(title) || title === null)\n\t\t{\n\t\t\tthis.linkTitle = title;\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tgetBadges(): ItemBadge[]\n\t{\n\t\treturn this.badges !== null ? this.badges : this.getItem().getBadges();\n\t}\n\n\tsetBadges(badges: ?ItemBadgeOptions[]): this\n\t{\n\t\tif (Type.isArray(badges))\n\t\t{\n\t\t\tthis.badges = [];\n\t\t\tbadges.forEach(badge => {\n\t\t\t\tthis.badges.push(new ItemBadge(badge));\n\t\t\t});\n\t\t}\n\t\telse if (badges === null)\n\t\t{\n\t\t\tthis.badges = null;\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tgetOuterContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('outer-container', () => {\n\n\t\t\tlet className = '';\n\n\t\t\tif (this.hasChildren() || this.isDynamic())\n\t\t\t{\n\t\t\t\tclassName += ' ui-selector-item-box-has-children';\n\t\t\t\tif (this.getDepthLevel() >= this.getTab().getItemMaxDepth())\n\t\t\t\t{\n\t\t\t\t\tclassName += ' ui-selector-item-box-max-depth';\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (this.getItem().isSelected())\n\t\t\t{\n\t\t\t\tclassName += ' ui-selector-item-box-selected';\n\t\t\t}\n\n\t\t\tif (this.isOpen())\n\t\t\t{\n\t\t\t\tclassName += ' ui-selector-item-box-open';\n\t\t\t}\n\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-selector-item-box${className}\">\n\t\t\t\t\t${this.getContainer()}\n\t\t\t\t\t${this.getChildrenContainer()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetChildrenContainer(): HTMLElement\n\t{\n\t\tif (this.isRoot() && this.getTab())\n\t\t{\n\t\t\treturn this.getTab().getItemsContainer();\n\t\t}\n\n\t\treturn this.cache.remember('children-container', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-selector-item-children\" ontransitionend=\"${this.handleTransitionEnd.bind(this)}\"></div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('container', () => {\n\n\t\t\treturn Tag.render`\n\t\t\t\t<div \n\t\t\t\t\tclass=\"ui-selector-item\" \n\t\t\t\t\tonclick=\"${this.handleClick.bind(this)}\"\n\t\t\t\t\tonmouseenter=\"${this.handleMouseEnter.bind(this)}\"\n\t\t\t\t\tonmouseleave=\"${this.handleMouseLeave.bind(this)}\"\n\t\t\t\t>\n\t\t\t\t\t${this.getAvatarContainer()}\n\t\t\t\t\t<div class=\"ui-selector-item-titles\">\n\t\t\t\t\t\t${this.getSupertitleContainer()}\n\t\t\t\t\t\t<div class=\"ui-selector-item-title-box\">\n\t\t\t\t\t\t\t${this.getTitleContainer()}\n\t\t\t\t\t\t\t${Type.isArrayFilled(this.getBadges()) ? this.getBadgeContainer() : ''}\n\t\t\t\t\t\t\t${this.getCaptionContainer()}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t${this.getSubtitleContainer()}\n\t\t\t\t\t</div>\n\t\t\t\t\t${Type.isStringFilled(this.getLink()) ? this.getLinkContainer() : ''}\n\t\t\t\t\t${this.getIndicatorContainer()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetAvatarContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('avatar', () => {\n\t\t\t return Tag.render`\n\t\t\t\t<div class=\"ui-selector-item-avatar\"></div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetTitleContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('title', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-selector-item-title\"></div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetSubtitleContainer()\n\t{\n\t\treturn this.cache.remember('subtitle', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-selector-item-subtitle\"></div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetSupertitleContainer()\n\t{\n\t\treturn this.cache.remember('supertitle', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-selector-item-supertitle\"></div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetCaptionContainer()\n\t{\n\t\treturn this.cache.remember('caption', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-selector-item-caption\"></div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetIndicatorContainer()\n\t{\n\t\treturn this.cache.remember('indicator', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-selector-item-indicator\"></div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetBadgeContainer()\n\t{\n\t\treturn this.cache.remember('badge', () => {\n\n\t\t\tconst badges = [];\n\n\t\t\tthis.getBadges().forEach((badge: ItemBadge) => {\n\t\t\t\tbadge.render();\n\t\t\t\tbadges.push(badge.render());\n\t\t\t});\n\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-selector-item-badges\">${badges}</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetLinkContainer()\n\t{\n\t\treturn this.cache.remember('link', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<a \n\t\t\t\t\tclass=\"ui-selector-item-link\"\n\t\t\t\t\thref=\"${this.getLink()}\" \n\t\t\t\t\ttarget=\"_blank\"\n\t\t\t\t\tonclick=\"${this.handleLinkClick.bind(this)}\"\n\t\t\t\t>${this.getLinkTextContainer()}</a>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetLinkTextContainer()\n\t{\n\t\treturn this.cache.remember('link-text', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<span class=\"ui-selector-item-link-text\">${this.getLinkTitle()}</span>\n\t\t\t`;\n\t\t});\n\t}\n\n\tshowLink()\n\t{\n\t\tif (Type.isStringFilled(this.getLink()))\n\t\t{\n\t\t\tDom.addClass(this.getLinkContainer(), 'ui-selector-item-link--show');\n\t\t\trequestAnimationFrame(() => {\n\t\t\t\trequestAnimationFrame(() => {\n\t\t\t\t\tDom.addClass(this.getLinkContainer(), 'ui-selector-item-link--animate');\n\t\t\t\t});\n\t\t\t});\n\n\t\t}\n\t}\n\n\thideLink()\n\t{\n\t\tif (Type.isStringFilled(this.getLink()))\n\t\t{\n\t\t\tDom.removeClass(\n\t\t\t\tthis.getLinkContainer(), ['ui-selector-item-link--show', 'ui-selector-item-link--animate']\n\t\t\t);\n\t\t}\n\t}\n\n\tsetHighlights(highlights: MatchField[])\n\t{\n\t\tthis.highlights = highlights;\n\t}\n\n\tgetHighlights(): MatchField[]\n\t{\n\t\treturn this.highlights;\n\t}\n\n\thighlight(): void\n\t{\n\t\tthis.getHighlights().forEach(matchField => {\n\t\t\tconst field = matchField.getField();\n\t\t\tconst fieldName = field.getName();\n\n\t\t\tif (field.isCustom())\n\t\t\t{\n\t\t\t\tconst text = this.getItem().getCustomData().get(fieldName);\n\t\t\t\tthis.getSubtitleContainer().innerHTML = Highlighter.mark(text, matchField.getMatches());\n\t\t\t}\n\t\t\telse if (field.getName() === 'title')\n\t\t\t{\n\t\t\t\tthis.getTitleContainer().innerHTML =\n\t\t\t\t\tHighlighter.mark(this.getItem().getTitle(), matchField.getMatches())\n\t\t\t\t;\n\t\t\t}\n\t\t\telse if (field.getName() === 'subtitle')\n\t\t\t{\n\t\t\t\tthis.getSubtitleContainer().innerHTML =\n\t\t\t\t\tHighlighter.mark(this.getItem().getSubtitle(), matchField.getMatches())\n\t\t\t\t;\n\t\t\t}\n\t\t});\n\t}\n\n\tselect(): void\n\t{\n\t\tif (this.hasChildren() || this.isDynamic())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tDom.addClass(this.getOuterContainer(), 'ui-selector-item-box-selected');\n\t}\n\n\tdeselect(): void\n\t{\n\t\tif (this.hasChildren() || this.isDynamic())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tDom.removeClass(this.getOuterContainer(), 'ui-selector-item-box-selected');\n\t}\n\n\tfocus(): void\n\t{\n\t\tif (this.isFocused())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.focused = true;\n\t\tDom.addClass(this.getOuterContainer(), 'ui-selector-item-box-focused');\n\n\t\tthis.getDialog().emit('ItemNode:onFocus', { node: this });\n\t}\n\n\tunfocus(): void\n\t{\n\t\tif (!this.isFocused())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.focused = false;\n\t\tDom.removeClass(this.getOuterContainer(), 'ui-selector-item-box-focused');\n\n\t\tthis.getDialog().emit('ItemNode:onUnfocus', { node: this });\n\t}\n\n\tisFocused(): boolean\n\t{\n\t\treturn this.focused;\n\t}\n\n\tclick()\n\t{\n\t\tif (this.hasChildren() || this.isDynamic())\n\t\t{\n\t\t\tif (this.isOpen())\n\t\t\t{\n\t\t\t\tthis.collapse();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.expand();\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (this.getItem().isSelected())\n\t\t\t{\n\t\t\t\tthis.getItem().deselect();\n\t\t\t\tif (this.getDialog().shouldHideOnDeselect())\n\t\t\t\t{\n\t\t\t\t\tthis.getDialog().hide();\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.getItem().select();\n\n\t\t\t\tif (this.getDialog().shouldClearSearchOnSelect())\n\t\t\t\t{\n\t\t\t\t\tthis.getDialog().clearSearch();\n\t\t\t\t}\n\n\t\t\t\tif (this.getDialog().shouldHideOnSelect())\n\t\t\t\t{\n\t\t\t\t\tthis.getDialog().hide();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.getDialog().focusSearch();\n\t}\n\n\tscrollIntoView()\n\t{\n\t\tconst tabContainer = this.getTab().getContainer();\n\t\tconst nodeContainer = this.getContainer();\n\n\t\tconst tabRect = Dom.getPosition(tabContainer);\n\t\tconst nodeRect = Dom.getPosition(nodeContainer);\n\t\tconst margin = 9; // 'ui-selector-items' padding - 'ui-selector-item' margin = 10 - 1\n\n\t\tif (nodeRect.top < tabRect.top) // scroll up\n\t\t{\n\t\t\ttabContainer.scrollTop -= (tabRect.top - nodeRect.top + margin);\n\t\t}\n\t\telse if (nodeRect.bottom > tabRect.bottom) // scroll down\n\t\t{\n\t\t\ttabContainer.scrollTop += nodeRect.bottom - tabRect.bottom + margin;\n\t\t}\n\t}\n\n\thandleClick(): void\n\t{\n\t\tthis.click();\n\t}\n\n\thandleLinkClick(event: MouseEvent): void\n\t{\n\t\tthis.getDialog().emit('ItemNode:onLinkClick', { node: this, event });\n\t\tevent.stopPropagation();\n\t}\n\n\thandleTransitionEnd(event: TransitionEvent): void\n\t{\n\t\tif (event.propertyName === 'height')\n\t\t{\n\t\t\tDom.style(this.getChildrenContainer(), 'height', null);\n\t\t}\n\t}\n\n\thandleMouseEnter(): void\n\t{\n\t\tthis.focus();\n\t\tthis.showLink();\n\t}\n\n\thandleMouseLeave(): void\n\t{\n\t\tthis.unfocus();\n\t\tthis.hideLink();\n\t}\n}","import type SearchField from './search-field';\nimport type WordIndex from './word-index';\n\nexport default class SearchFieldIndex\n{\n\tfield: SearchField = null;\n\tindexes: WordIndex[] = [];\n\n\tconstructor(field: SearchField, indexes: WordIndex[] = [])\n\t{\n\t\tthis.field = field;\n\t\tthis.addIndexes(indexes);\n\t}\n\n\tgetField(): SearchField\n\t{\n\t\treturn this.field;\n\t}\n\n\tgetIndexes(): WordIndex[]\n\t{\n\t\treturn this.indexes;\n\t}\n\n\taddIndex(index: WordIndex)\n\t{\n\t\tthis.getIndexes().push(index);\n\t}\n\n\taddIndexes(indexes: WordIndex[])\n\t{\n\t\tindexes.forEach(index => {\n\t\t\tthis.addIndex(index);\n\t\t});\n\t}\n}","import { Type } from 'main.core';\n\nexport default class WordIndex\n{\n\tword: string = '';\n\tstartIndex: number = 0;\n\n\tconstructor(word: string, startIndex: number)\n\t{\n\t\tthis.setWord(word);\n\t\tthis.setStartIndex(startIndex);\n\t}\n\n\tgetWord(): string\n\t{\n\t\treturn this.word;\n\t}\n\n\tsetWord(word: string): this\n\t{\n\t\tif (Type.isStringFilled(word))\n\t\t{\n\t\t\tthis.word = word;\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tgetStartIndex(): number\n\t{\n\t\treturn this.startIndex;\n\t}\n\n\tsetStartIndex(index: number): this\n\t{\n\t\tif (Type.isNumber(index) && index >= 0)\n\t\t{\n\t\t\tthis.startIndex = index;\n\t\t}\n\n\t\treturn this;\n\t}\n}","/**\n * @license\n * Lodash <https://lodash.com/>\n * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>\n * Released under MIT license <https://lodash.com/license>\n * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n */\n\n/** Used to compose unicode character classes. */\nconst rsAstralRange = '\\\\ud800-\\\\udfff';\nconst rsComboMarksRange = '\\\\u0300-\\\\u036f';\nconst reComboHalfMarksRange = '\\\\ufe20-\\\\ufe2f';\nconst rsComboSymbolsRange = '\\\\u20d0-\\\\u20ff';\nconst rsComboMarksExtendedRange = '\\\\u1ab0-\\\\u1aff';\nconst rsComboMarksSupplementRange = '\\\\u1dc0-\\\\u1dff';\nconst rsComboRange = rsComboMarksRange + reComboHalfMarksRange + rsComboSymbolsRange + rsComboMarksExtendedRange + rsComboMarksSupplementRange;\nconst rsDingbatRange = '\\\\u2700-\\\\u27bf';\nconst rsLowerRange = 'a-z\\\\xdf-\\\\xf6\\\\xf8-\\\\xff';\nconst rsMathOpRange = '\\\\xac\\\\xb1\\\\xd7\\\\xf7';\nconst rsNonCharRange = '\\\\x00-\\\\x2f\\\\x3a-\\\\x40\\\\x5b-\\\\x60\\\\x7b-\\\\xbf';\nconst rsPunctuationRange = '\\\\u2000-\\\\u206f';\nconst rsSpaceRange = ' \\\\t\\\\x0b\\\\f\\\\xa0\\\\ufeff\\\\n\\\\r\\\\u2028\\\\u2029\\\\u1680\\\\u180e\\\\u2000\\\\u2001\\\\u2002\\\\u2003\\\\u2004\\\\u2005\\\\u2006\\\\u2007\\\\u2008\\\\u2009\\\\u200a\\\\u202f\\\\u205f\\\\u3000';\nconst rsUpperRange = 'A-Z\\\\xc0-\\\\xd6\\\\xd8-\\\\xde';\nconst rsVarRange = '\\\\ufe0e\\\\ufe0f';\nconst rsBreakRange = rsMathOpRange + rsNonCharRange + rsPunctuationRange + rsSpaceRange;\n\n/** Used to compose unicode capture groups. */\nconst rsApos = '[\\'\\u2019]';\nconst rsBreak = `[${rsBreakRange}]`;\nconst rsCombo = `[${rsComboRange}]`;\nconst rsDigit = '\\\\d';\nconst rsDingbat = `[${rsDingbatRange}]`;\nconst rsLower = `[${rsLowerRange}]`;\nconst rsMisc = `[^${rsAstralRange}${rsBreakRange + rsDigit + rsDingbatRange + rsLowerRange + rsUpperRange}]`;\nconst rsFitz = '\\\\ud83c[\\\\udffb-\\\\udfff]';\nconst rsModifier = `(?:${rsCombo}|${rsFitz})`;\nconst rsNonAstral = `[^${rsAstralRange}]`;\nconst rsRegional = '(?:\\\\ud83c[\\\\udde6-\\\\uddff]){2}';\nconst rsSurrPair = '[\\\\ud800-\\\\udbff][\\\\udc00-\\\\udfff]';\nconst rsUpper = `[${rsUpperRange}]`;\nconst rsZWJ = '\\\\u200d';\n\n/** Used to compose unicode regexes. */\nconst rsMiscLower = `(?:${rsLower}|${rsMisc})`;\nconst rsMiscUpper = `(?:${rsUpper}|${rsMisc})`;\nconst rsOptContrLower = `(?:${rsApos}(?:d|ll|m|re|s|t|ve))?`;\nconst rsOptContrUpper = `(?:${rsApos}(?:D|LL|M|RE|S|T|VE))?`;\nconst reOptMod = `${rsModifier}?`;\nconst rsOptVar = `[${rsVarRange}]?`;\nconst rsOptJoin = `(?:${rsZWJ}(?:${[rsNonAstral, rsRegional, rsSurrPair].join('|')})${rsOptVar + reOptMod})*`;\nconst rsOrdLower = '\\\\d*(?:1st|2nd|3rd|(?![123])\\\\dth)(?=\\\\b|[A-Z_])';\nconst rsOrdUpper = '\\\\d*(?:1ST|2ND|3RD|(?![123])\\\\dTH)(?=\\\\b|[a-z_])';\nconst rsSeq = rsOptVar + reOptMod + rsOptJoin;\nconst rsEmoji = `(?:${[rsDingbat, rsRegional, rsSurrPair].join('|')})${rsSeq}`;\n\nconst unicodeWordsRegExp = new RegExp([\n\t`${rsUpper}?${rsLower}+${rsOptContrLower}(?=${[rsBreak, rsUpper, '$'].join('|')})`,\n\t`${rsMiscUpper}+${rsOptContrUpper}(?=${[rsBreak, rsUpper + rsMiscLower, '$'].join('|')})`,\n\t`${rsUpper}?${rsMiscLower}+${rsOptContrLower}`,\n\t`${rsUpper}+${rsOptContrUpper}`,\n\trsOrdUpper,\n\trsOrdLower,\n\t`${rsDigit}+`,\n\trsEmoji\n].join('|'), 'g');\n\nexport default unicodeWordsRegExp;","import { Type } from 'main.core';\n\nimport SearchFieldIndex from './search-field-index';\nimport WordIndex from './word-index';\n\nimport type Item from '../item/item';\nimport type SearchField from './search-field';\n\nimport unicodeWordsRegExp from './unicode-words';\nconst asciiWordRegExp = /[^\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\x7f]+/g;\nconst hasUnicodeWordRegExp = /[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;\n\nexport default class SearchIndex\n{\n\tindexes: SearchFieldIndex[] = [];\n\n\tconstructor()\n\t{\n\t}\n\n\taddIndex(fieldIndex: SearchFieldIndex)\n\t{\n\t\tif (Type.isObject(fieldIndex))\n\t\t{\n\t\t\tthis.getIndexes().push(fieldIndex);\n\t\t}\n\t}\n\n\tgetIndexes()\n\t{\n\t\treturn this.indexes;\n\t}\n\n\tstatic create(item: Item)\n\t{\n\t\tconst index = new SearchIndex();\n\t\tconst entity = item.getEntity();\n\n\t\tif (!item.isSearchable() || !entity.isSearchable() || item.isHidden())\n\t\t{\n\t\t\treturn index;\n\t\t}\n\n\t\tconst searchFields = entity.getSearchFields();\n\t\tsearchFields.forEach(field => {\n\t\t\tif (!field.isSeachable())\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (field.isSystem())\n\t\t\t{\n\t\t\t\tif (field.getName() === 'title')\n\t\t\t\t{\n\t\t\t\t\tindex.addIndex(this.createIndex(field, item.getTitle()));\n\t\t\t\t}\n\t\t\t\telse if (field.getName() === 'subtitle')\n\t\t\t\t{\n\t\t\t\t\tindex.addIndex(this.createIndex(field, item.getSubtitle()));\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst customData = item.getCustomData().get(field.getName());\n\t\t\t\tif (!Type.isUndefined(customData))\n\t\t\t\t{\n\t\t\t\t\tindex.addIndex(this.createIndex(field, customData));\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn index;\n\t}\n\n\tstatic createIndex(field: SearchField, text: string): SearchFieldIndex\n\t{\n\t\tif (!Type.isStringFilled(text))\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tlet index: SearchFieldIndex = null;\n\t\tif (field.getType() === 'string')\n\t\t{\n\t\t\tconst wordIndexes = this.splitText(text);\n\t\t\tif (Type.isArrayFilled(wordIndexes))\n\t\t\t{\n\t\t\t\t// \"GoPro111 Leto15\"\n\t\t\t\t// [go, pro, 111, leto, 15] + [gopro111, leto15]\n\t\t\t\tthis.fillComplexWords(wordIndexes);\n\t\t\t\tindex = new SearchFieldIndex(field, wordIndexes);\n\t\t\t}\n\t\t}\n\t\telse if (field.getType() === 'email')\n\t\t{\n\t\t\tconst position = text.indexOf('@');\n\t\t\tif (position !== -1)\n\t\t\t{\n\t\t\t\tindex = new SearchFieldIndex(\n\t\t\t\t\tfield,\n\t\t\t\t\t[\n\t\t\t\t\t\tnew WordIndex(text.toLowerCase(), 0),\n\t\t\t\t\t\tnew WordIndex(text.substr(position + 1).toLowerCase(), position + 1)\n\t\t\t\t\t]\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\treturn index;\n\t}\n\n\tstatic splitText(text: string): WordIndex[]\n\t{\n\t\tif (!Type.isStringFilled(text))\n\t\t{\n\t\t\treturn [];\n\t\t}\n\n\t\treturn this.hasUnicodeWord(text) ? this.splitUnicodeText(text) : this.splitAsciiText(text);\n\t}\n\n\tstatic splitUnicodeText(text: string): WordIndex[]\n\t{\n\t\treturn this.splitTextInternal(text, unicodeWordsRegExp);\n\t}\n\n\tstatic splitAsciiText(text: string): WordIndex[]\n\t{\n\t\treturn this.splitTextInternal(text, asciiWordRegExp);\n\t}\n\n\tstatic hasUnicodeWord(text: string): boolean\n\t{\n\t\treturn hasUnicodeWordRegExp.test(text);\n\t}\n\n\tstatic splitTextInternal(text: string, regExp: RegExp): WordIndex[]\n\t{\n\t\tlet match;\n\t\tconst result = [];\n\n\t\twhile ((match = regExp.exec(text)) !== null)\n\t\t{\n\t\t\tif (match.index === regExp.lastIndex)\n\t\t\t{\n\t\t\t\tregExp.lastIndex++;\n\t\t\t}\n\n\t\t\tresult.push(new WordIndex(match[0].toLowerCase(), match.index));\n\t\t}\n\n\t\treturn result;\n\t}\n\n\t/**\n\t *  @private\n\t */\n\tstatic fillComplexWords(indexes: WordIndex[]): void\n\t{\n\t\tif (indexes.length < 2)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet complexWord: ?string = null;\n\t\tlet startIndex: ?number = null;\n\n\t\tindexes.forEach((currentIndex, currentArrayIndex) => {\n\t\t\tconst nextIndex = indexes[currentArrayIndex + 1];\n\t\t\tif (nextIndex)\n\t\t\t{\n\t\t\t\tconst sameWord =\n\t\t\t\t\tcurrentIndex.getStartIndex() + currentIndex.getWord().length === nextIndex.getStartIndex()\n\t\t\t\t;\n\n\t\t\t\tif (sameWord)\n\t\t\t\t{\n\t\t\t\t\tif (complexWord === null)\n\t\t\t\t\t{\n\t\t\t\t\t\tcomplexWord = currentIndex.getWord();\n\t\t\t\t\t\tstartIndex = currentIndex.getStartIndex();\n\t\t\t\t\t}\n\n\t\t\t\t\tcomplexWord += nextIndex.getWord();\n\t\t\t\t}\n\t\t\t\telse if (complexWord !== null)\n\t\t\t\t{\n\t\t\t\t\tindexes.push(new WordIndex(complexWord, startIndex));\n\t\t\t\t\tcomplexWord = null;\n\t\t\t\t\tstartIndex = null;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (complexWord !== null)\n\t\t\t{\n\t\t\t\tindexes.push(new WordIndex(complexWord, startIndex));\n\t\t\t\tcomplexWord = null;\n\t\t\t\tstartIndex = null;\n\t\t\t}\n\t\t});\n\t}\n}","import { Type } from 'main.core';\nimport type { SearchFieldOptions } from './search-field-options';\n\nexport default class SearchField\n{\n\tname: string = null;\n\ttype: string = 'string';\n\tsearchable: boolean = true;\n\tsystem: boolean = false;\n\n\tconstructor(fieldOptions: SearchFieldOptions)\n\t{\n\t\tconst options = Type.isPlainObject(fieldOptions) ? fieldOptions : {};\n\n\t\tif (!Type.isStringFilled(options.name))\n\t\t{\n\t\t\tthrow new Error('EntitySelector.SearchField: \"name\" parameter is required.');\n\t\t}\n\n\t\tthis.name = options.name;\n\t\tthis.setType(options.type);\n\t\tthis.setSystem(options.system);\n\t\tthis.setSeachable(options.searchable);\n\t}\n\n\tgetName(): string\n\t{\n\t\treturn this.name;\n\t}\n\n\tgetType(): string\n\t{\n\t\treturn this.type;\n\t}\n\n\tsetType(type: string)\n\t{\n\t\tif (Type.isStringFilled(type))\n\t\t{\n\t\t\tthis.type = type;\n\t\t}\n\t}\n\n\tsetSeachable(flag: boolean): this\n\t{\n\t\tif (Type.isBoolean(flag))\n\t\t{\n\t\t\tthis.searchable = flag;\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tisSeachable(): boolean\n\t{\n\t\treturn this.searchable;\n\t}\n\n\tsetSystem(flag: boolean): this\n\t{\n\t\tif (Type.isBoolean(flag))\n\t\t{\n\t\t\tthis.system = flag;\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tisCustom(): boolean\n\t{\n\t\treturn !this.isSystem();\n\t}\n\n\tisSystem(): boolean\n\t{\n\t\treturn this.system;\n\t}\n}","import { Extension, Runtime, Type } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\n\nimport ItemCollection from '../item/item-collection';\nimport SearchField from '../search/search-field';\n\nimport type Item from '../item/item';\nimport type { EntityOptions } from './entity-options';\nimport type { SearchFieldOptions } from '../search/search-field-options';\nimport type { ItemBadgeOptions } from '../item/item-badge-options';\n\n/**\n * @memberof BX.UI.EntitySelector\n */\nexport default class Entity extends EventEmitter\n{\n\tstatic extensions: string[] = null;\n\tstatic defaultOptions: { [entityId: string]: { [key: string]: any } } = null;\n\n\tid: string = null;\n\toptions: { [key: string]: any } = {};\n\tsearchable: boolean = true;\n\tsearchFields: ItemCollection<SearchField> = new ItemCollection();\n\tdynamicLoad: boolean = false;\n\tdynamicSearch: boolean = false;\n\tsearchCacheLimits: RegExp[] = [];\n\n\titemOptions: { [key: string]: any } = {};\n\ttagOptions: { [key: string]: any } = {};\n\tbadgeOptions: ItemBadgeOptions[] = [];\n\n\tconstructor(entityOptions: EntityOptions)\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.UI.EntitySelector.Entity');\n\n\t\tlet options: EntityOptions = Type.isPlainObject(entityOptions) ? entityOptions : {};\n\t\tif (!Type.isStringFilled(options.id))\n\t\t{\n\t\t\tthrow new Error('EntitySelector.Entity: \"id\" parameter is required.');\n\t\t}\n\n\t\tconst defaultOptions = this.constructor.getEntityDefaultOptions(options.id) || {};\n\t\toptions = Runtime.merge(JSON.parse(JSON.stringify(defaultOptions)), options);\n\n\t\tthis.id = options.id;\n\t\tthis.options = Type.isPlainObject(options.options) ? options.options : {};\n\t\tthis.itemOptions = Type.isPlainObject(options.itemOptions) ? options.itemOptions : {};\n\t\tthis.tagOptions = Type.isPlainObject(options.tagOptions) ? options.tagOptions : {};\n\t\tthis.badgeOptions = Type.isArray(options.badgeOptions) ? options.badgeOptions : [];\n\n\t\tthis.setSeachable(options.searchable);\n\t\tthis.setDynamicLoad(options.dynamicLoad);\n\t\tthis.setDynamicSearch(options.dynamicSearch);\n\t\tthis.setSearchFields(options.searchFields);\n\t\tthis.setSearchCacheLimits(options.searchCacheLimits);\n\t}\n\n\tstatic getDefaultOptions()\n\t{\n\t\tif (this.defaultOptions === null)\n\t\t{\n\t\t\tthis.defaultOptions = {};\n\t\t\tthis.getExtensions().forEach((extension: string) => {\n\t\t\t\tconst settings = Extension.getSettings(extension);\n\t\t\t\tconst entities: [] = settings.get('entities', []);\n\t\t\t\tentities.forEach(entity => {\n\t\t\t\t\tif (Type.isStringFilled(entity.id) && Type.isPlainObject(entity.options))\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.defaultOptions[entity.id] = JSON.parse(JSON.stringify(entity.options)); // clone\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t\treturn this.defaultOptions;\n\t}\n\n\tstatic getExtensions(): string[]\n\t{\n\t\tif (this.extensions === null)\n\t\t{\n\t\t\tconst settings = Extension.getSettings('ui.entity-selector');\n\t\t\tthis.extensions = settings.get('extensions', []);\n\t\t}\n\n\t\treturn this.extensions;\n\t}\n\n\tstatic getEntityDefaultOptions(entityId: string)\n\t{\n\t\treturn this.getDefaultOptions()[entityId] || null;\n\t}\n\n\tstatic getItemOptions(entityId: string, entityType: string)\n\t{\n\t\tif (!Type.isStringFilled(entityId))\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst options = this.getEntityDefaultOptions(entityId);\n\t\tconst itemOptions = options && options['itemOptions'] ? options['itemOptions'] : null;\n\n\t\tif (Type.isUndefined(entityType))\n\t\t{\n\t\t\treturn itemOptions;\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn itemOptions && !Type.isUndefined(itemOptions[entityType]) ? itemOptions[entityType] : null;\n\t\t}\n\t}\n\n\tstatic getTagOptions(entityId: string, entityType?: string)\n\t{\n\t\tif (!Type.isStringFilled(entityId))\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst options = this.getEntityDefaultOptions(entityId);\n\t\tconst tagOptions = options && options['tagOptions'] ? options['tagOptions'] : null;\n\n\t\tif (Type.isUndefined(entityType))\n\t\t{\n\t\t\treturn tagOptions;\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn tagOptions && !Type.isUndefined(tagOptions[entityType]) ? tagOptions[entityType] : null;\n\t\t}\n\t}\n\n\tgetId(): string\n\t{\n\t\treturn this.id;\n\t}\n\n\tgetOptions(): { [key: string]: any }\n\t{\n\t\treturn this.options;\n\t}\n\n\tgetItemOptions(): { [key: string]: any }\n\t{\n\t\treturn this.itemOptions;\n\t}\n\n\tstatic getItemOption(entityId: string, option: string, entityType?: string)\n\t{\n\t\treturn this.getOptionInternal(this.getItemOptions(entityId), option, entityType);\n\t}\n\n\tgetItemOption(option: string, entityType?: string): any\n\t{\n\t\treturn this.constructor.getOptionInternal(this.itemOptions, option, entityType);\n\t}\n\n\tgetTagOptions(): { [key: string]: any }\n\t{\n\t\treturn this.tagOptions;\n\t}\n\n\tstatic getTagOption(entityId: string, option: string, entityType?: string)\n\t{\n\t\treturn this.getOptionInternal(this.getTagOptions(entityId), option, entityType);\n\t}\n\n\tgetTagOption(option: string, entityType?: string): any\n\t{\n\t\treturn this.constructor.getOptionInternal(this.tagOptions, option, entityType);\n\t}\n\n\tstatic getOptionInternal(options, option: string, type?: string): any\n\t{\n\t\tif (!Type.isPlainObject(options))\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tif (options[type] && !Type.isUndefined(options[type][option]))\n\t\t{\n\t\t\treturn options[type][option];\n\t\t}\n\t\telse if (options['default'] && !Type.isUndefined(options['default'][option]))\n\t\t{\n\t\t\treturn options['default'][option];\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tgetBadges(item: Item)\n\t{\n\t\tconst entityTypeBadges = this.getItemOption('badges', item.getEntityType()) || [];\n\t\tconst badges = [...entityTypeBadges];\n\n\t\tthis.badgeOptions.forEach((badge) => {\n\t\t\tif (Type.isPlainObject(badge.conditions))\n\t\t\t{\n\t\t\t\tfor (const condition in badge.conditions)\n\t\t\t\t{\n\t\t\t\t\tif (item.getCustomData().get(condition) !== badge.conditions[condition])\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tbadges.push(badge);\n\t\t\t}\n\t\t});\n\n\t\treturn badges;\n\t}\n\n\tisSearchable(): boolean\n\t{\n\t\treturn this.searchable;\n\t}\n\n\tsetSeachable(flag: boolean): this\n\t{\n\t\tif (Type.isBoolean(flag))\n\t\t{\n\t\t\tthis.searchable = flag;\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tgetSearchFields(): ItemCollection<SearchField>\n\t{\n\t\treturn this.searchFields;\n\t}\n\n\tsetSearchFields(searchFields: SearchFieldOptions[])\n\t{\n\t\tthis.searchFields.clear();\n\n\t\t// Default Search Fields\n\t\tconst titleField = new SearchField({ name: 'title', searchable: true, system: true, type: 'string' });\n\t\tconst subtitleField = new SearchField({ name: 'subtitle', searchable: true, system: true, type: 'string' });\n\t\tthis.searchFields.add(titleField);\n\t\tthis.searchFields.add(subtitleField);\n\n\t\t// Custom Search Fields\n\t\tconst customFields = Type.isArray(searchFields) ? searchFields : [];\n\t\tcustomFields.forEach(fieldOptions => {\n\t\t\tconst field = new SearchField(fieldOptions);\n\t\t\tif (field.isSystem()) // Entity can override default fields.\n\t\t\t{\n\t\t\t\t// delete a default title field\n\t\t\t\tif (field.getName() === 'title')\n\t\t\t\t{\n\t\t\t\t\tthis.searchFields.delete(titleField);\n\t\t\t\t}\n\t\t\t\telse if (field.getName() === 'subtitle')\n\t\t\t\t{\n\t\t\t\t\tthis.searchFields.delete(subtitleField);\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.searchFields.add(field);\n\t\t});\n\t}\n\n\tsetSearchCacheLimits(limits: string[])\n\t{\n\t\tif (Type.isArrayFilled(limits))\n\t\t{\n\t\t\tlimits.forEach((limit: string) => {\n\t\t\t\tif (Type.isStringFilled(limit))\n\t\t\t\t{\n\t\t\t\t\tthis.searchCacheLimits.push(new RegExp(limit, 'i'));\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tgetSearchCacheLimits(): RegExp[]\n\t{\n\t\treturn this.searchCacheLimits;\n\t}\n\n\thasDynamicLoad()\n\t{\n\t\treturn this.dynamicLoad;\n\t}\n\n\tsetDynamicLoad(flag: boolean): this\n\t{\n\t\tif (Type.isBoolean(flag))\n\t\t{\n\t\t\tthis.dynamicLoad = flag;\n\t\t}\n\n\t\treturn this;\n\t}\n\n\thasDynamicSearch()\n\t{\n\t\treturn this.dynamicSearch;\n\t}\n\n\tsetDynamicSearch(flag: boolean): this\n\t{\n\t\tif (Type.isBoolean(flag))\n\t\t{\n\t\t\tthis.dynamicSearch = flag;\n\t\t}\n\n\t\treturn this;\n\t}\n\n\ttoJSON()\n\t{\n\t\treturn {\n\t\t\tid: this.getId(),\n\t\t\toptions: this.getOptions(),\n\t\t\tsearchable: this.isSearchable(),\n\t\t\tdynamicLoad: this.hasDynamicLoad(),\n\t\t\tdynamicSearch: this.hasDynamicSearch(),\n\t\t};\n\t}\n}","import { Type, Loc, Text } from 'main.core';\nimport { EventEmitter, BaseEvent } from 'main.core.events';\n\nimport ItemNode from './item-node';\nimport SearchIndex from '../search/search-index';\nimport Entity from '../entity/entity';\n\nimport type Dialog from '../dialog/dialog';\nimport type { ItemOptions } from './item-options';\nimport type { ItemNodeOptions } from './item-node-options';\nimport type { ItemBadgeOptions } from './item-badge-options';\nimport ItemBadge from './item-badge';\nimport type { TagItemOptions } from '../tag-selector/tag-item-options';\n\n/**\n * @memberof BX.UI.EntitySelector\n * @package ui.entity-selector\n */\nexport default class Item extends EventEmitter\n{\n\tid: string | number = null;\n\tentityId: string = null;\n\tentityType: string = null;\n\n\ttitle: string = '';\n\tsubtitle: ?string = null;\n\tcaption: ?string = null;\n\tsupertitle: ?string = null;\n\tavatar: ?string = null;\n\ttextColor: ?string = null;\n\tlink: ?string = null;\n\tlinkTitle: ?string = null;\n\ttagOptions: Map<string, any> = null;\n\tbadges: ItemBadgeOptions[] = null;\n\n\tdialog: Dialog = null;\n\tnodes: Set<ItemNode> = new Set();\n\tselected: boolean = false;\n\tsearchable: boolean = true;\n\tsaveable: boolean = true;\n\tdeselectable: boolean = true;\n\thidden: boolean = false;\n\tsearchIndex: { [key: string]: string[] } = null;\n\tcustomData: Map<string, any> = null;\n\n\tsort: number = null;\n\tcontextSort: number = null;\n\tglobalSort: number = null;\n\n\tconstructor(itemOptions: ItemOptions)\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.UI.EntitySelector.Item');\n\n\t\tconst options: ItemOptions = Type.isPlainObject(itemOptions) ? itemOptions : {};\n\t\tif (!Type.isStringFilled(options.id) && !Type.isNumber(options.id))\n\t\t{\n\t\t\tthrow new Error('EntitySelector.Item: \"id\" parameter is required.');\n\t\t}\n\n\t\tif (!Type.isStringFilled(options.entityId))\n\t\t{\n\t\t\tthrow new Error('EntitySelector.Item: \"entityId\" parameter is required.');\n\t\t}\n\n\t\tthis.id = options.id;\n\t\tthis.entityId = options.entityId;\n\t\tthis.entityType = Type.isStringFilled(options.entityType) ? options.entityType : 'default';\n\t\tthis.selected = Type.isBoolean(options.selected) ? options.selected : false;\n\t\tthis.customData =\n\t\t\tType.isPlainObject(options.customData) ? new Map(Object.entries(options.customData)) : new Map()\n\t\t;\n\n\t\tthis.tagOptions =\n\t\t\tType.isPlainObject(options.tagOptions) ? new Map(Object.entries(options.tagOptions)) : new Map()\n\t\t;\n\n\t\tthis.setTitle(options.title);\n\t\tthis.setSubtitle(options.subtitle);\n\t\tthis.setSupertitle(options.supertitle);\n\t\tthis.setCaption(options.caption);\n\t\tthis.setAvatar(options.avatar);\n\t\tthis.setTextColor(options.textColor);\n\t\tthis.setLink(options.link);\n\t\tthis.setLinkTitle(options.linkTitle);\n\t\tthis.setBadges(options.badges);\n\n\t\tthis.setSearchable(options.searchable);\n\t\tthis.setSaveable(options.saveable);\n\t\tthis.setDeselectable(options.deselectable);\n\t\tthis.setHidden(options.hidden);\n\t\tthis.setContextSort(options.contextSort);\n\t\tthis.setGlobalSort(options.globalSort);\n\t\tthis.setSort(options.sort);\n\t}\n\n\tgetId(): string | number\n\t{\n\t\treturn this.id;\n\t}\n\n\tgetEntityId(): string\n\t{\n\t\treturn this.entityId;\n\t}\n\n\tgetEntity(): ?Entity\n\t{\n\t\tlet entity = this.getDialog().getEntity(this.getEntityId());\n\t\tif (entity === null)\n\t\t{\n\t\t\tentity = new Entity({ id: this.getEntityId() });\n\t\t\tthis.getDialog().addEntity(entity);\n\t\t}\n\n\t\treturn entity;\n\t}\n\n\tgetEntityType(): string\n\t{\n\t\treturn this.entityType;\n\t}\n\n\tgetTitle(): string\n\t{\n\t\treturn this.title;\n\t}\n\n\tsetTitle(title: string): void\n\t{\n\t\tif (Type.isStringFilled(title))\n\t\t{\n\t\t\tthis.title = title;\n\n\t\t\tif (this.isRendered())\n\t\t\t{\n\t\t\t\tfor (const node of this.getNodes())\n\t\t\t\t{\n\t\t\t\t\tnode.render();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tgetSubtitle(): ?string\n\t{\n\t\treturn this.subtitle !== null ? this.subtitle : this.getEntityItemOption('subtitle');\n\t}\n\n\tsetSubtitle(subtitle: string): void\n\t{\n\t\tif (Type.isString(subtitle) || subtitle === null)\n\t\t{\n\t\t\tthis.subtitle = subtitle;\n\n\t\t\tif (this.isRendered())\n\t\t\t{\n\t\t\t\tfor (const node of this.getNodes())\n\t\t\t\t{\n\t\t\t\t\tnode.render();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tgetSupertitle(): ?string\n\t{\n\t\treturn this.supertitle !== null ? this.supertitle : this.getEntityItemOption('supertitle');\n\t}\n\n\tsetSupertitle(supertitle: string): void\n\t{\n\t\tif (Type.isString(supertitle) || supertitle === null)\n\t\t{\n\t\t\tthis.supertitle = supertitle;\n\n\t\t\tif (this.isRendered())\n\t\t\t{\n\t\t\t\tfor (const node of this.getNodes())\n\t\t\t\t{\n\t\t\t\t\tnode.render();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tgetAvatar(): ?string\n\t{\n\t\treturn this.avatar !== null ? this.avatar : this.getEntityItemOption('avatar');\n\t}\n\n\tsetAvatar(avatar: ?string): void\n\t{\n\t\tif (Type.isString(avatar) || avatar === null)\n\t\t{\n\t\t\tthis.avatar = avatar;\n\n\t\t\tif (this.isRendered())\n\t\t\t{\n\t\t\t\tfor (const node of this.getNodes())\n\t\t\t\t{\n\t\t\t\t\tnode.render();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tgetTextColor(): ?string\n\t{\n\t\treturn this.textColor !== null ? this.textColor : this.getEntityItemOption('textColor');\n\t}\n\n\tsetTextColor(textColor: ?string): void\n\t{\n\t\tif (Type.isString(textColor) || textColor === null)\n\t\t{\n\t\t\tthis.textColor = textColor;\n\n\t\t\tif (this.isRendered())\n\t\t\t{\n\t\t\t\tfor (const node of this.getNodes())\n\t\t\t\t{\n\t\t\t\t\tnode.render();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tgetCaption(): ?string\n\t{\n\t\treturn this.caption !== null ? this.caption : this.getEntityItemOption('caption');\n\t}\n\n\tsetCaption(caption: ?string): void\n\t{\n\t\tif (Type.isString(caption) || caption === null)\n\t\t{\n\t\t\tthis.caption = caption;\n\n\t\t\tif (this.isRendered())\n\t\t\t{\n\t\t\t\tfor (const node of this.getNodes())\n\t\t\t\t{\n\t\t\t\t\tnode.render();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tgetLink(): ?string\n\t{\n\t\tconst link = this.link !== null ? this.link : this.getEntityItemOption('link');\n\n\t\treturn this.replaceMacros(link);\n\t}\n\n\tsetLink(link: ?string): void\n\t{\n\t\tif (Type.isString(link) || link === null)\n\t\t{\n\t\t\tthis.link = link;\n\t\t}\n\t}\n\n\tgetLinkTitle(): ?string\n\t{\n\t\tif (this.linkTitle !== null)\n\t\t{\n\t\t\treturn this.linkTitle;\n\t\t}\n\n\t\tconst linkTitle = this.getEntityItemOption('linkTitle');\n\n\t\treturn linkTitle !== null ? linkTitle : Loc.getMessage('UI_SELECTOR_ITEM_LINK_TITLE');\n\t}\n\n\tsetLinkTitle(linkTitle: ?string): void\n\t{\n\t\tif (Type.isString(linkTitle) || linkTitle === null)\n\t\t{\n\t\t\tthis.linkTitle = linkTitle;\n\t\t}\n\t}\n\n\tgetBadges(): ItemBadge[]\n\t{\n\t\tif (this.badges !== null)\n\t\t{\n\t\t\treturn this.badges;\n\t\t}\n\n\t\tconst badges = this.getEntity().getBadges(this);\n\t\tif (Type.isArray(badges))\n\t\t{\n\t\t\tthis.setBadges(badges);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.badges = [];\n\t\t}\n\n\t\treturn this.badges;\n\t}\n\n\tsetBadges(badges: ?ItemBadgeOptions[]): void\n\t{\n\t\tif (Type.isArray(badges))\n\t\t{\n\t\t\tthis.badges = [];\n\t\t\tbadges.forEach(badge => {\n\t\t\t\tthis.badges.push(new ItemBadge(badge));\n\t\t\t});\n\t\t}\n\t\telse if (badges === null)\n\t\t{\n\t\t\tthis.badges = null;\n\t\t}\n\t}\n\n\t/**\n\t * @internal\n\t */\n\tsetDialog(dialog: Dialog): void\n\t{\n\t\tthis.dialog = dialog;\n\t}\n\n\tgetDialog(): Dialog\n\t{\n\t\treturn this.dialog;\n\t}\n\n\tcreateNode(nodeOptions: ItemNodeOptions): ItemNode\n\t{\n\t\tconst itemNode = new ItemNode(this, nodeOptions);\n\t\tthis.nodes.add(itemNode);\n\n\t\treturn itemNode;\n\t}\n\n\tremoveNode(node: ItemNode): void\n\t{\n\t\tthis.nodes.delete(node);\n\t}\n\n\tgetNodes(): Set<ItemNode>\n\t{\n\t\treturn this.nodes;\n\t}\n\n\tselect(preselectedMode: boolean = false): void\n\t{\n\t\tif (this.selected)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst dialog = this.getDialog();\n\t\tconst emitEvents = dialog && !preselectedMode;\n\n\t\tif (emitEvents)\n\t\t{\n\t\t\tconst event = new BaseEvent({ data: { item: this } });\n\t\t\tdialog.emit('Item:onBeforeSelect', event);\n\t\t\tif (event.isDefaultPrevented())\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tthis.selected = true;\n\n\t\tif (dialog)\n\t\t{\n\t\t\tdialog.handleItemSelect(this, !preselectedMode);\n\t\t}\n\n\t\tif (this.isRendered())\n\t\t{\n\t\t\tthis.getNodes().forEach((node: ItemNode) => {\n\t\t\t\tnode.select();\n\t\t\t});\n\t\t}\n\n\t\tif (emitEvents)\n\t\t{\n\t\t\tdialog.emit('Item:onSelect', { item: this });\n\t\t\tdialog.saveRecentItem(this);\n\t\t}\n\t}\n\n\tdeselect(): void\n\t{\n\t\tif (!this.selected || !this.isDeselectable())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst dialog = this.getDialog();\n\t\tif (dialog)\n\t\t{\n\t\t\tconst event = new BaseEvent({ data: { item: this } });\n\t\t\tdialog.emit('Item:onBeforeDeselect', event);\n\t\t\tif (event.isDefaultPrevented())\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tthis.selected = false;\n\t\tif (dialog)\n\t\t{\n\t\t\tdialog.handleItemDeselect(this);\n\t\t}\n\n\t\tif (this.isRendered())\n\t\t{\n\t\t\tthis.getNodes().forEach(node => {\n\t\t\t\tnode.deselect();\n\t\t\t});\n\t\t}\n\n\t\tif (dialog)\n\t\t{\n\t\t\tdialog.emit('Item:onDeselect', { item: this });\n\n\t\t\tif (dialog.getTagSelector())\n\t\t\t{\n\t\t\t\tdialog.getTagSelector().removeTag({\n\t\t\t\t\tid: this.getId(),\n\t\t\t\t\tentityId: this.getEntityId()\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\tisSelected(): boolean\n\t{\n\t\treturn this.selected;\n\t}\n\n\tsetSearchable(flag: boolean): void\n\t{\n\t\tif (Type.isBoolean(flag))\n\t\t{\n\t\t\tthis.searchable = flag;\n\t\t}\n\t}\n\n\tisSearchable(): boolean\n\t{\n\t\treturn this.searchable;\n\t}\n\n\tsetSaveable(flag: boolean): void\n\t{\n\t\tif (Type.isBoolean(flag))\n\t\t{\n\t\t\tthis.saveable = flag;\n\t\t}\n\t}\n\n\tisSaveable(): boolean\n\t{\n\t\treturn this.saveable;\n\t}\n\n\tsetDeselectable(flag: boolean): void\n\t{\n\t\tif (Type.isBoolean(flag))\n\t\t{\n\t\t\tthis.deselectable = flag;\n\n\t\t\tif (this.getDialog() && this.getDialog().getTagSelector())\n\t\t\t{\n\t\t\t\tconst tag = this.getDialog().getTagSelector().getTag({\n\t\t\t\t\tid: this.getId(),\n\t\t\t\t\tentityId: this.getEntityId()\n\t\t\t\t});\n\n\t\t\t\tif (tag)\n\t\t\t\t{\n\t\t\t\t\ttag.setDeselectable(flag);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tisDeselectable(): boolean\n\t{\n\t\treturn this.deselectable;\n\t}\n\n\tsetHidden(flag: boolean): void\n\t{\n\t\tif (Type.isBoolean(flag))\n\t\t{\n\t\t\tthis.hidden = flag;\n\t\t}\n\t}\n\n\tisHidden(): boolean\n\t{\n\t\treturn this.hidden;\n\t}\n\n\tsetContextSort(sort: ?number): void\n\t{\n\t\tif (Type.isNumber(sort) || sort === null)\n\t\t{\n\t\t\tthis.contextSort = sort;\n\t\t}\n\t}\n\n\tgetContextSort(): ?number\n\t{\n\t\treturn this.contextSort;\n\t}\n\n\tsetGlobalSort(sort: ?number): void\n\t{\n\t\tif (Type.isNumber(sort) || sort === null)\n\t\t{\n\t\t\tthis.globalSort = sort;\n\t\t}\n\t}\n\n\tgetGlobalSort(): ?number\n\t{\n\t\treturn this.globalSort;\n\t}\n\n\tsetSort(sort: ?number): void\n\t{\n\t\tif (Type.isNumber(sort) || sort === null)\n\t\t{\n\t\t\tthis.sort = sort;\n\t\t}\n\t}\n\n\tgetSort(): ?number\n\t{\n\t\treturn this.sort;\n\t}\n\n\tgetSearchIndex(): SearchIndex\n\t{\n\t\tif (this.searchIndex === null)\n\t\t{\n\t\t\tthis.searchIndex = SearchIndex.create(this);\n\t\t}\n\n\t\treturn this.searchIndex;\n\t}\n\n\tresetSearchIndex(): void\n\t{\n\t\tthis.searchIndex = null;\n\t}\n\n\tgetCustomData(): Map<string, any>\n\t{\n\t\treturn this.customData;\n\t}\n\n\tisRendered(): boolean\n\t{\n\t\treturn this.getDialog() && this.getDialog().isRendered();\n\t}\n\n\tgetEntityItemOption(option): any\n\t{\n\t\treturn this.getEntity().getItemOption(option, this.getEntityType());\n\t}\n\n\tgetEntityTagOption(option): any\n\t{\n\t\treturn this.getEntity().getTagOption(option, this.getEntityType());\n\t}\n\n\tgetTagOptions(): Map<string, any>\n\t{\n\t\treturn this.tagOptions;\n\t}\n\n\tgetTagOption(option: string): any\n\t{\n\t\tconst value = this.getTagOptions().get(option);\n\n\t\tif (!Type.isUndefined(value))\n\t\t{\n\t\t\treturn value;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tgetTagGlobalOption(option: string, useItemOptions: boolean = false): any\n\t{\n\t\tif (!Type.isStringFilled(option))\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tlet value = this.getTagOption(option);\n\n\t\tif (value === null && useItemOptions === true && this[option] !== null)\n\t\t{\n\t\t\tvalue = this[option];\n\t\t}\n\n\t\tif (value === null && this.getDialog().getTagSelector())\n\t\t{\n\t\t\tconst fn = `getTag${Text.toPascalCase(option)}`;\n\t\t\tif (Type.isFunction(this.getDialog().getTagSelector()[fn]))\n\t\t\t{\n\t\t\t\tvalue = this.getDialog().getTagSelector()[fn]();\n\t\t\t}\n\t\t}\n\n\t\tif (value === null)\n\t\t{\n\t\t\tvalue = this.getEntityTagOption(option);\n\t\t}\n\n\t\tif (value === null && useItemOptions === true)\n\t\t{\n\t\t\tvalue = this.getEntityItemOption(option);\n\t\t}\n\n\t\treturn value;\n\t}\n\n\tgetTagBgColor(): ?string\n\t{\n\t\treturn this.getTagGlobalOption('bgColor');\n\t}\n\n\tgetTagTextColor(): ?string\n\t{\n\t\treturn this.getTagGlobalOption('textColor');\n\t}\n\n\tgetTagMaxWidth(): ?number\n\t{\n\t\treturn this.getTagGlobalOption('maxWidth');\n\t}\n\n\tgetTagFontWeight(): ?string\n\t{\n\t\treturn this.getTagGlobalOption('fontWeight');\n\t}\n\n\tgetTagAvatar(): ?string\n\t{\n\t\treturn this.getTagGlobalOption('avatar', true);\n\t}\n\n\tgetTagLink(): ?string\n\t{\n\t\treturn this.replaceMacros(this.getTagGlobalOption('link', true));\n\t}\n\n\treplaceMacros(str: string): string\n\t{\n\t\tif (!Type.isStringFilled(str))\n\t\t{\n\t\t\treturn str;\n\t\t}\n\n\t\treturn (\n\t\t\tstr\n\t\t\t\t.replace(/#id#/i, this.getId())\n\t\t\t\t.replace(/#element_id#/i, this.getId())\n\t\t);\n\t}\n\n\tcreateTag(): TagItemOptions\n\t{\n\t\treturn {\n\t\t\tid: this.getId(),\n\t\t\tentityId: this.getEntityId(),\n\t\t\tentityType: this.getEntityType(),\n\t\t\ttitle: this.getTagOption('title') || this.getTitle(),\n\t\t\tdeselectable: this.isDeselectable(),\n\t\t\tcustomData: this.getCustomData(),\n\n\t\t\tavatar: this.getTagAvatar(),\n\t\t\tlink: this.getTagLink(),\n\n\t\t\tmaxWidth: this.getTagMaxWidth(),\n\t\t\ttextColor: this.getTagTextColor(),\n\t\t\tbgColor: this.getTagBgColor(),\n\t\t\tfontWeight: this.getTagFontWeight(),\n\t\t};\n\t}\n\n\ttoJSON()\n\t{\n\t\treturn {\n\t\t\tid: this.getId(),\n\t\t\tentityId: this.getEntityId(),\n\t\t\tentityType: this.getEntityType(),\n\t\t\tselected: this.isSelected(),\n\t\t\tdeselectable: this.isDeselectable(),\n\t\t\thidden: this.isHidden(),\n\t\t\ttitle: this.getTitle(),\n\t\t\tlink: this.getLink(),\n\t\t\tlinkTitle: this.getLinkTitle(),\n\t\t\tsubtitle: this.getSubtitle(),\n\t\t\tsupertitle: this.getSupertitle(),\n\t\t\tcaption: this.getCaption(),\n\t\t\tavatar: this.getAvatar(),\n\t\t\tcustomData: this.getCustomData(),\n\t\t};\n\t}\n}","import { Cache, Dom, Tag, Type } from 'main.core';\nimport type Tab from '../tabs/tab';\n\nexport default class BaseStub\n{\n\ttab: Tab = null;\n\tautoShow: boolean = true;\n\tcache = new Cache.MemoryCache();\n\tcontent: HTMLElement = null;\n\n\tconstructor(tab: Tab, options: { [option: string]: any })\n\t{\n\t\tthis.options = Type.isPlainObject(options) ? options : {};\n\t\tthis.tab = tab;\n\t\tthis.autoShow = this.getOption('autoShow', true);\n\t}\n\n\tgetTab(): Tab\n\t{\n\t\treturn this.tab;\n\t}\n\n\tgetOuterContainer()\n\t{\n\t\treturn this.cache.remember('outer-container', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-selector-tab-stub\">${this.render()}</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tisAutoShow(): boolean\n\t{\n\t\treturn this.autoShow;\n\t}\n\n\tshow(): void\n\t{\n\t\tDom.append(this.getOuterContainer(), this.getTab().getContainer());\n\t\t/*requestAnimationFrame(() => {\n\t\t\tDom.addClass(this.getOuterContainer(), 'ui-selector-tab-stub--show');\n\t\t});*/\n\t}\n\n\thide(): void\n\t{\n\t\t// Dom.removeClass(this.getOuterContainer(), 'ui-selector-tab-stub--show');\n\t\tDom.remove(this.getOuterContainer());\n\t}\n\n\tgetOptions(): { [option: string]: any }\n\t{\n\t\treturn this.options;\n\t}\n\n\tgetOption(option: string, defaultValue?: any): any\n\t{\n\t\tif (!Type.isUndefined(this.options[option]))\n\t\t{\n\t\t\treturn this.options[option];\n\t\t}\n\t\telse if (!Type.isUndefined(defaultValue))\n\t\t{\n\t\t\treturn defaultValue;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tthrow new Error('You must implement render() method.');\n\t}\n}","import { Text, Tag, Type, Loc } from 'main.core';\nimport type Tab from '../tabs/tab';\nimport BaseStub from './base-stub';\n\nexport default class DefaultStub extends BaseStub\n{\n\tcontent: HTMLElement = null;\n\n\tconstructor(tab: Tab, options: { [option: string]: any })\n\t{\n\t\tsuper(tab, options);\n\t}\n\n\tgetContainer()\n\t{\n\t\treturn this.cache.remember('container', () => {\n\t\t\tconst subtitle = this.getOption('subtitle');\n\t\t\tconst title = Type.isStringFilled(this.getOption('title')) ? this.getOption('title') : this.getDefaultTitle();\n\n\t\t\tconst icon = this.getOption('icon') || this.getTab().getIcon('default');\n\t\t\tlet iconOpacity = 35;\n\t\t\tif (Type.isNumber(this.getOption('iconOpacity')))\n\t\t\t{\n\t\t\t\ticonOpacity = Math.min(100, Math.max(0, this.getOption('iconOpacity')));\n\t\t\t}\n\n\t\t\tconst iconStyle =\n\t\t\t\tType.isStringFilled(icon)\n\t\t\t\t\t? `style=\"background-image: url('${icon}'); opacity: ${iconOpacity / 100};\"`\n\t\t\t\t\t: ''\n\t\t\t;\n\n\t\t\tconst arrow = this.getOption('arrow', false) && this.getTab().getDialog().getActiveFooter() !== null;\n\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-selector-tab-default-stub\">\n\t\t\t\t\t<div class=\"ui-selector-tab-default-stub-icon\"${iconStyle}></div>\n\t\t\t\t\t<div class=\"ui-selector-tab-default-stub-titles\">\n\t\t\t\t\t\t<div class=\"ui-selector-tab-default-stub-title\">${title}</div>\n\t\t\t\t\t\t${\n\t\t\t\t\t\t\tsubtitle ? \n\t\t\t\t\t\t\t\tTag.render`<div class=\"ui-selector-tab-default-stub-subtitle\">${subtitle}</div>` \n\t\t\t\t\t\t\t\t: ''\n\t\t\t\t\t\t}\n\t\t\t\t\t</div>\n\t\t\t\t\t\n\t\t\t\t\t${arrow ? Tag.render`<div class=\"ui-selector-tab-default-stub-arrow\"></div>` : ''}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetDefaultTitle()\n\t{\n\t\tconst tabTitle = Text.encode(this.getTab().getTitle());\n\n\t\treturn Loc.getMessage('UI_SELECTOR_TAB_STUB_TITLE').replace(/#TAB_TITLE#/, tabTitle);\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\treturn this.getContainer();\n\t}\n}","import { Tag, Type, Dom, Cache } from 'main.core';\nimport Dialog from '../dialog';\nimport type Tab from '../tabs/tab';\n\nexport default class BaseFooter\n{\n\tdialog: Dialog = null;\n\ttab: Tab = null;\n\tcontainer: ?HTMLElement = null;\n\tcache = new Cache.MemoryCache();\n\n\tconstructor(context: Dialog | Tab, options: { [option: string]: any })\n\t{\n\t\tthis.options = Type.isPlainObject(options) ? options : {};\n\n\t\tif (context instanceof Dialog)\n\t\t{\n\t\t\tthis.dialog = context;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.tab = context;\n\t\t\tthis.dialog = this.tab.getDialog();\n\t\t}\n\t}\n\n\tgetDialog(): Dialog\n\t{\n\t\treturn this.dialog;\n\t}\n\n\tgetTab(): ?Tab\n\t{\n\t\treturn this.tab;\n\t}\n\n\tshow(): void\n\t{\n\t\tDom.addClass(this.getContainer(), 'ui-selector-footer--show');\n\t}\n\n\thide(): void\n\t{\n\t\tDom.removeClass(this.getContainer(), 'ui-selector-footer--show');\n\t}\n\n\tgetOptions(): { [option: string]: any }\n\t{\n\t\treturn this.options;\n\t}\n\n\tgetOption(option: string, defaultValue?: any): any\n\t{\n\t\tif (!Type.isUndefined(this.options[option]))\n\t\t{\n\t\t\treturn this.options[option];\n\t\t}\n\t\telse if (!Type.isUndefined(defaultValue))\n\t\t{\n\t\t\treturn defaultValue;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tgetContainer()\n\t{\n\t\tif (this.container === null)\n\t\t{\n\t\t\tthis.container = Tag.render`\n\t\t\t\t<div class=\"ui-selector-footer\">${this.render()}</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.container;\n\t}\n\n\t/**\n\t * @abstract\n\t */\n\trender(): HTMLElement\n\t{\n\t\tthrow new Error('You must implement render() method.');\n\t}\n}","import { Type, Tag, Dom, Text, Cache, Reflection } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport ItemNode from '../../item/item-node';\nimport Dialog from '../dialog';\nimport BaseStub from './base-stub';\nimport DefaultStub from './default-stub';\nimport BaseFooter from '../footer/base-footer';\n\nimport type { TabLabelState, TabLabelStates, TabOptions } from './tab-options';\nimport type { FooterContent, FooterOptions } from '../footer/footer-content';\n\n/**\n * @memberof BX.UI.EntitySelector\n */\nexport default class Tab extends EventEmitter\n{\n\tid: string = null;\n\ttitle: string = null;\n\trootNode: ItemNode = null;\n\n\tdialog: Dialog = null;\n\tstub: BaseStub = null;\n\n\tvisible: boolean = true;\n\trendered: boolean = false;\n\tlocked: boolean = false;\n\tselected: boolean = false;\n\thovered: boolean = false;\n\n\ticon: TabLabelStates = {};\n\ttextColor: TabLabelStates = {};\n\tbgColor: TabLabelStates = {};\n\n\titemMaxDepth: number = 3;\n\n\tfooter: BaseFooter = null;\n\tshowDefaultFooter = true;\n\tcache = new Cache.MemoryCache();\n\n\tconstructor(dialog: Dialog, tabOptions: TabOptions)\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.UI.EntitySelector.Tab');\n\n\t\tconst options: TabOptions = Type.isPlainObject(tabOptions) ? tabOptions : {};\n\n\t\tif (!Type.isStringFilled(options.id))\n\t\t{\n\t\t\tthrow new Error('EntitySelector.Tab: \"id\" parameter is required.');\n\t\t}\n\n\t\tthis.setDialog(dialog);\n\t\tthis.id = options.id;\n\t\tthis.showDefaultFooter = options.showDefaultFooter !== false;\n\n\t\tthis.rootNode = new ItemNode(null, { itemOrder: options.itemOrder });\n\t\tthis.rootNode.setTab(this);\n\n\t\tthis.setVisible(options.visible);\n\t\tthis.setTitle(options.title);\n\t\tthis.setItemMaxDepth(options.itemMaxDepth);\n\t\tthis.setIcon(options.icon);\n\t\tthis.setTextColor(options.textColor);\n\t\tthis.setBgColor(options.bgColor);\n\t\tthis.setStub(options.stub, options.stubOptions);\n\t\tthis.setFooter(options.footer, options.footerOptions);\n\t}\n\n\tgetId(): string\n\t{\n\t\treturn this.id;\n\t}\n\n\t/**\n\t * @internal\n\t */\n\tsetDialog(dialog: Dialog): void\n\t{\n\t\tthis.dialog = dialog;\n\t}\n\n\tgetDialog(): Dialog\n\t{\n\t\treturn this.dialog;\n\t}\n\n\tgetStub(): ?BaseStub\n\t{\n\t\treturn this.stub;\n\t}\n\n\tsetStub(stub?: boolean | string, stubOptions?: { [option: string]: any }): void\n\t{\n\t\tlet instance = null;\n\t\tconst options = Type.isPlainObject(stubOptions) ? stubOptions : {};\n\n\t\tif (Type.isString(stub))\n\t\t{\n\t\t\tconst className = Reflection.getClass(stub);\n\t\t\tif (Type.isFunction(className))\n\t\t\t{\n\t\t\t\tinstance = new className(this, options);\n\t\t\t\tif (!(instance instanceof BaseStub))\n\t\t\t\t{\n\t\t\t\t\tconsole.error('EntitySelector: stub is not an instance of BaseStub.');\n\t\t\t\t\tinstance = null;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (!instance && stub !== false)\n\t\t{\n\t\t\tinstance = new DefaultStub(this, options);\n\t\t}\n\n\t\tthis.stub = instance;\n\t}\n\n\tgetFooter(): ?BaseFooter\n\t{\n\t\treturn this.footer;\n\t}\n\n\tsetFooter(footerContent: ?FooterContent, footerOptions?: FooterOptions)\n\t{\n\t\t/** @var {BaseFooter} */\n\t\tlet footer = null;\n\t\tif (footerContent !== null)\n\t\t{\n\t\t\tfooter = Dialog.createFooter(this, footerContent, footerOptions);\n\t\t\tif (footer === null)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tif (this.isRendered() && this.getFooter() !== null)\n\t\t{\n\t\t\tDom.remove(this.getFooter().getContainer());\n\t\t\tthis.getDialog().adjustFooter();\n\t\t}\n\n\t\tthis.footer = footer;\n\n\t\tif (this.isRendered())\n\t\t{\n\t\t\tthis.getDialog().appendFooter(footer);\n\t\t\tthis.getDialog().adjustFooter();\n\t\t}\n\t}\n\n\tcanShowDefaultFooter(): boolean\n\t{\n\t\treturn this.showDefaultFooter;\n\t}\n\n\tenableDefaultFooter(): void\n\t{\n\t\tthis.showDefaultFooter = true;\n\t\tthis.getDialog().adjustFooter();\n\t}\n\n\tdisableDefaultFooter(): void\n\t{\n\t\tthis.showDefaultFooter = false;\n\t\tthis.getDialog().adjustFooter();\n\t}\n\n\tgetRootNode(): ItemNode\n\t{\n\t\treturn this.rootNode;\n\t}\n\n\tsetTitle(title: string): void\n\t{\n\t\tif (Type.isStringFilled(title))\n\t\t{\n\t\t\tthis.title = title;\n\n\t\t\tif (this.isRendered())\n\t\t\t{\n\t\t\t\tthis.getTitleContainer().textContent = title;\n\t\t\t}\n\t\t}\n\t}\n\n\tgetTitle(): ?string\n\t{\n\t\treturn this.title;\n\t}\n\n\tsetIcon(icon: TabLabelStates | string): void\n\t{\n\t\treturn this.setProperty('icon', icon);\n\t}\n\n\tgetIcon(state?: TabLabelState): ?string\n\t{\n\t\treturn this.getPropertyByState('icon', state);\n\t}\n\n\tsetBgColor(bgColor: TabLabelStates | string): void\n\t{\n\t\treturn this.setProperty('bgColor', bgColor);\n\t}\n\n\tgetBgColor(state?: TabLabelState): ?string\n\t{\n\t\treturn this.getPropertyByState('bgColor', state);\n\t}\n\n\tsetTextColor(textColor: TabLabelStates | string): void\n\t{\n\t\treturn this.setProperty('textColor', textColor);\n\t}\n\n\tgetTextColor(state?: TabLabelState): ?string\n\t{\n\t\treturn this.getPropertyByState('textColor', state);\n\t}\n\n\tsetProperty(name: string, states: TabLabelStates | string): void\n\t{\n\t\tconst property = this[name];\n\t\tif (!property)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (Type.isPlainObject(states))\n\t\t{\n\t\t\tObject.keys(states).forEach(state => {\n\t\t\t\tif (Type.isStringFilled(states[state]))\n\t\t\t\t{\n\t\t\t\t\tproperty[state] = states[state];\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\telse if (Type.isStringFilled(states))\n\t\t{\n\t\t\tproperty['default'] = states;\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t */\n\tgetPropertyByState(name: string, state?: TabLabelState): ?string\n\t{\n\t\tconst property = this[name];\n\t\tconst labelState = Type.isStringFilled(state) ? state : 'default';\n\n\t\tif (!Type.isUndefined(property) && !Type.isUndefined(property[labelState]))\n\t\t{\n\t\t\treturn property[labelState];\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tgetPropertyByCurrentState(name: string): ?string\n\t{\n\t\tconst property = this[name];\n\t\tif (this.isSelected() && this.isHovered() && property.selectedHovered)\n\t\t{\n\t\t\treturn property.selectedHovered;\n\t\t}\n\t\telse if (this.isSelected() && property.selected)\n\t\t{\n\t\t\treturn property.selected;\n\t\t}\n\t\telse if (this.isHovered() && property.hovered)\n\t\t{\n\t\t\treturn property.hovered;\n\t\t}\n\t\telse if (property.default)\n\t\t{\n\t\t\treturn property.default;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tsetItemMaxDepth(depth: number): void\n\t{\n\t\tif (Type.isNumber(depth) && depth > 0)\n\t\t{\n\t\t\tthis.itemMaxDepth = depth;\n\t\t}\n\t}\n\n\tgetItemMaxDepth(): number\n\t{\n\t\treturn this.itemMaxDepth;\n\t}\n\n\tgetContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('container', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-selector-tab-content\">${this.getItemsContainer()}</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetLabelContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('label', () => {\n\t\t\tconst className = this.isVisible() ? '' : ' ui-selector-tab-label-hidden';\n\t\t\treturn Tag.render`\n\t\t\t\t<div \n\t\t\t\t\tclass=\"ui-selector-tab-label${className}\" \n\t\t\t\t\tonclick=\"${this.handleLabelClick.bind(this)}\"\n\t\t\t\t\tonmouseenter=\"${this.handleLabelMouseEnter.bind(this)}\"\n\t\t\t\t\tonmouseleave=\"${this.handleLabelMouseLeave.bind(this)}\"\n\t\t\t\t>\n\t\t\t\t\t${this.getIconContainer()}\n\t\t\t\t\t${this.getTitleContainer()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetIconContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('icon', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-selector-tab-icon\"></div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetTitleContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('title', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-selector-tab-title\">${Text.encode(this.getTitle())}</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetItemsContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('items', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-selector-items\"></div>\n\t\t\t`;\n\t\t});\n\t}\n\n\trender(): void\n\t{\n\t\tthis.getRootNode().render();\n\t\tthis.rendered = true;\n\t}\n\n\trenderLabel(): void\n\t{\n\t\tDom.style(this.getTitleContainer(), 'color', this.getPropertyByCurrentState('textColor'));\n\t\tDom.style(this.getLabelContainer(), 'background-color', this.getPropertyByCurrentState('bgColor'));\n\n\t\tconst icon = this.getPropertyByCurrentState('icon');\n\t\tDom.style(this.getIconContainer(), 'background-image', icon ? `url('${icon}')` : null);\n\t}\n\n\tisVisible(): boolean\n\t{\n\t\treturn this.visible;\n\t}\n\n\tsetVisible(flag: boolean): void\n\t{\n\t\tif (Type.isBoolean(flag))\n\t\t{\n\t\t\tthis.visible = flag;\n\n\t\t\tif (this.isRendered())\n\t\t\t{\n\t\t\t\tif (this.visible)\n\t\t\t\t{\n\t\t\t\t\tDom.remove(this.getLabelContainer(), 'ui-selector-tab-label-hidden');\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tDom.addClass(this.getLabelContainer(), 'ui-selector-tab-label-hidden');\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tisRendered(): boolean\n\t{\n\t\treturn this.rendered && this.getDialog() && this.getDialog().isRendered();\n\t}\n\n\tselect(): void\n\t{\n\t\tif (this.isSelected())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tDom.addClass(this.getContainer(), 'ui-selector-tab-content-active');\n\t\tif (this.isVisible())\n\t\t{\n\t\t\tDom.addClass(this.getLabelContainer(), 'ui-selector-tab-label-active');\n\t\t\tthis.renderLabel();\n\t\t}\n\n\t\tthis.getDialog().emit('Tab:onSelect', { tab: this });\n\t\tthis.selected = true;\n\n\t\tif (this.isVisible())\n\t\t{\n\t\t\tthis.renderLabel();\n\t\t}\n\n\t\tif (this.getFooter())\n\t\t{\n\t\t\tthis.getFooter().show();\n\t\t}\n\t}\n\n\tdeselect(): void\n\t{\n\t\tif (!this.isSelected())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tDom.removeClass(this.getContainer(), 'ui-selector-tab-content-active');\n\t\tif (this.isVisible())\n\t\t{\n\t\t\tDom.removeClass(this.getLabelContainer(), 'ui-selector-tab-label-active');\n\t\t}\n\n\t\tthis.getDialog().emit('Tab:onDeselect', { tab: this\t });\n\t\tthis.selected = false;\n\n\t\tif (this.isVisible())\n\t\t{\n\t\t\tthis.renderLabel();\n\t\t}\n\n\t\tif (this.getFooter())\n\t\t{\n\t\t\tthis.getFooter().hide();\n\t\t}\n\t}\n\n\thover(): void\n\t{\n\t\tif (this.isHovered())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tDom.addClass(this.getLabelContainer(), 'ui-selector-tab-label-hover');\n\t\tthis.hovered = true;\n\n\t\tthis.renderLabel();\n\t}\n\n\tunhover(): void\n\t{\n\t\tif (!this.isHovered())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tDom.removeClass(this.getLabelContainer(), 'ui-selector-tab-label-hover');\n\t\tthis.hovered = false;\n\n\t\tthis.renderLabel();\n\t}\n\n\tisSelected(): boolean\n\t{\n\t\treturn this.selected;\n\t}\n\n\tisHovered(): boolean\n\t{\n\t\treturn this.hovered;\n\t}\n\n\tlock(): void\n\t{\n\t\tthis.locked = true;\n\t\tDom.addClass(this.getContainer(), 'ui-selector-tab-content-locked');\n\t}\n\n\tunlock(): void\n\t{\n\t\tthis.locked = false;\n\t\tDom.removeClass(this.getContainer(), 'ui-selector-tab-content-locked');\n\t}\n\n\tisLocked(): boolean\n\t{\n\t\treturn this.locked;\n\t}\n\n\thandleLabelClick(): void\n\t{\n\t\tthis.getDialog().selectTab(this.getId());\n\t}\n\n\thandleLabelMouseEnter(): void\n\t{\n\t\tthis.hover();\n\t}\n\n\thandleLabelMouseLeave(): void\n\t{\n\t\tthis.unhover();\n\t}\n}","import { Event, Type } from 'main.core';\n\nexport default class Animation\n{\n\tstatic handleTransitionEnd(element: HTMLElement, propertyName: string | string[]): Promise\n\t{\n\t\tconst properties = Type.isArray(propertyName) ? new Set(propertyName) : new Set([propertyName]);\n\n\t\treturn new Promise(function(resolve) {\n\t\t\tconst handler = (event: TransitionEvent) => {\n\t\t\t\tif (event.target !== element || !properties.has(event.propertyName))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tproperties.delete(event.propertyName);\n\t\t\t\tif (properties.size === 0)\n\t\t\t\t{\n\t\t\t\t\tresolve(event);\n\t\t\t\t\tEvent.unbind(element, 'transitionend', handler);\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tEvent.bind(element, 'transitionend', handler);\n\t\t});\n\t}\n\n\tstatic handleAnimationEnd(element: HTMLElement, animationName: string)\n\t{\n\t\treturn new Promise(resolve => {\n\t\t\tconst handler = (event) => {\n\t\t\t\tif (!animationName || (event.animationName === animationName))\n\t\t\t\t{\n\t\t\t\t\tresolve(event);\n\t\t\t\t\tEvent.unbind(element, 'animationend', handler);\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tEvent.bind(element, 'animationend', handler);\n\t\t});\n\t}\n}","import { Cache, Tag, Type, Dom, Event } from 'main.core';\nimport Entity from '../entity/entity';\nimport Animation from '../util/animation';\nimport type TagSelector from './tag-selector';\nimport type { TagItemOptions } from './tag-item-options';\n\nexport default class TagItem\n{\n\tid: string | number = null;\n\tentityId: string = null;\n\tentityType: string = null;\n\ttitle: string = '';\n\n\tavatar: ?string = null;\n\tmaxWidth: ?number = null;\n\ttextColor: ?string = null;\n\tbgColor: ?string = null;\n\tfontWeight: ?string = null;\n\n\tlink: ?string = null;\n\tonclick: ?Function = null;\n\n\tdeselectable: ?boolean = null;\n\tcustomData: Map<string, any> = null;\n\n\tcache = new Cache.MemoryCache();\n\tselector: TagSelector = null;\n\trendered: ?boolean = false;\n\n\tconstructor(itemOptions: TagItemOptions)\n\t{\n\t\tconst options = Type.isPlainObject(itemOptions) ? itemOptions : {};\n\t\tif (!Type.isStringFilled(options.id) && !Type.isNumber(options.id))\n\t\t{\n\t\t\tthrow new Error('TagSelector.TagItem: \"id\" parameter is required.');\n\t\t}\n\n\t\tif (!Type.isStringFilled(options.entityId))\n\t\t{\n\t\t\tthrow new Error('TagSelector.TagItem: \"entityId\" parameter is required.');\n\t\t}\n\n\t\tthis.id = options.id;\n\t\tthis.entityId = options.entityId;\n\t\tthis.entityType = Type.isStringFilled(options.entityType) ? options.entityType : 'default';\n\t\tthis.customData =\n\t\t\tType.isPlainObject(options.customData) ? new Map(Object.entries(options.customData)) : new Map()\n\t\t;\n\n\t\tthis.onclick = Type.isFunction(options.onclick) ? options.onclick : null;\n\t\tthis.link = Type.isStringFilled(options.link) ? options.link : null;\n\n\t\tthis.setTitle(options.title);\n\t\tthis.setDeselectable(options.deselectable);\n\n\t\tthis.setAvatar(options.avatar);\n\t\tthis.setMaxWidth(options.maxWidth);\n\t\tthis.setTextColor(options.textColor);\n\t\tthis.setBgColor(options.bgColor);\n\t\tthis.setFontWeight(options.fontWeight);\n\t}\n\n\tgetId(): string | number\n\t{\n\t\treturn this.id;\n\t}\n\n\tgetEntityId(): string\n\t{\n\t\treturn this.entityId;\n\t}\n\n\tgetEntityType(): string\n\t{\n\t\treturn this.entityType;\n\t}\n\n\tgetSelector(): TagSelector\n\t{\n\t\treturn this.selector;\n\t}\n\n\tsetSelector(selector: TagSelector)\n\t{\n\t\tthis.selector = selector;\n\t}\n\n\tgetTitle(): string\n\t{\n\t\treturn this.title;\n\t}\n\n\tsetTitle(title: string): this\n\t{\n\t\tif (Type.isStringFilled(title))\n\t\t{\n\t\t\tthis.title = title;\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tgetAvatar(): ?string\n\t{\n\t\tif (this.avatar !== null)\n\t\t{\n\t\t\treturn this.avatar;\n\t\t}\n\t\telse if (this.getSelector().getTagAvatar() !== null)\n\t\t{\n\t\t\treturn this.getSelector().getTagAvatar();\n\t\t}\n\t\telse if (this.getEntityTagOption('avatar') !== null)\n\t\t{\n\t\t\treturn this.getEntityTagOption('avatar');\n\t\t}\n\n\t\treturn this.getEntityItemOption('avatar');\n\t}\n\n\tsetAvatar(avatar: ?string): this\n\t{\n\t\tif (Type.isString(avatar) || avatar === null)\n\t\t{\n\t\t\tthis.avatar = avatar;\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tgetTextColor(): ?string\n\t{\n\t\tif (this.textColor !== null)\n\t\t{\n\t\t\treturn this.textColor;\n\t\t}\n\t\telse if (this.getSelector().getTagTextColor() !== null)\n\t\t{\n\t\t\treturn this.getSelector().getTagTextColor();\n\t\t}\n\n\t\treturn this.getEntityTagOption('textColor');\n\t}\n\n\tsetTextColor(textColor: ?string): this\n\t{\n\t\tif (Type.isString(textColor) || textColor === null)\n\t\t{\n\t\t\tthis.textColor = textColor;\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tgetBgColor(): ?string\n\t{\n\t\tif (this.bgColor !== null)\n\t\t{\n\t\t\treturn this.bgColor;\n\t\t}\n\t\telse if (this.getSelector().getTagBgColor() !== null)\n\t\t{\n\t\t\treturn this.getSelector().getTagBgColor();\n\t\t}\n\n\t\treturn this.getEntityTagOption('bgColor');\n\t}\n\n\tsetBgColor(bgColor: ?string): this\n\t{\n\t\tif (Type.isString(bgColor) || bgColor === null)\n\t\t{\n\t\t\tthis.bgColor = bgColor;\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tgetFontWeight(): ?string\n\t{\n\t\tif (this.fontWeight !== null)\n\t\t{\n\t\t\treturn this.fontWeight;\n\t\t}\n\t\telse if (this.getSelector().getTagFontWeight() !== null)\n\t\t{\n\t\t\treturn this.getSelector().getTagFontWeight();\n\t\t}\n\n\t\treturn this.getEntityTagOption('fontWeight');\n\t}\n\n\tsetFontWeight(fontWeight: ?string): this\n\t{\n\t\tif (Type.isString(fontWeight) || fontWeight === null)\n\t\t{\n\t\t\tthis.fontWeight = fontWeight;\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tgetMaxWidth(): ?number\n\t{\n\t\tif (this.maxWidth !== null)\n\t\t{\n\t\t\treturn this.maxWidth;\n\t\t}\n\t\telse if (this.getSelector().getTagMaxWidth() !== null)\n\t\t{\n\t\t\treturn this.getSelector().getTagMaxWidth();\n\t\t}\n\n\t\treturn this.getEntityTagOption('maxWidth');\n\t}\n\n\tsetMaxWidth(width: ?number)\n\t{\n\t\tif ((Type.isNumber(width) && width >= 0) || width === null)\n\t\t{\n\t\t\tthis.maxWidth = width;\n\t\t}\n\t}\n\n\tsetDeselectable(flag: boolean): this\n\t{\n\t\tif (Type.isBoolean(flag))\n\t\t{\n\t\t\tthis.deselectable = flag;\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tisDeselectable(): boolean\n\t{\n\t\treturn this.deselectable !== null ? this.deselectable : this.getSelector().isDeselectable();\n\t}\n\n\tgetLink(): ?string\n\t{\n\t\treturn this.link;\n\t}\n\n\tgetOnclick(): ?Function\n\t{\n\t\treturn this.onclick;\n\t}\n\n\trender()\n\t{\n\t\tthis.getTitleContainer().textContent = this.getTitle();\n\t\tDom.attr(this.getContentContainer(), 'title', this.getTitle());\n\n\t\tconst avatar = this.getAvatar();\n\t\tif (Type.isStringFilled(avatar))\n\t\t{\n\t\t\tDom.addClass(this.getContainer(), 'ui-tag-selector-tag--has-avatar');\n\t\t\tDom.style(this.getAvatarContainer(), 'background-image', `url('${avatar}')`);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.removeClass(this.getContainer(), 'ui-tag-selector-tag--has-avatar');\n\t\t\tDom.style(this.getAvatarContainer(), 'background-image', null);\n\t\t}\n\n\t\tconst maxWidth = this.getMaxWidth();\n\t\tif (maxWidth > 0)\n\t\t{\n\t\t\tDom.style(this.getContainer(), 'max-width', `${maxWidth}px`);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.style(this.getContainer(), 'max-width', null);\n\t\t}\n\n\t\tif (this.isDeselectable())\n\t\t{\n\t\t\tDom.removeClass(this.getContainer(), 'ui-tag-selector-tag-readonly');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.addClass(this.getContainer(), 'ui-tag-selector-tag-readonly');\n\t\t}\n\n\t\tDom.style(this.getTitleContainer(), 'color', this.getTextColor());\n\t\tDom.style(this.getTitleContainer(), 'font-weight', this.getFontWeight());\n\t\tDom.style(this.getContainer(), 'background-color', this.getBgColor());\n\n\t\tthis.rendered = true;\n\t}\n\n\tgetContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('container', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-tag-selector-item ui-tag-selector-tag\">\n\t\t\t\t\t${this.getContentContainer()}\n\t\t\t\t\t${this.getRemoveIcon()}\n\t\t\t\t</div>`\n\t\t\t;\n\t\t});\n\t}\n\n\tgetContentContainer()\n\t{\n\t\treturn this.cache.remember('content-container', () => {\n\t\t\tif (Type.isStringFilled(this.getLink()))\n\t\t\t{\n\t\t\t\treturn Tag.render`\n\t\t\t\t\t<a\n\t\t\t\t\t\tclass=\"ui-tag-selector-tag-content\"\n\t\t\t\t\t\tonclick=\"${this.handleContainerClick.bind(this)}\"\n\t\t\t\t\t\thref=\"${this.getLink()}\"\n\t\t\t\t\t\ttarget=\"_blank\"\n\t\t\t\t\t>\n\t\t\t\t\t\t${this.getAvatarContainer()}\n\t\t\t\t\t\t${this.getTitleContainer()}\n\t\t\t\t\t</a>\n\t\t\t\t`;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst className = Type.isFunction(this.getOnclick()) ? ' ui-tag-selector-tag-content--clickable' : '';\n\t\t\t\treturn Tag.render`\n\t\t\t\t\t<div \n\t\t\t\t\t\tclass=\"ui-tag-selector-tag-content${className}\" \n\t\t\t\t\t\tonclick=\"${this.handleContainerClick.bind(this)}\"\n\t\t\t\t\t>\n\t\t\t\t\t\t${this.getAvatarContainer()}\n\t\t\t\t\t\t${this.getTitleContainer()}\n\t\t\t\t\t</div>\n\t\t\t\t\t\n\t\t\t\t`;\n\t\t\t}\n\t\t});\n\t}\n\n\tgetAvatarContainer()\n\t{\n\t\treturn this.cache.remember('avatar', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-tag-selector-tag-avatar\"></div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetTitleContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('title', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-tag-selector-tag-title\"></div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetRemoveIcon(): HTMLElement\n\t{\n\t\treturn this.cache.remember('remove-icon', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-tag-selector-tag-remove\" onclick=\"${this.handleRemoveIconClick.bind(this)}\"></div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetEntityTagOption(option: string): any\n\t{\n\t\treturn Entity.getTagOption(this.getEntityId(), option, this.getEntityType());\n\t}\n\n\tgetEntityItemOption(option: string): any\n\t{\n\t\treturn Entity.getItemOption(this.getEntityId(), option, this.getEntityType());\n\t}\n\n\tisRendered()\n\t{\n\t\treturn this.rendered && this.getSelector() && this.getSelector().isRendered();\n\t}\n\n\tremove(animate: boolean = true): Promise\n\t{\n\t\tif (animate === false)\n\t\t{\n\t\t\tDom.remove(this.getContainer());\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\treturn new Promise(resolve => {\n\t\t\tDom.style(this.getContainer(), 'width', `${this.getContainer().offsetWidth}px`);\n\t\t\tDom.addClass(this.getContainer(), 'ui-tag-selector-tag--remove');\n\t\t\tAnimation.handleAnimationEnd(this.getContainer(), 'ui-tag-selector-tag-remove').then(() => {\n\t\t\t\tDom.remove(this.getContainer());\n\t\t\t\tresolve();\n\t\t\t});\n\t\t});\n\t}\n\n\tshow(): Promise\n\t{\n\t\treturn new Promise(resolve => {\n\t\t\tDom.addClass(this.getContainer(), 'ui-tag-selector-tag--show');\n\t\t\tAnimation.handleAnimationEnd(this.getContainer(), 'ui-tag-selector-tag-show').then(() => {\n\t\t\t\tDom.removeClass(this.getContainer(), 'ui-tag-selector-tag--show');\n\t\t\t\tresolve();\n\t\t\t});\n\t\t});\n\t}\n\n\thandleContainerClick()\n\t{\n\t\tconst fn = this.getOnclick();\n\t\tif (Type.isFunction(fn))\n\t\t{\n\t\t\tfn(this);\n\t\t}\n\t}\n\n\thandleRemoveIconClick(event: MouseEvent)\n\t{\n\t\tevent.stopPropagation();\n\t\tif (this.isDeselectable())\n\t\t{\n\t\t\tthis.getSelector().removeTag(this);\n\t\t}\n\t}\n}","import { Cache, Dom, Tag, Text, Type, Loc, Browser } from 'main.core';\nimport { EventEmitter, BaseEvent } from 'main.core.events';\n\nimport Dialog from '../dialog/dialog';\nimport TagItem from './tag-item';\n\nimport type { TagSelectorOptions } from './tag-selector-options';\nimport type { ItemOptions } from '../item/item-options';\nimport type { TagItemOptions } from './tag-item-options';\n\n/**\n * @memberof BX.UI.EntitySelector\n */\nexport default class TagSelector extends EventEmitter\n{\n\ttags: TagItem[] = [];\n\tcache = new Cache.MemoryCache();\n\trendered: false;\n\n\tmultiple: boolean = true;\n\treadonly: boolean = false;\n\tlocked: boolean = false;\n\tdeselectable: boolean = true;\n\n\taddButtonCaption: ?string = null;\n\taddButtonCaptionMore: ?string = null;\n\tcreateButtonCaption: ?string = null;\n\taddButtonVisible: boolean = true;\n\tcreateButtonVisible: boolean = false;\n\ttextBoxVisible: boolean = false;\n\ttextBoxWidth: string | number | null = null;\n\tmaxHeight: ?number = null;\n\n\tplaceholder: string = '';\n\ttextBoxAutoHide: boolean = false;\n\ttextBoxOldValue = '';\n\n\ttagAvatar: ?string = null;\n\ttagTextColor: ?string = null;\n\ttagBgColor: ?string = null;\n\ttagFontWeight: ?string = null;\n\ttagMaxWidth: ?number = null;\n\n\tdialog: ?Dialog = null;\n\n\tconstructor(selectorOptions: TagSelectorOptions)\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.UI.EntitySelector.TagSelector');\n\n\t\tconst options = Type.isPlainObject(selectorOptions) ? selectorOptions : {};\n\t\tthis.id = Type.isStringFilled(options.id) ? options.id : `ui-tag-selector-${Text.getRandom().toLowerCase()}`;\n\t\tthis.multiple = Type.isBoolean(options.multiple) ? options.multiple : true;\n\n\t\tthis.addButtonVisible = options.showAddButton !== false;\n\t\tthis.createButtonVisible = options.showCreateButton === true;\n\t\tthis.textBoxVisible = options.showTextBox === true;\n\n\t\tthis.setReadonly(options.readonly);\n\t\tthis.setLocked(options.locked);\n\t\tthis.setAddButtonCaption(options.addButtonCaption);\n\t\tthis.setAddButtonCaptionMore(options.addButtonCaptionMore);\n\t\tthis.setCreateButtonCaption(options.createButtonCaption);\n\t\tthis.setPlaceholder(options.placeholder);\n\t\tthis.setTextBoxAutoHide(options.textBoxAutoHide);\n\t\tthis.setTextBoxWidth(options.textBoxWidth);\n\t\tthis.setDeselectable(options.deselectable);\n\t\tthis.setMaxHeight(options.maxHeight);\n\n\t\tthis.setTagAvatar(options.tagAvatar);\n\t\tthis.setTagMaxWidth(options.tagMaxWidth);\n\t\tthis.setTagTextColor(options.tagTextColor);\n\t\tthis.setTagBgColor(options.tagBgColor);\n\t\tthis.setTagFontWeight(options.tagFontWeight);\n\n\t\tif (Type.isPlainObject(options.dialogOptions))\n\t\t{\n\t\t\tlet selectedItems = Type.isArray(options.items) ? options.items : [];\n\t\t\tif (Type.isArray(options.dialogOptions.selectedItems))\n\t\t\t{\n\t\t\t\tselectedItems = selectedItems.concat(options.dialogOptions.selectedItems);\n\t\t\t}\n\n\t\t\tconst dialogOptions = Object.assign(\n\t\t\t\t{},\n\t\t\t\toptions.dialogOptions,\n\t\t\t\t{\n\t\t\t\t\ttagSelectorOptions: null,\n\t\t\t\t\tselectedItems,\n\t\t\t\t\tmultiple: this.isMultiple(),\n\t\t\t\t\ttagSelector: this\n\t\t\t\t}\n\t\t\t);\n\n\t\t\t(new Dialog(dialogOptions));\n\t\t}\n\t\telse if (Type.isArray(options.items))\n\t\t{\n\t\t\toptions.items.forEach((item) => {\n\t\t\t\tthis.addTag(item);\n\t\t\t});\n\t\t}\n\n\t\tthis.subscribeFromOptions(options.events);\n\t}\n\n\tgetDialog(): ?Dialog\n\t{\n\t\treturn this.dialog;\n\t}\n\n\tsetDialog(dialog: ?Dialog): void\n\t{\n\t\tthis.dialog = dialog;\n\t}\n\n\tsetReadonly(flag: boolean): void\n\t{\n\t\tif (Type.isBoolean(flag))\n\t\t{\n\t\t\tthis.readonly = flag;\n\n\t\t\tif (this.isRendered())\n\t\t\t{\n\t\t\t\tif (flag)\n\t\t\t\t{\n\t\t\t\t\tDom.addClass(this.getOuterContainer(), 'ui-tag-selector-container-readonly');\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tDom.removeClass(this.getOuterContainer(), 'ui-tag-selector-container-readonly');\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tisReadonly(): boolean\n\t{\n\t\treturn this.readonly;\n\t}\n\n\tsetLocked(flag: boolean): void\n\t{\n\t\tif (Type.isBoolean(flag))\n\t\t{\n\t\t\tthis.locked = flag;\n\n\t\t\tif (this.isRendered())\n\t\t\t{\n\t\t\t\tif (flag)\n\t\t\t\t{\n\t\t\t\t\tDom.addClass(this.getOuterContainer(), 'ui-tag-selector-container-locked');\n\t\t\t\t\tthis.getTextBox().disabled = true;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tDom.removeClass(this.getOuterContainer(), 'ui-tag-selector-container-locked');\n\t\t\t\t\tthis.getTextBox().disabled = false;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tlock(): void\n\t{\n\t\tif (!this.isLocked())\n\t\t{\n\t\t\tthis.setLocked(true);\n\t\t}\n\t}\n\n\tunlock(): void\n\t{\n\t\tif (this.isLocked())\n\t\t{\n\t\t\tthis.setLocked(false);\n\t\t}\n\t}\n\n\tisLocked(): boolean\n\t{\n\t\treturn this.locked;\n\t}\n\n\tisMultiple(): boolean\n\t{\n\t\treturn this.multiple;\n\t}\n\n\tsetDeselectable(flag: boolean): void\n\t{\n\t\tif (Type.isBoolean(flag))\n\t\t{\n\t\t\tconst changed = this.deselectable !== flag;\n\t\t\tthis.deselectable = flag;\n\n\t\t\tif (changed)\n\t\t\t{\n\t\t\t\tthis.updateTags();\n\t\t\t}\n\t\t}\n\t}\n\n\tisDeselectable(): boolean\n\t{\n\t\treturn this.deselectable;\n\t}\n\n\tgetTag(tagItem: TagItem | ItemOptions): ?TagItem\n\t{\n\t\tif (tagItem instanceof TagItem)\n\t\t{\n\t\t\treturn this.getTags().find(tag => tag === tagItem);\n\t\t}\n\t\telse if (Type.isPlainObject(tagItem))\n\t\t{\n\t\t\tconst { id, entityId } = tagItem;\n\t\t\treturn this.getTags().find((tag: TagItem) => tag.getId() === id && tag.getEntityId() === entityId);\n\t\t}\n\n\t\treturn null;\n\t}\n\n\taddTag(tagOptions: TagItemOptions): ?TagItem\n\t{\n\t\tif (!Type.isObjectLike(tagOptions))\n\t\t{\n\t\t\tthrow new Error('TagSelector.addTag: wrong item options.');\n\t\t}\n\n\t\tif (this.getTag(tagOptions))\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst tag = new TagItem(tagOptions);\n\t\ttag.setSelector(this);\n\n\t\tconst event = new BaseEvent({ data: { tag } });\n\t\tthis.emit('onBeforeTagAdd', event);\n\n\t\tif (event.isDefaultPrevented())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tif (!this.isMultiple())\n\t\t{\n\t\t\tthis.removeTags();\n\t\t}\n\n\t\tthis.tags.push(tag);\n\n\t\tthis.emit('onTagAdd', { tag });\n\n\t\tif (this.isRendered())\n\t\t{\n\t\t\ttag.render();\n\t\t\tthis.getItemsContainer().insertBefore(tag.getContainer(), this.getTextBox());\n\t\t\tif (tagOptions.animate !== false)\n\t\t\t{\n\t\t\t\ttag.show().then(() => {\n\t\t\t\t\tthis.getContainer().scrollTop = this.getContainer().scrollHeight - this.getContainer().offsetHeight;\n\t\t\t\t\tthis.emit('onAfterTagAdd', { tag });\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.emit('onAfterTagAdd', { tag });\n\t\t\t}\n\n\t\t\tthis.toggleAddButtonCaption();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.emit('onAfterTagAdd', { tag });\n\t\t}\n\n\t\treturn tag;\n\t}\n\n\tremoveTag(item: TagItem | ItemOptions, animate = true): void\n\t{\n\t\tconst tagItem = this.getTag(item);\n\t\tif (!tagItem)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst event = new BaseEvent({ data: { tag: tagItem } });\n\t\tthis.emit('onBeforeTagRemove', event);\n\n\t\tif (event.isDefaultPrevented())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.tags = this.tags.filter(el => el !== tagItem);\n\n\t\tthis.emit('onTagRemove', { tag: tagItem });\n\n\t\tif (this.isRendered())\n\t\t{\n\t\t\ttagItem.remove(animate).then(() => {\n\t\t\t\tthis.toggleAddButtonCaption();\n\t\t\t\tthis.emit('onAfterTagRemove', { tag: tagItem });\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.emit('onAfterTagRemove', { tag: tagItem });\n\t\t}\n\t}\n\n\tremoveTags(): void\n\t{\n\t\tthis.getTags().forEach(tag => {\n\t\t\tthis.removeTag(tag, false);\n\t\t});\n\t}\n\n\tgetTags(): TagItem[]\n\t{\n\t\treturn this.tags;\n\t}\n\n\trenderTo(node: HTMLElement): void\n\t{\n\t\tthis.rendered = true;\n\n\t\tthis.getTags().forEach((tag: TagItem) => {\n\t\t\ttag.render();\n\t\t\tthis.getItemsContainer().insertBefore(tag.getContainer(), this.getTextBox());\n\t\t});\n\n\t\tif (Type.isDomNode(node))\n\t\t{\n\t\t\tnode.appendChild(this.getOuterContainer());\n\t\t}\n\t}\n\n\tisRendered(): boolean\n\t{\n\t\treturn this.rendered;\n\t}\n\n\tupdateTags(): void\n\t{\n\t\tif (this.isRendered())\n\t\t{\n\t\t\tthis.getTags().forEach((tag: TagItem) => {\n\t\t\t\ttag.render();\n\t\t\t});\n\t\t}\n\t}\n\n\tgetOuterContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('outer-container', () => {\n\t\t\tlet className = this.isReadonly() ? ' ui-tag-selector-container-readonly' : '';\n\t\t\tclassName += this.isLocked() ? ' ui-tag-selector-container-locked' : '';\n\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-tag-selector-outer-container${className}\">${this.getContainer()}</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('container', () => {\n\t\t\tconst style =\n\t\t\t\tthis.getMaxHeight()\n\t\t\t\t\t? ` style=\"max-height: ${this.getMaxHeight()}px; -ms-overflow-style: -ms-autohiding-scrollbar;\"`\n\t\t\t\t\t: ''\n\t\t\t;\n\n\t\t\treturn Tag.render`\n\t\t\t\t<div \n\t\t\t\t\tclass=\"ui-tag-selector-container\" \n\t\t\t\t\tonclick=\"${this.handleContainerClick.bind(this)}\"\n\t\t\t\t\t${style}\n\t\t\t\t>\n\t\t\t\t\t${this.getItemsContainer()}\n\t\t\t\t\t${this.getCreateButton()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetItemsContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('items-container', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-tag-selector-items\">\n\t\t\t\t\t${this.getTextBox()}\n\t\t\t\t\t${this.getAddButton()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetTextBox(): HTMLInputElement\n\t{\n\t\treturn this.cache.remember('text-box', () => {\n\t\t\tconst className = this.textBoxVisible ? '' : ' ui-tag-selector-item-hidden';\n\t\t\tconst input = Tag.render`\n\t\t\t\t<input \n\t\t\t\t\ttype=\"text\" \n\t\t\t\t\tclass=\"ui-tag-selector-item ui-tag-selector-text-box${className}\" \n\t\t\t\t\tautocomplete=\"off\"\n\t\t\t\t\tplaceholder=\"${Text.encode(this.getPlaceholder())}\"\n\t\t\t\t\toninput=\"${this.handleTextBoxInput.bind(this)}\"\n\t\t\t\t\tonblur=\"${this.handleTextBoxBlur.bind(this)}\"\n\t\t\t\t\tonkeyup=\"${this.handleTextBoxKeyUp.bind(this)}\"\n\t\t\t\t\tonkeydown=\"${this.handleTextBoxKeyDown.bind(this)}\"\n\t\t\t\t\tvalue=\"\"\n\t\t\t\t>\n\t\t\t`;\n\n\t\t\tconst width = this.getTextBoxWidth();\n\t\t\tif (width !== null)\n\t\t\t{\n\t\t\t\tDom.style(input, 'width', Type.isStringFilled(width) ? width : `${width}px`);\n\t\t\t}\n\n\t\t\tif (this.isLocked())\n\t\t\t{\n\t\t\t\tinput.disabled = true;\n\t\t\t}\n\n\t\t\treturn input;\n\t\t});\n\t}\n\n\tgetItemsHeight(): number\n\t{\n\t\treturn this.getItemsContainer().scrollHeight;\n\t}\n\n\tcalcHeight(): number\n\t{\n\t\tif (this.getMaxHeight() !== null)\n\t\t{\n\t\t\treturn Math.min(this.getItemsHeight(), this.getMaxHeight());\n\t\t}\n\n\t\treturn Math.max(this.getItemsHeight(), this.getMinHeight());\n\t}\n\n\tgetTextBoxValue(): string\n\t{\n\t\treturn this.getTextBox().value;\n\t}\n\n\tclearTextBox(): void\n\t{\n\t\tthis.getTextBox().value = '';\n\t}\n\n\tshowTextBox(): void\n\t{\n\t\tthis.textBoxVisible = true;\n\t\tDom.removeClass(this.getTextBox(), 'ui-tag-selector-item-hidden');\n\t}\n\n\thideTextBox(): void\n\t{\n\t\tthis.textBoxVisible = false;\n\t\tDom.addClass(this.getTextBox(), 'ui-tag-selector-item-hidden');\n\t}\n\n\tfocusTextBox(): void\n\t{\n\t\tthis.getTextBox().focus();\n\t}\n\n\tsetTextBoxAutoHide(autoHide: boolean): void\n\t{\n\t\tif (Type.isBoolean(autoHide))\n\t\t{\n\t\t\tthis.textBoxAutoHide = autoHide;\n\t\t}\n\t}\n\n\tgetTextBoxWidth(): string | number | null\n\t{\n\t\treturn this.textBoxWidth;\n\t}\n\n\tsetTextBoxWidth(width: string | number | null): void\n\t{\n\t\tif (Type.isStringFilled(width) || width === null)\n\t\t{\n\t\t\tthis.textBoxWidth = width;\n\t\t\tif (this.isRendered())\n\t\t\t{\n\t\t\t\tDom.style(this.getTextBox(), 'width', width);\n\t\t\t}\n\t\t}\n\t\telse if (Type.isNumber(width) && width > 0)\n\t\t{\n\t\t\tthis.textBoxWidth = width;\n\t\t\tif (this.isRendered())\n\t\t\t{\n\t\t\t\tDom.style(this.getTextBox(), 'width', `${width}px`);\n\t\t\t}\n\t\t}\n\t}\n\n\tgetTagMaxWidth(): ?number\n\t{\n\t\treturn this.tagMaxWidth;\n\t}\n\n\tsetTagMaxWidth(width: ?number): void\n\t{\n\t\tif ((Type.isNumber(width) && width >= 0) || width === null)\n\t\t{\n\t\t\tthis.tagMaxWidth = width;\n\t\t\tthis.updateTags();\n\t\t}\n\t}\n\n\tgetTagAvatar(): ?string\n\t{\n\t\treturn this.tagAvatar;\n\t}\n\n\tsetTagAvatar(tagAvatar: ?string): void\n\t{\n\t\tif (Type.isString(tagAvatar) || tagAvatar === null)\n\t\t{\n\t\t\tthis.tagAvatar = tagAvatar;\n\t\t\tthis.updateTags();\n\t\t}\n\t}\n\n\tgetTagTextColor(): ?string\n\t{\n\t\treturn this.tagTextColor;\n\t}\n\n\tsetTagTextColor(textColor: ?string): void\n\t{\n\t\tif (Type.isString(textColor) || textColor === null)\n\t\t{\n\t\t\tthis.tagTextColor = textColor;\n\t\t\tthis.updateTags();\n\t\t}\n\t}\n\n\tgetTagBgColor(): ?string\n\t{\n\t\treturn this.tagBgColor;\n\t}\n\n\tsetTagBgColor(bgColor: ?string): void\n\t{\n\t\tif (Type.isString(bgColor) || bgColor === null)\n\t\t{\n\t\t\tthis.tagBgColor = bgColor;\n\t\t\tthis.updateTags();\n\t\t}\n\t}\n\n\tgetTagFontWeight(): ?string\n\t{\n\t\treturn this.tagFontWeight;\n\t}\n\n\tsetTagFontWeight(fontWeight: ?string): void\n\t{\n\t\tif (Type.isString(fontWeight) || fontWeight === null)\n\t\t{\n\t\t\tthis.tagFontWeight = fontWeight;\n\t\t\tthis.updateTags();\n\t\t}\n\t}\n\n\tgetPlaceholder(): string\n\t{\n\t\treturn this.placeholder;\n\t}\n\n\tsetPlaceholder(placeholder: string): void\n\t{\n\t\tif (Type.isStringFilled(placeholder))\n\t\t{\n\t\t\tthis.placeholder = placeholder;\n\n\t\t\tif (this.isRendered())\n\t\t\t{\n\t\t\t\tthis.getTextBox().placeholder = placeholder;\n\t\t\t}\n\t\t}\n\t}\n\n\tgetMaxHeight(): ?number\n\t{\n\t\treturn this.maxHeight;\n\t}\n\n\tgetMinHeight(): number\n\t{\n\t\treturn 33;\n\t}\n\n\tsetMaxHeight(height: ?number): void\n\t{\n\t\tif ((Type.isNumber(height) && height > 0) || height === null)\n\t\t{\n\t\t\tthis.maxHeight = height;\n\t\t\tif (this.isRendered())\n\t\t\t{\n\t\t\t\tDom.style(this.getContainer(), 'max-height', height > 0 ? `${height}px` : null);\n\t\t\t\tDom.style(this.getContainer(), '-ms-overflow-style', height > 0 ? '-ms-autohiding-scrollbar' : null);\n\t\t\t}\n\t\t}\n\t}\n\n\tgetAddButton(): HTMLElement\n\t{\n\t\treturn this.cache.remember('add-button', () => {\n\t\t\tconst caption = Text.encode(this.getActualButtonCaption());\n\t\t\tconst className = this.addButtonVisible ? '' : ' ui-tag-selector-item-hidden';\n\n\t\t\treturn Tag.render`\n\t\t\t\t<span class=\"ui-tag-selector-item ui-tag-selector-add-button${className}\">\n\t\t\t\t\t<span \n\t\t\t\t\t\tclass=\"ui-tag-selector-add-button-caption\" \n\t\t\t\t\t\tonclick=\"${this.handleAddButtonClick.bind(this)}\">${caption}</span>\n\t\t\t\t</span>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetAddButtonCaption(): string\n\t{\n\t\treturn (\n\t\t\tthis.addButtonCaption === null\n\t\t\t\t? Loc.getMessage('UI_TAG_SELECTOR_ADD_BUTTON_CAPTION')\n\t\t\t\t: this.addButtonCaption\n\t\t);\n\t}\n\n\tsetAddButtonCaption(caption: string): void\n\t{\n\t\tif (Type.isStringFilled(caption))\n\t\t{\n\t\t\tthis.addButtonCaption = caption;\n\n\t\t\tif (this.isRendered())\n\t\t\t{\n\t\t\t\tthis.toggleAddButtonCaption();\n\t\t\t}\n\t\t}\n\t}\n\n\tgetAddButtonCaptionMore(): ?string\n\t{\n\t\treturn (\n\t\t\tthis.addButtonCaptionMore === null\n\t\t\t\t? this.isMultiple()\n\t\t\t\t\t? Loc.getMessage('UI_TAG_SELECTOR_ADD_BUTTON_CAPTION')\n\t\t\t\t\t: Loc.getMessage('UI_TAG_SELECTOR_ADD_BUTTON_CAPTION_SINGLE')\n\t\t\t\t: this.addButtonCaptionMore\n\t\t);\n\t}\n\n\tsetAddButtonCaptionMore(caption: string): void\n\t{\n\t\tif (Type.isStringFilled(caption))\n\t\t{\n\t\t\tthis.addButtonCaptionMore = caption;\n\n\t\t\tif (this.isRendered())\n\t\t\t{\n\t\t\t\tthis.toggleAddButtonCaption();\n\t\t\t}\n\t\t}\n\t}\n\n\ttoggleAddButtonCaption(): void\n\t{\n\t\tif (this.getAddButtonCaptionMore() === null)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.getAddButton().children[0].textContent = this.getActualButtonCaption();\n\t}\n\n\tgetActualButtonCaption()\n\t{\n\t\treturn (\n\t\t\tthis.getTags().length > 0 && this.getAddButtonCaptionMore() !== null\n\t\t\t\t? this.getAddButtonCaptionMore()\n\t\t\t\t: this.getAddButtonCaption()\n\t\t);\n\t}\n\n\tshowAddButton(): void\n\t{\n\t\tthis.addButtonVisible = true;\n\t\tDom.removeClass(this.getAddButton(), 'ui-tag-selector-item-hidden');\n\t}\n\n\thideAddButton(): void\n\t{\n\t\tthis.addButtonVisible = false;\n\t\tDom.addClass(this.getAddButton(), 'ui-tag-selector-item-hidden');\n\t}\n\n\tgetCreateButton(): HTMLElement\n\t{\n\t\treturn this.cache.remember('create-button', () => {\n\t\t\tconst className = this.createButtonVisible ? '' : ' ui-tag-selector-item-hidden';\n\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-tag-selector-create-button${className}\">\n\t\t\t\t\t<span \n\t\t\t\t\t\tclass=\"ui-tag-selector-create-button-caption\"\n\t\t\t\t\t\tonclick=\"${this.handleCreateButtonClick.bind(this)}\"\n\t\t\t\t\t>${Text.encode(this.getCreateButtonCaption())}</span>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tshowCreateButton(): void\n\t{\n\t\tthis.createButtonVisible = true;\n\t\tDom.removeClass(this.getCreateButton(), 'ui-tag-selector-item-hidden');\n\t}\n\n\thideCreateButton(): void\n\t{\n\t\tthis.createButtonVisible = false;\n\t\tDom.addClass(this.getCreateButton(), 'ui-tag-selector-item-hidden');\n\t}\n\n\tgetCreateButtonCaption(): string\n\t{\n\t\treturn (\n\t\t\tthis.createButtonCaption === null\n\t\t\t\t? Loc.getMessage('UI_TAG_SELECTOR_CREATE_BUTTON_CAPTION')\n\t\t\t\t: this.createButtonCaption\n\t\t);\n\t}\n\n\tsetCreateButtonCaption(caption: string): void\n\t{\n\t\tif (Type.isStringFilled(caption))\n\t\t{\n\t\t\tthis.createButtonCaption = caption;\n\n\t\t\tif (this.isRendered())\n\t\t\t{\n\t\t\t\tthis.getCreateButton().children[0].textContent = caption;\n\t\t\t}\n\t\t}\n\t}\n\n\thandleContainerClick(event: MouseEvent): void\n\t{\n\t\tthis.emit('onContainerClick', { selector: this, event });\n\t}\n\n\thandleTextBoxInput(event: InputEvent): void\n\t{\n\t\tconst newValue = this.getTextBoxValue();\n\t\tif (newValue !== this.textBoxOldValue)\n\t\t{\n\t\t\tthis.textBoxOldValue = newValue;\n\t\t\tthis.emit('onInput', { selector: this, event });\n\t\t}\n\t}\n\n\thandleTextBoxBlur(event: FocusEvent): void\n\t{\n\t\tthis.emit('onBlur', { selector: this, event });\n\n\t\tif (this.textBoxAutoHide)\n\t\t{\n\t\t\tthis.getTextBox().value = '';\n\t\t\tthis.showAddButton();\n\t\t\tthis.hideTextBox();\n\t\t}\n\t}\n\n\thandleTextBoxKeyUp(event: KeyboardEvent): void\n\t{\n\t\tthis.emit('onKeyUp', { selector: this, event });\n\n\t\tif (event.key === 'Enter')\n\t\t{\n\t\t\tthis.emit('onEnter', { selector: this, event });\n\n\t\t\tif (this.textBoxAutoHide)\n\t\t\t{\n\t\t\t\tthis.getTextBox().value = '';\n\t\t\t\tthis.showAddButton();\n\t\t\t\tthis.hideTextBox();\n\t\t\t}\n\t\t}\n\t}\n\n\thandleTextBoxKeyDown(event: KeyboardEvent): void\n\t{\n\t\tif (event.key === 'Enter')\n\t\t{\n\t\t\t// prevent a form submit\n\t\t\tevent.preventDefault();\n\n\t\t\tif ((Browser.isMac() && event.metaKey) || event.ctrlKey)\n\t\t\t{\n\t\t\t\tthis.emit('onMetaEnter', { selector: this, event });\n\t\t\t}\n\t\t}\n\n\t\tthis.emit('onKeyDown', { selector: this, event });\n\t}\n\n\thandleAddButtonClick(event: MouseEvent): void\n\t{\n\t\tthis.hideAddButton();\n\t\tthis.showTextBox();\n\t\tthis.focusTextBox();\n\n\t\tthis.emit('onAddButtonClick', { selector: this, event });\n\t}\n\n\thandleCreateButtonClick(event: MouseEvent): void\n\t{\n\t\tthis.emit('onCreateButtonClick', { selector: this, event });\n\t}\n}","import { Dom, Event, Type } from 'main.core';\nimport { BaseEvent } from 'main.core.events';\nimport type ItemNode from '../item/item-node';\nimport type Tab from './tabs/tab';\nimport type Dialog from './dialog';\n\nexport default class Navigation\n{\n\tdialog: Dialog = null;\n\tlockedTab: Tab = null;\n\tenabled: boolean = false;\n\n\tstatic keyMap: Object<string, string> = { // IE/Edge\n\t\t'Down': 'ArrowDown',\n\t\t'Up': 'ArrowUp',\n\t\t'Left': 'ArrowLeft',\n\t\t'Right': 'ArrowRight',\n\t\t'Spacebar': 'Space',\n\t\t' ': 'Space' // All\n\t};\n\n\tconstructor(dialog: Dialog)\n\t{\n\t\tthis.dialog = dialog;\n\n\t\tthis.dialog.subscribe('onShow', this.handleDialogShow.bind(this));\n\t\tthis.dialog.subscribe('onHide', this.handleDialogHide.bind(this));\n\t\tthis.dialog.subscribe('onDestroy', this.handleDialogDestroy.bind(this));\n\n\t\tthis.handleDocumentKeyDown = this.handleDocumentKeyDown.bind(this);\n\t\tthis.handleDocumentMouseMove = this.handleDocumentMouseMove.bind(this);\n\t}\n\n\tgetDialog(): Dialog\n\t{\n\t\treturn this.dialog;\n\t}\n\n\tenable(): void\n\t{\n\t\tif (!this.isEnabled())\n\t\t{\n\t\t\tthis.bindEvents();\n\t\t}\n\n\t\tthis.enabled = true;\n\t}\n\n\tdisable(): void\n\t{\n\t\tif (this.isEnabled())\n\t\t{\n\t\t\tthis.unbindEvents();\n\t\t\tthis.unlockTab();\n\t\t}\n\n\t\tthis.enabled = false;\n\t}\n\n\tisEnabled(): boolean\n\t{\n\t\treturn this.enabled;\n\t}\n\n\tbindEvents(): void\n\t{\n\t\tEvent.bind(document, 'keydown', this.handleDocumentKeyDown);\n\t}\n\n\tunbindEvents(): void\n\t{\n\t\tEvent.unbind(document, 'keydown', this.handleDocumentKeyDown);\n\t}\n\n\tgetNextNode(): ?ItemNode\n\t{\n\t\tif (!this.getActiveNode())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tlet nextNode = null;\n\t\tlet currentNode = this.getActiveNode();\n\n\t\tif (currentNode.hasChildren() && currentNode.isOpen())\n\t\t{\n\t\t\tnextNode = currentNode.getFirstChild();\n\t\t}\n\n\t\twhile (nextNode === null && currentNode !== null)\n\t\t{\n\t\t\tnextNode = currentNode.getNextSibling();\n\t\t\tif (nextNode)\n\t\t\t{\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tcurrentNode = currentNode.getParentNode();\n\t\t}\n\n\t\treturn nextNode;\n\t}\n\n\tgetPreviousNode(): ?ItemNode\n\t{\n\t\tif (!this.getActiveNode())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tlet previousNode = this.getActiveNode().getPreviousSibling();\n\t\tif (previousNode)\n\t\t{\n\t\t\twhile (previousNode.hasChildren() && previousNode.isOpen())\n\t\t\t{\n\t\t\t\tconst lastChild = previousNode.getLastChild();\n\t\t\t\tif (lastChild === null)\n\t\t\t\t{\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tpreviousNode = lastChild;\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (this.getActiveNode().getParentNode() && !this.getActiveNode().getParentNode().isRoot())\n\t\t\t{\n\t\t\t\tpreviousNode = this.getActiveNode().getParentNode();\n\t\t\t}\n\t\t}\n\n\t\treturn previousNode;\n\t}\n\n\tgetFirstNode(): ?ItemNode\n\t{\n\t\tconst tab = this.getDialog().getActiveTab();\n\t\treturn tab && tab.getRootNode().getFirstChild();\n\t}\n\n\tgetLastNode(): ?ItemNode\n\t{\n\t\tconst tab = this.getDialog().getActiveTab();\n\t\tif (!tab)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tlet lastNode = tab.getRootNode().getLastChild();\n\t\tif (lastNode !== null)\n\t\t{\n\t\t\twhile (lastNode.hasChildren() && lastNode.isOpen())\n\t\t\t{\n\t\t\t\tconst lastChild = lastNode.getLastChild();\n\t\t\t\tif (lastChild === null)\n\t\t\t\t{\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tlastNode = lastChild;\n\t\t\t}\n\t\t}\n\n\t\treturn lastNode;\n\t}\n\n\tgetActiveNode(): ?ItemNode\n\t{\n\t\treturn this.getDialog().getFocusedNode();\n\t}\n\n\tfocusOnNode(node: ItemNode): void\n\t{\n\t\tif (node)\n\t\t{\n\t\t\tnode.focus();\n\t\t\tnode.scrollIntoView();\n\t\t}\n\t}\n\n\tlockTab(): void\n\t{\n\t\tconst activeTab = this.getDialog().getActiveTab();\n\t\tif (this.lockedTab === activeTab)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\telse if (this.lockedTab !== null)\n\t\t{\n\t\t\tthis.unlockTab();\n\t\t}\n\n\t\tthis.lockedTab = activeTab;\n\t\tthis.lockedTab.lock();\n\n\t\tEvent.bind(document, 'mousemove', this.handleDocumentMouseMove);\n\t}\n\n\tunlockTab(): void\n\t{\n\t\tif (this.lockedTab === null)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.lockedTab.unlock();\n\t\tthis.lockedTab = null;\n\n\t\tEvent.unbind(document, 'mousemove', this.handleDocumentMouseMove);\n\t}\n\n\thandleDialogShow(): void\n\t{\n\t\tthis.enable();\n\t}\n\n\thandleDialogHide(): void\n\t{\n\t\tthis.disable();\n\t}\n\n\thandleDialogDestroy(): void\n\t{\n\t\tthis.disable();\n\t}\n\n\thandleDocumentMouseMove(): void\n\t{\n\t\tthis.unlockTab();\n\t}\n\n\thandleDocumentKeyDown(event: KeyboardEvent): void\n\t{\n\t\tif (!this.getDialog().isOpen())\n\t\t{\n\t\t\tthis.unbindEvents();\n\t\t\treturn;\n\t\t}\n\n\t\tif (event.metaKey || event.ctrlKey || event.altKey)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst activeTab = this.getDialog().getActiveTab();\n\t\tif (!activeTab)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst keyName = this.constructor.keyMap[event.key] || event.key;\n\t\tconst query = this.getDialog().getTagSelectorQuery();\n\t\tif (Type.isStringFilled(query) && ['ArrowLeft', 'ArrowRight'].includes(keyName))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst handler: ?Function = this[`handle${keyName}Press`];\n\t\tif (handler)\n\t\t{\n\t\t\thandler.call(this, event);\n\t\t\tthis.lockTab(activeTab);\n\t\t\tevent.preventDefault();\n\t\t}\n\t}\n\n\thandleArrowDownPress(): void\n\t{\n\t\tif (!this.getActiveNode())\n\t\t{\n\t\t\tconst firstNode = this.getFirstNode();\n\t\t\tthis.focusOnNode(firstNode);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst nextNode = this.getNextNode();\n\t\t\tif (nextNode)\n\t\t\t{\n\t\t\t\tthis.focusOnNode(nextNode);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst firstNode = this.getFirstNode();\n\t\t\t\tthis.focusOnNode(firstNode);\n\t\t\t}\n\t\t}\n\t}\n\n\thandleArrowUpPress(): void\n\t{\n\t\tif (!this.getActiveNode())\n\t\t{\n\t\t\tconst lastNode = this.getLastNode();\n\t\t\tthis.focusOnNode(lastNode);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst previousNode = this.getPreviousNode();\n\t\t\tif (previousNode)\n\t\t\t{\n\t\t\t\tthis.focusOnNode(previousNode);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst lastNode = this.getLastNode();\n\t\t\t\tthis.focusOnNode(lastNode);\n\t\t\t}\n\t\t}\n\t}\n\n\thandleArrowRightPress(): void\n\t{\n\t\tif (this.getActiveNode())\n\t\t{\n\t\t\tthis.getActiveNode().expand();\n\t\t}\n\t}\n\n\thandleArrowLeftPress(): void\n\t{\n\t\tif (!this.getActiveNode())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.getActiveNode().isOpen())\n\t\t{\n\t\t\tthis.getActiveNode().collapse();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst parentNode = this.getActiveNode().getParentNode();\n\t\t\tif (parentNode && !parentNode.isRoot())\n\t\t\t{\n\t\t\t\tthis.focusOnNode(parentNode);\n\t\t\t}\n\t\t}\n\t}\n\n\thandleEnterPress(): void\n\t{\n\t\tif (this.getActiveNode())\n\t\t{\n\t\t\tthis.getActiveNode().click();\n\t\t}\n\t}\n\n\t/*handleSpacePress(event: KeyboardEvent): void\n\t{\n\t\tconst searchQuery = this.getDialog().getTagSelector() && this.getDialog().getTagSelector().getTextBoxValue();\n\t\tif (this.getActiveNode() && !Type.isStringFilled(searchQuery))\n\t\t{\n\t\t\tthis.getActiveNode().click();\n\t\t\tevent.preventDefault();\n\t\t}\n\t}*/\n\n\thandleTabPress(event: KeyboardEvent): void\n\t{\n\t\tconst activeTab = this.getDialog().getActiveTab();\n\t\tif (!activeTab)\n\t\t{\n\t\t\tthis.getDialog().selectFirstTab();\n\t\t\treturn;\n\t\t}\n\n\t\tif (event.shiftKey)\n\t\t{\n\t\t\tconst previousTab = this.getDialog().getPreviousTab();\n\t\t\tif (previousTab)\n\t\t\t{\n\t\t\t\tthis.getDialog().selectTab(previousTab.getId());\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.getDialog().selectLastTab();\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst nextTab = this.getDialog().getNextTab();\n\t\t\tif (nextTab)\n\t\t\t{\n\t\t\t\tthis.getDialog().selectTab(nextTab.getId());\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.getDialog().selectFirstTab();\n\t\t\t}\n\t\t}\n\t}\n}","import { EventEmitter } from 'main.core.events';\nimport type { BaseEvent } from 'main.core.events';\nimport type Dialog from '../dialog';\n\nexport default class SliderIntegration\n{\n\tdialog: Dialog = null;\n\tsliders: Set = new Set();\n\n\tconstructor(dialog: Dialog)\n\t{\n\t\tthis.dialog = dialog;\n\n\t\tthis.dialog.subscribe('onShow', this.handleDialogShow.bind(this));\n\t\tthis.dialog.subscribe('onHide', this.handleDialogHide.bind(this));\n\t\tthis.dialog.subscribe('onDestroy', this.handleDialogDestroy.bind(this));\n\n\t\tthis.handleSliderOpen = this.handleSliderOpen.bind(this);\n\t\tthis.handleSliderClose = this.handleSliderClose.bind(this);\n\t}\n\n\tgetDialog(): Dialog\n\t{\n\t\treturn this.dialog;\n\t}\n\n\tbindEvents()\n\t{\n\t\tthis.unbindEvents();\n\n\t\tEventEmitter.subscribe('SidePanel.Slider:onOpen', this.handleSliderOpen);\n\t\tEventEmitter.subscribe('SidePanel.Slider:onCloseComplete', this.handleSliderClose);\n\t\tEventEmitter.subscribe('SidePanel.Slider:onDestroy', this.handleSliderClose);\n\t}\n\n\tunbindEvents()\n\t{\n\t\tEventEmitter.unsubscribe('SidePanel.Slider:onOpen', this.handleSliderOpen);\n\t\tEventEmitter.unsubscribe('SidePanel.Slider:onCloseComplete', this.handleSliderClose);\n\t\tEventEmitter.unsubscribe('SidePanel.Slider:onDestroy', this.handleSliderClose);\n\t}\n\n\thandleDialogShow()\n\t{\n\t\tthis.bindEvents();\n\t}\n\n\thandleDialogHide()\n\t{\n\t\tthis.sliders.clear();\n\t\tthis.unbindEvents();\n\t\tthis.getDialog().unfreeze();\n\t}\n\n\thandleDialogDestroy()\n\t{\n\t\tthis.sliders.clear();\n\t\tthis.unbindEvents();\n\t\tthis.getDialog().unfreeze();\n\t}\n\n\thandleSliderOpen(event: BaseEvent): void\n\t{\n\t\tconst [sliderEvent] = event.getData();\n\t\tconst slider = sliderEvent.getSlider();\n\n\t\tthis.sliders.add(slider);\n\n\t\tthis.getDialog().freeze();\n\t}\n\n\thandleSliderClose(event: BaseEvent): void\n\t{\n\t\tconst [sliderEvent] = event.getData();\n\t\tconst slider = sliderEvent.getSlider();\n\n\t\tthis.sliders.delete(slider);\n\n\t\tif (this.sliders.size === 0)\n\t\t{\n\t\t\tthis.getDialog().unfreeze();\n\t\t}\n\t}\n}","import { Tag, Type } from 'main.core';\nimport BaseFooter from './base-footer';\nimport type Dialog from '../dialog';\nimport type Tab from '../tabs/tab';\n\nexport default class DefaultFooter extends BaseFooter\n{\n\tcontent: HTMLElement = null;\n\n\tconstructor(context: Dialog | Tab, options: { [option: string]: any })\n\t{\n\t\tsuper(context, options);\n\n\t\tthis.setContent(this.getOption('content'));\n\t}\n\n\trender()\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"ui-selector-footer-default\">\n\t\t\t\t${this.getContent() ? this.getContent() : '' }\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tgetContent(): HTMLElement | HTMLElement[] | string | null\n\t{\n\t\treturn this.content;\n\t}\n\n\tsetContent(content: string | HTMLElement)\n\t{\n\t\tif (Type.isStringFilled(content) || Type.isDomNode(content) || Type.isArrayFilled(content))\n\t\t{\n\t\t\tthis.content = content;\n\t\t}\n\t}\n}","import { Loc } from 'main.core';\nimport Tab from './tab';\nimport type { TabOptions } from './tab-options';\nimport type Dialog from '../dialog';\n\nexport default class RecentTab extends Tab\n{\n\tconstructor(dialog: Dialog, tabOptions: TabOptions)\n\t{\n\t\tconst icon =\n\t\t\t'data:image/svg+xml;charset=US-ASCII,%3Csvg%20width%3D%2223%22%20height%3D%2223%22%20fill%3D%' +\n\t\t\t'22none%22%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%3E%3Cpath%20d%3D%22M14.432%2013.985a.96.' +\n\t\t\t'96%200%2000-.96-.96H8.505a.96.96%200%20000%201.92h4.967c.53%200%20.96-.43.96-.96zM14.432%2011.' +\n\t\t\t'009a.96.96%200%2000-.96-.96H8.505a.96.96%200%20000%201.92h4.967c.53%200%20.96-.43.96-.96zM14.' +\n\t\t\t'432%208.033a.96.96%200%2000-.96-.96H8.505a.96.96%200%20000%201.92h4.967c.53%200%20.96-.43.96-.' +\n\t\t\t'96z%22%20fill%3D%22%23ABB1B8%22/%3E%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd' +\n\t\t\t'%22%20d%3D%22M10.988%2019.52c1.8%200%203.469-.558%204.844-1.51l2.205%202.204a1.525%201.525%200%20' +\n\t\t\t'102.157-2.157l-2.205-2.205a8.512%208.512%200%2010-7%203.668zm0-2.403a6.108%206.108%200%20100-12.2' +\n\t\t\t'16%206.108%206.108%200%20000%2012.216z%22%20fill%3D%22%23ABB1B8%22/%3E%3C/svg%3E'\n\t\t;\n\n\t\tconst defaults = {\n\t\t\ttitle: Loc.getMessage('UI_SELECTOR_RECENT_TAB_TITLE'),\n\t\t\titemOrder: { sort: 'asc' },\n\t\t\ticon: {\n\t\t\t\t//default: '/bitrix/js/ui/entity-selector/src/css/images/recent-tab-icon.svg',\n\t\t\t\t//selected: '/bitrix/js/ui/entity-selector/src/css/images/recent-tab-icon-selected.svg'\n\t\t\t\tdefault: icon,\n\t\t\t\tselected: icon.replace(/ABB1B8/g, 'fff'),\n\t\t\t}\n\t\t};\n\n\t\tconst options: TabOptions = Object.assign({}, defaults, tabOptions);\n\t\toptions.id = 'recents';\n\n\t\tsuper(dialog, options);\n\t}\n}","import MatchField from './match-field';\n\nimport type MatchIndex from './match-index';\nimport type SearchField from './search-field';\nimport type Item from '../item/item';\n\nexport default class MatchResult\n{\n\titem: Item = null;\n\tqueryWords: string[] = null;\n\tmatchFields: Map<SearchField, MatchField> = new Map();\n\n\tconstructor(item: Item, queryWords: string[], matchIndexes: MatchIndex[] = [])\n\t{\n\t\tthis.item = item;\n\t\tthis.queryWords = queryWords;\n\t\tthis.addIndexes(matchIndexes);\n\t}\n\n\tgetItem(): Item\n\t{\n\t\treturn this.item;\n\t}\n\n\tgetQueryWords()\n\t{\n\t\treturn this.queryWords;\n\t}\n\n\tgetMatchFields(): Map<SearchField, MatchField>\n\t{\n\t\treturn this.matchFields;\n\t}\n\n\taddIndex(matchIndex: MatchIndex)\n\t{\n\t\tlet matchField = this.matchFields.get(matchIndex.getField());\n\t\tif (!matchField)\n\t\t{\n\t\t\tmatchField = new MatchField(matchIndex.getField());\n\t\t\tthis.matchFields.set(matchIndex.getField(), matchField);\n\t\t}\n\n\t\tmatchField.addIndex(matchIndex);\n\t}\n\n\taddIndexes(matchIndexes: MatchIndex[])\n\t{\n\t\tmatchIndexes.forEach(matchIndex => {\n\t\t\tthis.addIndex(matchIndex);\n\t\t});\n\t}\n}","import SearchField from './search-field';\n\nexport default class MatchIndex\n{\n\tfield: SearchField = null;\n\tqueryWord: string = null;\n\tstartIndex: number = null;\n\tendIndex: number = null;\n\n\tconstructor(field: SearchField, queryWord: string, startIndex: number)\n\t{\n\t\tthis.field = field;\n\t\tthis.queryWord = queryWord;\n\t\tthis.startIndex = startIndex;\n\t\tthis.endIndex = startIndex + queryWord.length;\n\t}\n\n\tgetField(): SearchField\n\t{\n\t\treturn this.field;\n\t}\n\n\tgetQueryWord(): string\n\t{\n\t\treturn this.queryWord;\n\t}\n\n\tgetStartIndex(): number\n\t{\n\t\treturn this.startIndex;\n\t}\n\n\tgetEndIndex(): number\n\t{\n\t\treturn this.endIndex;\n\t}\n}","import MatchResult from './match-result';\nimport MatchIndex from './match-index';\n\nimport type SearchFieldIndex from './search-field-index';\nimport type Item from '../item/item';\nimport type SearchQuery from './search-query';\n\nconst collator = new Intl.Collator(undefined, { sensitivity: 'base' });\n\nexport default class SearchEngine\n{\n\tstatic matchItems(items: Item[], searchQuery: SearchQuery): MatchResult[]\n\t{\n\t\tconst matchResults = [];\n\t\tconst queryWords = searchQuery.getQueryWords();\n\n\t\titems.forEach((item: Item) => {\n\n\t\t\tif (item.isSelected() || !item.isSearchable() || item.isHidden() || !item.getEntity().isSearchable())\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst matchResult = this.matchItem(item, queryWords);\n\t\t\tif (matchResult)\n\t\t\t{\n\t\t\t\tmatchResults.push(matchResult);\n\t\t\t}\n\t\t});\n\n\t\treturn matchResults;\n\t}\n\n\tstatic matchItem(item: Item, queryWords: string[]): MatchResult\n\t{\n\t\tlet matches = [];\n\t\tfor (let i = 0; i < queryWords.length; i++)\n\t\t{\n\t\t\tconst queryWord = queryWords[i];\n\t\t\tconst results = this.matchWord(item, queryWord);\n\t\t\t//const match = this.matchWord(item, queryWord);\n\t\t\t//if (match === null)\n\t\t\tif (results.length === 0)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tmatches = matches.concat(results);\n\t\t\t\t//matches.push(match);\n\t\t\t}\n\t\t}\n\n\t\tif (matches.length > 0)\n\t\t{\n\t\t\treturn new MatchResult(item, queryWords, matches);\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn null;\n\t\t}\n\t}\n\n\tstatic matchWord(item: Item, queryWord: string): MatchIndex\n\t{\n\t\tconst searchIndexes = item.getSearchIndex().getIndexes();\n\t\tconst matches = [];\n\n\t\tfor (let i = 0; i < searchIndexes.length; i++)\n\t\t{\n\t\t\tconst fieldIndex: SearchFieldIndex = searchIndexes[i];\n\t\t\tconst indexes = fieldIndex.getIndexes();\n\t\t\tfor (let j = 0; j < indexes.length; j++)\n\t\t\t{\n\t\t\t\tconst index = indexes[j];\n\t\t\t\tconst word = index.getWord().substring(0, queryWord.length);\n\t\t\t\tif (collator.compare(queryWord, word) === 0)\n\t\t\t\t{\n\t\t\t\t\tmatches.push(new MatchIndex(fieldIndex.getField(), queryWord, index.getStartIndex()));\n\t\t\t\t\t//return new MatchIndex(field, queryWord, index[i][1]);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (matches.length > 0)\n\t\t\t{\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t}\n\n\t\treturn matches;\n\t\t//return null;\n\t}\n}","import { Type } from 'main.core';\n\nexport default class SearchQuery\n{\n\tqueryWords: string[] = [];\n\tquery: string = '';\n\tcacheable: boolean = true;\n\tdynamicSearchEntities: string[] = [];\n\n\tconstructor(query: string)\n\t{\n\t\tthis.query = query.trim().replace(/\\s\\s+/g, ' ');\n\t\tthis.queryWords = Type.isStringFilled(this.query) ? this.query.split(' ') : [];\n\t}\n\n\tgetQueryWords(): string[]\n\t{\n\t\treturn this.queryWords;\n\t}\n\n\tgetQuery(): string\n\t{\n\t\treturn this.query;\n\t}\n\n\tisEmpty(): boolean\n\t{\n\t\treturn this.getQueryWords().length === 0;\n\t}\n\n\tsetCacheable(flag: boolean): void\n\t{\n\t\tif (Type.isBoolean(flag))\n\t\t{\n\t\t\tthis.cacheable = flag;\n\t\t}\n\t}\n\n\tisCacheable(): boolean\n\t{\n\t\treturn this.cacheable;\n\t}\n\n\thasDynamicSearch(): boolean\n\t{\n\t\treturn this.getDynamicSearchEntities().length > 0;\n\t}\n\n\thasDynamicSearchEntity(entityId: string): boolean\n\t{\n\t\treturn this.getDynamicSearchEntities().includes(entityId);\n\t}\n\n\tsetDynamicSearchEntities(entities: string[]): void\n\t{\n\t\tif (Type.isArrayFilled(entities))\n\t\t{\n\t\t\tentities.forEach((entityId: string) => {\n\t\t\t\tif (Type.isStringFilled(entityId) && !this.hasDynamicSearchEntity(entityId))\n\t\t\t\t{\n\t\t\t\t\tthis.dynamicSearchEntities.push(entityId);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\treturn this.dynamicSearchEntities;\n\t}\n\n\tgetDynamicSearchEntities(): string[]\n\t{\n\t\treturn this.dynamicSearchEntities;\n\t}\n\n\ttoJSON()\n\t{\n\t\treturn {\n\t\t\tqueryWords: this.getQueryWords(),\n\t\t\tquery: this.getQuery(),\n\t\t\tdynamicSearchEntities: this.getDynamicSearchEntities(),\n\t\t};\n\t}\n}","import { Cache, Tag, Loc, Dom } from 'main.core';\nimport { Loader } from 'main.loader';\nimport type Tab from './tab';\n\nexport default class SearchLoader\n{\n\ttab: Tab = null;\n\tloader: Loader = null;\n\tcache = new Cache.MemoryCache();\n\n\tconstructor(tab: Tab)\n\t{\n\t\tthis.tab = tab;\n\t}\n\n\tgetTab(): Tab\n\t{\n\t\treturn this.tab;\n\t}\n\n\tgetLoader(): Loader\n\t{\n\t\tif (this.loader === null)\n\t\t{\n\t\t\tthis.loader = new Loader({\n\t\t\t\ttarget: this.getIconContainer(),\n\t\t\t\tsize: 32\n\t\t\t});\n\t\t}\n\n\t\treturn this.loader;\n\t}\n\n\tgetContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('container', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-selector-search-loader\">\n\t\t\t\t\t${this.getBoxContainer()}\n\t\t\t\t\t${this.getSpacerContainer()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetBoxContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('box-container', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-selector-search-loader-box\">\n\t\t\t\t\t${this.getIconContainer()}\n\t\t\t\t\t${this.getTextContainer()}\n\t\t\t\t</div>`;\n\t\t});\n\t}\n\n\tgetIconContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('icon', () => {\n\t\t\treturn Tag.render`<div class=\"ui-selector-search-loader-icon\"></div>`;\n\t\t});\n\t}\n\n\tgetTextContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('text', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-selector-search-loader-text\">${\n\t\t\t\t\tLoc.getMessage('UI_SELECTOR_SEARCH_LOADER_TEXT')\n\t\t\t\t}</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetSpacerContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('spacer', () => {\n\t\t\treturn Tag.render`<div class=\"ui-selector-search-loader-spacer\"></div>`;\n\t\t});\n\t}\n\n\tshow(): void\n\t{\n\t\tif (!this.getContainer().parentNode)\n\t\t{\n\t\t\tDom.append(this.getContainer(), this.getTab().getContainer());\n\t\t}\n\n\t\tvoid this.getLoader().show();\n\n\t\tDom.addClass(this.getContainer(), 'ui-selector-search-loader--show');\n\t\trequestAnimationFrame(() => {\n\t\t\tDom.addClass(this.getContainer(), 'ui-selector-search-loader--animate');\n\t\t});\n\t}\n\n\thide(): void\n\t{\n\t\tif (this.loader === null)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tDom.removeClass(\n\t\t\tthis.getContainer(),\n\t\t\t['ui-selector-search-loader--show', 'ui-selector-search-loader--animate']\n\t\t);\n\n\t\tvoid this.getLoader().hide();\n\t}\n\n\tisShown(): boolean\n\t{\n\t\treturn this.loader !== null && this.loader.isShown();\n\t}\n}","import { Tag, Browser, Loc, Type } from 'main.core';\nimport { Loader } from 'main.loader';\nimport BaseFooter from '../footer/base-footer';\n\nimport type { BaseEvent } from 'main.core.events';\nimport type Tab from '../tabs/tab';\n\nexport default class SearchTabFooter extends BaseFooter\n{\n\tloader: Loader = null;\n\n\tconstructor(tab: Tab, options: { [option: string]: any })\n\t{\n\t\tsuper(tab, options);\n\n\t\tthis.getDialog().subscribe('onSearch', this.handleOnSearch.bind(this));\n\t\tconst tagSelector = this.getDialog().getTagSelector();\n\t\tif (tagSelector)\n\t\t{\n\t\t\ttagSelector.subscribe('onMetaEnter', this.handleMetaEnter.bind(this));\n\t\t}\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"ui-selector-search-footer\" onclick=\"${this.handleClick.bind(this)}\">\n\t\t\t\t<div class=\"ui-selector-search-footer-box\">\n\t\t\t\t\t${this.getLabelContainer()}\n\t\t\t\t\t${this.getQueryContainer()}\n\t\t\t\t\t${this.getLoaderContainer()}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"ui-selector-search-footer-cmd\">${\n\t\t\t\t\tBrowser.isMac() ? '&#8984;+Enter'  : 'Ctrl+Enter'\n\t\t\t\t}</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\tgetLoader(): Loader\n\t{\n\t\tif (this.loader === null)\n\t\t{\n\t\t\tthis.loader = new Loader({\n\t\t\t\ttarget: this.getLoaderContainer(),\n\t\t\t\tsize: 17,\n\t\t\t\tcolor: 'rgba(82, 92, 105, 0.9)'\n\t\t\t});\n\t\t}\n\n\t\treturn this.loader;\n\t}\n\n\tshowLoader(): void\n\t{\n\t\tthis.getLoader().show();\n\t}\n\n\thideLoader(): void\n\t{\n\t\tthis.getLoader().hide();\n\t}\n\n\tsetLabel(label: string)\n\t{\n\t\tif (Type.isString(label))\n\t\t{\n\t\t\tthis.getLabelContainer().textContent = label;\n\t\t}\n\t}\n\n\tgetLabelContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('label', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<span class=\"ui-selector-search-footer-label\">${\n\t\t\t\t\tthis.getOption('label', Loc.getMessage('UI_SELECTOR_CREATE_ITEM_LABEL'))\n\t\t\t}</span>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetQueryContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('name-container', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<span class=\"ui-selector-search-footer-query\"></span>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetLoaderContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('loader', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-selector-search-footer-loader\"></div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tcreateItem(): void\n\t{\n\t\tif (this.getDialog().getTagSelector().isLocked())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst finalize = () => {\n\t\t\tthis.hideLoader();\n\t\t\tif (this.getDialog().getTagSelector())\n\t\t\t{\n\t\t\t\tthis.getDialog().getTagSelector().unlock();\n\t\t\t\tthis.getDialog().focusSearch();\n\t\t\t}\n\t\t};\n\n\t\tevent.preventDefault();\n\t\tthis.showLoader();\n\t\tthis.getDialog().getTagSelector().lock();\n\n\t\tthis.getDialog()\n\t\t\t.emitAsync('Search:onItemCreateAsync', {\n\t\t\t\tsearchQuery: this.getTab().getLastSearchQuery()\n\t\t\t})\n\t\t\t.then(() => {\n\t\t\t\tthis.getTab().clearResults();\n\t\t\t\tthis.getDialog().clearSearch();\n\t\t\t\tif (this.getDialog().getActiveTab() === this.getTab())\n\t\t\t\t{\n\t\t\t\t\tthis.getDialog().selectFirstTab();\n\t\t\t\t}\n\n\t\t\t\tfinalize();\n\t\t\t})\n\t\t\t.catch(() => {\n\t\t\t\tfinalize();\n\t\t\t})\n\t\t;\n\t}\n\n\thandleClick(): void\n\t{\n\t\tthis.createItem();\n\t}\n\n\thandleMetaEnter(event: BaseEvent): void\n\t{\n\t\tif (this.getDialog().getActiveTab() !== this.getTab())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.handleClick();\n\t}\n\n\thandleOnSearch(event: BaseEvent): void\n\t{\n\t\tconst { query } = event.getData();\n\t\tthis.getQueryContainer().textContent = query;\n\t}\n}","import { Runtime, ajax as Ajax, Type, Loc } from 'main.core';\n\nimport Tab from './tab';\nimport SearchEngine from '../../search/search-engine';\nimport MatchResult from '../../search/match-result';\nimport SearchQuery from '../../search/search-query';\nimport SearchLoader from './search-loader';\nimport SearchTabFooter from '../footer/search-tab-footer';\n\nimport type { ItemOptions } from '../../item/item-options';\nimport type { TabOptions } from './tab-options';\nimport type Entity from '../../entity/entity';\nimport type Dialog from '../dialog';\nimport type { SearchOptions } from '../search-options';\n\nexport default class SearchTab extends Tab\n{\n\tlastSearchQuery: ?SearchQuery = null;\n\tloadWithDebounce = Runtime.debounce(this.load, 500, this);\n\tqueryCache = new Set();\n\tqueryXhr = null;\n\tsearchLoader: SearchLoader = new SearchLoader(this);\n\n\tallowCreateItem: boolean = false;\n\n\tconstructor(dialog: Dialog, tabOptions: TabOptions, searchOptions: SearchOptions)\n\t{\n\t\tconst defaults = {\n\t\t\ttitle: Loc.getMessage('UI_SELECTOR_SEARCH_TAB_TITLE'),\n\t\t\tvisible: false,\n\t\t\tstub: true,\n\t\t\tstubOptions: {\n\t\t\t\tautoShow: false,\n\t\t\t\ttitle: Loc.getMessage('UI_SELECTOR_SEARCH_STUB_TITLE'),\n\t\t\t\tsubtitle: Loc.getMessage('UI_SELECTOR_SEARCH_STUB_SUBTITLE')\n\t\t\t}\n\t\t};\n\n\t\tconst options: TabOptions = Object.assign({}, defaults, tabOptions);\n\t\toptions.id = 'search';\n\t\toptions.stubOptions.autoShow = false;\n\n\t\tsuper(dialog, options);\n\n\t\tsearchOptions = Type.isPlainObject(searchOptions) ? searchOptions : {};\n\t\tthis.setAllowCreateItem(searchOptions.allowCreateItem, searchOptions.footerOptions);\n\t}\n\n\tsearch(query: string)\n\t{\n\t\tconst searchQuery = new SearchQuery(query);\n\t\tconst dynamicEntities = this.getDynamicEntities(searchQuery);\n\t\tsearchQuery.setDynamicSearchEntities(dynamicEntities);\n\n\t\tif (searchQuery.isEmpty())\n\t\t{\n\t\t\tthis.getSearchLoader().hide();\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.lastSearchQuery = searchQuery;\n\n\t\tlet matchResults = [];\n\t\tthis.getDialog().getItems().forEach(items => {\n\t\t\tmatchResults = matchResults.concat(SearchEngine.matchItems(items, searchQuery));\n\t\t});\n\n\t\tthis.clearResults();\n\n\t\tthis.appendResults(matchResults);\n\n\t\tif (this.getDialog().shouldFocusOnFirst())\n\t\t{\n\t\t\tthis.getDialog().focusOnFirstNode();\n\t\t}\n\n\t\tif (this.shouldLoad(searchQuery))\n\t\t{\n\t\t\tthis.loadWithDebounce(searchQuery);\n\t\t\tif (!this.isEmptyResult())\n\t\t\t{\n\t\t\t\tthis.getStub().hide();\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (!this.getSearchLoader().isShown())\n\t\t\t{\n\t\t\t\tthis.toggleEmptyResult();\n\t\t\t}\n\t\t}\n\t}\n\n\tgetLastSearchQuery(): ?SearchQuery\n\t{\n\t\treturn this.lastSearchQuery;\n\t}\n\n\tsetAllowCreateItem(flag: boolean, options?: { [option: string]: any }): void\n\t{\n\t\tif (Type.isBoolean(flag))\n\t\t{\n\t\t\tthis.allowCreateItem = flag;\n\n\t\t\tif (flag)\n\t\t\t{\n\t\t\t\tthis.setFooter(SearchTabFooter, options);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.setFooter(null);\n\t\t\t}\n\t\t}\n\t}\n\n\tcanCreateItem(): boolean\n\t{\n\t\treturn this.allowCreateItem;\n\t}\n\n\tappendResults(matchResults: MatchResult[]): void\n\t{\n\t\tmatchResults.sort((a: MatchResult, b: MatchResult) => {\n\t\t\tconst contextSortA = a.getItem().getContextSort();\n\t\t\tconst contextSortB = b.getItem().getContextSort();\n\n\t\t\tif (contextSortA !== null && contextSortB === null)\n\t\t\t{\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t\telse if (contextSortA === null && contextSortB !== null)\n\t\t\t{\n\t\t\t\treturn 1;\n\t\t\t}\n\t\t\telse if (contextSortA !== null && contextSortB !== null)\n\t\t\t{\n\t\t\t\treturn contextSortB - contextSortA;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst globalSortA = a.getItem().getGlobalSort();\n\t\t\t\tconst globalSortB = b.getItem().getGlobalSort();\n\n\t\t\t\tif (globalSortA !== null && globalSortB === null)\n\t\t\t\t{\n\t\t\t\t\treturn -1;\n\t\t\t\t}\n\t\t\t\telse if (globalSortA === null && globalSortB !== null)\n\t\t\t\t{\n\t\t\t\t\treturn 1;\n\t\t\t\t}\n\t\t\t\telse if (globalSortA !== null && globalSortB !== null)\n\t\t\t\t{\n\t\t\t\t\treturn globalSortB - globalSortA;\n\t\t\t\t}\n\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t});\n\n\t\tthis.getRootNode().disableRender();\n\n\t\tmatchResults.forEach((matchResult: MatchResult) => {\n\t\t\tconst item = matchResult.getItem();\n\t\t\tif (!this.getRootNode().hasItem(item))\n\t\t\t{\n\t\t\t\tconst node = this.getRootNode().addItem(item);\n\t\t\t\tnode.setHighlights(matchResult.getMatchFields());\n\t\t\t}\n\t\t});\n\n\t\tthis.getRootNode().enableRender();\n\t\tthis.render();\n\t}\n\n\tgetDynamicEntities(searchQuery: SearchQuery): string[]\n\t{\n\t\tconst result = [];\n\n\t\tthis.getDialog().getEntities().forEach((entity: Entity) => {\n\t\t\tif (entity.isSearchable())\n\t\t\t{\n\t\t\t\tconst hasCacheLimit = entity.getSearchCacheLimits().some((pattern: RegExp) => {\n\t\t\t\t\treturn pattern.test(searchQuery.getQuery());\n\t\t\t\t});\n\n\t\t\t\tif (hasCacheLimit)\n\t\t\t\t{\n\t\t\t\t\tresult.push(entity.getId());\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn result;\n\t}\n\n\tisQueryCacheable(searchQuery: SearchQuery): boolean\n\t{\n\t\treturn searchQuery.isCacheable() && !searchQuery.hasDynamicSearch();\n\t}\n\n\tisQueryLoaded(searchQuery: SearchQuery): boolean\n\t{\n\t\tlet found = false;\n\t\tthis.queryCache.forEach(query => {\n\t\t\tif (found === false && searchQuery.getQuery().startsWith(query))\n\t\t\t{\n\t\t\t\tfound = true;\n\t\t\t}\n\t\t});\n\n\t\treturn found;\n\t}\n\n\taddCacheQuery(searchQuery: SearchQuery): void\n\t{\n\t\tif (this.isQueryCacheable(searchQuery))\n\t\t{\n\t\t\tthis.queryCache.add(searchQuery.getQuery());\n\t\t}\n\t}\n\n\tremoveCacheQuery(searchQuery: SearchQuery): void\n\t{\n\t\tthis.queryCache.delete(searchQuery.getQuery());\n\t}\n\n\tshouldLoad(searchQuery: SearchQuery): boolean\n\t{\n\t\tif (!this.isQueryCacheable(searchQuery))\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tif (!this.getDialog().hasDynamicSearch())\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\treturn !this.isQueryLoaded(searchQuery);\n\t}\n\n\tload(searchQuery: SearchQuery): void\n\t{\n\t\tif (!this.shouldLoad(searchQuery))\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\t/*if (this.queryXhr)\n\t\t{\n\t\t\tthis.queryXhr.abort();\n\t\t}*/\n\n\t\tthis.addCacheQuery(searchQuery);\n\n\t\tthis.getStub().hide();\n\t\tthis.getSearchLoader().show();\n\n\t\tAjax.runAction('ui.entityselector.doSearch', {\n\t\t\t\tjson: {\n\t\t\t\t\tdialog: this.getDialog(),\n\t\t\t\t\tsearchQuery\n\t\t\t\t},\n\t\t\t\tonrequeststart: (xhr) => {\n\t\t\t\t\tthis.queryXhr = xhr;\n\t\t\t\t},\n\t\t\t\tgetParameters: {\n\t\t\t\t\tcontext: this.getDialog().getContext()\n\t\t\t\t}\n\t\t\t})\n\t\t\t.then(response => {\n\n\t\t\t\tthis.getSearchLoader().hide();\n\n\t\t\t\tif (!response || !response.data || !response.data.dialog || !response.data.dialog.items)\n\t\t\t\t{\n\t\t\t\t\tthis.removeCacheQuery(searchQuery);\n\t\t\t\t\tthis.toggleEmptyResult();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (response.data.searchQuery && response.data.searchQuery.cacheable === false)\n\t\t\t\t{\n\t\t\t\t\tthis.removeCacheQuery(searchQuery);\n\t\t\t\t}\n\n\t\t\t\tif (Type.isArrayFilled(response.data.dialog.items))\n\t\t\t\t{\n\t\t\t\t\tconst items = new Set();\n\t\t\t\t\tresponse.data.dialog.items.forEach((itemOptions: ItemOptions) => {\n\t\t\t\t\t\tdelete itemOptions.tabs;\n\t\t\t\t\t\tdelete itemOptions.children;\n\n\t\t\t\t\t\tconst item = this.getDialog().addItem(itemOptions);\n\t\t\t\t\t\titems.add(item);\n\t\t\t\t\t});\n\n\t\t\t\t\tconst isTabEmpty = this.isEmptyResult();\n\n\t\t\t\t\tconst matchResults = SearchEngine.matchItems(items, this.getLastSearchQuery());\n\t\t\t\t\tthis.appendResults(matchResults);\n\n\t\t\t\t\tif (isTabEmpty && this.getDialog().shouldFocusOnFirst())\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.getDialog().focusOnFirstNode();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tthis.toggleEmptyResult();\n\t\t\t})\n\t\t\t.catch((error) => {\n\t\t\t\tthis.removeCacheQuery(searchQuery);\n\t\t\t\tthis.getSearchLoader().hide();\n\t\t\t\tthis.toggleEmptyResult();\n\n\t\t\t\tconsole.error(error);\n\t\t\t});\n\t}\n\n\tgetSearchLoader(): SearchLoader\n\t{\n\t\treturn this.searchLoader;\n\t}\n\n\tclearResults(): void\n\t{\n\t\tthis.getRootNode().removeChildren();\n\t}\n\n\tisEmptyResult(): boolean\n\t{\n\t\treturn !this.getRootNode().hasChildren();\n\t}\n\n\ttoggleEmptyResult(): void\n\t{\n\t\tif (this.isEmptyResult())\n\t\t{\n\t\t\tthis.getStub().show();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.getStub().hide();\n\t\t}\n\t}\n}","import { Type, Text, Tag, Dom, ajax as Ajax, Cache, Loc, Runtime, Reflection } from 'main.core';\nimport { EventEmitter, BaseEvent } from 'main.core.events';\nimport { Popup } from 'main.popup';\nimport { Loader } from 'main.loader';\n\nimport Item from '../item/item';\nimport Tab from './tabs/tab';\nimport Entity from '../entity/entity';\nimport TagSelector from '../tag-selector/tag-selector';\nimport Navigation from './navigation';\nimport SliderIntegration from './integration/slider-integration';\nimport Animation from '../util/animation';\nimport BaseFooter from './footer/base-footer';\nimport DefaultFooter from './footer/default-footer';\n\nimport RecentTab from './tabs/recent-tab';\nimport SearchTab from './tabs/search-tab';\n\nimport type ItemNode from '../item/item-node';\nimport type { TabOptions } from './tabs/tab-options';\nimport type { DialogOptions } from './dialog-options';\nimport type { ItemOptions } from '../item/item-options';\nimport type { EntityOptions } from '../entity/entity-options';\nimport type { ItemId } from '../item/item-id';\nimport type { PopupOptions } from 'main.popup';\nimport type { FooterOptions, FooterContent } from './footer/footer-content';\n\nclass LoadState\n{\n\tstatic UNSENT: string = 'UNSENT';\n\tstatic LOADING: string = 'LOADING';\n\tstatic DONE: string = 'DONE';\n}\n\nclass TagSelectorMode\n{\n\tstatic INSIDE: string = 'INSIDE';\n\tstatic OUTSIDE: string = 'OUTSIDE';\n}\n\nconst instances = new Map();\n\n/**\n * @memberof BX.UI.EntitySelector\n */\nexport default class Dialog extends EventEmitter\n{\n\tid: string = null;\n\titems: Map<string, Map<string, Item>> = new Map();\n\ttabs: Tab[] = [];\n\tentities: Entity[] = [];\n\ttargetNode: HTMLElement = null;\n\tpopup: Popup = null;\n\tcache = new Cache.MemoryCache();\n\tmultiple: boolean = true;\n\thideOnSelect: boolean = null;\n\thideOnDeselect: boolean = null;\n\tclearSearchOnSelect: boolean = true;\n\tcontext: string = null;\n\tselectedItems: Set<Item> = new Set();\n\tpreselectedItems: ItemId[] = [];\n\tundeselectedItems: ItemId[] = [];\n\tdropdownMode: boolean = false;\n\n\tfrozen: boolean = false;\n\tfrozenProps: { [propName: string]: any } = {};\n\n\thideByEsc: boolean = true;\n\tautoHide: boolean = true;\n\toffsetTop: number = 5;\n\toffsetLeft: number = 0;\n\tzIndex: number = null;\n\tcacheable: boolean = true;\n\n\twidth: number = 565;\n\theight: number = 420;\n\n\tmaxLabelWidth: number = 160;\n\tminLabelWidth: number = 45;\n\n\tactiveTab: Tab = null;\n\trecentTab: Tab = null;\n\tsearchTab: Tab = null;\n\n\trendered: boolean = false;\n\n\tloadState: LoadState = LoadState.UNSENT;\n\tloader: ?Loader = null;\n\n\ttagSelector: ?TagSelector = null;\n\ttagSelectorMode: ?TagSelectorMode = null;\n\ttagSelectorHeight: ?number = null;\n\n\tsaveRecentItemsWithDebounce: Function = Runtime.debounce(this.saveRecentItems, 2000, this);\n\trecentItemsToSave = [];\n\n\tnavigation: Navigation = null;\n\tfooter: BaseFooter = null;\n\tpopupOptions: PopupOptions = {};\n\n\tfocusOnFirst: boolean = true;\n\tfocusedNode: ItemNode = null;\n\n\tclearUnavailableItems: boolean = false;\n\n\tstatic getById(id: string): ?Dialog\n\t{\n\t\treturn instances.get(id) || null;\n\t}\n\n\tconstructor(dialogOptions: DialogOptions)\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.UI.EntitySelector.Dialog');\n\n\t\tconst options: DialogOptions = Type.isPlainObject(dialogOptions) ? dialogOptions : {};\n\t\tthis.id = Type.isStringFilled(options.id) ? options.id : `ui-selector-${Text.getRandom().toLowerCase()}`;\n\t\tthis.multiple = Type.isBoolean(options.multiple) ? options.multiple : true;\n\t\tthis.context = Type.isStringFilled(options.context) ? options.context : null;\n\t\tthis.clearUnavailableItems = options.clearUnavailableItems === true;\n\n\t\tif (Type.isArray(options.entities))\n\t\t{\n\t\t\toptions.entities.forEach((entity) => {\n\t\t\t\tthis.addEntity(entity);\n\t\t\t});\n\t\t}\n\n\t\tif (options.enableSearch === true)\n\t\t{\n\t\t\tconst defaultOptions = {\n\t\t\t\tplaceholder: Loc.getMessage('UI_TAG_SELECTOR_SEARCH_PLACEHOLDER'),\n\t\t\t\tmaxHeight: 99,\n\t\t\t\ttextBoxWidth: 105\n\t\t\t};\n\t\t\tconst customOptions = Type.isPlainObject(options.tagSelectorOptions) ? options.tagSelectorOptions : {};\n\t\t\tconst mandatoryOptions = {\n\t\t\t\tdialogOptions: null,\n\t\t\t\tshowTextBox: true,\n\t\t\t\tshowAddButton: false,\n\t\t\t\tshowCreateButton: false,\n\t\t\t\tmultiple: this.isMultiple()\n\t\t\t};\n\n\t\t\tconst tagSelectorOptions = Object.assign(defaultOptions, customOptions, mandatoryOptions);\n\t\t\tconst tagSelector = new TagSelector(tagSelectorOptions);\n\t\t\tthis.tagSelectorMode = TagSelectorMode.INSIDE;\n\t\t\tthis.setTagSelector(tagSelector);\n\t\t}\n\t\telse if (options.tagSelector instanceof TagSelector)\n\t\t{\n\t\t\tthis.tagSelectorMode = TagSelectorMode.OUTSIDE;\n\t\t\tthis.setTagSelector(options.tagSelector);\n\t\t}\n\n\t\tthis.setTargetNode(options.targetNode);\n\t\tthis.setHideOnSelect(options.hideOnSelect);\n\t\tthis.setHideOnDeselect(options.hideOnDeselect);\n\t\tthis.setClearSearchOnSelect(options.clearSearchOnSelect);\n\t\tthis.setWidth(options.width);\n\t\tthis.setHeight(options.height);\n\t\tthis.setAutoHide(options.autoHide);\n\t\tthis.setHideByEsc(options.hideByEsc);\n\t\tthis.setOffsetLeft(options.offsetLeft);\n\t\tthis.setOffsetTop(options.offsetTop);\n\t\tthis.setZindex(options.zIndex);\n\t\tthis.setCacheable(options.cacheable);\n\t\tthis.setFocusOnFirst(options.focusOnFirst);\n\n\t\tthis.recentTab = new RecentTab(this, options.recentTabOptions);\n\t\tthis.searchTab = new SearchTab(this, options.searchTabOptions, options.searchOptions);\n\n\t\tthis.addTab(this.recentTab);\n\t\tthis.addTab(this.searchTab);\n\n\t\tthis.setDropdownMode(options.dropdownMode);\n\t\tthis.setPreselectedItems(options.preselectedItems);\n\t\tthis.setUndeselectedItems(options.undeselectedItems);\n\n\t\tthis.setOptions(options);\n\n\t\tconst preload = options.preload === true || this.getPreselectedItems().length > 0;\n\t\tif (preload)\n\t\t{\n\t\t\tthis.load();\n\t\t}\n\n\t\tif (Type.isPlainObject(options.popupOptions))\n\t\t{\n\t\t\tconst allowedOptions = ['overlay', 'bindOptions'];\n\t\t\tconst popupOptions = {};\n\n\t\t\tObject.keys(options.popupOptions).forEach((option: string) => {\n\t\t\t\tif (allowedOptions.includes(option))\n\t\t\t\t{\n\t\t\t\t\tpopupOptions[option] = options.popupOptions[option];\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.popupOptions = popupOptions;\n\t\t}\n\n\t\tthis.navigation = new Navigation(this);\n\n\t\t(new SliderIntegration(this));\n\n\t\tthis.subscribe('ItemNode:onFocus', this.handleItemNodeFocus.bind(this));\n\t\tthis.subscribe('ItemNode:onUnfocus', this.handleItemNodeUnfocus.bind(this));\n\n\t\tthis.subscribeFromOptions(options.events);\n\n\t\tinstances.set(this.id, this);\n\t}\n\n\tsetOptions(dialogOptions: DialogOptions): void\n\t{\n\t\tconst options = Type.isPlainObject(dialogOptions) ? dialogOptions : {};\n\n\t\tif (Type.isArray(options.tabs))\n\t\t{\n\t\t\toptions.tabs.forEach((tab) => {\n\t\t\t\tthis.addTab(tab);\n\t\t\t});\n\t\t}\n\n\t\tif (Type.isArray(options.selectedItems))\n\t\t{\n\t\t\toptions.selectedItems.forEach((itemOptions: ItemOptions) => {\n\t\t\t\tconst options = Object.assign({}, Type.isPlainObject(itemOptions) ? itemOptions : {});\n\t\t\t\toptions.selected = true;\n\t\t\t\tthis.addItem(options);\n\t\t\t});\n\t\t}\n\n\t\tif (Type.isArray(options.items))\n\t\t{\n\t\t\toptions.items.forEach((itemOptions: ItemOptions) => {\n\t\t\t\tthis.addItem(itemOptions);\n\t\t\t});\n\t\t}\n\n\t\tthis.setFooter(options.footer, options.footerOptions);\n\t}\n\n\tgetId(): string\n\t{\n\t\treturn this.id;\n\t}\n\n\tgetContext(): ?string\n\t{\n\t\treturn this.context;\n\t}\n\n\tgetNavigation(): Navigation\n\t{\n\t\treturn this.navigation;\n\t}\n\n\tgetFooter(): ?BaseFooter\n\t{\n\t\treturn this.footer;\n\t}\n\n\tgetActiveFooter(): ?BaseFooter\n\t{\n\t\tif (!this.getActiveTab())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tif (this.getActiveTab().getFooter())\n\t\t{\n\t\t\treturn this.getActiveTab().getFooter();\n\t\t}\n\n\t\treturn this.getFooter() && this.getActiveTab().canShowDefaultFooter() ? this.getFooter() : null;\n\t}\n\n\tadjustFooter(): void\n\t{\n\t\tif (!this.getActiveTab())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.getActiveTab().getFooter())\n\t\t{\n\t\t\tif (this.getFooter())\n\t\t\t{\n\t\t\t\tthis.getFooter().hide();\n\t\t\t}\n\n\t\t\tthis.getActiveTab().getFooter().show();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (this.getFooter())\n\t\t\t{\n\t\t\t\tif (this.getActiveTab().canShowDefaultFooter())\n\t\t\t\t{\n\t\t\t\t\tthis.getFooter().show();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.getFooter().hide();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tsetFooter(footerContent: ?FooterContent, footerOptions?: FooterOptions): void\n\t{\n\t\t/** @var {BaseFooter} */\n\t\tlet footer = null;\n\t\tif (footerContent !== null)\n\t\t{\n\t\t\tfooter = this.constructor.createFooter(this, footerContent, footerOptions);\n\t\t\tif (footer === null)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tif (this.isRendered() && this.getFooter() !== null)\n\t\t{\n\t\t\tDom.remove(this.getFooter().getContainer());\n\t\t\tthis.adjustFooter();\n\t\t}\n\n\t\tthis.footer = footer;\n\n\t\tif (this.isRendered())\n\t\t{\n\t\t\tthis.appendFooter(footer);\n\t\t\tthis.adjustFooter();\n\t\t}\n\t}\n\n\tappendFooter(footer: BaseFooter): void\n\t{\n\t\tif (footer instanceof BaseFooter)\n\t\t{\n\t\t\tDom.append(footer.getContainer(), this.getFooterContainer());\n\t\t}\n\t}\n\n\tstatic createFooter(context: Dialog | Tab, footerContent: FooterContent, footerOptions?: FooterOptions): ?BaseFooter\n\t{\n\t\tif (\n\t\t\t!Type.isStringFilled(footerContent) &&\n\t\t\t!Type.isArrayFilled(footerContent) &&\n\t\t\t!Type.isDomNode(footerContent) &&\n\t\t\t!Type.isFunction(footerContent)\n\t\t)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\t/** @var {BaseFooter} */\n\t\tlet footer = null;\n\t\tconst options = Type.isPlainObject(footerOptions) ? footerOptions : {};\n\n\t\tif (Type.isFunction(footerContent) || Type.isString(footerContent))\n\t\t{\n\t\t\tconst className = Type.isString(footerContent) ? Reflection.getClass(footerContent) : footerContent;\n\t\t\tif (Type.isFunction(className))\n\t\t\t{\n\t\t\t\tfooter = new className(context, options);\n\t\t\t\tif (!(footer instanceof BaseFooter))\n\t\t\t\t{\n\t\t\t\t\tconsole.error('EntitySelector: footer is not an instance of BaseFooter.');\n\t\t\t\t\tfooter = null;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (footerContent !== null && !footer)\n\t\t{\n\t\t\tfooter = new DefaultFooter(context, Object.assign({}, options, { content: footerContent }));\n\t\t}\n\n\t\treturn footer;\n\t}\n\n\taddTab(tab: Tab | TabOptions): Tab\n\t{\n\t\tif (Type.isPlainObject(tab))\n\t\t{\n\t\t\ttab = new Tab(this, tab);\n\t\t}\n\n\t\tif (!(tab instanceof Tab))\n\t\t{\n\t\t\tthrow new Error('EntitySelector: a tab must be an instance of EntitySelector.Tab.');\n\t\t}\n\n\t\tif (this.getTab(tab.getId()))\n\t\t{\n\t\t\tconsole.error(`EntitySelector: the \"${tab.getId()}\" tab is already existed.`);\n\t\t\treturn tab;\n\t\t}\n\n\t\ttab.setDialog(this);\n\t\tthis.tabs.push(tab);\n\n\t\tif (this.isRendered())\n\t\t{\n\t\t\tthis.insertTab(tab);\n\t\t}\n\n\t\treturn tab;\n\t}\n\n\tgetTabs(): Tab[]\n\t{\n\t\treturn this.tabs;\n\t}\n\n\tgetTab(id: string): ?Tab\n\t{\n\t\tif (!Type.isStringFilled(id))\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst tab = this.getTabs().find((tab: Tab) => tab.getId() === id);\n\n\t\treturn tab || null;\n\t}\n\n\tgetRecentTab(): RecentTab\n\t{\n\t\treturn this.recentTab;\n\t}\n\n\tgetSearchTab(): SearchTab\n\t{\n\t\treturn this.searchTab;\n\t}\n\n\tselectTab(id: string): ?Tab\n\t{\n\t\tconst newActiveTab = this.getTab(id);\n\t\tif (!newActiveTab || newActiveTab === this.getActiveTab())\n\t\t{\n\t\t\treturn newActiveTab;\n\t\t}\n\n\t\tif (this.getActiveTab())\n\t\t{\n\t\t\tthis.getActiveTab().deselect();\n\t\t}\n\n\t\tthis.activeTab = newActiveTab;\n\t\tnewActiveTab.select();\n\n\t\tif (!newActiveTab.isRendered())\n\t\t{\n\t\t\tnewActiveTab.render();\n\t\t}\n\n\t\tthis.focusSearch();\n\n\t\tthis.clearNodeFocus();\n\t\tif (this.shouldFocusOnFirst())\n\t\t{\n\t\t\tthis.focusOnFirstNode();\n\t\t}\n\n\t\tthis.adjustFooter();\n\n\t\treturn newActiveTab;\n\t}\n\n\t/**\n\t * @private\n\t */\n\tinsertTab(tab: Tab): void\n\t{\n\t\ttab.renderLabel();\n\t\tDom.append(tab.getLabelContainer(), this.getLabelsContainer());\n\t\tDom.append(tab.getContainer(), this.getTabContentsContainer());\n\n\t\tif (tab.getFooter())\n\t\t{\n\t\t\tDom.append(tab.getFooter().getContainer(), this.getFooterContainer());\n\t\t}\n\t}\n\n\tselectFirstTab(onlyVisible = true): ?Tab\n\t{\n\t\tfor (let i = 0; i < this.getTabs().length; i++)\n\t\t{\n\t\t\tconst tab = this.getTabs()[i];\n\t\t\tif (onlyVisible === false || tab.isVisible())\n\t\t\t{\n\t\t\t\treturn this.selectTab(tab.getId());\n\t\t\t}\n\t\t}\n\n\t\tif (this.isDropdownMode())\n\t\t{\n\t\t\treturn this.selectTab(this.getRecentTab().getId());\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tselectLastTab(onlyVisible = true): ?Tab\n\t{\n\t\tfor (let i = this.getTabs().length - 1; i >= 0; i--)\n\t\t{\n\t\t\tconst tab = this.getTabs()[i];\n\t\t\tif (onlyVisible === false || tab.isVisible())\n\t\t\t{\n\t\t\t\treturn this.selectTab(tab.getId());\n\t\t\t}\n\t\t}\n\n\t\tif (this.isDropdownMode())\n\t\t{\n\t\t\treturn this.selectTab(this.getRecentTab().getId());\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tgetActiveTab(): ?Tab\n\t{\n\t\treturn this.activeTab;\n\t}\n\n\tgetNextTab(onlyVisible = true): ?Tab\n\t{\n\t\tlet nextTab = null;\n\t\tlet activeFound = false;\n\t\tfor (let i =  0; i < this.getTabs().length; i++)\n\t\t{\n\t\t\tconst tab = this.getTabs()[i];\n\t\t\tif (onlyVisible && !tab.isVisible())\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (tab === this.getActiveTab())\n\t\t\t{\n\t\t\t\tactiveFound = true;\n\t\t\t}\n\t\t\telse if (activeFound)\n\t\t\t{\n\t\t\t\tnextTab = tab;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\treturn nextTab;\n\t}\n\n\tgetPreviousTab(onlyVisible = true): ?Tab\n\t{\n\t\tlet previousTab = null;\n\t\tlet activeFound = false;\n\t\tfor (let i = this.getTabs().length - 1; i >= 0; i--)\n\t\t{\n\t\t\tconst tab = this.getTabs()[i];\n\t\t\tif (onlyVisible && !tab.isVisible())\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (tab === this.getActiveTab())\n\t\t\t{\n\t\t\t\tactiveFound = true;\n\t\t\t}\n\t\t\telse if (activeFound)\n\t\t\t{\n\t\t\t\tpreviousTab = tab;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\treturn previousTab;\n\t}\n\n\tremoveTab(id: string): void\n\t{\n\t\tconst tab = this.getTab(id);\n\t\tif (!tab)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\ttab.removeNodes();\n\n\t\tthis.tabs = this.tabs.filter((el: Tab) => tab.getId() !== el.getId());\n\n\t\tDom.remove(tab.getLabelContainer(), this.getLabelsContainer());\n\t\tDom.remove(tab.getContainer(), this.getTabContentsContainer());\n\n\t\tif (tab.getFooter())\n\t\t{\n\t\t\tDom.remove(tab.getFooter().getContainer(), this.getFooterContainer());\n\t\t}\n\n\t\tthis.selectFirstTab();\n\t}\n\n\tgetItem(item: ItemId | Item | ItemOptions): ?Item\n\t{\n\t\tlet id = null;\n\t\tlet entityId = null;\n\n\t\tif (Type.isArray(item) && item.length === 2)\n\t\t{\n\t\t\t[entityId, id] = item;\n\t\t}\n\t\telse if (item instanceof Item)\n\t\t{\n\t\t\tid = item.getId();\n\t\t\tentityId = item.getEntityId();\n\t\t}\n\t\telse if (Type.isObjectLike(item))\n\t\t{\n\t\t\t({ id, entityId } = item);\n\t\t}\n\n\t\tconst entityItems = this.getEntityItems(entityId);\n\t\tif (entityItems)\n\t\t{\n\t\t\treturn entityItems.get(String(id)) || null;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tgetItems(): Map<string, Map<string, Item>>\n\t{\n\t\treturn this.items;\n\t}\n\n\tgetSelectedItems(): Item[]\n\t{\n\t\treturn Array.from(this.selectedItems);\n\t}\n\n\tsetPreselectedItems(itemIds: ItemId[]): void\n\t{\n\t\tthis.preselectedItems = this.validateItemIds(itemIds);\n\t}\n\n\tgetPreselectedItems(): ItemId[]\n\t{\n\t\treturn this.preselectedItems;\n\t}\n\n\tsetUndeselectedItems(itemIds: ItemId[]): void\n\t{\n\t\tthis.undeselectedItems = this.validateItemIds(itemIds);\n\t}\n\n\tgetUndeselectedItems()\n\t{\n\t\treturn this.undeselectedItems;\n\t}\n\n\t/**\n\t * @private\n\t */\n\tvalidateItemIds(itemIds: ItemId[]): ItemId[]\n\t{\n\t\tif (!Type.isArrayFilled(itemIds))\n\t\t{\n\t\t\treturn [];\n\t\t}\n\n\t\tconst result = [];\n\t\titemIds.forEach((itemId: ItemId) => {\n\t\t\tif (!Type.isArray(itemId) || itemId.length !== 2)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst [entityId, id] = itemId;\n\n\t\t\tif (Type.isStringFilled(entityId) && (Type.isStringFilled(id) || Type.isNumber(id)))\n\t\t\t{\n\t\t\t\tresult.push(itemId);\n\t\t\t}\n\t\t});\n\n\t\treturn result;\n\t}\n\n\tgetEntityItems(entityId: string): Map<string, Item> | null\n\t{\n\t\treturn this.items.get(entityId) || null;\n\t}\n\n\taddItem(options: ItemOptions): Item\n\t{\n\t\tif (!Type.isPlainObject(options))\n\t\t{\n\t\t\tthrow new Error('EntitySelector.addItem: wrong item options.');\n\t\t}\n\n\t\tlet item = this.getItem(options);\n\t\tif (!item)\n\t\t{\n\t\t\titem = new Item(options);\n\n\t\t\tconst undeselectable = this.getUndeselectedItems().some((itemId: ItemId) => {\n\t\t\t\treturn itemId[0] === item.getEntityId() && itemId[1] === item.getId();\n\t\t\t});\n\n\t\t\tif (undeselectable)\n\t\t\t{\n\t\t\t\titem.setDeselectable(false);\n\t\t\t}\n\n\t\t\titem.setDialog(this);\n\n\t\t\tconst entity = this.getEntity(item.getEntityId());\n\t\t\tif (entity === null)\n\t\t\t{\n\t\t\t\tthis.addEntity({ id: item.getEntityId() });\n\t\t\t}\n\n\t\t\tlet entityItems = this.items.get(item.getEntityId());\n\t\t\tif (!entityItems)\n\t\t\t{\n\t\t\t\tentityItems = new Map();\n\t\t\t\tthis.items.set(item.getEntityId(), entityItems);\n\t\t\t}\n\n\t\t\tentityItems.set(String(item.getId()), item);\n\n\t\t\tif (item.isSelected())\n\t\t\t{\n\t\t\t\tthis.handleItemSelect(item);\n\t\t\t}\n\t\t}\n\n\t\tlet tabs = [];\n\t\tif (Type.isArray(options.tabs))\n\t\t{\n\t\t\ttabs = options.tabs;\n\t\t}\n\t\telse if (Type.isStringFilled(options.tabs))\n\t\t{\n\t\t\ttabs = [options.tabs];\n\t\t}\n\n\t\tconst children = Type.isArray(options.children) ? options.children : [];\n\n\t\ttabs.forEach((tabId) => {\n\t\t\tconst tab = this.getTab(tabId);\n\t\t\tif (tab)\n\t\t\t{\n\t\t\t\tconst itemNode = tab.getRootNode().addItem(item, options.nodeOptions);\n\t\t\t\titemNode.addChildren(children);\n\t\t\t}\n\t\t});\n\n\t\treturn item;\n\t}\n\n\tremoveItem(item: Item | ItemOptions): ?Item\n\t{\n\t\titem = this.getItem(item);\n\t\tif (item)\n\t\t{\n\t\t\tconst entityItems = this.getEntityItems(item.getEntityId());\n\t\t\tif (entityItems)\n\t\t\t{\n\t\t\t\tentityItems.delete(item.getId());\n\t\t\t\tif (entityItems.size === 0)\n\t\t\t\t{\n\t\t\t\t\tthis.items.delete(item.getEntityId());\n\t\t\t\t}\n\t\t\t}\n\n\t\t\titem.getNodes().forEach((node: ItemNode) => {\n\t\t\t\tnode.getParentNode().removeChild(node);\n\t\t\t});\n\t\t}\n\n\t\treturn item;\n\t}\n\n\tdeselectAll(): void\n\t{\n\t\tthis.getSelectedItems().forEach((item: Item) => {\n\t\t\titem.deselect();\n\t\t});\n\t}\n\n\tisMultiple(): boolean\n\t{\n\t\treturn this.multiple;\n\t}\n\n\tsetHideOnSelect(flag: boolean): void\n\t{\n\t\tif (Type.isBoolean(flag))\n\t\t{\n\t\t\tthis.hideOnSelect = flag;\n\t\t}\n\t}\n\n\tshouldHideOnSelect(): boolean\n\t{\n\t\tif (this.hideOnSelect !== null)\n\t\t{\n\t\t\treturn this.hideOnSelect;\n\t\t}\n\n\t\treturn !this.isMultiple();\n\t}\n\n\tsetHideOnDeselect(flag: boolean): void\n\t{\n\t\tif (Type.isBoolean(flag))\n\t\t{\n\t\t\tthis.hideOnDeselect = flag;\n\t\t}\n\t}\n\n\tshouldHideOnDeselect(): boolean\n\t{\n\t\tif (this.hideOnDeselect !== null)\n\t\t{\n\t\t\treturn this.hideOnDeselect;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tsetClearSearchOnSelect(flag: boolean): void\n\t{\n\t\tif (Type.isBoolean(flag))\n\t\t{\n\t\t\tthis.clearSearchOnSelect = flag;\n\t\t}\n\t}\n\n\tshouldClearSearchOnSelect(): boolean\n\t{\n\t\treturn this.clearSearchOnSelect;\n\t}\n\n\taddEntity(entity: Entity | EntityOptions)\n\t{\n\t\tif (Type.isPlainObject(entity))\n\t\t{\n\t\t\tentity = new Entity(entity);\n\t\t}\n\n\t\tif (!(entity instanceof Entity))\n\t\t{\n\t\t\tthrow new Error('EntitySelector: an entity must be an instance of EntitySelector.Entity.');\n\t\t}\n\n\t\tif (this.hasEntity(entity.getId()))\n\t\t{\n\t\t\tconsole.error(`EntitySelector: the \"${entity.getId()}\" entity is already existed.`);\n\t\t\treturn;\n\t\t}\n\n\t\tthis.entities.push(entity);\n\t}\n\n\tgetEntity(id: string): ?Entity\n\t{\n\t\treturn this.getEntities().find((entity: Entity) => entity.getId() === id) || null;\n\t}\n\n\thasEntity(id: string): boolean\n\t{\n\t\treturn this.getEntities().some((entity: Entity) => entity.getId() === id);\n\t}\n\n\tgetEntities(): Entity[]\n\t{\n\t\treturn this.entities;\n\t}\n\n\tremoveEntity(id: string): void\n\t{\n\t\tconst index = this.getEntities().find((entity: Entity) => entity.getId() === id);\n\t\tif (index >= 0)\n\t\t{\n\t\t\tthis.getEntities().splice(index, 1);\n\t\t}\n\t}\n\n\tgetTagSelector(): ?TagSelector\n\t{\n\t\treturn this.tagSelector;\n\t}\n\n\tgetTagSelectorMode(): ?TagSelectorMode\n\t{\n\t\treturn this.tagSelectorMode;\n\t}\n\n\tisTagSelectorInside(): boolean\n\t{\n\t\treturn this.getTagSelector() && this.getTagSelectorMode() === TagSelectorMode.INSIDE;\n\t}\n\n\tisTagSelectorOutside(): boolean\n\t{\n\t\treturn this.getTagSelector() && this.getTagSelectorMode() === TagSelectorMode.OUTSIDE;\n\t}\n\n\tgetTagSelectorQuery()\n\t{\n\t\treturn this.getTagSelector() ? this.getTagSelector().getTextBoxValue() : '';\n\t}\n\n\tsetTagSelector(tagSelector: TagSelector): void\n\t{\n\t\tthis.tagSelector = tagSelector;\n\n\t\tthis.tagSelector.subscribe('onInput', Runtime.debounce(this.handleTagSelectorInput, 200, this));\n\t\tthis.tagSelector.subscribe('onAddButtonClick', this.handleTagSelectorAddButtonClick.bind(this));\n\t\tthis.tagSelector.subscribe('onTagRemove', this.handleTagSelectorTagRemove.bind(this));\n\t\tthis.tagSelector.subscribe('onAfterTagRemove', this.handleTagSelectorAfterTagRemove.bind(this));\n\t\tthis.tagSelector.subscribe('onAfterTagAdd', this.handleTagSelectorAfterTagAdd.bind(this));\n\t\tthis.tagSelector.subscribe('onContainerClick', this.handleTagSelectorClick.bind(this));\n\n\t\tthis.tagSelector.setDialog(this);\n\t}\n\n\tfocusSearch(): void\n\t{\n\t\tif (this.getTagSelector())\n\t\t{\n\t\t\tif (this.getActiveTab() !== this.getSearchTab())\n\t\t\t{\n\t\t\t\tthis.getTagSelector().clearTextBox();\n\t\t\t}\n\n\t\t\tthis.getTagSelector().focusTextBox();\n\t\t}\n\t}\n\n\tclearSearch(): void\n\t{\n\t\tif (this.getTagSelector())\n\t\t{\n\t\t\tthis.getTagSelector().clearTextBox();\n\n\t\t\tif (this.getActiveTab() === this.getSearchTab())\n\t\t\t{\n\t\t\t\tthis.selectFirstTab();\n\t\t\t}\n\t\t}\n\t}\n\n\tgetLoader(): Loader\n\t{\n\t\tif (this.loader === null)\n\t\t{\n\t\t\tthis.loader = new Loader({\n\t\t\t\ttarget: this.getTabsContainer(),\n\t\t\t\tsize: 100\n\t\t\t});\n\t\t}\n\n\t\treturn this.loader;\n\t}\n\n\tshowLoader(): void\n\t{\n\t\tthis.getLoader().show();\n\t}\n\n\thideLoader(): void\n\t{\n\t\tif (this.loader !== null)\n\t\t{\n\t\t\tthis.getLoader().hide();\n\t\t}\n\t}\n\n\tdestroyLoader(): void\n\t{\n\t\tif (this.loader !== null)\n\t\t{\n\t\t\tthis.getLoader().destroy();\n\t\t}\n\n\t\tthis.loader = null;\n\t}\n\n\thandleTagSelectorInput(): void\n\t{\n\t\tif (this.getTagSelectorMode() === TagSelectorMode.OUTSIDE && !this.isOpen())\n\t\t{\n\t\t\tthis.show();\n\t\t}\n\n\t\tconst query = this.getTagSelector().getTextBoxValue();\n\t\tthis.search(query);\n\t}\n\n\thandleTagSelectorAddButtonClick(): void\n\t{\n\t\tthis.show();\n\t}\n\n\thandleTagSelectorTagRemove(event: BaseEvent): void\n\t{\n\t\tconst { tag } = event.getData();\n\n\t\tconst item = this.getItem({ id: tag.getId(), entityId: tag.getEntityId() });\n\t\tif (item)\n\t\t{\n\t\t\titem.deselect();\n\t\t}\n\n\t\tthis.focusSearch();\n\t}\n\n\thandleTagSelectorAfterTagRemove(): void\n\t{\n\t\tthis.adjustByTagSelector();\n\t}\n\n\thandleTagSelectorAfterTagAdd(): void\n\t{\n\t\tthis.adjustByTagSelector();\n\t}\n\n\thandleTagSelectorClick(): void\n\t{\n\t\tthis.focusSearch();\n\t}\n\n\tadjustByTagSelector(): void\n\t{\n\t\tif (this.getTagSelectorMode() === TagSelectorMode.OUTSIDE)\n\t\t{\n\t\t\tthis.adjustPosition();\n\t\t}\n\t\telse if (this.getTagSelectorMode() === TagSelectorMode.INSIDE)\n\t\t{\n\t\t\tconst newTagSelectorHeight = this.getTagSelector().calcHeight();\n\t\t\tif (newTagSelectorHeight > 0)\n\t\t\t{\n\t\t\t\tconst offset = newTagSelectorHeight - (this.tagSelectorHeight || this.getTagSelector().getMinHeight());\n\t\t\t\tthis.tagSelectorHeight = newTagSelectorHeight;\n\t\t\t\tif (offset !== 0)\n\t\t\t\t{\n\t\t\t\t\tconst height = this.getHeight();\n\t\t\t\t\tthis.setHeight(height + offset).then(() => {\n\t\t\t\t\t\tthis.adjustPosition();\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tobserveTabOverlapping()\n\t{\n\t\tconst observer = new MutationObserver(() => {\n\t\t\tif (this.getTabs().some((tab: Tab) => tab.isVisible()))\n\t\t\t{\n\t\t\t\tconst left = parseInt(this.getPopup().getPopupContainer().style.left, 10);\n\t\t\t\tif (left < this.getMinLabelWidth())\n\t\t\t\t{\n\t\t\t\t\tDom.style(this.getPopup().getPopupContainer(), 'left', `${this.getMinLabelWidth()}px`);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tobserver.observe(this.getPopup().getPopupContainer(), {\n\t\t\tattributes: true,\n\t\t\tattributeFilter: ['style']\n\t\t});\n\t}\n\n\t/**\n\t * @internal\n\t */\n\thandleItemSelect(item: Item, animate: boolean = true)\n\t{\n\t\tif (!this.isMultiple())\n\t\t{\n\t\t\tthis.deselectAll();\n\t\t}\n\n\t\tif (this.getTagSelector() && (this.isMultiple() || this.isTagSelectorOutside()))\n\t\t{\n\t\t\tconst tag = item.createTag();\n\t\t\ttag.animate = animate;\n\t\t\tthis.getTagSelector().addTag(tag);\n\t\t}\n\n\t\tthis.selectedItems.add(item);\n\t}\n\n\t/**\n\t * @internal\n\t */\n\thandleItemDeselect(item: Item)\n\t{\n\t\tthis.selectedItems.delete(item);\n\t}\n\n\thandlePopupAfterShow(): void\n\t{\n\t\tthis.focusSearch();\n\t\tthis.adjustByTagSelector();\n\n\t\tthis.emit('onShow');\n\t}\n\n\thandlePopupFirstShow(): void\n\t{\n\t\tthis.emit('onFirstShow');\n\n\t\trequestAnimationFrame(() => {\n\t\t\trequestAnimationFrame(() => {\n\t\t\t\tDom.addClass(this.getPopup().getPopupContainer(), 'ui-selector-popup-container');\n\t\t\t});\n\t\t});\n\n\t\tthis.observeTabOverlapping();\n\t}\n\n\thandlePopupAfterClose(): void\n\t{\n\t\tif (this.isTagSelectorOutside())\n\t\t{\n\t\t\tif (this.getActiveTab() && this.getActiveTab() === this.getSearchTab())\n\t\t\t{\n\t\t\t\tthis.selectFirstTab();\n\t\t\t}\n\n\t\t\tthis.getTagSelector().clearTextBox();\n\t\t\tthis.getTagSelector().showAddButton();\n\t\t\tthis.getTagSelector().hideTextBox();\n\t\t}\n\n\t\tthis.emit('onHide');\n\t}\n\n\thandlePopupDestroy(): void\n\t{\n\t\tthis.destroy();\n\t}\n\n\thandleLabelsMouseEnter(): void\n\t{\n\t\tconst rect = Dom.getPosition(this.getLabelsContainer());\n\t\tconst freeSpace = rect.right;\n\n\t\tif (freeSpace > this.getMinLabelWidth())\n\t\t{\n\t\t\tDom.removeClass(this.getLabelsContainer(), 'ui-selector-tab-labels--animate-hide');\n\t\t\tDom.addClass(this.getLabelsContainer(), 'ui-selector-tab-labels--animate-show');\n\n\t\t\tDom.style(this.getLabelsContainer(), 'max-width', `${Math.min(freeSpace, this.getMaxLabelWidth())}px`);\n\t\t\tAnimation.handleTransitionEnd(this.getLabelsContainer(), 'max-width').then(() => {\n\t\t\t\tDom.removeClass(this.getLabelsContainer(), 'ui-selector-tab-labels--animate-show');\n\t\t\t\tDom.addClass(this.getLabelsContainer(), 'ui-selector-tab-labels--active');\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.addClass(this.getLabelsContainer(), 'ui-selector-tab-labels--active');\n\t\t}\n\t}\n\n\thandleLabelsMouseLeave(): void\n\t{\n\t\tDom.addClass(this.getLabelsContainer(), 'ui-selector-tab-labels--animate-hide');\n\t\tDom.removeClass(this.getLabelsContainer(), 'ui-selector-tab-labels--animate-show');\n\t\tDom.removeClass(this.getLabelsContainer(), 'ui-selector-tab-labels--active');\n\n\t\tAnimation.handleTransitionEnd(this.getLabelsContainer(), 'max-width').then(() => {\n\t\t\tDom.removeClass(this.getLabelsContainer(), 'ui-selector-tab-labels--animate-hide');\n\t\t});\n\n\t\tDom.style(this.getLabelsContainer(), 'max-width', null);\n\t}\n\n\tshow(): void\n\t{\n\t\tthis.load();\n\t\tthis.getPopup().show();\n\t}\n\n\thide(): void\n\t{\n\t\tthis.getPopup().close();\n\t}\n\n\tdestroy(): void\n\t{\n\t\tif (this.destroying)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.destroying = true;\n\t\tthis.emit('onDestroy');\n\n\t\tinstances.delete(this.getId());\n\t\tif (this.isRendered())\n\t\t{\n\t\t\tthis.getPopup().destroy();\n\t\t}\n\n\t\tfor (const property in this)\n\t\t{\n\t\t\tif (this.hasOwnProperty(property))\n\t\t\t{\n\t\t\t\tdelete this[property];\n\t\t\t}\n\t\t}\n\n\t\tObject.setPrototypeOf(this, null);\n\t}\n\n\tisOpen(): boolean\n\t{\n\t\treturn this.popup && this.popup.isShown();\n\t}\n\n\tsetTargetNode(node: Element | { left: number, top: number } | null | MouseEvent): void\n\t{\n\t\tif (!Type.isDomNode(node) && !Type.isNull(node) && !Type.isObject(node))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.targetNode = node;\n\n\t\tif (this.isRendered())\n\t\t{\n\t\t\tthis.getPopup().setBindElement(this.targetNode);\n\t\t\tthis.getPopup().adjustPosition();\n\t\t}\n\t}\n\n\tgetTargetNode(): ?HTMLElement\n\t{\n\t\tif (this.targetNode === null)\n\t\t{\n\t\t\tif (this.getTagSelectorMode() === TagSelectorMode.OUTSIDE)\n\t\t\t{\n\t\t\t\treturn this.getTagSelector().getOuterContainer();\n\t\t\t}\n\t\t}\n\n\t\treturn this.targetNode;\n\t}\n\n\tadjustPosition()\n\t{\n\t\tif (this.isRendered())\n\t\t{\n\t\t\tthis.getPopup().adjustPosition();\n\t\t}\n\t}\n\n\tsetAutoHide(enable: boolean)\n\t{\n\t\tif (Type.isBoolean(enable))\n\t\t{\n\t\t\tthis.autoHide = enable;\n\t\t\tif (this.isRendered())\n\t\t\t{\n\t\t\t\tthis.getPopup().setAutoHide(enable);\n\t\t\t}\n\t\t}\n\t}\n\n\tisAutoHide(): boolean\n\t{\n\t\treturn this.autoHide;\n\t}\n\n\tsetHideByEsc(enable: boolean): void\n\t{\n\t\tif (Type.isBoolean(enable))\n\t\t{\n\t\t\tthis.hideByEsc = enable;\n\t\t\tif (this.isRendered())\n\t\t\t{\n\t\t\t\tthis.getPopup().setClosingByEsc(enable);\n\t\t\t}\n\t\t}\n\t}\n\n\tshouldHideByEsc(): boolean\n\t{\n\t\treturn this.hideByEsc;\n\t}\n\n\tfreeze(): void\n\t{\n\t\tif (this.isFrozen())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.frozenProps = {\n\t\t\tautoHide: this.isAutoHide(),\n\t\t\thideByEsc: this.shouldHideByEsc(),\n\t\t};\n\n\t\tthis.setAutoHide(false);\n\t\tthis.setHideByEsc(false);\n\n\t\tthis.getNavigation().disable();\n\t\tDom.addClass(this.getContainer(), 'ui-selector-dialog--freeze');\n\n\t\tthis.frozen = true;\n\t}\n\n\tunfreeze(): void\n\t{\n\t\tif (!this.isFrozen())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.setAutoHide(this.frozenProps.autoHide !== false);\n\t\tthis.setHideByEsc(this.frozenProps.hideByEsc !== false);\n\n\t\tthis.getNavigation().enable();\n\t\tDom.removeClass(this.getContainer(), 'ui-selector-dialog--freeze');\n\n\t\tthis.frozen = false;\n\t}\n\n\tisFrozen(): boolean\n\t{\n\t\treturn this.frozen;\n\t}\n\n\tgetWidth(): number\n\t{\n\t\treturn this.width;\n\t}\n\n\tsetWidth(width: number)\n\t{\n\t\tif (Type.isNumber(width) && width > 0)\n\t\t{\n\t\t\tthis.width = width;\n\t\t\tif (this.isRendered())\n\t\t\t{\n\t\t\t\tDom.style(this.getContainer(), 'width', `${width}px`);\n\t\t\t}\n\t\t}\n\t}\n\n\tgetHeight(): number\n\t{\n\t\treturn this.height;\n\t}\n\n\tsetHeight(height: number): Promise\n\t{\n\t\tif (Type.isNumber(height) && height > 0)\n\t\t{\n\t\t\tthis.height = height;\n\t\t\tif (this.isRendered())\n\t\t\t{\n\t\t\t\tDom.style(this.getContainer(), 'height', `${height}px`);\n\t\t\t\treturn Animation.handleTransitionEnd(this.getContainer(), 'height');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\treturn Promise.resolve();\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn Promise.resolve();\n\t\t}\n\t}\n\n\tgetOffsetLeft(): number\n\t{\n\t\treturn this.offsetLeft;\n\t}\n\n\tsetOffsetLeft(offset: number): void\n\t{\n\t\tif (Type.isNumber(offset) && offset >= 0)\n\t\t{\n\t\t\tthis.offsetLeft = offset;\n\t\t\tif (this.isRendered())\n\t\t\t{\n\t\t\t\tthis.getPopup().setOffset({ offsetLeft: offset });\n\t\t\t\tthis.adjustPosition();\n\t\t\t}\n\t\t}\n\t}\n\n\tgetOffsetTop(): number\n\t{\n\t\treturn this.offsetTop;\n\t}\n\n\tsetOffsetTop(offset: number): void\n\t{\n\t\tif (Type.isNumber(offset) && offset >= 0)\n\t\t{\n\t\t\tthis.offsetTop = offset;\n\t\t\tif (this.isRendered())\n\t\t\t{\n\t\t\t\tthis.getPopup().setOffset({ offsetTop: offset });\n\t\t\t\tthis.adjustPosition();\n\t\t\t}\n\t\t}\n\t}\n\n\tgetZindex(): number\n\t{\n\t\treturn this.getPopup().getZindex();\n\t}\n\n\tsetZindex(index: number): void\n\t{\n\t\tif ((Type.isNumber(index) && index > 0) || index === null)\n\t\t{\n\t\t\tthis.zIndex = index;\n\n\t\t\tif (this.isRendered())\n\t\t\t{\n\t\t\t\tthis.getPopup().params.zIndexAbsolute = index !== null ? index : 0;\n\t\t\t\tthis.adjustPosition();\n\t\t\t}\n\t\t}\n\t}\n\n\tisCacheable(): boolean\n\t{\n\t\treturn this.cacheable;\n\t}\n\n\tsetCacheable(cacheable: boolean): void\n\t{\n\t\tif (Type.isBoolean(cacheable))\n\t\t{\n\t\t\tthis.cacheable = cacheable;\n\t\t\tif (this.isRendered())\n\t\t\t{\n\t\t\t\tthis.getPopup().setCacheable(cacheable);\n\t\t\t}\n\t\t}\n\t}\n\n\tshouldFocusOnFirst(): boolean\n\t{\n\t\treturn this.focusOnFirst;\n\t}\n\n\tsetFocusOnFirst(flag: boolean): void\n\t{\n\t\tif (Type.isBoolean(flag))\n\t\t{\n\t\t\tthis.focusOnFirst = flag;\n\t\t}\n\t}\n\n\tisDropdownMode(): boolean\n\t{\n\t\treturn this.dropdownMode;\n\t}\n\n\tsetDropdownMode(flag: boolean): void\n\t{\n\t\tif (Type.isBoolean(flag))\n\t\t{\n\t\t\tthis.dropdownMode = flag;\n\t\t\tthis.getRecentTab().setVisible(!flag);\n\t\t}\n\t}\n\n\tgetMaxLabelWidth(): number\n\t{\n\t\treturn this.maxLabelWidth;\n\t}\n\n\tgetMinLabelWidth(): number\n\t{\n\t\treturn this.minLabelWidth;\n\t}\n\n\tgetPopup(): Popup\n\t{\n\t\tif (this.popup !== null)\n\t\t{\n\t\t\treturn this.popup;\n\t\t}\n\n\t\tthis.getTabs().forEach((tab: Tab) => {\n\t\t\tthis.insertTab(tab);\n\t\t});\n\n\t\tthis.popup = new Popup(Object.assign({\n\t\t\tcontentPadding: 0,\n\t\t\tpadding: 0,\n\t\t\toffsetTop: this.getOffsetTop(),\n\t\t\toffsetLeft: this.getOffsetLeft(),\n\t\t\tzIndexAbsolute: this.zIndex,\n\t\t\tanimation: {\n\t\t\t\tshowClassName: 'ui-selector-popup-animation-show',\n\t\t\t\tcloseClassName: 'ui-selector-popup-animation-close',\n\t\t\t\tcloseAnimationType: 'animation'\n\t\t\t},\n\t\t\tbindElement: this.getTargetNode(),\n\t\t\tbindOptions: {\n\t\t\t\tforceBindPosition: true\n\t\t\t},\n\t\t\tautoHide: this.isAutoHide(),\n\t\t\tcloseByEsc: this.shouldHideByEsc(),\n\t\t\tcacheable: this.isCacheable(),\n\t\t\tevents: {\n\t\t\t\tonFirstShow: this.handlePopupFirstShow.bind(this),\n\t\t\t\tonAfterShow: this.handlePopupAfterShow.bind(this),\n\t\t\t\tonAfterClose: this.handlePopupAfterClose.bind(this),\n\t\t\t\tonDestroy: this.handlePopupDestroy.bind(this)\n\t\t\t},\n\t\t\tcontent: this.getContainer()\n\t\t}, this.popupOptions));\n\n\t\tthis.rendered = true;\n\n\t\tthis.selectFirstTab();\n\n\t\treturn this.popup;\n\t}\n\n\tgetContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('container', () => {\n\n\t\t\tlet searchContainer = '';\n\t\t\tif (this.getTagSelectorMode() === TagSelectorMode.INSIDE)\n\t\t\t{\n\t\t\t\tsearchContainer = Tag.render`<div class=\"ui-selector-search\"></div>`;\n\n\t\t\t\tthis.getTagSelector().renderTo(searchContainer);\n\t\t\t}\n\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-selector-dialog\" style=\"width:${this.getWidth()}px; height:${this.getHeight()}px;\">\n\t\t\t\t\t${searchContainer}\n\t\t\t\t\t${this.getTabsContainer()}\n\t\t\t\t\t${this.getFooterContainer()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetTabsContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('tabs-container', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-selector-tabs\">\n\t\t\t\t\t${this.getTabContentsContainer()}\n\t\t\t\t\t${this.getLabelsContainer()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetTabContentsContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('tab-contents', () => {\n\t\t\treturn Tag.render`<div class=\"ui-selector-tab-contents\"></div>`;\n\t\t});\n\t}\n\n\tgetLabelsContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('labels-container', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div \n\t\t\t\t\tclass=\"ui-selector-tab-labels\"\n\t\t\t\t\tonmouseenter=\"${this.handleLabelsMouseEnter.bind(this)}\"\n\t\t\t\t\tonmouseleave=\"${this.handleLabelsMouseLeave.bind(this)}\"\n\t\t\t\t></div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetFooterContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('footer', () => {\n\t\t\tconst footer = this.getFooter() && this.getFooter().getContainer();\n\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-selector-footer-container\">${footer ? footer : ''}</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tisRendered(): boolean\n\t{\n\t\treturn this.rendered;\n\t}\n\n\tload(): void\n\t{\n\t\tif (this.loadState !== LoadState.UNSENT || !this.hasDynamicLoad())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.getTagSelector())\n\t\t{\n\t\t\tthis.getTagSelector().lock();\n\t\t}\n\n\t\tsetTimeout(() => {\n\t\t\tif (this.isLoading())\n\t\t\t{\n\t\t\t\tthis.showLoader();\n\t\t\t}\n\t\t}, 400);\n\n\t\tthis.loadState = LoadState.LOADING;\n\n\t\tAjax.runAction('ui.entityselector.load', {\n\t\t\t\tjson: {\n\t\t\t\t\tdialog: this\n\t\t\t\t},\n\t\t\t\tgetParameters: {\n\t\t\t\t\tcontext: this.getContext()\n\t\t\t\t}\n\t\t\t})\n\t\t\t.then((response) => {\n\t\t\t\tif (response && response.data && Type.isPlainObject(response.data.dialog))\n\t\t\t\t{\n\t\t\t\t\tthis.loadState = LoadState.DONE;\n\n\t\t\t\t\tconst entities =\n\t\t\t\t\t\tType.isArrayFilled(response.data.dialog.entities)\n\t\t\t\t\t\t\t? response.data.dialog.entities\n\t\t\t\t\t\t\t: []\n\t\t\t\t\t;\n\n\t\t\t\t\tentities.forEach((entityOptions: EntityOptions) => {\n\t\t\t\t\t\tconst entity = this.getEntity(entityOptions.id);\n\t\t\t\t\t\tif (entity)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tentity.setDynamicSearch(entityOptions.dynamicSearch);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\tthis.setOptions(response.data.dialog);\n\n\t\t\t\t\tthis.getPreselectedItems().forEach((preselectedItem: ItemId) => {\n\t\t\t\t\t\tconst item = this.getItem(preselectedItem);\n\t\t\t\t\t\tif (item)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\titem.select(true);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\tconst recentItems = response.data.dialog.recentItems;\n\t\t\t\t\tif (Type.isArray(recentItems))\n\t\t\t\t\t{\n\t\t\t\t\t\trecentItems.forEach((recentItem: ItemId) => {\n\t\t\t\t\t\t\tconst item = this.getItem(recentItem);\n\t\t\t\t\t\t\tif (item)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.getRecentTab().getRootNode().addItem(item);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!this.getRecentTab().getRootNode().hasChildren() && this.getRecentTab().getStub())\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.getRecentTab().getStub().show();\n\t\t\t\t\t}\n\n\t\t\t\t\tif (this.getTagSelector())\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.getTagSelector().unlock();\n\t\t\t\t\t}\n\n\t\t\t\t\tif (this.isRendered() && !this.getActiveTab())\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.selectFirstTab();\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.focusSearch();\n\t\t\t\t\tthis.destroyLoader();\n\n\t\t\t\t\tif (this.shouldFocusOnFirst())\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.focusOnFirstNode();\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.emit('onLoad');\n\t\t\t\t}\n\t\t\t})\n\t\t\t.catch((error) => {\n\t\t\t\tthis.loadState = LoadState.UNSENT;\n\n\t\t\t\tif (this.getTagSelector())\n\t\t\t\t{\n\t\t\t\t\tthis.getTagSelector().unlock();\n\t\t\t\t}\n\n\t\t\t\tthis.focusSearch();\n\t\t\t\tthis.destroyLoader();\n\n\t\t\t\tthis.emit('onLoadError', { error });\n\n\t\t\t\tconsole.error(error);\n\t\t\t});\n\t}\n\n\thasDynamicLoad(): boolean\n\t{\n\t\treturn this.getEntities().some((entity: Entity) => entity.hasDynamicLoad());\n\t}\n\n\thasDynamicSearch(): boolean\n\t{\n\t\treturn this.getEntities().some((entity: Entity) => {\n\t\t\treturn entity.isSearchable() && entity.hasDynamicSearch();\n\t\t});\n\t}\n\n\tisLoaded(): boolean\n\t{\n\t\treturn this.loadState === LoadState.DONE;\n\t}\n\n\tisLoading(): boolean\n\t{\n\t\treturn this.loadState === LoadState.LOADING;\n\t}\n\n\tsearch(queryString: string): void\n\t{\n\t\tconst query = Type.isStringFilled(queryString) ? queryString.trim() : '';\n\t\tif (!Type.isStringFilled(query))\n\t\t{\n\t\t\tthis.selectFirstTab();\n\t\t\tif (this.getSearchTab())\n\t\t\t{\n\t\t\t\tthis.getSearchTab().clearResults();\n\t\t\t}\n\t\t}\n\t\telse if (this.getSearchTab())\n\t\t{\n\t\t\tthis.selectTab(this.getSearchTab().getId());\n\t\t\tthis.getSearchTab().search(query);\n\t\t}\n\n\t\tthis.emit('onSearch', { query });\n\t}\n\n\tsaveRecentItem(item: Item): void\n\t{\n\t\tif (this.getContext() === null || !item.isSaveable())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.recentItemsToSave.push(item);\n\t\tthis.saveRecentItemsWithDebounce();\n\t}\n\n\tsaveRecentItems(): void\n\t{\n\t\tif (!Type.isArrayFilled(this.recentItemsToSave))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tAjax.runAction('ui.entityselector.saveRecentItems', {\n\t\t\t\tjson: {\n\t\t\t\t\tdialog: this,\n\t\t\t\t\trecentItems: this.recentItemsToSave\n\t\t\t\t},\n\t\t\t\tgetParameters: {\n\t\t\t\t\tcontext: this.getContext()\n\t\t\t\t}\n\t\t\t})\n\t\t\t.then((response) => {\n\n\t\t\t})\n\t\t\t.catch((error) => {\n\t\t\t\tconsole.error(error);\n\t\t\t});\n\n\t\tthis.recentItemsToSave = [];\n\t}\n\n\tgetFocusedNode(): ?ItemNode\n\t{\n\t\treturn this.focusedNode;\n\t}\n\n\tclearNodeFocus(): void\n\t{\n\t\tif (this.focusedNode)\n\t\t{\n\t\t\tthis.focusedNode.unfocus();\n\t\t\tthis.focusedNode = null;\n\t\t}\n\t}\n\n\tfocusOnFirstNode(): ?ItemNode\n\t{\n\t\tif (this.getActiveTab())\n\t\t{\n\t\t\tconst itemNode = this.getActiveTab().getRootNode().getFirstChild();\n\t\t\tif (itemNode)\n\t\t\t{\n\t\t\t\titemNode.focus();\n\n\t\t\t\treturn itemNode;\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tshouldClearUnavailableItems(): boolean\n\t{\n\t\treturn this.clearUnavailableItems;\n\t}\n\n\thandleItemNodeFocus(event: BaseEvent): void\n\t{\n\t\tconst { node } = event.getData();\n\t\tif (this.focusedNode === node)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.clearNodeFocus();\n\n\t\tthis.focusedNode = node;\n\t}\n\n\thandleItemNodeUnfocus(): void\n\t{\n\t\tthis.clearNodeFocus();\n\t}\n\n\ttoJSON()\n\t{\n\t\treturn {\n\t\t\tid: this.getId(),\n\t\t\tcontext: this.getContext(),\n\t\t\tentities: this.getEntities(),\n\t\t\tpreselectedItems: this.getPreselectedItems(),\n\t\t\tclearUnavailableItems: this.shouldClearUnavailableItems()\n\t\t};\n\t}\n}"],"names":["Symbol","iterator","ItemCollection","comparator","Type","isFunction","item","index","searchIndexToInsert","items","splice","push","includes","indexOf","isNumber","isUndefined","first","last","count","length","getIndex","callbackfn","thisArg","forEach","value","low","high","mid","Math","floor","ItemNodeComparator","orderProperty","orderDirection","sortOrder","nodeA","nodeB","itemA","getItem","itemB","valueA","valueB","result","isString","localeCompare","isNull","order","props","Object","keys","a","b","i","numberOfProperties","makeComparator","Highlighter","text","matches","isStringFilled","offset","match","getStartIndex","Text","encode","substring","getEndIndex","ItemBadge","badgeOptions","options","isPlainObject","setTitle","title","setTextColor","textColor","setBgColor","bgColor","container","Tag","render","textContent","getTitle","Dom","style","getTextColor","getBgColor","MatchField","field","indexes","addIndexes","matchIndexes","matchIndex","add","isArray","addIndex","RenderMode","ItemNode","nodeOptions","Cache","MemoryCache","WeakMap","PARTIAL","Runtime","debounce","isObject","itemOrder","makeMultipleComparator","children","renderMode","OVERRIDE","subtitle","caption","supertitle","avatar","link","linkTitle","badges","setSubtitle","setSupertitle","setCaption","setAvatar","setLink","setLinkTitle","setBadges","setDynamic","dynamic","setOpen","open","getParentNode","getTab","getDialog","tab","parentNode","siblings","getChildren","getByIndex","childOptions","tabs","childItem","addItem","childNode","addChildren","child","Error","isChildOf","has","childItems","set","setTab","setParentNode","isRendered","renderWithDebounce","isRoot","getDepthLevel","itemNode","get","createNode","addChild","getFirstChild","removeChild","isFocused","unfocus","removeNode","delete","parent","getFirst","getLast","isDynamic","dynamicPromise","Ajax","runAction","json","parentItem","dialog","getParameters","context","getContext","then","response","data","loaded","catch","error","console","isBoolean","isLoaded","setAutoOpen","autoOpen","loader","Loader","target","getIndicatorContainer","size","getLoader","show","addClass","hide","removeClass","destroy","isOpen","hasChildren","loadChildren","destroyLoader","expand","showLoader","getChildrenContainer","scrollHeight","getOuterContainer","offsetHeight","requestAnimationFrame","renderRoot","getTitleContainer","getSubtitleContainer","getSubtitle","getSupertitleContainer","getSupertitle","getCaptionContainer","getCaption","getAvatar","getAvatarContainer","getItemMaxDepth","highlight","isAutoOpen","renderChildren","rendered","stub","getStub","isAutoShow","hasDynamicLoad","clean","append","replaceMacros","getLink","getLinkTitle","getBadges","badge","cache","remember","className","isSelected","getContainer","getItemsContainer","handleTransitionEnd","bind","handleClick","handleMouseEnter","handleMouseLeave","isArrayFilled","getBadgeContainer","getLinkContainer","handleLinkClick","getLinkTextContainer","highlights","getHighlights","matchField","getField","fieldName","getName","isCustom","getCustomData","innerHTML","mark","getMatches","focused","emit","node","collapse","deselect","shouldHideOnDeselect","select","shouldClearSearchOnSelect","clearSearch","shouldHideOnSelect","focusSearch","tabContainer","nodeContainer","tabRect","getPosition","nodeRect","margin","top","scrollTop","bottom","click","event","stopPropagation","propertyName","focus","showLink","hideLink","SearchFieldIndex","getIndexes","WordIndex","word","startIndex","setWord","setStartIndex","rsAstralRange","rsComboMarksRange","reComboHalfMarksRange","rsComboSymbolsRange","rsComboMarksExtendedRange","rsComboMarksSupplementRange","rsComboRange","rsDingbatRange","rsLowerRange","rsMathOpRange","rsNonCharRange","rsPunctuationRange","rsSpaceRange","rsUpperRange","rsVarRange","rsBreakRange","rsApos","rsBreak","rsCombo","rsDigit","rsDingbat","rsLower","rsMisc","rsFitz","rsModifier","rsNonAstral","rsRegional","rsSurrPair","rsUpper","rsZWJ","rsMiscLower","rsMiscUpper","rsOptContrLower","rsOptContrUpper","reOptMod","rsOptVar","rsOptJoin","join","rsOrdLower","rsOrdUpper","rsSeq","rsEmoji","unicodeWordsRegExp","RegExp","asciiWordRegExp","hasUnicodeWordRegExp","SearchIndex","fieldIndex","entity","getEntity","isSearchable","isHidden","searchFields","getSearchFields","isSeachable","isSystem","createIndex","customData","getType","wordIndexes","splitText","fillComplexWords","position","toLowerCase","substr","hasUnicodeWord","splitUnicodeText","splitAsciiText","splitTextInternal","test","regExp","exec","lastIndex","complexWord","currentIndex","currentArrayIndex","nextIndex","sameWord","getWord","SearchField","fieldOptions","name","setType","type","setSystem","system","setSeachable","searchable","flag","Entity","entityOptions","setEventNamespace","id","defaultOptions","constructor","getEntityDefaultOptions","merge","JSON","parse","stringify","itemOptions","tagOptions","setDynamicLoad","dynamicLoad","setDynamicSearch","dynamicSearch","setSearchFields","setSearchCacheLimits","searchCacheLimits","option","entityType","getOptionInternal","entityTypeBadges","getItemOption","getEntityType","conditions","condition","clear","titleField","subtitleField","customFields","limits","limit","getId","getOptions","hasDynamicSearch","getExtensions","extension","settings","Extension","getSettings","entities","extensions","entityId","getDefaultOptions","getItemOptions","getTagOptions","EventEmitter","Item","Set","selected","Map","entries","setSearchable","setSaveable","saveable","setDeselectable","deselectable","setHidden","hidden","setContextSort","contextSort","setGlobalSort","globalSort","setSort","sort","getEntityId","addEntity","getNodes","getEntityItemOption","Loc","getMessage","nodes","preselectedMode","emitEvents","BaseEvent","isDefaultPrevented","handleItemSelect","saveRecentItem","isDeselectable","handleItemDeselect","getTagSelector","removeTag","tag","getTag","searchIndex","create","getTagOption","useItemOptions","fn","toPascalCase","getEntityTagOption","getTagGlobalOption","str","replace","getTagAvatar","getTagLink","maxWidth","getTagMaxWidth","getTagTextColor","getTagBgColor","fontWeight","getTagFontWeight","BaseStub","autoShow","getOption","remove","defaultValue","DefaultStub","getDefaultTitle","icon","getIcon","iconOpacity","min","max","iconStyle","arrow","getActiveFooter","tabTitle","BaseFooter","Dialog","Tab","tabOptions","setDialog","showDefaultFooter","rootNode","setVisible","visible","setItemMaxDepth","itemMaxDepth","setIcon","setStub","stubOptions","setFooter","footer","footerOptions","instance","Reflection","getClass","footerContent","createFooter","getFooter","adjustFooter","appendFooter","setProperty","state","getPropertyByState","states","property","labelState","isHovered","selectedHovered","hovered","default","depth","isVisible","handleLabelClick","handleLabelMouseEnter","handleLabelMouseLeave","getIconContainer","getRootNode","getPropertyByCurrentState","getLabelContainer","renderLabel","locked","selectTab","hover","unhover","Animation","element","properties","Promise","resolve","handler","Event","unbind","animationName","TagItem","onclick","setMaxWidth","setFontWeight","selector","getSelector","width","attr","getContentContainer","getMaxWidth","getFontWeight","getRemoveIcon","handleContainerClick","getOnclick","handleRemoveIconClick","animate","offsetWidth","handleAnimationEnd","TagSelector","selectorOptions","getRandom","multiple","addButtonVisible","showAddButton","createButtonVisible","showCreateButton","textBoxVisible","showTextBox","setReadonly","readonly","setLocked","setAddButtonCaption","addButtonCaption","setAddButtonCaptionMore","addButtonCaptionMore","setCreateButtonCaption","createButtonCaption","setPlaceholder","placeholder","setTextBoxAutoHide","textBoxAutoHide","setTextBoxWidth","textBoxWidth","setMaxHeight","maxHeight","setTagAvatar","tagAvatar","setTagMaxWidth","tagMaxWidth","setTagTextColor","tagTextColor","setTagBgColor","tagBgColor","setTagFontWeight","tagFontWeight","dialogOptions","selectedItems","concat","assign","tagSelectorOptions","isMultiple","tagSelector","addTag","subscribeFromOptions","events","getTextBox","disabled","isLocked","changed","updateTags","tagItem","getTags","find","isObjectLike","setSelector","removeTags","tags","insertBefore","toggleAddButtonCaption","filter","el","isDomNode","appendChild","isReadonly","getMaxHeight","getCreateButton","getAddButton","input","getPlaceholder","handleTextBoxInput","handleTextBoxBlur","handleTextBoxKeyUp","handleTextBoxKeyDown","getTextBoxWidth","getItemsHeight","getMinHeight","autoHide","height","getActualButtonCaption","handleAddButtonClick","getAddButtonCaptionMore","getAddButtonCaption","handleCreateButtonClick","getCreateButtonCaption","newValue","getTextBoxValue","textBoxOldValue","hideTextBox","key","preventDefault","Browser","isMac","metaKey","ctrlKey","hideAddButton","focusTextBox","Navigation","subscribe","handleDialogShow","handleDialogHide","handleDialogDestroy","handleDocumentKeyDown","handleDocumentMouseMove","isEnabled","bindEvents","enabled","unbindEvents","unlockTab","document","getActiveNode","nextNode","currentNode","getNextSibling","previousNode","getPreviousSibling","lastChild","getLastChild","getActiveTab","lastNode","getFocusedNode","scrollIntoView","activeTab","lockedTab","lock","unlock","enable","disable","altKey","keyName","keyMap","query","getTagSelectorQuery","call","lockTab","firstNode","getFirstNode","focusOnNode","getNextNode","getLastNode","getPreviousNode","selectFirstTab","shiftKey","previousTab","getPreviousTab","selectLastTab","nextTab","getNextTab","SliderIntegration","handleSliderOpen","handleSliderClose","unsubscribe","sliders","unfreeze","getData","sliderEvent","slider","getSlider","freeze","DefaultFooter","setContent","getContent","content","RecentTab","defaults","MatchResult","queryWords","matchFields","MatchIndex","queryWord","endIndex","collator","Intl","Collator","undefined","sensitivity","SearchEngine","searchQuery","matchResults","getQueryWords","matchResult","matchItem","results","matchWord","searchIndexes","getSearchIndex","j","compare","SearchQuery","trim","split","cacheable","getDynamicSearchEntities","hasDynamicSearchEntity","dynamicSearchEntities","getQuery","SearchLoader","getBoxContainer","getSpacerContainer","getTextContainer","isShown","SearchTabFooter","handleOnSearch","handleMetaEnter","getQueryContainer","getLoaderContainer","color","label","finalize","hideLoader","emitAsync","getLastSearchQuery","clearResults","createItem","SearchTab","searchOptions","load","setAllowCreateItem","allowCreateItem","dynamicEntities","getDynamicEntities","setDynamicSearchEntities","isEmpty","getSearchLoader","lastSearchQuery","getItems","matchItems","appendResults","shouldFocusOnFirst","focusOnFirstNode","shouldLoad","loadWithDebounce","isEmptyResult","toggleEmptyResult","contextSortA","getContextSort","contextSortB","globalSortA","getGlobalSort","globalSortB","disableRender","hasItem","setHighlights","getMatchFields","enableRender","getEntities","hasCacheLimit","getSearchCacheLimits","some","pattern","isCacheable","found","queryCache","startsWith","isQueryCacheable","isQueryLoaded","addCacheQuery","onrequeststart","xhr","queryXhr","removeCacheQuery","isTabEmpty","searchLoader","removeChildren","LoadState","TagSelectorMode","instances","UNSENT","saveRecentItems","clearUnavailableItems","enableSearch","customOptions","mandatoryOptions","tagSelectorMode","INSIDE","setTagSelector","OUTSIDE","setTargetNode","targetNode","setHideOnSelect","hideOnSelect","setHideOnDeselect","hideOnDeselect","setClearSearchOnSelect","clearSearchOnSelect","setWidth","setHeight","setAutoHide","setHideByEsc","hideByEsc","setOffsetLeft","offsetLeft","setOffsetTop","offsetTop","setZindex","zIndex","setCacheable","setFocusOnFirst","focusOnFirst","recentTab","recentTabOptions","searchTab","searchTabOptions","addTab","setDropdownMode","dropdownMode","setPreselectedItems","preselectedItems","setUndeselectedItems","undeselectedItems","setOptions","preload","getPreselectedItems","popupOptions","allowedOptions","navigation","handleItemNodeFocus","handleItemNodeUnfocus","canShowDefaultFooter","getFooterContainer","insertTab","getTabs","newActiveTab","clearNodeFocus","getLabelsContainer","getTabContentsContainer","onlyVisible","isDropdownMode","getRecentTab","activeFound","removeNodes","entityItems","getEntityItems","String","Array","from","itemIds","validateItemIds","itemId","undeselectable","getUndeselectedItems","tabId","getSelectedItems","hasEntity","getTagSelectorMode","handleTagSelectorInput","handleTagSelectorAddButtonClick","handleTagSelectorTagRemove","handleTagSelectorAfterTagRemove","handleTagSelectorAfterTagAdd","handleTagSelectorClick","getSearchTab","clearTextBox","getTabsContainer","search","adjustByTagSelector","adjustPosition","newTagSelectorHeight","calcHeight","tagSelectorHeight","getHeight","observer","MutationObserver","left","parseInt","getPopup","getPopupContainer","getMinLabelWidth","observe","attributes","attributeFilter","deselectAll","isTagSelectorOutside","createTag","observeTabOverlapping","rect","freeSpace","right","getMaxLabelWidth","close","destroying","hasOwnProperty","setPrototypeOf","popup","setBindElement","setClosingByEsc","isFrozen","frozenProps","isAutoHide","shouldHideByEsc","getNavigation","frozen","setOffset","getZindex","params","zIndexAbsolute","maxLabelWidth","minLabelWidth","Popup","contentPadding","padding","getOffsetTop","getOffsetLeft","animation","showClassName","closeClassName","closeAnimationType","bindElement","getTargetNode","bindOptions","forceBindPosition","closeByEsc","onFirstShow","handlePopupFirstShow","onAfterShow","handlePopupAfterShow","onAfterClose","handlePopupAfterClose","onDestroy","handlePopupDestroy","searchContainer","renderTo","getWidth","handleLabelsMouseEnter","handleLabelsMouseLeave","loadState","setTimeout","isLoading","LOADING","DONE","preselectedItem","recentItems","recentItem","queryString","isSaveable","recentItemsToSave","saveRecentItemsWithDebounce","focusedNode","shouldClearUnavailableItems"],"mappings":"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"}