if(typeof BX.UI.EntityConfigurationManager==="undefined"){BX.UI.EntityConfigurationManager=function(){this.id="";this._editor=null};BX.UI.EntityConfigurationManager.prototype={initialize:function(t,e){this.id=BX.type.isNotEmptyString(t)?t:BX.util.getRandomString(4);this._editor=e.editor},isSelectionEnabled:function(){return this._editor.getUserFieldManager().isSelectionEnabled()},isCreationEnabled:function(){return this._editor.getUserFieldManager().isCreationEnabled()},isMandatoryControlEnabled:function(){return this._editor.getUserFieldManager().isMandatoryControlEnabled()},getTypeInfos:function(){return this._editor.getUserFieldManager().getTypeInfos()},getCreationPageUrl:function(t){return this._editor.getUserFieldManager().getCreationPageUrl()},openCreationPageUrl:function(t){window.open(this.getCreationPageUrl(t))},hasExternalForm:function(t){return t==="custom"},createFieldConfigurator:function(t,e){if(!BX.type.isPlainObject(t)){throw"BX.UI.EntityConfigurationManager: The 'params' argument must be object."}var i=BX.prop.get(t,"field",null);if(!i||i.getType()==="userField"&&this._editor.getUserFieldManager().isModificationEnabled()){return this.getUserFieldConfigurator(t,e)}else{return this.getSimpleFieldConfigurator(t,e)}},getSimpleFieldConfigurator:function(t,e){var i="";var n=BX.prop.get(t,"field",null);if(n){i=n.getType();n.setVisible(false)}else{i=BX.prop.get(t,"typeId",BX.UI.EntityUserFieldType.string)}return this._fieldConfigurator=BX.UI.EntityEditorFieldConfigurator.create("",{editor:this._editor,schemeElement:null,model:e._model,mode:BX.UI.EntityEditorMode.edit,parent:e,typeId:i,field:n,mandatoryConfigurator:null})},getUserFieldConfigurator:function(t,e){var i="";var n=BX.prop.get(t,"field",null);if(n){if(!(n instanceof BX.UI.EntityEditorUserField)){throw"BX.UI.EntityConfigurationManager: The 'field' param must be EntityEditorUserField."}i=n.getFieldType();n.setVisible(false)}else{i=BX.prop.get(t,"typeId",BX.UI.EntityUserFieldType.string)}return BX.UI.EntityEditorUserFieldConfigurator.create("",{editor:this._editor,schemeElement:null,model:e.getModel(),mode:BX.UI.EntityEditorMode.edit,parent:e,typeId:i,field:n,enableMandatoryControl:BX.prop.getBoolean(t,"enableMandatoryControl",true),mandatoryConfigurator:t.mandatoryConfigurator,showAlways:true})}};BX.UI.EntityConfigurationManager.create=function(t,e){var i=new BX.UI.EntityConfigurationManager;i.initialize(t,e);return i}}if(typeof BX.UI.EntityEditorFieldConfigurator==="undefined"){BX.UI.EntityEditorFieldConfigurator=function(){BX.UI.EntityEditorFieldConfigurator.superclass.constructor.apply(this);this._field=null;this._typeId="";this._isLocked=false;this._labelInput=null;this._saveButton=null;this._cancelButton=null;this._isTimeEnabledCheckBox=null;this._isRequiredCheckBox=null;this._isMultipleCheckBox=null;this._showAlwaysCheckBox=null;this._enumItemWrapper=null;this._enumItemContainer=null;this._enumButtonWrapper=null;this._optionWrapper=null;this._enumItems=null;this._enableMandatoryControl=true;this._mandatoryConfigurator=null};BX.extend(BX.UI.EntityEditorFieldConfigurator,BX.UI.EntityEditorControl);BX.UI.EntityEditorFieldConfigurator.prototype.doInitialize=function(){BX.UI.EntityEditorFieldConfigurator.superclass.doInitialize.apply(this);this._field=BX.prop.get(this._settings,"field",null);if(this._field){this.checkField()}this._enableMandatoryControl=BX.prop.getBoolean(this._settings,"enableMandatoryControl",true);this._mandatoryConfigurator=BX.prop.get(this._settings,"mandatoryConfigurator",null);this._typeId=BX.prop.getString(this._settings,"typeId","");this._enumItems=[]};BX.UI.EntityEditorFieldConfigurator.prototype.checkField=function(){};BX.UI.EntityEditorFieldConfigurator.prototype.getDefaultFieldLabel=function(){var t=this._editor.getUserFieldManager();return this._field?this._field.getTitle():t.getDefaultFieldLabel(this._typeId)};BX.UI.EntityEditorFieldConfigurator.prototype.layout=function(t){if(this._hasLayout){return}if(this._mode===BX.UI.EntityEditorMode.view){throw"EntityEditorFieldConfigurator. View mode is not supported by this control type."}this._wrapper=BX.create("div",{props:{className:"ui-entity-editor-content-block-new-fields"}});this.layoutInternal();this.registerLayout(t);this._hasLayout=true};BX.UI.EntityEditorFieldConfigurator.prototype.layoutInternal=function(){this._wrapper.appendChild(this.getInputContainer());this._wrapper.appendChild(this.getOptionContainer());this._wrapper.appendChild(BX.create("hr",{props:{className:"ui-entity-editor-line"}}));this._wrapper.appendChild(this.getButtonContainer())};BX.UI.EntityEditorFieldConfigurator.prototype.getInputTitle=function(){return this._field.getTitle()};BX.UI.EntityEditorFieldConfigurator.prototype.getInputContainer=function(){this._labelInput=BX.create("input",{attrs:{className:"ui-ctl-element",type:"text",value:this.getInputTitle()}});return BX.create("div",{props:{className:"ui-entity-editor-content-block"},children:[BX.create("div",{props:{className:"ui-entity-editor-block-title"},children:[BX.create("span",{attrs:{className:"ui-entity-editor-block-title-text"},text:BX.message("UI_ENTITY_EDITOR_FIELD_TITLE")})]}),BX.create("div",{props:{className:"ui-entity-editor-content-block"},children:[BX.create("div",{props:{className:"ui-ctl ui-ctl-textbox ui-ctl-w100"},children:[this._labelInput]})]})]})};BX.UI.EntityEditorFieldConfigurator.prototype.getOptionContainer=function(){this._optionWrapper=BX.create("div",{props:{className:"ui-entity-editor-content-block"}});if(this._field.areAttributesEnabled()&&!this._field.isRequired()&&this._mandatoryConfigurator){this._isRequiredCheckBox=this.createOption({caption:this._mandatoryConfigurator.getTitle()+":",labelSettings:{props:{className:"ui-entity-new-field-addiction-label"}},containerSettings:{style:{alignItems:"center"}},elements:this._mandatoryConfigurator.getButton().prepareLayout()});this._isRequiredCheckBox.checked=!this._mandatoryConfigurator.isEmpty();this._mandatoryConfigurator.setSwitchCheckBox(this._isRequiredCheckBox);this._mandatoryConfigurator.setLabel(this._isRequiredCheckBox.nextSibling);this._mandatoryConfigurator.setEnabled(this._isRequiredCheckBox.checked);this._mandatoryConfigurator.adjust()}this._showAlwaysCheckBox=this.createOption({caption:BX.message("UI_ENTITY_EDITOR_SHOW_ALWAYS")});this._showAlwaysCheckBox.checked=this._field.checkOptionFlag(BX.UI.EntityEditorControlOptions.showAlways);return BX.create("div",{props:{className:"ui-entity-editor-content-block ui-entity-editor-content-block-checkbox"},children:[this._optionWrapper]})};BX.UI.EntityEditorFieldConfigurator.prototype.getButtonContainer=function(){this._saveButton=BX.create("span",{props:{className:"ui-btn ui-btn-primary"},text:BX.message("UI_ENTITY_EDITOR_SAVE"),events:{click:BX.delegate(this.onSaveButtonClick,this)}});this._cancelButton=BX.create("span",{props:{className:"ui-btn ui-btn-light-border"},text:BX.message("UI_ENTITY_EDITOR_CANCEL"),events:{click:BX.delegate(this.onCancelButtonClick,this)}});return BX.create("div",{props:{className:"ui-entity-editor-content-block-new-fields-btn-container"},children:[this._saveButton,this._cancelButton]})};BX.UI.EntityEditorFieldConfigurator.prototype.appendEnumerationSettings=function(){};BX.UI.EntityEditorFieldConfigurator.prototype.getIsTimeEnabledCheckBox=function(){var t=null;if(this._field===null&&(this._typeId==="datetime"||this._typeId==="date")){t=this.createOption({caption:BX.message("UI_ENTITY_EDITOR_UF_ENABLE_TIME")})}return t};BX.UI.EntityEditorFieldConfigurator.prototype.getMultipleCheckBox=function(){var t=null;if(this._field===null&&this._typeId!=="boolean"){t=this.createOption({caption:BX.message("UI_ENTITY_EDITOR_UF_MULTIPLE_FIELD")})}return t};BX.UI.EntityEditorFieldConfigurator.prototype.getIsRequiredCheckBox=function(){var t=null;if(this._field!==null&&this._field.areAttributesEnabled()&&!this._field.isRequired()&&this._mandatoryConfigurator){t=this.createOption({caption:this._mandatoryConfigurator.getTitle()+":",labelSettings:{props:{className:"ui-entity-new-field-addiction-label"}},containerSettings:{style:{alignItems:"center"}},elements:this._mandatoryConfigurator.getButton().prepareLayout()});t.checked=!this._mandatoryConfigurator.isEmpty();this._mandatoryConfigurator.setSwitchCheckBox(t);this._mandatoryConfigurator.setLabel(t.nextSibling);this._mandatoryConfigurator.setEnabled(t.checked);this._mandatoryConfigurator.adjust()}return t};BX.UI.EntityEditorFieldConfigurator.prototype.clearLayout=function(){if(!this._hasLayout){return}this._wrapper=BX.remove(this._wrapper);this._labelInput=null;this._saveButton=null;this._cancelButton=null;this._isRequiredCheckBox=null;this._showAlwaysCheckBox=null;this._enumItemWrapper=null;this._enumButtonWrapper=null;this._enumItemContainer=null;this._optionWrapper=null;this._enumItems=[];this._hasLayout=false};BX.UI.EntityEditorFieldConfigurator.prototype.createOption=function(t){var e=BX.create("input",{props:{className:"ui-ctl-element",type:"checkbox"}});var i=BX.create("div",{props:{className:"ui-ctl ui-ctl-checkbox ui-ctl-xs"},children:[BX.create("label",{children:[e,BX.create("span",{props:{className:"ui-ctl-label-text"},text:BX.prop.getString(t,"caption","")})]})]});var n=BX.prop.getObject(t,"labelSettings",null);if(n){BX.adjust(i,n)}var r=BX.prop.getString(t,"helpCode","");if(r){i.appendChild(BX.create("span",{props:{className:"ui-entity-editor-new-field-helper-icon"},events:{click:function(){top.BX.Helper.show("redirect=detail&code="+r)}}}))}else{var o=BX.prop.getString(t,"helpUrl","");if(o!==""){i.appendChild(BX.create("a",{props:{className:"ui-entity-editor-new-field-helper-icon",href:o,target:"_blank"}}))}}var a=[i];var s=BX.prop.getArray(t,"elements",[]);for(var l=0,d=s.length;l<d;l++){a.push(s[l])}var u=BX.create("div",{children:a});var p=BX.prop.getObject(t,"containerSettings",null);if(p){BX.adjust(u,p)}this._optionWrapper.appendChild(u);return e};BX.UI.EntityEditorFieldConfigurator.prototype.onSaveButtonClick=function(t){if(this._isLocked){return}if(this._mandatoryConfigurator){if(this._mandatoryConfigurator.isChanged()){this._mandatoryConfigurator.acceptChanges()}this._mandatoryConfigurator.close()}var e=this.prepareSaveParams();BX.onCustomEvent(this,"onSave",[this,e])};BX.UI.EntityEditorFieldConfigurator.prototype.prepareSaveParams=function(){var t={typeId:this._typeId,label:this._labelInput.value};if(this._field){t["field"]=this._field;t["mandatory"]=this._isRequiredCheckBox?this._isRequiredCheckBox.checked:this._field.isRequired()}else{if(this._isRequiredCheckBox){t["mandatory"]=this._isRequiredCheckBox.checked}}t["showAlways"]=this._showAlwaysCheckBox.checked;return t};BX.UI.EntityEditorFieldConfigurator.prototype.onCancelButtonClick=function(t){if(this._isLocked){return}var e={typeId:this._typeId};if(this._field){e["field"]=this._field}BX.onCustomEvent(this,"onCancel",[this,e])};BX.UI.EntityEditorFieldConfigurator.prototype.setLocked=function(t){t=!!t;if(this._isLocked===t){return}this._isLocked=t;if(this._isLocked){BX.addClass(this._saveButton,"ui-btn-clock")}else{BX.removeClass(this._saveButton,"ui-btn-clock")}};BX.UI.EntityEditorFieldConfigurator.prototype.getField=function(){return this._field};BX.UI.EntityEditorFieldConfigurator.create=function(t,e){var i=new BX.UI.EntityEditorFieldConfigurator;i.initialize(t,e);return i}}
//# sourceMappingURL=field-configurator.map.js