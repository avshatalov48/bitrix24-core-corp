BX.namespace("BX.UI");if(typeof BX.UI.EntityEditorToolPanel==="undefined"){BX.UI.EntityEditorToolPanel=function(){this._id="";this._settings={};this._container=null;this._wrapper=null;this._editor=null;this._isVisible=false;this._isLocked=false;this._hasLayout=false;this._keyPressHandler=BX.delegate(this.onKeyPress,this)};BX.UI.EntityEditorToolPanel.prototype={initialize:function(t,e){this._id=BX.type.isNotEmptyString(t)?t:BX.util.getRandomString(4);this._settings=e?e:{};this._container=BX.prop.getElementNode(this._settings,"container",null);this._editor=BX.prop.get(this._settings,"editor",null);this._isVisible=BX.prop.getBoolean(this._settings,"visible",false)},getId:function(){return this._id},getContainer:function(){return this._container},setContainer:function(t){this._container=t},isVisible:function(){return this._isVisible},setVisible:function(t){t=!!t;if(this._isVisible===t){return}this._isVisible=t;this.adjustLayout()},isLocked:function(){return this._isLocked},setLocked:function(t){t=!!t;if(this._isLocked===t){return}this._isLocked=t;if(t){BX.addClass(this._editButton,"ui-btn-clock")}else{BX.removeClass(this._editButton,"ui-btn-clock")}},disableSaveButton:function(){if(!this._editButton){return}this._editButton.disabled=true;BX.addClass(this._editButton,"ui-btn-disabled")},enableSaveButton:function(){if(!this._editButton){return}this._editButton.disabled=false;BX.removeClass(this._editButton,"ui-btn-disabled")},isSaveButtonEnabled:function(){return this._editButton&&!this._editButton.disabled},layout:function(){this._editButton=BX.create("button",{props:{className:"ui-btn ui-btn-success",title:"[Ctrl+Enter]"},text:BX.message("UI_ENTITY_EDITOR_SAVE"),events:{click:BX.delegate(this.onSaveButtonClick,this)}});this._cancelButton=BX.create("a",{props:{className:"ui-btn ui-btn-link",title:"[Esc]"},text:BX.message("UI_ENTITY_EDITOR_CANCEL"),attrs:{href:"#"},events:{click:BX.delegate(this.onCancelButtonClick,this)}});this._errorContainer=BX.create("DIV",{props:{className:"ui-entity-section-control-error-block"}});this._errorContainer.style.maxHeight="0";this._wrapper=BX.create("DIV",{props:{className:"ui-entity-wrap"},children:[BX.create("DIV",{props:{className:"ui-entity-section ui-entity-section-control"},children:[this._editButton,this._cancelButton,this._errorContainer]})]});this._container.appendChild(this._wrapper);this._hasLayout=true;this.adjustLayout()},adjustLayout:function(){if(!this._hasLayout){return}if(!this._isVisible){BX.removeClass(this._wrapper,"crm-section-control-active");BX.unbind(document,"keydown",this._keyPressHandler)}else{BX.addClass(this._wrapper,"crm-section-control-active");BX.bind(document,"keydown",this._keyPressHandler)}},getPosition:function(){return this._hasLayout?BX.pos(this._wrapper):null}};BX.UI.EntityEditorToolPanel.prototype.onSaveButtonClick=function(t){if(!this._isLocked){this._editor.saveChanged()}};BX.UI.EntityEditorToolPanel.prototype.onCancelButtonClick=function(t){if(!this._isLocked){this._editor.cancel()}return BX.eventReturnFalse(t)};BX.UI.EntityEditorToolPanel.prototype.onKeyPress=function(t){if(!this._isVisible){return}if(BX.type.isFunction(BX.PopupWindowManager.isAnyPopupShown)&&BX.PopupWindowManager.isAnyPopupShown()){return}t=t||window.event;if(t.keyCode==27){this._editor.cancel();BX.eventCancelBubble(t)}else if(t.keyCode==13&&t.ctrlKey){this._editor.saveChanged();BX.eventCancelBubble(t)}};BX.UI.EntityEditorToolPanel.prototype.addError=function(t){this._errorContainer.appendChild(BX.create("DIV",{attrs:{className:"ui-entity-section-control-error-text"},html:t}));this._errorContainer.style.maxHeight=""};BX.UI.EntityEditorToolPanel.prototype.clearErrors=function(){this._errorContainer.innerHTML="";this._errorContainer.style.maxHeight="0"};BX.UI.EntityEditorToolPanel.prototype.getMessage=function(t){var e=BX.UI.EntityEditorToolPanel.messages;return e.hasOwnProperty(t)?e[t]:t};if(typeof BX.UI.EntityEditorToolPanel.messages==="undefined"){BX.UI.EntityEditorToolPanel.messages={}}BX.UI.EntityEditorToolPanel.create=function(t,e){var i=new BX.UI.EntityEditorToolPanel;i.initialize(t,e);return i}}
//# sourceMappingURL=tool-panel.map.js