BX.namespace("BX.UI");if(typeof BX.UI.EntityEditorFieldSelector==="undefined"){BX.UI.EntityEditorFieldSelector=function(){this._id="";this._settings={};this._scheme=null;this._excludedNames=null;this._emitter=null;this._contentWrapper=null;this._popup=null};BX.UI.EntityEditorFieldSelector.prototype={initialize:function(e,t){this._id=e;this._settings=t?t:{};this._scheme=BX.prop.get(this._settings,"scheme",null);if(!this._scheme){throw"BX.UI.EntityEditorFieldSelector. Parameter 'scheme' is not found."}this._excludedNames=BX.prop.getArray(this._settings,"excludedNames",[]);this._emitter=new BX.Event.EventEmitter},getMessage:function(e){return BX.prop.getString(BX.UI.EntityEditorFieldSelector.messages,e,e)},isSchemeElementEnabled:function(e){var t=e.getName();for(var i=0,n=this._excludedNames.length;i<n;i++){if(this._excludedNames[i]===t){return false}}return true},addClosingListener:function(e){this._emitter.subscribe("BX.UI.EntityEditorFieldSelector:close",e)},removeClosingListener:function(e){this._emitter.unsubscribe("BX.UI.EntityEditorFieldSelector:close",e)},isOpened:function(){return this._popup&&this._popup.isShown()},open:function(){if(this.isOpened()){return}this._popup=new BX.PopupWindow(this._id,null,{autoHide:false,draggable:true,bindOptions:{forceBindPosition:false},closeByEsc:true,closeIcon:{},zIndex:1,titleBar:BX.prop.getString(this._settings,"title",""),events:{onPopupClose:BX.delegate(this._onPopupClose,this),onPopupDestroy:BX.delegate(this._onPopupDestroy,this)},content:this.prepareContent(),lightShadow:true,contentNoPaddings:true,buttons:[new BX.PopupWindowButton({text:BX.message("UI_ENTITY_EDITOR_SELECT"),className:"ui-btn ui-btn-success",events:{click:BX.delegate(this.onAcceptButtonClick,this)}}),new BX.PopupWindowButtonLink({text:BX.message("UI_ENTITY_EDITOR_CANCEL"),className:"ui-btn ui-btn-link",events:{click:BX.delegate(this.onCancelButtonClick,this)}})]});this._popup.show()},close:function(){if(!(this._popup&&this._popup.isShown())){return}this._popup.close()},prepareContent:function(){this._contentWrapper=BX.create("div",{props:{className:"ui-entity-editor-popup-field-selector"}});var e=BX.create("div",{props:{className:"ui-entity-editor-popup-field-selector-list"}});var t=this._scheme.getElements();for(var i=0,n=t.length;i<n;i++){var s=t[i];if(!this.isSchemeElementEnabled(s)){continue}var o=[];var r=s.getElements();var l;for(var p=0;p<r.length;p++){l=r[p];if(l.isTransferable()&&l.getName()!==""){o.push(l)}}if(o.length===0){continue}var c=s.getName();var a=s.getTitle();this._contentWrapper.appendChild(BX.create("div",{attrs:{className:"ui-entity-editor-popup-field-selector-list-caption"},text:a}));for(var u=0;u<o.length;u++){l=o[u];var d=l.getName();var h=l.getTitle();var f=c+"\\"+d;var m=BX.create("div",{attrs:{className:"ui-entity-editor-popup-field-selector-list-item"}});e.appendChild(m);m.appendChild(BX.create("input",{attrs:{id:f,type:"checkbox",className:"ui-entity-editor-popup-field-selector-list-checkbox"}}));m.appendChild(BX.create("label",{attrs:{for:f,className:"ui-entity-editor-popup-field-selector-list-label"},text:h}))}}this._contentWrapper.appendChild(e);return this._contentWrapper},getSelectedItems:function(){if(!this._contentWrapper){return[]}var e=[];var t=this._contentWrapper.querySelectorAll("input.ui-entity-editor-popup-field-selector-list-checkbox");for(var i=0,n=t.length;i<n;i++){var s=t[i];if(s.checked){var o=s.id.split("\\");if(o.length>=2){e.push({sectionName:o[0],fieldName:o[1]})}}}return e},onAcceptButtonClick:function(){this._emitter.emit("BX.UI.EntityEditorFieldSelector:close",{sender:this,isCanceled:false,items:this.getSelectedItems()});this.close()},onCancelButtonClick:function(){this._emitter.emit("BX.UI.EntityEditorFieldSelector:close",{sender:this,isCanceled:true});this.close()},onPopupClose:function(){if(this._popup){this._contentWrapper=null;this._popup.destroy()}},onPopupDestroy:function(){if(!this._popup){return}this._contentWrapper=null;this._popup=null}};if(typeof BX.UI.EntityEditorFieldSelector.messages==="undefined"){BX.UI.EntityEditorFieldSelector.messages={}}BX.UI.EntityEditorFieldSelector.create=function(e,t){var i=new BX.UI.EntityEditorFieldSelector(e,t);i.initialize(e,t);return i}}
//# sourceMappingURL=field-selector.map.js