{"version":3,"file":"ui.switcher.bundle.js","sources":["../src/ui.switcher.js"],"sourcesContent":["import {Type, Tag, Loc, Dom, bind, onCustomEvent} from 'main.core';\nimport 'ui.design-tokens';\n\nexport const SwitcherSize = Object.freeze({\n\tmedium: 'medium',\n\tsmall: 'small',\n});\n\nexport const SwitcherColor = Object.freeze({\n\tprimary: 'primary',\n\tgreen: 'green',\n});\n\nexport type SwitcherOptions = {\n\tattributeName: string;\n\tnode: HTMLElement;\n\tid: string;\n\tchecked: boolean;\n\tinputName: string;\n\thandlers: Object;\n\tsize: string;\n\tcolor: string;\n}\n\nexport class Switcher {\n\t#classNameSize = {\n\t\t[SwitcherSize.small]: 'ui-switcher-size-sm',\n\t\t[SwitcherSize.medium]: '',\n\t}\n\t#classNameColor = {\n\t\t[SwitcherColor.primary]: '',\n\t\t[SwitcherColor.green]: 'ui-switcher-color-green',\n\t}\n\n\tnode: HTMLElement | null = null;\n\tid: string = '';\n\t#checked: boolean = false;\n\t#inputName: string = '';\n\t#loading: boolean;\n\tevents: Object;\n\t#classNameOff: string = 'ui-switcher-off';\n\t#attributeName: string = 'data-switcher';\n\n\tstatic #attributeInitName: string = 'data-switcher-init';\n\tstatic list = [];\n\tstatic className = 'ui-switcher';\n\n\t/**\n\t * Switcher.\n\t *\n\t * @param {object} [options] - Options.\n\t * @param {string} [options.attributeName] - Name of switcher attribute.\n\t * @param {Element} [options.node] - Node.\n\t * @param {string} [options.id] - ID.\n\t * @param {123} [options.checked] - Checked.\n\t * @param {string} [options.inputName] - Input name.\n\t * @constructor\n\t */\n\tconstructor(options: SwitcherOptions)\n\t{\n\t\tthis.init(options);\n\t\tSwitcher.list.push(this);\n\t}\n\n\tstatic getById(id: string | number): Switcher | null\n\t{\n\t\treturn Switcher.list.find((item) => item.id === id) || null;\n\t}\n\n\tstatic initByClassName(): void\n\t{\n\t\tconst nodes = document.getElementsByClassName(Switcher.className);\n\t\tArray.from(nodes).forEach(function (node) {\n\t\t\tif (node.getAttribute(Switcher.#attributeInitName))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tnew Switcher({node: node});\n\t\t});\n\t}\n\n\tstatic getList(): Switcher[]\n\t{\n\t\treturn Switcher.list;\n\t}\n\n\tinit(options: SwitcherOptions = {}): void\n\t{\n\t\tthis.#attributeName = Type.isString(options.attributeName) ? options.attributeName : this.#attributeName;\n\t\tthis.handlers = Type.isPlainObject(options.handlers) ? options.handlers : {};\n\t\tthis.#inputName = Type.isString(options.inputName) ? options.inputName : '';\n\t\tthis.#loading = false;\n\t\tthis.events = {\n\t\t\ttoggled: 'toggled',\n\t\t\tchecked: 'checked',\n\t\t\tunchecked: 'unchecked'\n\t\t};\n\n\t\tif (options.node)\n\t\t{\n\t\t\tif (!Type.isDomNode(options.node))\n\t\t\t{\n\t\t\t\tthrow new Error('Parameter `node` DOM Node expected.');\n\t\t\t}\n\n\t\t\tthis.node = options.node;\n\t\t\tlet data = this.node.getAttribute(this.#attributeName);\n\t\t\ttry\n\t\t\t{\n\t\t\t\tdata = JSON.parse(data) || {};\n\t\t\t}\n\t\t\tcatch (e)\n\t\t\t{\n\t\t\t\tdata = {};\n\t\t\t}\n\n\t\t\tif (data.id)\n\t\t\t{\n\t\t\t\tthis.id = data.id;\n\t\t\t}\n\n\t\t\tthis.#checked = Boolean(data.checked);\n\t\t\tthis.#inputName = data.inputName;\n\t\t\tif(Type.isString(data.color) && Object.values(SwitcherColor).includes(data.color))\n\t\t\t{\n\t\t\t\toptions.color = data.color;\n\t\t\t}\n\t\t\tif(Type.isString(data.size) && Object.values(SwitcherSize).includes(data.size))\n\t\t\t{\n\t\t\t\toptions.size = data.size;\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.node = document.createElement('span');\n\t\t}\n\n\t\tif (this.#classNameSize[options.size])\n\t\t{\n\t\t\tDom.addClass(this.node, this.#classNameSize[options.size]);\n\t\t}\n\t\tif (this.#classNameColor[options.color])\n\t\t{\n\t\t\tDom.addClass(this.node, this.#classNameColor[options.color]);\n\t\t}\n\n\t\tif (Type.isString(options.id) || Type.isNumber(options.id))\n\t\t{\n\t\t\tthis.id = options.id;\n\t\t}\n\t\telse if (!this.id)\n\t\t{\n\t\t\tthis.id = Math.random();\n\t\t}\n\n\t\tif (Type.isString(options.inputName))\n\t\t{\n\t\t\tthis.#inputName = options.inputName;\n\t\t}\n\t\tthis.#checked = Type.isBoolean(options.checked) ? options.checked : this.#checked;\n\n\t\tthis.#initNode();\n\t\tthis.check(this.#checked, false);\n\t}\n\n\t#initNode(): void\n\t{\n\t\tif (this.node.getAttribute(Switcher.#attributeInitName))\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tthis.node.setAttribute(Switcher.#attributeInitName, 'y');\n\n\t\tDom.addClass(this.node, Switcher.className);\n\t\tthis.node.innerHTML =\n\t\t\t'<span class=\"ui-switcher-cursor\"></span>\\n' +\n\t\t\t'<span class=\"ui-switcher-enabled\">' + Loc.getMessage('UI_SWITCHER_ON') + '</span>\\n' +\n\t\t\t'<span class=\"ui-switcher-disabled\">' + Loc.getMessage('UI_SWITCHER_OFF') + '</span>\\n';\n\n\t\tif (this.#inputName)\n\t\t{\n\t\t\tthis.inputNode = Tag.render`\n\t\t\t\t<input type=\"hidden\" name=\"${this.#inputName}\" />\n\t\t\t`;\n\n\t\t\tDom.append(this.inputNode, this.node);\n\t\t}\n\n\t\tbind(this.node, 'click', this.toggle.bind(this));\n\t}\n\n\tcheck(checked: boolean, fireEvents: boolean): void\n\t{\n\t\tif (this.isLoading())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#checked = !!checked;\n\t\tif (this.inputNode)\n\t\t{\n\t\t\tthis.inputNode.value = this.#checked ? 'Y' : 'N';\n\t\t}\n\n\t\tfireEvents = fireEvents !== false;\n\n\t\tif (this.#checked)\n\t\t{\n\t\t\tDom.removeClass(this.node, this.#classNameOff);\n\t\t\tfireEvents ? this.#fireEvent(this.events.unchecked) : null;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.addClass(this.node, this.#classNameOff);\n\t\t\tfireEvents ? this.#fireEvent(this.events.checked) : null;\n\t\t}\n\n\t\tif (fireEvents)\n\t\t{\n\t\t\tthis.#fireEvent(this.events.toggled)\n\t\t}\n\t}\n\n\tisChecked(): boolean\n\t{\n\t\treturn this.#checked;\n\t}\n\n\ttoggle(): void\n\t{\n\t\tthis.check(!this.isChecked());\n\t}\n\n\tsetLoading(mode: boolean): void\n\t{\n\t\tthis.#loading = Boolean(mode);\n\n\t\tconst cursor = this.getNode().querySelector('.ui-switcher-cursor');\n\n\t\tif (this.#loading)\n\t\t{\n\t\t\tconst svg = Tag.render`\n\t\t\t\t<svg viewBox=\"25 25 50 50\">\n\t\t\t\t\t<circle\n\t\t\t\t\t\tclass=\"ui-sidepanel-wrapper-loader-path\"\n\t\t\t\t\t\tcx=\"50\"\n\t\t\t\t\t\tcy=\"50\"\n\t\t\t\t\t\tr=\"19\"\n\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\tstroke-width=\"5\"\n\t\t\t\t\t\tstroke-miterlimit=\"10\"\n\t\t\t\t\t>\n\t\t\t\t\t</circle>\n\t\t\t\t</svg>\n\t\t\t`\n\t\t\tDom.append(svg, cursor);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tcursor.innerHTML = '';\n\t\t}\n\t}\n\n\tisLoading(): boolean\n\t{\n\t\treturn this.#loading;\n\t}\n\n\t#fireEvent(eventName: string): void\n\t{\n\t\tonCustomEvent(this, eventName);\n\t\tif (this.handlers[eventName])\n\t\t{\n\t\t\tthis.handlers[eventName].call(this);\n\t\t}\n\t}\n\n\trenderTo(targetNode: HTMLElement): HTMLElement\n\t{\n\t\tif (!Type.isDomNode(targetNode))\n\t\t{\n\t\t\tthrow new Error('Target node must be HTMLElement');\n\t\t}\n\n\t\treturn Dom.append(this.getNode(), targetNode);\n\t}\n\n\tgetNode(): HTMLElement\n\t{\n\t\treturn this.node;\n\t}\n\n\tgetAttributeName(): string\n\t{\n\t\treturn this.#attributeName;\n\t}\n\n\tgetInputName(): string\n\t{\n\t\treturn this.#inputName;\n\t}\n}"],"names":["SwitcherSize","Object","freeze","medium","small","SwitcherColor","primary","green","Switcher","options","init","list","push","Type","isString","attributeName","handlers","isPlainObject","inputName","events","toggled","checked","unchecked","node","isDomNode","Error","data","getAttribute","JSON","parse","e","id","Boolean","color","values","includes","size","document","createElement","Dom","addClass","isNumber","Math","random","isBoolean","check","fireEvents","isLoading","inputNode","value","removeClass","isChecked","mode","cursor","getNode","querySelector","svg","Tag","render","append","innerHTML","targetNode","find","item","nodes","getElementsByClassName","className","Array","from","forEach","setAttribute","Loc","getMessage","bind","toggle","eventName","onCustomEvent","call"],"mappings":"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"}