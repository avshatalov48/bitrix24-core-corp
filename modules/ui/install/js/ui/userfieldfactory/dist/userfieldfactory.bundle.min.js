this.BX=this.BX||{};this.BX.UI=this.BX.UI||{};(function(e,t,i,n){"use strict";var s=20;var a=Object.freeze({string:"string",enumeration:"enumeration",date:"date",datetime:"datetime",address:"address",url:"url",file:"file",money:"money",boolean:"boolean",double:"double",employee:"employee",crm:"crm",crmStatus:"crm_status"});var r=Object.freeze({string:{title:n.Loc.getMessage("UI_USERFIELD_FACTORY_UF_STRING_TITLE"),description:n.Loc.getMessage("UI_USERFIELD_FACTORY_UF_STRING_LEGEND"),defaultTitle:n.Loc.getMessage("UI_USERFIELD_FACTORY_UF_STRING_LABEL")},enumeration:{title:n.Loc.getMessage("UI_USERFIELD_FACTORY_UF_ENUM_TITLE"),description:n.Loc.getMessage("UI_USERFIELD_FACTORY_UF_ENUM_LEGEND"),defaultTitle:n.Loc.getMessage("UI_USERFIELD_FACTORY_UF_ENUMERATION_LABEL")},datetime:{title:n.Loc.getMessage("UI_USERFIELD_FACTORY_UF_DATETIME_TITLE"),description:n.Loc.getMessage("UI_USERFIELD_FACTORY_UF_DATETIME_LEGEND"),defaultTitle:n.Loc.getMessage("UI_USERFIELD_FACTORY_UF_DATETIME_LABEL")},address:{title:n.Loc.getMessage("UI_USERFIELD_FACTORY_UF_ADDRESS_TITLE"),description:n.Loc.getMessage("UI_USERFIELD_FACTORY_UF_ADDRESS_LEGEND")},url:{title:n.Loc.getMessage("UI_USERFIELD_FACTORY_UF_URL_TITLE"),description:n.Loc.getMessage("UI_USERFIELD_FACTORY_UF_URL_LEGEND")},file:{title:n.Loc.getMessage("UI_USERFIELD_FACTORY_UF_FILE_TITLE"),description:n.Loc.getMessage("UI_USERFIELD_FACTORY_UF_FILE_LEGEND"),defaultTitle:n.Loc.getMessage("UI_USERFIELD_FACTORY_UF_FILE_LABEL")},money:{title:n.Loc.getMessage("UI_USERFIELD_FACTORY_UF_MONEY_TITLE"),description:n.Loc.getMessage("UI_USERFIELD_FACTORY_UF_MONEY_LEGEND"),defaultTitle:n.Loc.getMessage("UI_USERFIELD_FACTORY_UF_MONEY_LABEL")},boolean:{title:n.Loc.getMessage("UI_USERFIELD_FACTORY_BOOLEAN_TITLE"),description:n.Loc.getMessage("UI_USERFIELD_FACTORY_UF_BOOLEAN_LEGEND")},double:{title:n.Loc.getMessage("UI_USERFIELD_FACTORY_UF_DOUBLE_TITLE"),description:n.Loc.getMessage("UI_USERFIELD_FACTORY_UF_DOUBLE_LEGEND"),defaultTitle:n.Loc.getMessage("UI_USERFIELD_FACTORY_UF_DOUBLE_LABEL")},employee:{title:n.Loc.getMessage("UI_USERFIELD_FACTORY_UF_EMPLOYEE_TITLE"),description:n.Loc.getMessage("UI_USERFIELD_FACTORY_UF_EMPLOYEE_LEGEND")}});var o=Object.freeze({MULTIPLE:"N",MANDATORY:"N",USER_TYPE_ID:a.string,SHOW_FILTER:"E",SHOW_IN_LIST:"Y",SETTINGS:{},IS_SEARCHABLE:"N"});var l=Object.freeze({file:{SHOW_FILTER:"N",SHOW_IN_LIST:"N"},employee:{SHOW_FILTER:"I"},crm:{SHOW_FILTER:"I"},crm_status:{SHOW_FILTER:"I"},enumeration:{SETTINGS:{DISPLAY:"UI"}},double:{SETTINGS:{PRECISION:2}}});function u(){var e=babelHelpers.taggedTemplateLiteral(['<div class="ui-userfieldfactory-creation-menu-item" onclick="','">\n\t\t\t<div class="ui-userfieldfactory-creation-menu-item-title">','</div>\n\t\t\t<div class="ui-userfieldfactory-creation-menu-item-desc">',"</div>\n\t\t</div>"]);u=function t(){return e};return e}function c(){var e=babelHelpers.taggedTemplateLiteral(['<div class="ui-userfieldfactory-creation-menu-list"></div>']);c=function t(){return e};return e}function d(){var e=babelHelpers.taggedTemplateLiteral(['<div class="ui-userfieldfactory-creation-menu-scroll-bottom">',"</div>"]);d=function t(){return e};return e}function f(){var e=babelHelpers.taggedTemplateLiteral(['<div class="ui-userfieldfactory-creation-menu-scroll-top">',"</div>"]);f=function t(){return e};return e}function h(){var e=babelHelpers.taggedTemplateLiteral(['<div class="ui-userfieldfactory-creation-menu-container"></div>']);h=function t(){return e};return e}var p=function(){function e(t,i,s){babelHelpers.classCallCheck(this,e);this.id=t;this.items=i;this.params={};if(n.Type.isPlainObject(s)){this.params=s}}babelHelpers.createClass(e,[{key:"getId",value:function e(){if(!this.id){return"ui-user-field-factory-menu"}return this.id}},{key:"getPopup",value:function t(){var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;if(!this.popup){var s=babelHelpers.objectSpread({},e.getDefaultPopupOptions(),this.params);s.events={onPopupShow:this.onPopupShow.bind(this),onPopupDestroy:this.onPopupDestroy.bind(this)};s.id=this.getId();this.popup=new i.Popup(s)}this.popup.setContent(this.render(n));return this.popup}},{key:"open",value:function e(t){var i=this.getPopup(t);if(!i.isShown()){i.show()}}},{key:"render",value:function e(t){if(!this.container){this.container=n.Tag.render(h());var i='<svg xmlns="http://www.w3.org/2000/svg" width="42" height="13" viewBox="0 0 42 13">\n'+'  <polyline fill="none" stroke="#CACDD1" stroke-width="2" points="274 98 284 78.614 274 59" transform="rotate(90 186 -86.5)" stroke-linecap="round" stroke-linejoin="round"/>\n'+"</svg>\n";this.topScrollButton=n.Tag.render(f(),i);this.bottomScrollButton=n.Tag.render(d(),i);this.container.appendChild(this.topScrollButton);this.container.appendChild(this.bottomScrollButton);this.container.appendChild(this.renderList(t))}return this.container}},{key:"renderList",value:function e(t){var i=this;if(!this.containerList){this.containerList=n.Tag.render(c());this.items.forEach(function(e){i.containerList.appendChild(i.renderItem(e,t))})}return this.containerList}},{key:"renderItem",value:function e(t,i){var s=this;return n.Tag.render(u(),function(){s.onItemClick(t,i)},t.title,t.description)}},{key:"onItemClick",value:function e(t,i){if(n.Type.isFunction(i)){i(t.name)}this.getPopup().close()}},{key:"onPopupShow",value:function e(){n.Event.bind(this.bottomScrollButton,"mouseover",this.onBottomButtonMouseOver.bind(this));n.Event.bind(this.bottomScrollButton,"mouseout",this.onBottomButtonMouseOut.bind(this));n.Event.bind(this.topScrollButton,"mouseover",this.onTopButtonMouseOver.bind(this));n.Event.bind(this.topScrollButton,"mouseout",this.onTopButtonMouseOut.bind(this));n.Event.bind(this.containerList,"scroll",this.onScroll.bind(this));window.setTimeout(this.adjust.bind(this),100)}},{key:"onPopupDestroy",value:function e(){n.Event.unbind(this.bottomScrollButton,"mouseover",this.onBottomButtonMouseOver.bind(this));n.Event.unbind(this.bottomScrollButton,"mouseout",this.onBottomButtonMouseOut.bind(this));n.Event.unbind(this.topScrollButton,"mouseover",this.onTopButtonMouseOver.bind(this));n.Event.unbind(this.topScrollButton,"mouseout",this.onTopButtonMouseOut.bind(this));n.Event.unbind(this.containerList,"scroll",this.onScroll.bind(this));this.container=null;this.containerList=null;this.topScrollButton=null;this.bottomScrollButton=null;this.popup=null}},{key:"onBottomButtonMouseOver",value:function e(){if(this._enableScrollToBottom){return}this._enableScrollToBottom=true;this._enableScrollToTop=false;(function e(){if(!this._enableScrollToBottom){return}if(this.containerList.scrollTop+this.containerList.offsetHeight!==this.containerList.scrollHeight){this.containerList.scrollTop+=3}if(this.containerList.scrollTop+this.containerList.offsetHeight===this.containerList.scrollHeight){this._enableScrollToBottom=false}else{window.setTimeout(e.bind(this),20)}}).bind(this)()}},{key:"onBottomButtonMouseOut",value:function e(){this._enableScrollToBottom=false}},{key:"onTopButtonMouseOver",value:function e(){if(this._enableScrollToTop){return}this._enableScrollToBottom=false;this._enableScrollToTop=true;(function e(){if(!this._enableScrollToTop){return}if(this.containerList.scrollTop>0){this.containerList.scrollTop-=3}if(this.containerList.scrollTop===0){this._enableScrollToTop=false}else{window.setTimeout(e.bind(this),20)}}).bind(this)()}},{key:"onTopButtonMouseOut",value:function e(){this._enableScrollToTop=false}},{key:"onScroll",value:function e(){this.adjust()}},{key:"adjust",value:function e(){var t=this.containerList.offsetHeight;var i=this.containerList.scrollTop;var n=this.containerList.scrollHeight;if(i===0){this.topScrollButton.classList.add("hidden")}else{this.topScrollButton.classList.remove("hidden")}if(i+t===n){this.bottomScrollButton.classList.add("hidden")}else{this.bottomScrollButton.classList.remove("hidden")}}}],[{key:"getDefaultPopupOptions",value:function e(){return{autoHide:true,draggable:false,offsetLeft:0,offsetTop:0,noAllPaddings:true,bindOptions:{forceBindPosition:true},closeByEsc:true,cacheable:false}}}]);return e}();var g=function(){function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;babelHelpers.classCallCheck(this,e);this.value=t}babelHelpers.createClass(e,[{key:"setNode",value:function e(t){this.node=t}},{key:"getNode",value:function e(){return this.node}},{key:"getInput",value:function e(){var t=this.getNode();if(!t){return null}if(t instanceof HTMLInputElement){return t}return t.querySelector("input")}},{key:"getValue",value:function e(){var t=this.getInput();if(t&&t.value){return t.value}return this.value||""}}]);return e}();var E=function(){function e(t){babelHelpers.classCallCheck(this,e);babelHelpers.defineProperty(this,"saved",false);this.data=t;var i=n.Text.toInteger(t.ID);if(i>0){this.saved=true}}babelHelpers.createClass(e,[{key:"setData",value:function e(t){delete t.SIGNATURE;this.data=babelHelpers.objectSpread({},this.data,t);return this}},{key:"getData",value:function e(){return this.data}},{key:"markAsSaved",value:function e(){this.saved=true;return this}},{key:"getName",value:function e(){return this.data.FIELD}},{key:"setName",value:function e(t){if(!this.isSaved()){this.data.FIELD=t}return this}},{key:"getEntityId",value:function e(){return this.data.ENTITY_ID}},{key:"getTypeId",value:function e(){return this.data.USER_TYPE_ID}},{key:"getEnumeration",value:function e(){if(!n.Type.isArray(this.data.ENUM)){this.data.ENUM=[]}return this.data.ENUM}},{key:"saveEnumeration",value:function e(t){var i=this;this.data.ENUM=[];var n=100;t.forEach(function(e){i.data.ENUM.push({VALUE:e.getValue(),SORT:n});n+=100})}},{key:"getTitle",value:function t(){var i=e.getTitleFields();var s=i.length;for(var a=0;a<s;a++){if(n.Type.isString(this.data[i[a]])&&this.data[i[a]].length>0){return this.data[i[a]]}}return this.getName()}},{key:"setTitle",value:function t(i){var s=this;if(n.Type.isString(i)&&i.length>0){e.getTitleFields().forEach(function(e){s.data[e]=i});if(this.getTypeId()===a.boolean){this.data.SETTINGS.LABEL_CHECKBOX=i}}}},{key:"isSaved",value:function e(){return this.saved}},{key:"isMultiple",value:function e(){return this.data.MULTIPLE==="Y"}},{key:"setIsMultiple",value:function e(t){if(!this.isSaved()){this.data.MULTIPLE=n.Text.toBoolean(t)===true?"Y":"N"}}},{key:"isDateField",value:function e(){return this.getTypeId()===a.datetime||this.getTypeId()===a.date}},{key:"isShowTime",value:function e(){return this.getTypeId()===a.datetime}},{key:"setIsShowTime",value:function e(t){if(!this.isSaved()){t=n.Text.toBoolean(t);if(t){this.data.USER_TYPE_ID=a.datetime}else{this.data.USER_TYPE_ID=a.date}}}},{key:"isSearchable",value:function e(){return this.data.IS_SEARCHABLE==="Y"}},{key:"setIsSearchable",value:function e(t){this.data.IS_SEARCHABLE=n.Text.toBoolean(t)===true?"Y":"N"}}],[{key:"getTitleFields",value:function e(){return Array.from(["EDIT_FORM_LABEL","LIST_COLUMN_LABEL","LIST_FILTER_LABEL"])}}]);return e}();function T(){var e=babelHelpers.taggedTemplateLiteral(['<div>\n\t\t\t\t<label class="ui-ctl ui-ctl-checkbox ui-ctl-xs">\n\t\t\t\t\t','\n\t\t\t\t\t<div class="ui-ctl-label-text">',"</div>\n\t\t\t\t</label>\n\t\t\t</div>"]);T=function t(){return e};return e}function v(){var e=babelHelpers.taggedTemplateLiteral(['<input class="ui-ctl-element" type="checkbox">']);v=function t(){return e};return e}function L(){var e=babelHelpers.taggedTemplateLiteral(['<div>\n\t\t\t\t<label class="ui-ctl ui-ctl-checkbox ui-ctl-xs">\n\t\t\t\t\t','\n\t\t\t\t\t<div class="ui-ctl-label-text">',"</div>\n\t\t\t\t</label>\n\t\t\t</div>"]);L=function t(){return e};return e}function m(){var e=babelHelpers.taggedTemplateLiteral(['<input class="ui-ctl-element" type="checkbox">']);m=function t(){return e};return e}function _(){var e=babelHelpers.taggedTemplateLiteral(['<div class="ui-userfieldfactory-configurator-block"></div>']);_=function t(){return e};return e}function b(){var e=babelHelpers.taggedTemplateLiteral(['<div style="margin-bottom: 10px;" class="ui-ctl ui-ctl-textbox ui-ctl-w100 ui-ctl-row">\n\t\t\t<input class="ui-ctl-element" type="text" value="','">\n\t\t\t<div class="ui-userfieldfactory-configurator-remove-enum" onclick="','"></div>\n\t\t</div>']);b=function t(){return e};return e}function I(){var e=babelHelpers.taggedTemplateLiteral(['<div class="ui-userfieldfactory-configurator-block">\n\t\t\t<div class="ui-userfieldfactory-configurator-title">\n\t\t\t\t<span class="ui-userfieldfactory-configurator-title-text">',"</span>\n\t\t\t</div>\n\t\t\t","\n\t\t\t","\n\t\t</div>"]);I=function t(){return e};return e}function y(){var e=babelHelpers.taggedTemplateLiteral(['<div class="ui-userfieldfactory-configurator-block-add-field">\n\t\t\t<span class="ui-userfieldfactory-configurator-add-button" onclick="','">',"</span>\n\t\t</div>"]);y=function t(){return e};return e}function F(){var e=babelHelpers.taggedTemplateLiteral(['<div class="ui-userfieldfactory-configurator-block"></div>']);F=function t(){return e};return e}function S(){var e=babelHelpers.taggedTemplateLiteral(['<div class="ui-userfieldfactory-configurator-block">\n\t\t\t',"","\n\t\t</div>"]);S=function t(){return e};return e}function U(){var e=babelHelpers.taggedTemplateLiteral(['<span class="ui-btn ui-btn-light-border" onclick="','">',"</span>"]);U=function t(){return e};return e}function R(){var e=babelHelpers.taggedTemplateLiteral(['<span class="ui-btn ui-btn-primary" onclick="','">',"</span>"]);R=function t(){return e};return e}function C(){var e=babelHelpers.taggedTemplateLiteral(['<div class="ui-userfieldfactory-configurator-block">\n\t\t\t<div class="ui-userfieldfactory-configurator-title">\n\t\t\t\t<span class="ui-userfieldfactory-configurator-title-text">','</span>\n\t\t\t</div>\n\t\t\t<div class="ui-userfieldfactory-configurator-content">\n\t\t\t\t<div class="ui-ctl ui-ctl-textbox ui-ctl-w100">\n\t\t\t\t\t',"\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>"]);C=function t(){return e};return e}function D(){var e=babelHelpers.taggedTemplateLiteral(['<input class="ui-ctl-element" type="text" value="','" />']);D=function t(){return e};return e}function k(){var e=babelHelpers.taggedTemplateLiteral(['<div class="ui-userfieldfactory-configurator"></div>']);k=function t(){return e};return e}var O=function(){function e(t){babelHelpers.classCallCheck(this,e);if(n.Type.isPlainObject(t)){if(t.field instanceof E){this.field=t.field}if(n.Type.isFunction(t.onSave)){this.onSave=t.onSave}if(n.Type.isFunction(t.onCancel)){this.onCancel=t.onCancel}}this.enumItems=new Set}babelHelpers.createClass(e,[{key:"render",value:function e(){var t=this;this.node=n.Tag.render(k());this.labelInput=n.Tag.render(D(),this.field.getTitle());this.node.appendChild(n.Tag.render(C(),n.Loc.getMessage("UI_USERFIELD_FACTORY_CONFIGURATOR_FIELD_TITLE"),this.labelInput));if(this.field.getTypeId()===a.enumeration){this.node.appendChild(this.renderEnumeration())}this.node.appendChild(this.renderOptions());var i=function e(i){i.preventDefault();if(n.Type.isFunction(t.onSave)){t.onSave(t.saveField())}};var s=function e(i){i.preventDefault();if(n.Type.isFunction(t.onCancel)){t.onCancel()}else{t.node.style.display="none"}};this.saveButton=n.Tag.render(R(),i.bind(this),n.Loc.getMessage("UI_USERFIELD_SAVE"));this.cancelButton=n.Tag.render(U(),s.bind(this),n.Loc.getMessage("UI_USERFIELD_CANCEL"));this.node.appendChild(n.Tag.render(S(),this.saveButton,this.cancelButton));return this.node}},{key:"saveField",value:function e(){if(this.timeCheckbox){this.field.setIsShowTime(this.timeCheckbox.checked)}if(this.multipleCheckbox){this.field.setIsMultiple(this.multipleCheckbox.checked)}this.field.setTitle(this.labelInput.value);this.field.saveEnumeration(this.enumItems);return this.field}},{key:"renderEnumeration",value:function e(){var t=this;this.enumItemsContainer=n.Tag.render(F());this.enumAddItemContainer=n.Tag.render(y(),function(){t.addEnumInput().focus()},n.Loc.getMessage("UI_USERFIELD_ADD"));this.enumContainer=n.Tag.render(I(),n.Loc.getMessage("UI_USERFIELD_FACTORY_UF_ENUM_ITEMS"),this.enumItemsContainer,this.enumAddItemContainer);this.field.getEnumeration().forEach(function(e){t.addEnumInput(e)});this.addEnumInput();return this.enumContainer}},{key:"addEnumInput",value:function e(){var t=this;var i=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;if(!(i instanceof g)){if(n.Type.isPlainObject(i)){i=new g(i.VALUE)}else{i=new g}}var s=n.Tag.render(b(),i.getValue(),function(e){e.preventDefault();t.deleteEnumItem(i)});i.setNode(s);this.enumItems.add(i);this.enumItemsContainer.appendChild(s);return s}},{key:"deleteEnumItem",value:function e(t){this.enumItemsContainer.removeChild(t.getNode());this.enumItems.delete(t)}},{key:"renderOptions",value:function e(){this.optionsContainer=n.Tag.render(_());if(!this.field.isSaved()&&this.field.isDateField()){this.timeCheckbox=n.Tag.render(m());this.timeCheckbox.checked=this.field.isShowTime();this.optionsContainer.appendChild(n.Tag.render(L(),this.timeCheckbox,n.Loc.getMessage("UI_USERFIELD_FACTORY_UF_ENABLE_TIME")))}if(!this.field.isSaved()&&this.field.getTypeId()!==a.boolean){this.multipleCheckbox=n.Tag.render(v());this.multipleCheckbox.checked=this.field.isMultiple();this.optionsContainer.appendChild(n.Tag.render(T(),this.multipleCheckbox,n.Loc.getMessage("UI_USERFIELD_FACTORY_FIELD_MULTIPLE")))}return this.optionsContainer}}]);return e}();var M=function(){function e(i){var s=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};babelHelpers.classCallCheck(this,e);t.EventEmitter.makeObservable(this,"UI.UserFieldFactory.Factory");this.configuratorClass=O;if(n.Type.isString(i)&&i.length>0){this.entityId=i}if(n.Type.isPlainObject(s)){if(n.Type.isString(s.creationSignature)){this.creationSignature=s.creationSignature}if(n.Type.isString(s.menuId)){this.menuId=s.menuId}if(!n.Type.isArray(s.types)){s.types=[]}if(n.Type.isDomNode(s.bindElement)){this.bindElement=s.bindElement}this.setConfiguratorClass(s.configuratorClass)}else{s.types=[]}this.types=this.getFieldTypes().concat(s.types)}babelHelpers.createClass(e,[{key:"getFieldTypes",value:function e(){var t=[];Object.keys(r).forEach(function(e){t.push(babelHelpers.objectSpread({},r[e],{name:e}))});this.emit("OnGetUserTypes",{types:t});return t}},{key:"getMenu",value:function e(t){if(!n.Type.isPlainObject(t)){t={}}if(!n.Type.isDomNode(t.bindElement)){t.bindElement=this.bindElement}if(!this.menu){this.menu=new p(this.menuId,this.types,t)}return this.menu}},{key:"setConfiguratorClass",value:function e(t){var i=null;if(n.Type.isString(t)){i=n.Reflection.getClass(t)}else if(n.Type.isFunction(t)){i=t}if(n.Type.isFunction(i)&&i.prototype instanceof O){this.configuratorClass=i}}},{key:"getConfigurator",value:function e(t){return new this.configuratorClass(t)}},{key:"createField",value:function e(t,i){var a=babelHelpers.objectSpread({},o,l[t],{USER_TYPE_ID:t});if(!n.Type.isString(i)||i.length<=0||i.length>s){i=this.generateFieldName()}a.FIELD=i;a.ENTITY_ID=this.entityId;a.SIGNATURE=this.creationSignature;var r=new E(a);r.setTitle(this.getDefaultLabel(t));this.emit("onCreateField",{field:r});return r}},{key:"getDefaultLabel",value:function e(t){var i=n.Loc.getMessage("UI_USERFIELD_FACTORY_UF_LABEL");this.types.forEach(function(e){if(e.name===t&&n.Type.isString(e.defaultTitle)){i=e.defaultTitle}});return i}},{key:"generateFieldName",value:function e(){var t="UF_"+(this.entityId?this.entityId+"_":"");var i=(new Date).getTime().toString();if(t.length+i.length>s){i=i.substr(t.length+i.length-s)}t+=i;return t}},{key:"saveField",value:function e(t){var i=this;return new Promise(function(e,n){if(t instanceof E){if(t.isSaved()){i.getEditManager().update({FIELDS:[t.getData()]},function(s){i.onFieldSave(t,s,e,n)})}else{i.getEditManager().add({FIELDS:[t.getData()]},function(s){i.onFieldSave(t,s,e,n)})}}else{n(["Wrong parameter: field must be instance of Field"])}})}},{key:"deleteField",value:function e(t){var i=this;return new Promise(function(e,n){if(t instanceof E){if(t.isSaved()){i.getEditManager().delete({FIELDS:[t.getData()]},function(s){i.onFieldDelete(t,s,e,n)})}}else{n(["Wrong parameter: field must be instance of Field"])}})}},{key:"onFieldSave",value:function e(t,i,s,a){if(n.Type.isPlainObject(i)){if(i.ERROR&&n.Type.isArray(i.ERROR)&&i.ERROR.length>0){a(i.ERROR)}else{var r=this.getFieldDataFromResponse(i);if(r){t.markAsSaved().setData(r);if(n.Type.isFunction(s)){s(t)}this.emit("onFieldSave",{field:t})}}}else{if(n.Type.isFunction(a)){if(n.Type.isArray(this.managerErrors)&&this.managerErrors.length>0){a(this.managerErrors);this.managerErrors=[]}else{a([n.Loc.getMessage("UI_USERFIELD_SAVE_ERROR")])}}}}},{key:"onFieldDelete",value:function e(t,i,s,a){if(n.Type.isPlainObject(i)||n.Type.isArray(i)){if(n.Type.isPlainObject(i)&&i.ERROR&&n.Type.isArray(i.ERROR)&&i.ERROR.length>0){a(i.ERROR)}else{if(n.Type.isFunction(s)){s(t)}this.emit("onFieldDelete",{field:t})}}else{if(n.Type.isFunction(a)){if(n.Type.isArray(this.managerErrors)&&this.managerErrors.length>0){a(this.managerErrors);this.managerErrors=[]}else{a([n.Loc.getMessage("UI_USERFIELD_DELETE_ERROR")])}}}}},{key:"getFieldDataFromResponse",value:function e(t){if(n.Type.isPlainObject(t)){var i=null;Object.keys(t).forEach(function(e){if(n.Type.isPlainObject(t[e]["FIELD"])){i=t[e]["FIELD"]}});return i}return null}},{key:"getEditManager",value:function e(){var t=this;if(!this.editManager){this.editManager=BX.Main.UF.EditManager;this.editManager.displayError=function(e){t.managerErrors=e}}return this.editManager}}]);return e}();e.Factory=M;e.FieldTypes=a;e.Field=E;e.Configurator=O})(this.BX.UI.UserFieldFactory=this.BX.UI.UserFieldFactory||{},BX.Event,BX.Main,BX);
//# sourceMappingURL=userfieldfactory.bundle.map.js