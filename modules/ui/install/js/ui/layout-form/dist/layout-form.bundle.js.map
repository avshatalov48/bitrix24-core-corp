{"version":3,"file":"layout-form.bundle.js","sources":["../src/layout-form.js"],"sourcesContent":["import {Event, Dom} from \"main.core\";\nimport 'ui.design-tokens';\nimport 'ui.forms';\nimport {EventEmitter} from 'main.core.events';\nimport './css/style.css';\n\ntype LayoutOptions = {\n\tcontainer?: HTMLElement\n}\n\nexport class LayoutForm extends EventEmitter\n{\n\tstatic HIDDEN_ATTRIBUTE = 'data-form-row-hidden';\n\tstatic SHOW_CLASS = 'ui-form-row-hidden-show';\n\tstatic CHECKBOX_SELECTOR = '.ui-ctl-element[type=\"checkbox\"]';\n\n\tparams: LayoutOptions;\n\tcontainer: HTMLElement;\n\tnodes: [HTMLElement];\n\n\tconstructor(params: ?LayoutOptions)\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.UI.LayoutForm');\n\n\t\tthis.params = params ?? {};\n\t\tthis.container = this.params.container ?? document.documentElement;\n\n\t\tthis.nodes = null;\n\n\t\tthis.init();\n\t}\n\n\tinit(): void\n\t{\n\t\tthis.nodes = [].slice.call(this.container.querySelectorAll('[' + LayoutForm.HIDDEN_ATTRIBUTE + ']'));\n\t\tthis.nodes.forEach(node =>\n\t\t{\n\t\t\tEvent.bind(node, \"click\", event => {\n\t\t\t\tevent.preventDefault();\n\t\t\t\tthis.toggleBLock(node);\n\t\t\t\tthis.emit('onToggle', {\n\t\t\t\t\tcheckbox: node.querySelector(LayoutForm.CHECKBOX_SELECTOR),\n\t\t\t\t});\n\t\t\t});\n\t\t\tnode.querySelector(LayoutForm.CHECKBOX_SELECTOR).style.pointerEvents = 'none';\n\t\t\tthis.checkInitialBlockVisibility(node);\n\t\t});\n\t}\n\n\tcheckInitialBlockVisibility(node: HTMLElement): void\n\t{\n\t\tconst checkbox = node.querySelector(LayoutForm.CHECKBOX_SELECTOR);\n\t\tif (checkbox && checkbox.checked)\n\t\t{\n\t\t\tconst content = node.nextElementSibling;\n\t\t\tif (content)\n\t\t\t{\n\t\t\t\tcontent.style.height = 'auto';\n\t\t\t\tDom.addClass(content, LayoutForm.SHOW_CLASS);\n\t\t\t}\n\t\t}\n\t}\n\n\ttoggleBLock(node: HTMLElement): void\n\t{\n\t\tconst checkbox = node.querySelector(LayoutForm.CHECKBOX_SELECTOR);\n\t\tif (checkbox)\n\t\t{\n\t\t\tconst content = node.nextElementSibling;\n\t\t\tif (content)\n\t\t\t{\n\t\t\t\tconst height = content.scrollHeight;\n\t\t\t\tif (height > 0)\n\t\t\t\t{\n\t\t\t\t\tif (!checkbox.checked)\n\t\t\t\t\t{\n\t\t\t\t\t\tcheckbox.checked = true;\n\t\t\t\t\t\tcontent.style.height = height + 'px';\n\t\t\t\t\t\tDom.addClass(content, LayoutForm.SHOW_CLASS);\n\t\t\t\t\t\tconst onTransitionEnd = () =>\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcontent.style.height = 'auto';\n\t\t\t\t\t\t\tEvent.unbind(content, 'transitionend', onTransitionEnd);\n\t\t\t\t\t\t};\n\t\t\t\t\t\tEvent.bind(content, 'transitionend', onTransitionEnd);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tcheckbox.checked = false;\n\t\t\t\t\t\tcontent.style.height = height + 'px';\n\t\t\t\t\t\trequestAnimationFrame(() => {\n\t\t\t\t\t\t\tcontent.style.height = 0;\n\t\t\t\t\t\t\tDom.removeClass(content, LayoutForm.SHOW_CLASS);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n"],"names":["LayoutForm","EventEmitter","constructor","params","setEventNamespace","container","document","documentElement","nodes","init","slice","call","querySelectorAll","HIDDEN_ATTRIBUTE","forEach","node","Event","bind","event","preventDefault","toggleBLock","emit","checkbox","querySelector","CHECKBOX_SELECTOR","style","pointerEvents","checkInitialBlockVisibility","checked","content","nextElementSibling","height","Dom","addClass","SHOW_CLASS","scrollHeight","onTransitionEnd","unbind","requestAnimationFrame","removeClass"],"mappings":"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"}