{"version":3,"file":"accessrights.bundle.js","sources":["../src/grid.js","../src/item/base.js","../src/item/title.js","../src/item/hint.js","../src/item/member.js","../src/item/role.js","../src/item/changer.js","../src/item/toggler.js","../src/item/controller.js","../src/item/variableselector.js","../src/item/usergrouptitle.js","../src/item/multivariable/footer.js","../src/item/multivariable/multiselector.js","../src/columnitem.js","../src/column.js","../src/section.js"],"sourcesContent":["import {BaseEvent, EventEmitter} from \"main.core.events\";\nimport {Dom, Reflection, Type, Tag, Loc, Text} from 'main.core';\nimport {Loader} from \"main.loader\";\nimport Section from \"./section\";\nimport 'ui.notification';\n\nconst BX = Reflection.namespace('BX');\n\ntype GridOptions = {\n\toptions: GridOptions;\n\trenderTo: HTMLElement;\n\tbuttonPanel: BX.UI.ButtonPanel;\n\tcomponent: string;\n\tactionSave: null;\n\tactionDelete: null;\n\tactionLoad: null;\n\tmode: 'string';\n\topenPopupEvent: null;\n\tpopupContainer: null;\n\tadditionalSaveParams: {};\n\tuserGroups: [];\n\taccessRights: [];\n\tloadParams: {};\n};\n\nexport default class Grid {\n\tstatic ACTION_SAVE = 'save';\n\tstatic ACTION_DELETE = 'delete';\n\tstatic ACTION_LOAD = 'load';\n\tstatic MODE = 'ajax';\n\n\tconstructor(options: GridOptions)\n\t{\n\t\toptions = options || {};\n\t\tthis.options = options;\n\t\tthis.renderTo = options.renderTo;\n\t\tthis.buttonPanel = BX.UI.ButtonPanel || null;\n\n\t\tthis.layout = {\n\t\t\tcontainer: null\n\t\t};\n\t\tthis.component = options.component ? options.component : null;\n\t\tthis.actionSave = options.actionSave || Grid.ACTION_SAVE;\n\t\tthis.actionDelete = options.actionDelete || Grid.ACTION_DELETE;\n\t\tthis.actionLoad = options.actionLoad || Grid.ACTION_LOAD;\n\t\tthis.mode = options.mode || Grid.MODE;\n\t\tthis.openPopupEvent = options.openPopupEvent ? options.openPopupEvent : null;\n\t\tthis.popupContainer = options.popupContainer ? options.popupContainer : null;\n\t\tthis.additionalSaveParams = options.additionalSaveParams ? options.additionalSaveParams : null;\n\t\tthis.loadParams = options.loadParams ? options.loadParams : null;\n\t\tthis.loader = null;\n\t\tthis.timer = null;\n\n\t\tthis.initData();\n\t\tif (options.userGroups)\n\t\t{\n\t\t\tthis.userGroups = options.userGroups;\n\t\t}\n\t\tif (options.accessRights)\n\t\t{\n\t\t\tthis.accessRights = options.accessRights;\n\t\t}\n\n\t\tthis.isRequested = false;\n\n\t\tthis.loadData();\n\t\tthis.bindEvents();\n\t}\n\n\tbindEvents(): void\n\t{\n\t\tEventEmitter.subscribe('BX.UI.AccessRights.ColumnItem:updateRole', this.updateRole.bind(this));\n\t\tEventEmitter.subscribe('BX.UI.AccessRights.ColumnItem:selectAccessItems', this.updateAccessVariationRight.bind(this));\n\t\tEventEmitter.subscribe('BX.UI.AccessRights.ColumnItem:accessOn', this.updateAccessRight.bind(this));\n\t\tEventEmitter.subscribe('BX.UI.AccessRights.ColumnItem:accessOff', this.updateAccessRight.bind(this));\n\t\tEventEmitter.subscribe('BX.UI.AccessRights.ColumnItem:update', this.adjustButtonPanel.bind(this));\n\t\tEventEmitter.subscribe('BX.UI.AccessRights.ColumnItem:addRole', this.addUserGroup.bind(this));\n\t\tEventEmitter.subscribe('BX.UI.AccessRights.ColumnItem:addRole', this.addRoleColumn.bind(this));\n\t\tEventEmitter.subscribe('BX.UI.AccessRights.ColumnItem:copyRole', this.addRoleColumn.bind(this));\n\t\tEventEmitter.subscribe('BX.UI.AccessRights.ColumnItem:copyRole', this.addUserGroup.bind(this));\n\t\tEventEmitter.subscribe('BX.UI.AccessRights.ColumnItem:removeRole', this.removeRoleColumn.bind(this));\n\t\tEventEmitter.subscribe('BX.UI.AccessRights.ColumnItem:removeRole', this.adjustButtonPanel.bind(this));\n\t\tEventEmitter.subscribe('BX.Main.SelectorV2:onGetEntityTypes', this.onGetEntityTypes.bind(this));\n\t}\n\n\tinitData(): void\n\t{\n\t\tthis.accessRights = [];\n\t\tthis.userGroups = [];\n\t\tthis.accessRightsSections = [];\n\t\tthis.headSection = null;\n\t\tthis.members = [];\n\t\tthis.columns = [];\n\t}\n\n\tfireEventReset(): void\n\t{\n\t\tEventEmitter.emit('BX.UI.AccessRights:reset', this);\n\t}\n\n\tfireEventRefresh(): void\n\t{\n\t\tEventEmitter.emit( 'BX.UI.AccessRights:refresh', this);\n\t}\n\n\tgetButtonPanel(): BX.UI.ButtonPanel\n\t{\n\t\treturn this.buttonPanel;\n\t}\n\n\tshowNotification(title): void\n\t{\n\t\tBX.UI.Notification.Center.notify({\n\t\t\tcontent: title,\n\t\t\tposition: 'top-right',\n\t\t\tautoHideDelay: 3000,\n\t\t});\n\t}\n\n\tsendActionRequest(): void\n\t{\n\t\tif (this.isRequested)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.isRequested = true;\n\t\tEventEmitter.emit(this, 'onBeforeSave', this);\n\n\t\tthis.timer = setTimeout(\n\t\t\t() => {\n\t\t\t\tthis.blockGrid();\n\t\t\t},\n\t\t\t1000\n\t\t);\n\n\t\tlet needReload = false;\n\t\tconst dataToSave = [];\n\t\tfor (let i = 0; i < this.userGroups.length; i++)\n\t\t{\n\t\t\tif (Text.toNumber(this.userGroups[i].id) === 0)\n\t\t\t{\n\t\t\t\tneedReload = true;\n\t\t\t}\n\n\t\t\tdataToSave.push({\n\t\t\t\taccessCodes: this.userGroups[i].accessCodes,\n\t\t\t\tid: this.userGroups[i].id,\n\t\t\t\ttitle: this.userGroups[i].title,\n\t\t\t\ttype: this.userGroups[i].type,\n\t\t\t\taccessRights: this.userGroups[i].accessRights\n\t\t\t})\n\t\t}\n\n\t\tBX.ajax.runComponentAction(\n\t\t\tthis.component,\n\t\t\tthis.actionSave,\n\t\t\t{\n\t\t\t\tmode: this.mode,\n\t\t\t\tdata: {\n\t\t\t\t\tuserGroups: dataToSave,\n\t\t\t\t\tparameters: this.additionalSaveParams\n\t\t\t\t},\n\t\t\t\t// analyticsLabel: {\n\t\t\t\t// \tviewMode: 'grid',\n\t\t\t\t// \tfilterState: 'closed'\n\t\t\t\t// }\n\t\t\t}\n\t\t).then(\n\t\t\t() => {\n\t\t\t\tif (needReload)\n\t\t\t\t{\n\t\t\t\t\tthis.reloadGrid();\n\t\t\t\t}\n\n\t\t\t\tthis.isRequested = false;\n\t\t\t\tthis.showNotification(Loc.getMessage('JS_UI_ACCESSRIGHTS_STTINGS_HAVE_BEEN_SAVED'));\n\t\t\t\tthis.unBlockGrid();\n\t\t\t\tthis.fireEventRefresh();\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tthis.adjustButtonPanel()\n\t\t\t\t});\n\t\t\t\tclearTimeout(this.timer);\n\t\t\t\tconst waitContainer = this.buttonPanel.getContainer().querySelector('.ui-btn-wait');\n\t\t\t\tDom.removeClass(waitContainer, 'ui-btn-wait');\n\t\t\t},\n\t\t\t() => {\n\t\t\t\tthis.isRequested = false;\n\t\t\t\tthis.showNotification('Error message');\n\t\t\t\tthis.unBlockGrid();\n\t\t\t\tclearTimeout(this.timer);\n\t\t\t\tconst waitContainer = this.buttonPanel.getContainer().querySelector('.ui-btn-wait');\n\t\t\t\tDom.removeClass(waitContainer, 'ui-btn-wait');\n\t\t\t}\n\t\t);\n\n\t\tEventEmitter.emit( 'BX.UI.AccessRights:preservation', this);\n\t}\n\n\tlock(): void\n\t{\n\t\tDom.addClass(this.getMainContainer(), '--lock');\n\t}\n\n\tunlock(): void\n\t{\n\t\tDom.removeClass(this.getMainContainer(), '--lock');\n\t}\n\n\tdeleteActionRequest(roleId): void\n\t{\n\t\tif (this.isRequested)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.isRequested = true;\n\n\t\tthis.timer = setTimeout(\n\t\t\t() => {\n\t\t\t\tthis.blockGrid();\n\t\t\t\t},\n\t\t\t1000\n\t\t);\n\n\t\tBX.ajax.runComponentAction(\n\t\t\tthis.component,\n\t\t\tthis.actionDelete,\n\t\t\t{\n\t\t\t\tmode: this.mode,\n\t\t\t\tdata: {\n\t\t\t\t\troleId: roleId\n\t\t\t\t},\n\t\t\t\t// analyticsLabel: {\n\t\t\t\t// \tviewMode: 'grid',\n\t\t\t\t// \tfilterState: 'closed'\n\t\t\t\t// }\n\t\t\t}\n\t\t).then(\n\t\t\t() => {\n\t\t\t\tthis.isRequested = false;\n\t\t\t\tthis.showNotification(Loc.getMessage('JS_UI_ACCESSRIGHTS_ROLE_REMOVE'));\n\t\t\t\tthis.unBlockGrid();\n\t\t\t\tclearTimeout(this.timer);\n\t\t\t},\n\t\t\t() => {\n\t\t\t\tthis.isRequested = false;\n\t\t\t\tthis.showNotification('Error message');\n\t\t\t\tthis.unBlockGrid();\n\t\t\t\tclearTimeout(this.timer);\n\t\t\t}\n\t\t);\n\t}\n\n\treloadGrid(): void\n\t{\n\t\tthis.initData();\n\n\t\tBX.ajax.runComponentAction(\n\t\t\tthis.component,\n\t\t\tthis.actionLoad,\n\t\t\t{\n\t\t\t\tmode: this.mode,\n\t\t\t\tdata: {\n\t\t\t\t\tparameters: this.loadParams\n\t\t\t\t},\n\t\t\t}\n\t\t).then(\n\t\t\t(response) => {\n\t\t\t\tif (\n\t\t\t\t\tresponse.data['ACCESS_RIGHTS']\n\t\t\t\t\t&& response.data['USER_GROUPS']\n\t\t\t\t) {\n\t\t\t\t\tthis.accessRights = response.data.ACCESS_RIGHTS;\n\t\t\t\t\tthis.userGroups = response.data.USER_GROUPS;\n\t\t\t\t\tthis.loadData();\n\t\t\t\t\tthis.draw();\n\t\t\t\t}\n\t\t\t\tthis.unBlockGrid();\n\t\t\t},\n\t\t\t() => this.unBlockGrid\n\t\t);\n\t}\n\n\tblockGrid(): void\n\t{\n\t\tconst offsetTop =\n\t\t\tthis.layout.container.getBoundingClientRect().top < 0\n\t\t\t\t? '0'\n\t\t\t\t: this.layout.container.getBoundingClientRect().top\n\t\t;\n\n\t\tDom.addClass(this.layout.container, 'ui-access-rights-block');\n\t\tDom.style(this.layout.container, 'height', 'calc(100vh - ' + offsetTop  + 'px)')\n\n\t\tsetTimeout(() => {\n\t\t\tDom.style(this.layout.container, 'height', 'calc(100vh - ' + offsetTop  + 'px)')\n\t\t});\n\n\t\tthis\n\t\t\t.getLoader()\n\t\t\t.show()\n\t\t;\n\t}\n\n\tunBlockGrid(): void\n\t{\n\t\tDom.removeClass(this.layout.container, 'ui-access-rights-block');\n\t\tDom.style(this.layout.container, 'height', null)\n\n\t\tthis\n\t\t\t.getLoader()\n\t\t\t.hide()\n\t\t;\n\t}\n\n\tgetLoader(): Loader\n\t{\n\t\tif (!this.loader)\n\t\t{\n\t\t\tthis.loader = new Loader({\n\t\t\t\ttarget: this.layout.container\n\t\t\t});\n\t\t}\n\n\t\treturn this.loader;\n\t}\n\n\tremoveRoleColumn(param): void\n\t{\n\t\tthis.headSection.removeColumn(param.data);\n\t\tthis.accessRightsSections.map(\n\t\t\t(data) => {\n\t\t\t\tdata.removeColumn(param.data);\n\t\t\t}\n\t\t);\n\n\t\tconst targetIndex = this.userGroups.indexOf(param.data.userGroup);\n\t\tthis.userGroups.splice(targetIndex, 1);\n\n\t\tconst roleId = param.data.userGroup.id;\n\t\tif (roleId > 0)\n\t\t{\n\t\t\tthis.deleteActionRequest(roleId);\n\t\t}\n\t}\n\n\taddRoleColumn(event: BaseEvent): void\n\t{\n\t\tconst [param] = event.getData();\n\t\tif (!param)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst sections = this.accessRightsSections;\n\n\t\tfor (let i = 0; i < sections.length; i++)\n\t\t{\n\t\t\tparam.headSection = false;\n\t\t\tparam.newColumn = true;\n\t\t\tsections[i].addColumn(param);\n\t\t\tsections[i].scrollToRight(sections[i].getColumnsContainer().scrollWidth - sections[i].getColumnsContainer().offsetWidth, 'stop');\n\t\t}\n\n\t\tparam.headSection = true;\n\t\tparam.newColumn = true;\n\t\tthis.headSection.addColumn(param);\n\t}\n\n\taddUserGroup(event: BaseEvent): void\n\t{\n\t\tlet [options] = event.getData();\n\t\toptions = options || {};\n\t\tthis.userGroups.push(options);\n\t}\n\n\tupdateRole(event: BaseEvent): void\n\t{\n\t\tconst item = event.getData();\n\t\tconst index = this.userGroups.indexOf(item.userGroup);\n\t\tif (index >= 0)\n\t\t{\n\t\t\tthis.userGroups[index].title = item.text;\n\t\t}\n\t}\n\n\tadjustButtonPanel(): void\n\t{\n\t\tconst modifiedItems = this.getMainContainer().querySelectorAll('.ui-access-rights-column-item-changer-on');\n\t\tconst modifiedRoles = this.getMainContainer().querySelectorAll('.ui-access-rights-column-new');\n\t\tconst modifiedUsers = this.getMainContainer().querySelectorAll('.ui-access-rights-members-item-new');\n\t\tconst modifiedVariables = this.getMainContainer().querySelectorAll('.ui-tag-selector-container');\n\n\t\tif(modifiedItems.length > 0 || modifiedRoles.length > 0 || modifiedUsers.length > 0 || modifiedVariables.length > 0)\n\t\t{\n\t\t\tthis.buttonPanel.show();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.buttonPanel.hide();\n\t\t}\n\t}\n\n\tupdateAccessRight(event: BaseEvent): void\n\t{\n\t\tconst data = event.getData();\n\t\tconst userGroup = this.userGroups[this.userGroups.indexOf(data.userGroup)];\n\t\tconst accessId = data.access.id;\n\n\t\tfor (let i = 0; i < userGroup.accessRights.length; i++)\n\t\t{\n\t\t\tconst item = userGroup.accessRights[i];\n\t\t\tif (item && item.id === accessId)\n\t\t\t{\n\t\t\t\titem.value = (item.value === '0') ? '1' : '0';\n\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tuserGroup.accessRights.push({\n\t\t\tid: accessId,\n\t\t\tvalue: data.switcher.isChecked() ? '1' : '0'\n\t\t});\n\t}\n\n\tupdateAccessVariationRight(event: BaseEvent): void\n\t{\n\t\tconst item = event.getData();\n\t\tconst userGroup = this.userGroups[this.userGroups.indexOf(item.userGroup)];\n\t\tconst accessId = item.access.id;\n\n\t\tconst deleteIds = [];\n\t\tfor (let i = 0; i < userGroup.accessRights.length; i++)\n\t\t{\n\t\t\tconst item = userGroup.accessRights[i];\n\t\t\tif (item && item.id === accessId)\n\t\t\t{\n\t\t\t\tdeleteIds.push(i);\n\t\t\t}\n\t\t}\n\n\t\tdeleteIds.forEach((i) => {\n\t\t\tdelete (userGroup.accessRights[i]);\n\t\t});\n\t\tconst values = item.selectedValues || [];\n\t\tvalues.forEach((value) => {\n\t\t\tuserGroup.accessRights.push({\n\t\t\t\tid: accessId,\n\t\t\t\tvalue: value\n\t\t\t});\n\t\t});\n\t}\n\n\tloadData()\n\t{\n\t\tthis.accessRights.map(\n\t\t\t(data, index) => {\n\t\t\t\tdata.id = index;\n\t\t\t\tthis.accessRightsSections.push(this.addSection(data));\n\t\t\t}\n\t\t);\n\t}\n\n\tgetColumns(): Column[]\n\t{\n\t\treturn this.columns;\n\t}\n\n\tgetSections(): Section[]\n\t{\n\t\treturn this.accessRightsSections;\n\t}\n\n\tgetUserGroups(): []\n\t{\n\t\tthis.userGroups.forEach(\n\t\t\t(item) => {\n\t\t\t\tif (item.accessCodes)\n\t\t\t\t{\n\t\t\t\t\tfor (const user in item.members)\n\t\t\t\t\t{\n\t\t\t\t\t\titem.accessCodes[user] = item.members[user].type\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\n\t\treturn this.userGroups;\n\t}\n\n\tgetHeadSection(): Section\n\t{\n\t\tif (!this.headSection)\n\t\t{\n\t\t\tthis.headSection = new Section({\n\t\t\t\theadSection: true,\n\t\t\t\tuserGroups: this.userGroups,\n\t\t\t\tgrid: this\n\t\t\t});\n\t\t}\n\n\t\treturn this.headSection;\n\t}\n\n\taddSection(options): Section\n\t{\n\t\toptions = options || {};\n\t\treturn new Section({\n\t\t\tid: options.id,\n\t\t\thint: options.sectionHint,\n\t\t\ttitle: options.sectionTitle,\n\t\t\trights: options.rights ? options.rights : [],\n\t\t\tgrid: this\n\t\t});\n\t}\n\n\tgetSectionNode(): HTMLElement\n\t{\n\t\treturn Tag.render`<div class='ui-access-rights-section'></div>`;\n\t}\n\n\tgetMainContainer(): HTMLElement\n\t{\n\t\tif (!this.layout.container)\n\t\t{\n\t\t\tthis.layout.container = Tag.render`<div class='ui-access-rights'></div>`;\n\t\t}\n\n\t\treturn this.layout.container;\n\t}\n\n\tdraw(): void\n\t{\n\t\tconst docFragmentSections = document.createDocumentFragment();\n\t\tDom.append(this.getHeadSection().render(), docFragmentSections);\n\n\t\tthis\n\t\t\t.getSections()\n\t\t\t.map((data) => {\n\t\t\t\tDom.append(data.render(), docFragmentSections);\n\t\t\t})\n\t\t;\n\n\t\tthis.layout.container = null;\n\t\tDom.append(docFragmentSections, this.getMainContainer());\n\n\t\tthis.renderTo.innerHTML = '';\n\t\tDom.append(this.getMainContainer(), this.renderTo);\n\n\t\tthis.afterRender();\n\t}\n\n\tafterRender(): void\n\t{\n\t\tthis.getHeadSection().adjustEars();\n\t\tthis\n\t\t\t.getSections()\n\t\t\t.map((data) => {\n\t\t\t\tdata.adjustEars();\n\t\t\t})\n\t\t;\n\t}\n\n\tonMemberSelect(params): void\n\t{\n\t\tconst option = Grid.buildOption(params);\n\t\tif (!option)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (params.state === 'select')\n\t\t{\n\t\t\tEventEmitter.emit('BX.UI.AccessRights:addToAccessCodes', option);\n\t\t}\n\t}\n\n\tonMemberUnselect(params)\n\t{\n\t\tconst option = Grid.buildOption(params);\n\n\t\tif (!option)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tEventEmitter.emit('BX.UI.AccessRights:removeFromAccessCodes', option);\n\t}\n\n\tonGetEntityTypes(): void\n\t{\n\t\tconst controls = BX.Main\n\t\t\t.selectorManagerV2\n\t\t\t.controls\n\t\t;\n\t\tconst selectorInstance = controls[Object.keys(controls)[0]];\n\n\t\tselectorInstance.entityTypes.USERGROUPS = {\n\t\t\toptions: {\n\t\t\t\tenableSearch: 'Y',\n\t\t\t\tsearchById: 'Y',\n\t\t\t\taddTab: 'Y',\n\t\t\t\treturnItemUrl: (selectorInstance.getOption('returnItemUrl') === 'N' ? 'N' : 'Y')\n\t\t\t}\n\t\t};\n\t}\n\n\tstatic buildOption(params): {}\n\t{\n\t\tconst controls = BX.Main\n\t\t\t.selectorManagerV2\n\t\t\t.controls\n\t\t;\n\t\tconst selectorInstance = controls[Object.keys(controls)[0]].selectorInstance;\n\t\tconst dataColumnAttribute = 'bx-data-column-id';\n\n\t\tconst node = selectorInstance.bindOptions.node;\n\n\t\tif (!node.hasAttribute(dataColumnAttribute) || Type.isUndefined(params.item))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst columnId =  node.getAttribute(dataColumnAttribute);\n\n\t\tconst accessItem = params.item.id;\n\t\tconst entityType = params.entityType;\n\t\tconst accessCodesResult = {};\n\t\taccessCodesResult[accessItem] = entityType;\n\n\t\treturn {\n\t\t\taccessCodes: accessCodesResult,\n\t\t\tcolumnId: columnId,\n\t\t\titem: params.item\n\t\t};\n\t}\n}\n\nconst namespace = Reflection.namespace('BX.UI');\nnamespace.AccessRights = Grid;\n","import ColumnItemOptions from \"../columnitem\";\nimport {Tag} from 'main.core';\n\nexport default class Base {\n\tconstructor(options: ColumnItemOptions)\n\t{\n\t\tthis.currentValue = options.currentValue || null;\n\t\tthis.identificator = 'col-' + Math.random();\n\t\tthis.parentContainer = options.container;\n\t\tthis.grid = options.grid;\n\t\tthis.text = options.text;\n\t\tthis.userGroup = options.userGroup;\n\t\tthis.access = options.access;\n\n\t\tthis.bindEvents();\n\t}\n\n\tbindEvents()\n\t{\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\treturn Tag.render`<div></div>`;\n\t}\n\n\tgetId(): string\n\t{\n\t\treturn this.identificator;\n\t}\n}\n","import {Dom, Event, Text, Tag} from \"main.core\";\nimport {PopupWindowManager} from \"main.popup\";\nimport Base from \"./base\";\n\nexport default class Title extends Base\n{\n\tstatic TYPE = 'title';\n\n\trender(): HTMLElement\n\t{\n\t\tconst node = Tag.render`\n\t\t\t<div \n\t\t\t\tclass='ui-access-rights-column-item-text'\n\t\t\t\tdata-id='${this.getId()}'\n\t\t\t>\n\t\t\t\t${Text.encode(this.text)}\n\t\t\t</div>\n\t\t`;\n\n\t\tEvent.bind(node, 'mouseenter', this.adjustPopupHelper.bind(this));\n\n\t\tEvent.bind(node, 'mouseleave', () => {\n\t\t\tif (this.popupHelper)\n\t\t\t{\n\t\t\t\tthis.popupHelper.close();\n\t\t\t}\n\t\t});\n\n\t\treturn node;\n\t}\n\n\tadjustPopupHelper(): void\n\t{\n\t\tconst set = this.parentContainer.cloneNode(true);\n\n\t\tDom.style(set, 'position', 'absolute');\n\t\tDom.style(set, 'display', 'inline');\n\t\tDom.style(set, 'visibility', 'hidden');\n\t\tDom.style(set, 'height', '0');\n\n\t\tDom.append(set, document.body);\n\n\t\tsetTimeout(() => {\n\t\t\tDom.remove(set);\n\t\t});\n\n\t\tif (set.offsetWidth > this.parentContainer.offsetWidth)\n\t\t{\n\t\t\tDom.style(set, 'visibility', 'visible');\n\t\t\tthis.getPopupHelper().show();\n\t\t}\n\t}\n\n\tgetPopupHelper(): Popup\n\t{\n\t\tif (!this.popupHelper)\n\t\t{\n\t\t\tthis.popupHelper = PopupWindowManager.create(\n\t\t\t\tnull,\n\t\t\t\tthis.parentContainer,\n\t\t\t\t{\n\t\t\t\t\tautoHide: true,\n\t\t\t\t\tdarkMode: true,\n\t\t\t\t\tcontent: this.text,\n\t\t\t\t\tmaxWidth: this.parentContainer.offsetWidth,\n\t\t\t\t\toffsetTop: -9,\n\t\t\t\t\toffsetLeft: 5,\n\t\t\t\t\tanimation: 'fading-slide'\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\treturn this.popupHelper;\n\t}\n}","import {Tag} from 'main.core';\nimport ColumnItemOptions from \"../columnitem\";\nimport Base from \"./base\";\n\nexport default class Hint extends Base\n{\n\tconstructor(options: ColumnItemOptions)\n\t{\n\t\tsuper(options);\n\n\t\tthis.hint = options.hint;\n\t\tthis.className = options.className;\n\n\t\tthis.hintNode = null;\n\t}\n\n\trender(): ?HTMLElement\n\t{\n\t\tif (!this.hintNode && this.hint)\n\t\t{\n\t\t\tconst hintManager = BX.UI.Hint.createInstance({\n\t\t\t\tid: 'access-rights-ui-hint-' + this.getId(),\n\t\t\t\tpopupParameters: {\n\t\t\t\t\tclassName: 'ui-access-rights-popup-pointer-events ui-hint-popup',\n\t\t\t\t\tautoHide: true,\n\t\t\t\t\tdarkMode: true,\n\t\t\t\t\tmaxWidth: 280,\n\t\t\t\t\toffsetTop: 0,\n\t\t\t\t\toffsetLeft: 8,\n\t\t\t\t\tangle: true,\n\t\t\t\t\tanimation: 'fading-slide',\n\t\t\t\t},\n\t\t\t});\n\n\t\t\tthis.hintNode = Tag.render`<span class='${this.className}'></span>`;\n\t\t\tthis.hintNode.setAttribute(hintManager.attributeName, this.hint);\n\t\t\tthis.hintNode.setAttribute(hintManager.attributeHtmlName, true);\n\t\t\tthis.hintNode.setAttribute(hintManager.attributeInteractivityName, true);\n\n\t\t\thintManager.initNode(this.hintNode);\n\t\t}\n\n\t\treturn this.hintNode;\n\t}\n}\n","import {Dom, Event, Text, Tag, Type, Loc, Reflection} from 'main.core';\nimport {BaseEvent, EventEmitter} from \"main.core.events\";\nimport {PopupWindowManager} from \"main.popup\";\nimport Base from \"./base\";\nimport ColumnItemOptions from \"../columnitem\";\n\nconst BX = Reflection.namespace('BX');\n\nexport default class Member extends Base\n{\n\tstatic TYPE = 'members';\n\n\tconstructor(options: ColumnItemOptions)\n\t{\n\t\tsuper(options);\n\n\t\tthis.openPopupEvent = options.openPopupEvent;\n\t\tthis.popupContainer = options.popupContainer\n\t\tthis.accessCodes = options.accessCodes || [];\n\t}\n\n\tbindEvents(): void\n\t{\n\t\tEventEmitter.subscribe('BX.UI.AccessRights:addToAccessCodes', this.addToAccessCodes.bind(this));\n\t\tEventEmitter.subscribe('BX.UI.AccessRights:removeFromAccessCodes', this.removeFromAccessCodes.bind(this));\n\t\tEventEmitter.subscribe('BX.UI.AccessRights:reset', this.resetNewMembers.bind(this));\n\t\tEventEmitter.subscribe('BX.UI.AccessRights:refresh', this.resetNewMembers.bind(this));\n\t}\n\n\tgetMember(): HTMLElement\n\t{\n\t\tif (!this.member)\n\t\t{\n\t\t\tconst members = this.userGroup.members || {};\n\t\t\tconst membersFragment = document.createDocumentFragment();\n\t\t\tlet counter = 0;\n\t\t\tthis.validateVariables();\n\n\t\t\tObject.keys(members).reverse().forEach(\n\t\t\t\t(item) => {\n\t\t\t\t\tcounter++;\n\t\t\t\t\tif (counter < 7)\n\t\t\t\t\t{\n\t\t\t\t\t\tconst user = members[item];\n\n\t\t\t\t\t\tconst userNode = Tag.render`\n\t\t\t\t\t\t\t<div class='ui-access-rights-members-item'></div>\n\t\t\t\t\t\t`;\n\n\t\t\t\t\t\tif (user.new)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tDom.addClass(userNode, 'ui-access-rights-members-item-new');\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (user.avatar)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst userAvatar = Tag.render`<a class='ui-access-rights-members-item-avatar' title=\"${Text.encode(user.name)}\"></a>`;\n\t\t\t\t\t\t\tDom.style(userAvatar, 'backgroundImage', 'url(\\'' + encodeURI(user.avatar) + '\\')');\n\t\t\t\t\t\t\tDom.style(userAvatar, 'backgroundSize', 'cover');\n\t\t\t\t\t\t\tDom.append(userAvatar, userNode);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlet avatarClass = 'ui-icon-common-user';\n\n\t\t\t\t\t\t\tif (user.type === 'groups')\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tavatarClass = 'ui-icon-common-user-group';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse if (user.type === 'sonetgroups')\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tavatarClass = 'ui-icon-common-company';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse if (user.type === 'usergroups')\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tavatarClass = 'ui-icon-common-user-group';\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tconst emptyAvatar = Tag.render`<a class='ui-icon ui-icon-xs' title=\"${Text.encode(user.name)}\"><i></i></a>`;\n\t\t\t\t\t\t\tDom.addClass(emptyAvatar, avatarClass);\n\t\t\t\t\t\t\tDom.append(emptyAvatar, userNode);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tDom.append(userNode, membersFragment);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tDom.append(this.getAddUserToRole(), membersFragment);\n\n\t\t\tthis.member = Tag.render`<div class='ui-access-rights-members'>${membersFragment}</div>`;\n\t\t\tEvent.bind(this.member, 'click', this.adjustPopupUserControl.bind(this));\n\t\t}\n\n\t\treturn this.member;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\treturn this.getMember();\n\t}\n\n\tresetNewMembers(): void\n\t{\n\t\tconst newMembers = this.getMember().querySelectorAll('.ui-access-rights-members-item-new');\n\n\t\tnewMembers.forEach((item) => {\n\t\t\tDom.removeClass(item, 'ui-access-rights-members-item-new');\n\t\t})\n\t}\n\n\tvalidateVariables(): void\n\t{\n\t\tif (Type.isUndefined(this.userGroup.accessCodes))\n\t\t{\n\t\t\tthis.userGroup.accessCodes = [];\n\t\t}\n\t}\n\n\tupdateMembers(): void\n\t{\n\t\tDom.remove(this.member);\n\t\tthis.member = null;\n\n\t\tDom.append(this.getMember(), this.parentContainer);\n\t\tthis.grid.getButtonPanel().show();\n\t}\n\n\taddToAccessCodes(event: BaseEvent): void\n\t{\n\t\tconst params = event.getData();\n\n\t\tif (params.columnId !== this.getId())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst firstKey = Object.keys(params.accessCodes)[0];\n\t\tconst type = params.accessCodes[firstKey].toUpperCase();\n\t\tthis.userGroup.accessCodes = Object.keys(this.accessCodes);\n\n\t\tconst item = params.item;\n\n\t\tif (!Type.isUndefined(item) && Object.keys(item).length)\n\t\t{\n\t\t\tthis.userGroup.members[firstKey] = {\n\t\t\t\tid: item.entityId,\n\t\t\t\tname: item.name,\n\t\t\t\tavatar: item.avatar,\n\t\t\t\turl: '',\n\t\t\t\tnew: true,\n\t\t\t\ttype: type.toLowerCase()\n\t\t\t};\n\n\t\t\tthis.updateMembers();\n\t\t}\n\n\t\tthis.userGroup.accessCodes = [];\n\n\t\tfor (const key in this.userGroup.members)\n\t\t{\n\t\t\tthis.userGroup.accessCodes[key] = this.userGroup.members[key].type;\n\t\t}\n\t}\n\n\tremoveFromAccessCodes(event): void\n\t{\n\t\tconst params = event.data;\n\n\t\tif (params.columnId !== this.identificator)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst firstKey = Object.keys(params.accessCodes)[0];\n\n\t\tdelete this.userGroup.members[firstKey];\n\t\tthis.updateMembers();\n\n\t\tthis.userGroup.accessCodes = [];\n\n\t\tfor (const key in this.userGroup.members)\n\t\t{\n\t\t\tthis.userGroup.accessCodes[key] = this.userGroup.members[key].type;\n\t\t}\n\t}\n\n\tadjustPopupUserControl(): void\n\t{\n\t\tconst users = [];\n\t\tconst groups = [];\n\t\tconst departments = [];\n\t\tconst sonetgroups = [];\n\n\t\tfor (const item in this.userGroup.members)\n\t\t{\n\t\t\tthis.userGroup.members[item].key = item;\n\n\t\t\tif (this.userGroup.members[item].type === 'users')\n\t\t\t{\n\t\t\t\tusers.push(this.userGroup.members[item]);\n\t\t\t}\n\t\t\telse if (this.userGroup.members[item].type === 'groups')\n\t\t\t{\n\t\t\t\tgroups.push(this.userGroup.members[item]);\n\t\t\t}\n\t\t\telse if (this.userGroup.members[item].type === 'usergroups')\n\t\t\t{\n\t\t\t\tgroups.push(this.userGroup.members[item]);\n\t\t\t}\n\t\t\telse if (this.userGroup.members[item].type === 'departments')\n\t\t\t{\n\t\t\t\tdepartments.push(this.userGroup.members[item]);\n\t\t\t}\n\t\t\telse if (this.userGroup.members[item].type === 'sonetgroups')\n\t\t\t{\n\t\t\t\tsonetgroups.push(this.userGroup.members[item]);\n\t\t\t}\n\t\t}\n\n\t\tconst counterUsers = [];\n\n\t\tfor (const key in this.userGroup.members)\n\t\t{\n\t\t\tcounterUsers.push(this.userGroup.members[key])\n\t\t}\n\n\t\tif (counterUsers.length === 0)\n\t\t{\n\t\t\tthis.showUserSelectorPopup();\n\t\t\treturn;\n\t\t}\n\n\t\tthis.getUserPopup(users, groups, departments, sonetgroups).show();\n\t}\n\n\tgetAddUserToRole(): HTMLElement\n\t{\n\t\tif (!this.addUserToRole)\n\t\t{\n\t\t\tthis.addUserToRole = Tag.render`\n\t\t\t\t<span \n\t\t\t\t\tclass='ui-access-rights-members-item ui-access-rights-members-item-add'\n\t\t\t\t\tbx-data-column-id='${this.getId()}'\n\t\t\t\t>\n\t\t\t\t</span>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.addUserToRole;\n\t}\n\n\tgetUserPopup(users, groups, departments, sonetgroups): Popup\n\t{\n\t\tif (!this.popupUsers)\n\t\t{\n\t\t\tusers = users || [];\n\t\t\tgroups = groups || [];\n\t\t\tdepartments = departments || [];\n\t\t\tsonetgroups = sonetgroups || [];\n\n\t\t\tconst content = Tag.render`<div class='ui-access-rights-popup-toggler'></div>`;\n\n\t\t\tconst contentTitle = Tag.render`<div class='ui-access-rights-popup-toggler-title'></div>`;\n\n\t\t\tconst onTitleClick = (event: BaseEvent) => {\n\t\t\t\tconst node = event.target;\n\t\t\t\tactivate(node);\n\t\t\t\tadjustSlicker(node);\n\t\t\t};\n\n\t\t\tif (groups.length > 0)\n\t\t\t{\n\t\t\t\tconst groupTitleItem = Tag.render`\n\t\t\t\t\t<div \n\t\t\t\t\t\tclass='ui-access-rights-popup-toggler-title-item ui-access-rights-popup-toggler-title-item-active'\n\t\t\t\t\t\tdata-role='ui-access-rights-popup-toggler-content-groups'\n\t\t\t\t\t>\n\t\t\t\t\t\t${Loc.getMessage('JS_UI_ACCESSRIGHTS_USER_GROUPS')}\n\t\t\t\t\t</div>\n\t\t\t\t`;\n\t\t\t\tEvent.bind(groupTitleItem, 'click', onTitleClick.bind(this));\n\n\t\t\t\tDom.append(groupTitleItem, contentTitle);\n\t\t\t}\n\n\t\t\tif (departments.length > 0)\n\t\t\t{\n\t\t\t\tconst groupTitleItem = Tag.render`\n\t\t\t\t\t<div \n\t\t\t\t\t\tclass='ui-access-rights-popup-toggler-title-item'\n\t\t\t\t\t\tdata-role='ui-access-rights-popup-toggler-content-departments'\n\t\t\t\t\t>\n\t\t\t\t\t\t${Loc.getMessage('JS_UI_ACCESSRIGHTS_DEPARTMENTS')}\n\t\t\t\t\t</div>\n\t\t\t\t`;\n\t\t\t\tEvent.bind(groupTitleItem, 'click', onTitleClick.bind(this));\n\n\t\t\t\tDom.append(groupTitleItem, contentTitle);\n\t\t\t}\n\n\t\t\tif (users.length > 0)\n\t\t\t{\n\t\t\t\tconst groupTitleItem = Tag.render`\n\t\t\t\t\t<div \n\t\t\t\t\t\tclass='ui-access-rights-popup-toggler-title-item'\n\t\t\t\t\t\tdata-role='ui-access-rights-popup-toggler-content-users'\n\t\t\t\t\t>\n\t\t\t\t\t\t${Loc.getMessage('JS_UI_ACCESSRIGHTS_STAFF')}\n\t\t\t\t\t</div>\n\t\t\t\t`;\n\t\t\t\tEvent.bind(groupTitleItem, 'click', onTitleClick.bind(this));\n\n\t\t\t\tDom.append(groupTitleItem, contentTitle);\n\t\t\t}\n\n\t\t\tif (sonetgroups.length > 0)\n\t\t\t{\n\t\t\t\tconst groupTitleItem = Tag.render`\n\t\t\t\t\t<div \n\t\t\t\t\t\tclass='ui-access-rights-popup-toggler-title-item'\n\t\t\t\t\t\tdata-role='ui-access-rights-popup-toggler-content-sonetgroups'\n\t\t\t\t\t>\n\t\t\t\t\t\t${Loc.getMessage('JS_UI_ACCESSRIGHTS_SOCNETGROUP')}\n\t\t\t\t\t</div>\n\t\t\t\t`;\n\t\t\t\tEvent.bind(groupTitleItem, 'click', onTitleClick.bind(this));\n\n\t\t\t\tDom.append(groupTitleItem, contentTitle);\n\t\t\t}\n\n\t\t\tDom.append(Tag.render`<div class='ui-access-rights-popup-toggler-title-slicker'></div>`, contentTitle);\n\n\t\t\tDom.append(contentTitle, content);\n\n\t\t\tif (groups.length > 0)\n\t\t\t{\n\t\t\t\tDom.append(this.getUserPopupTogglerGroup(groups, 'groups'), content);\n\t\t\t}\n\n\t\t\tif (departments.length > 0)\n\t\t\t{\n\t\t\t\tDom.append(this.getUserPopupTogglerGroup(departments, 'departments'), content);\n\t\t\t}\n\n\t\t\tif (users.length > 0)\n\t\t\t{\n\t\t\t\tDom.append(this.getUserPopupTogglerGroup(users, 'users'), content);\n\t\t\t}\n\n\t\t\tif (sonetgroups.length > 0)\n\t\t\t{\n\t\t\t\tDom.append(this.getUserPopupTogglerGroup(sonetgroups, 'sonetgroups'), content);\n\t\t\t}\n\n\t\t\tconst footer = Tag.render`<div class='ui-access-rights-popup-toggler-footer'></div>`;\n\n\t\t\tconst footerLink = Tag.render`\n\t\t\t\t<div class='ui-access-rights-popup-toggler-footer-link'>\n\t\t\t\t\t${Loc.getMessage('JS_UI_ACCESSRIGHTS_ADD')}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t\tEvent.bind(footerLink, 'click', (event: Event) => {\n\t\t\t\tthis.popupUsers.close();\n\t\t\t\tthis.showUserSelectorPopup();\n\t\t\t\tevent.preventDefault()\n\t\t\t});\n\n\t\t\tDom.append(footerLink, footer);\n\t\t\tDom.append(footer, content);\n\n\t\t\tconst adjustSlicker = (node) => {\n\t\t\t\tif (!Type.isDomNode(node))\n\t\t\t\t{\n\t\t\t\t\tnode = content.querySelector('.ui-access-rights-popup-toggler-title-item-active');\n\t\t\t\t}\n\t\t\t\tconst slicker = content.querySelector('.ui-access-rights-popup-toggler-title-slicker');\n\t\t\t\tDom.style(slicker, 'left', node.offsetLeft + 'px');\n\t\t\t\tDom.style(slicker, 'width', node.offsetWidth + 'px');\n\t\t\t};\n\n\t\t\tconst activate = (node) => {\n\t\t\t\tconst titles = content.querySelectorAll('.ui-access-rights-popup-toggler-title-item');\n\t\t\t\tconst contents = content.querySelectorAll('.ui-access-rights-popup-toggler-content');\n\n\t\t\t\tconst target = content.querySelector('.' + node.getAttribute('data-role'));\n\n\t\t\t\ttitles.forEach((item) => {\n\t\t\t\t\tDom.removeClass(item, 'ui-access-rights-popup-toggler-title-item-active');\n\t\t\t\t});\n\n\t\t\t\tcontents.forEach((item) => {\n\t\t\t\t\tDom.style(item, 'display', 'none');\n\t\t\t\t});\n\n\t\t\t\tDom.style(target, 'display', 'block');\n\t\t\t\tDom.addClass(node, 'ui-access-rights-popup-toggler-title-item-active');\n\t\t\t};\n\n\t\t\tthis.popupUsers = PopupWindowManager.create(\n\t\t\t\tnull,\n\t\t\t\tthis.getAddUserToRole(),\n\t\t\t\t{\n\t\t\t\t\tcontentPadding: 10,\n\t\t\t\t\tanimation: 'fading-slide',\n\t\t\t\t\tcontent,\n\t\t\t\t\tpadding: 0,\n\t\t\t\t\toffsetTop: 5,\n\t\t\t\t\tangle: {\n\t\t\t\t\t\tposition: 'top',\n\t\t\t\t\t\toffset: 35,\n\t\t\t\t\t},\n\t\t\t\t\tautoHide: true,\n\t\t\t\t\tcloseEsc: true,\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tonPopupShow: () => {\n\t\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\t\tconst firstActiveNode = content.querySelector('.ui-access-rights-popup-toggler-title-item');\n\n\t\t\t\t\t\t\t\tif (!firstActiveNode)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tDom.addClass(firstActiveNode, 'ui-access-rights-popup-toggler-title-item-active');\n\t\t\t\t\t\t\t\tadjustSlicker(firstActiveNode);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonPopupClose: () => {\n\t\t\t\t\t\t\tthis.popupUsers.destroy();\n\t\t\t\t\t\t\tthis.popupUsers = null;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\treturn this.popupUsers;\n\t}\n\n\tgetUserPopupTogglerGroup(array, type)\n\t{\n\t\tconst node = Tag.render`<div class='ui-access-rights-popup-toggler-content'></div>`;\n\t\tDom.addClass(node, 'ui-access-rights-popup-toggler-content-' + type);\n\n\t\tarray.forEach((item) => {\n\t\t\tconst toggler = Tag.render`<div class='ui-access-rights-popup-toggler-content-item'></div>`;\n\n\t\t\tif (item.avatar)\n\t\t\t{\n\t\t\t\tconst avatar = Tag.render`\n\t\t\t\t\t<a \n\t\t\t\t\t\tclass='ui-access-rights-popup-toggler-content-item-userpic'\n\t\t\t\t\t\ttitle=\"${Text.encode(item.name)}\"\n\t\t\t\t\t></a>\n\t\t\t\t`;\n\t\t\t\tDom.style(avatar, 'backgroundImage', 'url(\\'' + encodeURI(item.avatar) + '\\')');\n\t\t\t\tDom.style(avatar, 'backgroundSize', 'cover');\n\t\t\t\tDom.append(avatar, toggler);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tlet iconClass = '';\n\n\t\t\t\tif (type === 'users')\n\t\t\t\t{\n\t\t\t\t\ticonClass = 'ui-icon-common-user';\n\t\t\t\t}\n\t\t\t\telse if (type === 'groups')\n\t\t\t\t{\n\t\t\t\t\ticonClass = 'ui-icon-common-user-group';\n\t\t\t\t}\n\t\t\t\telse if (type === 'sonetgroups' || type === 'departments')\n\t\t\t\t{\n\t\t\t\t\ticonClass = 'ui-icon-common-company';\n\t\t\t\t}\n\n\t\t\t\tconst emptyAvatar = Tag.render`<a class='ui-icon ui-icon-sm' title=\"${Text.encode(item.name)}\"><i></i></a>`;\n\t\t\t\tDom.addClass(emptyAvatar, iconClass);\n\t\t\t\tDom.style(emptyAvatar, 'margin', '5px 10px');\n\t\t\t\tDom.append(emptyAvatar, toggler);\n\t\t\t}\n\n\t\t\tDom.append(\n\t\t\t\tTag.render`<div class='ui-access-rights-popup-toggler-content-item-name'>${Text.encode(item.name)}</div>`,\n\t\t\t\ttoggler\n\t\t\t);\n\n\t\t\tconst removeButton = Tag.render`\n\t\t\t\t<div class='ui-access-rights-popup-toggler-content-item-remove'>${Loc.getMessage('JS_UI_ACCESSRIGHTS_REMOVE')}</div>\n\t\t\t`;\n\n\t\t\tEvent.bind(removeButton, 'click', () => {\n\t\t\t\tthis.userGroup.accessCodes.splice(this.userGroup.accessCodes.indexOf(item.key), 1);\n\n\t\t\t\tdelete this.userGroup.accessCodes[item.key];\n\t\t\t\tdelete this.userGroup.members[item.key];\n\n\t\t\t\tDom.remove(toggler);\n\n\t\t\t\tthis.updateMembers();\n\t\t\t\tthis.adjustPopupUserControl();\n\t\t\t\tthis.grid.getButtonPanel().show();\n\t\t\t});\n\n\t\t\tDom.append(removeButton, toggler);\n\n\t\t\tDom.append(toggler, node);\n\t\t});\n\n\t\treturn node;\n\t}\n\n\tshowUserSelectorPopup(): void\n\t{\n\t\tconst selectorInstance = BX.Main\n\t\t\t.selectorManagerV2.controls[this.popupContainer]\n\t\t\t?.selectorInstance\n\t\t;\n\n\t\tif (selectorInstance)\n\t\t{\n\t\t\tselectorInstance.itemsSelected = {};\n\t\t}\n\n\t\tBX.onCustomEvent(this.openPopupEvent, [{\n\t\t\tid: this.popupContainer,\n\t\t\tbindNode: this.getAddUserToRole()\n\t\t}]);\n\n\t\tBX.onCustomEvent('BX.Main.SelectorV2:reInitDialog', [{\n\t\t\tselectorId: this.popupContainer,\n\t\t\tselectedItems: this.userGroup.accessCodes\n\t\t}]);\n\t}\n}\n","import {EventEmitter} from \"main.core.events\";\nimport {Dom, Event, Text, Tag, Loc} from 'main.core';\nimport Base from \"./base\";\n\nimport {PopupWindowManager} from \"main.popup\";\nimport ColumnItemOptions from \"../columnitem\";\n\nexport default class Role extends Base\n{\n\tstatic TYPE = 'role';\n\n\tconstructor(options: ColumnItemOptions)\n\t{\n\t\tsuper(options);\n\n\t\tthis.column = options.column;\n\t}\n\n\tbindEvents(): void\n\t{\n\t\tEvent.bind(window, 'click', (event: Event) => {\n\t\t\tif (\n\t\t\t\tevent.target === this.getRole()\n\t\t\t\t|| event.target.closest('.ui-access-rights-role')\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.updateRole();\n\t\t\tthis.offRoleEditMode();\n\t\t});\n\n\t\tEventEmitter.subscribe(this.grid, 'onBeforeSave', () => {\n\t\t\tthis.updateRole();\n\t\t\tthis.offRoleEditMode();\n\t\t});\n\t}\n\n\tgetRole(): HTMLElement\n\t{\n\t\tif (this.role)\n\t\t{\n\t\t\treturn this.role;\n\t\t}\n\n\t\tEventEmitter.subscribe('BX.UI.AccessRights:preservation', this.updateRole.bind(this));\n\t\tEventEmitter.subscribe('BX.UI.AccessRights:preservation', this.offRoleEditMode.bind(this));\n\n\t\tthis.roleInput = Tag.render`\n\t\t\t\t<input\n\t\t\t\t\ttype='text'\n\t\t\t\t\tclass='ui-access-rights-role-input'\n\t\t\t\t\tvalue='${Text.encode(this.text)}'\n\t\t\t\t\tplaceholder='${Loc.getMessage('JS_UI_ACCESSRIGHTS_ROLE_NAME')}'\n\t\t\t\t/>\n\t\t\t`;\n\n\t\tEvent.bind(this.roleInput, 'keydown', (event: Event) => {\n\t\t\tif (event.keyCode === 13)\n\t\t\t{\n\t\t\t\tthis.updateRole();\n\t\t\t\tthis.offRoleEditMode();\n\t\t\t}\n\t\t});\n\n\t\tEvent.bind(this.roleInput, 'input', () => {\n\t\t\tthis.grid.getButtonPanel().show();\n\t\t});\n\n\t\tthis.roleValue = Tag.render`<div class='ui-access-rights-role-value'>${Text.encode(this.text)}</div>`;\n\n\t\tconst editControl = Tag.render`<div class='ui-access-rights-role-edit'></div>`;\n\t\tEvent.bind(editControl, 'click', this.onRoleEditMode.bind(this));\n\n\t\tconst removeControl = Tag.render`<div class='ui-access-rights-role-remove'></div>`;\n\t\tEvent.bind(removeControl, 'click', this.showPopupConfirm.bind(this));\n\n\t\tconst roleControlWrapper = Tag.render`\n\t\t\t\t<div class='ui-access-rights-role-controls'>\n\t\t\t\t\t${editControl}\n\t\t\t\t\t${removeControl}\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\tthis.role = Tag.render`\n\t\t\t\t<div class='ui-access-rights-role'>\n\t\t\t\t\t${this.roleInput}\n\t\t\t\t\t${this.roleValue}\n\t\t\t\t\t${roleControlWrapper}\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\treturn this.role;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\treturn this.getRole();\n\t}\n\n\tonRoleEditMode()\n\t{\n\t\tDom.addClass(this.getRole(), 'ui-access-rights-role-edit-mode');\n\t\tthis.roleInput.focus();\n\t}\n\n\tshowPopupConfirm()\n\t{\n\t\tif (!this.popupConfirm)\n\t\t{\n\t\t\t/**@ToDO check role*/\n\t\t\tthis.popupConfirm = PopupWindowManager.create(\n\t\t\t\tnull,\n\t\t\t\tthis.getRole(),\n\t\t\t\t{\n\t\t\t\t\twidth: 250,\n\t\t\t\t\toverlay: true,\n\t\t\t\t\tcontentPadding: 10,\n\t\t\t\t\tcontent: Loc.getMessage('JS_UI_ACCESSRIGHTS_POPUP_REMOVE_THIS_ROLE'),\n\t\t\t\t\tanimation: 'fading-slide'\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tthis.popupConfirm.setButtons([\n\t\t\t\tnew BX.UI.Button({\n\t\t\t\t\ttext: Loc.getMessage('JS_UI_ACCESSRIGHTS_POPUP_REMOVE'),\n\t\t\t\t\tclassName: 'ui-btn ui-btn-sm ui-btn-primary',\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tclick: () => {\n\t\t\t\t\t\t\tthis.popupConfirm.close();\n\t\t\t\t\t\t\tEventEmitter.emit('BX.UI.AccessRights.ColumnItem:removeRole', this);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}),\n\t\t\t\tnew BX.UI.Button({\n\t\t\t\t\ttext: Loc.getMessage('JS_UI_ACCESSRIGHTS_POPUP_CANCEL'),\n\t\t\t\t\tclassName: 'ui-btn ui-btn-sm ui-btn-link',\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tclick: () => {\n\t\t\t\t\t\t\tthis.popupConfirm.close();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t]);\n\t\t}\n\n\t\tthis.popupConfirm.show();\n\t}\n\n\tupdateRole(): void\n\t{\n\t\tif (this.roleValue.innerHTML === this.roleInput.value || this.roleInput.value === '')\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.text = this.roleInput.value;\n\t\tthis.userGroup = this.column.getUserGroup();\n\n\t\tthis.roleValue.innerText = this.roleInput.value;\n\t\tEventEmitter.emit('BX.UI.AccessRights.ColumnItem:updateRole', this);\n\t}\n\n\toffRoleEditMode(): void\n\t{\n\t\tDom.removeClass(this.getRole(), 'ui-access-rights-role-edit-mode')\n\t}\n}\n","import {EventEmitter} from \"main.core.events\";\nimport {Dom, Tag} from \"main.core\";\nimport Base from \"./base\";\nimport ColumnItemOptions from \"../columnitem\";\n\nexport default class Changer extends Base\n{\n\tconstructor(options: ColumnItemOptions)\n\t{\n\t\tsuper(options);\n\n\t\tthis.isModify = false;\n\t}\n\n\tgetChanger(): HTMLElement\n\t{\n\t\tif (!this.changer)\n\t\t{\n\t\t\tthis.changer = Tag.render`<a class='ui-access-rights-column-item-changer'></a>`\n\t\t}\n\n\t\treturn this.changer;\n\t}\n\n\tbindEvents(): void\n\t{\n\t\tEventEmitter.subscribe('BX.UI.AccessRights:reset', this.offChanger.bind(this));\n\t\tEventEmitter.subscribe('BX.UI.AccessRights:refresh', this.refreshStatus.bind(this));\n\t}\n\n\trefreshStatus(): void\n\t{\n\t\tDom.removeClass(this.getChanger(), 'ui-access-rights-column-item-changer-on')\n\t}\n\n\toffChanger(): void\n\t{\n\t\tif (this.isModify)\n\t\t{\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.refreshStatus();\n\t\t\t});\n\t\t}\n\t}\n\n\tadjustChanger(): void\n\t{\n\t\tthis.isModify = !this.isModify;\n\n\t\tDom.toggleClass(this.getChanger(), 'ui-access-rights-column-item-changer-on');\n\t}\n}\n","import ColumnItemOptions from \"../columnitem\";\nimport {EventEmitter} from \"main.core.events\";\nimport \"ui.switcher\";\nimport {Dom} from \"main.core\";\nimport Changer from \"./changer\";\n\nexport default class Toggler extends Changer\n{\n\tstatic TYPE = 'toggler';\n\n\tconstructor(options: ColumnItemOptions)\n\t{\n\t\tsuper(options);\n\n\t\tthis.switcher = new BX.UI.Switcher(\n\t\t\t{\n\t\t\t\tsize: 'small',\n\t\t\t\tchecked: this.currentValue === '1',\n\t\t\t\thandlers: {\n\t\t\t\t\tchecked: () => {\n\t\t\t\t\t\tEventEmitter.emit('BX.UI.AccessRights.ColumnItem:accessOn', this);\n\t\t\t\t\t},\n\t\t\t\t\tunchecked: () => {\n\t\t\t\t\t\tEventEmitter.emit('BX.UI.AccessRights.ColumnItem:accessOff', this);\n\t\t\t\t\t},\n\t\t\t\t\ttoggled: () => {\n\t\t\t\t\t\tthis.adjustChanger();\n\t\t\t\t\t\tEventEmitter.emit('BX.UI.AccessRights.ColumnItem:update', this);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t}\n\n\toffChanger(): void\n\t{\n\t\tif (this.isModify)\n\t\t{\n\t\t\tthis.switcher.check(!this.switcher.isChecked());\n\t\t}\n\n\t\tsuper.offChanger();\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tDom.append(this.switcher.getNode(), this.getChanger());\n\n\t\treturn this.getChanger();\n\t}\n}\n","import {EventEmitter} from \"main.core.events\";\nimport {Event, Text, Tag, Loc, Dom} from 'main.core';\nimport Base from \"./base\";\n\nimport { Menu} from \"main.popup\";\nimport Role from \"./role\";\n\nexport default class Controller extends Base\n{\n\trender(): HTMLElement\n\t{\n\t\tif (!this.controller)\n\t\t{\n\t\t\tthis.controllerLink = Tag.render`\n\t\t\t\t<div class='ui-access-rights-column-item-controller-link'>\n\t\t\t\t\t${Loc.getMessage('JS_UI_ACCESSRIGHTS_CREATE_ROLE')}\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tthis.controllerMenu = Tag.render`\n\t\t\t\t<div class='ui-access-rights-column-item-controller-link'>\n\t\t\t\t\t${Loc.getMessage('JS_UI_ACCESSRIGHTS_COPY_ROLE')}\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tEvent.bind(this.controllerMenu, 'click', () => {\n\t\t\t\tif (this.popupMenu)\n\t\t\t\t{\n\t\t\t\t\tthis.popupMenu.close();\n\t\t\t\t}\n\t\t\t\telse if (this.grid.getUserGroups().length > 0)\n\t\t\t\t{\n\t\t\t\t\tthis.getPopupMenu(this.grid.getUserGroups()).show();\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.toggleControllerMenu();\n\n\t\t\tthis.controller = Tag.render`\n\t\t\t\t<div class='ui-access-rights-column-item-controller'>\n\t\t\t\t\t${this.controllerLink}\n\t\t\t\t\t${this.controllerMenu}\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tEvent.bind(this.controllerLink, 'click', () => {\n\t\t\t\tEventEmitter.emit('BX.UI.AccessRights.ColumnItem:addRole', [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: '0',\n\t\t\t\t\t\ttitle: Loc.getMessage('JS_UI_ACCESSRIGHTS_ROLE_NAME'),\n\t\t\t\t\t\taccessRights: [],\n\t\t\t\t\t\tmembers: [],\n\t\t\t\t\t\taccessCodes: [],\n\t\t\t\t\t\ttype: Role.TYPE\n\t\t\t\t\t}\n\t\t\t\t]);\n\n\t\t\t\tEventEmitter.emit('BX.UI.AccessRights.ColumnItem:update', this);\n\n\t\t\t\tthis.toggleControllerMenu();\n\t\t\t\tthis.grid.lock();\n\t\t\t});\n\n\t\t\tEventEmitter.subscribe('BX.UI.AccessRights.ColumnItem:removeRole', this.toggleControllerMenu.bind(this));\n\t\t}\n\n\t\treturn this.controller;\n\t}\n\n\tgetPopupMenu(options): Menu\n\t{\n\t\tif (!options)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst menuItems = [];\n\n\t\toptions.map(\n\t\t\t(data) => {\n\t\t\t\tmenuItems.push({\n\t\t\t\t\ttext: Text.encode(data.title),\n\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\tconst accessRightsCopy = Object.assign([], data.accessRights);\n\t\t\t\t\t\tconst accessCodesCopy =  Object.assign([], data.accessCodes);\n\n\t\t\t\t\t\tEventEmitter.emit(\n\t\t\t\t\t\t\t'BX.UI.AccessRights.ColumnItem:copyRole',\n\t\t\t\t\t\t\t[{\n\t\t\t\t\t\t\t\tid: '0',\n\t\t\t\t\t\t\t\ttitle: Loc.getMessage('JS_UI_ACCESSRIGHTS_ROLE_NAME'),\n\t\t\t\t\t\t\t\taccessRights: accessRightsCopy,\n\t\t\t\t\t\t\t\taccessCodes: accessCodesCopy,\n\t\t\t\t\t\t\t\ttype: Role.TYPE,\n\t\t\t\t\t\t\t\tmembers: data.members\n\t\t\t\t\t\t\t}]\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\tEventEmitter.emit('BX.UI.AccessRights.ColumnItem:update', this);\n\t\t\t\t\t\tthis.popupMenu.destroy();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t);\n\n\t\treturn this.popupMenu = new Menu(\n\t\t\t'ui_accessrights_copy_role_list',\n\t\t\tthis.controllerMenu,\n\t\t\tmenuItems,\n\t\t\t{\n\t\t\t\tevents: {\n\t\t\t\t\tonPopupClose: () => {\n\t\t\t\t\t\tthis.popupMenu.destroy();\n\t\t\t\t\t\tthis.popupMenu = null;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t}\n\n\ttoggleControllerMenu()\n\t{\n\t\tif (this.grid.getUserGroups().length === 0)\n\t\t{\n\t\t\tDom.addClass(this.controllerMenu, 'ui-access-rights-column-item-controller-link--disabled');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.removeClass(this.controllerMenu, 'ui-access-rights-column-item-controller-link--disabled');\n\t\t}\n\t}\n}\n","import ColumnItemOptions from \"../columnitem\";\nimport {Event, Text, Tag, Dom, Loc} from 'main.core';\n\nimport {PopupMenu} from \"main.popup\";\nimport Changer from \"./changer\";\nimport {BaseEvent, EventEmitter} from \"main.core.events\";\n\ntype VariableItem = {\n\tid: number,\n\ttitle: string,\n}\n\nexport default class VariableSelector extends Changer\n{\n\tstatic TYPE = 'variables';\n\n\tconstructor(options: ColumnItemOptions)\n\t{\n\t\tsuper(options);\n\n\t\tthis.selectedValues = [this.currentValue];\n\n\t\tthis.variables = options.variables || [];\n\t}\n\n\tbindEvents()\n\t{\n\t\tEventEmitter.subscribe('BX.UI.AccessRights:reset', this.reset.bind(this));\n\t\tEventEmitter.subscribe('BX.UI.AccessRights:refresh', this.refresh.bind(this));\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tconst title = this.getSelected()?.title ?? Loc.getMessage('JS_UI_ACCESSRIGHTS_ADD');\n\t\tconst variablesValue = Tag.render`\n\t\t\t\t<div class='ui-access-rights-column-item-text-link'>\n\t\t\t\t\t${Text.encode(title)}\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\tEvent.bind(variablesValue, 'click', this.showVariablesPopup.bind(this));\n\n\t\tDom.append(variablesValue, this.getChanger());\n\n\t\treturn this.getChanger();\n\t}\n\n\trefresh(): HTMLElement\n\t{\n\t\tif (this.isModify)\n\t\t{\n\t\t\tthis.currentValue = this.selectedValues[0];\n\t\t\tthis.reset();\n\t\t}\n\t}\n\n\treset(): HTMLElement\n\t{\n\t\tif (this.isModify)\n\t\t{\n\t\t\tthis.selectedValues = [this.currentValue];\n\t\t\tthis.getChanger().innerHTML = '';\n\t\t\tthis.adjustChanger();\n\t\t\tthis.render();\n\t\t}\n\t}\n\n\tgetSelected(): VariableItem\n\t{\n\t\tconst selected = this.variables.filter(variable => this.selectedValues.includes(variable.id));\n\n\t\treturn selected[0];\n\t}\n\n\tshowVariablesPopup(event: Event): void\n\t{\n\t\tconst menuItems = [];\n\n\t\tthis.variables.map((data) => {\n\t\t\tmenuItems.push({\n\t\t\t\tid: data.id,\n\t\t\t\ttext: data.title,\n\t\t\t\tonclick: this.select.bind(this),\n\t\t\t});\n\t\t});\n\n\t\tPopupMenu.show(\n\t\t\t'ui-access-rights-column-item-popup-variables',\n\t\t\tevent.target,\n\t\t\tmenuItems,\n\t\t\t{\n\t\t\t\tautoHide: true,\n\t\t\t\tevents : {\n\t\t\t\t\tonPopupClose: () => {\n\t\t\t\t\t\tPopupMenu.destroy('ui-access-rights-column-item-popup-variables');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t}\n\n\tselect(event: BaseEvent, item: MenuItem)\n\t{\n\t\tthis.selectedValues = [item.id];\n\n\t\titem\n\t\t\t.getMenuWindow()\n\t\t\t?.close()\n\t\t;\n\n\t\tthis.getChanger().innerHTML = '';\n\t\tthis.render();\n\t\tthis.adjustChanger();\n\n\t\tEventEmitter.emit('BX.UI.AccessRights.ColumnItem:selectAccessItems', this);\n\t\tEventEmitter.emit('BX.UI.AccessRights.ColumnItem:update', this);\n\t}\n}\n","import {Tag, Text} from \"main.core\";\nimport Title from \"./title\";\n\nexport default class UserGroupTitle extends Title\n{\n\tstatic TYPE = 'userGroupTitle';\n\n\trender(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div \n\t\t\t\tclass='ui-access-rights-column-item-text'\n\t\t\t\tdata-id='${this.getId()}'\n\t\t\t>\n\t\t\t\t${Text.encode(this.text)}\n\t\t\t</div>\n\t\t`;\n\t}\n}","import {DefaultFooter, Dialog, Item} from 'ui.entity-selector';\nimport {Dom, Loc, Tag, Event} from 'main.core';\n\nexport default class Footer extends DefaultFooter\n{\n\tconstructor(dialog: Dialog, options: { [option: string]: any })\n\t{\n\t\tsuper(dialog, options);\n\n\t\tthis.selectAllButton = Tag.render`<div class=\"ui-selector-footer-link ui-selector-search-footer-label--hide\">${Loc.getMessage('JS_UI_ACCESSRIGHTS_ALL_SELECT_LABEL')}</div>`;\n\t\tEvent.bind(this.selectAllButton, 'click', this.selectAll.bind(this));\n\t\tthis.deselectAllButton = Tag.render`<div class=\"ui-selector-footer-link ui-selector-search-footer-label--hide\">${Loc.getMessage('JS_UI_ACCESSRIGHTS_ALL_DESELECT_LABEL')}</div>`;\n\t\tEvent.bind(this.deselectAllButton, 'click', this.deselectAll.bind(this));\n\n\t\tthis.getDialog().subscribe('Item:onSelect', this.onItemStatusChange.bind(this));\n\t\tthis.getDialog().subscribe('Item:onDeselect', this.onItemStatusChange.bind(this));\n\t}\n\n\tgetContent(): HTMLElement\n\t{\n\t\tthis.toggleSelectButtons();\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"ui-selector-search-footer-box\">\n\t\t\t\t${this.selectAllButton}\n\t\t\t\t${this.deselectAllButton}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\ttoggleSelectButtons(): void\n\t{\n\t\tif (this.getDialog().getSelectedItems().length === this.getDialog().getItems().length)\n\t\t{\n\t\t\tif (Dom.hasClass(this.deselectAllButton, 'ui-selector-search-footer-label--hide'))\n\t\t\t{\n\t\t\t\tDom.addClass(this.selectAllButton, 'ui-selector-search-footer-label--hide');\n\t\t\t\tDom.removeClass(this.deselectAllButton, 'ui-selector-search-footer-label--hide');\n\t\t\t}\n\t\t}\n\t\telse if (Dom.hasClass(this.selectAllButton, 'ui-selector-search-footer-label--hide'))\n\t\t{\n\t\t\tDom.addClass(this.deselectAllButton, 'ui-selector-search-footer-label--hide');\n\t\t\tDom.removeClass(this.selectAllButton, 'ui-selector-search-footer-label--hide');\n\t\t}\n\t}\n\n\tselectAll(): void\n\t{\n\t\tif (this.getDialog().getSelectedItems().length === this.getDialog().getItems().length)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis\n\t\t\t.getDialog()\n\t\t\t.getItems()\n\t\t\t.forEach((item: Item) => {\n\t\t\t\titem.select();\n\t\t\t})\n\t\t;\n\t}\n\n\tdeselectAll(): void\n\t{\n\t\tthis\n\t\t\t.getDialog()\n\t\t\t.getSelectedItems()\n\t\t\t.forEach((item: Item) => {\n\t\t\t\titem.deselect();\n\t\t\t})\n\t\t;\n\t}\n\n\tonItemStatusChange(): void\n\t{\n\t\tthis.toggleSelectButtons();\n\t}\n}","import ColumnItemOptions from \"../../columnitem\";\nimport {Event, Text, Tag, Dom, Type, Loc} from 'main.core';\nimport {Dialog, Item} from 'ui.entity-selector';\n\nimport Changer from \"../changer\";\nimport {EventEmitter} from \"main.core.events\";\nimport Footer from \"./footer\";\nimport 'ui.hint';\n\ntype VariableItem = {\n\tid: number,\n\ttitle: string,\n}\n\nexport default class MultiSelector extends Changer\n{\n\tstatic TYPE = 'multivariables';\n\n\tconstructor(options: ColumnItemOptions)\n\t{\n\t\tsuper(options);\n\t\tthis.variables = options.variables || [];\n\t\tthis.enableSearch = options.enableSearch ?? false;\n\t\tthis.placeholder = options.placeholder || '';\n\t\tthis.hintTitle = options.hintTitle || '';\n\t\tthis.allSelectedCode = Text.toNumber(options.allSelectedCode || -1);\n\t\tthis.showAvatars = options.showAvatars ?? true;\n\t\tthis.compactView = options.compactView ?? false;\n\t\tthis.currentValue = Type.isArray(options.currentValue) ? options.currentValue : [];\n\t\tthis.currentValue = this.currentValue.map(value => Text.toNumber(value));\n\t\tthis.selectedValues = this.currentValue;\n\n\t\tthis.variables = this.variables.map((item) => {\n\t\t\titem.entityId = item.entityId || 'editor-right-item';\n\t\t\titem.tabs = 'recents';\n\t\t\treturn item;\n\t\t});\n\n\t\tthis.selector = this.createSelector();\n\t}\n\n\tbindEvents()\n\t{\n\t\tEventEmitter.subscribe('BX.UI.AccessRights:reset', this.reset.bind(this));\n\t\tEventEmitter.subscribe('BX.UI.AccessRights:refresh', this.refresh.bind(this));\n\t}\n\n\tcreateSelector(): Dialog\n\t{\n\t\treturn new Dialog({\n\t\t\theight: 300,\n\t\t\tid: this.getId(),\n\t\t\tcontext: 'editor-right-items',\n\t\t\tenableSearch: this.enableSearch,\n\t\t\tmultiple: true,\n\t\t\tdropdownMode: true,\n\t\t\tcompactView: this.compactView,\n\t\t\tshowAvatars: this.showAvatars,\n\t\t\tselectedItems: this.getSelected(),\n\t\t\tsearchOptions: {\n\t\t\t\tallowCreateItem: false\n\t\t\t},\n\t\t\tevents: {\n\t\t\t\t'Item:onSelect': this.setSelectedInputs.bind(this),\n\t\t\t\t'Item:onDeselect': this.setSelectedInputs.bind(this),\n\t\t\t},\n\t\t\tentities: [\n\t\t\t\t{\n\t\t\t\t\tid: 'editor-right-item',\n\t\t\t\t}\n\t\t\t],\n\t\t\titems: this.variables,\n\t\t\tfooter: Footer,\n\t\t});\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tlet title = '';\n\t\tif (this.includesSelected(this.allSelectedCode))\n\t\t{\n\t\t\ttitle = Loc.getMessage('JS_UI_ACCESSRIGHTS_ALL_ACCEPTED');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst titles = [];\n\t\t\tthis.getSelected()?.forEach((item) => {\n\t\t\t\ttitles.push(item.title)\n\t\t\t});\n\n\t\t\tif (titles.length > 0 )\n\t\t\t{\n\t\t\t\tconst firstItem = titles[0];\n\t\t\t\ttitle =\n\t\t\t\t\ttitles.length - 1 > 0\n\t\t\t\t\t\t? Loc.getMessage(\n\t\t\t\t\t\t\t'JS_UI_ACCESSRIGHTS_HAS_SELECTED_ITEMS',\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t'#FIRST_ITEM_NAME#':\n\t\t\t\t\t\t\t\t\tfirstItem.length > 10\n\t\t\t\t\t\t\t\t\t\t? firstItem.slice(0, 10) + '...'\n\t\t\t\t\t\t\t\t\t\t: firstItem\n\t\t\t\t\t\t\t\t,\n\t\t\t\t\t\t\t\t'#COUNT_REST_ITEMS#': titles.length - 1,\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t)\n\t\t\t\t\t\t: firstItem\n\t\t\t\t;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\ttitle = Loc.getMessage('JS_UI_ACCESSRIGHTS_ADD');\n\t\t\t}\n\t\t}\n\n\t\tlet hint = '';\n\t\tif (this.selector.getSelectedItems().length > 0)\n\t\t{\n\t\t\tconst hintTitle =\n\t\t\t\tType.isStringFilled(this.hintTitle)\n\t\t\t\t\t? this.hintTitle\n\t\t\t\t\t: Loc.getMessage('JS_UI_ACCESSRIGHTS_SELECTED_ITEMS_TITLE')\n\t\t\t;\n\t\t\thint += '<p>' + hintTitle + ':</p>';\n\t\t\thint += '<ul>';\n\t\t\tthis.selector.getSelectedItems().forEach((item: Item) => hint += '<li>' + Text.encode(item.getTitle()))\n\t\t\thint += '</ul>';\n\t\t}\n\n\t\tconst variablesValue = Tag.render`\n\t\t\t\t<div class='ui-access-rights-column-item-text-link' data-hint-html data-hint-no-icon data-hint=\"${Text.encode(hint)}\">\n\t\t\t\t\t${Text.encode(title)}\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\tEvent.bind(variablesValue, 'click', this.showSelector.bind(this));\n\n\t\tDom.append(variablesValue, this.getChanger());\n\n\t\tBX.UI.Hint.init(this.getChanger());\n\t\treturn this.getChanger();\n\t}\n\n\trefresh(): HTMLElement\n\t{\n\t\tif (this.isModify)\n\t\t{\n\t\t\tthis.currentValue = this.selectedValues;\n\t\t\tthis.reset();\n\t\t}\n\t}\n\n\treset(): HTMLElement\n\t{\n\t\tif (this.isModify)\n\t\t{\n\t\t\tthis.selectedValues = this.currentValue;\n\t\t\tthis.selector = this.createSelector();\n\t\t\tthis.getChanger().innerHTML = '';\n\t\t\tthis.adjustChanger();\n\t\t\tthis.render();\n\t\t}\n\t}\n\n\tgetSelected(): ?VariableItem[]\n\t{\n\t\tif (this.includesSelected(this.allSelectedCode))\n\t\t{\n\t\t\treturn this.variables;\n\t\t}\n\n\t\treturn this.variables.filter(variable => this.includesSelected(variable.id));\n\t}\n\n\tincludesSelected(item): boolean\n\t{\n\t\treturn this.selectedValues.includes(Text.toNumber(item));\n\t}\n\n\tshowSelector(event: Event): void\n\t{\n\t\tthis.selector.show();\n\t}\n\n\tsetSelectedInputs(): void\n\t{\n\t\tconst selected = this.selector.getSelectedItems();\n\t\tthis.selectedValues = [];\n\t\tif (selected.length === this.variables.length)\n\t\t{\n\t\t\tthis.selectedValues.push(this.allSelectedCode);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tselected.forEach((item) => {\n\t\t\t\tthis.selectedValues.push(Text.toNumber(item.id));\n\t\t\t});\n\t\t}\n\n\t\tthis.getChanger().innerHTML = '';\n\t\tif (!this.isModify)\n\t\t{\n\t\t\tthis.adjustChanger();\n\t\t}\n\n\t\tthis.render();\n\n\t\tEventEmitter.emit('BX.UI.AccessRights.ColumnItem:update', this);\n\t\tEventEmitter.emit('BX.UI.AccessRights.ColumnItem:selectAccessItems', this);\n\t}\n}\n","import Column from \"./column\";\nimport Grid from \"./grid\";\nimport {Dom, Reflection, Tag} from 'main.core';\nimport Title from './item/title';\nimport Hint from './item/hint';\nimport Member from './item/member';\nimport Role from './item/role';\nimport Toggler from './item/toggler';\nimport Controller from './item/controller';\nimport VariableSelector from './item/variableselector';\nimport UserGroupTitle from './item/usergrouptitle';\nimport MultiSelector from \"./item/multivariable/multiselector\";\n\ntype ColumnItemOptions = {\n\tgrid: Grid;\n\tid: number;\n\ttype: string;\n\ttext: string;\n\tplaceholder: string;\n\thintTitle: string;\n\thint: string;\n\tvariables: [];\n\tenableSearch: boolean;\n\tshowAvatars: boolean;\n\tcompactView: boolean;\n\tuserGroup: null;\n\taccess: null;\n\tcurrentValue: null;\n\tcontroller: null;\n\topenPopupEvent: null;\n\tpopupContainer: null;\n\taccessCodes: null;\n\tallSelectedCode: number;\n\tcontainer: HTMLElement;\n\tcolumn: Column;\n};\n\nexport default class ColumnItem {\n\tconstructor(options: ColumnItemOptions)\n\t{\n\t\tthis.options = options;\n\t\tthis.type = options.type ? options.type : null;\n\t\tthis.hint = options.hint ? options.hint : null;\n\t\tthis.controller = options.controller ? options.controller : null;\n\t\tthis.column = options.column;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tlet item = null;\n\t\tconst container = Tag.render`<div class='ui-access-rights-column-item'></div>`;\n\t\tthis.options.container = container;\n\t\tif (this.type === Role.TYPE)\n\t\t{\n\t\t\titem = new Role(this.options);\n\t\t\tif (this.column.newColumn)\n\t\t\t{\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\titem.onRoleEditMode();\n\t\t\t\t\titem.roleInput.value = '';\n\t\t\t\t})\n\t\t\t}\n\t\t}\n\t\telse if (this.type === Member.TYPE)\n\t\t{\n\t\t\titem = new Member(this.options);\n\t\t}\n\t\telse if (this.type === Title.TYPE)\n\t\t{\n\t\t\titem = new Title(this.options);\n\t\t}\n\t\telse if (this.type === VariableSelector.TYPE)\n\t\t{\n\t\t\titem = new VariableSelector(this.options);\n\t\t}\n\t\telse if (this.type === MultiSelector.TYPE)\n\t\t{\n\t\t\titem = new MultiSelector(this.options);\n\t\t}\n\t\telse if (this.type === Toggler.TYPE)\n\t\t{\n\t\t\titem = new Toggler(this.options);\n\t\t}\n\n\t\tif (item)\n\t\t{\n\t\t\tDom.append(item.render(), container);\n\t\t}\n\n\t\tif (this.hint)\n\t\t{\n\t\t\tconst hintOptions = {\n\t\t\t\tclassName: 'ui-access-rights-column-item-notify',\n\t\t\t\t...this.options\n\t\t\t};\n\t\t\tDom.append((new Hint(hintOptions)).render(), container);\n\t\t}\n\n\t\tif (this.type === UserGroupTitle.TYPE)\n\t\t{\n\t\t\tDom.append((new UserGroupTitle(this.options)).render(), container);\n\t\t}\n\n\t\tif (this.controller)\n\t\t{\n\t\t\tDom.append((new Controller(this.options)).render(), container);\n\t\t}\n\n\t\treturn container;\n\t}\n}\n\nconst namespace = Reflection.namespace('BX.UI.AccessRights');\nnamespace.ColumnItem = ColumnItem;\n","import {EventEmitter} from \"main.core.events\";\nimport {Dom, Event, Reflection, Tag} from 'main.core';\n\nimport Section from \"./section\";\nimport ColumnItem from \"./columnitem\";\nimport Role from \"./item/role\";\nimport Member from \"./item/member\";\nimport Title from \"./item/title\";\nimport UserGroupTitle from \"./item/usergrouptitle\";\nimport Toggler from \"./item/toggler\";\nimport VariableSelector from \"./item/variableselector\";\nimport MultiSelector from \"./item/multivariable/multiselector\";\n\ntype ColumnOptions = {\n\tgrid: Grid;\n\titems: [];\n\tuserGroup: [];\n\taccessCodes: [];\n\tsection: Section;\n\theadSection: Section;\n\tnewColumn: Column;\n\topenPopupEvent: string;\n\tpopupContainer: HTMLElement;\n};\n\nexport default class Column {\n\tconstructor(options: ColumnOptions)\n\t{\n\t\tthis.layout = {\n\t\t\tcontainer: null\n\t\t};\n\t\tthis.grid = options.grid ? options.grid : null;\n\t\tthis.items = options.items ? options.items : [];\n\t\tthis.userGroup = options.userGroup ? options.userGroup : null;\n\t\tthis.accessCodes = options.accessCodes ? options.accessCodes : null;\n\t\tthis.section = options.section ? options.section : null;\n\t\tthis.headSection = options.headSection;\n\t\tthis.newColumn = options.newColumn ? options.newColumn : null;\n\t\tthis.openPopupEvent = options.grid.openPopupEvent ? options.grid.openPopupEvent : null;\n\t\tthis.popupContainer = options.grid.popupContainer ? options.grid.popupContainer : null;\n\t}\n\n\tgetItem(options): ColumnItem\n\t{\n\t\toptions = options || {};\n\n\t\tlet param = {};\n\n\t\tif (options.type === UserGroupTitle.TYPE)\n\t\t{\n\t\t\tparam = {\n\t\t\t\ttype: options.type,\n\t\t\t\ttext: options.title,\n\t\t\t\tcontroller: options.controller\n\t\t\t}\n\t\t}\n\n\t\tif (options.type === Title.TYPE)\n\t\t{\n\t\t\tparam = {\n\t\t\t\tid: options.id,\n\t\t\t\ttype: options.type,\n\t\t\t\thint: options.hint,\n\t\t\t\ttext: options.title,\n\t\t\t\tcontroller: options.controller\n\t\t\t}\n\t\t}\n\n\t\tif (options.type === Toggler.TYPE)\n\t\t{\n\t\t\tparam = {\n\t\t\t\ttype: options.type,\n\t\t\t\taccess: options.access\n\t\t\t}\n\t\t}\n\n\t\tif (options.type === VariableSelector.TYPE || options.type === MultiSelector.TYPE)\n\t\t{\n\t\t\tparam = {\n\t\t\t\ttype: options.type,\n\t\t\t\ttext: options.title,\n\t\t\t\tvariables: options.variables,\n\t\t\t\taccess: options.access\n\t\t\t}\n\t\t}\n\n\t\tif (options.type === MultiSelector.TYPE)\n\t\t{\n\t\t\tparam.allSelectedCode = options.allSelectedCode;\n\t\t\tparam.enableSearch = options.enableSearch;\n\t\t\tparam.showAvatars = options.showAvatars;\n\t\t\tparam.compactView = options.compactView;\n\t\t\tparam.hintTitle = options.hintTitle;\n\t\t}\n\n\t\tif (options.type === Role.TYPE)\n\t\t{\n\t\t\tparam = {\n\t\t\t\ttype: options.type,\n\t\t\t\ttext: options.title\n\t\t\t}\n\t\t}\n\n\t\tif (options.type === Member.TYPE)\n\t\t{\n\t\t\tconst accessCodes = [];\n\n\t\t\tfor (const item in options.members)\n\t\t\t{\n\t\t\t\taccessCodes[item] = options.members[item].type;\n\t\t\t}\n\n\t\t\tparam = {\n\t\t\t\ttype: options.type,\n\t\t\t\taccessCodes: accessCodes\n\t\t\t}\n\t\t}\n\n\t\tparam.column = this;\n\t\tparam.userGroup = this.userGroup;\n\t\tparam.openPopupEvent = this.openPopupEvent;\n\t\tparam.popupContainer = this.popupContainer;\n\t\tparam.currentValue = null;\n\n\t\tparam.grid = this.grid;\n\n\t\tif (\n\t\t\toptions.type === VariableSelector.TYPE\n\t\t\t|| options.type === MultiSelector.TYPE\n\t\t\t|| options.type === Toggler.TYPE\n\t\t)\n\t\t{\n\t\t\tconst accessId = param.access.id.toString();\n\t\t\tconst accessRights = param.userGroup?.accessRights ?? [];\n\n\t\t\tfor (let i = 0; i < accessRights.length; i++)\n\t\t\t{\n\t\t\t\tif (accessId === accessRights[i].id.toString())\n\t\t\t\t{\n\t\t\t\t\tif (options.type === MultiSelector.TYPE)\n\t\t\t\t\t{\n\t\t\t\t\t\tparam.currentValue = param.currentValue ?? [];\n\t\t\t\t\t\tparam.currentValue.push(accessRights[i].value);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tparam.currentValue = accessRights[i].value;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn new ColumnItem(param);\n\t}\n\n\tgetUserGroup(): []\n\t{\n\t\treturn this.userGroup;\n\t}\n\n\tremove(): void\n\t{\n\t\tif (Dom.hasClass(this.layout.container, 'ui-access-rights-column-new'))\n\t\t{\n\t\t\tthis.resetClassNew();\n\t\t}\n\n\t\tDom.addClass(this.layout.container,'ui-access-rights-column-remove')\n\t\tDom.style(this.layout.container, 'width', this.layout.container.offsetWidth + 'px')\n\n\t\tEvent.bind(this.layout.container, 'animationend', () => {\n\t\t\tDom.style(this.layout.container, 'minWidth', '0px')\n\t\t\tDom.style(this.layout.container, 'maxWidth', '0px')\n\t\t});\n\n\n\t\tsetTimeout(() => {\n\t\t\tDom.remove(this.layout.container);\n\t\t}, 500);\n\t}\n\n\tresetClassNew(): void\n\t{\n\t\tDom.removeClass(this.layout.container,'ui-access-rights-column-new');\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tif (!this.layout.container)\n\t\t{\n\t\t\tconst itemsFragment = document.createDocumentFragment();\n\n\t\t\tif (this.headSection)\n\t\t\t{\n\t\t\t\tthis.userGroup.type = Role.TYPE;\n\t\t\t\tDom.append(this.getItem(this.userGroup).render(), itemsFragment);\n\n\t\t\t\tthis.userGroup.type = Member.TYPE;\n\t\t\t\tDom.append(this.getItem(this.userGroup).render(), itemsFragment);\n\t\t\t}\n\n\t\t\tthis.items.map(\n\t\t\t\t(data) => {\n\t\t\t\t\tconst item = this.getItem(data);\n\t\t\t\t\tDom.append(item.render(), itemsFragment);\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tthis.layout.container = Tag.render`<div class='ui-access-rights-column'></div>`;\n\t\t\tif (this.newColumn)\n\t\t\t{\n\t\t\t\tDom.addClass('ui-access-rights-column-new', this.layout.container)\n\t\t\t}\n\n\t\t\tEventEmitter.subscribe('BX.UI.AccessRights:refresh', this.resetClassNew.bind(this));\n\n\t\t\tDom.append(itemsFragment, this.layout.container);\n\n\t\t\treturn this.layout.container;\n\t\t}\n\t}\n}\n\nconst namespace = Reflection.namespace('BX.UI.AccessRights');\nnamespace.Column = Column;","import {EventEmitter, BaseEvent} from \"main.core.events\";\nimport {PopupMenu} from 'main.popup';\nimport {Dom, Event, Reflection, Text, Tag, Loc} from 'main.core';\nimport Grid from \"./grid\";\nimport Column from \"./column\";\nimport Title from \"./item/title\";\nimport UserGroupTitle from \"./item/usergrouptitle\";\nimport VariableSelector from \"./item/variableselector\";\nimport MultiSelector from \"./item/multivariable/multiselector\";\nimport Hint from \"./item/hint\";\n\ntype SectionOptions = {\n\tid: string;\n\theadSection: Section;\n\ttitle: string;\n\thint: string;\n\trights: [];\n\tuserGroups: [];\n\tgrid: Grid;\n};\n\nexport default class Section {\n\tconstructor(options: SectionOptions)\n\t{\n\t\tthis.id = options.id ?? null;\n\t\tthis.headSection = options.headSection ? options.headSection : null;\n\t\tthis.title = options.title;\n\t\tthis.hint = options.hint;\n\t\tthis.rights = options.rights ? options.rights : [];\n\t\tthis.userGroups = options.userGroups ? options.userGroups : [];\n\t\tthis.grid = options.grid ? options.grid : null;\n\n\t\tthis.layout = {\n\t\t\ttitle: null,\n\t\t\theadColumn: null,\n\t\t\tcolumns: null,\n\t\t\tcontent: null,\n\t\t\tearLeft: null,\n\t\t\tearRight: null\n\t\t};\n\n\t\tthis.scroll = 0;\n\t\tthis.earTimer = null;\n\t\tthis.earLeftTimer = null;\n\t\tthis.earRightTimer = null;\n\t\tthis.columns = [];\n\n\t\tthis.bindEvents();\n\t}\n\n\tbindEvents(): void\n\t{\n\t\tEventEmitter.subscribe(this.grid, 'AccessRights.Section:scroll', (event: BaseEvent) => {\n\t\t\tconst [object] = event.getData();\n\t\t\tif (this.title !== object.title)\n\t\t\t{\n\t\t\t\tthis.getColumnsContainer().scrollLeft = object.getScroll()\n\t\t\t}\n\t\t\tobject.adjustEars();\n\t\t\tPopupMenu.destroy('ui-access-rights-column-item-popup-variables');\n\t\t});\n\n\t\tEvent.bind(window, 'resize', this.adjustEars.bind(this));\n\t}\n\n\tgetGrid(): Grid\n\t{\n\t\treturn this.grid;\n\t}\n\n\taddColumn(param): void\n\t{\n\t\tif(!param)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst options = Object.assign({}, param);\n\t\toptions.userGroup = param;\n\t\tconst column = this.getColumn(options);\n\n\t\tDom.append(column.render(), this.layout.columns)\n\t\tthis.columns.push(column);\n\t}\n\n\tgetColumn(options): Column\n\t{\n\t\tconst controls = [];\n\n\t\tthis.rights.map(\n\t\t\t(data) => {\n\t\t\t\tconst isVariable = (data.type === VariableSelector.TYPE || data.type === MultiSelector.TYPE);\n\n\t\t\t\tcontrols.push({\n\t\t\t\t\ttype: data.type,\n\t\t\t\t\ttitle: isVariable ? data.title : null,\n\t\t\t\t\thint: data.hint,\n\t\t\t\t\tvariables: isVariable ? data.variables : [],\n\t\t\t\t\tenableSearch: isVariable ? data.enableSearch : null,\n\t\t\t\t\tshowAvatars: isVariable ? data.showAvatars : false,\n\t\t\t\t\tcompactView: isVariable ? data.compactView : false,\n\t\t\t\t\thintTitle: isVariable ? data.hintTitle : null,\n\t\t\t\t\tallSelectedCode: isVariable ? data.allSelectedCode : null,\n\t\t\t\t\taccess: data\n\t\t\t\t})\n\t\t\t}\n\t\t);\n\n\t\treturn new Column({\n\t\t\titems: controls,\n\t\t\tuserGroup: options.userGroup ? options.userGroup : null,\n\t\t\tsection: this,\n\t\t\theadSection: options.headSection,\n\t\t\tgrid: this.grid,\n\t\t\tnewColumn: options.newColumn ? options.newColumn : null\n\t\t});\n\t}\n\n\tremoveColumn(param): void\n\t{\n\t\tif (!param)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tfor (let i = 0; i < this.columns.length; i++)\n\t\t{\n\t\t\tif (param.userGroup === this.columns[i].userGroup)\n\t\t\t{\n\t\t\t\tthis.columns[i].remove();\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\taddHeadColumn(): Column\n\t{\n\t\tlet titles = [];\n\n\t\tif(!this.headSection)\n\t\t{\n\t\t\tthis.rights.map((data) => {\n\t\t\t\ttitles.push({\n\t\t\t\t\tid: data.id,\n\t\t\t\t\ttype: Title.TYPE,\n\t\t\t\t\ttitle: data.title,\n\t\t\t\t\thint: data.hint\n\t\t\t\t})\n\t\t\t});\n\t\t}\n\n\t\tif (this.headSection)\n\t\t{\n\t\t\ttitles = [\n\t\t\t\t{\n\t\t\t\t\ttype: UserGroupTitle.TYPE,\n\t\t\t\t\ttitle: Loc.getMessage('JS_UI_ACCESSRIGHTS_ROLES'),\n\t\t\t\t\tcontroller: true\n\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttype: UserGroupTitle.TYPE,\n\t\t\t\t\ttitle: Loc.getMessage('JS_UI_ACCESSRIGHTS_EMPLOYEES_AND_DEPARTMENTS'),\n\t\t\t\t\tcontroller: false\n\t\t\t\t}\n\t\t\t]\n\t\t}\n\n\t\tconst column = new Column({\n\t\t\titems: titles,\n\t\t\tsection: this,\n\t\t\tgrid: this.grid\n\t\t});\n\n\t\tDom.append(column.render(), this.layout.headColumn);\n\n\t\treturn column;\n\t}\n\n\tgetColumnsContainer(): HTMLElement\n\t{\n\t\tif (!this.layout.columns)\n\t\t{\n\t\t\tconst column = Tag.render`<div class='ui-access-rights-section-wrapper'></div>`;\n\t\t\tEvent.bind(column, 'scroll', this.adjustScroll.bind(this));\n\t\t\tthis.layout.columns = column;\n\t\t}\n\n\t\treturn this.layout.columns;\n\t}\n\n\tgetTitleNode(): HTMLElement\n\t{\n\t\tconst node = Tag.render`<div class='ui-access-rights-section-title'>${Text.encode(this.title)}</div>`;\n\n\t\tif (this.hint)\n\t\t{\n\t\t\tconst hintNode = new Hint({\n\t\t\t\thint: this.hint,\n\t\t\t\tclassName: 'ui-access-rights-section-title-hint'\n\t\t\t});\n\t\t\tnode.appendChild(hintNode.render());\n\t\t}\n\n\t\treturn node;\n\t}\n\n\tadjustScroll(): void\n\t{\n\t\tif (Text.toNumber(this.scroll) !== Text.toNumber(this.getColumnsContainer().scrollLeft))\n\t\t{\n\t\t\tthis.scroll = this.getColumnsContainer().scrollLeft;\n\t\t\tEventEmitter.emit(this.grid, \"AccessRights.Section:scroll\", [this]);\n\t\t}\n\t}\n\n\tadjustEars(): void\n\t{\n\t\tconst container = this.getColumnsContainer();\n\t\tconst scroll = container.scrollLeft;\n\n\t\tconst isLeftVisible = scroll > 0;\n\t\tconst isRightVisible = container.scrollWidth > (Math.round(scroll + container.offsetWidth));\n\n\t\tthis.getContentContainer().classList[isLeftVisible ? 'add' : 'remove']('ui-access-rights-section-ear-left-shown');\n\t\tthis.getContentContainer().classList[isRightVisible ? 'add' : 'remove']('ui-access-rights-section-ear-right-shown');\n\t}\n\n\tgetContentContainer(): HTMLElement\n\t{\n\t\tif (!this.layout.content)\n\t\t{\n\t\t\tthis.layout.content = Tag.render`\n\t\t\t\t<div class='ui-access-rights-section-content'>\n\t\t\t\t\t${this.getColumnsContainer()}\n\t\t\t\t\t${this.getEarLeft()}\n\t\t\t\t\t${this.getEarRight()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.layout.content;\n\t}\n\n\tgetEarLeft(): HTMLElement\n\t{\n\t\tif (!this.layout.earLeft)\n\t\t{\n\t\t\tthis.layout.earLeft = Tag.render`<div class='ui-access-rights-section-ear-left'></div>`;\n\t\t\tEvent.bind(this.layout.earLeft, 'mouseenter', () => {\n\t\t\t\tthis.stopAutoScroll();\n\t\t\t\tthis.earLeftTimer =\tsetTimeout(\n\t\t\t\t\t() => {\n\t\t\t\t\t\tthis.scrollToLeft()\n\t\t\t\t\t},\n\t\t\t\t\t110\n\t\t\t\t);\n\t\t\t});\n\n\t\t\tEvent.bind(this.layout.earLeft, 'mouseleave', () => {\n\t\t\t\tclearTimeout(this.earLeftTimer);\n\t\t\t\tthis.stopAutoScroll()\n\t\t\t});\n\t\t}\n\n\t\treturn this.layout.earLeft;\n\t}\n\n\tgetEarRight(): HTMLElement\n\t{\n\t\tif (!this.layout.earRight)\n\t\t{\n\t\t\tthis.layout.earRight = Tag.render`<div class='ui-access-rights-section-ear-right'></div>`;\n\t\t\tEvent.bind(this.layout.earRight, 'mouseenter', () => {\n\t\t\t\tthis.stopAutoScroll();\n\t\t\t\tthis.earRightTimer = setTimeout(\n\t\t\t\t\t() => {\n\t\t\t\t\t\tthis.scrollToRight()\n\t\t\t\t\t},\n\t\t\t\t\t110\n\t\t\t\t);\n\t\t\t});\n\n\t\t\tEvent.bind(this.layout.earRight, 'mouseleave', () => {\n\t\t\t\tclearTimeout(this.earRightTimer);\n\t\t\t\tthis.stopAutoScroll()\n\t\t\t});\n\t\t}\n\n\t\treturn this.layout.earRight;\n\t}\n\n\tscrollToRight(param: number, stop): void\n\t{\n\t\tconst interval = param ? 2 : 20;\n\n\t\tthis.earTimer = setInterval(\n\t\t\t() => {\n\t\t\t\tthis.getColumnsContainer().scrollLeft += 10;\n\t\t\t\tif(param && param <= this.getColumnsContainer().scrollLeft)\n\t\t\t\t{\n\t\t\t\t\t this.stopAutoScroll();\n\t\t\t\t}\n\t\t\t},\n\t\t\tinterval\n\t\t);\n\n\t\tif(stop === 'stop')\n\t\t{\n\t\t\tsetTimeout(\n\t\t\t\t() => {\n\t\t\t\t\tthis.stopAutoScroll();\n\t\t\t\t\tthis.getGrid().unlock();\n\t\t\t\t},\n\t\t\t\tparam * 2\n\t\t\t)\n\t\t}\n\t}\n\n\tscrollToLeft(): void\n\t{\n\t\tthis.earTimer = setInterval(\n\t\t\t() => {\n\t\t\t\tthis.getColumnsContainer().scrollLeft -= 10;\n\t\t\t},\n\t\t\t20\n\t\t)\n\t}\n\n\tstopAutoScroll(): void\n\t{\n\t\tclearInterval(this.earTimer);\n\t}\n\n\tgetScroll(): number\n\t{\n\t\treturn this.scroll;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tconst title = this.title ? this.getTitleNode() : null;\n\n\t\tconst sectionContainer = Tag.render`\n\t\t\t<div class='ui-access-rights-section'>\n\t\t\t\t${title}\n\t\t\t\t${this.getMainContainer()}\n\t\t\t</div>\n\t\t`;\n\n\t\tif (this.headSection)\n\t\t{\n\t\t\tDom.addClass(sectionContainer, 'ui-access-rights--head-section')\n\t\t}\n\n\t\tthis.addHeadColumn();\n\n\t\tconst columnsFragment = document.createDocumentFragment();\n\n\t\tconst userGroups = this.grid.getUserGroups() ?? [];\n\t\tfor (let i = 0; i < userGroups.length; i++)\n\t\t{\n\t\t\tconst column = this.getColumn(\n\t\t\t\t{\n\t\t\t\t\theadSection: this.headSection ? this.headSection : null,\n\t\t\t\t\tuserGroup: userGroups[i]\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tthis.columns.push(column);\n\t\t\tDom.append(column.render(), columnsFragment);\n\t\t}\n\n\t\tDom.append(columnsFragment, this.getColumnsContainer());\n\n\t\treturn sectionContainer;\n\t}\n\n\tgetMainContainer(): HTMLElement\n\t{\n\t\tthis.layout.headColumn = Tag.render`<div class='ui-access-rights-section-head'></div>`;\n\t\treturn Tag.render`\n\t\t\t<div class='ui-access-rights-section-container'>\n\t\t\t\t${this.layout.headColumn}\n\t\t\t\t${this.getContentContainer()}\n\t\t\t</div>\n\t\t`;\n\t}\n}\n\nconst namespace = Reflection.namespace('BX.UI.AccessRights');\nnamespace.Section = Section;\n"],"names":["BX","Reflection","namespace","Grid","options","renderTo","buttonPanel","UI","ButtonPanel","layout","container","component","actionSave","ACTION_SAVE","actionDelete","ACTION_DELETE","actionLoad","ACTION_LOAD","mode","MODE","openPopupEvent","popupContainer","additionalSaveParams","loadParams","loader","timer","initData","userGroups","accessRights","isRequested","loadData","bindEvents","EventEmitter","subscribe","updateRole","bind","updateAccessVariationRight","updateAccessRight","adjustButtonPanel","addUserGroup","addRoleColumn","removeRoleColumn","onGetEntityTypes","accessRightsSections","headSection","members","columns","emit","title","Notification","Center","notify","content","position","autoHideDelay","setTimeout","blockGrid","needReload","dataToSave","i","length","Text","toNumber","id","push","accessCodes","type","ajax","runComponentAction","data","parameters","then","reloadGrid","showNotification","Loc","getMessage","unBlockGrid","fireEventRefresh","clearTimeout","waitContainer","getContainer","querySelector","Dom","removeClass","addClass","getMainContainer","roleId","response","ACCESS_RIGHTS","USER_GROUPS","draw","offsetTop","getBoundingClientRect","top","style","getLoader","show","hide","Loader","target","param","removeColumn","map","targetIndex","indexOf","userGroup","splice","deleteActionRequest","event","getData","sections","newColumn","addColumn","scrollToRight","getColumnsContainer","scrollWidth","offsetWidth","item","index","text","modifiedItems","querySelectorAll","modifiedRoles","modifiedUsers","modifiedVariables","accessId","access","value","switcher","isChecked","deleteIds","forEach","values","selectedValues","addSection","user","Section","grid","hint","sectionHint","sectionTitle","rights","Tag","render","docFragmentSections","document","createDocumentFragment","append","getHeadSection","getSections","innerHTML","afterRender","adjustEars","params","option","buildOption","state","controls","Main","selectorManagerV2","selectorInstance","Object","keys","entityTypes","USERGROUPS","enableSearch","searchById","addTab","returnItemUrl","getOption","dataColumnAttribute","node","bindOptions","hasAttribute","Type","isUndefined","columnId","getAttribute","accessItem","entityType","accessCodesResult","AccessRights","Base","currentValue","identificator","Math","random","parentContainer","Title","getId","encode","Event","adjustPopupHelper","popupHelper","close","set","cloneNode","body","remove","getPopupHelper","PopupWindowManager","create","autoHide","darkMode","maxWidth","offsetLeft","animation","Hint","className","hintNode","hintManager","createInstance","popupParameters","angle","setAttribute","attributeName","attributeHtmlName","attributeInteractivityName","initNode","Member","addToAccessCodes","removeFromAccessCodes","resetNewMembers","member","membersFragment","counter","validateVariables","reverse","userNode","avatar","userAvatar","name","encodeURI","avatarClass","emptyAvatar","getAddUserToRole","adjustPopupUserControl","getMember","newMembers","getButtonPanel","firstKey","toUpperCase","entityId","url","toLowerCase","updateMembers","key","users","groups","departments","sonetgroups","counterUsers","showUserSelectorPopup","getUserPopup","addUserToRole","popupUsers","contentTitle","onTitleClick","activate","adjustSlicker","groupTitleItem","getUserPopupTogglerGroup","footer","footerLink","preventDefault","isDomNode","slicker","titles","contents","contentPadding","padding","offset","closeEsc","events","onPopupShow","firstActiveNode","onPopupClose","destroy","array","toggler","iconClass","removeButton","itemsSelected","onCustomEvent","bindNode","selectorId","selectedItems","Role","column","window","getRole","closest","offRoleEditMode","role","roleInput","keyCode","roleValue","editControl","onRoleEditMode","removeControl","showPopupConfirm","roleControlWrapper","focus","popupConfirm","width","overlay","setButtons","Button","click","getUserGroup","innerText","Changer","isModify","changer","offChanger","refreshStatus","getChanger","toggleClass","Toggler","Switcher","size","checked","handlers","unchecked","toggled","adjustChanger","check","getNode","Controller","controller","controllerLink","controllerMenu","popupMenu","getUserGroups","getPopupMenu","toggleControllerMenu","TYPE","lock","menuItems","onclick","accessRightsCopy","assign","accessCodesCopy","Menu","VariableSelector","variables","reset","refresh","getSelected","variablesValue","showVariablesPopup","selected","filter","variable","includes","select","PopupMenu","getMenuWindow","UserGroupTitle","Footer","dialog","selectAllButton","selectAll","deselectAllButton","deselectAll","getDialog","onItemStatusChange","toggleSelectButtons","getSelectedItems","getItems","hasClass","deselect","DefaultFooter","MultiSelector","placeholder","hintTitle","allSelectedCode","showAvatars","compactView","isArray","tabs","selector","createSelector","Dialog","height","context","multiple","dropdownMode","searchOptions","allowCreateItem","setSelectedInputs","entities","items","includesSelected","firstItem","slice","isStringFilled","getTitle","showSelector","init","ColumnItem","hintOptions","Column","section","toString","resetClassNew","itemsFragment","getItem","headColumn","earLeft","earRight","scroll","earTimer","earLeftTimer","earRightTimer","object","scrollLeft","getScroll","getColumn","isVariable","adjustScroll","appendChild","isLeftVisible","isRightVisible","round","getContentContainer","classList","getEarLeft","getEarRight","stopAutoScroll","scrollToLeft","stop","interval","setInterval","getGrid","unlock","clearInterval","getTitleNode","sectionContainer","addHeadColumn","columnsFragment"],"mappings":"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"}