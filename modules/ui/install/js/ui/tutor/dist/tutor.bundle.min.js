this.BX=this.BX||{};this.BX.UI=this.BX.UI||{};(function(t,e,i,n){"use strict";var o=function(t){babelHelpers.inherits(i,t);function i(t){var n;babelHelpers.classCallCheck(this,i);n=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(i).call(this));n.setEventNamespace("BX.UI.Tutor.Step");t=e.Type.isPlainObject(t)?t:{};n.id=t.id||null;n.title=t.title||null;n.description=t.description||null;n.url=t.url||"";n.isCompleted=t.isCompleted||false;n.video=t.video||null;n.helpLink=t.helpLink||null;n.highlight=t.highlight||null;n.isActive=t.isActive===true;n.isShownForSlider=t.isShownForSlider||false;n.initOptions=t;n.videoObj=null;return n}babelHelpers.createClass(i,[{key:"getTitle",value:function t(){return this.title}},{key:"getVideoObj",value:function t(){return this.videoObj}},{key:"getHighlightOptions",value:function t(){return this.highlight}},{key:"getDescription",value:function t(){return this.description}},{key:"getUrl",value:function t(){return this.url}},{key:"getCompleted",value:function t(){return this.isCompleted}},{key:"getVideo",value:function t(){return this.video}},{key:"getHelpLink",value:function t(){return this.helpLink}},{key:"getId",value:function t(){return this.id}},{key:"getInitOptions",value:function t(){return this.initOptions}},{key:"activate",value:function t(){this.isActive=true}},{key:"getShownForSlider",value:function t(){return this.isShownForSlider}},{key:"deactivate",value:function t(){this.isActive=false}}],[{key:"getFullEventName",value:function t(e){return e}}]);return i}(e.Event.EventEmitter);function s(){var t=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<div class="ui-tutor-popup-step-title"></div>\n\t\t\t\t']);s=function e(){return t};return t}function r(){var t=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<button class="ui-btn ui-btn-success ui-btn-round ui-btn-xs">\n\t\t\t\t\t\t',"\n\t\t\t\t\t</button>\n\t\t\t\t"]);r=function e(){return t};return t}function u(){var t=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<button class="ui-btn ui-btn-primary ui-btn-round ui-btn-xs">\n\t\t\t\t\t\t',"\n\t\t\t\t\t</button>\n\t\t\t\t"]);u=function e(){return t};return t}function a(){var t=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<button class="ui-btn ui-btn-primary ui-btn-round ui-btn-xs">\n\t\t\t\t\t\t',"\n\t\t\t\t\t</button>\n\t\t\t\t"]);a=function e(){return t};return t}function l(){var t=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<div class="ui-tutor-popup ui-tutor-popup-collapse" onclick="','">\n\t\t\t\t\t\t<div class="ui-tutor-popup-content">\n\t\t\t\t\t\t\t<div class="ui-tutor-popup-step-subject">',"</div>\n\t\t\t\t\t\t\t",'\n\t\t\t\t\t\t\t<div class="ui-tutor-popup-collapse-btn">\n\t\t\t\t\t\t\t\t',"\n\t\t\t\t\t\t\t\t","\n\t\t\t\t\t\t\t\t","\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t"]);l=function e(){return t};return t}function p(){var t=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<div class="ui-tutor-informer" id="ui-tutor-informer"></div>\n\t\t\t\t']);p=function e(){return t};return t}function h(){var t=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<button class="ui-btn ui-btn-link">\n\t\t\t\t\t\t',"\n\t\t\t\t\t</button>\n\t\t\t\t"]);h=function e(){return t};return t}function c(){var t=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<button class="ui-btn ui-btn-primary ui-btn-round">\n\t\t\t\t\t\t',"\n\t\t\t\t\t</button>\n\t\t\t\t"]);c=function e(){return t};return t}function d(){var t=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<div class="ui-tutor-popup ui-tutor-popup-start">\n\t\t\t\t\t\t<div class="ui-tutor-popup-header">\n\t\t\t\t\t\t\t<span class="ui-tutor-popup-header-icon"></span>\n\t\t\t\t\t\t\t<span class="ui-tutor-popup-header-title-wrap">\n\t\t\t\t\t\t\t\t<span class="ui-tutor-popup-header-title">','</span>\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="ui-tutor-popup-content">\n\t\t\t\t\t\t\t<div class="ui-tutor-popup-title">','</div>\n\t\t\t\t\t\t\t<div class="ui-tutor-popup-text">','</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="ui-tutor-popup-footer">\n\t\t\t\t\t\t\t<div class="ui-tutor-popup-btn">\n\t\t\t\t\t\t\t\t',"\n\t\t\t\t\t\t\t\t",'\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="ui-tutor-popup-icon-angle"></div>\n\t\t\t\t\t</div>\n\t\t\t\t']);d=function e(){return t};return t}function f(){var t=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<div class="ui-tutor-popup" onclick="','">\n\t\t\t\t\t\t<div class="ui-tutor-popup-header">\n\t\t\t\t\t\t\t<span class="ui-tutor-popup-header-icon"></span>\n\t\t\t\t\t\t\t<span class="ui-tutor-popup-header-title-wrap">\n\t\t\t\t\t\t\t\t<span class="ui-tutor-popup-header-title">','</span> \n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="ui-tutor-popup-content">\n\t\t\t\t\t\t\t<div class="ui-tutor-popup-text">','</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="ui-tutor-popup-icon-angle"></div>\n\t\t\t\t\t</div>\n\t\t\t\t']);f=function e(){return t};return t}function v(){var t=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<div class="ui-tutor-btn"></div>\n\t\t\t\t']);v=function e(){return t};return t}var g=function(t){babelHelpers.inherits(g,t);function g(){var t;babelHelpers.classCallCheck(this,g);t=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(g).call(this));t.setEventNamespace("BX.UI.Tutor.Manager");return t}babelHelpers.createClass(g,[{key:"setOptions",value:function t(i,n,o){i=i||{};this.tutorialData=i.tutorialData||{};this.eventService=i.eventService||{};this.lastCheckTime=i.lastCheckTime||0;this.domain=i.domain||"";this.feedbackFormId=i.feedbackFormId||"";if(e.Type.isString(n)&&n.length>0){this.domain=n}if(e.Type.isString(o)&&o.length>0){this.feedbackFormId=o}}},{key:"showFeedbackForm",value:function t(){if(this.feedbackFormId){this.feedBackForm=BX.UI.Feedback.Form.getById(this.feedbackFormId);if(this.feedBackForm){this.feedBackForm.openPanel()}}}},{key:"getDomain",value:function t(){return this.domain}},{key:"getCurrentTutorialData",value:function t(){return this.tutorialData}},{key:"getCurrentEventService",value:function t(){return this.eventService}},{key:"getCurrentLastCheckTime",value:function t(){return this.lastCheckTime}}],[{key:"getInstance",value:function t(){return this.instance}},{key:"getScenarioInstance",value:function t(){return this.scenarioInstance}},{key:"init",value:function t(e,i,n){var o=this.getInstance();if(!(o instanceof g)){this.instance=new g;o=this.getInstance();this.emit("onInitManager")}else{o=this.getInstance()}o.setOptions(e,i,n);return o}},{key:"initScenario",value:function t(e){var i=this.getScenarioInstance();if(!(i instanceof Y)){this.scenarioInstance=new Y;i=this.getScenarioInstance();this.emit("onInitScenario")}else{i=this.getScenarioInstance()}i.setOptions(e);return i}},{key:"showButton",value:function t(e){return this.getImButton(e)}},{key:"getRootImButton",value:function t(){return document.getElementById("ui-tutor-btn-wrap")}},{key:"hasImButton",value:function t(){return!!this.getRootImButton()}},{key:"getImButton",value:function t(i){var n=this;if(!this.layout.imButton){var o=this.getRootImButton();if(o){var s=e.Tag.render(v());if(i){e.Dom.addClass(o,"ui-tutor-btn-wrap-animate")}e.Dom.append(s,o);e.Dom.addClass(o,"ui-tutor-btn-wrap-show");this.layout.imButton=o;e.Event.bind(this.layout.imButton,"click",function(){n.emit("clickImButton")});var r=document.querySelector(".bx-im-users-wrap");if(document.querySelector("#bx-im-btn-call")){r.style.bottom="175px"}else{r.style.bottom="120px"}}}return this.layout.imButton}},{key:"showSmallPopup",value:function t(i){this.smallPopupText=i;this.getSmallPopup().style.display="block";this.smallPopupText="";if(e.Dom.hasClass(this.getSmallPopup(),"ui-tutor-popup-welcome-hide")){e.Dom.removeClass(this.getSmallPopup(),"ui-tutor-popup-welcome-hide")}}},{key:"hideSmallPopup",value:function t(i){i=i===true;var n=function(){e.Dom.remove(this.getSmallPopup());if(this.hasOwnProperty("smallPopup")){delete this.smallPopup}this.emit("onCompleteHideSmallPopup")}.bind(this);e.Dom.removeClass(this.getSmallPopup(),"ui-tutor-popup-welcome-show");e.Dom.addClass(this.getSmallPopup(),"ui-tutor-popup-welcome-hide");if(i){n()}else{setTimeout(n,300)}}},{key:"showWelcomePopup",value:function t(e){this.emit("onShowWelcomePopup");this.showSmallPopup(e)}},{key:"hideWelcomePopup",value:function t(){this.emit("onBeforeHideWelcomePopup");this.hideSmallPopup();this.emit("onAfterHideWelcomePopup")}},{key:"showNoticePopup",value:function t(e){this.emit("onShowNoticePopup");this.showSmallPopup(e)}},{key:"hideNoticePopup",value:function t(){this.emit("onBeforeHideNoticePopup");this.hideSmallPopup();this.emit("onAfterHideNoticePopup")}},{key:"getSmallPopup",value:function t(){var i=this;var n=function t(){i.emit("onClickSmallPopupBtn")};if(!this.smallPopup){this.smallPopup=e.Tag.render(f(),n.bind(this),e.Loc.getMessage("JS_UI_TUTOR_TITLE"),this.smallPopupText);this.emit("onCreateSmallPopupNode");e.Dom.addClass(this.smallPopup,"ui-tutor-popup-welcome-show");this.emit("onBeforeAppendSmallPopupNode");e.Dom.append(this.smallPopup,document.body);this.emit("onAfterAppendSmallPopupNode")}return this.smallPopup}},{key:"showStartPopup",value:function t(i,n){this.emit("onShowStartPopup");this.startTitle=i;this.startText=n;e.Dom.addClass(this.getStartPopup(),"ui-tutor-popup-show");this.startPopup.style.display="flex";this.startTitle="";this.startText=""}},{key:"closeStartPopup",value:function t(){e.Dom.remove(this.getStartPopup());delete this.startPopup}},{key:"getStartPopup",value:function t(){if(!this.startPopup){this.startPopup=e.Tag.render(d(),e.Loc.getMessage("JS_UI_TUTOR_TITLE"),this.startTitle,this.startText,this.getBeginBtn(),this.getDeferBtn());this.emit("onCreateStartPopupNode");e.Dom.append(this.startPopup,document.body);this.emit("onAfterAppendStartPopupNode")}return this.startPopup}},{key:"getBeginBtn",value:function t(){var i=this;if(!this.beginBtn){this.beginBtn=e.Tag.render(c(),e.Loc.getMessage("JS_UI_TUTOR_BTN_BEGIN"));e.Event.bind(this.beginBtn,"click",function(){i.emit("clickBeginBtn")})}return this.beginBtn}},{key:"getDeferBtn",value:function t(){var i=this;if(!this.deferBtn){this.deferBtn=e.Tag.render(h(),e.Loc.getMessage("JS_UI_TUTOR_CLOSE_POPUP_BTN"));e.Event.bind(this.deferBtn,"click",function(){i.emit("clickDeferBtn")})}return this.deferBtn}},{key:"getFullEventName",value:function t(e){return e}},{key:"getInformer",value:function t(){if(!this.informer){this.informer=e.Tag.render(p());var i=this.getImButton();if(this.isCollapsedShow){i=this.getCollapseBlock()}if(i){e.Dom.append(this.informer,i)}}return this.informer}},{key:"setCount",value:function t(e){this.emit("onBeforeSetCount");if(e<1){this.removeInformer();delete this.informer;this.isInformerShow=false}else{this.getInformer().textContent=e;this.isInformerShow=true}this.emit("onAfterSetCount")}},{key:"removeInformer",value:function t(){if(this.isInformerShow){e.Dom.remove(this.getInformer())}}},{key:"showCollapsedBlock",value:function t(i,n,s){n=n!==false;s=s!==false;this.emit("onBeforeShowCollapsedBlock");if(!this.isCollapsedShow){this.emit("onStartShowCollapsedBlock");if(!(i instanceof o)){i=new o(i)}this.collapsedStep=i;var r=this.getCollapseBlock();var u=function t(){r.style.display="flex"};if(s){setTimeout(u.bind(this),300)}else{u.call(this)}this.getCollapseTitle().innerHTML=i.getTitle();if(this.isInformerShow){e.Dom.append(this.getInformer(),r)}this.isCollapsedShow=true;this.emit("onShowCollapsedBlock")}if(n){this.showGuide()}else{this.checkButtonsState()}}},{key:"setCollapsedInvisible",value:function t(){this.hideNode(this.getCollapseBlock())}},{key:"setCollapsedVisible",value:function t(){this.showNode(this.getCollapseBlock())}},{key:"checkButtonsState",value:function t(){this.emit("onCheckButtonsState");var e=this.collapsedStep;if(!e){return}if(e.getCompleted()){if(this.activeGuide){this.hideNode(this.getRepeatBtn())}else{this.showNode(this.getRepeatBtn())}this.hideNode(this.getCompletedBtn());this.hideNode(this.getStartBtn())}else if(e.isActive){this.showNode(this.getCompletedBtn());if(this.activeGuide||!this.isShowRepeatWithCompleted){this.hideNode(this.getRepeatBtn())}else{this.showNode(this.getRepeatBtn())}this.hideNode(this.getStartBtn())}else{this.showNode(this.getStartBtn());this.hideNode(this.getRepeatBtn());this.hideNode(this.getCompletedBtn())}}},{key:"showGuide",value:function t(){this.emit("onBeforeShowGuide");var n=this.collapsedStep;if(!this.activeGuide&&n){this.emit("onStartShowGuide");this.activeGuide=new i.Guide({simpleMode:true,steps:[n.getHighlightOptions()]});this.activeGuide.subscribe(i.Guide.getFullEventName("onFinish"),this.finishGuide.bind(this));this.activeGuide.start();e.Dom.remove(this.activeGuide.getPopup().closeIcon);this.emit("showCollapseWithGuide");this.checkButtonsState()}}},{key:"closeGuide",value:function t(){if(this.activeGuide instanceof i.Guide){this.activeGuide.close();this.emit("onAfterGuide")}}},{key:"getCollapseBlock",value:function t(){if(!this.layout.collapseBlock){this.layout.collapseBlock=e.Tag.render(l(),this.clickCollapseBlockHandler.bind(this),e.Loc.getMessage("JS_UI_TUTOR_STEP_TITLE"),this.getCollapseTitle(),this.getStartBtn(),this.getRepeatBtn(),this.getCompletedBtn());this.emit("onCreateCollapsedBlockNode");e.Dom.append(this.layout.collapseBlock,document.body);this.emit("onAfterAppendCollapsedBlockNode")}return this.layout.collapseBlock}},{key:"getStartBtn",value:function t(){var i=this;if(!this.startBtn){this.startBtn=e.Tag.render(a(),e.Loc.getMessage("JS_UI_TUTOR_BTN_START"));e.Event.bind(this.startBtn,"click",function(t){t.stopPropagation();i.emit("clickStartBtn")})}return this.startBtn}},{key:"getRepeatBtn",value:function t(){var i=this;if(!this.repeatBtn){this.repeatBtn=e.Tag.render(u(),e.Loc.getMessage("JS_UI_TUTOR_BTN_REPEAT"));e.Event.bind(this.repeatBtn,"click",function(t){t.stopPropagation();i.emit("clickRepeatBtn")})}return this.repeatBtn}},{key:"getCompletedBtn",value:function t(){var i=this;if(!this.completedBtn){this.completedBtn=e.Tag.render(r(),e.Loc.getMessage("JS_UI_TUTOR_BTN_COMPLETED_SHORT"));e.Event.bind(this.completedBtn,"click",function(t){t.stopPropagation();i.emit("clickCompletedBtn")})}return this.completedBtn}},{key:"getCollapseTitle",value:function t(){if(!this.layout.collapseTitle){this.layout.collapseTitle=e.Tag.render(s())}return this.layout.collapseTitle}},{key:"closeCollapsePopup",value:function t(e){this.closeCollapseEntity();this.emit("clickCloseCollapseBlock")}},{key:"clickCollapseBlockHandler",value:function t(){this.emit("clickCollapseBlock")}},{key:"finishGuide",value:function t(){delete this.activeGuide;this.checkButtonsState();this.emit("completeCloseGuide")}},{key:"closeCollapseEntity",value:function t(){this.emit("onBeforeHideCollapsedBlock");this.getCollapseBlock().style.display="none";this.getImButton().style.display="block";if(this.activeGuide instanceof i.Guide){this.activeGuide.close()}if(this.isInformerShow){e.Dom.append(this.getInformer(),this.getImButton())}delete this.collapsedStep;this.isCollapsedShow=false;this.emit("onHideCollapsedBlock")}},{key:"showLoader",value:function t(){this.emit("onBeforeShowLoader");this.startTitle="";this.startText="";this.layout.loader=new n.Loader({target:this.getStartPopup(),size:85});this.layout.loader.show();this.getStartPopup().style.display="flex";e.Dom.addClass(this.getStartPopup(),"ui-tutor-popup-load");this.emit("onAfterShowLoader")}},{key:"hideLoader",value:function t(){if(this.layout.loader){this.layout.loader.destroy();this.getStartPopup().style.display="none"}}},{key:"showCollapsedLoader",value:function t(){this.emit("onBeforeShowCollapsedLoader");this.layout.collapseLoader=new n.Loader({target:this.getCollapseBlock(),size:34});this.layout.collapseLoader.show();this.getCollapseBlock().style.display="flex";e.Dom.addClass(this.getCollapseBlock(),"ui-tutor-popup-collapse-load");this.emit("onAfterShowCollapsedLoader")}},{key:"hideCollapsedLoader",value:function t(){this.emit("onBeforeHideCollapsedLoader");if(this.layout.collapseLoader){this.layout.collapseLoader.destroy();e.Dom.removeClass(this.getCollapseBlock(),"ui-tutor-popup-collapse-load");this.getCollapseBlock().style.display="none"}this.emit("onAfterHideCollapsedLoader")}},{key:"showNode",value:function t(e){e.style.display="block"}},{key:"hideNode",value:function t(e){e.style.display="none"}},{key:"checkFollowLink",value:function t(i,n){this.emit("onStartCheckFollowLink");i=i||this.collapsedStep;if(i instanceof o){n=n||{};if(!(window.location.pathname===i.getUrl())){var s="onBeforeRedirectToActionPage";if(n instanceof Y){e.Dom.addClass(n.getStartBtn(),"ui-btn-wait");n.fireCurrentStepEvent(s)}else{e.Dom.addClass(this.getStartBtn(),"ui-btn-wait");this.emit(s,{step:i})}window.location=i.getUrl()}else{if(n instanceof Y){n.showCollapseBlock(i)}else{i.activate();this.showCollapsedBlock(i)}}}this.emit("onFinishCheckFollowLink")}},{key:"fireEvent",value:function t(e){this.emit(e)}}]);return g}(e.Event.EventEmitter);g.instance=null;g.scenarioInstance=null;g.activeGuide=null;g.isShowRepeatWithCompleted=true;g.layout={imButton:null,collapseBlock:null,collapseTitle:null};function m(){var t=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<div class="ui-tutor-popup-arrow ui-tutor-popup-arrow-next"></div>\n\t\t\t\t']);m=function e(){return t};return t}function k(){var t=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<div class="ui-tutor-popup-arrow ui-tutor-popup-arrow-prev"></div>\n\t\t\t\t']);k=function e(){return t};return t}function y(){var t=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<div class="ui-tutor-popup-new-text">',"</div>\n\t\t\t\t"]);y=function e(){return t};return t}function S(){var t=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<div class="ui-tutor-popup-finished-notice">',"</div>\n\t\t\t\t"]);S=function e(){return t};return t}function b(){var t=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<div class="ui-tutor-popup-finished">\n\t\t\t\t\t\t<div class="ui-tutor-popup-finished-title">','</div>\n\t\t\t\t\t\t<div class="ui-tutor-popup-finished-icon"></div>\n\t\t\t\t\t\t<div class="ui-tutor-popup-finished-text">',"</div>\n\t\t\t\t\t</div>\n\t\t\t\t"]);b=function e(){return t};return t}function B(){var t=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<span class="ui-tutor-popup-help-link" onclick="','">\n\t\t\t\t\t\t<span class="ui-tutor-popup-help-link-text">',"</span>\n\t\t\t\t\t</span>\n\t\t\t\t"]);B=function e(){return t};return t}function C(){var t=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<div class="ui-tutor-popup-video" data-step=',"></div>\n\t\t\t\t"]);C=function e(){return t};return t}function T(){var t=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<div class="ui-tutor-popup-help">\n\t\t\t\t\t\t',"\n\t\t\t\t\t</div>\n\t\t\t\t"]);T=function e(){return t};return t}function w(){var t=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t\t<span class="ui-tutor-popup-step-item" data-step=',' onclick="','">\n\t\t\t\t\t\t\t<span class="ui-tutor-popup-step-item-number">',"</span>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t"]);w=function e(){return t};return t}function L(){var t=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<div class="ui-tutor-popup-step-list"></div>\n\t\t\t\t']);L=function e(){return t};return t}function I(){var t=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<a class="ui-tutor-popup-support-link" onclick="','">\n\t\t\t\t\t\t',"\n\t\t\t\t\t</a>\n\t\t\t\t"]);I=function e(){return t};return t}function D(){var t=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<div class="ui-tutor-popup-step-decs"></div>\n\t\t\t\t']);D=function e(){return t};return t}function P(){var t=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<div class="ui-tutor-popup-step-title"></div>\n\t\t\t\t']);P=function e(){return t};return t}function E(){var t=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<div class="ui-tutor-popup-completed">\n\t\t\t\t\t\t<div class="ui-tutor-popup-completed-icon"></div>\n\t\t\t\t\t\t<div class="ui-tutor-popup-completed-text">',"</div>\n\t\t\t\t\t</div>\n\t\t\t\t"]);E=function e(){return t};return t}function N(){var t=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<button class="ui-btn ui-btn-link ui-btn-round" onclick="','">\n\t\t\t\t\t\t',"\n\t\t\t\t\t</button>\n\t\t\t\t"]);N=function e(){return t};return t}function _(){var t=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<button class="ui-btn ui-btn-primary ui-btn-round" onclick="','">\n\t\t\t\t\t\t',"\n\t\t\t\t\t</button>\n\t\t\t\t"]);_=function e(){return t};return t}function A(){var t=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<button class="ui-btn ui-btn-success ui-btn-round" onclick="','">\n\t\t\t\t\t\t',"\n\t\t\t\t\t</button>\n\t\t\t\t"]);A=function e(){return t};return t}function H(){var t=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<button class="ui-btn ui-btn-primary ui-btn-round" onclick="','">\n\t\t\t\t\t\t',"\n\t\t\t\t\t</button>\n\t\t\t\t"]);H=function e(){return t};return t}function x(){var t=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<span class="ui-tutor-popup-defer-link">\n\t\t\t\t\t\t',"\n\t\t\t\t\t</span>\n\t\t\t\t"]);x=function e(){return t};return t}function O(){var t=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<span class="ui-tutor-popup-header-counter-number"></span>\n\t\t\t\t']);O=function e(){return t};return t}function U(){var t=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<span class="ui-tutor-popup-header-counter-step">\n\t\t\t\t\t\t',"\n\t\t\t\t\t</span>\n\t\t\t\t"]);U=function e(){return t};return t}function R(){var t=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<span class="ui-tutor-popup-nav-item ui-tutor-popup-nav-item-next" onclick="','"></span>\n\t\t\t\t']);R=function e(){return t};return t}function F(){var t=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<span class="ui-tutor-popup-nav-item ui-tutor-popup-nav-item-prev" onclick="','"></span>\n\t\t\t\t']);F=function e(){return t};return t}function M(){var t=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<div class="ui-tutor-popup-nav"></div>\n\t\t\t\t']);M=function e(){return t};return t}function W(){var t=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<div class="ui-tutor-popup-btn">\n\t\t\t\t\t\t',"\n\t\t\t\t\t\t","\n\t\t\t\t\t\t","\n\t\t\t\t\t</div>\n\t\t\t\t"]);W=function e(){return t};return t}function V(){var t=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<div class="ui-tutor-popup-content-inner">\n\t\t\t\t\t\t',"\n\t\t\t\t\t\t","\n\t\t\t\t\t\t","\n\t\t\t\t\t</div>\n\t\t\t\t"]);V=function e(){return t};return t}function G(){var t=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<div class="ui-tutor-popup-footer">\n\t\t\t\t\t\t',"\n\t\t\t\t\t\t","\n\t\t\t\t\t</div>\n\t\t\t\t"]);G=function e(){return t};return t}function J(){var t=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<div class="ui-tutor-popup-content-block">\n\t\t\t\t\t\t',"\n\t\t\t\t\t\t","\n\t\t\t\t\t</div>\n\t\t\t\t"]);J=function e(){return t};return t}function X(){var t=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<div class="ui-tutor-popup ui-tutor-popup-step">\n\t\t\t\t\t\t<div class="ui-tutor-popup-header">\n\t\t\t\t\t\t\t<span class="ui-tutor-popup-header-icon"></span>\n\t\t\t\t\t\t\t<span class="ui-tutor-popup-header-title">\n\t\t\t\t\t\t\t\t<span class="ui-tutor-popup-header-counter">\n\t\t\t\t\t\t\t\t\t',".\n\t\t\t\t\t\t\t\t\t",'\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t<span class="ui-tutor-popup-header-subtitle">',"</span>\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t",'\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="ui-tutor-popup-content">\n\t\t\t\t\t\t\t','\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="ui-tutor-popup-step-wrap">\n\t\t\t\t\t\t\t<div class="ui-tutor-popup-step-inner">\n\t\t\t\t\t\t\t\t<div class="ui-tutor-popup-arrow-wrap"></div>\n\t\t\t\t\t\t\t\t<div class="ui-tutor-popup-step-list-wrap">\n\t\t\t\t\t\t\t\t\t','\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="ui-tutor-popup-icon-close" onclick="','"></div>\n\t\t\t\t\t\t<div class="ui-tutor-popup-icon-angle"></div>\n\t\t\t\t\t</div>\n\t\t\t\t']);X=function e(){return t};return t}var Y=function(t){babelHelpers.inherits(i,t);function i(){var t;var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};babelHelpers.classCallCheck(this,i);t=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(i).call(this));t.setEventNamespace("BX.UI.Tutor.Scenario");t.stepPopup=null;t.arrowTimer=null;t.guide=null;t.loader=null;t.arrowWrap=null;t.prevArrow=null;t.nextArrow=null;t.currentStepIndex=0;t.currentStep=null;t.isAddedSteps=false;t.hasArrows=false;t.isLoading=true;t.setOptions(e);t.btn=document.getElementById("ui-tutor-btn-wrap");t.informer=document.getElementById("ui-tutor-informer");t.layout={stepBlock:null,progress:null,counter:null,counterContainer:null,title:null,description:null,collapseBlock:null,collapseTitle:null,collapseDescription:null,content:null,contentInner:null,contentBlock:null,url:null,target:null,startBtn:null,nextBtn:null,repeatBtn:null,deferBtn:null,help:null,completedBtn:null,completedBlock:null,finishedBlock:null,supportLink:null};t.sections=["settings","scenario","work"];t.loadYoutubeApiScript();t.subscribe("onYouTubeReady",function(){t.setVideoItems()});return t}babelHelpers.createClass(i,[{key:"loadYoutubeApiScript",value:function t(){var i=function(){this.emit("onYouTubeReady",{scenario:this})}.bind(this);if(!window.YT){var n=true;var o=document.createElement("script");o.src="https://www.youtube.com/iframe_api";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(o,s);var r=setInterval(function(){if(n){if(window.YT&&e.Type.isFunction(window.YT.Player)){clearInterval(r);i()}}},200);setTimeout(function(){clearInterval(r);n=false},2e3)}else{setTimeout(function(){i()}.bind(this),100)}}},{key:"setOptions",value:function t(i){var n=this;this.fireCurrentStepEvent("onBeforeSetOptions",false);i=e.Type.isPlainObject(i)?i:{};var s=this.getCurrentStep();this.steps=[];if(Array.isArray(i.steps)){i.steps.forEach(function(t){n.steps.push(new o(t))})}if(s instanceof o){var r=this.findStepById(s.getId());if(r){s=r}}else if(e.Type.isString(i.currentStepId)&&i.currentStepId.length>0){var u=this.findStepById(i.currentStepId);if(u){s=u;if(i.currentStepIsActive===true){s.activate()}}}if(!s){var a=this.getFirstUncompletedStep();if(a){s=a}}if(!s&&this.steps&&this.steps[0]){s=this.steps[0]}this.setCurrentStep(s);if(i){this.isLoading=false}this.title=i.title||"";this.supportLink=i.supportLink||"";this.isFinished=i.isFinished||false;this.fireCurrentStepEvent("onAfterSetOptions",false)}},{key:"setCurrentStep",value:function t(i){if(i instanceof o){this.currentStep=i;var n=this.steps;if(e.Type.isArray(n)){this.currentStepIndex=n.indexOf(i)}this.fireCurrentStepEvent("onStartStep")}}},{key:"start",value:function t(e){this.emit("onStart",{scenario:this});if(e){this.complexAnimation=true}this.showPopup(this.getStepPopup());this.toggleCompletedState();this.toggleNavBtn();this.setPopupData();if(this.isAddedSteps){this.hideFinalState()}if(!this.hasArrows){this.initArrows()}this.complexAnimation=false;this.fireCurrentStepEvent("onShowComplete")}},{key:"findStepById",value:function t(e){for(var i=0;i<this.steps.length;i++){var n=this.steps[i];if(n.getId()===e){return n}}return null}},{key:"getStepPopup",value:function t(){var i=this;var n=function t(){i.emit("onClickOnCloseIcon",{scenario:i})};if(!this.stepPopup){this.stepPopup=e.Tag.render(X(),e.Loc.getMessage("JS_UI_TUTOR_TITLE"),this.getCounterContainer(),this.title,this.getDeferLink(),this.getContentBlock(),this.getStepBlock(),n.bind(this));this.fireCurrentStepEvent("onCreateStepPopupNode");e.Dom.append(this.stepPopup,document.body);this.fireCurrentStepEvent("onAfterAppendStepPopupNode")}return this.stepPopup}},{key:"getContentBlock",value:function t(){if(!this.layout.contentBlock){this.layout.contentBlock=e.Tag.render(J(),this.getContentInner(),this.getFooter())}return this.layout.contentBlock}},{key:"getFooter",value:function t(){if(!this.layout.footer){this.layout.footer=e.Tag.render(G(),this.getNavigation(),this.getBtnContainer());if(g.getInstance().feedbackFormId){e.Dom.append(this.getSupportLink(),this.layout.footer)}}return this.layout.footer}},{key:"getContentInner",value:function t(){if(!this.layout.contentInner){this.layout.contentInner=e.Tag.render(V(),this.getTitle(),this.getDescription(),this.getHelpBlock())}return this.layout.contentInner}},{key:"getBtnContainer",value:function t(){if(!this.layout.btnContainer){this.layout.btnContainer=e.Tag.render(W(),this.getStartBtn(),this.getRepeatBtn(),this.getCompletedBtn())}return this.layout.btnContainer}},{key:"getNavigation",value:function t(){if(!this.layout.navigation){this.layout.navigation=e.Tag.render(M());this.layout.backBtn=e.Tag.render(F(),this.clickOnBackBtn.bind(this));this.layout.nextBtn=e.Tag.render(R(),this.clickOnNextBtn.bind(this));e.Dom.append(this.layout.backBtn,this.layout.navigation);e.Dom.append(this.layout.nextBtn,this.layout.navigation)}return this.layout.navigation}},{key:"setInformer",value:function t(e){this.setInformerCount(this.steps.length-this.getCompletedSteps())}},{key:"setInformerExternal",value:function t(e){this.setInformerCount(e)}},{key:"setInformerCount",value:function t(e){g.setCount(e)}},{key:"closeStepPopup",value:function t(e,i){if(!this.stepPopup){return}if(e){e.stopPropagation()}this.fireCurrentStepEvent("onCloseStepPopup");if(i){this.complexAnimation=true}this.fadeAnimation(this.getStepPopup());setTimeout(function(){this.hideNode(this.getStepPopup())}.bind(this),310);this.complexAnimation=false}},{key:"getCompletedSteps",value:function t(){var e=0;for(var i=0;i<this.steps.length;i+=1){if(this.steps[i].isCompleted){e+=1}}return e}},{key:"setStepCounter",value:function t(){this.getCounter().textContent=e.Loc.getMessage("JS_UI_TUTOR_COUNTER_NUMBER").replace("#NUMBER#",this.steps.indexOf(this.getCurrentStep())+1).replace("#NUMBER_TOTAL#",this.steps.length)}},{key:"getCounterContainer",value:function t(){if(!this.layout.counterContainer){this.layout.counterContainer=e.Tag.render(U(),this.getCounter())}return this.layout.counterContainer}},{key:"getCounter",value:function t(){if(!this.layout.counter){this.layout.counter=e.Tag.render(O())}return this.layout.counter}},{key:"getDeferLink",value:function t(){if(!this.layout.deferLink){this.layout.deferLink=e.Tag.render(x(),e.Loc.getMessage("JS_UI_TUTOR_BTN_DEFER"));var i=new BX.PopupMenuWindow({angle:true,offsetLeft:15,className:"ui-tutor-popup-defer-menu",bindElement:this.layout.deferLink,items:[{text:e.Loc.getMessage("JS_UI_TUTOR_DEFER_MENU_HOUR"),onclick:function(){this.emit("onDeferOneHour",{scenario:this});i.close()}.bind(this)},{text:e.Loc.getMessage("JS_UI_TUTOR_DEFER_MENU_TOMORROW"),onclick:function(){this.emit("onDeferTomorrow",{scenario:this});i.close()}.bind(this)},{text:e.Loc.getMessage("JS_UI_TUTOR_DEFER_MENU_WEEK"),onclick:function(){this.emit("onDeferWeek",{scenario:this});i.close()}.bind(this)},{text:e.Loc.getMessage("JS_UI_TUTOR_DEFER_MENU_FOREVER"),onclick:function(){this.emit("onDeferForever",{scenario:this});i.close()}.bind(this)}]});e.Event.bind(this.layout.deferLink,"click",function(){i.show()})}return this.layout.deferLink}},{key:"getStartBtn",value:function t(){if(!this.layout.startBtn){this.layout.startBtn=e.Tag.render(H(),this.clickStartHandler.bind(this),e.Loc.getMessage("JS_UI_TUTOR_BTN_START"))}return this.layout.startBtn}},{key:"getCompletedBtn",value:function t(){if(!this.layout.completedBtn){this.layout.completedBtn=e.Tag.render(A(),this.showSuccessState.bind(this),e.Loc.getMessage("JS_UI_TUTOR_BTN_COMPLETED"))}return this.layout.completedBtn}},{key:"getRepeatBtn",value:function t(){if(!this.layout.repeatBtn){this.layout.repeatBtn=e.Tag.render(_(),this.repeatStep.bind(this),e.Loc.getMessage("JS_UI_TUTOR_BTN_REPEAT"))}return this.layout.repeatBtn}},{key:"getDeferBtn",value:function t(){if(!this.layout.deferBtn){this.layout.deferBtn=e.Tag.render(N(),this.closeStepPopup.bind(this),e.Loc.getMessage("JS_UI_TUTOR_BTN_DEFER"))}return this.layout.deferBtn}},{key:"getCompletedBLock",value:function t(){if(!this.layout.completedBlock){this.layout.completedBlock=e.Tag.render(E(),e.Loc.getMessage("JS_UI_TUTOR_STEP_COMPLETED"))}return this.layout.completedBlock}},{key:"getTitle",value:function t(){if(!this.layout.title){this.layout.title=e.Tag.render(P())}return this.layout.title}},{key:"getDescription",value:function t(){if(!this.layout.description){this.layout.description=e.Tag.render(D())}return this.layout.description}},{key:"getSupportLink",value:function t(){if(!this.layout.supportLink){this.layout.supportLink=e.Tag.render(I(),this.supportLinkHandler.bind(this),e.Loc.getMessage("JS_UI_TUTOR_BTN_SUPPORT"))}return this.layout.supportLink}},{key:"setInvisible",value:function t(){this.hideNode(this.getStepPopup())}},{key:"setVisible",value:function t(){this.showNode(this.getStepPopup())}},{key:"supportLinkHandler",value:function t(){this.emit("supportLinkClick");g.getInstance().showFeedbackForm()}},{key:"getStepBlock",value:function t(){if(!this.layout.stepBlock){this.layout.stepBlock=e.Tag.render(L());this.layout.stepItems=[];for(var i=0;i<this.steps.length;i+=1){var n=e.Tag.render(w(),i,this.switchStep.bind(this),i+1);this.layout.stepItems.push(n);e.Dom.append(n,this.layout.stepBlock)}this.setStepItems()}return this.layout.stepBlock}},{key:"setStepItems",value:function t(){if(this.layout&&this.layout.stepItems){for(var i=0;i<this.steps.length;i+=1){if(this.layout.stepItems[i]){e.Dom.removeClass(this.layout.stepItems[i],"ui-tutor-popup-step-item-current");if(i===this.currentStepIndex){e.Dom.addClass(this.layout.stepItems[i],"ui-tutor-popup-step-item-current")}if(this.steps[i].isCompleted){e.Dom.addClass(this.layout.stepItems[i],"ui-tutor-popup-step-item-completed")}}}}}},{key:"getHelpBlock",value:function t(){if(!this.layout.help){this.layout.help=e.Tag.render(T(),this.getHelpLink())}return this.layout.help}},{key:"setVideoItems",value:function t(){for(var i=0;i<this.steps.length;i+=1){var n=e.Tag.render(C(),i);e.Dom.prepend(n,this.getHelpBlock());if(window.YT&&e.Type.isObject(window.YT)&&e.Type.isFunction(window.YT.Player)&&this.steps[i].video!==null){var o={videoId:this.steps[i].video,events:{onReady:function(t){t.target.mute();t.target.pauseVideo();t.target.setPlaybackQuality("hd720");if(+t.target.getIframe().getAttribute("data-step")===this.currentStepIndex){e.Dom.addClass(t.target.getIframe(),"ui-tutor-popup-video-show");t.target.playVideo()}}.bind(this)},playerVars:{cc_load_policy:1,cc_lang_pref:"ru",rel:0}};this.fireCurrentStepEvent("onBeforeCreateVideo",true,{playerData:o});this.steps[i].videoObj=new YT.Player(n,o);this.fireCurrentStepEvent("onAfterCreateVideo")}}}},{key:"pauseCurrentVideo",value:function t(){var i=this.getCurrentStep();if(window.YT&&i instanceof o){var n=i.getVideoObj();if(e.Type.isObject(n)&&n.pauseVideo){n.pauseVideo()}}}},{key:"playCurrentVideo",value:function t(){var i=this.getCurrentStep();if(window.YT&&i instanceof o){var n=i.getVideoObj();if(e.Type.isObject(n)&&n.playVideo){n.playVideo()}}}},{key:"getHelpLink",value:function t(){if(!this.layout.link){this.layout.link=e.Tag.render(B(),this.handleClickLinkHandler.bind(this),e.Loc.getMessage("JS_UI_TUTOR_ARTICLE_HELP_TOPIC"))}return this.layout.link}},{key:"handleClickLinkHandler",value:function t(){this.emit("helpLinkClick")}},{key:"showPopup",value:function t(e){this.showAnimation(e);e.style.display="block"}},{key:"showNode",value:function t(e){e.style.display="block"}},{key:"hideNode",value:function t(e){e.style.display="none"}},{key:"removePopup",value:function t(i){e.Dom.remove(i)}},{key:"clickOnNextBtn",value:function t(){this.fireCurrentStepEvent("onBeforeClickNavNextBtn");if(this.getCompletedSteps()===this.steps.length&&!this.isFinished){this.isAddedSteps=false;e.Dom.remove(this.getNewStepsSection());e.Dom.removeClass(this.getFinishedBlock(),"ui-tutor-popup-finished-new");this.showFinalState();return}if(this.getCompletedSteps()===this.steps.length&&this.currentStepIndex+1===this.steps.length){this.currentStepIndex=-1}e.Dom.removeClass(this.getStartBtn(),"ui-btn-wait");this.increaseCurrentIndex();this.showStep();this.toggleNavBtn();this.fireCurrentStepEvent("onAfterClickNavNextBtn")}},{key:"clickOnBackBtn",value:function t(){this.fireCurrentStepEvent("onBeforeClickNavBackBtn");this.reduceCurrentIndex();this.toggleNavBtn();this.showStep();this.fireCurrentStepEvent("onAfterClickNavBackBtn")}},{key:"toggleNavBtn",value:function t(){e.Dom.removeClass(this.layout.backBtn,"ui-tutor-popup-nav-item-disabled");e.Dom.removeClass(this.layout.nextBtn,"ui-tutor-popup-nav-item-disabled");if(this.currentStepIndex===0){e.Dom.addClass(this.layout.backBtn,"ui-tutor-popup-nav-item-disabled")}if(this.currentStepIndex+1===this.steps.length){e.Dom.addClass(this.layout.nextBtn,"ui-tutor-popup-nav-item-disabled")}}},{key:"showStep",value:function t(){if(this.clickOnCompletedBtn&&this.currentStepIndex===this.steps.length){var e=this.getFirstUncompletedStep();if(e){this.setCurrentStep(e)}}this.scrollToStep();this.toggleCompletedState();this.setPopupData();this.clickOnCompletedBtn=false;this.fireCurrentStepEvent("onAfterShowStep")}},{key:"switchStep",value:function t(){this.fireCurrentStepEvent("onBeforeSwitchStep");this.setCurrentStep(this.steps[+window.event.target.getAttribute("data-step")]);this.fireCurrentStepEvent("onAfterSwitchStep");if(this.layout.finishedBlock){this.hideFinalState()}this.showStep();this.toggleNavBtn();this.fireCurrentStepEvent("onEndSwitchStep")}},{key:"getFirstUncompletedStep",value:function t(){for(var e=0;e<this.steps.length;e+=1){if(!this.steps[e].isCompleted){return this.steps[e]}}return null}},{key:"toggleCompletedState",value:function t(){var e=this.getCurrentStep();if(e){if(e.getCompleted()){this.showNode(this.getRepeatBtn());this.hideNode(this.getStartBtn());this.hideNode(this.getCompletedBtn())}else if(e.isActive){this.showNode(this.getCompletedBtn());this.hideNode(this.getStartBtn());this.showNode(this.getRepeatBtn())}else{this.showNode(this.getStartBtn());this.hideNode(this.getCompletedBtn());this.hideNode(this.getRepeatBtn())}}}},{key:"setPopupData",value:function t(){this.fireCurrentStepEvent("onBeforeSetPopupData");var e=this.getCurrentStep();if(e){this.getTitle().innerHTML=e.getTitle();this.getDescription().innerHTML=e.getDescription();g.getCollapseTitle().innerHTML=e.getTitle();if(this.getCurrentStep().getVideo()&&window.YT){this.setCurrentVideo()}this.setStepCounter();this.setStepItems()}this.fireCurrentStepEvent("onAfterSetPopupData")}},{key:"setCurrentVideo",value:function t(){this.fireCurrentStepEvent("onSetCurrentVideo");for(var i=0;i<this.steps.length;i+=1){var n=this.steps[i].getVideoObj();if(window.YT&&i===this.currentStepIndex&&n&&n.playVideo){e.Dom.addClass(n.getIframe(),"ui-tutor-popup-video-show");n.playVideo()}else{if(n){e.Dom.removeClass(n.getIframe(),"ui-tutor-popup-video-show");if(n.pauseVideo){n.pauseVideo()}}}}}},{key:"getCurrentStep",value:function t(){return this.currentStep}},{key:"increaseCurrentIndex",value:function t(){if(this.currentStepIndex===this.steps.length){return}this.currentStepIndex+=1;this.setCurrentStep(this.steps[this.currentStepIndex])}},{key:"reduceCurrentIndex",value:function t(){if(this.currentStepIndex===0){return}this.currentStepIndex-=1;this.setCurrentStep(this.steps[this.currentStepIndex])}},{key:"showCollapseBlock",value:function t(e,i){i=i!==false;this.closeStepPopup(null,true);g.showCollapsedBlock(e,i)}},{key:"minimize",value:function t(){this.pauseCurrentVideo();this.fireCurrentStepEvent("onMinimize");this.showCollapseBlock(this.getCurrentStep(),false)}},{key:"repeatStep",value:function t(){this.followLink()}},{key:"clickStartHandler",value:function t(){this.followLink()}},{key:"followLink",value:function t(e){var i=this.getCurrentStep();if(e instanceof o){i=e}this.pauseCurrentVideo();this.setActiveStep(i);g.checkFollowLink(i,this)}},{key:"setActiveStep",value:function t(e){this.fireCurrentStepEvent("onBeforeSetActiveStep");if(this.currentActiveStep instanceof o){this.currentActiveStep.deactivate()}e.activate();this.currentActiveStep=e;this.fireCurrentStepEvent("onAfterSetActiveStep")}},{key:"showSuccessState",value:function t(){var i=this.getCurrentStep();this.clickOnCompletedBtn=true;i.isCompleted=true;this.fireCurrentStepEvent("onFinishStep");if(i.getCompleted()){e.Dom.addClass(this.layout.stepItems[this.currentStepIndex],"ui-tutor-popup-step-item-completed")}e.Dom.addClass(this.getContentBlock(),"ui-tutor-popup-content-block-animate");setTimeout(function(){e.Dom.replace(this.getHelpBlock(),this.getCompletedBLock());this.getFooter().style.display="none";this.getDescription().style.display="none";this.getTitle().style.display="none"}.bind(this),300);setTimeout(function(){e.Dom.addClass(this.getCompletedBLock(),"ui-tutor-popup-completed-animate")}.bind(this),800);setTimeout(function(){e.Dom.replace(this.getCompletedBLock(),this.getHelpBlock());this.getTitle().style.display="block";this.getDescription().style.display="block";this.getFooter().style.display="flex";this.clickOnNextBtn()}.bind(this),1500);setTimeout(function(){e.Dom.removeClass(this.getCompletedBLock(),"ui-tutor-popup-completed-animate");e.Dom.removeClass(this.getContentBlock(),"ui-tutor-popup-content-block-animate");var t=this.stepPopup.querySelector(".ui-tutor-popup-header-counter-number");t.innerHTML=e.Loc.getMessage("JS_UI_TUTOR_COUNTER_NUMBER").replace("#NUMBER#",this.steps.indexOf(this.getCurrentStep())+1).replace("#NUMBER_TOTAL#",this.steps.length);this.fireCurrentStepEvent("onAfterShowSuccessState")}.bind(this),1700)}},{key:"fireCurrentStepEvent",value:function t(e,i,n){i=i!==false;var o=this.getCurrentStep();var s={step:o,scenario:this};if(n){s.extra=n}if(o&&i){o.emit(e,s)}this.emit(e,s)}},{key:"showFinalState",value:function t(){this.fireCurrentStepEvent("onFinalState");if(this.layout.stepItems){e.Dom.removeClass(this.layout.stepItems[this.currentStepIndex],"ui-tutor-popup-step-item-current")}e.Dom.append(this.getFinishedBlock(),this.getContentInner());e.Dom.replace(this.getStartBtn(),this.getFinishedNotice());e.Dom.remove(this.getCompletedBtn());e.Dom.remove(this.getSupportLink());e.Dom.remove(this.getNavigation());e.Dom.remove(this.getHelpBlock());e.Dom.remove(this.getRepeatBtn());e.Dom.remove(this.getTitle());e.Dom.remove(this.getDescription());e.Dom.remove(this.getDeferLink());this.isFinished=true;this.fireCurrentStepEvent("onAfterFinalState")}},{key:"hideFinalState",value:function t(){this.fireCurrentStepEvent("onBeforeHideFinalState");if(this.getCurrentStep().getCompleted()){e.Dom.replace(this.getFinishedNotice(),this.getRepeatBtn())}else{e.Dom.replace(this.getFinishedNotice(),this.getStartBtn())}e.Dom.replace(this.getFinishedBlock(),this.getHelpBlock());if(g.getInstance().feedbackFormId){e.Dom.append(this.getSupportLink(),this.getFooter())}e.Dom.prepend(this.getNavigation(),this.getFooter());e.Dom.prepend(this.getDescription(),this.getContentInner());e.Dom.prepend(this.getTitle(),this.getContentInner());if(this.layout.deferBtn){e.Dom.remove(this.getDeferBtn());e.Dom.prepend(this.getStartBtn(),this.getBtnContainer())}var i=this.getStepPopup().querySelector(".ui-tutor-popup-header");e.Dom.append(this.getDeferLink(),i);this.fireCurrentStepEvent("onAfterHideFinalState")}},{key:"getFinishedBlock",value:function t(){if(!this.layout.finishedBlock){this.layout.finishedBlock=e.Tag.render(b(),e.Loc.getMessage("JS_UI_TUTOR_FINAL_CONGRATULATIONS"),e.Loc.getMessage("JS_UI_TUTOR_FINAL_TEXT"))}return this.layout.finishedBlock}},{key:"getFinishedNotice",value:function t(){if(!this.layout.finishedNotice){this.layout.finishedNotice=e.Tag.render(S(),e.Loc.getMessage("JS_UI_TUTOR_FINAL_NOTICE"))}return this.layout.finishedNotice}},{key:"getNewStepsSection",value:function t(){if(!this.layout.newStepsSection){this.layout.newStepsSection=e.Tag.render(y(),e.Loc.getMessage("JS_UI_TUTOR_STEP_NEW"))}return this.layout.newStepsSection}},{key:"showNewSteps",value:function t(){e.Dom.addClass(this.getFinishedBlock(),"ui-tutor-popup-finished-new");this.showPopup(this.getStepPopup());this.showFinalState();e.Dom.append(this.getNewStepsSection(),this.getFinishedBlock());e.Dom.replace(this.getFinishedNotice(),g.getBeginBtn());e.Dom.append(this.getDeferBtn(),this.getBtnContainer());this.setStepCounter();this.initArrows();this.scrollToStep();this.isAddedSteps=true;this.isFinished=false}},{key:"initArrows",value:function t(){this.stepListWrap=document.querySelector(".ui-tutor-popup-step-list-wrap");this.arrowWrap=document.querySelector(".ui-tutor-popup-arrow-wrap");if(this.stepListWrap&&this.stepListWrap.scrollWidth>this.stepListWrap.offsetWidth){e.Dom.append(this.getPrevArrow(),this.arrowWrap);e.Dom.append(this.getNextArrow(),this.arrowWrap);this.stepListWrap.addEventListener("scroll",this.toggleArrows.bind(this));this.prevArrow.addEventListener("mouseenter",this.scrollToLeft.bind(this));this.prevArrow.addEventListener("mouseleave",this.stopAutoScroll.bind(this));this.nextArrow.addEventListener("mouseenter",this.scrollToRight.bind(this));this.nextArrow.addEventListener("mouseleave",this.stopAutoScroll.bind(this));this.toggleNextArrow();this.getStepBlock().classList.add("ui-tutor-popup-step-list-wide");this.hasArrows=true}}},{key:"getPrevArrow",value:function t(){if(!this.prevArrow){this.prevArrow=e.Tag.render(k())}return this.prevArrow}},{key:"getNextArrow",value:function t(){if(!this.nextArrow){this.nextArrow=e.Tag.render(m())}return this.nextArrow}},{key:"scrollToLeft",value:function t(){this.arrowTimer=setInterval(function(){this.stepListWrap.scrollLeft-=5}.bind(this),20)}},{key:"scrollToRight",value:function t(){this.arrowTimer=setInterval(function(){this.stepListWrap.scrollLeft+=5}.bind(this),20)}},{key:"stopAutoScroll",value:function t(){clearInterval(this.arrowTimer)}},{key:"toggleArrows",value:function t(){this.togglePrevArrow();this.toggleNextArrow()}},{key:"toggleNextArrow",value:function t(){if(this.stepListWrap.scrollWidth>this.stepListWrap.offsetWidth&&this.stepListWrap.offsetWidth+this.stepListWrap.scrollLeft<this.stepListWrap.scrollWidth){e.Dom.addClass(this.nextArrow,"ui-tutor-popup-arrow-show")}else{e.Dom.removeClass(this.nextArrow,"ui-tutor-popup-arrow-show")}}},{key:"togglePrevArrow",value:function t(){if(this.stepListWrap.scrollLeft>0){e.Dom.addClass(this.prevArrow,"ui-tutor-popup-arrow-show")}else{e.Dom.removeClass(this.prevArrow,"ui-tutor-popup-arrow-show")}}},{key:"showAnimation",value:function t(i){e.Dom.removeClass(i,"ui-tutor-popup-hide-complex");e.Dom.removeClass(i,"ui-tutor-popup-hide");if(this.complexAnimation){e.Dom.addClass(i,"ui-tutor-popup-show-complex")}else{e.Dom.addClass(i,"ui-tutor-popup-show")}}},{key:"fadeAnimation",value:function t(i){e.Dom.removeClass(i,"ui-tutor-popup-show-complex");e.Dom.removeClass(i,"ui-tutor-popup-show");if(this.complexAnimation){e.Dom.addClass(i,"ui-tutor-popup-hide-complex")}else{e.Dom.addClass(i,"ui-tutor-popup-hide")}}},{key:"scrollToStep",value:function t(){var i=null;var n=null;if(this.stepListWrap){i=e.Dom.getPosition(this.stepListWrap);n=e.Dom.getPosition(this.stepListWrap.querySelector('[data-step="'+this.currentStepIndex+'"]'))}var o=7;if(!e.Type.isNull(n)&&n.left+n.width>i.left+i.width){this.stepListWrap.scrollLeft+=n.left-(i.left+i.width)+n.width+o}if(!e.Type.isNull(n)&&n.left<i.left){this.stepListWrap.scrollLeft-=i.left-n.left+o}}}],[{key:"getFullEventName",value:function t(e){return e}},{key:"getInstance",value:function t(){return g.getScenarioInstance()}},{key:"init",value:function t(e){return g.initScenario(e)}}]);return i}(e.Event.EventEmitter);t.Scenario=Y;t.Manager=g;t.Step=o})(this.BX.UI.Tutor=this.BX.UI.Tutor||{},BX,BX.UI.Tour,BX);
//# sourceMappingURL=tutor.bundle.map.js