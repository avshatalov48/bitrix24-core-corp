{"version":3,"file":"bundle.js","sources":["../src/index.js"],"sourcesContent":["import { Tag, Type } from 'main.core';\n\nexport class TextCrop\n{\n\tconstructor(options)\n\t{\n\t\tthis.target = options.target || null;\n\t\tthis.rows = options.rows || 2;\n\t\tthis.resize = options.resize || false;\n\t\tthis.text = null;\n\t\tthis.rowHeight = null;\n\n\t\tthis.layout = {\n\t\t\twrapper: null,\n\t\t\tbasicBlock: null\n\t\t}\n\t}\n\n\tgetText()\n\t{\n\t\tif(!this.text)\n\t\t{\n\t\t\tthis.text = this.target\n\t\t\t\t? this.target.innerText\n\t\t\t\t: null;\n\t\t}\n\n\t\treturn this.text;\n\t}\n\n\tgetWrapper()\n\t{\n\t\tif(!this.layout.wrapper)\n\t\t{\n\t\t\tthis.layout.wrapper = Tag.render`\n\t\t\t\t<div>${this.getText()}</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.layout.wrapper;\n\t}\n\n\tgetBasicBlock()\n\t{\n\t\tif(!this.layout.basicBlock)\n\t\t{\n\t\t\tthis.layout.basicBlock = Tag.render`\n\t\t\t\t<div>a</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.layout.basicBlock;\n\t}\n\n\tgetRowHeight()\n\t{\n\t\tif(!this.rowHeight)\n\t\t{\n\t\t\tlet styleAtt = getComputedStyle(this.getWrapper());\n\n\t\t\tif (styleAtt.lineHeight  === 'normal')\n\t\t\t{\n\t\t\t\tlet firstHeight = this.getWrapper().offsetHeight;\n\t\t\t\tthis.layout.wrapper.appendChild(this.getBasicBlock());\n\t\t\t\tlet secondHeight = this.getWrapper().offsetHeight;\n\t\t\t\tthis.getBasicBlock().remove();\n\n\t\t\t\tthis.rowHeight = secondHeight - firstHeight;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.rowHeight = styleAtt.lineHeight;\n\t\t\t}\n\t\t}\n\n\t\treturn this.rowHeight;\n\t}\n\n\tcropResize()\n\t{\n\t\tif(this.resize)\n\t\t{\n\t\t\tlet timer;\n\t\t\twindow.addEventListener('resize', () => {\n\t\t\t\tif (!timer)\n\t\t\t\t{\n\t\t\t\t\ttimer = setTimeout(() => {\n\t\t\t\t\t\tthis.init();\n\t\t\t\t\t\tclearTimeout(timer);\n\t\t\t\t\t}, 100);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tcrop()\n\t{\n\t\tthis.init();\n\t}\n\n\tinit()\n\t{\n\t\tif(!Type.isDomNode(this.target))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.getText();\n\t\tthis.target.innerText = '';\n\t\tthis.layout.wrapper = '';\n\t\tthis.target.appendChild(this.getWrapper());\n\n\t\tlet rowHeight = this.getRowHeight();\n\t\tlet cropText = '';\n\t\tlet numberRows = this.getWrapper().offsetHeight / parseInt(rowHeight);\n\n\t\tif (numberRows > this.rows)\n\t\t{\n\t\t\tthis.target.setAttribute('title', this.getText());\n\n\t\t\twhile (this.getWrapper().offsetHeight / parseInt(rowHeight) > this.rows)\n\t\t\t{\n\t\t\t\tcropText = this.layout.wrapper.textContent.substring(0, this.layout.wrapper.textContent.length - 4);\n\t\t\t\tthis.layout.wrapper.innerHTML = cropText + '...';\n\t\t\t}\n\t\t}\n\n\t\tthis.cropResize();\n\t}\n}\n\n"],"names":["TextCrop","options","target","rows","resize","text","rowHeight","layout","wrapper","basicBlock","innerText","Tag","render","getText","styleAtt","getComputedStyle","getWrapper","lineHeight","firstHeight","offsetHeight","appendChild","getBasicBlock","secondHeight","remove","timer","window","addEventListener","setTimeout","init","clearTimeout","Type","isDomNode","getRowHeight","cropText","numberRows","parseInt","setAttribute","textContent","substring","length","innerHTML","cropResize"],"mappings":"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"}