{"version":3,"file":"bundle.js","sources":["../src/index.js"],"sourcesContent":["import { Tag, Type } from 'main.core';\n\nexport class TextCrop\n{\n\tconstructor(options)\n\t{\n\t\tthis.target = options.target || null;\n\t\tthis.rows = options.rows || 2;\n\t\tthis.resize = options.resize || false;\n\t\tthis.text = null;\n\t\tthis.rowHeight = null;\n\n\t\tthis.$wrapper = null;\n\t\tthis.$basicBlock = null;\n\t}\n\n\tgetText()\n\t{\n\t\tif(!this.text)\n\t\t{\n\t\t\tthis.text = this.target\n\t\t\t\t? this.target.innerText\n\t\t\t\t: null;\n\t\t}\n\n\t\treturn this.text;\n\t}\n\n\tgetWrapper()\n\t{\n\t\tif(!this.$wrapper)\n\t\t{\n\t\t\tthis.$wrapper = Tag.render`\n\t\t\t\t<div>${this.getText()}</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.$wrapper;\n\t}\n\n\tgetBasicBlock()\n\t{\n\t\tif(!this.$basicBlock)\n\t\t{\n\t\t\tthis.$basicBlock = Tag.render`\n\t\t\t\t<div>a</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.$basicBlock;\n\t}\n\n\tgetRowHeight()\n\t{\n\t\tif(!this.rowHeight)\n\t\t{\n\t\t\tlet styleAtt = getComputedStyle(this.getWrapper());\n\n\t\t\tif (styleAtt.lineHeight  === 'normal')\n\t\t\t{\n\t\t\t\tlet firstHeight = this.getWrapper().offsetHeight;\n\t\t\t\tthis.$wrapper.appendChild(this.getBasicBlock());\n\t\t\t\tlet secondHeight = this.getWrapper().offsetHeight;\n\t\t\t\tthis.getBasicBlock().remove();\n\n\t\t\t\tthis.rowHeight = secondHeight - firstHeight;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.rowHeight = styleAtt.lineHeight;\n\t\t\t}\n\t\t}\n\n\t\treturn this.rowHeight;\n\t}\n\n\tcropResize()\n\t{\n\t\tif(this.resize)\n\t\t{\n\t\t\twindow.addEventListener('resize', BX.delegate(this.init, this));\n\t\t}\n\t}\n\n\tcrop()\n\t{\n\t\tthis.init();\n\t}\n\n\tinit()\n\t{\n\t\tif(!Type.isDomNode(this.target))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.getText();\n\t\tthis.target.innerText = '';\n\t\tthis.$wrapper = '';\n\t\tthis.target.appendChild(this.getWrapper());\n\n\t\tlet rowHeight = this.getRowHeight();\n\t\tlet cropText = '';\n\t\tlet numberRows = this.getWrapper().offsetHeight / parseInt(rowHeight);\n\n\t\tif (numberRows > this.rows)\n\t\t{\n\t\t\tthis.target.setAttribute('title', this.getText());\n\n\t\t\twhile (this.getWrapper().offsetHeight / parseInt(rowHeight) > this.rows)\n\t\t\t{\n\t\t\t\tcropText = this.$wrapper.textContent.substring(0, this.$wrapper.textContent.length - 4);\n\t\t\t\tthis.$wrapper.innerHTML = cropText + '...';\n\t\t\t}\n\t\t}\n\n\t\tthis.cropResize();\n\t}\n}\n\n"],"names":["TextCrop","options","target","rows","resize","text","rowHeight","$wrapper","$basicBlock","innerText","Tag","render","getText","styleAtt","getComputedStyle","getWrapper","lineHeight","firstHeight","offsetHeight","appendChild","getBasicBlock","secondHeight","remove","window","addEventListener","BX","delegate","init","Type","isDomNode","getRowHeight","cropText","numberRows","parseInt","setAttribute","textContent","substring","length","innerHTML","cropResize"],"mappings":"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"}