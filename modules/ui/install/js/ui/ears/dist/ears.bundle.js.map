{"version":3,"file":"ears.bundle.js","sources":["../src/ears.js"],"sourcesContent":["import {Tag, Dom, Cache} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\n\nexport class Ears extends EventEmitter\n{\n\tconstructor(options)\n\t{\n\t\tsuper(...arguments);\n\t\tthis.setEventNamespace('BX.UI.Ears');\n\t\tthis.container = options.container;\n\t\tthis.smallSize = options.smallSize || null;\n\t\tthis.noScrollbar = options.noScrollbar ? options.noScrollbar : false;\n\t\tthis.className = options.className ? options.className : null;\n\t\tthis.wrapper = null;\n\t\tthis.leftEar = null;\n\t\tthis.rightEar = null;\n\t\tthis.parentContainer = this.container.parentNode;\n\t\tthis.delay = 6;\n\t\tthis.scrollTimeout = null;\n\t\tthis.cache = new Cache.MemoryCache();\n\t}\n\n\tbindEvents() {\n\t\tthis.container.addEventListener('scroll', this.toggleEars.bind(this));\n\t\tthis.container.addEventListener('wheel', this.onWheel.bind(this));\n\n\t\tthis.getLeftEar().addEventListener('mouseenter', this.scrollLeft.bind(this));\n\t\tthis.getLeftEar().addEventListener('mouseleave', this.stopScroll.bind(this));\n\t\tthis.getLeftEar().addEventListener('mousedown', this.stopScroll.bind(this));\n\t\tthis.getLeftEar().addEventListener('mouseup', this.scrollLeft.bind(this));\n\n\t\tthis.getRightEar().addEventListener('mouseenter', this.scrollRight.bind(this));\n\t\tthis.getRightEar().addEventListener('mouseleave', this.stopScroll.bind(this));\n\t\tthis.getRightEar().addEventListener('mousedown', this.stopScroll.bind(this));\n\t\tthis.getRightEar().addEventListener('mouseup', this.scrollRight.bind(this));\n\t}\n\n\tinit(): this\n\t{\n\t\tthis.setWrapper();\n\t\tthis.bindEvents();\n\n\t\tsetTimeout(() => {\n\t\t\tif (this.container.scrollWidth > this.container.offsetWidth)\n\t\t\t{\n\t\t\t\tthis.toggleRightEar();\n\n\t\t\t\tlet activeItem = this.container.querySelector('[data-role=\"ui-ears-active\"]');\n\n\t\t\t\tactiveItem ? this.scrollToActiveItem(activeItem) : null;\n\t\t\t}\n\t\t}, 600);\n\t\treturn this;\n\t}\n\n\tscrollToActiveItem(activeItem)\n\t{\n\t\tlet scrollToPoint = activeItem.offsetLeft - (this.container.offsetWidth / 2 - activeItem.offsetWidth / 2);\n\t\tlet scrollWidth = 0;\n\t\tlet interval = setInterval(() => {\n\t\t\tif( scrollWidth >= scrollToPoint ||\n\t\t\t\tscrollWidth + this.container.offsetWidth >= this.container.scrollWidth)\n\t\t\t{\n\t\t\t\tclearInterval(interval);\n\t\t\t}\n\n\t\t\tthis.container.scrollLeft = scrollWidth += 10;\n\t\t},10)\n\t}\n\n\tonWheel(event)\n\t{\n\t\tif (event.deltaY < 0 || event.deltaX > 0)\n\t\t{\n\t\t\tthis.scrollRight();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.scrollLeft();\n\t\t}\n\n\t\tclearTimeout(this.scrollTimeout);\n\t\tthis.scrollTimeout = setTimeout(() => this.stopScroll(), 150);\n\t}\n\n\tsetWrapper() {\n\t\tthis.container.classList.add('ui-ear-container');\n\t\tif (this.noScrollbar)\n\t\t{\n\t\t\tthis.container.classList.add('ui-ear-container-no-scrollbar');\n\t\t}\n\t\tDom.append(this.getWrapper(), this.parentContainer);\n\t}\n\n\tgetWrapper()\n\t{\n\t\treturn this.cache.remember('wrapper', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t\t<div class='ui-ears-wrapper ${this.smallSize ? ' ui-ears-wrapper-sm' : ''} ${this.className ? this.className : ''}'>\n\t\t\t\t\t\t${this.getLeftEar()}\n\t\t\t\t\t\t${this.getRightEar()}\n\t\t\t\t\t\t${this.container}\n\t\t\t\t\t</div>\n\t\t\t\t`;\n\t\t});\n\t}\n\n\tgetLeftEar()\n\t{\n\t\treturn this.cache.remember('leftEar', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t\t<div class='ui-ear ui-ear-left'></div>\n\t\t\t\t`;\n\t\t});\n\t}\n\n\tgetRightEar()\n\t{\n\t\treturn this.cache.remember('rightEar', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t\t<div class='ui-ear ui-ear-right'></div>\n\t\t\t\t`;\n\t\t});\n\t}\n\n\ttoggleEars() {\n\t\tthis.toggleRightEar();\n\t\tthis.toggleLeftEar();\n\t}\n\n\ttoggleRightEar() {\n\t\tif (this.container.scrollWidth > this.container.offsetWidth\n\t\t\t&& (this.container.offsetWidth + this.container.scrollLeft) < this.container.scrollWidth)\n\t\t{\n\t\t\tthis.getRightEar().classList.add('ui-ear-show');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.getRightEar().classList.remove('ui-ear-show');\n\t\t}\n\t}\n\n\ttoggleLeftEar() {\n\t\tif (this.container.scrollLeft > 0)\n\t\t{\n\t\t\tthis.getLeftEar().classList.add('ui-ear-show');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.getLeftEar().classList.remove('ui-ear-show');\n\t\t}\n\t}\n\n\tscrollLeft() {\n\t\tthis.stopScroll('right');\n\n\t\tlet previous = this.container.scrollLeft;\n\t\tthis.container.scrollLeft -= 10;\n\t\tthis.emit('onEarsAreMoved');\n\t\tif (this.container.scrollLeft <= 0 && previous > 0)\n\t\t{\n\t\t\tthis.emit('onEarsAreHidden');\n\t\t}\n\n\t\tthis.setDelay();\n\t\tthis.scrollInterval = setInterval(\n\t\t\tthis.scrollLeft.bind(this),\n\t\t\tthis.delay);\n\n\t\tthis.left = true;\n\t}\n\n\tscrollRight() {\n\t\tthis.stopScroll('left');\n\n\t\tthis.container.scrollLeft += 10;\n\t\tthis.emit('onEarsAreMoved');\n\t\tif (this.container.scrollLeft <= 10)\n\t\t{\n\t\t\tthis.emit('onEarsAreShown');\n\t\t}\n\n\t\tthis.setDelay();\n\t\tthis.scrollInterval = setInterval(\n\t\t\tthis.scrollRight.bind(this),\n\t\t\tthis.delay);\n\n\t\tthis.right = true;\n\t}\n\n\tsetDelay() {\n\t\tif (this.container.scrollWidth < this.container.offsetWidth * 1.6)\n\t\t{\n\t\t\tthis.delay = 20;\n\t\t\treturn;\n\t\t}\n\n\t\tconst fullScrollLeft = this.container.scrollWidth - this.container.offsetWidth;\n\t\tconst conditionRight = this.container.scrollLeft > fullScrollLeft / 1.3;\n\t\tconst conditionLeft = this.container.scrollLeft < fullScrollLeft / 4;\n\n\t\tif (this.container.scrollLeft === fullScrollLeft)\n\t\t{\n\t\t\tthis.delay = 6;\n\t\t}\n\n\t\tif (this.left)\n\t\t{\n\t\t\tif (conditionLeft)\n\t\t\t{\n\t\t\t\tthis.delay = 25;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.delay = 6;\n\t\t\t}\n\t\t}\n\n\t\tif (this.right)\n\t\t{\n\t\t\tif (conditionRight)\n\t\t\t{\n\t\t\t\tthis.delay = 25;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.delay = 6;\n\t\t\t}\n\t\t}\n\t}\n\n\tstopScroll(direction) {\n\t\tif (this.scrollInterval)\n\t\t{\n\t\t\tclearInterval(this.scrollInterval);\n\t\t\tthis.scrollInterval = 0;\n\t\t}\n\n\t\tif (direction === 'right')\n\t\t{\n\t\t\tthis.right = false;\n\t\t}\n\t\telse if (direction === 'left')\n\t\t{\n\t\t\tthis.left = false;\n\t\t}\n\t}\n}\n"],"names":["Ears","options","arguments","setEventNamespace","container","smallSize","noScrollbar","className","wrapper","leftEar","rightEar","parentContainer","parentNode","delay","scrollTimeout","cache","Cache","MemoryCache","addEventListener","toggleEars","bind","onWheel","getLeftEar","scrollLeft","stopScroll","getRightEar","scrollRight","setWrapper","bindEvents","setTimeout","scrollWidth","offsetWidth","toggleRightEar","activeItem","querySelector","scrollToActiveItem","scrollToPoint","offsetLeft","interval","setInterval","clearInterval","event","deltaY","deltaX","clearTimeout","classList","add","Dom","append","getWrapper","remember","Tag","render","toggleLeftEar","remove","previous","emit","setDelay","scrollInterval","left","right","fullScrollLeft","conditionRight","conditionLeft","direction","EventEmitter"],"mappings":";;;;;KAGaA,IAAb;CAAA;;CAEC,gBAAYC,OAAZ,EACA;CAAA;;CAAA;CACC,uGAASC,SAAT;;CACA,UAAKC,iBAAL,CAAuB,YAAvB;;CACA,UAAKC,SAAL,GAAiBH,OAAO,CAACG,SAAzB;CACA,UAAKC,SAAL,GAAiBJ,OAAO,CAACI,SAAR,IAAqB,IAAtC;CACA,UAAKC,WAAL,GAAmBL,OAAO,CAACK,WAAR,GAAsBL,OAAO,CAACK,WAA9B,GAA4C,KAA/D;CACA,UAAKC,SAAL,GAAiBN,OAAO,CAACM,SAAR,GAAoBN,OAAO,CAACM,SAA5B,GAAwC,IAAzD;CACA,UAAKC,OAAL,GAAe,IAAf;CACA,UAAKC,OAAL,GAAe,IAAf;CACA,UAAKC,QAAL,GAAgB,IAAhB;CACA,UAAKC,eAAL,GAAuB,MAAKP,SAAL,CAAeQ,UAAtC;CACA,UAAKC,KAAL,GAAa,CAAb;CACA,UAAKC,aAAL,GAAqB,IAArB;CACA,UAAKC,KAAL,GAAa,IAAIC,eAAK,CAACC,WAAV,EAAb;CAbD;CAcC;;CAjBF;CAAA;CAAA,iCAmBc;CACZ,WAAKb,SAAL,CAAec,gBAAf,CAAgC,QAAhC,EAA0C,KAAKC,UAAL,CAAgBC,IAAhB,CAAqB,IAArB,CAA1C;CACA,WAAKhB,SAAL,CAAec,gBAAf,CAAgC,OAAhC,EAAyC,KAAKG,OAAL,CAAaD,IAAb,CAAkB,IAAlB,CAAzC;CAEA,WAAKE,UAAL,GAAkBJ,gBAAlB,CAAmC,YAAnC,EAAiD,KAAKK,UAAL,CAAgBH,IAAhB,CAAqB,IAArB,CAAjD;CACA,WAAKE,UAAL,GAAkBJ,gBAAlB,CAAmC,YAAnC,EAAiD,KAAKM,UAAL,CAAgBJ,IAAhB,CAAqB,IAArB,CAAjD;CACA,WAAKE,UAAL,GAAkBJ,gBAAlB,CAAmC,WAAnC,EAAgD,KAAKM,UAAL,CAAgBJ,IAAhB,CAAqB,IAArB,CAAhD;CACA,WAAKE,UAAL,GAAkBJ,gBAAlB,CAAmC,SAAnC,EAA8C,KAAKK,UAAL,CAAgBH,IAAhB,CAAqB,IAArB,CAA9C;CAEA,WAAKK,WAAL,GAAmBP,gBAAnB,CAAoC,YAApC,EAAkD,KAAKQ,WAAL,CAAiBN,IAAjB,CAAsB,IAAtB,CAAlD;CACA,WAAKK,WAAL,GAAmBP,gBAAnB,CAAoC,YAApC,EAAkD,KAAKM,UAAL,CAAgBJ,IAAhB,CAAqB,IAArB,CAAlD;CACA,WAAKK,WAAL,GAAmBP,gBAAnB,CAAoC,WAApC,EAAiD,KAAKM,UAAL,CAAgBJ,IAAhB,CAAqB,IAArB,CAAjD;CACA,WAAKK,WAAL,GAAmBP,gBAAnB,CAAoC,SAApC,EAA+C,KAAKQ,WAAL,CAAiBN,IAAjB,CAAsB,IAAtB,CAA/C;CACA;CAhCF;CAAA;CAAA,2BAmCC;CAAA;;CACC,WAAKO,UAAL;CACA,WAAKC,UAAL;CAEAC,MAAAA,UAAU,CAAC,YAAM;CAChB,YAAI,MAAI,CAACzB,SAAL,CAAe0B,WAAf,GAA6B,MAAI,CAAC1B,SAAL,CAAe2B,WAAhD,EACA;CACC,UAAA,MAAI,CAACC,cAAL;;CAEA,cAAIC,UAAU,GAAG,MAAI,CAAC7B,SAAL,CAAe8B,aAAf,CAA6B,8BAA7B,CAAjB;;CAEAD,UAAAA,UAAU,GAAG,MAAI,CAACE,kBAAL,CAAwBF,UAAxB,CAAH,GAAyC,IAAnD;CACA;CACD,OATS,EASP,GATO,CAAV;CAUA,aAAO,IAAP;CACA;CAlDF;CAAA;CAAA,uCAoDoBA,UApDpB,EAqDC;CAAA;;CACC,UAAIG,aAAa,GAAGH,UAAU,CAACI,UAAX,IAAyB,KAAKjC,SAAL,CAAe2B,WAAf,GAA6B,CAA7B,GAAiCE,UAAU,CAACF,WAAX,GAAyB,CAAnF,CAApB;CACA,UAAID,WAAW,GAAG,CAAlB;CACA,UAAIQ,QAAQ,GAAGC,WAAW,CAAC,YAAM;CAChC,YAAIT,WAAW,IAAIM,aAAf,IACHN,WAAW,GAAG,MAAI,CAAC1B,SAAL,CAAe2B,WAA7B,IAA4C,MAAI,CAAC3B,SAAL,CAAe0B,WAD5D,EAEA;CACCU,UAAAA,aAAa,CAACF,QAAD,CAAb;CACA;;CAED,QAAA,MAAI,CAAClC,SAAL,CAAemB,UAAf,GAA4BO,WAAW,IAAI,EAA3C;CACA,OARyB,EAQxB,EARwB,CAA1B;CASA;CAjEF;CAAA;CAAA,4BAmESW,KAnET,EAoEC;CAAA;;CACC,UAAIA,KAAK,CAACC,MAAN,GAAe,CAAf,IAAoBD,KAAK,CAACE,MAAN,GAAe,CAAvC,EACA;CACC,aAAKjB,WAAL;CACA,OAHD,MAKA;CACC,aAAKH,UAAL;CACA;;CAEDqB,MAAAA,YAAY,CAAC,KAAK9B,aAAN,CAAZ;CACA,WAAKA,aAAL,GAAqBe,UAAU,CAAC;CAAA,eAAM,MAAI,CAACL,UAAL,EAAN;CAAA,OAAD,EAA0B,GAA1B,CAA/B;CACA;CAhFF;CAAA;CAAA,iCAkFc;CACZ,WAAKpB,SAAL,CAAeyC,SAAf,CAAyBC,GAAzB,CAA6B,kBAA7B;;CACA,UAAI,KAAKxC,WAAT,EACA;CACC,aAAKF,SAAL,CAAeyC,SAAf,CAAyBC,GAAzB,CAA6B,+BAA7B;CACA;;CACDC,MAAAA,aAAG,CAACC,MAAJ,CAAW,KAAKC,UAAL,EAAX,EAA8B,KAAKtC,eAAnC;CACA;CAzFF;CAAA;CAAA,iCA4FC;CAAA;;CACC,aAAO,KAAKI,KAAL,CAAWmC,QAAX,CAAoB,SAApB,EAA+B,YAAM;CAC3C,eAAOC,aAAG,CAACC,MAAX,uNACgC,MAAI,CAAC/C,SAAL,GAAiB,qBAAjB,GAAyC,EADzE,EAC+E,MAAI,CAACE,SAAL,GAAiB,MAAI,CAACA,SAAtB,GAAkC,EADjH,EAEK,MAAI,CAACe,UAAL,EAFL,EAGK,MAAI,CAACG,WAAL,EAHL,EAIK,MAAI,CAACrB,SAJV;CAOA,OARM,CAAP;CASA;CAtGF;CAAA;CAAA,iCAyGC;CACC,aAAO,KAAKW,KAAL,CAAWmC,QAAX,CAAoB,SAApB,EAA+B,YAAM;CAC3C,eAAOC,aAAG,CAACC,MAAX;CAGA,OAJM,CAAP;CAKA;CA/GF;CAAA;CAAA,kCAkHC;CACC,aAAO,KAAKrC,KAAL,CAAWmC,QAAX,CAAoB,UAApB,EAAgC,YAAM;CAC5C,eAAOC,aAAG,CAACC,MAAX;CAGA,OAJM,CAAP;CAKA;CAxHF;CAAA;CAAA,iCA0Hc;CACZ,WAAKpB,cAAL;CACA,WAAKqB,aAAL;CACA;CA7HF;CAAA;CAAA,qCA+HkB;CAChB,UAAI,KAAKjD,SAAL,CAAe0B,WAAf,GAA6B,KAAK1B,SAAL,CAAe2B,WAA5C,IACC,KAAK3B,SAAL,CAAe2B,WAAf,GAA6B,KAAK3B,SAAL,CAAemB,UAA7C,GAA2D,KAAKnB,SAAL,CAAe0B,WAD9E,EAEA;CACC,aAAKL,WAAL,GAAmBoB,SAAnB,CAA6BC,GAA7B,CAAiC,aAAjC;CACA,OAJD,MAMA;CACC,aAAKrB,WAAL,GAAmBoB,SAAnB,CAA6BS,MAA7B,CAAoC,aAApC;CACA;CACD;CAzIF;CAAA;CAAA,oCA2IiB;CACf,UAAI,KAAKlD,SAAL,CAAemB,UAAf,GAA4B,CAAhC,EACA;CACC,aAAKD,UAAL,GAAkBuB,SAAlB,CAA4BC,GAA5B,CAAgC,aAAhC;CACA,OAHD,MAKA;CACC,aAAKxB,UAAL,GAAkBuB,SAAlB,CAA4BS,MAA5B,CAAmC,aAAnC;CACA;CACD;CApJF;CAAA;CAAA,iCAsJc;CACZ,WAAK9B,UAAL,CAAgB,OAAhB;CAEA,UAAI+B,QAAQ,GAAG,KAAKnD,SAAL,CAAemB,UAA9B;CACA,WAAKnB,SAAL,CAAemB,UAAf,IAA6B,EAA7B;CACA,WAAKiC,IAAL,CAAU,gBAAV;;CACA,UAAI,KAAKpD,SAAL,CAAemB,UAAf,IAA6B,CAA7B,IAAkCgC,QAAQ,GAAG,CAAjD,EACA;CACC,aAAKC,IAAL,CAAU,iBAAV;CACA;;CAED,WAAKC,QAAL;CACA,WAAKC,cAAL,GAAsBnB,WAAW,CAChC,KAAKhB,UAAL,CAAgBH,IAAhB,CAAqB,IAArB,CADgC,EAEhC,KAAKP,KAF2B,CAAjC;CAIA,WAAK8C,IAAL,GAAY,IAAZ;CACA;CAvKF;CAAA;CAAA,kCAyKe;CACb,WAAKnC,UAAL,CAAgB,MAAhB;CAEA,WAAKpB,SAAL,CAAemB,UAAf,IAA6B,EAA7B;CACA,WAAKiC,IAAL,CAAU,gBAAV;;CACA,UAAI,KAAKpD,SAAL,CAAemB,UAAf,IAA6B,EAAjC,EACA;CACC,aAAKiC,IAAL,CAAU,gBAAV;CACA;;CAED,WAAKC,QAAL;CACA,WAAKC,cAAL,GAAsBnB,WAAW,CAChC,KAAKb,WAAL,CAAiBN,IAAjB,CAAsB,IAAtB,CADgC,EAEhC,KAAKP,KAF2B,CAAjC;CAIA,WAAK+C,KAAL,GAAa,IAAb;CACA;CAzLF;CAAA;CAAA,+BA2LY;CACV,UAAI,KAAKxD,SAAL,CAAe0B,WAAf,GAA6B,KAAK1B,SAAL,CAAe2B,WAAf,GAA6B,GAA9D,EACA;CACC,aAAKlB,KAAL,GAAa,EAAb;CACA;CACA;;CAED,UAAMgD,cAAc,GAAG,KAAKzD,SAAL,CAAe0B,WAAf,GAA6B,KAAK1B,SAAL,CAAe2B,WAAnE;CACA,UAAM+B,cAAc,GAAG,KAAK1D,SAAL,CAAemB,UAAf,GAA4BsC,cAAc,GAAG,GAApE;CACA,UAAME,aAAa,GAAG,KAAK3D,SAAL,CAAemB,UAAf,GAA4BsC,cAAc,GAAG,CAAnE;;CAEA,UAAI,KAAKzD,SAAL,CAAemB,UAAf,KAA8BsC,cAAlC,EACA;CACC,aAAKhD,KAAL,GAAa,CAAb;CACA;;CAED,UAAI,KAAK8C,IAAT,EACA;CACC,YAAII,aAAJ,EACA;CACC,eAAKlD,KAAL,GAAa,EAAb;CACA,SAHD,MAIK;CACJ,eAAKA,KAAL,GAAa,CAAb;CACA;CACD;;CAED,UAAI,KAAK+C,KAAT,EACA;CACC,YAAIE,cAAJ,EACA;CACC,eAAKjD,KAAL,GAAa,EAAb;CACA,SAHD,MAIK;CACJ,eAAKA,KAAL,GAAa,CAAb;CACA;CACD;CACD;CAhOF;CAAA;CAAA,+BAkOYmD,SAlOZ,EAkOuB;CACrB,UAAI,KAAKN,cAAT,EACA;CACClB,QAAAA,aAAa,CAAC,KAAKkB,cAAN,CAAb;CACA,aAAKA,cAAL,GAAsB,CAAtB;CACA;;CAED,UAAIM,SAAS,KAAK,OAAlB,EACA;CACC,aAAKJ,KAAL,GAAa,KAAb;CACA,OAHD,MAIK,IAAII,SAAS,KAAK,MAAlB,EACL;CACC,aAAKL,IAAL,GAAY,KAAZ;CACA;CACD;CAjPF;CAAA;CAAA,EAA0BM,6BAA1B;;;;;;;;"}