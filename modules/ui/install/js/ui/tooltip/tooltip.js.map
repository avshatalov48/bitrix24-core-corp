{"version":3,"file":"tooltip.js","sources":["src/tooltip.js","src/balloon.js","src/index.js"],"sourcesContent":["export class Tooltip\n{\n\tstatic disabled = false;\n\tstatic tooltipsList =  {};\n\n\tstatic disable()\n\t{\n\t\tthis.disabled = true;\n\t}\n\n\tstatic enable()\n\t{\n\t\tthis.disabled = false;\n\t}\n\n\tstatic getDisabledStatus()\n\t{\n\t\treturn this.disabled;\n\t}\n\n\tstatic getLoader()\n\t{\n\t\treturn '/bitrix/tools/tooltip.php';\n\t}\n\n\tstatic getIdPrefix()\n\t{\n\t\treturn 'bx-ui-tooltip-';\n\t}\n}\n","import {Type, ajax, Loc} from 'main.core';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\n\nimport {Tooltip} from './tooltip';\n\n\nexport class TooltipBalloon\n{\n\tconstructor(params)\n\t{\n\t\tthis.node = null;\n\t\tthis.userId = null;\n\t\tthis.loader = null;\n\t\tthis.version = null;\n\t\tthis.tracking = false;\n\t\tthis.active = false;\n\t\tthis.width = 364; // 393\n\t\tthis.height = 215; // 302\n\t\tthis.realAnchor = null;\n\t\tthis.coordsLeft = 0;\n\t\tthis.coordsTop = 0;\n\t\tthis.anchorRight = 0;\n\t\tthis.anchorTop = 0;\n\t\tthis.hMirror = false;\n\t\tthis.vMirror = false;\n\t\tthis.rootClassName = '';\n\t\tthis.INFO = null;\n\t\tthis.DIV = null;\n\t\tthis.ROOT_DIV = null;\n\t\tthis.params = {};\n\t\tthis.trackMouseHandle = this.trackMouse.bind(this);\n\n\t\tthis.init(params);\n\t\tthis.create();\n\t\treturn this;\n\t}\n\n\tinit(params)\n\t{\n\t\tthis.node = params.node;\n\t\tthis.userId = params.userId;\n\t\tthis.loader = (Type.isStringFilled(params.loader) ? params.loader : '');\n\n\t\tthis.version = (\n\t\t\t!Type.isUndefined(params.version)\n\t\t\t&& parseInt(params.version) > 0\n\t\t\t\t? parseInt(params.version)\n\t\t\t\t: (Type.isStringFilled(this.loader) ? 2 : 3)\n\t\t);\n\n\t\tthis.rootClassName = this.node.getAttribute('bx-tooltip-classname');\n\n\t\tconst paramsString = this.node.getAttribute('bx-tooltip-params');\n\n\t\tlet anchorParams = {};\n\t\tif (Type.isStringFilled(paramsString))\n\t\t{\n\t\t\tanchorParams = JSON.parse(paramsString);\n\t\t\tif (!Type.isPlainObject(anchorParams))\n\t\t\t{\n\t\t\t\tanchorParams = {};\n\t\t\t}\n\t\t}\n\n\t\tthis.params = anchorParams;\n\t}\n\n\tcreate()\n\t{\n\t\tif (!Tooltip.getDisabledStatus())\n\t\t{\n\t\t\tthis.startTrackMouse();\n\t\t}\n\n\t\tthis.node.addEventListener('mouseout', this.stopTrackMouse.bind(this));\n\t\tEventEmitter.subscribe('SidePanel.Slider:onOpen', this.onSliderOpen.bind(this));\n\t}\n\n\tonSliderOpen()\n\t{\n\t\tif (this.tracking)\n\t\t{\n\t\t\tthis.stopTrackMouse();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.hideTooltip();\n\t\t}\n\t}\n\n\tstartTrackMouse()\n\t{\n\t\tif (this.tracking)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst elCoords = BX.pos(this.node);\n\t\tthis.realAnchor = this.node;\n\n\t\tthis.coordsLeft = (\n\t\t\telCoords.width < 40\n\t\t\t\t? (elCoords.left - 35)\n\t\t\t\t: (elCoords.left + 0)\n\t\t);\n\t\tthis.coordsTop = elCoords.top - 245; // 325\n\t\tthis.anchorRight = elCoords.right;\n\t\tthis.anchorTop = elCoords.top;\n\n\t\tthis.tracking = true;\n\n\t\tdocument.addEventListener('mousemove', this.trackMouseHandle);\n\n\t\tsetTimeout(() => {\n\t\t\tthis.tickTimer();\n\t\t}, 500);\n\n\t\tthis.node.addEventListener('mouseout', this.stopTrackMouse.bind(this));\n\t}\n\n\tstopTrackMouse()\n\t{\n\t\tif (!this.tracking)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tdocument.removeEventListener('mousemove', this.trackMouseHandle);\n\n\t\tthis.active = false;\n\t\tsetTimeout(() => {\n\t\t\tthis.hideTooltip()\n\t\t}, 500);\n\t\tthis.tracking = false;\n\t}\n\n\ttrackMouse(e)\n\t{\n\t\tif (!this.tracking)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst current = (\n\t\t\te && e.pageX\n\t\t\t\t? {\n\t\t\t\t\tx: e.pageX,\n\t\t\t\t\ty: e.pageY,\n\t\t\t\t}\n\t\t\t\t: {\n\t\t\t\t\tx: e.clientX + document.body.scrollLeft,\n\t\t\t\t\ty: e.clientY + document.body.scrollTop,\n\t\t\t\t}\n\t\t);\n\n\t\tif (current.x < 0)\n\t\t{\n\t\t\tcurrent.x = 0;\n\t\t}\n\n\t\tif (current.y < 0)\n\t\t{\n\t\t\tcurrent.y = 0;\n\t\t}\n\n\t\tcurrent.time = this.tracking;\n\n\t\tif (!this.active)\n\t\t{\n\t\t\tthis.active = current;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (\n\t\t\t\tthis.active.x >= (current.x - 1) && this.active.x <= (current.x + 1)\n\t\t\t\t&& this.active.y >= (current.y - 1) && this.active.y <= (current.y + 1)\n\t\t\t)\n\t\t\t{\n\t\t\t\tif ((this.active.time + 20/*2sec*/) <= current.time)\n\t\t\t\t{\n\t\t\t\t\tthis.showTooltip();\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.active = current;\n\t\t\t}\n\t\t}\n\t}\n\n\ttickTimer()\n\t{\n\t\tif (!this.tracking)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.tracking++;\n\t\tif (this.active)\n\t\t{\n\t\t\tif ((this.active.time + 5/*0.5sec*/)  <= this.tracking)\n\t\t\t{\n\t\t\t\tthis.showTooltip();\n\t\t\t}\n\t\t}\n\n\t\tsetTimeout(() => {\n\t\t\tthis.tickTimer();\n\t\t}, 100);\n\t}\n\n\thideTooltip()\n\t{\n\t\tif (this.tracking)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.showOpacityEffect(1);\n\t}\n\n\tshowOpacityEffect(bFade)\n\t{\n\t\tconst steps = 3;\n\t\tconst period = 1;\n\t\tconst delta = 1 / steps;\n\t\tlet i = 0;\n\n\t\tconst intId = setInterval(() => {\n\t\t\ti++;\n\t\t\tif (i > steps)\n\t\t\t{\n\t\t\t\tclearInterval(intId);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst op = (\n\t\t\t\tbFade\n\t\t\t\t\t? 1 - i * delta\n\t\t\t\t\t: i * delta\n\t\t\t);\n\n\t\t\tif (this.DIV != null)\n\t\t\t{\n\t\t\t\ttry\n\t\t\t\t{\n\t\t\t\t\tthis.DIV.style.opacity = op;\n\t\t\t\t}\n\t\t\t\tcatch(e)\n\t\t\t\t{\n\t\t\t\t}\n\t\t\t\tfinally\n\t\t\t\t{\n\t\t\t\t\tif (\n\t\t\t\t\t\t!bFade\n\t\t\t\t\t\t&& i == 1\n\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.DIV.classList.add('ui-tooltip-info-shadow-show');\n\t\t\t\t\t\tthis.DIV.style.display = 'block';\n\t\t\t\t\t}\n\n\t\t\t\t\tif (\n\t\t\t\t\t\tbFade\n\t\t\t\t\t\t&& i == steps\n\t\t\t\t\t\t&& this.DIV\n\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.DIV.classList.remove('ui-tooltip-info-shadow-show');\n\t\t\t\t\t\tthis.DIV.classList.add('ui-tooltip-info-shadow-hide');\n\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\tthis.DIV.style.display = 'none';\n\t\t\t\t\t\t}, 500);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (bFade)\n\t\t\t\t\t{\n\t\t\t\t\t\tEventEmitter.emit('onTooltipHide', new BaseEvent({\n\t\t\t\t\t\t\tcompatData: [ this ],\n\t\t\t\t\t\t}));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}, period);\n\t}\n\n\tshowTooltip()\n\t{\n\t\tconst old = document.getElementById(`${Tooltip.getIdPrefix()}${this.userId}`);\n\n\t\tif (\n\t\t\tTooltip.getDisabledStatus()\n\t\t\t|| (\n\t\t\t\told\n\t\t\t\t&& old.classList.contains('ui-tooltip-info-shadow-show')\n\t\t\t)\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (\n\t\t\tnull == this.DIV\n\t\t\t&& null == this.ROOT_DIV\n\t\t)\n\t\t{\n\t\t\tthis.ROOT_DIV = document.body.appendChild(document.createElement('DIV'));\n\t\t\tthis.ROOT_DIV.style.position = 'absolute';\n\n\t\t\tBX.ZIndexManager.register(this.ROOT_DIV);\n\n\t\t\tthis.DIV = this.ROOT_DIV.appendChild(document.createElement('DIV'));\n\t\t\tthis.DIV.className = 'bx-ui-tooltip-info-shadow';\n\n\t\t\tthis.DIV.style.width = `${this.width}px`;\n\t\t}\n\n\t\tlet left = this.coordsLeft;\n\t\tconst top = this.coordsTop + 30;\n\t\tconst arScroll = BX.GetWindowScrollPos();\n\t\tconst body = document.body;\n\n\t\tthis.hMirror = false;\n\t\tthis.vMirror = ((top - arScroll.scrollTop) < 0);\n\n\t\tif ((body.clientWidth + arScroll.scrollLeft) < (left + this.width))\n\t\t{\n\t\t\tleft = this.anchorRight - this.width;\n\t\t\tthis.hMirror = true;\n\t\t}\n\n\t\tthis.ROOT_DIV.style.left = `${parseInt(left)}px`;\n\t\tthis.ROOT_DIV.style.top = `${parseInt(top)}px`;\n\n\t\tBX.ZIndexManager.bringToFront(this.ROOT_DIV);\n\n\t\tthis.ROOT_DIV.addEventListener('click', (e) => { e.stopPropagation(); });\n\n\t\tif (Type.isStringFilled(this.rootClassName))\n\t\t{\n\t\t\tthis.ROOT_DIV.className = this.rootClassName;\n\t\t}\n\n\t\tconst loader = (\n\t\t\tType.isStringFilled(this.loader)\n\t\t\t\t? this.loader\n\t\t\t\t: Tooltip.getLoader()\n\t\t);\n\n\t\t// create stub\n\t\tlet stubCreated = false;\n\n\t\tif ('' == this.DIV.innerHTML)\n\t\t{\n\t\t\tstubCreated = true;\n\n\t\t\tif (this.version >= 3)\n\t\t\t{\n\t\t\t\tajax.runComponentAction('bitrix:ui.tooltip', 'getData', {\n\t\t\t\t\tmode: 'ajax',\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tuserId: this.userId,\n\t\t\t\t\t\tparams: (!Type.isUndefined(this.params) ? this.params : {}),\n\t\t\t\t\t}\n\t\t\t\t}).then((response) => {\n\n\t\t\t\t\tconst detailUrl = (Type.isStringFilled(response.data.user.detailUrl) ? response.data.user.detailUrl : '');\n\t\t\t\t\tlet cardUserName = '';\n\n\t\t\t\t\tif (Type.isStringFilled(response.data.user.nameFormatted))\n\t\t\t\t\t{\n\t\t\t\t\t\tconst {nameFormatted = ''} = response.data.user;\n\n\t\t\t\t\t\tif (Type.isStringFilled(detailUrl))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcardUserName = `\n\t\t\t\t\t\t\t\t\t\t\t<a\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"bx-ui-tooltip-user-name\"\n\t\t\t\t\t\t\t\t\t\t\t\ttitle=\"${nameFormatted}\"\n\t\t\t\t\t\t\t\t\t\t\t\thref=\"${detailUrl}\"\n\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t${response.data.user.nameFormatted}\n\t\t\t\t\t\t\t\t\t\t\t</a>`\n\t\t\t\t\t\t\t;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcardUserName = `\n\t\t\t\t\t\t\t\t\t\t\t<span \n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"bx-ui-tooltip-user-name\"\n\t\t\t\t\t\t\t\t\t\t\t\ttitle=\"${nameFormatted}\"\n\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\tresponse.data.user.nameFormatted\n\t\t\t\t\t\t\t\t\t\t\t</span>`\n\t\t\t\t\t\t\t;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tlet cardFields = '<div class=\"bx-ui-tooltip-info-data-info\">';\n\t\t\t\t\tObject.keys(response.data.user.cardFields).forEach((fieldCode) => {\n\t\t\t\t\t\tcardFields += `<span class=\"bx-ui-tooltip-field-row bx-ui-tooltip-field-row-${fieldCode.toLowerCase()}\"><span class=\"bx-ui-tooltip-field-name\">${response.data.user.cardFields[fieldCode].name}</span>: <span class=\"bx-ui-tooltip-field-value\">${response.data.user.cardFields[fieldCode].value}</span></span>`;\n\t\t\t\t\t});\n\t\t\t\t\tcardFields += '</div>';\n\n\t\t\t\t\tconst cardFieldsClassName = (\n\t\t\t\t\t\tparseInt(Loc.getMessage('USER_ID')) > 0\n\t\t\t\t\t\t&& response.data.currentUserPerms.operations.videocall\n\t\t\t\t\t\t\t? 'bx-ui-tooltip-info-data-cont-video'\n\t\t\t\t\t\t\t: 'bx-ui-tooltip-info-data-cont'\n\t\t\t\t\t);\n\t\t\t\t\tcardFields = `<div id=\"bx_user_info_data_cont_${response.data.user.id}\" class=\"${cardFieldsClassName}\">${cardFields}</div>`;\n\n\t\t\t\t\tlet photo = '';\n\t\t\t\t\tlet photoClassName = 'bx-ui-tooltip-info-data-photo no-photo';\n\n\t\t\t\t\tif (Type.isStringFilled(response.data.user.photo))\n\t\t\t\t\t{\n\t\t\t\t\t\tphoto = response.data.user.photo;\n\t\t\t\t\t\tphotoClassName = 'bx-ui-tooltip-info-data-photo';\n\t\t\t\t\t}\n\n\t\t\t\t\tphoto = (\n\t\t\t\t\t\tType.isStringFilled(detailUrl)\n\t\t\t\t\t\t\t? `<a href=\"${detailUrl}\" class=\"${photoClassName}\">${photo}</a>`\n\t\t\t\t\t\t\t: `<span class=\"${photoClassName}\">${photo}</span>`\n\t\t\t\t\t);\n\n\t\t\t\t\tlet toolbar = '';\n\t\t\t\t\tlet toolbar2 = '';\n\n\t\t\t\t\tif (\n\t\t\t\t\t\tparseInt(Loc.getMessage('USER_ID')) > 0\n\t\t\t\t\t\t&& response.data.user.active\n\t\t\t\t\t\t&& response.data.user.id != Loc.getMessage('USER_ID')\n\t\t\t\t\t\t&& response.data.currentUserPerms.operations.message\n\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\ttoolbar2 += `<li class=\"bx-icon bx-icon-message\"><span onclick=\"return BX.tooltip.openIM(${response.data.user.id});\">${Loc.getMessage('MAIN_UL_TOOLBAR_MESSAGES_CHAT')}</span></li>`;\n\t\t\t\t\t\ttoolbar2 += `<li id=\"im-video-call-button${response.data.user.id}\" class=\"bx-icon bx-icon-video\"><span onclick=\"return BX.tooltip.openCallTo(${response.data.user.id});\">${Loc.getMessage('MAIN_UL_TOOLBAR_VIDEO_CALL')}</span></li>`;\n\t\t\t\t\t\ttoolbar2 += `<script>Event.ready(() => { BX.tooltip.checkCallTo(\"im-video-call-button${response.data.user.id}\"); };</script>`;\n\t\t\t\t\t}\n\n\t\t\t\t\ttoolbar2 = (Type.isStringFilled(toolbar2) ? `<div class=\"bx-ui-tooltip-info-data-separator\"></div><ul>${toolbar2}</ul>` : '');\n\n\t\t\t\t\tif (response.data.user.hasBirthday)\n\t\t\t\t\t{\n\t\t\t\t\t\ttoolbar += `<li class=\"bx-icon bx-icon-birth\">${Loc.getMessage('MAIN_UL_TOOLBAR_BIRTHDAY')}</li>`;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (response.data.user.hasHonour)\n\t\t\t\t\t{\n\t\t\t\t\t\ttoolbar += `<li class=\"bx-icon bx-icon-featured\">${Loc.getMessage('MAIN_UL_TOOLBAR_HONORED')}</li>`;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (response.data.user.hasAbsence)\n\t\t\t\t\t{\n\t\t\t\t\t\ttoolbar += `<li class=\"bx-icon bx-icon-away\">${Loc.getMessage('MAIN_UL_TOOLBAR_ABSENT')}</li>`;\n\t\t\t\t\t}\n\n\t\t\t\t\ttoolbar = (Type.isStringFilled(toolbar) ? `<ul>${toolbar}</ul>` : '');\n\n\t\t\t\t\tthis.insertData({\n\t\t\t\t\t\tRESULT: {\n\t\t\t\t\t\t\tName: cardUserName,\n\t\t\t\t\t\t\tPosition: (Type.isStringFilled(response.data.user.position) ? response.data.user.position : ''),\n\t\t\t\t\t\t\tCard: cardFields,\n\t\t\t\t\t\t\tPhoto: photo,\n\t\t\t\t\t\t\tToolbar: toolbar,\n\t\t\t\t\t\t\tToolbar2: toolbar2,\n\t\t\t\t\t\t},\n\t\t\t\t\t});\n\t\t\t\t\tthis.adjustPosition();\n\n\t\t\t\t}, () => {});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst url = loader +\n\t\t\t\t\t(loader.indexOf('?') >= 0 ? '&' : '?') +\n\t\t\t\t\t`MODE=UI&MUL_MODE=INFO&USER_ID=${this.userId}` +\n\t\t\t\t\t`&site=${(Loc.getMessage('SITE_ID') || '')}` +\n\t\t\t\t\t`&version=${this.version}` +\n\t\t\t\t\t(\n\t\t\t\t\t\t!Type.isUndefined(this.params)\n\t\t\t\t\t\t&& !Type.isUndefined(this.params.entityType)\n\t\t\t\t\t\t&& Type.isStringFilled(this.params.entityType)\n\t\t\t\t\t\t\t? `&entityType=${this.params.entityType}`\n\t\t\t\t\t\t\t: ''\n\t\t\t\t\t) +\n\t\t\t\t\t(\n\t\t\t\t\t\t!Type.isUndefined(this.params)\n\t\t\t\t\t\t&& !Type.isUndefined(this.params.entityId)\n\t\t\t\t\t\t&& parseInt(this.params.entityId) > 0\n\t\t\t\t\t\t\t? `&entityId=${parseInt(this.params.entityId)}`\n\t\t\t\t\t\t\t: ''\n\t\t\t\t\t);\n\n\t\t\t\tajax.get(url, (data) => {\n\t\t\t\t\tthis.insertData(data);\n\t\t\t\t\tthis.adjustPosition();\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis.DIV.id = `${Tooltip.getIdPrefix()}${this.userId}`;\n\n\t\t\tthis.DIV.innerHTML = '<div class=\"bx-ui-tooltip-info-wrap\">'\n\t\t\t\t+ '<div class=\"bx-ui-tooltip-info-leftcolumn\">'\n\t\t\t\t+ `<div class=\"bx-ui-tooltip-photo\" id=\"${Tooltip.getIdPrefix()}photo-${this.userId}\"><div class=\"bx-ui-tooltip-info-data-loading\">${Loc.getMessage('JS_CORE_LOADING')}</div></div>`\n\t\t\t\t+ '</div>'\n\t\t\t\t+ '<div class=\"bx-ui-tooltip-info-data\">'\n\t\t\t\t+ `<div id=\"${Tooltip.getIdPrefix()}data-card-${this.userId}\"></div>`\n\t\t\t\t+ '<div class=\"bx-ui-tooltip-info-data-tools\">'\n\t\t\t\t+ `<div class=\"bx-ui-tooltip-tb-control bx-ui-tooltip-tb-control-left\" id=\"${Tooltip.getIdPrefix()}toolbar-${this.userId}\"></div>`\n\t\t\t\t+ `<div class=\"bx-ui-tooltip-tb-control bx-ui-tooltip-tb-control-right\" id=\"${Tooltip.getIdPrefix()}toolbar2-${this.userId}\"></div>`\n\t\t\t\t+ '<div class=\"bx-ui-tooltip-info-data-clear\"></div>'\n\t\t\t\t+ '</div>'\n\t\t\t\t+ '</div>'\n\t\t\t\t+ '</div><div class=\"bx-ui-tooltip-info-bottomarea\"></div>';\n\t\t}\n\n\t\tthis.DIV.className = 'bx-ui-tooltip-info-shadow';\n\t\tthis.classNameAnim = 'bx-ui-tooltip-info-shadow-anim';\n\t\tthis.classNameFixed = 'bx-ui-tooltip-info-shadow';\n\n\t\tif (this.hMirror && this.vMirror)\n\t\t{\n\t\t\tthis.DIV.className = 'bx-ui-tooltip-info-shadow-hv';\n\t\t\tthis.classNameAnim = 'bx-ui-tooltip-info-shadow-hv-anim';\n\t\t\tthis.classNameFixed = 'bx-ui-tooltip-info-shadow-hv';\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (this.hMirror)\n\t\t\t{\n\t\t\t\tthis.DIV.className = 'bx-ui-tooltip-info-shadow-h';\n\t\t\t\tthis.classNameAnim = 'bx-ui-tooltip-info-shadow-h-anim';\n\t\t\t\tthis.classNameFixed = 'bx-ui-tooltip-info-shadow-h';\n\t\t\t}\n\n\t\t\tif (this.vMirror)\n\t\t\t{\n\t\t\t\tthis.DIV.className = 'bx-ui-tooltip-info-shadow-v';\n\t\t\t\tthis.classNameAnim = 'bx-ui-tooltip-info-shadow-v-anim';\n\t\t\t\tthis.classNameFixed = 'bx-ui-tooltip-info-shadow-v';\n\t\t\t}\n\t\t}\n\n\t\tthis.DIV.style.display = 'block';\n\n\t\tif (!stubCreated)\n\t\t{\n\t\t\tthis.adjustPosition();\n\t\t}\n\n\t\tthis.showOpacityEffect(0);\n\n\t\tdocument.getElementById(`${Tooltip.getIdPrefix()}${this.userId}`).onmouseover = () => {\n\t\t\tthis.startTrackMouse(this);\n\t\t};\n\n\t\tdocument.getElementById(`${Tooltip.getIdPrefix()}${this.userId}`).onmouseout = () => {\n\t\t\tthis.stopTrackMouse(this);\n\t\t};\n\n\t\tEventEmitter.emit('onTooltipShow', new BaseEvent({\n\t\t\tcompatData: [ this ],\n\t\t}));\n\t}\n\n\tadjustPosition()\n\t{\n\t\tconst tooltipCoords = BX.pos(this.DIV);\n\n\t\tif (this.vMirror)\n\t\t{\n\t\t\tthis.ROOT_DIV.style.top = `${parseInt(this.anchorTop + 13)}px`;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.ROOT_DIV.style.top = `${parseInt(this.anchorTop - tooltipCoords.height - 13 + 12)}px`; // 12 - bottom block\n\t\t}\n\t}\n\n\tinsertData(data)\n\t{\n\t\tif (\n\t\t\tnull != data\n\t\t\t&& (\n\t\t\t\tthis.version >= 3\n\t\t\t\t|| data.length > 0\n\t\t\t)\n\t\t)\n\t\t{\n\t\t\tif (this.version >= 3)\n\t\t\t{\n\t\t\t\tthis.INFO = data;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\teval(`this.INFO = ${data}`);\n\t\t\t}\n\n\t\t\tconst cardEl = document.getElementById(`${Tooltip.getIdPrefix()}data-card-${this.userId}`);\n\t\t\tcardEl.innerHTML = '';\n\t\t\tif (Type.isStringFilled(this.INFO.RESULT.Name))\n\t\t\t{\n\t\t\t\tcardEl.innerHTML += `<div class=\"bx-ui-tooltip-user-name-block\">${this.INFO.RESULT.Name}</div>`;\n\t\t\t}\n\t\t\tif (Type.isStringFilled(this.INFO.RESULT.Position))\n\t\t\t{\n\t\t\t\tcardEl.innerHTML += `<div class=\"bx-ui-tooltip-user-position\">${this.INFO.RESULT.Position}</div>`;\n\t\t\t}\n\t\t\tcardEl.innerHTML += this.INFO.RESULT.Card;\n\n\t\t\tconst photoEl = document.getElementById(`${Tooltip.getIdPrefix()}photo-${this.userId}`);\n\t\t\tphotoEl.innerHTML = this.INFO.RESULT.Photo;\n\n\t\t\tconst toolbarEl = document.getElementById(`${Tooltip.getIdPrefix()}toolbar-${this.userId}`);\n\t\t\ttoolbarEl.innerHTML = this.INFO.RESULT.Toolbar;\n\n\t\t\tconst toolbar2El = document.getElementById(`${Tooltip.getIdPrefix()}toolbar2-${this.userId}`);\n\t\t\ttoolbar2El.innerHTML = this.INFO.RESULT.Toolbar2;\n\n\t\t\tif (Type.isArray(this.INFO.RESULT.Scripts))\n\t\t\t{\n\t\t\t\tthis.INFO.RESULT.Scripts.forEach((script) => {\n\t\t\t\t\teval(script);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tEventEmitter.emit('onTooltipInsertData', new BaseEvent({\n\t\t\t\tcompatData: [ this ],\n\t\t\t}));\n\t\t}\n\t}\n}","import {Browser, Event, Type} from 'main.core';\n\nimport {Tooltip} from './tooltip.js';\nimport {TooltipBalloon} from './balloon.js';\n\nEvent.ready(() => {\n\tif (\n\t\tBrowser.isAndroid()\n\t\t|| Browser.isIOS()\n\t)\n\t{\n\t\treturn;\n\t}\n\n\tdocument.addEventListener('mouseover', (e) => {\n\n\t\tconst node = e.target;\n\n\t\tconst userId = node.getAttribute('bx-tooltip-user-id');\n\t\tconst loader = node.getAttribute('bx-tooltip-loader');\n\n\t\tlet tooltipId = userId; // don't use integer value!\n\n\t\tif (Type.isStringFilled(loader))\n\t\t{\n\t\t\tlet loaderHash = 0;\n\n\t\t\t[...loader].forEach((c, i) => {\n\t\t\t\tloaderHash = (31 * loaderHash + loader.charCodeAt(i)) << 0;\n\t\t\t});\n\n\t\t\ttooltipId = loaderHash + userId;\n\t\t}\n\n\t\tif (Type.isStringFilled(userId))\n\t\t{\n\t\t\tif (null == Tooltip.tooltipsList[tooltipId])\n\t\t\t{\n\t\t\t\tTooltip.tooltipsList[tooltipId] = new TooltipBalloon({\n\t\t\t\t\tuserId: userId,\n\t\t\t\t\tnode: node,\n\t\t\t\t\tloader: loader\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tTooltip.tooltipsList[tooltipId].node = node;\n\t\t\t\tTooltip.tooltipsList[tooltipId].create();\n\t\t\t}\n\n\t\t\te.preventDefault();\n\t\t}\n\t});\n\n});\n\nexport {\n\tTooltip,\n\tTooltipBalloon,\n}"],"names":["Tooltip","disabled","TooltipBalloon","params","node","userId","loader","version","tracking","active","width","height","realAnchor","coordsLeft","coordsTop","anchorRight","anchorTop","hMirror","vMirror","rootClassName","INFO","DIV","ROOT_DIV","trackMouseHandle","trackMouse","bind","init","create","Type","isStringFilled","isUndefined","parseInt","getAttribute","paramsString","anchorParams","JSON","parse","isPlainObject","getDisabledStatus","startTrackMouse","addEventListener","stopTrackMouse","EventEmitter","subscribe","onSliderOpen","hideTooltip","elCoords","BX","pos","left","top","right","document","setTimeout","tickTimer","removeEventListener","e","current","pageX","x","y","pageY","clientX","body","scrollLeft","clientY","scrollTop","time","showTooltip","showOpacityEffect","bFade","steps","period","delta","i","intId","setInterval","clearInterval","op","style","opacity","classList","add","display","remove","emit","BaseEvent","compatData","old","getElementById","getIdPrefix","contains","appendChild","createElement","position","ZIndexManager","register","className","arScroll","GetWindowScrollPos","clientWidth","bringToFront","stopPropagation","getLoader","stubCreated","innerHTML","ajax","runComponentAction","mode","data","then","response","detailUrl","user","cardUserName","nameFormatted","cardFields","Object","keys","forEach","fieldCode","toLowerCase","name","value","cardFieldsClassName","Loc","getMessage","currentUserPerms","operations","videocall","id","photo","photoClassName","toolbar","toolbar2","message","hasBirthday","hasHonour","hasAbsence","insertData","RESULT","Name","Position","Card","Photo","Toolbar","Toolbar2","adjustPosition","url","indexOf","entityType","entityId","get","classNameAnim","classNameFixed","onmouseover","onmouseout","tooltipCoords","length","eval","cardEl","photoEl","toolbarEl","toolbar2El","isArray","Scripts","script","Event","ready","Browser","isAndroid","isIOS","target","tooltipId","loaderHash","c","charCodeAt","tooltipsList","preventDefault"],"mappings":"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"}