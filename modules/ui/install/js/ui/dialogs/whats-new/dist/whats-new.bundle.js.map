{"version":3,"file":"whats-new.bundle.js","sources":["../src/slide.js","../src/whats-new.js"],"sourcesContent":["import { Type, Cache, Tag } from 'main.core';\nimport type { SlideOptions } from './types/slide-options';\n\nexport default class Slide\n{\n\t#id: string = '';\n\t#title: string = '';\n\t#description: string = '';\n\t#className: string = '';\n\t#image: ?string = null;\n\t#video: ?string = null;\n\t#autoplay: boolean = false;\n\t#html: string | HTMLElement | null = null;\n\t#iframe: ?HTMLIFrameElement = null;\n\t#cache = new Cache.MemoryCache();\n\n\tconstructor(options: SlideOptions)\n\t{\n\t\toptions = Type.isPlainObject(options) ? options : {};\n\n\t\tthis.#id = Type.isStringFilled(options.id) ? options.id : this.#id;\n\t\tthis.#className = Type.isStringFilled(options.className) ? options.className : this.#className;\n\t\tthis.#image = Type.isStringFilled(options.image) ? options.image : this.#image;\n\t\tthis.#title = Type.isStringFilled(options.title) ? options.title : this.#title;\n\t\tthis.#description = Type.isStringFilled(options.description) ? options.description : this.#description;\n\n\t\tthis.#setVideo(options.video);\n\t\tthis.#autoplay = Type.isBoolean(options.autoplay) ? options.autoplay : this.#autoplay;\n\n\t\tif (Type.isElementNode(options.html) || Type.isStringFilled(options.html))\n\t\t{\n\t\t\tthis.#html = options.html;\n\t\t}\n\t}\n\n\tgetId(): string\n\t{\n\t\treturn this.#id;\n\t}\n\n\tgetTitle(): string\n\t{\n\t\treturn this.#title;\n\t}\n\n\tgetDescription(): string\n\t{\n\t\treturn this.#description;\n\t}\n\n\tgetBullet(): HTMLElement\n\t{\n\t\treturn this.#cache.remember('bullet', () => {\n\t\t\treturn Tag.render`<span class=\"ui-whats-new-bullet\" title=\"${this.getTitle()}\"></span>`;\n\t\t});\n\t}\n\n\t#setVideo(video: string)\n\t{\n\t\tif (!Type.isStringFilled(video))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst url = new URL(video);\n\t\turl.searchParams.append('enablejsapi', '1');\n\n\t\tthis.#video = url.toString();\n\t}\n\n\tgetIframe(): ?HTMLIFrameElement\n\t{\n\t\treturn this.#iframe;\n\t}\n\n\tpauseVideo(): void\n\t{\n\t\tif (this.getIframe())\n\t\t{\n\t\t\tthis.getIframe().contentWindow.postMessage(JSON.stringify({ event: 'command', func: 'stopVideo' }), '*');\n\t\t}\n\t}\n\n\tplayVideo(): void\n\t{\n\t\tif (this.getIframe())\n\t\t{\n\t\t\tthis.getIframe().contentWindow.postMessage(JSON.stringify({ event: 'command', func: 'playVideo' }), '*');\n\t\t}\n\t}\n\n\tisVideo(): boolean\n\t{\n\t\treturn this.#video !== null;\n\t}\n\n\tisAutoplay(): boolean\n\t{\n\t\treturn this.#autoplay;\n\t}\n\n\tgetContainer(): HTMLElement\n\t{\n\t\treturn this.#cache.remember('container', () => {\n\t\t\tif (this.#video)\n\t\t\t{\n\t\t\t\tthis.#iframe = Tag.render`<iframe \n\t\t\t\t\t\tsrc=\"${this.#video}\" \n\t\t\t\t\t\tid=\"${this.#id}\" \n\t\t\t\t\t\tclass=\"ui-whats-new-slide-item ${this.#className}\" \n\t\t\t\t\t\ttitle=\"YouTube video player\"\n\t\t\t\t\t\tframeborder=\"0\"\n\t\t\t\t\t\tallow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\" \n\t\t\t\t\t\tallowfullscreen></iframe>\n\t\t\t\t`;\n\n\t\t\t\treturn this.#iframe;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\treturn Tag.render`<div \n\t\t\t\t\t\tid=\"${this.#id}\" \n\t\t\t\t\t\tclass=\"ui-whats-new-slide-item ${this.#className}\" \n\t\t\t\t\t\t${this.#image ? 'style=\"background-image: url(' + this.#image + ')\"' : ''}>${this.#html ?? ''}</div>`\n\t\t\t\t\t;\n\t\t\t}\n\t\t});\n\t}\n}","import { Cache, Dom, Event, Tag, Type } from 'main.core';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\nimport { Popup, type PopupOptions } from 'main.popup';\nimport Slide from './slide';\nimport type { WhatsNewOptions } from './types/whats-new-options';\n\nexport default class WhatsNew extends EventEmitter\n{\n\t#popup: Popup = null;\n\t#slides: Array<Slide> = [];\n\t#cache = new Cache.MemoryCache();\n\t#position: ?number = null;\n\t#popupOptions: PopupOptions = {};\n\tinfinityLoop: boolean = false;\n\t#documentKeyDownHandler: Function = null;\n\t#destroying: boolean = false;\n\n\tconstructor(options: WhatsNewOptions)\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.UI.Dialogs.WhatsNew');\n\n\t\toptions = Type.isPlainObject(options) ? options : {};\n\n\t\tif (!Type.isArrayFilled(options.slides))\n\t\t{\n\t\t\tthrow new Error('NewStructurePopup: \"items\" parameter is required.');\n\t\t}\n\n\t\toptions.slides.forEach(slideOptions => {\n\t\t\tthis.#slides.push(new Slide(slideOptions));\n\t\t});\n\n\t\tif (Type.isPlainObject(options.popupOptions))\n\t\t{\n\t\t\tthis.#popupOptions = options.popupOptions;\n\t\t}\n\n\t\tif (Type.isBoolean(options.infinityLoop))\n\t\t{\n\t\t\tthis.infinityLoop = options.infinityLoop;\n\t\t}\n\n\t\tthis.#documentKeyDownHandler = this.#handleDocumentKeyDown.bind(this);\n\t\tthis.subscribeFromOptions(options.events);\n\t}\n\n\tgetPopup(): Popup\n\t{\n\t\tif (this.#popup !== null)\n\t\t{\n\t\t\treturn this.#popup;\n\t\t}\n\n\t\tthis.#popup = new Popup(Object.assign({\n\t\t\tclassName: 'ui-whats-new-popup',\n\t\t\tcloseIcon: false,\n\t\t\tcloseByEsc: true,\n\t\t\toverlay: true,\n\t\t\tcacheable: false,\n\t\t\tanimation: 'scale',\n\t\t\tcontent: this.getContentContainer(),\n\t\t\twidth: 808,\n\t\t\theight: 503,\n\t\t\tautoHide: true\n\t\t}, this.#popupOptions));\n\n\t\tthis.#popup.subscribe('onDestroy', this.#handlePopupDestroy.bind(this));\n\t\tthis.#popup.subscribe('onShow', this.#handlePopupShow.bind(this));\n\t\tthis.#popup.subscribe('onClose', this.#handlePopupClose.bind(this));\n\n\t\tthis.selectSlide();\n\n\t\treturn this.#popup;\n\t}\n\n\tgetCurrentSlide(): Slide\n\t{\n\t\treturn this.#slides[this.#position];\n\t}\n\n\tgetSlides(): Slide[]\n\t{\n\t\treturn this.#slides;\n\t}\n\n\tgetSlideByPosition(position: number): ?Slide\n\t{\n\t\treturn this.#slides[position] ?? null;\n\t}\n\n\tgetPositionBySlide(slide: Slide): ?number\n\t{\n\t\tfor (let position = 0; position < this.#slides.length; position++)\n\t\t{\n\t\t\tconst current = this.#slides[position];\n\t\t\tif (current === slide)\n\t\t\t{\n\t\t\t\treturn position;\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tgetFirstPosition(): number\n\t{\n\t\treturn 0;\n\t}\n\n\tgetLastPosition(): number\n\t{\n\t\treturn this.#slides.length - 1;\n\t}\n\n\tgetContentContainer(): HTMLElement\n\t{\n\t\treturn this.#cache.remember('content', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-whats-new-content\"> \n\t\t\t\t\t${this.getHeadContainer()}\n\t\t\t\t\t<div class=\"ui-whats-new-slide-wrap\"> \n\t\t\t\t\t\t${this.getPrevBtn()} \n\t\t\t\t\t\t${this.getNextBtn()} \n\t\t\t\t\t\t<div class=\"ui-whats-new-slide-inner\">${this.getSliderBox()}</div>  \n\t\t\t\t\t</div> \n\t\t\t\t\t<div class=\"ui-whats-new-bullet-box\" onclick=\"${this.#handleBulletClick.bind(this)}\">${\n\t\t\t\t\t\tthis.#slides.map(slide => slide.getBullet())\n\t\t\t\t\t}</div>\n\t\t\t\t\t<div class=\"ui-whats-new-close-btn\" onclick=\"${this.hide.bind(this)}\"></div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetHeadContainer(): HTMLElement\n\t{\n\t\treturn this.#cache.remember('head', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-whats-new-head\"> \n\t\t\t\t\t${this.getTitleContainer()}\n\t\t\t\t\t${this.getDescContainer()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetTitleContainer(): HTMLElement\n\t{\n\t\treturn this.#cache.remember('title', () => {\n\t\t\treturn Tag.render`<div class=\"ui-whats-new-title\"></div>`;\n\t\t});\n\t}\n\n\tgetDescContainer(): HTMLElement\n\t{\n\t\treturn this.#cache.remember('description', () => {\n\t\t\treturn Tag.render`<div class=\"ui-whats-new-desc\"></div>`;\n\t\t});\n\t}\n\n\tgetSliderBox(): HTMLElement\n\t{\n\t\treturn this.#cache.remember('sliderBox', () => {\n\t\t\treturn Tag.render`<div class=\"ui-whats-new-slide-box\">${\n\t\t\t\tthis.#slides.map(slide => slide.getContainer())\n\t\t\t}</div>`;\n\t\t});\n\t}\n\n\tgetPrevBtn(): HTMLElement\n\t{\n\t\treturn this.#cache.remember('prevBtn', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div \n\t\t\t\t\tclass=\"ui-whats-new-slide-btn --btn-prev\" \n\t\t\t\t\tonclick=\"${this.selectPrevSlide.bind(this)}\">\n\t\t\t\t</div>`\n\t\t\t\t;\n\t\t});\n\t}\n\n\tgetNextBtn(): HTMLElement\n\t{\n\t\treturn this.#cache.remember('nextBtn', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div \n\t\t\t\t\tclass=\"ui-whats-new-slide-btn --btn-next\" \n\t\t\t\t\tonclick=\"${this.selectNextSlide.bind(this)}\">\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tshow(): void\n\t{\n\t\tthis.getPopup().show();\n\t}\n\n\thide(): void\n\t{\n\t\tthis.getPopup().close();\n\t}\n\n\tdestroy(): void\n\t{\n\t\tif (this.#destroying)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#destroying = true;\n\t\tthis.emit('onDestroy');\n\n\t\tthis.#unbindEvents();\n\t\tthis.getPopup().destroy();\n\n\t\tfor (const property in this)\n\t\t{\n\t\t\tif (this.hasOwnProperty(property))\n\t\t\t{\n\t\t\t\tdelete this[property];\n\t\t\t}\n\t\t}\n\n\t\tObject.setPrototypeOf(this, null);\n\t}\n\n\tselectPrevSlide(): void\n\t{\n\t\tif (this.infinityLoop && this.#position === this.getFirstPosition())\n\t\t{\n\t\t\tthis.selectSlide(this.getLastPosition());\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.selectSlide(this.#position - 1);\n\t\t}\n\t}\n\n\tselectNextSlide(): void\n\t{\n\t\tif (this.infinityLoop && this.#position === this.getLastPosition())\n\t\t{\n\t\t\tthis.selectSlide(this.getFirstPosition());\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.selectSlide(this.#position + 1);\n\t\t}\n\t}\n\n\tselectSlide(position = 0): void\n\t{\n\t\tconst firstPosition = this.getFirstPosition();\n\t\tconst lastPosition = this.getLastPosition();\n\n\t\tposition = Math.min(Math.max(position, firstPosition), lastPosition);\n\t\tif (this.#position === position)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst currentSlide = this.getSlideByPosition(this.#position);\n\t\tconst newSlide = this.getSlideByPosition(position);\n\t\tconst event = new BaseEvent({ data: { currentSlide, newSlide } });\n\n\t\tthis.emit('Slide:onBeforeSelect', event);\n\t\tif (event.isDefaultPrevented())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#position = position;\n\n\t\t// Ears\n\t\tif (!this.infinityLoop)\n\t\t{\n\t\t\tif (position === firstPosition)\n\t\t\t{\n\t\t\t\tDom.addClass(this.getPrevBtn(), '--hide');\n\t\t\t\tDom.removeClass(this.getNextBtn(), '--hide');\n\t\t\t}\n\t\t\telse if (position === lastPosition)\n\t\t\t{\n\t\t\t\tDom.removeClass(this.getPrevBtn(), '--hide');\n\t\t\t\tDom.addClass(this.getNextBtn(), '--hide');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tDom.removeClass(this.getPrevBtn(), '--hide');\n\t\t\t\tDom.removeClass(this.getNextBtn(), '--hide');\n\t\t\t}\n\t\t}\n\n\t\t// Sliding\n\t\tDom.style(\n\t\t\tthis.getSliderBox(),\n\t\t\t{\n\t\t\t\ttransform: 'translateX(' + (-position * this.getSliderBox().offsetWidth) + 'px)',\n\t\t\t}\n\t\t);\n\n\t\t// Bullets\n\t\tthis.#slides.forEach((slide, index) => {\n\t\t\tif (position === index)\n\t\t\t{\n\t\t\t\tDom.addClass(slide.getBullet(), '--active');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tDom.removeClass(slide.getBullet(), '--active');\n\t\t\t}\n\t\t});\n\n\t\t// Header\n\t\tDom.style(this.getHeadContainer(), { opacity: 0, transition: 'none' });\n\n\t\tconst title = newSlide.getTitle().trim();\n\t\tconst desc = newSlide.getDescription().trim();\n\n\t\tif (Type.isStringFilled(title))\n\t\t{\n\t\t\tDom.removeClass(this.getContentContainer(), '--empty-head');\n\t\t\tif (Type.isStringFilled(desc))\n\t\t\t{\n\t\t\t\tDom.removeClass(this.getContentContainer(), '--empty-desc');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tDom.addClass(this.getContentContainer(), '--empty-desc');\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.addClass(this.getContentContainer(), '--empty-head');\n\t\t}\n\n\t\tthis.getTitleContainer().innerHTML = title;\n\t\tthis.getDescContainer().innerHTML = desc;\n\n\t\tconst finalize = () => {\n\t\t\tthis.getSlides().forEach((slide: Slide) => {\n\t\t\t\tif (this.getCurrentSlide() !== slide)\n\t\t\t\t{\n\t\t\t\t\tDom.style(slide.getContainer(), 'opacity', null);\n\t\t\t\t\tslide.pauseVideo();\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tDom.style(this.getHeadContainer(), 'opacity', null);\n\t\t};\n\n\t\tif (newSlide.isVideo() && newSlide.isAutoplay())\n\t\t{\n\t\t\tnewSlide.playVideo();\n\t\t}\n\n\t\tsetTimeout(finalize, 700);\n\n\t\trequestAnimationFrame(() => {\n\t\t\trequestAnimationFrame(() => {\n\t\t\t\tif (currentSlide)\n\t\t\t\t{\n\t\t\t\t\tDom.style(currentSlide.getContainer(), 'opacity', 0);\n\t\t\t\t}\n\t\t\t\tDom.style(newSlide.getContainer(), 'opacity', 1);\n\t\t\t\tDom.style(this.getHeadContainer(), 'opacity', 1);\n\t\t\t\tDom.style(this.getHeadContainer(), 'transition', null);\n\t\t\t});\n\t\t});\n\n\t\tthis.emit('Slide:onSelect', { slide: newSlide });\n\t}\n\n\t#bindEvents(): void\n\t{\n\t\tEvent.bind(document, 'keydown', this.#documentKeyDownHandler);\n\t}\n\n\t#unbindEvents(): void\n\t{\n\t\tEvent.unbind(document, 'keydown', this.#documentKeyDownHandler);\n\t}\n\n\t#handleDocumentKeyDown(event: KeyboardEvent): void\n\t{\n\t\tif (!this.getPopup().isShown())\n\t\t{\n\t\t\tthis.#unbindEvents();\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (event.metaKey || event.ctrlKey || event.altKey)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (event.key === 'ArrowLeft')\n\t\t{\n\t\t\tthis.selectPrevSlide();\n\t\t}\n\t\telse if (event.key === 'ArrowRight')\n\t\t{\n\t\t\tthis.selectNextSlide();\n\t\t}\n\t}\n\n\t#handleBulletClick(event: MouseEvent): void\n\t{\n\t\tconst slide = this.getSlides().find((slide: Slide) => {\n\t\t\treturn event.target === slide.getBullet();\n\t\t});\n\n\t\tconst position = this.getPositionBySlide(slide);\n\t\tif (position !== null)\n\t\t{\n\t\t\tthis.selectSlide(position);\n\t\t}\n\t}\n\n\t#handlePopupShow(): void\n\t{\n\t\tthis.#bindEvents();\n\n\t\tthis.emit('onShow');\n\t}\n\n\t#handlePopupClose(): void\n\t{\n\t\tthis.#unbindEvents();\n\t\tthis.getSlides().forEach((slide: Slide) => {\n\t\t\tslide.pauseVideo();\n\t\t});\n\n\t\tthis.emit('onHide');\n\t}\n\n\t#handlePopupDestroy(): void\n\t{\n\t\tthis.getSlides().forEach((slide: Slide) => {\n\t\t\tslide.pauseVideo();\n\t\t});\n\n\t\tthis.destroy();\n\t}\n}"],"names":["Slide","constructor","options","Cache","MemoryCache","Type","isPlainObject","isStringFilled","id","className","image","title","description","video","isBoolean","autoplay","isElementNode","html","getId","getTitle","getDescription","getBullet","remember","Tag","render","getIframe","pauseVideo","contentWindow","postMessage","JSON","stringify","event","func","playVideo","isVideo","isAutoplay","getContainer","url","URL","searchParams","append","toString","WhatsNew","EventEmitter","infinityLoop","setEventNamespace","isArrayFilled","slides","Error","forEach","slideOptions","push","popupOptions","bind","subscribeFromOptions","events","getPopup","Popup","Object","assign","closeIcon","closeByEsc","overlay","cacheable","animation","content","getContentContainer","width","height","autoHide","subscribe","selectSlide","getCurrentSlide","getSlides","getSlideByPosition","position","getPositionBySlide","slide","length","current","getFirstPosition","getLastPosition","getHeadContainer","getPrevBtn","getNextBtn","getSliderBox","map","hide","getTitleContainer","getDescContainer","selectPrevSlide","selectNextSlide","show","close","destroy","emit","property","hasOwnProperty","setPrototypeOf","firstPosition","lastPosition","Math","min","max","currentSlide","newSlide","BaseEvent","data","isDefaultPrevented","Dom","addClass","removeClass","style","transform","offsetWidth","index","opacity","transition","trim","desc","innerHTML","finalize","setTimeout","requestAnimationFrame","Event","document","unbind","isShown","metaKey","ctrlKey","altKey","key","find","target"],"mappings":"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"}