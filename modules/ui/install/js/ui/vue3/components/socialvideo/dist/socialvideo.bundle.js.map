{"version":3,"file":"socialvideo.bundle.js","sources":["../src/socialvideo.js"],"sourcesContent":["/**\n * Bitrix UI\n * Social Video Vue component\n *\n * @package bitrix\n * @subpackage ui\n * @copyright 2001-2021 Bitrix\n */\n\nimport \"./socialvideo.css\";\nimport 'main.polyfill.intersectionobserver';\nimport {lazyload } from 'ui.vue3.directives.lazyload';\nimport {BaseEvent, EventEmitter} from \"main.core.events\";\n\nconst State = Object.freeze({\n\tplay: 'play',\n\tpause: 'pause',\n\tstop: 'stop',\n\tnone: 'none',\n});\nexport {State as SocialVideoState};\n\nexport const SocialVideo = {\n\n\tprops:\n\t{\n\t\tid: { default: 0 },\n\t\tsrc: { default: '' },\n\t\tpreview: { default: '' },\n\t\tautoplay: { default: true },\n\t\tcontainerClass: { default: null },\n\t\tcontainerStyle: { default: null },\n\t\telementStyle: { default: null },\n\t\tshowControls: { default: true }\n\t},\n\tdata()\n\t{\n\t\treturn {\n\t\t\tpreload: \"none\",\n\t\t\tpreviewLoaded: false,\n\t\t\tloaded: false,\n\t\t\tloading: false,\n\t\t\tplayAfterLoad: false,\n\t\t\tenterFullscreen: false,\n\t\t\tplayBeforeMute: 2,\n\t\t\tstate: State.none,\n\t\t\tprogress: 0,\n\t\t\ttimeCurrent: 0,\n\t\t\ttimeTotal: 0,\n\t\t\tmuteFlag: true,\n\t\t}\n\t},\n\tdirectives: {\n\t\tlazyload\n\t},\n\tcreated()\n\t{\n\t\tif (!this.preview)\n\t\t{\n\t\t\tthis.previewLoaded = true;\n\t\t\tthis.preload = 'metadata';\n\t\t}\n\n\t\tthis.$Bitrix.eventEmitter.subscribe('ui:socialvideo:play', this.onPlay);\n\t\tthis.$Bitrix.eventEmitter.subscribe('ui:socialvideo:stop', this.onStop);\n\t\tthis.$Bitrix.eventEmitter.subscribe('ui:socialvideo:pause', this.onPause);\n\t\tEventEmitter.subscribe('ui:socialvideo:pause', this.onPause);\n\t},\n\tmounted()\n\t{\n\t\tthis.getObserver().observe(this.$refs.body);\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.$Bitrix.eventEmitter.unsubscribe('ui:socialvideo:play', this.onPlay);\n\t\tthis.$Bitrix.eventEmitter.unsubscribe('ui:socialvideo:stop', this.onStop);\n\t\tthis.$Bitrix.eventEmitter.unsubscribe('ui:socialvideo:pause', this.onPause);\n\t\tEventEmitter.unsubscribe('ui:socialvideo:pause', this.onPause);\n\n\t\tthis.getObserver().unobserve(this.$refs.body);\n\t},\n\twatch:\n\t{\n\t\tid(value)\n\t\t{\n\t\t\tthis.registerPlayer(value);\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tloadFile(play = false)\n\t\t{\n\t\t\tif (this.loaded)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tif (this.loading)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tthis.preload = 'auto';\n\n\t\t\tthis.loading = true;\n\t\t\tthis.playAfterLoad = play;\n\n\t\t\treturn true;\n\t\t},\n\t\tclickToButton(event)\n\t\t{\n\t\t\tif (!this.src)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (this.state === State.play)\n\t\t\t{\n\t\t\t\tthis.getObserver().unobserve(this.$refs.body);\n\t\t\t\tthis.pause();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.play();\n\t\t\t}\n\n\t\t\tevent.stopPropagation();\n\t\t},\n\t\tclickToMute()\n\t\t{\n\t\t\tif (!this.src)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (!this.muteFlag)\n\t\t\t{\n\t\t\t\tthis.mute();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.unmute();\n\t\t\t}\n\n\t\t\tevent.stopPropagation();\n\t\t},\n\t\tclick(event)\n\t\t{\n\t\t\tif (this.autoPlayDisabled)\n\t\t\t{\n\t\t\t\tthis.play();\n\n\t\t\t\tevent.stopPropagation();\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (this.isMobile)\n\t\t\t{\n\t\t\t\tif (this.source().webkitEnterFullscreen)\n\t\t\t\t{\n\t\t\t\t\tthis.unmute();\n\t\t\t\t\tthis.enterFullscreen = true;\n\t\t\t\t\tthis.source().webkitEnterFullscreen();\n\t\t\t\t}\n\t\t\t\telse if (this.source().requestFullscreen)\n\t\t\t\t{\n\t\t\t\t\tthis.unmute();\n\t\t\t\t\tthis.enterFullscreen = true;\n\t\t\t\t\tthis.source().requestFullscreen();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.$emit('click', event);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.$emit('click', event);\n\t\t\t}\n\n\t\t\tevent.stopPropagation();\n\t\t},\n\t\tplay(event)\n\t\t{\n\t\t\tif (!this.loaded)\n\t\t\t{\n\t\t\t\tthis.loadFile(true);\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (!this.source())\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tthis.source().play();\n\t\t},\n\t\tpause()\n\t\t{\n\t\t\tif (!this.source())\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tthis.playAfterLoad = false;\n\n\t\t\tthis.source().pause();\n\t\t},\n\t\tstop()\n\t\t{\n\t\t\tif (!this.source())\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tthis.state = State.stop;\n\t\t\tthis.source().pause();\n\t\t},\n\t\tmute()\n\t\t{\n\t\t\tif (!this.source())\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tthis.muteFlag = true;\n\t\t\tthis.playBeforeMute = 2;\n\t\t\tthis.source().muted = true;\n\t\t},\n\t\tunmute()\n\t\t{\n\t\t\tif (!this.source())\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tthis.muteFlag = false;\n\t\t\tthis.source().muted = false;\n\t\t},\n\t\tsetProgress(percent, pixel = -1)\n\t\t{\n\t\t\tthis.progress = percent;\n\t\t},\n\t\tformatTime(second)\n\t\t{\n\t\t\tsecond = Math.floor(second);\n\n\t\t\tconst hour = Math.floor(second/60/60);\n\t\t\tif (hour > 0)\n\t\t\t{\n\t\t\t\tsecond -= hour*60*60;\n\t\t\t}\n\n\t\t\tconst minute = Math.floor(second/60);\n\t\t\tif (minute > 0)\n\t\t\t{\n\t\t\t\tsecond -= minute*60;\n\t\t\t}\n\n\t\t\treturn (hour > 0? hour+':': '')\n\t\t\t\t\t+ (hour > 0? minute.toString().padStart(2, \"0\")+':': minute+':')\n\t\t\t\t\t+ second.toString().padStart(2, \"0\")\n\t\t},\n\t\tonPlay(event: BaseEvent)\n\t\t{\n\t\t\tconst data = event.getData();\n\n\t\t\tif (data.id !== this.id)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (data.start)\n\t\t\t{\n\t\t\t\tthis.stop();\n\t\t\t}\n\n\t\t\tthis.play();\n\t\t},\n\t\tonStop(event: BaseEvent)\n\t\t{\n\t\t\tconst data = event.getData();\n\n\t\t\tif (data.initiator === this.id)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tthis.stop();\n\t\t},\n\t\tonPause(event: BaseEvent)\n\t\t{\n\t\t\tconst data = event.getData();\n\n\t\t\tif (data.initiator === this.id)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tthis.pause();\n\t\t},\n\t\tsource()\n\t\t{\n\t\t\treturn this.$refs.source;\n\t\t},\n\t\tvideoEventRouter(eventName, event)\n\t\t{\n\t\t\tif (\n\t\t\t\teventName === 'durationchange'\n\t\t\t\t|| eventName === 'loadeddata'\n\t\t\t)\n\t\t\t{\n\t\t\t\tif (!this.source())\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tthis.timeTotal = this.source().duration;\n\t\t\t}\n\t\t\telse if (eventName === 'loadedmetadata')\n\t\t\t{\n\t\t\t\tif (!this.source())\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tthis.timeTotal = this.source().duration;\n\t\t\t\tthis.loaded = true;\n\n\t\t\t\tif (this.playAfterLoad)\n\t\t\t\t{\n\t\t\t\t\tthis.play();\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (\n\t\t\t\teventName === 'abort'\n\t\t\t\t|| eventName === 'error'\n\t\t\t)\n\t\t\t{\n\t\t\t\tconsole.error('BxSocialVideo: load failed', this.id, event);\n\n\t\t\t\tthis.loading = false;\n\t\t\t\tthis.state = State.none;\n\t\t\t\tthis.timeTotal = 0;\n\t\t\t\tthis.preload = 'none';\n\t\t\t}\n\t\t\telse if (\n\t\t\t\teventName === 'canplaythrough'\n\t\t\t)\n\t\t\t{\n\t\t\t\tthis.loading = false;\n\t\t\t\tthis.loaded = true;\n\n\t\t\t\tif (this.playAfterLoad)\n\t\t\t\t{\n\t\t\t\t\tthis.play();\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (eventName === 'volumechange')\n\t\t\t{\n\t\t\t\tif (!this.source())\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tif (this.source().muted)\n\t\t\t\t{\n\t\t\t\t\tthis.mute();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.unmute();\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (eventName === 'timeupdate')\n\t\t\t{\n\t\t\t\tif (!this.source())\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tthis.timeCurrent = this.source().currentTime;\n\n\t\t\t\tif (!this.muteFlag && !this.enterFullscreen && this.timeCurrent === 0)\n\t\t\t\t{\n\t\t\t\t\tif (this.playBeforeMute <= 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.mute();\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.playBeforeMute -= 1;\n\t\t\t\t}\n\n\t\t\t\tthis.setProgress(Math.round(100/this.timeTotal*this.timeCurrent));\n\t\t\t}\n\t\t\telse if (eventName === 'pause')\n\t\t\t{\n\t\t\t\tif (this.state !== State.stop)\n\t\t\t\t{\n\t\t\t\t\tthis.state = State.pause;\n\t\t\t\t}\n\n\t\t\t\tif (this.enterFullscreen)\n\t\t\t\t{\n\t\t\t\t\tthis.enterFullscreen = false;\n\t\t\t\t\tthis.mute();\n\t\t\t\t\tthis.play();\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (eventName === 'play')\n\t\t\t{\n\t\t\t\tthis.state = State.play;\n\n\t\t\t\tif (this.state === State.stop)\n\t\t\t\t{\n\t\t\t\t\tthis.progress = 0;\n\t\t\t\t\tthis.timeCurrent = 0;\n\t\t\t\t}\n\n\t\t\t\tif (this.enterFullscreen)\n\t\t\t\t{\n\t\t\t\t\tthis.enterFullscreen = false;\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tgetObserver()\n\t\t{\n\t\t\tif (this.observer)\n\t\t\t{\n\t\t\t\treturn this.observer;\n\t\t\t}\n\n\t\t\tthis.observer = new IntersectionObserver((entries, observer) =>\n\t\t\t{\n\t\t\t\tif (this.autoPlayDisabled)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tentries.forEach((entry) =>\n\t\t\t\t{\n\t\t\t\t\tif (entry.isIntersecting)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.play();\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.pause();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},{\n\t\t\t\tthreshold: [0, 1]\n\t\t\t});\n\n\t\t\treturn this.observer;\n\t\t},\n\t\tlazyLoadCallback(element)\n\t\t{\n\t\t\tthis.previewLoaded = element.state === 'success';\n\t\t}\n\t},\n\tcomputed:\n\t{\n\t\tState: () => State,\n\t\tautoPlayDisabled()\n\t\t{\n\t\t\treturn !this.autoplay && this.state === State.none;\n\t\t},\n\t\tshowStartButton()\n\t\t{\n\t\t\treturn this.autoPlayDisabled && this.previewLoaded;\n\t\t},\n\t\tshowInterface()\n\t\t{\n\t\t\treturn this.previewLoaded && !this.showStartButton;\n\t\t},\n\t\tlabelTime()\n\t\t{\n\t\t\tif (!this.loaded && !this.timeTotal)\n\t\t\t{\n\t\t\t\treturn '--:--';\n\t\t\t}\n\n\t\t\tlet time;\n\t\t\tif (this.state === State.play)\n\t\t\t{\n\t\t\t\ttime = this.timeTotal - this.timeCurrent;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\ttime = this.timeTotal;\n\t\t\t}\n\n\t\t\treturn this.formatTime(time);\n\t\t},\n\t\tisMobile()\n\t\t{\n\t\t\tconst UA = navigator.userAgent.toLowerCase();\n\n\t\t\treturn (\n\t\t\t\tUA.includes('android')\n\t\t\t\t|| UA.includes('iphone')\n\t\t\t\t|| UA.includes('ipad')\n\t\t\t\t|| UA.includes('bitrixmobile')\n\t\t\t)\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div :class=\"['ui-vue-socialvideo', containerClass, {\n\t\t\t\t'ui-vue-socialvideo-mobile': isMobile,\n\t\t\t}]\" :style=\"containerStyle\" @click=\"click\">\n\t\t\t<transition name=\"ui-vue-socialvideo-animation-fade\">\n\t\t\t\t<div v-if=\"showStartButton && showControls\" class=\"ui-vue-socialvideo-button-start\">\n\t\t\t\t\t<span class=\"ui-vue-socialvideo-button-start-icon\"></span>\n\t\t\t\t</div>\n\t\t\t</transition>\n\t\t\t<transition name=\"ui-vue-socialvideo-animation-fade\">\n\t\t\t\t<div v-if=\"showInterface && showControls\" class=\"ui-vue-socialvideo-overlay-container\">\n\t\t\t\t\t<div class=\"ui-vue-socialvideo-controls-container\" @click=\"clickToButton\">\n\t\t\t\t\t\t<button :class=\"['ui-vue-socialvideo-control', {\n\t\t\t\t\t\t\t'ui-vue-socialvideo-control-loader': loading,\n\t\t\t\t\t\t\t'ui-vue-socialvideo-control-play': !loading && state !== State.play,\n\t\t\t\t\t\t\t'ui-vue-socialvideo-control-pause': !loading && state === State.play,\n\t\t\t\t\t\t}]\"></button>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"ui-vue-socialvideo-info-container\" @click=\"clickToMute\">\n\t\t\t\t\t\t<span class=\"ui-vue-socialvideo-time-current\">{{labelTime}}</span>\n\t\t\t\t\t\t<span :class=\"['ui-vue-socialvideo-sound', {\n\t\t\t\t\t\t\t'ui-vue-socialvideo-sound-on': state !== State.none && !muteFlag,\n\t\t\t\t\t\t\t'ui-vue-socialvideo-sound-off': state !== State.none && muteFlag\n\t\t\t\t\t\t}]\"></span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</transition>\n\t\t\t<div v-if=\"!preview\" class=\"ui-vue-socialvideo-background\" :style=\"{position: (src? 'absolute': 'relative')}\"></div>\n\t\t\t<div class=\"ui-vue-socialvideo-container\" ref=\"body\">\n\t\t\t\t<img \n\t\t\t\t\tv-lazyload=\"{callback: lazyLoadCallback}\"\n\t\t\t\t\tdata-lazyload-dont-hide\n\t\t\t\t\tv-if=\"preview\"\n\t\t\t\t\tclass=\"ui-vue-socialvideo-image-source\"\n\t\t\t\t\t:data-lazyload-src=\"preview\"\n\t\t\t\t\t:style=\"{position: (src? 'absolute': 'relative'), ...elementStyle}\"\n\t\t\t\t/>\n\t\t\t\t<video \n\t\t\t\t\tv-if=\"src\" :src=\"src\" \n\t\t\t\t\tclass=\"ui-vue-socialvideo-source\" \n\t\t\t\t\tref=\"source\"\n\t\t\t\t\t:preload=\"preload\" \n\t\t\t\t\tplaysinline\n\t\t\t\t\tloop \n\t\t\t\t\tmuted\n\t\t\t\t\t:style=\"{opacity: (loaded? 1: 0), ...elementStyle}\"\n\t\t\t\t\t@abort=\"videoEventRouter('abort', $event)\"\n\t\t\t\t\t@error=\"videoEventRouter('error', $event)\"\n\t\t\t\t\t@suspend=\"videoEventRouter('suspend', $event)\"\n\t\t\t\t\t@canplay=\"videoEventRouter('canplay', $event)\"\n\t\t\t\t\t@canplaythrough=\"videoEventRouter('canplaythrough', $event)\"\n\t\t\t\t\t@durationchange=\"videoEventRouter('durationchange', $event)\"\n\t\t\t\t\t@loadeddata=\"videoEventRouter('loadeddata', $event)\"\n\t\t\t\t\t@loadedmetadata=\"videoEventRouter('loadedmetadata', $event)\"\n\t\t\t\t\t@volumechange=\"videoEventRouter('volumechange', $event)\"\n\t\t\t\t\t@timeupdate=\"videoEventRouter('timeupdate', $event)\"\n\t\t\t\t\t@play=\"videoEventRouter('play', $event)\"\n\t\t\t\t\t@playing=\"videoEventRouter('playing', $event)\"\n\t\t\t\t\t@pause=\"videoEventRouter('pause', $event)\"\n\t\t\t\t></video>\n\t\t\t</div>\n\t\t</div>\t\n\t`\n};"],"names":["State","Object","freeze","play","pause","stop","none","SocialVideo","props","id","default","src","preview","autoplay","containerClass","containerStyle","elementStyle","showControls","data","preload","previewLoaded","loaded","loading","playAfterLoad","enterFullscreen","playBeforeMute","state","progress","timeCurrent","timeTotal","muteFlag","directives","lazyload","created","$Bitrix","eventEmitter","subscribe","onPlay","onStop","onPause","EventEmitter","mounted","getObserver","observe","$refs","body","beforeUnmount","unsubscribe","unobserve","watch","value","registerPlayer","methods","loadFile","clickToButton","event","stopPropagation","clickToMute","mute","unmute","click","autoPlayDisabled","isMobile","source","webkitEnterFullscreen","requestFullscreen","$emit","muted","setProgress","percent","pixel","formatTime","second","Math","floor","hour","minute","toString","padStart","getData","start","initiator","videoEventRouter","eventName","duration","console","error","currentTime","round","observer","IntersectionObserver","entries","forEach","entry","isIntersecting","threshold","lazyLoadCallback","element","computed","showStartButton","showInterface","labelTime","time","UA","navigator","userAgent","toLowerCase","includes","template"],"mappings":"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"}