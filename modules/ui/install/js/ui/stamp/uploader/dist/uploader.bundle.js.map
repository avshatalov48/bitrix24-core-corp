{"version":3,"file":"uploader.bundle.js","sources":["../src/header/header.js","../src/upload-layout/upload-layout.js","../src/dropzone/dropzone.js","../src/action-panel/action-panel.js","../src/status/status.js","../src/preview/preview.js","../src/message/message.js","../src/file-select/file-select.js","../src/uploader.js"],"sourcesContent":["import {Tag, Cache, Loc, Type, Dom, Text} from 'main.core';\nimport {Button} from 'ui.buttons';\n\nimport './css/style.css';\n\ntype HeaderOptions = {\n\tcontact: {\n\t\tlabel: string,\n\t\thref: string,\n\t},\n\tcontactsList: Array<any>,\n};\n\nexport default class Header\n{\n\tcache = new Cache.MemoryCache();\n\n\tconstructor(options)\n\t{\n\t\tthis.setOptions(options);\n\t}\n\n\tsetOptions(options: HeaderOptions)\n\t{\n\t\tthis.cache.set('options', {...options});\n\t}\n\n\tgetOptions(): HeaderOptions\n\t{\n\t\treturn this.cache.get('options', {});\n\t}\n\n\tsetValue(value: string)\n\t{\n\t\tif (Type.isString(value) || Type.isNumber(value))\n\t\t{\n\t\t\tthis.getValueLayout().textContent = value;\n\t\t}\n\t}\n\n\tgetValueLayout(): HTMLDivElement\n\t{\n\t\treturn this.cache.remember('valueLayout', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-stamp-uploader-header-text-value\">\n\t\t\t\t\t<span class=\"ui-link\">${Text.encode(this.getOptions().contact.label)}</span>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetChangeContactButton(): Button\n\t{\n\t\treturn this.cache.remember('changeContactButton', () => {\n\t\t\treturn new Button({\n\t\t\t\ttext: Loc.getMessage('UI_STAMP_UPLOADER_HEADER_CHANGE_CONTACT_BUTTON_LABEL'),\n\t\t\t\tsize: Button.Size.EXTRA_SMALL,\n\t\t\t\tcolor: Button.Color.LIGHT_BORDER,\n\t\t\t\tround: true,\n\t\t\t});\n\t\t});\n\t}\n\n\tgetLayout(): HTMLDivElement\n\t{\n\t\treturn this.cache.remember('headerLayout', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-stamp-uploader-header\">\n\t\t\t\t\t<div class=\"ui-stamp-uploader-header-icon\">\n\t\t\t\t\t\t<div class=\"ui-stamp-uploader-header-icon-image\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"ui-stamp-uploader-header-text\">\n\t\t\t\t\t\t<div class=\"ui-stamp-uploader-header-text-label\">\n\t\t\t\t\t\t\t${Loc.getMessage('UI_STAMP_UPLOADER_HEADER_TITLE')}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t${this.getValueLayout()}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"ui-stamp-uploader-header-action\">\n\t\t\t\t\t\t\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tappendTo(target: HTMLElement)\n\t{\n\t\tif (Type.isDomNode(target))\n\t\t{\n\t\t\tDom.append(this.getLayout(), target);\n\t\t}\n\t}\n\n\tprependTo(target: HTMLElement)\n\t{\n\t\tif (Type.isDomNode(target))\n\t\t{\n\t\t\tDom.prepend(this.getLayout(), target);\n\t\t}\n\t}\n\n\trenderTo(target: HTMLElement)\n\t{\n\t\tthis.appendTo(target);\n\t}\n}","import {Cache, Tag} from 'main.core';\n\nimport './css/style.css';\n\ntype UploadLayoutOptions = {\n\tchildren: Array<{getLayout: () => HTMLElement}>,\n}\n\nexport default class UploadLayout\n{\n\tcache = new Cache.MemoryCache();\n\n\tconstructor(options: UploadLayoutOptions)\n\t{\n\t\tthis.setOptions(options);\n\t}\n\n\tsetOptions(options: UploadLayoutOptions)\n\t{\n\t\tthis.cache.set('options', {...options});\n\t}\n\n\tgetOptions(): UploadLayoutOptions\n\t{\n\t\treturn this.cache.get('options', {});\n\t}\n\n\tgetLayout(): HTMLDivElement\n\t{\n\t\treturn this.cache.remember('layout', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-stamp-uploader-upload-layout\">\n\t\t\t\t\t${this.getOptions().children.map((item) => item.getLayout())}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n}","import {EventEmitter, BaseEvent} from 'main.core.events';\nimport {Tag, Cache, Loc} from 'main.core';\n\nimport './css/style.css';\n\ntype DropzoneOptions = {\n\tevents?: {[key: string]: (BaseEvent) => void},\n};\n\nexport default class Dropzone extends EventEmitter\n{\n\tcache = new Cache.MemoryCache();\n\n\tconstructor(options: DropzoneOptions = {})\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.UI.Stamp.Uploader.Dropzone');\n\t\tthis.subscribeFromOptions(options.events);\n\t\tthis.setOptions(options);\n\t}\n\n\tsetOptions(options: DropzoneOptions)\n\t{\n\t\tthis.cache.set('options', {...options});\n\t}\n\n\tgetOptions(): DropzoneOptions\n\t{\n\t\treturn this.cache.get('options', {});\n\t}\n\n\tgetLayout(): HTMLDivElement\n\t{\n\t\treturn this.cache.remember('layout', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-stamp-uploader-dropzone\">\n\t\t\t\t\t<div class=\"ui-stamp-uploader-dropzone-icon\"></div>\n\t\t\t\t\t<div class=\"ui-stamp-uploader-dropzone-header\">\n\t\t\t\t\t\t${Loc.getMessage('UI_STAMP_UPLOADER_DROPZONE_HEADER')}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"ui-stamp-uploader-dropzone-text\">\n\t\t\t\t\t\t${Loc.getMessage('UI_STAMP_UPLOADER_DROPZONE_TEXT')}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n}","import {EventEmitter, BaseEvent} from 'main.core.events';\nimport {Tag, Cache, Loc} from 'main.core';\n\nimport './css/style.css';\n\ntype ActionPanelOptions = {\n\tevents?: {\n\t\tonCropClick: (event: BaseEvent) => void,\n\t},\n};\n\nexport default class ActionPanel extends EventEmitter\n{\n\tcache = new Cache.MemoryCache();\n\n\tconstructor(options: ActionPanelOptions)\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.UI.Stamp.Uploader.ActionPanel');\n\t\tthis.setOptions(options);\n\t}\n\n\tsetOptions(options: ActionPanelOptions)\n\t{\n\t\tthis.cache.set('options', {...options});\n\t}\n\n\tgetOptions(): ActionPanelOptions\n\t{\n\t\treturn this.cache.get('options', {});\n\t}\n\n\tgetCropButton(): HTMLDivElement\n\t{\n\t\treturn this.cache.remember('cropButton', () => {\n\t\t\tconst onClick = (event: MouseEvent) => {\n\t\t\t\tevent.preventDefault();\n\t\t\t\tthis.emit('onCropClick');\n\t\t\t};\n\n\t\t\treturn Tag.render`\n\t\t\t\t<div \n\t\t\t\t\tclass=\"ui-stamp-uploader-crop-button\"\n\t\t\t\t\tonclick=\"${onClick}\"\n\t\t\t\t>\n\t\t\t\t\t${Loc.getMessage('UI_STAMP_UPLOADER_CROP_BUTTON_LABEL')}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetLayout(): HTMLDivElement\n\t{\n\t\treturn this.cache.remember('layout', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-stamp-uploader-action-panel\">\n\t\t\t\t\t${this.getCropButton()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n}","import {Cache, Tag, Text, Dom, Loc} from 'main.core';\nimport {Loader} from 'main.loader';\n\nimport './css/style.css';\n\nexport default class Status\n{\n\tcache = new Cache.MemoryCache();\n\n\tstatic formatSize(bytes: number): {number: number, text: string}\n\t{\n\t\tif (bytes === 0)\n\t\t{\n\t\t\treturn `0 ${Loc.getMessage('UI_STAMP_UPLOADER_UPLOAD_STATUS_SIZE_B')}`;\n\t\t}\n\n\t\tconst sizes = [\n\t\t\tLoc.getMessage('UI_STAMP_UPLOADER_UPLOAD_STATUS_SIZE_B'),\n\t\t\tLoc.getMessage('UI_STAMP_UPLOADER_UPLOAD_STATUS_SIZE_KB'),\n\t\t\tLoc.getMessage('UI_STAMP_UPLOADER_UPLOAD_STATUS_SIZE_MB'),\n\t\t];\n\n\t\tconst textIndex = Math.floor(Math.log(bytes) / Math.log(1024));\n\n\t\treturn {\n\t\t\tnumber: parseFloat((bytes / Math.pow(1024, textIndex)).toFixed(2)),\n\t\t\ttext: sizes[textIndex],\n\t\t};\n\t}\n\n\tgetUploadStatusLayout(): HTMLDivElement\n\t{\n\t\treturn this.cache.remember('statusLayout', () => {\n\t\t\tconst loaderLayout = Tag.render`\n\t\t\t\t<div class=\"ui-stamp-uploader-upload-status-loader\"></div>\n\t\t\t`;\n\t\t\tconst loader = new Loader({target: loaderLayout, mode: 'inline', size: 45});\n\t\t\tvoid loader.show();\n\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-stamp-uploader-upload-status\">\n\t\t\t\t\t${loaderLayout}\n\t\t\t\t\t<div class=\"ui-stamp-uploader-upload-status-text\">\n\t\t\t\t\t\t${Loc.getMessage('UI_STAMP_UPLOADER_UPLOAD_STATUS_TEXT')}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"ui-stamp-uploader-upload-status-percent\">\n\t\t\t\t\t\t${Loc.getMessage('UI_STAMP_UPLOADER_UPLOAD_STATUS_PERCENT')}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"ui-stamp-uploader-upload-status-size\">\n\t\t\t\t\t\t${Loc.getMessage('UI_STAMP_UPLOADER_UPLOAD_STATUS_SIZE')}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tupdateUploadStatus(options: {percent: number, size: number} = {percent: 0, size: 0})\n\t{\n\t\tconst percentNode = this.cache.remember('percentNode', () => {\n\t\t\treturn this.getUploadStatusLayout().querySelector('.ui-stamp-uploader-upload-status-percent');\n\t\t});\n\n\t\tconst sizeNode = this.cache.remember('sizeNode', () => {\n\t\t\treturn this.getUploadStatusLayout().querySelector('.ui-stamp-uploader-upload-status-size');\n\t\t});\n\n\t\tpercentNode.innerHTML = (\n\t\t\tLoc\n\t\t\t\t.getMessage('UI_STAMP_UPLOADER_UPLOAD_STATUS_PERCENT')\n\t\t\t\t.replace('{{number}}', `<strong>${Text.encode(options.percent)}</strong>`)\n\t\t);\n\n\t\tconst formatted = Status.formatSize(options.size);\n\t\tsizeNode.textContent = (\n\t\t\tLoc\n\t\t\t\t.getMessage('UI_STAMP_UPLOADER_UPLOAD_STATUS_SIZE')\n\t\t\t\t.replace('{{number}}', formatted.number)\n\t\t\t\t.replace('{{text}}', formatted.text)\n\t\t);\n\t}\n\n\tgetPreparingStatusLayout(): HTMLDivElement\n\t{\n\t\treturn this.cache.remember('preparingStatusLayout', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-stamp-uploader-preparing-status\">\n\t\t\t\t\t<div class=\"ui-stamp-uploader-preparing-status-icon\"></div>\n\t\t\t\t\t<div class=\"ui-stamp-uploader-preparing-status-text\">\n\t\t\t\t\t\t${Loc.getMessage('UI_STAMP_UPLOADER_PREPARING_STATUS')}\t\t\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetLayout(): HTMLDivElement\n\t{\n\t\treturn this.cache.remember('layout', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-stamp-uploader-status\"></div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tshowUploadStatus(options: {reset: boolean} = {reset: false})\n\t{\n\t\tconst layout = this.getLayout();\n\t\tconst uploadStatusLayout = this.getUploadStatusLayout();\n\t\tconst preparingStatusLayout = this.getPreparingStatusLayout();\n\n\t\tDom.remove(preparingStatusLayout);\n\t\tDom.append(uploadStatusLayout, layout);\n\n\t\tif (options.reset === true)\n\t\t{\n\t\t\tthis.updateUploadStatus({percent: 0, size: 0});\n\t\t}\n\n\t\tthis.setOpacity(1);\n\n\t\tthis.show();\n\t}\n\n\tshowPreparingStatus()\n\t{\n\t\tconst layout = this.getLayout();\n\t\tconst uploadStatusLayout = this.getUploadStatusLayout();\n\t\tconst preparingStatusLayout = this.getPreparingStatusLayout();\n\n\t\tDom.remove(uploadStatusLayout);\n\t\tDom.append(preparingStatusLayout, layout);\n\n\t\tthis.setOpacity(.45);\n\n\t\tthis.show();\n\t}\n\n\tsetOpacity(value: number)\n\t{\n\t\tDom.style(this.getLayout(), 'background-color', `rgba(255, 255, 255, ${value})`);\n\t}\n\n\thide()\n\t{\n\t\tDom.removeClass(this.getLayout(), 'ui-stamp-uploader-status-show');\n\t}\n\n\tshow()\n\t{\n\t\tDom.addClass(this.getLayout(), 'ui-stamp-uploader-status-show');\n\t}\n}","import {BaseEvent, EventEmitter} from 'main.core.events';\nimport {Dom, Tag, Cache, Loc} from 'main.core';\n\nimport './css/style.css';\n\ntype PreviewOptions = {\n\tevents: {\n\t\t[key: string]: (event: BaseEvent) => void,\n\t},\n};\n\nexport default class Preview extends EventEmitter\n{\n\tcache = new Cache.MemoryCache();\n\n\tconstructor(options: PreviewOptions = {})\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.UI.Stamp.Uploader');\n\t\tthis.subscribeFromOptions(options.events);\n\t\tthis.setOptions(options);\n\t}\n\n\tsetOptions(options: PreviewOptions)\n\t{\n\t\tthis.cache.set('options', {...options});\n\t}\n\n\tgetOptions(): PreviewOptions\n\t{\n\t\treturn this.cache.get('options', {});\n\t}\n\n\tgetImagePreviewLayout(): HTMLDivElement\n\t{\n\t\treturn this.cache.remember('imagePreviewLayout', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-stamp-uploader-preview-image\"></div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetActionButtonLayout(): HTMLDivElement\n\t{\n\t\treturn this.cache.remember('actionButtonLayout', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-stamp-uploader-preview-actions-button\"></div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetLayout(): HTMLDivElement\n\t{\n\t\treturn this.cache.remember('layout', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div \n\t\t\t\t\tclass=\"ui-stamp-uploader-preview\" \n\t\t\t\t\ttitle=\"${Loc.getMessage('UI_STAMP_UPLOADER_PREVIEW_TITLE')}\"\n\t\t\t\t>\n\t\t\t\t\t${this.getImagePreviewLayout()}\n\t\t\t\t\t${this.getActionButtonLayout()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tshow(src: string)\n\t{\n\t\tDom.style(this.getImagePreviewLayout(), {\n\t\t\tbackgroundImage: `url(${src})`,\n\t\t});\n\n\t\tDom.addClass(this.getLayout(), 'ui-stamp-uploader-preview-show');\n\t}\n\n\thide()\n\t{\n\t\tDom.removeClass(this.getLayout(), 'ui-stamp-uploader-preview-show');\n\t}\n}","import {Cache, Tag, Loc} from 'main.core';\n\nimport './css/style.css';\n\nexport default class Message\n{\n\tcache = new Cache.MemoryCache();\n\n\tgetLayout(): HTMLDivElement\n\t{\n\t\treturn this.cache.remember('layout', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-stamp-uploader-message\">\n\t\t\t\t\t<div class=\"ui-stamp-uploader-message-icon\"></div>\n\t\t\t\t\t<div class=\"ui-stamp-uploader-message-text\">\n\t\t\t\t\t\t<div class=\"ui-stamp-uploader-message-text-header\">\n\t\t\t\t\t\t\t${Loc.getMessage('UI_STAMP_UPLOADER_SLIDER_MESSAGE_TITLE')}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"ui-stamp-uploader-message-text-description\">\n\t\t\t\t\t\t\t${Loc.getMessage('UI_STAMP_UPLOADER_SLIDER_MESSAGE_DESCRIPTION')}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n}","import {Cache, Loc, Tag} from 'main.core';\nimport {EventEmitter, BaseEvent} from 'main.core.events';\nimport {Button} from 'ui.buttons';\n\nimport './css/style.css';\n\ntype FileSelectOptions = {\n\tevents: {\n\t\t[key: string]: (BaseEvent) => void,\n\t},\n};\n\nexport default class FileSelect extends EventEmitter\n{\n\tcache = new Cache.MemoryCache();\n\n\tconstructor(options: FileSelectOptions = {})\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.UI.Stamp.Uploader.FileSelect');\n\t\tthis.subscribeFromOptions(options.events);\n\t\tthis.setOptions(options);\n\t}\n\n\tsetOptions(options: FileSelectOptions)\n\t{\n\t\tthis.cache.set('options', {...options});\n\t}\n\n\tgetOptions(): FileSelectOptions\n\t{\n\t\treturn this.cache.get('options', {});\n\t}\n\n\tgetTakePhotoButton(): Button\n\t{\n\t\treturn this.cache.remember('takePhotoButton', () => {\n\t\t\treturn new Button({\n\t\t\t\ttext: Loc.getMessage('UI_STAMP_UPLOADER_TAKE_PHOTO_BUTTON_LABEL'),\n\t\t\t\tcolor: Button.Color.LIGHT_BORDER,\n\t\t\t\tsize: Button.Size.LARGE,\n\t\t\t\ticon: Button.Icon.CAMERA,\n\t\t\t\tround: true,\n\t\t\t\tonclick: () => {\n\t\t\t\t\tthis.emit('onTakePhotoClick');\n\t\t\t\t},\n\t\t\t});\n\t\t});\n\t}\n\n\tgetSelectPhotoButton(): Button\n\t{\n\t\treturn this.cache.remember('selectPhotoButton', () => {\n\t\t\treturn new Button({\n\t\t\t\ttext: Loc.getMessage('UI_STAMP_UPLOADER_SELECT_PHOTO_BUTTON_LABEL'),\n\t\t\t\tcolor: Button.Color.LIGHT_BORDER,\n\t\t\t\tsize: Button.Size.LARGE,\n\t\t\t\ticon: Button.Icon.DOWNLOAD,\n\t\t\t\tround: true,\n\t\t\t\tonclick: () => {\n\t\t\t\t\tthis.emit('onTakePhotoClick');\n\t\t\t\t},\n\t\t\t});\n\t\t});\n\t}\n\n\tgetLayout(): HTMLDivElement\n\t{\n\t\treturn this.cache.remember('layout', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-stamp-uploader-file-select\">\n\t\t\t\t\t<div class=\"ui-stamp-uploader-file-select-select-photo\">\n\t\t\t\t\t\t${this.getSelectPhotoButton().render()}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n}","import {EventEmitter, BaseEvent} from 'main.core.events';\nimport {Type, Cache, Tag, Dom, Reflection, Loc} from 'main.core';\nimport {Uploader as FileUploader, UploaderFile} from 'ui.uploader.core';\nimport {Layout} from 'ui.sidepanel.layout';\nimport {Button} from 'ui.buttons';\nimport Header from './header/header';\nimport UploadLayout from './upload-layout/upload-layout';\nimport Dropzone from './dropzone/dropzone';\nimport ActionPanel from './action-panel/action-panel';\nimport Status from './status/status';\nimport Preview from './preview/preview';\nimport Message from './message/message';\nimport FileSelect from './file-select/file-select';\n\nimport './css/style.css';\n\nexport type ContactItem = {\n\tid: number | string,\n\tlabel: string,\n\thref?: string,\n};\n\nexport type UploaderOptions = {\n\tcontroller: {\n\t\tupload: string,\n\t},\n\tmode: $Values<Uploader.Mode>,\n\tcontact: ContactItem,\n\tcontactsList: Array<ContactItem>,\n\tevents: {\n\t\t[key: string]: (event: BaseEvent) => void,\n\t},\n};\n\n/**\n * @namespace BX.UI.Stamp\n */\nexport class Uploader extends EventEmitter\n{\n\tstatic Mode = {\n\t\tSLIDER: 'slider',\n\t\tINLINE: 'inline',\n\t};\n\n\tcache = new Cache.MemoryCache();\n\n\tconstructor(options: UploaderOptions)\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.UI.Stamp.Uploader');\n\t\tthis.subscribeFromOptions(options.events);\n\t\tthis.setOptions(options);\n\n\t\tthis.cache.remember('fileUploader', () => {\n\t\t\tconst dropzoneLayout = this.getDropzone().getLayout();\n\t\t\tconst previewLayout = this.getPreview().getLayout();\n\t\t\tconst fileSelectButtonLayout = this.getFileSelect().getLayout();\n\t\t\treturn new FileUploader({\n\t\t\t\tacceptOnlyImages: true,\n\t\t\t\tcontroller: this.getOptions().controller.upload,\n\t\t\t\tbrowseElement: [\n\t\t\t\t\tdropzoneLayout,\n\t\t\t\t\tpreviewLayout,\n\t\t\t\t\tfileSelectButtonLayout,\n\t\t\t\t],\n\t\t\t\tdropElement: [\n\t\t\t\t\tdropzoneLayout,\n\t\t\t\t\tpreviewLayout,\n\t\t\t\t],\n\t\t\t\timagePreviewHeight: 556,\n\t\t\t\timagePreviewWidth: 1000,\n\t\t\t\tautoUpload: false,\n\t\t\t\tevents: {\n\t\t\t\t\t'File:onAdd': (event: BaseEvent) => {\n\t\t\t\t\t\tconst {file} = event.getData();\n\n\t\t\t\t\t\tthis.getPreview().show(URL.createObjectURL(file.clientPreview));\n\t\t\t\t\t\tthis.setUploaderFile(file);\n\n\t\t\t\t\t\tif (this.getMode() === Uploader.Mode.SLIDER)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.getSliderButtons().saveButton.setDisabled(false);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (this.getMode() === Uploader.Mode.INLINE)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.getInlineSaveButton().setDisabled(false);\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t'File:onUploadProgress': (event: BaseEvent) => {\n\t\t\t\t\t\tconst {progress, file} = event.getData();\n\n\t\t\t\t\t\tthis.getStatus().updateUploadStatus({\n\t\t\t\t\t\t\tpercent: progress,\n\t\t\t\t\t\t\tsize: (file.getSize() / 100) * progress,\n\t\t\t\t\t\t});\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t});\n\t\t});\n\t}\n\n\tstatic #delay(callback: () => void, delay: number)\n\t{\n\t\tconst timeoutId = setTimeout(() => {\n\t\t\tcallback();\n\t\t\tclearTimeout(timeoutId);\n\t\t}, delay);\n\t}\n\n\tgetFileUploader(): FileUploader\n\t{\n\t\treturn this.cache.get('fileUploader');\n\t}\n\n\tsetUploaderFile(file: UploaderFile)\n\t{\n\t\tthis.cache.set('uploaderFile', file);\n\t}\n\n\tgetUploaderFile(): UploaderFile\n\t{\n\t\treturn this.cache.get('uploaderFile', null);\n\t}\n\n\tsetOptions(options: UploaderOptions)\n\t{\n\t\tthis.cache.set('options', {...options});\n\t}\n\n\tgetOptions(): UploaderOptions\n\t{\n\t\treturn this.cache.get('options', {});\n\t}\n\n\tgetMode(): $Values<Uploader.Mode>\n\t{\n\t\tconst {mode} = this.getOptions();\n\t\tif (Object.values(Uploader.Mode).includes(mode))\n\t\t{\n\t\t\treturn mode;\n\t\t}\n\n\t\treturn Uploader.Mode.SLIDER;\n\t}\n\n\tgetHeader(): Header\n\t{\n\t\treturn this.cache.remember('header', () => {\n\t\t\treturn new Header(this.getOptions());\n\t\t});\n\t}\n\n\tgetPreview(): Preview\n\t{\n\t\treturn this.cache.remember('preview', () => {\n\t\t\treturn new Preview({});\n\t\t});\n\t}\n\n\tgetFileSelect(): FileSelect\n\t{\n\t\treturn this.cache.remember('fileSelect', () => {\n\t\t\treturn new FileSelect({\n\t\t\t\tevents: {\n\t\t\t\t\tonTakePhotoClick: () => {\n\t\t\t\t\t\tthis.emit('onTakePhotoClick');\n\t\t\t\t\t},\n\t\t\t\t\tonSelectPhotoClick: () => {\n\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t});\n\t\t});\n\t}\n\n\tgetUploadLayout(): UploadLayout\n\t{\n\t\treturn this.cache.remember('uploadLayout', () => {\n\t\t\treturn new UploadLayout({\n\t\t\t\tchildren: [\n\t\t\t\t\t(() => {\n\t\t\t\t\t\tif (this.getMode() === Uploader.Mode.INLINE)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn this.getFileSelect();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn this.getDropzone();\n\t\t\t\t\t})(),\n\t\t\t\t\tthis.getActionPanel(),\n\t\t\t\t\tthis.getStatus(),\n\t\t\t\t\tthis.getPreview(),\n\t\t\t\t],\n\t\t\t});\n\t\t});\n\t}\n\n\tgetDropzone(): Dropzone\n\t{\n\t\treturn this.cache.remember('dropzone', () => {\n\t\t\treturn new Dropzone({});\n\t\t});\n\t}\n\n\tgetActionPanel(): ActionPanel\n\t{\n\t\treturn this.cache.remember('actionPanel', () => {\n\t\t\treturn new ActionPanel({});\n\t\t});\n\t}\n\n\tgetStatus(): Status\n\t{\n\t\treturn this.cache.remember('status', () => {\n\t\t\treturn new Status();\n\t\t});\n\t}\n\n\tgetLayout(): HTMLDivElement\n\t{\n\t\treturn this.cache.remember('layout', () => {\n\t\t\tconst mode = this.getMode();\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-stamp-uploader ui-stamp-uploader-mode-${mode}\">\n\t\t\t\t\t${(() => {\n\t\t\t\t\t\tif (mode === Uploader.Mode.SLIDER)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn this.getMessage().getLayout();\n\t\t\t\t\t\t}\n\t\t\n\t\t\t\t\t\treturn '';\n\t\t\t\t\t})()}\n\t\t\t\t\t${this.getHeader().getLayout()}\n\t\t\t\t\t${this.getUploadLayout().getLayout()}\n\t\t\t\t\t${(() => {\n\t\t\t\t\t\tif (mode === Uploader.Mode.INLINE)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn Tag.render`\n\t\t\t\t\t\t\t\t<div class=\"ui-stamp-uploader-footer\">\n\t\t\t\t\t\t\t\t\t${this.getInlineSaveButton().render()}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t`;\n\t\t\t\t\t\t}\n\t\t\t\t\n\t\t\t\t\t\treturn '';\n\t\t\t\t\t})()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\trenderTo(target: HTMLElement)\n\t{\n\t\tif (Type.isDomNode(target))\n\t\t{\n\t\t\tDom.append(this.getLayout(), target);\n\t\t}\n\t}\n\n\tupload(): Promise<UploaderFile>\n\t{\n\t\treturn new Promise((resolve) => {\n\t\t\tconst file: UploaderFile = this.getUploaderFile();\n\t\t\tif (file)\n\t\t\t{\n\t\t\t\tthis.getPreview().hide();\n\t\t\t\tthis.getStatus().showUploadStatus({reset: true});\n\t\t\t\tfile.upload();\n\t\t\t\tfile.uploadController.subscribeOnce('onUpload', (event: BaseEvent) => {\n\t\t\t\t\tresolve(event.getData().fileInfo);\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\n\tgetMessage(): Message\n\t{\n\t\treturn this.cache.remember('message', () => {\n\t\t\treturn new Message();\n\t\t});\n\t}\n\n\tgetInlineSaveButton(): Button\n\t{\n\t\treturn this.cache.remember('inlineSaveButton', () => {\n\t\t\tconst button = new Button({\n\t\t\t\ttext: Loc.getMessage('UI_STAMP_UPLOADER_SAVE_BUTTON_LABEL'),\n\t\t\t\tcolor: Button.Color.PRIMARY,\n\t\t\t\tsize: Button.Size.LARGE,\n\t\t\t\tround: true,\n\t\t\t\tonclick: () => {\n\t\t\t\t\tconst saveButton = this.getInlineSaveButton();\n\t\t\t\t\tsaveButton.setWaiting(true);\n\n\t\t\t\t\tthis.upload()\n\t\t\t\t\t\t.then((uploaderFile) => {\n\t\t\t\t\t\t\tUploader.#delay(() => {\n\t\t\t\t\t\t\t\tthis.getPreview().show(uploaderFile.serverPreviewUrl);\n\t\t\t\t\t\t\t\tthis.getStatus().showPreparingStatus();\n\t\t\t\t\t\t\t}, 1000);\n\n\t\t\t\t\t\t\treturn this.emitAsync('onSaveAsync', {file: uploaderFile});\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.then(() => {\n\t\t\t\t\t\t\tthis.getStatus().hide();\n\n\t\t\t\t\t\t\tUploader.#delay(() => {\n\t\t\t\t\t\t\t\tsaveButton.setWaiting(false);\n\t\t\t\t\t\t\t\tsaveButton.setDisabled(true);\n\t\t\t\t\t\t\t}, 500);\n\t\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t});\n\n\t\t\tbutton.setDisabled(true);\n\n\t\t\treturn button;\n\t\t});\n\t}\n\n\tsetSliderButtons(buttons: {saveButton: Button, cancelButton: Button})\n\t{\n\t\tthis.cache.set('sliderButtons', buttons);\n\t}\n\n\tgetSliderButtons(): {saveButton: Button, cancelButton: Button}\n\t{\n\t\treturn this.cache.get('sliderButtons', {saveButton: null, cancelButton: null});\n\t}\n\n\tshow()\n\t{\n\t\tconst SidePanelInstance = Reflection.getClass('BX.SidePanel.Instance');\n\t\tif (Type.isNil(SidePanelInstance))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.getPreview().hide();\n\t\tthis.getStatus().hide();\n\n\t\tSidePanelInstance.open('stampUploader', {\n\t\t\twidth: 640,\n\t\t\tcontentCallback: () => {\n\t\t\t\treturn Layout.createContent({\n\t\t\t\t\textensions: [\n\t\t\t\t\t\t'ui.stamp.uploader',\n\t\t\t\t\t],\n\t\t\t\t\tcontent: () => {\n\t\t\t\t\t\treturn this.getLayout();\n\t\t\t\t\t},\n\t\t\t\t\tdesign: {\n\t\t\t\t\t\tsection: false,\n\t\t\t\t\t},\n\t\t\t\t\tbuttons: ({cancelButton, SaveButton}) => {\n\t\t\t\t\t\tconst saveButton = new SaveButton({\n\t\t\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\t\t\tsaveButton.setWaiting(true);\n\n\t\t\t\t\t\t\t\tthis.upload()\n\t\t\t\t\t\t\t\t\t.then((uploaderFile) => {\n\t\t\t\t\t\t\t\t\t\tUploader.#delay(() => {\n\t\t\t\t\t\t\t\t\t\t\tthis.getPreview().show(uploaderFile.serverPreviewUrl);\n\t\t\t\t\t\t\t\t\t\t\tthis.getStatus().showPreparingStatus();\n\t\t\t\t\t\t\t\t\t\t}, 1000);\n\n\t\t\t\t\t\t\t\t\t\treturn this.emitAsync('onSaveAsync', {file: uploaderFile});\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t.then(() => {\n\t\t\t\t\t\t\t\t\t\tthis.getStatus().hide();\n\n\t\t\t\t\t\t\t\t\t\tUploader.#delay(() => {\n\t\t\t\t\t\t\t\t\t\t\tsaveButton.setWaiting(false);\n\t\t\t\t\t\t\t\t\t\t\tsaveButton.setDisabled(true);\n\t\t\t\t\t\t\t\t\t\t\tBX.SidePanel.Instance.close();\n\t\t\t\t\t\t\t\t\t\t}, 500);\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tsaveButton.setDisabled(true);\n\t\t\t\t\t\tthis.setSliderButtons({saveButton, cancelButton});\n\n\t\t\t\t\t\treturn [\n\t\t\t\t\t\t\tsaveButton,\n\t\t\t\t\t\t\tcancelButton,\n\t\t\t\t\t\t];\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t},\n\t\t});\n\t}\n}"],"names":["Header","constructor","options","cache","Cache","MemoryCache","setOptions","set","getOptions","get","setValue","value","Type","isString","isNumber","getValueLayout","textContent","remember","Tag","render","Text","encode","contact","label","getChangeContactButton","Button","text","Loc","getMessage","size","Size","EXTRA_SMALL","color","Color","LIGHT_BORDER","round","getLayout","appendTo","target","isDomNode","Dom","append","prependTo","prepend","renderTo","UploadLayout","children","map","item","Dropzone","EventEmitter","setEventNamespace","subscribeFromOptions","events","ActionPanel","getCropButton","onClick","event","preventDefault","emit","Status","formatSize","bytes","sizes","textIndex","Math","floor","log","number","parseFloat","pow","toFixed","getUploadStatusLayout","loaderLayout","loader","Loader","mode","show","updateUploadStatus","percent","percentNode","querySelector","sizeNode","innerHTML","replace","formatted","getPreparingStatusLayout","showUploadStatus","reset","layout","uploadStatusLayout","preparingStatusLayout","remove","setOpacity","showPreparingStatus","style","hide","removeClass","addClass","Preview","getImagePreviewLayout","getActionButtonLayout","src","backgroundImage","Message","FileSelect","getTakePhotoButton","LARGE","icon","Icon","CAMERA","onclick","getSelectPhotoButton","DOWNLOAD","Uploader","dropzoneLayout","getDropzone","previewLayout","getPreview","fileSelectButtonLayout","getFileSelect","FileUploader","acceptOnlyImages","controller","upload","browseElement","dropElement","imagePreviewHeight","imagePreviewWidth","autoUpload","file","getData","URL","createObjectURL","clientPreview","setUploaderFile","getMode","Mode","SLIDER","getSliderButtons","saveButton","setDisabled","INLINE","getInlineSaveButton","progress","getStatus","getSize","getFileUploader","getUploaderFile","Object","values","includes","getHeader","onTakePhotoClick","onSelectPhotoClick","getUploadLayout","getActionPanel","Promise","resolve","uploadController","subscribeOnce","fileInfo","button","PRIMARY","setWaiting","then","uploaderFile","serverPreviewUrl","emitAsync","setSliderButtons","buttons","cancelButton","SidePanelInstance","Reflection","getClass","isNil","open","width","contentCallback","Layout","createContent","extensions","content","design","section","SaveButton","BX","SidePanel","Instance","close","callback","delay","timeoutId","setTimeout","clearTimeout"],"mappings":"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"}