{"version":3,"file":"ui.tile-uploader.widget.bundle.js","sources":["../src/components/drop-area.js","../src/components/upload-loader.js","../src/components/tile-item.js","../src/components/tile-list.js","../src/components/stack.js","../src/components/tile-uploader-component.js","../src/tile-uploader.js"],"sourcesContent":["import { BitrixVue } from 'ui.vue';\nimport type TileUploader from '../tile-uploader';\n\nexport const DropArea = BitrixVue.localComponent('drop-area', {\n\tmounted()\n\t{\n\t\tconst tileUploader: TileUploader = this.$Bitrix.Application.get();\n\t\ttileUploader.getUploader().assignDropzone(this.$refs.dropArea);\n\t\ttileUploader.getUploader().assignBrowse(this.$refs.dropArea);\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"disk-file-control-panel\" ref=\"dropArea\">\n\t\t\t<div class=\"disk-file-control-panel-btn-upload-box\">\n\t\t\t\t<label class=\"disk-file-control-panel-btn-upload\">Drag and Drop</label>\n\t\t\t\t<div class=\"disk-file-control-panel-btn-settings\"></div>\n\t\t\t</div>\n\t\t</div>\n\t`\n});\n","import { BitrixVue } from 'ui.vue';\nimport { Dom } from 'main.core';\nimport { ProgressRound } from 'ui.progressround';\n\nexport const UploadLoader = BitrixVue.component('tile-uploader.uploader-loader', {\n\tmounted()\n\t{\n\t\tthis.createProgressbar();\n\t},\n\tbeforeDestroy()\n\t{\n\t\tthis.removeProgressbar();\n\t},\n\tprops: {\n\t\tprogress: {\n\t\t\ttype: Number,\n\t\t\tdefault: 0,\n\t\t},\n\t\titem: {\n\t\t\ttype: Object,\n\t\t\tdefault: {}\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tcreateProgressbar()\n\t\t{\n\t\t\tthis.loader = new ProgressRound({\n\t\t\t\twidth: 20,\n\t\t\t\t// colorTrack: '#d8d8d8',\n\t\t\t\t// colorBar: '#2fc6f6',\n\t\t\t\tcolorTrack: '#73d8f8',\n\t\t\t\tcolorBar: '#fff',\n\t\t\t\tlineSize: 3,\n\t\t\t\trotation: true,\n\t\t\t\tcolor: ProgressRound.Color.SUCCESS,\n\t\t\t});\n\n\t\t\tthis.loader.renderTo(this.$refs.container);\n\t\t},\n\t\tupdateProgressbar()\n\t\t{\n\t\t\tif (this.item.status !== 'uploading')\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!this.loader)\n\t\t\t{\n\t\t\t\tthis.createProgressbar();\n\t\t\t}\n\n\t\t\tthis.loader.update(this.item.progress ? this.item.progress : 0);\n\t\t},\n\t\tremoveProgressbar()\n\t\t{\n\t\t\tif (this.loader)\n\t\t\t{\n\t\t\t\tDom.remove(this.loader.getContainer());\n\t\t\t\tthis.loader = null;\n\t\t\t}\n\t\t}\n\t},\n\tcomputed:\n\t{\n\t\tuploadProgress()\n\t\t{\n\t\t\treturn String(this.item.progress);\n\t\t},\n\t},\n\twatch:\n\t{\n\t\tuploadProgress()\n\t\t{\n\t\t\tthis.updateProgressbar();\n\t\t},\n\t},\n\ttemplate: `<div class=\"ui-tile-uploader-item-loader\" ref=\"container\"></div>`\n});\n","import { MenuManager, Popup } from 'main.popup';\nimport { Dom, Text, Loc } from 'main.core';\nimport { BitrixVue } from 'ui.vue';\nimport { FileStatus } from 'ui.file-uploader.api';\nimport { UploadLoader } from './upload-loader';\nimport { TileUploader } from 'ui.file-uploader.widgets.tile-uploader';\n\nexport const TileItem = BitrixVue.localComponent('tile', {\n\tprops: {\n\t\titem: {\n\t\t\ttype: Object,\n\t\t\tdefault: {}\n\t\t},\n\t},\n\tcomponents: {\n\t\tUploadLoader,\n\t},\n\tdata() {\n\t\treturn {\n\t\t\ttileId: 'tile-uploader-' + Text.getRandom().toLowerCase(),\n\t\t\tmenu: null,\n\t\t\terrorPopup: null,\n\t\t};\n\t},\n\tmethods: {\n\t\tremove(id)\n\t\t{\n\t\t\tconst tileUploader: TileUploader = this.$Bitrix.Application.get();\n\t\t\ttileUploader.remove(id);\n\t\t},\n\n\t\thandleMouseEnter(item)\n\t\t{\n\t\t\tif (item.error)\n\t\t\t{\n\t\t\t\tif (!this.errorPopup)\n\t\t\t\t{\n\t\t\t\t\tthis.errorPopup = new Popup({\n\t\t\t\t\t\tbindElement: this.$refs.container,\n\t\t\t\t\t\tdarkMode: true,\n\t\t\t\t\t\tanimation: 'fading-slide',\n\t\t\t\t\t\twidth: 250,\n\t\t\t\t\t\tangle: { offset: 110 },\n\t\t\t\t\t\toffsetTop: 6,\n\t\t\t\t\t\toffsetLeft: -25,\n\t\t\t\t\t\tcontent: item.error.getMessage() + '<br>' + item.error.getDescription(),\n\t\t\t\t\t})\n\t\t\t\t}\n\n\t\t\t\tthis.errorPopup.show();\n\t\t\t}\n\t\t},\n\n\t\thandleMouseLeave()\n\t\t{\n\t\t\tif (this.errorPopup)\n\t\t\t{\n\t\t\t\tthis.errorPopup.destroy();\n\t\t\t\tthis.errorPopup = null;\n\t\t\t}\n\t\t},\n\n\t\tshowMenu(item)\n\t\t{\n\t\t\tif (this.menu)\n\t\t\t{\n\t\t\t\tthis.menu.destroy();\n\t\t\t}\n\n\t\t\tthis.menu = MenuManager.create({\n\t\t\t\tid: this.tileId,\n\t\t\t\tbindElement: this.$refs.menu,\n\t\t\t\tcacheable: false,\n\t\t\t\titems: [\n\t\t\t\t\t{ text: 'Download', href: item.downloadUrl }\n\t\t\t\t]\n\t\t\t});\n\n\t\t\tthis.menu.show();\n\t\t},\n\t},\n\tcomputed: {\n\t\tFileStatus: () => FileStatus,\n\t\tstatus() {\n\t\t\tif (this.item.status === FileStatus.UPLOADING)\n\t\t\t{\n\t\t\t\treturn this.item.progress + '%';\n\t\t\t}\n\t\t\telse if (this.item.status === FileStatus.LOAD_FAILED || this.item.status === FileStatus.UPLOAD_FAILED)\n\t\t\t{\n\t\t\t\treturn Loc.getMessage('TILE_UPLOADER_ERROR_STATUS');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\treturn Loc.getMessage('TILE_UPLOADER_WAITING_STATUS');\n\t\t\t}\n\t\t}\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div\n\t\t\tclass=\"ui-tile-uploader-item\"\n\t\t\t:class=\"['ui-tile-uploader-item--' + item.status]\"\n\t\t\t@mouseenter=\"handleMouseEnter(item)\"\n\t\t\t@mouseleave=\"handleMouseLeave(item)\"\n\t\t\tref=\"container\"\n\t\t>\n\t\t\t<div class=\"ui-tile-uploader-item-content\">\n\t\t\t\t<div v-if=\"item.status !== FileStatus.COMPLETE\" key=\"loader\" class=\"ui-tile-uploader-item-state\">\n\t\t\t\t\t<UploadLoader v-if=\"item.status === FileStatus.UPLOADING\" :item=\"item\"></UploadLoader>\n\t\t\t\t\t<div v-else class=\"ui-tile-uploader-item-state-icon\"></div>\n\n\t\t\t\t\t<div class=\"ui-tile-uploader-item-status\">{{status}}</div>\n\t\t\t\t\t<div class=\"ui-tile-uploader-item-state-desc\">{{item.sizeFormatted}}</div>\n\t\t\t\t\t<div class=\"ui-tile-uploader-item-state-remove\" @click=\"remove(item.id)\"></div>\n\t\t\t\t</div>\n\t\t\t\t<div v-else key=\"complete\" class=\"ui-tile-uploader-item-actions\">\n\t\t\t\t\t<div class=\"ui-tile-uploader-item-remove\" @click=\"remove(item.id)\"></div>\n\t\t\t\t\t<div class=\"ui-tile-uploader-item-menu\" @click=\"showMenu(item)\" ref=\"menu\"></div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"ui-tile-uploader-item-preview\">\n\t\t\t\t\t<template v-if=\"item.isImage\">\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tclass=\"ui-tile-uploader-item-image\"\n\t\t\t\t\t\t\t:class=\"{ 'ui-tile-uploader-item-image-default': item.previewUrl === null }\"\n\t\t\t\t\t\t\t:style=\"{ backgroundImage: item.previewUrl !== null ? 'url(' + item.previewUrl + ')' : '' }\">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"ui-tile-uploader-item-image-name\" :title=\"item.originalName\">{{item.originalName}}</div>\n\t\t\t\t\t</template>\n\t\t\t\t\t<div v-else class=\"ui-tile-uploader-item-file\"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`\n\t/*template: `\n\t\t<div class=\"disk-file-thumb\" :class=\"[\n\t\t\titem.isImage ? 'disk-file-thumb-preview' : 'disk-file-thumb-file',\n\t\t\titem.status === 'uploading' ? 'disk-file-thumb--active' : '',\n\t\t\t'disk-file-thumb--' + item.status\n\t\t]\">\n\t\t\t<template v-if=\"item.isImage && item.previewUrl !== null\">\n\t\t\t\t<div\n\t\t\t\t\tclass=\"disk-file-thumb-image\" style=\"background-size: cover\"\n\t\t\t\t\t:style=\"{ backgroundImage: 'url(' + item.previewUrl + ')' }\">\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t\t<div class=\"disk-file-thumb-loader\" ref=\"loader\">\n\t\t\t\t<div class=\"disk-file-thumb-loader-size\">{{item.sizeFormatted}}</div>\n\t\t\t</div>\n\n\t\t\t<div class=\"ui-icon disk-file-thumb-icon\" :class=\"'ui-icon-file-'+ item.extension\"><i></i></div>\n\n\t\t\t<div class=\"disk-file-thumb-text\">{{item.originalName}}</div>\n\n\t\t\t<div class=\"disk-file-thumb-btn-box\">\n\t\t\t\t<div class=\"disk-file-thumb-btn-close\" @click=\"remove(item.id)\"></div>\n\t\t\t\t<div class=\"disk-file-thumb-btn-more\" @click=\"showMenu(item)\" ref=\"menu\"></div>\n\t\t\t</div>\n\t\t</div>\n\t`*/\n});\n","import { BitrixVue } from 'ui.vue';\nimport { TileItem } from './tile-item';\n\nexport const TileList = BitrixVue.localComponent('tile-list', {\n\tprops: {\n\t\titems: {\n\t\t\ttype: Array,\n\t\t\tdefault: []\n\t\t}\n\t},\n\tcomponents: {\n\t\tTileItem,\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"ui-tile-uploader-items\">\n\t\t\t<TileItem v-for=\"item in items\" :key=\"item.id\" :item=\"item\" />\n\t\t</div>\n\t`\n});\n","import { BitrixVue } from 'ui.vue';\nimport type TileUploader from '../tile-uploader';\n\nexport const Stack = BitrixVue.component('tile-uploader.stack', {\n\tmounted()\n\t{\n\t\tconst tileUploader: TileUploader = this.$Bitrix.Application.get();\n\t\ttileUploader.getUploader().assignDropzone(this.$refs.container);\n\t},\n\ttemplate: `<div class=\"ui-tile-uploader-stack\" v-on:click=\"$emit('click')\" ref=\"container\">Stack</div>`\n});\n","import { BitrixVue } from 'ui.vue';\nimport { DropArea } from './drop-area';\nimport { TileList } from './tile-list';\nimport { Stack } from './stack';\nimport { Text } from 'main.core';\nimport { Popup } from 'main.popup';\nimport { MountingPortal } from 'ui.vue.portal';\nimport { CloseButton } from 'ui.buttons';\n\nexport const TileUploaderComponent = BitrixVue.localComponent('tile-uploader', {\n\tprops: {\n\t\terror: {\n\t\t\ttype: Object,\n\t\t},\n\t\tstackMode: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\titems: {\n\t\t\ttype: Array,\n\t\t\tdefault: [],\n\t\t}\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tpopup: null,\n\t\t\tpopupContentId: '',\n\t\t}\n\t},\n\tcomponents:\n\t{\n\t\tDropArea,\n\t\tTileList,\n\t\tStack,\n\t\tMountingPortal,\n\t},\n\tmethods: {\n\t\tshowPopup()\n\t\t{\n\t\t\tif (!this.popup)\n\t\t\t{\n\t\t\t\tconst id = 'stack-uploader-' + Text.getRandom().toLowerCase();\n\t\t\t\tconst popup = new Popup({\n\t\t\t\t\twidth: 750,\n\t\t\t\t\theight: 400,\n\t\t\t\t\tdraggable: true,\n\t\t\t\t\ttitleBar: 'Uploaded Files',\n\t\t\t\t\tcontent: `<div id=\"${id}\"></div>`,\n\t\t\t\t\tcacheable: false,\n\t\t\t\t\tcloseIcon: true,\n\t\t\t\t\tcloseByEsc: true,\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tonDestroy: () => this.popup = null,\n\t\t\t\t\t},\n\t\t\t\t\tbuttons: [\n\t\t\t\t\t\tnew CloseButton({ onclick: () => this.popup.close() }),\n\t\t\t\t\t]\n\t\t\t\t});\n\n\t\t\t\tthis.popupContentId = `#${id}`;\n\t\t\t\tthis.popup = popup;\n\t\t\t}\n\n\t\t\tthis.popup.show();\n\t\t}\n\t},\n\twatch:\n\t{\n\t\terror()\n\t\t{\n\t\t\talert(this.error.message);\n\t\t}\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"ui-tile-uploader\">\n\t\t\t{{ error && error.message ? error.message : 'none' }}\n\t\t\t<template v-if=\"stackMode\">\n\t\t\t\t<Stack v-on:click=\"showPopup\"/>\n\t\t\t\t<mounting-portal v-if=\"popup\" :mount-to=\"popupContentId\" append>\n\t\t\t\t\t<TileList :items=\"items\"></TileList>\n\t\t\t\t</mounting-portal>\n\t\t\t</template>\n\t\t\t<template v-else>\n\t\t\t\t<template v-if=\"items.length === 0\">\n\t\t\t\t\t<DropArea />\n\t\t\t\t</template>\n\t\t\t\t<template v-else>\n\t\t\t\t\t<TileList :items=\"items\"></TileList>\n\t\t\t\t\t<DropArea />\n\t\t\t\t</template>\n\t\t\t</template>\n\t\t</div>\n\t`\n});\n","import { Dom, Type } from 'main.core';\nimport { BaseEvent } from 'main.core.events';\nimport { Uploader, UploaderFile, UploaderOptions, UploaderStatus } from 'ui.file-uploader.api';\nimport { BitrixVue } from 'ui.vue';\n\nimport { TileUploaderComponent } from './components/tile-uploader-component';\nimport { TileUploaderOptions } from './tile-uploader-options';\n\n/**\n * @memberof BX.UI.FileUploader.Widgets\n */\nexport default class TileUploader\n{\n\t#uploader: Uploader = null;\n\t#vueApp = null;\n\t#items = [];\n\t#error = {};\n\t#uploaderStatus: UploaderStatus = UploaderStatus.STOPPED;\n\t#stackMode: boolean = false;\n\n\tconstructor(uploaderOptions: UploaderOptions, tileUploaderOptions: TileUploaderOptions)\n\t{\n\t\tconst widgetOptions = Type.isPlainObject(tileUploaderOptions) ? Object.assign({}, tileUploaderOptions) : {};\n\t\tthis.#stackMode = widgetOptions.stackMode === true;\n\n\t\tconst context = this;\n\n\t\tthis.#vueApp = BitrixVue.createApp({\n\t\t\tdata: () => {\n\t\t\t\treturn {\n\t\t\t\t\titems: this.#items,\n\t\t\t\t\tstackMode: this.#stackMode,\n\t\t\t\t\terror: this.#error,\n\t\t\t\t};\n\t\t\t},\n\n\t\t\tcomponents: {\n\t\t\t\tTileUploaderComponent,\n\t\t\t},\n\n\t\t\tbeforeCreate()\n\t\t\t{\n\t\t\t\tthis.$bitrix.Application.set(context);\n\t\t\t},\n\n\t\t\t// language=Vue\n\t\t\ttemplate: `<TileUploaderComponent :items=\"items\" :stackMode=\"stackMode\" :error=\"error\" />`,\n\t\t});\n\n\t\tconst options = Type.isPlainObject(uploaderOptions) ? Object.assign({}, uploaderOptions) : {};\n\t\tconst userEvents = options.events;\n\t\toptions.events = {\n\t\t\t'File:onAddStart': this.handleFileAdd.bind(this),\n\t\t\t'File:onRemove': this.handleFileRemove.bind(this),\n\t\t\t'File:onUploadProgress': this.handleFileUploadProgress.bind(this),\n\t\t\t'File:onStateChange': this.handleFileStateChange.bind(this),\n\t\t\t'File:onError': this.handleFileError.bind(this),\n\t\t\t'onError': this.handleError.bind(this),\n\t\t};\n\n\t\tthis.#uploader = new Uploader(options);\n\t\tthis.#uploader.subscribeFromOptions(userEvents);\n\t}\n\n\tgetUploader(): Uploader\n\t{\n\t\treturn this.#uploader;\n\t}\n\n\trenderTo(node: HTMLElement): void\n\t{\n\t\tif (Type.isDomNode(node))\n\t\t{\n\t\t\tconst container = Dom.create('div');\n\t\t\tnode.appendChild(container);\n\n\t\t\tif (!this.getUploader().getHiddenFieldsContainer())\n\t\t\t{\n\t\t\t\tthis.getUploader().setHiddenFieldsContainer(node);\n\t\t\t}\n\n\t\t\tthis.#vueApp.mount(container);\n\t\t}\n\t}\n\n\tremove(id): void\n\t{\n\t\tthis.getUploader().removeFile(id);\n\t}\n\n\tgetItem(id)\n\t{\n\t\treturn this.#items.find(item => item.id === id);\n\t}\n\n\tcreateItemFromFile(file: UploaderFile): { [key: string]: any }\n\t{\n\t\tconst item = file.getState();\n\t\titem.progress = 0;\n\n\t\treturn item;\n\t}\n\n\thandleFileAdd(event: BaseEvent): void\n\t{\n\t\tconst { file, error } = event.getData();\n\t\tthis.#items.push(this.createItemFromFile(file));\n\t}\n\n\thandleFileError(event: BaseEvent): void\n\t{\n\t\tconst { file, error } = event.getData();\n\n\t\tconst item = this.getItem(file.getId());\n\t\titem.error = error;\n\t}\n\n\thandleFileRemove(event: BaseEvent): void\n\t{\n\t\tconst { file } = event.getData();\n\n\t\tconst position = this.#items.findIndex(fileInfo => fileInfo.id === file.getId());\n\t\tif (position >= 0)\n\t\t{\n\t\t\tthis.#items.splice(position, 1);\n\t\t}\n\t}\n\n\thandleFileUploadProgress(event: BaseEvent): void\n\t{\n\t\tconst { file, progress } = event.getData();\n\t\tconst item = this.getItem(file.getId());\n\t\tif (item)\n\t\t{\n\t\t\titem.progress = progress;\n\t\t}\n\t}\n\n\thandleFileStateChange(event: BaseEvent): void\n\t{\n\t\tconst { file } = event.getData();\n\t\tconst item = this.getItem(file.getId());\n\t\tif (item)\n\t\t{\n\t\t\tObject.assign(item, file.getState());\n\t\t}\n\t}\n\n\thandleError(event: BaseEvent): void\n\t{\n\t\tObject.assign(this.#error, event.getData().error.toJSON());\n\t}\n}\n\n\nclass StackUploader extends TileUploader\n{\n\tconstructor(uploaderOptions: UploaderOptions, tileUploaderOptions: TileUploaderOptions)\n\t{\n\t\tsuper(uploaderOptions, tileUploaderOptions);\n\n\n\t\tthis.getVue().setTemplate('');\n\t}\n}\n"],"names":["DropArea","BitrixVue","localComponent","mounted","tileUploader","$Bitrix","Application","get","getUploader","assignDropzone","$refs","dropArea","assignBrowse","template","UploadLoader","component","createProgressbar","beforeDestroy","removeProgressbar","props","progress","type","Number","default","item","Object","methods","loader","ProgressRound","width","colorTrack","colorBar","lineSize","rotation","color","Color","SUCCESS","renderTo","container","updateProgressbar","status","update","Dom","remove","getContainer","computed","uploadProgress","String","watch","TileItem","components","data","tileId","Text","getRandom","toLowerCase","menu","errorPopup","id","handleMouseEnter","error","Popup","bindElement","darkMode","animation","angle","offset","offsetTop","offsetLeft","content","getMessage","getDescription","show","handleMouseLeave","destroy","showMenu","MenuManager","create","cacheable","items","text","href","downloadUrl","FileStatus","UPLOADING","LOAD_FAILED","UPLOAD_FAILED","Loc","TileList","Array","Stack","TileUploaderComponent","stackMode","Boolean","popup","popupContentId","MountingPortal","showPopup","height","draggable","titleBar","closeIcon","closeByEsc","events","onDestroy","buttons","CloseButton","onclick","close","alert","message","TileUploader","uploaderOptions","tileUploaderOptions","UploaderStatus","STOPPED","widgetOptions","Type","isPlainObject","assign","context","createApp","beforeCreate","$bitrix","set","options","userEvents","handleFileAdd","bind","handleFileRemove","handleFileUploadProgress","handleFileStateChange","handleFileError","handleError","Uploader","subscribeFromOptions","node","isDomNode","appendChild","getHiddenFieldsContainer","setHiddenFieldsContainer","mount","removeFile","find","file","getState","event","getData","push","createItemFromFile","getItem","getId","position","findIndex","fileInfo","splice","toJSON","StackUploader","getVue","setTemplate"],"mappings":"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"}