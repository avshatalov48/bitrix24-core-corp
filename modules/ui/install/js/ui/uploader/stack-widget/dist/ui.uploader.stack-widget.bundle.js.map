{"version":3,"file":"ui.uploader.stack-widget.bundle.js","sources":["../src/stack-widget-size.js","../src/components/stack-upload.js","../src/components/stack-load.js","../src/components/stack-preview.js","../src/components/stack-drop-area.js","../src/components/stack-widget-component.js","../src/stack-widget.js"],"sourcesContent":["export const StackWidgetSize = {\n\tLARGE: 'large',\n\tMEDIUM: 'medium',\n\tSMALL: 'small',\n\tTINY: 'tiny',\n};","import { Loc } from 'main.core';\nimport { BitrixVue } from 'ui.vue';\nimport { UploadLoader } from 'ui.uploader.tile-widget';\n\nimport { StackWidgetSize } from '../stack-widget-size';\n\nconst progressSizes = {\n\t[StackWidgetSize.LARGE]: { width: 46, lineSize: 5 },\n\t[StackWidgetSize.MEDIUM]: { width: 34, lineSize: 4 },\n\t[StackWidgetSize.SMALL]: { width: 20, lineSize: 3 },\n\t[StackWidgetSize.TINY]: { width: 14, lineSize: 2 },\n};\n\nexport const StackUpload = BitrixVue.localComponent('ui.uploader.stack-widget.stack-upload', {\n\tcomponents: {\n\t\tUploadLoader,\n\t},\n\tprops: {\n\t\titems: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t\tqueueItems: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t}\n\t},\n\tcomputed: {\n\t\tStackWidgetSize: () => StackWidgetSize,\n\t\tuploadFileTitle()\n\t\t{\n\t\t\tif (this.queueItems.length > 1)\n\t\t\t{\n\t\t\t\treturn Loc.getMessage('STACK_WIDGET_FILES_UPLOADING');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\treturn Loc.getMessage('STACK_WIDGET_FILE_UPLOADING');\n\t\t\t}\n\t\t},\n\t\tprogress()\n\t\t{\n\t\t\tif (this.queueItems.length === 0)\n\t\t\t{\n\t\t\t\treturn 0;\n\t\t\t}\n\n\t\t\tconst progress = this.queueItems.reduce((total, item) => {\n\t\t\t\treturn total + item.progress;\n\t\t\t}, 0);\n\n\t\t\treturn Math.floor(progress / this.queueItems.length);\n\t\t},\n\t\tprogressOptions()\n\t\t{\n\t\t\tconst { width, lineSize } = progressSizes[this.$root.widget.size];\n\n\t\t\treturn {\n\t\t\t\twidth,\n\t\t\t\tlineSize,\n\t\t\t\tprogress: Math.max(this.progress, 10),\n\t\t\t};\n\t\t}\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"ui-uploader-stack-upload\" @click=\"$emit('showPopup')\">\n\t\t\t<div class=\"ui-uploader-stack-upload-box\">\n\t\t\t\t<div \n\t\t\t\t\tclass=\"ui-uploader-stack-upload-abort\" \n\t\t\t\t\t:title=\"$Bitrix.Loc.getMessage('STACK_WIDGET_ABORT_UPLOAD')\"\n\t\t\t\t\t@click.stop=\"$emit('abortUpload')\"\n\t\t\t\t>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"ui-uploader-stack-upload-content\">\n\t\t\t\t\t<div class=\"ui-uploader-stack-upload-loader\">\n\t\t\t\t\t\t<UploadLoader v-bind=\"progressOptions\" />\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"ui-uploader-stack-upload-progress\">\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tv-if=\"$root.widget.size === StackWidgetSize.LARGE\"\n\t\t\t\t\t\t\tclass=\"ui-uploader-stack-upload-title\"\n\t\t\t\t\t\t>{{ uploadFileTitle }}</div>\n\t\t\t\t\t\t<div class=\"ui-uploader-stack-upload-percent\">{{ progress }}%</div>\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tv-if=\"queueItems.length === 1 && $root.widget.size === StackWidgetSize.LARGE\"\n\t\t\t\t\t\t\tclass=\"ui-uploader-stack-upload-stats\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<span class=\"ui-uploader-stack-upload-total\">{{\n\t\t\t\t\t\t\t\tqueueItems.length ? queueItems[0].sizeFormatted : ''\n\t\t\t\t\t\t\t}}</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div\n\t\t\t\t\tclass=\"ui-uploader-stack-upload-menu\"\n\t\t\t\t\t:title=\"$Bitrix.Loc.getMessage('STACK_WIDGET_OPEN_FILE_GALLERY')\"\n\t\t\t\t></div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n});\n","import { BitrixVue } from 'ui.vue';\n\nexport const StackLoad = BitrixVue.localComponent('ui.uploader.stack-widget.stack-load', {\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"ui-uploader-stack-load\" @click=\"$emit('showPopup')\">\n\t\t\t<div class=\"ui-uploader-stack-load-icon\"></div>\n\t\t</div>\n\t`,\n});\n","import { BitrixVue } from 'ui.vue';\nimport { FileStatus } from 'ui.uploader.core';\nimport { FileIcon } from 'ui.uploader.tile-widget';\n\nimport { StackWidgetSize } from '../stack-widget-size';\n\nconst fileIconSizes = {\n\t[StackWidgetSize.LARGE]: 36,\n\t[StackWidgetSize.MEDIUM]: 27,\n\t[StackWidgetSize.SMALL]: 19,\n\t[StackWidgetSize.TINY]: 15,\n}\n\nexport const StackPreview = BitrixVue.localComponent('ui.uploader.stack-widget.stack-preview', {\n\tcomponents: {\n\t\tFileIcon,\n\t},\n\tprops: {\n\t\titems: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata()\n\t{\n\t\treturn {\n\t\t\tmenu: null,\n\t\t};\n\t},\n\tcomputed: {\n\t\tFileStatus: () => FileStatus,\n\t\tSizes: () => StackWidgetSize,\n\t\titem()\n\t\t{\n\t\t\tconst item = this.items.find(item => {\n\t\t\t\treturn item.status !== FileStatus.LOAD_FAILED || item.status !== FileStatus.UPLOAD_FAILED;\n\t\t\t});\n\n\t\t\treturn item || {};\n\t\t},\n\t\tfileIconSize()\n\t\t{\n\t\t\treturn fileIconSizes[this.$root.widget.size];\n\t\t},\n\t\terrorsCount()\n\t\t{\n\t\t\treturn this.items.reduce((errors, item) => {\n\t\t\t\tif (item.status === FileStatus.LOAD_FAILED || item.status === FileStatus.UPLOAD_FAILED)\n\t\t\t\t{\n\t\t\t\t\treturn errors + 1;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\treturn errors;\n\t\t\t\t}\n\t\t\t}, 0);\n\t\t},\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"ui-uploader-stack-preview\" :class=\"{'--image': item.isImage}\" @click=\"$emit('showPopup')\">\n\t\t\t<div class=\"ui-uploader-stack-preview-box\">\n\t\t\t\t<template v-if=\"item.failed\">\n\t\t\t\t\t<div class=\"ui-uploader-stack-preview-error\"></div>\n\t\t\t\t</template>\n\t\t\t\t<template v-else-if=\"item.isImage\">\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass=\"ui-uploader-stack-preview-image\"\n\t\t\t\t\t\t:class=\"{ '--default': item.previewUrl === null }\"\n\t\t\t\t\t\t:style=\"{ backgroundImage: item.previewUrl !== null ? 'url(' + item.previewUrl + ')' : '' }\">\n\t\t\t\t\t</div>\n\t\t\t\t\t<div v-if=\"items.length > 1\" class=\"ui-uploader-stack-preview-stats\">\n\t\t\t\t\t\t<span class=\"ui-uploader-stack-preview-total\">{{ items.length }}</span>\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t\t<template v-else>\n\t\t\t\t\t<template v-if=\"item.name && item.status !== FileStatus.LOADING\">\n\t\t\t\t\t\t<div class=\"ui-uploader-stack-preview-file-icon\">\n\t\t\t\t\t\t\t<FileIcon :name=\"item.extension\" :size=\"fileIconSize\"/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tv-if=\"[Sizes.LARGE, Sizes.MEDIUM].includes($root.widget.size)\"\n\t\t\t\t\t\t\t:title=\"item.originalName\"\n\t\t\t\t\t\t\tclass=\"ui-uploader-stack-preview-file-name\"\n\t\t\t\t\t\t>{{\n\t\t\t\t\t\t\titems.length > 1\n\t\t\t\t\t\t\t? this.$Bitrix.Loc.getMessage('STACK_WIDGET_FILE_COUNT', { '#count#': items.length })\n\t\t\t\t\t\t\t: item.originalName\n\t\t\t\t\t\t}}</div>\n\t\t\t\t\t\t<div \n\t\t\t\t\t\t\tv-if=\"items.length > 1 && [Sizes.SMALL, Sizes.TINY].includes($root.widget.size)\"\n\t\t\t\t\t\t\tclass=\"ui-uploader-stack-preview-stats\">\n\t\t\t\t\t\t\t<span class=\"ui-uploader-stack-preview-total\">{{ items.length }}</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</template>\n\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t<div class=\"ui-uploader-stack-preview-file-default\"></div>\n\t\t\t\t\t</template>\n\t\t\t\t</template>\n\t\t\t</div>\n\t\t\t<div\n\t\t\t\tclass=\"ui-uploader-stack-upload-menu\"\n\t\t\t\t:title=\"$Bitrix.Loc.getMessage('STACK_WIDGET_OPEN_FILE_GALLERY')\"\n\t\t\t></div>\n\t\t</div>\n\t`,\n});\n","import { Loc } from 'main.core';\n\nimport { BitrixVue } from 'ui.vue';\nimport { StackWidgetSize } from 'ui.uploader.stack-widget';\n\nexport const StackDropArea = BitrixVue.localComponent('ui.uploader.stack-widget.stack-drop-area', {\n\tdata()\n\t{\n\t\treturn {\n\t\t\tisHovering: false,\n\t\t}\n\t},\n\tcomputed: {\n\t\tStackWidgetSize: () => StackWidgetSize,\n\t\tuploadFileTitle()\n\t\t{\n\t\t\tif (this.$root.acceptOnlyImages)\n\t\t\t{\n\t\t\t\tif (this.$root.multiple)\n\t\t\t\t{\n\t\t\t\t\treturn Loc.getMessage('STACK_WIDGET_UPLOAD_IMAGES');\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\treturn Loc.getMessage('STACK_WIDGET_UPLOAD_IMAGE');\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (this.$root.multiple)\n\t\t\t\t{\n\t\t\t\t\treturn Loc.getMessage('STACK_WIDGET_UPLOAD_FILES');\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\treturn Loc.getMessage('STACK_WIDGET_UPLOAD_FILE');\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tdragFileHint()\n\t\t{\n\t\t\tif (this.$root.multiple)\n\t\t\t{\n\t\t\t\treturn Loc.getMessage('STACK_WIDGET_DRAG_FILES_HINT');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\treturn Loc.getMessage('STACK_WIDGET_DRAG_FILE_HINT');\n\t\t\t}\n\t\t},\n\t},\n\tmounted()\n\t{\n\t\tthis.$root.getUploader().assignDropzone(this.$refs.container);\n\t\tthis.$root.getUploader().assignBrowse(this.$refs.container);\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div\n\t\t\tclass=\"ui-uploader-stack-drop-area\"\n\t\t\tref=\"container\"\n\t\t\t:class=\"{ '--hover': isHovering }\"\n\t\t\t@mouseenter=\"isHovering = true\"\n\t\t\t@mouseleave=\"isHovering = false\"\n\t\t\t@dragleave=\"isHovering = false\"\n\t\t>\n\t\t\t<div class=\"ui-uploader-stack-drop-area-content\">\n\t\t\t\t<div class=\"ui-uploader-stack-drop-area-icon\"></div>\n\t\t\t\t<div\n\t\t\t\t\tv-if=\"[StackWidgetSize.LARGE, StackWidgetSize.MEDIUM].includes($root.widget.size)\"\n\t\t\t\t\tclass=\"ui-uploader-stack-drop-area-title\"\n\t\t\t\t>{{ uploadFileTitle }}</div>\n\t\t\t\t<div\n\t\t\t\t\tv-if=\"$root.widget.size === StackWidgetSize.LARGE\"\n\t\t\t\t\tclass=\"ui-uploader-stack-drop-area-hint\"\n\t\t\t\t>{{ dragFileHint }}</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n});\n","import { Text, Loc } from 'main.core';\nimport { Popup } from 'main.popup';\nimport { CloseButton } from 'ui.buttons';\n\nimport { BitrixVue } from 'ui.vue';\nimport { MountingPortal } from 'ui.vue.portal';\n\nimport { FileStatus, FileOrigin, UploaderStatus } from 'ui.uploader.core';\nimport { TileList, ErrorPopup, DragOverMixin } from 'ui.uploader.tile-widget';\n\nimport { StackUpload } from './stack-upload';\nimport { StackLoad } from './stack-load';\nimport { StackPreview } from './stack-preview';\nimport { StackDropArea } from './stack-drop-area';\n\nimport type { BaseEvent } from 'main.core.events';\n\nconst isItemLoading = item => item.status === FileStatus.LOADING;\n\nexport const StackWidgetComponent = BitrixVue.localComponent('ui.uploader.stack-widget', {\n\tcomponents: {\n\t\tTileList,\n\t\tErrorPopup,\n\t\tStackUpload,\n\t\tStackLoad,\n\t\tStackPreview,\n\t\tStackDropArea,\n\t\tMountingPortal,\n\t},\n\tmixins: [\n\t\tDragOverMixin,\n\t],\n\tprops: {\n\t\titems: {\n\t\t\ttype: Array,\n\t\t\tdefault: [],\n\t\t},\n\t},\n\tdata()\n\t{\n\t\treturn {\n\t\t\tpopup: null,\n\t\t\tpopupContentId: '',\n\t\t\tqueueItems: [],\n\t\t\tenableAnimation: true,\n\t\t\tdragMode: false,\n\t\t\tuploaderError: null,\n\t\t}\n\t},\n\tcomputed: {\n\t\tcontainerClasses()\n\t\t{\n\t\t\treturn [\n\t\t\t\t{\n\t\t\t\t\t'--multiple': this.$root.multiple,\n\t\t\t\t\t'--only-images': this.$root.acceptOnlyImages,\n\t\t\t\t\t'--many-items': this.items.length > 1,\n\t\t\t\t},\n\t\t\t\t`--${this.$root.widget.size}`\n\t\t\t];\n\t\t},\n\t\tcurrentComponent()\n\t\t{\n\t\t\tif (this.items.length === 0 || this.dragOver)\n\t\t\t{\n\t\t\t\tif (this.dragOver)\n\t\t\t\t{\n\t\t\t\t\tthis.dragMode = true;\n\t\t\t\t}\n\n\t\t\t\treturn StackDropArea;\n\t\t\t}\n\n\t\t\tif (this.queueItems.length > 0)\n\t\t\t{\n\t\t\t\treturn StackUpload;\n\t\t\t}\n\n\t\t\tif (this.items.some(isItemLoading))\n\t\t\t{\n\t\t\t\treturn StackLoad;\n\t\t\t}\n\n\t\t\treturn StackPreview;\n\t\t},\n\t\tcurrentComponentProps()\n\t\t{\n\t\t\tif (this.currentComponent === StackDropArea || this.currentComponent === StackLoad)\n\t\t\t{\n\t\t\t\treturn {};\n\t\t\t}\n\t\t\telse if (this.currentComponent === StackUpload)\n\t\t\t{\n\t\t\t\treturn {\n\t\t\t\t\titems: this.items,\n\t\t\t\t\tqueueItems: this.queueItems,\n\t\t\t\t};\n\t\t\t}\n\t\t\telse if (this.currentComponent === StackPreview)\n\t\t\t{\n\t\t\t\treturn {\n\t\t\t\t\titems: this.items,\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\terror()\n\t\t{\n\t\t\tif (this.uploaderError)\n\t\t\t{\n\t\t\t\treturn this.uploaderError;\n\t\t\t}\n\t\t\telse if (this.errorsCount > 0)\n\t\t\t{\n\t\t\t\treturn Loc.getMessage('STACK_WIDGET_FILE_UPLOAD_ERROR');\n\t\t\t}\n\n\t\t\treturn null;\n\t\t},\n\t\terrorsCount()\n\t\t{\n\t\t\treturn this.items.reduce((errors, item) => {\n\t\t\t\tif (item.status === FileStatus.LOAD_FAILED || item.status === FileStatus.UPLOAD_FAILED)\n\t\t\t\t{\n\t\t\t\t\treturn errors + 1;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\treturn errors;\n\t\t\t\t}\n\t\t\t}, 0);\n\t\t},\n\t\terrorPopupOptions()\n\t\t{\n\t\t\treturn {\n\t\t\t\tbindElement: this.$refs.item,\n\t\t\t\tbindOptions: {\n\t\t\t\t\tposition: 'top',\n\t\t\t\t},\n\t\t\t\tdarkMode: true,\n\t\t\t\toffsetTop: 3,\n\t\t\t\tbackground: '#d2000d',\n\t\t\t\tcontentBackground: 'transparent',\n\t\t\t\tcontentColor: 'white',\n\t\t\t\tpadding: this.uploaderError === null ? 10 : 20,\n\t\t\t\tcloseIcon: this.uploaderError !== null,\n\t\t\t};\n\t\t}\n\t},\n\twatch: {\n\t\tcurrentComponent(newValue, oldValue)\n\t\t{\n\t\t\tif (this.dragOver)\n\t\t\t{\n\t\t\t\tthis.enableAnimation = false;\n\t\t\t}\n\t\t\telse if (oldValue === StackDropArea && this.dragMode)\n\t\t\t{\n\t\t\t\tthis.enableAnimation = false;\n\t\t\t}\n\t\t\telse if (oldValue === StackPreview)\n\t\t\t{\n\t\t\t\tthis.enableAnimation = false;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.dragMode = false;\n\t\t\t\tthis.enableAnimation = true;\n\t\t\t}\n\t\t},\n\t\titems()\n\t\t{\n\t\t\tif (this.items.length === 0 && this.popup)\n\t\t\t{\n\t\t\t\tthis.popup.close();\n\t\t\t}\n\t\t}\n\t},\n\tcreated()\n\t{\n\t\tthis.$Bitrix.eventEmitter.subscribe('Uploader:onUploadStart', () => {\n\t\t\tthis.items.forEach(item => {\n\t\t\t\tif (item.origin === FileOrigin.CLIENT && item.queued !== true)\n\t\t\t\t{\n\t\t\t\t\titem.queued = true;\n\t\t\t\t\tthis.queueItems.push(item);\n\t\t\t\t}\n\t\t\t})\n\t\t});\n\n\t\tthis.$Bitrix.eventEmitter.subscribe('Uploader:onUploadComplete', () => {\n\t\t\tthis.queueItems = [];\n\t\t});\n\n\t\tthis.$Bitrix.eventEmitter.subscribe('Item:onAdd', (event: BaseEvent) => {\n\t\t\tthis.uploaderError = null;\n\t\t\tif (this.$root.getUploader().getStatus() === UploaderStatus.STARTED)\n\t\t\t{\n\t\t\t\tconst item = event.getData().item;\n\t\t\t\titem.queued = true;\n\t\t\t\tthis.queueItems.push(event.getData().item);\n\t\t\t}\n\t\t});\n\n\t\tthis.$Bitrix.eventEmitter.subscribe('Item:onRemove', (event: BaseEvent) => {\n\t\t\tthis.uploaderError = null;\n\t\t\tconst item = event.getData().item;\n\t\t\tconst position = this.queueItems.indexOf(item);\n\t\t\tif (position >= 0)\n\t\t\t{\n\t\t\t\tthis.queueItems.splice(position, 1);\n\t\t\t}\n\t\t});\n\n\t\tthis.$Bitrix.eventEmitter.subscribe('Uploader:onError', (event: BaseEvent) => {\n\t\t\tthis.uploaderError = event.getData().error;\n\t\t});\n\t},\n\tmounted()\n\t{\n\t\tthis.$root.getUploader().assignBrowse(this.$refs['add-button']);\n\t},\n\tmethods: {\n\t\tshowPopup()\n\t\t{\n\t\t\tif (!this.popup)\n\t\t\t{\n\t\t\t\tconst id = 'stack-uploader-' + Text.getRandom().toLowerCase();\n\t\t\t\tconst popup = new Popup({\n\t\t\t\t\twidth: 750,\n\t\t\t\t\theight: 400,\n\t\t\t\t\tdraggable: true,\n\t\t\t\t\ttitleBar: Loc.getMessage('STACK_WIDGET_POPUP_TITLE'),\n\t\t\t\t\tcontent: `<div id=\"${id}\"></div>`,\n\t\t\t\t\tcacheable: false,\n\t\t\t\t\tcloseIcon: true,\n\t\t\t\t\tcloseByEsc: true,\n\t\t\t\t\tresizable: true,\n\t\t\t\t\tminWidth: 450,\n\t\t\t\t\tminHeight: 300,\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tonDestroy: () => this.popup = null,\n\t\t\t\t\t},\n\t\t\t\t\tbuttons: [\n\t\t\t\t\t\tnew CloseButton({ onclick: () => this.popup.close() }),\n\t\t\t\t\t]\n\t\t\t\t});\n\n\t\t\t\tthis.popupContentId = `#${id}`;\n\t\t\t\tthis.popup = popup;\n\t\t\t}\n\n\t\t\tthis.popup.show();\n\t\t},\n\t\tabortUpload()\n\t\t{\n\t\t\tconst items = Array.from(this.queueItems);\n\t\t\tthis.queueItems = [];\n\n\t\t\titems.forEach(item => {\n\t\t\t\tthis.$root.getWidget().remove(item.id);\n\t\t\t});\n\t\t},\n\t\thandlePopupDestroy(error)\n\t\t{\n\t\t\tif (this.uploaderError === error)\n\t\t\t{\n\t\t\t\tthis.uploaderError = null;\n\t\t\t}\n\t\t}\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"ui-uploader-stack-widget\" :class=\"containerClasses\" v-drop>\n\t\t\t<mounting-portal v-if=\"popup\" :mount-to=\"popupContentId\" append>\n\t\t\t\t<TileList :items=\"items\" />\n\t\t\t</mounting-portal>\n\t\t\t<div class=\"ui-uploader-stack-item\" ref=\"item\">\n\t\t\t\t<transition name=\"ui-uploader-stack-item\" mode=\"out-in\" :css=\"enableAnimation\">\n\t\t\t\t\t<keep-alive>\n\t\t\t\t\t\t<component\n\t\t\t\t\t\t\t:is=\"currentComponent\"\n\t\t\t\t\t\t\tv-bind=\"currentComponentProps\"\n\t\t\t\t\t\t\t@showPopup=\"showPopup\"\n\t\t\t\t\t\t\t@abortUpload=\"abortUpload\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</keep-alive>\n\t\t\t\t</transition>\n\t\t\t</div>\n\t\t\t<div v-if=\"$root.multiple\" ref=\"add-button\" class=\"ui-uploader-stack-add-btn\"></div>\n\t\t\t<ErrorPopup\n\t\t\t\tv-if=\"error !== null\"\n\t\t\t\t:error=\"error\"\n\t\t\t\t:popup-options=\"errorPopupOptions\"\n\t\t\t\t@onDestroy=\"handlePopupDestroy\"\n\t\t\t/>\n\t\t</div>\n\t`\n});","import { Type } from 'main.core';\nimport { UploaderOptions, VueUploader } from 'ui.uploader.core';\n\nimport { StackWidgetSize } from './stack-widget-size';\nimport { StackWidgetComponent } from './components/stack-widget-component';\n\nimport type { StackWidgetOptions } from './stack-widget-options';\n\n/**\n * @memberof BX.UI.Uploader\n */\nexport default class StackWidget extends VueUploader\n{\n\tconstructor(uploaderOptions: UploaderOptions, stackWidgetOptions: StackWidgetOptions)\n\t{\n\t\tconst widgetOptions = Type.isPlainObject(stackWidgetOptions) ? Object.assign({}, stackWidgetOptions) : {};\n\t\tconst size =\n\t\t\tObject.values(StackWidgetSize).includes(widgetOptions.size) ? widgetOptions.size : StackWidgetSize.MEDIUM\n\t\t;\n\n\t\tconst vueOptions = {\n\t\t\tdata()\n\t\t\t{\n\t\t\t\treturn {\n\t\t\t\t\twidget: {\n\t\t\t\t\t\tsize,\n\t\t\t\t\t},\n\t\t\t\t};\n\t\t\t}\n\t\t};\n\n\t\tsuper(uploaderOptions, vueOptions);\n\t}\n\n\tgetRootComponentId(): Function\n\t{\n\t\treturn StackWidgetComponent;\n\t}\n}\n"],"names":["StackWidgetSize","LARGE","MEDIUM","SMALL","TINY","progressSizes","width","lineSize","StackUpload","BitrixVue","localComponent","components","UploadLoader","props","items","type","Array","required","queueItems","computed","uploadFileTitle","length","Loc","getMessage","progress","reduce","total","item","Math","floor","progressOptions","$root","widget","size","max","template","StackLoad","fileIconSizes","StackPreview","FileIcon","data","menu","FileStatus","Sizes","find","status","LOAD_FAILED","UPLOAD_FAILED","fileIconSize","errorsCount","errors","StackDropArea","isHovering","acceptOnlyImages","multiple","dragFileHint","mounted","getUploader","assignDropzone","$refs","container","assignBrowse","isItemLoading","LOADING","StackWidgetComponent","TileList","ErrorPopup","MountingPortal","mixins","DragOverMixin","default","popup","popupContentId","enableAnimation","dragMode","uploaderError","containerClasses","currentComponent","dragOver","some","currentComponentProps","error","errorPopupOptions","bindElement","bindOptions","position","darkMode","offsetTop","background","contentBackground","contentColor","padding","closeIcon","watch","newValue","oldValue","close","created","$Bitrix","eventEmitter","subscribe","forEach","origin","FileOrigin","CLIENT","queued","push","event","getStatus","UploaderStatus","STARTED","getData","indexOf","splice","methods","showPopup","id","Text","getRandom","toLowerCase","Popup","height","draggable","titleBar","content","cacheable","closeByEsc","resizable","minWidth","minHeight","events","onDestroy","buttons","CloseButton","onclick","show","abortUpload","from","getWidget","remove","handlePopupDestroy","StackWidget","VueUploader","constructor","uploaderOptions","stackWidgetOptions","widgetOptions","Type","isPlainObject","Object","assign","values","includes","vueOptions","getRootComponentId"],"mappings":";;;;;OAAaA,eAAe,GAAG;CAC9BC,EAAAA,KAAK,EAAE,OADuB;CAE9BC,EAAAA,MAAM,EAAE,QAFsB;CAG9BC,EAAAA,KAAK,EAAE,OAHuB;CAI9BC,EAAAA,IAAI,EAAE;CAJwB,CAAxB;;CCMP,MAAMC,aAAa,GAAG;CACrB,GAACL,eAAe,CAACC,KAAjB,GAAyB;CAAEK,IAAAA,KAAK,EAAE,EAAT;CAAaC,IAAAA,QAAQ,EAAE;CAAvB,GADJ;CAErB,GAACP,eAAe,CAACE,MAAjB,GAA0B;CAAEI,IAAAA,KAAK,EAAE,EAAT;CAAaC,IAAAA,QAAQ,EAAE;CAAvB,GAFL;CAGrB,GAACP,eAAe,CAACG,KAAjB,GAAyB;CAAEG,IAAAA,KAAK,EAAE,EAAT;CAAaC,IAAAA,QAAQ,EAAE;CAAvB,GAHJ;CAIrB,GAACP,eAAe,CAACI,IAAjB,GAAwB;CAAEE,IAAAA,KAAK,EAAE,EAAT;CAAaC,IAAAA,QAAQ,EAAE;CAAvB;CAJH,CAAtB;AAOA,CAAO,MAAMC,WAAW,GAAGC,gBAAS,CAACC,cAAV,CAAyB,uCAAzB,EAAkE;CAC5FC,EAAAA,UAAU,EAAE;CACXC,kBAAAA;CADW,GADgF;CAI5FC,EAAAA,KAAK,EAAE;CACNC,IAAAA,KAAK,EAAE;CACNC,MAAAA,IAAI,EAAEC,KADA;CAENC,MAAAA,QAAQ,EAAE;CAFJ,KADD;CAKNC,IAAAA,UAAU,EAAE;CACXH,MAAAA,IAAI,EAAEC,KADK;CAEXC,MAAAA,QAAQ,EAAE;CAFC;CALN,GAJqF;CAc5FE,EAAAA,QAAQ,EAAE;CACTnB,IAAAA,eAAe,EAAE,MAAMA,eADd;;CAEToB,IAAAA,eAAe,GACf;CACC,UAAI,KAAKF,UAAL,CAAgBG,MAAhB,GAAyB,CAA7B,EACA;CACC,eAAOC,aAAG,CAACC,UAAJ,CAAe,8BAAf,CAAP;CACA,OAHD,MAKA;CACC,eAAOD,aAAG,CAACC,UAAJ,CAAe,6BAAf,CAAP;CACA;CACD,KAZQ;;CAaTC,IAAAA,QAAQ,GACR;CACC,UAAI,KAAKN,UAAL,CAAgBG,MAAhB,KAA2B,CAA/B,EACA;CACC,eAAO,CAAP;CACA;;CAED,YAAMG,QAAQ,GAAG,KAAKN,UAAL,CAAgBO,MAAhB,CAAuB,CAACC,KAAD,EAAQC,IAAR,KAAiB;CACxD,eAAOD,KAAK,GAAGC,IAAI,CAACH,QAApB;CACA,OAFgB,EAEd,CAFc,CAAjB;CAIA,aAAOI,IAAI,CAACC,KAAL,CAAWL,QAAQ,GAAG,KAAKN,UAAL,CAAgBG,MAAtC,CAAP;CACA,KAzBQ;;CA0BTS,IAAAA,eAAe,GACf;CACC,YAAM;CAAExB,QAAAA,KAAF;CAASC,QAAAA;CAAT,UAAsBF,aAAa,CAAC,KAAK0B,KAAL,CAAWC,MAAX,CAAkBC,IAAnB,CAAzC;CAEA,aAAO;CACN3B,QAAAA,KADM;CAENC,QAAAA,QAFM;CAGNiB,QAAAA,QAAQ,EAAEI,IAAI,CAACM,GAAL,CAAS,KAAKV,QAAd,EAAwB,EAAxB;CAHJ,OAAP;CAKA;;CAnCQ,GAdkF;CAmD5F;CACAW,EAAAA,QAAQ,EAAG;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;CApDiF,CAAlE,CAApB;;CCXA,MAAMC,SAAS,GAAG3B,gBAAS,CAACC,cAAV,CAAyB,qCAAzB,EAAgE;CACxF;CACAyB,EAAAA,QAAQ,EAAG;;;;;CAF6E,CAAhE,CAAlB;;CCIP,MAAME,aAAa,GAAG;CACrB,GAACrC,eAAe,CAACC,KAAjB,GAAyB,EADJ;CAErB,GAACD,eAAe,CAACE,MAAjB,GAA0B,EAFL;CAGrB,GAACF,eAAe,CAACG,KAAjB,GAAyB,EAHJ;CAIrB,GAACH,eAAe,CAACI,IAAjB,GAAwB;CAJH,CAAtB;AAOA,CAAO,MAAMkC,YAAY,GAAG7B,gBAAS,CAACC,cAAV,CAAyB,wCAAzB,EAAmE;CAC9FC,EAAAA,UAAU,EAAE;CACX4B,cAAAA;CADW,GADkF;CAI9F1B,EAAAA,KAAK,EAAE;CACNC,IAAAA,KAAK,EAAE;CACNC,MAAAA,IAAI,EAAEC,KADA;CAENC,MAAAA,QAAQ,EAAE;CAFJ;CADD,GAJuF;;CAU9FuB,EAAAA,IAAI,GACJ;CACC,WAAO;CACNC,MAAAA,IAAI,EAAE;CADA,KAAP;CAGA,GAf6F;;CAgB9FtB,EAAAA,QAAQ,EAAE;CACTuB,IAAAA,UAAU,EAAE,MAAMA,2BADT;CAETC,IAAAA,KAAK,EAAE,MAAM3C,eAFJ;;CAGT2B,IAAAA,IAAI,GACJ;CACC,YAAMA,IAAI,GAAG,KAAKb,KAAL,CAAW8B,IAAX,CAAgBjB,IAAI,IAAI;CACpC,eAAOA,IAAI,CAACkB,MAAL,KAAgBH,2BAAU,CAACI,WAA3B,IAA0CnB,IAAI,CAACkB,MAAL,KAAgBH,2BAAU,CAACK,aAA5E;CACA,OAFY,CAAb;CAIA,aAAOpB,IAAI,IAAI,EAAf;CACA,KAVQ;;CAWTqB,IAAAA,YAAY,GACZ;CACC,aAAOX,aAAa,CAAC,KAAKN,KAAL,CAAWC,MAAX,CAAkBC,IAAnB,CAApB;CACA,KAdQ;;CAeTgB,IAAAA,WAAW,GACX;CACC,aAAO,KAAKnC,KAAL,CAAWW,MAAX,CAAkB,CAACyB,MAAD,EAASvB,IAAT,KAAkB;CAC1C,YAAIA,IAAI,CAACkB,MAAL,KAAgBH,2BAAU,CAACI,WAA3B,IAA0CnB,IAAI,CAACkB,MAAL,KAAgBH,2BAAU,CAACK,aAAzE,EACA;CACC,iBAAOG,MAAM,GAAG,CAAhB;CACA,SAHD,MAKA;CACC,iBAAOA,MAAP;CACA;CACD,OATM,EASJ,CATI,CAAP;CAUA;;CA3BQ,GAhBoF;CA6C9F;CACAf,EAAAA,QAAQ,EAAG;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;CA9CmF,CAAnE,CAArB;;CCRA,MAAMgB,aAAa,GAAG1C,gBAAS,CAACC,cAAV,CAAyB,0CAAzB,EAAqE;CACjG8B,EAAAA,IAAI,GACJ;CACC,WAAO;CACNY,MAAAA,UAAU,EAAE;CADN,KAAP;CAGA,GANgG;;CAOjGjC,EAAAA,QAAQ,EAAE;CACTnB,IAAAA,eAAe,EAAE,MAAMA,uCADd;;CAEToB,IAAAA,eAAe,GACf;CACC,UAAI,KAAKW,KAAL,CAAWsB,gBAAf,EACA;CACC,YAAI,KAAKtB,KAAL,CAAWuB,QAAf,EACA;CACC,iBAAOhC,aAAG,CAACC,UAAJ,CAAe,4BAAf,CAAP;CACA,SAHD,MAKA;CACC,iBAAOD,aAAG,CAACC,UAAJ,CAAe,2BAAf,CAAP;CACA;CACD,OAVD,MAYA;CACC,YAAI,KAAKQ,KAAL,CAAWuB,QAAf,EACA;CACC,iBAAOhC,aAAG,CAACC,UAAJ,CAAe,2BAAf,CAAP;CACA,SAHD,MAKA;CACC,iBAAOD,aAAG,CAACC,UAAJ,CAAe,0BAAf,CAAP;CACA;CACD;CACD,KA1BQ;;CA2BTgC,IAAAA,YAAY,GACZ;CACC,UAAI,KAAKxB,KAAL,CAAWuB,QAAf,EACA;CACC,eAAOhC,aAAG,CAACC,UAAJ,CAAe,8BAAf,CAAP;CACA,OAHD,MAKA;CACC,eAAOD,aAAG,CAACC,UAAJ,CAAe,6BAAf,CAAP;CACA;CACD;;CArCQ,GAPuF;;CA8CjGiC,EAAAA,OAAO,GACP;CACC,SAAKzB,KAAL,CAAW0B,WAAX,GAAyBC,cAAzB,CAAwC,KAAKC,KAAL,CAAWC,SAAnD;CACA,SAAK7B,KAAL,CAAW0B,WAAX,GAAyBI,YAAzB,CAAsC,KAAKF,KAAL,CAAWC,SAAjD;CACA,GAlDgG;;CAmDjG;CACAzB,EAAAA,QAAQ,EAAG;;;;;;;;;;;;;;;;;;;;;;CApDsF,CAArE,CAAtB;;CCYP,MAAM2B,aAAa,GAAGnC,IAAI,IAAIA,IAAI,CAACkB,MAAL,KAAgBH,2BAAU,CAACqB,OAAzD;;AAEA,CAAO,MAAMC,oBAAoB,GAAGvD,gBAAS,CAACC,cAAV,CAAyB,0BAAzB,EAAqD;CACxFC,EAAAA,UAAU,EAAE;CACXsD,cAAAA,+BADW;CAEXC,gBAAAA,iCAFW;CAGX1D,IAAAA,WAHW;CAIX4B,IAAAA,SAJW;CAKXE,IAAAA,YALW;CAMXa,IAAAA,aANW;CAOXgB,oBAAAA;CAPW,GAD4E;CAUxFC,EAAAA,MAAM,EAAE,CACPC,oCADO,CAVgF;CAaxFxD,EAAAA,KAAK,EAAE;CACNC,IAAAA,KAAK,EAAE;CACNC,MAAAA,IAAI,EAAEC,KADA;CAENsD,MAAAA,OAAO,EAAE;CAFH;CADD,GAbiF;;CAmBxF9B,EAAAA,IAAI,GACJ;CACC,WAAO;CACN+B,MAAAA,KAAK,EAAE,IADD;CAENC,MAAAA,cAAc,EAAE,EAFV;CAGNtD,MAAAA,UAAU,EAAE,EAHN;CAINuD,MAAAA,eAAe,EAAE,IAJX;CAKNC,MAAAA,QAAQ,EAAE,KALJ;CAMNC,MAAAA,aAAa,EAAE;CANT,KAAP;CAQA,GA7BuF;;CA8BxFxD,EAAAA,QAAQ,EAAE;CACTyD,IAAAA,gBAAgB,GAChB;CACC,aAAO,CACN;CACC,sBAAc,KAAK7C,KAAL,CAAWuB,QAD1B;CAEC,yBAAiB,KAAKvB,KAAL,CAAWsB,gBAF7B;CAGC,wBAAgB,KAAKvC,KAAL,CAAWO,MAAX,GAAoB;CAHrC,OADM,EAML,KAAI,KAAKU,KAAL,CAAWC,MAAX,CAAkBC,IAAK,EANtB,CAAP;CAQA,KAXQ;;CAYT4C,IAAAA,gBAAgB,GAChB;CACC,UAAI,KAAK/D,KAAL,CAAWO,MAAX,KAAsB,CAAtB,IAA2B,KAAKyD,QAApC,EACA;CACC,YAAI,KAAKA,QAAT,EACA;CACC,eAAKJ,QAAL,GAAgB,IAAhB;CACA;;CAED,eAAOvB,aAAP;CACA;;CAED,UAAI,KAAKjC,UAAL,CAAgBG,MAAhB,GAAyB,CAA7B,EACA;CACC,eAAOb,WAAP;CACA;;CAED,UAAI,KAAKM,KAAL,CAAWiE,IAAX,CAAgBjB,aAAhB,CAAJ,EACA;CACC,eAAO1B,SAAP;CACA;;CAED,aAAOE,YAAP;CACA,KAnCQ;;CAoCT0C,IAAAA,qBAAqB,GACrB;CACC,UAAI,KAAKH,gBAAL,KAA0B1B,aAA1B,IAA2C,KAAK0B,gBAAL,KAA0BzC,SAAzE,EACA;CACC,eAAO,EAAP;CACA,OAHD,MAIK,IAAI,KAAKyC,gBAAL,KAA0BrE,WAA9B,EACL;CACC,eAAO;CACNM,UAAAA,KAAK,EAAE,KAAKA,KADN;CAENI,UAAAA,UAAU,EAAE,KAAKA;CAFX,SAAP;CAIA,OANI,MAOA,IAAI,KAAK2D,gBAAL,KAA0BvC,YAA9B,EACL;CACC,eAAO;CACNxB,UAAAA,KAAK,EAAE,KAAKA;CADN,SAAP;CAGA;CACD,KAvDQ;;CAwDTmE,IAAAA,KAAK,GACL;CACC,UAAI,KAAKN,aAAT,EACA;CACC,eAAO,KAAKA,aAAZ;CACA,OAHD,MAIK,IAAI,KAAK1B,WAAL,GAAmB,CAAvB,EACL;CACC,eAAO3B,aAAG,CAACC,UAAJ,CAAe,gCAAf,CAAP;CACA;;CAED,aAAO,IAAP;CACA,KApEQ;;CAqET0B,IAAAA,WAAW,GACX;CACC,aAAO,KAAKnC,KAAL,CAAWW,MAAX,CAAkB,CAACyB,MAAD,EAASvB,IAAT,KAAkB;CAC1C,YAAIA,IAAI,CAACkB,MAAL,KAAgBH,2BAAU,CAACI,WAA3B,IAA0CnB,IAAI,CAACkB,MAAL,KAAgBH,2BAAU,CAACK,aAAzE,EACA;CACC,iBAAOG,MAAM,GAAG,CAAhB;CACA,SAHD,MAKA;CACC,iBAAOA,MAAP;CACA;CACD,OATM,EASJ,CATI,CAAP;CAUA,KAjFQ;;CAkFTgC,IAAAA,iBAAiB,GACjB;CACC,aAAO;CACNC,QAAAA,WAAW,EAAE,KAAKxB,KAAL,CAAWhC,IADlB;CAENyD,QAAAA,WAAW,EAAE;CACZC,UAAAA,QAAQ,EAAE;CADE,SAFP;CAKNC,QAAAA,QAAQ,EAAE,IALJ;CAMNC,QAAAA,SAAS,EAAE,CANL;CAONC,QAAAA,UAAU,EAAE,SAPN;CAQNC,QAAAA,iBAAiB,EAAE,aARb;CASNC,QAAAA,YAAY,EAAE,OATR;CAUNC,QAAAA,OAAO,EAAE,KAAKhB,aAAL,KAAuB,IAAvB,GAA8B,EAA9B,GAAmC,EAVtC;CAWNiB,QAAAA,SAAS,EAAE,KAAKjB,aAAL,KAAuB;CAX5B,OAAP;CAaA;;CAjGQ,GA9B8E;CAiIxFkB,EAAAA,KAAK,EAAE;CACNhB,IAAAA,gBAAgB,CAACiB,QAAD,EAAWC,QAAX,EAChB;CACC,UAAI,KAAKjB,QAAT,EACA;CACC,aAAKL,eAAL,GAAuB,KAAvB;CACA,OAHD,MAIK,IAAIsB,QAAQ,KAAK5C,aAAb,IAA8B,KAAKuB,QAAvC,EACL;CACC,aAAKD,eAAL,GAAuB,KAAvB;CACA,OAHI,MAIA,IAAIsB,QAAQ,KAAKzD,YAAjB,EACL;CACC,aAAKmC,eAAL,GAAuB,KAAvB;CACA,OAHI,MAKL;CACC,aAAKC,QAAL,GAAgB,KAAhB;CACA,aAAKD,eAAL,GAAuB,IAAvB;CACA;CACD,KApBK;;CAqBN3D,IAAAA,KAAK,GACL;CACC,UAAI,KAAKA,KAAL,CAAWO,MAAX,KAAsB,CAAtB,IAA2B,KAAKkD,KAApC,EACA;CACC,aAAKA,KAAL,CAAWyB,KAAX;CACA;CACD;;CA3BK,GAjIiF;;CA8JxFC,EAAAA,OAAO,GACP;CACC,SAAKC,OAAL,CAAaC,YAAb,CAA0BC,SAA1B,CAAoC,wBAApC,EAA8D,MAAM;CACnE,WAAKtF,KAAL,CAAWuF,OAAX,CAAmB1E,IAAI,IAAI;CAC1B,YAAIA,IAAI,CAAC2E,MAAL,KAAgBC,2BAAU,CAACC,MAA3B,IAAqC7E,IAAI,CAAC8E,MAAL,KAAgB,IAAzD,EACA;CACC9E,UAAAA,IAAI,CAAC8E,MAAL,GAAc,IAAd;CACA,eAAKvF,UAAL,CAAgBwF,IAAhB,CAAqB/E,IAArB;CACA;CACD,OAND;CAOA,KARD;CAUA,SAAKuE,OAAL,CAAaC,YAAb,CAA0BC,SAA1B,CAAoC,2BAApC,EAAiE,MAAM;CACtE,WAAKlF,UAAL,GAAkB,EAAlB;CACA,KAFD;CAIA,SAAKgF,OAAL,CAAaC,YAAb,CAA0BC,SAA1B,CAAoC,YAApC,EAAmDO,KAAD,IAAsB;CACvE,WAAKhC,aAAL,GAAqB,IAArB;;CACA,UAAI,KAAK5C,KAAL,CAAW0B,WAAX,GAAyBmD,SAAzB,OAAyCC,+BAAc,CAACC,OAA5D,EACA;CACC,cAAMnF,IAAI,GAAGgF,KAAK,CAACI,OAAN,GAAgBpF,IAA7B;CACAA,QAAAA,IAAI,CAAC8E,MAAL,GAAc,IAAd;CACA,aAAKvF,UAAL,CAAgBwF,IAAhB,CAAqBC,KAAK,CAACI,OAAN,GAAgBpF,IAArC;CACA;CACD,KARD;CAUA,SAAKuE,OAAL,CAAaC,YAAb,CAA0BC,SAA1B,CAAoC,eAApC,EAAsDO,KAAD,IAAsB;CAC1E,WAAKhC,aAAL,GAAqB,IAArB;CACA,YAAMhD,IAAI,GAAGgF,KAAK,CAACI,OAAN,GAAgBpF,IAA7B;CACA,YAAM0D,QAAQ,GAAG,KAAKnE,UAAL,CAAgB8F,OAAhB,CAAwBrF,IAAxB,CAAjB;;CACA,UAAI0D,QAAQ,IAAI,CAAhB,EACA;CACC,aAAKnE,UAAL,CAAgB+F,MAAhB,CAAuB5B,QAAvB,EAAiC,CAAjC;CACA;CACD,KARD;CAUA,SAAKa,OAAL,CAAaC,YAAb,CAA0BC,SAA1B,CAAoC,kBAApC,EAAyDO,KAAD,IAAsB;CAC7E,WAAKhC,aAAL,GAAqBgC,KAAK,CAACI,OAAN,GAAgB9B,KAArC;CACA,KAFD;CAGA,GArMuF;;CAsMxFzB,EAAAA,OAAO,GACP;CACC,SAAKzB,KAAL,CAAW0B,WAAX,GAAyBI,YAAzB,CAAsC,KAAKF,KAAL,CAAW,YAAX,CAAtC;CACA,GAzMuF;;CA0MxFuD,EAAAA,OAAO,EAAE;CACRC,IAAAA,SAAS,GACT;CACC,UAAI,CAAC,KAAK5C,KAAV,EACA;CACC,cAAM6C,EAAE,GAAG,oBAAoBC,cAAI,CAACC,SAAL,GAAiBC,WAAjB,EAA/B;CACA,cAAMhD,KAAK,GAAG,IAAIiD,gBAAJ,CAAU;CACvBlH,UAAAA,KAAK,EAAE,GADgB;CAEvBmH,UAAAA,MAAM,EAAE,GAFe;CAGvBC,UAAAA,SAAS,EAAE,IAHY;CAIvBC,UAAAA,QAAQ,EAAErG,aAAG,CAACC,UAAJ,CAAe,0BAAf,CAJa;CAKvBqG,UAAAA,OAAO,EAAG,YAAWR,EAAG,UALD;CAMvBS,UAAAA,SAAS,EAAE,KANY;CAOvBjC,UAAAA,SAAS,EAAE,IAPY;CAQvBkC,UAAAA,UAAU,EAAE,IARW;CASvBC,UAAAA,SAAS,EAAE,IATY;CAUvBC,UAAAA,QAAQ,EAAE,GAVa;CAWvBC,UAAAA,SAAS,EAAE,GAXY;CAYvBC,UAAAA,MAAM,EAAE;CACPC,YAAAA,SAAS,EAAE,MAAM,KAAK5D,KAAL,GAAa;CADvB,WAZe;CAevB6D,UAAAA,OAAO,EAAE,CACR,IAAIC,sBAAJ,CAAgB;CAAEC,YAAAA,OAAO,EAAE,MAAM,KAAK/D,KAAL,CAAWyB,KAAX;CAAjB,WAAhB,CADQ;CAfc,SAAV,CAAd;CAoBA,aAAKxB,cAAL,GAAuB,IAAG4C,EAAG,EAA7B;CACA,aAAK7C,KAAL,GAAaA,KAAb;CACA;;CAED,WAAKA,KAAL,CAAWgE,IAAX;CACA,KA/BO;;CAgCRC,IAAAA,WAAW,GACX;CACC,YAAM1H,KAAK,GAAGE,KAAK,CAACyH,IAAN,CAAW,KAAKvH,UAAhB,CAAd;CACA,WAAKA,UAAL,GAAkB,EAAlB;CAEAJ,MAAAA,KAAK,CAACuF,OAAN,CAAc1E,IAAI,IAAI;CACrB,aAAKI,KAAL,CAAW2G,SAAX,GAAuBC,MAAvB,CAA8BhH,IAAI,CAACyF,EAAnC;CACA,OAFD;CAGA,KAxCO;;CAyCRwB,IAAAA,kBAAkB,CAAC3D,KAAD,EAClB;CACC,UAAI,KAAKN,aAAL,KAAuBM,KAA3B,EACA;CACC,aAAKN,aAAL,GAAqB,IAArB;CACA;CACD;;CA/CO,GA1M+E;CA2PxF;CACAxC,EAAAA,QAAQ,EAAG;;;;;;;;;;;;;;;;;;;;;;;;;;CA5P6E,CAArD,CAA7B;;CCXP;CACA;CACA;AACA,CAAe,MAAM0G,WAAN,SAA0BC,4BAA1B,CACf;CACCC,EAAAA,WAAW,CAACC,eAAD,EAAmCC,kBAAnC,EACX;CACC,UAAMC,aAAa,GAAGC,cAAI,CAACC,aAAL,CAAmBH,kBAAnB,IAAyCI,MAAM,CAACC,MAAP,CAAc,EAAd,EAAkBL,kBAAlB,CAAzC,GAAiF,EAAvG;CACA,UAAMhH,IAAI,GACToH,MAAM,CAACE,MAAP,CAAcvJ,eAAd,EAA+BwJ,QAA/B,CAAwCN,aAAa,CAACjH,IAAtD,IAA8DiH,aAAa,CAACjH,IAA5E,GAAmFjC,eAAe,CAACE,MADpG;CAIA,UAAMuJ,UAAU,GAAG;CAClBjH,MAAAA,IAAI,GACJ;CACC,eAAO;CACNR,UAAAA,MAAM,EAAE;CACPC,YAAAA;CADO;CADF,SAAP;CAKA;;CARiB,KAAnB;CAWA,UAAM+G,eAAN,EAAuBS,UAAvB;CACA;;CAEDC,EAAAA,kBAAkB,GAClB;CACC,WAAO1F,oBAAP;CACA;;CAzBF;;;;;;;;;"}