(function(){"use strict";BX.namespace("BX.UI.Graph");BX.UI.Graph.Circle=function(t,e,r,s){this.domNode=t;this.perimetr=e;this.radius=e/2;this.progressBar=Number(r)>100?100:r;this.progressBg=null;this.number=null;this.waves=null;this.leftWave=null;this.rightWave=null;this.fixCounter=s?s:null};BX.UI.Graph.Circle.prototype={getCircumFerence:function(){return(this.radius-10)*2*3.14},getCircumProgress:function(){return this.getCircumFerence()-this.getCircumFerence()/100*this.progressBar},createCircle:function(){this.svg=document.createElementNS("http://www.w3.org/2000/svg","svg");this.svg.setAttributeNS(null,"class","ui-graph-circle-bar");this.svg.setAttributeNS(null,"viewport","0 0 "+this.radius+" "+this.radius);this.svg.setAttributeNS(null,"width",this.perimetr);this.svg.setAttributeNS(null,"height",this.perimetr);this.progressBg=document.createElementNS("http://www.w3.org/2000/svg","circle");this.progressBg.setAttributeNS(null,"r",this.radius-10);this.progressBg.setAttributeNS(null,"cx",this.radius);this.progressBg.setAttributeNS(null,"cy",this.radius);this.progressBg.setAttributeNS(null,"class","ui-graph-circle-bar-bg");this.progressMove=document.createElementNS("http://www.w3.org/2000/svg","circle");this.progressMove.setAttributeNS(null,"r",this.radius-10);this.progressMove.setAttributeNS(null,"cx",this.radius);this.progressMove.setAttributeNS(null,"cy",this.radius);this.progressMove.setAttributeNS(null,"stroke-dasharray",this.getCircumFerence());this.progressMove.setAttributeNS(null,"stroke-dashoffset",this.getCircumFerence());this.progressMove.setAttributeNS(null,"class","ui-graph-circle-bar-progress");this.svg.appendChild(this.progressBg);this.svg.appendChild(this.progressMove);return this.svg},animateFixedBar:function(){this.svg.setAttributeNS(null,"class","ui-graph-circle-bar ui-graph-circle-bar-animate ui-graph-circle-bar-without-animate");this.progressMove.setAttributeNS(null,"stroke-dashoffset",0)},animateProgressBar:function(){this.svg.setAttributeNS(null,"class","ui-graph-circle-bar ui-graph-circle-bar-animate");this.progressMove.setAttributeNS(null,"stroke-dashoffset",this.getCircumProgress())},createNumberBlock:function(){this.number=BX.create("div",{attrs:{className:"ui-graph-circle-number","data-progress":this.progressBar}});return this.number},createWavesBlock:function(){return BX.create("div",{attrs:{className:"ui-graph-circle-waves-wrapper"},children:[this.waves=BX.create("div",{attrs:{className:"ui-graph-circle-waves"},children:[this.leftWave=BX.create("div",{attrs:{className:"ui-graph-circle-waves-left"}}),this.rightWave=BX.create("div",{attrs:{className:"ui-graph-circle-waves-right"}})]})]})},animateWavesBlock:function(t){var e=this.progressBar;if(t){if(e<=50){e=45}if(e>50){e=85}this.progressBar<=25?e=25:null;this.waves.style.transform="translateY(-"+e+"%)"}this.progressBar<=25?e=25:null;this.waves.style.transform="translateY(-"+e+"%)"},animateBothWaves:function(){var t=0;var e=50;var r=15;var s;var i=Date.now();var a=1e3/r;var n;function h(){requestAnimationFrame(h);s=Date.now();n=s-i;if(n>a){i=s-n%a;var r=document.querySelector(".ui-graph-circle-waves-left");var u=document.querySelector(".ui-graph-circle-waves-right");t+=1;e-=1;r.style.transform="translateX("+t+"%)";u.style.transform="translateX("+e+"%)";if(parseInt(t,10)>=50){t=0}if(parseInt(e,10)<=0){e=50}}}h()},createWrapper:function(){this.graph=BX.create("div",{attrs:{className:"ui-graph-circle-wrapper"}});this.graph.appendChild(this.createCircle());this.graph.appendChild(this.createNumberBlock());this.graph.appendChild(this.createWavesBlock());return this.graph},addWrapperClass:function(){this.graph.classList.add("ui-graph-circle-wrapper-animate");if(this.fixCounter){this.graph.classList.add("ui-graph-circle-counter")}},animateNumber:function(t){var e=this.progressBar;if(t){e=t}if(Number(e)<=0){if(t){this.number.innerHTML="0"}else{this.number.innerHTML="0"+" <span>%</span>"}return}if(t){this.number.innerHTML=t;this.number.innerHTML.length>=4?this.graph.classList.add("ui-graph-font-sm"):null}else{var r=0;var s=1e3/e;var i=setInterval(function(){r++;this.number.innerHTML=r+" <span>%</span>";r===Number(e)?clearInterval(i):null}.bind(this),s)}},updateCounter:function(t,e){this.progressBar=t;if(e){this.progressMove.setAttributeNS(null,"stroke-dashoffset",0)}else{this.progressMove.setAttributeNS(null,"stroke-dashoffset",this.getCircumProgress())}this.animateNumber(e);this.animateWavesBlock(e)},show:function(){this.domNode.appendChild(this.createWrapper());setTimeout(function(){this.addWrapperClass();this.animateNumber(this.fixCounter);if(this.fixCounter){this.animateFixedBar()}else{this.animateProgressBar()}this.animateBothWaves();this.animateWavesBlock(this.fixCounter)}.bind(this),500)}}})();
//# sourceMappingURL=ui.circle.map.js