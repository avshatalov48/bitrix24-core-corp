this.BX=this.BX||{};this.BX.UI=this.BX.UI||{};(function(t,e){"use strict";class r{static flattenAst(t){if(t&&t.getChildren){const e=t.getChildren();return[...e,...e.flatMap((t=>r.flattenAst(t)))]}return[]}static parseSelector(t){const e=/(\w+)\[(.*?)]|\s*(>)\s*|\w+/g;const r=[...t.matchAll(e)];return r.map((([t,e,r,n])=>{if(n){return">"}if(r){const t=/(\w+)=["'](.*?)["']/g;const n=[...r.matchAll(t)];const s=n.map((([,t,e])=>[t,e]));return{nodeName:e,props:s}}return{nodeName:t,props:[]}}))}static matchesNodeWithSelector(t,e){if(t&&t.constructor.name===e.nodeName){if(e.props.length>0){return e.props.every((([e,r])=>t[e]===r))}return true}return false}static findParentNode(t,e){if(t){const n=t.getParent();if(r.matchesNodeWithSelector(n,e)){return n}return r.findParentNode(n,e)}return null}static findElements(t,n){const s=r.flattenAst(t);const i=r.parseSelector(n);const c=i.at(-1);let o=false;return i.reduceRight(((t,n)=>{if(e.Type.isPlainObject(n)){if(n===c){return t.filter((t=>r.matchesNodeWithSelector(t,n)))}if(o){o=false;return t.filter((t=>r.matchesNodeWithSelector(t.getParent(),n)))}return t.filter((t=>r.findParentNode(t,n)!==null))}if(n===">"){o=true}return t}),s)}static reduceAst(t,n){const s=t.getChildren==null?void 0:t.getChildren().reduce(((t,s)=>{const i=[r.reduceAst(s,n)].flat();if(!e.Type.isNil(i)){t.replaceChild(s,...i)}return t}),t);return n(t,s)}}t.AstProcessor=r})(this.BX.UI.Bbcode=this.BX.UI.Bbcode||{},BX);
//# sourceMappingURL=ast-processor.bundle.map.js