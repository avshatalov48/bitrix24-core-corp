this.BX=this.BX||{};this.BX.UI=this.BX.UI||{};(function(e,s,i,t,l){"use strict";let a=e=>e,r;var o=babelHelpers.classPrivateFieldLooseKey("list");var c=babelHelpers.classPrivateFieldLooseKey("node");var n=babelHelpers.classPrivateFieldLooseKey("sync");var b=babelHelpers.classPrivateFieldLooseKey("addSilent");class d extends t.EventEmitter{constructor(e={}){super();Object.defineProperty(this,b,{value:h});Object.defineProperty(this,o,{writable:true,value:[]});Object.defineProperty(this,c,{writable:true,value:void 0});Object.defineProperty(this,n,{writable:true,value:false});this.setEventNamespace("ui:sidepanel:menu:collection");this.setItems(e.items)}setActiveFirstItem(){const e=this.list()[0];if(!e){return}e.setActive(true);e.getCollection().setActiveFirstItem()}getActiveItem(){return this.list().filter((e=>e.isActive()))[0]}syncActive(e){if(babelHelpers.classPrivateFieldLooseBase(this,n)[n]){return this}babelHelpers.classPrivateFieldLooseBase(this,n)[n]=true;this.list().filter((s=>s!==e)).forEach((e=>{e.getCollection().isEmpty()?e.setActive(false):e.getCollection().syncActive(e)}));this.emit("sync:active");babelHelpers.classPrivateFieldLooseBase(this,n)[n]=false;return this}add(e){const s=babelHelpers.classPrivateFieldLooseBase(this,b)[b](e);this.emit("change");if(babelHelpers.classPrivateFieldLooseBase(this,c)[c]){this.render()}return s}get(e){return this.list().filter((s=>s.getId()===e))[0]}change(e,s){const i=this.list().find((s=>s.getId()===e));if(i){i.change(s);return i}return null}remove(e){const s=this.list().find((s=>s.getId()===e));if(s){this.emit("change");babelHelpers.classPrivateFieldLooseBase(this,o)[o]=this.list().filter((e=>e!==s));s.remove()}}setItems(e=[]){babelHelpers.classPrivateFieldLooseBase(this,o)[o]=e.map((e=>babelHelpers.classPrivateFieldLooseBase(this,b)[b](e)));this.emit("change");if(babelHelpers.classPrivateFieldLooseBase(this,c)[c]){this.render()}return this}list(){return babelHelpers.classPrivateFieldLooseBase(this,o)[o]}isEmpty(){return this.list().length===0}hasActive(e=true){const s=this.list().some((e=>e.isActive()));if(s){return true}if(!e){return false}return this.list().some((e=>e.getCollection().hasActive()))}render(){if(!babelHelpers.classPrivateFieldLooseBase(this,c)[c]){babelHelpers.classPrivateFieldLooseBase(this,c)[c]=l.Tag.render(r||(r=a`<div class="ui-sidepanel-menu-items"></div>`))}babelHelpers.classPrivateFieldLooseBase(this,c)[c].innerHTML="";babelHelpers.classPrivateFieldLooseBase(this,o)[o].forEach((e=>babelHelpers.classPrivateFieldLooseBase(this,c)[c].appendChild(e.render())));return babelHelpers.classPrivateFieldLooseBase(this,c)[c]}}function h(e){if(e.active){e.active=!this.hasActive()}else{e.active=false}const s=new w(e);babelHelpers.classPrivateFieldLooseBase(this,o)[o].push(s);s.subscribe("change:active",(()=>{if(s.isActive()&&s.getCollection().isEmpty()){this.syncActive(s)}}));s.subscribe("sync:active",(()=>this.syncActive(s)));s.subscribe("click",(e=>this.emit("click",e)));s.subscribe("change",(()=>setTimeout((()=>this.render()),0)));return s}let v=e=>e,p,u,P;var L=babelHelpers.classPrivateFieldLooseKey("id");var H=babelHelpers.classPrivateFieldLooseKey("label");var F=babelHelpers.classPrivateFieldLooseKey("active");var f=babelHelpers.classPrivateFieldLooseKey("notice");var B=babelHelpers.classPrivateFieldLooseKey("onclick");var m=babelHelpers.classPrivateFieldLooseKey("collection");var y=babelHelpers.classPrivateFieldLooseKey("node");var g=babelHelpers.classPrivateFieldLooseKey("actions");var A=babelHelpers.classPrivateFieldLooseKey("moduleId");var I=babelHelpers.classPrivateFieldLooseKey("emitChange");var E=babelHelpers.classPrivateFieldLooseKey("handleClick");var k=babelHelpers.classPrivateFieldLooseKey("showActionMenu");class w extends t.EventEmitter{constructor(e){super(e);Object.defineProperty(this,k,{value:j});Object.defineProperty(this,E,{value:M});Object.defineProperty(this,I,{value:C});Object.defineProperty(this,L,{writable:true,value:void 0});Object.defineProperty(this,H,{writable:true,value:void 0});Object.defineProperty(this,F,{writable:true,value:void 0});Object.defineProperty(this,f,{writable:true,value:void 0});Object.defineProperty(this,B,{writable:true,value:void 0});Object.defineProperty(this,m,{writable:true,value:void 0});Object.defineProperty(this,y,{writable:true,value:void 0});Object.defineProperty(this,g,{writable:true,value:void 0});Object.defineProperty(this,A,{writable:true,value:void 0});this.setEventNamespace("ui:sidepanel:menu:item");babelHelpers.classPrivateFieldLooseBase(this,m)[m]=new d;this.setLabel(e.label).setActive(e.active).setNotice(e.notice).setId(e.id).setItems(e.items).setClickHandler(e.onclick).setActions(e.actions).setModuleId(e.moduleId);babelHelpers.classPrivateFieldLooseBase(this,m)[m].subscribe("sync:active",(()=>this.emit("sync:active")));babelHelpers.classPrivateFieldLooseBase(this,m)[m].subscribe("click",(e=>this.emit("click",e)))}setLabel(e=""){if(babelHelpers.classPrivateFieldLooseBase(this,H)[H]===e){return this}babelHelpers.classPrivateFieldLooseBase(this,H)[H]=e;babelHelpers.classPrivateFieldLooseBase(this,I)[I]();return this}setId(e){if(babelHelpers.classPrivateFieldLooseBase(this,L)[L]===e){return this}babelHelpers.classPrivateFieldLooseBase(this,L)[L]=e;babelHelpers.classPrivateFieldLooseBase(this,I)[I]();return this}setActive(e=true){e=!!e;if(babelHelpers.classPrivateFieldLooseBase(this,F)[F]===e){return this}babelHelpers.classPrivateFieldLooseBase(this,F)[F]=e;babelHelpers.classPrivateFieldLooseBase(this,I)[I]({active:babelHelpers.classPrivateFieldLooseBase(this,F)[F]},"active");return this}setNotice(e=false){babelHelpers.classPrivateFieldLooseBase(this,f)[f]=!!e;babelHelpers.classPrivateFieldLooseBase(this,I)[I]();return this}setClickHandler(e){babelHelpers.classPrivateFieldLooseBase(this,B)[B]=e;return this}setModuleId(e){babelHelpers.classPrivateFieldLooseBase(this,A)[A]=e;return this}setActions(e=[]){babelHelpers.classPrivateFieldLooseBase(this,g)[g]=e;return this}setItems(e=[]){babelHelpers.classPrivateFieldLooseBase(this,m)[m].setItems(e||[]);babelHelpers.classPrivateFieldLooseBase(this,I)[I]();return this}getCollection(){return babelHelpers.classPrivateFieldLooseBase(this,m)[m]}getLabel(){return babelHelpers.classPrivateFieldLooseBase(this,H)[H]}getId(){return babelHelpers.classPrivateFieldLooseBase(this,L)[L]}getModuleId(){return babelHelpers.classPrivateFieldLooseBase(this,A)[A]}getClickHandler(){return babelHelpers.classPrivateFieldLooseBase(this,B)[B]}isActive(){return babelHelpers.classPrivateFieldLooseBase(this,F)[F]}hasNotice(){return babelHelpers.classPrivateFieldLooseBase(this,f)[f]}hasActions(){return babelHelpers.classPrivateFieldLooseBase(this,g)[g].length>0}change(e){if(!l.Type.isUndefined(e.label)){this.setLabel(e.label)}if(!l.Type.isUndefined(e.active)){this.setActive(e.active)}if(!l.Type.isUndefined(e.notice)){this.setNotice(e.notice)}if(!l.Type.isUndefined(e.id)){this.setId(e.id)}if(!l.Type.isUndefined(e.items)){this.setItems(e.items)}if(!l.Type.isUndefined(e.onclick)){this.setClickHandler(e.onclick)}if(!l.Type.isUndefined(e.actions)){this.setActions(e.actions)}}remove(){l.Dom.remove(babelHelpers.classPrivateFieldLooseBase(this,y)[y]);babelHelpers.classPrivateFieldLooseBase(this,y)[y]=null}render(){const e=babelHelpers.classPrivateFieldLooseBase(this,m)[m].isEmpty();const s=[];if(babelHelpers.classPrivateFieldLooseBase(this,F)[F]){if(e){s.push("ui-sidepanel-menu-active")}else{s.push("ui-sidepanel-menu-expand")}}const i=l.Loc.getMessage("UI_SIDEPANEL_MENU_JS_"+(this.isActive()?"COLLAPSE":"EXPAND"));babelHelpers.classPrivateFieldLooseBase(this,y)[y]=l.Tag.render(p||(p=v`
			<li class="ui-sidepanel-menu-item ${0}">
				<a
					class="ui-sidepanel-menu-link"
					onclick="${0}"
					title="${0}"
				>
					<div class="ui-sidepanel-menu-link-text">${0}</div>
					${0}
					${0}
					${0}
				</a>
			</li>
		`),s.join(" "),babelHelpers.classPrivateFieldLooseBase(this,E)[E].bind(this),l.Tag.safe(u||(u=v`${0}`),babelHelpers.classPrivateFieldLooseBase(this,H)[H]),l.Tag.safe(P||(P=v`${0}`),babelHelpers.classPrivateFieldLooseBase(this,H)[H]),!e?`<div class="ui-sidepanel-toggle-btn">${i}</div>`:"",babelHelpers.classPrivateFieldLooseBase(this,f)[f]?'<span class="ui-sidepanel-menu-notice-icon"></span>':"",this.hasActions()?'<span class="ui-sidepanel-menu-action-icon ui-btn ui-btn-link ui-btn-icon-edit"></span>':"");if(this.hasActions()){l.Event.bind(babelHelpers.classPrivateFieldLooseBase(this,y)[y].querySelector(".ui-sidepanel-menu-action-icon"),"click",babelHelpers.classPrivateFieldLooseBase(this,k)[k].bind(this))}if(!babelHelpers.classPrivateFieldLooseBase(this,m)[m].isEmpty()){l.Dom.append(babelHelpers.classPrivateFieldLooseBase(this,m)[m].render(),babelHelpers.classPrivateFieldLooseBase(this,y)[y])}return babelHelpers.classPrivateFieldLooseBase(this,y)[y]}}function C(e={},s=null){this.emit("change",e);if(s){this.emit("change:"+s,e)}}function M(e){e.preventDefault();e.stopPropagation();this.setActive(babelHelpers.classPrivateFieldLooseBase(this,m)[m].isEmpty()||!this.isActive());this.emit("click",{item:this});if(l.Type.isFunction(babelHelpers.classPrivateFieldLooseBase(this,B)[B])){babelHelpers.classPrivateFieldLooseBase(this,B)[B].apply(this)}}function j(e){e.preventDefault();e.stopPropagation();if(this.actionsMenu){this.actionsMenu.getPopupWindow().close();return}const s=e.currentTarget;l.Dom.addClass(s,"--hover");l.Dom.addClass(s.parentNode,"--hover");this.actionsMenu=new i.Menu({id:`ui-sidepanel-menu-item-actions-${this.getId()}`,bindElement:s});babelHelpers.classPrivateFieldLooseBase(this,g)[g].forEach((e=>{this.actionsMenu.addMenuItem({text:e.label,onclick:(s,i)=>{i.getMenuWindow().close();e.onclick(this)}})}));this.actionsMenu.getPopupWindow().subscribe("onClose",(()=>{l.Dom.removeClass(s,"--hover");l.Dom.removeClass(s.parentNode,"--hover");this.actionsMenu.destroy();this.actionsMenu=null}));this.actionsMenu.show()}let O=e=>e,K;var T=babelHelpers.classPrivateFieldLooseKey("node");class U extends d{constructor(e={}){super({items:e.items});Object.defineProperty(this,T,{writable:true,value:void 0});if(!this.hasActive()){this.setActiveFirstItem()}}render(){const e=super.render();if(!babelHelpers.classPrivateFieldLooseBase(this,T)[T]){babelHelpers.classPrivateFieldLooseBase(this,T)[T]=l.Tag.render(K||(K=O`<ul class="ui-sidepanel-menu"></ul>`));babelHelpers.classPrivateFieldLooseBase(this,T)[T].appendChild(e)}return babelHelpers.classPrivateFieldLooseBase(this,T)[T]}renderTo(e){const s=this.render();e.appendChild(s);return s}}e.Item=w;e.Menu=U})(this.BX.UI.SidePanel=this.BX.UI.SidePanel||{},BX,BX.Main,BX.Event,BX);
//# sourceMappingURL=sidepanel.menu.bundle.map.js