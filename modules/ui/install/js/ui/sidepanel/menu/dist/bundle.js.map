{"version":3,"file":"bundle.js","sources":["../src/collection.js","../src/item.js","../src/menu.js"],"sourcesContent":["import {Tag, Type} from 'main.core';\nimport {EventEmitter, BaseEvent} from 'main.core.events';\nimport {Item, type ItemOptions} from './item.js';\n\ntype CollectionOptions = {\n\titems: Array<ItemOptions>;\n};\n\nexport class Collection extends EventEmitter\n{\n\t#list: Array<Item> = [];\n\t#node: HTMLElement;\n\t#sync: boolean = false;\n\n\tconstructor(options: CollectionOptions = {})\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('ui:sidepanel:menu:collection');\n\t\tthis.setItems(options.items);\n\t}\n\n\t#addSilent(itemOptions: ItemOptions): Item\n\t{\n\t\tif (itemOptions.active)\n\t\t{\n\t\t\titemOptions.active = !this.hasActive();\n\t\t}\n\t\telse\n\t\t{\n\t\t\titemOptions.active = false;\n\t\t}\n\n\t\tconst item = new Item(itemOptions);\n\t\tthis.#list.push(item);\n\t\titem.subscribe('change:active', () => {\n\t\t\tif (item.isActive() && item.getCollection().isEmpty())\n\t\t\t{\n\t\t\t\tthis.syncActive(item);\n\t\t\t}\n\t\t});\n\t\titem.subscribe('sync:active', () => this.syncActive(item));\n\t\titem.subscribe('click', data => this.emit('click', data));\n\t\titem.subscribe('change', () => setTimeout(() => this.render(), 0));\n\n\t\treturn item;\n\t}\n\n\tsetActiveFirstItem(): void\n\t{\n\t\tconst item = this.list()[0];\n\t\tif (!item)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\titem.setActive(true);\n\t\titem.getCollection().setActiveFirstItem();\n\t}\n\n\tgetActiveItem(): Item\n\t{\n\t\treturn this.list().filter(item => item.isActive())[0];\n\t}\n\n\tsyncActive(excludeItem): Collection\n\t{\n\t\tif (this.#sync)\n\t\t{\n\t\t\treturn this;\n\t\t}\n\n\t\tthis.#sync = true;\n\t\tthis.list()\n\t\t\t.filter(otherItem => otherItem !== excludeItem)\n\t\t\t.forEach(otherItem => {\n\t\t\t\totherItem.getCollection().isEmpty()\n\t\t\t\t\t? otherItem.setActive(false)\n\t\t\t\t\t: otherItem.getCollection().syncActive(otherItem)\n\n\t\t\t})\n\t\t;\n\n\t\tthis.emit('sync:active');\n\t\tthis.#sync = false;\n\t\treturn this;\n\t}\n\n\tadd(itemOptions: ItemOptions): Item\n\t{\n\t\tconst item = this.#addSilent(itemOptions);\n\t\tthis.emit('change');\n\n\t\tif (this.#node)\n\t\t{\n\t\t\tthis.render();\n\t\t}\n\n\t\treturn item;\n\t}\n\n\tget(id: number | string): ?Item\n\t{\n\t\treturn this.list().filter(item => item.getId() === id)[0];\n\t}\n\n\tchange(id: number | string, options: ItemOptions): ?Item\n\t{\n\t\tconst foundItem = this.list().find((item: Item) => item.getId() === id);\n\n\t\tif (foundItem)\n\t\t{\n\t\t\tfoundItem.change(options);\n\n\t\t\treturn foundItem;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tremove(id: number | string)\n\t{\n\t\tconst foundItem = this.list().find((item: Item) => item.getId() === id);\n\t\tif (foundItem)\n\t\t{\n\t\t\tthis.emit('change');\n\n\t\t\tthis.#list = this.list().filter(otherItem => otherItem !== foundItem);\n\n\t\t\tfoundItem.remove();\n\t\t}\n\t}\n\n\tsetItems(items: Array<ItemOptions> = []): Collection\n\t{\n\t\tthis.#list = items.map(itemOptions => this.#addSilent(itemOptions));\n\t\tthis.emit('change');\n\n\t\tif (this.#node)\n\t\t{\n\t\t\tthis.render();\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tlist(): Array<Item>\n\t{\n\t\treturn this.#list;\n\t}\n\n\tisEmpty(): boolean\n\t{\n\t\treturn this.list().length === 0;\n\t}\n\n\thasActive(recursively: boolean = true): boolean\n\t{\n\t\tconst has = this.list().some(item => item.isActive());\n\t\tif (has)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tif (!recursively)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\treturn this.list().some(item => item.getCollection().hasActive());\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tif (!this.#node)\n\t\t{\n\t\t\tthis.#node = Tag.render`<div class=\"ui-sidepanel-menu-items\"></div>`;\n\t\t}\n\n\t\tthis.#node.innerHTML = '';\n\t\tthis.#list.forEach((item: Item) => this.#node.appendChild(item.render()));\n\n\t\treturn this.#node;\n\t}\n}\n","import {Tag, Type, Loc, Event, Dom} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport {Menu} from 'main.popup';\n\nimport {Collection} from './collection.js';\n\nexport type ItemOptions = {\n\tlabel: string;\n\tactive: ?boolean;\n\tnotice: ?boolean;\n\tonclick: ?Function;\n\tid: ?string;\n\titems: ?Array<ItemOptions>;\n\tactions?: Array<ActionOptions>\n};\n\ntype ActionOptions = {\n\tid: number | string;\n\tlabel: string,\n\tonclick: Function;\n}\n\nexport class Item extends EventEmitter\n{\n\t#id: ?string;\n\t#label: string;\n\t#active: ?boolean;\n\t#notice: ?boolean;\n\t#onclick: ?Function;\n\t#collection: Collection;\n\t#node: HTMLElement;\n\t#actions: Array<ActionOptions>\n\n\tconstructor(options: ItemOptions)\n\t{\n\t\tsuper(options);\n\n\t\tthis.setEventNamespace('ui:sidepanel:menu:item');\n\n\t\tthis.#collection = new Collection();\n\t\tthis.setLabel(options.label)\n\t\t\t.setActive(options.active)\n\t\t\t.setNotice(options.notice)\n\t\t\t.setId(options.id)\n\t\t\t.setItems(options.items)\n\t\t\t.setClickHandler(options.onclick)\n\t\t\t.setActions(options.actions)\n\t\t;\n\n\t\tthis.#collection.subscribe('sync:active', () => this.emit('sync:active'));\n\t\tthis.#collection.subscribe('click', event => this.emit('click', event));\n\t}\n\n\tsetLabel(label: string = ''): Item\n\t{\n\t\tif (this.#label === label)\n\t\t{\n\t\t\treturn this;\n\t\t}\n\n\t\tthis.#label = label;\n\t\tthis.#emitChange();\n\t\treturn this;\n\t}\n\n\tsetId(id: string): Item\n\t{\n\t\tif (this.#id === id)\n\t\t{\n\t\t\treturn this;\n\t\t}\n\n\t\tthis.#id = id;\n\t\tthis.#emitChange();\n\t\treturn this;\n\t}\n\n\tsetActive(mode: boolean = true): Item\n\t{\n\t\tmode = !!mode;\n\t\tif (this.#active === mode)\n\t\t{\n\t\t\treturn this;\n\t\t}\n\n\t\tthis.#active = mode;\n\t\tthis.#emitChange({active: this.#active}, 'active');\n\n\t\treturn this;\n\t}\n\n\tsetNotice(mode: boolean = false): Item\n\t{\n\t\tthis.#notice = !!mode;\n\t\tthis.#emitChange();\n\t\treturn this;\n\t}\n\n\tsetClickHandler(handler: Function): Item\n\t{\n\t\tthis.#onclick = handler;\n\t\treturn this;\n\t}\n\n\tsetActions(actions: Array<ActionOptions> = []): Item\n\t{\n\t\tthis.#actions = actions;\n\n\t\treturn this;\n\t}\n\n\tsetItems(items: Array<ItemOptions> = []): Item\n\t{\n\t\tthis.#collection.setItems(items || []);\n\t\tthis.#emitChange();\n\t\treturn this;\n\t}\n\n\tgetCollection(): Collection\n\t{\n\t\treturn this.#collection;\n\t}\n\n\tgetLabel(): string\n\t{\n\t\treturn this.#label;\n\t}\n\n\tgetId(): ?string\n\t{\n\t\treturn this.#id;\n\t}\n\n\tgetClickHandler(): ?Function\n\t{\n\t\treturn this.#onclick;\n\t}\n\n\tisActive(): boolean\n\t{\n\t\treturn this.#active;\n\t}\n\n\thasNotice(): boolean\n\t{\n\t\treturn this.#notice;\n\t}\n\n\thasActions(): boolean\n\t{\n\t\treturn this.#actions.length > 0;\n\t}\n\n\tchange(options: ItemOptions)\n\t{\n\t\tif (!Type.isUndefined(options.label))\n\t\t{\n\t\t\tthis.setLabel(options.label);\n\t\t}\n\n\t\tif (!Type.isUndefined(options.active))\n\t\t{\n\t\t\tthis.setActive(options.active);\n\t\t}\n\n\t\tif (!Type.isUndefined(options.notice))\n\t\t{\n\t\t\tthis.setNotice(options.notice);\n\t\t}\n\n\t\tif (!Type.isUndefined(options.id))\n\t\t{\n\t\t\tthis.setId(options.id);\n\t\t}\n\n\t\tif (!Type.isUndefined(options.items))\n\t\t{\n\t\t\tthis.setItems(options.items);\n\t\t}\n\n\t\tif (!Type.isUndefined(options.onclick))\n\t\t{\n\t\t\tthis.setClickHandler(options.onclick);\n\t\t}\n\n\t\tif (!Type.isUndefined(options.actions))\n\t\t{\n\t\t\tthis.setActions(options.actions);\n\t\t}\n\t}\n\n\tremove()\n\t{\n\t\tDom.remove(this.#node);\n\n\t\tthis.#node = null;\n\t}\n\n\t#emitChange(data = {}, type: string = null): void\n\t{\n\t\tthis.emit('change', data);\n\t\tif (type)\n\t\t{\n\t\t\tthis.emit('change:' + type, data);\n\t\t}\n\t}\n\n\t#handleClick(event: Event)\n\t{\n\t\tevent.preventDefault();\n\t\tevent.stopPropagation();\n\n\t\tthis.setActive(this.#collection.isEmpty() || !this.isActive());\n\t\tthis.emit('click', {item: this});\n\t\tif (Type.isFunction(this.#onclick))\n\t\t{\n\t\t\tthis.#onclick.apply(this);\n\t\t}\n\t}\n\n\t#showActionMenu(event: Event)\n\t{\n\t\tevent.preventDefault();\n\t\tevent.stopPropagation();\n\n\t\tif (this.actionsMenu)\n\t\t{\n\t\t\tthis.actionsMenu.getPopupWindow().close();\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst targetIcon: HTMLElement = event.currentTarget;\n\n\t\tDom.addClass(targetIcon, '--hover');\n\t\tDom.addClass(targetIcon.parentNode, '--hover');\n\n\t\tthis.actionsMenu = new Menu({\n\t\t\tid: `ui-sidepanel-menu-item-actions-${this.getId()}`,\n\t\t\tbindElement: targetIcon\n\t\t});\n\n\t\tthis.#actions.forEach((action: ActionOptions) => {\n\t\t\tthis.actionsMenu.addMenuItem({\n\t\t\t\ttext: action.label,\n\t\t\t\tonclick: (event, menuItem) => {\n\t\t\t\t\tmenuItem.getMenuWindow().close();\n\t\t\t\t\taction.onclick(this);\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\n\t\tthis.actionsMenu.getPopupWindow()\n\t\t\t.subscribe('onClose', () => {\n\t\t\t\tDom.removeClass(targetIcon, '--hover');\n\t\t\t\tDom.removeClass(targetIcon.parentNode, '--hover');\n\n\t\t\t\tthis.actionsMenu.destroy();\n\t\t\t\tthis.actionsMenu = null;\n\t\t\t})\n\t\t;\n\n\t\tthis.actionsMenu.show();\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tconst isEmpty = this.#collection.isEmpty();\n\n\t\tconst classes = [];\n\t\tif (this.#active)\n\t\t{\n\t\t\tif (isEmpty)\n\t\t\t{\n\t\t\t\tclasses.push('ui-sidepanel-menu-active');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tclasses.push('ui-sidepanel-menu-expand');\n\t\t\t}\n\t\t}\n\n\t\tconst actionText = Loc.getMessage('UI_SIDEPANEL_MENU_JS_' + (this.isActive() ? 'COLLAPSE' : 'EXPAND'));\n\t\tthis.#node = Tag.render`\n\t\t\t<li class=\"ui-sidepanel-menu-item ${classes.join(' ')}\">\n\t\t\t\t<a\n\t\t\t\t\tclass=\"ui-sidepanel-menu-link\"\n\t\t\t\t\tonclick=\"${this.#handleClick.bind(this)}\"\n\t\t\t\t\ttitle=\"${Tag.safe`${this.#label}`}\"\n\t\t\t\t>\n\t\t\t\t\t<div class=\"ui-sidepanel-menu-link-text\">${Tag.safe`${this.#label}`}</div>\n\t\t\t\t\t${!isEmpty ? `<div class=\"ui-sidepanel-toggle-btn\">${actionText}</div>` : ''}\n\t\t\t\t\t${this.#notice ? '<span class=\"ui-sidepanel-menu-notice-icon\"></span>' : ''}\n\t\t\t\t\t${\n\t\t\t\t\t\tthis.hasActions()\n\t\t\t\t\t\t\t? '<span class=\"ui-sidepanel-menu-action-icon ui-btn ui-btn-link ui-btn-icon-edit\"></span>'\n\t\t\t\t\t\t\t: ''\n\t\t\t\t\t}\n\t\t\t\t</a>\n\t\t\t</li>\n\t\t`;\n\n\t\tif (this.hasActions())\n\t\t{\n\t\t\tEvent.bind(\n\t\t\t\tthis.#node.querySelector('.ui-sidepanel-menu-action-icon'),\n\t\t\t\t'click',\n\t\t\t\tthis.#showActionMenu.bind(this)\n\t\t\t);\n\t\t}\n\n\t\tif (!this.#collection.isEmpty())\n\t\t{\n\t\t\tDom.append(this.#collection.render(), this.#node);\n\t\t}\n\n\t\treturn this.#node;\n\t}\n}\n","import 'ui.fonts.opensans';\nimport './style.css';\nimport {Item, ItemOptions} from './item.js';\nimport {Collection} from './collection.js';\nimport {Tag} from 'main.core';\n\nexport {Item};\n\nexport type MenuOptions = {\n\titems: Array<ItemOptions>;\n};\n\nexport class Menu extends Collection\n{\n\t#node: HTMLElement;\n\n\tconstructor(options: MenuOptions = {})\n\t{\n\t\tsuper({items: options.items});\n\n\t\tif (!this.hasActive())\n\t\t{\n\t\t\tthis.setActiveFirstItem();\n\t\t}\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tconst itemsNode = super.render();\n\t\tif (!this.#node)\n\t\t{\n\t\t\tthis.#node = Tag.render`<ul class=\"ui-sidepanel-menu\"></ul>`;\n\t\t\tthis.#node.appendChild(itemsNode);\n\t\t}\n\n\t\treturn this.#node;\n\t}\n\n\trenderTo(target: HTMLElement): HTMLElement\n\t{\n\t\tconst node = this.render();\n\t\ttarget.appendChild(node);\n\t\treturn node;\n\t}\n}"],"names":["Collection","options","setEventNamespace","setItems","items","item","list","setActive","getCollection","setActiveFirstItem","filter","isActive","excludeItem","otherItem","forEach","isEmpty","syncActive","emit","itemOptions","render","id","getId","foundItem","find","change","remove","map","length","recursively","has","some","hasActive","Tag","innerHTML","appendChild","EventEmitter","active","Item","push","subscribe","data","setTimeout","_classPrivateMethodInitSpec","_classPrivateFieldInitSpec","setLabel","label","setNotice","notice","setId","setClickHandler","onclick","setActions","actions","event","_classPrivateMethodGet","mode","handler","Type","isUndefined","Dom","classes","actionText","Loc","getMessage","join","bind","safe","hasActions","Event","querySelector","append","type","preventDefault","stopPropagation","isFunction","apply","actionsMenu","getPopupWindow","close","targetIcon","currentTarget","addClass","parentNode","Menu","bindElement","action","addMenuItem","text","menuItem","getMenuWindow","removeClass","destroy","show","itemsNode","target","node"],"mappings":"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"}