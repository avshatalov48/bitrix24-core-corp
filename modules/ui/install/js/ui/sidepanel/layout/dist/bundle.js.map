{"version":3,"file":"bundle.js","sources":["../src/index.js"],"sourcesContent":["import 'ui.fonts.opensans';\nimport './style.css';\nimport 'sidepanel';\nimport {Dom, Tag, Type, BaseError, Event, Runtime} from 'main.core';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\nimport {CloseButton, CancelButton, BaseButton} from 'ui.buttons';\nimport {Menu, type MenuOptions, Item as MenuItem} from 'ui.sidepanel.menu';\n\nconst UI = BX.UI;\nconst SidePanel = BX.SidePanel;\n\ntype DesignOptions = {\n\tmargin: ?boolean;\n\tsection: ?boolean;\n\talignButtonsLeft: ?boolean;\n};\n\ntype SidePanelMenuOptions = {\n\t...MenuOptions;\n\tcontentAttribute: ?string;\n};\n\ntype Options = {\n\textensions: ?Array<string>;\n\ttitle: ?string;\n\ttoolbar: ?Function;\n\tcontent: string|Element|Promise|BX.Promise;\n\tbuttons: ?Function;\n\tdesign: ?DesignOptions;\n\tmenu: ?SidePanelMenuOptions;\n};\n\nfunction prepareOptions(options: Options = {})\n{\n\toptions = Object.assign({}, options);\n\toptions.design = Object.assign({}, options.design || {});\n\toptions.design = {\n\t\tmargin: true,\n\t\tsection: true,\n\t\t...options.design,\n\t};\n\n\toptions.extensions = (options.extensions || []).concat([\n\t\t'ui.sidepanel.layout',\n\t\t'ui.buttons',\n\t]);\n\tif (options.toolbar)\n\t{\n\t\toptions.extensions.push('ui.buttons.icons');\n\t}\n\tif (options.design.section)\n\t{\n\t\toptions.extensions.push('ui.sidepanel-content');\n\t}\n\tif (options.menu)\n\t{\n\t\toptions.extensions.push('ui.sidepanel.menu');\n\t}\n\n\treturn options;\n}\n\nexport class Layout\n{\n\tstatic createContent(options: Options = {})\n\t{\n\t\toptions = prepareOptions(options);\n\t\treturn top.BX.Runtime\n\t\t\t.loadExtension(options.extensions)\n\t\t\t.then(() => (new Layout(options)).render())\n\t\t;\n\t}\n\n\tstatic createLayout(options: Options = {}): Promise\n\t{\n\t\toptions = prepareOptions(options);\n\n\t\treturn top.BX.Runtime\n\t\t\t.loadExtension(options.extensions)\n\t\t\t.then(() => new Layout(options))\n\t\t;\n\t}\n\n\t#container;\n\t#containerFooter;\n\t#options;\n\t#menu: Menu;\n\n\tconstructor(options: Options = {})\n\t{\n\t\tthis.#options = prepareOptions(options);\n\t\tconst menuOptions = this.#options.menu;\n\t\tif (menuOptions)\n\t\t{\n\t\t\tthis.#menu = new Menu(Object.assign(menuOptions));\n\t\t\tif (Type.isUndefined(menuOptions.contentAttribute))\n\t\t\t{\n\t\t\t\tmenuOptions.contentAttribute = 'data-menu-item-id';\n\t\t\t}\n\t\t\tif (menuOptions.contentAttribute)\n\t\t\t{\n\t\t\t\tthis.#menu.subscribe('click', (event: BaseEvent) => {\n\t\t\t\t\tthis.#onMenuItemClick((event.getData() || {}).item);\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\tgetContainer()\n\t{\n\t\tif (!this.#container)\n\t\t{\n\t\t\tthis.#container = Tag.render`<div class=\"ui-sidepanel-layout\"></div>`;\n\t\t}\n\t\treturn this.#container;\n\t}\n\n\tgetMenu(): Menu\n\t{\n\t\treturn this.#menu;\n\t}\n\n\tgetFooterContainer()\n\t{\n\t\tif (!this.#containerFooter)\n\t\t{\n\t\t\tthis.#containerFooter = Tag.render`<div class=\"ui-sidepanel-layout-footer\"></div>`;\n\t\t}\n\n\t\treturn this.#containerFooter;\n\t}\n\n\trender(content: string = '', promised: boolean = false)\n\t{\n\t\tif (this.#options.content && !promised)\n\t\t{\n\t\t\tcontent = this.#options.content();\n\t\t\tif (\n\t\t\t\tObject.prototype.toString.call(content) === \"[object Promise]\"\n\t\t\t\t|| (content.toString && content.toString() === \"[object BX.Promise]\")\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn content.then(content => this.render(content, true));\n\t\t\t}\n\t\t}\n\n\t\tconst container = this.getContainer();\n\t\tcontainer.innerHTML = '';\n\n\t\t// HEADER\n\t\tif (this.#options.title)\n\t\t{\n\t\t\tconst title = Tag.safe`${this.#options.title}`;\n\t\t\tconst header = Tag.render`\n\t\t\t\t<div class=\"ui-sidepanel-layout-header\">\n\t\t\t\t\t<div class=\"ui-sidepanel-layout-title\">${title}</div>\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tif (Type.isFunction(this.#options.toolbar))\n\t\t\t{\n\t\t\t\tconst toolbar = Tag.render`<div class=\"ui-sidepanel-layout-toolbar\"></div>`;\n\t\t\t\tthis.#options.toolbar({...UI}).forEach(button => {\n\t\t\t\t\tif (button instanceof BaseButton)\n\t\t\t\t\t{\n\t\t\t\t\t\tbutton.renderTo(toolbar)\n\t\t\t\t\t}\n\t\t\t\t\telse if (Type.isDomNode(button))\n\t\t\t\t\t{\n\t\t\t\t\t\ttoolbar.appendChild(button);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthrow BaseError('Wrong button type ' + button);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\theader.appendChild(toolbar);\n\t\t\t}\n\n\t\t\tcontainer.appendChild(header);\n\t\t}\n\n\t\t// CONTENT\n\t\t{\n\t\t\tconst design = this.#options.design;\n\t\t\tconst classes = ['ui-sidepanel-layout-content'];\n\t\t\tconst styles = [];\n\t\t\tif (design.margin)\n\t\t\t{\n\t\t\t\tif (design.margin === true)\n\t\t\t\t{\n\t\t\t\t\tclasses.push('ui-sidepanel-layout-content-margin');\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tstyles.push('margin: ' + design.margin);\n\t\t\t\t}\n\t\t\t}\n\t\t\tlet contentElement = Tag.render`<div class=\"${classes.join(' ')}\" style=\"${styles.join('; ')}\"></div>`;\n\t\t\tcontainer.appendChild(contentElement);\n\n\t\t\tif (this.#menu)\n\t\t\t{\n\t\t\t\tthis.#menu.renderTo(contentElement);\n\t\t\t}\n\t\t\tcontentElement.appendChild(Tag.render`<div class=\"ui-sidepanel-layout-content-inner\"></div>`);\n\t\t\tcontentElement = contentElement.lastElementChild;\n\n\t\t\tif (design.section)\n\t\t\t{\n\t\t\t\tcontentElement.appendChild(Tag.render`<div class=\"ui-slider-section ui-sidepanel-layout-content-fill-height\"></div>`);\n\t\t\t\tcontentElement = contentElement.firstElementChild;\n\t\t\t}\n\t\t\tif (typeof content === 'string')\n\t\t\t{\n\t\t\t\tcontentElement.innerHTML = content;\n\t\t\t}\n\t\t\telse if (content instanceof Element)\n\t\t\t{\n\t\t\t\tcontentElement.appendChild(content);\n\t\t\t}\n\n\t\t\tif (this.#menu)\n\t\t\t{\n\t\t\t\tthis.#onMenuItemClick(this.#menu.getActiveItem(), contentElement);\n\t\t\t}\n\t\t}\n\n\t\t// FOOTER\n\t\tconst isButtonsUndefined = typeof this.#options.buttons === 'undefined';\n\t\tif (typeof this.#options.buttons === 'function' || isButtonsUndefined)\n\t\t{\n\t\t\tconst cancelButton = new CancelButton({onclick: () => SidePanel.Instance.close()});\n\t\t\tconst closeButton = new CloseButton({onclick: () => SidePanel.Instance.close()});\n\t\t\tconst defaults = {\n\t\t\t\t...UI,\n\t\t\t\tcancelButton,\n\t\t\t\tcloseButton,\n\t\t\t};\n\t\t\tif (isButtonsUndefined)\n\t\t\t{\n\t\t\t\tthis.#options.buttons = () => [closeButton];\n\t\t\t}\n\n\t\t\tconst buttonList = this.#options.buttons(defaults);\n\t\t\tif (buttonList && buttonList.length > 0)\n\t\t\t{\n\t\t\t\tcontainer.appendChild(Tag.render`<div class=\"ui-sidepanel-layout-footer-anchor\"></div>`);\n\n\t\t\t\tconst classes = ['ui-sidepanel-layout-buttons'];\n\t\t\t\tif (this.#options.design.alignButtonsLeft)\n\t\t\t\t{\n\t\t\t\t\tclasses.push('ui-sidepanel-layout-buttons-align-left');\n\t\t\t\t}\n\t\t\t\tconst buttons = Tag.render`<div class=\"${classes.join(' ')}\"></div>`;\n\t\t\t\tthis.getFooterContainer().appendChild(buttons);\n\t\t\t\tbuttonList.forEach(button => {\n\t\t\t\t\tif (button instanceof BaseButton)\n\t\t\t\t\t{\n\t\t\t\t\t\tbutton.renderTo(buttons)\n\t\t\t\t\t}\n\t\t\t\t\telse if (Type.isDomNode(button))\n\t\t\t\t\t{\n\t\t\t\t\t\tbuttons.appendChild(button);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthrow BaseError('Wrong button type ' + button);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tcontainer.appendChild(this.getFooterContainer());\n\t\t\t}\n\t\t}\n\n\t\tsetTimeout(()=> {\n\t\t\tthis.afterRender();\n\t\t});\n\t\treturn container;\n\t}\n\n\tafterRender()\n\t{\n\t\tthis.#adjustFooter();\n\n\t\tconst resizeHandler = Runtime.throttle(this.#adjustFooter, 300, this);\n\t\tEvent.bind(window, \"resize\", resizeHandler);\n\n\t\tconst topSlider = SidePanel.Instance.getTopSlider();\n\t\tif (topSlider)\n\t\t{\n\t\t\tEventEmitter.subscribeOnce(topSlider, 'SidePanel.Slider:onDestroy', () => {\n\t\t\t\tEvent.unbind(window, \"resize\", resizeHandler);\n\t\t\t});\n\t\t}\n\t}\n\n\t#getScrollWidth()\n\t{\n\t\tconst div = Tag.render`<div style=\"overflow-y: scroll; width: 50px; height: 50px; opacity: 0; pointer-events: none; position: absolute;\"></div>`\n\t\tdocument.body.appendChild(div);\n\t\tconst scrollWidth = div.offsetWidth - div.clientWidth\n\t\tDom.remove(div);\n\t\treturn scrollWidth;\n\t}\n\n\n\t#adjustFooter()\n\t{\n\t\tconst parentSet = this.getContainer().parentNode;\n\n\t\tif (parentSet.scrollWidth > parentSet.offsetWidth)\n\t\t{\n\t\t\tDom.style(this.getFooterContainer(), 'bottom', this.#getScrollWidth() + 'px');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.style(this.getFooterContainer(), 'bottom', 0);\n\t\t}\n\t}\n\n\t#onMenuItemClick(item: MenuItem, container: HTMLElement = null)\n\t{\n\t\tif (!item)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst id = item.getId();\n\t\tlet attr = this.#options.menu.contentAttribute;\n\t\tif (!attr)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tcontainer = container || this.#container;\n\t\tlet nodes = container.querySelectorAll(`[${attr}]`);\n\t\tnodes = Array.prototype.slice.call(nodes);\n\t\tnodes.forEach(node => {\n\t\t\tnode.hidden = node.getAttribute(attr) !== id;\n\t\t});\n\t}\n}"],"names":["UI","BX","SidePanel","prepareOptions","options","Object","assign","design","margin","section","extensions","concat","toolbar","push","menu","Layout","top","Runtime","loadExtension","then","render","menuOptions","Menu","Type","isUndefined","contentAttribute","subscribe","event","getData","item","Tag","content","promised","prototype","toString","call","container","getContainer","innerHTML","title","safe","header","isFunction","forEach","button","BaseButton","renderTo","isDomNode","appendChild","BaseError","classes","styles","contentElement","join","lastElementChild","firstElementChild","Element","getActiveItem","isButtonsUndefined","buttons","cancelButton","CancelButton","onclick","Instance","close","closeButton","CloseButton","defaults","buttonList","length","alignButtonsLeft","getFooterContainer","setTimeout","afterRender","resizeHandler","throttle","Event","bind","window","topSlider","getTopSlider","EventEmitter","subscribeOnce","unbind","div","document","body","scrollWidth","offsetWidth","clientWidth","Dom","remove","parentSet","parentNode","style","id","getId","attr","nodes","querySelectorAll","Array","slice","node","hidden","getAttribute"],"mappings":"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"}