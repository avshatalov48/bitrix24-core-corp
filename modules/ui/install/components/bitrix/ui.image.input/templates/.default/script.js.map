{"version":3,"file":"script.js","sources":["script.es6.js"],"sourcesContent":["import {Dom, Event, Reflection, Tag, Type} from 'main.core';\nimport {type BaseEvent, EventEmitter} from 'main.core.events';\nimport {Loader} from 'main.loader';\n\nclass ImageInput\n{\n\tcontainer = null;\n\tloaderContainer = null;\n\taddButton = null;\n\tloader = null;\n\ttimeout = null;\n\tuploading = false;\n\n\tconstructor(params = {})\n\t{\n\t\tthis.instanceId = params.instanceId;\n\t\tthis.containerId = params.containerId;\n\t\tthis.loaderContainerId = params.loaderContainerId;\n\t\tthis.settings = params.settings || {};\n\n\t\tthis.addImageHandler = this.addImage.bind(this);\n\t\tthis.editImageHandler = this.editImage.bind(this);\n\n\t\tEventEmitter.subscribe('onUploaderIsInited', this.onUploaderIsInitedHandler.bind(this));\n\t}\n\n\tonUploaderIsInitedHandler(event: BaseEvent)\n\t{\n\t\tconst [id, uploader] = event.getCompatData();\n\n\t\tif (this.instanceId === id)\n\t\t{\n\t\t\tif (this.getPreviews().length > 0)\n\t\t\t{\n\t\t\t\tDom.addClass(this.getFileWrapper(), 'ui-image-input-wrapper');\n\t\t\t}\n\n\t\t\trequestAnimationFrame(() => {\n\t\t\t\tthis.getLoaderContainer() && (this.getLoaderContainer().style.display = 'none');\n\t\t\t\tthis.getContainer().style.display = '';\n\t\t\t});\n\n\t\t\tEventEmitter.subscribe(uploader, 'onFileIsDeleted', this.onFileIsDeletedHandler.bind(this));\n\t\t\tEventEmitter.subscribe(uploader, 'onStart', this.onUploadStartHandler.bind(this));\n\t\t\tEventEmitter.subscribe(uploader, 'onDone', this.onUploadDoneHandler.bind(this));\n\t\t\tEventEmitter.subscribe(uploader, 'onFileCanvasIsLoaded', this.onFileCanvasIsLoadedHandler.bind(this));\n\t\t}\n\t}\n\n\tgetInputInstance()\n\t{\n\t\treturn BX.UI.FileInput.getInstance(this.instanceId);\n\t}\n\n\tgetFileInput()\n\t{\n\t\treturn this.getInputInstance().agent.fileInput;\n\t}\n\n\tgetContainer()\n\t{\n\t\tif (!this.container)\n\t\t{\n\t\t\tthis.container = document.getElementById(this.containerId);\n\n\t\t\tif (!Type.isDomNode(this.container))\n\t\t\t{\n\t\t\t\tthrow Error(`Can't find container with id ${this.containerId}`);\n\t\t\t}\n\t\t}\n\n\t\treturn this.container;\n\t}\n\n\tgetFileWrapper()\n\t{\n\t\tif (!this.fileWrapper)\n\t\t{\n\t\t\tthis.fileWrapper = this.getContainer().querySelector('.adm-fileinput-wrapper');\n\t\t}\n\n\t\treturn this.fileWrapper;\n\t}\n\n\tgetLoaderContainer()\n\t{\n\t\tif (!this.loaderContainer)\n\t\t{\n\t\t\tthis.loaderContainer = document.getElementById(this.loaderContainerId);\n\t\t}\n\n\t\treturn this.loaderContainer;\n\t}\n\n\tgetAddButton()\n\t{\n\t\tif (!this.addButton)\n\t\t{\n\t\t\tthis.addButton = this.getContainer().querySelector('[data-role=\"image-add-button\"]');\n\t\t}\n\n\t\treturn this.addButton;\n\t}\n\n\teditImage(event)\n\t{\n\t\tif (event.target === this.getFileInput())\n\t\t{\n\t\t\t// api call .click() to fire file upload dialog\n\t\t\tif (event.detail === 0)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t// disable default file dialog open\n\t\t\telse\n\t\t\t{\n\t\t\t\tevent.preventDefault();\n\t\t\t}\n\t\t}\n\n\t\tconst inputInstance = this.getInputInstance();\n\t\tconst items = inputInstance.agent.getItems().items;\n\n\t\tfor (let id in items)\n\t\t{\n\t\t\tif (items.hasOwnProperty(id))\n\t\t\t{\n\t\t\t\t// hack to open editor (for unknown reasons the flag disappears)\n\t\t\t\tinputInstance.frameFlags.active = true;\n\t\t\t\tinputInstance.frameFiles(id);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\taddImage(event)\n\t{\n\t\tevent.preventDefault();\n\t\tevent.stopPropagation();\n\t\tthis.getFileInput().click();\n\t}\n\n\t/**\n\t * @returns {Loader}\n\t */\n\tgetLoader()\n\t{\n\t\tif (!this.loader)\n\t\t{\n\t\t\tthis.loader = new Loader({\n\t\t\t\ttarget: this.getFileWrapper().querySelector('.adm-fileinput-drag-area')\n\t\t\t});\n\t\t}\n\n\t\treturn this.loader;\n\t}\n\t\n\tshowLoader()\n\t{\n\t\tthis.getLoader().setOptions({\n\t\t\tsize: Math.min(this.getContainer().offsetHeight, this.getContainer().offsetWidth)\n\t\t});\n\t\tthis.getLoader().show();\n\t}\n\t\n\thideLoader()\n\t{\n\t\tthis.getLoader().hide();\n\t}\n\n\tonFileIsDeletedHandler()\n\t{\n\t\tthis.timeout = clearTimeout(this.timeout);\n\n\t\tthis.timeout = setTimeout(() => {\n\t\t\tthis.hideLoader();\n\t\t\tthis.recalculateWrapper();\n\t\t}, 100);\n\t}\n\n\tonUploadStartHandler(event: BaseEvent)\n\t{\n\t\tconst [stream] = event.getCompatData();\n\t\tif (stream)\n\t\t{\n\t\t\tthis.uploading = true;\n\t\t}\n\n\t\tclearTimeout(this.timeout);\n\n\t\tthis.timeout = setTimeout(() => {\n\t\t\tthis.showLoader();\n\t\t\tthis.recalculateWrapper();\n\t\t}, 100);\n\t}\n\n\tonUploadDoneHandler(event: BaseEvent)\n\t{\n\t\tconst [stream] = event.getCompatData();\n\t\tif (stream)\n\t\t{\n\t\t\tthis.uploading = false;\n\t\t\tthis.timeout = clearTimeout(this.timeout);\n\n\t\t\trequestAnimationFrame(() => {\n\t\t\t\tthis.hideLoader();\n\t\t\t\tthis.recalculateWrapper();\n\t\t\t});\n\t\t}\n\t}\n\n\tonFileCanvasIsLoadedHandler()\n\t{\n\t\tif (this.timeout && !this.uploading)\n\t\t{\n\t\t\tthis.uploading = false;\n\t\t\tthis.timeout = clearTimeout(this.timeout);\n\n\t\t\trequestAnimationFrame(() => {\n\t\t\t\tthis.hideLoader();\n\t\t\t\tthis.recalculateWrapper();\n\t\t\t});\n\t\t}\n\t}\n\n\tisMultipleInput()\n\t{\n\t\treturn this.getInputInstance().uploadParams.maxCount !== 1;\n\t}\n\n\tbuildShadowElement(wrapper)\n\t{\n\t\tlet shadowElement = wrapper.querySelector('div.ui-image-item-shadow');\n\t\tif (!shadowElement)\n\t\t{\n\t\t\tshadowElement = Tag.render`<div class=\"ui-image-item-shadow\"></div>`;\n\t\t\tDom.prepend(shadowElement, wrapper);\n\t\t}\n\n\t\tconst canvas = wrapper.querySelector('canvas');\n\t\tif (canvas)\n\t\t{\n\t\t\tconst bottomMargin = 4;\n\n\t\t\tshadowElement.style.height = canvas.offsetHeight + 'px';\n\t\t\tshadowElement.style.width = canvas.offsetWidth - bottomMargin + 'px';\n\n\t\t\twrapper.querySelector('.adm-fileinput-item-preview').style.height = canvas.offsetHeight + 'px';\n\t\t\twrapper.closest('.adm-fileinput-item-wrapper').style.height = canvas.offsetHeight + 'px';\n\t\t}\n\t}\n\n\tgetPreviews()\n\t{\n\t\treturn this.getFileWrapper().querySelectorAll('.adm-fileinput-item');\n\t}\n\n\trecalculateWrapper()\n\t{\n\t\tconst wrapper = this.getFileWrapper();\n\t\tconst previews = this.getPreviews();\n\t\tconst length = Math.min(previews.length, 3);\n\n\t\tif (length)\n\t\t{\n\t\t\tthis.buildShadowElement(previews[0]);\n\n\t\t\tDom.addClass(wrapper, 'ui-image-input-wrapper');\n\t\t\tthis.getFileInput().style.display = 'none';\n\n\t\t\tEvent.unbind(wrapper, 'click', this.editImageHandler);\n\t\t\tEvent.bind(wrapper, 'click', this.editImageHandler);\n\n\t\t\tif (this.isMultipleInput())\n\t\t\t{\n\t\t\t\tthis.getAddButton().style.display = '';\n\n\t\t\t\tEvent.unbind(this.getAddButton(), 'click', this.addImageHandler);\n\t\t\t\tEvent.bind(this.getAddButton(), 'click', this.addImageHandler);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.removeClass(wrapper, 'ui-image-input-wrapper');\n\t\t\tthis.getFileInput().style.display = '';\n\n\t\t\tEvent.unbind(wrapper, 'click', this.editImageHandler);\n\n\t\t\tif (this.isMultipleInput())\n\t\t\t{\n\t\t\t\tthis.getAddButton().style.display = 'none';\n\n\t\t\t\tEvent.unbind(this.getAddButton(), 'click', this.addImageHandler);\n\t\t\t}\n\t\t}\n\n\t\tswitch (length)\n\t\t{\n\t\t\tcase 3:\n\t\t\t\tDom.addClass(wrapper, 'ui-image-input-wrapper-multiple');\n\t\t\t\tDom.removeClass(wrapper, 'ui-image-input-wrapper-double');\n\t\t\t\tbreak;\n\n\t\t\tcase 2:\n\t\t\t\tDom.addClass(wrapper, 'ui-image-input-wrapper-double');\n\t\t\t\tDom.removeClass(wrapper, 'ui-image-input-wrapper-multiple');\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tDom.removeClass(wrapper, 'ui-image-input-wrapper-double');\n\t\t\t\tDom.removeClass(wrapper, 'ui-image-input-wrapper-multiple');\n\t\t\t\tbreak;\n\t\t}\n\t}\n}\n\nReflection.namespace('BX.UI').ImageInput = ImageInput;"],"names":["ImageInput","params","instanceId","containerId","loaderContainerId","settings","addImageHandler","addImage","bind","editImageHandler","editImage","EventEmitter","subscribe","onUploaderIsInitedHandler","event","getCompatData","id","uploader","getPreviews","length","Dom","addClass","getFileWrapper","requestAnimationFrame","getLoaderContainer","style","display","getContainer","onFileIsDeletedHandler","onUploadStartHandler","onUploadDoneHandler","onFileCanvasIsLoadedHandler","BX","UI","FileInput","getInstance","getInputInstance","agent","fileInput","container","document","getElementById","Type","isDomNode","Error","fileWrapper","querySelector","loaderContainer","addButton","target","getFileInput","detail","preventDefault","inputInstance","items","getItems","hasOwnProperty","frameFlags","active","frameFiles","stopPropagation","click","loader","Loader","getLoader","setOptions","size","Math","min","offsetHeight","offsetWidth","show","hide","timeout","clearTimeout","setTimeout","hideLoader","recalculateWrapper","stream","uploading","showLoader","uploadParams","maxCount","wrapper","shadowElement","Tag","render","prepend","canvas","bottomMargin","height","width","closest","querySelectorAll","previews","buildShadowElement","Event","unbind","isMultipleInput","getAddButton","removeClass","Reflection","namespace"],"mappings":"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"}