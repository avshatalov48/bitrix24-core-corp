(function(e,i,a){"use strict";function s(){var e=babelHelpers.taggedTemplateLiteral(['<a href="','" class="ui-icon ui-icon-xs ui-icon-common-user" title="','"><i></i></a>']);s=function i(){return e};return e}function t(){var e=babelHelpers.taggedTemplateLiteral(['<a href="','" class="ui-editor-config-item-avatar"  title="','" style="background-image: url(\'',"')\"></a>"]);t=function i(){return e};return e}function l(e,i,a){if(!i.has(e)){throw new TypeError("attempted to get private field on non-instance")}return a}var r=i.Reflection.namespace("BX.Ui.Form");var n=function e(i){var a=this;babelHelpers.classCallCheck(this,e);babelHelpers.defineProperty(this,"isOpen",false);o.set(this,{writable:true,value:[]});babelHelpers.defineProperty(this,"popupContainer",null);i.scopes.forEach(function(e){e.config=a;babelHelpers.classPrivateFieldGet(a,o).push(new BX.Ui.Form.ConfigItem(e))},this);this.popupContainer=i.componentId};var o=new WeakMap;var c=function(e){babelHelpers.inherits(i,e);function i(e){var a;babelHelpers.classCallCheck(this,i);a=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(i).call(this));T.add(babelHelpers.assertThisInitialized(a));w.add(babelHelpers.assertThisInitialized(a));g.add(babelHelpers.assertThisInitialized(a));F.add(babelHelpers.assertThisInitialized(a));I.add(babelHelpers.assertThisInitialized(a));C.add(babelHelpers.assertThisInitialized(a));H.add(babelHelpers.assertThisInitialized(a));f.add(babelHelpers.assertThisInitialized(a));d.set(babelHelpers.assertThisInitialized(a),{writable:true,value:void 0});b.set(babelHelpers.assertThisInitialized(a),{writable:true,value:void 0});p.set(babelHelpers.assertThisInitialized(a),{writable:true,value:void 0});v.set(babelHelpers.assertThisInitialized(a),{writable:true,value:void 0});u.set(babelHelpers.assertThisInitialized(a),{writable:true,value:void 0});h.set(babelHelpers.assertThisInitialized(a),{writable:true,value:"BX.Ui.Form.ConfigItem:onComponentOpen"});m.set(babelHelpers.assertThisInitialized(a),{writable:true,value:"BX.Main.SelectorV2:reInitDialog"});a.setEventNamespace("BX.Ui.Form");babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(a),d,e["scopeId"]||null);babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(a),b,e["members"]||null);babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(a),p,BX("ui-editor-config-".concat(babelHelpers.classPrivateFieldGet(babelHelpers.assertThisInitialized(a),d))));babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(a),v,null);a.drawingIconsLimit=e["drawingIconsLimit"]||10;babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(a),u,e["moduleId"]||null);a.config=e["config"]||null;l(babelHelpers.assertThisInitialized(a),f,k).call(babelHelpers.assertThisInitialized(a));a.addToAccessCodesHandler=BX.delegate(a.onAddToAccessCodes,babelHelpers.assertThisInitialized(a));a.removeFromAccessCodesHandler=BX.delegate(a.onRemoveFromAccessCodes,babelHelpers.assertThisInitialized(a));a.closePopupHandler=BX.delegate(a.onClosePopup,babelHelpers.assertThisInitialized(a));BX.addCustomEvent("Grid::updated",a.onGridUpdate.bind(babelHelpers.assertThisInitialized(a)));setTimeout(function(){BX.onCustomEvent("BX.Ui.Form.ConfigItem:onComponentLoad",[{openDialogWhenInit:false}])},100);return a}babelHelpers.createClass(i,[{key:"onGridUpdate",value:function e(i){l(this,T,z).call(this)}},{key:"onClosePopup",value:function e(i){this.config.isOpen=false;l(this,w,X).call(this)}},{key:"onAddToAccessCodes",value:function e(i){var a=this;BX.ajax.runComponentAction("bitrix:ui.form.config","updateScopeAccessCodes",{data:{moduleId:babelHelpers.classPrivateFieldGet(this,u),scopeId:babelHelpers.classPrivateFieldGet(this,d),accessCodes:l(this,g,S).call(this)}}).then(function(e){l(a,T,z).call(a,e.data)})}},{key:"onRemoveFromAccessCodes",value:function e(i){this.onAddToAccessCodes(i)}}],[{key:"onMemberSelect",value:function e(i){if(i.state==="select"){a.EventEmitter.emit("BX.Ui.Form.ConfigItem:addToAccessCodes",i)}}},{key:"onDialogClose",value:function e(i){a.EventEmitter.emit("BX.Ui.Form.ConfigItem:closePopup",i)}},{key:"onMemberUnselect",value:function e(i){a.EventEmitter.emit("BX.Ui.Form.ConfigItem:removeFromAccessCodes",i)}}]);return i}(a.EventEmitter);var d=new WeakMap;var b=new WeakMap;var p=new WeakMap;var v=new WeakMap;var u=new WeakMap;var h=new WeakMap;var m=new WeakMap;var f=new WeakSet;var H=new WeakSet;var C=new WeakSet;var I=new WeakSet;var F=new WeakSet;var g=new WeakSet;var w=new WeakSet;var T=new WeakSet;var d=new WeakMap;var b=new WeakMap;var p=new WeakMap;var v=new WeakMap;var u=new WeakMap;var h=new WeakMap;var m=new WeakMap;var f=new WeakSet;var H=new WeakSet;var C=new WeakSet;var I=new WeakSet;var F=new WeakSet;var g=new WeakSet;var w=new WeakSet;var T=new WeakSet;var k=function e(){if(babelHelpers.classPrivateFieldGet(this,b)){var i=0;for(var a in babelHelpers.classPrivateFieldGet(this,b)){var s=babelHelpers.classPrivateFieldGet(this,b)[a];babelHelpers.classPrivateFieldGet(this,p).appendChild(l(this,H,P).call(this,s));if(i++>this.drawingIconsLimit){break}}}babelHelpers.classPrivateFieldGet(this,p).appendChild(l(this,C,W).call(this))};var P=function e(a){var l=a.avatar?i.Tag.render(t(),a.url,i.Text.encode(a.name),a.avatar):i.Tag.render(s(),a.url,i.Text.encode(a.name));return i.Dom.create("div",{attrs:{class:"ui-editor-config-item"},children:[l]})};var W=function e(){var a=this;return i.Dom.create("div",{events:{click:function e(i){if(!a.config.isOpen){l(a,I,B).call(a)}}},attrs:{class:"ui-editor-config-item ui-editor-config-item--add"}})};var B=function e(){this.config.isOpen=true;l(this,F,E).call(this);var i=BX.Main.selectorManagerV2.controls[this.config.popupContainer].selectorInstance;i.itemsSelected={};BX.onCustomEvent(babelHelpers.classPrivateFieldGet(this,h),[{id:this.config.popupContainer,bindNode:babelHelpers.classPrivateFieldGet(this,p)}]);BX.onCustomEvent(babelHelpers.classPrivateFieldGet(this,m),[{selectorId:this.config.popupContainer,selectedItems:l(this,g,S).call(this)}])};var E=function e(){a.EventEmitter.subscribe("BX.Ui.Form.ConfigItem:addToAccessCodes",this.addToAccessCodesHandler);a.EventEmitter.subscribe("BX.Ui.Form.ConfigItem:removeFromAccessCodes",this.removeFromAccessCodesHandler);a.EventEmitter.subscribe("BX.Ui.Form.ConfigItem:closePopup",this.closePopupHandler)};var S=function e(){if(babelHelpers.classPrivateFieldGet(this,b)&&!babelHelpers.classPrivateFieldGet(this,v)){var i={};for(var a in babelHelpers.classPrivateFieldGet(this,b)){i[a]=babelHelpers.classPrivateFieldGet(this,b)[a].type.toUpperCase()}babelHelpers.classPrivateFieldSet(this,v,i)}return babelHelpers.classPrivateFieldGet(this,v)||{}};var X=function e(){a.EventEmitter.unsubscribe("BX.Ui.Form.ConfigItem:addToAccessCodes",this.addToAccessCodesHandler);a.EventEmitter.unsubscribe("BX.Ui.Form.ConfigItem:removeFromAccessCodes",this.removeFromAccessCodesHandler);a.EventEmitter.unsubscribe("BX.Ui.Form.ConfigItem:closePopup",this.closePopupHandler)};var z=function e(i){babelHelpers.classPrivateFieldSet(this,p,BX("ui-editor-config-".concat(babelHelpers.classPrivateFieldGet(this,d))));if(i){babelHelpers.classPrivateFieldSet(this,b,i)}if(babelHelpers.classPrivateFieldGet(this,p)){while(babelHelpers.classPrivateFieldGet(this,p).firstChild){babelHelpers.classPrivateFieldGet(this,p).removeChild(babelHelpers.classPrivateFieldGet(this,p).firstChild)}l(this,f,k).call(this)}};r.Config=n;r.ConfigItem=c})(this.window=this.window||{},BX,BX.Event);
//# sourceMappingURL=script.map.js