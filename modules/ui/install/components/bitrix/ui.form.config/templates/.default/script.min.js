(function(e,i,s){"use strict";function t(){var e=babelHelpers.taggedTemplateLiteral(['<a href="','" class="ui-icon ui-icon-xs ui-icon-common-user" title="','"><i></i></a>']);t=function i(){return e};return e}function a(){var e=babelHelpers.taggedTemplateLiteral(['<a href="','" class="ui-editor-config-item-avatar"  title="','" style="background-image: url(\'',"')\"></a>"]);a=function i(){return e};return e}function l(e,i,s){if(!i.has(e)){throw new TypeError("attempted to get private field on non-instance")}return s}var r=i.Reflection.namespace("BX.Ui.Form");var n=new WeakMap;var o=function e(i){var s=this;babelHelpers.classCallCheck(this,e);babelHelpers.defineProperty(this,"isOpen",false);n.set(this,{writable:true,value:[]});babelHelpers.defineProperty(this,"popupContainer",null);i.scopes.forEach(function(e){e.config=s;babelHelpers.classPrivateFieldGet(s,n).push(new BX.Ui.Form.ConfigItem(e))},this);this.popupContainer=i.componentId};var c=new WeakMap;var d=new WeakMap;var b=new WeakMap;var p=new WeakMap;var v=new WeakMap;var u=new WeakMap;var h=new WeakMap;var m=new WeakSet;var f=new WeakSet;var H=new WeakSet;var C=new WeakSet;var I=new WeakSet;var F=new WeakSet;var g=new WeakSet;var T=new WeakSet;var P=function(e){babelHelpers.inherits(i,e);function i(e){var s;babelHelpers.classCallCheck(this,i);s=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(i).call(this));T.add(babelHelpers.assertThisInitialized(s));g.add(babelHelpers.assertThisInitialized(s));F.add(babelHelpers.assertThisInitialized(s));I.add(babelHelpers.assertThisInitialized(s));C.add(babelHelpers.assertThisInitialized(s));H.add(babelHelpers.assertThisInitialized(s));f.add(babelHelpers.assertThisInitialized(s));m.add(babelHelpers.assertThisInitialized(s));c.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});d.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});b.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});p.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});v.set(babelHelpers.assertThisInitialized(s),{writable:true,value:void 0});u.set(babelHelpers.assertThisInitialized(s),{writable:true,value:"BX.Ui.Form.ConfigItem:onComponentOpen"});h.set(babelHelpers.assertThisInitialized(s),{writable:true,value:"BX.Main.SelectorV2:reInitDialog"});s.setEventNamespace("BX.Ui.Form");babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(s),c,e["scopeId"]||null);babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(s),d,e["members"]||null);babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(s),b,BX("ui-editor-config-".concat(babelHelpers.classPrivateFieldGet(babelHelpers.assertThisInitialized(s),c))));babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(s),p,null);s.drawingIconsLimit=e["drawingIconsLimit"]||10;babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(s),v,e["moduleId"]||null);s.config=e["config"]||null;l(babelHelpers.assertThisInitialized(s),m,w).call(babelHelpers.assertThisInitialized(s));s.addToAccessCodesHandler=BX.delegate(s.onAddToAccessCodes,babelHelpers.assertThisInitialized(s));s.removeFromAccessCodesHandler=BX.delegate(s.onRemoveFromAccessCodes,babelHelpers.assertThisInitialized(s));s.closePopupHandler=BX.delegate(s.onClosePopup,babelHelpers.assertThisInitialized(s));BX.addCustomEvent("Grid::updated",s.onGridUpdate.bind(babelHelpers.assertThisInitialized(s)));setTimeout(function(){BX.onCustomEvent("BX.Ui.Form.ConfigItem:onComponentLoad",[{openDialogWhenInit:false}])},100);return s}babelHelpers.createClass(i,[{key:"onGridUpdate",value:function e(i){l(this,T,A).call(this)}},{key:"onClosePopup",value:function e(i){this.config.isOpen=false;l(this,g,G).call(this)}},{key:"onAddToAccessCodes",value:function e(i){var s=this;BX.ajax.runComponentAction("bitrix:ui.form.config","updateScopeAccessCodes",{data:{moduleId:babelHelpers.classPrivateFieldGet(this,v),scopeId:babelHelpers.classPrivateFieldGet(this,c),accessCodes:l(this,F,z).call(this)}}).then(function(e){l(s,T,A).call(s,e.data)})}},{key:"onRemoveFromAccessCodes",value:function e(i){this.onAddToAccessCodes(i)}}],[{key:"onMemberSelect",value:function e(i){if(i.state==="select"){s.EventEmitter.emit("BX.Ui.Form.ConfigItem:addToAccessCodes",i)}}},{key:"onDialogClose",value:function e(i){s.EventEmitter.emit("BX.Ui.Form.ConfigItem:closePopup",i)}},{key:"onMemberUnselect",value:function e(i){s.EventEmitter.emit("BX.Ui.Form.ConfigItem:removeFromAccessCodes",i)}}]);return i}(s.EventEmitter);var w=function e(){if(babelHelpers.classPrivateFieldGet(this,d)){var i=0;for(var s in babelHelpers.classPrivateFieldGet(this,d)){var t=babelHelpers.classPrivateFieldGet(this,d)[s];babelHelpers.classPrivateFieldGet(this,b).appendChild(l(this,f,k).call(this,t));if(i++>this.drawingIconsLimit){break}}}babelHelpers.classPrivateFieldGet(this,b).appendChild(l(this,H,B).call(this))};var k=function e(s){var l=s.avatar?i.Tag.render(a(),s.url,i.Text.encode(s.name),s.avatar):i.Tag.render(t(),s.url,i.Text.encode(s.name));return i.Dom.create("div",{attrs:{class:"ui-editor-config-item"},children:[l]})};var B=function e(){var s=this;return i.Dom.create("div",{events:{click:function e(i){if(!s.config.isOpen){l(s,C,E).call(s)}}},attrs:{class:"ui-editor-config-item ui-editor-config-item--add"}})};var E=function e(){this.config.isOpen=true;l(this,I,X).call(this);var i=BX.Main.selectorManagerV2.controls[this.config.popupContainer].selectorInstance;i.itemsSelected={};BX.onCustomEvent(babelHelpers.classPrivateFieldGet(this,u),[{id:this.config.popupContainer,bindNode:babelHelpers.classPrivateFieldGet(this,b)}]);BX.onCustomEvent(babelHelpers.classPrivateFieldGet(this,h),[{selectorId:this.config.popupContainer,selectedItems:l(this,F,z).call(this)}])};var X=function e(){s.EventEmitter.subscribe("BX.Ui.Form.ConfigItem:addToAccessCodes",this.addToAccessCodesHandler);s.EventEmitter.subscribe("BX.Ui.Form.ConfigItem:removeFromAccessCodes",this.removeFromAccessCodesHandler);s.EventEmitter.subscribe("BX.Ui.Form.ConfigItem:closePopup",this.closePopupHandler)};var z=function e(){if(babelHelpers.classPrivateFieldGet(this,d)&&!babelHelpers.classPrivateFieldGet(this,p)){var i={};for(var s in babelHelpers.classPrivateFieldGet(this,d)){i[s]=babelHelpers.classPrivateFieldGet(this,d)[s].type.toUpperCase()}babelHelpers.classPrivateFieldSet(this,p,i)}return babelHelpers.classPrivateFieldGet(this,p)||{}};var G=function e(){s.EventEmitter.unsubscribe("BX.Ui.Form.ConfigItem:addToAccessCodes",this.addToAccessCodesHandler);s.EventEmitter.unsubscribe("BX.Ui.Form.ConfigItem:removeFromAccessCodes",this.removeFromAccessCodesHandler);s.EventEmitter.unsubscribe("BX.Ui.Form.ConfigItem:closePopup",this.closePopupHandler)};var A=function e(i){babelHelpers.classPrivateFieldSet(this,b,BX("ui-editor-config-".concat(babelHelpers.classPrivateFieldGet(this,c))));if(i){babelHelpers.classPrivateFieldSet(this,d,i)}if(babelHelpers.classPrivateFieldGet(this,b)){while(babelHelpers.classPrivateFieldGet(this,b).firstChild){babelHelpers.classPrivateFieldGet(this,b).removeChild(babelHelpers.classPrivateFieldGet(this,b).firstChild)}l(this,m,w).call(this)}};r.Config=o;r.ConfigItem=P})(this.window=this.window||{},BX,BX.Event);
//# sourceMappingURL=script.map.js