{"version":3,"file":"main.core.minimal.bundle.js","sources":["../../src/internal/get-tag.js","../../src/lib/type.js","../../src/lib/reflection.js","../../src/lib/text.js","../../src/lib/event/aliases.js","../../src/lib/event/registry.js","../../src/lib/event/fetch-supported-listener-options.js","../../src/lib/event/bind.js","../../src/lib/event/unbind.js","../../src/lib/event/unbind-all.js","../../src/lib/event/bind-once.js","../../src/lib/runtime/debug.js","../../src/lib/runtime/loadextension/load.extension.entity.js","../../src/lib/runtime/loadextension/lib/load.extension.constants.js","../../src/lib/runtime/loadextension/lib/load.extension.utils.js","../../src/lib/runtime/loadextension/load.extension.js","../../src/lib/runtime/clone.js","../../src/lib/runtime/merge.js","../../src/lib/runtime/create-comparator.js","../../src/lib/runtime.js","../../src/lib/base-error.js","../../src/lib/event/base-event.js","../../src/lib/event/event-emitter/eventstore.js","../../src/lib/event/event-emitter/warningstore.js","../../src/lib/event/event-emitter.js","../../src/lib/event/ready.js","../../src/lib/event.js","../../src/internal/encode-attribute-value.js","../../src/internal/decode-attribute-value.js","../../src/internal/get-page-scroll.js","../../src/lib/dom.js","../../src/lib/browser.js","../../src/lib/http/cookie.js","../../src/lib/http/internal/convert-object-to-form-data.js","../../src/lib/http/data.js","../../src/lib/http.js","../../src/lib/loc/message.js","../../src/lib/loc.js","../../src/lib/tag/render.js","../../src/lib/tag.js","../../src/lib/uri/parse-url.js","../../src/lib/uri/build-query-string.js","../../src/lib/uri/prepare-param-value.js","../../src/lib/uri.js","../../src/lib/validation.js","../../src/lib/cache/base-cache.js","../../src/lib/cache/memory-cache.js","../../src/lib/cache/storage/ls-storage.js","../../src/lib/cache/local-storage-cache.js","../../src/lib/cache.js","../../src/internal/get-element.js","../../src/internal/get-window.js","../../src/core-compatibility.js","../src/main.core.minimal.js"],"sourcesContent":["/**\n * Gets object.toString result\n * @param value\n * @return {string}\n */\nexport default function getTag(value: any)\n{\n\treturn Object.prototype.toString.call(value);\n}","import getTag from '../internal/get-tag';\n\nconst objectCtorString = Function.prototype.toString.call(Object);\n\n/**\n * @memberOf BX\n */\nexport default class Type\n{\n\t/**\n\t * Checks that value is string\n\t * @param value\n\t * @return {boolean}\n\t */\n\tstatic isString(value: any): boolean\n\t{\n\t\treturn typeof value === 'string';\n\t}\n\n\t/**\n\t * Returns true if a value is not empty string\n\t * @param value\n\t * @returns {boolean}\n\t */\n\tstatic isStringFilled(value: any): boolean\n\t{\n\t\treturn this.isString(value) && value !== '';\n\t}\n\n\t/**\n\t * Checks that value is function\n\t * @param value\n\t * @return {boolean}\n\t */\n\tstatic isFunction(value: any): boolean\n\t{\n\t\treturn typeof value === 'function';\n\t}\n\n\t/**\n\t * Checks that value is object\n\t * @param value\n\t * @return {boolean}\n\t */\n\tstatic isObject(value: any): boolean\n\t{\n\t\treturn !!value && (typeof value === 'object' || typeof value === 'function');\n\t}\n\n\t/**\n\t * Checks that value is object like\n\t * @param value\n\t * @return {boolean}\n\t */\n\tstatic isObjectLike(value: any): boolean\n\t{\n\t\treturn !!value && typeof value === 'object';\n\t}\n\n\t/**\n\t * Checks that value is plain object\n\t * @param value\n\t * @return {boolean}\n\t */\n\tstatic isPlainObject(value: any): boolean\n\t{\n\t\tif (!Type.isObjectLike(value) || getTag(value) !== '[object Object]')\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst proto = Object.getPrototypeOf(value);\n\t\tif (proto === null)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tconst ctor = proto.hasOwnProperty('constructor') && proto.constructor;\n\n\t\treturn (\n\t\t\ttypeof ctor === 'function' &&\n\t\t\tFunction.prototype.toString.call(ctor) === objectCtorString\n\t\t);\n\t}\n\n\t/**\n\t * Checks that value is boolean\n\t * @param value\n\t * @return {boolean}\n\t */\n\tstatic isBoolean(value: any): boolean\n\t{\n\t\treturn value === true || value === false;\n\t}\n\n\t/**\n\t * Checks that value is number\n\t * @param value\n\t * @return {boolean}\n\t */\n\tstatic isNumber(value: any): boolean\n\t{\n\t\treturn !Number.isNaN(value) && typeof value === 'number';\n\t}\n\n\t/**\n\t * Checks that value is integer\n\t * @param value\n\t * @return {boolean}\n\t */\n\tstatic isInteger(value: any): boolean\n\t{\n\t\treturn Type.isNumber(value) && (value % 1) === 0;\n\t}\n\n\t/**\n\t * Checks that value is float\n\t * @param value\n\t * @return {boolean}\n\t */\n\tstatic isFloat(value: any): boolean\n\t{\n\t\treturn Type.isNumber(value) && !Type.isInteger(value);\n\t}\n\n\t/**\n\t * Checks that value is nil\n\t * @param value\n\t * @return {boolean}\n\t */\n\tstatic isNil(value: any): boolean\n\t{\n\t\treturn value === null || value === undefined;\n\t}\n\n\t/**\n\t * Checks that value is array\n\t * @param value\n\t * @return {boolean}\n\t */\n\tstatic isArray(value: any): boolean\n\t{\n\t\treturn !Type.isNil(value) && Array.isArray(value);\n\t}\n\n\t/**\n\t * Returns true if a value is an array and it has at least one element\n\t * @param value\n\t * @returns {boolean}\n\t */\n\tstatic isArrayFilled(value: any): boolean\n\t{\n\t\treturn this.isArray(value) && value.length > 0;\n\t}\n\n\t/**\n\t * Checks that value is array like\n\t * @param value\n\t * @return {boolean}\n\t */\n\tstatic isArrayLike(value: any): boolean\n\t{\n\t\treturn (\n\t\t\t!Type.isNil(value)\n\t\t\t&& !Type.isFunction(value)\n\t\t\t&& value.length > -1\n\t\t\t&& value.length <= Number.MAX_SAFE_INTEGER\n\t\t);\n\t}\n\n\t/**\n\t * Checks that value is Date\n\t * @param value\n\t * @return {boolean}\n\t */\n\tstatic isDate(value: any): boolean\n\t{\n\t\treturn Type.isObjectLike(value) && getTag(value) === '[object Date]';\n\t}\n\n\t/**\n\t * Checks that is DOM node\n\t * @param value\n\t * @return {boolean}\n\t */\n\tstatic isDomNode(value: any): boolean\n\t{\n\t\treturn Type.isObjectLike(value) && !Type.isPlainObject(value) && 'nodeType' in value;\n\t}\n\n\t/**\n\t * Checks that value is element node\n\t * @param value\n\t * @return {boolean}\n\t */\n\tstatic isElementNode(value: any): boolean\n\t{\n\t\treturn Type.isDomNode(value) && value.nodeType === Node.ELEMENT_NODE;\n\t}\n\n\t/**\n\t * Checks that value is text node\n\t * @param value\n\t * @return {boolean}\n\t */\n\tstatic isTextNode(value: any): boolean\n\t{\n\t\treturn Type.isDomNode(value) && value.nodeType === Node.TEXT_NODE;\n\t}\n\n\t/**\n\t * Checks that value is Map\n\t * @param value\n\t * @return {boolean}\n\t */\n\tstatic isMap(value: any): boolean\n\t{\n\t\treturn Type.isObjectLike(value) && getTag(value) === '[object Map]';\n\t}\n\n\t/**\n\t * Checks that value is Set\n\t * @param value\n\t * @return {boolean}\n\t */\n\tstatic isSet(value: any): boolean\n\t{\n\t\treturn Type.isObjectLike(value) && getTag(value) === '[object Set]';\n\t}\n\n\t/**\n\t * Checks that value is WeakMap\n\t * @param value\n\t * @return {boolean}\n\t */\n\tstatic isWeakMap(value: any): boolean\n\t{\n\t\treturn Type.isObjectLike(value) && getTag(value) === '[object WeakMap]';\n\t}\n\n\t/**\n\t * Checks that value is WeakSet\n\t * @param value\n\t * @return {boolean}\n\t */\n\tstatic isWeakSet(value: any): boolean\n\t{\n\t\treturn Type.isObjectLike(value) && getTag(value) === '[object WeakSet]';\n\t}\n\n\t/**\n\t * Checks that value is prototype\n\t * @param value\n\t * @return {boolean}\n\t */\n\tstatic isPrototype(value: any): boolean\n\t{\n\t\treturn (\n\t\t\t(((typeof (value && value.constructor) === 'function') && value.constructor.prototype) || Object.prototype) === value\n\t\t);\n\t}\n\n\t/**\n\t * Checks that value is regexp\n\t * @param value\n\t * @return {boolean}\n\t */\n\tstatic isRegExp(value: any): boolean\n\t{\n\t\treturn Type.isObjectLike(value) && getTag(value) === '[object RegExp]';\n\t}\n\n\t/**\n\t * Checks that value is null\n\t * @param value\n\t * @return {boolean}\n\t */\n\tstatic isNull(value: any): boolean\n\t{\n\t\treturn value === null;\n\t}\n\n\t/**\n\t * Checks that value is undefined\n\t * @param value\n\t * @return {boolean}\n\t */\n\tstatic isUndefined(value: any): boolean\n\t{\n\t\treturn typeof value === 'undefined';\n\t}\n\n\t/**\n\t * Checks that value is ArrayBuffer\n\t * @param value\n\t * @return {boolean}\n\t */\n\tstatic isArrayBuffer(value: any): boolean\n\t{\n\t\treturn Type.isObjectLike(value) && getTag(value) === '[object ArrayBuffer]';\n\t}\n\n\t/**\n\t * Checks that value is typed array\n\t * @param value\n\t * @return {boolean}\n\t */\n\tstatic isTypedArray(value: any): boolean\n\t{\n\t\tconst regExpTypedTag = (\n\t\t\t/^\\[object (?:Float(?:32|64)|(?:Int|Uint)(?:8|16|32)|Uint8Clamped)]$/\n\t\t);\n\t\treturn Type.isObjectLike(value) && regExpTypedTag.test(getTag(value));\n\t}\n\n\t/**\n\t * Checks that value is Blob\n\t * @param value\n\t * @return {boolean}\n\t */\n\tstatic isBlob(value: any): boolean\n\t{\n\t\treturn (\n\t\t\tType.isObjectLike(value)\n\t\t\t&& Type.isNumber(value.size)\n\t\t\t&& Type.isString(value.type)\n\t\t\t&& Type.isFunction(value.slice)\n\t\t);\n\t}\n\n\t/**\n\t * Checks that value is File\n\t * @param value\n\t * @return {boolean}\n\t */\n\tstatic isFile(value: any): boolean\n\t{\n\t\treturn (\n\t\t\tType.isBlob(value)\n\t\t\t&& Type.isObjectLike(value.lastModifiedDate)\n\t\t\t&& Type.isNumber(value.lastModified)\n\t\t\t&& Type.isString(value.name)\n\t\t);\n\t}\n\n\t/**\n\t * Checks that value is FormData\n\t * @param value\n\t * @return {boolean}\n\t */\n\tstatic isFormData(value: any)\n\t{\n\t\treturn value instanceof FormData;\n\t}\n}","import Type from './type';\n\n/**\n * @memberOf BX\n */\nexport default class Reflection\n{\n\t/**\n\t * Gets link to function by function name\n\t * @param className\n\t * @return {?Function}\n\t */\n\tstatic getClass(className: string | Function): Function | null\n\t{\n\t\tif (Type.isString(className) && !!className)\n\t\t{\n\t\t\tlet classFn = null;\n\t\t\tlet currentNamespace = window;\n\t\t\tconst namespaces = className.split('.');\n\n\t\t\tfor (let i = 0; i < namespaces.length; i += 1)\n\t\t\t{\n\t\t\t\tconst namespace = namespaces[i];\n\n\t\t\t\tif (!currentNamespace[namespace])\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\tcurrentNamespace = currentNamespace[namespace];\n\t\t\t\tclassFn = currentNamespace;\n\t\t\t}\n\n\t\t\treturn classFn;\n\t\t}\n\n\t\tif (Type.isFunction(className))\n\t\t{\n\t\t\treturn className;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\t/**\n\t * Creates a namespace or returns a link to a previously created one\n\t * @param {String} namespaceName\n\t * @return {Object<string, any> | Function | null}\n\t */\n\tstatic namespace(namespaceName: string): {[key: string]: any} | Function\n\t{\n\t\tlet parts = namespaceName.split('.');\n\t\tlet parent = window.BX;\n\n\t\tif (parts[0] === 'BX')\n\t\t{\n\t\t\tparts = parts.slice(1);\n\t\t}\n\n\t\tfor (let i = 0; i < parts.length; i += 1)\n\t\t{\n\t\t\tif (Type.isUndefined(parent[parts[i]]))\n\t\t\t{\n\t\t\t\tparent[parts[i]] = {};\n\t\t\t}\n\n\t\t\tparent = parent[parts[i]];\n\t\t}\n\n\t\treturn parent;\n\t}\n}","import Type from './type';\n\nconst reEscape = /[&<>'\"]/g;\nconst reUnescape = /&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34);/g;\n\nconst escapeEntities = {\n\t'&': '&amp;',\n\t'<': '&lt;',\n\t'>': '&gt;',\n\t\"'\": '&#39;',\n\t'\"': '&quot;',\n};\n\nconst unescapeEntities = {\n\t'&amp;': '&',\n\t'&#38;': '&',\n\t'&lt;': '<',\n\t'&#60;': '<',\n\t'&gt;': '>',\n\t'&#62;': '>',\n\t'&apos;': \"'\",\n\t'&#39;': \"'\",\n\t'&quot;': '\"',\n\t'&#34;': '\"',\n};\n\n/**\n * @memberOf BX\n */\nexport default class Text\n{\n\t/**\n\t * Encodes all unsafe entities\n\t * @param {string} value\n\t * @return {string}\n\t */\n\tstatic encode(value: string): string\n\t{\n\t\tif (Type.isString(value))\n\t\t{\n\t\t\treturn value.replace(reEscape, item => escapeEntities[item]);\n\t\t}\n\n\t\treturn value;\n\t}\n\n\t/**\n\t * Decodes all encoded entities\n\t * @param {string} value\n\t * @return {string}\n\t */\n\tstatic decode(value: string): string\n\t{\n\t\tif (Type.isString(value))\n\t\t{\n\t\t\treturn value.replace(reUnescape, item => unescapeEntities[item]);\n\t\t}\n\n\t\treturn value;\n\t}\n\n\tstatic getRandom(length = 8)\n\t{\n\t\t// eslint-disable-next-line\n\t\treturn [...Array(length)].map(() => (~~(Math.random() * 36)).toString(36)).join('');\n\t}\n\n\tstatic toNumber(value: any): number\n\t{\n\t\tconst parsedValue = Number.parseFloat(value);\n\n\t\tif (Type.isNumber(parsedValue))\n\t\t{\n\t\t\treturn parsedValue;\n\t\t}\n\n\t\treturn 0;\n\t}\n\n\tstatic toInteger(value: any): number\n\t{\n\t\treturn Text.toNumber(Number.parseInt(value, 10));\n\t}\n\n\tstatic toBoolean(value: any, trueValues = []): boolean\n\t{\n\t\tconst transformedValue = Type.isString(value) ? value.toLowerCase() : value;\n\t\treturn ['true', 'y', '1', 1, true, ...trueValues].includes(transformedValue);\n\t}\n\n\tstatic toCamelCase(str: string)\n\t{\n\t\tif (!Type.isStringFilled(str))\n\t\t{\n\t\t\treturn str;\n\t\t}\n\n\t\tconst regex = /[-_\\s]+(.)?/g;\n\t\tif (!regex.test(str))\n\t\t{\n\t\t\treturn str.match(/^[A-Z]+$/) ? str.toLowerCase() : str[0].toLowerCase() + str.slice(1);\n\t\t}\n\n\t\tstr = str.toLowerCase();\n\t\tstr = str.replace(regex, function(match, letter) {\n\t\t\treturn letter ? letter.toUpperCase() : '';\n\t\t});\n\n\t\treturn str[0].toLowerCase() + str.substr(1);\n\t}\n\n\tstatic toPascalCase(str: string)\n\t{\n\t\tif (!Type.isStringFilled(str))\n\t\t{\n\t\t\treturn str;\n\t\t}\n\n\t\treturn this.capitalize(this.toCamelCase(str));\n\t}\n\n\tstatic toKebabCase(str: string)\n\t{\n\t\tif (!Type.isStringFilled(str))\n\t\t{\n\t\t\treturn str;\n\t\t}\n\n\t\tconst matches = str.match(/[A-Z]{2,}(?=[A-Z][a-z]+[0-9]*|\\b)|[A-Z]?[a-z]+[0-9]*|[A-Z]|[0-9]+/g);\n\t\tif (!matches)\n\t\t{\n\t\t\treturn str;\n\t\t}\n\n\t\treturn matches.map(x => x.toLowerCase()).join('-');\n\t}\n\n\tstatic capitalize(str: string)\n\t{\n\t\tif (!Type.isStringFilled(str))\n\t\t{\n\t\t\treturn str;\n\t\t}\n\n\t\treturn str[0].toUpperCase() + str.substr(1);\n\t}\n}","const aliases = {\n\tmousewheel: [\n\t\t'DOMMouseScroll',\n\t],\n\tbxchange: [\n\t\t'change',\n\t\t'cut',\n\t\t'paste',\n\t\t'drop',\n\t\t'keyup',\n\t],\n\tanimationend: [\n\t\t'animationend',\n\t\t'oAnimationEnd',\n\t\t'webkitAnimationEnd',\n\t\t'MSAnimationEnd',\n\t],\n\ttransitionend: [\n\t\t'webkitTransitionEnd',\n\t\t'otransitionend',\n\t\t'oTransitionEnd',\n\t\t'msTransitionEnd',\n\t\t'transitionend',\n\t],\n\tfullscreenchange: [\n\t\t'fullscreenchange',\n\t\t'webkitfullscreenchange',\n\t\t'mozfullscreenchange',\n\t\t'MSFullscreenChange',\n\t],\n\tfullscreenerror: [\n\t\t'fullscreenerror',\n\t\t'webkitfullscreenerror',\n\t\t'mozfullscreenerror',\n\t\t'MSFullscreenError',\n\t],\n};\n\nexport default aliases;","import Type from '../type';\n\nexport class Registry\n{\n\tregistry: WeakMap = new WeakMap();\n\n\tset(target: Element, event: string, listener: Function)\n\t{\n\t\tconst events = this.get(target);\n\n\t\tif (!Type.isSet(events[event]))\n\t\t{\n\t\t\tevents[event] = new Set();\n\t\t}\n\n\t\tevents[event].add(listener);\n\n\t\tthis.registry.set(target, events);\n\t}\n\n\tget(target: Element): {[event: string]: Set<Function>}\n\t{\n\t\treturn this.registry.get(target) || {};\n\t}\n\n\thas(target: Element, event?: string, listener?: Function): boolean\n\t{\n\t\tif (event && listener)\n\t\t{\n\t\t\treturn (\n\t\t\t\tthis.registry.has(target)\n\t\t\t\t&& this.registry.get(target)[event].has(listener)\n\t\t\t);\n\t\t}\n\n\t\treturn this.registry.has(target);\n\t}\n\n\tdelete(target: Element, event?: string, listener?: Function)\n\t{\n\t\tif (!Type.isDomNode(target))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (Type.isString(event) && Type.isFunction(listener))\n\t\t{\n\t\t\tconst events = this.registry.get(target);\n\n\t\t\tif (Type.isPlainObject(events) && Type.isSet(events[event]))\n\t\t\t{\n\t\t\t\tevents[event].delete(listener);\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (Type.isString(event))\n\t\t{\n\t\t\tconst events = this.registry.get(target);\n\n\t\t\tif (Type.isPlainObject(events) && Type.isSet(events[event]))\n\t\t\t{\n\t\t\t\tevents[event] = new Set();\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.registry.delete(target);\n\t}\n}\n\nexport default new Registry();","import Type from '../type';\n\nfunction isOptionSupported(name)\n{\n\tlet isSupported = false;\n\n\ttry {\n\t\tconst options = Object.defineProperty({}, name, {\n\t\t\tget() {\n\t\t\t\tisSupported = true;\n\t\t\t\treturn undefined;\n\t\t\t},\n\t\t});\n\n\t\twindow.addEventListener('test', null, options);\n\t}\n\t// eslint-disable-next-line\n\tcatch (err) {}\n\n\treturn isSupported;\n}\n\nexport default function fetchSupportedListenerOptions(\n\toptions?: T<{\n\t\tcapture?: boolean,\n\t\tonce?: boolean,\n\t\tpassive?: boolean,\n\t}>,\n): ?T\n{\n\tif (!Type.isPlainObject(options))\n\t{\n\t\treturn options;\n\t}\n\n\treturn Object\n\t\t.keys(options)\n\t\t.reduce((acc, name) => {\n\t\t\tif (isOptionSupported(name))\n\t\t\t{\n\t\t\t\tacc[name] = options[name];\n\t\t\t}\n\n\t\t\treturn acc;\n\t\t}, {});\n}","import Type from '../type';\nimport aliases from './aliases';\nimport registry from './registry';\nimport fetchSupportedListenerOptions from './fetch-supported-listener-options';\n\nexport default function bind(\n\ttarget: Element,\n\teventName: string,\n\thandler: (event: Event) => void,\n\toptions?: {\n\t\tcapture?: boolean,\n\t\tonce?: boolean,\n\t\tpassive?: boolean,\n\t},\n): void\n{\n\tif (\n\t\t!Type.isObject(target)\n\t\t|| !Type.isFunction(target.addEventListener)\n\t)\n\t{\n\t\treturn;\n\t}\n\n\tconst listenerOptions = fetchSupportedListenerOptions(options);\n\n\tif (eventName in aliases)\n\t{\n\t\taliases[eventName].forEach((key) => {\n\t\t\ttarget.addEventListener(key, handler, listenerOptions);\n\t\t\tregistry.set(target, eventName, handler);\n\t\t});\n\n\t\treturn;\n\t}\n\n\ttarget.addEventListener(eventName, handler, listenerOptions);\n\tregistry.set(target, eventName, handler);\n}","import Type from '../type';\nimport aliases from './aliases';\nimport registry from './registry';\nimport fetchSupportedListenerOptions from './fetch-supported-listener-options';\n\nexport default function unbind(\n\ttarget: Element,\n\teventName: string,\n\thandler: Function,\n\toptions?: {\n\t\tcapture?: boolean,\n\t\tonce?: boolean,\n\t\tpassive?: boolean,\n\t},\n): void\n{\n\tif (\n\t\t!Type.isObject(target)\n\t\t|| !Type.isFunction(target.removeEventListener)\n\t)\n\t{\n\t\treturn;\n\t}\n\n\tconst listenerOptions = fetchSupportedListenerOptions(options);\n\n\tif (eventName in aliases)\n\t{\n\t\taliases[eventName].forEach((key) => {\n\t\t\ttarget.removeEventListener(key, handler, listenerOptions);\n\t\t\tregistry.delete(target, key, handler);\n\t\t});\n\n\t\treturn;\n\t}\n\n\ttarget.removeEventListener(eventName, handler, listenerOptions);\n\tregistry.delete(target, eventName, handler);\n}","import Type from '../type';\nimport unbind from './unbind';\nimport registry from './registry';\n\nexport default function unbindAll(target: any, eventName?: string): void\n{\n\tconst events = registry.get(target);\n\n\tObject.keys(events).forEach((currentEvent) => {\n\t\tevents[currentEvent].forEach((handler) => {\n\t\t\tif (!Type.isString(eventName) || eventName === currentEvent)\n\t\t\t{\n\t\t\t\tunbind(target, currentEvent, handler);\n\t\t\t}\n\t\t});\n\t});\n}","import bind from './bind';\nimport unbind from './unbind';\n\nexport default function bindOnce(\n\ttarget: Element,\n\teventName: string,\n\thandler: (event: Event) => void,\n\toptions?: {\n\t\tcapture?: boolean,\n\t\tonce?: boolean,\n\t\tpassive?: boolean,\n\t},\n): void\n{\n\tconst once = function once(...args) {\n\t\tunbind(target, eventName, once, options);\n\t\thandler(...args);\n\t};\n\n\tbind(target, eventName, once, options);\n}","import Type from '../type';\n\n// eslint-disable-next-line\nexport let debugState = true;\n\nexport function enableDebug()\n{\n\tdebugState = true;\n}\n\nexport function disableDebug()\n{\n\tdebugState = false;\n}\n\nexport function isDebugEnabled()\n{\n\treturn debugState;\n}\n\nexport default function debug(...args: any)\n{\n\tif (\n\t\tisDebugEnabled()\n\t\t&& Type.isObject(window.console)\n\t)\n\t{\n\t\tif (Type.isFunction(window.console.log))\n\t\t{\n\t\t\twindow.console.log('BX.debug: ', args.length > 0 ? args : args[0]);\n\n\t\t\tif (args[0] instanceof Error && args[0].stack)\n\t\t\t{\n\t\t\t\twindow.console.log('BX.debug error stack trace', args[0].stack);\n\t\t\t}\n\t\t}\n\n\t\tif (Type.isFunction(window.console.trace))\n\t\t{\n\t\t\t// eslint-disable-next-line\n\t\t\tconsole.trace();\n\t\t}\n\t}\n}","import type {ExtensionOptions, State} from './type/load.extension.types';\n\nimport {\n\tloadAll,\n\tinlineScripts,\n\texternalStyles,\n\texternalScripts,\n} from './lib/load.extension.utils';\n\nimport Type from '../../type';\nimport Reflection from '../../reflection';\n\nexport default class Extension\n{\n\tname: string;\n\tstate: State;\n\tinlineScripts: Array<string>;\n\texternalScripts: Array<string>;\n\texternalStyles: Array<string>;\n\tloadPromise: Promise<Extension>;\n\tconfig: {[key: string]: string};\n\n\tconstructor(options: ExtensionOptions)\n\t{\n\t\tthis.config = options.config || {};\n\t\tthis.name = options.extension;\n\t\tthis.state = 'scheduled';\n\n\t\t// eslint-disable-next-line\n\t\tconst result = BX.processHTML(options.html || '');\n\t\tthis.inlineScripts = result.SCRIPT.reduce(inlineScripts, []);\n\t\tthis.externalScripts = result.SCRIPT.reduce(externalScripts, []);\n\t\tthis.externalStyles = result.STYLE.reduce(externalStyles, []);\n\t}\n\n\tload(): Promise<Extension>\n\t{\n\t\tif (this.state === 'error')\n\t\t{\n\t\t\tthis.loadPromise = this.loadPromise || Promise.resolve(this);\n\t\t\tconsole.warn('Extension', this.name, 'not found');\n\t\t}\n\n\t\tif (!this.loadPromise && this.state)\n\t\t{\n\t\t\tthis.state = 'load';\n\t\t\t// eslint-disable-next-line\n\t\t\tthis.inlineScripts.forEach(BX.evalGlobal);\n\n\t\t\tthis.loadPromise = Promise\n\t\t\t\t.all([\n\t\t\t\t\tloadAll(this.externalScripts),\n\t\t\t\t\tloadAll(this.externalStyles),\n\t\t\t\t])\n\t\t\t\t.then(() => {\n\t\t\t\t\tthis.state = 'loaded';\n\n\t\t\t\t\tif (Type.isPlainObject(this.config) && this.config.namespace)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn Reflection.getClass(this.config.namespace);\n\t\t\t\t\t}\n\n\t\t\t\t\treturn window;\n\t\t\t\t});\n\t\t}\n\n\t\treturn this.loadPromise;\n\t}\n}","import type Extension from '../load.extension.entity';\n\nexport const initialized: {[name: string]: Extension} = {};\nexport const ajaxController: string = 'main.bitrix.main.controller.loadext.getextensions';\nexport const Status: {[key: string]: string} = {\n\tSCHEDULED: 'scheduled',\n\tLOAD: 'load',\n\tLOADED: 'loaded',\n\tERROR: 'error',\n};","import Type from '../../../type';\n\nimport Extension from '../load.extension.entity';\nimport {initialized, ajaxController} from './load.extension.constants';\nimport type {JsItem, Response} from '../type/load.extension.types';\n\nexport function makeIterable(value: any): Array<any>\n{\n\treturn Type.isArray(value) ? value : [value];\n}\n\nexport function isInitialized(extension: string): boolean\n{\n\treturn extension in initialized;\n}\n\nexport function getInitialized(extension: string): Extension\n{\n\treturn initialized[extension];\n}\n\nexport function isAllInitialized(extensions: Array<string>): boolean\n{\n\treturn extensions.every(isInitialized);\n}\n\nexport function loadExtensions(extensions: Array<Extension>): Promise<Array<Extension>>\n{\n\treturn Promise.all(extensions.map(item => item.load()));\n}\n\nexport function mergeExports(exports: Array<Object>): {[key: string]: any}\n{\n\treturn exports.reduce((acc, currentExports) => {\n\t\tif (Type.isObject(currentExports))\n\t\t{\n\t\t\treturn {...currentExports};\n\t\t}\n\n\t\treturn currentExports;\n\t}, {});\n}\n\nexport function inlineScripts(acc: Array<string>, item: JsItem)\n{\n\tif (item.isInternal)\n\t{\n\t\tacc.push(item.JS);\n\t}\n\n\treturn acc;\n}\n\nexport function externalScripts(acc: Array<string>, item: JsItem)\n{\n\tif (!item.isInternal)\n\t{\n\t\tacc.push(item.JS);\n\t}\n\n\treturn acc;\n}\n\nexport function externalStyles(acc: Array<string>, item: ?string)\n{\n\tif (Type.isString(item) && item !== '')\n\t{\n\t\tacc.push(item);\n\t}\n\n\treturn acc;\n}\n\nexport function request(options: {extension: Array<string>}): Promise<any>\n{\n\treturn new Promise((resolve) => {\n\t\t// eslint-disable-next-line\n\t\tBX.ajax.runAction(ajaxController, {data: options}).then(resolve);\n\t});\n}\n\nexport function prepareExtensions(response: Response)\n{\n\tif (response.status !== 'success')\n\t{\n\t\tresponse.errors.map(console.warn);\n\t\treturn [];\n\t}\n\n\treturn response.data.map((item) => {\n\t\tconst initializedExtension = (\n\t\t\tgetInitialized(item.extension)\n\t\t);\n\n\t\tif (initializedExtension)\n\t\t{\n\t\t\treturn initializedExtension;\n\t\t}\n\n\t\tinitialized[item.extension] = new Extension(item);\n\n\t\treturn initialized[item.extension];\n\t});\n}\n\nexport function loadAll(items: Array<string>): Promise<void>\n{\n\tconst itemsList = makeIterable(items);\n\n\tif (!itemsList.length)\n\t{\n\t\treturn Promise.resolve();\n\t}\n\n\treturn new Promise((resolve) => {\n\t\t// eslint-disable-next-line\n\t\tBX.load(itemsList, resolve);\n\t});\n}","import * as utils from './lib/load.extension.utils';\nimport type Extension from './load.extension.entity';\n\ntype names = string | Array<string>;\ntype result = Promise<Array<Extension>>;\n\n/**\n * Loads extensions asynchronously\n * @param {string|Array<string>} extension\n * @return {Promise<Array<Extension>>}\n */\nexport default function loadExtension(extension: names): result\n{\n\tconst extensions = utils.makeIterable(extension);\n\tconst isAllInitialized = utils.isAllInitialized(extensions);\n\n\tif (isAllInitialized)\n\t{\n\t\tconst initializedExtensions = extensions.map(utils.getInitialized);\n\t\treturn utils.loadExtensions(initializedExtensions)\n\t\t\t.then(utils.mergeExports);\n\t}\n\n\treturn utils.request({extension: extensions})\n\t\t.then(utils.prepareExtensions)\n\t\t.then(utils.loadExtensions)\n\t\t.then(utils.mergeExports);\n}","import Type from '../type';\nimport getTag from '../../internal/get-tag';\n\nconst cloneableTags = [\n\t'[object Object]',\n\t'[object Array]',\n\t'[object RegExp]',\n\t'[object Arguments]',\n\t'[object Date]',\n\t'[object Error]',\n\t'[object Map]',\n\t'[object Set]',\n\t'[object ArrayBuffer]',\n\t'[object DataView]',\n\t'[object Float32Array]',\n\t'[object Float64Array]',\n\t'[object Int8Array]',\n\t'[object Int16Array]',\n\t'[object Int32Array]',\n\t'[object Uint8Array]',\n\t'[object Uint16Array]',\n\t'[object Uint32Array]',\n\t'[object Uint8ClampedArray]',\n];\n\nfunction isCloneable(value: any): boolean %checks\n{\n\tconst isCloneableValue = Type.isObjectLike(value)\n\t\t&& cloneableTags.includes(getTag(value));\n\n\treturn isCloneableValue || Type.isDomNode(value);\n}\n\nexport function internalClone(value: any, map: WeakMap<any, any>): any\n{\n\tif (map.has(value))\n\t{\n\t\treturn map.get(value);\n\t}\n\n\tif (isCloneable(value))\n\t{\n\t\tif (Type.isArray(value))\n\t\t{\n\t\t\tconst cloned = Array.from(value);\n\n\t\t\tmap.set(value, cloned);\n\n\t\t\tvalue.forEach((item, index) => {\n\t\t\t\tcloned[index] = internalClone(item, map);\n\t\t\t});\n\n\t\t\treturn map.get(value);\n\t\t}\n\n\t\tif (Type.isDomNode(value))\n\t\t{\n\t\t\treturn value.cloneNode(true);\n\t\t}\n\n\t\tif (Type.isMap(value))\n\t\t{\n\t\t\tconst result = new Map();\n\n\t\t\tmap.set(value, result);\n\n\t\t\tvalue.forEach((item, key) => {\n\t\t\t\tresult.set(\n\t\t\t\t\tinternalClone(key, map),\n\t\t\t\t\tinternalClone(item, map)\n\t\t\t\t);\n\t\t\t});\n\n\t\t\treturn result;\n\t\t}\n\n\t\tif (Type.isSet(value))\n\t\t{\n\t\t\tconst result = new Set();\n\n\t\t\tmap.set(value, result);\n\n\t\t\tvalue.forEach((item) => {\n\t\t\t\tresult.add(internalClone(item, map));\n\t\t\t});\n\n\t\t\treturn result;\n\t\t}\n\n\t\tif (Type.isDate(value))\n\t\t{\n\t\t\treturn new Date(value);\n\t\t}\n\n\t\tif (Type.isRegExp(value))\n\t\t{\n\t\t\tconst regExpFlags = /\\w*$/;\n\t\t\tconst flags = regExpFlags.exec(value);\n\n\t\t\tlet result = new RegExp(value.source);\n\n\t\t\tif (flags && Type.isArray(flags))\n\t\t\t{\n\t\t\t\tresult = new RegExp(value.source, flags[0]);\n\t\t\t}\n\n\t\t\tresult.lastIndex = value.lastIndex;\n\n\t\t\treturn result;\n\t\t}\n\n\t\tconst proto = Object.getPrototypeOf(value);\n\t\tconst result = Object.assign(Object.create(proto), value);\n\n\t\tmap.set(value, result);\n\n\t\tObject.keys(value).forEach((key) => {\n\t\t\tresult[key] = internalClone(value[key], map);\n\t\t});\n\n\t\treturn result;\n\t}\n\n\treturn value;\n}\n\n/**\n * Clones any cloneable object\n * @param value\n * @return {*}\n */\nexport default function clone(value: any): any\n{\n\treturn internalClone(value, new WeakMap());\n}","import Type from '../type';\n\nexport default function merge(current, target)\n{\n\treturn Object.entries(target).reduce((acc, [key, value]) => {\n\t\tif (\n\t\t\t!Type.isDomNode(acc[key])\n\t\t\t&& Type.isObjectLike(acc[key])\n\t\t\t&& Type.isObjectLike(value)\n\t\t)\n\t\t{\n\t\t\tacc[key] = merge(acc[key], value);\n\t\t\treturn acc;\n\t\t}\n\n\t\tacc[key] = value;\n\t\treturn acc;\n\t}, current);\n}","import Type from '../type';\n\nexport default function createComparator(fields, orders = [])\n{\n\treturn (a, b) => {\n\t\tconst field = fields[0];\n\t\tconst order = orders[0] || 'asc';\n\n\t\tif (Type.isUndefined(field))\n\t\t{\n\t\t\treturn 0;\n\t\t}\n\n\t\tlet valueA = a[field];\n\t\tlet valueB = b[field];\n\n\t\tif (Type.isString(valueA) && Type.isString(valueB))\n\t\t{\n\t\t\tvalueA = valueA.toLowerCase();\n\t\t\tvalueB = valueB.toLowerCase();\n\t\t}\n\n\t\tif (valueA < valueB)\n\t\t{\n\t\t\treturn order === 'asc' ? -1 : 1;\n\t\t}\n\n\t\tif (valueA > valueB)\n\t\t{\n\t\t\treturn order === 'asc' ? 1 : -1;\n\t\t}\n\n\t\treturn createComparator(fields.slice(1), orders.slice(1))(a, b);\n\t};\n}","import Type from './type';\nimport debug from './runtime/debug';\nimport loadExtension from './runtime/loadextension/load.extension';\nimport clone from './runtime/clone';\nimport {\n\texternalScripts,\n\texternalStyles,\n\tinlineScripts,\n\tloadAll,\n} from './runtime/loadextension/lib/load.extension.utils';\nimport merge from './runtime/merge';\nimport createComparator from './runtime/create-comparator';\n\n/**\n * @memberOf BX\n */\nexport default class Runtime\n{\n\tstatic debug = debug;\n\tstatic loadExtension = loadExtension;\n\tstatic clone = clone;\n\n\tstatic debounce(func: Function, wait: number = 0, context = null): Function\n\t{\n\t\tlet timeoutId;\n\n\t\treturn function debounced(...args)\n\t\t{\n\t\t\tif (Type.isNumber(timeoutId))\n\t\t\t{\n\t\t\t\tclearTimeout(timeoutId);\n\t\t\t}\n\n\t\t\ttimeoutId = setTimeout(() => {\n\t\t\t\tfunc.apply((context || this), args);\n\t\t\t}, wait);\n\t\t};\n\t}\n\n\tstatic throttle(func: Function, wait: number = 0, context = null): Function\n\t{\n\t\tlet timer = 0;\n\t\tlet invoke;\n\n\t\treturn function wrapper(...args)\n\t\t{\n\t\t\tinvoke = true;\n\n\t\t\tif (!timer)\n\t\t\t{\n\t\t\t\tconst q = function q()\n\t\t\t\t{\n\t\t\t\t\tif (invoke)\n\t\t\t\t\t{\n\t\t\t\t\t\tfunc.apply((context || this), args);\n\t\t\t\t\t\tinvoke = false;\n\t\t\t\t\t\ttimer = setTimeout(q, wait);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\ttimer = null;\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\tq();\n\t\t\t}\n\t\t};\n\t}\n\n\tstatic html(node: HTMLElement, html, params = {}): Promise | string\n\t{\n\t\tif (Type.isNil(html) && Type.isDomNode(node))\n\t\t{\n\t\t\treturn node.innerHTML;\n\t\t}\n\n\t\t// eslint-disable-next-line\n\t\tconst parsedHtml = BX.processHTML(html);\n\t\tconst externalCss = parsedHtml.STYLE.reduce(externalStyles, []);\n\t\tconst externalJs = parsedHtml.SCRIPT.reduce(externalScripts, []);\n\t\tconst inlineJs = parsedHtml.SCRIPT.reduce(inlineScripts, []);\n\n\t\tif (Type.isDomNode(node))\n\t\t{\n\t\t\tif (params.htmlFirst || (!externalJs.length && !externalCss.length))\n\t\t\t{\n\t\t\t\tnode.innerHTML = parsedHtml.HTML;\n\t\t\t}\n\t\t}\n\n\t\treturn Promise\n\t\t\t.all([\n\t\t\t\tloadAll(externalJs),\n\t\t\t\tloadAll(externalCss),\n\t\t\t])\n\t\t\t.then(() => {\n\t\t\t\tif (Type.isDomNode(node) && (externalJs.length > 0 || externalCss.length > 0))\n\t\t\t\t{\n\t\t\t\t\tnode.innerHTML = parsedHtml.HTML;\n\t\t\t\t}\n\n\t\t\t\t// eslint-disable-next-line\n\t\t\t\tinlineJs.forEach(script => BX.evalGlobal(script));\n\n\t\t\t\tif (Type.isFunction(params.callback))\n\t\t\t\t{\n\t\t\t\t\tparams.callback();\n\t\t\t\t}\n\t\t\t});\n\t}\n\n\t/**\n\t * Merges objects or arrays\n\t * @param targets\n\t * @return {any}\n\t */\n\tstatic merge(...targets)\n\t{\n\t\tif (Type.isArray(targets[0]))\n\t\t{\n\t\t\ttargets.unshift([]);\n\t\t}\n\t\telse if (Type.isObject(targets[0]))\n\t\t{\n\t\t\ttargets.unshift({});\n\t\t}\n\n\t\treturn targets.reduce((acc, item) => {\n\t\t\treturn merge(acc, item);\n\t\t}, targets[0]);\n\t}\n\n\tstatic orderBy(\n\t\tcollection: Array<{[key: string]: any}> | {[key: string]: {[key: string]: any}},\n\t\tfields: Array<string> = [],\n\t\torders: Array<string> = [],\n\t)\n\t{\n\t\tconst comparator = createComparator(fields, orders);\n\t\treturn Object.values(collection).sort(comparator);\n\t}\n}","import Type from './type';\n\nconst isError = Symbol.for('BX.BaseError.isError');\n\n/**\n * @memberOf BX\n */\nexport default class BaseError\n{\n\tconstructor(message?: string, code?: string, customData?: any)\n\t{\n\t\tthis[isError] = true;\n\t\tthis.message = '';\n\t\tthis.code = null;\n\t\tthis.customData = null;\n\n\t\tthis.setMessage(message);\n\t\tthis.setCode(code);\n\t\tthis.setCustomData(customData);\n\t}\n\n\t/**\n\t * Returns a brief description of the error\n\t * @returns {string}\n\t */\n\tgetMessage(): string\n\t{\n\t\treturn this.message;\n\t}\n\n\t/**\n\t * Sets a message of the error\n\t * @param {string} message\n\t * @returns {this}\n\t */\n\tsetMessage(message: string): this\n\t{\n\t\tif (Type.isString(message))\n\t\t{\n\t\t\tthis.message = message;\n\t\t}\n\n\t\treturn this;\n\t}\n\n\t/**\n\t * Returns a code of the error\n\t * @returns {?string}\n\t */\n\tgetCode(): string\n\t{\n\t\treturn this.code;\n\t}\n\n\t/**\n\t * Sets a code of the error\n\t * @param {string} code\n\t * @returns {this}\n\t */\n\tsetCode(code: string): this\n\t{\n\t\tif (Type.isStringFilled(code) || code === null)\n\t\t{\n\t\t\tthis.code = code;\n\t\t}\n\n\t\treturn this;\n\t}\n\n\n\t/**\n\t * Returns custom data of the error\n\t * @returns {null|*}\n\t */\n\tgetCustomData(): any\n\t{\n\t\treturn this.customData;\n\t}\n\n\t/**\n\t * Sets custom data of the error\n\t * @returns {this}\n\t */\n\tsetCustomData(customData: any): this\n\t{\n\t\tif (!Type.isUndefined(customData))\n\t\t{\n\t\t\tthis.customData = customData;\n\t\t}\n\n\t\treturn this;\n\t}\n\n\ttoString()\n\t{\n\t\tconst code = this.getCode();\n\t\tconst message = this.getMessage();\n\n\t\tif (!Type.isStringFilled(code) && !Type.isStringFilled(message))\n\t\t{\n\t\t\treturn '';\n\t\t}\n\t\telse if (!Type.isStringFilled(code))\n\t\t{\n\t\t\treturn `Error: ${message}`;\n\t\t}\n\t\telse if (!Type.isStringFilled(message))\n\t\t{\n\t\t\treturn code;\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn `${code}: ${message}`;\n\t\t}\n\t}\n\n\t/**\n\t * Returns true if the object is an instance of BaseError\n\t * @param error\n\t * @returns {boolean}\n\t */\n\tstatic isError(error: BaseError)\n\t{\n\t\treturn Type.isObject(error) && error[isError] === true;\n\t}\n}","import Type from '../type';\nimport BaseError from \"../base-error\";\n/**\n * Implements base event object interface\n */\nexport default class BaseEvent\n{\n\tconstructor(\n\t\toptions: {\n\t\t\tdata?: any,\n\t\t\tcompatData?: Array\n\t\t} = {\n\t\t\tdata: {},\n\t\t},\n\t)\n\t{\n\t\tthis.type = '';\n\t\tthis.data = null;\n\t\tthis.target = null;\n\t\tthis.compatData = null;\n\t\tthis.defaultPrevented = false;\n\t\tthis.immediatePropagationStopped = false;\n\t\tthis.errors = [];\n\n\t\tthis.setData(options.data);\n\t\tthis.setCompatData(options.compatData);\n\t}\n\n\tstatic create(options): this\n\t{\n\t\treturn new this(options);\n\t}\n\n\t/**\n\t * Returns the name of the event\n\t * @returns {string}\n\t */\n\tgetType(): string\n\t{\n\t\treturn this.type;\n\t}\n\n\t/**\n\t *\n\t * @param {string} type\n\t */\n\tsetType(type: string): this\n\t{\n\t\tif (Type.isStringFilled(type))\n\t\t{\n\t\t\tthis.type = type;\n\t\t}\n\n\t\treturn this;\n\t}\n\n\t/**\n\t * Returns an event data\n\t */\n\tgetData()\n\t{\n\t\treturn this.data;\n\t}\n\n\t/**\n\t * Sets an event data\n\t * @param data\n\t */\n\tsetData(data: any): this\n\t{\n\t\tif (!Type.isUndefined(data))\n\t\t{\n\t\t\tthis.data = data;\n\t\t}\n\n\t\treturn this;\n\t}\n\n\t/**\n\t * Returns arguments for BX.addCustomEvent handlers (deprecated).\n\t * @returns {array | null}\n\t */\n\tgetCompatData(): Array | null\n\t{\n\t\treturn this.compatData;\n\t}\n\n\t/**\n\t * Sets arguments for BX.addCustomEvent handlers (deprecated)\n\t * @param data\n\t */\n\tsetCompatData(data: Array): this\n\t{\n\t\tif (Type.isArrayLike(data))\n\t\t{\n\t\t\tthis.compatData = data;\n\t\t}\n\n\t\treturn this;\n\t}\n\n\t/**\n\t * Sets a event target\n\t * @param target\n\t */\n\tsetTarget(target): this\n\t{\n\t\tthis.target = target;\n\n\t\treturn this;\n\t}\n\n\t/**\n\t * Returns a event target\n\t */\n\tgetTarget(): any\n\t{\n\t\treturn this.target;\n\t}\n\n\t/**\n\t * Returns an array of event errors\n\t * @returns {[]}\n\t */\n\tgetErrors(): Array<BaseError>\n\t{\n\t\treturn this.errors;\n\t}\n\n\t/**\n\t * Adds an error of the event.\n\t * Event listeners can prevent emitter's default action and set the reason of this behavior.\n\t * @param error\n\t */\n\tsetError(error: BaseError)\n\t{\n\t\tif (BaseError.isError(error))\n\t\t{\n\t\t\tthis.errors.push(error);\n\t\t}\n\t}\n\n\t/**\n\t * Prevents default action\n\t */\n\tpreventDefault()\n\t{\n\t\tthis.defaultPrevented = true;\n\t}\n\n\t/**\n\t * Checks that is default action prevented\n\t * @return {boolean}\n\t */\n\tisDefaultPrevented(): boolean\n\t{\n\t\treturn this.defaultPrevented;\n\t}\n\n\t/**\n\t * Stops event immediate propagation\n\t */\n\tstopImmediatePropagation()\n\t{\n\t\tthis.immediatePropagationStopped = true;\n\t}\n\n\t/**\n\t * Checks that is immediate propagation stopped\n\t * @return {boolean}\n\t */\n\tisImmediatePropagationStopped(): boolean\n\t{\n\t\treturn this.immediatePropagationStopped;\n\t}\n}","import Type from \"../../type\";\n\nexport default class EventStore\n{\n\tconstructor(options: { defaultMaxListeners?: number } = {})\n\t{\n\t\tthis.defaultMaxListeners = Type.isNumber(options.defaultMaxListeners) ? options.defaultMaxListeners : 10;\n\t\tthis.eventStore = new WeakMap();\n\t}\n\n\tadd(target: Object, options: { maxListeners?: number } = {})\n\t{\n\t\tconst record = this.getRecordScheme();\n\t\tif (Type.isNumber(options.maxListeners))\n\t\t{\n\t\t\trecord.maxListeners = options.maxListeners;\n\t\t}\n\n\t\tthis.eventStore.set(target, record);\n\n\t\treturn record;\n\t}\n\n\tget(target: Object)\n\t{\n\t\treturn this.eventStore.get(target);\n\t}\n\n\tgetOrAdd(target: Object, options: { maxListeners?: number } = {})\n\t{\n\t\treturn this.get(target) || this.add(target, options);\n\t}\n\n\tdelete(context: any)\n\t{\n\t\tthis.eventStore.delete(context);\n\t}\n\n\tgetRecordScheme()\n\t{\n\t\treturn {\n\t\t\teventsMap: new Map(),\n\t\t\tonceMap: new Map(),\n\t\t\tmaxListeners: this.getDefaultMaxListeners(),\n\t\t\teventsMaxListeners: new Map(),\n\t\t};\n\t}\n\n\tgetDefaultMaxListeners()\n\t{\n\t\treturn this.defaultMaxListeners;\n\t}\n}\n\n","import Type from \"../../type\";\nimport Runtime from \"../../runtime\";\n\nexport default class WarningStore\n{\n\tconstructor()\n\t{\n\t\tthis.warnings = new Map();\n\t\tthis.printDelayed = Runtime.debounce(this.print.bind(this), 500);\n\t}\n\n\tadd(target, eventName, listeners)\n\t{\n\t\tlet contextWarnings = this.warnings.get(target);\n\t\tif (!contextWarnings)\n\t\t{\n\t\t\tcontextWarnings = Object.create(null);\n\t\t\tthis.warnings.set(target, contextWarnings);\n\t\t}\n\n\t\tif (!contextWarnings[eventName])\n\t\t{\n\t\t\tcontextWarnings[eventName] = {};\n\t\t}\n\n\t\tcontextWarnings[eventName].size = listeners.size;\n\t\tif (!Type.isArray(contextWarnings[eventName].errors))\n\t\t{\n\t\t\tcontextWarnings[eventName].errors = [];\n\t\t}\n\n\t\tcontextWarnings[eventName].errors.push(new Error());\n\t}\n\n\tprint()\n\t{\n\t\tfor (let [target, warnings] of this.warnings)\n\t\t{\n\t\t\tfor (let eventName in warnings)\n\t\t\t{\n\t\t\t\tconsole.groupCollapsed(\n\t\t\t\t\t'Possible BX.Event.EventEmitter memory leak detected. ' +\n\t\t\t\t\twarnings[eventName].size + ' \"' + eventName + '\" listeners added. ' +\n\t\t\t\t\t'Use emitter.setMaxListeners() to increase limit.'\n\t\t\t\t);\n\t\t\t\tconsole.dir(warnings[eventName].errors);\n\t\t\t\tconsole.groupEnd();\n\t\t\t}\n\t\t}\n\n\t\tthis.clear();\n\t}\n\n\tclear()\n\t{\n\t\tthis.warnings.clear();\n\t}\n\n\tprintDelayed()\n\t{\n\t}\n}","import Type from '../type';\nimport Runtime from '../runtime';\nimport BaseEvent from './base-event';\nimport EventStore from './event-emitter/eventstore';\nimport WarningStore from './event-emitter/warningstore';\n\nconst eventStore = new EventStore({ defaultMaxListeners: 10 });\nconst warningStore = new WarningStore();\nconst aliasStore = new Map();\n\nconst globalTarget = {\n\tGLOBAL_TARGET: 'GLOBAL_TARGET' // this key only for debugging purposes\n};\neventStore.add(globalTarget, { maxListeners: 25 });\n\nconst isEmitterProperty = Symbol.for('BX.Event.EventEmitter.isEmitter');\nconst namespaceProperty = Symbol('namespaceProperty');\nconst targetProperty = Symbol('targetProperty');\n\nexport default class EventEmitter\n{\n\tstatic GLOBAL_TARGET = globalTarget;\n\tstatic DEFAULT_MAX_LISTENERS = eventStore.getDefaultMaxListeners();\n\n\t/** @private */\n\tstatic sequenceValue = 1;\n\n\tconstructor(...args)\n\t{\n\t\tthis[targetProperty] = null;\n\t\tthis[namespaceProperty] = null;\n\t\tthis[isEmitterProperty] = true;\n\n\t\tlet target = this;\n\t\tif (Object.getPrototypeOf(this) === EventEmitter.prototype && args.length > 0) //new EventEmitter(obj) case\n\t\t{\n\t\t\tif (!Type.isObject(args[0]))\n\t\t\t{\n\t\t\t\tthrow new TypeError(`The \"target\" argument must be an object.`);\n\t\t\t}\n\n\t\t\ttarget = args[0];\n\n\t\t\tthis.setEventNamespace(args[1]);\n\t\t}\n\n\t\tthis[targetProperty] = target;\n\n\t\tsetTimeout(() => {\n\t\t\tif (this.getEventNamespace() === null)\n\t\t\t{\n\t\t\t\tconsole.warn(\n\t\t\t\t\t'The instance of BX.Event.EventEmitter is supposed to have an event namespace. ' +\n\t\t\t\t\t'Use emitter.setEventNamespace() to make events more unique.'\n\t\t\t\t);\n\t\t\t}\n\t\t}, 500);\n\t}\n\n\t/**\n\t * Makes a target observable\n\t * @param {object} target\n\t * @param {string} namespace\n\t */\n\tstatic makeObservable(target: Object, namespace: string): void\n\t{\n\t\tif (!Type.isObject(target))\n\t\t{\n\t\t\tthrow new TypeError('The \"target\" argument must be an object.');\n\t\t}\n\n\t\tif (!Type.isStringFilled(namespace))\n\t\t{\n\t\t\tthrow new TypeError('The \"namespace\" must be an non-empty string.');\n\t\t}\n\n\t\tif (EventEmitter.isEventEmitter(target))\n\t\t{\n\t\t\tthrow new TypeError('The \"target\" is an event emitter already.');\n\t\t}\n\n\t\tconst targetProto = Object.getPrototypeOf(target);\n\t\tconst emitter = new EventEmitter();\n\t\temitter.setEventNamespace(namespace);\n\n\t\tObject.setPrototypeOf(emitter, targetProto);\n\t\tObject.setPrototypeOf(target, emitter);\n\n\t\tObject.getOwnPropertyNames(EventEmitter.prototype).forEach(method => {\n\n\t\t\tif (['constructor'].includes(method))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\temitter[method] = function(...args) {\n\t\t\t\treturn EventEmitter.prototype[method].apply(target, args);\n\t\t\t}\n\t\t});\n\t}\n\n\tsetEventNamespace(namespace)\n\t{\n\t\tif (Type.isStringFilled(namespace))\n\t\t{\n\t\t\tthis[namespaceProperty] = namespace;\n\t\t}\n\t}\n\n\tgetEventNamespace()\n\t{\n\t\treturn this[namespaceProperty];\n\t}\n\n\t/**\n\t * Subscribes listener on specified global event\n\t * @param {object} target\n\t * @param {string} eventName\n\t * @param {Function<BaseEvent>} listener\n\t * @param {object} options\n\t */\n\tstatic subscribe(\n\t\ttarget: Object,\n\t\teventName: string,\n\t\tlistener: (event: BaseEvent) => void,\n\t\toptions?: {\n\t\t\tcompatMode?: boolean,\n\t\t\tuseGlobalNaming?: boolean\n\t\t}\n\t): void\n\t{\n\t\tif (Type.isString(target))\n\t\t{\n\t\t\toptions = listener;\n\t\t\tlistener = eventName;\n\t\t\teventName = target;\n\t\t\ttarget = this.GLOBAL_TARGET;\n\t\t}\n\n\t\tif (!Type.isObject(target))\n\t\t{\n\t\t\tthrow new TypeError(`The \"target\" argument must be an object.`);\n\t\t}\n\n\t\teventName = this.normalizeEventName(eventName);\n\t\tif (!Type.isStringFilled(eventName))\n\t\t{\n\t\t\tthrow new TypeError(`The \"eventName\" argument must be a string.`);\n\t\t}\n\n\t\tif (!Type.isFunction(listener))\n\t\t{\n\t\t\tthrow new TypeError(`The \"listener\" argument must be of type Function. Received type ${typeof listener}.`);\n\t\t}\n\n\t\toptions = Type.isPlainObject(options) ? options : {};\n\t\tconst fullEventName = this.resolveEventName(eventName, target, options.useGlobalNaming === true);\n\t\tconst { eventsMap, onceMap } = eventStore.getOrAdd(target);\n\t\tconst onceListeners = onceMap.get(fullEventName);\n\t\tlet listeners = eventsMap.get(fullEventName);\n\n\t\tif ((listeners && listeners.has(listener)) || (onceListeners && onceListeners.has(listener)))\n\t\t{\n\t\t\tconsole.error(`You cannot subscribe the same \"${fullEventName}\" event listener twice.`);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (listeners)\n\t\t\t{\n\t\t\t\tlisteners.set(\n\t\t\t\t\tlistener,\n\t\t\t\t\t{\n\t\t\t\t\t\tlistener,\n\t\t\t\t\t\toptions,\n\t\t\t\t\t\tsort: this.getNextSequenceValue()\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tlisteners = new Map([[\n\t\t\t\t\tlistener,\n\t\t\t\t\t{\n\t\t\t\t\t\tlistener,\n\t\t\t\t\t\toptions,\n\t\t\t\t\t\tsort: this.getNextSequenceValue()\n\t\t\t\t\t}\n\t\t\t\t]]);\n\n\t\t\t\teventsMap.set(fullEventName, listeners);\n\t\t\t}\n\t\t}\n\n\t\tconst maxListeners = this.getMaxListeners(target, eventName);\n\t\tif (listeners.size > maxListeners)\n\t\t{\n\t\t\twarningStore.add(target, fullEventName, listeners);\n\t\t\twarningStore.printDelayed();\n\t\t}\n\t}\n\n\t/**\n\t * Subscribes a listener on a specified event\n\t * @param {string} eventName\n\t * @param {Function<BaseEvent>} listener\n\t * @return {this}\n\t */\n\tsubscribe(eventName: string, listener: (event: BaseEvent) => void): this\n\t{\n\t\tEventEmitter.subscribe(this, eventName, listener);\n\n\t\treturn this;\n\t}\n\n\t/**\n\t *\n\t * @param {object} options\n\t * @param {object} [aliases]\n\t * @param {boolean} [compatMode=false]\n\t */\n\tsubscribeFromOptions(\n\t\toptions: { [eventName: string]: Function },\n\t\taliases?: { [alias: string]: { eventName: string, namespace: string } },\n\t\tcompatMode?: boolean\n\t)\n\t{\n\t\tif (!Type.isPlainObject(options))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\taliases = Type.isPlainObject(aliases) ? EventEmitter.normalizeAliases(aliases) : {};\n\n\t\tObject.keys(options).forEach((eventName) => {\n\n\t\t\tconst listener = options[eventName];\n\t\t\tif (!Type.isFunction(listener))\n\t\t\t{\n\t\t\t\tthrow new TypeError(`The \"listener\" argument must be of type Function. Received type ${typeof listener}.`);\n\t\t\t}\n\n\t\t\teventName = EventEmitter.normalizeEventName(eventName);\n\n\t\t\tif (aliases[eventName])\n\t\t\t{\n\t\t\t\tconst { eventName: actualName } = aliases[eventName];\n\t\t\t\tEventEmitter.subscribe(this, actualName, listener, { compatMode: compatMode !== false });\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tEventEmitter.subscribe(this, eventName, listener, { compatMode: compatMode === true });\n\t\t\t}\n\t\t})\n\t}\n\n\t/**\n\t * Subscribes a listener that is called at\n\t * most once for a specified event.\n\t * @param {object} target\n\t * @param {string} eventName\n\t * @param {Function<BaseEvent>} listener\n\t */\n\tstatic subscribeOnce(\n\t\ttarget: Object,\n\t\teventName: string,\n\t\tlistener: (event: BaseEvent) => void\n\t): void\n\t{\n\t\tif (Type.isString(target))\n\t\t{\n\t\t\tlistener = eventName;\n\t\t\teventName = target;\n\t\t\ttarget = this.GLOBAL_TARGET;\n\t\t}\n\n\t\tif (!Type.isObject(target))\n\t\t{\n\t\t\tthrow new TypeError(`The \"target\" argument must be an object.`);\n\t\t}\n\n\t\teventName = this.normalizeEventName(eventName);\n\t\tif (!Type.isStringFilled(eventName))\n\t\t{\n\t\t\tthrow new TypeError(`The \"eventName\" argument must be a string.`);\n\t\t}\n\n\t\tif (!Type.isFunction(listener))\n\t\t{\n\t\t\tthrow new TypeError(`The \"listener\" argument must be of type Function. Received type ${typeof listener}.`);\n\t\t}\n\n\t\tconst fullEventName = this.resolveEventName(eventName, target);\n\t\tconst { eventsMap, onceMap } = eventStore.getOrAdd(target);\n\t\tconst listeners = eventsMap.get(fullEventName);\n\t\tlet onceListeners = onceMap.get(fullEventName);\n\n\t\tif ((listeners && listeners.has(listener)) || (onceListeners && onceListeners.has(listener)))\n\t\t{\n\t\t\tconsole.error(`You cannot subscribe the same \"${fullEventName}\" event listener twice.`);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst once = (...args) => {\n\t\t\t\tthis.unsubscribe(target, eventName, once);\n\t\t\t\tonceListeners.delete(listener);\n\t\t\t\tlistener(...args);\n\t\t\t};\n\n\t\t\tif (onceListeners)\n\t\t\t{\n\t\t\t\tonceListeners.set(listener, once);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tonceListeners = new Map([[listener, once]]);\n\t\t\t\tonceMap.set(fullEventName, onceListeners);\n\t\t\t}\n\n\t\t\tthis.subscribe(target, eventName, once);\n\t\t}\n\t}\n\n\t/**\n\t * Subscribes a listener that is called at most once for a specified event.\n\t * @param {string} eventName\n\t * @param {Function<BaseEvent>} listener\n\t * @return {this}\n\t */\n\tsubscribeOnce(eventName: string, listener: (event: BaseEvent) => void): this\n\t{\n\t\tEventEmitter.subscribeOnce(this, eventName, listener);\n\n\t\treturn this;\n\t}\n\n\t/**\n\t * Unsubscribes an event listener\n\t * @param {object} target\n\t * @param {string} eventName\n\t * @param {Function<BaseEvent>} listener\n\t * @param options\n\t */\n\tstatic unsubscribe(\n\t\ttarget: Object,\n\t\teventName: string,\n\t\tlistener: (event: BaseEvent) => void,\n\t\toptions?: {\n\t\t\tuseGlobalNaming?: boolean\n\t\t}\n\t): void\n\t{\n\t\tif (Type.isString(target))\n\t\t{\n\t\t\tlistener = eventName;\n\t\t\teventName = target;\n\t\t\ttarget = this.GLOBAL_TARGET;\n\t\t}\n\n\t\teventName = this.normalizeEventName(eventName);\n\t\tif (!Type.isStringFilled(eventName))\n\t\t{\n\t\t\tthrow new TypeError(`The \"eventName\" argument must be a string.`);\n\t\t}\n\n\t\tif (!Type.isFunction(listener))\n\t\t{\n\t\t\tthrow new TypeError(\n\t\t\t\t`The \"listener\" argument must be of type Function. Received type ${typeof event}.`\n\t\t\t);\n\t\t}\n\n\t\toptions = Type.isPlainObject(options) ? options : {};\n\n\t\tconst fullEventName = this.resolveEventName(eventName, target, options.useGlobalNaming === true);\n\t\tconst targetInfo = eventStore.get(target);\n\t\tconst listeners = targetInfo && targetInfo.eventsMap.get(fullEventName);\n\t\tconst onceListeners = targetInfo && targetInfo.onceMap.get(fullEventName);\n\n\t\tif (listeners)\n\t\t{\n\t\t\tlisteners.delete(listener);\n\t\t}\n\n\t\tif (onceListeners)\n\t\t{\n\t\t\tconst once = onceListeners.get(listener);\n\t\t\tif (once)\n\t\t\t{\n\t\t\t\tonceListeners.delete(listener);\n\t\t\t\tlisteners.delete(once);\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Unsubscribes an event listener\n\t * @param {string} eventName\n\t * @param {Function<BaseEvent>} listener\n\t * @return {this}\n\t */\n\tunsubscribe(eventName: string, listener: (event: BaseEvent) => void): this\n\t{\n\t\tEventEmitter.unsubscribe(this, eventName, listener);\n\n\t\treturn this;\n\t}\n\n\t/**\n\t * Unsubscribes all event listeners\n\t * @param {object} target\n\t * @param {string} eventName\n\t * @param options\n\t */\n\tstatic unsubscribeAll(\n\t\ttarget: Object,\n\t\teventName?: string,\n\t\toptions?: {\n\t\t\tuseGlobalNaming?: boolean\n\t\t}\n\t): void\n\t{\n\t\tif (Type.isString(target))\n\t\t{\n\t\t\teventName = target;\n\t\t\ttarget = this.GLOBAL_TARGET;\n\t\t}\n\n\t\tif (Type.isStringFilled(eventName))\n\t\t{\n\t\t\tconst targetInfo = eventStore.get(target);\n\t\t\tif (targetInfo)\n\t\t\t{\n\t\t\t\toptions = Type.isPlainObject(options) ? options : {};\n\t\t\t\tconst fullEventName = this.resolveEventName(eventName, target, options.useGlobalNaming === true);\n\t\t\t\ttargetInfo.eventsMap.delete(fullEventName);\n\t\t\t\ttargetInfo.onceMap.delete(fullEventName)\n\t\t\t}\n\t\t}\n\t\telse if (Type.isNil(eventName))\n\t\t{\n\t\t\tif (target === this.GLOBAL_TARGET)\n\t\t\t{\n\t\t\t\tconsole.error('You cannot unsubscribe all global listeners.');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\teventStore.delete(target);\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Unsubscribes all event listeners\n\t * @param {string} [eventName]\n\t */\n\tunsubscribeAll(eventName?: string): void\n\t{\n\t\tEventEmitter.unsubscribeAll(this, eventName);\n\t}\n\n\t/**\n\t *\n\t * @param {object} target\n\t * @param {string} eventName\n\t * @param {BaseEvent | any} event\n\t * @param {object} options\n\t * @returns {Array}\n\t */\n\tstatic emit(\n\t\ttarget: Object,\n\t\teventName: string,\n\t\tevent?: BaseEvent | {[key: string]: any},\n\t\toptions?: {\n\t\t\tcloneData?: boolean,\n\t\t\tthisArg?: Object,\n\t\t\tuseGlobalNaming?: boolean\n\t\t}\n\t): this\n\t{\n\t\tif (Type.isString(target))\n\t\t{\n\t\t\toptions = event;\n\t\t\tevent = eventName;\n\t\t\teventName = target;\n\t\t\ttarget = this.GLOBAL_TARGET;\n\t\t}\n\n\t\tif (!Type.isObject(target))\n\t\t{\n\t\t\tthrow new TypeError(`The \"target\" argument must be an object.`);\n\t\t}\n\n\t\teventName = this.normalizeEventName(eventName);\n\t\tif (!Type.isStringFilled(eventName))\n\t\t{\n\t\t\tthrow new TypeError(`The \"eventName\" argument must be a string.`);\n\t\t}\n\n\t\toptions = Type.isPlainObject(options) ? options : {};\n\n\t\tconst fullEventName = this.resolveEventName(eventName, target, options.useGlobalNaming === true);\n\t\tconst globalEvents = eventStore.get(this.GLOBAL_TARGET);\n\t\tconst globalListeners = (globalEvents && globalEvents.eventsMap.get(fullEventName)) || new Map();\n\n\t\tlet targetListeners = new Set();\n\t\tif (target !== this.GLOBAL_TARGET)\n\t\t{\n\t\t\tconst targetEvents = eventStore.get(target);\n\t\t\ttargetListeners = (targetEvents && targetEvents.eventsMap.get(fullEventName)) || new Map();\n\t\t}\n\n\t\tconst listeners = [...globalListeners.values(), ...targetListeners.values()];\n\t\tlisteners.sort(function(a, b) {\n\t\t\treturn a.sort - b.sort;\n\t\t});\n\n\t\tconst preparedEvent = this.prepareEvent(target, fullEventName, event);\n\t\tconst result = [];\n\n\t\tfor (let i = 0; i < listeners.length; i++)\n\t\t{\n\t\t\tif (preparedEvent.isImmediatePropagationStopped())\n\t\t\t{\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tconst { listener, options: listenerOptions } = listeners[i];\n\n\t\t\t//A previous listener could remove a current listener.\n\t\t\tif (globalListeners.has(listener) || targetListeners.has(listener))\n\t\t\t{\n\t\t\t\tlet listenerResult;\n\t\t\t\tif (listenerOptions.compatMode)\n\t\t\t\t{\n\t\t\t\t\tlet params = [];\n\t\t\t\t\tconst compatData = preparedEvent.getCompatData();\n\t\t\t\t\tif (compatData !== null)\n\t\t\t\t\t{\n\t\t\t\t\t\tparams = options.cloneData === true ? Runtime.clone(compatData) : compatData\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tparams = [preparedEvent];\n\t\t\t\t\t}\n\n\t\t\t\t\tconst context = Type.isUndefined(options.thisArg) ? target : options.thisArg;\n\t\t\t\t\tlistenerResult = listener.apply(context, params);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tlistenerResult =\n\t\t\t\t\t\tType.isUndefined(options.thisArg)\n\t\t\t\t\t\t\t? listener(preparedEvent)\n\t\t\t\t\t\t\t: listener.call(options.thisArg, preparedEvent)\n\t\t\t\t\t;\n\t\t\t\t}\n\n\t\t\t\tresult.push(listenerResult);\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t}\n\n\t/**\n\t * Emits specified event with specified event object\n\t * @param {string} eventName\n\t * @param {BaseEvent | any} event\n\t * @return {this}\n\t */\n\temit(eventName: string, event?: BaseEvent | {[key: string]: any}): this\n\t{\n\t\tEventEmitter.emit(this, eventName, event);\n\n\t\treturn this;\n\t}\n\n\t/**\n\t * Emits global event and returns a promise that is resolved when\n\t * all promise returned from event handlers are resolved,\n\t * or rejected when at least one of the returned promise is rejected.\n\t * Importantly. You can return any value from synchronous handlers, not just promise\n\t * @param {object} target\n\t * @param {string} eventName\n\t * @param {BaseEvent | any} event\n\t * @return {Promise<Array>}\n\t */\n\tstatic emitAsync(target: Object, eventName: string, event?: BaseEvent | {[key: string]: any}): Promise<Array>\n\t{\n\t\tif (Type.isString(target))\n\t\t{\n\t\t\tevent = eventName;\n\t\t\teventName = target;\n\t\t\ttarget = this.GLOBAL_TARGET;\n\t\t}\n\n\t\treturn Promise.all(this.emit(target, eventName, event));\n\t}\n\n\t/**\n\t * Emits event and returns a promise that is resolved when\n\t * all promise returned from event handlers are resolved,\n\t * or rejected when at least one of the returned promise is rejected.\n\t * Importantly. You can return any value from synchronous handlers, not just promise\n\t * @param {string} eventName\n\t * @param {BaseEvent|any} event\n\t * @return {Promise<Array>}\n\t */\n\temitAsync(eventName: string, event?: BaseEvent | {[key: string]: any}): Promise<Array>\n\t{\n\t\treturn EventEmitter.emitAsync(this, eventName, event);\n\t}\n\n\t/**\n\t * @private\n\t * @param {object} target\n\t * @param {string} eventName\n\t * @param {BaseEvent|any} event\n\t * @returns {BaseEvent}\n\t */\n\tstatic prepareEvent(\n\t\ttarget: Object,\n\t\teventName: string,\n\t\tevent?: BaseEvent | {[key: string]: any},\n\t): BaseEvent\n\t{\n\t\tlet preparedEvent = event;\n\t\tif (!(event instanceof BaseEvent))\n\t\t{\n\t\t\tpreparedEvent = new BaseEvent();\n\t\t\tpreparedEvent.setData(event);\n\t\t}\n\n\t\tpreparedEvent.setTarget(this.isEventEmitter(target) ? target[targetProperty] : target);\n\t\tpreparedEvent.setType(eventName);\n\n\t\treturn preparedEvent;\n\t}\n\n\t/**\n\t * @private\n\t * @returns {number}\n\t */\n\tstatic getNextSequenceValue(): number\n\t{\n\t\treturn this.sequenceValue++;\n\t}\n\n\t/**\n\t * Sets max global events listeners count\n\t * Event.EventEmitter.setMaxListeners(10) - sets the default value for all events (global target)\n\t * Event.EventEmitter.setMaxListeners(\"onClose\", 10) - sets the value for onClose event (global target)\n\t * Event.EventEmitter.setMaxListeners(obj, 10) - sets the default value for all events (obj target)\n\t * Event.EventEmitter.setMaxListeners(obj, \"onClose\", 10); - sets the value for onClose event (obj target)\n\t * @return {void}\n\t * @param args\n\t */\n\tstatic setMaxListeners(...args): void\n\t{\n\t\tlet target = this.GLOBAL_TARGET;\n\t\tlet eventName = null;\n\t\tlet count = undefined;\n\n\t\tif (args.length === 1)\n\t\t{\n\t\t\tcount = args[0];\n\t\t}\n\t\telse if (args.length === 2)\n\t\t{\n\t\t\tif (Type.isString(args[0]))\n\t\t\t{\n\t\t\t\t[eventName, count] = args;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t[target, count] = args;\n\t\t\t}\n\t\t}\n\t\telse if (args.length >= 3)\n\t\t{\n\t\t\t[target, eventName, count] = args;\n\t\t}\n\n\t\tif (!Type.isObject(target))\n\t\t{\n\t\t\tthrow new TypeError(`The \"target\" argument must be an object.`);\n\t\t}\n\n\t\tif (eventName !== null && !Type.isStringFilled(eventName))\n\t\t{\n\t\t\tthrow new TypeError(`The \"eventName\" argument must be a string.`);\n\t\t}\n\n\t\tif (!Type.isNumber(count) || count < 0)\n\t\t{\n\t\t\tthrow new TypeError(\n\t\t\t\t`The value of \"count\" is out of range. It must be a non-negative number. Received ${count}.`\n\t\t\t);\n\t\t}\n\n\t\tconst targetInfo = eventStore.getOrAdd(target);\n\t\tif (Type.isStringFilled(eventName))\n\t\t{\n\t\t\tconst fullEventName = this.resolveEventName(eventName, target);\n\t\t\ttargetInfo.eventsMaxListeners.set(fullEventName, count);\n\t\t}\n\t\telse\n\t\t{\n\t\t\ttargetInfo.maxListeners = count;\n\t\t}\n\t}\n\n\t/**\n\t * Sets max events listeners count\n\t * this.setMaxListeners(10) - sets the default value for all events\n\t * this.setMaxListeners(\"onClose\", 10) sets the value for onClose event\n\t * @return {this}\n\t * @param args\n\t */\n\tsetMaxListeners(...args): this\n\t{\n\t\tEventEmitter.setMaxListeners(this, ...args);\n\n\t\treturn this;\n\t}\n\n\t/**\n\t * Returns max event listeners count\n\t * @param {object} target\n\t * @param {string} [eventName]\n\t * @returns {number}\n\t */\n\tstatic getMaxListeners(target: Object, eventName?: string): number\n\t{\n\t\tif (Type.isString(target))\n\t\t{\n\t\t\teventName = target;\n\t\t\ttarget = this.GLOBAL_TARGET;\n\t\t}\n\t\telse if (Type.isNil(target))\n\t\t{\n\t\t\ttarget = this.GLOBAL_TARGET;\n\t\t}\n\n\t\tif (!Type.isObject(target))\n\t\t{\n\t\t\tthrow new TypeError(`The \"target\" argument must be an object.`);\n\t\t}\n\n\t\tconst targetInfo = eventStore.get(target);\n\t\tif (targetInfo)\n\t\t{\n\t\t\tlet maxListeners = targetInfo.maxListeners;\n\t\t\tif (Type.isStringFilled(eventName))\n\t\t\t{\n\t\t\t\tconst fullEventName = this.resolveEventName(eventName, target);\n\t\t\t\tmaxListeners = targetInfo.eventsMaxListeners.get(fullEventName) || maxListeners;\n\t\t\t}\n\n\t\t\treturn maxListeners;\n\t\t}\n\n\t\treturn this.DEFAULT_MAX_LISTENERS;\n\t}\n\n\t/**\n\t * Returns max event listeners count\n\t * @param {string} [eventName]\n\t * @returns {number}\n\t */\n\tgetMaxListeners(eventName?: string): number\n\t{\n\t\treturn EventEmitter.getMaxListeners(this, eventName);\n\t}\n\n\t/**\n\t * Adds or subtracts max listeners count\n\t * Event.EventEmitter.addMaxListeners() - adds one max listener for all events of global target\n\t * Event.EventEmitter.addMaxListeners(3) - adds three max listeners for all events of global target\n\t * Event.EventEmitter.addMaxListeners(-1) - subtracts one max listener for all events of global target\n\t * Event.EventEmitter.addMaxListeners('onClose') - adds one max listener for onClose event of global target\n\t * Event.EventEmitter.addMaxListeners('onClose', 2) - adds two max listeners for onClose event of global target\n\t * Event.EventEmitter.addMaxListeners('onClose', -1) - subtracts one max listener for onClose event of global target\n\t *\n\t * Event.EventEmitter.addMaxListeners(obj) - adds one max listener for all events of 'obj' target\n\t * Event.EventEmitter.addMaxListeners(obj, 3) - adds three max listeners for all events of 'obj' target\n\t * Event.EventEmitter.addMaxListeners(obj, -1) - subtracts one max listener for all events of 'obj' target\n\t * Event.EventEmitter.addMaxListeners(obj, 'onClose') - adds one max listener for onClose event of 'obj' target\n\t * Event.EventEmitter.addMaxListeners(obj, 'onClose', 2) - adds two max listeners for onClose event of 'obj' target\n\t * Event.EventEmitter.addMaxListeners(obj, 'onClose', -1) - subtracts one max listener for onClose event of 'obj' target\n\t * @param args\n\t * @returns {number}\n\t */\n\tstatic addMaxListeners(...args)\n\t{\n\t\tconst [target, eventName, increment] = this.destructMaxListenersArgs(...args);\n\t\tconst maxListeners = Math.max(this.getMaxListeners(target, eventName) + increment, 0);\n\t\tif (Type.isStringFilled(eventName))\n\t\t{\n\t\t\tEventEmitter.setMaxListeners(target, eventName, maxListeners);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tEventEmitter.setMaxListeners(target, maxListeners);\n\t\t}\n\n\t\treturn maxListeners;\n\t}\n\n\t/**\n\t * Increases max listeners count\n\t *\n\t * Event.EventEmitter.incrementMaxListeners() - adds one max listener for all events of global target\n\t * Event.EventEmitter.incrementMaxListeners(3) - adds three max listeners for all events of global target\n\t * Event.EventEmitter.incrementMaxListeners('onClose') - adds one max listener for onClose event of global target\n\t * Event.EventEmitter.incrementMaxListeners('onClose', 2) - adds two max listeners for onClose event of global target\n\t *\n\t * Event.EventEmitter.incrementMaxListeners(obj) - adds one max listener for all events of 'obj' target\n\t * Event.EventEmitter.incrementMaxListeners(obj, 3) - adds three max listeners for all events of 'obj' target\n\t * Event.EventEmitter.incrementMaxListeners(obj, 'onClose') - adds one max listener for onClose event of 'obj' target\n\t * Event.EventEmitter.incrementMaxListeners(obj, 'onClose', 2) - adds two max listeners for onClose event of 'obj' target\n\t */\n\tstatic incrementMaxListeners(...args): number\n\t{\n\t\tconst [target, eventName, increment] = this.destructMaxListenersArgs(...args);\n\n\t\treturn this.addMaxListeners(target, eventName, Math.abs(increment));\n\t}\n\n\t/**\n\t * Increases max listeners count\n\t * this.incrementMaxListeners() - adds one max listener for all events\n\t * this.incrementMaxListeners(3) - adds three max listeners for all events\n\t * this.incrementMaxListeners('onClose') - adds one max listener for onClose event\n\t * this.incrementMaxListeners('onClose', 2) - adds two max listeners for onClose event\n\t */\n\tincrementMaxListeners(...args): number\n\t{\n\t\treturn EventEmitter.incrementMaxListeners(this, ...args);\n\t}\n\n\t/**\n\t * Decreases max listeners count\n\t *\n\t * Event.EventEmitter.decrementMaxListeners() - subtracts one max listener for all events of global target\n\t * Event.EventEmitter.decrementMaxListeners(3) - subtracts three max listeners for all events of global target\n\t * Event.EventEmitter.decrementMaxListeners('onClose') - subtracts one max listener for onClose event of global target\n\t * Event.EventEmitter.decrementMaxListeners('onClose', 2) - subtracts two max listeners for onClose event of global target\n\t *\n\t * Event.EventEmitter.decrementMaxListeners(obj) - subtracts one max listener for all events of 'obj' target\n\t * Event.EventEmitter.decrementMaxListeners(obj, 3) - subtracts three max listeners for all events of 'obj' target\n\t * Event.EventEmitter.decrementMaxListeners(obj, 'onClose') - subtracts one max listener for onClose event of 'obj' target\n\t * Event.EventEmitter.decrementMaxListeners(obj, 'onClose', 2) - subtracts two max listeners for onClose event of 'obj' target\n\t */\n\tstatic decrementMaxListeners(...args): number\n\t{\n\t\tconst [target, eventName, increment] = this.destructMaxListenersArgs(...args);\n\n\t\treturn this.addMaxListeners(target, eventName, -Math.abs(increment));\n\t}\n\n\t/**\n\t * Increases max listeners count\n\t * this.decrementMaxListeners() - subtracts one max listener for all events\n\t * this.decrementMaxListeners(3) - subtracts three max listeners for all events\n\t * this.decrementMaxListeners('onClose') - subtracts one max listener for onClose event\n\t * this.decrementMaxListeners('onClose', 2) - subtracts two max listeners for onClose event\n\t */\n\tdecrementMaxListeners(...args): number\n\t{\n\t\treturn EventEmitter.decrementMaxListeners(this, ...args);\n\t}\n\n\t/**\n\t * @private\n\t * @param {Array} args\n\t * @returns Array\n\t */\n\tstatic destructMaxListenersArgs(...args)\n\t{\n\t\tlet eventName = null;\n\t\tlet increment = 1;\n\t\tlet target = this.GLOBAL_TARGET;\n\n\t\tif (args.length === 1)\n\t\t{\n\t\t\tif (Type.isNumber(args[0]))\n\t\t\t{\n\t\t\t\tincrement = args[0];\n\t\t\t}\n\t\t\telse if (Type.isString(args[0]))\n\t\t\t{\n\t\t\t\teventName = args[0];\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\ttarget = args[0];\n\t\t\t}\n\t\t}\n\t\telse if (args.length === 2)\n\t\t{\n\t\t\tif (Type.isString(args[0]))\n\t\t\t{\n\t\t\t\t[eventName, increment] = args;\n\t\t\t}\n\t\t\telse if (Type.isString(args[1]))\n\t\t\t{\n\t\t\t\t[target, eventName] = args;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t[target, increment] = args;\n\t\t\t}\n\t\t}\n\t\telse if (args.length >= 3)\n\t\t{\n\t\t\t[target, eventName, increment] = args;\n\t\t}\n\n\t\tif (!Type.isObject(target))\n\t\t{\n\t\t\tthrow new TypeError(`The \"target\" argument must be an object.`);\n\t\t}\n\n\t\tif (eventName !== null && !Type.isStringFilled(eventName))\n\t\t{\n\t\t\tthrow new TypeError(`The \"eventName\" argument must be a string.`);\n\t\t}\n\n\t\tif (!Type.isNumber(increment))\n\t\t{\n\t\t\tthrow new TypeError(`The value of \"increment\" must be a number.`);\n\t\t}\n\n\t\treturn [target, eventName, increment];\n\t}\n\n\t/**\n\t * Gets listeners list for a specified event\n\t * @param {object} target\n\t * @param {string} eventName\n\t */\n\tstatic getListeners(target: Object, eventName: string): Function[]\n\t{\n\t\tif (Type.isString(target))\n\t\t{\n\t\t\teventName = target;\n\t\t\ttarget = this.GLOBAL_TARGET;\n\t\t}\n\n\t\tif (!Type.isObject(target))\n\t\t{\n\t\t\tthrow new TypeError(`The \"target\" argument must be an object.`);\n\t\t}\n\n\t\teventName = this.normalizeEventName(eventName);\n\t\tif (!Type.isStringFilled(eventName))\n\t\t{\n\t\t\tthrow new TypeError(`The \"eventName\" argument must be a string.`);\n\t\t}\n\n\t\tconst targetInfo = eventStore.get(target);\n\t\tif (!targetInfo)\n\t\t{\n\t\t\treturn new Map();\n\t\t}\n\n\t\tconst fullEventName = this.resolveEventName(eventName, target);\n\t\treturn targetInfo.eventsMap.get(fullEventName) || new Map();\n\t}\n\n\t/**\n\t * Gets listeners list for specified event\n\t * @param {string} eventName\n\t */\n\tgetListeners(eventName: string): Function[]\n\t{\n\t\treturn EventEmitter.getListeners(this, eventName);\n\t}\n\n\t/**\n\t * Returns a full event name with namespace\n\t * @param {string} eventName\n\t * @returns {string}\n\t */\n\tgetFullEventName(eventName: string)\n\t{\n\t\tif (!Type.isStringFilled(eventName))\n\t\t{\n\t\t\tthrow new TypeError(`The \"eventName\" argument must be a string.`);\n\t\t}\n\n\t\treturn EventEmitter.makeFullEventName(this.getEventNamespace(), eventName);\n\t}\n\n\t/**\n\t * Registers aliases (old event names for BX.onCustomEvent)\n\t * @param aliases\n\t */\n\tstatic registerAliases(aliases: { [alias: string]: { eventName: string, namespace: string } })\n\t{\n\t\taliases = this.normalizeAliases(aliases);\n\n\t\tObject.keys(aliases).forEach((alias) => {\n\t\t\taliasStore.set(alias, {\n\t\t\t\teventName: aliases[alias].eventName,\n\t\t\t\tnamespace: aliases[alias].namespace\n\t\t\t});\n\t\t});\n\n\t\tEventEmitter.mergeEventAliases(aliases);\n\t}\n\n\t/**\n\t * @private\n\t * @param aliases\n\t */\n\tstatic normalizeAliases(aliases: { [alias: string]: { eventName: string, namespace: string } })\n\t{\n\t\tif (!Type.isPlainObject(aliases))\n\t\t{\n\t\t\tthrow new TypeError(`The \"aliases\" argument must be an object.`);\n\t\t}\n\n\t\tconst result = Object.create(null);\n\t\tfor (let alias in aliases)\n\t\t{\n\t\t\tif (!Type.isStringFilled(alias))\n\t\t\t{\n\t\t\t\tthrow new TypeError(`The alias must be an non-empty string.`);\n\t\t\t}\n\n\t\t\tconst options = aliases[alias];\n\t\t\tif (!options || !Type.isStringFilled(options.eventName) || !Type.isStringFilled(options.namespace))\n\t\t\t{\n\t\t\t\tthrow new TypeError(`The alias options must set the \"eventName\" and the \"namespace\".`);\n\t\t\t}\n\n\t\t\talias = this.normalizeEventName(alias);\n\n\t\t\tresult[alias] = {\n\t\t\t\teventName: options.eventName,\n\t\t\t\tnamespace: options.namespace\n\t\t\t};\n\t\t}\n\n\t\treturn result;\n\t}\n\n\t/**\n\t * @private\n\t */\n\tstatic mergeEventAliases(aliases)\n\t{\n\t\tconst globalEvents = eventStore.get(this.GLOBAL_TARGET);\n\t\tif (!globalEvents)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tObject.keys(aliases).forEach((alias) => {\n\t\t\tconst options = aliases[alias];\n\t\t\talias = this.normalizeEventName(alias);\n\t\t\tconst fullEventName = this.makeFullEventName(options.namespace, options.eventName);\n\n\t\t\tconst aliasListeners = globalEvents.eventsMap.get(alias);\n\t\t\tif (aliasListeners)\n\t\t\t{\n\t\t\t\tconst listeners = globalEvents.eventsMap.get(fullEventName) || new Map();\n\t\t\t\tglobalEvents.eventsMap.set(fullEventName, new Map([...listeners, ...aliasListeners]));\n\t\t\t\tglobalEvents.eventsMap.delete(alias);\n\t\t\t}\n\n\t\t\tconst aliasOnceListeners = globalEvents.onceMap.get(alias);\n\t\t\tif (aliasOnceListeners)\n\t\t\t{\n\t\t\t\tconst onceListeners = globalEvents.onceMap.get(fullEventName) || new Map();\n\t\t\t\tglobalEvents.onceMap.set(fullEventName, new Map([...onceListeners, ...aliasOnceListeners]));\n\t\t\t\tglobalEvents.onceMap.delete(alias);\n\t\t\t}\n\n\t\t\tconst aliasMaxListeners = globalEvents.eventsMaxListeners.get(alias);\n\t\t\tif (aliasMaxListeners)\n\t\t\t{\n\t\t\t\tconst eventMaxListeners = globalEvents.eventsMaxListeners.get(fullEventName) || 0;\n\t\t\t\tglobalEvents.eventsMaxListeners.set(fullEventName, Math.max(eventMaxListeners, aliasMaxListeners));\n\t\t\t\tglobalEvents.eventsMaxListeners.delete(alias);\n\t\t\t}\n\t\t});\n\t}\n\n\t/**\n\t * Returns true if the target is an instance of Event.EventEmitter\n\t * @param {object} target\n\t * @returns {boolean}\n\t */\n\tstatic isEventEmitter(target: Object)\n\t{\n\t\treturn Type.isObject(target) && target[isEmitterProperty] === true;\n\t}\n\n\t/**\n\t * @private\n\t * @param {string} eventName\n\t * @returns {string}\n\t */\n\tstatic normalizeEventName(eventName: string)\n\t{\n\t\tif (!Type.isStringFilled(eventName))\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\treturn eventName.toLowerCase();\n\t}\n\n\t/**\n\t * @private\n\t * @param eventName\n\t * @param target\n\t * @param useGlobalNaming\n\t * @returns {string}\n\t */\n\tstatic resolveEventName(eventName: string, target: Object, useGlobalNaming: boolean = false)\n\t{\n\t\teventName = this.normalizeEventName(eventName);\n\t\tif (!Type.isStringFilled(eventName))\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\tif (this.isEventEmitter(target) && useGlobalNaming !== true)\n\t\t{\n\t\t\tif (target.getEventNamespace() !== null && eventName.includes('.'))\n\t\t\t{\n\t\t\t\tconsole.warn(`Possible the wrong event name \"${eventName}\".`);\n\t\t\t}\n\n\t\t\teventName = target.getFullEventName(eventName);\n\t\t}\n\t\telse if (aliasStore.has(eventName))\n\t\t{\n\t\t\tconst { namespace, eventName: actualEventName } = aliasStore.get(eventName);\n\t\t\teventName = this.makeFullEventName(namespace, actualEventName);\n\t\t}\n\n\t\treturn eventName;\n\t}\n\n\t/**\n\t * @private\n\t * @param {string} namespace\n\t * @param {string} eventName\n\t * @returns {string}\n\t */\n\tstatic makeFullEventName(namespace: string, eventName: string)\n\t{\n\t\tconst fullName = Type.isStringFilled(namespace) ? `${namespace}:${eventName}` : eventName;\n\n\t\treturn Type.isStringFilled(fullName) ? fullName.toLowerCase() : '';\n\t}\n}","import Type from '../type';\n\nlet stack: Array<Function> = [];\n/**\n * For compatibility only\n * @type {boolean}\n */\n// eslint-disable-next-line\nexport let isReady = false;\n\nexport default function ready(handler: () => void)\n{\n\tswitch (document.readyState)\n\t{\n\t\tcase 'loading':\n\t\t\tstack.push(handler);\n\t\t\tbreak;\n\t\tcase 'interactive':\n\t\tcase 'complete':\n\t\t\tif (Type.isFunction(handler))\n\t\t\t{\n\t\t\t\thandler();\n\t\t\t}\n\n\t\t\tisReady = true;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tbreak;\n\t}\n}\n\ndocument.addEventListener('readystatechange', () => {\n\tif (!isReady)\n\t{\n\t\tstack.forEach(ready);\n\t\tstack = [];\n\t}\n});","import bind from './event/bind';\nimport unbind from './event/unbind';\nimport unbindAll from './event/unbind-all';\nimport bindOnce from './event/bind-once';\nimport EventEmitter from './event/event-emitter';\nimport BaseEvent from './event/base-event';\nimport ready from './event/ready';\n\n/**\n * @memberOf BX\n */\nexport default class Event\n{\n\tstatic bind: bind = bind;\n\tstatic bindOnce: bindOnce = bindOnce;\n\tstatic unbind: unbind = unbind;\n\tstatic unbindAll: unbindAll = unbindAll;\n\tstatic ready: ready = ready;\n\n\t/**\n\t * @deprecated use import { EventEmitter } from 'main.core.events'\n\t */\n\tstatic EventEmitter: EventEmitter = EventEmitter;\n\t/**\n\t * @deprecated use import { BaseEvent } from 'main.core.events'\n\t */\n\tstatic BaseEvent: BaseEvent = BaseEvent;\n\n}","import Type from '../lib/type';\nimport Text from '../lib/text';\n\nexport default function encodeAttributeValue(value: any)\n{\n\tif (Type.isPlainObject(value) || Type.isArray(value))\n\t{\n\t\treturn JSON.stringify(value);\n\t}\n\n\treturn Text.encode(Text.decode(value));\n}","import Type from '../lib/type';\nimport Text from '../lib/text';\n\nexport default function decodeAttributeValue(value: any)\n{\n\tif (Type.isString(value))\n\t{\n\t\tconst decodedValue = Text.decode(value);\n\t\tlet result;\n\n\t\ttry\n\t\t{\n\t\t\tresult = JSON.parse(decodedValue);\n\t\t}\n\t\tcatch (e)\n\t\t{\n\t\t\tresult = decodedValue;\n\t\t}\n\n\t\tif (result === decodedValue)\n\t\t{\n\t\t\tif (/^[\\d.]+[.]?\\d+$/.test(result))\n\t\t\t{\n\t\t\t\treturn Number(result);\n\t\t\t}\n\t\t}\n\n\t\tif (result === 'true' || result === 'false')\n\t\t{\n\t\t\treturn Boolean(result);\n\t\t}\n\n\t\treturn result;\n\t}\n\n\treturn value;\n}","export default function getPageScroll(): {scrollTop: number, scrollLeft: number}\n{\n\tconst {documentElement, body} = document;\n\n\tconst scrollTop = Math.max(\n\t\t(window.pageYOffset || 0),\n\t\t(documentElement ? documentElement.scrollTop : 0),\n\t\t(body ? body.scrollTop : 0),\n\t);\n\n\tconst scrollLeft = Math.max(\n\t\t(window.pageXOffset || 0),\n\t\t(documentElement ? documentElement.scrollLeft : 0),\n\t\t(body ? body.scrollLeft : 0),\n\t);\n\n\treturn {scrollTop, scrollLeft};\n}","import Type from './type';\nimport Event from './event';\nimport encodeAttributeValue from '../internal/encode-attribute-value';\nimport decodeAttributeValue from '../internal/decode-attribute-value';\nimport getPageScroll from '../internal/get-page-scroll';\n\n/**\n * @memberOf BX\n */\nexport default class Dom\n{\n\t/**\n\t * Replaces old html element to new html element\n\t * @param oldElement\n\t * @param newElement\n\t */\n\tstatic replace(oldElement: ?HTMLElement, newElement: ?HTMLElement)\n\t{\n\t\tif (Type.isDomNode(oldElement) && Type.isDomNode(newElement))\n\t\t{\n\t\t\tif (Type.isDomNode(oldElement.parentNode))\n\t\t\t{\n\t\t\t\toldElement.parentNode.replaceChild(newElement, oldElement);\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Removes element\n\t * @param element\n\t */\n\tstatic remove(element: ?HTMLElement)\n\t{\n\t\tif (Type.isDomNode(element) && Type.isDomNode(element.parentNode))\n\t\t{\n\t\t\telement.parentNode.removeChild(element);\n\t\t}\n\t}\n\n\t/**\n\t * Cleans element\n\t * @param element\n\t */\n\tstatic clean(element: HTMLElement | string)\n\t{\n\t\tif (Type.isDomNode(element))\n\t\t{\n\t\t\twhile (element.childNodes.length > 0)\n\t\t\t{\n\t\t\t\telement.removeChild(element.firstChild);\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (Type.isString(element))\n\t\t{\n\t\t\tDom.clean(document.getElementById(element));\n\t\t}\n\t}\n\n\t/**\n\t * Inserts element before target element\n\t * @param current\n\t * @param target\n\t */\n\tstatic insertBefore(current: ?HTMLElement, target: ?HTMLElement)\n\t{\n\t\tif (Type.isDomNode(current) && Type.isDomNode(target))\n\t\t{\n\t\t\tif (Type.isDomNode(target.parentNode))\n\t\t\t{\n\t\t\t\ttarget.parentNode.insertBefore(current, target);\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Inserts element after target element\n\t * @param current\n\t * @param target\n\t */\n\tstatic insertAfter(current: ?HTMLElement, target: ?HTMLElement)\n\t{\n\t\tif (Type.isDomNode(current) && Type.isDomNode(target))\n\t\t{\n\t\t\tif (Type.isDomNode(target.parentNode))\n\t\t\t{\n\t\t\t\tconst parent = target.parentNode;\n\n\t\t\t\tif (Type.isDomNode(target.nextSibling))\n\t\t\t\t{\n\t\t\t\t\tparent.insertBefore(current, target.nextSibling);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tparent.appendChild(current);\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Appends element to target element\n\t * @param current\n\t * @param target\n\t */\n\tstatic append(current: ?HTMLElement, target: ?HTMLElement)\n\t{\n\t\tif (Type.isDomNode(current) && Type.isDomNode(target))\n\t\t{\n\t\t\ttarget.appendChild(current);\n\t\t}\n\t}\n\n\t/**\n\t * Prepends element to target element\n\t * @param current\n\t * @param target\n\t */\n\tstatic prepend(current: ?HTMLElement, target: ?HTMLElement)\n\t{\n\t\tif (Type.isDomNode(current) && Type.isDomNode(target))\n\t\t{\n\t\t\tif (Type.isDomNode(target.firstChild))\n\t\t\t{\n\t\t\t\ttarget.insertBefore(current, target.firstChild);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tDom.append(current, target);\n\t\t}\n\t}\n\n\t/**\n\t * Checks that element contains class name or class names\n\t * @param element\n\t * @param className\n\t * @return {Boolean}\n\t */\n\tstatic hasClass(element: any, className: string | Array<string>): boolean\n\t{\n\t\tif (Type.isElementNode(element))\n\t\t{\n\t\t\tif (Type.isString(className))\n\t\t\t{\n\t\t\t\tconst preparedClassName = className.trim();\n\n\t\t\t\tif (preparedClassName.length > 0)\n\t\t\t\t{\n\t\t\t\t\tif (preparedClassName.includes(' '))\n\t\t\t\t\t{\n\t\t\t\t\t\treturn preparedClassName.split(' ')\n\t\t\t\t\t\t\t.every(name => Dom.hasClass(element, name));\n\t\t\t\t\t}\n\n\t\t\t\t\tif ('classList' in element)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn element.classList.contains(preparedClassName);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (\n\t\t\t\t\t\tType.isObject(element.className)\n\t\t\t\t\t\t&& Type.isString(element.className.baseVal)\n\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn element.getAttribute('class').split(' ')\n\t\t\t\t\t\t\t.some(name => name === preparedClassName);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (Type.isArray(className) && className.length > 0)\n\t\t\t{\n\t\t\t\treturn className.every(name => Dom.hasClass(element, name));\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t}\n\n\t/**\n\t * Adds class name\n\t * @param element\n\t * @param className\n\t */\n\tstatic addClass(element: any, className: string | Array<string>)\n\t{\n\t\tif (Type.isElementNode(element))\n\t\t{\n\t\t\tif (Type.isString(className))\n\t\t\t{\n\t\t\t\tconst preparedClassName = className.trim();\n\n\t\t\t\tif (preparedClassName.length > 0)\n\t\t\t\t{\n\t\t\t\t\tif (preparedClassName.includes(' '))\n\t\t\t\t\t{\n\t\t\t\t\t\tDom.addClass(element, preparedClassName.split(' '));\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif ('classList' in element)\n\t\t\t\t\t{\n\t\t\t\t\t\telement.classList.add(preparedClassName);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (\n\t\t\t\t\t\tType.isObject(element.className)\n\t\t\t\t\t\t&& Type.isString(element.className.baseVal)\n\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (element.className.baseVal === '')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\telement.className.baseVal = preparedClassName;\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst names = element.className.baseVal.split(' ');\n\n\t\t\t\t\t\tif (!names.includes(preparedClassName))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tnames.push(preparedClassName);\n\t\t\t\t\t\t\telement.className.baseVal = names.join(' ').trim();\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (Type.isArray(className))\n\t\t\t{\n\t\t\t\tclassName.forEach(name => Dom.addClass(element, name));\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Removes class name\n\t * @param element\n\t * @param className\n\t */\n\tstatic removeClass(element: any, className: string | Array<string>)\n\t{\n\t\tif (Type.isElementNode(element))\n\t\t{\n\t\t\tif (Type.isString(className))\n\t\t\t{\n\t\t\t\tconst preparedClassName = className.trim();\n\n\t\t\t\tif (preparedClassName.length > 0)\n\t\t\t\t{\n\t\t\t\t\tif (preparedClassName.includes(' '))\n\t\t\t\t\t{\n\t\t\t\t\t\tDom.removeClass(element, preparedClassName.split(' '));\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif ('classList' in element)\n\t\t\t\t\t{\n\t\t\t\t\t\telement.classList.remove(preparedClassName);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (\n\t\t\t\t\t\tType.isObject(element.className)\n\t\t\t\t\t\t&& Type.isString(element.className.baseVal)\n\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\tconst names = element.className.baseVal.split(' ')\n\t\t\t\t\t\t\t.filter(name => name !== preparedClassName);\n\n\t\t\t\t\t\telement.className.baseVal = names.join(' ');\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (Type.isArray(className))\n\t\t\t{\n\t\t\t\tclassName.forEach(name => Dom.removeClass(element, name));\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Toggles class name\n\t * @param element\n\t * @param className\n\t */\n\tstatic toggleClass(element: any, className: string | Array<string>)\n\t{\n\t\tif (Type.isElementNode(element))\n\t\t{\n\t\t\tif (Type.isString(className))\n\t\t\t{\n\t\t\t\tconst preparedClassName = className.trim();\n\n\t\t\t\tif (preparedClassName.length > 0)\n\t\t\t\t{\n\t\t\t\t\tif (preparedClassName.includes(' '))\n\t\t\t\t\t{\n\t\t\t\t\t\tDom.toggleClass(element, preparedClassName.split(' '));\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\telement.classList.toggle(preparedClassName);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (Type.isArray(className))\n\t\t\t{\n\t\t\t\tclassName.forEach(name => Dom.toggleClass(element, name));\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Styles element\n\t */\n\tstatic style(\n\t\telement: ?HTMLElement,\n\t\tprop: ?string | {[key: string]: any},\n\t\tvalue?: any,\n\t): ?string | number | Element\n\t{\n\t\tif (Type.isElementNode(element))\n\t\t{\n\t\t\tif (Type.isNull(prop))\n\t\t\t{\n\t\t\t\telement.removeAttribute('style');\n\t\t\t\treturn element;\n\t\t\t}\n\n\t\t\tif (Type.isPlainObject(prop))\n\t\t\t{\n\t\t\t\tObject.entries(prop).forEach((item) => {\n\t\t\t\t\tconst [currentKey, currentValue] = item;\n\t\t\t\t\tDom.style(element, currentKey, currentValue);\n\t\t\t\t});\n\n\t\t\t\treturn element;\n\t\t\t}\n\n\t\t\tif (Type.isString(prop))\n\t\t\t{\n\t\t\t\tif (Type.isUndefined(value)\n\t\t\t\t\t&& element.nodeType !== Node.DOCUMENT_NODE)\n\t\t\t\t{\n\t\t\t\t\tconst computedStyle = getComputedStyle(element);\n\n\t\t\t\t\tif (prop in computedStyle)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn computedStyle[prop];\n\t\t\t\t\t}\n\n\t\t\t\t\treturn computedStyle.getPropertyValue(prop);\n\t\t\t\t}\n\n\t\t\t\tif (\n\t\t\t\t\tType.isNull(value)\n\t\t\t\t\t|| value === ''\n\t\t\t\t\t|| value === 'null'\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\t// eslint-disable-next-line\n\t\t\t\t\telement.style[prop] = '';\n\t\t\t\t\treturn element;\n\t\t\t\t}\n\n\t\t\t\tif (Type.isString(value) || Type.isNumber(value))\n\t\t\t\t{\n\t\t\t\t\t// eslint-disable-next-line\n\t\t\t\t\telement.style[prop] = value;\n\t\t\t\t\treturn element;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t}\n\n\t/**\n\t * Adjusts element\n\t * @param target\n\t * @param data\n\t * @return {*}\n\t */\n\tstatic adjust(\n\t\ttarget: HTMLElement | HTMLDocument,\n\t\tdata: Object = {},\n\t): HTMLElement | HTMLBodyElement\n\t{\n\t\tif (!target.nodeType)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tlet element = target;\n\n\t\tif (target.nodeType === Node.DOCUMENT_NODE)\n\t\t{\n\t\t\telement = target.body;\n\t\t}\n\n\t\tif (Type.isPlainObject(data))\n\t\t{\n\t\t\tif (Type.isPlainObject(data.attrs))\n\t\t\t{\n\t\t\t\tObject.keys(data.attrs).forEach((key) => {\n\t\t\t\t\tif (key === 'class' || key.toLowerCase() === 'classname')\n\t\t\t\t\t{\n\t\t\t\t\t\telement.className = data.attrs[key];\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\t// eslint-disable-next-line\n\t\t\t\t\tif (data.attrs[key] == '')\n\t\t\t\t\t{\n\t\t\t\t\t\telement.removeAttribute(key);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\telement.setAttribute(key, data.attrs[key]);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (Type.isPlainObject(data.style))\n\t\t\t{\n\t\t\t\tDom.style(element, data.style);\n\t\t\t}\n\n\t\t\tif (Type.isPlainObject(data.props))\n\t\t\t{\n\t\t\t\tObject.keys(data.props).forEach((key) => {\n\t\t\t\t\telement[key] = data.props[key];\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (Type.isPlainObject(data.events))\n\t\t\t{\n\t\t\t\tObject.keys(data.events).forEach((key) => {\n\t\t\t\t\tEvent.bind(element, key, data.events[key]);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (Type.isPlainObject(data.dataset))\n\t\t\t{\n\t\t\t\tObject.keys(data.dataset).forEach((key) => {\n\t\t\t\t\telement.dataset[key] = data.dataset[key];\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (Type.isString(data.children))\n\t\t\t{\n\t\t\t\tdata.children = [data.children];\n\t\t\t}\n\n\t\t\tif (Type.isArray(data.children) && data.children.length > 0)\n\t\t\t{\n\t\t\t\tdata.children.forEach((item) => {\n\t\t\t\t\tif (Type.isDomNode(item))\n\t\t\t\t\t{\n\t\t\t\t\t\tDom.append(item, element);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (Type.isString(item))\n\t\t\t\t\t{\n\t\t\t\t\t\telement.innerHTML += item;\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\treturn element;\n\t\t\t}\n\n\t\t\tif ('text' in data && !Type.isNil(data.text))\n\t\t\t{\n\t\t\t\telement.innerText = data.text;\n\t\t\t\treturn element;\n\t\t\t}\n\n\t\t\tif ('html' in data && !Type.isNil(data.html))\n\t\t\t{\n\t\t\t\telement.innerHTML = data.html;\n\t\t\t}\n\t\t}\n\n\t\treturn element;\n\t}\n\n\t/**\n\t * Creates element\n\t * @param tag\n\t * @param data\n\t * @param context\n\t * @return {HTMLElement|HTMLBodyElement}\n\t */\n\tstatic create(\n\t\ttag: string | {[key: string]: any},\n\t\tdata?: Object = {},\n\t\tcontext: HTMLDocument = document,\n\t)\n\t{\n\t\tlet tagName = tag;\n\t\tlet options = data;\n\n\t\tif (Type.isObjectLike(tag))\n\t\t{\n\t\t\toptions = tag;\n\t\t\ttagName = tag.tag;\n\t\t}\n\n\t\treturn Dom.adjust(context.createElement(tagName), options);\n\t}\n\n\t/**\n\t * Shows element\n\t * @param element\n\t */\n\tstatic show(element: ?HTMLElement)\n\t{\n\t\tif (Type.isDomNode(element))\n\t\t{\n\t\t\t// eslint-disable-next-line\n\t\t\telement.hidden = false;\n\t\t}\n\t}\n\n\t/**\n\t * Hides element\n\t * @param element\n\t */\n\tstatic hide(element: ?HTMLElement)\n\t{\n\t\tif (Type.isDomNode(element))\n\t\t{\n\t\t\t// eslint-disable-next-line\n\t\t\telement.hidden = true;\n\t\t}\n\t}\n\n\t/**\n\t * Checks that element is shown\n\t * @param element\n\t * @return {*|boolean}\n\t */\n\tstatic isShown(element: ?HTMLElement)\n\t{\n\t\treturn (\n\t\t\tType.isDomNode(element)\n\t\t\t&& !element.hidden\n\t\t\t&& element.style.getPropertyValue('display') !== 'none'\n\t\t);\n\t}\n\n\t/**\n\t * Toggles element visibility\n\t * @param element\n\t */\n\tstatic toggle(element: HTMLElement)\n\t{\n\t\tif (Type.isDomNode(element))\n\t\t{\n\t\t\tif (Dom.isShown(element))\n\t\t\t{\n\t\t\t\tDom.hide(element);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tDom.show(element);\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Gets element position relative page\n\t * @param {HTMLElement} element\n\t * @return {DOMRect}\n\t */\n\tstatic getPosition(element: HTMLElement): DOMRect\n\t{\n\t\tif (Type.isDomNode(element))\n\t\t{\n\t\t\tconst elementRect = element.getBoundingClientRect();\n\t\t\tconst {scrollLeft, scrollTop} = getPageScroll();\n\n\t\t\treturn new DOMRect(\n\t\t\t\t(elementRect.left + scrollLeft),\n\t\t\t\t(elementRect.top + scrollTop),\n\t\t\t\telementRect.width,\n\t\t\t\telementRect.height,\n\t\t\t);\n\t\t}\n\n\t\treturn new DOMRect();\n\t}\n\n\t/**\n\t * Gets element position relative specified element position\n\t * @param {HTMLElement} element\n\t * @param {HTMLElement} relationElement\n\t * @return {DOMRect}\n\t */\n\tstatic getRelativePosition(element: HTMLElement, relationElement: HTMLElement): DOMRect\n\t{\n\t\tif (Type.isDomNode(element) && Type.isDomNode(relationElement))\n\t\t{\n\t\t\tconst elementPosition = Dom.getPosition(element);\n\t\t\tconst relationElementPosition = Dom.getPosition(relationElement);\n\n\t\t\treturn new DOMRect(\n\t\t\t\telementPosition.left - relationElementPosition.left,\n\t\t\t\telementPosition.top - relationElementPosition.top,\n\t\t\t\telementPosition.width,\n\t\t\t\telementPosition.height,\n\t\t\t);\n\t\t}\n\n\t\treturn new DOMRect();\n\t}\n\n\tstatic attr(\n\t\telement: ?HTMLElement,\n\t\tattr: string | {[key: string]: any},\n\t\tvalue?: any,\n\t)\n\t{\n\t\tif (Type.isElementNode(element))\n\t\t{\n\t\t\tif (Type.isString(attr))\n\t\t\t{\n\t\t\t\tif (!Type.isNil(value))\n\t\t\t\t{\n\t\t\t\t\treturn element.setAttribute(attr, encodeAttributeValue(value));\n\t\t\t\t}\n\n\t\t\t\tif (Type.isNull(value))\n\t\t\t\t{\n\t\t\t\t\treturn element.removeAttribute(attr);\n\t\t\t\t}\n\n\t\t\t\treturn decodeAttributeValue(element.getAttribute(attr));\n\t\t\t}\n\n\t\t\tif (Type.isPlainObject(attr))\n\t\t\t{\n\t\t\t\treturn Object.entries(attr).forEach(([attrKey, attrValue]) => {\n\t\t\t\t\tDom.attr(element, attrKey, attrValue);\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t}\n}","import Type from './type';\nimport Dom from './dom';\n\nconst UA = navigator.userAgent.toLowerCase();\n\n/**\n * @memberOf BX\n */\nexport default class Browser\n{\n\tstatic isOpera()\n\t{\n\t\treturn UA.includes('opera');\n\t}\n\n\tstatic isIE()\n\t{\n\t\treturn ('attachEvent' in document) && !Browser.isOpera();\n\t}\n\n\tstatic isIE6()\n\t{\n\t\treturn UA.includes('msie 6');\n\t}\n\n\tstatic isIE7()\n\t{\n\t\treturn UA.includes('msie 7');\n\t}\n\n\tstatic isIE8()\n\t{\n\t\treturn UA.includes('msie 8');\n\t}\n\n\tstatic isIE9()\n\t{\n\t\treturn ('documentMode' in document) && document.documentMode >= 9;\n\t}\n\n\tstatic isIE10()\n\t{\n\t\treturn ('documentMode' in document) && document.documentMode >= 10;\n\t}\n\n\tstatic isSafari()\n\t{\n\t\treturn UA.includes('webkit');\n\t}\n\n\tstatic isFirefox()\n\t{\n\t\treturn UA.includes('firefox');\n\t}\n\n\tstatic isChrome()\n\t{\n\t\treturn UA.includes('chrome');\n\t}\n\n\tstatic detectIEVersion()\n\t{\n\t\tif (Browser.isOpera() || Browser.isSafari() || Browser.isFirefox() || Browser.isChrome())\n\t\t{\n\t\t\treturn -1;\n\t\t}\n\n\t\tlet rv = -1;\n\n\t\tif (\n\t\t\t!!(window.MSStream)\n\t\t\t&& !(window.ActiveXObject)\n\t\t\t&& ('ActiveXObject' in window)\n\t\t)\n\t\t{\n\t\t\trv = 11;\n\t\t}\n\t\telse if (Browser.isIE10())\n\t\t{\n\t\t\trv = 10;\n\t\t}\n\t\telse if (Browser.isIE9())\n\t\t{\n\t\t\trv = 9;\n\t\t}\n\t\telse if (Browser.isIE())\n\t\t{\n\t\t\trv = 8;\n\t\t}\n\n\t\tif (rv === -1 || rv === 8)\n\t\t{\n\t\t\tif (navigator.appName === 'Microsoft Internet Explorer')\n\t\t\t{\n\t\t\t\tconst re = new RegExp('MSIE ([0-9]+[.0-9]*)');\n\t\t\t\tconst res = navigator.userAgent.match(re);\n\n\t\t\t\tif (Type.isArrayLike(res) && res.length > 0)\n\t\t\t\t{\n\t\t\t\t\trv = parseFloat(res[1]);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (navigator.appName === 'Netscape')\n\t\t\t{\n\t\t\t\t// Alternative check for IE 11\n\t\t\t\trv = 11;\n\t\t\t\tconst re = new RegExp('Trident/.*rv:([0-9]+[.0-9]*)');\n\n\t\t\t\tif (re.exec(navigator.userAgent) != null)\n\t\t\t\t{\n\t\t\t\t\tconst res = navigator.userAgent.match(re);\n\n\t\t\t\t\tif (Type.isArrayLike(res) && res.length > 0)\n\t\t\t\t\t{\n\t\t\t\t\t\trv = parseFloat(res[1]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn rv;\n\t}\n\n\tstatic isIE11()\n\t{\n\t\treturn Browser.detectIEVersion() >= 11;\n\t}\n\n\tstatic isMac()\n\t{\n\t\treturn UA.includes('macintosh');\n\t}\n\n\tstatic isAndroid()\n\t{\n\t\treturn UA.includes('android');\n\t}\n\n\tstatic isIPad()\n\t{\n\t\treturn UA.includes('ipad;');\n\t}\n\n\tstatic isIPhone()\n\t{\n\t\treturn UA.includes('iphone;');\n\t}\n\n\tstatic isIOS()\n\t{\n\t\treturn Browser.isIPad() || Browser.isIPhone();\n\t}\n\n\tstatic isMobile()\n\t{\n\t\treturn (\n\t\t\tBrowser.isIPhone()\n\t\t\t|| Browser.isIPad()\n\t\t\t|| Browser.isAndroid()\n\t\t\t|| UA.includes('mobile')\n\t\t\t|| UA.includes('touch')\n\t\t);\n\t}\n\n\tstatic isRetina()\n\t{\n\t\treturn window.devicePixelRatio && window.devicePixelRatio >= 2;\n\t}\n\n\tstatic isDoctype(target: any)\n\t{\n\t\tconst doc = target || document;\n\n\t\tif (doc.compatMode)\n\t\t{\n\t\t\treturn (doc.compatMode === 'CSS1Compat');\n\t\t}\n\n\t\treturn (doc.documentElement && doc.documentElement.clientHeight);\n\t}\n\n\tstatic isLocalStorageSupported()\n\t{\n\t\ttry\n\t\t{\n\t\t\tlocalStorage.setItem('test', 'test');\n\t\t\tlocalStorage.removeItem('test');\n\t\t\treturn true;\n\t\t}\n\t\tcatch (e)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\t}\n\n\tstatic addGlobalClass()\n\t{\n\t\tlet globalClass = 'bx-core';\n\n\t\tif (Dom.hasClass(document.documentElement, globalClass))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (Browser.isIOS())\n\t\t{\n\t\t\tglobalClass += ' bx-ios';\n\t\t}\n\t\telse if (Browser.isMac())\n\t\t{\n\t\t\tglobalClass += ' bx-mac';\n\t\t}\n\t\telse if (Browser.isAndroid())\n\t\t{\n\t\t\tglobalClass += ' bx-android';\n\t\t}\n\n\t\tglobalClass += (Browser.isMobile() ? ' bx-touch' : ' bx-no-touch');\n\t\tglobalClass += (Browser.isRetina() ? ' bx-retina' : ' bx-no-retina');\n\n\t\tlet ieVersion = -1;\n\n\t\tif (/AppleWebKit/.test(navigator.userAgent))\n\t\t{\n\t\t\tglobalClass += ' bx-chrome';\n\t\t}\n\t\telse if (Browser.detectIEVersion() > 0)\n\t\t{\n\t\t\tieVersion = Browser.detectIEVersion();\n\t\t\tglobalClass += ` bx-ie bx-ie${ieVersion}`;\n\n\t\t\tif (ieVersion > 7 && ieVersion < 10 && !Browser.isDoctype())\n\t\t\t{\n\t\t\t\tglobalClass += ' bx-quirks';\n\t\t\t}\n\t\t}\n\t\telse if (/Opera/.test(navigator.userAgent))\n\t\t{\n\t\t\tglobalClass += ' bx-opera';\n\t\t}\n\t\telse if (/Gecko/.test(navigator.userAgent))\n\t\t{\n\t\t\tglobalClass += ' bx-firefox';\n\t\t}\n\n\t\tDom.addClass(document.documentElement, globalClass);\n\t}\n\n\tstatic detectAndroidVersion()\n\t{\n\t\tconst re = new RegExp('Android ([0-9]+[.0-9]*)');\n\n\t\tif (re.exec(navigator.userAgent) != null)\n\t\t{\n\t\t\tconst res = navigator.userAgent.match(re);\n\n\t\t\tif (Type.isArrayLike(res) && res.length > 0)\n\t\t\t{\n\t\t\t\treturn parseFloat(res[1]);\n\t\t\t}\n\t\t}\n\n\t\treturn 0;\n\t}\n\n\tstatic isPropertySupported(jsProperty: any, returnCSSName: any)\n\t{\n\t\tif (jsProperty === '')\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tfunction getCssName(propertyName)\n\t\t{\n\t\t\treturn propertyName.replace(/([A-Z])/g, (...args) => `-${args[1].toLowerCase()}`);\n\t\t}\n\n\t\tfunction getJsName(cssName)\n\t\t{\n\t\t\tconst reg = /(\\\\-([a-z]))/g;\n\n\t\t\tif (reg.test(cssName))\n\t\t\t{\n\t\t\t\treturn cssName.replace(reg, (...args) => args[2].toUpperCase());\n\t\t\t}\n\n\t\t\treturn cssName;\n\t\t}\n\n\t\tconst property = jsProperty.includes('-') ? getJsName(jsProperty) : jsProperty;\n\t\tconst bReturnCSSName = !!returnCSSName;\n\t\tconst ucProperty = property.charAt(0).toUpperCase() + property.slice(1);\n\t\tconst props = ['Webkit', 'Moz', 'O', 'ms'].join(`${ucProperty} `);\n\t\tconst properties = `${property} ${props} ${ucProperty}`.split(' ');\n\n\t\tconst obj = document.body || document.documentElement;\n\n\t\tfor (let i = 0; i < properties.length; i += 1)\n\t\t{\n\t\t\tconst prop = properties[i];\n\n\t\t\tif (obj && 'style' in obj && prop in obj.style)\n\t\t\t{\n\t\t\t\tconst lowerProp = prop.substr(0, prop.length - property.length).toLowerCase();\n\t\t\t\tconst prefix = prop === property ? '' : `-${lowerProp}-`;\n\t\t\t\treturn bReturnCSSName ? prefix + getCssName(property) : prop;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tstatic addGlobalFeatures(features: any)\n\t{\n\t\tif (!Type.isArray(features))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst classNames = [];\n\n\t\tfor (let i = 0; i < features.length; i += 1)\n\t\t{\n\t\t\tconst support = !!Browser.isPropertySupported(features[i]);\n\t\t\tclassNames.push(`bx-${(support ? '' : 'no-')}${features[i].toLowerCase()}`);\n\t\t}\n\n\t\tDom.addClass(document.documentElement, classNames.join(' '));\n\t}\n}","import Type from '../type';\n\nexport default class Cookie\n{\n\t/**\n\t * Gets cookies list for current domain\n\t * @return {object}\n\t */\n\tstatic getList(): {[key: string]: string}\n\t{\n\t\treturn document.cookie\n\t\t\t.split(';')\n\t\t\t.map(item => item.split('='))\n\t\t\t.map(item => item.map(subItem => subItem.trim()))\n\t\t\t.reduce((acc, item) => {\n\t\t\t\tconst [key, value] = item;\n\t\t\t\tacc[decodeURIComponent(key)] = (\n\t\t\t\t\tdecodeURIComponent(value)\n\t\t\t\t);\n\t\t\t\treturn acc;\n\t\t\t}, {});\n\t}\n\n\t/**\n\t * Gets cookie value\n\t * @param {string} name\n\t * @return {*}\n\t */\n\tstatic get(name)\n\t{\n\t\tconst cookiesList = Cookie.getList();\n\n\t\tif (name in cookiesList)\n\t\t{\n\t\t\treturn cookiesList[name];\n\t\t}\n\n\t\treturn undefined;\n\t}\n\n\t/**\n\t * Sets cookie\n\t * @param {string} name\n\t * @param {*} value\n\t * @param {object} [options]\n\t */\n\tstatic set(name, value, options = {})\n\t{\n\t\tconst attributes = {\n\t\t\texpires: '',\n\t\t\t...options,\n\t\t};\n\n\t\tif (Type.isNumber(attributes.expires))\n\t\t{\n\t\t\tconst now = (+new Date());\n\t\t\tconst days = attributes.expires;\n\t\t\tconst dayInMs = 864e+5;\n\t\t\tattributes.expires = new Date(now + days * dayInMs);\n\t\t}\n\n\t\tif (Type.isDate(attributes.expires))\n\t\t{\n\t\t\tattributes.expires = attributes.expires.toUTCString();\n\t\t}\n\n\t\tconst safeName = decodeURIComponent(String(name))\n\t\t\t.replace(/%(23|24|26|2B|5E|60|7C)/g, decodeURIComponent)\n\t\t\t.replace(/[()]/g, escape);\n\n\t\tconst safeValue = encodeURIComponent(String(value))\n\t\t\t.replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g, decodeURIComponent);\n\n\t\tconst stringifiedAttributes = Object.keys(attributes)\n\t\t\t.reduce((acc, key) => {\n\t\t\t\tconst attributeValue = attributes[key];\n\n\t\t\t\tif (!attributeValue)\n\t\t\t\t{\n\t\t\t\t\treturn acc;\n\t\t\t\t}\n\n\t\t\t\tif (attributeValue === true)\n\t\t\t\t{\n\t\t\t\t\treturn `${acc}; ${key}`;\n\t\t\t\t}\n\n\t\t\t\t/**\n\t\t\t\t * Considers RFC 6265 section 5.2:\n\t\t\t\t * ...\n\t\t\t\t * 3. If the remaining unparsed-attributes contains a %x3B (';')\n\t\t\t\t * character:\n\t\t\t\t * Consume the characters of the unparsed-attributes up to,\n\t\t\t\t * not including, the first %x3B (';') character.\n\t\t\t\t */\n\t\t\t\treturn `${acc}; ${key}=${attributeValue.split(';')[0]}`;\n\t\t\t}, '');\n\n\t\tdocument.cookie = `${safeName}=${safeValue}${stringifiedAttributes}`;\n\t}\n\n\t/**\n\t * Removes cookie\n\t * @param {string} name\n\t * @param {object} [options]\n\t */\n\tstatic remove(name, options = {})\n\t{\n\t\tCookie.set(name, '', {...options, expires: -1});\n\t}\n}","import Type from '../../type';\n\nexport default function objectToFormData(\n\tsource: {[key: string]: any},\n\tformData: FormData = new FormData(),\n\tpre = null,\n)\n{\n\tif (Type.isUndefined(source))\n\t{\n\t\treturn formData;\n\t}\n\n\tif (Type.isNull(source))\n\t{\n\t\tformData.append(pre, '');\n\t}\n\telse if (Type.isArray(source))\n\t{\n\t\tif (!source.length)\n\t\t{\n\t\t\tconst key = `${pre}[]`;\n\t\t\tformData.append(key, '');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tsource.forEach((value, index) => {\n\t\t\t\tconst key = `${pre}[${index}]`;\n\t\t\t\tobjectToFormData(value, formData, key);\n\t\t\t});\n\t\t}\n\t}\n\telse if (Type.isDate(source))\n\t{\n\t\tformData.append(pre, source.toISOString());\n\t}\n\telse if (Type.isObject(source) && !Type.isFile(source) && !Type.isBlob(source))\n\t{\n\t\tObject.keys(source).forEach((property) => {\n\t\t\tconst value = source[property];\n\t\t\tlet preparedProperty = property;\n\n\t\t\tif (Type.isArray(value))\n\t\t\t{\n\t\t\t\twhile (property.length > 2 && property.lastIndexOf('[]') === property.length - 2)\n\t\t\t\t{\n\t\t\t\t\tpreparedProperty = property.substring(0, property.length - 2);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst key = pre ? `${pre}[${preparedProperty}]` : preparedProperty;\n\t\t\tobjectToFormData(value, formData, key);\n\t\t});\n\t}\n\telse\n\t{\n\t\tformData.append(pre, source);\n\t}\n\n\treturn formData;\n}","import objectToFormData from './internal/convert-object-to-form-data';\n\nexport default class Data\n{\n\t/**\n\t * Converts object to FormData\n\t * @param source\n\t * @return {FormData}\n\t */\n\tstatic convertObjectToFormData(source: {[key: string]: any}): FormData\n\t{\n\t\treturn objectToFormData(source);\n\t}\n}","import Cookie from './http/cookie';\nimport Data from './http/data';\n\n/**\n * @memberOf BX\n */\nexport default class Http\n{\n\tstatic Cookie = Cookie;\n\tstatic Data = Data;\n}","import Type from '../type';\nimport Runtime from '../runtime';\nimport EventEmitter from '../event/event-emitter';\nimport BaseEvent from '../event/base-event';\n\ntype messageParam = string | {[key: string]: string | number};\n\nexport default function message(value: messageParam): string | boolean | void\n{\n\tif (Type.isString(value))\n\t{\n\t\tif (Type.isNil(message[value]))\n\t\t{\n\t\t\t// eslint-disable-next-line\n\t\t\tEventEmitter.emit('onBXMessageNotFound', new BaseEvent({ compatData: [value] }));\n\n\t\t\tif (Type.isNil(message[value]))\n\t\t\t{\n\t\t\t\tRuntime.debug(`message undefined: ${value}`);\n\t\t\t\tmessage[value] = '';\n\t\t\t}\n\t\t}\n\t}\n\n\tif (Type.isPlainObject(value))\n\t{\n\t\tObject.keys(value).forEach((key) => {\n\t\t\tmessage[key] = value[key];\n\t\t});\n\t}\n\n\treturn message[value];\n}\n\nif (\n\t!Type.isNil(window.BX)\n\t&& Type.isFunction(window.BX.message)\n)\n{\n\tObject.keys(window.BX.message).forEach((key) => {\n\t\tmessage({[key]: window.BX.message[key]});\n\t});\n}","import Type from './type';\nimport message from './loc/message';\n\n/**\n * Implements interface for works with language messages\n * @memberOf BX\n */\nexport default class Loc\n{\n\t/**\n\t * Gets message by id\n\t * @param {string} messageId\n\t * @return {?string}\n\t */\n\tstatic getMessage(messageId: string): ?string\n\t{\n\t\treturn message(messageId);\n\t}\n\n\t/**\n\t * Sets message or messages\n\t * @param {string | Object<string, string>} id\n\t * @param {string} [value]\n\t */\n\tstatic setMessage(id: string | {[key: string]: string}, value?: string)\n\t{\n\t\tif (Type.isString(id) && Type.isString(value))\n\t\t{\n\t\t\tmessage({[id]: value});\n\t\t}\n\n\t\tif (Type.isObject(id))\n\t\t{\n\t\t\tmessage(id);\n\t\t}\n\t}\n}","import Type from '../type';\nimport Dom from '../dom';\nimport Event from '../event';\n\ntype renderResult = HTMLDocument | HTMLElement | Element;\n\nconst handlers = new Map();\nconst children = new Map();\nconst getUid = (() => {\n\tlet incremental = 0;\n\treturn () => {\n\t\tincremental += 1;\n\t\treturn incremental;\n\t};\n})();\n\nfunction bindAll(element, handlersMap: Map)\n{\n\thandlersMap.forEach((handler, key) => {\n\t\tconst currentElement = element.querySelector(`[${key}]`);\n\n\t\tif (currentElement)\n\t\t{\n\t\t\tcurrentElement.removeAttribute(key);\n\t\t\tconst event = key.replace(/-(.*)/, '');\n\t\t\tEvent.bind(currentElement, event, handler);\n\t\t\thandlers.delete(key);\n\t\t}\n\t});\n}\n\nfunction replaceChild(element, childrenMap: Map)\n{\n\tchildrenMap.forEach((item, id) => {\n\t\tconst currentElement = element.getElementById(id);\n\n\t\tif (currentElement)\n\t\t{\n\t\t\tDom.replace(currentElement, item);\n\t\t\tchildren.delete(id);\n\t\t}\n\t});\n}\n\nexport default function render(sections: string[], ...substitutions: string[]): renderResult\n{\n\tconst eventAttrRe = /[ |\\t]on(\\w+)=\"$/;\n\tconst uselessSymbolsRe = /[\\r\\n\\t]/g;\n\n\tconst html = substitutions\n\t\t.reduce((acc, item, index) => {\n\t\t\tlet preparedAcc = acc;\n\n\t\t\t// Process event handlers\n\t\t\tconst matches = acc.match(eventAttrRe);\n\n\t\t\tif (matches && Type.isFunction(item))\n\t\t\t{\n\t\t\t\tconst eventName = matches[1].replace(/=['|\"]/, '');\n\t\t\t\tconst attrName = `${eventName}-${getUid()}`;\n\t\t\t\tconst attribute = `${attrName}=\"`;\n\t\t\t\tpreparedAcc = preparedAcc.replace(eventAttrRe, ` ${attribute}`);\n\t\t\t\thandlers.set(attrName, item);\n\t\t\t\tpreparedAcc += (\n\t\t\t\t\tsections[index + 1]\n\t\t\t\t\t\t.replace(uselessSymbolsRe, ' ')\n\t\t\t\t\t\t.replace(/  +/g, ' ')\n\t\t\t\t);\n\t\t\t\treturn preparedAcc;\n\t\t\t}\n\n\t\t\t// Process element\n\t\t\tif (Type.isDomNode(item))\n\t\t\t{\n\t\t\t\tconst childKey = `tmp___${getUid()}`;\n\t\t\t\tchildren.set(childKey, item);\n\t\t\t\tpreparedAcc += `<span id=\"${childKey}\"> </span>`;\n\t\t\t\tpreparedAcc += sections[index + 1];\n\t\t\t\treturn preparedAcc;\n\t\t\t}\n\n\t\t\t// Process array\n\t\t\tif (Type.isArray(item))\n\t\t\t{\n\t\t\t\t[...item].forEach((currentElement) => {\n\t\t\t\t\tif (Type.isDomNode(currentElement))\n\t\t\t\t\t{\n\t\t\t\t\t\tconst childKey = `tmp___${getUid()}`;\n\t\t\t\t\t\tchildren.set(childKey, currentElement);\n\t\t\t\t\t\tpreparedAcc += `<span id=\"${childKey}\"> </span>`;\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tpreparedAcc += sections[index + 1];\n\n\t\t\t\treturn preparedAcc;\n\t\t\t}\n\n\t\t\treturn preparedAcc + item + sections[index + 1];\n\t\t}, sections[0]);\n\n\tconst lowercaseHtml = html.trim().toLowerCase();\n\tif (\n\t\tlowercaseHtml.startsWith('<!doctype')\n\t\t|| lowercaseHtml.startsWith('<html')\n\t)\n\t{\n\t\tconst doc = document.implementation.createHTMLDocument('');\n\t\tdoc.documentElement.innerHTML = html;\n\t\treplaceChild(doc, children);\n\t\tbindAll(doc, handlers);\n\t\thandlers.clear();\n\t\treturn doc;\n\t}\n\n\tconst parser = new DOMParser();\n\tconst parsedDocument = parser.parseFromString(html, 'text/html');\n\n\treplaceChild(parsedDocument, children);\n\tbindAll(parsedDocument, handlers);\n\n\tif (\n\t\tparsedDocument.head.children.length\n\t\t&& parsedDocument.body.children.length\n\t)\n\t{\n\t\treturn parsedDocument;\n\t}\n\n\tif (parsedDocument.body.children.length === 1)\n\t{\n\t\tconst [el] = parsedDocument.body.children;\n\t\tDom.remove(el);\n\t\treturn el;\n\t}\n\n\tif (parsedDocument.body.children.length > 1)\n\t{\n\t\treturn [...parsedDocument.body.children].map((item) => {\n\t\t\tDom.remove(item);\n\t\t\treturn item;\n\t\t});\n\t}\n\n\tif (parsedDocument.body.children.length === 0)\n\t{\n\t\tif (parsedDocument.head.children.length === 1)\n\t\t{\n\t\t\tconst [el] = parsedDocument.head.children;\n\t\t\tDom.remove(el);\n\t\t\treturn el;\n\t\t}\n\n\t\tif (parsedDocument.head.children.length > 1)\n\t\t{\n\t\t\treturn [...parsedDocument.head.children].map((item) => {\n\t\t\t\tDom.remove(item);\n\t\t\t\treturn item;\n\t\t\t});\n\t\t}\n\t}\n\n\treturn false;\n}","import Type from './type';\nimport Dom from './dom';\nimport Loc from './loc';\nimport Text from './text';\nimport render from './tag/render';\n\nfunction parseProps(sections: string[], ...substitutions: string[]): {[key: string]: string}\n{\n\treturn substitutions\n\t\t.reduce((acc, item, index) => {\n\t\t\tconst nextSectionIndex = index + 1;\n\n\t\t\tif (!Type.isPlainObject(item) && !Type.isArray(item))\n\t\t\t{\n\t\t\t\treturn acc + item + sections[nextSectionIndex];\n\t\t\t}\n\n\t\t\treturn `${acc}__s${index}${sections[nextSectionIndex]}`;\n\t\t}, sections[0])\n\t\t.replace(/[\\r\\t]/gm, '')\n\t\t.split(';\\n')\n\t\t.map(item => item.replace(/\\n/, ''))\n\t\t.reduce((acc, item) => {\n\t\t\tif (item !== '')\n\t\t\t{\n\t\t\t\tconst matches = item.match(/^[\\w-. ]+:/);\n\t\t\t\tconst splitted = item.split(/^[\\w-. ]+:/);\n\t\t\t\tconst key = matches[0].replace(':', '').trim();\n\t\t\t\tconst value = splitted[1].trim();\n\t\t\t\tconst substitutionPlaceholderExp = /^__s\\d+/;\n\n\t\t\t\tif (substitutionPlaceholderExp.test(value))\n\t\t\t\t{\n\t\t\t\t\tacc[key] = substitutions[value.replace('__s', '')];\n\t\t\t\t\treturn acc;\n\t\t\t\t}\n\n\t\t\t\tacc[key] = value;\n\t\t\t}\n\n\t\t\treturn acc;\n\t\t}, {});\n}\n\n/**\n * @memberOf BX\n */\nexport default class Tag\n{\n\t/**\n\t * Encodes all substitutions\n\t * @param sections\n\t * @param substitutions\n\t * @return {string}\n\t */\n\tstatic safe(sections: string[], ...substitutions: string[])\n\t{\n\t\treturn substitutions.reduce((acc, item, index) => (\n\t\t\tacc + Text.encode(item) + sections[index + 1]\n\t\t), sections[0]);\n\t}\n\n\t/**\n\t * Decodes all substitutions\n\t * @param sections\n\t * @param substitutions\n\t * @return {string}\n\t */\n\tstatic unsafe(sections, ...substitutions)\n\t{\n\t\treturn substitutions.reduce((acc, item, index) => (\n\t\t\tacc + Text.decode(item) + sections[index + 1]\n\t\t), sections[0]);\n\t}\n\n\t/**\n\t * Adds styles to specified element\n\t * @param {HTMLElement} element\n\t * @return {Function}\n\t */\n\tstatic style(element: HTMLElement): Function\n\t{\n\t\tif (!Type.isDomNode(element))\n\t\t{\n\t\t\tthrow new Error('element is not HTMLElement');\n\t\t}\n\n\t\treturn function styleTagHandler(...args) {\n\t\t\tDom.style(element, parseProps(...args));\n\t\t};\n\t}\n\n\t/**\n\t * Replace all messages identifiers to real messages\n\t * @param sections\n\t * @param substitutions\n\t * @return {string}\n\t */\n\tstatic message(sections: string[], ...substitutions: string[]): string\n\t{\n\t\treturn substitutions.reduce((acc, item, index) => (\n\t\t\tacc + Loc.getMessage(item) + sections[index + 1]\n\t\t), sections[0]);\n\t}\n\n\tstatic render = render;\n\n\t/**\n\t * Adds attributes to specified element\n\t * @param element\n\t * @return {Function}\n\t */\n\tstatic attrs(element: HTMLElement)\n\t{\n\t\tif (!Type.isDomNode(element))\n\t\t{\n\t\t\tthrow new Error('element is not HTMLElement');\n\t\t}\n\n\t\treturn function attrsTagHandler(...args): string {\n\t\t\tDom.attr(element, parseProps(...args));\n\t\t};\n\t}\n\n\tstatic attr = Tag.attrs;\n}","import Type from '../type';\n\nfunction getParser(format)\n{\n\tswitch (format)\n\t{\n\t\tcase 'index':\n\t\t\treturn (sourceKey, value, accumulator) => {\n\t\t\t\tconst result = /\\[(\\w*)\\]$/.exec(sourceKey);\n\t\t\t\tconst key = sourceKey.replace(/\\[\\w*\\]$/, '');\n\n\t\t\t\tif (Type.isNil(result))\n\t\t\t\t{\n\t\t\t\t\taccumulator[key] = value;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (Type.isUndefined(accumulator[key]))\n\t\t\t\t{\n\t\t\t\t\taccumulator[key] = {};\n\t\t\t\t}\n\n\t\t\t\taccumulator[key][result[1]] = value;\n\t\t\t};\n\t\tcase 'bracket':\n\t\t\treturn (sourceKey, value, accumulator) => {\n\t\t\t\tconst result = /(\\[\\])$/.exec(sourceKey);\n\t\t\t\tconst key = sourceKey.replace(/\\[\\]$/, '');\n\n\t\t\t\tif (Type.isNil(result))\n\t\t\t\t{\n\t\t\t\t\taccumulator[key] = value;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (Type.isUndefined(accumulator[key]))\n\t\t\t\t{\n\t\t\t\t\taccumulator[key] = [value];\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\taccumulator[key] = [].concat(accumulator[key], value);\n\t\t\t};\n\t\tdefault:\n\t\t\treturn (sourceKey, value, accumulator) => {\n\t\t\t\tconst key = sourceKey.replace(/\\[\\]$/, '');\n\t\t\t\taccumulator[key] = value;\n\t\t\t};\n\t}\n}\n\nfunction getKeyFormat(key)\n{\n\tif (/^\\w+\\[([\\w]+)\\]$/.test(key))\n\t{\n\t\treturn 'index';\n\t}\n\n\tif (/^\\w+\\[\\]$/.test(key))\n\t{\n\t\treturn 'bracket';\n\t}\n\n\treturn 'default';\n}\n\nfunction parseQuery(input)\n{\n\tif (!Type.isString(input))\n\t{\n\t\treturn {};\n\t}\n\n\tconst url = input.trim().replace(/^[?#&]/, '');\n\n\tif (!url)\n\t{\n\t\treturn {};\n\t}\n\n\treturn url.split('&')\n\t\t.reduce((acc, param) => {\n\t\t\tconst [key, value] = param.replace(/\\+/g, ' ').split('=');\n\t\t\tconst keyFormat = getKeyFormat(key);\n\t\t\tconst formatter = getParser(keyFormat);\n\t\t\tformatter(key, value, acc);\n\t\t\treturn acc;\n\t\t}, {});\n}\n\nconst urlExp = /^((\\w+):)?(\\/\\/((\\w+)?(:(\\w+))?@)?([^\\/\\?:]+)(:(\\d+))?)?(\\/?([^\\/\\?#][^\\?#]*)?)?(\\?([^#]+))?(#(\\w*))?/;\n\nexport default function parseUrl(url)\n{\n\tconst result = url.match(urlExp);\n\n\tif (Type.isArray(result))\n\t{\n\t\tconst queryParams = parseQuery(result[14]);\n\n\t\treturn {\n\t\t\tuseShort: /^\\/\\//.test(url),\n\t\t\thref: result[0] || '',\n\t\t\tschema: result[2] || '',\n\t\t\thost: result[8] || '',\n\t\t\tport: result[10] || '',\n\t\t\tpath: result[11] || '',\n\t\t\tquery: result[14] || '',\n\t\t\tqueryParams,\n\t\t\thash: result[16] || '',\n\t\t\tusername: result[5] || '',\n\t\t\tpassword: result[7] || '',\n\t\t\torigin: result[8] || '',\n\t\t};\n\t}\n\n\treturn {};\n}","import Type from '../type';\n\nexport default function buildQueryString(params = {})\n{\n\tconst queryString = Object.keys(params)\n\t\t.reduce((acc, key) => {\n\t\t\tif (Type.isArray(params[key]))\n\t\t\t{\n\t\t\t\tparams[key].forEach((paramValue) => {\n\t\t\t\t\tacc.push(`${key}[]=${paramValue}`);\n\t\t\t\t}, '');\n\t\t\t}\n\n\t\t\tif (Type.isPlainObject(params[key]))\n\t\t\t{\n\t\t\t\tObject.keys(params[key]).forEach((paramIndex) => {\n\t\t\t\t\tacc.push(`${key}[${paramIndex}]=${params[key][paramIndex]}`);\n\t\t\t\t}, '');\n\t\t\t}\n\n\t\t\tif (!Type.isObject(params[key]) && !Type.isArray(params[key]))\n\t\t\t{\n\t\t\t\tacc.push(`${key}=${params[key]}`);\n\t\t\t}\n\n\t\t\treturn acc;\n\t\t}, []).join('&');\n\n\tif (queryString.length > 0)\n\t{\n\t\treturn `?${queryString}`;\n\t}\n\n\treturn queryString;\n}","import Type from '../type';\n\nexport default function prepareParamValue(value)\n{\n\tif (Type.isArray(value))\n\t{\n\t\treturn value.map(item => String(item));\n\t}\n\n\tif (Type.isPlainObject(value))\n\t{\n\t\treturn {...value};\n\t}\n\n\treturn String(value);\n}","import parseUrl from './uri/parse-url';\nimport buildQueryString from './uri/build-query-string';\nimport prepareParamValue from './uri/prepare-param-value';\nimport Type from './type';\n\nconst map = new WeakMap();\n\n/**\n * Implements interface for works with URI\n * @memberOf BX\n */\nexport default class Uri\n{\n\tstatic addParam(url: string, params = {}): string\n\t{\n\t\treturn (new Uri(url)).setQueryParams(params).toString();\n\t}\n\n\tstatic removeParam(url: string, params: Array<string> | string): string\n\t{\n\t\tconst removableParams = Type.isArray(params) ? params : [params];\n\t\treturn (new Uri(url)).removeQueryParam(...removableParams).toString();\n\t}\n\n\tconstructor(url = '')\n\t{\n\t\tmap.set(this, parseUrl(url));\n\t}\n\n\t/**\n\t * Gets schema\n\t * @return {?string}\n\t */\n\tgetSchema()\n\t{\n\t\treturn map.get(this).schema;\n\t}\n\n\t/**\n\t * Sets schema\n\t * @param {string} schema\n\t * @return {Uri}\n\t */\n\tsetSchema(schema)\n\t{\n\t\tmap.get(this).schema = String(schema);\n\t\treturn this;\n\t}\n\n\t/**\n\t * Gets host\n\t * @return {?string}\n\t */\n\tgetHost()\n\t{\n\t\treturn map.get(this).host;\n\t}\n\n\t/**\n\t * Sets host\n\t * @param {string} host\n\t * @return {Uri}\n\t */\n\tsetHost(host)\n\t{\n\t\tmap.get(this).host = String(host);\n\t\treturn this;\n\t}\n\n\t/**\n\t * Gets port\n\t * @return {?string}\n\t */\n\tgetPort()\n\t{\n\t\treturn map.get(this).port;\n\t}\n\n\t/**\n\t * Sets port\n\t * @param {String | Number} port\n\t * @return {Uri}\n\t */\n\tsetPort(port)\n\t{\n\t\tmap.get(this).port = String(port);\n\t\treturn this;\n\t}\n\n\t/**\n\t * Gets path\n\t * @return {?string}\n\t */\n\tgetPath()\n\t{\n\t\treturn map.get(this).path;\n\t}\n\n\t/**\n\t * Sets path\n\t * @param {string} path\n\t * @return {Uri}\n\t */\n\tsetPath(path)\n\t{\n\t\tif (!/^\\//.test(path))\n\t\t{\n\t\t\tmap.get(this).path = `/${String(path)}`;\n\t\t\treturn this;\n\t\t}\n\n\t\tmap.get(this).path = String(path);\n\t\treturn this;\n\t}\n\n\t/**\n\t * Gets query\n\t * @return {?string}\n\t */\n\tgetQuery()\n\t{\n\t\treturn buildQueryString(map.get(this).queryParams);\n\t}\n\n\t/**\n\t * Gets query param value by name\n\t * @param {string} key\n\t * @return {?string}\n\t */\n\tgetQueryParam(key)\n\t{\n\t\tconst params = this.getQueryParams();\n\n\t\tif (key in params)\n\t\t{\n\t\t\treturn params[key];\n\t\t}\n\n\t\treturn null;\n\t}\n\n\t/**\n\t * Sets query param\n\t * @param {string} key\n\t * @param [value]\n\t * @return {Uri}\n\t */\n\tsetQueryParam(key, value = '')\n\t{\n\t\tmap.get(this).queryParams[key] = prepareParamValue(value);\n\t\treturn this;\n\t}\n\n\t/**\n\t * Gets query params\n\t * @return {Object<string, any>}\n\t */\n\tgetQueryParams()\n\t{\n\t\treturn {...map.get(this).queryParams};\n\t}\n\n\t/**\n\t * Sets query params\n\t * @param {Object<string, any>} params\n\t * @return {Uri}\n\t */\n\tsetQueryParams(params = {})\n\t{\n\t\tconst currentParams = this.getQueryParams();\n\t\tconst newParams = {...currentParams, ...params};\n\n\t\tObject.keys(newParams).forEach((key) => {\n\t\t\tnewParams[key] = prepareParamValue(newParams[key]);\n\t\t});\n\n\t\tmap.get(this).queryParams = newParams;\n\t\treturn this;\n\t}\n\n\t/**\n\t * Removes query params by name\n\t * @param keys\n\t * @return {Uri}\n\t */\n\tremoveQueryParam(...keys)\n\t{\n\t\tconst currentParams = {...map.get(this).queryParams};\n\n\t\tkeys.forEach((key) => {\n\t\t\tif (key in currentParams)\n\t\t\t{\n\t\t\t\tdelete currentParams[key];\n\t\t\t}\n\t\t});\n\n\t\tmap.get(this).queryParams = currentParams;\n\t\treturn this;\n\t}\n\n\t/**\n\t * Gets fragment\n\t * @return {?string}\n\t */\n\tgetFragment()\n\t{\n\t\treturn map.get(this).hash;\n\t}\n\n\t/**\n\t * Sets fragment\n\t * @param {string} hash\n\t * @return {Uri}\n\t */\n\tsetFragment(hash)\n\t{\n\t\tmap.get(this).hash = String(hash);\n\t\treturn this;\n\t}\n\n\t/**\n\t * Serializes URI\n\t * @return {Object}\n\t */\n\tserialize()\n\t{\n\t\tconst serialized = {...map.get(this)};\n\t\tserialized.href = this.toString();\n\t\treturn serialized;\n\t}\n\n\t/**\n\t * Gets URI string\n\t * @return {string}\n\t */\n\ttoString()\n\t{\n\t\tconst data = {...map.get(this)};\n\n\t\tlet protocol = data.schema ? `${data.schema}://` : '';\n\n\t\tif (data.useShort)\n\t\t{\n\t\t\tprotocol = '//';\n\t\t}\n\n\t\tconst port = (() => {\n\t\t\tif (Type.isString(data.port) && !['', '80'].includes(data.port))\n\t\t\t{\n\t\t\t\treturn `:${data.port}`;\n\t\t\t}\n\n\t\t\treturn '';\n\t\t})();\n\n\t\tconst host = this.getHost();\n\t\tconst path = this.getPath();\n\t\tconst query = buildQueryString(data.queryParams);\n\t\tconst hash = data.hash ? `#${data.hash}` : '';\n\n\t\treturn `${host ? protocol : ''}${host}${host ? port : ''}${path}${query}${hash}`;\n\t}\n}\n","/**\n * @memberOf BX\n */\nexport default class Validation\n{\n\t/**\n\t * Checks that value is valid email\n\t * @param value\n\t * @return {boolean}\n\t */\n\tstatic isEmail(value)\n\t{\n\t\tconst exp = /^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;\n\t\treturn exp.test(String(value).toLowerCase());\n\t}\n}","import Type from '../type';\n\nexport default class BaseCache\n{\n\t/**\n\t * @private\n\t */\n\tstorage: Map<string, any> = new Map();\n\n\t/**\n\t * Gets cached value or default value\n\t */\n\tget(key: string, defaultValue?: T | () => T): T\n\t{\n\t\tif (!this.storage.has(key))\n\t\t{\n\t\t\tif (Type.isFunction(defaultValue))\n\t\t\t{\n\t\t\t\treturn defaultValue();\n\t\t\t}\n\n\t\t\tif (!Type.isUndefined(defaultValue))\n\t\t\t{\n\t\t\t\treturn defaultValue;\n\t\t\t}\n\t\t}\n\n\t\treturn this.storage.get(key);\n\t}\n\n\t/**\n\t * Sets cache entry\n\t */\n\tset(key: string, value: any)\n\t{\n\t\tthis.storage.set(key, value);\n\t}\n\n\t/**\n\t * Deletes cache entry\n\t */\n\tdelete(key: string)\n\t{\n\t\tthis.storage.delete(key);\n\t}\n\n\t/**\n\t * Checks that storage contains entry with specified key\n\t */\n\thas(key: string): boolean\n\t{\n\t\treturn this.storage.has(key);\n\t}\n\n\t/**\n\t * Gets cached value if exists,\n\t */\n\tremember(key: string, defaultValue?: T | () => T): T\n\t{\n\t\tif (!this.storage.has(key))\n\t\t{\n\t\t\tif (Type.isFunction(defaultValue))\n\t\t\t{\n\t\t\t\tthis.storage.set(key, defaultValue());\n\t\t\t}\n\t\t\telse if (!Type.isUndefined(defaultValue))\n\t\t\t{\n\t\t\t\tthis.storage.set(key, defaultValue);\n\t\t\t}\n\t\t}\n\n\t\treturn this.storage.get(key);\n\t}\n\n\t/**\n\t * Gets storage size\n\t */\n\tsize(): number\n\t{\n\t\treturn this.storage.size;\n\t}\n\n\t/**\n\t * Gets storage keys\n\t */\n\tkeys(): Array<string>\n\t{\n\t\treturn [...this.storage.keys()];\n\t}\n\n\t/**\n\t * Gets storage values\n\t */\n\tvalues(): Array<any>\n\t{\n\t\treturn [...this.storage.values()];\n\t}\n}","import BaseCache from './base-cache';\nimport MemoryStorage from './storage/memory';\n\nexport default class MemoryCache extends BaseCache\n{\n\t/**\n\t * @private\n\t */\n\tstorage: MemoryStorage = new MemoryStorage();\n}","import type {ICacheStorage} from './i-cache-storage';\nimport Type from '../../type';\n\nexport default class LsStorage implements ICacheStorage\n{\n\tstackKey = 'BX.Cache.Storage.LsStorage.stack';\n\tstack = null;\n\n\t/**\n\t * @private\n\t */\n\tgetStack(): {[key: string]: any}\n\t{\n\t\tif (Type.isPlainObject(this.stack))\n\t\t{\n\t\t\treturn this.stack;\n\t\t}\n\n\t\tconst stack = localStorage.getItem(this.stackKey);\n\n\t\tif (Type.isString(stack) && stack !== '')\n\t\t{\n\t\t\tconst parsedStack = JSON.parse(stack);\n\n\t\t\tif (Type.isPlainObject(parsedStack))\n\t\t\t{\n\t\t\t\tthis.stack = parsedStack;\n\t\t\t\treturn this.stack;\n\t\t\t}\n\t\t}\n\n\t\tthis.stack = {};\n\t\treturn this.stack;\n\t}\n\n\t/**\n\t * @private\n\t */\n\tsaveStack()\n\t{\n\t\tif (Type.isPlainObject(this.stack))\n\t\t{\n\t\t\tconst preparedStack = JSON.stringify(this.stack);\n\t\t\tlocalStorage.setItem(this.stackKey, preparedStack);\n\t\t}\n\t}\n\n\tget(key: string)\n\t{\n\t\tconst stack = this.getStack();\n\t\treturn stack[key];\n\t}\n\n\tset(key: string, value: any)\n\t{\n\t\tconst stack = this.getStack();\n\t\tstack[key] = value;\n\t\tthis.saveStack();\n\t}\n\n\tdelete(key: string)\n\t{\n\t\tconst stack = this.getStack();\n\n\t\tif (key in stack)\n\t\t{\n\t\t\tdelete stack[key];\n\t\t}\n\t}\n\n\thas(key: string): boolean\n\t{\n\t\tconst stack = this.getStack();\n\t\treturn key in stack;\n\t}\n\n\tget size(): number\n\t{\n\t\tconst stack = this.getStack();\n\t\treturn Object.keys(stack).length;\n\t}\n\n\tkeys(): Array<string>\n\t{\n\t\tconst stack = this.getStack();\n\t\treturn Object.keys(stack);\n\t}\n\n\tvalues(): Array<any>\n\t{\n\t\tconst stack = this.getStack();\n\t\treturn Object.values(stack);\n\t}\n}","import BaseCache from './base-cache';\nimport LsCacheStorage from './storage/ls-storage';\n\nexport default class LocalStorageCache extends BaseCache\n{\n\t/**\n\t * @private\n\t */\n\tstorage: LsCacheStorage = new LsCacheStorage();\n}","import MemoryCache from './cache/memory-cache';\nimport LocalStorageCache from './cache/local-storage-cache';\n\n/**\n * @memberOf BX\n */\nexport default class Cache\n{\n\tstatic MemoryCache: MemoryCache = MemoryCache;\n\tstatic LocalStorageCache: LocalStorageCache = LocalStorageCache;\n}","import Type from '../lib/type';\n\nexport default function getElement(element: string | HTMLElement)\n{\n\tif (Type.isString(element))\n\t{\n\t\treturn document.getElementById(element);\n\t}\n\n\treturn element;\n}","import Type from '../lib/type';\n\nexport default function getWindow(element)\n{\n\tif (Type.isElementNode(element))\n\t{\n\t\treturn (\n\t\t\telement.ownerDocument.parentWindow\n\t\t\t|| element.ownerDocument.defaultView\n\t\t\t|| window\n\t\t);\n\t}\n\n\tif (Type.isDomNode(element))\n\t{\n\t\treturn (\n\t\t\telement.parentWindow\n\t\t\t|| element.defaultView\n\t\t\t|| window\n\t\t);\n\t}\n\n\treturn window;\n}","/* eslint-disable prefer-rest-params */\n\nimport Type from './lib/type';\nimport Reflection from './lib/reflection';\nimport Dom from './lib/dom';\nimport Browser from './lib/browser';\nimport Event from './lib/event';\nimport Http from './lib/http';\nimport Runtime from './lib/runtime';\nimport Text from './lib/text';\nimport messageFunction from './lib/loc/message';\nimport * as debugNs from './lib/runtime/debug';\nimport {isReady} from './lib/event/ready';\nimport getElement from './internal/get-element';\nimport getWindow from './internal/get-window';\nimport EventEmitter from './lib/event/event-emitter';\nimport BaseEvent from './lib/event/base-event';\n\n// BX.*\nexport const {getClass, namespace} = Reflection;\nexport const message = messageFunction;\n\n/**\n * @memberOf BX\n */\nexport const {\n\treplace,\n\tremove,\n\tclean,\n\tinsertBefore,\n\tinsertAfter,\n\tappend,\n\tprepend,\n\tstyle,\n\tadjust,\n\tcreate,\n\tisShown,\n} = Dom;\n\nexport const addClass = function addClass() {\n\tDom.addClass(...Runtime.merge([], Array.from(arguments), [getElement(arguments[0])]));\n};\n\nexport const removeClass = function removeClass() {\n\tDom.removeClass(...Runtime.merge(Array.from(arguments), [getElement(arguments[0])]));\n};\n\nexport const hasClass = function hasClass() {\n\treturn Dom.hasClass(...Runtime.merge(Array.from(arguments), [getElement(arguments[0])]));\n};\n\nexport const toggleClass = function toggleClass() {\n\tDom.toggleClass(...Runtime.merge(Array.from(arguments), [getElement(arguments[0])]));\n};\n\nexport const cleanNode = (element, removeElement = false) => {\n\tconst currentElement = getElement(element);\n\n\tif (Type.isDomNode(currentElement))\n\t{\n\t\tDom.clean(currentElement);\n\n\t\tif (removeElement)\n\t\t{\n\t\t\tDom.remove(currentElement);\n\t\t\treturn currentElement;\n\t\t}\n\t}\n\n\treturn currentElement;\n};\n\nexport const getCookie = Http.Cookie.get;\nexport const setCookie = (name, value, options = {}) => {\n\tconst attributes = {...options};\n\n\tif (Type.isNumber(attributes.expires))\n\t{\n\t\tattributes.expires /= (3600 * 24);\n\t}\n\n\tHttp.Cookie.set(name, value, attributes);\n};\n\nexport const {\n\tbind,\n\tunbind,\n\tunbindAll,\n\tbindOnce,\n\tready,\n} = Event;\n\nexport {isReady};\nexport const {\n\tdebugState: debugEnableFlag,\n\tisDebugEnabled: debugStatus,\n\tdefault: debug,\n} = debugNs;\n\nexport const debugEnable = (value) => {\n\tif (value)\n\t{\n\t\tdebugNs.enableDebug();\n\t}\n\telse\n\t{\n\t\tdebugNs.disableDebug();\n\t}\n};\n\nexport const {\n\tclone,\n\tloadExtension: loadExt,\n\tdebounce,\n\tthrottle,\n\thtml,\n} = Runtime;\n\n// BX.type\nexport const type = {\n\t...Object.getOwnPropertyNames(Type)\n\t\t.filter(key => !['name', 'length', 'prototype', 'caller', 'arguments'].includes(key))\n\t\t.reduce((acc, key) => {\n\t\t\tacc[key] = Type[key];\n\t\t\treturn acc;\n\t\t}, {}),\n\tisNotEmptyString: value => Type.isString(value) && value !== '',\n\tisNotEmptyObject: value => Type.isObjectLike(value) && Object.keys(value).length > 0,\n\tisMapKey: Type.isObject,\n\tstringToInt: (value) => {\n\t\tconst parsed = parseInt(value);\n\t\treturn !Number.isNaN(parsed) ? parsed : 0;\n\t},\n};\n\n// BX.browser\nexport const browser = {\n\tIsOpera: Browser.isOpera,\n\tIsIE: Browser.isIE,\n\tIsIE6: Browser.isIE6,\n\tIsIE7: Browser.isIE7,\n\tIsIE8: Browser.isIE8,\n\tIsIE9: Browser.isIE9,\n\tIsIE10: Browser.isIE10,\n\tIsIE11: Browser.isIE11,\n\tIsSafari: Browser.isSafari,\n\tIsFirefox: Browser.isFirefox,\n\tIsChrome: Browser.isChrome,\n\tDetectIeVersion: Browser.detectIEVersion,\n\tIsMac: Browser.isMac,\n\tIsAndroid: Browser.isAndroid,\n\tisIPad: Browser.isIPad,\n\tisIPhone: Browser.isIPhone,\n\tIsIOS: Browser.isIOS,\n\tIsMobile: Browser.isMobile,\n\tisRetina: Browser.isRetina,\n\tIsDoctype: Browser.isDoctype,\n\tSupportLocalStorage: Browser.isLocalStorageSupported,\n\taddGlobalClass: Browser.addGlobalClass,\n\tDetectAndroidVersion: Browser.detectAndroidVersion,\n\tisPropertySupported: Browser.isPropertySupported,\n\taddGlobalFeatures: Browser.addGlobalFeatures,\n};\n\n// eslint-disable-next-line\nconst ajax = window.BX ? window.BX.ajax : () => {};\nexport {ajax};\n\nexport function GetWindowScrollSize(doc = document)\n{\n\treturn {\n\t\tscrollWidth: doc.documentElement.scrollWidth,\n\t\tscrollHeight: doc.documentElement.scrollHeight,\n\t};\n}\n\nexport function GetWindowScrollPos(doc = document)\n{\n\tconst win = getWindow(doc);\n\n\treturn {\n\t\tscrollLeft: win.pageXOffset,\n\t\tscrollTop: win.pageYOffset,\n\t};\n}\n\nexport function GetWindowInnerSize(doc = document)\n{\n\tconst win = getWindow(doc);\n\treturn {innerWidth: win.innerWidth, innerHeight: win.innerHeight};\n}\n\nexport function GetWindowSize(doc = document)\n{\n\treturn {\n\t\t...GetWindowInnerSize(doc),\n\t\t...GetWindowScrollPos(doc),\n\t\t...GetWindowScrollSize(doc),\n\t};\n}\n\nexport function GetContext(node)\n{\n\treturn getWindow(node);\n}\n\nexport function pos(element, relative = false)\n{\n\tif (!element)\n\t{\n\t\treturn (new DOMRect()).toJSON();\n\t}\n\n\tif (element.ownerDocument === document && !relative)\n\t{\n\t\tconst clientRect = element.getBoundingClientRect();\n\t\tconst root = document.documentElement;\n\t\tconst {body} = document;\n\n\t\treturn {\n\t\t\ttop: Math.round(clientRect.top + (root.scrollTop || body.scrollTop)),\n\t\t\tleft: Math.round(clientRect.left + (root.scrollLeft || body.scrollLeft)),\n\t\t\twidth: Math.round(clientRect.right - clientRect.left),\n\t\t\theight: Math.round(clientRect.bottom - clientRect.top),\n\t\t\tright: Math.round(clientRect.right + (root.scrollLeft || body.scrollLeft)),\n\t\t\tbottom: Math.round(clientRect.bottom + (root.scrollTop || body.scrollTop)),\n\t\t};\n\t}\n\n\tlet x = 0;\n\tlet y = 0;\n\tconst w = element.offsetWidth;\n\tconst h = element.offsetHeight;\n\tlet first = true;\n\n\t// eslint-disable-next-line no-param-reassign\n\tfor (; element != null; element = element.offsetParent)\n\t{\n\t\tif (!first && relative && BX.is_relative(element))\n\t\t{\n\t\t\tbreak;\n\t\t}\n\n\t\tx += element.offsetLeft;\n\t\ty += element.offsetTop;\n\n\t\tif (first)\n\t\t{\n\t\t\tfirst = false;\n\t\t\t// eslint-disable-next-line no-continue\n\t\t\tcontinue;\n\t\t}\n\n\t\tx += Text.toNumber(Dom.style(element, 'border-left-width'));\n\t\ty += Text.toNumber(Dom.style(element, 'border-top-width'));\n\t}\n\n\treturn (new DOMRect(x, y, w, h)).toJSON();\n}\n\nexport function addCustomEvent(eventObject, eventName, eventHandler)\n{\n\tif (Type.isString(eventObject))\n\t{\n\t\teventHandler = eventName;\n\t\teventName = eventObject;\n\t\teventObject = EventEmitter.GLOBAL_TARGET;\n\t}\n\n\tif (eventObject === window)\n\t{\n\t\teventObject = EventEmitter.GLOBAL_TARGET;\n\t}\n\n\tif (!Type.isObject(eventObject))\n\t{\n\t\tconsole.error('The \"eventObject\" argument must be an object. Received type '+ typeof(eventObject) + '.');\n\t\treturn;\n\t}\n\n\tif (!Type.isStringFilled(eventName))\n\t{\n\t\tconsole.error('The \"eventName\" argument must be a string.');\n\t\treturn;\n\t}\n\n\tif (!Type.isFunction(eventHandler))\n\t{\n\t\tconsole.error('The \"eventHandler\" argument must be a function. Received type '+ typeof(eventHandler) + '.');\n\t\treturn;\n\t}\n\n\teventName = eventName.toLowerCase();\n\n\tEventEmitter.subscribe(eventObject, eventName, eventHandler, { compatMode: true, useGlobalNaming: true });\n}\n\nexport function onCustomEvent(eventObject, eventName, eventParams, secureParams)\n{\n\tif (Type.isString(eventObject))\n\t{\n\t\tsecureParams = eventParams;\n\t\teventParams = eventName;\n\t\teventName = eventObject;\n\t\teventObject = EventEmitter.GLOBAL_TARGET;\n\t}\n\n\tif (!Type.isObject(eventObject) || eventObject === window)\n\t{\n\t\teventObject = EventEmitter.GLOBAL_TARGET;\n\t}\n\n\tif (!eventParams)\n\t{\n\t\teventParams = [];\n\t}\n\n\teventName = eventName.toLowerCase();\n\n\tconst event = new BaseEvent();\n\tevent.setData(eventParams);\n\tevent.setCompatData(eventParams);\n\n\tEventEmitter.emit(eventObject, eventName, event, { cloneData: secureParams === true, useGlobalNaming: true });\n}\n\nexport function removeCustomEvent(eventObject, eventName, eventHandler)\n{\n\tif (Type.isString(eventObject))\n\t{\n\t\teventHandler = eventName;\n\t\teventName = eventObject;\n\t\teventObject = EventEmitter.GLOBAL_TARGET;\n\t}\n\n\tif (!Type.isFunction(eventHandler))\n\t{\n\t\tconsole.error('The \"eventHandler\" argument must be a function. Received type '+ typeof(eventHandler) + '.');\n\t\treturn;\n\t}\n\n\tif (eventObject === window)\n\t{\n\t\teventObject = EventEmitter.GLOBAL_TARGET;\n\t}\n\n\teventName = eventName.toLowerCase();\n\n\tEventEmitter.unsubscribe(eventObject, eventName, eventHandler, { useGlobalNaming: true });\n}\n\nexport function removeAllCustomEvents(eventObject, eventName)\n{\n\tif (Type.isString(eventObject))\n\t{\n\t\teventName = eventObject;\n\t\teventObject = EventEmitter.GLOBAL_TARGET;\n\t}\n\n\tif (eventObject === window)\n\t{\n\t\teventObject = EventEmitter.GLOBAL_TARGET;\n\t}\n\n\teventName = eventName.toLowerCase();\n\n\tEventEmitter.unsubscribeAll(eventObject, eventName, { useGlobalNaming: true });\n}","//import './internal/bx';\n\nimport Type from '../../src/lib/type';\nimport Reflection from '../../src/lib/reflection';\nimport Text from '../../src/lib/text';\nimport Dom from '../../src/lib/dom';\nimport Browser from '../../src/lib/browser';\nimport Event from '../../src/lib/event';\nimport Http from '../../src/lib/http';\nimport Runtime from '../../src/lib/runtime';\nimport Loc from '../../src/lib/loc';\nimport Tag from '../../src/lib/tag';\nimport Uri from '../../src/lib/uri';\nimport Validation from '../../src/lib/validation';\nimport Cache from '../../src/lib/cache';\nimport BaseError from '../../src/lib/base-error';\n\nexport {\n\tType,\n\tReflection,\n\tText,\n\tDom,\n\tBrowser,\n\tEvent,\n\tHttp,\n\tRuntime,\n\tLoc,\n\tTag,\n\tUri,\n\tValidation,\n\tCache,\n\tBaseError,\n};\n\nexport * from '../../src/core-compatibility';"],"names":["getTag","value","Object","prototype","toString","call","objectCtorString","Function","Type","isString","isObjectLike","proto","getPrototypeOf","ctor","hasOwnProperty","constructor","Number","isNaN","isNumber","isInteger","undefined","isNil","Array","isArray","length","isFunction","MAX_SAFE_INTEGER","isPlainObject","isDomNode","nodeType","Node","ELEMENT_NODE","TEXT_NODE","regExpTypedTag","test","size","type","slice","isBlob","lastModifiedDate","lastModified","name","FormData","Reflection","className","classFn","currentNamespace","window","namespaces","split","i","namespace","namespaceName","parts","parent","BX","isUndefined","reEscape","reUnescape","escapeEntities","unescapeEntities","Text","replace","item","map","Math","random","join","parsedValue","parseFloat","toNumber","parseInt","trueValues","transformedValue","toLowerCase","includes","str","isStringFilled","regex","match","letter","toUpperCase","substr","capitalize","toCamelCase","matches","x","aliases","mousewheel","bxchange","animationend","transitionend","fullscreenchange","fullscreenerror","Registry","WeakMap","target","event","listener","events","get","isSet","Set","add","registry","set","has","delete","isOptionSupported","isSupported","options","defineProperty","addEventListener","err","fetchSupportedListenerOptions","keys","reduce","acc","bind","eventName","handler","isObject","listenerOptions","forEach","key","unbind","removeEventListener","unbindAll","currentEvent","bindOnce","once","debugState","enableDebug","disableDebug","isDebugEnabled","debug","console","log","args","Error","stack","trace","Extension","config","extension","state","result","processHTML","html","inlineScripts","SCRIPT","externalScripts","externalStyles","STYLE","loadPromise","Promise","resolve","warn","evalGlobal","all","loadAll","then","getClass","initialized","ajaxController","makeIterable","isInitialized","getInitialized","isAllInitialized","extensions","every","loadExtensions","load","mergeExports","exports","currentExports","isInternal","push","JS","request","ajax","runAction","data","prepareExtensions","response","status","errors","initializedExtension","items","itemsList","loadExtension","utils","initializedExtensions","cloneableTags","isCloneable","isCloneableValue","internalClone","cloned","from","index","cloneNode","isMap","Map","isDate","Date","isRegExp","regExpFlags","flags","exec","RegExp","source","lastIndex","assign","create","clone","merge","current","entries","createComparator","fields","orders","a","b","field","order","valueA","valueB","Runtime","func","wait","context","timeoutId","debounced","clearTimeout","setTimeout","apply","timer","invoke","wrapper","q","node","params","innerHTML","parsedHtml","externalCss","externalJs","inlineJs","htmlFirst","HTML","script","callback","targets","unshift","collection","comparator","values","sort","isError","Symbol","for","BaseError","message","code","customData","setMessage","setCode","setCustomData","getCode","getMessage","error","BaseEvent","compatData","defaultPrevented","immediatePropagationStopped","setData","setCompatData","isArrayLike","EventStore","defaultMaxListeners","eventStore","record","getRecordScheme","maxListeners","eventsMap","onceMap","getDefaultMaxListeners","eventsMaxListeners","WarningStore","warnings","printDelayed","debounce","print","listeners","contextWarnings","groupCollapsed","dir","groupEnd","clear","warningStore","aliasStore","globalTarget","GLOBAL_TARGET","isEmitterProperty","namespaceProperty","targetProperty","EventEmitter","TypeError","setEventNamespace","getEventNamespace","subscribe","compatMode","normalizeAliases","normalizeEventName","actualName","subscribeOnce","unsubscribe","unsubscribeAll","emit","emitAsync","setMaxListeners","getMaxListeners","incrementMaxListeners","decrementMaxListeners","getListeners","makeFullEventName","isEventEmitter","targetProto","emitter","setPrototypeOf","getOwnPropertyNames","method","fullEventName","resolveEventName","useGlobalNaming","getOrAdd","onceListeners","getNextSequenceValue","targetInfo","globalEvents","globalListeners","targetListeners","targetEvents","preparedEvent","prepareEvent","isImmediatePropagationStopped","listenerResult","getCompatData","cloneData","thisArg","setTarget","setType","sequenceValue","count","DEFAULT_MAX_LISTENERS","destructMaxListenersArgs","increment","max","addMaxListeners","abs","alias","mergeEventAliases","aliasListeners","aliasOnceListeners","aliasMaxListeners","eventMaxListeners","getFullEventName","actualEventName","fullName","isReady","ready","document","readyState","Event","encodeAttributeValue","JSON","stringify","encode","decode","decodeAttributeValue","decodedValue","parse","e","Boolean","getPageScroll","documentElement","body","scrollTop","pageYOffset","scrollLeft","pageXOffset","Dom","oldElement","newElement","parentNode","replaceChild","element","removeChild","childNodes","firstChild","clean","getElementById","insertBefore","nextSibling","appendChild","append","isElementNode","preparedClassName","trim","hasClass","classList","contains","baseVal","getAttribute","some","addClass","names","removeClass","remove","filter","toggleClass","toggle","prop","isNull","removeAttribute","currentKey","currentValue","style","DOCUMENT_NODE","computedStyle","getComputedStyle","getPropertyValue","attrs","setAttribute","props","dataset","children","text","innerText","tag","tagName","adjust","createElement","hidden","isShown","hide","show","elementRect","getBoundingClientRect","DOMRect","left","top","width","height","relationElement","elementPosition","getPosition","relationElementPosition","attr","attrKey","attrValue","UA","navigator","userAgent","Browser","isOpera","documentMode","isSafari","isFirefox","isChrome","rv","MSStream","ActiveXObject","isIE10","isIE9","isIE","appName","re","res","detectIEVersion","isIPad","isIPhone","isAndroid","devicePixelRatio","doc","clientHeight","localStorage","setItem","removeItem","globalClass","isIOS","isMac","isMobile","isRetina","ieVersion","isDoctype","jsProperty","returnCSSName","getCssName","propertyName","getJsName","cssName","reg","property","bReturnCSSName","ucProperty","charAt","properties","obj","lowerProp","prefix","features","classNames","support","isPropertySupported","Cookie","cookie","subItem","decodeURIComponent","cookiesList","getList","attributes","expires","now","days","dayInMs","toUTCString","safeName","String","escape","safeValue","encodeURIComponent","stringifiedAttributes","attributeValue","objectToFormData","formData","pre","toISOString","isFile","preparedProperty","lastIndexOf","substring","Data","Http","Loc","messageId","id","handlers","getUid","incremental","bindAll","handlersMap","currentElement","querySelector","childrenMap","render","sections","eventAttrRe","uselessSymbolsRe","substitutions","preparedAcc","attrName","attribute","childKey","lowercaseHtml","startsWith","implementation","createHTMLDocument","parser","DOMParser","parsedDocument","parseFromString","head","el","parseProps","nextSectionIndex","splitted","substitutionPlaceholderExp","Tag","styleTagHandler","attrsTagHandler","getParser","format","sourceKey","accumulator","concat","getKeyFormat","parseQuery","input","url","param","keyFormat","formatter","urlExp","parseUrl","queryParams","useShort","href","schema","host","port","path","query","hash","username","password","origin","buildQueryString","queryString","paramValue","paramIndex","prepareParamValue","Uri","setQueryParams","removableParams","removeQueryParam","getQueryParams","currentParams","newParams","serialized","protocol","getHost","getPath","Validation","exp","BaseCache","defaultValue","storage","MemoryCache","MemoryStorage","LsStorage","getItem","stackKey","parsedStack","preparedStack","getStack","saveStack","LocalStorageCache","LsCacheStorage","Cache","getElement","getWindow","ownerDocument","parentWindow","defaultView","messageFunction","insertAfter","prepend","arguments","cleanNode","removeElement","getCookie","setCookie","debugEnableFlag","debugNs","debugStatus","debugEnable","loadExt","throttle","isNotEmptyString","isNotEmptyObject","isMapKey","stringToInt","parsed","browser","IsOpera","IsIE","IsIE6","isIE6","IsIE7","isIE7","IsIE8","isIE8","IsIE9","IsIE10","IsIE11","isIE11","IsSafari","IsFirefox","IsChrome","DetectIeVersion","IsMac","IsAndroid","IsIOS","IsMobile","IsDoctype","SupportLocalStorage","isLocalStorageSupported","addGlobalClass","DetectAndroidVersion","detectAndroidVersion","addGlobalFeatures","GetWindowScrollSize","scrollWidth","scrollHeight","GetWindowScrollPos","win","GetWindowInnerSize","innerWidth","innerHeight","GetWindowSize","GetContext","pos","relative","toJSON","clientRect","root","round","right","bottom","y","w","offsetWidth","h","offsetHeight","first","offsetParent","is_relative","offsetLeft","offsetTop","addCustomEvent","eventObject","eventHandler","onCustomEvent","eventParams","secureParams","removeCustomEvent","removeAllCustomEvents"],"mappings":"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"}