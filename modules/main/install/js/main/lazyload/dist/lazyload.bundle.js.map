{"version":3,"file":"lazyload.bundle.js","sources":["../src/lazyload.js"],"sourcesContent":["const LazyLoad = {\n\timages: [],\n\timageStatus: {\n\t\thidden: -2,\n\t\terror: -1,\n\t\t\"undefined\": 0,\n\t\tinited: 1,\n\t\tloaded: 2\n\t},\n\timageTypes: {\n\t\timage: 1,\n\t\tbackground: 2\n\t},\n\n\tregisterImage: function(id, isImageVisibleCallback, options)\n\t{\n\t\toptions = options || {};\n\n\t\tif (BX.type.isNotEmptyString(id))\n\t\t{\n\t\t\tthis.images.push({\n\t\t\t\tid: id,\n\t\t\t\tnode: null,\n\t\t\t\tsrc: null,\n\t\t\t\tdataSrcName: options.dataSrcName || 'src',\n\t\t\t\ttype: null,\n\t\t\t\tfunc: BX.type.isFunction(isImageVisibleCallback) ? isImageVisibleCallback : null,\n\t\t\t\tstatus: this.imageStatus.undefined\n\t\t\t});\n\t\t}\n\t},\n\n\tregisterImages: function(ids, isImageVisibleCallback, options)\n\t{\n\t\tif (BX.type.isArray(ids))\n\t\t{\n\t\t\tfor (var i = 0, length = ids.length; i < length; i++)\n\t\t\t{\n\t\t\t\tthis.registerImage(ids[i], isImageVisibleCallback, options);\n\t\t\t}\n\t\t}\n\t},\n\n\tshowImages: function(checkOwnVisibility)\n\t{\n\t\tvar image = null;\n\t\tvar isImageVisible = false;\n\n\t\tcheckOwnVisibility = (checkOwnVisibility !== false);\n\t\tfor (var i = 0, length = this.images.length; i < length; i++)\n\t\t{\n\t\t\timage = this.images[i];\n\n\t\t\tif (image.status == this.imageStatus.undefined)\n\t\t\t{\n\t\t\t\tthis.initImage(image);\n\t\t\t}\n\n\t\t\tif (image.status !== this.imageStatus.inited)\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\t!image.node\n\t\t\t\t|| !image.node.parentNode\n\t\t\t)\n\t\t\t{\n\t\t\t\timage.node = null;\n\t\t\t\timage.status = this.imageStatus.error;\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tisImageVisible = true;\n\t\t\tif (checkOwnVisibility && image.func)\n\t\t\t{\n\t\t\t\tisImageVisible = image.func(image);\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\tisImageVisible === true\n\t\t\t\t&& this.isElementVisibleOnScreen(image.node)\n\t\t\t)\n\t\t\t{\n\t\t\t\tif (image.type == this.imageTypes.image)\n\t\t\t\t{\n\t\t\t\t\timage.node.src = image.src;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\timage.node.style.backgroundImage = \"url('\" + image.src + \"')\";\n\t\t\t\t}\n\n\t\t\t\timage.node.dataset[image.dataSrcName] = \"\";\n\t\t\t\timage.status = this.imageStatus.loaded;\n\t\t\t}\n\t\t}\n\t},\n\n\tinitImage: function(image)\n\t{\n\t\timage.status = this.imageStatus.error;\n\t\tvar node = BX(image.id);\n\t\tif (node)\n\t\t{\n\t\t\tvar src = node.dataset[image.dataSrcName];\n\t\t\tif (BX.type.isNotEmptyString(src))\n\t\t\t{\n\t\t\t\timage.node = node;\n\t\t\t\timage.src = src;\n\t\t\t\timage.status = this.imageStatus.inited;\n\t\t\t\timage.type = (image.node.tagName.toLowerCase() == \"img\"\n\t\t\t\t\t\t? this.imageTypes.image\n\t\t\t\t\t\t: this.imageTypes.background\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t},\n\n\tisElementVisibleOnScreen: function (element)\n\t{\n\t\tvar coords = this.getElementCoords(element);\n\n\t\tvar windowTop = window.pageYOffset || document.documentElement.scrollTop;\n\t\tvar windowBottom = windowTop + document.documentElement.clientHeight;\n\n\t\tcoords.bottom = coords.top + element.offsetHeight;\n\n\t\tvar topVisible = coords.top > windowTop && coords.top < windowBottom;\n\t\tvar bottomVisible = coords.bottom < windowBottom && coords.bottom > windowTop;\n\n\t\treturn topVisible || bottomVisible;\n\t},\n\n\tisElementVisibleOn2Screens: function(element)\n\t{\n\t\tvar coords = this.getElementCoords(element);\n\n\t\tvar windowHeight = document.documentElement.clientHeight;\n\t\tvar windowTop = window.pageYOffset || document.documentElement.scrollTop;\n\t\tvar windowBottom = windowTop + windowHeight;\n\n\t\tcoords.bottom = coords.top + element.offsetHeight;\n\n\t\twindowTop -= windowHeight;\n\t\twindowBottom += windowHeight;\n\n\t\tvar topVisible = coords.top > windowTop && coords.top < windowBottom;\n\t\tvar bottomVisible = coords.bottom < windowBottom && coords.bottom > windowTop;\n\n\t\treturn topVisible || bottomVisible;\n\t},\n\n\tgetElementCoords: function(element)\n\t{\n\t\tvar box = element.getBoundingClientRect();\n\n\t\treturn {\n\t\t\toriginTop: box.top,\n\t\t\toriginLeft: box.left,\n\t\t\ttop: box.top + window.pageYOffset,\n\t\t\tleft: box.left + window.pageXOffset\n\t\t};\n\t},\n\n\tonScroll: function()\n\t{\n\t\tBX.LazyLoad.showImages();\n\t},\n\n\tclearImages: function ()\n\t{\n\t\tthis.images = [];\n\t}\n};\n\nexport {LazyLoad};"],"names":["LazyLoad","images","imageStatus","hidden","error","inited","loaded","imageTypes","image","background","registerImage","id","isImageVisibleCallback","options","BX","type","isNotEmptyString","push","node","src","dataSrcName","func","isFunction","status","undefined","registerImages","ids","isArray","i","length","showImages","checkOwnVisibility","isImageVisible","initImage","parentNode","isElementVisibleOnScreen","style","backgroundImage","dataset","tagName","toLowerCase","element","coords","getElementCoords","windowTop","window","pageYOffset","document","documentElement","scrollTop","windowBottom","clientHeight","bottom","top","offsetHeight","topVisible","bottomVisible","isElementVisibleOn2Screens","windowHeight","box","getBoundingClientRect","originTop","originLeft","left","pageXOffset","onScroll","clearImages"],"mappings":"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"}