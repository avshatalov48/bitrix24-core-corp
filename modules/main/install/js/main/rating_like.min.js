if(!BXRL){var BXRL={};var BXRLW=null;var lastVoteRepo={};var lastReactionRepo={};var BXRLParams={pathToUserProfile:null}}RatingLike=function(e,t,i,n,o,a,s,r,l){var p=t+"_"+i;this.enabled=true;this.likeId=e;this.entityTypeId=t;this.entityId=i;this.available=n=="Y";this.userId=o;this.localize=a;this.template=s;this.pathToUserProfile=r;this.pathToAjax=BX.type.isNotEmptyString(l)?l:"/bitrix/components/bitrix/rating.vote/vote.ajax.php";this.box=BX("bx-ilike-button-"+e);if(this.box===null){this.enabled=false;return false}this.button=BX.findChild(this.box,{className:"bx-ilike-left-wrap"},true,false);this.buttonText=BX.findChild(this.button,{className:"bx-ilike-text"},true,false);this.count=BX.findChild(this.box,{tagName:"span",className:"bx-ilike-right-wrap"},true,false);if(!this.count){this.count=BX("bx-ilike-count-"+e)}this.countText=BX.findChild(this.count,{className:"bx-ilike-right"},true,false);this.topPanelContainer=BX("feed-post-emoji-top-panel-container-"+e);this.topPanel=BX("feed-post-emoji-top-panel-"+e);this.topUsersText=BX("bx-ilike-top-users-"+e);this.topUsersDataNode=BX("bx-ilike-top-users-data-"+e);this.userReactionNode=BX("bx-ilike-user-reaction-"+e);this.reactionsNode=BX("feed-post-emoji-icons-"+e);this.popup=null;this.popupId=null;this.popupTimeoutIdShow=null;this.popupTimeoutIdList=null;this.popupContent=BX.findChild(BX("bx-ilike-popup-cont-"+e),{tagName:"span",className:"bx-ilike-popup"},true,false);this.popupContentPage=1;this.popupTimeout=false;this.likeTimeout=false;this.mouseOverHandler=null;this.version=BXRL.render&&this.topPanel?2:1;this.mouseInShowPopupNode={};this.listXHR=null;if(typeof lastVoteRepo[p]!="undefined"){this.lastVote=lastVoteRepo[p];var u=s=="standart"?this.button:this.count;if(this.lastVote=="plus"){BX.addClass(u,"bx-you-like")}else{BX.removeClass(u,"bx-you-like")}}else{this.lastVote=BX.hasClass(s=="standart"?this.button:this.count,"bx-you-like")?"plus":"cancel";lastVoteRepo[p]=this.lastVote}if(typeof lastReactionRepo[p]!="undefined"){this.lastReaction=lastReactionRepo[p];this.count.setAttribute("data-myreaction",this.lastReaction)}else{var R=this.count.getAttribute("data-myreaction");this.lastReaction=BX.type.isNotEmptyString(R)?R:"like";lastReactionRepo[p]=this.lastReaction}if(this.topPanelContainer&&typeof BXRL.manager!="undefined"){BXRL.manager.addEntity(p,this)}};RatingLike.Draw=function(e,t){var i=e;var n=BXRL[i];n.countText.innerHTML=parseInt(t.TOTAL_POSITIVE_VOTES);if(typeof t.TYPE!="undefined"&&typeof t.USER_ID!="undefined"&&parseInt(t.USER_ID)>0&&typeof t.USER_DATA!="undefined"&&typeof t.USER_DATA.WEIGHT!="undefined"){var o=parseFloat(t.USER_DATA.WEIGHT);var a=BXRL[i].topUsersDataNode?JSON.parse(BXRL[i].topUsersDataNode.getAttribute("data-users")):false;if(t.TYPE!="CHANGE"&&BX.type.isPlainObject(a)){a.TOP=Object.values(a.TOP);var s=a.TOP.length<2;for(var r in a.TOP){if(s){break}if(!a.TOP.hasOwnProperty(r)){continue}if(t.TYPE=="ADD"&&o>a.TOP[r].WEIGHT||t.TYPE=="CANCEL"&&t.USER_ID==a.TOP[r].ID){s=true}}if(s){if(t.TYPE=="ADD"&&t.USER_ID!=BX.message("USER_ID")){if(!a.TOP.find((function(e){return e.ID==t.USER_ID}))){a.TOP.push({ID:parseInt(t.USER_ID),NAME_FORMATTED:t.USER_DATA.NAME_FORMATTED,WEIGHT:parseFloat(t.USER_DATA.WEIGHT)})}}else if(t.TYPE=="CANCEL"){a.TOP=a.TOP.filter((function(e){return e.ID!=t.USER_ID}))}a.TOP.sort((function(e,t){if(e.WEIGHT==t.WEIGHT){return 0}return e.WEIGHT>t.WEIGHT?-1:1}));if(a.TOP.length>2&&t.TYPE=="ADD"){a.TOP.pop();a.MORE++}}else{if(t.TYPE=="ADD"){a.MORE=typeof a.MORE!="undefined"?parseInt(a.MORE)+1:1}else if(t.TYPE=="CANCEL"){a.MORE=typeof a.MORE!="undefined"&&parseInt(a.MORE)>0?parseInt(a.MORE)-1:0}}BXRL[i].topUsersDataNode.setAttribute("data-users",JSON.stringify(a));if(BXRL[i].topUsersText){BXRL[i].topUsersText.innerHTML=BXRL.render.getTopUsersText({you:t.USER_ID==BX.message("USER_ID")?t.TYPE!="CANCEL":BX.hasClass(BXRL[i].count,"bx-you-like"),top:a.TOP,more:a.MORE})}}if(BX.type.isNotEmptyString(t.REACTION)&&BX.type.isNotEmptyString(t.REACTION_OLD)&&t.TYPE=="CHANGE"){BXRL.render.setReaction({likeId:i,rating:BXRL[i],action:"change",userReaction:t.REACTION,userReactionOld:t.REACTION_OLD,totalCount:t.TOTAL_POSITIVE_VOTES,userId:t.USER_ID})}else if(BX.type.isNotEmptyString(t.REACTION)&&BX.util.in_array(t.TYPE,["ADD","CANCEL"])){BXRL.render.setReaction({likeId:i,rating:BXRL[i],userReaction:t.REACTION,action:t.TYPE=="ADD"?"add":"cancel",totalCount:t.TOTAL_POSITIVE_VOTES,userId:t.USER_ID})}}if(BXRL[i].topPanel){BXRL[i].topPanel.setAttribute("data-popup","N")}if(!BXRL[i].userReactionNode){n.count.insertBefore(BX.create("span",{props:{className:"bx-ilike-plus-one"},style:{width:n.countText.clientWidth-8+"px",height:n.countText.clientHeight-8+"px"},html:t.TYPE=="ADD"?"+1":"-1"}),n.count.firstChild)}if(n.popup){n.popup.close();n.popupContentPage=1}};RatingLike.LiveUpdate=function(e){if(e.USER_ID==BX.message("USER_ID")){return false}for(var t in BXRL){if(!BXRL.hasOwnProperty(t)){continue}if(BXRL[t].entityTypeId==e.ENTITY_TYPE_ID&&BXRL[t].entityId==e.ENTITY_ID){RatingLike.Draw(t,e)}}if(typeof BXRL.manager!="undefined"){BXRL.manager.live(e)}};RatingLike.Set=function(e,t,i,n,o,a,s,r,l,p){p=!!p;if(s===undefined)s="standart";if(BXRLParams.pathToUserProfile){r=BXRLParams.pathToUserProfile}if(!BXRL[e]||BXRL[e].tryToSet<=5){var u=BXRL[e]&&BXRL[e].tryToSet?BXRL[e].tryToSet:1;BXRL[e]=new RatingLike(e,t,i,n,o,a,s,r,l);if(BXRL[e].enabled){RatingLike.Init(e,{mobile:p})}else{setTimeout((function(){BXRL[e].tryToSet=u+1;RatingLike.Set(e,t,i,n,o,a,s,r,l,p)}),500)}}};RatingLike.ClickVote=function(e,t,i){var n=null,o=null,a=null;if(typeof t=="undefined"){t="like"}if(BXRL[e].version==2&&BXRL[e].userReactionNode){BXRL.render.hideReactionsPopup({likeId:e});BXRL.render.blockReactionsPopup();BX.unbind(document,"mousemove",BXRL.render.reactionsPopupMouseOutHandler)}clearTimeout(BXRL[e].likeTimeout);var s=BX.hasClass(BXRL[e].template=="standart"?this:BXRL[e].count,"bx-you-like");i=!!i;var r=false,l=false;if(s&&!i){t=BXRL[e].version==2?BXRL.render.getUserReaction({userReactionNode:BXRL[e].userReactionNode}):false;BXRL[e].buttonText.innerHTML=BXRL[e].localize["LIKE_N"];BXRL[e].countText.innerHTML=parseInt(BXRL[e].countText.innerHTML)-1;BX.removeClass(BXRL[e].template=="standart"?this:BXRL[e].count,"bx-you-like");BX.removeClass(BXRL[e].button,"bx-you-like-button");if(t){BX.removeClass(BXRL[e].button,"bx-you-like-button-"+t)}BXRL[e].likeTimeout=setTimeout((function(){if(BXRL[e].lastVote!="cancel"){RatingLike.Vote(e,"cancel",t)}}),1e3)}else if(s&&i){r=true;l=BXRL[e].version==2?BXRL.render.getUserReaction({userReactionNode:BXRL[e].userReactionNode}):false;if(t!=l){if(l){BX.removeClass(BXRL[e].button,"bx-you-like-button-"+l)}BX.addClass(BXRL[e].button,"bx-you-like-button-"+t);BXRL[e].likeTimeout=setTimeout((function(){RatingLike.Vote(e,"change",t,l)}),1e3)}}else if(!s){BXRL[e].buttonText.innerHTML=BXRL[e].localize["LIKE_Y"];BXRL[e].countText.innerHTML=parseInt(BXRL[e].countText.innerHTML)+1;BX.addClass(BXRL[e].template=="standart"?this:BXRL[e].count,"bx-you-like");BX.addClass(BXRL[e].button,"bx-you-like-button");BX.addClass(BXRL[e].button,"bx-you-like-button-"+t);BXRL[e].likeTimeout=setTimeout((function(){if(BXRL[e].lastVote!="plus"){RatingLike.Vote(e,"plus",t)}else if(t!=BXRL[e].lastReaction){RatingLike.Vote(e,"change",t,BXRL[e].lastReaction)}}),1e3)}if(BXRL[e].version==2){if(r){BXRL.render.setReaction({likeId:e,rating:BXRL[e],action:"change",userReaction:t,userReactionOld:l,totalCount:parseInt(BXRL[e].countText.innerHTML)})}else{BXRL.render.setReaction({likeId:e,rating:BXRL[e],action:s?"cancel":"add",userReaction:t,totalCount:parseInt(BXRL[e].countText.innerHTML)})}}if(!r&&BXRL[e].version==2){var p=BXRL[e].topUsersDataNode?JSON.parse(BXRL[e].topUsersDataNode.getAttribute("data-users")):false;if(p){p.TOP=Object.values(p.TOP);BXRL[e].topUsersText.innerHTML=BXRL.render.getTopUsersText({you:!s,top:p.TOP,more:p.MORE})}}if(BXRL[e].template=="light"&&!BXRL[e].userReactionNode){n=BXRL[e].box;o=n.cloneNode(true);o.id="like_anim";var u="normal";if(BX.findParent(n,{className:"feed-com-informers-bottom"})){u="comment"}else if(BX.findParent(n,{className:"feed-post-informers"})){u="post"}BX.removeClass(o,"bx-ilike-button-hover");BX.addClass(o,"bx-like-anim");BX.adjust(n.parentNode,{style:{position:"relative"}});BX.adjust(o,{style:{position:"absolute",whiteSpace:"nowrap",top:u=="post"?"1px":u=="comment"?"0":""}});BX.adjust(n,{style:{visibility:"hidden"}});BX.prepend(o,n.parentNode);new BX.easing({duration:140,start:{scale:100},finish:{scale:u=="comment"?110:115},transition:BX.easing.transitions.quad,step:function(e){o.style.transform="scale("+e.scale/100+")"},complete:function(){a=BX.create("SPAN",{props:{className:s?"bx-ilike-icon":"bx-ilike-icon bx-ilike-icon-orange"}});BX.adjust(a,{style:{position:"absolute",whiteSpace:"nowrap"}});BX.prepend(a,n.parentNode);new BX.easing({duration:140,start:{scale:u=="comment"?110:115},finish:{scale:100},transition:BX.easing.transitions.quad,step:function(e){o.style.transform="scale("+e.scale/100+")"},complete:function(){}}).animate();var e={opacity:100,scale:u=="comment"?110:115,top:0};var t={opacity:0,scale:200,top:u=="comment"?-3:-2};if(u!="comment"){e.left=-5;t.left=-13}new BX.easing({duration:200,start:e,finish:t,transition:BX.easing.transitions.linear,step:function(e){a.style.transform="scale("+e.scale/100+")";a.style.opacity=e.opacity/100;if(u!="comment"){a.style.left=e.left+"px"}a.style.top=e.top+"px"},complete:function(){o.parentNode.removeChild(o);a.parentNode.removeChild(a);BX.adjust(n.parentNode,{style:{position:"static"}});BX.adjust(n,{style:{visibility:"visible"}})}}).animate()}}).animate()}BX.removeClass(this.box,"bx-ilike-button-hover")};RatingLike.Init=function(e,t){if(typeof t=="undefined"){t={}}if(typeof BXRL.manager!="undefined"){BXRL.manager.init(t)}if(BXRL[e].available){var i=BXRL[e].template=="standart"?BXRL[e].button:BXRL[e].buttonText;if(!BXRL.manager||!BXRL.manager.mobile){var n=i.closest(".feed-new-like");if(n){i=n}}if(BXRL[e].version>=2&&BXRL.manager.mobile){BX.bind(i,"touchstart",BX.delegate((function(e){BXRL.manager.startScrollTop=document.documentElement&&document.documentElement.scrollTop||document.body.scrollTop})))}var o=typeof BXRL.manager!="undefined"&&BXRL.manager.mobile?"touchend":"click";BX.bind(i,o,BX.delegate((function(t){if(BXRL[e].version>=2&&BXRL.manager.mobile&&BXRL.render.blockTouchEndByScroll){BXRL.render.blockTouchEndByScroll=false;return}if(BXRL[e].version<2||!BXRL.manager.mobile||!BXRL.render.reactionsPopupLikeId){if(BXRL[e].version>=2&&BXRL.manager.mobile){var i=document.documentElement&&document.documentElement.scrollTop||document.body.scrollTop;if(Math.abs(i-BXRL.manager.startScrollTop)>2){return}}RatingLike.ClickVote(e)}if(BXRL[e].version==2){BXRL.render.afterClick({likeId:e})}t.preventDefault()}),this));if(typeof BXRL.manager=="undefined"||!BXRL.manager.mobile){BX.bind(BXRL[e].box,"mouseover",(function(){BX.addClass(this,"bx-ilike-button-hover")}));BX.bind(BXRL[e].box,"mouseout",(function(){BX.removeClass(this,"bx-ilike-button-hover")}))}else{BXRL[e].pathToAjax=BX.message("SITE_DIR")+"mobile/ajax.php?mobile_action=like";BX.bind(BXRL[e].topPanel,"click",(function(t){BXRL.render.openMobileReactionsPage({entityTypeId:BXRL[e].entityTypeId,entityId:BXRL[e].entityId});t.stopPropagation()}))}}else if(BXRL[e].buttonText!=undefined){BXRL[e].buttonText.innerHTML=BXRL[e].localize["LIKE_D"];BXRL[e].buttonText.classList.add("bx-ilike-text-unavailable")}var a=BXRL[e].topUsersText?BXRL[e].topUsersText:BXRL[e].count;if(typeof BXRL.manager=="undefined"||!BXRL.manager.mobile){BX.bind(a,"mouseenter",(function(t){RatingLike.onResultMouseEnter({likeId:e,event:t,nodeId:t.currentTarget.id})}));BX.bind(a,"mouseleave",BX.proxy((function(){RatingLike.onResultMouseLeave({likeId:e})}),{likeId:e}))}if(typeof BXRL.manager=="undefined"||!BXRL.manager.mobile){BX.bind(a,"click",(function(t){RatingLike.onResultClick({likeId:e,event:t,nodeId:t.currentTarget.id})}))}if(BXRL[e].version==2&&BXRL[e].available&&BXRL[e].userReactionNode){BXRL.render.bindReactionsPopup({likeId:e})}};RatingLike.onResultClick=function(e){var t=BX.type.isNotEmptyString(e.likeId)?e.likeId:false,i=typeof e.event!="undefined"?e.event:null,n=BX.type.isNotEmptyString(e.reaction)?e.reaction:"";if(BXRL[t].resultPopupAnimation){return}if(BXRL[t].popup&&BXRL[t].popup.isShown()){BXRL[t].popup.close()}else{clearTimeout(BXRL[t].popupTimeoutIdList);clearTimeout(BXRL[t].popupTimeoutIdShow);if(BXRL[t].popupContentPage==1&&(i.currentTarget.getAttribute("data-popup")!="Y"||BXRL[t].popupCurrentReaction!=n)){RatingLike.List(t,1,n,true)}RatingLike.OpenWindow(t,i.currentTarget==BXRL[t].count?null:i,i.currentTarget,i.currentTarget.id)}};RatingLike.onResultMouseEnter=function(e){var t=BX.type.isNotEmptyString(e.likeId)?e.likeId:false,i=typeof e.event!="undefined"?e.event:null,n=BX.type.isNotEmptyString(e.reaction)?e.reaction:"",o=i&&BX.type.isNotEmptyString(i.currentTarget.id)?i.currentTarget.id:"";BXRL[t].mouseInShowPopupNode[n]=true;clearTimeout(BXRL[t].popupTimeoutIdList);clearTimeout(BXRL[t].popupTimeoutIdShow);BXRL[t].popupTimeoutIdList=setTimeout(BX.proxy((function(){if(BXRLW==this.likeId){return false}if(BXRL[this.likeId].popupContentPage==1&&this.target.getAttribute("data-popup")!="Y"){RatingLike.List(this.likeId,1,this.reaction,true)}BXRL[this.likeId].popupTimeoutIdShow=setTimeout(BX.proxy((function(){BXRL[this._likeId].resultPopupAnimation=true;var e=this._likeId;setTimeout((function(){BXRL[e].resultPopupAnimation=false}),500);if(BXRL[this._likeId].mouseInShowPopupNode[this._reaction]){RatingLike.OpenWindow(this._likeId,null,this._target,this._nodeId)}}),{_likeId:this.likeId,_reaction:this.reaction,_target:this.target,_nodeId:this.nodeId}),100)}),{likeId:t,target:i.currentTarget,reaction:n,nodeId:o}),300)};RatingLike.onResultMouseLeave=function(e){var t=BX.type.isNotEmptyString(e.likeId)?e.likeId:false,i=BX.type.isNotEmptyString(e.reaction)?e.reaction:"";BXRL[t].mouseInShowPopupNode[i]=false;BXRL[t].resultPopupAnimation=false};RatingLike.OpenWindow=function(e,t,i,n){if(parseInt(BXRL[e].countText.innerHTML)==0){return}var o=BXRL[e].template=="standart"?BXRL[e].count:BXRL[e].version==2?BX(i)?BX(i):BX.type.isNotEmptyString(n)&&BX(n)?BX(n):null:BXRL[e].box;if(!BX(o)){return}if(BXRL[e].popup==null){var a=RatingLike.getGlobalIndex(BX(o));BXRL[e].popup=new BX.PopupWindow("ilike-popup-"+e,o,{lightShadow:true,offsetTop:0,offsetLeft:typeof t!="undefined"&&t!=null&&typeof t.offsetX!="undefined"?t.offsetX-100:BXRL[e].version==2?-30:5,autoHide:true,closeByEsc:true,zIndexAbsolute:a>1e3?a+1:1e3,bindOptions:{position:"top"},animation:"fading-slide",events:{onPopupClose:function(){BXRLW=null},onPopupDestroy:function(){}},content:BX("bx-ilike-popup-cont-"+e),className:(BXRL[e].topPanel?"bx-ilike-wrap-block-react-wrap":"")+(typeof BXRL.manager!="undefined"&&BXRL.manager.mobile?" bx-ilike-mobile-wrap":"")});if(!BXRL[e].topPanel&&(typeof BXRL.manager=="undefined"||!BXRL.manager.mobile)){BXRL[e].popup.setAngle({});BX.bind(BX("ilike-popup-"+e),"mouseout",(function(){clearTimeout(BXRL[e].popupTimeout);BXRL[e].popupTimeout=setTimeout((function(){BXRL[e].popup.close()}),1e3)}));BX.bind(BX("ilike-popup-"+e),"mouseover",(function(){clearTimeout(BXRL[e].popupTimeout)}))}}else{if(typeof t!="undefined"&&t!=null&&typeof t.offsetX!="undefined"){BXRL[e].popup.offsetLeft=t.offsetX-100}if(BX(o)){BXRL[e].popup.setBindElement(o)}}if(BXRLW!=null&&BXRLW!=e){BXRL[BXRLW].popup.close()}BXRLW=e;BXRL[e].popup.show();if(typeof BX.SidePanel!="undefined"&&BX.SidePanel.Instance.getTopSlider()){BX.addCustomEvent(BX.SidePanel.Instance.getTopSlider().getWindow(),"SidePanel.Slider:onClose",(function e(){BX.removeCustomEvent(BX.SidePanel.Instance.getTopSlider().getWindow(),"SidePanel.Slider:onClose",e);if(typeof BXRL[BXRLW]!="undefined"){BXRL[BXRLW].popup.close()}}))}RatingLike.AdjustWindow(e)};RatingLike.getGlobalIndex=function(e){var t=0,i="";do{i=BX.style(e,"z-index");if(i!=="auto"){t=BX.type.stringToInt(i)}e=e.offsetParent}while(e&&e.tagName!=="BODY");return t};RatingLike.Vote=function(e,t,i,n){if(!BX.type.isNotEmptyString(i)){i="like"}var o=null;if(typeof BXRL.manager!="undefined"&&BXRL.manager.mobile){o=new MobileAjaxWrapper}var a=o?BX.proxy(o.Wrap,o):BX.ajax,s=o?"callback":"onsuccess",r=o?"callback_failure":"onfailure";var l=BXRL[e].pathToAjax;l=BX.util.add_url_param(l,{b24statAction:"addLike"});if(BXRL[e].version>=2&&BXRL.manager.mobile){l=BX.util.add_url_param(l,{b24statContext:"mobile"})}var p={url:l,method:"POST",dataType:"json",type:"json",data:{RATING_VOTE:"Y",RATING_VOTE_TYPE_ID:BXRL[e].entityTypeId,RATING_VOTE_ENTITY_ID:BXRL[e].entityId,RATING_VOTE_ACTION:t,RATING_VOTE_REACTION:i,sessid:BX.bitrix_sessid()}};p[s]=function(o){BXRL[e].lastVote=o.action;BXRL[e].lastReaction=i;lastVoteRepo[BXRL[e].entityTypeId+"_"+BXRL[e].entityId]=o.action;lastReactionRepo[BXRL[e].entityTypeId+"_"+BXRL[e].entityId]=o.voteReaction;BXRL[e].countText.innerHTML=o.items_all;BXRL[e].popupContentPage=1;BXRL[e].popupContent.innerHTML="";spanTag0=document.createElement("span");spanTag0.className="bx-ilike-wait";BXRL[e].popupContent.appendChild(spanTag0);if(BXRL[e].topPanel){BXRL[e].topPanel.setAttribute("data-popup","N")}RatingLike.AdjustWindow(e);if(BX("ilike-popup-"+e)&&BX("ilike-popup-"+e).style.display=="block"){RatingLike.List(e,null,"",true)}if(BXRL[e].version>=2&&BXRL.manager.mobile){BXMobileApp.onCustomEvent("onRatingLike",{action:o.action,ratingId:e,entityTypeId:BXRL[e].entityTypeId,entityId:BXRL[e].entityId,voteAction:t,voteReaction:i,voteReactionOld:n,userId:BX.message("USER_ID"),userData:typeof o.user_data!="undefined"?o.user_data:null,itemsAll:o.items_all},true)}};p[r]=function(o){var a=BXRL[e].topUsersDataNode?JSON.parse(BXRL[e].topUsersDataNode.getAttribute("data-users")):false;if(BXRL[e].version==2){if(t=="change"){BXRL.render.setReaction({likeId:e,rating:BXRL[e],action:t,userReaction:i,userReactionOld:n,totalCount:parseInt(BXRL[e].countText.innerHTML)})}else{BXRL.render.setReaction({likeId:e,rating:BXRL[e],action:t=="cancel"?"add":"cancel",userReaction:i,totalCount:t=="cancel"?parseInt(BXRL[e].countText.innerHTML)+1:parseInt(BXRL[e].countText.innerHTML)-1})}if(BXRL[e].buttonText){if(t=="add"){BXRL[e].buttonText.innerHTML=BX.message("RATING_LIKE_EMOTION_LIKE_CALC")}else if(t=="change"){BXRL[e].buttonText.innerHTML=BX.message("RATING_LIKE_EMOTION_"+n.toUpperCase()+"_CALC")}else{BXRL[e].buttonText.innerHTML=BX.message("RATING_LIKE_EMOTION_"+i.toUpperCase()+"_CALC")}}}if(a&&t!="change"&&BXRL[e].version==2){a.TOP=Object.values(a.TOP);BXRL[e].topUsersText.innerHTML=BXRL.render.getTopUsersText({you:t=="cancel",top:a.TOP,more:a.MORE})}};a(p);return false};RatingLike.List=function(e,t,i,n){if(parseInt(BXRL[e].countText.innerHTML)==0){return false}i=BX.type.isNotEmptyString(i)?i:"";if(t==null){t=BXRL[e].version==2?typeof BXRL.render.popupPagesList[i]!="undefined"?BXRL.render.popupPagesList[i]:1:BXRL[e].popupContentPage}if(n&&t==1&&BXRL[e].version==2){BXRL.render.clearPopupContent({likeId:e})}if(BXRL[e].listXHR){BXRL[e].listXHR.abort()}BXRL[e].listXHR=BX.ajax({url:BXRL[e].pathToAjax,method:"POST",dataType:"json",data:{RATING_VOTE_LIST:"Y",RATING_VOTE_TYPE_ID:BXRL[e].entityTypeId,RATING_VOTE_ENTITY_ID:BXRL[e].entityId,RATING_VOTE_LIST_PAGE:t,RATING_VOTE_REACTION:i=="all"?"":i,PATH_TO_USER_PROFILE:BXRL[e].pathToUserProfile,sessid:BX.bitrix_sessid()},onsuccess:function(o){if(!o){return false}BXRL[e].countText.innerHTML=o.items_all;if(parseInt(o.items_page)==0){return false}if(BXRL[e].version==2){BXRL.render.buildPopupContent({likeId:e,reaction:i,rating:BXRL[e],page:t,data:o,clear:n});BXRL[e].topPanel.setAttribute("data-popup","Y")}else{if(t==1){BXRL[e].popupContent.innerHTML="";spanTag0=document.createElement("span");spanTag0.className="bx-ilike-bottom_scroll";BXRL[e].popupContent.appendChild(spanTag0)}BXRL[e].popupContentPage+=1;var a=null;for(var s=0;s<o.items.length;s++){if(o.items[s]["PHOTO_SRC"].length>0){a=BX.create("IMG",{attrs:{src:o.items[s]["PHOTO_SRC"]},props:{className:"bx-ilike-popup-avatar-img"}})}else{a=BX.create("IMG",{attrs:{src:"/bitrix/images/main/blank.gif"},props:{className:"bx-ilike-popup-avatar-img bx-ilike-popup-avatar-img-default"}})}BXRL[e].popupContent.appendChild(BX.create("A",{attrs:{href:o.items[s]["URL"],target:"_blank"},props:{className:"bx-ilike-popup-img"+(!!o.items[s]["USER_TYPE"]?" bx-ilike-popup-img-"+o.items[s]["USER_TYPE"]:"")},children:[BX.create("SPAN",{props:{className:"bx-ilike-popup-avatar-new"},children:[a,BX.create("SPAN",{props:{className:"bx-ilike-popup-avatar-status-icon"}})]}),BX.create("SPAN",{props:{className:"bx-ilike-popup-name-new"},html:o.items[s]["FULL_NAME"]})]}))}}RatingLike.AdjustWindow(e);RatingLike.PopupScroll(e)},onfailure:function(e){}});return false};RatingLike.AdjustWindow=function(e){if(BXRL[e].popup!=null){BXRL[e].popup.bindOptions.forceBindPosition=true;BXRL[e].popup.adjustPosition();BXRL[e].popup.bindOptions.forceBindPosition=false}};RatingLike.PopupScroll=function(e){var t=BX.findChildren(BXRL[e].popupContent,{className:"bx-ilike-popup-content"},true);if(t.length<=0){t=[BXRL[e].popupContent]}var i=null;for(var n=0;n<t.length;n++){i=t[n];BX.bind(i,"scroll",(function(){if(this.scrollTop>(this.scrollHeight-this.offsetHeight)/1.5){RatingLike.List(e,null,BXRL[e].version==2?BXRL.render.popupCurrentReaction:false);BX.unbindAll(this)}}))}};RatingLike.setParams=function(e){if(typeof e!="undefined"){if(typeof e.pathToUserProfile!="undefined"){BXRLParams.pathToUserProfile=e.pathToUserProfile}}};
//# sourceMappingURL=rating_like.map.js