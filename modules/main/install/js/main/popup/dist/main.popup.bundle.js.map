{"version":3,"file":"main.popup.bundle.js","sources":["../src/compatibility/button.js","../src/popup/position-event.js","../src/popup/popup.js","../src/popup/popup-manager.js","../src/menu/menu-item.js","../src/menu/menu.js","../src/menu/menu-manager.js","../src/compatibility/popup-window.js","../src/compatibility/popup-window-button.js","../src/compatibility/buttonlink.js","../src/compatibility/popup-window-button-link.js","../src/compatibility/custombutton.js","../src/compatibility/popup-window-custom-button.js","../src/compatibility/popup-menu-window.js","../src/compatibility/popup-menu-item.js","../src/compatibility/input-popup.js","../src/index.js"],"sourcesContent":["import { Type, Dom } from 'main.core';\n\ndeclare type ButtonOptions = {\n\tid?: string,\n\ttext?: string,\n\tclassName?: string,\n\tevents?: { [event: string]: (event) => {} }\n};\n\n/**\n * @memberOf BX.Main.Popup\n * @deprecated use BX.UI.Button\n */\nexport default class Button\n{\n\tconstructor(params: ButtonOptions)\n\t{\n\t\tthis.popupWindow = null;\n\n\t\tthis.params = params || {};\n\n\t\tthis.text = this.params.text || '';\n\t\tthis.id = this.params.id || '';\n\t\tthis.className = this.params.className || '';\n\t\tthis.events = this.params.events || {};\n\n\t\tthis.contextEvents = {};\n\t\tfor (let eventName in this.events)\n\t\t{\n\t\t\tif (Type.isFunction(this.events[eventName]))\n\t\t\t{\n\t\t\t\tthis.contextEvents[eventName] = this.events[eventName].bind(this);\n\t\t\t}\n\t\t}\n\n\t\tthis.buttonNode = Dom.create(\n\t\t\t'span',\n\t\t\t{\n\t\t\t\tprops: {\n\t\t\t\t\tclassName: 'popup-window-button' + (this.className.length > 0 ? ' ' + this.className : ''),\n\t\t\t\t\tid: this.id\n\t\t\t\t},\n\t\t\t\tevents: this.contextEvents,\n\t\t\t\ttext: this.text\n\t\t\t}\n\t\t);\n\t}\n\n\trender(): Element\n\t{\n\t\treturn this.buttonNode;\n\t}\n\n\tgetId(): string\n\t{\n\t\treturn this.id;\n\t}\n\n\tgetContainer(): Element\n\t{\n\t\treturn this.buttonNode;\n\t}\n\n\tgetName(): string\n\t{\n\t\treturn this.text;\n\t}\n\n\tsetName(name: string)\n\t{\n\t\tthis.text = name || '';\n\t\tif (this.buttonNode)\n\t\t{\n\t\t\tDom.clean(this.buttonNode);\n\t\t\tDom.adjust(this.buttonNode, { text: this.text });\n\t\t}\n\t}\n\n\tsetClassName(className: string)\n\t{\n\t\tif (this.buttonNode)\n\t\t{\n\t\t\tif (Type.isString(this.className) && (this.className !== ''))\n\t\t\t{\n\t\t\t\tDom.removeClass(this.buttonNode, this.className);\n\t\t\t}\n\n\t\t\tDom.addClass(this.buttonNode, className);\n\t\t}\n\n\t\tthis.className = className;\n\t}\n\n\taddClassName(className: string)\n\t{\n\t\tif (this.buttonNode)\n\t\t{\n\t\t\tDom.addClass(this.buttonNode, className);\n\t\t\tthis.className = this.buttonNode.className;\n\t\t}\n\t}\n\n\tremoveClassName(className: string)\n\t{\n\t\tif (this.buttonNode)\n\t\t{\n\t\t\tDom.removeClass(this.buttonNode, className);\n\t\t\tthis.className = this.buttonNode.className;\n\t\t}\n\t}\n}","import { Type } from 'main.core';\nimport { BaseEvent } from 'main.core.events';\n\nexport default class PositionEvent extends BaseEvent\n{\n\t#left: number;\n\t#top: number;\n\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tget left(): number\n\t{\n\t\treturn this.#left;\n\t}\n\n\tset left(value: number)\n\t{\n\t\tif (Type.isNumber(value))\n\t\t{\n\t\t\tthis.#left = value;\n\t\t}\n\t}\n\n\tget top(): number\n\t{\n\t\treturn this.#top;\n\t}\n\n\tset top(value: number): void\n\t{\n\t\tif (Type.isNumber(value))\n\t\t{\n\t\t\tthis.#top = value;\n\t\t}\n\t}\n}","import Button from '../compatibility/button';\n\nimport { Type, Text, Tag, Event, Dom, Browser, Reflection } from 'main.core';\nimport { EventEmitter, BaseEvent } from 'main.core.events';\nimport { type PopupOptions, type PopupTarget, type PopupAnimationOptions } from './popup-types';\nimport { ZIndexManager, ZIndexComponent } from 'main.core.z-index-manager';\nimport PositionEvent from './position-event';\n\ndeclare type TargetPosition = {\n\tleft: number,\n\ttop: number,\n\tbottom: number,\n\twindowSize: number,\n\twindowScroll: number,\n\tpopupWidth: number,\n\tpopupHeight: number\n};\n\nconst aliases = {\n\tonPopupWindowInit: { namespace: 'BX.Main.Popup', eventName: 'onInit' },\n\tonPopupWindowIsInitialized: { namespace: 'BX.Main.Popup', eventName: 'onAfterInit' },\n\tonPopupFirstShow: { namespace: 'BX.Main.Popup', eventName: 'onFirstShow' },\n\tonPopupShow: { namespace: 'BX.Main.Popup', eventName: 'onShow' },\n\tonAfterPopupShow: { namespace: 'BX.Main.Popup', eventName: 'onAfterShow' },\n\tonPopupClose: { namespace: 'BX.Main.Popup', eventName: 'onClose' },\n\tonPopupAfterClose: { namespace: 'BX.Main.Popup', eventName: 'onAfterClose' },\n\tonPopupDestroy: { namespace: 'BX.Main.Popup', eventName: 'onDestroy' },\n\tonPopupFullscreenLeave: { namespace: 'BX.Main.Popup', eventName: 'onFullscreenLeave' },\n\tonPopupFullscreenEnter: { namespace: 'BX.Main.Popup', eventName: 'onFullscreenEnter' },\n\tonPopupDragStart: { namespace: 'BX.Main.Popup', eventName: 'onDragStart' },\n\tonPopupDrag: { namespace: 'BX.Main.Popup', eventName: 'onDrag' },\n\tonPopupDragEnd: { namespace: 'BX.Main.Popup', eventName: 'onDragEnd' },\n\tonPopupResizeStart: { namespace: 'BX.Main.Popup', eventName: 'onResizeStart' },\n\tonPopupResize: { namespace: 'BX.Main.Popup', eventName: 'onResize' },\n\tonPopupResizeEnd: { namespace: 'BX.Main.Popup', eventName: 'onResizeEnd' }\n};\n\nEventEmitter.registerAliases(aliases);\n\n/**\n * @memberof BX.Main\n */\nexport default class Popup extends EventEmitter\n{\n\t/**\n\t * @private\n\t */\n\tstatic options = {};\n\n\t/**\n\t * @private\n\t */\n\tstatic defaultOptions = {\n\n\t\t//left offset for popup about target\n\t\tangleLeftOffset: 40,\n\n\t\t//when popup position is 'top' offset distance between popup body and target node\n\t\tpositionTopXOffset: -11,\n\n\t\t//offset distance between popup body and target node if use angle, sum with positionTopXOffset\n\t\tangleTopOffset: 10,\n\n\t\tpopupZindex: 1000,\n\t\tpopupOverlayZindex: 1100,\n\n\t\tangleMinLeft: 10,\n\t\tangleMaxLeft: 30,\n\n\t\tangleMinRight: 10,\n\t\tangleMaxRight: 30,\n\n\t\tangleMinBottom: 23,\n\t\tangleMaxBottom: 25,\n\n\t\tangleMinTop: 23,\n\t\tangleMaxTop: 25,\n\n\t\toffsetLeft: 0,\n\t\toffsetTop: 0\n\t};\n\n\tstatic setOptions(options: { [name: string]: any })\n\t{\n\t\tif (!Type.isPlainObject(options))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tfor (let option in options)\n\t\t{\n\t\t\tthis.options[option] = options[option];\n\t\t}\n\t}\n\n\tstatic getOption(option: string, defaultValue?: any)\n\t{\n\t\tif (!Type.isUndefined(this.options[option]))\n\t\t{\n\t\t\treturn this.options[option];\n\t\t}\n\t\telse if (!Type.isUndefined(defaultValue))\n\t\t{\n\t\t\treturn defaultValue;\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn this.defaultOptions[option];\n\t\t}\n\t}\n\n\tconstructor(options?: PopupOptions)\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Main.Popup');\n\n\t\tlet [popupId: string, bindElement: PopupTarget, params: PopupOptions] = arguments; //compatible arguments\n\n\t\tthis.compatibleMode = params && Type.isBoolean(params.compatibleMode) ? params.compatibleMode : true;\n\t\tif (Type.isPlainObject(options) && !bindElement && !params)\n\t\t{\n\t\t\tparams = options;\n\t\t\tpopupId = options.id;\n\t\t\tbindElement = options.bindElement;\n\t\t\tthis.compatibleMode = false;\n\t\t}\n\n\t\tparams = params || {};\n\t\tthis.params = params;\n\n\t\tif (!Type.isStringFilled(popupId))\n\t\t{\n\t\t\tpopupId = 'popup-window-' + Text.getRandom().toLowerCase();\n\t\t}\n\n\t\tthis.emit('onInit', new BaseEvent({ compatData: [popupId, bindElement, params] }));\n\n\t\t/**\n\t\t * @private\n\t\t */\n\t\tthis.uniquePopupId = popupId;\n\t\tthis.params.zIndex = Type.isNumber(params.zIndex) ? parseInt(params.zIndex) : 0;\n\t\tthis.params.zIndexAbsolute = Type.isNumber(params.zIndexAbsolute) ? parseInt(params.zIndexAbsolute) : 0;\n\t\tthis.buttons = params.buttons && Type.isArray(params.buttons) ? params.buttons : [];\n\t\tthis.offsetTop = Popup.getOption('offsetTop');\n\t\tthis.offsetLeft = Popup.getOption('offsetLeft');\n\t\tthis.firstShow = false;\n\t\tthis.bordersWidth = 20;\n\t\tthis.bindElementPos = null;\n\t\tthis.closeIcon = null;\n\t\tthis.resizeIcon = null;\n\t\tthis.angle = null;\n\t\tthis.angleArrowElement = null;\n\t\tthis.overlay = null;\n\t\tthis.titleBar = null;\n\t\tthis.bindOptions = typeof (params.bindOptions) === 'object' ? params.bindOptions : {};\n\t\tthis.autoHide = params.autoHide === true;\n\t\tthis.isScrollBlock = params.isScrollBlock === true;\n\t\tthis.autoHideHandler = Type.isFunction(params.autoHideHandler) ? params.autoHideHandler : null;\n\t\tthis.handleAutoHide = this.handleAutoHide.bind(this);\n\t\tthis.handleOverlayClick = this.handleOverlayClick.bind(this);\n\t\tthis.isAutoHideBinded = false;\n\t\tthis.closeByEsc = params.closeByEsc === true;\n\t\tthis.isCloseByEscBinded = false;\n\t\tthis.toFrontOnShow = true;\n\n\t\tthis.cacheable = true;\n\t\tthis.destroyed = false;\n\n\t\tthis.width = null;\n\t\tthis.height = null;\n\t\tthis.minWidth = null;\n\t\tthis.minHeight = null;\n\t\tthis.maxWidth = null;\n\t\tthis.maxHeight = null;\n\n\t\tthis.padding = null;\n\t\tthis.contentPadding = null;\n\t\tthis.background = null;\n\t\tthis.contentBackground = null;\n\n\t\tthis.borderRadius = null;\n\t\tthis.contentBorderRadius = null;\n\n\t\tthis.targetContainer = Type.isElementNode(params.targetContainer) ? params.targetContainer : document.body;\n\n\t\tthis.dragOptions = {\n\t\t\tcursor: '',\n\t\t\tcallback: function() {\n\t\t\t},\n\t\t\teventName: ''\n\t\t};\n\n\t\tthis.dragged = false;\n\t\tthis.dragPageX = 0;\n\t\tthis.dragPageY = 0;\n\n\t\tthis.animationShowClassName = null;\n\t\tthis.animationCloseClassName = null;\n\t\tthis.animationCloseEventType = null;\n\n\t\tthis.handleDocumentMouseMove = this.handleDocumentMouseMove.bind(this);\n\t\tthis.handleDocumentMouseUp = this.handleDocumentMouseUp.bind(this);\n\t\tthis.handleDocumentKeyUp = this.handleDocumentKeyUp.bind(this);\n\t\tthis.handleResizeWindow = this.handleResizeWindow.bind(this);\n\t\tthis.handleResize = this.handleResize.bind(this);\n\t\tthis.handleMove = this.handleMove.bind(this);\n\t\tthis.onTitleMouseDown = this.onTitleMouseDown.bind(this);\n\t\tthis.handleFullScreen = this.handleFullScreen.bind(this);\n\n\t\tthis.subscribeFromOptions(params.events);\n\n\t\tlet popupClassName = 'popup-window';\n\n\t\tif (params.titleBar)\n\t\t{\n\t\t\tpopupClassName += ' popup-window-with-titlebar';\n\t\t}\n\n\t\tif (params.className && Type.isStringFilled(params.className))\n\t\t{\n\t\t\tpopupClassName += ' ' + params.className;\n\t\t}\n\n\t\tif (params.darkMode)\n\t\t{\n\t\t\tpopupClassName += ' popup-window-dark';\n\t\t}\n\n\t\tif (params.titleBar)\n\t\t{\n\t\t\tthis.titleBar = Tag.render`\n\t\t\t\t<div class=\"popup-window-titlebar\" id=\"popup-window-titlebar-${popupId}\"></div>\n\t\t\t`;\n\t\t}\n\n\t\tif (params.closeIcon)\n\t\t{\n\t\t\tconst className = 'popup-window-close-icon' + (params.titleBar ? ' popup-window-titlebar-close-icon' : '');\n\t\t\tthis.closeIcon = Tag.render`\n\t\t\t\t<span class=\"${className}\" onclick=\"${this.handleCloseIconClick.bind(this)}\"></span>\n\t\t\t`;\n\n\t\t\tif (Type.isPlainObject(params.closeIcon))\n\t\t\t{\n\t\t\t\tDom.style(this.closeIcon, params.closeIcon);\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * @private\n\t\t */\n\t\tthis.contentContainer = Tag.render\n\t\t\t`<div id=\"popup-window-content-${popupId}\" class=\"popup-window-content\"></div>`\n\t\t;\n\n\t\t/**\n\t\t * @private\n\t\t */\n\t\tthis.popupContainer = Tag.render\n\t\t\t`<div\n\t\t\t\tclass=\"${popupClassName}\"\n\t\t\t\tid=\"${popupId}\"\n\t\t\t\tstyle=\"display: none; position: absolute; left: 0; top: 0;\"\n\t\t\t>${[this.titleBar, this.contentContainer, this.closeIcon]}</div>`\n\t\t;\n\n\t\tthis.targetContainer.appendChild(this.popupContainer);\n\n\t\tthis.zIndexComponent = ZIndexManager.register(this.popupContainer, params.zIndexOptions);\n\n\t\tthis.buttonsContainer = null;\n\n\t\tif (params.contentColor && Type.isStringFilled(params.contentColor))\n\t\t{\n\t\t\tif (\n\t\t\t\tparams.contentColor === 'white'\n\t\t\t\t|| params.contentColor === 'gray'\n\t\t\t)\n\t\t\t{\n\t\t\t\tpopupClassName += ' popup-window-content-' + params.contentColor;\n\t\t\t}\n\n\t\t\tthis.setContentColor(params.contentColor);\n\n\t\t}\n\n\t\tif (params.angle)\n\t\t{\n\t\t\tthis.setAngle(params.angle);\n\t\t}\n\n\t\tif (params.overlay)\n\t\t{\n\t\t\tthis.setOverlay(params.overlay);\n\t\t}\n\n\t\tthis.setOffset(params);\n\t\tthis.setBindElement(bindElement);\n\t\tthis.setTitleBar(params.titleBar);\n\t\tthis.setContent(params.content);\n\t\tthis.setButtons(params.buttons);\n\t\tthis.setWidth(params.width);\n\t\tthis.setHeight(params.height);\n\t\tthis.setMinWidth(params.minWidth);\n\t\tthis.setMinHeight(params.minHeight);\n\t\tthis.setMaxWidth(params.maxWidth);\n\t\tthis.setMaxHeight(params.maxHeight);\n\t\tthis.setResizeMode(params.resizable);\n\t\tthis.setPadding(params.padding);\n\t\tthis.setContentPadding(params.contentPadding);\n\t\tthis.setBorderRadius(params.borderRadius);\n\t\tthis.setContentBorderRadius(params.contentBorderRadius);\n\t\tthis.setBackground(params.background);\n\t\tthis.setContentBackground(params.contentBackground);\n\t\tthis.setAnimation(params.animation);\n\t\tthis.setCacheable(params.cacheable);\n\t\tthis.setToFrontOnShow(params.toFrontOnShow);\n\n\t\t// Compatibility\n\t\tif (params.contentNoPaddings)\n\t\t{\n\t\t\tthis.setContentPadding(0);\n\t\t}\n\t\tif (params.noAllPaddings)\n\t\t{\n\t\t\tthis.setPadding(0);\n\t\t\tthis.setContentPadding(0);\n\t\t}\n\n\t\tif (params.bindOnResize !== false)\n\t\t{\n\t\t\tEvent.bind(window, 'resize', this.handleResizeWindow);\n\t\t}\n\n\t\tthis.emit('onAfterInit', new BaseEvent({ compatData: [popupId, this] }));\n\t}\n\n\t/**\n\t * @private\n\t */\n\tsubscribeFromOptions(events): void\n\t{\n\t\tsuper.subscribeFromOptions(events, aliases);\n\t}\n\n\tgetId(): string\n\t{\n\t\treturn this.uniquePopupId;\n\t}\n\n\tisCompatibleMode(): boolean\n\t{\n\t\treturn this.compatibleMode;\n\t}\n\n\tsetContent(content: string | Element | Node)\n\t{\n\t\tif (!this.contentContainer || !content)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (Type.isElementNode(content))\n\t\t{\n\t\t\tDom.clean(this.contentContainer);\n\n\t\t\tconst hasParent = Type.isDomNode(content.parentNode);\n\t\t\tthis.contentContainer.appendChild(content);\n\t\t\tif (this.isCompatibleMode() || hasParent)\n\t\t\t{\n\t\t\t\tcontent.style.display = 'block';\n\t\t\t}\n\t\t}\n\t\telse if (Type.isString(content))\n\t\t{\n\t\t\tthis.contentContainer.innerHTML = content;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.contentContainer.innerHTML = '&nbsp;';\n\t\t}\n\t}\n\n\tsetButtons(buttons: [])\n\t{\n\t\tthis.buttons = buttons && Type.isArray(buttons) ? buttons : [];\n\n\t\tif (this.buttonsContainer)\n\t\t{\n\t\t\tDom.remove(this.buttonsContainer);\n\t\t}\n\n\t\tconst ButtonClass = Reflection.getClass('BX.UI.Button');\n\t\tif (this.buttons.length > 0 && this.contentContainer)\n\t\t{\n\t\t\tconst newButtons = [];\n\t\t\tfor (let i = 0; i < this.buttons.length; i++)\n\t\t\t{\n\t\t\t\tconst button = this.buttons[i];\n\t\t\t\tif (button instanceof Button)\n\t\t\t\t{\n\t\t\t\t\tbutton.popupWindow = this;\n\t\t\t\t\tnewButtons.push(button.render());\n\t\t\t\t}\n\t\t\t\telse if (ButtonClass && (button instanceof ButtonClass))\n\t\t\t\t{\n\t\t\t\t\tbutton.setContext(this);\n\t\t\t\t\tnewButtons.push(button.render());\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.buttonsContainer = this.contentContainer.parentNode.appendChild(\n\t\t\t\tTag.render`<div class=\"popup-window-buttons\">${newButtons}</div>`\n\t\t\t);\n\t\t}\n\t}\n\n\tgetButtons(): []\n\t{\n\t\treturn this.buttons;\n\t}\n\n\tgetButton(id: string)\n\t{\n\t\tfor (let i = 0; i < this.buttons.length; i++)\n\t\t{\n\t\t\tconst button = this.buttons[i];\n\t\t\tif (button.getId() === id)\n\t\t\t{\n\t\t\t\treturn button;\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tsetBindElement(bindElement: Element | { left: number, top: number } | null | MouseEvent)\n\t{\n\t\tif (bindElement === null)\n\t\t{\n\t\t\tthis.bindElement = null;\n\t\t}\n\t\telse if (typeof (bindElement) === 'object')\n\t\t{\n\t\t\tif (Type.isDomNode(bindElement) || (Type.isNumber(bindElement.top) && Type.isNumber(bindElement.left)))\n\t\t\t{\n\t\t\t\tthis.bindElement = bindElement;\n\t\t\t}\n\t\t\telse if (Type.isNumber(bindElement.clientX) && Type.isNumber(bindElement.clientY))\n\t\t\t{\n\t\t\t\tthis.bindElement = { left: bindElement.pageX, top: bindElement.pageY, bottom: bindElement.pageY };\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t */\n\tgetBindElementPos(bindElement: HTMLElement | any): TargetPosition | DOMRect\n\t{\n\t\tif (Type.isDomNode(bindElement))\n\t\t{\n\t\t\tif (this.isTargetDocumentBody())\n\t\t\t{\n\t\t\t\treturn Dom.getPosition(bindElement);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\treturn this.getPositionRelativeToTarget(bindElement);\n\t\t\t}\n\t\t}\n\t\telse if (bindElement && typeof (bindElement) === 'object')\n\t\t{\n\t\t\tif (!Type.isNumber(bindElement.bottom))\n\t\t\t{\n\t\t\t\tbindElement.bottom = bindElement.top;\n\t\t\t}\n\n\t\t\treturn bindElement;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst windowSize = this.getWindowSize();\n\t\t\tconst windowScroll = this.getWindowScroll();\n\n\t\t\tconst popupWidth = this.getPopupContainer().offsetWidth;\n\t\t\tconst popupHeight = this.getPopupContainer().offsetHeight;\n\n\t\t\tthis.bindOptions.forceTop = true;\n\n\t\t\treturn {\n\t\t\t\tleft: windowSize.innerWidth / 2 - popupWidth / 2 + windowScroll.scrollLeft,\n\t\t\t\ttop: windowSize.innerHeight / 2 - popupHeight / 2 + windowScroll.scrollTop,\n\t\t\t\tbottom: windowSize.innerHeight / 2 - popupHeight / 2 + windowScroll.scrollTop,\n\n\t\t\t\t//for optimisation purposes\n\t\t\t\twindowSize: windowSize,\n\t\t\t\twindowScroll: windowScroll,\n\t\t\t\tpopupWidth: popupWidth,\n\t\t\t\tpopupHeight: popupHeight\n\t\t\t};\n\t\t}\n\t}\n\n\t/**\n\t * @internal\n\t */\n\tgetPositionRelativeToTarget(element: HTMLElement): DOMRect\n\t{\n\t\tlet offsetLeft = element.offsetLeft;\n\t\tlet offsetTop = element.offsetTop;\n\t\tlet offsetElement = element.offsetParent;\n\n\t\twhile (offsetElement && offsetElement !== this.getTargetContainer())\n\t\t{\n\t\t\toffsetLeft += offsetElement.offsetLeft;\n\t\t\toffsetTop += offsetElement.offsetTop;\n\t\t\toffsetElement = offsetElement.offsetParent;\n\t\t}\n\n\t\tconst elementRect = element.getBoundingClientRect();\n\n\t\treturn new DOMRect(\n\t\t\toffsetLeft,\n\t\t\toffsetTop,\n\t\t\telementRect.width,\n\t\t\telementRect.height\n\t\t);\n\t}\n\n\t// private\n\tgetWindowSize(): { innerWidth: number, innerHeight: number }\n\t{\n\t\tif (this.isTargetDocumentBody())\n\t\t{\n\t\t\treturn {\n\t\t\t\tinnerWidth: window.innerWidth,\n\t\t\t\tinnerHeight: window.innerHeight\n\t\t\t};\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn {\n\t\t\t\tinnerWidth: this.getTargetContainer().offsetWidth,\n\t\t\t\tinnerHeight: this.getTargetContainer().offsetHeight\n\t\t\t};\n\t\t}\n\t}\n\n\t// private\n\tgetWindowScroll()\n\t{\n\t\tif (this.isTargetDocumentBody())\n\t\t{\n\t\t\treturn {\n\t\t\t\tscrollLeft: window.pageXOffset,\n\t\t\t\tscrollTop: window.pageYOffset\n\t\t\t};\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn {\n\t\t\t\tscrollLeft: this.getTargetContainer().scrollLeft,\n\t\t\t\tscrollTop: this.getTargetContainer().scrollTop\n\t\t\t};\n\t\t}\n\t}\n\n\tsetAngle(params: { offset: number, position?: 'top' | 'bottom' | 'left' | 'right' })\n\t{\n\t\tif (params === false)\n\t\t{\n\t\t\tif (this.angle !== null)\n\t\t\t{\n\t\t\t\tDom.remove(this.angle.element);\n\t\t\t}\n\n\t\t\tthis.angle = null;\n\t\t\tthis.angleArrowElement = null;\n\t\t\treturn;\n\t\t}\n\n\t\tconst className = 'popup-window-angly';\n\t\tif (this.angle === null)\n\t\t{\n\t\t\tconst position = this.bindOptions.position && this.bindOptions.position === 'top' ? 'bottom' : 'top';\n\t\t\tconst angleMinLeft = Popup.getOption(position === 'top' ? 'angleMinTop' : 'angleMinBottom');\n\t\t\tlet defaultOffset = Type.isNumber(params.offset) ? params.offset : 0;\n\n\t\t\tconst angleLeftOffset = Popup.getOption('angleLeftOffset', null);\n\t\t\tif (defaultOffset > 0 && Type.isNumber(angleLeftOffset))\n\t\t\t{\n\t\t\t\tdefaultOffset += angleLeftOffset - Popup.defaultOptions.angleLeftOffset;\n\t\t\t}\n\n\t\t\tthis.angleArrowElement = Tag.render`<div class=\"popup-window-angly--arrow\"></div>`;\n\t\t\tif (this.background)\n\t\t\t{\n\t\t\t\tthis.angleArrowElement.style.background = this.background;\n\t\t\t}\n\n\t\t\tthis.angle = {\n\t\t\t\telement: Tag.render`\n\t\t\t\t\t<div class=\"${className} ${className}-${position}\">\n\t\t\t\t\t\t${this.angleArrowElement}\n\t\t\t\t\t</div>\n\t\t\t\t`,\n\t\t\t\tposition: position,\n\t\t\t\toffset: 0,\n\t\t\t\tdefaultOffset: Math.max(defaultOffset, angleMinLeft)\n\t\t\t\t//Math.max(Type.isNumber(params.offset) ? params.offset : 0, angleMinLeft)\n\t\t\t};\n\n\t\t\tthis.getPopupContainer().appendChild(this.angle.element);\n\t\t}\n\n\t\tif (typeof (params) === 'object' && params.position && ['top', 'right', 'bottom', 'left', 'hide'].includes(params.position))\n\t\t{\n\t\t\tDom.removeClass(this.angle.element, className + '-' + this.angle.position);\n\t\t\tDom.addClass(this.angle.element, className + '-' + params.position);\n\n\t\t\tthis.angle.position = params.position;\n\t\t}\n\n\t\tif (typeof (params) === 'object' && Type.isNumber(params.offset))\n\t\t{\n\t\t\tconst offset = params.offset;\n\t\t\tlet minOffset, maxOffset;\n\t\t\tif (this.angle.position === 'top')\n\t\t\t{\n\t\t\t\tminOffset = Popup.getOption('angleMinTop');\n\t\t\t\tmaxOffset = this.getPopupContainer().offsetWidth - Popup.getOption('angleMaxTop');\n\t\t\t\tmaxOffset = maxOffset < minOffset ? Math.max(minOffset, offset) : maxOffset;\n\n\t\t\t\tthis.angle.offset = Math.min(Math.max(minOffset, offset), maxOffset);\n\t\t\t\tthis.angle.element.style.left = this.angle.offset + 'px';\n\t\t\t\tthis.angle.element.style.marginLeft = 0;\n\t\t\t\tthis.angle.element.style.removeProperty('top');\n\t\t\t}\n\t\t\telse if (this.angle.position === 'bottom')\n\t\t\t{\n\t\t\t\tminOffset = Popup.getOption('angleMinBottom');\n\t\t\t\tmaxOffset = this.getPopupContainer().offsetWidth - Popup.getOption('angleMaxBottom');\n\t\t\t\tmaxOffset = maxOffset < minOffset ? Math.max(minOffset, offset) : maxOffset;\n\n\t\t\t\tthis.angle.offset = Math.min(Math.max(minOffset, offset), maxOffset);\n\t\t\t\tthis.angle.element.style.marginLeft = this.angle.offset + 'px';\n\t\t\t\tthis.angle.element.style.left = 0;\n\t\t\t\tthis.angle.element.style.removeProperty('top');\n\t\t\t}\n\t\t\telse if (this.angle.position === 'right')\n\t\t\t{\n\t\t\t\tminOffset = Popup.getOption('angleMinRight');\n\t\t\t\tmaxOffset = this.getPopupContainer().offsetHeight - Popup.getOption('angleMaxRight');\n\t\t\t\tmaxOffset = maxOffset < minOffset ? Math.max(minOffset, offset) : maxOffset;\n\n\t\t\t\tthis.angle.offset = Math.min(Math.max(minOffset, offset), maxOffset);\n\t\t\t\tthis.angle.element.style.top = this.angle.offset + 'px';\n\t\t\t\tthis.angle.element.style.removeProperty('left');\n\t\t\t\tthis.angle.element.style.removeProperty('margin-left');\n\t\t\t}\n\t\t\telse if (this.angle.position === 'left')\n\t\t\t{\n\t\t\t\tminOffset = Popup.getOption('angleMinLeft');\n\t\t\t\tmaxOffset = this.getPopupContainer().offsetHeight - Popup.getOption('angleMaxLeft');\n\t\t\t\tmaxOffset = maxOffset < minOffset ? Math.max(minOffset, offset) : maxOffset;\n\n\t\t\t\tthis.angle.offset = Math.min(Math.max(minOffset, offset), maxOffset);\n\t\t\t\tthis.angle.element.style.top = this.angle.offset + 'px';\n\t\t\t\tthis.angle.element.style.removeProperty('left');\n\t\t\t\tthis.angle.element.style.removeProperty('margin-left');\n\t\t\t}\n\t\t}\n\t}\n\n\tgetWidth(): number\n\t{\n\t\treturn this.width;\n\t}\n\n\tsetWidth(width: number)\n\t{\n\t\tthis.setWidthProperty('width', width);\n\t}\n\n\tgetHeight(): number\n\t{\n\t\treturn this.height;\n\t}\n\n\tsetHeight(height: number)\n\t{\n\t\tthis.setHeightProperty('height', height);\n\t}\n\n\tgetMinWidth(): number\n\t{\n\t\treturn this.minWidth;\n\t}\n\n\tsetMinWidth(width: number)\n\t{\n\t\tthis.setWidthProperty('minWidth', width);\n\t}\n\n\tgetMinHeight(): number\n\t{\n\t\treturn this.minHeight;\n\t}\n\n\tsetMinHeight(height: number)\n\t{\n\t\tthis.setHeightProperty('minHeight', height);\n\t}\n\n\tgetMaxWidth(): number\n\t{\n\t\treturn this.maxWidth;\n\t}\n\n\tsetMaxWidth(width: number)\n\t{\n\t\tthis.setWidthProperty('maxWidth', width);\n\t}\n\n\tgetMaxHeight(): number\n\t{\n\t\treturn this.maxHeight;\n\t}\n\n\tsetMaxHeight(height: number)\n\t{\n\t\tthis.setHeightProperty('maxHeight', height);\n\t}\n\n\t/**\n\t * @private\n\t */\n\tsetWidthProperty(property: string, width: number)\n\t{\n\t\tconst props = ['width', 'minWidth', 'maxWidth'];\n\t\tif (props.indexOf(property) === -1)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (Type.isNumber(width) && width >= 0)\n\t\t{\n\t\t\tthis[property] = width;\n\t\t\tthis.getResizableContainer().style[property] = width + 'px';\n\t\t\tthis.getContentContainer().style.overflowX = 'auto';\n\t\t\tthis.getPopupContainer().classList.add('popup-window-fixed-width');\n\n\t\t\tif (this.getTitleContainer() && Browser.isIE11())\n\t\t\t{\n\t\t\t\tthis.getTitleContainer().style[property] = width + 'px';\n\t\t\t}\n\t\t}\n\t\telse if (width === null || width === false)\n\t\t{\n\t\t\tthis[property] = null;\n\t\t\tthis.getResizableContainer().style.removeProperty(Text.toKebabCase(property));\n\n\t\t\tconst hasOtherProps = props.some(function(prop) {\n\t\t\t\treturn this.getResizableContainer().style.getPropertyValue(Text.toKebabCase(prop)) !== '';\n\t\t\t}, this);\n\n\t\t\tif (!hasOtherProps)\n\t\t\t{\n\t\t\t\tthis.getContentContainer().style.removeProperty('overflow-x');\n\t\t\t\tthis.getPopupContainer().classList.remove('popup-window-fixed-width');\n\t\t\t}\n\n\t\t\tif (this.getTitleContainer() && Browser.isIE11())\n\t\t\t{\n\t\t\t\tthis.getTitleContainer().style.removeProperty(Text.toKebabCase(property));\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t */\n\tsetHeightProperty(property: string, height: number)\n\t{\n\t\tconst props = ['height', 'minHeight', 'maxHeight'];\n\t\tif (props.indexOf(property) === -1)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (Type.isNumber(height) && height >= 0)\n\t\t{\n\t\t\tthis[property] = height;\n\t\t\tthis.getResizableContainer().style[property] = height + 'px';\n\t\t\tthis.getContentContainer().style.overflowY = 'auto';\n\t\t\tthis.getPopupContainer().classList.add('popup-window-fixed-height');\n\t\t}\n\t\telse if (height === null || height === false)\n\t\t{\n\t\t\tthis[property] = null;\n\t\t\tthis.getResizableContainer().style.removeProperty(Text.toKebabCase(property));\n\n\t\t\tconst hasOtherProps = props.some(function(prop) {\n\t\t\t\treturn this.getResizableContainer().style.getPropertyValue(Text.toKebabCase(prop)) !== '';\n\t\t\t}, this);\n\n\t\t\tif (!hasOtherProps)\n\t\t\t{\n\t\t\t\tthis.getContentContainer().style.removeProperty('overflow-y');\n\t\t\t\tthis.getPopupContainer().classList.remove('popup-window-fixed-height');\n\t\t\t}\n\t\t}\n\t}\n\n\tsetPadding(padding: number)\n\t{\n\t\tif (Type.isNumber(padding) && padding >= 0)\n\t\t{\n\t\t\tthis.padding = padding;\n\t\t\tthis.getPopupContainer().style.padding = padding + 'px';\n\t\t}\n\t\telse if (padding === null)\n\t\t{\n\t\t\tthis.padding = null;\n\t\t\tthis.getPopupContainer().style.removeProperty('padding');\n\t\t}\n\t}\n\n\tgetPadding(): number\n\t{\n\t\treturn this.padding;\n\t}\n\n\tsetContentPadding(padding: number)\n\t{\n\t\tif (Type.isNumber(padding) && padding >= 0)\n\t\t{\n\t\t\tthis.contentPadding = padding;\n\t\t\tthis.getContentContainer().style.padding = padding + 'px';\n\t\t}\n\t\telse if (padding === null)\n\t\t{\n\t\t\tthis.contentPadding = null;\n\t\t\tthis.getContentContainer().style.removeProperty('padding');\n\t\t}\n\t}\n\n\tgetContentPadding(): number\n\t{\n\t\treturn this.contentPadding;\n\t}\n\n\tsetBorderRadius(radius): void\n\t{\n\t\tif (Type.isStringFilled(radius))\n\t\t{\n\t\t\tthis.borderRadius = radius;\n\t\t\tthis.getPopupContainer().style.setProperty('--popup-window-border-radius', radius);\n\t\t}\n\t\telse if (radius === null)\n\t\t{\n\t\t\tthis.borderRadius = null;\n\t\t\tthis.getPopupContainer().style.removeProperty('--popup-window-border-radius');\n\t\t}\n\t}\n\n\tsetContentBorderRadius(radius): void\n\t{\n\t\tif (Type.isStringFilled(radius))\n\t\t{\n\t\t\tthis.contentBorderRadius = radius;\n\t\t\tthis.getContentContainer().style.setProperty('--popup-window-content-border-radius', radius);\n\t\t}\n\t\telse if (radius === null)\n\t\t{\n\t\t\tthis.contentBorderRadius = null;\n\t\t\tthis.getContentContainer().style.removeProperty('--popup-window-content-border-radius');\n\t\t}\n\t}\n\n\tsetContentColor(color: string | null)\n\t{\n\t\tif (Type.isString(color) && this.contentContainer)\n\t\t{\n\t\t\tthis.contentContainer.style.backgroundColor = color;\n\t\t}\n\t\telse if (color === null)\n\t\t{\n\t\t\tthis.contentContainer.style.style.removeProperty('background-color');\n\t\t}\n\t}\n\n\tsetBackground(background: string | null)\n\t{\n\t\tif (Type.isStringFilled(background))\n\t\t{\n\t\t\tthis.background = background;\n\t\t\tthis.getPopupContainer().style.background = background;\n\n\t\t\tif (this.angleArrowElement)\n\t\t\t{\n\t\t\t\tthis.angleArrowElement.style.background = background;\n\t\t\t}\n\t\t}\n\t\telse if (background === null)\n\t\t{\n\t\t\tthis.background = null;\n\t\t\tthis.getPopupContainer().style.removeProperty('background');\n\n\t\t\tif (this.angleArrowElement)\n\t\t\t{\n\t\t\t\tthis.angleArrowElement.style.removeProperty('background');\n\t\t\t}\n\t\t}\n\t}\n\n\tgetBackground(): string | null\n\t{\n\t\treturn this.background;\n\t}\n\n\tsetContentBackground(background: string | null)\n\t{\n\t\tif (Type.isStringFilled(background))\n\t\t{\n\t\t\tthis.contentBackground = background;\n\t\t\tthis.getContentContainer().style.background = background;\n\t\t}\n\t\telse if (background === null)\n\t\t{\n\t\t\tthis.contentBackground = null;\n\t\t\tthis.getContentContainer().style.removeProperty('background');\n\t\t}\n\t}\n\n\tgetContentBackground(): string | null\n\t{\n\t\treturn this.contentBackground;\n\t}\n\n\tisDestroyed(): boolean\n\t{\n\t\treturn this.destroyed;\n\t}\n\n\tsetCacheable(cacheable: boolean): void\n\t{\n\t\tthis.cacheable = cacheable !== false;\n\t}\n\n\tisCacheable(): boolean\n\t{\n\t\treturn this.cacheable;\n\t}\n\n\tsetToFrontOnShow(flag: boolean): void\n\t{\n\t\tthis.toFrontOnShow = flag !== false;\n\t}\n\n\tshouldFrontOnShow(): boolean\n\t{\n\t\treturn this.toFrontOnShow;\n\t}\n\n\tsetResizeMode(mode: boolean): void\n\t{\n\t\tif (mode === true || Type.isPlainObject(mode))\n\t\t{\n\t\t\tif (!this.resizeIcon)\n\t\t\t{\n\t\t\t\tthis.resizeIcon = Tag.render`\n\t\t\t\t\t<div class=\"popup-window-resize\" onmousedown=\"${this.handleResizeMouseDown.bind(this)}\"></div>\n\t\t\t\t`;\n\n\t\t\t\tthis.getPopupContainer().appendChild(this.resizeIcon);\n\t\t\t}\n\n\t\t\t//Compatibility\n\t\t\tthis.setMinWidth(mode.minWidth);\n\t\t\tthis.setMinHeight(mode.minHeight);\n\t\t}\n\t\telse if (mode === false && this.resizeIcon)\n\t\t{\n\t\t\tDom.remove(this.resizeIcon);\n\t\t\tthis.resizeIcon = null;\n\t\t}\n\t}\n\n\tgetTargetContainer(): HTMLElement\n\t{\n\t\treturn this.targetContainer;\n\t}\n\n\tisTargetDocumentBody(): boolean\n\t{\n\t\treturn this.getTargetContainer() === document.body;\n\t}\n\n\tgetPopupContainer(): Element\n\t{\n\t\treturn this.popupContainer;\n\t}\n\n\tgetContentContainer(): Element\n\t{\n\t\treturn this.contentContainer;\n\t}\n\n\tgetResizableContainer(): Element\n\t{\n\t\treturn Browser.isIE11() ? this.getContentContainer() : this.getPopupContainer();\n\t}\n\n\tgetTitleContainer(): Element\n\t{\n\t\treturn this.titleBar;\n\t}\n\n\t/**\n\t * @private\n\t */\n\tonTitleMouseDown(event: MouseEvent): void\n\t{\n\t\tthis._startDrag(\n\t\t\tevent,\n\t\t\t{\n\t\t\t\tcursor: 'move',\n\t\t\t\tcallback: this.handleMove,\n\t\t\t\teventName: 'Drag'\n\t\t\t}\n\t\t);\n\t}\n\n\t/**\n\t * @private\n\t */\n\thandleResizeMouseDown(event): void\n\t{\n\t\tthis._startDrag(\n\t\t\tevent,\n\t\t\t{\n\t\t\t\tcursor: 'nwse-resize',\n\t\t\t\teventName: 'Resize',\n\t\t\t\tcallback: this.handleResize\n\t\t\t}\n\t\t);\n\n\t\tif (this.isTargetDocumentBody())\n\t\t{\n\t\t\tthis.resizeContentPos = Dom.getPosition(this.getResizableContainer());\n\t\t\tthis.resizeContentOffset =\n\t\t\t\tthis.resizeContentPos.left - Dom.getPosition(this.getPopupContainer()).left;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.resizeContentPos = this.getPositionRelativeToTarget(this.getResizableContainer());\n\t\t\tthis.resizeContentOffset =\n\t\t\t\tthis.resizeContentPos.left - this.getPositionRelativeToTarget(this.getPopupContainer()).left;\n\t\t}\n\n\t\tthis.resizeContentPos.offsetX = 0;\n\t\tthis.resizeContentPos.offsetY = 0;\n\t}\n\n\t/**\n\t * @private\n\t */\n\thandleResize(offsetX, offsetY, pageX, pageY): void\n\t{\n\t\tthis.resizeContentPos.offsetX += offsetX;\n\t\tthis.resizeContentPos.offsetY += offsetY;\n\n\t\tlet width = this.resizeContentPos.width + this.resizeContentPos.offsetX;\n\t\tlet height = this.resizeContentPos.height + this.resizeContentPos.offsetY;\n\n\t\tconst scrollWidth =\n\t\t\tthis.isTargetDocumentBody() ? document.documentElement.scrollWidth : this.getTargetContainer().scrollWidth\n\t\t;\n\n\t\tif (this.resizeContentPos.left + width + this.resizeContentOffset >= scrollWidth)\n\t\t{\n\t\t\twidth = scrollWidth - this.resizeContentPos.left - this.resizeContentOffset;\n\t\t}\n\n\t\twidth = Math.max(width, this.getMinWidth());\n\t\theight = Math.max(height, this.getMinHeight());\n\n\t\tif (this.getMaxWidth() !== null)\n\t\t{\n\t\t\twidth = Math.min(width, this.getMaxWidth());\n\t\t}\n\n\t\tif (this.getMaxHeight() !== null)\n\t\t{\n\t\t\theight = Math.min(height, this.getMaxHeight());\n\t\t}\n\n\t\tthis.setWidth(width);\n\t\tthis.setHeight(height);\n\t}\n\n\tisTopAngle(): boolean\n\t{\n\t\treturn this.angle !== null && this.angle.position === 'top';\n\t}\n\n\tisBottomAngle(): boolean\n\t{\n\t\treturn this.angle !== null && this.angle.position === 'bottom';\n\t}\n\n\tisTopOrBottomAngle(): boolean\n\t{\n\t\treturn this.angle !== null && (this.angle.position === 'top' || this.angle.position === 'bottom');\n\t}\n\n\t/**\n\t * @private\n\t */\n\tgetAngleHeight(): number\n\t{\n\t\treturn (this.isTopOrBottomAngle() ? Popup.getOption('angleTopOffset') : 0);\n\t}\n\n\tsetOffset(params: { offsetTop: number, offsetLeft: number }): void\n\t{\n\t\tif (!Type.isPlainObject(params))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (Type.isNumber(params.offsetLeft))\n\t\t{\n\t\t\tthis.offsetLeft = params.offsetLeft + Popup.getOption('offsetLeft');\n\t\t}\n\n\t\tif (Type.isNumber(params.offsetTop))\n\t\t{\n\t\t\tthis.offsetTop = params.offsetTop + Popup.getOption('offsetTop');\n\t\t}\n\t}\n\n\tsetTitleBar(params: string | { content: string }): void\n\t{\n\t\tif (!this.titleBar)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (typeof (params) === 'object' && Type.isDomNode(params.content))\n\t\t{\n\t\t\tthis.titleBar.innerHTML = '';\n\t\t\tthis.titleBar.appendChild(params.content);\n\t\t}\n\t\telse if (typeof (params) === 'string')\n\t\t{\n\t\t\tthis.titleBar.innerHTML = '';\n\t\t\tthis.titleBar.appendChild(\n\t\t\t\tDom.create('span', {\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tclassName: 'popup-window-titlebar-text'\n\t\t\t\t\t},\n\t\t\t\t\ttext: params\n\t\t\t\t})\n\t\t\t);\n\t\t}\n\n\t\tif (this.params.draggable)\n\t\t{\n\t\t\tthis.titleBar.style.cursor = 'move';\n\t\t\tEvent.bind(this.titleBar, 'mousedown', this.onTitleMouseDown);\n\t\t}\n\t}\n\n\tsetClosingByEsc(enable: boolean): void\n\t{\n\t\tenable = Type.isBoolean(enable) ? enable : true;\n\t\tif (enable)\n\t\t{\n\t\t\tthis.closeByEsc = true;\n\t\t\tthis.bindClosingByEsc();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.closeByEsc = false;\n\t\t\tthis.unbindClosingByEsc();\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t */\n\tbindClosingByEsc(): void\n\t{\n\t\tif (this.closeByEsc && !this.isCloseByEscBinded)\n\t\t{\n\t\t\tEvent.bind(document, 'keyup', this.handleDocumentKeyUp);\n\t\t\tthis.isCloseByEscBinded = true;\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t */\n\tunbindClosingByEsc(): void\n\t{\n\t\tif (this.isCloseByEscBinded)\n\t\t{\n\t\t\tEvent.unbind(document, 'keyup', this.handleDocumentKeyUp);\n\t\t\tthis.isCloseByEscBinded = false;\n\t\t}\n\t}\n\n\tsetAutoHide(enable: boolean): void\n\t{\n\t\tenable = Type.isBoolean(enable) ? enable : true;\n\t\tif (enable)\n\t\t{\n\t\t\tthis.autoHide = true;\n\t\t\tthis.bindAutoHide();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.autoHide = false;\n\t\t\tthis.unbindAutoHide();\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t */\n\tbindAutoHide(): void\n\t{\n\t\tif (this.autoHide && !this.isAutoHideBinded && this.isShown())\n\t\t{\n\t\t\tthis.isAutoHideBinded = true;\n\n\t\t\tif (this.isCompatibleMode())\n\t\t\t{\n\t\t\t\tEvent.bind(this.getPopupContainer(), 'click', this.handleContainerClick);\n\t\t\t}\n\n\t\t\tif (this.overlay && this.overlay.element)\n\t\t\t{\n\t\t\t\tEvent.bind(this.overlay.element, 'click', this.handleOverlayClick);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (this.isCompatibleMode())\n\t\t\t\t{\n\t\t\t\t\tEvent.bind(document, 'click', this.handleAutoHide);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tdocument.addEventListener('click', this.handleAutoHide, true);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t */\n\tunbindAutoHide(): void\n\t{\n\t\tif (this.isAutoHideBinded)\n\t\t{\n\t\t\tthis.isAutoHideBinded = false;\n\n\t\t\tif (this.isCompatibleMode())\n\t\t\t{\n\t\t\t\tEvent.unbind(this.getPopupContainer(), 'click', this.handleContainerClick);\n\t\t\t}\n\n\t\t\tif (this.overlay && this.overlay.element)\n\t\t\t{\n\t\t\t\tEvent.unbind(this.overlay.element, 'click', this.handleOverlayClick);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (this.isCompatibleMode())\n\t\t\t\t{\n\t\t\t\t\tEvent.unbind(document, 'click', this.handleAutoHide);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tdocument.removeEventListener('click', this.handleAutoHide, true);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t */\n\thandleAutoHide(event): void\n\t{\n\t\tif (this.isDestroyed())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.autoHideHandler !== null)\n\t\t{\n\t\t\tif (this.autoHideHandler(event))\n\t\t\t{\n\t\t\t\tthis._tryCloseByEvent(event);\n\t\t\t}\n\t\t}\n\t\telse if (event.target !== this.getPopupContainer() && !this.getPopupContainer().contains(event.target))\n\t\t{\n\t\t\tthis._tryCloseByEvent(event);\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t */\n\t_tryCloseByEvent(event): void\n\t{\n\t\tif (this.isCompatibleMode())\n\t\t{\n\t\t\tthis.tryCloseByEvent(event);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.tryCloseByEvent(event);\n\t\t\t}, 0);\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t */\n\ttryCloseByEvent(event): void\n\t{\n\t\tif (event.button === 0)\n\t\t{\n\t\t\tthis.close();\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t */\n\thandleOverlayClick(event): void\n\t{\n\t\tthis.tryCloseByEvent(event);\n\t\tevent.stopPropagation();\n\t}\n\n\tsetOverlay(params: { backgroundColor?: string, opacity?: number }): void\n\t{\n\t\tif (this.overlay === null)\n\t\t{\n\t\t\tthis.overlay = {\n\t\t\t\telement: Tag.render`\n\t\t\t\t\t<div class=\"popup-window-overlay\" id=\"popup-window-overlay-${this.getId()}\"></div>\n\t\t\t\t`\n\t\t\t};\n\n\t\t\tthis.resizeOverlay();\n\n\t\t\tthis.targetContainer.appendChild(this.overlay.element);\n\t\t\tthis.getZIndexComponent().setOverlay(this.overlay.element);\n\t\t}\n\n\t\tif (params && Type.isNumber(params.opacity) && params.opacity >= 0 && params.opacity <= 100)\n\t\t{\n\t\t\tthis.overlay.element.style.opacity = parseFloat(params.opacity / 100).toPrecision(3);\n\t\t}\n\n\t\tif (params && params.backgroundColor)\n\t\t{\n\t\t\tthis.overlay.element.style.backgroundColor = params.backgroundColor;\n\t\t}\n\t}\n\n\tremoveOverlay(): void\n\t{\n\t\tif (this.overlay !== null && this.overlay.element !== null)\n\t\t{\n\t\t\tDom.remove(this.overlay.element);\n\t\t\tthis.getZIndexComponent().setOverlay(null);\n\t\t}\n\n\t\tif (this.overlayTimeout)\n\t\t{\n\t\t\tclearInterval(this.overlayTimeout);\n\t\t\tthis.overlayTimeout = null;\n\t\t}\n\n\t\tthis.overlay = null;\n\t}\n\n\thideOverlay(): void\n\t{\n\t\tif (this.overlay !== null && this.overlay.element !== null)\n\t\t{\n\t\t\tif (this.overlayTimeout)\n\t\t\t{\n\t\t\t\tclearInterval(this.overlayTimeout);\n\t\t\t\tthis.overlayTimeout = null;\n\t\t\t}\n\n\t\t\tthis.overlay.element.style.display = 'none';\n\t\t}\n\t}\n\n\tshowOverlay(): void\n\t{\n\t\tif (this.overlay !== null && this.overlay.element !== null)\n\t\t{\n\t\t\tthis.overlay.element.style.display = 'block';\n\n\t\t\tlet popupHeight = this.getPopupContainer().offsetHeight;\n\t\t\tthis.overlayTimeout = setInterval(() => {\n\t\t\t\tif (popupHeight !== this.getPopupContainer().offsetHeight)\n\t\t\t\t{\n\t\t\t\t\tthis.resizeOverlay();\n\t\t\t\t\tpopupHeight = this.getPopupContainer().offsetHeight;\n\t\t\t\t}\n\t\t\t}, 1000);\n\t\t}\n\t}\n\n\tresizeOverlay(): void\n\t{\n\t\tif (this.overlay !== null && this.overlay.element !== null)\n\t\t{\n\t\t\tlet scrollWidth;\n\t\t\tlet scrollHeight;\n\t\t\tif (this.isTargetDocumentBody())\n\t\t\t{\n\t\t\t\tscrollWidth = document.documentElement.scrollWidth;\n\t\t\t\tscrollHeight = Math.max(\n\t\t\t\t\tdocument.body.scrollHeight, document.documentElement.scrollHeight,\n\t\t\t\t\tdocument.body.offsetHeight, document.documentElement.offsetHeight,\n\t\t\t\t\tdocument.body.clientHeight, document.documentElement.clientHeight\n\t\t\t\t);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tscrollWidth = this.getTargetContainer().scrollWidth;\n\t\t\t\tscrollHeight = this.getTargetContainer().scrollHeight;\n\t\t\t}\n\n\t\t\tthis.overlay.element.style.width = scrollWidth + 'px';\n\t\t\tthis.overlay.element.style.height = scrollHeight + 'px';\n\t\t}\n\t}\n\n\tgetZindex(): number\n\t{\n\t\treturn this.getZIndexComponent().getZIndex();\n\t}\n\n\tgetZIndexComponent(): ZIndexComponent\n\t{\n\t\treturn this.zIndexComponent;\n\t}\n\n\t#disableScroll()\n\t{\n\t\tDom.addClass(document.body, 'popup-no-scroll');\n\t}\n\n\t#enableScroll()\n\t{\n\t\tDom.removeClass(document.body, 'popup-no-scroll')\n\t}\n\n\tshow(): void\n\t{\n\t\tif (this.isShown() || this.isDestroyed())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.emit('onBeforeShow');\n\n\t\tthis.showOverlay();\n\t\tthis.getPopupContainer().style.display = 'block';\n\n\t\tif (this.shouldFrontOnShow())\n\t\t{\n\t\t\tthis.bringToFront();\n\t\t}\n\n\t\tif (!this.firstShow)\n\t\t{\n\t\t\tthis.emit('onFirstShow', new BaseEvent({ compatData: [this] }));\n\t\t\tthis.firstShow = true;\n\t\t}\n\n\t\tthis.emit('onShow', new BaseEvent({ compatData: [this] }));\n\n\t\tthis.adjustPosition();\n\n\t\tthis.animateOpening(() => {\n\n\t\t\tif (this.isDestroyed())\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tDom.removeClass(this.getPopupContainer(), this.animationShowClassName);\n\t\t\tthis.emit('onAfterShow', new BaseEvent({ compatData: [this] }));\n\t\t});\n\n\t\tthis.bindClosingByEsc();\n\n\t\tif (this.isCompatibleMode())\n\t\t{\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.bindAutoHide();\n\t\t\t}, 100);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.bindAutoHide();\n\t\t}\n\n\t\tif (this.isScrollBlock)\n\t\t{\n\t\t\tthis.#disableScroll();\n\t\t}\n\t}\n\n\tclose(): void\n\t{\n\t\tif (this.isDestroyed() || !this.isShown())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.emit('onClose', new BaseEvent({ compatData: [this] }));\n\n\t\tif (this.isDestroyed())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.isScrollBlock)\n\t\t{\n\t\t\tthis.#enableScroll();\n\t\t}\n\n\t\tthis.animateClosing(() => {\n\n\t\t\tif (this.isDestroyed())\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.hideOverlay();\n\n\t\t\tthis.getPopupContainer().style.display = 'none';\n\n\t\t\tDom.removeClass(this.getPopupContainer(), this.animationCloseClassName);\n\n\t\t\tthis.unbindClosingByEsc();\n\n\t\t\tif (this.isCompatibleMode())\n\t\t\t{\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tthis.unbindAutoHide();\n\t\t\t\t}, 0);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.unbindAutoHide();\n\t\t\t}\n\n\t\t\tthis.emit('onAfterClose', new BaseEvent({ compatData: [this] }));\n\n\t\t\tif (!this.isCacheable())\n\t\t\t{\n\t\t\t\tthis.destroy();\n\t\t\t}\n\n\t\t});\n\t}\n\n\tbringToFront(): void\n\t{\n\t\tif (this.isShown())\n\t\t{\n\t\t\tZIndexManager.bringToFront(this.getPopupContainer());\n\t\t}\n\t}\n\n\ttoggle(): void\n\t{\n\t\tthis.isShown() ? this.close() : this.show();\n\t}\n\n\t/**\n\t *\n\t * @private\n\t */\n\tanimateOpening(callback: Function): void\n\t{\n\t\tDom.removeClass(this.getPopupContainer(), this.animationCloseClassName);\n\n\t\tif (this.animationShowClassName !== null)\n\t\t{\n\t\t\tDom.addClass(this.getPopupContainer(), this.animationShowClassName);\n\n\t\t\tif (this.animationCloseEventType !== null)\n\t\t\t{\n\t\t\t\tconst eventName = this.animationCloseEventType + 'end';\n\t\t\t\tthis.getPopupContainer().addEventListener(eventName, function handleTransitionEnd() {\n\t\t\t\t\tthis.removeEventListener(eventName, handleTransitionEnd);\n\t\t\t\t\tcallback();\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tcallback();\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tcallback();\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t */\n\tanimateClosing(callback: Function): void\n\t{\n\t\tDom.removeClass(this.getPopupContainer(), this.animationShowClassName);\n\n\t\tif (this.animationCloseClassName !== null)\n\t\t{\n\t\t\tDom.addClass(this.getPopupContainer(), this.animationCloseClassName);\n\n\t\t\tif (this.animationCloseEventType !== null)\n\t\t\t{\n\t\t\t\tconst eventName = this.animationCloseEventType + 'end';\n\t\t\t\tthis.getPopupContainer().addEventListener(eventName, function handleTransitionEnd() {\n\t\t\t\t\tthis.removeEventListener(eventName, handleTransitionEnd);\n\t\t\t\t\tcallback();\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tcallback();\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tcallback();\n\t\t}\n\t}\n\n\tsetAnimation(options: PopupAnimationOptions): void\n\t{\n\t\tif (Type.isPlainObject(options))\n\t\t{\n\t\t\tthis.animationShowClassName = Type.isStringFilled(options.showClassName) ? options.showClassName : null;\n\t\t\tthis.animationCloseClassName = Type.isStringFilled(options.closeClassName) ? options.closeClassName : null;\n\t\t\tthis.animationCloseEventType =\n\t\t\t\toptions.closeAnimationType === 'animation' || options.closeAnimationType === 'transition'\n\t\t\t\t\t? options.closeAnimationType\n\t\t\t\t\t: null\n\t\t\t;\n\t\t}\n\t\telse if (Type.isStringFilled(options))\n\t\t{\n\t\t\tconst animationName = options;\n\t\t\tif (animationName === 'fading')\n\t\t\t{\n\t\t\t\tthis.animationShowClassName = 'popup-window-show-animation-opacity';\n\t\t\t\tthis.animationCloseClassName = 'popup-window-close-animation-opacity';\n\t\t\t\tthis.animationCloseEventType = 'animation';\n\t\t\t}\n\t\t\telse if (animationName === 'fading-slide')\n\t\t\t{\n\t\t\t\tthis.animationShowClassName = 'popup-window-show-animation-opacity-transform';\n\t\t\t\tthis.animationCloseClassName = 'popup-window-close-animation-opacity';\n\t\t\t\tthis.animationCloseEventType = 'animation';\n\t\t\t}\n\t\t\telse if (animationName === 'scale')\n\t\t\t{\n\t\t\t\tthis.animationShowClassName = 'popup-window-show-animation-scale';\n\t\t\t\tthis.animationCloseClassName = 'popup-window-close-animation-opacity';\n\t\t\t\tthis.animationCloseEventType = 'animation';\n\t\t\t}\n\t\t}\n\t\telse if (options === false || options === null)\n\t\t{\n\t\t\tthis.animationShowClassName = null;\n\t\t\tthis.animationCloseClassName = null;\n\t\t\tthis.animationCloseEventType = null;\n\t\t}\n\t}\n\n\tisShown(): boolean\n\t{\n\t\treturn !this.isDestroyed() && this.getPopupContainer().style.display === 'block';\n\t}\n\n\tdestroy(): void\n\t{\n\t\tif (this.destroyed)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.isScrollBlock)\n\t\t{\n\t\t\tthis.#enableScroll();\n\t\t}\n\n\t\tthis.destroyed = true;\n\n\t\tthis.emit('onDestroy', new BaseEvent({ compatData: [this] }));\n\n\t\tthis.unbindClosingByEsc();\n\n\t\tif (this.isCompatibleMode())\n\t\t{\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.unbindAutoHide();\n\t\t\t}, 0);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.unbindAutoHide();\n\t\t}\n\n\t\tEvent.unbindAll(this);\n\t\tEvent.unbind(document, 'mousemove', this.handleDocumentMouseMove);\n\t\tEvent.unbind(document, 'mouseup', this.handleDocumentMouseUp);\n\t\tEvent.unbind(window, 'resize', this.handleResizeWindow);\n\n\t\tthis.removeOverlay();\n\n\t\tZIndexManager.unregister(this.popupContainer);\n\t\tthis.zIndexComponent = null;\n\n\t\tDom.remove(this.popupContainer);\n\n\t\tthis.popupContainer = null;\n\t\tthis.contentContainer = null;\n\t\tthis.closeIcon = null;\n\t\tthis.titleBar = null;\n\t\tthis.buttonsContainer = null;\n\t\tthis.angle = null;\n\t\tthis.angleArrowElement = null;\n\t\tthis.resizeIcon = null;\n\t}\n\n\tadjustPosition(bindOptions: {\n\t\tforceBindPosition?: boolean,\n\t\tforceLeft?: boolean,\n\t\tforceTop?: boolean,\n\t\tposition?: 'top' | 'bootom'\n\t}): void\n\t{\n\t\tif (bindOptions && typeof (bindOptions) === 'object')\n\t\t{\n\t\t\tthis.bindOptions = bindOptions;\n\t\t}\n\n\t\tconst bindElementPos = this.getBindElementPos(this.bindElement);\n\n\t\tif (\n\t\t\t!this.bindOptions.forceBindPosition &&\n\t\t\tthis.bindElementPos !== null &&\n\t\t\tbindElementPos.top === this.bindElementPos.top &&\n\t\t\tbindElementPos.left === this.bindElementPos.left\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.bindElementPos = bindElementPos;\n\n\t\tconst windowSize = bindElementPos.windowSize ? bindElementPos.windowSize : this.getWindowSize();\n\t\tconst windowScroll = bindElementPos.windowScroll ? bindElementPos.windowScroll : this.getWindowScroll();\n\n\t\tconst popupWidth = bindElementPos.popupWidth ? bindElementPos.popupWidth : this.popupContainer.offsetWidth;\n\t\tconst popupHeight = bindElementPos.popupHeight ? bindElementPos.popupHeight : this.popupContainer.offsetHeight;\n\n\t\tconst angleTopOffset = Popup.getOption('angleTopOffset');\n\n\t\tlet left =\n\t\t\tthis.bindElementPos.left + this.offsetLeft -\n\t\t\t(this.isTopOrBottomAngle() ? Popup.getOption('angleLeftOffset') : 0)\n\t\t;\n\n\t\tif (\n\t\t\t!this.bindOptions.forceLeft &&\n\t\t\t(left + popupWidth + this.bordersWidth) >= (windowSize.innerWidth + windowScroll.scrollLeft) &&\n\t\t\t(windowSize.innerWidth + windowScroll.scrollLeft - popupWidth - this.bordersWidth) > 0)\n\t\t{\n\t\t\tconst bindLeft = left;\n\t\t\tleft = windowSize.innerWidth + windowScroll.scrollLeft - popupWidth - this.bordersWidth;\n\t\t\tif (this.isTopOrBottomAngle())\n\t\t\t{\n\t\t\t\tthis.setAngle({ offset: bindLeft - left + this.angle.defaultOffset });\n\t\t\t}\n\t\t}\n\t\telse if (this.isTopOrBottomAngle())\n\t\t{\n\t\t\tthis.setAngle({ offset: this.angle.defaultOffset + (left < 0 ? left : 0) });\n\t\t}\n\n\t\tif (left < 0)\n\t\t{\n\t\t\tleft = 0;\n\t\t}\n\n\t\tlet top = 0;\n\n\t\tif (this.bindOptions.position && this.bindOptions.position === 'top')\n\t\t{\n\n\t\t\ttop = this.bindElementPos.top - popupHeight - this.offsetTop - (this.isBottomAngle() ? angleTopOffset : 0);\n\t\t\tif (top < 0 || (!this.bindOptions.forceTop && top < windowScroll.scrollTop))\n\t\t\t{\n\t\t\t\ttop = this.bindElementPos.bottom + this.offsetTop;\n\t\t\t\tif (this.angle !== null)\n\t\t\t\t{\n\t\t\t\t\ttop += angleTopOffset;\n\t\t\t\t\tthis.setAngle({ position: 'top' });\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (this.isTopAngle())\n\t\t\t{\n\t\t\t\ttop = top - angleTopOffset + Popup.getOption('positionTopXOffset');\n\t\t\t\tthis.setAngle({ position: 'bottom' });\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\ttop += Popup.getOption('positionTopXOffset');\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\ttop = this.bindElementPos.bottom + this.offsetTop + this.getAngleHeight();\n\n\t\t\tif (\n\t\t\t\t!this.bindOptions.forceTop &&\n\t\t\t\t(top + popupHeight) > (windowSize.innerHeight + windowScroll.scrollTop) &&\n\t\t\t\t(this.bindElementPos.top - popupHeight - this.getAngleHeight()) >= 0) //Can we place the PopupWindow above the bindElement?\n\t\t\t{\n\t\t\t\t//The PopupWindow doesn't place below the bindElement. We should place it above.\n\t\t\t\ttop = this.bindElementPos.top - popupHeight;\n\n\t\t\t\tif (this.isTopOrBottomAngle())\n\t\t\t\t{\n\t\t\t\t\ttop -= angleTopOffset;\n\t\t\t\t\tthis.setAngle({ position: 'bottom' });\n\t\t\t\t}\n\n\t\t\t\ttop += Popup.getOption('positionTopXOffset');\n\n\t\t\t}\n\t\t\telse if (this.isBottomAngle())\n\t\t\t{\n\t\t\t\ttop += angleTopOffset;\n\t\t\t\tthis.setAngle({ position: 'top' });\n\t\t\t}\n\t\t}\n\n\t\tif (top < 0)\n\t\t{\n\t\t\ttop = 0;\n\t\t}\n\n\t\tconst event = new PositionEvent();\n\t\tevent.left = left;\n\t\tevent.top = top;\n\n\t\tthis.emit('onBeforeAdjustPosition', event);\n\n\t\tDom.adjust(this.popupContainer, {\n\t\t\tstyle: {\n\t\t\t\ttop: event.top + 'px',\n\t\t\t\tleft: event.left + 'px'\n\t\t\t}\n\t\t});\n\t}\n\n\tenterFullScreen(): void\n\t{\n\t\tif (Popup.fullscreenStatus)\n\t\t{\n\t\t\tif (document.cancelFullScreen)\n\t\t\t{\n\t\t\t\tdocument.cancelFullScreen();\n\t\t\t}\n\t\t\telse if (document.mozCancelFullScreen)\n\t\t\t{\n\t\t\t\tdocument.mozCancelFullScreen();\n\t\t\t}\n\t\t\telse if (document.webkitCancelFullScreen)\n\t\t\t{\n\t\t\t\tdocument.webkitCancelFullScreen();\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (this.contentContainer.requestFullScreen)\n\t\t\t{\n\t\t\t\tthis.contentContainer.requestFullScreen();\n\t\t\t\tEvent.bind(window, 'fullscreenchange', this.handleFullScreen);\n\t\t\t}\n\t\t\telse if (this.contentContainer.mozRequestFullScreen)\n\t\t\t{\n\t\t\t\tthis.contentContainer.mozRequestFullScreen();\n\t\t\t\tEvent.bind(window, 'mozfullscreenchange', this.handleFullScreen);\n\t\t\t}\n\t\t\telse if (this.contentContainer.webkitRequestFullScreen)\n\t\t\t{\n\t\t\t\tthis.contentContainer.webkitRequestFullScreen();\n\t\t\t\tEvent.bind(window, 'webkitfullscreenchange', this.handleFullScreen);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconsole.log('fullscreen mode is not supported');\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t */\n\thandleFullScreen(event): void\n\t{\n\t\tif (Popup.fullscreenStatus)\n\t\t{\n\t\t\tEvent.unbind(window, 'fullscreenchange', this.handleFullScreen);\n\t\t\tEvent.unbind(window, 'webkitfullscreenchange', this.handleFullScreen);\n\t\t\tEvent.unbind(window, 'mozfullscreenchange', this.handleFullScreen);\n\n\t\t\tPopup.fullscreenStatus = false;\n\n\t\t\tif (!this.isDestroyed())\n\t\t\t{\n\t\t\t\tDom.removeClass(this.contentContainer, 'popup-window-fullscreen');\n\t\t\t\tthis.emit('onFullscreenLeave');\n\t\t\t\tthis.adjustPosition();\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tPopup.fullscreenStatus = true;\n\n\t\t\tif (!this.isDestroyed())\n\t\t\t{\n\t\t\t\tDom.addClass(this.contentContainer, 'popup-window-fullscreen');\n\t\t\t\tthis.emit('onFullscreenEnter');\n\t\t\t\tthis.adjustPosition();\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t */\n\thandleCloseIconClick(event): void\n\t{\n\t\tthis.tryCloseByEvent(event);\n\t\tevent.stopPropagation();\n\t}\n\n\t/**\n\t * @private\n\t */\n\thandleContainerClick(event): void\n\t{\n\t\tevent.stopPropagation();\n\t}\n\n\t/**\n\t * @private\n\t */\n\thandleDocumentKeyUp(event): void\n\t{\n\t\tif (event.keyCode === 27)\n\t\t{\n\t\t\tcheckEscPressed(this.getZindex(), () => {\n\t\t\t\tthis.close();\n\t\t\t});\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t */\n\thandleResizeWindow(): void\n\t{\n\t\tif (this.isShown())\n\t\t{\n\t\t\tthis.adjustPosition();\n\t\t\tif (this.overlay !== null)\n\t\t\t{\n\t\t\t\tthis.resizeOverlay();\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t */\n\thandleMove(offsetX: number, offsetY: number, pageX: number, pageY: number): void\n\t{\n\t\tlet left = parseInt(this.popupContainer.style.left) + offsetX;\n\t\tlet top = parseInt(this.popupContainer.style.top) + offsetY;\n\n\t\tif (typeof (this.params.draggable) === 'object' && this.params.draggable.restrict)\n\t\t{\n\t\t\t//Left side\n\t\t\tif (left < 0)\n\t\t\t{\n\t\t\t\tleft = 0;\n\t\t\t}\n\n\t\t\tlet scrollWidth;\n\t\t\tlet scrollHeight;\n\t\t\tif (this.isTargetDocumentBody())\n\t\t\t{\n\t\t\t\tscrollWidth = document.documentElement.scrollWidth;\n\t\t\t\tscrollHeight = document.documentElement.scrollHeight;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tscrollWidth = this.getTargetContainer().scrollWidth;\n\t\t\t\tscrollHeight = this.getTargetContainer().scrollHeight;\n\t\t\t}\n\n\t\t\t//Right side\n\t\t\tconst floatWidth = this.popupContainer.offsetWidth;\n\t\t\tconst floatHeight = this.popupContainer.offsetHeight;\n\n\t\t\tif (left > (scrollWidth - floatWidth))\n\t\t\t{\n\t\t\t\tleft = scrollWidth - floatWidth;\n\t\t\t}\n\n\t\t\tif (top > (scrollHeight - floatHeight))\n\t\t\t{\n\t\t\t\ttop = scrollHeight - floatHeight;\n\t\t\t}\n\n\t\t\t//Top side\n\t\t\tif (top < 0)\n\t\t\t{\n\t\t\t\ttop = 0;\n\t\t\t}\n\t\t}\n\n\t\tthis.popupContainer.style.left = left + 'px';\n\t\tthis.popupContainer.style.top = top + 'px';\n\t}\n\n\t/**\n\t * @private\n\t */\n\t_startDrag(event: MouseEvent, options): void\n\t{\n\t\toptions = options || {};\n\t\tif (Type.isStringFilled(options.cursor))\n\t\t{\n\t\t\tthis.dragOptions.cursor = options.cursor;\n\t\t}\n\n\t\tif (Type.isStringFilled(options.eventName))\n\t\t{\n\t\t\tthis.dragOptions.eventName = options.eventName;\n\t\t}\n\n\t\tif (Type.isFunction(options.callback))\n\t\t{\n\t\t\tthis.dragOptions.callback = options.callback;\n\t\t}\n\n\t\tthis.dragPageX = event.pageX;\n\t\tthis.dragPageY = event.pageY;\n\t\tthis.dragged = false;\n\n\t\tEvent.bind(document, 'mousemove', this.handleDocumentMouseMove);\n\t\tEvent.bind(document, 'mouseup', this.handleDocumentMouseUp);\n\n\t\tif (document.body.setCapture)\n\t\t{\n\t\t\tdocument.body.setCapture();\n\t\t}\n\n\t\tdocument.body.ondrag = () => false;\n\t\tdocument.body.onselectstart = () => false;\n\t\tdocument.body.style.cursor = this.dragOptions.cursor;\n\t\tdocument.body.style.MozUserSelect = 'none';\n\t\tthis.popupContainer.style.MozUserSelect = 'none';\n\n\t\tif (this.shouldFrontOnShow())\n\t\t{\n\t\t\tthis.bringToFront();\n\t\t}\n\n\t\tevent.preventDefault();\n\t}\n\n\t/**\n\t * @private\n\t */\n\thandleDocumentMouseMove(event): void\n\t{\n\t\tif (this.dragPageX === event.pageX && this.dragPageY === event.pageY)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.dragOptions.callback(\n\t\t\tevent.pageX - this.dragPageX,\n\t\t\tevent.pageY - this.dragPageY,\n\t\t\tevent.pageX,\n\t\t\tevent.pageY\n\t\t);\n\n\t\tthis.dragPageX = event.pageX;\n\t\tthis.dragPageY = event.pageY;\n\n\t\tif (!this.dragged)\n\t\t{\n\t\t\tthis.emit(`on${this.dragOptions.eventName}Start`, new BaseEvent({ compatData: [this] }));\n\t\t\tthis.dragged = true;\n\t\t}\n\n\t\tthis.emit(`on${this.dragOptions.eventName}`, new BaseEvent({ compatData: [this] }));\n\t}\n\n\t/**\n\t * @private\n\t */\n\thandleDocumentMouseUp(event: MouseEvent): void\n\t{\n\t\tif (document.body.releaseCapture)\n\t\t{\n\t\t\tdocument.body.releaseCapture();\n\t\t}\n\n\t\tEvent.unbind(document, 'mousemove', this.handleDocumentMouseMove);\n\t\tEvent.unbind(document, 'mouseup', this.handleDocumentMouseUp);\n\n\t\tdocument.body.ondrag = null;\n\t\tdocument.body.onselectstart = null;\n\t\tdocument.body.style.cursor = '';\n\t\tdocument.body.style.MozUserSelect = '';\n\t\tthis.popupContainer.style.MozUserSelect = '';\n\n\t\tthis.emit(`on${this.dragOptions.eventName}End`, new BaseEvent({ compatData: [this] }));\n\t\tthis.dragged = false;\n\n\t\tevent.preventDefault();\n\t}\n}\n\nlet escCallbackIndex = -1;\nlet escCallback = null;\n\nfunction checkEscPressed(zIndex, callback)\n{\n\tif (zIndex === false)\n\t{\n\t\tif (escCallback && escCallback.length > 0)\n\t\t{\n\t\t\tfor (let i = 0; i < escCallback.length; i++)\n\t\t\t{\n\t\t\t\tescCallback[i]();\n\t\t\t}\n\n\t\t\tescCallback = null;\n\t\t\tescCallbackIndex = -1;\n\t\t}\n\t}\n\telse\n\t{\n\t\tif (escCallback === null)\n\t\t{\n\t\t\tescCallback = [];\n\t\t\tescCallbackIndex = -1;\n\t\t\tsetTimeout(() => {\n\t\t\t\tcheckEscPressed(false);\n\t\t\t}, 10);\n\t\t}\n\n\t\tif (zIndex > escCallbackIndex)\n\t\t{\n\t\t\tescCallbackIndex = zIndex;\n\t\t\tescCallback = [callback];\n\t\t}\n\t\telse if (zIndex === escCallbackIndex)\n\t\t{\n\t\t\tescCallback.push(callback);\n\t\t}\n\t}\n}\n","import Popup from './popup';\nimport { type PopupOptions } from './popup-types';\nimport { Type } from 'main.core';\nimport { EventEmitter, type BaseEvent } from 'main.core.events';\n\nexport default class PopupManager\n{\n\tstatic _popups: Popup[] = [];\n\tstatic _currentPopup: Popup = null;\n\n\tconstructor()\n\t{\n\t\tthrow new Error('You cannot make an instance of PopupManager.');\n\t}\n\n\tstatic create(options: PopupOptions): Popup\n\t{\n\t\tlet [popupId, bindElement, params] = arguments; //compatible arguments\n\n\t\tlet id = popupId;\n\t\tlet compatMode = true;\n\t\tif (Type.isPlainObject(popupId) && !bindElement && !params)\n\t\t{\n\t\t\tcompatMode = false;\n\t\t\tid = popupId.id;\n\t\t\tif (!Type.isStringFilled(id))\n\t\t\t{\n\t\t\t\tthrow new Error('BX.Main.Popup.Manager: \"id\" parameter is required.');\n\t\t\t}\n\t\t}\n\n\t\tlet popupWindow = this.getPopupById(id);\n\t\tif (popupWindow === null)\n\t\t{\n\t\t\tpopupWindow = compatMode ? new Popup(popupId, bindElement, params) : new Popup(options);\n\t\t\tpopupWindow.subscribe('onShow', this.handlePopupShow);\n\t\t\tpopupWindow.subscribe('onClose', this.handlePopupClose);\n\t\t}\n\n\t\treturn popupWindow;\n\t}\n\n\t/**\n\t * @private\n\t */\n\tstatic handleOnAfterInit(event: BaseEvent)\n\t{\n\t\tevent.getTarget().subscribeOnce('onDestroy', this.handlePopupDestroy);\n\n\t\tthis._popups.forEach(popup => {\n\t\t\tif (popup.getId() === event.getTarget().getId())\n\t\t\t{\n\t\t\t\tconsole.error(`Duplicate id (${popup.getId()}) for the BX.Main.Popup instance.`);\n\t\t\t}\n\t\t});\n\n\t\tthis._popups.push(event.getTarget());\n\t}\n\n\t/**\n\t * @private\n\t */\n\tstatic handlePopupDestroy(event: BaseEvent)\n\t{\n\t\tthis._popups = this._popups.filter(popup => {\n\t\t\treturn popup !== event.getTarget();\n\t\t});\n\t}\n\n\t/**\n\t * @private\n\t */\n\tstatic handlePopupShow(event: BaseEvent)\n\t{\n\t\tif (this._currentPopup !== null)\n\t\t{\n\t\t\tthis._currentPopup.close();\n\t\t}\n\n\t\tthis._currentPopup = event.getTarget();\n\t}\n\n\t/**\n\t * @private\n\t */\n\tstatic handlePopupClose()\n\t{\n\t\tthis._currentPopup = null;\n\t}\n\n\tstatic getCurrentPopup(): Popup | null\n\t{\n\t\treturn this._currentPopup;\n\t}\n\n\tstatic isPopupExists(id): boolean\n\t{\n\t\treturn this.getPopupById(id) !== null;\n\t}\n\n\tstatic isAnyPopupShown(): boolean\n\t{\n\t\tfor (let i = 0, length = this._popups.length; i < length; i++)\n\t\t{\n\t\t\tif (this._popups[i].isShown())\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tstatic getPopupById(id): Popup | null\n\t{\n\t\tfor (let i = 0; i < this._popups.length; i++)\n\t\t{\n\t\t\tif (this._popups[i].getId() === id)\n\t\t\t{\n\t\t\t\treturn this._popups[i];\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tstatic getMaxZIndex(): number\n\t{\n\t\tlet zIndex = 0;\n\n\t\tthis.getPopups().forEach((popup: Popup) => {\n\t\t\tzIndex = Math.max(zIndex, popup.getZindex());\n\t\t});\n\n\t\treturn zIndex;\n\t}\n\n\tstatic getPopups(): Popup[]\n\t{\n\t\treturn this._popups;\n\t}\n}\n\nPopupManager.handlePopupDestroy = PopupManager.handlePopupDestroy.bind(PopupManager);\nPopupManager.handlePopupShow = PopupManager.handlePopupShow.bind(PopupManager);\nPopupManager.handlePopupClose = PopupManager.handlePopupClose.bind(PopupManager);\nPopupManager.handleOnAfterInit = PopupManager.handleOnAfterInit.bind(PopupManager);\n\nEventEmitter.subscribe('BX.Main.Popup:onAfterInit', PopupManager.handleOnAfterInit);","import Menu from './menu';\nimport { Type, Text, Dom, Event, Tag } from 'main.core';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\nimport { MenuItemOptions } from './menu-types';\n\nconst aliases = {\n\tonSubMenuShow: { namespace: 'BX.Main.Menu.Item', eventName: 'SubMenu:onShow' },\n\tonSubMenuClose: { namespace: 'BX.Main.Menu.Item', eventName: 'SubMenu:onClose' }\n};\n\nconst reEscape = /[<>'\"]/g;\nconst escapeEntities = {\n\t'<': '&lt;',\n\t'>': '&gt;',\n\t\"'\": '&#39;',\n\t'\"': '&quot;',\n};\n\nfunction encodeSafe(value: string): string\n{\n\tif (Type.isString(value))\n\t{\n\t\treturn value.replace(reEscape, item => escapeEntities[item]);\n\t}\n\n\treturn value;\n}\n\nEventEmitter.registerAliases(aliases);\n\nexport default class MenuItem extends EventEmitter\n{\n\tconstructor(options: MenuItemOptions)\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Main.Menu.Item');\n\n\t\toptions = options || {};\n\t\tthis.options = options;\n\n\t\tthis.id = options.id || Text.getRandom();\n\n\t\tthis.text = '';\n\t\tthis.allowHtml = false;\n\t\tif (Type.isStringFilled(options.html) || Type.isElementNode(options.html))\n\t\t{\n\t\t\tthis.text = options.html;\n\t\t\tthis.allowHtml = true;\n\t\t}\n\t\telse if (Type.isStringFilled(options.text))\n\t\t{\n\t\t\tthis.text = options.text;\n\t\t\tif (this.text.match(/<[^>]+>/))\n\t\t\t{\n\t\t\t\tconsole.warn('BX.Main.MenuItem: use \"html\" option for the html item content.', this.getText());\n\t\t\t}\n\t\t}\n\n\t\tthis.title = Type.isStringFilled(options.title) ? options.title : '';\n\t\tthis.delimiter = options.delimiter === true;\n\t\tthis.href = Type.isStringFilled(options.href) ? options.href : null;\n\t\tthis.target = Type.isStringFilled(options.target) ? options.target : null;\n\t\tthis.dataset = Type.isPlainObject(options.dataset) ? options.dataset : null;\n\t\tthis.className = Type.isStringFilled(options.className) ? options.className : null;\n\t\tthis.menuShowDelay = Type.isNumber(options.menuShowDelay) ? options.menuShowDelay : 300;\n\t\tthis.subMenuOffsetX = Type.isNumber(options.subMenuOffsetX) ? options.subMenuOffsetX : 4;\n\t\tthis._items = Type.isArray(options.items) ? options.items : [];\n\t\tthis.disabled = options.disabled === true;\n\t\tthis.cacheable = options.cacheable === true;\n\n\t\t/**\n\t\t *\n\t\t * @type {function|string}\n\t\t */\n\t\tthis.onclick =\n\t\t\tType.isStringFilled(options.onclick) || Type.isFunction(options.onclick)\n\t\t\t\t? options.onclick\n\t\t\t\t: null\n\t\t;\n\n\t\tthis.subscribeFromOptions(options.events, aliases);\n\n\t\t/**\n\t\t *\n\t\t * @type {Menu}\n\t\t */\n\t\tthis.menuWindow = null;\n\n\t\t/**\n\t\t *\n\t\t * @type {Menu}\n\t\t */\n\t\tthis.subMenuWindow = null;\n\n\t\t/**\n\t\t *\n\t\t * @type {{item: HTMLElement, text: HTMLElement}}\n\t\t */\n\t\tthis.layout = {\n\t\t\titem: null,\n\t\t\ttext: null\n\t\t};\n\n\t\tthis.getLayout(); //compatibility\n\n\t\t//compatibility\n\t\t//now use this.options\n\t\tthis.events = {};\n\t\tthis.items = [];\n\t\tfor (let property in options)\n\t\t{\n\t\t\tif (options.hasOwnProperty(property) && typeof (this[property]) === 'undefined')\n\t\t\t{\n\t\t\t\tthis[property] = options[property];\n\t\t\t}\n\t\t}\n\t}\n\n\tgetLayout(): Element\n\t{\n\t\tif (this.layout.item)\n\t\t{\n\t\t\treturn this.layout;\n\t\t}\n\n\t\tif (this.delimiter)\n\t\t{\n\t\t\tif (Type.isStringFilled(this.getText()))\n\t\t\t{\n\t\t\t\tthis.layout.item = Dom.create('span', {\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tclassName: [\n\t\t\t\t\t\t\t'popup-window-delimiter-section',\n\t\t\t\t\t\t\tthis.className ? this.className : '',\n\t\t\t\t\t\t].join(' ')\n\t\t\t\t\t},\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\t(this.layout.text = Tag.render`\n\t\t\t\t\t\t\t<span class=\"popup-window-delimiter-text\">${\n\t\t\t\t\t\t\t\tthis.allowHtml ? this.getText() : encodeSafe(this.getText())\n\t\t\t\t\t\t\t}</span>\n\t\t\t\t\t\t`)\n\t\t\t\t\t]\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.layout.item = Tag.render`<span class=\"popup-window-delimiter\">`;\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.layout.item = Dom.create(this.href ? 'a' : 'span', {\n\t\t\t\tprops: {\n\t\t\t\t\tclassName: [\n\t\t\t\t\t\t'menu-popup-item',\n\t\t\t\t\t\t(this.className ? this.className : 'menu-popup-no-icon'),\n\t\t\t\t\t\t(this.hasSubMenu() ? 'menu-popup-item-submenu' : '')\n\t\t\t\t\t].join(' ')\n\t\t\t\t},\n\n\t\t\t\tattrs: {\n\t\t\t\t\ttitle: this.title,\n\t\t\t\t\tonclick: Type.isString(this.onclick) ? this.onclick : '', // compatibility\n\t\t\t\t\ttarget: this.target ? this.target : ''\n\t\t\t\t},\n\n\t\t\t\tdataset: this.dataset,\n\n\t\t\t\tevents:\n\t\t\t\t\tType.isFunction(this.onclick)\n\t\t\t\t\t\t? { click: this.onItemClick.bind(this) }\n\t\t\t\t\t\t: null\n\t\t\t\t,\n\n\t\t\t\tchildren: [\n\t\t\t\t\tDom.create('span', { props: { className: 'menu-popup-item-icon' } }),\n\t\t\t\t\t(this.layout.text = Tag.render`\n\t\t\t\t\t\t<span class=\"menu-popup-item-text\">${\n\t\t\t\t\t\t\tthis.allowHtml ? this.getText() : encodeSafe(this.getText())\n\t\t\t\t\t\t}</span>\n\t\t\t\t\t`)\n\t\t\t\t]\n\t\t\t});\n\n\t\t\tif (this.href)\n\t\t\t{\n\t\t\t\tthis.layout.item.href = this.href;\n\t\t\t}\n\n\t\t\tif (this.isDisabled())\n\t\t\t{\n\t\t\t\tthis.disable();\n\t\t\t}\n\n\t\t\tEvent.bind(this.layout.item, 'mouseenter', this.onItemMouseEnter.bind(this));\n\t\t\tEvent.bind(this.layout.item, 'mouseleave', this.onItemMouseLeave.bind(this));\n\t\t}\n\n\t\treturn this.layout;\n\t}\n\n\tgetContainer(): Element\n\t{\n\t\treturn this.getLayout().item;\n\t}\n\n\tgetTextContainer(): Element\n\t{\n\t\treturn this.getLayout().text;\n\t}\n\n\tgetText(): string | HTMLElement\n\t{\n\t\treturn this.text;\n\t}\n\n\tsetText(text: string | HTMLElement, allowHtml = false)\n\t{\n\t\tif (Type.isString(text) || Type.isElementNode(text))\n\t\t{\n\t\t\tthis.allowHtml = allowHtml;\n\t\t\tthis.text = text;\n\n\t\t\tif (Type.isElementNode(text))\n\t\t\t{\n\t\t\t\tDom.clean(this.getTextContainer());\n\t\t\t\tif (this.allowHtml)\n\t\t\t\t{\n\t\t\t\t\tDom.append(text, this.getTextContainer());\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.getTextContainer().innerHTML = encodeSafe(text.outerHTML);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.getTextContainer().innerHTML = this.allowHtml ? text : encodeSafe(text);\n\t\t\t}\n\t\t}\n\t}\n\n\thasSubMenu(): boolean\n\t{\n\t\treturn this.subMenuWindow !== null || this._items.length;\n\t}\n\n\tshowSubMenu(): void\n\t{\n\t\tif (!this.getMenuWindow().getPopupWindow().isShown())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.addSubMenu(this._items);\n\n\t\tif (this.subMenuWindow)\n\t\t{\n\t\t\tDom.addClass(this.layout.item, 'menu-popup-item-open');\n\n\t\t\tthis.closeSiblings();\n\t\t\tthis.closeChildren();\n\n\t\t\tconst popupWindow = this.subMenuWindow.getPopupWindow();\n\t\t\tif (!popupWindow.isShown())\n\t\t\t{\n\t\t\t\tthis.emit('SubMenu:onShow');\n\t\t\t\tpopupWindow.show();\n\t\t\t}\n\n\t\t\tthis.adjustSubMenu();\n\t\t}\n\t}\n\n\taddSubMenu(items: []): Menu\n\t{\n\t\tif (this.subMenuWindow !== null || !Type.isArray(items) || !items.length)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst rootMenuWindow = this.getMenuWindow().getRootMenuWindow() || this.getMenuWindow();\n\t\tconst rootOptions = Object.assign({}, rootMenuWindow.params);\n\t\tdelete rootOptions.events;\n\n\t\tconst subMenuOptions =\n\t\t\tType.isPlainObject(rootMenuWindow.params.subMenuOptions) ? rootMenuWindow.params.subMenuOptions : {}\n\t\t;\n\n\t\tconst options = Object.assign({}, rootOptions, subMenuOptions);\n\n\t\t//Override root menu options\n\t\toptions.autoHide = false;\n\t\toptions.menuShowDelay = this.menuShowDelay;\n\t\toptions.cacheable = this.isCacheable();\n\t\toptions.targetContainer = this.getMenuWindow().getPopupWindow().getTargetContainer();\n\t\toptions.bindOptions = {\n\t\t\tforceTop: true,\n\t\t\tforceLeft: true,\n\t\t\tforceBindPosition: true\n\t\t};\n\n\t\tdelete options.angle;\n\t\tdelete options.overlay;\n\n\t\tthis.subMenuWindow = new Menu('popup-submenu-' + this.id, this.layout.item, items, options);\n\t\tthis.subMenuWindow.setParentMenuWindow(this.getMenuWindow());\n\t\tthis.subMenuWindow.setParentMenuItem(this);\n\n\t\tthis.subMenuWindow.getPopupWindow().subscribe('onDestroy', this.handleSubMenuDestroy.bind(this));\n\t\tDom.addClass(this.layout.item, 'menu-popup-item-submenu');\n\n\t\treturn this.subMenuWindow;\n\t}\n\n\tcloseSubMenu(): void\n\t{\n\t\tthis.clearSubMenuTimeout();\n\n\t\tif (this.subMenuWindow)\n\t\t{\n\t\t\tDom.removeClass(this.layout.item, 'menu-popup-item-open');\n\n\t\t\tthis.closeChildren();\n\n\t\t\tconst popup = this.subMenuWindow.getPopupWindow();\n\t\t\tif (popup.isShown())\n\t\t\t{\n\t\t\t\tthis.emit('SubMenu:onClose');\n\t\t\t}\n\n\t\t\tthis.subMenuWindow.close();\n\t\t}\n\t}\n\n\tcloseSiblings(): void\n\t{\n\t\tconst siblings = this.menuWindow.getMenuItems();\n\t\tfor (let i = 0; i < siblings.length; i++)\n\t\t{\n\t\t\tif (siblings[i] !== this)\n\t\t\t{\n\t\t\t\tsiblings[i].closeSubMenu();\n\t\t\t}\n\t\t}\n\t}\n\n\tcloseChildren(): void\n\t{\n\t\tif (this.subMenuWindow)\n\t\t{\n\t\t\tconst children = this.subMenuWindow.getMenuItems();\n\t\t\tfor (let i = 0; i < children.length; i++)\n\t\t\t{\n\t\t\t\tchildren[i].closeSubMenu();\n\t\t\t}\n\t\t}\n\t}\n\n\tdestroySubMenu(): void\n\t{\n\t\tif (this.subMenuWindow)\n\t\t{\n\t\t\tDom.removeClass(this.layout.item, 'menu-popup-item-open menu-popup-item-submenu');\n\t\t\tthis.destroyChildren();\n\t\t\tthis.subMenuWindow.destroy();\n\n\t\t\tthis.subMenuWindow = null;\n\t\t\tthis._items = [];\n\t\t}\n\t}\n\n\tdestroyChildren(): void\n\t{\n\t\tif (this.subMenuWindow)\n\t\t{\n\t\t\tconst children = this.subMenuWindow.getMenuItems();\n\t\t\tfor (let i = 0; i < children.length; i++)\n\t\t\t{\n\t\t\t\tchildren[i].destroySubMenu();\n\t\t\t}\n\t\t}\n\t}\n\n\tadjustSubMenu(): void\n\t{\n\t\tif (!this.subMenuWindow || !this.layout.item)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst popupWindow = this.subMenuWindow.getPopupWindow();\n\t\tconst itemRect = this.getBoundingClientRect();\n\n\t\tlet offsetLeft = itemRect.width + this.subMenuOffsetX;\n\t\tlet offsetTop = itemRect.height + this.getPopupPadding();\n\t\tlet angleOffset = itemRect.height / 2 - this.getPopupPadding();\n\t\tlet anglePosition = 'left';\n\n\t\tconst popupWidth = popupWindow.getPopupContainer().offsetWidth;\n\t\tconst popupHeight = popupWindow.getPopupContainer().offsetHeight;\n\t\tconst popupBottom = itemRect.top + popupHeight;\n\n\t\tconst targetContainer = this.getMenuWindow().getPopupWindow().getTargetContainer();\n\t\tconst isGlobalContext = this.getMenuWindow().getPopupWindow().isTargetDocumentBody();\n\t\tconst clientWidth = isGlobalContext ? document.documentElement.clientWidth : targetContainer.offsetWidth;\n\t\tconst clientHeight = isGlobalContext ? document.documentElement.clientHeight : targetContainer.offsetHeight;\n\n\t\t// let's try to fit a submenu to the browser viewport\n\t\tconst exceeded = popupBottom - clientHeight;\n\t\tif (exceeded > 0)\n\t\t{\n\t\t\tlet roundOffset = Math.ceil(exceeded / itemRect.height) * itemRect.height;\n\t\t\tif (roundOffset > itemRect.top)\n\t\t\t{\n\t\t\t\t// it cannot be higher than the browser viewport.\n\t\t\t\troundOffset -= Math.ceil((roundOffset - itemRect.top) / itemRect.height) * itemRect.height;\n\t\t\t}\n\n\t\t\tif (itemRect.bottom > (popupBottom - roundOffset))\n\t\t\t{\n\t\t\t\t// let's sync bottom boundaries.\n\t\t\t\troundOffset -= itemRect.bottom - (popupBottom - roundOffset) + this.getPopupPadding();\n\t\t\t}\n\n\t\t\toffsetTop += roundOffset;\n\t\t\tangleOffset += roundOffset;\n\t\t}\n\n\t\tif ((itemRect.left + offsetLeft + popupWidth) > clientWidth)\n\t\t{\n\t\t\tconst left = itemRect.left - popupWidth - this.subMenuOffsetX;\n\t\t\tif (left > 0)\n\t\t\t{\n\t\t\t\toffsetLeft = -popupWidth - this.subMenuOffsetX;\n\t\t\t\tanglePosition = 'right';\n\t\t\t}\n\t\t}\n\n\t\tpopupWindow.setBindElement(this.layout.item);\n\t\tpopupWindow.setOffset({ offsetLeft: offsetLeft, offsetTop: -offsetTop });\n\t\tpopupWindow.setAngle({ position: anglePosition, offset: angleOffset });\n\t\tpopupWindow.adjustPosition();\n\t}\n\n\tgetBoundingClientRect(): DOMRect\n\t{\n\t\tconst popup = this.getMenuWindow().getPopupWindow();\n\t\tif (popup.isTargetDocumentBody())\n\t\t{\n\t\t\treturn this.layout.item.getBoundingClientRect();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst rect = popup.getPositionRelativeToTarget(this.layout.item);\n\t\t\tconst targetContainer = this.getMenuWindow().getPopupWindow().getTargetContainer();\n\n\t\t\treturn new DOMRect(\n\t\t\t\trect.left - targetContainer.scrollLeft,\n\t\t\t\trect.top - targetContainer.scrollTop,\n\t\t\t\trect.width,\n\t\t\t\trect.height\n\t\t\t);\n\t\t}\n\t}\n\n\tgetPopupPadding(): number\n\t{\n\t\tif (!Type.isNumber(this.popupPadding))\n\t\t{\n\t\t\tif (this.subMenuWindow)\n\t\t\t{\n\t\t\t\tconst menuContainer = this.subMenuWindow.layout.menuContainer;\n\t\t\t\tthis.popupPadding = parseInt(Dom.style(menuContainer, 'paddingTop'), 10);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.popupPadding = 0;\n\t\t\t}\n\t\t}\n\n\t\treturn this.popupPadding;\n\t}\n\n\tgetSubMenu(): Menu | null\n\t{\n\t\treturn this.subMenuWindow;\n\t}\n\n\tgetId(): string\n\t{\n\t\treturn this.id;\n\t}\n\n\tsetMenuWindow(menu: Menu): string\n\t{\n\t\tthis.menuWindow = menu;\n\t}\n\n\tgetMenuWindow(): Menu | null\n\t{\n\t\treturn this.menuWindow;\n\t}\n\n\tgetMenuShowDelay(): number\n\t{\n\t\treturn this.menuShowDelay;\n\t}\n\n\tenable(): void\n\t{\n\t\tthis.disabled = false;\n\t\tthis.getContainer().classList.remove('menu-popup-item-disabled');\n\t}\n\n\tdisable(): void\n\t{\n\t\tthis.disabled = true;\n\t\tthis.closeSubMenu();\n\t\tthis.getContainer().classList.add('menu-popup-item-disabled');\n\t}\n\n\tisDisabled(): boolean\n\t{\n\t\treturn this.disabled;\n\t}\n\n\tsetCacheable(cacheable): void\n\t{\n\t\tthis.cacheable = cacheable !== false;\n\t}\n\n\tisCacheable(): boolean\n\t{\n\t\treturn this.cacheable;\n\t}\n\n\t/**\n\t * @private\n\t */\n\tonItemClick(event): void\n\t{\n\t\tthis.onclick.call(this.menuWindow, event, this); //compatibility\n\t}\n\n\t/**\n\t * @private\n\t */\n\tonItemMouseEnter(mouseEvent: MouseEvent): void\n\t{\n\t\tif (this.isDisabled())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst event = new BaseEvent({ data: { mouseEvent } });\n\t\tEventEmitter.emit(this, 'onMouseEnter', event, { thisArg: this });\n\t\tif (event.isDefaultPrevented())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.clearSubMenuTimeout();\n\n\t\tif (this.hasSubMenu())\n\t\t{\n\t\t\tthis.subMenuTimeout = setTimeout(function() {\n\t\t\t\tthis.showSubMenu();\n\t\t\t}.bind(this), this.menuShowDelay);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.subMenuTimeout = setTimeout(function() {\n\t\t\t\tthis.closeSiblings();\n\t\t\t}.bind(this), this.menuShowDelay);\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t */\n\tonItemMouseLeave(mouseEvent: MouseEvent): void\n\t{\n\t\tif (this.isDisabled())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst event = new BaseEvent({ data: { mouseEvent } });\n\t\tEventEmitter.emit(this, 'onMouseLeave', event, { thisArg: this });\n\t\tif (event.isDefaultPrevented())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.clearSubMenuTimeout();\n\t}\n\n\t/**\n\t * @private\n\t */\n\tclearSubMenuTimeout(): void\n\t{\n\t\tif (this.subMenuTimeout)\n\t\t{\n\t\t\tclearTimeout(this.subMenuTimeout);\n\t\t}\n\n\t\tthis.subMenuTimeout = null;\n\t}\n\n\t/**\n\t * @private\n\t */\n\thandleSubMenuDestroy(): void\n\t{\n\t\tthis.subMenuWindow = null;\n\t}\n}","import MenuItem from './menu-item';\nimport Popup from '../popup/popup';\nimport { Type, Text, Tag } from 'main.core';\nimport { type MenuOptions, type MenuItemOptions } from './menu-types';\nimport { type PopupTargetOptions } from '../popup/popup-types';\n\n/**\n * @memberof BX.Main\n */\nexport default class Menu\n{\n\tconstructor(options: MenuOptions)\n\t{\n\t\tlet [\n\t\t\tid: string,\n\t\t\tbindElement: PopupTargetOptions,\n\t\t\tmenuItems: MenuItemOptions[],\n\t\t\tparams: MenuOptions\n\t\t] = arguments;\n\n\t\tif (Type.isPlainObject(options) && !bindElement && !menuItems && !params)\n\t\t{\n\t\t\tparams = options;\n\t\t\tparams.compatibleMode = false;\n\n\t\t\tid = options.id;\n\t\t\tbindElement = options.bindElement;\n\t\t\tmenuItems = options.items;\n\n\t\t\tif (!Type.isStringFilled(id))\n\t\t\t{\n\t\t\t\tid = 'menu-popup-' + Text.getRandom();\n\t\t\t}\n\t\t}\n\n\t\tthis.id = id;\n\t\tthis.bindElement = bindElement;\n\n\t\t/**\n\t\t *\n\t\t * @type {MenuItem[]}\n\t\t */\n\t\tthis.menuItems = [];\n\t\tthis.itemsContainer = null;\n\t\tthis.params = params && typeof (params) === 'object' ? params : {};\n\t\tthis.parentMenuWindow = null;\n\t\tthis.parentMenuItem = null;\n\n\t\tif (menuItems && Type.isArray(menuItems))\n\t\t{\n\t\t\tfor (let i = 0; i < menuItems.length; i++)\n\t\t\t{\n\t\t\t\tthis.addMenuItemInternal(menuItems[i], null);\n\t\t\t}\n\t\t}\n\n\t\tthis.layout = {\n\t\t\tmenuContainer: null,\n\t\t\titemsContainer: null\n\t\t};\n\n\t\tthis.popupWindow = this.__createPopup();\n\t}\n\n\t/**\n\t * @private\n\t */\n\t__createPopup(): Popup\n\t{\n\t\tconst domItems = [];\n\t\tfor (let i = 0; i < this.menuItems.length; i++)\n\t\t{\n\t\t\tconst item = this.menuItems[i];\n\t\t\tconst itemLayout = item.getLayout();\n\t\t\tdomItems.push(itemLayout.item);\n\t\t}\n\n\t\tconst defaults = {\n\t\t\tcloseByEsc: false,\n\t\t\tangle: false,\n\t\t\tautoHide: true,\n\t\t\toffsetTop: 1,\n\t\t\toffsetLeft: 0,\n\t\t\tanimation: 'fading'\n\t\t};\n\n\t\tconst options = Object.assign(defaults, this.params);\n\n\t\t//Override user params\n\t\toptions.noAllPaddings = true;\n\t\toptions.darkMode = false;\n\t\toptions.autoHideHandler = this.handleAutoHide.bind(this);\n\n\t\tthis.layout.itemsContainer = Tag.render`\n\t\t\t<div class=\"menu-popup-items\">${domItems}</div>\n\t\t`;\n\n\t\tthis.layout.menuContainer = Tag.render`\n\t\t\t<div class=\"menu-popup\">${this.layout.itemsContainer}</div>\n\t\t`;\n\n\t\tthis.itemsContainer = this.layout.itemsContainer;\n\t\toptions.content = this.layout.menuContainer;\n\n\t\t//Make internal event handlers first in the queue.\n\t\toptions.events = {\n\t\t\tonClose: this.handlePopupClose.bind(this),\n\t\t\tonDestroy: this.handlePopupDestroy.bind(this)\n\t\t};\n\n\t\tconst id = options.compatibleMode === false ? this.getId() : 'menu-popup-' + this.getId();\n\t\tconst popup = new Popup(id, this.bindElement, options);\n\t\tif (this.params && this.params.events)\n\t\t{\n\t\t\tpopup.subscribeFromOptions(this.params.events);\n\t\t}\n\n\t\treturn popup;\n\t}\n\n\tgetPopupWindow(): Popup\n\t{\n\t\treturn this.popupWindow;\n\t}\n\n\tshow(): void\n\t{\n\t\tthis.getPopupWindow().show();\n\t}\n\n\tclose(): void\n\t{\n\t\tthis.getPopupWindow().close();\n\t}\n\n\tdestroy(): void\n\t{\n\t\tthis.getPopupWindow().destroy();\n\t}\n\n\ttoggle(): void\n\t{\n\t\tif (this.getPopupWindow().isShown())\n\t\t{\n\t\t\tthis.close();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.show();\n\t\t}\n\t}\n\n\tgetId(): string\n\t{\n\t\treturn this.id;\n\t}\n\n\t/**\n\t * @private\n\t */\n\thandlePopupClose(): void\n\t{\n\t\tfor (let i = 0; i < this.menuItems.length; i++)\n\t\t{\n\t\t\tconst item = this.menuItems[i];\n\t\t\titem.closeSubMenu();\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t */\n\thandlePopupDestroy(): void\n\t{\n\t\tfor (let i = 0; i < this.menuItems.length; i++)\n\t\t{\n\t\t\tconst item = this.menuItems[i];\n\t\t\titem.destroySubMenu();\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t */\n\thandleAutoHide(event): boolean\n\t{\n\t\treturn !this.containsTarget(event.target);\n\t}\n\n\t/**\n\t * @private\n\t */\n\tcontainsTarget(target: Element): boolean\n\t{\n\t\tconst el = this.getPopupWindow().getPopupContainer();\n\t\tif (this.getPopupWindow().isShown() && (target === el || el.contains(target)))\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\treturn this.getMenuItems().some(function(item: MenuItem) {\n\n\t\t\treturn item.getSubMenu() && item.getSubMenu().containsTarget(target);\n\n\t\t});\n\t}\n\n\tsetParentMenuWindow(parentMenu: Menu): void\n\t{\n\t\tif (parentMenu instanceof Menu)\n\t\t{\n\t\t\tthis.parentMenuWindow = parentMenu;\n\t\t}\n\t}\n\n\tgetParentMenuWindow(): Menu | null\n\t{\n\t\treturn this.parentMenuWindow;\n\t}\n\n\tgetRootMenuWindow(): Menu | null\n\t{\n\t\tlet root = null;\n\t\tlet parent = this.getParentMenuWindow();\n\t\twhile (parent !== null)\n\t\t{\n\t\t\troot = parent;\n\t\t\tparent = parent.getParentMenuWindow();\n\t\t}\n\n\t\treturn root;\n\t}\n\n\tsetParentMenuItem(parentItem: MenuItem): void\n\t{\n\t\tif (parentItem instanceof MenuItem)\n\t\t{\n\t\t\tthis.parentMenuItem = parentItem;\n\t\t}\n\t}\n\n\tgetParentMenuItem(): MenuItem | null\n\t{\n\t\treturn this.parentMenuItem;\n\t}\n\n\taddMenuItem(menuItemJson: any, targetItemId: string): MenuItem\n\t{\n\t\tconst menuItem = this.addMenuItemInternal(menuItemJson, targetItemId);\n\t\tif (!menuItem)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst itemLayout = menuItem.getLayout();\n\t\tconst targetItem = this.getMenuItem(targetItemId);\n\t\tif (targetItem !== null)\n\t\t{\n\t\t\tconst targetLayout = targetItem.getLayout();\n\t\t\tthis.itemsContainer.insertBefore(itemLayout.item, targetLayout.item);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.itemsContainer.appendChild(itemLayout.item);\n\t\t}\n\n\t\treturn menuItem;\n\t}\n\n\t/**\n\t * @private\n\t */\n\taddMenuItemInternal(menuItemJson: any, targetItemId: string): MenuItem\n\t{\n\t\tif (\n\t\t\t!menuItemJson ||\n\t\t\t(\n\t\t\t\t!menuItemJson.delimiter &&\n\t\t\t\t!Type.isStringFilled(menuItemJson.text) &&\n\t\t\t\t!Type.isStringFilled(menuItemJson.html) &&\n\t\t\t\t!Type.isElementNode(menuItemJson.html)\n\t\t\t) ||\n\t\t\t(menuItemJson.id && this.getMenuItem(menuItemJson.id) !== null)\n\t\t)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tif (Type.isNumber(this.params.menuShowDelay))\n\t\t{\n\t\t\tmenuItemJson.menuShowDelay = this.params.menuShowDelay;\n\t\t}\n\n\t\tconst menuItem = new MenuItem(menuItemJson);\n\t\tmenuItem.setMenuWindow(this);\n\n\t\tconst position = this.getMenuItemPosition(targetItemId);\n\t\tif (position >= 0)\n\t\t{\n\t\t\tthis.menuItems.splice(position, 0, menuItem);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.menuItems.push(menuItem);\n\t\t}\n\n\t\treturn menuItem;\n\t}\n\n\tremoveMenuItem(itemId: string): void\n\t{\n\t\tconst item = this.getMenuItem(itemId);\n\t\tif (!item)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tfor (let position = 0; position < this.menuItems.length; position++)\n\t\t{\n\t\t\tif (this.menuItems[position] === item)\n\t\t\t{\n\t\t\t\titem.destroySubMenu();\n\t\t\t\tthis.menuItems.splice(position, 1);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif (!this.menuItems.length)\n\t\t{\n\t\t\tconst menuWindow = item.getMenuWindow();\n\t\t\tif (menuWindow)\n\t\t\t{\n\t\t\t\tconst parentMenuItem = menuWindow.getParentMenuItem();\n\t\t\t\tif (parentMenuItem)\n\t\t\t\t{\n\t\t\t\t\tparentMenuItem.destroySubMenu();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tmenuWindow.destroy();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\titem.layout.item.parentNode.removeChild(item.layout.item);\n\t\titem.layout = {\n\t\t\titem: null,\n\t\t\ttext: null\n\t\t};\n\t}\n\n\tgetMenuItem(itemId: string): MenuItem | null\n\t{\n\t\tfor (let i = 0; i < this.menuItems.length; i++)\n\t\t{\n\t\t\tif (this.menuItems[i].id && this.menuItems[i].id === itemId)\n\t\t\t{\n\t\t\t\treturn this.menuItems[i];\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tgetMenuItems(): MenuItem[]\n\t{\n\t\treturn this.menuItems;\n\t}\n\n\tgetMenuItemPosition(itemId: string): number\n\t{\n\t\tif (itemId)\n\t\t{\n\t\t\tfor (let i = 0; i < this.menuItems.length; i++)\n\t\t\t{\n\t\t\t\tif (this.menuItems[i].id && this.menuItems[i].id === itemId)\n\t\t\t\t{\n\t\t\t\t\treturn i;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn -1;\n\t}\n\n\tgetMenuContainer()\n\t{\n\t\treturn this.getPopupWindow().getPopupContainer();\n\t}\n}","import Menu from './menu';\nimport { Type } from 'main.core';\nimport { MenuOptions } from './menu-types';\n\nexport default class MenuManager\n{\n\t/**\n\t * @private\n\t */\n\tstatic Data: { [id: string]: Menu } = {};\n\n\t/**\n\t * @private\n\t */\n\tstatic currentItem: ? Menu = null;\n\n\tconstructor()\n\t{\n\t\tthrow new Error('You cannot make an instance of MenuManager.');\n\t}\n\n\tstatic show(...args)\n\t{\n\t\tif (this.currentItem !== null)\n\t\t{\n\t\t\tthis.currentItem.popupWindow.close();\n\t\t}\n\n\t\tthis.currentItem = this.create.apply(this, args);\n\t\tthis.currentItem.popupWindow.show();\n\t}\n\n\tstatic create(options: MenuOptions)\n\t{\n\t\tlet menuId = null;\n\n\t\t//Compatibility\n\t\tconst bindElement = arguments[1];\n\t\tconst menuItems = arguments[2];\n\t\tconst params = arguments[3];\n\n\t\tif (Type.isPlainObject(options) && !bindElement && !menuItems && !params)\n\t\t{\n\t\t\tmenuId = options.id;\n\t\t\tif (!Type.isStringFilled(menuId))\n\t\t\t{\n\t\t\t\tthrow new Error('BX.Main.Menu.create: \"id\" parameter is required.');\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tmenuId = options;\n\t\t}\n\n\t\tif (!this.Data[menuId])\n\t\t{\n\t\t\tconst menu = new Menu(options, bindElement, menuItems, params);\n\t\t\tmenu.getPopupWindow().subscribe('onDestroy', () => {\n\t\t\t\tMenuManager.destroy(menuId);\n\t\t\t});\n\n\t\t\tthis.Data[menuId] = menu;\n\t\t}\n\n\t\treturn this.Data[menuId];\n\t}\n\n\tstatic getCurrentMenu(): Menu | null\n\t{\n\t\treturn this.currentItem;\n\t}\n\n\tstatic getMenuById(id): Menu | null\n\t{\n\t\treturn this.Data[id] ? this.Data[id] : null;\n\t}\n\n\t/**\n\t * compatibility\n\t * @private\n\t */\n\tstatic onPopupDestroy(popupMenuWindow: Menu)\n\t{\n\t\tthis.destroy(popupMenuWindow.id);\n\t}\n\n\tstatic destroy(id)\n\t{\n\t\tconst menu = this.getMenuById(id);\n\t\tif (menu)\n\t\t{\n\t\t\tif (this.currentItem === menu)\n\t\t\t{\n\t\t\t\tthis.currentItem = null;\n\t\t\t}\n\n\t\t\tdelete this.Data[id];\n\t\t\tmenu.getPopupWindow().destroy();\n\t\t}\n\t}\n}","import Popup from '../popup/popup';\n\n/**\n * @deprecated use Popup class instead: import { Popup } from 'main.popup'\n */\nexport default class PopupWindow extends Popup\n{\n\n}","import Button from './button';\n\n/**\n * @deprecated use BX.UI.Button\n */\nexport default class PopupWindowButton extends Button\n{\n\n}","import Button from './button';\nimport { Dom } from 'main.core';\n\n/**\n * @deprecated use BX.UI.Button\n */\nexport default class ButtonLink extends Button\n{\n\tconstructor(params)\n\t{\n\t\tsuper(params);\n\n\t\tthis.buttonNode = Dom.create(\n\t\t\t'span',\n\t\t\t{\n\t\t\t\tprops: {\n\t\t\t\t\tclassName:\n\t\t\t\t\t\t'popup-window-button popup-window-button-link' +\n\t\t\t\t\t\t(this.className.length > 0 ? ' ' + this.className : '')\n\t\t\t\t\t,\n\t\t\t\t\tid: this.id\n\t\t\t\t},\n\t\t\t\ttext: this.text,\n\t\t\t\tevents: this.contextEvents\n\t\t\t}\n\t\t);\n\t}\n}","import ButtonLink from './buttonlink';\n\n/**\n * @deprecated use BX.UI.Button\n */\nexport default class PopupWindowButtonLink extends ButtonLink\n{\n\n}","import Button from './button';\nimport { Dom } from 'main.core';\n\n/**\n * @deprecated use BX.UI.Button\n */\nexport default class CustomButton extends Button\n{\n\tconstructor(params)\n\t{\n\t\tsuper(params);\n\n\t\tthis.buttonNode = Dom.create(\n\t\t\t'span',\n\t\t\t{\n\t\t\t\tprops: {\n\t\t\t\t\tclassName: (this.className.length > 0 ? this.className : ''),\n\t\t\t\t\tid: this.id\n\t\t\t\t},\n\t\t\t\tevents: this.contextEvents,\n\t\t\t\ttext: this.text\n\t\t\t}\n\t\t);\n\t}\n}","import CustomButton from './custombutton';\n\n/**\n * @deprecated use BX.UI.Button\n */\nexport default class PopupWindowCustomButton extends CustomButton\n{\n\n}","import Menu from '../menu/menu';\n\n/**\n * @deprecated use Menu class instead: import { Menu } from 'main.popup'\n */\nexport default class PopupMenuWindow extends Menu\n{\n\n}","import MenuItem from '../menu/menu-item';\n\n/**\n * @deprecated use Menu.Item class instead: import { MenuItem } from 'main.popup'\n */\nexport default class PopupMenuItem extends MenuItem\n{\n\n}","import { Dom } from 'main.core';\nimport Popup from '../popup/popup';\nimport { EventEmitter, BaseEvent } from 'main.core.events';\n\n/**\n * @deprecated\n */\nexport default class InputPopup\n{\n\tconstructor(params)\n\t{\n\t\tthis.id = params.id || 'bx-inp-popup-' + Math.round(Math.random() * 1000000);\n\t\tthis.handler = params.handler || false;\n\t\tthis.values = params.values || false;\n\t\tthis.pInput = params.input;\n\t\tthis.bValues = !!this.values;\n\t\tthis.defaultValue = params.defaultValue || '';\n\t\tthis.openTitle = params.openTitle || '';\n\t\tthis.className = params.className || '';\n\t\tthis.noMRclassName = params.noMRclassName || 'ec-no-rm';\n\t\tthis.emptyClassName = params.noMRclassName || 'ec-label';\n\n\t\tconst _this = this;\n\t\tthis.curInd = false;\n\n\t\tif (this.bValues)\n\t\t{\n\t\t\tthis.pInput.onfocus = this.pInput.onclick = function(e) {\n\t\t\t\tif (this.value == _this.defaultValue)\n\t\t\t\t{\n\t\t\t\t\tthis.value = '';\n\t\t\t\t\tthis.className = _this.className;\n\t\t\t\t}\n\t\t\t\t_this.ShowPopup();\n\t\t\t\treturn e.preventDefault();\n\t\t\t};\n\n\t\t\tthis.pInput.onblur = function() {\n\t\t\t\tif (_this.bShowed)\n\t\t\t\t{\n\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t_this.ClosePopup(true);\n\t\t\t\t\t}, 200);\n\t\t\t\t}\n\t\t\t\t_this.OnChange();\n\t\t\t};\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.pInput.className = this.noMRclassName;\n\t\t\tthis.pInput.onblur = this.OnChange.bind(this);\n\t\t}\n\t}\n\n\tShowPopup()\n\t{\n\t\tif (this.bShowed)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst _this = this;\n\t\tif (!this.oPopup)\n\t\t{\n\t\t\tconst pWnd = Dom.create('DIV', { props: { className: 'bxecpl-loc-popup ' + this.className } });\n\n\t\t\tfor (let i = 0, l = this.values.length; i < l; i++)\n\t\t\t{\n\t\t\t\tconst pRow = pWnd.appendChild(Dom.create('DIV', {\n\t\t\t\t\tprops: { id: 'bxecmr_' + i },\n\t\t\t\t\ttext: this.values[i].NAME,\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tmouseover: function() {\n\t\t\t\t\t\t\tDom.addClass(this, 'bxecplloc-over');\n\t\t\t\t\t\t},\n\t\t\t\t\t\tmouseout: function() {\n\t\t\t\t\t\t\tDom.removeClass(this, 'bxecplloc-over');\n\t\t\t\t\t\t},\n\t\t\t\t\t\tclick: function() {\n\t\t\t\t\t\t\tconst ind = this.id.substr('bxecmr_'.length);\n\t\t\t\t\t\t\t_this.pInput.value = _this.values[ind].NAME;\n\t\t\t\t\t\t\t_this.curInd = ind;\n\t\t\t\t\t\t\t_this.OnChange();\n\t\t\t\t\t\t\t_this.ClosePopup(true);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}));\n\n\t\t\t\tif (this.values[i].DESCRIPTION)\n\t\t\t\t{\n\t\t\t\t\tpRow.title = this.values[i].DESCRIPTION;\n\t\t\t\t}\n\t\t\t\tif (this.values[i].CLASS_NAME)\n\t\t\t\t{\n\t\t\t\t\tDom.addClass(pRow, this.values[i].CLASS_NAME);\n\t\t\t\t}\n\n\t\t\t\tif (this.values[i].URL)\n\t\t\t\t{\n\t\t\t\t\tpRow.appendChild(Dom.create('a', {\n\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\thref: this.values[i].URL,\n\t\t\t\t\t\t\tclassName: 'bxecplloc-view',\n\t\t\t\t\t\t\ttarget: '_blank',\n\t\t\t\t\t\t\ttitle: this.openTitle\n\t\t\t\t\t\t}\n\t\t\t\t\t}));\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.oPopup = new Popup(this.id, this.pInput, {\n\t\t\t\tautoHide: true,\n\t\t\t\toffsetTop: 1,\n\t\t\t\toffsetLeft: 0,\n\t\t\t\tlightShadow: true,\n\t\t\t\tcloseByEsc: true,\n\t\t\t\tcontent: pWnd,\n\t\t\t\tevents: {\n\t\t\t\t\tonClose: this.ClosePopup.bind(this)\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tthis.oPopup.show();\n\t\tthis.pInput.select();\n\t\tthis.bShowed = true;\n\n\t\tEventEmitter.emit(this, 'onInputPopupShow', new BaseEvent({ compatData: [this] }));\n\t}\n\n\tClosePopup(bClosePopup)\n\t{\n\t\tthis.bShowed = false;\n\n\t\tif (this.pInput.value === '')\n\t\t{\n\t\t\tthis.OnChange();\n\t\t}\n\n\t\tEventEmitter.emit(this, 'onInputPopupClose', new BaseEvent({ compatData: [this] }));\n\n\t\tif (bClosePopup === true)\n\t\t{\n\t\t\tthis.oPopup.close();\n\t\t}\n\t}\n\n\tOnChange()\n\t{\n\t\tlet val = this.pInput.value;\n\t\tif (this.bValues)\n\t\t{\n\t\t\tif (this.pInput.value == '' || this.pInput.value == this.defaultValue)\n\t\t\t{\n\t\t\t\tthis.pInput.value = this.defaultValue;\n\t\t\t\tthis.pInput.className = this.emptyClassName;\n\t\t\t\tval = '';\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.pInput.className = '';\n\t\t\t}\n\t\t}\n\n\t\tif (isNaN(parseInt(this.curInd)) || this.curInd !== false && val != this.values[this.curInd].NAME)\n\t\t{\n\t\t\tthis.curInd = false;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.curInd = parseInt(this.curInd);\n\t\t}\n\n\t\tEventEmitter.emit(\n\t\t\tthis,\n\t\t\t'onInputPopupChanged',\n\t\t\tnew BaseEvent({ compatData: [this, this.curInd, val] })\n\t\t);\n\n\t\tif (this.handler && typeof this.handler == 'function')\n\t\t{\n\t\t\tthis.handler({ ind: this.curInd, value: val });\n\t\t}\n\t}\n\n\tSet(ind, val, bOnChange)\n\t{\n\t\tthis.curInd = ind;\n\t\tif (this.curInd !== false)\n\t\t{\n\t\t\tthis.pInput.value = this.values[this.curInd].NAME;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.pInput.value = val;\n\t\t}\n\n\t\tif (bOnChange !== false)\n\t\t{\n\t\t\tthis.OnChange();\n\t\t}\n\t}\n\n\tGet(ind)\n\t{\n\t\tlet id = false;\n\t\tif (typeof ind == 'undefined')\n\t\t{\n\t\t\tind = this.curInd;\n\t\t}\n\n\t\tif (ind !== false && this.values[ind])\n\t\t{\n\t\t\tid = this.values[ind].ID;\n\t\t}\n\n\t\treturn id;\n\t}\n\n\tGetIndex(id)\n\t{\n\t\tfor (let i = 0, l = this.values.length; i < l; i++)\n\t\t{\n\t\t\tif (this.values[i].ID == id)\n\t\t\t{\n\t\t\t\treturn i;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tDeactivate(bDeactivate)\n\t{\n\t\tif (this.pInput.value == '' || this.pInput.value == this.defaultValue)\n\t\t{\n\t\t\tif (bDeactivate)\n\t\t\t{\n\t\t\t\tthis.pInput.value = '';\n\t\t\t\tthis.pInput.className = this.noMRclassName;\n\t\t\t}\n\t\t\telse if (this.oEC.bUseMR)\n\t\t\t{\n\t\t\t\tthis.pInput.value = this.defaultValue;\n\t\t\t\tthis.pInput.className = this.emptyClassName;\n\t\t\t}\n\t\t}\n\n\t\tthis.pInput.disabled = bDeactivate;\n\t}\n}","/*\n\n//ES6\nimport { Popup, PopupManager } from 'main.popup';\nconst popup = new Popup();\nPopupManager.create();\n\n//ES5\nvar popup = new BX.Main.Popup();\nBX.Main.PopupManager.create();\n\n//ES6\nimport { Menu, MenuItem, MenuManager } from 'main.popup';\nconst menu = new Menu();\nconst item = new MenuItem();\nMenuManager.create();\n\n//ES5\nvar menu = new BX.Main.Menu();\nvar item = new BX.Main.MenuItem();\nBX.Main.MenuManager.create();\n\n */\n\nimport Popup from './popup/popup';\nimport PopupManager from './popup/popup-manager';\nimport Menu from './menu/menu';\nimport MenuManager from './menu/menu-manager';\nimport MenuItem from './menu/menu-item';\nimport { type PopupOptions } from './popup/popup-types';\nimport { type MenuOptions, type MenuItemOptions } from './menu/menu-types';\nimport type PositionEvent from './popup/position-event';\n\nimport PopupWindow from './compatibility/popup-window';\nimport PopupWindowButton from './compatibility/popup-window-button';\nimport PopupWindowButtonLink from './compatibility/popup-window-button-link';\nimport PopupWindowCustomButton from './compatibility/popup-window-custom-button';\nimport PopupMenuWindow from './compatibility/popup-menu-window';\nimport PopupMenuItem from './compatibility/popup-menu-item';\nimport InputPopup from './compatibility/input-popup';\nimport Button from './compatibility/button';\nimport ButtonLink from './compatibility/buttonlink';\nimport CustomButton from './compatibility/custombutton';\n\nimport { Reflection } from 'main.core';\n\nimport 'ui.design-tokens';\nimport 'ui.fonts.opensans';\nimport './css/popup.css';\n\nexport {\n\tPopup,\n\tMenu,\n\tMenuItem,\n\tPopupManager,\n\tMenuManager\n};\n\nexport type {\n\tPopupOptions,\n\tMenuOptions,\n\tMenuItemOptions,\n\tPositionEvent,\n};\n\n//Compatibility\nexport {\n\tPopupWindow,\n\tPopupMenuWindow,\n\tPopupMenuItem,\n\tPopupManager as PopupWindowManager,\n\tMenuManager as PopupMenu,\n\tPopupWindowButton,\n\tPopupWindowButtonLink,\n\tPopupWindowCustomButton\n};\n\nconst BX = Reflection.namespace('BX');\n\n/** @deprecated use BX.Main.Popup or import { Popup } from 'main.popup' */\nBX.PopupWindow = Popup;\n\n/** @deprecated use BX.Main.PopupManager or import { PopupManager } from 'main.popup' */\nBX.PopupWindowManager = PopupManager;\n\n/** @deprecated use BX.Main.Menu or import { Menu } from 'main.popup' */\nBX.PopupMenuWindow = Menu;\n\n/** @deprecated use BX.Main.MenuManager or import { MenuManager } from 'main.popup' */\nBX.PopupMenu = MenuManager;\n\n/** @deprecated use BX.Main.MenuItem or import { MenuItem } from 'main.popup' */\nBX.PopupMenuItem = MenuItem;\n\n/** @deprecated use BX.UI.Button */\nBX.PopupWindowButton = Button;\n\n/** @deprecated use BX.UI.Button */\nBX.PopupWindowButtonLink = ButtonLink;\n\n/** @deprecated use BX.UI.Button */\nBX.PopupWindowCustomButton = CustomButton;\n\n/** @deprecated use another API */\nwindow.BXInputPopup = InputPopup;"],"names":["Button","params","popupWindow","text","id","className","events","contextEvents","eventName","Type","isFunction","bind","buttonNode","Dom","create","props","length","name","clean","adjust","isString","removeClass","addClass","PositionEvent","value","isNumber","BaseEvent","aliases","onPopupWindowInit","namespace","onPopupWindowIsInitialized","onPopupFirstShow","onPopupShow","onAfterPopupShow","onPopupClose","onPopupAfterClose","onPopupDestroy","onPopupFullscreenLeave","onPopupFullscreenEnter","onPopupDragStart","onPopupDrag","onPopupDragEnd","onPopupResizeStart","onPopupResize","onPopupResizeEnd","EventEmitter","registerAliases","Popup","options","isPlainObject","option","defaultValue","isUndefined","defaultOptions","setEventNamespace","arguments","popupId","bindElement","compatibleMode","isBoolean","isStringFilled","Text","getRandom","toLowerCase","emit","compatData","uniquePopupId","zIndex","parseInt","zIndexAbsolute","buttons","isArray","offsetTop","getOption","offsetLeft","firstShow","bordersWidth","bindElementPos","closeIcon","resizeIcon","angle","angleArrowElement","overlay","titleBar","bindOptions","autoHide","isScrollBlock","autoHideHandler","handleAutoHide","handleOverlayClick","isAutoHideBinded","closeByEsc","isCloseByEscBinded","toFrontOnShow","cacheable","destroyed","width","height","minWidth","minHeight","maxWidth","maxHeight","padding","contentPadding","background","contentBackground","borderRadius","contentBorderRadius","targetContainer","isElementNode","document","body","dragOptions","cursor","callback","dragged","dragPageX","dragPageY","animationShowClassName","animationCloseClassName","animationCloseEventType","handleDocumentMouseMove","handleDocumentMouseUp","handleDocumentKeyUp","handleResizeWindow","handleResize","handleMove","onTitleMouseDown","handleFullScreen","subscribeFromOptions","popupClassName","darkMode","Tag","render","handleCloseIconClick","style","contentContainer","popupContainer","appendChild","zIndexComponent","ZIndexManager","register","zIndexOptions","buttonsContainer","contentColor","setContentColor","setAngle","setOverlay","setOffset","setBindElement","setTitleBar","setContent","content","setButtons","setWidth","setHeight","setMinWidth","setMinHeight","setMaxWidth","setMaxHeight","setResizeMode","resizable","setPadding","setContentPadding","setBorderRadius","setContentBorderRadius","setBackground","setContentBackground","setAnimation","animation","setCacheable","setToFrontOnShow","contentNoPaddings","noAllPaddings","bindOnResize","Event","window","hasParent","isDomNode","parentNode","isCompatibleMode","display","innerHTML","remove","ButtonClass","Reflection","getClass","newButtons","i","button","push","setContext","getId","top","left","clientX","clientY","pageX","pageY","bottom","isTargetDocumentBody","getPosition","getPositionRelativeToTarget","windowSize","getWindowSize","windowScroll","getWindowScroll","popupWidth","getPopupContainer","offsetWidth","popupHeight","offsetHeight","forceTop","innerWidth","scrollLeft","innerHeight","scrollTop","element","offsetElement","offsetParent","getTargetContainer","elementRect","getBoundingClientRect","DOMRect","pageXOffset","pageYOffset","position","angleMinLeft","defaultOffset","offset","angleLeftOffset","Math","max","includes","minOffset","maxOffset","min","marginLeft","removeProperty","setWidthProperty","setHeightProperty","property","indexOf","getResizableContainer","getContentContainer","overflowX","classList","add","getTitleContainer","Browser","isIE11","toKebabCase","hasOtherProps","some","prop","getPropertyValue","overflowY","radius","setProperty","color","backgroundColor","flag","mode","handleResizeMouseDown","event","_startDrag","resizeContentPos","resizeContentOffset","offsetX","offsetY","scrollWidth","documentElement","getMinWidth","getMinHeight","getMaxWidth","getMaxHeight","isTopOrBottomAngle","draggable","enable","bindClosingByEsc","unbindClosingByEsc","unbind","bindAutoHide","unbindAutoHide","isShown","handleContainerClick","addEventListener","removeEventListener","isDestroyed","_tryCloseByEvent","target","contains","tryCloseByEvent","setTimeout","close","stopPropagation","resizeOverlay","getZIndexComponent","opacity","parseFloat","toPrecision","overlayTimeout","clearInterval","setInterval","scrollHeight","clientHeight","getZIndex","showOverlay","shouldFrontOnShow","bringToFront","adjustPosition","animateOpening","animateClosing","hideOverlay","isCacheable","destroy","show","handleTransitionEnd","showClassName","closeClassName","closeAnimationType","animationName","unbindAll","removeOverlay","unregister","getBindElementPos","forceBindPosition","angleTopOffset","forceLeft","bindLeft","isBottomAngle","isTopAngle","getAngleHeight","fullscreenStatus","cancelFullScreen","mozCancelFullScreen","webkitCancelFullScreen","requestFullScreen","mozRequestFullScreen","webkitRequestFullScreen","console","log","keyCode","checkEscPressed","getZindex","restrict","floatWidth","floatHeight","setCapture","ondrag","onselectstart","MozUserSelect","preventDefault","releaseCapture","positionTopXOffset","popupZindex","popupOverlayZindex","angleMaxLeft","angleMinRight","angleMaxRight","angleMinBottom","angleMaxBottom","angleMinTop","angleMaxTop","escCallbackIndex","escCallback","PopupManager","Error","compatMode","getPopupById","subscribe","handlePopupShow","handlePopupClose","getTarget","subscribeOnce","handlePopupDestroy","_popups","forEach","popup","error","filter","_currentPopup","getPopups","handleOnAfterInit","onSubMenuShow","onSubMenuClose","reEscape","escapeEntities","encodeSafe","replace","item","MenuItem","allowHtml","html","match","warn","getText","title","delimiter","href","dataset","menuShowDelay","subMenuOffsetX","_items","items","disabled","onclick","menuWindow","subMenuWindow","layout","getLayout","hasOwnProperty","join","children","hasSubMenu","attrs","click","onItemClick","isDisabled","disable","onItemMouseEnter","onItemMouseLeave","getTextContainer","append","outerHTML","getMenuWindow","getPopupWindow","addSubMenu","closeSiblings","closeChildren","adjustSubMenu","rootMenuWindow","getRootMenuWindow","rootOptions","Object","assign","subMenuOptions","Menu","setParentMenuWindow","setParentMenuItem","handleSubMenuDestroy","clearSubMenuTimeout","siblings","getMenuItems","closeSubMenu","destroyChildren","destroySubMenu","itemRect","getPopupPadding","angleOffset","anglePosition","popupBottom","isGlobalContext","clientWidth","exceeded","roundOffset","ceil","rect","popupPadding","menuContainer","menu","getContainer","call","mouseEvent","data","thisArg","isDefaultPrevented","subMenuTimeout","showSubMenu","clearTimeout","menuItems","itemsContainer","parentMenuWindow","parentMenuItem","addMenuItemInternal","__createPopup","domItems","itemLayout","defaults","onClose","onDestroy","containsTarget","el","getSubMenu","parentMenu","root","parent","getParentMenuWindow","parentItem","menuItemJson","targetItemId","menuItem","targetItem","getMenuItem","targetLayout","insertBefore","setMenuWindow","getMenuItemPosition","splice","itemId","getParentMenuItem","removeChild","MenuManager","currentItem","args","apply","menuId","Data","popupMenuWindow","getMenuById","PopupWindow","PopupWindowButton","ButtonLink","PopupWindowButtonLink","CustomButton","PopupWindowCustomButton","PopupMenuWindow","PopupMenuItem","InputPopup","round","random","handler","values","pInput","input","bValues","openTitle","noMRclassName","emptyClassName","_this","curInd","onfocus","e","ShowPopup","onblur","bShowed","ClosePopup","OnChange","oPopup","pWnd","l","pRow","NAME","mouseover","mouseout","ind","substr","DESCRIPTION","CLASS_NAME","URL","lightShadow","select","bClosePopup","val","isNaN","bOnChange","ID","bDeactivate","oEC","bUseMR","BX","PopupWindowManager","PopupMenu","BXInputPopup"],"mappings":"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"}