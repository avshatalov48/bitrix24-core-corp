(function(){var e=window.BX;e.namespace("BXRL");if(typeof BXRL.render!="undefined"){return}e.namespace("BXRL.render");e.namespace("BXRL.manager");BXRL.render={reactionsList:["like","kiss","laugh","wonder","cry","angry","facepalm"],popupCurrentReaction:false,popupPagesList:[],popupSizeInitialized:false,blockShowPopup:false,blockShowPopupTimeout:false,afterClickBlockShowPopup:false,touchStartPosition:null,touchCurrentPosition:{x:null,y:null},currentReactionNodeHover:null,touchMoveDeltaY:null,touchScrollTop:0,hasMobileTouchMoved:null,mobileOverlay:null,getTopUsersText:function(t){var i=typeof t.you!="undefined"?!!t.you:false;var o=typeof t.top!="undefined"&&e.type.isArray(t.top)?t.top:[];var n=typeof t.more!="undefined"?parseInt(t.more):0;var r="";if(o.length<=0&&!i&&(BXRL.manager.mobile||n<=0)){return r}if(BXRL.manager.mobile){if(i){o.push({ID:parseInt(e.message("USER_ID")),NAME_FORMATTED:e.message("RATING_LIKE_TOP_TEXT3_YOU"),WEIGHT:1})}r=e.message("RATING_LIKE_TOP_TEXT3_"+(o.length>1?"2":"1")).replace("#OVERFLOW_START#",BXRL.manager.mobile?'<span class="feed-post-emoji-text-item-overflow">':"").replace("#OVERFLOW_END#",BXRL.manager.mobile?"</span>":"")}else{r=e.message("RATING_LIKE_TOP_TEXT2_"+(i?"YOU_":"")+o.length+(n>0?"_MORE":"")).replace("#OVERFLOW_START#",BXRL.manager.mobile?'<span class="feed-post-emoji-text-item-overflow">':"").replace("#OVERFLOW_END#",BXRL.manager.mobile?"</span>":"").replace("#MORE_START#",BXRL.manager.mobile?'<span class="feed-post-emoji-text-item-more">':"&nbsp;").replace("#MORE_END#",BXRL.manager.mobile?"</span>":"")}if(BXRL.manager.mobile){o.sort(function(t,i){if(parseFloat(t.ID)===parseInt(e.message("USER_ID"))){return-1}if(parseInt(i.ID)===parseInt(e.message("USER_ID"))){return 1}if(parseFloat(t.WEIGHT)===parseFloat(i.WEIGHT)){return 0}return parseFloat(t.WEIGHT)>parseFloat(i.WEIGHT)?-1:1});var a=o.map(function(e){return e.NAME_FORMATTED});var s="",p="";if(a.length===1){s=a.pop();p=""}else{s=a.slice(0,a.length-1).join(e.message("RATING_LIKE_TOP_TEXT3_USERLIST_SEPARATOR").replace(/#USERNAME#/g,""));p=a[a.length-1]}r=r.replace("#USER_LIST_BEGIN#",s).replace("#USER_LIST_END#",p)}else{for(var l in o){if(!o.hasOwnProperty(l)){continue}r=r.replace("#USER_"+(parseInt(l)+1)+"#",'<span class="feed-post-emoji-text-item">'+o[l].NAME_FORMATTED+"</span>")}r=r.replace("#USERS_MORE#",'<span class="feed-post-emoji-text-item">'+n+"</span>")}return r},getUserReaction:function(t){var i="";var o=e(t.userReactionNode)?e(t.userReactionNode):false;if(o){i=o.getAttribute("data-value")}return i},setReaction:function(t){if(typeof t.rating=="undefined"||!e.type.isNotEmptyString(t.likeId)){return}var i=t.likeId,o=t.rating,n=e.type.isNotEmptyString(t.action)?t.action:"add",r=e.type.isNotEmptyString(t.userReaction)?t.userReaction:e.message("RATING_LIKE_REACTION_DEFAULT"),a=e.type.isNotEmptyString(t.userReactionOld)?t.userReactionOld:e.message("RATING_LIKE_REACTION_DEFAULT"),s=typeof t.totalCount!="undefined"?parseInt(t.totalCount):null,p=typeof t.userId!="undefined"?parseInt(t.userId):parseInt(e.message("USER_ID"));if(!e.util.in_array(n,["add","cancel","change"])){return}if(n=="change"&&r==a){return}var l=e(o.userReactionNode)?e(o.userReactionNode):false;var c=e(o.reactionsNode)?e(o.reactionsNode):false;var d=e(o.topPanel)?e(o.topPanel):false;var u=e(o.topPanelContainer)?e(o.topPanelContainer):false;var f=e(o.topUsersText)?e(o.topUsersText):false;var m=e(o.countText)?e(o.countText):false;var L=e(o.buttonText)?e(o.buttonText):false;if(p==e.message("USER_ID")&&l){l.setAttribute("data-value",e.util.in_array(n,["add","change"])?r:"")}var R=0,v=false,h=false,b=false,y=false;if(s!==null&&d&&f&&c){if(s>0){u.classList.add("feed-post-emoji-top-panel-container-active");if(!d.classList.contains("feed-post-emoji-container-toggle")){d.classList.add("feed-post-emoji-container-toggle");f.classList.add("feed-post-emoji-move-to-right");c.classList.add("feed-post-emoji-icon-box-show")}}else if(s<=0){u.classList.remove("feed-post-emoji-top-panel-container-active");if(d.classList.contains("feed-post-emoji-container-toggle")){d.classList.remove("feed-post-emoji-container-toggle");f.classList.remove("feed-post-emoji-move-to-right");c.classList.remove("feed-post-emoji-icon-box-show")}}}if(s!==null&&m){if(s<=0&&!m.classList.contains("feed-post-emoji-text-counter-invisible")){m.classList.add("feed-post-emoji-text-counter-invisible")}else if(s>0&&m.classList.contains("feed-post-emoji-text-counter-invisible")){m.classList.remove("feed-post-emoji-text-counter-invisible")}}if(c){var B=c.querySelector(".feed-post-emoji-icon-container");v=c.querySelectorAll(".feed-post-emoji-icon-item");h=[];if(B){var X=false,g=false;for(R=0;R<v.length;R++){b=v[R].getAttribute("data-reaction");y=parseInt(v[R].getAttribute("data-value"));if(b==r){X=true;if(n=="cancel"){g=y>0?y-1:0}else if(e.util.in_array(n,["add","change"])){g=y+1}if(g>0){h.push({reaction:b,count:g,animate:false})}}else if(n=="change"&&b==a){g=y>0?y-1:0;if(g>0){h.push({reaction:b,count:g,animate:false})}}else{h.push({reaction:b,count:y,animate:false})}}if(e.util.in_array(n,["add","change"])&&!X){h.push({reaction:r,count:1,animate:true})}e.cleanNode(B);if(d){if(h.length>0){d.classList.add("feed-post-emoji-container-nonempty")}else{d.classList.remove("feed-post-emoji-container-nonempty")}if(BXRL.manager.mobile){var P=e.findParent(d,{className:"post-comment-block"});if(P){if(h.length>0){P.classList.add("comment-block-rating-nonempty")}else{P.classList.remove("comment-block-rating-nonempty")}}}}var I=BXRL.manager.mobile?{}:{click:BXRL.render.resultReactionClick,mouseenter:BXRL.render.resultReactionMouseEnter,mouseleave:BXRL.render.resultReactionMouseLeave};for(R=0;R<h.length;R++){if(R>=1){B.appendChild(e.create("span",{props:{id:"bx-ilike-result-reaction-"+h[R].reaction+"-"+i,className:"feed-post-emoji-icon-item "+(h[R].animate?"feed-post-emoji-icon-animate":"")+" feed-post-emoji-icon-"+h[R].reaction+" feed-post-emoji-icon-item-"+(R+1)},attrs:{"data-reaction":h[R].reaction,"data-value":h[R].count,"data-like-id":i,title:e.message("RATING_LIKE_EMOTION_"+h[R].reaction.toUpperCase()+"_CALC")},events:I}))}else{B.appendChild(e.create("span",{props:{id:"bx-ilike-result-reaction-"+h[R].reaction+"-"+i,className:"feed-post-emoji-icon-item "+(h.length==1&&h[R].animate?"feed-post-emoji-animation-pop":"")+" feed-post-emoji-icon-"+h[R].reaction+" feed-post-emoji-icon-item-"+(R+1)},attrs:{"data-reaction":h[R].reaction,"data-value":h[R].count,"data-like-id":i,title:e.message("RATING_LIKE_EMOTION_"+h[R].reaction.toUpperCase()+"_CALC")},events:I}))}}}}if(p==e.message("USER_ID")&&e(L)){if(e.util.in_array(n,["add","change"])){e(L).innerHTML=e.message("RATING_LIKE_EMOTION_"+r.toUpperCase()+"_CALC");if(BXRL.manager.mobile){L.parentElement.className="bx-ilike-left-wrap bx-you-like-button bx-you-like-button-"+r.toLowerCase()}}else{e(L).innerHTML=e.message("RATING_LIKE_EMOTION_LIKE_CALC");if(BXRL.manager.mobile){L.parentElement.className="bx-ilike-left-wrap"}}}},reactionsPopup:null,reactionsPopupAnimation:null,reactionsPopupAnimation2:null,reactionsPopupLikeId:null,reactionsPopupMouseOutHandler:null,reactionsPopupOpacityState:0,reactionsPopupTouchStartIn:null,reactionsPopupPositionY:null,blockTouchEndByScroll:false,showReactionsPopup:function(t){var i=e(t.bindElement)?e(t.bindElement):false,o=e.type.isNotEmptyString(t.likeId)?t.likeId:false;if(!i||!o){return false}BXRL.render.reactionsPopupLikeId=o;if(BXRL.render.reactionsPopup==null){var n=[];for(var r in BXRL.render.reactionsList){if(!BXRL.render.reactionsList.hasOwnProperty(r)){continue}var a=BXRL.render.reactionsList[r];n.push(e.create("div",{props:{className:"feed-post-emoji-icon-item feed-post-emoji-icon-"+a},attrs:{"data-reaction":a,title:e.message("RATING_LIKE_EMOTION_"+a.toUpperCase()+"_CALC")}}))}BXRL.render.reactionsPopup=e.create("div",{props:{className:"feed-post-emoji-popup-container"+(BXRL.manager.mobile?" feed-post-emoji-popup-container-mobile":"")},children:[e.create("div",{props:{className:"feed-post-emoji-icon-inner"},children:n})]});e.bind(BXRL.render.reactionsPopup,BXRL.manager.mobile?"touchend":"click",function(t){var i=false;if(t.target.classList.contains("feed-post-emoji-icon-item")){i=t.target}else{i=e.findParent(t.target,{className:"feed-post-emoji-icon-item"},BXRL.render.reactionsPopup)}if(i){RatingLike.ClickVote(BXRL.render.reactionsPopupLikeId,i.getAttribute("data-reaction"),true)}t.preventDefault()});e.append(BXRL.render.reactionsPopup,document.body)}else if(BXRL.render.reactionsPopup.classList.contains("feed-post-emoji-popup-invisible")){BXRL.render.reactionsPopup.classList.remove("feed-post-emoji-popup-invisible")}else if(BXRL.manager.mobile&&BXRL.render.reactionsPopup.classList.contains("feed-post-emoji-popup-invisible-final-mobile")){BXRL.render.reactionsPopup.classList.remove("feed-post-emoji-popup-invisible-final-mobile")}else{return}BXRL.render.reactionsPopupMouseOutHandler=e.proxy(function(t){var i=BXRL.render.reactionsPopup.getBoundingClientRect();var o=BXRL.render.reactionsPopup.classList.contains("feed-post-emoji-popup-inverted");if(t.clientX>=i.left&&t.clientX<=i.right&&t.clientY>=i.top-(o?25:0)&&t.clientY<=i.bottom+(o?0:25)){return}BXRL.render.blockReactionsPopup();BXRL.render.hideReactionsPopup({likeId:this.likeId});e.unbind(document,"mousemove",BXRL.render.reactionsPopupMouseOutHandler);BXRL.render.reactionsPopupMouseOutHandler=null},{likeId:o});var s=e.pos(i);if(e.findParent(i,{className:"feed-com-informers-bottom"})&&(e.findParent(i,{className:"iframe-comments-cont"})||e.findParent(i,{className:"task-iframe-popup"}))){s.left+=100}var p=s.top-e.GetWindowSize().scrollTop<80;if(p){BXRL.render.reactionsPopup.classList.add("feed-post-emoji-popup-inverted")}else{BXRL.render.reactionsPopup.classList.remove("feed-post-emoji-popup-inverted")}var l=p?15:-45;if(BXRL.manager.mobile){BXRL.render.touchMoveDeltaY=p?60:-45;e.adjust(BXRL.render.reactionsPopup,{style:{left:"12px",top:(p?s.top-23:s.top-28)+l+"px",width:"330px",borderRadius:"61px"}});BXRL.render.reactionsPopup.classList.remove("feed-post-emoji-popup-invisible-final");BXRL.render.reactionsPopup.classList.add("feed-post-emoji-popup-active-final");BXRL.render.reactionsPopup.classList.add("feed-post-emoji-popup-active-final-item");BXRL[o].box.classList.add("feed-post-emoji-control-active");BXRL.render.reactionsPopupMobileDisableScroll()}else{BXRL.render.reactionsPopupAnimation=new e.easing({duration:300,start:{width:100,left:s.left+s.width/2-50,top:(p?s.top-30:s.top+30)+l,borderRadius:0,opacity:0},finish:{width:305,left:s.left+s.width/2-133,top:s.top+l-5,borderRadius:50,opacity:100},transition:e.easing.makeEaseInOut(e.easing.transitions.cubic),step:function(e){BXRL.render.reactionsPopup.style.width=e.width+"px";BXRL.render.reactionsPopup.style.left=e.left+"px";BXRL.render.reactionsPopup.style.top=e.top+"px";BXRL.render.reactionsPopup.style.borderRadius=e.borderRadius+"px";BXRL.render.reactionsPopup.style.opacity=e.opacity/100;BXRL.render.reactionsPopupOpacityState=e.opacity},complete:function(){BXRL.render.reactionsPopup.style.opacity="";BXRL.render.reactionsPopup.classList.add("feed-post-emoji-popup-active-final");BXRL[o].box.classList.add("feed-post-emoji-control-active")}});BXRL.render.reactionsPopupAnimation.animate();setTimeout(function(){var t=BXRL.render.reactionsPopup.querySelectorAll(".feed-post-emoji-icon-item");BXRL.render.reactionsPopupAnimation2=new e.easing({duration:140,start:{opacity:0},finish:{opacity:100},transition:e.easing.transitions.cubic,step:function(e){t[0].style.opacity=e.opacity/100;t[1].style.opacity=e.opacity/100;t[2].style.opacity=e.opacity/100;t[3].style.opacity=e.opacity/100;t[4].style.opacity=e.opacity/100;t[5].style.opacity=e.opacity/100;t[6].style.opacity=e.opacity/100},complete:function(){BXRL.render.reactionsPopup.classList.add("feed-post-emoji-popup-active-final-item");t[0].style.opacity="";t[1].style.opacity="";t[2].style.opacity="";t[3].style.opacity="";t[4].style.opacity="";t[5].style.opacity="";t[6].style.opacity=""}});BXRL.render.reactionsPopupAnimation2.animate()},100)}if(!BXRL.render.reactionsPopup.classList.contains("feed-post-emoji-popup-active")){BXRL.render.reactionsPopup.classList.add("feed-post-emoji-popup-active")}if(!BXRL.manager.mobile){e.bind(document,"mousemove",BXRL.render.reactionsPopupMouseOutHandler)}else{BXRL.render.touchScrollTop=e.GetWindowSize().scrollTop;BXRL.render.hasMobileTouchMoved=null;window.addEventListener("touchend",BXRL.render.reactionsPopupMobileTouchEndHandler);window.addEventListener("touchmove",BXRL.render.reactionsPopupMobileTouchMoveHandler)}},reactionsPopupMobileTouchEndHandler:function(e){var t={x:e.changedTouches[0].pageX,y:e.changedTouches[0].pageY};if(BXRL.render.hasMobileTouchMoved===true){var i=null,o=BXRL.render.reactionsPopupMobileGetHoverNode(t.x,t.y);if(o&&(i=o.getAttribute("data-reaction"))){RatingLike.ClickVote(BXRL.render.reactionsPopupLikeId,i,true)}BXRL.render.reactionsPopupMobileHide()}else{window.addEventListener("touchend",BXRL.render.reactionsPopupMobileHide)}window.removeEventListener("touchend",BXRL.render.reactionsPopupMobileTouchEndHandler);window.removeEventListener("touchmove",BXRL.render.reactionsPopupMobileTouchMoveHandler);BXRL.render.touchStartPosition=null;e.preventDefault()},reactionsPopupMobileHide:function(e){window.removeEventListener("touchend",BXRL.render.reactionsPopupMobileHide);if(BXRL.render.reactionsPopupLikeId){BXRL.render.hideReactionsPopup({likeId:BXRL.render.reactionsPopupLikeId});if(e){e.preventDefault()}}},reactionsPopupMobileCheckTouchMove:function(){if(BXRL.render.touchStartPosition===null){return true}else{if(Math.abs(BXRL.render.touchCurrentPosition.x-BXRL.render.touchStartPosition.x)>5||Math.abs(BXRL.render.touchCurrentPosition.y-BXRL.render.touchStartPosition.y)>5){return false}}return true},reactionsPopupMobileTouchMoveHandler:function(e){var t={x:e.touches[0].pageX,y:e.touches[0].pageY};BXRL.render.touchCurrentPosition={x:t.x,y:t.y};if(BXRL.render.touchStartPosition===null){BXRL.render.touchStartPosition={x:t.x,y:t.y}}else{if(BXRL.render.hasMobileTouchMoved!==true){BXRL.render.hasMobileTouchMoved=!BXRL.render.reactionsPopupMobileCheckTouchMove()}}if(BXRL.render.hasMobileTouchMoved===true){var i=BXRL.render.reactionsPopupMobileGetHoverNode(t.x,t.y);if(i){if(BXRL.render.currentReactionNodeHover&&BXRL.render.currentReactionNodeHover!=i){BXRL.render.reactionsPopupMobileRemoveHover(BXRL.render.currentReactionNodeHover)}BXRL.render.reactionsPopupMobileAddHover(i);BXRL.render.currentReactionNodeHover=i}else if(BXRL.render.currentReactionNodeHover){BXRL.render.reactionsPopupMobileRemoveHover(BXRL.render.currentReactionNodeHover)}}else{if(BXRL.render.currentReactionNodeHover){BXRL.render.reactionsPopupMobileRemoveHover(BXRL.render.currentReactionNodeHover)}}},reactionsPopupMobileGetHoverNode:function(t,i){var o=null,n=null,r=null;if((o=document.elementFromPoint(t,i+BXRL.render.touchMoveDeltaY-BXRL.render.touchScrollTop))&&(n=o.getAttribute("data-reaction"))&&e.type.isNotEmptyString(n)||(o=document.elementFromPoint(t,i-BXRL.render.touchScrollTop))&&(n=o.getAttribute("data-reaction"))&&e.type.isNotEmptyString(n)){r=o}return r},reactionsPopupMobileAddHover:function(e){if(e){e.classList.add("feed-post-emoji-icon-item-hover")}},reactionsPopupMobileRemoveHover:function(e){if(e){e.classList.remove("feed-post-emoji-icon-item-hover")}},reactionsPopupMobileDisableScroll:function(){document.addEventListener("touchmove",BXRL.render.touchMoveScrollListener,{passive:false});e.onCustomEvent("onPullDownDisable",{});if(BXRL.render.mobileOverlay===null){BXRL.render.mobileOverlay=e.create("DIV",{props:{className:"feed-post-emoji-popup-mobile-overlay"}});setTimeout(function(){if(BXRL.render.mobileOverlay!==null){e.append(BXRL.render.mobileOverlay,document.body)}},1e3)}},reactionsPopupMobileEnableScroll:function(){document.removeEventListener("touchmove",BXRL.render.touchMoveScrollListener,{passive:false});e.onCustomEvent("onPullDownEnable",{});if(BXRL.render.mobileOverlay!==null){e.cleanNode(BXRL.render.mobileOverlay,true);BXRL.render.mobileOverlay=null}},touchMoveScrollListener:function(e){e.preventDefault()},hideReactionsPopup:function(t){var i=e.type.isNotEmptyString(t.likeId)?t.likeId:false;if(BXRL.render.reactionsPopup){if(BXRL.manager.mobile){BXRL.render.reactionsPopup.classList.add("feed-post-emoji-popup-invisible-final");BXRL.render.reactionsPopup.classList.add("feed-post-emoji-popup-invisible-final-mobile");BXRL.render.reactionsPopup.classList.remove("feed-post-emoji-popup-active");BXRL.render.reactionsPopup.classList.remove("feed-post-emoji-popup-active-final");BXRL.render.reactionsPopup.classList.remove("feed-post-emoji-popup-active-final-item");BXRL.render.reactionsPopupMobileEnableScroll()}else{if(BXRL.render.reactionsPopupAnimation){BXRL.render.reactionsPopupAnimation.stop()}if(BXRL.render.reactionsPopupAnimation2){BXRL.render.reactionsPopupAnimation2.stop()}BXRL.render.reactionsPopup.classList.add("feed-post-emoji-popup-invisible");BXRL.render.reactionsPopupAnimation4=new e.easing({duration:500,start:{opacity:BXRL.render.reactionsPopupOpacityState},finish:{opacity:0},transition:e.easing.transitions.linear,step:function(e){BXRL.render.reactionsPopup.style.opacity=e.opacity/100;BXRL.render.reactionsPopupOpacityState=e.opacity},complete:function(){BXRL.render.reactionsPopup.style.opacity="";BXRL.render.reactionsPopup.classList.add("feed-post-emoji-popup-invisible-final");BXRL.render.reactionsPopup.classList.remove("feed-post-emoji-popup-active");BXRL.render.reactionsPopup.classList.remove("feed-post-emoji-popup-active-final");BXRL.render.reactionsPopup.classList.remove("feed-post-emoji-popup-active-final-item")}});BXRL.render.reactionsPopupAnimation4.animate()}BXRL.render.reactionsPopupLikeId=null;if(i){BXRL[i].box.classList.remove("feed-post-emoji-control-active")}}BXRL.render.reactionsPopupMobileRemoveHover(BXRL.render.currentReactionNodeHover);if(i){BXRL.render.bindReactionsPopup({likeId:i})}},bindReactionsPopup:function(t){if(BXRL.manager.mobile){return false}var i=e.type.isNotEmptyString(t.likeId)?t.likeId:false;if(!i||typeof BXRL[i]=="undefined"||!BXRL[i]){return false}BXRL[i].mouseOverHandler=e.debounce(function(){if(BXRL.render.afterClickBlockShowPopup){e.unbind(BXRL[this.likeId].box,"mouseenter",BXRL[this.likeId].mouseOverHandler);e.unbind(BXRL[this.likeId].box,"mouseleave",BXRL.render.blockReactionsPopup);return}if(!BXRL.render.blockShowPopup){if(BXRL.manager.mobile){app.exec("callVibration")}BXRL.render.showReactionsPopup({bindElement:BXRL[this.likeId].box,likeId:this.likeId});e.unbind(BXRL[this.likeId].box,"mouseenter",BXRL[this.likeId].mouseOverHandler);e.unbind(BXRL[this.likeId].box,"mouseleave",BXRL.render.blockReactionsPopup)}},500,{likeId:i});e.bind(BXRL[i].box,"mouseenter",BXRL[i].mouseOverHandler);e.bind(BXRL[i].box,"mouseleave",BXRL.render.blockReactionsPopup)},buildPopupContent:function(t){var i=!!t.clear?t.clear:false,o=e.type.isNotEmptyString(t.likeId)?t.likeId:false,n=t.rating,r=e.type.isNotEmptyString(t.reaction)?t.reaction:"",a=parseInt(t.page)>0?t.page:1,s=t.data,p=false;var l=[],c=0,d=null,u=null;if(i&&a==1){BXRL.render.clearPopupContent({likeId:o})}this.popupCurrentReaction=e.type.isNotEmptyString(r)?r:"all";if(r.length<=0||r=="all"){BXRL.render.popupSizeInitialized=false;e("bx-ilike-popup-cont-"+o).style.height="auto";e("bx-ilike-popup-cont-"+o).style.minWidth="auto"}if(!e.type.isNotEmptyString(r)){this.popupPagesList={}}this.popupPagesList[r==""?"all":r]=a+1;if(typeof s.reactions!="undefined"){for(p in s.reactions){if(!s.reactions.hasOwnProperty(p)||parseInt(s.reactions[p])<=0){continue}l.push({reaction:p,count:parseInt(s.reactions[p])});c++;d=p}}var f=e.create("span",{props:{className:"bx-ilike-popup-head"}});if(c>1){f.appendChild(e.create("span",{props:{className:"bx-ilike-popup-head-item"+(!e.type.isNotEmptyString(r)||r=="all"?" bx-ilike-popup-head-item-current":"")},children:[e.create("span",{props:{className:"bx-ilike-popup-head-icon feed-post-emoji-icon-all"}}),e.create("span",{props:{className:"bx-ilike-popup-head-text"},html:e.message("RATING_LIKE_POPUP_ALL").replace("#CNT#",parseInt(s.items_all))})],events:{click:e.proxy(function(e){BXRL.render.changePopupTab({likeId:this.likeId,rating:this.rating,reaction:"all"});e.preventDefault()},{likeId:o,rating:n})}}))}if(c==0){l.push({reaction:e.message("RATING_LIKE_REACTION_DEFAULT"),count:parseInt(s.items_all)})}l.sort(function(e,t){var i={like:0,kiss:1,laugh:2,wonder:3,cry:4,angry:5,facepalm:6};if(i[e.reaction]<i[t.reaction]){return-1}if(i[e.reaction]>i[t.reaction]){return 1}return 0});for(var m=0;m<l.length;m++){f.appendChild(e.create("span",{props:{className:"bx-ilike-popup-head-item"+(r==l[m].reaction?" bx-ilike-popup-head-item-current":"")},attrs:{title:e.message("RATING_LIKE_EMOTION_"+l[m].reaction.toUpperCase()+"_CALC")},children:[e.create("span",{props:{className:"bx-ilike-popup-head-icon feed-post-emoji-icon-item feed-post-emoji-icon-"+l[m].reaction}}),e.create("span",{props:{className:"bx-ilike-popup-head-text"},html:l[m].count})],events:{click:e.proxy(function(t){var i=e("bx-ilike-popup-cont-"+this.likeId);var o=i.getBoundingClientRect();if(r.length<=0||r=="all"){BXRL.render.popupSizeInitialized=true;i.style.height=o.height+"px";i.style.minWidth=o.width+"px"}else{if(o.width>parseInt(i.style.minWidth)){i.style.minWidth=o.width+"px"}}BXRL.render.changePopupTab({likeId:this.likeId,rating:this.rating,reaction:this.reaction});t.preventDefault()},{likeId:o,rating:n,reaction:l[m].reaction})}}))}var L=n.popupContent.querySelector(".bx-ilike-popup-content-container");var R=false;if(!L){L=e.create("span",{props:{className:"bx-ilike-popup-content-container"}})}else{R=true}var v=L.querySelectorAll(".bx-ilike-popup-content");for(u=0;u<v.length;u++){v[u].classList.add("bx-ilike-popup-content-invisible")}var h=L.querySelector(".bx-ilike-popup-content-"+this.popupCurrentReaction);if(!h){h=e.create("span",{props:{className:"bx-ilike-popup-content bx-ilike-popup-content-"+this.popupCurrentReaction}});L.appendChild(h)}else{h.classList.remove("bx-ilike-popup-content-invisible")}for(u=0;u<s.items.length;u++){h.appendChild(e.create("a",{props:{className:"bx-ilike-popup-user-item"+(e.type.isNotEmptyString(s.items[u]["USER_TYPE"])?" bx-ilike-popup-user-item-"+s.items[u]["USER_TYPE"]:"")},attrs:{href:s.items[u]["URL"],target:"_blank"},children:[e.create("span",{props:{className:"bx-ilike-popup-user-icon"},style:e.type.isNotEmptyString(s.items[u]["PHOTO_SRC"])?{"background-image":'url("'+s.items[u]["PHOTO_SRC"]+'")'}:{}}),e.create("span",{props:{className:"bx-ilike-popup-user-name"},html:s.items[u]["FULL_NAME"]}),e.create("SPAN",{props:{className:"bx-ilike-popup-user-status"}})]}))}var b=n.popupContent.querySelector(".bx-ilike-wait");if(b){e.cleanNode(b,true)}var y=n.popupContent.querySelector(".bx-ilike-popup-head");if(y){y.parentNode.insertBefore(f,y);y.parentNode.removeChild(y)}else{n.popupContent.appendChild(f)}if(!R){n.popupContent.appendChild(L)}},clearPopupContent:function(t){var i=e.type.isNotEmptyString(t.likeId)?t.likeId:false;BXRL[i].popupContent.innerHTML="";e("bx-ilike-popup-cont-"+i).style.height="auto";e("bx-ilike-popup-cont-"+i).style.minWidth="auto";BXRL[i].popupContent.appendChild(e.create("span",{props:{className:"bx-ilike-wait"}}))},blockReactionsPopup:function(){if(BXRL.render.blockShowPopupTimeout){window.clearTimeout(BXRL.render.blockShowPopupTimeout)}BXRL.render.blockShowPopup=true;BXRL.render.blockShowPopupTimeout=setTimeout(function(){BXRL.render.blockShowPopup=false},500)},changePopupTab:function(t){var i=e.type.isNotEmptyString(t.likeId)?t.likeId:false,o=t.rating,n=e.type.isNotEmptyString(t.reaction)?t.reaction:"",r=false,a=false;var s=o.popupContent.querySelector(".bx-ilike-popup-content-container");if(!s){return false}var p=s.querySelector(".bx-ilike-popup-content-"+n);if(p){this.popupCurrentReaction=e.type.isNotEmptyString(n)?n:"all";var l=o.popupContent.querySelectorAll(".bx-ilike-popup-head-item");for(r=0;r<l.length;r++){l[r].classList.remove("bx-ilike-popup-head-item-current");a=l[r].querySelector(".feed-post-emoji-icon-"+n);if(a){l[r].classList.add("bx-ilike-popup-head-item-current")}}var c=s.querySelectorAll(".bx-ilike-popup-content");for(r=0;r<c.length;r++){c[r].classList.add("bx-ilike-popup-content-invisible")}p.classList.remove("bx-ilike-popup-content-invisible")}else{RatingLike.List(i,1,n)}},afterClick:function(t){var i=e.type.isNotEmptyString(t.likeId)?t.likeId:false;if(!i){return}BXRL.render.afterClickBlockShowPopup=true;BXRL.render.afterClickHandler=e.proxy(function(t){BXRL.render.afterClickBlockShowPopup=false;e.unbind(BXRL[this.likeId].box,"mouseleave",BXRL.render.afterClickHandler)},{likeId:i});e.bind(BXRL[i].box,"mouseleave",BXRL.render.afterClickHandler)},resultReactionClick:function(t){var i=t.currentTarget.getAttribute("data-like-id"),o=t.currentTarget.getAttribute("data-reaction");if(!e.type.isNotEmptyString(o)){o=""}RatingLike.onResultClick({likeId:i,event:t,reaction:o});t.stopPropagation()},resultReactionMouseEnter:function(e){var t=e.currentTarget.getAttribute("data-like-id"),i=e.currentTarget.getAttribute("data-reaction");RatingLike.onResultMouseEnter({likeId:t,event:e,reaction:i})},resultReactionMouseLeave:function(e){var t=e.currentTarget.getAttribute("data-like-id"),i=e.currentTarget.getAttribute("data-reaction");RatingLike.onResultMouseLeave({likeId:t,reaction:i})},openMobileReactionsPage:function(t){BXMobileApp.PageManager.loadPageBlank({url:e.message("SITE_DIR")+"mobile/like/result.php",title:e.message("RATING_LIKE_RESULTS"),backdrop:{mediumPositionPercent:65},cache:true,data:{entityTypeId:t.entityTypeId,entityId:t.entityId}})},onRatingLike:function(t){for(var i in BXRL){if(!BXRL.hasOwnProperty(i)){continue}if(BXRL[i].entityTypeId==t.entityTypeId&&BXRL[i].entityId==t.entityId){var o=e.type.isNotEmptyString(t.voteAction)?t.voteAction.toUpperCase():"ADD";o=o=="PLUS"?"ADD":o;if(t.userId==e.message("USER_ID")&&BXRL[i].button){if(o=="CANCEL"){e.removeClass(BXRL[i].button,"bx-you-like-button")}else{e.addClass(BXRL[i].button,"bx-you-like-button")}}RatingLike.Draw(i,{TYPE:o,USER_ID:t.userId,ENTITY_TYPE_ID:t.entityTypeId,ENTITY_ID:t.entityId,USER_DATA:t.userData,REACTION:t.voteReaction,REACTION_OLD:t.voteReactionOld,TOTAL_POSITIVE_VOTES:t.itemsAll})}}},onMobileCommentsGet:function(){var e=document.querySelector(".feed-post-emoji-popup-container");if(e){e.style.top=0;e.style.left=0;e.classList.remove("feed-post-emoji-popup-active");e.classList.remove("feed-post-emoji-popup-active-final");e.classList.remove("feed-post-emoji-popup-active-final-item");e.classList.add("feed-post-emoji-popup-invisible-final");e.classList.add("feed-post-emoji-popup-invisible-final-mobile")}}};BXRL.manager={mobile:false,inited:false,displayHeight:0,startScrollTop:0,entityList:[],ratingNodeList:{},delayedList:{},init:function(t){if(typeof t=="undefined"){t={}}if(this.inited){return}this.mobile=typeof t.mobile!="undefined"&&!!t.mobile;this.inited=true;this.setDisplayHeight();if(!this.mobile){window.addEventListener("scroll",e.throttle(function(){this.getInViewScope()},80,this),{passive:true});window.addEventListener("resize",e.delegate(this.setDisplayHeight,this))}e.addCustomEvent("onBeforeMobileLivefeedRefresh",BXRL.render.reactionsPopupMobileHide);e.addCustomEvent("BX.MobileLF:onCommentsGet",BXRL.render.onMobileCommentsGet);if(this.mobile){BXMobileApp.addCustomEvent("onRatingLike",BXRL.render.onRatingLike)}},addEntity:function(t,i){if(!e.util.in_array(t,this.entityList)&&i.topPanelContainer){this.entityList.push(t);this.addNode(t,i.topPanelContainer)}},checkEntity:function(t){return e.util.in_array(t,this.entityList)},addNode:function(t,i){if(e(i)&&typeof this.ratingNodeList[t]!="undefined"){return}this.ratingNodeList[t]=i},getNode:function(e){var t=false;if(typeof this.ratingNodeList[e]!=undefined){t=this.ratingNodeList[e]}return t},setDisplayHeight:function(){this.displayHeight=document.documentElement.clientHeight},getInViewScope:function(){var t=null;for(var i in this.delayedList){if(!this.delayedList.hasOwnProperty(i)){continue}t=e(this.getNode(i));if(!t){continue}if(this.isNodeVisibleOnScreen(t)){this.fireAnimation(i,t,this.delayedList[i])}}},isNodeVisibleOnScreen:function(e){var t=e.getBoundingClientRect();var i=parseInt(this.displayHeight/10);var o=parseInt(this.displayHeight*9/10);return(t.top>0&&t.top<o||t.bottom>i&&t.bottom<this.displayHeight)&&(this.mobile||!(t.top<i&&t.bottom<i||t.top>o&&t.bottom>o))},live:function(t){if(typeof t.TYPE=="undefined"||t.TYPE!="ADD"||!e.type.isNotEmptyString(t.ENTITY_TYPE_ID)||typeof t.ENTITY_ID=="undefined"||parseInt(t.ENTITY_ID)<=0){return}var i=t.ENTITY_TYPE_ID+"_"+t.ENTITY_ID;if(!this.checkEntity(i)){return}var o=this.getNode(i);if(!o){return false}if(this.isNodeVisibleOnScreen(o)){this.fireAnimation(i,o,t)}else{this.addDelayed(t)}},addDelayed:function(t){if(!e.type.isNotEmptyString(t.ENTITY_TYPE_ID)||typeof t.ENTITY_ID=="undefined"||parseInt(t.ENTITY_ID)<=0){return}var i=t.ENTITY_TYPE_ID+"_"+t.ENTITY_ID;if(typeof this.delayedList[i]=="undefined"){this.delayedList[i]=[]}this.delayedList[i].push(t)},fireAnimation:function(e,t,i){if(typeof this.delayedList[e]!="undefined"){delete this.delayedList[e]}}}})();
//# sourceMappingURL=main.rating.map.js