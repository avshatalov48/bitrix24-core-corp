{"version":3,"file":"main.rating.js","sources":["src/listpopup.js","src/render.js","src/manager.js","src/like.js","src/index.js"],"sourcesContent":["import { Type, Dom, Event, ajax } from 'main.core';\nimport { Popup } from 'main.popup';\nimport { EventEmitter } from 'main.core.events';\n\nimport { RatingManager } from './manager';\nimport { RatingLike } from './like';\nimport { RatingRender } from './render';\n\nexport class ListPopup\n{\n\tstatic popupLikeId = null;\n\n\tstatic removeOnCloseHandler = this.removeOnClose.bind(this);\n\n\tstatic getListPopup(params)\n\t{\n\t\tconst likeId = params.likeId;\n\t\tconst likeInstance = RatingLike.getInstance(likeId);\n\t\tconst target = params.target;\n\t\tconst reaction = params.reaction;\n\t\tconst nodeId = params.nodeId;\n\n\t\tif (this.popupLikeId === likeId)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tif (likeInstance.popupContentPage != 1)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.List(likeId, 1, reaction, true);\n\n\t\tlikeInstance.popupTimeoutIdShow = setTimeout(() => {\n\t\t\tthis.getListPopupShow({\n\t\t\t\tlikeId: likeId,\n\t\t\t\treaction: reaction,\n\t\t\t\ttarget: target,\n\t\t\t\tnodeId: nodeId,\n\t\t\t})\n\t\t}, 100);\n\t}\n\n\tstatic getListPopupShow(params)\n\t{\n\t\tconst likeId = params.likeId;\n\t\tconst likeInstance = RatingLike.getInstance(likeId);\n\t\tconst target = params.target;\n\t\tconst reaction = params.reaction;\n\t\tconst nodeId = params.nodeId;\n\n\t\tlikeInstance.resultPopupAnimation = true;\n\n\t\tsetTimeout(() => {\n\t\t\tthis.getListPopupAnimation({\n\t\t\t\tlikeId: likeId,\n\t\t\t});\n\t\t}, 500);\n\n\t\tif (likeInstance.mouseInShowPopupNode[reaction])\n\t\t{\n\t\t\tthis.OpenWindow(\n\t\t\t\tlikeId,\n\t\t\t\tnull,\n\t\t\t\ttarget,\n\t\t\t\tnodeId\n\t\t\t);\n\t\t}\n\t}\n\n\tstatic getListPopupAnimation(params)\n\t{\n\t\tconst likeId = params.likeId;\n\t\tconst likeInstance = RatingLike.getInstance(likeId);\n\n\t\tlikeInstance.resultPopupAnimation = false;\n\t}\n\n\tstatic OpenWindow(likeId, clickEvent, target, targetId)\n\t{\n\t\tconst likeInstance = RatingLike.getInstance(likeId);\n\n\t\tif (Number(likeInstance.countText.innerHTML) === 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst bindNode = (\n\t\t\tlikeInstance.template === 'standart'\n\t\t\t\t? likeInstance.count\n\t\t\t\t: (\n\t\t\t\t\tlikeInstance.version === 2\n\t\t\t\t\t\t? (\n\t\t\t\t\t\t\tType.isDomNode(target)\n\t\t\t\t\t\t\t\t? target\n\t\t\t\t\t\t\t\t: (\n\t\t\t\t\t\t\t\t\tType.isStringFilled(targetId) && document.getElementById(targetId)\n\t\t\t\t\t\t\t\t\t\t? document.getElementById(targetId)\n\t\t\t\t\t\t\t\t\t\t: null\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t)\n\t\t\t\t\t\t: likeInstance.box\n\t\t\t\t)\n\t\t);\n\n\t\tif (!Type.isDomNode(bindNode))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (likeInstance.popup == null)\n\t\t{\n\t\t\tconst globalZIndex = this.getGlobalIndex(bindNode);\n\n\t\t\tconst popupClassNameList = [];\n\t\t\tif (likeInstance.topPanel)\n\t\t\t{\n\t\t\t\tpopupClassNameList.push('bx-ilike-wrap-block-react-wrap');\n\t\t\t}\n\t\t\tif (RatingManager.mobile)\n\t\t\t{\n\t\t\t\tpopupClassNameList.push('bx-ilike-mobile-wrap');\n\t\t\t}\n\n\t\t\tlikeInstance.popup = new Popup({\n\t\t\t\tid: `ilike-popup-${likeId}`,\n\t\t\t\tbindElement: bindNode,\n\t\t\t\tlightShadow : true,\n\t\t\t\toffsetTop: 0,\n\t\t\t\toffsetLeft: (\n\t\t\t\t\t!Type.isUndefined(clickEvent)\n\t\t\t\t\t&& !Type.isNull(clickEvent)\n\t\t\t\t\t&& !Type.isUndefined(clickEvent.offsetX)\n\t\t\t\t\t\t? (clickEvent.offsetX - 100)\n\t\t\t\t\t\t: (likeInstance.version == 2 ? -30 : 5)\n\t\t\t\t),\n\t\t\t\tautoHide: true,\n\t\t\t\tcloseByEsc: true,\n\t\t\t\tzIndexAbsolute: (globalZIndex > 1000 ? globalZIndex + 1 : 1000),\n\t\t\t\tbindOptions: {\n\t\t\t\t\tposition: 'top',\n\t\t\t\t},\n\t\t\t\tanimation: 'fading-slide',\n\t\t\t\tevents: {\n\t\t\t\t\tonPopupClose: () => {\n\t\t\t\t\t\tthis.popupLikeId = null;\n\t\t\t\t\t},\n\t\t\t\t\tonPopupDestroy: () => {},\n\t\t\t\t},\n\t\t\t\tcontent : document.getElementById(`bx-ilike-popup-cont-${likeId}`),\n\t\t\t\tclassName: popupClassNameList.join(' '),\n\t\t\t});\n\n\t\t\tif (\n\t\t\t\t!likeInstance.topPanel\n\t\t\t\t&& !RatingManager.mobile\n\t\t\t)\n\t\t\t{\n\t\t\t\tlikeInstance.popup.setAngle({});\n\n\t\t\t\tdocument.getElementById(`ilike-popup-${likeId}`).addEventListener('mouseout', () => {\n\t\t\t\t\tclearTimeout(likeInstance.popupTimeout);\n\t\t\t\t\tlikeInstance.popupTimeout = setTimeout(() => {\n\t\t\t\t\t\tlikeInstance.popup.close();\n\t\t\t\t\t}, 1000);\n\t\t\t\t});\n\n\t\t\t\tdocument.getElementById(`ilike-popup-${likeId}`).addEventListener('mouseover', () => {\n\t\t\t\t\tclearTimeout(likeInstance.popupTimeout);\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (\n\t\t\t\t!Type.isUndefined(clickEvent)\n\t\t\t\t&& !Type.isNull(clickEvent)\n\t\t\t\t&& !Type.isUndefined(clickEvent.offsetX)\n\t\t\t)\n\t\t\t{\n\t\t\t\tlikeInstance.popup.offsetLeft = (clickEvent.offsetX - 100);\n\t\t\t}\n\n\t\t\tlikeInstance.popup.setBindElement(bindNode);\n\t\t}\n\n\t\tif (this.popupLikeId !== likeId)\n\t\t{\n\t\t\tconst popupLikeInstance = RatingLike.getInstance(this.popupLikeId);\n\t\t\tif (popupLikeInstance)\n\t\t\t{\n\t\t\t\tpopupLikeInstance.popup.close();\n\t\t\t}\n\t\t}\n\n\t\tthis.popupLikeId = likeId;\n\n\t\tlikeInstance.popup.show();\n\n\t\tthis.AdjustWindow(likeId);\n\t}\n\n\tstatic getGlobalIndex(element)\n\t{\n\t\tlet index = 0;\n\t\tlet propertyValue = '';\n\n\t\tdo\n\t\t{\n\t\t\tpropertyValue = Dom.style(element, 'z-index');\n\t\t\tif (propertyValue !== 'auto')\n\t\t\t{\n\t\t\t\tindex = !Number.isNaN(parseInt(propertyValue)) ? index : 0;\n\t\t\t}\n\t\t\telement = element.offsetParent;\n\t\t}\n\t\twhile (\n\t\t\telement\n\t\t\t&& element.tagName !== 'BODY'\n\t\t\t);\n\n\t\treturn index;\n\t}\n\n\tstatic removeOnClose()\n\t{\n\t\tEventEmitter.unsubscribe(BX.SidePanel.Instance.getTopSlider().getWindow(), 'SidePanel.Slider:onClose', this.removeOnCloseHandler);\n\n\t\tconst popupLikeInstance = RatingLike.getInstance(this.popupLikeId);\n\t\tif (popupLikeInstance)\n\t\t{\n\t\t\tpopupLikeInstance.popup.close();\n\t\t}\n\t}\n\n\tstatic AdjustWindow(likeId)\n\t{\n\t\tlet likeInstance = RatingLike.getInstance(likeId);\n\n\t\tif (!likeInstance.popup)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlikeInstance.popup.bindOptions.forceBindPosition = true;\n\t\tlikeInstance.popup.adjustPosition();\n\t\tlikeInstance.popup.bindOptions.forceBindPosition = false;\n\t}\n\n\tstatic PopupScroll(likeId)\n\t{\n\t\tconst likeInstance = RatingLike.getInstance(likeId);\n\n\t\tlet contentContainerNodeList = likeInstance.popupContent.querySelectorAll('.bx-ilike-popup-content'); // reactions\n\t\tif (contentContainerNodeList.length <= 0)\n\t\t{\n\t\t\tcontentContainerNodeList = [ likeInstance.popupContent ];\n\t\t}\n\n\t\tcontentContainerNodeList.forEach((contentContainerNode) => {\n\t\t\tcontentContainerNode.addEventListener('scroll', (e) => {\n\t\t\t\tif (e.target.scrollTop <= (e.target.scrollHeight - e.target.offsetHeight) / 1.5)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis.List(likeId, null, (likeInstance.version == 2 ? RatingRender.popupCurrentReaction : false));\n\t\t\t\tEvent.unbindAll(e.target);\n\t\t\t});\n\t\t});\n\t}\n\n\tstatic List(likeId, page, reaction, clear)\n\t{\n\t\tconst likeInstance = RatingLike.getInstance(likeId);\n\n\t\tif (Number(likeInstance.countText.innerHTML) === 0)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\treaction = (Type.isStringFilled(reaction) ? reaction : '');\n\n\t\tif (Type.isNull(page))\n\t\t{\n\t\t\tpage = (\n\t\t\t\tlikeInstance.version === 2\n\t\t\t\t\t? (\n\t\t\t\t\t\t!Type.isUndefined(RatingRender.popupPagesList[reaction])\n\t\t\t\t\t\t\t? RatingRender.popupPagesList[reaction]\n\t\t\t\t\t\t\t: 1\n\t\t\t\t\t)\n\t\t\t\t\t: likeInstance.popupContentPage\n\t\t\t);\n\t\t}\n\n\t\tif (\n\t\t\tclear\n\t\t\t&& Number(page) === 1\n\t\t\t&& likeInstance.version === 2\n\t\t)\n\t\t{\n\t\t\tRatingRender.clearPopupContent({\n\t\t\t\tlikeId: likeId,\n\t\t\t});\n\t\t}\n\n\t\tif (likeInstance.listXHR)\n\t\t{\n\t\t\tlikeInstance.listXHR.abort();\n\t\t}\n\n\t\tajax.runAction('main.rating.list', {\n\t\t\tdata: {\n\t\t\t\tparams: {\n\t\t\t\t\tRATING_VOTE_TYPE_ID: likeInstance.entityTypeId,\n\t\t\t\t\tRATING_VOTE_ENTITY_ID: likeInstance.entityId,\n\t\t\t\t\tRATING_VOTE_LIST_PAGE: page,\n\t\t\t\t\tRATING_VOTE_REACTION: (reaction === 'all' ? '' : reaction),\n\t\t\t\t\tPATH_TO_USER_PROFILE: likeInstance.pathToUserProfile,\n\t\t\t\t},\n\t\t\t},\n\t\t\tonrequeststart: (xhr) => {\n\t\t\t\tlikeInstance.listXHR = xhr;\n\t\t\t},\n\t\t}).then((result) => {\n\t\t\t\tthis.onListSuccess(result.data, {\n\t\t\t\t\tlikeId: likeId,\n\t\t\t\t\treaction: reaction,\n\t\t\t\t\tpage: page,\n\t\t\t\t\tclear: clear,\n\t\t\t\t});\n\t\t\t},\n\t\t\t() => {}\n\t\t);\n\n\t\treturn false;\n\t}\n\n\tstatic onListSuccess(data, params)\n\t{\n\t\tif (!data)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst likeInstance = RatingLike.getInstance(params.likeId);\n\n\t\tlikeInstance.countText.innerHTML = data.items_all;\n\n\t\tif (Number(data.items_page) === 0)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tif (likeInstance.version === 2)\n\t\t{\n\t\t\tRatingRender.buildPopupContent({\n\t\t\t\tlikeId: params.likeId,\n\t\t\t\treaction: params.reaction,\n\t\t\t\trating: likeInstance,\n\t\t\t\tpage: params.page,\n\t\t\t\tdata: data,\n\t\t\t\tclear: params.clear,\n\t\t\t});\n\t\t\tlikeInstance.topPanel.setAttribute('data-popup', 'Y');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tRatingRender.buildPopupContentNoReactions({\n\t\t\t\trating: likeInstance,\n\t\t\t\tpage: params.page,\n\t\t\t\tdata: data,\n\t\t\t});\n\t\t}\n\n\t\tthis.AdjustWindow(params.likeId);\n\t\tthis.PopupScroll(params.likeId);\n\t}\n\n\tstatic onResultClick(params)\n\t{\n\t\tconst likeId = (Type.isStringFilled(params.likeId) ? params.likeId : false);\n\t\tconst clickEvent = (!Type.isUndefined(params.event) ? params.event : false);\n\t\tconst reaction = (Type.isStringFilled(params.reaction) ? params.reaction : '');\n\t\tconst likeInstance = RatingLike.getInstance(likeId);\n\n\t\tif (likeInstance.resultPopupAnimation)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (\n\t\t\tlikeInstance.popup\n\t\t\t&& likeInstance.popup.isShown()\n\t\t)\n\t\t{\n\t\t\tlikeInstance.popup.close();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tclearTimeout(likeInstance.popupTimeoutIdList);\n\t\t\tclearTimeout(likeInstance.popupTimeoutIdShow);\n\n\t\t\tif (\n\t\t\t\tlikeInstance.popupContentPage == 1\n\t\t\t\t&& (\n\t\t\t\t\tlikeInstance.topPanel.getAttribute('data-popup') !== 'Y'\n\t\t\t\t\t|| likeInstance.popupCurrentReaction != reaction\n\t\t\t\t)\n\t\t\t)\n\t\t\t{\n\t\t\t\tthis.List(likeId, 1, reaction, true);\n\t\t\t}\n\n\t\t\tthis.OpenWindow(\n\t\t\t\tlikeId,\n\t\t\t\t(clickEvent.currentTarget === likeInstance.count ? null : clickEvent),\n\t\t\t\tclickEvent.currentTarget,\n\t\t\t\tclickEvent.currentTarget.id\n\t\t\t);\n\t\t}\n\t}\n\n\tstatic onResultMouseEnter(params)\n\t{\n\t\tconst likeId = (Type.isStringFilled(params.likeId) ? params.likeId : false);\n\t\tconst mouseEnterEvent = (!Type.isUndefined(params.event) ? params.event : null);\n\t\tconst reaction = (Type.isStringFilled(params.reaction) ? params.reaction : '');\n\t\tconst nodeId = (\n\t\t\tmouseEnterEvent && Type.isStringFilled(mouseEnterEvent.currentTarget.id)\n\t\t\t\t? mouseEnterEvent.currentTarget.id\n\t\t\t\t: ''\n\t\t);\n\n\t\tconst likeInstance = RatingLike.getInstance(likeId);\n\n\t\tlikeInstance.mouseInShowPopupNode[reaction] = true;\n\n\t\tclearTimeout(likeInstance.popupTimeoutIdList);\n\t\tclearTimeout(likeInstance.popupTimeoutIdShow);\n\n\t\tlikeInstance.popupTimeoutIdList = setTimeout(() => {\n\t\t\tthis.getListPopup({\n\t\t\t\tlikeId: likeId,\n\t\t\t\ttarget: mouseEnterEvent.currentTarget,\n\t\t\t\treaction: reaction,\n\t\t\t\tnodeId: nodeId,\n\t\t\t});\n\t\t}, 300);\n\t}\n\n\tstatic onResultMouseLeave(params)\n\t{\n\t\tconst likeId = (Type.isStringFilled(params.likeId) ? params.likeId : false);\n\t\tconst reaction = (Type.isStringFilled(params.reaction) ? params.reaction : '');\n\t\tconst likeInstance = RatingLike.getInstance(likeId);\n\n\t\tlikeInstance.mouseInShowPopupNode[reaction] = false;\n\t\tlikeInstance.resultPopupAnimation = false;\n\t}\n}\n","import { Type, Loc, Dom, Runtime, pos, GetWindowSize } from 'main.core';\nimport { EventEmitter } from 'main.core.events'\n\nimport { RatingManager } from './manager';\nimport { RatingLike } from './like';\nimport { ListPopup } from './listpopup';\n\nexport class RatingRender\n{\n\tstatic reactionsList = [ 'like', 'kiss', 'laugh', 'wonder', 'cry', 'angry', 'facepalm' ];\n\tstatic popupCurrentReaction = false;\n\tstatic popupPagesList = [];\n\tstatic popupSizeInitialized = false;\n\tstatic blockShowPopup = false;\n\tstatic blockShowPopupTimeout = false;\n\tstatic afterClickBlockShowPopup = false;\n\tstatic afterClickHandler = null;\n\tstatic touchStartPosition = null;\n\tstatic touchCurrentPosition = {\n\t\tx: null,\n\t\ty: null,\n\t};\n\tstatic currentReactionNodeHover = null;\n\n\tstatic touchMoveDeltaY = null;\n\tstatic touchScrollTop = 0;\n\n\tstatic hasMobileTouchMoved = null;\n\tstatic mobileOverlay = null;\n\n\tstatic reactionsPopup = null;\n\tstatic reactionsPopupAnimation = null;\n\tstatic reactionsPopupAnimation2 = null;\n\tstatic reactionsPopupLikeId = null;\n\tstatic reactionsPopupMouseOutHandler = null;\n\tstatic reactionsPopupOpacityState = 0;\n\tstatic reactionsPopupTouchStartIn = null;\n\tstatic reactionsPopupPositionY = null;\n\tstatic blockTouchEndByScroll = false;\n\n\tstatic reactionsPopupMobileTouchEndHandler = this.reactionsPopupMobileTouchEnd.bind(this);\n\tstatic reactionsPopupMobileTouchMoveHandler = this.reactionsPopupMobileTouchMove.bind(this);\n\tstatic reactionsPopupMobileHideHandler = this.reactionsPopupMobileHide.bind(this);\n\n\tstatic getTopUsersText(params)\n\t{\n\t\tconst currentUserId = Number(Loc.getMessage('USER_ID'));\n\t\tconst you = (!Type.isUndefined(params.you) ? !!params.you : false);\n\t\tconst topList = (!Type.isUndefined(params.top) && Type.isArray(params.top) ? params.top : []);\n\t\tconst more = (!Type.isUndefined(params.more) ? Number(params.more) : 0);\n\t\tlet result = '';\n\n\t\tif (\n\t\t\ttopList.length <= 0\n\t\t\t&& !you\n\t\t\t&& (\n\t\t\t\tRatingManager.mobile\n\t\t\t\t|| more <= 0\n\t\t\t)\n\t\t)\n\t\t{\n\t\t\treturn result;\n\t\t}\n\n\t\tif (RatingManager.mobile)\n\t\t{\n\t\t\tif (you)\n\t\t\t{\n\t\t\t\ttopList.push({\n\t\t\t\t\tID: currentUserId,\n\t\t\t\t\tNAME_FORMATTED: Loc.getMessage('RATING_LIKE_TOP_TEXT3_YOU'),\n\t\t\t\t\tWEIGHT: 1,\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tresult = Loc.getMessage(`RATING_LIKE_TOP_TEXT3_${(topList.length > 1 ? '2' : '1')}`)\n\t\t\t\t.replace('#OVERFLOW_START#', RatingManager.mobile ? '<span class=\"feed-post-emoji-text-item-overflow\">' : '')\n\t\t\t\t.replace('#OVERFLOW_END#', RatingManager.mobile ? '</span>' : '');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tresult = Loc.getMessage(`RATING_LIKE_TOP_TEXT2_${(you ? 'YOU_' : '')}${(topList.length)}${(more > 0 ? '_MORE' : '')}`)\n\t\t\t\t.replace('#OVERFLOW_START#', RatingManager.mobile ? '<span class=\"feed-post-emoji-text-item-overflow\">' : '')\n\t\t\t\t.replace('#OVERFLOW_END#', RatingManager.mobile ? '</span>' : '')\n\t\t\t\t.replace('#MORE_START#', RatingManager.mobile ? '<span class=\"feed-post-emoji-text-item-more\">' : '&nbsp;')\n\t\t\t\t.replace('#MORE_END#', RatingManager.mobile ? '</span>' : '');\n\t\t}\n\n\t\tif (RatingManager.mobile)\n\t\t{\n\t\t\ttopList.sort((a, b) => {\n\t\t\t\tif (parseInt(a.ID) === currentUserId)\n\t\t\t\t{\n\t\t\t\t\treturn -1;\n\t\t\t\t}\n\n\t\t\t\tif (parseInt(b.ID) === currentUserId)\n\t\t\t\t{\n\t\t\t\t\treturn 1;\n\t\t\t\t}\n\n\t\t\t\tif (parseFloat(a.WEIGHT) === parseFloat(b.WEIGHT))\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn (parseFloat(a.WEIGHT) > parseFloat(b.WEIGHT) ? -1 : 1);\n\t\t\t});\n\n\t\t\tconst userNameList = topList.map((item) => {\n\t\t\t\treturn item.NAME_FORMATTED;\n\t\t\t});\n\n\t\t\tlet userNameBegin = '';\n\t\t\tlet userNameEnd = '';\n\n\t\t\tif (userNameList.length === 1)\n\t\t\t{\n\t\t\t\tuserNameBegin = userNameList.pop();\n\t\t\t\tuserNameEnd = '';\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tuserNameBegin = userNameList.slice(0, userNameList.length - 1)\n\t\t\t\t\t.join(Loc.getMessage('RATING_LIKE_TOP_TEXT3_USERLIST_SEPARATOR').replace(/#USERNAME#/g, ''));\n\t\t\t\tuserNameEnd = userNameList[userNameList.length - 1];\n\t\t\t}\n\n\t\t\tresult = result.replace('#USER_LIST_BEGIN#', userNameBegin)\n\t\t\t\t.replace('#USER_LIST_END#', userNameEnd);\n\t\t}\n\t\telse\n\t\t{\n\t\t\ttopList.forEach((item, i) => {\n\n\t\t\t\tresult = result.replace(\n\t\t\t\t\t`#USER_${(Number(i) + 1)}#`,\n\t\t\t\t\t`<span class=\"feed-post-emoji-text-item\">${item.NAME_FORMATTED}</span>`\n\t\t\t\t);\n\t\t\t});\n\n\t\t\tresult = result.replace('#USERS_MORE#', '<span class=\"feed-post-emoji-text-item\">' + more + '</span>');\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tstatic getUserReaction(params)\n\t{\n\t\treturn (\n\t\t\tType.isDomNode(params.userReactionNode)\n\t\t\t\t? params.userReactionNode.getAttribute('data-value')\n\t\t\t\t: ''\n\t\t);\n\t}\n\n\tstatic setReaction(params)\n\t{\n\t\tif (\n\t\t\tType.isUndefined(params.rating)\n\t\t\t|| !Type.isStringFilled(params.likeId)\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst action = (Type.isStringFilled(params.action) ? params.action : 'add');\n\t\tif (!['add', 'cancel', 'change'].includes(action))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst likeId = params.likeId;\n\t\tconst rating = params.rating;\n\t\tconst userReaction = (Type.isStringFilled(params.userReaction) ? params.userReaction : Loc.getMessage('RATING_LIKE_REACTION_DEFAULT'));\n\t\tconst userReactionOld = (Type.isStringFilled(params.userReactionOld) ? params.userReactionOld : Loc.getMessage('RATING_LIKE_REACTION_DEFAULT'));\n\t\tif (\n\t\t\taction === 'change'\n\t\t\t&& userReaction === userReactionOld\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst totalCount = (!Type.isUndefined(params.totalCount) ? Number(params.totalCount) : null);\n\t\tconst currentUserId = Number(Loc.getMessage('USER_ID'));\n\t\tconst userId = (!Type.isUndefined(params.userId) ? Number(params.userId) : currentUserId);\n\n\t\tconst userReactionNode = this.getNode(rating.userReactionNode);\n\t\tconst reactionsNode = this.getNode(rating.reactionsNode);\n\t\tconst topPanel = this.getNode(rating.topPanel);\n\t\tconst topPanelContainer = this.getNode(rating.topPanelContainer);\n\t\tconst topUsersText = this.getNode(rating.topUsersText);\n\t\tconst countText = this.getNode(rating.countText);\n\t\tconst buttonText = this.getNode(rating.buttonText);\n\n\t\tif (\n\t\t\tuserId === currentUserId // not pull\n\t\t\t&& userReactionNode\n\t\t)\n\t\t{\n\t\t\tuserReactionNode.setAttribute('data-value', [ 'add', 'change' ].includes(action) ? userReaction : '');\n\t\t}\n\n\t\tlet i = 0;\n\t\tlet elements = [];\n\t\tlet elementsNew = [];\n\n\t\tif (\n\t\t\ttotalCount !== null\n\t\t\t&& topPanel\n\t\t\t&& topUsersText\n\t\t\t&& reactionsNode\n\t\t)\n\t\t{\n\t\t\tif (totalCount > 0)\n\t\t\t{\n\t\t\t\ttopPanelContainer.classList.add('feed-post-emoji-top-panel-container-active');\n\n\t\t\t\tif (!topPanel.classList.contains('feed-post-emoji-container-toggle'))\n\t\t\t\t{\n\t\t\t\t\ttopPanel.classList.add('feed-post-emoji-container-toggle');\n\t\t\t\t\ttopUsersText.classList.add('feed-post-emoji-move-to-right');\n\t\t\t\t\treactionsNode.classList.add('feed-post-emoji-icon-box-show');\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (totalCount <= 0)\n\t\t\t{\n\t\t\t\ttopPanelContainer.classList.remove('feed-post-emoji-top-panel-container-active');\n\n\t\t\t\tif (topPanel.classList.contains('feed-post-emoji-container-toggle'))\n\t\t\t\t{\n\t\t\t\t\ttopPanel.classList.remove('feed-post-emoji-container-toggle');\n\t\t\t\t\ttopUsersText.classList.remove('feed-post-emoji-move-to-right');\n\t\t\t\t\treactionsNode.classList.remove('feed-post-emoji-icon-box-show');\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (\n\t\t\ttotalCount !== null\n\t\t\t&& countText\n\t\t)\n\t\t{\n\t\t\tif (\n\t\t\t\ttotalCount <= 0\n\t\t\t\t&& !countText.classList.contains('feed-post-emoji-text-counter-invisible')\n\t\t\t)\n\t\t\t{\n\t\t\t\tcountText.classList.add('feed-post-emoji-text-counter-invisible');\n\t\t\t}\n\t\t\telse if (\n\t\t\t\ttotalCount > 0\n\t\t\t\t&& countText.classList.contains('feed-post-emoji-text-counter-invisible')\n\t\t\t)\n\t\t\t{\n\t\t\t\tcountText.classList.remove('feed-post-emoji-text-counter-invisible');\n\t\t\t}\n\t\t}\n\n\t\tif (reactionsNode)\n\t\t{\n\t\t\tconst reactionsContainer = reactionsNode.querySelector('.feed-post-emoji-icon-container');\n\t\t\telements = reactionsNode.querySelectorAll('.feed-post-emoji-icon-item');\n\n\t\t\tif (reactionsContainer)\n\t\t\t{\n\t\t\t\tlet found = false;\n\t\t\t\tlet newValue = false;\n\n\t\t\t\telements.forEach((element) => {\n\n\t\t\t\t\tconst reactionValue = element.getAttribute('data-reaction');\n\t\t\t\t\tconst reactionCount = Number(element.getAttribute('data-value'));\n\n\t\t\t\t\tif (reactionValue === userReaction)\n\t\t\t\t\t{\n\t\t\t\t\t\tfound = true;\n\t\t\t\t\t\tif (action === 'cancel')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tnewValue = (reactionCount > 0 ? reactionCount - 1 : 0);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if ([ 'add', 'change' ].includes(action))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tnewValue = reactionCount + 1;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (newValue > 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\telementsNew.push({\n\t\t\t\t\t\t\t\treaction: reactionValue,\n\t\t\t\t\t\t\t\tcount: newValue,\n\t\t\t\t\t\t\t\tanimate: false,\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse if (\n\t\t\t\t\t\taction === 'change'\n\t\t\t\t\t\t&& reactionValue === userReactionOld\n\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\tnewValue = (reactionCount > 0 ? reactionCount - 1 : 0);\n\n\t\t\t\t\t\tif (newValue > 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\telementsNew.push({\n\t\t\t\t\t\t\t\treaction: reactionValue,\n\t\t\t\t\t\t\t\tcount: newValue,\n\t\t\t\t\t\t\t\tanimate: false,\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\telementsNew.push({\n\t\t\t\t\t\t\treaction: reactionValue,\n\t\t\t\t\t\t\tcount: reactionCount,\n\t\t\t\t\t\t\tanimate: false,\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tif (\n\t\t\t\t\t['add', 'change'].includes(action)\n\t\t\t\t\t&& !found\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\telementsNew.push({\n\t\t\t\t\t\treaction: userReaction,\n\t\t\t\t\t\tcount: 1,\n\t\t\t\t\t\tanimate: true,\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tDom.clean(reactionsContainer);\n\n\t\t\t\tif (topPanel)\n\t\t\t\t{\n\t\t\t\t\tif (elementsNew.length > 0)\n\t\t\t\t\t{\n\t\t\t\t\t\ttopPanel.classList.add('feed-post-emoji-container-nonempty');\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\ttopPanel.classList.remove('feed-post-emoji-container-nonempty');\n\t\t\t\t\t}\n\n\t\t\t\t\tif (RatingManager.mobile)\n\t\t\t\t\t{\n\t\t\t\t\t\tconst commentNode = topPanel.closest('.post-comment-block');\n\t\t\t\t\t\tif (commentNode)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (elementsNew.length > 0)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tcommentNode.classList.add('comment-block-rating-nonempty');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tcommentNode.classList.remove('comment-block-rating-nonempty');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tthis.drawReactions({\n\t\t\t\t\tlikeId: likeId,\n\t\t\t\t\tcontainer: reactionsContainer,\n\t\t\t\t\tdata: elementsNew,\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tif (\n\t\t\tuserId === currentUserId\n\t\t\t&& buttonText\n\t\t)\n\t\t{\n\t\t\tif ([ 'add', 'change' ].includes(action))\n\t\t\t{\n\t\t\t\tbuttonText.innerHTML = Loc.getMessage(`RATING_LIKE_EMOTION_${userReaction.toUpperCase()}_CALC`);\n\t\t\t\tif (RatingManager.mobile)\n\t\t\t\t{\n\t\t\t\t\tbuttonText.parentElement.className = '';\n\t\t\t\t\tbuttonText.parentElement.classList.add(\n\t\t\t\t\t\t'bx-ilike-left-wrap',\n\t\t\t\t\t\t'bx-you-like-button',\n\t\t\t\t\t\t`bx-you-like-button-${userReaction.toLowerCase()}`\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tbuttonText.innerHTML = Loc.getMessage('RATING_LIKE_EMOTION_LIKE_CALC');\n\t\t\t\tif (RatingManager.mobile)\n\t\t\t\t{\n\t\t\t\t\tbuttonText.parentElement.className = 'bx-ilike-left-wrap';\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic drawReactions(params)\n\t{\n\t\tconst container = (Type.isDomNode(params.container) ? params.container : null);\n\t\tconst data = (Type.isArray(params.data) ? params.data : []);\n\t\tconst likeId = (Type.isStringFilled(params.likeId) ? params.likeId : '')\n\t\tif (\n\t\t\t!container\n\t\t\t|| !Type.isStringFilled(likeId)\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst reactionEvents = (\n\t\t\tRatingManager.mobile\n\t\t\t\t? {}\n\t\t\t\t: {\n\t\t\t\t\tclick: this.resultReactionClick.bind(this),\n\t\t\t\t\tmouseenter: this.resultReactionMouseEnter.bind(this),\n\t\t\t\t\tmouseleave: this.resultReactionMouseLeave.bind(this),\n\t\t\t\t}\n\t\t);\n\n\t\tDom.clean(container);\n\n\t\tconst reactionsData = {};\n\n\t\tdata.forEach((element, i) => {\n\n\t\t\tconst classList = [\n\t\t\t\t'feed-post-emoji-icon-item',\n\t\t\t\t`feed-post-emoji-icon-${element.reaction}`,\n\t\t\t\t`feed-post-emoji-icon-item-${(i+1)}`,\n\t\t\t];\n\n\t\t\tif (element.animate)\n\t\t\t{\n\t\t\t\tif (i >= 1)\n\t\t\t\t{\n\t\t\t\t\tclassList.push('feed-post-emoji-icon-animate');\n\t\t\t\t}\n\t\t\t\telse if (data.length == 1)\n\t\t\t\t{\n\t\t\t\t\tclassList.push('feed-post-emoji-animation-pop');\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tcontainer.appendChild(Dom.create('span', {\n\t\t\t\tprops: {\n\t\t\t\t\tid: `bx-ilike-result-reaction-${element.reaction}-${likeId}`,\n\t\t\t\t\tclassName: classList.join(' '),\n\t\t\t\t},\n\t\t\t\tattrs: {\n\t\t\t\t\t'data-reaction': element.reaction,\n\t\t\t\t\t'data-value': element.count,\n\t\t\t\t\t'data-like-id': likeId,\n\t\t\t\t\ttitle: Loc.getMessage(`RATING_LIKE_EMOTION_${element.reaction.toUpperCase()}_CALC`),\n\t\t\t\t},\n\t\t\t\tevents: reactionEvents,\n\t\t\t}));\n\n\t\t\treactionsData[element.reaction] = element.count;\n\t\t});\n\n\t\tcontainer.setAttribute('data-reactions-data', JSON.stringify(reactionsData));\n\t}\n\n\tstatic showReactionsPopup(params)\n\t{\n\t\tconst bindElement = this.getNode(params.bindElement);\n\t\tconst likeId = (Type.isStringFilled(params.likeId) ? params.likeId : '');\n\n\t\tif (\n\t\t\t!bindElement\n\t\t\t|| !Type.isStringFilled(likeId)\n\t\t)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.reactionsPopupLikeId = likeId;\n\n\t\tif (this.reactionsPopup === null)\n\t\t{\n\t\t\tconst reactionsNodesList = [];\n\n\t\t\tthis.reactionsList.forEach((currentEmotion) => {\n\n\t\t\t\treactionsNodesList.push(Dom.create('div', {\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tclassName: `feed-post-emoji-icon-item feed-post-emoji-icon-${currentEmotion}`,\n\t\t\t\t\t},\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\t'data-reaction': currentEmotion,\n\t\t\t\t\t\ttitle: Loc.getMessage(`RATING_LIKE_EMOTION_${currentEmotion.toUpperCase()}_CALC`),\n\t\t\t\t\t},\n\t\t\t\t}));\n\t\t\t});\n\n\t\t\tthis.reactionsPopup = Dom.create('div', {\n\t\t\t\tprops: {\n\t\t\t\t\tclassName: `feed-post-emoji-popup-container ${(RatingManager.mobile ? '--mobile' : '')}`,\n\t\t\t\t},\n\t\t\t\tchildren: [\n\t\t\t\t\tDom.create('div', {\n\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\tclassName: 'feed-post-emoji-icon-inner',\n\t\t\t\t\t\t},\n\t\t\t\t\t\tchildren: reactionsNodesList,\n\t\t\t\t\t})\n\t\t\t\t],\n\t\t\t});\n\n\t\t\tthis.reactionsPopup.addEventListener((RatingManager.mobile ? 'touchend' : 'click'), (e) => {\n\n\t\t\t\tconst reactionNode = (\n\t\t\t\t\t(e.target.classList.contains('feed-post-emoji-icon-item'))\n\t\t\t\t\t\t? e.target\n\t\t\t\t\t\t: e.target.closest('.feed-post-emoji-icon-item')\n\t\t\t\t);\n\n\t\t\t\tif (reactionNode)\n\t\t\t\t{\n\t\t\t\t\tRatingLike.ClickVote(\n\t\t\t\t\t\te,\n\t\t\t\t\t\tthis.reactionsPopupLikeId,\n\t\t\t\t\t\treactionNode.getAttribute('data-reaction'),\n\t\t\t\t\t\ttrue\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\te.preventDefault();\n\t\t\t});\n\n\t\t\tDom.append(this.reactionsPopup, document.body);\n\t\t}\n\t\telse if (this.reactionsPopup.classList.contains('feed-post-emoji-popup-invisible'))\n\t\t{\n\t\t\tthis.reactionsPopup.classList.remove('feed-post-emoji-popup-invisible');\n\t\t}\n\t\telse if (\n\t\t\tRatingManager.mobile\n\t\t\t&& this.reactionsPopup.classList.contains('feed-post-emoji-popup-invisible-final-mobile')\n\t\t)\n\t\t{\n\t\t\tthis.reactionsPopup.classList.remove('feed-post-emoji-popup-invisible-final-mobile');\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.reactionsPopupMouseOutHandler = this.getReactionsPopupMouseOutHandler(likeId);\n\n\t\tconst bindElementPosition = pos(bindElement);\n\n\t\tif (\n\t\t\tbindElement.closest('.feed-com-informers-bottom')\n\t\t\t&& bindElement.closest('.iframe-comments-cont, .task-iframe-popup')\n\t\t)\n\t\t{\n\t\t\tbindElementPosition.left += 100;\n\t\t}\n\n\t\tconst inverted = ((bindElementPosition.top - GetWindowSize().scrollTop) < 80);\n\t\tconst deltaY = (inverted ? 15 : -45);\n\n\t\tif (inverted)\n\t\t{\n\t\t\tthis.reactionsPopup.classList.add('feed-post-emoji-popup-inverted');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.reactionsPopup.classList.remove('feed-post-emoji-popup-inverted');\n\t\t}\n\n\t\tconst likeInstance = RatingLike.getInstance(likeId);\n\n\t\tif (RatingManager.mobile)\n\t\t{\n\t\t\tthis.touchMoveDeltaY = (inverted ? 60 : -45);\n\t\t\tDom.adjust(this.reactionsPopup, {\n\t\t\t\tstyle: {\n\t\t\t\t\tleft: '12px',\n\t\t\t\t\ttop: ((inverted ? (bindElementPosition.top - 23) : (bindElementPosition.top - 28)) + deltaY) + 'px',\n\t\t\t\t\twidth: '330px',\n\t\t\t\t\tborderRadius: '61px',\n\t\t\t\t},\n\t\t\t});\n\n\t\t\tthis.reactionsPopup.classList.remove('feed-post-emoji-popup-invisible-final');\n\t\t\tthis.reactionsPopup.classList.add('feed-post-emoji-popup-active-final');\n\t\t\tthis.reactionsPopup.classList.add('feed-post-emoji-popup-active-final-item');\n\t\t\tlikeInstance.box.classList.add('feed-post-emoji-control-active');\n\t\t\tthis.reactionsPopupMobileDisableScroll();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.reactionsPopupAnimation = new BX.easing({\n\t\t\t\tduration: 300,\n\t\t\t\tstart: {\n\t\t\t\t\twidth: 100,\n\t\t\t\t\tleft: (bindElementPosition.left + (bindElementPosition.width / 2) - 50),\n\t\t\t\t\ttop: ((inverted ? bindElementPosition.top - 30 : bindElementPosition.top + 30 ) + deltaY),\n\t\t\t\t\tborderRadius: 0,\n\t\t\t\t\topacity: 0,\n\t\t\t\t},\n\t\t\t\tfinish: {\n\t\t\t\t\twidth: 305,\n\t\t\t\t\tleft: (bindElementPosition.left + (bindElementPosition.width / 2) - 133),\n\t\t\t\t\ttop: (bindElementPosition.top + deltaY - 5),\n\t\t\t\t\tborderRadius: 50,\n\t\t\t\t\topacity: 100,\n\t\t\t\t},\n\t\t\t\ttransition : BX.easing.makeEaseInOut(BX.easing.transitions.cubic),\n\t\t\t\tstep: (state) => {\n\t\t\t\t\tthis.reactionsPopup.style.width = `${state.width}px`;\n\t\t\t\t\tthis.reactionsPopup.style.left = `${state.left}px`;\n\t\t\t\t\tthis.reactionsPopup.style.top = `${state.top}px`;\n\t\t\t\t\tthis.reactionsPopup.style.borderRadius = `${state.borderRadius}px`;\n\t\t\t\t\tthis.reactionsPopup.style.opacity = state.opacity / 100;\n\t\t\t\t\tthis.reactionsPopupOpacityState = state.opacity;\n\t\t\t\t},\n\t\t\t\tcomplete: () => {\n\t\t\t\t\tthis.reactionsPopup.style.opacity = '';\n\t\t\t\t\tthis.reactionsPopup.classList.add('feed-post-emoji-popup-active-final');\n\t\t\t\t\tlikeInstance.box.classList.add('feed-post-emoji-control-active');\n\t\t\t\t},\n\t\t\t});\n\t\t\tthis.reactionsPopupAnimation.animate();\n\n\t\t\tsetTimeout(() => {\n\n\t\t\t\tconst reactions = this.reactionsPopup.querySelectorAll('.feed-post-emoji-icon-item');\n\n\t\t\t\tthis.reactionsPopupAnimation2 = new BX.easing({\n\t\t\t\t\tduration: 140,\n\t\t\t\t\tstart: {\n\t\t\t\t\t\topacity: 0,\n\t\t\t\t\t},\n\t\t\t\t\tfinish: {\n\t\t\t\t\t\topacity: 100\n\t\t\t\t\t},\n\t\t\t\t\ttransition : BX.easing.transitions.cubic,\n\t\t\t\t\tstep: (state) => {\n\t\t\t\t\t\treactions[0].style.opacity = state.opacity / 100;\n\t\t\t\t\t\treactions[1].style.opacity = state.opacity / 100;\n\t\t\t\t\t\treactions[2].style.opacity = state.opacity / 100;\n\t\t\t\t\t\treactions[3].style.opacity = state.opacity / 100;\n\t\t\t\t\t\treactions[4].style.opacity = state.opacity / 100;\n\t\t\t\t\t\treactions[5].style.opacity = state.opacity / 100;\n\t\t\t\t\t\treactions[6].style.opacity = state.opacity / 100;\n\t\t\t\t\t},\n\t\t\t\t\tcomplete: () => {\n\t\t\t\t\t\tthis.reactionsPopup.classList.add('feed-post-emoji-popup-active-final-item');\n\t\t\t\t\t\treactions[0].style.opacity = '';\n\t\t\t\t\t\treactions[1].style.opacity = '';\n\t\t\t\t\t\treactions[2].style.opacity = '';\n\t\t\t\t\t\treactions[3].style.opacity = '';\n\t\t\t\t\t\treactions[4].style.opacity = '';\n\t\t\t\t\t\treactions[5].style.opacity = '';\n\t\t\t\t\t\treactions[6].style.opacity = '';\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t\tthis.reactionsPopupAnimation2.animate();\n\t\t\t}, 100);\n\t\t}\n\n\t\tif (!this.reactionsPopup.classList.contains('feed-post-emoji-popup-active'))\n\t\t{\n\t\t\tthis.reactionsPopup.classList.add('feed-post-emoji-popup-active');\n\t\t}\n\n\t\tif (!RatingManager.mobile)\n\t\t{\n\t\t\tdocument.addEventListener('mousemove', this.reactionsPopupMouseOutHandler);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.touchScrollTop = GetWindowSize().scrollTop;\n\t\t\tthis.hasMobileTouchMoved = null;\n\n\t\t\twindow.addEventListener('touchend', this.reactionsPopupMobileTouchEndHandler);\n\t\t\twindow.addEventListener('touchmove', this.reactionsPopupMobileTouchMoveHandler);\n\t\t}\n\t}\n\n\tstatic reactionsPopupMobileTouchEnd(e)\n\t{\n\t\tconst coords = {\n\t\t\tx: e.changedTouches[0].pageX, // e.touches[0].clientX + window.pageXOffset\n\t\t\ty: e.changedTouches[0].pageY, // e.touches[0].clientY + window.pageYOffset\n\t\t};\n\n\t\tif (this.hasMobileTouchMoved === true)\n\t\t{\n\t\t\tlet userReaction = null;\n\t\t\tconst reactionNode = this.reactionsPopupMobileGetHoverNode(coords.x, coords.y);\n\n\t\t\tif (\n\t\t\t\treactionNode\n\t\t\t\t&& (userReaction = reactionNode.getAttribute('data-reaction'))\n\t\t\t)\n\t\t\t{\n\t\t\t\tRatingLike.ClickVote(\n\t\t\t\t\te,\n\t\t\t\t\tthis.reactionsPopupLikeId,\n\t\t\t\t\tuserReaction,\n\t\t\t\t\ttrue\n\t\t\t\t);\n\t\t\t}\n\t\t\tthis.reactionsPopupMobileHideHandler();\n\t\t}\n\t\telse // show reactions popup and handle clicks\n\t\t{\n\t\t\twindow.addEventListener('touchend', this.reactionsPopupMobileHideHandler);\n\t\t}\n\n\t\twindow.removeEventListener('touchend', this.reactionsPopupMobileTouchEndHandler);\n\t\twindow.removeEventListener('touchmove', this.reactionsPopupMobileTouchMoveHandler);\n\n\t\tthis.touchStartPosition = null;\n\t\te.preventDefault();\n\t}\n\n\tstatic reactionsPopupMobileTouchMove(e)\n\t{\n\t\tconst coords = {\n\t\t\tx: e.touches[0].pageX, // e.touches[0].clientX + window.pageXOffset\n\t\t\ty: e.touches[0].pageY, // e.touches[0].clientY + window.pageYOffset\n\t\t};\n\n\n\t\tthis.touchCurrentPosition = {\n\t\t\tx: coords.x,\n\t\t\ty: coords.y,\n\t\t};\n\n\t\tif (this.touchStartPosition === null)\n\t\t{\n\t\t\tthis.touchStartPosition = {\n\t\t\t\tx: coords.x,\n\t\t\t\ty: coords.y,\n\t\t\t};\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (this.hasMobileTouchMoved !== true)\n\t\t\t{\n\t\t\t\tthis.hasMobileTouchMoved = !this.reactionsPopupMobileCheckTouchMove();\n\t\t\t}\n\t\t}\n\n\t\tif (this.hasMobileTouchMoved === true)\n\t\t{\n\t\t\tconst reactionNode = this.reactionsPopupMobileGetHoverNode(coords.x, coords.y);\n\t\t\tif (reactionNode)\n\t\t\t{\n\t\t\t\tif (\n\t\t\t\t\tthis.currentReactionNodeHover\n\t\t\t\t\t&& this.currentReactionNodeHover !== reactionNode\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tthis.reactionsPopupMobileRemoveHover(this.currentReactionNodeHover);\n\t\t\t\t}\n\t\t\t\tthis.reactionsPopupMobileAddHover(reactionNode);\n\t\t\t\tthis.currentReactionNodeHover = reactionNode;\n\t\t\t}\n\t\t\telse if (this.currentReactionNodeHover)\n\t\t\t{\n\t\t\t\tthis.reactionsPopupMobileRemoveHover(this.currentReactionNodeHover);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (this.currentReactionNodeHover)\n\t\t\t{\n\t\t\t\tthis.reactionsPopupMobileRemoveHover(this.currentReactionNodeHover);\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic blockReactionsPopup()\n\t{\n\t\tif (this.blockShowPopupTimeout)\n\t\t{\n\t\t\twindow.clearTimeout(this.blockShowPopupTimeout);\n\t\t}\n\n\t\tthis.blockShowPopup = true;\n\t\tthis.blockShowPopupTimeout = setTimeout(() => {\n\t\t\tthis.blockShowPopup = false;\n\t\t}, 500);\n\t}\n\n\tstatic hideReactionsPopup(params)\n\t{\n\t\tconst likeId = (Type.isStringFilled(params.likeId) ? params.likeId : false);\n\n\t\tif (this.reactionsPopup)\n\t\t{\n\t\t\tif (RatingManager.mobile)\n\t\t\t{\n\t\t\t\tthis.reactionsPopup.classList.add('feed-post-emoji-popup-invisible-final');\n\t\t\t\tthis.reactionsPopup.classList.add('feed-post-emoji-popup-invisible-final-mobile');\n\t\t\t\tthis.reactionsPopup.classList.remove('feed-post-emoji-popup-active');\n\t\t\t\tthis.reactionsPopup.classList.remove('feed-post-emoji-popup-active-final');\n\t\t\t\tthis.reactionsPopup.classList.remove('feed-post-emoji-popup-active-final-item');\n\t\t\t\tthis.reactionsPopupMobileEnableScroll();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (this.reactionsPopupAnimation)\n\t\t\t\t{\n\t\t\t\t\tthis.reactionsPopupAnimation.stop();\n\t\t\t\t}\n\t\t\t\tif (this.reactionsPopupAnimation2)\n\t\t\t\t{\n\t\t\t\t\tthis.reactionsPopupAnimation2.stop();\n\t\t\t\t}\n\n\t\t\t\tthis.reactionsPopup.classList.add('feed-post-emoji-popup-invisible');\n\n\t\t\t\tthis.reactionsPopupAnimation4 = new BX.easing({\n\t\t\t\t\tduration: 500,\n\t\t\t\t\tstart: {\n\t\t\t\t\t\topacity: this.reactionsPopupOpacityState,\n\t\t\t\t\t},\n\t\t\t\t\tfinish: {\n\t\t\t\t\t\topacity: 0,\n\t\t\t\t\t},\n\t\t\t\t\ttransition: BX.easing.transitions.linear,\n\t\t\t\t\tstep: (state) => {\n\t\t\t\t\t\tthis.reactionsPopup.style.opacity = state.opacity / 100;\n\t\t\t\t\t\tthis.reactionsPopupOpacityState = state.opacity;\n\t\t\t\t\t},\n\t\t\t\t\tcomplete: () => {\n\t\t\t\t\t\tthis.reactionsPopup.style.opacity = '';\n\t\t\t\t\t\tthis.reactionsPopup.classList.add('feed-post-emoji-popup-invisible-final');\n\t\t\t\t\t\tthis.reactionsPopup.classList.remove('feed-post-emoji-popup-active');\n\t\t\t\t\t\tthis.reactionsPopup.classList.remove('feed-post-emoji-popup-active-final');\n\t\t\t\t\t\tthis.reactionsPopup.classList.remove('feed-post-emoji-popup-active-final-item');\n\t\t\t\t\t},\n\t\t\t\t});\n\n\t\t\t\tthis.reactionsPopupAnimation4.animate();\n\t\t\t}\n\n\t\t\tthis.reactionsPopupLikeId = null;\n\n\t\t\tif (likeId)\n\t\t\t{\n\t\t\t\tRatingLike.getInstance(likeId).box.classList.remove('feed-post-emoji-control-active');\n\t\t\t}\n\t\t}\n\n\t\tthis.reactionsPopupMobileRemoveHover(this.currentReactionNodeHover);\n\n\t\tif (likeId)\n\t\t{\n\t\t\tthis.bindReactionsPopup({\n\t\t\t\tlikeId: likeId,\n\t\t\t});\n\t\t}\n\t}\n\n\tstatic reactionsPopupMobileCheckTouchMove()\n\t{\n\t\tif (this.touchStartPosition === null)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (\n\t\t\t\tMath.abs(this.touchCurrentPosition.x - this.touchStartPosition.x) > 5\n\t\t\t\t|| Math.abs(this.touchCurrentPosition.y - this.touchStartPosition.y) > 5\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tstatic reactionsPopupMobileHide(e)\n\t{\n\t\twindow.removeEventListener('touchend', this.reactionsPopupMobileHideHandler);\n\t\tif (this.reactionsPopupLikeId)\n\t\t{\n\t\t\tthis.hideReactionsPopup({\n\t\t\t\tlikeId: this.reactionsPopupLikeId,\n\t\t\t});\n\n\t\t\tif (e)\n\t\t\t{\n\t\t\t\te.preventDefault();\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic reactionsPopupMobileGetHoverNode(x, y)\n\t{\n\t\tlet reactionNode = null;\n\t\tlet userReaction = null;\n\t\tlet result = null;\n\n\t\tif (\n\t\t\t(\n\t\t\t\t(reactionNode = document.elementFromPoint(x, (y + this.touchMoveDeltaY - this.touchScrollTop))) // icon above/below a finger\n\t\t\t\t|| (reactionNode = document.elementFromPoint(x, (y - this.touchScrollTop))) // icon is under a finger\n\t\t\t)\n\t\t\t&& (userReaction = reactionNode.getAttribute('data-reaction'))\n\t\t\t&& Type.isStringFilled(userReaction)\n\t\t)\n\t\t{\n\t\t\tresult = reactionNode;\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tstatic reactionsPopupMobileAddHover(reactionNode)\n\t{\n\t\tif (!reactionNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\treactionNode.classList.add('feed-post-emoji-icon-item-hover');\n\t}\n\n\tstatic reactionsPopupMobileRemoveHover(reactionNode)\n\t{\n\t\tif (!reactionNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\treactionNode.classList.remove('feed-post-emoji-icon-item-hover');\n\t}\n\n\tstatic reactionsPopupMobileEnableScroll()\n\t{\n\t\tdocument.removeEventListener('touchmove', this.touchMoveScrollListener, { passive: false });\n\t\tEventEmitter.emit('onPullDownEnable');\n\n\t\tif (this.mobileOverlay !== null)\n\t\t{\n\t\t\tDom.clean(this.mobileOverlay);\n\t\t\tDom.remove(this.mobileOverlay);\n\n\t\t\tthis.mobileOverlay = null;\n\t\t}\n\t}\n\n\tstatic reactionsPopupMobileDisableScroll()\n\t{\n\t\tdocument.addEventListener('touchmove', this.touchMoveScrollListener.bind(this), { passive: false });\n\t\tEventEmitter.emit('onPullDownDisable');\n\n\t\tif (!Type.isNull(this.mobileOverlay))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.mobileOverlay = Dom.create('DIV', {\n\t\t\tprops: {\n\t\t\t\tclassName: 'feed-post-emoji-popup-mobile-overlay',\n\t\t\t},\n\t\t});\n\t\tsetTimeout(() => {\n\t\t\tif (Type.isNull(this.mobileOverlay))\n\t\t\t{\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\tDom.append(this.mobileOverlay, document.body);\n\t\t}, 1000); // to avoid blink\n\t}\n\n\tstatic bindReactionsPopup(params) {\n\n\t\tif (RatingManager.mobile)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst likeId = (Type.isStringFilled(params.likeId) ? params.likeId : '');\n\n\t\tif (!Type.isStringFilled(likeId))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst likeInstance = RatingLike.getInstance(likeId);\n\t\tif (!likeInstance)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tlikeInstance.mouseOverHandler = Runtime.debounce(this.getMouseOverHandler(likeId), 500);\n\n\t\tlikeInstance.box.addEventListener('mouseenter', likeInstance.mouseOverHandler);\n\t\tlikeInstance.box.addEventListener('mouseleave', this.blockReactionsPopup);\n\t}\n\n\tstatic touchMoveScrollListener(e)\n\t{\n\t\te.preventDefault();\n\t}\n\n\tstatic getReactionsPopupMouseOutHandler(likeId)\n\t{\n\t\treturn (e) => {\n\n\t\t\tconst popupPosition = this.reactionsPopup.getBoundingClientRect();\n\t\t\tconst inverted = this.reactionsPopup.classList.contains('feed-post-emoji-popup-inverted');\n\n\t\t\tif (\n\t\t\t\te.clientX >= popupPosition.left\n\t\t\t\t&& e.clientX <= popupPosition.right\n\t\t\t\t&& e.clientY >= popupPosition.top - (inverted ? 25 : 0)\n\t\t\t\t&& e.clientY <= (popupPosition.bottom + (inverted ? 0 : 25))\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.blockReactionsPopup();\n\t\t\tthis.hideReactionsPopup({\n\t\t\t\tlikeId: likeId\n\t\t\t});\n\n\t\t\tdocument.removeEventListener('mousemove', this.reactionsPopupMouseOutHandler)\n\t\t\tthis.reactionsPopupMouseOutHandler = null;\n\t\t};\n\t}\n\n\tstatic getMouseOverHandler(likeId)\n\t{\n\t\treturn () => {\n\n\t\t\tconst likeInstance = RatingLike.getInstance(likeId);\n\n\t\t\tif (!this.afterClickBlockShowPopup)\n\t\t\t{\n\t\t\t\tif (this.blockShowPopup)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (RatingManager.mobile)\n\t\t\t\t{\n\t\t\t\t\tapp.exec('callVibration');\n\t\t\t\t}\n\n\t\t\t\tthis.showReactionsPopup({\n\t\t\t\t\tbindElement: likeInstance.box,\n\t\t\t\t\tlikeId: likeId,\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tlikeInstance.box.removeEventListener('mouseenter', likeInstance.mouseOverHandler);\n\t\t\tlikeInstance.box.removeEventListener('mouseleave', this.blockReactionsPopup.bind(this));\n\t\t};\n\t}\n\n\tstatic buildPopupContent(params)\n\t{\n\t\tconst clear = (params.clear ? Boolean(params.clear) : false);\n\t\tconst likeId = (Type.isStringFilled(params.likeId) ? params.likeId : '');\n\t\tconst rating = params.rating;\n\t\tconst requestReaction = (Type.isStringFilled(params.reaction) ? params.reaction : '');\n\t\tconst page = (Number(params.page) > 0 ? Number(params.page) : 1);\n\t\tconst data = params.data;\n\t\tconst reaction = false;\n\n\t\tconst reactionsList = [];\n\t\tlet reactionsCount = 0;\n\n\t\tif (\n\t\t\tclear\n\t\t\t&& page === 1\n\t\t)\n\t\t{\n\t\t\tthis.clearPopupContent({\n\t\t\t\tlikeId: likeId,\n\t\t\t});\n\t\t}\n\n\t\tthis.popupCurrentReaction = (Type.isStringFilled(requestReaction) ? requestReaction : 'all');\n\n\t\tif (\n\t\t\trequestReaction.length <= 0\n\t\t\t|| requestReaction == 'all'\n\t\t) // first current tab\n\t\t{\n\t\t\tthis.popupSizeInitialized = false;\n\t\t\tdocument.getElementById(`bx-ilike-popup-cont-${likeId}`).style.height = 'auto';\n\t\t\tdocument.getElementById(`bx-ilike-popup-cont-${likeId}`).style.minWidth = 'auto';\n\t\t}\n\n\t\tif (!Type.isStringFilled(requestReaction))\n\t\t{\n\t\t\tthis.popupPagesList = {};\n\t\t}\n\n\t\tthis.popupPagesList[(requestReaction == '' ? 'all' : requestReaction)] = (page + 1);\n\n\t\tif (Type.isPlainObject(data.reactions))\n\t\t{\n\t\t\tObject.entries(data.reactions).forEach(([ reaction, count ]) => {\n\t\t\t\tif (Number(count) <= 0)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\treactionsList.push({\n\t\t\t\t\treaction: reaction,\n\t\t\t\t\tcount: Number(count)\n\t\t\t\t});\n\t\t\t\treactionsCount++;\n\t\t\t});\n\t\t}\n\n\t\tconst tabsNode = Dom.create('span', {\n\t\t\tprops: {\n\t\t\t\tclassName: 'bx-ilike-popup-head',\n\t\t\t},\n\t\t});\n\n\t\tif (reactionsCount > 1)\n\t\t{\n\t\t\tconst headClassList = [ 'bx-ilike-popup-head-item' ];\n\t\t\tif (!Type.isStringFilled(requestReaction) || requestReaction == 'all')\n\t\t\t{\n\t\t\t\theadClassList.push('bx-ilike-popup-head-item-current');\n\t\t\t}\n\n\t\t\ttabsNode.appendChild(Dom.create('span', {\n\t\t\t\tprops: {\n\t\t\t\t\tclassName: headClassList.join(' '),\n\t\t\t\t},\n\t\t\t\tchildren: [\n\t\t\t\t\tDom.create('span', {\n\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\tclassName: 'bx-ilike-popup-head-icon feed-post-emoji-icon-all',\n\t\t\t\t\t\t},\n\t\t\t\t\t}),\n\t\t\t\t\tDom.create('span', {\n\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\tclassName: 'bx-ilike-popup-head-text',\n\t\t\t\t\t\t},\n\t\t\t\t\t\thtml: Loc.getMessage('RATING_LIKE_POPUP_ALL').replace('#CNT#', Number(data.items_all)),\n\t\t\t\t\t})\n\t\t\t\t],\n\t\t\t\tevents: {\n\t\t\t\t\tclick: ((e) => {\n\t\t\t\t\t\tthis.changePopupTab({\n\t\t\t\t\t\t\tlikeId: likeId,\n\t\t\t\t\t\t\trating: rating,\n\t\t\t\t\t\t\treaction: 'all',\n\t\t\t\t\t\t});\n\t\t\t\t\t\te. preventDefault();\n\t\t\t\t\t}),\n\t\t\t\t},\n\t\t\t}));\n\t\t}\n\n\t\tif (reactionsCount === 0)\n\t\t{\n\t\t\treactionsList.push({\n\t\t\t\treaction: Loc.getMessage('RATING_LIKE_REACTION_DEFAULT'),\n\t\t\t\tcount: Number(data.items_all),\n\t\t\t});\n\t\t}\n\n\t\treactionsList.sort((a, b) => {\n\t\t\tconst sample = {\n\t\t\t\tlike: 0,\n\t\t\t\tkiss: 1,\n\t\t\t\tlaugh: 2,\n\t\t\t\twonder: 3,\n\t\t\t\tcry: 4,\n\t\t\t\tangry: 5,\n\t\t\t\tfacepalm: 6,\n\t\t\t};\n\t\t\tif (sample[a.reaction] < sample[b.reaction])\n\t\t\t{\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t\tif (sample[a.reaction] > sample[b.reaction])\n\t\t\t{\n\t\t\t\treturn 1;\n\t\t\t}\n\t\t\treturn 0;\n\t\t});\n\n\t\treactionsList.forEach((reactionData) => {\n\n\t\t\tconst headItemClassList = [ 'bx-ilike-popup-head-item' ];\n\t\t\tif (requestReaction === reactionData.reaction)\n\t\t\t{\n\t\t\t\theadItemClassList.push('bx-ilike-popup-head-item-current');\n\t\t\t}\n\n\t\t\ttabsNode.appendChild(Dom.create('span', {\n\t\t\t\tprops: {\n\t\t\t\t\tclassName: headItemClassList.join(' '),\n\t\t\t\t},\n\t\t\t\tattrs: {\n\t\t\t\t\ttitle: Loc.getMessage(`RATING_LIKE_EMOTION_${reactionData.reaction.toUpperCase()}_CALC`),\n\t\t\t\t},\n\t\t\t\tchildren: [\n\t\t\t\t\tDom.create('span', {\n\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\tclassName: [\n\t\t\t\t\t\t\t\t'bx-ilike-popup-head-icon',\n\t\t\t\t\t\t\t\t'feed-post-emoji-icon-item',\n\t\t\t\t\t\t\t\t`feed-post-emoji-icon-${reactionData.reaction}`,\n\t\t\t\t\t\t\t].join(' '),\n\t\t\t\t\t\t}\n\t\t\t\t\t}),\n\t\t\t\t\tDom.create('span', {\n\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\tclassName: 'bx-ilike-popup-head-text',\n\t\t\t\t\t\t},\n\t\t\t\t\t\thtml: reactionData.count,\n\t\t\t\t\t})\n\t\t\t\t],\n\t\t\t\tevents: {\n\t\t\t\t\tclick: (e) => {\n\n\t\t\t\t\t\tconst popupContent = document.getElementById(`bx-ilike-popup-cont-${likeId}`);\n\t\t\t\t\t\tconst popupContentPosition = popupContent.getBoundingClientRect();\n\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\trequestReaction.length <= 0\n\t\t\t\t\t\t\t|| requestReaction === 'all'\n\t\t\t\t\t\t) // first current tab\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.popupSizeInitialized = true;\n\t\t\t\t\t\t\tpopupContent.style.height = `${popupContentPosition.height}px`;\n\t\t\t\t\t\t\tpopupContent.style.minWidth = `${popupContentPosition.width}px`;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (popupContentPosition.width > Number(popupContent.style.minWidth))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tpopupContent.style.minWidth = `${popupContentPosition.width}px`;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis.changePopupTab({\n\t\t\t\t\t\t\tlikeId: likeId,\n\t\t\t\t\t\t\trating: rating,\n\t\t\t\t\t\t\treaction: reactionData.reaction,\n\t\t\t\t\t\t});\n\t\t\t\t\t\te. preventDefault();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t}));\n\t\t});\n\n\t\tlet usersNode = rating.popupContent.querySelector('.bx-ilike-popup-content-container');\n\t\tlet usersNodeExists = false;\n\n\t\tif (!usersNode)\n\t\t{\n\t\t\tusersNode = Dom.create('span', {\n\t\t\t\tprops: {\n\t\t\t\t\tclassName: 'bx-ilike-popup-content-container',\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tusersNodeExists = true;\n\t\t}\n\n\t\tusersNode.querySelectorAll('.bx-ilike-popup-content').forEach((contentNode) => {\n\t\t\tcontentNode.classList.add('bx-ilike-popup-content-invisible');\n\t\t});\n\n\t\tlet reactionUsersNode = usersNode.querySelector(`.bx-ilike-popup-content-${this.popupCurrentReaction}`);\n\t\tif (!reactionUsersNode)\n\t\t{\n\t\t\treactionUsersNode = Dom.create('span', {\n\t\t\t\tprops: {\n\t\t\t\t\tclassName: [\n\t\t\t\t\t\t'bx-ilike-popup-content',\n\t\t\t\t\t\t`bx-ilike-popup-content-${this.popupCurrentReaction}`,\n\t\t\t\t\t].join(' '),\n\t\t\t\t}\n\t\t\t});\n\t\t\tusersNode.appendChild(reactionUsersNode);\n\t\t}\n\t\telse\n\t\t{\n\t\t\treactionUsersNode.classList.remove('bx-ilike-popup-content-invisible');\n\t\t}\n\n\t\tdata.items.forEach((item) => {\n\n\t\t\tconst userItemClassList = [ 'bx-ilike-popup-user-item' ];\n\t\t\tif (Type.isStringFilled(item.USER_TYPE))\n\t\t\t{\n\t\t\t\tuserItemClassList.push(`bx-ilike-popup-user-item-${item.USER_TYPE}`);\n\t\t\t}\n\n\t\t\treactionUsersNode.appendChild(Dom.create('a', {\n\t\t\t\tprops: {\n\t\t\t\t\tclassName: userItemClassList.join(' '),\n\t\t\t\t},\n\t\t\t\tattrs: {\n\t\t\t\t\thref: item.URL,\n\t\t\t\t\ttarget: '_blank',\n\t\t\t\t},\n\t\t\t\tchildren: [\n\t\t\t\t\tDom.create('span', {\n\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\tclassName: 'bx-ilike-popup-user-icon',\n\t\t\t\t\t\t},\n\t\t\t\t\t\tstyle: (\n\t\t\t\t\t\t\tType.isStringFilled(item.PHOTO_SRC)\n\t\t\t\t\t\t\t\t? {\n\t\t\t\t\t\t\t\t\t'background-image': `url(\"${item.PHOTO_SRC}\")`,\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t: {}\n\t\t\t\t\t\t)\n\t\t\t\t\t}),\n\t\t\t\t\tDom.create('span', {\n\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\tclassName: 'bx-ilike-popup-user-name'\n\t\t\t\t\t\t},\n\t\t\t\t\t\thtml: item.FULL_NAME,\n\t\t\t\t\t}),\n\t\t\t\t\tDom.create('span', {\n\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\tclassName: 'bx-ilike-popup-user-status',\n\t\t\t\t\t\t},\n\t\t\t\t\t}),\n\t\t\t\t],\n\t\t\t}));\n\t\t});\n\n\n\t\tconst waitNode = rating.popupContent.querySelector('.bx-ilike-wait');\n\t\tif (waitNode)\n\t\t{\n\t\t\tDom.clean(waitNode);\n\t\t\tDom.remove(waitNode);\n\t\t}\n\t\tconst tabsNodeOld = rating.popupContent.querySelector('.bx-ilike-popup-head');\n\t\tif (tabsNodeOld)\n\t\t{\n\t\t\ttabsNodeOld.parentNode.insertBefore(tabsNode, tabsNodeOld);\n\t\t\ttabsNodeOld.parentNode.removeChild(tabsNodeOld);\n\t\t}\n\t\telse\n\t\t{\n\t\t\trating.popupContent.appendChild(tabsNode);\n\t\t}\n\n\t\tif (!usersNodeExists)\n\t\t{\n\t\t\trating.popupContent.appendChild(usersNode);\n\t\t}\n\t}\n\n\tstatic clearPopupContent(params)\n\t{\n\t\tconst likeId = (Type.isStringFilled(params.likeId) ? params.likeId : '');\n\n\t\tconst likeInstance = RatingLike.getInstance(likeId);\n\t\tlikeInstance.popupContent.innerHTML = '';\n\t\tdocument.getElementById(`bx-ilike-popup-cont-${likeId}`).style.height = 'auto';\n\t\tdocument.getElementById(`bx-ilike-popup-cont-${likeId}`).style.minWidth = 'auto';\n\t\tlikeInstance.popupContent.appendChild(Dom.create('span', {\n\t\t\tprops: {\n\t\t\t\tclassName: 'bx-ilike-wait',\n\t\t\t},\n\t\t}));\n\t}\n\n\tstatic changePopupTab(params)\n\t{\n\t\tconst likeId = (Type.isStringFilled(params.likeId) ? params.likeId : '');\n\t\tconst rating = params.rating;\n\t\tconst reaction = (Type.isStringFilled(params.reaction) ? params.reaction : '');\n\n\t\tconst contentContainerNode = rating.popupContent.querySelector('.bx-ilike-popup-content-container');\n\t\tif (!contentContainerNode)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst reactionUsersNode = contentContainerNode.querySelector('.bx-ilike-popup-content-' + reaction);\n\t\tif (reactionUsersNode)\n\t\t{\n\t\t\tthis.popupCurrentReaction = (Type.isStringFilled(reaction) ? reaction : 'all');\n\n\t\t\trating.popupContent.querySelectorAll('.bx-ilike-popup-head-item').forEach((tabNode) => {\n\t\t\t\ttabNode.classList.remove('bx-ilike-popup-head-item-current');\n\t\t\t\tconst reactionTabNode = tabNode.querySelector(`.feed-post-emoji-icon-${reaction}`);\n\t\t\t\tif (reactionTabNode)\n\t\t\t\t{\n\t\t\t\t\ttabNode.classList.add('bx-ilike-popup-head-item-current');\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tcontentContainerNode.querySelectorAll('.bx-ilike-popup-content').forEach((contentNode) => {\n\t\t\t\tcontentNode.classList.add('bx-ilike-popup-content-invisible');\n\t\t\t});\n\t\t\treactionUsersNode.classList.remove('bx-ilike-popup-content-invisible');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tListPopup.List(likeId, 1, reaction);\n\t\t}\n\t}\n\n\tstatic buildPopupContentNoReactions(params)\n\t{\n\t\tconst page = (Number(params.page) > 0 ? Number(params.page) : 1);\n\t\tconst likeInstance = (!Type.isUndefined(params.rating) ? params.rating : null);\n\t\tconst data = params.data;\n\n\t\tif (!likeInstance)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tif (page === 1)\n\t\t{\n\t\t\tlikeInstance.popupContent.innerHTML = '';\n\t\t\tlikeInstance.popupContent.appendChild(Dom.create('span', {\n\t\t\t\tprops: {\n\t\t\t\t\tclassName: 'bx-ilike-bottom_scroll',\n\t\t\t\t}\n\t\t\t}));\n\t\t}\n\n\t\tlikeInstance.popupContentPage += 1;\n\n\t\tdata.items.forEach((item) => {\n\t\t\tlet avatarNode = null;\n\n\t\t\tif (Type.isStringFilled(item.PHOTO_SRC))\n\t\t\t{\n\t\t\t\tavatarNode = Dom.create('img', {\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\tsrc: item.PHOTO_SRC,\n\t\t\t\t\t},\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tclassName: 'bx-ilike-popup-avatar-img',\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tavatarNode = Dom.create('img', {\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\tsrc: '/bitrix/images/main/blank.gif',\n\t\t\t\t\t},\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tclassName: 'bx-ilike-popup-avatar-img bx-ilike-popup-avatar-img-default',\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tconst imgClassList = [\n\t\t\t\t'bx-ilike-popup-img',\n\t\t\t];\n\t\t\tif (Type.isStringFilled(item.USER_TYPE))\n\t\t\t{\n\t\t\t\timgClassList.push(`bx-ilike-popup-img-${item.USER_TYPE}`);\n\t\t\t}\n\n\t\t\tlikeInstance.popupContent.appendChild(\n\t\t\t\tDom.create('a', {\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\thref: item.URL,\n\t\t\t\t\t\ttarget: '_blank',\n\t\t\t\t\t},\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tclassName: imgClassList.join(' '),\n\t\t\t\t\t},\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tDom.create('span', {\n\t\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\t\tclassName: 'bx-ilike-popup-avatar-new',\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tchildren: [\n\t\t\t\t\t\t\t\tavatarNode,\n\t\t\t\t\t\t\t\tDom.create('span', {\n\t\t\t\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\t\t\t\tclassName: 'bx-ilike-popup-avatar-status-icon',\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tDom.create('span', {\n\t\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\t\tclassName: 'bx-ilike-popup-name-new',\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\thtml: item.FULL_NAME,\n\t\t\t\t\t\t}),\n\t\t\t\t\t],\n\t\t\t\t})\n\t\t\t);\n\t\t});\n\t}\n\n\tstatic afterClick(params)\n\t{\n\t\tconst likeId = (Type.isStringFilled(params.likeId) ? params.likeId : '');\n\n\t\tif (!Type.isStringFilled(likeId))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.afterClickBlockShowPopup = true;\n\n\t\tthis.afterClickHandler = this.getAfterClickHandler(likeId);\n\n\t\tRatingLike.getInstance(likeId).box.addEventListener('mouseleave', this.afterClickHandler);\n\t}\n\n\tstatic getAfterClickHandler(likeId)\n\t{\n\t\treturn () => {\n\t\t\tthis.afterClickBlockShowPopup = false;\n\n\t\t\tRatingLike.getInstance(likeId).box.removeEventListener('mouseleave', this.afterClickHandler);\n\t\t};\n\t}\n\n\tstatic resultReactionClick(e)\n\t{\n\t\tconst likeId = e.currentTarget.getAttribute('data-like-id');\n\t\tlet reaction = e.currentTarget.getAttribute('data-reaction');\n\n\t\tif (!Type.isSet(reaction))\n\t\t{\n\t\t\treaction = '';\n\t\t}\n\n\t\tListPopup.onResultClick({\n\t\t\tlikeId: likeId,\n\t\t\tevent: e,\n\t\t\treaction: reaction,\n\t\t});\n\n\t\te.stopPropagation();\n\t}\n\n\tstatic resultReactionMouseEnter(e)\n\t{\n\t\tconst likeId = e.currentTarget.getAttribute('data-like-id');\n\t\tconst reaction = e.currentTarget.getAttribute('data-reaction');\n\n\t\tListPopup.onResultMouseEnter({\n\t\t\tlikeId: likeId,\n\t\t\tevent: e,\n\t\t\treaction: reaction,\n\t\t});\n\t}\n\n\tstatic resultReactionMouseLeave(e)\n\t{\n\t\tconst likeId = e.currentTarget.getAttribute('data-like-id');\n\t\tconst reaction = e.currentTarget.getAttribute('data-reaction');\n\n\t\tListPopup.onResultMouseLeave({\n\t\t\tlikeId: likeId,\n\t\t\treaction: reaction,\n\t\t});\n\t}\n\n\tstatic openMobileReactionsPage(params)\n\t{\n\t\tBXMobileApp.PageManager.loadPageBlank({\n\t\t\turl: `${Loc.getMessage('SITE_DIR')}mobile/like/result.php`,\n\t\t\ttitle: Loc.getMessage('RATING_LIKE_RESULTS'),\n\t\t\tbackdrop: {\n\t\t\t\tmediumPositionPercent: 65,\n\t\t\t},\n\t\t\tcache: true,\n\t\t\tdata: {\n\t\t\t\tentityTypeId: params.entityTypeId,\n\t\t\t\tentityId: params.entityId,\n\t\t\t}\n\t\t});\n\t}\n\n\tstatic onRatingLike(eventData)\n\t{\n\t\tRatingLike.repo.forEach((likeInstance, likeId) => {\n\t\t\tif (\n\t\t\t\tlikeInstance.entityTypeId !== eventData.entityTypeId\n\t\t\t\t&& Number(likeInstance.entityId) !== Number(eventData.entityId)\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tlet voteAction = (Type.isStringFilled(eventData.voteAction) ? eventData.voteAction.toUpperCase() : 'ADD');\n\t\t\tvoteAction = (voteAction === 'PLUS' ? 'ADD' : voteAction);\n\n\t\t\tif (\n\t\t\t\tNumber(eventData.userId) === Number(Loc.getMessage('USER_ID'))\n\t\t\t\t&& likeInstance.button\n\t\t\t)\n\t\t\t{\n\t\t\t\tif (voteAction === 'CANCEL')\n\t\t\t\t{\n\t\t\t\t\tlikeInstance.button.classList.remove('bx-you-like-button');\n\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tlikeInstance.button.classList.add('bx-you-like-button');\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tRatingLike.Draw(likeId, {\n\t\t\t\tTYPE: voteAction,\n\t\t\t\tUSER_ID: eventData.userId,\n\t\t\t\tENTITY_TYPE_ID: eventData.entityTypeId,\n\t\t\t\tENTITY_ID: eventData.entityId,\n\t\t\t\tUSER_DATA: eventData.userData,\n\t\t\t\tREACTION: eventData.voteReaction,\n\t\t\t\tREACTION_OLD: eventData.voteReactionOld,\n\t\t\t\tTOTAL_POSITIVE_VOTES: eventData.itemsAll,\n\t\t\t});\n\t\t});\n\t}\n\n\tstatic onMobileCommentsGet()\n\t{\n\t\tconst ratingEmojiSelectorPopup = document.querySelector('.feed-post-emoji-popup-container');\n\t\tif (ratingEmojiSelectorPopup)\n\t\t{\n\t\t\tratingEmojiSelectorPopup.style.top = 0;\n\t\t\tratingEmojiSelectorPopup.style.left = 0;\n\t\t\tratingEmojiSelectorPopup.classList.remove('feed-post-emoji-popup-active');\n\t\t\tratingEmojiSelectorPopup.classList.remove('feed-post-emoji-popup-active-final');\n\t\t\tratingEmojiSelectorPopup.classList.remove('feed-post-emoji-popup-active-final-item');\n\t\t\tratingEmojiSelectorPopup.classList.add('feed-post-emoji-popup-invisible-final');\n\t\t\tratingEmojiSelectorPopup.classList.add('feed-post-emoji-popup-invisible-final-mobile');\n\t\t}\n\t}\n\n\tstatic getNode(node)\n\t{\n\t\tif (Type.isDomNode(node))\n\t\t{\n\t\t\treturn node;\n\t\t}\n\t\telse if (Type.isStringFilled(node))\n\t\t{\n\t\t\treturn document.getElementById(node);\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn null;\n\t\t}\n\t}\n}\n","import { Type, Runtime } from 'main.core';\nimport { EventEmitter, BaseEvent } from 'main.core.events';\n\nimport { RatingRender } from './render';\nimport { ListPopup } from './listpopup';\n\nexport class RatingManager\n{\n\tstatic mobile = false;\n\tstatic initialized = false;\n\tstatic displayHeight = 0;\n\tstatic startScrollTop = 0;\n\tstatic entityList = [];\n\tstatic ratingNodeList = new Map();\n\tstatic delayedList = new Map();\n\n\tstatic init(params)\n\t{\n\t\tif (!Type.isPlainObject(params))\n\t\t{\n\t\t\tparams = {};\n\t\t}\n\n\t\tif (this.initialized)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.mobile = (!Type.isUndefined(params.mobile) && !!params.mobile);\n\n\t\tthis.initialized = true;\n\n\t\tthis.setDisplayHeight();\n\n\t\tif (!this.mobile)\n\t\t{\n\t\t\twindow.addEventListener('scroll', Runtime.throttle(() => {\n\t\t\t\tthis.getInViewScope();\n\t\t\t}, 80), { passive: true });\n\n\t\t\twindow.addEventListener('resize', this.setDisplayHeight.bind(this));\n\t\t}\n\n\t\tEventEmitter.subscribe('onBeforeMobileLivefeedRefresh', RatingRender.reactionsPopupMobileHide)\n\t\tEventEmitter.subscribe('BX.MobileLF:onCommentsGet', RatingRender.onMobileCommentsGet)\n\n\t\tif (this.mobile)\n\t\t{\n\t\t\t// new one\n\t\t\tBXMobileApp.addCustomEvent('onRatingLike', RatingRender.onRatingLike);\n\t\t}\n\n\t\tif (this.mobile)\n\t\t{\n\t\t\tBXMobileApp.addCustomEvent('onPull-main', (data) => {\n\t\t\t\tif (data.command == 'rating_vote')\n\t\t\t\t{\n\t\t\t\t\tRatingLike.LiveUpdate(data.params);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tEventEmitter.subscribe('onPullEvent-main', (event: BaseEvent) => {\n\t\t\t\tconst [ command, params ] = event.getCompatData();\n\n\t\t\t\tif (command === 'rating_vote')\n\t\t\t\t{\n\t\t\t\t\tRatingLike.LiveUpdate(params);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (\n\t\t\t\t!Type.isUndefined(window.BX.SidePanel)\n\t\t\t\t&& BX.SidePanel.Instance.getTopSlider()\n\t\t\t)\n\t\t\t{\n\t\t\t\tEventEmitter.subscribe(\n\t\t\t\t\tBX.SidePanel.Instance.getTopSlider().getWindow(),\n\t\t\t\t\t'SidePanel.Slider:onCloseComplete',\n\t\t\t\t\tListPopup.removeOnCloseHandler\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic setDisplayHeight()\n\t{\n\t\tthis.displayHeight = document.documentElement.clientHeight;\n\t}\n\n\tstatic getInViewScope()\n\t{\n\t\tlet ratingNode = null;\n\t\tthis.delayedList.forEach((value, key) => {\n\n\t\t\tratingNode = BX(this.getNode(key));\n\n\t\t\tif (!ratingNode)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.isNodeVisibleOnScreen(ratingNode))\n\t\t\t{\n\t\t\t\tthis.fireAnimation(key);\n\t\t\t}\n\t\t});\n\t}\n\n\tstatic addNode(entityId, node)\n\t{\n\t\tif (\n\t\t\t!Type.isDomNode(node)\n//\t\t\t|| !Type.isUndefined(this.ratingNodeList.get(entityId))\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.ratingNodeList.set(entityId, node);\n\t}\n\n\n\tstatic getNode(entityId)\n\t{\n\t\tconst node = this.ratingNodeList.get(entityId);\n\t\treturn (!Type.isUndefined(node) ? node : false);\n\t}\n\n\tstatic isNodeVisibleOnScreen(node)\n\t{\n\t\tconst coords = node.getBoundingClientRect();\n\t\tconst visibleAreaTop = Number(this.displayHeight / 10);\n\t\tconst visibleAreaBottom = Number(this.displayHeight * 9 / 10);\n\n\t\treturn (\n\t\t\t(\n\t\t\t\t(\n\t\t\t\t\tcoords.top > 0\n\t\t\t\t\t&& coords.top < visibleAreaBottom\n\t\t\t\t)\n\t\t\t\t|| (\n\t\t\t\t\tcoords.bottom > visibleAreaTop\n\t\t\t\t\t&& coords.bottom < this.displayHeight\n\t\t\t\t)\n\t\t\t)\n\t\t\t&& (\n\t\t\t\tthis.mobile\n\t\t\t\t|| !(\n\t\t\t\t\t(\n\t\t\t\t\t\tcoords.top < visibleAreaTop\n\t\t\t\t\t\t&& coords.bottom < visibleAreaTop\n\t\t\t\t)\n\t\t\t\t|| (\n\t\t\t\t\tcoords.top > visibleAreaBottom\n\t\t\t\t\t&& coords.bottom > visibleAreaBottom\n\t\t\t\t)\n\t\t\t\t)\n\t\t\t)\n\t\t);\n\t}\n\n\tstatic fireAnimation(key)\n\t{\n\t\tthis.delayedList.delete(key);\n\t}\n\n\tstatic addEntity(entityId, ratingObject)\n\t{\n\t\tif (\n\t\t\t!this.entityList.includes(entityId)\n\t\t\t&& ratingObject.topPanelContainer\n\t\t\t)\n\t\t\t{\n\t\t\t\tthis.entityList.push(entityId);\n\t\t\t\tthis.addNode(entityId, ratingObject.topPanelContainer);\n\t\t\t}\n\t}\n\n\tstatic live(params)\n\t{\n\t\tif (\n\t\t\tType.isUndefined(params.TYPE)\n\t\t\t|| params.TYPE !== 'ADD'\n\t\t\t|| !Type.isStringFilled(params.ENTITY_TYPE_ID)\n\t\t\t|| Type.isUndefined(params.ENTITY_ID)\n\t\t\t|| Number(params.ENTITY_ID) <= 0\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst key = `${params.ENTITY_TYPE_ID}_${params.ENTITY_ID}`;\n\t\tif (!this.checkEntity(key))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst ratingNode = this.getNode(key);\n\t\tif (!ratingNode)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tif (this.isNodeVisibleOnScreen(ratingNode))\n\t\t{\n\t\t\tthis.fireAnimation(key);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.addDelayed(params)\n\t\t}\n\t}\n\n\tstatic checkEntity(entityId)\n\t{\n\t\treturn this.entityList.includes(entityId);\n\t}\n\n\tstatic addDelayed(liveParams)\n\t{\n\t\tif (\n\t\t\t!Type.isStringFilled(liveParams.ENTITY_TYPE_ID)\n\t\t\t|| Type.isUndefined(liveParams.ENTITY_ID)\n\t\t\t|| Number(liveParams.ENTITY_ID) <= 0\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst key = `${liveParams.ENTITY_TYPE_ID}_${liveParams.ENTITY_ID}`;\n\n\t\tlet delayedListItem = this.delayedList.get(key);\n\t\tif (Type.isUndefined(delayedListItem))\n\t\t{\n\t\t\tdelayedListItem = [];\n\t\t}\n\n\t\tdelayedListItem.push(liveParams);\n\t\tthis.delayedList.set(key, delayedListItem);\n\t}\n}\n","import { Type, Dom, Loc, ajax } from 'main.core';\n\nimport { RatingManager } from './manager';\nimport { RatingRender } from './render';\nimport { ListPopup } from './listpopup';\n\nimport './css/reaction.css';\nimport './css/mobile.css';\n\nexport class RatingLike\n{\n\tstatic repo = new Map();\n\tstatic lastVoteRepo = new Map();\n\tstatic lastReactionRepo = new Map();\n\tstatic additionalParams = new Map();\n\n\tconstructor(likeId, entityTypeId, entityId, available, userId, localize, template, pathToUserProfile)\n\t{\n\t\tif (Type.isObject(arguments[0]))\n\t\t{\n\t\t\tconst params = arguments[0];\n\n\t\t\tthis.likeId = Type.isStringFilled(params.likeId) ? params.likeId : '';\n\t\t\tthis.entityTypeId = Type.isStringFilled(params.entityTypeId) ? params.entityTypeId : '';\n\t\t\tthis.entityId = !Type.isUndefined(params.entityId) ? Number(params.entityId) : 0;\n\t\t\tthis.available = Type.isStringFilled(params.available) ? params.available === 'Y' : false;\n\t\t\tthis.userId = !Type.isUndefined(params.userId) ? Number(params.userId) : 0;\n\t\t\tthis.localize = Type.isPlainObject(params.localize) ? params.localize : {};\n\t\t\tthis.template = Type.isStringFilled(params.template) ? params.template : '';\n\t\t\tthis.pathToUserProfile = Type.isStringFilled(params.pathToUserProfile) ? params.pathToUserProfile : '';\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.likeId = Type.isStringFilled(arguments[0]) ? arguments[0] : '';\n\t\t\tthis.entityTypeId = Type.isStringFilled(arguments[1]) ? arguments[1] : '';\n\t\t\tthis.entityId = !Type.isUndefined(arguments[2]) ? Number(arguments[2]) : 0;\n\t\t\tthis.available = Type.isStringFilled(arguments[3]) ? arguments[3] === 'Y' : false;\n\t\t\tthis.userId = !Type.isUndefined(arguments[4]) ? Number(arguments[4]) : 0;\n\t\t\tthis.localize = Type.isPlainObject(arguments[5]) ? arguments[5] : {};\n\t\t\tthis.template = Type.isStringFilled(arguments[6]) ? arguments[6] : '';\n\t\t\tthis.pathToUserProfile = Type.isStringFilled(arguments[7]) ? arguments[7] : '';\n\t\t}\n\n\t\tconst key = `${this.entityTypeId}_${this.entityId}`;\n\n\t\tthis.enabled = true;\n\n\t\tthis.box = document.getElementById(`bx-ilike-button-${this.likeId}`);\n\t\tif (this.box === null)\n\t\t{\n\t\t\tthis.enabled = false;\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.box.setAttribute('data-rating-vote-id', likeId);\n\n\t\tthis.button = this.box.querySelector('.bx-ilike-left-wrap');\n\t\tthis.buttonText = this.button.querySelector('.bx-ilike-text');\n\t\tthis.count = this.box.querySelector('span.bx-ilike-right-wrap');\n\t\tif (!this.count)\n\t\t{\n\t\t\tthis.count = document.getElementById(`bx-ilike-count-${this.likeId}`);\n\t\t}\n\t\tthis.countText = this.count.querySelector('.bx-ilike-right');\n\n\t\tthis.topPanelContainer = document.getElementById(`feed-post-emoji-top-panel-container-${this.likeId}`);\n\t\tthis.topPanel = document.getElementById(`feed-post-emoji-top-panel-${this.likeId}`);\n\t\tthis.topUsersText = document.getElementById(`bx-ilike-top-users-${this.likeId}`);\n\t\tthis.topUsersDataNode = document.getElementById(`bx-ilike-top-users-data-${this.likeId}`);\n\t\tthis.userReactionNode = document.getElementById(`bx-ilike-user-reaction-${this.likeId}`);\n\t\tthis.reactionsNode = document.getElementById(`feed-post-emoji-icons-${this.likeId}`);\n\n\t\tthis.popup = null;\n\t\tthis.popupId = null;\n\t\tthis.popupTimeoutIdShow = null;\n\t\tthis.popupTimeoutIdList = null;\n\n\t\tthis.popupContent = document.getElementById(`bx-ilike-popup-cont-${this.likeId}`).querySelector('span.bx-ilike-popup');\n\t\tthis.popupContentPage = 1;\n\t\tthis.popupTimeout = false;\n\t\tthis.likeTimeout = false;\n\t\tthis.mouseOverHandler = null;\n\t\tthis.version = (Type.isDomNode(this.topPanel) ? 2 : 1);\n\t\tthis.mouseInShowPopupNode = {};\n\t\tthis.listXHR = null;\n\n\t\tif (\n\t\t\tthis.template === 'light'\n\t\t\t&& Type.isDomNode(this.reactionsNode)\n\t\t)\n\t\t{\n\t\t\tconst container = this.reactionsNode.querySelector('.feed-post-emoji-icon-container');\n\t\t\tif (container)\n\t\t\t{\n\t\t\t\tlet reactionsData = container.getAttribute('data-reactions-data');\n\t\t\t\ttry\n\t\t\t\t{\n\t\t\t\t\treactionsData = JSON.parse(reactionsData);\n\n\t\t\t\t\tconst elementsNew = [];\n\t\t\t\t\tObject.entries(reactionsData).forEach(([reaction, count]) => {\n\t\t\t\t\t\telementsNew.push({\n\t\t\t\t\t\t\treaction: reaction,\n\t\t\t\t\t\t\tcount: count,\n\t\t\t\t\t\t\tanimate: false,\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\n\t\t\t\t\tRatingRender.drawReactions({\n\t\t\t\t\t\tlikeId: likeId,\n\t\t\t\t\t\tcontainer: container,\n\t\t\t\t\t\tdata: elementsNew,\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tcatch (e)\n\t\t\t\t{\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (!Type.isUndefined(RatingLike.lastVoteRepo.get(key)))\n\t\t{\n\t\t\tthis.lastVote = RatingLike.lastVoteRepo.get(key);\n\n\t\t\tconst ratingNode = (template === 'standart' ? this.button : this.count);\n\t\t\tif (this.lastVote === 'plus')\n\t\t\t{\n\t\t\t\tratingNode.classList.add('bx-you-like');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tratingNode.classList.remove('bx-you-like');\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.lastVote = (\n\t\t\t\t(this.template === 'standart' ? this.button : this.count).classList.contains('bx-you-like')\n\t\t\t\t\t? 'plus'\n\t\t\t\t\t: 'cancel'\n\t\t\t);\n\t\t\tRatingLike.lastVoteRepo.set(key, this.lastVote);\n\t\t}\n\n\t\tif (!Type.isUndefined(RatingLike.lastReactionRepo.get(key)))\n\t\t{\n\t\t\tthis.lastReaction = RatingLike.lastReactionRepo.get(key);\n\t\t\tthis.count.setAttribute('data-myreaction', this.lastReaction);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst lastReaction = this.count.getAttribute('data-myreaction');\n\t\t\tthis.lastReaction = (Type.isStringFilled(lastReaction) ? lastReaction : 'like');\n\t\t\tRatingLike.lastReactionRepo.set(key, this.lastReaction);\n\t\t}\n\n\t\tif (this.topPanelContainer)\n\t\t{\n\t\t\tRatingManager.addEntity(key, this);\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tstatic setInstance(likeId: string, likeInstance)\n\t{\n\t\tthis.repo.set(likeId, likeInstance);\n\t\twindow.BXRL[likeId] = likeInstance;\n\t}\n\n\tstatic getInstance(likeId: string)\n\t{\n\t\treturn this.repo.get(likeId);\n\t}\n\n\tstatic ClickVote(e, likeId, userReaction, forceAdd)\n\t{\n\t\tif (Type.isUndefined(userReaction))\n\t\t{\n\t\t\tuserReaction = 'like';\n\t\t}\n\n\t\tconst likeInstance = this.getInstance(likeId);\n\t\tconst container = (likeInstance.template === 'standart' ? e.target : likeInstance.count);\n\n\t\tif (\n\t\t\tlikeInstance.version === 2\n\t\t\t&& likeInstance.userReactionNode\n\t\t)\n\t\t{\n\t\t\tRatingRender.hideReactionsPopup({\n\t\t\t\tlikeId: likeId,\n\t\t\t});\n\t\t\tRatingRender.blockReactionsPopup();\n\t\t\tdocument.removeEventListener('mousemove', RatingRender.reactionsPopupMouseOutHandler);\n\t\t}\n\n\t\tclearTimeout(likeInstance.likeTimeout);\n\n\t\tconst active = container.classList.contains('bx-you-like');\n\n\t\tforceAdd = !!forceAdd;\n\n\t\tlet change = false;\n\t\tlet userReactionOld = false;\n\n\t\tif (active && !forceAdd)\n\t\t{\n\t\t\tuserReaction = (\n\t\t\t\tlikeInstance.version === 2\n\t\t\t\t\t? RatingRender.getUserReaction({\n\t\t\t\t\t\tuserReactionNode: likeInstance.userReactionNode\n\t\t\t\t\t})\n\t\t\t\t\t: false\n\t\t\t);\n\n\t\t\tlikeInstance.buttonText.innerHTML = likeInstance.localize['LIKE_N'];\n\t\t\tlikeInstance.countText.innerHTML = Number(likeInstance.countText.innerHTML)-1;\n\n\t\t\tcontainer.classList.remove('bx-you-like');\n\t\t\tlikeInstance.button.classList.remove('bx-you-like-button');\n\n\t\t\tif (userReaction)\n\t\t\t{\n\t\t\t\tlikeInstance.button.classList.remove(`bx-you-like-button-${userReaction}`);\n\t\t\t}\n\n\t\t\tlikeInstance.likeTimeout = setTimeout(() => {\n\t\t\t\tif (likeInstance.lastVote != 'cancel')\n\t\t\t\t{\n\t\t\t\t\tthis.Vote(likeId, 'cancel', userReaction);\n\t\t\t\t}\n\t\t\t}, 1000);\n\t\t}\n\t\telse if (active && forceAdd)\n\t\t{\n\t\t\tchange = true;\n\t\t\tuserReactionOld = (\n\t\t\t\tlikeInstance.version === 2\n\t\t\t\t\t? RatingRender.getUserReaction({ userReactionNode: likeInstance.userReactionNode })\n\t\t\t\t\t: false\n\t\t\t);\n\n\t\t\tif (userReaction != userReactionOld)\n\t\t\t{\n\t\t\t\tif (userReactionOld)\n\t\t\t\t{\n\t\t\t\t\tlikeInstance.button.classList.remove(`bx-you-like-button-${userReactionOld}`);\n\t\t\t\t}\n\t\t\t\tlikeInstance.button.classList.add(`bx-you-like-button-${userReaction}`);\n\n\t\t\t\tlikeInstance.likeTimeout = setTimeout(() => {\n\t\t\t\t\tthis.Vote(likeId, 'change', userReaction, userReactionOld);\n\t\t\t\t}, 1000);\n\t\t\t}\n\t\t}\n\t\telse if (!active)\n\t\t{\n\t\t\tlikeInstance.buttonText.innerHTML = likeInstance.localize['LIKE_Y'];\n\t\t\tlikeInstance.countText.innerHTML = Number(likeInstance.countText.innerHTML) + 1;\n\t\t\tcontainer.classList.add('bx-you-like');\n\n\t\t\tlikeInstance.button.classList.add('bx-you-like-button');\n\t\t\tlikeInstance.button.classList.add(`bx-you-like-button-${userReaction}`);\n\n\t\t\tlikeInstance.likeTimeout = setTimeout(() => {\n\t\t\t\tif (likeInstance.lastVote !== 'plus')\n\t\t\t\t{\n\t\t\t\t\tthis.Vote(likeId, 'plus', userReaction);\n\t\t\t\t}\n\t\t\t\telse if (userReaction !== likeInstance.lastReaction) // http://jabber.bx/view.php?id=99339\n\t\t\t\t{\n\t\t\t\t\tthis.Vote(likeId, 'change', userReaction, likeInstance.lastReaction);\n\t\t\t\t}\n\t\t\t}, 1000);\n\t\t}\n\n\t\tif (likeInstance.version === 2)\n\t\t{\n\t\t\tif (change)\n\t\t\t{\n\t\t\t\tRatingRender.setReaction({\n\t\t\t\t\tlikeId: likeId,\n\t\t\t\t\trating: likeInstance,\n\t\t\t\t\taction: 'change',\n\t\t\t\t\tuserReaction: userReaction,\n\t\t\t\t\tuserReactionOld: userReactionOld,\n\t\t\t\t\ttotalCount: Number(likeInstance.countText.innerHTML),\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tRatingRender.setReaction({\n\t\t\t\t\tlikeId: likeId,\n\t\t\t\t\trating: likeInstance,\n\t\t\t\t\taction: (active ? 'cancel' : 'add'),\n\t\t\t\t\tuserReaction: userReaction,\n\t\t\t\t\ttotalCount: Number(likeInstance.countText.innerHTML),\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tif (\n\t\t\t!change\n\t\t\t&& likeInstance.version === 2\n\t\t)\n\t\t{\n\t\t\tconst dataUsers = (\n\t\t\t\tlikeInstance.topUsersDataNode\n\t\t\t\t\t? JSON.parse(likeInstance.topUsersDataNode.getAttribute('data-users'))\n\t\t\t\t\t: false\n\t\t\t);\n\n\t\t\tif (dataUsers)\n\t\t\t{\n\t\t\t\tdataUsers.TOP = Object.values(dataUsers.TOP);\n\n\t\t\t\tlikeInstance.topUsersText.innerHTML = RatingRender.getTopUsersText({\n\t\t\t\t\tyou: !active,\n\t\t\t\t\ttop: dataUsers.TOP,\n\t\t\t\t\tmore: dataUsers.MORE,\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tif (\n\t\t\tlikeInstance.template === 'light'\n\t\t\t&& !likeInstance.userReactionNode\n\t\t)\n\t\t{\n\t\t\tconst cont = likeInstance.box;\n\t\t\tconst likeNode = cont.cloneNode(true);\n\n\t\t\tlikeNode.id = 'like_anim'; // to not dublicate original id\n\n\t\t\tlet type = 'normal';\n\t\t\tif (cont.closest('.feed-com-informers-bottom'))\n\t\t\t{\n\t\t\t\ttype = 'comment';\n\t\t\t}\n\t\t\telse if (cont.closest('.feed-post-informers'))\n\t\t\t{\n\t\t\t\ttype = 'post';\n\t\t\t}\n\n\t\t\tlikeNode.classList.remove('bx-ilike-button-hover')\n\t\t\tlikeNode.classList.add('bx-like-anim')\n\n\t\t\tDom.adjust(cont.parentNode, { style: { position: 'relative' } });\n\n\t\t\tDom.adjust(likeNode, {\n\t\t\t\tstyle: {\n\t\t\t\t\tposition: 'absolute',\n\t\t\t\t\twhiteSpace: 'nowrap',\n\t\t\t\t\ttop: (type === 'post' ? '1px' : (type === 'comment' ? '0' : '')),\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tDom.adjust(cont, { style: { visibility: 'hidden' } });\n\t\t\tDom.prepend(likeNode, cont.parentNode);\n\n\t\t\tnew BX.easing({\n\t\t\t\tduration: 140,\n\t\t\t\tstart: { scale: 100 },\n\t\t\t\tfinish: { scale: (type === 'comment' ? 110 : 115) },\n\t\t\t\ttransition : BX.easing.transitions.quad,\n\t\t\t\tstep: (state) => {\n\t\t\t\t\tlikeNode.style.transform = `scale(${state.scale / 100})`;\n\t\t\t\t},\n\t\t\t\tcomplete: () => {\n\t\t\t\t\tconst likeThumbNode = Dom.create('SPAN', {\n\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\tclassName: (active ? 'bx-ilike-icon' : 'bx-ilike-icon bx-ilike-icon-orange'),\n\t\t\t\t\t\t},\n\t\t\t\t\t});\n\n\t\t\t\t\tDom.adjust(likeThumbNode, {\n\t\t\t\t\t\tstyle: {\n\t\t\t\t\t\t\tposition: 'absolute',\n\t\t\t\t\t\t\twhiteSpace: 'nowrap',\n\t\t\t\t\t\t},\n\t\t\t\t\t});\n\n\t\t\t\t\tDom.prepend(likeThumbNode, cont.parentNode);\n\n\t\t\t\t\tnew BX.easing({\n\t\t\t\t\t\tduration: 140,\n\t\t\t\t\t\tstart: { scale: (type == 'comment' ? 110 : 115) },\n\t\t\t\t\t\tfinish: { scale: 100 },\n\t\t\t\t\t\ttransition : BX.easing.transitions.quad,\n\t\t\t\t\t\tstep: (state) => {\n\t\t\t\t\t\t\tlikeNode.style.transform = `scale(${state.scale / 100})`;\n\t\t\t\t\t\t},\n\t\t\t\t\t\tcomplete: () => {}\n\t\t\t\t\t}).animate();\n\n\t\t\t\t\tconst propsStart = {\n\t\t\t\t\t\topacity: 100,\n\t\t\t\t\t\tscale: (type === 'comment' ? 110 : 115),\n\t\t\t\t\t\ttop: 0,\n\t\t\t\t\t};\n\t\t\t\t\tconst propsFinish = {\n\t\t\t\t\t\topacity: 0,\n\t\t\t\t\t\tscale: 200,\n\t\t\t\t\t\ttop: (type === 'comment' ? -3 : -2),\n\t\t\t\t\t};\n\n\t\t\t\t\tif (type !== 'comment')\n\t\t\t\t\t{\n\t\t\t\t\t\tpropsStart.left = -5;\n\t\t\t\t\t\tpropsFinish.left = -13;\n\t\t\t\t\t}\n\n\t\t\t\t\tnew BX.easing({\n\t\t\t\t\t\tduration: 200,\n\t\t\t\t\t\tstart: propsStart,\n\t\t\t\t\t\tfinish: propsFinish,\n\t\t\t\t\t\ttransition : BX.easing.transitions.linear,\n\t\t\t\t\t\tstep: (state) => {\n\t\t\t\t\t\t\tlikeThumbNode.style.transform = `scale(${state.scale / 100})`;\n\t\t\t\t\t\t\tlikeThumbNode.style.opacity = state.opacity / 100;\n\t\t\t\t\t\t\tif (type !== 'comment')\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tlikeThumbNode.style.left = `${state.left}px`;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tlikeThumbNode.style.top = `${state.top}px`;\n\t\t\t\t\t\t},\n\t\t\t\t\t\tcomplete: () => {\n\t\t\t\t\t\t\tlikeNode.parentNode.removeChild(likeNode);\n\t\t\t\t\t\t\tlikeThumbNode.parentNode.removeChild(likeThumbNode);\n\n\t\t\t\t\t\t\tDom.adjust(cont.parentNode, { style: { position: 'static' } });\n\t\t\t\t\t\t\tDom.adjust(cont, { style: { visibility: 'visible' } });\n\t\t\t\t\t\t}\n\t\t\t\t\t}).animate();\n\n\t\t\t\t}\n\t\t\t}).animate();\n\t\t}\n\n\t\tlikeInstance.box.classList.remove('bx-ilike-button-hover');\n\t}\n\n\tstatic Draw(likeId, params)\n\t{\n\t\tconst likeInstance = this.getInstance(likeId);\n\t\tlikeInstance.countText.innerHTML = Number(params.TOTAL_POSITIVE_VOTES);\n\n\t\tif (\n\t\t\t!Type.isUndefined(params.TYPE)\n\t\t\t&& !Type.isUndefined(params.USER_ID)\n\t\t\t&& Number(params.USER_ID) > 0\n\t\t\t&& !Type.isUndefined(params.USER_DATA)\n\t\t\t&& !Type.isUndefined(params.USER_DATA.WEIGHT)\n\t\t)\n\t\t{\n\t\t\tconst userWeight = parseFloat(params.USER_DATA.WEIGHT);\n\n\t\t\tconst usersData = (\n\t\t\t\tlikeInstance.topUsersDataNode\n\t\t\t\t\t? JSON.parse(likeInstance.topUsersDataNode.getAttribute('data-users'))\n\t\t\t\t\t: false\n\t\t\t);\n\n\t\t\tif (\n\t\t\t\tparams.TYPE != 'CHANGE'\n\t\t\t\t&& Type.isPlainObject(usersData)\n\t\t\t)\n\t\t\t{\n\t\t\t\tusersData.TOP = Object.values(usersData.TOP);\n\t\t\t\tlet recalcNeeded = (usersData.TOP.length < 2);\n\n\t\t\t\tObject.values(usersData.TOP).forEach((item) => {\n\t\t\t\t\tif (recalcNeeded)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (\n\t\t\t\t\t\t(\n\t\t\t\t\t\t\tparams.TYPE === 'ADD'\n\t\t\t\t\t\t\t&& userWeight > item.WEIGHT\n\t\t\t\t\t\t)\n\t\t\t\t\t\t|| (\n\t\t\t\t\t\t\tparams.TYPE === 'CANCEL'\n\t\t\t\t\t\t\t&& params.USER_ID === item.ID\n\t\t\t\t\t\t)\n\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\trecalcNeeded = true;\n\t\t\t\t\t}\n\t\t\t\t});\n\n\n\t\t\t\tif (recalcNeeded)\n\t\t\t\t{\n\t\t\t\t\tif (\n\t\t\t\t\t\tparams.TYPE === 'ADD'\n\t\t\t\t\t\t&& Number(params.USER_ID) !== Number(Loc.getMessage('USER_ID'))\n\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (!usersData.TOP.find((a) => {\n\t\t\t\t\t\t\treturn Number(a.ID) === Number(params.USER_ID)\n\t\t\t\t\t\t}))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tusersData.TOP.push({\n\t\t\t\t\t\t\t\tID: Number(params.USER_ID),\n\t\t\t\t\t\t\t\tNAME_FORMATTED: params.USER_DATA.NAME_FORMATTED,\n\t\t\t\t\t\t\t\tWEIGHT: parseFloat(params.USER_DATA.WEIGHT),\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse if (params.TYPE === 'CANCEL')\n\t\t\t\t\t{\n\t\t\t\t\t\tusersData.TOP = usersData.TOP.filter((a) => {\n\t\t\t\t\t\t\treturn Number(a.ID) !== Number(params.USER_ID);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t\tusersData.TOP.sort((a, b) => {\n\t\t\t\t\t\tif (parseFloat(a.WEIGHT) === parseFloat(b.WEIGHT))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn 0;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn (parseFloat(a.WEIGHT) > parseFloat(b.WEIGHT)) ? -1 : 1;\n\t\t\t\t\t});\n\n\t\t\t\t\tif (\n\t\t\t\t\t\tusersData.TOP.length > 2\n\t\t\t\t\t\t&& params.TYPE === 'ADD'\n\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\tusersData.TOP.pop();\n\t\t\t\t\t\tusersData.MORE++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tif (params.TYPE === 'ADD')\n\t\t\t\t\t{\n\t\t\t\t\t\tusersData.MORE = (\n\t\t\t\t\t\t\t!Type.isUndefined(usersData.MORE)\n\t\t\t\t\t\t\t\t? Number(usersData.MORE) + 1\n\t\t\t\t\t\t\t\t: 1\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t\telse if (params.TYPE === 'CANCEL')\n\t\t\t\t\t{\n\t\t\t\t\t\tusersData.MORE = (\n\t\t\t\t\t\t\t!Type.isUndefined(usersData.MORE)\n\t\t\t\t\t\t\t&& Number(usersData.MORE) > 0\n\t\t\t\t\t\t\t\t? Number(usersData.MORE) - 1\n\t\t\t\t\t\t\t\t: 0\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tlikeInstance.topUsersDataNode.setAttribute('data-users', JSON.stringify(usersData));\n\n\t\t\t\tif (likeInstance.topUsersText)\n\t\t\t\t{\n\t\t\t\t\tlikeInstance.topUsersText.innerHTML = RatingRender.getTopUsersText({\n\t\t\t\t\t\tyou: (\n\t\t\t\t\t\t\tNumber(params.USER_ID) === Number(Loc.getMessage('USER_ID'))\n\t\t\t\t\t\t\t\t? params.TYPE !== 'CANCEL'\n\t\t\t\t\t\t\t\t: likeInstance.count.classList.contains('bx-you-like')\n\t\t\t\t\t\t),\n\t\t\t\t\t\ttop: usersData.TOP,\n\t\t\t\t\t\tmore: usersData.MORE,\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\tType.isStringFilled(params.REACTION)\n\t\t\t\t&& Type.isStringFilled(params.REACTION_OLD)\n\t\t\t\t&& params.TYPE === 'CHANGE'\n\t\t\t)\n\t\t\t{\n\t\t\t\tRatingRender.setReaction({\n\t\t\t\t\tlikeId: likeId,\n\t\t\t\t\trating: likeInstance,\n\t\t\t\t\taction: 'change',\n\t\t\t\t\tuserReaction: params.REACTION,\n\t\t\t\t\tuserReactionOld: params.REACTION_OLD,\n\t\t\t\t\ttotalCount: params.TOTAL_POSITIVE_VOTES,\n\t\t\t\t\tuserId: params.USER_ID,\n\t\t\t\t});\n\t\t\t}\n\t\t\telse if (\n\t\t\t\tType.isStringFilled(params.REACTION)\n\t\t\t\t&& [ 'ADD', 'CANCEL' ].includes(params.TYPE)\n\t\t\t)\n\t\t\t{\n\t\t\t\tRatingRender.setReaction({\n\t\t\t\t\tlikeId: likeId,\n\t\t\t\t\trating: likeInstance,\n\t\t\t\t\tuserReaction: params.REACTION,\n\t\t\t\t\taction: (params.TYPE === 'ADD' ? 'add' : 'cancel'),\n\t\t\t\t\ttotalCount: params.TOTAL_POSITIVE_VOTES,\n\t\t\t\t\tuserId: params.USER_ID,\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tif (likeInstance.topPanel)\n\t\t{\n\t\t\tlikeInstance.topPanel.setAttribute('data-popup', 'N');\n\t\t}\n\n\t\tif (!likeInstance.userReactionNode)\n\t\t{\n\t\t\tlikeInstance.count.insertBefore(\n\t\t\t\tDom.create('span', {\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tclassName: 'bx-ilike-plus-one',\n\t\t\t\t\t},\n\t\t\t\t\tstyle: {\n\t\t\t\t\t\twidth: `${(element.countText.clientWidth - 8)}px`,\n\t\t\t\t\t\theight: `${(element.countText.clientHeight - 8)}px`,\n\t\t\t\t\t},\n\t\t\t\t\thtml: (params.TYPE === 'ADD'? '+1': '-1'),\n\t\t\t\t}),\n\t\t\t\telement.count.firstChild\n\t\t\t);\n\t\t}\n\n\t\tif (likeInstance.popup)\n\t\t{\n\t\t\tlikeInstance.popup.close();\n\t\t\tlikeInstance.popupContentPage = 1;\n\t\t}\n\t}\n\n\tstatic Vote(likeId, voteAction, voteReaction, voteReactionOld)\n\t{\n\t\tif (!Type.isStringFilled(voteReaction))\n\t\t{\n\t\t\tvoteReaction = 'like';\n\t\t}\n\n\t\tconst ajaxInstance = (RatingManager.mobile ? new MobileAjaxWrapper : ajax);\n\t\tconst likeInstance = this.getInstance(likeId);\n\n\t\tconst successCallback = (response) => {\n\n\t\t\tconst data = response.data;\n\n\t\t\tlikeInstance.lastVote = data.action;\n\t\t\tlikeInstance.lastReaction = voteReaction;\n\n\t\t\tconst key = `${likeInstance.entityTypeId}_${likeInstance.entityId}`;\n\n\t\t\tthis.lastVoteRepo.set(key, data.action);\n\t\t\tthis.lastReactionRepo.set(key, data.voteReaction);\n\n\t\t\tlikeInstance.countText.innerHTML = data.items_all;\n\t\t\tlikeInstance.popupContentPage = 1;\n\t\t\tlikeInstance.popupContent.innerHTML = '';\n\t\t\tlikeInstance.popupContent.appendChild(Dom.create('span', {\n\t\t\t\tprops: {\n\t\t\t\t\tclassName: 'bx-ilike-wait',\n\t\t\t\t},\n\t\t\t}));\n\n\t\t\tif (likeInstance.topPanel)\n\t\t\t{\n\t\t\t\tlikeInstance.topPanel.setAttribute('data-popup', 'N');\n\t\t\t}\n\n\t\t\tListPopup.AdjustWindow(likeId);\n\n\t\t\tconst popup = document.getElementById(`ilike-popup-${likeId}`)\n\t\t\tif (\n\t\t\t\tpopup\n\t\t\t\t&& popup.style.display === 'block'\n\t\t\t)\n\t\t\t{\n\t\t\t\tListPopup.List(likeId, null, '', true);\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\tlikeInstance.version >= 2\n\t\t\t\t&& RatingManager.mobile\n\t\t\t)\n\t\t\t{\n\t\t\t\tBXMobileApp.onCustomEvent('onRatingLike', {\n\t\t\t\t\taction: data.action,\n\t\t\t\t\tratingId: likeId,\n\t\t\t\t\tentityTypeId : likeInstance.entityTypeId,\n\t\t\t\t\tentityId: likeInstance.entityId,\n\t\t\t\t\tvoteAction: voteAction,\n\t\t\t\t\tvoteReaction: voteReaction,\n\t\t\t\t\tvoteReactionOld: voteReactionOld,\n\t\t\t\t\tuserId: Loc.getMessage('USER_ID'),\n\t\t\t\t\tuserData: (!Type.isUndefined(data.user_data) ? data.user_data : null),\n\t\t\t\t\titemsAll: data.items_all,\n\t\t\t\t}, true);\n\t\t\t}\n\t\t};\n\n\t\tconst failureCallback = () => {\n\n\t\t\tconst dataUsers = ((likeInstance.topUsersDataNode)\n\t\t\t\t? JSON.parse(likeInstance.topUsersDataNode.getAttribute('data-users'))\n\t\t\t\t: false\n\t\t\t);\n\n\t\t\tif (likeInstance.version == 2)\n\t\t\t{\n\t\t\t\tif (voteAction === 'change')\n\t\t\t\t{\n\t\t\t\t\tRatingRender.setReaction({\n\t\t\t\t\t\tlikeId: likeId,\n\t\t\t\t\t\trating: likeInstance,\n\t\t\t\t\t\taction: voteAction,\n\t\t\t\t\t\tuserReaction: voteReaction,\n\t\t\t\t\t\tuserReactionOld: voteReactionOld,\n\t\t\t\t\t\ttotalCount: Number(likeInstance.countText.innerHTML),\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tRatingRender.setReaction({\n\t\t\t\t\t\tlikeId: likeId,\n\t\t\t\t\t\trating: likeInstance,\n\t\t\t\t\t\taction: (voteAction === 'cancel' ? 'add' : 'cancel'),\n\t\t\t\t\t\tuserReaction: voteReaction,\n\t\t\t\t\t\ttotalCount: (\n\t\t\t\t\t\t\tvoteAction == 'cancel'\n\t\t\t\t\t\t\t\t? Number(likeInstance.countText.innerHTML) + 1\n\t\t\t\t\t\t\t\t: Number(likeInstance.countText.innerHTML) - 1\n\t\t\t\t\t\t)\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tif (likeInstance.buttonText)\n\t\t\t\t{\n\t\t\t\t\tif (voteAction === 'add')\n\t\t\t\t\t{\n\t\t\t\t\t\tlikeInstance.buttonText.innerHTML = Loc.getMessage('RATING_LIKE_EMOTION_LIKE_CALC');\n\t\t\t\t\t}\n\t\t\t\t\telse if (voteAction === 'change')\n\t\t\t\t\t{\n\t\t\t\t\t\tlikeInstance.buttonText.innerHTML = Loc.getMessage(`RATING_LIKE_EMOTION_${voteReactionOld.toUpperCase()}_CALC`);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tlikeInstance.buttonText.innerHTML = Loc.getMessage(`RATING_LIKE_EMOTION_${voteReaction.toUpperCase()}_CALC`);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\tdataUsers\n\t\t\t\t&& voteAction !== 'change'\n\t\t\t\t&& likeInstance.version == 2\n\t\t\t)\n\t\t\t{\n\t\t\t\tlikeInstance.topUsersText.innerHTML = RatingRender.getTopUsersText({\n\t\t\t\t\tyou: (voteAction === 'cancel'), // negative\n\t\t\t\t\ttop: Object.values(dataUsers.TOP),\n\t\t\t\t\tmore: dataUsers.MORE\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\n\t\tconst analyticsLabel ={\n\t\t\tb24statAction: 'addLike',\n\t\t}\n\n\t\tif (\n\t\t\tlikeInstance.version >= 2\n\t\t\t&& RatingManager.mobile\n\t\t)\n\t\t{\n\t\t\tanalyticsLabel.b24statContext = 'mobile';\n\t\t}\n\n\t\tajaxInstance.runAction('main.rating.vote', {\n\t\t\tdata: {\n\t\t\t\tparams: {\n\t\t\t\t\tRATING_VOTE_TYPE_ID: likeInstance.entityTypeId,\n\t\t\t\t\tRATING_VOTE_ENTITY_ID: likeInstance.entityId,\n\t\t\t\t\tRATING_VOTE_ACTION: voteAction,\n\t\t\t\t\tRATING_VOTE_REACTION: voteReaction,\n\t\t\t\t},\n\t\t\t},\n\t\t\tanalyticsLabel: analyticsLabel,\n\t\t}).then(\n\t\t\tsuccessCallback,\n\t\t\tfailureCallback\n\t\t);\n\n\t\treturn false;\n\t}\n\n\tstatic LiveUpdate(params)\n\t{\n\t\tif (Number(params.USER_ID) === Number(Loc.getMessage('USER_ID')))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.repo.forEach((likeInstance, likeId) => {\n\t\t\tif (\n\t\t\t\tlikeInstance.entityTypeId !== params.ENTITY_TYPE_ID\n\t\t\t\t|| Number(likeInstance.entityId) !== Number(params.ENTITY_ID)\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.Draw(likeId, params);\n\t\t});\n\n\n\t\tRatingManager.live(params);\n\t}\n\n\tstatic Set(likeId, entityTypeId, entityId, available, userId, localize, template, pathToUserProfile, pathToAjax, mobile)\n\t{\n\t\tmobile = !!mobile;\n\n\t\tif (template === undefined)\n\t\t{\n\t\t\ttemplate = 'standart';\n\t\t}\n\n\t\tif (this.additionalParams.get('pathToUserProfile'))\n\t\t{\n\t\t\tpathToUserProfile = this.additionalParams.get('pathToUserProfile');\n\t\t}\n\n\t\tlet likeInstance = this.getInstance(likeId);\n\n\t\tif (likeInstance && likeInstance.tryToSet > 5)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst tryToSend = likeInstance && likeInstance.tryToSet ? likeInstance.tryToSet : 1;\n\n\t\tlikeInstance = new RatingLike(likeId, entityTypeId, entityId, available, userId, localize, template, pathToUserProfile);\n\t\tthis.setInstance(\n\t\t\tlikeId,\n\t\t\tlikeInstance\n\t\t);\n\n\t\tif (likeInstance.enabled)\n\t\t{\n\t\t\tthis.Init(likeId, {\n\t\t\t\tmobile: mobile,\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tsetTimeout(() => {\n\t\t\t\tlikeInstance.tryToSet = tryToSend + 1;\n\t\t\t\tthis.Set(likeId, entityTypeId, entityId, available, userId, localize, template, pathToUserProfile, pathToAjax, mobile);\n\t\t\t}, 500);\n\t\t}\n\t}\n\n\tstatic setParams(params)\n\t{\n\t\tif (!Type.isUndefined(params.pathToUserProfile))\n\t\t{\n\t\t\tthis.additionalParams.set('pathToUserProfile', params.pathToUserProfile);\n\t\t}\n\t}\n\n\tstatic Init(likeId, params)\n\t{\n\t\tparams = (!Type.isUndefined(params) ? params : {});\n\n\t\tRatingManager.init(params);\n\n\t\tconst likeInstance = this.getInstance(likeId);\n\n\t\t// like/unlike button\n\t\tif (likeInstance.available)\n\t\t{\n\t\t\tlet eventNode = (\n\t\t\t\tlikeInstance.template === 'standart'\n\t\t\t\t\t? likeInstance.button\n\t\t\t\t\t: likeInstance.buttonText\n\t\t\t);\n\n\t\t\tif (!RatingManager.mobile)\n\t\t\t{\n\t\t\t\tconst eventNodeNew = eventNode.closest('.feed-new-like');\n\t\t\t\tif (eventNodeNew)\n\t\t\t\t{\n\t\t\t\t\teventNode = eventNodeNew;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\tlikeInstance.version >= 2\n\t\t\t\t&& RatingManager.mobile\n\t\t\t)\n\t\t\t{\n\t\t\t\teventNode.removeEventListener('touchstart', this.mobileTouchStartHandler);\n\t\t\t\teventNode.addEventListener('touchstart', this.mobileTouchStartHandler);\n\t\t\t}\n\n\t\t\tconst eventName = (RatingManager.mobile ? 'touchend' : 'click');\n\t\t\teventNode.removeEventListener(eventName, this.buttonClickHandler);\n\t\t\teventNode.addEventListener(eventName, this.buttonClickHandler);\n\n\t\t\tif (!RatingManager.mobile)\n\t\t\t{\n\t\t\t\t// Hover/unHover like-button\n\t\t\t\tlikeInstance.box.addEventListener('mouseover', () => {\n\t\t\t\t\tlikeInstance.box.classList.add('bx-ilike-button-hover');\n\t\t\t\t});\n\t\t\t\tlikeInstance.box.addEventListener('mouseout', () => {\n\t\t\t\t\tlikeInstance.box.classList.remove('bx-ilike-button-hover');\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tlikeInstance.topPanel.removeEventListener('click', this.mobileTopPanelClickHandler);\n\t\t\t\tlikeInstance.topPanel.addEventListener('click', this.mobileTopPanelClickHandler);\n\t\t\t}\n\t\t}\n\t\telse if (Type.isDomNode(likeInstance.buttonText))\n\t\t{\n\t\t\tlikeInstance.buttonText.innerHTML = likeInstance.localize['LIKE_D'];\n\t\t\tlikeInstance.buttonText.classList.add('bx-ilike-text-unavailable');\n\t\t}\n\t\t// get like-user-list\n\t\tconst clickShowPopupNode = (likeInstance.topUsersText ? likeInstance.topUsersText : likeInstance.count);\n\n\t\tif (!RatingManager.mobile)\n\t\t{\n\t\t\tclickShowPopupNode.addEventListener('mouseenter', (e) => {\n\t\t\t\tListPopup.onResultMouseEnter({\n\t\t\t\t\tlikeId: likeId,\n\t\t\t\t\tevent: e,\n\t\t\t\t\tnodeId: e.currentTarget.id,\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tclickShowPopupNode.addEventListener('mouseleave', (e) => {\n\t\t\t\tListPopup.onResultMouseLeave({\n\t\t\t\t\tlikeId: likeId,\n\t\t\t\t});\n\t\t\t})\n\n\t\t\tclickShowPopupNode.addEventListener('click', (e) => {\n\t\t\t\tListPopup.onResultClick({\n\t\t\t\t\tlikeId: likeId,\n\t\t\t\t\tevent: e,\n\t\t\t\t\tnodeId: e.currentTarget.id,\n\t\t\t\t});\n\t\t\t})\n\t\t}\n\n\t\tif (\n\t\t\tlikeInstance.version === 2\n\t\t\t&& likeInstance.available\n\t\t\t&& likeInstance.userReactionNode\n\t\t)\n\t\t{\n\t\t\tRatingRender.bindReactionsPopup({\n\t\t\t\tlikeId: likeId,\n\t\t\t});\n\t\t}\n\t}\n\n\tstatic mobileTouchStartHandler()\n\t{\n\t\tRatingManager.startScrollTop = (\n\t\t\t(\n\t\t\t\tdocument.documentElement\n\t\t\t\t&& document.documentElement.scrollTop\n\t\t\t)\n\t\t\t|| document.body.scrollTop\n\t\t);\n\t}\n\n\tstatic buttonClickHandler(e)\n\t{\n\t\tconst likeInstanceNode = e.currentTarget.closest('[data-rating-vote-id]');\n\t\tif (!Type.isDomNode(likeInstanceNode))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst likeId = likeInstanceNode.getAttribute('data-rating-vote-id');\n\t\tif (!Type.isStringFilled(likeId))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst likeInstance = RatingLike.getInstance(likeId);\n\n\t\tif (\n\t\t\tlikeInstance.version >= 2\n\t\t\t&& RatingManager.mobile\n\t\t\t&& RatingRender.blockTouchEndByScroll\n\t\t)\n\t\t{\n\t\t\tRatingRender.blockTouchEndByScroll = false;\n\t\t\treturn;\n\t\t}\n\n\t\tif (\n\t\t\tlikeInstance.version < 2\n\t\t\t|| !RatingManager.mobile\n\t\t\t|| !RatingRender.reactionsPopupLikeId\n\t\t)\n\t\t{\n\t\t\tif (\n\t\t\t\tlikeInstance.version >= 2\n\t\t\t\t&& RatingManager.mobile\n\t\t\t)\n\t\t\t{\n\t\t\t\tconst currentScrollTop = (\n\t\t\t\t\t(\n\t\t\t\t\t\tdocument.documentElement\n\t\t\t\t\t\t&& document.documentElement.scrollTop\n\t\t\t\t\t)\n\t\t\t\t\t|| document.body.scrollTop\n\t\t\t\t);\n\n\t\t\t\tif (Math.abs(currentScrollTop - RatingManager.startScrollTop) > 2)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tRatingLike.ClickVote(e, likeId);\n\t\t}\n\n\t\tif (likeInstance.version == 2)\n\t\t{\n\t\t\tRatingRender.afterClick({\n\t\t\t\tlikeId: likeId,\n\t\t\t});\n\t\t}\n\n\t\te.preventDefault();\n\t}\n\n\tstatic mobileTopPanelClickHandler(e)\n\t{\n\t\tconst likeInstanceNode = e.currentTarget.querySelector('[data-like-id]');\n\t\tif (!Type.isDomNode(likeInstanceNode))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst likeId = likeInstanceNode.getAttribute('data-like-id');\n\t\tif (!Type.isStringFilled(likeId))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst likeInstance = RatingLike.getInstance(likeId);\n\n\t\tRatingRender.openMobileReactionsPage({\n\t\t\tentityTypeId: likeInstance.entityTypeId,\n\t\t\tentityId: likeInstance.entityId,\n\t\t});\n\t\te.stopPropagation();\n\t}\n}\n","import { Type } from 'main.core';\n\nimport { RatingLike } from './like.js';\nimport { RatingManager } from './manager.js';\nimport { RatingRender } from './render.js';\n\nif (Type.isUndefined(window.BXRL))\n{\n\twindow.BXRL = {};\n}\nwindow.BXRL.manager = RatingManager;\nwindow.BXRL.render = RatingRender;\n\nwindow.RatingLike = RatingLike;\n"],"names":["ListPopup","params","likeId","likeInstance","RatingLike","getInstance","target","reaction","nodeId","popupLikeId","popupContentPage","List","popupTimeoutIdShow","setTimeout","getListPopupShow","resultPopupAnimation","getListPopupAnimation","mouseInShowPopupNode","OpenWindow","clickEvent","targetId","Number","countText","innerHTML","bindNode","template","count","version","Type","isDomNode","isStringFilled","document","getElementById","box","popup","globalZIndex","getGlobalIndex","popupClassNameList","topPanel","push","RatingManager","mobile","Popup","id","bindElement","lightShadow","offsetTop","offsetLeft","isUndefined","isNull","offsetX","autoHide","closeByEsc","zIndexAbsolute","bindOptions","position","animation","events","onPopupClose","onPopupDestroy","content","className","join","setAngle","addEventListener","clearTimeout","popupTimeout","close","setBindElement","popupLikeInstance","show","AdjustWindow","element","index","propertyValue","Dom","style","isNaN","parseInt","offsetParent","tagName","EventEmitter","unsubscribe","BX","SidePanel","Instance","getTopSlider","getWindow","removeOnCloseHandler","forceBindPosition","adjustPosition","contentContainerNodeList","popupContent","querySelectorAll","length","forEach","contentContainerNode","e","scrollTop","scrollHeight","offsetHeight","RatingRender","popupCurrentReaction","Event","unbindAll","page","clear","popupPagesList","clearPopupContent","listXHR","abort","ajax","runAction","data","RATING_VOTE_TYPE_ID","entityTypeId","RATING_VOTE_ENTITY_ID","entityId","RATING_VOTE_LIST_PAGE","RATING_VOTE_REACTION","PATH_TO_USER_PROFILE","pathToUserProfile","onrequeststart","xhr","then","result","onListSuccess","items_all","items_page","buildPopupContent","rating","setAttribute","buildPopupContentNoReactions","PopupScroll","event","isShown","popupTimeoutIdList","getAttribute","currentTarget","mouseEnterEvent","getListPopup","removeOnClose","bind","currentUserId","Loc","getMessage","you","topList","top","isArray","more","ID","NAME_FORMATTED","WEIGHT","replace","sort","a","b","parseFloat","userNameList","map","item","userNameBegin","userNameEnd","pop","slice","i","userReactionNode","action","includes","userReaction","userReactionOld","totalCount","userId","getNode","reactionsNode","topPanelContainer","topUsersText","buttonText","elements","elementsNew","classList","add","contains","remove","reactionsContainer","querySelector","found","newValue","reactionValue","reactionCount","animate","clean","commentNode","closest","drawReactions","container","toUpperCase","parentElement","toLowerCase","reactionEvents","click","resultReactionClick","mouseenter","resultReactionMouseEnter","mouseleave","resultReactionMouseLeave","reactionsData","appendChild","create","props","attrs","title","JSON","stringify","reactionsPopupLikeId","reactionsPopup","reactionsNodesList","reactionsList","currentEmotion","children","reactionNode","ClickVote","preventDefault","append","body","reactionsPopupMouseOutHandler","getReactionsPopupMouseOutHandler","bindElementPosition","pos","left","inverted","GetWindowSize","deltaY","touchMoveDeltaY","adjust","width","borderRadius","reactionsPopupMobileDisableScroll","reactionsPopupAnimation","easing","duration","start","opacity","finish","transition","makeEaseInOut","transitions","cubic","step","state","reactionsPopupOpacityState","complete","reactions","reactionsPopupAnimation2","touchScrollTop","hasMobileTouchMoved","window","reactionsPopupMobileTouchEndHandler","reactionsPopupMobileTouchMoveHandler","coords","x","changedTouches","pageX","y","pageY","reactionsPopupMobileGetHoverNode","reactionsPopupMobileHideHandler","removeEventListener","touchStartPosition","touches","touchCurrentPosition","reactionsPopupMobileCheckTouchMove","currentReactionNodeHover","reactionsPopupMobileRemoveHover","reactionsPopupMobileAddHover","blockShowPopupTimeout","blockShowPopup","reactionsPopupMobileEnableScroll","stop","reactionsPopupAnimation4","linear","bindReactionsPopup","Math","abs","hideReactionsPopup","elementFromPoint","touchMoveScrollListener","passive","emit","mobileOverlay","mouseOverHandler","Runtime","debounce","getMouseOverHandler","blockReactionsPopup","popupPosition","getBoundingClientRect","clientX","right","clientY","bottom","afterClickBlockShowPopup","app","exec","showReactionsPopup","Boolean","requestReaction","reactionsCount","popupSizeInitialized","height","minWidth","isPlainObject","Object","entries","tabsNode","headClassList","html","changePopupTab","sample","like","kiss","laugh","wonder","cry","angry","facepalm","reactionData","headItemClassList","popupContentPosition","usersNode","usersNodeExists","contentNode","reactionUsersNode","items","userItemClassList","USER_TYPE","href","URL","PHOTO_SRC","FULL_NAME","waitNode","tabsNodeOld","parentNode","insertBefore","removeChild","tabNode","reactionTabNode","avatarNode","src","imgClassList","afterClickHandler","getAfterClickHandler","isSet","onResultClick","stopPropagation","onResultMouseEnter","onResultMouseLeave","BXMobileApp","PageManager","loadPageBlank","url","backdrop","mediumPositionPercent","cache","eventData","repo","voteAction","button","Draw","TYPE","USER_ID","ENTITY_TYPE_ID","ENTITY_ID","USER_DATA","userData","REACTION","voteReaction","REACTION_OLD","voteReactionOld","TOTAL_POSITIVE_VOTES","itemsAll","ratingEmojiSelectorPopup","node","reactionsPopupMobileTouchEnd","reactionsPopupMobileTouchMove","reactionsPopupMobileHide","initialized","setDisplayHeight","throttle","getInViewScope","subscribe","onMobileCommentsGet","addCustomEvent","onRatingLike","command","LiveUpdate","getCompatData","displayHeight","documentElement","clientHeight","ratingNode","delayedList","value","key","isNodeVisibleOnScreen","fireAnimation","ratingNodeList","set","get","visibleAreaTop","visibleAreaBottom","ratingObject","entityList","addNode","checkEntity","addDelayed","liveParams","delayedListItem","Map","available","localize","isObject","arguments","enabled","topUsersDataNode","popupId","likeTimeout","parse","lastVoteRepo","lastVote","lastReactionRepo","lastReaction","addEntity","BXRL","forceAdd","active","change","getUserReaction","Vote","setReaction","dataUsers","TOP","values","getTopUsersText","MORE","cont","likeNode","cloneNode","type","whiteSpace","visibility","prepend","scale","quad","transform","likeThumbNode","propsStart","propsFinish","userWeight","usersData","recalcNeeded","find","filter","clientWidth","firstChild","ajaxInstance","MobileAjaxWrapper","successCallback","response","display","onCustomEvent","ratingId","user_data","failureCallback","analyticsLabel","b24statAction","b24statContext","RATING_VOTE_ACTION","live","pathToAjax","undefined","additionalParams","tryToSet","tryToSend","setInstance","Init","Set","init","eventNode","eventNodeNew","mobileTouchStartHandler","eventName","buttonClickHandler","mobileTopPanelClickHandler","clickShowPopupNode","startScrollTop","likeInstanceNode","blockTouchEndByScroll","currentScrollTop","afterClick","openMobileReactionsPage","manager","render"],"mappings":";;;;KAQaA,SAAb;CAAA;CAAA;CAAA;;CAAA;CAAA;CAAA,iCAMqBC,MANrB,EAOC;CAAA;;CACC,UAAMC,MAAM,GAAGD,MAAM,CAACC,MAAtB;CACA,UAAMC,YAAY,GAAGC,YAAU,CAACC,WAAX,CAAuBH,MAAvB,CAArB;CACA,UAAMI,MAAM,GAAGL,MAAM,CAACK,MAAtB;CACA,UAAMC,QAAQ,GAAGN,MAAM,CAACM,QAAxB;CACA,UAAMC,MAAM,GAAGP,MAAM,CAACO,MAAtB;;CAEA,UAAI,KAAKC,WAAL,KAAqBP,MAAzB,EACA;CACC,eAAO,KAAP;CACA;;CAED,UAAIC,YAAY,CAACO,gBAAb,IAAiC,CAArC,EACA;CACC;CACA;;CAED,WAAKC,IAAL,CAAUT,MAAV,EAAkB,CAAlB,EAAqBK,QAArB,EAA+B,IAA/B;CAEAJ,MAAAA,YAAY,CAACS,kBAAb,GAAkCC,UAAU,CAAC,YAAM;CAClD,QAAA,KAAI,CAACC,gBAAL,CAAsB;CACrBZ,UAAAA,MAAM,EAAEA,MADa;CAErBK,UAAAA,QAAQ,EAAEA,QAFW;CAGrBD,UAAAA,MAAM,EAAEA,MAHa;CAIrBE,UAAAA,MAAM,EAAEA;CAJa,SAAtB;CAMA,OAP2C,EAOzC,GAPyC,CAA5C;CAQA;CAlCF;CAAA;CAAA,qCAoCyBP,MApCzB,EAqCC;CAAA;;CACC,UAAMC,MAAM,GAAGD,MAAM,CAACC,MAAtB;CACA,UAAMC,YAAY,GAAGC,YAAU,CAACC,WAAX,CAAuBH,MAAvB,CAArB;CACA,UAAMI,MAAM,GAAGL,MAAM,CAACK,MAAtB;CACA,UAAMC,QAAQ,GAAGN,MAAM,CAACM,QAAxB;CACA,UAAMC,MAAM,GAAGP,MAAM,CAACO,MAAtB;CAEAL,MAAAA,YAAY,CAACY,oBAAb,GAAoC,IAApC;CAEAF,MAAAA,UAAU,CAAC,YAAM;CAChB,QAAA,MAAI,CAACG,qBAAL,CAA2B;CAC1Bd,UAAAA,MAAM,EAAEA;CADkB,SAA3B;CAGA,OAJS,EAIP,GAJO,CAAV;;CAMA,UAAIC,YAAY,CAACc,oBAAb,CAAkCV,QAAlC,CAAJ,EACA;CACC,aAAKW,UAAL,CACChB,MADD,EAEC,IAFD,EAGCI,MAHD,EAICE,MAJD;CAMA;CACD;CA7DF;CAAA;CAAA,0CA+D8BP,MA/D9B,EAgEC;CACC,UAAMC,MAAM,GAAGD,MAAM,CAACC,MAAtB;CACA,UAAMC,YAAY,GAAGC,YAAU,CAACC,WAAX,CAAuBH,MAAvB,CAArB;CAEAC,MAAAA,YAAY,CAACY,oBAAb,GAAoC,KAApC;CACA;CArEF;CAAA;CAAA,+BAuEmBb,MAvEnB,EAuE2BiB,UAvE3B,EAuEuCb,MAvEvC,EAuE+Cc,QAvE/C,EAwEC;CAAA;;CACC,UAAMjB,YAAY,GAAGC,YAAU,CAACC,WAAX,CAAuBH,MAAvB,CAArB;;CAEA,UAAImB,MAAM,CAAClB,YAAY,CAACmB,SAAb,CAAuBC,SAAxB,CAAN,KAA6C,CAAjD,EACA;CACC;CACA;;CAED,UAAMC,QAAQ,GACbrB,YAAY,CAACsB,QAAb,KAA0B,UAA1B,GACGtB,YAAY,CAACuB,KADhB,GAGEvB,YAAY,CAACwB,OAAb,KAAyB,CAAzB,GAEEC,cAAI,CAACC,SAAL,CAAevB,MAAf,IACGA,MADH,GAGEsB,cAAI,CAACE,cAAL,CAAoBV,QAApB,KAAiCW,QAAQ,CAACC,cAAT,CAAwBZ,QAAxB,CAAjC,GACGW,QAAQ,CAACC,cAAT,CAAwBZ,QAAxB,CADH,GAEG,IAPP,GAUGjB,YAAY,CAAC8B,GAdnB;;CAkBA,UAAI,CAACL,cAAI,CAACC,SAAL,CAAeL,QAAf,CAAL,EACA;CACC;CACA;;CAED,UAAIrB,YAAY,CAAC+B,KAAb,IAAsB,IAA1B,EACA;CACC,YAAMC,YAAY,GAAG,KAAKC,cAAL,CAAoBZ,QAApB,CAArB;CAEA,YAAMa,kBAAkB,GAAG,EAA3B;;CACA,YAAIlC,YAAY,CAACmC,QAAjB,EACA;CACCD,UAAAA,kBAAkB,CAACE,IAAnB,CAAwB,gCAAxB;CACA;;CACD,YAAIC,aAAa,CAACC,MAAlB,EACA;CACCJ,UAAAA,kBAAkB,CAACE,IAAnB,CAAwB,sBAAxB;CACA;;CAEDpC,QAAAA,YAAY,CAAC+B,KAAb,GAAqB,IAAIQ,gBAAJ,CAAU;CAC9BC,UAAAA,EAAE,wBAAiBzC,MAAjB,CAD4B;CAE9B0C,UAAAA,WAAW,EAAEpB,QAFiB;CAG9BqB,UAAAA,WAAW,EAAG,IAHgB;CAI9BC,UAAAA,SAAS,EAAE,CAJmB;CAK9BC,UAAAA,UAAU,EACT,CAACnB,cAAI,CAACoB,WAAL,CAAiB7B,UAAjB,CAAD,IACG,CAACS,cAAI,CAACqB,MAAL,CAAY9B,UAAZ,CADJ,IAEG,CAACS,cAAI,CAACoB,WAAL,CAAiB7B,UAAU,CAAC+B,OAA5B,CAFJ,GAGI/B,UAAU,CAAC+B,OAAX,GAAqB,GAHzB,GAII/C,YAAY,CAACwB,OAAb,IAAwB,CAAxB,GAA4B,CAAC,EAA7B,GAAkC,CAVT;CAY9BwB,UAAAA,QAAQ,EAAE,IAZoB;CAa9BC,UAAAA,UAAU,EAAE,IAbkB;CAc9BC,UAAAA,cAAc,EAAGlB,YAAY,GAAG,IAAf,GAAsBA,YAAY,GAAG,CAArC,GAAyC,IAd5B;CAe9BmB,UAAAA,WAAW,EAAE;CACZC,YAAAA,QAAQ,EAAE;CADE,WAfiB;CAkB9BC,UAAAA,SAAS,EAAE,cAlBmB;CAmB9BC,UAAAA,MAAM,EAAE;CACPC,YAAAA,YAAY,EAAE,wBAAM;CACnB,cAAA,MAAI,CAACjD,WAAL,GAAmB,IAAnB;CACA,aAHM;CAIPkD,YAAAA,cAAc,EAAE,0BAAM;CAJf,WAnBsB;CAyB9BC,UAAAA,OAAO,EAAG7B,QAAQ,CAACC,cAAT,+BAA+C9B,MAA/C,EAzBoB;CA0B9B2D,UAAAA,SAAS,EAAExB,kBAAkB,CAACyB,IAAnB,CAAwB,GAAxB;CA1BmB,SAAV,CAArB;;CA6BA,YACC,CAAC3D,YAAY,CAACmC,QAAd,IACG,CAACE,aAAa,CAACC,MAFnB,EAIA;CACCtC,UAAAA,YAAY,CAAC+B,KAAb,CAAmB6B,QAAnB,CAA4B,EAA5B;CAEAhC,UAAAA,QAAQ,CAACC,cAAT,uBAAuC9B,MAAvC,GAAiD8D,gBAAjD,CAAkE,UAAlE,EAA8E,YAAM;CACnFC,YAAAA,YAAY,CAAC9D,YAAY,CAAC+D,YAAd,CAAZ;CACA/D,YAAAA,YAAY,CAAC+D,YAAb,GAA4BrD,UAAU,CAAC,YAAM;CAC5CV,cAAAA,YAAY,CAAC+B,KAAb,CAAmBiC,KAAnB;CACA,aAFqC,EAEnC,IAFmC,CAAtC;CAGA,WALD;CAOApC,UAAAA,QAAQ,CAACC,cAAT,uBAAuC9B,MAAvC,GAAiD8D,gBAAjD,CAAkE,WAAlE,EAA+E,YAAM;CACpFC,YAAAA,YAAY,CAAC9D,YAAY,CAAC+D,YAAd,CAAZ;CACA,WAFD;CAGA;CACD,OA7DD,MA+DA;CACC,YACC,CAACtC,cAAI,CAACoB,WAAL,CAAiB7B,UAAjB,CAAD,IACG,CAACS,cAAI,CAACqB,MAAL,CAAY9B,UAAZ,CADJ,IAEG,CAACS,cAAI,CAACoB,WAAL,CAAiB7B,UAAU,CAAC+B,OAA5B,CAHL,EAKA;CACC/C,UAAAA,YAAY,CAAC+B,KAAb,CAAmBa,UAAnB,GAAiC5B,UAAU,CAAC+B,OAAX,GAAqB,GAAtD;CACA;;CAED/C,QAAAA,YAAY,CAAC+B,KAAb,CAAmBkC,cAAnB,CAAkC5C,QAAlC;CACA;;CAED,UAAI,KAAKf,WAAL,KAAqBP,MAAzB,EACA;CACC,YAAMmE,iBAAiB,GAAGjE,YAAU,CAACC,WAAX,CAAuB,KAAKI,WAA5B,CAA1B;;CACA,YAAI4D,iBAAJ,EACA;CACCA,UAAAA,iBAAiB,CAACnC,KAAlB,CAAwBiC,KAAxB;CACA;CACD;;CAED,WAAK1D,WAAL,GAAmBP,MAAnB;CAEAC,MAAAA,YAAY,CAAC+B,KAAb,CAAmBoC,IAAnB;CAEA,WAAKC,YAAL,CAAkBrE,MAAlB;CACA;CAjMF;CAAA;CAAA,mCAmMuBsE,OAnMvB,EAoMC;CACC,UAAIC,KAAK,GAAG,CAAZ;CACA,UAAIC,aAAa,GAAG,EAApB;;CAEA,SACA;CACCA,QAAAA,aAAa,GAAGC,aAAG,CAACC,KAAJ,CAAUJ,OAAV,EAAmB,SAAnB,CAAhB;;CACA,YAAIE,aAAa,KAAK,MAAtB,EACA;CACCD,UAAAA,KAAK,GAAG,CAACpD,MAAM,CAACwD,KAAP,CAAaC,QAAQ,CAACJ,aAAD,CAArB,CAAD,GAAyCD,KAAzC,GAAiD,CAAzD;CACA;;CACDD,QAAAA,OAAO,GAAGA,OAAO,CAACO,YAAlB;CACA,OARD,QAUCP,OAAO,IACJA,OAAO,CAACQ,OAAR,KAAoB,MAXxB;;CAcA,aAAOP,KAAP;CACA;CAvNF;CAAA;CAAA,oCA0NC;CACCQ,MAAAA,6BAAY,CAACC,WAAb,CAAyBC,EAAE,CAACC,SAAH,CAAaC,QAAb,CAAsBC,YAAtB,GAAqCC,SAArC,EAAzB,EAA2E,0BAA3E,EAAuG,KAAKC,oBAA5G;CAEA,UAAMnB,iBAAiB,GAAGjE,YAAU,CAACC,WAAX,CAAuB,KAAKI,WAA5B,CAA1B;;CACA,UAAI4D,iBAAJ,EACA;CACCA,QAAAA,iBAAiB,CAACnC,KAAlB,CAAwBiC,KAAxB;CACA;CACD;CAlOF;CAAA;CAAA,iCAoOqBjE,MApOrB,EAqOC;CACC,UAAIC,YAAY,GAAGC,YAAU,CAACC,WAAX,CAAuBH,MAAvB,CAAnB;;CAEA,UAAI,CAACC,YAAY,CAAC+B,KAAlB,EACA;CACC;CACA;;CAED/B,MAAAA,YAAY,CAAC+B,KAAb,CAAmBoB,WAAnB,CAA+BmC,iBAA/B,GAAmD,IAAnD;CACAtF,MAAAA,YAAY,CAAC+B,KAAb,CAAmBwD,cAAnB;CACAvF,MAAAA,YAAY,CAAC+B,KAAb,CAAmBoB,WAAnB,CAA+BmC,iBAA/B,GAAmD,KAAnD;CACA;CAhPF;CAAA;CAAA,gCAkPoBvF,MAlPpB,EAmPC;CAAA;;CACC,UAAMC,YAAY,GAAGC,YAAU,CAACC,WAAX,CAAuBH,MAAvB,CAArB;CAEA,UAAIyF,wBAAwB,GAAGxF,YAAY,CAACyF,YAAb,CAA0BC,gBAA1B,CAA2C,yBAA3C,CAA/B,CAHD;;CAIC,UAAIF,wBAAwB,CAACG,MAAzB,IAAmC,CAAvC,EACA;CACCH,QAAAA,wBAAwB,GAAG,CAAExF,YAAY,CAACyF,YAAf,CAA3B;CACA;;CAEDD,MAAAA,wBAAwB,CAACI,OAAzB,CAAiC,UAACC,oBAAD,EAA0B;CAC1DA,QAAAA,oBAAoB,CAAChC,gBAArB,CAAsC,QAAtC,EAAgD,UAACiC,CAAD,EAAO;CACtD,cAAIA,CAAC,CAAC3F,MAAF,CAAS4F,SAAT,IAAsB,CAACD,CAAC,CAAC3F,MAAF,CAAS6F,YAAT,GAAwBF,CAAC,CAAC3F,MAAF,CAAS8F,YAAlC,IAAkD,GAA5E,EACA;CACC;CACA;;CACD,UAAA,MAAI,CAACzF,IAAL,CAAUT,MAAV,EAAkB,IAAlB,EAAyBC,YAAY,CAACwB,OAAb,IAAwB,CAAxB,GAA4B0E,YAAY,CAACC,oBAAzC,GAAgE,KAAzF;;CACAC,UAAAA,eAAK,CAACC,SAAN,CAAgBP,CAAC,CAAC3F,MAAlB;CACA,SAPD;CAQA,OATD;CAUA;CAtQF;CAAA;CAAA,yBAwQaJ,MAxQb,EAwQqBuG,IAxQrB,EAwQ2BlG,QAxQ3B,EAwQqCmG,KAxQrC,EAyQC;CAAA;;CACC,UAAMvG,YAAY,GAAGC,YAAU,CAACC,WAAX,CAAuBH,MAAvB,CAArB;;CAEA,UAAImB,MAAM,CAAClB,YAAY,CAACmB,SAAb,CAAuBC,SAAxB,CAAN,KAA6C,CAAjD,EACA;CACC,eAAO,KAAP;CACA;;CAEDhB,MAAAA,QAAQ,GAAIqB,cAAI,CAACE,cAAL,CAAoBvB,QAApB,IAAgCA,QAAhC,GAA2C,EAAvD;;CAEA,UAAIqB,cAAI,CAACqB,MAAL,CAAYwD,IAAZ,CAAJ,EACA;CACCA,QAAAA,IAAI,GACHtG,YAAY,CAACwB,OAAb,KAAyB,CAAzB,GAEE,CAACC,cAAI,CAACoB,WAAL,CAAiBqD,YAAY,CAACM,cAAb,CAA4BpG,QAA5B,CAAjB,CAAD,GACG8F,YAAY,CAACM,cAAb,CAA4BpG,QAA5B,CADH,GAEG,CAJL,GAMGJ,YAAY,CAACO,gBAPjB;CASA;;CAED,UACCgG,KAAK,IACFrF,MAAM,CAACoF,IAAD,CAAN,KAAiB,CADpB,IAEGtG,YAAY,CAACwB,OAAb,KAAyB,CAH7B,EAKA;CACC0E,QAAAA,YAAY,CAACO,iBAAb,CAA+B;CAC9B1G,UAAAA,MAAM,EAAEA;CADsB,SAA/B;CAGA;;CAED,UAAIC,YAAY,CAAC0G,OAAjB,EACA;CACC1G,QAAAA,YAAY,CAAC0G,OAAb,CAAqBC,KAArB;CACA;;CAEDC,MAAAA,cAAI,CAACC,SAAL,CAAe,kBAAf,EAAmC;CAClCC,QAAAA,IAAI,EAAE;CACLhH,UAAAA,MAAM,EAAE;CACPiH,YAAAA,mBAAmB,EAAE/G,YAAY,CAACgH,YAD3B;CAEPC,YAAAA,qBAAqB,EAAEjH,YAAY,CAACkH,QAF7B;CAGPC,YAAAA,qBAAqB,EAAEb,IAHhB;CAIPc,YAAAA,oBAAoB,EAAGhH,QAAQ,KAAK,KAAb,GAAqB,EAArB,GAA0BA,QAJ1C;CAKPiH,YAAAA,oBAAoB,EAAErH,YAAY,CAACsH;CAL5B;CADH,SAD4B;CAUlCC,QAAAA,cAAc,EAAE,wBAACC,GAAD,EAAS;CACxBxH,UAAAA,YAAY,CAAC0G,OAAb,GAAuBc,GAAvB;CACA;CAZiC,OAAnC,EAaGC,IAbH,CAaQ,UAACC,MAAD,EAAY;CAClB,QAAA,MAAI,CAACC,aAAL,CAAmBD,MAAM,CAACZ,IAA1B,EAAgC;CAC/B/G,UAAAA,MAAM,EAAEA,MADuB;CAE/BK,UAAAA,QAAQ,EAAEA,QAFqB;CAG/BkG,UAAAA,IAAI,EAAEA,IAHyB;CAI/BC,UAAAA,KAAK,EAAEA;CAJwB,SAAhC;CAMA,OApBF,EAqBC,YAAM,EArBP;CAwBA,aAAO,KAAP;CACA;CAzUF;CAAA;CAAA,kCA2UsBO,IA3UtB,EA2U4BhH,MA3U5B,EA4UC;CACC,UAAI,CAACgH,IAAL,EACA;CACC,eAAO,KAAP;CACA;;CAED,UAAM9G,YAAY,GAAGC,YAAU,CAACC,WAAX,CAAuBJ,MAAM,CAACC,MAA9B,CAArB;CAEAC,MAAAA,YAAY,CAACmB,SAAb,CAAuBC,SAAvB,GAAmC0F,IAAI,CAACc,SAAxC;;CAEA,UAAI1G,MAAM,CAAC4F,IAAI,CAACe,UAAN,CAAN,KAA4B,CAAhC,EACA;CACC,eAAO,KAAP;CACA;;CAED,UAAI7H,YAAY,CAACwB,OAAb,KAAyB,CAA7B,EACA;CACC0E,QAAAA,YAAY,CAAC4B,iBAAb,CAA+B;CAC9B/H,UAAAA,MAAM,EAAED,MAAM,CAACC,MADe;CAE9BK,UAAAA,QAAQ,EAAEN,MAAM,CAACM,QAFa;CAG9B2H,UAAAA,MAAM,EAAE/H,YAHsB;CAI9BsG,UAAAA,IAAI,EAAExG,MAAM,CAACwG,IAJiB;CAK9BQ,UAAAA,IAAI,EAAEA,IALwB;CAM9BP,UAAAA,KAAK,EAAEzG,MAAM,CAACyG;CANgB,SAA/B;CAQAvG,QAAAA,YAAY,CAACmC,QAAb,CAAsB6F,YAAtB,CAAmC,YAAnC,EAAiD,GAAjD;CACA,OAXD,MAaA;CACC9B,QAAAA,YAAY,CAAC+B,4BAAb,CAA0C;CACzCF,UAAAA,MAAM,EAAE/H,YADiC;CAEzCsG,UAAAA,IAAI,EAAExG,MAAM,CAACwG,IAF4B;CAGzCQ,UAAAA,IAAI,EAAEA;CAHmC,SAA1C;CAKA;;CAED,WAAK1C,YAAL,CAAkBtE,MAAM,CAACC,MAAzB;CACA,WAAKmI,WAAL,CAAiBpI,MAAM,CAACC,MAAxB;CACA;CAlXF;CAAA;CAAA,kCAoXsBD,MApXtB,EAqXC;CACC,UAAMC,MAAM,GAAI0B,cAAI,CAACE,cAAL,CAAoB7B,MAAM,CAACC,MAA3B,IAAqCD,MAAM,CAACC,MAA5C,GAAqD,KAArE;CACA,UAAMiB,UAAU,GAAI,CAACS,cAAI,CAACoB,WAAL,CAAiB/C,MAAM,CAACqI,KAAxB,CAAD,GAAkCrI,MAAM,CAACqI,KAAzC,GAAiD,KAArE;CACA,UAAM/H,QAAQ,GAAIqB,cAAI,CAACE,cAAL,CAAoB7B,MAAM,CAACM,QAA3B,IAAuCN,MAAM,CAACM,QAA9C,GAAyD,EAA3E;CACA,UAAMJ,YAAY,GAAGC,YAAU,CAACC,WAAX,CAAuBH,MAAvB,CAArB;;CAEA,UAAIC,YAAY,CAACY,oBAAjB,EACA;CACC;CACA;;CAED,UACCZ,YAAY,CAAC+B,KAAb,IACG/B,YAAY,CAAC+B,KAAb,CAAmBqG,OAAnB,EAFJ,EAIA;CACCpI,QAAAA,YAAY,CAAC+B,KAAb,CAAmBiC,KAAnB;CACA,OAND,MAQA;CACCF,QAAAA,YAAY,CAAC9D,YAAY,CAACqI,kBAAd,CAAZ;CACAvE,QAAAA,YAAY,CAAC9D,YAAY,CAACS,kBAAd,CAAZ;;CAEA,YACCT,YAAY,CAACO,gBAAb,IAAiC,CAAjC,KAECP,YAAY,CAACmC,QAAb,CAAsBmG,YAAtB,CAAmC,YAAnC,MAAqD,GAArD,IACGtI,YAAY,CAACmG,oBAAb,IAAqC/F,QAHzC,CADD,EAOA;CACC,eAAKI,IAAL,CAAUT,MAAV,EAAkB,CAAlB,EAAqBK,QAArB,EAA+B,IAA/B;CACA;;CAED,aAAKW,UAAL,CACChB,MADD,EAEEiB,UAAU,CAACuH,aAAX,KAA6BvI,YAAY,CAACuB,KAA1C,GAAkD,IAAlD,GAAyDP,UAF3D,EAGCA,UAAU,CAACuH,aAHZ,EAICvH,UAAU,CAACuH,aAAX,CAAyB/F,EAJ1B;CAMA;CACD;CA9ZF;CAAA;CAAA,uCAga2B1C,MAha3B,EAiaC;CAAA;;CACC,UAAMC,MAAM,GAAI0B,cAAI,CAACE,cAAL,CAAoB7B,MAAM,CAACC,MAA3B,IAAqCD,MAAM,CAACC,MAA5C,GAAqD,KAArE;CACA,UAAMyI,eAAe,GAAI,CAAC/G,cAAI,CAACoB,WAAL,CAAiB/C,MAAM,CAACqI,KAAxB,CAAD,GAAkCrI,MAAM,CAACqI,KAAzC,GAAiD,IAA1E;CACA,UAAM/H,QAAQ,GAAIqB,cAAI,CAACE,cAAL,CAAoB7B,MAAM,CAACM,QAA3B,IAAuCN,MAAM,CAACM,QAA9C,GAAyD,EAA3E;CACA,UAAMC,MAAM,GACXmI,eAAe,IAAI/G,cAAI,CAACE,cAAL,CAAoB6G,eAAe,CAACD,aAAhB,CAA8B/F,EAAlD,CAAnB,GACGgG,eAAe,CAACD,aAAhB,CAA8B/F,EADjC,GAEG,EAHJ;CAMA,UAAMxC,YAAY,GAAGC,YAAU,CAACC,WAAX,CAAuBH,MAAvB,CAArB;CAEAC,MAAAA,YAAY,CAACc,oBAAb,CAAkCV,QAAlC,IAA8C,IAA9C;CAEA0D,MAAAA,YAAY,CAAC9D,YAAY,CAACqI,kBAAd,CAAZ;CACAvE,MAAAA,YAAY,CAAC9D,YAAY,CAACS,kBAAd,CAAZ;CAEAT,MAAAA,YAAY,CAACqI,kBAAb,GAAkC3H,UAAU,CAAC,YAAM;CAClD,QAAA,MAAI,CAAC+H,YAAL,CAAkB;CACjB1I,UAAAA,MAAM,EAAEA,MADS;CAEjBI,UAAAA,MAAM,EAAEqI,eAAe,CAACD,aAFP;CAGjBnI,UAAAA,QAAQ,EAAEA,QAHO;CAIjBC,UAAAA,MAAM,EAAEA;CAJS,SAAlB;CAMA,OAP2C,EAOzC,GAPyC,CAA5C;CAQA;CA1bF;CAAA;CAAA,uCA4b2BP,MA5b3B,EA6bC;CACC,UAAMC,MAAM,GAAI0B,cAAI,CAACE,cAAL,CAAoB7B,MAAM,CAACC,MAA3B,IAAqCD,MAAM,CAACC,MAA5C,GAAqD,KAArE;CACA,UAAMK,QAAQ,GAAIqB,cAAI,CAACE,cAAL,CAAoB7B,MAAM,CAACM,QAA3B,IAAuCN,MAAM,CAACM,QAA9C,GAAyD,EAA3E;CACA,UAAMJ,YAAY,GAAGC,YAAU,CAACC,WAAX,CAAuBH,MAAvB,CAArB;CAEAC,MAAAA,YAAY,CAACc,oBAAb,CAAkCV,QAAlC,IAA8C,KAA9C;CACAJ,MAAAA,YAAY,CAACY,oBAAb,GAAoC,KAApC;CACA;CApcF;CAAA;CAAA;6BAAaf,0BAES;6BAFTA,mCAAAA,SAIkB,CAAK6I,aAAL,CAAmBC,IAAnB,CAJlB9I,SAIkB;;KCLlBqG,YAAb;CAAA;CAAA;CAAA;;CAAA;CAAA;CAAA,oCAqCwBpG,MArCxB,EAsCC;CACC,UAAM8I,aAAa,GAAG1H,MAAM,CAAC2H,aAAG,CAACC,UAAJ,CAAe,SAAf,CAAD,CAA5B;CACA,UAAMC,GAAG,GAAI,CAACtH,cAAI,CAACoB,WAAL,CAAiB/C,MAAM,CAACiJ,GAAxB,CAAD,GAAgC,CAAC,CAACjJ,MAAM,CAACiJ,GAAzC,GAA+C,KAA5D;CACA,UAAMC,OAAO,GAAI,CAACvH,cAAI,CAACoB,WAAL,CAAiB/C,MAAM,CAACmJ,GAAxB,CAAD,IAAiCxH,cAAI,CAACyH,OAAL,CAAapJ,MAAM,CAACmJ,GAApB,CAAjC,GAA4DnJ,MAAM,CAACmJ,GAAnE,GAAyE,EAA1F;CACA,UAAME,IAAI,GAAI,CAAC1H,cAAI,CAACoB,WAAL,CAAiB/C,MAAM,CAACqJ,IAAxB,CAAD,GAAiCjI,MAAM,CAACpB,MAAM,CAACqJ,IAAR,CAAvC,GAAuD,CAArE;CACA,UAAIzB,MAAM,GAAG,EAAb;;CAEA,UACCsB,OAAO,CAACrD,MAAR,IAAkB,CAAlB,IACG,CAACoD,GADJ,KAGC1G,aAAa,CAACC,MAAd,IACG6G,IAAI,IAAI,CAJZ,CADD,EAQA;CACC,eAAOzB,MAAP;CACA;;CAED,UAAIrF,aAAa,CAACC,MAAlB,EACA;CACC,YAAIyG,GAAJ,EACA;CACCC,UAAAA,OAAO,CAAC5G,IAAR,CAAa;CACZgH,YAAAA,EAAE,EAAER,aADQ;CAEZS,YAAAA,cAAc,EAAER,aAAG,CAACC,UAAJ,CAAe,2BAAf,CAFJ;CAGZQ,YAAAA,MAAM,EAAE;CAHI,WAAb;CAKA;;CAED5B,QAAAA,MAAM,GAAGmB,aAAG,CAACC,UAAJ,iCAAyCE,OAAO,CAACrD,MAAR,GAAiB,CAAjB,GAAqB,GAArB,GAA2B,GAApE,GACP4D,OADO,CACC,kBADD,EACqBlH,aAAa,CAACC,MAAd,GAAuB,mDAAvB,GAA6E,EADlG,EAEPiH,OAFO,CAEC,gBAFD,EAEmBlH,aAAa,CAACC,MAAd,GAAuB,SAAvB,GAAmC,EAFtD,CAAT;CAGA,OAdD,MAgBA;CACCoF,QAAAA,MAAM,GAAGmB,aAAG,CAACC,UAAJ,iCAAyCC,GAAG,GAAG,MAAH,GAAY,EAAxD,SAA+DC,OAAO,CAACrD,MAAvE,SAAkFwD,IAAI,GAAG,CAAP,GAAW,OAAX,GAAqB,EAAvG,GACPI,OADO,CACC,kBADD,EACqBlH,aAAa,CAACC,MAAd,GAAuB,mDAAvB,GAA6E,EADlG,EAEPiH,OAFO,CAEC,gBAFD,EAEmBlH,aAAa,CAACC,MAAd,GAAuB,SAAvB,GAAmC,EAFtD,EAGPiH,OAHO,CAGC,cAHD,EAGiBlH,aAAa,CAACC,MAAd,GAAuB,+CAAvB,GAAyE,QAH1F,EAIPiH,OAJO,CAIC,YAJD,EAIelH,aAAa,CAACC,MAAd,GAAuB,SAAvB,GAAmC,EAJlD,CAAT;CAKA;;CAED,UAAID,aAAa,CAACC,MAAlB,EACA;CACC0G,QAAAA,OAAO,CAACQ,IAAR,CAAa,UAACC,CAAD,EAAIC,CAAJ,EAAU;CACtB,cAAI/E,QAAQ,CAAC8E,CAAC,CAACL,EAAH,CAAR,KAAmBR,aAAvB,EACA;CACC,mBAAO,CAAC,CAAR;CACA;;CAED,cAAIjE,QAAQ,CAAC+E,CAAC,CAACN,EAAH,CAAR,KAAmBR,aAAvB,EACA;CACC,mBAAO,CAAP;CACA;;CAED,cAAIe,UAAU,CAACF,CAAC,CAACH,MAAH,CAAV,KAAyBK,UAAU,CAACD,CAAC,CAACJ,MAAH,CAAvC,EACA;CACC,mBAAO,CAAP;CACA;;CAED,iBAAQK,UAAU,CAACF,CAAC,CAACH,MAAH,CAAV,GAAuBK,UAAU,CAACD,CAAC,CAACJ,MAAH,CAAjC,GAA8C,CAAC,CAA/C,GAAmD,CAA3D;CACA,SAjBD;CAmBA,YAAMM,YAAY,GAAGZ,OAAO,CAACa,GAAR,CAAY,UAACC,IAAD,EAAU;CAC1C,iBAAOA,IAAI,CAACT,cAAZ;CACA,SAFoB,CAArB;CAIA,YAAIU,aAAa,GAAG,EAApB;CACA,YAAIC,WAAW,GAAG,EAAlB;;CAEA,YAAIJ,YAAY,CAACjE,MAAb,KAAwB,CAA5B,EACA;CACCoE,UAAAA,aAAa,GAAGH,YAAY,CAACK,GAAb,EAAhB;CACAD,UAAAA,WAAW,GAAG,EAAd;CACA,SAJD,MAMA;CACCD,UAAAA,aAAa,GAAGH,YAAY,CAACM,KAAb,CAAmB,CAAnB,EAAsBN,YAAY,CAACjE,MAAb,GAAsB,CAA5C,EACdhC,IADc,CACTkF,aAAG,CAACC,UAAJ,CAAe,0CAAf,EAA2DS,OAA3D,CAAmE,aAAnE,EAAkF,EAAlF,CADS,CAAhB;CAEAS,UAAAA,WAAW,GAAGJ,YAAY,CAACA,YAAY,CAACjE,MAAb,GAAsB,CAAvB,CAA1B;CACA;;CAED+B,QAAAA,MAAM,GAAGA,MAAM,CAAC6B,OAAP,CAAe,mBAAf,EAAoCQ,aAApC,EACPR,OADO,CACC,iBADD,EACoBS,WADpB,CAAT;CAEA,OA1CD,MA4CA;CACChB,QAAAA,OAAO,CAACpD,OAAR,CAAgB,UAACkE,IAAD,EAAOK,CAAP,EAAa;CAE5BzC,UAAAA,MAAM,GAAGA,MAAM,CAAC6B,OAAP,iBACErI,MAAM,CAACiJ,CAAD,CAAN,GAAY,CADd,4DAEmCL,IAAI,CAACT,cAFxC,aAAT;CAIA,SAND;CAQA3B,QAAAA,MAAM,GAAGA,MAAM,CAAC6B,OAAP,CAAe,cAAf,EAA+B,6CAA6CJ,IAA7C,GAAoD,SAAnF,CAAT;CACA;;CAED,aAAOzB,MAAP;CACA;CA1IF;CAAA;CAAA,oCA4IwB5H,MA5IxB,EA6IC;CACC,aACC2B,cAAI,CAACC,SAAL,CAAe5B,MAAM,CAACsK,gBAAtB,IACGtK,MAAM,CAACsK,gBAAP,CAAwB9B,YAAxB,CAAqC,YAArC,CADH,GAEG,EAHJ;CAKA;CAnJF;CAAA;CAAA,gCAqJoBxI,MArJpB,EAsJC;CACC,UACC2B,cAAI,CAACoB,WAAL,CAAiB/C,MAAM,CAACiI,MAAxB,KACG,CAACtG,cAAI,CAACE,cAAL,CAAoB7B,MAAM,CAACC,MAA3B,CAFL,EAIA;CACC;CACA;;CAED,UAAMsK,MAAM,GAAI5I,cAAI,CAACE,cAAL,CAAoB7B,MAAM,CAACuK,MAA3B,IAAqCvK,MAAM,CAACuK,MAA5C,GAAqD,KAArE;;CACA,UAAI,CAAC,CAAC,KAAD,EAAQ,QAAR,EAAkB,QAAlB,EAA4BC,QAA5B,CAAqCD,MAArC,CAAL,EACA;CACC;CACA;;CAED,UAAMtK,MAAM,GAAGD,MAAM,CAACC,MAAtB;CACA,UAAMgI,MAAM,GAAGjI,MAAM,CAACiI,MAAtB;CACA,UAAMwC,YAAY,GAAI9I,cAAI,CAACE,cAAL,CAAoB7B,MAAM,CAACyK,YAA3B,IAA2CzK,MAAM,CAACyK,YAAlD,GAAiE1B,aAAG,CAACC,UAAJ,CAAe,8BAAf,CAAvF;CACA,UAAM0B,eAAe,GAAI/I,cAAI,CAACE,cAAL,CAAoB7B,MAAM,CAAC0K,eAA3B,IAA8C1K,MAAM,CAAC0K,eAArD,GAAuE3B,aAAG,CAACC,UAAJ,CAAe,8BAAf,CAAhG;;CACA,UACCuB,MAAM,KAAK,QAAX,IACGE,YAAY,KAAKC,eAFrB,EAIA;CACC;CACA;;CAED,UAAMC,UAAU,GAAI,CAAChJ,cAAI,CAACoB,WAAL,CAAiB/C,MAAM,CAAC2K,UAAxB,CAAD,GAAuCvJ,MAAM,CAACpB,MAAM,CAAC2K,UAAR,CAA7C,GAAmE,IAAvF;CACA,UAAM7B,aAAa,GAAG1H,MAAM,CAAC2H,aAAG,CAACC,UAAJ,CAAe,SAAf,CAAD,CAA5B;CACA,UAAM4B,MAAM,GAAI,CAACjJ,cAAI,CAACoB,WAAL,CAAiB/C,MAAM,CAAC4K,MAAxB,CAAD,GAAmCxJ,MAAM,CAACpB,MAAM,CAAC4K,MAAR,CAAzC,GAA2D9B,aAA3E;CAEA,UAAMwB,gBAAgB,GAAG,KAAKO,OAAL,CAAa5C,MAAM,CAACqC,gBAApB,CAAzB;CACA,UAAMQ,aAAa,GAAG,KAAKD,OAAL,CAAa5C,MAAM,CAAC6C,aAApB,CAAtB;CACA,UAAMzI,QAAQ,GAAG,KAAKwI,OAAL,CAAa5C,MAAM,CAAC5F,QAApB,CAAjB;CACA,UAAM0I,iBAAiB,GAAG,KAAKF,OAAL,CAAa5C,MAAM,CAAC8C,iBAApB,CAA1B;CACA,UAAMC,YAAY,GAAG,KAAKH,OAAL,CAAa5C,MAAM,CAAC+C,YAApB,CAArB;CACA,UAAM3J,SAAS,GAAG,KAAKwJ,OAAL,CAAa5C,MAAM,CAAC5G,SAApB,CAAlB;CACA,UAAM4J,UAAU,GAAG,KAAKJ,OAAL,CAAa5C,MAAM,CAACgD,UAApB,CAAnB;;CAEA,UACCL,MAAM,KAAK9B,aAAX;CAAA,SACGwB,gBAFJ,EAIA;CACCA,QAAAA,gBAAgB,CAACpC,YAAjB,CAA8B,YAA9B,EAA4C,CAAE,KAAF,EAAS,QAAT,EAAoBsC,QAApB,CAA6BD,MAA7B,IAAuCE,YAAvC,GAAsD,EAAlG;CACA;CAGD,UAAIS,QAAQ,GAAG,EAAf;CACA,UAAIC,WAAW,GAAG,EAAlB;;CAEA,UACCR,UAAU,KAAK,IAAf,IACGtI,QADH,IAEG2I,YAFH,IAGGF,aAJJ,EAMA;CACC,YAAIH,UAAU,GAAG,CAAjB,EACA;CACCI,UAAAA,iBAAiB,CAACK,SAAlB,CAA4BC,GAA5B,CAAgC,4CAAhC;;CAEA,cAAI,CAAChJ,QAAQ,CAAC+I,SAAT,CAAmBE,QAAnB,CAA4B,kCAA5B,CAAL,EACA;CACCjJ,YAAAA,QAAQ,CAAC+I,SAAT,CAAmBC,GAAnB,CAAuB,kCAAvB;CACAL,YAAAA,YAAY,CAACI,SAAb,CAAuBC,GAAvB,CAA2B,+BAA3B;CACAP,YAAAA,aAAa,CAACM,SAAd,CAAwBC,GAAxB,CAA4B,+BAA5B;CACA;CACD,SAVD,MAWK,IAAIV,UAAU,IAAI,CAAlB,EACL;CACCI,UAAAA,iBAAiB,CAACK,SAAlB,CAA4BG,MAA5B,CAAmC,4CAAnC;;CAEA,cAAIlJ,QAAQ,CAAC+I,SAAT,CAAmBE,QAAnB,CAA4B,kCAA5B,CAAJ,EACA;CACCjJ,YAAAA,QAAQ,CAAC+I,SAAT,CAAmBG,MAAnB,CAA0B,kCAA1B;CACAP,YAAAA,YAAY,CAACI,SAAb,CAAuBG,MAAvB,CAA8B,+BAA9B;CACAT,YAAAA,aAAa,CAACM,SAAd,CAAwBG,MAAxB,CAA+B,+BAA/B;CACA;CACD;CACD;;CAED,UACCZ,UAAU,KAAK,IAAf,IACGtJ,SAFJ,EAIA;CACC,YACCsJ,UAAU,IAAI,CAAd,IACG,CAACtJ,SAAS,CAAC+J,SAAV,CAAoBE,QAApB,CAA6B,wCAA7B,CAFL,EAIA;CACCjK,UAAAA,SAAS,CAAC+J,SAAV,CAAoBC,GAApB,CAAwB,wCAAxB;CACA,SAND,MAOK,IACJV,UAAU,GAAG,CAAb,IACGtJ,SAAS,CAAC+J,SAAV,CAAoBE,QAApB,CAA6B,wCAA7B,CAFC,EAIL;CACCjK,UAAAA,SAAS,CAAC+J,SAAV,CAAoBG,MAApB,CAA2B,wCAA3B;CACA;CACD;;CAED,UAAIT,aAAJ,EACA;CACC,YAAMU,kBAAkB,GAAGV,aAAa,CAACW,aAAd,CAA4B,iCAA5B,CAA3B;CACAP,QAAAA,QAAQ,GAAGJ,aAAa,CAAClF,gBAAd,CAA+B,4BAA/B,CAAX;;CAEA,YAAI4F,kBAAJ,EACA;CACC,cAAIE,KAAK,GAAG,KAAZ;CACA,cAAIC,QAAQ,GAAG,KAAf;CAEAT,UAAAA,QAAQ,CAACpF,OAAT,CAAiB,UAACvB,OAAD,EAAa;CAE7B,gBAAMqH,aAAa,GAAGrH,OAAO,CAACiE,YAAR,CAAqB,eAArB,CAAtB;CACA,gBAAMqD,aAAa,GAAGzK,MAAM,CAACmD,OAAO,CAACiE,YAAR,CAAqB,YAArB,CAAD,CAA5B;;CAEA,gBAAIoD,aAAa,KAAKnB,YAAtB,EACA;CACCiB,cAAAA,KAAK,GAAG,IAAR;;CACA,kBAAInB,MAAM,KAAK,QAAf,EACA;CACCoB,gBAAAA,QAAQ,GAAIE,aAAa,GAAG,CAAhB,GAAoBA,aAAa,GAAG,CAApC,GAAwC,CAApD;CACA,eAHD,MAIK,IAAI,CAAE,KAAF,EAAS,QAAT,EAAoBrB,QAApB,CAA6BD,MAA7B,CAAJ,EACL;CACCoB,gBAAAA,QAAQ,GAAGE,aAAa,GAAG,CAA3B;CACA;;CAED,kBAAIF,QAAQ,GAAG,CAAf,EACA;CACCR,gBAAAA,WAAW,CAAC7I,IAAZ,CAAiB;CAChBhC,kBAAAA,QAAQ,EAAEsL,aADM;CAEhBnK,kBAAAA,KAAK,EAAEkK,QAFS;CAGhBG,kBAAAA,OAAO,EAAE;CAHO,iBAAjB;CAKA;CACD,aApBD,MAqBK,IACJvB,MAAM,KAAK,QAAX,IACGqB,aAAa,KAAKlB,eAFjB,EAIL;CACCiB,cAAAA,QAAQ,GAAIE,aAAa,GAAG,CAAhB,GAAoBA,aAAa,GAAG,CAApC,GAAwC,CAApD;;CAEA,kBAAIF,QAAQ,GAAG,CAAf,EACA;CACCR,gBAAAA,WAAW,CAAC7I,IAAZ,CAAiB;CAChBhC,kBAAAA,QAAQ,EAAEsL,aADM;CAEhBnK,kBAAAA,KAAK,EAAEkK,QAFS;CAGhBG,kBAAAA,OAAO,EAAE;CAHO,iBAAjB;CAKA;CACD,aAfI,MAiBL;CACCX,cAAAA,WAAW,CAAC7I,IAAZ,CAAiB;CAChBhC,gBAAAA,QAAQ,EAAEsL,aADM;CAEhBnK,gBAAAA,KAAK,EAAEoK,aAFS;CAGhBC,gBAAAA,OAAO,EAAE;CAHO,eAAjB;CAKA;CACD,WAlDD;;CAoDA,cACC,CAAC,KAAD,EAAQ,QAAR,EAAkBtB,QAAlB,CAA2BD,MAA3B,KACG,CAACmB,KAFL,EAIA;CACCP,YAAAA,WAAW,CAAC7I,IAAZ,CAAiB;CAChBhC,cAAAA,QAAQ,EAAEmK,YADM;CAEhBhJ,cAAAA,KAAK,EAAE,CAFS;CAGhBqK,cAAAA,OAAO,EAAE;CAHO,aAAjB;CAKA;;CAEDpH,UAAAA,aAAG,CAACqH,KAAJ,CAAUP,kBAAV;;CAEA,cAAInJ,QAAJ,EACA;CACC,gBAAI8I,WAAW,CAACtF,MAAZ,GAAqB,CAAzB,EACA;CACCxD,cAAAA,QAAQ,CAAC+I,SAAT,CAAmBC,GAAnB,CAAuB,oCAAvB;CACA,aAHD,MAKA;CACChJ,cAAAA,QAAQ,CAAC+I,SAAT,CAAmBG,MAAnB,CAA0B,oCAA1B;CACA;;CAED,gBAAIhJ,aAAa,CAACC,MAAlB,EACA;CACC,kBAAMwJ,WAAW,GAAG3J,QAAQ,CAAC4J,OAAT,CAAiB,qBAAjB,CAApB;;CACA,kBAAID,WAAJ,EACA;CACC,oBAAIb,WAAW,CAACtF,MAAZ,GAAqB,CAAzB,EACA;CACCmG,kBAAAA,WAAW,CAACZ,SAAZ,CAAsBC,GAAtB,CAA0B,+BAA1B;CACA,iBAHD,MAKA;CACCW,kBAAAA,WAAW,CAACZ,SAAZ,CAAsBG,MAAtB,CAA6B,+BAA7B;CACA;CACD;CACD;CACD;;CAED,eAAKW,aAAL,CAAmB;CAClBjM,YAAAA,MAAM,EAAEA,MADU;CAElBkM,YAAAA,SAAS,EAAEX,kBAFO;CAGlBxE,YAAAA,IAAI,EAAEmE;CAHY,WAAnB;CAKA;CACD;;CAED,UACCP,MAAM,KAAK9B,aAAX,IACGmC,UAFJ,EAIA;CACC,YAAI,CAAE,KAAF,EAAS,QAAT,EAAoBT,QAApB,CAA6BD,MAA7B,CAAJ,EACA;CACCU,UAAAA,UAAU,CAAC3J,SAAX,GAAuByH,aAAG,CAACC,UAAJ,+BAAsCyB,YAAY,CAAC2B,WAAb,EAAtC,WAAvB;;CACA,cAAI7J,aAAa,CAACC,MAAlB,EACA;CACCyI,YAAAA,UAAU,CAACoB,aAAX,CAAyBzI,SAAzB,GAAqC,EAArC;CACAqH,YAAAA,UAAU,CAACoB,aAAX,CAAyBjB,SAAzB,CAAmCC,GAAnC,CACC,oBADD,EAEC,oBAFD,+BAGuBZ,YAAY,CAAC6B,WAAb,EAHvB;CAKA;CACD,SAZD,MAcA;CACCrB,UAAAA,UAAU,CAAC3J,SAAX,GAAuByH,aAAG,CAACC,UAAJ,CAAe,+BAAf,CAAvB;;CACA,cAAIzG,aAAa,CAACC,MAAlB,EACA;CACCyI,YAAAA,UAAU,CAACoB,aAAX,CAAyBzI,SAAzB,GAAqC,oBAArC;CACA;CACD;CACD;CACD;CAxYF;CAAA;CAAA,kCA0YsB5D,MA1YtB,EA2YC;CACC,UAAMmM,SAAS,GAAIxK,cAAI,CAACC,SAAL,CAAe5B,MAAM,CAACmM,SAAtB,IAAmCnM,MAAM,CAACmM,SAA1C,GAAsD,IAAzE;CACA,UAAMnF,IAAI,GAAIrF,cAAI,CAACyH,OAAL,CAAapJ,MAAM,CAACgH,IAApB,IAA4BhH,MAAM,CAACgH,IAAnC,GAA0C,EAAxD;CACA,UAAM/G,MAAM,GAAI0B,cAAI,CAACE,cAAL,CAAoB7B,MAAM,CAACC,MAA3B,IAAqCD,MAAM,CAACC,MAA5C,GAAqD,EAArE;;CACA,UACC,CAACkM,SAAD,IACG,CAACxK,cAAI,CAACE,cAAL,CAAoB5B,MAApB,CAFL,EAIA;CACC;CACA;;CAED,UAAMsM,cAAc,GACnBhK,aAAa,CAACC,MAAd,GACG,EADH,GAEG;CACDgK,QAAAA,KAAK,EAAE,KAAKC,mBAAL,CAAyB5D,IAAzB,CAA8B,IAA9B,CADN;CAED6D,QAAAA,UAAU,EAAE,KAAKC,wBAAL,CAA8B9D,IAA9B,CAAmC,IAAnC,CAFX;CAGD+D,QAAAA,UAAU,EAAE,KAAKC,wBAAL,CAA8BhE,IAA9B,CAAmC,IAAnC;CAHX,OAHJ;CAUAnE,MAAAA,aAAG,CAACqH,KAAJ,CAAUI,SAAV;CAEA,UAAMW,aAAa,GAAG,EAAtB;CAEA9F,MAAAA,IAAI,CAAClB,OAAL,CAAa,UAACvB,OAAD,EAAU8F,CAAV,EAAgB;CAE5B,YAAMe,SAAS,GAAG,CACjB,2BADiB,iCAEO7G,OAAO,CAACjE,QAFf,uCAGa+J,CAAC,GAAC,CAHf,EAAlB;;CAMA,YAAI9F,OAAO,CAACuH,OAAZ,EACA;CACC,cAAIzB,CAAC,IAAI,CAAT,EACA;CACCe,YAAAA,SAAS,CAAC9I,IAAV,CAAe,8BAAf;CACA,WAHD,MAIK,IAAI0E,IAAI,CAACnB,MAAL,IAAe,CAAnB,EACL;CACCuF,YAAAA,SAAS,CAAC9I,IAAV,CAAe,+BAAf;CACA;CACD;;CAED6J,QAAAA,SAAS,CAACY,WAAV,CAAsBrI,aAAG,CAACsI,MAAJ,CAAW,MAAX,EAAmB;CACxCC,UAAAA,KAAK,EAAE;CACNvK,YAAAA,EAAE,qCAA8B6B,OAAO,CAACjE,QAAtC,cAAkDL,MAAlD,CADI;CAEN2D,YAAAA,SAAS,EAAEwH,SAAS,CAACvH,IAAV,CAAe,GAAf;CAFL,WADiC;CAKxCqJ,UAAAA,KAAK,EAAE;CACN,6BAAiB3I,OAAO,CAACjE,QADnB;CAEN,0BAAciE,OAAO,CAAC9C,KAFhB;CAGN,4BAAgBxB,MAHV;CAINkN,YAAAA,KAAK,EAAEpE,aAAG,CAACC,UAAJ,+BAAsCzE,OAAO,CAACjE,QAAR,CAAiB8L,WAAjB,EAAtC;CAJD,WALiC;CAWxC5I,UAAAA,MAAM,EAAE+I;CAXgC,SAAnB,CAAtB;CAcAO,QAAAA,aAAa,CAACvI,OAAO,CAACjE,QAAT,CAAb,GAAkCiE,OAAO,CAAC9C,KAA1C;CACA,OAnCD;CAqCA0K,MAAAA,SAAS,CAACjE,YAAV,CAAuB,qBAAvB,EAA8CkF,IAAI,CAACC,SAAL,CAAeP,aAAf,CAA9C;CACA;CA3cF;CAAA;CAAA,uCA6c2B9M,MA7c3B,EA8cC;CAAA;;CACC,UAAM2C,WAAW,GAAG,KAAKkI,OAAL,CAAa7K,MAAM,CAAC2C,WAApB,CAApB;CACA,UAAM1C,MAAM,GAAI0B,cAAI,CAACE,cAAL,CAAoB7B,MAAM,CAACC,MAA3B,IAAqCD,MAAM,CAACC,MAA5C,GAAqD,EAArE;;CAEA,UACC,CAAC0C,WAAD,IACG,CAAChB,cAAI,CAACE,cAAL,CAAoB5B,MAApB,CAFL,EAIA;CACC,eAAO,KAAP;CACA;;CAED,WAAKqN,oBAAL,GAA4BrN,MAA5B;;CAEA,UAAI,KAAKsN,cAAL,KAAwB,IAA5B,EACA;CACC,YAAMC,kBAAkB,GAAG,EAA3B;CAEA,aAAKC,aAAL,CAAmB3H,OAAnB,CAA2B,UAAC4H,cAAD,EAAoB;CAE9CF,UAAAA,kBAAkB,CAAClL,IAAnB,CAAwBoC,aAAG,CAACsI,MAAJ,CAAW,KAAX,EAAkB;CACzCC,YAAAA,KAAK,EAAE;CACNrJ,cAAAA,SAAS,2DAAoD8J,cAApD;CADH,aADkC;CAIzCR,YAAAA,KAAK,EAAE;CACN,+BAAiBQ,cADX;CAENP,cAAAA,KAAK,EAAEpE,aAAG,CAACC,UAAJ,+BAAsC0E,cAAc,CAACtB,WAAf,EAAtC;CAFD;CAJkC,WAAlB,CAAxB;CASA,SAXD;CAaA,aAAKmB,cAAL,GAAsB7I,aAAG,CAACsI,MAAJ,CAAW,KAAX,EAAkB;CACvCC,UAAAA,KAAK,EAAE;CACNrJ,YAAAA,SAAS,4CAAsCrB,aAAa,CAACC,MAAd,GAAuB,UAAvB,GAAoC,EAA1E;CADH,WADgC;CAIvCmL,UAAAA,QAAQ,EAAE,CACTjJ,aAAG,CAACsI,MAAJ,CAAW,KAAX,EAAkB;CACjBC,YAAAA,KAAK,EAAE;CACNrJ,cAAAA,SAAS,EAAE;CADL,aADU;CAIjB+J,YAAAA,QAAQ,EAAEH;CAJO,WAAlB,CADS;CAJ6B,SAAlB,CAAtB;CAcA,aAAKD,cAAL,CAAoBxJ,gBAApB,CAAsCxB,aAAa,CAACC,MAAd,GAAuB,UAAvB,GAAoC,OAA1E,EAAoF,UAACwD,CAAD,EAAO;CAE1F,cAAM4H,YAAY,GAChB5H,CAAC,CAAC3F,MAAF,CAAS+K,SAAT,CAAmBE,QAAnB,CAA4B,2BAA5B,CAAD,GACGtF,CAAC,CAAC3F,MADL,GAEG2F,CAAC,CAAC3F,MAAF,CAAS4L,OAAT,CAAiB,4BAAjB,CAHJ;;CAMA,cAAI2B,YAAJ,EACA;CACCzN,YAAAA,YAAU,CAAC0N,SAAX,CACC7H,CADD,EAEC,KAAI,CAACsH,oBAFN,EAGCM,YAAY,CAACpF,YAAb,CAA0B,eAA1B,CAHD,EAIC,IAJD;CAMA;;CAEDxC,UAAAA,CAAC,CAAC8H,cAAF;CACA,SAnBD;CAqBApJ,QAAAA,aAAG,CAACqJ,MAAJ,CAAW,KAAKR,cAAhB,EAAgCzL,QAAQ,CAACkM,IAAzC;CACA,OArDD,MAsDK,IAAI,KAAKT,cAAL,CAAoBnC,SAApB,CAA8BE,QAA9B,CAAuC,iCAAvC,CAAJ,EACL;CACC,aAAKiC,cAAL,CAAoBnC,SAApB,CAA8BG,MAA9B,CAAqC,iCAArC;CACA,OAHI,MAIA,IACJhJ,aAAa,CAACC,MAAd,IACG,KAAK+K,cAAL,CAAoBnC,SAApB,CAA8BE,QAA9B,CAAuC,8CAAvC,CAFC,EAIL;CACC,aAAKiC,cAAL,CAAoBnC,SAApB,CAA8BG,MAA9B,CAAqC,8CAArC;CACA,OANI,MAQL;CACC;CACA;;CAED,WAAK0C,6BAAL,GAAqC,KAAKC,gCAAL,CAAsCjO,MAAtC,CAArC;CAEA,UAAMkO,mBAAmB,GAAGC,aAAG,CAACzL,WAAD,CAA/B;;CAEA,UACCA,WAAW,CAACsJ,OAAZ,CAAoB,4BAApB,KACGtJ,WAAW,CAACsJ,OAAZ,CAAoB,2CAApB,CAFJ,EAIA;CACCkC,QAAAA,mBAAmB,CAACE,IAApB,IAA4B,GAA5B;CACA;;CAED,UAAMC,QAAQ,GAAKH,mBAAmB,CAAChF,GAApB,GAA0BoF,uBAAa,GAAGtI,SAA3C,GAAwD,EAA1E;CACA,UAAMuI,MAAM,GAAIF,QAAQ,GAAG,EAAH,GAAQ,CAAC,EAAjC;;CAEA,UAAIA,QAAJ,EACA;CACC,aAAKf,cAAL,CAAoBnC,SAApB,CAA8BC,GAA9B,CAAkC,gCAAlC;CACA,OAHD,MAKA;CACC,aAAKkC,cAAL,CAAoBnC,SAApB,CAA8BG,MAA9B,CAAqC,gCAArC;CACA;;CAED,UAAMrL,YAAY,GAAGC,YAAU,CAACC,WAAX,CAAuBH,MAAvB,CAArB;;CAEA,UAAIsC,aAAa,CAACC,MAAlB,EACA;CACC,aAAKiM,eAAL,GAAwBH,QAAQ,GAAG,EAAH,GAAQ,CAAC,EAAzC;CACA5J,QAAAA,aAAG,CAACgK,MAAJ,CAAW,KAAKnB,cAAhB,EAAgC;CAC/B5I,UAAAA,KAAK,EAAE;CACN0J,YAAAA,IAAI,EAAE,MADA;CAENlF,YAAAA,GAAG,EAAG,CAACmF,QAAQ,GAAIH,mBAAmB,CAAChF,GAApB,GAA0B,EAA9B,GAAqCgF,mBAAmB,CAAChF,GAApB,GAA0B,EAAxE,IAA+EqF,MAAhF,GAA0F,IAFzF;CAGNG,YAAAA,KAAK,EAAE,OAHD;CAINC,YAAAA,YAAY,EAAE;CAJR;CADwB,SAAhC;CASA,aAAKrB,cAAL,CAAoBnC,SAApB,CAA8BG,MAA9B,CAAqC,uCAArC;CACA,aAAKgC,cAAL,CAAoBnC,SAApB,CAA8BC,GAA9B,CAAkC,oCAAlC;CACA,aAAKkC,cAAL,CAAoBnC,SAApB,CAA8BC,GAA9B,CAAkC,yCAAlC;CACAnL,QAAAA,YAAY,CAAC8B,GAAb,CAAiBoJ,SAAjB,CAA2BC,GAA3B,CAA+B,gCAA/B;CACA,aAAKwD,iCAAL;CACA,OAjBD,MAmBA;CACC,aAAKC,uBAAL,GAA+B,IAAI5J,EAAE,CAAC6J,MAAP,CAAc;CAC5CC,UAAAA,QAAQ,EAAE,GADkC;CAE5CC,UAAAA,KAAK,EAAE;CACNN,YAAAA,KAAK,EAAE,GADD;CAENN,YAAAA,IAAI,EAAGF,mBAAmB,CAACE,IAApB,GAA4BF,mBAAmB,CAACQ,KAApB,GAA4B,CAAxD,GAA6D,EAF9D;CAGNxF,YAAAA,GAAG,EAAG,CAACmF,QAAQ,GAAGH,mBAAmB,CAAChF,GAApB,GAA0B,EAA7B,GAAkCgF,mBAAmB,CAAChF,GAApB,GAA0B,EAArE,IAA4EqF,MAH5E;CAINI,YAAAA,YAAY,EAAE,CAJR;CAKNM,YAAAA,OAAO,EAAE;CALH,WAFqC;CAS5CC,UAAAA,MAAM,EAAE;CACPR,YAAAA,KAAK,EAAE,GADA;CAEPN,YAAAA,IAAI,EAAGF,mBAAmB,CAACE,IAApB,GAA4BF,mBAAmB,CAACQ,KAApB,GAA4B,CAAxD,GAA6D,GAF7D;CAGPxF,YAAAA,GAAG,EAAGgF,mBAAmB,CAAChF,GAApB,GAA0BqF,MAA1B,GAAmC,CAHlC;CAIPI,YAAAA,YAAY,EAAE,EAJP;CAKPM,YAAAA,OAAO,EAAE;CALF,WAToC;CAgB5CE,UAAAA,UAAU,EAAGlK,EAAE,CAAC6J,MAAH,CAAUM,aAAV,CAAwBnK,EAAE,CAAC6J,MAAH,CAAUO,WAAV,CAAsBC,KAA9C,CAhB+B;CAiB5CC,UAAAA,IAAI,EAAE,cAACC,KAAD,EAAW;CAChB,YAAA,KAAI,CAAClC,cAAL,CAAoB5I,KAApB,CAA0BgK,KAA1B,aAAqCc,KAAK,CAACd,KAA3C;CACA,YAAA,KAAI,CAACpB,cAAL,CAAoB5I,KAApB,CAA0B0J,IAA1B,aAAoCoB,KAAK,CAACpB,IAA1C;CACA,YAAA,KAAI,CAACd,cAAL,CAAoB5I,KAApB,CAA0BwE,GAA1B,aAAmCsG,KAAK,CAACtG,GAAzC;CACA,YAAA,KAAI,CAACoE,cAAL,CAAoB5I,KAApB,CAA0BiK,YAA1B,aAA4Ca,KAAK,CAACb,YAAlD;CACA,YAAA,KAAI,CAACrB,cAAL,CAAoB5I,KAApB,CAA0BuK,OAA1B,GAAoCO,KAAK,CAACP,OAAN,GAAgB,GAApD;CACA,YAAA,KAAI,CAACQ,0BAAL,GAAkCD,KAAK,CAACP,OAAxC;CACA,WAxB2C;CAyB5CS,UAAAA,QAAQ,EAAE,oBAAM;CACf,YAAA,KAAI,CAACpC,cAAL,CAAoB5I,KAApB,CAA0BuK,OAA1B,GAAoC,EAApC;;CACA,YAAA,KAAI,CAAC3B,cAAL,CAAoBnC,SAApB,CAA8BC,GAA9B,CAAkC,oCAAlC;;CACAnL,YAAAA,YAAY,CAAC8B,GAAb,CAAiBoJ,SAAjB,CAA2BC,GAA3B,CAA+B,gCAA/B;CACA;CA7B2C,SAAd,CAA/B;CA+BA,aAAKyD,uBAAL,CAA6BhD,OAA7B;CAEAlL,QAAAA,UAAU,CAAC,YAAM;CAEhB,cAAMgP,SAAS,GAAG,KAAI,CAACrC,cAAL,CAAoB3H,gBAApB,CAAqC,4BAArC,CAAlB;;CAEA,UAAA,KAAI,CAACiK,wBAAL,GAAgC,IAAI3K,EAAE,CAAC6J,MAAP,CAAc;CAC7CC,YAAAA,QAAQ,EAAE,GADmC;CAE7CC,YAAAA,KAAK,EAAE;CACNC,cAAAA,OAAO,EAAE;CADH,aAFsC;CAK7CC,YAAAA,MAAM,EAAE;CACPD,cAAAA,OAAO,EAAE;CADF,aALqC;CAQ7CE,YAAAA,UAAU,EAAGlK,EAAE,CAAC6J,MAAH,CAAUO,WAAV,CAAsBC,KARU;CAS7CC,YAAAA,IAAI,EAAE,cAACC,KAAD,EAAW;CAChBG,cAAAA,SAAS,CAAC,CAAD,CAAT,CAAajL,KAAb,CAAmBuK,OAAnB,GAA6BO,KAAK,CAACP,OAAN,GAAgB,GAA7C;CACAU,cAAAA,SAAS,CAAC,CAAD,CAAT,CAAajL,KAAb,CAAmBuK,OAAnB,GAA6BO,KAAK,CAACP,OAAN,GAAgB,GAA7C;CACAU,cAAAA,SAAS,CAAC,CAAD,CAAT,CAAajL,KAAb,CAAmBuK,OAAnB,GAA6BO,KAAK,CAACP,OAAN,GAAgB,GAA7C;CACAU,cAAAA,SAAS,CAAC,CAAD,CAAT,CAAajL,KAAb,CAAmBuK,OAAnB,GAA6BO,KAAK,CAACP,OAAN,GAAgB,GAA7C;CACAU,cAAAA,SAAS,CAAC,CAAD,CAAT,CAAajL,KAAb,CAAmBuK,OAAnB,GAA6BO,KAAK,CAACP,OAAN,GAAgB,GAA7C;CACAU,cAAAA,SAAS,CAAC,CAAD,CAAT,CAAajL,KAAb,CAAmBuK,OAAnB,GAA6BO,KAAK,CAACP,OAAN,GAAgB,GAA7C;CACAU,cAAAA,SAAS,CAAC,CAAD,CAAT,CAAajL,KAAb,CAAmBuK,OAAnB,GAA6BO,KAAK,CAACP,OAAN,GAAgB,GAA7C;CACA,aAjB4C;CAkB7CS,YAAAA,QAAQ,EAAE,oBAAM;CACf,cAAA,KAAI,CAACpC,cAAL,CAAoBnC,SAApB,CAA8BC,GAA9B,CAAkC,yCAAlC;;CACAuE,cAAAA,SAAS,CAAC,CAAD,CAAT,CAAajL,KAAb,CAAmBuK,OAAnB,GAA6B,EAA7B;CACAU,cAAAA,SAAS,CAAC,CAAD,CAAT,CAAajL,KAAb,CAAmBuK,OAAnB,GAA6B,EAA7B;CACAU,cAAAA,SAAS,CAAC,CAAD,CAAT,CAAajL,KAAb,CAAmBuK,OAAnB,GAA6B,EAA7B;CACAU,cAAAA,SAAS,CAAC,CAAD,CAAT,CAAajL,KAAb,CAAmBuK,OAAnB,GAA6B,EAA7B;CACAU,cAAAA,SAAS,CAAC,CAAD,CAAT,CAAajL,KAAb,CAAmBuK,OAAnB,GAA6B,EAA7B;CACAU,cAAAA,SAAS,CAAC,CAAD,CAAT,CAAajL,KAAb,CAAmBuK,OAAnB,GAA6B,EAA7B;CACAU,cAAAA,SAAS,CAAC,CAAD,CAAT,CAAajL,KAAb,CAAmBuK,OAAnB,GAA6B,EAA7B;CACA;CA3B4C,WAAd,CAAhC;;CA6BA,UAAA,KAAI,CAACW,wBAAL,CAA8B/D,OAA9B;CACA,SAlCS,EAkCP,GAlCO,CAAV;CAmCA;;CAED,UAAI,CAAC,KAAKyB,cAAL,CAAoBnC,SAApB,CAA8BE,QAA9B,CAAuC,8BAAvC,CAAL,EACA;CACC,aAAKiC,cAAL,CAAoBnC,SAApB,CAA8BC,GAA9B,CAAkC,8BAAlC;CACA;;CAED,UAAI,CAAC9I,aAAa,CAACC,MAAnB,EACA;CACCV,QAAAA,QAAQ,CAACiC,gBAAT,CAA0B,WAA1B,EAAuC,KAAKkK,6BAA5C;CACA,OAHD,MAKA;CACC,aAAK6B,cAAL,GAAsBvB,uBAAa,GAAGtI,SAAtC;CACA,aAAK8J,mBAAL,GAA2B,IAA3B;CAEAC,QAAAA,MAAM,CAACjM,gBAAP,CAAwB,UAAxB,EAAoC,KAAKkM,mCAAzC;CACAD,QAAAA,MAAM,CAACjM,gBAAP,CAAwB,WAAxB,EAAqC,KAAKmM,oCAA1C;CACA;CACD;CAvqBF;CAAA;CAAA,iDAyqBqClK,CAzqBrC,EA0qBC;CACC,UAAMmK,MAAM,GAAG;CACdC,QAAAA,CAAC,EAAEpK,CAAC,CAACqK,cAAF,CAAiB,CAAjB,EAAoBC,KADT;CACgB;CAC9BC,QAAAA,CAAC,EAAEvK,CAAC,CAACqK,cAAF,CAAiB,CAAjB,EAAoBG,KAFT;;CAAA,OAAf;;CAKA,UAAI,KAAKT,mBAAL,KAA6B,IAAjC,EACA;CACC,YAAItF,YAAY,GAAG,IAAnB;CACA,YAAMmD,YAAY,GAAG,KAAK6C,gCAAL,CAAsCN,MAAM,CAACC,CAA7C,EAAgDD,MAAM,CAACI,CAAvD,CAArB;;CAEA,YACC3C,YAAY,KACRnD,YAAY,GAAGmD,YAAY,CAACpF,YAAb,CAA0B,eAA1B,CADP,CADb,EAIA;CACCrI,UAAAA,YAAU,CAAC0N,SAAX,CACC7H,CADD,EAEC,KAAKsH,oBAFN,EAGC7C,YAHD,EAIC,IAJD;CAMA;;CACD,aAAKiG,+BAAL;CACA,OAlBD;CAoBA;CACCV,UAAAA,MAAM,CAACjM,gBAAP,CAAwB,UAAxB,EAAoC,KAAK2M,+BAAzC;CACA;;CAEDV,MAAAA,MAAM,CAACW,mBAAP,CAA2B,UAA3B,EAAuC,KAAKV,mCAA5C;CACAD,MAAAA,MAAM,CAACW,mBAAP,CAA2B,WAA3B,EAAwC,KAAKT,oCAA7C;CAEA,WAAKU,kBAAL,GAA0B,IAA1B;CACA5K,MAAAA,CAAC,CAAC8H,cAAF;CACA;CA7sBF;CAAA;CAAA,kDA+sBsC9H,CA/sBtC,EAgtBC;CACC,UAAMmK,MAAM,GAAG;CACdC,QAAAA,CAAC,EAAEpK,CAAC,CAAC6K,OAAF,CAAU,CAAV,EAAaP,KADF;CACS;CACvBC,QAAAA,CAAC,EAAEvK,CAAC,CAAC6K,OAAF,CAAU,CAAV,EAAaL,KAFF;;CAAA,OAAf;CAMA,WAAKM,oBAAL,GAA4B;CAC3BV,QAAAA,CAAC,EAAED,MAAM,CAACC,CADiB;CAE3BG,QAAAA,CAAC,EAAEJ,MAAM,CAACI;CAFiB,OAA5B;;CAKA,UAAI,KAAKK,kBAAL,KAA4B,IAAhC,EACA;CACC,aAAKA,kBAAL,GAA0B;CACzBR,UAAAA,CAAC,EAAED,MAAM,CAACC,CADe;CAEzBG,UAAAA,CAAC,EAAEJ,MAAM,CAACI;CAFe,SAA1B;CAIA,OAND,MAQA;CACC,YAAI,KAAKR,mBAAL,KAA6B,IAAjC,EACA;CACC,eAAKA,mBAAL,GAA2B,CAAC,KAAKgB,kCAAL,EAA5B;CACA;CACD;;CAED,UAAI,KAAKhB,mBAAL,KAA6B,IAAjC,EACA;CACC,YAAMnC,YAAY,GAAG,KAAK6C,gCAAL,CAAsCN,MAAM,CAACC,CAA7C,EAAgDD,MAAM,CAACI,CAAvD,CAArB;;CACA,YAAI3C,YAAJ,EACA;CACC,cACC,KAAKoD,wBAAL,IACG,KAAKA,wBAAL,KAAkCpD,YAFtC,EAIA;CACC,iBAAKqD,+BAAL,CAAqC,KAAKD,wBAA1C;CACA;;CACD,eAAKE,4BAAL,CAAkCtD,YAAlC;CACA,eAAKoD,wBAAL,GAAgCpD,YAAhC;CACA,SAXD,MAYK,IAAI,KAAKoD,wBAAT,EACL;CACC,eAAKC,+BAAL,CAAqC,KAAKD,wBAA1C;CACA;CACD,OAnBD,MAqBA;CACC,YAAI,KAAKA,wBAAT,EACA;CACC,eAAKC,+BAAL,CAAqC,KAAKD,wBAA1C;CACA;CACD;CACD;CAtwBF;CAAA;CAAA,0CAywBC;CAAA;;CACC,UAAI,KAAKG,qBAAT,EACA;CACCnB,QAAAA,MAAM,CAAChM,YAAP,CAAoB,KAAKmN,qBAAzB;CACA;;CAED,WAAKC,cAAL,GAAsB,IAAtB;CACA,WAAKD,qBAAL,GAA6BvQ,UAAU,CAAC,YAAM;CAC7C,QAAA,MAAI,CAACwQ,cAAL,GAAsB,KAAtB;CACA,OAFsC,EAEpC,GAFoC,CAAvC;CAGA;CAnxBF;CAAA;CAAA,uCAqxB2BpR,MArxB3B,EAsxBC;CAAA;;CACC,UAAMC,MAAM,GAAI0B,cAAI,CAACE,cAAL,CAAoB7B,MAAM,CAACC,MAA3B,IAAqCD,MAAM,CAACC,MAA5C,GAAqD,KAArE;;CAEA,UAAI,KAAKsN,cAAT,EACA;CACC,YAAIhL,aAAa,CAACC,MAAlB,EACA;CACC,eAAK+K,cAAL,CAAoBnC,SAApB,CAA8BC,GAA9B,CAAkC,uCAAlC;CACA,eAAKkC,cAAL,CAAoBnC,SAApB,CAA8BC,GAA9B,CAAkC,8CAAlC;CACA,eAAKkC,cAAL,CAAoBnC,SAApB,CAA8BG,MAA9B,CAAqC,8BAArC;CACA,eAAKgC,cAAL,CAAoBnC,SAApB,CAA8BG,MAA9B,CAAqC,oCAArC;CACA,eAAKgC,cAAL,CAAoBnC,SAApB,CAA8BG,MAA9B,CAAqC,yCAArC;CACA,eAAK8F,gCAAL;CACA,SARD,MAUA;CACC,cAAI,KAAKvC,uBAAT,EACA;CACC,iBAAKA,uBAAL,CAA6BwC,IAA7B;CACA;;CACD,cAAI,KAAKzB,wBAAT,EACA;CACC,iBAAKA,wBAAL,CAA8ByB,IAA9B;CACA;;CAED,eAAK/D,cAAL,CAAoBnC,SAApB,CAA8BC,GAA9B,CAAkC,iCAAlC;CAEA,eAAKkG,wBAAL,GAAgC,IAAIrM,EAAE,CAAC6J,MAAP,CAAc;CAC7CC,YAAAA,QAAQ,EAAE,GADmC;CAE7CC,YAAAA,KAAK,EAAE;CACNC,cAAAA,OAAO,EAAE,KAAKQ;CADR,aAFsC;CAK7CP,YAAAA,MAAM,EAAE;CACPD,cAAAA,OAAO,EAAE;CADF,aALqC;CAQ7CE,YAAAA,UAAU,EAAElK,EAAE,CAAC6J,MAAH,CAAUO,WAAV,CAAsBkC,MARW;CAS7ChC,YAAAA,IAAI,EAAE,cAACC,KAAD,EAAW;CAChB,cAAA,MAAI,CAAClC,cAAL,CAAoB5I,KAApB,CAA0BuK,OAA1B,GAAoCO,KAAK,CAACP,OAAN,GAAgB,GAApD;CACA,cAAA,MAAI,CAACQ,0BAAL,GAAkCD,KAAK,CAACP,OAAxC;CACA,aAZ4C;CAa7CS,YAAAA,QAAQ,EAAE,oBAAM;CACf,cAAA,MAAI,CAACpC,cAAL,CAAoB5I,KAApB,CAA0BuK,OAA1B,GAAoC,EAApC;;CACA,cAAA,MAAI,CAAC3B,cAAL,CAAoBnC,SAApB,CAA8BC,GAA9B,CAAkC,uCAAlC;;CACA,cAAA,MAAI,CAACkC,cAAL,CAAoBnC,SAApB,CAA8BG,MAA9B,CAAqC,8BAArC;;CACA,cAAA,MAAI,CAACgC,cAAL,CAAoBnC,SAApB,CAA8BG,MAA9B,CAAqC,oCAArC;;CACA,cAAA,MAAI,CAACgC,cAAL,CAAoBnC,SAApB,CAA8BG,MAA9B,CAAqC,yCAArC;CACA;CAnB4C,WAAd,CAAhC;CAsBA,eAAKgG,wBAAL,CAA8BzF,OAA9B;CACA;;CAED,aAAKwB,oBAAL,GAA4B,IAA5B;;CAEA,YAAIrN,MAAJ,EACA;CACCE,UAAAA,YAAU,CAACC,WAAX,CAAuBH,MAAvB,EAA+B+B,GAA/B,CAAmCoJ,SAAnC,CAA6CG,MAA7C,CAAoD,gCAApD;CACA;CACD;;CAED,WAAK0F,+BAAL,CAAqC,KAAKD,wBAA1C;;CAEA,UAAI/Q,MAAJ,EACA;CACC,aAAKwR,kBAAL,CAAwB;CACvBxR,UAAAA,MAAM,EAAEA;CADe,SAAxB;CAGA;CACD;CA11BF;CAAA;CAAA,yDA61BC;CACC,UAAI,KAAK2Q,kBAAL,KAA4B,IAAhC,EACA;CACC,eAAO,IAAP;CACA,OAHD,MAKA;CACC,YACCc,IAAI,CAACC,GAAL,CAAS,KAAKb,oBAAL,CAA0BV,CAA1B,GAA8B,KAAKQ,kBAAL,CAAwBR,CAA/D,IAAoE,CAApE,IACGsB,IAAI,CAACC,GAAL,CAAS,KAAKb,oBAAL,CAA0BP,CAA1B,GAA8B,KAAKK,kBAAL,CAAwBL,CAA/D,IAAoE,CAFxE,EAIA;CACC,iBAAO,KAAP;CACA;CACD;;CAED,aAAO,IAAP;CACA;CA92BF;CAAA;CAAA,6CAg3BiCvK,CAh3BjC,EAi3BC;CACCgK,MAAAA,MAAM,CAACW,mBAAP,CAA2B,UAA3B,EAAuC,KAAKD,+BAA5C;;CACA,UAAI,KAAKpD,oBAAT,EACA;CACC,aAAKsE,kBAAL,CAAwB;CACvB3R,UAAAA,MAAM,EAAE,KAAKqN;CADU,SAAxB;;CAIA,YAAItH,CAAJ,EACA;CACCA,UAAAA,CAAC,CAAC8H,cAAF;CACA;CACD;CACD;CA93BF;CAAA;CAAA,qDAg4ByCsC,CAh4BzC,EAg4B4CG,CAh4B5C,EAi4BC;CACC,UAAI3C,YAAY,GAAG,IAAnB;CACA,UAAInD,YAAY,GAAG,IAAnB;CACA,UAAI7C,MAAM,GAAG,IAAb;;CAEA,UACC,CACC,CAACgG,YAAY,GAAG9L,QAAQ,CAAC+P,gBAAT,CAA0BzB,CAA1B,EAA8BG,CAAC,GAAG,KAAK9B,eAAT,GAA2B,KAAKqB,cAA9D,CAAhB;CAAA,YACIlC,YAAY,GAAG9L,QAAQ,CAAC+P,gBAAT,CAA0BzB,CAA1B,EAA8BG,CAAC,GAAG,KAAKT,cAAvC,CADnB,CADD;CAAA,YAIIrF,YAAY,GAAGmD,YAAY,CAACpF,YAAb,CAA0B,eAA1B,CAJnB,KAKG7G,cAAI,CAACE,cAAL,CAAoB4I,YAApB,CANJ,EAQA;CACC7C,QAAAA,MAAM,GAAGgG,YAAT;CACA;;CAED,aAAOhG,MAAP;CACA;CAn5BF;CAAA;CAAA,iDAq5BqCgG,YAr5BrC,EAs5BC;CACC,UAAI,CAACA,YAAL,EACA;CACC;CACA;;CAEDA,MAAAA,YAAY,CAACxC,SAAb,CAAuBC,GAAvB,CAA2B,iCAA3B;CACA;CA75BF;CAAA;CAAA,oDA+5BwCuC,YA/5BxC,EAg6BC;CACC,UAAI,CAACA,YAAL,EACA;CACC;CACA;;CAEDA,MAAAA,YAAY,CAACxC,SAAb,CAAuBG,MAAvB,CAA8B,iCAA9B;CACA;CAv6BF;CAAA;CAAA,uDA06BC;CACCzJ,MAAAA,QAAQ,CAAC6O,mBAAT,CAA6B,WAA7B,EAA0C,KAAKmB,uBAA/C,EAAwE;CAAEC,QAAAA,OAAO,EAAE;CAAX,OAAxE;CACA/M,MAAAA,6BAAY,CAACgN,IAAb,CAAkB,kBAAlB;;CAEA,UAAI,KAAKC,aAAL,KAAuB,IAA3B,EACA;CACCvN,QAAAA,aAAG,CAACqH,KAAJ,CAAU,KAAKkG,aAAf;CACAvN,QAAAA,aAAG,CAAC6G,MAAJ,CAAW,KAAK0G,aAAhB;CAEA,aAAKA,aAAL,GAAqB,IAArB;CACA;CACD;CAr7BF;CAAA;CAAA,wDAw7BC;CAAA;;CACCnQ,MAAAA,QAAQ,CAACiC,gBAAT,CAA0B,WAA1B,EAAuC,KAAK+N,uBAAL,CAA6BjJ,IAA7B,CAAkC,IAAlC,CAAvC,EAAgF;CAAEkJ,QAAAA,OAAO,EAAE;CAAX,OAAhF;CACA/M,MAAAA,6BAAY,CAACgN,IAAb,CAAkB,mBAAlB;;CAEA,UAAI,CAACrQ,cAAI,CAACqB,MAAL,CAAY,KAAKiP,aAAjB,CAAL,EACA;CACC;CACA;;CAED,WAAKA,aAAL,GAAqBvN,aAAG,CAACsI,MAAJ,CAAW,KAAX,EAAkB;CACtCC,QAAAA,KAAK,EAAE;CACNrJ,UAAAA,SAAS,EAAE;CADL;CAD+B,OAAlB,CAArB;CAKAhD,MAAAA,UAAU,CAAC,YAAM;CAChB,YAAIe,cAAI,CAACqB,MAAL,CAAY,MAAI,CAACiP,aAAjB,CAAJ,EACA;CACC;CACA;;CAEDvN,QAAAA,aAAG,CAACqJ,MAAJ,CAAW,MAAI,CAACkE,aAAhB,EAA+BnQ,QAAQ,CAACkM,IAAxC;CACA,OAPS,EAOP,IAPO,CAAV,CAdD;CAsBC;CA98BF;CAAA;CAAA,uCAg9B2BhO,MAh9B3B,EAg9BmC;CAEjC,UAAIuC,aAAa,CAACC,MAAlB,EACA;CACC,eAAO,KAAP;CACA;;CAED,UAAMvC,MAAM,GAAI0B,cAAI,CAACE,cAAL,CAAoB7B,MAAM,CAACC,MAA3B,IAAqCD,MAAM,CAACC,MAA5C,GAAqD,EAArE;;CAEA,UAAI,CAAC0B,cAAI,CAACE,cAAL,CAAoB5B,MAApB,CAAL,EACA;CACC,eAAO,KAAP;CACA;;CAED,UAAMC,YAAY,GAAGC,YAAU,CAACC,WAAX,CAAuBH,MAAvB,CAArB;;CACA,UAAI,CAACC,YAAL,EACA;CACC,eAAO,KAAP;CACA;;CAEDA,MAAAA,YAAY,CAACgS,gBAAb,GAAgCC,iBAAO,CAACC,QAAR,CAAiB,KAAKC,mBAAL,CAAyBpS,MAAzB,CAAjB,EAAmD,GAAnD,CAAhC;CAEAC,MAAAA,YAAY,CAAC8B,GAAb,CAAiB+B,gBAAjB,CAAkC,YAAlC,EAAgD7D,YAAY,CAACgS,gBAA7D;CACAhS,MAAAA,YAAY,CAAC8B,GAAb,CAAiB+B,gBAAjB,CAAkC,YAAlC,EAAgD,KAAKuO,mBAArD;CACA;CAx+BF;CAAA;CAAA,4CA0+BgCtM,CA1+BhC,EA2+BC;CACCA,MAAAA,CAAC,CAAC8H,cAAF;CACA;CA7+BF;CAAA;CAAA,qDA++ByC7N,MA/+BzC,EAg/BC;CAAA;;CACC,aAAO,UAAC+F,CAAD,EAAO;CAEb,YAAMuM,aAAa,GAAG,MAAI,CAAChF,cAAL,CAAoBiF,qBAApB,EAAtB;;CACA,YAAMlE,QAAQ,GAAG,MAAI,CAACf,cAAL,CAAoBnC,SAApB,CAA8BE,QAA9B,CAAuC,gCAAvC,CAAjB;;CAEA,YACCtF,CAAC,CAACyM,OAAF,IAAaF,aAAa,CAAClE,IAA3B,IACGrI,CAAC,CAACyM,OAAF,IAAaF,aAAa,CAACG,KAD9B,IAEG1M,CAAC,CAAC2M,OAAF,IAAaJ,aAAa,CAACpJ,GAAd,IAAqBmF,QAAQ,GAAG,EAAH,GAAQ,CAArC,CAFhB,IAGGtI,CAAC,CAAC2M,OAAF,IAAcJ,aAAa,CAACK,MAAd,IAAwBtE,QAAQ,GAAG,CAAH,GAAO,EAAvC,CAJlB,EAMA;CACC;CACA;;CAED,QAAA,MAAI,CAACgE,mBAAL;;CACA,QAAA,MAAI,CAACV,kBAAL,CAAwB;CACvB3R,UAAAA,MAAM,EAAEA;CADe,SAAxB;;CAIA6B,QAAAA,QAAQ,CAAC6O,mBAAT,CAA6B,WAA7B,EAA0C,MAAI,CAAC1C,6BAA/C;CACA,QAAA,MAAI,CAACA,6BAAL,GAAqC,IAArC;CACA,OAtBD;CAuBA;CAxgCF;CAAA;CAAA,wCA0gC4BhO,MA1gC5B,EA2gCC;CAAA;;CACC,aAAO,YAAM;CAEZ,YAAMC,YAAY,GAAGC,YAAU,CAACC,WAAX,CAAuBH,MAAvB,CAArB;;CAEA,YAAI,CAAC,MAAI,CAAC4S,wBAAV,EACA;CACC,cAAI,MAAI,CAACzB,cAAT,EACA;CACC;CACA;;CAED,cAAI7O,aAAa,CAACC,MAAlB,EACA;CACCsQ,YAAAA,GAAG,CAACC,IAAJ,CAAS,eAAT;CACA;;CAED,UAAA,MAAI,CAACC,kBAAL,CAAwB;CACvBrQ,YAAAA,WAAW,EAAEzC,YAAY,CAAC8B,GADH;CAEvB/B,YAAAA,MAAM,EAAEA;CAFe,WAAxB;CAIA;;CAEDC,QAAAA,YAAY,CAAC8B,GAAb,CAAiB2O,mBAAjB,CAAqC,YAArC,EAAmDzQ,YAAY,CAACgS,gBAAhE;CACAhS,QAAAA,YAAY,CAAC8B,GAAb,CAAiB2O,mBAAjB,CAAqC,YAArC,EAAmD,MAAI,CAAC2B,mBAAL,CAAyBzJ,IAAzB,CAA8B,MAA9B,CAAnD;CACA,OAxBD;CAyBA;CAriCF;CAAA;CAAA,sCAuiC0B7I,MAviC1B,EAwiCC;CAAA;;CACC,UAAMyG,KAAK,GAAIzG,MAAM,CAACyG,KAAP,GAAewM,OAAO,CAACjT,MAAM,CAACyG,KAAR,CAAtB,GAAuC,KAAtD;CACA,UAAMxG,MAAM,GAAI0B,cAAI,CAACE,cAAL,CAAoB7B,MAAM,CAACC,MAA3B,IAAqCD,MAAM,CAACC,MAA5C,GAAqD,EAArE;CACA,UAAMgI,MAAM,GAAGjI,MAAM,CAACiI,MAAtB;CACA,UAAMiL,eAAe,GAAIvR,cAAI,CAACE,cAAL,CAAoB7B,MAAM,CAACM,QAA3B,IAAuCN,MAAM,CAACM,QAA9C,GAAyD,EAAlF;CACA,UAAMkG,IAAI,GAAIpF,MAAM,CAACpB,MAAM,CAACwG,IAAR,CAAN,GAAsB,CAAtB,GAA0BpF,MAAM,CAACpB,MAAM,CAACwG,IAAR,CAAhC,GAAgD,CAA9D;CACA,UAAMQ,IAAI,GAAGhH,MAAM,CAACgH,IAApB;AACA,CAEA,UAAMyG,aAAa,GAAG,EAAtB;CACA,UAAI0F,cAAc,GAAG,CAArB;;CAEA,UACC1M,KAAK,IACFD,IAAI,KAAK,CAFb,EAIA;CACC,aAAKG,iBAAL,CAAuB;CACtB1G,UAAAA,MAAM,EAAEA;CADc,SAAvB;CAGA;;CAED,WAAKoG,oBAAL,GAA6B1E,cAAI,CAACE,cAAL,CAAoBqR,eAApB,IAAuCA,eAAvC,GAAyD,KAAtF;;CAEA,UACCA,eAAe,CAACrN,MAAhB,IAA0B,CAA1B,IACGqN,eAAe,IAAI,KAFvB;CAIA;CACC,eAAKE,oBAAL,GAA4B,KAA5B;CACAtR,UAAAA,QAAQ,CAACC,cAAT,+BAA+C9B,MAA/C,GAAyD0E,KAAzD,CAA+D0O,MAA/D,GAAwE,MAAxE;CACAvR,UAAAA,QAAQ,CAACC,cAAT,+BAA+C9B,MAA/C,GAAyD0E,KAAzD,CAA+D2O,QAA/D,GAA0E,MAA1E;CACA;;CAED,UAAI,CAAC3R,cAAI,CAACE,cAAL,CAAoBqR,eAApB,CAAL,EACA;CACC,aAAKxM,cAAL,GAAsB,EAAtB;CACA;;CAED,WAAKA,cAAL,CAAqBwM,eAAe,IAAI,EAAnB,GAAwB,KAAxB,GAAgCA,eAArD,IAA0E1M,IAAI,GAAG,CAAjF;;CAEA,UAAI7E,cAAI,CAAC4R,aAAL,CAAmBvM,IAAI,CAAC4I,SAAxB,CAAJ,EACA;CACC4D,QAAAA,MAAM,CAACC,OAAP,CAAezM,IAAI,CAAC4I,SAApB,EAA+B9J,OAA/B,CAAuC,gBAAyB;CAAA;CAAA,cAAtBxF,QAAsB;CAAA,cAAZmB,KAAY;;CAC/D,cAAIL,MAAM,CAACK,KAAD,CAAN,IAAiB,CAArB,EACA;CACC;CACA;;CAEDgM,UAAAA,aAAa,CAACnL,IAAd,CAAmB;CAClBhC,YAAAA,QAAQ,EAAEA,QADQ;CAElBmB,YAAAA,KAAK,EAAEL,MAAM,CAACK,KAAD;CAFK,WAAnB;CAIA0R,UAAAA,cAAc;CACd,SAXD;CAYA;;CAED,UAAMO,QAAQ,GAAGhP,aAAG,CAACsI,MAAJ,CAAW,MAAX,EAAmB;CACnCC,QAAAA,KAAK,EAAE;CACNrJ,UAAAA,SAAS,EAAE;CADL;CAD4B,OAAnB,CAAjB;;CAMA,UAAIuP,cAAc,GAAG,CAArB,EACA;CACC,YAAMQ,aAAa,GAAG,CAAE,0BAAF,CAAtB;;CACA,YAAI,CAAChS,cAAI,CAACE,cAAL,CAAoBqR,eAApB,CAAD,IAAyCA,eAAe,IAAI,KAAhE,EACA;CACCS,UAAAA,aAAa,CAACrR,IAAd,CAAmB,kCAAnB;CACA;;CAEDoR,QAAAA,QAAQ,CAAC3G,WAAT,CAAqBrI,aAAG,CAACsI,MAAJ,CAAW,MAAX,EAAmB;CACvCC,UAAAA,KAAK,EAAE;CACNrJ,YAAAA,SAAS,EAAE+P,aAAa,CAAC9P,IAAd,CAAmB,GAAnB;CADL,WADgC;CAIvC8J,UAAAA,QAAQ,EAAE,CACTjJ,aAAG,CAACsI,MAAJ,CAAW,MAAX,EAAmB;CAClBC,YAAAA,KAAK,EAAE;CACNrJ,cAAAA,SAAS,EAAE;CADL;CADW,WAAnB,CADS,EAMTc,aAAG,CAACsI,MAAJ,CAAW,MAAX,EAAmB;CAClBC,YAAAA,KAAK,EAAE;CACNrJ,cAAAA,SAAS,EAAE;CADL,aADW;CAIlBgQ,YAAAA,IAAI,EAAE7K,aAAG,CAACC,UAAJ,CAAe,uBAAf,EAAwCS,OAAxC,CAAgD,OAAhD,EAAyDrI,MAAM,CAAC4F,IAAI,CAACc,SAAN,CAA/D;CAJY,WAAnB,CANS,CAJ6B;CAiBvCtE,UAAAA,MAAM,EAAE;CACPgJ,YAAAA,KAAK,EAAG,eAACxG,CAAD,EAAO;CACd,cAAA,MAAI,CAAC6N,cAAL,CAAoB;CACnB5T,gBAAAA,MAAM,EAAEA,MADW;CAEnBgI,gBAAAA,MAAM,EAAEA,MAFW;CAGnB3H,gBAAAA,QAAQ,EAAE;CAHS,eAApB;;CAKA0F,cAAAA,CAAC,CAAE8H,cAAH;CACA;CARM;CAjB+B,SAAnB,CAArB;CA4BA;;CAED,UAAIqF,cAAc,KAAK,CAAvB,EACA;CACC1F,QAAAA,aAAa,CAACnL,IAAd,CAAmB;CAClBhC,UAAAA,QAAQ,EAAEyI,aAAG,CAACC,UAAJ,CAAe,8BAAf,CADQ;CAElBvH,UAAAA,KAAK,EAAEL,MAAM,CAAC4F,IAAI,CAACc,SAAN;CAFK,SAAnB;CAIA;;CAED2F,MAAAA,aAAa,CAAC/D,IAAd,CAAmB,UAACC,CAAD,EAAIC,CAAJ,EAAU;CAC5B,YAAMkK,MAAM,GAAG;CACdC,UAAAA,IAAI,EAAE,CADQ;CAEdC,UAAAA,IAAI,EAAE,CAFQ;CAGdC,UAAAA,KAAK,EAAE,CAHO;CAIdC,UAAAA,MAAM,EAAE,CAJM;CAKdC,UAAAA,GAAG,EAAE,CALS;CAMdC,UAAAA,KAAK,EAAE,CANO;CAOdC,UAAAA,QAAQ,EAAE;CAPI,SAAf;;CASA,YAAIP,MAAM,CAACnK,CAAC,CAACrJ,QAAH,CAAN,GAAqBwT,MAAM,CAAClK,CAAC,CAACtJ,QAAH,CAA/B,EACA;CACC,iBAAO,CAAC,CAAR;CACA;;CACD,YAAIwT,MAAM,CAACnK,CAAC,CAACrJ,QAAH,CAAN,GAAqBwT,MAAM,CAAClK,CAAC,CAACtJ,QAAH,CAA/B,EACA;CACC,iBAAO,CAAP;CACA;;CACD,eAAO,CAAP;CACA,OAnBD;CAqBAmN,MAAAA,aAAa,CAAC3H,OAAd,CAAsB,UAACwO,YAAD,EAAkB;CAEvC,YAAMC,iBAAiB,GAAG,CAAE,0BAAF,CAA1B;;CACA,YAAIrB,eAAe,KAAKoB,YAAY,CAAChU,QAArC,EACA;CACCiU,UAAAA,iBAAiB,CAACjS,IAAlB,CAAuB,kCAAvB;CACA;;CAEDoR,QAAAA,QAAQ,CAAC3G,WAAT,CAAqBrI,aAAG,CAACsI,MAAJ,CAAW,MAAX,EAAmB;CACvCC,UAAAA,KAAK,EAAE;CACNrJ,YAAAA,SAAS,EAAE2Q,iBAAiB,CAAC1Q,IAAlB,CAAuB,GAAvB;CADL,WADgC;CAIvCqJ,UAAAA,KAAK,EAAE;CACNC,YAAAA,KAAK,EAAEpE,aAAG,CAACC,UAAJ,+BAAsCsL,YAAY,CAAChU,QAAb,CAAsB8L,WAAtB,EAAtC;CADD,WAJgC;CAOvCuB,UAAAA,QAAQ,EAAE,CACTjJ,aAAG,CAACsI,MAAJ,CAAW,MAAX,EAAmB;CAClBC,YAAAA,KAAK,EAAE;CACNrJ,cAAAA,SAAS,EAAE,CACV,0BADU,EAEV,2BAFU,iCAGc0Q,YAAY,CAAChU,QAH3B,GAITuD,IAJS,CAIJ,GAJI;CADL;CADW,WAAnB,CADS,EAUTa,aAAG,CAACsI,MAAJ,CAAW,MAAX,EAAmB;CAClBC,YAAAA,KAAK,EAAE;CACNrJ,cAAAA,SAAS,EAAE;CADL,aADW;CAIlBgQ,YAAAA,IAAI,EAAEU,YAAY,CAAC7S;CAJD,WAAnB,CAVS,CAP6B;CAwBvC+B,UAAAA,MAAM,EAAE;CACPgJ,YAAAA,KAAK,EAAE,eAACxG,CAAD,EAAO;CAEb,kBAAML,YAAY,GAAG7D,QAAQ,CAACC,cAAT,+BAA+C9B,MAA/C,EAArB;CACA,kBAAMuU,oBAAoB,GAAG7O,YAAY,CAAC6M,qBAAb,EAA7B;;CAEA,kBACCU,eAAe,CAACrN,MAAhB,IAA0B,CAA1B,IACGqN,eAAe,KAAK,KAFxB;CAIA;CACC,kBAAA,MAAI,CAACE,oBAAL,GAA4B,IAA5B;CACAzN,kBAAAA,YAAY,CAAChB,KAAb,CAAmB0O,MAAnB,aAA+BmB,oBAAoB,CAACnB,MAApD;CACA1N,kBAAAA,YAAY,CAAChB,KAAb,CAAmB2O,QAAnB,aAAiCkB,oBAAoB,CAAC7F,KAAtD;CACA,iBARD,MAUA;CACC,oBAAI6F,oBAAoB,CAAC7F,KAArB,GAA6BvN,MAAM,CAACuE,YAAY,CAAChB,KAAb,CAAmB2O,QAApB,CAAvC,EACA;CACC3N,kBAAAA,YAAY,CAAChB,KAAb,CAAmB2O,QAAnB,aAAiCkB,oBAAoB,CAAC7F,KAAtD;CACA;CACD;;CAED,cAAA,MAAI,CAACkF,cAAL,CAAoB;CACnB5T,gBAAAA,MAAM,EAAEA,MADW;CAEnBgI,gBAAAA,MAAM,EAAEA,MAFW;CAGnB3H,gBAAAA,QAAQ,EAAEgU,YAAY,CAAChU;CAHJ,eAApB;;CAKA0F,cAAAA,CAAC,CAAE8H,cAAH;CACA;CA7BM;CAxB+B,SAAnB,CAArB;CAwDA,OAhED;CAkEA,UAAI2G,SAAS,GAAGxM,MAAM,CAACtC,YAAP,CAAoB8F,aAApB,CAAkC,mCAAlC,CAAhB;CACA,UAAIiJ,eAAe,GAAG,KAAtB;;CAEA,UAAI,CAACD,SAAL,EACA;CACCA,QAAAA,SAAS,GAAG/P,aAAG,CAACsI,MAAJ,CAAW,MAAX,EAAmB;CAC9BC,UAAAA,KAAK,EAAE;CACNrJ,YAAAA,SAAS,EAAE;CADL;CADuB,SAAnB,CAAZ;CAKA,OAPD,MASA;CACC8Q,QAAAA,eAAe,GAAG,IAAlB;CACA;;CAEDD,MAAAA,SAAS,CAAC7O,gBAAV,CAA2B,yBAA3B,EAAsDE,OAAtD,CAA8D,UAAC6O,WAAD,EAAiB;CAC9EA,QAAAA,WAAW,CAACvJ,SAAZ,CAAsBC,GAAtB,CAA0B,kCAA1B;CACA,OAFD;CAIA,UAAIuJ,iBAAiB,GAAGH,SAAS,CAAChJ,aAAV,mCAAmD,KAAKpF,oBAAxD,EAAxB;;CACA,UAAI,CAACuO,iBAAL,EACA;CACCA,QAAAA,iBAAiB,GAAGlQ,aAAG,CAACsI,MAAJ,CAAW,MAAX,EAAmB;CACtCC,UAAAA,KAAK,EAAE;CACNrJ,YAAAA,SAAS,EAAE,CACV,wBADU,mCAEgB,KAAKyC,oBAFrB,GAGTxC,IAHS,CAGJ,GAHI;CADL;CAD+B,SAAnB,CAApB;CAQA4Q,QAAAA,SAAS,CAAC1H,WAAV,CAAsB6H,iBAAtB;CACA,OAXD,MAaA;CACCA,QAAAA,iBAAiB,CAACxJ,SAAlB,CAA4BG,MAA5B,CAAmC,kCAAnC;CACA;;CAEDvE,MAAAA,IAAI,CAAC6N,KAAL,CAAW/O,OAAX,CAAmB,UAACkE,IAAD,EAAU;CAE5B,YAAM8K,iBAAiB,GAAG,CAAE,0BAAF,CAA1B;;CACA,YAAInT,cAAI,CAACE,cAAL,CAAoBmI,IAAI,CAAC+K,SAAzB,CAAJ,EACA;CACCD,UAAAA,iBAAiB,CAACxS,IAAlB,oCAAmD0H,IAAI,CAAC+K,SAAxD;CACA;;CAEDH,QAAAA,iBAAiB,CAAC7H,WAAlB,CAA8BrI,aAAG,CAACsI,MAAJ,CAAW,GAAX,EAAgB;CAC7CC,UAAAA,KAAK,EAAE;CACNrJ,YAAAA,SAAS,EAAEkR,iBAAiB,CAACjR,IAAlB,CAAuB,GAAvB;CADL,WADsC;CAI7CqJ,UAAAA,KAAK,EAAE;CACN8H,YAAAA,IAAI,EAAEhL,IAAI,CAACiL,GADL;CAEN5U,YAAAA,MAAM,EAAE;CAFF,WAJsC;CAQ7CsN,UAAAA,QAAQ,EAAE,CACTjJ,aAAG,CAACsI,MAAJ,CAAW,MAAX,EAAmB;CAClBC,YAAAA,KAAK,EAAE;CACNrJ,cAAAA,SAAS,EAAE;CADL,aADW;CAIlBe,YAAAA,KAAK,EACJhD,cAAI,CAACE,cAAL,CAAoBmI,IAAI,CAACkL,SAAzB,IACG;CACD,kDAA4BlL,IAAI,CAACkL,SAAjC;CADC,aADH,GAIG;CATc,WAAnB,CADS,EAaTxQ,aAAG,CAACsI,MAAJ,CAAW,MAAX,EAAmB;CAClBC,YAAAA,KAAK,EAAE;CACNrJ,cAAAA,SAAS,EAAE;CADL,aADW;CAIlBgQ,YAAAA,IAAI,EAAE5J,IAAI,CAACmL;CAJO,WAAnB,CAbS,EAmBTzQ,aAAG,CAACsI,MAAJ,CAAW,MAAX,EAAmB;CAClBC,YAAAA,KAAK,EAAE;CACNrJ,cAAAA,SAAS,EAAE;CADL;CADW,WAAnB,CAnBS;CARmC,SAAhB,CAA9B;CAkCA,OA1CD;CA6CA,UAAMwR,QAAQ,GAAGnN,MAAM,CAACtC,YAAP,CAAoB8F,aAApB,CAAkC,gBAAlC,CAAjB;;CACA,UAAI2J,QAAJ,EACA;CACC1Q,QAAAA,aAAG,CAACqH,KAAJ,CAAUqJ,QAAV;CACA1Q,QAAAA,aAAG,CAAC6G,MAAJ,CAAW6J,QAAX;CACA;;CACD,UAAMC,WAAW,GAAGpN,MAAM,CAACtC,YAAP,CAAoB8F,aAApB,CAAkC,sBAAlC,CAApB;;CACA,UAAI4J,WAAJ,EACA;CACCA,QAAAA,WAAW,CAACC,UAAZ,CAAuBC,YAAvB,CAAoC7B,QAApC,EAA8C2B,WAA9C;CACAA,QAAAA,WAAW,CAACC,UAAZ,CAAuBE,WAAvB,CAAmCH,WAAnC;CACA,OAJD,MAMA;CACCpN,QAAAA,MAAM,CAACtC,YAAP,CAAoBoH,WAApB,CAAgC2G,QAAhC;CACA;;CAED,UAAI,CAACgB,eAAL,EACA;CACCzM,QAAAA,MAAM,CAACtC,YAAP,CAAoBoH,WAApB,CAAgC0H,SAAhC;CACA;CACD;CAp1CF;CAAA;CAAA,sCAs1C0BzU,MAt1C1B,EAu1CC;CACC,UAAMC,MAAM,GAAI0B,cAAI,CAACE,cAAL,CAAoB7B,MAAM,CAACC,MAA3B,IAAqCD,MAAM,CAACC,MAA5C,GAAqD,EAArE;CAEA,UAAMC,YAAY,GAAGC,YAAU,CAACC,WAAX,CAAuBH,MAAvB,CAArB;CACAC,MAAAA,YAAY,CAACyF,YAAb,CAA0BrE,SAA1B,GAAsC,EAAtC;CACAQ,MAAAA,QAAQ,CAACC,cAAT,+BAA+C9B,MAA/C,GAAyD0E,KAAzD,CAA+D0O,MAA/D,GAAwE,MAAxE;CACAvR,MAAAA,QAAQ,CAACC,cAAT,+BAA+C9B,MAA/C,GAAyD0E,KAAzD,CAA+D2O,QAA/D,GAA0E,MAA1E;CACApT,MAAAA,YAAY,CAACyF,YAAb,CAA0BoH,WAA1B,CAAsCrI,aAAG,CAACsI,MAAJ,CAAW,MAAX,EAAmB;CACxDC,QAAAA,KAAK,EAAE;CACNrJ,UAAAA,SAAS,EAAE;CADL;CADiD,OAAnB,CAAtC;CAKA;CAn2CF;CAAA;CAAA,mCAq2CuB5D,MAr2CvB,EAs2CC;CACC,UAAMC,MAAM,GAAI0B,cAAI,CAACE,cAAL,CAAoB7B,MAAM,CAACC,MAA3B,IAAqCD,MAAM,CAACC,MAA5C,GAAqD,EAArE;CACA,UAAMgI,MAAM,GAAGjI,MAAM,CAACiI,MAAtB;CACA,UAAM3H,QAAQ,GAAIqB,cAAI,CAACE,cAAL,CAAoB7B,MAAM,CAACM,QAA3B,IAAuCN,MAAM,CAACM,QAA9C,GAAyD,EAA3E;CAEA,UAAMyF,oBAAoB,GAAGkC,MAAM,CAACtC,YAAP,CAAoB8F,aAApB,CAAkC,mCAAlC,CAA7B;;CACA,UAAI,CAAC1F,oBAAL,EACA;CACC,eAAO,KAAP;CACA;;CAED,UAAM6O,iBAAiB,GAAG7O,oBAAoB,CAAC0F,aAArB,CAAmC,6BAA6BnL,QAAhE,CAA1B;;CACA,UAAIsU,iBAAJ,EACA;CACC,aAAKvO,oBAAL,GAA6B1E,cAAI,CAACE,cAAL,CAAoBvB,QAApB,IAAgCA,QAAhC,GAA2C,KAAxE;CAEA2H,QAAAA,MAAM,CAACtC,YAAP,CAAoBC,gBAApB,CAAqC,2BAArC,EAAkEE,OAAlE,CAA0E,UAAC2P,OAAD,EAAa;CACtFA,UAAAA,OAAO,CAACrK,SAAR,CAAkBG,MAAlB,CAAyB,kCAAzB;CACA,cAAMmK,eAAe,GAAGD,OAAO,CAAChK,aAAR,iCAA+CnL,QAA/C,EAAxB;;CACA,cAAIoV,eAAJ,EACA;CACCD,YAAAA,OAAO,CAACrK,SAAR,CAAkBC,GAAlB,CAAsB,kCAAtB;CACA;CACD,SAPD;CASAtF,QAAAA,oBAAoB,CAACH,gBAArB,CAAsC,yBAAtC,EAAiEE,OAAjE,CAAyE,UAAC6O,WAAD,EAAiB;CACzFA,UAAAA,WAAW,CAACvJ,SAAZ,CAAsBC,GAAtB,CAA0B,kCAA1B;CACA,SAFD;CAGAuJ,QAAAA,iBAAiB,CAACxJ,SAAlB,CAA4BG,MAA5B,CAAmC,kCAAnC;CACA,OAjBD,MAmBA;CACCxL,QAAAA,SAAS,CAACW,IAAV,CAAeT,MAAf,EAAuB,CAAvB,EAA0BK,QAA1B;CACA;CACD;CAx4CF;CAAA;CAAA,iDA04CqCN,MA14CrC,EA24CC;CACC,UAAMwG,IAAI,GAAIpF,MAAM,CAACpB,MAAM,CAACwG,IAAR,CAAN,GAAsB,CAAtB,GAA0BpF,MAAM,CAACpB,MAAM,CAACwG,IAAR,CAAhC,GAAgD,CAA9D;CACA,UAAMtG,YAAY,GAAI,CAACyB,cAAI,CAACoB,WAAL,CAAiB/C,MAAM,CAACiI,MAAxB,CAAD,GAAmCjI,MAAM,CAACiI,MAA1C,GAAmD,IAAzE;CACA,UAAMjB,IAAI,GAAGhH,MAAM,CAACgH,IAApB;;CAEA,UAAI,CAAC9G,YAAL,EACA;CACC,eAAO,KAAP;CACA;;CAED,UAAIsG,IAAI,KAAK,CAAb,EACA;CACCtG,QAAAA,YAAY,CAACyF,YAAb,CAA0BrE,SAA1B,GAAsC,EAAtC;CACApB,QAAAA,YAAY,CAACyF,YAAb,CAA0BoH,WAA1B,CAAsCrI,aAAG,CAACsI,MAAJ,CAAW,MAAX,EAAmB;CACxDC,UAAAA,KAAK,EAAE;CACNrJ,YAAAA,SAAS,EAAE;CADL;CADiD,SAAnB,CAAtC;CAKA;;CAED1D,MAAAA,YAAY,CAACO,gBAAb,IAAiC,CAAjC;CAEAuG,MAAAA,IAAI,CAAC6N,KAAL,CAAW/O,OAAX,CAAmB,UAACkE,IAAD,EAAU;CAC5B,YAAI2L,UAAU,GAAG,IAAjB;;CAEA,YAAIhU,cAAI,CAACE,cAAL,CAAoBmI,IAAI,CAACkL,SAAzB,CAAJ,EACA;CACCS,UAAAA,UAAU,GAAGjR,aAAG,CAACsI,MAAJ,CAAW,KAAX,EAAkB;CAC9BE,YAAAA,KAAK,EAAE;CACN0I,cAAAA,GAAG,EAAE5L,IAAI,CAACkL;CADJ,aADuB;CAI9BjI,YAAAA,KAAK,EAAE;CACNrJ,cAAAA,SAAS,EAAE;CADL;CAJuB,WAAlB,CAAb;CAQA,SAVD,MAYA;CACC+R,UAAAA,UAAU,GAAGjR,aAAG,CAACsI,MAAJ,CAAW,KAAX,EAAkB;CAC9BE,YAAAA,KAAK,EAAE;CACN0I,cAAAA,GAAG,EAAE;CADC,aADuB;CAI9B3I,YAAAA,KAAK,EAAE;CACNrJ,cAAAA,SAAS,EAAE;CADL;CAJuB,WAAlB,CAAb;CAQA;;CAED,YAAMiS,YAAY,GAAG,CACpB,oBADoB,CAArB;;CAGA,YAAIlU,cAAI,CAACE,cAAL,CAAoBmI,IAAI,CAAC+K,SAAzB,CAAJ,EACA;CACCc,UAAAA,YAAY,CAACvT,IAAb,8BAAwC0H,IAAI,CAAC+K,SAA7C;CACA;;CAED7U,QAAAA,YAAY,CAACyF,YAAb,CAA0BoH,WAA1B,CACCrI,aAAG,CAACsI,MAAJ,CAAW,GAAX,EAAgB;CACfE,UAAAA,KAAK,EAAE;CACN8H,YAAAA,IAAI,EAAEhL,IAAI,CAACiL,GADL;CAEN5U,YAAAA,MAAM,EAAE;CAFF,WADQ;CAKf4M,UAAAA,KAAK,EAAE;CACNrJ,YAAAA,SAAS,EAAEiS,YAAY,CAAChS,IAAb,CAAkB,GAAlB;CADL,WALQ;CAQf8J,UAAAA,QAAQ,EAAE,CACTjJ,aAAG,CAACsI,MAAJ,CAAW,MAAX,EAAmB;CAClBC,YAAAA,KAAK,EAAE;CACNrJ,cAAAA,SAAS,EAAE;CADL,aADW;CAIlB+J,YAAAA,QAAQ,EAAE,CACTgI,UADS,EAETjR,aAAG,CAACsI,MAAJ,CAAW,MAAX,EAAmB;CAClBC,cAAAA,KAAK,EAAE;CACNrJ,gBAAAA,SAAS,EAAE;CADL;CADW,aAAnB,CAFS;CAJQ,WAAnB,CADS,EAcTc,aAAG,CAACsI,MAAJ,CAAW,MAAX,EAAmB;CAClBC,YAAAA,KAAK,EAAE;CACNrJ,cAAAA,SAAS,EAAE;CADL,aADW;CAIlBgQ,YAAAA,IAAI,EAAE5J,IAAI,CAACmL;CAJO,WAAnB,CAdS;CARK,SAAhB,CADD;CAgCA,OAlED;CAmEA;CAp+CF;CAAA;CAAA,+BAs+CmBnV,MAt+CnB,EAu+CC;CACC,UAAMC,MAAM,GAAI0B,cAAI,CAACE,cAAL,CAAoB7B,MAAM,CAACC,MAA3B,IAAqCD,MAAM,CAACC,MAA5C,GAAqD,EAArE;;CAEA,UAAI,CAAC0B,cAAI,CAACE,cAAL,CAAoB5B,MAApB,CAAL,EACA;CACC;CACA;;CAED,WAAK4S,wBAAL,GAAgC,IAAhC;CAEA,WAAKiD,iBAAL,GAAyB,KAAKC,oBAAL,CAA0B9V,MAA1B,CAAzB;CAEAE,MAAAA,YAAU,CAACC,WAAX,CAAuBH,MAAvB,EAA+B+B,GAA/B,CAAmC+B,gBAAnC,CAAoD,YAApD,EAAkE,KAAK+R,iBAAvE;CACA;CAp/CF;CAAA;CAAA,yCAs/C6B7V,MAt/C7B,EAu/CC;CAAA;;CACC,aAAO,YAAM;CACZ,QAAA,MAAI,CAAC4S,wBAAL,GAAgC,KAAhC;CAEA1S,QAAAA,YAAU,CAACC,WAAX,CAAuBH,MAAvB,EAA+B+B,GAA/B,CAAmC2O,mBAAnC,CAAuD,YAAvD,EAAqE,MAAI,CAACmF,iBAA1E;CACA,OAJD;CAKA;CA7/CF;CAAA;CAAA,wCA+/C4B9P,CA//C5B,EAggDC;CACC,UAAM/F,MAAM,GAAG+F,CAAC,CAACyC,aAAF,CAAgBD,YAAhB,CAA6B,cAA7B,CAAf;CACA,UAAIlI,QAAQ,GAAG0F,CAAC,CAACyC,aAAF,CAAgBD,YAAhB,CAA6B,eAA7B,CAAf;;CAEA,UAAI,CAAC7G,cAAI,CAACqU,KAAL,CAAW1V,QAAX,CAAL,EACA;CACCA,QAAAA,QAAQ,GAAG,EAAX;CACA;;CAEDP,MAAAA,SAAS,CAACkW,aAAV,CAAwB;CACvBhW,QAAAA,MAAM,EAAEA,MADe;CAEvBoI,QAAAA,KAAK,EAAErC,CAFgB;CAGvB1F,QAAAA,QAAQ,EAAEA;CAHa,OAAxB;CAMA0F,MAAAA,CAAC,CAACkQ,eAAF;CACA;CAhhDF;CAAA;CAAA,6CAkhDiClQ,CAlhDjC,EAmhDC;CACC,UAAM/F,MAAM,GAAG+F,CAAC,CAACyC,aAAF,CAAgBD,YAAhB,CAA6B,cAA7B,CAAf;CACA,UAAMlI,QAAQ,GAAG0F,CAAC,CAACyC,aAAF,CAAgBD,YAAhB,CAA6B,eAA7B,CAAjB;CAEAzI,MAAAA,SAAS,CAACoW,kBAAV,CAA6B;CAC5BlW,QAAAA,MAAM,EAAEA,MADoB;CAE5BoI,QAAAA,KAAK,EAAErC,CAFqB;CAG5B1F,QAAAA,QAAQ,EAAEA;CAHkB,OAA7B;CAKA;CA5hDF;CAAA;CAAA,6CA8hDiC0F,CA9hDjC,EA+hDC;CACC,UAAM/F,MAAM,GAAG+F,CAAC,CAACyC,aAAF,CAAgBD,YAAhB,CAA6B,cAA7B,CAAf;CACA,UAAMlI,QAAQ,GAAG0F,CAAC,CAACyC,aAAF,CAAgBD,YAAhB,CAA6B,eAA7B,CAAjB;CAEAzI,MAAAA,SAAS,CAACqW,kBAAV,CAA6B;CAC5BnW,QAAAA,MAAM,EAAEA,MADoB;CAE5BK,QAAAA,QAAQ,EAAEA;CAFkB,OAA7B;CAIA;CAviDF;CAAA;CAAA,4CAyiDgCN,MAziDhC,EA0iDC;CACCqW,MAAAA,WAAW,CAACC,WAAZ,CAAwBC,aAAxB,CAAsC;CACrCC,QAAAA,GAAG,YAAKzN,aAAG,CAACC,UAAJ,CAAe,UAAf,CAAL,2BADkC;CAErCmE,QAAAA,KAAK,EAAEpE,aAAG,CAACC,UAAJ,CAAe,qBAAf,CAF8B;CAGrCyN,QAAAA,QAAQ,EAAE;CACTC,UAAAA,qBAAqB,EAAE;CADd,SAH2B;CAMrCC,QAAAA,KAAK,EAAE,IAN8B;CAOrC3P,QAAAA,IAAI,EAAE;CACLE,UAAAA,YAAY,EAAElH,MAAM,CAACkH,YADhB;CAELE,UAAAA,QAAQ,EAAEpH,MAAM,CAACoH;CAFZ;CAP+B,OAAtC;CAYA;CAvjDF;CAAA;CAAA,iCAyjDqBwP,SAzjDrB,EA0jDC;CACCzW,MAAAA,YAAU,CAAC0W,IAAX,CAAgB/Q,OAAhB,CAAwB,UAAC5F,YAAD,EAAeD,MAAf,EAA0B;CACjD,YACCC,YAAY,CAACgH,YAAb,KAA8B0P,SAAS,CAAC1P,YAAxC,IACG9F,MAAM,CAAClB,YAAY,CAACkH,QAAd,CAAN,KAAkChG,MAAM,CAACwV,SAAS,CAACxP,QAAX,CAF5C,EAIA;CACC;CACA;;CAED,YAAI0P,UAAU,GAAInV,cAAI,CAACE,cAAL,CAAoB+U,SAAS,CAACE,UAA9B,IAA4CF,SAAS,CAACE,UAAV,CAAqB1K,WAArB,EAA5C,GAAiF,KAAnG;CACA0K,QAAAA,UAAU,GAAIA,UAAU,KAAK,MAAf,GAAwB,KAAxB,GAAgCA,UAA9C;;CAEA,YACC1V,MAAM,CAACwV,SAAS,CAAChM,MAAX,CAAN,KAA6BxJ,MAAM,CAAC2H,aAAG,CAACC,UAAJ,CAAe,SAAf,CAAD,CAAnC,IACG9I,YAAY,CAAC6W,MAFjB,EAIA;CACC,cAAID,UAAU,KAAK,QAAnB,EACA;CACC5W,YAAAA,YAAY,CAAC6W,MAAb,CAAoB3L,SAApB,CAA8BG,MAA9B,CAAqC,oBAArC;CAEA,WAJD,MAMA;CACCrL,YAAAA,YAAY,CAAC6W,MAAb,CAAoB3L,SAApB,CAA8BC,GAA9B,CAAkC,oBAAlC;CACA;CACD;;CAEDlL,QAAAA,YAAU,CAAC6W,IAAX,CAAgB/W,MAAhB,EAAwB;CACvBgX,UAAAA,IAAI,EAAEH,UADiB;CAEvBI,UAAAA,OAAO,EAAEN,SAAS,CAAChM,MAFI;CAGvBuM,UAAAA,cAAc,EAAEP,SAAS,CAAC1P,YAHH;CAIvBkQ,UAAAA,SAAS,EAAER,SAAS,CAACxP,QAJE;CAKvBiQ,UAAAA,SAAS,EAAET,SAAS,CAACU,QALE;CAMvBC,UAAAA,QAAQ,EAAEX,SAAS,CAACY,YANG;CAOvBC,UAAAA,YAAY,EAAEb,SAAS,CAACc,eAPD;CAQvBC,UAAAA,oBAAoB,EAAEf,SAAS,CAACgB;CART,SAAxB;CAUA,OAtCD;CAuCA;CAlmDF;CAAA;CAAA,0CAqmDC;CACC,UAAMC,wBAAwB,GAAG/V,QAAQ,CAAC2J,aAAT,CAAuB,kCAAvB,CAAjC;;CACA,UAAIoM,wBAAJ,EACA;CACCA,QAAAA,wBAAwB,CAAClT,KAAzB,CAA+BwE,GAA/B,GAAqC,CAArC;CACA0O,QAAAA,wBAAwB,CAAClT,KAAzB,CAA+B0J,IAA/B,GAAsC,CAAtC;CACAwJ,QAAAA,wBAAwB,CAACzM,SAAzB,CAAmCG,MAAnC,CAA0C,8BAA1C;CACAsM,QAAAA,wBAAwB,CAACzM,SAAzB,CAAmCG,MAAnC,CAA0C,oCAA1C;CACAsM,QAAAA,wBAAwB,CAACzM,SAAzB,CAAmCG,MAAnC,CAA0C,yCAA1C;CACAsM,QAAAA,wBAAwB,CAACzM,SAAzB,CAAmCC,GAAnC,CAAuC,uCAAvC;CACAwM,QAAAA,wBAAwB,CAACzM,SAAzB,CAAmCC,GAAnC,CAAuC,8CAAvC;CACA;CACD;CAjnDF;CAAA;CAAA,4BAmnDgByM,IAnnDhB,EAonDC;CACC,UAAInW,cAAI,CAACC,SAAL,CAAekW,IAAf,CAAJ,EACA;CACC,eAAOA,IAAP;CACA,OAHD,MAIK,IAAInW,cAAI,CAACE,cAAL,CAAoBiW,IAApB,CAAJ,EACL;CACC,eAAOhW,QAAQ,CAACC,cAAT,CAAwB+V,IAAxB,CAAP;CACA,OAHI,MAKL;CACC,eAAO,IAAP;CACA;CACD;CAjoDF;CAAA;CAAA;6BAAa1R,+BAEW,CAAE,MAAF,EAAU,MAAV,EAAkB,OAAlB,EAA2B,QAA3B,EAAqC,KAArC,EAA4C,OAA5C,EAAqD,UAArD;6BAFXA,sCAGkB;6BAHlBA,gCAIY;6BAJZA,sCAKkB;6BALlBA,gCAMY;6BANZA,uCAOmB;6BAPnBA,0CAQsB;6BARtBA,mCASe;6BATfA,oCAUgB;6BAVhBA,sCAWkB;CAC7BgK,EAAAA,CAAC,EAAE,IAD0B;CAE7BG,EAAAA,CAAC,EAAE;CAF0B;6BAXlBnK,0CAesB;6BAftBA,iCAiBa;6BAjBbA,gCAkBY;6BAlBZA,qCAoBiB;6BApBjBA,+BAqBW;6BArBXA,gCAuBY;6BAvBZA,yCAwBqB;6BAxBrBA,0CAyBsB;6BAzBtBA,sCA0BkB;6BA1BlBA,+CA2B2B;6BA3B3BA,4CA4BwB;6BA5BxBA,4CA6BwB;6BA7BxBA,yCA8BqB;6BA9BrBA,uCA+BmB;6BA/BnBA,qDAAAA,YAiCiC,CAAK2R,4BAAL,CAAkClP,IAAlC,CAjCjCzC,YAiCiC;6BAjCjCA,sDAAAA,YAkCkC,CAAK4R,6BAAL,CAAmCnP,IAAnC,CAlClCzC,YAkCkC;6BAlClCA,iDAAAA,YAmC6B,CAAK6R,wBAAL,CAA8BpP,IAA9B,CAnC7BzC,YAmC6B;;KCpC7B7D,aAAb;CAAA;CAAA;CAAA;;CAAA;CAAA;CAAA,yBAUavC,MAVb,EAWC;CAAA;;CACC,UAAI,CAAC2B,cAAI,CAAC4R,aAAL,CAAmBvT,MAAnB,CAAL,EACA;CACCA,QAAAA,MAAM,GAAG,EAAT;CACA;;CAED,UAAI,KAAKkY,WAAT,EACA;CACC;CACA;;CAED,WAAK1V,MAAL,GAAe,CAACb,cAAI,CAACoB,WAAL,CAAiB/C,MAAM,CAACwC,MAAxB,CAAD,IAAoC,CAAC,CAACxC,MAAM,CAACwC,MAA5D;CAEA,WAAK0V,WAAL,GAAmB,IAAnB;CAEA,WAAKC,gBAAL;;CAEA,UAAI,CAAC,KAAK3V,MAAV,EACA;CACCwN,QAAAA,MAAM,CAACjM,gBAAP,CAAwB,QAAxB,EAAkCoO,iBAAO,CAACiG,QAAR,CAAiB,YAAM;CACxD,UAAA,KAAI,CAACC,cAAL;CACA,SAFiC,EAE/B,EAF+B,CAAlC,EAEQ;CAAEtG,UAAAA,OAAO,EAAE;CAAX,SAFR;CAIA/B,QAAAA,MAAM,CAACjM,gBAAP,CAAwB,QAAxB,EAAkC,KAAKoU,gBAAL,CAAsBtP,IAAtB,CAA2B,IAA3B,CAAlC;CACA;;CAED7D,MAAAA,6BAAY,CAACsT,SAAb,CAAuB,+BAAvB,EAAwDlS,YAAY,CAAC6R,wBAArE;CACAjT,MAAAA,6BAAY,CAACsT,SAAb,CAAuB,2BAAvB,EAAoDlS,YAAY,CAACmS,mBAAjE;;CAEA,UAAI,KAAK/V,MAAT,EACA;CACC;CACA6T,QAAAA,WAAW,CAACmC,cAAZ,CAA2B,cAA3B,EAA2CpS,YAAY,CAACqS,YAAxD;CACA;;CAED,UAAI,KAAKjW,MAAT,EACA;CACC6T,QAAAA,WAAW,CAACmC,cAAZ,CAA2B,aAA3B,EAA0C,UAACxR,IAAD,EAAU;CACnD,cAAIA,IAAI,CAAC0R,OAAL,IAAgB,aAApB,EACA;CACCvY,YAAAA,UAAU,CAACwY,UAAX,CAAsB3R,IAAI,CAAChH,MAA3B;CACA;CACD,SALD;CAMA,OARD,MAUA;CACCgF,QAAAA,6BAAY,CAACsT,SAAb,CAAuB,kBAAvB,EAA2C,UAACjQ,KAAD,EAAsB;CAChE,qCAA4BA,KAAK,CAACuQ,aAAN,EAA5B;CAAA;CAAA,cAAQF,OAAR;CAAA,cAAiB1Y,MAAjB;;CAEA,cAAI0Y,OAAO,KAAK,aAAhB,EACA;CACCvY,YAAAA,UAAU,CAACwY,UAAX,CAAsB3Y,MAAtB;CACA;CACD,SAPD;;CASA,YACC,CAAC2B,cAAI,CAACoB,WAAL,CAAiBiN,MAAM,CAAC9K,EAAP,CAAUC,SAA3B,CAAD,IACGD,EAAE,CAACC,SAAH,CAAaC,QAAb,CAAsBC,YAAtB,EAFJ,EAIA;CACCL,UAAAA,6BAAY,CAACsT,SAAb,CACCpT,EAAE,CAACC,SAAH,CAAaC,QAAb,CAAsBC,YAAtB,GAAqCC,SAArC,EADD,EAEC,kCAFD,EAGCvF,SAAS,CAACwF,oBAHX;CAKA;CACD;CACD;CA9EF;CAAA;CAAA,uCAiFC;CACC,WAAKsT,aAAL,GAAqB/W,QAAQ,CAACgX,eAAT,CAAyBC,YAA9C;CACA;CAnFF;CAAA;CAAA,qCAsFC;CAAA;;CACC,UAAIC,UAAU,GAAG,IAAjB;CACA,WAAKC,WAAL,CAAiBnT,OAAjB,CAAyB,UAACoT,KAAD,EAAQC,GAAR,EAAgB;CAExCH,QAAAA,UAAU,GAAG9T,EAAE,CAAC,MAAI,CAAC2F,OAAL,CAAasO,GAAb,CAAD,CAAf;;CAEA,YAAI,CAACH,UAAL,EACA;CACC;CACA;;CAED,YAAI,MAAI,CAACI,qBAAL,CAA2BJ,UAA3B,CAAJ,EACA;CACC,UAAA,MAAI,CAACK,aAAL,CAAmBF,GAAnB;CACA;CACD,OAbD;CAcA;CAtGF;CAAA;CAAA,4BAwGgB/R,QAxGhB,EAwG0B0Q,IAxG1B,EAyGC;CACC,UACC,CAACnW,cAAI,CAACC,SAAL,CAAekW,IAAf,CADF;CAAA,QAIA;CACC;CACA;;CAED,WAAKwB,cAAL,CAAoBC,GAApB,CAAwBnS,QAAxB,EAAkC0Q,IAAlC;CACA;CAnHF;CAAA;CAAA,4BAsHgB1Q,QAtHhB,EAuHC;CACC,UAAM0Q,IAAI,GAAG,KAAKwB,cAAL,CAAoBE,GAApB,CAAwBpS,QAAxB,CAAb;CACA,aAAQ,CAACzF,cAAI,CAACoB,WAAL,CAAiB+U,IAAjB,CAAD,GAA0BA,IAA1B,GAAiC,KAAzC;CACA;CA1HF;CAAA;CAAA,0CA4H8BA,IA5H9B,EA6HC;CACC,UAAM3H,MAAM,GAAG2H,IAAI,CAACtF,qBAAL,EAAf;CACA,UAAMiH,cAAc,GAAGrY,MAAM,CAAC,KAAKyX,aAAL,GAAqB,EAAtB,CAA7B;CACA,UAAMa,iBAAiB,GAAGtY,MAAM,CAAC,KAAKyX,aAAL,GAAqB,CAArB,GAAyB,EAA1B,CAAhC;CAEA,aACC,CAEE1I,MAAM,CAAChH,GAAP,GAAa,CAAb,IACGgH,MAAM,CAAChH,GAAP,GAAauQ,iBAFjB,IAKCvJ,MAAM,CAACyC,MAAP,GAAgB6G,cAAhB,IACGtJ,MAAM,CAACyC,MAAP,GAAgB,KAAKiG,aAP1B,MAWC,KAAKrW,MAAL,IACG,EAED2N,MAAM,CAAChH,GAAP,GAAasQ,cAAb,IACGtJ,MAAM,CAACyC,MAAP,GAAgB6G,cAFpB,IAKAtJ,MAAM,CAAChH,GAAP,GAAauQ,iBAAb,IACGvJ,MAAM,CAACyC,MAAP,GAAgB8G,iBAPjB,CAZJ,CADD;CAyBA;CA3JF;CAAA;CAAA,kCA6JsBP,GA7JtB,EA8JC;CACC,WAAKF,WAAL,WAAwBE,GAAxB;CACA;CAhKF;CAAA;CAAA,8BAkKkB/R,QAlKlB,EAkK4BuS,YAlK5B,EAmKC;CACC,UACC,CAAC,KAAKC,UAAL,CAAgBpP,QAAhB,CAAyBpD,QAAzB,CAAD,IACGuS,YAAY,CAAC5O,iBAFjB,EAIC;CACC,aAAK6O,UAAL,CAAgBtX,IAAhB,CAAqB8E,QAArB;CACA,aAAKyS,OAAL,CAAazS,QAAb,EAAuBuS,YAAY,CAAC5O,iBAApC;CACA;CACF;CA5KF;CAAA;CAAA,yBA8Ka/K,MA9Kb,EA+KC;CACC,UACC2B,cAAI,CAACoB,WAAL,CAAiB/C,MAAM,CAACiX,IAAxB,KACGjX,MAAM,CAACiX,IAAP,KAAgB,KADnB,IAEG,CAACtV,cAAI,CAACE,cAAL,CAAoB7B,MAAM,CAACmX,cAA3B,CAFJ,IAGGxV,cAAI,CAACoB,WAAL,CAAiB/C,MAAM,CAACoX,SAAxB,CAHH,IAIGhW,MAAM,CAACpB,MAAM,CAACoX,SAAR,CAAN,IAA4B,CALhC,EAOA;CACC;CACA;;CAED,UAAM+B,GAAG,aAAMnZ,MAAM,CAACmX,cAAb,cAA+BnX,MAAM,CAACoX,SAAtC,CAAT;;CACA,UAAI,CAAC,KAAK0C,WAAL,CAAiBX,GAAjB,CAAL,EACA;CACC;CACA;;CAED,UAAMH,UAAU,GAAG,KAAKnO,OAAL,CAAasO,GAAb,CAAnB;;CACA,UAAI,CAACH,UAAL,EACA;CACC,eAAO,KAAP;CACA;;CAED,UAAI,KAAKI,qBAAL,CAA2BJ,UAA3B,CAAJ,EACA;CACC,aAAKK,aAAL,CAAmBF,GAAnB;CACA,OAHD,MAKA;CACC,aAAKY,UAAL,CAAgB/Z,MAAhB;CACA;CACD;CA/MF;CAAA;CAAA,gCAiNoBoH,QAjNpB,EAkNC;CACC,aAAO,KAAKwS,UAAL,CAAgBpP,QAAhB,CAAyBpD,QAAzB,CAAP;CACA;CApNF;CAAA;CAAA,+BAsNmB4S,UAtNnB,EAuNC;CACC,UACC,CAACrY,cAAI,CAACE,cAAL,CAAoBmY,UAAU,CAAC7C,cAA/B,CAAD,IACGxV,cAAI,CAACoB,WAAL,CAAiBiX,UAAU,CAAC5C,SAA5B,CADH,IAEGhW,MAAM,CAAC4Y,UAAU,CAAC5C,SAAZ,CAAN,IAAgC,CAHpC,EAKA;CACC;CACA;;CAED,UAAM+B,GAAG,aAAMa,UAAU,CAAC7C,cAAjB,cAAmC6C,UAAU,CAAC5C,SAA9C,CAAT;CAEA,UAAI6C,eAAe,GAAG,KAAKhB,WAAL,CAAiBO,GAAjB,CAAqBL,GAArB,CAAtB;;CACA,UAAIxX,cAAI,CAACoB,WAAL,CAAiBkX,eAAjB,CAAJ,EACA;CACCA,QAAAA,eAAe,GAAG,EAAlB;CACA;;CAEDA,MAAAA,eAAe,CAAC3X,IAAhB,CAAqB0X,UAArB;CACA,WAAKf,WAAL,CAAiBM,GAAjB,CAAqBJ,GAArB,EAA0Bc,eAA1B;CACA;CA3OF;CAAA;CAAA;6BAAa1X,yBAEI;6BAFJA,8BAGS;6BAHTA,gCAIW;6BAJXA,iCAKY;6BALZA,6BAMQ;6BANRA,iCAOY,IAAI2X,GAAJ;6BAPZ3X,8BAQS,IAAI2X,GAAJ;;KCLT/Z,YAAb;CAOC,sBAAYF,MAAZ,EAAoBiH,YAApB,EAAkCE,QAAlC,EAA4C+S,SAA5C,EAAuDvP,MAAvD,EAA+DwP,QAA/D,EAAyE5Y,QAAzE,EAAmFgG,iBAAnF,EACA;CAAA;;CACC,QAAI7F,cAAI,CAAC0Y,QAAL,CAAcC,SAAS,CAAC,CAAD,CAAvB,CAAJ,EACA;CACC,UAAMta,MAAM,GAAGsa,SAAS,CAAC,CAAD,CAAxB;CAEA,WAAKra,MAAL,GAAc0B,cAAI,CAACE,cAAL,CAAoB7B,MAAM,CAACC,MAA3B,IAAqCD,MAAM,CAACC,MAA5C,GAAqD,EAAnE;CACA,WAAKiH,YAAL,GAAoBvF,cAAI,CAACE,cAAL,CAAoB7B,MAAM,CAACkH,YAA3B,IAA2ClH,MAAM,CAACkH,YAAlD,GAAiE,EAArF;CACA,WAAKE,QAAL,GAAgB,CAACzF,cAAI,CAACoB,WAAL,CAAiB/C,MAAM,CAACoH,QAAxB,CAAD,GAAqChG,MAAM,CAACpB,MAAM,CAACoH,QAAR,CAA3C,GAA+D,CAA/E;CACA,WAAK+S,SAAL,GAAiBxY,cAAI,CAACE,cAAL,CAAoB7B,MAAM,CAACma,SAA3B,IAAwCna,MAAM,CAACma,SAAP,KAAqB,GAA7D,GAAmE,KAApF;CACA,WAAKvP,MAAL,GAAc,CAACjJ,cAAI,CAACoB,WAAL,CAAiB/C,MAAM,CAAC4K,MAAxB,CAAD,GAAmCxJ,MAAM,CAACpB,MAAM,CAAC4K,MAAR,CAAzC,GAA2D,CAAzE;CACA,WAAKwP,QAAL,GAAgBzY,cAAI,CAAC4R,aAAL,CAAmBvT,MAAM,CAACoa,QAA1B,IAAsCpa,MAAM,CAACoa,QAA7C,GAAwD,EAAxE;CACA,WAAK5Y,QAAL,GAAgBG,cAAI,CAACE,cAAL,CAAoB7B,MAAM,CAACwB,QAA3B,IAAuCxB,MAAM,CAACwB,QAA9C,GAAyD,EAAzE;CACA,WAAKgG,iBAAL,GAAyB7F,cAAI,CAACE,cAAL,CAAoB7B,MAAM,CAACwH,iBAA3B,IAAgDxH,MAAM,CAACwH,iBAAvD,GAA2E,EAApG;CACA,KAZD,MAcA;CACC,WAAKvH,MAAL,GAAc0B,cAAI,CAACE,cAAL,CAAoByY,SAAS,CAAC,CAAD,CAA7B,IAAoCA,SAAS,CAAC,CAAD,CAA7C,GAAmD,EAAjE;CACA,WAAKpT,YAAL,GAAoBvF,cAAI,CAACE,cAAL,CAAoByY,SAAS,CAAC,CAAD,CAA7B,IAAoCA,SAAS,CAAC,CAAD,CAA7C,GAAmD,EAAvE;CACA,WAAKlT,QAAL,GAAgB,CAACzF,cAAI,CAACoB,WAAL,CAAiBuX,SAAS,CAAC,CAAD,CAA1B,CAAD,GAAkClZ,MAAM,CAACkZ,SAAS,CAAC,CAAD,CAAV,CAAxC,GAAyD,CAAzE;CACA,WAAKH,SAAL,GAAiBxY,cAAI,CAACE,cAAL,CAAoByY,SAAS,CAAC,CAAD,CAA7B,IAAoCA,SAAS,CAAC,CAAD,CAAT,KAAiB,GAArD,GAA2D,KAA5E;CACA,WAAK1P,MAAL,GAAc,CAACjJ,cAAI,CAACoB,WAAL,CAAiBuX,SAAS,CAAC,CAAD,CAA1B,CAAD,GAAkClZ,MAAM,CAACkZ,SAAS,CAAC,CAAD,CAAV,CAAxC,GAAyD,CAAvE;CACA,WAAKF,QAAL,GAAgBzY,cAAI,CAAC4R,aAAL,CAAmB+G,SAAS,CAAC,CAAD,CAA5B,IAAmCA,SAAS,CAAC,CAAD,CAA5C,GAAkD,EAAlE;CACA,WAAK9Y,QAAL,GAAgBG,cAAI,CAACE,cAAL,CAAoByY,SAAS,CAAC,CAAD,CAA7B,IAAoCA,SAAS,CAAC,CAAD,CAA7C,GAAmD,EAAnE;CACA,WAAK9S,iBAAL,GAAyB7F,cAAI,CAACE,cAAL,CAAoByY,SAAS,CAAC,CAAD,CAA7B,IAAoCA,SAAS,CAAC,CAAD,CAA7C,GAAmD,EAA5E;CACA;;CAED,QAAMnB,GAAG,aAAM,KAAKjS,YAAX,cAA2B,KAAKE,QAAhC,CAAT;CAEA,SAAKmT,OAAL,GAAe,IAAf;CAEA,SAAKvY,GAAL,GAAWF,QAAQ,CAACC,cAAT,2BAA2C,KAAK9B,MAAhD,EAAX;;CACA,QAAI,KAAK+B,GAAL,KAAa,IAAjB,EACA;CACC,WAAKuY,OAAL,GAAe,KAAf;CACA,aAAO,KAAP;CACA;;CAED,SAAKvY,GAAL,CAASkG,YAAT,CAAsB,qBAAtB,EAA6CjI,MAA7C;CAEA,SAAK8W,MAAL,GAAc,KAAK/U,GAAL,CAASyJ,aAAT,CAAuB,qBAAvB,CAAd;CACA,SAAKR,UAAL,GAAkB,KAAK8L,MAAL,CAAYtL,aAAZ,CAA0B,gBAA1B,CAAlB;CACA,SAAKhK,KAAL,GAAa,KAAKO,GAAL,CAASyJ,aAAT,CAAuB,0BAAvB,CAAb;;CACA,QAAI,CAAC,KAAKhK,KAAV,EACA;CACC,WAAKA,KAAL,GAAaK,QAAQ,CAACC,cAAT,0BAA0C,KAAK9B,MAA/C,EAAb;CACA;;CACD,SAAKoB,SAAL,GAAiB,KAAKI,KAAL,CAAWgK,aAAX,CAAyB,iBAAzB,CAAjB;CAEA,SAAKV,iBAAL,GAAyBjJ,QAAQ,CAACC,cAAT,+CAA+D,KAAK9B,MAApE,EAAzB;CACA,SAAKoC,QAAL,GAAgBP,QAAQ,CAACC,cAAT,qCAAqD,KAAK9B,MAA1D,EAAhB;CACA,SAAK+K,YAAL,GAAoBlJ,QAAQ,CAACC,cAAT,8BAA8C,KAAK9B,MAAnD,EAApB;CACA,SAAKua,gBAAL,GAAwB1Y,QAAQ,CAACC,cAAT,mCAAmD,KAAK9B,MAAxD,EAAxB;CACA,SAAKqK,gBAAL,GAAwBxI,QAAQ,CAACC,cAAT,kCAAkD,KAAK9B,MAAvD,EAAxB;CACA,SAAK6K,aAAL,GAAqBhJ,QAAQ,CAACC,cAAT,iCAAiD,KAAK9B,MAAtD,EAArB;CAEA,SAAKgC,KAAL,GAAa,IAAb;CACA,SAAKwY,OAAL,GAAe,IAAf;CACA,SAAK9Z,kBAAL,GAA0B,IAA1B;CACA,SAAK4H,kBAAL,GAA0B,IAA1B;CAEA,SAAK5C,YAAL,GAAoB7D,QAAQ,CAACC,cAAT,+BAA+C,KAAK9B,MAApD,GAA8DwL,aAA9D,CAA4E,qBAA5E,CAApB;CACA,SAAKhL,gBAAL,GAAwB,CAAxB;CACA,SAAKwD,YAAL,GAAoB,KAApB;CACA,SAAKyW,WAAL,GAAmB,KAAnB;CACA,SAAKxI,gBAAL,GAAwB,IAAxB;CACA,SAAKxQ,OAAL,GAAgBC,cAAI,CAACC,SAAL,CAAe,KAAKS,QAApB,IAAgC,CAAhC,GAAoC,CAApD;CACA,SAAKrB,oBAAL,GAA4B,EAA5B;CACA,SAAK4F,OAAL,GAAe,IAAf;;CAEA,QACC,KAAKpF,QAAL,KAAkB,OAAlB,IACGG,cAAI,CAACC,SAAL,CAAe,KAAKkJ,aAApB,CAFJ,EAIA;CACC,UAAMqB,SAAS,GAAG,KAAKrB,aAAL,CAAmBW,aAAnB,CAAiC,iCAAjC,CAAlB;;CACA,UAAIU,SAAJ,EACA;CACC,YAAIW,aAAa,GAAGX,SAAS,CAAC3D,YAAV,CAAuB,qBAAvB,CAApB;;CACA,YACA;CACCsE,UAAAA,aAAa,GAAGM,IAAI,CAACuN,KAAL,CAAW7N,aAAX,CAAhB;CAEA,cAAM3B,WAAW,GAAG,EAApB;CACAqI,UAAAA,MAAM,CAACC,OAAP,CAAe3G,aAAf,EAA8BhH,OAA9B,CAAsC,gBAAuB;CAAA;CAAA,gBAArBxF,QAAqB;CAAA,gBAAXmB,KAAW;;CAC5D0J,YAAAA,WAAW,CAAC7I,IAAZ,CAAiB;CAChBhC,cAAAA,QAAQ,EAAEA,QADM;CAEhBmB,cAAAA,KAAK,EAAEA,KAFS;CAGhBqK,cAAAA,OAAO,EAAE;CAHO,aAAjB;CAKA,WAND;CAQA1F,UAAAA,YAAY,CAAC8F,aAAb,CAA2B;CAC1BjM,YAAAA,MAAM,EAAEA,MADkB;CAE1BkM,YAAAA,SAAS,EAAEA,SAFe;CAG1BnF,YAAAA,IAAI,EAAEmE;CAHoB,WAA3B;CAKA,SAlBD,CAmBA,OAAOnF,CAAP,EACA;CAEA;CACD;;CAED,QAAI,CAACrE,cAAI,CAACoB,WAAL,CAAiB5C,UAAU,CAACya,YAAX,CAAwBpB,GAAxB,CAA4BL,GAA5B,CAAjB,CAAL,EACA;CACC,WAAK0B,QAAL,GAAgB1a,UAAU,CAACya,YAAX,CAAwBpB,GAAxB,CAA4BL,GAA5B,CAAhB;CAEA,UAAMH,UAAU,GAAIxX,QAAQ,KAAK,UAAb,GAA0B,KAAKuV,MAA/B,GAAwC,KAAKtV,KAAjE;;CACA,UAAI,KAAKoZ,QAAL,KAAkB,MAAtB,EACA;CACC7B,QAAAA,UAAU,CAAC5N,SAAX,CAAqBC,GAArB,CAAyB,aAAzB;CACA,OAHD,MAKA;CACC2N,QAAAA,UAAU,CAAC5N,SAAX,CAAqBG,MAArB,CAA4B,aAA5B;CACA;CACD,KAbD,MAeA;CACC,WAAKsP,QAAL,GACC,CAAC,KAAKrZ,QAAL,KAAkB,UAAlB,GAA+B,KAAKuV,MAApC,GAA6C,KAAKtV,KAAnD,EAA0D2J,SAA1D,CAAoEE,QAApE,CAA6E,aAA7E,IACG,MADH,GAEG,QAHJ;CAKAnL,MAAAA,UAAU,CAACya,YAAX,CAAwBrB,GAAxB,CAA4BJ,GAA5B,EAAiC,KAAK0B,QAAtC;CACA;;CAED,QAAI,CAAClZ,cAAI,CAACoB,WAAL,CAAiB5C,UAAU,CAAC2a,gBAAX,CAA4BtB,GAA5B,CAAgCL,GAAhC,CAAjB,CAAL,EACA;CACC,WAAK4B,YAAL,GAAoB5a,UAAU,CAAC2a,gBAAX,CAA4BtB,GAA5B,CAAgCL,GAAhC,CAApB;CACA,WAAK1X,KAAL,CAAWyG,YAAX,CAAwB,iBAAxB,EAA2C,KAAK6S,YAAhD;CACA,KAJD,MAMA;CACC,UAAMA,YAAY,GAAG,KAAKtZ,KAAL,CAAW+G,YAAX,CAAwB,iBAAxB,CAArB;CACA,WAAKuS,YAAL,GAAqBpZ,cAAI,CAACE,cAAL,CAAoBkZ,YAApB,IAAoCA,YAApC,GAAmD,MAAxE;CACA5a,MAAAA,UAAU,CAAC2a,gBAAX,CAA4BvB,GAA5B,CAAgCJ,GAAhC,EAAqC,KAAK4B,YAA1C;CACA;;CAED,QAAI,KAAKhQ,iBAAT,EACA;CACCxI,MAAAA,aAAa,CAACyY,SAAd,CAAwB7B,GAAxB,EAA6B,IAA7B;CACA;;CAED,WAAO,IAAP;CACA;;CAzJF;CAAA;CAAA,gCA2JoBlZ,MA3JpB,EA2JoCC,YA3JpC,EA4JC;CACC,WAAK2W,IAAL,CAAU0C,GAAV,CAActZ,MAAd,EAAsBC,YAAtB;CACA8P,MAAAA,MAAM,CAACiL,IAAP,CAAYhb,MAAZ,IAAsBC,YAAtB;CACA;CA/JF;CAAA;CAAA,gCAiKoBD,MAjKpB,EAkKC;CACC,aAAO,KAAK4W,IAAL,CAAU2C,GAAV,CAAcvZ,MAAd,CAAP;CACA;CApKF;CAAA;CAAA,8BAsKkB+F,CAtKlB,EAsKqB/F,MAtKrB,EAsK6BwK,YAtK7B,EAsK2CyQ,QAtK3C,EAuKC;CAAA;;CACC,UAAIvZ,cAAI,CAACoB,WAAL,CAAiB0H,YAAjB,CAAJ,EACA;CACCA,QAAAA,YAAY,GAAG,MAAf;CACA;;CAED,UAAMvK,YAAY,GAAG,KAAKE,WAAL,CAAiBH,MAAjB,CAArB;CACA,UAAMkM,SAAS,GAAIjM,YAAY,CAACsB,QAAb,KAA0B,UAA1B,GAAuCwE,CAAC,CAAC3F,MAAzC,GAAkDH,YAAY,CAACuB,KAAlF;;CAEA,UACCvB,YAAY,CAACwB,OAAb,KAAyB,CAAzB,IACGxB,YAAY,CAACoK,gBAFjB,EAIA;CACClE,QAAAA,YAAY,CAACwL,kBAAb,CAAgC;CAC/B3R,UAAAA,MAAM,EAAEA;CADuB,SAAhC;CAGAmG,QAAAA,YAAY,CAACkM,mBAAb;CACAxQ,QAAAA,QAAQ,CAAC6O,mBAAT,CAA6B,WAA7B,EAA0CvK,YAAY,CAAC6H,6BAAvD;CACA;;CAEDjK,MAAAA,YAAY,CAAC9D,YAAY,CAACwa,WAAd,CAAZ;CAEA,UAAMS,MAAM,GAAGhP,SAAS,CAACf,SAAV,CAAoBE,QAApB,CAA6B,aAA7B,CAAf;CAEA4P,MAAAA,QAAQ,GAAG,CAAC,CAACA,QAAb;CAEA,UAAIE,MAAM,GAAG,KAAb;CACA,UAAI1Q,eAAe,GAAG,KAAtB;;CAEA,UAAIyQ,MAAM,IAAI,CAACD,QAAf,EACA;CACCzQ,QAAAA,YAAY,GACXvK,YAAY,CAACwB,OAAb,KAAyB,CAAzB,GACG0E,YAAY,CAACiV,eAAb,CAA6B;CAC9B/Q,UAAAA,gBAAgB,EAAEpK,YAAY,CAACoK;CADD,SAA7B,CADH,GAIG,KALJ;CAQApK,QAAAA,YAAY,CAAC+K,UAAb,CAAwB3J,SAAxB,GAAoCpB,YAAY,CAACka,QAAb,CAAsB,QAAtB,CAApC;CACAla,QAAAA,YAAY,CAACmB,SAAb,CAAuBC,SAAvB,GAAmCF,MAAM,CAAClB,YAAY,CAACmB,SAAb,CAAuBC,SAAxB,CAAN,GAAyC,CAA5E;CAEA6K,QAAAA,SAAS,CAACf,SAAV,CAAoBG,MAApB,CAA2B,aAA3B;CACArL,QAAAA,YAAY,CAAC6W,MAAb,CAAoB3L,SAApB,CAA8BG,MAA9B,CAAqC,oBAArC;;CAEA,YAAId,YAAJ,EACA;CACCvK,UAAAA,YAAY,CAAC6W,MAAb,CAAoB3L,SAApB,CAA8BG,MAA9B,8BAA2Dd,YAA3D;CACA;;CAEDvK,QAAAA,YAAY,CAACwa,WAAb,GAA2B9Z,UAAU,CAAC,YAAM;CAC3C,cAAIV,YAAY,CAAC2a,QAAb,IAAyB,QAA7B,EACA;CACC,YAAA,KAAI,CAACS,IAAL,CAAUrb,MAAV,EAAkB,QAAlB,EAA4BwK,YAA5B;CACA;CACD,SALoC,EAKlC,IALkC,CAArC;CAMA,OA3BD,MA4BK,IAAI0Q,MAAM,IAAID,QAAd,EACL;CACCE,QAAAA,MAAM,GAAG,IAAT;CACA1Q,QAAAA,eAAe,GACdxK,YAAY,CAACwB,OAAb,KAAyB,CAAzB,GACG0E,YAAY,CAACiV,eAAb,CAA6B;CAAE/Q,UAAAA,gBAAgB,EAAEpK,YAAY,CAACoK;CAAjC,SAA7B,CADH,GAEG,KAHJ;;CAMA,YAAIG,YAAY,IAAIC,eAApB,EACA;CACC,cAAIA,eAAJ,EACA;CACCxK,YAAAA,YAAY,CAAC6W,MAAb,CAAoB3L,SAApB,CAA8BG,MAA9B,8BAA2Db,eAA3D;CACA;;CACDxK,UAAAA,YAAY,CAAC6W,MAAb,CAAoB3L,SAApB,CAA8BC,GAA9B,8BAAwDZ,YAAxD;CAEAvK,UAAAA,YAAY,CAACwa,WAAb,GAA2B9Z,UAAU,CAAC,YAAM;CAC3C,YAAA,KAAI,CAAC0a,IAAL,CAAUrb,MAAV,EAAkB,QAAlB,EAA4BwK,YAA5B,EAA0CC,eAA1C;CACA,WAFoC,EAElC,IAFkC,CAArC;CAGA;CACD,OArBI,MAsBA,IAAI,CAACyQ,MAAL,EACL;CACCjb,QAAAA,YAAY,CAAC+K,UAAb,CAAwB3J,SAAxB,GAAoCpB,YAAY,CAACka,QAAb,CAAsB,QAAtB,CAApC;CACAla,QAAAA,YAAY,CAACmB,SAAb,CAAuBC,SAAvB,GAAmCF,MAAM,CAAClB,YAAY,CAACmB,SAAb,CAAuBC,SAAxB,CAAN,GAA2C,CAA9E;CACA6K,QAAAA,SAAS,CAACf,SAAV,CAAoBC,GAApB,CAAwB,aAAxB;CAEAnL,QAAAA,YAAY,CAAC6W,MAAb,CAAoB3L,SAApB,CAA8BC,GAA9B,CAAkC,oBAAlC;CACAnL,QAAAA,YAAY,CAAC6W,MAAb,CAAoB3L,SAApB,CAA8BC,GAA9B,8BAAwDZ,YAAxD;CAEAvK,QAAAA,YAAY,CAACwa,WAAb,GAA2B9Z,UAAU,CAAC,YAAM;CAC3C,cAAIV,YAAY,CAAC2a,QAAb,KAA0B,MAA9B,EACA;CACC,YAAA,KAAI,CAACS,IAAL,CAAUrb,MAAV,EAAkB,MAAlB,EAA0BwK,YAA1B;CACA,WAHD,MAIK,IAAIA,YAAY,KAAKvK,YAAY,CAAC6a,YAAlC;CACL;CACC,cAAA,KAAI,CAACO,IAAL,CAAUrb,MAAV,EAAkB,QAAlB,EAA4BwK,YAA5B,EAA0CvK,YAAY,CAAC6a,YAAvD;CACA;CACD,SAToC,EASlC,IATkC,CAArC;CAUA;;CAED,UAAI7a,YAAY,CAACwB,OAAb,KAAyB,CAA7B,EACA;CACC,YAAI0Z,MAAJ,EACA;CACChV,UAAAA,YAAY,CAACmV,WAAb,CAAyB;CACxBtb,YAAAA,MAAM,EAAEA,MADgB;CAExBgI,YAAAA,MAAM,EAAE/H,YAFgB;CAGxBqK,YAAAA,MAAM,EAAE,QAHgB;CAIxBE,YAAAA,YAAY,EAAEA,YAJU;CAKxBC,YAAAA,eAAe,EAAEA,eALO;CAMxBC,YAAAA,UAAU,EAAEvJ,MAAM,CAAClB,YAAY,CAACmB,SAAb,CAAuBC,SAAxB;CANM,WAAzB;CAQA,SAVD,MAYA;CACC8E,UAAAA,YAAY,CAACmV,WAAb,CAAyB;CACxBtb,YAAAA,MAAM,EAAEA,MADgB;CAExBgI,YAAAA,MAAM,EAAE/H,YAFgB;CAGxBqK,YAAAA,MAAM,EAAG4Q,MAAM,GAAG,QAAH,GAAc,KAHL;CAIxB1Q,YAAAA,YAAY,EAAEA,YAJU;CAKxBE,YAAAA,UAAU,EAAEvJ,MAAM,CAAClB,YAAY,CAACmB,SAAb,CAAuBC,SAAxB;CALM,WAAzB;CAOA;CACD;;CAED,UACC,CAAC8Z,MAAD,IACGlb,YAAY,CAACwB,OAAb,KAAyB,CAF7B,EAIA;CACC,YAAM8Z,SAAS,GACdtb,YAAY,CAACsa,gBAAb,GACGpN,IAAI,CAACuN,KAAL,CAAWza,YAAY,CAACsa,gBAAb,CAA8BhS,YAA9B,CAA2C,YAA3C,CAAX,CADH,GAEG,KAHJ;;CAMA,YAAIgT,SAAJ,EACA;CACCA,UAAAA,SAAS,CAACC,GAAV,GAAgBjI,MAAM,CAACkI,MAAP,CAAcF,SAAS,CAACC,GAAxB,CAAhB;CAEAvb,UAAAA,YAAY,CAAC8K,YAAb,CAA0B1J,SAA1B,GAAsC8E,YAAY,CAACuV,eAAb,CAA6B;CAClE1S,YAAAA,GAAG,EAAE,CAACkS,MAD4D;CAElEhS,YAAAA,GAAG,EAAEqS,SAAS,CAACC,GAFmD;CAGlEpS,YAAAA,IAAI,EAAEmS,SAAS,CAACI;CAHkD,WAA7B,CAAtC;CAKA;CACD;;CAED,UACC1b,YAAY,CAACsB,QAAb,KAA0B,OAA1B,IACG,CAACtB,YAAY,CAACoK,gBAFlB,EAIA;CACC,YAAMuR,IAAI,GAAG3b,YAAY,CAAC8B,GAA1B;CACA,YAAM8Z,QAAQ,GAAGD,IAAI,CAACE,SAAL,CAAe,IAAf,CAAjB;CAEAD,QAAAA,QAAQ,CAACpZ,EAAT,GAAc,WAAd,CAJD;;CAMC,YAAIsZ,IAAI,GAAG,QAAX;;CACA,YAAIH,IAAI,CAAC5P,OAAL,CAAa,4BAAb,CAAJ,EACA;CACC+P,UAAAA,IAAI,GAAG,SAAP;CACA,SAHD,MAIK,IAAIH,IAAI,CAAC5P,OAAL,CAAa,sBAAb,CAAJ,EACL;CACC+P,UAAAA,IAAI,GAAG,MAAP;CACA;;CAEDF,QAAAA,QAAQ,CAAC1Q,SAAT,CAAmBG,MAAnB,CAA0B,uBAA1B;CACAuQ,QAAAA,QAAQ,CAAC1Q,SAAT,CAAmBC,GAAnB,CAAuB,cAAvB;CAEA3G,QAAAA,aAAG,CAACgK,MAAJ,CAAWmN,IAAI,CAACvG,UAAhB,EAA4B;CAAE3Q,UAAAA,KAAK,EAAE;CAAErB,YAAAA,QAAQ,EAAE;CAAZ;CAAT,SAA5B;CAEAoB,QAAAA,aAAG,CAACgK,MAAJ,CAAWoN,QAAX,EAAqB;CACpBnX,UAAAA,KAAK,EAAE;CACNrB,YAAAA,QAAQ,EAAE,UADJ;CAEN2Y,YAAAA,UAAU,EAAE,QAFN;CAGN9S,YAAAA,GAAG,EAAG6S,IAAI,KAAK,MAAT,GAAkB,KAAlB,GAA2BA,IAAI,KAAK,SAAT,GAAqB,GAArB,GAA2B;CAHtD;CADa,SAArB;CAQAtX,QAAAA,aAAG,CAACgK,MAAJ,CAAWmN,IAAX,EAAiB;CAAElX,UAAAA,KAAK,EAAE;CAAEuX,YAAAA,UAAU,EAAE;CAAd;CAAT,SAAjB;CACAxX,QAAAA,aAAG,CAACyX,OAAJ,CAAYL,QAAZ,EAAsBD,IAAI,CAACvG,UAA3B;CAEA,YAAIpQ,EAAE,CAAC6J,MAAP,CAAc;CACbC,UAAAA,QAAQ,EAAE,GADG;CAEbC,UAAAA,KAAK,EAAE;CAAEmN,YAAAA,KAAK,EAAE;CAAT,WAFM;CAGbjN,UAAAA,MAAM,EAAE;CAAEiN,YAAAA,KAAK,EAAGJ,IAAI,KAAK,SAAT,GAAqB,GAArB,GAA2B;CAArC,WAHK;CAIb5M,UAAAA,UAAU,EAAGlK,EAAE,CAAC6J,MAAH,CAAUO,WAAV,CAAsB+M,IAJtB;CAKb7M,UAAAA,IAAI,EAAE,cAACC,KAAD,EAAW;CAChBqM,YAAAA,QAAQ,CAACnX,KAAT,CAAe2X,SAAf,mBAAoC7M,KAAK,CAAC2M,KAAN,GAAc,GAAlD;CACA,WAPY;CAQbzM,UAAAA,QAAQ,EAAE,oBAAM;CACf,gBAAM4M,aAAa,GAAG7X,aAAG,CAACsI,MAAJ,CAAW,MAAX,EAAmB;CACxCC,cAAAA,KAAK,EAAE;CACNrJ,gBAAAA,SAAS,EAAGuX,MAAM,GAAG,eAAH,GAAqB;CADjC;CADiC,aAAnB,CAAtB;CAMAzW,YAAAA,aAAG,CAACgK,MAAJ,CAAW6N,aAAX,EAA0B;CACzB5X,cAAAA,KAAK,EAAE;CACNrB,gBAAAA,QAAQ,EAAE,UADJ;CAEN2Y,gBAAAA,UAAU,EAAE;CAFN;CADkB,aAA1B;CAOAvX,YAAAA,aAAG,CAACyX,OAAJ,CAAYI,aAAZ,EAA2BV,IAAI,CAACvG,UAAhC;CAEA,gBAAIpQ,EAAE,CAAC6J,MAAP,CAAc;CACbC,cAAAA,QAAQ,EAAE,GADG;CAEbC,cAAAA,KAAK,EAAE;CAAEmN,gBAAAA,KAAK,EAAGJ,IAAI,IAAI,SAAR,GAAoB,GAApB,GAA0B;CAApC,eAFM;CAGb7M,cAAAA,MAAM,EAAE;CAAEiN,gBAAAA,KAAK,EAAE;CAAT,eAHK;CAIbhN,cAAAA,UAAU,EAAGlK,EAAE,CAAC6J,MAAH,CAAUO,WAAV,CAAsB+M,IAJtB;CAKb7M,cAAAA,IAAI,EAAE,cAACC,KAAD,EAAW;CAChBqM,gBAAAA,QAAQ,CAACnX,KAAT,CAAe2X,SAAf,mBAAoC7M,KAAK,CAAC2M,KAAN,GAAc,GAAlD;CACA,eAPY;CAQbzM,cAAAA,QAAQ,EAAE,oBAAM;CARH,aAAd,EASG7D,OATH;CAWA,gBAAM0Q,UAAU,GAAG;CAClBtN,cAAAA,OAAO,EAAE,GADS;CAElBkN,cAAAA,KAAK,EAAGJ,IAAI,KAAK,SAAT,GAAqB,GAArB,GAA2B,GAFjB;CAGlB7S,cAAAA,GAAG,EAAE;CAHa,aAAnB;CAKA,gBAAMsT,WAAW,GAAG;CACnBvN,cAAAA,OAAO,EAAE,CADU;CAEnBkN,cAAAA,KAAK,EAAE,GAFY;CAGnBjT,cAAAA,GAAG,EAAG6S,IAAI,KAAK,SAAT,GAAqB,CAAC,CAAtB,GAA0B,CAAC;CAHd,aAApB;;CAMA,gBAAIA,IAAI,KAAK,SAAb,EACA;CACCQ,cAAAA,UAAU,CAACnO,IAAX,GAAkB,CAAC,CAAnB;CACAoO,cAAAA,WAAW,CAACpO,IAAZ,GAAmB,CAAC,EAApB;CACA;;CAED,gBAAInJ,EAAE,CAAC6J,MAAP,CAAc;CACbC,cAAAA,QAAQ,EAAE,GADG;CAEbC,cAAAA,KAAK,EAAEuN,UAFM;CAGbrN,cAAAA,MAAM,EAAEsN,WAHK;CAIbrN,cAAAA,UAAU,EAAGlK,EAAE,CAAC6J,MAAH,CAAUO,WAAV,CAAsBkC,MAJtB;CAKbhC,cAAAA,IAAI,EAAE,cAACC,KAAD,EAAW;CAChB8M,gBAAAA,aAAa,CAAC5X,KAAd,CAAoB2X,SAApB,mBAAyC7M,KAAK,CAAC2M,KAAN,GAAc,GAAvD;CACAG,gBAAAA,aAAa,CAAC5X,KAAd,CAAoBuK,OAApB,GAA8BO,KAAK,CAACP,OAAN,GAAgB,GAA9C;;CACA,oBAAI8M,IAAI,KAAK,SAAb,EACA;CACCO,kBAAAA,aAAa,CAAC5X,KAAd,CAAoB0J,IAApB,aAA8BoB,KAAK,CAACpB,IAApC;CACA;;CACDkO,gBAAAA,aAAa,CAAC5X,KAAd,CAAoBwE,GAApB,aAA6BsG,KAAK,CAACtG,GAAnC;CACA,eAbY;CAcbwG,cAAAA,QAAQ,EAAE,oBAAM;CACfmM,gBAAAA,QAAQ,CAACxG,UAAT,CAAoBE,WAApB,CAAgCsG,QAAhC;CACAS,gBAAAA,aAAa,CAACjH,UAAd,CAAyBE,WAAzB,CAAqC+G,aAArC;CAEA7X,gBAAAA,aAAG,CAACgK,MAAJ,CAAWmN,IAAI,CAACvG,UAAhB,EAA4B;CAAE3Q,kBAAAA,KAAK,EAAE;CAAErB,oBAAAA,QAAQ,EAAE;CAAZ;CAAT,iBAA5B;CACAoB,gBAAAA,aAAG,CAACgK,MAAJ,CAAWmN,IAAX,EAAiB;CAAElX,kBAAAA,KAAK,EAAE;CAAEuX,oBAAAA,UAAU,EAAE;CAAd;CAAT,iBAAjB;CACA;CApBY,aAAd,EAqBGpQ,OArBH;CAuBA;CA3EY,SAAd,EA4EGA,OA5EH;CA6EA;;CAED5L,MAAAA,YAAY,CAAC8B,GAAb,CAAiBoJ,SAAjB,CAA2BG,MAA3B,CAAkC,uBAAlC;CACA;CAhbF;CAAA;CAAA,yBAkbatL,MAlbb,EAkbqBD,MAlbrB,EAmbC;CACC,UAAME,YAAY,GAAG,KAAKE,WAAL,CAAiBH,MAAjB,CAArB;CACAC,MAAAA,YAAY,CAACmB,SAAb,CAAuBC,SAAvB,GAAmCF,MAAM,CAACpB,MAAM,CAAC2X,oBAAR,CAAzC;;CAEA,UACC,CAAChW,cAAI,CAACoB,WAAL,CAAiB/C,MAAM,CAACiX,IAAxB,CAAD,IACG,CAACtV,cAAI,CAACoB,WAAL,CAAiB/C,MAAM,CAACkX,OAAxB,CADJ,IAEG9V,MAAM,CAACpB,MAAM,CAACkX,OAAR,CAAN,GAAyB,CAF5B,IAGG,CAACvV,cAAI,CAACoB,WAAL,CAAiB/C,MAAM,CAACqX,SAAxB,CAHJ,IAIG,CAAC1V,cAAI,CAACoB,WAAL,CAAiB/C,MAAM,CAACqX,SAAP,CAAiB7N,MAAlC,CALL,EAOA;CACC,YAAMkT,UAAU,GAAG7S,UAAU,CAAC7J,MAAM,CAACqX,SAAP,CAAiB7N,MAAlB,CAA7B;CAEA,YAAMmT,SAAS,GACdzc,YAAY,CAACsa,gBAAb,GACGpN,IAAI,CAACuN,KAAL,CAAWza,YAAY,CAACsa,gBAAb,CAA8BhS,YAA9B,CAA2C,YAA3C,CAAX,CADH,GAEG,KAHJ;;CAMA,YACCxI,MAAM,CAACiX,IAAP,IAAe,QAAf,IACGtV,cAAI,CAAC4R,aAAL,CAAmBoJ,SAAnB,CAFJ,EAIA;CACCA,UAAAA,SAAS,CAAClB,GAAV,GAAgBjI,MAAM,CAACkI,MAAP,CAAciB,SAAS,CAAClB,GAAxB,CAAhB;CACA,cAAImB,YAAY,GAAID,SAAS,CAAClB,GAAV,CAAc5V,MAAd,GAAuB,CAA3C;CAEA2N,UAAAA,MAAM,CAACkI,MAAP,CAAciB,SAAS,CAAClB,GAAxB,EAA6B3V,OAA7B,CAAqC,UAACkE,IAAD,EAAU;CAC9C,gBAAI4S,YAAJ,EACA;CACC;CACA;;CAED,gBAEE5c,MAAM,CAACiX,IAAP,KAAgB,KAAhB,IACGyF,UAAU,GAAG1S,IAAI,CAACR,MAFtB,IAKCxJ,MAAM,CAACiX,IAAP,KAAgB,QAAhB,IACGjX,MAAM,CAACkX,OAAP,KAAmBlN,IAAI,CAACV,EAP7B,EAUA;CACCsT,cAAAA,YAAY,GAAG,IAAf;CACA;CACD,WAnBD;;CAsBA,cAAIA,YAAJ,EACA;CACC,gBACC5c,MAAM,CAACiX,IAAP,KAAgB,KAAhB,IACG7V,MAAM,CAACpB,MAAM,CAACkX,OAAR,CAAN,KAA2B9V,MAAM,CAAC2H,aAAG,CAACC,UAAJ,CAAe,SAAf,CAAD,CAFrC,EAIA;CACC,kBAAI,CAAC2T,SAAS,CAAClB,GAAV,CAAcoB,IAAd,CAAmB,UAAClT,CAAD,EAAO;CAC9B,uBAAOvI,MAAM,CAACuI,CAAC,CAACL,EAAH,CAAN,KAAiBlI,MAAM,CAACpB,MAAM,CAACkX,OAAR,CAA9B;CACA,eAFI,CAAL,EAGA;CACCyF,gBAAAA,SAAS,CAAClB,GAAV,CAAcnZ,IAAd,CAAmB;CAClBgH,kBAAAA,EAAE,EAAElI,MAAM,CAACpB,MAAM,CAACkX,OAAR,CADQ;CAElB3N,kBAAAA,cAAc,EAAEvJ,MAAM,CAACqX,SAAP,CAAiB9N,cAFf;CAGlBC,kBAAAA,MAAM,EAAEK,UAAU,CAAC7J,MAAM,CAACqX,SAAP,CAAiB7N,MAAlB;CAHA,iBAAnB;CAKA;CACD,aAfD,MAgBK,IAAIxJ,MAAM,CAACiX,IAAP,KAAgB,QAApB,EACL;CACC0F,cAAAA,SAAS,CAAClB,GAAV,GAAgBkB,SAAS,CAAClB,GAAV,CAAcqB,MAAd,CAAqB,UAACnT,CAAD,EAAO;CAC3C,uBAAOvI,MAAM,CAACuI,CAAC,CAACL,EAAH,CAAN,KAAiBlI,MAAM,CAACpB,MAAM,CAACkX,OAAR,CAA9B;CACA,eAFe,CAAhB;CAGA;;CAEDyF,YAAAA,SAAS,CAAClB,GAAV,CAAc/R,IAAd,CAAmB,UAACC,CAAD,EAAIC,CAAJ,EAAU;CAC5B,kBAAIC,UAAU,CAACF,CAAC,CAACH,MAAH,CAAV,KAAyBK,UAAU,CAACD,CAAC,CAACJ,MAAH,CAAvC,EACA;CACC,uBAAO,CAAP;CACA;;CAED,qBAAQK,UAAU,CAACF,CAAC,CAACH,MAAH,CAAV,GAAuBK,UAAU,CAACD,CAAC,CAACJ,MAAH,CAAlC,GAAgD,CAAC,CAAjD,GAAqD,CAA5D;CACA,aAPD;;CASA,gBACCmT,SAAS,CAAClB,GAAV,CAAc5V,MAAd,GAAuB,CAAvB,IACG7F,MAAM,CAACiX,IAAP,KAAgB,KAFpB,EAIA;CACC0F,cAAAA,SAAS,CAAClB,GAAV,CAActR,GAAd;CACAwS,cAAAA,SAAS,CAACf,IAAV;CACA;CACD,WA1CD,MA4CA;CACC,gBAAI5b,MAAM,CAACiX,IAAP,KAAgB,KAApB,EACA;CACC0F,cAAAA,SAAS,CAACf,IAAV,GACC,CAACja,cAAI,CAACoB,WAAL,CAAiB4Z,SAAS,CAACf,IAA3B,CAAD,GACGxa,MAAM,CAACub,SAAS,CAACf,IAAX,CAAN,GAAyB,CAD5B,GAEG,CAHJ;CAKA,aAPD,MAQK,IAAI5b,MAAM,CAACiX,IAAP,KAAgB,QAApB,EACL;CACC0F,cAAAA,SAAS,CAACf,IAAV,GACC,CAACja,cAAI,CAACoB,WAAL,CAAiB4Z,SAAS,CAACf,IAA3B,CAAD,IACGxa,MAAM,CAACub,SAAS,CAACf,IAAX,CAAN,GAAyB,CAD5B,GAEGxa,MAAM,CAACub,SAAS,CAACf,IAAX,CAAN,GAAyB,CAF5B,GAGG,CAJJ;CAMA;CACD;;CAED1b,UAAAA,YAAY,CAACsa,gBAAb,CAA8BtS,YAA9B,CAA2C,YAA3C,EAAyDkF,IAAI,CAACC,SAAL,CAAesP,SAAf,CAAzD;;CAEA,cAAIzc,YAAY,CAAC8K,YAAjB,EACA;CACC9K,YAAAA,YAAY,CAAC8K,YAAb,CAA0B1J,SAA1B,GAAsC8E,YAAY,CAACuV,eAAb,CAA6B;CAClE1S,cAAAA,GAAG,EACF7H,MAAM,CAACpB,MAAM,CAACkX,OAAR,CAAN,KAA2B9V,MAAM,CAAC2H,aAAG,CAACC,UAAJ,CAAe,SAAf,CAAD,CAAjC,GACGhJ,MAAM,CAACiX,IAAP,KAAgB,QADnB,GAEG/W,YAAY,CAACuB,KAAb,CAAmB2J,SAAnB,CAA6BE,QAA7B,CAAsC,aAAtC,CAJ8D;CAMlEnC,cAAAA,GAAG,EAAEwT,SAAS,CAAClB,GANmD;CAOlEpS,cAAAA,IAAI,EAAEsT,SAAS,CAACf;CAPkD,aAA7B,CAAtC;CASA;CACD;;CAED,YACCja,cAAI,CAACE,cAAL,CAAoB7B,MAAM,CAACuX,QAA3B,KACG5V,cAAI,CAACE,cAAL,CAAoB7B,MAAM,CAACyX,YAA3B,CADH,IAEGzX,MAAM,CAACiX,IAAP,KAAgB,QAHpB,EAKA;CACC7Q,UAAAA,YAAY,CAACmV,WAAb,CAAyB;CACxBtb,YAAAA,MAAM,EAAEA,MADgB;CAExBgI,YAAAA,MAAM,EAAE/H,YAFgB;CAGxBqK,YAAAA,MAAM,EAAE,QAHgB;CAIxBE,YAAAA,YAAY,EAAEzK,MAAM,CAACuX,QAJG;CAKxB7M,YAAAA,eAAe,EAAE1K,MAAM,CAACyX,YALA;CAMxB9M,YAAAA,UAAU,EAAE3K,MAAM,CAAC2X,oBANK;CAOxB/M,YAAAA,MAAM,EAAE5K,MAAM,CAACkX;CAPS,WAAzB;CASA,SAfD,MAgBK,IACJvV,cAAI,CAACE,cAAL,CAAoB7B,MAAM,CAACuX,QAA3B,KACG,CAAE,KAAF,EAAS,QAAT,EAAoB/M,QAApB,CAA6BxK,MAAM,CAACiX,IAApC,CAFC,EAIL;CACC7Q,UAAAA,YAAY,CAACmV,WAAb,CAAyB;CACxBtb,YAAAA,MAAM,EAAEA,MADgB;CAExBgI,YAAAA,MAAM,EAAE/H,YAFgB;CAGxBuK,YAAAA,YAAY,EAAEzK,MAAM,CAACuX,QAHG;CAIxBhN,YAAAA,MAAM,EAAGvK,MAAM,CAACiX,IAAP,KAAgB,KAAhB,GAAwB,KAAxB,GAAgC,QAJjB;CAKxBtM,YAAAA,UAAU,EAAE3K,MAAM,CAAC2X,oBALK;CAMxB/M,YAAAA,MAAM,EAAE5K,MAAM,CAACkX;CANS,WAAzB;CAQA;CACD;;CAED,UAAIhX,YAAY,CAACmC,QAAjB,EACA;CACCnC,QAAAA,YAAY,CAACmC,QAAb,CAAsB6F,YAAtB,CAAmC,YAAnC,EAAiD,GAAjD;CACA;;CAED,UAAI,CAAChI,YAAY,CAACoK,gBAAlB,EACA;CACCpK,QAAAA,YAAY,CAACuB,KAAb,CAAmB8T,YAAnB,CACC7Q,aAAG,CAACsI,MAAJ,CAAW,MAAX,EAAmB;CAClBC,UAAAA,KAAK,EAAE;CACNrJ,YAAAA,SAAS,EAAE;CADL,WADW;CAIlBe,UAAAA,KAAK,EAAE;CACNgK,YAAAA,KAAK,YAAMpK,OAAO,CAAClD,SAAR,CAAkB0b,WAAlB,GAAgC,CAAtC,OADC;CAEN1J,YAAAA,MAAM,YAAM9O,OAAO,CAAClD,SAAR,CAAkB0X,YAAlB,GAAiC,CAAvC;CAFA,WAJW;CAQlBnF,UAAAA,IAAI,EAAG5T,MAAM,CAACiX,IAAP,KAAgB,KAAhB,GAAuB,IAAvB,GAA6B;CARlB,SAAnB,CADD,EAWC1S,OAAO,CAAC9C,KAAR,CAAcub,UAXf;CAaA;;CAED,UAAI9c,YAAY,CAAC+B,KAAjB,EACA;CACC/B,QAAAA,YAAY,CAAC+B,KAAb,CAAmBiC,KAAnB;CACAhE,QAAAA,YAAY,CAACO,gBAAb,GAAgC,CAAhC;CACA;CACD;CAhnBF;CAAA;CAAA,yBAknBaR,MAlnBb,EAknBqB6W,UAlnBrB,EAknBiCU,YAlnBjC,EAknB+CE,eAlnB/C,EAmnBC;CAAA;;CACC,UAAI,CAAC/V,cAAI,CAACE,cAAL,CAAoB2V,YAApB,CAAL,EACA;CACCA,QAAAA,YAAY,GAAG,MAAf;CACA;;CAED,UAAMyF,YAAY,GAAI1a,aAAa,CAACC,MAAd,GAAuB,IAAI0a,iBAAJ,EAAvB,GAA+CpW,cAArE;CACA,UAAM5G,YAAY,GAAG,KAAKE,WAAL,CAAiBH,MAAjB,CAArB;;CAEA,UAAMkd,eAAe,GAAG,SAAlBA,eAAkB,CAACC,QAAD,EAAc;CAErC,YAAMpW,IAAI,GAAGoW,QAAQ,CAACpW,IAAtB;CAEA9G,QAAAA,YAAY,CAAC2a,QAAb,GAAwB7T,IAAI,CAACuD,MAA7B;CACArK,QAAAA,YAAY,CAAC6a,YAAb,GAA4BvD,YAA5B;CAEA,YAAM2B,GAAG,aAAMjZ,YAAY,CAACgH,YAAnB,cAAmChH,YAAY,CAACkH,QAAhD,CAAT;;CAEA,QAAA,MAAI,CAACwT,YAAL,CAAkBrB,GAAlB,CAAsBJ,GAAtB,EAA2BnS,IAAI,CAACuD,MAAhC;;CACA,QAAA,MAAI,CAACuQ,gBAAL,CAAsBvB,GAAtB,CAA0BJ,GAA1B,EAA+BnS,IAAI,CAACwQ,YAApC;;CAEAtX,QAAAA,YAAY,CAACmB,SAAb,CAAuBC,SAAvB,GAAmC0F,IAAI,CAACc,SAAxC;CACA5H,QAAAA,YAAY,CAACO,gBAAb,GAAgC,CAAhC;CACAP,QAAAA,YAAY,CAACyF,YAAb,CAA0BrE,SAA1B,GAAsC,EAAtC;CACApB,QAAAA,YAAY,CAACyF,YAAb,CAA0BoH,WAA1B,CAAsCrI,aAAG,CAACsI,MAAJ,CAAW,MAAX,EAAmB;CACxDC,UAAAA,KAAK,EAAE;CACNrJ,YAAAA,SAAS,EAAE;CADL;CADiD,SAAnB,CAAtC;;CAMA,YAAI1D,YAAY,CAACmC,QAAjB,EACA;CACCnC,UAAAA,YAAY,CAACmC,QAAb,CAAsB6F,YAAtB,CAAmC,YAAnC,EAAiD,GAAjD;CACA;;CAEDnI,QAAAA,SAAS,CAACuE,YAAV,CAAuBrE,MAAvB;CAEA,YAAMgC,KAAK,GAAGH,QAAQ,CAACC,cAAT,uBAAuC9B,MAAvC,EAAd;;CACA,YACCgC,KAAK,IACFA,KAAK,CAAC0C,KAAN,CAAY0Y,OAAZ,KAAwB,OAF5B,EAIA;CACCtd,UAAAA,SAAS,CAACW,IAAV,CAAeT,MAAf,EAAuB,IAAvB,EAA6B,EAA7B,EAAiC,IAAjC;CACA;;CAED,YACCC,YAAY,CAACwB,OAAb,IAAwB,CAAxB,IACGa,aAAa,CAACC,MAFlB,EAIA;CACC6T,UAAAA,WAAW,CAACiH,aAAZ,CAA0B,cAA1B,EAA0C;CACzC/S,YAAAA,MAAM,EAAEvD,IAAI,CAACuD,MAD4B;CAEzCgT,YAAAA,QAAQ,EAAEtd,MAF+B;CAGzCiH,YAAAA,YAAY,EAAGhH,YAAY,CAACgH,YAHa;CAIzCE,YAAAA,QAAQ,EAAElH,YAAY,CAACkH,QAJkB;CAKzC0P,YAAAA,UAAU,EAAEA,UAL6B;CAMzCU,YAAAA,YAAY,EAAEA,YAN2B;CAOzCE,YAAAA,eAAe,EAAEA,eAPwB;CAQzC9M,YAAAA,MAAM,EAAE7B,aAAG,CAACC,UAAJ,CAAe,SAAf,CARiC;CASzCsO,YAAAA,QAAQ,EAAG,CAAC3V,cAAI,CAACoB,WAAL,CAAiBiE,IAAI,CAACwW,SAAtB,CAAD,GAAoCxW,IAAI,CAACwW,SAAzC,GAAqD,IATvB;CAUzC5F,YAAAA,QAAQ,EAAE5Q,IAAI,CAACc;CAV0B,WAA1C,EAWG,IAXH;CAYA;CACD,OAvDD;;CAyDA,UAAM2V,eAAe,GAAG,SAAlBA,eAAkB,GAAM;CAE7B,YAAMjC,SAAS,GAAKtb,YAAY,CAACsa,gBAAd,GAChBpN,IAAI,CAACuN,KAAL,CAAWza,YAAY,CAACsa,gBAAb,CAA8BhS,YAA9B,CAA2C,YAA3C,CAAX,CADgB,GAEhB,KAFH;;CAKA,YAAItI,YAAY,CAACwB,OAAb,IAAwB,CAA5B,EACA;CACC,cAAIoV,UAAU,KAAK,QAAnB,EACA;CACC1Q,YAAAA,YAAY,CAACmV,WAAb,CAAyB;CACxBtb,cAAAA,MAAM,EAAEA,MADgB;CAExBgI,cAAAA,MAAM,EAAE/H,YAFgB;CAGxBqK,cAAAA,MAAM,EAAEuM,UAHgB;CAIxBrM,cAAAA,YAAY,EAAE+M,YAJU;CAKxB9M,cAAAA,eAAe,EAAEgN,eALO;CAMxB/M,cAAAA,UAAU,EAAEvJ,MAAM,CAAClB,YAAY,CAACmB,SAAb,CAAuBC,SAAxB;CANM,aAAzB;CAQA,WAVD,MAYA;CACC8E,YAAAA,YAAY,CAACmV,WAAb,CAAyB;CACxBtb,cAAAA,MAAM,EAAEA,MADgB;CAExBgI,cAAAA,MAAM,EAAE/H,YAFgB;CAGxBqK,cAAAA,MAAM,EAAGuM,UAAU,KAAK,QAAf,GAA0B,KAA1B,GAAkC,QAHnB;CAIxBrM,cAAAA,YAAY,EAAE+M,YAJU;CAKxB7M,cAAAA,UAAU,EACTmM,UAAU,IAAI,QAAd,GACG1V,MAAM,CAAClB,YAAY,CAACmB,SAAb,CAAuBC,SAAxB,CAAN,GAA2C,CAD9C,GAEGF,MAAM,CAAClB,YAAY,CAACmB,SAAb,CAAuBC,SAAxB,CAAN,GAA2C;CARvB,aAAzB;CAWA;;CAED,cAAIpB,YAAY,CAAC+K,UAAjB,EACA;CACC,gBAAI6L,UAAU,KAAK,KAAnB,EACA;CACC5W,cAAAA,YAAY,CAAC+K,UAAb,CAAwB3J,SAAxB,GAAoCyH,aAAG,CAACC,UAAJ,CAAe,+BAAf,CAApC;CACA,aAHD,MAIK,IAAI8N,UAAU,KAAK,QAAnB,EACL;CACC5W,cAAAA,YAAY,CAAC+K,UAAb,CAAwB3J,SAAxB,GAAoCyH,aAAG,CAACC,UAAJ,+BAAsC0O,eAAe,CAACtL,WAAhB,EAAtC,WAApC;CACA,aAHI,MAKL;CACClM,cAAAA,YAAY,CAAC+K,UAAb,CAAwB3J,SAAxB,GAAoCyH,aAAG,CAACC,UAAJ,+BAAsCwO,YAAY,CAACpL,WAAb,EAAtC,WAApC;CACA;CACD;CACD;;CAED,YACCoP,SAAS,IACN1E,UAAU,KAAK,QADlB,IAEG5W,YAAY,CAACwB,OAAb,IAAwB,CAH5B,EAKA;CACCxB,UAAAA,YAAY,CAAC8K,YAAb,CAA0B1J,SAA1B,GAAsC8E,YAAY,CAACuV,eAAb,CAA6B;CAClE1S,YAAAA,GAAG,EAAG6N,UAAU,KAAK,QAD6C;CAClC;CAChC3N,YAAAA,GAAG,EAAEqK,MAAM,CAACkI,MAAP,CAAcF,SAAS,CAACC,GAAxB,CAF6D;CAGlEpS,YAAAA,IAAI,EAAEmS,SAAS,CAACI;CAHkD,WAA7B,CAAtC;CAKA;CACD,OAhED;;CAkEA,UAAM8B,cAAc,GAAE;CACrBC,QAAAA,aAAa,EAAE;CADM,OAAtB;;CAIA,UACCzd,YAAY,CAACwB,OAAb,IAAwB,CAAxB,IACGa,aAAa,CAACC,MAFlB,EAIA;CACCkb,QAAAA,cAAc,CAACE,cAAf,GAAgC,QAAhC;CACA;;CAEDX,MAAAA,YAAY,CAAClW,SAAb,CAAuB,kBAAvB,EAA2C;CAC1CC,QAAAA,IAAI,EAAE;CACLhH,UAAAA,MAAM,EAAE;CACPiH,YAAAA,mBAAmB,EAAE/G,YAAY,CAACgH,YAD3B;CAEPC,YAAAA,qBAAqB,EAAEjH,YAAY,CAACkH,QAF7B;CAGPyW,YAAAA,kBAAkB,EAAE/G,UAHb;CAIPxP,YAAAA,oBAAoB,EAAEkQ;CAJf;CADH,SADoC;CAS1CkG,QAAAA,cAAc,EAAEA;CAT0B,OAA3C,EAUG/V,IAVH,CAWCwV,eAXD,EAYCM,eAZD;CAeA,aAAO,KAAP;CACA;CAnxBF;CAAA;CAAA,+BAqxBmBzd,MArxBnB,EAsxBC;CAAA;;CACC,UAAIoB,MAAM,CAACpB,MAAM,CAACkX,OAAR,CAAN,KAA2B9V,MAAM,CAAC2H,aAAG,CAACC,UAAJ,CAAe,SAAf,CAAD,CAArC,EACA;CACC,eAAO,KAAP;CACA;;CAED,WAAK6N,IAAL,CAAU/Q,OAAV,CAAkB,UAAC5F,YAAD,EAAeD,MAAf,EAA0B;CAC3C,YACCC,YAAY,CAACgH,YAAb,KAA8BlH,MAAM,CAACmX,cAArC,IACG/V,MAAM,CAAClB,YAAY,CAACkH,QAAd,CAAN,KAAkChG,MAAM,CAACpB,MAAM,CAACoX,SAAR,CAF5C,EAIA;CACC;CACA;;CAED,QAAA,MAAI,CAACJ,IAAL,CAAU/W,MAAV,EAAkBD,MAAlB;CACA,OAVD;CAaAuC,MAAAA,aAAa,CAACub,IAAd,CAAmB9d,MAAnB;CACA;CA1yBF;CAAA;CAAA,wBA4yBYC,MA5yBZ,EA4yBoBiH,YA5yBpB,EA4yBkCE,QA5yBlC,EA4yB4C+S,SA5yB5C,EA4yBuDvP,MA5yBvD,EA4yB+DwP,QA5yB/D,EA4yByE5Y,QA5yBzE,EA4yBmFgG,iBA5yBnF,EA4yBsGuW,UA5yBtG,EA4yBkHvb,MA5yBlH,EA6yBC;CAAA;;CACCA,MAAAA,MAAM,GAAG,CAAC,CAACA,MAAX;;CAEA,UAAIhB,QAAQ,KAAKwc,SAAjB,EACA;CACCxc,QAAAA,QAAQ,GAAG,UAAX;CACA;;CAED,UAAI,KAAKyc,gBAAL,CAAsBzE,GAAtB,CAA0B,mBAA1B,CAAJ,EACA;CACChS,QAAAA,iBAAiB,GAAG,KAAKyW,gBAAL,CAAsBzE,GAAtB,CAA0B,mBAA1B,CAApB;CACA;;CAED,UAAItZ,YAAY,GAAG,KAAKE,WAAL,CAAiBH,MAAjB,CAAnB;;CAEA,UAAIC,YAAY,IAAIA,YAAY,CAACge,QAAb,GAAwB,CAA5C,EACA;CACC;CACA;;CAED,UAAMC,SAAS,GAAGje,YAAY,IAAIA,YAAY,CAACge,QAA7B,GAAwChe,YAAY,CAACge,QAArD,GAAgE,CAAlF;CAEAhe,MAAAA,YAAY,GAAG,IAAIC,UAAJ,CAAeF,MAAf,EAAuBiH,YAAvB,EAAqCE,QAArC,EAA+C+S,SAA/C,EAA0DvP,MAA1D,EAAkEwP,QAAlE,EAA4E5Y,QAA5E,EAAsFgG,iBAAtF,CAAf;CACA,WAAK4W,WAAL,CACCne,MADD,EAECC,YAFD;;CAKA,UAAIA,YAAY,CAACqa,OAAjB,EACA;CACC,aAAK8D,IAAL,CAAUpe,MAAV,EAAkB;CACjBuC,UAAAA,MAAM,EAAEA;CADS,SAAlB;CAGA,OALD,MAOA;CACC5B,QAAAA,UAAU,CAAC,YAAM;CAChBV,UAAAA,YAAY,CAACge,QAAb,GAAwBC,SAAS,GAAG,CAApC;;CACA,UAAA,MAAI,CAACG,GAAL,CAASre,MAAT,EAAiBiH,YAAjB,EAA+BE,QAA/B,EAAyC+S,SAAzC,EAAoDvP,MAApD,EAA4DwP,QAA5D,EAAsE5Y,QAAtE,EAAgFgG,iBAAhF,EAAmGuW,UAAnG,EAA+Gvb,MAA/G;CACA,SAHS,EAGP,GAHO,CAAV;CAIA;CACD;CAt1BF;CAAA;CAAA,8BAw1BkBxC,MAx1BlB,EAy1BC;CACC,UAAI,CAAC2B,cAAI,CAACoB,WAAL,CAAiB/C,MAAM,CAACwH,iBAAxB,CAAL,EACA;CACC,aAAKyW,gBAAL,CAAsB1E,GAAtB,CAA0B,mBAA1B,EAA+CvZ,MAAM,CAACwH,iBAAtD;CACA;CACD;CA91BF;CAAA;CAAA,yBAg2BavH,MAh2Bb,EAg2BqBD,MAh2BrB,EAi2BC;CACCA,MAAAA,MAAM,GAAI,CAAC2B,cAAI,CAACoB,WAAL,CAAiB/C,MAAjB,CAAD,GAA4BA,MAA5B,GAAqC,EAA/C;CAEAuC,MAAAA,aAAa,CAACgc,IAAd,CAAmBve,MAAnB;CAEA,UAAME,YAAY,GAAG,KAAKE,WAAL,CAAiBH,MAAjB,CAArB,CALD;;CAQC,UAAIC,YAAY,CAACia,SAAjB,EACA;CACC,YAAIqE,SAAS,GACZte,YAAY,CAACsB,QAAb,KAA0B,UAA1B,GACGtB,YAAY,CAAC6W,MADhB,GAEG7W,YAAY,CAAC+K,UAHjB;;CAMA,YAAI,CAAC1I,aAAa,CAACC,MAAnB,EACA;CACC,cAAMic,YAAY,GAAGD,SAAS,CAACvS,OAAV,CAAkB,gBAAlB,CAArB;;CACA,cAAIwS,YAAJ,EACA;CACCD,YAAAA,SAAS,GAAGC,YAAZ;CACA;CACD;;CAED,YACCve,YAAY,CAACwB,OAAb,IAAwB,CAAxB,IACGa,aAAa,CAACC,MAFlB,EAIA;CACCgc,UAAAA,SAAS,CAAC7N,mBAAV,CAA8B,YAA9B,EAA4C,KAAK+N,uBAAjD;CACAF,UAAAA,SAAS,CAACza,gBAAV,CAA2B,YAA3B,EAAyC,KAAK2a,uBAA9C;CACA;;CAED,YAAMC,SAAS,GAAIpc,aAAa,CAACC,MAAd,GAAuB,UAAvB,GAAoC,OAAvD;CACAgc,QAAAA,SAAS,CAAC7N,mBAAV,CAA8BgO,SAA9B,EAAyC,KAAKC,kBAA9C;CACAJ,QAAAA,SAAS,CAACza,gBAAV,CAA2B4a,SAA3B,EAAsC,KAAKC,kBAA3C;;CAEA,YAAI,CAACrc,aAAa,CAACC,MAAnB,EACA;CACC;CACAtC,UAAAA,YAAY,CAAC8B,GAAb,CAAiB+B,gBAAjB,CAAkC,WAAlC,EAA+C,YAAM;CACpD7D,YAAAA,YAAY,CAAC8B,GAAb,CAAiBoJ,SAAjB,CAA2BC,GAA3B,CAA+B,uBAA/B;CACA,WAFD;CAGAnL,UAAAA,YAAY,CAAC8B,GAAb,CAAiB+B,gBAAjB,CAAkC,UAAlC,EAA8C,YAAM;CACnD7D,YAAAA,YAAY,CAAC8B,GAAb,CAAiBoJ,SAAjB,CAA2BG,MAA3B,CAAkC,uBAAlC;CACA,WAFD;CAGA,SATD,MAWA;CACCrL,UAAAA,YAAY,CAACmC,QAAb,CAAsBsO,mBAAtB,CAA0C,OAA1C,EAAmD,KAAKkO,0BAAxD;CACA3e,UAAAA,YAAY,CAACmC,QAAb,CAAsB0B,gBAAtB,CAAuC,OAAvC,EAAgD,KAAK8a,0BAArD;CACA;CACD,OA7CD,MA8CK,IAAIld,cAAI,CAACC,SAAL,CAAe1B,YAAY,CAAC+K,UAA5B,CAAJ,EACL;CACC/K,QAAAA,YAAY,CAAC+K,UAAb,CAAwB3J,SAAxB,GAAoCpB,YAAY,CAACka,QAAb,CAAsB,QAAtB,CAApC;CACAla,QAAAA,YAAY,CAAC+K,UAAb,CAAwBG,SAAxB,CAAkCC,GAAlC,CAAsC,2BAAtC;CACA,OA1DF;;;CA4DC,UAAMyT,kBAAkB,GAAI5e,YAAY,CAAC8K,YAAb,GAA4B9K,YAAY,CAAC8K,YAAzC,GAAwD9K,YAAY,CAACuB,KAAjG;;CAEA,UAAI,CAACc,aAAa,CAACC,MAAnB,EACA;CACCsc,QAAAA,kBAAkB,CAAC/a,gBAAnB,CAAoC,YAApC,EAAkD,UAACiC,CAAD,EAAO;CACxDjG,UAAAA,SAAS,CAACoW,kBAAV,CAA6B;CAC5BlW,YAAAA,MAAM,EAAEA,MADoB;CAE5BoI,YAAAA,KAAK,EAAErC,CAFqB;CAG5BzF,YAAAA,MAAM,EAAEyF,CAAC,CAACyC,aAAF,CAAgB/F;CAHI,WAA7B;CAKA,SAND;CAQAoc,QAAAA,kBAAkB,CAAC/a,gBAAnB,CAAoC,YAApC,EAAkD,UAACiC,CAAD,EAAO;CACxDjG,UAAAA,SAAS,CAACqW,kBAAV,CAA6B;CAC5BnW,YAAAA,MAAM,EAAEA;CADoB,WAA7B;CAGA,SAJD;CAMA6e,QAAAA,kBAAkB,CAAC/a,gBAAnB,CAAoC,OAApC,EAA6C,UAACiC,CAAD,EAAO;CACnDjG,UAAAA,SAAS,CAACkW,aAAV,CAAwB;CACvBhW,YAAAA,MAAM,EAAEA,MADe;CAEvBoI,YAAAA,KAAK,EAAErC,CAFgB;CAGvBzF,YAAAA,MAAM,EAAEyF,CAAC,CAACyC,aAAF,CAAgB/F;CAHD,WAAxB;CAKA,SAND;CAOA;;CAED,UACCxC,YAAY,CAACwB,OAAb,KAAyB,CAAzB,IACGxB,YAAY,CAACia,SADhB,IAEGja,YAAY,CAACoK,gBAHjB,EAKA;CACClE,QAAAA,YAAY,CAACqL,kBAAb,CAAgC;CAC/BxR,UAAAA,MAAM,EAAEA;CADuB,SAAhC;CAGA;CACD;CAl8BF;CAAA;CAAA,8CAq8BC;CACCsC,MAAAA,aAAa,CAACwc,cAAd,GAEEjd,QAAQ,CAACgX,eAAT,IACGhX,QAAQ,CAACgX,eAAT,CAAyB7S,SAF7B,IAIGnE,QAAQ,CAACkM,IAAT,CAAc/H,SALlB;CAOA;CA78BF;CAAA;CAAA,uCA+8B2BD,CA/8B3B,EAg9BC;CACC,UAAMgZ,gBAAgB,GAAGhZ,CAAC,CAACyC,aAAF,CAAgBwD,OAAhB,CAAwB,uBAAxB,CAAzB;;CACA,UAAI,CAACtK,cAAI,CAACC,SAAL,CAAeod,gBAAf,CAAL,EACA;CACC;CACA;;CAED,UAAM/e,MAAM,GAAG+e,gBAAgB,CAACxW,YAAjB,CAA8B,qBAA9B,CAAf;;CACA,UAAI,CAAC7G,cAAI,CAACE,cAAL,CAAoB5B,MAApB,CAAL,EACA;CACC;CACA;;CAED,UAAMC,YAAY,GAAGC,UAAU,CAACC,WAAX,CAAuBH,MAAvB,CAArB;;CAEA,UACCC,YAAY,CAACwB,OAAb,IAAwB,CAAxB,IACGa,aAAa,CAACC,MADjB,IAEG4D,YAAY,CAAC6Y,qBAHjB,EAKA;CACC7Y,QAAAA,YAAY,CAAC6Y,qBAAb,GAAqC,KAArC;CACA;CACA;;CAED,UACC/e,YAAY,CAACwB,OAAb,GAAuB,CAAvB,IACG,CAACa,aAAa,CAACC,MADlB,IAEG,CAAC4D,YAAY,CAACkH,oBAHlB,EAKA;CACC,YACCpN,YAAY,CAACwB,OAAb,IAAwB,CAAxB,IACGa,aAAa,CAACC,MAFlB,EAIA;CACC,cAAM0c,gBAAgB,GAEpBpd,QAAQ,CAACgX,eAAT,IACGhX,QAAQ,CAACgX,eAAT,CAAyB7S,SAF7B,IAIGnE,QAAQ,CAACkM,IAAT,CAAc/H,SALlB;;CAQA,cAAIyL,IAAI,CAACC,GAAL,CAASuN,gBAAgB,GAAG3c,aAAa,CAACwc,cAA1C,IAA4D,CAAhE,EACA;CACC;CACA;CACD;;CAED5e,QAAAA,UAAU,CAAC0N,SAAX,CAAqB7H,CAArB,EAAwB/F,MAAxB;CACA;;CAED,UAAIC,YAAY,CAACwB,OAAb,IAAwB,CAA5B,EACA;CACC0E,QAAAA,YAAY,CAAC+Y,UAAb,CAAwB;CACvBlf,UAAAA,MAAM,EAAEA;CADe,SAAxB;CAGA;;CAED+F,MAAAA,CAAC,CAAC8H,cAAF;CACA;CA7gCF;CAAA;CAAA,+CA+gCmC9H,CA/gCnC,EAghCC;CACC,UAAMgZ,gBAAgB,GAAGhZ,CAAC,CAACyC,aAAF,CAAgBgD,aAAhB,CAA8B,gBAA9B,CAAzB;;CACA,UAAI,CAAC9J,cAAI,CAACC,SAAL,CAAeod,gBAAf,CAAL,EACA;CACC;CACA;;CAED,UAAM/e,MAAM,GAAG+e,gBAAgB,CAACxW,YAAjB,CAA8B,cAA9B,CAAf;;CACA,UAAI,CAAC7G,cAAI,CAACE,cAAL,CAAoB5B,MAApB,CAAL,EACA;CACC;CACA;;CAED,UAAMC,YAAY,GAAGC,UAAU,CAACC,WAAX,CAAuBH,MAAvB,CAArB;CAEAmG,MAAAA,YAAY,CAACgZ,uBAAb,CAAqC;CACpClY,QAAAA,YAAY,EAAEhH,YAAY,CAACgH,YADS;CAEpCE,QAAAA,QAAQ,EAAElH,YAAY,CAACkH;CAFa,OAArC;CAIApB,MAAAA,CAAC,CAACkQ,eAAF;CACA;CApiCF;CAAA;CAAA;6BAAa/V,sBAEE,IAAI+Z,GAAJ;6BAFF/Z,8BAGU,IAAI+Z,GAAJ;6BAHV/Z,kCAIc,IAAI+Z,GAAJ;6BAJd/Z,kCAKc,IAAI+Z,GAAJ;;CCR3B,IAAIvY,cAAI,CAACoB,WAAL,CAAiBiN,MAAM,CAACiL,IAAxB,CAAJ,EACA;CACCjL,EAAAA,MAAM,CAACiL,IAAP,GAAc,EAAd;CACA;;CACDjL,MAAM,CAACiL,IAAP,CAAYoE,OAAZ,GAAsB9c,aAAtB;CACAyN,MAAM,CAACiL,IAAP,CAAYqE,MAAZ,GAAqBlZ,YAArB;CAEA4J,MAAM,CAAC7P,UAAP,GAAoBA,YAApB;;;;"}