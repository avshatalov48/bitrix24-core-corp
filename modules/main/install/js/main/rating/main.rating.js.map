{"version":3,"file":"main.rating.js","sources":["src/listpopup.js","src/render.js","src/manager.js","src/like.js","src/index.js"],"sourcesContent":["import { Type, Dom, Event, ajax } from 'main.core';\nimport { Popup } from 'main.popup';\nimport { EventEmitter } from 'main.core.events';\n\nimport { RatingManager } from './manager';\nimport { RatingLike } from './like';\nimport { RatingRender } from './render';\n\nexport class ListPopup\n{\n\tstatic popupLikeId = null;\n\n\tstatic removeOnCloseHandler = this.removeOnClose.bind(this);\n\n\tstatic getListPopup(params)\n\t{\n\t\tconst likeId = params.likeId;\n\t\tconst likeInstance = RatingLike.getInstance(likeId);\n\t\tconst target = params.target;\n\t\tconst reaction = params.reaction;\n\t\tconst nodeId = params.nodeId;\n\n\t\tif (this.popupLikeId === likeId)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tif (likeInstance.popupContentPage != 1)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.List(likeId, 1, reaction, true);\n\n\t\tlikeInstance.popupTimeoutIdShow = setTimeout(() => {\n\t\t\tthis.getListPopupShow({\n\t\t\t\tlikeId: likeId,\n\t\t\t\treaction: reaction,\n\t\t\t\ttarget: target,\n\t\t\t\tnodeId: nodeId,\n\t\t\t})\n\t\t}, 100);\n\t}\n\n\tstatic getListPopupShow(params)\n\t{\n\t\tconst likeId = params.likeId;\n\t\tconst likeInstance = RatingLike.getInstance(likeId);\n\t\tconst target = params.target;\n\t\tconst reaction = params.reaction;\n\t\tconst nodeId = params.nodeId;\n\n\t\tlikeInstance.resultPopupAnimation = true;\n\n\t\tsetTimeout(() => {\n\t\t\tthis.getListPopupAnimation({\n\t\t\t\tlikeId: likeId,\n\t\t\t});\n\t\t}, 500);\n\n\t\tif (likeInstance.mouseInShowPopupNode[reaction])\n\t\t{\n\t\t\tthis.OpenWindow(\n\t\t\t\tlikeId,\n\t\t\t\tnull,\n\t\t\t\ttarget,\n\t\t\t\tnodeId\n\t\t\t);\n\t\t}\n\t}\n\n\tstatic getListPopupAnimation(params)\n\t{\n\t\tconst likeId = params.likeId;\n\t\tconst likeInstance = RatingLike.getInstance(likeId);\n\n\t\tlikeInstance.resultPopupAnimation = false;\n\t}\n\n\tstatic OpenWindow(likeId, clickEvent, target, targetId)\n\t{\n\t\tconst likeInstance = RatingLike.getInstance(likeId);\n\n\t\tif (Number(likeInstance.countText.innerHTML) === 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst bindNode = (\n\t\t\tlikeInstance.template === 'standart'\n\t\t\t\t? likeInstance.count\n\t\t\t\t: (\n\t\t\t\t\tlikeInstance.version === 2\n\t\t\t\t\t\t? (\n\t\t\t\t\t\t\tType.isDomNode(target)\n\t\t\t\t\t\t\t\t? target\n\t\t\t\t\t\t\t\t: (\n\t\t\t\t\t\t\t\t\tType.isStringFilled(targetId) && document.getElementById(targetId)\n\t\t\t\t\t\t\t\t\t\t? document.getElementById(targetId)\n\t\t\t\t\t\t\t\t\t\t: null\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t)\n\t\t\t\t\t\t: likeInstance.box\n\t\t\t\t)\n\t\t);\n\n\t\tif (!Type.isDomNode(bindNode))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (likeInstance.popup == null)\n\t\t{\n\t\t\tconst globalZIndex = this.getGlobalIndex(bindNode);\n\n\t\t\tconst popupClassNameList = [];\n\t\t\tif (likeInstance.topPanel)\n\t\t\t{\n\t\t\t\tpopupClassNameList.push('bx-ilike-wrap-block-react-wrap');\n\t\t\t}\n\t\t\tif (RatingManager.mobile)\n\t\t\t{\n\t\t\t\tpopupClassNameList.push('bx-ilike-mobile-wrap');\n\t\t\t}\n\n\t\t\tlikeInstance.popup = new Popup({\n\t\t\t\tid: `ilike-popup-${likeId}`,\n\t\t\t\tbindElement: bindNode,\n\t\t\t\tlightShadow : true,\n\t\t\t\toffsetTop: 0,\n\t\t\t\toffsetLeft: (\n\t\t\t\t\t!Type.isUndefined(clickEvent)\n\t\t\t\t\t&& !Type.isNull(clickEvent)\n\t\t\t\t\t&& !Type.isUndefined(clickEvent.offsetX)\n\t\t\t\t\t\t? (clickEvent.offsetX - 100)\n\t\t\t\t\t\t: (likeInstance.version == 2 ? -30 : 5)\n\t\t\t\t),\n\t\t\t\tautoHide: true,\n\t\t\t\tcloseByEsc: true,\n\t\t\t\tzIndexAbsolute: (globalZIndex > 1000 ? globalZIndex + 1 : 1000),\n\t\t\t\tbindOptions: {\n\t\t\t\t\tposition: 'top',\n\t\t\t\t},\n\t\t\t\tanimation: 'fading-slide',\n\t\t\t\tevents: {\n\t\t\t\t\tonPopupClose: () => {\n\t\t\t\t\t\tthis.popupLikeId = null;\n\t\t\t\t\t},\n\t\t\t\t\tonPopupDestroy: () => {},\n\t\t\t\t},\n\t\t\t\tcontent : document.getElementById(`bx-ilike-popup-cont-${likeId}`),\n\t\t\t\tclassName: popupClassNameList.join(' '),\n\t\t\t});\n\n\t\t\tif (\n\t\t\t\t!likeInstance.topPanel\n\t\t\t\t&& !RatingManager.mobile\n\t\t\t)\n\t\t\t{\n\t\t\t\tlikeInstance.popup.setAngle({});\n\n\t\t\t\tdocument.getElementById(`ilike-popup-${likeId}`).addEventListener('mouseout', () => {\n\t\t\t\t\tclearTimeout(likeInstance.popupTimeout);\n\t\t\t\t\tlikeInstance.popupTimeout = setTimeout(() => {\n\t\t\t\t\t\tlikeInstance.popup.close();\n\t\t\t\t\t}, 1000);\n\t\t\t\t});\n\n\t\t\t\tdocument.getElementById(`ilike-popup-${likeId}`).addEventListener('mouseover', () => {\n\t\t\t\t\tclearTimeout(likeInstance.popupTimeout);\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (\n\t\t\t\t!Type.isUndefined(clickEvent)\n\t\t\t\t&& !Type.isNull(clickEvent)\n\t\t\t\t&& !Type.isUndefined(clickEvent.offsetX)\n\t\t\t)\n\t\t\t{\n\t\t\t\tlikeInstance.popup.offsetLeft = (clickEvent.offsetX - 100);\n\t\t\t}\n\n\t\t\tlikeInstance.popup.setBindElement(bindNode);\n\t\t}\n\n\t\tif (this.popupLikeId !== likeId)\n\t\t{\n\t\t\tconst popupLikeInstance = RatingLike.getInstance(this.popupLikeId);\n\t\t\tif (popupLikeInstance)\n\t\t\t{\n\t\t\t\tpopupLikeInstance.popup.close();\n\t\t\t}\n\t\t}\n\n\t\tthis.popupLikeId = likeId;\n\n\t\tlikeInstance.popup.show();\n\n\t\tthis.AdjustWindow(likeId);\n\t}\n\n\tstatic getGlobalIndex(element)\n\t{\n\t\tlet index = 0;\n\t\tlet propertyValue = '';\n\n\t\tdo\n\t\t{\n\t\t\tpropertyValue = Dom.style(element, 'z-index');\n\t\t\tif (propertyValue !== 'auto')\n\t\t\t{\n\t\t\t\tindex = !Number.isNaN(parseInt(propertyValue)) ? index : 0;\n\t\t\t}\n\t\t\telement = element.offsetParent;\n\t\t}\n\t\twhile (\n\t\t\telement\n\t\t\t&& element.tagName !== 'BODY'\n\t\t\t);\n\n\t\treturn index;\n\t}\n\n\tstatic removeOnClose()\n\t{\n\t\tEventEmitter.unsubscribe(BX.SidePanel.Instance.getTopSlider().getWindow(), 'SidePanel.Slider:onClose', this.removeOnCloseHandler);\n\n\t\tconst popupLikeInstance = RatingLike.getInstance(this.popupLikeId);\n\t\tif (popupLikeInstance)\n\t\t{\n\t\t\tpopupLikeInstance.popup.close();\n\t\t}\n\t}\n\n\tstatic AdjustWindow(likeId)\n\t{\n\t\tlet likeInstance = RatingLike.getInstance(likeId);\n\n\t\tif (!likeInstance.popup)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlikeInstance.popup.bindOptions.forceBindPosition = true;\n\t\tlikeInstance.popup.adjustPosition();\n\t\tlikeInstance.popup.bindOptions.forceBindPosition = false;\n\t}\n\n\tstatic PopupScroll(likeId)\n\t{\n\t\tconst likeInstance = RatingLike.getInstance(likeId);\n\n\t\tlet contentContainerNodeList = likeInstance.popupContent.querySelectorAll('.bx-ilike-popup-content'); // reactions\n\t\tif (contentContainerNodeList.length <= 0)\n\t\t{\n\t\t\tcontentContainerNodeList = [ likeInstance.popupContent ];\n\t\t}\n\n\t\tcontentContainerNodeList.forEach((contentContainerNode) => {\n\t\t\tcontentContainerNode.addEventListener('scroll', (e) => {\n\t\t\t\tif (e.target.scrollTop <= (e.target.scrollHeight - e.target.offsetHeight) / 1.5)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis.List(likeId, null, (likeInstance.version == 2 ? RatingRender.popupCurrentReaction : false));\n\t\t\t\tEvent.unbindAll(e.target);\n\t\t\t});\n\t\t});\n\t}\n\n\tstatic List(likeId, page, reaction, clear)\n\t{\n\t\tconst likeInstance = RatingLike.getInstance(likeId);\n\n\t\tif (Number(likeInstance.countText.innerHTML) === 0)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\treaction = (Type.isStringFilled(reaction) ? reaction : '');\n\n\t\tif (Type.isNull(page))\n\t\t{\n\t\t\tpage = (\n\t\t\t\tlikeInstance.version === 2\n\t\t\t\t\t? (\n\t\t\t\t\t\t!Type.isUndefined(RatingRender.popupPagesList[reaction])\n\t\t\t\t\t\t\t? RatingRender.popupPagesList[reaction]\n\t\t\t\t\t\t\t: 1\n\t\t\t\t\t)\n\t\t\t\t\t: likeInstance.popupContentPage\n\t\t\t);\n\t\t}\n\n\t\tif (\n\t\t\tclear\n\t\t\t&& Number(page) === 1\n\t\t\t&& likeInstance.version === 2\n\t\t)\n\t\t{\n\t\t\tRatingRender.clearPopupContent({\n\t\t\t\tlikeId: likeId,\n\t\t\t});\n\t\t}\n\n\t\tif (likeInstance.listXHR)\n\t\t{\n\t\t\tlikeInstance.listXHR.abort();\n\t\t}\n\n\t\tajax.runAction('main.rating.list', {\n\t\t\tdata: {\n\t\t\t\tparams: {\n\t\t\t\t\tRATING_VOTE_TYPE_ID: likeInstance.entityTypeId,\n\t\t\t\t\tRATING_VOTE_KEY_SIGNED: likeInstance.keySigned,\n\t\t\t\t\tRATING_VOTE_ENTITY_ID: likeInstance.entityId,\n\t\t\t\t\tRATING_VOTE_LIST_PAGE: page,\n\t\t\t\t\tRATING_VOTE_REACTION: (reaction === 'all' ? '' : reaction),\n\t\t\t\t\tPATH_TO_USER_PROFILE: likeInstance.pathToUserProfile,\n\t\t\t\t},\n\t\t\t},\n\t\t\tonrequeststart: (xhr) => {\n\t\t\t\tlikeInstance.listXHR = xhr;\n\t\t\t},\n\t\t}).then((result) => {\n\t\t\t\tthis.onListSuccess(result.data, {\n\t\t\t\t\tlikeId: likeId,\n\t\t\t\t\treaction: reaction,\n\t\t\t\t\tpage: page,\n\t\t\t\t\tclear: clear,\n\t\t\t\t});\n\t\t\t},\n\t\t\t() => {}\n\t\t);\n\n\t\treturn false;\n\t}\n\n\tstatic onListSuccess(data, params)\n\t{\n\t\tif (!data)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst likeInstance = RatingLike.getInstance(params.likeId);\n\n\t\tlikeInstance.countText.innerHTML = data.items_all;\n\n\t\tif (Number(data.items_page) === 0)\n\t\t{\n\t\t\tif (Number(data.list_page) === 1)\n\t\t\t{\n\t\t\t\tlikeInstance.popup.close();\n\t\t\t}\n\t\t\treturn false;\n\t\t}\n\n\t\tif (likeInstance.version === 2)\n\t\t{\n\t\t\tRatingRender.buildPopupContent({\n\t\t\t\tlikeId: params.likeId,\n\t\t\t\treaction: params.reaction,\n\t\t\t\trating: likeInstance,\n\t\t\t\tpage: params.page,\n\t\t\t\tdata: data,\n\t\t\t\tclear: params.clear,\n\t\t\t});\n\t\t\tlikeInstance.topPanel.setAttribute('data-popup', 'Y');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tRatingRender.buildPopupContentNoReactions({\n\t\t\t\trating: likeInstance,\n\t\t\t\tpage: params.page,\n\t\t\t\tdata: data,\n\t\t\t});\n\t\t}\n\n\t\tthis.AdjustWindow(params.likeId);\n\t\tthis.PopupScroll(params.likeId);\n\t}\n\n\tstatic onResultClick(params)\n\t{\n\t\tconst likeId = (Type.isStringFilled(params.likeId) ? params.likeId : false);\n\t\tconst clickEvent = (!Type.isUndefined(params.event) ? params.event : false);\n\t\tconst reaction = (Type.isStringFilled(params.reaction) ? params.reaction : '');\n\t\tconst likeInstance = RatingLike.getInstance(likeId);\n\n\t\tif (likeInstance.resultPopupAnimation)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (\n\t\t\tlikeInstance.popup\n\t\t\t&& likeInstance.popup.isShown()\n\t\t)\n\t\t{\n\t\t\tlikeInstance.popup.close();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tclearTimeout(likeInstance.popupTimeoutIdList);\n\t\t\tclearTimeout(likeInstance.popupTimeoutIdShow);\n\n\t\t\tif (\n\t\t\t\tlikeInstance.popupContentPage == 1\n\t\t\t\t&& (\n\t\t\t\t\tlikeInstance.topPanel.getAttribute('data-popup') !== 'Y'\n\t\t\t\t\t|| likeInstance.popupCurrentReaction != reaction\n\t\t\t\t)\n\t\t\t)\n\t\t\t{\n\t\t\t\tthis.List(likeId, 1, reaction, true);\n\t\t\t}\n\n\t\t\tthis.OpenWindow(\n\t\t\t\tlikeId,\n\t\t\t\t(clickEvent.currentTarget === likeInstance.count ? null : clickEvent),\n\t\t\t\tclickEvent.currentTarget,\n\t\t\t\tclickEvent.currentTarget.id\n\t\t\t);\n\t\t}\n\t}\n\n\tstatic onResultMouseEnter(params)\n\t{\n\t\tconst likeId = (Type.isStringFilled(params.likeId) ? params.likeId : false);\n\t\tconst mouseEnterEvent = (!Type.isUndefined(params.event) ? params.event : null);\n\t\tconst reaction = (Type.isStringFilled(params.reaction) ? params.reaction : '');\n\t\tconst nodeId = (\n\t\t\tmouseEnterEvent && Type.isStringFilled(mouseEnterEvent.currentTarget.id)\n\t\t\t\t? mouseEnterEvent.currentTarget.id\n\t\t\t\t: ''\n\t\t);\n\n\t\tconst likeInstance = RatingLike.getInstance(likeId);\n\n\t\tlikeInstance.mouseInShowPopupNode[reaction] = true;\n\n\t\tclearTimeout(likeInstance.popupTimeoutIdList);\n\t\tclearTimeout(likeInstance.popupTimeoutIdShow);\n\n\t\tlikeInstance.popupTimeoutIdList = setTimeout(() => {\n\t\t\tthis.getListPopup({\n\t\t\t\tlikeId: likeId,\n\t\t\t\ttarget: mouseEnterEvent.currentTarget,\n\t\t\t\treaction: reaction,\n\t\t\t\tnodeId: nodeId,\n\t\t\t});\n\t\t}, 300);\n\t}\n\n\tstatic onResultMouseLeave(params)\n\t{\n\t\tconst likeId = (Type.isStringFilled(params.likeId) ? params.likeId : false);\n\t\tconst reaction = (Type.isStringFilled(params.reaction) ? params.reaction : '');\n\t\tconst likeInstance = RatingLike.getInstance(likeId);\n\n\t\tlikeInstance.mouseInShowPopupNode[reaction] = false;\n\t\tlikeInstance.resultPopupAnimation = false;\n\t}\n}\n","import { Type, Loc, Dom, Runtime, pos, GetWindowSize } from 'main.core';\nimport { EventEmitter } from 'main.core.events'\nimport {Lottie} from 'ui.lottie';\n\nimport { RatingManager } from './manager';\nimport { RatingLike } from './like';\nimport { ListPopup } from './listpopup';\nimport likeAnimatedEmojiData from '../animations/em_01.json';\nimport laughAnimatedEmojiData from '../animations/em_02.json';\nimport wonderAnimatedEmojiData from '../animations/em_03.json';\nimport cryAnimatedEmojiData from '../animations/em_04.json';\nimport angryAnimatedEmojiData from '../animations/em_05.json';\nimport facepalmAnimatedEmojiData from '../animations/em_06.json';\nimport kissAnimatedEmojiData from '../animations/em_07.json';\n\nexport class RatingRender\n{\n\tstatic reactionsList = [ 'like', 'kiss', 'laugh', 'wonder', 'cry', 'angry', 'facepalm' ];\n\tstatic reactionsAnimationData = {\n\t\tlike: likeAnimatedEmojiData,\n\t\tkiss: kissAnimatedEmojiData,\n\t\tlaugh: laughAnimatedEmojiData,\n\t\twonder: wonderAnimatedEmojiData,\n\t\tcry: cryAnimatedEmojiData,\n\t\tangry: angryAnimatedEmojiData,\n\t\tfacepalm: facepalmAnimatedEmojiData,\n\t}\n\tstatic popupCurrentReaction = false;\n\tstatic popupPagesList = [];\n\tstatic popupSizeInitialized = false;\n\tstatic blockShowPopup = false;\n\tstatic blockShowPopupTimeout = false;\n\tstatic afterClickBlockShowPopup = false;\n\tstatic afterClickHandler = null;\n\tstatic touchStartPosition = null;\n\tstatic touchCurrentPosition = {\n\t\tx: null,\n\t\ty: null,\n\t};\n\tstatic currentReactionNodeHover = null;\n\n\tstatic touchMoveDeltaY = null;\n\tstatic touchScrollTop = 0;\n\n\tstatic hasMobileTouchMoved = null;\n\tstatic mobileOverlay = null;\n\n\tstatic reactionsPopup = null;\n\tstatic reactionsPopupAnimation = null;\n\tstatic reactionsPopupAnimation2 = null;\n\tstatic reactionsPopupLikeId = null;\n\tstatic reactionsPopupMouseOutHandler = null;\n\tstatic reactionsPopupOpacityState = 0;\n\tstatic reactionsPopupTouchStartIn = null;\n\tstatic reactionsPopupPositionY = null;\n\tstatic blockTouchEndByScroll = false;\n\n\tstatic reactionsPopupMobileTouchEndHandler = this.reactionsPopupMobileTouchEnd.bind(this);\n\tstatic reactionsPopupMobileTouchMoveHandler = this.reactionsPopupMobileTouchMove.bind(this);\n\tstatic reactionsPopupMobileHideHandler = this.reactionsPopupMobileHide.bind(this);\n\n\tstatic getTopUsersText(params)\n\t{\n\t\tconst currentUserId = Number(Loc.getMessage('USER_ID'));\n\t\tconst you = (!Type.isUndefined(params.you) ? !!params.you : false);\n\t\tconst topList = (!Type.isUndefined(params.top) && Type.isArray(params.top) ? params.top : []);\n\t\tconst more = (!Type.isUndefined(params.more) ? Number(params.more) : 0);\n\t\tlet result = '';\n\n\t\tif (\n\t\t\ttopList.length <= 0\n\t\t\t&& !you\n\t\t\t&& (\n\t\t\t\tRatingManager.mobile\n\t\t\t\t|| more <= 0\n\t\t\t)\n\t\t)\n\t\t{\n\t\t\treturn result;\n\t\t}\n\n\t\tif (RatingManager.mobile)\n\t\t{\n\t\t\tif (you)\n\t\t\t{\n\t\t\t\ttopList.push({\n\t\t\t\t\tID: currentUserId,\n\t\t\t\t\tNAME_FORMATTED: Loc.getMessage('RATING_LIKE_TOP_TEXT3_YOU'),\n\t\t\t\t\tWEIGHT: 1,\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tresult = Loc.getMessage(`RATING_LIKE_TOP_TEXT3_${(topList.length > 1 ? '2' : '1')}`)\n\t\t\t\t.replace('#OVERFLOW_START#', RatingManager.mobile ? '<span class=\"feed-post-emoji-text-item-overflow\">' : '')\n\t\t\t\t.replace('#OVERFLOW_END#', RatingManager.mobile ? '</span>' : '');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tresult = Loc.getMessage(`RATING_LIKE_TOP_TEXT2_${(you ? 'YOU_' : '')}${(topList.length)}${(more > 0 ? '_MORE' : '')}`)\n\t\t\t\t.replace('#OVERFLOW_START#', RatingManager.mobile ? '<span class=\"feed-post-emoji-text-item-overflow\">' : '')\n\t\t\t\t.replace('#OVERFLOW_END#', RatingManager.mobile ? '</span>' : '')\n\t\t\t\t.replace('#MORE_START#', RatingManager.mobile ? '<span class=\"feed-post-emoji-text-item-more\">' : '&nbsp;')\n\t\t\t\t.replace('#MORE_END#', RatingManager.mobile ? '</span>' : '');\n\t\t}\n\n\t\tif (RatingManager.mobile)\n\t\t{\n\t\t\ttopList.sort((a, b) => {\n\t\t\t\tif (parseInt(a.ID) === currentUserId)\n\t\t\t\t{\n\t\t\t\t\treturn -1;\n\t\t\t\t}\n\n\t\t\t\tif (parseInt(b.ID) === currentUserId)\n\t\t\t\t{\n\t\t\t\t\treturn 1;\n\t\t\t\t}\n\n\t\t\t\tif (parseFloat(a.WEIGHT) === parseFloat(b.WEIGHT))\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn (parseFloat(a.WEIGHT) > parseFloat(b.WEIGHT) ? -1 : 1);\n\t\t\t});\n\n\t\t\tconst userNameList = topList.map((item) => {\n\t\t\t\treturn item.NAME_FORMATTED;\n\t\t\t});\n\n\t\t\tlet userNameBegin = '';\n\t\t\tlet userNameEnd = '';\n\n\t\t\tif (userNameList.length === 1)\n\t\t\t{\n\t\t\t\tuserNameBegin = userNameList.pop();\n\t\t\t\tuserNameEnd = '';\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tuserNameBegin = userNameList.slice(0, userNameList.length - 1)\n\t\t\t\t\t.join(Loc.getMessage('RATING_LIKE_TOP_TEXT3_USERLIST_SEPARATOR').replace(/#USERNAME#/g, ''));\n\t\t\t\tuserNameEnd = userNameList[userNameList.length - 1];\n\t\t\t}\n\n\t\t\tresult = result.replace('#USER_LIST_BEGIN#', userNameBegin)\n\t\t\t\t.replace('#USER_LIST_END#', userNameEnd);\n\t\t}\n\t\telse\n\t\t{\n\t\t\ttopList.forEach((item, i) => {\n\n\t\t\t\tresult = result.replace(\n\t\t\t\t\t`#USER_${(Number(i) + 1)}#`,\n\t\t\t\t\t`<span class=\"feed-post-emoji-text-item\">${item.NAME_FORMATTED}</span>`\n\t\t\t\t);\n\t\t\t});\n\n\t\t\tresult = result.replace('#USERS_MORE#', '<span class=\"feed-post-emoji-text-item\">' + more + '</span>');\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tstatic getUserReaction(params)\n\t{\n\t\treturn (\n\t\t\tType.isDomNode(params.userReactionNode)\n\t\t\t\t? params.userReactionNode.getAttribute('data-value')\n\t\t\t\t: ''\n\t\t);\n\t}\n\n\tstatic setReaction(params)\n\t{\n\t\tif (\n\t\t\tType.isUndefined(params.rating)\n\t\t\t|| !Type.isStringFilled(params.likeId)\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst action = (Type.isStringFilled(params.action) ? params.action : 'add');\n\t\tif (!['add', 'cancel', 'change'].includes(action))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst likeId = params.likeId;\n\t\tconst rating = params.rating;\n\t\tconst userReaction = (Type.isStringFilled(params.userReaction) ? params.userReaction : Loc.getMessage('RATING_LIKE_REACTION_DEFAULT'));\n\t\tconst userReactionOld = (Type.isStringFilled(params.userReactionOld) ? params.userReactionOld : Loc.getMessage('RATING_LIKE_REACTION_DEFAULT'));\n\t\tif (\n\t\t\taction === 'change'\n\t\t\t&& userReaction === userReactionOld\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst totalCount = (!Type.isUndefined(params.totalCount) ? Number(params.totalCount) : null);\n\t\tconst currentUserId = Number(Loc.getMessage('USER_ID'));\n\t\tconst userId = (!Type.isUndefined(params.userId) ? Number(params.userId) : currentUserId);\n\n\t\tconst userReactionNode = this.getNode(rating.userReactionNode);\n\t\tconst reactionsNode = this.getNode(rating.reactionsNode);\n\t\tconst topPanel = this.getNode(rating.topPanel);\n\t\tconst topPanelContainer = this.getNode(rating.topPanelContainer);\n\t\tconst topUsersText = this.getNode(rating.topUsersText);\n\t\tconst countText = this.getNode(rating.countText);\n\t\tconst buttonText = this.getNode(rating.buttonText);\n\n\t\tif (\n\t\t\tuserId === currentUserId // not pull\n\t\t\t&& userReactionNode\n\t\t)\n\t\t{\n\t\t\tuserReactionNode.setAttribute('data-value', [ 'add', 'change' ].includes(action) ? userReaction : '');\n\t\t}\n\n\t\tlet i = 0;\n\t\tlet elements = [];\n\t\tlet elementsNew = [];\n\n\t\tif (\n\t\t\ttotalCount !== null\n\t\t\t&& topPanel\n\t\t\t&& topUsersText\n\t\t\t&& reactionsNode\n\t\t)\n\t\t{\n\t\t\tif (totalCount > 0)\n\t\t\t{\n\t\t\t\ttopPanelContainer.classList.add('feed-post-emoji-top-panel-container-active');\n\n\t\t\t\tif (!topPanel.classList.contains('feed-post-emoji-container-toggle'))\n\t\t\t\t{\n\t\t\t\t\ttopPanel.classList.add('feed-post-emoji-container-toggle');\n\t\t\t\t\ttopUsersText.classList.add('feed-post-emoji-move-to-right');\n\t\t\t\t\treactionsNode.classList.add('feed-post-emoji-icon-box-show');\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (totalCount <= 0)\n\t\t\t{\n\t\t\t\ttopPanelContainer.classList.remove('feed-post-emoji-top-panel-container-active');\n\n\t\t\t\tif (topPanel.classList.contains('feed-post-emoji-container-toggle'))\n\t\t\t\t{\n\t\t\t\t\ttopPanel.classList.remove('feed-post-emoji-container-toggle');\n\t\t\t\t\ttopUsersText.classList.remove('feed-post-emoji-move-to-right');\n\t\t\t\t\treactionsNode.classList.remove('feed-post-emoji-icon-box-show');\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (\n\t\t\ttotalCount !== null\n\t\t\t&& countText\n\t\t)\n\t\t{\n\t\t\tif (\n\t\t\t\ttotalCount <= 0\n\t\t\t\t&& !countText.classList.contains('feed-post-emoji-text-counter-invisible')\n\t\t\t)\n\t\t\t{\n\t\t\t\tcountText.classList.add('feed-post-emoji-text-counter-invisible');\n\t\t\t}\n\t\t\telse if (\n\t\t\t\ttotalCount > 0\n\t\t\t\t&& countText.classList.contains('feed-post-emoji-text-counter-invisible')\n\t\t\t)\n\t\t\t{\n\t\t\t\tcountText.classList.remove('feed-post-emoji-text-counter-invisible');\n\t\t\t}\n\t\t}\n\n\t\tif (reactionsNode)\n\t\t{\n\t\t\tconst reactionsContainer = reactionsNode.querySelector('.feed-post-emoji-icon-container');\n\t\t\telements = reactionsNode.querySelectorAll('.feed-post-emoji-icon-item');\n\n\t\t\tif (reactionsContainer)\n\t\t\t{\n\t\t\t\tlet found = false;\n\t\t\t\tlet newValue = false;\n\n\t\t\t\telements.forEach((element) => {\n\n\t\t\t\t\tconst reactionValue = element.getAttribute('data-reaction');\n\t\t\t\t\tconst reactionCount = Number(element.getAttribute('data-value'));\n\n\t\t\t\t\tif (reactionValue === userReaction)\n\t\t\t\t\t{\n\t\t\t\t\t\tfound = true;\n\t\t\t\t\t\tif (action === 'cancel')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tnewValue = (reactionCount > 0 ? reactionCount - 1 : 0);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if ([ 'add', 'change' ].includes(action))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tnewValue = reactionCount + 1;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (newValue > 0 && newValue > reactionCount)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\telementsNew.push({\n\t\t\t\t\t\t\t\treaction: reactionValue,\n\t\t\t\t\t\t\t\tcount: newValue,\n\t\t\t\t\t\t\t\tanimate: {\n\t\t\t\t\t\t\t\t\ttype: 'pop',\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (newValue > 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\telementsNew.push({\n\t\t\t\t\t\t\t\treaction: reactionValue,\n\t\t\t\t\t\t\t\tcount: reactionCount,\n\t\t\t\t\t\t\t\tanimate: false,\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse if (\n\t\t\t\t\t\taction === 'change'\n\t\t\t\t\t\t&& reactionValue === userReactionOld\n\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\tnewValue = (reactionCount > 0 ? reactionCount - 1 : 0);\n\n\t\t\t\t\t\tif (newValue > 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\telementsNew.push({\n\t\t\t\t\t\t\t\treaction: reactionValue,\n\t\t\t\t\t\t\t\tcount: newValue,\n\t\t\t\t\t\t\t\tanimate: false,\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\telementsNew.push({\n\t\t\t\t\t\t\treaction: reactionValue,\n\t\t\t\t\t\t\tcount: reactionCount,\n\t\t\t\t\t\t\tanimate: false,\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tif (\n\t\t\t\t\t['add', 'change'].includes(action)\n\t\t\t\t\t&& !found\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\telementsNew.push({\n\t\t\t\t\t\treaction: userReaction,\n\t\t\t\t\t\tcount: 1,\n\t\t\t\t\t\tanimate: true,\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tDom.clean(reactionsContainer);\n\n\t\t\t\tif (topPanel)\n\t\t\t\t{\n\t\t\t\t\tif (elementsNew.length > 0)\n\t\t\t\t\t{\n\t\t\t\t\t\ttopPanel.classList.add('feed-post-emoji-container-nonempty');\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\ttopPanel.classList.remove('feed-post-emoji-container-nonempty');\n\t\t\t\t\t}\n\n\t\t\t\t\tif (RatingManager.mobile)\n\t\t\t\t\t{\n\t\t\t\t\t\tconst commentNode = topPanel.closest('.post-comment-block');\n\t\t\t\t\t\tif (commentNode)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (elementsNew.length > 0)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tcommentNode.classList.add('comment-block-rating-nonempty');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tcommentNode.classList.remove('comment-block-rating-nonempty');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tthis.drawReactions({\n\t\t\t\t\tlikeId: likeId,\n\t\t\t\t\tcontainer: reactionsContainer,\n\t\t\t\t\tdata: elementsNew,\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tif (\n\t\t\tuserId === currentUserId\n\t\t\t&& buttonText\n\t\t)\n\t\t{\n\t\t\tif ([ 'add', 'change' ].includes(action))\n\t\t\t{\n\t\t\t\tbuttonText.innerHTML = Loc.getMessage(`RATING_LIKE_EMOTION_${userReaction.toUpperCase()}_CALC`);\n\t\t\t\tif (RatingManager.mobile)\n\t\t\t\t{\n\t\t\t\t\tbuttonText.parentElement.className = '';\n\t\t\t\t\tbuttonText.parentElement.classList.add(\n\t\t\t\t\t\t'bx-ilike-left-wrap',\n\t\t\t\t\t\t'bx-you-like-button',\n\t\t\t\t\t\t`bx-you-like-button-${userReaction.toLowerCase()}`\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tbuttonText.innerHTML = Loc.getMessage('RATING_LIKE_EMOTION_LIKE_CALC');\n\t\t\t\tif (RatingManager.mobile)\n\t\t\t\t{\n\t\t\t\t\tbuttonText.parentElement.className = 'bx-ilike-left-wrap';\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic drawReactions(params)\n\t{\n\t\tconst container = (Type.isDomNode(params.container) ? params.container : null);\n\t\tconst data = (Type.isArray(params.data) ? params.data : []);\n\t\tconst likeId = (Type.isStringFilled(params.likeId) ? params.likeId : '')\n\t\tif (\n\t\t\t!container\n\t\t\t|| !Type.isStringFilled(likeId)\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst reactionEvents = (\n\t\t\tRatingManager.mobile\n\t\t\t\t? {}\n\t\t\t\t: {\n\t\t\t\t\tclick: this.resultReactionClick.bind(this),\n\t\t\t\t\tmouseenter: this.resultReactionMouseEnter.bind(this),\n\t\t\t\t\tmouseleave: this.resultReactionMouseLeave.bind(this),\n\t\t\t\t}\n\t\t);\n\n\t\tDom.clean(container);\n\n\t\tconst reactionsData = {};\n\n\t\tdata.forEach((element, i) => {\n\n\t\t\tconst classList = [\n\t\t\t\t'feed-post-emoji-icon-item',\n\t\t\t\t`feed-post-emoji-icon-item-${(i+1)}`,\n\t\t\t];\n\n\t\t\tif (element?.animate)\n\t\t\t{\n\t\t\t\tif (element.animate?.type === 'pop')\n\t\t\t\t{\n\t\t\t\t\tclassList.push('feed-post-emoji-animation-pop');\n\t\t\t\t}\n\t\t\t\telse if (i >= 1)\n\t\t\t\t{\n\t\t\t\t\tclassList.push('feed-post-emoji-icon-animate');\n\t\t\t\t}\n\t\t\t\telse if (data.length == 1)\n\t\t\t\t{\n\t\t\t\t\tclassList.push('feed-post-emoji-animation-pop');\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst emojiContainer = Dom.create('div', {\n\t\t\t\tprops: {\n\t\t\t\t\tid: `bx-ilike-result-reaction-${element.reaction}-${likeId}`,\n\t\t\t\t\tclassName: classList.join(' '),\n\t\t\t\t},\n\t\t\t\tattrs: {\n\t\t\t\t\t'data-reaction': element.reaction,\n\t\t\t\t\t'data-value': element.count,\n\t\t\t\t\t'data-like-id': likeId,\n\t\t\t\t\ttitle: Loc.getMessage(`RATING_LIKE_EMOTION_${element.reaction.toUpperCase()}_CALC`),\n\t\t\t\t},\n\t\t\t\tevents: reactionEvents,\n\t\t\t});\n\n\t\t\tconst animation = Lottie.loadAnimation({\n\t\t\t\tanimationData: this.reactionsAnimationData[element.reaction],\n\t\t\t\tcontainer: emojiContainer,\n\t\t\t\tloop: false,\n\t\t\t\tautoplay: false,\n\t\t\t\trenderer: 'svg',\n\t\t\t\trendererSettings: {\n\t\t\t\t\tviewBoxOnly: true,\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (Boolean(element.animate))\n\t\t\t{\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tanimation.play();\n\t\t\t\t}, 200);\n\t\t\t}\n\n\t\t\tcontainer.appendChild(emojiContainer);\n\n\t\t\treactionsData[element.reaction] = element.count;\n\t\t});\n\n\t\tcontainer.setAttribute('data-reactions-data', JSON.stringify(reactionsData));\n\t}\n\n\tstatic showReactionsPopup(params)\n\t{\n\t\tconst bindElement = this.getNode(params.bindElement);\n\t\tconst likeId = (Type.isStringFilled(params.likeId) ? params.likeId : '');\n\n\t\tif (\n\t\t\t!bindElement\n\t\t\t|| !Type.isStringFilled(likeId)\n\t\t)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.reactionsPopupLikeId = likeId;\n\n\t\tif (this.reactionsPopup === null)\n\t\t{\n\t\t\tconst reactionsNodesList = [];\n\n\t\t\tthis.reactionsList.forEach((currentEmotion, index) => {\n\n\t\t\t\tconst emojiItem = Dom.create('div', {\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tclassName: `feed-post-emoji-icon-item`,\n\t\t\t\t\t},\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\t'data-reaction': currentEmotion,\n\t\t\t\t\t\ttitle: Loc.getMessage(`RATING_LIKE_EMOTION_${currentEmotion.toUpperCase()}_CALC`),\n\t\t\t\t\t},\n\t\t\t\t});\n\n\t\t\t\tLottie.loadAnimation({\n\t\t\t\t\trenderer: 'svg',\n\t\t\t\t\tcontainer: emojiItem,\n\t\t\t\t\tanimationData: this.reactionsAnimationData[currentEmotion],\n\t\t\t\t});\n\n\t\t\t\treactionsNodesList.push(emojiItem);\n\t\t\t});\n\n\t\t\tthis.reactionsPopup = Dom.create('div', {\n\t\t\t\tprops: {\n\t\t\t\t\tclassName: `feed-post-emoji-popup-container ${(RatingManager.mobile ? '--mobile' : '')}`,\n\t\t\t\t},\n\t\t\t\tchildren: [\n\t\t\t\t\tDom.create('div', {\n\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\tclassName: 'feed-post-emoji-icon-inner',\n\t\t\t\t\t\t},\n\t\t\t\t\t\tchildren: reactionsNodesList,\n\t\t\t\t\t})\n\t\t\t\t],\n\t\t\t});\n\n\t\t\tthis.reactionsPopup.addEventListener((RatingManager.mobile ? 'touchend' : 'click'), (e) => {\n\n\t\t\t\tconst reactionNode = (\n\t\t\t\t\t(e.target.classList.contains('feed-post-emoji-icon-item'))\n\t\t\t\t\t\t? e.target\n\t\t\t\t\t\t: e.target.closest('.feed-post-emoji-icon-item')\n\t\t\t\t);\n\n\t\t\t\tif (reactionNode)\n\t\t\t\t{\n\t\t\t\t\tRatingLike.ClickVote(\n\t\t\t\t\t\te,\n\t\t\t\t\t\tthis.reactionsPopupLikeId,\n\t\t\t\t\t\treactionNode.getAttribute('data-reaction'),\n\t\t\t\t\t\ttrue\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\te.preventDefault();\n\t\t\t});\n\n\t\t\tDom.append(this.reactionsPopup, document.body);\n\t\t}\n\t\telse if (this.reactionsPopup.classList.contains('feed-post-emoji-popup-invisible'))\n\t\t{\n\t\t\tthis.reactionsPopup.classList.remove('feed-post-emoji-popup-invisible');\n\t\t}\n\t\telse if (\n\t\t\tRatingManager.mobile\n\t\t\t&& this.reactionsPopup.classList.contains('feed-post-emoji-popup-invisible-final-mobile')\n\t\t)\n\t\t{\n\t\t\tthis.reactionsPopup.classList.remove('feed-post-emoji-popup-invisible-final-mobile');\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.reactionsPopupMouseOutHandler = this.getReactionsPopupMouseOutHandler(likeId);\n\n\t\tconst bindElementPosition = pos(bindElement);\n\n\t\tif (\n\t\t\tbindElement.closest('.feed-com-informers-bottom')\n\t\t\t&& bindElement.closest('.iframe-comments-cont, .task-iframe-popup')\n\t\t)\n\t\t{\n\t\t\tbindElementPosition.left += 100;\n\t\t}\n\n\t\tconst inverted = ((bindElementPosition.top - GetWindowSize().scrollTop) < 80);\n\t\tconst deltaY = (inverted ? 15 : -45);\n\n\t\tif (inverted)\n\t\t{\n\t\t\tthis.reactionsPopup.classList.add('feed-post-emoji-popup-inverted');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.reactionsPopup.classList.remove('feed-post-emoji-popup-inverted');\n\t\t}\n\n\t\tconst likeInstance = RatingLike.getInstance(likeId);\n\n\t\tif (RatingManager.mobile)\n\t\t{\n\t\t\tthis.touchMoveDeltaY = (inverted ? 60 : -45);\n\t\t\tDom.adjust(this.reactionsPopup, {\n\t\t\t\tstyle: {\n\t\t\t\t\tleft: '12px',\n\t\t\t\t\ttop: ((inverted ? (bindElementPosition.top - 23) : (bindElementPosition.top - 28)) + deltaY) + 'px',\n\t\t\t\t\twidth: '330px',\n\t\t\t\t\tborderRadius: '61px',\n\t\t\t\t},\n\t\t\t});\n\n\t\t\tthis.reactionsPopup.classList.remove('feed-post-emoji-popup-invisible-final');\n\t\t\tthis.reactionsPopup.classList.add('feed-post-emoji-popup-active-final');\n\t\t\tthis.reactionsPopup.classList.add('feed-post-emoji-popup-active-final-item');\n\t\t\tlikeInstance.box.classList.add('feed-post-emoji-control-active');\n\t\t\tthis.reactionsPopupMobileDisableScroll();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.reactionsPopupAnimation = new BX.easing({\n\t\t\t\tduration: 300,\n\t\t\t\tstart: {\n\t\t\t\t\twidth: 100,\n\t\t\t\t\tleft: (bindElementPosition.left + (bindElementPosition.width / 2) - 50),\n\t\t\t\t\ttop: ((inverted ? bindElementPosition.top - 30 : bindElementPosition.top + 30 ) + deltaY),\n\t\t\t\t\tborderRadius: 0,\n\t\t\t\t\topacity: 0,\n\t\t\t\t},\n\t\t\t\tfinish: {\n\t\t\t\t\twidth: 300,\n\t\t\t\t\tleft: (bindElementPosition.left + (bindElementPosition.width / 2) - 133),\n\t\t\t\t\ttop: (bindElementPosition.top + deltaY - 5),\n\t\t\t\t\tborderRadius: 50,\n\t\t\t\t\topacity: 100,\n\t\t\t\t},\n\t\t\t\ttransition : BX.easing.makeEaseInOut(BX.easing.transitions.cubic),\n\t\t\t\tstep: (state) => {\n\t\t\t\t\tif (!this.reactionsPopup)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.reactionsPopupAnimation.stop();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tthis.reactionsPopup.style.width = `${state.width}px`;\n\t\t\t\t\tthis.reactionsPopup.style.left = `${state.left}px`;\n\t\t\t\t\tthis.reactionsPopup.style.top = `${state.top}px`;\n\t\t\t\t\tthis.reactionsPopup.style.borderRadius = `${state.borderRadius}px`;\n\t\t\t\t\tthis.reactionsPopup.style.opacity = state.opacity / 100;\n\t\t\t\t\tthis.reactionsPopupOpacityState = state.opacity;\n\t\t\t\t},\n\t\t\t\tcomplete: () => {\n\t\t\t\t\tif (!this.reactionsPopup)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tthis.reactionsPopup.style.opacity = '';\n\t\t\t\t\tthis.reactionsPopup.classList.add('feed-post-emoji-popup-active-final');\n\t\t\t\t\tlikeInstance.box.classList.add('feed-post-emoji-control-active');\n\t\t\t\t\tif (Type.isFunction(params.onComplete))\n\t\t\t\t\t{\n\t\t\t\t\t\tparams.onComplete();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t});\n\t\t\tthis.reactionsPopupAnimation.animate();\n\n\t\t\tsetTimeout(() => {\n\n\t\t\t\tif (!this.reactionsPopup)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst reactions = this.reactionsPopup.querySelectorAll('.feed-post-emoji-icon-item');\n\n\t\t\t\tthis.reactionsPopupAnimation2 = new BX.easing({\n\t\t\t\t\tduration: 140,\n\t\t\t\t\tstart: {\n\t\t\t\t\t\topacity: 0,\n\t\t\t\t\t},\n\t\t\t\t\tfinish: {\n\t\t\t\t\t\topacity: 100\n\t\t\t\t\t},\n\t\t\t\t\ttransition : BX.easing.transitions.cubic,\n\t\t\t\t\tstep: (state) => {\n\t\t\t\t\t\treactions[0].style.opacity = state.opacity / 100;\n\t\t\t\t\t\treactions[1].style.opacity = state.opacity / 100;\n\t\t\t\t\t\treactions[2].style.opacity = state.opacity / 100;\n\t\t\t\t\t\treactions[3].style.opacity = state.opacity / 100;\n\t\t\t\t\t\treactions[4].style.opacity = state.opacity / 100;\n\t\t\t\t\t\treactions[5].style.opacity = state.opacity / 100;\n\t\t\t\t\t\treactions[6].style.opacity = state.opacity / 100;\n\t\t\t\t\t},\n\t\t\t\t\tcomplete: () => {\n\t\t\t\t\t\tthis.reactionsPopup.classList.add('feed-post-emoji-popup-active-final-item');\n\t\t\t\t\t\treactions[0].style.opacity = '';\n\t\t\t\t\t\treactions[1].style.opacity = '';\n\t\t\t\t\t\treactions[2].style.opacity = '';\n\t\t\t\t\t\treactions[3].style.opacity = '';\n\t\t\t\t\t\treactions[4].style.opacity = '';\n\t\t\t\t\t\treactions[5].style.opacity = '';\n\t\t\t\t\t\treactions[6].style.opacity = '';\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t\tthis.reactionsPopupAnimation2.animate();\n\t\t\t}, 100);\n\t\t}\n\n\t\tif (!this.reactionsPopup.classList.contains('feed-post-emoji-popup-active'))\n\t\t{\n\t\t\tthis.reactionsPopup.classList.add('feed-post-emoji-popup-active');\n\t\t}\n\n\t\tif (!RatingManager.mobile)\n\t\t{\n\t\t\tdocument.addEventListener('mousemove', this.reactionsPopupMouseOutHandler);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.touchScrollTop = GetWindowSize().scrollTop;\n\t\t\tthis.hasMobileTouchMoved = null;\n\n\t\t\twindow.addEventListener('touchend', this.reactionsPopupMobileTouchEndHandler);\n\t\t\twindow.addEventListener('touchmove', this.reactionsPopupMobileTouchMoveHandler);\n\t\t}\n\t}\n\n\tstatic reactionsPopupMobileTouchEnd(e)\n\t{\n\t\tconst coords = {\n\t\t\tx: e.changedTouches[0].pageX, // e.touches[0].clientX + window.pageXOffset\n\t\t\ty: e.changedTouches[0].pageY, // e.touches[0].clientY + window.pageYOffset\n\t\t};\n\n\t\tif (this.hasMobileTouchMoved === true)\n\t\t{\n\t\t\tlet userReaction = null;\n\t\t\tconst reactionNode = this.reactionsPopupMobileGetHoverNode(coords.x, coords.y);\n\n\t\t\tif (\n\t\t\t\treactionNode\n\t\t\t\t&& (userReaction = reactionNode.getAttribute('data-reaction'))\n\t\t\t)\n\t\t\t{\n\t\t\t\tRatingLike.ClickVote(\n\t\t\t\t\te,\n\t\t\t\t\tthis.reactionsPopupLikeId,\n\t\t\t\t\tuserReaction,\n\t\t\t\t\ttrue\n\t\t\t\t);\n\t\t\t}\n\t\t\tthis.reactionsPopupMobileHideHandler();\n\t\t}\n\t\telse // show reactions popup and handle clicks\n\t\t{\n\t\t\twindow.addEventListener('touchend', this.reactionsPopupMobileHideHandler);\n\t\t}\n\n\t\twindow.removeEventListener('touchend', this.reactionsPopupMobileTouchEndHandler);\n\t\twindow.removeEventListener('touchmove', this.reactionsPopupMobileTouchMoveHandler);\n\n\t\tthis.touchStartPosition = null;\n\t\te.preventDefault();\n\t}\n\n\tstatic reactionsPopupMobileTouchMove(e)\n\t{\n\t\tconst coords = {\n\t\t\tx: e.touches[0].pageX, // e.touches[0].clientX + window.pageXOffset\n\t\t\ty: e.touches[0].pageY, // e.touches[0].clientY + window.pageYOffset\n\t\t};\n\n\n\t\tthis.touchCurrentPosition = {\n\t\t\tx: coords.x,\n\t\t\ty: coords.y,\n\t\t};\n\n\t\tif (this.touchStartPosition === null)\n\t\t{\n\t\t\tthis.touchStartPosition = {\n\t\t\t\tx: coords.x,\n\t\t\t\ty: coords.y,\n\t\t\t};\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (this.hasMobileTouchMoved !== true)\n\t\t\t{\n\t\t\t\tthis.hasMobileTouchMoved = !this.reactionsPopupMobileCheckTouchMove();\n\t\t\t}\n\t\t}\n\n\t\tif (this.hasMobileTouchMoved === true)\n\t\t{\n\t\t\tconst reactionNode = this.reactionsPopupMobileGetHoverNode(coords.x, coords.y);\n\t\t\tif (reactionNode)\n\t\t\t{\n\t\t\t\tif (\n\t\t\t\t\tthis.currentReactionNodeHover\n\t\t\t\t\t&& this.currentReactionNodeHover !== reactionNode\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tthis.reactionsPopupMobileRemoveHover(this.currentReactionNodeHover);\n\t\t\t\t}\n\t\t\t\tthis.reactionsPopupMobileAddHover(reactionNode);\n\t\t\t\tthis.currentReactionNodeHover = reactionNode;\n\t\t\t}\n\t\t\telse if (this.currentReactionNodeHover)\n\t\t\t{\n\t\t\t\tthis.reactionsPopupMobileRemoveHover(this.currentReactionNodeHover);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (this.currentReactionNodeHover)\n\t\t\t{\n\t\t\t\tthis.reactionsPopupMobileRemoveHover(this.currentReactionNodeHover);\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic blockReactionsPopup()\n\t{\n\t\tif (this.blockShowPopupTimeout)\n\t\t{\n\t\t\twindow.clearTimeout(this.blockShowPopupTimeout);\n\t\t}\n\n\t\tthis.blockShowPopup = true;\n\t\tthis.blockShowPopupTimeout = setTimeout(() => {\n\t\t\tthis.blockShowPopup = false;\n\t\t}, 500);\n\t}\n\n\tstatic hideReactionsPopup(params)\n\t{\n\t\tconst likeId = (Type.isStringFilled(params.likeId) ? params.likeId : false);\n\n\t\tif (this.reactionsPopup)\n\t\t{\n\t\t\tif (RatingManager.mobile)\n\t\t\t{\n\t\t\t\tthis.reactionsPopup.classList.add('feed-post-emoji-popup-invisible-final');\n\t\t\t\tthis.reactionsPopup.classList.add('feed-post-emoji-popup-invisible-final-mobile');\n\t\t\t\tthis.reactionsPopup.classList.remove('feed-post-emoji-popup-active');\n\t\t\t\tthis.reactionsPopup.classList.remove('feed-post-emoji-popup-active-final');\n\t\t\t\tthis.reactionsPopup.classList.remove('feed-post-emoji-popup-active-final-item');\n\t\t\t\tthis.reactionsPopupMobileEnableScroll();\n\t\t\t\tDom.remove(this.reactionsPopup);\n\t\t\t\tthis.reactionsPopup = null;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (this.reactionsPopupAnimation)\n\t\t\t\t{\n\t\t\t\t\tthis.reactionsPopupAnimation.stop();\n\t\t\t\t}\n\t\t\t\tif (this.reactionsPopupAnimation2)\n\t\t\t\t{\n\t\t\t\t\tthis.reactionsPopupAnimation2.stop();\n\t\t\t\t}\n\n\t\t\t\tthis.reactionsPopup.classList.add('feed-post-emoji-popup-invisible');\n\n\t\t\t\tthis.reactionsPopupAnimation4 = new BX.easing({\n\t\t\t\t\tduration: 500,\n\t\t\t\t\tstart: {\n\t\t\t\t\t\topacity: this.reactionsPopupOpacityState,\n\t\t\t\t\t},\n\t\t\t\t\tfinish: {\n\t\t\t\t\t\topacity: 0,\n\t\t\t\t\t},\n\t\t\t\t\ttransition: BX.easing.transitions.linear,\n\t\t\t\t\tstep: (state) => {\n\t\t\t\t\t\tthis.reactionsPopup.style.opacity = state.opacity / 100;\n\t\t\t\t\t\tthis.reactionsPopupOpacityState = state.opacity;\n\t\t\t\t\t},\n\t\t\t\t\tcomplete: () => {\n\t\t\t\t\t\tthis.reactionsPopup.style.opacity = '';\n\t\t\t\t\t\tthis.reactionsPopup.classList.add('feed-post-emoji-popup-invisible-final');\n\t\t\t\t\t\tthis.reactionsPopup.classList.remove('feed-post-emoji-popup-active');\n\t\t\t\t\t\tthis.reactionsPopup.classList.remove('feed-post-emoji-popup-active-final');\n\t\t\t\t\t\tthis.reactionsPopup.classList.remove('feed-post-emoji-popup-active-final-item');\n\t\t\t\t\t\tDom.remove(this.reactionsPopup);\n\t\t\t\t\t\tthis.reactionsPopup = null;\n\t\t\t\t\t},\n\t\t\t\t});\n\n\t\t\t\tthis.reactionsPopupAnimation4.animate();\n\t\t\t}\n\n\t\t\tthis.reactionsPopupLikeId = null;\n\n\t\t\tif (likeId)\n\t\t\t{\n\t\t\t\tRatingLike.getInstance(likeId).box.classList.remove('feed-post-emoji-control-active');\n\t\t\t}\n\t\t}\n\n\t\tthis.reactionsPopupMobileRemoveHover(this.currentReactionNodeHover);\n\n\t\tif (likeId)\n\t\t{\n\t\t\tthis.bindReactionsPopup({\n\t\t\t\tlikeId: likeId,\n\t\t\t});\n\t\t}\n\t}\n\n\tstatic reactionsPopupMobileCheckTouchMove()\n\t{\n\t\tif (this.touchStartPosition === null)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (\n\t\t\t\tMath.abs(this.touchCurrentPosition.x - this.touchStartPosition.x) > 5\n\t\t\t\t|| Math.abs(this.touchCurrentPosition.y - this.touchStartPosition.y) > 5\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tstatic reactionsPopupMobileHide(e)\n\t{\n\t\twindow.removeEventListener('touchend', this.reactionsPopupMobileHideHandler);\n\t\tif (this.reactionsPopupLikeId)\n\t\t{\n\t\t\tthis.hideReactionsPopup({\n\t\t\t\tlikeId: this.reactionsPopupLikeId,\n\t\t\t});\n\n\t\t\tif (e)\n\t\t\t{\n\t\t\t\te.preventDefault();\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic reactionsPopupMobileGetHoverNode(x, y)\n\t{\n\t\tconst nodeAboveFinger = document.elementFromPoint(x, (y + this.touchMoveDeltaY - this.touchScrollTop));\n\t\tconst nodeBelowFinger = document.elementFromPoint(x, (y - this.touchScrollTop));\n\n\t\tconst iconNodeAboveFinger = nodeAboveFinger?.closest('[data-reaction]');\n\t\tconst iconNodeBelowFinger = nodeBelowFinger?.closest('[data-reaction]');\n\n\t\tconst reactionNode = iconNodeAboveFinger || iconNodeBelowFinger;\n\n\t\tconst userReaction = reactionNode?.getAttribute('data-reaction');\n\n\t\treturn Type.isStringFilled(userReaction) ? reactionNode : null;\n\t}\n\n\tstatic reactionsPopupMobileAddHover(reactionNode)\n\t{\n\t\tif (!reactionNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\treactionNode.classList.add('feed-post-emoji-icon-item-hover');\n\t}\n\n\tstatic reactionsPopupMobileRemoveHover(reactionNode)\n\t{\n\t\tif (!reactionNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\treactionNode.classList.remove('feed-post-emoji-icon-item-hover');\n\t}\n\n\tstatic reactionsPopupMobileEnableScroll()\n\t{\n\t\tdocument.removeEventListener('touchmove', this.touchMoveScrollListener, { passive: false });\n\t\tEventEmitter.emit('onPullDownEnable');\n\n\t\tif (this.mobileOverlay !== null)\n\t\t{\n\t\t\tDom.clean(this.mobileOverlay);\n\t\t\tDom.remove(this.mobileOverlay);\n\n\t\t\tthis.mobileOverlay = null;\n\t\t}\n\t}\n\n\tstatic reactionsPopupMobileDisableScroll()\n\t{\n\t\tdocument.addEventListener('touchmove', this.touchMoveScrollListener, { passive: false });\n\t\tif (app)\n\t\t{\n\t\t\tapp.exec('disableTabScrolling');\n\t\t}\n\t\tEventEmitter.emit('onPullDownDisable');\n\n\t\tif (!Type.isNull(this.mobileOverlay))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.mobileOverlay = Dom.create('DIV', {\n\t\t\tprops: {\n\t\t\t\tclassName: 'feed-post-emoji-popup-mobile-overlay',\n\t\t\t},\n\t\t});\n\t\tsetTimeout(() => {\n\t\t\tif (Type.isNull(this.mobileOverlay))\n\t\t\t{\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\tDom.append(this.mobileOverlay, document.body);\n\t\t}, 1000); // to avoid blink\n\t}\n\n\tstatic bindReactionsPopup(params) {\n\n\t\tif (RatingManager.mobile)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst likeId = (Type.isStringFilled(params.likeId) ? params.likeId : '');\n\n\t\tif (!Type.isStringFilled(likeId))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst likeInstance = RatingLike.getInstance(likeId);\n\t\tif (!likeInstance)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tlikeInstance.mouseOverHandler = Runtime.debounce(this.getMouseOverHandler(likeId), 500);\n\n\t\tlikeInstance.box.addEventListener('mouseenter', likeInstance.mouseOverHandler);\n\t\tlikeInstance.box.addEventListener('mouseleave', this.blockReactionsPopup);\n\t}\n\n\tstatic touchMoveScrollListener(e)\n\t{\n\t\te.preventDefault();\n\t}\n\n\tstatic getReactionsPopupMouseOutHandler(likeId)\n\t{\n\t\treturn (e) => {\n\n\t\t\tif (!this.reactionsPopup)\n\t\t\t{\n\t\t\t\tdocument.removeEventListener('mousemove', this.reactionsPopupMouseOutHandler)\n\t\t\t\tthis.reactionsPopupMouseOutHandler = null;\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst popupPosition = this.reactionsPopup.getBoundingClientRect();\n\t\t\tconst inverted = this.reactionsPopup.classList.contains('feed-post-emoji-popup-inverted');\n\n\t\t\tif (\n\t\t\t\te.clientX >= popupPosition.left\n\t\t\t\t&& e.clientX <= popupPosition.right\n\t\t\t\t&& e.clientY >= popupPosition.top - (inverted ? 25 : 0)\n\t\t\t\t&& e.clientY <= (popupPosition.bottom + (inverted ? 0 : 25))\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.blockReactionsPopup();\n\t\t\tthis.hideReactionsPopup({\n\t\t\t\tlikeId: likeId\n\t\t\t});\n\n\t\t\tdocument.removeEventListener('mousemove', this.reactionsPopupMouseOutHandler)\n\t\t\tthis.reactionsPopupMouseOutHandler = null;\n\t\t};\n\t}\n\n\tstatic getMouseOverHandler(likeId)\n\t{\n\t\treturn () => {\n\n\t\t\tconst likeInstance = RatingLike.getInstance(likeId);\n\n\t\t\tif (\n\t\t\t\tthis.reactionsPopup\n\t\t\t\t&& !this.reactionsPopup?.classList.contains('feed-post-emoji-popup-invisible')\n\t\t\t\t&& !(\n\t\t\t\t\tRatingManager.mobile\n\t\t\t\t\t&& this.reactionsPopup?.classList.contains('feed-post-emoji-popup-invisible-final-mobile')\n\t\t\t\t)\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!this.afterClickBlockShowPopup)\n\t\t\t{\n\t\t\t\tif (this.blockShowPopup)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (RatingManager.mobile)\n\t\t\t\t{\n\t\t\t\t\tapp.exec('callVibration');\n\t\t\t\t}\n\n\t\t\t\tthis.showReactionsPopup({\n\t\t\t\t\tbindElement: likeInstance.box,\n\t\t\t\t\tlikeId: likeId,\n\t\t\t\t\tonComplete: () => {\n\t\t\t\t\t\tlikeInstance.box.removeEventListener('mouseenter', likeInstance.mouseOverHandler);\n\t\t\t\t\t\tlikeInstance.box.removeEventListener('mouseleave', this.blockReactionsPopup.bind(this));\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\t}\n\n\tstatic buildPopupContent(params)\n\t{\n\t\tconst clear = (params.clear ? Boolean(params.clear) : false);\n\t\tconst likeId = (Type.isStringFilled(params.likeId) ? params.likeId : '');\n\t\tconst rating = params.rating;\n\t\tconst requestReaction = (Type.isStringFilled(params.reaction) ? params.reaction : '');\n\t\tconst page = (Number(params.page) > 0 ? Number(params.page) : 1);\n\t\tconst data = params.data;\n\t\tconst reaction = false;\n\n\t\tconst reactionsList = [];\n\t\tlet reactionsCount = 0;\n\n\t\tif (\n\t\t\tclear\n\t\t\t&& page === 1\n\t\t)\n\t\t{\n\t\t\tthis.clearPopupContent({\n\t\t\t\tlikeId: likeId,\n\t\t\t});\n\t\t}\n\n\t\tthis.popupCurrentReaction = (Type.isStringFilled(requestReaction) ? requestReaction : 'all');\n\n\t\tif (\n\t\t\trequestReaction.length <= 0\n\t\t\t|| requestReaction == 'all'\n\t\t) // first current tab\n\t\t{\n\t\t\tthis.popupSizeInitialized = false;\n\t\t\tdocument.getElementById(`bx-ilike-popup-cont-${likeId}`).style.height = 'auto';\n\t\t\tdocument.getElementById(`bx-ilike-popup-cont-${likeId}`).style.minWidth = 'auto';\n\t\t}\n\n\t\tif (!Type.isStringFilled(requestReaction))\n\t\t{\n\t\t\tthis.popupPagesList = {};\n\t\t}\n\n\t\tthis.popupPagesList[(requestReaction == '' ? 'all' : requestReaction)] = (page + 1);\n\n\t\tif (Type.isPlainObject(data.reactions))\n\t\t{\n\t\t\tObject.entries(data.reactions).forEach(([ reaction, count ]) => {\n\t\t\t\tif (Number(count) <= 0)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\treactionsList.push({\n\t\t\t\t\treaction: reaction,\n\t\t\t\t\tcount: Number(count)\n\t\t\t\t});\n\t\t\t\treactionsCount++;\n\t\t\t});\n\t\t}\n\n\t\tconst tabsNode = Dom.create('span', {\n\t\t\tprops: {\n\t\t\t\tclassName: 'bx-ilike-popup-head',\n\t\t\t},\n\t\t});\n\n\t\tif (reactionsCount > 1)\n\t\t{\n\t\t\tconst headClassList = [ 'bx-ilike-popup-head-item' ];\n\t\t\tif (!Type.isStringFilled(requestReaction) || requestReaction == 'all')\n\t\t\t{\n\t\t\t\theadClassList.push('bx-ilike-popup-head-item-current');\n\t\t\t}\n\n\t\t\ttabsNode.appendChild(Dom.create('span', {\n\t\t\t\tprops: {\n\t\t\t\t\tclassName: headClassList.join(' '),\n\t\t\t\t},\n\t\t\t\tchildren: [\n\t\t\t\t\tDom.create('span', {\n\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\tclassName: 'bx-ilike-popup-head-icon feed-post-emoji-icon-all',\n\t\t\t\t\t\t},\n\t\t\t\t\t}),\n\t\t\t\t\tDom.create('span', {\n\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\tclassName: 'bx-ilike-popup-head-text',\n\t\t\t\t\t\t},\n\t\t\t\t\t\thtml: Loc.getMessage('RATING_LIKE_POPUP_ALL').replace('#CNT#', Number(data.items_all)),\n\t\t\t\t\t})\n\t\t\t\t],\n\t\t\t\tevents: {\n\t\t\t\t\tclick: ((e) => {\n\t\t\t\t\t\tthis.changePopupTab({\n\t\t\t\t\t\t\tlikeId: likeId,\n\t\t\t\t\t\t\trating: rating,\n\t\t\t\t\t\t\treaction: 'all',\n\t\t\t\t\t\t});\n\t\t\t\t\t\te. preventDefault();\n\t\t\t\t\t}),\n\t\t\t\t},\n\t\t\t}));\n\t\t}\n\n\t\tif (reactionsCount === 0)\n\t\t{\n\t\t\treactionsList.push({\n\t\t\t\treaction: Loc.getMessage('RATING_LIKE_REACTION_DEFAULT'),\n\t\t\t\tcount: Number(data.items_all),\n\t\t\t});\n\t\t}\n\n\t\treactionsList.sort((a, b) => {\n\t\t\tconst sample = {\n\t\t\t\tlike: 0,\n\t\t\t\tkiss: 1,\n\t\t\t\tlaugh: 2,\n\t\t\t\twonder: 3,\n\t\t\t\tcry: 4,\n\t\t\t\tangry: 5,\n\t\t\t\tfacepalm: 6,\n\t\t\t};\n\t\t\tif (sample[a.reaction] < sample[b.reaction])\n\t\t\t{\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t\tif (sample[a.reaction] > sample[b.reaction])\n\t\t\t{\n\t\t\t\treturn 1;\n\t\t\t}\n\t\t\treturn 0;\n\t\t});\n\n\t\treactionsList.forEach((reactionData) => {\n\n\t\t\tconst headItemClassList = [ 'bx-ilike-popup-head-item' ];\n\t\t\tif (requestReaction === reactionData.reaction)\n\t\t\t{\n\t\t\t\theadItemClassList.push('bx-ilike-popup-head-item-current');\n\t\t\t}\n\n\t\t\ttabsNode.appendChild(Dom.create('span', {\n\t\t\t\tprops: {\n\t\t\t\t\tclassName: headItemClassList.join(' '),\n\t\t\t\t},\n\t\t\t\tattrs: {\n\t\t\t\t\ttitle: Loc.getMessage(`RATING_LIKE_EMOTION_${reactionData.reaction.toUpperCase()}_CALC`),\n\t\t\t\t},\n\t\t\t\tchildren: [\n\t\t\t\t\tDom.create('span', {\n\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\tclassName: [\n\t\t\t\t\t\t\t\t'bx-ilike-popup-head-icon',\n\t\t\t\t\t\t\t\t'feed-post-emoji-icon-item',\n\t\t\t\t\t\t\t\t`feed-post-emoji-icon-${reactionData.reaction}`,\n\t\t\t\t\t\t\t].join(' '),\n\t\t\t\t\t\t}\n\t\t\t\t\t}),\n\t\t\t\t\tDom.create('span', {\n\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\tclassName: 'bx-ilike-popup-head-text',\n\t\t\t\t\t\t},\n\t\t\t\t\t\thtml: reactionData.count,\n\t\t\t\t\t})\n\t\t\t\t],\n\t\t\t\tevents: {\n\t\t\t\t\tclick: (e) => {\n\n\t\t\t\t\t\tconst popupContent = document.getElementById(`bx-ilike-popup-cont-${likeId}`);\n\t\t\t\t\t\tconst popupContentPosition = popupContent.getBoundingClientRect();\n\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\trequestReaction.length <= 0\n\t\t\t\t\t\t\t|| requestReaction === 'all'\n\t\t\t\t\t\t) // first current tab\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.popupSizeInitialized = true;\n\t\t\t\t\t\t\tpopupContent.style.height = `${popupContentPosition.height}px`;\n\t\t\t\t\t\t\tpopupContent.style.minWidth = `${popupContentPosition.width}px`;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (popupContentPosition.width > Number(popupContent.style.minWidth))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tpopupContent.style.minWidth = `${popupContentPosition.width}px`;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis.changePopupTab({\n\t\t\t\t\t\t\tlikeId: likeId,\n\t\t\t\t\t\t\trating: rating,\n\t\t\t\t\t\t\treaction: reactionData.reaction,\n\t\t\t\t\t\t});\n\t\t\t\t\t\te. preventDefault();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t}));\n\t\t});\n\n\t\tlet usersNode = rating.popupContent.querySelector('.bx-ilike-popup-content-container');\n\t\tlet usersNodeExists = false;\n\n\t\tif (!usersNode)\n\t\t{\n\t\t\tusersNode = Dom.create('span', {\n\t\t\t\tprops: {\n\t\t\t\t\tclassName: 'bx-ilike-popup-content-container',\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tusersNodeExists = true;\n\t\t}\n\n\t\tusersNode.querySelectorAll('.bx-ilike-popup-content').forEach((contentNode) => {\n\t\t\tcontentNode.classList.add('bx-ilike-popup-content-invisible');\n\t\t});\n\n\t\tlet reactionUsersNode = usersNode.querySelector(`.bx-ilike-popup-content-${this.popupCurrentReaction}`);\n\t\tif (!reactionUsersNode)\n\t\t{\n\t\t\treactionUsersNode = Dom.create('span', {\n\t\t\t\tprops: {\n\t\t\t\t\tclassName: [\n\t\t\t\t\t\t'bx-ilike-popup-content',\n\t\t\t\t\t\t`bx-ilike-popup-content-${this.popupCurrentReaction}`,\n\t\t\t\t\t].join(' '),\n\t\t\t\t}\n\t\t\t});\n\t\t\tusersNode.appendChild(reactionUsersNode);\n\t\t}\n\t\telse\n\t\t{\n\t\t\treactionUsersNode.classList.remove('bx-ilike-popup-content-invisible');\n\t\t}\n\n\t\tdata.items.forEach((item) => {\n\n\t\t\tconst userItemClassList = [ 'bx-ilike-popup-user-item' ];\n\t\t\tif (Type.isStringFilled(item.USER_TYPE))\n\t\t\t{\n\t\t\t\tuserItemClassList.push(`bx-ilike-popup-user-item-${item.USER_TYPE}`);\n\t\t\t}\n\n\t\t\treactionUsersNode.appendChild(Dom.create('a', {\n\t\t\t\tprops: {\n\t\t\t\t\tclassName: userItemClassList.join(' '),\n\t\t\t\t},\n\t\t\t\tattrs: {\n\t\t\t\t\thref: item.URL,\n\t\t\t\t\ttarget: '_blank',\n\t\t\t\t},\n\t\t\t\tchildren: [\n\t\t\t\t\tDom.create('span', {\n\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\tclassName: 'bx-ilike-popup-user-icon',\n\t\t\t\t\t\t},\n\t\t\t\t\t\tstyle: (\n\t\t\t\t\t\t\tType.isStringFilled(item.PHOTO_SRC)\n\t\t\t\t\t\t\t\t? {\n\t\t\t\t\t\t\t\t\t'background-image': `url(\"${encodeURI(item.PHOTO_SRC)}\")`,\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t: {}\n\t\t\t\t\t\t)\n\t\t\t\t\t}),\n\t\t\t\t\tDom.create('span', {\n\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\tclassName: 'bx-ilike-popup-user-name'\n\t\t\t\t\t\t},\n\t\t\t\t\t\thtml: item.FULL_NAME,\n\t\t\t\t\t}),\n\t\t\t\t\tDom.create('span', {\n\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\tclassName: 'bx-ilike-popup-user-status',\n\t\t\t\t\t\t},\n\t\t\t\t\t}),\n\t\t\t\t],\n\t\t\t}));\n\t\t});\n\n\n\t\tconst waitNode = rating.popupContent.querySelector('.bx-ilike-wait');\n\t\tif (waitNode)\n\t\t{\n\t\t\tDom.clean(waitNode);\n\t\t\tDom.remove(waitNode);\n\t\t}\n\t\tconst tabsNodeOld = rating.popupContent.querySelector('.bx-ilike-popup-head');\n\t\tif (tabsNodeOld)\n\t\t{\n\t\t\ttabsNodeOld.parentNode.insertBefore(tabsNode, tabsNodeOld);\n\t\t\ttabsNodeOld.parentNode.removeChild(tabsNodeOld);\n\t\t}\n\t\telse\n\t\t{\n\t\t\trating.popupContent.appendChild(tabsNode);\n\t\t}\n\n\t\tif (!usersNodeExists)\n\t\t{\n\t\t\trating.popupContent.appendChild(usersNode);\n\t\t}\n\t}\n\n\tstatic clearPopupContent(params)\n\t{\n\t\tconst likeId = (Type.isStringFilled(params.likeId) ? params.likeId : '');\n\n\t\tconst likeInstance = RatingLike.getInstance(likeId);\n\t\tlikeInstance.popupContent.innerHTML = '';\n\t\tdocument.getElementById(`bx-ilike-popup-cont-${likeId}`).style.height = 'auto';\n\t\tdocument.getElementById(`bx-ilike-popup-cont-${likeId}`).style.minWidth = 'auto';\n\t\tlikeInstance.popupContent.appendChild(Dom.create('span', {\n\t\t\tprops: {\n\t\t\t\tclassName: 'bx-ilike-wait',\n\t\t\t},\n\t\t}));\n\t}\n\n\tstatic changePopupTab(params)\n\t{\n\t\tconst likeId = (Type.isStringFilled(params.likeId) ? params.likeId : '');\n\t\tconst rating = params.rating;\n\t\tconst reaction = (Type.isStringFilled(params.reaction) ? params.reaction : '');\n\n\t\tconst contentContainerNode = rating.popupContent.querySelector('.bx-ilike-popup-content-container');\n\t\tif (!contentContainerNode)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst reactionUsersNode = contentContainerNode.querySelector('.bx-ilike-popup-content-' + reaction);\n\t\tif (reactionUsersNode)\n\t\t{\n\t\t\tthis.popupCurrentReaction = (Type.isStringFilled(reaction) ? reaction : 'all');\n\n\t\t\trating.popupContent.querySelectorAll('.bx-ilike-popup-head-item').forEach((tabNode) => {\n\t\t\t\ttabNode.classList.remove('bx-ilike-popup-head-item-current');\n\t\t\t\tconst reactionTabNode = tabNode.querySelector(`.feed-post-emoji-icon-${reaction}`);\n\t\t\t\tif (reactionTabNode)\n\t\t\t\t{\n\t\t\t\t\ttabNode.classList.add('bx-ilike-popup-head-item-current');\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tcontentContainerNode.querySelectorAll('.bx-ilike-popup-content').forEach((contentNode) => {\n\t\t\t\tcontentNode.classList.add('bx-ilike-popup-content-invisible');\n\t\t\t});\n\t\t\treactionUsersNode.classList.remove('bx-ilike-popup-content-invisible');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tListPopup.List(likeId, 1, reaction);\n\t\t}\n\t}\n\n\tstatic buildPopupContentNoReactions(params)\n\t{\n\t\tconst page = (Number(params.page) > 0 ? Number(params.page) : 1);\n\t\tconst likeInstance = (!Type.isUndefined(params.rating) ? params.rating : null);\n\t\tconst data = params.data;\n\n\t\tif (!likeInstance)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tif (page === 1)\n\t\t{\n\t\t\tlikeInstance.popupContent.innerHTML = '';\n\t\t\tlikeInstance.popupContent.appendChild(Dom.create('span', {\n\t\t\t\tprops: {\n\t\t\t\t\tclassName: 'bx-ilike-bottom_scroll',\n\t\t\t\t}\n\t\t\t}));\n\t\t}\n\n\t\tlikeInstance.popupContentPage += 1;\n\n\t\tdata.items.forEach((item) => {\n\t\t\tlet avatarNode = null;\n\n\t\t\tif (Type.isStringFilled(item.PHOTO_SRC))\n\t\t\t{\n\t\t\t\tavatarNode = Dom.create('img', {\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\tsrc: encodeURI(item.PHOTO_SRC),\n\t\t\t\t\t},\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tclassName: 'bx-ilike-popup-avatar-img',\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tavatarNode = Dom.create('img', {\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\tsrc: '/bitrix/images/main/blank.gif',\n\t\t\t\t\t},\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tclassName: 'bx-ilike-popup-avatar-img bx-ilike-popup-avatar-img-default',\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tconst imgClassList = [\n\t\t\t\t'bx-ilike-popup-img',\n\t\t\t];\n\t\t\tif (Type.isStringFilled(item.USER_TYPE))\n\t\t\t{\n\t\t\t\timgClassList.push(`bx-ilike-popup-img-${item.USER_TYPE}`);\n\t\t\t}\n\n\t\t\tlikeInstance.popupContent.appendChild(\n\t\t\t\tDom.create('a', {\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\thref: item.URL,\n\t\t\t\t\t\ttarget: '_blank',\n\t\t\t\t\t},\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tclassName: imgClassList.join(' '),\n\t\t\t\t\t},\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tDom.create('span', {\n\t\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\t\tclassName: 'bx-ilike-popup-avatar-new',\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tchildren: [\n\t\t\t\t\t\t\t\tavatarNode,\n\t\t\t\t\t\t\t\tDom.create('span', {\n\t\t\t\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\t\t\t\tclassName: 'bx-ilike-popup-avatar-status-icon',\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tDom.create('span', {\n\t\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\t\tclassName: 'bx-ilike-popup-name-new',\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\thtml: item.FULL_NAME,\n\t\t\t\t\t\t}),\n\t\t\t\t\t],\n\t\t\t\t})\n\t\t\t);\n\t\t});\n\t}\n\n\tstatic afterClick(params)\n\t{\n\t\tconst likeId = (Type.isStringFilled(params.likeId) ? params.likeId : '');\n\n\t\tif (!Type.isStringFilled(likeId))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.afterClickBlockShowPopup = true;\n\n\t\tthis.afterClickHandler = this.getAfterClickHandler(likeId);\n\n\t\tRatingLike.getInstance(likeId).box.addEventListener('mouseleave', this.afterClickHandler);\n\t}\n\n\tstatic getAfterClickHandler(likeId)\n\t{\n\t\treturn () => {\n\t\t\tthis.afterClickBlockShowPopup = false;\n\n\t\t\tRatingLike.getInstance(likeId).box.removeEventListener('mouseleave', this.afterClickHandler);\n\t\t};\n\t}\n\n\tstatic resultReactionClick(e)\n\t{\n\t\tconst likeId = e.currentTarget.getAttribute('data-like-id');\n\t\tlet reaction = e.currentTarget.getAttribute('data-reaction');\n\n\t\tif (!Type.isSet(reaction))\n\t\t{\n\t\t\treaction = '';\n\t\t}\n\n\t\tListPopup.onResultClick({\n\t\t\tlikeId: likeId,\n\t\t\tevent: e,\n\t\t\treaction: reaction,\n\t\t});\n\n\t\te.stopPropagation();\n\t}\n\n\tstatic resultReactionMouseEnter(e)\n\t{\n\t\tconst likeId = e.currentTarget.getAttribute('data-like-id');\n\t\tconst reaction = e.currentTarget.getAttribute('data-reaction');\n\n\t\tListPopup.onResultMouseEnter({\n\t\t\tlikeId: likeId,\n\t\t\tevent: e,\n\t\t\treaction: reaction,\n\t\t});\n\t}\n\n\tstatic resultReactionMouseLeave(e)\n\t{\n\t\tconst likeId = e.currentTarget.getAttribute('data-like-id');\n\t\tconst reaction = e.currentTarget.getAttribute('data-reaction');\n\n\t\tListPopup.onResultMouseLeave({\n\t\t\tlikeId: likeId,\n\t\t\treaction: reaction,\n\t\t});\n\t}\n\n\tstatic openMobileReactionsPage(params)\n\t{\n\t\tBXMobileApp.PageManager.loadPageBlank({\n\t\t\turl: `${Loc.getMessage('SITE_DIR')}mobile/like/result.php`,\n\t\t\ttitle: Loc.getMessage('RATING_LIKE_RESULTS'),\n\t\t\tbackdrop: {\n\t\t\t\tmediumPositionPercent: 65,\n\t\t\t},\n\t\t\tcache: true,\n\t\t\tdata: {\n\t\t\t\tentityTypeId: params.entityTypeId,\n\t\t\t\tentityId: params.entityId,\n\t\t\t}\n\t\t});\n\t}\n\n\tstatic onRatingLike(eventData)\n\t{\n\t\tRatingLike.repo.forEach((likeInstance, likeId) => {\n\t\t\tif (\n\t\t\t\tlikeInstance.entityTypeId !== eventData.entityTypeId\n\t\t\t\t&& Number(likeInstance.entityId) !== Number(eventData.entityId)\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tlet voteAction = (Type.isStringFilled(eventData.voteAction) ? eventData.voteAction.toUpperCase() : 'ADD');\n\t\t\tvoteAction = (voteAction === 'PLUS' ? 'ADD' : voteAction);\n\n\t\t\tif (\n\t\t\t\tNumber(eventData.userId) === Number(Loc.getMessage('USER_ID'))\n\t\t\t\t&& likeInstance.button\n\t\t\t)\n\t\t\t{\n\t\t\t\tif (voteAction === 'CANCEL')\n\t\t\t\t{\n\t\t\t\t\tlikeInstance.button.classList.remove('bx-you-like-button');\n\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tlikeInstance.button.classList.add('bx-you-like-button');\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tRatingLike.Draw(likeId, {\n\t\t\t\tTYPE: voteAction,\n\t\t\t\tUSER_ID: eventData.userId,\n\t\t\t\tENTITY_TYPE_ID: eventData.entityTypeId,\n\t\t\t\tENTITY_ID: eventData.entityId,\n\t\t\t\tUSER_DATA: eventData.userData,\n\t\t\t\tREACTION: eventData.voteReaction,\n\t\t\t\tREACTION_OLD: eventData.voteReactionOld,\n\t\t\t\tTOTAL_POSITIVE_VOTES: eventData.itemsAll,\n\t\t\t});\n\t\t});\n\t}\n\n\tstatic onMobileCommentsGet()\n\t{\n\t\tconst ratingEmojiSelectorPopup = document.querySelector('.feed-post-emoji-popup-container');\n\t\tif (ratingEmojiSelectorPopup)\n\t\t{\n\t\t\tratingEmojiSelectorPopup.style.top = 0;\n\t\t\tratingEmojiSelectorPopup.style.left = 0;\n\t\t\tratingEmojiSelectorPopup.classList.remove('feed-post-emoji-popup-active');\n\t\t\tratingEmojiSelectorPopup.classList.remove('feed-post-emoji-popup-active-final');\n\t\t\tratingEmojiSelectorPopup.classList.remove('feed-post-emoji-popup-active-final-item');\n\t\t\tratingEmojiSelectorPopup.classList.add('feed-post-emoji-popup-invisible-final');\n\t\t\tratingEmojiSelectorPopup.classList.add('feed-post-emoji-popup-invisible-final-mobile');\n\t\t}\n\t}\n\n\tstatic getNode(node)\n\t{\n\t\tif (Type.isDomNode(node))\n\t\t{\n\t\t\treturn node;\n\t\t}\n\t\telse if (Type.isStringFilled(node))\n\t\t{\n\t\t\treturn document.getElementById(node);\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn null;\n\t\t}\n\t}\n}\n","import { Type, Runtime } from 'main.core';\nimport { EventEmitter, BaseEvent } from 'main.core.events';\n\nimport { RatingRender } from './render';\nimport { ListPopup } from './listpopup';\n\nexport class RatingManager\n{\n\tstatic mobile = false;\n\tstatic initialized = false;\n\tstatic displayHeight = 0;\n\tstatic startScrollTop = 0;\n\tstatic entityList = [];\n\tstatic ratingNodeList = new Map();\n\tstatic delayedList = new Map();\n\n\tstatic init(params)\n\t{\n\t\tif (!Type.isPlainObject(params))\n\t\t{\n\t\t\tparams = {};\n\t\t}\n\n\t\tif (this.initialized)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.mobile = (!Type.isUndefined(params.mobile) && !!params.mobile);\n\n\t\tthis.initialized = true;\n\n\t\tthis.setDisplayHeight();\n\n\t\tif (!this.mobile)\n\t\t{\n\t\t\twindow.addEventListener('scroll', Runtime.throttle(() => {\n\t\t\t\tthis.getInViewScope();\n\t\t\t}, 80), { passive: true });\n\n\t\t\twindow.addEventListener('resize', this.setDisplayHeight.bind(this));\n\t\t}\n\n\t\tEventEmitter.subscribe('onBeforeMobileLivefeedRefresh', RatingRender.reactionsPopupMobileHide)\n\t\tEventEmitter.subscribe('BX.MobileLF:onCommentsGet', RatingRender.onMobileCommentsGet)\n\n\t\tif (this.mobile)\n\t\t{\n\t\t\t// new one\n\t\t\tBXMobileApp.addCustomEvent('onRatingLike', RatingRender.onRatingLike);\n\t\t}\n\n\t\tif (this.mobile)\n\t\t{\n\t\t\tBXMobileApp.addCustomEvent('onPull-main', (data) => {\n\t\t\t\tif (data.command == 'rating_vote')\n\t\t\t\t{\n\t\t\t\t\tRatingLike.LiveUpdate(data.params);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tEventEmitter.subscribe('onPullEvent-main', (event: BaseEvent) => {\n\t\t\t\tconst [ command, params ] = event.getCompatData();\n\n\t\t\t\tif (command === 'rating_vote')\n\t\t\t\t{\n\t\t\t\t\tRatingLike.LiveUpdate(params);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (\n\t\t\t\t!Type.isUndefined(window.BX.SidePanel)\n\t\t\t\t&& BX.SidePanel.Instance.getTopSlider()\n\t\t\t)\n\t\t\t{\n\t\t\t\tEventEmitter.subscribe(\n\t\t\t\t\tBX.SidePanel.Instance.getTopSlider().getWindow(),\n\t\t\t\t\t'SidePanel.Slider:onCloseComplete',\n\t\t\t\t\tListPopup.removeOnCloseHandler\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic setDisplayHeight()\n\t{\n\t\tthis.displayHeight = document.documentElement.clientHeight;\n\t}\n\n\tstatic getInViewScope()\n\t{\n\t\tlet ratingNode = null;\n\t\tthis.delayedList.forEach((value, key) => {\n\n\t\t\tratingNode = BX(this.getNode(key));\n\n\t\t\tif (!ratingNode)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.isNodeVisibleOnScreen(ratingNode))\n\t\t\t{\n\t\t\t\tthis.fireAnimation(key);\n\t\t\t}\n\t\t});\n\t}\n\n\tstatic addNode(entityId, node)\n\t{\n\t\tif (\n\t\t\t!Type.isDomNode(node)\n//\t\t\t|| !Type.isUndefined(this.ratingNodeList.get(entityId))\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.ratingNodeList.set(entityId, node);\n\t}\n\n\n\tstatic getNode(entityId)\n\t{\n\t\tconst node = this.ratingNodeList.get(entityId);\n\t\treturn (!Type.isUndefined(node) ? node : false);\n\t}\n\n\tstatic isNodeVisibleOnScreen(node)\n\t{\n\t\tconst coords = node.getBoundingClientRect();\n\t\tconst visibleAreaTop = Number(this.displayHeight / 10);\n\t\tconst visibleAreaBottom = Number(this.displayHeight * 9 / 10);\n\n\t\treturn (\n\t\t\t(\n\t\t\t\t(\n\t\t\t\t\tcoords.top > 0\n\t\t\t\t\t&& coords.top < visibleAreaBottom\n\t\t\t\t)\n\t\t\t\t|| (\n\t\t\t\t\tcoords.bottom > visibleAreaTop\n\t\t\t\t\t&& coords.bottom < this.displayHeight\n\t\t\t\t)\n\t\t\t)\n\t\t\t&& (\n\t\t\t\tthis.mobile\n\t\t\t\t|| !(\n\t\t\t\t\t(\n\t\t\t\t\t\tcoords.top < visibleAreaTop\n\t\t\t\t\t\t&& coords.bottom < visibleAreaTop\n\t\t\t\t)\n\t\t\t\t|| (\n\t\t\t\t\tcoords.top > visibleAreaBottom\n\t\t\t\t\t&& coords.bottom > visibleAreaBottom\n\t\t\t\t)\n\t\t\t\t)\n\t\t\t)\n\t\t);\n\t}\n\n\tstatic fireAnimation(key)\n\t{\n\t\tthis.delayedList.delete(key);\n\t}\n\n\tstatic addEntity(entityId, ratingObject)\n\t{\n\t\tif (\n\t\t\t!this.entityList.includes(entityId)\n\t\t\t&& ratingObject.topPanelContainer\n\t\t\t)\n\t\t\t{\n\t\t\t\tthis.entityList.push(entityId);\n\t\t\t\tthis.addNode(entityId, ratingObject.topPanelContainer);\n\t\t\t}\n\t}\n\n\tstatic live(params)\n\t{\n\t\tif (\n\t\t\tType.isUndefined(params.TYPE)\n\t\t\t|| params.TYPE !== 'ADD'\n\t\t\t|| !Type.isStringFilled(params.ENTITY_TYPE_ID)\n\t\t\t|| Type.isUndefined(params.ENTITY_ID)\n\t\t\t|| Number(params.ENTITY_ID) <= 0\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst key = `${params.ENTITY_TYPE_ID}_${params.ENTITY_ID}`;\n\t\tif (!this.checkEntity(key))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst ratingNode = this.getNode(key);\n\t\tif (!ratingNode)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tif (this.isNodeVisibleOnScreen(ratingNode))\n\t\t{\n\t\t\tthis.fireAnimation(key);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.addDelayed(params)\n\t\t}\n\t}\n\n\tstatic checkEntity(entityId)\n\t{\n\t\treturn this.entityList.includes(entityId);\n\t}\n\n\tstatic addDelayed(liveParams)\n\t{\n\t\tif (\n\t\t\t!Type.isStringFilled(liveParams.ENTITY_TYPE_ID)\n\t\t\t|| Type.isUndefined(liveParams.ENTITY_ID)\n\t\t\t|| Number(liveParams.ENTITY_ID) <= 0\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst key = `${liveParams.ENTITY_TYPE_ID}_${liveParams.ENTITY_ID}`;\n\n\t\tlet delayedListItem = this.delayedList.get(key);\n\t\tif (Type.isUndefined(delayedListItem))\n\t\t{\n\t\t\tdelayedListItem = [];\n\t\t}\n\n\t\tdelayedListItem.push(liveParams);\n\t\tthis.delayedList.set(key, delayedListItem);\n\t}\n}\n","import { Type, Dom, Loc, ajax } from 'main.core';\n\nimport { RatingManager } from './manager';\nimport { RatingRender } from './render';\nimport { ListPopup } from './listpopup';\n\nimport './css/reaction.css';\nimport './css/mobile.css';\n\ntype Params = {\n\tlikeId: string,\n\tkeySigned: string,\n\tentityTypeId: string,\n\tentityId: number,\n\tavailable: number,\n\tuserId?: number,\n\tlocalize?: Object,\n\ttemplate?: string,\n\tpathToUserProfile?: string,\n\tmobile?: boolean | 'true' | 'false'\n}\n\nexport class RatingLike\n{\n\tstatic repo = new Map();\n\tstatic lastVoteRepo = new Map();\n\tstatic lastReactionRepo = new Map();\n\tstatic additionalParams = new Map();\n\n\tconstructor(params: Params)\n\t{\n\t\tthis.likeId = Type.isStringFilled(params.likeId) ? params.likeId : '';\n\t\tthis.keySigned = Type.isStringFilled(params.keySigned) ? params.keySigned : '';\n\t\tthis.entityTypeId = Type.isStringFilled(params.entityTypeId) ? params.entityTypeId : '';\n\t\tthis.entityId = !Type.isUndefined(params.entityId) ? Number(params.entityId) : 0;\n\t\tthis.available = Type.isStringFilled(params.available) ? params.available === 'Y' : false;\n\t\tthis.userId = !Type.isUndefined(params.userId) ? Number(params.userId) : 0;\n\t\tthis.localize = Type.isPlainObject(params.localize) ? params.localize : {};\n\t\tthis.template = Type.isStringFilled(params.template) ? params.template : '';\n\t\tthis.pathToUserProfile = Type.isStringFilled(params.pathToUserProfile) ? params.pathToUserProfile : '';\n\n\t\tconst key = `${this.entityTypeId}_${this.entityId}`;\n\n\t\tthis.enabled = true;\n\n\t\tthis.box = document.getElementById(`bx-ilike-button-${this.likeId}`);\n\t\tif (this.box === null)\n\t\t{\n\t\t\tthis.enabled = false;\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.box.setAttribute('data-rating-vote-id', this.likeId);\n\n\t\tif (this.keySigned === '')\n\t\t{\n\t\t\tconst keySigned = this.box.getAttribute('data-vote-key-signed');\n\t\t\tthis.keySigned = keySigned ? keySigned : '';\n\t\t}\n\n\t\tthis.button = this.box.querySelector('.bx-ilike-left-wrap');\n\t\tthis.buttonText = this.button.querySelector('.bx-ilike-text');\n\t\tthis.count = this.box.querySelector('span.bx-ilike-right-wrap');\n\t\tif (!this.count)\n\t\t{\n\t\t\tthis.count = document.getElementById(`bx-ilike-count-${this.likeId}`);\n\t\t}\n\t\tthis.countText = this.count.querySelector('.bx-ilike-right');\n\n\t\tthis.topPanelContainer = document.getElementById(`feed-post-emoji-top-panel-container-${this.likeId}`);\n\t\tthis.topPanel = document.getElementById(`feed-post-emoji-top-panel-${this.likeId}`);\n\t\tthis.topUsersText = document.getElementById(`bx-ilike-top-users-${this.likeId}`);\n\t\tthis.topUsersDataNode = document.getElementById(`bx-ilike-top-users-data-${this.likeId}`);\n\t\tthis.userReactionNode = document.getElementById(`bx-ilike-user-reaction-${this.likeId}`);\n\t\tthis.reactionsNode = document.getElementById(`feed-post-emoji-icons-${this.likeId}`);\n\n\t\tthis.popup = null;\n\t\tthis.popupId = null;\n\t\tthis.popupTimeoutIdShow = null;\n\t\tthis.popupTimeoutIdList = null;\n\n\t\tthis.popupContent = document.getElementById(`bx-ilike-popup-cont-${this.likeId}`)\n\t\t\t.querySelector('span.bx-ilike-popup')\n\t\t;\n\t\tthis.popupContentPage = 1;\n\t\tthis.popupTimeout = false;\n\t\tthis.likeTimeout = false;\n\t\tthis.mouseOverHandler = null;\n\t\tthis.version = (Type.isDomNode(this.topPanel) ? 2 : 1);\n\t\tthis.mouseInShowPopupNode = {};\n\t\tthis.listXHR = null;\n\n\t\tif (\n\t\t\tthis.template === 'light'\n\t\t\t&& Type.isDomNode(this.reactionsNode)\n\t\t)\n\t\t{\n\t\t\tconst container = this.reactionsNode.querySelector('.feed-post-emoji-icon-container');\n\t\t\tif (container)\n\t\t\t{\n\t\t\t\tlet reactionsData = container.getAttribute('data-reactions-data');\n\t\t\t\ttry\n\t\t\t\t{\n\t\t\t\t\treactionsData = JSON.parse(reactionsData);\n\n\t\t\t\t\tconst elementsNew = [];\n\t\t\t\t\tObject.entries(reactionsData).forEach(([reaction, count]) => {\n\t\t\t\t\t\telementsNew.push({\n\t\t\t\t\t\t\treaction: reaction,\n\t\t\t\t\t\t\tcount: count,\n\t\t\t\t\t\t\tanimate: false,\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\n\t\t\t\t\tRatingRender.drawReactions({\n\t\t\t\t\t\tlikeId: this.likeId,\n\t\t\t\t\t\tcontainer: container,\n\t\t\t\t\t\tdata: elementsNew,\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tcatch (e)\n\t\t\t\t{\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (!Type.isUndefined(RatingLike.lastVoteRepo.get(key)))\n\t\t{\n\t\t\tthis.lastVote = RatingLike.lastVoteRepo.get(key);\n\n\t\t\tconst ratingNode = (this.template === 'standart' ? this.button : this.count);\n\t\t\tif (this.lastVote === 'plus')\n\t\t\t{\n\t\t\t\tratingNode.classList.add('bx-you-like');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tratingNode.classList.remove('bx-you-like');\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.lastVote = (\n\t\t\t\t(this.template === 'standart' ? this.button : this.count).classList.contains('bx-you-like')\n\t\t\t\t\t? 'plus'\n\t\t\t\t\t: 'cancel'\n\t\t\t);\n\t\t\tRatingLike.lastVoteRepo.set(key, this.lastVote);\n\t\t}\n\n\t\tif (!Type.isUndefined(RatingLike.lastReactionRepo.get(key)))\n\t\t{\n\t\t\tthis.lastReaction = RatingLike.lastReactionRepo.get(key);\n\t\t\tthis.count.setAttribute('data-myreaction', this.lastReaction);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst lastReaction = this.count.getAttribute('data-myreaction');\n\t\t\tthis.lastReaction = (Type.isStringFilled(lastReaction) ? lastReaction : 'like');\n\t\t\tRatingLike.lastReactionRepo.set(key, this.lastReaction);\n\t\t}\n\n\t\tif (this.topPanelContainer)\n\t\t{\n\t\t\tRatingManager.addEntity(key, this);\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tstatic setInstance(likeId: string, likeInstance)\n\t{\n\t\tthis.repo.set(likeId, likeInstance);\n\t\twindow.BXRL[likeId] = likeInstance;\n\t}\n\n\tstatic getInstance(likeId: string)\n\t{\n\t\treturn this.repo.get(likeId);\n\t}\n\n\tstatic ClickVote(e, likeId, userReaction, forceAdd)\n\t{\n\t\tif (Type.isUndefined(userReaction))\n\t\t{\n\t\t\tuserReaction = 'like';\n\t\t}\n\n\t\tconst likeInstance = this.getInstance(likeId);\n\t\tconst container = (likeInstance.template === 'standart' ? e.target : likeInstance.count);\n\n\t\tif (\n\t\t\tlikeInstance.version === 2\n\t\t\t&& likeInstance.userReactionNode\n\t\t)\n\t\t{\n\t\t\tRatingRender.hideReactionsPopup({\n\t\t\t\tlikeId: likeId,\n\t\t\t});\n\t\t\tRatingRender.blockReactionsPopup();\n\t\t\tdocument.removeEventListener('mousemove', RatingRender.reactionsPopupMouseOutHandler);\n\t\t}\n\n\t\tclearTimeout(likeInstance.likeTimeout);\n\n\t\tconst active = container.classList.contains('bx-you-like');\n\n\t\tforceAdd = !!forceAdd;\n\n\t\tlet change = false;\n\t\tlet userReactionOld = false;\n\n\t\tif (active && !forceAdd)\n\t\t{\n\t\t\tuserReaction = (\n\t\t\t\tlikeInstance.version === 2\n\t\t\t\t\t? RatingRender.getUserReaction({\n\t\t\t\t\t\tuserReactionNode: likeInstance.userReactionNode\n\t\t\t\t\t})\n\t\t\t\t\t: false\n\t\t\t);\n\n\t\t\tlikeInstance.buttonText.innerHTML = likeInstance.localize['LIKE_N'];\n\t\t\tlikeInstance.countText.innerHTML = Number(likeInstance.countText.innerHTML)-1;\n\n\t\t\tcontainer.classList.remove('bx-you-like');\n\t\t\tlikeInstance.button.classList.remove('bx-you-like-button');\n\n\t\t\tif (userReaction)\n\t\t\t{\n\t\t\t\tlikeInstance.button.classList.remove(`bx-you-like-button-${userReaction}`);\n\t\t\t}\n\n\t\t\tlikeInstance.likeTimeout = setTimeout(() => {\n\t\t\t\tif (likeInstance.lastVote != 'cancel')\n\t\t\t\t{\n\t\t\t\t\tthis.Vote(likeId, 'cancel', userReaction);\n\t\t\t\t}\n\t\t\t}, 1000);\n\t\t}\n\t\telse if (active && forceAdd)\n\t\t{\n\t\t\tchange = true;\n\t\t\tuserReactionOld = (\n\t\t\t\tlikeInstance.version === 2\n\t\t\t\t\t? RatingRender.getUserReaction({ userReactionNode: likeInstance.userReactionNode })\n\t\t\t\t\t: false\n\t\t\t);\n\n\t\t\tif (userReaction != userReactionOld)\n\t\t\t{\n\t\t\t\tif (userReactionOld)\n\t\t\t\t{\n\t\t\t\t\tlikeInstance.button.classList.remove(`bx-you-like-button-${userReactionOld}`);\n\t\t\t\t}\n\t\t\t\tlikeInstance.button.classList.add(`bx-you-like-button-${userReaction}`);\n\n\t\t\t\tlikeInstance.likeTimeout = setTimeout(() => {\n\t\t\t\t\tthis.Vote(likeId, 'change', userReaction, userReactionOld);\n\t\t\t\t}, 1000);\n\t\t\t}\n\t\t}\n\t\telse if (!active)\n\t\t{\n\t\t\tlikeInstance.buttonText.innerHTML = likeInstance.localize['LIKE_Y'];\n\t\t\tlikeInstance.countText.innerHTML = Number(likeInstance.countText.innerHTML) + 1;\n\t\t\tcontainer.classList.add('bx-you-like');\n\n\t\t\tlikeInstance.button.classList.add('bx-you-like-button');\n\t\t\tlikeInstance.button.classList.add(`bx-you-like-button-${userReaction}`);\n\n\t\t\tlikeInstance.likeTimeout = setTimeout(() => {\n\t\t\t\tif (likeInstance.lastVote !== 'plus')\n\t\t\t\t{\n\t\t\t\t\tthis.Vote(likeId, 'plus', userReaction);\n\t\t\t\t}\n\t\t\t\telse if (userReaction !== likeInstance.lastReaction) // http://jabber.bx/view.php?id=99339\n\t\t\t\t{\n\t\t\t\t\tthis.Vote(likeId, 'change', userReaction, likeInstance.lastReaction);\n\t\t\t\t}\n\t\t\t}, 1000);\n\t\t}\n\n\t\tif (likeInstance.version === 2)\n\t\t{\n\t\t\tif (change)\n\t\t\t{\n\t\t\t\tRatingRender.setReaction({\n\t\t\t\t\tlikeId: likeId,\n\t\t\t\t\trating: likeInstance,\n\t\t\t\t\taction: 'change',\n\t\t\t\t\tuserReaction: userReaction,\n\t\t\t\t\tuserReactionOld: userReactionOld,\n\t\t\t\t\ttotalCount: Number(likeInstance.countText.innerHTML),\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tRatingRender.setReaction({\n\t\t\t\t\tlikeId: likeId,\n\t\t\t\t\trating: likeInstance,\n\t\t\t\t\taction: (active ? 'cancel' : 'add'),\n\t\t\t\t\tuserReaction: userReaction,\n\t\t\t\t\ttotalCount: Number(likeInstance.countText.innerHTML),\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tif (\n\t\t\t!change\n\t\t\t&& likeInstance.version === 2\n\t\t)\n\t\t{\n\t\t\tconst dataUsers = (\n\t\t\t\tlikeInstance.topUsersDataNode\n\t\t\t\t\t? JSON.parse(likeInstance.topUsersDataNode.getAttribute('data-users'))\n\t\t\t\t\t: false\n\t\t\t);\n\n\t\t\tif (dataUsers)\n\t\t\t{\n\t\t\t\tdataUsers.TOP = Object.values(dataUsers.TOP);\n\n\t\t\t\tlikeInstance.topUsersText.innerHTML = RatingRender.getTopUsersText({\n\t\t\t\t\tyou: !active,\n\t\t\t\t\ttop: dataUsers.TOP,\n\t\t\t\t\tmore: dataUsers.MORE,\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tif (\n\t\t\tlikeInstance.template === 'light'\n\t\t\t&& !likeInstance.userReactionNode\n\t\t)\n\t\t{\n\t\t\tconst cont = likeInstance.box;\n\t\t\tconst likeNode = cont.cloneNode(true);\n\n\t\t\tlikeNode.id = 'like_anim'; // to not dublicate original id\n\n\t\t\tlet type = 'normal';\n\t\t\tif (cont.closest('.feed-com-informers-bottom'))\n\t\t\t{\n\t\t\t\ttype = 'comment';\n\t\t\t}\n\t\t\telse if (cont.closest('.feed-post-informers'))\n\t\t\t{\n\t\t\t\ttype = 'post';\n\t\t\t}\n\n\t\t\tlikeNode.classList.remove('bx-ilike-button-hover')\n\t\t\tlikeNode.classList.add('bx-like-anim')\n\n\t\t\tDom.adjust(cont.parentNode, { style: { position: 'relative' } });\n\n\t\t\tDom.adjust(likeNode, {\n\t\t\t\tstyle: {\n\t\t\t\t\tposition: 'absolute',\n\t\t\t\t\twhiteSpace: 'nowrap',\n\t\t\t\t\ttop: (type === 'post' ? '1px' : (type === 'comment' ? '0' : '')),\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tDom.adjust(cont, { style: { visibility: 'hidden' } });\n\t\t\tDom.prepend(likeNode, cont.parentNode);\n\n\t\t\tnew BX.easing({\n\t\t\t\tduration: 140,\n\t\t\t\tstart: { scale: 100 },\n\t\t\t\tfinish: { scale: (type === 'comment' ? 110 : 115) },\n\t\t\t\ttransition : BX.easing.transitions.quad,\n\t\t\t\tstep: (state) => {\n\t\t\t\t\tlikeNode.style.transform = `scale(${state.scale / 100})`;\n\t\t\t\t},\n\t\t\t\tcomplete: () => {\n\t\t\t\t\tconst likeThumbNode = Dom.create('SPAN', {\n\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\tclassName: (active ? 'bx-ilike-icon' : 'bx-ilike-icon bx-ilike-icon-orange'),\n\t\t\t\t\t\t},\n\t\t\t\t\t});\n\n\t\t\t\t\tDom.adjust(likeThumbNode, {\n\t\t\t\t\t\tstyle: {\n\t\t\t\t\t\t\tposition: 'absolute',\n\t\t\t\t\t\t\twhiteSpace: 'nowrap',\n\t\t\t\t\t\t},\n\t\t\t\t\t});\n\n\t\t\t\t\tDom.prepend(likeThumbNode, cont.parentNode);\n\n\t\t\t\t\tnew BX.easing({\n\t\t\t\t\t\tduration: 140,\n\t\t\t\t\t\tstart: { scale: (type == 'comment' ? 110 : 115) },\n\t\t\t\t\t\tfinish: { scale: 100 },\n\t\t\t\t\t\ttransition : BX.easing.transitions.quad,\n\t\t\t\t\t\tstep: (state) => {\n\t\t\t\t\t\t\tlikeNode.style.transform = `scale(${state.scale / 100})`;\n\t\t\t\t\t\t},\n\t\t\t\t\t\tcomplete: () => {}\n\t\t\t\t\t}).animate();\n\n\t\t\t\t\tconst propsStart = {\n\t\t\t\t\t\topacity: 100,\n\t\t\t\t\t\tscale: (type === 'comment' ? 110 : 115),\n\t\t\t\t\t\ttop: 0,\n\t\t\t\t\t};\n\t\t\t\t\tconst propsFinish = {\n\t\t\t\t\t\topacity: 0,\n\t\t\t\t\t\tscale: 200,\n\t\t\t\t\t\ttop: (type === 'comment' ? -3 : -2),\n\t\t\t\t\t};\n\n\t\t\t\t\tif (type !== 'comment')\n\t\t\t\t\t{\n\t\t\t\t\t\tpropsStart.left = -5;\n\t\t\t\t\t\tpropsFinish.left = -13;\n\t\t\t\t\t}\n\n\t\t\t\t\tnew BX.easing({\n\t\t\t\t\t\tduration: 200,\n\t\t\t\t\t\tstart: propsStart,\n\t\t\t\t\t\tfinish: propsFinish,\n\t\t\t\t\t\ttransition : BX.easing.transitions.linear,\n\t\t\t\t\t\tstep: (state) => {\n\t\t\t\t\t\t\tlikeThumbNode.style.transform = `scale(${state.scale / 100})`;\n\t\t\t\t\t\t\tlikeThumbNode.style.opacity = state.opacity / 100;\n\t\t\t\t\t\t\tif (type !== 'comment')\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tlikeThumbNode.style.left = `${state.left}px`;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tlikeThumbNode.style.top = `${state.top}px`;\n\t\t\t\t\t\t},\n\t\t\t\t\t\tcomplete: () => {\n\t\t\t\t\t\t\tlikeNode.parentNode.removeChild(likeNode);\n\t\t\t\t\t\t\tlikeThumbNode.parentNode.removeChild(likeThumbNode);\n\n\t\t\t\t\t\t\tDom.adjust(cont.parentNode, { style: { position: 'static' } });\n\t\t\t\t\t\t\tDom.adjust(cont, { style: { visibility: 'visible' } });\n\t\t\t\t\t\t}\n\t\t\t\t\t}).animate();\n\n\t\t\t\t}\n\t\t\t}).animate();\n\t\t}\n\n\t\tlikeInstance.box.classList.remove('bx-ilike-button-hover');\n\t}\n\n\tstatic Draw(likeId, params)\n\t{\n\t\tconst likeInstance = this.getInstance(likeId);\n\t\tlikeInstance.countText.innerHTML = Number(params.TOTAL_POSITIVE_VOTES);\n\n\t\tif (\n\t\t\t!Type.isUndefined(params.TYPE)\n\t\t\t&& !Type.isUndefined(params.USER_ID)\n\t\t\t&& Number(params.USER_ID) > 0\n\t\t\t&& !Type.isUndefined(params.USER_DATA)\n\t\t\t&& !Type.isUndefined(params.USER_DATA.WEIGHT)\n\t\t)\n\t\t{\n\t\t\tconst userWeight = parseFloat(params.USER_DATA.WEIGHT);\n\n\t\t\tconst usersData = (\n\t\t\t\tlikeInstance.topUsersDataNode\n\t\t\t\t\t? JSON.parse(likeInstance.topUsersDataNode.getAttribute('data-users'))\n\t\t\t\t\t: false\n\t\t\t);\n\n\t\t\tif (\n\t\t\t\tparams.TYPE != 'CHANGE'\n\t\t\t\t&& Type.isPlainObject(usersData)\n\t\t\t)\n\t\t\t{\n\t\t\t\tusersData.TOP = Object.values(usersData.TOP);\n\t\t\t\tlet recalcNeeded = (usersData.TOP.length < 2);\n\n\t\t\t\tObject.values(usersData.TOP).forEach((item) => {\n\t\t\t\t\tif (recalcNeeded)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (\n\t\t\t\t\t\t(\n\t\t\t\t\t\t\tparams.TYPE === 'ADD'\n\t\t\t\t\t\t\t&& userWeight > item.WEIGHT\n\t\t\t\t\t\t)\n\t\t\t\t\t\t|| (\n\t\t\t\t\t\t\tparams.TYPE === 'CANCEL'\n\t\t\t\t\t\t\t&& params.USER_ID === item.ID\n\t\t\t\t\t\t)\n\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\trecalcNeeded = true;\n\t\t\t\t\t}\n\t\t\t\t});\n\n\n\t\t\t\tif (recalcNeeded)\n\t\t\t\t{\n\t\t\t\t\tif (\n\t\t\t\t\t\tparams.TYPE === 'ADD'\n\t\t\t\t\t\t&& Number(params.USER_ID) !== Number(Loc.getMessage('USER_ID'))\n\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (!usersData.TOP.find((a) => {\n\t\t\t\t\t\t\treturn Number(a.ID) === Number(params.USER_ID)\n\t\t\t\t\t\t}))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tusersData.TOP.push({\n\t\t\t\t\t\t\t\tID: Number(params.USER_ID),\n\t\t\t\t\t\t\t\tNAME_FORMATTED: params.USER_DATA.NAME_FORMATTED,\n\t\t\t\t\t\t\t\tWEIGHT: parseFloat(params.USER_DATA.WEIGHT),\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse if (params.TYPE === 'CANCEL')\n\t\t\t\t\t{\n\t\t\t\t\t\tusersData.TOP = usersData.TOP.filter((a) => {\n\t\t\t\t\t\t\treturn Number(a.ID) !== Number(params.USER_ID);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t\tusersData.TOP.sort((a, b) => {\n\t\t\t\t\t\tif (parseFloat(a.WEIGHT) === parseFloat(b.WEIGHT))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn 0;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn (parseFloat(a.WEIGHT) > parseFloat(b.WEIGHT)) ? -1 : 1;\n\t\t\t\t\t});\n\n\t\t\t\t\tif (\n\t\t\t\t\t\tusersData.TOP.length > 2\n\t\t\t\t\t\t&& params.TYPE === 'ADD'\n\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\tusersData.TOP.pop();\n\t\t\t\t\t\tusersData.MORE++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tif (params.TYPE === 'ADD')\n\t\t\t\t\t{\n\t\t\t\t\t\tusersData.MORE = (\n\t\t\t\t\t\t\t!Type.isUndefined(usersData.MORE)\n\t\t\t\t\t\t\t\t? Number(usersData.MORE) + 1\n\t\t\t\t\t\t\t\t: 1\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t\telse if (params.TYPE === 'CANCEL')\n\t\t\t\t\t{\n\t\t\t\t\t\tusersData.MORE = (\n\t\t\t\t\t\t\t!Type.isUndefined(usersData.MORE)\n\t\t\t\t\t\t\t&& Number(usersData.MORE) > 0\n\t\t\t\t\t\t\t\t? Number(usersData.MORE) - 1\n\t\t\t\t\t\t\t\t: 0\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tlikeInstance.topUsersDataNode.setAttribute('data-users', JSON.stringify(usersData));\n\n\t\t\t\tif (likeInstance.topUsersText)\n\t\t\t\t{\n\t\t\t\t\tlikeInstance.topUsersText.innerHTML = RatingRender.getTopUsersText({\n\t\t\t\t\t\tyou: (\n\t\t\t\t\t\t\tNumber(params.USER_ID) === Number(Loc.getMessage('USER_ID'))\n\t\t\t\t\t\t\t\t? params.TYPE !== 'CANCEL'\n\t\t\t\t\t\t\t\t: likeInstance.count.classList.contains('bx-you-like')\n\t\t\t\t\t\t),\n\t\t\t\t\t\ttop: usersData.TOP,\n\t\t\t\t\t\tmore: usersData.MORE,\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\tType.isStringFilled(params.REACTION)\n\t\t\t\t&& Type.isStringFilled(params.REACTION_OLD)\n\t\t\t\t&& params.TYPE === 'CHANGE'\n\t\t\t)\n\t\t\t{\n\t\t\t\tRatingRender.setReaction({\n\t\t\t\t\tlikeId: likeId,\n\t\t\t\t\trating: likeInstance,\n\t\t\t\t\taction: 'change',\n\t\t\t\t\tuserReaction: params.REACTION,\n\t\t\t\t\tuserReactionOld: params.REACTION_OLD,\n\t\t\t\t\ttotalCount: params.TOTAL_POSITIVE_VOTES,\n\t\t\t\t\tuserId: params.USER_ID,\n\t\t\t\t});\n\t\t\t}\n\t\t\telse if (\n\t\t\t\tType.isStringFilled(params.REACTION)\n\t\t\t\t&& [ 'ADD', 'CANCEL' ].includes(params.TYPE)\n\t\t\t)\n\t\t\t{\n\t\t\t\tRatingRender.setReaction({\n\t\t\t\t\tlikeId: likeId,\n\t\t\t\t\trating: likeInstance,\n\t\t\t\t\tuserReaction: params.REACTION,\n\t\t\t\t\taction: (params.TYPE === 'ADD' ? 'add' : 'cancel'),\n\t\t\t\t\ttotalCount: params.TOTAL_POSITIVE_VOTES,\n\t\t\t\t\tuserId: params.USER_ID,\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tif (likeInstance.topPanel)\n\t\t{\n\t\t\tlikeInstance.topPanel.setAttribute('data-popup', 'N');\n\t\t}\n\n\t\tif (!likeInstance.userReactionNode)\n\t\t{\n\t\t\tlikeInstance.count.insertBefore(\n\t\t\t\tDom.create('span', {\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tclassName: 'bx-ilike-plus-one',\n\t\t\t\t\t},\n\t\t\t\t\tstyle: {\n\t\t\t\t\t\twidth: `${(element.countText.clientWidth - 8)}px`,\n\t\t\t\t\t\theight: `${(element.countText.clientHeight - 8)}px`,\n\t\t\t\t\t},\n\t\t\t\t\thtml: (params.TYPE === 'ADD'? '+1': '-1'),\n\t\t\t\t}),\n\t\t\t\telement.count.firstChild\n\t\t\t);\n\t\t}\n\n\t\tif (likeInstance.popup)\n\t\t{\n\t\t\tlikeInstance.popup.close();\n\t\t\tlikeInstance.popupContentPage = 1;\n\t\t}\n\t}\n\n\tstatic Vote(likeId, voteAction, voteReaction, voteReactionOld)\n\t{\n\t\tif (!Type.isStringFilled(voteReaction))\n\t\t{\n\t\t\tvoteReaction = 'like';\n\t\t}\n\n\t\tconst ajaxInstance = (RatingManager.mobile ? new MobileAjaxWrapper : ajax);\n\t\tconst likeInstance = this.getInstance(likeId);\n\n\t\tconst successCallback = (response) => {\n\n\t\t\tconst data = response.data;\n\n\t\t\tlikeInstance.lastVote = data.action;\n\t\t\tlikeInstance.lastReaction = voteReaction;\n\n\t\t\tconst key = `${likeInstance.entityTypeId}_${likeInstance.entityId}`;\n\n\t\t\tthis.lastVoteRepo.set(key, data.action);\n\t\t\tthis.lastReactionRepo.set(key, data.voteReaction);\n\n\t\t\tlikeInstance.countText.innerHTML = data.items_all;\n\t\t\tlikeInstance.popupContentPage = 1;\n\t\t\tlikeInstance.popupContent.innerHTML = '';\n\t\t\tlikeInstance.popupContent.appendChild(Dom.create('span', {\n\t\t\t\tprops: {\n\t\t\t\t\tclassName: 'bx-ilike-wait',\n\t\t\t\t},\n\t\t\t}));\n\n\t\t\tif (likeInstance.topPanel)\n\t\t\t{\n\t\t\t\tlikeInstance.topPanel.setAttribute('data-popup', 'N');\n\t\t\t}\n\n\t\t\tListPopup.AdjustWindow(likeId);\n\n\t\t\tconst popup = document.getElementById(`ilike-popup-${likeId}`)\n\t\t\tif (\n\t\t\t\tpopup\n\t\t\t\t&& popup.style.display === 'block'\n\t\t\t)\n\t\t\t{\n\t\t\t\tListPopup.List(likeId, null, '', true);\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\tlikeInstance.version >= 2\n\t\t\t\t&& RatingManager.mobile\n\t\t\t)\n\t\t\t{\n\t\t\t\tBXMobileApp.onCustomEvent('onRatingLike', {\n\t\t\t\t\taction: data.action,\n\t\t\t\t\tratingId: likeId,\n\t\t\t\t\tentityTypeId : likeInstance.entityTypeId,\n\t\t\t\t\tentityId: likeInstance.entityId,\n\t\t\t\t\tvoteAction: voteAction,\n\t\t\t\t\tvoteReaction: voteReaction,\n\t\t\t\t\tvoteReactionOld: voteReactionOld,\n\t\t\t\t\tuserId: Loc.getMessage('USER_ID'),\n\t\t\t\t\tuserData: (!Type.isUndefined(data.user_data) ? data.user_data : null),\n\t\t\t\t\titemsAll: data.items_all,\n\t\t\t\t}, true);\n\t\t\t}\n\t\t};\n\n\t\tconst failureCallback = () => {\n\n\t\t\tconst dataUsers = ((likeInstance.topUsersDataNode)\n\t\t\t\t? JSON.parse(likeInstance.topUsersDataNode.getAttribute('data-users'))\n\t\t\t\t: false\n\t\t\t);\n\n\t\t\tif (likeInstance.version == 2)\n\t\t\t{\n\t\t\t\tif (voteAction === 'change')\n\t\t\t\t{\n\t\t\t\t\tRatingRender.setReaction({\n\t\t\t\t\t\tlikeId: likeId,\n\t\t\t\t\t\trating: likeInstance,\n\t\t\t\t\t\taction: voteAction,\n\t\t\t\t\t\tuserReaction: voteReaction,\n\t\t\t\t\t\tuserReactionOld: voteReactionOld,\n\t\t\t\t\t\ttotalCount: Number(likeInstance.countText.innerHTML),\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tRatingRender.setReaction({\n\t\t\t\t\t\tlikeId: likeId,\n\t\t\t\t\t\trating: likeInstance,\n\t\t\t\t\t\taction: (voteAction === 'cancel' ? 'add' : 'cancel'),\n\t\t\t\t\t\tuserReaction: voteReaction,\n\t\t\t\t\t\ttotalCount: (\n\t\t\t\t\t\t\tvoteAction == 'cancel'\n\t\t\t\t\t\t\t\t? Number(likeInstance.countText.innerHTML) + 1\n\t\t\t\t\t\t\t\t: Number(likeInstance.countText.innerHTML) - 1\n\t\t\t\t\t\t)\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tif (likeInstance.buttonText)\n\t\t\t\t{\n\t\t\t\t\tif (voteAction === 'add')\n\t\t\t\t\t{\n\t\t\t\t\t\tlikeInstance.buttonText.innerHTML = Loc.getMessage('RATING_LIKE_EMOTION_LIKE_CALC');\n\t\t\t\t\t}\n\t\t\t\t\telse if (voteAction === 'change')\n\t\t\t\t\t{\n\t\t\t\t\t\tlikeInstance.buttonText.innerHTML = Loc.getMessage(`RATING_LIKE_EMOTION_${voteReactionOld.toUpperCase()}_CALC`);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tlikeInstance.buttonText.innerHTML = Loc.getMessage(`RATING_LIKE_EMOTION_${voteReaction.toUpperCase()}_CALC`);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\tdataUsers\n\t\t\t\t&& voteAction !== 'change'\n\t\t\t\t&& likeInstance.version == 2\n\t\t\t)\n\t\t\t{\n\t\t\t\tlikeInstance.topUsersText.innerHTML = RatingRender.getTopUsersText({\n\t\t\t\t\tyou: (voteAction === 'cancel'), // negative\n\t\t\t\t\ttop: Object.values(dataUsers.TOP),\n\t\t\t\t\tmore: dataUsers.MORE\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\n\t\tconst analyticsLabel ={\n\t\t\tb24statAction: 'addLike',\n\t\t}\n\n\t\tif (\n\t\t\tlikeInstance.version >= 2\n\t\t\t&& RatingManager.mobile\n\t\t)\n\t\t{\n\t\t\tanalyticsLabel.b24statContext = 'mobile';\n\t\t}\n\n\t\tajaxInstance.runAction('main.rating.vote', {\n\t\t\tdata: {\n\t\t\t\tparams: {\n\t\t\t\t\tRATING_VOTE_TYPE_ID: likeInstance.entityTypeId,\n\t\t\t\t\tRATING_VOTE_KEY_SIGNED: likeInstance.keySigned,\n\t\t\t\t\tRATING_VOTE_ENTITY_ID: likeInstance.entityId,\n\t\t\t\t\tRATING_VOTE_ACTION: voteAction,\n\t\t\t\t\tRATING_VOTE_REACTION: voteReaction,\n\t\t\t\t},\n\t\t\t},\n\t\t\tanalyticsLabel: analyticsLabel,\n\t\t}).then(\n\t\t\tsuccessCallback,\n\t\t\tfailureCallback\n\t\t);\n\n\t\treturn false;\n\t}\n\n\tstatic LiveUpdate(params)\n\t{\n\t\tif (Number(params.USER_ID) === Number(Loc.getMessage('USER_ID')))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.repo.forEach((likeInstance, likeId) => {\n\t\t\tif (\n\t\t\t\tlikeInstance.entityTypeId !== params.ENTITY_TYPE_ID\n\t\t\t\t|| Number(likeInstance.entityId) !== Number(params.ENTITY_ID)\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.Draw(likeId, params);\n\t\t});\n\n\n\t\tRatingManager.live(params);\n\t}\n\n\tstatic Set(params: Params)\n\t{\n\t\tconst mobile = !!params.mobile;\n\n\t\tif (params.template === undefined)\n\t\t{\n\t\t\tparams.template = 'standart';\n\t\t}\n\n\t\tif (this.additionalParams.get('pathToUserProfile'))\n\t\t{\n\t\t\tparams.pathToUserProfile = this.additionalParams.get('pathToUserProfile');\n\t\t}\n\n\t\tlet likeInstance = this.getInstance(params.likeId);\n\n\t\tif (likeInstance && likeInstance.tryToSet > 5)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst tryToSend = likeInstance && likeInstance.tryToSet ? likeInstance.tryToSet : 1;\n\n\t\tlikeInstance = new RatingLike(params);\n\t\tthis.setInstance(\n\t\t\tparams.likeId,\n\t\t\tlikeInstance\n\t\t);\n\n\t\tif (likeInstance.enabled)\n\t\t{\n\t\t\tthis.Init(\n\t\t\t\tparams.likeId,\n\t\t\t\t{\n\t\t\t\t\tmobile: mobile,\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tsetTimeout(() => {\n\t\t\t\tlikeInstance.tryToSet = tryToSend + 1;\n\t\t\t\tthis.Set(params);\n\t\t\t}, 500);\n\t\t}\n\t}\n\n\tstatic setParams(params)\n\t{\n\t\tif (!Type.isUndefined(params.pathToUserProfile))\n\t\t{\n\t\t\tthis.additionalParams.set('pathToUserProfile', params.pathToUserProfile);\n\t\t}\n\t}\n\n\tstatic Init(likeId, params)\n\t{\n\t\tparams = (!Type.isUndefined(params) ? params : {});\n\n\t\tRatingManager.init(params);\n\n\t\tconst likeInstance = this.getInstance(likeId);\n\n\t\t// like/unlike button\n\t\tif (likeInstance.available)\n\t\t{\n\t\t\tlet eventNode = (\n\t\t\t\tlikeInstance.template === 'standart'\n\t\t\t\t\t? likeInstance.button\n\t\t\t\t\t: likeInstance.buttonText\n\t\t\t);\n\n\t\t\tif (!RatingManager.mobile)\n\t\t\t{\n\t\t\t\tconst eventNodeNew = eventNode.closest('.feed-new-like');\n\t\t\t\tif (eventNodeNew)\n\t\t\t\t{\n\t\t\t\t\teventNode = eventNodeNew;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\tlikeInstance.version >= 2\n\t\t\t\t&& RatingManager.mobile\n\t\t\t)\n\t\t\t{\n\t\t\t\teventNode.removeEventListener('touchstart', this.mobileTouchStartHandler);\n\t\t\t\teventNode.addEventListener('touchstart', this.mobileTouchStartHandler);\n\t\t\t}\n\n\t\t\tconst eventName = (RatingManager.mobile ? 'touchend' : 'click');\n\t\t\teventNode.removeEventListener(eventName, this.buttonClickHandler);\n\t\t\teventNode.addEventListener(eventName, this.buttonClickHandler);\n\n\t\t\tif (!RatingManager.mobile)\n\t\t\t{\n\t\t\t\t// Hover/unHover like-button\n\t\t\t\tlikeInstance.box.addEventListener('mouseover', () => {\n\t\t\t\t\tlikeInstance.box.classList.add('bx-ilike-button-hover');\n\t\t\t\t});\n\t\t\t\tlikeInstance.box.addEventListener('mouseout', () => {\n\t\t\t\t\tlikeInstance.box.classList.remove('bx-ilike-button-hover');\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tlikeInstance.topPanel.removeEventListener('click', this.mobileTopPanelClickHandler);\n\t\t\t\tlikeInstance.topPanel.addEventListener('click', this.mobileTopPanelClickHandler);\n\t\t\t}\n\t\t}\n\t\telse if (Type.isDomNode(likeInstance.buttonText))\n\t\t{\n\t\t\tlikeInstance.buttonText.innerHTML = likeInstance.localize['LIKE_D'];\n\t\t\tlikeInstance.buttonText.classList.add('bx-ilike-text-unavailable');\n\t\t}\n\t\t// get like-user-list\n\t\tconst clickShowPopupNode = (likeInstance.topUsersText ? likeInstance.topUsersText : likeInstance.count);\n\n\t\tif (!RatingManager.mobile)\n\t\t{\n\t\t\tclickShowPopupNode.addEventListener('mouseenter', (e) => {\n\t\t\t\tListPopup.onResultMouseEnter({\n\t\t\t\t\tlikeId: likeId,\n\t\t\t\t\tevent: e,\n\t\t\t\t\tnodeId: e.currentTarget.id,\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tclickShowPopupNode.addEventListener('mouseleave', (e) => {\n\t\t\t\tListPopup.onResultMouseLeave({\n\t\t\t\t\tlikeId: likeId,\n\t\t\t\t});\n\t\t\t})\n\n\t\t\tclickShowPopupNode.addEventListener('click', (e) => {\n\t\t\t\tListPopup.onResultClick({\n\t\t\t\t\tlikeId: likeId,\n\t\t\t\t\tevent: e,\n\t\t\t\t\tnodeId: e.currentTarget.id,\n\t\t\t\t});\n\t\t\t})\n\t\t}\n\n\t\tif (\n\t\t\tlikeInstance.version === 2\n\t\t\t&& likeInstance.available\n\t\t\t&& likeInstance.userReactionNode\n\t\t)\n\t\t{\n\t\t\tRatingRender.bindReactionsPopup({\n\t\t\t\tlikeId: likeId,\n\t\t\t});\n\t\t}\n\t}\n\n\tstatic mobileTouchStartHandler()\n\t{\n\t\tRatingManager.startScrollTop = (\n\t\t\t(\n\t\t\t\tdocument.documentElement\n\t\t\t\t&& document.documentElement.scrollTop\n\t\t\t)\n\t\t\t|| document.body.scrollTop\n\t\t);\n\t}\n\n\tstatic buttonClickHandler(e)\n\t{\n\t\tconst likeInstanceNode = e.currentTarget.closest('[data-rating-vote-id]');\n\t\tif (!Type.isDomNode(likeInstanceNode))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst likeId = likeInstanceNode.getAttribute('data-rating-vote-id');\n\t\tif (!Type.isStringFilled(likeId))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst likeInstance = RatingLike.getInstance(likeId);\n\n\t\tif (\n\t\t\tlikeInstance.version >= 2\n\t\t\t&& RatingManager.mobile\n\t\t\t&& RatingRender.blockTouchEndByScroll\n\t\t)\n\t\t{\n\t\t\tRatingRender.blockTouchEndByScroll = false;\n\t\t\treturn;\n\t\t}\n\n\t\tif (\n\t\t\tlikeInstance.version < 2\n\t\t\t|| !RatingManager.mobile\n\t\t\t|| !RatingRender.reactionsPopupLikeId\n\t\t)\n\t\t{\n\t\t\tif (\n\t\t\t\tlikeInstance.version >= 2\n\t\t\t\t&& RatingManager.mobile\n\t\t\t)\n\t\t\t{\n\t\t\t\tconst currentScrollTop = (\n\t\t\t\t\t(\n\t\t\t\t\t\tdocument.documentElement\n\t\t\t\t\t\t&& document.documentElement.scrollTop\n\t\t\t\t\t)\n\t\t\t\t\t|| document.body.scrollTop\n\t\t\t\t);\n\n\t\t\t\tif (Math.abs(currentScrollTop - RatingManager.startScrollTop) > 2)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tRatingLike.ClickVote(e, likeId);\n\t\t}\n\n\t\tif (likeInstance.version == 2)\n\t\t{\n\t\t\tRatingRender.afterClick({\n\t\t\t\tlikeId: likeId,\n\t\t\t});\n\t\t}\n\n\t\te.preventDefault();\n\t}\n\n\tstatic mobileTopPanelClickHandler(e)\n\t{\n\t\tconst likeInstanceNode = e.currentTarget.querySelector('[data-like-id]');\n\t\tif (!Type.isDomNode(likeInstanceNode))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst likeId = likeInstanceNode.getAttribute('data-like-id');\n\t\tif (!Type.isStringFilled(likeId))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst likeInstance = RatingLike.getInstance(likeId);\n\n\t\tRatingRender.openMobileReactionsPage({\n\t\t\tentityTypeId: likeInstance.entityTypeId,\n\t\t\tentityId: likeInstance.entityId,\n\t\t});\n\t\te.stopPropagation();\n\t}\n}\n","import { Type } from 'main.core';\n\nimport { RatingLike } from './like.js';\nimport { RatingManager } from './manager.js';\nimport { RatingRender } from './render.js';\n\nimport likeAnimatedEmojiData from '../animations/em_01.json';\nimport laughAnimatedEmojiData from '../animations/em_02.json';\nimport wonderAnimatedEmojiData from '../animations/em_03.json';\nimport cryAnimatedEmojiData from '../animations/em_04.json';\nimport angryAnimatedEmojiData from '../animations/em_05.json';\nimport facepalmAnimatedEmojiData from '../animations/em_06.json';\nimport admireAnimatedEmojiData from '../animations/em_07.json';\n\nexport const lottieAnimations = Object.freeze({\n\tlike: likeAnimatedEmojiData,\n\tlaugh: laughAnimatedEmojiData,\n\twonder: wonderAnimatedEmojiData,\n\tcry: cryAnimatedEmojiData,\n\tangry: angryAnimatedEmojiData,\n\tfacepalm: facepalmAnimatedEmojiData,\n\tadmire: admireAnimatedEmojiData,\n});\n\n\nif (Type.isUndefined(window.BXRL))\n{\n\twindow.BXRL = {};\n}\nwindow.BXRL.manager = RatingManager;\nwindow.BXRL.render = RatingRender;\n\nwindow.RatingLike = RatingLike;\n"],"names":["ListPopup","params","likeId","likeInstance","RatingLike","getInstance","target","reaction","nodeId","popupLikeId","popupContentPage","List","popupTimeoutIdShow","setTimeout","getListPopupShow","resultPopupAnimation","getListPopupAnimation","mouseInShowPopupNode","OpenWindow","clickEvent","targetId","Number","countText","innerHTML","bindNode","template","count","version","Type","isDomNode","isStringFilled","document","getElementById","box","popup","globalZIndex","getGlobalIndex","popupClassNameList","topPanel","push","RatingManager","mobile","Popup","id","bindElement","lightShadow","offsetTop","offsetLeft","isUndefined","isNull","offsetX","autoHide","closeByEsc","zIndexAbsolute","bindOptions","position","animation","events","onPopupClose","onPopupDestroy","content","className","join","setAngle","addEventListener","clearTimeout","popupTimeout","close","setBindElement","popupLikeInstance","show","AdjustWindow","element","index","propertyValue","Dom","style","isNaN","parseInt","offsetParent","tagName","EventEmitter","unsubscribe","BX","SidePanel","Instance","getTopSlider","getWindow","removeOnCloseHandler","forceBindPosition","adjustPosition","contentContainerNodeList","popupContent","querySelectorAll","length","forEach","contentContainerNode","e","scrollTop","scrollHeight","offsetHeight","RatingRender","popupCurrentReaction","Event","unbindAll","page","clear","popupPagesList","clearPopupContent","listXHR","abort","ajax","runAction","data","RATING_VOTE_TYPE_ID","entityTypeId","RATING_VOTE_KEY_SIGNED","keySigned","RATING_VOTE_ENTITY_ID","entityId","RATING_VOTE_LIST_PAGE","RATING_VOTE_REACTION","PATH_TO_USER_PROFILE","pathToUserProfile","onrequeststart","xhr","then","result","onListSuccess","items_all","items_page","list_page","buildPopupContent","rating","setAttribute","buildPopupContentNoReactions","PopupScroll","event","isShown","popupTimeoutIdList","getAttribute","currentTarget","mouseEnterEvent","getListPopup","removeOnClose","bind","currentUserId","Loc","getMessage","you","topList","top","isArray","more","ID","NAME_FORMATTED","WEIGHT","replace","sort","a","b","parseFloat","userNameList","map","item","userNameBegin","userNameEnd","pop","slice","i","userReactionNode","action","includes","userReaction","userReactionOld","totalCount","userId","getNode","reactionsNode","topPanelContainer","topUsersText","buttonText","elements","elementsNew","classList","add","contains","remove","reactionsContainer","querySelector","found","newValue","reactionValue","reactionCount","animate","type","clean","commentNode","closest","drawReactions","container","toUpperCase","parentElement","toLowerCase","reactionEvents","click","resultReactionClick","mouseenter","resultReactionMouseEnter","mouseleave","resultReactionMouseLeave","reactionsData","emojiContainer","create","props","attrs","title","Lottie","loadAnimation","animationData","reactionsAnimationData","loop","autoplay","renderer","rendererSettings","viewBoxOnly","Boolean","play","appendChild","JSON","stringify","reactionsPopupLikeId","reactionsPopup","reactionsNodesList","reactionsList","currentEmotion","emojiItem","children","reactionNode","ClickVote","preventDefault","append","body","reactionsPopupMouseOutHandler","getReactionsPopupMouseOutHandler","bindElementPosition","pos","left","inverted","GetWindowSize","deltaY","touchMoveDeltaY","adjust","width","borderRadius","reactionsPopupMobileDisableScroll","reactionsPopupAnimation","easing","duration","start","opacity","finish","transition","makeEaseInOut","transitions","cubic","step","state","stop","reactionsPopupOpacityState","complete","isFunction","onComplete","reactions","reactionsPopupAnimation2","touchScrollTop","hasMobileTouchMoved","window","reactionsPopupMobileTouchEndHandler","reactionsPopupMobileTouchMoveHandler","coords","x","changedTouches","pageX","y","pageY","reactionsPopupMobileGetHoverNode","reactionsPopupMobileHideHandler","removeEventListener","touchStartPosition","touches","touchCurrentPosition","reactionsPopupMobileCheckTouchMove","currentReactionNodeHover","reactionsPopupMobileRemoveHover","reactionsPopupMobileAddHover","blockShowPopupTimeout","blockShowPopup","reactionsPopupMobileEnableScroll","reactionsPopupAnimation4","linear","bindReactionsPopup","Math","abs","hideReactionsPopup","nodeAboveFinger","elementFromPoint","nodeBelowFinger","iconNodeAboveFinger","iconNodeBelowFinger","touchMoveScrollListener","passive","emit","mobileOverlay","app","exec","mouseOverHandler","Runtime","debounce","getMouseOverHandler","blockReactionsPopup","popupPosition","getBoundingClientRect","clientX","right","clientY","bottom","afterClickBlockShowPopup","showReactionsPopup","requestReaction","reactionsCount","popupSizeInitialized","height","minWidth","isPlainObject","Object","entries","tabsNode","headClassList","html","changePopupTab","sample","like","kiss","laugh","wonder","cry","angry","facepalm","reactionData","headItemClassList","popupContentPosition","usersNode","usersNodeExists","contentNode","reactionUsersNode","items","userItemClassList","USER_TYPE","href","URL","PHOTO_SRC","encodeURI","FULL_NAME","waitNode","tabsNodeOld","parentNode","insertBefore","removeChild","tabNode","reactionTabNode","avatarNode","src","imgClassList","afterClickHandler","getAfterClickHandler","isSet","onResultClick","stopPropagation","onResultMouseEnter","onResultMouseLeave","BXMobileApp","PageManager","loadPageBlank","url","backdrop","mediumPositionPercent","cache","eventData","repo","voteAction","button","Draw","TYPE","USER_ID","ENTITY_TYPE_ID","ENTITY_ID","USER_DATA","userData","REACTION","voteReaction","REACTION_OLD","voteReactionOld","TOTAL_POSITIVE_VOTES","itemsAll","ratingEmojiSelectorPopup","node","likeAnimatedEmojiData","kissAnimatedEmojiData","laughAnimatedEmojiData","wonderAnimatedEmojiData","cryAnimatedEmojiData","angryAnimatedEmojiData","facepalmAnimatedEmojiData","reactionsPopupMobileTouchEnd","reactionsPopupMobileTouchMove","reactionsPopupMobileHide","initialized","setDisplayHeight","throttle","getInViewScope","subscribe","onMobileCommentsGet","addCustomEvent","onRatingLike","command","LiveUpdate","getCompatData","displayHeight","documentElement","clientHeight","ratingNode","delayedList","value","key","isNodeVisibleOnScreen","fireAnimation","ratingNodeList","set","get","visibleAreaTop","visibleAreaBottom","ratingObject","entityList","addNode","checkEntity","addDelayed","liveParams","delayedListItem","Map","available","localize","enabled","topUsersDataNode","popupId","likeTimeout","parse","lastVoteRepo","lastVote","lastReactionRepo","lastReaction","addEntity","BXRL","forceAdd","active","change","getUserReaction","Vote","setReaction","dataUsers","TOP","values","getTopUsersText","MORE","cont","likeNode","cloneNode","whiteSpace","visibility","prepend","scale","quad","transform","likeThumbNode","propsStart","propsFinish","userWeight","usersData","recalcNeeded","find","filter","clientWidth","firstChild","ajaxInstance","MobileAjaxWrapper","successCallback","response","display","onCustomEvent","ratingId","user_data","failureCallback","analyticsLabel","b24statAction","b24statContext","RATING_VOTE_ACTION","live","undefined","additionalParams","tryToSet","tryToSend","setInstance","Init","Set","init","eventNode","eventNodeNew","mobileTouchStartHandler","eventName","buttonClickHandler","mobileTopPanelClickHandler","clickShowPopupNode","startScrollTop","likeInstanceNode","blockTouchEndByScroll","currentScrollTop","afterClick","openMobileReactionsPage","lottieAnimations","freeze","admire","admireAnimatedEmojiData","manager","render"],"mappings":";;;;;KAQaA,SAAS;GAAA;KAAA;;GAAA;KAAA;KAAA,6BAMDC,MAAM,EAC1B;OAAA;OACC,IAAMC,MAAM,GAAGD,MAAM,CAACC,MAAM;OAC5B,IAAMC,YAAY,GAAGC,YAAU,CAACC,WAAW,CAACH,MAAM,CAAC;OACnD,IAAMI,MAAM,GAAGL,MAAM,CAACK,MAAM;OAC5B,IAAMC,QAAQ,GAAGN,MAAM,CAACM,QAAQ;OAChC,IAAMC,MAAM,GAAGP,MAAM,CAACO,MAAM;OAE5B,IAAI,IAAI,CAACC,WAAW,KAAKP,MAAM,EAC/B;SACC,OAAO,KAAK;;OAGb,IAAIC,YAAY,CAACO,gBAAgB,IAAI,CAAC,EACtC;SACC;;OAGD,IAAI,CAACC,IAAI,CAACT,MAAM,EAAE,CAAC,EAAEK,QAAQ,EAAE,IAAI,CAAC;OAEpCJ,YAAY,CAACS,kBAAkB,GAAGC,UAAU,CAAC,YAAM;SAClD,KAAI,CAACC,gBAAgB,CAAC;WACrBZ,MAAM,EAAEA,MAAM;WACdK,QAAQ,EAAEA,QAAQ;WAClBD,MAAM,EAAEA,MAAM;WACdE,MAAM,EAAEA;UACR,CAAC;QACF,EAAE,GAAG,CAAC;;;KACP;KAAA,iCAEuBP,MAAM,EAC9B;OAAA;OACC,IAAMC,MAAM,GAAGD,MAAM,CAACC,MAAM;OAC5B,IAAMC,YAAY,GAAGC,YAAU,CAACC,WAAW,CAACH,MAAM,CAAC;OACnD,IAAMI,MAAM,GAAGL,MAAM,CAACK,MAAM;OAC5B,IAAMC,QAAQ,GAAGN,MAAM,CAACM,QAAQ;OAChC,IAAMC,MAAM,GAAGP,MAAM,CAACO,MAAM;OAE5BL,YAAY,CAACY,oBAAoB,GAAG,IAAI;OAExCF,UAAU,CAAC,YAAM;SAChB,MAAI,CAACG,qBAAqB,CAAC;WAC1Bd,MAAM,EAAEA;UACR,CAAC;QACF,EAAE,GAAG,CAAC;OAEP,IAAIC,YAAY,CAACc,oBAAoB,CAACV,QAAQ,CAAC,EAC/C;SACC,IAAI,CAACW,UAAU,CACdhB,MAAM,EACN,IAAI,EACJI,MAAM,EACNE,MAAM,CACN;;;;KAEF;KAAA,sCAE4BP,MAAM,EACnC;OACC,IAAMC,MAAM,GAAGD,MAAM,CAACC,MAAM;OAC5B,IAAMC,YAAY,GAAGC,YAAU,CAACC,WAAW,CAACH,MAAM,CAAC;OAEnDC,YAAY,CAACY,oBAAoB,GAAG,KAAK;;;KACzC;KAAA,2BAEiBb,MAAM,EAAEiB,UAAU,EAAEb,MAAM,EAAEc,QAAQ,EACtD;OAAA;OACC,IAAMjB,YAAY,GAAGC,YAAU,CAACC,WAAW,CAACH,MAAM,CAAC;OAEnD,IAAImB,MAAM,CAAClB,YAAY,CAACmB,SAAS,CAACC,SAAS,CAAC,KAAK,CAAC,EAClD;SACC;;OAGD,IAAMC,QAAQ,GACbrB,YAAY,CAACsB,QAAQ,KAAK,UAAU,GACjCtB,YAAY,CAACuB,KAAK,GAEnBvB,YAAY,CAACwB,OAAO,KAAK,CAAC,GAExBC,cAAI,CAACC,SAAS,CAACvB,MAAM,CAAC,GACnBA,MAAM,GAEPsB,cAAI,CAACE,cAAc,CAACV,QAAQ,CAAC,IAAIW,QAAQ,CAACC,cAAc,CAACZ,QAAQ,CAAC,GAC/DW,QAAQ,CAACC,cAAc,CAACZ,QAAQ,CAAC,GACjC,IACH,GAEDjB,YAAY,CAAC8B,GAElB;OAED,IAAI,CAACL,cAAI,CAACC,SAAS,CAACL,QAAQ,CAAC,EAC7B;SACC;;OAGD,IAAIrB,YAAY,CAAC+B,KAAK,IAAI,IAAI,EAC9B;SACC,IAAMC,YAAY,GAAG,IAAI,CAACC,cAAc,CAACZ,QAAQ,CAAC;SAElD,IAAMa,kBAAkB,GAAG,EAAE;SAC7B,IAAIlC,YAAY,CAACmC,QAAQ,EACzB;WACCD,kBAAkB,CAACE,IAAI,CAAC,gCAAgC,CAAC;;SAE1D,IAAIC,aAAa,CAACC,MAAM,EACxB;WACCJ,kBAAkB,CAACE,IAAI,CAAC,sBAAsB,CAAC;;SAGhDpC,YAAY,CAAC+B,KAAK,GAAG,IAAIQ,gBAAK,CAAC;WAC9BC,EAAE,wBAAiBzC,MAAM,CAAE;WAC3B0C,WAAW,EAAEpB,QAAQ;WACrBqB,WAAW,EAAG,IAAI;WAClBC,SAAS,EAAE,CAAC;WACZC,UAAU,EACT,CAACnB,cAAI,CAACoB,WAAW,CAAC7B,UAAU,CAAC,IAC1B,CAACS,cAAI,CAACqB,MAAM,CAAC9B,UAAU,CAAC,IACxB,CAACS,cAAI,CAACoB,WAAW,CAAC7B,UAAU,CAAC+B,OAAO,CAAC,GACpC/B,UAAU,CAAC+B,OAAO,GAAG,GAAG,GACxB/C,YAAY,CAACwB,OAAO,IAAI,CAAC,GAAG,CAAC,EAAE,GAAG,CACtC;WACDwB,QAAQ,EAAE,IAAI;WACdC,UAAU,EAAE,IAAI;WAChBC,cAAc,EAAGlB,YAAY,GAAG,IAAI,GAAGA,YAAY,GAAG,CAAC,GAAG,IAAK;WAC/DmB,WAAW,EAAE;aACZC,QAAQ,EAAE;YACV;WACDC,SAAS,EAAE,cAAc;WACzBC,MAAM,EAAE;aACPC,YAAY,EAAE,wBAAM;eACnB,MAAI,CAACjD,WAAW,GAAG,IAAI;cACvB;aACDkD,cAAc,EAAE,0BAAM;YACtB;WACDC,OAAO,EAAG7B,QAAQ,CAACC,cAAc,+BAAwB9B,MAAM,EAAG;WAClE2D,SAAS,EAAExB,kBAAkB,CAACyB,IAAI,CAAC,GAAG;UACtC,CAAC;SAEF,IACC,CAAC3D,YAAY,CAACmC,QAAQ,IACnB,CAACE,aAAa,CAACC,MAAM,EAEzB;WACCtC,YAAY,CAAC+B,KAAK,CAAC6B,QAAQ,CAAC,EAAE,CAAC;WAE/BhC,QAAQ,CAACC,cAAc,uBAAgB9B,MAAM,EAAG,CAAC8D,gBAAgB,CAAC,UAAU,EAAE,YAAM;aACnFC,YAAY,CAAC9D,YAAY,CAAC+D,YAAY,CAAC;aACvC/D,YAAY,CAAC+D,YAAY,GAAGrD,UAAU,CAAC,YAAM;eAC5CV,YAAY,CAAC+B,KAAK,CAACiC,KAAK,EAAE;cAC1B,EAAE,IAAI,CAAC;YACR,CAAC;WAEFpC,QAAQ,CAACC,cAAc,uBAAgB9B,MAAM,EAAG,CAAC8D,gBAAgB,CAAC,WAAW,EAAE,YAAM;aACpFC,YAAY,CAAC9D,YAAY,CAAC+D,YAAY,CAAC;YACvC,CAAC;;QAEH,MAED;SACC,IACC,CAACtC,cAAI,CAACoB,WAAW,CAAC7B,UAAU,CAAC,IAC1B,CAACS,cAAI,CAACqB,MAAM,CAAC9B,UAAU,CAAC,IACxB,CAACS,cAAI,CAACoB,WAAW,CAAC7B,UAAU,CAAC+B,OAAO,CAAC,EAEzC;WACC/C,YAAY,CAAC+B,KAAK,CAACa,UAAU,GAAI5B,UAAU,CAAC+B,OAAO,GAAG,GAAI;;SAG3D/C,YAAY,CAAC+B,KAAK,CAACkC,cAAc,CAAC5C,QAAQ,CAAC;;OAG5C,IAAI,IAAI,CAACf,WAAW,KAAKP,MAAM,EAC/B;SACC,IAAMmE,iBAAiB,GAAGjE,YAAU,CAACC,WAAW,CAAC,IAAI,CAACI,WAAW,CAAC;SAClE,IAAI4D,iBAAiB,EACrB;WACCA,iBAAiB,CAACnC,KAAK,CAACiC,KAAK,EAAE;;;OAIjC,IAAI,CAAC1D,WAAW,GAAGP,MAAM;OAEzBC,YAAY,CAAC+B,KAAK,CAACoC,IAAI,EAAE;OAEzB,IAAI,CAACC,YAAY,CAACrE,MAAM,CAAC;;;KACzB;KAAA,+BAEqBsE,OAAO,EAC7B;OACC,IAAIC,KAAK,GAAG,CAAC;OACb,IAAIC,aAAa,GAAG,EAAE;OAEtB,GACA;SACCA,aAAa,GAAGC,aAAG,CAACC,KAAK,CAACJ,OAAO,EAAE,SAAS,CAAC;SAC7C,IAAIE,aAAa,KAAK,MAAM,EAC5B;WACCD,KAAK,GAAG,CAACpD,MAAM,CAACwD,KAAK,CAACC,QAAQ,CAACJ,aAAa,CAAC,CAAC,GAAGD,KAAK,GAAG,CAAC;;SAE3DD,OAAO,GAAGA,OAAO,CAACO,YAAY;QAC9B,QAEAP,OAAO,IACJA,OAAO,CAACQ,OAAO,KAAK,MAAM;OAG9B,OAAOP,KAAK;;;KACZ;KAAA,gCAGD;OACCQ,6BAAY,CAACC,WAAW,CAACC,EAAE,CAACC,SAAS,CAACC,QAAQ,CAACC,YAAY,EAAE,CAACC,SAAS,EAAE,EAAE,0BAA0B,EAAE,IAAI,CAACC,oBAAoB,CAAC;OAEjI,IAAMnB,iBAAiB,GAAGjE,YAAU,CAACC,WAAW,CAAC,IAAI,CAACI,WAAW,CAAC;OAClE,IAAI4D,iBAAiB,EACrB;SACCA,iBAAiB,CAACnC,KAAK,CAACiC,KAAK,EAAE;;;;KAEhC;KAAA,6BAEmBjE,MAAM,EAC1B;OACC,IAAIC,YAAY,GAAGC,YAAU,CAACC,WAAW,CAACH,MAAM,CAAC;OAEjD,IAAI,CAACC,YAAY,CAAC+B,KAAK,EACvB;SACC;;OAGD/B,YAAY,CAAC+B,KAAK,CAACoB,WAAW,CAACmC,iBAAiB,GAAG,IAAI;OACvDtF,YAAY,CAAC+B,KAAK,CAACwD,cAAc,EAAE;OACnCvF,YAAY,CAAC+B,KAAK,CAACoB,WAAW,CAACmC,iBAAiB,GAAG,KAAK;;;KACxD;KAAA,4BAEkBvF,MAAM,EACzB;OAAA;OACC,IAAMC,YAAY,GAAGC,YAAU,CAACC,WAAW,CAACH,MAAM,CAAC;OAEnD,IAAIyF,wBAAwB,GAAGxF,YAAY,CAACyF,YAAY,CAACC,gBAAgB,CAAC,yBAAyB,CAAC,CAAC;OACrG,IAAIF,wBAAwB,CAACG,MAAM,IAAI,CAAC,EACxC;SACCH,wBAAwB,GAAG,CAAExF,YAAY,CAACyF,YAAY,CAAE;;OAGzDD,wBAAwB,CAACI,OAAO,CAAC,UAACC,oBAAoB,EAAK;SAC1DA,oBAAoB,CAAChC,gBAAgB,CAAC,QAAQ,EAAE,UAACiC,CAAC,EAAK;WACtD,IAAIA,CAAC,CAAC3F,MAAM,CAAC4F,SAAS,IAAI,CAACD,CAAC,CAAC3F,MAAM,CAAC6F,YAAY,GAAGF,CAAC,CAAC3F,MAAM,CAAC8F,YAAY,IAAI,GAAG,EAC/E;aACC;;WAED,MAAI,CAACzF,IAAI,CAACT,MAAM,EAAE,IAAI,EAAGC,YAAY,CAACwB,OAAO,IAAI,CAAC,GAAG0E,YAAY,CAACC,oBAAoB,GAAG,KAAK,CAAE;WAChGC,eAAK,CAACC,SAAS,CAACP,CAAC,CAAC3F,MAAM,CAAC;UACzB,CAAC;QACF,CAAC;;;KACF;KAAA,qBAEWJ,MAAM,EAAEuG,IAAI,EAAElG,QAAQ,EAAEmG,KAAK,EACzC;OAAA;OACC,IAAMvG,YAAY,GAAGC,YAAU,CAACC,WAAW,CAACH,MAAM,CAAC;OAEnD,IAAImB,MAAM,CAAClB,YAAY,CAACmB,SAAS,CAACC,SAAS,CAAC,KAAK,CAAC,EAClD;SACC,OAAO,KAAK;;OAGbhB,QAAQ,GAAIqB,cAAI,CAACE,cAAc,CAACvB,QAAQ,CAAC,GAAGA,QAAQ,GAAG,EAAG;OAE1D,IAAIqB,cAAI,CAACqB,MAAM,CAACwD,IAAI,CAAC,EACrB;SACCA,IAAI,GACHtG,YAAY,CAACwB,OAAO,KAAK,CAAC,GAExB,CAACC,cAAI,CAACoB,WAAW,CAACqD,YAAY,CAACM,cAAc,CAACpG,QAAQ,CAAC,CAAC,GACrD8F,YAAY,CAACM,cAAc,CAACpG,QAAQ,CAAC,GACrC,CAAC,GAEHJ,YAAY,CAACO,gBAChB;;OAGF,IACCgG,KAAK,IACFrF,MAAM,CAACoF,IAAI,CAAC,KAAK,CAAC,IAClBtG,YAAY,CAACwB,OAAO,KAAK,CAAC,EAE9B;SACC0E,YAAY,CAACO,iBAAiB,CAAC;WAC9B1G,MAAM,EAAEA;UACR,CAAC;;OAGH,IAAIC,YAAY,CAAC0G,OAAO,EACxB;SACC1G,YAAY,CAAC0G,OAAO,CAACC,KAAK,EAAE;;OAG7BC,cAAI,CAACC,SAAS,CAAC,kBAAkB,EAAE;SAClCC,IAAI,EAAE;WACLhH,MAAM,EAAE;aACPiH,mBAAmB,EAAE/G,YAAY,CAACgH,YAAY;aAC9CC,sBAAsB,EAAEjH,YAAY,CAACkH,SAAS;aAC9CC,qBAAqB,EAAEnH,YAAY,CAACoH,QAAQ;aAC5CC,qBAAqB,EAAEf,IAAI;aAC3BgB,oBAAoB,EAAGlH,QAAQ,KAAK,KAAK,GAAG,EAAE,GAAGA,QAAS;aAC1DmH,oBAAoB,EAAEvH,YAAY,CAACwH;;UAEpC;SACDC,cAAc,EAAE,wBAACC,GAAG,EAAK;WACxB1H,YAAY,CAAC0G,OAAO,GAAGgB,GAAG;;QAE3B,CAAC,CAACC,IAAI,CAAC,UAACC,MAAM,EAAK;SAClB,MAAI,CAACC,aAAa,CAACD,MAAM,CAACd,IAAI,EAAE;WAC/B/G,MAAM,EAAEA,MAAM;WACdK,QAAQ,EAAEA,QAAQ;WAClBkG,IAAI,EAAEA,IAAI;WACVC,KAAK,EAAEA;UACP,CAAC;QACF,EACD,YAAM,EAAE,CACR;OAED,OAAO,KAAK;;;KACZ;KAAA,8BAEoBO,IAAI,EAAEhH,MAAM,EACjC;OACC,IAAI,CAACgH,IAAI,EACT;SACC,OAAO,KAAK;;OAGb,IAAM9G,YAAY,GAAGC,YAAU,CAACC,WAAW,CAACJ,MAAM,CAACC,MAAM,CAAC;OAE1DC,YAAY,CAACmB,SAAS,CAACC,SAAS,GAAG0F,IAAI,CAACgB,SAAS;OAEjD,IAAI5G,MAAM,CAAC4F,IAAI,CAACiB,UAAU,CAAC,KAAK,CAAC,EACjC;SACC,IAAI7G,MAAM,CAAC4F,IAAI,CAACkB,SAAS,CAAC,KAAK,CAAC,EAChC;WACChI,YAAY,CAAC+B,KAAK,CAACiC,KAAK,EAAE;;SAE3B,OAAO,KAAK;;OAGb,IAAIhE,YAAY,CAACwB,OAAO,KAAK,CAAC,EAC9B;SACC0E,YAAY,CAAC+B,iBAAiB,CAAC;WAC9BlI,MAAM,EAAED,MAAM,CAACC,MAAM;WACrBK,QAAQ,EAAEN,MAAM,CAACM,QAAQ;WACzB8H,MAAM,EAAElI,YAAY;WACpBsG,IAAI,EAAExG,MAAM,CAACwG,IAAI;WACjBQ,IAAI,EAAEA,IAAI;WACVP,KAAK,EAAEzG,MAAM,CAACyG;UACd,CAAC;SACFvG,YAAY,CAACmC,QAAQ,CAACgG,YAAY,CAAC,YAAY,EAAE,GAAG,CAAC;QACrD,MAED;SACCjC,YAAY,CAACkC,4BAA4B,CAAC;WACzCF,MAAM,EAAElI,YAAY;WACpBsG,IAAI,EAAExG,MAAM,CAACwG,IAAI;WACjBQ,IAAI,EAAEA;UACN,CAAC;;OAGH,IAAI,CAAC1C,YAAY,CAACtE,MAAM,CAACC,MAAM,CAAC;OAChC,IAAI,CAACsI,WAAW,CAACvI,MAAM,CAACC,MAAM,CAAC;;;KAC/B;KAAA,8BAEoBD,MAAM,EAC3B;OACC,IAAMC,MAAM,GAAI0B,cAAI,CAACE,cAAc,CAAC7B,MAAM,CAACC,MAAM,CAAC,GAAGD,MAAM,CAACC,MAAM,GAAG,KAAM;OAC3E,IAAMiB,UAAU,GAAI,CAACS,cAAI,CAACoB,WAAW,CAAC/C,MAAM,CAACwI,KAAK,CAAC,GAAGxI,MAAM,CAACwI,KAAK,GAAG,KAAM;OAC3E,IAAMlI,QAAQ,GAAIqB,cAAI,CAACE,cAAc,CAAC7B,MAAM,CAACM,QAAQ,CAAC,GAAGN,MAAM,CAACM,QAAQ,GAAG,EAAG;OAC9E,IAAMJ,YAAY,GAAGC,YAAU,CAACC,WAAW,CAACH,MAAM,CAAC;OAEnD,IAAIC,YAAY,CAACY,oBAAoB,EACrC;SACC;;OAGD,IACCZ,YAAY,CAAC+B,KAAK,IACf/B,YAAY,CAAC+B,KAAK,CAACwG,OAAO,EAAE,EAEhC;SACCvI,YAAY,CAAC+B,KAAK,CAACiC,KAAK,EAAE;QAC1B,MAED;SACCF,YAAY,CAAC9D,YAAY,CAACwI,kBAAkB,CAAC;SAC7C1E,YAAY,CAAC9D,YAAY,CAACS,kBAAkB,CAAC;SAE7C,IACCT,YAAY,CAACO,gBAAgB,IAAI,CAAC,KAEjCP,YAAY,CAACmC,QAAQ,CAACsG,YAAY,CAAC,YAAY,CAAC,KAAK,GAAG,IACrDzI,YAAY,CAACmG,oBAAoB,IAAI/F,QAAQ,CAChD,EAEF;WACC,IAAI,CAACI,IAAI,CAACT,MAAM,EAAE,CAAC,EAAEK,QAAQ,EAAE,IAAI,CAAC;;SAGrC,IAAI,CAACW,UAAU,CACdhB,MAAM,EACLiB,UAAU,CAAC0H,aAAa,KAAK1I,YAAY,CAACuB,KAAK,GAAG,IAAI,GAAGP,UAAU,EACpEA,UAAU,CAAC0H,aAAa,EACxB1H,UAAU,CAAC0H,aAAa,CAAClG,EAAE,CAC3B;;;;KAEF;KAAA,mCAEyB1C,MAAM,EAChC;OAAA;OACC,IAAMC,MAAM,GAAI0B,cAAI,CAACE,cAAc,CAAC7B,MAAM,CAACC,MAAM,CAAC,GAAGD,MAAM,CAACC,MAAM,GAAG,KAAM;OAC3E,IAAM4I,eAAe,GAAI,CAAClH,cAAI,CAACoB,WAAW,CAAC/C,MAAM,CAACwI,KAAK,CAAC,GAAGxI,MAAM,CAACwI,KAAK,GAAG,IAAK;OAC/E,IAAMlI,QAAQ,GAAIqB,cAAI,CAACE,cAAc,CAAC7B,MAAM,CAACM,QAAQ,CAAC,GAAGN,MAAM,CAACM,QAAQ,GAAG,EAAG;OAC9E,IAAMC,MAAM,GACXsI,eAAe,IAAIlH,cAAI,CAACE,cAAc,CAACgH,eAAe,CAACD,aAAa,CAAClG,EAAE,CAAC,GACrEmG,eAAe,CAACD,aAAa,CAAClG,EAAE,GAChC,EACH;OAED,IAAMxC,YAAY,GAAGC,YAAU,CAACC,WAAW,CAACH,MAAM,CAAC;OAEnDC,YAAY,CAACc,oBAAoB,CAACV,QAAQ,CAAC,GAAG,IAAI;OAElD0D,YAAY,CAAC9D,YAAY,CAACwI,kBAAkB,CAAC;OAC7C1E,YAAY,CAAC9D,YAAY,CAACS,kBAAkB,CAAC;OAE7CT,YAAY,CAACwI,kBAAkB,GAAG9H,UAAU,CAAC,YAAM;SAClD,MAAI,CAACkI,YAAY,CAAC;WACjB7I,MAAM,EAAEA,MAAM;WACdI,MAAM,EAAEwI,eAAe,CAACD,aAAa;WACrCtI,QAAQ,EAAEA,QAAQ;WAClBC,MAAM,EAAEA;UACR,CAAC;QACF,EAAE,GAAG,CAAC;;;KACP;KAAA,mCAEyBP,MAAM,EAChC;OACC,IAAMC,MAAM,GAAI0B,cAAI,CAACE,cAAc,CAAC7B,MAAM,CAACC,MAAM,CAAC,GAAGD,MAAM,CAACC,MAAM,GAAG,KAAM;OAC3E,IAAMK,QAAQ,GAAIqB,cAAI,CAACE,cAAc,CAAC7B,MAAM,CAACM,QAAQ,CAAC,GAAGN,MAAM,CAACM,QAAQ,GAAG,EAAG;OAC9E,IAAMJ,YAAY,GAAGC,YAAU,CAACC,WAAW,CAACH,MAAM,CAAC;OAEnDC,YAAY,CAACc,oBAAoB,CAACV,QAAQ,CAAC,GAAG,KAAK;OACnDJ,YAAY,CAACY,oBAAoB,GAAG,KAAK;;;GACzC;CAAA;CACD,4BA1cYf,SAAS,iBAEA,IAAI;CAAA,4BAFbA,SAAS,0BAATA,SAAS,CAIcgJ,aAAa,CAACC,IAAI,CAJzCjJ,SAAS,CAIsC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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"}