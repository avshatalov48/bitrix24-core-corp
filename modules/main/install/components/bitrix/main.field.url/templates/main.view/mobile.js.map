{"version":3,"file":"mobile.js","sources":["src/mobile.js"],"sourcesContent":["import {Loc} from 'main.core';\n\nlet\n\tBX = window.BX,\n\tBXMobileApp = window.BXMobileApp;\n\nlet nodeUrl = (function ()\n{\n\tlet nodeUrl = function (node, container)\n\t{\n\t\tthis.node = node;\n\t\tthis.container = container;\n\t\tthis.nodeLink = this.node.previousElementSibling;\n\t\tthis.click = BX.delegate(this.click, this);\n\t\tthis.callback = BX.delegate(this.callback, this);\n\t\tBX.bind(this.container, 'click', this.click);\n\t};\n\tnodeUrl.prototype = {\n\t\tclick(e)\n\t\t{\n\t\t\tif (e.toElement.tagName !== 'A')\n\t\t\t{\n\t\t\t\tthis.show();\n\t\t\t\treturn BX.PreventDefault(e);\n\t\t\t}\n\t\t},\n\t\tshow()\n\t\t{\n\t\t\twindow.app.exec('showPostForm', {\n\t\t\t\tattachButton: {items: []},\n\t\t\t\tattachFileSettings: {},\n\t\t\t\tattachedFiles: [],\n\t\t\t\textraData: {},\n\t\t\t\tmentionButton: {},\n\t\t\t\tsmileButton: {},\n\t\t\t\tmessage: {\n\t\t\t\t\ttext: BX.util.htmlspecialcharsback(this.nodeLink.value)\n\t\t\t\t},\n\t\t\t\tokButton: {\n\t\t\t\t\tcallback: this.callback,\n\t\t\t\t\tname: Loc.getMessage('interface_form_save')\n\t\t\t\t},\n\t\t\t\tcancelButton: {\n\t\t\t\t\tcallback: function ()\n\t\t\t\t\t{\n\t\t\t\t\t},\n\t\t\t\t\tname: Loc.getMessage('interface_form_cancel')\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tcallback(data)\n\t\t{\n\t\t\tdata.text = (BX.util.htmlspecialchars(data.text) || '');\n\t\t\tif (data.text === '')\n\t\t\t{\n\t\t\t\tthis.node.textContent = this.nodeLink.getAttribute('placeholder');\n\t\t\t\tthis.node.setAttribute('href', '#');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.node.textContent = data.text;\n\t\t\t\tif (this.checkUrl(data.text))\n\t\t\t\t{\n\t\t\t\t\tthis.node.setAttribute('href', data.text);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.node.setAttribute('href', 'http://'+data.text);\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.nodeLink.value = data.text;\n\t\t\tBX.onCustomEvent(this, 'onChange', [this, this.nodeLink]);\n\t\t},\n\t\tcheckUrl(url)\n\t\t{\n\t\t\treturn /^(callto:|mailto:|https:\\/\\/|http:\\/\\/)/i.test(url);\n\t\t}\n\t};\n\treturn nodeUrl;\n})();\n\nwindow.app.exec('enableCaptureKeyboard', true);\n\nBX.Mobile.Field.Url = function (params)\n{\n\tthis.init(params);\n};\n\nBX.Mobile.Field.Url.prototype = {\n\t__proto__: BX.Mobile.Field.prototype,\n\tbindElement: function (node)\n\t{\n\t\tlet result = null;\n\t\tif (BX(node))\n\t\t{\n\t\t\tresult = new nodeUrl(node, node.parentElement);\n\t\t}\n\t\treturn result;\n\t}\n};"],"names":["BX","window","BXMobileApp","nodeUrl","node","container","nodeLink","previousElementSibling","click","delegate","callback","bind","prototype","e","toElement","tagName","show","PreventDefault","app","exec","attachButton","items","attachFileSettings","attachedFiles","extraData","mentionButton","smileButton","message","text","util","htmlspecialcharsback","value","okButton","name","Loc","getMessage","cancelButton","data","htmlspecialchars","textContent","getAttribute","setAttribute","checkUrl","onCustomEvent","url","test","Mobile","Field","Url","params","init","__proto__","bindElement","result","parentElement"],"mappings":"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"}