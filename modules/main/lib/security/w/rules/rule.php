<? namespace Bitrix\Main\Security\W\Rules;$GLOBALS['____452146021']= array(base64_decode(''.'aXNfc3RyaW5'.'n'),base64_decode('c3RydG'.'9sb'.'3d'.'lcg=='),base64_decode('a'.'X'.'Nf'.'YXJyYXk='),base64_decode('aXNfc3RyaW5n'),base64_decode('Z3pkZW'.'NvZGU='),base64_decode('Y'.'m'.'FzZTY'.'0X2RlY29kZQ=='),base64_decode('dXJsZGVjb'.'2Rl'),base64_decode('YXJyYXlfcmV2Z'.'XJzZ'.'Q=='),base64_decode('Z3plbmNvZ'.'GU='),base64_decode('YmFzZTY0'.'X2'.'VuY'.'29kZQ'.'=='),base64_decode('dX'.'JsZW5j'.'b2Rl'),base64_decode('Ym'.'luMmhl'.'e'.'A=='),base64_decode(''.'aXNfYXJyYXk='),base64_decode(''.'c3RydG9'.'sb3dlc'.'g='.'='),base64_decode('aX'.'N'.'fYXJyYX'.'k'.'='),base64_decode(''.'am9pbg'.'=='),base64_decode('Z'.'m5tYXR'.'jaA=='),base64_decode('c'.'mF'.'3dX'.'JsZG'.'V'.'jb2Rl'),base64_decode('c3Vic3Ry'),base64_decode('c'.'3'.'Vi'.'c3Ry'),base64_decode('c3RyX3J'.'lcGxhY2U='),base64_decode('cHJlZ'.'19x'.'dW90ZQ=='),base64_decode('cHJlZ19t'.'YXRjaA=='));if(!function_exists(__NAMESPACE__.'\\___1965198586')){function ___1965198586($_1700131091){static $_2091199828= false; if($_2091199828 == false) $_2091199828=array('YWN0aW9u',''.'aW'.'50dmF'.'s',''.'cG'.'F0'.'aA='.'=','Y29udGV4'.'dA==','a2V5'.'cw'.'==',''.'cHJ'.'vY2Vz'.'c'.'w==',''.'Z'.'W5jb2'.'Rpbmc=',''.'cH'.'J'.'l'.'Z19yZXB'.'s'.'Y'.'W'.'Nl',''.'cG'.'F0aA==','Y'.'29udG'.'V4dA='.'=','a'.'2V5'.'cw='.'=','cHJv'.'Y2'.'V'.'zc'.'w==','Z'.'W5'.'jb2Rpbmc=','cGF0d'.'G'.'V'.'ybg==','cHJlZ'.'19tYXRjaA='.'=','cG'.'F0aA==','Y29udGV4dA==','a2V'.'5cw='.'=',''.'cHJvY2Vzcw==','ZW5'.'jb2'.'Rpbm'.'c=','c'.'GF0dGVy'.'bg='.'=','cG9zdF9hY3R'.'pb2'.'4'.'=',''.'Y2hlY2tfY3N'.'yZg='.'=','cGF0a'.'A==','Y29udG'.'V'.'4dA==','a2V5cw==','cH'.'J'.'v'.'Y2Vzcw='.'=','ZW5j'.'b2R'.'pbmc'.'=','cGF0dGVy'.'b'.'g==','YWN0aW'.'9u','Y'.'WN0aW9u',''.'Y'.'WN0a'.'W9u','YWN0'.'aW'.'9u','YWN0'.'aW9u','YWN0aW9u','cG9zdF9hY3R'.'pb24=','ZW'.'5jb2Rpb'.'mc'.'=','ZW5jb2'.'Rpbmc'.'=','ZW5'.'jb2Rpbmc'.'=','ZW5'.'j'.'b2Rpbmc=','ZW5'.'jb2Rp'.'bmc=',''.'ZW5jb'.'2Rpbmc=','Z'.'3o=','Ym'.'F'.'z'.'ZTY0','dX'.'Js','aGV4',''.'L'.'g='.'=',''.'Lw==','a'.'W5'.'kZXgucGhw','L'.'2luZGV'.'4LnB'.'ocA='.'=','U0NSS'.'VBUX'.'05BTUU=','L'.'2'.'l'.'uZGV4L'.'nBo'.'cA='.'=',''.'U0NSSVBUX'.'0'.'5BTUU=','U0'.'N'.'SSVBUX05BTUU=',''.'U0NSS'.'V'.'BUX'.'05'.'BTU'.'U=',''.'fg='.'=',''.'fl4=','fg==','XH4'.'=','J'.'H4=');return base64_decode($_2091199828[$_1700131091]);}}; use Bitrix\Main\IO\Path; use Bitrix\Main\Web\Uri; use Bitrix\Main\Security\W\Rules\Results\ModifyResult; abstract class Rule{ protected $_1901166415; protected $_68795852; protected $_2001564398; protected $_1864724431; protected $_1866620079; public static function make(array $_2128416529):?static{ $_2128416529= static::prepareRuleParameters($_2128416529); return match($_2128416529[___1965198586(0)]){ ___1965198586(1) => new IntvalRule( $_2128416529[___1965198586(2)], $_2128416529[___1965198586(3)], $_2128416529[___1965198586(4)], $_2128416529[___1965198586(5)], $_2128416529[___1965198586(6)]), ___1965198586(7) => new PregReplaceRule( $_2128416529[___1965198586(8)], $_2128416529[___1965198586(9)], $_2128416529[___1965198586(10)], $_2128416529[___1965198586(11)], $_2128416529[___1965198586(12)], $_2128416529[___1965198586(13)]), ___1965198586(14) => new PregMatchRule( $_2128416529[___1965198586(15)], $_2128416529[___1965198586(16)], $_2128416529[___1965198586(17)], $_2128416529[___1965198586(18)], $_2128416529[___1965198586(19)], $_2128416529[___1965198586(20)], $_2128416529[___1965198586(21)]), ___1965198586(22) => new CsrfRule( $_2128416529[___1965198586(23)], $_2128416529[___1965198586(24)], $_2128416529[___1965198586(25)], $_2128416529[___1965198586(26)], $_2128416529[___1965198586(27)], $_2128416529[___1965198586(28)],), default => null,};} protected static function prepareRuleParameters(array $_308131687): array{ if($GLOBALS['____452146021'][0]($_308131687[___1965198586(29)])){ $_308131687[___1965198586(30)]= $GLOBALS['____452146021'][1]($_308131687[___1965198586(31)]);} elseif($GLOBALS['____452146021'][2]($_308131687[___1965198586(32)])){ $_2035802090= $_308131687[___1965198586(33)]; $_308131687[___1965198586(34)]= $_2035802090[min(106,0,35.333333333333)]; $_308131687[___1965198586(35)]= $_2035802090[round(0+0.25+0.25+0.25+0.25)];} $_308131687[___1965198586(36)]=!empty($_308131687[___1965198586(37)])? $_308131687[___1965198586(38)]:[]; if($GLOBALS['____452146021'][3]($_308131687[___1965198586(39)])){ $_308131687[___1965198586(40)]=[$_308131687[___1965198586(41)]];} return $_308131687;}  public function __construct($_1901166415, $_68795852, $_2001564398, $_1864724431, $_1866620079){ $this->_1901166415= $_1901166415; $this->_68795852= $this->castContext($_68795852); $this->_2001564398= $this->castKeys($_2001564398); $this->_1864724431= $_1864724431; $this->_1866620079= $_1866620079;} public function evaluateValue($_576842319){ if(!empty($this->_1866620079)){ foreach($this->_1866620079 as $_2038869535){ $_576842319= match($_2038869535){ 'gz' => $GLOBALS['____452146021'][4]($_576842319), 'base64' => $GLOBALS['____452146021'][5]($_576842319), 'url' => $GLOBALS['____452146021'][6]($_576842319), 'hex' => hex2bin($_576842319)};}} $_1171671228= $this->evaluate($_576842319); if(!empty($this->_1866620079) && $_1171671228 instanceof ModifyResult){ $_1754504006= $_1171671228->getCleanValue(); foreach($GLOBALS['____452146021'][7]($this->_1866620079) as $_2038869535){ $_1754504006= match($_2038869535){ ___1965198586(42) => $GLOBALS['____452146021'][8]($_1754504006), ___1965198586(43) => $GLOBALS['____452146021'][9]($_1754504006), ___1965198586(44) => $GLOBALS['____452146021'][10]($_1754504006), ___1965198586(45) => $GLOBALS['____452146021'][11]($_1754504006)};} $_1171671228= new ModifyResult($_1754504006);} return $_1171671228;} abstract public function evaluate($_576842319); protected function castContext($_68795852){ if(!$GLOBALS['____452146021'][12]($_68795852)){ $_68795852=[$_68795852];} foreach($_68795852 as $_153886171 => $_1276682960){ $_68795852[$_153886171]= $GLOBALS['____452146021'][13]($_1276682960);} return $_68795852;} protected function castKeys($_2001564398){ if(!$GLOBALS['____452146021'][14]($_2001564398)){ $_2001564398=[$_2001564398];} return $_2001564398;} public function matchKey(array $_326359220): bool{ $_326359220= $GLOBALS['____452146021'][15](___1965198586(46), $_326359220); foreach($this->_2001564398 as $_1541827141){   if($GLOBALS['____452146021'][16]($_1541827141, $_326359220)){ return true;}} return false;}  public function matchPath($_36797278){ if($this->_1901166415 === '*'){ return true;}  $_1235388991= new Uri($_36797278); $_1282023286= $_1235388991->getPath(); $_1282023286= $GLOBALS['____452146021'][17]($_1282023286);      if(str_ends_with($_1282023286, ___1965198586(47))){ $_1282023286 .= ___1965198586(48);} $_1282023286= Path::normalize($_1282023286);  $_325377391[]= $_1282023286; if(str_ends_with($_1282023286, ___1965198586(49))){ $_325377391[]= $GLOBALS['____452146021'][18]($_1282023286,(1428/2-714),-round(0+3+3+3));} elseif(str_ends_with($_SERVER[___1965198586(50)], ___1965198586(51))){ $_325377391[]= $GLOBALS['____452146021'][19]($_SERVER[___1965198586(52)], min(56,0,18.666666666667),-round(0+2.25+2.25+2.25+2.25));} if($_1282023286 !== $_SERVER[___1965198586(53)]){ $_325377391[]= $_SERVER[___1965198586(54)];}  if(str_starts_with($this->_1901166415, ___1965198586(55))){ $_961779510= $this->_1901166415;} else{ $_961779510= ___1965198586(56). $GLOBALS['____452146021'][20](___1965198586(57), ___1965198586(58), $GLOBALS['____452146021'][21]($this->_1901166415)). ___1965198586(59);} foreach($_325377391 as $_1067823325){ if($this->_1901166415 === $_1067823325 || $GLOBALS['____452146021'][22]($_961779510, $_1067823325)){ return true;}} return false;}  public function getPath(){ return $this->_1901166415;}  public function getContext(){ return $this->_68795852;}  public function getKeys(){ return $this->_2001564398;}  public function getProcess(){ return $this->_1864724431;}}?>