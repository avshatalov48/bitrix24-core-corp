(function(){"use strict";BX.namespace("BX.Salescenter");BX.Salescenter.Context={sms:"sms",chat:"chat"};BX.Salescenter.Payments={gridId:"CRM_ORDER_PAYMENT_LIST_V12",sessionId:0,context:""};BX.Salescenter.Payments.init=function(e){if(e.sessionId>0){BX.Salescenter.Payments.sessionId=e.sessionId}if(e.gridId){BX.Salescenter.Payments.gridId=e.gridId}if(e.context){BX.Salescenter.Payments.context=e.context}this.isPaymentsLimitReached=e.isPaymentsLimitReached===true};BX.Salescenter.Payments.getGrid=function(){var e=BX.Main.gridManager.getById(BX.Salescenter.Payments.gridId);if(e){return e.instance}return false};BX.Salescenter.Payments.sendGridPayments=function(){if(BX.Salescenter.Payments.isPaymentsLimitReached){BX.Salescenter.Payments.showFeaturePopup()}if(BX.Salescenter.Payments.context===BX.Salescenter.Context.chat&&BX.Salescenter.Payments.sessionId<=0){return}var e=BX.Salescenter.Payments.getGrid();if(!e){return}var t=e.getRows().getSelectedIds();if(!t||t.length===0){return}BX.ajax.runAction("salescenter.order.sendPayments",{analyticsLabel:"salescenterSendPayments",data:{paymentIds:t,options:{context:BX.Salescenter.Payments.context,sessionId:BX.Salescenter.Payments.sessionId}}}).then(function(e){var t=e.data.payments;if(t&&t.length>0){if(BX.SidePanel){var n=BX.SidePanel.Instance.getSliderByWindow(window);if(n){var s=BX.SidePanel.Instance.getPreviousSlider(n);if(s){if(BX.Salescenter.Payments.context===BX.Salescenter.Context.sms&&e.data.paymentTitle){s.getData().set("action","sendPayment");s.getData().set("order",{title:e.data.paymentTitle})}s.close()}n.destroy()}}for(var a in t){if(t.hasOwnProperty(a)){BX.UI.Notification.Center.notify({content:BX.message("SPL_TEMPLETE_SALESCENTER_PAYMENT_SENT_NOTIFICATION").replace("#PAYMENT_ID#",t[a])})}}}})};BX.Salescenter.Payments.highlightOrder=function(e){if(e>0){var t=BX.Salescenter.Payments.getGrid();if(t){var n=t.getRows().getById(e);if(n){n.select()}}}};BX.Salescenter.Payments.showFeaturePopup=function(){B24.licenseInfoPopup.show("salescenterPaymentsLimit",BX.message("SPL_ORDERS_LIMITS_TITLE"),BX.message("SPL_ORDERS_LIMITS_MESSAGE"),true)}})(window);
//# sourceMappingURL=script.map.js