{"version":3,"file":"script.js","sources":["script.es6.js"],"sourcesContent":["import {Tag, Event, Type, Reflection, ajax as Ajax} from 'main.core';\nimport {PopupMenu, PopupMenuWindow, PopupWindow, PopupWindowButton} from 'main.popup';\n\nimport {Manager} from 'salescenter.manager';\n\nimport 'marketplace';\nimport 'applayout';\n\nconst namespace = Reflection.namespace('BX.Salescenter');\n\nclass ControlPanel\n{\n\tstatic shopRoot = '/shop/settings/';\n\tstatic commonConnectionDependentTiles = [];\n\tstatic pageMenuTiles = [];\n\tstatic paymentSystemsTile;\n\tstatic userConsentTile;\n\n\tstatic init(options: {\n\t\tshopRoot: string,\n\t})\n\t{\n\t\tif(Type.isPlainObject(options))\n\t\t{\n\t\t\tthis.constructor.shopRoot = options.shopRoot;\n\t\t}\n\n\t\tEvent.ready(() =>\n\t\t{\n\t\t\tif (BX.SidePanel.Instance)\n\t\t\t{\n\t\t\t\tBX.SidePanel.Instance.bindAnchors(top.BX.clone({\n\t\t\t\t\trules: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcondition: [\n\t\t\t\t\t\t\t\tthis.constructor.shopRoot + \"sale_delivery_service_edit/\",\n\t\t\t\t\t\t\t\tthis.constructor.shopRoot + \"sale_pay_system_edit/\"\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\thandler: this.constructor.adjustSidePanelOpener\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcondition: [\n\t\t\t\t\t\t\t\t\"/shop/orders/details/(\\\\d+)/\",\n\t\t\t\t\t\t\t\t\"/shop/orders/payment/details/(\\\\d+)/\",\n\t\t\t\t\t\t\t\t\"/shop/orders/shipment/details/(\\\\d+)/\"\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcondition: [\n\t\t\t\t\t\t\t\t\"/crm/configs/sale/\"\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t}));\n\t\t\t}\n\n\t\t\tvar adminSidePanel = top.BX.adminSidePanel || BX.adminSidePanel;\n\t\t\tif (adminSidePanel)\n\t\t\t{\n\t\t\t\tif (!top.window[\"adminSidePanel\"] || !BX.is_subclass_of(top.window[\"adminSidePanel\"], adminSidePanel))\n\t\t\t\t{\n\t\t\t\t\ttop.window[\"adminSidePanel\"] = new adminSidePanel({\n\t\t\t\t\t\tpublicMode: true\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tstatic addCommonConnectionDependentTile(tile: BaseItem)\n\t{\n\t\tControlPanel.commonConnectionDependentTiles.push(tile);\n\t}\n\n\tstatic addPageMenuTile(tile: BaseItem)\n\t{\n\t\tControlPanel.pageMenuTiles.push(tile);\n\t}\n\n\tstatic adjustSidePanelOpener(event, link)\n\t{\n\t\tif (BX.SidePanel.Instance)\n\t\t{\n\t\t\tconst isSidePanelParams = (link.url.indexOf(\"IFRAME=Y&IFRAME_TYPE=SIDE_SLIDER\") >= 0);\n\t\t\tif (!isSidePanelParams || (isSidePanelParams && !BX.SidePanel.Instance.getTopSlider()))\n\t\t\t{\n\t\t\t\tevent.preventDefault();\n\t\t\t\tlink.url =\tBX.util.add_url_param(link.url, {\"publicSidePanel\": \"Y\"});\n\t\t\t\tBX.SidePanel.Instance.open(link.url, {\n\t\t\t\t\tallowChangeHistory: false\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic connectShop(id: string)\n\t{\n\t\tManager.startConnection({\n\t\t\tcontext: id,\n\t\t}).then(() =>\n\t\t{\n\t\t\tManager.loadConfig().then((result) =>\n\t\t\t{\n\t\t\t\tif(result.isSiteExists)\n\t\t\t\t{\n\t\t\t\t\tManager.showAfterConnectPopup();\n\t\t\t\t\tControlPanel.commonConnectionDependentTiles.forEach((item) =>\n\t\t\t\t\t{\n\t\t\t\t\t\titem.data.active = true;\n\t\t\t\t\t\titem.dropMenu();\n\t\t\t\t\t\titem.rerender();\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n\n\tstatic paymentSystemsTileClick()\n\t{\n\t\tif(ControlPanel.paymentSystemsTile)\n\t\t{\n\t\t\tControlPanel.paymentSystemsTile.onClick();\n\t\t}\n\t}\n\n\tstatic closeMenu()\n\t{\n\t\tconst menu = PopupMenu.getCurrentMenu();\n\t\tif(menu)\n\t\t{\n\t\t\tmenu.destroy();\n\t\t}\n\t}\n\n\tstatic dropPageMenus()\n\t{\n\t\tControlPanel.pageMenuTiles.forEach((item: BaseItem) =>\n\t\t{\n\t\t\titem.dropMenu();\n\t\t});\n\t}\n\n\tstatic reloadUserConsentTile()\n\t{\n\t\tif(ControlPanel.userConsentTile)\n\t\t{\n\t\t\tControlPanel.userConsentTile.reloadTile();\n\t\t}\n\t}\n}\n\nclass BaseItem extends BX.TileGrid.Item\n{\n\tconstructor(options)\n\t{\n\t\tsuper(options);\n\n\t\tthis.title = options.title;\n\t\tthis.image = options.image;\n\t\tthis.data = options.data || {};\n\n\t\tif(this.isDependsOnConnection())\n\t\t{\n\t\t\tControlPanel.addCommonConnectionDependentTile(this);\n\t\t}\n\t\tif(this.hasPagesMenu())\n\t\t{\n\t\t\tControlPanel.addPageMenuTile(this);\n\t\t}\n\t\tif(this.id === 'payment-systems')\n\t\t{\n\t\t\tControlPanel.paymentSystemsTile = this;\n\t\t}\n\t\telse if (this.id === 'userconsent')\n\t\t{\n\t\t\tControlPanel.userConsentTile = this;\n\t\t}\n\t}\n\n\tisDependsOnConnection(): boolean\n\t{\n\t\treturn (this.data.isDependsOnConnection === true);\n\t}\n\n\thasPagesMenu(): boolean\n\t{\n\t\treturn (this.data.hasPagesMenu === true);\n\t}\n\n\tgetContent(): Element\n\t{\n\t\tthis.layout.innerContent = Tag.render`<div class=\"salescenter-item ${this.getAdditionalContentClass()}\" onclick=\"${this.onClick.bind(this)}\" style=\"${this.getContentStyles()}\">\n\t\t\t<div class=\"salescenter-item-content\">\n\t\t\t\t${this.getImage()}\n\t\t\t\t${this.getTitle()}\n\t\t\t\t${(this.isActive() ? this.getStatus() : '')}\n\t\t\t\t${this.getLabel()}\n\t\t\t</div>\n\t\t</div>`;\n\n\t\treturn this.layout.innerContent;\n\t}\n\n\trerender()\n\t{\n\t\tif(!this.layout.innerContent)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tconst contentNode = this.layout.innerContent.parentNode;\n\t\tcontentNode.removeChild(this.layout.innerContent);\n\t\tcontentNode.appendChild(this.getContent());\n\t}\n\n\tgetAdditionalContentClass(): string\n\t{\n\t\tif(this.isActive())\n\t\t{\n\t\t\treturn 'salescenter-item-selected';\n\t\t}\n\n\t\treturn '';\n\t}\n\n\tisActive(): boolean\n\t{\n\t\treturn (this.data.active === true);\n\t}\n\n\tgetLoadMenuItemsAction(): ?string\n\t{\n\t\treturn null;\n\t}\n\n\tonClick()\n\t{\n\t\tif(!this.isActive())\n\t\t{\n\t\t\tControlPanel.connectShop(this.id);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tlet menu = this.getMenuItems();\n\t\t\tif(!menu)\n\t\t\t{\n\t\t\t\tthis.reloadTile(true).then((response) =>\n\t\t\t\t{\n\t\t\t\t\tmenu = this.getMenuItems();\n\t\t\t\t\tif(this.isActive() && menu)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.showMenu();\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.onClick();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.showMenu();\n\t\t\t}\n\t\t}\n\t}\n\n\tgetContentStyles(): string\n\t{\n\t\tlet styles = '';\n\t\tif(this.isActive() && this.data.activeColor && !this.isMarketplaceAll())\n\t\t{\n\t\t\tstyles = 'background-color: ' + this.data.activeColor;\n\t\t}\n\n\t\treturn styles;\n\t}\n\n\tgetImage()\n\t{\n\t\tlet path = '';\n\t\tlet className = 'salescenter-item-image';\n\t\tif(this.image)\n\t\t{\n\t\t\tpath = this.image;\n\t\t}\n\t\tif(this.isActive() && this.data.activeImage)\n\t\t{\n\t\t\tpath = this.data.activeImage;\n\t\t}\n\t\tpath = encodeURI(path);\n\n\t\tif (this.isMarketplaceAll()\n\t\t\t&& this.data.hasOwnProperty('hasOwnIcon')\n\t\t\t&& this.data.hasOwnIcon\n\t\t)\n\t\t{\n\t\t\tclassName = 'salescenter-marketplace-item-image';\n\t\t}\n\n\t\treturn Tag.render`<div class=\"${className}\" style=\"background-image:url(${path})\"></div>`;\n\t}\n\n\tgetStatus(): Element\n\t{\n\t\treturn Tag.render`<div class=\"salescenter-item-status-selected\"></div>`;\n\t}\n\n\tgetLabel(): ?Element\n\t{\n\t\tif (this.needNewLabel())\n\t\t{\n\t\t\tlet className = 'salescenter-item-label-new';\n\t\t\tlet classNameText = 'salescenter-item-label-new-text';\n\t\t\tif (this.isActive() && this.data.hasOwnProperty('activeColor'))\n\t\t\t{\n\t\t\t\tclassName = 'salescenter-item-label-new-active';\n\t\t\t\tclassNameText = 'salescenter-item-label-new-text-active';\n\t\t\t}\n\n\t\t\treturn Tag.render`<div class=\"${className}\"><div class=\"${classNameText}\">${BX.message('SALESCENTER_CONTROL_PANEL_ITEM_LABEL_NEW')}</div></div>`;\n\t\t}\n\n\t\treturn '';\n\t}\n\n\tgetTitle(): Element\n\t{\n\t\tlet className = this.isMarketplaceAll() ? 'salescenter-marketplace-item-title' : 'salescenter-item-title';\n\t\treturn Tag.render`<div class=\"${className}\">${this.title}</div>`;\n\t}\n\n\tgetMenuItems(): ?Array\n\t{\n\t\treturn this.data.menu;\n\t}\n\n\thasMenu(): boolean\n\t{\n\t\treturn Type.isArrayFilled(this.data.menu);\n\t}\n\n\tdropMenu(): BaseItem\n\t{\n\t\tdelete this.data.menu;\n\n\t\treturn this;\n\t}\n\n\tshowMenu()\n\t{\n\t\tPopupMenu.show(this.id + '-menu', this.layout.container, this.getMenuItems(), {\n\t\t\toffsetLeft: 0,\n\t\t\toffsetTop: 0,\n\t\t\tcloseByEsc: true,\n\t\t\tclassName: 'salescenter-panel-menu'\n\t\t});\n\t}\n\n\tgetUrl(): ?string\n\t{\n\t\tif(Type.isString(this.data.url))\n\t\t{\n\t\t\treturn this.data.url;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tgetSliderOptions()\n\t{\n\t\tif (Type.isPlainObject(this.data.sliderOptions))\n\t\t{\n\t\t\treturn this.data.sliderOptions;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\treloadTile(isClick: boolean = false)\n\t{\n\t\treturn new Promise((resolve) =>\n\t\t{\n\t\t\tif(Type.isString(this.data.reloadAction))\n\t\t\t{\n\t\t\t\tAjax.runComponentAction(\n\t\t\t\t\t'bitrix:salescenter.control_panel',\n\t\t\t\t\tthis.data.reloadAction,\n\t\t\t\t\t{\n\t\t\t\t\t\tanalyticsLabel: isClick ? 'salescenterControlPanelReloadTile' : null,\n\t\t\t\t\t\tgetParameters: isClick ? {\n\t\t\t\t\t\t\ttileId: this.id,\n\t\t\t\t\t\t} : null,\n\t\t\t\t\t\tmode: 'class',\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\tid: this.id,\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t).then((response) =>\n\t\t\t\t{\n\t\t\t\t\tif(!Type.isNil(response.data.active))\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.data.active = response.data.active;\n\t\t\t\t\t}\n\t\t\t\t\tif(!Type.isNil(response.data.menu))\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.data.menu = response.data.menu;\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.rerender();\n\t\t\t\t\tresolve();\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresolve();\n\t\t\t}\n\t\t});\n\t}\n\n\tisMarketplaceAll()\n\t{\n\t\treturn this.data.hasOwnProperty('itemSubType')\n\t\t\t&& this.data.itemSubType === 'marketplaceApp';\n\t}\n\n\tneedNewLabel()\n\t{\n\t\treturn this.data.hasOwnProperty('label')\n\t\t\t&& this.data.label === 'new';\n\t}\n\n\topenRestAppLayout(applicationId, appCode)\n\t{\n\t\tAjax.runComponentAction(\n\t\t\t\"bitrix:salescenter.control_panel\",\n\t\t\t\"getRestApp\",\n\t\t\t{\n\t\t\t\tdata: {\n\t\t\t\t\tcode: appCode\n\t\t\t\t}\n\t\t\t}\n\t\t).then(function(response)\n\t\t{\n\t\t\tlet app = response.data;\n\t\t\tif(app.TYPE === \"A\")\n\t\t\t{\n\t\t\t\tthis.showRestApplication(appCode);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tBX.rest.AppLayout.openApplication(applicationId);\n\t\t\t}\n\t\t}.bind(this)).catch(function(response)\n\t\t{\n\t\t\tthis.restAppErrorPopup(\" \", response.errors.pop().message);\n\t\t}.bind(this));\n\t}\n\n\tshowRestApplication(appCode)\n\t{\n\t\tlet applicationUrlTemplate = \"/marketplace/detail/#app#/\";\n\t\tlet url = applicationUrlTemplate.replace(\"#app#\", encodeURIComponent(appCode));\n\t\tManager.openSlider(url).then(this.reloadTile.bind(this));\n\t}\n\n\trestAppErrorPopup(title, text)\n\t{\n\t\tBX.UI.Dialogs.MessageBox.alert(\n\t\t\ttext,\n\t\t\ttitle,\n\t\t\t(messageBox) => messageBox.close(),\n\t\t\tBX.Loc.getMessage('SALESCENTER_CONTROL_PANEL_POPUP_CLOSE'),\n\t\t);\n\t}\n}\n\nclass PaymentItem extends BaseItem\n{\n\tdropMenu(): BaseItem\n\t{\n\t\treturn this;\n\t}\n\n\tonClick()\n\t{\n\t\tif (this.isMarketplaceAll())\n\t\t{\n\t\t\tif (this.data.active)\n\t\t\t{\n\t\t\t\tthis.openRestAppLayout(this.data.appId, this.data.code);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.showRestApplication(this.data.code);\n\t\t\t}\n\t\t}\n\t\telse if (this.opensSlider())\n\t\t{\n\t\t\tconst url = this.getUrl();\n\t\t\tconst options = this.getSliderOptions();\n\t\t\tif(url)\n\t\t\t{\n\t\t\t\tManager.openSlider(url, options).then(this.reloadTile.bind(this));\n\t\t\t}\n\t\t}\n\t\telse if (this.isRecommendTile())\n\t\t{\n\t\t\tManager.openFeedbackPayOrderForm();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tsuper.onClick();\n\t\t}\n\t}\n\n\topensSlider(): boolean\n\t{\n\t\tconst tileHasSlider =\n\t\t\tthis.isCrmStoreTile()\n\t\t\t|| this.isCrmWithEshopTile()\n\t\t\t|| this.isCrmFormTile()\n\t\t\t|| this.isTerminalTile()\n\t\t;\n\t\tconst tileHasUrl = this.getUrl();\n\t\tconst tileHasMenu = this.hasMenu();\n\n\t\treturn tileHasSlider && tileHasUrl && !tileHasMenu;\n\t}\n\n\tisRecommendTile()\n\t{\n\t\treturn this.id === 'recommendation';\n\t}\n\n\tisCrmStoreTile()\n\t{\n\t\treturn this.id === 'crmstore';\n\t}\n\n\tisCrmWithEshopTile()\n\t{\n\t\treturn this.id === 'crm-with-eshop';\n\t}\n\n\tisCrmFormTile()\n\t{\n\t\treturn this.id && this.id === 'crmform';\n\t}\n\n\tisTerminalTile()\n\t{\n\t\treturn this.id && this.id === 'terminal';\n\t}\n}\n\nclass PaymentSystemItem extends BaseItem\n{\n\tonClick()\n\t{\n\t\tif(this.isDependsOnConnection())\n\t\t{\n\t\t\tsuper.onClick();\n\t\t}\n\t\telse if(this.id === 'userconsent')\n\t\t{\n\t\t\tif(!this.isActive())\n\t\t\t{\n\t\t\t\tconst url = this.getUrl();\n\t\t\t\tif(url)\n\t\t\t\t{\n\t\t\t\t\tManager.openSlider(url).then(this.reloadTile.bind(this));\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.showMenu();\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst url = this.getUrl();\n\t\t\tif(url)\n\t\t\t{\n\t\t\t\tManager.openSlider(url).then(this.reloadTile.bind(this));\n\t\t\t}\n\t\t}\n\t}\n}\n\nnamespace.ControlPanel = ControlPanel;\nnamespace.PaymentItem = PaymentItem;\nnamespace.PaymentSystemItem = PaymentSystemItem;\n"],"names":["namespace","Reflection","ControlPanel","options","Type","isPlainObject","constructor","shopRoot","Event","ready","BX","SidePanel","Instance","bindAnchors","top","clone","rules","condition","handler","adjustSidePanelOpener","adminSidePanel","window","is_subclass_of","publicMode","tile","commonConnectionDependentTiles","push","pageMenuTiles","event","link","isSidePanelParams","url","indexOf","getTopSlider","preventDefault","util","add_url_param","open","allowChangeHistory","id","Manager","startConnection","context","then","loadConfig","result","isSiteExists","showAfterConnectPopup","forEach","item","data","active","dropMenu","rerender","paymentSystemsTile","onClick","menu","PopupMenu","getCurrentMenu","destroy","userConsentTile","reloadTile","BaseItem","title","image","isDependsOnConnection","addCommonConnectionDependentTile","hasPagesMenu","addPageMenuTile","layout","innerContent","Tag","render","getAdditionalContentClass","bind","getContentStyles","getImage","getTitle","isActive","getStatus","getLabel","contentNode","parentNode","removeChild","appendChild","getContent","connectShop","getMenuItems","response","showMenu","styles","activeColor","isMarketplaceAll","path","className","activeImage","encodeURI","hasOwnProperty","hasOwnIcon","needNewLabel","classNameText","message","isArrayFilled","show","container","offsetLeft","offsetTop","closeByEsc","isString","sliderOptions","isClick","Promise","resolve","reloadAction","Ajax","runComponentAction","analyticsLabel","getParameters","tileId","mode","isNil","itemSubType","label","applicationId","appCode","code","app","TYPE","showRestApplication","rest","AppLayout","openApplication","restAppErrorPopup","errors","pop","applicationUrlTemplate","replace","encodeURIComponent","openSlider","text","UI","Dialogs","MessageBox","alert","messageBox","close","Loc","getMessage","TileGrid","Item","PaymentItem","openRestAppLayout","appId","opensSlider","getUrl","getSliderOptions","isRecommendTile","openFeedbackPayOrderForm","tileHasSlider","isCrmStoreTile","isCrmWithEshopTile","isCrmFormTile","isTerminalTile","tileHasUrl","tileHasMenu","hasMenu","PaymentSystemItem"],"mappings":"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"}