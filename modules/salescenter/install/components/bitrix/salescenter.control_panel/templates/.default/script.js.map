{"version":3,"file":"script.js","sources":["script.es6.js"],"sourcesContent":["import {Tag, Event, Type, Reflection, ajax as Ajax} from 'main.core';\nimport {PopupMenu, PopupMenuWindow, PopupWindow, PopupWindowButton} from 'main.popup';\n\nimport {Manager} from 'salescenter.manager';\n\nimport 'marketplace';\nimport 'applayout';\n\nconst namespace = Reflection.namespace('BX.Salescenter');\n\nclass ControlPanel\n{\n\tstatic shopRoot = '/shop/settings/';\n\tstatic commonConnectionDependentTiles = [];\n\tstatic pageMenuTiles = [];\n\tstatic paymentSystemsTile;\n\tstatic userConsentTile;\n\n\tstatic init(options: {\n\t\tshopRoot: string,\n\t})\n\t{\n\t\tif(Type.isPlainObject(options))\n\t\t{\n\t\t\tthis.constructor.shopRoot = options.shopRoot;\n\t\t}\n\n\t\tEvent.ready(() =>\n\t\t{\n\t\t\tif (BX.SidePanel.Instance)\n\t\t\t{\n\t\t\t\tBX.SidePanel.Instance.bindAnchors(top.BX.clone({\n\t\t\t\t\trules: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcondition: [\n\t\t\t\t\t\t\t\tthis.constructor.shopRoot + \"sale_delivery_service_edit/\",\n\t\t\t\t\t\t\t\tthis.constructor.shopRoot + \"sale_pay_system_edit/\"\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\thandler: this.constructor.adjustSidePanelOpener\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcondition: [\n\t\t\t\t\t\t\t\t\"/shop/orders/details/(\\\\d+)/\",\n\t\t\t\t\t\t\t\t\"/shop/orders/payment/details/(\\\\d+)/\",\n\t\t\t\t\t\t\t\t\"/shop/orders/shipment/details/(\\\\d+)/\"\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcondition: [\n\t\t\t\t\t\t\t\t\"/crm/configs/sale/\"\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t}));\n\t\t\t}\n\n\t\t\tvar adminSidePanel = top.BX.adminSidePanel || BX.adminSidePanel;\n\t\t\tif (adminSidePanel)\n\t\t\t{\n\t\t\t\tif (!top.window[\"adminSidePanel\"] || !BX.is_subclass_of(top.window[\"adminSidePanel\"], adminSidePanel))\n\t\t\t\t{\n\t\t\t\t\ttop.window[\"adminSidePanel\"] = new adminSidePanel({\n\t\t\t\t\t\tpublicMode: true\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tstatic addCommonConnectionDependentTile(tile: BaseItem)\n\t{\n\t\tControlPanel.commonConnectionDependentTiles.push(tile);\n\t}\n\n\tstatic addPageMenuTile(tile: BaseItem)\n\t{\n\t\tControlPanel.pageMenuTiles.push(tile);\n\t}\n\n\tstatic adjustSidePanelOpener(event, link)\n\t{\n\t\tif (BX.SidePanel.Instance)\n\t\t{\n\t\t\tconst isSidePanelParams = (link.url.indexOf(\"IFRAME=Y&IFRAME_TYPE=SIDE_SLIDER\") >= 0);\n\t\t\tif (!isSidePanelParams || (isSidePanelParams && !BX.SidePanel.Instance.getTopSlider()))\n\t\t\t{\n\t\t\t\tevent.preventDefault();\n\t\t\t\tlink.url =\tBX.util.add_url_param(link.url, {\"publicSidePanel\": \"Y\"});\n\t\t\t\tBX.SidePanel.Instance.open(link.url, {\n\t\t\t\t\tallowChangeHistory: false\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic connectShop(id: string)\n\t{\n\t\tManager.startConnection({\n\t\t\tcontext: id,\n\t\t}).then(() =>\n\t\t{\n\t\t\tManager.loadConfig().then((result) =>\n\t\t\t{\n\t\t\t\tif(result.isSiteExists)\n\t\t\t\t{\n\t\t\t\t\tManager.showAfterConnectPopup();\n\t\t\t\t\tControlPanel.commonConnectionDependentTiles.forEach((item) =>\n\t\t\t\t\t{\n\t\t\t\t\t\titem.data.active = true;\n\t\t\t\t\t\titem.dropMenu();\n\t\t\t\t\t\titem.rerender();\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n\n\tstatic paymentSystemsTileClick()\n\t{\n\t\tif(ControlPanel.paymentSystemsTile)\n\t\t{\n\t\t\tControlPanel.paymentSystemsTile.onClick();\n\t\t}\n\t}\n\n\tstatic closeMenu()\n\t{\n\t\tconst menu = PopupMenu.getCurrentMenu();\n\t\tif(menu)\n\t\t{\n\t\t\tmenu.destroy();\n\t\t}\n\t}\n\n\tstatic dropPageMenus()\n\t{\n\t\tControlPanel.pageMenuTiles.forEach((item: BaseItem) =>\n\t\t{\n\t\t\titem.dropMenu();\n\t\t});\n\t}\n\n\tstatic reloadUserConsentTile()\n\t{\n\t\tif(ControlPanel.userConsentTile)\n\t\t{\n\t\t\tControlPanel.userConsentTile.reloadTile();\n\t\t}\n\t}\n}\n\nclass BaseItem extends BX.TileGrid.Item\n{\n\tconstructor(options)\n\t{\n\t\tsuper(options);\n\n\t\tthis.title = options.title;\n\t\tthis.image = options.image;\n\t\tthis.data = options.data || {};\n\n\t\tif(this.isDependsOnConnection())\n\t\t{\n\t\t\tControlPanel.addCommonConnectionDependentTile(this);\n\t\t}\n\t\tif(this.hasPagesMenu())\n\t\t{\n\t\t\tControlPanel.addPageMenuTile(this);\n\t\t}\n\t\tif(this.id === 'payment-systems')\n\t\t{\n\t\t\tControlPanel.paymentSystemsTile = this;\n\t\t}\n\t\telse if (this.id === 'userconsent')\n\t\t{\n\t\t\tControlPanel.userConsentTile = this;\n\t\t}\n\t}\n\n\tisDependsOnConnection(): boolean\n\t{\n\t\treturn (this.data.isDependsOnConnection === true);\n\t}\n\n\thasPagesMenu(): boolean\n\t{\n\t\treturn (this.data.hasPagesMenu === true);\n\t}\n\n\tgetContent(): Element\n\t{\n\t\tthis.layout.innerContent = Tag.render`<div class=\"salescenter-item ${this.getAdditionalContentClass()}\" onclick=\"${this.onClick.bind(this)}\" style=\"${this.getContentStyles()}\">\n\t\t\t<div class=\"salescenter-item-content\">\n\t\t\t\t${this.getImage()}\n\t\t\t\t${this.getTitle()}\n\t\t\t\t${(this.isActive() ? this.getStatus() : '')}\n\t\t\t\t${this.getLabel()}\n\t\t\t</div>\n\t\t</div>`;\n\n\t\treturn this.layout.innerContent;\n\t}\n\n\trerender()\n\t{\n\t\tif(!this.layout.innerContent)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tconst contentNode = this.layout.innerContent.parentNode;\n\t\tcontentNode.removeChild(this.layout.innerContent);\n\t\tcontentNode.appendChild(this.getContent());\n\t}\n\n\tgetAdditionalContentClass(): string\n\t{\n\t\tif(this.isActive())\n\t\t{\n\t\t\treturn 'salescenter-item-selected';\n\t\t}\n\n\t\treturn '';\n\t}\n\n\tisActive(): boolean\n\t{\n\t\treturn (this.data.active === true);\n\t}\n\n\tgetLoadMenuItemsAction(): ?string\n\t{\n\t\treturn null;\n\t}\n\n\tonClick()\n\t{\n\t\tif(!this.isActive())\n\t\t{\n\t\t\tControlPanel.connectShop(this.id);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tlet menu = this.getMenuItems();\n\t\t\tif(!menu)\n\t\t\t{\n\t\t\t\tthis.reloadTile(true).then((response) =>\n\t\t\t\t{\n\t\t\t\t\tmenu = this.getMenuItems();\n\t\t\t\t\tif(this.isActive() && menu)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.showMenu();\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.onClick();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.showMenu();\n\t\t\t}\n\t\t}\n\t}\n\n\tgetContentStyles(): string\n\t{\n\t\tlet styles = '';\n\t\tif(this.isActive() && this.data.activeColor && !this.isMarketplaceAll())\n\t\t{\n\t\t\tstyles = 'background-color: ' + this.data.activeColor;\n\t\t}\n\n\t\treturn styles;\n\t}\n\n\tgetImage()\n\t{\n\t\tlet path = '';\n\t\tlet className = 'salescenter-item-image';\n\t\tif(this.image)\n\t\t{\n\t\t\tpath = this.image;\n\t\t}\n\t\tif(this.isActive() && this.data.activeImage)\n\t\t{\n\t\t\tpath = this.data.activeImage;\n\t\t}\n\t\tpath = encodeURI(path);\n\n\t\tif (this.isMarketplaceAll()\n\t\t\t&& this.data.hasOwnProperty('hasOwnIcon')\n\t\t\t&& this.data.hasOwnIcon\n\t\t)\n\t\t{\n\t\t\tclassName = 'salescenter-marketplace-item-image';\n\t\t}\n\n\t\treturn Tag.render`<div class=\"${className}\" style=\"background-image:url(${path})\"></div>`;\n\t}\n\n\tgetStatus(): Element\n\t{\n\t\treturn Tag.render`<div class=\"salescenter-item-status-selected\"></div>`;\n\t}\n\n\tgetLabel(): ?Element\n\t{\n\t\tif (this.needNewLabel())\n\t\t{\n\t\t\tlet className = 'salescenter-item-label-new';\n\t\t\tlet classNameText = 'salescenter-item-label-new-text';\n\t\t\tif (this.isActive() && this.data.hasOwnProperty('activeColor'))\n\t\t\t{\n\t\t\t\tclassName = 'salescenter-item-label-new-active';\n\t\t\t\tclassNameText = 'salescenter-item-label-new-text-active';\n\t\t\t}\n\n\t\t\treturn Tag.render`<div class=\"${className}\"><div class=\"${classNameText}\">${BX.message('SALESCENTER_CONTROL_PANEL_ITEM_LABEL_NEW')}</div></div>`;\n\t\t}\n\n\t\treturn '';\n\t}\n\n\tgetTitle(): Element\n\t{\n\t\tlet className = this.isMarketplaceAll() ? 'salescenter-marketplace-item-title' : 'salescenter-item-title';\n\t\treturn Tag.render`<div class=\"${className}\">${this.title}</div>`;\n\t}\n\n\tgetMenuItems(): ?Array\n\t{\n\t\treturn this.data.menu;\n\t}\n\n\thasMenu(): boolean\n\t{\n\t\treturn Type.isArrayFilled(this.data.menu);\n\t}\n\n\tdropMenu(): BaseItem\n\t{\n\t\tdelete this.data.menu;\n\n\t\treturn this;\n\t}\n\n\tshowMenu()\n\t{\n\t\tPopupMenu.show(this.id + '-menu', this.layout.container, this.getMenuItems(), {\n\t\t\toffsetLeft: 0,\n\t\t\toffsetTop: 0,\n\t\t\tcloseByEsc: true,\n\t\t\tclassName: 'salescenter-panel-menu'\n\t\t});\n\t}\n\n\tgetUrl(): ?string\n\t{\n\t\tif(Type.isString(this.data.url))\n\t\t{\n\t\t\treturn this.data.url;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tgetSliderOptions()\n\t{\n\t\tif (Type.isPlainObject(this.data.sliderOptions))\n\t\t{\n\t\t\treturn this.data.sliderOptions;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\treloadTile(isClick: boolean = false)\n\t{\n\t\treturn new Promise((resolve) =>\n\t\t{\n\t\t\tif(Type.isString(this.data.reloadAction))\n\t\t\t{\n\t\t\t\tAjax.runComponentAction(\n\t\t\t\t\t'bitrix:salescenter.control_panel',\n\t\t\t\t\tthis.data.reloadAction,\n\t\t\t\t\t{\n\t\t\t\t\t\tanalyticsLabel: isClick ? 'salescenterControlPanelReloadTile' : null,\n\t\t\t\t\t\tgetParameters: isClick ? {\n\t\t\t\t\t\t\ttileId: this.id,\n\t\t\t\t\t\t} : null,\n\t\t\t\t\t\tmode: 'class',\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\tid: this.id,\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t).then((response) =>\n\t\t\t\t{\n\t\t\t\t\tif(!Type.isNil(response.data.active))\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.data.active = response.data.active;\n\t\t\t\t\t}\n\t\t\t\t\tif(!Type.isNil(response.data.menu))\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.data.menu = response.data.menu;\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.rerender();\n\t\t\t\t\tresolve();\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresolve();\n\t\t\t}\n\t\t});\n\t}\n\n\tisMarketplaceAll()\n\t{\n\t\treturn this.data.hasOwnProperty('itemSubType')\n\t\t\t&& this.data.itemSubType === 'marketplaceApp';\n\t}\n\n\tneedNewLabel()\n\t{\n\t\treturn this.data.hasOwnProperty('label')\n\t\t\t&& this.data.label === 'new';\n\t}\n\n\topenRestAppLayout(applicationId, appCode)\n\t{\n\t\tAjax.runComponentAction(\n\t\t\t\"bitrix:salescenter.control_panel\",\n\t\t\t\"getRestApp\",\n\t\t\t{\n\t\t\t\tdata: {\n\t\t\t\t\tcode: appCode\n\t\t\t\t}\n\t\t\t}\n\t\t).then(function(response)\n\t\t{\n\t\t\tlet app = response.data;\n\t\t\tif(app.TYPE === \"A\")\n\t\t\t{\n\t\t\t\tthis.showRestApplication(appCode);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tBX.rest.AppLayout.openApplication(applicationId);\n\t\t\t}\n\t\t}.bind(this)).catch(function(response)\n\t\t{\n\t\t\tthis.restAppErrorPopup(\" \", response.errors.pop().message);\n\t\t}.bind(this));\n\t}\n\n\tshowRestApplication(appCode)\n\t{\n\t\tlet applicationUrlTemplate = \"/marketplace/detail/#app#/\";\n\t\tlet url = applicationUrlTemplate.replace(\"#app#\", encodeURIComponent(appCode));\n\t\tManager.openSlider(url).then(this.reloadTile.bind(this));\n\t}\n\n\trestAppErrorPopup(title, text)\n\t{\n\t\tlet popup = new BX.PopupWindow('rest-app-error-alert', null, {\n\t\t\tcloseIcon: true,\n\t\t\tcloseByEsc: true,\n\t\t\tautoHide: false,\n\t\t\ttitleBar: title,\n\t\t\tcontent: text,\n\t\t\tzIndex: 16000,\n\t\t\toverlay: {\n\t\t\t\tcolor: 'gray',\n\t\t\t\topacity: 30\n\t\t\t},\n\t\t\tbuttons: [\n\t\t\t\tnew BX.PopupWindowButton({\n\t\t\t\t\t'id': 'close',\n\t\t\t\t\t'text': BX.message('SALESCENTER_CONTROL_PANEL_POPUP_CLOSE'),\n\t\t\t\t\t'events': {\n\t\t\t\t\t\t'click': function() {\n\t\t\t\t\t\t\tpopup.close();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t],\n\t\t\tevents: {\n\t\t\t\tonPopupClose: function() {\n\t\t\t\t\tthis.destroy();\n\t\t\t\t},\n\t\t\t\tonPopupDestroy: function() {\n\t\t\t\t\tpopup = null;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tpopup.show();\n\t}\n}\n\nclass PaymentItem extends BaseItem\n{\n\tdropMenu(): BaseItem\n\t{\n\t\treturn this;\n\t}\n\n\tonClick()\n\t{\n\t\tif (this.isMarketplaceAll())\n\t\t{\n\t\t\tif (this.data.active)\n\t\t\t{\n\t\t\t\tthis.openRestAppLayout(this.data.appId, this.data.code);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.showRestApplication(this.data.code);\n\t\t\t}\n\t\t}\n\t\telse if (this.opensSlider())\n\t\t{\n\t\t\tconst url = this.getUrl();\n\t\t\tconst options = this.getSliderOptions();\n\t\t\tif(url)\n\t\t\t{\n\t\t\t\tManager.openSlider(url, options).then(this.reloadTile.bind(this));\n\t\t\t}\n\t\t}\n\t\telse if (this.isRecommendTile())\n\t\t{\n\t\t\tManager.openFeedbackPayOrderForm();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tsuper.onClick();\n\t\t}\n\t}\n\n\topensSlider(): boolean\n\t{\n\t\tconst tileHasSlider =\n\t\t\tthis.isCrmStoreTile()\n\t\t\t|| this.isCrmWithEshopTile()\n\t\t\t|| this.isCrmFormTile()\n\t\t\t|| this.isTerminalTile()\n\t\t;\n\t\tconst tileHasUrl = this.getUrl();\n\t\tconst tileHasMenu = this.hasMenu();\n\n\t\treturn tileHasSlider && tileHasUrl && !tileHasMenu;\n\t}\n\n\tisRecommendTile()\n\t{\n\t\treturn this.id === 'recommendation';\n\t}\n\n\tisCrmStoreTile()\n\t{\n\t\treturn this.id === 'crmstore';\n\t}\n\n\tisCrmWithEshopTile()\n\t{\n\t\treturn this.id === 'crm-with-eshop';\n\t}\n\n\tisCrmFormTile()\n\t{\n\t\treturn this.id && this.id === 'crmform';\n\t}\n\n\tisTerminalTile()\n\t{\n\t\treturn this.id && this.id === 'terminal';\n\t}\n}\n\nclass PaymentSystemItem extends BaseItem\n{\n\tonClick()\n\t{\n\t\tif(this.isDependsOnConnection())\n\t\t{\n\t\t\tsuper.onClick();\n\t\t}\n\t\telse if(this.id === 'userconsent')\n\t\t{\n\t\t\tif(!this.isActive())\n\t\t\t{\n\t\t\t\tconst url = this.getUrl();\n\t\t\t\tif(url)\n\t\t\t\t{\n\t\t\t\t\tManager.openSlider(url).then(this.reloadTile.bind(this));\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.showMenu();\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst url = this.getUrl();\n\t\t\tif(url)\n\t\t\t{\n\t\t\t\tManager.openSlider(url).then(this.reloadTile.bind(this));\n\t\t\t}\n\t\t}\n\t}\n}\n\nnamespace.ControlPanel = ControlPanel;\nnamespace.PaymentItem = PaymentItem;\nnamespace.PaymentSystemItem = PaymentSystemItem;\n"],"names":["namespace","Reflection","ControlPanel","options","Type","isPlainObject","constructor","shopRoot","Event","ready","BX","SidePanel","Instance","bindAnchors","top","clone","rules","condition","handler","adjustSidePanelOpener","adminSidePanel","window","is_subclass_of","publicMode","tile","commonConnectionDependentTiles","push","pageMenuTiles","event","link","isSidePanelParams","url","indexOf","getTopSlider","preventDefault","util","add_url_param","open","allowChangeHistory","id","Manager","startConnection","context","then","loadConfig","result","isSiteExists","showAfterConnectPopup","forEach","item","data","active","dropMenu","rerender","paymentSystemsTile","onClick","menu","PopupMenu","getCurrentMenu","destroy","userConsentTile","reloadTile","BaseItem","title","image","isDependsOnConnection","addCommonConnectionDependentTile","hasPagesMenu","addPageMenuTile","layout","innerContent","Tag","render","getAdditionalContentClass","bind","getContentStyles","getImage","getTitle","isActive","getStatus","getLabel","contentNode","parentNode","removeChild","appendChild","getContent","connectShop","getMenuItems","response","showMenu","styles","activeColor","isMarketplaceAll","path","className","activeImage","encodeURI","hasOwnProperty","hasOwnIcon","needNewLabel","classNameText","message","isArrayFilled","show","container","offsetLeft","offsetTop","closeByEsc","isString","sliderOptions","isClick","Promise","resolve","reloadAction","Ajax","runComponentAction","analyticsLabel","getParameters","tileId","mode","isNil","itemSubType","label","applicationId","appCode","code","app","TYPE","showRestApplication","rest","AppLayout","openApplication","restAppErrorPopup","errors","pop","applicationUrlTemplate","replace","encodeURIComponent","openSlider","text","popup","PopupWindow","closeIcon","autoHide","titleBar","content","zIndex","overlay","color","opacity","buttons","PopupWindowButton","close","events","onPopupClose","onPopupDestroy","TileGrid","Item","PaymentItem","openRestAppLayout","appId","opensSlider","getUrl","getSliderOptions","isRecommendTile","openFeedbackPayOrderForm","tileHasSlider","isCrmStoreTile","isCrmWithEshopTile","isCrmFormTile","isTerminalTile","tileHasUrl","tileHasMenu","hasMenu","PaymentSystemItem"],"mappings":"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"}