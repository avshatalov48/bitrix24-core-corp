(function(){"use strict";BX.namespace("BX.Salescenter");BX.Salescenter.Context={sms:"sms",chat:"chat"};BX.Salescenter.Orders={gridId:"CRM_ORDER_LIST_V12",sessionId:0,context:""};BX.Salescenter.Orders.init=function(e){if(e.sessionId>0){BX.Salescenter.Orders.sessionId=e.sessionId}if(e.gridId){BX.Salescenter.Orders.gridId=e.gridId}if(e.context){BX.Salescenter.Orders.context=e.context}this.isPaymentsLimitReached=e.isPaymentsLimitReached===true;BX.Salescenter.Orders.initEvents()};BX.Salescenter.Orders.getGrid=function(){var e=BX.Main.gridManager.getById(BX.Salescenter.Orders.gridId);if(e){return e.instance}return false};BX.Salescenter.Orders.sendGridOrders=function(){if(BX.Salescenter.Orders.isPaymentsLimitReached){BX.Salescenter.Orders.showFeaturePopup()}if(BX.Salescenter.Orders.context===BX.Salescenter.Context.chat&&BX.Salescenter.Orders.sessionId<=0){return}var e=BX.Salescenter.Orders.getGrid();if(!e){return}var r=e.getRows().getSelectedIds();if(!r||r.length===0){return}BX.ajax.runAction("salescenter.order.sendOrders",{analyticsLabel:"salescenterSendOrders",data:{orderIds:r,options:{context:BX.Salescenter.Orders.context,sessionId:BX.Salescenter.Orders.sessionId}}}).then(function(e){var r=e.data.orders;if(r&&r.length>0){if(BX.SidePanel){var t=BX.SidePanel.Instance.getSliderByWindow(window);if(t){var s=BX.SidePanel.Instance.getPreviousSlider(t);if(s){if(BX.Salescenter.Orders.context===BX.Salescenter.Context.sms&&e.data.orderTitle){s.getData().set("action","sendPayment");s.getData().set("order",{title:e.data.orderTitle})}s.close()}t.destroy()}}for(var n in r){if(r.hasOwnProperty(n)){BX.UI.Notification.Center.notify({content:BX.message("SALESCENTER_ORDER_SENT_NOTIFICATION").replace("#ORDER_ID#",r[n])})}}}})};BX.Salescenter.Orders.highlightOrder=function(e){if(e>0){var r=BX.Salescenter.Orders.getGrid();if(r){var t=r.getRows().getById(e);if(t){t.select()}}}};BX.Salescenter.Orders.initEvents=function(){top.BX.addCustomEvent(window,"salescenter-order-create",function(e){var r=BX.Salescenter.Orders.getGrid();if(r){r.reloadTable("GET",{},function(){BX.Salescenter.Orders.highlightOrder(e.orderId)})}})};BX.Salescenter.Orders.showFeaturePopup=function(){B24.licenseInfoPopup.show("salescenterPaymentsLimit",BX.message("SALESCENTER_ORDERS_LIMITS_TITLE"),BX.message("SALESCENTER_ORDERS_LIMITS_MESSAGE"),true)}})(window);
//# sourceMappingURL=script.map.js