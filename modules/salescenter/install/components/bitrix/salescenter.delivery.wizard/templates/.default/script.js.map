{"version":3,"file":"script.js","sources":["script.es6.js"],"sourcesContent":[";(function ()\n{\n\t'use strict';\n\n\tvar namespace = BX.namespace('BX.Salescenter.DeliveryInstallation');\n\tif (namespace.Wizard)\n\t{\n\t\treturn;\n\t}\n\n\t/**\n\t * Wizard.\n\t *\n\t */\n\tfunction Wizard()\n\t{\n\t}\n\n\tWizard.prototype.init = function (params)\n\t{\n\t\tthis.id = params.id;\n\t\tthis.code = params.code;\n\t\tthis.form = BX(params.formId);\n\t\tthis.saveButton = BX(params.saveButtonId);\n\t\tthis.confirmDeleteMessage = params.confirmDeleteMessage;\n\t\tthis.errorMessageNode = BX(params.errorMessageId);\n\n\t\tthis.buttonWaitClass = 'ui-btn-wait';\n\n\t\tBX.bind(this.saveButton, 'click', this.onSave.bind(this));\n\t\tBX.bind(this.form, 'submit', this.onSubmit.bind(this));\n\t};\n\tWizard.prototype.onSave = function ()\n\t{\n\t\tif (BX.hasClass(this.saveButton, this.buttonWaitClass))\n\t\t{\n\t\t\tBX.removeClass(this.saveButton, this.buttonWaitClass);\n\t\t}\n\t};\n\tWizard.prototype.delete = function (event)\n\t{\n\t\tevent.preventDefault();\n\n\t\tlet deleteButton = event.target;\n\n\t\tif(this.id > 0 && confirm(this.confirmDeleteMessage))\n\t\t{\n\t\t\tBX.ajax.runComponentAction(\n\t\t\t\t'bitrix:salescenter.delivery.wizard',\n\t\t\t\t'delete',\n\t\t\t\t{\n\t\t\t\t\tdata: {id: this.id, code: this.code},\n\t\t\t\t}\n\t\t\t).then(\n\t\t\t\tfunction() {\n\t\t\t\t\tdeleteButton.classList.remove('ui-btn-wait');\n\t\t\t\t\tBX.SidePanel.Instance.close();\n\t\t\t\t}.bind(this),\n\t\t\t\tfunction (result) {\n\t\t\t\t\tdeleteButton.classList.remove('ui-btn-wait');\n\n\t\t\t\t\tthis.showError(result.errors);\n\t\t\t\t}.bind(this)\n\t\t\t);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tsetTimeout(() => BX.removeClass(deleteButton, 'ui-btn-wait'), 100);\n\t\t}\n\t};\n\tWizard.prototype.onSubmit = function (event)\n\t{\n\t\tlet settings = {};\n\t\tlet formData = new FormData(this.form);\n\t\tfor(let pair of formData.entries())\n\t\t{\n\t\t\tsettings[pair[0]] = pair[1];\n\t\t}\n\n\t\tthis.saveButton.classList.add('ui-btn-wait');\n\n\t\tlet finallyCallback = () => {this.saveButton.classList.remove('ui-btn-wait');};\n\n\t\tlet action = formData.has('id') ? 'update' : 'install';\n\n\t\tBX.ajax.runComponentAction(\n\t\t\t'bitrix:salescenter.delivery.wizard',\n\t\t\taction,\n\t\t\t{\n\t\t\t\tjson: settings\n\t\t\t}\n\t\t).then((response) =>\n\t\t{\n\t\t\tfinallyCallback();\n\t\t\tBX.SidePanel.Instance.close();\n\t\t}).catch((result) => {\n\t\t\tfinallyCallback();\n\t\t\tthis.showError(result.errors);\n\t\t});\n\n\t\tevent.preventDefault();\n\t};\n\tWizard.prototype.showError = function (errors)\n\t{\n\t\tlet text = '';\n\n\t\terrors.forEach(function (error) {\n\t\t\ttext += error.message + '<br>';\n\t\t});\n\n\t\tif(this.errorMessageNode && text)\n\t\t{\n\t\t\tthis.errorMessageNode.parentNode.style.display = 'block';\n\t\t\tthis.errorMessageNode.innerHTML = text;\n\t\t}\n\t}\n\n\tnamespace.Wizard = new Wizard();\n})();"],"names":["namespace","BX","Wizard","prototype","init","params","id","code","form","formId","saveButton","saveButtonId","confirmDeleteMessage","errorMessageNode","errorMessageId","buttonWaitClass","bind","onSave","onSubmit","hasClass","removeClass","event","preventDefault","deleteButton","target","confirm","ajax","runComponentAction","data","then","classList","remove","SidePanel","Instance","close","result","showError","errors","setTimeout","settings","formData","FormData","entries","pair","add","finallyCallback","action","has","json","response","text","forEach","error","message","parentNode","style","display","innerHTML"],"mappings":"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"}