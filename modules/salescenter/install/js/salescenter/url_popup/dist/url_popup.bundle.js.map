{"version":3,"file":"url_popup.bundle.js","sources":["../src/url_popup.js"],"sourcesContent":["import {Type, Text} from 'main.core';\nimport {PopupMenu} from 'main.popup';\nimport {Vue} from 'ui.vue';\nimport {Manager} from 'salescenter.manager';\nimport './url_popup.css';\nimport 'ui.forms';\n\nVue.component('bx-salescenter-url-popup',\n\t{\n\t\tdata()\n\t\t{\n\t\t\treturn {\n\t\t\t\turlCheckStatus: 0,\n\t\t\t\terrorMessage: null,\n\t\t\t\tpreviousUrl: null,\n\t\t\t\tisEmptyNameOnSave: false,\n\t\t\t\tisDefaultName: false,\n\t\t\t\tpreviousName: null,\n\t\t\t\tfieldsPopupMenuId: 'salescenter-url-fields-popup',\n\t\t\t\tparams: [],\n\t\t\t\tfieldsMap: null,\n\t\t\t};\n\t\t},\n\t\tcreated()\n\t\t{\n\t\t\tthis.$root.$on('onAddUrlPopupCreate', this.setPageData);\n\t\t\tthis.previousUrl = new Set();\n\n\t\t\tlet checkUrlDebounce = BX.debounce(this.checkUrl, 1500, this);\n\t\t\tthis.debounceCheckUrl = () =>\n\t\t\t{\n\t\t\t\tlet url = this.$refs['urlInput'].value;\n\t\t\t\tif(this.previousUrl.has(url))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis.errorMessage = null;\n\t\t\t\tthis.urlCheckStatus = 0;\n\t\t\t\tcheckUrlDebounce();\n\t\t\t};\n\t\t},\n\t\tmounted()\n\t\t{\n\t\t\tsetTimeout(() =>\n\t\t\t{\n\t\t\t\tthis.$refs['urlInput'].focus();\n\t\t\t}, 100);\n\t\t},\n\t\tbeforeDestroy()\n\t\t{\n\t\t\tthis.$root.$off('onAddUrlPopupCreate', this.setPageData);\n\t\t},\n\t\tmethods:\n\t\t{\n\t\t\tonTitleKeyUp()\n\t\t\t{\n\t\t\t\tif(this.isDefaultName && this.$refs['nameInput'].value !== this.previousName)\n\t\t\t\t{\n\t\t\t\t\tthis.isDefaultName = false;\n\t\t\t\t\tthis.previousName = this.$refs['nameInput'].value;\n\t\t\t\t}\n\t\t\t},\n\t\t\tcheckUrl()\n\t\t\t{\n\t\t\t\tlet url = this.$refs['urlInput'].value;\n\t\t\t\tthis.$refs['isFrameDeniedInput'].value = '';\n\t\t\t\tthis.errorMessage = null;\n\t\t\t\tthis.urlCheckStatus = 0;\n\t\t\t\tthis.previousUrl = new Set();\n\t\t\t\tthis.previousUrl.add(url);\n\t\t\t\tif(url.length < 5)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis.urlCheckStatus = 1;\n\t\t\t\tthis.$root.$app.checkUrl(url).then((result) =>\n\t\t\t\t{\n\t\t\t\t\tthis.urlCheckStatus = 11;\n\t\t\t\t\tif(!result.answer.result)\n\t\t\t\t\t{\n\t\t\t\t\t\t//this.urlCheckStatus = 23;\n\t\t\t\t\t\tif(url.indexOf('http://') !== 0 && url.indexOf('https://') !== 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.$refs['urlInput'].value = 'http://' + url;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.errorMessage = this.localize.SALESCENTER_ACTION_ADD_CUSTOM_NO_META;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tif(this.$refs['nameInput'].value.length <= 0 || this.isDefaultName)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.$refs['nameInput'].value = result.answer.result.title;\n\t\t\t\t\t\t\tthis.isDefaultName = true;\n\t\t\t\t\t\t\tthis.previousName = this.$refs['nameInput'].value\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(result.answer.result.extra && result.answer.result.extra.effectiveUrl)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.$refs['urlInput'].value = result.answer.result.extra.effectiveUrl;\n\t\t\t\t\t\t\tthis.previousUrl.add(result.answer.result.extra.effectiveUrl);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.$refs['urlInput'].value = result.answer.result.url;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(result.answer.result.isFrameDenied === true)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.$refs['isFrameDeniedInput'].value = 'Y';\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.$refs['nameInput'].focus();\n\t\t\t\t\t}\n\t\t\t\t}).catch((result) =>\n\t\t\t\t{\n\t\t\t\t\tthis.urlCheckStatus = 22;\n\t\t\t\t\tthis.errorMessage = result.answer.error_description;\n\t\t\t\t});\n\t\t\t},\n\t\t\tsave()\n\t\t\t{\n\t\t\t\tthis.isEmptyNameOnSave = false;\n\t\t\t\tif(this.$refs['nameInput'].value.length <= 0)\n\t\t\t\t{\n\t\t\t\t\tthis.isEmptyNameOnSave = true;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif(this.urlCheckStatus > 10 && this.urlCheckStatus < 20)\n\t\t\t\t{\n\t\t\t\t\tlet params = [];\n\t\t\t\t\tthis.params.forEach((param) =>\n\t\t\t\t\t{\n\t\t\t\t\t\tparams.push(param.chain);\n\t\t\t\t\t});\n\t\t\t\t\tif(params.length <= 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tparams = 'false';\n\t\t\t\t\t}\n\t\t\t\t\tthis.$root.$app.addPage({\n\t\t\t\t\t\turl: this.$refs['urlInput'].value,\n\t\t\t\t\t\tname: this.$refs['nameInput'].value,\n\t\t\t\t\t\tid: this.$refs['idInput'].value,\n\t\t\t\t\t\tisFrameDenied: this.$refs['isFrameDeniedInput'].value,\n\t\t\t\t\t\tisWebform: this.$refs['isWebformInput'].value,\n\t\t\t\t\t\tparams,\n\t\t\t\t\t}).then((result) =>\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$refs['idInput'].value = result.answer.result.page.id;\n\t\t\t\t\t\tthis.$refs['isSaved'].value = 'y';\n\t\t\t\t\t\tif(this.$root.$app.addUrlPopup)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.$root.$app.addUrlPopup.close();\n\t\t\t\t\t\t}\n\t\t\t\t\t}).catch((result) =>\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.errorMessage = result.answer.error_description;\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t},\n\t\t\tcancel()\n\t\t\t{\n\t\t\t\tif(this.$root.$app.addUrlPopup)\n\t\t\t\t{\n\t\t\t\t\tthis.$root.$app.addUrlPopup.close();\n\t\t\t\t}\n\t\t\t},\n\t\t\tsetPageData(page = {\n\t\t\t\turl: '',\n\t\t\t\tname: '',\n\t\t\t\tid: 0,\n\t\t\t\tisWebform: '',\n\t\t\t\tparams: [],\n\t\t\t})\n\t\t\t{\n\t\t\t\tconst fields = ['url', 'name', 'id', 'isWebform'];\n\t\t\t\tfor(let i in fields)\n\t\t\t\t{\n\t\t\t\t\tlet name = fields[i];\n\t\t\t\t\tlet value = '';\n\t\t\t\t\tif(page.hasOwnProperty(name))\n\t\t\t\t\t{\n\t\t\t\t\t\tvalue = page[name];\n\t\t\t\t\t}\n\t\t\t\t\tlet input = this.$refs[name + 'Input'];\n\t\t\t\t\tif(input)\n\t\t\t\t\t{\n\t\t\t\t\t\tinput.value = value;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.checkUrl();\n\t\t\t\tthis.$refs['isSaved'].value = 'n';\n\t\t\t\tthis.params = [];\n\t\t\t\tif(Type.isArray(page.params) && page.params.length > 0)\n\t\t\t\t{\n\t\t\t\t\tManager.getFieldsMap().then((fields) =>\n\t\t\t\t\t{\n\t\t\t\t\t\tpage.params.forEach((param) =>\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlet field = this.findFieldByParam(fields, param.field);\n\t\t\t\t\t\t\tif(field)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.params.push(field);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t},\n\t\t\tfindFieldByParam(fields, param)\n\t\t\t{\n\t\t\t\tif(!Type.isArray(fields) || !Type.isString(param) || param.length <= 0)\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t\treturn this.getEntityField({items: fields}, param);\n\t\t\t},\n\t\t\tgetEntityField(entity, chain)\n\t\t\t{\n\t\t\t\tlet result = null;\n\t\t\t\tif(!Type.isPlainObject(entity) || !Type.isString(chain) || chain.length <= 0 || !entity.items || !Type.isArray(entity.items))\n\t\t\t\t{\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t\tlet parts = chain.split('.');\n\t\t\t\tentity.items.forEach((field) =>\n\t\t\t\t{\n\t\t\t\t\tif(!result)\n\t\t\t\t\t{\n\t\t\t\t\t\tif(field.name === parts[0])\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif(parts.length === 1)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tresult = field;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tparts.shift();\n\t\t\t\t\t\t\t\tresult = this.getEntityField(field, parts.join('.'));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\treturn result;\n\t\t\t},\n\t\t\topenFieldsMenu()\n\t\t\t{\n\t\t\t\tManager.getFieldsMap().then((fields) =>\n\t\t\t\t{\n\t\t\t\t\tfields = this.prepareFieldsMenu(fields);\n\t\t\t\t\tPopupMenu.show({\n\t\t\t\t\t\tid: this.fieldsPopupMenuId,\n\t\t\t\t\t\tbindElement: this.$refs['fieldsSelector'],\n\t\t\t\t\t\titems: fields,\n\t\t\t\t\t\toffsetLeft: 0,\n\t\t\t\t\t\toffsetTop: 0,\n\t\t\t\t\t\tcloseByEsc: true,\n\t\t\t\t\t\tzIndex: 2000,\n\t\t\t\t\t\tzIndexAbsolute: 2000,\n\t\t\t\t\t\tmaxHeight: 500,\n\t\t\t\t\t});\n\t\t\t\t}).catch((errors) =>\n\t\t\t\t{\n\t\t\t\t\tif(Type.isArray(errors))\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.errorMessage = errors.pop().message;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.errorMessage = errors;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\t\t\tprepareFieldsMenu(fields)\n\t\t\t{\n\t\t\t\tconst result = [];\n\t\t\t\tfields.forEach((item) =>\n\t\t\t\t{\n\t\t\t\t\tconst menu = {\n\t\t\t\t\t\ttext: Text.encode(item.title),\n\t\t\t\t\t\tdataset: {\n\t\t\t\t\t\t\trootMenu: this.fieldsPopupMenuId,\n\t\t\t\t\t\t},\n\t\t\t\t\t};\n\t\t\t\t\tif(Type.isArray(item.items))\n\t\t\t\t\t{\n\t\t\t\t\t\tmenu.items = this.prepareFieldsMenu(item.items);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tmenu.onclick = () =>\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.selectField(item);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tresult.push(menu);\n\t\t\t\t});\n\n\t\t\t\treturn result;\n\t\t\t},\n\t\t\tselectField(field)\n\t\t\t{\n\t\t\t\tthis.removeParam(field);\n\t\t\t\tthis.params.push(field);\n\t\t\t},\n\t\t\tremoveParam(param)\n\t\t\t{\n\t\t\t\tthis.params = this.params.filter((item) =>\n\t\t\t\t{\n\t\t\t\t\treturn (item.chain !== param.chain);\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\tcomputed:\n\t\t{\n\t\t\tlocalize()\n\t\t\t{\n\t\t\t\treturn Vue.getFilteredPhrases('SALESCENTER_');\n\t\t\t},\n\t\t\thasParams()\n\t\t\t{\n\t\t\t\treturn (this.params && this.params.length > 0);\n\t\t\t},\n\t\t},\n\t\ttemplate: `\n\t\t<div class=\"salescenter-add-custom-url-popup\">\n\t\t\t<div class=\"salescenter-add-custom-url-popup-form\">\n\t\t\t\t<div class=\"ui-ctl-label-text\">{{localize.SALESCENTER_ACTION_ADD_CUSTOM_INPUT}}</div>\n\t\t\t\t<div class=\"ui-ctl ui-ctl-ext-after-icon ui-ctl-textbox\" :class=\"{\n\t\t\t\t\t'ui-ctl-danger': this.urlCheckStatus > 20 || errorMessage, \n\t\t\t\t\t'ui-ctl-success': this.urlCheckStatus > 10 && this.urlCheckStatus < 20\n\t\t\t\t}\">\n\t\t\t\t\t<div class=\"ui-ctl-ext-after ui-ctl-icon-dots salescenter-url-params-selector\" @click=\"openFieldsMenu\" ref=\"fieldsSelector\"></div>\n\t\t\t\t\t<input name=\"url\" class=\"ui-ctl-element\" @keyup=\"debounceCheckUrl\" ref=\"urlInput\" :placeholder=\"localize.SALESCENTER_ACTION_ADD_CUSTOM_INPUT_PLACEHOLDER\" autocomplete=\"off\"/>\n\t\t\t\t</div>\n\t\t\t\t<div style=\"min-height: 20px;\">\n\t\t\t\t\t<template v-if=\"urlCheckStatus > 20 || errorMessage\" class=\"salescenter-url-message\">{{errorMessage}}</template>\n\t\t\t\t\t<template v-else-if=\"urlCheckStatus > 10\"></template>\n\t\t\t\t\t<template v-else-if=\"urlCheckStatus > 0\">{{localize.SALESCENTER_ACTION_ADD_CUSTOM_PENDING}}</template>\n\t\t\t\t</div>\n\t\t\t\t<label class=\"ui-ctl\" :class=\"{\n\t\t\t\t\t'hidden': !this.hasParams\n\t\t\t\t}\">\n\t\t\t\t\t<div class=\"ui-ctl-label-text\">{{localize.SALESCENTER_ACTION_URL_PARAMS}}</div>\n\t\t\t\t\t<div class=\"salescenter-url-params-field\">\n\t\t\t\t\t\t<div v-for=\"param in params\" class=\"salescenter-url-param\">\n\t\t\t\t\t\t\t<span class=\"salescenter-url-param-name\">{{param.fullName}}</span>\n\t\t\t\t\t\t\t<span class=\"salescenter-url-param-delete\" @click=\"removeParam(param)\"></span>\n\t\t\t\t\t    </div>\n\t\t\t\t    </div>\n\t\t\t\t</label>\n\t\t\t\t<div class=\"ui-ctl-label-text\">{{localize.SALESCENTER_ACTION_ADD_CUSTOM_NAME}}</div>\n\t\t\t\t<label class=\"ui-ctl ui-ctl-textbox\" :class=\"{\n\t\t\t\t\t'ui-ctl-danger': this.isEmptyNameOnSave\n\t\t\t\t}\">\n\t\t\t\t\t<input class=\"ui-ctl-element\" name=\"name\" @keyup=\"onTitleKeyUp\" ref=\"nameInput\" :placeholder=\"localize.SALESCENTER_ACTION_ADD_CUSTOM_NAME_PLACEHOLDER\" autocomplete=\"off\"/>\n\t\t\t\t</label>\n\t\t\t\t<input type=\"hidden\" name=\"id\" value=\"\" ref=\"idInput\" id=\"salescenter-app-add-custom-url-id\" />\n\t\t\t\t<input type=\"hidden\" name=\"isFrameDenied\" value=\"\" ref=\"isFrameDeniedInput\"/>\n\t\t\t\t<input type=\"hidden\" name=\"isWebform\" value=\"\" ref=\"isWebformInput\"/>\n\t\t\t\t<input type=\"hidden\" name=\"isSaved\" value=\"n\" id=\"salescenter-app-add-custom-url-is-saved\" ref=\"isSaved\" />\n\t\t\t</div>\n\t\t\t<div class=\"popup-window-buttons salescenter-add-custom-url-popup-buttons\">\n\t\t\t\t<button :class=\"{\n\t\t\t\t\t'ui-btn-disabled': this.urlCheckStatus < 10 || this.urlCheckStatus > 20\n\t\t\t\t}\" class=\"ui-btn ui-btn-md ui-btn-success\" @click=\"save\">{{localize.SALESCENTER_ACTION_ADD_CUSTOM_SAVE}}</button>\n\t\t\t\t<button class=\"ui-btn ui-btn-md ui-btn-link\" @click=\"cancel\">{{localize.SALESCENTER_CANCEL}}</button>\n\t\t\t</div>\n\t\t</div>\n\t`,\n\t});"],"names":["Vue","component","data","urlCheckStatus","errorMessage","previousUrl","isEmptyNameOnSave","isDefaultName","previousName","fieldsPopupMenuId","params","fieldsMap","created","$root","$on","setPageData","Set","checkUrlDebounce","BX","debounce","checkUrl","debounceCheckUrl","url","$refs","value","has","mounted","setTimeout","focus","beforeDestroy","$off","methods","onTitleKeyUp","add","length","$app","then","result","answer","indexOf","localize","SALESCENTER_ACTION_ADD_CUSTOM_NO_META","title","extra","effectiveUrl","isFrameDenied","error_description","save","forEach","param","push","chain","addPage","name","id","isWebform","page","addUrlPopup","close","cancel","fields","i","hasOwnProperty","input","Type","isArray","Manager","getFieldsMap","field","findFieldByParam","isString","getEntityField","items","entity","isPlainObject","parts","split","shift","join","openFieldsMenu","prepareFieldsMenu","PopupMenu","show","bindElement","offsetLeft","offsetTop","closeByEsc","zIndex","zIndexAbsolute","maxHeight","errors","pop","message","item","menu","text","Text","encode","dataset","rootMenu","onclick","selectField","removeParam","filter","computed","getFilteredPhrases","hasParams","template"],"mappings":"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"}