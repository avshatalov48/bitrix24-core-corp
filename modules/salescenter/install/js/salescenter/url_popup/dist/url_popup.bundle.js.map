{"version":3,"file":"url_popup.bundle.js","sources":["../src/url_popup.js"],"sourcesContent":["import {Type, Text} from 'main.core';\nimport {PopupMenu} from 'main.popup';\nimport {Vue} from 'ui.vue';\nimport {Manager} from 'salescenter.manager';\nimport './url_popup.css';\nimport 'ui.forms';\n\nVue.component('bx-salescenter-url-popup',\n\t{\n\t\tdata()\n\t\t{\n\t\t\treturn {\n\t\t\t\turlCheckStatus: 0,\n\t\t\t\terrorMessage: null,\n\t\t\t\tpreviousUrl: null,\n\t\t\t\tisEmptyNameOnSave: false,\n\t\t\t\tisDefaultName: false,\n\t\t\t\tpreviousName: null,\n\t\t\t\tfieldsPopupMenuId: 'salescenter-url-fields-popup',\n\t\t\t\tparams: [],\n\t\t\t\tfieldsMap: null,\n\t\t\t};\n\t\t},\n\t\tcreated()\n\t\t{\n\t\t\tthis.$root.$on('onAddUrlPopupCreate', this.setPageData);\n\t\t\tthis.previousUrl = new Set();\n\n\t\t\tlet checkUrlDebounce = BX.debounce(this.checkUrl, 1500, this);\n\t\t\tthis.debounceCheckUrl = () =>\n\t\t\t{\n\t\t\t\tlet url = this.$refs['urlInput'].value;\n\t\t\t\tif(this.previousUrl.has(url))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis.errorMessage = null;\n\t\t\t\tthis.urlCheckStatus = 0;\n\t\t\t\tcheckUrlDebounce();\n\t\t\t};\n\t\t},\n\t\tmounted()\n\t\t{\n\t\t\tsetTimeout(() =>\n\t\t\t{\n\t\t\t\tthis.$refs['urlInput'].focus();\n\t\t\t}, 100);\n\t\t},\n\t\tbeforeDestroy()\n\t\t{\n\t\t\tthis.$root.$off('onAddUrlPopupCreate', this.setPageData);\n\t\t},\n\t\tmethods:\n\t\t{\n\t\t\tonTitleKeyUp()\n\t\t\t{\n\t\t\t\tif(this.isDefaultName && this.$refs['nameInput'].value !== this.previousName)\n\t\t\t\t{\n\t\t\t\t\tthis.isDefaultName = false;\n\t\t\t\t\tthis.previousName = this.$refs['nameInput'].value;\n\t\t\t\t}\n\t\t\t},\n\t\t\tcheckUrl()\n\t\t\t{\n\t\t\t\tlet url = this.$refs['urlInput'].value;\n\t\t\t\tthis.$refs['isFrameDeniedInput'].value = '';\n\t\t\t\tthis.errorMessage = null;\n\t\t\t\tthis.urlCheckStatus = 0;\n\t\t\t\tthis.previousUrl = new Set();\n\t\t\t\tthis.previousUrl.add(url);\n\t\t\t\tif(url.length < 5)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis.urlCheckStatus = 1;\n\t\t\t\tthis.$root.$app.checkUrl(url).then((result) =>\n\t\t\t\t{\n\t\t\t\t\tthis.urlCheckStatus = 11;\n\t\t\t\t\tif(!result.answer.result)\n\t\t\t\t\t{\n\t\t\t\t\t\t//this.urlCheckStatus = 23;\n\t\t\t\t\t\tif(url.indexOf('http://') !== 0 && url.indexOf('https://') !== 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.$refs['urlInput'].value = 'http://' + url;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.errorMessage = this.localize.SALESCENTER_ACTION_ADD_CUSTOM_NO_META;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tif(this.$refs['nameInput'].value.length <= 0 || this.isDefaultName)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.$refs['nameInput'].value = result.answer.result.title;\n\t\t\t\t\t\t\tthis.isDefaultName = true;\n\t\t\t\t\t\t\tthis.previousName = this.$refs['nameInput'].value\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(result.answer.result.extra && result.answer.result.extra.effectiveUrl)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.$refs['urlInput'].value = result.answer.result.extra.effectiveUrl;\n\t\t\t\t\t\t\tthis.previousUrl.add(result.answer.result.extra.effectiveUrl);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.$refs['urlInput'].value = result.answer.result.url;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(result.answer.result.isFrameDenied === true)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.$refs['isFrameDeniedInput'].value = 'Y';\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.$refs['nameInput'].focus();\n\t\t\t\t\t}\n\t\t\t\t}).catch((result) =>\n\t\t\t\t{\n\t\t\t\t\tthis.urlCheckStatus = 22;\n\t\t\t\t\tthis.errorMessage = result.answer.error_description;\n\t\t\t\t});\n\t\t\t},\n\t\t\tsave()\n\t\t\t{\n\t\t\t\tthis.isEmptyNameOnSave = false;\n\t\t\t\tif(this.$refs['nameInput'].value.length <= 0)\n\t\t\t\t{\n\t\t\t\t\tthis.isEmptyNameOnSave = true;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif(this.urlCheckStatus > 10 && this.urlCheckStatus < 20)\n\t\t\t\t{\n\t\t\t\t\tlet params = [];\n\t\t\t\t\tthis.params.forEach((param) =>\n\t\t\t\t\t{\n\t\t\t\t\t\tparams.push(param.chain);\n\t\t\t\t\t});\n\t\t\t\t\tif(params.length <= 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tparams = 'false';\n\t\t\t\t\t}\n\t\t\t\t\tthis.$root.$app.addPage({\n\t\t\t\t\t\turl: this.$refs['urlInput'].value,\n\t\t\t\t\t\tname: this.$refs['nameInput'].value,\n\t\t\t\t\t\tid: this.$refs['idInput'].value,\n\t\t\t\t\t\tisFrameDenied: this.$refs['isFrameDeniedInput'].value,\n\t\t\t\t\t\tisWebform: this.$refs['isWebformInput'].value,\n\t\t\t\t\t\tparams,\n\t\t\t\t\t}).then((result) =>\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$refs['idInput'].value = result.answer.result.page.id;\n\t\t\t\t\t\tthis.$refs['isSaved'].value = 'y';\n\t\t\t\t\t\tif(this.$root.$app.addUrlPopup)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.$root.$app.addUrlPopup.close();\n\t\t\t\t\t\t}\n\t\t\t\t\t}).catch((result) =>\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.errorMessage = result.answer.error_description;\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t},\n\t\t\tcancel()\n\t\t\t{\n\t\t\t\tif(this.$root.$app.addUrlPopup)\n\t\t\t\t{\n\t\t\t\t\tthis.$root.$app.addUrlPopup.close();\n\t\t\t\t}\n\t\t\t},\n\t\t\tsetPageData(page = {\n\t\t\t\turl: '',\n\t\t\t\tname: '',\n\t\t\t\tid: 0,\n\t\t\t\tisWebform: '',\n\t\t\t\tparams: [],\n\t\t\t})\n\t\t\t{\n\t\t\t\tconst fields = ['url', 'name', 'id', 'isWebform'];\n\t\t\t\tfor(let i in fields)\n\t\t\t\t{\n\t\t\t\t\tlet name = fields[i];\n\t\t\t\t\tlet value = '';\n\t\t\t\t\tif(page.hasOwnProperty(name))\n\t\t\t\t\t{\n\t\t\t\t\t\tvalue = page[name];\n\t\t\t\t\t}\n\t\t\t\t\tlet input = this.$refs[name + 'Input'];\n\t\t\t\t\tif(input)\n\t\t\t\t\t{\n\t\t\t\t\t\tinput.value = value;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.checkUrl();\n\t\t\t\tthis.$refs['isSaved'].value = 'n';\n\t\t\t\tthis.params = [];\n\t\t\t\tif(Type.isArray(page.params) && page.params.length > 0)\n\t\t\t\t{\n\t\t\t\t\tManager.getFieldsMap().then((fields) =>\n\t\t\t\t\t{\n\t\t\t\t\t\tpage.params.forEach((param) =>\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlet field = this.findFieldByParam(fields, param.field);\n\t\t\t\t\t\t\tif(field)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.params.push(field);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t},\n\t\t\tfindFieldByParam(fields, param)\n\t\t\t{\n\t\t\t\tif(!Type.isArray(fields) || !Type.isString(param) || param.length <= 0)\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t\treturn this.getEntityField({items: fields}, param);\n\t\t\t},\n\t\t\tgetEntityField(entity, chain)\n\t\t\t{\n\t\t\t\tlet result = null;\n\t\t\t\tif(!Type.isPlainObject(entity) || !Type.isString(chain) || chain.length <= 0 || !entity.items || !Type.isArray(entity.items))\n\t\t\t\t{\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t\tlet parts = chain.split('.');\n\t\t\t\tentity.items.forEach((field) =>\n\t\t\t\t{\n\t\t\t\t\tif(!result)\n\t\t\t\t\t{\n\t\t\t\t\t\tif(field.name === parts[0])\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif(parts.length === 1)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tresult = field;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tparts.shift();\n\t\t\t\t\t\t\t\tresult = this.getEntityField(field, parts.join('.'));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\treturn result;\n\t\t\t},\n\t\t\topenFieldsMenu()\n\t\t\t{\n\t\t\t\tManager.getFieldsMap().then((fields) =>\n\t\t\t\t{\n\t\t\t\t\tfields = this.prepareFieldsMenu(fields);\n\t\t\t\t\tPopupMenu.show({\n\t\t\t\t\t\tid: this.fieldsPopupMenuId,\n\t\t\t\t\t\tbindElement: this.$refs['fieldsSelector'],\n\t\t\t\t\t\titems: fields,\n\t\t\t\t\t\toffsetLeft: 0,\n\t\t\t\t\t\toffsetTop: 0,\n\t\t\t\t\t\tcloseByEsc: true,\n\t\t\t\t\t\tzIndex: 2000,\n\t\t\t\t\t\tzIndexAbsolute: 2000,\n\t\t\t\t\t\tmaxHeight: 500,\n\t\t\t\t\t});\n\t\t\t\t}).catch((errors) =>\n\t\t\t\t{\n\t\t\t\t\tif(Type.isArray(errors))\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.errorMessage = errors.pop().message;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.errorMessage = errors;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\t\t\tprepareFieldsMenu(fields)\n\t\t\t{\n\t\t\t\tconst result = [];\n\t\t\t\tfields.forEach((item) =>\n\t\t\t\t{\n\t\t\t\t\tconst menu = {\n\t\t\t\t\t\ttext: Text.encode(item.title),\n\t\t\t\t\t\tdataset: {\n\t\t\t\t\t\t\trootMenu: this.fieldsPopupMenuId,\n\t\t\t\t\t\t},\n\t\t\t\t\t};\n\t\t\t\t\tif(Type.isArray(item.items))\n\t\t\t\t\t{\n\t\t\t\t\t\tmenu.items = this.prepareFieldsMenu(item.items);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tmenu.onclick = () =>\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.selectField(item);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tresult.push(menu);\n\t\t\t\t});\n\n\t\t\t\treturn result;\n\t\t\t},\n\t\t\tselectField(field)\n\t\t\t{\n\t\t\t\tthis.removeParam(field);\n\t\t\t\tthis.params.push(field);\n\t\t\t},\n\t\t\tremoveParam(param)\n\t\t\t{\n\t\t\t\tthis.params = this.params.filter((item) =>\n\t\t\t\t{\n\t\t\t\t\treturn (item.chain !== param.chain);\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\tcomputed:\n\t\t{\n\t\t\tlocalize()\n\t\t\t{\n\t\t\t\treturn Vue.getFilteredPhrases('SALESCENTER_');\n\t\t\t},\n\t\t\thasParams()\n\t\t\t{\n\t\t\t\treturn (this.params && this.params.length > 0);\n\t\t\t},\n\t\t},\n\t\ttemplate: `\n\t\t<div class=\"salescenter-add-custom-url-popup\">\n\t\t\t<div class=\"salescenter-add-custom-url-popup-form\">\n\t\t\t\t<div class=\"ui-ctl-label-text\">{{localize.SALESCENTER_ACTION_ADD_CUSTOM_INPUT}}</div>\n\t\t\t\t<div class=\"ui-ctl ui-ctl-ext-after-icon ui-ctl-textbox\" :class=\"{\n\t\t\t\t\t'ui-ctl-danger': this.urlCheckStatus > 20 || errorMessage, \n\t\t\t\t\t'ui-ctl-success': this.urlCheckStatus > 10 && this.urlCheckStatus < 20\n\t\t\t\t}\">\n\t\t\t\t\t<div class=\"ui-ctl-ext-after ui-ctl-icon-dots salescenter-url-params-selector\" @click=\"openFieldsMenu\" ref=\"fieldsSelector\"></div>\n\t\t\t\t\t<input name=\"url\" class=\"ui-ctl-element\" @keyup=\"debounceCheckUrl\" ref=\"urlInput\" :placeholder=\"localize.SALESCENTER_ACTION_ADD_CUSTOM_INPUT_PLACEHOLDER\" autocomplete=\"off\"/>\n\t\t\t\t</div>\n\t\t\t\t<div style=\"min-height: 20px;\">\n\t\t\t\t\t<template v-if=\"urlCheckStatus > 20 || errorMessage\" class=\"salescenter-url-message\">{{errorMessage}}</template>\n\t\t\t\t\t<template v-else-if=\"urlCheckStatus > 10\"></template>\n\t\t\t\t\t<template v-else-if=\"urlCheckStatus > 0\">{{localize.SALESCENTER_ACTION_ADD_CUSTOM_PENDING}}</template>\n\t\t\t\t</div>\n\t\t\t\t<label class=\"ui-ctl\" :class=\"{\n\t\t\t\t\t'hidden': !this.hasParams\n\t\t\t\t}\">\n\t\t\t\t\t<div class=\"ui-ctl-label-text\">{{localize.SALESCENTER_ACTION_URL_PARAMS}}</div>\n\t\t\t\t\t<div class=\"salescenter-url-params-field\">\n\t\t\t\t\t\t<div v-for=\"param in params\" class=\"salescenter-url-param\">\n\t\t\t\t\t\t\t<span class=\"salescenter-url-param-name\">{{param.fullName}}</span>\n\t\t\t\t\t\t\t<span class=\"salescenter-url-param-delete\" @click=\"removeParam(param)\"></span>\n\t\t\t\t\t    </div>\n\t\t\t\t    </div>\n\t\t\t\t</label>\n\t\t\t\t<div class=\"ui-ctl-label-text\">{{localize.SALESCENTER_ACTION_ADD_CUSTOM_NAME}}</div>\n\t\t\t\t<label class=\"ui-ctl ui-ctl-textbox\" :class=\"{\n\t\t\t\t\t'ui-ctl-danger': this.isEmptyNameOnSave\n\t\t\t\t}\">\n\t\t\t\t\t<input class=\"ui-ctl-element\" name=\"name\" @keyup=\"onTitleKeyUp\" ref=\"nameInput\" :placeholder=\"localize.SALESCENTER_ACTION_ADD_CUSTOM_NAME_PLACEHOLDER\" autocomplete=\"off\"/>\n\t\t\t\t</label>\n\t\t\t\t<input type=\"hidden\" name=\"id\" value=\"\" ref=\"idInput\" id=\"salescenter-app-add-custom-url-id\" />\n\t\t\t\t<input type=\"hidden\" name=\"isFrameDenied\" value=\"\" ref=\"isFrameDeniedInput\"/>\n\t\t\t\t<input type=\"hidden\" name=\"isWebform\" value=\"\" ref=\"isWebformInput\"/>\n\t\t\t\t<input type=\"hidden\" name=\"isSaved\" value=\"n\" id=\"salescenter-app-add-custom-url-is-saved\" ref=\"isSaved\" />\n\t\t\t</div>\n\t\t\t<div class=\"popup-window-buttons salescenter-add-custom-url-popup-buttons\">\n\t\t\t\t<button :class=\"{\n\t\t\t\t\t'ui-btn-disabled': this.urlCheckStatus < 10 || this.urlCheckStatus > 20\n\t\t\t\t}\" class=\"ui-btn ui-btn-md ui-btn-success\" @click=\"save\">{{localize.SALESCENTER_ACTION_ADD_CUSTOM_SAVE}}</button>\n\t\t\t\t<button class=\"ui-btn ui-btn-md ui-btn-link\" @click=\"cancel\">{{localize.SALESCENTER_CANCEL}}</button>\n\t\t\t</div>\n\t\t</div>\n\t`,\n\t});"],"names":["Vue","component","data","urlCheckStatus","errorMessage","previousUrl","isEmptyNameOnSave","isDefaultName","previousName","fieldsPopupMenuId","params","fieldsMap","created","$root","$on","setPageData","Set","checkUrlDebounce","BX","debounce","checkUrl","debounceCheckUrl","url","$refs","value","has","mounted","setTimeout","focus","beforeDestroy","$off","methods","onTitleKeyUp","add","length","$app","then","result","answer","indexOf","localize","SALESCENTER_ACTION_ADD_CUSTOM_NO_META","title","extra","effectiveUrl","isFrameDenied","catch","error_description","save","forEach","param","push","chain","addPage","name","id","isWebform","page","addUrlPopup","close","cancel","fields","i","hasOwnProperty","input","Type","isArray","Manager","getFieldsMap","field","findFieldByParam","isString","getEntityField","items","entity","isPlainObject","parts","split","shift","join","openFieldsMenu","prepareFieldsMenu","PopupMenu","show","bindElement","offsetLeft","offsetTop","closeByEsc","zIndex","zIndexAbsolute","maxHeight","errors","pop","message","item","menu","text","Text","encode","dataset","rootMenu","onclick","selectField","removeParam","filter","computed","getFilteredPhrases","hasParams","template"],"mappings":"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"}