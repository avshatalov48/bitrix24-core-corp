{"version":3,"file":"marketplace.bundle.js","sources":["../src/event-types.js","../src/tile-slider/app-local.js","../src/tile-slider/app-installed.js","../src/tile-slider/app-uninstalled.js","../src/app-slider.js"],"sourcesContent":["const EventTypes = {\n\tAppLocalSliderClose\t\t\t: 'app-local:slider-on-close',\n\tAppSliderSliderClose\t\t: 'app-slider:slider-on-close',\n\tAppUninstalledSliderClose\t: 'app-uninstalled:slider-on-close'\n};\n\nexport\n{\n\tEventTypes\n}","import {Manager} from 'salescenter.manager';\nimport * as Tile from 'salescenter.tile';\nimport {EventEmitter, BaseEvent} from 'main.core.events';\nimport {EventTypes} from \"../event-types\";\n\nclass AppLocal extends EventEmitter {\n\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Salescenter.TileSlider.AppSystem');\n\t}\n\n\topen(tile: Tile.Base, options = {})\n\t{\n\t\tthis.openLink(tile.link, options, {data:{type: tile.getType()}});\n\t}\n\n\topenLink(link, options = {}, eventOptions = {})\n\t{\n\t\tManager.openSlider(link, options).then(\n\t\t\t() => this.emit(EventTypes.AppLocalSliderClose, new BaseEvent(eventOptions)));\n\t}\n}\n\nexport{\n\tAppLocal\n}","import {Loc} from 'main.core';\nimport * as Tile from 'salescenter.tile';\n\nclass AppInstalled{\n\n\topen(tile: Tile.Base)\n\t{\n\t\tBX.ajax.runComponentAction(\n\t\t\t\"bitrix:salescenter.app\",\n\t\t\t\"getRestApp\",\n\t\t\t{\n\t\t\t\tdata: {\n\t\t\t\t\tcode: tile.code\n\t\t\t\t}\n\t\t\t}\n\t\t).then(function(response)\n\t\t{\n\t\t\tlet app = response.data;\n\t\t\tif(app.TYPE === \"A\")\n\t\t\t{\n\t\t\t\t// this.showRestApplication(code);  ???\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tBX.rest.AppLayout.openApplication(tile.id);\n\t\t\t}\n\t\t}.bind(this)).catch(function(response)\n\t\t{\n\t\t\tthis.errorPopup(\" \", response.errors.pop().message);\n\t\t}.bind(this));\n\t}\n\n\terrorPopup(title, text)\n\t{\n\t\tlet popup = new PopupWindow('rest-app-error-alert', null, {\n\t\t\tcloseIcon: true,\n\t\t\tcloseByEsc: true,\n\t\t\tautoHide: false,\n\t\t\ttitleBar: title,\n\t\t\tcontent: text,\n\t\t\tzIndex: 16000,\n\t\t\toverlay: {\n\t\t\t\tcolor: 'gray',\n\t\t\t\topacity: 30\n\t\t\t},\n\t\t\tbuttons: [\n\t\t\t\tnew PopupWindowButton({\n\t\t\t\t\t'id': 'close',\n\t\t\t\t\t'text': Loc.getMessage('SALESCENTER_JS_POPUP_CLOSE'),\n\t\t\t\t\t'events': {\n\t\t\t\t\t\t'click': function(){\n\t\t\t\t\t\t\tpopup.close();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t],\n\t\t\tevents: {\n\t\t\t\tonPopupClose: function() {\n\t\t\t\t\tthis.destroy();\n\t\t\t\t},\n\t\t\t\tonPopupDestroy: function() {\n\t\t\t\t\tpopup = null;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tpopup.show();\n\t}\n}\n\nexport\n{\n\tAppInstalled\n}","import {Manager} from 'salescenter.manager';\nimport {EventEmitter} from 'main.core.events';\nimport * as Tile from 'salescenter.tile';\nimport {EventTypes} from \"../event-types\";\n\nconst URL = '/marketplace/detail/#app#/';\n\nclass AppUninstalled extends EventEmitter {\n\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Salescenter.Marketplace.TileSlider.AppUninstalled');\n\t}\n\n\topen(tile: Tile.Base, options = {})\n\t{\n\t\tlet url = URL.replace(\"#app#\", encodeURIComponent(tile.code));\n\n\t\tManager.openSlider(url, options).then(\n\t\t\t() => this.emit(EventTypes.AppUninstalledSliderClose));\n\t}\n}\n\nexport{\n\tAppUninstalled\n}\n","import {EventTypes} from \"./event-types\";\nimport {AppLocal} from \"./tile-slider/app-local\";\nimport {AppInstalled} from \"./tile-slider/app-installed\";\nimport {AppUninstalled} from \"./tile-slider/app-uninstalled\";\nimport {EventEmitter, BaseEvent} from 'main.core.events';\nimport * as Tile from 'salescenter.tile';\n\nclass AppSlider extends EventEmitter {\n\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Salescenter.AppSlider');\n\t}\n\n\topenAppLocal(tile: Tile.Base, options = {})\n\t{\n\t\tif (tile.hasOwnProperty('width'))\n\t\t{\n\t\t\toptions.width = Number(tile.width);\n\t\t}\n\n\t\tif (tile.getType() === Tile.Marketplace.type())\n\t\t{\n\t\t\tthis.openApp(tile, options);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tlet system = new AppLocal();\n\t\t\tsystem.open(tile, options);\n\t\t\tsystem.subscribe(\n\t\t\t\tEventTypes.AppLocalSliderClose,\n\t\t\t\t(e) => this.emit(EventTypes.AppSliderSliderClose, new BaseEvent({data: e.data}))\n\t\t\t);\n\t\t}\n\t}\n\n\topenAppLocalLink(link, options = {})\n\t{\n\t\tlet system = new AppLocal();\n\t\tsystem.openLink(link, options);\n\t\tsystem.subscribe(\n\t\t\tEventTypes.AppLocalSliderClose,\n\t\t\t(e) => this.emit(EventTypes.AppSliderSliderClose, new BaseEvent({data: e.data}))\n\t\t);\n\t}\n\n\topenApp(tile: Tile.Marketplace, options = {})\n\t{\n\t\tif (tile.isInstalled())\n\t\t{\n\t\t\t(new AppInstalled()).open(tile);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tlet uninstalled = new AppUninstalled();\n\t\t\tuninstalled.open(tile, options);\n\t\t\tuninstalled.subscribe(\n\t\t\t\tEventTypes.AppUninstalledSliderClose,\n\t\t\t\t() => this.emit(EventTypes.AppSliderSliderClose, new BaseEvent({data:{type: Tile.Marketplace.type()}})));\n\t\t}\n\t}\n}\n\nexport{\n\tAppSlider\n}"],"names":["EventTypes","AppLocalSliderClose","AppSliderSliderClose","AppUninstalledSliderClose","AppLocal","setEventNamespace","tile","options","openLink","link","data","type","getType","eventOptions","Manager","openSlider","then","emit","BaseEvent","EventEmitter","AppInstalled","BX","ajax","runComponentAction","code","response","app","TYPE","rest","AppLayout","openApplication","id","bind","errorPopup","errors","pop","message","title","text","popup","PopupWindow","closeIcon","closeByEsc","autoHide","titleBar","content","zIndex","overlay","color","opacity","buttons","PopupWindowButton","Loc","getMessage","close","events","onPopupClose","destroy","onPopupDestroy","show","URL","AppUninstalled","url","replace","encodeURIComponent","AppSlider","hasOwnProperty","width","Number","Tile","openApp","system","open","subscribe","e","isInstalled","uninstalled"],"mappings":"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"}