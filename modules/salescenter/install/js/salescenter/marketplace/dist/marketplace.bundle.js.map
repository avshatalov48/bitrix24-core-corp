{"version":3,"file":"marketplace.bundle.js","sources":["../src/event-types.js","../src/tile-slider/app-local.js","../src/tile-slider/app-installed.js","../src/tile-slider/app-uninstalled.js","../src/app-slider.js"],"sourcesContent":["const EventTypes = {\n\tAppLocalSliderClose\t\t\t: 'app-local:slider-on-close',\n\tAppSliderSliderClose\t\t: 'app-slider:slider-on-close',\n\tAppUninstalledSliderClose\t: 'app-uninstalled:slider-on-close'\n};\n\nexport\n{\n\tEventTypes\n}","import {Manager} from 'salescenter.manager';\nimport * as Tile from 'salescenter.tile';\nimport {EventEmitter, BaseEvent} from 'main.core.events';\nimport {EventTypes} from \"../event-types\";\n\nclass AppLocal extends EventEmitter {\n\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Salescenter.TileSlider.AppSystem');\n\t}\n\n\topen(tile: Tile.Base, options = {})\n\t{\n\t\tthis.openLink(tile.link, options, {data:{type: tile.getType()}});\n\t}\n\n\topenLink(link, options = {}, eventOptions = {})\n\t{\n\t\tManager.openSlider(link, options).then(\n\t\t\t() => this.emit(EventTypes.AppLocalSliderClose, new BaseEvent(eventOptions)));\n\t}\n}\n\nexport{\n\tAppLocal\n}","import {Loc} from 'main.core';\nimport * as Tile from 'salescenter.tile';\n\nclass AppInstalled{\n\n\topen(tile: Tile.Base)\n\t{\n\t\tBX.ajax.runComponentAction(\n\t\t\t\"bitrix:salescenter.app\",\n\t\t\t\"getRestApp\",\n\t\t\t{\n\t\t\t\tdata: {\n\t\t\t\t\tcode: tile.code\n\t\t\t\t}\n\t\t\t}\n\t\t).then(function(response)\n\t\t{\n\t\t\tlet app = response.data;\n\t\t\tif(app.TYPE === \"A\")\n\t\t\t{\n\t\t\t\t// this.showRestApplication(code);  ???\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tBX.rest.AppLayout.openApplication(tile.id);\n\t\t\t}\n\t\t}.bind(this)).catch(function(response)\n\t\t{\n\t\t\tthis.errorPopup(\" \", response.errors.pop().message);\n\t\t}.bind(this));\n\t}\n\n\terrorPopup(title, text)\n\t{\n\t\tlet popup = new PopupWindow('rest-app-error-alert', null, {\n\t\t\tcloseIcon: true,\n\t\t\tcloseByEsc: true,\n\t\t\tautoHide: false,\n\t\t\ttitleBar: title,\n\t\t\tcontent: text,\n\t\t\tzIndex: 16000,\n\t\t\toverlay: {\n\t\t\t\tcolor: 'gray',\n\t\t\t\topacity: 30\n\t\t\t},\n\t\t\tbuttons: [\n\t\t\t\tnew PopupWindowButton({\n\t\t\t\t\t'id': 'close',\n\t\t\t\t\t'text': Loc.getMessage('SALESCENTER_JS_POPUP_CLOSE'),\n\t\t\t\t\t'events': {\n\t\t\t\t\t\t'click': function(){\n\t\t\t\t\t\t\tpopup.close();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t],\n\t\t\tevents: {\n\t\t\t\tonPopupClose: function() {\n\t\t\t\t\tthis.destroy();\n\t\t\t\t},\n\t\t\t\tonPopupDestroy: function() {\n\t\t\t\t\tpopup = null;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tpopup.show();\n\t}\n}\n\nexport\n{\n\tAppInstalled\n}","import {Manager} from 'salescenter.manager';\nimport {EventEmitter} from 'main.core.events';\nimport * as Tile from 'salescenter.tile';\nimport {EventTypes} from \"../event-types\";\n\nconst URL = '/marketplace/detail/#app#/';\n\nclass AppUninstalled extends EventEmitter {\n\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Salescenter.Marketplace.TileSlider.AppUninstalled');\n\t}\n\n\topen(tile: Tile.Base, options = {})\n\t{\n\t\tlet url = URL.replace(\"#app#\", encodeURIComponent(tile.code));\n\n\t\tManager.openSlider(url, options).then(\n\t\t\t() => this.emit(EventTypes.AppUninstalledSliderClose));\n\t}\n}\n\nexport{\n\tAppUninstalled\n}\n","import {EventTypes} from \"./event-types\";\nimport {AppLocal} from \"./tile-slider/app-local\";\nimport {AppInstalled} from \"./tile-slider/app-installed\";\nimport {AppUninstalled} from \"./tile-slider/app-uninstalled\";\nimport {EventEmitter, BaseEvent} from 'main.core.events';\nimport * as Tile from 'salescenter.tile';\n\nclass AppSlider extends EventEmitter {\n\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Salescenter.AppSlider');\n\t}\n\n\topenAppLocal(tile: Tile.Base, options = {})\n\t{\n\t\tif (tile.hasOwnProperty('width'))\n\t\t{\n\t\t\toptions.width = Number(tile.width);\n\t\t}\n\n\t\tif (tile.getType() === Tile.Marketplace.type())\n\t\t{\n\t\t\tthis.openApp(tile, options);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tlet system = new AppLocal();\n\t\t\tsystem.open(tile, options);\n\t\t\tsystem.subscribe(\n\t\t\t\tEventTypes.AppLocalSliderClose,\n\t\t\t\t(e) => this.emit(EventTypes.AppSliderSliderClose, new BaseEvent({data: e.data}))\n\t\t\t);\n\t\t}\n\t}\n\n\topenAppLocalLink(link, options = {})\n\t{\n\t\tlet system = new AppLocal();\n\t\tsystem.openLink(link, options);\n\t\tsystem.subscribe(\n\t\t\tEventTypes.AppLocalSliderClose,\n\t\t\t(e) => this.emit(EventTypes.AppSliderSliderClose, new BaseEvent({data: e.data}))\n\t\t);\n\t}\n\n\topenApp(tile: Tile.Marketplace, options = {})\n\t{\n\t\tif (tile.isInstalled())\n\t\t{\n\t\t\t(new AppInstalled()).open(tile);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tlet uninstalled = new AppUninstalled();\n\t\t\tuninstalled.open(tile, options);\n\t\t\tuninstalled.subscribe(\n\t\t\t\tEventTypes.AppUninstalledSliderClose,\n\t\t\t\t() => this.emit(EventTypes.AppSliderSliderClose, new BaseEvent({data:{type: Tile.Marketplace.type()}})));\n\t\t}\n\t}\n}\n\nexport{\n\tAppSlider\n}"],"names":["EventTypes","AppLocalSliderClose","AppSliderSliderClose","AppUninstalledSliderClose","AppLocal","setEventNamespace","tile","options","openLink","link","data","type","getType","eventOptions","Manager","openSlider","then","emit","BaseEvent","EventEmitter","AppInstalled","BX","ajax","runComponentAction","code","response","app","TYPE","rest","AppLayout","openApplication","id","bind","catch","errorPopup","errors","pop","message","title","text","popup","PopupWindow","closeIcon","closeByEsc","autoHide","titleBar","content","zIndex","overlay","color","opacity","buttons","PopupWindowButton","Loc","getMessage","close","events","onPopupClose","destroy","onPopupDestroy","show","URL","AppUninstalled","url","replace","encodeURIComponent","AppSlider","hasOwnProperty","width","Number","Tile","openApp","system","open","subscribe","e","isInstalled","uninstalled"],"mappings":"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"}