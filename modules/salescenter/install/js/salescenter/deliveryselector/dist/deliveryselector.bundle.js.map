{"version":3,"file":"deliveryselector.bundle.js","sources":["../src/properties/string.js","../src/closabledirective.js","../src/properties/address.js","../src/services/checkbox.js","../src/services/dropdown.js","../src/deliveryselector.js"],"sourcesContent":["export default {\n\tprops: {\n\t\tname: {type: String, required: true},\n\t\tinitValue: {required: false},\n\t\tsettings: {required: false},\n\t\toptions: {required: false},\n\t},\n\tcreated()\n\t{\n\t\tthis.value = this.initValue;\n\t},\n\tdata()\n\t{\n\t\treturn {\n\t\t\tvalue: null,\n\t\t}\n\t},\n\tmethods: {\n\t\tonInput(event)\n\t\t{\n\t\t\tthis.value = event.target.value;\n\n\t\t\tthis.$emit('change', this.value);\n\t\t}\n\t},\n\tcomputed: {\n\t\tisMultiline()\n\t\t{\n\t\t\treturn (this.settings && this.settings.MULTILINE === 'Y');\n\t\t}\n\t},\n\ttemplate: `\n\t\t<div class=\"ui-ctl ui-ctl-w100\">\n\t\t\t<textarea v-if=\"isMultiline\" @input=\"onInput\" :name=\"name\" class=\"ui-ctl-element salescenter-delivery-comment-textarea\" rows=\"1\">{{value}}</textarea>\n\t\t\t<input v-else @input=\"onInput\" type=\"text\" :name=\"name\" :value=\"value\" class=\"ui-ctl-element ui-ctl-textbox\" />\n\t\t</div>\t\t\t\t\t\n\t`\n};\n","let handleOutsideClick;\n\nexport default {\n\tbind (el, binding, vnode) {\n\t\thandleOutsideClick = (e) => {\n\t\t\tif (e.type === 'mousedown' && e.which !== 1)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\te.stopPropagation();\n\t\t\tconst { handler, exclude } = binding.value;\n\t\t\tlet clickedOnExcludedEl = false;\n\t\t\texclude.forEach(refName => {\n\t\t\t\tif (!clickedOnExcludedEl) {\n\t\t\t\t\tconst excludedEl = vnode.context.$refs[refName];\n\t\t\t\t\tif (excludedEl)\n\t\t\t\t\t{\n\t\t\t\t\t\tclickedOnExcludedEl = excludedEl.contains(e.target);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t/**\n\t\t\t * Click inside map wrapper\n\t\t\t */\n\t\t\tif (e.target.closest('.location-map-wrapper'))\n\t\t\t{\n\t\t\t\tclickedOnExcludedEl = true;\n\t\t\t}\n\n\t\t\tif (!el.contains(e.target) && !clickedOnExcludedEl) {\n\t\t\t\tvnode.context[handler]()\n\t\t\t}\n\t\t};\n\t\tdocument.addEventListener('mousedown', handleOutsideClick);\n\t\tdocument.addEventListener('touchstart', handleOutsideClick);\n\t},\n\n\tunbind () {\n\t\tdocument.removeEventListener('mousedown', handleOutsideClick);\n\t\tdocument.removeEventListener('touchstart', handleOutsideClick);\n\t}\n};\n","import {Vue} from 'ui.vue';\nimport ClosableDirective from '../closabledirective';\nimport {Location} from 'location.core';\nimport {State, AutocompleteFeature} from 'location.widget'\nimport 'ui.notification';\nimport '../css/address.css';\n\nexport default\n{\n\tdirectives: {\n\t\tclosable: ClosableDirective\n\t},\n\tprops: {\n\t\tname: {type: String, required: true},\n\t\tinitValue: {},\n\t\tsettings: {},\n\t\toptions: {required: false},\n\t\tisStartMarker: {type: Boolean, required: true},\n\t},\n\tdata()\n\t{\n\t\treturn {\n\t\t\tvalue: null,\n\t\t\tenterTookPlace: false,\n\t\t\trightIcon: null,\n\t\t\tisEntering: false,\n\t\t\tisLoading: false,\n\t\t\teditMode: false,\n\t\t\taddressWidgetState: null,\n\t\t\tenteredAddresses: [],\n\t\t}\n\t},\n\tmethods: {\n\t\tswitchToEditMode()\n\t\t{\n\t\t\tthis.showMap();\n\t\t\tthis.editMode = true;\n\t\t},\n\t\tclarifyAddress()\n\t\t{\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.$refs['input-node'].focus();\n\t\t\t\tthis.$refs['input-node'].click();\n\t\t\t\tthis.$refs['input-node'].click();\n\t\t\t}, 0);\n\t\t},\n\t\tclearAddress()\n\t\t{\n\t\t\tthis.addressWidget.address = null;\n\t\t\tthis.changeValue(null);\n\t\t\tthis.clarifyAddress();\n\t\t},\n\t\tonControlClicked()\n\t\t{\n\t\t\tthis.closeMap();\n\t\t},\n\t\tonControlFocus()\n\t\t{\n\t\t\tthis.enterTookPlace = true;\n\t\t\tthis.isEntering = true;\n\t\t},\n\t\tonControlBlur()\n\t\t{\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.isEntering = false;\n\t\t\t}, 200)\n\n\t\t\tthis.editMode = false;\n\n\t\t\tthis.closeMap();\n\t\t},\n\t\tchangeValue(newValue)\n\t\t{\n\t\t\tthis.value = newValue;\n\n\t\t\tthis.syncRightIcon();\n\n\t\t\tthis.$emit('change', this.value);\n\n\t\t\tif (this.onChangeCallback)\n\t\t\t{\n\t\t\t\tthis.onChangeCallback();\n\t\t\t}\n\t\t},\n\t\tsyncRightIcon()\n\t\t{\n\t\t\tif (this.$refs['input-node'].value.length === 0)\n\t\t\t{\n\t\t\t\tthis.rightIcon = 'search';\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.rightIcon = 'clear';\n\t\t\t}\n\t\t},\n\t\tbuildAddress(value)\n\t\t{\n\t\t\ttry\n\t\t\t{\n\t\t\t\treturn new BX.Location.Core.Address(JSON.parse(value));\n\t\t\t}\n\t\t\tcatch(e)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\t\t},\n\t\tisValueValid(value)\n\t\t{\n\t\t\treturn (\n\t\t\t\tvalue\n\t\t\t\t&& value.latitude\n\t\t\t\t&& value.longitude\n\t\t\t\t&& !(value.latitude === '0' && value.longitude === '0')\n\t\t\t);\n\t\t},\n\t\tgetPresetLocationsProvider()\n\t\t{\n\t\t\treturn () => {\n\t\t\t\tlet result = this.options && this.options.hasOwnProperty('defaultItems')\n\t\t\t\t\t? this.options.defaultItems.map((item) => new Location(item))\n\t\t\t\t\t: [];\n\n\t\t\t\tfor (let enteredAddress of this.enteredAddresses)\n\t\t\t\t{\n\t\t\t\t\tlet location = enteredAddress.toLocation();\n\t\t\t\t\tif (!location)\n\t\t\t\t\t{\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\tlocation.name = BX.Location.Core.AddressStringConverter.convertAddressToString(\n\t\t\t\t\t\tenteredAddress,\n\t\t\t\t\t\tthis.addressWidget.addressFormat,\n\t\t\t\t\t\tBX.Location.Core.AddressStringConverter.STRATEGY_TYPE_FIELD_TYPE,\n\t\t\t\t\t\tBX.Location.Core.AddressStringConverter.CONTENT_TYPE_TEXT\n\t\t\t\t\t);\n\n\t\t\t\t\tresult.push(location);\n\t\t\t\t}\n\n\t\t\t\treturn result.filter((location, index, self) =>\n\t\t\t\t\tindex === self.findIndex((l) => (\n\t\t\t\t\t\tl.name === location.name\n\t\t\t\t\t))\n\t\t\t\t);\n\t\t\t};\n\t\t},\n\t\t/**\n\t\t * Map Feature Methods\n\t\t */\n\t\tgetMap()\n\t\t{\n\t\t\tif (!this.addressWidget)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tfor( let feature of this.addressWidget.features)\n\t\t\t{\n\t\t\t\tif(feature instanceof BX.Location.Widget.MapFeature)\n\t\t\t\t{\n\t\t\t\t\treturn feature;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn null;\n\t\t},\n\t\tshowMap()\n\t\t{\n\t\t\tlet map = this.getMap();\n\n\t\t\tif (map)\n\t\t\t{\n\t\t\t\tmap.showMap();\n\t\t\t}\n\t\t},\n\t\tcloseMap()\n\t\t{\n\t\t\tlet map = this.getMap();\n\n\t\t\tif (map)\n\t\t\t{\n\t\t\t\tmap.closeMap();\n\t\t\t}\n\t\t},\n\t},\n\tcomputed: {\n\t\taddressFormatted()\n\t\t{\n\t\t\tif(!this.value || !this.addressWidget)\n\t\t\t{\n\t\t\t\treturn '';\n\t\t\t}\n\n\t\t\tlet address = this.buildAddress(this.value);\n\t\t\tif (!address)\n\t\t\t{\n\t\t\t\treturn '';\n\t\t\t}\n\n\t\t\treturn address.toString(\n\t\t\t\tthis.addressWidget.addressFormat,\n\t\t\t\tBX.Location.Core.AddressStringConverter.STRATEGY_TYPE_FIELD_SORT\n\t\t\t);\n\t\t},\n\t\tisEditMode()\n\t\t{\n\t\t\treturn this.editMode || !this.value;\n\t\t},\n\t\twrapperClass()\n\t\t{\n\t\t\treturn {\n\t\t\t\t'ui-ctl': true,\n\t\t\t\t'ui-ctl-textbox': true,\n\t\t\t\t'ui-ctl-danger': this.needsClarification,\n\t\t\t\t'ui-ctl-w100': true,\n\t\t\t\t'ui-ctl-after-icon': true,\n\t\t\t\t'sale-address-control-top-margin-5 sale-address-control-top-margin-width-820': this.isEditMode\n\t\t\t}\n\t\t},\n\t\tmapMarkerClass()\n\t\t{\n\t\t\treturn {\n\t\t\t\t'salescenter-delivery-path-icon': true,\n\t\t\t\t'salescenter-delivery-path-icon--green': !this.isStartMarker\n\t\t\t};\n\t\t},\n\t\trightIconClass()\n\t\t{\n\t\t\treturn {\n\t\t\t\t'ui-ctl-after': true,\n\t\t\t\t'ui-ctl-icon-btn': true,\n\t\t\t\t'ui-ctl-icon-search': (this.rightIcon === 'search'),\n\t\t\t\t'ui-ctl-icon-clear': (this.rightIcon === 'clear'),\n\t\t\t\t'sale-address-control-path-input-clear': true,\n\t\t\t};\n\t\t},\n\t\tneedsClarification()\n\t\t{\n\t\t\treturn (\n\t\t\t\t!this.isEntering\n\t\t\t\t&& this.enterTookPlace\n\t\t\t\t&& !this.value\n\t\t\t\t&& this.addressWidgetState !== State.DATA_LOADING\n\t\t\t);\n\t\t},\n\t\tlocalize()\n\t\t{\n\t\t\treturn Vue.getFilteredPhrases('SALE_DELIVERY_SERVICE_SELECTOR_');\n\t\t},\n\t},\n\tmounted()\n\t{\n\t\tif (this.initValue)\n\t\t{\n\t\t\tlet initValue = null;\n\t\t\tlet address = JSON.parse(this.initValue);\n\n\t\t\tif (this.isValueValid(address))\n\t\t\t{\n\t\t\t\tinitValue = this.initValue;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t/**\n\t\t\t\t * Simulate invalid input\n\t\t\t\t */\n\t\t\t\tthis.isEntering = false;\n\t\t\t\tthis.enterTookPlace = true;\n\t\t\t}\n\n\t\t\tthis.changeValue(initValue);\n\t\t}\n\n\t\tthis.addressWidget = (new BX.Location.Widget.Factory).createAddressWidget({\n\t\t\taddress: this.initValue ? this.buildAddress(this.initValue) : null,\n\t\t\tmode: BX.Location.Core.ControlMode.edit,\n\t\t\tmapBehavior: 'manual',\n\t\t\tuseFeatures: {\n\t\t\t\tfields: false,\n\t\t\t\tmap: true,\n\t\t\t\tautocomplete: true\n\t\t\t},\n\t\t\tpopupOptions: {\n\t\t\t\toffsetLeft: 14,\n\t\t\t},\n\t\t\tpopupBindOptions: {\n\t\t\t\tforceBindPosition: true,\n\t\t\t},\n\t\t\tpresetLocationsProvider: this.getPresetLocationsProvider()\n\t\t});\n\n\t\t/**\n\t\t * Redefine native onInputKeyup\n\t\t */\n\t\tconst nativeOnInputKeyup = this.addressWidget.onInputKeyup;\n\t\tthis.addressWidget.onInputKeyup = (e: KeyboardEvent) =>\n\t\t{\n\t\t\tswitch (e.code)\n\t\t\t{\n\t\t\t\tcase 'Enter':\n\t\t\t\tcase 'NumpadEnter':\n\t\t\t\t\treturn;\n\t\t\t\tdefault:\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tnativeOnInputKeyup.call(this.addressWidget, e);\n\t\t};\n\n\t\t/**\n\t\t * Subscribe to widget events\n\t\t */\n\t\tthis.addressWidget.subscribeOnAddressChangedEvent((event) => {\n\t\t\tlet data = event.getData();\n\n\t\t\tthis.editMode = true;\n\n\t\t\tlet address = data.address;\n\n\t\t\tif (!this.isValueValid(address))\n\t\t\t{\n\t\t\t\tthis.changeValue(null);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.enteredAddresses.push(address);\n\t\t\t\tthis.changeValue(address.toJson());\n\t\t\t\tthis.showMap();\n\t\t\t}\n\t\t});\n\n\t\tthis.addressWidget.subscribeOnStateChangedEvent((event) => {\n\t\t\tlet data = event.getData();\n\n\t\t\tthis.addressWidgetState = data.state;\n\n\t\t\tif (data.state === State.DATA_INPUTTING)\n\t\t\t{\n\t\t\t\tthis.changeValue(null);\n\t\t\t\tthis.closeMap();\n\t\t\t}\n\t\t\telse if (data.state === State.DATA_LOADING)\n\t\t\t{\n\t\t\t\tthis.isLoading = true;\n\t\t\t}\n\t\t\telse if (data.state === State.DATA_LOADED)\n\t\t\t{\n\t\t\t\tthis.isLoading = false;\n\t\t\t}\n\t\t});\n\n\t\tthis.addressWidget.subscribeOnFeatureEvent((event) => {\n\t\t\tlet data = event.getData();\n\n\t\t\tif (data.feature instanceof AutocompleteFeature)\n\t\t\t{\n\t\t\t\tif (data.eventCode === AutocompleteFeature.searchStartedEvent)\n\t\t\t\t{\n\t\t\t\t\tthis.isLoading = true;\n\t\t\t\t}\n\t\t\t\telse if (data.eventCode === AutocompleteFeature.searchCompletedEvent)\n\t\t\t\t{\n\t\t\t\t\tthis.isLoading = false;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tthis.addressWidget.subscribeOnErrorEvent((event) => {\n\t\t\tlet data = event.getData();\n\t\t\tlet errors = data.errors;\n\t\t\tlet errorMessage = errors\n\t\t\t\t.map((error) => error.message + (error.code.length ? `${error.code}` : ''))\n\t\t\t\t.join(', ');\n\n\t\t\tthis.isLoading = false;\n\n\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\tcontent: errorMessage,\n\t\t\t});\n\t\t});\n\n\t\t/**\n\t\t * Render widget\n\t\t */\n\t\tthis.addressWidget.render({\n\t\t\tinputNode: this.$refs['input-node'],\n\t\t\tautocompleteMenuElement: this.$refs['autocomplete-menu'],\n\t\t\tmapBindElement: this.$refs['map-marker'],\n\t\t\tcontrolWrapper: this.$refs['autocomplete-menu'],\n\t\t});\n\n\t\tthis.syncRightIcon();\n\t},\n\ttemplate: `\n\t\t<div class=\"salescenter-delivery-path-control\">\n\t\t\t<div ref=\"map-marker\" :class=\"mapMarkerClass\"></div>\n\t\t\t\t<div\n\t\t\t\t\tv-closable=\"{\n\t\t\t\t\t\texclude: ['input-node'],\n\t\t\t\t\t\thandler: 'onControlBlur'\n\t\t\t\t\t}\"\n\t\t\t\t\tclass=\"ui-ctl-w100\"\n\t\t\t\t>\n\t\t\t\t\t<div :class=\"wrapperClass\">\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tv-show=\"isLoading\"\n\t\t\t\t\t\t\tclass=\"ui-ctl-after ui-ctl-icon-loader\"\n\t\t\t\t\t\t></div>\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tv-show=\"isEditMode\" \n\t\t\t\t\t\t\tref=\"autocomplete-menu\"\n\t\t\t\t\t\t\tclass=\"sale-address-control-path-input-wrapper\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t@click=\"onControlClicked\"\n\t\t\t\t\t\t\t\t@focus=\"onControlFocus\"\n\t\t\t\t\t\t\t\tref=\"input-node\"\n\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\tclass=\"ui-ctl-element\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tv-show=\"!isLoading && isEditMode\"\n\t\t\t\t\t\t\t\t@click=\"clearAddress\"\n\t\t\t\t\t\t\t\t@mouseover.stop.prevent=\"\"\n\t\t\t\t\t\t\t\t:class=\"rightIconClass\"\n\t\t\t\t\t\t\t></div>\n\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\tv-show=\"needsClarification\"\n\t\t\t\t\t\t\t\t@mouseover.stop.prevent=\"\"\n\t\t\t\t\t\t\t\t@click=\"clarifyAddress\"\n\t\t\t\t\t\t\t\tclass=\"sale-address-control-path-input--alert\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{{localize.SALE_DELIVERY_SERVICE_SELECTOR_CLARIFY_ADDRESS}}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div v-show=\"!isEditMode\"class=\"sale-address-control-path-input-wrapper\">\n\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t@click=\"switchToEditMode\"\n\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\tclass=\"ui-ctl-element ui-ctl-textbox sale-address-control-path-input\"\n\t\t\t\t\t\t\t\tcontenteditable=\"false\"\n\t\t\t\t\t\t\t\tv-html=\"addressFormatted\"\n\t\t\t\t\t\t\t></span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<input v-model=\"value\" :name=\"name\" type=\"hidden\" />\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`\n};\n","export default {\n\tprops: {\n\t\tname: {required: false},\n\t\tinitValue: {required: false},\n\t},\n\tcreated()\n\t{\n\t\tthis.value = this.initValue;\n\t},\n\tdata()\n\t{\n\t\treturn {\n\t\t\tvalue: null\n\t\t}\n\t},\n\tmethods: {\n\t\tonChange(event)\n\t\t{\n\t\t\tthis.value =  event.target.checked ? 'Y' : '';\n\t\t\tthis.$emit('change', this.value);\n\t\t}\n\t},\n\ttemplate: `\n\t\t<label class=\"salescenter-delivery-selector salescenter-delivery-selector--hover salescenter-delivery-selector--checkbox\">\n\t\t\t<input @change=\"onChange\" :checked=\"value == 'Y' ? true : false\" type=\"checkbox\" value=\"Y\" />\n\t\t\t<span class=\"salescenter-delivery-selector-text\">{{name}}</span>\n\t\t</label>\n\t`\n};\n","import {Menu} from 'main.popup'\n\nexport default {\n\tprops: {\n\t\tname: {required: false},\n\t\tinitValue: {required: false},\n\t\toptions: {required: true, type: Array}\n\t},\n\tcreated()\n\t{\n\t\tthis.value = this.initValue;\n\t},\n\tdata()\n\t{\n\t\treturn {\n\t\t\tvalue: null\n\t\t}\n\t},\n\tmethods: {\n\t\tgetSelectedItemTitle()\n\t\t{\n\t\t\tlet selectedItem = this.getSelectedItem();\n\t\t\tif (!selectedItem || selectedItem.id === 'null')\n\t\t\t{\n\t\t\t\treturn this.name;\n\t\t\t}\n\t\t\treturn selectedItem.title;\n\t\t},\n\t\tgetSelectedItem()\n\t\t{\n\t\t\tfor (let option of this.options)\n\t\t\t{\n\t\t\t\tif (option.id === this.value)\n\t\t\t\t{\n\t\t\t\t\treturn option;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn null;\n\t\t},\n\n\t\tshowPopupMenu(e)\n\t\t{\n\t\t\tlet menuItems = [];\n\t\t\tfor (let option of this.options)\n\t\t\t{\n\t\t\t\tmenuItems.push(\n\t\t\t\t\t{\n\t\t\t\t\t\t'text': option.title,\n\t\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\t\tthis.value =  option.id;\n\t\t\t\t\t\t\tthis.$emit('change', this.value);\n\n\t\t\t\t\t\t\tthis.popupMenu.close();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tthis.popupMenu = new Menu({\n\t\t\t\tbindElement: e.target,\n\t\t\t\titems: menuItems,\n\t\t\t\tangle: true,\n\t\t\t\tcloseByEsc: true,\n\t\t\t\toffsetLeft: 40,\n\t\t\t});\n\n\t\t\tthis.popupMenu.show();\n\t\t}\n\t},\n\ttemplate: `\n\t\t<div @click=\"showPopupMenu($event)\" class=\"salescenter-delivery-selector salescenter-delivery-selector--dropdown\">\n\t\t\t<span class=\"salescenter-delivery-selector-text\">{{getSelectedItemTitle()}}</span>\n\t\t</div>\n\t`\n};\n","import {Vue} from 'ui.vue';\nimport {ajax} from 'main.core';\nimport {Manager} from 'salescenter.manager';\nimport {Ears} from 'ui.ears';\nimport StringControl from './properties/string';\nimport AddressControl from './properties/address';\nimport CheckboxService from './services/checkbox';\nimport DropdownService from './services/dropdown';\nimport Hint from 'salescenter.component.stage-block.hint';\nimport {Tag, Text} from 'main.core';\nimport {Loc} from 'main.core';\nimport 'currency';\n\nimport 'ui.design-tokens';\nimport 'ui.fonts.opensans';\nimport './css/deliveryselector.css';\n\nexport default {\n\tcomponents: {\n\t\t/**\n\t\t * Properties Control Types\n\t\t */\n\t\t'ADDRESS-control': AddressControl,\n\t\t'STRING-control': StringControl,\n\t\t/**\n\t\t * Extra Services Control Types\n\t\t */\n\t\t'checkbox-service': CheckboxService,\n\t\t'dropdown-service': DropdownService,\n\t},\n\tprops: {\n\t\tinitDeliveryServiceId: {required: false},\n\t\tinitRelatedServicesValues: {required: false},\n\t\tinitRelatedPropsValues: {required: false},\n\t\tinitRelatedPropsOptions: {required: false},\n\t\tinitResponsibleId: {default: null, required: false},\n\t\tinitEnteredDeliveryPrice: {required: false},\n\t\tpersonTypeId: {required: true},\n\t\taction: {type: String, required: true },\n\t\tactionData: {type: Object, required: true },\n\t\texternalSum: {required: true},\n\t\texternalSumLabel: {type: String, required: true},\n\t\tcurrency: {type: String, required: true},\n\t\tcurrencySymbol: {type: String, required: true},\n\t\tavailableServices: {type: [Object, Array], required: true},\n\t\texcludedServiceIds: {type: Array, required: true},\n\t},\n\tdata()\n\t{\n\t\treturn {\n\t\t\t/**\n\t\t\t * Selected Service\n\t\t\t */\n\t\t\tselectedDeliveryService: null,\n\t\t\tdeliveryServices: [],\n\n\t\t\t/**\n\t\t\t * Props\n\t\t\t */\n\t\t\trelatedProps: [],\n\t\t\trelatedPropsOfAddressType: [],\n\t\t\trelatedPropsOfOtherTypes: [],\n\t\t\trelatedPropsValues: {},\n\n\t\t\t/**\n\t\t\t * Extra Services\n\t\t\t */\n\t\t\trelatedServices: [],\n\t\t\trelatedServicesValues: {},\n\n\t\t\t/**\n\t\t\t * Prices\n\t\t\t */\n\t\t\testimatedDeliveryPrice: null,\n\t\t\tenteredDeliveryPrice: null,\n\t\t\t/**\n\t\t\t * Responsible User\n\t\t\t */\n\t\t\tresponsibleUser: null,\n\n\t\t\t/**\n\t\t\t * Processing Indicators\n\t\t\t */\n\t\t\tisCalculated: false,\n\t\t\tisCalculating: false,\n\n\t\t\tcalculateErrors: [],\n\n\t\t\trestrictionsHintPopup: null,\n\t\t};\n\t},\n\tmethods: {\n\t\tinitialize()\n\t\t{\n\t\t\tajax.runAction(\n\t\t\t\t'salescenter.deliveryselector.getinitializationdata',\n\t\t\t\t{data: {\n\t\t\t\t\t\tpersonTypeId: this.personTypeId,\n\t\t\t\t\t\tresponsibleId: this.initResponsibleId,\n\t\t\t\t\t\texcludedServiceIds: this.excludedServiceIds\n\t\t\t\t\t}}\n\t\t\t).then((result) => {\n\t\t\t\t/**\n\t\t\t\t * Delivery services\n\t\t\t\t */\n\n\t\t\t\tthis.deliveryServices = result.data.services;\n\n\t\t\t\tif (this.deliveryServices.length > 0)\n\t\t\t\t{\n\t\t\t\t\tlet initDeliveryServiceId = this.selectedDeliveryService\n\t\t\t\t\t\t? this.selectedDeliveryService.id\n\t\t\t\t\t\t: (this.initDeliveryServiceId ? this.initDeliveryServiceId : null);\n\n\t\t\t\t\tif (initDeliveryServiceId)\n\t\t\t\t\t{\n\t\t\t\t\t\tfor (let deliveryService of this.deliveryServices)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (deliveryService.id == initDeliveryServiceId)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.onDeliveryServiceChanged(deliveryService, true);\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tfor (let profile of deliveryService.profiles)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tif (profile.id == initDeliveryServiceId)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tthis.onDeliveryServiceChanged(profile, true);\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t/**\n\t\t\t\t * Related props\n\t\t\t\t */\n\t\t\t\tlet relatedProps = result.data.properties;\n\n\t\t\t\t/**\n\t\t\t\t * Setting default values to related props\n\t\t\t\t */\n\t\t\t\tfor (let relatedProp of relatedProps)\n\t\t\t\t{\n\t\t\t\t\tlet initValue = null;\n\n\t\t\t\t\tif (this.initRelatedPropsValues\n\t\t\t\t\t\t&& this.initRelatedPropsValues.hasOwnProperty(relatedProp.id)\n\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\tinitValue = this.initRelatedPropsValues[relatedProp.id];\n\t\t\t\t\t}\n\t\t\t\t\telse if (relatedProp.initValue)\n\t\t\t\t\t{\n\t\t\t\t\t\tinitValue = relatedProp.initValue;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (initValue !== null)\n\t\t\t\t\t{\n\t\t\t\t\t\tinitValue = (typeof initValue === 'object') ? JSON.stringify(initValue) : initValue;\n\n\t\t\t\t\t\tVue.set(this.relatedPropsValues, relatedProp.id, initValue);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tthis.relatedProps = relatedProps;\n\t\t\t\tthis.relatedPropsOfAddressType = this.relatedProps.filter((item) => item.type === 'ADDRESS');\n\t\t\t\tthis.relatedPropsOfOtherTypes = this.relatedProps.filter((item) => item.type !== 'ADDRESS');\n\n\t\t\t\t/**\n\t\t\t\t * Related services\n\t\t\t\t */\n\t\t\t\tlet relatedServices = result.data.extraServices;\n\n\t\t\t\tfor (let relatedService of relatedServices)\n\t\t\t\t{\n\t\t\t\t\tlet initValue = null;\n\n\t\t\t\t\tif (this.initRelatedServicesValues\n\t\t\t\t\t\t&& this.initRelatedServicesValues.hasOwnProperty(relatedService.id)\n\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\tinitValue = this.initRelatedServicesValues[relatedService.id];\n\t\t\t\t\t}\n\t\t\t\t\telse if (relatedService.initValue)\n\t\t\t\t\t{\n\t\t\t\t\t\tinitValue = relatedService.initValue;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (initValue !== null)\n\t\t\t\t\t{\n\t\t\t\t\t\tVue.set(this.relatedServicesValues, relatedService.id, initValue);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.relatedServices = relatedServices;\n\n\t\t\t\t/**\n\t\t\t\t * Responsible\n\t\t\t\t */\n\t\t\t\tthis.responsibleUser = result.data.responsible;\n\n\t\t\t\t/**\n\t\t\t\t * Misc\n\t\t\t\t */\n\t\t\t\tthis._userPageTemplate = result.data.userPageTemplate;\n\n\t\t\t\tthis._deliverySettingsUrl = result.data.deliverySettingsUrl;\n\n\t\t\t\t/**\n\t\t\t\t *\n\t\t\t\t */\n\t\t\t\tif (this.initEnteredDeliveryPrice !== null)\n\t\t\t\t{\n\t\t\t\t\tthis.enteredDeliveryPrice = this.initEnteredDeliveryPrice;\n\t\t\t\t}\n\n\t\t\t\t(new Ears({\n\t\t\t\t\tcontainer: this.$refs['delivery-methods'],\n\t\t\t\t\tsmallSize: true,\n\t\t\t\t\tnoScrollbar: true\n\t\t\t\t})).init();\n\n\t\t\t\tthis.emitChange();\n\t\t\t\tthis.recalculateRelatedServiceAvailabilities();\n\t\t\t});\n\t\t},\n\t\tcalculate()\n\t\t{\n\t\t\tif (!this.isCalculatingAllowed)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.isCalculating = true;\n\n\t\t\tlet calculationFinallyCallback = (status, payload) =>\n\t\t\t{\n\t\t\t\tthis.isCalculating = false;\n\t\t\t\tthis.isCalculated = true;\n\t\t\t\tthis.emitChange();\n\t\t\t};\n\n\t\t\tlet actionData = Object.assign(\n\t\t\t\t{},\n\t\t\t\tthis.actionData,\n\t\t\t\t{\n\t\t\t\t\tdeliveryServiceId: this.selectedDeliveryServiceId,\n\t\t\t\t\tshipmentPropValues: this.currentRelatedPropsValues,\n\t\t\t\t\tdeliveryRelatedServiceValues: this.currentRelatedServicesValues,\n\t\t\t\t\tdeliveryResponsibleId: this.responsibleUser ? this.responsibleUser.id : null,\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tajax.runAction(this.action, {data: actionData}).then((result) => {\n\t\t\t\tlet deliveryPrice = result.data.deliveryPrice;\n\n\t\t\t\tthis.estimatedDeliveryPrice = deliveryPrice;\n\t\t\t\tthis.enteredDeliveryPrice = deliveryPrice;\n\n\t\t\t\tthis.calculateErrors = [];\n\t\t\t\tcalculationFinallyCallback();\n\t\t\t}).catch((result) => {\n\t\t\t\tthis.estimatedDeliveryPrice = null;\n\t\t\t\tthis.enteredDeliveryPrice = 0.00;\n\n\t\t\t\tthis.calculateErrors = result.errors.map((item) => item.message);\n\t\t\t\tcalculationFinallyCallback();\n\t\t\t});\n\t\t},\n\t\topenChangeResponsibleDialog(event)\n\t\t{\n\t\t\tlet self = this;\n\n\t\t\tif (typeof(this._userEditor) === 'undefined')\n\t\t\t{\n\t\t\t\tthis._userEditor = new BX.Crm.EntityEditorUserSelector();\n\n\t\t\t\tthis._userEditor.initialize(\n\t\t\t\t\t'deliverySelectorUserEditor',\n\t\t\t\t\t{\n\t\t\t\t\t\tcallback(item, type, search, bUndeleted)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tself.responsibleUser = {\n\t\t\t\t\t\t\t\tid: type.entityId,\n\t\t\t\t\t\t\t\tname: type.name,\n\t\t\t\t\t\t\t\tphoto: type.avatar,\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tself.emitChange();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tthis._userEditor.open(\n\t\t\t\tevent.target.parentElement\n\t\t\t);\n\t\t},\n\t\tonDeliveryServiceChanged(deliveryService, selfCall = false)\n\t\t{\n\t\t\tif (!this.isServiceAvailable(deliveryService) && !selfCall)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!deliveryService.parentId && deliveryService.profiles.length > 0)\n\t\t\t{\n\t\t\t\tlet firstAvailableProfile;\n\t\t\t\tfor (let profile of deliveryService.profiles)\n\t\t\t\t{\n\t\t\t\t\tif (this.isServiceAvailable(profile))\n\t\t\t\t\t{\n\t\t\t\t\t\tfirstAvailableProfile = profile;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (firstAvailableProfile)\n\t\t\t\t{\n\t\t\t\t\tthis.onDeliveryServiceChanged(firstAvailableProfile, true);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.onDeliveryServiceChanged(deliveryService.profiles[0], true);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.selectedDeliveryService = deliveryService;\n\t\t\t\tthis.emitChange();\n\t\t\t\tthis.emitServiceChanged();\n\t\t\t}\n\t\t},\n\t\tisNoDeliveryService(service)\n\t\t{\n\t\t\treturn service['code'] === 'NO_DELIVERY';\n\t\t},\n\t\tisServiceAvailable(service)\n\t\t{\n\t\t\treturn this.availableServices.hasOwnProperty(service.id);\n\t\t},\n\t\tisServiceProfitable(service)\n\t\t{\n\t\t\treturn (\n\t\t\t\tservice.hasOwnProperty('tags')\n\t\t\t\t&& Array.isArray(service.tags)\n\t\t\t\t&& service.tags.includes('profitable')\n\t\t\t);\n\t\t},\n\t\tonPropValueChanged(event, relatedProp)\n\t\t{\n\t\t\tVue.set(this.relatedPropsValues, relatedProp.id, event);\n\n\t\t\tthis.emitChange();\n\t\t\tif (relatedProp.isAddressFrom)\n\t\t\t{\n\t\t\t\tthis.emitAddressFromChanged();\n\t\t\t}\n\t\t},\n\t\tonServiceValueChanged(event, relatedService)\n\t\t{\n\t\t\tVue.set(this.relatedServicesValues, relatedService.id, event);\n\t\t\tthis.emitChange();\n\t\t},\n\t\tresponsibleUserClicked()\n\t\t{\n\t\t\tManager.openSlider(this.responsibleUserLink);\n\t\t},\n\t\temitChange()\n\t\t{\n\t\t\tthis.$emit('change', this.state);\n\t\t},\n\t\temitAddressFromChanged()\n\t\t{\n\t\t\tthis.$emit('address-from-changed');\n\t\t},\n\t\temitServiceChanged()\n\t\t{\n\t\t\tthis.$emit('delivery-service-changed');\n\t\t},\n\t\tformatMoney(value)\n\t\t{\n\t\t\treturn BX.Currency.currencyFormat(value, this.currency, false);\n\t\t},\n\t\tisNumber: function(event) {\n\t\t\tevent = (event) ? event : window.event;\n\t\t\tvar charCode = (event.which) ? event.which : event.keyCode;\n\t\t\tif ((charCode > 31 && (charCode < 48 || charCode > 57)) && charCode !== 46) {\n\t\t\t\tevent.preventDefault();\n\t\t\t} else {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\treturn false;\n\t\t},\n\t\tgetPropValue(relatedProp)\n\t\t{\n\t\t\tif (!this.relatedPropsValues)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\treturn this.relatedPropsValues.hasOwnProperty(relatedProp.id) ? this.relatedPropsValues[relatedProp.id] : null;\n\t\t},\n\t\tgetPropOptions(relatedProp)\n\t\t{\n\t\t\tif (!this.initRelatedPropsOptions)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\treturn this.initRelatedPropsOptions.hasOwnProperty(relatedProp.id) ? this.initRelatedPropsOptions[relatedProp.id] : null;\n\t\t},\n\t\tgetPropName(relatedProp)\n\t\t{\n\t\t\tif (relatedProp.isAddressFrom)\n\t\t\t{\n\t\t\t\treturn Loc.getMessage('SALE_DELIVERY_SERVICE_SHIPMENT_ADDRESS_FROM_LABEL');\n\t\t\t}\n\n\t\t\tif (relatedProp.isAddressTo)\n\t\t\t{\n\t\t\t\treturn Loc.getMessage('SALE_DELIVERY_SERVICE_SHIPMENT_ADDRESS_TO_LABEL');\n\t\t\t}\n\n\t\t\treturn relatedProp.name;\n\t\t},\n\t\tgetServiceValue(relatedService)\n\t\t{\n\t\t\tif (!this.relatedServicesValues)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\treturn this.relatedServicesValues.hasOwnProperty(relatedService.id) ? this.relatedServicesValues[relatedService.id] : null;\n\t\t},\n\t\tonAddMoreClicked()\n\t\t{\n\t\t\tManager.openSlider(this._deliverySettingsUrl).then(() => {\n\t\t\t\tthis.initialize();\n\t\t\t\tthis.$emit('settings-changed');\n\t\t\t});\n\t\t},\n\t\tgetDeliveryServiceById(id)\n\t\t{\n\t\t\tfor (let deliveryService of this.deliveryServices)\n\t\t\t{\n\t\t\t\tif (deliveryService.id == id)\n\t\t\t\t{\n\t\t\t\t\treturn deliveryService;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn null;\n\t\t},\n\t\tisParentDeliveryServiceSelected(deliveryService)\n\t\t{\n\t\t\tif (!this.selectedParentDeliveryService)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn this.selectedParentDeliveryService.id == deliveryService.id;\n\t\t},\n\t\tonRestrictionsHintShow(e, profile)\n\t\t{\n\t\t\tthis.restrictionsHintPopup = new Hint.Popup();\n\t\t\tthis.restrictionsHintPopup.show(e.target, this.buildRestrictionsNode(profile));\n\n\t\t},\n\t\tisVisibleProfileRestriction(profile)\n\t\t{\n\t\t\treturn (profile.restrictions && Array.isArray(profile.restrictions) && profile.restrictions.length > 0);\n\t\t},\n\t\tbuildRestrictionsNode(profile)\n\t\t{\n\t\t\tlet restrictionsNodes = profile.restrictions.map((restriction) => `<div>${Text.encode(restriction)}</div>`);\n\n\t\t\treturn Tag.render `<div>${restrictionsNodes.join('')}</div>`;\n\t\t},\n\t\tonRestrictionsHintHide(e)\n\t\t{\n\t\t\tif (this.restrictionsHintPopup)\n\t\t\t{\n\t\t\t\tthis.restrictionsHintPopup.hide();\n\t\t\t}\n\t\t},\n\t\tisProfileSelected(profile)\n\t\t{\n\t\t\treturn (\n\t\t\t\tthis.selectedDeliveryService\n\t\t\t\t&& this.selectedDeliveryService.id == profile.id\n\t\t\t\t&& this.isServiceAvailable(profile)\n\t\t\t);\n\t\t},\n\t\tgetProfileClass(profile)\n\t\t{\n\t\t\treturn {\n\t\t\t\t'salescenter-delivery-car-item': true,\n\t\t\t\t'salescenter-delivery-car-item--selected': this.isProfileSelected(profile),\n\t\t\t\t'salescenter-delivery-car-item--disabled': !this.isServiceAvailable(profile)\n\t\t\t};\n\t\t},\n\t\tisRelatedServiceRelevant(relatedService)\n\t\t{\n\t\t\treturn relatedService.deliveryServiceIds.includes(this.selectedDeliveryServiceId);\n\t\t},\n\t\tisRelatedServiceAvailable(relatedService)\n\t\t{\n\t\t\treturn (\n\t\t\t\trelatedService.hasOwnProperty('isAvailable')\n\t\t\t\t&& relatedService.isAvailable\n\t\t\t);\n\t\t},\n\t\tgetRelatedServiceStyle(relatedService)\n\t\t{\n\t\t\treturn {\n\t\t\t\t'opacity': this.isRelatedServiceAvailable(relatedService) ? 1 : 0.5,\n\t\t\t\t'pointer-events': this.isRelatedServiceAvailable(relatedService) ? 'auto' : 'none',\n\t\t\t};\n\t\t},\n\t\tgetProfileLogoStyle(logo)\n\t\t{\n\t\t\tif (!logo)\n\t\t\t{\n\t\t\t\treturn {};\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tbackgroundImage: 'url(' + logo.src + ')',\n\t\t\t\tbackgroundSize: (logo.width < 55)\n\t\t\t\t\t? 'auto'\n\t\t\t\t\t: 'contain'\n\t\t\t};\n\t\t},\n\t\trecalculateRelatedServiceAvailabilities()\n\t\t{\n\t\t\tfor (let i = 0; i < this.relatedServices.length; i++)\n\t\t\t{\n\t\t\t\tlet relatedService = this.relatedServices[i];\n\n\t\t\t\tlet isAvailable = false;\n\t\t\t\tfor (let deliveryServiceId of relatedService.deliveryServiceIds)\n\t\t\t\t{\n\t\t\t\t\tif (this.availableServices.hasOwnProperty(deliveryServiceId))\n\t\t\t\t\t{\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\tthis.availableServices[deliveryServiceId] === null\n\t\t\t\t\t\t\t|| (\n\t\t\t\t\t\t\t\tArray.isArray(this.availableServices[deliveryServiceId])\n\t\t\t\t\t\t\t\t&& this.availableServices[deliveryServiceId].includes(relatedService.id)\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\tisAvailable = true;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\trelatedService.isAvailable = isAvailable;\n\n\t\t\t\tVue.set(this.relatedServices, i, relatedService);\n\t\t\t}\n\t\t},\n\t\tisSelectorDisabled()\n\t\t{\n\t\t\treturn this.$store.getters['orderCreation/isCompilationMode'];\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tthis.initialize();\n\t},\n\twatch: {\n\t\tenteredDeliveryPrice(value)\n\t\t{\n\t\t\tthis.emitChange();\n\t\t},\n\t\tareProfilesVisible(newValue, oldValue)\n\t\t{\n\t\t\tif (!oldValue && newValue)\n\t\t\t{\n\t\t\t\t//uncomment the block belowe to apply the ears plugin to profiles' section\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t(new Ears({\n\t\t\t\t\t\tcontainer: this.$refs['delivery-profiles'],\n\t\t\t\t\t\tsmallSize: true,\n\t\t\t\t\t\tnoScrollbar: true,\n\t\t\t\t\t\tclassName: 'salescenter-delivery-ears'\n\t\t\t\t\t})).init();\n\t\t\t\t}, 0);\n\t\t\t}\n\t\t},\n\t\tisSelectedDeliveryServiceAvailable(newValue, oldValue)\n\t\t{\n\t\t\tif (oldValue && !newValue)\n\t\t\t{\n\t\t\t\tthis.isCalculated = false;\n\t\t\t\tthis.estimatedDeliveryPrice = null;\n\t\t\t\tthis.enteredDeliveryPrice = 0.00;\n\t\t\t}\n\t\t},\n\t\tavailableServices(newValue)\n\t\t{\n\t\t\tthis.recalculateRelatedServiceAvailabilities();\n\t\t},\n\t},\n\tcomputed: {\n\t\tstate()\n\t\t{\n\t\t\treturn {\n\t\t\t\tdeliveryServiceId: this.selectedDeliveryServiceId,\n\t\t\t\tdeliveryServiceName: this.selectedDeliveryServiceName,\n\t\t\t\tdeliveryPrice: this.deliveryPrice,\n\t\t\t\testimatedDeliveryPrice: this.estimatedDeliveryPrice,\n\t\t\t\trelatedPropsValues: this.currentRelatedPropsValues,\n\t\t\t\trelatedServicesValues: this.currentRelatedServicesValues,\n\t\t\t\tresponsibleUser: this.responsibleUser,\n\t\t\t};\n\t\t},\n\t\tselectedDeliveryServiceId()\n\t\t{\n\t\t\treturn this.selectedDeliveryService ? this.selectedDeliveryService.id : null;\n\t\t},\n\t\tselectedDeliveryServiceName()\n\t\t{\n\t\t\tif (!this.selectedDeliveryService)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tif (this.selectedParentDeliveryService === this.selectedDeliveryService)\n\t\t\t{\n\t\t\t\treturn this.selectedDeliveryService.name;\n\t\t\t}\n\n\t\t\treturn this.selectedParentDeliveryService.name + ': ' + this.selectedDeliveryService.name;\n\t\t},\n\t\tselectedParentDeliveryService()\n\t\t{\n\t\t\tif (!this.selectedDeliveryService)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn this.selectedDeliveryService.parentId\n\t\t\t\t? this.getDeliveryServiceById(this.selectedDeliveryService.parentId)\n\t\t\t\t: this.selectedDeliveryService;\n\t\t},\n\t\tselectedNoDelivery()\n\t\t{\n\t\t\treturn this.selectedDeliveryService && this.isNoDeliveryService(this.selectedDeliveryService);\n\t\t},\n\t\tisCalculatingAllowed()\n\t\t{\n\t\t\treturn this.selectedDeliveryServiceId\n\t\t\t\t&& this.arePropValuesReady\n\t\t\t\t&& this.isSelectedDeliveryServiceAvailable\n\t\t\t\t&& !this.isCalculating;\n\t\t},\n\t\tcurrentRelatedPropsValues()\n\t\t{\n\t\t\tlet result = [];\n\n\t\t\tif (!this.selectedDeliveryServiceId)\n\t\t\t{\n\t\t\t\treturn result;\n\t\t\t}\n\n\t\t\tfor (let relatedProp of this.relatedProps)\n\t\t\t{\n\t\t\t\tif (!relatedProp.deliveryServiceIds.includes(this.selectedDeliveryServiceId))\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tif (this.relatedPropsValues.hasOwnProperty(relatedProp.id))\n\t\t\t\t{\n\t\t\t\t\tresult.push(\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tid: relatedProp.id,\n\t\t\t\t\t\t\tvalue: this.relatedPropsValues[relatedProp.id]\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn result;\n\t\t},\n\t\tisResponsibleUserSectionVisible()\n\t\t{\n\t\t\treturn this.responsibleUser && !this.selectedNoDelivery;\n\t\t},\n\t\tresponsibleUserLink()\n\t\t{\n\t\t\tif (!this.responsibleUser)\n\t\t\t{\n\t\t\t\treturn '';\n\t\t\t}\n\n\t\t\treturn this._userPageTemplate.replace('#user_id#', this.responsibleUser.id);\n\t\t},\n\t\tarePropValuesReady()\n\t\t{\n\t\t\tif (!this.selectedDeliveryServiceId)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tfor (let relatedProp of this.relatedProps)\n\t\t\t{\n\t\t\t\tif (!relatedProp.deliveryServiceIds.includes(this.selectedDeliveryServiceId))\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tif (relatedProp.required && !this.relatedPropsValues[relatedProp.id])\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn true;\n\t\t},\n\t\tcurrentRelatedServicesValues()\n\t\t{\n\t\t\tlet result = [];\n\n\t\t\tif (!this.selectedDeliveryServiceId)\n\t\t\t{\n\t\t\t\treturn result;\n\t\t\t}\n\n\t\t\tfor (let relatedService of this.relatedServices)\n\t\t\t{\n\t\t\t\tif (\n\t\t\t\t\t! (\n\t\t\t\t\t\tthis.isRelatedServiceRelevant(relatedService)\n\t\t\t\t\t\t&& this.isRelatedServiceAvailable(relatedService)\n\t\t\t\t\t)\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tif (this.relatedServicesValues.hasOwnProperty(relatedService.id))\n\t\t\t\t{\n\t\t\t\t\tresult.push(\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tid: relatedService.id,\n\t\t\t\t\t\t\tvalue: this.relatedServicesValues[relatedService.id]\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn result;\n\t\t},\n\t\ttotalPrice()\n\t\t{\n\t\t\tlet result = this.externalSum;\n\n\t\t\tif (this.deliveryPrice !== null)\n\t\t\t{\n\t\t\t\tresult += this.deliveryPrice;\n\t\t\t}\n\t\t\treturn result;\n\t\t},\n\t\ttotalPriceFormatted()\n\t\t{\n\t\t\treturn this.formatMoney(this.totalPrice);\n\t\t},\n\t\tdeliveryPrice()\n\t\t{\n\t\t\tif (!this.selectedDeliveryServiceId)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tif (this.selectedNoDelivery)\n\t\t\t{\n\t\t\t\treturn 0;\n\t\t\t}\n\n\t\t\tif (this.enteredDeliveryPrice)\n\t\t\t{\n\t\t\t\treturn +this.enteredDeliveryPrice;\n\t\t\t}\n\n\t\t\treturn null;\n\t\t},\n\t\tdeliveryPriceFormatted()\n\t\t{\n\t\t\treturn this.formatMoney(this.deliveryPrice);\n\t\t},\n\t\testimatedDeliveryPriceFormatted()\n\t\t{\n\t\t\treturn this.formatMoney(this.estimatedDeliveryPrice);\n\t\t},\n\t\texternalSumFormatted()\n\t\t{\n\t\t\treturn this.formatMoney(this.externalSum);\n\t\t},\n\t\tcalculateDeliveryPriceButtonClass()\n\t\t{\n\t\t\treturn {\n\t\t\t\t'ui-btn': true,\n\t\t\t\t'ui-btn-light-border': true,\n\t\t\t\t'salescenter-delivery-bottom-update-icon': true,\n\t\t\t\t'ui-btn-disabled': !this.isCalculatingAllowed,\n\t\t\t};\n\t\t},\n\t\tlocalize()\n\t\t{\n\t\t\treturn Vue.getFilteredPhrases('SALE_DELIVERY_SERVICE_SELECTOR_');\n\t\t},\n\t\textraServicesCount()\n\t\t{\n\t\t\tlet result = 0;\n\n\t\t\tfor (let relatedService of this.relatedServices)\n\t\t\t{\n\t\t\t\tif (!this.isRelatedServiceRelevant(relatedService))\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tresult++;\n\t\t\t}\n\n\t\t\treturn result;\n\t\t},\n\t\trelatedPropsOfAddressTypeCount()\n\t\t{\n\t\t\tlet result = 0;\n\n\t\t\tfor (let relatedProp of this.relatedPropsOfAddressType)\n\t\t\t{\n\t\t\t\tif (!relatedProp.deliveryServiceIds.includes(this.selectedDeliveryServiceId))\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tresult++;\n\t\t\t}\n\n\t\t\treturn result;\n\t\t},\n\t\trelatedPropsOfOtherTypeCount()\n\t\t{\n\t\t\tlet result = 0;\n\n\t\t\tfor (let relatedProp of this.relatedPropsOfOtherTypes)\n\t\t\t{\n\t\t\t\tif (!relatedProp.deliveryServiceIds.includes(this.selectedDeliveryServiceId))\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tresult++;\n\t\t\t}\n\n\t\t\treturn result;\n\t\t},\n\t\tareProfilesVisible()\n\t\t{\n\t\t\treturn (this.selectedParentDeliveryService && this.selectedParentDeliveryService.profiles.length > 0);\n\t\t},\n\t\tselectedParentServiceName()\n\t\t{\n\t\t\treturn this.selectedParentDeliveryService ? this.selectedParentDeliveryService.name : '';\n\t\t},\n\t\tselectedParentServiceProfiles()\n\t\t{\n\t\t\tif (!this.selectedParentDeliveryService)\n\t\t\t{\n\t\t\t\treturn [];\n\t\t\t}\n\n\t\t\treturn this.selectedParentDeliveryService.profiles;\n\t\t},\n\t\tisSelectedDeliveryServiceAvailable()\n\t\t{\n\t\t\treturn this.selectedDeliveryService && this.isServiceAvailable(this.selectedDeliveryService);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"salescenter-delivery\" :class=\"{'salescenter-delivery--disabled': isSelectorDisabled()}\">\n\t\t\t<div class=\"salescenter-delivery-header\">\n\t\t\t\t<div class=\"salescenter-delivery-car-title--sm\">{{localize.SALE_DELIVERY_SERVICE_SELECTOR_DELIVERY_METHOD}}</div>\n\t\t\t\t<div class=\"salescenter-delivery-method\" ref=\"delivery-methods\">\n\t\t\t\t\t<div\n\t\t\t\t\t\tv-for=\"deliveryService in deliveryServices\"\n\t\t\t\t\t\t@click=\"onDeliveryServiceChanged(deliveryService)\"\n\t\t\t\t\t\t:class=\"{\n\t\t\t\t\t\t\t'salescenter-delivery-method-item': true,\n\t\t\t\t\t\t\t'salescenter-delivery-method-item--selected': isParentDeliveryServiceSelected(deliveryService)\n\t\t\t\t\t\t}\"\n\t\t\t\t\t\t:data-role=\"isParentDeliveryServiceSelected(deliveryService) ? 'ui-ears-active' : ''\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<div class=\"salescenter-delivery-method-image\">\n\t\t\t\t\t\t\t<img v-if=\"deliveryService.logo\" :src=\"deliveryService.logo.src\">\n\t\t\t\t\t\t\t<div v-else-if=\"!isNoDeliveryService(deliveryService)\" class=\"salescenter-delivery-method-image-blank\"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"salescenter-delivery-method-info\">\n\t\t\t\t\t\t\t<div v-if=\"deliveryService.title\" class=\"salescenter-delivery-method-title\">{{deliveryService.title}}</div>\n\t\t\t\t\t\t\t<div v-else=\"deliveryService.title\" class=\"salescenter-delivery-method-title\"></div>\n\t\t\t\t\t\t\t<div class=\"salescenter-delivery-method-name\">{{deliveryService.name}}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div @click=\"onAddMoreClicked\" class=\"salescenter-delivery-method-item salescenter-delivery-method-item--add\">\n\t\t\t\t\t\t<div class=\"salescenter-delivery-method-image-more\"></div>\n\t\t\t\t\t\t<div class=\"salescenter-delivery-method-info\">\n\t\t\t\t\t\t\t<div class=\"salescenter-delivery-method-name\">\n\t\t\t\t\t\t\t\t{{localize.SALE_DELIVERY_SERVICE_SELECTOR_ADD_MORE}}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div v-show=\"areProfilesVisible\">\n\t\t\t\t<div class=\"salescenter-delivery-car-title--sm\">{{selectedParentServiceName}}: {{localize.SALE_DELIVERY_SERVICE_SELECTOR_SHIPPING_SERVICES}}</div>\n\t\t\t\t<div ref=\"delivery-profiles\" class=\"salescenter-delivery-car salescenter-delivery-car--ya-delivery\">\n\t\t\t\t\t<div\n\t\t\t\t\t\tv-for=\"(profile, index) in selectedParentServiceProfiles\"\n\t\t\t\t\t\t@click=\"onDeliveryServiceChanged(profile)\"\n\t\t\t\t\t\t:class=\"getProfileClass(profile)\"\n\t\t\t\t\t\t:data-role=\"selectedDeliveryService.id == profile.id ? 'ui-ears-active' : ''\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<div v-show=\"isServiceProfitable(profile)\" class=\"salescenter-delivery-car-lable\">\n\t\t\t\t\t\t\t{{localize.SALE_DELIVERY_SERVICE_SELECTOR_PROFITABLE}}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"salescenter-delivery-car-container\">\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclass=\"salescenter-delivery-car-image\"\n\t\t\t\t\t\t\t\t:style=\"getProfileLogoStyle(profile.logo)\"\n\t\t\t\t\t\t\t></div>\n\t\t\t\t\t\t\t<div class=\"salescenter-delivery-car-param\">\n\t\t\t\t\t\t\t\t<div class=\"salescenter-delivery-car-title\">\n\t\t\t\t\t\t\t\t\t{{profile.name}}\n\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\tv-show=\"isVisibleProfileRestriction(profile)\"\n\t\t\t\t\t\t\t\t\t\t@mouseenter=\"onRestrictionsHintShow($event, profile)\"\n\t\t\t\t\t\t\t\t\t\t@mouseleave=\"onRestrictionsHintHide($event)\"\n\t\t\t\t\t\t\t\t\t\tclass=\"salescenter-delivery-car-title-info\"\n\t\t\t\t\t\t\t\t\t></div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class=\"salescenter-delivery-car-info\">{{profile.description}}</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\t\t\t\t\t\t\t\n\t\t\t<div v-show=\"extraServicesCount > 0\" class=\"salescenter-delivery-additionally\">\n\t\t\t\t<div class=\"salescenter-delivery-additionally-options\">\n\t\t\t\t\t<component\n\t\t\t\t\t\tv-for=\"relatedService in relatedServices\"\n\t\t\t\t\t\tv-show=\"isRelatedServiceRelevant(relatedService)\"\n\t\t\t\t\t\t:is=\"relatedService.type + '-service'\"\n\t\t\t\t\t\t:key=\"relatedService.id\"\n\t\t\t\t\t\t:name=\"relatedService.name\"\n\t\t\t\t\t\t:initValue=\"getServiceValue(relatedService)\"\t\t\t\t\t\t\n\t\t\t\t\t\t:options=\"relatedService.options\"\n\t\t\t\t\t\t:style=\"getRelatedServiceStyle(relatedService)\"\n\t\t\t\t\t\t@change=\"onServiceValueChanged($event, relatedService)\"\n\t\t\t\t\t>\n\t\t\t\t\t</component>\n\t\t\t\t</div>\n\t\t\t</div>\t\t\t\n\t\t\t<div v-show=\"relatedPropsOfAddressTypeCount > 0\" class=\"salescenter-delivery-path\">\n\t\t\t\t<div\n\t\t\t\t\tv-for=\"(relatedProp, index) in relatedPropsOfAddressType\"\n\t\t\t\t\tv-show=\"relatedProp.deliveryServiceIds.includes(selectedDeliveryServiceId)\"\n\t\t\t\t\t:style=\"{'margin-bottom': '30px'}\"\n\t\t\t\t\tclass=\"salescenter-delivery-path-item\"\n\t\t\t\t>\n\t\t\t\t\t<div class=\"salescenter-delivery-path-title\">\n\t\t\t\t\t\t{{getPropName(relatedProp)}}\n\t\t\t\t\t</div>\n\t\t\t\t\t<component\n\t\t\t\t\t\t:is=\"'ADDRESS-control'\"\n\t\t\t\t\t\t:key=\"relatedProp.id\"\n\t\t\t\t\t\t:name=\"'PROPS_' + relatedProp.id\"\t\t\t\t\t\t\t\n\t\t\t\t\t\t:initValue=\"getPropValue(relatedProp)\"\n\t\t\t\t\t\t:options=\"getPropOptions(relatedProp)\"\n\t\t\t\t\t\t:isStartMarker=\"relatedProp.isAddressFrom\"\n\t\t\t\t\t\t@change=\"onPropValueChanged($event, relatedProp)\"\n\t\t\t\t\t></component>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div v-show=\"relatedPropsOfOtherTypeCount > 0\" class=\"salescenter-delivery-path --without-bg\">\n\t\t\t\t<div\n\t\t\t\t\tv-for=\"(relatedProp, index) in relatedPropsOfOtherTypes\"\n\t\t\t\t\tv-show=\"relatedProp.deliveryServiceIds.includes(selectedDeliveryServiceId)\"\n\t\t\t\t\tclass=\"salescenter-delivery-path-item\"\n\t\t\t\t\t:style=\"{'margin-bottom': '30px'}\"\n\t\t\t\t>\n\t\t\t\t\t<div class=\"salescenter-delivery-path-title-ordinary\">{{relatedProp.name}}</div>\n\t\t\t\t\t<div class=\"salescenter-delivery-path-control\">\n\t\t\t\t\t\t<component\n\t\t\t\t\t\t\t:is=\"relatedProp.type + '-control'\"\n\t\t\t\t\t\t\t:key=\"relatedProp.id\"\n\t\t\t\t\t\t\t:name=\"'PROPS_' + relatedProp.id\"\n\t\t\t\t\t\t\t:initValue=\"getPropValue(relatedProp)\"\n\t\t\t\t\t\t\t:settings=\"relatedProp.settings\"\n\t\t\t\t\t\t\t:options=\"getPropOptions(relatedProp)\"\n\t\t\t\t\t\t\t@change=\"onPropValueChanged($event, relatedProp)\"\n\t\t\t\t\t\t></component>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div v-if=\"isResponsibleUserSectionVisible\" class=\"salescenter-delivery-manager-wrapper\">\n\t\t\t\t<div class=\"ui-ctl-label-text\">{{localize.SALE_DELIVERY_SERVICE_SELECTOR_RESPONSIBLE_MANAGER}}</div>\n\t\t\t\t<div class=\"salescenter-delivery-manager\">\n\t\t\t\t\t<div class=\"salescenter-delivery-manager-avatar\" :style=\"responsibleUser.photo ? {'background-image': 'url(' + responsibleUser.photo + ')'} : {}\"></div>\n\t\t\t\t\t<div class=\"salescenter-delivery-manager-content\">\n\t\t\t\t\t\t<div @click=\"responsibleUserClicked\" class=\"salescenter-delivery-manager-name\">{{responsibleUser.name}}</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div @click=\"openChangeResponsibleDialog\" class=\"salescenter-delivery-manager-edit\">{{localize.SALE_DELIVERY_SERVICE_SELECTOR_CHANGE_RESPONSIBLE}}</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t\t\t\n\t\t\t<div v-show=\"!selectedNoDelivery\">\n\t\t\t\t<template v-if=\"calculateErrors\">\n\t\t\t\t\t<div v-for=\"(error, index) in calculateErrors\" class=\"ui-alert ui-alert-danger ui-alert-icon-danger salescenter-delivery-errors-container-alert\">\n\t\t\t\t\t\t<span class=\"ui-alert-message\">{{error}}</span>\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t\t<div class=\"salescenter-delivery-bottom\">\n\t\t\t\t\t<div class=\"salescenter-delivery-bottom-row\">\t\t\t\t\t\n\t\t\t\t\t\t<div class=\"salescenter-delivery-bottom-col\">\n\t\t\t\t\t\t\t<span v-show=\"!isCalculating\" @click=\"calculate\" :class=\"calculateDeliveryPriceButtonClass\">{{isCalculated ? localize.SALE_DELIVERY_SERVICE_SELECTOR_CALCULATE_UPDATE : localize.SALE_DELIVERY_SERVICE_SELECTOR_CALCULATE}}</span>\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t<span v-show=\"isCalculating\" class=\"salescenter-delivery-waiter\">\n\t\t\t\t\t\t\t\t<span class=\"salescenter-delivery-waiter-alert\">{{localize.SALE_DELIVERY_SERVICE_SELECTOR_CALCULATING_LABEL}}</span>\n\t\t\t\t\t\t\t\t<span class=\"salescenter-delivery-waiter-text\">{{localize.SALE_DELIVERY_SERVICE_SELECTOR_CALCULATING_REQUEST_SENT}} {{selectedParentDeliveryService ? selectedParentDeliveryService.name : ''}}</span>\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div v-show=\"isSelectedDeliveryServiceAvailable && isCalculated\" class=\"salescenter-delivery-bottom-row\">\n\t\t\t\t\t\t<div class=\"salescenter-delivery-bottom-col\"></div>\n\t\t\t\t\t\t<div class=\"salescenter-delivery-bottom-col\">\n\t\t\t\t\t\t\t<table class=\"salescenter-delivery-table-total\">\n\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t<td>{{localize.SALE_DELIVERY_SERVICE_SELECTOR_EXPECTED_DELIVERY_PRICE}}:</td>\n\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t<span v-html=\"estimatedDeliveryPriceFormatted\"></span>&nbsp;<span v-html=\"currencySymbol\"></span>\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t<td>{{localize.SALE_DELIVERY_SERVICE_SELECTOR_CLIENT_DELIVERY_PRICE}}:</td>\n\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t<div class=\"ui-ctl ui-ctl-md ui-ctl-wa salescenter-delivery-bottom-input-symbol\">\n\t\t\t\t\t\t\t\t\t\t\t<input v-model=\"enteredDeliveryPrice\" @keypress=\"isNumber($event)\" type=\"text\" class=\"ui-ctl-element ui-ctl-textbox\">\n\t\t\t\t\t\t\t\t\t\t\t<span v-html=\"currencySymbol\"></span>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t<td>{{externalSumLabel}}:</td>\n\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t<span v-html=\"externalSumFormatted\"></span><span class=\"salescenter-delivery-table-total-symbol\" v-html=\"currencySymbol\"></span>\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t<td>{{localize.SALE_DELIVERY_SERVICE_SELECTOR_DELIVERY_DELIVERY}}:</td>\n\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t<span v-show=\"deliveryPrice > 0\">\n\t\t\t\t\t\t\t\t\t\t\t<span v-html=\"deliveryPriceFormatted\"></span>&nbsp;<span v-html=\"currencySymbol\"></span>\n\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t<span v-show=\"!deliveryPrice\" class=\"salescenter-delivery-status salescenter-delivery-status--success\">\n\t\t\t\t\t\t\t\t\t\t\t{{localize.SALE_DELIVERY_SERVICE_SELECTOR_CLIENT_DELIVERY_PRICE_FREE}}\n\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t<tr class=\"salescenter-delivery-table-total-result\">\n\t\t\t\t\t\t\t\t\t<td>{{localize.SALE_DELIVERY_SERVICE_SELECTOR_TOTAL}}:</td>\n\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t<span v-html=\"totalPriceFormatted\"></span>\n\t\t\t\t\t\t\t\t\t\t<span class=\"salescenter-delivery-table-total-symbol\" v-html=\"currencySymbol\"></span>\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t</table>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`\n};\n"],"names":["props","name","type","String","required","initValue","settings","options","created","value","data","methods","onInput","event","target","$emit","computed","isMultiline","MULTILINE","template","handleOutsideClick","bind","el","binding","vnode","e","which","stopPropagation","handler","exclude","clickedOnExcludedEl","forEach","refName","excludedEl","context","$refs","contains","closest","document","addEventListener","unbind","removeEventListener","directives","closable","ClosableDirective","isStartMarker","Boolean","enterTookPlace","rightIcon","isEntering","isLoading","editMode","addressWidgetState","enteredAddresses","switchToEditMode","showMap","clarifyAddress","setTimeout","focus","click","clearAddress","addressWidget","address","changeValue","onControlClicked","closeMap","onControlFocus","onControlBlur","newValue","syncRightIcon","onChangeCallback","length","buildAddress","BX","Location","Core","Address","JSON","parse","isValueValid","latitude","longitude","getPresetLocationsProvider","result","hasOwnProperty","defaultItems","map","item","enteredAddress","location","toLocation","AddressStringConverter","convertAddressToString","addressFormat","STRATEGY_TYPE_FIELD_TYPE","CONTENT_TYPE_TEXT","push","filter","index","self","findIndex","l","getMap","features","feature","Widget","MapFeature","addressFormatted","toString","STRATEGY_TYPE_FIELD_SORT","isEditMode","wrapperClass","needsClarification","mapMarkerClass","rightIconClass","State","DATA_LOADING","localize","Vue","getFilteredPhrases","mounted","Factory","createAddressWidget","mode","ControlMode","edit","mapBehavior","useFeatures","fields","autocomplete","popupOptions","offsetLeft","popupBindOptions","forceBindPosition","presetLocationsProvider","nativeOnInputKeyup","onInputKeyup","code","call","subscribeOnAddressChangedEvent","getData","toJson","subscribeOnStateChangedEvent","state","DATA_INPUTTING","DATA_LOADED","subscribeOnFeatureEvent","AutocompleteFeature","eventCode","searchStartedEvent","searchCompletedEvent","subscribeOnErrorEvent","errors","errorMessage","error","message","join","UI","Notification","Center","notify","content","render","inputNode","autocompleteMenuElement","mapBindElement","controlWrapper","onChange","checked","Array","getSelectedItemTitle","selectedItem","getSelectedItem","id","title","option","showPopupMenu","menuItems","onclick","popupMenu","close","Menu","bindElement","items","angle","closeByEsc","show","components","AddressControl","StringControl","CheckboxService","DropdownService","initDeliveryServiceId","initRelatedServicesValues","initRelatedPropsValues","initRelatedPropsOptions","initResponsibleId","initEnteredDeliveryPrice","personTypeId","action","actionData","Object","externalSum","externalSumLabel","currency","currencySymbol","availableServices","excludedServiceIds","selectedDeliveryService","deliveryServices","relatedProps","relatedPropsOfAddressType","relatedPropsOfOtherTypes","relatedPropsValues","relatedServices","relatedServicesValues","estimatedDeliveryPrice","enteredDeliveryPrice","responsibleUser","isCalculated","isCalculating","calculateErrors","restrictionsHintPopup","initialize","ajax","runAction","responsibleId","then","services","deliveryService","onDeliveryServiceChanged","profiles","profile","properties","relatedProp","stringify","set","extraServices","relatedService","responsible","_userPageTemplate","userPageTemplate","_deliverySettingsUrl","deliverySettingsUrl","Ears","container","smallSize","noScrollbar","init","emitChange","recalculateRelatedServiceAvailabilities","calculate","isCalculatingAllowed","calculationFinallyCallback","status","payload","assign","deliveryServiceId","selectedDeliveryServiceId","shipmentPropValues","currentRelatedPropsValues","deliveryRelatedServiceValues","currentRelatedServicesValues","deliveryResponsibleId","deliveryPrice","openChangeResponsibleDialog","_userEditor","Crm","EntityEditorUserSelector","callback","search","bUndeleted","entityId","photo","avatar","open","parentElement","selfCall","isServiceAvailable","parentId","firstAvailableProfile","emitServiceChanged","isNoDeliveryService","service","isServiceProfitable","isArray","tags","includes","onPropValueChanged","isAddressFrom","emitAddressFromChanged","onServiceValueChanged","responsibleUserClicked","Manager","openSlider","responsibleUserLink","formatMoney","Currency","currencyFormat","isNumber","window","charCode","keyCode","preventDefault","getPropValue","getPropOptions","getPropName","Loc","getMessage","isAddressTo","getServiceValue","onAddMoreClicked","getDeliveryServiceById","isParentDeliveryServiceSelected","selectedParentDeliveryService","onRestrictionsHintShow","Hint","Popup","buildRestrictionsNode","isVisibleProfileRestriction","restrictions","restrictionsNodes","restriction","Text","encode","Tag","onRestrictionsHintHide","hide","isProfileSelected","getProfileClass","isRelatedServiceRelevant","deliveryServiceIds","isRelatedServiceAvailable","isAvailable","getRelatedServiceStyle","getProfileLogoStyle","logo","backgroundImage","src","backgroundSize","width","i","isSelectorDisabled","$store","getters","watch","areProfilesVisible","oldValue","className","isSelectedDeliveryServiceAvailable","deliveryServiceName","selectedDeliveryServiceName","selectedNoDelivery","arePropValuesReady","isResponsibleUserSectionVisible","replace","totalPrice","totalPriceFormatted","deliveryPriceFormatted","estimatedDeliveryPriceFormatted","externalSumFormatted","calculateDeliveryPriceButtonClass","extraServicesCount","relatedPropsOfAddressTypeCount","relatedPropsOfOtherTypeCount","selectedParentServiceName","selectedParentServiceProfiles"],"mappings":"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"}