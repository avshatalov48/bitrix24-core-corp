{"version":3,"file":"deliveryselector.bundle.js","sources":["../src/properties/string.js","../src/closabledirective.js","../src/properties/address.js","../src/services/checkbox.js","../src/services/yandex-taxi-vehicle-car.js","../src/services/yandex-taxi-vehicle-truck.js","../src/services/yandex-taxi-vehicle-type.js","../src/services/customregistry.js","../src/deliveryselector.js"],"sourcesContent":["export default {\n\tprops: {\n\t\tname: {type: String, required: true},\n\t\tinitValue: {required: false},\n\t\tsettings: {required: false},\n\t\toptions: {required: false},\n\t\teditable: {required: true, type: Boolean},\n\t},\n\tcreated()\n\t{\n\t\tthis.value = this.initValue;\n\t},\n\tdata()\n\t{\n\t\treturn {\n\t\t\tvalue: null,\n\t\t}\n\t},\n\tmethods: {\n\t\tonInput(event)\n\t\t{\n\t\t\tthis.value = event.target.value;\n\n\t\t\tthis.$emit('change', this.value);\n\t\t}\n\t},\n\tcomputed: {\n\t\tisMultiline()\n\t\t{\n\t\t\treturn (this.settings && this.settings.MULTILINE === 'Y');\n\t\t}\n\t},\n\ttemplate: `\n\t\t<div class=\"ui-ctl ui-ctl-w100\">\n\t\t\t<textarea v-if=\"isMultiline\" :disabled=\"!editable\" @input=\"onInput\" :name=\"name\" class=\"ui-ctl-element salescenter-delivery-comment-textarea\" rows=\"1\">{{value}}</textarea>\n\t\t\t<input v-else :disabled=\"!editable\" @input=\"onInput\" type=\"text\" :name=\"name\" :value=\"value\" class=\"ui-ctl-element ui-ctl-textbox\" />\n\t\t</div>\t\t\t\t\t\n\t`\n};\n","let handleOutsideClick;\n\nexport default {\n\tbind (el, binding, vnode) {\n\t\thandleOutsideClick = (e) => {\n\t\t\tif (e.type === 'mousedown' && e.which !== 1)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\te.stopPropagation();\n\t\t\tconst { handler, exclude } = binding.value;\n\t\t\tlet clickedOnExcludedEl = false;\n\t\t\texclude.forEach(refName => {\n\t\t\t\tif (!clickedOnExcludedEl) {\n\t\t\t\t\tconst excludedEl = vnode.context.$refs[refName];\n\t\t\t\t\tclickedOnExcludedEl = excludedEl.contains(e.target);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t/**\n\t\t\t * Click inside map wrapper\n\t\t\t */\n\t\t\tif (e.target.closest('.location-map-wrapper'))\n\t\t\t{\n\t\t\t\tclickedOnExcludedEl = true;\n\t\t\t}\n\n\t\t\tif (!el.contains(e.target) && !clickedOnExcludedEl) {\n\t\t\t\tvnode.context[handler]()\n\t\t\t}\n\t\t};\n\t\tdocument.addEventListener('mousedown', handleOutsideClick);\n\t\tdocument.addEventListener('touchstart', handleOutsideClick);\n\t},\n\n\tunbind () {\n\t\tdocument.removeEventListener('click', handleOutsideClick);\n\t\tdocument.removeEventListener('touchstart', handleOutsideClick);\n\t}\n};\n","import ClosableDirective from '../closabledirective';\nimport {Location} from 'location.core';\nimport {State, AutocompleteFeature} from 'location.widget'\n\nimport '../css/address.css';\n\nexport default {\n\tdirectives: {\n\t\tclosable: ClosableDirective\n\t},\n\tprops: {\n\t\tname: {type: String, required: true},\n\t\tinitValue: {},\n\t\tsettings: {},\n\t\toptions: {required: false},\n\t\teditable: {type: Boolean, default: true},\n\t},\n\tdata()\n\t{\n\t\treturn {\n\t\t\tenterTookPlace: false,\n\t\t\tisEntering: false,\n\t\t\tisLoading: false,\n\t\t\teditMode: false,\n\t\t\tvalue: null,\n\t\t\taddressWidgetState: null,\n\t\t}\n\t},\n\tmethods: {\n\t\tonInputClicked()\n\t\t{\n\t\t\tif (!this.editable)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.value)\n\t\t\t{\n\t\t\t\tthis.showMap();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.closeMap();\n\t\t\t}\n\t\t},\n\t\tonTextClicked()\n\t\t{\n\t\t\tif (!this.editable)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.editMode = true;\n\t\t},\n\t\tonClearClicked()\n\t\t{\n\t\t\tif (!this.editable)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.addressWidget.address = null;\n\t\t\tthis.changeValue(null);\n\t\t\tthis.closeMap();\n\t\t},\n\t\tonInputFocus()\n\t\t{\n\t\t\tthis.enterTookPlace = true;\n\t\t\tthis.isEntering = true;\n\t\t},\n\t\tonInputBlur()\n\t\t{\n\t\t\tthis.isEntering = false;\n\n\t\t\tthis.closeMap();\n\t\t},\n\t\tonInputEnterKeyDown()\n\t\t{\n\t\t\tthis.isEntering = false;\n\t\t},\n\t\tchangeValue(newValue)\n\t\t{\n\t\t\tthis.value = newValue;\n\n\t\t\tthis.$emit('change', this.value);\n\n\t\t\tif (this.onChangeCallback)\n\t\t\t{\n\t\t\t\tthis.onChangeCallback();\n\t\t\t}\n\t\t},\n\t\tbuildAddress(value)\n\t\t{\n\t\t\ttry\n\t\t\t{\n\t\t\t\treturn new BX.Location.Core.Address(JSON.parse(value));\n\t\t\t}\n\t\t\tcatch(e)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * Map Feature Methods\n\t\t */\n\t\tgetMap()\n\t\t{\n\t\t\tif (!this.addressWidget)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tfor( let feature of this.addressWidget.features)\n\t\t\t{\n\t\t\t\tif(feature instanceof BX.Location.Widget.MapFeature)\n\t\t\t\t{\n\t\t\t\t\treturn feature;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn null;\n\t\t},\n\t\tshowMap()\n\t\t{\n\t\t\tlet map = this.getMap();\n\n\t\t\tif (map)\n\t\t\t{\n\t\t\t\tmap.showMap();\n\t\t\t}\n\t\t},\n\t\tcloseMap()\n\t\t{\n\t\t\tlet map = this.getMap();\n\n\t\t\tif (map)\n\t\t\t{\n\t\t\t\tmap.closeMap();\n\t\t\t}\n\n\t\t\tthis.editMode = false;\n\t\t},\n\t},\n\tcomputed: {\n\t\taddressFormatted()\n\t\t{\n\t\t\tif(!this.value || !this.addressWidget)\n\t\t\t{\n\t\t\t\treturn '';\n\t\t\t}\n\n\t\t\tlet address = this.buildAddress(this.value);\n\n\t\t\tif (!address)\n\t\t\t{\n\t\t\t\treturn '';\n\t\t\t}\n\n\t\t\treturn address.toString(\n\t\t\t\tthis.addressWidget.addressFormat,\n\t\t\t\tBX.Location.Core.AddressStringConverter.STRATEGY_TYPE_FIELD_SORT\n\t\t\t);\n\t\t},\n\t\tisEditMode()\n\t\t{\n\t\t\treturn this.editMode || !this.value;\n\t\t},\n\t\twrapperClass()\n\t\t{\n\t\t\tlet showDangerIndicator = (\n\t\t\t\t!this.isEntering\n\t\t\t\t&& this.enterTookPlace\n\t\t\t\t&& !this.value\n\t\t\t\t&& this.addressWidgetState !== State.DATA_LOADING\n\t\t\t);\n\n\t\t\treturn {\n\t\t\t\t'ui-ctl': true,\n\t\t\t\t'ui-ctl-textbox': true,\n\t\t\t\t'ui-ctl-danger': showDangerIndicator,\n\t\t\t\t'ui-ctl-w100': true,\n\t\t\t\t'ui-ctl-after-icon': true,\n\t\t\t\t'sale-address-control-top-margin-5': this.isEditMode\n\t\t\t}\n\t\t},\n\t},\n\tmounted()\n\t{\n\t\tif (this.initValue)\n\t\t{\n\t\t\tthis.value = this.initValue;\n\t\t}\n\n\t\tlet presetLocationList = this.options && this.options.hasOwnProperty('defaultItems')\n\t\t\t? this.options.defaultItems.map((item) => new Location(item))\n\t\t\t: [];\n\n\t\tthis.addressWidget = (new BX.Location.Widget.Factory).createAddressWidget({\n\t\t\taddress: this.initValue ? this.buildAddress(this.initValue) : null,\n\t\t\tmapBehavior: 'manual',\n\t\t\tpopupBindOptions: {\n\t\t\t\tposition: 'right'\n\t\t\t},\n\t\t\tmode: BX.Location.Core.ControlMode.edit,\n\t\t\tuseFeatures: {\n\t\t\t\tfields: false,\n\t\t\t\tmap: true,\n\t\t\t\tautocomplete: true\n\t\t\t},\n\t\t\tpresetLocationList\n\t\t});\n\n\n\t\t/**\n\t\t * Redefine native onInputKeyup\n\t\t */\n\t\tconst nativeOnInputKeyup = this.addressWidget.onInputKeyup;\n\t\tthis.addressWidget.onInputKeyup = (e: KeyboardEvent) =>\n\t\t{\n\t\t\tswitch (e.code)\n\t\t\t{\n\t\t\t\tcase 'Enter':\n\t\t\t\tcase 'NumpadEnter':\n\t\t\t\t\treturn;\n\t\t\t\tdefault:\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tnativeOnInputKeyup.call(this.addressWidget, e);\n\t\t};\n\n\t\t/**\n\t\t * Subscribe to widget events\n\t\t */\n\t\tthis.addressWidget.subscribeOnAddressChangedEvent((event) => {\n\t\t\tlet data = event.getData();\n\n\t\t\tthis.editMode = true;\n\n\t\t\tlet address = data.address;\n\n\t\t\tif (!address.latitude || !address.longitude)\n\t\t\t{\n\t\t\t\tthis.changeValue(null);\n\t\t\t\tthis.closeMap();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.changeValue(address.toJson());\n\t\t\t\tthis.showMap();\n\t\t\t}\n\t\t});\n\n\t\tthis.addressWidget.subscribeOnStateChangedEvent((event) => {\n\t\t\tlet data = event.getData();\n\n\t\t\tthis.addressWidgetState = data.state;\n\n\t\t\tif (data.state === State.DATA_INPUTTING)\n\t\t\t{\n\t\t\t\tthis.changeValue(null);\n\t\t\t\tthis.closeMap();\n\t\t\t}\n\t\t\telse if (data.state === State.DATA_LOADING)\n\t\t\t{\n\t\t\t\tthis.isLoading = true;\n\t\t\t}\n\t\t\telse if (data.state === State.DATA_LOADED)\n\t\t\t{\n\t\t\t\tthis.isLoading = false;\n\t\t\t}\n\t\t});\n\n\t\tthis.addressWidget.subscribeOnFeatureEvent((event) => {\n\t\t\tlet data = event.getData();\n\n\t\t\tif (data.feature instanceof AutocompleteFeature)\n\t\t\t{\n\t\t\t\tthis.isLoading = (data.eventCode === AutocompleteFeature.searchStartedEvent);\n\t\t\t}\n\t\t});\n\n\t\t/**\n\t\t * Render widget\n\t\t */\n\t\tthis.addressWidget.render({\n\t\t\tinputNode: this.$refs['input-node'],\n\t\t\tmapBindElement: this.$refs['input-node'],\n\t\t\tcontrolWrapper: this.$refs['control-wrapper'],\n\t\t});\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tv-closable=\"{\n\t\t\t\texclude: ['input-node'],\n\t\t\t\thandler: 'onInputBlur'\n\t\t\t}\"\n\t\t\tclass=\"ui-ctl-w100\"\n\t\t>\n\t\t\t<div :class=\"wrapperClass\" ref=\"control-wrapper\">\n\t\t\t\t<div\n\t\t\t\t\tv-show=\"!isLoading && isEditMode\"\n\t\t\t\t\t@click=\"onClearClicked\"\n\t\t\t\t\tclass=\"ui-ctl-after ui-ctl-icon-btn ui-ctl-icon-clear\"\n\t\t\t\t></div>\n\t\t\t\t<div\n\t\t\t\t\tv-show=\"isLoading\"\n\t\t\t\t\tclass=\"ui-ctl-after ui-ctl-icon-loader\"\n\t\t\t\t></div>\n\t\t\t\t<input\n\t\t\t\t\tv-show=\"isEditMode\"\n\t\t\t\t\t@click=\"onInputClicked\"\n\t\t\t\t\t@focus=\"onInputFocus\"\n\t\t\t\t\t@keydown.enter=\"onInputEnterKeyDown\"\n\t\t\t\t\t:disabled=\"!editable\"\n\t\t\t\t\tref=\"input-node\"\n\t\t\t\t\ttype=\"text\"\n\t\t\t\t\tclass=\"ui-ctl-element\"\n\t\t\t\t/>\n\t\t\t\t<span\n\t\t\t\t\tv-show=\"!isEditMode\"\n\t\t\t\t\t@click=\"onTextClicked\"\n\t\t\t\t\ttype=\"text\"\n\t\t\t\t\tclass=\"ui-ctl-element ui-ctl-textbox sale-address-control-path-input\"\n\t\t\t\t\tcontenteditable=\"false\"\n\t\t\t\t\tv-html=\"addressFormatted\"\n\t\t\t\t></span>\n\t\t\t\t<input v-model=\"value\" :name=\"name\" type=\"hidden\" />\n\t\t\t</div>\t\t\t\t\t\n\t\t</div>\n\t`\n};\n","export default {\n\tprops: {\n\t\tname: {required: false},\n\t\tinitValue: {required: false},\n\t\teditable: {required: true, type: Boolean},\n\t},\n\tcreated()\n\t{\n\t\tthis.value = this.initValue;\n\t},\n\tdata()\n\t{\n\t\treturn {\n\t\t\tvalue: null\n\t\t}\n\t},\n\tmethods: {\n\t\tonChange(event)\n\t\t{\n\t\t\tthis.value =  event.target.checked ? 'Y' : '';\n\t\t\tthis.$emit('change', this.value);\n\t\t}\n\t},\n\ttemplate: `\n\t\t<label class=\"salescenter-delivery-selector salescenter-delivery-selector--hover salescenter-delivery-selector--checkbox\">\n\t\t\t<input :disabled=\"!editable\" @change=\"onChange\" :checked=\"value == 'Y' ? true : false\" type=\"checkbox\" value=\"Y\" />\n\t\t\t<span class=\"salescenter-delivery-selector-text\">{{name}}</span>\n\t\t</label>\n\t`\n};\n","import {Vue} from 'ui.vue';\nimport {Loc} from 'main.core';\n\nexport default {\n\ttemplate: `\n\t\t<div class=\"salescenter-delivery-car-container\">\n\t\t\t<div class=\"salescenter-delivery-car-image salescenter-delivery-car-image--car\"></div>\n\t\t\t<div class=\"salescenter-delivery-car-param\">\n\t\t\t\t<table>\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td>{{localize.SALE_DELIVERY_SERVICE_SELECTOR_LENGTH}}</td>\n\t\t\t\t\t\t<td>130 {{localize.SALE_DELIVERY_SERVICE_SELECTOR_LENGTH_DIMENSION_UNIT}}</td>\n\t\t\t\t\t</tr>\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td>{{localize.SALE_DELIVERY_SERVICE_SELECTOR_WIDTH}}</td>\n\t\t\t\t\t\t<td>100 {{localize.SALE_DELIVERY_SERVICE_SELECTOR_LENGTH_DIMENSION_UNIT}}</td>\n\t\t\t\t\t</tr>\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td>{{localize.SALE_DELIVERY_SERVICE_SELECTOR_HEIGHT}}</td>\n\t\t\t\t\t\t<td>50 {{localize.SALE_DELIVERY_SERVICE_SELECTOR_LENGTH_DIMENSION_UNIT}}</td>\n\t\t\t\t\t</tr>\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td>{{localize.SALE_DELIVERY_SERVICE_SELECTOR_WEIGHT}}</td>\n\t\t\t\t\t\t<td>20 {{localize.SALE_DELIVERY_SERVICE_SELECTOR_WEIGHT_UNIT}}</td>\n\t\t\t\t\t</tr>\n\t\t\t\t</table>\n\t\t\t</div>\n\t\t</div>\n\t`,\n\tcomputed: {\n\t\tlocalize() {\n\t\t\treturn Vue.getFilteredPhrases('SALE_DELIVERY_SERVICE_SELECTOR_');\n\t\t}\n\t}\n}\n","import {Vue} from 'ui.vue';\nimport {Loc} from 'main.core';\n\nexport default {\n\ttemplate: `\n\t\t<div class=\"salescenter-delivery-car-container\">\n\t\t\t<div class=\"salescenter-delivery-car-image salescenter-delivery-car-image--truck\"></div>\n\t\t\t<div class=\"salescenter-delivery-car-param\">\n\t\t\t\t<table>\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td>{{localize.SALE_DELIVERY_SERVICE_SELECTOR_LENGTH}}</td>\n\t\t\t\t\t\t<td>3 400 {{localize.SALE_DELIVERY_SERVICE_SELECTOR_LENGTH_DIMENSION_UNIT}}</td>\n\t\t\t\t\t</tr>\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td>{{localize.SALE_DELIVERY_SERVICE_SELECTOR_WIDTH}}</td>\n\t\t\t\t\t\t<td>1 950 {{localize.SALE_DELIVERY_SERVICE_SELECTOR_LENGTH_DIMENSION_UNIT}}</td>\n\t\t\t\t\t</tr>\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td>{{localize.SALE_DELIVERY_SERVICE_SELECTOR_HEIGHT}}</td>\n\t\t\t\t\t\t<td>1 600 {{localize.SALE_DELIVERY_SERVICE_SELECTOR_LENGTH_DIMENSION_UNIT}}</td>\n\t\t\t\t\t</tr>\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td>{{localize.SALE_DELIVERY_SERVICE_SELECTOR_WEIGHT}}</td>\n\t\t\t\t\t\t<td>2 200 {{localize.SALE_DELIVERY_SERVICE_SELECTOR_WEIGHT_UNIT}}</td>\n\t\t\t\t\t</tr>\n\t\t\t\t</table>\n\t\t\t</div>\n\t\t</div>\n\t`,\n\tcomputed: {\n\t\tlocalize() {\n\t\t\treturn Vue.getFilteredPhrases('SALE_DELIVERY_SERVICE_SELECTOR_');\n\t\t}\n\t}\n}\n","import Car from './yandex-taxi-vehicle-car';\nimport Truck from './yandex-taxi-vehicle-truck';\n\nexport default {\n\tprops: {\n\t\toptions: {type: Array, required: true},\n\t\tname: {type: String, required: true},\n\t\tinitValue: {type: String, required: false},\n\t\teditable: {required: true, type: Boolean},\n\t},\n\tdata()\n\t{\n\t\treturn {\n\t\t\tvalue: null\n\t\t};\n\t},\n\tmethods: {\n\t\tonItemClick(value)\n\t\t{\n\t\t\tif (!this.editable)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.value = value;\n\t\t\tthis.$emit('change', this.value);\n\t\t}\n\t},\n\tcomponents: {\n\t\t'express': Car,\n\t\t'cargo': Truck,\n\t},\n\tcreated()\n\t{\n\t\tthis.value = this.initValue;\n\t},\n\ttemplate: `\n\t\t<div class=\"salescenter-delivery-car\">\n\t\t\t<div v-for=\"option in options\" @click=\"onItemClick(option.id)\" :class=\"{'salescenter-delivery-car-item': true, 'salescenter-delivery-car-item--selected': option.id == value}\" >\n\t\t\t\t<div class=\"salescenter-delivery-car-title\">{{option.title}}</div>\n\t\t\t\t<component\n\t\t\t\t\t:is=\"option.code\"\n\t\t\t\t\t:key=\"option.code\"\n\t\t\t\t>\n\t\t\t\t</component>\n\t\t\t</div>\n\t\t</div>\n\t`\n};\n","import YandexTaxiVehicleType from './yandex-taxi-vehicle-type';\n\nexport default {\n\t'SERVICE_YANDEX_TAXI_VEHICLE_TYPE': YandexTaxiVehicleType,\n}\n","import {Vue} from 'ui.vue';\nimport {ajax} from 'main.core';\nimport {Manager} from 'salescenter.manager';\nimport StringControl from './properties/string';\nimport AddressControl from './properties/address';\nimport CheckboxService from './services/checkbox';\nimport customServiceRegistry from './services/customregistry';\nimport 'currency';\n\nimport './css/deliveryselector.css';\n\nexport default {\n\tcomponents: {\n\t\t/**\n\t\t * Properties Control Types\n\t\t */\n\t\t'ADDRESS-control': AddressControl,\n\t\t'STRING-control': StringControl,\n\t\t/**\n\t\t * Extra Services Control Types\n\t\t */\n\t\t'checkbox-service': CheckboxService,\n\t},\n\tprops: {\n\t\tinitDeliveryServiceId: {required: false},\n\t\tinitRelatedServicesValues: {required: false},\n\t\tinitRelatedPropsValues: {required: false},\n\t\tinitRelatedPropsOptions: {required: false},\n\t\tinitResponsibleId: {default: null, required: false},\n\t\tinitEstimatedDeliveryPrice: {required: false},\n\t\tinitEnteredDeliveryPrice: {required: false},\n\t\tinitIsCalculated: {required: false},\n\t\tpersonTypeId: {required: true},\n\t\taction: {type: String, required: true },\n\t\tactionData: {type: Object, required: true },\n\t\texternalSum: {required: true},\n\t\texternalSumLabel: {type: String, required: true},\n\t\tcurrency: {type: String, required: true},\n\t\tcurrencySymbol: {type: String, required: true},\n\t\teditable: {type: Boolean, required: true},\n\t},\n\tdata()\n\t{\n\t\treturn {\n\t\t\t/**\n\t\t\t * Selected Service\n\t\t\t */\n\t\t\tselectedDeliveryService: null,\n\t\t\tdeliveryServices: [],\n\n\t\t\t/**\n\t\t\t * Props\n\t\t\t */\n\t\t\trelatedProps: [],\n\t\t\trelatedPropsOfAddressType: [],\n\t\t\trelatedPropsOfOtherTypes: [],\n\t\t\trelatedPropsValues: {},\n\n\t\t\t/**\n\t\t\t * Extra Services\n\t\t\t */\n\t\t\trelatedServices: [],\n\t\t\trelatedServicesOfCheckboxType: [],\n\t\t\tcustomServices: [],\n\t\t\trelatedServicesValues: {},\n\n\t\t\t/**\n\t\t\t * Prices\n\t\t\t */\n\t\t\testimatedDeliveryPrice: null,\n\t\t\tenteredDeliveryPrice: null,\n\t\t\t/**\n\t\t\t * Responsible User\n\t\t\t */\n\t\t\tresponsibleUser: null,\n\n\t\t\t/**\n\t\t\t * Processing Indicators\n\t\t\t */\n\t\t\tisCalculated: false,\n\t\t\tisCalculating: false,\n\n\t\t\tcalculateErrors: [],\n\t\t};\n\t},\n\tmethods: {\n\t\tinitialize()\n\t\t{\n\t\t\tajax.runAction(\n\t\t\t\t'salescenter.deliveryselector.getinitializationdata',\n\t\t\t\t{data: {personTypeId: this.personTypeId, responsibleId: this.initResponsibleId}}\n\t\t\t).then((result) => {\n\t\t\t\t/**\n\t\t\t\t * Delivery services\n\t\t\t\t */\n\n\t\t\t\tthis.deliveryServices = result.data.services;\n\n\t\t\t\tif (this.deliveryServices.length > 0)\n\t\t\t\t{\n\t\t\t\t\tlet initDeliveryServiceId = this.selectedDeliveryService\n\t\t\t\t\t\t? this.selectedDeliveryService.id\n\t\t\t\t\t\t: (this.initDeliveryServiceId ? this.initDeliveryServiceId : null);\n\n\t\t\t\t\tif (initDeliveryServiceId)\n\t\t\t\t\t{\n\t\t\t\t\t\tfor (let deliveryService of this.deliveryServices)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (deliveryService.id == initDeliveryServiceId)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.selectedDeliveryService = deliveryService;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!this.selectedDeliveryService)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.selectedDeliveryService = this.deliveryServices[0];\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t/**\n\t\t\t\t * Related props\n\t\t\t\t */\n\t\t\t\tlet relatedProps = result.data.properties;\n\n\t\t\t\t/**\n\t\t\t\t * Setting default values to related props\n\t\t\t\t */\n\t\t\t\tfor (let relatedProp of relatedProps)\n\t\t\t\t{\n\t\t\t\t\tlet initValue = null;\n\n\t\t\t\t\tif (this.initRelatedPropsValues\n\t\t\t\t\t\t&& this.initRelatedPropsValues.hasOwnProperty(relatedProp.id)\n\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\tinitValue = this.initRelatedPropsValues[relatedProp.id];\n\t\t\t\t\t}\n\t\t\t\t\telse if (relatedProp.initValue)\n\t\t\t\t\t{\n\t\t\t\t\t\tinitValue = relatedProp.initValue;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (initValue !== null)\n\t\t\t\t\t{\n\t\t\t\t\t\tinitValue = (typeof initValue === 'object') ? JSON.stringify(initValue) : initValue;\n\n\t\t\t\t\t\tVue.set(this.relatedPropsValues, relatedProp.id, initValue);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tthis.relatedProps = relatedProps;\n\t\t\t\tthis.relatedPropsOfAddressType = this.relatedProps.filter((item) => item.type === 'ADDRESS');\n\t\t\t\tthis.relatedPropsOfOtherTypes = this.relatedProps.filter((item) => item.type !== 'ADDRESS');\n\n\t\t\t\t/**\n\t\t\t\t * Related services\n\t\t\t\t */\n\t\t\t\tlet relatedServices = result.data.extraServices;\n\n\t\t\t\tfor (let relatedService of relatedServices)\n\t\t\t\t{\n\t\t\t\t\tlet initValue = null;\n\n\t\t\t\t\tif (this.initRelatedServicesValues\n\t\t\t\t\t\t&& this.initRelatedServicesValues.hasOwnProperty(relatedService.id)\n\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\tinitValue = this.initRelatedServicesValues[relatedService.id];\n\t\t\t\t\t}\n\t\t\t\t\telse if (relatedService.initValue)\n\t\t\t\t\t{\n\t\t\t\t\t\tinitValue = relatedService.initValue;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (initValue !== null)\n\t\t\t\t\t{\n\t\t\t\t\t\tVue.set(this.relatedServicesValues, relatedService.id, initValue);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.relatedServices = relatedServices;\n\t\t\t\tthis.relatedServicesOfCheckboxType = this.relatedServices.filter((item) => item.type === 'checkbox');\n\n\t\t\t\t/**\n\t\t\t\t * Custom extra services\n\t\t\t\t */\n\t\t\t\tfor (let component in customServiceRegistry)\n\t\t\t\t{\n\t\t\t\t\tthis.$options.components[component] = customServiceRegistry[component];\n\t\t\t\t}\n\n\t\t\t\tthis.customServices = [];\n\t\t\t\tlet registeredComponents = Object.keys(this.$options.components).filter(item => item.startsWith('SERVICE_'));\n\t\t\t\tfor (let relatedService of this.relatedServices)\n\t\t\t\t{\n\t\t\t\t\tlet componentName = 'SERVICE_' + relatedService.deliveryServiceCode + '_' + relatedService.code;\n\n\t\t\t\t\tif (registeredComponents.includes(componentName))\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.customServices.push({\n\t\t\t\t\t\t\tname: componentName,\n\t\t\t\t\t\t\tservice: relatedService\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t/**\n\t\t\t\t * Responsible\n\t\t\t\t */\n\t\t\t\tthis.responsibleUser = result.data.responsible;\n\n\t\t\t\t/**\n\t\t\t\t * Misc\n\t\t\t\t */\n\t\t\t\tthis._userPageTemplate = result.data.userPageTemplate;\n\n\t\t\t\tthis._deliverySettingsUrl = result.data.deliverySettingsUrl;\n\n\t\t\t\t/**\n\t\t\t\t *\n\t\t\t\t */\n\t\t\t\tif (this.initEstimatedDeliveryPrice !== null)\n\t\t\t\t{\n\t\t\t\t\tthis.estimatedDeliveryPrice = this.initEstimatedDeliveryPrice;\n\t\t\t\t}\n\t\t\t\tif (this.initEnteredDeliveryPrice !== null)\n\t\t\t\t{\n\t\t\t\t\tthis.enteredDeliveryPrice = this.initEnteredDeliveryPrice;\n\t\t\t\t}\n\n\t\t\t\tif (this.initIsCalculated !== null)\n\t\t\t\t{\n\t\t\t\t\tthis.isCalculated = this.initIsCalculated;\n\t\t\t\t}\n\n\t\t\t\tthis.emitChange();\n\t\t\t});\n\t\t},\n\t\tcalculate()\n\t\t{\n\t\t\tif (!this.isCalculatingAllowed)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.isCalculating = true;\n\n\t\t\tlet calculationFinallyCallback = (status, payload) =>\n\t\t\t{\n\t\t\t\tthis.isCalculating = false;\n\t\t\t\tthis.isCalculated = true;\n\t\t\t\tthis.emitChange();\n\t\t\t};\n\n\t\t\tlet actionData = Object.assign(\n\t\t\t\t{},\n\t\t\t\tthis.actionData,\n\t\t\t\t{\n\t\t\t\t\tdeliveryServiceId: this.selectedDeliveryServiceId,\n\t\t\t\t\tdeliveryRelatedPropValues: this.currentRelatedPropsValues,\n\t\t\t\t\tdeliveryRelatedServiceValues: this.currentRelatedServicesValues,\n\t\t\t\t\tdeliveryResponsibleId: this.responsibleUser ? this.responsibleUser.id : null,\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tajax.runAction(this.action, {data: actionData}).then((result) => {\n\t\t\t\tlet deliveryPrice = result.data.deliveryCalculationResult.price;\n\n\t\t\t\tthis.estimatedDeliveryPrice = deliveryPrice;\n\t\t\t\tthis.enteredDeliveryPrice = deliveryPrice;\n\n\t\t\t\tthis.calculateErrors = [];\n\t\t\t\tcalculationFinallyCallback();\n\t\t\t}).catch((result) => {\n\t\t\t\tthis.estimatedDeliveryPrice = null;\n\t\t\t\tthis.enteredDeliveryPrice = 0.00;\n\n\t\t\t\tthis.calculateErrors = result.errors.map((item) => item.message);\n\t\t\t\tcalculationFinallyCallback();\n\t\t\t});\n\t\t},\n\t\topenChangeResponsibleDialog(event)\n\t\t{\n\t\t\tlet self = this;\n\n\t\t\tif (typeof(this._userEditor) === 'undefined')\n\t\t\t{\n\t\t\t\tthis._userEditor = new BX.Crm.EntityEditorUserSelector();\n\n\t\t\t\tthis._userEditor.initialize(\n\t\t\t\t\t'deliverySelectorUserEditor',\n\t\t\t\t\t{\n\t\t\t\t\t\tcallback(item, type, search, bUndeleted)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tself.responsibleUser = {\n\t\t\t\t\t\t\t\tid: type.entityId,\n\t\t\t\t\t\t\t\tname: type.name,\n\t\t\t\t\t\t\t\tphoto: type.avatar,\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tself.emitChange();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tthis._userEditor.open(\n\t\t\t\tevent.target.parentElement\n\t\t\t);\n\t\t},\n\t\tonDeliveryServiceChanged(deliveryService)\n\t\t{\n\t\t\tif (!this.editable)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.selectedDeliveryService = deliveryService;\n\t\t\tthis.emitChange();\n\t\t},\n\t\tonPropValueChanged(event, relatedProp)\n\t\t{\n\t\t\tVue.set(this.relatedPropsValues, relatedProp.id, event);\n\t\t\tthis.emitChange();\n\t\t},\n\t\tonServiceValueChanged(event, relatedService)\n\t\t{\n\t\t\tVue.set(this.relatedServicesValues, relatedService.id, event);\n\t\t\tthis.emitChange();\n\t\t},\n\t\tresponsibleUserClicked()\n\t\t{\n\t\t\tManager.openSlider(this.responsibleUserLink);\n\t\t},\n\t\temitChange()\n\t\t{\n\t\t\tthis.$emit('change', this.state);\n\t\t},\n\t\tformatMoney(value)\n\t\t{\n\t\t\treturn BX.Currency.currencyFormat(value, this.currency, false);\n\t\t},\n\t\tisNumber: function(event) {\n\t\t\tevent = (event) ? event : window.event;\n\t\t\tvar charCode = (event.which) ? event.which : event.keyCode;\n\t\t\tif ((charCode > 31 && (charCode < 48 || charCode > 57)) && charCode !== 46) {\n\t\t\t\tevent.preventDefault();\n\t\t\t} else {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\treturn false;\n\t\t},\n\t\tgetPropValue(relatedProp)\n\t\t{\n\t\t\tif (!this.relatedPropsValues)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\treturn this.relatedPropsValues.hasOwnProperty(relatedProp.id) ? this.relatedPropsValues[relatedProp.id] : null;\n\t\t},\n\t\tgetPropOptions(relatedProp)\n\t\t{\n\t\t\tif (!this.initRelatedPropsOptions)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\treturn this.initRelatedPropsOptions.hasOwnProperty(relatedProp.id) ? this.initRelatedPropsOptions[relatedProp.id] : null;\n\t\t},\n\t\tgetServiceValue(relatedService)\n\t\t{\n\t\t\tif (!this.relatedServicesValues)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\treturn this.relatedServicesValues.hasOwnProperty(relatedService.id) ? this.relatedServicesValues[relatedService.id] : null;\n\t\t},\n\t\tgetCustomServiceValue(customService)\n\t\t{\n\t\t\tif (!this.relatedServicesValues)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\treturn this.relatedServicesValues.hasOwnProperty(customService.service.id) ? this.relatedServicesValues[customService.service.id] : null;\n\t\t},\n\t\tonAddMoreClicked()\n\t\t{\n\t\t\tif (!this.editable)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t\n\t\t\tManager.openSlider(this._deliverySettingsUrl).then(() => {\n\t\t\t\tthis.initialize();\n\t\t\t\tthis.$emit('settings-changed');\n\t\t\t});\n\t\t}\n\t},\n\tcreated()\n\t{\n\t\tthis.initialize();\n\t},\n\twatch: {\n\t\tenteredDeliveryPrice(value)\n\t\t{\n\t\t\tthis.emitChange();\n\t\t}\n\t},\n\tcomputed: {\n\t\tstate()\n\t\t{\n\t\t\treturn {\n\t\t\t\tdeliveryServiceId: this.selectedDeliveryServiceId,\n\t\t\t\tdeliveryPrice: this.deliveryPrice,\n\t\t\t\testimatedDeliveryPrice: this.estimatedDeliveryPrice,\n\t\t\t\trelatedPropsValues: this.currentRelatedPropsValues,\n\t\t\t\trelatedServicesValues: this.currentRelatedServicesValues,\n\t\t\t\tresponsibleUser: this.responsibleUser,\n\t\t\t};\n\t\t},\n\t\tselectedDeliveryServiceId()\n\t\t{\n\t\t\treturn this.selectedDeliveryService ? this.selectedDeliveryService.id : null;\n\t\t},\n\t\tselectedNoDelivery()\n\t\t{\n\t\t\treturn this.selectedDeliveryService && this.selectedDeliveryService['code'] === 'NO_DELIVERY';\n\t\t},\n\t\tisCalculatingAllowed()\n\t\t{\n\t\t\treturn this.selectedDeliveryServiceId\n\t\t\t\t&& this.arePropValuesReady\n\t\t\t\t&& !this.isCalculating\n\t\t\t\t&& this.editable;\n\t\t},\n\t\tcurrentRelatedPropsValues()\n\t\t{\n\t\t\tlet result = [];\n\n\t\t\tif (!this.selectedDeliveryServiceId)\n\t\t\t{\n\t\t\t\treturn result;\n\t\t\t}\n\n\t\t\tfor (let relatedProp of this.relatedProps)\n\t\t\t{\n\t\t\t\tif (!relatedProp.deliveryServiceIds.includes(this.selectedDeliveryServiceId))\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tif (this.relatedPropsValues.hasOwnProperty(relatedProp.id))\n\t\t\t\t{\n\t\t\t\t\tresult.push(\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tid: relatedProp.id,\n\t\t\t\t\t\t\tvalue: this.relatedPropsValues[relatedProp.id]\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn result;\n\t\t},\n\t\tisResponsibleUserSectionVisible()\n\t\t{\n\t\t\treturn this.responsibleUser && !this.selectedNoDelivery;\n\t\t},\n\t\tresponsibleUserLink()\n\t\t{\n\t\t\tif (!this.responsibleUser)\n\t\t\t{\n\t\t\t\treturn '';\n\t\t\t}\n\n\t\t\treturn this._userPageTemplate.replace('#user_id#', this.responsibleUser.id);\n\t\t},\n\t\tarePropValuesReady()\n\t\t{\n\t\t\tif (!this.selectedDeliveryServiceId)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tfor (let relatedProp of this.relatedProps)\n\t\t\t{\n\t\t\t\tif (!relatedProp.deliveryServiceIds.includes(this.selectedDeliveryServiceId))\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tif (relatedProp.required && !this.relatedPropsValues[relatedProp.id])\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn true;\n\t\t},\n\t\tcurrentRelatedServicesValues()\n\t\t{\n\t\t\tlet result = [];\n\n\t\t\tif (!this.selectedDeliveryServiceId)\n\t\t\t{\n\t\t\t\treturn result;\n\t\t\t}\n\n\t\t\tfor (let relatedService of this.relatedServices)\n\t\t\t{\n\t\t\t\tif (!relatedService.deliveryServiceIds.includes(this.selectedDeliveryServiceId))\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tif (this.relatedServicesValues.hasOwnProperty(relatedService.id))\n\t\t\t\t{\n\t\t\t\t\tresult.push(\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tid: relatedService.id,\n\t\t\t\t\t\t\tvalue: this.relatedServicesValues[relatedService.id]\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn result;\n\t\t},\n\t\ttotalPrice()\n\t\t{\n\t\t\tlet result = this.externalSum;\n\n\t\t\tif (this.deliveryPrice !== null)\n\t\t\t{\n\t\t\t\tresult += this.deliveryPrice;\n\t\t\t}\n\t\t\treturn result;\n\t\t},\n\t\ttotalPriceFormatted()\n\t\t{\n\t\t\treturn this.formatMoney(this.totalPrice);\n\t\t},\n\t\tdeliveryPrice()\n\t\t{\n\t\t\tif (!this.selectedDeliveryServiceId)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tif (this.selectedNoDelivery)\n\t\t\t{\n\t\t\t\treturn 0;\n\t\t\t}\n\n\t\t\tif (this.enteredDeliveryPrice)\n\t\t\t{\n\t\t\t\treturn +this.enteredDeliveryPrice;\n\t\t\t}\n\n\t\t\treturn null;\n\t\t},\n\t\tdeliveryPriceFormatted()\n\t\t{\n\t\t\treturn this.formatMoney(this.deliveryPrice);\n\t\t},\n\t\testimatedDeliveryPriceFormatted()\n\t\t{\n\t\t\treturn this.formatMoney(this.estimatedDeliveryPrice);\n\t\t},\n\t\texternalSumFormatted()\n\t\t{\n\t\t\treturn this.formatMoney(this.externalSum);\n\t\t},\n\t\tcalculateDeliveryPriceButtonClass()\n\t\t{\n\t\t\treturn {\n\t\t\t\t'ui-btn': true,\n\t\t\t\t'ui-btn-light-border': true,\n\t\t\t\t'salescenter-delivery-bottom-update-icon': true,\n\t\t\t\t'ui-btn-disabled': !this.isCalculatingAllowed,\n\t\t\t};\n\t\t},\n\t\tlocalize()\n\t\t{\n\t\t\treturn Vue.getFilteredPhrases('SALE_DELIVERY_SERVICE_SELECTOR_');\n\t\t},\n\n\t\textraServiceCheckboxesCount()\n\t\t{\n\t\t\tlet result = 0;\n\n\t\t\tfor (let relatedService of this.relatedServicesOfCheckboxType)\n\t\t\t{\n\t\t\t\tif (!relatedService.deliveryServiceIds.includes(this.selectedDeliveryServiceId))\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tresult++;\n\t\t\t}\n\n\t\t\treturn result;\n\t\t},\n\t\trelatedPropsOfAddressTypeCount()\n\t\t{\n\t\t\tlet result = 0;\n\n\t\t\tfor (let relatedProp of this.relatedPropsOfAddressType)\n\t\t\t{\n\t\t\t\tif (!relatedProp.deliveryServiceIds.includes(this.selectedDeliveryServiceId))\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tresult++;\n\t\t\t}\n\n\t\t\treturn result;\n\t\t},\n\t\trelatedPropsOfOtherTypeCount()\n\t\t{\n\t\t\tlet result = 0;\n\n\t\t\tfor (let relatedProp of this.relatedPropsOfOtherTypes)\n\t\t\t{\n\t\t\t\tif (!relatedProp.deliveryServiceIds.includes(this.selectedDeliveryServiceId))\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tresult++;\n\t\t\t}\n\n\t\t\treturn result;\n\t\t}\n\t},\n\ttemplate: `\n\t\t<div class=\"salescenter-delivery\">\n\t\t\t<div class=\"salescenter-delivery-header\">\n\t\t\t\t<span class=\"salescenter-delivery-header-method\">\n\t\t\t\t\t{{localize.SALE_DELIVERY_SERVICE_SELECTOR_DELIVERY_SERVICE}}\n\t\t\t\t</span>\n\t\t\t\t\n\t\t\t\t<div\n\t\t\t\t\tv-for=\"deliveryService in deliveryServices\"\n\t\t\t\t\t@click=\"onDeliveryServiceChanged(deliveryService)\"\n\t\t\t\t\t:class=\"{'salescenter-delivery-method-item': true, 'salescenter-delivery-method-item--selected': (selectedDeliveryService && deliveryService.id == selectedDeliveryService.id) ? true : false}\"\n\t\t\t\t>\n\t\t\t\t\t<div class=\"salescenter-delivery-method-image\">\n\t\t\t\t\t\t<img :src=\"deliveryService.logo\">\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"salescenter-delivery-method-info\">\n\t\t\t\t\t\t<div v-if=\"deliveryService.title\" class=\"salescenter-delivery-method-title\">{{deliveryService.title}}</div>\n\t\t\t\t\t\t<div v-else=\"deliveryService.title\" class=\"salescenter-delivery-method-title\"></div>\n\t\t\t\t\t\t<div class=\"salescenter-delivery-method-name\">{{deliveryService.name}}</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div @click=\"onAddMoreClicked\" class=\"salescenter-delivery-method-item salescenter-delivery-method-item--add\">\n\t\t\t\t\t<div class=\"salescenter-delivery-method-image-more\"></div>\n\t\t\t\t\t<div class=\"salescenter-delivery-method-info\">\n\t\t\t\t\t\t<div class=\"salescenter-delivery-method-name\">\n\t\t\t\t\t\t\t{{localize.SALE_DELIVERY_SERVICE_SELECTOR_ADD_MORE}}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t\n\t\t\t<component\n\t\t\t\tv-for=\"customService in customServices\"\n\t\t\t\tv-show=\"customService.service.deliveryServiceIds.includes(selectedDeliveryServiceId)\"\n\t\t\t\t:is=\"customService.name\"\n\t\t\t\t:key=\"customService.service.id\"\n\t\t\t\t:name=\"customService.service.name\"\n\t\t\t\t:initValue=\"getCustomServiceValue(customService)\"\n\t\t\t\t:options=\"customService.service.options\"\n\t\t\t\t:editable=\"editable\"\n\t\t\t\t@change=\"onServiceValueChanged($event, customService.service)\"\n\t\t\t>\n\t\t\t</component>\n\t\t\t\n\t\t\t<div v-show=\"extraServiceCheckboxesCount > 0\" class=\"salescenter-delivery-additionally\">\n\t\t\t\t<div class=\"salescenter-delivery-additionally-options\">\n\t\t\t\t\t<component\n\t\t\t\t\t\tv-for=\"relatedService in relatedServicesOfCheckboxType\"\n\t\t\t\t\t\tv-show=\"relatedService.deliveryServiceIds.includes(selectedDeliveryServiceId)\"\n\t\t\t\t\t\t:is=\"'checkbox-service'\"\n\t\t\t\t\t\t:key=\"relatedService.id\"\n\t\t\t\t\t\t:name=\"relatedService.name\"\n\t\t\t\t\t\t:initValue=\"getServiceValue(relatedService)\"\t\t\t\t\t\t\n\t\t\t\t\t\t:options=\"relatedService.options\"\n\t\t\t\t\t\t:editable=\"editable\"\n\t\t\t\t\t\t@change=\"onServiceValueChanged($event, relatedService)\"\n\t\t\t\t\t>\n\t\t\t\t\t</component>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div v-show=\"relatedPropsOfAddressTypeCount > 0\" class=\"salescenter-delivery-path\">\n\t\t\t\t<div\n\t\t\t\t\tv-for=\"(relatedProp, index) in relatedPropsOfAddressType\"\n\t\t\t\t\tv-show=\"relatedProp.deliveryServiceIds.includes(selectedDeliveryServiceId)\"\n\t\t\t\t\tclass=\"salescenter-delivery-path-item\"\n\t\t\t\t>\n\t\t\t\t\t<div class=\"salescenter-delivery-path-title\">{{relatedProp.name}}</div>\n\t\t\t\t\t<div class=\"salescenter-delivery-path-control\">\n\t\t\t\t\t\t<div :class=\"{'salescenter-delivery-path-icon': true, 'salescenter-delivery-path-icon--green': index > 0}\"></div>\n\t\t\t\t\t\t<component\n\t\t\t\t\t\t\t:is=\"'ADDRESS-control'\"\n\t\t\t\t\t\t\t:key=\"relatedProp.id\"\n\t\t\t\t\t\t\t:name=\"'PROPS_' + relatedProp.id\"\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t:initValue=\"getPropValue(relatedProp)\"\n\t\t\t\t\t\t\t:editable=\"editable\"\n\t\t\t\t\t\t\t:options=\"getPropOptions(relatedProp)\"\n\t\t\t\t\t\t\t@change=\"onPropValueChanged($event, relatedProp)\"\n\t\t\t\t\t\t></component>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t\n\t\t\t<div v-show=\"relatedPropsOfOtherTypeCount > 0\" class=\"salescenter-delivery-path\">\n\t\t\t\t<div\n\t\t\t\t\tv-for=\"(relatedProp, index) in relatedPropsOfOtherTypes\"\n\t\t\t\t\tv-show=\"relatedProp.deliveryServiceIds.includes(selectedDeliveryServiceId)\"\n\t\t\t\t\tclass=\"salescenter-delivery-path-item\"\n\t\t\t\t>\n\t\t\t\t\t<div class=\"salescenter-delivery-path-title-ordinary\">{{relatedProp.name}}</div>\n\t\t\t\t\t<div class=\"salescenter-delivery-path-control\">\n\t\t\t\t\t\t<component\n\t\t\t\t\t\t\t:is=\"relatedProp.type + '-control'\"\n\t\t\t\t\t\t\t:key=\"relatedProp.id\"\n\t\t\t\t\t\t\t:name=\"'PROPS_' + relatedProp.id\"\n\t\t\t\t\t\t\t:editable=\"editable\"\n\t\t\t\t\t\t\t:initValue=\"getPropValue(relatedProp)\"\n\t\t\t\t\t\t\t:settings=\"relatedProp.settings\"\n\t\t\t\t\t\t\t:options=\"getPropOptions(relatedProp)\"\n\t\t\t\t\t\t\t@change=\"onPropValueChanged($event, relatedProp)\"\n\t\t\t\t\t\t></component>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div v-if=\"isResponsibleUserSectionVisible\" class=\"salescenter-delivery-manager-wrapper\">\n\t\t\t\t<div class=\"ui-ctl-label-text\">{{localize.SALE_DELIVERY_SERVICE_SELECTOR_RESPONSIBLE_MANAGER}}</div>\n\t\t\t\t<div class=\"salescenter-delivery-manager\">\n\t\t\t\t\t<div class=\"salescenter-delivery-manager-avatar\" :style=\"responsibleUser.photo ? {'background-image': 'url(' + responsibleUser.photo + ')'} : {}\"></div>\n\t\t\t\t\t<div class=\"salescenter-delivery-manager-content\">\n\t\t\t\t\t\t<div @click=\"responsibleUserClicked\" class=\"salescenter-delivery-manager-name\">{{responsibleUser.name}}</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div v-if=\"editable\" @click=\"openChangeResponsibleDialog\" class=\"salescenter-delivery-manager-edit\">{{localize.SALE_DELIVERY_SERVICE_SELECTOR_CHANGE_RESPONSIBLE}}</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t\t\t\n\t\t\t<div v-show=\"!selectedNoDelivery\">\n\t\t\t\t<template v-if=\"calculateErrors\">\n\t\t\t\t\t<div v-for=\"(error, index) in calculateErrors\" class=\"ui-alert ui-alert-danger ui-alert-icon-danger salescenter-delivery-errors-container-alert\">\n\t\t\t\t\t\t<span  class=\"ui-alert-message\">\n\t\t\t\t\t\t\t<span v-html=\"error\"></span>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t\t<div class=\"salescenter-delivery-bottom\">\n\t\t\t\t\t<div v-if=\"editable\" class=\"salescenter-delivery-bottom-row\">\t\t\t\t\t\n\t\t\t\t\t\t<div class=\"salescenter-delivery-bottom-col\">\n\t\t\t\t\t\t\t<span v-show=\"!isCalculating\" @click=\"calculate\" :class=\"calculateDeliveryPriceButtonClass\">{{isCalculated ? localize.SALE_DELIVERY_SERVICE_SELECTOR_CALCULATE_UPDATE : localize.SALE_DELIVERY_SERVICE_SELECTOR_CALCULATE}}</span>\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t<span v-show=\"isCalculating\" class=\"salescenter-delivery-waiter\">\n\t\t\t\t\t\t\t\t<span class=\"salescenter-delivery-waiter-alert\">{{localize.SALE_DELIVERY_SERVICE_SELECTOR_CALCULATING_LABEL}}</span>\n\t\t\t\t\t\t\t\t<span class=\"salescenter-delivery-waiter-text\">{{localize.SALE_DELIVERY_SERVICE_SELECTOR_CALCULATING_REQUEST_SENT}} {{selectedDeliveryService ? selectedDeliveryService.name : ''}}</span>\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div v-show=\"isCalculated\" class=\"salescenter-delivery-bottom-row\">\n\t\t\t\t\t\t<div class=\"salescenter-delivery-bottom-col\"></div>\n\t\t\t\t\t\t<div class=\"salescenter-delivery-bottom-col\">\n\t\t\t\t\t\t\t<table class=\"salescenter-delivery-table-total\">\n\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t<td>{{localize.SALE_DELIVERY_SERVICE_SELECTOR_EXPECTED_DELIVERY_PRICE}}:</td>\n\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t<span v-html=\"estimatedDeliveryPriceFormatted\"></span>&nbsp;<span v-html=\"currencySymbol\"></span>\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t<td>{{localize.SALE_DELIVERY_SERVICE_SELECTOR_CLIENT_DELIVERY_PRICE}}:</td>\n\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t<div class=\"ui-ctl ui-ctl-md ui-ctl-wa salescenter-delivery-bottom-input-symbol\">\n\t\t\t\t\t\t\t\t\t\t\t<input :disabled=\"!editable\" v-model=\"enteredDeliveryPrice\" @keypress=\"isNumber($event)\" type=\"text\" class=\"ui-ctl-element ui-ctl-textbox\">\n\t\t\t\t\t\t\t\t\t\t\t<span v-html=\"currencySymbol\"></span>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t<td>{{externalSumLabel}}:</td>\n\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t<span v-html=\"externalSumFormatted\"></span><span class=\"salescenter-delivery-table-total-symbol\" v-html=\"currencySymbol\"></span>\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t<td>{{localize.SALE_DELIVERY_SERVICE_SELECTOR_DELIVERY_DELIVERY}}:</td>\n\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t<span v-show=\"deliveryPrice > 0\">\n\t\t\t\t\t\t\t\t\t\t\t<span v-html=\"deliveryPriceFormatted\"></span>&nbsp;<span v-html=\"currencySymbol\"></span>\n\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t<span v-show=\"!deliveryPrice\" class=\"salescenter-delivery-status salescenter-delivery-status--success\">\n\t\t\t\t\t\t\t\t\t\t\t{{localize.SALE_DELIVERY_SERVICE_SELECTOR_CLIENT_DELIVERY_PRICE_FREE}}\n\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t<tr class=\"salescenter-delivery-table-total-result\">\n\t\t\t\t\t\t\t\t\t<td>{{localize.SALE_DELIVERY_SERVICE_SELECTOR_TOTAL}}:</td>\n\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t<span v-html=\"totalPriceFormatted\"></span>\n\t\t\t\t\t\t\t\t\t\t<span class=\"salescenter-delivery-table-total-symbol\" v-html=\"currencySymbol\"></span>\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t</table>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`\n};\n"],"names":["props","name","type","String","required","initValue","settings","options","editable","Boolean","created","value","data","methods","onInput","event","target","$emit","computed","isMultiline","MULTILINE","template","handleOutsideClick","bind","el","binding","vnode","e","which","stopPropagation","handler","exclude","clickedOnExcludedEl","forEach","refName","excludedEl","context","$refs","contains","closest","document","addEventListener","unbind","removeEventListener","directives","closable","ClosableDirective","default","enterTookPlace","isEntering","isLoading","editMode","addressWidgetState","onInputClicked","showMap","closeMap","onTextClicked","onClearClicked","addressWidget","address","changeValue","onInputFocus","onInputBlur","onInputEnterKeyDown","newValue","onChangeCallback","buildAddress","BX","Location","Core","Address","JSON","parse","getMap","features","feature","Widget","MapFeature","map","addressFormatted","toString","addressFormat","AddressStringConverter","STRATEGY_TYPE_FIELD_SORT","isEditMode","wrapperClass","showDangerIndicator","State","DATA_LOADING","mounted","presetLocationList","hasOwnProperty","defaultItems","item","Factory","createAddressWidget","mapBehavior","popupBindOptions","position","mode","ControlMode","edit","useFeatures","fields","autocomplete","nativeOnInputKeyup","onInputKeyup","code","call","subscribeOnAddressChangedEvent","getData","latitude","longitude","toJson","subscribeOnStateChangedEvent","state","DATA_INPUTTING","DATA_LOADED","subscribeOnFeatureEvent","AutocompleteFeature","eventCode","searchStartedEvent","render","inputNode","mapBindElement","controlWrapper","onChange","checked","localize","Vue","getFilteredPhrases","Array","onItemClick","components","Car","Truck","YandexTaxiVehicleType","AddressControl","StringControl","CheckboxService","initDeliveryServiceId","initRelatedServicesValues","initRelatedPropsValues","initRelatedPropsOptions","initResponsibleId","initEstimatedDeliveryPrice","initEnteredDeliveryPrice","initIsCalculated","personTypeId","action","actionData","Object","externalSum","externalSumLabel","currency","currencySymbol","selectedDeliveryService","deliveryServices","relatedProps","relatedPropsOfAddressType","relatedPropsOfOtherTypes","relatedPropsValues","relatedServices","relatedServicesOfCheckboxType","customServices","relatedServicesValues","estimatedDeliveryPrice","enteredDeliveryPrice","responsibleUser","isCalculated","isCalculating","calculateErrors","initialize","ajax","runAction","responsibleId","then","result","services","length","id","deliveryService","properties","relatedProp","stringify","set","filter","extraServices","relatedService","component","customServiceRegistry","$options","registeredComponents","keys","startsWith","componentName","deliveryServiceCode","includes","push","service","responsible","_userPageTemplate","userPageTemplate","_deliverySettingsUrl","deliverySettingsUrl","emitChange","calculate","isCalculatingAllowed","calculationFinallyCallback","status","payload","assign","deliveryServiceId","selectedDeliveryServiceId","deliveryRelatedPropValues","currentRelatedPropsValues","deliveryRelatedServiceValues","currentRelatedServicesValues","deliveryResponsibleId","deliveryPrice","deliveryCalculationResult","price","catch","errors","message","openChangeResponsibleDialog","self","_userEditor","Crm","EntityEditorUserSelector","callback","search","bUndeleted","entityId","photo","avatar","open","parentElement","onDeliveryServiceChanged","onPropValueChanged","onServiceValueChanged","responsibleUserClicked","Manager","openSlider","responsibleUserLink","formatMoney","Currency","currencyFormat","isNumber","window","charCode","keyCode","preventDefault","getPropValue","getPropOptions","getServiceValue","getCustomServiceValue","customService","onAddMoreClicked","watch","selectedNoDelivery","arePropValuesReady","deliveryServiceIds","isResponsibleUserSectionVisible","replace","totalPrice","totalPriceFormatted","deliveryPriceFormatted","estimatedDeliveryPriceFormatted","externalSumFormatted","calculateDeliveryPriceButtonClass","extraServiceCheckboxesCount","relatedPropsOfAddressTypeCount","relatedPropsOfOtherTypeCount"],"mappings":"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"}