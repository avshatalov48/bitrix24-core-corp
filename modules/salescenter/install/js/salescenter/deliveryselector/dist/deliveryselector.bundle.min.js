this.BX=this.BX||{};(function(t,e,i,r,n,s){"use strict";var l={props:{name:{type:String,required:true},initValue:{required:false},settings:{required:false},options:{required:false},editable:{required:true,type:Boolean}},created:function t(){this.value=this.initValue},data:function t(){return{value:null}},methods:{onInput:function t(e){this.value=e.target.value;this.$emit("change",this.value)}},computed:{isMultiline:function t(){return this.settings&&this.settings.MULTILINE==="Y"}},template:'\n\t\t<div class="ui-ctl ui-ctl-w100">\n\t\t\t<textarea v-if="isMultiline" :disabled="!editable" @input="onInput" :name="name" class="ui-ctl-element salescenter-delivery-comment-textarea" rows="1">{{value}}</textarea>\n\t\t\t<input v-else :disabled="!editable" @input="onInput" type="text" :name="name" :value="value" class="ui-ctl-element ui-ctl-textbox" />\n\t\t</div>\t\t\t\t\t\n\t'};var a;var d={bind:function t(e,i,r){a=function t(n){if(n.type==="mousedown"&&n.which!==1){return}n.stopPropagation();var s=i.value,l=s.handler,a=s.exclude;var d=false;a.forEach(function(t){if(!d){var e=r.context.$refs[t];d=e.contains(n.target)}});if(n.target.closest(".location-map-wrapper")){d=true}if(!e.contains(n.target)&&!d){r.context[l]()}};document.addEventListener("mousedown",a);document.addEventListener("touchstart",a)},unbind:function t(){document.removeEventListener("click",a);document.removeEventListener("touchstart",a)}};function c(t,e){var i;if(typeof Symbol==="undefined"||t[Symbol.iterator]==null){if(Array.isArray(t)||(i=o(t))||e&&t&&typeof t.length==="number"){if(i)t=i;var r=0;var n=function t(){};return{s:n,n:function e(){if(r>=t.length)return{done:true};return{done:false,value:t[r++]}},e:function t(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s=true,l=false,a;return{s:function e(){i=t[Symbol.iterator]()},n:function t(){var e=i.next();s=e.done;return e},e:function t(e){l=true;a=e},f:function t(){try{if(!s&&i.return!=null)i.return()}finally{if(l)throw a}}}}function o(t,e){if(!t)return;if(typeof t==="string")return u(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);if(i==="Object"&&t.constructor)i=t.constructor.name;if(i==="Map"||i==="Set")return Array.from(t);if(i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return u(t,e)}function u(t,e){if(e==null||e>t.length)e=t.length;for(var i=0,r=new Array(e);i<e;i++){r[i]=t[i]}return r}var v={directives:{closable:d},props:{name:{type:String,required:true},initValue:{},settings:{},options:{required:false},editable:{type:Boolean,default:true}},data:function t(){return{enterTookPlace:false,isEntering:false,isLoading:false,editMode:false,value:null,addressWidgetState:null}},methods:{onInputClicked:function t(){if(!this.editable){return}if(this.value){this.showMap()}else{this.closeMap()}},onTextClicked:function t(){if(!this.editable){return}this.editMode=true},onClearClicked:function t(){if(!this.editable){return}this.addressWidget.address=null;this.changeValue(null);this.closeMap()},onInputFocus:function t(){this.enterTookPlace=true;this.isEntering=true},onInputBlur:function t(){this.isEntering=false;this.closeMap()},onInputEnterKeyDown:function t(){this.isEntering=false},changeValue:function t(e){this.value=e;this.$emit("change",this.value);if(this.onChangeCallback){this.onChangeCallback()}},buildAddress:function t(e){try{return new BX.Location.Core.Address(JSON.parse(e))}catch(t){return null}},getMap:function t(){if(!this.addressWidget){return null}var e=c(this.addressWidget.features),i;try{for(e.s();!(i=e.n()).done;){var r=i.value;if(r instanceof BX.Location.Widget.MapFeature){return r}}}catch(t){e.e(t)}finally{e.f()}return null},showMap:function t(){var e=this.getMap();if(e){e.showMap()}},closeMap:function t(){var e=this.getMap();if(e){e.closeMap()}this.editMode=false}},computed:{addressFormatted:function t(){if(!this.value||!this.addressWidget){return""}var e=this.buildAddress(this.value);if(!e){return""}return e.toString(this.addressWidget.addressFormat,BX.Location.Core.AddressStringConverter.STRATEGY_TYPE_FIELD_SORT)},isEditMode:function t(){return this.editMode||!this.value},wrapperClass:function t(){var e=!this.isEntering&&this.enterTookPlace&&!this.value&&this.addressWidgetState!==r.State.DATA_LOADING;return{"ui-ctl":true,"ui-ctl-textbox":true,"ui-ctl-danger":e,"ui-ctl-w100":true,"ui-ctl-after-icon":true,"sale-address-control-top-margin-5":this.isEditMode}}},mounted:function t(){var e=this;if(this.initValue){this.value=this.initValue}var n=this.options&&this.options.hasOwnProperty("defaultItems")?this.options.defaultItems.map(function(t){return new i.Location(t)}):[];this.addressWidget=(new BX.Location.Widget.Factory).createAddressWidget({address:this.initValue?this.buildAddress(this.initValue):null,mapBehavior:"manual",popupBindOptions:{position:"right"},mode:BX.Location.Core.ControlMode.edit,useFeatures:{fields:false,map:true,autocomplete:true},presetLocationList:n});var s=this.addressWidget.onInputKeyup;this.addressWidget.onInputKeyup=function(t){switch(t.code){case"Enter":case"NumpadEnter":return;default:break}s.call(e.addressWidget,t)};this.addressWidget.subscribeOnAddressChangedEvent(function(t){var i=t.getData();e.editMode=true;var r=i.address;if(!r.latitude||!r.longitude){e.changeValue(null);e.closeMap()}else{e.changeValue(r.toJson());e.showMap()}});this.addressWidget.subscribeOnStateChangedEvent(function(t){var i=t.getData();e.addressWidgetState=i.state;if(i.state===r.State.DATA_INPUTTING){e.changeValue(null);e.closeMap()}else if(i.state===r.State.DATA_LOADING){e.isLoading=true}else if(i.state===r.State.DATA_LOADED){e.isLoading=false}});this.addressWidget.subscribeOnFeatureEvent(function(t){var i=t.getData();if(i.feature instanceof r.AutocompleteFeature){e.isLoading=i.eventCode===r.AutocompleteFeature.searchStartedEvent}});this.addressWidget.render({inputNode:this.$refs["input-node"],mapBindElement:this.$refs["input-node"],controlWrapper:this.$refs["control-wrapper"]})},template:'\n\t\t<div\n\t\t\tv-closable="{\n\t\t\t\texclude: [\'input-node\'],\n\t\t\t\thandler: \'onInputBlur\'\n\t\t\t}"\n\t\t\tclass="ui-ctl-w100"\n\t\t>\n\t\t\t<div :class="wrapperClass" ref="control-wrapper">\n\t\t\t\t<div\n\t\t\t\t\tv-show="!isLoading && isEditMode"\n\t\t\t\t\t@click="onClearClicked"\n\t\t\t\t\tclass="ui-ctl-after ui-ctl-icon-btn ui-ctl-icon-clear"\n\t\t\t\t></div>\n\t\t\t\t<div\n\t\t\t\t\tv-show="isLoading"\n\t\t\t\t\tclass="ui-ctl-after ui-ctl-icon-loader"\n\t\t\t\t></div>\n\t\t\t\t<input\n\t\t\t\t\tv-show="isEditMode"\n\t\t\t\t\t@click="onInputClicked"\n\t\t\t\t\t@focus="onInputFocus"\n\t\t\t\t\t@keydown.enter="onInputEnterKeyDown"\n\t\t\t\t\t:disabled="!editable"\n\t\t\t\t\tref="input-node"\n\t\t\t\t\ttype="text"\n\t\t\t\t\tclass="ui-ctl-element"\n\t\t\t\t/>\n\t\t\t\t<span\n\t\t\t\t\tv-show="!isEditMode"\n\t\t\t\t\t@click="onTextClicked"\n\t\t\t\t\ttype="text"\n\t\t\t\t\tclass="ui-ctl-element ui-ctl-textbox sale-address-control-path-input"\n\t\t\t\t\tcontenteditable="false"\n\t\t\t\t\tv-html="addressFormatted"\n\t\t\t\t></span>\n\t\t\t\t<input v-model="value" :name="name" type="hidden" />\n\t\t\t</div>\t\t\t\t\t\n\t\t</div>\n\t'};var p={props:{name:{required:false},initValue:{required:false},editable:{required:true,type:Boolean}},created:function t(){this.value=this.initValue},data:function t(){return{value:null}},methods:{onChange:function t(e){this.value=e.target.checked?"Y":"";this.$emit("change",this.value)}},template:'\n\t\t<label class="salescenter-delivery-selector salescenter-delivery-selector--hover salescenter-delivery-selector--checkbox">\n\t\t\t<input :disabled="!editable" @change="onChange" :checked="value == \'Y\' ? true : false" type="checkbox" value="Y" />\n\t\t\t<span class="salescenter-delivery-selector-text">{{name}}</span>\n\t\t</label>\n\t'};var h={template:'\n\t\t<div class="salescenter-delivery-car-container">\n\t\t\t<div class="salescenter-delivery-car-image salescenter-delivery-car-image--car"></div>\n\t\t\t<div class="salescenter-delivery-car-param">\n\t\t\t\t<table>\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td>{{localize.SALE_DELIVERY_SERVICE_SELECTOR_LENGTH}}</td>\n\t\t\t\t\t\t<td>130 {{localize.SALE_DELIVERY_SERVICE_SELECTOR_LENGTH_DIMENSION_UNIT}}</td>\n\t\t\t\t\t</tr>\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td>{{localize.SALE_DELIVERY_SERVICE_SELECTOR_WIDTH}}</td>\n\t\t\t\t\t\t<td>100 {{localize.SALE_DELIVERY_SERVICE_SELECTOR_LENGTH_DIMENSION_UNIT}}</td>\n\t\t\t\t\t</tr>\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td>{{localize.SALE_DELIVERY_SERVICE_SELECTOR_HEIGHT}}</td>\n\t\t\t\t\t\t<td>50 {{localize.SALE_DELIVERY_SERVICE_SELECTOR_LENGTH_DIMENSION_UNIT}}</td>\n\t\t\t\t\t</tr>\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td>{{localize.SALE_DELIVERY_SERVICE_SELECTOR_WEIGHT}}</td>\n\t\t\t\t\t\t<td>20 {{localize.SALE_DELIVERY_SERVICE_SELECTOR_WEIGHT_UNIT}}</td>\n\t\t\t\t\t</tr>\n\t\t\t\t</table>\n\t\t\t</div>\n\t\t</div>\n\t',computed:{localize:function t(){return n.Vue.getFilteredPhrases("SALE_DELIVERY_SERVICE_SELECTOR_")}}};var f={template:'\n\t\t<div class="salescenter-delivery-car-container">\n\t\t\t<div class="salescenter-delivery-car-image salescenter-delivery-car-image--truck"></div>\n\t\t\t<div class="salescenter-delivery-car-param">\n\t\t\t\t<table>\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td>{{localize.SALE_DELIVERY_SERVICE_SELECTOR_LENGTH}}</td>\n\t\t\t\t\t\t<td>3 400 {{localize.SALE_DELIVERY_SERVICE_SELECTOR_LENGTH_DIMENSION_UNIT}}</td>\n\t\t\t\t\t</tr>\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td>{{localize.SALE_DELIVERY_SERVICE_SELECTOR_WIDTH}}</td>\n\t\t\t\t\t\t<td>1 950 {{localize.SALE_DELIVERY_SERVICE_SELECTOR_LENGTH_DIMENSION_UNIT}}</td>\n\t\t\t\t\t</tr>\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td>{{localize.SALE_DELIVERY_SERVICE_SELECTOR_HEIGHT}}</td>\n\t\t\t\t\t\t<td>1 600 {{localize.SALE_DELIVERY_SERVICE_SELECTOR_LENGTH_DIMENSION_UNIT}}</td>\n\t\t\t\t\t</tr>\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td>{{localize.SALE_DELIVERY_SERVICE_SELECTOR_WEIGHT}}</td>\n\t\t\t\t\t\t<td>2 200 {{localize.SALE_DELIVERY_SERVICE_SELECTOR_WEIGHT_UNIT}}</td>\n\t\t\t\t\t</tr>\n\t\t\t\t</table>\n\t\t\t</div>\n\t\t</div>\n\t',computed:{localize:function t(){return n.Vue.getFilteredPhrases("SALE_DELIVERY_SERVICE_SELECTOR_")}}};var E={props:{options:{type:Array,required:true},name:{type:String,required:true},initValue:{type:String,required:false},editable:{required:true,type:Boolean}},data:function t(){return{value:null}},methods:{onItemClick:function t(e){if(!this.editable){return}this.value=e;this.$emit("change",this.value)}},components:{express:h,cargo:f},created:function t(){this.value=this.initValue},template:'\n\t\t<div class="salescenter-delivery-car">\n\t\t\t<div v-for="option in options" @click="onItemClick(option.id)" :class="{\'salescenter-delivery-car-item\': true, \'salescenter-delivery-car-item--selected\': option.id == value}" >\n\t\t\t\t<div class="salescenter-delivery-car-title">{{option.title}}</div>\n\t\t\t\t<component\n\t\t\t\t\t:is="option.code"\n\t\t\t\t\t:key="option.code"\n\t\t\t\t>\n\t\t\t\t</component>\n\t\t\t</div>\n\t\t</div>\n\t'};var y={SERVICE_YANDEX_TAXI_VEHICLE_TYPE:E};function S(t,e){var i;if(typeof Symbol==="undefined"||t[Symbol.iterator]==null){if(Array.isArray(t)||(i=m(t))||e&&t&&typeof t.length==="number"){if(i)t=i;var r=0;var n=function t(){};return{s:n,n:function e(){if(r>=t.length)return{done:true};return{done:false,value:t[r++]}},e:function t(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s=true,l=false,a;return{s:function e(){i=t[Symbol.iterator]()},n:function t(){var e=i.next();s=e.done;return e},e:function t(e){l=true;a=e},f:function t(){try{if(!s&&i.return!=null)i.return()}finally{if(l)throw a}}}}function m(t,e){if(!t)return;if(typeof t==="string")return I(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);if(i==="Object"&&t.constructor)i=t.constructor.name;if(i==="Map"||i==="Set")return Array.from(t);if(i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return I(t,e)}function I(t,e){if(e==null||e>t.length)e=t.length;for(var i=0,r=new Array(e);i<e;i++){r[i]=t[i]}return r}var _={components:{"ADDRESS-control":v,"STRING-control":l,"checkbox-service":p},props:{initDeliveryServiceId:{required:false},initRelatedServicesValues:{required:false},initRelatedPropsValues:{required:false},initRelatedPropsOptions:{required:false},initResponsibleId:{default:null,required:false},initEstimatedDeliveryPrice:{required:false},initEnteredDeliveryPrice:{required:false},initIsCalculated:{required:false},personTypeId:{required:true},action:{type:String,required:true},actionData:{type:Object,required:true},externalSum:{required:true},externalSumLabel:{type:String,required:true},currency:{type:String,required:true},currencySymbol:{type:String,required:true},editable:{type:Boolean,required:true}},data:function t(){return{selectedDeliveryService:null,deliveryServices:[],relatedProps:[],relatedPropsOfAddressType:[],relatedPropsOfOtherTypes:[],relatedPropsValues:{},relatedServices:[],relatedServicesOfCheckboxType:[],customServices:[],relatedServicesValues:{},estimatedDeliveryPrice:null,enteredDeliveryPrice:null,responsibleUser:null,isCalculated:false,isCalculating:false,calculateErrors:[]}},methods:{initialize:function t(){var e=this;s.ajax.runAction("salescenter.deliveryselector.getinitializationdata",{data:{personTypeId:this.personTypeId,responsibleId:this.initResponsibleId}}).then(function(t){e.deliveryServices=t.data.services;if(e.deliveryServices.length>0){var i=e.selectedDeliveryService?e.selectedDeliveryService.id:e.initDeliveryServiceId?e.initDeliveryServiceId:null;if(i){var r=S(e.deliveryServices),s;try{for(r.s();!(s=r.n()).done;){var l=s.value;if(l.id==i){e.selectedDeliveryService=l;break}}}catch(t){r.e(t)}finally{r.f()}}if(!e.selectedDeliveryService){e.selectedDeliveryService=e.deliveryServices[0]}}var a=t.data.properties;var d=S(a),c;try{for(d.s();!(c=d.n()).done;){var o=c.value;var u=null;if(e.initRelatedPropsValues&&e.initRelatedPropsValues.hasOwnProperty(o.id)){u=e.initRelatedPropsValues[o.id]}else if(o.initValue){u=o.initValue}if(u!==null){u=babelHelpers.typeof(u)==="object"?JSON.stringify(u):u;n.Vue.set(e.relatedPropsValues,o.id,u)}}}catch(t){d.e(t)}finally{d.f()}e.relatedProps=a;e.relatedPropsOfAddressType=e.relatedProps.filter(function(t){return t.type==="ADDRESS"});e.relatedPropsOfOtherTypes=e.relatedProps.filter(function(t){return t.type!=="ADDRESS"});var v=t.data.extraServices;var p=S(v),h;try{for(p.s();!(h=p.n()).done;){var f=h.value;var E=null;if(e.initRelatedServicesValues&&e.initRelatedServicesValues.hasOwnProperty(f.id)){E=e.initRelatedServicesValues[f.id]}else if(f.initValue){E=f.initValue}if(E!==null){n.Vue.set(e.relatedServicesValues,f.id,E)}}}catch(t){p.e(t)}finally{p.f()}e.relatedServices=v;e.relatedServicesOfCheckboxType=e.relatedServices.filter(function(t){return t.type==="checkbox"});for(var m in y){e.$options.components[m]=y[m]}e.customServices=[];var I=Object.keys(e.$options.components).filter(function(t){return t.startsWith("SERVICE_")});var _=S(e.relatedServices),g;try{for(_.s();!(g=_.n()).done;){var C=g.value;var b="SERVICE_"+C.deliveryServiceCode+"_"+C.code;if(I.includes(b)){e.customServices.push({name:b,service:C})}}}catch(t){_.e(t)}finally{_.f()}e.responsibleUser=t.data.responsible;e._userPageTemplate=t.data.userPageTemplate;e._deliverySettingsUrl=t.data.deliverySettingsUrl;if(e.initEstimatedDeliveryPrice!==null){e.estimatedDeliveryPrice=e.initEstimatedDeliveryPrice}if(e.initEnteredDeliveryPrice!==null){e.enteredDeliveryPrice=e.initEnteredDeliveryPrice}if(e.initIsCalculated!==null){e.isCalculated=e.initIsCalculated}e.emitChange()})},calculate:function t(){var e=this;if(!this.isCalculatingAllowed){return}this.isCalculating=true;var i=function t(i,r){e.isCalculating=false;e.isCalculated=true;e.emitChange()};var r=Object.assign({},this.actionData,{deliveryServiceId:this.selectedDeliveryServiceId,deliveryRelatedPropValues:this.currentRelatedPropsValues,deliveryRelatedServiceValues:this.currentRelatedServicesValues,deliveryResponsibleId:this.responsibleUser?this.responsibleUser.id:null});s.ajax.runAction(this.action,{data:r}).then(function(t){var r=t.data.deliveryCalculationResult.price;e.estimatedDeliveryPrice=r;e.enteredDeliveryPrice=r;e.calculateErrors=[];i()}).catch(function(t){e.estimatedDeliveryPrice=null;e.enteredDeliveryPrice=0;e.calculateErrors=t.errors.map(function(t){return t.message});i()})},openChangeResponsibleDialog:function t(e){var i=this;if(typeof this._userEditor==="undefined"){this._userEditor=new BX.Crm.EntityEditorUserSelector;this._userEditor.initialize("deliverySelectorUserEditor",{callback:function t(e,r,n,s){i.responsibleUser={id:r.entityId,name:r.name,photo:r.avatar};i.emitChange()}})}this._userEditor.open(e.target.parentElement)},onDeliveryServiceChanged:function t(e){if(!this.editable){return}this.selectedDeliveryService=e;this.emitChange()},onPropValueChanged:function t(e,i){n.Vue.set(this.relatedPropsValues,i.id,e);this.emitChange()},onServiceValueChanged:function t(e,i){n.Vue.set(this.relatedServicesValues,i.id,e);this.emitChange()},responsibleUserClicked:function t(){e.Manager.openSlider(this.responsibleUserLink)},emitChange:function t(){this.$emit("change",this.state)},formatMoney:function t(e){return BX.Currency.currencyFormat(e,this.currency,false)},isNumber:function t(e){e=e?e:window.event;var i=e.which?e.which:e.keyCode;if(i>31&&(i<48||i>57)&&i!==46){e.preventDefault()}else{return true}return false},getPropValue:function t(e){if(!this.relatedPropsValues){return null}return this.relatedPropsValues.hasOwnProperty(e.id)?this.relatedPropsValues[e.id]:null},getPropOptions:function t(e){if(!this.initRelatedPropsOptions){return null}return this.initRelatedPropsOptions.hasOwnProperty(e.id)?this.initRelatedPropsOptions[e.id]:null},getServiceValue:function t(e){if(!this.relatedServicesValues){return null}return this.relatedServicesValues.hasOwnProperty(e.id)?this.relatedServicesValues[e.id]:null},getCustomServiceValue:function t(e){if(!this.relatedServicesValues){return null}return this.relatedServicesValues.hasOwnProperty(e.service.id)?this.relatedServicesValues[e.service.id]:null},onAddMoreClicked:function t(){var i=this;if(!this.editable){return}e.Manager.openSlider(this._deliverySettingsUrl).then(function(){i.initialize();i.$emit("settings-changed")})}},created:function t(){this.initialize()},watch:{enteredDeliveryPrice:function t(e){this.emitChange()}},computed:{state:function t(){return{deliveryServiceId:this.selectedDeliveryServiceId,deliveryPrice:this.deliveryPrice,estimatedDeliveryPrice:this.estimatedDeliveryPrice,relatedPropsValues:this.currentRelatedPropsValues,relatedServicesValues:this.currentRelatedServicesValues,responsibleUser:this.responsibleUser}},selectedDeliveryServiceId:function t(){return this.selectedDeliveryService?this.selectedDeliveryService.id:null},selectedNoDelivery:function t(){return this.selectedDeliveryService&&this.selectedDeliveryService["code"]==="NO_DELIVERY"},isCalculatingAllowed:function t(){return this.selectedDeliveryServiceId&&this.arePropValuesReady&&!this.isCalculating&&this.editable},currentRelatedPropsValues:function t(){var e=[];if(!this.selectedDeliveryServiceId){return e}var i=S(this.relatedProps),r;try{for(i.s();!(r=i.n()).done;){var n=r.value;if(!n.deliveryServiceIds.includes(this.selectedDeliveryServiceId)){continue}if(this.relatedPropsValues.hasOwnProperty(n.id)){e.push({id:n.id,value:this.relatedPropsValues[n.id]})}}}catch(t){i.e(t)}finally{i.f()}return e},isResponsibleUserSectionVisible:function t(){return this.responsibleUser&&!this.selectedNoDelivery},responsibleUserLink:function t(){if(!this.responsibleUser){return""}return this._userPageTemplate.replace("#user_id#",this.responsibleUser.id)},arePropValuesReady:function t(){if(!this.selectedDeliveryServiceId){return false}var e=S(this.relatedProps),i;try{for(e.s();!(i=e.n()).done;){var r=i.value;if(!r.deliveryServiceIds.includes(this.selectedDeliveryServiceId)){continue}if(r.required&&!this.relatedPropsValues[r.id]){return false}}}catch(t){e.e(t)}finally{e.f()}return true},currentRelatedServicesValues:function t(){var e=[];if(!this.selectedDeliveryServiceId){return e}var i=S(this.relatedServices),r;try{for(i.s();!(r=i.n()).done;){var n=r.value;if(!n.deliveryServiceIds.includes(this.selectedDeliveryServiceId)){continue}if(this.relatedServicesValues.hasOwnProperty(n.id)){e.push({id:n.id,value:this.relatedServicesValues[n.id]})}}}catch(t){i.e(t)}finally{i.f()}return e},totalPrice:function t(){var e=this.externalSum;if(this.deliveryPrice!==null){e+=this.deliveryPrice}return e},totalPriceFormatted:function t(){return this.formatMoney(this.totalPrice)},deliveryPrice:function t(){if(!this.selectedDeliveryServiceId){return null}if(this.selectedNoDelivery){return 0}if(this.enteredDeliveryPrice){return+this.enteredDeliveryPrice}return null},deliveryPriceFormatted:function t(){return this.formatMoney(this.deliveryPrice)},estimatedDeliveryPriceFormatted:function t(){return this.formatMoney(this.estimatedDeliveryPrice)},externalSumFormatted:function t(){return this.formatMoney(this.externalSum)},calculateDeliveryPriceButtonClass:function t(){return{"ui-btn":true,"ui-btn-light-border":true,"salescenter-delivery-bottom-update-icon":true,"ui-btn-disabled":!this.isCalculatingAllowed}},localize:function t(){return n.Vue.getFilteredPhrases("SALE_DELIVERY_SERVICE_SELECTOR_")},extraServiceCheckboxesCount:function t(){var e=0;var i=S(this.relatedServicesOfCheckboxType),r;try{for(i.s();!(r=i.n()).done;){var n=r.value;if(!n.deliveryServiceIds.includes(this.selectedDeliveryServiceId)){continue}e++}}catch(t){i.e(t)}finally{i.f()}return e},relatedPropsOfAddressTypeCount:function t(){var e=0;var i=S(this.relatedPropsOfAddressType),r;try{for(i.s();!(r=i.n()).done;){var n=r.value;if(!n.deliveryServiceIds.includes(this.selectedDeliveryServiceId)){continue}e++}}catch(t){i.e(t)}finally{i.f()}return e},relatedPropsOfOtherTypeCount:function t(){var e=0;var i=S(this.relatedPropsOfOtherTypes),r;try{for(i.s();!(r=i.n()).done;){var n=r.value;if(!n.deliveryServiceIds.includes(this.selectedDeliveryServiceId)){continue}e++}}catch(t){i.e(t)}finally{i.f()}return e}},template:'\n\t\t<div class="salescenter-delivery">\n\t\t\t<div class="salescenter-delivery-header">\n\t\t\t\t<span class="salescenter-delivery-header-method">\n\t\t\t\t\t{{localize.SALE_DELIVERY_SERVICE_SELECTOR_DELIVERY_SERVICE}}\n\t\t\t\t</span>\n\t\t\t\t\n\t\t\t\t<div\n\t\t\t\t\tv-for="deliveryService in deliveryServices"\n\t\t\t\t\t@click="onDeliveryServiceChanged(deliveryService)"\n\t\t\t\t\t:class="{\'salescenter-delivery-method-item\': true, \'salescenter-delivery-method-item--selected\': (selectedDeliveryService && deliveryService.id == selectedDeliveryService.id) ? true : false}"\n\t\t\t\t>\n\t\t\t\t\t<div class="salescenter-delivery-method-image">\n\t\t\t\t\t\t<img :src="deliveryService.logo">\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="salescenter-delivery-method-info">\n\t\t\t\t\t\t<div v-if="deliveryService.title" class="salescenter-delivery-method-title">{{deliveryService.title}}</div>\n\t\t\t\t\t\t<div v-else="deliveryService.title" class="salescenter-delivery-method-title"></div>\n\t\t\t\t\t\t<div class="salescenter-delivery-method-name">{{deliveryService.name}}</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div @click="onAddMoreClicked" class="salescenter-delivery-method-item salescenter-delivery-method-item--add">\n\t\t\t\t\t<div class="salescenter-delivery-method-image-more"></div>\n\t\t\t\t\t<div class="salescenter-delivery-method-info">\n\t\t\t\t\t\t<div class="salescenter-delivery-method-name">\n\t\t\t\t\t\t\t{{localize.SALE_DELIVERY_SERVICE_SELECTOR_ADD_MORE}}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t\n\t\t\t<component\n\t\t\t\tv-for="customService in customServices"\n\t\t\t\tv-show="customService.service.deliveryServiceIds.includes(selectedDeliveryServiceId)"\n\t\t\t\t:is="customService.name"\n\t\t\t\t:key="customService.service.id"\n\t\t\t\t:name="customService.service.name"\n\t\t\t\t:initValue="getCustomServiceValue(customService)"\n\t\t\t\t:options="customService.service.options"\n\t\t\t\t:editable="editable"\n\t\t\t\t@change="onServiceValueChanged($event, customService.service)"\n\t\t\t>\n\t\t\t</component>\n\t\t\t\n\t\t\t<div v-show="extraServiceCheckboxesCount > 0" class="salescenter-delivery-additionally">\n\t\t\t\t<div class="salescenter-delivery-additionally-options">\n\t\t\t\t\t<component\n\t\t\t\t\t\tv-for="relatedService in relatedServicesOfCheckboxType"\n\t\t\t\t\t\tv-show="relatedService.deliveryServiceIds.includes(selectedDeliveryServiceId)"\n\t\t\t\t\t\t:is="\'checkbox-service\'"\n\t\t\t\t\t\t:key="relatedService.id"\n\t\t\t\t\t\t:name="relatedService.name"\n\t\t\t\t\t\t:initValue="getServiceValue(relatedService)"\t\t\t\t\t\t\n\t\t\t\t\t\t:options="relatedService.options"\n\t\t\t\t\t\t:editable="editable"\n\t\t\t\t\t\t@change="onServiceValueChanged($event, relatedService)"\n\t\t\t\t\t>\n\t\t\t\t\t</component>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div v-show="relatedPropsOfAddressTypeCount > 0" class="salescenter-delivery-path">\n\t\t\t\t<div\n\t\t\t\t\tv-for="(relatedProp, index) in relatedPropsOfAddressType"\n\t\t\t\t\tv-show="relatedProp.deliveryServiceIds.includes(selectedDeliveryServiceId)"\n\t\t\t\t\tclass="salescenter-delivery-path-item"\n\t\t\t\t>\n\t\t\t\t\t<div class="salescenter-delivery-path-title">{{relatedProp.name}}</div>\n\t\t\t\t\t<div class="salescenter-delivery-path-control">\n\t\t\t\t\t\t<div :class="{\'salescenter-delivery-path-icon\': true, \'salescenter-delivery-path-icon--green\': index > 0}"></div>\n\t\t\t\t\t\t<component\n\t\t\t\t\t\t\t:is="\'ADDRESS-control\'"\n\t\t\t\t\t\t\t:key="relatedProp.id"\n\t\t\t\t\t\t\t:name="\'PROPS_\' + relatedProp.id"\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t:initValue="getPropValue(relatedProp)"\n\t\t\t\t\t\t\t:editable="editable"\n\t\t\t\t\t\t\t:options="getPropOptions(relatedProp)"\n\t\t\t\t\t\t\t@change="onPropValueChanged($event, relatedProp)"\n\t\t\t\t\t\t></component>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t\n\t\t\t<div v-show="relatedPropsOfOtherTypeCount > 0" class="salescenter-delivery-path">\n\t\t\t\t<div\n\t\t\t\t\tv-for="(relatedProp, index) in relatedPropsOfOtherTypes"\n\t\t\t\t\tv-show="relatedProp.deliveryServiceIds.includes(selectedDeliveryServiceId)"\n\t\t\t\t\tclass="salescenter-delivery-path-item"\n\t\t\t\t>\n\t\t\t\t\t<div class="salescenter-delivery-path-title-ordinary">{{relatedProp.name}}</div>\n\t\t\t\t\t<div class="salescenter-delivery-path-control">\n\t\t\t\t\t\t<component\n\t\t\t\t\t\t\t:is="relatedProp.type + \'-control\'"\n\t\t\t\t\t\t\t:key="relatedProp.id"\n\t\t\t\t\t\t\t:name="\'PROPS_\' + relatedProp.id"\n\t\t\t\t\t\t\t:editable="editable"\n\t\t\t\t\t\t\t:initValue="getPropValue(relatedProp)"\n\t\t\t\t\t\t\t:settings="relatedProp.settings"\n\t\t\t\t\t\t\t:options="getPropOptions(relatedProp)"\n\t\t\t\t\t\t\t@change="onPropValueChanged($event, relatedProp)"\n\t\t\t\t\t\t></component>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div v-if="isResponsibleUserSectionVisible" class="salescenter-delivery-manager-wrapper">\n\t\t\t\t<div class="ui-ctl-label-text">{{localize.SALE_DELIVERY_SERVICE_SELECTOR_RESPONSIBLE_MANAGER}}</div>\n\t\t\t\t<div class="salescenter-delivery-manager">\n\t\t\t\t\t<div class="salescenter-delivery-manager-avatar" :style="responsibleUser.photo ? {\'background-image\': \'url(\' + responsibleUser.photo + \')\'} : {}"></div>\n\t\t\t\t\t<div class="salescenter-delivery-manager-content">\n\t\t\t\t\t\t<div @click="responsibleUserClicked" class="salescenter-delivery-manager-name">{{responsibleUser.name}}</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div v-if="editable" @click="openChangeResponsibleDialog" class="salescenter-delivery-manager-edit">{{localize.SALE_DELIVERY_SERVICE_SELECTOR_CHANGE_RESPONSIBLE}}</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t\t\t\n\t\t\t<div v-show="!selectedNoDelivery">\n\t\t\t\t<template v-if="calculateErrors">\n\t\t\t\t\t<div v-for="(error, index) in calculateErrors" class="ui-alert ui-alert-danger ui-alert-icon-danger salescenter-delivery-errors-container-alert">\n\t\t\t\t\t\t<span  class="ui-alert-message">\n\t\t\t\t\t\t\t<span v-html="error"></span>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t\t<div class="salescenter-delivery-bottom">\n\t\t\t\t\t<div v-if="editable" class="salescenter-delivery-bottom-row">\t\t\t\t\t\n\t\t\t\t\t\t<div class="salescenter-delivery-bottom-col">\n\t\t\t\t\t\t\t<span v-show="!isCalculating" @click="calculate" :class="calculateDeliveryPriceButtonClass">{{isCalculated ? localize.SALE_DELIVERY_SERVICE_SELECTOR_CALCULATE_UPDATE : localize.SALE_DELIVERY_SERVICE_SELECTOR_CALCULATE}}</span>\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t<span v-show="isCalculating" class="salescenter-delivery-waiter">\n\t\t\t\t\t\t\t\t<span class="salescenter-delivery-waiter-alert">{{localize.SALE_DELIVERY_SERVICE_SELECTOR_CALCULATING_LABEL}}</span>\n\t\t\t\t\t\t\t\t<span class="salescenter-delivery-waiter-text">{{localize.SALE_DELIVERY_SERVICE_SELECTOR_CALCULATING_REQUEST_SENT}} {{selectedDeliveryService ? selectedDeliveryService.name : \'\'}}</span>\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div v-show="isCalculated" class="salescenter-delivery-bottom-row">\n\t\t\t\t\t\t<div class="salescenter-delivery-bottom-col"></div>\n\t\t\t\t\t\t<div class="salescenter-delivery-bottom-col">\n\t\t\t\t\t\t\t<table class="salescenter-delivery-table-total">\n\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t<td>{{localize.SALE_DELIVERY_SERVICE_SELECTOR_EXPECTED_DELIVERY_PRICE}}:</td>\n\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t<span v-html="estimatedDeliveryPriceFormatted"></span>&nbsp;<span v-html="currencySymbol"></span>\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t<td>{{localize.SALE_DELIVERY_SERVICE_SELECTOR_CLIENT_DELIVERY_PRICE}}:</td>\n\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t<div class="ui-ctl ui-ctl-md ui-ctl-wa salescenter-delivery-bottom-input-symbol">\n\t\t\t\t\t\t\t\t\t\t\t<input :disabled="!editable" v-model="enteredDeliveryPrice" @keypress="isNumber($event)" type="text" class="ui-ctl-element ui-ctl-textbox">\n\t\t\t\t\t\t\t\t\t\t\t<span v-html="currencySymbol"></span>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t<td>{{externalSumLabel}}:</td>\n\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t<span v-html="externalSumFormatted"></span><span class="salescenter-delivery-table-total-symbol" v-html="currencySymbol"></span>\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t<td>{{localize.SALE_DELIVERY_SERVICE_SELECTOR_DELIVERY_DELIVERY}}:</td>\n\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t<span v-show="deliveryPrice > 0">\n\t\t\t\t\t\t\t\t\t\t\t<span v-html="deliveryPriceFormatted"></span>&nbsp;<span v-html="currencySymbol"></span>\n\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t<span v-show="!deliveryPrice" class="salescenter-delivery-status salescenter-delivery-status--success">\n\t\t\t\t\t\t\t\t\t\t\t{{localize.SALE_DELIVERY_SERVICE_SELECTOR_CLIENT_DELIVERY_PRICE_FREE}}\n\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t<tr class="salescenter-delivery-table-total-result">\n\t\t\t\t\t\t\t\t\t<td>{{localize.SALE_DELIVERY_SERVICE_SELECTOR_TOTAL}}:</td>\n\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t<span v-html="totalPriceFormatted"></span>\n\t\t\t\t\t\t\t\t\t\t<span class="salescenter-delivery-table-total-symbol" v-html="currencySymbol"></span>\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t</table>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t'};t.default=_})(this.BX.Salescenter=this.BX.Salescenter||{},BX.Salescenter,BX.Location.Core,BX.Location.Widget,BX,BX);
//# sourceMappingURL=deliveryselector.bundle.map.js