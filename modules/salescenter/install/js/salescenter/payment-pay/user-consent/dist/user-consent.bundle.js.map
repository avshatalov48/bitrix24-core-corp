{"version":3,"file":"user-consent.bundle.js","sources":["../src/user-consent.js"],"sourcesContent":["import {EventEmitter} from 'main.core.events';\nimport {EventType} from 'sale.payment-pay.const';\n\nexport class UserConsent\n{\n\t/**\n\t * @public\n\t * @param {object} options\n\t */\n\tconstructor(options)\n\t{\n\t\tthis.options = options || {};\n\n\t\tthis.accepted = this.option('accepted', false);\n\t\tthis.container = document.getElementById(this.option('containerId'), '');\n\t\tthis.eventName = this.option('eventName', false);\n\t\tthis.callback = null;\n\n\t\tthis.subscribeToEvents();\n\t}\n\n\t/**\n\t * @private\n\t */\n\tsubscribeToEvents()\n\t{\n\t\tEventEmitter.subscribe(EventType.consent.accepted, (event) => {\n\t\t\tthis.accepted = true;\n\t\t\tif (this.callback) {\n\t\t\t\tthis.callback();\n\t\t\t}\n\t\t});\n\t\tEventEmitter.subscribe(EventType.consent.refused, (event) => {\n\t\t\tthis.accepted = false;\n\t\t\tthis.callback = null;\n\t\t});\n\t}\n\n\t/**\n\t * @public\n\t * @returns {boolean}\n\t */\n\tisAvailable()\n\t{\n\t\treturn BX.UserConsent && this.eventName;\n\t}\n\n\t/**\n\t * @public\n\t * @param callback\n\t */\n\taskUserToPerform(callback)\n\t{\n\t\tif (!this.isAvailable() || this.accepted)\n\t\t{\n\t\t\tcallback();\n\t\t\treturn;\n\t\t}\n\n\t\tthis.callback = callback;\n\t\tEventEmitter.emit(this.eventName);\n\n\t\tif (this.checkCurrentConsent())\n\t\t{\n\t\t\tcallback();\n\t\t}\n\t}\n\n\tcheckCurrentConsent()\n\t{\n\t\tif (!BX.UserConsent || !BX.UserConsent.current)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\treturn BX.UserConsent.check(BX.UserConsent.current);\n\t}\n\n\t/**\n\t * @private\n\t * @param {string} name\n\t * @param defaultValue\n\t * @returns {*}\n\t */\n\toption(name, defaultValue)\n\t{\n\t\treturn this.options.hasOwnProperty(name) ? this.options[name] : defaultValue;\n\t}\n}"],"names":["UserConsent","options","accepted","option","container","document","getElementById","eventName","callback","subscribeToEvents","EventEmitter","subscribe","EventType","consent","event","refused","BX","isAvailable","emit","checkCurrentConsent","current","check","name","defaultValue","hasOwnProperty"],"mappings":";;;;;KAGaA,WAAb;;CAGA;CACA;CACA;GACC,qBAAYC,OAAZ,EACA;KAAA;KACC,KAAKA,OAAL,GAAeA,OAAO,IAAI,EAA1B;KAEA,KAAKC,QAAL,GAAgB,KAAKC,MAAL,CAAY,UAAZ,EAAwB,KAAxB,CAAhB;KACA,KAAKC,SAAL,GAAiBC,QAAQ,CAACC,cAAT,CAAwB,KAAKH,MAAL,CAAY,aAAZ,CAAxB,EAAoD,EAApD,CAAjB;KACA,KAAKI,SAAL,GAAiB,KAAKJ,MAAL,CAAY,WAAZ,EAAyB,KAAzB,CAAjB;KACA,KAAKK,QAAL,GAAgB,IAAhB;KAEA,KAAKC,iBAAL;;;CAIF;CACA;;;GApBA;KAAA;KAAA,oCAsBC;OAAA;;OACCC,6BAAY,CAACC,SAAb,CAAuBC,+BAAS,CAACC,OAAV,CAAkBX,QAAzC,EAAmD,UAACY,KAAD,EAAW;SAC7D,KAAI,CAACZ,QAAL,GAAgB,IAAhB;;SACA,IAAI,KAAI,CAACM,QAAT,EAAmB;WAClB,KAAI,CAACA,QAAL;;QAHF;OAMAE,6BAAY,CAACC,SAAb,CAAuBC,+BAAS,CAACC,OAAV,CAAkBE,OAAzC,EAAkD,UAACD,KAAD,EAAW;SAC5D,KAAI,CAACZ,QAAL,GAAgB,KAAhB;SACA,KAAI,CAACM,QAAL,GAAgB,IAAhB;QAFD;;;CAOF;CACA;CACA;;;KAtCA;KAAA,8BAwCC;OACC,OAAOQ,EAAE,CAAChB,WAAH,IAAkB,KAAKO,SAA9B;;;CAIF;CACA;CACA;;;KA/CA;KAAA,iCAgDkBC,QAhDlB,EAiDC;OACC,IAAI,CAAC,KAAKS,WAAL,EAAD,IAAuB,KAAKf,QAAhC,EACA;SACCM,QAAQ;SACR;;;OAGD,KAAKA,QAAL,GAAgBA,QAAhB;OACAE,6BAAY,CAACQ,IAAb,CAAkB,KAAKX,SAAvB;;OAEA,IAAI,KAAKY,mBAAL,EAAJ,EACA;SACCX,QAAQ;;;;KA7DX;KAAA,sCAkEC;OACC,IAAI,CAACQ,EAAE,CAAChB,WAAJ,IAAmB,CAACgB,EAAE,CAAChB,WAAH,CAAeoB,OAAvC,EACA;SACC,OAAO,KAAP;;;OAGD,OAAOJ,EAAE,CAAChB,WAAH,CAAeqB,KAAf,CAAqBL,EAAE,CAAChB,WAAH,CAAeoB,OAApC,CAAP;;;CAIF;CACA;CACA;CACA;CACA;;;KAhFA;KAAA,uBAiFQE,IAjFR,EAiFcC,YAjFd,EAkFC;OACC,OAAO,KAAKtB,OAAL,CAAauB,cAAb,CAA4BF,IAA5B,IAAoC,KAAKrB,OAAL,CAAaqB,IAAb,CAApC,GAAyDC,YAAhE;;;GAnFF;CAAA;;;;;;;;"}