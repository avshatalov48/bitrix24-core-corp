{"version":3,"file":"form.bundle.js","sources":["../src/form.js"],"sourcesContent":["import {Tag, Text} from 'main.core';\nimport {Type} from 'main.core';\nimport \"ui.forms\";\n\nexport class Form\n{\n\tconstructor(id, options = {\n\t\tconfig: [],\n\t\tfields: [],\n\t\tdata: [],\n\t\tclasses: {},\n\t\tcontainer: null\n\t})\n\t{\n\t\tthis.id = id;\n\t\tthis.config = options.config;\n\t\tthis.fields = options.fields;\n\t\tthis.data = options.data;\n\t\tif(options.container)\n\t\t{\n\t\t\tthis.setContainer(options.container);\n\t\t}\n\t\tthis.classes = new Map([\n\t\t\t['sectionContainer', 'salescenter-form-settings-section'],\n\t\t\t['sectionTitle', 'ui-title-6'],\n\t\t\t['controlContainer', 'salescenter-control-container'],\n\t\t\t['controlRequired', 'salescenter-control-required'],\n\t\t\t['subtextContainer', 'salescenter-subtext-container'],\n\t\t\t['subtextLink', 'ui-link ui-link-dashed'],\n\t\t\t['controlTitle', 'ui-ctl-label-text'],\n\t\t\t['controlInner', 'ui-ctl ui-ctl-w100'],\n\t\t\t['controlAfterIcon', 'ui-ctl-after-icon'],\n\t\t\t['controlSelect', 'ui-ctl-dropdown ui-ctl-after-icon'],\n\t\t\t['controlSelectIcon', 'ui-ctl-after ui-ctl-icon-angle'],\n\t\t\t['controlFile', 'ui-ctl-file-btn ui-ctl-w33'],\n\t\t\t['controlInput', 'ui-ctl-element'],\n\t\t\t['controlCheckbox', 'ui-ctl-checkbox'],\n\t\t\t['controlCheckboxLabel', 'ui-ctl-label-text'],\n\t\t]);\n\n\t\tif(Type.isPlainObject(options.classes))\n\t\t{\n\t\t\tthis.classes.forEach((value, name) =>\n\t\t\t{\n\t\t\t\tif(Type.isString(options.classes[name]))\n\t\t\t\t{\n\t\t\t\t\tthis.classes[name] = options.classes[name];\n\t\t\t\t}\n\t\t\t})\n\t\t}\n\t}\n\n\tstatic getByName(collection, name)\n\t{\n\t\tlet items = [];\n\t\tif(Type.isArray(collection) && Type.isString(name))\n\t\t{\n\t\t\titems = collection.filter((item) =>\n\t\t\t{\n\t\t\t\treturn item.name === name;\n\t\t\t});\n\t\t\tif(items.length > 0)\n\t\t\t{\n\t\t\t\treturn items[0];\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t}\n\n\t/**\n\t * @param {HTMLElement|null} nodeTo\n\t * @returns {HTMLElement[]}\n\t */\n\trender(nodeTo = null)\n\t{\n\t\tlet result = '';\n\t\tthis.config.forEach((section) =>\n\t\t{\n\t\t\tresult += this.renderSection(section);\n\t\t});\n\n\t\tlet nodes = Tag.render`${result}`;\n\t\tif(!Type.isArray(nodes))\n\t\t{\n\t\t\tnodes = [nodes];\n\t\t}\n\n\t\tif(Type.isDomNode(nodeTo))\n\t\t{\n\t\t\tnodes.forEach((node) =>\n\t\t\t{\n\t\t\t\tnodeTo.appendChild(node);\n\t\t\t})\n\t\t}\n\n\t\treturn nodes;\n\t}\n\n\t/**\n\t * @param field\n\t * @returns {HTMLElement}\n\t */\n\trenderField(field)\n\t{\n\t\tlet result = '';\n\t\tif (!Type.isObject(field))\n\t\t{\n\t\t\treturn result;\n\t\t}\n\n\t\tif (!field.html)\n\t\t{\n\t\t\tfield.html = this.renderFieldInput(field);\n\t\t}\n\n\t\tif (Type.isDomNode(field.html))\n\t\t{\n\t\t\tfield.input = field.html;\n\t\t\tfield.html = field.html.innerHTML;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tfield.input = Tag.render`${field.html}`;\n\t\t}\n\n\t\tlet label = '';\n\t\tlet hint = '';\n\t\tif (field.hint)\n\t\t{\n\t\t\thint = Tag.render`<span class=\"ui-ctl-after\" data-hint=\"${Text.encode(field.hint)}\"></span>`;\n\t\t}\n\n\t\tlet title = '';\n\t\tif (field.title)\n\t\t{\n\t\t\ttitle = Tag.render`<div class=\"${this.classes.get('controlTitle')} ${field.required ? this.classes.get('controlRequired') : ''}\">${Text.encode(field.title)}</div>`;\n\t\t}\n\n\t\tlet subtextLink = '';\n\t\tif (field.subtextLinkOnClick && field.subtextLinkText)\n\t\t{\n\t\t\tsubtextLink = Tag.render`<a onclick=\"${Text.encode(field.subtextLinkOnClick)}\" class=\"${this.classes.get('subtextLink')}\">${Text.encode(field.subtextLinkText)}</a>`;\n\t\t}\n\n\t\tlet subtext = '';\n\t\tif (field.subtext)\n\t\t{\n\t\t\tsubtext = Tag.render`<div class=\"${this.classes.get('subtextContainer')}\">${Text.encode(field.subtext)} ${subtextLink}</div>`;\n\t\t}\n\n\t\tif (field.html.indexOf('type=\"checkbox\"') > 0)\n\t\t{\n\t\t\tlabel = Tag.render`<label class=\"${this.classes.get('controlInner')} ${this.classes.get('controlCheckbox')}\">${field.input}${field.title ? '<div class=\"' + this.classes.get('controlCheckboxLabel') + '\">' + Text.encode(field.title) + '</div>' : ''}${hint}</label>`;\n\t\t}\n\t\telse if (field.type === 'file')\n\t\t{\n\t\t\tlet hiddenFileInput = '';\n\t\t\tif (field.addHidden === true)\n\t\t\t{\n\t\t\t\tconst hiddenFileField = {\n\t\t\t\t\tname: field.name,\n\t\t\t\t\ttype: 'hidden',\n\t\t\t\t\tvalue: field.value,\n\t\t\t\t};\n\t\t\t\thiddenFileInput = this.renderFieldInput(hiddenFileField);\n\t\t\t}\n\t\t\tlabel = Tag.render`\n\t\t\t\t${title}\n\t\t\t\t<label class=\"${this.classes.get('controlInner')} ${this.classes.get('controlFile')}\">\n\t\t\t\t${field.input}\n\t\t\t\t${field.label ? '<div class=\"ui-ctl-label-text\">' + Text.encode(field.label) + '</div>' : ''}\n\t\t\t\t</label>\n\t\t\t\t<span></span>\n\t\t\t\t${hiddenFileInput}\n\t\t\t\t${subtext}\n\t\t\t`;\n\t\t}\n\t\telse if (field.type === 'list' || field.html.indexOf('select') > 0)\n\t\t{\n\t\t\tlabel = Tag.render`\n\t\t\t\t${title}\n\t\t\t\t<div class=\"${this.classes.get('controlSelect')} ${this.classes.get('controlInner')}\">\n\t\t\t\t\t<div class=\"${this.classes.get('controlSelectIcon')}\"></div>\n\t\t\t\t\t${field.input}\n\t\t\t\t</div>\n\t\t\t\t${subtext}\n\t\t\t`;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tlabel = Tag.render`\n\t\t\t\t${title}\n\t\t\t\t<div class=\"${this.classes.get('controlInner')}${hint ? ' ' + this.classes.get('controlAfterIcon') : ''}\">\n\t\t\t\t\t${field.input}${hint}\n\t\t\t\t</div>\n\t\t\t\t${subtext}\n\t\t\t`;\n\t\t}\n\n\t\tresult = Tag.render`<div class=\"${this.classes.get('controlContainer')}\">${label}</div>`;\n\n\t\treturn result;\n\t}\n\n\t/**\n\t * @param field\n\t * @returns {string}\n\t */\n\trenderFieldInput(field)\n\t{\n\t\tlet result = '';\n\t\tlet type = field.type;\n\t\tif(!type)\n\t\t{\n\t\t\ttype = 'text';\n\t\t}\n\n\t\tlet value = '';\n\t\tif(field.hasOwnProperty('value'))\n\t\t{\n\t\t\tvalue = Text.encode(field.value);\n\t\t}\n\t\telse if(this.data[field.name])\n\t\t{\n\t\t\tvalue = Text.encode(this.data[field.name]);\n\t\t}\n\n\t\tlet required = '';\n\t\tif(field.required === true)\n\t\t{\n\t\t\trequired = ' required=\"required\"';\n\t\t}\n\n\t\tlet attribute = '';\n\t\tif (field.attribute && Type.isArray(field.attribute))\n\t\t{\n\t\t\tattribute = field.attribute.join(' ');\n\t\t}\n\n\t\tif(type === 'text')\n\t\t{\n\t\t\tresult = `<input name=\"${field.name}\"\n\t\t\t\tclass=\"${this.classes.get('controlInput')}\"\n\t\t\t\tvalue=\"${value}\"${required}\n\t\t\t\ttype=\"text\"\n\t\t\t\t${attribute}>`\n\t\t\t;\n\t\t}\n\t\telse if(type === 'boolean')\n\t\t{\n\t\t\tvalue = 'Y';\n\t\t\tresult =`<input type=\"checkbox\" name=\"${Text.encode(field.name)}\"${this.data[field.name] === value ? ' checked=\"checked\"' : ''}${field.disabled ? ' disabled=\"disabled\"' : ''}${required}\n\t\t\t\tvalue=\"${value}\" class=\"${this.classes.get('controlInput')}\">`;\n\t\t}\n\t\telse if(type === 'list')\n\t\t{\n\t\t\tresult = `<select class=\"${this.classes.get('controlInput')}\" name=\"${Text.encode(field.name)}\"${required}>`;\n\t\t\tif(field.data && Type.isArray(field.data.items))\n\t\t\t{\n\t\t\t\tfield.data.items.forEach((item) =>\n\t\t\t\t{\n\t\t\t\t\tresult += `<option${Type.isString(item.VALUE) ? ' value=\"' + Text.encode(item.VALUE) + '\"' : ''}${item.SELECTED ? ' selected=\"selected\"' : ''}>${Text.encode(item.NAME)}</option>`;\n\t\t\t\t});\n\t\t\t}\n\t\t\tresult += `</select>`;\n\t\t}\n\t\telse if(type === 'hidden')\n\t\t{\n\t\t\tresult = `<input name=\"${Text.encode(field.name)}\"\n\t\t\t\tvalue=\"${value}\"\n\t\t\t\ttype=\"hidden\">`\n\t\t\t;\n\t\t}\n\t\telse if(type === 'file')\n\t\t{\n\t\t\tconst onFileChange = ({target}) =>\n\t\t\t{\n\t\t\t\tconst value = target.value.split(/(\\\\|\\/)/g).pop();\n\t\t\t\ttarget.parentNode.nextSibling.innerText = Text.encode(value);\n\t\t\t};\n\t\t\tresult = Tag.render`<input \n\t\t\t\tonchange=\"${onFileChange}\" \n\t\t\t\tname=\"${Text.encode(field.name)}\"\n\t\t\t\tvalue=\"\"\n\t\t\t\tclass=\"${this.classes.get('controlInput')}\"\n\t\t\t\ttype=\"file\">`\n\t\t\t;\n\t\t}\n\n\t\treturn result;\n\t}\n\n\t/**\n\t * @param section\n\t * @returns {HTMLElement}\n\t */\n\trenderSection(section)\n\t{\n\t\tlet result = null;\n\t\tif(!Type.isObject(section))\n\t\t{\n\t\t\treturn result;\n\t\t}\n\n\t\tif(!Type.isArray(section.elements))\n\t\t{\n\t\t\tsection.elements = [];\n\t\t}\n\n\t\tlet sectionId = '';\n\t\tif(section.name)\n\t\t{\n\t\t\tsectionId = ' id=\"' + this.id + '-' + section.name + '\"';\n\t\t}\n\n\t\tresult = `<div${sectionId} class=\"${this.classes.get('sectionContainer')}\">`;\n\t\tif(section.title)\n\t\t{\n\t\t\tresult += `<div class=\"${this.classes.get('sectionTitle')}\">${Text.encode(section.title)}</div><hr class=\"ui-hr ui-mb-15\">`;\n\t\t}\n\t\tresult += `</div>`;\n\n\t\tresult = Tag.render`${result}`;\n\n\t\tsection.elements.forEach((element) =>\n\t\t{\n\t\t\tif(Type.isObject(element) && element.name)\n\t\t\t{\n\t\t\t\tlet field = Form.getByName(this.fields, element.name);\n\t\t\t\tif(field)\n\t\t\t\t{\n\t\t\t\t\tresult.appendChild(this.renderField(field));\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn result;\n\t}\n\n\t/**\n\t * @param container\n\t */\n\tsetContainer(container)\n\t{\n\t\tif(Type.isDomNode(container))\n\t\t{\n\t\t\tthis.container = container;\n\t\t}\n\t}\n\n\t/**\n\t * @returns {HTMLElement}\n\t */\n\tgetContainer()\n\t{\n\t\tlet container = this.container;\n\t\tif(!container)\n\t\t{\n\t\t\tcontainer = document;\n\t\t}\n\n\t\treturn container;\n\t}\n\n\t/**\n\t * @param field\n\t * @returns {Element | null}\n\t */\n\tgetFieldInput(field)\n\t{\n\t\tif(!field.input)\n\t\t{\n\t\t\tlet container = this.getContainer();\n\t\t\tfield.input = container.querySelector('[name=\"' + field.name + '\"]');\n\t\t}\n\n\t\treturn field.input;\n\t}\n\n\t/**\n\t * @returns {Object}\n\t */\n\tgetData()\n\t{\n\t\tlet result = {};\n\t\tvar container = this.getContainer();\n\t\tif(container.nodeName === 'FORM')\n\t\t{\n\t\t\treturn new FormData(container);\n\t\t}\n\t\tthis.fields.forEach((field) =>\n\t\t{\n\t\t\tlet input = this.getFieldInput(field);\n\t\t\tif(Type.isDomNode(input))\n\t\t\t{\n\t\t\t\tif(input.getAttribute('type') === 'checkbox')\n\t\t\t\t{\n\t\t\t\t\tif(input.checked)\n\t\t\t\t\t{\n\t\t\t\t\t\tresult[field.name] = Text.decode(input.value);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tresult[field.name] = Text.decode(input.value);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn result;\n\t}\n}\n"],"names":["Form","id","options","config","fields","data","classes","container","setContainer","Map","Type","isPlainObject","forEach","value","name","isString","nodeTo","result","section","renderSection","nodes","Tag","render","isArray","isDomNode","node","appendChild","field","isObject","html","renderFieldInput","input","innerHTML","label","hint","Text","encode","title","get","required","subtextLink","subtextLinkOnClick","subtextLinkText","subtext","indexOf","type","hiddenFileInput","addHidden","hiddenFileField","hasOwnProperty","attribute","join","disabled","items","item","VALUE","SELECTED","NAME","onFileChange","target","split","pop","parentNode","nextSibling","innerText","elements","sectionId","element","getByName","renderField","document","getContainer","querySelector","nodeName","FormData","getFieldInput","getAttribute","checked","decode","collection","filter","length"],"mappings":"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"}