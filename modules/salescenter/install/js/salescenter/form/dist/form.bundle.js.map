{"version":3,"file":"form.bundle.js","sources":["../src/form.js"],"sourcesContent":["import {Tag, Text} from 'main.core';\nimport {Type} from 'main.core';\nimport \"ui.forms\";\n\nexport class Form\n{\n\tconstructor(id, options = {\n\t\tconfig: [],\n\t\tfields: [],\n\t\tdata: [],\n\t\tclasses: {},\n\t\tcontainer: null\n\t})\n\t{\n\t\tthis.id = id;\n\t\tthis.config = options.config;\n\t\tthis.fields = options.fields;\n\t\tthis.data = options.data;\n\t\tif(options.container)\n\t\t{\n\t\t\tthis.setContainer(options.container);\n\t\t}\n\t\tthis.classes = new Map([\n\t\t\t['sectionContainer', 'salescenter-form-settings-section'],\n\t\t\t['sectionTitle', 'ui-title-6'],\n\t\t\t['controlContainer', 'salescenter-control-container'],\n\t\t\t['controlRequired', 'salescenter-control-required'],\n\t\t\t['controlTitle', 'ui-ctl-label-text'],\n\t\t\t['controlInner', 'ui-ctl ui-ctl-w100'],\n\t\t\t['controlAfterIcon', 'ui-ctl-after-icon'],\n\t\t\t['controlSelect', 'ui-ctl-dropdown ui-ctl-after-icon'],\n\t\t\t['controlSelectIcon', 'ui-ctl-after ui-ctl-icon-angle'],\n\t\t\t['controlFile', 'ui-ctl-file-btn ui-ctl-w33'],\n\t\t\t['controlInput', 'ui-ctl-element'],\n\t\t\t['controlCheckbox', 'ui-ctl-checkbox'],\n\t\t\t['controlCheckboxLabel', 'ui-ctl-label-text'],\n\t\t]);\n\n\t\tif(Type.isPlainObject(options.classes))\n\t\t{\n\t\t\tthis.classes.forEach((value, name) =>\n\t\t\t{\n\t\t\t\tif(Type.isString(options.classes[name]))\n\t\t\t\t{\n\t\t\t\t\tthis.classes[name] = options.classes[name];\n\t\t\t\t}\n\t\t\t})\n\t\t}\n\t}\n\n\tstatic getByName(collection, name)\n\t{\n\t\tlet items = [];\n\t\tif(Type.isArray(collection) && Type.isString(name))\n\t\t{\n\t\t\titems = collection.filter((item) =>\n\t\t\t{\n\t\t\t\treturn item.name === name;\n\t\t\t});\n\t\t\tif(items.length > 0)\n\t\t\t{\n\t\t\t\treturn items[0];\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t}\n\n\t/**\n\t * @param {HTMLElement|null} nodeTo\n\t * @returns {HTMLElement[]}\n\t */\n\trender(nodeTo = null)\n\t{\n\t\tlet result = '';\n\t\tthis.config.forEach((section) =>\n\t\t{\n\t\t\tresult += this.renderSection(section);\n\t\t});\n\n\t\tlet nodes = Tag.render`${result}`;\n\t\tif(!Type.isArray(nodes))\n\t\t{\n\t\t\tnodes = [nodes];\n\t\t}\n\n\t\tif(Type.isDomNode(nodeTo))\n\t\t{\n\t\t\tnodes.forEach((node) =>\n\t\t\t{\n\t\t\t\tnodeTo.appendChild(node);\n\t\t\t})\n\t\t}\n\n\t\treturn nodes;\n\t}\n\n\t/**\n\t * @param field\n\t * @returns {HTMLElement}\n\t */\n\trenderField(field)\n\t{\n\t\tlet result = '';\n\t\tif(!Type.isObject(field))\n\t\t{\n\t\t\treturn result;\n\t\t}\n\n\t\tif(!field.html)\n\t\t{\n\t\t\tfield.html = this.renderFieldInput(field);\n\t\t}\n\n\t\tif(Type.isDomNode(field.html))\n\t\t{\n\t\t\tfield.input = field.html;\n\t\t\tfield.html = field.html.innerHTML;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tfield.input = Tag.render`${field.html}`;\n\t\t}\n\n\t\tlet label = '';\n\t\tlet hint = '';\n\t\tif(field.hint)\n\t\t{\n\t\t\thint = Tag.render`<span class=\"ui-ctl-after\" data-hint=\"${Text.encode(field.hint)}\"></span>`;\n\t\t}\n\n\t\tlet title = '';\n\t\tif(field.title)\n\t\t{\n\t\t\ttitle = `<div class=\"${this.classes.get('controlTitle')} ${field.required ? this.classes.get('controlRequired') : ''}\">${Text.encode(field.title)}</div>`;\n\t\t}\n\n\t\tif(field.html.indexOf('type=\"checkbox\"') > 0)\n\t\t{\n\t\t\tlabel = Tag.render`<label class=\"${this.classes.get('controlInner')} ${this.classes.get('controlCheckbox')}\">${field.input}${field.title ? '<div class=\"' + this.classes.get('controlCheckboxLabel') + '\">' + Text.encode(field.title) + '</div>' : ''}${hint}</label>`;\n\t\t}\n\t\telse if(field.type === 'file')\n\t\t{\n\t\t\tlet hiddenFileInput = '';\n\t\t\tif(field.addHidden === true)\n\t\t\t{\n\t\t\t\tlet hiddenFileField = {\n\t\t\t\t\tname: field.name,\n\t\t\t\t\ttype: 'hidden',\n\t\t\t\t\tvalue: field.value,\n\t\t\t\t};\n\t\t\t\thiddenFileInput = this.renderFieldInput(hiddenFileField);\n\t\t\t}\n\t\t\tlabel = Tag.render`\n\t\t\t\t${title}\n\t\t\t\t<label class=\"${this.classes.get('controlInner')} ${this.classes.get('controlFile')}\">\n\t\t\t\t${field.input}\n\t\t\t\t${field.label ? '<div class=\"ui-ctl-label-text\">' + Text.encode(field.label) + '</div>' : ''}\n\t\t\t\t</label>\n\t\t\t\t<span></span>\n\t\t\t\t${hiddenFileInput}\n\t\t\t`;\n\t\t}\n\t\telse if(field.type === 'list' || field.html.indexOf('select') > 0)\n\t\t{\n\t\t\tlabel = Tag.render`\n\t\t\t\t${title}\n\t\t\t\t<div class=\"${this.classes.get('controlSelect')} ${this.classes.get('controlInner')}\">\n\t\t\t\t\t<div class=\"${this.classes.get('controlSelectIcon')}\"></div>\n\t\t\t\t\t${field.input}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tlabel = Tag.render`\n\t\t\t\t${title}\n\t\t\t\t<div class=\"${this.classes.get('controlInner')}${hint ? ' ' + this.classes.get('controlAfterIcon') : ''}\">\n\t\t\t\t\t${field.input}${hint}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\tresult = Tag.render`<div class=\"${this.classes.get('controlContainer')}\">${label}</div>`;\n\n\t\treturn result;\n\t}\n\n\t/**\n\t * @param field\n\t * @returns {string}\n\t */\n\trenderFieldInput(field)\n\t{\n\t\tlet result = '';\n\t\tlet type = field.type;\n\t\tif(!type)\n\t\t{\n\t\t\ttype = 'text';\n\t\t}\n\n\t\tlet value = '';\n\t\tif(field.hasOwnProperty('value'))\n\t\t{\n\t\t\tvalue = Text.encode(field.value);\n\t\t}\n\t\telse if(this.data[field.name])\n\t\t{\n\t\t\tvalue = Text.encode(this.data[field.name]);\n\t\t}\n\n\t\tlet required = '';\n\t\tif(field.required === true)\n\t\t{\n\t\t\trequired = ' required=\"required\"';\n\t\t}\n\n\t\tlet attribute = '';\n\t\tif (field.attribute && Type.isArray(field.attribute))\n\t\t{\n\t\t\tattribute = field.attribute.join(' ');\n\t\t}\n\n\t\tif(type === 'text')\n\t\t{\n\t\t\tresult = `<input name=\"${field.name}\"\n\t\t\t\tclass=\"${this.classes.get('controlInput')}\"\n\t\t\t\tvalue=\"${value}\"${required}\n\t\t\t\ttype=\"text\"\n\t\t\t\t${attribute}>`\n\t\t\t;\n\t\t}\n\t\telse if(type === 'boolean')\n\t\t{\n\t\t\tvalue = 'Y';\n\t\t\tresult =`<input type=\"checkbox\" name=\"${Text.encode(field.name)}\"${this.data[field.name] === value ? ' checked=\"checked\"' : ''}${field.disabled ? ' disabled=\"disabled\"' : ''}${required}\n\t\t\t\tvalue=\"${value}\" class=\"${this.classes.get('controlInput')}\">`;\n\t\t}\n\t\telse if(type === 'list')\n\t\t{\n\t\t\tresult = `<select class=\"${this.classes.get('controlInput')}\" name=\"${Text.encode(field.name)}\"${required}>`;\n\t\t\tif(field.data && Type.isArray(field.data.items))\n\t\t\t{\n\t\t\t\tfield.data.items.forEach((item) =>\n\t\t\t\t{\n\t\t\t\t\tresult += `<option${Type.isString(item.VALUE) ? ' value=\"' + Text.encode(item.VALUE) + '\"' : ''}${item.SELECTED ? ' selected=\"selected\"' : ''}>${Text.encode(item.NAME)}</option>`;\n\t\t\t\t});\n\t\t\t}\n\t\t\tresult += `</select>`;\n\t\t}\n\t\telse if(type === 'hidden')\n\t\t{\n\t\t\tresult = `<input name=\"${Text.encode(field.name)}\"\n\t\t\t\tvalue=\"${value}\"\n\t\t\t\ttype=\"hidden\">`\n\t\t\t;\n\t\t}\n\t\telse if(type === 'file')\n\t\t{\n\t\t\tconst onFileChange = ({target}) =>\n\t\t\t{\n\t\t\t\tconst value = target.value.split(/(\\\\|\\/)/g).pop();\n\t\t\t\ttarget.parentNode.nextSibling.innerText = Text.encode(value);\n\t\t\t};\n\t\t\tresult = Tag.render`<input \n\t\t\t\tonchange=\"${onFileChange}\" \n\t\t\t\tname=\"${Text.encode(field.name)}\"\n\t\t\t\tvalue=\"\"\n\t\t\t\tclass=\"${this.classes.get('controlInput')}\"\n\t\t\t\ttype=\"file\">`\n\t\t\t;\n\t\t}\n\n\t\treturn result;\n\t}\n\n\t/**\n\t * @param section\n\t * @returns {HTMLElement}\n\t */\n\trenderSection(section)\n\t{\n\t\tlet result = null;\n\t\tif(!Type.isObject(section))\n\t\t{\n\t\t\treturn result;\n\t\t}\n\n\t\tif(!Type.isArray(section.elements))\n\t\t{\n\t\t\tsection.elements = [];\n\t\t}\n\n\t\tlet sectionId = '';\n\t\tif(section.name)\n\t\t{\n\t\t\tsectionId = ' id=\"' + this.id + '-' + section.name + '\"';\n\t\t}\n\n\t\tresult = `<div${sectionId} class=\"${this.classes.get('sectionContainer')}\">`;\n\t\tif(section.title)\n\t\t{\n\t\t\tresult += `<div class=\"${this.classes.get('sectionTitle')}\">${Text.encode(section.title)}</div><hr class=\"ui-hr ui-mb-15\">`;\n\t\t}\n\t\tresult += `</div>`;\n\n\t\tresult = Tag.render`${result}`;\n\n\t\tsection.elements.forEach((element) =>\n\t\t{\n\t\t\tif(Type.isObject(element) && element.name)\n\t\t\t{\n\t\t\t\tlet field = Form.getByName(this.fields, element.name);\n\t\t\t\tif(field)\n\t\t\t\t{\n\t\t\t\t\tresult.appendChild(this.renderField(field));\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn result;\n\t}\n\n\t/**\n\t * @param container\n\t */\n\tsetContainer(container)\n\t{\n\t\tif(Type.isDomNode(container))\n\t\t{\n\t\t\tthis.container = container;\n\t\t}\n\t}\n\n\t/**\n\t * @returns {HTMLElement}\n\t */\n\tgetContainer()\n\t{\n\t\tlet container = this.container;\n\t\tif(!container)\n\t\t{\n\t\t\tcontainer = document;\n\t\t}\n\n\t\treturn container;\n\t}\n\n\t/**\n\t * @param field\n\t * @returns {Element | null}\n\t */\n\tgetFieldInput(field)\n\t{\n\t\tif(!field.input)\n\t\t{\n\t\t\tlet container = this.getContainer();\n\t\t\tfield.input = container.querySelector('[name=\"' + field.name + '\"]');\n\t\t}\n\n\t\treturn field.input;\n\t}\n\n\t/**\n\t * @returns {Object}\n\t */\n\tgetData()\n\t{\n\t\tlet result = {};\n\t\tvar container = this.getContainer();\n\t\tif(container.nodeName === 'FORM')\n\t\t{\n\t\t\treturn new FormData(container);\n\t\t}\n\t\tthis.fields.forEach((field) =>\n\t\t{\n\t\t\tlet input = this.getFieldInput(field);\n\t\t\tif(Type.isDomNode(input))\n\t\t\t{\n\t\t\t\tif(input.getAttribute('type') === 'checkbox')\n\t\t\t\t{\n\t\t\t\t\tif(input.checked)\n\t\t\t\t\t{\n\t\t\t\t\t\tresult[field.name] = Text.decode(input.value);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tresult[field.name] = Text.decode(input.value);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn result;\n\t}\n}\n"],"names":["Form","id","options","config","fields","data","classes","container","setContainer","Map","Type","isPlainObject","forEach","value","name","isString","nodeTo","result","section","renderSection","nodes","Tag","render","isArray","isDomNode","node","appendChild","field","isObject","html","renderFieldInput","input","innerHTML","label","hint","Text","encode","title","get","required","indexOf","type","hiddenFileInput","addHidden","hiddenFileField","hasOwnProperty","attribute","join","disabled","items","item","VALUE","SELECTED","NAME","onFileChange","target","split","pop","parentNode","nextSibling","innerText","elements","sectionId","element","getByName","renderField","document","getContainer","querySelector","nodeName","FormData","getFieldInput","getAttribute","checked","decode","collection","filter","length"],"mappings":"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"}