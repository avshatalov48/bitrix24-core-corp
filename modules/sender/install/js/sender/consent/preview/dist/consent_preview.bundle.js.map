{"version":3,"file":"consent_preview.bundle.js","sources":["../src/view/previewcontent.js","../src/consent_preview.js"],"sourcesContent":["import {Tag, Event} from \"main.core\";\n\nexport default class PreviewContent\n{\n\tconstructor()\n\t{\n\t\tthis.isActive= false;\n\t\tthis.text =  '';\n\t\tthis.approveBtn =  '';\n\t\tthis.rejectBtn = '';\n\t\tthis.activeTab = 'desktop';\n\t\tthis.activeClass = 'sender-message-editor--slider-desktop';\n\n\t\treturn this;\n\t}\n\n\tchangeActiveTab(activeTab)\n\t{\n\t\tthis.activeTab = activeTab;\n\t\tthis.activeClass = 'sender-message-editor--slider-' + activeTab;\n\t\tthis.reDraw();\n\t}\n\n\tsetActive(active)\n\t{\n\t\tthis.isActive = active;\n\t\tthis.reDraw();\n\t}\n\n\tsetText(text)\n\t{\n\t\tthis.text = text;\n\t\tthis.reDraw();\n\t}\n\n\tsetApproveBtn(accept)\n\t{\n\t\tthis.approveBtn = BX.util.htmlspecialchars(accept);\n\t\tthis.reDraw();\n\t}\n\n\tsetRejectBtn(reject)\n\t{\n\t\tthis.rejectBtn = BX.util.htmlspecialchars(reject);\n\t\tthis.reDraw();\n\t}\n\n\tgetTemplate()\n\t{\n\t\tconst tabletActive = this.activeTab === 'tablet' ? 'active' : '';\n\t\tconst mobileActive = this.activeTab === 'mobile' ? 'active' : '';\n\t\tconst desktopActive = this.activeTab === 'desktop' ? 'active' : '';\n\t\treturn Tag.render`\n\t\t\t<div class=\"sender-js-slider-contents\">\n\t\t\t\t<div class=\"ui-slider-section sender-message-editor--slider-modifier ${this.activeClass}\">\n\t\t\t\t\t<div class=\"sender-ui-panel-top-devices\">\n\t\t\t\t\t\t<div class=\"sender-ui-panel-top-devices-inner\">\n\t\t\t\t\t\t<button \n\t\t\t\t\t\tclass=\"sender-ui-button sender-ui-button-desktop sender-js-slider-modifier ${desktopActive}\" \n\t\t\t\t\t\tdata-id=\"desktop\"></button>\n\t\t\t\t\t\t<button \n\t\t\t\t\t\tclass=\"sender-ui-button sender-ui-button-tablet sender-js-slider-modifier  ${tabletActive}\"\n\t\t\t\t\t\tdata-id=\"tablet\"></button>\n\t\t\t\t\t\t<button class=\"sender-ui-button sender-ui-button-mobile sender-js-slider-modifier  ${mobileActive}\"\n\t\t\t\t\t\tdata-id=\"mobile\"></button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"ui-slider-content-box\">\n\t\t\t\t\t<div class=\"sender-message-mailing-icon\"></div>\n\t\t\t\t\t${this.text}\n\t\t\t\t\t<div class=\"ui-btn-container ui-btn-container-center\">\n\t\t\t\t\t\t<button class=\"ui-btn ui-btn-success\">${this.approveBtn}</button>\n\t\t\t\t\t\t<button class=\"ui-btn ui-btn-light-border\">${this.rejectBtn}</button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t`;\n\t}\n\n\tbindEvent()\n\t{\n\t\tconst buttons = window.top.document.querySelectorAll('.sender-js-slider-modifier');\n\n\t\tbuttons.forEach((element) => {\n\t\t\tconst type = element.dataset.id || 'desktop';\n\t\t\tEvent.bind(element, 'click', this.changeActiveTab.bind(this, type));\n\t\t});\n\t}\n\n\treDraw()\n\t{\n\t\t// BX.SidePanel.Slider.top\n\t\tconst content = window.top.document.querySelector('div.sender-js-slider-contents');\n\n\t\tif (!content)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tconst parentNode = content.parentNode;\n\n\t\tparentNode.removeChild(content);\n\n\t\tparentNode.append(this.getTemplate());\n\t\tthis.bindEvent();\n\t}\n};\n","import {Layout} from 'ui.sidepanel.layout';\nimport PreviewContent from './view/previewcontent.js';\n\nexport class ConsentPreview\n{\n\n\tconstructor()\n\t{\n\t}\n\n\tstatic open(consentId)\n\t{\n\t\tif (!consentId)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst view = (new PreviewContent());\n\t\tBX.SidePanel.Instance.open(\"sender:consent-preview\", {\n\t\t\twidth: 800,\n\t\t\tcacheable: false,\n\t\t\tcontentCallback: () => {\n\t\t\t\treturn Layout.createContent({\n\t\t\t\t\textensions:[\n\t\t\t\t\t\t'ui.buttons',\n\t\t\t\t\t\t'ui.buttons.icons',\n\t\t\t\t\t\t'ui.notification',\n\t\t\t\t\t\t'ui.sidepanel-content',\n\t\t\t\t\t\t'ui.sidepanel.layout',\n\t\t\t\t\t\t'sender.consent.preview',\n\t\t\t\t\t],\n\t\t\t\t\tcontent ()\n\t\t\t\t\t{\n\t\t\t\t\t\tBX.ajax.runAction('sender.consentPreview.loadData', {\n\t\t\t\t\t\t\tjson: {\n\t\t\t\t\t\t\t\tid:consentId\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t}).then((response) => {\n\t\t\t\t\t\t\t\tview.setText(response.data.consentBody) || \"\";\n\t\t\t\t\t\t\t\tview.setApproveBtn(response.data.approveBtnText);\n\t\t\t\t\t\t\t\tview.setRejectBtn(response.data.rejectBtnText);\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t(response) => {\n\t\t\t\t\t\t\t\t// view.setText(response.data.consent);\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\treturn view.getTemplate();\n\t\t\t\t\t},\n\t\t\t\t\tbuttons ({cancelButton})\n\t\t\t\t\t{\n\t\t\t\t\t\treturn [\n\t\t\t\t\t\t\tcancelButton,\n\t\t\t\t\t\t];\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t},\n\t\t});\n\t}\n\n}"],"names":["PreviewContent","isActive","text","approveBtn","rejectBtn","activeTab","activeClass","reDraw","active","accept","BX","util","htmlspecialchars","reject","tabletActive","mobileActive","desktopActive","Tag","render","buttons","window","top","document","querySelectorAll","forEach","element","type","dataset","id","Event","bind","changeActiveTab","content","querySelector","parentNode","removeChild","append","getTemplate","bindEvent","ConsentPreview","consentId","view","SidePanel","Instance","open","width","cacheable","contentCallback","Layout","createContent","extensions","ajax","runAction","json","then","response","setText","data","consentBody","setApproveBtn","approveBtnText","setRejectBtn","rejectBtnText","cancelButton"],"mappings":"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"}