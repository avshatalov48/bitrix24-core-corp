this.BX=this.BX||{};(function(e,t,i){"use strict";function l(e,t){a(e,t);t.add(e)}function s(e,t,i){a(e,t);t.set(e,i)}function a(e,t){if(t.has(e)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}function r(e,t,i){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return i}var n=new WeakMap;var c=new WeakMap;var h=new WeakMap;var o=new WeakMap;var u=new WeakMap;var d=new WeakSet;var v=function(){function e(i){babelHelpers.classCallCheck(this,e);l(this,d);s(this,n,{writable:true,value:void 0});s(this,c,{writable:true,value:void 0});s(this,h,{writable:true,value:void 0});s(this,o,{writable:true,value:void 0});s(this,u,{writable:true,value:void 0});babelHelpers.classPrivateFieldSet(this,c,i.button);babelHelpers.classPrivateFieldSet(this,h,i.targetInput);babelHelpers.classPrivateFieldSet(this,u,i.fields);babelHelpers.classPrivateFieldSet(this,o,i.onItemClick||{});t.Event.bind(babelHelpers.classPrivateFieldGet(this,c),"click",this.openMenu.bind(this))}babelHelpers.createClass(e,[{key:"setName",value:function e(i){if(t.Type.isString(i)){this.name=i}}},{key:"getName",value:function e(){return this.name}},{key:"onKeyDown",value:function e(t,i){if(i.keyCode==45&&i.altKey===false&&i.ctrlKey===false&&i.shiftKey===false){this.openMenu(i);i.preventDefault()}}},{key:"openMenu",value:function e(l){var s=this;if(babelHelpers.classPrivateFieldGet(this,n)){babelHelpers.classPrivateFieldGet(this,n).show();return}var a=[];var h={ROOT:{title:t.Loc.getMessage("SENDER_PERSONALIZATION_SELECTOR_ROOT"),entityId:"sender",tabs:"recents",id:"ROOT",children:[]}};r(this,d,p).call(this,babelHelpers.classPrivateFieldGet(this,u),h);if(Object.keys(h).length<2){if(h["ROOT"]["children"].length>0){a=h["ROOT"]["children"]}}else{if(h["ROOT"]["children"].length>0){a.push(h["ROOT"])}delete h["ROOT"];for(var v in h){if(h.hasOwnProperty(v)&&h[v]["children"].length>0){a.push(h[v])}}}babelHelpers.classPrivateFieldSet(this,n,new i.EntitySelector.Dialog({targetNode:babelHelpers.classPrivateFieldGet(this,c),tagSelectorOptions:{textBoxWidth:500},width:500,height:300,multiple:false,dropdownMode:true,enableSearch:true,items:this.injectDialogMenuTitles(a.reverse()),showAvatars:false,events:{"Item:onBeforeSelect":t.Type.isFunction(babelHelpers.classPrivateFieldGet(this,o))?babelHelpers.classPrivateFieldGet(this,o):function(e){e.preventDefault();s.onFieldSelect(e.getData().item.getCustomData().get("property"))}},compactView:true}));babelHelpers.classPrivateFieldGet(this,n).show()}},{key:"injectDialogMenuTitles",value:function e(i){var l=this;i.forEach((function(e){if(t.Type.isArray(e.children)){e.searchable=false;l.injectDialogMenuSupertitles(e.title,e.children)}}),this);return i}},{key:"injectDialogMenuSupertitles",value:function e(i,l){l.forEach((function(e){if(!e.supertitle){e.supertitle=i}if(t.Type.isArray(e.children)){e.searchable=false;this.injectDialogMenuSupertitles(e.title,e.children)}}),this)}},{key:"onFieldSelect",value:function e(t){if(!t){return}babelHelpers.classPrivateFieldGet(this,h).value=babelHelpers.classPrivateFieldGet(this,h).value+t.id}},{key:"destroy",value:function e(){if(babelHelpers.classPrivateFieldGet(this,n)){babelHelpers.classPrivateFieldGet(this,n).destroy()}}}]);return e}();function p(e,t){var i=this;e.forEach((function(e){var l=e.id.indexOf(".")<0?e.items&&e.items.length>0?e.id:"ROOT":e.id.split(".")[0]+"#";if(!e.text&&!e.title){return}if(!t[l]){t[l]={title:e.text||e.title,entityId:"sender",tabs:"recents",tabId:"sender",id:e.id,children:[]}}if(e.items&&e.items.length>0){r(i,d,p).call(i,e.items,t);return}t[l]["children"].push({title:e.text||e.title,customData:{property:e},entityId:"sender",tabs:"recents",id:e.id})}))}e.PersonalizationSelector=v})(this.BX.Sender=this.BX.Sender||{},BX,BX.UI.EntitySelector);
//# sourceMappingURL=personalization_selector.bundle.map.js