(function(t){if(!t.BX){t.BX={}}if(BX.AjaxAction){return}var e=function(t){this.controllerUri=t};e.prototype.mess=function(t){return BX.message("MAIN_AJAX_ACTION_"+(t||"").toUpperCase())||""};e.prototype.getRequestingUri=function(t,e,s){e=e||{};e.action=t;e.sessid=BX.bitrix_sessid();return BX.util.add_url_param(s||this.controllerUri,e)};e.prototype.confirmDelete=function(t,e,s){this.confirm(this.mess("confirm_delete").replace("%name%",t||""),e,this.mess("delete"),s)};e.prototype.confirm=function(t,e,s,o){s=s||this.mess("apply");if(!this.confirmPopup){this.confirmPopup=BX.PopupWindowManager.create("main_ajax_action_confirm",null,{autoHide:true,lightShadow:true,closeByEsc:true,overlay:{backgroundColor:"black",opacity:500}});this.confirmPopup.setButtons([new BX.PopupWindowButton({text:s,className:"popup-window-button-accept",events:{click:this.onConfirmPopup.bind(this,e)}}),new BX.PopupWindowButton({text:this.mess("cancel"),events:{click:this.onConfirmPopup.bind(this,o)}})])}var i="main-ajax-action-text main-ajax-action-confirm";t=t||this.mess("confirm");t=BX.util.htmlspecialchars(t);this.confirmPopup.setContent('<span class="'+i+'">'+t+"</span>");this.confirmPopup.show()};e.prototype.onConfirmPopup=function(t){this.confirmPopup.close();if(!t){return}if(BX.type.isFunction(t)){t.apply(this)}else if(BX.type.isPlainObject(t)){this.request(t)}};e.prototype.showResult=function(t){if(!this.resultPopup){this.resultPopup=BX.PopupWindowManager.create("main_ajax_action_result",null,{autoHide:true,lightShadow:true,closeByEsc:true,overlay:{backgroundColor:"black",opacity:500}});this.resultPopup.setButtons([new BX.PopupWindowButton({text:this.mess("close"),events:{click:this.resultPopup.close.bind(this.resultPopup)}})])}var e="main-ajax-action-text main-ajax-action-result-"+(t.error?"error":"success");var s=t.text||(t.error?this.mess("error"):this.mess("success"));s=BX.util.htmlspecialchars(s);this.resultPopup.setContent('<span class="'+e+'">'+s+"</span>");this.resultPopup.show()};e.prototype.requestHtml=function(t){t.method=t.method||"GET";t.dataType="html";t.processData=t.processData||false;this.request(t)};e.prototype.request=function(t){var e=t.action;var s=t.data||{};var o=t.urlParams||{};var i=t.onsuccess||null;var r=t.onfailure||null;var n=t.onusererror||null;var a=t.showErrors!==undefined?!!t.showErrors:true;var p=t.showSuccess||false;var u=t.url||this.controllerUri;var c=t.method||"POST";if(c==="GET"){u=this.getRequestingUri(e,s,u)}else{u=BX.util.add_url_param(u,BX.merge({action:e},o))}var l=t.dataType||"json";var h=t.processData!==undefined?!!t.processData:true;s.action=e;s.sessid=BX.bitrix_sessid();BX.ajax({url:u,method:c,data:s,timeout:t.timeout||30,dataType:l,processData:h,onsuccess:this.onResponse.bind(this,p,a,i,r,n),onfailure:this.onResponseFailure.bind(this,a,r)})};e.prototype.onResponse=function(t,e,s,o,i,r){r=r||{};if(r.error){if(r.code&&i&&BX.type.isFunction(i[r.code])){i[r.code].apply(this,[r])}else{this.onResponseFailure(e,o,r)}}else{if(t){this.showResult(r)}if(BX.type.isFunction(s)){s.apply(this,[r])}}};e.prototype.onResponseFailure=function(t,e,s){s=BX.type.isPlainObject(s)?s:{};s.error=true;s.text=s.text||this.mess("error");if(t){this.showResult(s)}if(BX.type.isFunction(e)){e.apply(this,[s])}};BX.AjaxAction=e})(window);
//# sourceMappingURL=script.map.js