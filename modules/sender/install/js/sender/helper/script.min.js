(function(t){BX.namespace("BX.Sender");if(BX.Sender.Helper){return}var e={hint:{attributeName:"data-hint",attributeInitName:"data-hint-init",popup:null,content:null,init:function(t){t=t||document.body;var e=t.querySelectorAll("["+this.attributeName+"]");e=BX.convert.nodeListToArray(e);e.forEach(this.initNode,this)},initNode:function(t){if(t.getAttribute(this.attributeInitName)){return}t.setAttribute(this.attributeInitName,"y");var e=t.getAttribute(this.attributeName);if(e===""||e===null){return}BX.addClass(t,"sender-hint");t.innerHTML='<div class="sender-hint-icon"></div>';BX.bind(t,"mouseenter",this.show.bind(this,t,e));BX.bind(t,"mouseleave",this.hide.bind(this,t))},show:function(t,e){if(this.content===null){this.content=document.createElement("div");this.content.style.margin="7px";this.content.style.maxWidth="400px";this.popup=new BX.PopupWindow("sender-helper-hint",t,{zIndex:1e3,darkMode:true,content:this.content})}this.content.innerHTML=e;this.popup.setBindElement(t);this.popup.show()},hide:function(){if(!this.popup){return}this.popup.close()}},tag:{attributeName:"data-tag",attributeInitName:"data-tag-init",popup:null,init:function(t,e){if(!t||!e){return}t=t||document.body;var i=t.querySelectorAll("["+this.attributeName+"]");i=BX.convert.nodeListToArray(i);i.forEach(this.initNode.bind(this,e))},initNode:function(t,e){if(e.getAttribute(this.attributeInitName)){return}e.setAttribute(this.attributeInitName,"y");var i=e.getAttribute(this.attributeName);if(!i){return}BX.addClass(e,"sender-tag");e.innerHTML='<span class="sender-tag-icon"></span>';try{i=JSON.parse(i)}catch(t){i=null}if(!i){return}BX.bind(e,"click",this.show.bind(this,t,e,i))},onClick:function(t,e,i){t.value=t.value+i.id;this.hide()},show:function(t,e,i){if(!this.popup){this.popup=new BX.PopupMenuWindow("sender-helper-hint-tag-"+(t.name||t.id),e,i.map(function(i){i.onclick=this.onClick.bind(this,t,e,i);return i},this),{autoHide:true,autoClose:true},{events:{onclick:function(){}}})}this.popup.bindElement=e;this.popup.show()},hide:function(){if(!this.popup){return}this.popup.close()}},titleEditor:{isInit:false,init:function(t){this.dataNode=t.dataNode;this.titleNode=BX("pagetitle");this.inputNode=BX("pagetitle_input");this.buttonNode=BX("pagetitle_edit");this.initialTitle=this.titleNode.textContent;this.defaultTitle=t.defaultTitle;BX.bind(this.dataNode,"bxchange",this.onDataNodeChange.bind(this));BX.bind(this.buttonNode,"click",this.startEdit.bind(this));BX.bind(this.inputNode,"keyup",this.onKeyUp.bind(this));BX.bind(this.inputNode,"blur",this.endEdit.bind(this));this.isInit=true;if(!t.disabled){this.enable()}if(!this.dataNode.value){this.dataNode.value=this.defaultTitle}},enable:function(t){t=t||false;if(!this.isInit){return}e.changeDisplay(this.buttonNode,!t);this.titleNode.textContent=!t?this.dataNode.value?this.dataNode.value:this.defaultTitle:this.initialTitle},disable:function(){this.enable(true)},onDataNodeChange:function(){this.titleNode.textContent=this.dataNode.value},onKeyUp:function(e){e=e||t.event;if(e.keyCode===10||e.keyCode===13){this.endEdit();e.preventDefault();return false}},getTitle:function(){var t=this.dataNode.value;if(!t){t=this.titleNode.textContent}return t},startEdit:function(){this.inputNode.value=this.getTitle();e.changeDisplay(this.titleNode,false);e.changeDisplay(this.buttonNode,false);e.changeDisplay(this.inputNode,true);this.inputNode.focus()},endEdit:function(){this.dataNode.value=this.inputNode.value;this.titleNode.textContent=this.inputNode.value;e.changeDisplay(this.inputNode,false);e.changeDisplay(this.buttonNode,true);e.changeDisplay(this.titleNode,true)}},getObjectByKey:function(t,e,i){var n=t.filter(function(t){return t.hasOwnProperty(e)&&t[e]===i});return n.length>0?n[0]:null},changeClass:function(t,e,i){if(!t){return}i?BX.addClass(t,e):BX.removeClass(t,e)},replace:function(t,e,i){e=e||{};i=i||false;if(!t){return""}for(var n in e){if(!e.hasOwnProperty(n)){continue}var a=e[n];a=a||"";if(!i&&a){a=BX.util.htmlspecialchars(a)}t=t.replace(new RegExp("%"+n+"%","g"),a)}return t},getNode:function(t,e){var i=this.getNodes(t,e);return i.length>0?i[0]:null},getNodes:function(t,e){if(!BX.type.isDomNode(e)){return[]}return BX.convert.nodeListToArray(e.querySelectorAll('[data-role="'+t+'"]'))},safe:function(t){return BX.util.htmlspecialchars(t)},getTemplate:function(t,i,n){if(!t){return null}return e.replace(t.innerHTML,i,n)},getTemplatedNode:function(t,e,i){if(!t){return null}if(BX.type.isDomNode(t)){t=this.getTemplate(t,e,i)}if(!t){return null}var n=document.createElement("div");n.innerHTML=t;return n.children.length>0?n.children[0]:null},handleKeyEnter:function(e,i){if(!i){return}var n=function(e){e=e||t.event;if(e.keyCode===10||e.keyCode===13){e.preventDefault();e.stopPropagation();i();return false}};BX.bind(e,"keyup",n)},changeDisplay:function(t,e){return this.display.change(t,e,true)},animate:{numbers:function(t,e){e=BX.type.isString(e)?e.replace(/[^0-9]/,""):e;var i=parseInt(t.tagName==="INPUT"?t.value:t.textContent.replace(/[^0-9]/,""));if(isNaN(i)){i=0}var n=new BX.easing({duration:500,start:{num:i},finish:{num:e},transition:BX.easing.transitions.quart,step:function(e){var i=BX.util.number_format(e.num,0,"."," ");if(t.tagName==="INPUT"){t.value=i}else{t.textContent=i}},complete:function(){}});n.animate()}},display:{animateShowing:function(t,e){e=e||false;var i=new BX.easing({duration:500,start:{height:0,opacity:e?30:100},finish:{height:1e5,opacity:100},transition:BX.easing.transitions.quart,step:function(e){t.style.opacity=e.opacity/100;t.style.maxHeight=e.height+"px";t.style.height=null;t.style.display="";var n=BX.pos(t);if(n.height<e.height){i.stop(true)}},complete:function(){}});i.animate()},animateHiding:function(t,e,i){e=e||false;var n=BX.pos(t);var a=new BX.easing({duration:300,start:{height:n.height,opacity:80},finish:{height:0,opacity:e?30:100},transition:BX.easing.transitions.quart,step:function(e){t.style.maxHeight=e.height+"px";t.style.height=null;t.style.opacity=e.opacity/100},complete:function(){t.style.display="none";t.style.opacity=0;if(i){i.apply(this)}}});a.animate()},change:function(t,e,i){i=BX.type.isBoolean(i)?i:false;if(!t){return}if(i){t.style.display=e?"":"none";return}if(e===this.isShowed(t)){return}var n=true;if(!e){this.animateHiding(t,n)}else{this.animateShowing(t,n)}},toggle:function(t,e){if(!t){return}this.change(t,!this.isShowed(t),e)},isShowed:function(t){if(!t){return false}return!(t.style.display==="none")}}};BX.Sender.Helper=e})(window);