(function(){BX.namespace("BX.Sender.Call");if(BX.Sender.Call.TextEditor){return}var t=BX.Sender.Helper;function e(){}e.prototype.init=function(e){this.context=BX(e.containerId);this.speechRates=e.speechRates;this.speechRateInterval=e.speechRateInterval;this.mess=e.mess;this.AITextContextId=e.AITextContextId;this.isAITextAvailable=e.isAITextAvailable==="Y";this.input=t.getNode("input",this.context);this.counter=t.getNode("counter",this.context);this.num=t.getNode("num",this.context);this.sms=t.getNode("sms",this.context);this.speed=document.getElementsByName(e.speedInputName);this.speed=this.speed.length>0?this.speed.item(0):null;BX.bind(this.input,"bxchange",this.onChange.bind(this));BX.bind(this.input,"input",this.onChange.bind(this));if(this.speed){BX.bind(this.speed,"bxchange",this.onChange.bind(this))}this.initPanelToolsButtons();this.refresh()};e.prototype.initPanelToolsButtons=function(){if(this.isAITextAvailable){const t=this.context.querySelector('[data-bx-call-panel-tools-button="ai-text"]');t.addEventListener("click",(()=>{const t=new BX.AI.Picker({moduleId:"sender",contextId:this.AITextContextId,analyticLabel:"sender_call_ai_text",history:true,onSelect:t=>{const e=t.data;this.input.value=this.input.value+e},onTariffRestriction:()=>{}});t.setLangSpace(BX.AI.Picker.LangSpace.text);t.text()}))}};e.prototype.onChange=function(){this.refresh()};e.prototype.refresh=function(){var t=this.input.value;var e=this.getRatioPerChar();var n=t.length===0?0:Math.floor(t.length*e)+1;this.counter.textContent=BX.date.format("sdiff",Date.now()/1e3-n)};e.prototype.getRatioPerChar=function(){var t=this.speechRateInterval;var e=this.speechRates;var n=this.speed?this.speed.value:null;var i=e[n];if(!i){i=e["medium"]}return t/i};BX.Sender.Call.TextEditor=new e})(window);
//# sourceMappingURL=script.map.js