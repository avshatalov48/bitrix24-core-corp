(function(){BX.namespace("BX.Sender.UI");if(BX.Sender.UI.UserSelector){return}function e(e){this.caller=e.caller;this.ajaxAction=new BX.AjaxAction(e.actionUri);this.container=BX(e.containerId);this.id=e.id;this.containerId=e.containerId;this.inputId=e.inputName;this.inputNode=this.container.querySelector('input[name="'+e.inputName+'"]');this.selector=BX.Sender.UI.TileSelector.getById(this.id);if(!this.selector){throw new Error("Tile selector `"+this.id+"` not found.")}this.searchInputNode=this.selector.getSearchInput();if(!this.searchInputNode.id){this.searchInputNode.id=this.inputId+"-search-input"}BX.addCustomEvent(this.selector,this.selector.events.buttonSelect,this.openDialog.bind(this));BX.addCustomEvent(this.selector,this.selector.events.tileRemove,this.removeTile.bind(this));BX.Sender.UI.UserSelectorController.init(this)}e.prototype={openDialog:function(){BX.Sender.UI.UserSelectorController.open(this)},removeTile:function(e){this.unsetValue(e.id)},setUsers:function(e){e=e||[];this.inputNode.value=e.join(",")},getUsers:function(){if(!this.inputNode){return[]}var e=this.inputNode.value.split(",");return e.filter(function(e){e=parseInt(e);return!!e}).map(function(e){return parseInt(e)})},setValue:function(e){if(/^\d+$/.test(e)!==true){return}e=parseInt(e);if(this.selectOne){this.setUsers([e])}else{var t=this.getUsers();if(!BX.util.in_array(e,t)){t.push(e)}this.setUsers(t)}},unsetValue:function(e){if(/^\d+$/.test(e)!==true){return}e=parseInt(e);if(this.selectOne){this.setUsers()}else{var t=this.getUsers().filter(function(t){return t!==e});this.setUsers(t)}}};var t={list:[],init:function(e){this.list.push(e);BX.onCustomEvent(window,"BX.Sender.UI.UserSelectorController::init",[{id:e.id,inputId:e.searchInputNode.id,containerId:e.containerId,openDialogWhenInit:false}])},open:function(e){if(e.isOpen){return}if(BX.UI.SelectorManager){var t=e.id;var r=BX.UI.SelectorManager.instances[e.id];if(r){r.itemsSelected={};e.getUsers().forEach(function(e){r.itemsSelected[e]="users"});r.nodes.input=e.selector.input;r.nodes.tag=e.selector.buttonSelect}}e.isOpen=true;BX.onCustomEvent(window,"BX.Sender.UI.UserSelectorController::open",[{id:e.id,inputId:e.searchInputNode.id,containerId:e.containerId,bindNode:e.container}])},select:function(e){var t=BX.Sender.UI.UserSelectorController;var r=t.getUserSelector(e.selectorId);if(!r){return}r.setValue(e.item.entityId);r.selector.addTile(e.item.name,{},e.item.entityId)},unSelect:function(e){var t=BX.Sender.UI.UserSelectorController;var r=t.getUserSelector(e.selectorId);if(!r){return}r.unsetValue(e.item.entityId);var n=r.selector.getTile(e.item.entityId);r.selector.removeTile(n)},closeDialog:function(e){var t=BX.Sender.UI.UserSelectorController;var r=t.getUserSelector(e.selectorId);if(!r){return}r.isOpen=false;if(r.selector){r.selector.input.style.display="none";r.selector.buttonSelect.style.display=""}},openSearch:function(e){var t=BX.Sender.UI.UserSelectorController;var r=t.getUserSelector(e.selectorId);if(!r){return}r.isOpen=false;if(r.selector){r.selector.input.style.display="";r.selector.buttonSelect.style.display="none"}},closeSearch:function(e){var t=BX.Sender.UI.UserSelectorController;var r=t.getUserSelector(e.selectorId);if(!r){return}r.isOpen=false;if(r.selector){r.selector.input.value="";r.selector.input.style.display="none";r.selector.buttonSelect.style.display=""}},getUserSelector:function(e){var t=this.list.filter(function(t){return t.id===e});return t[0]}};if(!BX.Sender.UI.UserSelectorController){BX.Sender.UI.UserSelectorController=t}BX.Sender.UI.UserSelector=e})(window);
//# sourceMappingURL=script.map.js