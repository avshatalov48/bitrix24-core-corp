(function(){BX.namespace("BX.Sender.Call");if(BX.Sender.Call.Number){return}var t=BX.Sender.Helper;function e(){}e.prototype.init=function(e){this.context=BX(e.containerId);this.selectorNode=t.getNode("number-selector",this.context);this.inputNode=t.getNode("number-input",this.context);this.list=e.list;var o=this.list.map(function(t){return{id:t.id,text:t.name,onclick:this.onSelect.bind(this,t)}},this);if(this.list.length>0){BX.bind(this.selectorNode,"click",this.showMenu.bind(this,this.selectorNode,o,"main"));var i=this.inputNode.value;i=i?i:this.list[0].id;var n=this.list.filter(function(t){return i.toString()===t.id.toString()});var s=n.length>0?n[0]:this.list[0];this.setNumber(s)}else{var p={id:"",name:this.selectorNode.getAttribute("data-setup-name")};this.setNumber(p);var r=this.selectorNode.getAttribute("data-setup-uri");BX.bind(this.selectorNode,"click",function(){top.location.href=r})}};e.prototype.setNumber=function(t){this.selectorNode.textContent=t.name;this.inputNode.value=t.id};e.prototype.onSelect=function(t,e){this.setNumber(t);this.closeMenu()};e.prototype.showMenu=function(t,e,o){this.popup=this.createMenu("sender-call-number-"+o,t,e);this.popup.popupWindow.show()};e.prototype.createMenu=function(t,e,o,i){i=i||{};return BX.PopupMenu.create(t,e,o,{autoHide:true,offsetLeft:i.offsetLeft?i.offsetLeft:-21,offsetTop:i.offsetTop?i.offsetTop:-3,angle:{position:"top",offset:42},events:{onPopupClose:BX.delegate(this.onPopupClose,this)}})};e.prototype.closeMenu=function(){if(this.popup&&this.popup.popupWindow){this.popup.popupWindow.close()}};BX.Sender.Call.Number=new e})(window);