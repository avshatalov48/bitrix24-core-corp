{"version":3,"file":"monitor.bundle.js","sources":["../src/model/utils/code.js","../src/model/utils/time.js","../src/lib/logger.js","../src/lib/debug.js","../src/lib/action-timer.js","../src/lib/notification.js","../src/model/monitor.js","../src/model/entity.js","../src/eventhandler.js","../src/sender.js","../src/lib/commandhandler.js","../src/monitor.js"],"sourcesContent":["import {md5} from 'main.md5';\nimport {sha1} from 'main.sha1';\n\nexport class Code\n{\n\tstatic createPublic(...params)\n\t{\n\t\treturn md5(params.join(''));\n\t}\n\n\tstatic createPrivate(...params)\n\t{\n\t\treturn sha1(params.join(''));\n\t}\n\n\tstatic createSecret()\n\t{\n\t\tif (typeof BXDesktopSystem === 'undefined')\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn Code.createPrivate(\n\t\t\tBXDesktopSystem.UserAccount(),\n\t\t\tBXDesktopSystem.UserOsMark(),\n\t\t\t+Date.now(),\n\t\t);\n\t}\n\n\tstatic getDesktopCode()\n\t{\n\t\tif (typeof BXDesktopSystem === 'undefined')\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn Code.createPublic(\n\t\t\tBXDesktopSystem.UserAccount(),\n\t\t\tBXDesktopSystem.UserOsMark()\n\t\t);\n\t}\n}","export class Time\n{\n\tstatic calculateInEntityOnADate(state, entity, date)\n\t{\n\t\treturn state.history\n\t\t\t.filter(entry => (\n\t\t\t\tentry.privateCode === entity.privateCode\n\t\t\t\t&& entry.dateLog === date\n\t\t\t))\n\t\t\t.map(Time.calculateInEntry)\n\t\t\t.reduce((sum, time) => sum + time, 0);\n\t}\n\n\tstatic calculateInEntry(entry)\n\t{\n\t\tconst time = entry.time\n\t\t\t.map(interval => {\n\t\t\t\tconst finish = interval.finish ? new Date(interval.finish) : new Date();\n\n\t\t\t\treturn finish - new Date(interval.start);\n\t\t\t})\n\t\t\t.reduce((sum, interval) => sum + interval, 0);\n\n\t\treturn Math.round(time / 1000);\n\t}\n\n\tstatic formatDateToTime(date: Date)\n\t{\n\t\tconst addZero = num => (num >= 0 && num <= 9) ? '0' + num : num;\n\n\t\tconst hour = date.getHours();\n\t\tconst min = addZero(date.getMinutes());\n\n\t\treturn hour + ':' + min;\n\t}\n\n\tstatic msToSec(ms)\n\t{\n\t\treturn ms / 1000;\n\t}\n}","import {Type} from 'main.core';\nimport {Monitor} from '../monitor';\n\nclass Logger\n{\n\tconstructor()\n\t{\n\t\tthis.storageKey = 'bx-timeman-monitor-logger-enabled';\n\t\tthis.enabled = null;\n\t}\n\n\tstart()\n\t{\n\t\tif (!Monitor.isEnabled())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.enabled = true;\n\n\t\tif (typeof window.localStorage !== 'undefined')\n\t\t{\n\t\t\ttry\n\t\t\t{\n\t\t\t\twindow.localStorage.setItem(this.storageKey, 'Y');\n\t\t\t}\n\t\t\tcatch(e) {}\n\t\t}\n\n\t\treturn this.enabled;\n\t}\n\n\tstop()\n\t{\n\t\tthis.enabled = false;\n\n\t\tif (typeof window.localStorage !== 'undefined')\n\t\t{\n\t\t\ttry\n\t\t\t{\n\t\t\t\twindow.localStorage.removeItem(this.storageKey);\n\t\t\t}\n\t\t\tcatch(e) {}\n\t\t}\n\n\t\treturn this.enabled;\n\t}\n\n\tisEnabled()\n\t{\n\t\tif (!Monitor.isEnabled())\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tif (this.enabled === null)\n\t\t{\n\t\t\tif (typeof window.localStorage !== 'undefined')\n\t\t\t{\n\t\t\t\ttry\n\t\t\t\t{\n\t\t\t\t\tthis.enabled = window.localStorage.getItem(this.storageKey) === 'Y';\n\t\t\t\t}\n\t\t\t\tcatch(e) {}\n\t\t\t}\n\t\t}\n\n\t\treturn this.enabled === true;\n\t}\n\n\tlog(...params)\n\t{\n\t\tif (this.isEnabled())\n\t\t{\n\t\t\tconsole.log(...params);\n\t\t}\n\t}\n\n\tinfo(...params)\n\t{\n\t\tif (this.isEnabled())\n\t\t{\n\t\t\tconsole.info(...params);\n\t\t}\n\t}\n\n\twarn(...params)\n\t{\n\t\tif (this.isEnabled())\n\t\t{\n\t\t\tconsole.warn(...params);\n\t\t}\n\t}\n\n\terror(...params)\n\t{\n\t\tconsole.error(...params);\n\t}\n\n\ttrace(...params)\n\t{\n\t\tconsole.trace(...params);\n\t}\n}\n\nlet logger = new Logger();\n\nexport {logger as Logger};","import {Loc} from 'main.core';\n\nclass Debug\n{\n\tconstructor()\n\t{\n\t\tthis.enabled = false;\n\t}\n\n\tisEnabled()\n\t{\n\t\treturn this.enabled;\n\t}\n\n\tenable()\n\t{\n\t\tthis.enabled = true;\n\t}\n\n\tdisable()\n\t{\n\t\tthis.enabled = false;\n\t}\n\n\tlog(...params)\n\t{\n\t\tif (!this.isEnabled())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet text = this.getLogMessage(...params);\n\n\t\tBX.desktop.log(Loc.getMessage('USER_ID') + '.monitor.log', text.substr(3));\n\t}\n\n\tspace()\n\t{\n\t\tif (!this.isEnabled())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tBX.desktop.log(Loc.getMessage('USER_ID') + '.monitor.log', ' ');\n\t}\n\n\tgetLogMessage()\n\t{\n\t\tif (!this.isEnabled())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet text = '';\n\n\t\tfor (let i = 0; i < arguments.length; i++)\n\t\t{\n\t\t\tif(arguments[i] instanceof Error)\n\t\t\t{\n\t\t\t\ttext = arguments[i].message + \"\\n\" + arguments[i].stack\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\ttry\n\t\t\t\t{\n\t\t\t\t\ttext = text+' | '+(typeof(arguments[i]) == 'object'? JSON.stringify(arguments[i]): arguments[i]);\n\t\t\t\t}\n\t\t\t\tcatch (e)\n\t\t\t\t{\n\t\t\t\t\ttext = text+' | (circular structure)';\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn text;\n\t}\n}\n\nlet debug = new Debug();\n\nexport {debug as Debug};","class ActionTimer\n{\n\tconstructor()\n\t{\n\t\tthis.actionsCollection = {};\n\t}\n\n\tstart(key)\n\t{\n\t\tthis.actionsCollection[key] = {};\n\t\tthis.actionsCollection[key].start = Date.now();\n\t}\n\n\tfinish(key)\n\t{\n\t\tif (\n\t\t\t!this.actionsCollection[key]\n\t\t\t|| !this.actionsCollection[key].start\n\t\t\t|| this.actionsCollection[key].finish\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.actionsCollection[key].finish = Date.now();\n\t}\n\n\tgetDuration(key)\n\t{\n\t\tif (\n\t\t\t!this.actionsCollection[key]\n\t\t\t|| !this.actionsCollection[key].start\n\t\t\t|| !this.actionsCollection[key].finish\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst timeInSeconds = (this.actionsCollection[key].finish - this.actionsCollection[key].start) / 1000;\n\n\t\treturn `ACTION: ${key}, TIME: ${timeInSeconds.toFixed(2)}s`;\n\t}\n}\n\nlet actionTimer = new ActionTimer();\n\nexport {actionTimer as ActionTimer};","import {Type} from 'main.core';\n\nexport class Notification\n{\n\tconstructor(title, text, callback)\n\t{\n\t\tthis.title = title.toString();\n\t\tthis.text = text.toString();\n\n\t\tif (Type.isFunction(callback))\n\t\t{\n\t\t\tthis.callback = callback;\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tshow()\n\t{\n\t\tBXIM.playSound('newMessage1');\n\n\t\tconst messageTemplate = BXIM.notify.createNotify({\n\t\t\tid: 0, type: 4,\n\t\t\tdate: new Date(),\n\t\t\tparams: {},\n\t\t\ttitle: this.title,\n\t\t\ttext: this.text,\n\t\t}, true);\n\n\t\tconst messageJs = `\n\t\t\tvar notify = BX.findChildByClassName(document.body, \"bx-notifier-item\");\n\t\t\t\n\t\t\tnotify.style.cursor = \"pointer\";\n\t\t\t\n\t\t\tBX.bind(notify, \"click\", function() {\n\t\t\t\tBX.desktop.onCustomEvent(\"main\", \"bxImClickPwtMessage\", []);\n\t\t\t\tBX.desktop.windowCommand(\"close\")\n\t\t\t});\n\t\t\t\n\t\t\tBX.bind(BX.findChildByClassName(notify, \"bx-notifier-item-delete\"), \"click\", function(event) { \n\t\t\t\tBX.desktop.windowCommand(\"close\"); \n\t\t\t\tBX.MessengerCommon.preventDefault(event); \n\t\t\t});\n\t\t\t\n\t\t\tBX.bind(notify, \"contextmenu\", function() {\n\t\t\t\tBX.desktop.windowCommand(\"close\")\n\t\t\t});\n\t\t`;\n\n\t\tBXIM.desktop.openNewMessage('pwt' + (new Date), messageTemplate, messageJs);\n\n\t\tBX.desktop.addCustomEvent('bxImClickPwtMessage', () => this.click());\n\t}\n\n\tclick()\n\t{\n\t\tif (Type.isFunction(this.callback))\n\t\t{\n\t\t\tthis.callback();\n\t\t}\n\n\t\tBX.desktop.removeCustomEvents('bxImClickPwtMessage');\n\t}\n}","import {Loc, Type} from 'main.core';\nimport {VuexBuilderModel} from 'ui.vue.vuex';\nimport {EntityType, EntityGroup} from 'timeman.const';\nimport {Code} from './utils/code';\nimport {Time} from './utils/time';\nimport {Logger} from '../lib/logger';\nimport {Debug} from '../lib/debug';\nimport {ActionTimer} from '../lib/action-timer';\nimport {DateFormatter} from 'timeman.dateformatter';\nimport {Notification} from \"../lib/notification\";\n\nexport class MonitorModel extends VuexBuilderModel\n{\n\tgetName()\n\t{\n\t\treturn 'monitor';\n\t}\n\n\tgetSaveTimeout()\n\t{\n\t\treturn 1000;\n\t}\n\n\tgetLoadTimeout()\n\t{\n\t\treturn false;\n\t}\n\n\tgetState()\n\t{\n\t\treturn {\n\t\t\tconfig: {\n\t\t\t\tsecret: Code.createSecret(),\n\t\t\t\tdesktopCode: Code.getDesktopCode(),\n\t\t\t\totherTime: this.getVariable('config.otherTime', 1800000),\n\t\t\t\tshortAbsenceTime: this.getVariable('config.shortAbsenceTime', 1800000),\n\t\t\t\tpausedUntil: null,\n\t\t\t\tlastSuccessfulSendDate: null,\n\t\t\t\tlastRemindDate: null,\n\t\t\t\tgrantingPermissionDate: null,\n\t\t\t\tdeferredGrantingPermissionShowDate: null,\n\t\t\t},\n\t\t\treportState: {\n\t\t\t\tdateLog: this.getDateLog(),\n\t\t\t\tcomments: [],\n\t\t\t},\n\t\t\tpersonal: [],\n\t\t\tstrictlyWorking: [],\n\t\t\tentity: [],\n\t\t\thistory: [],\n\t\t\tsentQueue: [],\n\t\t};\n\t}\n\n\tgetEntityState()\n\t{\n\t\treturn {\n\t\t\ttype: EntityType.unknown,\n\t\t\ttitle: '',\n\t\t\tpublicCode: '',\n\t\t\tprivateCode: '',\n\t\t\tcomments: [],\n\t\t\textra: {},\n\t\t};\n\t}\n\n\tgetHistoryState()\n\t{\n\t\treturn {\n\t\t\tdateLog: this.getDateLog(),\n\t\t\tprivateCode: '',\n\t\t\ttime: [{\n\t\t\t\tstart: new Date(),\n\t\t\t\tpreFinish: null,\n\t\t\t\tfinish: null\n\t\t\t}]\n\t\t};\n\t}\n\n\tgetSentQueueState()\n\t{\n\t\treturn {\n\t\t\tdateLog: this.getDateLog(),\n\t\t\tcomment: '',\n\t\t\thistoryPackage: [],\n\t\t\tchartPackage: [],\n\t\t\tdesktopCode: '',\n\t\t};\n\t}\n\n\tgetActions()\n\t{\n\t\treturn {\n\t\t\tsetDateLog: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (Type.isString(payload))\n\t\t\t\t{\n\t\t\t\t\tconst date = new Date(payload);\n\n\t\t\t\t\tif (\n\t\t\t\t\t\tType.isDate(date)\n\t\t\t\t\t\t&& !isNaN(date)\n\t\t\t\t\t\t&& payload.length === 10\n\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\tstore.commit('setDateLog', payload);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\n\t\t\trefreshDateLog: (store) =>\n\t\t\t{\n\t\t\t\tif (Type.isArrayFilled(store.state.history))\n\t\t\t\t{\n\t\t\t\t\tlet firstHistoryEntryDateLog = store.state.history[0].dateLog;\n\t\t\t\t\tthis.getActions().setDateLog(store, firstHistoryEntryDateLog);\n\n\t\t\t\t\tLogger.log(`Report date is set for ${firstHistoryEntryDateLog}`);\n\t\t\t\t\tDebug.log(`Report date is set for ${firstHistoryEntryDateLog}`);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tlet dateLog = this.getDateLog();\n\t\t\t\t\tthis.getActions().setDateLog(store, dateLog);\n\n\t\t\t\t\tLogger.log(`Report date is set for ${dateLog}`);\n\t\t\t\t\tDebug.log(`Report date is set for ${dateLog}`);\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tsetLastRemindDate: (store, date) =>\n\t\t\t{\n\t\t\t\tstore.commit('setLastRemindDate', date);\n\t\t\t},\n\n\t\t\tgrantPermission: (store) =>\n\t\t\t{\n\t\t\t\tstore.commit('setGrantingPermissionDate', new Date());\n\t\t\t},\n\n\t\t\tshowGrantingPermissionLater: (store) =>\n\t\t\t{\n\t\t\t\tlet date = new Date();\n\t\t\t\tdate.setDate(date.getDate() + 1);\n\n\t\t\t\tlet formattedDate = MonitorModel.prototype.formatDateLog(date);\n\n\t\t\t\tstore.commit('setDeferredGrantingPermissionShowDate', formattedDate);\n\t\t\t},\n\n\t\t\tsetLastSuccessfulSendDate: (store, date) =>\n\t\t\t{\n\t\t\t\tif (\n\t\t\t\t\tType.isDate(date)\n\t\t\t\t\t&& !isNaN(date)\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('setLastSuccessfulSendDate', date);\n\t\t\t\t}\n\t\t\t},\n\n\t\t\taddPersonal: (store, privateCode) =>\n\t\t\t{\n\t\t\t\tstore.commit('addPersonal', this.validatePersonal(privateCode));\n\t\t\t},\n\n\t\t\tremovePersonal: (store, privateCode) =>\n\t\t\t{\n\t\t\t\tstore.commit('removePersonal', this.validatePersonal(privateCode));\n\t\t\t},\n\n\t\t\taddToStrictlyWorking: (store, privateCode) =>\n\t\t\t{\n\t\t\t\tstore.commit('addToStrictlyWorking', privateCode);\n\t\t\t},\n\n\t\t\tremoveFromStrictlyWorking: (store, privateCode) =>\n\t\t\t{\n\t\t\t\tstore.commit('removeFromStrictlyWorking', privateCode);\n\t\t\t},\n\n\t\t\tclearStrictlyWorking: (store) =>\n\t\t\t{\n\t\t\t\tstore.commit('clearStrictlyWorking');\n\t\t\t},\n\n\t\t\tclearPersonal: (store) =>\n\t\t\t{\n\t\t\t\tstore.commit('clearPersonal');\n\t\t\t},\n\n\t\t\taddEntity: (store, payload) =>\n\t\t\t{\n\t\t\t\tlet result = this.validateEntity({...payload});\n\n\t\t\t\tif (\n\t\t\t\t\tresult.type !== EntityType.absence\n\t\t\t\t\t&& result.type !== EntityType.custom\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tresult.publicCode = Code.createPublic(result.title);\n\t\t\t\t\tresult.privateCode = Code.createPrivate(result.title, store.state.config.secret);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tconst date = new Date();\n\t\t\t\t\tconst timestamp = +date;\n\n\t\t\t\t\tresult.publicCode = Code.createPublic(result.title, timestamp);\n\t\t\t\t\tresult.privateCode = Code.createPrivate(result.title, timestamp, store.state.config.secret);\n\n\t\t\t\t\tif (result.type === EntityType.absence)\n\t\t\t\t\t{\n\t\t\t\t\t\tresult.extra = {\n\t\t\t\t\t\t\ttimeStart: date,\n\t\t\t\t\t\t};\n\t\t\t\t\t\tresult.title +=\n\t\t\t\t\t\t\t' '\n\t\t\t\t\t\t\t+ Loc.getMessage('TIMEMAN_PWT_REPORT_ABSENCE_FROM_TIME')\n\t\t\t\t\t\t\t+ ' '\n\t\t\t\t\t\t\t+ Time.formatDateToTime(result.extra.timeStart)\n\t\t\t\t\t\t;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tstore.commit('addEntity', {\n\t\t\t\t\t...this.getEntityState(),\n\t\t\t\t\t...result,\n\t\t\t\t});\n\n\t\t\t\tif (!store.state.strictlyWorking.find(privateCode => privateCode === result.privateCode))\n\t\t\t\t{\n\t\t\t\t\tconst isBitrix24Cp = (\n\t\t\t\t\t\tresult.type === EntityType.site\n\t\t\t\t\t\t&& result.title === location.host\n\t\t\t\t\t);\n\n\t\t\t\t\tconst isBitrix24Desktop = (\n\t\t\t\t\t\tresult.type === EntityType.app\n\t\t\t\t\t\t&& payload.isBitrix24Desktop\n\t\t\t\t\t);\n\n\t\t\t\t\tif (\n\t\t\t\t\t\tisBitrix24Cp\n\t\t\t\t\t\t|| isBitrix24Desktop\n\t\t\t\t\t\t|| result.type === EntityType.custom\n\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\tstore.commit('addToStrictlyWorking', result.privateCode);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn result;\n\t\t\t},\n\n\t\t\tremoveEntityByPrivateCode: (store, payload) =>\n\t\t\t{\n\t\t\t\tstore.commit('removeEntityByPrivateCode', payload);\n\t\t\t},\n\n\t\t\tclearEntities: (store) =>\n\t\t\t{\n\t\t\t\tstore.commit('clearEntities');\n\t\t\t},\n\n\t\t\taddHistory: (store, payload) =>\n\t\t\t{\n\t\t\t\tstore.commit('finishLastInterval');\n\n\t\t\t\tconst result = this.validateHistory({...payload});\n\n\t\t\t\tlet entity;\n\t\t\t\tlet privateCode;\n\t\t\t\tlet historyEntry = null;\n\n\t\t\t\tif (\n\t\t\t\t\tresult.type === EntityType.app\n\t\t\t\t\t|| result.type === EntityType.site\n\t\t\t\t\t|| result.type === EntityType.unknown\n\t\t\t\t\t|| result.type === EntityType.incognito\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tentity = this.getEntityByTitle(store, result.title);\n\t\t\t\t\tprivateCode = (entity ? entity.privateCode : null);\n\n\t\t\t\t\tif (!privateCode)\n\t\t\t\t\t{\n\t\t\t\t\t\tprivateCode = this.getActions().addEntity(store, payload).privateCode;\n\t\t\t\t\t}\n\n\t\t\t\t\thistoryEntry = (entity && entity.type === EntityType.site)\n\t\t\t\t\t\t? this.getHistoryEntryBySiteUrl(store, result.siteUrl)\n\t\t\t\t\t\t: this.getHistoryEntryByPrivateCode(store, privateCode);\n\t\t\t\t}\n\t\t\t\telse if (\n\t\t\t\t\tresult.type === EntityType.absence\n\t\t\t\t\t|| result.type === EntityType.custom\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tentity = this.getActions().addEntity(store, payload);\n\t\t\t\t\tprivateCode = entity.privateCode;\n\t\t\t\t}\n\n\t\t\t\tconst logEntity = {\n\t\t\t\t\ttype: result.type,\n\t\t\t\t\ttitle: result.title,\n\t\t\t\t};\n\n\t\t\t\tif (!historyEntry)\n\t\t\t\t{\n\t\t\t\t\tdelete result.title;\n\n\t\t\t\t\tstore.commit('addHistory', {\n\t\t\t\t\t\t...this.getHistoryState(),\n\t\t\t\t\t\t...result,\n\t\t\t\t\t\tprivateCode,\n\t\t\t\t\t});\n\n\t\t\t\t\tActionTimer.finish('CATCH_ENTITY');\n\t\t\t\t\tDebug.log('Caught new:', logEntity, ActionTimer.getDuration('CATCH_ENTITY'));\n\t\t\t\t\tLogger.log('Caught new:', logEntity, ActionTimer.getDuration('CATCH_ENTITY'));\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (result.type !== EntityType.custom)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('startIntervalForHistoryEntry', historyEntry);\n\t\t\t\t}\n\n\t\t\t\tlet lastRemindDate = store.state.config.lastRemindDate;\n\t\t\t\tlet canShowReminder = new Date(lastRemindDate) < new Date(this.getDateLog());\n\t\t\t\tlet isHistorySent = this.getGetters().isHistorySent(store.state);\n\n\t\t\t\tif (!lastRemindDate || (canShowReminder && !isHistorySent))\n\t\t\t\t{\n\t\t\t\t\tif (this.getGetters().getWorkingTimeForToday(store.state) >= 32400) //9 hour in seconds\n\t\t\t\t\t{\n\t\t\t\t\t\tnew Notification(\n\t\t\t\t\t\t\tLoc.getMessage('TIMEMAN_PWT_REPORT_NOTIFICATION_REMINDER_TITLE'),\n\t\t\t\t\t\t\tLoc.getMessage('TIMEMAN_PWT_REPORT_NOTIFICATION_REMINDER_TEXT'),\n\t\t\t\t\t\t\t() => {\n\t\t\t\t\t\t\t\tBX.desktop.windowCommand(\"show\");\n\t\t\t\t\t\t\t\tBX.desktop.changeTab('im');\n\t\t\t\t\t\t\t\tBX.MessengerWindow.changeTab('timeman-pwt');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t).show();\n\n\t\t\t\t\t\tstore.commit('setLastRemindDate', this.getDateLog());\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tActionTimer.finish('CATCH_ENTITY');\n\t\t\t\tDebug.log('Caught:', logEntity, ActionTimer.getDuration('CATCH_ENTITY'));\n\t\t\t\tLogger.log('Caught:', logEntity, ActionTimer.getDuration('CATCH_ENTITY'));\n\t\t\t},\n\n\t\t\tpreFinishLastInterval: (store) =>\n\t\t\t{\n\t\t\t\tstore.commit('preFinishLastInterval');\n\t\t\t},\n\n\t\t\tfinishLastInterval: (store) =>\n\t\t\t{\n\t\t\t\tstore.commit('finishLastInterval');\n\t\t\t},\n\n\t\t\tclearHistory: (store) =>\n\t\t\t{\n\t\t\t\tstore.commit('clearHistory');\n\t\t\t},\n\n\t\t\tcreateSentQueue: (store) =>\n\t\t\t{\n\t\t\t\tif (store.state.history.length === 0)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tlet sentQueue = this.collectSentQueue(store);\n\t\t\t\tlet reportComment = store.state.reportState.comments\n\t\t\t\t\t.find(comment => comment.dateLog === store.state.reportState.dateLog);\n\n\t\t\t\tlet result = this.validateSentQueue({\n\t\t\t\t\tdateLog: store.state.reportState.dateLog,\n\t\t\t\t\tcomment: reportComment ? reportComment.text : '',\n\t\t\t\t\thistoryPackage: sentQueue.history,\n\t\t\t\t\tchartPackage: sentQueue.chart,\n\t\t\t\t\tdesktopCode: store.state.config.desktopCode,\n\t\t\t\t});\n\n\t\t\t\tstore.commit('createSentQueue', {\n\t\t\t\t\t...this.getSentQueueState(),\n\t\t\t\t\t...result\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tclearSentQueue: (store) =>\n\t\t\t{\n\t\t\t\tstore.commit('clearSentQueue');\n\t\t\t},\n\n\t\t\tclearSentHistory: (store) =>\n\t\t\t{\n\t\t\t\tlet lastSuccessfulSendDate = store.state.config.lastSuccessfulSendDate;\n\t\t\t\tif (!lastSuccessfulSendDate)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (new Date(this.getDateLog()) > new Date(lastSuccessfulSendDate))\n\t\t\t\t{\n\t\t\t\t\tstore.commit('clearStorageBeforeDate', new Date(lastSuccessfulSendDate));\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tclearStorageBeforeDate: (store, date) =>\n\t\t\t{\n\t\t\t\tstore.commit('clearStorageBeforeDate', new Date(date));\n\t\t\t},\n\n\t\t\tsetComment: (store, payload) =>\n\t\t\t{\n\t\t\t\tconst entity = store.state.entity.find(entity => entity.privateCode === payload.privateCode);\n\n\t\t\t\tif (entity && (Type.isString(payload.comment) || Type.isNumber(payload.comment)))\n\t\t\t\t{\n\t\t\t\t\tstore.commit('setComment', {\n\t\t\t\t\t\tentity,\n\t\t\t\t\t\tcomment: payload.comment.toString()\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tsetPausedUntil: (store, dateTime) =>\n\t\t\t{\n\t\t\t\tif (\n\t\t\t\t\tType.isDate(dateTime)\n\t\t\t\t\t&& Type.isNumber(dateTime.getTime())\n\t\t\t\t\t&& dateTime > new Date()\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('setPausedUntil', dateTime);\n\n\t\t\t\t\tLogger.warn('Monitor paused until ', dateTime.toString());\n\t\t\t\t\tDebug.log('Monitor paused until ', dateTime.toString());\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tclearPausedUntil: (store) =>\n\t\t\t{\n\t\t\t\tstore.commit('clearPausedUntil');\n\t\t\t},\n\n\t\t\tsetReportComment: (store, comment) =>\n\t\t\t{\n\t\t\t\tstore.commit('setReportComment', comment.toString());\n\t\t\t},\n\n\t\t\tprocessUnfinishedEvents: (store) =>\n\t\t\t{\n\t\t\t\tstore.commit('processUnfinishedEvents');\n\t\t\t},\n\n\t\t\tmigrateHistory: (store) =>\n\t\t\t{\n\t\t\t\tstore.commit('migrateHistory');\n\t\t\t}\n\t\t}\n\t}\n\n\tgetMutations()\n\t{\n\t\treturn {\n\t\t\tsetDateLog: (state, payload) =>\n\t\t\t{\n\t\t\t\tstate.reportState.dateLog = payload;\n\n\t\t\t\tsuper.saveState(state);\n\t\t\t},\n\n\t\t\tsetLastSuccessfulSendDate: (state, date) =>\n\t\t\t{\n\t\t\t\tstate.config.lastSuccessfulSendDate = date;\n\n\t\t\t\tsuper.saveState(state);\n\t\t\t},\n\n\t\t\tsetLastRemindDate: (state, date) =>\n\t\t\t{\n\t\t\t\tstate.config.lastRemindDate = date;\n\n\t\t\t\tsuper.saveState(state);\n\t\t\t},\n\n\t\t\tsetGrantingPermissionDate: (state, date) =>\n\t\t\t{\n\t\t\t\tstate.config.grantingPermissionDate = date;\n\n\t\t\t\tsuper.saveState(state);\n\t\t\t},\n\n\t\t\tsetDeferredGrantingPermissionShowDate: (state, date) =>\n\t\t\t{\n\t\t\t\tstate.config.deferredGrantingPermissionShowDate = date;\n\n\t\t\t\tsuper.saveState(state);\n\t\t\t},\n\n\t\t\taddPersonal: (state, payload) =>\n\t\t\t{\n\t\t\t\tstate.personal.push(payload);\n\n\t\t\t\tsuper.saveState(state);\n\t\t\t},\n\n\t\t\tremovePersonal: (state, payload) =>\n\t\t\t{\n\t\t\t\tstate.personal = state.personal.filter(privateCode => privateCode !== payload);\n\n\t\t\t\tsuper.saveState(state);\n\t\t\t},\n\n\t\t\taddToStrictlyWorking: (state, payload) =>\n\t\t\t{\n\t\t\t\tstate.strictlyWorking.push(payload);\n\n\t\t\t\tsuper.saveState(state);\n\t\t\t},\n\n\t\t\tremoveFromStrictlyWorking: (state, payload) =>\n\t\t\t{\n\t\t\t\tstate.strictlyWorking = state.strictlyWorking.filter(publicCode => publicCode !== payload)\n\n\t\t\t\tsuper.saveState(state);\n\t\t\t},\n\n\t\t\tclearStrictlyWorking: (state) =>\n\t\t\t{\n\t\t\t\tstate.strictlyWorking = [];\n\n\t\t\t\tsuper.saveState(state);\n\t\t\t},\n\n\t\t\tclearPersonal: (state) =>\n\t\t\t{\n\t\t\t\tstate.personal = [];\n\n\t\t\t\tsuper.saveState(state);\n\t\t\t},\n\n\t\t\taddEntity: (state, payload) =>\n\t\t\t{\n\t\t\t\tstate.entity.push(payload);\n\n\t\t\t\tsuper.saveState(state);\n\t\t\t},\n\n\t\t\tremoveEntityByPrivateCode: (state, payload) =>\n\t\t\t{\n\t\t\t\tstate.entity = state.entity.filter(entity => entity.privateCode !== payload);\n\t\t\t\tstate.history = state.history.filter(entry => entry.privateCode !== payload);\n\t\t\t\tstate.strictlyWorking = state.strictlyWorking.filter(privateCode => privateCode !== payload);\n\t\t\t\tstate.personal = state.personal.filter(privateCode => privateCode !== payload);\n\n\t\t\t\tsuper.saveState(state);\n\t\t\t},\n\n\t\t\tclearEntities: (state) =>\n\t\t\t{\n\t\t\t\tstate.entity = [];\n\n\t\t\t\tsuper.saveState(state);\n\t\t\t},\n\n\t\t\taddHistory: (state, payload) =>\n\t\t\t{\n\t\t\t\tstate.history.push(payload);\n\n\t\t\t\tsuper.saveState(state);\n\t\t\t},\n\n\t\t\tstartIntervalForHistoryEntry: (state, historyEntry) =>\n\t\t\t{\n\t\t\t\thistoryEntry.time.push({\n\t\t\t\t\tstart: new Date(),\n\t\t\t\t\tfinish: null\n\t\t\t\t});\n\n\t\t\t\tsuper.saveState(state);\n\t\t\t},\n\n\t\t\tfinishLastInterval: (state) => {\n\t\t\t\tlet shouldRemoveTransitionInterval = false;\n\n\t\t\t\tstate.history.map(entry => {\n\t\t\t\t\tentry.time = entry.time.map(time => {\n\t\t\t\t\t\tif (time.finish === null)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttime.finish = new Date();\n\t\t\t\t\t\t\ttime.preFinish = null;\n\n\t\t\t\t\t\t\tif (new Date(time.start).getDate() !== time.finish.getDate())\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tshouldRemoveTransitionInterval = true;\n\t\t\t\t\t\t\t\ttime.markedForDeletion = true;\n\n\t\t\t\t\t\t\t\tLogger.warn('Interval marked for deletion');\n\t\t\t\t\t\t\t\tDebug.log('Interval marked for deletion');\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (entry.type !== EntityType.absence)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\treturn time;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tlet shortAbsenceTimeRest = Time.msToSec(state.config.shortAbsenceTime);\n\n\t\t\t\t\t\t\tstate.entity\n\t\t\t\t\t\t\t\t.filter(entity => {\n\t\t\t\t\t\t\t\t\tif (!state.personal.includes(entity.privateCode))\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\treturn entity;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t.map(entity => {\n\t\t\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\t\t\t...entity,\n\t\t\t\t\t\t\t\t\t\ttime: Time.calculateInEntityOnADate(state, entity, state.reportState.dateLog),\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t.sort((currentEntity, nextEntity) => currentEntity.time - nextEntity.time)\n\t\t\t\t\t\t\t\t.forEach(entity => {\n\t\t\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t\t\tstate.strictlyWorking.includes(entity.privateCode)\n\t\t\t\t\t\t\t\t\t\t|| entity.type !== EntityType.absence\n\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\tif (MonitorModel.prototype.getCommentByEntity(state, entity).trim() === '')\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tif (shortAbsenceTimeRest - entity.time >= 0)\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\tshortAbsenceTimeRest -= entity.time;\n\t\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\tstate.personal.push(entity.privateCode);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn time;\n\t\t\t\t\t}).filter(interval => !interval.markedForDeletion);\n\n\t\t\t\t\treturn entry;\n\t\t\t\t});\n\n\t\t\t\tif (shouldRemoveTransitionInterval)\n\t\t\t\t{\n\t\t\t\t\tstate.history = state.history.filter(entry => Type.isArrayFilled(entry.time));\n\t\t\t\t}\n\n\t\t\t\tsuper.saveState(state);\n\t\t\t},\n\n\t\t\tpreFinishLastInterval: (state) =>\n\t\t\t{\n\t\t\t\tstate.history = state.history.map(entry => {\n\t\t\t\t\tentry.time = entry.time.map(time => {\n\t\t\t\t\t\tif (time.finish === null)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttime.preFinish = new Date();\n\t\t\t\t\t\t\tLogger.log('Last interval for ', entry.privateCode, ' preFinished');\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn time;\n\t\t\t\t\t})\n\n\t\t\t\t\treturn entry;\n\t\t\t\t});\n\n\t\t\t\tsuper.saveState(state);\n\t\t\t},\n\n\t\t\tclearHistory: (state) =>\n\t\t\t{\n\t\t\t\tstate.history = [];\n\n\t\t\t\tsuper.saveState(state);\n\t\t\t},\n\n\t\t\tcreateSentQueue: (state, payload) =>\n\t\t\t{\n\t\t\t\tstate.sentQueue.push(payload);\n\n\t\t\t\tsuper.saveState(state);\n\t\t\t},\n\n\t\t\tclearSentQueue: (state) =>\n\t\t\t{\n\t\t\t\tstate.sentQueue = [];\n\n\t\t\t\tsuper.saveState(state);\n\t\t\t},\n\n\t\t\tclearStorageBeforeDate: (state, date) =>\n\t\t\t{\n\t\t\t\tstate.history = state.history\n\t\t\t\t\t.filter(entry => new Date(entry.dateLog) > date);\n\n\t\t\t\tconst getCodesToStore = privateCode => {\n\n\t\t\t\t\tconst entity = state.entity.find(entity => entity.privateCode === privateCode);\n\n\t\t\t\t\tif (Type.isObject(entity) && entity.hasOwnProperty('type'))\n\t\t\t\t\t{\n\t\t\t\t\t\tif (entity.type !== EntityType.absence)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst isInUnsentHistory = state.history.find(entry => entry.privateCode === privateCode);\n\t\t\t\t\t\tif (isInUnsentHistory)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tLogger.warn(`${entity.title} has been removed from personal`);\n\t\t\t\t\t\tDebug.log(`${entity.title} has been removed from personal`);\n\t\t\t\t\t}\n\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tstate.personal = state.personal.filter(getCodesToStore);\n\t\t\t\tstate.strictlyWorking = state.strictlyWorking.filter(getCodesToStore);\n\n\t\t\t\tif (Type.isArrayFilled(state.history))\n\t\t\t\t{\n\t\t\t\t\tlet privateCodesToStore = [];\n\n\t\t\t\t\tstate.history.forEach(entry => {\n\t\t\t\t\t\tif (!privateCodesToStore.includes(entry.privateCode))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tprivateCodesToStore.push(entry.privateCode);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\tstate.entity = state.entity\n\t\t\t\t\t\t.filter(entity => privateCodesToStore.includes(entity.privateCode));\n\n\t\t\t\t\tstate.entity = state.entity.map(entity => {\n\t\t\t\t\t\tentity.comments = entity.comments.filter(comment => new Date(comment.dateLog) > date);\n\n\t\t\t\t\t\treturn entity;\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tstate.entity = [];\n\t\t\t\t}\n\n\t\t\t\tstate.sentQueue = [];\n\t\t\t\tstate.reportState.comments = state.reportState.comments\n\t\t\t\t\t.filter(comment => new Date(comment.dateLog) > date);\n\n\t\t\t\tLogger.log(`Local history before ${DateFormatter.toString(date)} cleared`);\n\t\t\t\tDebug.space();\n\t\t\t\tDebug.log(`Local history before ${DateFormatter.toString(date)} cleared`);\n\n\t\t\t\tsuper.saveState(state);\n\t\t\t},\n\n\t\t\tsetComment: (state, payload) =>\n\t\t\t{\n\t\t\t\tconst dateLog = state.reportState.dateLog;\n\n\t\t\t\tlet comment = payload.entity.comments.find(comment => comment.dateLog === dateLog);\n\t\t\t\tif (comment)\n\t\t\t\t{\n\t\t\t\t\tcomment.text = payload.comment;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tpayload.entity.comments.push({\n\t\t\t\t\t\tdateLog,\n\t\t\t\t\t\ttext: payload.comment\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tsuper.saveState(state);\n\t\t\t},\n\n\t\t\tsetReportComment: (state, text) =>\n\t\t\t{\n\t\t\t\tconst dateLog = state.reportState.dateLog;\n\n\t\t\t\tlet comment = state.reportState.comments.find(comment => comment.dateLog === dateLog);\n\t\t\t\tif (comment)\n\t\t\t\t{\n\t\t\t\t\tcomment.text = text;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tstate.reportState.comments.push({\n\t\t\t\t\t\tdateLog,\n\t\t\t\t\t\ttext\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tsuper.saveState(state);\n\t\t\t},\n\n\t\t\tsetPausedUntil: (state, dateTime) =>\n\t\t\t{\n\t\t\t\tstate.config.pausedUntil = dateTime;\n\n\t\t\t\tsuper.saveState(state);\n\t\t\t},\n\n\t\t\tclearPausedUntil: (state) =>\n\t\t\t{\n\t\t\t\tstate.config.pausedUntil = null;\n\n\t\t\t\tsuper.saveState(state);\n\t\t\t},\n\n\t\t\tprocessUnfinishedEvents: (state) =>\n\t\t\t{\n\t\t\t\tstate.history.map(entry => {\n\t\t\t\t\tentry.time = entry.time.map(interval => {\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\tinterval.finish === null\n\t\t\t\t\t\t\t&& interval.preFinish !== null\n\t\t\t\t\t\t)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tinterval.finish = interval.preFinish;\n\t\t\t\t\t\t\tinterval.preFinish = null;\n\n\t\t\t\t\t\t\tLogger.log('Unfinished interval closed based on preFinish time');\n\t\t\t\t\t\t\tDebug.space();\n\t\t\t\t\t\t\tDebug.log('Unfinished interval closed based on preFinish time');\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn interval;\n\t\t\t\t\t});\n\n\t\t\t\t\tentry.time = entry.time.filter(time => {\n\t\t\t\t\t\tif (time.finish != null)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tLogger.log('Unfinished interval has been removed');\n\t\t\t\t\t\t\tDebug.space();\n\t\t\t\t\t\t\tDebug.log('Unfinished interval has been removed');\n\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\treturn entry;\n\t\t\t\t});\n\n\t\t\t\tsuper.saveState(state);\n\t\t\t},\n\n\t\t\tmigrateHistory: (state) =>\n\t\t\t{\n\t\t\t\tstate.entity.map(entity => {\n\t\t\t\t\tif (!entity.hasOwnProperty('comments'))\n\t\t\t\t\t{\n\t\t\t\t\t\tentity.comments = [];\n\n\t\t\t\t\t\tif (entity.comment)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tentity.comments.push({\n\t\t\t\t\t\t\t\tdateLog: state.reportState.dateLog,\n\t\t\t\t\t\t\t\ttext: entity.comment,\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tdelete entity.comment;\n\n\t\t\t\t\treturn entity;\n\t\t\t\t});\n\n\t\t\t\tif (!state.reportState.hasOwnProperty('comments'))\n\t\t\t\t{\n\t\t\t\t\tstate.reportState.comments = [];\n\n\t\t\t\t\tif (state.reportState.comment)\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.reportState.comments.push({\n\t\t\t\t\t\t\tdateLog: state.reportState.dateLog,\n\t\t\t\t\t\t\ttext: state.reportState.comment,\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t\tdelete state.reportState.comment;\n\t\t\t\t}\n\n\t\t\t\tsuper.saveState(state);\n\t\t\t},\n\t\t}\n\t}\n\n\tgetGetters()\n\t{\n\t\treturn {\n\t\t\tgetWorkingEntities(state)\n\t\t\t{\n\t\t\t\tlet workingEntities = state.entity.filter(entity => {\n\t\t\t\t\tif (!state.personal.includes(entity.privateCode))\n\t\t\t\t\t{\n\t\t\t\t\t\treturn entity;\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tworkingEntities = workingEntities\n\t\t\t\t\t.map(entity => {\n\t\t\t\t\t\tconst comment = entity.comments.find(comment => comment.dateLog === state.reportState.dateLog);\n\n\t\t\t\t\t\tconst workingEntity = {\n\t\t\t\t\t\t\t...entity,\n\t\t\t\t\t\t\ttime: Time.calculateInEntityOnADate(state, entity, state.reportState.dateLog),\n\t\t\t\t\t\t\tcomment: comment ? comment.text : '',\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (workingEntity.type === EntityType.unknown)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tworkingEntity.hint = EntityGroup.unknown.hint;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn workingEntity;\n\t\t\t\t\t})\n\t\t\t\t\t.filter(entity => entity.time > 0);\n\n\t\t\t\tlet otherTimeRest = Time.msToSec(state.config.otherTime);\n\t\t\t\tconst others = workingEntities\n\t\t\t\t\t.sort((currentEntity, nextEntity) => currentEntity.time - nextEntity.time)\n\t\t\t\t\t.filter(entity => {\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\tstate.strictlyWorking.includes(entity.privateCode)\n\t\t\t\t\t\t\t|| entity.type === EntityType.absence\n\t\t\t\t\t\t)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (otherTimeRest - entity.time >= 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\totherTimeRest -= entity.time;\n\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\tlet shortAbsenceTimeRest = Time.msToSec(state.config.shortAbsenceTime);\n\n\t\t\t\tconst shortAbsence = workingEntities\n\t\t\t\t\t.sort((currentEntity, nextEntity) => currentEntity.time - nextEntity.time)\n\t\t\t\t\t.filter(entity => {\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\tstate.strictlyWorking.includes(entity.privateCode)\n\t\t\t\t\t\t\t|| entity.type !== EntityType.absence\n\t\t\t\t\t\t)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (MonitorModel.prototype.getCommentByEntity(state, entity).trim() === '')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (shortAbsenceTimeRest - entity.time >= 0)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tshortAbsenceTimeRest -= entity.time;\n\n\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\tconst otherCodes = others.map(entity => entity.privateCode);\n\t\t\t\tconst shortAbsenceCodes = shortAbsence.map(entity => entity.privateCode);\n\t\t\t\tconst excludeCodes = otherCodes.concat(shortAbsenceCodes);\n\n\t\t\t\tworkingEntities = workingEntities\n\t\t\t\t\t.filter(entity => !excludeCodes.includes(entity.privateCode))\n\t\t\t\t\t.sort((currentEntity, nextEntity) => nextEntity.time - currentEntity.time);\n\n\t\t\t\tif (Type.isArrayFilled(others))\n\t\t\t\t{\n\t\t\t\t\tworkingEntities.push({\n\t\t\t\t\t\ttype: EntityType.group,\n\t\t\t\t\t\ttitle: EntityGroup.other.title,\n\t\t\t\t\t\ttime: Time.msToSec(state.config.otherTime) - otherTimeRest,\n\t\t\t\t\t\tallowedTime: Time.msToSec(state.config.otherTime),\n\t\t\t\t\t\thint: EntityGroup.other.hint,\n\t\t\t\t\t\tprivateCode: EntityGroup.other.value,\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tif (Type.isArrayFilled(shortAbsence))\n\t\t\t\t{\n\t\t\t\t\tworkingEntities.push({\n\t\t\t\t\t\ttype: EntityType.group,\n\t\t\t\t\t\ttitle: EntityGroup.absence.title,\n\t\t\t\t\t\ttime: shortAbsence.reduce((sum, entity) => sum + entity.time, 0),\n\t\t\t\t\t\tallowedTime: Time.msToSec(state.config.shortAbsenceTime),\n\t\t\t\t\t\thint: EntityGroup.absence.hint,\n\t\t\t\t\t\tprivateCode: EntityGroup.absence.value,\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\treturn workingEntities;\n\t\t\t},\n\t\t\tgetPersonalEntities(state)\n\t\t\t{\n\t\t\t\tlet personalEntities = state.entity.filter(entity => {\n\t\t\t\t\tif (state.personal.includes(entity.privateCode))\n\t\t\t\t\t{\n\t\t\t\t\t\treturn entity;\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\treturn personalEntities\n\t\t\t\t\t.map(entity => {\n\t\t\t\t\t\tconst comment = entity.comments.find(comment => comment.dateLog === state.reportState.dateLog);\n\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t...entity,\n\t\t\t\t\t\t\ttime: Time.calculateInEntityOnADate(state, entity, state.reportState.dateLog),\n\t\t\t\t\t\t\tcomment: comment ? comment.text : '',\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t\t.filter(entity => entity.time > 0)\n\t\t\t\t\t.sort((a, b) => b.time - a.time);\n\t\t\t},\n\t\t\tgetSiteDetailByPrivateCode: state => privateCode => {\n\t\t\t\tconst history = BX.util.objectClone(state.history);\n\n\t\t\t\tlet entries = history.filter(entry => (\n\t\t\t\t\tentry.privateCode === privateCode\n\t\t\t\t\t&& entry.dateLog === state.reportState.dateLog\n\t\t\t\t));\n\n\t\t\t\tentries.map(entry => {\n\t\t\t\t\tentry.time = Time.calculateInEntry(entry);\n\t\t\t\t});\n\n\t\t\t\treturn entries;\n\t\t\t},\n\t\t\tgetChartData(state)\n\t\t\t{\n\t\t\t\tlet segments = [];\n\n\t\t\t\tconst reportDate = new Date(state.reportState.dateLog);\n\t\t\t\tconst emptyChart = [{\n\t\t\t\t\tstart: new Date(\n\t\t\t\t\t\treportDate.getFullYear(),\n\t\t\t\t\t\treportDate.getMonth(),\n\t\t\t\t\t\treportDate.getDate(),\n\t\t\t\t\t\t0,\n\t\t\t\t\t\t0\n\t\t\t\t\t),\n\t\t\t\t\tfinish: new Date(\n\t\t\t\t\t\treportDate.getFullYear(),\n\t\t\t\t\t\treportDate.getMonth(),\n\t\t\t\t\t\treportDate.getDate(),\n\t\t\t\t\t\t23,\n\t\t\t\t\t\t59\n\t\t\t\t\t),\n\t\t\t\t\ttype: EntityGroup.inactive.value,\n\t\t\t\t\tclickable: true,\n\t\t\t\t\tclickableHint: Loc.getMessage('TIMEMAN_PWT_REPORT_INTERVAL_CLICKABLE_HINT'),\n\t\t\t\t\tstretchable: true,\n\t\t\t\t}];\n\n\t\t\t\tif (!Type.isArrayFilled(state.history))\n\t\t\t\t{\n\t\t\t\t\treturn emptyChart;\n\t\t\t\t}\n\n\t\t\t\tlet history = state.history.filter(entry => entry.dateLog === state.reportState.dateLog);\n\t\t\t\tconst minute = 60000;\n\n\t\t\t\t//collecting real intervals\n\t\t\t\thistory.forEach(entry => {\n\t\t\t\t\tlet type;\n\t\t\t\t\tif (state.personal.includes(entry.privateCode))\n\t\t\t\t\t{\n\t\t\t\t\t\ttype = EntityGroup.personal.value;\n\t\t\t\t\t}\n\t\t\t\t\telse if (entry.type === EntityType.custom)\n\t\t\t\t\t{\n\t\t\t\t\t\ttype = EntityGroup.workingCustom.value;\n\t\t\t\t\t}\n\t\t\t\t\telse if (entry.type === EntityType.absence)\n\t\t\t\t\t{\n\t\t\t\t\t\tconst entity = state.entity.find(entity => entity.privateCode === entry.privateCode);\n\t\t\t\t\t\tconst comment = MonitorModel.prototype.getCommentByEntity(state, entity);\n\n\t\t\t\t\t\ttype = comment ? EntityGroup.workingCustom.value : EntityGroup.working.value;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\ttype = EntityGroup.working.value;\n\t\t\t\t\t}\n\n\t\t\t\t\tentry.time.forEach(interval => {\n\t\t\t\t\t\tconst start = new Date(interval.start);\n\t\t\t\t\t\tconst finish = interval.finish ? new Date(interval.finish) : new Date();\n\n\t\t\t\t\t\tsegments.push({ type, start, finish });\n\t\t\t\t\t})\n\t\t\t\t});\n\n\t\t\t\tif (!Type.isArrayFilled(segments))\n\t\t\t\t{\n\t\t\t\t\treturn emptyChart;\n\t\t\t\t}\n\n\t\t\t\tsegments = segments\n\t\t\t\t\t.sort((currentSegment, nextSegment) => currentSegment.start - nextSegment.start)\n\t\t\t\t;\n\n\t\t\t\t//fill the voids with inactive intervals\n\n\t\t\t\t//create the leftmost interval\n\t\t\t\tlet firstSegmentFrom = segments[0].start;\n\t\t\t\tif (firstSegmentFrom.getHours() + firstSegmentFrom.getMinutes() > 0)\n\t\t\t\t{\n\t\t\t\t\tsegments.unshift({\n\t\t\t\t\t\tstart: new Date(\n\t\t\t\t\t\t\tfirstSegmentFrom.getFullYear(),\n\t\t\t\t\t\t\tfirstSegmentFrom.getMonth(),\n\t\t\t\t\t\t\tfirstSegmentFrom.getDate(),\n\t\t\t\t\t\t\t0,\n\t\t\t\t\t\t\t0\n\t\t\t\t\t\t),\n\t\t\t\t\t\tfinish: firstSegmentFrom,\n\t\t\t\t\t\ttype: EntityGroup.inactive.value,\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\t//create inactive intervals throughout the day\n\t\t\t\tsegments\n\t\t\t\t\t.forEach((interval, index) => {\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\tindex > 0\n\t\t\t\t\t\t\t&& interval.start - segments[index - 1].finish >= minute * 3\n\t\t\t\t\t\t)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst start = segments[index - 1].finish;\n\t\t\t\t\t\t\tconst finish = interval.start;\n\n\t\t\t\t\t\t\tstart.setMinutes(start.getMinutes() + 1);\n\t\t\t\t\t\t\tfinish.setMinutes(finish.getMinutes() - 1);\n\n\t\t\t\t\t\t\tsegments.push({\n\t\t\t\t\t\t\t\tstart,\n\t\t\t\t\t\t\t\tfinish,\n\t\t\t\t\t\t\t\ttype: EntityGroup.inactive.value,\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t;\n\n\t\t\t\tsegments = segments\n\t\t\t\t\t.sort((currentSegment, nextSegment) => currentSegment.start - nextSegment.start)\n\t\t\t\t;\n\n\t\t\t\t//create the rightmost interval\n\t\t\t\tlet lastSegmentTo = segments[segments.length - 1].finish;\n\t\t\t\tif (lastSegmentTo.getHours() + lastSegmentTo.getMinutes() < 82)\n\t\t\t\t{\n\t\t\t\t\tlastSegmentTo.setMinutes(lastSegmentTo.getMinutes() + 1);\n\n\t\t\t\t\tsegments.push({\n\t\t\t\t\t\tstart: lastSegmentTo,\n\t\t\t\t\t\tfinish: new Date(\n\t\t\t\t\t\t\tlastSegmentTo.getFullYear(),\n\t\t\t\t\t\t\tlastSegmentTo.getMonth(),\n\t\t\t\t\t\t\tlastSegmentTo.getDate(),\n\t\t\t\t\t\t\t23,\n\t\t\t\t\t\t\t59\n\t\t\t\t\t\t),\n\t\t\t\t\t\ttype: EntityGroup.inactive.value,\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\t//collapse intervals shorter than a minute\n\t\t\t\tsegments = segments.filter(interval => interval.finish - interval.start >= minute);\n\n\t\t\t\tlet chartData = [];\n\t\t\t\tlet lastSegmentType = null;\n\n\t\t\t\t//create data for the graph from intervals\n\t\t\t\tsegments\n\t\t\t\t\t.forEach((segment, index) => {\n\t\t\t\t\t\tif (index > 0 && segment.type !== EntityGroup.inactive.value)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tchartData[chartData.length - 1].finish = segment.start;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (segment.type !== lastSegmentType)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlastSegmentType = segment.type;\n\n\t\t\t\t\t\t\tchartData.push({\n\t\t\t\t\t\t\t\tstart: segment.start,\n\t\t\t\t\t\t\t\tfinish: segment.finish,\n\t\t\t\t\t\t\t\ttype: segment.type,\n\t\t\t\t\t\t\t\tclickable: (\n\t\t\t\t\t\t\t\t\tsegment.type === EntityGroup.inactive.value\n\t\t\t\t\t\t\t\t\t&& segment.start < new Date()\n\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\tclickableHint: segment.type === EntityGroup.inactive.value\n\t\t\t\t\t\t\t\t\t? Loc.getMessage('TIMEMAN_PWT_REPORT_INTERVAL_CLICKABLE_HINT')\n\t\t\t\t\t\t\t\t\t: '',\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (segment.type !== EntityGroup.inactive.value)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tchartData[chartData.length - 1].finish = segment.finish;\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t;\n\n\t\t\t\treturn chartData;\n\t\t\t},\n\t\t\tgetOverChartData: state => selectedPrivateCode => {\n\t\t\t\tlet selectedCodes = [];\n\n\t\t\t\tlet workingEntities = [];\n\t\t\t\tif (\n\t\t\t\t\tselectedPrivateCode === EntityGroup.other.value\n\t\t\t\t\t|| selectedPrivateCode === EntityGroup.absence.value\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tworkingEntities = state.entity\n\t\t\t\t\t\t.filter(entity => {\n\t\t\t\t\t\t\tif (!state.personal.includes(entity.privateCode))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\treturn entity;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.map(entity => {\n\t\t\t\t\t\t\tconst workingEntity = {\n\t\t\t\t\t\t\t\t...entity,\n\t\t\t\t\t\t\t\ttime: Time.calculateInEntityOnADate(state, entity, state.reportState.dateLog),\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (workingEntity.type === EntityType.unknown)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tworkingEntity.hint = EntityGroup.unknown.hint;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\treturn workingEntity;\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.filter(entity => entity.time > 0);\n\t\t\t\t}\n\n\t\t\t\tif (selectedPrivateCode === EntityGroup.other.value)\n\t\t\t\t{\n\t\t\t\t\tlet otherTimeRest = Time.msToSec(state.config.otherTime);\n\t\t\t\t\tconst others = workingEntities\n\t\t\t\t\t\t.sort((currentEntity, nextEntity) => currentEntity.time - nextEntity.time)\n\t\t\t\t\t\t.filter(entity => {\n\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\tstate.strictlyWorking.includes(entity.privateCode)\n\t\t\t\t\t\t\t\t|| entity.type === EntityType.absence\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (otherTimeRest - entity.time >= 0)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\totherTimeRest -= entity.time;\n\n\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\n\t\t\t\t\tothers.forEach(entity => selectedCodes.push(entity.privateCode));\n\t\t\t\t}\n\t\t\t\telse if (selectedPrivateCode === EntityGroup.absence.value)\n\t\t\t\t{\n\t\t\t\t\tlet shortAbsenceTimeRest = Time.msToSec(state.config.shortAbsenceTime);\n\n\t\t\t\t\tconst shortAbsence = workingEntities\n\t\t\t\t\t\t.sort((currentEntity, nextEntity) => currentEntity.time - nextEntity.time)\n\t\t\t\t\t\t.filter(entity => {\n\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\tstate.strictlyWorking.includes(entity.privateCode)\n\t\t\t\t\t\t\t\t|| entity.type !== EntityType.absence\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (MonitorModel.prototype.getCommentByEntity(state, entity).trim() === '')\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tif (shortAbsenceTimeRest - entity.time >= 0)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tshortAbsenceTimeRest -= entity.time;\n\n\t\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\n\t\t\t\t\tshortAbsence.forEach(entity => selectedCodes.push(entity.privateCode));\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tselectedCodes = [selectedPrivateCode];\n\t\t\t\t}\n\n\t\t\t\tlet segments = [];\n\n\t\t\t\tlet history = BX.util.objectClone(state.history).filter(entry => entry.dateLog === state.reportState.dateLog);\n\t\t\t\tconst minute = 60000;\n\n\t\t\t\t//collecting real intervals\n\t\t\t\thistory.forEach(entry => {\n\t\t\t\t\tconst type = state.personal.includes(entry.privateCode)\n\t\t\t\t\t\t? EntityGroup.personal.value\n\t\t\t\t\t\t: EntityGroup.working.value\n\t\t\t\t\t;\n\n\t\t\t\t\tentry.display = (selectedCodes.includes(entry.privateCode) ? 'selected' : 'transparent');\n\n\t\t\t\t\tentry.time.forEach(interval => {\n\t\t\t\t\t\tconst start = new Date(interval.start);\n\t\t\t\t\t\tconst finish = interval.finish ? new Date(interval.finish) : new Date();\n\n\t\t\t\t\t\tsegments.push({ type, start, finish, display: entry.display });\n\t\t\t\t\t})\n\t\t\t\t});\n\n\t\t\t\tsegments = segments\n\t\t\t\t\t.sort((currentSegment, nextSegment) => currentSegment.start - nextSegment.start)\n\t\t\t\t;\n\n\t\t\t\t//create the leftmost interval\n\t\t\t\tlet firstSegmentFrom = segments[0].start;\n\t\t\t\tif (firstSegmentFrom.getHours() + firstSegmentFrom.getMinutes() > 0)\n\t\t\t\t{\n\t\t\t\t\tsegments.unshift({\n\t\t\t\t\t\tstart: new Date(\n\t\t\t\t\t\t\tfirstSegmentFrom.getFullYear(),\n\t\t\t\t\t\t\tfirstSegmentFrom.getMonth(),\n\t\t\t\t\t\t\tfirstSegmentFrom.getDate(),\n\t\t\t\t\t\t\t0,\n\t\t\t\t\t\t\t0\n\t\t\t\t\t\t),\n\t\t\t\t\t\tfinish: firstSegmentFrom,\n\t\t\t\t\t\ttype: EntityGroup.inactive.value,\n\t\t\t\t\t\tdisplay: 'transparent',\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\t//create inactive intervals throughout the day\n\t\t\t\tsegments\n\t\t\t\t\t.forEach((interval, index) => {\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\tindex > 0\n\t\t\t\t\t\t\t&& interval.start - segments[index - 1].finish >= minute * 3\n\t\t\t\t\t\t)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst start = segments[index - 1].finish;\n\t\t\t\t\t\t\tconst finish = interval.start;\n\n\t\t\t\t\t\t\tstart.setMinutes(start.getMinutes() + 1);\n\t\t\t\t\t\t\tfinish.setMinutes(finish.getMinutes() - 1);\n\n\t\t\t\t\t\t\tsegments.push({\n\t\t\t\t\t\t\t\tstart,\n\t\t\t\t\t\t\t\tfinish,\n\t\t\t\t\t\t\t\ttype: EntityGroup.inactive.value,\n\t\t\t\t\t\t\t\tdisplay: 'transparent',\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t;\n\n\t\t\t\tsegments = segments\n\t\t\t\t\t.sort((currentSegment, nextSegment) => currentSegment.start - nextSegment.start)\n\t\t\t\t;\n\n\t\t\t\t//create the rightmost interval\n\t\t\t\tlet lastSegmentTo = segments[segments.length - 1].finish;\n\t\t\t\tif (lastSegmentTo.getHours() + lastSegmentTo.getMinutes() < 82)\n\t\t\t\t{\n\t\t\t\t\tlastSegmentTo.setMinutes(lastSegmentTo.getMinutes() + 1);\n\n\t\t\t\t\tsegments.push({\n\t\t\t\t\t\tstart: lastSegmentTo,\n\t\t\t\t\t\tfinish: new Date(\n\t\t\t\t\t\t\tlastSegmentTo.getFullYear(),\n\t\t\t\t\t\t\tlastSegmentTo.getMonth(),\n\t\t\t\t\t\t\tlastSegmentTo.getDate(),\n\t\t\t\t\t\t\t23,\n\t\t\t\t\t\t\t59\n\t\t\t\t\t\t),\n\t\t\t\t\t\ttype: EntityGroup.inactive.value,\n\t\t\t\t\t\tdisplay: 'transparent',\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\treturn segments;\n\t\t\t},\n\t\t\tisHistorySent(state)\n\t\t\t{\n\t\t\t\tlet lastSuccessfulSendDate = state.config.lastSuccessfulSendDate;\n\n\t\t\t\tlet hasUnsentHistory = (\n\t\t\t\t\tType.isArrayFilled(state.history)\n\t\t\t\t\t&& new Date(state.history[0].dateLog) < new Date(MonitorModel.prototype.getDateLog())\n\t\t\t\t);\n\n\t\t\t\tif (!lastSuccessfulSendDate)\n\t\t\t\t{\n\t\t\t\t\treturn !hasUnsentHistory;\n\t\t\t\t}\n\n\t\t\t\tlastSuccessfulSendDate = new Date(lastSuccessfulSendDate);\n\t\t\t\tlastSuccessfulSendDate.setHours(0);\n\t\t\t\tlastSuccessfulSendDate.setMinutes(0);\n\t\t\t\tlastSuccessfulSendDate.setSeconds(0);\n\t\t\t\tlastSuccessfulSendDate.setMilliseconds(0);\n\n\t\t\t\tlet currentDate = new Date();\n\t\t\t\tcurrentDate.setHours(0);\n\t\t\t\tcurrentDate.setMinutes(0);\n\t\t\t\tcurrentDate.setSeconds(0);\n\t\t\t\tcurrentDate.setMilliseconds(0);\n\n\t\t\t\treturn currentDate - lastSuccessfulSendDate <= 86400000\n\t\t\t\t\t|| !hasUnsentHistory;\n\t\t\t},\n\t\t\tgetWorkingTimeForToday(state)\n\t\t\t{\n\t\t\t\tlet workingEntities = state.entity.filter(entity => {\n\t\t\t\t\tif (!state.personal.includes(entity.privateCode))\n\t\t\t\t\t{\n\t\t\t\t\t\treturn entity;\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\treturn workingEntities\n\t\t\t\t\t.map(entity => {\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t...entity,\n\t\t\t\t\t\t\ttime: Time.calculateInEntityOnADate(state, entity, MonitorModel.prototype.getDateLog()),\n\t\t\t\t\t\t};\n\t\t\t\t\t})\n\t\t\t\t\t.reduce((sum, entity) => sum + entity.time, 0);\n\t\t\t},\n\t\t\tgetReportComment(state)\n\t\t\t{\n\t\t\t\tlet reportComment = state.reportState.comments\n\t\t\t\t\t.find(comment => comment.dateLog === state.reportState.dateLog);\n\n\t\t\t\treturn reportComment ? reportComment.text : '';\n\t\t\t},\n\t\t\thasActivityOtherThanBitrix24(state)\n\t\t\t{\n\t\t\t\tlet hasActivity = false;\n\n\t\t\t\tlet appSiteEntities = state.entity\n\t\t\t\t\t.filter(entity => entity.type === EntityType.app || entity.type === EntityType.site);\n\n\t\t\t\tif (Type.isArrayFilled(appSiteEntities) && appSiteEntities.length > 1)\n\t\t\t\t{\n\t\t\t\t\thasActivity = true;\n\t\t\t\t}\n\n\t\t\t\treturn hasActivity;\n\t\t\t},\n\t\t}\n\t}\n\n\tvalidatePersonal(personal = '')\n\t{\n\t\tlet result = '';\n\n\t\tif (personal && (Type.isString(personal) || Type.isNumber(personal)))\n\t\t{\n\t\t\tresult = personal.toString();\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tvalidateEntity(entity = {})\n\t{\n\t\tlet result = {};\n\n\t\tif (Type.isObject(entity) && entity)\n\t\t{\n\t\t\tif (Type.isString(entity.type))\n\t\t\t{\n\t\t\t\tresult.type = entity.type;\n\t\t\t}\n\n\t\t\tif (Type.isString(entity.title) || Type.isNumber(entity.title))\n\t\t\t{\n\t\t\t\tresult.title = entity.title.toString();\n\t\t\t}\n\n\t\t\tif (Type.isArrayFilled(entity.comments))\n\t\t\t{\n\t\t\t\tresult.comments = entity.comments;\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tvalidateHistory(historyEntry= {})\n\t{\n\t\tlet result = {};\n\n\t\tif (Type.isObject(historyEntry) && historyEntry)\n\t\t{\n\t\t\tif (\n\t\t\t\tType.isString(historyEntry.dateLog)\n\t\t\t\t&& Type.isDate(new Date(historyEntry.dateLog))\n\t\t\t\t&& !isNaN(new Date(historyEntry.dateLog))\n\t\t\t)\n\t\t\t{\n\t\t\t\tresult.dateLog = historyEntry.dateLog;\n\t\t\t}\n\n\t\t\tif (Type.isString(historyEntry.title) || Type.isNumber(historyEntry.title))\n\t\t\t{\n\t\t\t\tresult.title = historyEntry.title.toString();\n\t\t\t}\n\n\t\t\tif (Type.isString(historyEntry.type) && EntityType.hasOwnProperty(historyEntry.type))\n\t\t\t{\n\t\t\t\tresult.type = historyEntry.type;\n\n\t\t\t\tif (historyEntry.type === EntityType.site)\n\t\t\t\t{\n\t\t\t\t\tresult.siteUrl = historyEntry.siteUrl;\n\t\t\t\t\tresult.siteTitle = historyEntry.siteTitle.toString();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (Type.isArrayFilled(historyEntry.time))\n\t\t\t{\n\t\t\t\tresult.time = historyEntry.time;\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tvalidateSentQueue(sentQueueItem = {})\n\t{\n\t\tlet result = {};\n\n\t\tif (Type.isObject(sentQueueItem) && sentQueueItem)\n\t\t{\n\t\t\tif (Type.isString(sentQueueItem.dateLog))\n\t\t\t{\n\t\t\t\tresult.dateLog = sentQueueItem.dateLog;\n\t\t\t}\n\n\t\t\tif (Type.isArrayFilled(sentQueueItem.historyPackage))\n\t\t\t{\n\t\t\t\tresult.historyPackage = sentQueueItem.historyPackage;\n\t\t\t}\n\n\t\t\tif (Type.isArrayFilled(sentQueueItem.chartPackage))\n\t\t\t{\n\t\t\t\tresult.chartPackage = sentQueueItem.chartPackage;\n\t\t\t}\n\n\t\t\tif (Type.isString(sentQueueItem.desktopCode))\n\t\t\t{\n\t\t\t\tresult.desktopCode = sentQueueItem.desktopCode;\n\t\t\t}\n\n\t\t\tif (Type.isString(sentQueueItem.comment))\n\t\t\t{\n\t\t\t\tresult.comment = sentQueueItem.comment;\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tgetHistoryEntryByPrivateCode(store, privateCode)\n\t{\n\t\treturn store.state.history.find(entry => (\n\t\t\tentry.privateCode === privateCode\n\t\t\t&& entry.dateLog === this.getDateLog()\n\t\t));\n\t}\n\n\tgetHistoryEntryBySiteUrl(store, siteUrl)\n\t{\n\t\treturn store.state.history.find(entry => (\n\t\t\tentry.siteUrl === siteUrl\n\t\t\t&& entry.dateLog === this.getDateLog()\n\t\t));\n\t}\n\n\tgetEntityByPrivateCode(store, privateCode)\n\t{\n\t\treturn store.state.entity.find(entity => entity.privateCode === privateCode);\n\t}\n\n\tgetEntityByTitle(store, title)\n\t{\n\t\treturn store.state.entity.find(entity => entity.title === title);\n\t}\n\n\tgetCommentByEntity(state, entity)\n\t{\n\t\tconst comment = entity.comments.find(comment => comment.dateLog === state.reportState.dateLog);\n\n\t\treturn comment ? comment.text : '';\n\t}\n\n\tgetDateLog()\n\t{\n\t\treturn this.formatDateLog(new Date());\n\t}\n\n\tformatDateLog(date)\n\t{\n\t\tconst addZero = num => (num >= 0 && num <= 9) ? '0' + num : num;\n\n\t\tconst year = date.getFullYear();\n\t\tconst month = addZero(date.getMonth() + 1);\n\t\tconst day = addZero(date.getDate());\n\n\t\treturn year + '-' + month + '-' + day;\n\t}\n\n\tcollectSentQueue(store)\n\t{\n\t\tlet history = BX.util.objectClone(this.getGetters().getWorkingEntities(store.state));\n\n\t\thistory = history.map(entry => {\n\t\t\tif (\n\t\t\t\tentry.type === EntityType.group\n\t\t\t\t&& entry.title === EntityGroup.other.title\n\t\t\t)\n\t\t\t{\n\t\t\t\tentry.type = EntityType.other;\n\t\t\t\tentry.publicCode = Code.createPublic(EntityType.other);\n\t\t\t\tentry.privateCode = Code.createPrivate(EntityType.other);\n\n\t\t\t\tdelete entry.items;\n\t\t\t}\n\t\t\telse if (\n\t\t\t\tentry.type === EntityType.group\n\t\t\t\t&& entry.title === EntityGroup.absence.title\n\t\t\t)\n\t\t\t{\n\t\t\t\tentry.type = EntityType.absenceShort;\n\t\t\t\tentry.publicCode = Code.createPublic(EntityType.absenceShort);\n\t\t\t\tentry.privateCode = Code.createPrivate(EntityType.absenceShort);\n\n\t\t\t\tdelete entry.items;\n\t\t\t}\n\t\t\telse if (entry.type === EntityType.absence)\n\t\t\t{\n\t\t\t\tif (entry.extra.hasOwnProperty('timeStart'))\n\t\t\t\t{\n\t\t\t\t\tentry.timeStart = entry.extra.timeStart;\n\t\t\t\t}\n\n\t\t\t\tentry.title = Loc.getMessage('TIMEMAN_PWT_REPORT_ABSENCE');\n\t\t\t\tentry.publicCode = Code.createPublic(EntityType.absence);\n\t\t\t\tentry.privateCode = Code.createPrivate(EntityType.absence);\n\t\t\t}\n\n\t\t\tdelete entry.extra;\n\t\t\tdelete entry.hint;\n\n\t\t\treturn entry;\n\t\t});\n\n\t\tLogger.log('History to send:', history);\n\t\tDebug.space();\n\t\tDebug.log('History to send:', history);\n\n\t\tlet chart = this.getGetters().getChartData(store.state).map(interval => {\n\t\t\treturn {\n\t\t\t\ttype: interval.type,\n\t\t\t\tstart: interval.start,\n\t\t\t\tfinish: interval.finish,\n\t\t\t}\n\t\t});\n\n\t\tLogger.log('ChartData to send:', chart);\n\n\t\treturn {\n\t\t\thistory,\n\t\t\tchart,\n\t\t};\n\t}\n}\n","import {EntityType} from 'timeman.const';\nimport {Loc} from 'main.core';\n\nexport class Entity\n{\n\tconstructor(params = {})\n\t{\n\t\tswitch (params.type)\n\t\t{\n\t\t\tcase EntityType.site:\n\t\t\t\tthis.createSite(params);\n\t\t\t\tbreak;\n\n\t\t\tcase EntityType.app:\n\t\t\t\tthis.createApp(params);\n\t\t\t\tbreak;\n\n\t\t\tcase EntityType.absence:\n\t\t\t\tthis.createAbsence();\n\t\t\t\tbreak;\n\n\t\t\tcase EntityType.unknown:\n\t\t\t\tthis.createUnknown(params);\n\t\t\t\tbreak;\n\n\t\t\tcase EntityType.incognito:\n\t\t\t\tthis.createIncognito();\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tcreateSite(params)\n\t{\n\t\tthis.type = EntityType.site;\n\n\t\tlet host;\n\t\ttry\n\t\t{\n\t\t\thost = new URL(params.url).host;\n\t\t}\n\t\tcatch (err)\n\t\t{\n\t\t\thost = params.url;\n\t\t}\n\n\t\tif (host === '')\n\t\t{\n\t\t\tlet hostFragments = params.url.split('/');\n\n\t\t\thost = hostFragments[hostFragments.length - 1] !== ''\n\t\t\t\t? hostFragments[hostFragments.length - 1]\n\t\t\t\t: params.url;\n\t\t}\n\t\telse if (host.split('.')[0] === 'www')\n\t\t{\n\t\t\thost = host.substring(4);\n\t\t}\n\n\t\tthis.title = host.toString();\n\t\tthis.siteUrl = params.url.toString();\n\t\tthis.siteTitle = params.title.toString();\n\t}\n\n\tcreateApp(params)\n\t{\n\t\tthis.type = EntityType.app;\n\t\tthis.title = params.name.toString();\n\n\t\tif (params.isBitrix24Desktop)\n\t\t{\n\t\t\tthis.isBitrix24Desktop = params.isBitrix24Desktop;\n\t\t}\n\t}\n\n\tcreateAbsence()\n\t{\n\t\tthis.type = EntityType.absence;\n\t\tthis.title = Loc.getMessage('TIMEMAN_PWT_REPORT_ABSENCE');\n\t}\n\n\tcreateUnknown(params)\n\t{\n\t\tthis.type = EntityType.unknown;\n\t\tthis.title = Loc.getMessage('TIMEMAN_PWT_REPORT_UNKNOWN');\n\n\t\tthis.pureName = params.name;\n\t\tthis.pureTitle = params.title;\n\t}\n\n\tcreateIncognito()\n\t{\n\t\tthis.type = EntityType.incognito;\n\t\tthis.title = Loc.getMessage('TIMEMAN_PWT_REPORT_INCOGNITO');\n\t}\n}","import {Logger} from './lib/logger';\nimport {Debug} from \"./lib/debug\";\nimport {ActionTimer} from './lib/action-timer';\nimport {Entity} from './model/entity';\nimport {EntityType} from 'timeman.const';\nimport {Loc} from 'main.core';\nimport {DesktopApi} from 'im.v2.lib.desktop-api';\n\nclass EventHandler\n{\n\tinit(store)\n\t{\n\t\tthis.enabled = false;\n\t\tthis.store = store;\n\n\t\tthis.preFinishInterval = null;\n\n\t\tthis.lastCaught = {\n\t\t\tname: null,\n\t\t\turl: null\n\t\t}\n\t}\n\n\tcatch(process, name, title, url)\n\t{\n\t\tif (!this.enabled || !process)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tActionTimer.start('CATCH_ENTITY');\n\n\t\tconst type = this.getEntityTypeByEvent({process, name, title, url});\n\n\t\tlet isBitrix24Desktop = false;\n\t\tif (type === EntityType.app)\n\t\t{\n\t\t\tif (['Bitrix24.exe', 'Bitrix24'].includes(this.getNameByProcess(process)))\n\t\t\t{\n\t\t\t\tisBitrix24Desktop = true;\n\t\t\t}\n\t\t}\n\n\t\tif (type !== EntityType.absence)\n\t\t{\n\t\t\tif (type === EntityType.app)\n\t\t\t{\n\t\t\t\tswitch (name)\n\t\t\t\t{\n\t\t\t\t\tcase 'Application Frame Host':\n\t\t\t\t\t\tname = title\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'StartMenuExperienceHost':\n\t\t\t\t\tcase 'Search application':\n\t\t\t\t\t\tname = Loc.getMessage('TIMEMAN_PWT_WINDOWS_START_ALIAS');\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'Windows Shell Experience Host':\n\t\t\t\t\t\tname = Loc.getMessage('TIMEMAN_PWT_WINDOWS_NOTIFICATIONS_ALIAS');\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (name === '')\n\t\t\t{\n\t\t\t\tname = this.getNameByProcess(process);\n\t\t\t}\n\n\t\t\tif (!this.isNewEvent(name, url))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.lastCaught = {\n\t\t\t\tname,\n\t\t\t\turl\n\t\t\t};\n\t\t}\n\n\t\tthis.store.dispatch('monitor/addHistory', new Entity({type, name, title, url, isBitrix24Desktop}));\n\t}\n\n\tcatchAbsence(away)\n\t{\n\t\tif (away)\n\t\t{\n\t\t\tthis.store.dispatch(\n\t\t\t\t'monitor/addHistory',\n\t\t\t\tnew Entity({\n\t\t\t\t\ttype: EntityType.absence\n\t\t\t\t})\n\t\t\t);\n\n\t\t\tthis.lastCaught = {\n\t\t\t\tname: EntityType.absence,\n\t\t\t\turl: null\n\t\t\t};\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (this.isWorkingDayStarted() && this.isTrackerGetActiveAppAvailable())\n\t\t\t{\n\t\t\t\tBXDesktopSystem.TrackerGetActiveApp();\n\t\t\t}\n\t\t}\n\t}\n\n\tcatchAppClose()\n\t{\n\t\tLogger.warn('Application shutdown recognized. The last interval is finished.');\n\t\tDebug.log('Application shutdown recognized. The last interval is finished.');\n\n\t\tthis.store.dispatch('monitor/finishLastInterval');\n\t}\n\n\tgetEntityTypeByEvent(event)\n\t{\n\t\tlet type = EntityType.unknown;\n\n\t\tif (event.url === 'unknown')\n\t\t{\n\t\t\ttype = EntityType.unknown;\n\t\t}\n\t\telse if (event.url === 'incognito')\n\t\t{\n\t\t\ttype = EntityType.incognito;\n\t\t}\n\t\telse if (event.url)\n\t\t{\n\t\t\ttype = EntityType.site\n\t\t}\n\t\telse if (event.process !== '')\n\t\t{\n\t\t\ttype = EntityType.app\n\t\t}\n\n\t\treturn type;\n\t}\n\n\tgetNameByProcess(process)\n\t{\n\t\tconst separator = (process.includes('/') ? '/' : '\\\\');\n\t\tconst path = process.split(separator);\n\n\t\treturn path[path.length - 1];\n\t}\n\n\tisNewEvent(name, url)\n\t{\n\t\tif (this.url === '')\n\t\t{\n\t\t\tif (this.lastCaught.name === name)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (this.lastCaught.name === name && this.lastCaught.url === url)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tisTrackerGetActiveAppAvailable()\n\t{\n\t\treturn (BX.desktop.getApiVersion() >= 56);\n\t}\n\n\tstart()\n\t{\n\t\tif (this.enabled)\n\t\t{\n\t\t\tLogger.warn('EventHandler already started');\n\t\t\treturn;\n\t\t}\n\n\t\tthis.enabled = true;\n\n\t\tDesktopApi.subscribe(\n\t\t\t'BXUserApp',\n\t\t\t(process, name, title, url) => this.catch(process, name, title, url),\n\t\t);\n\n\t\tDesktopApi.subscribe(\n\t\t\t'BXExitApplication',\n\t\t\tthis.catchAppClose.bind(this),\n\t\t);\n\n\t\tif (this.isTrackerGetActiveAppAvailable())\n\t\t{\n\t\t\tBXDesktopSystem.TrackerGetActiveApp();\n\t\t}\n\n\t\tthis.preFinishInterval = setInterval(\n\t\t\t() => this.store.dispatch('monitor/preFinishLastInterval'),\n\t\t\t60000\n\t\t);\n\n\t\tLogger.log('EventHandler started');\n\t}\n\n\tstop()\n\t{\n\t\tif (!this.enabled)\n\t\t{\n\t\t\tLogger.warn('EventHandler already stopped');\n\t\t\treturn;\n\t\t}\n\n\t\tthis.enabled = false;\n\n\t\tthis.lastCaught = {\n\t\t\tname: null,\n\t\t\turl: null\n\t\t}\n\n\t\tthis.preFinishInterval = null;\n\n\t\tthis.store.dispatch('monitor/finishLastInterval');\n\n\t\tLogger.log('EventHandler stopped');\n\t}\n}\n\nconst eventHandler = new EventHandler();\n\nexport {eventHandler as EventHandler};","import {Loc, Type} from 'main.core';\nimport {Monitor} from './monitor';\nimport {Logger} from './lib/logger';\nimport {Debug} from './lib/debug';\nimport {UI} from 'ui.notification';\n\nclass Sender\n{\n\tinit(store)\n\t{\n\t\tthis.enabled = false;\n\t\tthis.store = store;\n\n\t\tthis.attempt = 0;\n\t\tthis.resendTimeout = 5000;\n\t\tthis.resendTimeoutId = null;\n\t}\n\n\tsend()\n\t{\n\t\tLogger.warn('Trying to send history...');\n\n\t\tBX.ajax.runAction('bitrix:timeman.api.monitor.recordhistory', {\n\t\t\tdata: {\n\t\t\t\thistory: JSON.stringify(this.getSentQueue()),\n\t\t\t}\n\t\t})\n\t\t\t.then(result =>\n\t\t\t{\n\t\t\t\tDebug.log('History sent');\n\n\t\t\t\tif (result.status === 'success')\n\t\t\t\t{\n\t\t\t\t\tLogger.warn('SUCCESS!');\n\n\t\t\t\t\tthis.attempt = 0;\n\n\t\t\t\t\tthis.afterSuccessSend();\n\n\t\t\t\t\tif (result.data.enabled === Monitor.getStatusDisabled())\n\t\t\t\t\t{\n\t\t\t\t\t\tLogger.warn('Disabled after server response');\n\t\t\t\t\t\tDebug.log('Disabled after server response');\n\n\t\t\t\t\t\tMonitor.disable();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tLogger.error('ERROR!');\n\t\t\t\t\tthis.attempt++\n\t\t\t\t\tthis.startSendingTimer();\n\t\t\t\t}\n\t\t\t})\n\t\t\t.catch(() =>\n\t\t\t{\n\t\t\t\tLogger.error('CONNECTION ERROR!');\n\n\t\t\t\tthis.attempt++\n\t\t\t\tthis.startSendingTimer();\n\t\t\t});\n\t}\n\n\tstartSendingTimer()\n\t{\n\t\tthis.resendTimeoutId = setTimeout(this.send.bind(this), this.getSendingDelay());\n\t\tLogger.log(`Next send in ${this.getSendingDelay() / 1000} seconds...`);\n\t}\n\n\tgetSendingDelay()\n\t{\n\t\treturn (this.attempt === 0 ? this.resendTimeout : this.resendTimeout * this.attempt);\n\t}\n\n\tgetSentQueue()\n\t{\n\t\treturn this.store.state.monitor.sentQueue;\n\t}\n\n\tstart()\n\t{\n\t\tif (this.enabled)\n\t\t{\n\t\t\tLogger.warn('Sender already started');\n\t\t\treturn;\n\t\t}\n\n\t\tthis.enabled = true;\n\t\tthis.attempt = 0;\n\n\t\tif (Type.isArrayFilled(this.getSentQueue()))\n\t\t{\n\t\t\tLogger.log('Preparing to send old history...');\n\t\t\tthis.startSendingTimer();\n\t\t}\n\n\t\tLogger.log(\"Sender started\");\n\t}\n\n\tstop()\n\t{\n\t\tif (!this.enabled)\n\t\t{\n\t\t\tLogger.warn('Sender already stopped');\n\t\t\treturn;\n\t\t}\n\n\t\tthis.enabled = false;\n\t\tthis.attempt = 0;\n\n\t\tclearTimeout(this.resendTimeoutId);\n\t\tLogger.log(\"Sender stopped\");\n\t}\n\n\tafterSuccessSend()\n\t{\n\t\tLogger.warn('History sent');\n\t\tDebug.space();\n\t\tDebug.log('History sent');\n\n\t\tthis.store.dispatch(\n\t\t\t'monitor/setLastSuccessfulSendDate',\n\t\t\tnew Date(this.store.state.monitor.reportState.dateLog)\n\t\t)\n\t\t\t.then(() => {\n\t\t\t\tthis.store.dispatch('monitor/clearSentHistory')\n\t\t\t\t\t.then(() => {\n\t\t\t\t\t\tthis.store.dispatch('monitor/refreshDateLog');\n\t\t\t\t\t\tthis.store.dispatch('monitor/clearSentQueue');\n\n\t\t\t\t\t\tBX.SidePanel.Instance.close();\n\n\t\t\t\t\t\tUI.Notification.Center.notify({\n\t\t\t\t\t\t\tcontent: Loc.getMessage('TIMEMAN_PWT_REPORT_NOTIFICATION_REPORT_SENT'),\n\t\t\t\t\t\t\tautoHideDelay: 5000,\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t}\n\t\t);\n\t}\n}\n\nconst sender = new Sender();\n\nexport {sender as Sender};","import {Monitor} from \"../monitor\";\nimport {Logger} from './logger';\nimport {Debug} from './debug';\n\nexport class CommandHandler\n{\n\tconstructor(options = {})\n\t{\n\t}\n\n\tgetModuleId()\n\t{\n\t\treturn 'timeman';\n\t}\n\n\thandleChangeMonitorEnabled(params)\n\t{\n\t\tif (params.enabled === Monitor.getStatusEnabled())\n\t\t{\n\t\t\tLogger.warn('Enabled via API');\n\t\t\tDebug.log('Enabled via API');\n\n\t\t\tlocation.reload();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tMonitor.stop();\n\t\t\tMonitor.disable();\n\n\t\t\tLogger.warn('Disabled via API');\n\t\t\tDebug.log('Disabled via API');\n\t\t}\n\t}\n\n\thandleChangeMonitorDebugEnabled(params)\n\t{\n\t\tif (params.enabled)\n\t\t{\n\t\t\tDebug.enable();\n\n\t\t\tLogger.warn('Debug mode enabled via API');\n\t\t\tDebug.log('Debug mode enabled via API');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tLogger.warn('Debug mode disabled via API');\n\t\t\tDebug.log('Debug mode disabled via API');\n\n\t\t\tDebug.disable();\n\t\t}\n\t}\n}","import {VuexBuilder} from \"ui.vue.vuex\";\nimport {MonitorModel} from './model/monitor';\nimport {EventHandler} from './eventhandler';\nimport {Sender} from './sender';\nimport {MonitorReport} from 'timeman.monitor-report';\nimport {Logger} from './lib/logger';\nimport {Debug} from './lib/debug';\nimport {DateFormatter} from \"timeman.dateformatter\";\nimport {TimeFormatter} from \"timeman.timeformatter\";\n\nimport {PULL as Pull} from 'pull.client';\nimport {CommandHandler} from './lib/commandhandler';\nimport {Loc, Type} from 'main.core';\nimport {DesktopApi} from 'im.v2.lib.desktop-api';\n\nclass Monitor\n{\n\tinit(options)\n\t{\n\t\tthis.enabled = options.enabled;\n\t\tthis.playTimeout = null;\n\t\tthis.isAway = false;\n\t\tthis.vuex = {};\n\n\t\tthis.defaultStorageConfig = {\n\t\t\tconfig: {\n\t\t\t\totherTime: options.otherTime,\n\t\t\t\tshortAbsenceTime: options.shortAbsenceTime,\n\t\t\t}\n\t\t};\n\n\t\tthis.dateFormat = options.dateFormat;\n\t\tthis.timeFormat = options.timeFormat;\n\n\t\tif (options.debugEnabled)\n\t\t{\n\t\t\tDebug.enable();\n\t\t}\n\n\t\tDebug.space();\n\t\tDebug.log('Desktop launched!');\n\n\t\tif (this.isEnabled() && Logger.isEnabled())\n\t\t{\n\t\t\tBXDesktopSystem.LogInfo = function() {};\n\t\t\tLogger.start();\n\t\t}\n\n\t\tDebug.log(`Enabled: ${this.enabled}`);\n\n\t\tif (this.isEnabled())\n\t\t{\n\t\t\tthis.initApp();\n\t\t}\n\n\t\tPull.subscribe(new CommandHandler());\n\t}\n\n\tinitApp()\n\t{\n\t\tif (!this.isEnabled())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tnew VuexBuilder()\n\t\t\t.addModel(\n\t\t\t\tMonitorModel\n\t\t\t\t\t.create()\n\t\t\t\t\t.setVariables(this.defaultStorageConfig)\n\t\t\t\t\t.useDatabase(true)\n\t\t\t)\n\t\t\t.setDatabaseConfig({\n\t\t\t\tname: 'timeman-pwt',\n\t\t\t\ttype: VuexBuilder.DatabaseType.indexedDb,\n\t\t\t\tsiteId: Loc.getMessage('SITE_ID'),\n\t\t\t\tuserId: Loc.getMessage('USER_ID')\n\t\t\t})\n\t\t\t.build()\n\t\t\t.then(builder => {\n\t\t\t\tthis.vuex.store = builder.store;\n\n\t\t\t\tthis.getStorage().dispatch('monitor/processUnfinishedEvents')\n\t\t\t\t\t.then(() => this.initTracker(this.getStorage()));\n\t\t\t})\n\t\t\t.catch(() => {\n\t\t\t\tconst errorMessage = \"PWT: Storage initialization error\";\n\n\t\t\t\tLogger.error(errorMessage);\n\t\t\t\tDebug.log(errorMessage);\n\t\t\t})\n\t\t;\n\t}\n\n\tinitTracker(store)\n\t{\n\t\tDateFormatter.init(this.dateFormat);\n\t\tTimeFormatter.init(this.timeFormat);\n\n\t\tEventHandler.init(store);\n\t\tSender.init(store);\n\n\t\tDesktopApi.subscribe(\n\t\t\t'BXUserAway',\n\t\t\t(away) => this.onAway(away),\n\t\t);\n\n\t\tif (BX.MessengerWindow && BX.MessengerWindow.addTab)\n\t\t{\n\t\t\tBX.MessengerWindow.addTab({\n\t\t\t\tid: 'timeman-pwt',\n\t\t\t\ttitle: Loc.getMessage('TIMEMAN_PWT_REPORT_SLIDER_TITLE'),\n\t\t\t\torder: 540,\n\t\t\t\ttarget: false,\n\t\t\t\tevents: {\n\t\t\t\t\topen: () => this.openReport(),\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\n\t\tBX.desktop.addCustomEvent(\n\t\t\t'BXProtocolUrl',\n\t\t\tcommand => {\n\t\t\t\tif (command === 'timemanpwt')\n\t\t\t\t{\n\t\t\t\t\tif (!BX.MessengerCommon.isDesktop())\n\t\t\t\t\t{\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t\tBX.MessengerWindow.changeTab('timeman-pwt', true);\n\t\t\t\t\tBX.desktop.setActiveWindow();\n\t\t\t\t\tBX.desktop.windowCommand(\"show\");\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\n\t\tif (this.isEnabled())\n\t\t{\n\t\t\tthis.launch();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tLogger.warn('Monitor is disabled');\n\t\t}\n\t}\n\n\tlaunch()\n\t{\n\t\tif (this.isAway)\n\t\t{\n\t\t\tLogger.log('Pause is over, but computer is in sleep mode. Waiting for the return of the user.');\n\t\t\tDebug.log('Pause is over, but computer is in sleep mode. Waiting for the return of the user.');\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this.getStorage().state.monitor.config.grantingPermissionDate)\n\t\t{\n\t\t\tLogger.log('History access not provided. Monitor is not started.');\n\t\t\tDebug.log('History access not provided. Monitor is not started.');\n\n\t\t\tif (this.shouldShowGrantingPermissionWindow())\n\t\t\t{\n\t\t\t\tthis.openReport();\n\t\t\t\tBXDesktopWindow.ExecuteCommand('show.active');\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.getStorage().dispatch('monitor/migrateHistory').then(() => {\n\t\t\tthis.getStorage().dispatch('monitor/clearSentHistory').then(() => {\n\t\t\t\tthis.getStorage().dispatch('monitor/refreshDateLog').then(() => {\n\t\t\t\t\tif (this.isPaused())\n\t\t\t\t\t{\n\t\t\t\t\t\tif (this.isPauseRelevant())\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tLogger.warn(\"Can't start, monitor is paused!\");\n\t\t\t\t\t\t\tDebug.log(\"Can't start, monitor is paused!\");\n\n\t\t\t\t\t\t\tthis.setPlayTimeout();\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis.clearPausedUntil().then(() => this.start());\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.start();\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t}\n\n\tstart()\n\t{\n\t\tif (!this.isEnabled())\n\t\t{\n\t\t\tLogger.warn(\"Can't start, monitor is disabled!\");\n\t\t\tDebug.log(\"Can't start, monitor is disabled!\");\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.isPaused())\n\t\t{\n\t\t\tLogger.warn(\"Can't start, monitor is paused!\");\n\t\t\tDebug.log(\"Can't start, monitor is paused!\");\n\n\t\t\treturn;\n\t\t}\n\n\t\tDebug.log('Monitor started');\n\t\tDebug.space();\n\n\t\tif (this.isTrackerEventsApiAvailable())\n\t\t{\n\t\t\tLogger.log('Events started');\n\t\t\tBXDesktopSystem.TrackerStart();\n\t\t}\n\n\t\tEventHandler.start();\n\t\tSender.start();\n\n\t\tLogger.warn('Monitor started');\n\t}\n\n\tstop()\n\t{\n\t\tif (this.isTrackerEventsApiAvailable())\n\t\t{\n\t\t\tLogger.log('Events stopped');\n\t\t\tBXDesktopSystem.TrackerStop();\n\t\t}\n\n\t\tEventHandler.stop();\n\t\tSender.stop();\n\n\t\tLogger.warn('Monitor stopped');\n\t\tDebug.log('Monitor stopped');\n\t}\n\n\tpause()\n\t{\n\t\tthis.stop();\n\t\tthis.setPlayTimeout();\n\t}\n\n\tonAway(away)\n\t{\n\t\tif (!this.isEnabled() || this.isPaused())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (away && !this.isAway)\n\t\t{\n\t\t\tthis.isAway = true;\n\n\t\t\tLogger.warn('User AWAY');\n\t\t\tDebug.space();\n\t\t\tDebug.log('User AWAY');\n\n\t\t\tthis.stop();\n\n\t\t\tEventHandler.catchAbsence(away);\n\t\t}\n\t\telse if (!away && this.isAway)\n\t\t{\n\t\t\tthis.isAway = false;\n\n\t\t\tLogger.warn('User RETURNED, continue monitoring...');\n\t\t\tDebug.space();\n\t\t\tDebug.log('User RETURNED, continue monitoring...');\n\n\t\t\tthis.launch();\n\t\t}\n\t}\n\n\tsend()\n\t{\n\t\tif (!this.vuex.hasOwnProperty('store'))\n\t\t{\n\t\t\tLogger.warn('Unable to send report. Store is not initialized.');\n\t\t\tDebug.log('Unable to send report. Store is not initialized.');\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.getStorage().dispatch('monitor/createSentQueue').then(() => Sender.send());\n\t}\n\n\topenReport()\n\t{\n\t\tif (!this.isEnabled())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tMonitorReport.open(this.getStorage());\n\t}\n\n\topenReportPreview()\n\t{\n\t\tif (!this.isEnabled())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tMonitorReport.openPreview(this.getStorage());\n\t}\n\n\tgetPausedUntilTime()\n\t{\n\t\treturn this.getStorage().state.monitor.config.pausedUntil;\n\t}\n\n\tclearPausedUntil()\n\t{\n\t\treturn this.getStorage().dispatch('monitor/clearPausedUntil');\n\t}\n\n\tisPaused()\n\t{\n\t\treturn !!this.getPausedUntilTime();\n\t}\n\n\tisPauseRelevant()\n\t{\n\t\treturn this.getPausedUntilTime() - new Date() > 0;\n\t}\n\n\tsetPlayTimeout()\n\t{\n\t\tLogger.warn(`Monitor will be turned on at ${this.getPausedUntilTime().toString()}`);\n\t\tDebug.log(`Monitor will be turned on at ${this.getPausedUntilTime().toString()}`);\n\n\t\tclearTimeout(this.playTimeout);\n\n\t\tthis.playTimeout = setTimeout(\n\t\t\t() => this.clearPausedUntil().then(() => this.launch()),\n\t\t\tthis.getPausedUntilTime() - new Date()\n\t\t);\n\t}\n\n\tpauseUntil(dateTime: Date)\n\t{\n\t\tif (\n\t\t\tType.isDate(dateTime)\n\t\t\t&& Type.isNumber(dateTime.getTime())\n\t\t\t&& dateTime > new Date()\n\t\t)\n\t\t{\n\t\t\tthis.getStorage().dispatch('monitor/setPausedUntil', dateTime).then(() => this.pause());\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthrow Error('Pause must be set as a date in the future');\n\t\t}\n\t}\n\n\tshouldShowGrantingPermissionWindow()\n\t{\n\t\tlet config = this.getStorage().state.monitor.config;\n\t\tif (!config)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tif (config.grantingPermissionDate !== null)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tlet deferredGrantingPermissionShowDate = config.deferredGrantingPermissionShowDate;\n\t\tif (deferredGrantingPermissionShowDate === null)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\treturn new Date(MonitorModel.prototype.getDateLog()) >= new Date(deferredGrantingPermissionShowDate);\n\t}\n\n\tshowGrantingPermissionLater()\n\t{\n\t\treturn this.getStorage().dispatch('monitor/showGrantingPermissionLater');\n\t}\n\n\tplay()\n\t{\n\t\tclearTimeout(this.playTimeout);\n\t\tthis.playTimeout = null;\n\t\tthis.clearPausedUntil().then(() => this.launch());\n\t}\n\n\tisEnabled()\n\t{\n\t\treturn (this.enabled === this.getStatusEnabled())\n\t}\n\n\tenable()\n\t{\n\t\tthis.enabled = this.getStatusEnabled();\n\t}\n\n\tdisable()\n\t{\n\t\tthis.stop();\n\n\t\tBX.MessengerWindow.hideTab('timeman-pwt');\n\t\tthis.vuex = {};\n\n\t\tthis.enabled = this.getStatusDisabled();\n\t}\n\n\tgetStatusEnabled()\n\t{\n\t\treturn 'Y';\n\t}\n\n\tgetStatusDisabled()\n\t{\n\t\treturn 'N';\n\t}\n\n\tisTrackerEventsApiAvailable()\n\t{\n\t\treturn (DesktopApi.getApiVersion() >= 55);\n\t}\n\n\tgetStorage()\n\t{\n\t\treturn (this.vuex.hasOwnProperty('store') ? this.vuex.store : null);\n\t}\n}\n\nconst monitor = new Monitor();\n\nexport {monitor as Monitor};\n"],"names":["Code","params","md5","join","sha1","BXDesktopSystem","createPrivate","UserAccount","UserOsMark","Date","now","createPublic","Time","state","entity","date","history","filter","entry","privateCode","dateLog","map","calculateInEntry","reduce","sum","time","interval","finish","start","Math","round","addZero","num","hour","getHours","min","getMinutes","ms","Logger","storageKey","enabled","Monitor","isEnabled","window","localStorage","setItem","e","removeItem","getItem","console","log","info","warn","error","trace","logger","Debug","text","getLogMessage","BX","desktop","Loc","getMessage","substr","i","arguments","length","Error","message","stack","JSON","stringify","debug","ActionTimer","actionsCollection","key","timeInSeconds","toFixed","actionTimer","Notification","title","callback","toString","Type","isFunction","BXIM","playSound","messageTemplate","notify","createNotify","id","type","messageJs","openNewMessage","addCustomEvent","click","removeCustomEvents","MonitorModel","config","secret","createSecret","desktopCode","getDesktopCode","otherTime","getVariable","shortAbsenceTime","pausedUntil","lastSuccessfulSendDate","lastRemindDate","grantingPermissionDate","deferredGrantingPermissionShowDate","reportState","getDateLog","comments","personal","strictlyWorking","sentQueue","EntityType","unknown","publicCode","extra","preFinish","comment","historyPackage","chartPackage","setDateLog","store","payload","isString","isDate","isNaN","commit","refreshDateLog","isArrayFilled","firstHistoryEntryDateLog","getActions","setLastRemindDate","grantPermission","showGrantingPermissionLater","setDate","getDate","formattedDate","prototype","formatDateLog","setLastSuccessfulSendDate","addPersonal","validatePersonal","removePersonal","addToStrictlyWorking","removeFromStrictlyWorking","clearStrictlyWorking","clearPersonal","addEntity","result","validateEntity","absence","custom","timestamp","timeStart","formatDateToTime","getEntityState","find","isBitrix24Cp","site","location","host","isBitrix24Desktop","app","removeEntityByPrivateCode","clearEntities","addHistory","validateHistory","historyEntry","incognito","getEntityByTitle","getHistoryEntryBySiteUrl","siteUrl","getHistoryEntryByPrivateCode","logEntity","getHistoryState","getDuration","canShowReminder","isHistorySent","getGetters","getWorkingTimeForToday","windowCommand","changeTab","MessengerWindow","show","preFinishLastInterval","finishLastInterval","clearHistory","createSentQueue","collectSentQueue","reportComment","validateSentQueue","chart","getSentQueueState","clearSentQueue","clearSentHistory","clearStorageBeforeDate","setComment","isNumber","setPausedUntil","dateTime","getTime","clearPausedUntil","setReportComment","processUnfinishedEvents","migrateHistory","setGrantingPermissionDate","setDeferredGrantingPermissionShowDate","push","startIntervalForHistoryEntry","shouldRemoveTransitionInterval","markedForDeletion","shortAbsenceTimeRest","msToSec","includes","calculateInEntityOnADate","sort","currentEntity","nextEntity","forEach","getCommentByEntity","trim","getCodesToStore","isObject","hasOwnProperty","isInUnsentHistory","privateCodesToStore","DateFormatter","space","getWorkingEntities","workingEntities","workingEntity","hint","EntityGroup","otherTimeRest","others","shortAbsence","otherCodes","shortAbsenceCodes","excludeCodes","concat","group","other","allowedTime","value","getPersonalEntities","personalEntities","a","b","getSiteDetailByPrivateCode","util","objectClone","entries","getChartData","segments","reportDate","emptyChart","getFullYear","getMonth","inactive","clickable","clickableHint","stretchable","minute","workingCustom","working","currentSegment","nextSegment","firstSegmentFrom","unshift","index","setMinutes","lastSegmentTo","chartData","lastSegmentType","segment","getOverChartData","selectedPrivateCode","selectedCodes","display","hasUnsentHistory","setHours","setSeconds","setMilliseconds","currentDate","getReportComment","hasActivityOtherThanBitrix24","hasActivity","appSiteEntities","siteTitle","sentQueueItem","year","month","day","items","absenceShort","VuexBuilderModel","Entity","createSite","createApp","createAbsence","createUnknown","createIncognito","URL","url","err","hostFragments","split","substring","name","pureName","pureTitle","EventHandler","preFinishInterval","lastCaught","process","getEntityTypeByEvent","getNameByProcess","isNewEvent","dispatch","away","isWorkingDayStarted","isTrackerGetActiveAppAvailable","TrackerGetActiveApp","event","separator","path","getApiVersion","DesktopApi","subscribe","catchAppClose","bind","setInterval","eventHandler","Sender","attempt","resendTimeout","resendTimeoutId","ajax","runAction","data","getSentQueue","then","status","afterSuccessSend","getStatusDisabled","disable","startSendingTimer","setTimeout","send","getSendingDelay","monitor","clearTimeout","SidePanel","Instance","close","UI","Center","content","autoHideDelay","sender","CommandHandler","getStatusEnabled","reload","stop","enable","options","playTimeout","isAway","vuex","defaultStorageConfig","dateFormat","timeFormat","debugEnabled","LogInfo","initApp","Pull","VuexBuilder","addModel","create","setVariables","useDatabase","setDatabaseConfig","DatabaseType","indexedDb","siteId","userId","build","builder","getStorage","initTracker","errorMessage","init","TimeFormatter","onAway","addTab","order","target","events","open","openReport","command","MessengerCommon","isDesktop","setActiveWindow","launch","shouldShowGrantingPermissionWindow","BXDesktopWindow","ExecuteCommand","isPaused","isPauseRelevant","setPlayTimeout","isTrackerEventsApiAvailable","TrackerStart","TrackerStop","catchAbsence","MonitorReport","openPreview","getPausedUntilTime","pause","hideTab"],"mappings":"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"}