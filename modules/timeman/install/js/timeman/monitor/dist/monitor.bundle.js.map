{"version":3,"file":"monitor.bundle.js","sources":["../src/model/utils/code.js","../src/model/utils/time.js","../src/lib/logger.js","../src/lib/debug.js","../src/lib/notification.js","../src/model/monitor.js","../src/model/entity.js","../src/eventhandler.js","../src/sender.js","../src/lib/commandhandler.js","../src/monitor.js"],"sourcesContent":["import {md5} from 'main.md5';\nimport {sha1} from 'main.sha1';\n\nexport class Code\n{\n\tstatic createPublic(...params)\n\t{\n\t\treturn md5(params.join(''));\n\t}\n\n\tstatic createPrivate(...params)\n\t{\n\t\treturn sha1(params.join(''));\n\t}\n\n\tstatic createSecret()\n\t{\n\t\tif (typeof BXDesktopSystem === 'undefined')\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn Code.createPrivate(\n\t\t\tBXDesktopSystem.UserAccount(),\n\t\t\tBXDesktopSystem.UserOsMark(),\n\t\t\t+Date.now(),\n\t\t);\n\t}\n\n\tstatic getDesktopCode()\n\t{\n\t\tif (typeof BXDesktopSystem === 'undefined')\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn Code.createPublic(\n\t\t\tBXDesktopSystem.UserAccount(),\n\t\t\tBXDesktopSystem.UserOsMark()\n\t\t);\n\t}\n}","export class Time\n{\n\tstatic calculateInEntityOnADate(state, entity, date)\n\t{\n\t\treturn state.history\n\t\t\t.filter(entry => (\n\t\t\t\tentry.privateCode === entity.privateCode\n\t\t\t\t&& entry.dateLog === date\n\t\t\t))\n\t\t\t.map(Time.calculateInEntry)\n\t\t\t.reduce((sum, time) => sum + time, 0);\n\t}\n\n\tstatic calculateInEntry(entry)\n\t{\n\t\tconst time = entry.time\n\t\t\t.map(interval => {\n\t\t\t\tconst finish = interval.finish ? new Date(interval.finish) : new Date();\n\n\t\t\t\treturn finish - new Date(interval.start);\n\t\t\t})\n\t\t\t.reduce((sum, interval) => sum + interval, 0);\n\n\t\treturn Math.round(time / 1000);\n\t}\n\n\tstatic formatDateToTime(date: Date)\n\t{\n\t\tconst addZero = num => (num >= 0 && num <= 9) ? '0' + num : num;\n\n\t\tconst hour = date.getHours();\n\t\tconst min = addZero(date.getMinutes());\n\n\t\treturn hour + ':' + min;\n\t}\n\n\tstatic msToSec(ms)\n\t{\n\t\treturn ms / 1000;\n\t}\n}","import {Type} from 'main.core';\nimport {Monitor} from '../monitor';\n\nclass Logger\n{\n\tconstructor()\n\t{\n\t\tthis.storageKey = 'bx-timeman-monitor-logger-enabled';\n\t\tthis.enabled = null;\n\t}\n\n\tstart()\n\t{\n\t\tif (!Monitor.isEnabled())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.enabled = true;\n\n\t\tif (typeof window.localStorage !== 'undefined')\n\t\t{\n\t\t\ttry\n\t\t\t{\n\t\t\t\twindow.localStorage.setItem(this.storageKey, 'Y');\n\t\t\t}\n\t\t\tcatch(e) {}\n\t\t}\n\n\t\treturn this.enabled;\n\t}\n\n\tstop()\n\t{\n\t\tthis.enabled = false;\n\n\t\tif (typeof window.localStorage !== 'undefined')\n\t\t{\n\t\t\ttry\n\t\t\t{\n\t\t\t\twindow.localStorage.removeItem(this.storageKey);\n\t\t\t}\n\t\t\tcatch(e) {}\n\t\t}\n\n\t\treturn this.enabled;\n\t}\n\n\tisEnabled()\n\t{\n\t\tif (!Monitor.isEnabled())\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tif (this.enabled === null)\n\t\t{\n\t\t\tif (typeof window.localStorage !== 'undefined')\n\t\t\t{\n\t\t\t\ttry\n\t\t\t\t{\n\t\t\t\t\tthis.enabled = window.localStorage.getItem(this.storageKey) === 'Y';\n\t\t\t\t}\n\t\t\t\tcatch(e) {}\n\t\t\t}\n\t\t}\n\n\t\treturn this.enabled === true;\n\t}\n\n\tlog(...params)\n\t{\n\t\tif (this.isEnabled())\n\t\t{\n\t\t\tconsole.log(...params);\n\t\t}\n\t}\n\n\tinfo(...params)\n\t{\n\t\tif (this.isEnabled())\n\t\t{\n\t\t\tconsole.info(...params);\n\t\t}\n\t}\n\n\twarn(...params)\n\t{\n\t\tif (this.isEnabled())\n\t\t{\n\t\t\tconsole.warn(...params);\n\t\t}\n\t}\n\n\terror(...params)\n\t{\n\t\tconsole.error(...params);\n\t}\n\n\ttrace(...params)\n\t{\n\t\tconsole.trace(...params);\n\t}\n}\n\nlet logger = new Logger();\n\nexport {logger as Logger};","import {Loc} from 'main.core';\n\nclass Debug\n{\n\tconstructor()\n\t{\n\t\tthis.enabled = false;\n\t}\n\n\tisEnabled()\n\t{\n\t\treturn this.enabled;\n\t}\n\n\tenable()\n\t{\n\t\tthis.enabled = true;\n\t}\n\n\tdisable()\n\t{\n\t\tthis.enabled = false;\n\t}\n\n\tlog(...params)\n\t{\n\t\tif (!this.isEnabled())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet text = this.getLogMessage(...params);\n\n\t\tBX.desktop.log(Loc.getMessage('USER_ID') + '.monitor.log', text.substr(3));\n\t}\n\n\tspace()\n\t{\n\t\tif (!this.isEnabled())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tBX.desktop.log(Loc.getMessage('USER_ID') + '.monitor.log', ' ');\n\t}\n\n\tgetLogMessage()\n\t{\n\t\tif (!this.isEnabled())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet text = '';\n\n\t\tfor (let i = 0; i < arguments.length; i++)\n\t\t{\n\t\t\tif(arguments[i] instanceof Error)\n\t\t\t{\n\t\t\t\ttext = arguments[i].message + \"\\n\" + arguments[i].stack\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\ttry\n\t\t\t\t{\n\t\t\t\t\ttext = text+' | '+(typeof(arguments[i]) == 'object'? JSON.stringify(arguments[i]): arguments[i]);\n\t\t\t\t}\n\t\t\t\tcatch (e)\n\t\t\t\t{\n\t\t\t\t\ttext = text+' | (circular structure)';\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn text;\n\t}\n}\n\nlet debug = new Debug();\n\nexport {debug as Debug};","import {Type} from 'main.core';\n\nexport class Notification\n{\n\tconstructor(title, text, callback)\n\t{\n\t\tthis.title = title.toString();\n\t\tthis.text = text.toString();\n\n\t\tif (Type.isFunction(callback))\n\t\t{\n\t\t\tthis.callback = callback;\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tshow()\n\t{\n\t\tBXIM.playSound('newMessage1');\n\n\t\tconst messageTemplate = BXIM.notify.createNotify({\n\t\t\tid: 0, type: 4,\n\t\t\tdate: new Date(),\n\t\t\tparams: {},\n\t\t\ttitle: this.title,\n\t\t\ttext: this.text,\n\t\t}, true);\n\n\t\tconst messageJs = `\n\t\t\tvar notify = BX.findChildByClassName(document.body, \"bx-notifier-item\");\n\t\t\t\n\t\t\tnotify.style.cursor = \"pointer\";\n\t\t\t\n\t\t\tBX.bind(notify, \"click\", function() {\n\t\t\t\tBX.desktop.onCustomEvent(\"main\", \"bxImClickPwtMessage\", []);\n\t\t\t\tBX.desktop.windowCommand(\"close\")\n\t\t\t});\n\t\t\t\n\t\t\tBX.bind(BX.findChildByClassName(notify, \"bx-notifier-item-delete\"), \"click\", function(event) { \n\t\t\t\tBX.desktop.windowCommand(\"close\"); \n\t\t\t\tBX.MessengerCommon.preventDefault(event); \n\t\t\t});\n\t\t\t\n\t\t\tBX.bind(notify, \"contextmenu\", function() {\n\t\t\t\tBX.desktop.windowCommand(\"close\")\n\t\t\t});\n\t\t`;\n\n\t\tBXIM.desktop.openNewMessage('pwt' + (new Date), messageTemplate, messageJs);\n\n\t\tBX.desktop.addCustomEvent('bxImClickPwtMessage', () => this.click());\n\t}\n\n\tclick()\n\t{\n\t\tif (Type.isFunction(this.callback))\n\t\t{\n\t\t\tthis.callback();\n\t\t}\n\n\t\tBX.desktop.removeCustomEvents('bxImClickPwtMessage');\n\t}\n}","import {Loc, Type} from 'main.core';\nimport {VuexBuilderModel} from 'ui.vue.vuex';\nimport {EntityType, EntityGroup} from 'timeman.const';\nimport {Code} from './utils/code';\nimport {Time} from './utils/time';\nimport {Logger} from '../lib/logger';\nimport {Debug} from '../lib/debug';\nimport {DateFormatter} from 'timeman.dateformatter';\nimport {Notification} from \"../lib/notification\";\n\nexport class MonitorModel extends VuexBuilderModel\n{\n\tgetName()\n\t{\n\t\treturn 'monitor';\n\t}\n\n\tgetSaveTimeout()\n\t{\n\t\treturn 1000;\n\t}\n\n\tgetLoadTimeout()\n\t{\n\t\treturn false;\n\t}\n\n\tgetState()\n\t{\n\t\treturn {\n\t\t\tconfig: {\n\t\t\t\tsecret: Code.createSecret(),\n\t\t\t\tdesktopCode: Code.getDesktopCode(),\n\t\t\t\totherTime: this.getVariable('config.otherTime', 1800000),\n\t\t\t\tshortAbsenceTime: this.getVariable('config.shortAbsenceTime', 1800000),\n\t\t\t\tpausedUntil: null,\n\t\t\t\tlastSuccessfulSendDate: null,\n\t\t\t\tlastRemindDate: null,\n\t\t\t\tgrantingPermissionDate: null,\n\t\t\t\tdeferredGrantingPermissionShowDate: null,\n\t\t\t},\n\t\t\treportState: {\n\t\t\t\tdateLog: this.getDateLog(),\n\t\t\t\tcomments: [],\n\t\t\t},\n\t\t\tpersonal: [],\n\t\t\tstrictlyWorking: [],\n\t\t\tentity: [],\n\t\t\thistory: [],\n\t\t\tsentQueue: [],\n\t\t};\n\t}\n\n\tgetEntityState()\n\t{\n\t\treturn {\n\t\t\ttype: EntityType.unknown,\n\t\t\ttitle: '',\n\t\t\tpublicCode: '',\n\t\t\tprivateCode: '',\n\t\t\tcomments: [],\n\t\t\textra: {},\n\t\t};\n\t}\n\n\tgetHistoryState()\n\t{\n\t\treturn {\n\t\t\tdateLog: this.getDateLog(),\n\t\t\tprivateCode: '',\n\t\t\ttime: [{\n\t\t\t\tstart: new Date(),\n\t\t\t\tpreFinish: null,\n\t\t\t\tfinish: null\n\t\t\t}]\n\t\t};\n\t}\n\n\tgetSentQueueState()\n\t{\n\t\treturn {\n\t\t\tdateLog: this.getDateLog(),\n\t\t\tcomment: '',\n\t\t\thistoryPackage: [],\n\t\t\tchartPackage: [],\n\t\t\tdesktopCode: '',\n\t\t};\n\t}\n\n\tgetActions()\n\t{\n\t\treturn {\n\t\t\tsetDateLog: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (Type.isString(payload))\n\t\t\t\t{\n\t\t\t\t\tconst date = new Date(payload);\n\n\t\t\t\t\tif (\n\t\t\t\t\t\tType.isDate(date)\n\t\t\t\t\t\t&& !isNaN(date)\n\t\t\t\t\t\t&& payload.length === 10\n\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\tstore.commit('setDateLog', payload);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\n\t\t\trefreshDateLog: (store) =>\n\t\t\t{\n\t\t\t\tif (Type.isArrayFilled(store.state.history))\n\t\t\t\t{\n\t\t\t\t\tlet firstHistoryEntryDateLog = store.state.history[0].dateLog;\n\t\t\t\t\tthis.getActions().setDateLog(store, firstHistoryEntryDateLog);\n\n\t\t\t\t\tLogger.log(`Report date is set for ${firstHistoryEntryDateLog}`);\n\t\t\t\t\tDebug.log(`Report date is set for ${firstHistoryEntryDateLog}`);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tlet dateLog = this.getDateLog();\n\t\t\t\t\tthis.getActions().setDateLog(store, dateLog);\n\n\t\t\t\t\tLogger.log(`Report date is set for ${dateLog}`);\n\t\t\t\t\tDebug.log(`Report date is set for ${dateLog}`);\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tsetLastRemindDate: (store, date) =>\n\t\t\t{\n\t\t\t\tstore.commit('setLastRemindDate', date);\n\t\t\t},\n\n\t\t\tgrantPermission: (store) =>\n\t\t\t{\n\t\t\t\tstore.commit('setGrantingPermissionDate', new Date());\n\t\t\t},\n\n\t\t\tshowGrantingPermissionLater: (store) =>\n\t\t\t{\n\t\t\t\tlet date = new Date();\n\t\t\t\tdate.setDate(date.getDate() + 1);\n\n\t\t\t\tlet formattedDate = MonitorModel.prototype.formatDateLog(date);\n\n\t\t\t\tstore.commit('setDeferredGrantingPermissionShowDate', formattedDate);\n\t\t\t},\n\n\t\t\tsetLastSuccessfulSendDate: (store, date) =>\n\t\t\t{\n\t\t\t\tif (\n\t\t\t\t\tType.isDate(date)\n\t\t\t\t\t&& !isNaN(date)\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('setLastSuccessfulSendDate', date);\n\t\t\t\t}\n\t\t\t},\n\n\t\t\taddPersonal: (store, privateCode) =>\n\t\t\t{\n\t\t\t\tstore.commit('addPersonal', this.validatePersonal(privateCode));\n\t\t\t},\n\n\t\t\tremovePersonal: (store, privateCode) =>\n\t\t\t{\n\t\t\t\tstore.commit('removePersonal', this.validatePersonal(privateCode));\n\t\t\t},\n\n\t\t\taddToStrictlyWorking: (store, privateCode) =>\n\t\t\t{\n\t\t\t\tstore.commit('addToStrictlyWorking', privateCode);\n\t\t\t},\n\n\t\t\tremoveFromStrictlyWorking: (store, privateCode) =>\n\t\t\t{\n\t\t\t\tstore.commit('removeFromStrictlyWorking', privateCode);\n\t\t\t},\n\n\t\t\tclearStrictlyWorking: (store) =>\n\t\t\t{\n\t\t\t\tstore.commit('clearStrictlyWorking');\n\t\t\t},\n\n\t\t\tclearPersonal: (store) =>\n\t\t\t{\n\t\t\t\tstore.commit('clearPersonal');\n\t\t\t},\n\n\t\t\taddEntity: (store, payload) =>\n\t\t\t{\n\t\t\t\tlet result = this.validateEntity({...payload});\n\n\t\t\t\tif (\n\t\t\t\t\tresult.type !== EntityType.absence\n\t\t\t\t\t&& result.type !== EntityType.custom\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tresult.publicCode = Code.createPublic(result.title);\n\t\t\t\t\tresult.privateCode = Code.createPrivate(result.title, store.state.config.secret);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tconst date = new Date();\n\t\t\t\t\tconst timestamp = +date;\n\n\t\t\t\t\tresult.publicCode = Code.createPublic(result.title, timestamp);\n\t\t\t\t\tresult.privateCode = Code.createPrivate(result.title, timestamp, store.state.config.secret);\n\n\t\t\t\t\tif (result.type === EntityType.absence)\n\t\t\t\t\t{\n\t\t\t\t\t\tresult.extra = {\n\t\t\t\t\t\t\ttimeStart: date,\n\t\t\t\t\t\t};\n\t\t\t\t\t\tresult.title +=\n\t\t\t\t\t\t\t' '\n\t\t\t\t\t\t\t+ Loc.getMessage('TIMEMAN_PWT_REPORT_ABSENCE_FROM_TIME')\n\t\t\t\t\t\t\t+ ' '\n\t\t\t\t\t\t\t+ Time.formatDateToTime(result.extra.timeStart)\n\t\t\t\t\t\t;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tstore.commit('addEntity', {\n\t\t\t\t\t...this.getEntityState(),\n\t\t\t\t\t...result,\n\t\t\t\t});\n\n\t\t\t\tif (!store.state.strictlyWorking.find(privateCode => privateCode === result.privateCode))\n\t\t\t\t{\n\t\t\t\t\tconst isBitrix24Cp = (\n\t\t\t\t\t\tresult.type === EntityType.site\n\t\t\t\t\t\t&& result.title === location.host\n\t\t\t\t\t);\n\n\t\t\t\t\tconst isBitrix24Desktop = (\n\t\t\t\t\t\tresult.type === EntityType.app\n\t\t\t\t\t\t&& payload.isBitrix24Desktop\n\t\t\t\t\t);\n\n\t\t\t\t\tif (\n\t\t\t\t\t\tisBitrix24Cp\n\t\t\t\t\t\t|| isBitrix24Desktop\n\t\t\t\t\t\t|| result.type === EntityType.custom\n\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\tstore.commit('addToStrictlyWorking', result.privateCode);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn result;\n\t\t\t},\n\n\t\t\tremoveEntityByPrivateCode: (store, payload) =>\n\t\t\t{\n\t\t\t\tstore.commit('removeEntityByPrivateCode', payload);\n\t\t\t},\n\n\t\t\tclearEntities: (store) =>\n\t\t\t{\n\t\t\t\tstore.commit('clearEntities');\n\t\t\t},\n\n\t\t\taddHistory: (store, payload) =>\n\t\t\t{\n\t\t\t\tstore.commit('finishLastInterval');\n\n\t\t\t\tconst result = this.validateHistory({...payload});\n\n\t\t\t\tlet entity;\n\t\t\t\tlet privateCode;\n\t\t\t\tlet historyEntry = null;\n\n\t\t\t\tif (\n\t\t\t\t\tresult.type === EntityType.app\n\t\t\t\t\t|| result.type === EntityType.site\n\t\t\t\t\t|| result.type === EntityType.unknown\n\t\t\t\t\t|| result.type === EntityType.incognito\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tentity = this.getEntityByTitle(store, result.title);\n\t\t\t\t\tprivateCode = (entity ? entity.privateCode : null);\n\n\t\t\t\t\tif (!privateCode)\n\t\t\t\t\t{\n\t\t\t\t\t\tprivateCode = this.getActions().addEntity(store, payload).privateCode;\n\t\t\t\t\t}\n\n\t\t\t\t\thistoryEntry = (entity && entity.type === EntityType.site)\n\t\t\t\t\t\t? this.getHistoryEntryBySiteUrl(store, result.siteUrl)\n\t\t\t\t\t\t: this.getHistoryEntryByPrivateCode(store, privateCode);\n\t\t\t\t}\n\t\t\t\telse if (\n\t\t\t\t\tresult.type === EntityType.absence\n\t\t\t\t\t|| result.type === EntityType.custom\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tentity = this.getActions().addEntity(store, payload);\n\t\t\t\t\tprivateCode = entity.privateCode;\n\t\t\t\t}\n\n\t\t\t\tif (!historyEntry)\n\t\t\t\t{\n\t\t\t\t\tdelete result.title;\n\n\t\t\t\t\tstore.commit('addHistory', {\n\t\t\t\t\t\t...this.getHistoryState(),\n\t\t\t\t\t\t...result,\n\t\t\t\t\t\tprivateCode,\n\t\t\t\t\t});\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (result.type !== EntityType.custom)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('startIntervalForHistoryEntry', historyEntry);\n\t\t\t\t}\n\n\t\t\t\tlet lastRemindDate = store.state.config.lastRemindDate;\n\t\t\t\tlet canShowReminder = new Date(lastRemindDate) < new Date(this.getDateLog());\n\t\t\t\tlet isHistorySent = this.getGetters().isHistorySent(store.state);\n\n\t\t\t\tif (!lastRemindDate || (canShowReminder && !isHistorySent))\n\t\t\t\t{\n\t\t\t\t\tif (this.getGetters().getWorkingTimeForToday(store.state) >= 32400) //9 hour in seconds\n\t\t\t\t\t{\n\t\t\t\t\t\tnew Notification(\n\t\t\t\t\t\t\tLoc.getMessage('TIMEMAN_PWT_REPORT_NOTIFICATION_REMINDER_TITLE'),\n\t\t\t\t\t\t\tLoc.getMessage('TIMEMAN_PWT_REPORT_NOTIFICATION_REMINDER_TEXT'),\n\t\t\t\t\t\t\t() => {\n\t\t\t\t\t\t\t\tBX.desktop.windowCommand(\"show\");\n\t\t\t\t\t\t\t\tBX.desktop.changeTab('im');\n\t\t\t\t\t\t\t\tBX.MessengerWindow.changeTab('timeman-pwt');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t).show();\n\n\t\t\t\t\t\tstore.commit('setLastRemindDate', this.getDateLog());\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tpreFinishLastInterval: (store) =>\n\t\t\t{\n\t\t\t\tstore.commit('preFinishLastInterval');\n\t\t\t},\n\n\t\t\tfinishLastInterval: (store) =>\n\t\t\t{\n\t\t\t\tstore.commit('finishLastInterval');\n\t\t\t},\n\n\t\t\tclearHistory: (store) =>\n\t\t\t{\n\t\t\t\tstore.commit('clearHistory');\n\t\t\t},\n\n\t\t\tcreateSentQueue: (store) =>\n\t\t\t{\n\t\t\t\tif (store.state.history.length === 0)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tlet sentQueue = this.collectSentQueue(store);\n\t\t\t\tlet reportComment = store.state.reportState.comments\n\t\t\t\t\t.find(comment => comment.dateLog === store.state.reportState.dateLog);\n\n\t\t\t\tlet result = this.validateSentQueue({\n\t\t\t\t\tdateLog: store.state.reportState.dateLog,\n\t\t\t\t\tcomment: reportComment ? reportComment.text : '',\n\t\t\t\t\thistoryPackage: sentQueue.history,\n\t\t\t\t\tchartPackage: sentQueue.chart,\n\t\t\t\t\tdesktopCode: store.state.config.desktopCode,\n\t\t\t\t});\n\n\t\t\t\tstore.commit('createSentQueue', {\n\t\t\t\t\t...this.getSentQueueState(),\n\t\t\t\t\t...result\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tclearSentQueue: (store) =>\n\t\t\t{\n\t\t\t\tstore.commit('clearSentQueue');\n\t\t\t},\n\n\t\t\tclearSentHistory: (store) =>\n\t\t\t{\n\t\t\t\tlet lastSuccessfulSendDate = store.state.config.lastSuccessfulSendDate;\n\t\t\t\tif (!lastSuccessfulSendDate)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (new Date(this.getDateLog()) > new Date(lastSuccessfulSendDate))\n\t\t\t\t{\n\t\t\t\t\tstore.commit('clearStorageBeforeDate', new Date(lastSuccessfulSendDate));\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tclearStorageBeforeDate: (store, date) =>\n\t\t\t{\n\t\t\t\tstore.commit('clearStorageBeforeDate', new Date(date));\n\t\t\t},\n\n\t\t\tsetComment: (store, payload) =>\n\t\t\t{\n\t\t\t\tconst entity = store.state.entity.find(entity => entity.privateCode === payload.privateCode);\n\n\t\t\t\tif (entity && (Type.isString(payload.comment) || Type.isNumber(payload.comment)))\n\t\t\t\t{\n\t\t\t\t\tstore.commit('setComment', {\n\t\t\t\t\t\tentity,\n\t\t\t\t\t\tcomment: payload.comment.toString()\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tsetPausedUntil: (store, dateTime) =>\n\t\t\t{\n\t\t\t\tif (\n\t\t\t\t\tType.isDate(dateTime)\n\t\t\t\t\t&& Type.isNumber(dateTime.getTime())\n\t\t\t\t\t&& dateTime > new Date()\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('setPausedUntil', dateTime);\n\n\t\t\t\t\tLogger.warn('Monitor paused until ', dateTime.toString());\n\t\t\t\t\tDebug.log('Monitor paused until ', dateTime.toString());\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tclearPausedUntil: (store) =>\n\t\t\t{\n\t\t\t\tstore.commit('clearPausedUntil');\n\t\t\t},\n\n\t\t\tsetReportComment: (store, comment) =>\n\t\t\t{\n\t\t\t\tstore.commit('setReportComment', comment.toString());\n\t\t\t},\n\n\t\t\tprocessUnfinishedEvents: (store) =>\n\t\t\t{\n\t\t\t\tstore.commit('processUnfinishedEvents');\n\t\t\t},\n\n\t\t\tmigrateHistory: (store) =>\n\t\t\t{\n\t\t\t\tstore.commit('migrateHistory');\n\t\t\t}\n\t\t}\n\t}\n\n\tgetMutations()\n\t{\n\t\treturn {\n\t\t\tsetDateLog: (state, payload) =>\n\t\t\t{\n\t\t\t\tstate.reportState.dateLog = payload;\n\n\t\t\t\tsuper.saveState(state);\n\t\t\t},\n\n\t\t\tsetLastSuccessfulSendDate: (state, date) =>\n\t\t\t{\n\t\t\t\tstate.config.lastSuccessfulSendDate = date;\n\n\t\t\t\tsuper.saveState(state);\n\t\t\t},\n\n\t\t\tsetLastRemindDate: (state, date) =>\n\t\t\t{\n\t\t\t\tstate.config.lastRemindDate = date;\n\n\t\t\t\tsuper.saveState(state);\n\t\t\t},\n\n\t\t\tsetGrantingPermissionDate: (state, date) =>\n\t\t\t{\n\t\t\t\tstate.config.grantingPermissionDate = date;\n\n\t\t\t\tsuper.saveState(state);\n\t\t\t},\n\n\t\t\tsetDeferredGrantingPermissionShowDate: (state, date) =>\n\t\t\t{\n\t\t\t\tstate.config.deferredGrantingPermissionShowDate = date;\n\n\t\t\t\tsuper.saveState(state);\n\t\t\t},\n\n\t\t\taddPersonal: (state, payload) =>\n\t\t\t{\n\t\t\t\tstate.personal.push(payload);\n\n\t\t\t\tsuper.saveState(state);\n\t\t\t},\n\n\t\t\tremovePersonal: (state, payload) =>\n\t\t\t{\n\t\t\t\tstate.personal = state.personal.filter(privateCode => privateCode !== payload);\n\n\t\t\t\tsuper.saveState(state);\n\t\t\t},\n\n\t\t\taddToStrictlyWorking: (state, payload) =>\n\t\t\t{\n\t\t\t\tstate.strictlyWorking.push(payload);\n\n\t\t\t\tsuper.saveState(state);\n\t\t\t},\n\n\t\t\tremoveFromStrictlyWorking: (state, payload) =>\n\t\t\t{\n\t\t\t\tstate.strictlyWorking = state.strictlyWorking.filter(publicCode => publicCode !== payload)\n\n\t\t\t\tsuper.saveState(state);\n\t\t\t},\n\n\t\t\tclearStrictlyWorking: (state) =>\n\t\t\t{\n\t\t\t\tstate.strictlyWorking = [];\n\n\t\t\t\tsuper.saveState(state);\n\t\t\t},\n\n\t\t\tclearPersonal: (state) =>\n\t\t\t{\n\t\t\t\tstate.personal = [];\n\n\t\t\t\tsuper.saveState(state);\n\t\t\t},\n\n\t\t\taddEntity: (state, payload) =>\n\t\t\t{\n\t\t\t\tstate.entity.push(payload);\n\n\t\t\t\tsuper.saveState(state);\n\t\t\t},\n\n\t\t\tremoveEntityByPrivateCode: (state, payload) =>\n\t\t\t{\n\t\t\t\tstate.entity = state.entity.filter(entity => entity.privateCode !== payload);\n\t\t\t\tstate.history = state.history.filter(entry => entry.privateCode !== payload);\n\t\t\t\tstate.strictlyWorking = state.strictlyWorking.filter(privateCode => privateCode !== payload);\n\t\t\t\tstate.personal = state.personal.filter(privateCode => privateCode !== payload);\n\n\t\t\t\tsuper.saveState(state);\n\t\t\t},\n\n\t\t\tclearEntities: (state) =>\n\t\t\t{\n\t\t\t\tstate.entity = [];\n\n\t\t\t\tsuper.saveState(state);\n\t\t\t},\n\n\t\t\taddHistory: (state, payload) =>\n\t\t\t{\n\t\t\t\tstate.history.push(payload);\n\n\t\t\t\tsuper.saveState(state);\n\t\t\t},\n\n\t\t\tstartIntervalForHistoryEntry: (state, historyEntry) =>\n\t\t\t{\n\t\t\t\thistoryEntry.time.push({\n\t\t\t\t\tstart: new Date(),\n\t\t\t\t\tfinish: null\n\t\t\t\t});\n\n\t\t\t\tsuper.saveState(state);\n\t\t\t},\n\n\t\t\tfinishLastInterval: (state) => {\n\t\t\t\tlet shouldRemoveTransitionInterval = false;\n\n\t\t\t\tstate.history.map(entry => {\n\t\t\t\t\tentry.time = entry.time.map(time => {\n\t\t\t\t\t\tif (time.finish === null)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttime.finish = new Date();\n\t\t\t\t\t\t\ttime.preFinish = null;\n\n\t\t\t\t\t\t\tif (new Date(time.start).getDate() !== time.finish.getDate())\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tshouldRemoveTransitionInterval = true;\n\t\t\t\t\t\t\t\ttime.markedForDeletion = true;\n\n\t\t\t\t\t\t\t\tLogger.warn('Interval marked for deletion');\n\t\t\t\t\t\t\t\tDebug.log('Interval marked for deletion');\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (entry.type !== EntityType.absence)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\treturn time;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tlet shortAbsenceTimeRest = Time.msToSec(state.config.shortAbsenceTime);\n\n\t\t\t\t\t\t\tstate.entity\n\t\t\t\t\t\t\t\t.filter(entity => {\n\t\t\t\t\t\t\t\t\tif (!state.personal.includes(entity.privateCode))\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\treturn entity;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t.map(entity => {\n\t\t\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\t\t\t...entity,\n\t\t\t\t\t\t\t\t\t\ttime: Time.calculateInEntityOnADate(state, entity, state.reportState.dateLog),\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t.sort((currentEntity, nextEntity) => currentEntity.time - nextEntity.time)\n\t\t\t\t\t\t\t\t.forEach(entity => {\n\t\t\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t\t\tstate.strictlyWorking.includes(entity.privateCode)\n\t\t\t\t\t\t\t\t\t\t|| entity.type !== EntityType.absence\n\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\tif (MonitorModel.prototype.getCommentByEntity(state, entity).trim() === '')\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tif (shortAbsenceTimeRest - entity.time >= 0)\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\tshortAbsenceTimeRest -= entity.time;\n\t\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\tstate.personal.push(entity.privateCode);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn time;\n\t\t\t\t\t}).filter(interval => !interval.markedForDeletion);\n\n\t\t\t\t\treturn entry;\n\t\t\t\t});\n\n\t\t\t\tif (shouldRemoveTransitionInterval)\n\t\t\t\t{\n\t\t\t\t\tstate.history = state.history.filter(entry => Type.isArrayFilled(entry.time));\n\t\t\t\t}\n\n\t\t\t\tsuper.saveState(state);\n\t\t\t},\n\n\t\t\tpreFinishLastInterval: (state) =>\n\t\t\t{\n\t\t\t\tstate.history = state.history.map(entry => {\n\t\t\t\t\tentry.time = entry.time.map(time => {\n\t\t\t\t\t\tif (time.finish === null)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttime.preFinish = new Date();\n\t\t\t\t\t\t\tLogger.log('Last interval for ', entry.privateCode, ' preFinished');\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn time;\n\t\t\t\t\t})\n\n\t\t\t\t\treturn entry;\n\t\t\t\t});\n\n\t\t\t\tsuper.saveState(state);\n\t\t\t},\n\n\t\t\tclearHistory: (state) =>\n\t\t\t{\n\t\t\t\tstate.history = [];\n\n\t\t\t\tsuper.saveState(state);\n\t\t\t},\n\n\t\t\tcreateSentQueue: (state, payload) =>\n\t\t\t{\n\t\t\t\tstate.sentQueue.push(payload);\n\n\t\t\t\tsuper.saveState(state);\n\t\t\t},\n\n\t\t\tclearSentQueue: (state) =>\n\t\t\t{\n\t\t\t\tstate.sentQueue = [];\n\n\t\t\t\tsuper.saveState(state);\n\t\t\t},\n\n\t\t\tclearStorageBeforeDate: (state, date) =>\n\t\t\t{\n\t\t\t\tstate.history = state.history\n\t\t\t\t\t.filter(entry => new Date(entry.dateLog) > date);\n\n\t\t\t\tconst getCodesToStore = privateCode => {\n\n\t\t\t\t\tconst entity = state.entity.find(entity => entity.privateCode === privateCode);\n\n\t\t\t\t\tif (Type.isObject(entity) && entity.hasOwnProperty('type'))\n\t\t\t\t\t{\n\t\t\t\t\t\tif (entity.type !== EntityType.absence)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst isInUnsentHistory = state.history.find(entry => entry.privateCode === privateCode);\n\t\t\t\t\t\tif (isInUnsentHistory)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tLogger.warn(`${entity.title} has been removed from personal`);\n\t\t\t\t\t\tDebug.log(`${entity.title} has been removed from personal`);\n\t\t\t\t\t}\n\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tstate.personal = state.personal.filter(getCodesToStore);\n\t\t\t\tstate.strictlyWorking = state.strictlyWorking.filter(getCodesToStore);\n\n\t\t\t\tif (Type.isArrayFilled(state.history))\n\t\t\t\t{\n\t\t\t\t\tlet privateCodesToStore = [];\n\n\t\t\t\t\tstate.history.forEach(entry => {\n\t\t\t\t\t\tif (!privateCodesToStore.includes(entry.privateCode))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tprivateCodesToStore.push(entry.privateCode);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\tstate.entity = state.entity\n\t\t\t\t\t\t.filter(entity => privateCodesToStore.includes(entity.privateCode));\n\n\t\t\t\t\tstate.entity = state.entity.map(entity => {\n\t\t\t\t\t\tentity.comments = entity.comments.filter(comment => new Date(comment.dateLog) > date);\n\n\t\t\t\t\t\treturn entity;\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tstate.entity = [];\n\t\t\t\t}\n\n\t\t\t\tstate.sentQueue = [];\n\t\t\t\tstate.reportState.comments = state.reportState.comments\n\t\t\t\t\t.filter(comment => new Date(comment.dateLog) > date);\n\n\t\t\t\tLogger.log(`Local history before ${DateFormatter.toString(date)} cleared`);\n\t\t\t\tDebug.space();\n\t\t\t\tDebug.log(`Local history before ${DateFormatter.toString(date)} cleared`);\n\n\t\t\t\tsuper.saveState(state);\n\t\t\t},\n\n\t\t\tsetComment: (state, payload) =>\n\t\t\t{\n\t\t\t\tconst dateLog = state.reportState.dateLog;\n\n\t\t\t\tlet comment = payload.entity.comments.find(comment => comment.dateLog === dateLog);\n\t\t\t\tif (comment)\n\t\t\t\t{\n\t\t\t\t\tcomment.text = payload.comment;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tpayload.entity.comments.push({\n\t\t\t\t\t\tdateLog,\n\t\t\t\t\t\ttext: payload.comment\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tsuper.saveState(state);\n\t\t\t},\n\n\t\t\tsetReportComment: (state, text) =>\n\t\t\t{\n\t\t\t\tconst dateLog = state.reportState.dateLog;\n\n\t\t\t\tlet comment = state.reportState.comments.find(comment => comment.dateLog === dateLog);\n\t\t\t\tif (comment)\n\t\t\t\t{\n\t\t\t\t\tcomment.text = text;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tstate.reportState.comments.push({\n\t\t\t\t\t\tdateLog,\n\t\t\t\t\t\ttext\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tsuper.saveState(state);\n\t\t\t},\n\n\t\t\tsetPausedUntil: (state, dateTime) =>\n\t\t\t{\n\t\t\t\tstate.config.pausedUntil = dateTime;\n\n\t\t\t\tsuper.saveState(state);\n\t\t\t},\n\n\t\t\tclearPausedUntil: (state) =>\n\t\t\t{\n\t\t\t\tstate.config.pausedUntil = null;\n\n\t\t\t\tsuper.saveState(state);\n\t\t\t},\n\n\t\t\tprocessUnfinishedEvents: (state) =>\n\t\t\t{\n\t\t\t\tstate.history.map(entry => {\n\t\t\t\t\tentry.time = entry.time.map(interval => {\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\tinterval.finish === null\n\t\t\t\t\t\t\t&& interval.preFinish !== null\n\t\t\t\t\t\t)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tinterval.finish = interval.preFinish;\n\t\t\t\t\t\t\tinterval.preFinish = null;\n\n\t\t\t\t\t\t\tLogger.log('Unfinished interval closed based on preFinish time');\n\t\t\t\t\t\t\tDebug.space();\n\t\t\t\t\t\t\tDebug.log('Unfinished interval closed based on preFinish time');\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn interval;\n\t\t\t\t\t});\n\n\t\t\t\t\tentry.time = entry.time.filter(time => {\n\t\t\t\t\t\tif (time.finish != null)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tLogger.log('Unfinished interval has been removed');\n\t\t\t\t\t\t\tDebug.space();\n\t\t\t\t\t\t\tDebug.log('Unfinished interval has been removed');\n\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\treturn entry;\n\t\t\t\t});\n\n\t\t\t\tsuper.saveState(state);\n\t\t\t},\n\n\t\t\tmigrateHistory: (state) =>\n\t\t\t{\n\t\t\t\tstate.entity.map(entity => {\n\t\t\t\t\tif (!entity.hasOwnProperty('comments'))\n\t\t\t\t\t{\n\t\t\t\t\t\tentity.comments = [];\n\n\t\t\t\t\t\tif (entity.comment)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tentity.comments.push({\n\t\t\t\t\t\t\t\tdateLog: state.reportState.dateLog,\n\t\t\t\t\t\t\t\ttext: entity.comment,\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tdelete entity.comment;\n\n\t\t\t\t\treturn entity;\n\t\t\t\t});\n\n\t\t\t\tif (!state.reportState.hasOwnProperty('comments'))\n\t\t\t\t{\n\t\t\t\t\tstate.reportState.comments = [];\n\n\t\t\t\t\tif (state.reportState.comment)\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.reportState.comments.push({\n\t\t\t\t\t\t\tdateLog: state.reportState.dateLog,\n\t\t\t\t\t\t\ttext: state.reportState.comment,\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t\tdelete state.reportState.comment;\n\t\t\t\t}\n\n\t\t\t\tsuper.saveState(state);\n\t\t\t},\n\t\t}\n\t}\n\n\tgetGetters()\n\t{\n\t\treturn {\n\t\t\tgetWorkingEntities(state)\n\t\t\t{\n\t\t\t\tlet workingEntities = state.entity.filter(entity => {\n\t\t\t\t\tif (!state.personal.includes(entity.privateCode))\n\t\t\t\t\t{\n\t\t\t\t\t\treturn entity;\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tworkingEntities = workingEntities\n\t\t\t\t\t.map(entity => {\n\t\t\t\t\t\tconst comment = entity.comments.find(comment => comment.dateLog === state.reportState.dateLog);\n\n\t\t\t\t\t\tconst workingEntity = {\n\t\t\t\t\t\t\t...entity,\n\t\t\t\t\t\t\ttime: Time.calculateInEntityOnADate(state, entity, state.reportState.dateLog),\n\t\t\t\t\t\t\tcomment: comment ? comment.text : '',\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (workingEntity.type === EntityType.unknown)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tworkingEntity.hint = EntityGroup.unknown.hint;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn workingEntity;\n\t\t\t\t\t})\n\t\t\t\t\t.filter(entity => entity.time > 0);\n\n\t\t\t\tlet otherTimeRest = Time.msToSec(state.config.otherTime);\n\t\t\t\tconst others = workingEntities\n\t\t\t\t\t.sort((currentEntity, nextEntity) => currentEntity.time - nextEntity.time)\n\t\t\t\t\t.filter(entity => {\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\tstate.strictlyWorking.includes(entity.privateCode)\n\t\t\t\t\t\t\t|| entity.type === EntityType.absence\n\t\t\t\t\t\t)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (otherTimeRest - entity.time >= 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\totherTimeRest -= entity.time;\n\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\tlet shortAbsenceTimeRest = Time.msToSec(state.config.shortAbsenceTime);\n\n\t\t\t\tconst shortAbsence = workingEntities\n\t\t\t\t\t.sort((currentEntity, nextEntity) => currentEntity.time - nextEntity.time)\n\t\t\t\t\t.filter(entity => {\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\tstate.strictlyWorking.includes(entity.privateCode)\n\t\t\t\t\t\t\t|| entity.type !== EntityType.absence\n\t\t\t\t\t\t)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (MonitorModel.prototype.getCommentByEntity(state, entity).trim() === '')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (shortAbsenceTimeRest - entity.time >= 0)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tshortAbsenceTimeRest -= entity.time;\n\n\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\tconst otherCodes = others.map(entity => entity.privateCode);\n\t\t\t\tconst shortAbsenceCodes = shortAbsence.map(entity => entity.privateCode);\n\t\t\t\tconst excludeCodes = otherCodes.concat(shortAbsenceCodes);\n\n\t\t\t\tworkingEntities = workingEntities\n\t\t\t\t\t.filter(entity => !excludeCodes.includes(entity.privateCode))\n\t\t\t\t\t.sort((currentEntity, nextEntity) => nextEntity.time - currentEntity.time);\n\n\t\t\t\tif (Type.isArrayFilled(others))\n\t\t\t\t{\n\t\t\t\t\tworkingEntities.push({\n\t\t\t\t\t\ttype: EntityType.group,\n\t\t\t\t\t\ttitle: EntityGroup.other.title,\n\t\t\t\t\t\ttime: Time.msToSec(state.config.otherTime) - otherTimeRest,\n\t\t\t\t\t\tallowedTime: Time.msToSec(state.config.otherTime),\n\t\t\t\t\t\thint: EntityGroup.other.hint,\n\t\t\t\t\t\tprivateCode: EntityGroup.other.value,\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tif (Type.isArrayFilled(shortAbsence))\n\t\t\t\t{\n\t\t\t\t\tworkingEntities.push({\n\t\t\t\t\t\ttype: EntityType.group,\n\t\t\t\t\t\ttitle: EntityGroup.absence.title,\n\t\t\t\t\t\ttime: shortAbsence.reduce((sum, entity) => sum + entity.time, 0),\n\t\t\t\t\t\tallowedTime: Time.msToSec(state.config.shortAbsenceTime),\n\t\t\t\t\t\thint: EntityGroup.absence.hint,\n\t\t\t\t\t\tprivateCode: EntityGroup.absence.value,\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\treturn workingEntities;\n\t\t\t},\n\t\t\tgetPersonalEntities(state)\n\t\t\t{\n\t\t\t\tlet personalEntities = state.entity.filter(entity => {\n\t\t\t\t\tif (state.personal.includes(entity.privateCode))\n\t\t\t\t\t{\n\t\t\t\t\t\treturn entity;\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\treturn personalEntities\n\t\t\t\t\t.map(entity => {\n\t\t\t\t\t\tconst comment = entity.comments.find(comment => comment.dateLog === state.reportState.dateLog);\n\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t...entity,\n\t\t\t\t\t\t\ttime: Time.calculateInEntityOnADate(state, entity, state.reportState.dateLog),\n\t\t\t\t\t\t\tcomment: comment ? comment.text : '',\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t\t.filter(entity => entity.time > 0)\n\t\t\t\t\t.sort((a, b) => b.time - a.time);\n\t\t\t},\n\t\t\tgetSiteDetailByPrivateCode: state => privateCode => {\n\t\t\t\tconst history = BX.util.objectClone(state.history);\n\n\t\t\t\tlet entries = history.filter(entry => (\n\t\t\t\t\tentry.privateCode === privateCode\n\t\t\t\t\t&& entry.dateLog === state.reportState.dateLog\n\t\t\t\t));\n\n\t\t\t\tentries.map(entry => {\n\t\t\t\t\tentry.time = Time.calculateInEntry(entry);\n\t\t\t\t});\n\n\t\t\t\treturn entries;\n\t\t\t},\n\t\t\tgetChartData(state)\n\t\t\t{\n\t\t\t\tlet segments = [];\n\n\t\t\t\tconst reportDate = new Date(state.reportState.dateLog);\n\t\t\t\tconst emptyChart = [{\n\t\t\t\t\tstart: new Date(\n\t\t\t\t\t\treportDate.getFullYear(),\n\t\t\t\t\t\treportDate.getMonth(),\n\t\t\t\t\t\treportDate.getDate(),\n\t\t\t\t\t\t0,\n\t\t\t\t\t\t0\n\t\t\t\t\t),\n\t\t\t\t\tfinish: new Date(\n\t\t\t\t\t\treportDate.getFullYear(),\n\t\t\t\t\t\treportDate.getMonth(),\n\t\t\t\t\t\treportDate.getDate(),\n\t\t\t\t\t\t23,\n\t\t\t\t\t\t59\n\t\t\t\t\t),\n\t\t\t\t\ttype: EntityGroup.inactive.value,\n\t\t\t\t\tclickable: true,\n\t\t\t\t\tclickableHint: Loc.getMessage('TIMEMAN_PWT_REPORT_INTERVAL_CLICKABLE_HINT'),\n\t\t\t\t\tstretchable: true,\n\t\t\t\t}];\n\n\t\t\t\tif (!Type.isArrayFilled(state.history))\n\t\t\t\t{\n\t\t\t\t\treturn emptyChart;\n\t\t\t\t}\n\n\t\t\t\tlet history = state.history.filter(entry => entry.dateLog === state.reportState.dateLog);\n\t\t\t\tconst minute = 60000;\n\n\t\t\t\t//collecting real intervals\n\t\t\t\thistory.forEach(entry => {\n\t\t\t\t\tlet type;\n\t\t\t\t\tif (state.personal.includes(entry.privateCode))\n\t\t\t\t\t{\n\t\t\t\t\t\ttype = EntityGroup.personal.value;\n\t\t\t\t\t}\n\t\t\t\t\telse if (entry.type === EntityType.custom)\n\t\t\t\t\t{\n\t\t\t\t\t\ttype = EntityGroup.workingCustom.value;\n\t\t\t\t\t}\n\t\t\t\t\telse if (entry.type === EntityType.absence)\n\t\t\t\t\t{\n\t\t\t\t\t\tconst entity = state.entity.find(entity => entity.privateCode === entry.privateCode);\n\t\t\t\t\t\tconst comment = MonitorModel.prototype.getCommentByEntity(state, entity);\n\n\t\t\t\t\t\ttype = comment ? EntityGroup.workingCustom.value : EntityGroup.working.value;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\ttype = EntityGroup.working.value;\n\t\t\t\t\t}\n\n\t\t\t\t\tentry.time.forEach(interval => {\n\t\t\t\t\t\tconst start = new Date(interval.start);\n\t\t\t\t\t\tconst finish = interval.finish ? new Date(interval.finish) : new Date();\n\n\t\t\t\t\t\tsegments.push({ type, start, finish });\n\t\t\t\t\t})\n\t\t\t\t});\n\n\t\t\t\tif (!Type.isArrayFilled(segments))\n\t\t\t\t{\n\t\t\t\t\treturn emptyChart;\n\t\t\t\t}\n\n\t\t\t\tsegments = segments\n\t\t\t\t\t.sort((currentSegment, nextSegment) => currentSegment.start - nextSegment.start)\n\t\t\t\t;\n\n\t\t\t\t//fill the voids with inactive intervals\n\n\t\t\t\t//create the leftmost interval\n\t\t\t\tlet firstSegmentFrom = segments[0].start;\n\t\t\t\tif (firstSegmentFrom.getHours() + firstSegmentFrom.getMinutes() > 0)\n\t\t\t\t{\n\t\t\t\t\tsegments.unshift({\n\t\t\t\t\t\tstart: new Date(\n\t\t\t\t\t\t\tfirstSegmentFrom.getFullYear(),\n\t\t\t\t\t\t\tfirstSegmentFrom.getMonth(),\n\t\t\t\t\t\t\tfirstSegmentFrom.getDate(),\n\t\t\t\t\t\t\t0,\n\t\t\t\t\t\t\t0\n\t\t\t\t\t\t),\n\t\t\t\t\t\tfinish: firstSegmentFrom,\n\t\t\t\t\t\ttype: EntityGroup.inactive.value,\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\t//create inactive intervals throughout the day\n\t\t\t\tsegments\n\t\t\t\t\t.forEach((interval, index) => {\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\tindex > 0\n\t\t\t\t\t\t\t&& interval.start - segments[index - 1].finish >= minute * 3\n\t\t\t\t\t\t)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst start = segments[index - 1].finish;\n\t\t\t\t\t\t\tconst finish = interval.start;\n\n\t\t\t\t\t\t\tstart.setMinutes(start.getMinutes() + 1);\n\t\t\t\t\t\t\tfinish.setMinutes(finish.getMinutes() - 1);\n\n\t\t\t\t\t\t\tsegments.push({\n\t\t\t\t\t\t\t\tstart,\n\t\t\t\t\t\t\t\tfinish,\n\t\t\t\t\t\t\t\ttype: EntityGroup.inactive.value,\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t;\n\n\t\t\t\tsegments = segments\n\t\t\t\t\t.sort((currentSegment, nextSegment) => currentSegment.start - nextSegment.start)\n\t\t\t\t;\n\n\t\t\t\t//create the rightmost interval\n\t\t\t\tlet lastSegmentTo = segments[segments.length - 1].finish;\n\t\t\t\tif (lastSegmentTo.getHours() + lastSegmentTo.getMinutes() < 82)\n\t\t\t\t{\n\t\t\t\t\tlastSegmentTo.setMinutes(lastSegmentTo.getMinutes() + 1);\n\n\t\t\t\t\tsegments.push({\n\t\t\t\t\t\tstart: lastSegmentTo,\n\t\t\t\t\t\tfinish: new Date(\n\t\t\t\t\t\t\tlastSegmentTo.getFullYear(),\n\t\t\t\t\t\t\tlastSegmentTo.getMonth(),\n\t\t\t\t\t\t\tlastSegmentTo.getDate(),\n\t\t\t\t\t\t\t23,\n\t\t\t\t\t\t\t59\n\t\t\t\t\t\t),\n\t\t\t\t\t\ttype: EntityGroup.inactive.value,\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\t//collapse intervals shorter than a minute\n\t\t\t\tsegments = segments.filter(interval => interval.finish - interval.start >= minute);\n\n\t\t\t\tlet chartData = [];\n\t\t\t\tlet lastSegmentType = null;\n\n\t\t\t\t//create data for the graph from intervals\n\t\t\t\tsegments\n\t\t\t\t\t.forEach((segment, index) => {\n\t\t\t\t\t\tif (index > 0 && segment.type !== EntityGroup.inactive.value)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tchartData[chartData.length - 1].finish = segment.start;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (segment.type !== lastSegmentType)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlastSegmentType = segment.type;\n\n\t\t\t\t\t\t\tchartData.push({\n\t\t\t\t\t\t\t\tstart: segment.start,\n\t\t\t\t\t\t\t\tfinish: segment.finish,\n\t\t\t\t\t\t\t\ttype: segment.type,\n\t\t\t\t\t\t\t\tclickable: (\n\t\t\t\t\t\t\t\t\tsegment.type === EntityGroup.inactive.value\n\t\t\t\t\t\t\t\t\t&& segment.start < new Date()\n\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\tclickableHint: segment.type === EntityGroup.inactive.value\n\t\t\t\t\t\t\t\t\t? Loc.getMessage('TIMEMAN_PWT_REPORT_INTERVAL_CLICKABLE_HINT')\n\t\t\t\t\t\t\t\t\t: '',\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (segment.type !== EntityGroup.inactive.value)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tchartData[chartData.length - 1].finish = segment.finish;\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t;\n\n\t\t\t\treturn chartData;\n\t\t\t},\n\t\t\tgetOverChartData: state => selectedPrivateCode => {\n\t\t\t\tlet selectedCodes = [];\n\n\t\t\t\tlet workingEntities = [];\n\t\t\t\tif (\n\t\t\t\t\tselectedPrivateCode === EntityGroup.other.value\n\t\t\t\t\t|| selectedPrivateCode === EntityGroup.absence.value\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tworkingEntities = state.entity\n\t\t\t\t\t\t.filter(entity => {\n\t\t\t\t\t\t\tif (!state.personal.includes(entity.privateCode))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\treturn entity;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.map(entity => {\n\t\t\t\t\t\t\tconst workingEntity = {\n\t\t\t\t\t\t\t\t...entity,\n\t\t\t\t\t\t\t\ttime: Time.calculateInEntityOnADate(state, entity, state.reportState.dateLog),\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (workingEntity.type === EntityType.unknown)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tworkingEntity.hint = EntityGroup.unknown.hint;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\treturn workingEntity;\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.filter(entity => entity.time > 0);\n\t\t\t\t}\n\n\t\t\t\tif (selectedPrivateCode === EntityGroup.other.value)\n\t\t\t\t{\n\t\t\t\t\tlet otherTimeRest = Time.msToSec(state.config.otherTime);\n\t\t\t\t\tconst others = workingEntities\n\t\t\t\t\t\t.sort((currentEntity, nextEntity) => currentEntity.time - nextEntity.time)\n\t\t\t\t\t\t.filter(entity => {\n\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\tstate.strictlyWorking.includes(entity.privateCode)\n\t\t\t\t\t\t\t\t|| entity.type === EntityType.absence\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (otherTimeRest - entity.time >= 0)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\totherTimeRest -= entity.time;\n\n\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\n\t\t\t\t\tothers.forEach(entity => selectedCodes.push(entity.privateCode));\n\t\t\t\t}\n\t\t\t\telse if (selectedPrivateCode === EntityGroup.absence.value)\n\t\t\t\t{\n\t\t\t\t\tlet shortAbsenceTimeRest = Time.msToSec(state.config.shortAbsenceTime);\n\n\t\t\t\t\tconst shortAbsence = workingEntities\n\t\t\t\t\t\t.sort((currentEntity, nextEntity) => currentEntity.time - nextEntity.time)\n\t\t\t\t\t\t.filter(entity => {\n\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\tstate.strictlyWorking.includes(entity.privateCode)\n\t\t\t\t\t\t\t\t|| entity.type !== EntityType.absence\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (MonitorModel.prototype.getCommentByEntity(state, entity).trim() === '')\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tif (shortAbsenceTimeRest - entity.time >= 0)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tshortAbsenceTimeRest -= entity.time;\n\n\t\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\n\t\t\t\t\tshortAbsence.forEach(entity => selectedCodes.push(entity.privateCode));\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tselectedCodes = [selectedPrivateCode];\n\t\t\t\t}\n\n\t\t\t\tlet segments = [];\n\n\t\t\t\tlet history = BX.util.objectClone(state.history).filter(entry => entry.dateLog === state.reportState.dateLog);\n\t\t\t\tconst minute = 60000;\n\n\t\t\t\t//collecting real intervals\n\t\t\t\thistory.forEach(entry => {\n\t\t\t\t\tconst type = state.personal.includes(entry.privateCode)\n\t\t\t\t\t\t? EntityGroup.personal.value\n\t\t\t\t\t\t: EntityGroup.working.value\n\t\t\t\t\t;\n\n\t\t\t\t\tentry.display = (selectedCodes.includes(entry.privateCode) ? 'selected' : 'transparent');\n\n\t\t\t\t\tentry.time.forEach(interval => {\n\t\t\t\t\t\tconst start = new Date(interval.start);\n\t\t\t\t\t\tconst finish = interval.finish ? new Date(interval.finish) : new Date();\n\n\t\t\t\t\t\tsegments.push({ type, start, finish, display: entry.display });\n\t\t\t\t\t})\n\t\t\t\t});\n\n\t\t\t\tsegments = segments\n\t\t\t\t\t.sort((currentSegment, nextSegment) => currentSegment.start - nextSegment.start)\n\t\t\t\t;\n\n\t\t\t\t//create the leftmost interval\n\t\t\t\tlet firstSegmentFrom = segments[0].start;\n\t\t\t\tif (firstSegmentFrom.getHours() + firstSegmentFrom.getMinutes() > 0)\n\t\t\t\t{\n\t\t\t\t\tsegments.unshift({\n\t\t\t\t\t\tstart: new Date(\n\t\t\t\t\t\t\tfirstSegmentFrom.getFullYear(),\n\t\t\t\t\t\t\tfirstSegmentFrom.getMonth(),\n\t\t\t\t\t\t\tfirstSegmentFrom.getDate(),\n\t\t\t\t\t\t\t0,\n\t\t\t\t\t\t\t0\n\t\t\t\t\t\t),\n\t\t\t\t\t\tfinish: firstSegmentFrom,\n\t\t\t\t\t\ttype: EntityGroup.inactive.value,\n\t\t\t\t\t\tdisplay: 'transparent',\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\t//create inactive intervals throughout the day\n\t\t\t\tsegments\n\t\t\t\t\t.forEach((interval, index) => {\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\tindex > 0\n\t\t\t\t\t\t\t&& interval.start - segments[index - 1].finish >= minute * 3\n\t\t\t\t\t\t)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst start = segments[index - 1].finish;\n\t\t\t\t\t\t\tconst finish = interval.start;\n\n\t\t\t\t\t\t\tstart.setMinutes(start.getMinutes() + 1);\n\t\t\t\t\t\t\tfinish.setMinutes(finish.getMinutes() - 1);\n\n\t\t\t\t\t\t\tsegments.push({\n\t\t\t\t\t\t\t\tstart,\n\t\t\t\t\t\t\t\tfinish,\n\t\t\t\t\t\t\t\ttype: EntityGroup.inactive.value,\n\t\t\t\t\t\t\t\tdisplay: 'transparent',\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t;\n\n\t\t\t\tsegments = segments\n\t\t\t\t\t.sort((currentSegment, nextSegment) => currentSegment.start - nextSegment.start)\n\t\t\t\t;\n\n\t\t\t\t//create the rightmost interval\n\t\t\t\tlet lastSegmentTo = segments[segments.length - 1].finish;\n\t\t\t\tif (lastSegmentTo.getHours() + lastSegmentTo.getMinutes() < 82)\n\t\t\t\t{\n\t\t\t\t\tlastSegmentTo.setMinutes(lastSegmentTo.getMinutes() + 1);\n\n\t\t\t\t\tsegments.push({\n\t\t\t\t\t\tstart: lastSegmentTo,\n\t\t\t\t\t\tfinish: new Date(\n\t\t\t\t\t\t\tlastSegmentTo.getFullYear(),\n\t\t\t\t\t\t\tlastSegmentTo.getMonth(),\n\t\t\t\t\t\t\tlastSegmentTo.getDate(),\n\t\t\t\t\t\t\t23,\n\t\t\t\t\t\t\t59\n\t\t\t\t\t\t),\n\t\t\t\t\t\ttype: EntityGroup.inactive.value,\n\t\t\t\t\t\tdisplay: 'transparent',\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\treturn segments;\n\t\t\t},\n\t\t\tisHistorySent(state)\n\t\t\t{\n\t\t\t\tlet lastSuccessfulSendDate = state.config.lastSuccessfulSendDate;\n\n\t\t\t\tlet hasUnsentHistory = (\n\t\t\t\t\tType.isArrayFilled(state.history)\n\t\t\t\t\t&& new Date(state.history[0].dateLog) < new Date(MonitorModel.prototype.getDateLog())\n\t\t\t\t);\n\n\t\t\t\tif (!lastSuccessfulSendDate)\n\t\t\t\t{\n\t\t\t\t\treturn !hasUnsentHistory;\n\t\t\t\t}\n\n\t\t\t\tlastSuccessfulSendDate = new Date(lastSuccessfulSendDate);\n\t\t\t\tlastSuccessfulSendDate.setHours(0);\n\t\t\t\tlastSuccessfulSendDate.setMinutes(0);\n\t\t\t\tlastSuccessfulSendDate.setSeconds(0);\n\t\t\t\tlastSuccessfulSendDate.setMilliseconds(0);\n\n\t\t\t\tlet currentDate = new Date();\n\t\t\t\tcurrentDate.setHours(0);\n\t\t\t\tcurrentDate.setMinutes(0);\n\t\t\t\tcurrentDate.setSeconds(0);\n\t\t\t\tcurrentDate.setMilliseconds(0);\n\n\t\t\t\treturn currentDate - lastSuccessfulSendDate <= 86400000\n\t\t\t\t\t|| !hasUnsentHistory;\n\t\t\t},\n\t\t\tgetWorkingTimeForToday(state)\n\t\t\t{\n\t\t\t\tlet workingEntities = state.entity.filter(entity => {\n\t\t\t\t\tif (!state.personal.includes(entity.privateCode))\n\t\t\t\t\t{\n\t\t\t\t\t\treturn entity;\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\treturn workingEntities\n\t\t\t\t\t.map(entity => {\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t...entity,\n\t\t\t\t\t\t\ttime: Time.calculateInEntityOnADate(state, entity, MonitorModel.prototype.getDateLog()),\n\t\t\t\t\t\t};\n\t\t\t\t\t})\n\t\t\t\t\t.reduce((sum, entity) => sum + entity.time, 0);\n\t\t\t},\n\t\t\tgetReportComment(state)\n\t\t\t{\n\t\t\t\tlet reportComment = state.reportState.comments\n\t\t\t\t\t.find(comment => comment.dateLog === state.reportState.dateLog);\n\n\t\t\t\treturn reportComment ? reportComment.text : '';\n\t\t\t},\n\t\t\thasActivityOtherThanBitrix24(state)\n\t\t\t{\n\t\t\t\tlet hasActivity = false;\n\n\t\t\t\tlet appSiteEntities = state.entity\n\t\t\t\t\t.filter(entity => entity.type === EntityType.app || entity.type === EntityType.site);\n\n\t\t\t\tif (Type.isArrayFilled(appSiteEntities) && appSiteEntities.length > 1)\n\t\t\t\t{\n\t\t\t\t\thasActivity = true;\n\t\t\t\t}\n\n\t\t\t\treturn hasActivity;\n\t\t\t},\n\t\t}\n\t}\n\n\tvalidatePersonal(personal = '')\n\t{\n\t\tlet result = '';\n\n\t\tif (personal && (Type.isString(personal) || Type.isNumber(personal)))\n\t\t{\n\t\t\tresult = personal.toString();\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tvalidateEntity(entity = {})\n\t{\n\t\tlet result = {};\n\n\t\tif (Type.isObject(entity) && entity)\n\t\t{\n\t\t\tif (Type.isString(entity.type))\n\t\t\t{\n\t\t\t\tresult.type = entity.type;\n\t\t\t}\n\n\t\t\tif (Type.isString(entity.title) || Type.isNumber(entity.title))\n\t\t\t{\n\t\t\t\tresult.title = entity.title.toString();\n\t\t\t}\n\n\t\t\tif (Type.isArrayFilled(entity.comments))\n\t\t\t{\n\t\t\t\tresult.comments = entity.comments;\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tvalidateHistory(historyEntry= {})\n\t{\n\t\tlet result = {};\n\n\t\tif (Type.isObject(historyEntry) && historyEntry)\n\t\t{\n\t\t\tif (\n\t\t\t\tType.isString(historyEntry.dateLog)\n\t\t\t\t&& Type.isDate(new Date(historyEntry.dateLog))\n\t\t\t\t&& !isNaN(new Date(historyEntry.dateLog))\n\t\t\t)\n\t\t\t{\n\t\t\t\tresult.dateLog = historyEntry.dateLog;\n\t\t\t}\n\n\t\t\tif (Type.isString(historyEntry.title) || Type.isNumber(historyEntry.title))\n\t\t\t{\n\t\t\t\tresult.title = historyEntry.title.toString();\n\t\t\t}\n\n\t\t\tif (Type.isString(historyEntry.type) && EntityType.hasOwnProperty(historyEntry.type))\n\t\t\t{\n\t\t\t\tresult.type = historyEntry.type;\n\n\t\t\t\tif (historyEntry.type === EntityType.site)\n\t\t\t\t{\n\t\t\t\t\tresult.siteUrl = historyEntry.siteUrl;\n\t\t\t\t\tresult.siteTitle = historyEntry.siteTitle.toString();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (Type.isArrayFilled(historyEntry.time))\n\t\t\t{\n\t\t\t\tresult.time = historyEntry.time;\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tvalidateSentQueue(sentQueueItem = {})\n\t{\n\t\tlet result = {};\n\n\t\tif (Type.isObject(sentQueueItem) && sentQueueItem)\n\t\t{\n\t\t\tif (Type.isString(sentQueueItem.dateLog))\n\t\t\t{\n\t\t\t\tresult.dateLog = sentQueueItem.dateLog;\n\t\t\t}\n\n\t\t\tif (Type.isArrayFilled(sentQueueItem.historyPackage))\n\t\t\t{\n\t\t\t\tresult.historyPackage = sentQueueItem.historyPackage;\n\t\t\t}\n\n\t\t\tif (Type.isArrayFilled(sentQueueItem.chartPackage))\n\t\t\t{\n\t\t\t\tresult.chartPackage = sentQueueItem.chartPackage;\n\t\t\t}\n\n\t\t\tif (Type.isString(sentQueueItem.desktopCode))\n\t\t\t{\n\t\t\t\tresult.desktopCode = sentQueueItem.desktopCode;\n\t\t\t}\n\n\t\t\tif (Type.isString(sentQueueItem.comment))\n\t\t\t{\n\t\t\t\tresult.comment = sentQueueItem.comment;\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tgetHistoryEntryByPrivateCode(store, privateCode)\n\t{\n\t\treturn store.state.history.find(entry => (\n\t\t\tentry.privateCode === privateCode\n\t\t\t&& entry.dateLog === this.getDateLog()\n\t\t));\n\t}\n\n\tgetHistoryEntryBySiteUrl(store, siteUrl)\n\t{\n\t\treturn store.state.history.find(entry => (\n\t\t\tentry.siteUrl === siteUrl\n\t\t\t&& entry.dateLog === this.getDateLog()\n\t\t));\n\t}\n\n\tgetEntityByPrivateCode(store, privateCode)\n\t{\n\t\treturn store.state.entity.find(entity => entity.privateCode === privateCode);\n\t}\n\n\tgetEntityByTitle(store, title)\n\t{\n\t\treturn store.state.entity.find(entity => entity.title === title);\n\t}\n\n\tgetCommentByEntity(state, entity)\n\t{\n\t\tconst comment = entity.comments.find(comment => comment.dateLog === state.reportState.dateLog);\n\n\t\treturn comment ? comment.text : '';\n\t}\n\n\tgetDateLog()\n\t{\n\t\treturn this.formatDateLog(new Date());\n\t}\n\n\tformatDateLog(date)\n\t{\n\t\tconst addZero = num => (num >= 0 && num <= 9) ? '0' + num : num;\n\n\t\tconst year = date.getFullYear();\n\t\tconst month = addZero(date.getMonth() + 1);\n\t\tconst day = addZero(date.getDate());\n\n\t\treturn year + '-' + month + '-' + day;\n\t}\n\n\tcollectSentQueue(store)\n\t{\n\t\tlet history = BX.util.objectClone(this.getGetters().getWorkingEntities(store.state));\n\n\t\thistory = history.map(entry => {\n\t\t\tif (\n\t\t\t\tentry.type === EntityType.group\n\t\t\t\t&& entry.title === EntityGroup.other.title\n\t\t\t)\n\t\t\t{\n\t\t\t\tentry.type = EntityType.other;\n\t\t\t\tentry.publicCode = Code.createPublic(EntityType.other);\n\t\t\t\tentry.privateCode = Code.createPrivate(EntityType.other);\n\n\t\t\t\tdelete entry.items;\n\t\t\t}\n\t\t\telse if (\n\t\t\t\tentry.type === EntityType.group\n\t\t\t\t&& entry.title === EntityGroup.absence.title\n\t\t\t)\n\t\t\t{\n\t\t\t\tentry.type = EntityType.absenceShort;\n\t\t\t\tentry.publicCode = Code.createPublic(EntityType.absenceShort);\n\t\t\t\tentry.privateCode = Code.createPrivate(EntityType.absenceShort);\n\n\t\t\t\tdelete entry.items;\n\t\t\t}\n\t\t\telse if (entry.type === EntityType.absence)\n\t\t\t{\n\t\t\t\tif (entry.extra.hasOwnProperty('timeStart'))\n\t\t\t\t{\n\t\t\t\t\tentry.timeStart = entry.extra.timeStart;\n\t\t\t\t}\n\n\t\t\t\tentry.title = Loc.getMessage('TIMEMAN_PWT_REPORT_ABSENCE');\n\t\t\t\tentry.publicCode = Code.createPublic(EntityType.absence);\n\t\t\t\tentry.privateCode = Code.createPrivate(EntityType.absence);\n\t\t\t}\n\n\t\t\tdelete entry.extra;\n\t\t\tdelete entry.hint;\n\n\t\t\treturn entry;\n\t\t});\n\n\t\tLogger.log('History to send:', history);\n\t\tDebug.space();\n\t\tDebug.log('History to send:', history);\n\n\t\tlet chart = this.getGetters().getChartData(store.state).map(interval => {\n\t\t\treturn {\n\t\t\t\ttype: interval.type,\n\t\t\t\tstart: interval.start,\n\t\t\t\tfinish: interval.finish,\n\t\t\t}\n\t\t});\n\n\t\tLogger.log('ChartData to send:', chart);\n\n\t\treturn {\n\t\t\thistory,\n\t\t\tchart,\n\t\t};\n\t}\n}\n","import {EntityType} from 'timeman.const';\nimport {Logger} from '../lib/logger';\nimport {Debug} from '../lib/debug';\nimport {Loc} from 'main.core';\n\nexport class Entity\n{\n\tconstructor(params = {})\n\t{\n\t\tswitch (params.type)\n\t\t{\n\t\t\tcase EntityType.site:\n\t\t\t\tthis.createSite(params);\n\t\t\t\tbreak;\n\n\t\t\tcase EntityType.app:\n\t\t\t\tthis.createApp(params);\n\t\t\t\tbreak;\n\n\t\t\tcase EntityType.absence:\n\t\t\t\tthis.createAbsence();\n\t\t\t\tbreak;\n\n\t\t\tcase EntityType.unknown:\n\t\t\t\tthis.createUnknown(params);\n\t\t\t\tbreak;\n\n\t\t\tcase EntityType.incognito:\n\t\t\t\tthis.createIncognito();\n\t\t\t\tbreak;\n\t\t}\n\n\t\tLogger.log('Caught:', this);\n\t\tDebug.log('Caught:', this);\n\t}\n\n\tcreateSite(params)\n\t{\n\t\tthis.type = EntityType.site;\n\n\t\tlet host;\n\t\ttry\n\t\t{\n\t\t\thost = new URL(params.url).host;\n\t\t}\n\t\tcatch (err)\n\t\t{\n\t\t\thost = params.url;\n\t\t}\n\n\t\tif (host === '')\n\t\t{\n\t\t\tlet hostFragments = params.url.split('/');\n\n\t\t\thost = hostFragments[hostFragments.length - 1] !== ''\n\t\t\t\t? hostFragments[hostFragments.length - 1]\n\t\t\t\t: params.url;\n\t\t}\n\t\telse if (host.split('.')[0] === 'www')\n\t\t{\n\t\t\thost = host.substring(4);\n\t\t}\n\n\t\tthis.title = host.toString();\n\t\tthis.siteUrl = params.url.toString();\n\t\tthis.siteTitle = params.title.toString();\n\t}\n\n\tcreateApp(params)\n\t{\n\t\tthis.type = EntityType.app;\n\t\tthis.title = params.name.toString();\n\n\t\tif (params.isBitrix24Desktop)\n\t\t{\n\t\t\tthis.isBitrix24Desktop = params.isBitrix24Desktop;\n\t\t}\n\t}\n\n\tcreateAbsence()\n\t{\n\t\tthis.type = EntityType.absence;\n\t\tthis.title = Loc.getMessage('TIMEMAN_PWT_REPORT_ABSENCE');\n\t}\n\n\tcreateUnknown(params)\n\t{\n\t\tthis.type = EntityType.unknown;\n\t\tthis.title = Loc.getMessage('TIMEMAN_PWT_REPORT_UNKNOWN');\n\n\t\tthis.pureName = params.name;\n\t\tthis.pureTitle = params.title;\n\t}\n\n\tcreateIncognito()\n\t{\n\t\tthis.type = EntityType.incognito;\n\t\tthis.title = Loc.getMessage('TIMEMAN_PWT_REPORT_INCOGNITO');\n\t}\n}","import {Logger} from './lib/logger';\nimport {Debug} from \"./lib/debug\";\nimport {Entity} from './model/entity';\nimport {EntityType} from 'timeman.const';\nimport {Loc} from 'main.core';\n\nclass EventHandler\n{\n\tinit(store)\n\t{\n\t\tthis.enabled = false;\n\t\tthis.store = store;\n\n\t\tthis.preFinishInterval = null;\n\n\t\tthis.lastCaught = {\n\t\t\tname: null,\n\t\t\turl: null\n\t\t}\n\t}\n\n\tcatch(process, name, title, url)\n\t{\n\t\tif (!this.enabled || !process)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst type = this.getEntityTypeByEvent({process, name, title, url});\n\n\t\tlet isBitrix24Desktop = false;\n\t\tif (type === EntityType.app)\n\t\t{\n\t\t\tif (['Bitrix24.exe', 'Bitrix24'].includes(this.getNameByProcess(process)))\n\t\t\t{\n\t\t\t\tisBitrix24Desktop = true;\n\t\t\t}\n\t\t}\n\n\t\tif (type !== EntityType.absence)\n\t\t{\n\t\t\tif (type === EntityType.app)\n\t\t\t{\n\t\t\t\tswitch (name)\n\t\t\t\t{\n\t\t\t\t\tcase 'Application Frame Host':\n\t\t\t\t\t\tname = title\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'StartMenuExperienceHost':\n\t\t\t\t\tcase 'Search application':\n\t\t\t\t\t\tname = Loc.getMessage('TIMEMAN_PWT_WINDOWS_START_ALIAS');\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'Windows Shell Experience Host':\n\t\t\t\t\t\tname = Loc.getMessage('TIMEMAN_PWT_WINDOWS_NOTIFICATIONS_ALIAS');\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (name === '')\n\t\t\t{\n\t\t\t\tname = this.getNameByProcess(process);\n\t\t\t}\n\n\t\t\tif (!this.isNewEvent(name, url))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.lastCaught = {\n\t\t\t\tname,\n\t\t\t\turl\n\t\t\t};\n\t\t}\n\n\t\tthis.store.dispatch('monitor/addHistory', new Entity({type, name, title, url, isBitrix24Desktop}));\n\t}\n\n\tcatchAbsence(away)\n\t{\n\t\tif (away)\n\t\t{\n\t\t\tthis.store.dispatch(\n\t\t\t\t'monitor/addHistory',\n\t\t\t\tnew Entity({\n\t\t\t\t\ttype: EntityType.absence\n\t\t\t\t})\n\t\t\t);\n\n\t\t\tthis.lastCaught = {\n\t\t\t\tname: EntityType.absence,\n\t\t\t\turl: null\n\t\t\t};\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (this.isWorkingDayStarted() && this.isTrackerGetActiveAppAvailable())\n\t\t\t{\n\t\t\t\tBXDesktopSystem.TrackerGetActiveApp();\n\t\t\t}\n\t\t}\n\t}\n\n\tcatchAppClose()\n\t{\n\t\tLogger.warn('Application shutdown recognized. The last interval is finished.');\n\t\tDebug.log('Application shutdown recognized. The last interval is finished.');\n\n\t\tthis.store.dispatch('monitor/finishLastInterval');\n\t}\n\n\tgetEntityTypeByEvent(event)\n\t{\n\t\tlet type = EntityType.unknown;\n\n\t\tif (event.url === 'unknown')\n\t\t{\n\t\t\ttype = EntityType.unknown;\n\t\t}\n\t\telse if (event.url === 'incognito')\n\t\t{\n\t\t\ttype = EntityType.incognito;\n\t\t}\n\t\telse if (event.url)\n\t\t{\n\t\t\ttype = EntityType.site\n\t\t}\n\t\telse if (event.process !== '')\n\t\t{\n\t\t\ttype = EntityType.app\n\t\t}\n\n\t\treturn type;\n\t}\n\n\tgetNameByProcess(process)\n\t{\n\t\tconst separator = (process.includes('/') ? '/' : '\\\\');\n\t\tconst path = process.split(separator);\n\n\t\treturn path[path.length - 1];\n\t}\n\n\tisNewEvent(name, url)\n\t{\n\t\tif (this.url === '')\n\t\t{\n\t\t\tif (this.lastCaught.name === name)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (this.lastCaught.name === name && this.lastCaught.url === url)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tisTrackerGetActiveAppAvailable()\n\t{\n\t\treturn (BX.desktop.getApiVersion() >= 56);\n\t}\n\n\tstart()\n\t{\n\t\tif (this.enabled)\n\t\t{\n\t\t\tLogger.warn('EventHandler already started');\n\t\t\treturn;\n\t\t}\n\n\t\tthis.enabled = true;\n\n\t\tBX.desktop.addCustomEvent(\n\t\t\t'BXUserApp',\n\t\t\t(process, name, title, url) => this.catch(process, name, title, url)\n\t\t);\n\n\t\tBX.desktop.addCustomEvent(\n\t\t\t'BXExitApplication',\n\t\t\tthis.catchAppClose.bind(this)\n\t\t);\n\n\t\tif (this.isTrackerGetActiveAppAvailable())\n\t\t{\n\t\t\tBXDesktopSystem.TrackerGetActiveApp();\n\t\t}\n\n\t\tthis.preFinishInterval = setInterval(\n\t\t\t() => this.store.dispatch('monitor/preFinishLastInterval'),\n\t\t\t60000\n\t\t);\n\n\t\tLogger.log('EventHandler started');\n\t}\n\n\tstop()\n\t{\n\t\tif (!this.enabled)\n\t\t{\n\t\t\tLogger.warn('EventHandler already stopped');\n\t\t\treturn;\n\t\t}\n\n\t\tthis.enabled = false;\n\n\t\tthis.lastCaught = {\n\t\t\tname: null,\n\t\t\turl: null\n\t\t}\n\n\t\tthis.preFinishInterval = null;\n\n\t\tthis.store.dispatch('monitor/finishLastInterval');\n\n\t\tLogger.log('EventHandler stopped');\n\t}\n}\n\nconst eventHandler = new EventHandler();\n\nexport {eventHandler as EventHandler};","import {Loc, Type} from 'main.core';\nimport {Monitor} from './monitor';\nimport {Logger} from './lib/logger';\nimport {Debug} from './lib/debug';\nimport {UI} from 'ui.notification';\n\nclass Sender\n{\n\tinit(store)\n\t{\n\t\tthis.enabled = false;\n\t\tthis.store = store;\n\n\t\tthis.attempt = 0;\n\t\tthis.resendTimeout = 5000;\n\t\tthis.resendTimeoutId = null;\n\t}\n\n\tsend()\n\t{\n\t\tLogger.warn('Trying to send history...');\n\n\t\tBX.ajax.runAction('bitrix:timeman.api.monitor.recordhistory', {\n\t\t\tdata: {\n\t\t\t\thistory: JSON.stringify(this.getSentQueue()),\n\t\t\t}\n\t\t})\n\t\t\t.then(result =>\n\t\t\t{\n\t\t\t\tDebug.log('History sent');\n\n\t\t\t\tif (result.status === 'success')\n\t\t\t\t{\n\t\t\t\t\tLogger.warn('SUCCESS!');\n\n\t\t\t\t\tthis.attempt = 0;\n\n\t\t\t\t\tthis.afterSuccessSend();\n\n\t\t\t\t\tif (result.data.enabled === Monitor.getStatusDisabled())\n\t\t\t\t\t{\n\t\t\t\t\t\tLogger.warn('Disabled after server response');\n\t\t\t\t\t\tDebug.log('Disabled after server response');\n\n\t\t\t\t\t\tMonitor.disable();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tLogger.error('ERROR!');\n\t\t\t\t\tthis.attempt++\n\t\t\t\t\tthis.startSendingTimer();\n\t\t\t\t}\n\t\t\t})\n\t\t\t.catch(() =>\n\t\t\t{\n\t\t\t\tLogger.error('CONNECTION ERROR!');\n\n\t\t\t\tthis.attempt++\n\t\t\t\tthis.startSendingTimer();\n\t\t\t});\n\t}\n\n\tstartSendingTimer()\n\t{\n\t\tthis.resendTimeoutId = setTimeout(this.send.bind(this), this.getSendingDelay());\n\t\tLogger.log(`Next send in ${this.getSendingDelay() / 1000} seconds...`);\n\t}\n\n\tgetSendingDelay()\n\t{\n\t\treturn (this.attempt === 0 ? this.resendTimeout : this.resendTimeout * this.attempt);\n\t}\n\n\tgetSentQueue()\n\t{\n\t\treturn this.store.state.monitor.sentQueue;\n\t}\n\n\tstart()\n\t{\n\t\tif (this.enabled)\n\t\t{\n\t\t\tLogger.warn('Sender already started');\n\t\t\treturn;\n\t\t}\n\n\t\tthis.enabled = true;\n\t\tthis.attempt = 0;\n\n\t\tif (Type.isArrayFilled(this.getSentQueue()))\n\t\t{\n\t\t\tLogger.log('Preparing to send old history...');\n\t\t\tthis.startSendingTimer();\n\t\t}\n\n\t\tLogger.log(\"Sender started\");\n\t}\n\n\tstop()\n\t{\n\t\tif (!this.enabled)\n\t\t{\n\t\t\tLogger.warn('Sender already stopped');\n\t\t\treturn;\n\t\t}\n\n\t\tthis.enabled = false;\n\t\tthis.attempt = 0;\n\n\t\tclearTimeout(this.resendTimeoutId);\n\t\tLogger.log(\"Sender stopped\");\n\t}\n\n\tafterSuccessSend()\n\t{\n\t\tLogger.warn('History sent');\n\t\tDebug.space();\n\t\tDebug.log('History sent');\n\n\t\tthis.store.dispatch(\n\t\t\t'monitor/setLastSuccessfulSendDate',\n\t\t\tnew Date(this.store.state.monitor.reportState.dateLog)\n\t\t)\n\t\t\t.then(() => {\n\t\t\t\tthis.store.dispatch('monitor/clearSentHistory')\n\t\t\t\t\t.then(() => {\n\t\t\t\t\t\tthis.store.dispatch('monitor/refreshDateLog');\n\t\t\t\t\t\tthis.store.dispatch('monitor/clearSentQueue');\n\n\t\t\t\t\t\tBX.SidePanel.Instance.close();\n\n\t\t\t\t\t\tUI.Notification.Center.notify({\n\t\t\t\t\t\t\tcontent: Loc.getMessage('TIMEMAN_PWT_REPORT_NOTIFICATION_REPORT_SENT'),\n\t\t\t\t\t\t\tautoHideDelay: 5000,\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t}\n\t\t);\n\t}\n}\n\nconst sender = new Sender();\n\nexport {sender as Sender};","import {Monitor} from \"../monitor\";\nimport {Logger} from './logger';\nimport {Debug} from './debug';\n\nexport class CommandHandler\n{\n\tconstructor(options = {})\n\t{\n\t}\n\n\tgetModuleId()\n\t{\n\t\treturn 'timeman';\n\t}\n\n\thandleChangeMonitorEnabled(params)\n\t{\n\t\tif (params.enabled === Monitor.getStatusEnabled())\n\t\t{\n\t\t\tLogger.warn('Enabled via API');\n\t\t\tDebug.log('Enabled via API');\n\n\t\t\tlocation.reload();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tMonitor.stop();\n\t\t\tMonitor.disable();\n\n\t\t\tLogger.warn('Disabled via API');\n\t\t\tDebug.log('Disabled via API');\n\t\t}\n\t}\n\n\thandleChangeMonitorDebugEnabled(params)\n\t{\n\t\tif (params.enabled)\n\t\t{\n\t\t\tDebug.enable();\n\n\t\t\tLogger.warn('Debug mode enabled via API');\n\t\t\tDebug.log('Debug mode enabled via API');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tLogger.warn('Debug mode disabled via API');\n\t\t\tDebug.log('Debug mode disabled via API');\n\n\t\t\tDebug.disable();\n\t\t}\n\t}\n}","import {VuexBuilder} from \"ui.vue.vuex\";\nimport {MonitorModel} from './model/monitor';\nimport {EventHandler} from './eventhandler';\nimport {Sender} from './sender';\nimport {MonitorReport} from 'timeman.monitor-report';\nimport {Logger} from './lib/logger';\nimport {Debug} from './lib/debug';\nimport {DateFormatter} from \"timeman.dateformatter\";\nimport {TimeFormatter} from \"timeman.timeformatter\";\n\nimport {PULL as Pull} from 'pull.client';\nimport {CommandHandler} from './lib/commandhandler';\nimport {Loc, Type} from 'main.core';\n\nclass Monitor\n{\n\tinit(options)\n\t{\n\t\tthis.enabled = options.enabled;\n\t\tthis.playTimeout = null;\n\t\tthis.isAway = false;\n\t\tthis.vuex = {};\n\n\t\tthis.defaultStorageConfig = {\n\t\t\tconfig: {\n\t\t\t\totherTime: options.otherTime,\n\t\t\t\tshortAbsenceTime: options.shortAbsenceTime,\n\t\t\t}\n\t\t};\n\n\t\tthis.dateFormat = options.dateFormat;\n\t\tthis.timeFormat = options.timeFormat;\n\n\t\tif (options.debugEnabled)\n\t\t{\n\t\t\tDebug.enable();\n\t\t}\n\n\t\tDebug.space();\n\t\tDebug.log('Desktop launched!');\n\n\t\tif (this.isEnabled() && Logger.isEnabled())\n\t\t{\n\t\t\tBXDesktopSystem.LogInfo = function() {};\n\t\t\tLogger.start();\n\t\t}\n\n\t\tDebug.log(`Enabled: ${this.enabled}`);\n\n\t\tif (this.isEnabled())\n\t\t{\n\t\t\tthis.initApp();\n\t\t}\n\n\t\tPull.subscribe(new CommandHandler());\n\t}\n\n\tinitApp()\n\t{\n\t\tif (!this.isEnabled())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tnew VuexBuilder()\n\t\t\t.addModel(\n\t\t\t\tMonitorModel\n\t\t\t\t\t.create()\n\t\t\t\t\t.setVariables(this.defaultStorageConfig)\n\t\t\t\t\t.useDatabase(true)\n\t\t\t)\n\t\t\t.setDatabaseConfig({\n\t\t\t\tname: 'timeman-pwt',\n\t\t\t\ttype: VuexBuilder.DatabaseType.indexedDb,\n\t\t\t\tsiteId: Loc.getMessage('SITE_ID'),\n\t\t\t\tuserId: Loc.getMessage('USER_ID')\n\t\t\t})\n\t\t\t.build()\n\t\t\t.then(builder => {\n\t\t\t\tthis.vuex.store = builder.store;\n\n\t\t\t\tthis.getStorage().dispatch('monitor/processUnfinishedEvents')\n\t\t\t\t\t.then(() => this.initTracker(this.getStorage()));\n\t\t\t})\n\t\t\t.catch(() => {\n\t\t\t\tconst errorMessage = \"PWT: Storage initialization error\";\n\n\t\t\t\tLogger.error(errorMessage);\n\t\t\t\tDebug.log(errorMessage);\n\t\t\t})\n\t\t;\n\t}\n\n\tinitTracker(store)\n\t{\n\t\tDateFormatter.init(this.dateFormat);\n\t\tTimeFormatter.init(this.timeFormat);\n\n\t\tEventHandler.init(store);\n\t\tSender.init(store);\n\n\t\tBX.desktop.addCustomEvent(\n\t\t\t'BXUserAway',\n\t\t\t(away) => this.onAway(away)\n\t\t);\n\n\t\tBX.MessengerWindow.addTab({\n\t\t\tid: 'timeman-pwt',\n\t\t\ttitle: Loc.getMessage('TIMEMAN_PWT_REPORT_SLIDER_TITLE'),\n\t\t\torder: 540,\n\t\t\ttarget: false,\n\t\t\tevents: {\n\t\t\t\topen: () => this.openReport()\n\t\t\t}\n\t\t});\n\n\t\tBX.desktop.addCustomEvent(\n\t\t\t'BXProtocolUrl',\n\t\t\tcommand => {\n\t\t\t\tif (command === 'timemanpwt')\n\t\t\t\t{\n\t\t\t\t\tif (!BX.MessengerCommon.isDesktop())\n\t\t\t\t\t{\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t\tBX.MessengerWindow.changeTab('timeman-pwt', true);\n\t\t\t\t\tBX.desktop.setActiveWindow();\n\t\t\t\t\tBX.desktop.windowCommand(\"show\");\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\n\t\tif (this.isEnabled())\n\t\t{\n\t\t\tthis.launch();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tLogger.warn('Monitor is disabled');\n\t\t}\n\t}\n\n\tlaunch()\n\t{\n\t\tif (this.isAway)\n\t\t{\n\t\t\tLogger.log('Pause is over, but computer is in sleep mode. Waiting for the return of the user.');\n\t\t\tDebug.log('Pause is over, but computer is in sleep mode. Waiting for the return of the user.');\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this.getStorage().state.monitor.config.grantingPermissionDate)\n\t\t{\n\t\t\tLogger.log('History access not provided. Monitor is not started.');\n\t\t\tDebug.log('History access not provided. Monitor is not started.');\n\n\t\t\tif (this.shouldShowGrantingPermissionWindow())\n\t\t\t{\n\t\t\t\tthis.openReport();\n\t\t\t\tBXDesktopWindow.ExecuteCommand('show.active');\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.getStorage().dispatch('monitor/migrateHistory').then(() => {\n\t\t\tthis.getStorage().dispatch('monitor/clearSentHistory').then(() => {\n\t\t\t\tthis.getStorage().dispatch('monitor/refreshDateLog').then(() => {\n\t\t\t\t\tif (this.isPaused())\n\t\t\t\t\t{\n\t\t\t\t\t\tif (this.isPauseRelevant())\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tLogger.warn(\"Can't start, monitor is paused!\");\n\t\t\t\t\t\t\tDebug.log(\"Can't start, monitor is paused!\");\n\n\t\t\t\t\t\t\tthis.setPlayTimeout();\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis.clearPausedUntil().then(() => this.start());\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.start();\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t}\n\n\tstart()\n\t{\n\t\tif (!this.isEnabled())\n\t\t{\n\t\t\tLogger.warn(\"Can't start, monitor is disabled!\");\n\t\t\tDebug.log(\"Can't start, monitor is disabled!\");\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.isPaused())\n\t\t{\n\t\t\tLogger.warn(\"Can't start, monitor is paused!\");\n\t\t\tDebug.log(\"Can't start, monitor is paused!\");\n\n\t\t\treturn;\n\t\t}\n\n\t\tDebug.log('Monitor started');\n\t\tDebug.space();\n\n\t\tif (this.isTrackerEventsApiAvailable())\n\t\t{\n\t\t\tLogger.log('Events started');\n\t\t\tBXDesktopSystem.TrackerStart();\n\t\t}\n\n\t\tEventHandler.start();\n\t\tSender.start();\n\n\t\tLogger.warn('Monitor started');\n\t}\n\n\tstop()\n\t{\n\t\tif (this.isTrackerEventsApiAvailable())\n\t\t{\n\t\t\tLogger.log('Events stopped');\n\t\t\tBXDesktopSystem.TrackerStop();\n\t\t}\n\n\t\tEventHandler.stop();\n\t\tSender.stop();\n\n\t\tLogger.warn('Monitor stopped');\n\t\tDebug.log('Monitor stopped');\n\t}\n\n\tpause()\n\t{\n\t\tthis.stop();\n\t\tthis.setPlayTimeout();\n\t}\n\n\tonAway(away)\n\t{\n\t\tif (!this.isEnabled() || this.isPaused())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (away && !this.isAway)\n\t\t{\n\t\t\tthis.isAway = true;\n\n\t\t\tLogger.warn('User AWAY');\n\t\t\tDebug.space();\n\t\t\tDebug.log('User AWAY');\n\n\t\t\tthis.stop();\n\n\t\t\tEventHandler.catchAbsence(away);\n\t\t}\n\t\telse if (!away && this.isAway)\n\t\t{\n\t\t\tthis.isAway = false;\n\n\t\t\tLogger.warn('User RETURNED, continue monitoring...');\n\t\t\tDebug.space();\n\t\t\tDebug.log('User RETURNED, continue monitoring...');\n\n\t\t\tthis.launch();\n\t\t}\n\t}\n\n\tsend()\n\t{\n\t\tif (!this.vuex.hasOwnProperty('store'))\n\t\t{\n\t\t\tLogger.warn('Unable to send report. Store is not initialized.');\n\t\t\tDebug.log('Unable to send report. Store is not initialized.');\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.getStorage().dispatch('monitor/createSentQueue').then(() => Sender.send());\n\t}\n\n\topenReport()\n\t{\n\t\tif (!this.isEnabled())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tMonitorReport.open(this.getStorage());\n\t}\n\n\topenReportPreview()\n\t{\n\t\tif (!this.isEnabled())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tMonitorReport.openPreview(this.getStorage());\n\t}\n\n\tgetPausedUntilTime()\n\t{\n\t\treturn this.getStorage().state.monitor.config.pausedUntil;\n\t}\n\n\tclearPausedUntil()\n\t{\n\t\treturn this.getStorage().dispatch('monitor/clearPausedUntil');\n\t}\n\n\tisPaused()\n\t{\n\t\treturn !!this.getPausedUntilTime();\n\t}\n\n\tisPauseRelevant()\n\t{\n\t\treturn this.getPausedUntilTime() - new Date() > 0;\n\t}\n\n\tsetPlayTimeout()\n\t{\n\t\tLogger.warn(`Monitor will be turned on at ${this.getPausedUntilTime().toString()}`);\n\t\tDebug.log(`Monitor will be turned on at ${this.getPausedUntilTime().toString()}`);\n\n\t\tclearTimeout(this.playTimeout);\n\n\t\tthis.playTimeout = setTimeout(\n\t\t\t() => this.clearPausedUntil().then(() => this.launch()),\n\t\t\tthis.getPausedUntilTime() - new Date()\n\t\t);\n\t}\n\n\tpauseUntil(dateTime: Date)\n\t{\n\t\tif (\n\t\t\tType.isDate(dateTime)\n\t\t\t&& Type.isNumber(dateTime.getTime())\n\t\t\t&& dateTime > new Date()\n\t\t)\n\t\t{\n\t\t\tthis.getStorage().dispatch('monitor/setPausedUntil', dateTime).then(() => this.pause());\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthrow Error('Pause must be set as a date in the future');\n\t\t}\n\t}\n\n\tshouldShowGrantingPermissionWindow()\n\t{\n\t\tlet config = this.getStorage().state.monitor.config;\n\t\tif (!config)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tif (config.grantingPermissionDate !== null)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tlet deferredGrantingPermissionShowDate = config.deferredGrantingPermissionShowDate;\n\t\tif (deferredGrantingPermissionShowDate === null)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\treturn new Date(MonitorModel.prototype.getDateLog()) >= new Date(deferredGrantingPermissionShowDate);\n\t}\n\n\tshowGrantingPermissionLater()\n\t{\n\t\treturn this.getStorage().dispatch('monitor/showGrantingPermissionLater');\n\t}\n\n\tplay()\n\t{\n\t\tclearTimeout(this.playTimeout);\n\t\tthis.playTimeout = null;\n\t\tthis.clearPausedUntil().then(() => this.launch());\n\t}\n\n\tisEnabled()\n\t{\n\t\treturn (this.enabled === this.getStatusEnabled())\n\t}\n\n\tenable()\n\t{\n\t\tthis.enabled = this.getStatusEnabled();\n\t}\n\n\tdisable()\n\t{\n\t\tthis.stop();\n\n\t\tBX.MessengerWindow.hideTab('timeman-pwt');\n\t\tthis.vuex = {};\n\n\t\tthis.enabled = this.getStatusDisabled();\n\t}\n\n\tgetStatusEnabled()\n\t{\n\t\treturn 'Y';\n\t}\n\n\tgetStatusDisabled()\n\t{\n\t\treturn 'N';\n\t}\n\n\tisTrackerEventsApiAvailable()\n\t{\n\t\treturn (BX.desktop.getApiVersion() >= 55);\n\t}\n\n\tgetStorage()\n\t{\n\t\treturn (this.vuex.hasOwnProperty('store') ? this.vuex.store : null);\n\t}\n}\n\nconst monitor = new Monitor();\n\nexport {monitor as Monitor};\n"],"names":["Code","params","md5","join","sha1","BXDesktopSystem","createPrivate","UserAccount","UserOsMark","Date","now","createPublic","Time","state","entity","date","history","filter","entry","privateCode","dateLog","map","calculateInEntry","reduce","sum","time","interval","finish","start","Math","round","addZero","num","hour","getHours","min","getMinutes","ms","Logger","storageKey","enabled","Monitor","isEnabled","window","localStorage","setItem","e","removeItem","getItem","console","log","info","warn","error","trace","logger","Debug","text","getLogMessage","BX","desktop","Loc","getMessage","substr","i","arguments","length","Error","message","stack","JSON","stringify","debug","Notification","title","callback","toString","Type","isFunction","BXIM","playSound","messageTemplate","notify","createNotify","id","type","messageJs","openNewMessage","addCustomEvent","click","removeCustomEvents","MonitorModel","config","secret","createSecret","desktopCode","getDesktopCode","otherTime","getVariable","shortAbsenceTime","pausedUntil","lastSuccessfulSendDate","lastRemindDate","grantingPermissionDate","deferredGrantingPermissionShowDate","reportState","getDateLog","comments","personal","strictlyWorking","sentQueue","EntityType","unknown","publicCode","extra","preFinish","comment","historyPackage","chartPackage","setDateLog","store","payload","isString","isDate","isNaN","commit","refreshDateLog","isArrayFilled","firstHistoryEntryDateLog","getActions","setLastRemindDate","grantPermission","showGrantingPermissionLater","setDate","getDate","formattedDate","prototype","formatDateLog","setLastSuccessfulSendDate","addPersonal","validatePersonal","removePersonal","addToStrictlyWorking","removeFromStrictlyWorking","clearStrictlyWorking","clearPersonal","addEntity","result","validateEntity","absence","custom","timestamp","timeStart","formatDateToTime","getEntityState","find","isBitrix24Cp","site","location","host","isBitrix24Desktop","app","removeEntityByPrivateCode","clearEntities","addHistory","validateHistory","historyEntry","incognito","getEntityByTitle","getHistoryEntryBySiteUrl","siteUrl","getHistoryEntryByPrivateCode","getHistoryState","canShowReminder","isHistorySent","getGetters","getWorkingTimeForToday","windowCommand","changeTab","MessengerWindow","show","preFinishLastInterval","finishLastInterval","clearHistory","createSentQueue","collectSentQueue","reportComment","validateSentQueue","chart","getSentQueueState","clearSentQueue","clearSentHistory","clearStorageBeforeDate","setComment","isNumber","setPausedUntil","dateTime","getTime","clearPausedUntil","setReportComment","processUnfinishedEvents","migrateHistory","setGrantingPermissionDate","setDeferredGrantingPermissionShowDate","push","startIntervalForHistoryEntry","shouldRemoveTransitionInterval","markedForDeletion","shortAbsenceTimeRest","msToSec","includes","calculateInEntityOnADate","sort","currentEntity","nextEntity","forEach","getCommentByEntity","trim","getCodesToStore","isObject","hasOwnProperty","isInUnsentHistory","privateCodesToStore","DateFormatter","space","getWorkingEntities","workingEntities","workingEntity","hint","EntityGroup","otherTimeRest","others","shortAbsence","otherCodes","shortAbsenceCodes","excludeCodes","concat","group","other","allowedTime","value","getPersonalEntities","personalEntities","a","b","getSiteDetailByPrivateCode","util","objectClone","entries","getChartData","segments","reportDate","emptyChart","getFullYear","getMonth","inactive","clickable","clickableHint","stretchable","minute","workingCustom","working","currentSegment","nextSegment","firstSegmentFrom","unshift","index","setMinutes","lastSegmentTo","chartData","lastSegmentType","segment","getOverChartData","selectedPrivateCode","selectedCodes","display","hasUnsentHistory","setHours","setSeconds","setMilliseconds","currentDate","getReportComment","hasActivityOtherThanBitrix24","hasActivity","appSiteEntities","siteTitle","sentQueueItem","year","month","day","items","absenceShort","VuexBuilderModel","Entity","createSite","createApp","createAbsence","createUnknown","createIncognito","URL","url","err","hostFragments","split","substring","name","pureName","pureTitle","EventHandler","preFinishInterval","lastCaught","process","getEntityTypeByEvent","getNameByProcess","isNewEvent","dispatch","away","isWorkingDayStarted","isTrackerGetActiveAppAvailable","TrackerGetActiveApp","event","separator","path","getApiVersion","catch","catchAppClose","bind","setInterval","eventHandler","Sender","attempt","resendTimeout","resendTimeoutId","ajax","runAction","data","getSentQueue","then","status","afterSuccessSend","getStatusDisabled","disable","startSendingTimer","setTimeout","send","getSendingDelay","monitor","clearTimeout","SidePanel","Instance","close","UI","Center","content","autoHideDelay","sender","CommandHandler","getStatusEnabled","reload","stop","enable","options","playTimeout","isAway","vuex","defaultStorageConfig","dateFormat","timeFormat","debugEnabled","LogInfo","initApp","Pull","subscribe","VuexBuilder","addModel","create","setVariables","useDatabase","setDatabaseConfig","DatabaseType","indexedDb","siteId","userId","build","builder","getStorage","initTracker","errorMessage","init","TimeFormatter","onAway","addTab","order","target","events","open","openReport","command","MessengerCommon","isDesktop","setActiveWindow","launch","shouldShowGrantingPermissionWindow","BXDesktopWindow","ExecuteCommand","isPaused","isPauseRelevant","setPlayTimeout","isTrackerEventsApiAvailable","TrackerStart","TrackerStop","catchAbsence","MonitorReport","openPreview","getPausedUntilTime","pause","hideTab"],"mappings":"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"}