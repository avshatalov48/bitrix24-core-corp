this.BX=this.BX||{};this.BX.Timeman=this.BX.Timeman||{};this.BX.Timeman.Component=this.BX.Timeman.Component||{};(function(t,n,i,e,o,p,r,s,a){"use strict";var m=i.BitrixVue.localComponent("bx-timeman-component-monitor-monitor-group-group-item",{mixins:[e.Time],props:["readOnly","group","privateCode","type","title","time","allowedTime","comment","hint"],data:function t(){return{action:""}},computed:babelHelpers.objectSpread({},n.Vuex.mapGetters("monitor",["getSiteDetailByPrivateCode"]),n.Vuex.mapState({monitor:function t(n){return n.monitor}}),{EntityType:function t(){return o.EntityType},EntityGroup:function t(){return o.EntityGroup}}),methods:{addPersonal:function t(n){this.$store.dispatch("monitor/addPersonal",n)},removePersonal:function t(n){var i=this;if(this.type===o.EntityType.absence&&this.comment.trim()===""){this.action=function(){return i.$store.dispatch("monitor/removePersonal",i.privateCode)};this.onCommentClick();return}this.$store.dispatch("monitor/removePersonal",n)},addToStrictlyWorking:function t(n){var i=this;if(this.type===o.EntityType.absence&&this.comment.trim()===""){this.action=function(){return i.$store.dispatch("monitor/addToStrictlyWorking",n)};this.onCommentClick();return}this.$store.dispatch("monitor/addToStrictlyWorking",n)},removeFromStrictlyWorking:function t(n){this.$store.dispatch("monitor/removeFromStrictlyWorking",n)},onCommentClick:function t(n){this.$emit("commentClick",{event:n,group:this.group,content:{privateCode:this.privateCode,title:this.title,time:this.time,comment:this.comment,type:this.type},onSaveComment:this.action})},onDetailClick:function t(n){this.$emit("detailClick",{event:n,group:this.group,content:{privateCode:this.privateCode,title:this.title,detail:this.getSiteDetailByPrivateCode(this.privateCode),time:this.time}})}},template:'\n    \t<div class="bx-monitor-group-item-wrap">\n\t\t\t<div class="bx-monitor-group-item"> \t\t\t  \n\t\t\t\t<template v-if="type !== EntityType.group">\t\t\t\t\t  \n\t\t\t\t\t<div class="bx-monitor-group-item-container">\n\t\t\t\t\t\t<div class="bx-monitor-group-item-title-container">\n\t\t\t\t\t\t  \t<div\t\t\t\t\t\t\t\t\t\n                                v-if="type === EntityType.absence"\n                                class="bx-monitor-group-item-title-small"\n\t\t\t\t\t\t\t>\n                              {{ title }}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div v-else class="bx-monitor-group-item-title">\n\t\t\t\t\t\t\t\t<template v-if="type !== EntityType.site || readOnly">\n\t\t\t\t\t\t\t\t\t{{ title }}\n\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t\t\t\t<a \n\t\t\t\t\t\t\t\t\t\t@click="onDetailClick" \n\t\t\t\t\t\t\t\t\t\thref="#" \n\t\t\t\t\t\t\t\t\t\tclass="bx-monitor-group-site-title"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t{{ title }}\n\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<bx-hint v-if="hint" :text="hint"/>\n\t\t\t\t\t\t\t<button \n\t\t\t\t\t\t\t\tv-if="group === EntityGroup.working.value" \n\t\t\t\t\t\t\t\tclass="bx-monitor-group-item-button-comment ui-icon ui-icon-xs"\n\t\t\t\t\t\t\t\t:class="{\n\t\t\t\t\t\t\t\t  \'ui-icon-service-imessage\': comment, \n\t\t\t\t\t\t\t\t  \'ui-icon-service-light-imessage\': !comment \n\t\t\t\t\t\t\t\t}"\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<i \n\t\t\t\t\t\t\t\t\t@click="onCommentClick" \n\t\t\t\t\t\t\t\t\t:style="{\n\t\t\t\t\t\t\t\t\t  backgroundColor: comment ? EntityGroup.working.primaryColor : \'transparent\'\n\t\t\t\t\t\t\t\t\t}"\n\t\t\t\t\t\t\t\t/>\t\t\t\t\t\t\t  \t\t\t\t\t\t\t\t  \n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="bx-monitor-group-item-time">\n\t\t\t\t\t\t\t{{ time }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<button\n\t\t\t\t\t\tv-if="group === EntityGroup.personal.value && !readOnly"\n\t\t\t\t\t\t@click="removePersonal(privateCode)"\n\t\t\t\t\t\tclass="ui-btn ui-btn-xs ui-btn-light-border ui-btn-round bx-monitor-group-btn-right"\n\t\t\t\t\t>\n                    \t{{ $Bitrix.Loc.getMessage(\'TIMEMAN_MONITOR_GROUP_BUTTON_TO_WORKING\') }}\n\t\t\t\t\t</button>\t\t\t\t\t  \n\t\t\t\t\t<button\n\t\t\t\t\t\tv-if="\n\t\t\t\t\t\t\tgroup === EntityGroup.working.value \n\t\t\t\t\t\t\t&& type !== EntityType.unknown \n\t\t\t\t\t\t\t&& !readOnly\n\t\t\t\t\t\t"\n\t\t\t\t\t\t@click="addPersonal(privateCode)"\n\t\t\t\t\t\tclass="ui-btn ui-btn-xs ui-btn-light-border ui-btn-round bx-monitor-group-btn-right" \t\t\t\t\t\t\n\t\t\t\t\t>\n                    \t{{ $Bitrix.Loc.getMessage(\'TIMEMAN_MONITOR_GROUP_BUTTON_TO_PERSONAL\') }}\n\t\t\t\t\t</button>\n\t\t\t\t</template>\n\t\t\t\t<template v-else>\n\t\t\t\t\t<div class="bx-monitor-group-item-container">\n\t\t\t\t\t\t<div class="bx-monitor-group-item-title-container">\n\t\t\t\t\t\t\t<div class="bx-monitor-group-item-title-full">\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t{{ title }}\n\t\t\t\t\t\t\t</div>\n                          \t<bx-hint v-if="hint" :text="hint"/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="bx-monitor-group-item-menu">\n\t\t\t\t\t\t\t<div class="bx-monitor-group-item-time">\n\t\t\t\t\t\t\t\t{{ time }} / {{ allowedTime }}\t\t\t\t\t\t\t\t  \n\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t  \n\t\t\t\t\t\t</div>\n\t\t\t\t  </div>\t\t\t\t  \n\t\t\t\t</template>\n\t\t\t</div>\t\t\t\n\t\t</div>\n\t'});i.Vue.component("bx-timeman-component-monitor-group",{components:{GroupItem:m,MountingPortal:r.MountingPortal},mixins:[e.Time],props:["group","readOnly"],data:function t(){return{refreshCount:0,popupInstance:null,popupIdSelector:!!this.readOnly?"#bx-timeman-pwt-popup-preview":"#bx-timeman-pwt-popup-editor",popupContent:{privateCode:"",title:"",time:"",comment:"",detail:"",type:"",onSaveComment:""},comment:"",isCommentPopup:false,isDetailPopup:false}},created:function t(){var n=this;setInterval(function(){return n.refreshCount++},6e4)},computed:babelHelpers.objectSpread({},n.Vuex.mapGetters("monitor",["getWorkingEntities","getPersonalEntities"]),n.Vuex.mapState({monitor:function t(n){return n.monitor}}),{EntityType:function t(){return o.EntityType},EntityGroup:function t(){return o.EntityGroup},displayedGroup:function t(){if(this.EntityGroup.getValues().includes(this.group)){return this.EntityGroup[this.group]}},items:function t(){this.refreshCount;switch(this.displayedGroup.value){case o.EntityGroup.working.value:return this.getWorkingEntities;case o.EntityGroup.personal.value:return this.getPersonalEntities}},time:function t(){this.refreshCount;switch(this.displayedGroup.value){case o.EntityGroup.working.value:return this.workTime;case o.EntityGroup.personal.value:return this.personalTime}}}),methods:{onCommentClick:function t(n){var i=this;this.isCommentPopup=true;this.popupContent.privateCode=n.content.privateCode;this.popupContent.title=n.content.title;this.popupContent.time=n.content.time;this.popupContent.type=n.content.type;this.popupContent.onSaveComment=n.onSaveComment;this.comment=n.content.comment;if(this.popupInstance!==null){this.popupInstance.destroy();this.popupInstance=null}var e=s.PopupManager.create({id:"bx-timeman-pwt-external-data",targetContainer:document.body,autoHide:true,closeByEsc:true,bindOptions:{position:"top"},events:{onPopupDestroy:function t(){i.isCommentPopup=false;i.popupInstance=null}}});this.$nextTick(function(){return i.popupInstance=e})},onDetailClick:function t(n){var i=this;this.isDetailPopup=true;this.popupContent.privateCode=n.content.privateCode;this.popupContent.title=n.content.title;this.popupContent.time=n.content.time;this.popupContent.detail=n.content.detail;if(this.popupInstance!==null){this.popupInstance.destroy();this.popupInstance=null}var e=s.PopupManager.create({id:"bx-timeman-pwt-external-data",targetContainer:document.body,autoHide:true,closeByEsc:true,bindOptions:{position:"top"},events:{onPopupDestroy:function t(){i.isDetailPopup=false;i.popupInstance=null}}});this.$nextTick(function(){return i.popupInstance=e})},saveComment:function t(n){if(this.comment.trim()===""&&this.popupContent.type===o.EntityType.absence){return}this.$store.dispatch("monitor/setComment",{privateCode:n,comment:this.comment});if(typeof this.popupContent.onSaveComment==="function"){this.popupContent.onSaveComment()}this.popupInstance.destroy()}},template:'\t\t  \n\t\t<div class="bx-monitor-group-wrap">\t\t\t\n\t\t\t<div class="bx-monitor-group">\t\t\t\t  \n\t\t\t\t<div class="bx-monitor-group-header" v-bind:style="{ background: displayedGroup.secondaryColor }">\n\t\t\t\t\t<div class="bx-monitor-group-title-wrap">\n\t\t\t\t\t\t<div class="bx-monitor-group-title">\n\t\t\t\t\t\t\t{{ displayedGroup.title }}\n                        </div>\n                      \t<div class="bx-monitor-group-title-wrap">\n\t\t\t\t\t\t\t<div class="bx-monitor-group-subtitle">\n                              {{ formatSeconds(time) }}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div v-if="!readOnly" class="bx-monitor-group-subtitle-wrap">\n\t\t\t\t\t\t<div class="bx-monitor-group-hint">\n\t\t\t\t\t\t\t{{ displayedGroup.hint }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="bx-monitor-group-content" v-bind:style="{ background: displayedGroup.lightColor }">\n\t\t\t\t\t<transition-group name="bx-monitor-group-item" class="bx-monitor-group-content-wrap">\t\t\t\t\t\t  \n\t\t\t\t\t  \n                      <GroupItem\n\t\t\t\t\t\tv-for="item of items"\n                        :key="item.privateCode ? item.privateCode : item.title"\n\t\t\t\t\t\t:group="displayedGroup.value"\n\t\t\t\t\t\t:privateCode="item.privateCode"\n\t\t\t\t\t  \t:type="item.type"\n\t\t\t\t\t\t:title="item.title"\n                        :comment="item.comment"\n\t\t\t\t\t\t:time="formatSeconds(item.time)"\n\t\t\t\t\t\t:allowedTime="item.allowedTime ? formatSeconds(item.allowedTime) : null"\n\t\t\t\t\t\t:readOnly="!!readOnly"\n\t\t\t\t\t\t:hint="item.hint !== \'\' ? item.hint : null"\n                        @commentClick="onCommentClick"\n                        @detailClick="onDetailClick"\n\t\t\t\t\t  />\n                      \t\t\t\t\t\t  \n\t\t\t\t\t</transition-group>\n\t\t\t\t</div>\n\t\t\t</div>\n\n            <mounting-portal :mount-to="popupIdSelector" append v-if="popupInstance">\n            \t<div class="bx-timeman-monitor-popup-wrap">\t\t\t\t\t\n\t\t\t\t\t<div class="popup-window popup-window-with-titlebar ui-message-box ui-message-box-medium-buttons popup-window-fixed-width popup-window-fixed-height" style="padding: 0">\n\t\t\t\t\t\t<div class="bx-timeman-monitor-popup-title popup-window-titlebar">\n\t\t\t\t\t  \t\t<span class="popup-window-titlebar-text">\n\t\t\t\t\t\t\t\t{{ popupContent.title }}\n\t\t\t\t\t \t\t</span>\n\t\t\t\t\t\t\t<span class="popup-window-titlebar-text">\n\t\t\t\t\t\t\t\t{{ popupContent.time }}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="popup-window-content" style="overflow: auto; background: transparent;">\n\t\t\t\t\t\t\t<textarea \n\t\t\t\t\t\t\t\tclass="bx-timeman-monitor-popup-input"\n\t\t\t\t\t\t\t\tid="bx-timeman-monitor-popup-input-comment"\n\t\t\t\t\t\t\t\tv-if="isCommentPopup"\n\t\t\t\t\t\t\t\t:placeholder="$Bitrix.Loc.getMessage(\'TIMEMAN_MONITOR_GROUP_ITEM_COMMENT\')"\n\t\t\t\t\t\t\t\tv-model="comment"\n                                @keydown.enter.prevent="saveComment(popupContent.privateCode)"\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n                            />\n\t\t\t\t\t\t\t<div v-if="isDetailPopup" class="bx-timeman-monitor-popup-items-container">\n\t\t\t\t\t\t\t  \t<div \n\t\t\t\t\t\t\t\t\tv-for="detailItem in popupContent.detail" \n\t\t\t\t\t\t\t\t\tclass="bx-timeman-monitor-popup-item"\n\t\t\t\t\t\t\t  \t>\n\t\t\t\t\t\t\t\t\t<div class="bx-timeman-monitor-popup-content">\n\t\t\t\t\t\t\t\t\t\t<div class="bx-timeman-monitor-popup-content-title">\n                                        \t{{ detailItem.siteTitle }}\n                                      \t</div>\n                                      \t<div class="bx-timeman-monitor-popup-content-title">\n                                        \t<a target="_blank" :href="detailItem.siteUrl" class="bx-timeman-monitor-popup-content-title">\n                                        \t\t{{ detailItem.siteUrl }}\n                                        \t</a>\n                                      \t</div>\n                                    </div>\n                                    <div class="bx-timeman-monitor-popup-time">\n                                    \t{{ formatSeconds(detailItem.time) }}\n                                    </div>\n\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t  \n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="popup-window-buttons">\n\t\t\t\t\t\t\t<button \n\t\t\t\t\t\t\t\tv-if="isCommentPopup" \n\t\t\t\t\t\t\t\t@click="saveComment(popupContent.privateCode)" \n\t\t\t\t\t\t\t\tclass="ui-btn ui-btn-md ui-btn-primary"\n\t\t\t\t\t\t\t\t:class="{\'ui-btn-disabled\': (comment.trim() === \'\' && popupContent.type === EntityType.absence)}"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<span class="ui-btn-text">\n\t\t\t\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage(\'TIMEMAN_MONITOR_GROUP_BUTTON_OK\') }}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t  \t<button @click="popupInstance.destroy()" class="ui-btn ui-btn-md ui-btn-light">\n\t\t\t\t\t\t\t\t<span v-if="isCommentPopup" class="ui-btn-text">\n\t\t\t\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage(\'TIMEMAN_MONITOR_GROUP_BUTTON_CANCEL\') }}\n\t\t\t\t\t\t\t\t</span>\n                              \t<span v-if="isDetailPopup" class="ui-btn-text">\n\t\t\t\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage(\'TIMEMAN_MONITOR_GROUP_BUTTON_CLOSE\') }}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\t\t\t\t\t\n\t\t\t\t</div>\n            </mounting-portal>\n\t\t</div>\n\t'})})(this.BX.Timeman.Component.Monitor=this.BX.Timeman.Component.Monitor||{},BX,BX,BX.Timeman.Mixin,BX.Timeman.Const,window,BX.Vue,BX.Main,BX.UI.Dialogs);
//# sourceMappingURL=monitor-group.bundle.map.js