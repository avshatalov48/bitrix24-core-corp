{"version":3,"file":"export.bundle.js","sources":["../src/export-state.js","../src/export-popup.js","../src/export.js"],"sourcesContent":["import {Event} from \"main.core\";\n\nexport class ExportState extends Event.EventEmitter\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis.states = {\n\t\t\tintermediate: 0,\n\t\t\trunning: 1,\n\t\t\tcompleted: 2,\n\t\t\tstopped: 3,\n\t\t\terror: 4\n\t\t};\n\t}\n\n\tisRunning()\n\t{\n\t\treturn this.state === this.states.running;\n\t}\n\n\tsetRunning()\n\t{\n\t\tthis.state = this.states.running;\n\n\t\tthis.emit('running');\n\t}\n\n\tsetIntermediate()\n\t{\n\t\tthis.state = this.states.intermediate;\n\n\t\tthis.emit('intermediate');\n\t}\n\n\tsetStopped()\n\t{\n\t\tthis.state = this.states.stopped;\n\n\t\tthis.emit('stopped');\n\t}\n\n\tsetCompleted()\n\t{\n\t\tthis.state = this.states.completed;\n\n\t\tthis.emit('completed');\n\t}\n\n\tsetError()\n\t{\n\t\tthis.state = this.states.error;\n\n\t\tthis.emit('error');\n\t}\n}","import {PopupManager} from 'main.popup';\nimport {Loc, Tag, Text} from 'main.core';\nimport {Button} from 'ui.buttons';\nimport {Export} from './export';\nimport {ExportState} from './export-state';\n\nimport './css/export.css';\n\nexport class ExportPopup\n{\n\tconstructor(options)\n\t{\n\t\toptions = {...{\n\t\t\texportManager: null,\n\t\t\texportState: null\n\t\t}, ...options};\n\n\t\tthis.exportManager = (options.exportManager instanceof Export ? options.exportManager : null);\n\t\tthis.exportState = (options.exportState instanceof ExportState ? options.exportState : new ExportState());\n\n\t\tthis.popup = null;\n\t\tthis.popupIsShown = false;\n\n\t\tthis.popupContentId = 'timeman-export-popup-content';\n\n\t\tthis.createProgressBar();\n\n\t\tthis.subscribeToState();\n\t}\n\n\tcreatePopup()\n\t{\n\t\tthis.popup = PopupManager.create(\n\t\t\tText.getRandom(),\n\t\t\tnull,\n\t\t\t{\n\t\t\t\tautoHide: false,\n\t\t\t\tbindOptions: { forceBindPosition: false },\n\t\t\t\tbuttons: this.getPopupButtons(),\n\t\t\t\tcloseByEsc: false,\n\t\t\t\tcloseIcon: false,\n\t\t\t\tcontent: this.getPopupContent(),\n\t\t\t\tdraggable: true,\n\t\t\t\tevents: {\n\t\t\t\t\tonPopupClose: this.onPopupClose.bind(this)\n\t\t\t\t},\n\t\t\t\toffsetLeft: 0,\n\t\t\t\toffsetTop: 0,\n\t\t\t\ttitleBar: Loc.getMessage('TIMEMAN_EXPORT_POPUP_TITLE_EXCEL'),\n\t\t\t\toverlay: true\n\t\t\t}\n\t\t);\n\t}\n\n\tshowPopup()\n\t{\n\t\tif (this.popupIsShown || !this.popup)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.popup.adjustPosition();\n\n\t\tif (!this.popup.isShown())\n\t\t{\n\t\t\tthis.popup.show();\n\t\t}\n\n\t\tthis.popupIsShown = this.popup.isShown();\n\t}\n\n\tadjustPosition()\n\t{\n\t\tif (this.popup)\n\t\t{\n\t\t\tthis.popup.adjustPosition();\n\t\t}\n\t}\n\n\tcreateProgressBar()\n\t{\n\t\t/* eslint-disable */\n\n\t\tBX.loadExt('ui.progressbar').then(() =>\n\t\t{\n\t\t\tthis.progressBar = new BX.UI.ProgressBar({\n\t\t\t\tstatusType: BX.UI.ProgressBar.Status.COUNTER,\n\t\t\t\tsize: BX.UI.ProgressBar.Size.LARGE,\n\t\t\t\tfill: true\n\t\t\t});\n\n\t\t\tthis.progressBarContainer = Tag.render`\n\t\t\t\t<div class=\"timeman-export-progress-bar-container\">\n\t\t\t\t\t${this.progressBar.getContainer()}\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tthis.progressBarHide();\n\t\t});\n\n\t\t/* eslint-enable */\n\t}\n\n\tsubscribeToState()\n\t{\n\t\tthis.exportState\n\t\t\t.subscribe('running', () => {\n\t\t\t\tthis.hideCloseButton();\n\t\t\t})\n\t\t\t.subscribe('intermediate', () => {\n\t\t\t\tthis.showCloseButton();\n\t\t\t})\n\t\t\t.subscribe('stopped', () => {\n\t\t\t\tthis.showCloseButton();\n\t\t\t})\n\t\t\t.subscribe('completed', () => {\n\t\t\t\tthis.showCloseButton();\n\t\t\t\tthis.progressBarHide();\n\t\t\t})\n\t\t\t.subscribe('error', () => {\n\t\t\t\tthis.showCloseButton();\n\t\t\t\tthis.progressBarSetDanger();\n\t\t\t});\n\t}\n\n\tshowCloseButton()\n\t{\n\t\tif (this.buttons['close'] !== 'undefined')\n\t\t{\n\t\t\tthis.buttons['close'].button.style.display = '';\n\t\t}\n\t}\n\n\thideCloseButton()\n\t{\n\t\tif (this.buttons['close'] !== 'undefined')\n\t\t{\n\t\t\tthis.buttons['close'].button.style.display = 'none';\n\t\t}\n\t}\n\n\tprogressBarShow()\n\t{\n\t\tif (this.progressBarContainer)\n\t\t{\n\t\t\tthis.progressBarContainer.style.display = '';\n\t\t}\n\t}\n\n\tprogressBarHide()\n\t{\n\t\tif (this.progressBarContainer)\n\t\t{\n\t\t\tthis.progressBarContainer.style.display = 'none';\n\t\t}\n\t}\n\n\tprogressBarSetDanger()\n\t{\n\t\tif (this.progressBar)\n\t\t{\n\t\t\t// eslint-disable-next-line\n\t\t\tthis.progressBar.setColor(BX.UI.ProgressBar.Color.DANGER);\n\t\t}\n\t}\n\n\tgetPopupButtons()\n\t{\n\t\tthis.buttons = {};\n\n\t\t//todo stop\n\n\t\tthis.buttons['close'] = new Button({\n\t\t\ttext: Loc.getMessage('TIMEMAN_EXPORT_POPUP_CLOSE'),\n\t\t\tcolor: Button.Color.LINK,\n\t\t\tevents: { click : this.handleCloseButtonClick.bind(this) }\n\t\t});\n\n\t\treturn [\n\t\t\tthis.buttons['close']\n\t\t];\n\t}\n\n\tgetDownloadButton(text, downloadUrl)\n\t{\n\t\treturn new Button({\n\t\t\ttext: text,\n\t\t\tcolor: Button.Color.SUCCESS,\n\t\t\ticon: Button.Icon.DOWNLOAD,\n\t\t\ttag: Button.Tag.LINK,\n\t\t\tlink: downloadUrl\n\t\t});\n\t}\n\n\tgetDeleteButton(text)\n\t{\n\t\treturn new Button({\n\t\t\ttext: text,\n\t\t\ticon: Button.Icon.REMOVE,\n\t\t\tonclick: (btn, event) => {\n\t\t\t\tthis.exportManager.clearRequest();\n\t\t\t}\n\t\t});\n\t}\n\n\tsetPopupContent(data)\n\t{\n\t\tconst popupContent = document.getElementById(this.popupContentId);\n\t\tpopupContent.innerHTML = data['SUMMARY_HTML'];\n\t\tif (data['DOWNLOAD_LINK'])\n\t\t{\n\t\t\tpopupContent.appendChild(this.renderFinalButtons(data));\n\t\t}\n\t}\n\n\tgetPopupContent()\n\t{\n\t\tthis.popupContent = `<div id=\"${this.popupContentId}\"></div>`\n\t\treturn Tag.render`\n\t\t\t<div>\n\t\t\t\t${this.popupContent}\n\t\t\t\t${this.progressBarContainer}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\trenderFinalButtons(data)\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"timeman-export-content-final-buttons\">\n\t\t\t\t${this.getDownloadButton(data['DOWNLOAD_LINK_NAME'], data['DOWNLOAD_LINK']).render()}\n\t\t\t\t${this.getDeleteButton(data['CLEAR_LINK_NAME']).render()}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tonPopupClose()\n\t{\n\t\tif (this.popup)\n\t\t{\n\t\t\tthis.popup.destroy();\n\t\t\tthis.popup = null;\n\t\t}\n\n\t\tthis.popupIsShown = false;\n\t}\n\n\thandleCloseButtonClick()\n\t{\n\t\tif (this.popup && !this.exportState.isRunning())\n\t\t{\n\t\t\tthis.popup.close();\n\t\t}\n\t}\n\n\tsetProgressBar(processedItems, totalItems)\n\t{\n\t\tif (totalItems)\n\t\t{\n\t\t\tif (this.progressBar)\n\t\t\t{\n\t\t\t\tthis.progressBarShow();\n\t\t\t\tthis.progressBar.setMaxValue(totalItems);\n\t\t\t\tthis.progressBar.update(processedItems);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.progressBarHide();\n\t\t}\n\t}\n}","import {ajax, Type} from 'main.core';\nimport {ExportState} from './export-state';\nimport {ExportPopup} from './export-popup';\n\nexport class Export\n{\n\tconstructor(options)\n\t{\n\t\toptions = {...{\n\t\t\tsignedParameters: '',\n\t\t\tcomponentName: '',\n\t\t\tsiteId: '',\n\t\t\tstExportId: '',\n\t\t\tmanagerId: '',\n\t\t\tsToken: '',\n\t\t}, ...options};\n\n\t\tthis.signedParameters = options.signedParameters;\n\t\tthis.componentName = options.componentName;\n\t\tthis.siteId = options.siteId;\n\t\tthis.stExportId = options.stExportId;\n\t\tthis.managerId = options.managerId;\n\n\t\tthis.sToken = options.sToken;\n\t\tthis.cToken = 'c';\n\n\t\tthis.exportState = new ExportState();\n\t\tthis.exportPopup = new ExportPopup({\n\t\t\texportManager: this,\n\t\t\texportState: this.exportState\n\t\t});\n\n\t\tthis.availableTypes = ['excel', 'csv'];\n\t}\n\n\tstartExport(exportType)\n\t{\n\t\tif (!this.availableTypes.includes(exportType))\n\t\t{\n\t\t\tthrow 'Export: parameter \"exportType\" has invalid value';\n\t\t}\n\n\t\tthis.exportType = exportType;\n\n\t\tthis.exportPopup.createPopup();\n\n\t\tthis.exportPopup.showPopup();\n\n\t\tthis.startRequest();\n\t}\n\n\tgetExcelExportType()\n\t{\n\t\treturn 'excel';\n\t}\n\n\tgetCsvExportType()\n\t{\n\t\treturn 'csv';\n\t}\n\n\tstartRequest()\n\t{\n\t\tthis.cToken += Date.now();\n\t\tthis.request('timeman.api.export.dispatcher');\n\t}\n\n\tnextRequest()\n\t{\n\t\tthis.request('timeman.api.export.dispatcher');\n\t}\n\n\tstopRequest()\n\t{\n\t\tthis.request('timeman.api.export.cancel');\n\t}\n\n\tclearRequest()\n\t{\n\t\tthis.request('timeman.api.export.clear');\n\t}\n\n\trequest(action)\n\t{\n\t\tthis.exportState.setRunning();\n\n\t\tajax.runAction(action, {\n\t\t\tdata: {\n\t\t\t\t'SITE_ID': this.siteId,\n\t\t\t\t'PROCESS_TOKEN': this.sToken + this.cToken,\n\t\t\t\t'EXPORT_TYPE': this.exportType,\n\t\t\t\t'COMPONENT_NAME': this.componentName,\n\t\t\t\t'signedParameters': this.signedParameters\n\t\t\t}\n\t\t}).then((response) => {\n\t\t\tthis.handleResponse(response);\n\t\t}).catch((response) => {\n\t\t\tthis.handleResponse(response);\n\t\t});\n\t}\n\n\thandleResponse(response)\n\t{\n\t\tif (response.errors.length)\n\t\t{\n\t\t\tthis.exportPopup.setPopupContent(response.errors.shift().message);\n\t\t\tthis.exportState.setError();\n\t\t}\n\t\telse if (response.status === 'success')\n\t\t{\n\t\t\tconst data = response.data;\n\t\t\tswitch (data['STATUS'])\n\t\t\t{\n\t\t\t\tcase 'COMPLETED':\n\t\t\t\tcase 'NOT_REQUIRED':\n\t\t\t\t\tthis.exportState.setCompleted();\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'PROGRESS':\n\t\t\t\t\tconst processedItems = (Type.isInteger(data['PROCESSED_ITEMS']) ? data['PROCESSED_ITEMS'] : 0);\n\t\t\t\t\tconst totalItems = (Type.isInteger(data['TOTAL_ITEMS']) ? data['TOTAL_ITEMS'] : 0);\n\t\t\t\t\tthis.exportPopup.setProgressBar(processedItems, totalItems);\n\t\t\t\t\tsetTimeout(() => this.nextRequest(), 200);\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tthis.exportPopup.setPopupContent(data);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.exportState.setError();\n\t\t}\n\n\t\tthis.exportPopup.adjustPosition();\n\t}\n}"],"names":["ExportState","states","intermediate","running","completed","stopped","error","state","emit","Event","EventEmitter","ExportPopup","options","exportManager","exportState","Export","popup","popupIsShown","popupContentId","createProgressBar","subscribeToState","PopupManager","create","Text","getRandom","autoHide","bindOptions","forceBindPosition","buttons","getPopupButtons","closeByEsc","closeIcon","content","getPopupContent","draggable","events","onPopupClose","bind","offsetLeft","offsetTop","titleBar","Loc","getMessage","overlay","adjustPosition","isShown","show","BX","loadExt","then","progressBar","UI","ProgressBar","statusType","Status","COUNTER","size","Size","LARGE","fill","progressBarContainer","Tag","render","getContainer","progressBarHide","subscribe","hideCloseButton","showCloseButton","progressBarSetDanger","button","style","display","setColor","Color","DANGER","Button","text","color","LINK","click","handleCloseButtonClick","downloadUrl","SUCCESS","icon","Icon","DOWNLOAD","tag","link","REMOVE","onclick","btn","event","clearRequest","data","popupContent","document","getElementById","innerHTML","appendChild","renderFinalButtons","getDownloadButton","getDeleteButton","destroy","isRunning","close","processedItems","totalItems","progressBarShow","setMaxValue","update","signedParameters","componentName","siteId","stExportId","managerId","sToken","cToken","exportPopup","availableTypes","exportType","includes","createPopup","showPopup","startRequest","Date","now","request","action","setRunning","ajax","runAction","response","handleResponse","catch","errors","length","setPopupContent","shift","message","setError","status","setCompleted","Type","isInteger","setProgressBar","setTimeout","nextRequest"],"mappings":"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"}