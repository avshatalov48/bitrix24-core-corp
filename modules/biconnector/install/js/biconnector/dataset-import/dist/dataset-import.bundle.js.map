{"version":3,"file":"dataset-import.bundle.js","sources":["../src/layout/app-layout.js","../src/layout/import-config.js","../src/layout/popup.js","../src/popups/generic-popup.js","../src/popups/saving/saving-popup.js","../src/popups/saving/import-failure-popup.js","../src/popups/saving/import-progress-popup.js","../src/popups/saving/import-success-popup.js","../src/layout/step-hint.js","../src/layout/step-block.js","../src/steps/base-step.js","../src/layout/error-popup.js","../src/fields/type/base-field.js","../src/fields/type/string-field.js","../src/fields/type/text-field.js","../src/fields/dataset-properties.js","../src/steps/dataset-properties.js","../src/steps/data-type/table-header.js","../src/types/data-types.js","../src/steps/data-type/data-type-menu.js","../src/steps/data-type/data-type-selector.js","../src/steps/data-type/table-row.js","../src/steps/data-type/format-table.js","../src/steps/fields-settings.js","../src/steps/data-type/format-selector.js","../src/steps/data-type/slider-button.js","../src/fields/type/switcher-field.js","../src/fields/type/custom-field.js","../src/fields/type/dropdown-field.js","../src/fields/file/file-uploader.js","../src/steps/file.js","../src/layout/app-section.js","../src/steps/import-preview/table-header.js","../src/steps/import-preview/table-row.js","../src/steps/import-preview/preview-table.js","../src/steps/import-preview.js","../src/app/base-app.js","../src/app/csv-app.js","../src/fields/type/connection-selector-field.js","../src/fields/type/table-selector-field.js","../src/steps/connection.js","../src/app/external-connection-app.js","../src/app/store.js","../src/app/app-factory.js","../src/app/slider.js"],"sourcesContent":["import 'ui.pinner';\n\nimport '../css/app-layout.css';\nimport { Dom } from 'main.core';\n\nexport const AppLayout = {\n\tprops: {\n\t\tsaveLocked: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: false,\n\t\t},\n\t\tisEditMode: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\tcomputed: {\n\t\tsaveButtonClass()\n\t\t{\n\t\t\treturn {\n\t\t\t\t'ui-btn-base-light': this.saveLocked,\n\t\t\t\t'app-root__button--blocked': this.saveLocked,\n\t\t\t\t'ui-btn-success': !this.saveLocked,\n\t\t\t};\n\t\t},\n\t\tsaveButtonText()\n\t\t{\n\t\t\treturn this.isEditMode\n\t\t\t\t? this.$Bitrix.Loc.getMessage('DATASET_IMPORT_SAVE')\n\t\t\t\t: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_CREATE');\n\t\t},\n\t},\n\tmounted()\n\t{\n\t\tDom.addClass(document.querySelector('body'), 'app-body');\n\n\t\tconst buttonsPanel = this.$refs.buttonsPanel;\n\t\tif (buttonsPanel)\n\t\t{\n\t\t\tthis.$root.$el.parentNode.appendChild(buttonsPanel);\n\t\t\tnew BX.UI.Pinner(\n\t\t\t\tbuttonsPanel,\n\t\t\t\t{\n\t\t\t\t\tfixBottom: true,\n\t\t\t\t\tfullWidth: true,\n\t\t\t\t},\n\t\t\t);\n\t\t}\n\t},\n\tmethods: {\n\t\tonCreateButtonClick()\n\t\t{\n\t\t\tthis.$Bitrix.eventEmitter.emit('biconnector:dataset-import:createButtonClick', {});\n\t\t},\n\t\tonCancelButtonClick()\n\t\t{\n\t\t\tthis.$Bitrix.eventEmitter.emit('biconnector:dataset-import:cancelButtonClick', {});\n\t\t},\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"app\">\n\t\t\t<div class=\"app__block app__block--narrow\">\n\t\t\t\t<slot name=\"left-panel\"></slot>\n\t\t\t</div>\n\t\t\t<div class=\"app__block\">\n\t\t\t\t<slot name=\"right-panel\"></slot>\n\t\t\t</div>\n\t\n\t\t\t<div class=\"ui-button-panel-wrapper\" ref=\"buttonsPanel\">\n\t\t\t\t<div class=\"ui-button-panel\">\n\t\t\t\t\t<div class=\"app-root__button-wrapper\" :class=\"saveLocked ? 'app-root__button-wrapper--blocked' : ''\">\n\t\t\t\t\t\t<button class=\"ui-btn ui-btn-md app-root__button\" :class=\"saveButtonClass\" @click=\"onCreateButtonClick\" ref=\"saveButton\">\n\t\t\t\t\t\t\t{{ saveButtonText }}\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t\t<button class=\"ui-btn ui-btn-md ui-btn-link app-root__button\" @click=\"onCancelButtonClick\">\n\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('DATASET_IMPORT_CANCEL') }}\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import '../css/import-config.css';\n\nexport const ImportConfig = {\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"import-config\">\n\t\t\t<slot></slot>\n\t\t</div>\n\t`,\n};\n","import { Popup as MainPopup, PopupManager } from 'main.popup';\nimport '../css/popup.css';\n\nexport const Popup = {\n\temits: ['close'],\n\tprops: {\n\t\tid: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\toptions: {\n\t\t\ttype: Object,\n\t\t\trequired: false,\n\t\t\tdefault: {},\n\t\t},\n\t\twrapperClass: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t},\n\tdata()\n\t{\n\t\treturn {\n\t\t\tpopupInstance: null,\n\t\t};\n\t},\n\tcomputed: {\n\t\tpopupOptions()\n\t\t{\n\t\t\treturn {\n\t\t\t\tid: this.id,\n\t\t\t\tcontent: this.$refs.content,\n\t\t\t\tautoHide: true,\n\t\t\t\tevents: {\n\t\t\t\t\tonPopupClose: this.closePopup,\n\t\t\t\t\tonPopupDestroy: this.closePopup,\n\t\t\t\t},\n\t\t\t\tfixed: true,\n\t\t\t\t...this.options,\n\t\t\t};\n\t\t},\n\t},\n\tmethods: {\n\t\tclosePopup()\n\t\t{\n\t\t\tPopupManager.getPopupById(this.id)?.destroy();\n\t\t\tthis.popupInstance = null;\n\t\t\tthis.$emit('close');\n\t\t},\n\t},\n\tmounted()\n\t{\n\t\tif (!this.popupInstance)\n\t\t{\n\t\t\tthis.popupInstance = new MainPopup(this.popupOptions);\n\t\t}\n\n\t\tthis.popupInstance.show();\n\t},\n\tbeforeUnmount(): void\n\t{\n\t\tthis.closePopup();\n\t},\n\ttemplate: `\n\t\t<div ref=\"content\" :class=\"wrapperClass\">\n\t\t\t<slot></slot>\n\t\t</div>\n\t`,\n};\n","import type { PopupOptions } from 'main.popup';\nimport { Popup } from '../layout/popup';\nimport '../css/generic-popup.css';\n\nexport const GenericPopup = {\n\temits: ['close'],\n\tprops: {\n\t\ttitle: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed: {\n\t\tpopupOptions(): PopupOptions\n\t\t{\n\t\t\treturn {\n\t\t\t\twidth: 440,\n\t\t\t\tcloseIcon: true,\n\t\t\t\tnoAllPaddings: true,\n\t\t\t\toverlay: true,\n\t\t\t};\n\t\t},\n\t},\n\tmethods: {\n\t\tonClose()\n\t\t{\n\t\t\tthis.$emit('close');\n\t\t},\n\t},\n\tcomponents: {\n\t\tPopup,\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<Popup id=\"generic\" @close=\"this.onClose\" :options=\"popupOptions\" wrapper-class=\"generic-popup\">\n\t\t\t<h3 class=\"generic-popup__header\">{{ title }}</h3>\n\t\t\t<div class=\"generic-popup__content\">\n\t\t\t\t<slot name=\"content\"></slot>\n\t\t\t</div>\n\t\t\t<div class=\"generic-popup__buttons-wrapper\">\n\t\t\t\t<slot name=\"buttons\"></slot>\n\t\t\t</div>\n\t\t</Popup>\n\t`,\n};\n","import type { PopupOptions } from 'main.popup';\nimport { Popup } from '../../layout/popup';\nimport '../../css/save-progress-popup.css';\n\nexport const SavingPopup = {\n\temits: ['close'],\n\tprops: {\n\t\ttitle: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tdescription: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t\toptions: {\n\t\t\ttype: Object,\n\t\t\trequired: false,\n\t\t\tdefault: {},\n\t\t},\n\t},\n\tcomputed: {\n\t\tpopupOptions(): PopupOptions\n\t\t{\n\t\t\treturn {\n\t\t\t\twidth: 500,\n\t\t\t\tminHeight: 299,\n\t\t\t\tcloseIcon: true,\n\t\t\t\tnoAllPaddings: true,\n\t\t\t\toverlay: true,\n\t\t\t\t...this.options,\n\t\t\t};\n\t\t},\n\t},\n\tmethods: {\n\t\tonClose()\n\t\t{\n\t\t\tthis.$emit('close');\n\t\t},\n\t},\n\tcomponents: {\n\t\tPopup,\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<Popup id=\"saveProgress\" @close=\"this.onClose\" :options=\"popupOptions\" wrapper-class=\"dataset-import-popup--full-height\">\n\t\t\t<div class=\"dataset-save-progress-popup\">\n\t\t\t\t<div class=\"dataset-save-progress-popup__content\">\n\t\t\t\t\t<slot name=\"icon\"></slot>\n\t\t\t\t\t<div class=\"dataset-save-progress-popup__texts\">\n\t\t\t\t\t\t<h3 class=\"dataset-save-progress-popup__header\">{{ title }}</h3>\n\t\t\t\t\t\t<p class=\"dataset-save-progress-popup__description\" v-if=\"description\">{{ description }}</p>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"dataset-save-progress-popup__buttons\"><slot name=\"buttons\"></slot></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</Popup>\n\t`,\n};\n","import { SavingPopup } from './saving-popup';\nimport '../../css/save-progress-popup.css';\n\nexport const ImportFailurePopup = {\n\tprops: {\n\t\ttitle: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tdescription: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['click'],\n\tcomputed: {},\n\tmethods:\n\t{\n\t\tonClick()\n\t\t{\n\t\t\tthis.$emit('click');\n\t\t},\n\t},\n\tcomponents: {\n\t\tSaveProgressPopup: SavingPopup,\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<SaveProgressPopup\n\t\t\t:title=\"title\"\n\t\t\t:description=\"description\"\n\t\t>\n\t\t\t<template v-slot:icon>\n\t\t\t\t<div class=\"dataset-save-progress-popup__failure-logo\"></div>\n\t\t\t</template>\n\t\t\t<template v-slot:buttons>\n\t\t\t\t<button @click=\"onClick\" class=\"ui-btn ui-btn-md ui-btn-primary\">{{ $Bitrix.Loc.getMessage('DATASET_IMPORT_FAILURE_POPUP_BUTTON') }}</button>\n\t\t\t</template>\n\t\t</SaveProgressPopup>\n\t`,\n};\n","import { SavingPopup } from './saving-popup';\nimport { Loader } from 'main.loader';\nimport '../../css/save-progress-popup.css';\n\nexport const ImportProgressPopup = {\n\tprops: {\n\t\tdescription: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t},\n\tmounted()\n\t{\n\t\tconst loader = new Loader({\n\t\t\ttarget: this.$refs.loader,\n\t\t\tsize: 65,\n\t\t\tcolor: 'var(--ui-color-primary)',\n\t\t\tstrokeWidth: 4,\n\t\t\tmode: 'inline',\n\t\t});\n\t\tloader.show();\n\t},\n\tcomputed: {\n\t\tpopupOptions()\n\t\t{\n\t\t\treturn {\n\t\t\t\tautoHide: false,\n\t\t\t\tcloseIcon: false,\n\t\t\t};\n\t\t},\n\t},\n\tcomponents: {\n\t\tSaveProgressPopup: SavingPopup,\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<SaveProgressPopup\n\t\t\t:title=\"$Bitrix.Loc.getMessage('DATASET_IMPORT_PROGRESS_POPUP_HEADER')\"\n\t\t\t:description=\"description\"\n\t\t\t:options=\"popupOptions\"\n\t\t>\n\t\t\t<template v-slot:icon>\n\t\t\t\t<div ref=\"loader\" class=\"dataset-save-progress-loader\"></div>\n\t\t\t</template>\n\t\t</SaveProgressPopup>\n\t`,\n};\n","import { ajax as Ajax, Dom } from 'main.core';\nimport { SavingPopup } from './saving-popup';\nimport '../../css/save-progress-popup.css';\n\nexport const ImportSuccessPopup = {\n\temits: ['click', 'oneMoreClick'],\n\tprops: {\n\t\ttitle: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tdescription: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t\tdatasetId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\tshowMoreButton: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: false,\n\t\t}\n\t},\n\tcomputed: {},\n\tmethods: {\n\t\tonButtonClick()\n\t\t{\n\t\t\tDom.addClass(this.$refs.openDatasetButton, 'ui-btn-wait');\n\t\t\tAjax.runAction(\n\t\t\t\t'biconnector.externalsource.dataset.getEditUrl',\n\t\t\t\t{\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tid: this.datasetId,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t)\n\t\t\t\t.then((response) => {\n\t\t\t\t\tconst link = response.data;\n\t\t\t\t\tif (link)\n\t\t\t\t\t{\n\t\t\t\t\t\twindow.open(link, '_blank').focus();\n\t\t\t\t\t\tDom.removeClass(this.$refs.openDatasetButton, 'ui-btn-wait');\n\t\t\t\t\t\tthis.$emit('click');\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.catch((response) => {\n\t\t\t\t\tDom.removeClass(this.$refs.openDatasetButton, 'ui-btn-wait');\n\t\t\t\t\tthis.$emit('click');\n\t\t\t\t});\n\t\t},\n\t\tonOneMoreButtonClick()\n\t\t{\n\t\t\tDom.addClass(this.$refs.oneMoreButton, 'ui-btn-wait');\n\t\t\tthis.$emit('oneMoreClick');\n\t\t},\n\t},\n\tcomponents: {\n\t\tSaveProgressPopup: SavingPopup,\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<SaveProgressPopup\n\t\t\t:title=\"title\"\n\t\t\t:description=\"description\"\n\t\t>\n\t\t\t<template v-slot:icon>\n\t\t\t\t<div class=\"dataset-save-progress-popup__success-logo\"></div>\n\t\t\t</template>\n\t\t\t<template v-slot:buttons>\n\t\t\t\t<a class=\"ui-btn ui-btn-md ui-btn-primary\" @click=\"onButtonClick\" ref=\"openDatasetButton\">\n\t\t\t\t\t{{ $Bitrix.Loc.getMessage('DATASET_IMPORT_SUCCESS_POPUP_BUTTON') }}\n\t\t\t\t</a>\n\t\t\t\t<a class=\"ui-btn ui-btn-md ui-btn-light-border\" @click=\"onOneMoreButtonClick\" ref=\"oneMoreButton\" v-if=\"showMoreButton\">\n\t\t\t\t\t{{ $Bitrix.Loc.getMessage('DATASET_IMPORT_SUCCESS_POPUP_ONE_MORE_BUTTON') }}\n\t\t\t\t</a>\n\t\t\t</template>\n\t\t</SaveProgressPopup>\n\t`,\n};\n","import 'ui.alerts';\nimport '../css/step-hint.css';\n\nexport const StepHint = {\n\tprops: {\n\t\thintClass: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: 'ui-alert-primary',\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"ui-alert dataset-import-step__hint\" :class=\"hintClass\">\n\t\t\t<span class=\"ui-alert-message\">\n\t\t\t\t<slot></slot>\n\t\t\t</span>\n\t\t</div>\n\t`,\n};\n","import { Text } from 'main.core';\nimport { Section } from 'ui.section';\nimport { StepHint } from './step-hint';\nimport '../css/step.css';\n\nexport const StepBlock = {\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tsection: null,\n\t\t};\n\t},\n\tprops: {\n\t\ttitle: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\thint: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t\tisOpenInitially: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: true,\n\t\t},\n\t\tcanCollapse: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: true,\n\t\t},\n\t\tdisabled: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: false,\n\t\t},\n\t\tcustomClasses: {\n\t\t\ttype: Array,\n\t\t\tdefault: [],\n\t\t},\n\t\thintClass: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t},\n\t},\n\tcomputed: {\n\t\tadditionalClasses()\n\t\t{\n\t\t\tconst custom = this.customClasses.reduce((acc, key) => {\n\t\t\t\tacc[key] = true;\n\n\t\t\t\treturn acc;\n\t\t\t}, {});\n\n\t\t\treturn {\n\t\t\t\t'dataset-import-step__disabled': this.disabled,\n\t\t\t\t...custom,\n\t\t\t};\n\t\t},\n\t},\n\tmethods: {\n\t\ttoggleCollapse(open: ?boolean)\n\t\t{\n\t\t\tthis.section.toggle(open);\n\t\t},\n\t},\n\tmounted()\n\t{\n\t\tconst contentContainer = this.$refs.contentContainer;\n\n\t\tconst section = new Section({\n\t\t\ttitle: this.title,\n\t\t\tisOpen: this.isOpenInitially,\n\t\t\tcanCollapse: this.canCollapse,\n\t\t});\n\n\t\tsection.append(this.$refs.content);\n\t\tsection.renderTo(contentContainer);\n\t\tthis.section = section;\n\t},\n\twatch: {\n\t\ttitle(newValue)\n\t\t{\n\t\t\tif (!this.section)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.section.getContent().querySelector('.ui-section__title').innerHTML = Text.encode(newValue);\n\t\t},\n\t},\n\tcomponents: {\n\t\tStepHint,\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"dataset-import-step\" :class=\"additionalClasses\" ref=\"contentContainer\">\n\t\t</div>\n\t\t<div ref=\"content\" class=\"dataset-import-step__content\">\n\t\t\t<StepHint v-if=\"hint\" :hint-class=\"hintClass\">\n\t\t\t\t<span v-html=\"hint\"></span>\n\t\t\t</StepHint>\n\t\t\t<slot></slot>\n\t\t</div>\n\t`,\n};\n","import { StepBlock } from '../layout/step-block';\n\nexport const BaseStep = {\n\temits: ['validation'],\n\tprops: {\n\t\ttitle: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t},\n\t\thint: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t},\n\t\tisOpenInitially: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: true,\n\t\t},\n\t\tdisabled: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\tcomputed: {\n\t\tdisplayedTitle()\n\t\t{\n\t\t\treturn this.title ?? this.defaultTitle;\n\t\t},\n\t\tdisplayedHint()\n\t\t{\n\t\t\treturn this.hint ?? this.defaultHint;\n\t\t},\n\t\tdefaultTitle()\n\t\t{\n\t\t\treturn '';\n\t\t},\n\t\tdefaultHint()\n\t\t{\n\t\t\treturn '';\n\t\t},\n\t},\n\tmethods: {\n\t\topen()\n\t\t{\n\t\t\tif (this.$refs.stepBlock)\n\t\t\t{\n\t\t\t\tthis.$refs.stepBlock.toggleCollapse(true);\n\t\t\t}\n\t\t},\n\t\tclose()\n\t\t{\n\t\t\tif (this.$refs.stepBlock)\n\t\t\t{\n\t\t\t\tthis.$refs.stepBlock.toggleCollapse(false);\n\t\t\t}\n\t\t},\n\t\tvalidate()\n\t\t{\n\t\t\treturn true;\n\t\t},\n\t\tshowValidationErrors()\n\t\t{},\n\t},\n\tcomponents: {\n\t\tStep: StepBlock,\n\t},\n};\n","import { Tag } from 'main.core';\nimport { Popup, PopupOptions } from 'main.popup';\n\nexport class ErrorPopup\n{\n\tstatic create(message: string, element: HTMLElement): Popup\n\t{\n\t\tconst content = Tag.render`<span class='ui-hint-content'></span>`;\n\t\tcontent.innerHTML = message;\n\n\t\tconst popupOptions: PopupOptions = {\n\t\t\tbindElement: element,\n\t\t\tdarkMode: true,\n\t\t\tcontent,\n\t\t\tautoHide: false,\n\t\t\tbindOptions: {\n\t\t\t\tposition: 'top',\n\t\t\t},\n\t\t\tangle: {\n\t\t\t\tposition: 'bottom',\n\t\t\t},\n\t\t\tcacheable: false,\n\t\t};\n\n\t\tPopup.setOptions({\n\t\t\tangleMinBottom: 43,\n\t\t});\n\n\t\treturn new Popup(popupOptions);\n\t}\n}\n","import '../../css/dataset-import-field.css';\n\nexport const BaseField = {\n\tprops: {\n\t\tdefaultValue: {\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t\tname: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\ttitle: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tplaceholder: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t\tisValid: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: true,\n\t\t},\n\t\terrorMessage: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t\tisDisabled: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: false,\n\t\t},\n\t\thintText: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t},\n\t},\n\temits: [\n\t\t'valueChange',\n\t],\n\tdata()\n\t{\n\t\treturn {\n\t\t\tvalue: this.defaultValue,\n\t\t\tareValidationErrorsShown: false,\n\t\t};\n\t},\n\tmethods: {\n\t\tshowValidationErrors()\n\t\t{\n\t\t\tthis.areValidationErrorsShown = true;\n\t\t},\n\t\tonInputChange(newValue)\n\t\t{\n\t\t\tthis.$emit('valueChange', {\n\t\t\t\tnewValue,\n\t\t\t\tfieldName: this.name,\n\t\t\t});\n\t\t},\n\t},\n\twatch: {\n\t\tdefaultValue(newValue)\n\t\t{\n\t\t\tthis.value = newValue;\n\t\t},\n\t},\n};\n","import { Dom, Tag } from 'main.core';\nimport { Popup, PopupOptions } from 'main.popup';\nimport { ErrorPopup } from '../../layout/error-popup';\nimport { BaseField } from './base-field';\nimport '../../css/dataset-import-field.css';\nimport 'ui.hint';\n\nexport const StringField = {\n\textends: BaseField,\n\tdata()\n\t{\n\t\treturn {\n\t\t\terrorPopup: null,\n\t\t\terrorPopupTimeout: null,\n\t\t};\n\t},\n\tmethods: {\n\t\tonInput(event)\n\t\t{\n\t\t\tthis.areValidationErrorsShown = false;\n\t\t\tthis.onInputChange(event.target.value);\n\t\t},\n\t\tonBlur()\n\t\t{\n\t\t\tthis.areValidationErrorsShown = true;\n\t\t\tif (!this.isValid)\n\t\t\t{\n\t\t\t\tthis.showErrorHint();\n\t\t\t\tthis.errorPopupTimeout = setTimeout(() => {\n\t\t\t\t\tthis.hideErrorHint();\n\t\t\t\t\tthis.errorPopupTimeout = null;\n\t\t\t\t}, 3000);\n\t\t\t}\n\t\t},\n\t\tshowErrorHint()\n\t\t{\n\t\t\tif (this.errorPopupTimeout)\n\t\t\t{\n\t\t\t\tclearTimeout(this.errorPopupTimeout);\n\t\t\t\tthis.errorPopupTimeout = null;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.errorPopup = this.createErrorPopup();\n\t\t\t\tthis.errorPopup.show();\n\t\t\t}\n\t\t},\n\t\thideErrorHint()\n\t\t{\n\t\t\tif (this.errorPopup)\n\t\t\t{\n\t\t\t\tthis.errorPopup.close();\n\t\t\t}\n\t\t},\n\t\tcreateErrorPopup()\n\t\t{\n\t\t\treturn ErrorPopup.create(this.errorMessage, this.$refs.errorIconWrapper);\n\t\t},\n\t},\n\tmounted()\n\t{\n\t\tif (this.hintText)\n\t\t{\n\t\t\tDom.append(BX.UI.Hint.createNode(this.hintText), this.$refs.title);\n\t\t}\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"ui-form-row\">\n\t\t\t<div class=\"ui-form-label\">\n\t\t\t\t<div class=\"ui-ctl-label-text\" ref=\"title\">\n\t\t\t\t\t{{ title }}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"ui-ctl ui-ctl-after-icon ui-ctl-textbox ui-ctl-w100 dataset-import-control\">\n\t\t\t\t<input\n\t\t\t\t\tclass=\"ui-ctl-element dataset-import-field\"\n\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t:class=\"{ 'data-import-field--invalid': !isValid && areValidationErrorsShown }\"\n\t\t\t\t\t:disabled=\"isDisabled\"\n\t\t\t\t\t:placeholder=\"placeholder\"\n\t\t\t\t\tv-model=\"value\"\n\t\t\t\t\t@input=\"onInput\"\n\t\t\t\t\t@blur=\"onBlur\"\n\t\t\t\t>\n\t\t\t\t<div class=\"ui-ctl-after\" ref=\"errorIconWrapper\">\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass=\"ui-icon-set --warning format-table__error-icon\"\n\t\t\t\t\t\t@mouseenter=\"showErrorHint\"\n\t\t\t\t\t\t@mouseleave=\"hideErrorHint\"\n\t\t\t\t\t\tv-if=\"!isValid && areValidationErrorsShown\"\n\t\t\t\t\t></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { BaseField } from './base-field';\n\nexport const TextField = {\n\textends: BaseField,\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"ui-form-row\">\n\t\t\t<div class=\"ui-form-label\">\n\t\t\t\t<div class=\"ui-ctl-label-text\">{{ title }}</div>\n\t\t\t</div>\n\t\t\t<div class=\"ui-ctl ui-ctl-textarea dataset-import-textarea ui-ctl-w100 ui-ctl-no-resize\">\n\t\t\t\t<textarea \n\t\t\t\t\tclass=\"ui-ctl-element dataset-import-textarea-element\" \n\t\t\t\t\t:placeholder=\"placeholder\" \n\t\t\t\t\t@input=\"onInputChange($event.target.value)\"\n\t\t\t\t\tv-model=\"value\"\n\t\t\t\t></textarea>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import type { FieldValueChangeEvent } from '../types/field-value-change-event';\nimport { StringField } from './type/string-field';\nimport { TextField } from './type/text-field';\nimport '../css/dataset-properties.css';\n\nexport const DatasetProperties = {\n\tprops: {\n\t\tdefaultName: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t\tdefaultDescription: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t\tunvalidatedFields: {\n\t\t\ttype: Object,\n\t\t\trequired: false,\n\t\t\tdefault: {},\n\t\t},\n\t\tdisabledFields: {\n\t\t\ttype: Object,\n\t\t\trequired: false,\n\t\t\tdefault: {},\n\t\t},\n\t\tdatasetSourceCode: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: [\n\t\t'valueChange',\n\t\t'validationNeeded',\n\t],\n\tmethods: {\n\t\tonValueChange(event: FieldValueChangeEvent)\n\t\t{\n\t\t\tthis.$emit('valueChange', event);\n\t\t},\n\t\tshowValidationErrors()\n\t\t{\n\t\t\tthis.$refs.nameField.showValidationErrors();\n\t\t},\n\t},\n\tcomponents: {\n\t\tStringField,\n\t\tTextField,\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"ui-form dataset-properties\">\n\t\t\t<StringField\n\t\t\t\tref=\"nameField\"\n\t\t\t\tname=\"name\"\n\t\t\t\t:defaultValue=\"defaultName\"\n\t\t\t\t@value-change=\"onValueChange\"\n\t\t\t\t:title=\"this.$Bitrix.Loc.getMessage('DATASET_IMPORT_DATASET_PROPERTIES_CODE')\"\n\t\t\t\t:placeholder=\"this.$Bitrix.Loc.getMessage('DATASET_IMPORT_DATASET_PROPERTIES_CODE_PLACEHOLDER', { '#CODE#': this.datasetSourceCode })\"\n\t\t\t\t:is-valid=\"unvalidatedFields.name?.result ?? true\"\n\t\t\t\t:is-disabled=\"disabledFields.name ?? false\"\n\t\t\t\t:error-message=\"unvalidatedFields.name?.message ?? ''\"\n\t\t\t/>\n\t\t\t<TextField\n\t\t\t\tname=\"description\"\n\t\t\t\t:defaultValue=\"defaultDescription\"\n\t\t\t\t@value-change=\"onValueChange\"\n\t\t\t\t:title=\"this.$Bitrix.Loc.getMessage('DATASET_IMPORT_DATASET_PROPERTIES_DESCRIPTION')\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","import { StepBlock } from '../layout/step-block';\nimport { BaseStep } from './base-step';\nimport { DatasetProperties } from '../fields/dataset-properties';\nimport type { FieldValueChangeEvent } from '../types/field-value-change-event';\n\nexport const DatasetPropertiesStep = {\n\textends: BaseStep,\n\tprops: {\n\t\tdatasetSourceCode: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\treservedNames: {\n\t\t\ttype: Array,\n\t\t\trequired: false,\n\t\t\tdefault: [],\n\t\t},\n\t},\n\temits: ['propertiesChanged'],\n\tcomputed: {\n\t\tdatasetProperties()\n\t\t{\n\t\t\treturn this.$store.state.config.datasetProperties;\n\t\t},\n\t\tdefaultTitle()\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage('DATASET_IMPORT_PROPERTIES_HEADER');\n\t\t},\n\t\tdefaultHint()\n\t\t{\n\t\t\tif (this.isEditMode)\n\t\t\t{\n\t\t\t\treturn '';\n\t\t\t}\n\n\t\t\treturn this.$Bitrix.Loc.getMessage('DATASET_IMPORT_PROPERTIES_HINT');\n\t\t},\n\t\tdisabledFields()\n\t\t{\n\t\t\treturn {\n\t\t\t\tname: this.$store.getters.isEditMode,\n\t\t\t};\n\t\t},\n\t\tunvalidatedFields()\n\t\t{\n\t\t\tconst result = {};\n\t\t\tconst nameValidationResult = this.validateName();\n\t\t\tif (!nameValidationResult.result)\n\t\t\t{\n\t\t\t\tresult.name = nameValidationResult;\n\t\t\t}\n\n\t\t\treturn result;\n\t\t},\n\t\tisEditMode()\n\t\t{\n\t\t\treturn this.$store.getters.isEditMode;\n\t\t},\n\t},\n\tcomponents: {\n\t\tStep: StepBlock,\n\t\tDatasetProperties,\n\t},\n\tmethods: {\n\t\tonDatasetPropertiesFieldsChange(event: FieldValueChangeEvent)\n\t\t{\n\t\t\tconst datasetProperties = this.datasetProperties;\n\t\t\tdatasetProperties[event.fieldName] = event.newValue;\n\t\t\tthis.$store.commit('setDatasetProperties', datasetProperties);\n\t\t\tthis.validate();\n\n\t\t\tthis.$emit('propertiesChanged');\n\t\t},\n\t\tvalidate()\n\t\t{\n\t\t\tlet result = true;\n\t\t\tif (!this.isEditMode)\n\t\t\t{\n\t\t\t\tresult = Object.keys(this.unvalidatedFields).length === 0;\n\t\t\t}\n\n\t\t\tthis.$emit('validation', result);\n\n\t\t\treturn result;\n\t\t},\n\t\tvalidateName()\n\t\t{\n\t\t\tconst name = this.$store.state.config.datasetProperties.name;\n\t\t\tif (!name)\n\t\t\t{\n\t\t\t\treturn {\n\t\t\t\t\tresult: true,\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tconst isReserved = this.reservedNames.includes(name);\n\t\t\tif (isReserved)\n\t\t\t{\n\t\t\t\treturn {\n\t\t\t\t\tresult: false,\n\t\t\t\t\tmessage: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_FIELD_VALIDATION_DATASET_EXISTS'),\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tif (name.length > 30)\n\t\t\t{\n\t\t\t\treturn {\n\t\t\t\t\tresult: false,\n\t\t\t\t\tmessage: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_FIELD_VALIDATION_DATASET_TOO_LONG'),\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tif (!/^[a-z][\\d_a-z]*$/.test(name))\n\t\t\t{\n\t\t\t\treturn {\n\t\t\t\t\tresult: false,\n\t\t\t\t\tmessage: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_FIELD_VALIDATION_DATASET_INVALID_CHARS'),\n\t\t\t\t};\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tresult: true,\n\t\t\t};\n\t\t},\n\t\tshowValidationErrors()\n\t\t{\n\t\t\tthis.$refs.datasetProperties.showValidationErrors();\n\t\t},\n\t},\n\ttemplate: `\n\t\t<Step\n\t\t\t:title=\"displayedTitle\"\n\t\t\t:hint=\"displayedHint\"\n\t\t\t:is-open-initially=\"isOpenInitially\"\n\t\t\t:disabled=\"disabled\"\n\t\t\tref=\"stepBlock\"\n\t\t>\n\t\t\t<slot name=\"additional-properties\"></slot>\n\t\t\t<DatasetProperties\n\t\t\t\t@value-change=\"onDatasetPropertiesFieldsChange\"\n\t\t\t\t:default-name=\"datasetProperties.name\"\n\t\t\t\t:default-description=\"datasetProperties.description\"\n\t\t\t\tref=\"datasetProperties\"\n\t\t\t\t:disabled-fields=\"disabledFields\"\n\t\t\t\t:unvalidated-fields=\"unvalidatedFields\"\n\t\t\t\t:dataset-source-code=\"datasetSourceCode\"\n\t\t\t/>\n\t\t</Step>\n\t`,\n};\n","import '../../css/format-table.css';\nimport 'ui.hint';\n\nexport const TableHeader = {\n\tprops: {\n\t\tenabled: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: true,\n\t\t},\n\t\tindeterminate: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\temits: [\n\t\t'checkboxClick',\n\t],\n\tcomputed: {\n\t\tisNeedShowOriginalNameHint(): boolean\n\t\t{\n\t\t\treturn this.$store.state.config.fileProperties?.firstLineHeader ?? true;\n\t\t},\n\t},\n\tmethods: {\n\t\tonCheckboxClick(event)\n\t\t{\n\t\t\tevent.preventDefault();\n\t\t\tthis.$emit('checkboxClick');\n\t\t},\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<tr>\n\t\t\t<th class=\"format-table__header format-table__checkbox-header\">\n\t\t\t\t<input class=\"format-table__checkbox\" type=\"checkbox\" @change=\"onCheckboxClick\" :checked=\"enabled\" :indeterminate.prop=\"indeterminate\">\n\t\t\t</th>\n\t\t\t<th class=\"format-table__header format-table__type-header format-table__type-subfield-header\">{{ $Bitrix.Loc.getMessage('DATASET_IMPORT_FIELD_SETTINGS_TYPE_HEADER') }}</th>\n\t\t\t<th class=\"format-table__header format-table__header format-table__title-header\">{{ $Bitrix.Loc.getMessage('DATASET_IMPORT_FIELD_SETTINGS_CODE_HEADER') }}</th>\n\t\t\t<th class=\"format-table__header format-table__header format-table__title-header\" v-if=\"isNeedShowOriginalNameHint\"></th>\n\t\t</tr>\n\t`,\n};\n","import { Loc } from 'main.core';\n\ntype DataTypeDescription = {\n\ttitle: string,\n\ticon: string,\n}\n\nconst DataType = {\n\tstring: 'string',\n\tmoney: 'money',\n\tint: 'int',\n\tdouble: 'double',\n\tdate: 'date',\n\tdatetime: 'datetime',\n};\n\nconst DataTypeDescriptions: Record<string, DataTypeDescription> = {\n\t[DataType.string]: {\n\t\ttitle: Loc.getMessage('DATASET_IMPORT_FIELD_SETTINGS_TYPE_TEXT'),\n\t\ticon: '--formatting',\n\t},\n\t[DataType.money]: {\n\t\ttitle: Loc.getMessage('DATASET_IMPORT_FIELD_SETTINGS_TYPE_MONEY'),\n\t\ticon: '--money',\n\t},\n\t[DataType.int]: {\n\t\ttitle: Loc.getMessage('DATASET_IMPORT_FIELD_SETTINGS_TYPE_NUMBER'),\n\t\ticon: '--numbers-123',\n\t},\n\t[DataType.double]: {\n\t\ttitle: Loc.getMessage('DATASET_IMPORT_FIELD_SETTINGS_TYPE_DECIMAL'),\n\t\ticon: '--numbers-05',\n\t},\n\t[DataType.date]: {\n\t\ttitle: Loc.getMessage('DATASET_IMPORT_FIELD_SETTINGS_TYPE_DATE'),\n\t\ticon: '--calendar-1',\n\t},\n\t[DataType.datetime]: {\n\t\ttitle: Loc.getMessage('DATASET_IMPORT_FIELD_SETTINGS_TYPE_DATETIME'),\n\t\ticon: '--planning-2',\n\t},\n};\n\ntype DataFormatTemplate = {\n\t[DataType.money]: string[],\n\t[DataType.double]: string[],\n\t[DataType.date]: string[],\n\t[DataType.datetime]: string[],\n};\n\nexport {\n\tDataType,\n\tDataTypeDescriptions,\n\tDataFormatTemplate,\n};\n","import { Menu } from 'main.popup';\nimport { DataTypeDescriptions } from '../../types/data-types';\n\ntype DataTypeMenuOptions = {\n\tselectedType: string,\n\tbindElement: HTMLElement,\n\tonSelect: Function,\n\tonClose: Function,\n};\n\nexport class DataTypeMenu\n{\n\t#selectedType: string;\n\t#bindElement: HTMLElement;\n\t#onSelect: Function;\n\t#onClose: Function;\n\n\tconstructor(options: DataTypeMenuOptions)\n\t{\n\t\tthis.#selectedType = options.selectedType;\n\t\tthis.#bindElement = options.bindElement;\n\t\tthis.#onSelect = options.onSelect;\n\t\tthis.#onClose = options.onClose;\n\t}\n\n\tgetMenu(): Menu\n\t{\n\t\tconst items = [];\n\t\tObject.entries(DataTypeDescriptions).forEach(([key, value]) => {\n\t\t\titems.push({\n\t\t\t\thtml: `\n\t\t\t\t\t<div class=\"ui-icon-set ${value.icon}\"></div>\n\t\t\t\t\t<span class=\"format-table__dropdown-item-text\">${value.title}</span>\n\t\t\t\t\t${key === this.#selectedType ? '<div class=\"format-table__dropdown-item-selected ui-icon-set --check\"></div>' : ''}\n\t\t\t\t`,\n\t\t\t\tonclick: (event, item) => {\n\t\t\t\t\tthis.#onSelect(key);\n\t\t\t\t\titem.getMenuWindow().close();\n\t\t\t\t},\n\t\t\t\tclassName: `format-table__dropdown-item${key === this.#selectedType ? ' format-table__dropdown-item--active' : ''}`,\n\t\t\t});\n\t\t});\n\n\t\treturn new Menu({\n\t\t\tclassName: 'format-table__dropdown-popup',\n\t\t\tbindElement: this.#bindElement,\n\t\t\titems,\n\t\t\tevents: {\n\t\t\t\tonClose: this.#onClose,\n\t\t\t},\n\t\t});\n\t}\n}\n","import { DataTypeMenu } from './data-type-menu';\nimport { DataTypeDescriptions } from '../../types/data-types';\n\nexport const DataTypeSelector = {\n\tprops: {\n\t\tselectedType: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: 'text',\n\t\t},\n\t\tisEditMode: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\temits: [\n\t\t'valueChange',\n\t],\n\tdata()\n\t{\n\t\treturn {\n\t\t\ttypeMenu: null,\n\t\t\tisFocused: false,\n\t\t};\n\t},\n\tcomputed: {\n\t\ticonClass()\n\t\t{\n\t\t\treturn DataTypeDescriptions[this.selectedType].icon;\n\t\t},\n\t\ttypeTitle()\n\t\t{\n\t\t\treturn DataTypeDescriptions[this.selectedType].title;\n\t\t},\n\t},\n\tmethods: {\n\t\tonClick(event)\n\t\t{\n\t\t\tif (this.isEditMode)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.isFocused = true;\n\n\t\t\tif (!this.typeMenu)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.typeMenu.getPopupWindow().setWidth(this.$refs.formatButton.offsetWidth);\n\t\t\tthis.typeMenu.show();\n\t\t},\n\t\tcreateMenu()\n\t\t{\n\t\t\tif (!this.isEditMode)\n\t\t\t{\n\t\t\t\tthis.typeMenu = (new DataTypeMenu({\n\t\t\t\t\tselectedType: this.selectedType,\n\t\t\t\t\tbindElement: this.$refs.formatButton,\n\t\t\t\t\tonSelect: (selectedType) => {\n\t\t\t\t\t\tthis.$emit('valueChange', selectedType);\n\t\t\t\t\t},\n\t\t\t\t\tonClose: () => {\n\t\t\t\t\t\tthis.isFocused = false;\n\t\t\t\t\t},\n\t\t\t\t})).getMenu();\n\t\t\t}\n\t\t},\n\t\tdestroyMenu()\n\t\t{\n\t\t\tthis.typeMenu?.destroy();\n\t\t},\n\t},\n\tmounted()\n\t{\n\t\tthis.createMenu();\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.destroyMenu();\n\t},\n\twatch: {\n\t\tselectedType(newValue)\n\t\t{\n\t\t\tthis.destroyMenu();\n\t\t\tthis.createMenu();\n\t\t},\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div\n\t\t\tclass=\"ui-ctl ui-ctl-before-icon ui-ctl-after-icon ui-ctl-w100 format-table__type-control ui-ctl-dropdown\"\n\t\t\tref=\"formatButton\"\n\t\t\t@click=\"onClick\"\n\t\t\t:class=\"{\n\t\t\t\t'format-table__type-control--disabled': isEditMode,\n\t\t\t\t'ui-ctl-hover': isFocused,\n\t\t\t}\"\n\t\t>\n\t\t\t<div class=\"ui-ctl-after ui-ctl-icon-angle\" v-if=\"!isEditMode\"></div>\n\t\t\t<div class=\"ui-ctl-before\">\n\t\t\t\t<div class=\"format-table__type-button\" :class=\"{ 'format-table__type-button--disabled': isEditMode }\">\n\t\t\t\t\t<div class=\"ui-icon-set\" :class=\"iconClass\"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"ui-ctl-element format-table__text-input\">\n\t\t\t\t<span>{{ typeTitle }}</span>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import '../../css/format-table.css';\nimport { ErrorPopup } from '../../layout/error-popup';\nimport { DataTypeDescriptions } from '../../types/data-types';\nimport { DataTypeSelector } from './data-type-selector';\nimport { BIcon, Set } from 'ui.icon-set.api.vue';\nimport { hint } from 'ui.vue3.directives.hint';\n\nexport const TableRow = {\n\tdirectives: {\n\t\thint,\n\t},\n\tprops: {\n\t\tenabled: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: true,\n\t\t},\n\t\tindex: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\tfieldSettings: {\n\t\t\ttype: Object,\n\t\t\trequired: false,\n\t\t\tdefault: null,\n\t\t},\n\t\tinvalidFields: {\n\t\t\ttype: Object,\n\t\t\trequired: false,\n\t\t\tdefault: {},\n\t\t},\n\t\tisEditMode: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\tdata()\n\t{\n\t\treturn {\n\t\t\tdisplayedValidationErrors: {\n\t\t\t\tname: true,\n\t\t\t},\n\t\t\terrorPopup: {\n\t\t\t\tname: null,\n\t\t\t},\n\t\t\terrorPopupTimeout: null,\n\t\t};\n\t},\n\tcomputed: {\n\t\tisNameValid(): boolean\n\t\t{\n\t\t\treturn !('name' in this.invalidFields);\n\t\t},\n\t\tdisplayedErrorForName(): string\n\t\t{\n\t\t\treturn this.invalidFields.name.message;\n\t\t},\n\t\tset(): Set\n\t\t{\n\t\t\treturn Set;\n\t\t},\n\t\toriginalsHintText(): string\n\t\t{\n\t\t\tconst originalType = this.fieldSettings.originalType;\n\t\t\tconst originalName = this.fieldSettings.originalName;\n\n\t\t\tlet typeText = '';\n\t\t\tif (originalType)\n\t\t\t{\n\t\t\t\ttypeText = this.$Bitrix.Loc.getMessage('DATASET_IMPORT_FIELD_SETTINGS_ORIG_TYPE', {\n\t\t\t\t\t'#CLASS#': '<span class=\"format-table__orig_info_title\">',\n\t\t\t\t\t'#/CLASS#': '</span>',\n\t\t\t\t\t'#TYPENAME#': DataTypeDescriptions[originalType].title,\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tconst nameText = this.$Bitrix.Loc.getMessage('DATASET_IMPORT_FIELD_SETTINGS_ORIG_NAME', {\n\t\t\t\t'#CLASS#': '<span class=\"format-table__orig_info_title\">',\n\t\t\t\t'#/CLASS#': '</span>',\n\t\t\t\t'#FIELDNAME#': originalName,\n\t\t\t});\n\n\t\t\tif (!originalType)\n\t\t\t{\n\t\t\t\treturn nameText;\n\t\t\t}\n\n\t\t\treturn `${typeText}<br>${nameText}`;\n\t\t},\n\t\tisNeedShowOriginalNameHint(): boolean\n\t\t{\n\t\t\treturn (this.$store.state.config.fileProperties?.firstLineHeader ?? true)\n\t\t\t\t&& this.$store.state.config.connectionProperties?.connectionType\n\t\t\t;\n\t\t},\n\t\thintOptions(): Object\n\t\t{\n\t\t\treturn {\n\t\t\t\thtml: this.originalsHintText,\n\t\t\t\tpopupOptions: {\n\t\t\t\t\tangle: {\n\t\t\t\t\t\tposition: 'left',\n\t\t\t\t\t},\n\t\t\t\t\toffsetLeft: 30,\n\t\t\t\t\toffsetTop: -46,\n\t\t\t\t\tautoHide: false,\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t},\n\temits: [\n\t\t'checkboxClick',\n\t\t'fieldChange',\n\t],\n\tmethods: {\n\t\tonCheckboxClick(event)\n\t\t{\n\t\t\tevent.preventDefault();\n\t\t\tthis.$emit('checkboxClick', {\n\t\t\t\tindex: this.index,\n\t\t\t});\n\t\t},\n\t\tonTypeSelected(type)\n\t\t{\n\t\t\tthis.$emit('fieldChange', {\n\t\t\t\tfieldName: 'type',\n\t\t\t\tvalue: type,\n\t\t\t\tindex: this.index,\n\t\t\t});\n\t\t},\n\t\tonFieldInput(event)\n\t\t{\n\t\t\tthis.displayedValidationErrors[event.target.name] = false;\n\t\t\tthis.$emit('fieldChange', {\n\t\t\t\tfieldName: event.target.name,\n\t\t\t\tvalue: event.target.value,\n\t\t\t\tindex: this.index,\n\t\t\t});\n\t\t},\n\t\tonFieldBlur(event)\n\t\t{\n\t\t\tthis.displayedValidationErrors[event.target.name] = true;\n\n\t\t\tif ('name' in this.invalidFields)\n\t\t\t{\n\t\t\t\tthis.showErrorHint();\n\t\t\t\tthis.errorPopupTimeout = setTimeout(() => {\n\t\t\t\t\tthis.hideErrorHint();\n\t\t\t\t\tthis.errorPopupTimeout = null;\n\t\t\t\t}, 3000);\n\t\t\t}\n\t\t},\n\t\tshowValidationErrors()\n\t\t{\n\t\t\tObject.keys(this.displayedValidationErrors).forEach((field) => {\n\t\t\t\tthis.displayedValidationErrors[field] = true;\n\t\t\t});\n\t\t},\n\t\tshowErrorHint()\n\t\t{\n\t\t\tif (this.errorPopupTimeout)\n\t\t\t{\n\t\t\t\tclearTimeout(this.errorPopupTimeout);\n\t\t\t\tthis.errorPopupTimeout = null;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.errorPopup.name = this.createErrorPopup();\n\t\t\t\tthis.errorPopup.name.show();\n\t\t\t}\n\t\t},\n\t\thideErrorHint()\n\t\t{\n\t\t\tif (this.errorPopup.name)\n\t\t\t{\n\t\t\t\tthis.errorPopup.name.close();\n\t\t\t}\n\t\t},\n\t\tcreateErrorPopup()\n\t\t{\n\t\t\treturn ErrorPopup.create(this.displayedErrorForName, this.$refs.errorIconWrapper);\n\t\t},\n\t},\n\twatch: {\n\t\tisNeedShowOriginalNameHint()\n\t\t{\n\t\t\tif (this.$refs.originalsHint)\n\t\t\t{\n\t\t\t\tthis.$refs.originalsHint.remove();\n\t\t\t}\n\t\t},\n\t},\n\tcomponents: {\n\t\tDataTypeButton: DataTypeSelector,\n\t\tBIcon,\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<tr class=\"format-table__row\">\n\t\t\t<td class=\"format-table__checkbox-cell\">\n\t\t\t\t<input class=\"format-table__checkbox\" ref=\"visibilityCheckbox\" type=\"checkbox\" @change=\"onCheckboxClick\" :checked=\"enabled\">\n\t\t\t</td>\n\t\t\t<td class=\"format-table__cell\">\n\t\t\t\t<DataTypeButton :selected-type=\"fieldSettings.type\" @value-change=\"onTypeSelected\" :is-edit-mode=\"isEditMode\" />\n\t\t\t</td>\n\t\t\t<td class=\"format-table__cell\">\n\t\t\t\t<div\n\t\t\t\t\tclass=\"ui-ctl ui-ctl-textbox ui-ctl-w100 format-table__name-control\"\n\t\t\t\t\t:class=\"{\n\t\t\t\t\t\t'format-table__text-input--invalid': displayedValidationErrors.name && !isNameValid,\n\t\t\t\t\t\t'format-table__text-input--disabled': isEditMode,\n\t\t\t\t\t\t'ui-ctl-after-icon': !isEditMode && !isNameValid,\n\t\t\t\t\t}\"\n\t\t\t\t>\n\t\t\t\t\t<input\n\t\t\t\t\t\tclass=\"ui-ctl-element format-table__text-input format-table__name-input\"\n\t\t\t\t\t\t:disabled=\"isEditMode\"\n\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t:placeholder=\"$Bitrix.Loc.getMessage('DATASET_IMPORT_FIELD_SETTINGS_PLACEHOLDER')\"\n\t\t\t\t\t\tname=\"name\"\n\t\t\t\t\t\t@input=\"onFieldInput\"\n\t\t\t\t\t\t@blur=\"onFieldBlur\"\n\t\t\t\t\t\t:value=\"fieldSettings.name\"\n\t\t\t\t\t>\n\t\t\t\t\t<div class=\"ui-ctl-after\" ref=\"errorIconWrapper\">\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tclass=\"ui-icon-set --warning format-table__error-icon\"\n\t\t\t\t\t\t\t@mouseenter=\"showErrorHint\"\n\t\t\t\t\t\t\t@mouseleave=\"hideErrorHint\"\n\t\t\t\t\t\t\tv-if=\"displayedValidationErrors.name && !isNameValid\"\n\t\t\t\t\t\t></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</td>\n\t\t\t<td class=\"format-table__cell\" v-if=\"isNeedShowOriginalNameHint\">\n\t\t\t\t<div class=\"format-table__orig-type-hint-wrapper\" v-hint=\"hintOptions\" ref=\"originalsHint\">\n\t\t\t\t\t<div class=\"format-table__orig-type-hint\">\n\t\t\t\t\t\t<BIcon\n\t\t\t\t\t\t\t:name=\"set.INFO_1\"\n\t\t\t\t\t\t\t:size=\"20\"\n\t\t\t\t\t\t\tcolor=\"#B5BABE\"\n\t\t\t\t\t\t></BIcon>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</td>\n\t\t</tr>\n\t`,\n};\n","import { TableHeader } from './table-header';\nimport { TableRow } from './table-row';\nimport '../../css/format-table.css';\n\nexport const FormatTable = {\n\tprops: {\n\t\tfieldsSettings: {\n\t\t\ttype: Array,\n\t\t\trequired: false,\n\t\t},\n\t\tunvalidatedRows: {\n\t\t\ttype: Object,\n\t\t\trequired: false,\n\t\t},\n\t\tisEditMode: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\temits: [\n\t\t'rowToggle',\n\t\t'headerToggle',\n\t\t'rowFieldChanged',\n\t],\n\tcomputed: {\n\t\tareAllRowsVisible()\n\t\t{\n\t\t\treturn this.$store.getters.areAllRowsVisible;\n\t\t},\n\t\tareNoRowsVisible()\n\t\t{\n\t\t\treturn this.$store.getters.areNoRowsVisible;\n\t\t},\n\t\tareSomeRowsVisible()\n\t\t{\n\t\t\treturn this.$store.getters.areSomeRowsVisible;\n\t\t},\n\t},\n\tmethods: {\n\t\tonRowCheckboxClicked(event)\n\t\t{\n\t\t\tthis.$emit('rowToggle', event);\n\t\t},\n\t\tonHeaderCheckboxClicked()\n\t\t{\n\t\t\tthis.$emit('headerToggle');\n\t\t},\n\t\tonRowFieldChanged(event)\n\t\t{\n\t\t\tthis.$emit('rowFieldChanged', event);\n\t\t},\n\t\tshowValidationErrors()\n\t\t{\n\t\t\tconst rowIndices = Object.keys(this.unvalidatedRows);\n\t\t\trowIndices.forEach((index) => {\n\t\t\t\tif (this.$refs.row[index])\n\t\t\t\t{\n\t\t\t\t\tthis.$refs.row[index].showValidationErrors();\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t},\n\tcomponents: {\n\t\tTableHeader,\n\t\tTableRow,\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<table class=\"format-table\">\n\t\t\t<thead>\n\t\t\t\t<TableHeader :enabled=\"areAllRowsVisible\" :indeterminate=\"areSomeRowsVisible\" @checkbox-click=\"onHeaderCheckboxClicked\" />\n\t\t\t</thead>\n\t\t\t<tbody>\n\t\t\t\t<template v-for=\"(field, index) in fieldsSettings\" :key=\"index\">\n\t\t\t\t\t<TableRow\n\t\t\t\t\t\tref=\"row\"\n\t\t\t\t\t\t:index=\"index\"\n\t\t\t\t\t\t:enabled=\"field.visible\"\n\t\t\t\t\t\t:field-settings=\"field\"\n\t\t\t\t\t\t@checkbox-click=\"onRowCheckboxClicked\"\n\t\t\t\t\t\t@field-change=\"onRowFieldChanged\"\n\t\t\t\t\t\t:invalid-fields=\"unvalidatedRows[index] ?? []\"\n\t\t\t\t\t\t:is-edit-mode=\"isEditMode\"\n\t\t\t\t\t/>\n\t\t\t\t</template>\n\t\t\t</tbody>\n\t\t</table>\n\t`,\n};\n","import { StepBlock } from '../layout/step-block';\nimport { BaseStep } from './base-step';\nimport { FormatTable } from './data-type/format-table';\nimport '../css/fields-settings.css';\n\nexport const FieldsSettingsStep = {\n\temits: ['parsingOptionsChanged', 'settingsChanged'],\n\textends: BaseStep,\n\tcomputed: {\n\t\tfieldsSettings()\n\t\t{\n\t\t\treturn this.$store.state.config.fieldsSettings;\n\t\t},\n\t\tdefaultTitle()\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage('DATASET_IMPORT_FIELDS_SETTINGS_HEADER');\n\t\t},\n\t\tdefaultHint()\n\t\t{\n\t\t\tif (this.isEditMode)\n\t\t\t{\n\t\t\t\treturn this.$Bitrix.Loc.getMessage('DATASET_IMPORT_FIELDS_SETTINGS_HINT_EDIT')\n\t\t\t\t\t.replace('[link]', '<a onclick=\"top.BX.Helper.show(`redirect=detail&code=23378698`)\">')\n\t\t\t\t\t.replace('[/link]', '</a>')\n\t\t\t\t;\n\t\t\t}\n\n\t\t\treturn this.$Bitrix.Loc.getMessage('DATASET_IMPORT_FIELDS_SETTINGS_HINT')\n\t\t\t\t.replace('[link]', '<a onclick=\"top.BX.Helper.show(`redirect=detail&code=23378698`)\">')\n\t\t\t\t.replace('[/link]', '</a>')\n\t\t\t;\n\t\t},\n\t\tunvalidatedRows()\n\t\t{\n\t\t\tconst rows = {};\n\n\t\t\tthis.$store.state.config.fieldsSettings.forEach((field, index) => {\n\t\t\t\tconst invalidFields = {};\n\n\t\t\t\tif (!this.isEditMode)\n\t\t\t\t{\n\t\t\t\t\tconst nameValidationResult = this.validateName(field.name);\n\t\t\t\t\tif (!nameValidationResult.result)\n\t\t\t\t\t{\n\t\t\t\t\t\tinvalidFields.name = nameValidationResult;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (Object.keys(invalidFields).length > 0)\n\t\t\t\t{\n\t\t\t\t\trows[index] = invalidFields;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\treturn rows;\n\t\t},\n\t\tisEditMode()\n\t\t{\n\t\t\treturn this.$store.getters.isEditMode;\n\t\t},\n\t},\n\tmethods: {\n\t\tvalidateName(name)\n\t\t{\n\t\t\tconst isNotEmpty = name.length > 0;\n\t\t\tif (!isNotEmpty)\n\t\t\t{\n\t\t\t\treturn {\n\t\t\t\t\tresult: false,\n\t\t\t\t\tmessage: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_FIELD_VALIDATION_EMPTY_ERROR'),\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tconst isTooLong = name.length > 32;\n\t\t\tif (isTooLong)\n\t\t\t{\n\t\t\t\treturn {\n\t\t\t\t\tresult: false,\n\t\t\t\t\tmessage: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_FIELD_VALIDATION_FIELD_TOO_LONG'),\n\t\t\t\t};\n\t\t\t}\n\n\t\t\t// only numbers, uppercase letters and underscores; starts with a letter\n\t\t\tconst areCharactersValid = /^[A-Z](?=.*[A-Z_])[A-Z0-9_]*$/.test(name);\n\t\t\tif (!areCharactersValid)\n\t\t\t{\n\t\t\t\treturn {\n\t\t\t\t\tresult: false,\n\t\t\t\t\tmessage: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_FIELD_VALIDATION_FIELD_INVALID_CHARS'),\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tconst isAlreadyUsed = this.$store.getters.previewHeaders.reduce((\n\t\t\t\tcount,\n\t\t\t\tvalue,\n\t\t\t) => (name === value ? count + 1 : count), 0) > 1;\n\t\t\tif (isAlreadyUsed)\n\t\t\t{\n\t\t\t\treturn {\n\t\t\t\t\tresult: false,\n\t\t\t\t\tmessage: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_FIELD_VALIDATION_FIELD_ALREADY_USED'),\n\t\t\t\t};\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tresult: true,\n\t\t\t};\n\t\t},\n\t\tonRowToggled(event)\n\t\t{\n\t\t\tthis.$store.commit('toggleRowVisibility', event.index);\n\t\t\tthis.$emit('settingsChanged');\n\t\t},\n\t\tonHeaderToggled(event)\n\t\t{\n\t\t\tif (this.$store.getters.areAllRowsVisible)\n\t\t\t{\n\t\t\t\tthis.$store.commit('setAllRowsInvisible');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.$store.commit('setAllRowsVisible');\n\t\t\t}\n\n\t\t\tthis.$emit('settingsChanged');\n\t\t},\n\t\tonRowFieldChanged(event)\n\t\t{\n\t\t\tthis.fieldsSettings[event.index][event.fieldName] = event.value;\n\t\t\tthis.$store.commit('setFieldRowSettings', {\n\t\t\t\tindex: event.index,\n\t\t\t\tsettings: this.fieldsSettings[event.index],\n\t\t\t});\n\n\t\t\tif (event.fieldName === 'type')\n\t\t\t{\n\t\t\t\tthis.$emit('parsingOptionsChanged');\n\t\t\t}\n\n\t\t\tthis.$emit('settingsChanged');\n\n\t\t\tthis.validate();\n\t\t},\n\t\tvalidate()\n\t\t{\n\t\t\tconst result = Object.keys(this.unvalidatedRows).length === 0;\n\n\t\t\tthis.$emit('validation', result);\n\n\t\t\treturn result;\n\t\t},\n\t\tshowValidationErrors()\n\t\t{\n\t\t\tthis.$refs.formatTable.showValidationErrors();\n\t\t},\n\t},\n\tcomponents: {\n\t\tStep: StepBlock,\n\t\tFormatTable,\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<Step\n\t\t\t:title=\"displayedTitle\"\n\t\t\t:hint=\"displayedHint\"\n\t\t\t:is-open-initially=\"isOpenInitially\"\n\t\t\t:disabled=\"disabled\"\n\t\t\tref=\"stepBlock\"\n\t\t>\n\t\t\t<div class=\"ui-form-row fields-settings\">\n\t\t\t\t<FormatTable\n\t\t\t\t\t:fields-settings=\"fieldsSettings\"\n\t\t\t\t\t@row-toggle=\"onRowToggled\"\n\t\t\t\t\t@header-toggle=\"onHeaderToggled\"\n\t\t\t\t\t@row-field-changed=\"onRowFieldChanged\"\n\t\t\t\t\t:unvalidated-rows=\"unvalidatedRows\"\n\t\t\t\t\tref=\"formatTable\"\n\t\t\t\t\t:is-edit-mode=\"isEditMode\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</Step>\n\t`,\n};\n","import { Dom, Event, Loc, Tag } from 'main.core';\nimport { Layout } from 'ui.sidepanel.layout';\nimport '../../css/format-selector.css';\nimport { DataType } from '../../types/data-types';\nimport type { DataFormatTemplate } from '../../types/data-types';\n\ntype DropdownControlOptions = {\n\ttitle: string,\n\tsubtitle: string,\n\toptions: Option[],\n\tfieldType: string,\n\tselected: string,\n};\n\nconst OptionType = {\n\tCUSTOM: 'custom',\n\tVALUE: 'value',\n};\n\ntype Option = {\n\ttitle: string,\n\ttype: OptionType.CUSTOM | OptionType.VALUE,\n\tvalue: string,\n};\n\nexport class FormatSelector\n{\n\tstatic openSlider(selected: Object, dataFormatTemplates: DataFormatTemplate, onClose: function)\n\t{\n\t\tBX.SidePanel.Instance.open('biconnector:import-field-formats', {\n\t\t\twidth: 584,\n\t\t\tcontentCallback: () => {\n\t\t\t\treturn Layout.createContent({\n\t\t\t\t\textensions: ['ui.forms', 'ui.layout-form', 'ui.alerts', 'biconnector.dataset-import'],\n\t\t\t\t\ttitle: Loc.getMessage('DATASET_IMPORT_FIELD_FORMAT_SELECTOR_TITLE'),\n\t\t\t\t\tcontent()\n\t\t\t\t\t{\n\t\t\t\t\t\treturn FormatSelector.#getContent(selected, dataFormatTemplates);\n\t\t\t\t\t},\n\t\t\t\t\tbuttons({ cancelButton, SaveButton })\n\t\t\t\t\t{\n\t\t\t\t\t\treturn [\n\t\t\t\t\t\t\tnew SaveButton({\n\t\t\t\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\t\t\t\t// hack: using a singleton instance to store the form didn't work\n\t\t\t\t\t\t\t\t\tconst form = BX.SidePanel.Instance.getTopSlider().getContainer().querySelector('#formatSelectorForm');\n\t\t\t\t\t\t\t\t\tonClose(FormatSelector.#extractValues(form));\n\t\t\t\t\t\t\t\t\tBX.SidePanel.Instance.close();\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\tcancelButton,\n\t\t\t\t\t\t];\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t},\n\t\t});\n\t}\n\n\tstatic #extractValues(form): Object\n\t{\n\t\tconst formData = new FormData(form);\n\n\t\tconst result = Object.fromEntries(formData);\n\n\t\tconst customFieldsToExtract = ['date', 'datetime'];\n\n\t\tcustomFieldsToExtract.forEach((field) => {\n\t\t\tif (result[field] === 'custom')\n\t\t\t{\n\t\t\t\tresult[field] = result[`${field}CustomValue`];\n\t\t\t}\n\n\t\t\tdelete result[`${field}CustomValue`];\n\t\t});\n\n\t\treturn result;\n\t}\n\n\tstatic #getContent(selected: Object, dataFormatTemplates: DataFormatTemplate): HTMLElement\n\t{\n\t\tconst formRoot = Tag.render`\n\t\t\t<form class=\"ui-form\" id=\"formatSelectorForm\">\n\t\t\t</form>\n\t\t`;\n\n\t\tDom.append(FormatSelector.#getDropdownControl({\n\t\t\ttitle: Loc.getMessage('DATASET_IMPORT_FIELD_FORMAT_SELECTOR_DATE'),\n\t\t\tsubtitle: Loc.getMessage('DATASET_IMPORT_FIELD_FORMAT_SELECTOR_DATE_HINT'),\n\t\t\toptions: dataFormatTemplates[DataType.date],\n\t\t\tfieldType: DataType.date,\n\t\t\tselected: selected[DataType.date],\n\t\t}), formRoot);\n\n\t\tDom.append(FormatSelector.#getDropdownControl({\n\t\t\ttitle: Loc.getMessage('DATASET_IMPORT_FIELD_FORMAT_SELECTOR_DATETIME'),\n\t\t\tsubtitle: Loc.getMessage('DATASET_IMPORT_FIELD_FORMAT_SELECTOR_DATETIME_HINT'),\n\t\t\toptions: dataFormatTemplates[DataType.datetime],\n\t\t\tfieldType: DataType.datetime,\n\t\t\tselected: selected[DataType.datetime],\n\t\t}), formRoot);\n\n\t\tDom.append(FormatSelector.#getDropdownControl({\n\t\t\ttitle: Loc.getMessage('DATASET_IMPORT_FIELD_FORMAT_SELECTOR_MONEY'),\n\t\t\tsubtitle: Loc.getMessage('DATASET_IMPORT_FIELD_FORMAT_SELECTOR_MONEY_HINT'),\n\t\t\toptions: dataFormatTemplates[DataType.money],\n\t\t\tfieldType: DataType.money,\n\t\t\tselected: selected[DataType.money],\n\t\t}), formRoot);\n\n\t\tDom.append(FormatSelector.#getDropdownControl({\n\t\t\ttitle: Loc.getMessage('DATASET_IMPORT_FIELD_FORMAT_SELECTOR_DOUBLE'),\n\t\t\tsubtitle: Loc.getMessage('DATASET_IMPORT_FIELD_FORMAT_SELECTOR_DOUBLE_HINT'),\n\t\t\toptions: dataFormatTemplates[DataType.double],\n\t\t\tfieldType: DataType.double,\n\t\t\tselected: selected[DataType.double],\n\t\t}), formRoot);\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"format-selector\">\n\t\t\t\t<div class=\"ui-alert ui-alert-primary format-selector__hint\">\n\t\t\t\t\t<span class=\"ui-alert-message\">\n\t\t\t\t\t\t${Loc.getMessage('DATASET_IMPORT_FIELD_FORMAT_SELECTOR_HINT', {\n\t\t\t\t\t\t\t'[link]': '<a onclick=\"top.BX.Helper.show(`redirect=detail&code=23378698`)\">',\n\t\t\t\t\t\t\t'[/link]': '</a>',\n\t\t\t\t\t\t})}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t${formRoot}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tstatic #getDropdownControl(options: DropdownControlOptions): HTMLElement\n\t{\n\t\tconst selectRoot = Tag.render`\n\t\t\t<select class=\"ui-ctl-element\" name=\"${options.fieldType}\">\n\t\t\t</select>\n\t\t`;\n\n\t\tlet isCustomSelected = true;\n\t\tlet customElement = null;\n\t\tlet customOptionInput = null;\n\n\t\toptions.options.forEach((option) => {\n\t\t\tlet optionElement = '';\n\n\t\t\tconst isSelected = option.value === options.selected;\n\t\t\tif (isSelected)\n\t\t\t{\n\t\t\t\tisCustomSelected = false;\n\t\t\t}\n\n\t\t\tif (option.type === OptionType.VALUE)\n\t\t\t{\n\t\t\t\toptionElement = Tag.render`\n\t\t\t\t\t<option ${option.value === options.selected ? 'selected' : ''} value=\"${option.value}\">${option.title}</option>\n\t\t\t\t`;\n\t\t\t}\n\t\t\telse if (option.type === OptionType.CUSTOM)\n\t\t\t{\n\t\t\t\tcustomElement = Tag.render`\n\t\t\t\t\t<option value=\"custom\">${Loc.getMessage('DATASET_IMPORT_FIELD_FORMAT_SELECTOR_CUSTOM_FORMAT')}</option>\n\t\t\t\t`;\n\t\t\t\toptionElement = customElement;\n\n\t\t\t\tcustomOptionInput = Tag.render`\n\t\t\t\t\t<div class=\"ui-ctl ui-ctl-textbox ui-ctl-w100 format-selector__custom-value-input format-selector__custom-value-input--hidden\">\n\t\t\t\t\t\t<input class=\"ui-ctl-element\" name=\"${options.fieldType}CustomValue\" type=\"text\" placeholder=\"...\" value=\"${option.value ?? ''}\">\n\t\t\t\t\t</div>\n\t\t\t\t`;\n\n\t\t\t\tEvent.bind(selectRoot, 'change', (event) => {\n\t\t\t\t\tconst value = event.target.value;\n\t\t\t\t\tif (value === 'custom')\n\t\t\t\t\t{\n\t\t\t\t\t\tDom.removeClass(customOptionInput, 'format-selector__custom-value-input--hidden');\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tDom.addClass(customOptionInput, 'format-selector__custom-value-input--hidden');\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tDom.append(optionElement, selectRoot);\n\t\t});\n\n\t\tif (isCustomSelected)\n\t\t{\n\t\t\tif (customElement)\n\t\t\t{\n\t\t\t\tcustomElement.setAttribute('selected', true);\n\t\t\t}\n\n\t\t\tif (customOptionInput)\n\t\t\t{\n\t\t\t\tcustomOptionInput.querySelector('input').value = options.selected;\n\t\t\t\tDom.removeClass(customOptionInput, 'format-selector__custom-value-input--hidden');\n\t\t\t}\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"ui-form-row\">\n\t\t\t\t<div class=\"ui-form-label\">\n\t\t\t\t\t<div class=\"ui-ctl-label-text\">\n\t\t\t\t\t\t${options.title}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"format-selector__type-subtitle\">\n\t\t\t\t\t\t${options.subtitle}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"ui-ctl ui-ctl-after-icon ui-ctl-dropdown ui-ctl-w100\">\n\t\t\t\t\t<div class=\"ui-ctl-after ui-ctl-icon-angle\"></div>\n\t\t\t\t\t${selectRoot}\n\t\t\t\t</div>\n\t\t\t\t${customOptionInput}\n\t\t\t</div>\n\t\t`;\n\t}\n}\n","import '../../css/fields-settings.css';\nimport 'ui.icon-set.crm';\n\nexport const SliderButton = {\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"ui-form-row\">\n\t\t\t<div class=\"ui-ctl ui-ctl-before-icon ui-ctl-after-icon ui-ctl-w100 fields-settings__slider-button\">\n\t\t\t\t<div class=\"ui-ctl-before\">\n\t\t\t\t\t<div class=\"ui-icon-set --form-settings fields-settings__slider-icon\"></div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"ui-ctl-after ui-ctl-icon-angle fields-settings__slider-chevron\">\n\t\t\t\t</div>\n\t\t\t\t<div class=\"ui-ctl-element\">\n\t\t\t\t\t{{ this.$Bitrix.Loc.getMessage('DATASET_IMPORT_FIELD_SETTINGS_FORMAT_BUTTON') }}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { BaseField } from './base-field';\nimport { Switcher, SwitcherSize } from 'ui.switcher';\nimport '../../css/switcher-field.css';\n\nexport const SwitcherField = {\n\textends: BaseField,\n\tmounted()\n\t{\n\t\tnew Switcher({\n\t\t\tnode: this.$refs.switcher,\n\t\t\tsize: SwitcherSize.small,\n\t\t\tchecked: this.defaultValue,\n\t\t\thandlers: {\n\t\t\t\ttoggled: () => {\n\t\t\t\t\tthis.value = !this.value;\n\t\t\t\t\tthis.onInputChange(this.value);\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"ui-form-row\">\n\t\t\t<div class=\"switcher-field\">\n\t\t\t\t<div ref=\"switcher\"></div>\n\t\t\t\t<div class=\"switcher-field__label\">\n\t\t\t\t\t<span>{{ title }}</span>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { BaseField } from './base-field';\n\nexport const CustomField = {\n\textends: BaseField,\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"ui-form-row\">\n\t\t\t<div class=\"ui-form-label\">\n\t\t\t\t<div class=\"ui-ctl-label-text\">{{ title }}</div>\n\t\t\t</div>\n\t\t\t<div class=\"ui-ctl ui-ctl-w100\">\n\t\t\t\t<slot name=\"field-content\"></slot>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { BaseField } from './base-field';\n\nexport const DropdownField = {\n\textends: BaseField,\n\tprops: {\n\t\toptions: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"ui-form-row\">\n\t\t\t<div class=\"ui-form-label\">\n\t\t\t\t<div class=\"ui-ctl-label-text\">{{ title }}</div>\n\t\t\t</div>\n\t\t\t<div class=\"ui-ctl ui-ctl-after-icon ui-ctl-dropdown ui-ctl-w100\">\n\t\t\t\t<div class=\"ui-ctl-after ui-ctl-icon-angle\"></div>\n\t\t\t\t<select class=\"ui-ctl-element\" v-model=\"value\" @change=\"onInputChange($event.target.value)\">\n\t\t\t\t\t<option v-for=\"option in options\" :value=\"option.value\" :selected=\"option.value === defaultValue\">{{ option.title }}</option>\n\t\t\t\t</select>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { FormatSelector } from '../../steps/data-type/format-selector';\nimport { SliderButton } from '../../steps/data-type/slider-button';\nimport type { FieldValueChangeEvent } from '../../types/field-value-change-event';\nimport { SwitcherField } from '../type/switcher-field';\nimport { StackWidgetComponent as FileUploadWidget } from 'ui.uploader.stack-widget';\nimport { CustomField } from '../type/custom-field';\nimport { DropdownField } from '../type/dropdown-field';\nimport '../../css/dataset-file-upload.css';\n\nexport const FileUploader = {\n\tcomponents: {\n\t\tFileUploadWidget,\n\t\tCustomField,\n\t\tDropdownField,\n\t\tSwitcherField,\n\t\tSliderButton,\n\t},\n\tprops: {\n\t\tdefaultEncoding: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t\tdefaultSeparator: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t\tdefaultFirstLineHeader: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: true,\n\t\t},\n\t\tencodings: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t\tseparators: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t\tisEditMode: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: false,\n\t\t},\n\t\tunvalidatedFields: {\n\t\t\ttype: Object,\n\t\t\trequired: false,\n\t\t\tdefault: {},\n\t\t},\n\t\tdataFormatTemplates: {\n\t\t\ttype: Object,\n\t\t},\n\t},\n\tdata()\n\t{\n\t\treturn {\n\t\t\tinputElement: null,\n\t\t\tareValidationErrorsShown: false,\n\t\t};\n\t},\n\temits: [\n\t\t'valueChange',\n\t\t'uploadError',\n\t\t'parsingOptionsChanged',\n\t],\n\tcomputed: {\n\t\tuploaderOptions()\n\t\t{\n\t\t\treturn {\n\t\t\t\tcontroller: 'biconnector.integration.ui.fileUploaderController.datasetUploaderController',\n\t\t\t\tcontrollerOptions: {},\n\t\t\t\tmultiple: false,\n\t\t\t\tacceptOnlyImages: false,\n\t\t\t\tmaxFileSize: 1024 * 1024 * 60,\n\t\t\t\tautoUpload: true,\n\t\t\t\tacceptedFileTypes: ['.csv'],\n\t\t\t\tevents: {\n\t\t\t\t\tonUploadComplete: () => {\n\t\t\t\t\t\tthis.onUploadComplete();\n\t\t\t\t\t},\n\t\t\t\t\t'File:onRemove': () => {\n\t\t\t\t\t\tthis.onFileRemoved();\n\t\t\t\t\t},\n\t\t\t\t\tonError: () => {\n\t\t\t\t\t\tthis.onUploadError();\n\t\t\t\t\t},\n\t\t\t\t\t'File:onError': () => {\n\t\t\t\t\t\tthis.onUploadError();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t\twidgetOptions()\n\t\t{\n\t\t\treturn {\n\t\t\t\tsize: 'large',\n\t\t\t};\n\t\t},\n\t},\n\tmethods: {\n\t\tonValueChange(event: FieldValueChangeEvent)\n\t\t{\n\t\t\tthis.$emit('valueChange', event);\n\t\t},\n\t\tonUploadComplete()\n\t\t{\n\t\t\tconst file = this.$refs.uploader.uploader.getFiles()[0];\n\t\t\tif (file && file.isComplete())\n\t\t\t{\n\t\t\t\tthis.areValidationErrorsShown = false;\n\t\t\t\tthis.$emit('valueChange', {\n\t\t\t\t\tnewValue: file.getServerFileId(),\n\t\t\t\t\tfieldName: 'fileToken',\n\t\t\t\t});\n\t\t\t\tthis.$emit('valueChange', {\n\t\t\t\t\tnewValue: file.getName(),\n\t\t\t\t\tfieldName: 'fileName',\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\tonFileRemoved()\n\t\t{\n\t\t\tthis.$emit('valueChange', {\n\t\t\t\tnewValue: null,\n\t\t\t\tfieldName: 'fileToken',\n\t\t\t});\n\t\t},\n\t\tonUploadError()\n\t\t{\n\t\t\tthis.$emit('uploadError');\n\t\t},\n\t\tshowValidationErrors()\n\t\t{\n\t\t\tthis.areValidationErrorsShown = true;\n\t\t},\n\t\topenDataFormatSlider()\n\t\t{\n\t\t\tFormatSelector.openSlider(this.$store.state.config.dataFormats, this.dataFormatTemplates, (selectedFormats) => {\n\t\t\t\tthis.$store.commit('setDataFormats', selectedFormats);\n\t\t\t\tthis.$emit('parsingOptionsChanged');\n\t\t\t});\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"ui-form\">\n\t\t\t<CustomField :title=\"$Bitrix.Loc.getMessage('DATASET_IMPORT_FILE_FIELD')\" name=\"file\">\n\t\t\t\t<template #field-content>\n\t\t\t\t\t<div class=\"dataset-file-upload\">\n\t\t\t\t\t\t<FileUploadWidget\n\t\t\t\t\t\t\t:uploaderOptions=\"uploaderOptions\"\n\t\t\t\t\t\t\t:widgetOptions=\"widgetOptions\"\n\t\t\t\t\t\t\tref=\"uploader\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<p class=\"dataset-import-field__error-text\" v-if=\"areValidationErrorsShown && !unvalidatedFields.file?.result\">\n\t\t\t\t\t\t\t{{ unvalidatedFields.file?.message }}\n\t\t\t\t\t\t</p>\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t</CustomField>\n\t\t\t<div class=\"ui-form-row-inline\">\n\t\t\t\t<DropdownField\n\t\t\t\t\t:title=\"$Bitrix.Loc.getMessage('DATASET_IMPORT_FILE_ENCODING')\"\n\t\t\t\t\tname=\"encoding\"\n\t\t\t\t\t:options=\"encodings\"\n\t\t\t\t\t:default-value=\"defaultEncoding\"\n\t\t\t\t\t@value-change=\"onValueChange\"\n\t\t\t\t/>\n\t\t\t\t<DropdownField\n\t\t\t\t\t:title=\"$Bitrix.Loc.getMessage('DATASET_IMPORT_FILE_SEPARATOR')\"\n\t\t\t\t\tname=\"separator\"\n\t\t\t\t\t:options=\"separators\"\n\t\t\t\t\t:default-value=\"defaultSeparator\"\n\t\t\t\t\t@value-change=\"onValueChange\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<SliderButton @click=\"openDataFormatSlider\" />\n\t\t\t<SwitcherField\n\t\t\t\t:title=\"$Bitrix.Loc.getMessage('DATASET_IMPORT_FILE_FIRST_ROW_HEADER')\"\n\t\t\t\tname=\"firstLineHeader\"\n\t\t\t\t:default-value=\"defaultFirstLineHeader\"\n\t\t\t\t@value-change=\"onValueChange\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","import { FileUploader } from '../fields/file/file-uploader';\nimport type { FieldValueChangeEvent } from '../types/field-value-change-event';\nimport { BaseStep } from './base-step';\nimport { StepBlock } from '../layout/step-block';\n\nexport const FileStep = {\n\textends: BaseStep,\n\tprops: {\n\t\tencodings: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t\tseparators: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t\tdataFormatTemplates: {\n\t\t\ttype: Object,\n\t\t},\n\t},\n\tdata()\n\t{\n\t\treturn {\n\t\t\tfileProperties: this.$store.state.config.fileProperties,\n\t\t\tisErrorDisplayed: false,\n\t\t};\n\t},\n\temits: [\n\t\t'filePropertiesChange',\n\t\t'parsingOptionsChanged',\n\t],\n\tcomputed: {\n\t\tdefaultTitle()\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage('DATASET_IMPORT_FILE_HEADER');\n\t\t},\n\t\tdefaultHint()\n\t\t{\n\t\t\tif (this.isErrorDisplayed)\n\t\t\t{\n\t\t\t\treturn this.$Bitrix.Loc.getMessage('DATASET_IMPORT_FILE_HINT_ERROR');\n\t\t\t}\n\n\t\t\tif (this.isEditMode)\n\t\t\t{\n\t\t\t\treturn this.$Bitrix.Loc.getMessage('DATASET_IMPORT_FILE_HINT_EDIT')\n\t\t\t\t\t.replace('[link]', '<a onclick=\"top.BX.Helper.show(`redirect=detail&code=23378680`)\">')\n\t\t\t\t\t.replace('[/link]', '</a>')\n\t\t\t\t;\n\t\t\t}\n\n\t\t\treturn this.$Bitrix.Loc.getMessage('DATASET_IMPORT_FILE_HINT')\n\t\t\t\t.replace('[link]', '<a onclick=\"top.BX.Helper.show(`redirect=detail&code=23378680`)\">')\n\t\t\t\t.replace('[/link]', '</a>')\n\t\t\t;\n\t\t},\n\t\thintClass()\n\t\t{\n\t\t\treturn this.isErrorDisplayed ? 'ui-alert-danger' : 'ui-alert-primary';\n\t\t},\n\t\tisEditMode()\n\t\t{\n\t\t\treturn this.$store.getters.isEditMode;\n\t\t},\n\t\tunvalidatedFields()\n\t\t{\n\t\t\tconst result = {};\n\n\t\t\tconst fileValidationResult = this.validateFile();\n\t\t\tif (!fileValidationResult.result)\n\t\t\t{\n\t\t\t\tresult.file = fileValidationResult;\n\t\t\t}\n\n\t\t\treturn result;\n\t\t},\n\t},\n\tmethods: {\n\t\tonFilePropertiesChange(event: FieldValueChangeEvent)\n\t\t{\n\t\t\tif (event.fieldName === 'fileToken')\n\t\t\t{\n\t\t\t\tthis.isErrorDisplayed = false;\n\t\t\t}\n\n\t\t\tthis.fileProperties[event.fieldName] = event.newValue;\n\t\t\tthis.$store.commit('setFileProperties', this.fileProperties);\n\t\t\tif (event.fieldName !== 'fileName')\n\t\t\t{\n\t\t\t\tthis.$emit('filePropertiesChange');\n\t\t\t}\n\t\t\tthis.validate();\n\t\t},\n\t\tonUploadError()\n\t\t{\n\t\t\tthis.isErrorDisplayed = true;\n\t\t},\n\t\tonParsingOptionsChanged()\n\t\t{\n\t\t\tthis.$emit('parsingOptionsChanged');\n\t\t},\n\t\tvalidate()\n\t\t{\n\t\t\tlet result = true;\n\t\t\tif (!this.isEditMode)\n\t\t\t{\n\t\t\t\tresult = Object.keys(this.unvalidatedFields).length === 0;\n\t\t\t}\n\n\t\t\tthis.$emit('validation', result);\n\n\t\t\treturn result;\n\t\t},\n\t\tvalidateFile()\n\t\t{\n\t\t\tif (!this.isEditMode && !this.$store.state.config.fileProperties.fileToken)\n\t\t\t{\n\t\t\t\treturn {\n\t\t\t\t\tresult: false,\n\t\t\t\t\tmessage: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_FILE_NOT_SELECTED'),\n\t\t\t\t};\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tresult: true,\n\t\t\t};\n\t\t},\n\t\tshowValidationErrors()\n\t\t{\n\t\t\tthis.$refs.fileUploader.showValidationErrors();\n\t\t},\n\t},\n\tcomponents: {\n\t\tStep: StepBlock,\n\t\tFileUploader,\n\t},\n\ttemplate: `\n\t\t<Step\n\t\t\t:title=\"displayedTitle\"\n\t\t\t:hint=\"displayedHint\"\n\t\t\t:is-open-initially=\"isOpenInitially\"\n\t\t\t:disabled=\"disabled\"\n\t\t\t:hint-class=\"hintClass\"\n\t\t\tref=\"stepBlock\"\n\t\t>\n\t\t\t<FileUploader\n\t\t\t\t@value-change=\"onFilePropertiesChange\"\n\t\t\t\t@upload-error=\"onUploadError\"\n\t\t\t\t@parsing-options-changed=\"onParsingOptionsChanged\"\n\t\t\t\tref=\"fileUploader\"\n\t\t\t\t:encodings=\"encodings\"\n\t\t\t\t:separators=\"separators\"\n\t\t\t\t:default-encoding=\"fileProperties.encoding\"\n\t\t\t\t:default-first-line-header=\"fileProperties.firstLineHeader\"\n\t\t\t\t:default-separator=\"fileProperties.separator\"\n\t\t\t\t:is-edit-mode=\"isEditMode\"\n\t\t\t\t:unvalidated-fields=\"unvalidatedFields\"\n\t\t\t\t:data-format-templates=\"dataFormatTemplates\"\n\t\t\t/>\n\t\t</Step>\n\t`,\n};\n","import { StepBlock } from './step-block';\n\nexport const AppSection = {\n\tprops: {\n\t\ttitle: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t},\n\t\tcustomClasses: {\n\t\t\ttype: Array,\n\t\t\trequired: false,\n\t\t},\n\t},\n\tcomponents: {\n\t\tStep: StepBlock,\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<Step\n\t\t\t:title=\"title\"\n\t\t\t:can-collapse=\"false\"\n\t\t\t:custom-classes=\"customClasses\"\n\t\t>\n\t\t\t<slot></slot>\n\t\t</Step>\n\t`,\n};\n","import '../../css/dataset-preview-table.css';\n\nexport const TableHeader = {\n\tprops: {\n\t\theaders: {\n\t\t\ttype: Array,\n\t\t\trequired: false,\n\t\t\tdefault: [],\n\t\t},\n\t\tcolumnVisibility: {\n\t\t\ttype: Array,\n\t\t\trequired: false,\n\t\t\tdefault: [],\n\t\t},\n\t},\n\tcomputed: {\n\t\tvisibleHeaders()\n\t\t{\n\t\t\treturn this.headers.filter((_, index) => this.columnVisibility[index]);\n\t\t},\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<thead>\n\t\t\t<tr class=\"dataset-preview-table__header-row\">\n\t\t\t\t<th class=\"dataset-preview-table__header\" v-for=\"header in visibleHeaders\" :title=\"header\">{{ header }}</th>\n\t\t\t</tr>\n\t\t</thead>\n\t`,\n};\n","import '../../css/dataset-preview-table.css';\n\nexport const TableRow = {\n\tprops: {\n\t\trow: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t\tcolumnVisibility: {\n\t\t\ttype: Array,\n\t\t\trequired: false,\n\t\t\tdefault: [],\n\t\t},\n\t},\n\tcomputed: {\n\t\tvisibleValues()\n\t\t{\n\t\t\treturn this.row.filter((_, index) => this.columnVisibility[index]);\n\t\t},\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<tr>\n\t\t\t<td class=\"dataset-preview-table__cell\" v-for=\"value in visibleValues\" :title=\"value\">{{ value }}</td>\n\t\t</tr>\n\t`,\n};\n","import '../../css/dataset-preview-table.css';\nimport { Ears } from 'ui.ears';\nimport { TableHeader } from './table-header';\nimport { TableRow } from './table-row';\nimport { Dom, debounce } from 'main.core';\n\nexport const PreviewTable = {\n\tprops: {\n\t\theaders: {\n\t\t\ttype: Array,\n\t\t\trequired: false,\n\t\t\tdefault: [],\n\t\t},\n\t\trows: {\n\t\t\ttype: Array,\n\t\t\trequired: false,\n\t\t\tdefault: [],\n\t\t},\n\t\tcolumnVisibility: {\n\t\t\ttype: Array,\n\t\t\trequired: false,\n\t\t\tdefault: [],\n\t\t},\n\t},\n\tdata()\n\t{\n\t\treturn {\n\t\t\tdisplayedColumnVisibility: this.columnVisibility,\n\t\t\tdebouncedRefresh: debounce(this.refreshColumns, 1000),\n\t\t};\n\t},\n\tmounted()\n\t{\n\t\tconst ears = new Ears({\n\t\t\tcontainer: document.querySelector('.dataset-preview-table'),\n\t\t\tsmallSize: true,\n\t\t\tnoScrollbar: false,\n\t\t});\n\n\t\tears.init();\n\t},\n\tmethods: {\n\t\trefreshColumns(newVisibility)\n\t\t{\n\t\t\tthis.displayedColumnVisibility = newVisibility;\n\t\t\tDom.removeClass(this.$refs.table, 'dataset-preview-table--fade');\n\t\t},\n\t},\n\twatch: {\n\t\tcolumnVisibility(newValue, oldValue)\n\t\t{\n\t\t\tDom.addClass(this.$refs.table, 'dataset-preview-table--fade');\n\t\t\tthis.debouncedRefresh(newValue);\n\t\t},\n\t},\n\tcomponents: {\n\t\tTableHeader,\n\t\tTableRow,\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"dataset-preview-table\" ref=\"table\">\n\t\t\t<table class=\"dataset-preview-table__table\">\n\t\t\t\t<TableHeader v-if=\"headers.length > 0\" :headers=\"headers\" :column-visibility=\"displayedColumnVisibility\" />\n\t\t\t\t<tbody>\n\t\t\t\t\t<TableRow v-for=\"row in rows\" :row=\"row\" :column-visibility=\"displayedColumnVisibility\" />\n\t\t\t\t</tbody>\n\t\t\t</table>\n\t\t</div>\n\t`,\n};\n","import { Loader } from 'main.loader';\nimport { AppSection } from '../layout/app-section';\nimport '../css/import-preview.css';\nimport { PreviewTable } from './import-preview/preview-table';\n\nexport const ImportPreview = {\n\tcomponents: {\n\t\tAppSection,\n\t\tPreviewTable,\n\t},\n\tprops: {\n\t\temptyStateText: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: null,\n\t\t},\n\t\terror: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t\tisLoading: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\tcomputed: {\n\t\tisEditMode(): boolean\n\t\t{\n\t\t\treturn this.$store.getters.isEditMode;\n\t\t},\n\t\theaders()\n\t\t{\n\t\t\treturn this.$store.getters.previewHeaders;\n\t\t},\n\t\trows()\n\t\t{\n\t\t\treturn this.$store.state.previewData.rows;\n\t\t},\n\t\tisEverythingHidden()\n\t\t{\n\t\t\treturn this.headers.length > 0 && this.$store.getters.areNoRowsVisible;\n\t\t},\n\t\thasData()\n\t\t{\n\t\t\treturn this.$store.getters.hasData;\n\t\t},\n\t\thasHeaders(): boolean\n\t\t{\n\t\t\treturn this.headers.length > 0;\n\t\t},\n\t\tdisplayedEmptyStateText()\n\t\t{\n\t\t\treturn this.emptyStateText ?? this.$Bitrix.Loc.getMessage('DATASET_IMPORT_PREVIEW_EMPTY_STATE');\n\t\t},\n\t\tdisplayedEverythingHiddenText()\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage('DATASET_IMPORT_PREVIEW_EVERYTHING_HIDDEN');\n\t\t},\n\t\tcolumnVisibility()\n\t\t{\n\t\t\treturn this.$store.getters.columnVisibilityMap;\n\t\t},\n\t\tisErrorInEditMode()\n\t\t{\n\t\t\treturn this.hasData && this.error && this.isEditMode;\n\t\t},\n\t\tisEditModeInitialDataDisplayed()\n\t\t{\n\t\t\treturn this.isEditMode && !this.$store.state.config.fileProperties.fileToken;\n\t\t},\n\t\tdisplayedTitle()\n\t\t{\n\t\t\treturn this.isEditModeInitialDataDisplayed\n\t\t\t\t? this.$Bitrix.Loc.getMessage('DATASET_IMPORT_INITIAL_DATA_PREVIEW_TITLE')\n\t\t\t\t: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_PREVIEW_TITLE')\n\t\t\t;\n\t\t},\n\t\thasDataDisplayedHint()\n\t\t{\n\t\t\treturn this.isEditModeInitialDataDisplayed\n\t\t\t\t? this.$Bitrix.Loc.getMessage('DATASET_IMPORT_INITIAL_DATA_PREVIEW_HINT')\n\t\t\t\t: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_PREVIEW_HINT')\n\t\t\t;\n\t\t},\n\t},\n\twatch: {\n\t\tisLoading(newValue)\n\t\t{\n\t\t\tif (this.loader)\n\t\t\t{\n\t\t\t\tthis.loader.destroy();\n\t\t\t}\n\n\t\t\tif (newValue)\n\t\t\t{\n\t\t\t\tthis.loader = new Loader({\n\t\t\t\t\ttarget: this.$refs.loadingAnchor,\n\t\t\t\t\tsize: 77,\n\t\t\t\t\tcolor: 'var(--ui-color-primary)',\n\t\t\t\t\tstrokeWidth: 4,\n\t\t\t\t});\n\t\t\t\tthis.loader.show();\n\t\t\t}\n\t\t},\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<AppSection\n\t\t\t:title=\"displayedTitle\"\n\t\t\t:custom-classes=\"['dataset-import-step--full-height', 'dataset-import-step--sticky', 'import-preview']\"\n\t\t>\n\t\t\t<div class=\"import-preview__loading\" ref=\"loadingAnchor\"></div>\n\t\t\t<template v-if=\"!isLoading\">\n\t\t\t\t<template v-if=\"error\">\n\t\t\t\t\t<div class=\"import-preview__no-data\" v-if=\"isEverythingHidden\">\n\t\t\t\t\t\t<div class=\"import-preview__no-data-logo\"></div>\n\t\t\t\t\t\t<p class=\"import-preview__no-data-text\">{{ displayedEverythingHiddenText }}</p>\n\t\t\t\t\t</div>\n\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t<div class=\"import-preview__has-data import-preview__has-data--edit-mode-error\" v-if=\"isEditMode\">\n\t\t\t\t\t\t\t<span class=\"import-preview__hint\">{{ $Bitrix.Loc.getMessage('DATASET_IMPORT_PREVIEW_HINT') }}</span>\n\t\t\t\t\t\t\t<PreviewTable\n\t\t\t\t\t\t\t\t:headers=\"headers\"\n\t\t\t\t\t\t\t\t:column-visibility=\"columnVisibility\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<div class=\"import-preview__edit-mode-error\">\n\t\t\t\t\t\t\t\t<div class=\"import-preview__error-logo\"></div>\n\t\t\t\t\t\t\t\t<p class=\"import-preview__no-data-text\">{{ error }}</p>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"import-preview__has-data\" v-else>\n\t\t\t\t\t\t\t<span class=\"import-preview__hint\">{{ $Bitrix.Loc.getMessage('DATASET_IMPORT_PREVIEW_HINT') }}</span>\n\t\t\t\t\t\t\t<PreviewTable\n\t\t\t\t\t\t\t\t:headers=\"headers\"\n\t\t\t\t\t\t\t\t:column-visibility=\"columnVisibility\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<div class=\"import-preview__edit-mode-error\">\n\t\t\t\t\t\t\t\t<div class=\"import-preview__error-logo\"></div>\n\t\t\t\t\t\t\t\t<p class=\"import-preview__no-data-text\">{{ error }}</p>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</template>\n\t\t\t\t</template>\n\t\t\t\t<template v-else>\n\t\t\t\t\t<div class=\"import-preview__no-data\" v-if=\"isEverythingHidden\">\n\t\t\t\t\t\t<div class=\"import-preview__no-data-logo\"></div>\n\t\t\t\t\t\t<p class=\"import-preview__no-data-text\">{{ displayedEverythingHiddenText }}</p>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"import-preview__has-data\" v-else-if=\"hasData\">\n\t\t\t\t\t\t<span class=\"import-preview__hint\">{{ hasDataDisplayedHint }}</span>\n\t\t\t\t\t\t<PreviewTable\n\t\t\t\t\t\t\t:headers=\"headers\"\n\t\t\t\t\t\t\t:rows=\"rows\"\n\t\t\t\t\t\t\t:column-visibility=\"columnVisibility\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"import-preview__has-data\" v-else-if=\"hasHeaders\">\n\t\t\t\t\t\t<PreviewTable\n\t\t\t\t\t\t\t:headers=\"headers\"\n\t\t\t\t\t\t\t:column-visibility=\"columnVisibility\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<div class=\"import-preview__edit-mode-error\">\n\t\t\t\t\t\t\t<div class=\"import-preview__no-data-logo\"></div>\n\t\t\t\t\t\t\t<p class=\"import-preview__no-data-text\">{{ displayedEmptyStateText }}</p>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"import-preview__no-data\" v-else>\n\t\t\t\t\t\t<div class=\"import-preview__no-data-logo\"></div>\n\t\t\t\t\t\t<p class=\"import-preview__no-data-text\">{{ displayedEmptyStateText }}</p>\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t</template>\n\t\t</AppSection>\n\t`,\n};\n","import { ajax as Ajax, Tag, Type } from 'main.core';\nimport { Popup as MainPopup, PopupManager } from 'main.popup';\nimport type { AnalyticsOptions } from 'ui.analytics';\nimport { sendData } from 'ui.analytics';\nimport { SidePanel } from 'ui.sidepanel';\nimport { Button, ButtonColor } from 'ui.buttons';\n\n// language=Vue\nexport const BaseApp = {\n\tprops: {\n\t\tappParams: {\n\t\t\ttype: Object,\n\t\t\trequired: false,\n\t\t\tdefault: {},\n\t\t},\n\t},\n\tdata()\n\t{\n\t\treturn {\n\t\t\tsteps: {},\n\t\t\tshownPopups: {},\n\t\t\tisChanged: false,\n\t\t\tisSaveComplete: false,\n\t\t\tlastChangedStep: null,\n\t\t};\n\t},\n\tcomputed: {\n\t\tsourceCode()\n\t\t{\n\t\t\treturn '';\n\t\t},\n\t\tloadParams()\n\t\t{\n\t\t\treturn {};\n\t\t},\n\t\tsaveParams()\n\t\t{\n\t\t\treturn {};\n\t\t},\n\t\tisEditMode()\n\t\t{\n\t\t\treturn false;\n\t\t},\n\t\tdatasetId()\n\t\t{\n\t\t\treturn this.$store.state.config.datasetProperties.id;\n\t\t},\n\t\tisSaveEnabled(): boolean\n\t\t{\n\t\t\treturn !(this.$store.getters.areNoRowsVisible) && this.isValidatedForSave && !this.previewError;\n\t\t},\n\t\tisValidatedForSave(): boolean\n\t\t{\n\t\t\treturn true;\n\t\t},\n\t\tunsavedChangesPopupTitle(): string\n\t\t{\n\t\t\treturn this.isEditMode\n\t\t\t\t? this.$Bitrix.Loc.getMessage('DATASET_IMPORT_UNSAVED_CHANGES_TITLE_EDIT')\n\t\t\t\t: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_UNSAVED_CHANGES_TITLE')\n\t\t\t;\n\t\t},\n\t\tunsavedChangesPopupText(): string\n\t\t{\n\t\t\treturn this.isEditMode\n\t\t\t\t? this.$Bitrix.Loc.getMessage('DATASET_IMPORT_UNSAVED_CHANGES_TEXT_EDIT')\n\t\t\t\t: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_UNSAVED_CHANGES_TEXT')\n\t\t\t;\n\t\t},\n\t},\n\tmounted()\n\t{\n\t\tthis.$Bitrix.eventEmitter.subscribe('biconnector:dataset-import:createButtonClick', this.onSaveButtonClick);\n\t\tthis.$Bitrix.eventEmitter.subscribe('biconnector:dataset-import:cancelButtonClick', this.onCancelButtonClick);\n\n\t\tconst slider = SidePanel.Instance.getTopSlider();\n\t\tif (slider)\n\t\t{\n\t\t\ttop.BX.addCustomEvent(slider, 'SidePanel.Slider:onClose', this.onSliderClose);\n\n\t\t\taddEventListener('beforeunload', (event) => {\n\t\t\t\ttop.BX.removeCustomEvent(slider, 'SidePanel.Slider:onClose', this.onSliderClose);\n\t\t\t});\n\t\t}\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.$Bitrix.eventEmitter.unsubscribe('biconnector:dataset-import:createButtonClick', this.onSaveButtonClick);\n\t\tthis.$Bitrix.eventEmitter.unsubscribe('biconnector:dataset-import:cancelButtonClick', this.onCancelButtonClick);\n\t},\n\tmethods: {\n\t\tmarkAsChanged()\n\t\t{\n\t\t\tthis.isChanged = true;\n\t\t},\n\t\tonSliderClose(event)\n\t\t{\n\t\t\tif (!this.isChanged)\n\t\t\t{\n\t\t\t\tif (!this.isSaveComplete)\n\t\t\t\t{\n\t\t\t\t\tthis.sendAnalytics({\n\t\t\t\t\t\tevent: this.isEditMode ? 'edit_end' : 'creation_end',\n\t\t\t\t\t\tstatus: 'error',\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tevent.denyAction();\n\n\t\t\tif (PopupManager.getPopupById('unsaved'))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst continueButton = new Button({\n\t\t\t\tcolor: ButtonColor.PRIMARY,\n\t\t\t\ttext: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_CONTINUE_IMPORT'),\n\t\t\t\tevents: {\n\t\t\t\t\tclick() {\n\t\t\t\t\t\tpopup.destroy();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t});\n\n\t\t\tconst closeButton = new Button({\n\t\t\t\tcolor: ButtonColor.LINK,\n\t\t\t\ttext: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_CONFIRM_CANCEL_IMPORT'),\n\t\t\t\tevents: {\n\t\t\t\t\tclick: () => {\n\t\t\t\t\t\tthis.isChanged = false;\n\t\t\t\t\t\tthis.closeApp();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t});\n\n\t\t\tconst popupHeader = this.unsavedChangesPopupTitle;\n\t\t\tconst popupText = this.unsavedChangesPopupText;\n\n\t\t\tconst popup = new MainPopup({\n\t\t\t\tid: 'unsaved',\n\t\t\t\tcontent: Tag.render`\n\t\t\t\t\t<div class=\"generic-popup\">\n\t\t\t\t\t\t<h3 class=\"generic-popup__header\">${popupHeader}</h3>\n\t\t\t\t\t\t<div class=\"generic-popup__content\">\n\t\t\t\t\t\t\t${popupText}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"generic-popup__buttons-wrapper\">\n\t\t\t\t\t\t\t${continueButton.render()}\n\t\t\t\t\t\t\t${closeButton.render()}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t`,\n\t\t\t\twidth: 440,\n\t\t\t\tnoAllPaddings: true,\n\t\t\t\tautoHide: false,\n\t\t\t\tfixed: true,\n\t\t\t\toverlay: true,\n\t\t\t});\n\n\t\t\tpopup.show();\n\t\t},\n\t\tcloseApp()\n\t\t{\n\t\t\tSidePanel.Instance.getTopSlider().close();\n\t\t},\n\t\ttoggleStepState(step: string, disabled: ?boolean = null)\n\t\t{\n\t\t\tif (!this.steps[step])\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (Type.isNull(disabled))\n\t\t\t{\n\t\t\t\tthis.steps[step].disabled = !Boolean(this.steps[step].disabled);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.steps[step].disabled = disabled;\n\t\t\t}\n\t\t},\n\t\ttogglePopup(step: string, shown: ?boolean = null)\n\t\t{\n\t\t\tif (Type.isNull(shown))\n\t\t\t{\n\t\t\t\tthis.shownPopups[step] = !Boolean(this.shownPopups[step]);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.shownPopups[step] = shown;\n\t\t\t}\n\t\t},\n\t\tloadDataset()\n\t\t{\n\t\t\tAjax.runAction('biconnector.externalsource.dataset.view', {\n\t\t\t\tdata: {\n\t\t\t\t\ttype: this.sourceCode,\n\t\t\t\t\tfields: this.loadParams,\n\t\t\t\t},\n\t\t\t})\n\t\t\t\t.then((response) => {\n\t\t\t\t\tthis.onLoadSuccess(response);\n\t\t\t\t})\n\t\t\t\t.catch((error) => {\n\t\t\t\t\tthis.onLoadError(error);\n\t\t\t\t});\n\t\t},\n\t\tonStepValidation(step, validationResult)\n\t\t{\n\t\t\tif (!this.steps[step])\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.steps[step].valid = validationResult;\n\t\t},\n\t\tonSaveButtonClick()\n\t\t{\n\t\t\tif (!this.onSaveStart())\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.isEditMode)\n\t\t\t{\n\t\t\t\tthis.updateDataset();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.saveDataset();\n\t\t\t}\n\t\t},\n\t\tonCancelButtonClick()\n\t\t{\n\t\t\tthis.closeApp();\n\t\t},\n\t\tsaveDataset()\n\t\t{\n\t\t\tAjax.runAction('biconnector.externalsource.dataset.add', {\n\t\t\t\tdata: {\n\t\t\t\t\ttype: this.sourceCode,\n\t\t\t\t\tfields: this.saveParams,\n\t\t\t\t},\n\t\t\t})\n\t\t\t\t.then((response) => {\n\t\t\t\t\tthis.onSaveEnd(response);\n\t\t\t\t})\n\t\t\t\t.catch((error) => {\n\t\t\t\t\tthis.onSaveError();\n\t\t\t\t});\n\t\t},\n\t\tupdateDataset()\n\t\t{\n\t\t\tAjax.runAction('biconnector.externalsource.dataset.update', {\n\t\t\t\tdata: {\n\t\t\t\t\tid: this.datasetId,\n\t\t\t\t\ttype: this.sourceCode,\n\t\t\t\t\tfields: this.saveParams,\n\t\t\t\t},\n\t\t\t})\n\t\t\t\t.then((response) => {\n\t\t\t\t\tthis.onSaveEnd(response);\n\t\t\t\t})\n\t\t\t\t.catch((error) => {\n\t\t\t\t\tthis.onSaveError();\n\t\t\t\t});\n\t\t},\n\t\tonSaveStart()\n\t\t{\n\t\t\treturn true;\n\t\t},\n\t\tonSaveEnd()\n\t\t{\n\t\t},\n\t\tonSaveError()\n\t\t{\n\t\t},\n\t\tonLoadStart()\n\t\t{\n\t\t},\n\t\tonLoadSuccess(response)\n\t\t{\n\t\t},\n\t\tonLoadError(response)\n\t\t{\n\t\t},\n\t\treload()\n\t\t{\n\t\t\twindow.location.reload();\n\t\t},\n\t\tsendAnalytics(params: AnalyticsOptions)\n\t\t{\n\t\t\tif (this.sourceCode)\n\t\t\t{\n\t\t\t\tsendData({\n\t\t\t\t\t...this.getBaseAnalyticsParams(),\n\t\t\t\t\t...params,\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\tgetBaseAnalyticsParams()\n\t\t{\n\t\t\treturn {\n\t\t\t\ttool: 'BI_Builder',\n\t\t\t\tc_section: 'BI_Builder',\n\t\t\t\tcategory: this.sourceCode.toUpperCase(),\n\t\t\t};\n\t\t},\n\t},\n};\n","import { AppLayout } from '../layout/app-layout';\nimport { ImportConfig } from '../layout/import-config';\nimport { GenericPopup } from '../popups/generic-popup';\nimport { ImportFailurePopup } from '../popups/saving/import-failure-popup';\nimport { ImportProgressPopup } from '../popups/saving/import-progress-popup';\nimport { ImportSuccessPopup } from '../popups/saving/import-success-popup';\nimport { DatasetPropertiesStep } from '../steps/dataset-properties';\nimport { FieldsSettingsStep } from '../steps/fields-settings';\nimport { FileStep } from '../steps/file';\nimport { ImportPreview } from '../steps/import-preview';\nimport { BaseApp } from './base-app';\n\nexport const CsvApp = {\n\textends: BaseApp,\n\tdata()\n\t{\n\t\treturn {\n\t\t\tsteps: {\n\t\t\t\tfile: {\n\t\t\t\t\tdisabled: false,\n\t\t\t\t\tvalid: this.$store.getters.isEditMode,\n\t\t\t\t},\n\t\t\t\tproperties: {\n\t\t\t\t\tdisabled: !this.$store.getters.isEditMode,\n\t\t\t\t\tvalid: true,\n\t\t\t\t},\n\t\t\t\tfields: {\n\t\t\t\t\tdisabled: !this.$store.getters.isEditMode,\n\t\t\t\t\tvalid: true,\n\t\t\t\t},\n\t\t\t},\n\t\t\tshownPopups: {\n\t\t\t\tsavingProgress: false,\n\t\t\t\tsavingSuccess: false,\n\t\t\t\tsavingFailure: false,\n\t\t\t\teditModeFileReplacement: false,\n\t\t\t},\n\t\t\tisValidationComplete: true,\n\t\t\tpopupParams: {\n\t\t\t\tsavingSuccess: {},\n\t\t\t},\n\t\t\tlastReloadSource: null,\n\t\t\tinitialPreviewData: {},\n\t\t\tinitialFieldsSettings: [],\n\t\t\tpreviewError: '',\n\t\t\tisEditModeSaveConfirmed: false,\n\t\t\tisDataLoadingAnimationDisplayed: false,\n\t\t\thasMinimalLoadingAnimationTimePassed: true,\n\t\t};\n\t},\n\tcomputed: {\n\t\tsourceCode()\n\t\t{\n\t\t\treturn 'csv';\n\t\t},\n\t\tisEditMode()\n\t\t{\n\t\t\treturn this.$store.getters.isEditMode;\n\t\t},\n\t\tloadParams()\n\t\t{\n\t\t\treturn {\n\t\t\t\tfileProperties: this.$store.state.config.fileProperties,\n\t\t\t\tdatasetProperties: this.$store.state.config.datasetProperties,\n\t\t\t\tfieldsSettings: this.$store.state.config.fieldsSettings,\n\t\t\t\tdataFormats: this.$store.state.config.dataFormats,\n\t\t\t};\n\t\t},\n\t\tsaveParams()\n\t\t{\n\t\t\treturn {\n\t\t\t\tfileProperties: this.$store.state.config.fileProperties,\n\t\t\t\tdatasetProperties: this.$store.state.config.datasetProperties,\n\t\t\t\tfieldsSettings: this.$store.state.config.fieldsSettings,\n\t\t\t\tdataFormats: this.$store.state.config.dataFormats,\n\t\t\t};\n\t\t},\n\t\tdatasetId()\n\t\t{\n\t\t\treturn this.$store.state.config.datasetProperties.id;\n\t\t},\n\t\tisValidatedForSave()\n\t\t{\n\t\t\treturn this.steps.fields.valid && this.steps.properties.valid && this.steps.file.valid;\n\t\t},\n\t\timportFailurePopupTitle()\n\t\t{\n\t\t\treturn this.isEditMode ? this.$Bitrix.Loc.getMessage('DATASET_IMPORT_FAILURE_POPUP_HEADER_EDIT') : this.$Bitrix.Loc.getMessage('DATASET_IMPORT_FAILURE_POPUP_HEADER');\n\t\t},\n\t\timportSuccessPopupTitle()\n\t\t{\n\t\t\treturn this.isEditMode\n\t\t\t\t? this.$Bitrix.Loc.getMessage('DATASET_IMPORT_SUCCESS_POPUP_HEADER_EDIT').replace('#DATASET_TITLE#', this.popupParams.savingSuccess.title)\n\t\t\t\t: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_SUCCESS_POPUP_HEADER').replace('#DATASET_TITLE#', this.popupParams.savingSuccess.title);\n\t\t},\n\t\timportSuccessPopupDescription()\n\t\t{\n\t\t\treturn this.$store.state.config.fileProperties.fileName\n\t\t\t\t? this.$Bitrix.Loc.getMessage('DATASET_IMPORT_SUCCESS_POPUP_DESCRIPTION').replace('#FILE_NAME#', this.popupParams.savingSuccess.fileName)\n\t\t\t\t: '';\n\t\t},\n\t\timportProgressPopupDescription()\n\t\t{\n\t\t\treturn this.isEditMode\n\t\t\t\t? this.$Bitrix.Loc.getMessage('DATASET_IMPORT_PROGRESS_POPUP_DESCRIPTION_EDIT')\n\t\t\t\t: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_PROGRESS_POPUP_DESCRIPTION');\n\t\t},\n\t},\n\tmethods: {\n\t\tmarkAsChanged()\n\t\t{\n\t\t\tthis.isChanged = true;\n\t\t},\n\t\tonDatasetPropertiesChanged()\n\t\t{\n\t\t\tthis.markAsChanged();\n\t\t\tif (this.lastChangedStep !== 'properties')\n\t\t\t{\n\t\t\t\tthis.sendAnalytics({\n\t\t\t\t\tevent: this.isEditMode ? 'edit_start' : 'creation_start',\n\t\t\t\t\tc_element: 'step_2',\n\t\t\t\t\t...(this.isEditMode && { p1: `datasetName_${this.$store.state.config.datasetProperties.name.replaceAll('_', '')}`}),\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis.lastChangedStep = 'properties';\n\t\t},\n\t\tonFieldsSettingsChanged()\n\t\t{\n\t\t\tthis.markAsChanged();\n\t\t\tif (this.lastChangedStep !== 'fields')\n\t\t\t{\n\t\t\t\tthis.sendAnalytics({\n\t\t\t\t\tevent: this.isEditMode ? 'edit_start' : 'creation_start',\n\t\t\t\t\tc_element: 'step_3',\n\t\t\t\t\t...(this.isEditMode && { p1: `datasetName_${this.$store.state.config.datasetProperties.name.replaceAll('_', '')}`}),\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis.lastChangedStep = 'fields';\n\t\t},\n\t\tonDatasetReloadNeeded(reloadSource)\n\t\t{\n\t\t\tthis.markAsChanged();\n\t\t\tthis.previewError = '';\n\t\t\tthis.lastReloadSource = reloadSource;\n\n\t\t\tif (this.$store.state.config.fileProperties.fileToken)\n\t\t\t{\n\t\t\t\tif (reloadSource === 'file')\n\t\t\t\t{\n\t\t\t\t\tthis.lastChangedStep = 'file';\n\n\t\t\t\t\tthis.sendAnalytics({\n\t\t\t\t\t\tevent: this.isEditMode ? 'edit_start' : 'creation_start',\n\t\t\t\t\t\tc_element: 'step_1',\n\t\t\t\t\t\t...(this.isEditMode && { p1: `datasetName_${this.$store.state.config.datasetProperties.name.replaceAll('_', '')}` }),\n\t\t\t\t\t});\n\n\t\t\t\t\tthis.startPreviewLoadingAnimation();\n\t\t\t\t}\n\n\t\t\t\tthis.loadDataset();\n\t\t\t}\n\t\t\telse if (this.isEditMode)\n\t\t\t{\n\t\t\t\tthis.$store.commit('setPreviewData', this.initialPreviewData);\n\t\t\t\tthis.$store.commit('setFieldsSettings', this.initialFieldsSettings);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.$store.commit('setPreviewData', []);\n\t\t\t\tthis.$refs.propertiesStep.close();\n\t\t\t\tthis.$refs.fieldsStep.close();\n\t\t\t\tthis.toggleStepState('properties', true);\n\t\t\t\tthis.toggleStepState('fields', true);\n\t\t\t}\n\t\t},\n\t\tprocessLoadResponse(response)\n\t\t{\n\t\t\tconst responseData = response.data;\n\n\t\t\tif (!responseData || responseData.data.length === 0)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.lastReloadSource === 'file' && !this.isEditMode)\n\t\t\t{\n\t\t\t\tconst headers = [];\n\t\t\t\tresponseData.headers.forEach((header, index) => {\n\t\t\t\t\theaders.push(this.prepareHeader(header, index));\n\t\t\t\t});\n\n\t\t\t\tthis.$store.commit('setFieldsSettings', headers);\n\t\t\t}\n\t\t\tthis.$store.commit('setPreviewData', responseData.data);\n\t\t},\n\t\tprepareHeader(header, index)\n\t\t{\n\t\t\treturn {\n\t\t\t\tvisible: true,\n\t\t\t\ttype: header.type,\n\t\t\t\tname: header.name && header.name.length > 0 ? header.name : `field_${index}`,\n\t\t\t\toriginalType: null,\n\t\t\t\toriginalName: header.externalCode,\n\t\t\t\texternalCode: header.externalCode,\n\t\t\t};\n\t\t},\n\t\tonLoadSuccess(response)\n\t\t{\n\t\t\tthis.stopPreviewLoadingAnimation();\n\t\t\tthis.processLoadResponse(response);\n\n\t\t\tthis.$refs.propertiesStep.open();\n\t\t\tthis.$refs.fieldsStep.open();\n\t\t\tthis.toggleStepState('properties', false);\n\t\t\tthis.toggleStepState('fields', false);\n\t\t\tthis.$refs.fieldsStep.validate();\n\t\t},\n\t\tonLoadError(response)\n\t\t{\n\t\t\tthis.stopPreviewLoadingAnimation();\n\t\t\tthis.previewError = response.errors[0]?.message ?? this.$Bitrix.Loc.getMessage('DATASET_IMPORT_PREVIEW_ERROR_FILE');\n\t\t},\n\t\tonSaveStart()\n\t\t{\n\t\t\tif (!this.isValidatedForSave)\n\t\t\t{\n\t\t\t\tthis.$refs.fileStep.showValidationErrors();\n\t\t\t\tthis.$refs.fieldsStep.showValidationErrors();\n\t\t\t\tthis.$refs.propertiesStep.showValidationErrors();\n\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (this.isEditMode && !this.isEditModeSaveConfirmed && this.$store.state.config.fileProperties.fileToken)\n\t\t\t{\n\t\t\t\tthis.togglePopup('editModeFileReplacement', true);\n\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tthis.togglePopup('savingProgress', true);\n\n\t\t\treturn true;\n\t\t},\n\t\tonSaveEnd(response)\n\t\t{\n\t\t\tconst datasetName = response.data.name ?? this.$store.state.config.datasetProperties.name;\n\t\t\tthis.popupParams.savingSuccess = {\n\t\t\t\ttitle: datasetName,\n\t\t\t\tdatasetId: response.data.id,\n\t\t\t\tfileName: this.$store.state.config.fileProperties.fileName,\n\t\t\t};\n\n\t\t\tthis.togglePopup('savingProgress', false);\n\t\t\tthis.togglePopup('savingSuccess', true);\n\t\t\tthis.isChanged = false;\n\t\t\tthis.isSaveComplete = true;\n\t\t\tBX.SidePanel.Instance.postMessage(window, 'BIConnector.dataset-import:onDatasetCreated', {});\n\t\t\tthis.sendAnalytics({\n\t\t\t\tevent: this.isEditMode ? 'edit_end' : 'creation_end',\n\t\t\t\tstatus: 'success',\n\t\t\t\tp1: `datasetName_${datasetName.replaceAll('_', '')}`,\n\t\t\t});\n\t\t},\n\t\tonSaveError()\n\t\t{\n\t\t\tthis.togglePopup('savingProgress', false);\n\t\t\tthis.togglePopup('savingFailure', true);\n\t\t\tBX.SidePanel.Instance.postMessage(window, 'BIConnector.dataset-import:onDatasetCreated', {});\n\n\t\t\tthis.sendAnalytics({\n\t\t\t\tevent: this.isEditMode ? 'edit_end' : 'creation_end',\n\t\t\t\tstatus: 'error',\n\t\t\t});\n\t\t},\n\t\tonSuccessPopupClose()\n\t\t{\n\t\t\tthis.togglePopup('savingSuccess', false);\n\t\t\tthis.closeApp();\n\t\t},\n\t\tcloseFailurePopup()\n\t\t{\n\t\t\tthis.togglePopup('savingFailure', false);\n\t\t},\n\t\tonReplacementButtonClick()\n\t\t{\n\t\t\tthis.isEditModeSaveConfirmed = true;\n\t\t\tthis.togglePopup('editModeFileReplacement', false);\n\t\t\tthis.onSaveButtonClick();\n\t\t},\n\t\tstartPreviewLoadingAnimation()\n\t\t{\n\t\t\tthis.isDataLoadingAnimationDisplayed = true;\n\t\t\tthis.hasMinimalLoadingAnimationTimePassed = false;\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.hasMinimalLoadingAnimationTimePassed = true;\n\t\t\t}, 1500);\n\t\t},\n\t\tstopPreviewLoadingAnimation()\n\t\t{\n\t\t\tthis.isDataLoadingAnimationDisplayed = false;\n\t\t},\n\t},\n\tmounted()\n\t{\n\t\tif (this.isEditMode)\n\t\t{\n\t\t\tthis.initialPreviewData = this.$store.state.previewData.rows;\n\t\t\tthis.initialFieldsSettings = this.$store.state.config.fieldsSettings;\n\t\t}\n\t},\n\tcomponents: {\n\t\tAppLayout,\n\t\tImportConfig,\n\t\tImportPreview,\n\t\tFileStep,\n\t\tDatasetPropertiesStep,\n\t\tFieldsSettingsStep,\n\t\tImportProgressPopup,\n\t\tImportSuccessPopup,\n\t\tImportFailurePopup,\n\t\tGenericPopup,\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<AppLayout :save-locked=\"!isSaveEnabled\" ref=\"appLayout\" :is-edit-mode=\"isEditMode\">\n\t\t\t<template v-slot:left-panel>\n\t\t\t\t<ImportConfig>\n\t\t\t\t\t<FileStep\n\t\t\t\t\t\t:separators=\"appParams.separators\"\n\t\t\t\t\t\t:encodings=\"appParams.encodings\"\n\t\t\t\t\t\t:disabled=\"steps.file.disabled\"\n\t\t\t\t\t\t:data-format-templates=\"appParams.dataFormatTemplates\"\n\t\t\t\t\t\tref=\"fileStep\"\n\t\t\t\t\t\t@validation=\"onStepValidation('file', $event)\"\n\t\t\t\t\t\t@file-properties-change=\"onDatasetReloadNeeded('file')\"\n\t\t\t\t\t\t@parsing-options-changed=\"onDatasetReloadNeeded('fields')\"\n\t\t\t\t\t/>\n\t\t\t\t\t<DatasetPropertiesStep\n\t\t\t\t\t\t:is-open-initially=\"isEditMode\"\n\t\t\t\t\t\t:disabled=\"steps.properties.disabled\"\n\t\t\t\t\t\t:reserved-names=\"appParams.reservedNames\"\n\t\t\t\t\t\tref=\"propertiesStep\"\n\t\t\t\t\t\t@validation=\"onStepValidation('properties', $event)\"\n\t\t\t\t\t\t@properties-changed=\"onDatasetPropertiesChanged\"\n\t\t\t\t\t\t:dataset-source-code=\"sourceCode\"\n\t\t\t\t\t/>\n\t\t\t\t\t<FieldsSettingsStep\n\t\t\t\t\t\t:is-open-initially=\"isEditMode\"\n\t\t\t\t\t\t:disabled=\"steps.fields.disabled\"\n\t\t\t\t\t\tref=\"fieldsStep\"\n\t\t\t\t\t\t@validation=\"onStepValidation('fields', $event)\"\n\t\t\t\t\t\t@parsing-options-changed=\"onDatasetReloadNeeded('fields')\"\n\t\t\t\t\t\t@settings-changed=\"onFieldsSettingsChanged\"\n\t\t\t\t\t/>\n\t\t\t\t</ImportConfig>\n\t\t\t</template>\n\t\t\t<template v-slot:right-panel>\n\t\t\t\t<ImportPreview \n\t\t\t\t\t:error=\"previewError\"\n\t\t\t\t\t:is-loading=\"isDataLoadingAnimationDisplayed || !hasMinimalLoadingAnimationTimePassed\"\n\t\t\t\t/>\n\t\t\t</template>\n\t\t</AppLayout>\n\n\t\t<ImportProgressPopup\n\t\t\tv-if=\"shownPopups.savingProgress\"\n\t\t\t:description=\"importProgressPopupDescription\"\n\t\t/>\n\n\t\t<ImportSuccessPopup\n\t\t\tv-if=\"shownPopups.savingSuccess\"\n\t\t\t@close=\"onSuccessPopupClose\"\n\t\t\t@click=\"closeApp\"\n\t\t\t@one-more-click=\"reload\"\n\t\t\t:title=\"importSuccessPopupTitle\"\n\t\t\t:description=\"importSuccessPopupDescription\"\n\t\t\t:dataset-id=\"popupParams.savingSuccess.datasetId\"\n\t\t\t:show-more-button=\"!isEditMode\"\n\t\t/>\n\n\t\t<ImportFailurePopup\n\t\t\tv-if=\"shownPopups.savingFailure\"\n\t\t\t@close=\"closeFailurePopup\"\n\t\t\t@click=\"closeFailurePopup\"\n\t\t\t:title=\"importFailurePopupTitle\"\n\t\t\t:description=\"$Bitrix.Loc.getMessage('DATASET_IMPORT_FAILURE_POPUP_DESCRIPTION').replace('[link]', '<a>').replace('[/link]', '</a>')\"\n\t\t/>\n\n\t\t<GenericPopup\n\t\t\tv-if=\"shownPopups.editModeFileReplacement\"\n\t\t\t:title=\"$Bitrix.Loc.getMessage('DATASET_IMPORT_FILE_REPLACEMENT_TITLE')\"\n\t\t\t@close=\"togglePopup('editModeFileReplacement', false)\"\n\t\t>\n\t\t\t<template v-slot:content>\n\t\t\t\t{{ $Bitrix.Loc.getMessage('DATASET_IMPORT_FILE_REPLACEMENT_TEXT') }}\n\t\t\t</template>\n\t\t\t<template v-slot:buttons>\n\t\t\t\t<button @click=\"onReplacementButtonClick\" class=\"ui-btn ui-btn-md ui-btn-primary\">{{\n\t\t\t\t\t$Bitrix.Loc.getMessage('DATASET_IMPORT_FILE_REPLACEMENT_LOAD') }}\n\t\t\t\t</button>\n\t\t\t\t<button @click=\"togglePopup('editModeFileReplacement', false)\"\n\t\t\t\t\t\tclass=\"ui-btn ui-btn-md ui-btn-light-border\">{{\n\t\t\t\t\t$Bitrix.Loc.getMessage('DATASET_IMPORT_FILE_REPLACEMENT_CANCEL') }}\n\t\t\t\t</button>\n\t\t\t</template>\n\t\t</GenericPopup>\n\t`,\n};\n","import { Dom, Event, Tag } from 'main.core';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\nimport { BaseField } from './base-field';\nimport { TagSelector } from 'ui.entity-selector';\nimport '../../css/entity-selector-field.css';\n\nexport const ConnectionSelectorField = {\n\textends: BaseField,\n\tprops: {\n\t\toptions: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\titems: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t\tconnectionId: {\n\t\t\ttype: Number,\n\t\t\trequired: false,\n\t\t},\n\t},\n\tmounted()\n\t{\n\t\tconst node = this.$refs['entity-selector'];\n\t\tconst selector = new TagSelector({\n\t\t\tid: this.options.selectorId,\n\t\t\tmultiple: false,\n\t\t\taddButtonCaption: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_CONNECTIONS_SELECT'),\n\t\t\taddButtonCaptionMore: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_CONNECTIONS_CHANGE'),\n\t\t\tdialogOptions: {\n\t\t\t\tid: this.options.selectorId,\n\t\t\t\titems: this.prepareItems(this.items),\n\t\t\t\tenableSearch: true,\n\t\t\t\tdropdownMode: true,\n\t\t\t\tshowAvatars: true,\n\t\t\t\tcompactView: false,\n\t\t\t\tmultiple: false,\n\t\t\t\twidth: 460,\n\t\t\t\theight: 420,\n\t\t\t\ttabs: [{\n\t\t\t\t\tid: 'connections',\n\t\t\t\t\tstubOptions: {\n\t\t\t\t\t\ttitle: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_NO_CONNECTIONS_TITLE'),\n\t\t\t\t\t\tsubtitle: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_NO_CONNECTIONS_SUBTITLE'),\n\t\t\t\t\t\tarrow: true,\n\t\t\t\t\t\ticon: '/bitrix/images/biconnector/database-connections/connections-empty-state.png',\n\t\t\t\t\t\ticonOpacity: 100,\n\t\t\t\t\t},\n\t\t\t\t}],\n\t\t\t\tentities: [{\n\t\t\t\t\tid: 'biconnector-external-connection',\n\t\t\t\t}],\n\t\t\t},\n\t\t\tevents: {\n\t\t\t\tonTagAdd: (event: BaseEvent) => {\n\t\t\t\t\tthis.$emit('valueChange', event);\n\t\t\t\t},\n\t\t\t\tonTagRemove: (event: BaseEvent) => {\n\t\t\t\t\tthis.$emit('valueClear', event);\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\t\tDom.addClass(selector.getDialog().getContainer(), 'biconnector-dataset-entity-selector');\n\t\tselector.renderTo(node);\n\n\t\tconst footer = Tag.render`\n\t\t\t<span class=\"ui-selector-footer-link ui-selector-footer-link-add\">\n\t\t\t\t${this.$Bitrix.Loc.getMessage('DATASET_IMPORT_NO_CONNECTIONS_FOOTER')}\n\t\t\t</span>\n\t\t`;\n\t\tEvent.bind(footer, 'click', () => {\n\t\t\tconst link = '/bitrix/components/bitrix/biconnector.externalconnection/slider.php';\n\t\t\tBX.SidePanel.Instance.open(link, {\n\t\t\t\twidth: 564,\n\t\t\t\tallowChangeHistory: false,\n\t\t\t\tcacheable: false,\n\t\t\t});\n\t\t});\n\t\tselector.getDialog().getTab(this.name).setFooter(footer);\n\n\t\tthis.selector = selector;\n\n\t\tEventEmitter.subscribe('SidePanel.Slider:onMessage', (event) => {\n\t\t\tconst [messageEvent] = event.getData();\n\t\t\tif (messageEvent.getEventId() === 'BIConnector:ExternalConnection:onConnectionCreated')\n\t\t\t{\n\t\t\t\tthis.addSelectedItem(messageEvent);\n\t\t\t}\n\t\t});\n\t},\n\tmethods: {\n\t\tprepareItems(items: Array): Array\n\t\t{\n\t\t\tconst selectorItems = [];\n\t\t\titems.forEach((item) => {\n\t\t\t\tconst itemOptions = {\n\t\t\t\t\tid: item.ID,\n\t\t\t\t\ttitle: item.TITLE,\n\t\t\t\t\tentityId: this.options.selectorId,\n\t\t\t\t\ttabs: this.name,\n\t\t\t\t\tlink: `/bitrix/components/bitrix/biconnector.externalconnection/slider.php?sourceId=${item.ID}`,\n\t\t\t\t\tlinkTitle: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_CONNECTIONS_ABOUT'),\n\t\t\t\t\tcustomData: {\n\t\t\t\t\t\tconnectionType: item.TYPE,\n\t\t\t\t\t},\n\t\t\t\t};\n\t\t\t\tif (item.TYPE)\n\t\t\t\t{\n\t\t\t\t\titemOptions.avatar = `/bitrix/images/biconnector/database-connections/${item.TYPE}.svg`;\n\t\t\t\t}\n\n\t\t\t\tif (this.connectionId)\n\t\t\t\t{\n\t\t\t\t\titemOptions.selected = item.ID === this.connectionId.toString();\n\t\t\t\t}\n\n\t\t\t\tselectorItems.push(itemOptions);\n\t\t\t});\n\n\t\t\treturn selectorItems;\n\t\t},\n\t\taddSelectedItem(event)\n\t\t{\n\t\t\tconst itemOptions: {id: number, name: string, type: string} = event.getData().connection;\n\t\t\tconst item = this.selector.getDialog().addItem({\n\t\t\t\tid: itemOptions.id,\n\t\t\t\ttitle: itemOptions.name,\n\t\t\t\tentityId: this.options.selectorId,\n\t\t\t\ttabs: this.name,\n\t\t\t\tlink: `/bitrix/components/bitrix/biconnector.externalconnection/slider.php?sourceId=${itemOptions.id}`,\n\t\t\t\tlinkTitle: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_CONNECTIONS_ABOUT'),\n\t\t\t\tavatar: `/bitrix/images/biconnector/database-connections/${itemOptions.type}.svg`,\n\t\t\t\tcustomData: {\n\t\t\t\t\tconnectionType: itemOptions.type,\n\t\t\t\t},\n\t\t\t});\n\n\t\t\tif (item)\n\t\t\t{\n\t\t\t\titem.select();\n\t\t\t}\n\t\t\tthis.selector.getDialog().hide();\n\t\t},\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div>\n\t\t\t<div class=\"ui-ctl-title\">\n\t\t\t\t<div class=\"ui-ctl-label-text\">{{ this.title }}</div>\n\t\t\t</div>\n\t\t\t<div ref=\"entity-selector\"></div>\n\t\t\t<div \n\t\t\t\tv-if=\"!isValid\"\n\t\t\t\tclass=\"connection-error\"\n\t\t\t>\n\t\t\t\t{{ this.errorMessage }}\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Dom } from 'main.core';\nimport { BaseEvent } from 'main.core.events';\nimport { BaseField } from './base-field';\nimport { TagSelector } from 'ui.entity-selector';\nimport { BIcon, Set } from 'ui.icon-set.api.vue';\nimport { hint } from 'ui.vue3.directives.hint';\nimport '../../css/entity-selector-field.css';\n\nexport const TableSelectorField = {\n\textends: BaseField,\n\tdirectives: {\n\t\thint,\n\t},\n\tprops: {\n\t\toptions: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tconnectionId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tmounted()\n\t{\n\t\tconst node = this.$refs['entity-selector'];\n\t\tconst selector = new TagSelector({\n\t\t\tid: this.options.selectorId,\n\t\t\tmultiple: false,\n\t\t\taddButtonCaption: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_CONNECTIONS_SELECT'),\n\t\t\taddButtonCaptionMore: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_CONNECTIONS_CHANGE'),\n\t\t\tdialogOptions: {\n\t\t\t\tid: this.options.selectorId,\n\t\t\t\tenableSearch: true,\n\t\t\t\tdropdownMode: true,\n\t\t\t\tshowAvatars: false,\n\t\t\t\tcompactView: true,\n\t\t\t\tmultiple: false,\n\t\t\t\tdynamicLoad: true,\n\t\t\t\twidth: 460,\n\t\t\t\theight: 420,\n\t\t\t\ttabs: [{\n\t\t\t\t\tid: 'tables',\n\t\t\t\t\tstub: true,\n\t\t\t\t\tstubOptions: {\n\t\t\t\t\t\ttitle: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_TABLES_STUB_TITLE'),\n\t\t\t\t\t\tsubtitle: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_TABLES_STUB_SUBTITLE'),\n\t\t\t\t\t},\n\t\t\t\t}],\n\t\t\t\tentities: [{\n\t\t\t\t\tid: 'biconnector-external-table',\n\t\t\t\t\tdynamicLoad: false,\n\t\t\t\t\tdynamicSearch: true,\n\t\t\t\t}],\n\t\t\t},\n\t\t\tevents: {\n\t\t\t\tonTagAdd: (event: BaseEvent) => {\n\t\t\t\t\tthis.$emit('valueChange', event);\n\t\t\t\t},\n\t\t\t\tonTagRemove: (event: BaseEvent) => {\n\t\t\t\t\tthis.$emit('valueClear', event);\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\t\tDom.addClass(selector.getDialog().getContainer(), 'biconnector-dataset-entity-selector');\n\t\tselector.setLocked(!this.isDisabled);\n\t\tselector.renderTo(node);\n\n\t\tthis.selector = selector;\n\t},\n\tcomputed: {\n\t\tset(): Set\n\t\t{\n\t\t\treturn Set;\n\t\t},\n\t\thintOptions(): Object\n\t\t{\n\t\t\treturn {\n\t\t\t\thtml: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_TABLES_HINT'),\n\t\t\t\tpopupOptions: {\n\t\t\t\t\tbindOptions: {\n\t\t\t\t\t\tposition: 'top',\n\t\t\t\t\t},\n\t\t\t\t\toffsetTop: -10,\n\t\t\t\t\tangle: {\n\t\t\t\t\t\tposition: 'top',\n\t\t\t\t\t\toffset: 34,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t},\n\twatch: {\n\t\tconnectionId(newConnectionId)\n\t\t{\n\t\t\tconst selector: TagSelector = this.selector;\n\t\t\tselector.removeTags();\n\t\t\tselector.getDialog().removeItems();\n\n\t\t\tif (!newConnectionId)\n\t\t\t{\n\t\t\t\tselector.setLocked(true);\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tselector.getDialog().getEntity('biconnector-external-table').options.connectionId = newConnectionId;\n\t\t\tselector.setLocked(this.isDisabled);\n\t\t},\n\t},\n\tmethods: {},\n\tcomponents: {\n\t\tBIcon,\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div>\n\t\t\t<div class=\"ui-ctl-title\">\n\t\t\t\t<div class=\"ui-ctl-label-text table-title\">\n\t\t\t\t\t<span>{{ this.title }}</span>\n\t\t\t\t\t<div class=\"table-hint\" v-hint=\"hintOptions\">\n\t\t\t\t\t\t<BIcon\n\t\t\t\t\t\t\t:name=\"set.HELP\"\n\t\t\t\t\t\t\t:size=\"20\"\n\t\t\t\t\t\t\tcolor=\"#D5D7DB\"\n\t\t\t\t\t\t></BIcon>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div ref=\"entity-selector\"></div>\n\t\t</div>\n\t`,\n};\n","import { ajax as Ajax } from 'main.core';\nimport { BaseStep } from './base-step';\nimport { ConnectionSelectorField } from '../fields/type/connection-selector-field';\nimport { CustomField } from '../fields/type/custom-field';\nimport { TableSelectorField } from '../fields/type/table-selector-field';\nimport { StringField } from '../fields/type/string-field';\nimport '../css/connection.css';\n\nexport const ConnectionStep = {\n\textends: BaseStep,\n\tprops: {\n\t\tconnections: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tconnectionId: this.$store.state.config.connection,\n\t\t\ttableId: this.$store.state.config.table,\n\t\t\tconnectionSelectorId: 'biconnector-external-connection',\n\t\t\ttableSelectorId: 'biconnector-external-table',\n\t\t\tunvalidatedFields: {},\n\t\t};\n\t},\n\tcomponents: {\n\t\tConnectionSelectorField,\n\t\tCustomField,\n\t\tTableSelectorField,\n\t\tStringField,\n\t},\n\tcomputed: {\n\t\tdefaultTitle(): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage('DATASET_IMPORT_CONNECTIONS_HEADER');\n\t\t},\n\t\tconnectionSelectorOptions(): Object\n\t\t{\n\t\t\treturn {\n\t\t\t\tselectorId: this.connectionSelectorId,\n\t\t\t};\n\t\t},\n\t\ttableSelectorOptions(): Object\n\t\t{\n\t\t\treturn {\n\t\t\t\tselectorId: this.tableSelectorId,\n\t\t\t};\n\t\t},\n\t\tselectedConnectionType(): string\n\t\t{\n\t\t\treturn this.$store.getters.connectionProperties?.connectionType;\n\t\t},\n\t\tselectedConnectionId(): number\n\t\t{\n\t\t\treturn this.$store.getters.connectionProperties?.connectionId ?? 0;\n\t\t},\n\t\tselectedConnectionName(): number\n\t\t{\n\t\t\treturn this.$store.getters.connectionProperties?.connectionName;\n\t\t},\n\t\tselectedTableName(): string\n\t\t{\n\t\t\treturn this.$store.getters.connectionProperties?.tableName;\n\t\t},\n\t\tisEditMode(): boolean\n\t\t{\n\t\t\treturn this.$store.getters.isEditMode;\n\t\t},\n\t},\n\tmethods: {\n\t\tonConnectionSelected(event)\n\t\t{\n\t\t\tconst tag = event.data.tag;\n\t\t\tconst dialogItems = event.target.getDialog().getItems();\n\t\t\tdialogItems.forEach((item) => {\n\t\t\t\tif (item.getId() === tag.getId())\n\t\t\t\t{\n\t\t\t\t\ttag.customData = item.getCustomData();\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tconst sourceId = parseInt(event.data.tag.getId(), 10);\n\n\t\t\tthis.$store.commit('setConnectionProperties', {\n\t\t\t\tconnectionType: event.data.tag.getCustomData().get('connectionType'),\n\t\t\t\tconnectionId: sourceId,\n\t\t\t\ttableName: null,\n\t\t\t});\n\n\t\t\tAjax.runAction('biconnector.externalsource.source.checkConnection', {\n\t\t\t\tdata: {\n\t\t\t\t\tsourceId,\n\t\t\t\t},\n\t\t\t})\n\t\t\t\t.then(() => {\n\t\t\t\t\tthis.unvalidatedFields = {};\n\t\t\t\t})\n\t\t\t\t.catch((response) => {\n\t\t\t\t\tthis.unvalidatedFields = {\n\t\t\t\t\t\tconnection: {\n\t\t\t\t\t\t\tresult: false,\n\t\t\t\t\t\t\tmessage: response.errors[0].message,\n\t\t\t\t\t\t},\n\t\t\t\t\t};\n\t\t\t\t})\n\t\t\t;\n\t\t\tthis.$emit('validation', false);\n\t\t},\n\t\tonConnectionDeselected()\n\t\t{\n\t\t\tthis.$store.commit('setConnectionProperties', {\n\t\t\t\tconnectionType: null,\n\t\t\t\tconnectionId: null,\n\t\t\t\ttableName: null,\n\t\t\t});\n\t\t\tthis.$emit('validation', false);\n\t\t\tthis.unvalidatedFields = {};\n\t\t},\n\t\tonTableSelected(event)\n\t\t{\n\t\t\tthis.$store.commit('setConnectionProperties', {\n\t\t\t\tconnectionType: this.selectedConnectionType,\n\t\t\t\tconnectionId: this.selectedConnectionId,\n\t\t\t\ttableName: event.data.tag.getTitle(),\n\t\t\t});\n\n\t\t\tconst tag = event.data.tag;\n\t\t\tconst dialogItems = event.target.getDialog().getItems();\n\t\t\tdialogItems.forEach((item) => {\n\t\t\t\tif (item.getId() === tag.getId())\n\t\t\t\t{\n\t\t\t\t\ttag.customData = item.getCustomData();\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.$store.commit('setDatasetProperties', {\n\t\t\t\tid: event.data.tag.getId(),\n\t\t\t\tname: event.data.tag.getCustomData().get('datasetName'),\n\t\t\t\tcode: event.data.tag.getCustomData().get('description'),\n\t\t\t\tdescription: event.data.tag.getTitle(),\n\t\t\t\texternalCode: event.data.tag.getCustomData().get('description'),\n\t\t\t\texternalName: event.data.tag.getTitle(),\n\t\t\t});\n\t\t\tthis.$emit('tableSelected', event);\n\t\t\tthis.$emit('validation', true);\n\t\t},\n\t\tonTableDeselected(event)\n\t\t{\n\t\t\tthis.$store.commit('setConnectionProperties', {\n\t\t\t\tconnectionType: this.selectedConnectionType,\n\t\t\t\tconnectionId: this.selectedConnectionId,\n\t\t\t\ttableName: null,\n\t\t\t});\n\t\t\tthis.$store.commit('setDatasetProperties', {\n\t\t\t\tid: null,\n\t\t\t\tname: null,\n\t\t\t\tcode: null,\n\t\t\t\tdescription: null,\n\t\t\t\texternalCode: null,\n\t\t\t\texternalName: null,\n\t\t\t});\n\t\t\tthis.$emit('tableDeselected', event);\n\t\t\tthis.$emit('validation', false);\n\t\t},\n\t\topenConnectionSlider()\n\t\t{\n\t\t\tconst link = `/bitrix/components/bitrix/biconnector.externalconnection/slider.php?sourceId=${this.selectedConnectionId}`;\n\t\t\tBX.SidePanel.Instance.open(link, {\n\t\t\t\twidth: 564,\n\t\t\t\tallowChangeHistory: false,\n\t\t\t\tcacheable: false,\n\t\t\t});\n\t\t},\n\t},\n\temits: [\n\t\t'tableSelected',\n\t\t'tableDeselected',\n\t],\n\ttemplate: `\n\t\t<Step\n\t\t\t:title=\"displayedTitle\"\n\t\t\t:hint=\"displayedHint\"\n\t\t\t:is-open-initially=\"isOpenInitially\"\n\t\t\t:disabled=\"disabled\"\n\t\t\tref=\"stepBlock\"\n\t\t>\n\t\t\t<ConnectionSelectorField\n\t\t\t\tv-if=\"!this.isEditMode\"\n\t\t\t\t:options=\"this.connectionSelectorOptions\"\n\t\t\t\tname=\"connections\"\n\t\t\t\t:title=\"this.$Bitrix.Loc.getMessage('DATASET_IMPORT_CONNECTIONS_FIELD_TITLE')\"\n\t\t\t\t:items=\"this.connections\"\n\t\t\t\t:is-disabled=\"disabled\"\n\t\t\t\t:connection-id=\"this.selectedConnectionId\"\n\t\t\t\t@value-change=\"onConnectionSelected\"\n\t\t\t\t@value-clear=\"onConnectionDeselected\"\n\t\t\t\tref=\"connectionField\"\n\t\t\t\t:is-valid=\"unvalidatedFields.connection?.result ?? true\"\n\t\t\t\t:error-message=\"unvalidatedFields.connection?.message ?? ''\"\n\t\t\t/>\n\t\t\t<TableSelectorField\n\t\t\t\tv-if=\"!this.isEditMode\"\n\t\t\t\t:options=\"this.tableSelectorOptions\"\n\t\t\t\tname=\"tables\"\n\t\t\t\t:title=\"this.$Bitrix.Loc.getMessage('DATASET_IMPORT_TABLES_FIELD_TITLE')\"\n\t\t\t\t:connection-id=\"this.selectedConnectionId\"\n\t\t\t\t:is-disabled=\"disabled\"\n\t\t\t\t@value-change=\"onTableSelected\"\n\t\t\t\t@value-clear=\"onTableDeselected\"\n\t\t\t\tref=\"tableField\"\n\t\t\t/>\n\n\t\t\t<div\n\t\t\t\tv-if=\"this.isEditMode\"\n\t\t\t>\n\t\t\t\t<CustomField\n\t\t\t\t\tname=\"connections\"\n\t\t\t\t\t:title=\"this.$Bitrix.Loc.getMessage('DATASET_IMPORT_CONNECTIONS_FIELD_TITLE')\"\n\t\t\t\t>\n\t\t\t\t\t<template #field-content>\n\t\t\t\t\t\t<div class=\"connection-preview\">\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclass=\"connection-icon\"\n\t\t\t\t\t\t\t\t:style=\"'background-image: url(\\\\'' + '/bitrix/images/biconnector/database-connections/' + selectedConnectionType + '.svg\\\\');'\"\n\t\t\t\t\t\t\t></div>\n\t\t\t\t\t\t\t<div class=\"connection-name\" @click=\"openConnectionSlider\">\n\t\t\t\t\t\t\t\t{{ this.selectedConnectionName }}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</template>\n\t\t\t\t</CustomField>\n\n\t\t\t\t<StringField\n\t\t\t\t\tname=\"tables\"\n\t\t\t\t\t:title=\"this.$Bitrix.Loc.getMessage('DATASET_IMPORT_TABLES_FIELD_TITLE')\"\n\t\t\t\t\t:is-disabled=\"true\"\n\t\t\t\t\t:defaultValue=\"this.selectedTableName\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</Step>\n\t`,\n};\n","import { ajax as Ajax } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { AppLayout } from '../layout/app-layout';\nimport { ImportConfig } from '../layout/import-config';\nimport { GenericPopup } from '../popups/generic-popup';\nimport { ImportFailurePopup } from '../popups/saving/import-failure-popup';\nimport { ImportProgressPopup } from '../popups/saving/import-progress-popup';\nimport { ImportSuccessPopup } from '../popups/saving/import-success-popup';\nimport { ConnectionStep } from '../steps/connection';\nimport { FieldsSettingsStep } from '../steps/fields-settings';\nimport { ImportPreview } from '../steps/import-preview';\nimport { DatasetPropertiesStep } from '../steps/dataset-properties';\nimport { BaseApp } from './base-app';\n\nexport const ExternalConnectionApp = {\n\textends: BaseApp,\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tsteps: {\n\t\t\t\tconnection: {\n\t\t\t\t\tdisabled: false,\n\t\t\t\t\tvalid: this.$store.getters.isEditMode,\n\t\t\t\t},\n\t\t\t\tproperties: {\n\t\t\t\t\tdisabled: !this.$store.getters.isEditMode,\n\t\t\t\t\tvalid: true,\n\t\t\t\t},\n\t\t\t\tfields: {\n\t\t\t\t\tdisabled: !this.$store.getters.isEditMode,\n\t\t\t\t\tvalid: true,\n\t\t\t\t},\n\t\t\t},\n\t\t\tshownPopups: {\n\t\t\t\tsavingProgress: false,\n\t\t\t\tsavingSuccess: false,\n\t\t\t\tsavingFailure: false,\n\t\t\t\tloadFailure: false,\n\t\t\t},\n\t\t\tisValidationComplete: true,\n\t\t\tpopupParams: {\n\t\t\t\tsavingSuccess: {},\n\t\t\t\tloadFailure: {\n\t\t\t\t\tmessages: [],\n\t\t\t\t},\n\t\t\t},\n\t\t\tisLoading: false,\n\t\t\tpreviewError: '',\n\t\t\tpreviewDataLoaded: false,\n\t\t};\n\t},\n\tcomputed: {\n\t\tsourceCode(): string\n\t\t{\n\t\t\treturn this.$store.state.config.connectionProperties?.connectionType ?? '';\n\t\t},\n\t\tisEditMode(): boolean\n\t\t{\n\t\t\treturn this.$store.getters.isEditMode;\n\t\t},\n\t\tloadParams(): Object\n\t\t{\n\t\t\treturn {\n\t\t\t\tdatasetProperties: this.$store.state.config.datasetProperties,\n\t\t\t\tfieldsSettings: this.$store.state.config.fieldsSettings,\n\t\t\t\tdataFormats: this.$store.state.config.dataFormats,\n\t\t\t\ttableName: this.$store.state.config.connectionProperties.tableName,\n\t\t\t\tconnectionType: this.$store.state.config.connectionProperties.connectionType,\n\t\t\t};\n\t\t},\n\t\tsaveParams(): Object\n\t\t{\n\t\t\treturn {\n\t\t\t\tdatasetProperties: this.$store.state.config.datasetProperties,\n\t\t\t\tfieldsSettings: this.$store.state.config.fieldsSettings,\n\t\t\t\tdataFormats: this.$store.state.config.dataFormats,\n\t\t\t\tconnectionSettings: this.$store.state.config.connectionProperties,\n\t\t\t};\n\t\t},\n\t\tisValidatedForSave(): boolean\n\t\t{\n\t\t\treturn this.steps.fields.valid && this.steps.properties.valid && this.steps.connection.valid;\n\t\t},\n\t\timportSuccessPopupTitle(): string\n\t\t{\n\t\t\treturn this.isEditMode\n\t\t\t\t? this.$Bitrix.Loc.getMessage('DATASET_IMPORT_SUCCESS_POPUP_HEADER_EDIT').replace('#DATASET_TITLE#', this.popupParams.savingSuccess.title)\n\t\t\t\t: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_SUCCESS_POPUP_HEADER').replace('#DATASET_TITLE#', this.popupParams.savingSuccess.title)\n\t\t\t;\n\t\t},\n\t\tloadFailurePopupTitle(): string\n\t\t{\n\t\t\treturn this.isEditMode\n\t\t\t\t? this.$Bitrix.Loc.getMessage('DATASET_IMPORT_FILE_ERROR_EDIT_TITLE')\n\t\t\t\t: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_FILE_ERROR_TITLE')\n\t\t\t;\n\t\t},\n\t\tfieldsSettingsStepHint(): string\n\t\t{\n\t\t\treturn this.isEditMode\n\t\t\t\t? this.$Bitrix.Loc.getMessage('DATASET_IMPORT_FIELDS_SETTINGS_HINT_EDIT')\n\t\t\t\t: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_FIELDS_SETTINGS_HINT_EXTERNAL')\n\t\t\t\t\t.replace('[link]', '<a onclick=\"top.BX.Helper.show(`redirect=detail&code=23508958`)\">')\n\t\t\t\t\t.replace('[/link]', '</a>')\n\t\t\t;\n\t\t},\n\t\tunsavedChangesPopupTitle(): string\n\t\t{\n\t\t\treturn this.isEditMode\n\t\t\t\t? this.$Bitrix.Loc.getMessage('DATASET_IMPORT_UNSAVED_CHANGES_TITLE_EDIT')\n\t\t\t\t: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_UNSAVED_CHANGES_TITLE_EXTERNAL')\n\t\t\t;\n\t\t},\n\t\tunsavedChangesPopupText(): string\n\t\t{\n\t\t\treturn this.isEditMode\n\t\t\t\t? this.$Bitrix.Loc.getMessage('DATASET_IMPORT_UNSAVED_CHANGES_TEXT_EDIT')\n\t\t\t\t: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_UNSAVED_CHANGES_TEXT_EXTERNAL')\n\t\t\t;\n\t\t},\n\t\temptyStateText(): string\n\t\t{\n\t\t\treturn this.previewDataLoaded\n\t\t\t\t? this.$Bitrix.Loc.getMessage('DATASET_IMPORT_PREVIEW_ERROR_EMPTY_TABLE')\n\t\t\t\t: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_PREVIEW_EMPTY_STATE_EXTERNAL')\n\t\t\t;\n\t\t},\n\t},\n\tmounted()\n\t{\n\t\tif (\n\t\t\t!this.$store.getters.hasData\n\t\t\t&& this.$store.state.config.connectionProperties?.connectionId\n\t\t)\n\t\t{\n\t\t\tthis.loadDataset();\n\t\t}\n\n\t\tEventEmitter.subscribe('SidePanel.Slider:onMessage', this.onSliderEvent);\n\t},\n\tbeforeUnmount()\n\t{\n\t\tEventEmitter.subscribe('SidePanel.Slider:onMessage', this.onSliderEvent);\n\t},\n\tmethods: {\n\t\tonSliderEvent(event)\n\t\t{\n\t\t\tconst [messageEvent] = event.getData();\n\t\t\tif (messageEvent.getEventId() === 'BIConnector:ExternalConnection:onConnectionCreated')\n\t\t\t{\n\t\t\t\tthis.onConnectionCreated();\n\t\t\t}\n\t\t\telse if (messageEvent.getEventId() === 'BIConnector:ExternalConnection:onConnectionCreationError')\n\t\t\t{\n\t\t\t\tthis.onConnectionCreationError();\n\t\t\t}\n\t\t},\n\t\tonConnectionCreated()\n\t\t{\n\t\t\tthis.sendAnalytics({\n\t\t\t\tevent: 'connection',\n\t\t\t\tstatus: 'success',\n\t\t\t});\n\t\t},\n\t\tonConnectionCreationError()\n\t\t{\n\t\t\tthis.sendAnalytics({\n\t\t\t\tevent: 'connection',\n\t\t\t\tstatus: 'error',\n\t\t\t});\n\t\t},\n\t\tonTableSelected()\n\t\t{\n\t\t\tthis.sendConnectionSelectorAnalytics();\n\t\t\tthis.markAsChanged();\n\t\t\tthis.loadDataset();\n\t\t\tthis.$refs.propertiesStep.showValidationErrors();\n\t\t},\n\t\tonTableDeselected()\n\t\t{\n\t\t\tthis.sendConnectionSelectorAnalytics();\n\t\t\tthis.$refs.propertiesStep.close();\n\t\t\tthis.$refs.fieldsStep.close();\n\t\t\tthis.toggleStepState('properties', true);\n\t\t\tthis.toggleStepState('fields', true);\n\t\t\tthis.$store.commit('setPreviewData', []);\n\t\t\tthis.$store.commit('setFieldsSettings', []);\n\t\t\tthis.$refs.propertiesStep.validate();\n\t\t\tthis.previewError = '';\n\t\t},\n\t\tsendConnectionSelectorAnalytics()\n\t\t{\n\t\t\tif (this.lastChangedStep !== 'connection' && !this.isEditMode)\n\t\t\t{\n\t\t\t\tthis.sendAnalytics({\n\t\t\t\t\tevent: 'creation_start',\n\t\t\t\t\tc_element: 'step_1',\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis.lastChangedStep = 'connection';\n\t\t},\n\t\tonDatasetPropertiesChanged()\n\t\t{\n\t\t\tthis.markAsChanged();\n\t\t\tif (this.lastChangedStep !== 'properties' && !this.isEditMode)\n\t\t\t{\n\t\t\t\tthis.sendAnalytics({\n\t\t\t\t\tevent: 'creation_start',\n\t\t\t\t\tc_element: 'step_2',\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis.lastChangedStep = 'properties';\n\t\t},\n\t\tonParsingOptionsChanged()\n\t\t{\n\t\t\tthis.markAsChanged();\n\t\t\tthis.loadDataset();\n\t\t},\n\t\tonFieldsChanged()\n\t\t{\n\t\t\tthis.markAsChanged();\n\t\t\tif (this.lastChangedStep !== 'fields' && !this.isEditMode)\n\t\t\t{\n\t\t\t\tthis.sendAnalytics({\n\t\t\t\t\tevent: 'creation_start',\n\t\t\t\t\tc_element: 'step_3',\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis.lastChangedStep = 'fields';\n\t\t},\n\t\tloadDataset()\n\t\t{\n\t\t\tthis.isLoading = true;\n\t\t\tAjax.runAction('biconnector.externalsource.dataset.view', {\n\t\t\t\tdata: {\n\t\t\t\t\ttype: this.sourceCode,\n\t\t\t\t\tfields: this.loadParams,\n\t\t\t\t\tsourceId: this.$store.state.config.connectionProperties.connectionId,\n\t\t\t\t},\n\t\t\t})\n\t\t\t\t.then((response) => {\n\t\t\t\t\tthis.isLoading = false;\n\t\t\t\t\tthis.onLoadSuccess(response);\n\t\t\t\t})\n\t\t\t\t.catch((response) => {\n\t\t\t\t\tthis.processLoadResponse(response);\n\t\t\t\t\tthis.isLoading = false;\n\t\t\t\t\tthis.previewError = response.errors[0]?.message ?? this.$Bitrix.Loc.getMessage('DATASET_IMPORT_PREVIEW_ERROR_EXTERNAL');\n\t\t\t\t});\n\t\t},\n\t\tonLoadSuccess(response)\n\t\t{\n\t\t\tthis.processLoadResponse(response);\n\n\t\t\tthis.$refs.propertiesStep.open();\n\t\t\tthis.$refs.fieldsStep.open();\n\t\t\tthis.toggleStepState('properties', false);\n\t\t\tthis.toggleStepState('fields', false);\n\t\t\tthis.$refs.propertiesStep.validate();\n\t\t\tthis.$refs.fieldsStep.validate();\n\t\t},\n\t\tprocessLoadResponse(response)\n\t\t{\n\t\t\tconst responseData = response.data;\n\n\t\t\tif (!responseData)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.previewDataLoaded = true;\n\t\t\tconst headers = [];\n\t\t\tresponseData.headers.forEach((header, index) => {\n\t\t\t\theaders.push(this.prepareHeader(header, index));\n\t\t\t});\n\n\t\t\tthis.$store.commit('setFieldsSettings', headers);\n\t\t\tthis.$store.commit('setPreviewData', responseData.data);\n\t\t},\n\t\tprepareHeader(header, index)\n\t\t{\n\t\t\treturn {\n\t\t\t\tid: header.id,\n\t\t\t\tvisible: header.visible,\n\t\t\t\ttype: header.type,\n\t\t\t\tname: header.name && header.name.length > 0 ? header.name : `FIELD_${index}`,\n\t\t\t\toriginalType: header.type,\n\t\t\t\toriginalName: header.externalCode,\n\t\t\t\texternalCode: header.externalCode,\n\t\t\t};\n\t\t},\n\t\tonSaveStart(): boolean\n\t\t{\n\t\t\tif (!this.isValidatedForSave)\n\t\t\t{\n\t\t\t\tthis.$refs.fieldsStep.showValidationErrors();\n\t\t\t\tthis.$refs.propertiesStep.showValidationErrors();\n\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tthis.togglePopup('savingProgress', true);\n\n\t\t\treturn true;\n\t\t},\n\t\tonSaveEnd(response)\n\t\t{\n\t\t\tconst datasetName = response.data.name ?? this.$store.state.config.datasetProperties.name;\n\t\t\tthis.popupParams.savingSuccess = {\n\t\t\t\ttitle: datasetName,\n\t\t\t\tdatasetId: response.data.id,\n\t\t\t\tlink: response.data.url,\n\t\t\t};\n\n\t\t\tthis.togglePopup('savingProgress', false);\n\t\t\tthis.togglePopup('savingSuccess', true);\n\t\t\tthis.isChanged = false;\n\t\t\tthis.sendAnalytics({\n\t\t\t\tevent: this.isEditMode ? 'dataset_editing' : 'creation_end',\n\t\t\t\tstatus: 'success',\n\t\t\t\tp1: `datasetName_${datasetName.replaceAll('_', '')}`,\n\t\t\t});\n\t\t\tBX.SidePanel.Instance.postMessage(window, 'BIConnector.dataset-import:onDatasetCreated', {});\n\t\t},\n\t\tonSaveError()\n\t\t{\n\t\t\tthis.togglePopup('savingProgress', false);\n\t\t\tthis.togglePopup('savingFailure', true);\n\t\t\tthis.sendAnalytics({\n\t\t\t\tevent: this.isEditMode ? 'dataset_editing' : 'creation_end',\n\t\t\t\tstatus: 'error',\n\t\t\t});\n\t\t\tBX.SidePanel.Instance.postMessage(window, 'BIConnector.dataset-import:onDatasetCreated', {});\n\t\t},\n\t\tonSuccessPopupClose()\n\t\t{\n\t\t\tthis.togglePopup('savingSuccess', false);\n\t\t\tthis.closeApp();\n\t\t},\n\t\tcloseFailurePopup()\n\t\t{\n\t\t\tthis.togglePopup('savingFailure', false);\n\t\t},\n\t},\n\tcomponents: {\n\t\tAppLayout,\n\t\tImportConfig,\n\t\tImportPreview,\n\t\tConnectionStep,\n\t\tDatasetPropertiesStep,\n\t\tFieldsSettingsStep,\n\t\tImportProgressPopup,\n\t\tImportSuccessPopup,\n\t\tImportFailurePopup,\n\t\tGenericPopup,\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<AppLayout\n\t\t\tref=\"appLayout\"\n\t\t\t:save-locked=\"!isSaveEnabled\"\n\t\t\t:is-edit-mode=\"isEditMode\"\n\t\t>\n\t\t\t<template v-slot:left-panel>\n\t\t\t\t<ImportConfig>\n\t\t\t\t\t<ConnectionStep\n\t\t\t\t\t\t:disabled=\"steps.connection.disabled\"\n\t\t\t\t\t\t:connections=\"appParams.connections\"\n\t\t\t\t\t\tref=\"connectionsStep\"\n\t\t\t\t\t\t@table-selected=\"onTableSelected\"\n\t\t\t\t\t\t@table-deselected=\"onTableDeselected\"\n\t\t\t\t\t\t@validation=\"onStepValidation('connection', $event)\"\n\t\t\t\t\t/>\n\t\t\t\t\t<DatasetPropertiesStep\n\t\t\t\t\t\t:is-open-initially=\"isEditMode\"\n\t\t\t\t\t\t:disabled=\"steps.properties.disabled\"\n\t\t\t\t\t\t:reserved-names=\"appParams.reservedNames\"\n\t\t\t\t\t\tref=\"propertiesStep\"\n\t\t\t\t\t\t@validation=\"onStepValidation('properties', $event)\"\n\t\t\t\t\t\t@properties-changed=\"onDatasetPropertiesChanged\"\n\t\t\t\t\t\tdataset-source-code=\"external\"\n\t\t\t\t\t/>\n\t\t\t\t\t<FieldsSettingsStep\n\t\t\t\t\t\t:is-open-initially=\"isEditMode\"\n\t\t\t\t\t\t:disabled=\"steps.fields.disabled\"\n\t\t\t\t\t\tref=\"fieldsStep\"\n\t\t\t\t\t\t@validation=\"onStepValidation('fields', $event)\"\n\t\t\t\t\t\t@parsing-options-changed=\"onParsingOptionsChanged\"\n\t\t\t\t\t\t@settings-changed=\"onFieldsChanged\"\n\t\t\t\t\t\t:hint=\"fieldsSettingsStepHint\"\n\t\t\t\t\t/>\n\t\t\t\t</ImportConfig>\n\t\t\t</template>\n\t\t\t<template v-slot:right-panel>\n\t\t\t\t<ImportPreview \n\t\t\t\t\t:empty-state-text=\"emptyStateText\"\n\t\t\t\t\t:is-loading=\"isLoading\"\n\t\t\t\t\t:error=\"previewError\"\n\t\t\t\t/>\n\t\t\t</template>\n\t\t</AppLayout>\n\n\t\t<ImportProgressPopup\n\t\t\tv-if=\"shownPopups.savingProgress\"\n\t\t\t:description=\"$Bitrix.Loc.getMessage('DATASET_IMPORT_PROGRESS_POPUP_DESCRIPTION')\"\n\t\t/>\n\n\t\t<ImportSuccessPopup\n\t\t\tv-if=\"shownPopups.savingSuccess\"\n\t\t\t@close=\"onSuccessPopupClose\"\n\t\t\t@click=\"closeApp\"\n\t\t\t:title=\"importSuccessPopupTitle\"\n\t\t\t:description=\"''\"\n\t\t\t:dataset-id=\"popupParams.savingSuccess.datasetId\"\n\t\t\t:dataset-link=\"popupParams.savingSuccess.link\"\n\t\t\t:show-more-button=\"!isEditMode\"\n\t\t\t@one-more-click=\"reload\"\n\t\t/>\n\n\t\t<ImportFailurePopup\n\t\t\tv-if=\"shownPopups.savingFailure\"\n\t\t\t@close=\"closeFailurePopup\"\n\t\t\t@click=\"closeFailurePopup\"\n\t\t\t:title=\"$Bitrix.Loc.getMessage('DATASET_IMPORT_FAILURE_POPUP_HEADER')\"\n\t\t\t:description=\"$Bitrix.Loc.getMessage('DATASET_IMPORT_EXTERNAL_FAILURE_POPUP_DESCRIPTION').replace('[link]', '<a>').replace('[/link]', '</a>')\"\n\t\t/>\n\n\t\t<GenericPopup\n\t\t\tv-if=\"shownPopups.loadFailure\"\n\t\t\t:title=\"loadFailurePopupTitle\"\n\t\t\t@close=\"togglePopup('loadFailure')\"\n\t\t>\n\t\t\t<template v-slot:content>\n\t\t\t\t<p v-for=\"message in popupParams.loadFailure.messages\">\n\t\t\t\t\t{{ message }}\n\t\t\t\t</p>\n\t\t\t</template>\n\t\t\t<template v-slot:buttons>\n\t\t\t\t<button @click=\"togglePopup('loadFailure')\" class=\"ui-btn ui-btn-md ui-btn-primary\">{{ $Bitrix.Loc.getMessage('DATASET_IMPORT_FILE_ERROR_POPUP_CLOSE') }}</button>\n\t\t\t</template>\n\t\t</GenericPopup>\n\t`,\n};\n","/* eslint-disable no-param-reassign */\nimport { createStore } from 'ui.vue3.vuex';\nimport type { AppStateOptions, ConnectionProperties } from '../types/app-state-options';\n\nexport class Store\n{\n\tstatic buildStore(defaultValues: AppStateOptions)\n\t{\n\t\treturn createStore({\n\t\t\tstate()\n\t\t\t{\n\t\t\t\treturn defaultValues;\n\t\t\t},\n\t\t\tmutations: {\n\t\t\t\tsetFileProperties(state, fileProperties)\n\t\t\t\t{\n\t\t\t\t\tstate.config.fileProperties = fileProperties;\n\t\t\t\t},\n\t\t\t\tsetConnectionProperties(state, connectionProperties)\n\t\t\t\t{\n\t\t\t\t\tstate.config.connectionProperties = connectionProperties;\n\t\t\t\t},\n\t\t\t\tsetDatasetProperties(state, datasetProperties)\n\t\t\t\t{\n\t\t\t\t\tstate.config.datasetProperties = datasetProperties;\n\t\t\t\t},\n\t\t\t\ttoggleRowVisibility(state, rowIndex)\n\t\t\t\t{\n\t\t\t\t\tstate.config.fieldsSettings[rowIndex].visible = !state.config.fieldsSettings[rowIndex].visible;\n\t\t\t\t},\n\t\t\t\tsetAllRowsVisible(state)\n\t\t\t\t{\n\t\t\t\t\tstate.config.fieldsSettings = state.config.fieldsSettings.map((field) => {\n\t\t\t\t\t\tfield.visible = true;\n\n\t\t\t\t\t\treturn field;\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tsetAllRowsInvisible(state)\n\t\t\t\t{\n\t\t\t\t\tstate.config.fieldsSettings = state.config.fieldsSettings.map((field) => {\n\t\t\t\t\t\tfield.visible = false;\n\n\t\t\t\t\t\treturn field;\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tsetFieldRowSettings(state, payload)\n\t\t\t\t{\n\t\t\t\t\tstate.config.fieldsSettings[payload.index] = payload.settings;\n\t\t\t\t},\n\t\t\t\tsetDataFormats(state, formats)\n\t\t\t\t{\n\t\t\t\t\tstate.config.dataFormats = formats;\n\t\t\t\t},\n\t\t\t\tsetPreviewData(state, data)\n\t\t\t\t{\n\t\t\t\t\tstate.previewData.rows = data;\n\t\t\t\t},\n\t\t\t\tsetFieldsSettings(state, settings)\n\t\t\t\t{\n\t\t\t\t\tstate.config.fieldsSettings = settings;\n\t\t\t\t},\n\t\t\t},\n\t\t\tgetters: {\n\t\t\t\tisEditMode(state)\n\t\t\t\t{\n\t\t\t\t\treturn state.config.datasetProperties.id > 0;\n\t\t\t\t},\n\t\t\t\tareAllRowsVisible(state)\n\t\t\t\t{\n\t\t\t\t\treturn state.config.fieldsSettings.filter((field) => !(field.visible)).length === 0;\n\t\t\t\t},\n\t\t\t\tareNoRowsVisible(state)\n\t\t\t\t{\n\t\t\t\t\treturn state.config.fieldsSettings.filter((field) => (field.visible)).length === 0;\n\t\t\t\t},\n\t\t\t\tareSomeRowsVisible(state, getters)\n\t\t\t\t{\n\t\t\t\t\treturn !getters.areAllRowsVisible && !getters.areNoRowsVisible;\n\t\t\t\t},\n\t\t\t\tcolumnVisibilityMap(state)\n\t\t\t\t{\n\t\t\t\t\tconst map = [];\n\t\t\t\t\tstate.config.fieldsSettings.forEach((field) => {\n\t\t\t\t\t\tmap.push(Boolean(field.visible));\n\t\t\t\t\t});\n\n\t\t\t\t\treturn map;\n\t\t\t\t},\n\t\t\t\tpreviewHeaders(state)\n\t\t\t\t{\n\t\t\t\t\treturn state.config.fieldsSettings.map((item) => item.name);\n\t\t\t\t},\n\t\t\t\thasData(state)\n\t\t\t\t{\n\t\t\t\t\treturn state.previewData?.rows?.length > 0;\n\t\t\t\t},\n\t\t\t\tconnectionProperties(state): ConnectionProperties\n\t\t\t\t{\n\t\t\t\t\treturn state.config?.connectionProperties;\n\t\t\t\t},\n\t\t\t\tdatasetProperties(state)\n\t\t\t\t{\n\t\t\t\t\treturn state.config?.datasetProperties;\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\t}\n}\n","import { BitrixVue } from 'ui.vue3';\nimport type { AppStateOptions } from '../types/app-state-options';\nimport type { DataFormatTemplate } from '../types/data-types';\nimport { CsvApp } from './csv-app';\nimport { ExternalConnectionApp } from './external-connection-app';\nimport { Store } from './store';\n\nconst codeMap = {\n\tcsv: CsvApp,\n\t'1c': ExternalConnectionApp,\n};\n\ntype AppParams = {\n\tdataFormatTemplates: DataFormatTemplate,\n\tencodings: Array,\n\tseparator: Array,\n};\n\nexport class AppFactory\n{\n\tstatic getApp(code: string, stateOptions: AppStateOptions = {}, appParams: AppParams = {})\n\t{\n\t\tconst defaultStructure = {\n\t\t\tpreviewData: {},\n\t\t\tconfig: {\n\t\t\t\tfileProperties: {},\n\t\t\t\tdataFormats: {},\n\t\t\t\tdatasetProperties: {},\n\t\t\t\tfieldsSettings: [],\n\t\t\t},\n\t\t};\n\n\t\tconst state = BX.util.objectMerge(defaultStructure, stateOptions);\n\n\t\tlet app = null;\n\n\t\tconst appComponent = codeMap[code];\n\n\t\tif (appComponent)\n\t\t{\n\t\t\tapp = BitrixVue.createApp({\n\t\t\t\tname: 'DatasetImport',\n\t\t\t\tdata()\n\t\t\t\t{\n\t\t\t\t\treturn {\n\t\t\t\t\t\tappParams,\n\t\t\t\t\t};\n\t\t\t\t},\n\t\t\t\tcomponents: {\n\t\t\t\t\tappComponent,\n\t\t\t\t},\n\t\t\t\tcomputed: {\n\t\t\t\t\tcomponentName()\n\t\t\t\t\t{\n\t\t\t\t\t\treturn appComponent;\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t// language=Vue\n\t\t\t\ttemplate: `\n\t\t\t\t\t<component :is=\"componentName\" :app-params=\"appParams\" />\n\t\t\t\t`,\n\t\t\t});\n\t\t}\n\n\t\tif (app)\n\t\t{\n\t\t\tconst store = Store.buildStore(state);\n\n\t\t\tapp.use(store);\n\t\t}\n\n\t\treturn app;\n\t}\n}\n","import { Uri } from 'main.core';\nimport { SidePanel } from 'ui.sidepanel';\n\nexport class Slider\n{\n\tstatic open(sourceId: string, datasetId: ?number = 0): void\n\t{\n\t\tconst componentLink = '/bitrix/components/bitrix/biconnector.dataset.import/slider.php';\n\n\t\tconst sliderLink = new Uri(componentLink);\n\t\tsliderLink.setQueryParam('sourceId', sourceId);\n\t\tif (datasetId)\n\t\t{\n\t\t\tsliderLink.setQueryParam('datasetId', datasetId);\n\t\t}\n\n\t\tconst options = {\n\t\t\twidth: 1240,\n\t\t\tallowChangeHistory: false,\n\t\t\tcacheable: false,\n\t\t};\n\n\t\tif (screen.width <= 1440)\n\t\t{\n\t\t\toptions.customLeftBoundary = 0;\n\t\t}\n\n\t\tSidePanel.Instance.open(\n\t\t\tsliderLink.toString(),\n\t\t\toptions,\n\t\t);\n\t}\n}\n"],"names":["AppLayout","props","saveLocked","type","Boolean","required","default","isEditMode","computed","saveButtonClass","saveButtonText","$Bitrix","Loc","getMessage","mounted","Dom","addClass","document","querySelector","buttonsPanel","$refs","$root","$el","parentNode","appendChild","BX","UI","Pinner","fixBottom","fullWidth","methods","onCreateButtonClick","eventEmitter","emit","onCancelButtonClick","template","ImportConfig","Popup","emits","id","String","options","Object","wrapperClass","data","popupInstance","popupOptions","content","autoHide","events","onPopupClose","closePopup","onPopupDestroy","fixed","PopupManager","getPopupById","destroy","$emit","MainPopup","show","beforeUnmount","GenericPopup","title","width","closeIcon","noAllPaddings","overlay","onClose","components","SavingPopup","description","minHeight","ImportFailurePopup","onClick","SaveProgressPopup","ImportProgressPopup","loader","Loader","target","size","color","strokeWidth","mode","ImportSuccessPopup","datasetId","Number","showMoreButton","onButtonClick","openDatasetButton","Ajax","runAction","then","response","link","window","open","focus","removeClass","catch","onOneMoreButtonClick","oneMoreButton","StepHint","hintClass","StepBlock","section","hint","isOpenInitially","canCollapse","disabled","customClasses","Array","additionalClasses","custom","reduce","acc","key","toggleCollapse","toggle","contentContainer","Section","isOpen","append","renderTo","watch","newValue","getContent","innerHTML","Text","encode","BaseStep","displayedTitle","defaultTitle","displayedHint","defaultHint","stepBlock","close","validate","showValidationErrors","Step","ErrorPopup","create","message","element","Tag","render","bindElement","darkMode","bindOptions","position","angle","cacheable","setOptions","angleMinBottom","BaseField","defaultValue","name","placeholder","isValid","errorMessage","isDisabled","hintText","value","areValidationErrorsShown","onInputChange","fieldName","StringField","extends","errorPopup","errorPopupTimeout","onInput","event","onBlur","showErrorHint","setTimeout","hideErrorHint","clearTimeout","createErrorPopup","errorIconWrapper","Hint","createNode","TextField","DatasetProperties","defaultName","defaultDescription","unvalidatedFields","disabledFields","datasetSourceCode","onValueChange","nameField","DatasetPropertiesStep","reservedNames","datasetProperties","$store","state","config","getters","result","nameValidationResult","validateName","onDatasetPropertiesFieldsChange","commit","keys","length","isReserved","includes","test","TableHeader","enabled","indeterminate","isNeedShowOriginalNameHint","fileProperties","firstLineHeader","onCheckboxClick","preventDefault","DataType","string","money","int","double","date","datetime","DataTypeDescriptions","icon","DataTypeMenu","constructor","selectedType","onSelect","getMenu","items","entries","forEach","push","html","onclick","item","getMenuWindow","className","Menu","DataTypeSelector","typeMenu","isFocused","iconClass","typeTitle","getPopupWindow","setWidth","formatButton","offsetWidth","createMenu","destroyMenu","TableRow","directives","index","fieldSettings","invalidFields","displayedValidationErrors","isNameValid","displayedErrorForName","set","Set","originalsHintText","originalType","originalName","typeText","nameText","connectionProperties","connectionType","hintOptions","offsetLeft","offsetTop","onTypeSelected","onFieldInput","onFieldBlur","field","originalsHint","remove","DataTypeButton","BIcon","FormatTable","fieldsSettings","unvalidatedRows","areAllRowsVisible","areNoRowsVisible","areSomeRowsVisible","onRowCheckboxClicked","onHeaderCheckboxClicked","onRowFieldChanged","rowIndices","row","FieldsSettingsStep","replace","rows","isNotEmpty","isTooLong","areCharactersValid","isAlreadyUsed","previewHeaders","count","onRowToggled","onHeaderToggled","settings","formatTable","OptionType","CUSTOM","VALUE","FormatSelector","openSlider","selected","dataFormatTemplates","SidePanel","Instance","contentCallback","Layout","createContent","extensions","buttons","cancelButton","SaveButton","form","getTopSlider","getContainer","formData","FormData","fromEntries","customFieldsToExtract","formRoot","subtitle","fieldType","selectRoot","isCustomSelected","customElement","customOptionInput","option","optionElement","isSelected","Event","bind","setAttribute","SliderButton","SwitcherField","Switcher","node","switcher","SwitcherSize","small","checked","handlers","toggled","CustomField","DropdownField","FileUploader","FileUploadWidget","defaultEncoding","defaultSeparator","defaultFirstLineHeader","encodings","separators","inputElement","uploaderOptions","controller","controllerOptions","multiple","acceptOnlyImages","maxFileSize","autoUpload","acceptedFileTypes","onUploadComplete","onFileRemoved","onError","onUploadError","widgetOptions","file","uploader","getFiles","isComplete","getServerFileId","getName","openDataFormatSlider","dataFormats","selectedFormats","FileStep","isErrorDisplayed","fileValidationResult","validateFile","onFilePropertiesChange","onParsingOptionsChanged","fileToken","fileUploader","AppSection","headers","columnVisibility","visibleHeaders","filter","_","visibleValues","PreviewTable","displayedColumnVisibility","debouncedRefresh","debounce","refreshColumns","ears","Ears","container","smallSize","noScrollbar","init","newVisibility","table","oldValue","ImportPreview","emptyStateText","error","isLoading","previewData","isEverythingHidden","hasData","hasHeaders","displayedEmptyStateText","displayedEverythingHiddenText","columnVisibilityMap","isErrorInEditMode","isEditModeInitialDataDisplayed","hasDataDisplayedHint","loadingAnchor","BaseApp","appParams","steps","shownPopups","isChanged","isSaveComplete","lastChangedStep","sourceCode","loadParams","saveParams","isSaveEnabled","isValidatedForSave","previewError","unsavedChangesPopupTitle","unsavedChangesPopupText","subscribe","onSaveButtonClick","slider","top","addCustomEvent","onSliderClose","addEventListener","removeCustomEvent","unsubscribe","markAsChanged","sendAnalytics","status","denyAction","continueButton","Button","ButtonColor","PRIMARY","text","click","popup","closeButton","LINK","closeApp","popupHeader","popupText","toggleStepState","step","Type","isNull","togglePopup","shown","loadDataset","fields","onLoadSuccess","onLoadError","onStepValidation","validationResult","valid","onSaveStart","updateDataset","saveDataset","onSaveEnd","onSaveError","onLoadStart","reload","location","params","sendData","getBaseAnalyticsParams","tool","c_section","category","toUpperCase","CsvApp","properties","savingProgress","savingSuccess","savingFailure","editModeFileReplacement","isValidationComplete","popupParams","lastReloadSource","initialPreviewData","initialFieldsSettings","isEditModeSaveConfirmed","isDataLoadingAnimationDisplayed","hasMinimalLoadingAnimationTimePassed","importFailurePopupTitle","importSuccessPopupTitle","importSuccessPopupDescription","fileName","importProgressPopupDescription","onDatasetPropertiesChanged","c_element","p1","replaceAll","onFieldsSettingsChanged","onDatasetReloadNeeded","reloadSource","startPreviewLoadingAnimation","propertiesStep","fieldsStep","processLoadResponse","responseData","header","prepareHeader","visible","externalCode","stopPreviewLoadingAnimation","errors","fileStep","datasetName","postMessage","onSuccessPopupClose","closeFailurePopup","onReplacementButtonClick","ConnectionSelectorField","connectionId","selector","TagSelector","selectorId","addButtonCaption","addButtonCaptionMore","dialogOptions","prepareItems","enableSearch","dropdownMode","showAvatars","compactView","height","tabs","stubOptions","arrow","iconOpacity","entities","onTagAdd","onTagRemove","getDialog","footer","allowChangeHistory","getTab","setFooter","EventEmitter","messageEvent","getData","getEventId","addSelectedItem","selectorItems","itemOptions","ID","TITLE","entityId","linkTitle","customData","TYPE","avatar","toString","connection","addItem","select","hide","TableSelectorField","dynamicLoad","stub","dynamicSearch","setLocked","offset","newConnectionId","removeTags","removeItems","getEntity","ConnectionStep","connections","tableId","connectionSelectorId","tableSelectorId","connectionSelectorOptions","tableSelectorOptions","selectedConnectionType","selectedConnectionId","selectedConnectionName","connectionName","selectedTableName","tableName","onConnectionSelected","tag","dialogItems","getItems","getId","getCustomData","sourceId","parseInt","get","onConnectionDeselected","onTableSelected","getTitle","code","externalName","onTableDeselected","openConnectionSlider","ExternalConnectionApp","loadFailure","messages","previewDataLoaded","connectionSettings","loadFailurePopupTitle","fieldsSettingsStepHint","onSliderEvent","onConnectionCreated","onConnectionCreationError","sendConnectionSelectorAnalytics","onFieldsChanged","url","Store","buildStore","defaultValues","createStore","mutations","setFileProperties","setConnectionProperties","setDatasetProperties","toggleRowVisibility","rowIndex","setAllRowsVisible","map","setAllRowsInvisible","setFieldRowSettings","payload","setDataFormats","formats","setPreviewData","setFieldsSettings","codeMap","csv","AppFactory","getApp","stateOptions","defaultStructure","util","objectMerge","app","appComponent","BitrixVue","createApp","componentName","store","use","Slider","componentLink","sliderLink","Uri","setQueryParam","screen","customLeftBoundary"],"mappings":";;;;;;CAKO,MAAMA,SAAS,GAAG;GACxBC,KAAK,EAAE;KACNC,UAAU,EAAE;OACXC,IAAI,EAAEC,OAAO;OACbC,QAAQ,EAAE,KAAK;OACfC,OAAO,EAAE;MACT;KACDC,UAAU,EAAE;OACXJ,IAAI,EAAEC,OAAO;OACbC,QAAQ,EAAE,KAAK;OACfC,OAAO,EAAE;;IAEV;GACDE,QAAQ,EAAE;KACTC,eAAe,GACf;OACC,OAAO;SACN,mBAAmB,EAAE,IAAI,CAACP,UAAU;SACpC,2BAA2B,EAAE,IAAI,CAACA,UAAU;SAC5C,gBAAgB,EAAE,CAAC,IAAI,CAACA;QACxB;MACD;KACDQ,cAAc,GACd;OACC,OAAO,IAAI,CAACH,UAAU,GACnB,IAAI,CAACI,OAAO,CAACC,GAAG,CAACC,UAAU,CAAC,qBAAqB,CAAC,GAClD,IAAI,CAACF,OAAO,CAACC,GAAG,CAACC,UAAU,CAAC,uBAAuB,CAAC;;IAExD;GACDC,OAAO,GACP;KACCC,aAAG,CAACC,QAAQ,CAACC,QAAQ,CAACC,aAAa,CAAC,MAAM,CAAC,EAAE,UAAU,CAAC;KAExD,MAAMC,YAAY,GAAG,IAAI,CAACC,KAAK,CAACD,YAAY;KAC5C,IAAIA,YAAY,EAChB;OACC,IAAI,CAACE,KAAK,CAACC,GAAG,CAACC,UAAU,CAACC,WAAW,CAACL,YAAY,CAAC;OACnD,IAAIM,EAAE,CAACC,EAAE,CAACC,MAAM,CACfR,YAAY,EACZ;SACCS,SAAS,EAAE,IAAI;SACfC,SAAS,EAAE;QACX,CACD;;IAEF;GACDC,OAAO,EAAE;KACRC,mBAAmB,GACnB;OACC,IAAI,CAACpB,OAAO,CAACqB,YAAY,CAACC,IAAI,CAAC,8CAA8C,EAAE,EAAE,CAAC;MAClF;KACDC,mBAAmB,GACnB;OACC,IAAI,CAACvB,OAAO,CAACqB,YAAY,CAACC,IAAI,CAAC,8CAA8C,EAAE,EAAE,CAAC;;IAEnF;;GAEDE,QAAQ,EAAG;;;;;;;;;;;;;;;;;;;;;;;CAuBZ,CAAC;;CCnFM,MAAMC,YAAY,GAAG;;GAE3BD,QAAQ,EAAG;;;;;CAKZ,CAAC;;CCNM,MAAME,KAAK,GAAG;GACpBC,KAAK,EAAE,CAAC,OAAO,CAAC;GAChBrC,KAAK,EAAE;KACNsC,EAAE,EAAE;OACHpC,IAAI,EAAEqC,MAAM;OACZnC,QAAQ,EAAE;MACV;KACDoC,OAAO,EAAE;OACRtC,IAAI,EAAEuC,MAAM;OACZrC,QAAQ,EAAE,KAAK;OACfC,OAAO,EAAE;MACT;KACDqC,YAAY,EAAE;OACbxC,IAAI,EAAEqC,MAAM;OACZnC,QAAQ,EAAE,KAAK;OACfC,OAAO,EAAE;;IAEV;GACDsC,IAAI,GACJ;KACC,OAAO;OACNC,aAAa,EAAE;MACf;IACD;GACDrC,QAAQ,EAAE;KACTsC,YAAY,GACZ;OACC,OAAO;SACNP,EAAE,EAAE,IAAI,CAACA,EAAE;SACXQ,OAAO,EAAE,IAAI,CAAC3B,KAAK,CAAC2B,OAAO;SAC3BC,QAAQ,EAAE,IAAI;SACdC,MAAM,EAAE;WACPC,YAAY,EAAE,IAAI,CAACC,UAAU;WAC7BC,cAAc,EAAE,IAAI,CAACD;UACrB;SACDE,KAAK,EAAE,IAAI;SACX,GAAG,IAAI,CAACZ;QACR;;IAEF;GACDX,OAAO,EAAE;KACRqB,UAAU,GACV;OAAA;OACC,yBAAAG,uBAAY,CAACC,YAAY,CAAC,IAAI,CAAChB,EAAE,CAAC,qBAAlC,sBAAoCiB,OAAO,EAAE;OAC7C,IAAI,CAACX,aAAa,GAAG,IAAI;OACzB,IAAI,CAACY,KAAK,CAAC,OAAO,CAAC;;IAEpB;GACD3C,OAAO,GACP;KACC,IAAI,CAAC,IAAI,CAAC+B,aAAa,EACvB;OACC,IAAI,CAACA,aAAa,GAAG,IAAIa,gBAAS,CAAC,IAAI,CAACZ,YAAY,CAAC;;KAGtD,IAAI,CAACD,aAAa,CAACc,IAAI,EAAE;IACzB;GACDC,aAAa,GACb;KACC,IAAI,CAACT,UAAU,EAAE;IACjB;GACDhB,QAAQ,EAAG;;;;;CAKZ,CAAC;;CCjEM,MAAM0B,YAAY,GAAG;GAC3BvB,KAAK,EAAE,CAAC,OAAO,CAAC;GAChBrC,KAAK,EAAE;KACN6D,KAAK,EAAE;OACN3D,IAAI,EAAEqC,MAAM;OACZnC,QAAQ,EAAE;;IAEX;GACDG,QAAQ,EAAE;KACTsC,YAAY,GACZ;OACC,OAAO;SACNiB,KAAK,EAAE,GAAG;SACVC,SAAS,EAAE,IAAI;SACfC,aAAa,EAAE,IAAI;SACnBC,OAAO,EAAE;QACT;;IAEF;GACDpC,OAAO,EAAE;KACRqC,OAAO,GACP;OACC,IAAI,CAACV,KAAK,CAAC,OAAO,CAAC;;IAEpB;GACDW,UAAU,EAAE;KACX/B;IACA;;GAEDF,QAAQ,EAAG;;;;;;;;;;;CAWZ,CAAC;;CCxCM,MAAMkC,WAAW,GAAG;GAC1B/B,KAAK,EAAE,CAAC,OAAO,CAAC;GAChBrC,KAAK,EAAE;KACN6D,KAAK,EAAE;OACN3D,IAAI,EAAEqC,MAAM;OACZnC,QAAQ,EAAE;MACV;KACDiE,WAAW,EAAE;OACZnE,IAAI,EAAEqC,MAAM;OACZnC,QAAQ,EAAE,KAAK;OACfC,OAAO,EAAE;MACT;KACDmC,OAAO,EAAE;OACRtC,IAAI,EAAEuC,MAAM;OACZrC,QAAQ,EAAE,KAAK;OACfC,OAAO,EAAE;;IAEV;GACDE,QAAQ,EAAE;KACTsC,YAAY,GACZ;OACC,OAAO;SACNiB,KAAK,EAAE,GAAG;SACVQ,SAAS,EAAE,GAAG;SACdP,SAAS,EAAE,IAAI;SACfC,aAAa,EAAE,IAAI;SACnBC,OAAO,EAAE,IAAI;SACb,GAAG,IAAI,CAACzB;QACR;;IAEF;GACDX,OAAO,EAAE;KACRqC,OAAO,GACP;OACC,IAAI,CAACV,KAAK,CAAC,OAAO,CAAC;;IAEpB;GACDW,UAAU,EAAE;KACX/B;IACA;;GAEDF,QAAQ,EAAG;;;;;;;;;;;;;;CAcZ,CAAC;;CCxDM,MAAMqC,kBAAkB,GAAG;GACjCvE,KAAK,EAAE;KACN6D,KAAK,EAAE;OACN3D,IAAI,EAAEqC,MAAM;OACZnC,QAAQ,EAAE;MACV;KACDiE,WAAW,EAAE;OACZnE,IAAI,EAAEqC,MAAM;OACZnC,QAAQ,EAAE;;IAEX;GACDiC,KAAK,EAAE,CAAC,OAAO,CAAC;GAChB9B,QAAQ,EAAE,EAAE;GACZsB,OAAO,EACP;KACC2C,OAAO,GACP;OACC,IAAI,CAAChB,KAAK,CAAC,OAAO,CAAC;;IAEpB;GACDW,UAAU,EAAE;KACXM,iBAAiB,EAAEL;IACnB;;GAEDlC,QAAQ,EAAG;;;;;;;;;;;;;CAaZ,CAAC;;CCpCM,MAAMwC,mBAAmB,GAAG;GAClC1E,KAAK,EAAE;KACNqE,WAAW,EAAE;OACZnE,IAAI,EAAEqC,MAAM;OACZnC,QAAQ,EAAE,KAAK;OACfC,OAAO,EAAE;;IAEV;GACDQ,OAAO,GACP;KACC,MAAM8D,MAAM,GAAG,IAAIC,kBAAM,CAAC;OACzBC,MAAM,EAAE,IAAI,CAAC1D,KAAK,CAACwD,MAAM;OACzBG,IAAI,EAAE,EAAE;OACRC,KAAK,EAAE,yBAAyB;OAChCC,WAAW,EAAE,CAAC;OACdC,IAAI,EAAE;MACN,CAAC;KACFN,MAAM,CAACjB,IAAI,EAAE;IACb;GACDnD,QAAQ,EAAE;KACTsC,YAAY,GACZ;OACC,OAAO;SACNE,QAAQ,EAAE,KAAK;SACfgB,SAAS,EAAE;QACX;;IAEF;GACDI,UAAU,EAAE;KACXM,iBAAiB,EAAEL;IACnB;;GAEDlC,QAAQ,EAAG;;;;;;;;;;;CAWZ,CAAC;;CC3CM,MAAMgD,kBAAkB,GAAG;GACjC7C,KAAK,EAAE,CAAC,OAAO,EAAE,cAAc,CAAC;GAChCrC,KAAK,EAAE;KACN6D,KAAK,EAAE;OACN3D,IAAI,EAAEqC,MAAM;OACZnC,QAAQ,EAAE;MACV;KACDiE,WAAW,EAAE;OACZnE,IAAI,EAAEqC,MAAM;OACZnC,QAAQ,EAAE,KAAK;OACfC,OAAO,EAAE;MACT;KACD8E,SAAS,EAAE;OACVjF,IAAI,EAAEkF,MAAM;OACZhF,QAAQ,EAAE;MACV;KACDiF,cAAc,EAAE;OACfnF,IAAI,EAAEC,OAAO;OACbC,QAAQ,EAAE,KAAK;OACfC,OAAO,EAAE;;IAEV;GACDE,QAAQ,EAAE,EAAE;GACZsB,OAAO,EAAE;KACRyD,aAAa,GACb;OACCxE,aAAG,CAACC,QAAQ,CAAC,IAAI,CAACI,KAAK,CAACoE,iBAAiB,EAAE,aAAa,CAAC;OACzDC,cAAI,CAACC,SAAS,CACb,+CAA+C,EAC/C;SACC9C,IAAI,EAAE;WACLL,EAAE,EAAE,IAAI,CAAC6C;;QAEV,CACD,CACCO,IAAI,CAAEC,QAAQ,IAAK;SACnB,MAAMC,IAAI,GAAGD,QAAQ,CAAChD,IAAI;SAC1B,IAAIiD,IAAI,EACR;WACCC,MAAM,CAACC,IAAI,CAACF,IAAI,EAAE,QAAQ,CAAC,CAACG,KAAK,EAAE;WACnCjF,aAAG,CAACkF,WAAW,CAAC,IAAI,CAAC7E,KAAK,CAACoE,iBAAiB,EAAE,aAAa,CAAC;WAC5D,IAAI,CAAC/B,KAAK,CAAC,OAAO,CAAC;;QAEpB,CAAC,CACDyC,KAAK,CAAEN,QAAQ,IAAK;SACpB7E,aAAG,CAACkF,WAAW,CAAC,IAAI,CAAC7E,KAAK,CAACoE,iBAAiB,EAAE,aAAa,CAAC;SAC5D,IAAI,CAAC/B,KAAK,CAAC,OAAO,CAAC;QACnB,CAAC;MACH;KACD0C,oBAAoB,GACpB;OACCpF,aAAG,CAACC,QAAQ,CAAC,IAAI,CAACI,KAAK,CAACgF,aAAa,EAAE,aAAa,CAAC;OACrD,IAAI,CAAC3C,KAAK,CAAC,cAAc,CAAC;;IAE3B;GACDW,UAAU,EAAE;KACXM,iBAAiB,EAAEL;IACnB;;GAEDlC,QAAQ,EAAG;;;;;;;;;;;;;;;;;;CAkBZ,CAAC;;CC9EM,MAAMkE,QAAQ,GAAG;GACvBpG,KAAK,EAAE;KACNqG,SAAS,EAAE;OACVnG,IAAI,EAAEqC,MAAM;OACZnC,QAAQ,EAAE,KAAK;OACfC,OAAO,EAAE;;IAEV;GACD6B,QAAQ,EAAG;;;;;;;CAOZ,CAAC;;CCbM,MAAMoE,SAAS,GAAG;GACxB3D,IAAI,GACJ;KACC,OAAO;OACN4D,OAAO,EAAE;MACT;IACD;GACDvG,KAAK,EAAE;KACN6D,KAAK,EAAE;OACN3D,IAAI,EAAEqC,MAAM;OACZnC,QAAQ,EAAE;MACV;KACDoG,IAAI,EAAE;OACLtG,IAAI,EAAEqC,MAAM;OACZnC,QAAQ,EAAE,KAAK;OACfC,OAAO,EAAE;MACT;KACDoG,eAAe,EAAE;OAChBvG,IAAI,EAAEC,OAAO;OACbC,QAAQ,EAAE,KAAK;OACfC,OAAO,EAAE;MACT;KACDqG,WAAW,EAAE;OACZxG,IAAI,EAAEC,OAAO;OACbC,QAAQ,EAAE,KAAK;OACfC,OAAO,EAAE;MACT;KACDsG,QAAQ,EAAE;OACTzG,IAAI,EAAEC,OAAO;OACbC,QAAQ,EAAE,KAAK;OACfC,OAAO,EAAE;MACT;KACDuG,aAAa,EAAE;OACd1G,IAAI,EAAE2G,KAAK;OACXxG,OAAO,EAAE;MACT;KACDgG,SAAS,EAAE;OACVnG,IAAI,EAAEqC,MAAM;OACZnC,QAAQ,EAAE;;IAEX;GACDG,QAAQ,EAAE;KACTuG,iBAAiB,GACjB;OACC,MAAMC,MAAM,GAAG,IAAI,CAACH,aAAa,CAACI,MAAM,CAAC,CAACC,GAAG,EAAEC,GAAG,KAAK;SACtDD,GAAG,CAACC,GAAG,CAAC,GAAG,IAAI;SAEf,OAAOD,GAAG;QACV,EAAE,EAAE,CAAC;OAEN,OAAO;SACN,+BAA+B,EAAE,IAAI,CAACN,QAAQ;SAC9C,GAAGI;QACH;;IAEF;GACDlF,OAAO,EAAE;KACRsF,cAAc,CAACrB,IAAc,EAC7B;OACC,IAAI,CAACS,OAAO,CAACa,MAAM,CAACtB,IAAI,CAAC;;IAE1B;GACDjF,OAAO,GACP;KACC,MAAMwG,gBAAgB,GAAG,IAAI,CAAClG,KAAK,CAACkG,gBAAgB;KAEpD,MAAMd,OAAO,GAAG,IAAIe,kBAAO,CAAC;OAC3BzD,KAAK,EAAE,IAAI,CAACA,KAAK;OACjB0D,MAAM,EAAE,IAAI,CAACd,eAAe;OAC5BC,WAAW,EAAE,IAAI,CAACA;MAClB,CAAC;KAEFH,OAAO,CAACiB,MAAM,CAAC,IAAI,CAACrG,KAAK,CAAC2B,OAAO,CAAC;KAClCyD,OAAO,CAACkB,QAAQ,CAACJ,gBAAgB,CAAC;KAClC,IAAI,CAACd,OAAO,GAAGA,OAAO;IACtB;GACDmB,KAAK,EAAE;KACN7D,KAAK,CAAC8D,QAAQ,EACd;OACC,IAAI,CAAC,IAAI,CAACpB,OAAO,EACjB;SACC;;OAGD,IAAI,CAACA,OAAO,CAACqB,UAAU,EAAE,CAAC3G,aAAa,CAAC,oBAAoB,CAAC,CAAC4G,SAAS,GAAGC,cAAI,CAACC,MAAM,CAACJ,QAAQ,CAAC;;IAEhG;GACDxD,UAAU,EAAE;KACXiC;IACA;;GAEDlE,QAAQ,EAAG;;;;;;;;;;CAUZ,CAAC;;CCxGM,MAAM8F,QAAQ,GAAG;GACvB3F,KAAK,EAAE,CAAC,YAAY,CAAC;GACrBrC,KAAK,EAAE;KACN6D,KAAK,EAAE;OACN3D,IAAI,EAAEqC,MAAM;OACZnC,QAAQ,EAAE;MACV;KACDoG,IAAI,EAAE;OACLtG,IAAI,EAAEqC,MAAM;OACZnC,QAAQ,EAAE;MACV;KACDqG,eAAe,EAAE;OAChBvG,IAAI,EAAEC,OAAO;OACbC,QAAQ,EAAE,KAAK;OACfC,OAAO,EAAE;MACT;KACDsG,QAAQ,EAAE;OACTzG,IAAI,EAAEC,OAAO;OACbC,QAAQ,EAAE,KAAK;OACfC,OAAO,EAAE;;IAEV;GACDE,QAAQ,EAAE;KACT0H,cAAc,GACd;OAAA;OACC,sBAAO,IAAI,CAACpE,KAAK,0BAAI,IAAI,CAACqE,YAAY;MACtC;KACDC,aAAa,GACb;OAAA;OACC,qBAAO,IAAI,CAAC3B,IAAI,yBAAI,IAAI,CAAC4B,WAAW;MACpC;KACDF,YAAY,GACZ;OACC,OAAO,EAAE;MACT;KACDE,WAAW,GACX;OACC,OAAO,EAAE;;IAEV;GACDvG,OAAO,EAAE;KACRiE,IAAI,GACJ;OACC,IAAI,IAAI,CAAC3E,KAAK,CAACkH,SAAS,EACxB;SACC,IAAI,CAAClH,KAAK,CAACkH,SAAS,CAAClB,cAAc,CAAC,IAAI,CAAC;;MAE1C;KACDmB,KAAK,GACL;OACC,IAAI,IAAI,CAACnH,KAAK,CAACkH,SAAS,EACxB;SACC,IAAI,CAAClH,KAAK,CAACkH,SAAS,CAAClB,cAAc,CAAC,KAAK,CAAC;;MAE3C;KACDoB,QAAQ,GACR;OACC,OAAO,IAAI;MACX;KACDC,oBAAoB,GACpB;IACA;GACDrE,UAAU,EAAE;KACXsE,IAAI,EAAEnC;;CAER,CAAC;;;;ACnED,CAGO,MAAMoC,UAAU,CACvB;GACC,OAAOC,MAAM,CAACC,OAAe,EAAEC,OAAoB,EACnD;KACC,MAAM/F,OAAO,GAAGgG,aAAG,CAACC,MAAM,cAAC,uCAAqC,EAAC;KACjEjG,OAAO,CAAC+E,SAAS,GAAGe,OAAO;KAE3B,MAAM/F,YAA0B,GAAG;OAClCmG,WAAW,EAAEH,OAAO;OACpBI,QAAQ,EAAE,IAAI;OACdnG,OAAO;OACPC,QAAQ,EAAE,KAAK;OACfmG,WAAW,EAAE;SACZC,QAAQ,EAAE;QACV;OACDC,KAAK,EAAE;SACND,QAAQ,EAAE;QACV;OACDE,SAAS,EAAE;MACX;KAEDjH,gBAAK,CAACkH,UAAU,CAAC;OAChBC,cAAc,EAAE;MAChB,CAAC;KAEF,OAAO,IAAInH,gBAAK,CAACS,YAAY,CAAC;;CAEhC;;CC5BO,MAAM2G,SAAS,GAAG;GACxBxJ,KAAK,EAAE;KACNyJ,YAAY,EAAE;OACbrJ,QAAQ,EAAE,KAAK;OACfC,OAAO,EAAE;MACT;KACDqJ,IAAI,EAAE;OACLxJ,IAAI,EAAEqC,MAAM;OACZnC,QAAQ,EAAE;MACV;KACDyD,KAAK,EAAE;OACN3D,IAAI,EAAEqC,MAAM;OACZnC,QAAQ,EAAE;MACV;KACDuJ,WAAW,EAAE;OACZzJ,IAAI,EAAEqC,MAAM;OACZnC,QAAQ,EAAE,KAAK;OACfC,OAAO,EAAE;MACT;KACDuJ,OAAO,EAAE;OACR1J,IAAI,EAAEC,OAAO;OACbC,QAAQ,EAAE,KAAK;OACfC,OAAO,EAAE;MACT;KACDwJ,YAAY,EAAE;OACb3J,IAAI,EAAEqC,MAAM;OACZnC,QAAQ,EAAE,KAAK;OACfC,OAAO,EAAE;MACT;KACDyJ,UAAU,EAAE;OACX5J,IAAI,EAAEC,OAAO;OACbC,QAAQ,EAAE,KAAK;OACfC,OAAO,EAAE;MACT;KACD0J,QAAQ,EAAE;OACT7J,IAAI,EAAEqC,MAAM;OACZnC,QAAQ,EAAE;;IAEX;GACDiC,KAAK,EAAE,CACN,aAAa,CACb;GACDM,IAAI,GACJ;KACC,OAAO;OACNqH,KAAK,EAAE,IAAI,CAACP,YAAY;OACxBQ,wBAAwB,EAAE;MAC1B;IACD;GACDpI,OAAO,EAAE;KACR2G,oBAAoB,GACpB;OACC,IAAI,CAACyB,wBAAwB,GAAG,IAAI;MACpC;KACDC,aAAa,CAACvC,QAAQ,EACtB;OACC,IAAI,CAACnE,KAAK,CAAC,aAAa,EAAE;SACzBmE,QAAQ;SACRwC,SAAS,EAAE,IAAI,CAACT;QAChB,CAAC;;IAEH;GACDhC,KAAK,EAAE;KACN+B,YAAY,CAAC9B,QAAQ,EACrB;OACC,IAAI,CAACqC,KAAK,GAAGrC,QAAQ;;;CAGxB,CAAC;;CC/DM,MAAMyC,WAAW,GAAG;GAC1BC,OAAO,EAAEb,SAAS;GAClB7G,IAAI,GACJ;KACC,OAAO;OACN2H,UAAU,EAAE,IAAI;OAChBC,iBAAiB,EAAE;MACnB;IACD;GACD1I,OAAO,EAAE;KACR2I,OAAO,CAACC,KAAK,EACb;OACC,IAAI,CAACR,wBAAwB,GAAG,KAAK;OACrC,IAAI,CAACC,aAAa,CAACO,KAAK,CAAC5F,MAAM,CAACmF,KAAK,CAAC;MACtC;KACDU,MAAM,GACN;OACC,IAAI,CAACT,wBAAwB,GAAG,IAAI;OACpC,IAAI,CAAC,IAAI,CAACL,OAAO,EACjB;SACC,IAAI,CAACe,aAAa,EAAE;SACpB,IAAI,CAACJ,iBAAiB,GAAGK,UAAU,CAAC,MAAM;WACzC,IAAI,CAACC,aAAa,EAAE;WACpB,IAAI,CAACN,iBAAiB,GAAG,IAAI;UAC7B,EAAE,IAAI,CAAC;;MAET;KACDI,aAAa,GACb;OACC,IAAI,IAAI,CAACJ,iBAAiB,EAC1B;SACCO,YAAY,CAAC,IAAI,CAACP,iBAAiB,CAAC;SACpC,IAAI,CAACA,iBAAiB,GAAG,IAAI;QAC7B,MAED;SACC,IAAI,CAACD,UAAU,GAAG,IAAI,CAACS,gBAAgB,EAAE;SACzC,IAAI,CAACT,UAAU,CAAC5G,IAAI,EAAE;;MAEvB;KACDmH,aAAa,GACb;OACC,IAAI,IAAI,CAACP,UAAU,EACnB;SACC,IAAI,CAACA,UAAU,CAAChC,KAAK,EAAE;;MAExB;KACDyC,gBAAgB,GAChB;OACC,OAAOrC,UAAU,CAACC,MAAM,CAAC,IAAI,CAACkB,YAAY,EAAE,IAAI,CAAC1I,KAAK,CAAC6J,gBAAgB,CAAC;;IAEzE;GACDnK,OAAO,GACP;KACC,IAAI,IAAI,CAACkJ,QAAQ,EACjB;OACCjJ,aAAG,CAAC0G,MAAM,CAAChG,EAAE,CAACC,EAAE,CAACwJ,IAAI,CAACC,UAAU,CAAC,IAAI,CAACnB,QAAQ,CAAC,EAAE,IAAI,CAAC5I,KAAK,CAAC0C,KAAK,CAAC;;IAEnE;;GAED3B,QAAQ,EAAG;;;;;;;;;;;;;;;;;;;;;;;;;;;;;CA6BZ,CAAC;;CC9FM,MAAMiJ,SAAS,GAAG;GACxBd,OAAO,EAAEb,SAAS;;GAElBtH,QAAQ,EAAG;;;;;;;;;;;;;;;CAeZ,CAAC;;CCfM,MAAMkJ,iBAAiB,GAAG;GAChCpL,KAAK,EAAE;KACNqL,WAAW,EAAE;OACZnL,IAAI,EAAEqC,MAAM;OACZnC,QAAQ,EAAE,KAAK;OACfC,OAAO,EAAE;MACT;KACDiL,kBAAkB,EAAE;OACnBpL,IAAI,EAAEqC,MAAM;OACZnC,QAAQ,EAAE,KAAK;OACfC,OAAO,EAAE;MACT;KACDkL,iBAAiB,EAAE;OAClBrL,IAAI,EAAEuC,MAAM;OACZrC,QAAQ,EAAE,KAAK;OACfC,OAAO,EAAE;MACT;KACDmL,cAAc,EAAE;OACftL,IAAI,EAAEuC,MAAM;OACZrC,QAAQ,EAAE,KAAK;OACfC,OAAO,EAAE;MACT;KACDoL,iBAAiB,EAAE;OAClBvL,IAAI,EAAEqC,MAAM;OACZnC,QAAQ,EAAE;;IAEX;GACDiC,KAAK,EAAE,CACN,aAAa,EACb,kBAAkB,CAClB;GACDR,OAAO,EAAE;KACR6J,aAAa,CAACjB,KAA4B,EAC1C;OACC,IAAI,CAACjH,KAAK,CAAC,aAAa,EAAEiH,KAAK,CAAC;MAChC;KACDjC,oBAAoB,GACpB;OACC,IAAI,CAACrH,KAAK,CAACwK,SAAS,CAACnD,oBAAoB,EAAE;;IAE5C;GACDrE,UAAU,EAAE;KACXiG,WAAW;KACXe;IACA;;GAEDjJ,QAAQ,EAAG;;;;;;;;;;;;;;;;;;;;;CAqBZ,CAAC;;CCnEM,MAAM0J,qBAAqB,GAAG;GACpCvB,OAAO,EAAErC,QAAQ;GACjBhI,KAAK,EAAE;KACNyL,iBAAiB,EAAE;OAClBvL,IAAI,EAAEqC,MAAM;OACZnC,QAAQ,EAAE;MACV;KACDyL,aAAa,EAAE;OACd3L,IAAI,EAAE2G,KAAK;OACXzG,QAAQ,EAAE,KAAK;OACfC,OAAO,EAAE;;IAEV;GACDgC,KAAK,EAAE,CAAC,mBAAmB,CAAC;GAC5B9B,QAAQ,EAAE;KACTuL,iBAAiB,GACjB;OACC,OAAO,IAAI,CAACC,MAAM,CAACC,KAAK,CAACC,MAAM,CAACH,iBAAiB;MACjD;KACD5D,YAAY,GACZ;OACC,OAAO,IAAI,CAACxH,OAAO,CAACC,GAAG,CAACC,UAAU,CAAC,kCAAkC,CAAC;MACtE;KACDwH,WAAW,GACX;OACC,IAAI,IAAI,CAAC9H,UAAU,EACnB;SACC,OAAO,EAAE;;OAGV,OAAO,IAAI,CAACI,OAAO,CAACC,GAAG,CAACC,UAAU,CAAC,gCAAgC,CAAC;MACpE;KACD4K,cAAc,GACd;OACC,OAAO;SACN9B,IAAI,EAAE,IAAI,CAACqC,MAAM,CAACG,OAAO,CAAC5L;QAC1B;MACD;KACDiL,iBAAiB,GACjB;OACC,MAAMY,MAAM,GAAG,EAAE;OACjB,MAAMC,oBAAoB,GAAG,IAAI,CAACC,YAAY,EAAE;OAChD,IAAI,CAACD,oBAAoB,CAACD,MAAM,EAChC;SACCA,MAAM,CAACzC,IAAI,GAAG0C,oBAAoB;;OAGnC,OAAOD,MAAM;MACb;KACD7L,UAAU,GACV;OACC,OAAO,IAAI,CAACyL,MAAM,CAACG,OAAO,CAAC5L,UAAU;;IAEtC;GACD6D,UAAU,EAAE;KACXsE,IAAI,EAAEnC,SAAS;KACf8E;IACA;GACDvJ,OAAO,EAAE;KACRyK,+BAA+B,CAAC7B,KAA4B,EAC5D;OACC,MAAMqB,iBAAiB,GAAG,IAAI,CAACA,iBAAiB;OAChDA,iBAAiB,CAACrB,KAAK,CAACN,SAAS,CAAC,GAAGM,KAAK,CAAC9C,QAAQ;OACnD,IAAI,CAACoE,MAAM,CAACQ,MAAM,CAAC,sBAAsB,EAAET,iBAAiB,CAAC;OAC7D,IAAI,CAACvD,QAAQ,EAAE;OAEf,IAAI,CAAC/E,KAAK,CAAC,mBAAmB,CAAC;MAC/B;KACD+E,QAAQ,GACR;OACC,IAAI4D,MAAM,GAAG,IAAI;OACjB,IAAI,CAAC,IAAI,CAAC7L,UAAU,EACpB;SACC6L,MAAM,GAAG1J,MAAM,CAAC+J,IAAI,CAAC,IAAI,CAACjB,iBAAiB,CAAC,CAACkB,MAAM,KAAK,CAAC;;OAG1D,IAAI,CAACjJ,KAAK,CAAC,YAAY,EAAE2I,MAAM,CAAC;OAEhC,OAAOA,MAAM;MACb;KACDE,YAAY,GACZ;OACC,MAAM3C,IAAI,GAAG,IAAI,CAACqC,MAAM,CAACC,KAAK,CAACC,MAAM,CAACH,iBAAiB,CAACpC,IAAI;OAC5D,IAAI,CAACA,IAAI,EACT;SACC,OAAO;WACNyC,MAAM,EAAE;UACR;;OAGF,MAAMO,UAAU,GAAG,IAAI,CAACb,aAAa,CAACc,QAAQ,CAACjD,IAAI,CAAC;OACpD,IAAIgD,UAAU,EACd;SACC,OAAO;WACNP,MAAM,EAAE,KAAK;WACbvD,OAAO,EAAE,IAAI,CAAClI,OAAO,CAACC,GAAG,CAACC,UAAU,CAAC,gDAAgD;UACrF;;OAGF,IAAI8I,IAAI,CAAC+C,MAAM,GAAG,EAAE,EACpB;SACC,OAAO;WACNN,MAAM,EAAE,KAAK;WACbvD,OAAO,EAAE,IAAI,CAAClI,OAAO,CAACC,GAAG,CAACC,UAAU,CAAC,kDAAkD;UACvF;;OAGF,IAAI,CAAC,kBAAkB,CAACgM,IAAI,CAAClD,IAAI,CAAC,EAClC;SACC,OAAO;WACNyC,MAAM,EAAE,KAAK;WACbvD,OAAO,EAAE,IAAI,CAAClI,OAAO,CAACC,GAAG,CAACC,UAAU,CAAC,uDAAuD;UAC5F;;OAGF,OAAO;SACNuL,MAAM,EAAE;QACR;MACD;KACD3D,oBAAoB,GACpB;OACC,IAAI,CAACrH,KAAK,CAAC2K,iBAAiB,CAACtD,oBAAoB,EAAE;;IAEpD;GACDtG,QAAQ,EAAG;;;;;;;;;;;;;;;;;;;;CAoBZ,CAAC;;CClJM,MAAM2K,WAAW,GAAG;GAC1B7M,KAAK,EAAE;KACN8M,OAAO,EAAE;OACR5M,IAAI,EAAEC,OAAO;OACbC,QAAQ,EAAE,KAAK;OACfC,OAAO,EAAE;MACT;KACD0M,aAAa,EAAE;OACd7M,IAAI,EAAEC,OAAO;OACbC,QAAQ,EAAE,KAAK;OACfC,OAAO,EAAE;;IAEV;GACDgC,KAAK,EAAE,CACN,eAAe,CACf;GACD9B,QAAQ,EAAE;KACTyM,0BAA0B,GAC1B;OAAA;OACC,0DAAO,IAAI,CAACjB,MAAM,CAACC,KAAK,CAACC,MAAM,CAACgB,cAAc,qBAAvC,uBAAyCC,eAAe,oCAAI,IAAI;;IAExE;GACDrL,OAAO,EAAE;KACRsL,eAAe,CAAC1C,KAAK,EACrB;OACCA,KAAK,CAAC2C,cAAc,EAAE;OACtB,IAAI,CAAC5J,KAAK,CAAC,eAAe,CAAC;;IAE5B;;GAEDtB,QAAQ,EAAG;;;;;;;;;;CAUZ,CAAC;;CCpCD,MAAMmL,QAAQ,GAAG;GAChBC,MAAM,EAAE,QAAQ;GAChBC,KAAK,EAAE,OAAO;GACdC,GAAG,EAAE,KAAK;GACVC,MAAM,EAAE,QAAQ;GAChBC,IAAI,EAAE,MAAM;GACZC,QAAQ,EAAE;CACX,CAAC;CAED,MAAMC,oBAAyD,GAAG;GACjE,CAACP,QAAQ,CAACC,MAAM,GAAG;KAClBzJ,KAAK,EAAElD,aAAG,CAACC,UAAU,CAAC,yCAAyC,CAAC;KAChEiN,IAAI,EAAE;IACN;GACD,CAACR,QAAQ,CAACE,KAAK,GAAG;KACjB1J,KAAK,EAAElD,aAAG,CAACC,UAAU,CAAC,0CAA0C,CAAC;KACjEiN,IAAI,EAAE;IACN;GACD,CAACR,QAAQ,CAACG,GAAG,GAAG;KACf3J,KAAK,EAAElD,aAAG,CAACC,UAAU,CAAC,2CAA2C,CAAC;KAClEiN,IAAI,EAAE;IACN;GACD,CAACR,QAAQ,CAACI,MAAM,GAAG;KAClB5J,KAAK,EAAElD,aAAG,CAACC,UAAU,CAAC,4CAA4C,CAAC;KACnEiN,IAAI,EAAE;IACN;GACD,CAACR,QAAQ,CAACK,IAAI,GAAG;KAChB7J,KAAK,EAAElD,aAAG,CAACC,UAAU,CAAC,yCAAyC,CAAC;KAChEiN,IAAI,EAAE;IACN;GACD,CAACR,QAAQ,CAACM,QAAQ,GAAG;KACpB9J,KAAK,EAAElD,aAAG,CAACC,UAAU,CAAC,6CAA6C,CAAC;KACpEiN,IAAI,EAAE;;CAER,CAAC;;CCxC6D;CAAA;CAAA;CAAA;AAS9D,CAAO,MAAMC,YAAY,CACzB;GAMCC,WAAW,CAACvL,OAA4B,EACxC;KAAA;OAAA;OAAA;;KAAA;OAAA;OAAA;;KAAA;OAAA;OAAA;;KAAA;OAAA;OAAA;;KACC,4CAAI,kCAAiBA,OAAO,CAACwL,YAAY;KACzC,4CAAI,gCAAgBxL,OAAO,CAACwG,WAAW;KACvC,4CAAI,0BAAaxG,OAAO,CAACyL,QAAQ;KACjC,4CAAI,wBAAYzL,OAAO,CAAC0B,OAAO;;GAGhCgK,OAAO,GACP;KACC,MAAMC,KAAK,GAAG,EAAE;KAChB1L,MAAM,CAAC2L,OAAO,CAACR,oBAAoB,CAAC,CAACS,OAAO,CAAC,CAAC,CAACnH,GAAG,EAAE8C,KAAK,CAAC,KAAK;OAC9DmE,KAAK,CAACG,IAAI,CAAC;SACVC,IAAI,EAAG;+BACoBvE,KAAK,CAAC6D,IAAK;sDACY7D,KAAK,CAACnG,KAAM;OAC3DqD,GAAG,6CAAK,IAAI,+BAAc,GAAG,8EAA8E,GAAG,EAAG;KACnH;SACDsH,OAAO,EAAE,CAAC/D,KAAK,EAAEgE,IAAI,KAAK;WACzB,4CAAI,wBAAWvH,GAAG;WAClBuH,IAAI,CAACC,aAAa,EAAE,CAACpG,KAAK,EAAE;UAC5B;SACDqG,SAAS,EAAG,8BAA6BzH,GAAG,6CAAK,IAAI,+BAAc,GAAG,sCAAsC,GAAG,EAAG;QAClH,CAAC;MACF,CAAC;KAEF,OAAO,IAAI0H,eAAI,CAAC;OACfD,SAAS,EAAE,8BAA8B;OACzC3F,WAAW,0CAAE,IAAI,6BAAa;OAC9BmF,KAAK;OACLnL,MAAM,EAAE;SACPkB,OAAO,0CAAE,IAAI;;MAEd,CAAC;;CAEJ;;CCjDO,MAAM2K,gBAAgB,GAAG;GAC/B7O,KAAK,EAAE;KACNgO,YAAY,EAAE;OACb9N,IAAI,EAAEqC,MAAM;OACZnC,QAAQ,EAAE,KAAK;OACfC,OAAO,EAAE;MACT;KACDC,UAAU,EAAE;OACXJ,IAAI,EAAEC,OAAO;OACbC,QAAQ,EAAE,KAAK;OACfC,OAAO,EAAE;;IAEV;GACDgC,KAAK,EAAE,CACN,aAAa,CACb;GACDM,IAAI,GACJ;KACC,OAAO;OACNmM,QAAQ,EAAE,IAAI;OACdC,SAAS,EAAE;MACX;IACD;GACDxO,QAAQ,EAAE;KACTyO,SAAS,GACT;OACC,OAAOpB,oBAAoB,CAAC,IAAI,CAACI,YAAY,CAAC,CAACH,IAAI;MACnD;KACDoB,SAAS,GACT;OACC,OAAOrB,oBAAoB,CAAC,IAAI,CAACI,YAAY,CAAC,CAACnK,KAAK;;IAErD;GACDhC,OAAO,EAAE;KACR2C,OAAO,CAACiG,KAAK,EACb;OACC,IAAI,IAAI,CAACnK,UAAU,EACnB;SACC;;OAGD,IAAI,CAACyO,SAAS,GAAG,IAAI;OAErB,IAAI,CAAC,IAAI,CAACD,QAAQ,EAClB;SACC;;OAGD,IAAI,CAACA,QAAQ,CAACI,cAAc,EAAE,CAACC,QAAQ,CAAC,IAAI,CAAChO,KAAK,CAACiO,YAAY,CAACC,WAAW,CAAC;OAC5E,IAAI,CAACP,QAAQ,CAACpL,IAAI,EAAE;MACpB;KACD4L,UAAU,GACV;OACC,IAAI,CAAC,IAAI,CAAChP,UAAU,EACpB;SACC,IAAI,CAACwO,QAAQ,GAAI,IAAIhB,YAAY,CAAC;WACjCE,YAAY,EAAE,IAAI,CAACA,YAAY;WAC/BhF,WAAW,EAAE,IAAI,CAAC7H,KAAK,CAACiO,YAAY;WACpCnB,QAAQ,EAAGD,YAAY,IAAK;aAC3B,IAAI,CAACxK,KAAK,CAAC,aAAa,EAAEwK,YAAY,CAAC;YACvC;WACD9J,OAAO,EAAE,MAAM;aACd,IAAI,CAAC6K,SAAS,GAAG,KAAK;;UAEvB,CAAC,CAAEb,OAAO,EAAE;;MAEd;KACDqB,WAAW,GACX;OAAA;OACC,sBAAI,CAACT,QAAQ,qBAAb,eAAevL,OAAO,EAAE;;IAEzB;GACD1C,OAAO,GACP;KACC,IAAI,CAACyO,UAAU,EAAE;IACjB;GACD3L,aAAa,GACb;KACC,IAAI,CAAC4L,WAAW,EAAE;IAClB;GACD7H,KAAK,EAAE;KACNsG,YAAY,CAACrG,QAAQ,EACrB;OACC,IAAI,CAAC4H,WAAW,EAAE;OAClB,IAAI,CAACD,UAAU,EAAE;;IAElB;;GAEDpN,QAAQ,EAAG;;;;;;;;;;;;;;;;;;;;;CAqBZ,CAAC;;CCzGM,MAAMsN,QAAQ,GAAG;GACvBC,UAAU,EAAE;WACXjJ;IACA;GACDxG,KAAK,EAAE;KACN8M,OAAO,EAAE;OACR5M,IAAI,EAAEC,OAAO;OACbC,QAAQ,EAAE,KAAK;OACfC,OAAO,EAAE;MACT;KACDqP,KAAK,EAAE;OACNxP,IAAI,EAAEkF,MAAM;OACZhF,QAAQ,EAAE;MACV;KACDuP,aAAa,EAAE;OACdzP,IAAI,EAAEuC,MAAM;OACZrC,QAAQ,EAAE,KAAK;OACfC,OAAO,EAAE;MACT;KACDuP,aAAa,EAAE;OACd1P,IAAI,EAAEuC,MAAM;OACZrC,QAAQ,EAAE,KAAK;OACfC,OAAO,EAAE;MACT;KACDC,UAAU,EAAE;OACXJ,IAAI,EAAEC,OAAO;OACbC,QAAQ,EAAE,KAAK;OACfC,OAAO,EAAE;;IAEV;GACDsC,IAAI,GACJ;KACC,OAAO;OACNkN,yBAAyB,EAAE;SAC1BnG,IAAI,EAAE;QACN;OACDY,UAAU,EAAE;SACXZ,IAAI,EAAE;QACN;OACDa,iBAAiB,EAAE;MACnB;IACD;GACDhK,QAAQ,EAAE;KACTuP,WAAW,GACX;OACC,OAAO,EAAE,MAAM,IAAI,IAAI,CAACF,aAAa,CAAC;MACtC;KACDG,qBAAqB,GACrB;OACC,OAAO,IAAI,CAACH,aAAa,CAAClG,IAAI,CAACd,OAAO;MACtC;KACDoH,GAAG,GACH;OACC,OAAOC,sBAAG;MACV;KACDC,iBAAiB,GACjB;OACC,MAAMC,YAAY,GAAG,IAAI,CAACR,aAAa,CAACQ,YAAY;OACpD,MAAMC,YAAY,GAAG,IAAI,CAACT,aAAa,CAACS,YAAY;OAEpD,IAAIC,QAAQ,GAAG,EAAE;OACjB,IAAIF,YAAY,EAChB;SACCE,QAAQ,GAAG,IAAI,CAAC3P,OAAO,CAACC,GAAG,CAACC,UAAU,CAAC,yCAAyC,EAAE;WACjF,SAAS,EAAE,8CAA8C;WACzD,UAAU,EAAE,SAAS;WACrB,YAAY,EAAEgN,oBAAoB,CAACuC,YAAY,CAAC,CAACtM;UACjD,CAAC;;OAGH,MAAMyM,QAAQ,GAAG,IAAI,CAAC5P,OAAO,CAACC,GAAG,CAACC,UAAU,CAAC,yCAAyC,EAAE;SACvF,SAAS,EAAE,8CAA8C;SACzD,UAAU,EAAE,SAAS;SACrB,aAAa,EAAEwP;QACf,CAAC;OAEF,IAAI,CAACD,YAAY,EACjB;SACC,OAAOG,QAAQ;;OAGhB,OAAQ,GAAED,QAAS,OAAMC,QAAS,EAAC;MACnC;KACDtD,0BAA0B,GAC1B;OAAA;OACC,OAAO,oDAAC,IAAI,CAACjB,MAAM,CAACC,KAAK,CAACC,MAAM,CAACgB,cAAc,qBAAvC,uBAAyCC,eAAe,oCAAI,IAAI,gCACpE,IAAI,CAACnB,MAAM,CAACC,KAAK,CAACC,MAAM,CAACsE,oBAAoB,qBAA7C,uBAA+CC,cAAc;MAEjE;KACDC,WAAW,GACX;OACC,OAAO;SACNlC,IAAI,EAAE,IAAI,CAAC2B,iBAAiB;SAC5BrN,YAAY,EAAE;WACbuG,KAAK,EAAE;aACND,QAAQ,EAAE;YACV;WACDuH,UAAU,EAAE,EAAE;WACdC,SAAS,EAAE,CAAC,EAAE;WACd5N,QAAQ,EAAE;;QAEX;;IAEF;GACDV,KAAK,EAAE,CACN,eAAe,EACf,aAAa,CACb;GACDR,OAAO,EAAE;KACRsL,eAAe,CAAC1C,KAAK,EACrB;OACCA,KAAK,CAAC2C,cAAc,EAAE;OACtB,IAAI,CAAC5J,KAAK,CAAC,eAAe,EAAE;SAC3BkM,KAAK,EAAE,IAAI,CAACA;QACZ,CAAC;MACF;KACDkB,cAAc,CAAC1Q,IAAI,EACnB;OACC,IAAI,CAACsD,KAAK,CAAC,aAAa,EAAE;SACzB2G,SAAS,EAAE,MAAM;SACjBH,KAAK,EAAE9J,IAAI;SACXwP,KAAK,EAAE,IAAI,CAACA;QACZ,CAAC;MACF;KACDmB,YAAY,CAACpG,KAAK,EAClB;OACC,IAAI,CAACoF,yBAAyB,CAACpF,KAAK,CAAC5F,MAAM,CAAC6E,IAAI,CAAC,GAAG,KAAK;OACzD,IAAI,CAAClG,KAAK,CAAC,aAAa,EAAE;SACzB2G,SAAS,EAAEM,KAAK,CAAC5F,MAAM,CAAC6E,IAAI;SAC5BM,KAAK,EAAES,KAAK,CAAC5F,MAAM,CAACmF,KAAK;SACzB0F,KAAK,EAAE,IAAI,CAACA;QACZ,CAAC;MACF;KACDoB,WAAW,CAACrG,KAAK,EACjB;OACC,IAAI,CAACoF,yBAAyB,CAACpF,KAAK,CAAC5F,MAAM,CAAC6E,IAAI,CAAC,GAAG,IAAI;OAExD,IAAI,MAAM,IAAI,IAAI,CAACkG,aAAa,EAChC;SACC,IAAI,CAACjF,aAAa,EAAE;SACpB,IAAI,CAACJ,iBAAiB,GAAGK,UAAU,CAAC,MAAM;WACzC,IAAI,CAACC,aAAa,EAAE;WACpB,IAAI,CAACN,iBAAiB,GAAG,IAAI;UAC7B,EAAE,IAAI,CAAC;;MAET;KACD/B,oBAAoB,GACpB;OACC/F,MAAM,CAAC+J,IAAI,CAAC,IAAI,CAACqD,yBAAyB,CAAC,CAACxB,OAAO,CAAE0C,KAAK,IAAK;SAC9D,IAAI,CAAClB,yBAAyB,CAACkB,KAAK,CAAC,GAAG,IAAI;QAC5C,CAAC;MACF;KACDpG,aAAa,GACb;OACC,IAAI,IAAI,CAACJ,iBAAiB,EAC1B;SACCO,YAAY,CAAC,IAAI,CAACP,iBAAiB,CAAC;SACpC,IAAI,CAACA,iBAAiB,GAAG,IAAI;QAC7B,MAED;SACC,IAAI,CAACD,UAAU,CAACZ,IAAI,GAAG,IAAI,CAACqB,gBAAgB,EAAE;SAC9C,IAAI,CAACT,UAAU,CAACZ,IAAI,CAAChG,IAAI,EAAE;;MAE5B;KACDmH,aAAa,GACb;OACC,IAAI,IAAI,CAACP,UAAU,CAACZ,IAAI,EACxB;SACC,IAAI,CAACY,UAAU,CAACZ,IAAI,CAACpB,KAAK,EAAE;;MAE7B;KACDyC,gBAAgB,GAChB;OACC,OAAOrC,UAAU,CAACC,MAAM,CAAC,IAAI,CAACoH,qBAAqB,EAAE,IAAI,CAAC5O,KAAK,CAAC6J,gBAAgB,CAAC;;IAElF;GACDtD,KAAK,EAAE;KACNsF,0BAA0B,GAC1B;OACC,IAAI,IAAI,CAAC7L,KAAK,CAAC6P,aAAa,EAC5B;SACC,IAAI,CAAC7P,KAAK,CAAC6P,aAAa,CAACC,MAAM,EAAE;;;IAGnC;GACD9M,UAAU,EAAE;KACX+M,cAAc,EAAErC,gBAAgB;YAChCsC;IACA;;GAEDjP,QAAQ,EAAG;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;CAkDZ,CAAC;;CCpPM,MAAMkP,WAAW,GAAG;GAC1BpR,KAAK,EAAE;KACNqR,cAAc,EAAE;OACfnR,IAAI,EAAE2G,KAAK;OACXzG,QAAQ,EAAE;MACV;KACDkR,eAAe,EAAE;OAChBpR,IAAI,EAAEuC,MAAM;OACZrC,QAAQ,EAAE;MACV;KACDE,UAAU,EAAE;OACXJ,IAAI,EAAEC,OAAO;OACbC,QAAQ,EAAE,KAAK;OACfC,OAAO,EAAE;;IAEV;GACDgC,KAAK,EAAE,CACN,WAAW,EACX,cAAc,EACd,iBAAiB,CACjB;GACD9B,QAAQ,EAAE;KACTgR,iBAAiB,GACjB;OACC,OAAO,IAAI,CAACxF,MAAM,CAACG,OAAO,CAACqF,iBAAiB;MAC5C;KACDC,gBAAgB,GAChB;OACC,OAAO,IAAI,CAACzF,MAAM,CAACG,OAAO,CAACsF,gBAAgB;MAC3C;KACDC,kBAAkB,GAClB;OACC,OAAO,IAAI,CAAC1F,MAAM,CAACG,OAAO,CAACuF,kBAAkB;;IAE9C;GACD5P,OAAO,EAAE;KACR6P,oBAAoB,CAACjH,KAAK,EAC1B;OACC,IAAI,CAACjH,KAAK,CAAC,WAAW,EAAEiH,KAAK,CAAC;MAC9B;KACDkH,uBAAuB,GACvB;OACC,IAAI,CAACnO,KAAK,CAAC,cAAc,CAAC;MAC1B;KACDoO,iBAAiB,CAACnH,KAAK,EACvB;OACC,IAAI,CAACjH,KAAK,CAAC,iBAAiB,EAAEiH,KAAK,CAAC;MACpC;KACDjC,oBAAoB,GACpB;OACC,MAAMqJ,UAAU,GAAGpP,MAAM,CAAC+J,IAAI,CAAC,IAAI,CAAC8E,eAAe,CAAC;OACpDO,UAAU,CAACxD,OAAO,CAAEqB,KAAK,IAAK;SAC7B,IAAI,IAAI,CAACvO,KAAK,CAAC2Q,GAAG,CAACpC,KAAK,CAAC,EACzB;WACC,IAAI,CAACvO,KAAK,CAAC2Q,GAAG,CAACpC,KAAK,CAAC,CAAClH,oBAAoB,EAAE;;QAE7C,CAAC;;IAEH;GACDrE,UAAU,EAAE;KACX0I,WAAW;KACX2C;IACA;;GAEDtN,QAAQ,EAAG;;;;;;;;;;;;;;;;;;;;;CAqBZ,CAAC;;CCpFM,MAAM6P,kBAAkB,GAAG;GACjC1P,KAAK,EAAE,CAAC,uBAAuB,EAAE,iBAAiB,CAAC;GACnDgI,OAAO,EAAErC,QAAQ;GACjBzH,QAAQ,EAAE;KACT8Q,cAAc,GACd;OACC,OAAO,IAAI,CAACtF,MAAM,CAACC,KAAK,CAACC,MAAM,CAACoF,cAAc;MAC9C;KACDnJ,YAAY,GACZ;OACC,OAAO,IAAI,CAACxH,OAAO,CAACC,GAAG,CAACC,UAAU,CAAC,uCAAuC,CAAC;MAC3E;KACDwH,WAAW,GACX;OACC,IAAI,IAAI,CAAC9H,UAAU,EACnB;SACC,OAAO,IAAI,CAACI,OAAO,CAACC,GAAG,CAACC,UAAU,CAAC,0CAA0C,CAAC,CAC5EoR,OAAO,CAAC,QAAQ,EAAE,mEAAmE,CAAC,CACtFA,OAAO,CAAC,SAAS,EAAE,MAAM,CAAC;;OAI7B,OAAO,IAAI,CAACtR,OAAO,CAACC,GAAG,CAACC,UAAU,CAAC,qCAAqC,CAAC,CACvEoR,OAAO,CAAC,QAAQ,EAAE,mEAAmE,CAAC,CACtFA,OAAO,CAAC,SAAS,EAAE,MAAM,CAAC;MAE5B;KACDV,eAAe,GACf;OACC,MAAMW,IAAI,GAAG,EAAE;OAEf,IAAI,CAAClG,MAAM,CAACC,KAAK,CAACC,MAAM,CAACoF,cAAc,CAAChD,OAAO,CAAC,CAAC0C,KAAK,EAAErB,KAAK,KAAK;SACjE,MAAME,aAAa,GAAG,EAAE;SAExB,IAAI,CAAC,IAAI,CAACtP,UAAU,EACpB;WACC,MAAM8L,oBAAoB,GAAG,IAAI,CAACC,YAAY,CAAC0E,KAAK,CAACrH,IAAI,CAAC;WAC1D,IAAI,CAAC0C,oBAAoB,CAACD,MAAM,EAChC;aACCyD,aAAa,CAAClG,IAAI,GAAG0C,oBAAoB;;;SAI3C,IAAI3J,MAAM,CAAC+J,IAAI,CAACoD,aAAa,CAAC,CAACnD,MAAM,GAAG,CAAC,EACzC;WACCwF,IAAI,CAACvC,KAAK,CAAC,GAAGE,aAAa;;QAE5B,CAAC;OAEF,OAAOqC,IAAI;MACX;KACD3R,UAAU,GACV;OACC,OAAO,IAAI,CAACyL,MAAM,CAACG,OAAO,CAAC5L,UAAU;;IAEtC;GACDuB,OAAO,EAAE;KACRwK,YAAY,CAAC3C,IAAI,EACjB;OACC,MAAMwI,UAAU,GAAGxI,IAAI,CAAC+C,MAAM,GAAG,CAAC;OAClC,IAAI,CAACyF,UAAU,EACf;SACC,OAAO;WACN/F,MAAM,EAAE,KAAK;WACbvD,OAAO,EAAE,IAAI,CAAClI,OAAO,CAACC,GAAG,CAACC,UAAU,CAAC,6CAA6C;UAClF;;OAGF,MAAMuR,SAAS,GAAGzI,IAAI,CAAC+C,MAAM,GAAG,EAAE;OAClC,IAAI0F,SAAS,EACb;SACC,OAAO;WACNhG,MAAM,EAAE,KAAK;WACbvD,OAAO,EAAE,IAAI,CAAClI,OAAO,CAACC,GAAG,CAACC,UAAU,CAAC,gDAAgD;UACrF;;;;OAIF,MAAMwR,kBAAkB,GAAG,+BAA+B,CAACxF,IAAI,CAAClD,IAAI,CAAC;OACrE,IAAI,CAAC0I,kBAAkB,EACvB;SACC,OAAO;WACNjG,MAAM,EAAE,KAAK;WACbvD,OAAO,EAAE,IAAI,CAAClI,OAAO,CAACC,GAAG,CAACC,UAAU,CAAC,qDAAqD;UAC1F;;OAGF,MAAMyR,aAAa,GAAG,IAAI,CAACtG,MAAM,CAACG,OAAO,CAACoG,cAAc,CAACtL,MAAM,CAAC,CAC/DuL,KAAK,EACLvI,KAAK,KACAN,IAAI,KAAKM,KAAK,GAAGuI,KAAK,GAAG,CAAC,GAAGA,KAAM,EAAE,CAAC,CAAC,GAAG,CAAC;OACjD,IAAIF,aAAa,EACjB;SACC,OAAO;WACNlG,MAAM,EAAE,KAAK;WACbvD,OAAO,EAAE,IAAI,CAAClI,OAAO,CAACC,GAAG,CAACC,UAAU,CAAC,oDAAoD;UACzF;;OAGF,OAAO;SACNuL,MAAM,EAAE;QACR;MACD;KACDqG,YAAY,CAAC/H,KAAK,EAClB;OACC,IAAI,CAACsB,MAAM,CAACQ,MAAM,CAAC,qBAAqB,EAAE9B,KAAK,CAACiF,KAAK,CAAC;OACtD,IAAI,CAAClM,KAAK,CAAC,iBAAiB,CAAC;MAC7B;KACDiP,eAAe,CAAChI,KAAK,EACrB;OACC,IAAI,IAAI,CAACsB,MAAM,CAACG,OAAO,CAACqF,iBAAiB,EACzC;SACC,IAAI,CAACxF,MAAM,CAACQ,MAAM,CAAC,qBAAqB,CAAC;QACzC,MAED;SACC,IAAI,CAACR,MAAM,CAACQ,MAAM,CAAC,mBAAmB,CAAC;;OAGxC,IAAI,CAAC/I,KAAK,CAAC,iBAAiB,CAAC;MAC7B;KACDoO,iBAAiB,CAACnH,KAAK,EACvB;OACC,IAAI,CAAC4G,cAAc,CAAC5G,KAAK,CAACiF,KAAK,CAAC,CAACjF,KAAK,CAACN,SAAS,CAAC,GAAGM,KAAK,CAACT,KAAK;OAC/D,IAAI,CAAC+B,MAAM,CAACQ,MAAM,CAAC,qBAAqB,EAAE;SACzCmD,KAAK,EAAEjF,KAAK,CAACiF,KAAK;SAClBgD,QAAQ,EAAE,IAAI,CAACrB,cAAc,CAAC5G,KAAK,CAACiF,KAAK;QACzC,CAAC;OAEF,IAAIjF,KAAK,CAACN,SAAS,KAAK,MAAM,EAC9B;SACC,IAAI,CAAC3G,KAAK,CAAC,uBAAuB,CAAC;;OAGpC,IAAI,CAACA,KAAK,CAAC,iBAAiB,CAAC;OAE7B,IAAI,CAAC+E,QAAQ,EAAE;MACf;KACDA,QAAQ,GACR;OACC,MAAM4D,MAAM,GAAG1J,MAAM,CAAC+J,IAAI,CAAC,IAAI,CAAC8E,eAAe,CAAC,CAAC7E,MAAM,KAAK,CAAC;OAE7D,IAAI,CAACjJ,KAAK,CAAC,YAAY,EAAE2I,MAAM,CAAC;OAEhC,OAAOA,MAAM;MACb;KACD3D,oBAAoB,GACpB;OACC,IAAI,CAACrH,KAAK,CAACwR,WAAW,CAACnK,oBAAoB,EAAE;;IAE9C;GACDrE,UAAU,EAAE;KACXsE,IAAI,EAAEnC,SAAS;KACf8K;IACA;;GAEDlP,QAAQ,EAAG;;;;;;;;;;;;;;;;;;;;;CAqBZ,CAAC;;;;;;;;;;ACtLD,CAcA,MAAM0Q,UAAU,GAAG;GAClBC,MAAM,EAAE,QAAQ;GAChBC,KAAK,EAAE;CACR,CAAC;CAAC;CAAA;CAAA;AAQF,CAAO,MAAMC,cAAc,CAC3B;GACC,OAAOC,UAAU,CAACC,QAAgB,EAAEC,mBAAuC,EAAEhP,OAAiB,EAC9F;KACC1C,EAAE,CAAC2R,SAAS,CAACC,QAAQ,CAACtN,IAAI,CAAC,kCAAkC,EAAE;OAC9DhC,KAAK,EAAE,GAAG;OACVuP,eAAe,EAAE,MAAM;SACtB,OAAOC,0BAAM,CAACC,aAAa,CAAC;WAC3BC,UAAU,EAAE,CAAC,UAAU,EAAE,gBAAgB,EAAE,WAAW,EAAE,4BAA4B,CAAC;WACrF3P,KAAK,EAAElD,aAAG,CAACC,UAAU,CAAC,4CAA4C,CAAC;WACnEkC,OAAO,GACP;aACC,+CAAOiQ,cAAc,4BAAaE,QAAQ,EAAEC,mBAAmB;YAC/D;WACDO,OAAO,CAAC;aAAEC,YAAY;aAAEC;YAAY,EACpC;aACC,OAAO,CACN,IAAIA,UAAU,CAAC;eACdnF,OAAO,EAAE,MAAM;;iBAEd,MAAMoF,IAAI,GAAGpS,EAAE,CAAC2R,SAAS,CAACC,QAAQ,CAACS,YAAY,EAAE,CAACC,YAAY,EAAE,CAAC7S,aAAa,CAAC,qBAAqB,CAAC;iBACrGiD,OAAO,yCAAC6O,cAAc,kCAAgBa,IAAI,EAAE;iBAC5CpS,EAAE,CAAC2R,SAAS,CAACC,QAAQ,CAAC9K,KAAK,EAAE;;cAE9B,CAAC,EACFoL,YAAY,CACZ;;UAEF,CAAC;;MAEH,CAAC;;CAoKJ;CAAC,yBAjKsBE,IAAI,EAC1B;GACC,MAAMG,QAAQ,GAAG,IAAIC,QAAQ,CAACJ,IAAI,CAAC;GAEnC,MAAMzH,MAAM,GAAG1J,MAAM,CAACwR,WAAW,CAACF,QAAQ,CAAC;GAE3C,MAAMG,qBAAqB,GAAG,CAAC,MAAM,EAAE,UAAU,CAAC;GAElDA,qBAAqB,CAAC7F,OAAO,CAAE0C,KAAK,IAAK;KACxC,IAAI5E,MAAM,CAAC4E,KAAK,CAAC,KAAK,QAAQ,EAC9B;OACC5E,MAAM,CAAC4E,KAAK,CAAC,GAAG5E,MAAM,CAAE,GAAE4E,KAAM,aAAY,CAAC;;KAG9C,OAAO5E,MAAM,CAAE,GAAE4E,KAAM,aAAY,CAAC;IACpC,CAAC;GAEF,OAAO5E,MAAM;CACd;CAAC,sBAEkB8G,QAAgB,EAAEC,mBAAuC,EAC5E;GACC,MAAMiB,QAAQ,GAAGrL,aAAG,CAACC,MAAM,oBAAC;;;GAG5B,EAAC;GAEDjI,aAAG,CAAC0G,MAAM,yCAACuL,cAAc,4CAAqB;KAC7ClP,KAAK,EAAElD,aAAG,CAACC,UAAU,CAAC,2CAA2C,CAAC;KAClEwT,QAAQ,EAAEzT,aAAG,CAACC,UAAU,CAAC,gDAAgD,CAAC;KAC1E4B,OAAO,EAAE0Q,mBAAmB,CAAC7F,QAAQ,CAACK,IAAI,CAAC;KAC3C2G,SAAS,EAAEhH,QAAQ,CAACK,IAAI;KACxBuF,QAAQ,EAAEA,QAAQ,CAAC5F,QAAQ,CAACK,IAAI;IAChC,GAAGyG,QAAQ,CAAC;GAEbrT,aAAG,CAAC0G,MAAM,yCAACuL,cAAc,4CAAqB;KAC7ClP,KAAK,EAAElD,aAAG,CAACC,UAAU,CAAC,+CAA+C,CAAC;KACtEwT,QAAQ,EAAEzT,aAAG,CAACC,UAAU,CAAC,oDAAoD,CAAC;KAC9E4B,OAAO,EAAE0Q,mBAAmB,CAAC7F,QAAQ,CAACM,QAAQ,CAAC;KAC/C0G,SAAS,EAAEhH,QAAQ,CAACM,QAAQ;KAC5BsF,QAAQ,EAAEA,QAAQ,CAAC5F,QAAQ,CAACM,QAAQ;IACpC,GAAGwG,QAAQ,CAAC;GAEbrT,aAAG,CAAC0G,MAAM,yCAACuL,cAAc,4CAAqB;KAC7ClP,KAAK,EAAElD,aAAG,CAACC,UAAU,CAAC,4CAA4C,CAAC;KACnEwT,QAAQ,EAAEzT,aAAG,CAACC,UAAU,CAAC,iDAAiD,CAAC;KAC3E4B,OAAO,EAAE0Q,mBAAmB,CAAC7F,QAAQ,CAACE,KAAK,CAAC;KAC5C8G,SAAS,EAAEhH,QAAQ,CAACE,KAAK;KACzB0F,QAAQ,EAAEA,QAAQ,CAAC5F,QAAQ,CAACE,KAAK;IACjC,GAAG4G,QAAQ,CAAC;GAEbrT,aAAG,CAAC0G,MAAM,yCAACuL,cAAc,4CAAqB;KAC7ClP,KAAK,EAAElD,aAAG,CAACC,UAAU,CAAC,6CAA6C,CAAC;KACpEwT,QAAQ,EAAEzT,aAAG,CAACC,UAAU,CAAC,kDAAkD,CAAC;KAC5E4B,OAAO,EAAE0Q,mBAAmB,CAAC7F,QAAQ,CAACI,MAAM,CAAC;KAC7C4G,SAAS,EAAEhH,QAAQ,CAACI,MAAM;KAC1BwF,QAAQ,EAAEA,QAAQ,CAAC5F,QAAQ,CAACI,MAAM;IAClC,GAAG0G,QAAQ,CAAC;GAEb,OAAOrL,aAAG,CAACC,MAAM,kBAAC;;;;QAId,CAGG;;;MAGL,CAAW;;GAEb,GARMpI,aAAG,CAACC,UAAU,CAAC,2CAA2C,EAAE;KAC7D,QAAQ,EAAE,mEAAmE;KAC7E,SAAS,EAAE;IACX,CAAC,EAGFuT,QAAQ;CAGb;CAAC,8BAE0B3R,OAA+B,EAC1D;GACC,MAAM8R,UAAU,GAAGxL,aAAG,CAACC,MAAM,kBAAC;0CACQ,CAAoB;;GAE1D,GAFwCvG,OAAO,CAAC6R,SAAS,CAExD;GAED,IAAIE,gBAAgB,GAAG,IAAI;GAC3B,IAAIC,aAAa,GAAG,IAAI;GACxB,IAAIC,iBAAiB,GAAG,IAAI;GAE5BjS,OAAO,CAACA,OAAO,CAAC6L,OAAO,CAAEqG,MAAM,IAAK;KACnC,IAAIC,aAAa,GAAG,EAAE;KAEtB,MAAMC,UAAU,GAAGF,MAAM,CAAC1K,KAAK,KAAKxH,OAAO,CAACyQ,QAAQ;KACpD,IAAI2B,UAAU,EACd;OACCL,gBAAgB,GAAG,KAAK;;KAGzB,IAAIG,MAAM,CAACxU,IAAI,KAAK0S,UAAU,CAACE,KAAK,EACpC;OACC6B,aAAa,GAAG7L,aAAG,CAACC,MAAM,kBAAC;eAClB,CAAsD,WAAQ,CAAe,KAAE,CAAe;KACvG,GADW2L,MAAM,CAAC1K,KAAK,KAAKxH,OAAO,CAACyQ,QAAQ,GAAG,UAAU,GAAG,EAAE,EAAWyB,MAAM,CAAC1K,KAAK,EAAK0K,MAAM,CAAC7Q,KAAK,CACrG;MACD,MACI,IAAI6Q,MAAM,CAACxU,IAAI,KAAK0S,UAAU,CAACC,MAAM,EAC1C;OAAA;OACC2B,aAAa,GAAG1L,aAAG,CAACC,MAAM,kBAAC;8BACH,CAAuE;KAC/F,GAD0BpI,aAAG,CAACC,UAAU,CAAC,oDAAoD,CAAC,CAC7F;OACD+T,aAAa,GAAGH,aAAa;OAE7BC,iBAAiB,GAAG3L,aAAG,CAACC,MAAM,kBAAC;;4CAEO,CAAoB,qDAAkD,CAAqB;;KAEjI,GAFwCvG,OAAO,CAAC6R,SAAS,mBAAqDK,MAAM,CAAC1K,KAAK,4BAAI,EAAE,CAE/H;OAED6K,eAAK,CAACC,IAAI,CAACR,UAAU,EAAE,QAAQ,EAAG7J,KAAK,IAAK;SAC3C,MAAMT,KAAK,GAAGS,KAAK,CAAC5F,MAAM,CAACmF,KAAK;SAChC,IAAIA,KAAK,KAAK,QAAQ,EACtB;WACClJ,aAAG,CAACkF,WAAW,CAACyO,iBAAiB,EAAE,6CAA6C,CAAC;UACjF,MAED;WACC3T,aAAG,CAACC,QAAQ,CAAC0T,iBAAiB,EAAE,6CAA6C,CAAC;;QAE/E,CAAC;;KAGH3T,aAAG,CAAC0G,MAAM,CAACmN,aAAa,EAAEL,UAAU,CAAC;IACrC,CAAC;GAEF,IAAIC,gBAAgB,EACpB;KACC,IAAIC,aAAa,EACjB;OACCA,aAAa,CAACO,YAAY,CAAC,UAAU,EAAE,IAAI,CAAC;;KAG7C,IAAIN,iBAAiB,EACrB;OACCA,iBAAiB,CAACxT,aAAa,CAAC,OAAO,CAAC,CAAC+I,KAAK,GAAGxH,OAAO,CAACyQ,QAAQ;OACjEnS,aAAG,CAACkF,WAAW,CAACyO,iBAAiB,EAAE,6CAA6C,CAAC;;;GAInF,OAAO3L,aAAG,CAACC,MAAM,kBAAC;;;;QAId,CAAgB;;;QAGhB,CAAmB;;;;;OAKpB,CAAa;;MAEd,CAAoB;;GAEtB,GAZMvG,OAAO,CAACqB,KAAK,EAGbrB,OAAO,CAAC4R,QAAQ,EAKjBE,UAAU,EAEXG,iBAAiB;CAGtB;CAAC,sBAjMW1B,cAAc;GAAA;CAAA;CAAA,sBAAdA,cAAc;GAAA;CAAA;CAAA,sBAAdA,cAAc;GAAA;CAAA;;CCtBpB,MAAMiC,YAAY,GAAG;;GAE3B9S,QAAQ,EAAG;;;;;;;;;;;;;;CAcZ,CAAC;;CCfM,MAAM+S,aAAa,GAAG;GAC5B5K,OAAO,EAAEb,SAAS;GAClB3I,OAAO,GACP;KACC,IAAIqU,oBAAQ,CAAC;OACZC,IAAI,EAAE,IAAI,CAAChU,KAAK,CAACiU,QAAQ;OACzBtQ,IAAI,EAAEuQ,wBAAY,CAACC,KAAK;OACxBC,OAAO,EAAE,IAAI,CAAC9L,YAAY;OAC1B+L,QAAQ,EAAE;SACTC,OAAO,EAAE,MAAM;WACd,IAAI,CAACzL,KAAK,GAAG,CAAC,IAAI,CAACA,KAAK;WACxB,IAAI,CAACE,aAAa,CAAC,IAAI,CAACF,KAAK,CAAC;;;MAGhC,CAAC;IACF;;GAED9H,QAAQ,EAAG;;;;;;;;;;CAUZ,CAAC;;CC7BM,MAAMwT,WAAW,GAAG;GAC1BrL,OAAO,EAAEb,SAAS;;GAElBtH,QAAQ,EAAG;;;;;;;;;;CAUZ,CAAC;;CCbM,MAAMyT,aAAa,GAAG;GAC5BtL,OAAO,EAAEb,SAAS;GAClBxJ,KAAK,EAAE;KACNwC,OAAO,EAAE;OACRtC,IAAI,EAAE2G,KAAK;OACXzG,QAAQ,EAAE;;IAEX;;GAED8B,QAAQ,EAAG;;;;;;;;;;;;;CAaZ,CAAC;;CCfM,MAAM0T,YAAY,GAAG;GAC3BzR,UAAU,EAAE;uBACX0R,4CAAgB;KAChBH,WAAW;KACXC,aAAa;KACbV,aAAa;KACbD;IACA;GACDhV,KAAK,EAAE;KACN8V,eAAe,EAAE;OAChB5V,IAAI,EAAEqC,MAAM;OACZnC,QAAQ,EAAE,KAAK;OACfC,OAAO,EAAE;MACT;KACD0V,gBAAgB,EAAE;OACjB7V,IAAI,EAAEqC,MAAM;OACZnC,QAAQ,EAAE,KAAK;OACfC,OAAO,EAAE;MACT;KACD2V,sBAAsB,EAAE;OACvB9V,IAAI,EAAEC,OAAO;OACbC,QAAQ,EAAE,KAAK;OACfC,OAAO,EAAE;MACT;KACD4V,SAAS,EAAE;OACV/V,IAAI,EAAE2G,KAAK;OACXzG,QAAQ,EAAE;MACV;KACD8V,UAAU,EAAE;OACXhW,IAAI,EAAE2G,KAAK;OACXzG,QAAQ,EAAE;MACV;KACDE,UAAU,EAAE;OACXJ,IAAI,EAAEC,OAAO;OACbC,QAAQ,EAAE,KAAK;OACfC,OAAO,EAAE;MACT;KACDkL,iBAAiB,EAAE;OAClBrL,IAAI,EAAEuC,MAAM;OACZrC,QAAQ,EAAE,KAAK;OACfC,OAAO,EAAE;MACT;KACD6S,mBAAmB,EAAE;OACpBhT,IAAI,EAAEuC;;IAEP;GACDE,IAAI,GACJ;KACC,OAAO;OACNwT,YAAY,EAAE,IAAI;OAClBlM,wBAAwB,EAAE;MAC1B;IACD;GACD5H,KAAK,EAAE,CACN,aAAa,EACb,aAAa,EACb,uBAAuB,CACvB;GACD9B,QAAQ,EAAE;KACT6V,eAAe,GACf;OACC,OAAO;SACNC,UAAU,EAAE,6EAA6E;SACzFC,iBAAiB,EAAE,EAAE;SACrBC,QAAQ,EAAE,KAAK;SACfC,gBAAgB,EAAE,KAAK;SACvBC,WAAW,EAAE,IAAI,GAAG,IAAI,GAAG,EAAE;SAC7BC,UAAU,EAAE,IAAI;SAChBC,iBAAiB,EAAE,CAAC,MAAM,CAAC;SAC3B3T,MAAM,EAAE;WACP4T,gBAAgB,EAAE,MAAM;aACvB,IAAI,CAACA,gBAAgB,EAAE;YACvB;WACD,eAAe,EAAE,MAAM;aACtB,IAAI,CAACC,aAAa,EAAE;YACpB;WACDC,OAAO,EAAE,MAAM;aACd,IAAI,CAACC,aAAa,EAAE;YACpB;WACD,cAAc,EAAE,MAAM;aACrB,IAAI,CAACA,aAAa,EAAE;;;QAGtB;MACD;KACDC,aAAa,GACb;OACC,OAAO;SACNlS,IAAI,EAAE;QACN;;IAEF;GACDjD,OAAO,EAAE;KACR6J,aAAa,CAACjB,KAA4B,EAC1C;OACC,IAAI,CAACjH,KAAK,CAAC,aAAa,EAAEiH,KAAK,CAAC;MAChC;KACDmM,gBAAgB,GAChB;OACC,MAAMK,IAAI,GAAG,IAAI,CAAC9V,KAAK,CAAC+V,QAAQ,CAACA,QAAQ,CAACC,QAAQ,EAAE,CAAC,CAAC,CAAC;OACvD,IAAIF,IAAI,IAAIA,IAAI,CAACG,UAAU,EAAE,EAC7B;SACC,IAAI,CAACnN,wBAAwB,GAAG,KAAK;SACrC,IAAI,CAACzG,KAAK,CAAC,aAAa,EAAE;WACzBmE,QAAQ,EAAEsP,IAAI,CAACI,eAAe,EAAE;WAChClN,SAAS,EAAE;UACX,CAAC;SACF,IAAI,CAAC3G,KAAK,CAAC,aAAa,EAAE;WACzBmE,QAAQ,EAAEsP,IAAI,CAACK,OAAO,EAAE;WACxBnN,SAAS,EAAE;UACX,CAAC;;MAEH;KACD0M,aAAa,GACb;OACC,IAAI,CAACrT,KAAK,CAAC,aAAa,EAAE;SACzBmE,QAAQ,EAAE,IAAI;SACdwC,SAAS,EAAE;QACX,CAAC;MACF;KACD4M,aAAa,GACb;OACC,IAAI,CAACvT,KAAK,CAAC,aAAa,CAAC;MACzB;KACDgF,oBAAoB,GACpB;OACC,IAAI,CAACyB,wBAAwB,GAAG,IAAI;MACpC;KACDsN,oBAAoB,GACpB;OACCxE,cAAc,CAACC,UAAU,CAAC,IAAI,CAACjH,MAAM,CAACC,KAAK,CAACC,MAAM,CAACuL,WAAW,EAAE,IAAI,CAACtE,mBAAmB,EAAGuE,eAAe,IAAK;SAC9G,IAAI,CAAC1L,MAAM,CAACQ,MAAM,CAAC,gBAAgB,EAAEkL,eAAe,CAAC;SACrD,IAAI,CAACjU,KAAK,CAAC,uBAAuB,CAAC;QACnC,CAAC;;IAEH;GACDtB,QAAQ,EAAG;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;CAyCZ,CAAC;;CCrLM,MAAMwV,QAAQ,GAAG;GACvBrN,OAAO,EAAErC,QAAQ;GACjBhI,KAAK,EAAE;KACNiW,SAAS,EAAE;OACV/V,IAAI,EAAE2G,KAAK;OACXzG,QAAQ,EAAE;MACV;KACD8V,UAAU,EAAE;OACXhW,IAAI,EAAE2G,KAAK;OACXzG,QAAQ,EAAE;MACV;KACD8S,mBAAmB,EAAE;OACpBhT,IAAI,EAAEuC;;IAEP;GACDE,IAAI,GACJ;KACC,OAAO;OACNsK,cAAc,EAAE,IAAI,CAAClB,MAAM,CAACC,KAAK,CAACC,MAAM,CAACgB,cAAc;OACvD0K,gBAAgB,EAAE;MAClB;IACD;GACDtV,KAAK,EAAE,CACN,sBAAsB,EACtB,uBAAuB,CACvB;GACD9B,QAAQ,EAAE;KACT2H,YAAY,GACZ;OACC,OAAO,IAAI,CAACxH,OAAO,CAACC,GAAG,CAACC,UAAU,CAAC,4BAA4B,CAAC;MAChE;KACDwH,WAAW,GACX;OACC,IAAI,IAAI,CAACuP,gBAAgB,EACzB;SACC,OAAO,IAAI,CAACjX,OAAO,CAACC,GAAG,CAACC,UAAU,CAAC,gCAAgC,CAAC;;OAGrE,IAAI,IAAI,CAACN,UAAU,EACnB;SACC,OAAO,IAAI,CAACI,OAAO,CAACC,GAAG,CAACC,UAAU,CAAC,+BAA+B,CAAC,CACjEoR,OAAO,CAAC,QAAQ,EAAE,mEAAmE,CAAC,CACtFA,OAAO,CAAC,SAAS,EAAE,MAAM,CAAC;;OAI7B,OAAO,IAAI,CAACtR,OAAO,CAACC,GAAG,CAACC,UAAU,CAAC,0BAA0B,CAAC,CAC5DoR,OAAO,CAAC,QAAQ,EAAE,mEAAmE,CAAC,CACtFA,OAAO,CAAC,SAAS,EAAE,MAAM,CAAC;MAE5B;KACD3L,SAAS,GACT;OACC,OAAO,IAAI,CAACsR,gBAAgB,GAAG,iBAAiB,GAAG,kBAAkB;MACrE;KACDrX,UAAU,GACV;OACC,OAAO,IAAI,CAACyL,MAAM,CAACG,OAAO,CAAC5L,UAAU;MACrC;KACDiL,iBAAiB,GACjB;OACC,MAAMY,MAAM,GAAG,EAAE;OAEjB,MAAMyL,oBAAoB,GAAG,IAAI,CAACC,YAAY,EAAE;OAChD,IAAI,CAACD,oBAAoB,CAACzL,MAAM,EAChC;SACCA,MAAM,CAAC8K,IAAI,GAAGW,oBAAoB;;OAGnC,OAAOzL,MAAM;;IAEd;GACDtK,OAAO,EAAE;KACRiW,sBAAsB,CAACrN,KAA4B,EACnD;OACC,IAAIA,KAAK,CAACN,SAAS,KAAK,WAAW,EACnC;SACC,IAAI,CAACwN,gBAAgB,GAAG,KAAK;;OAG9B,IAAI,CAAC1K,cAAc,CAACxC,KAAK,CAACN,SAAS,CAAC,GAAGM,KAAK,CAAC9C,QAAQ;OACrD,IAAI,CAACoE,MAAM,CAACQ,MAAM,CAAC,mBAAmB,EAAE,IAAI,CAACU,cAAc,CAAC;OAC5D,IAAIxC,KAAK,CAACN,SAAS,KAAK,UAAU,EAClC;SACC,IAAI,CAAC3G,KAAK,CAAC,sBAAsB,CAAC;;OAEnC,IAAI,CAAC+E,QAAQ,EAAE;MACf;KACDwO,aAAa,GACb;OACC,IAAI,CAACY,gBAAgB,GAAG,IAAI;MAC5B;KACDI,uBAAuB,GACvB;OACC,IAAI,CAACvU,KAAK,CAAC,uBAAuB,CAAC;MACnC;KACD+E,QAAQ,GACR;OACC,IAAI4D,MAAM,GAAG,IAAI;OACjB,IAAI,CAAC,IAAI,CAAC7L,UAAU,EACpB;SACC6L,MAAM,GAAG1J,MAAM,CAAC+J,IAAI,CAAC,IAAI,CAACjB,iBAAiB,CAAC,CAACkB,MAAM,KAAK,CAAC;;OAG1D,IAAI,CAACjJ,KAAK,CAAC,YAAY,EAAE2I,MAAM,CAAC;OAEhC,OAAOA,MAAM;MACb;KACD0L,YAAY,GACZ;OACC,IAAI,CAAC,IAAI,CAACvX,UAAU,IAAI,CAAC,IAAI,CAACyL,MAAM,CAACC,KAAK,CAACC,MAAM,CAACgB,cAAc,CAAC+K,SAAS,EAC1E;SACC,OAAO;WACN7L,MAAM,EAAE,KAAK;WACbvD,OAAO,EAAE,IAAI,CAAClI,OAAO,CAACC,GAAG,CAACC,UAAU,CAAC,kCAAkC;UACvE;;OAGF,OAAO;SACNuL,MAAM,EAAE;QACR;MACD;KACD3D,oBAAoB,GACpB;OACC,IAAI,CAACrH,KAAK,CAAC8W,YAAY,CAACzP,oBAAoB,EAAE;;IAE/C;GACDrE,UAAU,EAAE;KACXsE,IAAI,EAAEnC,SAAS;KACfsP;IACA;GACD1T,QAAQ,EAAG;;;;;;;;;;;;;;;;;;;;;;;;;CAyBZ,CAAC;;CC/JM,MAAMgW,UAAU,GAAG;GACzBlY,KAAK,EAAE;KACN6D,KAAK,EAAE;OACN3D,IAAI,EAAEqC,MAAM;OACZnC,QAAQ,EAAE;MACV;KACDwG,aAAa,EAAE;OACd1G,IAAI,EAAE2G,KAAK;OACXzG,QAAQ,EAAE;;IAEX;GACD+D,UAAU,EAAE;KACXsE,IAAI,EAAEnC;IACN;;GAEDpE,QAAQ,EAAG;;;;;;;;;CASZ,CAAC;;CCxBM,MAAM2K,aAAW,GAAG;GAC1B7M,KAAK,EAAE;KACNmY,OAAO,EAAE;OACRjY,IAAI,EAAE2G,KAAK;OACXzG,QAAQ,EAAE,KAAK;OACfC,OAAO,EAAE;MACT;KACD+X,gBAAgB,EAAE;OACjBlY,IAAI,EAAE2G,KAAK;OACXzG,QAAQ,EAAE,KAAK;OACfC,OAAO,EAAE;;IAEV;GACDE,QAAQ,EAAE;KACT8X,cAAc,GACd;OACC,OAAO,IAAI,CAACF,OAAO,CAACG,MAAM,CAAC,CAACC,CAAC,EAAE7I,KAAK,KAAK,IAAI,CAAC0I,gBAAgB,CAAC1I,KAAK,CAAC,CAAC;;IAEvE;;GAEDxN,QAAQ,EAAG;;;;;;;CAOZ,CAAC;;CC3BM,MAAMsN,UAAQ,GAAG;GACvBxP,KAAK,EAAE;KACN8R,GAAG,EAAE;OACJ5R,IAAI,EAAE2G,KAAK;OACXzG,QAAQ,EAAE;MACV;KACDgY,gBAAgB,EAAE;OACjBlY,IAAI,EAAE2G,KAAK;OACXzG,QAAQ,EAAE,KAAK;OACfC,OAAO,EAAE;;IAEV;GACDE,QAAQ,EAAE;KACTiY,aAAa,GACb;OACC,OAAO,IAAI,CAAC1G,GAAG,CAACwG,MAAM,CAAC,CAACC,CAAC,EAAE7I,KAAK,KAAK,IAAI,CAAC0I,gBAAgB,CAAC1I,KAAK,CAAC,CAAC;;IAEnE;;GAEDxN,QAAQ,EAAG;;;;;CAKZ,CAAC;;CCpBM,MAAMuW,YAAY,GAAG;GAC3BzY,KAAK,EAAE;KACNmY,OAAO,EAAE;OACRjY,IAAI,EAAE2G,KAAK;OACXzG,QAAQ,EAAE,KAAK;OACfC,OAAO,EAAE;MACT;KACD4R,IAAI,EAAE;OACL/R,IAAI,EAAE2G,KAAK;OACXzG,QAAQ,EAAE,KAAK;OACfC,OAAO,EAAE;MACT;KACD+X,gBAAgB,EAAE;OACjBlY,IAAI,EAAE2G,KAAK;OACXzG,QAAQ,EAAE,KAAK;OACfC,OAAO,EAAE;;IAEV;GACDsC,IAAI,GACJ;KACC,OAAO;OACN+V,yBAAyB,EAAE,IAAI,CAACN,gBAAgB;OAChDO,gBAAgB,EAAEC,kBAAQ,CAAC,IAAI,CAACC,cAAc,EAAE,IAAI;MACpD;IACD;GACDhY,OAAO,GACP;KACC,MAAMiY,IAAI,GAAG,IAAIC,YAAI,CAAC;OACrBC,SAAS,EAAEhY,QAAQ,CAACC,aAAa,CAAC,wBAAwB,CAAC;OAC3DgY,SAAS,EAAE,IAAI;OACfC,WAAW,EAAE;MACb,CAAC;KAEFJ,IAAI,CAACK,IAAI,EAAE;IACX;GACDtX,OAAO,EAAE;KACRgX,cAAc,CAACO,aAAa,EAC5B;OACC,IAAI,CAACV,yBAAyB,GAAGU,aAAa;OAC9CtY,aAAG,CAACkF,WAAW,CAAC,IAAI,CAAC7E,KAAK,CAACkY,KAAK,EAAE,6BAA6B,CAAC;;IAEjE;GACD3R,KAAK,EAAE;KACN0Q,gBAAgB,CAACzQ,QAAQ,EAAE2R,QAAQ,EACnC;OACCxY,aAAG,CAACC,QAAQ,CAAC,IAAI,CAACI,KAAK,CAACkY,KAAK,EAAE,6BAA6B,CAAC;OAC7D,IAAI,CAACV,gBAAgB,CAAChR,QAAQ,CAAC;;IAEhC;GACDxD,UAAU,EAAE;kBACX0I,aAAW;eACX2C;IACA;;GAEDtN,QAAQ,EAAG;;;;;;;;;;CAUZ,CAAC;;CCjEM,MAAMqX,aAAa,GAAG;GAC5BpV,UAAU,EAAE;KACX+T,UAAU;KACVO;IACA;GACDzY,KAAK,EAAE;KACNwZ,cAAc,EAAE;OACftZ,IAAI,EAAEqC,MAAM;OACZnC,QAAQ,EAAE,KAAK;OACfC,OAAO,EAAE;MACT;KACDoZ,KAAK,EAAE;OACNvZ,IAAI,EAAEqC,MAAM;OACZnC,QAAQ,EAAE,KAAK;OACfC,OAAO,EAAE;MACT;KACDqZ,SAAS,EAAE;OACVxZ,IAAI,EAAEC,OAAO;OACbC,QAAQ,EAAE,KAAK;OACfC,OAAO,EAAE;;IAEV;GACDE,QAAQ,EAAE;KACTD,UAAU,GACV;OACC,OAAO,IAAI,CAACyL,MAAM,CAACG,OAAO,CAAC5L,UAAU;MACrC;KACD6X,OAAO,GACP;OACC,OAAO,IAAI,CAACpM,MAAM,CAACG,OAAO,CAACoG,cAAc;MACzC;KACDL,IAAI,GACJ;OACC,OAAO,IAAI,CAAClG,MAAM,CAACC,KAAK,CAAC2N,WAAW,CAAC1H,IAAI;MACzC;KACD2H,kBAAkB,GAClB;OACC,OAAO,IAAI,CAACzB,OAAO,CAAC1L,MAAM,GAAG,CAAC,IAAI,IAAI,CAACV,MAAM,CAACG,OAAO,CAACsF,gBAAgB;MACtE;KACDqI,OAAO,GACP;OACC,OAAO,IAAI,CAAC9N,MAAM,CAACG,OAAO,CAAC2N,OAAO;MAClC;KACDC,UAAU,GACV;OACC,OAAO,IAAI,CAAC3B,OAAO,CAAC1L,MAAM,GAAG,CAAC;MAC9B;KACDsN,uBAAuB,GACvB;OAAA;OACC,+BAAO,IAAI,CAACP,cAAc,mCAAI,IAAI,CAAC9Y,OAAO,CAACC,GAAG,CAACC,UAAU,CAAC,oCAAoC,CAAC;MAC/F;KACDoZ,6BAA6B,GAC7B;OACC,OAAO,IAAI,CAACtZ,OAAO,CAACC,GAAG,CAACC,UAAU,CAAC,0CAA0C,CAAC;MAC9E;KACDwX,gBAAgB,GAChB;OACC,OAAO,IAAI,CAACrM,MAAM,CAACG,OAAO,CAAC+N,mBAAmB;MAC9C;KACDC,iBAAiB,GACjB;OACC,OAAO,IAAI,CAACL,OAAO,IAAI,IAAI,CAACJ,KAAK,IAAI,IAAI,CAACnZ,UAAU;MACpD;KACD6Z,8BAA8B,GAC9B;OACC,OAAO,IAAI,CAAC7Z,UAAU,IAAI,CAAC,IAAI,CAACyL,MAAM,CAACC,KAAK,CAACC,MAAM,CAACgB,cAAc,CAAC+K,SAAS;MAC5E;KACD/P,cAAc,GACd;OACC,OAAO,IAAI,CAACkS,8BAA8B,GACvC,IAAI,CAACzZ,OAAO,CAACC,GAAG,CAACC,UAAU,CAAC,2CAA2C,CAAC,GACxE,IAAI,CAACF,OAAO,CAACC,GAAG,CAACC,UAAU,CAAC,8BAA8B,CAAC;MAE9D;KACDwZ,oBAAoB,GACpB;OACC,OAAO,IAAI,CAACD,8BAA8B,GACvC,IAAI,CAACzZ,OAAO,CAACC,GAAG,CAACC,UAAU,CAAC,0CAA0C,CAAC,GACvE,IAAI,CAACF,OAAO,CAACC,GAAG,CAACC,UAAU,CAAC,6BAA6B,CAAC;;IAG9D;GACD8G,KAAK,EAAE;KACNgS,SAAS,CAAC/R,QAAQ,EAClB;OACC,IAAI,IAAI,CAAChD,MAAM,EACf;SACC,IAAI,CAACA,MAAM,CAACpB,OAAO,EAAE;;OAGtB,IAAIoE,QAAQ,EACZ;SACC,IAAI,CAAChD,MAAM,GAAG,IAAIC,kBAAM,CAAC;WACxBC,MAAM,EAAE,IAAI,CAAC1D,KAAK,CAACkZ,aAAa;WAChCvV,IAAI,EAAE,EAAE;WACRC,KAAK,EAAE,yBAAyB;WAChCC,WAAW,EAAE;UACb,CAAC;SACF,IAAI,CAACL,MAAM,CAACjB,IAAI,EAAE;;;IAGpB;;GAEDxB,QAAQ,EAAG;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;CAoEZ,CAAC;;;;AChLD;CAOA;AACA,CAAO,MAAMoY,OAAO,GAAG;GACtBta,KAAK,EAAE;KACNua,SAAS,EAAE;OACVra,IAAI,EAAEuC,MAAM;OACZrC,QAAQ,EAAE,KAAK;OACfC,OAAO,EAAE;;IAEV;GACDsC,IAAI,GACJ;KACC,OAAO;OACN6X,KAAK,EAAE,EAAE;OACTC,WAAW,EAAE,EAAE;OACfC,SAAS,EAAE,KAAK;OAChBC,cAAc,EAAE,KAAK;OACrBC,eAAe,EAAE;MACjB;IACD;GACDra,QAAQ,EAAE;KACTsa,UAAU,GACV;OACC,OAAO,EAAE;MACT;KACDC,UAAU,GACV;OACC,OAAO,EAAE;MACT;KACDC,UAAU,GACV;OACC,OAAO,EAAE;MACT;KACDza,UAAU,GACV;OACC,OAAO,KAAK;MACZ;KACD6E,SAAS,GACT;OACC,OAAO,IAAI,CAAC4G,MAAM,CAACC,KAAK,CAACC,MAAM,CAACH,iBAAiB,CAACxJ,EAAE;MACpD;KACD0Y,aAAa,GACb;OACC,OAAO,CAAE,IAAI,CAACjP,MAAM,CAACG,OAAO,CAACsF,gBAAiB,IAAI,IAAI,CAACyJ,kBAAkB,IAAI,CAAC,IAAI,CAACC,YAAY;MAC/F;KACDD,kBAAkB,GAClB;OACC,OAAO,IAAI;MACX;KACDE,wBAAwB,GACxB;OACC,OAAO,IAAI,CAAC7a,UAAU,GACnB,IAAI,CAACI,OAAO,CAACC,GAAG,CAACC,UAAU,CAAC,2CAA2C,CAAC,GACxE,IAAI,CAACF,OAAO,CAACC,GAAG,CAACC,UAAU,CAAC,sCAAsC,CAAC;MAEtE;KACDwa,uBAAuB,GACvB;OACC,OAAO,IAAI,CAAC9a,UAAU,GACnB,IAAI,CAACI,OAAO,CAACC,GAAG,CAACC,UAAU,CAAC,0CAA0C,CAAC,GACvE,IAAI,CAACF,OAAO,CAACC,GAAG,CAACC,UAAU,CAAC,qCAAqC,CAAC;;IAGtE;GACDC,OAAO,GACP;KACC,IAAI,CAACH,OAAO,CAACqB,YAAY,CAACsZ,SAAS,CAAC,8CAA8C,EAAE,IAAI,CAACC,iBAAiB,CAAC;KAC3G,IAAI,CAAC5a,OAAO,CAACqB,YAAY,CAACsZ,SAAS,CAAC,8CAA8C,EAAE,IAAI,CAACpZ,mBAAmB,CAAC;KAE7G,MAAMsZ,MAAM,GAAGpI,sBAAS,CAACC,QAAQ,CAACS,YAAY,EAAE;KAChD,IAAI0H,MAAM,EACV;OACCC,GAAG,CAACha,EAAE,CAACia,cAAc,CAACF,MAAM,EAAE,0BAA0B,EAAE,IAAI,CAACG,aAAa,CAAC;OAE7EC,gBAAgB,CAAC,cAAc,EAAGlR,KAAK,IAAK;SAC3C+Q,GAAG,CAACha,EAAE,CAACoa,iBAAiB,CAACL,MAAM,EAAE,0BAA0B,EAAE,IAAI,CAACG,aAAa,CAAC;QAChF,CAAC;;IAEH;GACD/X,aAAa,GACb;KACC,IAAI,CAACjD,OAAO,CAACqB,YAAY,CAAC8Z,WAAW,CAAC,8CAA8C,EAAE,IAAI,CAACP,iBAAiB,CAAC;KAC7G,IAAI,CAAC5a,OAAO,CAACqB,YAAY,CAAC8Z,WAAW,CAAC,8CAA8C,EAAE,IAAI,CAAC5Z,mBAAmB,CAAC;IAC/G;GACDJ,OAAO,EAAE;KACRia,aAAa,GACb;OACC,IAAI,CAACpB,SAAS,GAAG,IAAI;MACrB;KACDgB,aAAa,CAACjR,KAAK,EACnB;OACC,IAAI,CAAC,IAAI,CAACiQ,SAAS,EACnB;SACC,IAAI,CAAC,IAAI,CAACC,cAAc,EACxB;WACC,IAAI,CAACoB,aAAa,CAAC;aAClBtR,KAAK,EAAE,IAAI,CAACnK,UAAU,GAAG,UAAU,GAAG,cAAc;aACpD0b,MAAM,EAAE;YACR,CAAC;;SAGH;;OAGDvR,KAAK,CAACwR,UAAU,EAAE;OAElB,IAAI5Y,uBAAY,CAACC,YAAY,CAAC,SAAS,CAAC,EACxC;SACC;;OAGD,MAAM4Y,cAAc,GAAG,IAAIC,iBAAM,CAAC;SACjCpX,KAAK,EAAEqX,sBAAW,CAACC,OAAO;SAC1BC,IAAI,EAAE,IAAI,CAAC5b,OAAO,CAACC,GAAG,CAACC,UAAU,CAAC,gCAAgC,CAAC;SACnEoC,MAAM,EAAE;WACPuZ,KAAK,GAAG;aACPC,KAAK,CAACjZ,OAAO,EAAE;;;QAGjB,CAAC;OAEF,MAAMkZ,WAAW,GAAG,IAAIN,iBAAM,CAAC;SAC9BpX,KAAK,EAAEqX,sBAAW,CAACM,IAAI;SACvBJ,IAAI,EAAE,IAAI,CAAC5b,OAAO,CAACC,GAAG,CAACC,UAAU,CAAC,sCAAsC,CAAC;SACzEoC,MAAM,EAAE;WACPuZ,KAAK,EAAE,MAAM;aACZ,IAAI,CAAC7B,SAAS,GAAG,KAAK;aACtB,IAAI,CAACiC,QAAQ,EAAE;;;QAGjB,CAAC;OAEF,MAAMC,WAAW,GAAG,IAAI,CAACzB,wBAAwB;OACjD,MAAM0B,SAAS,GAAG,IAAI,CAACzB,uBAAuB;OAE9C,MAAMoB,KAAK,GAAG,IAAI/Y,gBAAS,CAAC;SAC3BnB,EAAE,EAAE,SAAS;SACbQ,OAAO,EAAEgG,aAAG,CAACC,MAAM,oBAAC;;0CAEgB,CAAc;;SAE/C,CAAY;;;SAGZ,CAA0B;SAC1B,CAAuB;;;KAG1B,GATsC6T,WAAW,EAE5CC,SAAS,EAGTX,cAAc,CAACnT,MAAM,EAAE,EACvB0T,WAAW,CAAC1T,MAAM,EAAE,CAGxB;SACDjF,KAAK,EAAE,GAAG;SACVE,aAAa,EAAE,IAAI;SACnBjB,QAAQ,EAAE,KAAK;SACfK,KAAK,EAAE,IAAI;SACXa,OAAO,EAAE;QACT,CAAC;OAEFuY,KAAK,CAAC9Y,IAAI,EAAE;MACZ;KACDiZ,QAAQ,GACR;OACCxJ,sBAAS,CAACC,QAAQ,CAACS,YAAY,EAAE,CAACvL,KAAK,EAAE;MACzC;KACDwU,eAAe,CAACC,IAAY,EAAEpW,QAAkB,GAAG,IAAI,EACvD;OACC,IAAI,CAAC,IAAI,CAAC6T,KAAK,CAACuC,IAAI,CAAC,EACrB;SACC;;OAGD,IAAIC,cAAI,CAACC,MAAM,CAACtW,QAAQ,CAAC,EACzB;SACC,IAAI,CAAC6T,KAAK,CAACuC,IAAI,CAAC,CAACpW,QAAQ,GAAG,CAACxG,OAAO,CAAC,IAAI,CAACqa,KAAK,CAACuC,IAAI,CAAC,CAACpW,QAAQ,CAAC;QAC/D,MAED;SACC,IAAI,CAAC6T,KAAK,CAACuC,IAAI,CAAC,CAACpW,QAAQ,GAAGA,QAAQ;;MAErC;KACDuW,WAAW,CAACH,IAAY,EAAEI,KAAe,GAAG,IAAI,EAChD;OACC,IAAIH,cAAI,CAACC,MAAM,CAACE,KAAK,CAAC,EACtB;SACC,IAAI,CAAC1C,WAAW,CAACsC,IAAI,CAAC,GAAG,CAAC5c,OAAO,CAAC,IAAI,CAACsa,WAAW,CAACsC,IAAI,CAAC,CAAC;QACzD,MAED;SACC,IAAI,CAACtC,WAAW,CAACsC,IAAI,CAAC,GAAGI,KAAK;;MAE/B;KACDC,WAAW,GACX;OACC5X,cAAI,CAACC,SAAS,CAAC,yCAAyC,EAAE;SACzD9C,IAAI,EAAE;WACLzC,IAAI,EAAE,IAAI,CAAC2a,UAAU;WACrBwC,MAAM,EAAE,IAAI,CAACvC;;QAEd,CAAC,CACApV,IAAI,CAAEC,QAAQ,IAAK;SACnB,IAAI,CAAC2X,aAAa,CAAC3X,QAAQ,CAAC;QAC5B,CAAC,CACDM,KAAK,CAAEwT,KAAK,IAAK;SACjB,IAAI,CAAC8D,WAAW,CAAC9D,KAAK,CAAC;QACvB,CAAC;MACH;KACD+D,gBAAgB,CAACT,IAAI,EAAEU,gBAAgB,EACvC;OACC,IAAI,CAAC,IAAI,CAACjD,KAAK,CAACuC,IAAI,CAAC,EACrB;SACC;;OAGD,IAAI,CAACvC,KAAK,CAACuC,IAAI,CAAC,CAACW,KAAK,GAAGD,gBAAgB;MACzC;KACDnC,iBAAiB,GACjB;OACC,IAAI,CAAC,IAAI,CAACqC,WAAW,EAAE,EACvB;SACC;;OAGD,IAAI,IAAI,CAACrd,UAAU,EACnB;SACC,IAAI,CAACsd,aAAa,EAAE;QACpB,MAED;SACC,IAAI,CAACC,WAAW,EAAE;;MAEnB;KACD5b,mBAAmB,GACnB;OACC,IAAI,CAAC0a,QAAQ,EAAE;MACf;KACDkB,WAAW,GACX;OACCrY,cAAI,CAACC,SAAS,CAAC,wCAAwC,EAAE;SACxD9C,IAAI,EAAE;WACLzC,IAAI,EAAE,IAAI,CAAC2a,UAAU;WACrBwC,MAAM,EAAE,IAAI,CAACtC;;QAEd,CAAC,CACArV,IAAI,CAAEC,QAAQ,IAAK;SACnB,IAAI,CAACmY,SAAS,CAACnY,QAAQ,CAAC;QACxB,CAAC,CACDM,KAAK,CAAEwT,KAAK,IAAK;SACjB,IAAI,CAACsE,WAAW,EAAE;QAClB,CAAC;MACH;KACDH,aAAa,GACb;OACCpY,cAAI,CAACC,SAAS,CAAC,2CAA2C,EAAE;SAC3D9C,IAAI,EAAE;WACLL,EAAE,EAAE,IAAI,CAAC6C,SAAS;WAClBjF,IAAI,EAAE,IAAI,CAAC2a,UAAU;WACrBwC,MAAM,EAAE,IAAI,CAACtC;;QAEd,CAAC,CACArV,IAAI,CAAEC,QAAQ,IAAK;SACnB,IAAI,CAACmY,SAAS,CAACnY,QAAQ,CAAC;QACxB,CAAC,CACDM,KAAK,CAAEwT,KAAK,IAAK;SACjB,IAAI,CAACsE,WAAW,EAAE;QAClB,CAAC;MACH;KACDJ,WAAW,GACX;OACC,OAAO,IAAI;MACX;KACDG,SAAS,GACT,EACC;KACDC,WAAW,GACX,EACC;KACDC,WAAW,GACX,EACC;KACDV,aAAa,CAAC3X,QAAQ,EACtB,EACC;KACD4X,WAAW,CAAC5X,QAAQ,EACpB,EACC;KACDsY,MAAM,GACN;OACCpY,MAAM,CAACqY,QAAQ,CAACD,MAAM,EAAE;MACxB;KACDlC,aAAa,CAACoC,MAAwB,EACtC;OACC,IAAI,IAAI,CAACtD,UAAU,EACnB;SACCuD,qBAAQ,CAAC;WACR,GAAG,IAAI,CAACC,sBAAsB,EAAE;WAChC,GAAGF;UACH,CAAC;;MAEH;KACDE,sBAAsB,GACtB;OACC,OAAO;SACNC,IAAI,EAAE,YAAY;SAClBC,SAAS,EAAE,YAAY;SACvBC,QAAQ,EAAE,IAAI,CAAC3D,UAAU,CAAC4D,WAAW;QACrC;;;CAGJ,CAAC;;CC5SM,MAAMC,MAAM,GAAG;GACrBrU,OAAO,EAAEiQ,OAAO;GAChB3X,IAAI,GACJ;KACC,OAAO;OACN6X,KAAK,EAAE;SACNvD,IAAI,EAAE;WACLtQ,QAAQ,EAAE,KAAK;WACf+W,KAAK,EAAE,IAAI,CAAC3R,MAAM,CAACG,OAAO,CAAC5L;UAC3B;SACDqe,UAAU,EAAE;WACXhY,QAAQ,EAAE,CAAC,IAAI,CAACoF,MAAM,CAACG,OAAO,CAAC5L,UAAU;WACzCod,KAAK,EAAE;UACP;SACDL,MAAM,EAAE;WACP1W,QAAQ,EAAE,CAAC,IAAI,CAACoF,MAAM,CAACG,OAAO,CAAC5L,UAAU;WACzCod,KAAK,EAAE;;QAER;OACDjD,WAAW,EAAE;SACZmE,cAAc,EAAE,KAAK;SACrBC,aAAa,EAAE,KAAK;SACpBC,aAAa,EAAE,KAAK;SACpBC,uBAAuB,EAAE;QACzB;OACDC,oBAAoB,EAAE,IAAI;OAC1BC,WAAW,EAAE;SACZJ,aAAa,EAAE;QACf;OACDK,gBAAgB,EAAE,IAAI;OACtBC,kBAAkB,EAAE,EAAE;OACtBC,qBAAqB,EAAE,EAAE;OACzBlE,YAAY,EAAE,EAAE;OAChBmE,uBAAuB,EAAE,KAAK;OAC9BC,+BAA+B,EAAE,KAAK;OACtCC,oCAAoC,EAAE;MACtC;IACD;GACDhf,QAAQ,EAAE;KACTsa,UAAU,GACV;OACC,OAAO,KAAK;MACZ;KACDva,UAAU,GACV;OACC,OAAO,IAAI,CAACyL,MAAM,CAACG,OAAO,CAAC5L,UAAU;MACrC;KACDwa,UAAU,GACV;OACC,OAAO;SACN7N,cAAc,EAAE,IAAI,CAAClB,MAAM,CAACC,KAAK,CAACC,MAAM,CAACgB,cAAc;SACvDnB,iBAAiB,EAAE,IAAI,CAACC,MAAM,CAACC,KAAK,CAACC,MAAM,CAACH,iBAAiB;SAC7DuF,cAAc,EAAE,IAAI,CAACtF,MAAM,CAACC,KAAK,CAACC,MAAM,CAACoF,cAAc;SACvDmG,WAAW,EAAE,IAAI,CAACzL,MAAM,CAACC,KAAK,CAACC,MAAM,CAACuL;QACtC;MACD;KACDuD,UAAU,GACV;OACC,OAAO;SACN9N,cAAc,EAAE,IAAI,CAAClB,MAAM,CAACC,KAAK,CAACC,MAAM,CAACgB,cAAc;SACvDnB,iBAAiB,EAAE,IAAI,CAACC,MAAM,CAACC,KAAK,CAACC,MAAM,CAACH,iBAAiB;SAC7DuF,cAAc,EAAE,IAAI,CAACtF,MAAM,CAACC,KAAK,CAACC,MAAM,CAACoF,cAAc;SACvDmG,WAAW,EAAE,IAAI,CAACzL,MAAM,CAACC,KAAK,CAACC,MAAM,CAACuL;QACtC;MACD;KACDrS,SAAS,GACT;OACC,OAAO,IAAI,CAAC4G,MAAM,CAACC,KAAK,CAACC,MAAM,CAACH,iBAAiB,CAACxJ,EAAE;MACpD;KACD2Y,kBAAkB,GAClB;OACC,OAAO,IAAI,CAACT,KAAK,CAAC6C,MAAM,CAACK,KAAK,IAAI,IAAI,CAAClD,KAAK,CAACmE,UAAU,CAACjB,KAAK,IAAI,IAAI,CAAClD,KAAK,CAACvD,IAAI,CAACyG,KAAK;MACtF;KACD8B,uBAAuB,GACvB;OACC,OAAO,IAAI,CAAClf,UAAU,GAAG,IAAI,CAACI,OAAO,CAACC,GAAG,CAACC,UAAU,CAAC,0CAA0C,CAAC,GAAG,IAAI,CAACF,OAAO,CAACC,GAAG,CAACC,UAAU,CAAC,qCAAqC,CAAC;MACrK;KACD6e,uBAAuB,GACvB;OACC,OAAO,IAAI,CAACnf,UAAU,GACnB,IAAI,CAACI,OAAO,CAACC,GAAG,CAACC,UAAU,CAAC,0CAA0C,CAAC,CAACoR,OAAO,CAAC,iBAAiB,EAAE,IAAI,CAACiN,WAAW,CAACJ,aAAa,CAAChb,KAAK,CAAC,GACxI,IAAI,CAACnD,OAAO,CAACC,GAAG,CAACC,UAAU,CAAC,qCAAqC,CAAC,CAACoR,OAAO,CAAC,iBAAiB,EAAE,IAAI,CAACiN,WAAW,CAACJ,aAAa,CAAChb,KAAK,CAAC;MACtI;KACD6b,6BAA6B,GAC7B;OACC,OAAO,IAAI,CAAC3T,MAAM,CAACC,KAAK,CAACC,MAAM,CAACgB,cAAc,CAAC0S,QAAQ,GACpD,IAAI,CAACjf,OAAO,CAACC,GAAG,CAACC,UAAU,CAAC,0CAA0C,CAAC,CAACoR,OAAO,CAAC,aAAa,EAAE,IAAI,CAACiN,WAAW,CAACJ,aAAa,CAACc,QAAQ,CAAC,GACvI,EAAE;MACL;KACDC,8BAA8B,GAC9B;OACC,OAAO,IAAI,CAACtf,UAAU,GACnB,IAAI,CAACI,OAAO,CAACC,GAAG,CAACC,UAAU,CAAC,gDAAgD,CAAC,GAC7E,IAAI,CAACF,OAAO,CAACC,GAAG,CAACC,UAAU,CAAC,2CAA2C,CAAC;;IAE5E;GACDiB,OAAO,EAAE;KACRia,aAAa,GACb;OACC,IAAI,CAACpB,SAAS,GAAG,IAAI;MACrB;KACDmF,0BAA0B,GAC1B;OACC,IAAI,CAAC/D,aAAa,EAAE;OACpB,IAAI,IAAI,CAAClB,eAAe,KAAK,YAAY,EACzC;SACC,IAAI,CAACmB,aAAa,CAAC;WAClBtR,KAAK,EAAE,IAAI,CAACnK,UAAU,GAAG,YAAY,GAAG,gBAAgB;WACxDwf,SAAS,EAAE,QAAQ;WACnB,IAAI,IAAI,CAACxf,UAAU,IAAI;aAAEyf,EAAE,EAAG,eAAc,IAAI,CAAChU,MAAM,CAACC,KAAK,CAACC,MAAM,CAACH,iBAAiB,CAACpC,IAAI,CAACsW,UAAU,CAAC,GAAG,EAAE,EAAE,CAAE;YAAE;UAClH,CAAC;;OAGH,IAAI,CAACpF,eAAe,GAAG,YAAY;MACnC;KACDqF,uBAAuB,GACvB;OACC,IAAI,CAACnE,aAAa,EAAE;OACpB,IAAI,IAAI,CAAClB,eAAe,KAAK,QAAQ,EACrC;SACC,IAAI,CAACmB,aAAa,CAAC;WAClBtR,KAAK,EAAE,IAAI,CAACnK,UAAU,GAAG,YAAY,GAAG,gBAAgB;WACxDwf,SAAS,EAAE,QAAQ;WACnB,IAAI,IAAI,CAACxf,UAAU,IAAI;aAAEyf,EAAE,EAAG,eAAc,IAAI,CAAChU,MAAM,CAACC,KAAK,CAACC,MAAM,CAACH,iBAAiB,CAACpC,IAAI,CAACsW,UAAU,CAAC,GAAG,EAAE,EAAE,CAAE;YAAE;UAClH,CAAC;;OAGH,IAAI,CAACpF,eAAe,GAAG,QAAQ;MAC/B;KACDsF,qBAAqB,CAACC,YAAY,EAClC;OACC,IAAI,CAACrE,aAAa,EAAE;OACpB,IAAI,CAACZ,YAAY,GAAG,EAAE;OACtB,IAAI,CAACgE,gBAAgB,GAAGiB,YAAY;OAEpC,IAAI,IAAI,CAACpU,MAAM,CAACC,KAAK,CAACC,MAAM,CAACgB,cAAc,CAAC+K,SAAS,EACrD;SACC,IAAImI,YAAY,KAAK,MAAM,EAC3B;WACC,IAAI,CAACvF,eAAe,GAAG,MAAM;WAE7B,IAAI,CAACmB,aAAa,CAAC;aAClBtR,KAAK,EAAE,IAAI,CAACnK,UAAU,GAAG,YAAY,GAAG,gBAAgB;aACxDwf,SAAS,EAAE,QAAQ;aACnB,IAAI,IAAI,CAACxf,UAAU,IAAI;eAAEyf,EAAE,EAAG,eAAc,IAAI,CAAChU,MAAM,CAACC,KAAK,CAACC,MAAM,CAACH,iBAAiB,CAACpC,IAAI,CAACsW,UAAU,CAAC,GAAG,EAAE,EAAE,CAAE;cAAG;YACnH,CAAC;WAEF,IAAI,CAACI,4BAA4B,EAAE;;SAGpC,IAAI,CAAChD,WAAW,EAAE;QAClB,MACI,IAAI,IAAI,CAAC9c,UAAU,EACxB;SACC,IAAI,CAACyL,MAAM,CAACQ,MAAM,CAAC,gBAAgB,EAAE,IAAI,CAAC4S,kBAAkB,CAAC;SAC7D,IAAI,CAACpT,MAAM,CAACQ,MAAM,CAAC,mBAAmB,EAAE,IAAI,CAAC6S,qBAAqB,CAAC;QACnE,MAED;SACC,IAAI,CAACrT,MAAM,CAACQ,MAAM,CAAC,gBAAgB,EAAE,EAAE,CAAC;SACxC,IAAI,CAACpL,KAAK,CAACkf,cAAc,CAAC/X,KAAK,EAAE;SACjC,IAAI,CAACnH,KAAK,CAACmf,UAAU,CAAChY,KAAK,EAAE;SAC7B,IAAI,CAACwU,eAAe,CAAC,YAAY,EAAE,IAAI,CAAC;SACxC,IAAI,CAACA,eAAe,CAAC,QAAQ,EAAE,IAAI,CAAC;;MAErC;KACDyD,mBAAmB,CAAC5a,QAAQ,EAC5B;OACC,MAAM6a,YAAY,GAAG7a,QAAQ,CAAChD,IAAI;OAElC,IAAI,CAAC6d,YAAY,IAAIA,YAAY,CAAC7d,IAAI,CAAC8J,MAAM,KAAK,CAAC,EACnD;SACC;;OAGD,IAAI,IAAI,CAACyS,gBAAgB,KAAK,MAAM,IAAI,CAAC,IAAI,CAAC5e,UAAU,EACxD;SACC,MAAM6X,OAAO,GAAG,EAAE;SAClBqI,YAAY,CAACrI,OAAO,CAAC9J,OAAO,CAAC,CAACoS,MAAM,EAAE/Q,KAAK,KAAK;WAC/CyI,OAAO,CAAC7J,IAAI,CAAC,IAAI,CAACoS,aAAa,CAACD,MAAM,EAAE/Q,KAAK,CAAC,CAAC;UAC/C,CAAC;SAEF,IAAI,CAAC3D,MAAM,CAACQ,MAAM,CAAC,mBAAmB,EAAE4L,OAAO,CAAC;;OAEjD,IAAI,CAACpM,MAAM,CAACQ,MAAM,CAAC,gBAAgB,EAAEiU,YAAY,CAAC7d,IAAI,CAAC;MACvD;KACD+d,aAAa,CAACD,MAAM,EAAE/Q,KAAK,EAC3B;OACC,OAAO;SACNiR,OAAO,EAAE,IAAI;SACbzgB,IAAI,EAAEugB,MAAM,CAACvgB,IAAI;SACjBwJ,IAAI,EAAE+W,MAAM,CAAC/W,IAAI,IAAI+W,MAAM,CAAC/W,IAAI,CAAC+C,MAAM,GAAG,CAAC,GAAGgU,MAAM,CAAC/W,IAAI,GAAI,SAAQgG,KAAM,EAAC;SAC5ES,YAAY,EAAE,IAAI;SAClBC,YAAY,EAAEqQ,MAAM,CAACG,YAAY;SACjCA,YAAY,EAAEH,MAAM,CAACG;QACrB;MACD;KACDtD,aAAa,CAAC3X,QAAQ,EACtB;OACC,IAAI,CAACkb,2BAA2B,EAAE;OAClC,IAAI,CAACN,mBAAmB,CAAC5a,QAAQ,CAAC;OAElC,IAAI,CAACxE,KAAK,CAACkf,cAAc,CAACva,IAAI,EAAE;OAChC,IAAI,CAAC3E,KAAK,CAACmf,UAAU,CAACxa,IAAI,EAAE;OAC5B,IAAI,CAACgX,eAAe,CAAC,YAAY,EAAE,KAAK,CAAC;OACzC,IAAI,CAACA,eAAe,CAAC,QAAQ,EAAE,KAAK,CAAC;OACrC,IAAI,CAAC3b,KAAK,CAACmf,UAAU,CAAC/X,QAAQ,EAAE;MAChC;KACDgV,WAAW,CAAC5X,QAAQ,EACpB;OAAA;OACC,IAAI,CAACkb,2BAA2B,EAAE;OAClC,IAAI,CAAC3F,YAAY,iDAAGvV,QAAQ,CAACmb,MAAM,CAAC,CAAC,CAAC,qBAAlB,kBAAoBlY,OAAO,oCAAI,IAAI,CAAClI,OAAO,CAACC,GAAG,CAACC,UAAU,CAAC,mCAAmC,CAAC;MACnH;KACD+c,WAAW,GACX;OACC,IAAI,CAAC,IAAI,CAAC1C,kBAAkB,EAC5B;SACC,IAAI,CAAC9Z,KAAK,CAAC4f,QAAQ,CAACvY,oBAAoB,EAAE;SAC1C,IAAI,CAACrH,KAAK,CAACmf,UAAU,CAAC9X,oBAAoB,EAAE;SAC5C,IAAI,CAACrH,KAAK,CAACkf,cAAc,CAAC7X,oBAAoB,EAAE;SAEhD,OAAO,KAAK;;OAGb,IAAI,IAAI,CAAClI,UAAU,IAAI,CAAC,IAAI,CAAC+e,uBAAuB,IAAI,IAAI,CAACtT,MAAM,CAACC,KAAK,CAACC,MAAM,CAACgB,cAAc,CAAC+K,SAAS,EACzG;SACC,IAAI,CAACkF,WAAW,CAAC,yBAAyB,EAAE,IAAI,CAAC;SAEjD,OAAO,KAAK;;OAGb,IAAI,CAACA,WAAW,CAAC,gBAAgB,EAAE,IAAI,CAAC;OAExC,OAAO,IAAI;MACX;KACDY,SAAS,CAACnY,QAAQ,EAClB;OAAA;OACC,MAAMqb,WAAW,0BAAGrb,QAAQ,CAAChD,IAAI,CAAC+G,IAAI,kCAAI,IAAI,CAACqC,MAAM,CAACC,KAAK,CAACC,MAAM,CAACH,iBAAiB,CAACpC,IAAI;OACzF,IAAI,CAACuV,WAAW,CAACJ,aAAa,GAAG;SAChChb,KAAK,EAAEmd,WAAW;SAClB7b,SAAS,EAAEQ,QAAQ,CAAChD,IAAI,CAACL,EAAE;SAC3Bqd,QAAQ,EAAE,IAAI,CAAC5T,MAAM,CAACC,KAAK,CAACC,MAAM,CAACgB,cAAc,CAAC0S;QAClD;OAED,IAAI,CAACzC,WAAW,CAAC,gBAAgB,EAAE,KAAK,CAAC;OACzC,IAAI,CAACA,WAAW,CAAC,eAAe,EAAE,IAAI,CAAC;OACvC,IAAI,CAACxC,SAAS,GAAG,KAAK;OACtB,IAAI,CAACC,cAAc,GAAG,IAAI;OAC1BnZ,EAAE,CAAC2R,SAAS,CAACC,QAAQ,CAAC6N,WAAW,CAACpb,MAAM,EAAE,6CAA6C,EAAE,EAAE,CAAC;OAC5F,IAAI,CAACkW,aAAa,CAAC;SAClBtR,KAAK,EAAE,IAAI,CAACnK,UAAU,GAAG,UAAU,GAAG,cAAc;SACpD0b,MAAM,EAAE,SAAS;SACjB+D,EAAE,EAAG,eAAciB,WAAW,CAAChB,UAAU,CAAC,GAAG,EAAE,EAAE,CAAE;QACnD,CAAC;MACF;KACDjC,WAAW,GACX;OACC,IAAI,CAACb,WAAW,CAAC,gBAAgB,EAAE,KAAK,CAAC;OACzC,IAAI,CAACA,WAAW,CAAC,eAAe,EAAE,IAAI,CAAC;OACvC1b,EAAE,CAAC2R,SAAS,CAACC,QAAQ,CAAC6N,WAAW,CAACpb,MAAM,EAAE,6CAA6C,EAAE,EAAE,CAAC;OAE5F,IAAI,CAACkW,aAAa,CAAC;SAClBtR,KAAK,EAAE,IAAI,CAACnK,UAAU,GAAG,UAAU,GAAG,cAAc;SACpD0b,MAAM,EAAE;QACR,CAAC;MACF;KACDkF,mBAAmB,GACnB;OACC,IAAI,CAAChE,WAAW,CAAC,eAAe,EAAE,KAAK,CAAC;OACxC,IAAI,CAACP,QAAQ,EAAE;MACf;KACDwE,iBAAiB,GACjB;OACC,IAAI,CAACjE,WAAW,CAAC,eAAe,EAAE,KAAK,CAAC;MACxC;KACDkE,wBAAwB,GACxB;OACC,IAAI,CAAC/B,uBAAuB,GAAG,IAAI;OACnC,IAAI,CAACnC,WAAW,CAAC,yBAAyB,EAAE,KAAK,CAAC;OAClD,IAAI,CAAC5B,iBAAiB,EAAE;MACxB;KACD8E,4BAA4B,GAC5B;OACC,IAAI,CAACd,+BAA+B,GAAG,IAAI;OAC3C,IAAI,CAACC,oCAAoC,GAAG,KAAK;OACjD3U,UAAU,CAAC,MAAM;SAChB,IAAI,CAAC2U,oCAAoC,GAAG,IAAI;QAChD,EAAE,IAAI,CAAC;MACR;KACDsB,2BAA2B,GAC3B;OACC,IAAI,CAACvB,+BAA+B,GAAG,KAAK;;IAE7C;GACDze,OAAO,GACP;KACC,IAAI,IAAI,CAACP,UAAU,EACnB;OACC,IAAI,CAAC6e,kBAAkB,GAAG,IAAI,CAACpT,MAAM,CAACC,KAAK,CAAC2N,WAAW,CAAC1H,IAAI;OAC5D,IAAI,CAACmN,qBAAqB,GAAG,IAAI,CAACrT,MAAM,CAACC,KAAK,CAACC,MAAM,CAACoF,cAAc;;IAErE;GACDlN,UAAU,EAAE;KACXpE,SAAS;KACToC,YAAY;KACZoX,aAAa;KACb7B,QAAQ;KACR9L,qBAAqB;KACrBmG,kBAAkB;KAClBrN,mBAAmB;KACnBQ,kBAAkB;KAClBX,kBAAkB;KAClBX;IACA;;GAED1B,QAAQ,EAAG;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;CAoFZ,CAAC;;;;AC3ZD,CAMO,MAAMmf,uBAAuB,GAAG;GACtChX,OAAO,EAAEb,SAAS;GAClBxJ,KAAK,EAAE;KACNwC,OAAO,EAAE;OACRtC,IAAI,EAAEuC,MAAM;OACZrC,QAAQ,EAAE;MACV;KACD+N,KAAK,EAAE;OACNjO,IAAI,EAAE2G,KAAK;OACXzG,QAAQ,EAAE;MACV;KACDkhB,YAAY,EAAE;OACbphB,IAAI,EAAEkF,MAAM;OACZhF,QAAQ,EAAE;;IAEX;GACDS,OAAO,GACP;KACC,MAAMsU,IAAI,GAAG,IAAI,CAAChU,KAAK,CAAC,iBAAiB,CAAC;KAC1C,MAAMogB,QAAQ,GAAG,IAAIC,6BAAW,CAAC;OAChClf,EAAE,EAAE,IAAI,CAACE,OAAO,CAACif,UAAU;OAC3BlL,QAAQ,EAAE,KAAK;OACfmL,gBAAgB,EAAE,IAAI,CAAChhB,OAAO,CAACC,GAAG,CAACC,UAAU,CAAC,mCAAmC,CAAC;OAClF+gB,oBAAoB,EAAE,IAAI,CAACjhB,OAAO,CAACC,GAAG,CAACC,UAAU,CAAC,mCAAmC,CAAC;OACtFghB,aAAa,EAAE;SACdtf,EAAE,EAAE,IAAI,CAACE,OAAO,CAACif,UAAU;SAC3BtT,KAAK,EAAE,IAAI,CAAC0T,YAAY,CAAC,IAAI,CAAC1T,KAAK,CAAC;SACpC2T,YAAY,EAAE,IAAI;SAClBC,YAAY,EAAE,IAAI;SAClBC,WAAW,EAAE,IAAI;SACjBC,WAAW,EAAE,KAAK;SAClB1L,QAAQ,EAAE,KAAK;SACfzS,KAAK,EAAE,GAAG;SACVoe,MAAM,EAAE,GAAG;SACXC,IAAI,EAAE,CAAC;WACN7f,EAAE,EAAE,aAAa;WACjB8f,WAAW,EAAE;aACZve,KAAK,EAAE,IAAI,CAACnD,OAAO,CAACC,GAAG,CAACC,UAAU,CAAC,qCAAqC,CAAC;aACzEwT,QAAQ,EAAE,IAAI,CAAC1T,OAAO,CAACC,GAAG,CAACC,UAAU,CAAC,wCAAwC,CAAC;aAC/EyhB,KAAK,EAAE,IAAI;aACXxU,IAAI,EAAE,6EAA6E;aACnFyU,WAAW,EAAE;;UAEd,CAAC;SACFC,QAAQ,EAAE,CAAC;WACVjgB,EAAE,EAAE;UACJ;QACD;OACDU,MAAM,EAAE;SACPwf,QAAQ,EAAG/X,KAAgB,IAAK;WAC/B,IAAI,CAACjH,KAAK,CAAC,aAAa,EAAEiH,KAAK,CAAC;UAChC;SACDgY,WAAW,EAAGhY,KAAgB,IAAK;WAClC,IAAI,CAACjH,KAAK,CAAC,YAAY,EAAEiH,KAAK,CAAC;;;MAGjC,CAAC;KACF3J,aAAG,CAACC,QAAQ,CAACwgB,QAAQ,CAACmB,SAAS,EAAE,CAAC5O,YAAY,EAAE,EAAE,qCAAqC,CAAC;KACxFyN,QAAQ,CAAC9Z,QAAQ,CAAC0N,IAAI,CAAC;KAEvB,MAAMwN,MAAM,GAAG7Z,aAAG,CAACC,MAAM,oBAAC;;MAExB,CAAsE;;GAExE,GAFI,IAAI,CAACrI,OAAO,CAACC,GAAG,CAACC,UAAU,CAAC,sCAAsC,CAAC,CAEtE;KACDiU,eAAK,CAACC,IAAI,CAAC6N,MAAM,EAAE,OAAO,EAAE,MAAM;OACjC,MAAM/c,IAAI,GAAG,qEAAqE;OAClFpE,EAAE,CAAC2R,SAAS,CAACC,QAAQ,CAACtN,IAAI,CAACF,IAAI,EAAE;SAChC9B,KAAK,EAAE,GAAG;SACV8e,kBAAkB,EAAE,KAAK;SACzBvZ,SAAS,EAAE;QACX,CAAC;MACF,CAAC;KACFkY,QAAQ,CAACmB,SAAS,EAAE,CAACG,MAAM,CAAC,IAAI,CAACnZ,IAAI,CAAC,CAACoZ,SAAS,CAACH,MAAM,CAAC;KAExD,IAAI,CAACpB,QAAQ,GAAGA,QAAQ;KAExBwB,6BAAY,CAAC1H,SAAS,CAAC,4BAA4B,EAAG5Q,KAAK,IAAK;OAC/D,MAAM,CAACuY,YAAY,CAAC,GAAGvY,KAAK,CAACwY,OAAO,EAAE;OACtC,IAAID,YAAY,CAACE,UAAU,EAAE,KAAK,oDAAoD,EACtF;SACC,IAAI,CAACC,eAAe,CAACH,YAAY,CAAC;;MAEnC,CAAC;IACF;GACDnhB,OAAO,EAAE;KACRggB,YAAY,CAAC1T,KAAY,EACzB;OACC,MAAMiV,aAAa,GAAG,EAAE;OACxBjV,KAAK,CAACE,OAAO,CAAEI,IAAI,IAAK;SACvB,MAAM4U,WAAW,GAAG;WACnB/gB,EAAE,EAAEmM,IAAI,CAAC6U,EAAE;WACXzf,KAAK,EAAE4K,IAAI,CAAC8U,KAAK;WACjBC,QAAQ,EAAE,IAAI,CAAChhB,OAAO,CAACif,UAAU;WACjCU,IAAI,EAAE,IAAI,CAACzY,IAAI;WACf9D,IAAI,EAAG,gFAA+E6I,IAAI,CAAC6U,EAAG,EAAC;WAC/FG,SAAS,EAAE,IAAI,CAAC/iB,OAAO,CAACC,GAAG,CAACC,UAAU,CAAC,kCAAkC,CAAC;WAC1E8iB,UAAU,EAAE;aACXlT,cAAc,EAAE/B,IAAI,CAACkV;;UAEtB;SACD,IAAIlV,IAAI,CAACkV,IAAI,EACb;WACCN,WAAW,CAACO,MAAM,GAAI,mDAAkDnV,IAAI,CAACkV,IAAK,MAAK;;SAGxF,IAAI,IAAI,CAACrC,YAAY,EACrB;WACC+B,WAAW,CAACpQ,QAAQ,GAAGxE,IAAI,CAAC6U,EAAE,KAAK,IAAI,CAAChC,YAAY,CAACuC,QAAQ,EAAE;;SAGhET,aAAa,CAAC9U,IAAI,CAAC+U,WAAW,CAAC;QAC/B,CAAC;OAEF,OAAOD,aAAa;MACpB;KACDD,eAAe,CAAC1Y,KAAK,EACrB;OACC,MAAM4Y,WAAqD,GAAG5Y,KAAK,CAACwY,OAAO,EAAE,CAACa,UAAU;OACxF,MAAMrV,IAAI,GAAG,IAAI,CAAC8S,QAAQ,CAACmB,SAAS,EAAE,CAACqB,OAAO,CAAC;SAC9CzhB,EAAE,EAAE+gB,WAAW,CAAC/gB,EAAE;SAClBuB,KAAK,EAAEwf,WAAW,CAAC3Z,IAAI;SACvB8Z,QAAQ,EAAE,IAAI,CAAChhB,OAAO,CAACif,UAAU;SACjCU,IAAI,EAAE,IAAI,CAACzY,IAAI;SACf9D,IAAI,EAAG,gFAA+Eyd,WAAW,CAAC/gB,EAAG,EAAC;SACtGmhB,SAAS,EAAE,IAAI,CAAC/iB,OAAO,CAACC,GAAG,CAACC,UAAU,CAAC,kCAAkC,CAAC;SAC1EgjB,MAAM,EAAG,mDAAkDP,WAAW,CAACnjB,IAAK,MAAK;SACjFwjB,UAAU,EAAE;WACXlT,cAAc,EAAE6S,WAAW,CAACnjB;;QAE7B,CAAC;OAEF,IAAIuO,IAAI,EACR;SACCA,IAAI,CAACuV,MAAM,EAAE;;OAEd,IAAI,CAACzC,QAAQ,CAACmB,SAAS,EAAE,CAACuB,IAAI,EAAE;;IAEjC;;GAED/hB,QAAQ,EAAG;;;;;;;;;;;;;;CAcZ,CAAC;;CCxJM,MAAMgiB,kBAAkB,GAAG;GACjC7Z,OAAO,EAAEb,SAAS;GAClBiG,UAAU,EAAE;WACXjJ;IACA;GACDxG,KAAK,EAAE;KACNwC,OAAO,EAAE;OACRtC,IAAI,EAAEuC,MAAM;OACZrC,QAAQ,EAAE;MACV;KACDkhB,YAAY,EAAE;OACbphB,IAAI,EAAEkF,MAAM;OACZhF,QAAQ,EAAE;;IAEX;GACDS,OAAO,GACP;KACC,MAAMsU,IAAI,GAAG,IAAI,CAAChU,KAAK,CAAC,iBAAiB,CAAC;KAC1C,MAAMogB,QAAQ,GAAG,IAAIC,6BAAW,CAAC;OAChClf,EAAE,EAAE,IAAI,CAACE,OAAO,CAACif,UAAU;OAC3BlL,QAAQ,EAAE,KAAK;OACfmL,gBAAgB,EAAE,IAAI,CAAChhB,OAAO,CAACC,GAAG,CAACC,UAAU,CAAC,mCAAmC,CAAC;OAClF+gB,oBAAoB,EAAE,IAAI,CAACjhB,OAAO,CAACC,GAAG,CAACC,UAAU,CAAC,mCAAmC,CAAC;OACtFghB,aAAa,EAAE;SACdtf,EAAE,EAAE,IAAI,CAACE,OAAO,CAACif,UAAU;SAC3BK,YAAY,EAAE,IAAI;SAClBC,YAAY,EAAE,IAAI;SAClBC,WAAW,EAAE,KAAK;SAClBC,WAAW,EAAE,IAAI;SACjB1L,QAAQ,EAAE,KAAK;SACf4N,WAAW,EAAE,IAAI;SACjBrgB,KAAK,EAAE,GAAG;SACVoe,MAAM,EAAE,GAAG;SACXC,IAAI,EAAE,CAAC;WACN7f,EAAE,EAAE,QAAQ;WACZ8hB,IAAI,EAAE,IAAI;WACVhC,WAAW,EAAE;aACZve,KAAK,EAAE,IAAI,CAACnD,OAAO,CAACC,GAAG,CAACC,UAAU,CAAC,kCAAkC,CAAC;aACtEwT,QAAQ,EAAE,IAAI,CAAC1T,OAAO,CAACC,GAAG,CAACC,UAAU,CAAC,qCAAqC;;UAE5E,CAAC;SACF2hB,QAAQ,EAAE,CAAC;WACVjgB,EAAE,EAAE,4BAA4B;WAChC6hB,WAAW,EAAE,KAAK;WAClBE,aAAa,EAAE;UACf;QACD;OACDrhB,MAAM,EAAE;SACPwf,QAAQ,EAAG/X,KAAgB,IAAK;WAC/B,IAAI,CAACjH,KAAK,CAAC,aAAa,EAAEiH,KAAK,CAAC;UAChC;SACDgY,WAAW,EAAGhY,KAAgB,IAAK;WAClC,IAAI,CAACjH,KAAK,CAAC,YAAY,EAAEiH,KAAK,CAAC;;;MAGjC,CAAC;KACF3J,aAAG,CAACC,QAAQ,CAACwgB,QAAQ,CAACmB,SAAS,EAAE,CAAC5O,YAAY,EAAE,EAAE,qCAAqC,CAAC;KACxFyN,QAAQ,CAAC+C,SAAS,CAAC,CAAC,IAAI,CAACxa,UAAU,CAAC;KACpCyX,QAAQ,CAAC9Z,QAAQ,CAAC0N,IAAI,CAAC;KAEvB,IAAI,CAACoM,QAAQ,GAAGA,QAAQ;IACxB;GACDhhB,QAAQ,EAAE;KACTyP,GAAG,GACH;OACC,OAAOC,sBAAG;MACV;KACDQ,WAAW,GACX;OACC,OAAO;SACNlC,IAAI,EAAE,IAAI,CAAC7N,OAAO,CAACC,GAAG,CAACC,UAAU,CAAC,4BAA4B,CAAC;SAC/DiC,YAAY,EAAE;WACbqG,WAAW,EAAE;aACZC,QAAQ,EAAE;YACV;WACDwH,SAAS,EAAE,CAAC,EAAE;WACdvH,KAAK,EAAE;aACND,QAAQ,EAAE,KAAK;aACfob,MAAM,EAAE;;;QAGV;;IAEF;GACD7c,KAAK,EAAE;KACN4Z,YAAY,CAACkD,eAAe,EAC5B;OACC,MAAMjD,QAAqB,GAAG,IAAI,CAACA,QAAQ;OAC3CA,QAAQ,CAACkD,UAAU,EAAE;OACrBlD,QAAQ,CAACmB,SAAS,EAAE,CAACgC,WAAW,EAAE;OAElC,IAAI,CAACF,eAAe,EACpB;SACCjD,QAAQ,CAAC+C,SAAS,CAAC,IAAI,CAAC;SAExB;;OAGD/C,QAAQ,CAACmB,SAAS,EAAE,CAACiC,SAAS,CAAC,4BAA4B,CAAC,CAACniB,OAAO,CAAC8e,YAAY,GAAGkD,eAAe;OACnGjD,QAAQ,CAAC+C,SAAS,CAAC,IAAI,CAACxa,UAAU,CAAC;;IAEpC;GACDjI,OAAO,EAAE,EAAE;GACXsC,UAAU,EAAE;YACXgN;IACA;;GAEDjP,QAAQ,EAAG;;;;;;;;;;;;;;;;;CAiBZ,CAAC;;CC5HM,MAAM0iB,cAAc,GAAG;GAC7Bva,OAAO,EAAErC,QAAQ;GACjBhI,KAAK,EAAE;KACN6kB,WAAW,EAAE;OACZ3kB,IAAI,EAAE2G,KAAK;OACXzG,QAAQ,EAAE;;IAEX;GACDuC,IAAI,GACJ;KACC,OAAO;OACN2e,YAAY,EAAE,IAAI,CAACvV,MAAM,CAACC,KAAK,CAACC,MAAM,CAAC6X,UAAU;OACjDgB,OAAO,EAAE,IAAI,CAAC/Y,MAAM,CAACC,KAAK,CAACC,MAAM,CAACoN,KAAK;OACvC0L,oBAAoB,EAAE,iCAAiC;OACvDC,eAAe,EAAE,4BAA4B;OAC7CzZ,iBAAiB,EAAE;MACnB;IACD;GACDpH,UAAU,EAAE;KACXkd,uBAAuB;KACvB3L,WAAW;KACXwO,kBAAkB;KAClB9Z;IACA;GACD7J,QAAQ,EAAE;KACT2H,YAAY,GACZ;OACC,OAAO,IAAI,CAACxH,OAAO,CAACC,GAAG,CAACC,UAAU,CAAC,mCAAmC,CAAC;MACvE;KACDqkB,yBAAyB,GACzB;OACC,OAAO;SACNxD,UAAU,EAAE,IAAI,CAACsD;QACjB;MACD;KACDG,oBAAoB,GACpB;OACC,OAAO;SACNzD,UAAU,EAAE,IAAI,CAACuD;QACjB;MACD;KACDG,sBAAsB,GACtB;OAAA;OACC,gCAAO,IAAI,CAACpZ,MAAM,CAACG,OAAO,CAACqE,oBAAoB,qBAAxC,sBAA0CC,cAAc;MAC/D;KACD4U,oBAAoB,GACpB;OAAA;OACC,2DAAO,IAAI,CAACrZ,MAAM,CAACG,OAAO,CAACqE,oBAAoB,qBAAxC,uBAA0C+Q,YAAY,qCAAI,CAAC;MAClE;KACD+D,sBAAsB,GACtB;OAAA;OACC,iCAAO,IAAI,CAACtZ,MAAM,CAACG,OAAO,CAACqE,oBAAoB,qBAAxC,uBAA0C+U,cAAc;MAC/D;KACDC,iBAAiB,GACjB;OAAA;OACC,iCAAO,IAAI,CAACxZ,MAAM,CAACG,OAAO,CAACqE,oBAAoB,qBAAxC,uBAA0CiV,SAAS;MAC1D;KACDllB,UAAU,GACV;OACC,OAAO,IAAI,CAACyL,MAAM,CAACG,OAAO,CAAC5L,UAAU;;IAEtC;GACDuB,OAAO,EAAE;KACR4jB,oBAAoB,CAAChb,KAAK,EAC1B;OACC,MAAMib,GAAG,GAAGjb,KAAK,CAAC9H,IAAI,CAAC+iB,GAAG;OAC1B,MAAMC,WAAW,GAAGlb,KAAK,CAAC5F,MAAM,CAAC6d,SAAS,EAAE,CAACkD,QAAQ,EAAE;OACvDD,WAAW,CAACtX,OAAO,CAAEI,IAAI,IAAK;SAC7B,IAAIA,IAAI,CAACoX,KAAK,EAAE,KAAKH,GAAG,CAACG,KAAK,EAAE,EAChC;WACCH,GAAG,CAAChC,UAAU,GAAGjV,IAAI,CAACqX,aAAa,EAAE;;QAEtC,CAAC;OAEF,MAAMC,QAAQ,GAAGC,QAAQ,CAACvb,KAAK,CAAC9H,IAAI,CAAC+iB,GAAG,CAACG,KAAK,EAAE,EAAE,EAAE,CAAC;OAErD,IAAI,CAAC9Z,MAAM,CAACQ,MAAM,CAAC,yBAAyB,EAAE;SAC7CiE,cAAc,EAAE/F,KAAK,CAAC9H,IAAI,CAAC+iB,GAAG,CAACI,aAAa,EAAE,CAACG,GAAG,CAAC,gBAAgB,CAAC;SACpE3E,YAAY,EAAEyE,QAAQ;SACtBP,SAAS,EAAE;QACX,CAAC;OAEFhgB,cAAI,CAACC,SAAS,CAAC,mDAAmD,EAAE;SACnE9C,IAAI,EAAE;WACLojB;;QAED,CAAC,CACArgB,IAAI,CAAC,MAAM;SACX,IAAI,CAAC6F,iBAAiB,GAAG,EAAE;QAC3B,CAAC,CACDtF,KAAK,CAAEN,QAAQ,IAAK;SACpB,IAAI,CAAC4F,iBAAiB,GAAG;WACxBuY,UAAU,EAAE;aACX3X,MAAM,EAAE,KAAK;aACbvD,OAAO,EAAEjD,QAAQ,CAACmb,MAAM,CAAC,CAAC,CAAC,CAAClY;;UAE7B;QACD,CAAC;OAEH,IAAI,CAACpF,KAAK,CAAC,YAAY,EAAE,KAAK,CAAC;MAC/B;KACD0iB,sBAAsB,GACtB;OACC,IAAI,CAACna,MAAM,CAACQ,MAAM,CAAC,yBAAyB,EAAE;SAC7CiE,cAAc,EAAE,IAAI;SACpB8Q,YAAY,EAAE,IAAI;SAClBkE,SAAS,EAAE;QACX,CAAC;OACF,IAAI,CAAChiB,KAAK,CAAC,YAAY,EAAE,KAAK,CAAC;OAC/B,IAAI,CAAC+H,iBAAiB,GAAG,EAAE;MAC3B;KACD4a,eAAe,CAAC1b,KAAK,EACrB;OACC,IAAI,CAACsB,MAAM,CAACQ,MAAM,CAAC,yBAAyB,EAAE;SAC7CiE,cAAc,EAAE,IAAI,CAAC2U,sBAAsB;SAC3C7D,YAAY,EAAE,IAAI,CAAC8D,oBAAoB;SACvCI,SAAS,EAAE/a,KAAK,CAAC9H,IAAI,CAAC+iB,GAAG,CAACU,QAAQ;QAClC,CAAC;OAEF,MAAMV,GAAG,GAAGjb,KAAK,CAAC9H,IAAI,CAAC+iB,GAAG;OAC1B,MAAMC,WAAW,GAAGlb,KAAK,CAAC5F,MAAM,CAAC6d,SAAS,EAAE,CAACkD,QAAQ,EAAE;OACvDD,WAAW,CAACtX,OAAO,CAAEI,IAAI,IAAK;SAC7B,IAAIA,IAAI,CAACoX,KAAK,EAAE,KAAKH,GAAG,CAACG,KAAK,EAAE,EAChC;WACCH,GAAG,CAAChC,UAAU,GAAGjV,IAAI,CAACqX,aAAa,EAAE;;QAEtC,CAAC;OAEF,IAAI,CAAC/Z,MAAM,CAACQ,MAAM,CAAC,sBAAsB,EAAE;SAC1CjK,EAAE,EAAEmI,KAAK,CAAC9H,IAAI,CAAC+iB,GAAG,CAACG,KAAK,EAAE;SAC1Bnc,IAAI,EAAEe,KAAK,CAAC9H,IAAI,CAAC+iB,GAAG,CAACI,aAAa,EAAE,CAACG,GAAG,CAAC,aAAa,CAAC;SACvDI,IAAI,EAAE5b,KAAK,CAAC9H,IAAI,CAAC+iB,GAAG,CAACI,aAAa,EAAE,CAACG,GAAG,CAAC,aAAa,CAAC;SACvD5hB,WAAW,EAAEoG,KAAK,CAAC9H,IAAI,CAAC+iB,GAAG,CAACU,QAAQ,EAAE;SACtCxF,YAAY,EAAEnW,KAAK,CAAC9H,IAAI,CAAC+iB,GAAG,CAACI,aAAa,EAAE,CAACG,GAAG,CAAC,aAAa,CAAC;SAC/DK,YAAY,EAAE7b,KAAK,CAAC9H,IAAI,CAAC+iB,GAAG,CAACU,QAAQ;QACrC,CAAC;OACF,IAAI,CAAC5iB,KAAK,CAAC,eAAe,EAAEiH,KAAK,CAAC;OAClC,IAAI,CAACjH,KAAK,CAAC,YAAY,EAAE,IAAI,CAAC;MAC9B;KACD+iB,iBAAiB,CAAC9b,KAAK,EACvB;OACC,IAAI,CAACsB,MAAM,CAACQ,MAAM,CAAC,yBAAyB,EAAE;SAC7CiE,cAAc,EAAE,IAAI,CAAC2U,sBAAsB;SAC3C7D,YAAY,EAAE,IAAI,CAAC8D,oBAAoB;SACvCI,SAAS,EAAE;QACX,CAAC;OACF,IAAI,CAACzZ,MAAM,CAACQ,MAAM,CAAC,sBAAsB,EAAE;SAC1CjK,EAAE,EAAE,IAAI;SACRoH,IAAI,EAAE,IAAI;SACV2c,IAAI,EAAE,IAAI;SACVhiB,WAAW,EAAE,IAAI;SACjBuc,YAAY,EAAE,IAAI;SAClB0F,YAAY,EAAE;QACd,CAAC;OACF,IAAI,CAAC9iB,KAAK,CAAC,iBAAiB,EAAEiH,KAAK,CAAC;OACpC,IAAI,CAACjH,KAAK,CAAC,YAAY,EAAE,KAAK,CAAC;MAC/B;KACDgjB,oBAAoB,GACpB;OACC,MAAM5gB,IAAI,GAAI,gFAA+E,IAAI,CAACwf,oBAAqB,EAAC;OACxH5jB,EAAE,CAAC2R,SAAS,CAACC,QAAQ,CAACtN,IAAI,CAACF,IAAI,EAAE;SAChC9B,KAAK,EAAE,GAAG;SACV8e,kBAAkB,EAAE,KAAK;SACzBvZ,SAAS,EAAE;QACX,CAAC;;IAEH;GACDhH,KAAK,EAAE,CACN,eAAe,EACf,iBAAiB,CACjB;GACDH,QAAQ,EAAG;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;CA+DZ,CAAC;;CCpOM,MAAMukB,qBAAqB,GAAG;GACpCpc,OAAO,EAAEiQ,OAAO;GAChB3X,IAAI,GACJ;KACC,OAAO;OACN6X,KAAK,EAAE;SACNsJ,UAAU,EAAE;WACXnd,QAAQ,EAAE,KAAK;WACf+W,KAAK,EAAE,IAAI,CAAC3R,MAAM,CAACG,OAAO,CAAC5L;UAC3B;SACDqe,UAAU,EAAE;WACXhY,QAAQ,EAAE,CAAC,IAAI,CAACoF,MAAM,CAACG,OAAO,CAAC5L,UAAU;WACzCod,KAAK,EAAE;UACP;SACDL,MAAM,EAAE;WACP1W,QAAQ,EAAE,CAAC,IAAI,CAACoF,MAAM,CAACG,OAAO,CAAC5L,UAAU;WACzCod,KAAK,EAAE;;QAER;OACDjD,WAAW,EAAE;SACZmE,cAAc,EAAE,KAAK;SACrBC,aAAa,EAAE,KAAK;SACpBC,aAAa,EAAE,KAAK;SACpB4H,WAAW,EAAE;QACb;OACD1H,oBAAoB,EAAE,IAAI;OAC1BC,WAAW,EAAE;SACZJ,aAAa,EAAE,EAAE;SACjB6H,WAAW,EAAE;WACZC,QAAQ,EAAE;;QAEX;OACDjN,SAAS,EAAE,KAAK;OAChBwB,YAAY,EAAE,EAAE;OAChB0L,iBAAiB,EAAE;MACnB;IACD;GACDrmB,QAAQ,EAAE;KACTsa,UAAU,GACV;OAAA;OACC,0DAAO,IAAI,CAAC9O,MAAM,CAACC,KAAK,CAACC,MAAM,CAACsE,oBAAoB,qBAA7C,uBAA+CC,cAAc,oCAAI,EAAE;MAC1E;KACDlQ,UAAU,GACV;OACC,OAAO,IAAI,CAACyL,MAAM,CAACG,OAAO,CAAC5L,UAAU;MACrC;KACDwa,UAAU,GACV;OACC,OAAO;SACNhP,iBAAiB,EAAE,IAAI,CAACC,MAAM,CAACC,KAAK,CAACC,MAAM,CAACH,iBAAiB;SAC7DuF,cAAc,EAAE,IAAI,CAACtF,MAAM,CAACC,KAAK,CAACC,MAAM,CAACoF,cAAc;SACvDmG,WAAW,EAAE,IAAI,CAACzL,MAAM,CAACC,KAAK,CAACC,MAAM,CAACuL,WAAW;SACjDgO,SAAS,EAAE,IAAI,CAACzZ,MAAM,CAACC,KAAK,CAACC,MAAM,CAACsE,oBAAoB,CAACiV,SAAS;SAClEhV,cAAc,EAAE,IAAI,CAACzE,MAAM,CAACC,KAAK,CAACC,MAAM,CAACsE,oBAAoB,CAACC;QAC9D;MACD;KACDuK,UAAU,GACV;OACC,OAAO;SACNjP,iBAAiB,EAAE,IAAI,CAACC,MAAM,CAACC,KAAK,CAACC,MAAM,CAACH,iBAAiB;SAC7DuF,cAAc,EAAE,IAAI,CAACtF,MAAM,CAACC,KAAK,CAACC,MAAM,CAACoF,cAAc;SACvDmG,WAAW,EAAE,IAAI,CAACzL,MAAM,CAACC,KAAK,CAACC,MAAM,CAACuL,WAAW;SACjDqP,kBAAkB,EAAE,IAAI,CAAC9a,MAAM,CAACC,KAAK,CAACC,MAAM,CAACsE;QAC7C;MACD;KACD0K,kBAAkB,GAClB;OACC,OAAO,IAAI,CAACT,KAAK,CAAC6C,MAAM,CAACK,KAAK,IAAI,IAAI,CAAClD,KAAK,CAACmE,UAAU,CAACjB,KAAK,IAAI,IAAI,CAAClD,KAAK,CAACsJ,UAAU,CAACpG,KAAK;MAC5F;KACD+B,uBAAuB,GACvB;OACC,OAAO,IAAI,CAACnf,UAAU,GACnB,IAAI,CAACI,OAAO,CAACC,GAAG,CAACC,UAAU,CAAC,0CAA0C,CAAC,CAACoR,OAAO,CAAC,iBAAiB,EAAE,IAAI,CAACiN,WAAW,CAACJ,aAAa,CAAChb,KAAK,CAAC,GACxI,IAAI,CAACnD,OAAO,CAACC,GAAG,CAACC,UAAU,CAAC,qCAAqC,CAAC,CAACoR,OAAO,CAAC,iBAAiB,EAAE,IAAI,CAACiN,WAAW,CAACJ,aAAa,CAAChb,KAAK,CAAC;MAEtI;KACDijB,qBAAqB,GACrB;OACC,OAAO,IAAI,CAACxmB,UAAU,GACnB,IAAI,CAACI,OAAO,CAACC,GAAG,CAACC,UAAU,CAAC,sCAAsC,CAAC,GACnE,IAAI,CAACF,OAAO,CAACC,GAAG,CAACC,UAAU,CAAC,iCAAiC,CAAC;MAEjE;KACDmmB,sBAAsB,GACtB;OACC,OAAO,IAAI,CAACzmB,UAAU,GACnB,IAAI,CAACI,OAAO,CAACC,GAAG,CAACC,UAAU,CAAC,0CAA0C,CAAC,GACvE,IAAI,CAACF,OAAO,CAACC,GAAG,CAACC,UAAU,CAAC,8CAA8C,CAAC,CAC3EoR,OAAO,CAAC,QAAQ,EAAE,mEAAmE,CAAC,CACtFA,OAAO,CAAC,SAAS,EAAE,MAAM,CAAC;MAE7B;KACDmJ,wBAAwB,GACxB;OACC,OAAO,IAAI,CAAC7a,UAAU,GACnB,IAAI,CAACI,OAAO,CAACC,GAAG,CAACC,UAAU,CAAC,2CAA2C,CAAC,GACxE,IAAI,CAACF,OAAO,CAACC,GAAG,CAACC,UAAU,CAAC,+CAA+C,CAAC;MAE/E;KACDwa,uBAAuB,GACvB;OACC,OAAO,IAAI,CAAC9a,UAAU,GACnB,IAAI,CAACI,OAAO,CAACC,GAAG,CAACC,UAAU,CAAC,0CAA0C,CAAC,GACvE,IAAI,CAACF,OAAO,CAACC,GAAG,CAACC,UAAU,CAAC,8CAA8C,CAAC;MAE9E;KACD4Y,cAAc,GACd;OACC,OAAO,IAAI,CAACoN,iBAAiB,GAC1B,IAAI,CAAClmB,OAAO,CAACC,GAAG,CAACC,UAAU,CAAC,0CAA0C,CAAC,GACvE,IAAI,CAACF,OAAO,CAACC,GAAG,CAACC,UAAU,CAAC,6CAA6C,CAAC;;IAG9E;GACDC,OAAO,GACP;KAAA;KACC,IACC,CAAC,IAAI,CAACkL,MAAM,CAACG,OAAO,CAAC2N,OAAO,8BACzB,IAAI,CAAC9N,MAAM,CAACC,KAAK,CAACC,MAAM,CAACsE,oBAAoB,aAA7C,uBAA+C+Q,YAAY,EAE/D;OACC,IAAI,CAAClE,WAAW,EAAE;;KAGnB2F,6BAAY,CAAC1H,SAAS,CAAC,4BAA4B,EAAE,IAAI,CAAC2L,aAAa,CAAC;IACxE;GACDrjB,aAAa,GACb;KACCof,6BAAY,CAAC1H,SAAS,CAAC,4BAA4B,EAAE,IAAI,CAAC2L,aAAa,CAAC;IACxE;GACDnlB,OAAO,EAAE;KACRmlB,aAAa,CAACvc,KAAK,EACnB;OACC,MAAM,CAACuY,YAAY,CAAC,GAAGvY,KAAK,CAACwY,OAAO,EAAE;OACtC,IAAID,YAAY,CAACE,UAAU,EAAE,KAAK,oDAAoD,EACtF;SACC,IAAI,CAAC+D,mBAAmB,EAAE;QAC1B,MACI,IAAIjE,YAAY,CAACE,UAAU,EAAE,KAAK,0DAA0D,EACjG;SACC,IAAI,CAACgE,yBAAyB,EAAE;;MAEjC;KACDD,mBAAmB,GACnB;OACC,IAAI,CAAClL,aAAa,CAAC;SAClBtR,KAAK,EAAE,YAAY;SACnBuR,MAAM,EAAE;QACR,CAAC;MACF;KACDkL,yBAAyB,GACzB;OACC,IAAI,CAACnL,aAAa,CAAC;SAClBtR,KAAK,EAAE,YAAY;SACnBuR,MAAM,EAAE;QACR,CAAC;MACF;KACDmK,eAAe,GACf;OACC,IAAI,CAACgB,+BAA+B,EAAE;OACtC,IAAI,CAACrL,aAAa,EAAE;OACpB,IAAI,CAACsB,WAAW,EAAE;OAClB,IAAI,CAACjc,KAAK,CAACkf,cAAc,CAAC7X,oBAAoB,EAAE;MAChD;KACD+d,iBAAiB,GACjB;OACC,IAAI,CAACY,+BAA+B,EAAE;OACtC,IAAI,CAAChmB,KAAK,CAACkf,cAAc,CAAC/X,KAAK,EAAE;OACjC,IAAI,CAACnH,KAAK,CAACmf,UAAU,CAAChY,KAAK,EAAE;OAC7B,IAAI,CAACwU,eAAe,CAAC,YAAY,EAAE,IAAI,CAAC;OACxC,IAAI,CAACA,eAAe,CAAC,QAAQ,EAAE,IAAI,CAAC;OACpC,IAAI,CAAC/Q,MAAM,CAACQ,MAAM,CAAC,gBAAgB,EAAE,EAAE,CAAC;OACxC,IAAI,CAACR,MAAM,CAACQ,MAAM,CAAC,mBAAmB,EAAE,EAAE,CAAC;OAC3C,IAAI,CAACpL,KAAK,CAACkf,cAAc,CAAC9X,QAAQ,EAAE;OACpC,IAAI,CAAC2S,YAAY,GAAG,EAAE;MACtB;KACDiM,+BAA+B,GAC/B;OACC,IAAI,IAAI,CAACvM,eAAe,KAAK,YAAY,IAAI,CAAC,IAAI,CAACta,UAAU,EAC7D;SACC,IAAI,CAACyb,aAAa,CAAC;WAClBtR,KAAK,EAAE,gBAAgB;WACvBqV,SAAS,EAAE;UACX,CAAC;;OAGH,IAAI,CAAClF,eAAe,GAAG,YAAY;MACnC;KACDiF,0BAA0B,GAC1B;OACC,IAAI,CAAC/D,aAAa,EAAE;OACpB,IAAI,IAAI,CAAClB,eAAe,KAAK,YAAY,IAAI,CAAC,IAAI,CAACta,UAAU,EAC7D;SACC,IAAI,CAACyb,aAAa,CAAC;WAClBtR,KAAK,EAAE,gBAAgB;WACvBqV,SAAS,EAAE;UACX,CAAC;;OAGH,IAAI,CAAClF,eAAe,GAAG,YAAY;MACnC;KACD7C,uBAAuB,GACvB;OACC,IAAI,CAAC+D,aAAa,EAAE;OACpB,IAAI,CAACsB,WAAW,EAAE;MAClB;KACDgK,eAAe,GACf;OACC,IAAI,CAACtL,aAAa,EAAE;OACpB,IAAI,IAAI,CAAClB,eAAe,KAAK,QAAQ,IAAI,CAAC,IAAI,CAACta,UAAU,EACzD;SACC,IAAI,CAACyb,aAAa,CAAC;WAClBtR,KAAK,EAAE,gBAAgB;WACvBqV,SAAS,EAAE;UACX,CAAC;;OAGH,IAAI,CAAClF,eAAe,GAAG,QAAQ;MAC/B;KACDwC,WAAW,GACX;OACC,IAAI,CAAC1D,SAAS,GAAG,IAAI;OACrBlU,cAAI,CAACC,SAAS,CAAC,yCAAyC,EAAE;SACzD9C,IAAI,EAAE;WACLzC,IAAI,EAAE,IAAI,CAAC2a,UAAU;WACrBwC,MAAM,EAAE,IAAI,CAACvC,UAAU;WACvBiL,QAAQ,EAAE,IAAI,CAACha,MAAM,CAACC,KAAK,CAACC,MAAM,CAACsE,oBAAoB,CAAC+Q;;QAEzD,CAAC,CACA5b,IAAI,CAAEC,QAAQ,IAAK;SACnB,IAAI,CAAC+T,SAAS,GAAG,KAAK;SACtB,IAAI,CAAC4D,aAAa,CAAC3X,QAAQ,CAAC;QAC5B,CAAC,CACDM,KAAK,CAAEN,QAAQ,IAAK;SAAA;SACpB,IAAI,CAAC4a,mBAAmB,CAAC5a,QAAQ,CAAC;SAClC,IAAI,CAAC+T,SAAS,GAAG,KAAK;SACtB,IAAI,CAACwB,YAAY,iDAAGvV,QAAQ,CAACmb,MAAM,CAAC,CAAC,CAAC,qBAAlB,kBAAoBlY,OAAO,oCAAI,IAAI,CAAClI,OAAO,CAACC,GAAG,CAACC,UAAU,CAAC,uCAAuC,CAAC;QACvH,CAAC;MACH;KACD0c,aAAa,CAAC3X,QAAQ,EACtB;OACC,IAAI,CAAC4a,mBAAmB,CAAC5a,QAAQ,CAAC;OAElC,IAAI,CAACxE,KAAK,CAACkf,cAAc,CAACva,IAAI,EAAE;OAChC,IAAI,CAAC3E,KAAK,CAACmf,UAAU,CAACxa,IAAI,EAAE;OAC5B,IAAI,CAACgX,eAAe,CAAC,YAAY,EAAE,KAAK,CAAC;OACzC,IAAI,CAACA,eAAe,CAAC,QAAQ,EAAE,KAAK,CAAC;OACrC,IAAI,CAAC3b,KAAK,CAACkf,cAAc,CAAC9X,QAAQ,EAAE;OACpC,IAAI,CAACpH,KAAK,CAACmf,UAAU,CAAC/X,QAAQ,EAAE;MAChC;KACDgY,mBAAmB,CAAC5a,QAAQ,EAC5B;OACC,MAAM6a,YAAY,GAAG7a,QAAQ,CAAChD,IAAI;OAElC,IAAI,CAAC6d,YAAY,EACjB;SACC;;OAGD,IAAI,CAACoG,iBAAiB,GAAG,IAAI;OAC7B,MAAMzO,OAAO,GAAG,EAAE;OAClBqI,YAAY,CAACrI,OAAO,CAAC9J,OAAO,CAAC,CAACoS,MAAM,EAAE/Q,KAAK,KAAK;SAC/CyI,OAAO,CAAC7J,IAAI,CAAC,IAAI,CAACoS,aAAa,CAACD,MAAM,EAAE/Q,KAAK,CAAC,CAAC;QAC/C,CAAC;OAEF,IAAI,CAAC3D,MAAM,CAACQ,MAAM,CAAC,mBAAmB,EAAE4L,OAAO,CAAC;OAChD,IAAI,CAACpM,MAAM,CAACQ,MAAM,CAAC,gBAAgB,EAAEiU,YAAY,CAAC7d,IAAI,CAAC;MACvD;KACD+d,aAAa,CAACD,MAAM,EAAE/Q,KAAK,EAC3B;OACC,OAAO;SACNpN,EAAE,EAAEme,MAAM,CAACne,EAAE;SACbqe,OAAO,EAAEF,MAAM,CAACE,OAAO;SACvBzgB,IAAI,EAAEugB,MAAM,CAACvgB,IAAI;SACjBwJ,IAAI,EAAE+W,MAAM,CAAC/W,IAAI,IAAI+W,MAAM,CAAC/W,IAAI,CAAC+C,MAAM,GAAG,CAAC,GAAGgU,MAAM,CAAC/W,IAAI,GAAI,SAAQgG,KAAM,EAAC;SAC5ES,YAAY,EAAEsQ,MAAM,CAACvgB,IAAI;SACzBkQ,YAAY,EAAEqQ,MAAM,CAACG,YAAY;SACjCA,YAAY,EAAEH,MAAM,CAACG;QACrB;MACD;KACDjD,WAAW,GACX;OACC,IAAI,CAAC,IAAI,CAAC1C,kBAAkB,EAC5B;SACC,IAAI,CAAC9Z,KAAK,CAACmf,UAAU,CAAC9X,oBAAoB,EAAE;SAC5C,IAAI,CAACrH,KAAK,CAACkf,cAAc,CAAC7X,oBAAoB,EAAE;SAEhD,OAAO,KAAK;;OAGb,IAAI,CAAC0U,WAAW,CAAC,gBAAgB,EAAE,IAAI,CAAC;OAExC,OAAO,IAAI;MACX;KACDY,SAAS,CAACnY,QAAQ,EAClB;OAAA;OACC,MAAMqb,WAAW,0BAAGrb,QAAQ,CAAChD,IAAI,CAAC+G,IAAI,kCAAI,IAAI,CAACqC,MAAM,CAACC,KAAK,CAACC,MAAM,CAACH,iBAAiB,CAACpC,IAAI;OACzF,IAAI,CAACuV,WAAW,CAACJ,aAAa,GAAG;SAChChb,KAAK,EAAEmd,WAAW;SAClB7b,SAAS,EAAEQ,QAAQ,CAAChD,IAAI,CAACL,EAAE;SAC3BsD,IAAI,EAAED,QAAQ,CAAChD,IAAI,CAAC0kB;QACpB;OAED,IAAI,CAACnK,WAAW,CAAC,gBAAgB,EAAE,KAAK,CAAC;OACzC,IAAI,CAACA,WAAW,CAAC,eAAe,EAAE,IAAI,CAAC;OACvC,IAAI,CAACxC,SAAS,GAAG,KAAK;OACtB,IAAI,CAACqB,aAAa,CAAC;SAClBtR,KAAK,EAAE,IAAI,CAACnK,UAAU,GAAG,iBAAiB,GAAG,cAAc;SAC3D0b,MAAM,EAAE,SAAS;SACjB+D,EAAE,EAAG,eAAciB,WAAW,CAAChB,UAAU,CAAC,GAAG,EAAE,EAAE,CAAE;QACnD,CAAC;OACFxe,EAAE,CAAC2R,SAAS,CAACC,QAAQ,CAAC6N,WAAW,CAACpb,MAAM,EAAE,6CAA6C,EAAE,EAAE,CAAC;MAC5F;KACDkY,WAAW,GACX;OACC,IAAI,CAACb,WAAW,CAAC,gBAAgB,EAAE,KAAK,CAAC;OACzC,IAAI,CAACA,WAAW,CAAC,eAAe,EAAE,IAAI,CAAC;OACvC,IAAI,CAACnB,aAAa,CAAC;SAClBtR,KAAK,EAAE,IAAI,CAACnK,UAAU,GAAG,iBAAiB,GAAG,cAAc;SAC3D0b,MAAM,EAAE;QACR,CAAC;OACFxa,EAAE,CAAC2R,SAAS,CAACC,QAAQ,CAAC6N,WAAW,CAACpb,MAAM,EAAE,6CAA6C,EAAE,EAAE,CAAC;MAC5F;KACDqb,mBAAmB,GACnB;OACC,IAAI,CAAChE,WAAW,CAAC,eAAe,EAAE,KAAK,CAAC;OACxC,IAAI,CAACP,QAAQ,EAAE;MACf;KACDwE,iBAAiB,GACjB;OACC,IAAI,CAACjE,WAAW,CAAC,eAAe,EAAE,KAAK,CAAC;;IAEzC;GACD/Y,UAAU,EAAE;KACXpE,SAAS;KACToC,YAAY;KACZoX,aAAa;KACbqL,cAAc;KACdhZ,qBAAqB;KACrBmG,kBAAkB;KAClBrN,mBAAmB;KACnBQ,kBAAkB;KAClBX,kBAAkB;KAClBX;IACA;;GAED1B,QAAQ,EAAG;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;CAqFZ,CAAC;;CC7bD;AACA,CAGO,MAAMolB,KAAK,CAClB;GACC,OAAOC,UAAU,CAACC,aAA8B,EAChD;KACC,OAAOC,wBAAW,CAAC;OAClBzb,KAAK,GACL;SACC,OAAOwb,aAAa;QACpB;OACDE,SAAS,EAAE;SACVC,iBAAiB,CAAC3b,KAAK,EAAEiB,cAAc,EACvC;WACCjB,KAAK,CAACC,MAAM,CAACgB,cAAc,GAAGA,cAAc;UAC5C;SACD2a,uBAAuB,CAAC5b,KAAK,EAAEuE,oBAAoB,EACnD;WACCvE,KAAK,CAACC,MAAM,CAACsE,oBAAoB,GAAGA,oBAAoB;UACxD;SACDsX,oBAAoB,CAAC7b,KAAK,EAAEF,iBAAiB,EAC7C;WACCE,KAAK,CAACC,MAAM,CAACH,iBAAiB,GAAGA,iBAAiB;UAClD;SACDgc,mBAAmB,CAAC9b,KAAK,EAAE+b,QAAQ,EACnC;WACC/b,KAAK,CAACC,MAAM,CAACoF,cAAc,CAAC0W,QAAQ,CAAC,CAACpH,OAAO,GAAG,CAAC3U,KAAK,CAACC,MAAM,CAACoF,cAAc,CAAC0W,QAAQ,CAAC,CAACpH,OAAO;UAC9F;SACDqH,iBAAiB,CAAChc,KAAK,EACvB;WACCA,KAAK,CAACC,MAAM,CAACoF,cAAc,GAAGrF,KAAK,CAACC,MAAM,CAACoF,cAAc,CAAC4W,GAAG,CAAElX,KAAK,IAAK;aACxEA,KAAK,CAAC4P,OAAO,GAAG,IAAI;aAEpB,OAAO5P,KAAK;YACZ,CAAC;UACF;SACDmX,mBAAmB,CAAClc,KAAK,EACzB;WACCA,KAAK,CAACC,MAAM,CAACoF,cAAc,GAAGrF,KAAK,CAACC,MAAM,CAACoF,cAAc,CAAC4W,GAAG,CAAElX,KAAK,IAAK;aACxEA,KAAK,CAAC4P,OAAO,GAAG,KAAK;aAErB,OAAO5P,KAAK;YACZ,CAAC;UACF;SACDoX,mBAAmB,CAACnc,KAAK,EAAEoc,OAAO,EAClC;WACCpc,KAAK,CAACC,MAAM,CAACoF,cAAc,CAAC+W,OAAO,CAAC1Y,KAAK,CAAC,GAAG0Y,OAAO,CAAC1V,QAAQ;UAC7D;SACD2V,cAAc,CAACrc,KAAK,EAAEsc,OAAO,EAC7B;WACCtc,KAAK,CAACC,MAAM,CAACuL,WAAW,GAAG8Q,OAAO;UAClC;SACDC,cAAc,CAACvc,KAAK,EAAErJ,IAAI,EAC1B;WACCqJ,KAAK,CAAC2N,WAAW,CAAC1H,IAAI,GAAGtP,IAAI;UAC7B;SACD6lB,iBAAiB,CAACxc,KAAK,EAAE0G,QAAQ,EACjC;WACC1G,KAAK,CAACC,MAAM,CAACoF,cAAc,GAAGqB,QAAQ;;QAEvC;OACDxG,OAAO,EAAE;SACR5L,UAAU,CAAC0L,KAAK,EAChB;WACC,OAAOA,KAAK,CAACC,MAAM,CAACH,iBAAiB,CAACxJ,EAAE,GAAG,CAAC;UAC5C;SACDiP,iBAAiB,CAACvF,KAAK,EACvB;WACC,OAAOA,KAAK,CAACC,MAAM,CAACoF,cAAc,CAACiH,MAAM,CAAEvH,KAAK,IAAK,CAAEA,KAAK,CAAC4P,OAAQ,CAAC,CAAClU,MAAM,KAAK,CAAC;UACnF;SACD+E,gBAAgB,CAACxF,KAAK,EACtB;WACC,OAAOA,KAAK,CAACC,MAAM,CAACoF,cAAc,CAACiH,MAAM,CAAEvH,KAAK,IAAMA,KAAK,CAAC4P,OAAQ,CAAC,CAAClU,MAAM,KAAK,CAAC;UAClF;SACDgF,kBAAkB,CAACzF,KAAK,EAAEE,OAAO,EACjC;WACC,OAAO,CAACA,OAAO,CAACqF,iBAAiB,IAAI,CAACrF,OAAO,CAACsF,gBAAgB;UAC9D;SACDyI,mBAAmB,CAACjO,KAAK,EACzB;WACC,MAAMic,GAAG,GAAG,EAAE;WACdjc,KAAK,CAACC,MAAM,CAACoF,cAAc,CAAChD,OAAO,CAAE0C,KAAK,IAAK;aAC9CkX,GAAG,CAAC3Z,IAAI,CAACnO,OAAO,CAAC4Q,KAAK,CAAC4P,OAAO,CAAC,CAAC;YAChC,CAAC;WAEF,OAAOsH,GAAG;UACV;SACD3V,cAAc,CAACtG,KAAK,EACpB;WACC,OAAOA,KAAK,CAACC,MAAM,CAACoF,cAAc,CAAC4W,GAAG,CAAExZ,IAAI,IAAKA,IAAI,CAAC/E,IAAI,CAAC;UAC3D;SACDmQ,OAAO,CAAC7N,KAAK,EACb;WAAA;WACC,OAAO,uBAAAA,KAAK,CAAC2N,WAAW,8CAAjB,mBAAmB1H,IAAI,qBAAvB,sBAAyBxF,MAAM,IAAG,CAAC;UAC1C;SACD8D,oBAAoB,CAACvE,KAAK,EAC1B;WAAA;WACC,wBAAOA,KAAK,CAACC,MAAM,qBAAZ,cAAcsE,oBAAoB;UACzC;SACDzE,iBAAiB,CAACE,KAAK,EACvB;WAAA;WACC,yBAAOA,KAAK,CAACC,MAAM,qBAAZ,eAAcH,iBAAiB;;;MAGxC,CAAC;;CAEJ;;CCrGA,MAAM2c,OAAO,GAAG;GACfC,GAAG,EAAEhK,MAAM;GACX,IAAI,EAAE+H;CACP,CAAC;AAQD,CAAO,MAAMkC,UAAU,CACvB;GACC,OAAOC,MAAM,CAACvC,IAAY,EAAEwC,YAA6B,GAAG,EAAE,EAAEtO,SAAoB,GAAG,EAAE,EACzF;KACC,MAAMuO,gBAAgB,GAAG;OACxBnP,WAAW,EAAE,EAAE;OACf1N,MAAM,EAAE;SACPgB,cAAc,EAAE,EAAE;SAClBuK,WAAW,EAAE,EAAE;SACf1L,iBAAiB,EAAE,EAAE;SACrBuF,cAAc,EAAE;;MAEjB;KAED,MAAMrF,KAAK,GAAGxK,EAAE,CAACunB,IAAI,CAACC,WAAW,CAACF,gBAAgB,EAAED,YAAY,CAAC;KAEjE,IAAII,GAAG,GAAG,IAAI;KAEd,MAAMC,YAAY,GAAGT,OAAO,CAACpC,IAAI,CAAC;KAElC,IAAI6C,YAAY,EAChB;OACCD,GAAG,GAAGE,iBAAS,CAACC,SAAS,CAAC;SACzB1f,IAAI,EAAE,eAAe;SACrB/G,IAAI,GACJ;WACC,OAAO;aACN4X;YACA;UACD;SACDpW,UAAU,EAAE;WACX+kB;UACA;SACD3oB,QAAQ,EAAE;WACT8oB,aAAa,GACb;aACC,OAAOH,YAAY;;UAEpB;;SAEDhnB,QAAQ,EAAG;;;QAGX,CAAC;;KAGH,IAAI+mB,GAAG,EACP;OACC,MAAMK,KAAK,GAAGhC,KAAK,CAACC,UAAU,CAACvb,KAAK,CAAC;OAErCid,GAAG,CAACM,GAAG,CAACD,KAAK,CAAC;;KAGf,OAAOL,GAAG;;CAEZ;;CCtEO,MAAMO,MAAM,CACnB;GACC,OAAO1jB,IAAI,CAACigB,QAAgB,EAAE5gB,SAAkB,GAAG,CAAC,EACpD;KACC,MAAMskB,aAAa,GAAG,iEAAiE;KAEvF,MAAMC,UAAU,GAAG,IAAIC,aAAG,CAACF,aAAa,CAAC;KACzCC,UAAU,CAACE,aAAa,CAAC,UAAU,EAAE7D,QAAQ,CAAC;KAC9C,IAAI5gB,SAAS,EACb;OACCukB,UAAU,CAACE,aAAa,CAAC,WAAW,EAAEzkB,SAAS,CAAC;;KAGjD,MAAM3C,OAAO,GAAG;OACfsB,KAAK,EAAE,IAAI;OACX8e,kBAAkB,EAAE,KAAK;OACzBvZ,SAAS,EAAE;MACX;KAED,IAAIwgB,MAAM,CAAC/lB,KAAK,IAAI,IAAI,EACxB;OACCtB,OAAO,CAACsnB,kBAAkB,GAAG,CAAC;;KAG/B3W,sBAAS,CAACC,QAAQ,CAACtN,IAAI,CACtB4jB,UAAU,CAAC7F,QAAQ,EAAE,EACrBrhB,OAAO,CACP;;CAEH;;;;;;;;;"}