this.BX=this.BX||{},function(t,e,i,s,n,a,o,r,c,l){"use strict";function d(t,e){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function(t,e){if(!t)return;if("string"==typeof t)return p(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return p(t,e)}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var s=0,n=function(){};return{s:n,n:function(){return s>=t.length?{done:!0}:{done:!1,value:t[s++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,r=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return o=t.done,t},e:function(t){r=!0,a=t},f:function(){try{o||null==i.return||i.return()}finally{if(r)throw a}}}}function p(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,s=new Array(e);i<e;i++)s[i]=t[i];return s}function b(t,e){h(t,e),e.add(t)}function v(t,e,i){h(t,e),e.set(t,i)}function h(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function u(t,e,i){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return i}var g=new WeakMap,f=new WeakMap,P=new WeakMap,S=new WeakMap,E=new WeakMap,I=new WeakMap,w=new WeakSet,C=new WeakSet,T=new WeakSet,y=new WeakSet,m=new WeakSet,B=new WeakSet,_=new WeakSet,x=function(){function t(e){babelHelpers.classCallCheck(this,t),b(this,_),b(this,B),b(this,m),b(this,y),b(this,T),b(this,C),b(this,w),v(this,g,{writable:!0,value:void 0}),v(this,f,{writable:!0,value:void 0}),v(this,P,{writable:!0,value:void 0}),v(this,S,{writable:!0,value:void 0}),v(this,E,{writable:!0,value:!0}),v(this,I,{writable:!0,value:void 0}),babelHelpers.classPrivateFieldSet(this,g,e.dashboardId),babelHelpers.classPrivateFieldSet(this,f,e.openedFrom)}return babelHelpers.createClass(t,[{key:"showPopup",value:function(){var t=this;return new Promise((function(i,s){u(t,w,H).call(t,babelHelpers.classPrivateFieldGet(t,g)).then((function(e){babelHelpers.classPrivateFieldSet(t,S,e.data),u(t,C,F).call(t,e.data),i(e)})).catch((function(t){e.UI.Notification.Center.notify({content:e.Loc.getMessage("BIC_EXPORT_ERROR")}),s(t)}))}))}}]),t}();function H(t){return new Promise((function(s,n){e.ajax.runAction("biconnector.dashboard.getExportData",{data:{id:t}}).then((function(t){i.EventEmitter.emit("BIConnector.ExportMaster:onDashboardDataLoaded"),s(t)})).catch((function(t){n(t)}))}))}function F(t){var i=this;if(babelHelpers.classPrivateFieldSet(this,P,new n.Popup({content:u(this,T,R).call(this,t),closeIcon:!0,closeByEsc:!0,cacheable:!1,overlay:!0,width:360,height:500,padding:0})),babelHelpers.classPrivateFieldGet(this,P).show(),t.scopesNotToExport){var s=document.querySelector("#bic-scope-hint");e.UI.Hint.createInstance({popupParameters:{darkMode:!0,maxWidth:250,padding:5,offsetTop:0,offsetLeft:10,angle:!0,animation:"fading-slide"}}).initNode(s)}new l.TextCrop({rows:1,resize:!0,target:document.querySelector(".bic-export-dashboard-title")}).init(),babelHelpers.classPrivateFieldSet(this,I,new r.Button({text:e.Loc.getMessage("BIC_EXPORT_BUTTON"),size:r.Button.Size.SMALL,round:!0,color:r.Button.Color.PRIMARY,className:"bic-export-button",onclick:function(){return u(i,m,O).call(i,babelHelpers.classPrivateFieldGet(i,g),babelHelpers.classPrivateFieldGet(i,E))}})),babelHelpers.classPrivateFieldGet(this,I).renderTo(babelHelpers.classPrivateFieldGet(this,P).getContentContainer().querySelector(".bic-export-footer")),new c.Switcher({node:babelHelpers.classPrivateFieldGet(this,P).getContentContainer().querySelector("#bic-setting-switcher"),checked:!0,color:c.SwitcherColor.primary,size:c.SwitcherSize.small,handlers:{toggled:u(this,y,A).bind(this)}}),babelHelpers.classPrivateFieldGet(this,P).getContentContainer().querySelector(".bic-settings-link").onclick=u(this,B,X).bind(this,babelHelpers.classPrivateFieldGet(this,g))}function R(t){var i="";t.scopesToExport||t.scopesNotToExport?t.scopesToExport?(i='<span class="bic-scopes-to-export">'.concat(t.scopesToExport,"</span>"),t.scopesNotToExport&&(i+=', <span class="bic-scopes-not-to-export">'.concat(t.scopesNotToExport,"</span>"))):i='<span class="bic-scopes-not-to-export">'.concat(t.scopesNotToExport,"</span>"):i=e.Loc.getMessage("BIC_EXPORT_SCOPE_NONE");var s="";t.scopesNotToExport&&(s='\n\t\t\t\t<span data-hint="'.concat(e.Loc.getMessage("BIC_EXPORT_SCOPE_HINT"),'" data-hint-no-icon id="bic-scope-hint">\n\t\t\t\t\t<i class="ui-icon-set --info-circle bic-scope-hint-icon"></i>\n\t\t\t\t</span>\n\t\t\t'));var n=t.urlParams||e.Loc.getMessage("BIC_EXPORT_SCOPE_NONE");return'\n\t\t\t<div class="bic-export-container">\n\t\t\t\t<div class="bic-export-header">\n\t\t\t\t\t<div class="bic-export-subtitle">'.concat(e.Loc.getMessage("BIC_EXPORT_SUBTITLE"),'</div>\n\t\t\t\t\t<div class="bic-export-dashboard-title">').concat(t.title,'</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="bic-export-separator"></div>\n\t\t\t\t<div class="bic-export-body">\n\t\t\t\t\t<div class="bic-setting-item bic-setting-item-export-with-settings">\n\t\t\t\t\t\t<div class="bic-setting-title">').concat(e.Loc.getMessage("BIC_EXPORT_EXPORT_WITH_SETTINGS"),'</div>\n\t\t\t\t\t\t<div class="bic-setting-value" id="bic-setting-switcher"></div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class="bic-export-hint">').concat(e.Loc.getMessage("BIC_EXPORT_HINT"),'</div>\n\t\t\t\t\t<div class="bic-export-hint disabled">').concat(e.Loc.getMessage("BIC_EXPORT_HINT_WITH_NO_SETTINGS"),'</div>\n\n\t\t\t\t\t<div class="bic-setting-item bic-setting-item-period">\n\t\t\t\t\t\t<div class="bic-setting-title">').concat(e.Loc.getMessage("BIC_EXPORT_PERIOD"),'</div>\n\t\t\t\t\t\t<div class="bic-setting-value">').concat(t.period,'</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class="bic-setting-item bic-setting-item-scope">\n\t\t\t\t\t\t<div class="bic-setting-title">\n\t\t\t\t\t\t\t<span>').concat(e.Loc.getMessage("BIC_EXPORT_SCOPE"),"</span>\n\t\t\t\t\t\t\t").concat(s,'\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="bic-setting-value">').concat(i,'</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t\n\t\t\t\t\t<div class="bic-setting-item bic-setting-item-url-params">\n\t\t\t\t\t\t<div class="bic-setting-title">\n\t\t\t\t\t\t\t<span>').concat(e.Loc.getMessage("BIC_EXPORT_URL_PARAM"),'</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="bic-setting-value">').concat(n,'</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class="bic-setting-item">\n\t\t\t\t\t\t<span class="bic-settings-link">').concat(e.Loc.getMessage("BIC_EXPORT_OPEN_SETTINGS"),'</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t\n\t\t\t\t</div>\n\t\t\t\t<div class="bic-export-separator"></div>\n\t\t\t\t<div class="bic-export-footer"></div>\n\t\t\t</div>\n\t\t')}function A(){var t,i=d(babelHelpers.classPrivateFieldGet(this,P).getContentContainer().querySelectorAll(".bic-setting-item-period,.bic-setting-item-scope,.bic-export-hint,.bic-settings-link"));try{for(i.s();!(t=i.n()).done;){var s=t.value;e.Dom.toggleClass(s,"disabled")}}catch(t){i.e(t)}finally{i.f()}babelHelpers.classPrivateFieldSet(this,E,!babelHelpers.classPrivateFieldGet(this,E))}function O(t,i){var s=this;return babelHelpers.classPrivateFieldGet(this,I).setState(r.Button.State.WAITING),e.ajax.runAction("biconnector.dashboard.export",{data:{id:t,withSettings:i?1:0}}).then((function(e){var i=e.data.filePath;i&&window.open(i,"_self"),babelHelpers.classPrivateFieldGet(s,P).close(),a.ApacheSupersetAnalytics.sendAnalytics("edit","report_export",{type:babelHelpers.classPrivateFieldGet(s,S).type.toLowerCase(),p1:a.ApacheSupersetAnalytics.buildAppIdForAnalyticRequest(babelHelpers.classPrivateFieldGet(s,S).appId),p2:t,status:"success",c_element:babelHelpers.classPrivateFieldGet(s,f)})})).catch((function(){e.UI.Notification.Center.notify({content:e.Loc.getMessage("BIC_EXPORT_ERROR")}),babelHelpers.classPrivateFieldGet(s,I).setState(r.Button.State.ACTIVE),a.ApacheSupersetAnalytics.sendAnalytics("edit","report_export",{type:babelHelpers.classPrivateFieldGet(s,S).type.toLowerCase(),p1:a.ApacheSupersetAnalytics.buildAppIdForAnalyticRequest(babelHelpers.classPrivateFieldGet(s,S).appId),p2:t,status:"error",c_element:babelHelpers.classPrivateFieldGet(s,f)})}))}function X(t){i.EventEmitter.subscribe("BX.BIConnector.Settings:onAfterSave",u(this,_,M).bind(this)),o.DashboardManager.openSettingsSlider(t)}function M(){var t=this;(i.EventEmitter.unsubscribe("BX.BIConnector.Settings:onAfterSave",u(this,_,M).bind(this)),babelHelpers.classPrivateFieldGet(this,P).isDestroyed())||(new s.Loader({target:babelHelpers.classPrivateFieldGet(this,P).getContentContainer()}).show(),u(this,w,H).call(this,babelHelpers.classPrivateFieldGet(this,g)).then((function(e){babelHelpers.classPrivateFieldSet(t,S,e.data),babelHelpers.classPrivateFieldGet(t,P).close(),u(t,C,F).call(t,e.data)})).catch((function(){e.UI.Notification.Center.notify({content:e.Loc.getMessage("BIC_EXPORT_ERROR")})})))}t.DashboardExportMaster=x}(this.BX.BIConnector=this.BX.BIConnector||{},BX,BX.Event,BX,BX.Main,BX.BIConnector,BX.BIConnector,BX.UI,BX.UI,BX.UI);
//# sourceMappingURL=dashboard-export-master.bundle.map.js