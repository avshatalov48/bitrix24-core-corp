{"version":3,"file":"script.js","sources":["script.es6.js"],"sourcesContent":["import { Loc, Type, Tag, Reflection, Dom, Text } from 'main.core';\nimport { DashboardManager } from 'biconnector.apache-superset-dashboard-manager';\nimport { EventEmitter } from 'main.core.events';\nimport { MessageBox } from 'ui.dialogs.messagebox';\nimport { ApacheSupersetAnalytics } from 'biconnector.apache-superset-analytics';\nimport type { DashboardAnalyticInfo } from 'biconnector.apache-superset-analytics';\n\ntype Props = {\n\tgridId: ?string,\n};\n\ntype LoginPopupParams = {\n\tdashboardId: number,\n\ttype: string,\n\teditUrl: string,\n\tappId: string,\n};\n\nclass SupersetDashboardGridManager\n{\n\t#dashboardManager: DashboardManager = null;\n\t#grid: BX.Main.grid;\n\n\tconstructor(props: Props)\n\t{\n\t\tthis.#dashboardManager = new DashboardManager();\n\n\t\tthis.#grid = BX.Main.gridManager.getById(props.gridId)?.instance;\n\t\tthis.#subscribeToEvents();\n\t}\n\n\t#subscribeToEvents()\n\t{\n\t\tEventEmitter.subscribe('BiConnector:DashboardManager.onUserCredentialsLoaded', this.onUserCredentialsLoaded.bind(this));\n\n\t\tEventEmitter.subscribe('SidePanel.Slider:onMessage', (event) => {\n\t\t\tconst [sliderEvent] = event.getCompatData();\n\n\t\t\tif (sliderEvent.getEventId() === 'BIConnector.Superset.DashboardDetail:onDashboardBatchStatusUpdate')\n\t\t\t{\n\t\t\t\tconst eventArgs = sliderEvent.getData();\n\t\t\t\tif (eventArgs.dashboardList)\n\t\t\t\t{\n\t\t\t\t\tthis.onUpdatedDashboardBatchStatus(eventArgs.dashboardList);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tEventEmitter.subscribe('BIConnector.Superset.DashboardManager:onDashboardBatchStatusUpdate', (event) => {\n\t\t\tconst data = event.getData();\n\t\t\tif (!data.dashboardList)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst dashboardList = data.dashboardList;\n\t\t\tthis.onUpdatedDashboardBatchStatus(dashboardList);\n\t\t});\n\n\t\tEventEmitter.subscribe('BX.Rest.Configuration.Install:onFinish', () => {\n\t\t\tthis.#grid.reload();\n\t\t});\n\t}\n\n\tonUpdatedDashboardBatchStatus(dashboardList: Array)\n\t{\n\t\tfor (const dashboard of dashboardList)\n\t\t{\n\t\t\tthis.updateDashboardStatus(dashboard.id, dashboard.status);\n\t\t}\n\t}\n\n\tgetGrid(): BX.Main.grid\n\t{\n\t\treturn this.#grid;\n\t}\n\n\t/**\n\t * @param params LoginPopupParams\n\t * @param openedFrom\n\t */\n\tshowLoginPopup(params: LoginPopupParams, openedFrom: string = 'unknown')\n\t{\n\t\tconst grid = this.getGrid();\n\t\tif (params.type === 'CUSTOM')\n\t\t{\n\t\t\tgrid.tableFade();\n\t\t}\n\n\t\tthis.#dashboardManager.processEditDashboard(\n\t\t\t{\n\t\t\t\tid: params.dashboardId,\n\t\t\t\ttype: params.type,\n\t\t\t\teditLink: params.editUrl,\n\t\t\t},\n\t\t\t() => {\n\t\t\t\tgrid.tableUnfade();\n\t\t\t},\n\t\t\t(popupType) => {\n\t\t\t\tApacheSupersetAnalytics.sendAnalytics('edit', 'report_edit', {\n\t\t\t\t\tc_sub_section: popupType,\n\t\t\t\t\tc_element: openedFrom,\n\t\t\t\t\ttype: params.type.toLowerCase(),\n\t\t\t\t\tp1: ApacheSupersetAnalytics.buildAppIdForAnalyticRequest(params.appId),\n\t\t\t\t\tp2: params.dashboardId,\n\t\t\t\t\tstatus: 'success',\n\t\t\t\t});\n\t\t\t},\n\t\t\t(popupType) => {\n\t\t\t\tApacheSupersetAnalytics.sendAnalytics('edit', 'report_edit', {\n\t\t\t\t\tc_sub_section: popupType,\n\t\t\t\t\tc_element: openedFrom,\n\t\t\t\t\ttype: params.type.toLowerCase(),\n\t\t\t\t\tp1: ApacheSupersetAnalytics.buildAppIdForAnalyticRequest(params.appId),\n\t\t\t\t\tp2: params.dashboardId,\n\t\t\t\t\tstatus: 'error',\n\t\t\t\t});\n\t\t\t},\n\t\t);\n\t}\n\n\tonUserCredentialsLoaded()\n\t{\n\t\tthis.getGrid().tableUnfade();\n\t}\n\n\trestartDashboardLoad(dashboardId: number): void\n\t{\n\t\tconst row = this.#grid.getRows().getById(dashboardId);\n\t\tif (row)\n\t\t{\n\t\t\tconst btn = row.node.querySelector('#restart-dashboard-load-btn');\n\t\t\tif (Type.isDomNode(btn))\n\t\t\t{\n\t\t\t\tconst isDisabled = btn.getAttribute('disabled');\n\t\t\t\tif (isDisabled)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tbtn.setAttribute('disabled', 'true');\n\t\t\t\tDom.addClass(btn, 'dashboard-status-label-error-btn__loading');\n\t\t\t}\n\t\t}\n\n\t\tthis.#dashboardManager.restartDashboardImport(dashboardId).then(\n\t\t\t(response) => {\n\t\t\t\tconst dashboardIds = response?.data?.restartedDashboardIds;\n\t\t\t\tif (!dashboardIds)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tfor (const restartedDashboardId of dashboardIds)\n\t\t\t\t{\n\t\t\t\t\tthis.updateDashboardStatus(restartedDashboardId, 'L');\n\t\t\t\t}\n\t\t\t},\n\t\t);\n\t}\n\n\tsetDashboardStatusReady(dashboardId: number): void\n\t{\n\t\tconst row = this.#grid.getRows().getById(dashboardId);\n\t\tif (row)\n\t\t{\n\t\t\tconst label = row.node.getElementsByClassName('dashboard-status-label')[0];\n\t\t\tDom.addClass(label, 'ui-label-success');\n\t\t\tDom.removeClass(label, 'ui-label-primary');\n\t\t\tlabel.querySelector('span').innerText = Loc.getMessage('BICONNECTOR_SUPERSET_DASHBOARD_GRID_STATUS_READY');\n\t\t}\n\t}\n\n\tupdateDashboardStatus(dashboardId: number, status: string): void\n\t{\n\t\tconst row = this.#grid.getRows().getById(dashboardId);\n\t\tif (row)\n\t\t{\n\t\t\tconst labelWrapper = row.node.querySelector('.dashboard-status-label-wrapper');\n\t\t\tconst label = labelWrapper.querySelector('.dashboard-status-label');\n\t\t\tconst reloadBtn = labelWrapper.querySelector('#restart-dashboard-load-btn');\n\n\t\t\tswitch (status) {\n\t\t\t\tcase DashboardManager.DASHBOARD_STATUS_READY:\n\t\t\t\t\tif (reloadBtn)\n\t\t\t\t\t{\n\t\t\t\t\t\treloadBtn.remove();\n\t\t\t\t\t}\n\t\t\t\t\tDom.addClass(label, 'ui-label-success');\n\t\t\t\t\tDom.removeClass(label, 'ui-label-primary');\n\t\t\t\t\tDom.removeClass(label, 'ui-label-danger');\n\t\t\t\t\tlabel.querySelector('span').innerText = Loc.getMessage('BICONNECTOR_SUPERSET_DASHBOARD_GRID_STATUS_READY');\n\t\t\t\t\tbreak;\n\t\t\t\tcase DashboardManager.DASHBOARD_STATUS_LOAD:\n\t\t\t\t\tif (reloadBtn)\n\t\t\t\t\t{\n\t\t\t\t\t\treloadBtn.remove();\n\t\t\t\t\t}\n\t\t\t\t\tDom.addClass(label, 'ui-label-primary');\n\t\t\t\t\tDom.removeClass(label, 'ui-label-success');\n\t\t\t\t\tDom.removeClass(label, 'ui-label-danger');\n\t\t\t\t\tlabel.querySelector('span').innerText = Loc.getMessage('BICONNECTOR_SUPERSET_DASHBOARD_GRID_STATUS_LOAD');\n\t\t\t\t\tbreak;\n\t\t\t\tcase DashboardManager.DASHBOARD_STATUS_FAILED:\n\t\t\t\t\tif (!reloadBtn)\n\t\t\t\t\t{\n\t\t\t\t\t\tconst createdReloadBtn = this.createReloadBtn(dashboardId);\n\t\t\t\t\t\tDom.append(createdReloadBtn, labelWrapper);\n\t\t\t\t\t}\n\t\t\t\t\tDom.addClass(label, 'ui-label-danger');\n\t\t\t\t\tDom.removeClass(label, 'ui-label-success');\n\t\t\t\t\tDom.removeClass(label, 'ui-label-primary');\n\t\t\t\t\tlabel.querySelector('span').innerText = Loc.getMessage('BICONNECTOR_SUPERSET_DASHBOARD_GRID_STATUS_FAILED');\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tcreateReloadBtn(dashboardId: number): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div id=\"restart-dashboard-load-btn\" onclick=\"BX.BIConnector.SupersetDashboardGridManager.Instance.restartDashboardLoad(${dashboardId})\" class=\"dashboard-status-label-error-btn\">\n\t\t\t\t<div class=\"ui-icon-set --refresh-5 dashboard-status-label-error-icon\"></div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tduplicateDashboard(dashboardId: number, analyticInfo: DashboardAnalyticInfo = null): void\n\t{\n\t\tconst grid = this.getGrid();\n\t\tgrid.tableFade();\n\n\t\treturn this.#dashboardManager.duplicateDashboard(dashboardId)\n\t\t\t.then((response) => {\n\t\t\t\tconst gridRealtime: BX.Grid.Realtime = grid.getRealtime();\n\t\t\t\tconst newDashboard = response.data.dashboard;\n\n\t\t\t\tgridRealtime.addRow({\n\t\t\t\t\tid: newDashboard.id,\n\t\t\t\t\tprepend: true,\n\t\t\t\t\tcolumns: newDashboard.columns,\n\t\t\t\t\tactions: newDashboard.actions,\n\t\t\t\t});\n\t\t\t\tgrid.tableUnfade();\n\t\t\t\tconst counterTotalTextContainer = grid.getCounterTotal().querySelector('.main-grid-panel-content-text');\n\t\t\t\tcounterTotalTextContainer.textContent++;\n\n\t\t\t\tBX.UI.Hint.init(BX('biconnector-dashboard-grid'));\n\t\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\t\tcontent: Loc.getMessage('BICONNECTOR_SUPERSET_DASHBOARD_GRID_COPY_NOTIFICATION_ADDED'),\n\t\t\t\t});\n\n\t\t\t\tif (analyticInfo !== null)\n\t\t\t\t{\n\t\t\t\t\tApacheSupersetAnalytics.sendAnalytics('edit', 'report_copy', {\n\t\t\t\t\t\ttype: analyticInfo.type,\n\t\t\t\t\t\tp1: ApacheSupersetAnalytics.buildAppIdForAnalyticRequest(analyticInfo.appId),\n\t\t\t\t\t\tp2: dashboardId,\n\t\t\t\t\t\tstatus: 'success',\n\t\t\t\t\t\tc_element: analyticInfo.from,\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t})\n\t\t\t.catch((response) => {\n\t\t\t\tgrid.tableUnfade();\n\t\t\t\tif (response.errors && Type.isStringFilled(response.errors[0]?.message))\n\t\t\t\t{\n\t\t\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\t\t\tcontent: Text.encode(response.errors[0].message),\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tif (analyticInfo !== null)\n\t\t\t\t{\n\t\t\t\t\tApacheSupersetAnalytics.sendAnalytics('edit', 'report_copy', {\n\t\t\t\t\t\ttype: analyticInfo.type,\n\t\t\t\t\t\tp1: ApacheSupersetAnalytics.buildAppIdForAnalyticRequest(analyticInfo.appId),\n\t\t\t\t\t\tp2: dashboardId,\n\t\t\t\t\t\tstatus: 'error',\n\t\t\t\t\t\tc_element: analyticInfo.from,\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t}\n\n\texportDashboard(dashboardId: number, analyticInfo: DashboardAnalyticInfo = null): void\n\t{\n\t\tconst grid = this.getGrid();\n\t\tgrid.tableFade();\n\n\t\treturn this.#dashboardManager.exportDashboard(\n\t\t\tdashboardId,\n\t\t\t() => {\n\t\t\t\tgrid.tableUnfade();\n\t\t\t\tif (analyticInfo !== null)\n\t\t\t\t{\n\t\t\t\t\tApacheSupersetAnalytics.sendAnalytics('edit', 'report_export', {\n\t\t\t\t\t\ttype: analyticInfo.type,\n\t\t\t\t\t\tp1: ApacheSupersetAnalytics.buildAppIdForAnalyticRequest(analyticInfo.appId),\n\t\t\t\t\t\tp2: dashboardId,\n\t\t\t\t\t\tstatus: 'success',\n\t\t\t\t\t\tc_element: analyticInfo.from,\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t},\n\t\t\t() => {\n\t\t\t\tgrid.tableUnfade();\n\t\t\t\tif (analyticInfo !== null)\n\t\t\t\t{\n\t\t\t\t\tApacheSupersetAnalytics.sendAnalytics('edit', 'report_export', {\n\t\t\t\t\t\ttype: analyticInfo.type,\n\t\t\t\t\t\tp1: ApacheSupersetAnalytics.buildAppIdForAnalyticRequest(analyticInfo.appId),\n\t\t\t\t\t\tp2: dashboardId,\n\t\t\t\t\t\tstatus: 'error',\n\t\t\t\t\t\tc_element: analyticInfo.from,\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t},\n\t\t);\n\t}\n\n\tdeleteDashboard(dashboardId: number): void\n\t{\n\t\tMessageBox.confirm(\n\t\t\tLoc.getMessage('BICONNECTOR_SUPERSET_DASHBOARD_GRID_DELETE_POPUP_TITLE'),\n\t\t\t(messageBox, button) => {\n\t\t\t\tbutton.setWaiting();\n\t\t\t\tthis.#dashboardManager.deleteDashboard(dashboardId)\n\t\t\t\t\t.then(() => {\n\t\t\t\t\t\tthis.getGrid().reload();\n\t\t\t\t\t\tmessageBox.close();\n\t\t\t\t\t})\n\t\t\t\t\t.catch((response) => {\n\t\t\t\t\t\tmessageBox.close();\n\t\t\t\t\t\tif (response.errors && Type.isStringFilled(response.errors[0]?.message))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\t\t\t\t\tcontent: Text.encode(response.errors[0].message),\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t},\n\t\t\tLoc.getMessage('BICONNECTOR_SUPERSET_DASHBOARD_GRID_DELETE_POPUP_CAPTION_YES'),\n\t\t\t(messageBox) => messageBox.close(),\n\t\t\tLoc.getMessage('BICONNECTOR_SUPERSET_DASHBOARD_GRID_DELETE_POPUP_CAPTION_NO'),\n\t\t);\n\t}\n\n\tcreateEmptyDashboard()\n\t{\n\t\tBX.BIConnector.ApacheSupersetAnalytics.sendAnalytics('new', 'report_new', {\n\t\t\ttype: 'custom',\n\t\t\tc_element: 'new_button',\n\t\t});\n\n\t\tconst grid = this.getGrid();\n\t\tgrid.tableFade();\n\t\tthis.#dashboardManager.createEmptyDashboard()\n\t\t\t.then((response) => {\n\t\t\t\tgrid.tableUnfade();\n\t\t\t\tconst gridRealtime: BX.Grid.Realtime = grid.getRealtime();\n\t\t\t\tconst newDashboard = response.data.dashboard;\n\n\t\t\t\tgridRealtime.addRow({\n\t\t\t\t\tid: newDashboard.id,\n\t\t\t\t\tprepend: true,\n\t\t\t\t\tcolumns: newDashboard.columns,\n\t\t\t\t\tactions: newDashboard.actions,\n\t\t\t\t});\n\n\t\t\t\tgrid.tableUnfade();\n\t\t\t\tconst counterTotalTextContainer = grid.getCounterTotal().querySelector('.main-grid-panel-content-text');\n\t\t\t\tcounterTotalTextContainer.textContent++;\n\t\t\t})\n\t\t\t.catch((response) => {\n\t\t\t\tgrid.tableUnfade();\n\n\t\t\t\tif (response.errors)\n\t\t\t\t{\n\t\t\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\t\t\tcontent: Loc.getMessage('BICONNECTOR_SUPERSET_DASHBOARD_GRID_CREATE_EMPTY_NOTIFICATION_ERROR'),\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t}\n}\n\nReflection.namespace('BX.BIConnector').SupersetDashboardGridManager = SupersetDashboardGridManager;\n"],"names":["SupersetDashboardGridManager","props","DashboardManager","BX","Main","gridManager","getById","gridId","instance","dashboardList","dashboard","updateDashboardStatus","id","status","params","openedFrom","grid","getGrid","type","tableFade","processEditDashboard","dashboardId","editLink","editUrl","tableUnfade","popupType","ApacheSupersetAnalytics","sendAnalytics","c_sub_section","c_element","toLowerCase","p1","buildAppIdForAnalyticRequest","appId","p2","row","getRows","btn","node","querySelector","Type","isDomNode","isDisabled","getAttribute","setAttribute","Dom","addClass","restartDashboardImport","then","response","dashboardIds","data","restartedDashboardIds","restartedDashboardId","label","getElementsByClassName","removeClass","innerText","Loc","getMessage","labelWrapper","reloadBtn","DASHBOARD_STATUS_READY","remove","DASHBOARD_STATUS_LOAD","DASHBOARD_STATUS_FAILED","createdReloadBtn","createReloadBtn","append","Tag","render","analyticInfo","duplicateDashboard","gridRealtime","getRealtime","newDashboard","addRow","prepend","columns","actions","counterTotalTextContainer","getCounterTotal","textContent","UI","Hint","init","Notification","Center","notify","content","from","errors","isStringFilled","message","Text","encode","exportDashboard","MessageBox","confirm","messageBox","button","setWaiting","deleteDashboard","reload","close","BIConnector","createEmptyDashboard","EventEmitter","subscribe","onUserCredentialsLoaded","bind","event","getCompatData","sliderEvent","getEventId","eventArgs","getData","onUpdatedDashboardBatchStatus","Reflection","namespace"],"mappings":"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"}