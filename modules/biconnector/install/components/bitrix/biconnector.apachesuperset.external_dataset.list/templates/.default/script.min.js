(function(e,t,n,a){"use strict";function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){babelHelpers.defineProperty(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){o(e,t);t.add(e)}function s(e,t,n){o(e,t);t.set(e,n)}function o(e,t){if(t.has(e)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}function c(e,t,n){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return n}var u=new WeakMap;var d=new WeakMap;var E=new WeakSet;var f=new WeakSet;var h=new WeakSet;var v=function(){function e(t){var n;babelHelpers.classCallCheck(this,e);l(this,h);l(this,f);l(this,E);s(this,u,{writable:true,value:void 0});s(this,d,{writable:true,value:void 0});babelHelpers.classPrivateFieldSet(this,u,(n=BX.Main.gridManager.getById(t.gridId))===null||n===void 0?void 0:n.instance);babelHelpers.classPrivateFieldSet(this,d,BX.Main.filterManager.getById(t.gridId));c(this,f,g).call(this);c(this,E,I).call(this)}babelHelpers.createClass(e,[{key:"getGrid",value:function e(){return babelHelpers.classPrivateFieldGet(this,u)}},{key:"getFilter",value:function e(){return babelHelpers.classPrivateFieldGet(this,d)}},{key:"handleCreatedByClick",value:function e(t){this.handleDatasetFilterChange(r({fieldId:"CREATED_BY_ID"},t))}},{key:"handleUpdatedByClick",value:function e(t){this.handleDatasetFilterChange(r({fieldId:"UPDATED_BY_ID"},t))}},{key:"handleSourceClick",value:function e(t){this.handleDatasetFilterChange(r({fieldId:"SOURCE.ID"},t))}},{key:"handleDatasetFilterChange",value:function e(t){var n,a;var i=this.getFilter().getFilterFieldsValues();var r=(n=i[t.fieldId])!==null&&n!==void 0?n:[];var l=(a=i["".concat(t.fieldId,"_label")])!==null&&a!==void 0?a:[];if(t.IS_FILTERED){r=r.filter((function(e){return parseInt(e,10)!==t.ID}));l=l.filter((function(e){return e!==t.TITLE}))}else if(!r.includes(t.ID)){r.push(t.ID);l.push(t.TITLE)}var s=this.getFilter().getApi();var o={};o[t.fieldId]=r;o["".concat(t.fieldId,"_label")]=l;s.extendFilter(o);s.apply()}},{key:"deleteDataset",value:function e(t){var a=this;var i=new BX.UI.Dialogs.MessageBox({message:n.Loc.getMessage("BICONNECTOR_SUPERSET_EXTERNAL_DATASET_GRID_DELETE_POPUP_DESCRIPTION"),title:n.Loc.getMessage("BICONNECTOR_SUPERSET_EXTERNAL_DATASET_GRID_DELETE_POPUP_TITLE"),buttons:[new BX.UI.Button({color:BX.UI.Button.Color.DANGER,text:n.Loc.getMessage("BICONNECTOR_SUPERSET_EXTERNAL_DATASET_GRID_DELETE_POPUP_CAPTION_YES"),onclick:function e(n){n.setWaiting();a.deleteDatasetAjaxAction(t).then((function(){a.getGrid().reload();i.close()}))["catch"]((function(e){i.close();if(e.errors){c(a,h,p).call(a,e.errors)}}))}}),new BX.UI.CancelButton({text:n.Loc.getMessage("BICONNECTOR_SUPERSET_EXTERNAL_DATASET_GRID_DELETE_POPUP_CAPTION_NO"),onclick:function e(t){return i.close()}})]});i.show()}},{key:"deleteDatasetAjaxAction",value:function e(t){return n.ajax.runAction("biconnector.externalsource.dataset.delete",{data:{id:t}})}},{key:"showSupersetError",value:function e(){BX.UI.Notification.Center.notify({content:n.Text.encode(n.Loc.getMessage("BICONNECTOR_SUPERSET_EXTERNAL_DATASET_GRID_ERROR_SUPERSET"))})}}]);return e}();function I(){var e=BX.UI.Hint.createInstance({popupParameters:{autoHide:true}});e.init(babelHelpers.classPrivateFieldGet(this,u).getContainer())}function g(){var e=this;a.EventEmitter.subscribe("SidePanel.Slider:onMessage",(function(t){var n=t.getData(),a=babelHelpers.slicedToArray(n,1),i=a[0];if(i.getEventId()==="BIConnector.dataset-import:onDatasetCreated"){babelHelpers.classPrivateFieldGet(e,u).reload()}}));a.EventEmitter.subscribe("Grid::updated",(function(){c(e,E,I).call(e)}))}function p(e){if(e[0]&&e[0].message){BX.UI.Notification.Center.notify({content:n.Text.encode(e[0].message)})}}n.Reflection.namespace("BX.BIConnector").ExternalDatasetManager=v})(this.window=this.window||{},BX.UI.Dialogs,BX,BX.Event);
//# sourceMappingURL=script.map.js