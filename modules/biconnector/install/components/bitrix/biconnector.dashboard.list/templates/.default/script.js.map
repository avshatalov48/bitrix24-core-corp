{"version":3,"file":"script.js","sources":["src/grid.js"],"sourcesContent":["import {Loc, ajax} from 'main.core';\nimport {Guide} from 'ui.tour';\n\ntype DashboardGridOptions = {\n\tbindElement: HTMLElement,\n\tarticle: string,\n}\n\nexport class DashboardGrid\n{\n\tstatic gridId = 'biconnector_dashboard_list';\n\tstatic componentName = 'bitrix:biconnector.dashboard.list';\n\t#options;\n\t#spotLight;\n\t#guide;\n\n\tconstructor(options: DashboardGridOptions)\n\t{\n\t\tthis.#options = options;\n\t}\n\n\tstatic deleteRow(id: number): void\n\t{\n\t\tconst grid = BX.Main.gridManager.getInstanceById(DashboardGrid.gridId);\n\t\tgrid.confirmDialog({\n\t\t\tCONFIRM: true,\n\t\t\tCONFIRM_MESSAGE: Loc.getMessage('CC_BBDL_ACTION_MENU_DELETE_CONF'),\n\t\t}, () => {\n\t\t\tajax.runComponentAction(DashboardGrid.componentName, 'deleteRow', {\n\t\t\t\tmode: 'class',\n\t\t\t\tdata: {\n\t\t\t\t\tid: id,\n\t\t\t\t}\n\t\t\t}).then(() => {\n\t\t\t\tgrid.removeRow(id);\n\t\t\t});\n\t\t});\n\t}\n\n\tshowOnboarding(): void\n\t{\n\t\tthis.#getSpotlight().show();\n\t\tthis.#getGuide().start();\n\t\tthis.#getSpotlight().getTargetContainer().addEventListener('mouseover', () => {\n\t\t\tthis.#getSpotlight().close();\n\t\t});\n\t}\n\n\t#getSpotlight(): BX.SpotLight\n\t{\n\t\tif (this.#spotLight)\n\t\t{\n\t\t\treturn this.#spotLight;\n\t\t}\n\n\t\tthis.#spotLight = new BX.SpotLight({\n\t\t\ttargetElement: this.#options.bindElement,\n\t\t\ttargetVertex: 'middle-center',\n\t\t\tid: DashboardGrid.gridId,\n\t\t\tlightMode: true,\n\t\t});\n\n\t\treturn this.#spotLight;\n\t}\n\n\t#getGuide(): Guide\n\t{\n\t\tif (this.#guide)\n\t\t{\n\t\t\treturn this.#guide;\n\t\t}\n\n\t\tthis.#guide = new Guide({\n\t\t\tsimpleMode: true,\n\t\t\tonEvents: true,\n\t\t\toverlay: false,\n\t\t\tsteps: [\n\t\t\t\t{\n\t\t\t\t\ttarget: this.#options.bindElement,\n\t\t\t\t\ttitle: Loc.getMessage('CC_BBDL_ONBOARDING_TITLE'),\n\t\t\t\t\ttext: Loc.getMessage('CC_BBDL_ONBOARDING_DESCRIPTION'),\n\t\t\t\t\tbuttons: null,\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tonClose: () => {\n\t\t\t\t\t\t\tthis.#getSpotlight().close();\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonShow: () => {\n\t\t\t\t\t\t\tajax.runComponentAction(DashboardGrid.componentName, 'markShowOnboarding', {\n\t\t\t\t\t\t\t\tmode: 'class'\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\tarticle: this.#options.article,\n\t\t\t\t},\n\t\t\t],\n\t\t\tautoHide: true,\n\t\t});\n\t\tthis.#guide.getPopup().setWidth(320);\n\t\tthis.#guide.getPopup().setAngle({\n\t\t\toffset: this.#options.bindElement.offsetWidth / 2,\n\t\t});\n\t\tthis.#guide.getPopup().setAutoHide(true);\n\n\t\treturn this.#guide;\n\t}\n}"],"names":["DashboardGrid","options","show","start","getTargetContainer","addEventListener","close","id","grid","BX","Main","gridManager","getInstanceById","gridId","confirmDialog","CONFIRM","CONFIRM_MESSAGE","Loc","getMessage","ajax","runComponentAction","componentName","mode","data","then","removeRow","SpotLight","targetElement","bindElement","targetVertex","lightMode","Guide","simpleMode","onEvents","overlay","steps","target","title","text","buttons","events","onClose","onShow","article","autoHide","getPopup","setWidth","setAngle","offset","offsetWidth","setAutoHide"],"mappings":";;;;;;;;AAAA,CAC8B;CAAA;CAAA;CAAA;CAAA;AAO9B,KAAaA,aAAa;GAQzB,uBAAYC,OAA6B,EACzC;KAAA;KAAA;KAAA;KAAA;OAAA;OAAA;;KAAA;OAAA;OAAA;;KAAA;OAAA;OAAA;;KACC,sCAAI,YAAYA,OAAO;;GACvB;KAAA;KAAA,iCAqBD;OAAA;OACC,2BAAI,sCAAJ,IAAI,EAAiBC,IAAI,EAAE;OAC3B,2BAAI,8BAAJ,IAAI,EAAaC,KAAK,EAAE;OACxB,2BAAI,sCAAJ,IAAI,EAAiBC,kBAAkB,EAAE,CAACC,gBAAgB,CAAC,WAAW,EAAE,YAAM;SAC7E,4BAAI,sCAAJ,KAAI,EAAiBC,KAAK,EAAE;QAC5B,CAAC;;;KACF;KAAA,0BAzBgBC,EAAU,EAC3B;OACC,IAAMC,IAAI,GAAGC,EAAE,CAACC,IAAI,CAACC,WAAW,CAACC,eAAe,CAACZ,aAAa,CAACa,MAAM,CAAC;OACtEL,IAAI,CAACM,aAAa,CAAC;SAClBC,OAAO,EAAE,IAAI;SACbC,eAAe,EAAEC,aAAG,CAACC,UAAU,CAAC,iCAAiC;QACjE,EAAE,YAAM;SACRC,cAAI,CAACC,kBAAkB,CAACpB,aAAa,CAACqB,aAAa,EAAE,WAAW,EAAE;WACjEC,IAAI,EAAE,OAAO;WACbC,IAAI,EAAE;aACLhB,EAAE,EAAEA;;UAEL,CAAC,CAACiB,IAAI,CAAC,YAAM;WACbhB,IAAI,CAACiB,SAAS,CAAClB,EAAE,CAAC;UAClB,CAAC;QACF,CAAC;;;GACF;CAAA;CAoED,0BAxDA;GACC,sCAAI,IAAI,eACR;KACC,yCAAO,IAAI;;GAGZ,sCAAI,cAAc,IAAIE,EAAE,CAACiB,SAAS,CAAC;KAClCC,aAAa,EAAE,sCAAI,YAAUC,WAAW;KACxCC,YAAY,EAAE,eAAe;KAC7BtB,EAAE,EAAEP,aAAa,CAACa,MAAM;KACxBiB,SAAS,EAAE;IACX,CAAC;GAEF,yCAAO,IAAI;CACZ;CAAC,sBAGD;GAAA;GACC,sCAAI,IAAI,WACR;KACC,yCAAO,IAAI;;GAGZ,sCAAI,UAAU,IAAIC,aAAK,CAAC;KACvBC,UAAU,EAAE,IAAI;KAChBC,QAAQ,EAAE,IAAI;KACdC,OAAO,EAAE,KAAK;KACdC,KAAK,EAAE,CACN;OACCC,MAAM,EAAE,sCAAI,YAAUR,WAAW;OACjCS,KAAK,EAAEpB,aAAG,CAACC,UAAU,CAAC,0BAA0B,CAAC;OACjDoB,IAAI,EAAErB,aAAG,CAACC,UAAU,CAAC,gCAAgC,CAAC;OACtDqB,OAAO,EAAE,IAAI;OACbC,MAAM,EAAE;SACPC,OAAO,EAAE,mBAAM;WACd,6BAAI,sCAAJ,MAAI,EAAiBnC,KAAK,EAAE;UAC5B;SACDoC,MAAM,EAAE,kBAAM;WACbvB,cAAI,CAACC,kBAAkB,CAACpB,aAAa,CAACqB,aAAa,EAAE,oBAAoB,EAAE;aAC1EC,IAAI,EAAE;YACN,CAAC;;QAEH;OACDqB,OAAO,EAAE,sCAAI,YAAUA;MACvB,CACD;KACDC,QAAQ,EAAE;IACV,CAAC;GACF,sCAAI,UAAQC,QAAQ,EAAE,CAACC,QAAQ,CAAC,GAAG,CAAC;GACpC,sCAAI,UAAQD,QAAQ,EAAE,CAACE,QAAQ,CAAC;KAC/BC,MAAM,EAAE,sCAAI,YAAUpB,WAAW,CAACqB,WAAW,GAAG;IAChD,CAAC;GACF,sCAAI,UAAQJ,QAAQ,EAAE,CAACK,WAAW,CAAC,IAAI,CAAC;GAExC,yCAAO,IAAI;CACZ;CAAC,4BAhGWlD,aAAa,YAET,4BAA4B;CAAA,4BAFhCA,aAAa,mBAGF,mCAAmC;;;;;;;;"}