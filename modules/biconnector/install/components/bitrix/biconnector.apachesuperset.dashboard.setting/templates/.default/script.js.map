{"version":3,"file":"script.js","sources":["src/editor-controller/setting-controller.js","src/editor-controller/factory.js","src/setting.js"],"sourcesContent":["import { Type } from 'main.core';\nimport { ApacheSupersetAnalytics } from 'biconnector.apache-superset-analytics';\nimport { EventEmitter, BaseEvent } from 'main.core.events';\nimport type { AnalyticInfo } from './analytic-info';\n\nconst SidePanel = BX.SidePanel;\nexport class SettingController extends BX.UI.EntityEditorController\n{\n\tanalytic: AnalyticInfo;\n\tconstructor(id, settings)\n\t{\n\t\tsuper();\n\n\t\tthis.initialize(id, settings);\n\t\tthis.analytic = settings.config?.dashboardAnalyticInfo ?? {};\n\n\t\tEventEmitter.subscribeOnce('BX.UI.EntityEditor:onInit', (event: BaseEvent) => {\n\t\t\tconst [editor] = event.getData();\n\t\t\teditor?._toolPanel.disableSaveButton();\n\t\t});\n\n\t\tEventEmitter.subscribeOnce('BX.UI.EntityEditor:onControlChange', (event: BaseEvent) => {\n\t\t\tconst [editor] = event.getData();\n\t\t\teditor?._toolPanel.enableSaveButton();\n\t\t});\n\n\t\tEventEmitter.subscribeOnce('BX.UI.EntityEditor:onCancel', (event: BaseEvent) => {\n\t\t\tconst [, eventArguments] = event.getData();\n\t\t\teventArguments.enableCloseConfirmation = false;\n\t\t});\n\n\t\tEventEmitter.subscribeOnce('BX.UI.EntityEditor:onSave', (event: BaseEvent) => {\n\t\t\tconst [, eventArguments] = event.getData();\n\t\t\teventArguments.enableCloseConfirmation = false;\n\t\t});\n\t}\n\n\tonAfterSave()\n\t{\n\t\tlet analyticOptions;\n\t\tif (Type.isStringFilled(this.analytic.type))\n\t\t{\n\t\t\tanalyticOptions = {\n\t\t\t\ttype: this.analytic.type.toLowerCase(),\n\t\t\t\tp1: ApacheSupersetAnalytics.buildAppIdForAnalyticRequest(this.analytic.appId),\n\t\t\t\tp2: this.analytic.id,\n\t\t\t\tc_element: 'grid_menu',\n\t\t\t\tstatus: 'success',\n\t\t\t};\n\t\t}\n\t\telse\n\t\t{\n\t\t\tanalyticOptions = {\n\t\t\t\tc_element: 'grid_settings',\n\t\t\t\tstatus: 'success',\n\t\t\t};\n\t\t}\n\n\t\tApacheSupersetAnalytics.sendAnalytics('edit', 'report_settings', analyticOptions);\n\t\tthis?._editor?._modeSwitch.reset();\n\n\t\twindow.location.reload();\n\t}\n\n\tinnerCancel()\n\t{\n\t\tSidePanel.Instance.close();\n\t}\n}","import type { BaseEvent } from 'main.core.events';\nimport { EventEmitter } from 'main.core.events';\nimport { SettingController } from './setting-controller';\n\nexport class Factory\n{\n\tconstructor(eventName)\n\t{\n\t\tEventEmitter.subscribe(eventName + ':onInitialize', (event: BaseEvent) => {\n\t\t\tconst [, eventArgs] = event.getCompatData();\n\t\t\teventArgs.methods['dashboardSettings'] = this.factory.bind(this);\n\t\t});\n\t}\n\n\tfactory(type, controlId, settings)\n\t{\n\t\tif (type === 'settingComponentController')\n\t\t{\n\t\t\treturn new SettingController(controlId, settings);\n\t\t}\n\n\t\treturn null;\n\t}\n}","import { SettingsDateFilterFieldFactory } from 'biconnector.entity-editor.field.settings-date-filter';\nimport { Factory } from './editor-controller/factory';\n\nexport class Setting\n{\n\tstatic registerFieldFactory(entityEditorControlFactory)\n\t{\n\t\tnew SettingsDateFilterFieldFactory(entityEditorControlFactory);\n\t}\n\n\tstatic registerControllerFactory(entityEditorControllerFactory)\n\t{\n\t\tnew Factory(entityEditorControllerFactory);\n\t}\n}\n"],"names":["SidePanel","BX","SettingController","id","settings","initialize","analytic","config","dashboardAnalyticInfo","EventEmitter","subscribeOnce","event","getData","editor","_toolPanel","disableSaveButton","enableSaveButton","eventArguments","enableCloseConfirmation","analyticOptions","Type","isStringFilled","type","toLowerCase","p1","ApacheSupersetAnalytics","buildAppIdForAnalyticRequest","appId","p2","c_element","status","sendAnalytics","_editor","_modeSwitch","reset","window","location","reload","Instance","close","UI","EntityEditorController","Factory","eventName","subscribe","getCompatData","eventArgs","methods","factory","bind","controlId","Setting","entityEditorControlFactory","SettingsDateFilterFieldFactory","entityEditorControllerFactory"],"mappings":"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"}