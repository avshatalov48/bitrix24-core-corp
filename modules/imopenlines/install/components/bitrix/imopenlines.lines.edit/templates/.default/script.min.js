(function(e){if(!!e.BX.OpenLinesConfigEdit)return;var t=null;e.BX.OpenLinesConfigEdit={init:function(t){BX.imolTrialHandler.init();BX.OpenLinesConfigEdit.addEventForTooltip();BX.OpenLinesConfigEdit.bindEvents();BX.OpenLinesConfigEdit.onLoad();if(t.isSuccessSendForm===true){e.addEventListener("load",(function(){BX.OpenLinesConfigEdit.formSuccessSendForm();t.isSuccessSendForm=false}))}},loadKpiTimeMenus:function(e){if(e){if(e.kpiFirstAnswer){BX.ready((function(){new BX.ImolKpiTimeMenu({element:e.kpiFirstAnswer.element,bindElement:e.kpiFirstAnswer.bindElement,inputElement:e.kpiFirstAnswer.inputElement,items:e.kpiFirstAnswer.items,customInputId:"imol_kpi_first_answer_time_custom_input",fullBlockName:"imol_kpi_first_answer_full_block"})}))}if(e.kpiFurtherAnswer){BX.ready((function(){new BX.ImolKpiTimeMenu({element:e.kpiFurtherAnswer.element,bindElement:e.kpiFurtherAnswer.bindElement,inputElement:e.kpiFurtherAnswer.inputElement,items:e.kpiFurtherAnswer.items,customInputId:"imol_kpi_further_answer_time_custom_input",fullBlockName:"imol_kpi_further_answer_full_block"})}))}}},loadKpiEntitySelector:function(e){if(e){if(e.firstAnswer){var t=new a(e.firstAnswer);t.setInput()}if(e.furtherAnswer){var i=new a(e.furtherAnswer);i.setInput()}}},initQueue:function(e,n){if(t===null){t=new i(n)}t.setInput(BX(e.queueInputNode));t.setUserInput(BX(e.userInputNode));t.setDefaultUserInput(BX(e.defaultUserInputNode))},formSuccessSendForm:function(){BX.OpenLinesConfigEdit.sendUsersData();BX.OpenLinesConfigEdit.updateLinesList()},successSendForm:function(){BX.OpenLinesConfigEdit.sendUsersData();BX.OpenLinesConfigEdit.updateLinesList()},sendUsersData:function(){if(t!==null){BX.SidePanel.Instance.postMessage(e,"ImOpenlines:reloadUsersList",t.selector.getDialog().getSelectedItems())}},updateLinesList:function(){var t=BX("imol_config_id").value;BX.SidePanel.Instance.postMessage(e,"ImOpenlines:updateLinesSubmit",t)},addEventForTooltip:function(){BX.UI.Hint.init(BX("imopenlines-field-container"))},getUrlParam:function(t,i){if(t.charAt(0)==="/"){t=e.location.protocol+"//"+e.location.host+t}var n=new URL(t);var a=n.searchParams.get(i);return BX.util.htmlspecialchars(a)},getPageParam:function(e){return this.getUrlParam(e,"PAGE")},visualReload:function(e){var t=document.querySelectorAll("[data-imol-page]");for(var i=0;i<t.length;i++){if((t[i].dataset.imolPage===e||!t[i].classList.contains("invisible"))&&!(t[i].dataset.imolPage===e&&!t[i].classList.contains("invisible"))){BX.animationHandler.smoothShowHide(t[i]);if(t[i].dataset.imolPage===e){var n=BX(t[i]).querySelector("[data-imol-title]");var a=n.dataset.imolTitle.toString();if(BX("pagetitle")&&a!==""){BX("pagetitle").innerHTML=a}}}}},reloadHandler:function(e){e.preventDefault();var t=BX.proxy_context;var i=this.getPageParam(t.getAttribute("href").toString());this.changeHistoryPage(i);this.visualReload(i)},changeHistory:function(t){var i=BX("imol_config_edit_form").getAttribute("action");if(i.charAt(0)==="/"){i=e.location.protocol+"//"+e.location.host+i}var n=new URL(i);var a;for(var o in t){a=BX.util.htmlspecialchars(t[o]);n.searchParams.set(o,a)}var s=n.href;top.window.history.replaceState({},"",s);BX("imol_config_edit_form").setAttribute("action",s)},changeHistoryPage:function(e){var t={PAGE:e};BX("imol_config_current_page").value=e},changeRatingRequest:function(e){var t={"rating-request":e};this.changeHistory(t)},botmarketButtonAction:function(e){e.preventDefault();BX.SidePanel.Instance.open("/market/collection/openline_bot/",{allowChangeHistory:false});top.BX.addCustomEvent(top,"Rest:AppLayout:ApplicationInstall",(function(e,t){t.redirect=false;BX.OpenLinesConfigEdit.botAddHandler()}))},botButtonAction:function(e){e.preventDefault();BX.rest.Marketplace.open({PLACEMENT:"OPENLINE_BOT"});top.BX.addCustomEvent(top,"Rest:AppLayout:ApplicationInstall",(function(e,t){t.redirect=false;BX.OpenLinesConfigEdit.botAddHandler()}))},botAddHandler:function(){e.location.reload()},actionClose:function(){BX.OpenLinesConfigEdit.toggleSelectFormOrText(BX("imol_action_close"),BX("imol_action_close_form"),BX("imol_action_close_text"))},actionAutoClose:function(){BX.OpenLinesConfigEdit.toggleSelectFormOrText(BX("imol_action_auto_close"),BX("imol_action_auto_close_form"),BX("imol_action_auto_close_text"))},changeQueueTypeValue:function(e){if(e.options[e.selectedIndex].value=="all"){if(BX.message("IMOL_CONFIG_EDIT_LIMIT_QUEUE_ALL")=="Y"){BX.UI.InfoHelper.show(BX.message("IMOL_CONFIG_EDIT_LIMIT_INFO_HELPER_MESSAGE_TO_ALL"));e.selectedIndex=0}else{BX.animationHandler.fadeSlideToggleByClass(BX("imol_limitation_max_chat_block"),false);BX.animationHandler.fadeSlideToggleByClass(BX("imol_workers_time_block"),false)}}else{if(BX.hasClass(BX("imol_workers_time_block"),"invisible")){BX.animationHandler.fadeSlideToggleByClass(BX("imol_limitation_max_chat_block"),true);if(BX("imol_limitation_max_chat").checked==true){BX.animationHandler.fadeSlideToggleByClass(BX("imol_max_chat"),true)}BX.animationHandler.fadeSlideToggleByClass(BX("imol_workers_time_block"),true)}}},toggleKpiFirstBlock:function(){BX.animationHandler.fadeSlideToggleByClass(BX("imol_kpi_first_answer_inner_block"))},toggleKpiFurtherBlock:function(){BX.animationHandler.fadeSlideToggleByClass(BX("imol_kpi_further_answer_inner_block"))},toggleCrmBlock:function(){BX.animationHandler.fadeSlideToggleByClass(BX("imol_crm_block"))},toggleCrmSourceRule:function(){var e=BX("imol_crm_create");if(e.options[e.selectedIndex].value=="lead"){BX.animationHandler.fadeSlideToggleByClass(BX("imol_crm_source_rule"),true);BX.removeClass(BX("imol_crm_transfer_change_title"),"invisible");BX.addClass(BX("imol_crm_transfer_change_title_deal"),"invisible");BX.removeClass(BX("imol_crm_source_title"),"invisible");BX.addClass(BX("imol_crm_source_title_deal"),"invisible");BX.animationHandler.fadeSlideToggleByClass(BX("imol_crm_create_second_deal"),false)}else if(e.options[e.selectedIndex].value=="deal"){BX.animationHandler.fadeSlideToggleByClass(BX("imol_crm_source_rule"),true);BX.addClass(BX("imol_crm_transfer_change_title"),"invisible");BX.removeClass(BX("imol_crm_transfer_change_title_deal"),"invisible");BX.addClass(BX("imol_crm_source_title"),"invisible");BX.removeClass(BX("imol_crm_source_title_deal"),"invisible");BX.animationHandler.fadeSlideToggleByClass(BX("imol_crm_create_second_deal"),true)}else{BX.animationHandler.fadeSlideToggleByClass(BX("imol_crm_source_rule"),false);BX.removeClass(BX("imol_crm_source_title"),"invisible");BX.addClass(BX("imol_crm_source_title_deal"),"invisible");BX.animationHandler.fadeSlideToggleByClass(BX("imol_crm_create_second_deal"),false)}},toggleQueueSettingsBlock:function(e){e.preventDefault();BX.animationHandler.fadeSlideToggleByClass(BX("imol_queue_settings_block"))},toggleWelcomeMessageBlock:function(){if(BX("imol_welcome_message").checked){BX.removeClass(BX("imol_welcome_message_block"),"invisible")}else{BX.addClass(BX("imol_welcome_message_block"),"invisible")}},toggleAutomaticMessageBlock:function(){BX.animationHandler.fadeSlideToggleByClass(BX("imol_action_automatic_message"))},toggleVoteTimeLimitBlock:function(){BX.animationHandler.fadeSlideToggleByClass(BX("imol_action_vote_time_limit"))},toggleAgreementBlock:function(){BX.animationHandler.fadeSlideToggleByClass(BX("imol_agreement_message_block"))},toggleVoteBlock:function(){if(BX("imol_vote_message").getAttribute("data-limit")!="Y"){BX.animationHandler.fadeSlideToggleByClass(BX("imol_vote_message_block"));var e=BX(this).checked===true?"Y":"N";BX.OpenLinesConfigEdit.changeRatingRequest(e)}},toggleWorkTimeBlock:function(){if(BX("imol_worktime_checkbox").getAttribute("data-limit")!="Y"){if(BX("imol_worktime_checkbox").checked){BX("imol_worktime_block").classList.remove("invisible")}else{BX("imol_worktime_block").classList.add("invisible")}}if(BX("imol_check_available").checked||BX("imol_worktime_checkbox").checked){BX("imol_worktime_answer_block").classList.remove("invisible")}else{BX("imol_worktime_answer_block").classList.add("invisible")}},toggleBotBlock:function(){BX.animationHandler.fadeSlideToggleByClass(BX("imol_welcome_bot_block"))},toggleQueueUsersBlock:function(){BX.OpenLinesConfigEdit.toggleSelectOperatorData(BX("imol_operator_data"),BX("users_for_queue_data"),BX("default_user_data"))},toggleWorkersTimeBlock:function(e){BX.animationHandler.fadeSlideToggleByClass(BX("imol_workers_time_block"))},toggleNoAnswerRule:function(){BX.OpenLinesConfigEdit.toggleSelectFormText(BX("imol_no_answer_rule"),BX("imol_no_answer_rule_form_form"),BX("imol_no_answer_rule_text"))},toggleQueueMaxChat:function(){BX.animationHandler.fadeSlideToggleByClass(BX("imol_max_chat"))},toggleWorktimeDayoffRule:function(){BX.OpenLinesConfigEdit.toggleSelectFormText(BX("imol_worktime_dayoff_rule"),BX("imol_worktime_dayoff_rule_form"),BX("imol_worktime_dayoff_rule_text"))},toggleWelcomeFormBlock:function(){if(BX("imol_form_welcome").checked){BX("imol_form_welcome_block").classList.remove("invisible")}else{BX("imol_form_welcome_block").classList.add("invisible")}},toggleWelcomeFormDelayHint:function(){if(BX("imol_form_welcome_delay").value==="Y"){BX("imol_form_no_delay_description").classList.add("invisible");BX("imol_form_delay_description").classList.remove("invisible")}else{BX("imol_form_no_delay_description").classList.remove("invisible");BX("imol_form_delay_description").classList.add("invisible")}},deleteOpenLine:function(){var t=BX("imol_config_id").value;BX.ajax.runComponentAction("bitrix:imopenlines.lines.edit","deleteOpenLine",{mode:"ajax",data:{configId:t}}).then((function(t){BX.SidePanel.Instance.closeAll();e.top.BX.UI.Notification.Center.notify({content:BX.message("IMOL_CONFIG_EDIT_DELETE_NOTIFICATION_SUCCESS")});location.href=BX.SidePanel.Instance.pageUrl}),(function(e){BX("imol-alert-popup-text").innerHTML=BX.message("IMOL_CONFIG_EDIT_DELETE_FAIL")}))},addNewForm:function(e){e.preventDefault();BX.SidePanel.Instance.open("/crm/webform/edit/0/?ACTIVE=Y",{events:{onClose:function(e){}}})},showPopupDeleteConfirm:function(){var e=new BX.PopupWindow({closeByEsc:true,content:BX("imol_delete_openline_popup"),closeIcon:true,className:"imopenlines-control-alert-popup",buttons:[new BX.UI.Button({text:BX.message("IMOL_CONFIG_EDIT_DELETE_THIS_OPENLINE_BUTTON"),color:BX.UI.Button.Color.DANGER,onclick:function(e){e.setWaiting();BX.OpenLinesConfigEdit.deleteOpenLine()}}),new BX.UI.CancelButton({events:{click:function(e){e.getContext().close()}}})]});e.show()},toggleSelectFormText:function(e,t,i){if(!!e){if(e.options[e.selectedIndex].value=="form"){BX.animationHandler.fadeSlideToggleByClass(t,true);BX.animationHandler.fadeSlideToggleByClass(i,true)}else if(e.options[e.selectedIndex].value=="text"){BX.animationHandler.fadeSlideToggleByClass(t,false);BX.animationHandler.fadeSlideToggleByClass(i,true)}else{BX.animationHandler.fadeSlideToggleByClass(t,false);BX.animationHandler.fadeSlideToggleByClass(i,false)}}},toggleSelectFormOrText:function(e,t,i){if(!!e){if(e.options[e.selectedIndex].value=="form"){BX.animationHandler.fadeSlideToggleByClass(t,true);BX.animationHandler.fadeSlideToggleByClass(i,false)}else if(e.options[e.selectedIndex].value=="text"||e.options[e.selectedIndex].value=="quality"){BX.animationHandler.fadeSlideToggleByClass(t,false);BX.animationHandler.fadeSlideToggleByClass(i,true)}else{BX.animationHandler.fadeSlideToggleByClass(t,false);BX.animationHandler.fadeSlideToggleByClass(i,false)}}},toggleSelectOperatorData:function(e,t,i){if(e.options[e.selectedIndex].value=="queue"){BX.animationHandler.fadeSlideToggleByClass(t,true);BX.animationHandler.fadeSlideToggleByClass(i,false)}else if(e.options[e.selectedIndex].value=="hide"){BX.animationHandler.fadeSlideToggleByClass(i,true);BX.animationHandler.fadeSlideToggleByClass(t,false)}else{BX.animationHandler.fadeSlideToggleByClass(i,false);BX.animationHandler.fadeSlideToggleByClass(t,false)}},toggleExtraContainer:function(){BX.toggleClass(BX("imol_extra_btn"),["imopenlines-extra-btn-container-active",""]);BX.toggleClass(BX("imol_extra_container"),["ui-form-border-bottom",""]);BX.animationHandler.fadeSlideToggleByClass(BX("imol_setting_container"));var e=BX.hasClass(BX("imol_extra_btn"),"imopenlines-extra-btn-container-active")?"Y":"N";BX("imol_config_opened").setAttribute("value",e)},toggleBoolInputValue:function(e){e.value=e.value==="Y"?"N":"Y"},openQuickAnswers:function(t){var i=t.dataset.url;i.toString();if(i!=""){e.open(i,"_blank")}},bindEvents:function(){BX.bind(BX("imol_crm_create"),"change",BX.OpenLinesConfigEdit.toggleCrmSourceRule);BX.bind(BX("imol_extra_btn"),"click",BX.OpenLinesConfigEdit.toggleExtraContainer);BX.bind(BX("imol_no_answer_rule"),"change",BX.OpenLinesConfigEdit.toggleNoAnswerRule);BX.bind(BX("imol_worktime_dayoff_rule"),"change",BX.OpenLinesConfigEdit.toggleWorktimeDayoffRule);BX.bind(BX("imol_queue_settings_link"),"click",BX.OpenLinesConfigEdit.toggleQueueSettingsBlock);BX.bind(BX("imol_workers_time_link"),"click",BX.OpenLinesConfigEdit.toggleWorkersTimeBlock);BX.bind(BX("imol_agreement_message"),"change",BX.OpenLinesConfigEdit.toggleAgreementBlock);BX.bind(BX("imol_vote_message"),"change",BX.OpenLinesConfigEdit.toggleVoteBlock);BX.bind(BX("imol_worktime_checkbox"),"change",BX.OpenLinesConfigEdit.toggleWorkTimeBlock);BX.bind(BX("imol_crm_checkbox"),"change",BX.OpenLinesConfigEdit.toggleCrmBlock);BX.bind(BX("imol_operator_data"),"change",BX.OpenLinesConfigEdit.toggleQueueUsersBlock);BX.bind(BX("imol_welcome_message"),"change",BX.OpenLinesConfigEdit.toggleWelcomeMessageBlock);BX.bind(BX("imol_automatic_message"),"change",BX.OpenLinesConfigEdit.toggleAutomaticMessageBlock);BX.bind(BX("imol_vote_time_limit"),"change",BX.OpenLinesConfigEdit.toggleVoteTimeLimitBlock);BX.bind(BX("imol_check_available"),"change",BX.OpenLinesConfigEdit.toggleWorkTimeBlock);BX.bind(BX("imol_action_close"),"change",BX.OpenLinesConfigEdit.actionClose);BX.bind(BX("imol_action_auto_close"),"change",BX.OpenLinesConfigEdit.actionAutoClose);BX.bind(BX("imol_kpi_first_answer_alert"),"change",BX.OpenLinesConfigEdit.toggleKpiFirstBlock);BX.bind(BX("imol_kpi_further_answer_alert"),"change",BX.OpenLinesConfigEdit.toggleKpiFurtherBlock);BX.bind(BX("imol_queue_type"),"change",(function(e){BX.OpenLinesConfigEdit.changeQueueTypeValue(this)}));BX.bind(BX("imol_limitation_max_chat"),"change",BX.OpenLinesConfigEdit.toggleQueueMaxChat);BX.bind(BX("imol_active_checkbox"),"change",(function(e){var t=BX("imol_config_id").value;if(this.checked){BX.ajax.runComponentAction("bitrix:imopenlines.lines.edit","checkCanActiveLine",{mode:"ajax",data:{configId:t}}).then(BX.proxy((function(e){if(e.data===false){this.checked=false;alert(BX.message("IMOL_CONFIG_EDIT_POPUP_LIMITED_ACTIVE"))}}),this)).then(BX.proxy((function(e){this.checked=false}),this))}}));BX.bind(BX("imol_quick_answer_manage"),"click",(function(e){e.preventDefault();BX.OpenLinesConfigEdit.openQuickAnswers(this)}));BX.bind(BX("imol_quick_answer_manage_not_can_use"),"click",(function(e){e.preventDefault();BX.imolTrialHandler.openPopup(BX.message("IMOL_CONFIG_EDIT_LIMIT_INFO_HELPER_QUICK_ANSWERS"))}));BX.bind(BX("imol_delete_openline"),"click",BX.proxy(this.showPopupDeleteConfirm,this));BX.bind(BX("imol_form_welcome_new_form"),"click",BX.proxy(this.addNewForm,this));BX.bind(BX("imol_form_welcome"),"change",BX.OpenLinesConfigEdit.toggleWelcomeFormBlock);BX.bind(BX("imol_form_welcome_delay"),"change",BX.OpenLinesConfigEdit.toggleWelcomeFormDelayHint);BX.bindDelegate(document.body,"click",{className:"ui-sidepanel-menu-link"},BX.proxy(this.reloadHandler,this))},onLoad:function(){BX.OpenLinesConfigEdit.toggleNoAnswerRule();BX.OpenLinesConfigEdit.actionClose();BX.OpenLinesConfigEdit.actionAutoClose();BX.OpenLinesConfigEdit.toggleWorktimeDayoffRule()}};e.BX.imolTrialHandler={openPopup:function(e){if(typeof BX!="undefined"&&typeof BX.UI!="undefined"&&typeof BX.UI.InfoHelper!="undefined"&&e){BX.UI.InfoHelper.show(e)}else{alert(BX.message("IMOL_CONFIG_EDIT_POPUP_LIMITED_TITLE_DEFAULT"))}},openPopupQueueAll:function(){BX.imolTrialHandler.openPopup(BX.message("IMOL_CONFIG_EDIT_LIMIT_INFO_HELPER_MESSAGE_TO_ALL"))},openPopupQueueVote:function(){BX.imolTrialHandler.openPopup(BX.message("IMOL_CONFIG_EDIT_LIMIT_INFO_HELPER_CUSTOMER_RATE"))},openPopupWorkTime:function(){BX.imolTrialHandler.openPopup(BX.message("IMOL_CONFIG_EDIT_LIMIT_INFO_HELPER_WORKHOUR_SETTING"))},init:function(){BX.bind(BX("imol_queue_all"),"click",BX.imolTrialHandler.openPopupQueueAll)}};e.BX.animationHandler={animations:[],animate:function(e){e=e||{};var t=e.node||null;var i=new BX.Promise;e.transition=e.transition||BX.easing.transitions.linear;if(!BX.type.isElementNode(t)){i.reject();return i}var n=e.duration||300;var a=null;for(var o in BX.animationHandler.animations){if(BX.animationHandler.animations[o].node==t){a=BX.animationHandler.animations[o];break}}if(a===null){var s=new BX.easing({duration:n,start:e.start,finish:e.finish,transition:e.transition,step:e.step,complete:function(){for(var n in BX.animationHandler.animations){if(BX.animationHandler.animations[n].node==t){BX.animationHandler.animations[n].easing=null;BX.animationHandler.animations[n].node=null;BX.animationHandler.animations.splice(n,1);break}}t=null;a=null;e.complete.call(this);if(i){i.fulfill()}}});a={node:t,easing:s};a.easing.animate();BX.animationHandler.animations.push(a)}else{a.easing.stop(true);e.duplicate.call(this);if(i){i.reject()}}return i},animateShowHide:function(e){e=e||{};var t=e.node||null;e.transition=e.transition||BX.easing.transitions.linear;if(!BX.type.isElementNode(t)){var i=new BX.Promise;i.reject();return i}var n=BX.hasClass(t,"invisible");var a=typeof e.way=="undefined"||e.way===null?n:!!e.way;if(n!=a){var i=new BX.Promise;i.resolve();return i}var o=e.toShow||{};var s=e.toHide||{};return BX.animationHandler.animate({node:t,duration:e.duration,start:!a?o:s,finish:a?o:s,transition:e.transition,complete:function(){BX[!a?"addClass":"removeClass"](t,"invisible");t.style.cssText="";if(BX.type.isFunction(e.complete)){e.complete.call(this)}},duplicate:function(){BX[a?"addClass":"removeClass"](t,"invisible");t.style.cssText="";if(BX.type.isFunction(e.duplicate)){e.duplicate.call(this)}},step:function(e){if(typeof e.opacity!="undefined"){t.style.opacity=e.opacity/100}if(typeof e.height!="undefined"){t.style.height=e.height+"px"}if(typeof e.width!="undefined"){t.style.width=e.width+"px"}}})},fadeSlideToggleByClass:function(e,t,i,n){return BX.animationHandler.animateShowHide({node:e,duration:i,toShow:{opacity:100,height:BX.animationHandler.getInvisibleSize(e).height},toHide:{opacity:0,height:0},complete:n,way:t})},getInvisibleSize:function(e){var t=BX.hasClass(e,"invisible");if(t){BX.removeClass(e,"invisible")}var i=BX.pos(e);if(t){BX.addClass(e,"invisible")}return i},smoothScroll:function(e){var t=BX.GetWindowScrollPos().scrollTop,i=BX.pos(e).top-Math.round(BX.GetWindowInnerSize().innerHeight/2),n=t<i,a=Math.abs(i-t),o=Math.round(a/100)>20?20:Math.round(a/100),s=4*o,r=n?t+s:t-s,l=0;if(n){for(var u=t;u<i;u+=s){setTimeout("window.scrollTo(0,"+r+")",l*o);r+=s;if(r>i){r=i}l++}}else{for(var u=t;u>i;u-=s){setTimeout("window.scrollTo(0,"+r+")",l*o);r-=s;if(r<i){r=i}l++}}},smoothShowHide:function(e){if(!e.classList.contains("imopenlines-page-show")){setTimeout((function(){BX.removeClass(e,"invisible")}),100);BX.animationHandler.smoothShow(e)}else{BX.animationHandler.smoothHide(e);BX.addClass(e,"invisible")}},smoothShow:function(e){BX.removeClass(e,"imopenlines-page-hide");BX.addClass(e,"imopenlines-page-show")},smoothHide:function(e){BX.removeClass(e,"imopenlines-page-show");BX.addClass(e,"imopenlines-page-hide")}};var i=function(e){if(!e.queue){e.queue={}}this.id=e.queue["lineId"];this.nodes={};this.defaultOperator=e.defaultOperator||{};this.nodesType={destInput:"",userInput:"",userInputBox:"",userInputContainer:"",userInputButton:"",defaultUserInput:""};this.popupDepartment=false;this.params={queueItems:e.queue.queueItems,readOnly:e.queue.readOnly,queueInputName:e.queue.queueInputName,queueUserInputName:e.queue.queueUserInputName,blockIdQueueInput:e.queue.blockIdQueueInput,queueUsers:e.queue.queueUsers,popupDepartment:e.queue.popupDepartment,queueUsersFields:!!e.queue["queueUsersFields"]?BX.clone(e.queue["queueUsersFields"]):{}}};i.prototype={setInput:function(e){e=BX(e);if(!!e&&!e.hasAttribute("bx-destination-id")){var t=false;if(this.params.readOnly){t=true}this.selector=new BX.UI.EntitySelector.TagSelector({id:e.id,readonly:t,dialogOptions:{id:e.id,context:"IMOL_QUEUE_USERS",selectedItems:this.params.queueItems,events:{"Item:onSelect":BX.proxy((function(e){this.addItemQueue(e)}),this),"Item:onDeselect":BX.proxy((function(e){this.deleteItemQueue(e)}),this),onShow:BX.proxy((function(e){this.nodes[this.nodesType.userInputButton].style.visibility="hidden";e.target.tagSelector.hideAddButton()}),this),onHide:BX.proxy((function(e){this.nodes[this.nodesType.userInputButton].style.visibility="visible";e.target.tagSelector.showAddButton()}),this)},entities:[{id:"user",options:{inviteEmployeeLink:false,intranetUsersOnly:true}},{id:"department",options:{inviteEmployeeLink:false,selectMode:"usersAndDepartments"}}]}});this.selector.renderTo(document.getElementById(e.id));this.reloadInputConfigQueue(this.selector.getDialog());BX.addCustomEvent("ItemUser:onDeselect",BX.delegate((function(e){this.selector.getDialog().getItem({id:e,entityId:"user"}).deselect()}),this));this.nodes[e.id]=e;this.nodesType.destInput=e.id}},setUserInput:function(e){e=BX(e);if(!!e&&!e.hasAttribute("bx-destination-id")){var t="data-destination"+(""+(new Date).getTime()).substr(6),i;e.setAttribute("bx-destination-id",t);this.nodesType.userInput=t;this.nodesType.userInputBox=t+"-input-box";this.nodesType.userInputContainer=t+"-container";this.nodesType.userInputButton=t+"-add-button";e.appendChild(BX.create("SPAN",{props:{id:this.nodesType.userInputContainer}}));e.appendChild(BX.create("SPAN",{props:{className:"bx-destination-input-box",id:this.nodesType.userInputBox},html:['<input type="text" value="" class="bx-destination-input" id="'+t+'-input">']}));if(!this.params.readOnly){e.appendChild(BX.create("span",{props:{className:"ui-tag-selector-item ui-tag-selector-add-button"},children:[BX.create("a",{props:{href:"#"+this.params.blockIdQueueInput,className:"ui-tag-selector-add-button-caption",id:this.nodesType.userInputButton},html:[BX.message("LM_ADD")]})]}))}this.nodes[this.nodesType.userInput]=e;this.nodes[this.nodesType.userInputBox]=BX(this.nodesType.userInputBox);this.nodes[this.nodesType.userInputContainer]=BX(this.nodesType.userInputContainer);this.nodes[this.nodesType.userInputButton]=BX(this.nodesType.userInputButton);if(typeof this.selector!=="undefined"){BX.bind(this.nodes[this.nodesType.userInputButton],"click",BX.proxy((function(e){this.selector.dialog.show()}),this))}if(!this.params.readOnly){BX.addCustomEvent(e,"selectUserInput",BX.proxy(this.selectUserInput,this))}var n;this.params.queueUsers.forEach(BX.proxy((function(e){var t=!!this.params.queueUsersFields[e.entityId]?this.params.queueUsersFields[e.entityId]:{};n=this.selectUserInputNodes(e,t,n)}),this))}},selectUserInput:function(e,t){if(!BX.findChild(this.nodes[this.nodesType.userInputContainer],{attr:{"data-id":e.entityId}},false,false)){var i=BX.findChildren(t,{className:"imopenlines-form-settings-user-input"},true);if(i!==null){var n;for(var a=0;a<i.length;a++){n=this.params.queueUserInputName+""+"["+e.entityId+"]["+i[a].name+"]";i[a].setAttribute("name",n)}}var o=BX.findChild(t,{attr:{id:"button-avatar-user-"+e.entityId}},true);var s=BX.findChild(t,{attr:{id:"input-avatar-user-"+e.entityId}},true);var r=BX.findChild(t,{attr:{id:"input-avatar-file-id-user-"+e.entityId}},true);if(!!o&&!!s){var l=function(){this.currentAvatarNode=o;this.currentAvatarInputNode=s;this.currentAvatarFileIdInputNode=r;this.showAvatarPopup()};BX.bind(o,"click",BX.delegate(l,this))}this.nodes[this.nodesType.userInputContainer].appendChild(t)}},setDefaultUserInput:function(e){e=BX(e);if(!!e){var t=this.createDefaultUserInputNode(this.defaultOperator);var i=BX.findChild(t,{attr:{id:"button-avatar-user-default-user"}},true);var n=BX.findChild(t,{attr:{id:"input-avatar-user-default-user"}},true);var a=BX.findChild(t,{attr:{id:"input-avatar-file-id-user-default-user"}},true);if(!!i&&!!n){var o=function(){this.currentAvatarNode=i;this.currentAvatarInputNode=n;this.currentAvatarFileIdInputNode=a;this.showAvatarPopup()};BX.bind(i,"click",BX.delegate(o,this))}e.appendChild(t)}},addItemQueue:function(e){this.showPopupDepartment(e.getData().item);this.reloadInputConfigQueue(e.getData().item.getDialog());this.reloadUserInputQueue(e.getData().item.getDialog())},deleteItemQueue:function(e){this.reloadInputConfigQueue(e.getData().item.getDialog());this.reloadUserInputQueue(e.getData().item.getDialog())},reloadInputConfigQueue:function(e){var t=e.getSelectedItems();BX.cleanNode(BX(this.params.blockIdQueueInput));t.forEach(BX.delegate((function(e,t){BX(this.params.blockIdQueueInput).appendChild(BX.create("input",{props:{name:this.params.queueInputName+"["+t+"][id]",value:e.id},attrs:{type:"hidden"}}));BX(this.params.blockIdQueueInput).appendChild(BX.create("input",{props:{name:this.params.queueInputName+"["+t+"][type]",value:e.entityId},attrs:{type:"hidden"}}))}),this))},reloadUserInputQueue:function(e){var t=e.getSelectedItems();var i=[];t.forEach((function(e){i.push({type:e.entityId,id:e.id})}));if(i.length>0){this.sendActionRequest("getUsersQueue",{queue:i},BX.proxy(this.setResultRequestQueueUsers,this))}else{this.setResultRequestQueueUsers({data:i})}},showPopupDepartment:function(e){var t={id:e.getId(),entityId:e.getEntityId()};if(this.params.popupDepartment.valueDisables!==true&&e.getEntityId()==="department"&&!!this.selector){if(!!this.popupDepartment){this.popupDepartment.close();this.popupDepartment.destroy()}var i=this.selector.getTag(t).getContainer();if(i){var n=[BX.create("DIV",{html:BX.message("LM_HEAD_DEPARTMENT_EXCLUDED_QUEUE"),style:{margin:"10px 20px 10px 5px"}}),BX.create("DIV",{style:{margin:"10px 20px 10px 5px"},children:[BX.create("A",{props:{href:"javascript:void(0)"},text:this.params.popupDepartment.titleOption,events:{click:BX.proxy((function(){this.setDisablesPopupDepartment()}),this)}})]})];this.popupDepartment=BX.PopupWindowManager.create("popup-department",i,{content:BX.create("DIV",{attrs:{className:"imopenlines-hint-popup-contents"},children:n}),zIndex:100,closeIcon:{opacity:1},closeByEsc:true,darkMode:false,autoHide:true,angle:true,offsetLeft:20,offsetTop:10,events:{onPopupClose:BX.proxy((function(){this.popupDepartment.destroy()}),this)}});this.popupDepartment.show()}}},setDisablesPopupDepartment:function(){if(!!this.popupDepartment){BX.userOptions.save(this.params.popupDepartment.nameOption.category,this.params.popupDepartment.nameOption.name,this.params.popupDepartment.nameOption.nameValue,"N",false);this.params.popupDepartment.valueDisables=true;this.popupDepartment.close();this.popupDepartment.destroy()}},setResultRequestQueueUsers:function(e){this.params.queueUsers=e.data;var t;var i=BX.findChild(this.nodes[this.nodesType.userInputContainer],{},false,true);var n={};if(i){i.forEach(BX.proxy((function(e){n[e.getAttribute("data-id")]=e}),this))}this.params.queueUsers.forEach(BX.proxy((function(e){delete n[e.entityId];var i=!!this.params.queueUsersFields[e.entityId]?this.params.queueUsersFields[e.entityId]:{};t=this.selectUserInputNodes(e,i,t)}),this));if(n){for(var a in n){delete this.params.queueUsersFields[a];BX.Dom.remove(n[a])}}},showAvatarPopup:function(){if(!this.avatarPopup){var e=BX("imol_user_data_avatar_upload");this.avatarEditor=new n({caller:this,context:e});BX.addCustomEvent(this.avatarEditor,"onClose",BX.delegate(this.showAvatarPopup,this));BX.addCustomEvent(this.avatarEditor,"onSelect",BX.delegate(this.onSelectAvatar,this));this.avatarPopup=BX.PopupWindowManager.create("imol_user_edit_avatar",null,{autoHide:true,lightShadow:true,overlay:true,closeIcon:true,closeByEsc:true,angle:true,content:e})}this.avatarEditor.markCurrentAvatar(this.currentAvatarInputNode.value);this.avatarPopup.setBindElement(this.currentAvatarNode);this.avatarPopup.show()},onSelectAvatar:function(e,t){if(e){this.currentAvatarNode.style["background-image"]="url('"+encodeURI(e)+"')";this.currentAvatarInputNode.value=e;this.currentAvatarFileIdInputNode.value=t}this.avatarPopup.close()},createUserInputNode:function(e,t){e.entityId=BX.util.htmlspecialchars(e.entityId);e.department=BX.util.htmlspecialchars(e.department);e.name=BX.util.htmlspecialchars(e.name);e.avatar=BX.util.htmlspecialchars(e.avatar);t.USER_AVATAR=BX.util.htmlspecialchars(t.USER_AVATAR);t.USER_NAME=BX.util.htmlspecialchars(t.USER_NAME);t.USER_WORK_POSITION=BX.util.htmlspecialchars(t.USER_WORK_POSITION);t.USER_AVATAR_ID=BX.util.htmlspecialchars(t.USER_AVATAR_ID);var i=!!t.USER_NAME?t.USER_NAME:e.name,n=!!t.USER_WORK_POSITION?t.USER_WORK_POSITION:"",a=!!t.USER_AVATAR?t.USER_AVATAR:"",o=!!t.USER_AVATAR?t.USER_AVATAR:e.avatar,s=!!t.USER_AVATAR_ID?t.USER_AVATAR_ID:null;if(!!e.avatar){e.avatar=' style="background-image: url('+encodeURI(e.avatar)+')"'}if(!!o){o=' style="background-image: url('+encodeURI(o)+')"'}var r=BX("user_data_input_template").innerHTML;var l=r.replace(new RegExp("%data_id%","g"),e.entityId).replace(new RegExp("%data_department%","g"),e.department).replace(new RegExp("%user_name_default%","g"),e.name).replace(new RegExp("%user_avatar_default%","g"),e.avatar).replace(new RegExp("%user_name%","g"),i).replace(new RegExp("%user_work_position%","g"),n).replace(new RegExp("%user_avatar%","g"),a).replace(new RegExp("%user_avatar_show%","g"),o).replace(new RegExp("%user_avatar_file_id%","g"),s).replace(new RegExp("%user_data_input_container_class%","g"),"imopenlines-form-settings-user").replace(new RegExp("background-image: url\\(\\)","g"),"");var u=BX.create("DIV");u.innerHTML=l;u=u.children[0];if((!e.department||e.department==0)&&!this.params.readOnly){u.appendChild(this.createBottomDeleteUser(e.entityId))}return u},modificationUserInputNode:function(e,t){e.entityId=BX.util.htmlspecialchars(e.entityId);e.department=BX.util.htmlspecialchars(e.department);t.setAttribute("data-department",e.department);var i=BX.findChildByClassName(t,"imopenlines-form-settings-user-delete");if((!e.department||e.department==0)&&!this.params.readOnly){if(!i){t.appendChild(this.createBottomDeleteUser(e.entityId))}}else{if(i){BX.Dom.remove(i)}}return t},createBottomDeleteUser:function(e){var t=BX.create("span",{props:{className:"imopenlines-form-settings-user-delete"},events:{click:BX.delegate((function(t){BX.onCustomEvent("ItemUser:onDeselect",[e])}),this),mouseover:function(){BX.addClass(this.parentNode,"bx-destination-hover")},mouseout:function(){BX.removeClass(this.parentNode,"bx-destination-hover")}}});return t},createDefaultUserInputNode:function(e){e.AVATAR=BX.util.htmlspecialchars(e.AVATAR);var t=!!e.NAME?BX.util.htmlspecialchars(e.NAME):"",i=!!e.AVATAR?e.AVATAR:"",n=!!e.AVATAR?' style="background-image: url('+encodeURI(e.AVATAR)+")":"",a=!!e.AVATAR_ID?BX.util.htmlspecialchars(e.AVATAR_ID):null;var o=BX("default_user_data_input_template").innerHTML;var s=o.replace(new RegExp("%user_name%","g"),t).replace(new RegExp("%user_avatar%","g"),i).replace(new RegExp("%user_avatar_show%","g"),n).replace(new RegExp("%user_avatar_file_id%","g"),a).replace(new RegExp("background-image: url\\(\\)","g"),"");var r=BX.create("DIV");r.innerHTML=s;r=r.children[0];return r},selectUserInputNodes:function(e,t,i){var n=BX.findChild(this.nodes[this.nodesType.userInputContainer],{attr:{"data-id":e.entityId}},false,false);if(!n){var a=this.createUserInputNode(e,t);BX.onCustomEvent(this.nodes[this.nodesType.userInput],"selectUserInput",[e,a])}else{var a=this.modificationUserInputNode(e,n)}if(!i){BX.prepend(a,BX(this.nodes[this.nodesType.userInputContainer]))}else{BX.insertAfter(a,i)}return a},sendActionRequest:function(e,t,i,n){i=i||null;n=n||null;t=t||{};if(t instanceof FormData){t.append("action",e);t.append("configId",this.id)}else{t.action=e;t.configId=this.id}BX.ajax.runComponentAction("bitrix:imopenlines.lines.edit",e,{mode:"ajax",data:t}).then(BX.proxy((function(e){e=e||{};if(e.error){n.apply(this,[e])}else if(i){i.apply(this,[e])}}),this)).then(BX.proxy((function(e){var t={error:true,text:e.error};n.apply(this,[t])}),this))}};var n=function(e){this.caller=e.caller;this.context=e.context;this.init()};n.prototype={init:function(){this.editButtonNode=this.context.querySelector("[data-imopenlines-user-photo-edit]");BX.bind(this.editButtonNode,"click",BX.delegate(this.show,this));this.avatarContainer=this.context.querySelector("[data-imopenlines-user-photo-edit-avatars]");this.attributeCarouselNext="dataimopenlines-user-photo-edit-avatar-next";this.attributeCarouselPrev="data-imopenlines-user-photo-edit-avatar-prev";this.attributeAvatar="data-imopenlines-user-photo-edit-avatar-item";this.attributeAvatarRemove="data-remove";this.attributeFileId="data-file-id";this.attributePath="data-path";this.attributeView="data-view";this.getAllAvatarNodes().forEach(this.initAvatar,this)},createAvatarNode:function(e,t){var i=BX("user_data_avatar_template");i=i.innerHTML;e=BX.util.htmlspecialchars(e);t=BX.util.htmlspecialchars(t);i=i.replace("%file_id%",e).replace("%path%",t).replace("%url_path%",encodeURI(t));var n=BX.create("DIV");n.innerHTML=i;n=n.children[0];return n},initAvatar:function(e){var t=e.querySelector("["+this.attributeView+"]");t=t||e;BX.bind(t,"click",BX.delegate((function(){this.selectAvatar(e)}),this));var i=e.getAttribute(this.attributeFileId);if(i){var n=e.querySelector("["+this.attributeAvatarRemove+"]");BX.bind(n,"click",BX.delegate((function(){this.removeFile(i,e)}),this))}},selectAvatar:function(e){var t=e.getAttribute(this.attributePath);var i=e.getAttribute(this.attributeFileId);BX.onCustomEvent(this,"onSelect",[t,i])},initCarousel:function(){if(!this.carouselNextNode){this.carouselNextNode=this.context.querySelector("["+this.attributeCarouselNext+"]");this.carouselPrevNode=this.context.querySelector("["+this.attributeCarouselPrev+"]");BX.bind(this.carouselNextNode,"click",BX.delegate((function(){this.turnCarousel("next")}),this));BX.bind(this.carouselPrevNode,"click",BX.delegate((function(){this.turnCarousel("prev")}),this))}var e=this.getUserAvatarNodes();var t=Math.round(100/e.length);e.forEach((function(e){e.style.width=t+"%"}),this);this.avatarContainer.style.width="calc(66px * "+e.length+")";this.turnCarousel("start")},turnCarousel:function(e){var t=this.getUserAvatarNodes();var i;var n=66;var a=-n*(t.length-3);var o=this.avatarContainer.style.left.toString();o=parseInt(o.replace("px",""));if(isNaN(o))o=0;switch(e){case"prev":i=o+n;break;case"start":i=0;break;case"end":i=1e5;break;case"next":default:i=o-n;break}if(i>=0){i=0}else if(i<a){i=a}this.carouselPrevNode.style.display=i==0||t.length<=3?"none":"";this.carouselNextNode.style.display=i==a||t.length<=3?"none":"";this.avatarContainer.style.left=i+(i==0?"":"px")},markCurrentAvatar:function(e){var t="selected";this.getAllAvatarNodes().forEach((function(i){var n=i.getAttribute(this.attributePath);if(n==e){BX.addClass(i,t)}else{BX.removeClass(i,t)}}),this);this.getUserAvatarNodes().forEach((function(e,i){if(i>2&&BX.hasClass(e,t)){this.avatarContainer.insertBefore(e,this.avatarContainer.children[0])}}),this)},getUserAvatarNodeByFileId:function(e){return this.avatarContainer.querySelector("["+this.attributeFileId+'="'+e+'"]')},getUserAvatarNodes:function(){return BX.convert.nodeListToArray(this.avatarContainer.querySelectorAll("["+this.attributeAvatar+"]"))},getAllAvatarNodes:function(){return BX.convert.nodeListToArray(this.context.querySelectorAll("["+this.attributeAvatar+"]"))},showLoader:function(){BX.addClass(this.editButtonNode,"loader")},hideLoader:function(){BX.removeClass(this.editButtonNode,"loader")},onFileAdded:function(e){if(!e.error&&!!e.data.path){var t=this.createAvatarNode(e.data.fileId,e.data.path);if(this.avatarContainer.children.length>0){this.avatarContainer.insertBefore(t,this.avatarContainer.children[0])}else{this.avatarContainer.appendChild(t)}this.initAvatar(t);this.selectAvatar(t);this.hideLoader()}},onFileRemoved:function(e){if(e.data.fileId&&e.data.fileId>0){var t=this.getUserAvatarNodeByFileId(e.data.fileId)}if(e.error){if(t){t.style.display=""}}else if(t){BX.remove(t)}this.hideLoader()},addFile:function(e){if(!e||e.size<=0){return}this.showLoader();var t=new FormData;t.append("avatarFile",e);this.caller.sendActionRequest("addAvatarFile",t,BX.proxy(this.onFileAdded,this),BX.proxy((function(e){e=e||{error:true};this.onFileAdded(e)}),this))},removeFile:function(e,t){this.showLoader();t.style.display="none";this.caller.sendActionRequest("removeAvatarFile",{fileId:e},BX.proxy(this.onFileRemoved,this))},show:function(){if(!this.editor){this.initEditor()}this.editor.show();BX.addCustomEvent(this.editor.popup,"onPopupClose",BX.proxy(this.onEditorPopupClose,this))},onEditorPopupClose:function(){BX.onCustomEvent(this,"onClose",[]);BX.removeCustomEvent(this.editor.popup,"onPopupClose",BX.proxy(this.onEditorPopupClose,this))},initEditor:function(){this.editor=new BX.AvatarEditor;BX.addCustomEvent(this.editor,"onApply",BX.delegate((function(e){if(!e){return}this.addFile(e)}),this))}};BX.ImolKpiTimeMenu=function(e){this.element=e.element;this.bindElement=document.getElementById(e.bindElement);this.inputElement=document.getElementById(e.inputElement);this.items=this.prepareItems(e.items);this.fullBlockName=e.fullBlockName;this.customInputId=e.customInputId;this.init()};BX.ImolKpiTimeMenu.prototype={init:function(){var e={maxHeight:600,minWidth:this.bindElement.offsetWidth};this.menu=new BX.PopupMenuWindow(this.element,this.bindElement,this.items,e);BX.bind(this.bindElement,"click",BX.delegate(this.show,this))},show:function(){this.menu.show()},close:function(){this.menu.close()},prepareItems:function(e){if(typeof e==="object"){e=Object.values(e)}var t=[];var i;for(var n=0;n<e.length;n++){i=this.prepareItem(e[n]);if(i.delimiterBefore){t.push({delimiter:true})}t.push(i);if(i.delimiterAfter){t.push({delimiter:true})}}return t},prepareItem:function(e){var t={};t.title=e.NAME;t.text=e.TITLE||e.NAME;t.delimiterAfter=e.DELIMITER_AFTER;t.delimiterBefore=e.DELIMITER_BEFORE;t.onclick=BX.delegate((function(t){if(e.CUSTOM==="Y"){var i=new BX.PopupWindow(null,t.target,{offsetLeft:t.target.offsetWidth,offsetTop:-t.target.offsetHeight,className:"imopenlines-lines-edit-popup",autoHide:true,buttons:[new BX.PopupWindowButton({text:BX.message("IMOL_CONFIG_EDIT_KPI_ANSWER_TIME_SET"),className:"ui-btn ui-btn-sm ui-btn-primary",events:{click:BX.proxy((function(){var t=BX(this.customInputId).value;var n=t+" ";n+=e.TYPE=="further"?BX.message("IMOL_CONFIG_EDIT_KPI_ANSWER_TIME_MINUTES"):BX.message("IMOL_CONFIG_EDIT_KPI_ANSWER_TIME_SECONDS");this.bindElement.innerHTML=n;this.inputElement.value=e.TYPE=="further"?60*t:t;this.changeKpiBlock(t);i.destroy();this.close()}),this)}})],events:{onPopupClose:function(){i.destroy()}},contentNoPaddings:true,contentColor:"white",content:BX.create("div",{props:{className:"imopenlines-lines-edit-popup-content"},children:[BX.create("div",{props:{className:"ui-ctl ui-ctl-textbox ui-ctl-inline"},style:{maxWidth:"45px"},children:[BX.create("input",{props:{type:"number",className:"ui-ctl-element imopenlines-lines-edit-popup-input-number",id:this.customInputId},style:{textAlign:"center"}})]}),BX.create("span",{props:{className:"imopenlines-lines-edit-popup-text"},text:e.TYPE=="further"?BX.message("IMOL_CONFIG_EDIT_KPI_ANSWER_TIME_MINUTES"):BX.message("IMOL_CONFIG_EDIT_KPI_ANSWER_TIME_SECONDS")})]})});i.show()}else{this.bindElement.innerHTML=e.NAME;this.inputElement.value=e.VALUE;this.changeKpiBlock(e.VALUE);this.close()}}),this);return t},changeKpiBlock:function(e){if(this.fullBlockName){var t=e!=0;BX.animationHandler.fadeSlideToggleByClass(BX(this.fullBlockName),t)}}};var a=function(e){this.params={id:e.id,inputName:e.inputName,inputId:e.inputId,list:e.list,readOnly:e.readOnly};this.nodesType={userInput:this.params.id,userInputContainer:this.params.inputId};this.nodes={};this.nodes[this.nodesType.userInput]=BX(this.params.id);this.nodes[this.nodesType.userInputContainer]=BX(this.params.inputId)};a.prototype={setInput:function(){var e=false;if(this.params.readOnly){e=true}this.selector=new BX.UI.EntitySelector.TagSelector({id:this.nodesType.userInput,readonly:e,dialogOptions:{id:this.nodesType.userInput,context:"IMOL_KPI_USERS",preselectedItems:this.prepareItems(),events:{"Item:onSelect":BX.proxy((function(){this.reloadInputKpi()}),this),"Item:onDeselect":BX.proxy((function(){this.reloadInputKpi()}),this),onLoad:BX.proxy((function(){this.reloadInputKpi()}),this)},entities:[{id:"user",options:{inviteEmployeeLink:false,intranetUsersOnly:true}},{id:"department",options:{inviteEmployeeLink:false,selectMode:"usersOnly"}}]}});this.selector.renderTo(this.nodes[this.nodesType.userInput])},prepareItems:function(){var e=[];this.params.list.forEach((function(t){e.push(["user",t])}));return e},reloadInputKpi:function(){var e=this.selector.getDialog().getSelectedItems();BX.cleanNode(this.nodes[this.nodesType.userInputContainer]);e.forEach(BX.delegate((function(e){this.nodes[this.nodesType.userInputContainer].appendChild(BX.create("input",{props:{name:this.params.inputName,value:e.id},attrs:{type:"hidden"}}))}),this))}}})(window);
//# sourceMappingURL=script.map.js