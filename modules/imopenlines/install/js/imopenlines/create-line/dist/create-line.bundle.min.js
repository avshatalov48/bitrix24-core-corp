this.BX=this.BX||{};(function(e,t,n){"use strict";var i;var r=function(){function e(n){babelHelpers.classCallCheck(this,e);babelHelpers.defineProperty(this,"isLocked",false);babelHelpers.defineProperty(this,"cache",new t.Cache.MemoryCache);this.path=n.path;if(this.path){this.init()}}babelHelpers.createClass(e,[{key:"init",value:function e(){var n=this;if(this.isLocked){return}this.isLocked=true;t.ajax({url:"/bitrix/components/bitrix/imopenlines.lines/ajax.php",method:"POST",data:{action:"create",sessid:BX.bitrix_sessid()},timeout:30,dataType:"json",processData:true,onsuccess:function e(t){t=t||{};if(t.error){n.onFail(t)}else{n.onSuccess(t)}},onfailure:function e(t){return n.onFail(t)}})}},{key:"onSuccess",value:function e(t){BX.SidePanel.Instance.open(this.path.replace("#LINE#",t.config_id),{width:700,cacheable:false})}},{key:"onFail",value:function e(n){n=n||{error:true,text:""};this.isLocked=false;if(n.limited){if(!B24||!B24["licenseInfoPopup"]){return}BX.UI.InfoHelper.show("limit_contact_center_ol_number")}else{n=n||{};var i=n.text||t.Loc.getMessage("IMOPENLINES_CREATE_LINE_ERROR_ACTION");this.showErrorPopup(i)}}},{key:"showErrorPopup",value:function e(i){var r=n.PopupManager.create({id:"crm_webform_list_error",content:this.getPopupContent(i),buttons:[new BX.UI.Button({text:t.Loc.getMessage("IMOPENLINES_CREATE_LINE_CLOSE_BUTTON"),onclick:function e(){return r.close()}})],autoHide:true,lightShadow:true,closeByEsc:true,overlay:{backgroundColor:"black",opacity:500}});r.show()}},{key:"getPopupContent",value:function e(n){return this.cache.remember("popupContent",(function(){return t.Tag.render(i||(i=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<span class="crm-webform-edit-warning-popup-alert">',"</span>\n\t\t\t"])),n)}))}}]);return e}();e.CreateLine=r})(this.BX.Imopenlines=this.BX.Imopenlines||{},BX,BX.Main);
//# sourceMappingURL=create-line.bundle.map.js