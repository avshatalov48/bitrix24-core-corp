this.BX=this.BX||{};(function(e,t,i){"use strict";var n;var r=function(){function e(i){babelHelpers.classCallCheck(this,e);babelHelpers.defineProperty(this,"isLocked",false);babelHelpers.defineProperty(this,"cache",new t.Cache.MemoryCache);this.path=i.path;this.sliderWidth=i.sliderWidth;if(this.path){this.init()}}babelHelpers.createClass(e,[{key:"init",value:function e(){var i=this;if(this.isLocked){return}this.isLocked=true;t.ajax({url:"/bitrix/components/bitrix/imopenlines.lines/ajax.php",method:"POST",data:{action:"create",sessid:BX.bitrix_sessid()},timeout:30,dataType:"json",processData:true,onsuccess:function e(t){t=t||{};if(t.error){i.onFail(t)}else{i.onSuccess(t)}},onfailure:function e(t){return i.onFail(t)}})}},{key:"onSuccess",value:function e(t){BX.SidePanel.Instance.open(this.path.replace("#LINE#",t.config_id),{width:this.sliderWidth,cacheable:false})}},{key:"onFail",value:function e(i){i=i||{error:true,text:""};this.isLocked=false;if(i.limited){if(!B24||!B24["licenseInfoPopup"]){return}BX.UI.InfoHelper.show("limit_contact_center_ol_number")}else{i=i||{};var n=i.text||t.Loc.getMessage("IMOPENLINES_CREATE_LINE_ERROR_ACTION");this.showErrorPopup(n)}}},{key:"showErrorPopup",value:function e(n){var r=i.PopupManager.create({id:"crm_webform_list_error",content:this.getPopupContent(n),buttons:[new BX.UI.Button({text:t.Loc.getMessage("IMOPENLINES_CREATE_LINE_CLOSE_BUTTON"),onclick:function e(){return r.close()}})],autoHide:true,lightShadow:true,closeByEsc:true,overlay:{backgroundColor:"black",opacity:500}});r.show()}},{key:"getPopupContent",value:function e(i){return this.cache.remember("popupContent",(function(){return t.Tag.render(n||(n=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<span class="crm-webform-edit-warning-popup-alert">',"</span>\n\t\t\t"])),i)}))}}]);return e}();e.CreateLine=r})(this.BX.Imopenlines=this.BX.Imopenlines||{},BX,BX.Main);
//# sourceMappingURL=create-line.bundle.map.js