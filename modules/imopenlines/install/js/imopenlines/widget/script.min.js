(function(){if(typeof window.BX==="function"){return}
/**
 * Babel external helpers
 * (c) 2018 Babel
 * @license MIT
 */(function(e){var t=e.babelHelpers={};function n(e){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){t.typeof=n=function(e){return typeof e}}else{t.typeof=n=function(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e}}return n(e)}t.typeof=n;var i;function r(e,t,n,r){if(!i){i=typeof Symbol==="function"&&Symbol.for&&Symbol.for("react.element")||60103}var s=e&&e.defaultProps;var o=arguments.length-3;if(!t&&o!==0){t={children:void 0}}if(t&&s){for(var a in s){if(t[a]===void 0){t[a]=s[a]}}}else if(!t){t=s||{}}if(o===1){t.children=r}else if(o>1){var l=new Array(o);for(var u=0;u<o;u++){l[u]=arguments[u+3]}t.children=l}return{$$typeof:i,type:e,key:n===undefined?null:""+n,ref:null,props:t,_owner:null}}t.jsx=r;function s(e){var t;if(typeof Symbol==="function"){if(Symbol.asyncIterator){t=e[Symbol.asyncIterator];if(t!=null)return t.call(e)}if(Symbol.iterator){t=e[Symbol.iterator];if(t!=null)return t.call(e)}}throw new TypeError("Object is not async iterable")}t.asyncIterator=s;function o(e){this.wrapped=e}t.AwaitValue=o;function a(e){var n,i;function r(e,t){return new Promise((function(r,o){var a={key:e,arg:t,resolve:r,reject:o,next:null};if(i){i=i.next=a}else{n=i=a;s(e,t)}}))}function s(n,i){try{var r=e[n](i);var a=r.value;var l=a instanceof t.AwaitValue;Promise.resolve(l?a.wrapped:a).then((function(e){if(l){s("next",e);return}o(r.done?"return":"normal",e)}),(function(e){s("throw",e)}))}catch(e){o("throw",e)}}function o(e,t){switch(e){case"return":n.resolve({value:t,done:true});break;case"throw":n.reject(t);break;default:n.resolve({value:t,done:false});break}n=n.next;if(n){s(n.key,n.arg)}else{i=null}}this._invoke=r;if(typeof e.return!=="function"){this.return=undefined}}if(typeof Symbol==="function"&&Symbol.asyncIterator){a.prototype[Symbol.asyncIterator]=function(){return this}}a.prototype.next=function(e){return this._invoke("next",e)};a.prototype.throw=function(e){return this._invoke("throw",e)};a.prototype.return=function(e){return this._invoke("return",e)};t.AsyncGenerator=a;function l(e){return function(){return new t.AsyncGenerator(e.apply(this,arguments))}}t.wrapAsyncGenerator=l;function u(e){return new t.AwaitValue(e)}t.awaitAsyncGenerator=u;function c(e,t){var n={},i=false;function r(n,r){i=true;r=new Promise((function(t){t(e[n](r))}));return{done:false,value:t(r)}}if(typeof Symbol==="function"&&Symbol.iterator){n[Symbol.iterator]=function(){return this}}n.next=function(e){if(i){i=false;return e}return r("next",e)};if(typeof e.throw==="function"){n.throw=function(e){if(i){i=false;throw e}return r("throw",e)}}if(typeof e.return==="function"){n.return=function(e){return r("return",e)}}return n}t.asyncGeneratorDelegate=c;function f(e,t,n,i,r,s,o){try{var a=e[s](o);var l=a.value}catch(e){n(e);return}if(a.done){t(l)}else{Promise.resolve(l).then(i,r)}}function d(e){return function(){var t=this,n=arguments;return new Promise((function(i,r){var s=e.apply(t,n);function o(e){f(s,i,r,o,a,"next",e)}function a(e){f(s,i,r,o,a,"throw",e)}o(undefined)}))}}t.asyncToGenerator=d;function h(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}t.classCallCheck=h;function p(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||false;i.configurable=true;if("value"in i)i.writable=true;Object.defineProperty(e,i.key,i)}}function m(e,t,n){if(t)p(e.prototype,t);if(n)p(e,n);return e}t.createClass=m;function g(e,t){for(var n in t){var i=t[n];i.configurable=i.enumerable=true;if("value"in i)i.writable=true;Object.defineProperty(e,n,i)}if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);for(var s=0;s<r.length;s++){var o=r[s];var i=t[o];i.configurable=i.enumerable=true;if("value"in i)i.writable=true;Object.defineProperty(e,o,i)}}return e}t.defineEnumerableProperties=g;function v(e,t){var n=Object.getOwnPropertyNames(t);for(var i=0;i<n.length;i++){var r=n[i];var s=Object.getOwnPropertyDescriptor(t,r);if(s&&s.configurable&&e[r]===undefined){Object.defineProperty(e,r,s)}}return e}t.defaults=v;function y(e,t,n){if(t in e){Object.defineProperty(e,t,{value:n,enumerable:true,configurable:true,writable:true})}else{e[t]=n}return e}t.defineProperty=y;function b(){t.extends=b=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n){if(Object.prototype.hasOwnProperty.call(n,i)){e[i]=n[i]}}}return e};return b.apply(this,arguments)}t.extends=b;function w(e){for(var n=1;n<arguments.length;n++){var i=arguments[n]!=null?arguments[n]:{};var r=Object.keys(i);if(typeof Object.getOwnPropertySymbols==="function"){r=r.concat(Object.getOwnPropertySymbols(i).filter((function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable})))}r.forEach((function(n){t.defineProperty(e,n,i[n])}))}return e}t.objectSpread=w;function S(e,n){if(typeof n!=="function"&&n!==null){throw new TypeError("Super expression must either be null or a function")}e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:true,configurable:true}});if(n)t.setPrototypeOf(e,n)}t.inherits=S;function I(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;e.__proto__=t}t.inheritsLoose=I;function k(e){t.getPrototypeOf=k=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)};return k(e)}t.getPrototypeOf=k;function C(e,n){t.setPrototypeOf=C=Object.setPrototypeOf||function e(t,n){t.__proto__=n;return t};return C(e,n)}t.setPrototypeOf=C;function E(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function _(e,n,i){if(E()){t.construct=_=Reflect.construct}else{t.construct=_=function e(n,i,r){var s=[null];s.push.apply(s,i);var o=Function.bind.apply(n,s);var a=new o;if(r)t.setPrototypeOf(a,r.prototype);return a}}return _.apply(null,arguments)}t.construct=_;function x(e){return Function.toString.call(e).indexOf("[native code]")!==-1}t.isNativeFunction=x;function T(e){var n=typeof Map==="function"?new Map:undefined;t.wrapNativeSuper=T=function e(i){if(i===null||!t.isNativeFunction(i))return i;if(typeof i!=="function"){throw new TypeError("Super expression must either be null or a function")}if(typeof n!=="undefined"){if(n.has(i))return n.get(i);n.set(i,r)}function r(){return t.construct(i,arguments,t.getPrototypeOf(this).constructor)}r.prototype=Object.create(i.prototype,{constructor:{value:r,enumerable:false,writable:true,configurable:true}});return t.setPrototypeOf(r,i)};return T(e)}t.wrapNativeSuper=T;function O(e,t){if(t!=null&&typeof Symbol!=="undefined"&&t[Symbol.hasInstance]){return t[Symbol.hasInstance](e)}else{return e instanceof t}}t.instanceof=O;function M(e){return e&&e.__esModule?e:{default:e}}t.interopRequireDefault=M;function D(e){if(e&&e.__esModule){return e}else{var t={};if(e!=null){for(var n in e){if(Object.prototype.hasOwnProperty.call(e,n)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};if(i.get||i.set){Object.defineProperty(t,n,i)}else{t[n]=e[n]}}}}t.default=e;return t}}t.interopRequireWildcard=D;function A(e,t){if(e!==t){throw new TypeError("Cannot instantiate an arrow function")}}t.newArrowCheck=A;function P(e){if(e==null)throw new TypeError("Cannot destructure undefined")}t.objectDestructuringEmpty=P;function L(e,t){if(e==null)return{};var n={};var i=Object.keys(e);var r,s;for(s=0;s<i.length;s++){r=i[s];if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}t.objectWithoutPropertiesLoose=L;function R(e,n){if(e==null)return{};var i=t.objectWithoutPropertiesLoose(e,n);var r,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(s=0;s<o.length;s++){r=o[s];if(n.indexOf(r)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(e,r))continue;i[r]=e[r]}}return i}t.objectWithoutProperties=R;function H(e){if(e===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return e}t.assertThisInitialized=H;function j(e,n){if(n&&(typeof n==="object"||typeof n==="function")){return n}return t.assertThisInitialized(e)}t.possibleConstructorReturn=j;function N(e,n){while(!Object.prototype.hasOwnProperty.call(e,n)){e=t.getPrototypeOf(e);if(e===null)break}return e}t.superPropBase=N;function B(e,n,i){if(typeof Reflect!=="undefined"&&Reflect.get){t.get=B=Reflect.get}else{t.get=B=function e(n,i,r){var s=t.superPropBase(n,i);if(!s)return;var o=Object.getOwnPropertyDescriptor(s,i);if(o.get){return o.get.call(r)}return o.value}}return B(e,n,i||e)}t.get=B;function F(e,n,i,r){if(typeof Reflect!=="undefined"&&Reflect.set){F=Reflect.set}else{F=function e(n,i,r,s){var o=t.superPropBase(n,i);var a;if(o){a=Object.getOwnPropertyDescriptor(o,i);if(a.set){a.set.call(s,r);return true}else if(!a.writable){return false}}a=Object.getOwnPropertyDescriptor(s,i);if(a){if(!a.writable){return false}a.value=r;Object.defineProperty(s,i,a)}else{t.defineProperty(s,i,r)}return true}}return F(e,n,i,r)}function U(e,t,n,i,r){var s=F(e,t,n,i||e);if(!s&&r){throw new Error("failed to set property")}return n}t.set=U;function W(e,t){if(!t){t=e.slice(0)}return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}t.taggedTemplateLiteral=W;function $(e,t){if(!t){t=e.slice(0)}e.raw=t;return e}t.taggedTemplateLiteralLoose=$;function V(e,n){if(e===t.temporalUndefined){throw new ReferenceError(n+" is not defined - temporal dead zone")}else{return e}}t.temporalRef=V;function G(e){throw new Error('"'+e+'" is read-only')}t.readOnlyError=G;function z(e){throw new Error('Class "'+e+'" cannot be referenced in computed property keys.')}t.classNameTDZError=z;t.temporalUndefined={};function X(e,n){return t.arrayWithHoles(e)||t.iterableToArrayLimit(e,n)||t.nonIterableRest()}t.slicedToArray=X;function q(e,n){return t.arrayWithHoles(e)||t.iterableToArrayLimitLoose(e,n)||t.nonIterableRest()}t.slicedToArrayLoose=q;function K(e){return t.arrayWithHoles(e)||t.iterableToArray(e)||t.nonIterableRest()}t.toArray=K;function Y(e){return t.arrayWithoutHoles(e)||t.iterableToArray(e)||t.nonIterableSpread()}t.toConsumableArray=Y;function J(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}t.arrayWithoutHoles=J;function Q(e){if(Array.isArray(e))return e}t.arrayWithHoles=Q;function Z(e){if(Symbol.iterator in Object(e)||Object.prototype.toString.call(e)==="[object Arguments]")return Array.from(e)}t.iterableToArray=Z;function ee(e,t){var n=[];var i=true;var r=false;var s=undefined;try{for(var o=e[Symbol.iterator](),a;!(i=(a=o.next()).done);i=true){n.push(a.value);if(t&&n.length===t)break}}catch(e){r=true;s=e}finally{try{if(!i&&o["return"]!=null)o["return"]()}finally{if(r)throw s}}return n}t.iterableToArrayLimit=ee;function te(e,t){var n=[];for(var i=e[Symbol.iterator](),r;!(r=i.next()).done;){n.push(r.value);if(t&&n.length===t)break}return n}t.iterableToArrayLimitLoose=te;function ne(){throw new TypeError("Invalid attempt to spread non-iterable instance")}t.nonIterableSpread=ne;function ie(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}t.nonIterableRest=ie;function re(e){return function(){var t=e.apply(this,arguments);t.next();return t}}t.skipFirstGeneratorNext=re;function se(e){if(typeof e==="symbol"){return e}else{return String(e)}}t.toPropertyKey=se;function oe(e,t){throw new Error("Decorating class property failed. Please ensure that "+"proposal-class-properties is enabled and set to use loose mode. "+"To use proposal-class-properties in spec mode with decorators, wait for "+"the next major version of decorators in stage 2.")}t.initializerWarningHelper=oe;function ae(e,t,n,i){if(!n)return;Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(i):void 0})}t.initializerDefineProperty=ae;function le(e,t,n,i,r){var s={};Object["ke"+"ys"](i).forEach((function(e){s[e]=i[e]}));s.enumerable=!!s.enumerable;s.configurable=!!s.configurable;if("value"in s||s.initializer){s.writable=true}s=n.slice().reverse().reduce((function(n,i){return i(e,t,n)||n}),s);if(r&&s.initializer!==void 0){s.value=s.initializer?s.initializer.call(r):void 0;s.initializer=undefined}if(s.initializer===void 0){Object["define"+"Property"](e,t,s);s=null}return s}t.applyDecoratedDescriptor=le;var ue=0;function ce(e){return"__private_"+ue+++"_"+e}t.classPrivateFieldLooseKey=ce;function fe(e,t){if(!Object.prototype.hasOwnProperty.call(e,t)){throw new TypeError("attempted to use private field on non-instance")}return e}t.classPrivateFieldLooseBase=fe;function de(e,t){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return t.get(e).value}t.classPrivateFieldGet=de;function he(e,t,n){if(!t.has(e)){throw new TypeError("attempted to set private field on non-instance")}var i=t.get(e);if(!i.writable){throw new TypeError("attempted to set read only private field")}i.value=n;return n}t.classPrivateFieldSet=he})(typeof global==="undefined"?window:global);!function(e){"use strict";var t=Object.prototype;var n=t.hasOwnProperty;var i;var r=typeof Symbol==="function"?Symbol:{};var s=r.iterator||"@@iterator";var o=r.asyncIterator||"@@asyncIterator";var a=r.toStringTag||"@@toStringTag";var l=e.regeneratorRuntime={};function u(e,t,n,i){var r=t&&t.prototype instanceof g?t:g;var s=Object.create(r.prototype);var o=new O(i||[]);s._invoke=E(e,n,o);return s}l.wrap=u;function c(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}var f="suspendedStart";var d="suspendedYield";var h="executing";var p="completed";var m={};function g(){}function v(){}function y(){}var b={};b[s]=function(){return this};var w=Object.getPrototypeOf;var S=w&&w(w(M([])));if(S&&S!==t&&n.call(S,s)){b=S}var I=y.prototype=g.prototype=Object.create(b);v.prototype=I.constructor=y;y.constructor=v;y[a]=v.displayName="GeneratorFunction";function k(e){["next","throw","return"].forEach((function(t){e[t]=function(e){return this._invoke(t,e)}}))}l.isGeneratorFunction=function(e){var t=typeof e==="function"&&e.constructor;return t?t===v||(t.displayName||t.name)==="GeneratorFunction":false};l.mark=function(e){if(Object.setPrototypeOf){Object.setPrototypeOf(e,y)}else{e.__proto__=y;if(!(a in e)){e[a]="GeneratorFunction"}}e.prototype=Object.create(I);return e};l.awrap=function(e){return{__await:e}};function C(e){function t(i,r,s,o){var a=c(e[i],e,r);if(a.type==="throw"){o(a.arg)}else{var l=a.arg;var u=l.value;if(u&&typeof u==="object"&&n.call(u,"__await")){return Promise.resolve(u.__await).then((function(e){t("next",e,s,o)}),(function(e){t("throw",e,s,o)}))}return Promise.resolve(u).then((function(e){l.value=e;s(l)}),o)}}var i;function r(e,n){function r(){return new Promise((function(i,r){t(e,n,i,r)}))}return i=i?i.then(r,r):r()}this._invoke=r}k(C.prototype);C.prototype[o]=function(){return this};l.AsyncIterator=C;l.async=function(e,t,n,i){var r=new C(u(e,t,n,i));return l.isGeneratorFunction(t)?r:r.next().then((function(e){return e.done?e.value:r.next()}))};function E(e,t,n){var i=f;return function r(s,o){if(i===h){throw new Error("Generator is already running")}if(i===p){if(s==="throw"){throw o}return D()}n.method=s;n.arg=o;while(true){var a=n.delegate;if(a){var l=_(a,n);if(l){if(l===m)continue;return l}}if(n.method==="next"){n.sent=n._sent=n.arg}else if(n.method==="throw"){if(i===f){i=p;throw n.arg}n.dispatchException(n.arg)}else if(n.method==="return"){n.abrupt("return",n.arg)}i=h;var u=c(e,t,n);if(u.type==="normal"){i=n.done?p:d;if(u.arg===m){continue}return{value:u.arg,done:n.done}}else if(u.type==="throw"){i=p;n.method="throw";n.arg=u.arg}}}}function _(e,t){var n=e.iterator[t.method];if(n===i){t.delegate=null;if(t.method==="throw"){if(e.iterator.return){t.method="return";t.arg=i;_(e,t);if(t.method==="throw"){return m}}t.method="throw";t.arg=new TypeError("The iterator does not provide a 'throw' method")}return m}var r=c(n,e.iterator,t.arg);if(r.type==="throw"){t.method="throw";t.arg=r.arg;t.delegate=null;return m}var s=r.arg;if(!s){t.method="throw";t.arg=new TypeError("iterator result is not an object");t.delegate=null;return m}if(s.done){t[e.resultName]=s.value;t.next=e.nextLoc;if(t.method!=="return"){t.method="next";t.arg=i}}else{return s}t.delegate=null;return m}k(I);I[a]="Generator";I[s]=function(){return this};I.toString=function(){return"[object Generator]"};function x(e){var t={tryLoc:e[0]};if(1 in e){t.catchLoc=e[1]}if(2 in e){t.finallyLoc=e[2];t.afterLoc=e[3]}this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal";delete t.arg;e.completion=t}function O(e){this.tryEntries=[{tryLoc:"root"}];e.forEach(x,this);this.reset(true)}l.keys=function(e){var t=[];for(var n in e){t.push(n)}t.reverse();return function n(){while(t.length){var i=t.pop();if(i in e){n.value=i;n.done=false;return n}}n.done=true;return n}};function M(e){if(e){var t=e[s];if(t){return t.call(e)}if(typeof e.next==="function"){return e}if(!isNaN(e.length)){var r=-1,o=function t(){while(++r<e.length){if(n.call(e,r)){t.value=e[r];t.done=false;return t}}t.value=i;t.done=true;return t};return o.next=o}}return{next:D}}l.values=M;function D(){return{value:i,done:true}}O.prototype={constructor:O,reset:function(e){this.prev=0;this.next=0;this.sent=this._sent=i;this.done=false;this.delegate=null;this.method="next";this.arg=i;this.tryEntries.forEach(T);if(!e){for(var t in this){if(t.charAt(0)==="t"&&n.call(this,t)&&!isNaN(+t.slice(1))){this[t]=i}}}},stop:function(){this.done=true;var e=this.tryEntries[0];var t=e.completion;if(t.type==="throw"){throw t.arg}return this.rval},dispatchException:function(e){if(this.done){throw e}var t=this;function r(n,r){a.type="throw";a.arg=e;t.next=n;if(r){t.method="next";t.arg=i}return!!r}for(var s=this.tryEntries.length-1;s>=0;--s){var o=this.tryEntries[s];var a=o.completion;if(o.tryLoc==="root"){return r("end")}if(o.tryLoc<=this.prev){var l=n.call(o,"catchLoc");var u=n.call(o,"finallyLoc");if(l&&u){if(this.prev<o.catchLoc){return r(o.catchLoc,true)}else if(this.prev<o.finallyLoc){return r(o.finallyLoc)}}else if(l){if(this.prev<o.catchLoc){return r(o.catchLoc,true)}}else if(u){if(this.prev<o.finallyLoc){return r(o.finallyLoc)}}else{throw new Error("try statement without catch or finally")}}}},abrupt:function(e,t){for(var i=this.tryEntries.length-1;i>=0;--i){var r=this.tryEntries[i];if(r.tryLoc<=this.prev&&n.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var s=r;break}}if(s&&(e==="break"||e==="continue")&&s.tryLoc<=t&&t<=s.finallyLoc){s=null}var o=s?s.completion:{};o.type=e;o.arg=t;if(s){this.method="next";this.next=s.finallyLoc;return m}return this.complete(o)},complete:function(e,t){if(e.type==="throw"){throw e.arg}if(e.type==="break"||e.type==="continue"){this.next=e.arg}else if(e.type==="return"){this.rval=this.arg=e.arg;this.method="return";this.next="end"}else if(e.type==="normal"&&t){this.next=t}return m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e){this.complete(n.completion,n.afterLoc);T(n);return m}}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var i=n.completion;if(i.type==="throw"){var r=i.arg;T(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){this.delegate={iterator:M(e),resultName:t,nextLoc:n};if(this.method==="next"){this.arg=i}return m}}}(function(){return this}()||Function("return this")());(function(e){"use strict";var t=typeof window!=="undefined"?window:typeof global!=="undefined"?global:typeof self!=="undefined"?self:{};function n(e,t){return t={exports:{}},e(t,t.exports),t.exports}var i=function(e){return e&&e.Math==Math&&e};var r=i(typeof globalThis=="object"&&globalThis)||i(typeof window=="object"&&window)||i(typeof self=="object"&&self)||i(typeof t=="object"&&t)||function(){return this}()||Function("return this")();var s=function(e){try{return!!e()}catch(e){return true}};var o=!s((function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7}));var a=Function.prototype.call;var l=a.bind?a.bind(a):function(){return a.apply(a,arguments)};var u={}.propertyIsEnumerable;var c=Object.getOwnPropertyDescriptor;var f=c&&!u.call({1:2},1);var d=f?function e(t){var n=c(this,t);return!!n&&n.enumerable}:u;var h={f:d};var p=function(e,t){return{enumerable:!(e&1),configurable:!(e&2),writable:!(e&4),value:t}};var m=Function.prototype;var g=m.bind;var v=m.call;var y=g&&g.bind(v);var b=g?function(e){return e&&y(v,e)}:function(e){return e&&function(){return v.apply(e,arguments)}};var w=b({}.toString);var S=b("".slice);var I=function(e){return S(w(e),8,-1)};var k=r.Object;var C=b("".split);var E=s((function(){return!k("z").propertyIsEnumerable(0)}))?function(e){return I(e)=="String"?C(e,""):k(e)}:k;var _=r.TypeError;var x=function(e){if(e==undefined)throw _("Can't call method on "+e);return e};var T=function(e){return E(x(e))};var O=function(e){return typeof e=="function"};var M=function(e){return typeof e=="object"?e!==null:O(e)};var D=function(e){return O(e)?e:undefined};var A=function(e,t){return arguments.length<2?D(r[e]):r[e]&&r[e][t]};var P=b({}.isPrototypeOf);var L=A("navigator","userAgent")||"";var R=r.process;var H=r.Deno;var j=R&&R.versions||H&&H.version;var N=j&&j.v8;var B,F;if(N){B=N.split(".");F=B[0]>0&&B[0]<4?1:+(B[0]+B[1])}if(!F&&L){B=L.match(/Edge\/(\d+)/);if(!B||B[1]>=74){B=L.match(/Chrome\/(\d+)/);if(B)F=+B[1]}}var U=F;var W=!!Object.getOwnPropertySymbols&&!s((function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&U&&U<41}));var $=W&&!Symbol.sham&&typeof Symbol.iterator=="symbol";var V=r.Object;var G=$?function(e){return typeof e=="symbol"}:function(e){var t=A("Symbol");return O(t)&&P(t.prototype,V(e))};var z=r.String;var X=function(e){try{return z(e)}catch(e){return"Object"}};var q=r.TypeError;var K=function(e){if(O(e))return e;throw q(X(e)+" is not a function")};var Y=function(e,t){var n=e[t];return n==null?undefined:K(n)};var J=r.TypeError;var Q=function(e,t){var n,i;if(t==="string"&&O(n=e.toString)&&!M(i=l(n,e)))return i;if(O(n=e.valueOf)&&!M(i=l(n,e)))return i;if(t!=="string"&&O(n=e.toString)&&!M(i=l(n,e)))return i;throw J("Can't convert object to primitive value")};var Z=false;var ee=Object.defineProperty;var te=function(e,t){try{ee(r,e,{value:t,configurable:true,writable:true})}catch(n){r[e]=t}return t};var ne="__core-js_shared__";var ie=r[ne]||te(ne,{});var re=ie;var se=n((function(e){(e.exports=function(e,t){return re[e]||(re[e]=t!==undefined?t:{})})("versions",[]).push({version:"3.19.2",mode:"global",copyright:"(c) 2021 Denis Pushkarev (zloirock.ru)"})}));var oe=r.Object;var ae=function(e){return oe(x(e))};var le=b({}.hasOwnProperty);var ue=Object.hasOwn||function e(t,n){return le(ae(t),n)};var ce=0;var fe=Math.random();var de=b(1..toString);var he=function(e){return"Symbol("+(e===undefined?"":e)+")_"+de(++ce+fe,36)};var pe=se("wks");var me=r.Symbol;var ge=me&&me["for"];var ve=$?me:me&&me.withoutSetter||he;var ye=function(e){if(!ue(pe,e)||!(W||typeof pe[e]=="string")){var t="Symbol."+e;if(W&&ue(me,e)){pe[e]=me[e]}else if($&&ge){pe[e]=ge(t)}else{pe[e]=ve(t)}}return pe[e]};var be=r.TypeError;var we=ye("toPrimitive");var Se=function(e,t){if(!M(e)||G(e))return e;var n=Y(e,we);var i;if(n){if(t===undefined)t="default";i=l(n,e,t);if(!M(i)||G(i))return i;throw be("Can't convert object to primitive value")}if(t===undefined)t="number";return Q(e,t)};var Ie=function(e){var t=Se(e,"string");return G(t)?t:t+""};var ke=r.document;var Ce=M(ke)&&M(ke.createElement);var Ee=function(e){return Ce?ke.createElement(e):{}};var _e=!o&&!s((function(){return Object.defineProperty(Ee("div"),"a",{get:function(){return 7}}).a!=7}));var xe=Object.getOwnPropertyDescriptor;var Te=o?xe:function e(t,n){t=T(t);n=Ie(n);if(_e)try{return xe(t,n)}catch(e){}if(ue(t,n))return p(!l(h.f,t,n),t[n])};var Oe={f:Te};var Me=r.String;var De=r.TypeError;var Ae=function(e){if(M(e))return e;throw De(Me(e)+" is not an object")};var Pe=r.TypeError;var Le=Object.defineProperty;var Re=o?Le:function e(t,n,i){Ae(t);n=Ie(n);Ae(i);if(_e)try{return Le(t,n,i)}catch(e){}if("get"in i||"set"in i)throw Pe("Accessors not supported");if("value"in i)t[n]=i.value;return t};var He={f:Re};var je=o?function(e,t,n){return He.f(e,t,p(1,n))}:function(e,t,n){e[t]=n;return e};var Ne=b(Function.toString);if(!O(re.inspectSource)){re.inspectSource=function(e){return Ne(e)}}var Be=re.inspectSource;var Fe=r.WeakMap;var Ue=O(Fe)&&/native code/.test(Be(Fe));var We=se("keys");var $e=function(e){return We[e]||(We[e]=he(e))};var Ve={};var Ge="Object already initialized";var ze=r.TypeError;var Xe=r.WeakMap;var qe,Ke,Ye;var Je=function(e){return Ye(e)?Ke(e):qe(e,{})};var Qe=function(e){return function(t){var n;if(!M(t)||(n=Ke(t)).type!==e){throw ze("Incompatible receiver, "+e+" required")}return n}};if(Ue||re.state){var Ze=re.state||(re.state=new Xe);var et=b(Ze.get);var tt=b(Ze.has);var nt=b(Ze.set);qe=function(e,t){if(tt(Ze,e))throw new ze(Ge);t.facade=e;nt(Ze,e,t);return t};Ke=function(e){return et(Ze,e)||{}};Ye=function(e){return tt(Ze,e)}}else{var it=$e("state");Ve[it]=true;qe=function(e,t){if(ue(e,it))throw new ze(Ge);t.facade=e;je(e,it,t);return t};Ke=function(e){return ue(e,it)?e[it]:{}};Ye=function(e){return ue(e,it)}}var rt={set:qe,get:Ke,has:Ye,enforce:Je,getterFor:Qe};var st=Function.prototype;var ot=o&&Object.getOwnPropertyDescriptor;var at=ue(st,"name");var lt=at&&function e(){}.name==="something";var ut=at&&(!o||o&&ot(st,"name").configurable);var ct={EXISTS:at,PROPER:lt,CONFIGURABLE:ut};var ft=n((function(e){var t=ct.CONFIGURABLE;var n=rt.get;var i=rt.enforce;var s=String(String).split("String");(e.exports=function(e,n,o,a){var l=a?!!a.unsafe:false;var u=a?!!a.enumerable:false;var c=a?!!a.noTargetGet:false;var f=a&&a.name!==undefined?a.name:n;var d;if(O(o)){if(String(f).slice(0,7)==="Symbol("){f="["+String(f).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"}if(!ue(o,"name")||t&&o.name!==f){je(o,"name",f)}d=i(o);if(!d.source){d.source=s.join(typeof f=="string"?f:"")}}if(e===r){if(u)e[n]=o;else te(n,o);return}else if(!l){delete e[n]}else if(!c&&e[n]){u=true}if(u)e[n]=o;else je(e,n,o)})(Function.prototype,"toString",(function e(){return O(this)&&n(this).source||Be(this)}))}));var dt=Math.ceil;var ht=Math.floor;var pt=function(e){var t=+e;return t!==t||t===0?0:(t>0?ht:dt)(t)};var mt=Math.max;var gt=Math.min;var vt=function(e,t){var n=pt(e);return n<0?mt(n+t,0):gt(n,t)};var yt=Math.min;var bt=function(e){return e>0?yt(pt(e),9007199254740991):0};var wt=function(e){return bt(e.length)};var St=function(e){return function(t,n,i){var r=T(t);var s=wt(r);var o=vt(i,s);var a;if(e&&n!=n)while(s>o){a=r[o++];if(a!=a)return true}else for(;s>o;o++){if((e||o in r)&&r[o]===n)return e||o||0}return!e&&-1}};var It={includes:St(true),indexOf:St(false)};var kt=It.indexOf;var Ct=b([].push);var Et=function(e,t){var n=T(e);var i=0;var r=[];var s;for(s in n)!ue(Ve,s)&&ue(n,s)&&Ct(r,s);while(t.length>i)if(ue(n,s=t[i++])){~kt(r,s)||Ct(r,s)}return r};var _t=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"];var xt=_t.concat("length","prototype");var Tt=Object.getOwnPropertyNames||function e(t){return Et(t,xt)};var Ot={f:Tt};var Mt=Object.getOwnPropertySymbols;var Dt={f:Mt};var At=b([].concat);var Pt=A("Reflect","ownKeys")||function e(t){var n=Ot.f(Ae(t));var i=Dt.f;return i?At(n,i(t)):n};var Lt=function(e,t){var n=Pt(t);var i=He.f;var r=Oe.f;for(var s=0;s<n.length;s++){var o=n[s];if(!ue(e,o))i(e,o,r(t,o))}};var Rt=/#|\.prototype\./;var Ht=function(e,t){var n=Nt[jt(e)];return n==Ft?true:n==Bt?false:O(t)?s(t):!!t};var jt=Ht.normalize=function(e){return String(e).replace(Rt,".").toLowerCase()};var Nt=Ht.data={};var Bt=Ht.NATIVE="N";var Ft=Ht.POLYFILL="P";var Ut=Ht;var Wt=Oe.f;var $t=function(e,t){var n=e.target;var i=e.global;var s=e.stat;var o,a,l,u,c,f;if(i){a=r}else if(s){a=r[n]||te(n,{})}else{a=(r[n]||{}).prototype}if(a)for(l in t){c=t[l];if(e.noTargetGet){f=Wt(a,l);u=f&&f.value}else u=a[l];o=Ut(i?l:n+(s?".":"#")+l,e.forced);if(!o&&u!==undefined){if(typeof c==typeof u)continue;Lt(c,u)}if(e.sham||u&&u.sham){je(c,"sham",true)}ft(a,l,c,e)}};var Vt=!s((function(){function e(){}e.prototype.constructor=null;return Object.getPrototypeOf(new e)!==e.prototype}));var Gt=$e("IE_PROTO");var zt=r.Object;var Xt=zt.prototype;var qt=Vt?zt.getPrototypeOf:function(e){var t=ae(e);if(ue(t,Gt))return t[Gt];var n=t.constructor;if(O(n)&&t instanceof n){return n.prototype}return t instanceof zt?Xt:null};var Kt=r.String;var Yt=r.TypeError;var Jt=function(e){if(typeof e=="object"||O(e))return e;throw Yt("Can't set "+Kt(e)+" as a prototype")};var Qt=Object.setPrototypeOf||("__proto__"in{}?function(){var e=false;var t={};var n;try{n=b(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set);n(t,[]);e=t instanceof Array}catch(e){}return function t(i,r){Ae(i);Jt(r);if(e)n(i,r);else i.__proto__=r;return i}}():undefined);var Zt=Object.keys||function e(t){return Et(t,_t)};var en=o?Object.defineProperties:function e(t,n){Ae(t);var i=T(n);var r=Zt(n);var s=r.length;var o=0;var a;while(s>o)He.f(t,a=r[o++],i[a]);return t};var tn=A("document","documentElement");var nn=">";var rn="<";var sn="prototype";var on="script";var an=$e("IE_PROTO");var ln=function(){};var un=function(e){return rn+on+nn+e+rn+"/"+on+nn};var cn=function(e){e.write(un(""));e.close();var t=e.parentWindow.Object;e=null;return t};var fn=function(){var e=Ee("iframe");var t="java"+on+":";var n;e.style.display="none";tn.appendChild(e);e.src=String(t);n=e.contentWindow.document;n.open();n.write(un("document.F=Object"));n.close();return n.F};var dn;var hn=function(){try{dn=new ActiveXObject("htmlfile")}catch(e){}hn=typeof document!="undefined"?document.domain&&dn?cn(dn):fn():cn(dn);var e=_t.length;while(e--)delete hn[sn][_t[e]];return hn()};Ve[an]=true;var pn=Object.create||function e(t,n){var i;if(t!==null){ln[sn]=Ae(t);i=new ln;ln[sn]=null;i[an]=t}else i=hn();return n===undefined?i:en(i,n)};var mn=function(e,t,n){var i=Ie(t);if(i in e)He.f(e,i,p(0,n));else e[i]=n};var gn=r.Array;var vn=Math.max;var yn=function(e,t,n){var i=wt(e);var r=vt(t,i);var s=vt(n===undefined?i:n,i);var o=gn(vn(s-r,0));for(var a=0;r<s;r++,a++)mn(o,a,e[r]);o.length=a;return o};var bn=b("".replace);var wn=b("".split);var Sn=b([].join);var In=function(e){return String(Error(e).stack)}("zxcasd");var kn=/\n\s*at [^:]*:[^\n]*/;var Cn=kn.test(In);var En=/@[^\n]*\n/.test(In)&&!/zxcasd/.test(In);var _n=function(e,t){if(typeof e!="string")return e;if(Cn){while(t--)e=bn(e,kn,"")}else if(En){return Sn(yn(wn(e,"\n"),t),"\n")}return e};var xn=function(e,t){if(M(t)&&"cause"in t){je(e,"cause",t.cause)}};var Tn=b(b.bind);var On=function(e,t){K(e);return t===undefined?e:Tn?Tn(e,t):function(){return e.apply(t,arguments)}};var Mn={};var Dn=ye("iterator");var An=Array.prototype;var Pn=function(e){return e!==undefined&&(Mn.Array===e||An[Dn]===e)};var Ln=ye("toStringTag");var Rn={};Rn[Ln]="z";var Hn=String(Rn)==="[object z]";var jn=ye("toStringTag");var Nn=r.Object;var Bn=I(function(){return arguments}())=="Arguments";var Fn=function(e,t){try{return e[t]}catch(e){}};var Un=Hn?I:function(e){var t,n,i;return e===undefined?"Undefined":e===null?"Null":typeof(n=Fn(t=Nn(e),jn))=="string"?n:Bn?I(t):(i=I(t))=="Object"&&O(t.callee)?"Arguments":i};var Wn=ye("iterator");var $n=function(e){if(e!=undefined)return Y(e,Wn)||Y(e,"@@iterator")||Mn[Un(e)]};var Vn=r.TypeError;var Gn=function(e,t){var n=arguments.length<2?$n(e):t;if(K(n))return Ae(l(n,e));throw Vn(X(e)+" is not iterable")};var zn=function(e,t,n){var i,r;Ae(e);try{i=Y(e,"return");if(!i){if(t==="throw")throw n;return n}i=l(i,e)}catch(e){r=true;i=e}if(t==="throw")throw n;if(r)throw i;Ae(i);return n};var Xn=r.TypeError;var qn=function(e,t){this.stopped=e;this.result=t};var Kn=qn.prototype;var Yn=function(e,t,n){var i=n&&n.that;var r=!!(n&&n.AS_ENTRIES);var s=!!(n&&n.IS_ITERATOR);var o=!!(n&&n.INTERRUPTED);var a=On(t,i);var u,c,f,d,h,p,m;var g=function(e){if(u)zn(u,"normal",e);return new qn(true,e)};var v=function(e){if(r){Ae(e);return o?a(e[0],e[1],g):a(e[0],e[1])}return o?a(e,g):a(e)};if(s){u=e}else{c=$n(e);if(!c)throw Xn(X(e)+" is not iterable");if(Pn(c)){for(f=0,d=wt(e);d>f;f++){h=v(e[f]);if(h&&P(Kn,h))return h}return new qn(false)}u=Gn(e,c)}p=u.next;while(!(m=l(p,u)).done){try{h=v(m.value)}catch(e){zn(u,"throw",e)}if(typeof h=="object"&&h&&P(Kn,h))return h}return new qn(false)};var Jn=r.String;var Qn=function(e){if(Un(e)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return Jn(e)};var Zn=function(e,t){return e===undefined?arguments.length<2?"":t:Qn(e)};var ei=!s((function(){var e=Error("a");if(!("stack"in e))return true;Object.defineProperty(e,"stack",p(1,7));return e.stack!==7}));var ti=ye("toStringTag");var ni=r.Error;var ii=[].push;var ri=function e(t,n){var i=arguments.length>2?arguments[2]:undefined;var r=P(si,this);var s;if(Qt){s=Qt(new ni(undefined),r?qt(this):si)}else{s=r?this:pn(si);je(s,ti,"Error")}je(s,"message",Zn(n,""));if(ei)je(s,"stack",_n(s.stack,1));xn(s,i);var o=[];Yn(t,ii,{that:o});je(s,"errors",o);return s};if(Qt)Qt(ri,ni);else Lt(ri,ni);var si=ri.prototype=pn(ni.prototype,{constructor:p(1,ri),message:p(1,""),name:p(1,"AggregateError")});$t({global:true},{AggregateError:ri});var oi=ye("unscopables");var ai=Array.prototype;if(ai[oi]==undefined){He.f(ai,oi,{configurable:true,value:pn(null)})}var li=function(e){ai[oi][e]=true};$t({target:"Array",proto:true},{at:function e(t){var n=ae(this);var i=wt(n);var r=pt(t);var s=r>=0?r:i+r;return s<0||s>=i?undefined:n[s]}});li("at");var ui=Array.isArray||function e(t){return I(t)=="Array"};var ci=b([].reverse);var fi=[1,2];$t({target:"Array",proto:true,forced:String(fi)===String(fi.reverse())},{reverse:function e(){if(ui(this))this.length=this.length;return ci(this)}});var di=typeof ArrayBuffer!="undefined"&&typeof DataView!="undefined";var hi=function(e,t,n){for(var i in t)ft(e,i,t[i],n);return e};var pi=r.TypeError;var mi=function(e,t){if(P(t,e))return e;throw pi("Incorrect invocation")};var gi=r.RangeError;var vi=function(e){if(e===undefined)return 0;var t=pt(e);var n=bt(t);if(t!==n)throw gi("Wrong length or index");return n};var yi=r.Array;var bi=Math.abs;var wi=Math.pow;var Si=Math.floor;var Ii=Math.log;var ki=Math.LN2;var Ci=function(e,t,n){var i=yi(n);var r=n*8-t-1;var s=(1<<r)-1;var o=s>>1;var a=t===23?wi(2,-24)-wi(2,-77):0;var l=e<0||e===0&&1/e<0?1:0;var u=0;var c,f,d;e=bi(e);if(e!=e||e===Infinity){f=e!=e?1:0;c=s}else{c=Si(Ii(e)/ki);d=wi(2,-c);if(e*d<1){c--;d*=2}if(c+o>=1){e+=a/d}else{e+=a*wi(2,1-o)}if(e*d>=2){c++;d/=2}if(c+o>=s){f=0;c=s}else if(c+o>=1){f=(e*d-1)*wi(2,t);c=c+o}else{f=e*wi(2,o-1)*wi(2,t);c=0}}while(t>=8){i[u++]=f&255;f/=256;t-=8}c=c<<t|f;r+=t;while(r>0){i[u++]=c&255;c/=256;r-=8}i[--u]|=l*128;return i};var Ei=function(e,t){var n=e.length;var i=n*8-t-1;var r=(1<<i)-1;var s=r>>1;var o=i-7;var a=n-1;var l=e[a--];var u=l&127;var c;l>>=7;while(o>0){u=u*256+e[a--];o-=8}c=u&(1<<-o)-1;u>>=-o;o+=t;while(o>0){c=c*256+e[a--];o-=8}if(u===0){u=1-s}else if(u===r){return c?NaN:l?-Infinity:Infinity}else{c=c+wi(2,t);u=u-s}return(l?-1:1)*c*wi(2,u-t)};var _i={pack:Ci,unpack:Ei};var xi=function e(t){var n=ae(this);var i=wt(n);var r=arguments.length;var s=vt(r>1?arguments[1]:undefined,i);var o=r>2?arguments[2]:undefined;var a=o===undefined?i:vt(o,i);while(a>s)n[s++]=t;return n};var Ti=He.f;var Oi=ye("toStringTag");var Mi=function(e,t,n){if(e&&!ue(e=n?e:e.prototype,Oi)){Ti(e,Oi,{configurable:true,value:t})}};var Di=Ot.f;var Ai=He.f;var Pi=ct.PROPER;var Li=ct.CONFIGURABLE;var Ri=rt.get;var Hi=rt.set;var ji="ArrayBuffer";var Ni="DataView";var Bi="prototype";var Fi="Wrong length";var Ui="Wrong index";var Wi=r[ji];var $i=Wi;var Vi=$i&&$i[Bi];var Gi=r[Ni];var zi=Gi&&Gi[Bi];var Xi=Object.prototype;var qi=r.Array;var Ki=r.RangeError;var Yi=b(xi);var Ji=b([].reverse);var Qi=_i.pack;var Zi=_i.unpack;var er=function(e){return[e&255]};var tr=function(e){return[e&255,e>>8&255]};var nr=function(e){return[e&255,e>>8&255,e>>16&255,e>>24&255]};var ir=function(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]};var rr=function(e){return Qi(e,23,4)};var sr=function(e){return Qi(e,52,8)};var or=function(e,t){Ai(e[Bi],t,{get:function(){return Ri(this)[t]}})};var ar=function(e,t,n,i){var r=vi(n);var s=Ri(e);if(r+t>s.byteLength)throw Ki(Ui);var o=Ri(s.buffer).bytes;var a=r+s.byteOffset;var l=yn(o,a,a+t);return i?l:Ji(l)};var lr=function(e,t,n,i,r,s){var o=vi(n);var a=Ri(e);if(o+t>a.byteLength)throw Ki(Ui);var l=Ri(a.buffer).bytes;var u=o+a.byteOffset;var c=i(+r);for(var f=0;f<t;f++)l[u+f]=c[s?f:t-f-1]};if(!di){$i=function e(t){mi(this,Vi);var n=vi(t);Hi(this,{bytes:Yi(qi(n),0),byteLength:n});if(!o)this.byteLength=n};Vi=$i[Bi];Gi=function e(t,n,i){mi(this,zi);mi(t,Vi);var r=Ri(t).byteLength;var s=pt(n);if(s<0||s>r)throw Ki("Wrong offset");i=i===undefined?r-s:bt(i);if(s+i>r)throw Ki(Fi);Hi(this,{buffer:t,byteLength:i,byteOffset:s});if(!o){this.buffer=t;this.byteLength=i;this.byteOffset=s}};zi=Gi[Bi];if(o){or($i,"byteLength");or(Gi,"buffer");or(Gi,"byteLength");or(Gi,"byteOffset")}hi(zi,{getInt8:function e(t){return ar(this,1,t)[0]<<24>>24},getUint8:function e(t){return ar(this,1,t)[0]},getInt16:function e(t){var n=ar(this,2,t,arguments.length>1?arguments[1]:undefined);return(n[1]<<8|n[0])<<16>>16},getUint16:function e(t){var n=ar(this,2,t,arguments.length>1?arguments[1]:undefined);return n[1]<<8|n[0]},getInt32:function e(t){return ir(ar(this,4,t,arguments.length>1?arguments[1]:undefined))},getUint32:function e(t){return ir(ar(this,4,t,arguments.length>1?arguments[1]:undefined))>>>0},getFloat32:function e(t){return Zi(ar(this,4,t,arguments.length>1?arguments[1]:undefined),23)},getFloat64:function e(t){return Zi(ar(this,8,t,arguments.length>1?arguments[1]:undefined),52)},setInt8:function e(t,n){lr(this,1,t,er,n)},setUint8:function e(t,n){lr(this,1,t,er,n)},setInt16:function e(t,n){lr(this,2,t,tr,n,arguments.length>2?arguments[2]:undefined)},setUint16:function e(t,n){lr(this,2,t,tr,n,arguments.length>2?arguments[2]:undefined)},setInt32:function e(t,n){lr(this,4,t,nr,n,arguments.length>2?arguments[2]:undefined)},setUint32:function e(t,n){lr(this,4,t,nr,n,arguments.length>2?arguments[2]:undefined)},setFloat32:function e(t,n){lr(this,4,t,rr,n,arguments.length>2?arguments[2]:undefined)},setFloat64:function e(t,n){lr(this,8,t,sr,n,arguments.length>2?arguments[2]:undefined)}})}else{var ur=Pi&&Wi.name!==ji;if(!s((function(){Wi(1)}))||!s((function(){new Wi(-1)}))||s((function(){new Wi;new Wi(1.5);new Wi(NaN);return ur&&!Li}))){$i=function e(t){mi(this,Vi);return new Wi(vi(t))};$i[Bi]=Vi;for(var cr=Di(Wi),fr=0,dr;cr.length>fr;){if(!((dr=cr[fr++])in $i)){je($i,dr,Wi[dr])}}Vi.constructor=$i}else if(ur&&Li){je(Wi,"name",ji)}if(Qt&&qt(zi)!==Xi){Qt(zi,Xi)}var hr=new Gi(new $i(2));var pr=b(zi.setInt8);hr.setInt8(0,2147483648);hr.setInt8(1,2147483649);if(hr.getInt8(0)||!hr.getInt8(1))hi(zi,{setInt8:function e(t,n){pr(this,t,n<<24>>24)},setUint8:function e(t,n){pr(this,t,n<<24>>24)}},{unsafe:true})}Mi($i,ji);Mi(Gi,Ni);var mr={ArrayBuffer:$i,DataView:Gi};var gr=function(){};var vr=[];var yr=A("Reflect","construct");var br=/^\s*(?:class|function)\b/;var wr=b(br.exec);var Sr=!br.exec(gr);var Ir=function(e){if(!O(e))return false;try{yr(gr,vr,e);return true}catch(e){return false}};var kr=function(e){if(!O(e))return false;switch(Un(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return false}return Sr||!!wr(br,Be(e))};var Cr=!yr||s((function(){var e;return Ir(Ir.call)||!Ir(Object)||!Ir((function(){e=true}))||e}))?kr:Ir;var Er=r.TypeError;var _r=function(e){if(Cr(e))return e;throw Er(X(e)+" is not a constructor")};var xr=ye("species");var Tr=function(e,t){var n=Ae(e).constructor;var i;return n===undefined||(i=Ae(n)[xr])==undefined?t:_r(i)};var Or=mr.ArrayBuffer;var Mr=mr.DataView;var Dr=Mr.prototype;var Ar=b(Or.prototype.slice);var Pr=b(Dr.getUint8);var Lr=b(Dr.setUint8);var Rr=s((function(){return!new Or(2).slice(1,undefined).byteLength}));$t({target:"ArrayBuffer",proto:true,unsafe:true,forced:Rr},{slice:function e(t,n){if(Ar&&n===undefined){return Ar(Ae(this),t)}var i=Ae(this).byteLength;var r=vt(t,i);var s=vt(n===undefined?i:n,i);var o=new(Tr(this,Or))(bt(s-r));var a=new Mr(this);var l=new Mr(o);var u=0;while(r<s){Lr(l,u++,Pr(a,r++))}return o}});$t({target:"Object",stat:true},{fromEntries:function e(t){var n={};Yn(t,(function(e,t){mn(n,e,t)}),{AS_ENTRIES:true});return n}});$t({target:"Object",stat:true},{hasOwn:ue});var Hr=function(e){var t,n;this.promise=new e((function(e,i){if(t!==undefined||n!==undefined)throw TypeError("Bad Promise constructor");t=e;n=i}));this.resolve=K(t);this.reject=K(n)};var jr=function(e){return new Hr(e)};var Nr={f:jr};var Br=function(e){try{return{error:false,value:e()}}catch(e){return{error:true,value:e}}};$t({target:"Promise",stat:true},{allSettled:function e(t){var n=this;var i=Nr.f(n);var r=i.resolve;var s=i.reject;var o=Br((function(){var e=K(n.resolve);var i=[];var s=0;var o=1;Yn(t,(function(t){var a=s++;var u=false;o++;l(e,n,t).then((function(e){if(u)return;u=true;i[a]={status:"fulfilled",value:e};--o||r(i)}),(function(e){if(u)return;u=true;i[a]={status:"rejected",reason:e};--o||r(i)}))}));--o||r(i)}));if(o.error)s(o.value);return i.promise}});var Fr="No one promise resolved";$t({target:"Promise",stat:true},{any:function e(t){var n=this;var i=A("AggregateError");var r=Nr.f(n);var s=r.resolve;var o=r.reject;var a=Br((function(){var e=K(n.resolve);var r=[];var a=0;var u=1;var c=false;Yn(t,(function(t){var f=a++;var d=false;u++;l(e,n,t).then((function(e){if(d||c)return;c=true;s(e)}),(function(e){if(d||c)return;d=true;r[f]=e;--u||o(new i(r,Fr))}))}));--u||o(new i(r,Fr))}));if(a.error)o(a.value);return r.promise}});var Ur=r.Promise;var Wr=function(e,t){Ae(e);if(M(t)&&t.constructor===e)return t;var n=Nr.f(e);var i=n.resolve;i(t);return n.promise};var $r=!!Ur&&s((function(){Ur.prototype["finally"].call({then:function(){}},(function(){}))}));$t({target:"Promise",proto:true,real:true,forced:$r},{finally:function(e){var t=Tr(this,A("Promise"));var n=O(e);return this.then(n?function(n){return Wr(t,e()).then((function(){return n}))}:e,n?function(n){return Wr(t,e()).then((function(){throw n}))}:e)}});if(!Z&&O(Ur)){var Vr=A("Promise").prototype["finally"];if(Ur.prototype["finally"]!==Vr){ft(Ur.prototype,"finally",Vr,{unsafe:true})}}var Gr=ye("iterator");var zr=false;var Xr,qr,Kr;if([].keys){Kr=[].keys();if(!("next"in Kr))zr=true;else{qr=qt(qt(Kr));if(qr!==Object.prototype)Xr=qr}}var Yr=Xr==undefined||s((function(){var e={};return Xr[Gr].call(e)!==e}));if(Yr)Xr={};if(!O(Xr[Gr])){ft(Xr,Gr,(function(){return this}))}var Jr={IteratorPrototype:Xr,BUGGY_SAFARI_ITERATORS:zr};var Qr=Jr.IteratorPrototype;var Zr=function(){return this};var es=function(e,t,n){var i=t+" Iterator";e.prototype=pn(Qr,{next:p(1,n)});Mi(e,i,false,true);Mn[i]=Zr;return e};var ts=ye("match");var ns=function(e){var t;return M(e)&&((t=e[ts])!==undefined?!!t:I(e)=="RegExp")};var is=function(){var e=Ae(this);var t="";if(e.global)t+="g";if(e.ignoreCase)t+="i";if(e.multiline)t+="m";if(e.dotAll)t+="s";if(e.unicode)t+="u";if(e.sticky)t+="y";return t};var rs=b("".charAt);var ss=b("".charCodeAt);var os=b("".slice);var as=function(e){return function(t,n){var i=Qn(x(t));var r=pt(n);var s=i.length;var o,a;if(r<0||r>=s)return e?"":undefined;o=ss(i,r);return o<55296||o>56319||r+1===s||(a=ss(i,r+1))<56320||a>57343?e?rs(i,r):o:e?os(i,r,r+2):(o-55296<<10)+(a-56320)+65536}};var ls={codeAt:as(false),charAt:as(true)};var us=ls.charAt;var cs=function(e,t,n){return t+(n?us(e,t).length:1)};var fs=r.RegExp;var ds=s((function(){var e=fs("a","y");e.lastIndex=2;return e.exec("abcd")!=null}));var hs=ds||s((function(){return!fs("a","y").sticky}));var ps=ds||s((function(){var e=fs("^r","gy");e.lastIndex=2;return e.exec("str")!=null}));var ms={BROKEN_CARET:ps,MISSED_STICKY:hs,UNSUPPORTED_Y:ds};var gs=r.RegExp;var vs=s((function(){var e=gs(".","s");return!(e.dotAll&&e.exec("\n")&&e.flags==="s")}));var ys=r.RegExp;var bs=s((function(){var e=ys("(?<a>b)","g");return e.exec("b").groups.a!=="b"||"b".replace(e,"$<a>c")!=="bc"}));var ws=rt.get;var Ss=se("native-string-replace",String.prototype.replace);var Is=RegExp.prototype.exec;var ks=Is;var Cs=b("".charAt);var Es=b("".indexOf);var _s=b("".replace);var xs=b("".slice);var Ts=function(){var e=/a/;var t=/b*/g;l(Is,e,"a");l(Is,t,"a");return e.lastIndex!==0||t.lastIndex!==0}();var Os=ms.BROKEN_CARET;var Ms=/()??/.exec("")[1]!==undefined;var Ds=Ts||Ms||Os||vs||bs;if(Ds){ks=function e(t){var n=this;var i=ws(n);var r=Qn(t);var s=i.raw;var o,a,u,c,f,d,h;if(s){s.lastIndex=n.lastIndex;o=l(ks,s,r);n.lastIndex=s.lastIndex;return o}var p=i.groups;var m=Os&&n.sticky;var g=l(is,n);var v=n.source;var y=0;var b=r;if(m){g=_s(g,"y","");if(Es(g,"g")===-1){g+="g"}b=xs(r,n.lastIndex);if(n.lastIndex>0&&(!n.multiline||n.multiline&&Cs(r,n.lastIndex-1)!=="\n")){v="(?: "+v+")";b=" "+b;y++}a=new RegExp("^(?:"+v+")",g)}if(Ms){a=new RegExp("^"+v+"$(?!\\s)",g)}if(Ts)u=n.lastIndex;c=l(Is,m?a:n,b);if(m){if(c){c.input=xs(c.input,y);c[0]=xs(c[0],y);c.index=n.lastIndex;n.lastIndex+=c[0].length}else n.lastIndex=0}else if(Ts&&c){n.lastIndex=n.global?c.index+c[0].length:u}if(Ms&&c&&c.length>1){l(Ss,c[0],a,(function(){for(f=1;f<arguments.length-2;f++){if(arguments[f]===undefined)c[f]=undefined}}))}if(c&&p){c.groups=d=pn(null);for(f=0;f<p.length;f++){h=p[f];d[h[0]]=c[h[1]]}}return c}}var As=ks;var Ps=r.TypeError;var Ls=function(e,t){var n=e.exec;if(O(n)){var i=l(n,e,t);if(i!==null)Ae(i);return i}if(I(e)==="RegExp")return l(As,e,t);throw Ps("RegExp#exec called on incompatible receiver")};var Rs=ye("matchAll");var Hs="RegExp String";var js=Hs+" Iterator";var Ns=rt.set;var Bs=rt.getterFor(js);var Fs=RegExp.prototype;var Us=r.TypeError;var Ws=b(is);var $s=b("".indexOf);var Vs=b("".matchAll);var Gs=!!Vs&&!s((function(){Vs("a",/./)}));var zs=es((function e(t,n,i,r){Ns(this,{type:js,regexp:t,string:n,global:i,unicode:r,done:false})}),Hs,(function e(){var t=Bs(this);if(t.done)return{value:undefined,done:true};var n=t.regexp;var i=t.string;var r=Ls(n,i);if(r===null)return{value:undefined,done:t.done=true};if(t.global){if(Qn(r[0])==="")n.lastIndex=cs(i,bt(n.lastIndex),t.unicode);return{value:r,done:false}}t.done=true;return{value:r,done:false}}));var Xs=function(e){var t=Ae(this);var n=Qn(e);var i,r,s,o,a,l;i=Tr(t,RegExp);r=t.flags;if(r===undefined&&P(Fs,t)&&!("flags"in Fs)){r=Ws(t)}s=r===undefined?"":Qn(r);o=new i(i===RegExp?t.source:t,s);a=!!~$s(s,"g");l=!!~$s(s,"u");o.lastIndex=bt(t.lastIndex);return new zs(o,n,a,l)};$t({target:"String",proto:true,forced:Gs},{matchAll:function e(t){var n=x(this);var i,r,s,o;if(t!=null){if(ns(t)){i=Qn(x("flags"in Fs?t.flags:Ws(t)));if(!~$s(i,"g"))throw Us("`.matchAll` does not allow non-global regexes")}if(Gs)return Vs(n,t);s=Y(t,Rs);if(s===undefined&&Z&&I(t)=="RegExp")s=Xs;if(s)return l(s,t,n)}else if(Gs)return Vs(n,t);r=Qn(n);o=new RegExp(t,"g");return Z?l(Xs,o,r):o[Rs](r)}});Z||Rs in Fs||ft(Fs,Rs,Xs);var qs=Math.floor;var Ks=b("".charAt);var Ys=b("".replace);var Js=b("".slice);var Qs=/\$([$&'`]|\d{1,2}|<[^>]*>)/g;var Zs=/\$([$&'`]|\d{1,2})/g;var eo=function(e,t,n,i,r,s){var o=n+e.length;var a=i.length;var l=Zs;if(r!==undefined){r=ae(r);l=Qs}return Ys(s,l,(function(s,l){var u;switch(Ks(l,0)){case"$":return"$";case"&":return e;case"`":return Js(t,0,n);case"'":return Js(t,o);case"<":u=r[Js(l,1,-1)];break;default:var c=+l;if(c===0)return s;if(c>a){var f=qs(c/10);if(f===0)return s;if(f<=a)return i[f-1]===undefined?Ks(l,1):i[f-1]+Ks(l,1);return s}u=i[c-1]}return u===undefined?"":u}))};var to=ye("replace");var no=RegExp.prototype;var io=r.TypeError;var ro=b(is);var so=b("".indexOf);var oo=b("".replace);var ao=b("".slice);var lo=Math.max;var uo=function(e,t,n){if(n>e.length)return-1;if(t==="")return n;return so(e,t,n)};$t({target:"String",proto:true},{replaceAll:function e(t,n){var i=x(this);var r,s,o,a,u,c,f,d,h;var p=0;var m=0;var g="";if(t!=null){r=ns(t);if(r){s=Qn(x("flags"in no?t.flags:ro(t)));if(!~so(s,"g"))throw io("`.replaceAll` does not allow non-global regexes")}o=Y(t,to);if(o){return l(o,t,i,n)}else if(Z&&r){return oo(Qn(i),t,n)}}a=Qn(i);u=Qn(t);c=O(n);if(!c)n=Qn(n);f=u.length;d=lo(1,f);p=uo(a,u,0);while(p!==-1){h=c?Qn(n(u,p,a)):eo(u,a,p,[],undefined,n);g+=ao(a,m,p)+h;m=p+f;p=uo(a,u,p+d)}if(m<a.length){g+=ao(a,m)}return g}});var co=ye("iterator");var fo=false;var ho=function(e,t){if(!t&&!fo)return false;var n=false;try{var i={};i[co]=function(){return{next:function(){return{done:n=true}}}};e(i)}catch(e){}return n};var po=He.f;var mo=r.Int8Array;var go=mo&&mo.prototype;var vo=r.Uint8ClampedArray;var yo=vo&&vo.prototype;var bo=mo&&qt(mo);var wo=go&&qt(go);var So=Object.prototype;var Io=r.TypeError;var ko=ye("toStringTag");var Co=he("TYPED_ARRAY_TAG");var Eo=he("TYPED_ARRAY_CONSTRUCTOR");var _o=di&&!!Qt&&Un(r.opera)!=="Opera";var xo=false;var To,Oo,Mo;var Do={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8};var Ao={BigInt64Array:8,BigUint64Array:8};var Po=function e(t){if(!M(t))return false;var n=Un(t);return n==="DataView"||ue(Do,n)||ue(Ao,n)};var Lo=function(e){if(!M(e))return false;var t=Un(e);return ue(Do,t)||ue(Ao,t)};var Ro=function(e){if(Lo(e))return e;throw Io("Target is not a typed array")};var Ho=function(e){if(O(e)&&(!Qt||P(bo,e)))return e;throw Io(X(e)+" is not a typed array constructor")};var jo=function(e,t,n){if(!o)return;if(n)for(var i in Do){var s=r[i];if(s&&ue(s.prototype,e))try{delete s.prototype[e]}catch(e){}}if(!wo[e]||n){ft(wo,e,n?t:_o&&go[e]||t)}};var No=function(e,t,n){var i,s;if(!o)return;if(Qt){if(n)for(i in Do){s=r[i];if(s&&ue(s,e))try{delete s[e]}catch(e){}}if(!bo[e]||n){try{return ft(bo,e,n?t:_o&&bo[e]||t)}catch(e){}}else return}for(i in Do){s=r[i];if(s&&(!s[e]||n)){ft(s,e,t)}}};for(To in Do){Oo=r[To];Mo=Oo&&Oo.prototype;if(Mo)je(Mo,Eo,Oo);else _o=false}for(To in Ao){Oo=r[To];Mo=Oo&&Oo.prototype;if(Mo)je(Mo,Eo,Oo)}if(!_o||!O(bo)||bo===Function.prototype){bo=function e(){throw Io("Incorrect invocation")};if(_o)for(To in Do){if(r[To])Qt(r[To],bo)}}if(!_o||!wo||wo===So){wo=bo.prototype;if(_o)for(To in Do){if(r[To])Qt(r[To].prototype,wo)}}if(_o&&qt(yo)!==wo){Qt(yo,wo)}if(o&&!ue(wo,ko)){xo=true;po(wo,ko,{get:function(){return M(this)?this[Co]:undefined}});for(To in Do)if(r[To]){je(r[To],Co,To)}}var Bo={NATIVE_ARRAY_BUFFER_VIEWS:_o,TYPED_ARRAY_CONSTRUCTOR:Eo,TYPED_ARRAY_TAG:xo&&Co,aTypedArray:Ro,aTypedArrayConstructor:Ho,exportTypedArrayMethod:jo,exportTypedArrayStaticMethod:No,isView:Po,isTypedArray:Lo,TypedArray:bo,TypedArrayPrototype:wo};var Fo=Bo.NATIVE_ARRAY_BUFFER_VIEWS;var Uo=r.ArrayBuffer;var Wo=r.Int8Array;var $o=!Fo||!s((function(){Wo(1)}))||!s((function(){new Wo(-1)}))||!ho((function(e){new Wo;new Wo(null);new Wo(1.5);new Wo(e)}),true)||s((function(){return new Wo(new Uo(2),1,undefined).length!==1}));var Vo=Math.floor;var Go=Number.isInteger||function e(t){return!M(t)&&isFinite(t)&&Vo(t)===t};var zo=r.RangeError;var Xo=function(e){var t=pt(e);if(t<0)throw zo("The argument can't be less than 0");return t};var qo=r.RangeError;var Ko=function(e,t){var n=Xo(e);if(n%t)throw qo("Wrong offset");return n};var Yo=Bo.aTypedArrayConstructor;var Jo=function e(t){var n=_r(this);var i=ae(t);var r=arguments.length;var s=r>1?arguments[1]:undefined;var o=s!==undefined;var a=$n(i);var u,c,f,d,h,p;if(a&&!Pn(a)){h=Gn(i,a);p=h.next;i=[];while(!(d=l(p,h)).done){i.push(d.value)}}if(o&&r>2){s=On(s,arguments[2])}c=wt(i);f=new(Yo(n))(c);for(u=0;c>u;u++){f[u]=o?s(i[u],u):i[u]}return f};var Qo=ye("species");var Zo=r.Array;var ea=function(e){var t;if(ui(e)){t=e.constructor;if(Cr(t)&&(t===Zo||ui(t.prototype)))t=undefined;else if(M(t)){t=t[Qo];if(t===null)t=undefined}}return t===undefined?Zo:t};var ta=function(e,t){return new(ea(e))(t===0?0:t)};var na=b([].push);var ia=function(e){var t=e==1;var n=e==2;var i=e==3;var r=e==4;var s=e==6;var o=e==7;var a=e==5||s;return function(l,u,c,f){var d=ae(l);var h=E(d);var p=On(u,c);var m=wt(h);var g=0;var v=f||ta;var y=t?v(l,m):n||o?v(l,0):undefined;var b,w;for(;m>g;g++)if(a||g in h){b=h[g];w=p(b,g,d);if(e){if(t)y[g]=w;else if(w)switch(e){case 3:return true;case 5:return b;case 6:return g;case 2:na(y,b)}else switch(e){case 4:return false;case 7:na(y,b)}}}return s?-1:i||r?r:y}};var ra={forEach:ia(0),map:ia(1),filter:ia(2),some:ia(3),every:ia(4),find:ia(5),findIndex:ia(6),filterReject:ia(7)};var sa=ye("species");var oa=function(e){var t=A(e);var n=He.f;if(o&&t&&!t[sa]){n(t,sa,{configurable:true,get:function(){return this}})}};var aa=function(e,t,n){var i,r;if(Qt&&O(i=t.constructor)&&i!==n&&M(r=i.prototype)&&r!==n.prototype)Qt(e,r);return e};var la=n((function(e){var t=Ot.f;var n=ra.forEach;var i=rt.get;var s=rt.set;var a=He.f;var u=Oe.f;var c=Math.round;var f=r.RangeError;var d=mr.ArrayBuffer;var h=d.prototype;var m=mr.DataView;var g=Bo.NATIVE_ARRAY_BUFFER_VIEWS;var v=Bo.TYPED_ARRAY_CONSTRUCTOR;var y=Bo.TYPED_ARRAY_TAG;var b=Bo.TypedArray;var w=Bo.TypedArrayPrototype;var S=Bo.aTypedArrayConstructor;var I=Bo.isTypedArray;var k="BYTES_PER_ELEMENT";var C="Wrong length";var E=function(e,t){S(e);var n=0;var i=t.length;var r=new e(i);while(i>n)r[n]=t[n++];return r};var _=function(e,t){a(e,t,{get:function(){return i(this)[t]}})};var x=function(e){var t;return P(h,e)||(t=Un(e))=="ArrayBuffer"||t=="SharedArrayBuffer"};var T=function(e,t){return I(e)&&!G(t)&&t in e&&Go(+t)&&t>=0};var O=function e(t,n){n=Ie(n);return T(t,n)?p(2,t[n]):u(t,n)};var D=function e(t,n,i){n=Ie(n);if(T(t,n)&&M(i)&&ue(i,"value")&&!ue(i,"get")&&!ue(i,"set")&&!i.configurable&&(!ue(i,"writable")||i.writable)&&(!ue(i,"enumerable")||i.enumerable)){t[n]=i.value;return t}return a(t,n,i)};if(o){if(!g){Oe.f=O;He.f=D;_(w,"buffer");_(w,"byteOffset");_(w,"byteLength");_(w,"length")}$t({target:"Object",stat:true,forced:!g},{getOwnPropertyDescriptor:O,defineProperty:D});e.exports=function(e,o,u){var h=e.match(/\d+$/)[0]/8;var p=e+(u?"Clamped":"")+"Array";var S="get"+e;var _="set"+e;var T=r[p];var O=T;var D=O&&O.prototype;var A={};var P=function(e,t){var n=i(e);return n.view[S](t*h+n.byteOffset,true)};var L=function(e,t,n){var r=i(e);if(u)n=(n=c(n))<0?0:n>255?255:n&255;r.view[_](t*h+r.byteOffset,n,true)};var R=function(e,t){a(e,t,{get:function(){return P(this,t)},set:function(e){return L(this,t,e)},enumerable:true})};if(!g){O=o((function(e,t,n,i){mi(e,D);var r=0;var o=0;var a,u,c;if(!M(t)){c=vi(t);u=c*h;a=new d(u)}else if(x(t)){a=t;o=Ko(n,h);var p=t.byteLength;if(i===undefined){if(p%h)throw f(C);u=p-o;if(u<0)throw f(C)}else{u=bt(i)*h;if(u+o>p)throw f(C)}c=u/h}else if(I(t)){return E(O,t)}else{return l(Jo,O,t)}s(e,{buffer:a,byteOffset:o,byteLength:u,length:c,view:new m(a)});while(r<c)R(e,r++)}));if(Qt)Qt(O,b);D=O.prototype=pn(w)}else if($o){O=o((function(e,t,n,i){mi(e,D);return aa(function(){if(!M(t))return new T(vi(t));if(x(t))return i!==undefined?new T(t,Ko(n,h),i):n!==undefined?new T(t,Ko(n,h)):new T(t);if(I(t))return E(O,t);return l(Jo,O,t)}(),e,O)}));if(Qt)Qt(O,b);n(t(T),(function(e){if(!(e in O)){je(O,e,T[e])}}));O.prototype=D}if(D.constructor!==O){je(D,"constructor",O)}je(D,v,O);if(y){je(D,y,p)}A[p]=O;$t({global:true,forced:O!=T,sham:!g},A);if(!(k in O)){je(O,k,h)}if(!(k in D)){je(D,k,h)}oa(p)}}else e.exports=function(){}}));la("Float32",(function(e){return function t(n,i,r){return e(this,n,i,r)}}));la("Float64",(function(e){return function t(n,i,r){return e(this,n,i,r)}}));la("Int8",(function(e){return function t(n,i,r){return e(this,n,i,r)}}));la("Int16",(function(e){return function t(n,i,r){return e(this,n,i,r)}}));la("Int32",(function(e){return function t(n,i,r){return e(this,n,i,r)}}));la("Uint8",(function(e){return function t(n,i,r){return e(this,n,i,r)}}));la("Uint8",(function(e){return function t(n,i,r){return e(this,n,i,r)}}),true);la("Uint16",(function(e){return function t(n,i,r){return e(this,n,i,r)}}));la("Uint32",(function(e){return function t(n,i,r){return e(this,n,i,r)}}));var ua=Bo.aTypedArray;var ca=Bo.exportTypedArrayMethod;ca("at",(function e(t){var n=ua(this);var i=wt(n);var r=pt(t);var s=r>=0?r:i+r;return s<0||s>=i?undefined:n[s]}));var fa=Bo.exportTypedArrayStaticMethod;fa("from",Jo,$o);var da=Bo.aTypedArrayConstructor;var ha=Bo.exportTypedArrayStaticMethod;ha("of",(function e(){var t=0;var n=arguments.length;var i=new(da(this))(n);while(n>t)i[t]=arguments[t++];return i}),$o);var pa=Math.floor;var ma=function(e,t){var n=e.length;var i=pa(n/2);return n<8?ga(e,t):va(e,ma(yn(e,0,i),t),ma(yn(e,i),t),t)};var ga=function(e,t){var n=e.length;var i=1;var r,s;while(i<n){s=i;r=e[i];while(s&&t(e[s-1],r)>0){e[s]=e[--s]}if(s!==i++)e[s]=r}return e};var va=function(e,t,n,i){var r=t.length;var s=n.length;var o=0;var a=0;while(o<r||a<s){e[o+a]=o<r&&a<s?i(t[o],n[a])<=0?t[o++]:n[a++]:o<r?t[o++]:n[a++]}return e};var ya=ma;var ba=L.match(/firefox\/(\d+)/i);var wa=!!ba&&+ba[1];var Sa=/MSIE|Trident/.test(L);var Ia=L.match(/AppleWebKit\/(\d+)\./);var ka=!!Ia&&+Ia[1];var Ca=r.Array;var Ea=Bo.aTypedArray;var _a=Bo.exportTypedArrayMethod;var xa=r.Uint16Array;var Ta=xa&&b(xa.prototype.sort);var Oa=!!Ta&&!(s((function(){Ta(new xa(2),null)}))&&s((function(){Ta(new xa(2),{})})));var Ma=!!Ta&&!s((function(){if(U)return U<74;if(wa)return wa<67;if(Sa)return true;if(ka)return ka<602;var e=new xa(516);var t=Ca(516);var n,i;for(n=0;n<516;n++){i=n%4;e[n]=515-n;t[n]=n-2*i+3}Ta(e,(function(e,t){return(e/4|0)-(t/4|0)}));for(n=0;n<516;n++){if(e[n]!==t[n])return true}}));var Da=function(e){return function(t,n){if(e!==undefined)return+e(t,n)||0;if(n!==n)return-1;if(t!==t)return 1;if(t===0&&n===0)return 1/t>0&&1/n<0?1:-1;return t>n}};_a("sort",(function e(t){if(t!==undefined)K(t);if(Ma)return Ta(this,t);return ya(Ea(this),Da(t))}),!Ma||Oa);var Aa={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0};var Pa=Ee("span").classList;var La=Pa&&Pa.constructor&&Pa.constructor.prototype;var Ra=La===Object.prototype?undefined:La;var Ha=ct.PROPER;var ja=ct.CONFIGURABLE;var Na=Jr.IteratorPrototype;var Ba=Jr.BUGGY_SAFARI_ITERATORS;var Fa=ye("iterator");var Ua="keys";var Wa="values";var $a="entries";var Va=function(){return this};var Ga=function(e,t,n,i,r,s,o){es(n,t,i);var a=function(e){if(e===r&&h)return h;if(!Ba&&e in f)return f[e];switch(e){case Ua:return function t(){return new n(this,e)};case Wa:return function t(){return new n(this,e)};case $a:return function t(){return new n(this,e)}}return function(){return new n(this)}};var u=t+" Iterator";var c=false;var f=e.prototype;var d=f[Fa]||f["@@iterator"]||r&&f[r];var h=!Ba&&d||a(r);var p=t=="Array"?f.entries||d:d;var m,g,v;if(p){m=qt(p.call(new e));if(m!==Object.prototype&&m.next){if(qt(m)!==Na){if(Qt){Qt(m,Na)}else if(!O(m[Fa])){ft(m,Fa,Va)}}Mi(m,u,true,true)}}if(Ha&&r==Wa&&d&&d.name!==Wa){if(ja){je(f,"name",Wa)}else{c=true;h=function e(){return l(d,this)}}}if(r){g={values:a(Wa),keys:s?h:a(Ua),entries:a($a)};if(o)for(v in g){if(Ba||c||!(v in f)){ft(f,v,g[v])}}else $t({target:t,proto:true,forced:Ba||c},g)}if(f[Fa]!==h){ft(f,Fa,h,{name:r})}Mn[t]=h;return g};var za="Array Iterator";var Xa=rt.set;var qa=rt.getterFor(za);var Ka=Ga(Array,"Array",(function(e,t){Xa(this,{type:za,target:T(e),index:0,kind:t})}),(function(){var e=qa(this);var t=e.target;var n=e.kind;var i=e.index++;if(!t||i>=t.length){e.target=undefined;return{value:undefined,done:true}}if(n=="keys")return{value:i,done:false};if(n=="values")return{value:t[i],done:false};return{value:[i,t[i]],done:false}}),"values");Mn.Arguments=Mn.Array;li("keys");li("values");li("entries");var Ya=ye("iterator");var Ja=ye("toStringTag");var Qa=Ka.values;var Za=function(e,t){if(e){if(e[Ya]!==Qa)try{je(e,Ya,Qa)}catch(t){e[Ya]=Qa}if(!e[Ja]){je(e,Ja,t)}if(Aa[t])for(var n in Ka){if(e[n]!==Ka[n])try{je(e,n,Ka[n])}catch(t){e[n]=Ka[n]}}}};for(var el in Aa){Za(r[el]&&r[el].prototype,el)}Za(Ra,"DOMTokenList");var tl=Function.prototype;var nl=tl.apply;var il=tl.bind;var rl=tl.call;var sl=typeof Reflect=="object"&&Reflect.apply||(il?rl.bind(nl):function(){return rl.apply(nl,arguments)});var ol=b([].slice);var al=/(?:ipad|iphone|ipod).*applewebkit/i.test(L);var ll=I(r.process)=="process";var ul=r.setImmediate;var cl=r.clearImmediate;var fl=r.process;var dl=r.Dispatch;var hl=r.Function;var pl=r.MessageChannel;var ml=r.String;var gl=0;var vl={};var yl="onreadystatechange";var bl,wl,Sl,Il;try{bl=r.location}catch(e){}var kl=function(e){if(ue(vl,e)){var t=vl[e];delete vl[e];t()}};var Cl=function(e){return function(){kl(e)}};var El=function(e){kl(e.data)};var _l=function(e){r.postMessage(ml(e),bl.protocol+"//"+bl.host)};if(!ul||!cl){ul=function e(t){var n=ol(arguments,1);vl[++gl]=function(){sl(O(t)?t:hl(t),undefined,n)};wl(gl);return gl};cl=function e(t){delete vl[t]};if(ll){wl=function(e){fl.nextTick(Cl(e))}}else if(dl&&dl.now){wl=function(e){dl.now(Cl(e))}}else if(pl&&!al){Sl=new pl;Il=Sl.port2;Sl.port1.onmessage=El;wl=On(Il.postMessage,Il)}else if(r.addEventListener&&O(r.postMessage)&&!r.importScripts&&bl&&bl.protocol!=="file:"&&!s(_l)){wl=_l;r.addEventListener("message",El,false)}else if(yl in Ee("script")){wl=function(e){tn.appendChild(Ee("script"))[yl]=function(){tn.removeChild(this);kl(e)}}}else{wl=function(e){setTimeout(Cl(e),0)}}}var xl={set:ul,clear:cl};var Tl=!r.setImmediate||!r.clearImmediate;$t({global:true,bind:true,enumerable:true,forced:Tl},{setImmediate:xl.set,clearImmediate:xl.clear});var Ol=/ipad|iphone|ipod/i.test(L)&&r.Pebble!==undefined;var Ml=/web0s(?!.*chrome)/i.test(L);var Dl=Oe.f;var Al=xl.set;var Pl=r.MutationObserver||r.WebKitMutationObserver;var Ll=r.document;var Rl=r.process;var Hl=r.Promise;var jl=Dl(r,"queueMicrotask");var Nl=jl&&jl.value;var Bl,Fl,Ul,Wl,$l,Vl,Gl,zl;if(!Nl){Bl=function(){var e,t;if(ll&&(e=Rl.domain))e.exit();while(Fl){t=Fl.fn;Fl=Fl.next;try{t()}catch(e){if(Fl)Wl();else Ul=undefined;throw e}}Ul=undefined;if(e)e.enter()};if(!al&&!ll&&!Ml&&Pl&&Ll){$l=true;Vl=Ll.createTextNode("");new Pl(Bl).observe(Vl,{characterData:true});Wl=function(){Vl.data=$l=!$l}}else if(!Ol&&Hl&&Hl.resolve){Gl=Hl.resolve(undefined);Gl.constructor=Hl;zl=On(Gl.then,Gl);Wl=function(){zl(Bl)}}else if(ll){Wl=function(){Rl.nextTick(Bl)}}else{Al=On(Al,r);Wl=function(){Al(Bl)}}}var Xl=Nl||function(e){var t={fn:e,next:undefined};if(Ul)Ul.next=t;if(!Fl){Fl=t;Wl()}Ul=t};var ql=r.process;$t({global:true,enumerable:true,noTargetGet:true},{queueMicrotask:function e(t){var n=ll&&ql.domain;Xl(n?n.bind(t):t)}})})(this.window=this.window||{});if(window._main_polyfill_core){console.warn("main.polyfill.core is loaded more than once on this page")}window._main_polyfill_core=true;(function(e){"use strict";function t(e){return Object.prototype.toString.call(e)}var n=Function.prototype.toString.call(Object);var i=function(){function e(){babelHelpers.classCallCheck(this,e)}babelHelpers.createClass(e,null,[{key:"isString",value:function e(t){return typeof t==="string"}},{key:"isStringFilled",value:function e(t){return this.isString(t)&&t!==""}},{key:"isFunction",value:function e(t){return typeof t==="function"}},{key:"isObject",value:function e(t){return!!t&&(babelHelpers["typeof"](t)==="object"||typeof t==="function")}},{key:"isObjectLike",value:function e(t){return!!t&&babelHelpers["typeof"](t)==="object"}},{key:"isPlainObject",value:function i(r){if(!e.isObjectLike(r)||t(r)!=="[object Object]"){return false}var s=Object.getPrototypeOf(r);if(s===null){return true}var o=s.hasOwnProperty("constructor")&&s.constructor;return typeof o==="function"&&Function.prototype.toString.call(o)===n}},{key:"isBoolean",value:function e(t){return t===true||t===false}},{key:"isNumber",value:function e(t){return!Number.isNaN(t)&&typeof t==="number"}},{key:"isInteger",value:function t(n){return e.isNumber(n)&&n%1===0}},{key:"isFloat",value:function t(n){return e.isNumber(n)&&!e.isInteger(n)}},{key:"isNil",value:function e(t){return t===null||t===undefined}},{key:"isArray",value:function t(n){return!e.isNil(n)&&Array.isArray(n)}},{key:"isArrayFilled",value:function e(t){return this.isArray(t)&&t.length>0}},{key:"isArrayLike",value:function t(n){return!e.isNil(n)&&!e.isFunction(n)&&n.length>-1&&n.length<=Number.MAX_SAFE_INTEGER}},{key:"isDate",value:function n(i){return e.isObjectLike(i)&&t(i)==="[object Date]"}},{key:"isDomNode",value:function t(n){return e.isObjectLike(n)&&!e.isPlainObject(n)&&"nodeType"in n}},{key:"isElementNode",value:function t(n){return e.isDomNode(n)&&n.nodeType===Node.ELEMENT_NODE}},{key:"isTextNode",value:function t(n){return e.isDomNode(n)&&n.nodeType===Node.TEXT_NODE}},{key:"isMap",value:function n(i){return e.isObjectLike(i)&&t(i)==="[object Map]"}},{key:"isSet",value:function n(i){return e.isObjectLike(i)&&t(i)==="[object Set]"}},{key:"isWeakMap",value:function n(i){return e.isObjectLike(i)&&t(i)==="[object WeakMap]"}},{key:"isWeakSet",value:function n(i){return e.isObjectLike(i)&&t(i)==="[object WeakSet]"}},{key:"isPrototype",value:function e(t){return(typeof(t&&t.constructor)==="function"&&t.constructor.prototype||Object.prototype)===t}},{key:"isRegExp",value:function n(i){return e.isObjectLike(i)&&t(i)==="[object RegExp]"}},{key:"isNull",value:function e(t){return t===null}},{key:"isUndefined",value:function e(t){return typeof t==="undefined"}},{key:"isArrayBuffer",value:function n(i){return e.isObjectLike(i)&&t(i)==="[object ArrayBuffer]"}},{key:"isTypedArray",value:function n(i){var r=/^\[object (?:Float(?:32|64)|(?:Int|Uint)(?:8|16|32)|Uint8Clamped)]$/;return e.isObjectLike(i)&&r.test(t(i))}},{key:"isBlob",value:function t(n){return e.isObjectLike(n)&&e.isNumber(n.size)&&e.isString(n.type)&&e.isFunction(n.slice)}},{key:"isFile",value:function t(n){return e.isBlob(n)&&e.isString(n.name)&&(e.isNumber(n.lastModified)||e.isObjectLike(n.lastModifiedDate))}},{key:"isFormData",value:function e(t){return t instanceof FormData}}]);return e}();var r=function(){function e(){babelHelpers.classCallCheck(this,e)}babelHelpers.createClass(e,null,[{key:"getClass",value:function e(t){if(i.isString(t)&&!!t){var n=null;var r=window;var s=t.split(".");for(var o=0;o<s.length;o+=1){var a=s[o];if(!r[a]){return null}r=r[a];n=r}return n}if(i.isFunction(t)){return t}return null}},{key:"namespace",value:function e(t){var n=t.split(".");var r=window.BX;if(n[0]==="BX"){n=n.slice(1)}for(var s=0;s<n.length;s+=1){if(i.isUndefined(r[n[s]])){r[n[s]]={}}r=r[n[s]]}return r}}]);return e}();var s=/[&<>'"]/g;var o=/&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34);/g;var a={"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#39;",'"':"&quot;"};var l={"&amp;":"&","&#38;":"&","&lt;":"<","&#60;":"<","&gt;":">","&#62;":">","&apos;":"'","&#39;":"'","&quot;":'"',"&#34;":'"'};var u=function(){function e(){babelHelpers.classCallCheck(this,e)}babelHelpers.createClass(e,null,[{key:"encode",value:function e(t){if(i.isString(t)){return t.replace(s,(function(e){return a[e]}))}return t}},{key:"decode",value:function e(t){if(i.isString(t)){return t.replace(o,(function(e){return l[e]}))}return t}},{key:"getRandom",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:8;return babelHelpers.toConsumableArray(Array(t)).map((function(){return(~~(Math.random()*36)).toString(36)})).join("")}},{key:"toNumber",value:function e(t){var n=Number.parseFloat(t);if(i.isNumber(n)){return n}return 0}},{key:"toInteger",value:function t(n){return e.toNumber(Number.parseInt(n,10))}},{key:"toBoolean",value:function e(t){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];var r=i.isString(t)?t.toLowerCase():t;return["true","y","1",1,true].concat(babelHelpers.toConsumableArray(n)).includes(r)}},{key:"toCamelCase",value:function e(t){if(!i.isStringFilled(t)){return t}var n=/[-_\s]+(.)?/g;if(!n.test(t)){return t.match(/^[A-Z]+$/)?t.toLowerCase():t[0].toLowerCase()+t.slice(1)}t=t.toLowerCase();t=t.replace(n,(function(e,t){return t?t.toUpperCase():""}));return t[0].toLowerCase()+t.substr(1)}},{key:"toPascalCase",value:function e(t){if(!i.isStringFilled(t)){return t}return this.capitalize(this.toCamelCase(t))}},{key:"toKebabCase",value:function e(t){if(!i.isStringFilled(t)){return t}var n=t.match(/[A-Z]{2,}(?=[A-Z][a-z]+[0-9]*|\b)|[A-Z]?[a-z]+[0-9]*|[A-Z]|[0-9]+/g);if(!n){return t}return n.map((function(e){return e.toLowerCase()})).join("-")}},{key:"capitalize",value:function e(t){if(!i.isStringFilled(t)){return t}return t[0].toUpperCase()+t.substr(1)}}]);return e}();var c={mousewheel:["DOMMouseScroll"],bxchange:["change","cut","paste","drop","keyup"],animationend:["animationend","oAnimationEnd","webkitAnimationEnd","MSAnimationEnd"],transitionend:["webkitTransitionEnd","otransitionend","oTransitionEnd","msTransitionEnd","transitionend"],fullscreenchange:["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"],fullscreenerror:["fullscreenerror","webkitfullscreenerror","mozfullscreenerror","MSFullscreenError"]};var f=function(){function e(){babelHelpers.classCallCheck(this,e);babelHelpers.defineProperty(this,"registry",new WeakMap)}babelHelpers.createClass(e,[{key:"set",value:function e(t,n,r){var s=this.get(t);if(!i.isSet(s[n])){s[n]=new Set}s[n].add(r);this.registry.set(t,s)}},{key:"get",value:function e(t){return this.registry.get(t)||{}}},{key:"has",value:function e(t,n,i){if(n&&i){return this.registry.has(t)&&this.registry.get(t)[n].has(i)}return this.registry.has(t)}},{key:"delete",value:function e(t,n,r){if(!i.isDomNode(t)){return}if(i.isString(n)&&i.isFunction(r)){var s=this.registry.get(t);if(i.isPlainObject(s)&&i.isSet(s[n])){s[n]["delete"](r)}return}if(i.isString(n)){var o=this.registry.get(t);if(i.isPlainObject(o)&&i.isSet(o[n])){o[n]=new Set}return}this.registry["delete"](t)}}]);return e}();var d=new f;function h(e){var t=false;try{var n=Object.defineProperty({},e,{get:function e(){t=true;return undefined}});window.addEventListener("test",null,n)}catch(e){}return t}function p(e){if(!i.isPlainObject(e)){return e}return Object.keys(e).reduce((function(t,n){if(h(n)){t[n]=e[n]}return t}),{})}function m(e,t,n,r){if(!i.isObject(e)||!i.isFunction(e.addEventListener)){return}var s=p(r);if(t in c){c[t].forEach((function(i){e.addEventListener(i,n,s);d.set(e,t,n)}));return}e.addEventListener(t,n,s);d.set(e,t,n)}function g(e,t,n,r){if(!i.isObject(e)||!i.isFunction(e.removeEventListener)){return}var s=p(r);if(t in c){c[t].forEach((function(t){e.removeEventListener(t,n,s);d["delete"](e,t,n)}));return}e.removeEventListener(t,n,s);d["delete"](e,t,n)}function v(e,t){var n=d.get(e);Object.keys(n).forEach((function(r){n[r].forEach((function(n){if(!i.isString(t)||t===r){g(e,r,n)}}))}))}function y(e,t,n,i){var r=function r(){g(e,t,r,i);n.apply(void 0,arguments)};m(e,t,r,i)}var b=true;function w(){b=true}function S(){b=false}function I(){return b}function k(){if(I()&&i.isObject(window.console)){if(i.isFunction(window.console.log)){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++){t[n]=arguments[n]}window.console.log("BX.debug: ",t.length>0?t:t[0]);if(t[0]instanceof Error&&t[0].stack){window.console.log("BX.debug error stack trace",t[0].stack)}}if(i.isFunction(window.console.trace)){console.trace()}}}function C(e){if(i.isStringFilled(e)){var t=e.match(/<script type="extension\/settings" \b[^>]*>([\s\S]*?)<\/script>/g);if(i.isArrayFilled(t)){return t.map((function(e){var t=e.match(/data-extension="(.[a-z0-9_.-]+)"/),n=babelHelpers.slicedToArray(t,2),i=n[1];return{extension:i,script:e}}))}}return[]}var E=function(){function e(t){babelHelpers.classCallCheck(this,e);this.config=t.config||{};this.name=t.extension;this.state="scheduled";var n=BX.processHTML(t.html||"");this.inlineScripts=n.SCRIPT.reduce(H,[]);this.externalScripts=n.SCRIPT.reduce(j,[]);this.externalStyles=n.STYLE.reduce(N,[]);this.settingsScripts=C(n.HTML)}babelHelpers.createClass(e,[{key:"load",value:function e(){var t=this;if(this.state==="error"){this.loadPromise=this.loadPromise||Promise.resolve(this);console.warn("Extension",this.name,"not found")}if(!this.loadPromise&&this.state){this.state="load";this.settingsScripts.forEach((function(e){var t=!!document.querySelector('script[data-extension="'.concat(e.extension,'"]'));if(!t){document.body.insertAdjacentHTML("beforeend",e.script)}}));this.inlineScripts.forEach(BX.evalGlobal);this.loadPromise=Promise.all([U(this.externalScripts),U(this.externalStyles)]).then((function(){t.state="loaded";if(i.isPlainObject(t.config)&&t.config.namespace){return r.getClass(t.config.namespace)}return window}))}return this.loadPromise}}]);return e}();var _={};var x="main.bitrix.main.controller.loadext.getextensions";function T(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function O(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?T(Object(n),!0).forEach((function(t){babelHelpers.defineProperty(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):T(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function M(e){return i.isArray(e)?e:[e]}function D(e){return e in _}function A(e){return _[e]}function P(e){return e.every(D)}function L(e){return Promise.all(e.map((function(e){return e.load()})))}function R(e){return e.reduce((function(e,t){if(i.isObject(t)){return O({},t)}return t}),{})}function H(e,t){if(t.isInternal){e.push(t.JS)}return e}function j(e,t){if(!t.isInternal){e.push(t.JS)}return e}function N(e,t){if(i.isString(t)&&t!==""){e.push(t)}return e}function B(e){return new Promise((function(t){BX.ajax.runAction(x,{data:e}).then(t)}))}function F(e){if(e.status!=="success"){e.errors.map(console.warn);return[]}return e.data.map((function(e){var t=A(e.extension);if(t){return t}_[e.extension]=new E(e);return _[e.extension]}))}function U(e){var t=M(e);if(!t.length){return Promise.resolve()}return new Promise((function(e){BX.load(t,e)}))}function W(e){var t=M(e);var n=P(t);if(n){var i=t.map(A);return L(i).then(R)}return B({extension:t}).then(F).then(L).then(R)}var $=["[object Object]","[object Array]","[object RegExp]","[object Arguments]","[object Date]","[object Error]","[object Map]","[object Set]","[object ArrayBuffer]","[object DataView]","[object Float32Array]","[object Float64Array]","[object Int8Array]","[object Int16Array]","[object Int32Array]","[object Uint8Array]","[object Uint16Array]","[object Uint32Array]","[object Uint8ClampedArray]"];function V(e){var n=i.isObjectLike(e)&&$.includes(t(e));return n||i.isDomNode(e)}function G(e,t){if(t.has(e)){return t.get(e)}if(V(e)){if(i.isArray(e)){var n=Array.from(e);t.set(e,n);e.forEach((function(e,i){n[i]=G(e,t)}));return t.get(e)}if(i.isDomNode(e)){return e.cloneNode(true)}if(i.isMap(e)){var r=new Map;t.set(e,r);e.forEach((function(e,n){r.set(G(n,t),G(e,t))}));return r}if(i.isSet(e)){var s=new Set;t.set(e,s);e.forEach((function(e){s.add(G(e,t))}));return s}if(i.isDate(e)){return new Date(e)}if(i.isRegExp(e)){var o=/\w*$/;var a=o.exec(e);var l=new RegExp(e.source);if(a&&i.isArray(a)){l=new RegExp(e.source,a[0])}l.lastIndex=e.lastIndex;return l}var u=Object.getPrototypeOf(e);var c=Object.assign(Object.create(u),e);t.set(e,c);Object.keys(e).forEach((function(n){c[n]=G(e[n],t)}));return c}return e}function z(e){return G(e,new WeakMap)}function X(e,t){return Object.entries(t).reduce((function(e,t){var n=babelHelpers.slicedToArray(t,2),r=n[0],s=n[1];if(!i.isDomNode(e[r])&&i.isObjectLike(e[r])&&i.isObjectLike(s)){e[r]=X(e[r],s);return e}e[r]=s;return e}),e)}function q(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];return function(n,r){var s=e[0];var o=t[0]||"asc";if(i.isUndefined(s)){return 0}var a=n[s];var l=r[s];if(i.isString(a)&&i.isString(l)){a=a.toLowerCase();l=l.toLowerCase()}if(a<l){return o==="asc"?-1:1}if(a>l){return o==="asc"?1:-1}return q(e.slice(1),t.slice(1))(n,r)}}var K=function(){function e(){babelHelpers.classCallCheck(this,e)}babelHelpers.createClass(e,null,[{key:"debounce",value:function e(t){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;var s;return function e(){var o=this;for(var a=arguments.length,l=new Array(a),u=0;u<a;u++){l[u]=arguments[u]}if(i.isNumber(s)){clearTimeout(s)}s=setTimeout((function(){t.apply(r||o,l)}),n)}}},{key:"throttle",value:function e(t){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;var r=0;var s;return function e(){for(var o=arguments.length,a=new Array(o),l=0;l<o;l++){a[l]=arguments[l]}s=true;if(!r){var u=function e(){if(s){t.apply(i||this,a);s=false;r=setTimeout(e,n)}else{r=null}};u()}}}},{key:"html",value:function e(t,n){var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};if(i.isNil(n)&&i.isDomNode(t)){return t.innerHTML}var s=BX.processHTML(n);var o=s.STYLE.reduce(N,[]);var a=s.SCRIPT.reduce(j,[]);var l=s.SCRIPT.reduce(H,[]);if(i.isDomNode(t)){if(r.htmlFirst||!a.length&&!o.length){if(r.useAdjacentHTML){t.insertAdjacentHTML("beforeend",s.HTML)}else{t.innerHTML=s.HTML}}}return Promise.all([U(a),U(o)]).then((function(){if(i.isDomNode(t)&&(a.length>0||o.length>0)){if(r.useAdjacentHTML){t.insertAdjacentHTML("beforeend",s.HTML)}else{t.innerHTML=s.HTML}}l.forEach((function(e){return BX.evalGlobal(e)}));if(i.isFunction(r.callback)){r.callback()}}))}},{key:"merge",value:function e(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++){n[r]=arguments[r]}if(i.isArray(n[0])){n.unshift([])}else if(i.isObject(n[0])){n.unshift({})}return n.reduce((function(e,t){return X(e,t)}),n[0])}},{key:"orderBy",value:function e(t){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:[];var r=q(n,i);return Object.values(t).sort(r)}},{key:"destroy",value:function e(t){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"Object is destroyed";if(i.isObject(t)){var r=function e(){throw new Error(n)};var s=Object.keys(t);var o=function(){var e=Object.getPrototypeOf(t);if(i.isObject(e)){return Object.getOwnPropertyNames(e)}return[]}();var a=babelHelpers.toConsumableArray(new Set([].concat(babelHelpers.toConsumableArray(s),babelHelpers.toConsumableArray(o))));a.filter((function(e){var n=Object.getOwnPropertyDescriptor(t,e);return!/__(.+)__/.test(e)&&(!i.isObject(n)||n.configurable===true)})).forEach((function(e){Object.defineProperty(t,e,{get:r,set:r,configurable:false})}));Object.setPrototypeOf(t,null)}}}]);return e}();babelHelpers.defineProperty(K,"debug",k);babelHelpers.defineProperty(K,"loadExtension",W);babelHelpers.defineProperty(K,"clone",z);var Y=Symbol["for"]("BX.BaseError.isError");var J=function(){function e(t,n,i){babelHelpers.classCallCheck(this,e);this[Y]=true;this.message="";this.code=null;this.customData=null;this.setMessage(t);this.setCode(n);this.setCustomData(i)}babelHelpers.createClass(e,[{key:"getMessage",value:function e(){return this.message}},{key:"setMessage",value:function e(t){if(i.isString(t)){this.message=t}return this}},{key:"getCode",value:function e(){return this.code}},{key:"setCode",value:function e(t){if(i.isStringFilled(t)||t===null){this.code=t}return this}},{key:"getCustomData",value:function e(){return this.customData}},{key:"setCustomData",value:function e(t){if(!i.isUndefined(t)){this.customData=t}return this}},{key:"toString",value:function e(){var t=this.getCode();var n=this.getMessage();if(!i.isStringFilled(t)&&!i.isStringFilled(n)){return""}else if(!i.isStringFilled(t)){return"Error: ".concat(n)}else if(!i.isStringFilled(n)){return t}else{return"".concat(t,": ").concat(n)}}}],[{key:"isError",value:function e(t){return i.isObject(t)&&t[Y]===true}}]);return e}();var Q=function(){function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{data:{}};babelHelpers.classCallCheck(this,e);this.type="";this.data=null;this.target=null;this.compatData=null;this.defaultPrevented=false;this.immediatePropagationStopped=false;this.errors=[];this.setData(t.data);this.setCompatData(t.compatData)}babelHelpers.createClass(e,[{key:"getType",value:function e(){return this.type}},{key:"setType",value:function e(t){if(i.isStringFilled(t)){this.type=t}return this}},{key:"getData",value:function e(){return this.data}},{key:"setData",value:function e(t){if(!i.isUndefined(t)){this.data=t}return this}},{key:"getCompatData",value:function e(){return this.compatData}},{key:"setCompatData",value:function e(t){if(i.isArrayLike(t)){this.compatData=t}return this}},{key:"setTarget",value:function e(t){this.target=t;return this}},{key:"getTarget",value:function e(){return this.target}},{key:"getErrors",value:function e(){return this.errors}},{key:"setError",value:function e(t){if(J.isError(t)){this.errors.push(t)}}},{key:"preventDefault",value:function e(){this.defaultPrevented=true}},{key:"isDefaultPrevented",value:function e(){return this.defaultPrevented}},{key:"stopImmediatePropagation",value:function e(){this.immediatePropagationStopped=true}},{key:"isImmediatePropagationStopped",value:function e(){return this.immediatePropagationStopped}}],[{key:"create",value:function e(t){return new this(t)}}]);return e}();var Z=function(){function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};babelHelpers.classCallCheck(this,e);this.defaultMaxListeners=i.isNumber(t.defaultMaxListeners)?t.defaultMaxListeners:10;this.eventStore=new WeakMap}babelHelpers.createClass(e,[{key:"add",value:function e(t){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var r=this.getRecordScheme();if(i.isNumber(n.maxListeners)){r.maxListeners=n.maxListeners}this.eventStore.set(t,r);return r}},{key:"get",value:function e(t){return this.eventStore.get(t)}},{key:"getOrAdd",value:function e(t){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};return this.get(t)||this.add(t,n)}},{key:"delete",value:function e(t){this.eventStore["delete"](t)}},{key:"getRecordScheme",value:function e(){return{eventsMap:new Map,onceMap:new Map,maxListeners:this.getDefaultMaxListeners(),eventsMaxListeners:new Map}}},{key:"getDefaultMaxListeners",value:function e(){return this.defaultMaxListeners}}]);return e}();var ee=function(){function e(){babelHelpers.classCallCheck(this,e);this.warnings=new Map;this.printDelayed=K.debounce(this.print.bind(this),500)}babelHelpers.createClass(e,[{key:"add",value:function e(t,n,r){var s=this.warnings.get(t);if(!s){s=Object.create(null);this.warnings.set(t,s)}if(!s[n]){s[n]={}}s[n].size=r.size;if(!i.isArray(s[n].errors)){s[n].errors=[]}s[n].errors.push(new Error)}},{key:"print",value:function e(){this.warnings.forEach((function(e){for(var t in e){console.groupCollapsed("Possible BX.Event.EventEmitter memory leak detected. "+e[t].size+' "'+t+'" listeners added. '+"Use emitter.setMaxListeners() to increase limit.");console.dir(e[t].errors);console.groupEnd()}}));this.clear()}},{key:"clear",value:function e(){this.warnings.clear()}},{key:"printDelayed",value:function e(){}}]);return e}();var te=new Z({defaultMaxListeners:10});var ne=new ee;var ie=new Map;var re={GLOBAL_TARGET:"GLOBAL_TARGET"};te.add(re,{maxListeners:25});var se=Symbol["for"]("BX.Event.EventEmitter.isEmitter");var oe=Symbol("namespaceProperty");var ae=Symbol("targetProperty");var le=function(){function e(){babelHelpers.classCallCheck(this,e);this[ae]=null;this[oe]=null;this[se]=true;var t=this;if(Object.getPrototypeOf(this)===e.prototype&&arguments.length>0){if(!i.isObject(arguments.length<=0?undefined:arguments[0])){throw new TypeError('The "target" argument must be an object.')}t=arguments.length<=0?undefined:arguments[0];this.setEventNamespace(arguments.length<=1?undefined:arguments[1])}this[ae]=t}babelHelpers.createClass(e,[{key:"setEventNamespace",value:function e(t){if(i.isStringFilled(t)){this[oe]=t}}},{key:"getEventNamespace",value:function e(){return this[oe]}},{key:"subscribe",value:function t(n,i){e.subscribe(this,n,i);return this}},{key:"subscribeFromOptions",value:function t(n,r,s){var o=this;if(!i.isPlainObject(n)){return}r=i.isPlainObject(r)?e.normalizeAliases(r):{};Object.keys(n).forEach((function(t){var i=e.normalizeListener(n[t]);t=e.normalizeEventName(t);if(r[t]){var a=r[t].eventName;e.subscribe(o,a,i,{compatMode:s!==false})}else{e.subscribe(o,t,i,{compatMode:s===true})}}))}},{key:"subscribeOnce",value:function t(n,i){e.subscribeOnce(this,n,i);return this}},{key:"unsubscribe",value:function t(n,i){e.unsubscribe(this,n,i);return this}},{key:"unsubscribeAll",value:function t(n){e.unsubscribeAll(this,n)}},{key:"emit",value:function t(n,i){if(this.getEventNamespace()===null){console.warn("The instance of BX.Event.EventEmitter is supposed to have an event namespace. "+"Use emitter.setEventNamespace() to make events more unique.")}e.emit(this,n,i);return this}},{key:"emitAsync",value:function t(n,i){if(this.getEventNamespace()===null){console.warn("The instance of BX.Event.EventEmitter is supposed to have an event namespace. "+"Use emitter.setEventNamespace() to make events more unique.")}return e.emitAsync(this,n,i)}},{key:"setMaxListeners",value:function t(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++){i[r]=arguments[r]}e.setMaxListeners.apply(e,[this].concat(i));return this}},{key:"getMaxListeners",value:function t(n){return e.getMaxListeners(this,n)}},{key:"incrementMaxListeners",value:function t(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++){i[r]=arguments[r]}return e.incrementMaxListeners.apply(e,[this].concat(i))}},{key:"decrementMaxListeners",value:function t(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++){i[r]=arguments[r]}return e.decrementMaxListeners.apply(e,[this].concat(i))}},{key:"getListeners",value:function t(n){return e.getListeners(this,n)}},{key:"getFullEventName",value:function t(n){if(!i.isStringFilled(n)){throw new TypeError('The "eventName" argument must be a string.')}return e.makeFullEventName(this.getEventNamespace(),n)}}],[{key:"makeObservable",value:function t(n,r){if(!i.isObject(n)){throw new TypeError('The "target" argument must be an object.')}if(!i.isStringFilled(r)){throw new TypeError('The "namespace" must be an non-empty string.')}if(e.isEventEmitter(n)){throw new TypeError('The "target" is an event emitter already.')}var s=Object.getPrototypeOf(n);var o=new e;o.setEventNamespace(r);Object.setPrototypeOf(o,s);Object.setPrototypeOf(n,o);Object.getOwnPropertyNames(e.prototype).forEach((function(t){if(["constructor"].includes(t)){return}o[t]=function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++){r[s]=arguments[s]}return e.prototype[t].apply(n,r)}}))}},{key:"subscribe",value:function e(t,n,r,s){if(i.isString(t)){s=r;r=n;n=t;t=this.GLOBAL_TARGET}if(!i.isObject(t)){throw new TypeError('The "target" argument must be an object.')}n=this.normalizeEventName(n);if(!i.isStringFilled(n)){throw new TypeError('The "eventName" argument must be a string.')}r=this.normalizeListener(r);s=i.isPlainObject(s)?s:{};var o=this.resolveEventName(n,t,s.useGlobalNaming===true);var a=te.getOrAdd(t),l=a.eventsMap,u=a.onceMap;var c=u.get(o);var f=l.get(o);if(f&&f.has(r)||c&&c.has(r)){console.error('You cannot subscribe the same "'.concat(o,'" event listener twice.'))}else{if(f){f.set(r,{listener:r,options:s,sort:this.getNextSequenceValue()})}else{f=new Map([[r,{listener:r,options:s,sort:this.getNextSequenceValue()}]]);l.set(o,f)}}var d=this.getMaxListeners(t,n);if(f.size>d){ne.add(t,o,f);ne.printDelayed()}}},{key:"subscribeOnce",value:function e(t,n,r){var s=this;if(i.isString(t)){r=n;n=t;t=this.GLOBAL_TARGET}if(!i.isObject(t)){throw new TypeError('The "target" argument must be an object.')}n=this.normalizeEventName(n);if(!i.isStringFilled(n)){throw new TypeError('The "eventName" argument must be a string.')}r=this.normalizeListener(r);var o=this.resolveEventName(n,t);var a=te.getOrAdd(t),l=a.eventsMap,u=a.onceMap;var c=l.get(o);var f=u.get(o);if(c&&c.has(r)||f&&f.has(r)){console.error('You cannot subscribe the same "'.concat(o,'" event listener twice.'))}else{var d=function e(){s.unsubscribe(t,n,e);f["delete"](r);r.apply(void 0,arguments)};if(f){f.set(r,d)}else{f=new Map([[r,d]]);u.set(o,f)}this.subscribe(t,n,d)}}},{key:"unsubscribe",value:function e(t,n,r,s){if(i.isString(t)){r=n;n=t;t=this.GLOBAL_TARGET}n=this.normalizeEventName(n);if(!i.isStringFilled(n)){throw new TypeError('The "eventName" argument must be a string.')}r=this.normalizeListener(r);s=i.isPlainObject(s)?s:{};var o=this.resolveEventName(n,t,s.useGlobalNaming===true);var a=te.get(t);var l=a&&a.eventsMap.get(o);var u=a&&a.onceMap.get(o);if(l){l["delete"](r)}if(u){var c=u.get(r);if(c){u["delete"](r);l["delete"](c)}}}},{key:"unsubscribeAll",value:function e(t,n,r){if(i.isString(t)){n=t;t=this.GLOBAL_TARGET}if(i.isStringFilled(n)){var s=te.get(t);if(s){r=i.isPlainObject(r)?r:{};var o=this.resolveEventName(n,t,r.useGlobalNaming===true);s.eventsMap["delete"](o);s.onceMap["delete"](o)}}else if(i.isNil(n)){if(t===this.GLOBAL_TARGET){console.error("You cannot unsubscribe all global listeners.")}else{te["delete"](t)}}}},{key:"emit",value:function e(t,n,r,s){if(i.isString(t)){s=r;r=n;n=t;t=this.GLOBAL_TARGET}if(!i.isObject(t)){throw new TypeError('The "target" argument must be an object.')}n=this.normalizeEventName(n);if(!i.isStringFilled(n)){throw new TypeError('The "eventName" argument must be a string.')}s=i.isPlainObject(s)?s:{};var o=this.resolveEventName(n,t,s.useGlobalNaming===true);var a=te.get(this.GLOBAL_TARGET);var l=a&&a.eventsMap.get(o)||new Map;var u=new Set;if(t!==this.GLOBAL_TARGET){var c=te.get(t);u=c&&c.eventsMap.get(o)||new Map}var f=[].concat(babelHelpers.toConsumableArray(l.values()),babelHelpers.toConsumableArray(u.values()));f.sort((function(e,t){return e.sort-t.sort}));var d=this.prepareEvent(t,o,r);var h=[];for(var p=0;p<f.length;p++){if(d.isImmediatePropagationStopped()){break}var m=f[p],g=m.listener,v=m.options;if(l.has(g)||u.has(g)){var y=void 0;if(v.compatMode){var b=[];var w=d.getCompatData();if(w!==null){b=s.cloneData===true?K.clone(w):w}else{b=[d]}var S=i.isUndefined(s.thisArg)?t:s.thisArg;y=g.apply(S,b)}else{y=i.isUndefined(s.thisArg)?g(d):g.call(s.thisArg,d)}h.push(y)}}return h}},{key:"emitAsync",value:function e(t,n,r){if(i.isString(t)){r=n;n=t;t=this.GLOBAL_TARGET}return Promise.all(this.emit(t,n,r))}},{key:"prepareEvent",value:function e(t,n,i){var r=i;if(!(i instanceof Q)){r=new Q;r.setData(i)}r.setTarget(this.isEventEmitter(t)?t[ae]:t);r.setType(n);return r}},{key:"getNextSequenceValue",value:function e(){return this.sequenceValue++}},{key:"setMaxListeners",value:function e(){var t=this.GLOBAL_TARGET;var n=null;var r=undefined;for(var s=arguments.length,o=new Array(s),a=0;a<s;a++){o[a]=arguments[a]}if(o.length===1){r=o[0]}else if(o.length===2){if(i.isString(o[0])){n=o[0];r=o[1]}else{t=o[0];r=o[1]}}else if(o.length>=3){t=o[0];n=o[1];r=o[2]}if(!i.isObject(t)){throw new TypeError('The "target" argument must be an object.')}if(n!==null&&!i.isStringFilled(n)){throw new TypeError('The "eventName" argument must be a string.')}if(!i.isNumber(r)||r<0){throw new TypeError('The value of "count" is out of range. It must be a non-negative number. Received '.concat(r,"."))}var l=te.getOrAdd(t);if(i.isStringFilled(n)){var u=this.resolveEventName(n,t);l.eventsMaxListeners.set(u,r)}else{l.maxListeners=r}}},{key:"getMaxListeners",value:function e(t,n){if(i.isString(t)){n=t;t=this.GLOBAL_TARGET}else if(i.isNil(t)){t=this.GLOBAL_TARGET}if(!i.isObject(t)){throw new TypeError('The "target" argument must be an object.')}var r=te.get(t);if(r){var s=r.maxListeners;if(i.isStringFilled(n)){var o=this.resolveEventName(n,t);s=r.eventsMaxListeners.get(o)||s}return s}return this.DEFAULT_MAX_LISTENERS}},{key:"addMaxListeners",value:function t(){var n=this.destructMaxListenersArgs.apply(this,arguments),r=babelHelpers.slicedToArray(n,3),s=r[0],o=r[1],a=r[2];var l=Math.max(this.getMaxListeners(s,o)+a,0);if(i.isStringFilled(o)){e.setMaxListeners(s,o,l)}else{e.setMaxListeners(s,l)}return l}},{key:"incrementMaxListeners",value:function e(){var t=this.destructMaxListenersArgs.apply(this,arguments),n=babelHelpers.slicedToArray(t,3),i=n[0],r=n[1],s=n[2];return this.addMaxListeners(i,r,Math.abs(s))}},{key:"decrementMaxListeners",value:function e(){var t=this.destructMaxListenersArgs.apply(this,arguments),n=babelHelpers.slicedToArray(t,3),i=n[0],r=n[1],s=n[2];return this.addMaxListeners(i,r,-Math.abs(s))}},{key:"destructMaxListenersArgs",value:function e(){var t=null;var n=1;var r=this.GLOBAL_TARGET;for(var s=arguments.length,o=new Array(s),a=0;a<s;a++){o[a]=arguments[a]}if(o.length===1){if(i.isNumber(o[0])){n=o[0]}else if(i.isString(o[0])){t=o[0]}else{r=o[0]}}else if(o.length===2){if(i.isString(o[0])){t=o[0];n=o[1]}else if(i.isString(o[1])){r=o[0];t=o[1]}else{r=o[0];n=o[1]}}else if(o.length>=3){r=o[0];t=o[1];n=o[2]}if(!i.isObject(r)){throw new TypeError('The "target" argument must be an object.')}if(t!==null&&!i.isStringFilled(t)){throw new TypeError('The "eventName" argument must be a string.')}if(!i.isNumber(n)){throw new TypeError('The value of "increment" must be a number.')}return[r,t,n]}},{key:"getListeners",value:function e(t,n){if(i.isString(t)){n=t;t=this.GLOBAL_TARGET}if(!i.isObject(t)){throw new TypeError('The "target" argument must be an object.')}n=this.normalizeEventName(n);if(!i.isStringFilled(n)){throw new TypeError('The "eventName" argument must be a string.')}var r=te.get(t);if(!r){return new Map}var s=this.resolveEventName(n,t);return r.eventsMap.get(s)||new Map}},{key:"registerAliases",value:function t(n){n=this.normalizeAliases(n);Object.keys(n).forEach((function(e){ie.set(e,{eventName:n[e].eventName,namespace:n[e].namespace})}));e.mergeEventAliases(n)}},{key:"normalizeAliases",value:function e(t){if(!i.isPlainObject(t)){throw new TypeError('The "aliases" argument must be an object.')}var n=Object.create(null);for(var r in t){if(!i.isStringFilled(r)){throw new TypeError("The alias must be an non-empty string.")}var s=t[r];if(!s||!i.isStringFilled(s.eventName)||!i.isStringFilled(s.namespace)){throw new TypeError('The alias options must set the "eventName" and the "namespace".')}r=this.normalizeEventName(r);n[r]={eventName:s.eventName,namespace:s.namespace}}return n}},{key:"mergeEventAliases",value:function e(t){var n=this;var i=te.get(this.GLOBAL_TARGET);if(!i){return}Object.keys(t).forEach((function(e){var r=t[e];e=n.normalizeEventName(e);var s=n.makeFullEventName(r.namespace,r.eventName);var o=i.eventsMap.get(e);if(o){var a=i.eventsMap.get(s)||new Map;i.eventsMap.set(s,new Map([].concat(babelHelpers.toConsumableArray(a),babelHelpers.toConsumableArray(o))));i.eventsMap["delete"](e)}var l=i.onceMap.get(e);if(l){var u=i.onceMap.get(s)||new Map;i.onceMap.set(s,new Map([].concat(babelHelpers.toConsumableArray(u),babelHelpers.toConsumableArray(l))));i.onceMap["delete"](e)}var c=i.eventsMaxListeners.get(e);if(c){var f=i.eventsMaxListeners.get(s)||0;i.eventsMaxListeners.set(s,Math.max(f,c));i.eventsMaxListeners["delete"](e)}}))}},{key:"isEventEmitter",value:function e(t){return i.isObject(t)&&t[se]===true}},{key:"normalizeEventName",value:function e(t){if(!i.isStringFilled(t)){return""}return t.toLowerCase()}},{key:"normalizeListener",value:function e(t){if(i.isString(t)){t=r.getClass(t)}if(!i.isFunction(t)){throw new TypeError('The "listener" argument must be of type Function. Received type '.concat(babelHelpers["typeof"](t),"."))}return t}},{key:"resolveEventName",value:function e(t,n){var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;t=this.normalizeEventName(t);if(!i.isStringFilled(t)){return""}if(this.isEventEmitter(n)&&r!==true){if(n.getEventNamespace()!==null&&t.includes(".")){console.warn('Possible the wrong event name "'.concat(t,'".'))}t=n.getFullEventName(t)}else if(ie.has(t)){var s=ie.get(t),o=s.namespace,a=s.eventName;t=this.makeFullEventName(o,a)}return t}},{key:"makeFullEventName",value:function e(t,n){var r=i.isStringFilled(t)?"".concat(t,":").concat(n):n;return i.isStringFilled(r)?r.toLowerCase():""}}]);return e}();babelHelpers.defineProperty(le,"GLOBAL_TARGET",re);babelHelpers.defineProperty(le,"DEFAULT_MAX_LISTENERS",te.getDefaultMaxListeners());babelHelpers.defineProperty(le,"sequenceValue",1);var ue=[];e.isReady=false;function ce(t){switch(document.readyState){case"loading":ue.push(t);break;case"interactive":case"complete":if(i.isFunction(t)){t()}e.isReady=true;break;default:break}}document.addEventListener("readystatechange",(function(){if(!e.isReady){ue.forEach(ce);ue=[]}}));var fe=function e(){babelHelpers.classCallCheck(this,e)};babelHelpers.defineProperty(fe,"bind",m);babelHelpers.defineProperty(fe,"bindOnce",y);babelHelpers.defineProperty(fe,"unbind",g);babelHelpers.defineProperty(fe,"unbindAll",v);babelHelpers.defineProperty(fe,"ready",ce);babelHelpers.defineProperty(fe,"EventEmitter",le);babelHelpers.defineProperty(fe,"BaseEvent",Q);function de(e){if(i.isPlainObject(e)||i.isArray(e)){return JSON.stringify(e)}return u.encode(u.decode(e))}function he(e){if(i.isString(e)){var t=u.decode(e);var n;try{n=JSON.parse(t)}catch(e){n=t}if(n===t){if(/^[\d.]+[.]?\d+$/.test(n)){return Number(n)}}if(n==="true"||n==="false"){return Boolean(n)}return n}return e}function pe(){var e=document,t=e.documentElement,n=e.body;var i=Math.max(window.pageYOffset||0,t?t.scrollTop:0,n?n.scrollTop:0);var r=Math.max(window.pageXOffset||0,t?t.scrollLeft:0,n?n.scrollLeft:0);return{scrollTop:i,scrollLeft:r}}var me=function(){function e(){babelHelpers.classCallCheck(this,e)}babelHelpers.createClass(e,null,[{key:"replace",value:function e(t,n){if(i.isDomNode(t)&&i.isDomNode(n)){if(i.isDomNode(t.parentNode)){t.parentNode.replaceChild(n,t)}}}},{key:"remove",value:function e(t){if(i.isDomNode(t)&&i.isDomNode(t.parentNode)){t.parentNode.removeChild(t)}}},{key:"clean",value:function t(n){if(i.isDomNode(n)){while(n.childNodes.length>0){n.removeChild(n.firstChild)}return}if(i.isString(n)){e.clean(document.getElementById(n))}}},{key:"insertBefore",value:function e(t,n){if(i.isDomNode(t)&&i.isDomNode(n)){if(i.isDomNode(n.parentNode)){n.parentNode.insertBefore(t,n)}}}},{key:"insertAfter",value:function e(t,n){if(i.isDomNode(t)&&i.isDomNode(n)){if(i.isDomNode(n.parentNode)){var r=n.parentNode;if(i.isDomNode(n.nextSibling)){r.insertBefore(t,n.nextSibling);return}r.appendChild(t)}}}},{key:"append",value:function e(t,n){if(i.isDomNode(t)&&i.isDomNode(n)){n.appendChild(t)}}},{key:"prepend",value:function t(n,r){if(i.isDomNode(n)&&i.isDomNode(r)){if(i.isDomNode(r.firstChild)){r.insertBefore(n,r.firstChild);return}e.append(n,r)}}},{key:"hasClass",value:function t(n,r){if(i.isElementNode(n)){if(i.isString(r)){var s=r.trim();if(s.length>0){if(s.includes(" ")){return s.split(" ").every((function(t){return e.hasClass(n,t)}))}if("classList"in n){return n.classList.contains(s)}if(i.isObject(n.className)&&i.isString(n.className.baseVal)){return n.getAttribute("class").split(" ").some((function(e){return e===s}))}}}if(i.isArray(r)&&r.length>0){return r.every((function(t){return e.hasClass(n,t)}))}}return false}},{key:"addClass",value:function t(n,r){if(i.isElementNode(n)){if(i.isString(r)){var s=r.trim();if(s.length>0){if(s.includes(" ")){e.addClass(n,s.split(" "));return}if("classList"in n){n.classList.add(s);return}if(i.isObject(n.className)&&i.isString(n.className.baseVal)){if(n.className.baseVal===""){n.className.baseVal=s;return}var o=n.className.baseVal.split(" ");if(!o.includes(s)){o.push(s);n.className.baseVal=o.join(" ").trim();return}}return}}if(i.isArray(r)){r.forEach((function(t){return e.addClass(n,t)}))}}}},{key:"removeClass",value:function t(n,r){if(i.isElementNode(n)){if(i.isString(r)){var s=r.trim();if(s.length>0){if(s.includes(" ")){e.removeClass(n,s.split(" "));return}if("classList"in n){n.classList.remove(s);return}if(i.isObject(n.className)&&i.isString(n.className.baseVal)){var o=n.className.baseVal.split(" ").filter((function(e){return e!==s}));n.className.baseVal=o.join(" ");return}}}if(i.isArray(r)){r.forEach((function(t){return e.removeClass(n,t)}))}}}},{key:"toggleClass",value:function t(n,r){if(i.isElementNode(n)){if(i.isString(r)){var s=r.trim();if(s.length>0){if(s.includes(" ")){e.toggleClass(n,s.split(" "));return}n.classList.toggle(s);return}}if(i.isArray(r)){r.forEach((function(t){return e.toggleClass(n,t)}))}}}},{key:"style",value:function t(n,r,s){if(i.isElementNode(n)){if(i.isNull(r)){n.removeAttribute("style");return n}if(i.isPlainObject(r)){Object.entries(r).forEach((function(t){var i=babelHelpers.slicedToArray(t,2),r=i[0],s=i[1];e.style(n,r,s)}));return n}if(i.isString(r)){if(i.isUndefined(s)&&n.nodeType!==Node.DOCUMENT_NODE){var o=getComputedStyle(n);if(r in o){return o[r]}return o.getPropertyValue(r)}if(i.isNull(s)||s===""||s==="null"){if(String(r).startsWith("--")){n.style.removeProperty(r);return n}n.style[r]="";return n}if(i.isString(s)||i.isNumber(s)){if(String(r).startsWith("--")){n.style.setProperty(r,s);return n}n.style[r]=s;return n}}}return null}},{key:"adjust",value:function t(n){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};if(!n.nodeType){return null}var s=n;if(n.nodeType===Node.DOCUMENT_NODE){s=n.body}if(i.isPlainObject(r)){if(i.isPlainObject(r.attrs)){Object.keys(r.attrs).forEach((function(e){if(e==="class"||e.toLowerCase()==="classname"){s.className=r.attrs[e];return}if(r.attrs[e]==""){s.removeAttribute(e);return}s.setAttribute(e,r.attrs[e])}))}if(i.isPlainObject(r.style)){e.style(s,r.style)}if(i.isPlainObject(r.props)){Object.keys(r.props).forEach((function(e){s[e]=r.props[e]}))}if(i.isPlainObject(r.events)){Object.keys(r.events).forEach((function(e){fe.bind(s,e,r.events[e])}))}if(i.isPlainObject(r.dataset)){Object.keys(r.dataset).forEach((function(e){s.dataset[e]=r.dataset[e]}))}if(i.isString(r.children)){r.children=[r.children]}if(i.isArray(r.children)&&r.children.length>0){r.children.forEach((function(t){if(i.isDomNode(t)){e.append(t,s)}if(i.isString(t)){s.insertAdjacentHTML("beforeend",t)}}));return s}if("text"in r&&!i.isNil(r.text)){s.innerText=r.text;return s}if("html"in r&&!i.isNil(r.html)){s.innerHTML=r.html}}return s}},{key:"create",value:function t(n){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var s=arguments.length>2&&arguments[2]!==undefined?arguments[2]:document;var o=n;var a=r;if(i.isObjectLike(n)){a=n;o=n.tag}return e.adjust(s.createElement(o),a)}},{key:"show",value:function e(t){if(i.isDomNode(t)){t.hidden=false}}},{key:"hide",value:function e(t){if(i.isDomNode(t)){t.hidden=true}}},{key:"isShown",value:function e(t){return i.isDomNode(t)&&!t.hidden&&t.style.getPropertyValue("display")!=="none"}},{key:"toggle",value:function t(n){if(i.isDomNode(n)){if(e.isShown(n)){e.hide(n)}else{e.show(n)}}}},{key:"getPosition",value:function e(t){if(i.isDomNode(t)){var n=t.getBoundingClientRect();var r=pe(),s=r.scrollLeft,o=r.scrollTop;return new DOMRect(n.left+s,n.top+o,n.width,n.height)}return new DOMRect}},{key:"getRelativePosition",value:function t(n,r){if(i.isDomNode(n)&&i.isDomNode(r)){var s=e.getPosition(n);var o=e.getPosition(r);return new DOMRect(s.left-o.left,s.top-o.top,s.width,s.height)}return new DOMRect}},{key:"attr",value:function t(n,r,s){if(i.isElementNode(n)){if(i.isString(r)){if(!i.isNil(s)){return n.setAttribute(r,de(s))}if(i.isNull(s)){return n.removeAttribute(r)}return he(n.getAttribute(r))}if(i.isPlainObject(r)){return Object.entries(r).forEach((function(t){var i=babelHelpers.slicedToArray(t,2),r=i[0],s=i[1];e.attr(n,r,s)}))}}return null}}]);return e}();var ge=navigator.userAgent.toLowerCase();var ve=function(){function e(){babelHelpers.classCallCheck(this,e)}babelHelpers.createClass(e,null,[{key:"isOpera",value:function e(){return ge.includes("opera")}},{key:"isIE",value:function t(){return"attachEvent"in document&&!e.isOpera()}},{key:"isIE6",value:function e(){return ge.includes("msie 6")}},{key:"isIE7",value:function e(){return ge.includes("msie 7")}},{key:"isIE8",value:function e(){return ge.includes("msie 8")}},{key:"isIE9",value:function e(){return"documentMode"in document&&document.documentMode>=9}},{key:"isIE10",value:function e(){return"documentMode"in document&&document.documentMode>=10}},{key:"isSafari",value:function e(){return ge.includes("webkit")}},{key:"isFirefox",value:function e(){return ge.includes("firefox")}},{key:"isChrome",value:function e(){return ge.includes("chrome")}},{key:"detectIEVersion",value:function t(){if(e.isOpera()||e.isSafari()||e.isFirefox()||e.isChrome()){return-1}var n=-1;if(!!window.MSStream&&!window.ActiveXObject&&"ActiveXObject"in window){n=11}else if(e.isIE10()){n=10}else if(e.isIE9()){n=9}else if(e.isIE()){n=8}if(n===-1||n===8){if(navigator.appName==="Microsoft Internet Explorer"){var r=new RegExp("MSIE ([0-9]+[.0-9]*)");var s=navigator.userAgent.match(r);if(i.isArrayLike(s)&&s.length>0){n=parseFloat(s[1])}}if(navigator.appName==="Netscape"){n=11;var o=new RegExp("Trident/.*rv:([0-9]+[.0-9]*)");if(o.exec(navigator.userAgent)!=null){var a=navigator.userAgent.match(o);if(i.isArrayLike(a)&&a.length>0){n=parseFloat(a[1])}}}}return n}},{key:"isIE11",value:function t(){return e.detectIEVersion()>=11}},{key:"isMac",value:function e(){return ge.includes("macintosh")}},{key:"isWin",value:function e(){return ge.includes("windows")}},{key:"isLinux",value:function t(){return ge.includes("linux")&&!e.isAndroid()}},{key:"isAndroid",value:function e(){return ge.includes("android")}},{key:"isIPad",value:function e(){return ge.includes("ipad;")||this.isMac()&&this.isTouchDevice()}},{key:"isIPhone",value:function e(){return ge.includes("iphone;")}},{key:"isIOS",value:function t(){return e.isIPad()||e.isIPhone()}},{key:"isMobile",value:function t(){return e.isIPhone()||e.isIPad()||e.isAndroid()||ge.includes("mobile")||ge.includes("touch")}},{key:"isRetina",value:function e(){return window.devicePixelRatio&&window.devicePixelRatio>=2}},{key:"isTouchDevice",value:function e(){return"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0}},{key:"isDoctype",value:function e(t){var n=t||document;if(n.compatMode){return n.compatMode==="CSS1Compat"}return n.documentElement&&n.documentElement.clientHeight}},{key:"isLocalStorageSupported",value:function e(){try{localStorage.setItem("test","test");localStorage.removeItem("test");return true}catch(e){return false}}},{key:"addGlobalClass",value:function t(){var n="bx-core";if(me.hasClass(document.documentElement,n)){return}if(e.isIOS()){n+=" bx-ios"}else if(e.isWin()){n+=" bx-win"}else if(e.isMac()){n+=" bx-mac"}else if(e.isLinux()){n+=" bx-linux"}else if(e.isAndroid()){n+=" bx-android"}n+=e.isMobile()?" bx-touch":" bx-no-touch";n+=e.isRetina()?" bx-retina":" bx-no-retina";var i=-1;if(/AppleWebKit/.test(navigator.userAgent)){n+=" bx-chrome"}else if(e.detectIEVersion()>0){i=e.detectIEVersion();n+=" bx-ie bx-ie".concat(i);if(i>7&&i<10&&!e.isDoctype()){n+=" bx-quirks"}}else if(/Opera/.test(navigator.userAgent)){n+=" bx-opera"}else if(/Gecko/.test(navigator.userAgent)){n+=" bx-firefox"}me.addClass(document.documentElement,n)}},{key:"detectAndroidVersion",value:function e(){var t=new RegExp("Android ([0-9]+[.0-9]*)");if(t.exec(navigator.userAgent)!=null){var n=navigator.userAgent.match(t);if(i.isArrayLike(n)&&n.length>0){return parseFloat(n[1])}}return 0}},{key:"isPropertySupported",value:function e(t,n){if(t===""){return false}function i(e){return e.replace(/([A-Z])/g,(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++){t[n]=arguments[n]}return"-".concat(t[1].toLowerCase())}))}function r(e){var t=/(\\-([a-z]))/g;if(t.test(e)){return e.replace(t,(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++){t[n]=arguments[n]}return t[2].toUpperCase()}))}return e}var s=t.includes("-")?r(t):t;var o=!!n;var a=s.charAt(0).toUpperCase()+s.slice(1);var l=["Webkit","Moz","O","ms"].join("".concat(a," "));var u="".concat(s," ").concat(l," ").concat(a).split(" ");var c=document.body||document.documentElement;for(var f=0;f<u.length;f+=1){var d=u[f];if(c&&"style"in c&&d in c.style){var h=d.substr(0,d.length-s.length).toLowerCase();var p=d===s?"":"-".concat(h,"-");return o?p+i(s):d}}return false}},{key:"addGlobalFeatures",value:function t(n){if(!i.isArray(n)){return}var r=[];for(var s=0;s<n.length;s+=1){var o=!!e.isPropertySupported(n[s]);r.push("bx-".concat(o?"":"no-").concat(n[s].toLowerCase()))}me.addClass(document.documentElement,r.join(" "))}}]);return e}();function ye(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function be(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ye(Object(n),!0).forEach((function(t){babelHelpers.defineProperty(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ye(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var we=function(){function e(){babelHelpers.classCallCheck(this,e)}babelHelpers.createClass(e,null,[{key:"getList",value:function e(){return document.cookie.split(";").map((function(e){return e.split("=")})).map((function(e){return e.map((function(e){return e.trim()}))})).reduce((function(e,t){var n=babelHelpers.slicedToArray(t,2),i=n[0],r=n[1];e[decodeURIComponent(i)]=decodeURIComponent(r);return e}),{})}},{key:"get",value:function t(n){var i=e.getList();if(n in i){return i[n]}return undefined}},{key:"set",value:function e(t,n){var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var s=be({expires:""},r);if(i.isNumber(s.expires)){var o=+new Date;var a=s.expires;var l=864e5;s.expires=new Date(o+a*l)}if(i.isDate(s.expires)){s.expires=s.expires.toUTCString()}var u=decodeURIComponent(String(t)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var c=encodeURIComponent(String(n)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent);var f=Object.keys(s).reduce((function(e,t){var n=s[t];if(!n){return e}if(n===true){return"".concat(e,"; ").concat(t)}return"".concat(e,"; ").concat(t,"=").concat(n.split(";")[0])}),"");document.cookie="".concat(u,"=").concat(c).concat(f)}},{key:"remove",value:function t(n){var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};e.set(n,"",be(be({},i),{},{expires:-1}))}}]);return e}();function Se(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:new FormData;var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;if(i.isUndefined(e)){return t}if(i.isNull(e)){t.append(n,"")}else if(i.isArray(e)){if(!e.length){var r="".concat(n,"[]");t.append(r,"")}else{e.forEach((function(e,i){var r="".concat(n,"[").concat(i,"]");Se(e,t,r)}))}}else if(i.isDate(e)){t.append(n,e.toISOString())}else if(i.isObject(e)&&!i.isFile(e)&&!i.isBlob(e)){Object.keys(e).forEach((function(r){var s=e[r];var o=r;if(i.isArray(s)){while(r.length>2&&r.lastIndexOf("[]")===r.length-2){o=r.substring(0,r.length-2)}}var a=n?"".concat(n,"[").concat(o,"]"):o;Se(s,t,a)}))}else{t.append(n,e)}return t}var Ie=function(){function e(){babelHelpers.classCallCheck(this,e)}babelHelpers.createClass(e,null,[{key:"convertObjectToFormData",value:function e(t){return Se(t)}}]);return e}();var ke=function e(){babelHelpers.classCallCheck(this,e)};babelHelpers.defineProperty(ke,"Cookie",we);babelHelpers.defineProperty(ke,"Data",Ie);function Ce(e){if(i.isString(e)){if(i.isNil(Ce[e])){le.emit("onBXMessageNotFound",new Q({compatData:[e]}));if(i.isNil(Ce[e])){K.debug("message undefined: ".concat(e));Ce[e]=""}}}if(i.isPlainObject(e)){Object.keys(e).forEach((function(t){Ce[t]=e[t]}))}return Ce[e]}if(!i.isNil(window.BX)&&i.isFunction(window.BX.message)){Object.keys(window.BX.message).forEach((function(e){Ce(babelHelpers.defineProperty({},e,window.BX.message[e]))}))}var Ee=function(){function e(){babelHelpers.classCallCheck(this,e)}babelHelpers.createClass(e,null,[{key:"getMessage",value:function e(t){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;var r=Ce(t);if(i.isString(r)&&i.isPlainObject(n)){Object.keys(n).forEach((function(e){var t=new RegExp(e,"gi");r=r.replace(t,(function(){return i.isNil(n[e])?"":String(n[e])}))}))}return r}},{key:"hasMessage",value:function e(t){return i.isString(t)&&!i.isNil(Ce[t])}},{key:"setMessage",value:function e(t,n){if(i.isString(t)&&i.isString(n)){Ce(babelHelpers.defineProperty({},t,n))}if(i.isObject(t)){Ce(t)}}},{key:"getMessagePlural",value:function e(t,n){var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;var s="";if(i.isNumber(n)){if(this.hasMessage("".concat(t,"_PLURAL_").concat(this.getPluralForm(n)))){s=this.getMessage("".concat(t,"_PLURAL_").concat(this.getPluralForm(n)),r)}else{s=this.getMessage("".concat(t,"_PLURAL_1"),r)}}else{s=this.getMessage(t,r)}return s}},{key:"getPluralForm",value:function e(t,n){var r;if(!i.isStringFilled(n)){n=Ce("LANGUAGE_ID")}if(t<0){t=-1*t}switch(n){case"ar":r=t!==1?1:0;break;case"br":case"fr":case"tr":r=t>1?1:0;break;case"de":case"en":case"hi":case"it":case"la":r=t!==1?1:0;break;case"ru":case"ua":if(t%10===1&&t%100!==11){r=0}else if(t%10>=2&&t%10<=4&&(t%100<10||t%100>=20)){r=1}else{r=2}break;case"pl":if(t===1){r=0}else if(t%10>=2&&t%10<=4&&(t%100<10||t%100>=20)){r=1}else{r=2}break;case"id":case"ja":case"ms":case"sc":case"tc":case"th":case"vn":r=0;break;default:r=1;break}return r}}]);return e}();var _e=["area","base","br","col","embed","hr","img","input","link","meta","param","source","track","wbr"];function xe(e){return _e.includes(e)}var Te={tag:/<[a-zA-Z0-9\-\!\/](?:"[^"]*"|'[^']*'|[^'">])*>|{{uid[0-9]+}}/g,comment:/<!--(?!<!)[^\[>].*?-->/g,tagName:/<\/?([^\s]+?)[/\s>]/,attributes:/\s([\w\-_:.]+)\s?\n?=\s?\n?"([^"]+)?"|\s([\w\-_:.]+)\s?\n?=\s?\n?'([^']+)?'|\s([\w\-_:.]+)/g,placeholder:/{{uid[0-9]+}}/g};function Oe(e){var t={type:"tag",name:"",svg:false,attrs:{},children:[],voidElement:false};if(e.startsWith("\x3c!--")){var n=e.indexOf("--\x3e");var r="\x3c!--".length;return{type:"comment",content:n!==-1?e.slice(r,n):""}}var s=e.match(Te.tagName);if(i.isArrayFilled(s)){var o=babelHelpers.slicedToArray(s,2),a=o[1];t.name=a;t.svg=a==="svg";t.voidElement=xe(a)||e.trim().endsWith("/>")}var l=new RegExp(Te.attributes);for(;;){var u=l.exec(e);if(!i.isNil(u)){var c=babelHelpers.slicedToArray(u,3),f=c[1],d=c[2];if(!i.isNil(f)){t.attrs[f]=i.isStringFilled(d)?d:""}else{var h=babelHelpers.slicedToArray(u,5),p=h[3],m=h[4];if(!i.isNil(p)){t.attrs[p]=i.isStringFilled(m)?m:""}else{var g=babelHelpers.slicedToArray(u,6),v=g[5];t.attrs[v]=""}}}else{break}}return t}function Me(e){var t=e.replace(/[\n\r\t]$/,"");var n=t.match(Te.placeholder);return t.split(Te.placeholder).reduce((function(e,t,r){if(i.isStringFilled(t)){e.push.apply(e,babelHelpers.toConsumableArray(t.split(/\n/).reduce((function(e,t){var n=t.replace(/[\t\r]/g,"");if(i.isStringFilled(n)){e.push({type:"text",content:n})}return e}),[])))}if(n&&n[r]){e.push({type:"placeholder",uid:parseInt(n[r].replace(/{{uid|}}/,""))})}return e}),[])}function De(e,t){var n=[];if(e.indexOf("<")!==0&&!e.startsWith("{{")){var i=e.indexOf("<");n.push.apply(n,babelHelpers.toConsumableArray(Me(i===-1?e:e.slice(0,i))))}var r=[];var s=-1;e=e.replace(Te.comment,(function(e){s+=1;r.push(e.replace(/^<!--|-->$/g,""));return"\x3c!--{{cUid".concat(s,"}}--\x3e")}));var o=[];var a=-1;var l;e.replace(Te.tag,(function(i,s){var u=s+i.length;var c=e.charAt(u);var f;if(i.startsWith("\x3c!--")){var d=Oe(i,t);d.content=r[i.replace(/<!--{{cUid|}}-->/g,"")];if(a<0){n.push(d);return n}f=o[a];f.children.push(d);return n}if(i.startsWith("{{")){var h=Me(i),p=babelHelpers.slicedToArray(h,1),m=p[0];if(a<0){n.push(m);return n}f=o[a];f.children.push(m);return n}if(!i.startsWith("</")){a++;l=Oe(i,t);if(!l.voidElement&&c&&c!=="<"){var g;(g=l.children).push.apply(g,babelHelpers.toConsumableArray(Me(e.slice(u,e.indexOf("<",u)))))}if(a===0){n.push(l)}f=o[a-1];if(f){if(!l.svg){l.svg=f.svg}f.children.push(l)}o[a]=l}if(i.startsWith("</")||l.voidElement){if(a>-1&&(l.voidElement||l.name===i.slice(2,-1))){a--;l=a===-1?n:o[a]}if(c&&c!=="<"){f=a===-1?n:o[a].children;var v=e.indexOf("<",u);var y=e.slice(u,v===-1?undefined:v);if(v>-1&&a+f.length>=0||y!==" "){var b;(b=f).push.apply(b,babelHelpers.toConsumableArray(Me(y)))}}}}));return n}var Ae=function e(t,n){if(i.isDomNode(t)&&i.isDomNode(n)){if(n.nodeName!=="TEMPLATE"){me.append(t,n)}else{n.content.append(t)}}};function Pe(e){var t=e.node,n=e.parentElement,r=e.substitutions;if(t.type==="tag"){var s=function(){if(t.svg){return document.createElementNS("http://www.w3.org/2000/svg",t.name)}return document.createElement(t.name)}();Object.entries(t.attrs).forEach((function(e){var t=babelHelpers.slicedToArray(e,2),n=t[0],o=t[1];if(n.startsWith("on")&&new RegExp(Te.placeholder).test(o)){var a=r[parseInt(o.replace(/{{uid|}}/,""))-1];if(i.isFunction(a)){var l=n.endsWith("once")?"bindOnce":"bind";fe[l](s,n.replace(/^on|once$/g,""),a)}else{s.setAttribute(n,a)}}else{if(new RegExp(Te.placeholder).test(o)){var c=o.split(/{{|}}/).reduce((function(e,t){if(t.startsWith("uid")){var n=r[parseInt(t.replace("uid",""))-1];return"".concat(e).concat(n)}return"".concat(e).concat(t)}),"");s.setAttribute(n,c)}else{s.setAttribute(n,u.decode(o))}}}));t.children.forEach((function(e){var t=Pe({node:e,parentElement:s,substitutions:r});if(i.isArray(t)){t.forEach((function(e){Ae(e,s)}))}else{Ae(t,s)}}));return s}if(t.type==="comment"){return document.createComment(t.content)}if(t.type==="text"){if(n){if(n.nodeName!=="TEMPLATE"){n.insertAdjacentHTML("beforeend",t.content)}else{n.content.append(t.content)}return}return document.createTextNode(t.content)}if(t.type==="placeholder"){return r[t.uid-1]}}function Le(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++){n[r-1]=arguments[r]}var s=e.reduce((function(e,t,r){if(r>0){var s=n[r-1];if(i.isString(s)||i.isNumber(s)){return"".concat(e).concat(s).concat(t)}return"".concat(e,"{{uid").concat(r,"}}").concat(t)}return e}),e[0]).replace(/^[\r\n\t\s]+/gm,"").replace(/>[\n]+/g,">").replace(/[}][\n]+/g,"}");var o=De(s);if(o.length===1){return Pe({node:o[0],substitutions:n})}if(o.length>1){return o.map((function(e){return Pe({node:e,substitutions:n})}))}return false}function Re(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++){n[r-1]=arguments[r]}return n.reduce((function(t,n,r){var s=r+1;if(!i.isPlainObject(n)&&!i.isArray(n)){return t+n+e[s]}return"".concat(t,"__s").concat(r).concat(e[s])}),e[0]).replace(/[\r\t]/gm,"").split(";\n").map((function(e){return e.replace(/\n/,"")})).reduce((function(e,t){if(t!==""){var i=t.match(/^[\w-. ]+:/);var r=t.split(/^[\w-. ]+:/);var s=i[0].replace(":","").trim();var o=r[1].trim();var a=/^__s\d+/;if(a.test(o)){e[s]=n[o.replace("__s","")];return e}e[s]=o}return e}),{})}var He=function(){function e(){babelHelpers.classCallCheck(this,e)}babelHelpers.createClass(e,null,[{key:"safe",value:function e(t){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++){i[r-1]=arguments[r]}return i.reduce((function(e,n,i){return e+u.encode(n)+t[i+1]}),t[0])}},{key:"unsafe",value:function e(t){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++){i[r-1]=arguments[r]}return i.reduce((function(e,n,i){return e+u.decode(n)+t[i+1]}),t[0])}},{key:"style",value:function e(t){if(!i.isDomNode(t)){throw new Error("element is not HTMLElement")}return function e(){me.style(t,Re.apply(void 0,arguments))}}},{key:"message",value:function e(t){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++){i[r-1]=arguments[r]}return i.reduce((function(e,n,i){return e+Ee.getMessage(n)+t[i+1]}),t[0])}},{key:"attrs",value:function e(t){if(!i.isDomNode(t)){throw new Error("element is not HTMLElement")}return function e(){me.attr(t,Re.apply(void 0,arguments))}}}]);return e}();babelHelpers.defineProperty(He,"render",Le);babelHelpers.defineProperty(He,"attr",He.attrs);function je(e){switch(e){case"index":return function(e,t,n){var r=/\[(\w*)\]$/.exec(e);var s=e.replace(/\[\w*\]$/,"");if(i.isNil(r)){n[s]=t;return}if(i.isUndefined(n[s])){n[s]={}}n[s][r[1]]=t};case"bracket":return function(e,t,n){var r=/(\[\])$/.exec(e);var s=e.replace(/\[\]$/,"");if(i.isNil(r)){n[s]=t;return}if(i.isUndefined(n[s])){n[s]=[t];return}n[s]=[].concat(n[s],t)};default:return function(e,t,n){var i=e.replace(/\[\]$/,"");n[i]=t}}}function Ne(e){if(/^\w+\[([\w]+)\]$/.test(e)){return"index"}if(/^\w+\[\]$/.test(e)){return"bracket"}return"default"}function Be(e){if(!i.isString(e)){return{}}var t=e.trim().replace(/^[?#&]/,"");if(!t){return{}}return t.split("&").reduce((function(e,t){var n=t.replace(/\+/g," ").split("="),i=babelHelpers.slicedToArray(n,2),r=i[0],s=i[1];var o=Ne(r);var a=je(o);a(r,s,e);return e}),{})}var Fe=/^((\w+):)?(\/\/((\w+)?(:(\w+))?@)?([^\/\?:]+)(:(\d+))?)?(\/?([^\/\?#][^\?#]*)?)?(\?([^#]+))?(#(\w*))?/;function Ue(e){var t=e.match(Fe);if(i.isArray(t)){var n=Be(t[14]);return{useShort:/^\/\//.test(e),href:t[0]||"",schema:t[2]||"",host:t[8]||"",port:t[10]||"",path:t[11]||"",query:t[14]||"",queryParams:n,hash:t[16]||"",username:t[5]||"",password:t[7]||"",origin:t[8]||""}}return{}}function We(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var t=Object.keys(e).reduce((function(t,n){if(i.isArray(e[n])){e[n].forEach((function(e){t.push("".concat(n,"[]=").concat(e))}),"")}if(i.isPlainObject(e[n])){Object.keys(e[n]).forEach((function(i){t.push("".concat(n,"[").concat(i,"]=").concat(e[n][i]))}),"")}if(!i.isObject(e[n])&&!i.isArray(e[n])){t.push("".concat(n,"=").concat(e[n]))}return t}),[]).join("&");if(t.length>0){return"?".concat(t)}return t}function $e(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function Ve(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$e(Object(n),!0).forEach((function(t){babelHelpers.defineProperty(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$e(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ge(e){if(i.isArray(e)){return e.map((function(e){return String(e)}))}if(i.isPlainObject(e)){return Ve({},e)}return String(e)}function ze(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function Xe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ze(Object(n),!0).forEach((function(t){babelHelpers.defineProperty(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ze(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var qe=new WeakMap;var Ke=function(){babelHelpers.createClass(e,null,[{key:"addParam",value:function t(n){var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};return new e(n).setQueryParams(i).toString()}},{key:"removeParam",value:function t(n,r){var s;var o=i.isArray(r)?r:[r];return(s=new e(n)).removeQueryParam.apply(s,babelHelpers.toConsumableArray(o)).toString()}}]);function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"";babelHelpers.classCallCheck(this,e);qe.set(this,Ue(t))}babelHelpers.createClass(e,[{key:"getSchema",value:function e(){return qe.get(this).schema}},{key:"setSchema",value:function e(t){qe.get(this).schema=String(t);return this}},{key:"getHost",value:function e(){return qe.get(this).host}},{key:"setHost",value:function e(t){qe.get(this).host=String(t);return this}},{key:"getPort",value:function e(){return qe.get(this).port}},{key:"setPort",value:function e(t){qe.get(this).port=String(t);return this}},{key:"getPath",value:function e(){return qe.get(this).path}},{key:"setPath",value:function e(t){if(!/^\//.test(t)){qe.get(this).path="/".concat(String(t));return this}qe.get(this).path=String(t);return this}},{key:"getQuery",value:function e(){return We(qe.get(this).queryParams)}},{key:"getQueryParam",value:function e(t){var n=this.getQueryParams();if(t in n){return n[t]}return null}},{key:"setQueryParam",value:function e(t){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"";qe.get(this).queryParams[t]=Ge(n);return this}},{key:"getQueryParams",value:function e(){return Xe({},qe.get(this).queryParams)}},{key:"setQueryParams",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var n=this.getQueryParams();var i=Xe(Xe({},n),t);Object.keys(i).forEach((function(e){i[e]=Ge(i[e])}));qe.get(this).queryParams=i;return this}},{key:"removeQueryParam",value:function e(){var t=Xe({},qe.get(this).queryParams);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++){i[r]=arguments[r]}i.forEach((function(e){if(e in t){delete t[e]}}));qe.get(this).queryParams=t;return this}},{key:"getFragment",value:function e(){return qe.get(this).hash}},{key:"setFragment",value:function e(t){qe.get(this).hash=String(t);return this}},{key:"serialize",value:function e(){var t=Xe({},qe.get(this));t.href=this.toString();return t}},{key:"toString",value:function e(){var t=Xe({},qe.get(this));var n=t.schema?"".concat(t.schema,"://"):"";if(t.useShort){n="//"}var r=function(){if(i.isString(t.port)&&!["","80"].includes(t.port)){return":".concat(t.port)}return""}();var s=this.getHost();var o=this.getPath();var a=We(t.queryParams);var l=t.hash?"#".concat(t.hash):"";return"".concat(s?n:"").concat(s).concat(s?r:"").concat(o).concat(a).concat(l)}}]);return e}();var Ye=function(){function e(){babelHelpers.classCallCheck(this,e)}babelHelpers.createClass(e,null,[{key:"isEmail",value:function e(t){var n=/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;return n.test(String(t).toLowerCase())}}]);return e}();var Je=function(){function e(){babelHelpers.classCallCheck(this,e);babelHelpers.defineProperty(this,"storage",new Map)}babelHelpers.createClass(e,[{key:"get",value:function e(t,n){if(!this.storage.has(t)){if(i.isFunction(n)){return n()}if(!i.isUndefined(n)){return n}}return this.storage.get(t)}},{key:"set",value:function e(t,n){this.storage.set(t,n)}},{key:"delete",value:function e(t){this.storage["delete"](t)}},{key:"has",value:function e(t){return this.storage.has(t)}},{key:"remember",value:function e(t,n){if(!this.storage.has(t)){if(i.isFunction(n)){this.storage.set(t,n())}else if(!i.isUndefined(n)){this.storage.set(t,n)}}return this.storage.get(t)}},{key:"size",value:function e(){return this.storage.size}},{key:"keys",value:function e(){return babelHelpers.toConsumableArray(this.storage.keys())}},{key:"values",value:function e(){return babelHelpers.toConsumableArray(this.storage.values())}}]);return e}();var Qe=function(e){babelHelpers.inherits(t,e);function t(){var e;var n;babelHelpers.classCallCheck(this,t);for(var i=arguments.length,r=new Array(i),s=0;s<i;s++){r[s]=arguments[s]}n=babelHelpers.possibleConstructorReturn(this,(e=babelHelpers.getPrototypeOf(t)).call.apply(e,[this].concat(r)));babelHelpers.defineProperty(babelHelpers.assertThisInitialized(n),"storage",new Map);return n}return t}(Je);var Ze=function(){function e(){babelHelpers.classCallCheck(this,e);babelHelpers.defineProperty(this,"stackKey","BX.Cache.Storage.LsStorage.stack");babelHelpers.defineProperty(this,"stack",null)}babelHelpers.createClass(e,[{key:"getStack",value:function e(){if(i.isPlainObject(this.stack)){return this.stack}var t=localStorage.getItem(this.stackKey);if(i.isString(t)&&t!==""){var n=JSON.parse(t);if(i.isPlainObject(n)){this.stack=n;return this.stack}}this.stack={};return this.stack}},{key:"saveStack",value:function e(){if(i.isPlainObject(this.stack)){var t=JSON.stringify(this.stack);localStorage.setItem(this.stackKey,t)}}},{key:"get",value:function e(t){var n=this.getStack();return n[t]}},{key:"set",value:function e(t,n){var i=this.getStack();i[t]=n;this.saveStack()}},{key:"delete",value:function e(t){var n=this.getStack();if(t in n){delete n[t]}}},{key:"has",value:function e(t){var n=this.getStack();return t in n}},{key:"keys",value:function e(){var t=this.getStack();return Object.keys(t)}},{key:"values",value:function e(){var t=this.getStack();return Object.values(t)}},{key:"size",get:function e(){var t=this.getStack();return Object.keys(t).length}}]);return e}();var et=function(e){babelHelpers.inherits(t,e);function t(){var e;var n;babelHelpers.classCallCheck(this,t);for(var i=arguments.length,r=new Array(i),s=0;s<i;s++){r[s]=arguments[s]}n=babelHelpers.possibleConstructorReturn(this,(e=babelHelpers.getPrototypeOf(t)).call.apply(e,[this].concat(r)));babelHelpers.defineProperty(babelHelpers.assertThisInitialized(n),"storage",new Ze);return n}return t}(Je);var tt=function e(){babelHelpers.classCallCheck(this,e)};babelHelpers.defineProperty(tt,"MemoryCache",Qe);babelHelpers.defineProperty(tt,"LocalStorageCache",et);var nt;function it(e,t){rt(e,t);t.add(e)}function rt(e,t){if(t.has(e)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}function st(e,t,n){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return n}var ot=new WeakSet;nt=Symbol.iterator;var at=function(){function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;babelHelpers.classCallCheck(this,e);it(this,ot);babelHelpers.defineProperty(this,"comparator",null);babelHelpers.defineProperty(this,"items",[]);this.comparator=i.isFunction(t)?t:null}babelHelpers.createClass(e,[{key:"add",value:function e(t){var n=-1;if(this.comparator){n=st(this,ot,lt).call(this,t);this.items.splice(n,0,t)}else{this.items.push(t)}return n}},{key:"has",value:function e(t){return this.items.includes(t)}},{key:"getIndex",value:function e(t){return this.items.indexOf(t)}},{key:"getByIndex",value:function e(t){if(i.isNumber(t)&&t>=0){var n=this.items[t];return i.isUndefined(n)?null:n}return null}},{key:"getFirst",value:function e(){var t=this.items[0];return i.isUndefined(t)?null:t}},{key:"getLast",value:function e(){var t=this.items[this.count()-1];return i.isUndefined(t)?null:t}},{key:"count",value:function e(){return this.items.length}},{key:"delete",value:function e(t){var n=this.getIndex(t);if(n!==-1){this.items.splice(n,1);return true}return false}},{key:"clear",value:function e(){this.items=[]}},{key:nt,value:function e(){return this.items[Symbol.iterator]()}},{key:"forEach",value:function e(t,n){return this.items.forEach(t,n)}},{key:"getAll",value:function e(){return this.items}},{key:"getComparator",value:function e(){return this.comparator}},{key:"sort",value:function e(){var t=this;var n=this.getComparator();if(n===null){return}var i=this.items.length;var r=new Array(i);for(var s=0;s<i;s++){r[s]=s}r.sort((function(e,i){return n(t.items[e],t.items[i])||e-i}));for(var o=0;o<i;o++){r[o]=this.items[r[o]]}for(var a=0;a<i;a++){this.items[a]=r[a]}}}]);return e}();function lt(e){var t=0;var n=this.items.length;while(t<n){var i=Math.floor((t+n)/2);if(this.comparator(this.items[i],e)>=0){n=i}else{t=i+1}}return t}var ut=function(e){babelHelpers.inherits(t,e);function t(e){var n;var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};babelHelpers.classCallCheck(this,t);n=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this));babelHelpers.defineProperty(babelHelpers.assertThisInitialized(n),"sort",0);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(n),"alwaysOnTop",false);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(n),"zIndex",0);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(n),"element",null);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(n),"overlay",null);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(n),"overlayGap",-5);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(n),"stack",null);n.setEventNamespace("BX.Main.ZIndexManager.Component");if(!i.isElementNode(e)){throw new Error("ZIndexManager.Component: The argument 'element' must be a DOM element.")}n.element=e;var s=i.isPlainObject(r)?r:{};n.setAlwaysOnTop(s.alwaysOnTop);n.setOverlay(s.overlay);n.setOverlayGap(s.overlayGap);n.subscribeFromOptions(s.events);return n}babelHelpers.createClass(t,[{key:"getSort",value:function e(){return this.sort}},{key:"setSort",value:function e(t){if(i.isNumber(t)){this.sort=t}}},{key:"setStack",value:function e(t){this.stack=t}},{key:"getStack",value:function e(){return this.stack}},{key:"getZIndex",value:function e(){return this.zIndex}},{key:"setZIndex",value:function e(t){var n=this.getZIndex()!==t;this.getElement().style.setProperty("z-index",t,"important");this.zIndex=t;if(this.getOverlay()!==null){this.getOverlay().style.setProperty("z-index",t+this.getOverlayGap(),"important")}if(n){this.emit("onZIndexChange",{component:this})}}},{key:"getAlwaysOnTop",value:function e(){return this.alwaysOnTop}},{key:"setAlwaysOnTop",value:function e(t){if(i.isNumber(t)||i.isBoolean(t)){this.alwaysOnTop=t}}},{key:"getElement",value:function e(){return this.element}},{key:"setOverlay",value:function e(t,n){if(i.isElementNode(t)||t===null){this.overlay=t;this.setOverlayGap(n);if(this.getStack()){this.getStack().sort()}}}},{key:"getOverlay",value:function e(){return this.overlay}},{key:"setOverlayGap",value:function e(t){if(i.isNumber(t)){this.overlayGap=t}}},{key:"getOverlayGap",value:function e(){return this.overlayGap}}]);return t}(le);var ct=function(){function e(t){babelHelpers.classCallCheck(this,e);babelHelpers.defineProperty(this,"container",null);babelHelpers.defineProperty(this,"components",null);babelHelpers.defineProperty(this,"elements",new WeakMap);babelHelpers.defineProperty(this,"baseIndex",1e3);babelHelpers.defineProperty(this,"baseStep",50);babelHelpers.defineProperty(this,"sortCount",0);if(!i.isDomNode(t)){throw new Error("ZIndexManager.Stack: The 'container' argument must be a DOM element.")}this.container=t;var n=function e(t,n){var i=(t.getAlwaysOnTop()||0)-(n.getAlwaysOnTop()||0);if(!i){i=t.getSort()-n.getSort()}return i};this.components=new at(n)}babelHelpers.createClass(e,[{key:"getBaseIndex",value:function e(){return this.baseIndex}},{key:"setBaseIndex",value:function e(t){if(i.isNumber(t)&&t>=0){this.baseIndex=t;this.sort()}}},{key:"setBaseStep",value:function e(t){if(i.isNumber(t)&&t>0){this.baseStep=t;this.sort()}}},{key:"getBaseStep",value:function e(){return this.baseStep}},{key:"register",value:function e(t){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};if(this.getComponent(t)){console.warn("ZIndexManager: You cannot register the element twice.",t);return this.getComponent(t)}var i=new ut(t,n);i.setStack(this);i.setSort(++this.sortCount);this.elements.set(t,i);this.components.add(i);this.sort();return i}},{key:"unregister",value:function e(t){var n=this.elements.get(t);this.components["delete"](n);this.elements["delete"](t);this.sort()}},{key:"getComponent",value:function e(t){return this.elements.get(t)||null}},{key:"getComponents",value:function e(){return this.components.getAll()}},{key:"getMaxZIndex",value:function e(){var t=this.components.getLast();return t?t.getZIndex():this.baseIndex}},{key:"sort",value:function e(){var t=this;this.components.sort();var n=this.baseIndex;this.components.forEach((function(e){e.setZIndex(n);n+=t.baseStep}))}},{key:"bringToFront",value:function e(t){var n=this.getComponent(t);if(!n){console.error("ZIndexManager: element was not found in the stack.",t);return null}n.setSort(++this.sortCount);this.sort();return n}}]);return e}();function ft(e,t,n){dt(e,t);return n}function dt(e,t){if(e!==t){throw new TypeError("Private static access of wrong provenance")}}var ht=function(){function e(){babelHelpers.classCallCheck(this,e)}babelHelpers.createClass(e,null,[{key:"register",value:function t(n){var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var r=ft(this,e,pt).call(this,n);if(!r){return null}var s=this.getOrAddStack(r);return s.register(n,i)}},{key:"unregister",value:function t(n){var i=ft(this,e,pt).call(this,n);var r=this.getStack(i);if(r){r.unregister(n)}}},{key:"addStack",value:function e(t){var n=new ct(t);this.stacks.set(t,n);return n}},{key:"getStack",value:function e(t){return this.stacks.get(t)||null}},{key:"getOrAddStack",value:function e(t){return this.getStack(t)||this.addStack(t)}},{key:"getComponent",value:function t(n){var i=ft(this,e,pt).call(this,n,true);if(!i){return null}var r=this.getStack(i);return r?r.getComponent(n):null}},{key:"bringToFront",value:function t(n){var i=ft(this,e,pt).call(this,n);var r=this.getStack(i);if(r){return r.bringToFront(n)}return null}}]);return e}();function pt(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;if(!i.isElementNode(e)){if(!t){console.error("ZIndexManager: The argument 'element' must be a DOM element.",e)}return null}else if(!i.isElementNode(e.parentNode)){if(!t){console.error("ZIndexManager: The 'element' doesn't have a parent node.",e)}return null}return e.parentNode}babelHelpers.defineProperty(ht,"stacks",new WeakMap);function mt(e){if(i.isStringFilled(e)){return e.split(".").reduce((function(e,t){t.split(/\[['"]?(.+?)['"]?\]/g).forEach((function(t){if(i.isStringFilled(t)){e.push(t)}}));return e}),[])}return[]}var gt=function(){function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};babelHelpers.classCallCheck(this,e);if(i.isPlainObject(t)){Object.assign(this,t)}}babelHelpers.createClass(e,[{key:"get",value:function e(t){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;var r=mt(t);return r.reduce((function(e,t){if(!i.isNil(e)&&e!==n){if(!i.isUndefined(e[t])){return e[t]}return n}return e}),this)}}]);return e}();function vt(e){if(i.isObject(e)){Object.values(e).forEach((function(e){vt(e)}));return Object.freeze(e)}return e}var yt=new Map;var bt=function(){function e(){babelHelpers.classCallCheck(this,e)}babelHelpers.createClass(e,null,[{key:"getSettings",value:function e(t){if(i.isStringFilled(t)){if(yt.has(t)){return yt.get(t)}var n=document.querySelector('script[data-extension="'.concat(t,'"]'));if(i.isDomNode(n)){var r=function(){try{return new gt(JSON.parse(n.innerHTML))}catch(e){return new gt}}();var s=vt(r);yt.set(t,s);return s}}return vt(new gt)}}]);return e}();function wt(e){if(i.isString(e)){return document.getElementById(e)}return e}function St(e){if(i.isElementNode(e)){return e.ownerDocument.parentWindow||e.ownerDocument.defaultView||window}if(i.isDomNode(e)){return e.parentWindow||e.defaultView||window}return window}function It(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function kt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?It(Object(n),!0).forEach((function(t){babelHelpers.defineProperty(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):It(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ct=r.getClass,Et=r.namespace;var _t=Ce;var xt=me.replace,Tt=me.remove,Ot=me.clean,Mt=me.insertBefore,Dt=me.insertAfter,At=me.append,Pt=me.prepend,Lt=me.style,Rt=me.adjust,Ht=me.create,jt=me.isShown;var Nt=function e(){me.addClass.apply(me,babelHelpers.toConsumableArray(K.merge([],Array.from(arguments),[wt(arguments[0])])))};var Bt=function e(){me.removeClass.apply(me,babelHelpers.toConsumableArray(K.merge(Array.from(arguments),[wt(arguments[0])])))};var Ft=function e(){return me.hasClass.apply(me,babelHelpers.toConsumableArray(K.merge(Array.from(arguments),[wt(arguments[0])])))};var Ut=function e(){me.toggleClass.apply(me,babelHelpers.toConsumableArray(K.merge(Array.from(arguments),[wt(arguments[0])])))};var Wt=function e(t){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var r=wt(t);if(i.isDomNode(r)){me.clean(r);if(n){me.remove(r);return r}}return r};var $t=ke.Cookie.get;var Vt=function e(t,n){var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var s=kt({},r);if(i.isNumber(s.expires)){s.expires/=3600*24}ke.Cookie.set(t,n,s)};var Gt=fe.bind,zt=fe.unbind,Xt=fe.unbindAll,qt=fe.bindOnce,Kt=fe.ready;var Yt=b,Jt=I,Qt=k;var Zt=function e(t){if(t){w()}else{S()}};var en=K.clone,tn=K.loadExtension,nn=K.debounce,rn=K.throttle,sn=K.html;var on=kt(kt({},Object.getOwnPropertyNames(i).filter((function(e){return!["name","length","prototype","caller","arguments"].includes(e)})).reduce((function(e,t){e[t]=i[t];return e}),{})),{},{isNotEmptyString:function e(t){return i.isString(t)&&t!==""},isNotEmptyObject:function e(t){return i.isObjectLike(t)&&Object.keys(t).length>0},isMapKey:i.isObject,stringToInt:function e(t){var n=parseInt(t);return!Number.isNaN(n)?n:0}});var an={IsOpera:ve.isOpera,IsIE:ve.isIE,IsIE6:ve.isIE6,IsIE7:ve.isIE7,IsIE8:ve.isIE8,IsIE9:ve.isIE9,IsIE10:ve.isIE10,IsIE11:ve.isIE11,IsSafari:ve.isSafari,IsFirefox:ve.isFirefox,IsChrome:ve.isChrome,DetectIeVersion:ve.detectIEVersion,IsMac:ve.isMac,IsAndroid:ve.isAndroid,isIPad:ve.isIPad,isIPhone:ve.isIPhone,IsIOS:ve.isIOS,IsMobile:ve.isMobile,isRetina:ve.isRetina,IsDoctype:ve.isDoctype,SupportLocalStorage:ve.isLocalStorageSupported,addGlobalClass:ve.addGlobalClass,DetectAndroidVersion:ve.detectAndroidVersion,isPropertySupported:ve.isPropertySupported,addGlobalFeatures:ve.addGlobalFeatures};var ln=window.BX?window.BX.ajax:function(){};function un(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:document;return{scrollWidth:e.documentElement.scrollWidth,scrollHeight:e.documentElement.scrollHeight}}function cn(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:document;var t=St(e);return{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}}function fn(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:document;var t=St(e);return{innerWidth:t.innerWidth,innerHeight:t.innerHeight}}function dn(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:document;return kt(kt(kt({},fn(e)),cn(e)),un(e))}function hn(e){return St(e)}function pn(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;if(!e){return(new DOMRect).toJSON()}if(e.ownerDocument===document&&!t){var n=e.getBoundingClientRect();var i=document.documentElement;var r=document,s=r.body;return{top:Math.round(n.top+(i.scrollTop||s.scrollTop)),left:Math.round(n.left+(i.scrollLeft||s.scrollLeft)),width:Math.round(n.right-n.left),height:Math.round(n.bottom-n.top),right:Math.round(n.right+(i.scrollLeft||s.scrollLeft)),bottom:Math.round(n.bottom+(i.scrollTop||s.scrollTop))}}var o=0;var a=0;var l=e.offsetWidth;var c=e.offsetHeight;var f=true;for(;e!=null;e=e.offsetParent){if(!f&&t&&BX.is_relative(e)){break}o+=e.offsetLeft;a+=e.offsetTop;if(f){f=false;continue}o+=u.toNumber(me.style(e,"border-left-width"));a+=u.toNumber(me.style(e,"border-top-width"))}return new DOMRect(o,a,l,c).toJSON()}function mn(e,t,n){if(i.isString(e)){n=t;t=e;e=le.GLOBAL_TARGET}if(e===window){e=le.GLOBAL_TARGET}if(!i.isObject(e)){console.error('The "eventObject" argument must be an object. Received type '+babelHelpers["typeof"](e)+".");return}if(!i.isStringFilled(t)){console.error('The "eventName" argument must be a string.');return}if(!i.isFunction(n)){console.error('The "eventHandler" argument must be a function. Received type '+babelHelpers["typeof"](n)+".");return}t=t.toLowerCase();le.subscribe(e,t,n,{compatMode:true,useGlobalNaming:true})}function gn(e,t,n,r){if(i.isString(e)){r=n;n=t;t=e;e=le.GLOBAL_TARGET}if(!i.isObject(e)||e===window){e=le.GLOBAL_TARGET}if(!n){n=[]}t=t.toLowerCase();var s=new Q;s.setData(n);s.setCompatData(n);le.emit(e,t,s,{cloneData:r===true,useGlobalNaming:true})}function vn(e,t,n){if(i.isString(e)){n=t;t=e;e=le.GLOBAL_TARGET}if(!i.isFunction(n)){console.error('The "eventHandler" argument must be a function. Received type '+babelHelpers["typeof"](n)+".");return}if(e===window){e=le.GLOBAL_TARGET}t=t.toLowerCase();le.unsubscribe(e,t,n,{useGlobalNaming:true})}function yn(e,t){if(i.isString(e)){t=e;e=le.GLOBAL_TARGET}if(e===window){e=le.GLOBAL_TARGET}t=t.toLowerCase();le.unsubscribeAll(e,t,{useGlobalNaming:true})}e.Type=i;e.Reflection=r;e.Text=u;e.Dom=me;e.Browser=ve;e.Event=fe;e.Http=ke;e.Runtime=K;e.Loc=Ee;e.Tag=He;e.Uri=Ke;e.Validation=Ye;e.Cache=tt;e.BaseError=J;e.ZIndexManager=ht;e.Extension=bt;e.getClass=Ct;e.namespace=Et;e.message=_t;e.replace=xt;e.remove=Tt;e.clean=Ot;e.insertBefore=Mt;e.insertAfter=Dt;e.append=At;e.prepend=Pt;e.style=Lt;e.adjust=Rt;e.create=Ht;e.isShown=jt;e.addClass=Nt;e.removeClass=Bt;e.hasClass=Ft;e.toggleClass=Ut;e.cleanNode=Wt;e.getCookie=$t;e.setCookie=Vt;e.bind=Gt;e.unbind=zt;e.unbindAll=Xt;e.bindOnce=qt;e.ready=Kt;e.debugEnableFlag=Yt;e.debugStatus=Jt;e.debug=Qt;e.debugEnable=Zt;e.clone=en;e.loadExt=tn;e.debounce=nn;e.throttle=rn;e.html=sn;e.type=on;e.browser=an;e.ajax=ln;e.GetWindowScrollSize=un;e.GetWindowScrollPos=cn;e.GetWindowInnerSize=fn;e.GetWindowSize=dn;e.GetContext=hn;e.pos=pn;e.addCustomEvent=mn;e.onCustomEvent=gn;e.removeCustomEvent=vn;e.removeAllCustomEvents=yn})(this.BX=this.BX||{})})();(function(){"use strict";try{new window.CustomEvent("bx-test-custom-event",{bubbles:true,cancelable:true})}catch(t){var e=function(e,t){t=t||{};t.bubbles=!!t.bubbles;t.cancelable=!!t.cancelable;var n=document.createEvent("CustomEvent");n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail);var i=n.preventDefault;n.preventDefault=function(){Object.defineProperty(this,"defaultPrevented",{get:function(){return true}});i.call(this)};return n};e.prototype=window.Event.prototype;window.CustomEvent=e}})();(function(){if(typeof this.BX!=="undefined"&&typeof this.BX.WidgetVue!=="undefined"){var e="2.6.14";if(this.BX.WidgetVue.version()!==e){console.warn("BX.WidgetVue already loaded. Loaded: "+this.BX.WidgetVue.version()+", Skipped: "+e+". Version differences may cause errors!")}return}(function(e,t,n,i,r){"use strict";function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){babelHelpers.defineProperty(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var a=function(){function e(t){babelHelpers.classCallCheck(this,e);this._appCounter=0;this._components={};this._mutations={};this._clones={};this._instance=t;this._instance.use(this);this.event=new t;this.events={restClientChange:"RestClient::change",pullClientChange:"PullClient::change"};var i=n.Extension.getSettings("ui.vue");this.localizationMode=i.get("localizationDebug",false)?"development":"production"}babelHelpers.createClass(e,[{key:"create",value:function t(n){e.showNotice("Method Vue.create is deprecated, use BitrixVue.createApp instead.\n"+'If you are using "el" property or .$mount(...) to bind your application, use .mount(...) instead.');return this.createApp(n)}},{key:"createApp",value:function e(s){var a=this;var l={};l.Loc={messages:{},getMessage:function e(t){var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;if(a.localizationMode==="development"){var r=[t];if(n.Type.isPlainObject(i)){var s=Object.keys(i);if(s.length>0){r=[t," (replacements: ",s.join(", "),")"]}}return r.join("")}var o="";if(!n.Type.isUndefined(this.messages[t])){o=this.messages[t]}else{o=n.Loc.getMessage(t);this.messages[t]=o}if(n.Type.isString(o)&&n.Type.isPlainObject(i)){Object.keys(i).forEach((function(e){var t=new RegExp(e,"gi");o=o.replace(t,(function(){return n.Type.isNil(i[e])?"":String(i[e])}))}))}return o},hasMessage:function e(t){return n.Type.isString(t)&&!n.Type.isNil(this.getMessages()[t])},getMessages:function e(){if(typeof BX.message!=="undefined"){return o(o({},BX.message),this.messages)}return o({},this.messages)},setMessage:function e(t,i){if(n.Type.isString(t)){this.messages[t]=i}if(n.Type.isObject(t)){for(var r in t){if(t.hasOwnProperty(r)){this.messages[r]=t[r]}}}}};l.Application={instance:null,get:function e(){return this.instance},set:function e(t){this.instance=t}};l.Data={data:{},get:function e(t,n){var i;return(i=this.data[t])!==null&&i!==void 0?i:n},set:function e(t,n){this.data[t]=n}};l.eventEmitter=new t.EventEmitter;if(typeof l.eventEmitter.setEventNamespace==="function"){this._appCounter++;l.eventEmitter.setEventNamespace("vue:app:"+this._appCounter)}else{window.BX.Event.EventEmitter.prototype.setEventNamespace=function(){};l.eventEmitter.setEventNamespace=function(){}}l.RestClient={instance:null,get:function e(){var t;return(t=this.instance)!==null&&t!==void 0?t:i.rest},set:function e(t){this.instance=t;l.eventEmitter.emit(a.events.restClientChange)},isCustom:function e(){return this.instance!==null}};l.PullClient={instance:null,get:function e(){var t;return(t=this.instance)!==null&&t!==void 0?t:r.PULL},set:function e(t){this.instance=t;l.eventEmitter.emit(a.events.pullClientChange)},isCustom:function e(){return this.instance!==null}};if(typeof s.mixins==="undefined"){s.mixins=[]}s.mixins.unshift({beforeCreate:function e(){this.$bitrix=l}});var u=new this._instance(s);u.mount=function(e){return this.$mount(e)};return u}},{key:"component",value:function e(t,n){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};if(!n.name){n.name=t}this._components[t]=Object.assign({},n);this._components[t].bitrixOptions={immutable:i.immutable===true,local:i.local===true};if(typeof this._clones[t]!=="undefined"){this._registerCloneComponent(t)}var r=this._getFinalComponentParams(t);if(this.isLocal(t)){return r}return this._instance.component(t,r)}},{key:"localComponent",value:function e(t,n){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};return this.component(t,n,o(o({},i),{},{local:true}))}},{key:"getLocalComponent",value:function t(n){if(!this.isComponent(n)){e.showNotice('Component "'+n+'" is not registered yet.');return null}if(!this.isLocal(n)){e.showNotice('You cannot get the component "'+n+'" because it is marked as global.');return null}return this._getFinalComponentParams(n)}},{key:"mutateComponent",value:function t(n,i){var r=this;var s=this.isMutable(n);if(s===false){e.showNotice('You cannot mutate the component "'+n+'" because it is marked as immutable, perhaps cloning the component is fine for you.');return false}if(typeof this._mutations[n]==="undefined"){this._mutations[n]=[]}this._mutations[n].push(i);if(typeof this._components[n]!=="undefined"&&!this.isLocal(n)){this.component(n,this._components[n],this._components[n].bitrixOptions)}return function(){r._mutations[n]=r._mutations[n].filter((function(e){return e!==i}))}}},{key:"cloneComponent",value:function e(t,n,i){if(this.isLocal(n)){var r=this.getLocalComponent(n);r.name=t;this.component(t,r,{immutable:false,local:true});this.mutateComponent(t,i);return true}if(typeof this._clones[n]==="undefined"){this._clones[n]={}}this._clones[n][t]={id:t,sourceId:n,mutations:i};if(typeof this._components[n]!=="undefined"){this._registerCloneComponent(n,t)}return true}},{key:"cloneLocalComponent",value:function e(t,n){if(babelHelpers["typeof"](t)!=="object"){t=this.getLocalComponent(t);if(!t){return null}}return this._applyMutation(this._cloneObjectWithoutDuplicateFunction(t,n),n)}},{key:"isComponent",value:function e(t){return typeof this._components[t]!=="undefined"}},{key:"isMutable",value:function e(t){if(typeof this._components[t]==="undefined"){return undefined}return!this._components[t].bitrixOptions.immutable}},{key:"isLocal",value:function e(t){if(typeof this._components[t]==="undefined"){return undefined}return this._components[t].bitrixOptions.local===true}},{key:"extend",value:function e(t){return this._instance.extend(t)}},{key:"nextTick",value:function e(t,n){return this._instance.nextTick(t,n)}},{key:"set",value:function e(t,n,i){return this._instance.set(t,n,i)}},{key:"delete",value:function e(t,n){return this._instance["delete"](t,n)}},{key:"directive",value:function e(t,n){return this._instance.directive(t,n)}},{key:"filter",value:function e(t,n){return this._instance.filter(t,n)}},{key:"use",value:function e(t){return this._instance.use(t)}},{key:"mixin",value:function e(t){return this._instance.mixin(t)}},{key:"observable",value:function e(t){return this._instance.observable(t)}},{key:"compile",value:function e(t){return this._instance.compile(t)}},{key:"version",value:function e(){return this._instance.version}},{key:"testNode",value:function e(t,n){if(!n||babelHelpers["typeof"](n)!=="object"){return true}var i,r,s;for(i in n){if(!n.hasOwnProperty(i)){continue}switch(i){case"tag":case"tagName":if(typeof n[i]==="string"){if(t.tagName.toUpperCase()!==n[i].toUpperCase()){return false}}else if(n[i]instanceof RegExp){if(!n[i].test(t.tagName)){return false}}break;case"class":case"className":if(typeof n[i]==="string"){if(!t.classList.contains(n[i].trim())){return false}}else if(n[i]instanceof RegExp){if(typeof t.className!=="string"||!n[i].test(t.className)){return false}}break;case"attr":case"attrs":case"attribute":if(typeof n[i]==="string"){if(!t.getAttribute(n[i])){return false}}else if(n[i]&&Object.prototype.toString.call(n[i])==="[object Array]"){for(r=0,s=n[i].length;r<s;r++){if(n[i][r]&&!t.getAttribute(n[i][r])){return false}}}else{for(r in n[i]){if(!n[i].hasOwnProperty(r)){continue}var o=t.getAttribute(r);if(typeof o!=="string"){return false}if(n[i][r]instanceof RegExp){if(!n[i][r].test(o)){return false}}else if(o!==""+n[i][r]){return false}}}break;case"property":case"props":if(typeof n[i]==="string"){if(!t[n[i]]){return false}}else if(n[i]&&Object.prototype.toString.call(n[i])=="[object Array]"){for(r=0,s=n[i].length;r<s;r++){if(n[i][r]&&!t[n[i][r]]){return false}}}else{for(r in n[i]){if(!n[i].hasOwnProperty(r)){continue}if(typeof n[i][r]==="string"){if(t[r]!=n[i][r]){return false}}else if(n[i][r]instanceof RegExp){if(typeof t[r]!=="string"||!n[i][r].test(t[r])){return false}}}}break}}return true}},{key:"getFilteredPhrases",value:function e(t){var i=this;var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;var s={};if(!r&&typeof BX.message!=="undefined"){r=BX.message}else if(n.Type.isObject(r)&&n.Type.isObject(r.$Bitrix)){r=r.$Bitrix.Loc.getMessages()}if(Array.isArray(t)){var o=function e(n){if(!r.hasOwnProperty(n)){return"continue"}if(!t.find((function(e){return n.toString().startsWith(e)}))){return"continue"}if(i.localizationMode==="development"){s[n]=n}else{s[n]=r[n]}};for(var a in r){var l=o(a);if(l==="continue")continue}}else{for(var u in r){if(!r.hasOwnProperty(u)){continue}if(!u.startsWith(t)){continue}if(this.localizationMode==="development"){s[u]=u}else{s[u]=r[u]}}}return Object.freeze(s)}},{key:"_getComponentParamsWithMutation",value:function e(t,n){var i=this;if(typeof this._components[t]==="undefined"){return null}var r=Object.assign({},this._components[t]);if(typeof n==="undefined"){return r}n.forEach((function(e){r=i._applyMutation(i._cloneObjectWithoutDuplicateFunction(r,e),e)}));return r}},{key:"_getFinalComponentParams",value:function e(t){var n=this.isMutable(t)?this._mutations[t]:undefined;return this._getComponentParamsWithMutation(t,n)}},{key:"_registerCloneComponent",value:function e(t){var n=this;var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;var r=[];if(i){if(typeof this._clones[t][i]!=="undefined"){r.push(this._clones[t][i])}}else{for(var s in this._clones[t]){if(!this._clones[t].hasOwnProperty(s)){continue}r.push(this._clones[t][s])}}r.forEach((function(e){var t=[];if(typeof n._mutations[e.sourceId]!=="undefined"){t=t.concat(n._mutations[e.sourceId])}t.push(e.mutations);var i=n._getComponentParamsWithMutation(e.sourceId,t);if(!i){return false}n.component(e.id,i)}))}},{key:"_cloneObjectWithoutDuplicateFunction",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:1;var s=arguments.length>3&&arguments[3]!==undefined?arguments[3]:"";var o={};for(var a in t){if(!t.hasOwnProperty(a)){continue}if(n.Type.isString(t[a])){o[a]=t[a]}else if(n.Type.isArray(t[a])){o[a]=[].concat(t[a])}else if(n.Type.isObjectLike(t[a])){if(s==="watch"||s==="props"||s==="directives"){o[a]=t[a]}else if(n.Type.isNull(t[a])){o[a]=null}else if(n.Type.isObjectLike(i[a])){o[a]=this._cloneObjectWithoutDuplicateFunction(t[a],i[a],r+1,a)}else{o[a]=Object.assign({},t[a])}}else if(n.Type.isFunction(t[a])){if(!n.Type.isFunction(i[a])){o[a]=t[a]}else if(r>1){if(s==="watch"){o[a]=t[a]}else{o["parent"+a[0].toUpperCase()+a.substr(1)]=t[a]}}else{if(n.Type.isUndefined(o["methods"])){o["methods"]={}}o["methods"]["parent"+a[0].toUpperCase()+a.substr(1)]=t[a];if(n.Type.isUndefined(t["methods"])){t["methods"]={}}t["methods"]["parent"+a[0].toUpperCase()+a.substr(1)]=t[a]}}else if(!n.Type.isUndefined(t[a])){o[a]=t[a]}}return o}},{key:"_applyMutation",value:function e(){var t=this;var i=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var s=arguments.length>2&&arguments[2]!==undefined?arguments[2]:1;var o=Object.assign({},i);var a=function e(i){if(!r.hasOwnProperty(i)){return"continue"}if(s===1&&(i==="compilerOptions"||i==="setup")){o[i]=r[i]}else if(s===1&&i==="extends"){o[i]=r[i]}else if(n.Type.isString(r[i])){if(n.Type.isString(o[i])){o[i]=r[i].replace("#PARENT_".concat(i.toUpperCase(),"#"),o[i])}else{o[i]=r[i].replace("#PARENT_".concat(i.toUpperCase(),"#"),"")}}else if(n.Type.isArray(r[i])){if(s===1&&i==="replaceMixins"){o["mixins"]=[].concat(r[i])}else if(s===1&&i==="replaceInject"){o["inject"]=[].concat(r[i])}else if(s===1&&i==="replaceEmits"){o["emits"]=[].concat(r[i])}else if(s===1&&i==="replaceExpose"){o["expose"]=[].concat(r[i])}else if(n.Type.isPlainObject(o[i])){r[i].forEach((function(e){return o[i][e]=null}))}else{o[i]=o[i].concat(r[i])}}else if(n.Type.isObjectLike(r[i])){if(s===1&&i==="props"&&n.Type.isArray(o[i])||s===1&&i==="emits"&&n.Type.isArray(o[i])){var a={};o[i].forEach((function(e){a[e]=null}));o[i]=a}if(s===1&&i==="watch"){for(var l in o[i]){if(!o[i].hasOwnProperty(l)){continue}if(l.includes(".")){continue}if(n.Type.isFunction(o[i][l])||n.Type.isObject(o[i][l])&&n.Type.isFunction(o[i][l]["handler"])){if(n.Type.isUndefined(o["methods"])){o["methods"]={}}var u="parentWatch"+l[0].toUpperCase()+l.substr(1);if(n.Type.isFunction(o[i][l])){o["methods"][u]=o[i][l]}else{o["methods"][u]=o[i][l]["handler"]}}}}if(s===1&&i==="replaceEmits"){o["emits"]=Object.assign({},r[i])}else if(s===1&&(i==="components"||i==="directives")){if(n.Type.isUndefined(o[i])){o[i]={}}for(var c in r[i]){if(!r[i].hasOwnProperty(c)){continue}var f=c[0].toUpperCase()+c.substr(1);f=i==="components"?"Parent"+f:"parent"+f;o[i][f]=Object.assign({},o[i][c]);if(i==="components"){if(n.Type.isUndefined(r[i][c].components)){r[i][c].components={}}r[i][c].components=Object.assign(babelHelpers.defineProperty({},f,o[i][c]),r[i][c].components)}o[i][c]=r[i][c]}}else if(n.Type.isArray(o[i])){for(var d in r[i]){if(!r[i].hasOwnProperty(d)){continue}o[i].push(d)}}else if(n.Type.isObjectLike(o[i])){o[i]=t._applyMutation(o[i],r[i],s+1)}else{o[i]=r[i]}}else{o[i]=r[i]}};for(var l in r){var u=a(l);if(u==="continue")continue}return o}},{key:"install",value:function t(i,r){i.mixin({beforeCreate:function e(){if(typeof this.$root!=="undefined"){this.$bitrix=this.$root.$bitrix}},computed:{$Bitrix:function e(){return this.$root.$bitrix}},mounted:function t(){if(!n.Type.isNil(this.$root.$bitrixApplication)){e.showNotice("Store reference in global variables (like: this.$bitrixApplication) is deprecated, use this.$Bitrix.Data.set(...) instead.")}if(!n.Type.isNil(this.$root.$bitrixController)){e.showNotice("Store reference in global variables (like: this.$bitrixController) is deprecated, use this.$Bitrix.Data.set(...) instead.")}if(!n.Type.isNil(this.$root.$bitrixMessages)){e.showNotice("Store localization in global variable this.$bitrixMessages is deprecated, use this.$Bitrix.Log.setMessage(...) instead.")}if(!n.Type.isNil(this.$root.$bitrixRestClient)){e.showNotice("Working with a Rest-client through an old variable this.$bitrixRestClient is deprecated, use this.$Bitrix.RestClient.get() instead.")}if(!n.Type.isNil(this.$root.$bitrixPullClient)){e.showNotice("Working with a Pull-client through an old variable this.$bitrixPullClient is deprecated, use this.$Bitrix.PullClient.get() instead.")}}})}}],[{key:"showNotice",value:function t(n){if(e.developerMode){console.warn("BitrixVue: "+n)}}}]);return e}();babelHelpers.defineProperty(a,"developerMode",false);
/*!
	 * Vue.js v2.6.14
	 * (c) 2014-2021 Evan You
	 * Released under the MIT License.
	 *
	 * @source: https://cdn.jsdelivr.net/npm/vue@2.6.14/dist/vue.esm.browser.min.js
	 */var l=Object.freeze({});function u(e){return null==e}function c(e){return null!=e}function f(e){return!0===e}function d(e){return"string"==typeof e||"number"==typeof e||"symbol"==babelHelpers["typeof"](e)||"boolean"==typeof e}function h(e){return null!==e&&"object"==babelHelpers["typeof"](e)}var p=Object.prototype.toString;function m(e){return"[object Object]"===p.call(e)}function g(e){var t=parseFloat(String(e));return t>=0&&Math.floor(t)===t&&isFinite(e)}function v(e){return c(e)&&"function"==typeof e.then&&"function"==typeof e["catch"]}function y(e){return null==e?"":Array.isArray(e)||m(e)&&e.toString===p?JSON.stringify(e,null,2):String(e)}function b(e){var t=parseFloat(e);return isNaN(t)?e:t}function w(e,t){var n=Object.create(null),i=e.split(",");for(var r=0;r<i.length;r++){n[i[r]]=!0}return t?function(e){return n[e.toLowerCase()]}:function(e){return n[e]}}var S=w("slot,component",!0),I=w("key,ref,slot,slot-scope,is");function k(e,t){if(e.length){var n=e.indexOf(t);if(n>-1)return e.splice(n,1)}}var C=Object.prototype.hasOwnProperty;function E(e,t){return C.call(e,t)}function _(e){var t=Object.create(null);return function(n){return t[n]||(t[n]=e(n))}}var x=/-(\w)/g,T=_((function(e){return e.replace(x,(function(e,t){return t?t.toUpperCase():""}))})),O=_((function(e){return e.charAt(0).toUpperCase()+e.slice(1)})),M=/\B([A-Z])/g,D=_((function(e){return e.replace(M,"-$1").toLowerCase()}));var A=Function.prototype.bind?function(e,t){return e.bind(t)}:function(e,t){function n(n){var i=arguments.length;return i?i>1?e.apply(t,arguments):e.call(t,n):e.call(t)}return n._length=e.length,n};function P(e,t){t=t||0;var n=e.length-t;var i=new Array(n);for(;n--;){i[n]=e[n+t]}return i}function L(e,t){for(var n in t){e[n]=t[n]}return e}function R(e){var t={};for(var n=0;n<e.length;n++){e[n]&&L(t,e[n])}return t}function H(e,t,n){}var j=function e(t,n,i){return!1},N=function e(t){return t};function B(e,t){if(e===t)return!0;var n=h(e),i=h(t);if(!n||!i)return!n&&!i&&String(e)===String(t);try{var r=Array.isArray(e),s=Array.isArray(t);if(r&&s)return e.length===t.length&&e.every((function(e,n){return B(e,t[n])}));if(e instanceof Date&&t instanceof Date)return e.getTime()===t.getTime();if(r||s)return!1;{var o=Object.keys(e),a=Object.keys(t);return o.length===a.length&&o.every((function(n){return B(e[n],t[n])}))}}catch(e){return!1}}function F(e,t){for(var n=0;n<e.length;n++){if(B(e[n],t))return n}return-1}function U(e){var t=!1;return function(){t||(t=!0,e.apply(this,arguments))}}var W="data-server-rendered",$=["component","directive","filter"],V=["beforeCreate","created","beforeMount","mounted","beforeUpdate","updated","beforeDestroy","destroyed","activated","deactivated","errorCaptured","serverPrefetch"];var G={optionMergeStrategies:Object.create(null),silent:!1,productionTip:!1,devtools:!1,performance:!1,errorHandler:null,warnHandler:null,ignoredElements:[],keyCodes:Object.create(null),isReservedTag:j,isReservedAttr:j,isUnknownElement:j,getTagNamespace:H,parsePlatformTagName:N,mustUseProp:j,async:!0,_lifecycleHooks:V};var z=/a-zA-Z\u00B7\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u037D\u037F-\u1FFF\u200C-\u200D\u203F-\u2040\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD/;function X(e){var t=(e+"").charCodeAt(0);return 36===t||95===t}function q(e,t,n,i){Object.defineProperty(e,t,{value:n,enumerable:!!i,writable:!0,configurable:!0})}var K=new RegExp("[^".concat(z.source,".$_\\d]"));var Y="__proto__"in{},J="undefined"!=typeof window,Q="undefined"!=typeof WXEnvironment&&!!WXEnvironment.platform,Z=Q&&WXEnvironment.platform.toLowerCase(),ee=J&&window.navigator.userAgent.toLowerCase(),te=ee&&/msie|trident/.test(ee),ne=ee&&ee.indexOf("msie 9.0")>0,ie=ee&&ee.indexOf("edge/")>0,re=(ee&&ee.indexOf("android"),ee&&/iphone|ipad|ipod|ios/.test(ee)||"ios"===Z),se=(ee&&/chrome\/\d+/.test(ee),ee&&/phantomjs/.test(ee),ee&&ee.match(/firefox\/(\d+)/)),oe={}.watch;var ae,le=!1;if(J)try{var ue={};Object.defineProperty(ue,"passive",{get:function e(){le=!0}}),window.addEventListener("test-passive",null,ue)}catch(l){}var ce=function e(){return void 0===ae&&(ae=!J&&!Q&&"undefined"!=typeof global&&global.process&&"server"===global.process.env.VUE_ENV),ae},fe=J&&window.__VUE_DEVTOOLS_GLOBAL_HOOK__;function de(e){return"function"==typeof e&&/native code/.test(e.toString())}var he="undefined"!=typeof Symbol&&de(Symbol)&&"undefined"!=typeof Reflect&&de(Reflect.ownKeys);var pe;pe="undefined"!=typeof Set&&de(Set)?Set:function(){function e(){babelHelpers.classCallCheck(this,e);this.set=Object.create(null)}babelHelpers.createClass(e,[{key:"has",value:function e(t){return!0===this.set[t]}},{key:"add",value:function e(t){this.set[t]=!0}},{key:"clear",value:function e(){this.set=Object.create(null)}}]);return e}();var me=H,ge=0;var ve=function(){function e(){babelHelpers.classCallCheck(this,e);this.id=ge++,this.subs=[]}babelHelpers.createClass(e,[{key:"addSub",value:function e(t){this.subs.push(t)}},{key:"removeSub",value:function e(t){k(this.subs,t)}},{key:"depend",value:function t(){e.target&&e.target.addDep(this)}},{key:"notify",value:function e(){var t=this.subs.slice();for(var n=0,i=t.length;n<i;n++){t[n].update()}}}]);return e}();ve.target=null;var ye=[];function be(e){ye.push(e),ve.target=e}function we(){ye.pop(),ve.target=ye[ye.length-1]}var Se=function(){function e(t,n,i,r,s,o,a,l){babelHelpers.classCallCheck(this,e);this.tag=t,this.data=n,this.children=i,this.text=r,this.elm=s,this.ns=void 0,this.context=o,this.fnContext=void 0,this.fnOptions=void 0,this.fnScopeId=void 0,this.key=n&&n.key,this.componentOptions=a,this.componentInstance=void 0,this.parent=void 0,this.raw=!1,this.isStatic=!1,this.isRootInsert=!0,this.isComment=!1,this.isCloned=!1,this.isOnce=!1,this.asyncFactory=l,this.asyncMeta=void 0,this.isAsyncPlaceholder=!1}babelHelpers.createClass(e,[{key:"child",get:function e(){return this.componentInstance}}]);return e}();var Ie=function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"";var n=new Se;return n.text=t,n.isComment=!0,n};function ke(e){return new Se(void 0,void 0,void 0,String(e))}function Ce(e){var t=new Se(e.tag,e.data,e.children&&e.children.slice(),e.text,e.elm,e.context,e.componentOptions,e.asyncFactory);return t.ns=e.ns,t.isStatic=e.isStatic,t.key=e.key,t.isComment=e.isComment,t.fnContext=e.fnContext,t.fnOptions=e.fnOptions,t.fnScopeId=e.fnScopeId,t.asyncMeta=e.asyncMeta,t.isCloned=!0,t}var Ee=Array.prototype,_e=Object.create(Ee);["push","pop","shift","unshift","splice","sort","reverse"].forEach((function(e){var t=Ee[e];q(_e,e,(function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++){i[r]=arguments[r]}var s=t.apply(this,i),o=this.__ob__;var a;switch(e){case"push":case"unshift":a=i;break;case"splice":a=i.slice(2)}return a&&o.observeArray(a),o.dep.notify(),s}))}));var xe=Object.getOwnPropertyNames(_e);var Te=!0;function Oe(e){Te=e}var Me=function(){function e(t){babelHelpers.classCallCheck(this,e);var n;this.value=t,this.dep=new ve,this.vmCount=0,q(t,"__ob__",this),Array.isArray(t)?(Y?(n=_e,t.__proto__=n):function(e,t,n){for(var i=0,r=n.length;i<r;i++){var s=n[i];q(e,s,t[s])}}(t,_e,xe),this.observeArray(t)):this.walk(t)}babelHelpers.createClass(e,[{key:"walk",value:function e(t){var n=Object.keys(t);for(var i=0;i<n.length;i++){Ae(t,n[i])}}},{key:"observeArray",value:function e(t){for(var n=0,i=t.length;n<i;n++){De(t[n])}}}]);return e}();function De(e,t){if(!h(e)||e instanceof Se)return;var n;return E(e,"__ob__")&&e.__ob__ instanceof Me?n=e.__ob__:Te&&!ce()&&(Array.isArray(e)||m(e))&&Object.isExtensible(e)&&!e._isVue&&(n=new Me(e)),t&&n&&n.vmCount++,n}function Ae(e,t,n,i,r){var s=new ve,o=Object.getOwnPropertyDescriptor(e,t);if(o&&!1===o.configurable)return;var a=o&&o.get,l=o&&o.set;a&&!l||2!==arguments.length||(n=e[t]);var u=!r&&De(n);Object.defineProperty(e,t,{enumerable:!0,configurable:!0,get:function t(){var i=a?a.call(e):n;return ve.target&&(s.depend(),u&&(u.dep.depend(),Array.isArray(i)&&function e(t){for(var n,i=0,r=t.length;i<r;i++){(n=t[i])&&n.__ob__&&n.__ob__.dep.depend(),Array.isArray(n)&&e(n)}}(i))),i},set:function t(i){var o=a?a.call(e):n;i===o||i!=i&&o!=o||a&&!l||(l?l.call(e,i):n=i,u=!r&&De(i),s.notify())}})}function Pe(e,t,n){if(Array.isArray(e)&&g(t))return e.length=Math.max(e.length,t),e.splice(t,1,n),n;if(t in e&&!(t in Object.prototype))return e[t]=n,n;var i=e.__ob__;return e._isVue||i&&i.vmCount?n:i?(Ae(i.value,t,n),i.dep.notify(),n):(e[t]=n,n)}function Le(e,t){if(Array.isArray(e)&&g(t))return void e.splice(t,1);var n=e.__ob__;e._isVue||n&&n.vmCount||E(e,t)&&(delete e[t],n&&n.dep.notify())}var Re=G.optionMergeStrategies;function He(e,t){if(!t)return e;var n,i,r;var s=he?Reflect.ownKeys(t):Object.keys(t);for(var o=0;o<s.length;o++){"__ob__"!==(n=s[o])&&(i=e[n],r=t[n],E(e,n)?i!==r&&m(i)&&m(r)&&He(i,r):Pe(e,n,r))}return e}function je(e,t,n){return n?function(){var i="function"==typeof t?t.call(n,n):t,r="function"==typeof e?e.call(n,n):e;return i?He(i,r):r}:t?e?function(){return He("function"==typeof t?t.call(this,this):t,"function"==typeof e?e.call(this,this):e)}:t:e}function Ne(e,t){var n=t?e?e.concat(t):Array.isArray(t)?t:[t]:e;return n?function(e){var t=[];for(var n=0;n<e.length;n++){-1===t.indexOf(e[n])&&t.push(e[n])}return t}(n):n}function Be(e,t,n,i){var r=Object.create(e||null);return t?L(r,t):r}Re.data=function(e,t,n){return n?je(e,t,n):t&&"function"!=typeof t?e:je(e,t)},V.forEach((function(e){Re[e]=Ne})),$.forEach((function(e){Re[e+"s"]=Be})),Re.watch=function(e,t,n,i){if(e===oe&&(e=void 0),t===oe&&(t=void 0),!t)return Object.create(e||null);if(!e)return t;var r={};L(r,e);for(var s in t){var o=r[s];var a=t[s];o&&!Array.isArray(o)&&(o=[o]),r[s]=o?o.concat(a):Array.isArray(a)?a:[a]}return r},Re.props=Re.methods=Re.inject=Re.computed=function(e,t,n,i){if(!e)return t;var r=Object.create(null);return L(r,e),t&&L(r,t),r},Re.provide=je;var Fe=function e(t,n){return void 0===n?t:n};function Ue(e,t,n){if("function"==typeof t&&(t=t.options),function(e,t){var n=e.props;if(!n)return;var i={};var r,s,o;if(Array.isArray(n))for(r=n.length;r--;){"string"==typeof(s=n[r])&&(i[o=T(s)]={type:null})}else if(m(n))for(var a in n){s=n[a],i[o=T(a)]=m(s)?s:{type:s}}e.props=i}(t),function(e,t){var n=e.inject;if(!n)return;var i=e.inject={};if(Array.isArray(n))for(var r=0;r<n.length;r++){i[n[r]]={from:n[r]}}else if(m(n))for(var s in n){var o=n[s];i[s]=m(o)?L({from:s},o):{from:o}}}(t),function(e){var t=e.directives;if(t)for(var n in t){var i=t[n];"function"==typeof i&&(t[n]={bind:i,update:i})}}(t),!t._base&&(t["extends"]&&(e=Ue(e,t["extends"],n)),t.mixins))for(var i=0,r=t.mixins.length;i<r;i++){e=Ue(e,t.mixins[i],n)}var s={};var o;for(o in e){a(o)}for(o in t){E(e,o)||a(o)}function a(i){var r=Re[i]||Fe;s[i]=r(e[i],t[i],n,i)}return s}function We(e,t,n,i){if("string"!=typeof n)return;var r=e[t];if(E(r,n))return r[n];var s=T(n);if(E(r,s))return r[s];var o=O(s);return E(r,o)?r[o]:r[n]||r[s]||r[o]}function $e(e,t,n,i){var r=t[e],s=!E(n,e);var o=n[e];var a=Xe(Boolean,r.type);if(a>-1)if(s&&!E(r,"default"))o=!1;else if(""===o||o===D(e)){var l=Xe(String,r.type);(l<0||a<l)&&(o=!0)}if(void 0===o){o=function(e,t,n){if(!E(t,"default"))return;var i=t["default"];if(e&&e.$options.propsData&&void 0===e.$options.propsData[n]&&void 0!==e._props[n])return e._props[n];return"function"==typeof i&&"Function"!==Ge(t.type)?i.call(e):i}(i,r,e);var u=Te;Oe(!0),De(o),Oe(u)}return o}var Ve=/^\s*function (\w+)/;function Ge(e){var t=e&&e.toString().match(Ve);return t?t[1]:""}function ze(e,t){return Ge(e)===Ge(t)}function Xe(e,t){if(!Array.isArray(t))return ze(t,e)?0:-1;for(var n=0,i=t.length;n<i;n++){if(ze(t[n],e))return n}return-1}function qe(e,t,n){be();try{if(t){var i=t;for(;i=i.$parent;){var r=i.$options.errorCaptured;if(r)for(var s=0;s<r.length;s++){try{if(!1===r[s].call(i,e,t,n))return}catch(e){Ye(e,i,"errorCaptured hook")}}}}Ye(e,t,n)}finally{we()}}function Ke(e,t,n,i,r){var s;try{(s=n?e.apply(t,n):e.call(t))&&!s._isVue&&v(s)&&!s._handled&&(s["catch"]((function(e){return qe(e,i,r+" (Promise/async)")})),s._handled=!0)}catch(e){qe(e,i,r)}return s}function Ye(e,t,n){if(G.errorHandler)try{return G.errorHandler.call(null,e,t,n)}catch(t){t!==e&&Je(t,null,"config.errorHandler")}Je(e,t,n)}function Je(e,t,n){if(!J&&!Q||"undefined"==typeof console)throw e;console.error(e)}var Qe=!1;var Ze=[];var et,tt=!1;function nt(){tt=!1;var e=Ze.slice(0);Ze.length=0;for(var t=0;t<e.length;t++){e[t]()}}if("undefined"!=typeof Promise&&de(Promise)){var it=Promise.resolve();et=function e(){it.then(nt),re&&setTimeout(H)},Qe=!0}else if(te||"undefined"==typeof MutationObserver||!de(MutationObserver)&&"[object MutationObserverConstructor]"!==MutationObserver.toString())et="undefined"!=typeof setImmediate&&de(setImmediate)?function(){setImmediate(nt)}:function(){setTimeout(nt,0)};else{var rt=1;var st=new MutationObserver(nt),ot=document.createTextNode(String(rt));st.observe(ot,{characterData:!0}),et=function e(){rt=(rt+1)%2,ot.data=String(rt)},Qe=!0}function at(e,t){var n;if(Ze.push((function(){if(e)try{e.call(t)}catch(e){qe(e,t,"nextTick")}else n&&n(t)})),tt||(tt=!0,et()),!e&&"undefined"!=typeof Promise)return new Promise((function(e){n=e}))}var lt=new pe;function ut(e){!function e(t,n){var i,r;var s=Array.isArray(t);if(!s&&!h(t)||Object.isFrozen(t)||t instanceof Se)return;if(t.__ob__){var o=t.__ob__.dep.id;if(n.has(o))return;n.add(o)}if(s)for(i=t.length;i--;){e(t[i],n)}else for(r=Object.keys(t),i=r.length;i--;){e(t[r[i]],n)}}(e,lt),lt.clear()}var ct=_((function(e){var t="&"===e.charAt(0),n="~"===(e=t?e.slice(1):e).charAt(0),i="!"===(e=n?e.slice(1):e).charAt(0);return{name:e=i?e.slice(1):e,once:n,capture:i,passive:t}}));function ft(e,t){function n(){var e=n.fns;if(!Array.isArray(e))return Ke(e,null,arguments,t,"v-on handler");{var i=e.slice();for(var r=0;r<i.length;r++){Ke(i[r],null,arguments,t,"v-on handler")}}}return n.fns=e,n}function dt(e,t,n,i,r,s){var o,a,l,c,d;for(o in e){a=l=e[o],c=t[o],d=ct(o),u(l)||(u(c)?(u(l.fns)&&(l=e[o]=ft(l,s)),f(d.once)&&(l=e[o]=r(d.name,l,d.capture)),n(d.name,l,d.capture,d.passive,d.params)):l!==c&&(c.fns=l,e[o]=c))}for(o in t){u(e[o])&&i((d=ct(o)).name,t[o],d.capture)}}function ht(e,t,n){var i;e instanceof Se&&(e=e.data.hook||(e.data.hook={}));var r=e[t];function s(){n.apply(this,arguments),k(i.fns,s)}u(r)?i=ft([s]):c(r.fns)&&f(r.merged)?(i=r).fns.push(s):i=ft([r,s]),i.merged=!0,e[t]=i}function pt(e,t,n,i,r){if(c(t)){if(E(t,n))return e[n]=t[n],r||delete t[n],!0;if(E(t,i))return e[n]=t[i],r||delete t[i],!0}return!1}function mt(e){return d(e)?[ke(e)]:Array.isArray(e)?function e(t,n){var i=[];var r,s,o,a;for(r=0;r<t.length;r++){u(s=t[r])||"boolean"==typeof s||(o=i.length-1,a=i[o],Array.isArray(s)?s.length>0&&(gt((s=e(s,"".concat(n||"","_").concat(r)))[0])&&gt(a)&&(i[o]=ke(a.text+s[0].text),s.shift()),i.push.apply(i,s)):d(s)?gt(a)?i[o]=ke(a.text+s):""!==s&&i.push(ke(s)):gt(s)&&gt(a)?i[o]=ke(a.text+s.text):(f(t._isVList)&&c(s.tag)&&u(s.key)&&c(n)&&(s.key="__vlist".concat(n,"_").concat(r,"__")),i.push(s)))}return i}(e):void 0}function gt(e){return c(e)&&c(e.text)&&!1===e.isComment}function vt(e,t){if(e){var n=Object.create(null),i=he?Reflect.ownKeys(e):Object.keys(e);for(var r=0;r<i.length;r++){var s=i[r];if("__ob__"===s)continue;var o=e[s].from;var a=t;for(;a;){if(a._provided&&E(a._provided,o)){n[s]=a._provided[o];break}a=a.$parent}if(!a&&"default"in e[s]){var l=e[s]["default"];n[s]="function"==typeof l?l.call(t):l}}return n}}function yt(e,t){if(!e||!e.length)return{};var n={};for(var i=0,r=e.length;i<r;i++){var s=e[i],o=s.data;if(o&&o.attrs&&o.attrs.slot&&delete o.attrs.slot,s.context!==t&&s.fnContext!==t||!o||null==o.slot)(n["default"]||(n["default"]=[])).push(s);else{var a=o.slot,l=n[a]||(n[a]=[]);"template"===s.tag?l.push.apply(l,s.children||[]):l.push(s)}}for(var u in n){n[u].every(bt)&&delete n[u]}return n}function bt(e){return e.isComment&&!e.asyncFactory||" "===e.text}function wt(e){return e.isComment&&e.asyncFactory}function St(e,t,n){var i;var r=Object.keys(t).length>0,s=e?!!e.$stable:!r,o=e&&e.$key;if(e){if(e._normalized)return e._normalized;if(s&&n&&n!==l&&o===n.$key&&!r&&!n.$hasNormal)return n;i={};for(var a in e){e[a]&&"$"!==a[0]&&(i[a]=It(t,a,e[a]))}}else i={};for(var u in t){u in i||(i[u]=kt(t,u))}return e&&Object.isExtensible(e)&&(e._normalized=i),q(i,"$stable",s),q(i,"$key",o),q(i,"$hasNormal",r),i}function It(e,t,n){var i=function e(){var t=arguments.length?n.apply(null,arguments):n({}),i=(t=t&&"object"==babelHelpers["typeof"](t)&&!Array.isArray(t)?[t]:mt(t))&&t[0];return t&&(!i||1===t.length&&i.isComment&&!wt(i))?void 0:t};return n.proxy&&Object.defineProperty(e,t,{get:i,enumerable:!0,configurable:!0}),i}function kt(e,t){return function(){return e[t]}}function Ct(e,t){var n,i,r,s,o;if(Array.isArray(e)||"string"==typeof e)for(n=new Array(e.length),i=0,r=e.length;i<r;i++){n[i]=t(e[i],i)}else if("number"==typeof e)for(n=new Array(e),i=0;i<e;i++){n[i]=t(i+1,i)}else if(h(e))if(he&&e[Symbol.iterator]){n=[];var a=e[Symbol.iterator]();var l=a.next();for(;!l.done;){n.push(t(l.value,n.length)),l=a.next()}}else for(s=Object.keys(e),n=new Array(s.length),i=0,r=s.length;i<r;i++){o=s[i],n[i]=t(e[o],o,i)}return c(n)||(n=[]),n._isVList=!0,n}function Et(e,t,n,i){var r=this.$scopedSlots[e];var s;r?(n=n||{},i&&(n=L(L({},i),n)),s=r(n)||("function"==typeof t?t():t)):s=this.$slots[e]||("function"==typeof t?t():t);var o=n&&n.slot;return o?this.$createElement("template",{slot:o},s):s}function _t(e){return We(this.$options,"filters",e)||N}function xt(e,t){return Array.isArray(e)?-1===e.indexOf(t):e!==t}function Tt(e,t,n,i,r){var s=G.keyCodes[t]||n;return r&&i&&!G.keyCodes[t]?xt(r,i):s?xt(s,e):i?D(i)!==t:void 0===e}function Ot(e,t,n,i,r){if(n)if(h(n)){var s;Array.isArray(n)&&(n=R(n));var o=function o(a){if("class"===a||"style"===a||I(a))s=e;else{var l=e.attrs&&e.attrs.type;s=i||G.mustUseProp(t,l,a)?e.domProps||(e.domProps={}):e.attrs||(e.attrs={})}var u=T(a),c=D(a);if(!(u in s||c in s)&&(s[a]=n[a],r)){(e.on||(e.on={}))["update:".concat(a)]=function(e){n[a]=e}}};for(var a in n){o(a)}}return e}function Mt(e,t){var n=this._staticTrees||(this._staticTrees=[]);var i=n[e];return i&&!t?i:(At(i=n[e]=this.$options.staticRenderFns[e].call(this._renderProxy,null,this),"__static__".concat(e),!1),i)}function Dt(e,t,n){return At(e,"__once__".concat(t).concat(n?"_".concat(n):""),!0),e}function At(e,t,n){if(Array.isArray(e))for(var i=0;i<e.length;i++){e[i]&&"string"!=typeof e[i]&&Pt(e[i],"".concat(t,"_").concat(i),n)}else Pt(e,t,n)}function Pt(e,t,n){e.isStatic=!0,e.key=t,e.isOnce=n}function Lt(e,t){if(t)if(m(t)){var n=e.on=e.on?L({},e.on):{};for(var i in t){var r=n[i],s=t[i];n[i]=r?[].concat(r,s):s}}return e}function Rt(e,t,n,i){t=t||{$stable:!n};for(var r=0;r<e.length;r++){var s=e[r];Array.isArray(s)?Rt(s,t,n):s&&(s.proxy&&(s.fn.proxy=!0),t[s.key]=s.fn)}return i&&(t.$key=i),t}function Ht(e,t){for(var n=0;n<t.length;n+=2){var i=t[n];"string"==typeof i&&i&&(e[t[n]]=t[n+1])}return e}function jt(e,t){return"string"==typeof e?t+e:e}function Nt(e){e._o=Dt,e._n=b,e._s=y,e._l=Ct,e._t=Et,e._q=B,e._i=F,e._m=Mt,e._f=_t,e._k=Tt,e._b=Ot,e._v=ke,e._e=Ie,e._u=Rt,e._g=Lt,e._d=Ht,e._p=jt}function Bt(e,t,n,i,r){var s=this;var o=r.options;var a;E(i,"_uid")?(a=Object.create(i))._original=i:(a=i,i=i._original);var u=f(o._compiled),c=!u;this.data=e,this.props=t,this.children=n,this.parent=i,this.listeners=e.on||l,this.injections=vt(o.inject,i),this.slots=function(){return s.$slots||St(e.scopedSlots,s.$slots=yt(n,i)),s.$slots},Object.defineProperty(this,"scopedSlots",{enumerable:!0,get:function t(){return St(e.scopedSlots,this.slots())}}),u&&(this.$options=o,this.$slots=this.slots(),this.$scopedSlots=St(e.scopedSlots,this.$slots)),o._scopeId?this._c=function(e,t,n,r){var s=qt(a,e,t,n,r,c);return s&&!Array.isArray(s)&&(s.fnScopeId=o._scopeId,s.fnContext=i),s}:this._c=function(e,t,n,i){return qt(a,e,t,n,i,c)}}function Ft(e,t,n,i,r){var s=Ce(e);return s.fnContext=n,s.fnOptions=i,t.slot&&((s.data||(s.data={})).slot=t.slot),s}function Ut(e,t){for(var n in t){e[T(n)]=t[n]}}Nt(Bt.prototype);var Wt={init:function e(t,n){if(t.componentInstance&&!t.componentInstance._isDestroyed&&t.data.keepAlive){var i=t;Wt.prepatch(i,i)}else{(t.componentInstance=function(e,t){var n={_isComponent:!0,_parentVnode:e,parent:t},i=e.data.inlineTemplate;c(i)&&(n.render=i.render,n.staticRenderFns=i.staticRenderFns);return new e.componentOptions.Ctor(n)}(t,rn)).$mount(n?t.elm:void 0,n)}},prepatch:function e(t,n){var i=n.componentOptions;!function(e,t,n,i,r){var s=i.data.scopedSlots,o=e.$scopedSlots,a=!!(s&&!s.$stable||o!==l&&!o.$stable||s&&e.$scopedSlots.$key!==s.$key||!s&&e.$scopedSlots.$key),u=!!(r||e.$options._renderChildren||a);e.$options._parentVnode=i,e.$vnode=i,e._vnode&&(e._vnode.parent=i);if(e.$options._renderChildren=r,e.$attrs=i.data.attrs||l,e.$listeners=n||l,t&&e.$options.props){Oe(!1);var c=e._props,f=e.$options._propKeys||[];for(var d=0;d<f.length;d++){var h=f[d],p=e.$options.props;c[h]=$e(h,p,t,e)}Oe(!0),e.$options.propsData=t}n=n||l;var m=e.$options._parentListeners;e.$options._parentListeners=n,nn(e,n,m),u&&(e.$slots=yt(r,i.context),e.$forceUpdate())}(n.componentInstance=t.componentInstance,i.propsData,i.listeners,n,i.children)},insert:function e(t){var n=t.context,i=t.componentInstance;var r;i._isMounted||(i._isMounted=!0,ln(i,"mounted")),t.data.keepAlive&&(n._isMounted?((r=i)._inactive=!1,cn.push(r)):an(i,!0))},destroy:function e(t){var n=t.componentInstance;n._isDestroyed||(t.data.keepAlive?function e(t,n){if(n&&(t._directInactive=!0,on(t)))return;if(!t._inactive){t._inactive=!0;for(var i=0;i<t.$children.length;i++){e(t.$children[i])}ln(t,"deactivated")}}(n,!0):n.$destroy())}},$t=Object.keys(Wt);function Vt(e,t,n,i,r){if(u(e))return;var s=n.$options._base;if(h(e)&&(e=s.extend(e)),"function"!=typeof e)return;var o;if(u(e.cid)&&void 0===(e=function(e,t){if(f(e.error)&&c(e.errorComp))return e.errorComp;if(c(e.resolved))return e.resolved;var n=Yt;n&&c(e.owners)&&-1===e.owners.indexOf(n)&&e.owners.push(n);if(f(e.loading)&&c(e.loadingComp))return e.loadingComp;if(n&&!c(e.owners)){var i=e.owners=[n];var r=!0,s=null,o=null;n.$on("hook:destroyed",(function(){return k(i,n)}));var a=function e(t){for(var n=0,r=i.length;n<r;n++){i[n].$forceUpdate()}t&&(i.length=0,null!==s&&(clearTimeout(s),s=null),null!==o&&(clearTimeout(o),o=null))},l=U((function(n){e.resolved=Jt(n,t),r?i.length=0:a(!0)})),d=U((function(t){c(e.errorComp)&&(e.error=!0,a(!0))})),p=e(l,d);return h(p)&&(v(p)?u(e.resolved)&&p.then(l,d):v(p.component)&&(p.component.then(l,d),c(p.error)&&(e.errorComp=Jt(p.error,t)),c(p.loading)&&(e.loadingComp=Jt(p.loading,t),0===p.delay?e.loading=!0:s=setTimeout((function(){s=null,u(e.resolved)&&u(e.error)&&(e.loading=!0,a(!1))}),p.delay||200)),c(p.timeout)&&(o=setTimeout((function(){o=null,u(e.resolved)&&d(null)}),p.timeout)))),r=!1,e.loading?e.loadingComp:e.resolved}}(o=e,s)))return function(e,t,n,i,r){var s=Ie();return s.asyncFactory=e,s.asyncMeta={data:t,context:n,children:i,tag:r},s}(o,t,n,i,r);t=t||{},Mn(e),c(t.model)&&function(e,t){var n=e.model&&e.model.prop||"value",i=e.model&&e.model.event||"input";(t.attrs||(t.attrs={}))[n]=t.model.value;var r=t.on||(t.on={}),s=r[i],o=t.model.callback;c(s)?(Array.isArray(s)?-1===s.indexOf(o):s!==o)&&(r[i]=[o].concat(s)):r[i]=o}(e.options,t);var a=function(e,t,n){var i=t.options.props;if(u(i))return;var r={},s=e.attrs,o=e.props;if(c(s)||c(o))for(var a in i){var l=D(a);pt(r,o,a,l,!0)||pt(r,s,a,l,!1)}return r}(t,e);if(f(e.options.functional))return function(e,t,n,i,r){var s=e.options,o={},a=s.props;if(c(a))for(var u in a){o[u]=$e(u,a,t||l)}else c(n.attrs)&&Ut(o,n.attrs),c(n.props)&&Ut(o,n.props);var f=new Bt(n,o,r,i,e),d=s.render.call(null,f._c,f);if(d instanceof Se)return Ft(d,n,f.parent,s);if(Array.isArray(d)){var h=mt(d)||[],p=new Array(h.length);for(var m=0;m<h.length;m++){p[m]=Ft(h[m],n,f.parent,s)}return p}}(e,a,t,n,i);var d=t.on;if(t.on=t.nativeOn,f(e.options["abstract"])){var p=t.slot;t={},p&&(t.slot=p)}!function(e){var t=e.hook||(e.hook={});for(var n=0;n<$t.length;n++){var i=$t[n],r=t[i],s=Wt[i];r===s||r&&r._merged||(t[i]=r?Gt(s,r):s)}}(t);var m=e.options.name||r;return new Se("vue-component-".concat(e.cid).concat(m?"-".concat(m):""),t,void 0,void 0,void 0,n,{Ctor:e,propsData:a,listeners:d,tag:r,children:i},o)}function Gt(e,t){var n=function n(i,r){e(i,r),t(i,r)};return n._merged=!0,n}var zt=1,Xt=2;function qt(e,t,n,i,r,s){return(Array.isArray(n)||d(n))&&(r=i,i=n,n=void 0),f(s)&&(r=Xt),function(e,t,n,i,r){if(c(n)&&c(n.__ob__))return Ie();c(n)&&c(n.is)&&(t=n.is);if(!t)return Ie();Array.isArray(i)&&"function"==typeof i[0]&&((n=n||{}).scopedSlots={default:i[0]},i.length=0);r===Xt?i=mt(i):r===zt&&(i=function(e){for(var t=0;t<e.length;t++){if(Array.isArray(e[t]))return Array.prototype.concat.apply([],e)}return e}(i));var s,o;if("string"==typeof t){var a;o=e.$vnode&&e.$vnode.ns||G.getTagNamespace(t),s=G.isReservedTag(t)?new Se(G.parsePlatformTagName(t),n,i,void 0,void 0,e):n&&n.pre||!c(a=We(e.$options,"components",t))?new Se(t,n,i,void 0,void 0,e):Vt(a,n,e,i,t)}else s=Vt(t,n,e,i);return Array.isArray(s)?s:c(s)?(c(o)&&function e(t,n,i){t.ns=n;"foreignObject"===t.tag&&(n=void 0,i=!0);if(c(t.children))for(var r=0,s=t.children.length;r<s;r++){var o=t.children[r];c(o.tag)&&(u(o.ns)||f(i)&&"svg"!==o.tag)&&e(o,n,i)}}(s,o),c(n)&&function(e){h(e.style)&&ut(e.style);h(e["class"])&&ut(e["class"])}(n),s):Ie()}(e,t,n,i,r)}var Kt,Yt=null;function Jt(e,t){return(e.__esModule||he&&"Module"===e[Symbol.toStringTag])&&(e=e["default"]),h(e)?t.extend(e):e}function Qt(e){if(Array.isArray(e))for(var t=0;t<e.length;t++){var n=e[t];if(c(n)&&(c(n.componentOptions)||wt(n)))return n}}function Zt(e,t){Kt.$on(e,t)}function en(e,t){Kt.$off(e,t)}function tn(e,t){var n=Kt;return function i(){null!==t.apply(null,arguments)&&n.$off(e,i)}}function nn(e,t,n){Kt=e,dt(t,n||{},Zt,en,tn,e),Kt=void 0}var rn=null;function sn(e){var t=rn;return rn=e,function(){rn=t}}function on(e){for(;e&&(e=e.$parent);){if(e._inactive)return!0}return!1}function an(e,t){if(t){if(e._directInactive=!1,on(e))return}else if(e._directInactive)return;if(e._inactive||null===e._inactive){e._inactive=!1;for(var n=0;n<e.$children.length;n++){an(e.$children[n])}ln(e,"activated")}}function ln(e,t){be();var n=e.$options[t],i="".concat(t," hook");if(n)for(var r=0,s=n.length;r<s;r++){Ke(n[r],e,null,e,i)}e._hasHookEvent&&e.$emit("hook:"+t),we()}var un=[],cn=[];var fn={},dn=!1,hn=!1,pn=0;var mn=0,gn=Date.now;if(J&&!te){var vn=window.performance;vn&&"function"==typeof vn.now&&gn()>document.createEvent("Event").timeStamp&&(gn=function e(){return vn.now()})}function yn(){var e,t;for(mn=gn(),hn=!0,un.sort((function(e,t){return e.id-t.id})),pn=0;pn<un.length;pn++){(e=un[pn]).before&&e.before(),t=e.id,fn[t]=null,e.run()}var n=cn.slice(),i=un.slice();pn=un.length=cn.length=0,fn={},dn=hn=!1,function(e){for(var t=0;t<e.length;t++){e[t]._inactive=!0,an(e[t],!0)}}(n),function(e){var t=e.length;for(;t--;){var n=e[t],i=n.vm;i._watcher===n&&i._isMounted&&!i._isDestroyed&&ln(i,"updated")}}(i),fe&&G.devtools&&fe.emit("flush")}var bn=0;var wn=function(){function e(t,n,i,r,s){babelHelpers.classCallCheck(this,e);this.vm=t,s&&(t._watcher=this),t._watchers.push(this),r?(this.deep=!!r.deep,this.user=!!r.user,this.lazy=!!r.lazy,this.sync=!!r.sync,this.before=r.before):this.deep=this.user=this.lazy=this.sync=!1,this.cb=i,this.id=++bn,this.active=!0,this.dirty=this.lazy,this.deps=[],this.newDeps=[],this.depIds=new pe,this.newDepIds=new pe,this.expression="","function"==typeof n?this.getter=n:(this.getter=function(e){if(K.test(e))return;var t=e.split(".");return function(e){for(var n=0;n<t.length;n++){if(!e)return;e=e[t[n]]}return e}}(n),this.getter||(this.getter=H)),this.value=this.lazy?void 0:this.get()}babelHelpers.createClass(e,[{key:"get",value:function e(){var t;be(this);var n=this.vm;try{t=this.getter.call(n,n)}catch(t){if(!this.user)throw t;qe(t,n,'getter for watcher "'.concat(this.expression,'"'))}finally{this.deep&&ut(t),we(),this.cleanupDeps()}return t}},{key:"addDep",value:function e(t){var n=t.id;this.newDepIds.has(n)||(this.newDepIds.add(n),this.newDeps.push(t),this.depIds.has(n)||t.addSub(this))}},{key:"cleanupDeps",value:function e(){var t=this.deps.length;for(;t--;){var n=this.deps[t];this.newDepIds.has(n.id)||n.removeSub(this)}var i=this.depIds;this.depIds=this.newDepIds,this.newDepIds=i,this.newDepIds.clear(),i=this.deps,this.deps=this.newDeps,this.newDeps=i,this.newDeps.length=0}},{key:"update",value:function e(){this.lazy?this.dirty=!0:this.sync?this.run():function(e){var t=e.id;if(null==fn[t]){if(fn[t]=!0,hn){var n=un.length-1;for(;n>pn&&un[n].id>e.id;){n--}un.splice(n+1,0,e)}else un.push(e);dn||(dn=!0,at(yn))}}(this)}},{key:"run",value:function e(){if(this.active){var t=this.get();if(t!==this.value||h(t)||this.deep){var n=this.value;if(this.value=t,this.user){var i='callback for watcher "'.concat(this.expression,'"');Ke(this.cb,this.vm,[t,n],this.vm,i)}else this.cb.call(this.vm,t,n)}}}},{key:"evaluate",value:function e(){this.value=this.get(),this.dirty=!1}},{key:"depend",value:function e(){var t=this.deps.length;for(;t--;){this.deps[t].depend()}}},{key:"teardown",value:function e(){if(this.active){this.vm._isBeingDestroyed||k(this.vm._watchers,this);var t=this.deps.length;for(;t--;){this.deps[t].removeSub(this)}this.active=!1}}}]);return e}();var Sn={enumerable:!0,configurable:!0,get:H,set:H};function In(e,t,n){Sn.get=function(){return this[t][n]},Sn.set=function(e){this[t][n]=e},Object.defineProperty(e,n,Sn)}function kn(e){e._watchers=[];var t=e.$options;t.props&&function(e,t){var n=e.$options.propsData||{},i=e._props={},r=e.$options._propKeys=[];e.$parent&&Oe(!1);for(var s in t){r.push(s);var o=$e(s,t,n,e);Ae(i,s,o),s in e||In(e,"_props",s)}Oe(!0)}(e,t.props),t.methods&&function(e,t){e.$options.props;for(var n in t){e[n]="function"!=typeof t[n]?H:A(t[n],e)}}(e,t.methods),t.data?function(e){var t=e.$options.data;m(t=e._data="function"==typeof t?function(e,t){be();try{return e.call(t,t)}catch(e){return qe(e,t,"data()"),{}}finally{we()}}(t,e):t||{})||(t={});var n=Object.keys(t),i=e.$options.props;e.$options.methods;var r=n.length;for(;r--;){var s=n[r];i&&E(i,s)||X(s)||In(e,"_data",s)}De(t,!0)}(e):De(e._data={},!0),t.computed&&function(e,t){var n=e._computedWatchers=Object.create(null),i=ce();for(var r in t){var s=t[r],o="function"==typeof s?s:s.get;i||(n[r]=new wn(e,o||H,H,Cn)),r in e||En(e,r,s)}}(e,t.computed),t.watch&&t.watch!==oe&&function(e,t){for(var n in t){var i=t[n];if(Array.isArray(i))for(var r=0;r<i.length;r++){Tn(e,n,i[r])}else Tn(e,n,i)}}(e,t.watch)}var Cn={lazy:!0};function En(e,t,n){var i=!ce();"function"==typeof n?(Sn.get=i?_n(t):xn(n),Sn.set=H):(Sn.get=n.get?i&&!1!==n.cache?_n(t):xn(n.get):H,Sn.set=n.set||H),Object.defineProperty(e,t,Sn)}function _n(e){return function(){var t=this._computedWatchers&&this._computedWatchers[e];if(t)return t.dirty&&t.evaluate(),ve.target&&t.depend(),t.value}}function xn(e){return function(){return e.call(this,this)}}function Tn(e,t,n,i){return m(n)&&(i=n,n=n.handler),"string"==typeof n&&(n=e[n]),e.$watch(t,n,i)}var On=0;function Mn(e){var t=e.options;if(e["super"]){var n=Mn(e["super"]);if(n!==e.superOptions){e.superOptions=n;var i=function(e){var t;var n=e.options,i=e.sealedOptions;for(var r in n){n[r]!==i[r]&&(t||(t={}),t[r]=n[r])}return t}(e);i&&L(e.extendOptions,i),(t=e.options=Ue(n,e.extendOptions)).name&&(t.components[t.name]=e)}}return t}function Dn(e){this._init(e)}function An(e){e.cid=0;var t=1;e.extend=function(e){e=e||{};var n=this,i=n.cid,r=e._Ctor||(e._Ctor={});if(r[i])return r[i];var s=e.name||n.options.name,o=function e(t){this._init(t)};return(o.prototype=Object.create(n.prototype)).constructor=o,o.cid=t++,o.options=Ue(n.options,e),o["super"]=n,o.options.props&&function(e){var t=e.options.props;for(var n in t){In(e.prototype,"_props",n)}}(o),o.options.computed&&function(e){var t=e.options.computed;for(var n in t){En(e.prototype,n,t[n])}}(o),o.extend=n.extend,o.mixin=n.mixin,o.use=n.use,$.forEach((function(e){o[e]=n[e]})),s&&(o.options.components[s]=o),o.superOptions=n.options,o.extendOptions=e,o.sealedOptions=L({},o.options),r[i]=o,o}}function Pn(e){return e&&(e.Ctor.options.name||e.tag)}function Ln(e,t){return Array.isArray(e)?e.indexOf(t)>-1:"string"==typeof e?e.split(",").indexOf(t)>-1:(n=e,"[object RegExp]"===p.call(n)&&e.test(t));var n}function Rn(e,t){var n=e.cache,i=e.keys,r=e._vnode;for(var s in n){var o=n[s];if(o){var a=o.name;a&&!t(a)&&Hn(n,s,i,r)}}}function Hn(e,t,n,i){var r=e[t];!r||i&&r.tag===i.tag||r.componentInstance.$destroy(),e[t]=null,k(n,t)}!function(e){e.prototype._init=function(e){var t=this;t._uid=On++,t._isVue=!0,e&&e._isComponent?function(e,t){var n=e.$options=Object.create(e.constructor.options),i=t._parentVnode;n.parent=t.parent,n._parentVnode=i;var r=i.componentOptions;n.propsData=r.propsData,n._parentListeners=r.listeners,n._renderChildren=r.children,n._componentTag=r.tag,t.render&&(n.render=t.render,n.staticRenderFns=t.staticRenderFns)}(t,e):t.$options=Ue(Mn(t.constructor),e||{},t),t._renderProxy=t,t._self=t,function(e){var t=e.$options;var n=t.parent;if(n&&!t["abstract"]){for(;n.$options["abstract"]&&n.$parent;){n=n.$parent}n.$children.push(e)}e.$parent=n,e.$root=n?n.$root:e,e.$children=[],e.$refs={},e._watcher=null,e._inactive=null,e._directInactive=!1,e._isMounted=!1,e._isDestroyed=!1,e._isBeingDestroyed=!1}(t),function(e){e._events=Object.create(null),e._hasHookEvent=!1;var t=e.$options._parentListeners;t&&nn(e,t)}(t),function(e){e._vnode=null,e._staticTrees=null;var t=e.$options,n=e.$vnode=t._parentVnode,i=n&&n.context;e.$slots=yt(t._renderChildren,i),e.$scopedSlots=l,e._c=function(t,n,i,r){return qt(e,t,n,i,r,!1)},e.$createElement=function(t,n,i,r){return qt(e,t,n,i,r,!0)};var r=n&&n.data;Ae(e,"$attrs",r&&r.attrs||l,null,!0),Ae(e,"$listeners",t._parentListeners||l,null,!0)}(t),ln(t,"beforeCreate"),function(e){var t=vt(e.$options.inject,e);t&&(Oe(!1),Object.keys(t).forEach((function(n){Ae(e,n,t[n])})),Oe(!0))}(t),kn(t),function(e){var t=e.$options.provide;t&&(e._provided="function"==typeof t?t.call(e):t)}(t),ln(t,"created"),t.$options.el&&t.$mount(t.$options.el)}}(Dn),function(e){var t={get:function e(){return this._data}},n={get:function e(){return this._props}};Object.defineProperty(e.prototype,"$data",t),Object.defineProperty(e.prototype,"$props",n),e.prototype.$set=Pe,e.prototype.$delete=Le,e.prototype.$watch=function(e,t,n){var i=this;if(m(t))return Tn(i,e,t,n);(n=n||{}).user=!0;var r=new wn(i,e,t,n);if(n.immediate){var s='callback for immediate watcher "'.concat(r.expression,'"');be(),Ke(t,i,[r.value],i,s),we()}return function(){r.teardown()}}}(Dn),function(e){var t=/^hook:/;e.prototype.$on=function(e,n){var i=this;if(Array.isArray(e))for(var r=0,s=e.length;r<s;r++){i.$on(e[r],n)}else(i._events[e]||(i._events[e]=[])).push(n),t.test(e)&&(i._hasHookEvent=!0);return i},e.prototype.$once=function(e,t){var n=this;function i(){n.$off(e,i),t.apply(n,arguments)}return i.fn=t,n.$on(e,i),n},e.prototype.$off=function(e,t){var n=this;if(!arguments.length)return n._events=Object.create(null),n;if(Array.isArray(e)){for(var i=0,r=e.length;i<r;i++){n.$off(e[i],t)}return n}var s=n._events[e];if(!s)return n;if(!t)return n._events[e]=null,n;var o,a=s.length;for(;a--;){if((o=s[a])===t||o.fn===t){s.splice(a,1);break}}return n},e.prototype.$emit=function(e){var t=this;var n=t._events[e];if(n){n=n.length>1?P(n):n;var i=P(arguments,1),r='event handler for "'.concat(e,'"');for(var s=0,o=n.length;s<o;s++){Ke(n[s],t,i,t,r)}}return t}}(Dn),function(e){e.prototype._update=function(e,t){var n=this,i=n.$el,r=n._vnode,s=sn(n);n._vnode=e,n.$el=r?n.__patch__(r,e):n.__patch__(n.$el,e,t,!1),s(),i&&(i.__vue__=null),n.$el&&(n.$el.__vue__=n),n.$vnode&&n.$parent&&n.$vnode===n.$parent._vnode&&(n.$parent.$el=n.$el)},e.prototype.$forceUpdate=function(){var e=this;e._watcher&&e._watcher.update()},e.prototype.$destroy=function(){var e=this;if(e._isBeingDestroyed)return;ln(e,"beforeDestroy"),e._isBeingDestroyed=!0;var t=e.$parent;!t||t._isBeingDestroyed||e.$options["abstract"]||k(t.$children,e),e._watcher&&e._watcher.teardown();var n=e._watchers.length;for(;n--;){e._watchers[n].teardown()}e._data.__ob__&&e._data.__ob__.vmCount--,e._isDestroyed=!0,e.__patch__(e._vnode,null),ln(e,"destroyed"),e.$off(),e.$el&&(e.$el.__vue__=null),e.$vnode&&(e.$vnode.parent=null)}}(Dn),function(e){Nt(e.prototype),e.prototype.$nextTick=function(e){return at(e,this)},e.prototype._render=function(){var e=this,t=e.$options,n=t.render,i=t._parentVnode;var r;i&&(e.$scopedSlots=St(i.data.scopedSlots,e.$slots,e.$scopedSlots)),e.$vnode=i;try{Yt=e,r=n.call(e._renderProxy,e.$createElement)}catch(n){qe(n,e,"render"),r=e._vnode}finally{Yt=null}return Array.isArray(r)&&1===r.length&&(r=r[0]),r instanceof Se||(r=Ie()),r.parent=i,r}}(Dn);var jn=[String,RegExp,Array];var Nn={KeepAlive:{name:"keep-alive",abstract:!0,props:{include:jn,exclude:jn,max:[String,Number]},methods:{cacheVNode:function e(){var t=this.cache,n=this.keys,i=this.vnodeToCache,r=this.keyToCache;if(i){var s=i.tag,o=i.componentInstance,a=i.componentOptions;t[r]={name:Pn(a),tag:s,componentInstance:o},n.push(r),this.max&&n.length>parseInt(this.max)&&Hn(t,n[0],n,this._vnode),this.vnodeToCache=null}}},created:function e(){this.cache=Object.create(null),this.keys=[]},destroyed:function e(){for(var t in this.cache){Hn(this.cache,t,this.keys)}},mounted:function e(){var t=this;this.cacheVNode(),this.$watch("include",(function(e){Rn(t,(function(t){return Ln(e,t)}))})),this.$watch("exclude",(function(e){Rn(t,(function(t){return!Ln(e,t)}))}))},updated:function e(){this.cacheVNode()},render:function e(){var t=this.$slots["default"],n=Qt(t),i=n&&n.componentOptions;if(i){var r=Pn(i),s=this.include,o=this.exclude;if(s&&(!r||!Ln(s,r))||o&&r&&Ln(o,r))return n;var a=this.cache,l=this.keys,u=null==n.key?i.Ctor.cid+(i.tag?"::".concat(i.tag):""):n.key;a[u]?(n.componentInstance=a[u].componentInstance,k(l,u),l.push(u)):(this.vnodeToCache=n,this.keyToCache=u),n.data.keepAlive=!0}return n||t&&t[0]}}};!function(e){var t={get:function e(){return G}};Object.defineProperty(e,"config",t),e.util={warn:me,extend:L,mergeOptions:Ue,defineReactive:Ae},e.set=Pe,e["delete"]=Le,e.nextTick=at,e.observable=function(e){return De(e),e},e.options=Object.create(null),$.forEach((function(t){e.options[t+"s"]=Object.create(null)})),e.options._base=e,L(e.options.components,Nn),function(e){e.use=function(e){var t=this._installedPlugins||(this._installedPlugins=[]);if(t.indexOf(e)>-1)return this;var n=P(arguments,1);return n.unshift(this),"function"==typeof e.install?e.install.apply(e,n):"function"==typeof e&&e.apply(null,n),t.push(e),this}}(e),function(e){e.mixin=function(e){return this.options=Ue(this.options,e),this}}(e),An(e),function(e){$.forEach((function(t){e[t]=function(e,n){return n?("component"===t&&m(n)&&(n.name=n.name||e,n=this.options._base.extend(n)),"directive"===t&&"function"==typeof n&&(n={bind:n,update:n}),this.options[t+"s"][e]=n,n):this.options[t+"s"][e]}}))}(e)}(Dn),Object.defineProperty(Dn.prototype,"$isServer",{get:ce}),Object.defineProperty(Dn.prototype,"$ssrContext",{get:function e(){return this.$vnode&&this.$vnode.ssrContext}}),Object.defineProperty(Dn,"FunctionalRenderContext",{value:Bt}),Dn.version="2.6.14";var Bn=w("style,class"),Fn=w("input,textarea,option,select,progress"),Un=function e(t,n,i){return"value"===i&&Fn(t)&&"button"!==n||"selected"===i&&"option"===t||"checked"===i&&"input"===t||"muted"===i&&"video"===t},Wn=w("contenteditable,draggable,spellcheck"),$n=w("events,caret,typing,plaintext-only"),Vn=function e(t,n){return Kn(n)||"false"===n?"false":"contenteditable"===t&&$n(n)?n:"true"},Gn=w("allowfullscreen,async,autofocus,autoplay,checked,compact,controls,declare,default,defaultchecked,defaultmuted,defaultselected,defer,disabled,enabled,formnovalidate,hidden,indeterminate,inert,ismap,itemscope,loop,multiple,muted,nohref,noresize,noshade,novalidate,nowrap,open,pauseonexit,readonly,required,reversed,scoped,seamless,selected,sortable,truespeed,typemustmatch,visible"),zn="http://www.w3.org/1999/xlink",Xn=function e(t){return":"===t.charAt(5)&&"xlink"===t.slice(0,5)},qn=function e(t){return Xn(t)?t.slice(6,t.length):""},Kn=function e(t){return null==t||!1===t};function Yn(e){var t=e.data,n=e,i=e;for(;c(i.componentInstance);){(i=i.componentInstance._vnode)&&i.data&&(t=Jn(i.data,t))}for(;c(n=n.parent);){n&&n.data&&(t=Jn(t,n.data))}return function(e,t){if(c(e)||c(t))return Qn(e,Zn(t));return""}(t.staticClass,t["class"])}function Jn(e,t){return{staticClass:Qn(e.staticClass,t.staticClass),class:c(e["class"])?[e["class"],t["class"]]:t["class"]}}function Qn(e,t){return e?t?e+" "+t:e:t||""}function Zn(e){return Array.isArray(e)?function(e){var t,n="";for(var i=0,r=e.length;i<r;i++){c(t=Zn(e[i]))&&""!==t&&(n&&(n+=" "),n+=t)}return n}(e):h(e)?function(e){var t="";for(var n in e){e[n]&&(t&&(t+=" "),t+=n)}return t}(e):"string"==typeof e?e:""}var ei={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"},ti=w("html,body,base,head,link,meta,style,title,address,article,aside,footer,header,h1,h2,h3,h4,h5,h6,hgroup,nav,section,div,dd,dl,dt,figcaption,figure,picture,hr,img,li,main,ol,p,pre,ul,a,b,abbr,bdi,bdo,br,cite,code,data,dfn,em,i,kbd,mark,q,rp,rt,rtc,ruby,s,samp,small,span,strong,sub,sup,time,u,var,wbr,area,audio,map,track,video,embed,object,param,source,canvas,script,noscript,del,ins,caption,col,colgroup,table,thead,tbody,td,th,tr,button,datalist,fieldset,form,input,label,legend,meter,optgroup,option,output,progress,select,textarea,details,dialog,menu,menuitem,summary,content,element,shadow,template,blockquote,iframe,tfoot"),ni=w("svg,animate,circle,clippath,cursor,defs,desc,ellipse,filter,font-face,foreignobject,g,glyph,image,line,marker,mask,missing-glyph,path,pattern,polygon,polyline,rect,switch,symbol,text,textpath,tspan,use,view",!0),ii=function e(t){return ti(t)||ni(t)};function ri(e){return ni(e)?"svg":"math"===e?"math":void 0}var si=Object.create(null);var oi=w("text,number,password,search,email,tel,url");function ai(e){if("string"==typeof e){var t=document.querySelector(e);return t||document.createElement("div")}return e}var li=Object.freeze({createElement:function e(t,n){var i=document.createElement(t);return"select"!==t?i:(n.data&&n.data.attrs&&void 0!==n.data.attrs.multiple&&i.setAttribute("multiple","multiple"),i)},createElementNS:function e(t,n){return document.createElementNS(ei[t],n)},createTextNode:function e(t){return document.createTextNode(t)},createComment:function e(t){return document.createComment(t)},insertBefore:function e(t,n,i){t.insertBefore(n,i)},removeChild:function e(t,n){t.removeChild(n)},appendChild:function e(t,n){t.appendChild(n)},parentNode:function e(t){return t.parentNode},nextSibling:function e(t){return t.nextSibling},tagName:function e(t){return t.tagName},setTextContent:function e(t,n){t.textContent=n},setStyleScope:function e(t,n){t.setAttribute(n,"")}}),ui={create:function e(t,n){ci(n)},update:function e(t,n){t.data.ref!==n.data.ref&&(ci(t,!0),ci(n))},destroy:function e(t){ci(t,!0)}};function ci(e,t){var n=e.data.ref;if(!c(n))return;var i=e.context,r=e.componentInstance||e.elm,s=i.$refs;t?Array.isArray(s[n])?k(s[n],r):s[n]===r&&(s[n]=void 0):e.data.refInFor?Array.isArray(s[n])?s[n].indexOf(r)<0&&s[n].push(r):s[n]=[r]:s[n]=r}var fi=new Se("",{},[]),di=["create","activate","update","remove","destroy"];function hi(e,t){return e.key===t.key&&e.asyncFactory===t.asyncFactory&&(e.tag===t.tag&&e.isComment===t.isComment&&c(e.data)===c(t.data)&&function(e,t){if("input"!==e.tag)return!0;var n;var i=c(n=e.data)&&c(n=n.attrs)&&n.type,r=c(n=t.data)&&c(n=n.attrs)&&n.type;return i===r||oi(i)&&oi(r)}(e,t)||f(e.isAsyncPlaceholder)&&u(t.asyncFactory.error))}function pi(e,t,n){var i,r;var s={};for(i=t;i<=n;++i){c(r=e[i].key)&&(s[r]=i)}return s}var mi={create:gi,update:gi,destroy:function e(t){gi(t,fi)}};function gi(e,t){(e.data.directives||t.data.directives)&&function(e,t){var n=e===fi,i=t===fi,r=yi(e.data.directives,e.context),s=yi(t.data.directives,t.context),o=[],a=[];var l,u,c;for(l in s){u=r[l],c=s[l],u?(c.oldValue=u.value,c.oldArg=u.arg,wi(c,"update",t,e),c.def&&c.def.componentUpdated&&a.push(c)):(wi(c,"bind",t,e),c.def&&c.def.inserted&&o.push(c))}if(o.length){var f=function n(){for(var i=0;i<o.length;i++){wi(o[i],"inserted",t,e)}};n?ht(t,"insert",f):f()}a.length&&ht(t,"postpatch",(function(){for(var n=0;n<a.length;n++){wi(a[n],"componentUpdated",t,e)}}));if(!n)for(l in r){s[l]||wi(r[l],"unbind",e,e,i)}}(e,t)}var vi=Object.create(null);function yi(e,t){var n=Object.create(null);if(!e)return n;var i,r;for(i=0;i<e.length;i++){(r=e[i]).modifiers||(r.modifiers=vi),n[bi(r)]=r,r.def=We(t.$options,"directives",r.name)}return n}function bi(e){return e.rawName||"".concat(e.name,".").concat(Object.keys(e.modifiers||{}).join("."))}function wi(e,t,n,i,r){var s=e.def&&e.def[t];if(s)try{s(n.elm,e,n,i,r)}catch(i){qe(i,n.context,"directive ".concat(e.name," ").concat(t," hook"))}}var Si=[ui,mi];function Ii(e,t){var n=t.componentOptions;if(c(n)&&!1===n.Ctor.options.inheritAttrs)return;if(u(e.data.attrs)&&u(t.data.attrs))return;var i,r,s;var o=t.elm,a=e.data.attrs||{};var l=t.data.attrs||{};for(i in c(l.__ob__)&&(l=t.data.attrs=L({},l)),l){r=l[i],(s=a[i])!==r&&ki(o,i,r,t.data.pre)}for(i in(te||ie)&&l.value!==a.value&&ki(o,"value",l.value),a){u(l[i])&&(Xn(i)?o.removeAttributeNS(zn,qn(i)):Wn(i)||o.removeAttribute(i))}}function ki(e,t,n,i){i||e.tagName.indexOf("-")>-1?Ci(e,t,n):Gn(t)?Kn(n)?e.removeAttribute(t):(n="allowfullscreen"===t&&"EMBED"===e.tagName?"true":t,e.setAttribute(t,n)):Wn(t)?e.setAttribute(t,Vn(t,n)):Xn(t)?Kn(n)?e.removeAttributeNS(zn,qn(t)):e.setAttributeNS(zn,t,n):Ci(e,t,n)}function Ci(e,t,n){if(Kn(n))e.removeAttribute(t);else{if(te&&!ne&&"TEXTAREA"===e.tagName&&"placeholder"===t&&""!==n&&!e.__ieph){var i=function t(n){n.stopImmediatePropagation(),e.removeEventListener("input",t)};e.addEventListener("input",i),e.__ieph=!0}e.setAttribute(t,n)}}var Ei={create:Ii,update:Ii};function _i(e,t){var n=t.elm,i=t.data,r=e.data;if(u(i.staticClass)&&u(i["class"])&&(u(r)||u(r.staticClass)&&u(r["class"])))return;var s=Yn(t);var o=n._transitionClasses;c(o)&&(s=Qn(s,Zn(o))),s!==n._prevClass&&(n.setAttribute("class",s),n._prevClass=s)}var xi={create:_i,update:_i};var Ti=/[\w).+\-_$\]]/;function Oi(e){var t,n,i,r,s,o=!1,a=!1,l=!1,u=!1,c=0,f=0,d=0,h=0;for(i=0;i<e.length;i++){if(n=t,t=e.charCodeAt(i),o)39===t&&92!==n&&(o=!1);else if(a)34===t&&92!==n&&(a=!1);else if(l)96===t&&92!==n&&(l=!1);else if(u)47===t&&92!==n&&(u=!1);else if(124!==t||124===e.charCodeAt(i+1)||124===e.charCodeAt(i-1)||c||f||d){switch(t){case 34:a=!0;break;case 39:o=!0;break;case 96:l=!0;break;case 40:d++;break;case 41:d--;break;case 91:f++;break;case 93:f--;break;case 123:c++;break;case 125:c--}if(47===t){var p=void 0,m=i-1;for(;m>=0&&" "===(p=e.charAt(m));m--){}p&&Ti.test(p)||(u=!0)}}else void 0===r?(h=i+1,r=e.slice(0,i).trim()):g()}function g(){(s||(s=[])).push(e.slice(h,i).trim()),h=i+1}if(void 0===r?r=e.slice(0,i).trim():0!==h&&g(),s)for(i=0;i<s.length;i++){r=Mi(r,s[i])}return r}function Mi(e,t){var n=t.indexOf("(");if(n<0)return'_f("'.concat(t,'")(').concat(e,")");{var i=t.slice(0,n),r=t.slice(n+1);return'_f("'.concat(i,'")(').concat(e).concat(")"!==r?","+r:r)}}function Di(e,t){console.error("[Vue compiler]: ".concat(e))}function Ai(e,t){return e?e.map((function(e){return e[t]})).filter((function(e){return e})):[]}function Pi(e,t,n,i,r){(e.props||(e.props=[])).push(Wi({name:t,value:n,dynamic:r},i)),e.plain=!1}function Li(e,t,n,i,r){(r?e.dynamicAttrs||(e.dynamicAttrs=[]):e.attrs||(e.attrs=[])).push(Wi({name:t,value:n,dynamic:r},i)),e.plain=!1}function Ri(e,t,n,i){e.attrsMap[t]=n,e.attrsList.push(Wi({name:t,value:n},i))}function Hi(e,t,n,i,r,s,o,a){(e.directives||(e.directives=[])).push(Wi({name:t,rawName:n,value:i,arg:r,isDynamicArg:s,modifiers:o},a)),e.plain=!1}function ji(e,t,n){return n?"_p(".concat(t,',"').concat(e,'")'):e+t}function Ni(e,t,n,i,r,s,o,a){var u;(i=i||l).right?a?t="(".concat(t,")==='click'?'contextmenu':(").concat(t,")"):"click"===t&&(t="contextmenu",delete i.right):i.middle&&(a?t="(".concat(t,")==='click'?'mouseup':(").concat(t,")"):"click"===t&&(t="mouseup")),i.capture&&(delete i.capture,t=ji("!",t,a)),i.once&&(delete i.once,t=ji("~",t,a)),i.passive&&(delete i.passive,t=ji("&",t,a)),i["native"]?(delete i["native"],u=e.nativeEvents||(e.nativeEvents={})):u=e.events||(e.events={});var c=Wi({value:n.trim(),dynamic:a},o);i!==l&&(c.modifiers=i);var f=u[t];Array.isArray(f)?r?f.unshift(c):f.push(c):u[t]=f?r?[c,f]:[f,c]:c,e.plain=!1}function Bi(e,t,n){var i=Fi(e,":"+t)||Fi(e,"v-bind:"+t);if(null!=i)return Oi(i);if(!1!==n){var r=Fi(e,t);if(null!=r)return JSON.stringify(r)}}function Fi(e,t,n){var i;if(null!=(i=e.attrsMap[t])){var r=e.attrsList;for(var s=0,o=r.length;s<o;s++){if(r[s].name===t){r.splice(s,1);break}}}return n&&delete e.attrsMap[t],i}function Ui(e,t){var n=e.attrsList;for(var i=0,r=n.length;i<r;i++){var s=n[i];if(t.test(s.name))return n.splice(i,1),s}}function Wi(e,t){return t&&(null!=t.start&&(e.start=t.start),null!=t.end&&(e.end=t.end)),e}function $i(e,t,n){var i=n||{},r=i.number,s=i.trim;var o="$$v";s&&(o="(typeof $$v === 'string'? $$v.trim(): $$v)"),r&&(o="_n(".concat(o,")"));var a=Vi(t,o);e.model={value:"(".concat(t,")"),expression:JSON.stringify(t),callback:"function ($$v) {".concat(a,"}")}}function Vi(e,t){var n=function(e){if(e=e.trim(),Gi=e.length,e.indexOf("[")<0||e.lastIndexOf("]")<Gi-1)return(qi=e.lastIndexOf("."))>-1?{exp:e.slice(0,qi),key:'"'+e.slice(qi+1)+'"'}:{exp:e,key:null};zi=e,qi=Ki=Yi=0;for(;!Qi();){Zi(Xi=Ji())?tr(Xi):91===Xi&&er(Xi)}return{exp:e.slice(0,Ki),key:e.slice(Ki+1,Yi)}}(e);return null===n.key?"".concat(e,"=").concat(t):"$set(".concat(n.exp,", ").concat(n.key,", ").concat(t,")")}var Gi,zi,Xi,qi,Ki,Yi;function Ji(){return zi.charCodeAt(++qi)}function Qi(){return qi>=Gi}function Zi(e){return 34===e||39===e}function er(e){var t=1;for(Ki=qi;!Qi();){if(Zi(e=Ji()))tr(e);else if(91===e&&t++,93===e&&t--,0===t){Yi=qi;break}}}function tr(e){var t=e;for(;!Qi()&&(e=Ji())!==t;){}}var nr="__r",ir="__c";var rr;function sr(e,t,n){var i=rr;return function r(){null!==t.apply(null,arguments)&&lr(e,r,n,i)}}var or=Qe&&!(se&&Number(se[1])<=53);function ar(e,t,n,i){if(or){var r=mn,s=t;t=s._wrapper=function(e){if(e.target===e.currentTarget||e.timeStamp>=r||e.timeStamp<=0||e.target.ownerDocument!==document)return s.apply(this,arguments)}}rr.addEventListener(e,t,le?{capture:n,passive:i}:n)}function lr(e,t,n,i){(i||rr).removeEventListener(e,t._wrapper||t,n)}function ur(e,t){if(u(e.data.on)&&u(t.data.on))return;var n=t.data.on||{},i=e.data.on||{};rr=t.elm,function(e){if(c(e[nr])){var t=te?"change":"input";e[t]=[].concat(e[nr],e[t]||[]),delete e[nr]}c(e[ir])&&(e.change=[].concat(e[ir],e.change||[]),delete e[ir])}(n),dt(n,i,ar,lr,sr,t.context),rr=void 0}var cr={create:ur,update:ur};var fr;function dr(e,t){if(u(e.data.domProps)&&u(t.data.domProps))return;var n,i;var r=t.elm,s=e.data.domProps||{};var o=t.data.domProps||{};for(n in c(o.__ob__)&&(o=t.data.domProps=L({},o)),s){n in o||(r[n]="")}for(n in o){if(i=o[n],"textContent"===n||"innerHTML"===n){if(t.children&&(t.children.length=0),i===s[n])continue;1===r.childNodes.length&&r.removeChild(r.childNodes[0])}if("value"===n&&"PROGRESS"!==r.tagName){r._value=i;var a=u(i)?"":String(i);hr(r,a)&&(r.value=a)}else if("innerHTML"===n&&ni(r.tagName)&&u(r.innerHTML)){(fr=fr||document.createElement("div")).innerHTML="<svg>".concat(i,"</svg>");var l=fr.firstChild;for(;r.firstChild;){r.removeChild(r.firstChild)}for(;l.firstChild;){r.appendChild(l.firstChild)}}else if(i!==s[n])try{r[n]=i}catch(e){}}}function hr(e,t){return!e.composing&&("OPTION"===e.tagName||function(e,t){var n=!0;try{n=document.activeElement!==e}catch(e){}return n&&e.value!==t}(e,t)||function(e,t){var n=e.value,i=e._vModifiers;if(c(i)){if(i.number)return b(n)!==b(t);if(i.trim)return n.trim()!==t.trim()}return n!==t}(e,t))}var pr={create:dr,update:dr};var mr=_((function(e){var t={},n=/:(.+)/;return e.split(/;(?![^(]*\))/g).forEach((function(e){if(e){var i=e.split(n);i.length>1&&(t[i[0].trim()]=i[1].trim())}})),t}));function gr(e){var t=vr(e.style);return e.staticStyle?L(e.staticStyle,t):t}function vr(e){return Array.isArray(e)?R(e):"string"==typeof e?mr(e):e}var yr=/^--/,br=/\s*!important$/,wr=function e(t,n,i){if(yr.test(n))t.style.setProperty(n,i);else if(br.test(i))t.style.setProperty(D(n),i.replace(br,""),"important");else{var r=kr(n);if(Array.isArray(i))for(var s=0,o=i.length;s<o;s++){t.style[r]=i[s]}else t.style[r]=i}},Sr=["Webkit","Moz","ms"];var Ir;var kr=_((function(e){if(Ir=Ir||document.createElement("div").style,"filter"!==(e=T(e))&&e in Ir)return e;var t=e.charAt(0).toUpperCase()+e.slice(1);for(var n=0;n<Sr.length;n++){var i=Sr[n]+t;if(i in Ir)return i}}));function Cr(e,t){var n=t.data,i=e.data;if(u(n.staticStyle)&&u(n.style)&&u(i.staticStyle)&&u(i.style))return;var r,s;var o=t.elm,a=i.staticStyle,l=i.normalizedStyle||i.style||{},f=a||l,d=vr(t.data.style)||{};t.data.normalizedStyle=c(d.__ob__)?L({},d):d;var h=function(e,t){var n={};var i;if(t){var r=e;for(;r.componentInstance;){(r=r.componentInstance._vnode)&&r.data&&(i=gr(r.data))&&L(n,i)}}(i=gr(e.data))&&L(n,i);var s=e;for(;s=s.parent;){s.data&&(i=gr(s.data))&&L(n,i)}return n}(t,!0);for(s in f){u(h[s])&&wr(o,s,"")}for(s in h){(r=h[s])!==f[s]&&wr(o,s,null==r?"":r)}}var Er={create:Cr,update:Cr};var _r=/\s+/;function xr(e,t){if(t&&(t=t.trim()))if(e.classList)t.indexOf(" ")>-1?t.split(_r).forEach((function(t){return e.classList.add(t)})):e.classList.add(t);else{var n=" ".concat(e.getAttribute("class")||""," ");n.indexOf(" "+t+" ")<0&&e.setAttribute("class",(n+t).trim())}}function Tr(e,t){if(t&&(t=t.trim()))if(e.classList)t.indexOf(" ")>-1?t.split(_r).forEach((function(t){return e.classList.remove(t)})):e.classList.remove(t),e.classList.length||e.removeAttribute("class");else{var n=" ".concat(e.getAttribute("class")||""," ");var i=" "+t+" ";for(;n.indexOf(i)>=0;){n=n.replace(i," ")}(n=n.trim())?e.setAttribute("class",n):e.removeAttribute("class")}}function Or(e){if(e){if("object"==babelHelpers["typeof"](e)){var t={};return!1!==e.css&&L(t,Mr(e.name||"v")),L(t,e),t}return"string"==typeof e?Mr(e):void 0}}var Mr=_((function(e){return{enterClass:"".concat(e,"-enter"),enterToClass:"".concat(e,"-enter-to"),enterActiveClass:"".concat(e,"-enter-active"),leaveClass:"".concat(e,"-leave"),leaveToClass:"".concat(e,"-leave-to"),leaveActiveClass:"".concat(e,"-leave-active")}})),Dr=J&&!ne,Ar="transition",Pr="animation";var Lr="transition",Rr="transitionend",Hr="animation",jr="animationend";Dr&&(void 0===window.ontransitionend&&void 0!==window.onwebkittransitionend&&(Lr="WebkitTransition",Rr="webkitTransitionEnd"),void 0===window.onanimationend&&void 0!==window.onwebkitanimationend&&(Hr="WebkitAnimation",jr="webkitAnimationEnd"));var Nr=J?window.requestAnimationFrame?window.requestAnimationFrame.bind(window):setTimeout:function(e){return e()};function Br(e){Nr((function(){Nr(e)}))}function Fr(e,t){var n=e._transitionClasses||(e._transitionClasses=[]);n.indexOf(t)<0&&(n.push(t),xr(e,t))}function Ur(e,t){e._transitionClasses&&k(e._transitionClasses,t),Tr(e,t)}function Wr(e,t,n){var i=Vr(e,t),r=i.type,s=i.timeout,o=i.propCount;if(!r)return n();var a=r===Ar?Rr:jr;var l=0;var u=function t(){e.removeEventListener(a,c),n()},c=function t(n){n.target===e&&++l>=o&&u()};setTimeout((function(){l<o&&u()}),s+1),e.addEventListener(a,c)}var $r=/\b(transform|all)(,|$)/;function Vr(e,t){var n=window.getComputedStyle(e),i=(n[Lr+"Delay"]||"").split(", "),r=(n[Lr+"Duration"]||"").split(", "),s=Gr(i,r),o=(n[Hr+"Delay"]||"").split(", "),a=(n[Hr+"Duration"]||"").split(", "),l=Gr(o,a);var u,c=0,f=0;return t===Ar?s>0&&(u=Ar,c=s,f=r.length):t===Pr?l>0&&(u=Pr,c=l,f=a.length):f=(u=(c=Math.max(s,l))>0?s>l?Ar:Pr:null)?u===Ar?r.length:a.length:0,{type:u,timeout:c,propCount:f,hasTransform:u===Ar&&$r.test(n[Lr+"Property"])}}function Gr(e,t){for(;e.length<t.length;){e=e.concat(e)}return Math.max.apply(null,t.map((function(t,n){return zr(t)+zr(e[n])})))}function zr(e){return 1e3*Number(e.slice(0,-1).replace(",","."))}function Xr(e,t){var n=e.elm;c(n._leaveCb)&&(n._leaveCb.cancelled=!0,n._leaveCb());var i=Or(e.data.transition);if(u(i))return;if(c(n._enterCb)||1!==n.nodeType)return;var r=i.css,s=i.type,o=i.enterClass,a=i.enterToClass,l=i.enterActiveClass,f=i.appearClass,d=i.appearToClass,p=i.appearActiveClass,m=i.beforeEnter,g=i.enter,v=i.afterEnter,y=i.enterCancelled,w=i.beforeAppear,S=i.appear,I=i.afterAppear,k=i.appearCancelled,C=i.duration;var E=rn,_=rn.$vnode;for(;_&&_.parent;){E=_.context,_=_.parent}var x=!E._isMounted||!e.isRootInsert;if(x&&!S&&""!==S)return;var T=x&&f?f:o,O=x&&p?p:l,M=x&&d?d:a,D=x&&w||m,A=x&&"function"==typeof S?S:g,P=x&&I||v,L=x&&k||y,R=b(h(C)?C.enter:C),H=!1!==r&&!ne,j=Yr(A),N=n._enterCb=U((function(){H&&(Ur(n,M),Ur(n,O)),N.cancelled?(H&&Ur(n,T),L&&L(n)):P&&P(n),n._enterCb=null}));e.data.show||ht(e,"insert",(function(){var t=n.parentNode,i=t&&t._pending&&t._pending[e.key];i&&i.tag===e.tag&&i.elm._leaveCb&&i.elm._leaveCb(),A&&A(n,N)})),D&&D(n),H&&(Fr(n,T),Fr(n,O),Br((function(){Ur(n,T),N.cancelled||(Fr(n,M),j||(Kr(R)?setTimeout(N,R):Wr(n,s,N)))}))),e.data.show&&(t&&t(),A&&A(n,N)),H||j||N()}function qr(e,t){var n=e.elm;c(n._enterCb)&&(n._enterCb.cancelled=!0,n._enterCb());var i=Or(e.data.transition);if(u(i)||1!==n.nodeType)return t();if(c(n._leaveCb))return;var r=i.css,s=i.type,o=i.leaveClass,a=i.leaveToClass,l=i.leaveActiveClass,f=i.beforeLeave,d=i.leave,p=i.afterLeave,m=i.leaveCancelled,g=i.delayLeave,v=i.duration,y=!1!==r&&!ne,w=Yr(d),S=b(h(v)?v.leave:v),I=n._leaveCb=U((function(){n.parentNode&&n.parentNode._pending&&(n.parentNode._pending[e.key]=null),y&&(Ur(n,a),Ur(n,l)),I.cancelled?(y&&Ur(n,o),m&&m(n)):(t(),p&&p(n)),n._leaveCb=null}));function k(){I.cancelled||(!e.data.show&&n.parentNode&&((n.parentNode._pending||(n.parentNode._pending={}))[e.key]=e),f&&f(n),y&&(Fr(n,o),Fr(n,l),Br((function(){Ur(n,o),I.cancelled||(Fr(n,a),w||(Kr(S)?setTimeout(I,S):Wr(n,s,I)))}))),d&&d(n,I),y||w||I())}g?g(k):k()}function Kr(e){return"number"==typeof e&&!isNaN(e)}function Yr(e){if(u(e))return!1;var t=e.fns;return c(t)?Yr(Array.isArray(t)?t[0]:t):(e._length||e.length)>1}function Jr(e,t){!0!==t.data.show&&Xr(t)}var Qr=function(e){var t,n;var i={},r=e.modules,s=e.nodeOps;for(t=0;t<di.length;++t){for(i[di[t]]=[],n=0;n<r.length;++n){c(r[n][di[t]])&&i[di[t]].push(r[n][di[t]])}}function o(e){var t=s.parentNode(e);c(t)&&s.removeChild(t,e)}function a(e,t,n,r,o,a,u){if(c(e.elm)&&c(a)&&(e=a[u]=Ce(e)),e.isRootInsert=!o,function(e,t,n,r){var s=e.data;if(c(s)){var o=c(e.componentInstance)&&s.keepAlive;if(c(s=s.hook)&&c(s=s.init)&&s(e,!1),c(e.componentInstance))return l(e,t),h(n,e.elm,r),f(o)&&function(e,t,n,r){var s,o=e;for(;o.componentInstance;){if(o=o.componentInstance._vnode,c(s=o.data)&&c(s=s.transition)){for(s=0;s<i.activate.length;++s){i.activate[s](fi,o)}t.push(o);break}}h(n,e.elm,r)}(e,t,n,r),!0}}(e,t,n,r))return;var d=e.data,m=e.children,y=e.tag;c(y)?(e.elm=e.ns?s.createElementNS(e.ns,y):s.createElement(y,e),v(e),p(e,m,t),c(d)&&g(e,t),h(n,e.elm,r)):f(e.isComment)?(e.elm=s.createComment(e.text),h(n,e.elm,r)):(e.elm=s.createTextNode(e.text),h(n,e.elm,r))}function l(e,t){c(e.data.pendingInsert)&&(t.push.apply(t,e.data.pendingInsert),e.data.pendingInsert=null),e.elm=e.componentInstance.$el,m(e)?(g(e,t),v(e)):(ci(e),t.push(e))}function h(e,t,n){c(e)&&(c(n)?s.parentNode(n)===e&&s.insertBefore(e,t,n):s.appendChild(e,t))}function p(e,t,n){if(Array.isArray(t))for(var i=0;i<t.length;++i){a(t[i],n,e.elm,null,!0,t,i)}else d(e.text)&&s.appendChild(e.elm,s.createTextNode(String(e.text)))}function m(e){for(;e.componentInstance;){e=e.componentInstance._vnode}return c(e.tag)}function g(e,n){for(var r=0;r<i.create.length;++r){i.create[r](fi,e)}c(t=e.data.hook)&&(c(t.create)&&t.create(fi,e),c(t.insert)&&n.push(e))}function v(e){var t;if(c(t=e.fnScopeId))s.setStyleScope(e.elm,t);else{var n=e;for(;n;){c(t=n.context)&&c(t=t.$options._scopeId)&&s.setStyleScope(e.elm,t),n=n.parent}}c(t=rn)&&t!==e.context&&t!==e.fnContext&&c(t=t.$options._scopeId)&&s.setStyleScope(e.elm,t)}function y(e,t,n,i,r,s){for(;i<=r;++i){a(n[i],s,e,t,!1,n,i)}}function b(e){var t,n;var r=e.data;if(c(r))for(c(t=r.hook)&&c(t=t.destroy)&&t(e),t=0;t<i.destroy.length;++t){i.destroy[t](e)}if(c(t=e.children))for(n=0;n<e.children.length;++n){b(e.children[n])}}function S(e,t,n){for(;t<=n;++t){var i=e[t];c(i)&&(c(i.tag)?(I(i),b(i)):o(i.elm))}}function I(e,t){if(c(t)||c(e.data)){var n;var r=i.remove.length+1;for(c(t)?t.listeners+=r:t=function(e,t){function n(){0==--n.listeners&&o(e)}return n.listeners=t,n}(e.elm,r),c(n=e.componentInstance)&&c(n=n._vnode)&&c(n.data)&&I(n,t),n=0;n<i.remove.length;++n){i.remove[n](e,t)}c(n=e.data.hook)&&c(n=n.remove)?n(e,t):t()}else o(e.elm)}function k(e,t,n,i){for(var r=n;r<i;r++){var s=t[r];if(c(s)&&hi(e,s))return r}}function C(e,t,n,r,o,l){if(e===t)return;c(t.elm)&&c(r)&&(t=r[o]=Ce(t));var d=t.elm=e.elm;if(f(e.isAsyncPlaceholder))return void(c(t.asyncFactory.resolved)?x(e.elm,t,n):t.isAsyncPlaceholder=!0);if(f(t.isStatic)&&f(e.isStatic)&&t.key===e.key&&(f(t.isCloned)||f(t.isOnce)))return void(t.componentInstance=e.componentInstance);var h;var p=t.data;c(p)&&c(h=p.hook)&&c(h=h.prepatch)&&h(e,t);var g=e.children,v=t.children;if(c(p)&&m(t)){for(h=0;h<i.update.length;++h){i.update[h](e,t)}c(h=p.hook)&&c(h=h.update)&&h(e,t)}u(t.text)?c(g)&&c(v)?g!==v&&function(e,t,n,i,r){var o,l,f,d,h=0,p=0,m=t.length-1,g=t[0],v=t[m],b=n.length-1,w=n[0],I=n[b];var E=!r;for(;h<=m&&p<=b;){u(g)?g=t[++h]:u(v)?v=t[--m]:hi(g,w)?(C(g,w,i,n,p),g=t[++h],w=n[++p]):hi(v,I)?(C(v,I,i,n,b),v=t[--m],I=n[--b]):hi(g,I)?(C(g,I,i,n,b),E&&s.insertBefore(e,g.elm,s.nextSibling(v.elm)),g=t[++h],I=n[--b]):hi(v,w)?(C(v,w,i,n,p),E&&s.insertBefore(e,v.elm,g.elm),v=t[--m],w=n[++p]):(u(o)&&(o=pi(t,h,m)),u(l=c(w.key)?o[w.key]:k(w,t,h,m))?a(w,i,e,g.elm,!1,n,p):hi(f=t[l],w)?(C(f,w,i,n,p),t[l]=void 0,E&&s.insertBefore(e,f.elm,g.elm)):a(w,i,e,g.elm,!1,n,p),w=n[++p])}h>m?y(e,d=u(n[b+1])?null:n[b+1].elm,n,p,b,i):p>b&&S(t,h,m)}(d,g,v,n,l):c(v)?(c(e.text)&&s.setTextContent(d,""),y(d,null,v,0,v.length-1,n)):c(g)?S(g,0,g.length-1):c(e.text)&&s.setTextContent(d,""):e.text!==t.text&&s.setTextContent(d,t.text),c(p)&&c(h=p.hook)&&c(h=h.postpatch)&&h(e,t)}function E(e,t,n){if(f(n)&&c(e.parent))e.parent.data.pendingInsert=t;else for(var i=0;i<t.length;++i){t[i].data.hook.insert(t[i])}}var _=w("attrs,class,staticClass,staticStyle,key");function x(e,t,n,i){var r;var s=t.tag,o=t.data,a=t.children;if(i=i||o&&o.pre,t.elm=e,f(t.isComment)&&c(t.asyncFactory))return t.isAsyncPlaceholder=!0,!0;if(c(o)&&(c(r=o.hook)&&c(r=r.init)&&r(t,!0),c(r=t.componentInstance)))return l(t,n),!0;if(c(s)){if(c(a))if(e.hasChildNodes()){if(c(r=o)&&c(r=r.domProps)&&c(r=r.innerHTML)){if(r!==e.innerHTML)return!1}else{var u=!0,d=e.firstChild;for(var h=0;h<a.length;h++){if(!d||!x(d,a[h],n,i)){u=!1;break}d=d.nextSibling}if(!u||d)return!1}}else p(t,a,n);if(c(o)){var m=!1;for(var v in o){if(!_(v)){m=!0,g(t,n);break}}!m&&o["class"]&&ut(o["class"])}}else e.data!==t.text&&(e.data=t.text);return!0}return function(e,t,n,r){if(u(t))return void(c(e)&&b(e));var o=!1;var l=[];if(u(e))o=!0,a(t,l);else{var d=c(e.nodeType);if(!d&&hi(e,t))C(e,t,l,null,null,r);else{if(d){if(1===e.nodeType&&e.hasAttribute(W)&&(e.removeAttribute(W),n=!0),f(n)&&x(e,t,l))return E(t,l,!0),e;_=e,e=new Se(s.tagName(_).toLowerCase(),{},[],void 0,_)}var h=e.elm,p=s.parentNode(h);if(a(t,l,h._leaveCb?null:p,s.nextSibling(h)),c(t.parent)){var g=t.parent;var v=m(t);for(;g;){for(var y=0;y<i.destroy.length;++y){i.destroy[y](g)}if(g.elm=t.elm,v){for(var w=0;w<i.create.length;++w){i.create[w](fi,g)}var I=g.data.hook.insert;if(I.merged)for(var k=1;k<I.fns.length;k++){I.fns[k]()}}else ci(g);g=g.parent}}c(p)?S([e],0,0):c(e.tag)&&b(e)}}var _;return E(t,l,o),t.elm}}({nodeOps:li,modules:[Ei,xi,cr,pr,Er,J?{create:Jr,activate:Jr,remove:function e(t,n){!0!==t.data.show?qr(t,n):n()}}:{}].concat(Si)});ne&&document.addEventListener("selectionchange",(function(){var e=document.activeElement;e&&e.vmodel&&os(e,"input")}));var Zr={inserted:function e(t,n,i,r){"select"===i.tag?(r.elm&&!r.elm._vOptions?ht(i,"postpatch",(function(){Zr.componentUpdated(t,n,i)})):es(t,n,i.context),t._vOptions=[].map.call(t.options,is)):("textarea"===i.tag||oi(t.type))&&(t._vModifiers=n.modifiers,n.modifiers.lazy||(t.addEventListener("compositionstart",rs),t.addEventListener("compositionend",ss),t.addEventListener("change",ss),ne&&(t.vmodel=!0)))},componentUpdated:function e(t,n,i){if("select"===i.tag){es(t,n,i.context);var r=t._vOptions,s=t._vOptions=[].map.call(t.options,is);if(s.some((function(e,t){return!B(e,r[t])}))){(t.multiple?n.value.some((function(e){return ns(e,s)})):n.value!==n.oldValue&&ns(n.value,s))&&os(t,"change")}}}};function es(e,t,n){ts(e,t,n),(te||ie)&&setTimeout((function(){ts(e,t,n)}),0)}function ts(e,t,n){var i=t.value,r=e.multiple;if(r&&!Array.isArray(i))return;var s,o;for(var a=0,l=e.options.length;a<l;a++){if(o=e.options[a],r)s=F(i,is(o))>-1,o.selected!==s&&(o.selected=s);else if(B(is(o),i))return void(e.selectedIndex!==a&&(e.selectedIndex=a))}r||(e.selectedIndex=-1)}function ns(e,t){return t.every((function(t){return!B(t,e)}))}function is(e){return"_value"in e?e._value:e.value}function rs(e){e.target.composing=!0}function ss(e){e.target.composing&&(e.target.composing=!1,os(e.target,"input"))}function os(e,t){var n=document.createEvent("HTMLEvents");n.initEvent(t,!0,!0),e.dispatchEvent(n)}function as(e){return!e.componentInstance||e.data&&e.data.transition?e:as(e.componentInstance._vnode)}var ls={model:Zr,show:{bind:function e(t,n,i){var r=n.value;var s=(i=as(i)).data&&i.data.transition,o=t.__vOriginalDisplay="none"===t.style.display?"":t.style.display;r&&s?(i.data.show=!0,Xr(i,(function(){t.style.display=o}))):t.style.display=r?o:"none"},update:function e(t,n,i){var r=n.value,s=n.oldValue;if(!r==!s)return;(i=as(i)).data&&i.data.transition?(i.data.show=!0,r?Xr(i,(function(){t.style.display=t.__vOriginalDisplay})):qr(i,(function(){t.style.display="none"}))):t.style.display=r?t.__vOriginalDisplay:"none"},unbind:function e(t,n,i,r,s){s||(t.style.display=t.__vOriginalDisplay)}}};var us={name:String,appear:Boolean,css:Boolean,mode:String,type:String,enterClass:String,leaveClass:String,enterToClass:String,leaveToClass:String,enterActiveClass:String,leaveActiveClass:String,appearClass:String,appearActiveClass:String,appearToClass:String,duration:[Number,String,Object]};function cs(e){var t=e&&e.componentOptions;return t&&t.Ctor.options["abstract"]?cs(Qt(t.children)):e}function fs(e){var t={},n=e.$options;for(var i in n.propsData){t[i]=e[i]}var r=n._parentListeners;for(var s in r){t[T(s)]=r[s]}return t}function ds(e,t){if(/\d-keep-alive$/.test(t.tag))return e("keep-alive",{props:t.componentOptions.propsData})}var hs=function e(t){return t.tag||wt(t)},ps=function e(t){return"show"===t.name};var ms={name:"transition",props:us,abstract:!0,render:function e(t){var n=this;var i=this.$slots["default"];if(!i)return;if(!(i=i.filter(hs)).length)return;var r=this.mode,s=i[0];if(function(e){for(;e=e.parent;){if(e.data.transition)return!0}}(this.$vnode))return s;var o=cs(s);if(!o)return s;if(this._leaving)return ds(t,s);var a="__transition-".concat(this._uid,"-");o.key=null==o.key?o.isComment?a+"comment":a+o.tag:d(o.key)?0===String(o.key).indexOf(a)?o.key:a+o.key:o.key;var l=(o.data||(o.data={})).transition=fs(this),u=this._vnode,c=cs(u);if(o.data.directives&&o.data.directives.some(ps)&&(o.data.show=!0),c&&c.data&&!function(e,t){return t.key===e.key&&t.tag===e.tag}(o,c)&&!wt(c)&&(!c.componentInstance||!c.componentInstance._vnode.isComment)){var f=c.data.transition=L({},l);if("out-in"===r)return this._leaving=!0,ht(f,"afterLeave",(function(){n._leaving=!1,n.$forceUpdate()})),ds(t,s);if("in-out"===r){if(wt(o))return u;var h;var p=function e(){h()};ht(l,"afterEnter",p),ht(l,"enterCancelled",p),ht(f,"delayLeave",(function(e){h=e}))}}return s}};var gs=L({tag:String,moveClass:String},us);function vs(e){e.elm._moveCb&&e.elm._moveCb(),e.elm._enterCb&&e.elm._enterCb()}function ys(e){e.data.newPos=e.elm.getBoundingClientRect()}function bs(e){var t=e.data.pos,n=e.data.newPos,i=t.left-n.left,r=t.top-n.top;if(i||r){e.data.moved=!0;var s=e.elm.style;s.transform=s.WebkitTransform="translate(".concat(i,"px,").concat(r,"px)"),s.transitionDuration="0s"}}delete gs.mode;var ws={Transition:ms,TransitionGroup:{props:gs,beforeMount:function e(){var t=this;var n=this._update;this._update=function(e,i){var r=sn(t);t.__patch__(t._vnode,t.kept,!1,!0),t._vnode=t.kept,r(),n.call(t,e,i)}},render:function e(t){var n=this.tag||this.$vnode.data.tag||"span",i=Object.create(null),r=this.prevChildren=this.children,s=this.$slots["default"]||[],o=this.children=[],a=fs(this);for(var l=0;l<s.length;l++){var u=s[l];u.tag&&null!=u.key&&0!==String(u.key).indexOf("__vlist")&&(o.push(u),i[u.key]=u,(u.data||(u.data={})).transition=a)}if(r){var c=[],f=[];for(var d=0;d<r.length;d++){var h=r[d];h.data.transition=a,h.data.pos=h.elm.getBoundingClientRect(),i[h.key]?c.push(h):f.push(h)}this.kept=t(n,null,c),this.removed=f}return t(n,null,o)},updated:function e(){var t=this.prevChildren,n=this.moveClass||(this.name||"v")+"-move";t.length&&this.hasMove(t[0].elm,n)&&(t.forEach(vs),t.forEach(ys),t.forEach(bs),this._reflow=document.body.offsetHeight,t.forEach((function(e){if(e.data.moved){var t=e.elm,i=t.style;Fr(t,n),i.transform=i.WebkitTransform=i.transitionDuration="",t.addEventListener(Rr,t._moveCb=function e(i){i&&i.target!==t||i&&!/transform$/.test(i.propertyName)||(t.removeEventListener(Rr,e),t._moveCb=null,Ur(t,n))})}})))},methods:{hasMove:function e(t,n){if(!Dr)return!1;if(this._hasMove)return this._hasMove;var i=t.cloneNode();t._transitionClasses&&t._transitionClasses.forEach((function(e){Tr(i,e)})),xr(i,n),i.style.display="none",this.$el.appendChild(i);var r=Vr(i);return this.$el.removeChild(i),this._hasMove=r.hasTransform}}}};Dn.config.mustUseProp=Un,Dn.config.isReservedTag=ii,Dn.config.isReservedAttr=Bn,Dn.config.getTagNamespace=ri,Dn.config.isUnknownElement=function(e){if(!J)return!0;if(ii(e))return!1;if(e=e.toLowerCase(),null!=si[e])return si[e];var t=document.createElement(e);return e.indexOf("-")>-1?si[e]=t.constructor===window.HTMLUnknownElement||t.constructor===window.HTMLElement:si[e]=/HTMLUnknownElement/.test(t.toString())},L(Dn.options.directives,ls),L(Dn.options.components,ws),Dn.prototype.__patch__=J?Qr:H,Dn.prototype.$mount=function(e,t){return function(e,t,n){var i;return e.$el=t,e.$options.render||(e.$options.render=Ie),ln(e,"beforeMount"),i=function t(){e._update(e._render(),n)},new wn(e,i,H,{before:function t(){e._isMounted&&!e._isDestroyed&&ln(e,"beforeUpdate")}},!0),n=!1,null==e.$vnode&&(e._isMounted=!0,ln(e,"mounted")),e}(this,e=e&&J?ai(e):void 0,t)},J&&setTimeout((function(){G.devtools&&fe&&fe.emit("init",Dn)}),0);var Ss=/\{\{((?:.|\r?\n)+?)\}\}/g,Is=/[-.*+?^${}()|[\]\/\\]/g,ks=_((function(e){var t=e[0].replace(Is,"\\$&"),n=e[1].replace(Is,"\\$&");return new RegExp(t+"((?:.|\\n)+?)"+n,"g")}));var Cs={staticKeys:["staticClass"],transformNode:function e(t,n){n.warn;var i=Fi(t,"class");i&&(t.staticClass=JSON.stringify(i));var r=Bi(t,"class",!1);r&&(t.classBinding=r)},genData:function e(t){var n="";return t.staticClass&&(n+="staticClass:".concat(t.staticClass,",")),t.classBinding&&(n+="class:".concat(t.classBinding,",")),n}};var Es={staticKeys:["staticStyle"],transformNode:function e(t,n){n.warn;var i=Fi(t,"style");i&&(t.staticStyle=JSON.stringify(mr(i)));var r=Bi(t,"style",!1);r&&(t.styleBinding=r)},genData:function e(t){var n="";return t.staticStyle&&(n+="staticStyle:".concat(t.staticStyle,",")),t.styleBinding&&(n+="style:(".concat(t.styleBinding,"),")),n}};var _s;var xs={decode:function e(t){return(_s=_s||document.createElement("div")).innerHTML=t,_s.textContent}};var Ts=w("area,base,br,col,embed,frame,hr,img,input,isindex,keygen,link,meta,param,source,track,wbr"),Os=w("colgroup,dd,dt,li,options,p,td,tfoot,th,thead,tr,source"),Ms=w("address,article,aside,base,blockquote,body,caption,col,colgroup,dd,details,dialog,div,dl,dt,fieldset,figcaption,figure,footer,form,h1,h2,h3,h4,h5,h6,head,header,hgroup,hr,html,legend,li,menuitem,meta,optgroup,option,param,rp,rt,source,style,summary,tbody,td,tfoot,th,thead,title,tr,track"),Ds=/^\s*([^\s"'<>\/=]+)(?:\s*(=)\s*(?:"([^"]*)"+|'([^']*)'+|([^\s"'=<>`]+)))?/,As=/^\s*((?:v-[\w-]+:|@|:|#)\[[^=]+?\][^\s"'<>\/=]*)(?:\s*(=)\s*(?:"([^"]*)"+|'([^']*)'+|([^\s"'=<>`]+)))?/,Ps="[a-zA-Z_][\\-\\.0-9_a-zA-Z".concat(z.source,"]*"),Ls="((?:".concat(Ps,"\\:)?").concat(Ps,")"),Rs=new RegExp("^<".concat(Ls)),Hs=/^\s*(\/?)>/,js=new RegExp("^<\\/".concat(Ls,"[^>]*>")),Ns=/^<!DOCTYPE [^>]+>/i,Bs=/^<!\--/,Fs=/^<!\[/,Us=w("script,style,textarea",!0),Ws={},$s={"&lt;":"<","&gt;":">","&quot;":'"',"&amp;":"&","&#10;":"\n","&#9;":"\t","&#39;":"'"},Vs=/&(?:lt|gt|quot|amp|#39);/g,Gs=/&(?:lt|gt|quot|amp|#39|#10|#9);/g,zs=w("pre,textarea",!0),Xs=function e(t,n){return t&&zs(t)&&"\n"===n[0]};function qs(e,t){var n=t?Gs:Vs;return e.replace(n,(function(e){return $s[e]}))}var Ks=/^@|^v-on:/,Ys=/^v-|^@|^:|^#/,Js=/([\s\S]*?)\s+(?:in|of)\s+([\s\S]*)/,Qs=/,([^,\}\]]*)(?:,([^,\}\]]*))?$/,Zs=/^\(|\)$/g,eo=/^\[.*\]$/,to=/:(.*)$/,no=/^:|^\.|^v-bind:/,io=/\.[^.\]]+(?=[^\]]*$)/g,ro=/^v-slot(:|$)|^#/,so=/[\r\n]/,oo=/[ \f\t\r\n]+/g,ao=_(xs.decode),lo="_empty_";var uo,co,fo,ho,po,mo,go,vo;function yo(e,t,n){return{type:1,tag:e,attrsList:t,attrsMap:Eo(t),rawAttrsMap:{},parent:n,children:[]}}function bo(e,t){uo=t.warn||Di,mo=t.isPreTag||j,go=t.mustUseProp||j,vo=t.getTagNamespace||j;t.isReservedTag;fo=Ai(t.modules,"transformNode"),ho=Ai(t.modules,"preTransformNode"),po=Ai(t.modules,"postTransformNode"),co=t.delimiters;var n=[],i=!1!==t.preserveWhitespace,r=t.whitespace;var s,o,a=!1,l=!1;function u(e){if(c(e),a||e.processed||(e=wo(e,t)),n.length||e===s||s["if"]&&(e.elseif||e["else"])&&Io(s,{exp:e.elseif,block:e}),o&&!e.forbidden)if(e.elseif||e["else"])!function(e,t){var n=function(e){var t=e.length;for(;t--;){if(1===e[t].type)return e[t];e.pop()}}(t.children);n&&n["if"]&&Io(n,{exp:e.elseif,block:e})}(e,o);else{if(e.slotScope){var i=e.slotTarget||'"default"';(o.scopedSlots||(o.scopedSlots={}))[i]=e}o.children.push(e),e.parent=o}e.children=e.children.filter((function(e){return!e.slotScope})),c(e),e.pre&&(a=!1),mo(e.tag)&&(l=!1);for(var r=0;r<po.length;r++){po[r](e,t)}}function c(e){if(!l){var t;for(;(t=e.children[e.children.length-1])&&3===t.type&&" "===t.text;){e.children.pop()}}}return function(e,t){var n=[],i=t.expectHTML,r=t.isUnaryTag||j,s=t.canBeLeftOpenTag||j;var o,a,l=0;for(;e;){if(o=e,a&&Us(a)){(function(){var n=0;var i=a.toLowerCase(),r=Ws[i]||(Ws[i]=new RegExp("([\\s\\S]*?)(</"+i+"[^>]*>)","i")),s=e.replace(r,(function(e,r,s){return n=s.length,Us(i)||"noscript"===i||(r=r.replace(/<!\--([\s\S]*?)-->/g,"$1").replace(/<!\[CDATA\[([\s\S]*?)]]>/g,"$1")),Xs(i,r)&&(r=r.slice(1)),t.chars&&t.chars(r),""}));l+=e.length-s.length,e=s,I(i,l-n,l)})()}else{var u=void 0,c=void 0,f=void 0,d=e.indexOf("<");if(0===d){if(Bs.test(e)){var h=e.indexOf("--\x3e");if(h>=0){t.shouldKeepComment&&t.comment(e.substring(4,h),l,l+h+3),b(h+3);continue}}if(Fs.test(e)){var p=e.indexOf("]>");if(p>=0){b(p+2);continue}}var m=e.match(Ns);if(m){b(m[0].length);continue}var g=e.match(js);if(g){var v=l;b(g[0].length),I(g[1],v,l);continue}var y=w();if(y){S(y),Xs(y.tagName,e)&&b(1);continue}}if(d>=0){for(c=e.slice(d);!(js.test(c)||Rs.test(c)||Bs.test(c)||Fs.test(c)||(f=c.indexOf("<",1))<0);){d+=f,c=e.slice(d)}u=e.substring(0,d)}d<0&&(u=e),u&&b(u.length),t.chars&&u&&t.chars(u,l-u.length,l)}if(e===o){t.chars&&t.chars(e);break}}function b(t){l+=t,e=e.substring(t)}function w(){var t=e.match(Rs);if(t){var n={tagName:t[1],attrs:[],start:l};var i,r;for(b(t[0].length);!(i=e.match(Hs))&&(r=e.match(As)||e.match(Ds));){r.start=l,b(r[0].length),r.end=l,n.attrs.push(r)}if(i)return n.unarySlash=i[1],b(i[0].length),n.end=l,n}}function S(e){var o=e.tagName,l=e.unarySlash;i&&("p"===a&&Ms(o)&&I(a),s(o)&&a===o&&I(o));var u=r(o)||!!l,c=e.attrs.length,f=new Array(c);for(var d=0;d<c;d++){var h=e.attrs[d],p=h[3]||h[4]||h[5]||"",m="a"===o&&"href"===h[1]?t.shouldDecodeNewlinesForHref:t.shouldDecodeNewlines;f[d]={name:h[1],value:qs(p,m)}}u||(n.push({tag:o,lowerCasedTag:o.toLowerCase(),attrs:f,start:e.start,end:e.end}),a=o),t.start&&t.start(o,f,u,e.start,e.end)}function I(e,i,r){var s,o;if(null==i&&(i=l),null==r&&(r=l),e)for(o=e.toLowerCase(),s=n.length-1;s>=0&&n[s].lowerCasedTag!==o;s--){}else s=0;if(s>=0){for(var u=n.length-1;u>=s;u--){t.end&&t.end(n[u].tag,i,r)}n.length=s,a=s&&n[s-1].tag}else"br"===o?t.start&&t.start(e,[],!0,i,r):"p"===o&&(t.start&&t.start(e,[],!1,i,r),t.end&&t.end(e,i,r))}I()}(e,{warn:uo,expectHTML:t.expectHTML,isUnaryTag:t.isUnaryTag,canBeLeftOpenTag:t.canBeLeftOpenTag,shouldDecodeNewlines:t.shouldDecodeNewlines,shouldDecodeNewlinesForHref:t.shouldDecodeNewlinesForHref,shouldKeepComment:t.comments,outputSourceRange:t.outputSourceRange,start:function e(i,r,c,f,d){var h=o&&o.ns||vo(i);te&&"svg"===h&&(r=function(e){var t=[];for(var n=0;n<e.length;n++){var i=e[n];_o.test(i.name)||(i.name=i.name.replace(xo,""),t.push(i))}return t}(r));var p=yo(i,r,o);var m;h&&(p.ns=h),"style"!==(m=p).tag&&("script"!==m.tag||m.attrsMap.type&&"text/javascript"!==m.attrsMap.type)||ce()||(p.forbidden=!0);for(var g=0;g<ho.length;g++){p=ho[g](p,t)||p}a||(!function(e){null!=Fi(e,"v-pre")&&(e.pre=!0)}(p),p.pre&&(a=!0)),mo(p.tag)&&(l=!0),a?function(e){var t=e.attrsList,n=t.length;if(n){var i=e.attrs=new Array(n);for(var r=0;r<n;r++){i[r]={name:t[r].name,value:JSON.stringify(t[r].value)},null!=t[r].start&&(i[r].start=t[r].start,i[r].end=t[r].end)}}else e.pre||(e.plain=!0)}(p):p.processed||(So(p),function(e){var t=Fi(e,"v-if");if(t)e["if"]=t,Io(e,{exp:t,block:e});else{null!=Fi(e,"v-else")&&(e["else"]=!0);var n=Fi(e,"v-else-if");n&&(e.elseif=n)}}(p),function(e){null!=Fi(e,"v-once")&&(e.once=!0)}(p)),s||(s=p),c?u(p):(o=p,n.push(p))},end:function e(t,i,r){var s=n[n.length-1];n.length-=1,o=n[n.length-1],u(s)},chars:function e(t,n,s){if(!o)return;if(te&&"textarea"===o.tag&&o.attrsMap.placeholder===t)return;var u=o.children;var c;if(t=l||t.trim()?"script"===(c=o).tag||"style"===c.tag?t:ao(t):u.length?r?"condense"===r&&so.test(t)?"":" ":i?" ":"":""){var f,d;l||"condense"!==r||(t=t.replace(oo," ")),!a&&" "!==t&&(f=function(e,t){var n=t?ks(t):Ss;if(!n.test(e))return;var i=[],r=[];var s,o,a,l=n.lastIndex=0;for(;s=n.exec(e);){(o=s.index)>l&&(r.push(a=e.slice(l,o)),i.push(JSON.stringify(a)));var u=Oi(s[1].trim());i.push("_s(".concat(u,")")),r.push({"@binding":u}),l=o+s[0].length}return l<e.length&&(r.push(a=e.slice(l)),i.push(JSON.stringify(a))),{expression:i.join("+"),tokens:r}}(t,co))?d={type:2,expression:f.expression,tokens:f.tokens,text:t}:" "===t&&u.length&&" "===u[u.length-1].text||(d={type:3,text:t}),d&&u.push(d)}},comment:function e(t,n,i){if(o){var r={type:3,text:t,isComment:!0};o.children.push(r)}}}),s}function wo(e,t){var n;!function(e){var t=Bi(e,"key");t&&(e.key=t)}(e),e.plain=!e.key&&!e.scopedSlots&&!e.attrsList.length,function(e){var t=Bi(e,"ref");t&&(e.ref=t,e.refInFor=function(e){var t=e;for(;t;){if(void 0!==t["for"])return!0;t=t.parent}return!1}(e))}(e),function(e){var t;"template"===e.tag?(t=Fi(e,"scope"),e.slotScope=t||Fi(e,"slot-scope")):(t=Fi(e,"slot-scope"))&&(e.slotScope=t);var n=Bi(e,"slot");n&&(e.slotTarget='""'===n?'"default"':n,e.slotTargetDynamic=!(!e.attrsMap[":slot"]&&!e.attrsMap["v-bind:slot"]),"template"===e.tag||e.slotScope||Li(e,"slot",n,function(e,t){return e.rawAttrsMap[":"+t]||e.rawAttrsMap["v-bind:"+t]||e.rawAttrsMap[t]}(e,"slot")));if("template"===e.tag){var i=Ui(e,ro);if(i){var r=ko(i),s=r.name,o=r.dynamic;e.slotTarget=s,e.slotTargetDynamic=o,e.slotScope=i.value||lo}}else{var a=Ui(e,ro);if(a){var l=e.scopedSlots||(e.scopedSlots={}),u=ko(a),c=u.name,f=u.dynamic,d=l[c]=yo("template",[],e);d.slotTarget=c,d.slotTargetDynamic=f,d.children=e.children.filter((function(e){if(!e.slotScope)return e.parent=d,!0})),d.slotScope=a.value||lo,e.children=[],e.plain=!1}}}(e),"slot"===(n=e).tag&&(n.slotName=Bi(n,"name")),function(e){var t;(t=Bi(e,"is"))&&(e.component=t);null!=Fi(e,"inline-template")&&(e.inlineTemplate=!0)}(e);for(var i=0;i<fo.length;i++){e=fo[i](e,t)||e}return function(e){var t=e.attrsList;var n,i,r,s,o,a,l,u;for(n=0,i=t.length;n<i;n++){if(r=s=t[n].name,o=t[n].value,Ys.test(r)){if(e.hasBindings=!0,(a=Co(r.replace(Ys,"")))&&(r=r.replace(io,"")),no.test(r))r=r.replace(no,""),o=Oi(o),(u=eo.test(r))&&(r=r.slice(1,-1)),a&&(a.prop&&!u&&"innerHtml"===(r=T(r))&&(r="innerHTML"),a.camel&&!u&&(r=T(r)),a.sync&&(l=Vi(o,"$event"),u?Ni(e,'"update:"+('.concat(r,")"),l,null,!1,0,t[n],!0):(Ni(e,"update:".concat(T(r)),l,null,!1,0,t[n]),D(r)!==T(r)&&Ni(e,"update:".concat(D(r)),l,null,!1,0,t[n])))),a&&a.prop||!e.component&&go(e.tag,e.attrsMap.type,r)?Pi(e,r,o,t[n],u):Li(e,r,o,t[n],u);else if(Ks.test(r))r=r.replace(Ks,""),(u=eo.test(r))&&(r=r.slice(1,-1)),Ni(e,r,o,a,!1,0,t[n],u);else{var c=(r=r.replace(Ys,"")).match(to);var f=c&&c[1];u=!1,f&&(r=r.slice(0,-(f.length+1)),eo.test(f)&&(f=f.slice(1,-1),u=!0)),Hi(e,r,s,o,f,u,a,t[n])}}else Li(e,r,JSON.stringify(o),t[n]),!e.component&&"muted"===r&&go(e.tag,e.attrsMap.type,r)&&Pi(e,r,"true",t[n])}}(e),e}function So(e){var t;if(t=Fi(e,"v-for")){var n=function(e){var t=e.match(Js);if(!t)return;var n={};n["for"]=t[2].trim();var i=t[1].trim().replace(Zs,""),r=i.match(Qs);r?(n.alias=i.replace(Qs,"").trim(),n.iterator1=r[1].trim(),r[2]&&(n.iterator2=r[2].trim())):n.alias=i;return n}(t);n&&L(e,n)}}function Io(e,t){e.ifConditions||(e.ifConditions=[]),e.ifConditions.push(t)}function ko(e){var t=e.name.replace(ro,"");return t||"#"!==e.name[0]&&(t="default"),eo.test(t)?{name:t.slice(1,-1),dynamic:!0}:{name:'"'.concat(t,'"'),dynamic:!1}}function Co(e){var t=e.match(io);if(t){var n={};return t.forEach((function(e){n[e.slice(1)]=!0})),n}}function Eo(e){var t={};for(var n=0,i=e.length;n<i;n++){t[e[n].name]=e[n].value}return t}var _o=/^xmlns:NS\d+/,xo=/^NS\d+:/;function To(e){return yo(e.tag,e.attrsList.slice(),e.parent)}var Oo=[Cs,Es,{preTransformNode:function e(t,n){if("input"===t.tag){var i=t.attrsMap;if(!i["v-model"])return;var r;if((i[":type"]||i["v-bind:type"])&&(r=Bi(t,"type")),i.type||r||!i["v-bind"]||(r="(".concat(i["v-bind"],").type")),r){var s=Fi(t,"v-if",!0),o=s?"&&(".concat(s,")"):"",a=null!=Fi(t,"v-else",!0),l=Fi(t,"v-else-if",!0),u=To(t);So(u),Ri(u,"type","checkbox"),wo(u,n),u.processed=!0,u["if"]="(".concat(r,")==='checkbox'")+o,Io(u,{exp:u["if"],block:u});var c=To(t);Fi(c,"v-for",!0),Ri(c,"type","radio"),wo(c,n),Io(u,{exp:"(".concat(r,")==='radio'")+o,block:c});var f=To(t);return Fi(f,"v-for",!0),Ri(f,":type",r),wo(f,n),Io(u,{exp:s,block:f}),a?u["else"]=!0:l&&(u.elseif=l),u}}}}];var Mo={expectHTML:!0,modules:Oo,directives:{model:function e(t,n,i){var r=n.value,s=n.modifiers,o=t.tag,a=t.attrsMap.type;if(t.component)return $i(t,r,s),!1;if("select"===o)!function(e,t,n){var i="var $$selectedVal = ".concat('Array.prototype.filter.call($event.target.options,function(o){return o.selected}).map(function(o){var val = "_value" in o ? o._value : o.value;'+"return ".concat(n&&n.number?"_n(val)":"val","})"),";");i="".concat(i," ").concat(Vi(t,"$event.target.multiple ? $$selectedVal : $$selectedVal[0]")),Ni(e,"change",i,null,!0)}(t,r,s);else if("input"===o&&"checkbox"===a)!function(e,t,n){var i=n&&n.number,r=Bi(e,"value")||"null",s=Bi(e,"true-value")||"true",o=Bi(e,"false-value")||"false";Pi(e,"checked","Array.isArray(".concat(t,")")+"?_i(".concat(t,",").concat(r,")>-1")+("true"===s?":(".concat(t,")"):":_q(".concat(t,",").concat(s,")"))),Ni(e,"change","var $$a=".concat(t,",")+"$$el=$event.target,"+"$$c=$$el.checked?(".concat(s,"):(").concat(o,");")+"if(Array.isArray($$a)){"+"var $$v=".concat(i?"_n("+r+")":r,",")+"$$i=_i($$a,$$v);"+"if($$el.checked){$$i<0&&(".concat(Vi(t,"$$a.concat([$$v])"),")}")+"else{$$i>-1&&(".concat(Vi(t,"$$a.slice(0,$$i).concat($$a.slice($$i+1))"),")}")+"}else{".concat(Vi(t,"$$c"),"}"),null,!0)}(t,r,s);else if("input"===o&&"radio"===a)!function(e,t,n){var i=n&&n.number;var r=Bi(e,"value")||"null";Pi(e,"checked","_q(".concat(t,",").concat(r=i?"_n(".concat(r,")"):r,")")),Ni(e,"change",Vi(t,r),null,!0)}(t,r,s);else if("input"===o||"textarea"===o)!function(e,t,n){var i=e.attrsMap.type,r=n||{},s=r.lazy,o=r.number,a=r.trim,l=!s&&"range"!==i,u=s?"change":"range"===i?nr:"input";var c="$event.target.value";a&&(c="$event.target.value.trim()"),o&&(c="_n(".concat(c,")"));var f=Vi(t,c);l&&(f="if($event.target.composing)return;".concat(f)),Pi(e,"value","(".concat(t,")")),Ni(e,u,f,null,!0),(a||o)&&Ni(e,"blur","$forceUpdate()")}(t,r,s);else if(!G.isReservedTag(o))return $i(t,r,s),!1;return!0},text:function e(t,n){n.value&&Pi(t,"textContent","_s(".concat(n.value,")"),n)},html:function e(t,n){n.value&&Pi(t,"innerHTML","_s(".concat(n.value,")"),n)}},isPreTag:function e(t){return"pre"===t},isUnaryTag:Ts,mustUseProp:Un,canBeLeftOpenTag:Os,isReservedTag:ii,getTagNamespace:ri,staticKeys:function(e){return e.reduce((function(e,t){return e.concat(t.staticKeys||[])}),[]).join(",")}(Oo)};var Do,Ao;var Po=_((function(e){return w("type,tag,attrsList,attrsMap,plain,parent,children,attrs,start,end,rawAttrsMap"+(e?","+e:""))}));function Lo(e,t){e&&(Do=Po(t.staticKeys||""),Ao=t.isReservedTag||j,function e(t){t["static"]=function(e){if(2===e.type)return!1;if(3===e.type)return!0;return!(!e.pre&&(e.hasBindings||e["if"]||e["for"]||S(e.tag)||!Ao(e.tag)||function(e){for(;e.parent;){if("template"!==(e=e.parent).tag)return!1;if(e["for"])return!0}return!1}(e)||!Object.keys(e).every(Do)))}(t);if(1===t.type){if(!Ao(t.tag)&&"slot"!==t.tag&&null==t.attrsMap["inline-template"])return;for(var n=0,i=t.children.length;n<i;n++){var r=t.children[n];e(r),r["static"]||(t["static"]=!1)}if(t.ifConditions)for(var s=1,o=t.ifConditions.length;s<o;s++){var a=t.ifConditions[s].block;e(a),a["static"]||(t["static"]=!1)}}}(e),function e(t,n){if(1===t.type){if((t["static"]||t.once)&&(t.staticInFor=n),t["static"]&&t.children.length&&(1!==t.children.length||3!==t.children[0].type))return void(t.staticRoot=!0);if(t.staticRoot=!1,t.children)for(var i=0,r=t.children.length;i<r;i++){e(t.children[i],n||!!t["for"])}if(t.ifConditions)for(var s=1,o=t.ifConditions.length;s<o;s++){e(t.ifConditions[s].block,n)}}}(e,!1))}var Ro=/^([\w$_]+|\([^)]*?\))\s*=>|^function(?:\s+[\w$]+)?\s*\(/,Ho=/\([^)]*?\);*$/,jo=/^[A-Za-z_$][\w$]*(?:\.[A-Za-z_$][\w$]*|\['[^']*?']|\["[^"]*?"]|\[\d+]|\[[A-Za-z_$][\w$]*])*$/,No={esc:27,tab:9,enter:13,space:32,up:38,left:37,right:39,down:40,delete:[8,46]},Bo={esc:["Esc","Escape"],tab:"Tab",enter:"Enter",space:[" ","Spacebar"],up:["Up","ArrowUp"],left:["Left","ArrowLeft"],right:["Right","ArrowRight"],down:["Down","ArrowDown"],delete:["Backspace","Delete","Del"]},Fo=function e(t){return"if(".concat(t,")return null;")},Uo={stop:"$event.stopPropagation();",prevent:"$event.preventDefault();",self:Fo("$event.target !== $event.currentTarget"),ctrl:Fo("!$event.ctrlKey"),shift:Fo("!$event.shiftKey"),alt:Fo("!$event.altKey"),meta:Fo("!$event.metaKey"),left:Fo("'button' in $event && $event.button !== 0"),middle:Fo("'button' in $event && $event.button !== 1"),right:Fo("'button' in $event && $event.button !== 2")};function Wo(e,t){var n=t?"nativeOn:":"on:";var i="",r="";for(var s in e){var o=$o(e[s]);e[s]&&e[s].dynamic?r+="".concat(s,",").concat(o,","):i+='"'.concat(s,'":').concat(o,",")}return i="{".concat(i.slice(0,-1),"}"),r?n+"_d(".concat(i,",[").concat(r.slice(0,-1),"])"):n+i}function $o(e){if(!e)return"function(){}";if(Array.isArray(e))return"[".concat(e.map((function(e){return $o(e)})).join(","),"]");var t=jo.test(e.value),n=Ro.test(e.value),i=jo.test(e.value.replace(Ho,""));if(e.modifiers){var r="",s="";var o=[];for(var a in e.modifiers){if(Uo[a])s+=Uo[a],No[a]&&o.push(a);else if("exact"===a){(function(){var t=e.modifiers;s+=Fo(["ctrl","shift","alt","meta"].filter((function(e){return!t[e]})).map((function(e){return"$event.".concat(e,"Key")})).join("||"))})()}else o.push(a)}return o.length&&(r+=function(e){return"if(!$event.type.indexOf('key')&&"+"".concat(e.map(Vo).join("&&"),")return null;")}(o)),s&&(r+=s),"function($event){".concat(r).concat(t?"return ".concat(e.value,".apply(null, arguments)"):n?"return (".concat(e.value,").apply(null, arguments)"):i?"return ".concat(e.value):e.value,"}")}return t||n?e.value:"function($event){".concat(i?"return ".concat(e.value):e.value,"}")}function Vo(e){var t=parseInt(e,10);if(t)return"$event.keyCode!==".concat(t);var n=No[e],i=Bo[e];return"_k($event.keyCode,"+"".concat(JSON.stringify(e),",")+"".concat(JSON.stringify(n),",")+"$event.key,"+"".concat(JSON.stringify(i))+")"}var Go={on:function e(t,n){t.wrapListeners=function(e){return"_g(".concat(e,",").concat(n.value,")")}},bind:function e(t,n){t.wrapData=function(e){return"_b(".concat(e,",'").concat(t.tag,"',").concat(n.value,",").concat(n.modifiers&&n.modifiers.prop?"true":"false").concat(n.modifiers&&n.modifiers.sync?",true":"",")")}},cloak:H};var zo=function e(t){babelHelpers.classCallCheck(this,e);this.options=t,this.warn=t.warn||Di,this.transforms=Ai(t.modules,"transformCode"),this.dataGenFns=Ai(t.modules,"genData"),this.directives=L(L({},Go),t.directives);var n=t.isReservedTag||j;this.maybeComponent=function(e){return!!e.component||!n(e.tag)},this.onceId=0,this.staticRenderFns=[],this.pre=!1};function Xo(e,t){var n=new zo(t);return{render:"with(this){return ".concat(e?"script"===e.tag?"null":qo(e,n):'_c("div")',"}"),staticRenderFns:n.staticRenderFns}}function qo(e,t){if(e.parent&&(e.pre=e.pre||e.parent.pre),e.staticRoot&&!e.staticProcessed)return Ko(e,t);if(e.once&&!e.onceProcessed)return Yo(e,t);if(e["for"]&&!e.forProcessed)return Qo(e,t);if(e["if"]&&!e.ifProcessed)return Jo(e,t);if("template"!==e.tag||e.slotTarget||t.pre){if("slot"===e.tag)return function(e,t){var n=e.slotName||'"default"',i=na(e,t);var r="_t(".concat(n).concat(i?",function(){return ".concat(i,"}"):"");var s=e.attrs||e.dynamicAttrs?sa((e.attrs||[]).concat(e.dynamicAttrs||[]).map((function(e){return{name:T(e.name),value:e.value,dynamic:e.dynamic}}))):null,o=e.attrsMap["v-bind"];!s&&!o||i||(r+=",null");s&&(r+=",".concat(s));o&&(r+="".concat(s?"":",null",",").concat(o));return r+")"}(e,t);{var n;if(e.component)n=function(e,t,n){var i=t.inlineTemplate?null:na(t,n,!0);return"_c(".concat(e,",").concat(Zo(t,n)).concat(i?",".concat(i):"",")")}(e.component,e,t);else{var i;(!e.plain||e.pre&&t.maybeComponent(e))&&(i=Zo(e,t));var r=e.inlineTemplate?null:na(e,t,!0);n="_c('".concat(e.tag,"'").concat(i?",".concat(i):"").concat(r?",".concat(r):"",")")}for(var s=0;s<t.transforms.length;s++){n=t.transforms[s](e,n)}return n}}return na(e,t)||"void 0"}function Ko(e,t){e.staticProcessed=!0;var n=t.pre;return e.pre&&(t.pre=e.pre),t.staticRenderFns.push("with(this){return ".concat(qo(e,t),"}")),t.pre=n,"_m(".concat(t.staticRenderFns.length-1).concat(e.staticInFor?",true":"",")")}function Yo(e,t){if(e.onceProcessed=!0,e["if"]&&!e.ifProcessed)return Jo(e,t);if(e.staticInFor){var n="",i=e.parent;for(;i;){if(i["for"]){n=i.key;break}i=i.parent}return n?"_o(".concat(qo(e,t),",").concat(t.onceId++,",").concat(n,")"):qo(e,t)}return Ko(e,t)}function Jo(e,t,n,i){return e.ifProcessed=!0,function e(t,n,i,r){if(!t.length)return r||"_e()";var s=t.shift();return s.exp?"(".concat(s.exp,")?").concat(o(s.block),":").concat(e(t,n,i,r)):"".concat(o(s.block));function o(e){return i?i(e,n):e.once?Yo(e,n):qo(e,n)}}(e.ifConditions.slice(),t,n,i)}function Qo(e,t,n,i){var r=e["for"],s=e.alias,o=e.iterator1?",".concat(e.iterator1):"",a=e.iterator2?",".concat(e.iterator2):"";return e.forProcessed=!0,"".concat(i||"_l","((").concat(r,"),")+"function(".concat(s).concat(o).concat(a,"){")+"return ".concat((n||qo)(e,t))+"})"}function Zo(e,t){var n="{";var i=function(e,t){var n=e.directives;if(!n)return;var i,r,s,o,a="directives:[",l=!1;for(i=0,r=n.length;i<r;i++){s=n[i],o=!0;var u=t.directives[s.name];u&&(o=!!u(e,s,t.warn)),o&&(l=!0,a+='{name:"'.concat(s.name,'",rawName:"').concat(s.rawName,'"').concat(s.value?",value:(".concat(s.value,"),expression:").concat(JSON.stringify(s.value)):"").concat(s.arg?",arg:".concat(s.isDynamicArg?s.arg:'"'.concat(s.arg,'"')):"").concat(s.modifiers?",modifiers:".concat(JSON.stringify(s.modifiers)):"","},"))}if(l)return a.slice(0,-1)+"]"}(e,t);i&&(n+=i+","),e.key&&(n+="key:".concat(e.key,",")),e.ref&&(n+="ref:".concat(e.ref,",")),e.refInFor&&(n+="refInFor:true,"),e.pre&&(n+="pre:true,"),e.component&&(n+='tag:"'.concat(e.tag,'",'));for(var r=0;r<t.dataGenFns.length;r++){n+=t.dataGenFns[r](e)}if(e.attrs&&(n+="attrs:".concat(sa(e.attrs),",")),e.props&&(n+="domProps:".concat(sa(e.props),",")),e.events&&(n+="".concat(Wo(e.events,!1),",")),e.nativeEvents&&(n+="".concat(Wo(e.nativeEvents,!0),",")),e.slotTarget&&!e.slotScope&&(n+="slot:".concat(e.slotTarget,",")),e.scopedSlots&&(n+="".concat(function(e,t,n){var i=e["for"]||Object.keys(t).some((function(e){var n=t[e];return n.slotTargetDynamic||n["if"]||n["for"]||ea(n)})),r=!!e["if"];if(!i){var s=e.parent;for(;s;){if(s.slotScope&&s.slotScope!==lo||s["for"]){i=!0;break}s["if"]&&(r=!0),s=s.parent}}var o=Object.keys(t).map((function(e){return ta(t[e],n)})).join(",");return"scopedSlots:_u([".concat(o,"]").concat(i?",null,true":"").concat(!i&&r?",null,false,".concat(function(e){var t=5381,n=e.length;for(;n;){t=33*t^e.charCodeAt(--n)}return t>>>0}(o)):"",")")}(e,e.scopedSlots,t),",")),e.model&&(n+="model:{value:".concat(e.model.value,",callback:").concat(e.model.callback,",expression:").concat(e.model.expression,"},")),e.inlineTemplate){var s=function(e,t){var n=e.children[0];if(n&&1===n.type){var i=Xo(n,t.options);return"inlineTemplate:{render:function(){".concat(i.render,"},staticRenderFns:[").concat(i.staticRenderFns.map((function(e){return"function(){".concat(e,"}")})).join(","),"]}")}}(e,t);s&&(n+="".concat(s,","))}return n=n.replace(/,$/,"")+"}",e.dynamicAttrs&&(n="_b(".concat(n,',"').concat(e.tag,'",').concat(sa(e.dynamicAttrs),")")),e.wrapData&&(n=e.wrapData(n)),e.wrapListeners&&(n=e.wrapListeners(n)),n}function ea(e){return 1===e.type&&("slot"===e.tag||e.children.some(ea))}function ta(e,t){var n=e.attrsMap["slot-scope"];if(e["if"]&&!e.ifProcessed&&!n)return Jo(e,t,ta,"null");if(e["for"]&&!e.forProcessed)return Qo(e,t,ta);var i=e.slotScope===lo?"":String(e.slotScope),r="function(".concat(i,"){")+"return ".concat("template"===e.tag?e["if"]&&n?"(".concat(e["if"],")?").concat(na(e,t)||"undefined",":undefined"):na(e,t)||"undefined":qo(e,t),"}"),s=i?"":",proxy:true";return"{key:".concat(e.slotTarget||'"default"',",fn:").concat(r).concat(s,"}")}function na(e,t,n,i,r){var s=e.children;if(s.length){var o=s[0];if(1===s.length&&o["for"]&&"template"!==o.tag&&"slot"!==o.tag){var a=n?t.maybeComponent(o)?",1":",0":"";return"".concat((i||qo)(o,t)).concat(a)}var l=n?function(e,t){var n=0;for(var i=0;i<e.length;i++){var r=e[i];if(1===r.type){if(ia(r)||r.ifConditions&&r.ifConditions.some((function(e){return ia(e.block)}))){n=2;break}(t(r)||r.ifConditions&&r.ifConditions.some((function(e){return t(e.block)})))&&(n=1)}}return n}(s,t.maybeComponent):0,u=r||ra;return"[".concat(s.map((function(e){return u(e,t)})).join(","),"]").concat(l?",".concat(l):"")}}function ia(e){return void 0!==e["for"]||"template"===e.tag||"slot"===e.tag}function ra(e,t){return 1===e.type?qo(e,t):3===e.type&&e.isComment?(i=e,"_e(".concat(JSON.stringify(i.text),")")):"_v(".concat(2===(n=e).type?n.expression:oa(JSON.stringify(n.text)),")");var n,i}function sa(e){var t="",n="";for(var i=0;i<e.length;i++){var r=e[i],s=oa(r.value);r.dynamic?n+="".concat(r.name,",").concat(s,","):t+='"'.concat(r.name,'":').concat(s,",")}return t="{".concat(t.slice(0,-1),"}"),n?"_d(".concat(t,",[").concat(n.slice(0,-1),"])"):t}function oa(e){return e.replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}function aa(e,t){try{return new Function(e)}catch(n){return t.push({err:n,code:e}),H}}function la(e){var t=Object.create(null);return function(n,i,r){(i=L({},i)).warn;delete i.warn;var s=i.delimiters?String(i.delimiters)+n:n;if(t[s])return t[s];var o=e(n,i),a={},l=[];return a.render=aa(o.render,l),a.staticRenderFns=o.staticRenderFns.map((function(e){return aa(e,l)})),t[s]=a}}var ua=(ca=function e(t,n){var i=bo(t.trim(),n);!1!==n.optimize&&Lo(i,n);var r=Xo(i,n);return{ast:i,render:r.render,staticRenderFns:r.staticRenderFns}},function(e){function t(t,n){var i=Object.create(e),r=[],s=[];if(n){n.modules&&(i.modules=(e.modules||[]).concat(n.modules)),n.directives&&(i.directives=L(Object.create(e.directives||null),n.directives));for(var o in n){"modules"!==o&&"directives"!==o&&(i[o]=n[o])}}i.warn=function(e,t,n){(n?s:r).push(e)};var a=ca(t.trim(),i);return a.errors=r,a.tips=s,a}return{compile:t,compileToFunctions:la(t)}});var ca;var fa=ua(Mo),da=fa.compile,ha=fa.compileToFunctions;var pa;function ma(e){return(pa=pa||document.createElement("div")).innerHTML=e?'<a href="\n"/>':'<div a="\n"/>',pa.innerHTML.indexOf("&#10;")>0}var ga=!!J&&ma(!1),va=!!J&&ma(!0),ya=_((function(e){var t=ai(e);return t&&t.innerHTML})),ba=Dn.prototype.$mount;Dn.prototype.$mount=function(e,t){if((e=e&&ai(e))===document.body||e===document.documentElement)return this;var n=this.$options;if(!n.render){var i=n.template;if(i){if("string"==typeof i)"#"===i.charAt(0)&&(i=ya(i));else{if(!i.nodeType)return this;i=i.innerHTML}}else e&&(i=function(e){if(e.outerHTML)return e.outerHTML;{var t=document.createElement("div");return t.appendChild(e.cloneNode(!0)),t.innerHTML}}(e));if(i){var r=ha(i,{outputSourceRange:!1,shouldDecodeNewlines:ga,shouldDecodeNewlinesForHref:va,delimiters:n.delimiters,comments:n.comments},this),s=r.render,o=r.staticRenderFns;n.render=s,n.staticRenderFns=o}}return ba.call(this,e,t)},Dn.compile=ha;var wa=new a(Dn);e.WidgetBitrixVue=wa;e.WidgetVue=wa;e.WidgetVueVendor=Dn;e.WidgetVueVendorV2=Dn})(this.BX=this.BX||{},BX.Event,BX,BX,BX)})();
/*!
 * protobuf.js v6.8.6 (c) 2016, daniel wirtz
 * compiled mon, 26 feb 2018 11:35:34 utc
 * licensed under the bsd-3-clause license
 * see: https://github.com/dcodeio/protobuf.js for details
 *
 * Modify list for integration with Bitrix Framework:
 * - removed integration with RequireJS and AMD package builders;
 */(function(global,undefined){"use strict";(function e(t,n,i){function r(e){var i=n[e];if(!i)t[e][0].call(i=n[e]={exports:{}},r,i,i.exports);return i.exports}var s=global.protobuf=r(i[0])})({1:[function(e,t,n){"use strict";t.exports=i;function i(e,t){var n=new Array(arguments.length-1),i=0,r=2,s=true;while(r<arguments.length)n[i++]=arguments[r++];return new Promise((function r(o,a){n[i]=function e(t){if(s){s=false;if(t)a(t);else{var n=new Array(arguments.length-1),i=0;while(i<n.length)n[i++]=arguments[i];o.apply(null,n)}}};try{e.apply(t||null,n)}catch(e){if(s){s=false;a(e)}}}))}},{}],2:[function(e,t,n){"use strict";var i=n;i.length=function e(t){var n=t.length;if(!n)return 0;var i=0;while(--n%4>1&&t.charAt(n)==="=")++i;return Math.ceil(t.length*3)/4-i};var r=new Array(64);var s=new Array(123);for(var o=0;o<64;)s[r[o]=o<26?o+65:o<52?o+71:o<62?o-4:o-59|43]=o++;i.encode=function e(t,n,i){var s=null,o=[];var a=0,l=0,u;while(n<i){var c=t[n++];switch(l){case 0:o[a++]=r[c>>2];u=(c&3)<<4;l=1;break;case 1:o[a++]=r[u|c>>4];u=(c&15)<<2;l=2;break;case 2:o[a++]=r[u|c>>6];o[a++]=r[c&63];l=0;break}if(a>8191){(s||(s=[])).push(String.fromCharCode.apply(String,o));a=0}}if(l){o[a++]=r[u];o[a++]=61;if(l===1)o[a++]=61}if(s){if(a)s.push(String.fromCharCode.apply(String,o.slice(0,a)));return s.join("")}return String.fromCharCode.apply(String,o.slice(0,a))};var a="invalid encoding";i.decode=function e(t,n,i){var r=i;var o=0,l;for(var u=0;u<t.length;){var c=t.charCodeAt(u++);if(c===61&&o>1)break;if((c=s[c])===undefined)throw Error(a);switch(o){case 0:l=c;o=1;break;case 1:n[i++]=l<<2|(c&48)>>4;l=c;o=2;break;case 2:n[i++]=(l&15)<<4|(c&60)>>2;l=c;o=3;break;case 3:n[i++]=(l&3)<<6|c;o=0;break}}if(o===1)throw Error(a);return i-r};i.test=function e(t){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(t)}},{}],3:[function(e,t,n){"use strict";t.exports=i;function i(e,t){if(typeof e==="string"){t=e;e=undefined}var n=[];function r(e){if(typeof e!=="string"){var t=s();if(i.verbose)console.log("codegen: "+t);t="return "+t;if(e){var o=Object.keys(e),a=new Array(o.length+1),l=new Array(o.length),u=0;while(u<o.length){a[u]=o[u];l[u]=e[o[u++]]}a[u]=t;return Function.apply(null,a).apply(null,l)}return Function(t)()}var c=new Array(arguments.length-1),f=0;while(f<c.length)c[f]=arguments[++f];f=0;e=e.replace(/%([%dfijs])/g,(function e(t,n){var i=c[f++];switch(n){case"d":case"f":return String(Number(i));case"i":return String(Math.floor(i));case"j":return JSON.stringify(i);case"s":return String(i)}return"%"}));if(f!==c.length)throw Error("parameter count mismatch");n.push(e);return r}function s(i){return"function "+(i||t||"")+"("+(e&&e.join(",")||"")+"){\n  "+n.join("\n  ")+"\n}"}r.toString=s;return r}i.verbose=false},{}],4:[function(e,t,n){"use strict";t.exports=i;function i(){this._listeners={}}i.prototype.on=function e(t,n,i){(this._listeners[t]||(this._listeners[t]=[])).push({fn:n,ctx:i||this});return this};i.prototype.off=function e(t,n){if(t===undefined)this._listeners={};else{if(n===undefined)this._listeners[t]=[];else{var i=this._listeners[t];for(var r=0;r<i.length;)if(i[r].fn===n)i.splice(r,1);else++r}}return this};i.prototype.emit=function e(t){var n=this._listeners[t];if(n){var i=[],r=1;for(;r<arguments.length;)i.push(arguments[r++]);for(r=0;r<n.length;)n[r].fn.apply(n[r++].ctx,i)}return this}},{}],5:[function(e,t,n){"use strict";t.exports=o;var i=e(1),r=e(7);var s=r("fs");function o(e,t,n){if(typeof t==="function"){n=t;t={}}else if(!t)t={};if(!n)return i(o,this,e,t);if(!t.xhr&&s&&s.readFile)return s.readFile(e,(function i(r,s){return r&&typeof XMLHttpRequest!=="undefined"?o.xhr(e,t,n):r?n(r):n(null,t.binary?s:s.toString("utf8"))}));return o.xhr(e,t,n)}o.xhr=function e(t,n,i){var r=new XMLHttpRequest;r.onreadystatechange=function e(){if(r.readyState!==4)return undefined;if(r.status!==0&&r.status!==200)return i(Error("status "+r.status));if(n.binary){var t=r.response;if(!t){t=[];for(var s=0;s<r.responseText.length;++s)t.push(r.responseText.charCodeAt(s)&255)}return i(null,typeof Uint8Array!=="undefined"?new Uint8Array(t):t)}return i(null,r.responseText)};if(n.binary){if("overrideMimeType"in r)r.overrideMimeType("text/plain; charset=x-user-defined");r.responseType="arraybuffer"}r.open("GET",t);r.send()}},{1:1,7:7}],6:[function(e,t,n){"use strict";t.exports=i(i);function i(e){if(typeof Float32Array!=="undefined")(function(){var t=new Float32Array([-0]),n=new Uint8Array(t.buffer),i=n[3]===128;function r(e,i,r){t[0]=e;i[r]=n[0];i[r+1]=n[1];i[r+2]=n[2];i[r+3]=n[3]}function s(e,i,r){t[0]=e;i[r]=n[3];i[r+1]=n[2];i[r+2]=n[1];i[r+3]=n[0]}e.writeFloatLE=i?r:s;e.writeFloatBE=i?s:r;function o(e,i){n[0]=e[i];n[1]=e[i+1];n[2]=e[i+2];n[3]=e[i+3];return t[0]}function a(e,i){n[3]=e[i];n[2]=e[i+1];n[1]=e[i+2];n[0]=e[i+3];return t[0]}e.readFloatLE=i?o:a;e.readFloatBE=i?a:o})();else(function(){function t(e,t,n,i){var r=t<0?1:0;if(r)t=-t;if(t===0)e(1/t>0?0:2147483648,n,i);else if(isNaN(t))e(2143289344,n,i);else if(t>34028234663852886e22)e((r<<31|2139095040)>>>0,n,i);else if(t<11754943508222875e-54)e((r<<31|Math.round(t/1401298464324817e-60))>>>0,n,i);else{var s=Math.floor(Math.log(t)/Math.LN2),o=Math.round(t*Math.pow(2,-s)*8388608)&8388607;e((r<<31|s+127<<23|o)>>>0,n,i)}}e.writeFloatLE=t.bind(null,r);e.writeFloatBE=t.bind(null,s);function n(e,t,n){var i=e(t,n),r=(i>>31)*2+1,s=i>>>23&255,o=i&8388607;return s===255?o?NaN:r*Infinity:s===0?r*1401298464324817e-60*o:r*Math.pow(2,s-150)*(o+8388608)}e.readFloatLE=n.bind(null,o);e.readFloatBE=n.bind(null,a)})();if(typeof Float64Array!=="undefined")(function(){var t=new Float64Array([-0]),n=new Uint8Array(t.buffer),i=n[7]===128;function r(e,i,r){t[0]=e;i[r]=n[0];i[r+1]=n[1];i[r+2]=n[2];i[r+3]=n[3];i[r+4]=n[4];i[r+5]=n[5];i[r+6]=n[6];i[r+7]=n[7]}function s(e,i,r){t[0]=e;i[r]=n[7];i[r+1]=n[6];i[r+2]=n[5];i[r+3]=n[4];i[r+4]=n[3];i[r+5]=n[2];i[r+6]=n[1];i[r+7]=n[0]}e.writeDoubleLE=i?r:s;e.writeDoubleBE=i?s:r;function o(e,i){n[0]=e[i];n[1]=e[i+1];n[2]=e[i+2];n[3]=e[i+3];n[4]=e[i+4];n[5]=e[i+5];n[6]=e[i+6];n[7]=e[i+7];return t[0]}function a(e,i){n[7]=e[i];n[6]=e[i+1];n[5]=e[i+2];n[4]=e[i+3];n[3]=e[i+4];n[2]=e[i+5];n[1]=e[i+6];n[0]=e[i+7];return t[0]}e.readDoubleLE=i?o:a;e.readDoubleBE=i?a:o})();else(function(){function t(e,t,n,i,r,s){var o=i<0?1:0;if(o)i=-i;if(i===0){e(0,r,s+t);e(1/i>0?0:2147483648,r,s+n)}else if(isNaN(i)){e(0,r,s+t);e(2146959360,r,s+n)}else if(i>17976931348623157e292){e(0,r,s+t);e((o<<31|2146435072)>>>0,r,s+n)}else{var a;if(i<22250738585072014e-324){a=i/5e-324;e(a>>>0,r,s+t);e((o<<31|a/4294967296)>>>0,r,s+n)}else{var l=Math.floor(Math.log(i)/Math.LN2);if(l===1024)l=1023;a=i*Math.pow(2,-l);e(a*4503599627370496>>>0,r,s+t);e((o<<31|l+1023<<20|a*1048576&1048575)>>>0,r,s+n)}}}e.writeDoubleLE=t.bind(null,r,0,4);e.writeDoubleBE=t.bind(null,s,4,0);function n(e,t,n,i,r){var s=e(i,r+t),o=e(i,r+n);var a=(o>>31)*2+1,l=o>>>20&2047,u=4294967296*(o&1048575)+s;return l===2047?u?NaN:a*Infinity:l===0?a*5e-324*u:a*Math.pow(2,l-1075)*(u+4503599627370496)}e.readDoubleLE=n.bind(null,o,0,4);e.readDoubleBE=n.bind(null,a,4,0)})();return e}function r(e,t,n){t[n]=e&255;t[n+1]=e>>>8&255;t[n+2]=e>>>16&255;t[n+3]=e>>>24}function s(e,t,n){t[n]=e>>>24;t[n+1]=e>>>16&255;t[n+2]=e>>>8&255;t[n+3]=e&255}function o(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function a(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}},{}],7:[function(require,module,exports){"use strict";module.exports=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}},{}],8:[function(e,t,n){"use strict";var i=n;var r=i.isAbsolute=function e(t){return/^(?:\/|\w+:)/.test(t)};var s=i.normalize=function e(t){t=t.replace(/\\/g,"/").replace(/\/{2,}/g,"/");var n=t.split("/"),i=r(t),s="";if(i)s=n.shift()+"/";for(var o=0;o<n.length;){if(n[o]===".."){if(o>0&&n[o-1]!=="..")n.splice(--o,2);else if(i)n.splice(o,1);else++o}else if(n[o]===".")n.splice(o,1);else++o}return s+n.join("/")};i.resolve=function e(t,n,i){if(!i)n=s(n);if(r(n))return n;if(!i)t=s(t);return(t=t.replace(/(?:\/|^)[^/]+$/,"")).length?s(t+"/"+n):n}},{}],9:[function(e,t,n){"use strict";t.exports=i;function i(e,t,n){var i=n||8192;var r=i>>>1;var s=null;var o=i;return function n(a){if(a<1||a>r)return e(a);if(o+a>i){s=e(i);o=0}var l=t.call(s,o,o+=a);if(o&7)o=(o|7)+1;return l}}},{}],10:[function(e,t,n){"use strict";var i=n;i.length=function e(t){var n=0,i=0;for(var r=0;r<t.length;++r){i=t.charCodeAt(r);if(i<128)n+=1;else if(i<2048)n+=2;else if((i&64512)===55296&&(t.charCodeAt(r+1)&64512)===56320){++r;n+=4}else n+=3}return n};i.read=function e(t,n,i){var r=i-n;if(r<1)return"";var s=null,o=[],a=0,l;while(n<i){l=t[n++];if(l<128)o[a++]=l;else if(l>191&&l<224)o[a++]=(l&31)<<6|t[n++]&63;else if(l>239&&l<365){l=((l&7)<<18|(t[n++]&63)<<12|(t[n++]&63)<<6|t[n++]&63)-65536;o[a++]=55296+(l>>10);o[a++]=56320+(l&1023)}else o[a++]=(l&15)<<12|(t[n++]&63)<<6|t[n++]&63;if(a>8191){(s||(s=[])).push(String.fromCharCode.apply(String,o));a=0}}if(s){if(a)s.push(String.fromCharCode.apply(String,o.slice(0,a)));return s.join("")}return String.fromCharCode.apply(String,o.slice(0,a))};i.write=function e(t,n,i){var r=i,s,o;for(var a=0;a<t.length;++a){s=t.charCodeAt(a);if(s<128){n[i++]=s}else if(s<2048){n[i++]=s>>6|192;n[i++]=s&63|128}else if((s&64512)===55296&&((o=t.charCodeAt(a+1))&64512)===56320){s=65536+((s&1023)<<10)+(o&1023);++a;n[i++]=s>>18|240;n[i++]=s>>12&63|128;n[i++]=s>>6&63|128;n[i++]=s&63|128}else{n[i++]=s>>12|224;n[i++]=s>>6&63|128;n[i++]=s&63|128}}return i-r}},{}],11:[function(e,t,n){"use strict";t.exports=r;var i=/\/|\./;function r(e,t){if(!i.test(e)){e="google/protobuf/"+e+".proto";t={nested:{google:{nested:{protobuf:{nested:t}}}}}}r[e]=t}r("any",{Any:{fields:{type_url:{type:"string",id:1},value:{type:"bytes",id:2}}}});var s;r("duration",{Duration:s={fields:{seconds:{type:"int64",id:1},nanos:{type:"int32",id:2}}}});r("timestamp",{Timestamp:s});r("empty",{Empty:{fields:{}}});r("struct",{Struct:{fields:{fields:{keyType:"string",type:"Value",id:1}}},Value:{oneofs:{kind:{oneof:["nullValue","numberValue","stringValue","boolValue","structValue","listValue"]}},fields:{nullValue:{type:"NullValue",id:1},numberValue:{type:"double",id:2},stringValue:{type:"string",id:3},boolValue:{type:"bool",id:4},structValue:{type:"Struct",id:5},listValue:{type:"ListValue",id:6}}},NullValue:{values:{NULL_VALUE:0}},ListValue:{fields:{values:{rule:"repeated",type:"Value",id:1}}}});r("wrappers",{DoubleValue:{fields:{value:{type:"double",id:1}}},FloatValue:{fields:{value:{type:"float",id:1}}},Int64Value:{fields:{value:{type:"int64",id:1}}},UInt64Value:{fields:{value:{type:"uint64",id:1}}},Int32Value:{fields:{value:{type:"int32",id:1}}},UInt32Value:{fields:{value:{type:"uint32",id:1}}},BoolValue:{fields:{value:{type:"bool",id:1}}},StringValue:{fields:{value:{type:"string",id:1}}},BytesValue:{fields:{value:{type:"bytes",id:1}}}});r("field_mask",{FieldMask:{fields:{paths:{rule:"repeated",type:"string",id:1}}}});r.get=function e(t){return r[t]||null}},{}],12:[function(e,t,n){"use strict";var i=n;var r=e(15),s=e(37);function o(e,t,n,i){if(t.resolvedType){if(t.resolvedType instanceof r){e("switch(d%s){",i);for(var s=t.resolvedType.values,o=Object.keys(s),a=0;a<o.length;++a){if(t.repeated&&s[o[a]]===t.typeDefault)e("default:");e("case%j:",o[a])("case %i:",s[o[a]])("m%s=%j",i,s[o[a]])("break")}e("}")}else e('if(typeof d%s!=="object")',i)("throw TypeError(%j)",t.fullName+": object expected")("m%s=types[%i].fromObject(d%s)",i,n,i)}else{var l=false;switch(t.type){case"double":case"float":e("m%s=Number(d%s)",i,i);break;case"uint32":case"fixed32":e("m%s=d%s>>>0",i,i);break;case"int32":case"sint32":case"sfixed32":e("m%s=d%s|0",i,i);break;case"uint64":l=true;case"int64":case"sint64":case"fixed64":case"sfixed64":e("if(util.Long)")("(m%s=util.Long.fromValue(d%s)).unsigned=%j",i,i,l)('else if(typeof d%s==="string")',i)("m%s=parseInt(d%s,10)",i,i)('else if(typeof d%s==="number")',i)("m%s=d%s",i,i)('else if(typeof d%s==="object")',i)("m%s=new util.LongBits(d%s.low>>>0,d%s.high>>>0).toNumber(%s)",i,i,i,l?"true":"");break;case"bytes":e('if(typeof d%s==="string")',i)("util.base64.decode(d%s,m%s=util.newBuffer(util.base64.length(d%s)),0)",i,i,i)("else if(d%s.length)",i)("m%s=d%s",i,i);break;case"string":e("m%s=String(d%s)",i,i);break;case"bool":e("m%s=Boolean(d%s)",i,i);break}}return e}i.fromObject=function e(t){var n=t.fieldsArray;var i=s.codegen(["d"],t.name+"$fromObject")("if(d instanceof this.ctor)")("return d");if(!n.length)return i("return new this.ctor");i("var m=new this.ctor");for(var a=0;a<n.length;++a){var l=n[a].resolve(),u=s.safeProp(l.name);if(l.map){i("if(d%s){",u)('if(typeof d%s!=="object")',u)("throw TypeError(%j)",l.fullName+": object expected")("m%s={}",u)("for(var ks=Object.keys(d%s),i=0;i<ks.length;++i){",u);o(i,l,a,u+"[ks[i]]")("}")("}")}else if(l.repeated){i("if(d%s){",u)("if(!Array.isArray(d%s))",u)("throw TypeError(%j)",l.fullName+": array expected")("m%s=[]",u)("for(var i=0;i<d%s.length;++i){",u);o(i,l,a,u+"[i]")("}")("}")}else{if(!(l.resolvedType instanceof r))i("if(d%s!=null){",u);o(i,l,a,u);if(!(l.resolvedType instanceof r))i("}")}}return i("return m")};function a(e,t,n,i){if(t.resolvedType){if(t.resolvedType instanceof r)e("d%s=o.enums===String?types[%i].values[m%s]:m%s",i,n,i,i);else e("d%s=types[%i].toObject(m%s,o)",i,n,i)}else{var s=false;switch(t.type){case"double":case"float":e("d%s=o.json&&!isFinite(m%s)?String(m%s):m%s",i,i,i,i);break;case"uint64":s=true;case"int64":case"sint64":case"fixed64":case"sfixed64":e('if(typeof m%s==="number")',i)("d%s=o.longs===String?String(m%s):m%s",i,i,i)("else")("d%s=o.longs===String?util.Long.prototype.toString.call(m%s):o.longs===Number?new util.LongBits(m%s.low>>>0,m%s.high>>>0).toNumber(%s):m%s",i,i,i,i,s?"true":"",i);break;case"bytes":e("d%s=o.bytes===String?util.base64.encode(m%s,0,m%s.length):o.bytes===Array?Array.prototype.slice.call(m%s):m%s",i,i,i,i,i);break;default:e("d%s=m%s",i,i);break}}return e}i.toObject=function e(t){var n=t.fieldsArray.slice().sort(s.compareFieldsById);if(!n.length)return s.codegen()("return {}");var i=s.codegen(["m","o"],t.name+"$toObject")("if(!o)")("o={}")("var d={}");var o=[],l=[],u=[],c=0;for(;c<n.length;++c)if(!n[c].partOf)(n[c].resolve().repeated?o:n[c].map?l:u).push(n[c]);if(o.length){i("if(o.arrays||o.defaults){");for(c=0;c<o.length;++c)i("d%s=[]",s.safeProp(o[c].name));i("}")}if(l.length){i("if(o.objects||o.defaults){");for(c=0;c<l.length;++c)i("d%s={}",s.safeProp(l[c].name));i("}")}if(u.length){i("if(o.defaults){");for(c=0;c<u.length;++c){var f=u[c],d=s.safeProp(f.name);if(f.resolvedType instanceof r)i("d%s=o.enums===String?%j:%j",d,f.resolvedType.valuesById[f.typeDefault],f.typeDefault);else if(f.long)i("if(util.Long){")("var n=new util.Long(%i,%i,%j)",f.typeDefault.low,f.typeDefault.high,f.typeDefault.unsigned)("d%s=o.longs===String?n.toString():o.longs===Number?n.toNumber():n",d)("}else")("d%s=o.longs===String?%j:%i",d,f.typeDefault.toString(),f.typeDefault.toNumber());else if(f.bytes)i("d%s=o.bytes===String?%j:%s",d,String.fromCharCode.apply(String,f.typeDefault),"["+Array.prototype.slice.call(f.typeDefault).join(",")+"]");else i("d%s=%j",d,f.typeDefault)}i("}")}var h=false;for(c=0;c<n.length;++c){var f=n[c],p=t._fieldsArray.indexOf(f),d=s.safeProp(f.name);if(f.map){if(!h){h=true;i("var ks2")}i("if(m%s&&(ks2=Object.keys(m%s)).length){",d,d)("d%s={}",d)("for(var j=0;j<ks2.length;++j){");a(i,f,p,d+"[ks2[j]]")("}")}else if(f.repeated){i("if(m%s&&m%s.length){",d,d)("d%s=[]",d)("for(var j=0;j<m%s.length;++j){",d);a(i,f,p,d+"[j]")("}")}else{i("if(m%s!=null&&m.hasOwnProperty(%j)){",d,f.name);a(i,f,p,d);if(f.partOf)i("if(o.oneofs)")("d%s=%j",s.safeProp(f.partOf.name),f.name)}i("}")}return i("return d")}},{15:15,37:37}],13:[function(e,t,n){"use strict";t.exports=a;var i=e(15),r=e(36),s=e(37);function o(e){return"missing required '"+e.name+"'"}function a(e){var t=s.codegen(["r","l"],e.name+"$decode")("if(!(r instanceof Reader))")("r=Reader.create(r)")("var c=l===undefined?r.len:r.pos+l,m=new this.ctor"+(e.fieldsArray.filter((function(e){return e.map})).length?",k":""))("while(r.pos<c){")("var t=r.uint32()");if(e.group)t("if((t&7)===4)")("break");t("switch(t>>>3){");var n=0;for(;n<e.fieldsArray.length;++n){var a=e._fieldsArray[n].resolve(),l=a.resolvedType instanceof i?"int32":a.type,u="m"+s.safeProp(a.name);t("case %i:",a.id);if(a.map){t("r.skip().pos++")("if(%s===util.emptyObject)",u)("%s={}",u)("k=r.%s()",a.keyType)("r.pos++");if(r.long[a.keyType]!==undefined){if(r.basic[l]===undefined)t('%s[typeof k==="object"?util.longToHash(k):k]=types[%i].decode(r,r.uint32())',u,n);else t('%s[typeof k==="object"?util.longToHash(k):k]=r.%s()',u,l)}else{if(r.basic[l]===undefined)t("%s[k]=types[%i].decode(r,r.uint32())",u,n);else t("%s[k]=r.%s()",u,l)}}else if(a.repeated){t("if(!(%s&&%s.length))",u,u)("%s=[]",u);if(r.packed[l]!==undefined)t("if((t&7)===2){")("var c2=r.uint32()+r.pos")("while(r.pos<c2)")("%s.push(r.%s())",u,l)("}else");if(r.basic[l]===undefined)t(a.resolvedType.group?"%s.push(types[%i].decode(r))":"%s.push(types[%i].decode(r,r.uint32()))",u,n);else t("%s.push(r.%s())",u,l)}else if(r.basic[l]===undefined)t(a.resolvedType.group?"%s=types[%i].decode(r)":"%s=types[%i].decode(r,r.uint32())",u,n);else t("%s=r.%s()",u,l);t("break")}t("default:")("r.skipType(t&7)")("break")("}")("}");for(n=0;n<e._fieldsArray.length;++n){var c=e._fieldsArray[n];if(c.required)t("if(!m.hasOwnProperty(%j))",c.name)("throw util.ProtocolError(%j,{instance:m})",o(c))}return t("return m")}},{15:15,36:36,37:37}],14:[function(e,t,n){"use strict";t.exports=a;var i=e(15),r=e(36),s=e(37);function o(e,t,n,i){return t.resolvedType.group?e("types[%i].encode(%s,w.uint32(%i)).uint32(%i)",n,i,(t.id<<3|3)>>>0,(t.id<<3|4)>>>0):e("types[%i].encode(%s,w.uint32(%i).fork()).ldelim()",n,i,(t.id<<3|2)>>>0)}function a(e){var t=s.codegen(["m","w"],e.name+"$encode")("if(!w)")("w=Writer.create()");var n,a;var l=e.fieldsArray.slice().sort(s.compareFieldsById);for(var n=0;n<l.length;++n){var u=l[n].resolve(),c=e._fieldsArray.indexOf(u),f=u.resolvedType instanceof i?"int32":u.type,d=r.basic[f];a="m"+s.safeProp(u.name);if(u.map){t("if(%s!=null&&m.hasOwnProperty(%j)){",a,u.name)("for(var ks=Object.keys(%s),i=0;i<ks.length;++i){",a)("w.uint32(%i).fork().uint32(%i).%s(ks[i])",(u.id<<3|2)>>>0,8|r.mapKey[u.keyType],u.keyType);if(d===undefined)t("types[%i].encode(%s[ks[i]],w.uint32(18).fork()).ldelim().ldelim()",c,a);else t(".uint32(%i).%s(%s[ks[i]]).ldelim()",16|d,f,a);t("}")("}")}else if(u.repeated){t("if(%s!=null&&%s.length){",a,a);if(u.packed&&r.packed[f]!==undefined){t("w.uint32(%i).fork()",(u.id<<3|2)>>>0)("for(var i=0;i<%s.length;++i)",a)("w.%s(%s[i])",f,a)("w.ldelim()")}else{t("for(var i=0;i<%s.length;++i)",a);if(d===undefined)o(t,u,c,a+"[i]");else t("w.uint32(%i).%s(%s[i])",(u.id<<3|d)>>>0,f,a)}t("}")}else{if(u.optional)t("if(%s!=null&&m.hasOwnProperty(%j))",a,u.name);if(d===undefined)o(t,u,c,a);else t("w.uint32(%i).%s(%s)",(u.id<<3|d)>>>0,f,a)}}return t("return w")}},{15:15,36:36,37:37}],15:[function(e,t,n){"use strict";t.exports=o;var i=e(24);((o.prototype=Object.create(i.prototype)).constructor=o).className="Enum";var r=e(23),s=e(37);function o(e,t,n,r,s){i.call(this,e,n);if(t&&typeof t!=="object")throw TypeError("values must be an object");this.valuesById={};this.values=Object.create(this.valuesById);this.comment=r;this.comments=s||{};this.reserved=undefined;if(t)for(var o=Object.keys(t),a=0;a<o.length;++a)if(typeof t[o[a]]==="number")this.valuesById[this.values[o[a]]=t[o[a]]]=o[a]}o.fromJSON=function e(t,n){var i=new o(t,n.values,n.options,n.comment,n.comments);i.reserved=n.reserved;return i};o.prototype.toJSON=function e(t){var n=t?Boolean(t.keepComments):false;return s.toObject(["options",this.options,"values",this.values,"reserved",this.reserved&&this.reserved.length?this.reserved:undefined,"comment",n?this.comment:undefined,"comments",n?this.comments:undefined])};o.prototype.add=function e(t,n,i){if(!s.isString(t))throw TypeError("name must be a string");if(!s.isInteger(n))throw TypeError("id must be an integer");if(this.values[t]!==undefined)throw Error("duplicate name '"+t+"' in "+this);if(this.isReservedId(n))throw Error("id "+n+" is reserved in "+this);if(this.isReservedName(t))throw Error("name '"+t+"' is reserved in "+this);if(this.valuesById[n]!==undefined){if(!(this.options&&this.options.allow_alias))throw Error("duplicate id "+n+" in "+this);this.values[t]=n}else this.valuesById[this.values[t]=n]=t;this.comments[t]=i||null;return this};o.prototype.remove=function e(t){if(!s.isString(t))throw TypeError("name must be a string");var n=this.values[t];if(n==null)throw Error("name '"+t+"' does not exist in "+this);delete this.valuesById[n];delete this.values[t];delete this.comments[t];return this};o.prototype.isReservedId=function e(t){return r.isReservedId(this.reserved,t)};o.prototype.isReservedName=function e(t){return r.isReservedName(this.reserved,t)}},{23:23,24:24,37:37}],16:[function(e,t,n){"use strict";t.exports=u;var i=e(24);((u.prototype=Object.create(i.prototype)).constructor=u).className="Field";var r=e(15),s=e(36),o=e(37);var a;var l=/^required|optional|repeated$/;u.fromJSON=function e(t,n){return new u(t,n.id,n.type,n.rule,n.extend,n.options,n.comment)};function u(e,t,n,r,a,u,c){if(o.isObject(r)){c=a;u=r;r=a=undefined}else if(o.isObject(a)){c=u;u=a;a=undefined}i.call(this,e,u);if(!o.isInteger(t)||t<0)throw TypeError("id must be a non-negative integer");if(!o.isString(n))throw TypeError("type must be a string");if(r!==undefined&&!l.test(r=r.toString().toLowerCase()))throw TypeError("rule must be a string rule");if(a!==undefined&&!o.isString(a))throw TypeError("extend must be a string");this.rule=r&&r!=="optional"?r:undefined;this.type=n;this.id=t;this.extend=a||undefined;this.required=r==="required";this.optional=!this.required;this.repeated=r==="repeated";this.map=false;this.message=null;this.partOf=null;this.typeDefault=null;this.defaultValue=null;this.long=o.Long?s.long[n]!==undefined:false;this.bytes=n==="bytes";this.resolvedType=null;this.extensionField=null;this.declaringField=null;this._packed=null;this.comment=c}Object.defineProperty(u.prototype,"packed",{get:function(){if(this._packed===null)this._packed=this.getOption("packed")!==false;return this._packed}});u.prototype.setOption=function e(t,n,r){if(t==="packed")this._packed=null;return i.prototype.setOption.call(this,t,n,r)};u.prototype.toJSON=function e(t){var n=t?Boolean(t.keepComments):false;return o.toObject(["rule",this.rule!=="optional"&&this.rule||undefined,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",n?this.comment:undefined])};u.prototype.resolve=function e(){if(this.resolved)return this;if((this.typeDefault=s.defaults[this.type])===undefined){this.resolvedType=(this.declaringField?this.declaringField.parent:this.parent).lookupTypeOrEnum(this.type);if(this.resolvedType instanceof a)this.typeDefault=null;else this.typeDefault=this.resolvedType.values[Object.keys(this.resolvedType.values)[0]]}if(this.options&&this.options["default"]!=null){this.typeDefault=this.options["default"];if(this.resolvedType instanceof r&&typeof this.typeDefault==="string")this.typeDefault=this.resolvedType.values[this.typeDefault]}if(this.options){if(this.options.packed===true||this.options.packed!==undefined&&this.resolvedType&&!(this.resolvedType instanceof r))delete this.options.packed;if(!Object.keys(this.options).length)this.options=undefined}if(this.long){this.typeDefault=o.Long.fromNumber(this.typeDefault,this.type.charAt(0)==="u");if(Object.freeze)Object.freeze(this.typeDefault)}else if(this.bytes&&typeof this.typeDefault==="string"){var t;if(o.base64.test(this.typeDefault))o.base64.decode(this.typeDefault,t=o.newBuffer(o.base64.length(this.typeDefault)),0);else o.utf8.write(this.typeDefault,t=o.newBuffer(o.utf8.length(this.typeDefault)),0);this.typeDefault=t}if(this.map)this.defaultValue=o.emptyObject;else if(this.repeated)this.defaultValue=o.emptyArray;else this.defaultValue=this.typeDefault;if(this.parent instanceof a)this.parent.ctor.prototype[this.name]=this.defaultValue;return i.prototype.resolve.call(this)};u.d=function e(t,n,i,r){if(typeof n==="function")n=o.decorateType(n).name;else if(n&&typeof n==="object")n=o.decorateEnum(n).name;return function e(s,a){o.decorateType(s.constructor).add(new u(a,t,n,i,{default:r}))}};u._configure=function e(t){a=t}},{15:15,24:24,36:36,37:37}],17:[function(e,t,n){"use strict";var i=t.exports=e(18);i.build="light";function r(e,t,n){if(typeof t==="function"){n=t;t=new i.Root}else if(!t)t=new i.Root;return t.load(e,n)}i.load=r;function s(e,t){if(!t)t=new i.Root;return t.loadSync(e)}i.loadSync=s;i.encoder=e(14);i.decoder=e(13);i.verifier=e(40);i.converter=e(12);i.ReflectionObject=e(24);i.Namespace=e(23);i.Root=e(29);i.Enum=e(15);i.Type=e(35);i.Field=e(16);i.OneOf=e(25);i.MapField=e(20);i.Service=e(33);i.Method=e(22);i.Message=e(21);i.wrappers=e(41);i.types=e(36);i.util=e(37);i.ReflectionObject._configure(i.Root);i.Namespace._configure(i.Type,i.Service);i.Root._configure(i.Type);i.Field._configure(i.Type)},{12:12,13:13,14:14,15:15,16:16,18:18,20:20,21:21,22:22,23:23,24:24,25:25,29:29,33:33,35:35,36:36,37:37,40:40,41:41}],18:[function(e,t,n){"use strict";var i=n;i.build="minimal";i.Writer=e(42);i.BufferWriter=e(43);i.Reader=e(27);i.BufferReader=e(28);i.util=e(39);i.rpc=e(31);i.roots=e(30);i.configure=r;function r(){i.Reader._configure(i.BufferReader);i.util._configure()}i.Writer._configure(i.BufferWriter);r()},{27:27,28:28,30:30,31:31,39:39,42:42,43:43}],19:[function(e,t,n){"use strict";var i=t.exports=e(17);i.build="full";i.tokenize=e(34);i.parse=e(26);i.common=e(11);i.Root._configure(i.Type,i.parse,i.common)},{11:11,17:17,26:26,34:34}],20:[function(e,t,n){"use strict";t.exports=o;var i=e(16);((o.prototype=Object.create(i.prototype)).constructor=o).className="MapField";var r=e(36),s=e(37);function o(e,t,n,r,o,a){i.call(this,e,t,r,undefined,undefined,o,a);if(!s.isString(n))throw TypeError("keyType must be a string");this.keyType=n;this.resolvedKeyType=null;this.map=true}o.fromJSON=function e(t,n){return new o(t,n.id,n.keyType,n.type,n.options,n.comment)};o.prototype.toJSON=function e(t){var n=t?Boolean(t.keepComments):false;return s.toObject(["keyType",this.keyType,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",n?this.comment:undefined])};o.prototype.resolve=function e(){if(this.resolved)return this;if(r.mapKey[this.keyType]===undefined)throw Error("invalid key type: "+this.keyType);return i.prototype.resolve.call(this)};o.d=function e(t,n,i){if(typeof i==="function")i=s.decorateType(i).name;else if(i&&typeof i==="object")i=s.decorateEnum(i).name;return function e(r,a){s.decorateType(r.constructor).add(new o(a,t,n,i))}}},{16:16,36:36,37:37}],21:[function(e,t,n){"use strict";t.exports=r;var i=e(39);function r(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)this[t[n]]=e[t[n]]}r.create=function e(t){return this.$type.create(t)};r.encode=function e(t,n){return this.$type.encode(t,n)};r.encodeDelimited=function e(t,n){return this.$type.encodeDelimited(t,n)};r.decode=function e(t){return this.$type.decode(t)};r.decodeDelimited=function e(t){return this.$type.decodeDelimited(t)};r.verify=function e(t){return this.$type.verify(t)};r.fromObject=function e(t){return this.$type.fromObject(t)};r.toObject=function e(t,n){return this.$type.toObject(t,n)};r.prototype.toJSON=function e(){return this.$type.toObject(this,i.toJSONOptions)}},{39:39}],22:[function(e,t,n){"use strict";t.exports=s;var i=e(24);((s.prototype=Object.create(i.prototype)).constructor=s).className="Method";var r=e(37);function s(e,t,n,s,o,a,l,u){if(r.isObject(o)){l=o;o=a=undefined}else if(r.isObject(a)){l=a;a=undefined}if(!(t===undefined||r.isString(t)))throw TypeError("type must be a string");if(!r.isString(n))throw TypeError("requestType must be a string");if(!r.isString(s))throw TypeError("responseType must be a string");i.call(this,e,l);this.type=t||"rpc";this.requestType=n;this.requestStream=o?true:undefined;this.responseType=s;this.responseStream=a?true:undefined;this.resolvedRequestType=null;this.resolvedResponseType=null;this.comment=u}s.fromJSON=function e(t,n){return new s(t,n.type,n.requestType,n.responseType,n.requestStream,n.responseStream,n.options,n.comment)};s.prototype.toJSON=function e(t){var n=t?Boolean(t.keepComments):false;return r.toObject(["type",this.type!=="rpc"&&this.type||undefined,"requestType",this.requestType,"requestStream",this.requestStream,"responseType",this.responseType,"responseStream",this.responseStream,"options",this.options,"comment",n?this.comment:undefined])};s.prototype.resolve=function e(){if(this.resolved)return this;this.resolvedRequestType=this.parent.lookupType(this.requestType);this.resolvedResponseType=this.parent.lookupType(this.responseType);return i.prototype.resolve.call(this)}},{24:24,37:37}],23:[function(e,t,n){"use strict";t.exports=c;var i=e(24);((c.prototype=Object.create(i.prototype)).constructor=c).className="Namespace";var r=e(15),s=e(16),o=e(37);var a,l;c.fromJSON=function e(t,n){return new c(t,n.options).addJSON(n.nested)};function u(e,t){if(!(e&&e.length))return undefined;var n={};for(var i=0;i<e.length;++i)n[e[i].name]=e[i].toJSON(t);return n}c.arrayToJSON=u;c.isReservedId=function e(t,n){if(t)for(var i=0;i<t.length;++i)if(typeof t[i]!=="string"&&t[i][0]<=n&&t[i][1]>=n)return true;return false};c.isReservedName=function e(t,n){if(t)for(var i=0;i<t.length;++i)if(t[i]===n)return true;return false};function c(e,t){i.call(this,e,t);this.nested=undefined;this._nestedArray=null}function f(e){e._nestedArray=null;return e}Object.defineProperty(c.prototype,"nestedArray",{get:function(){return this._nestedArray||(this._nestedArray=o.toArray(this.nested))}});c.prototype.toJSON=function e(t){return o.toObject(["options",this.options,"nested",u(this.nestedArray,t)])};c.prototype.addJSON=function e(t){var n=this;if(t){for(var i=Object.keys(t),o=0,u;o<i.length;++o){u=t[i[o]];n.add((u.fields!==undefined?a.fromJSON:u.values!==undefined?r.fromJSON:u.methods!==undefined?l.fromJSON:u.id!==undefined?s.fromJSON:c.fromJSON)(i[o],u))}}return this};c.prototype.get=function e(t){return this.nested&&this.nested[t]||null};c.prototype.getEnum=function e(t){if(this.nested&&this.nested[t]instanceof r)return this.nested[t].values;throw Error("no such enum: "+t)};c.prototype.add=function e(t){if(!(t instanceof s&&t.extend!==undefined||t instanceof a||t instanceof r||t instanceof l||t instanceof c))throw TypeError("object must be a valid nested object");if(!this.nested)this.nested={};else{var n=this.get(t.name);if(n){if(n instanceof c&&t instanceof c&&!(n instanceof a||n instanceof l)){var i=n.nestedArray;for(var o=0;o<i.length;++o)t.add(i[o]);this.remove(n);if(!this.nested)this.nested={};t.setOptions(n.options,true)}else throw Error("duplicate name '"+t.name+"' in "+this)}}this.nested[t.name]=t;t.onAdd(this);return f(this)};c.prototype.remove=function e(t){if(!(t instanceof i))throw TypeError("object must be a ReflectionObject");if(t.parent!==this)throw Error(t+" is not a member of "+this);delete this.nested[t.name];if(!Object.keys(this.nested).length)this.nested=undefined;t.onRemove(this);return f(this)};c.prototype.define=function e(t,n){if(o.isString(t))t=t.split(".");else if(!Array.isArray(t))throw TypeError("illegal path");if(t&&t.length&&t[0]==="")throw Error("path must be relative");var i=this;while(t.length>0){var r=t.shift();if(i.nested&&i.nested[r]){i=i.nested[r];if(!(i instanceof c))throw Error("path conflicts with non-namespace objects")}else i.add(i=new c(r))}if(n)i.addJSON(n);return i};c.prototype.resolveAll=function e(){var t=this.nestedArray,n=0;while(n<t.length)if(t[n]instanceof c)t[n++].resolveAll();else t[n++].resolve();return this.resolve()};c.prototype.lookup=function e(t,n,i){if(typeof n==="boolean"){i=n;n=undefined}else if(n&&!Array.isArray(n))n=[n];if(o.isString(t)&&t.length){if(t===".")return this.root;t=t.split(".")}else if(!t.length)return this;if(t[0]==="")return this.root.lookup(t.slice(1),n);var r=this.get(t[0]);if(r){if(t.length===1){if(!n||n.indexOf(r.constructor)>-1)return r}else if(r instanceof c&&(r=r.lookup(t.slice(1),n,true)))return r}else for(var s=0;s<this.nestedArray.length;++s)if(this._nestedArray[s]instanceof c&&(r=this._nestedArray[s].lookup(t,n,true)))return r;if(this.parent===null||i)return null;return this.parent.lookup(t,n)};c.prototype.lookupType=function e(t){var n=this.lookup(t,[a]);if(!n)throw Error("no such type: "+t);return n};c.prototype.lookupEnum=function e(t){var n=this.lookup(t,[r]);if(!n)throw Error("no such Enum '"+t+"' in "+this);return n};c.prototype.lookupTypeOrEnum=function e(t){var n=this.lookup(t,[a,r]);if(!n)throw Error("no such Type or Enum '"+t+"' in "+this);return n};c.prototype.lookupService=function e(t){var n=this.lookup(t,[l]);if(!n)throw Error("no such Service '"+t+"' in "+this);return n};c._configure=function(e,t){a=e;l=t}},{15:15,16:16,24:24,37:37}],24:[function(e,t,n){"use strict";t.exports=s;s.className="ReflectionObject";var i=e(37);var r;function s(e,t){if(!i.isString(e))throw TypeError("name must be a string");if(t&&!i.isObject(t))throw TypeError("options must be an object");this.options=t;this.name=e;this.parent=null;this.resolved=false;this.comment=null;this.filename=null}Object.defineProperties(s.prototype,{root:{get:function(){var e=this;while(e.parent!==null)e=e.parent;return e}},fullName:{get:function(){var e=[this.name],t=this.parent;while(t){e.unshift(t.name);t=t.parent}return e.join(".")}}});s.prototype.toJSON=function e(){throw Error()};s.prototype.onAdd=function e(t){if(this.parent&&this.parent!==t)this.parent.remove(this);this.parent=t;this.resolved=false;var n=t.root;if(n instanceof r)n._handleAdd(this)};s.prototype.onRemove=function e(t){var n=t.root;if(n instanceof r)n._handleRemove(this);this.parent=null;this.resolved=false};s.prototype.resolve=function e(){if(this.resolved)return this;if(this.root instanceof r)this.resolved=true;return this};s.prototype.getOption=function e(t){if(this.options)return this.options[t];return undefined};s.prototype.setOption=function e(t,n,i){if(!i||!this.options||this.options[t]===undefined)(this.options||(this.options={}))[t]=n;return this};s.prototype.setOptions=function e(t,n){if(t)for(var i=Object.keys(t),r=0;r<i.length;++r)this.setOption(i[r],t[i[r]],n);return this};s.prototype.toString=function e(){var t=this.constructor.className,n=this.fullName;if(n.length)return t+" "+n;return t};s._configure=function(e){r=e}},{37:37}],25:[function(e,t,n){"use strict";t.exports=o;var i=e(24);((o.prototype=Object.create(i.prototype)).constructor=o).className="OneOf";var r=e(16),s=e(37);function o(e,t,n,r){if(!Array.isArray(t)){n=t;t=undefined}i.call(this,e,n);if(!(t===undefined||Array.isArray(t)))throw TypeError("fieldNames must be an Array");this.oneof=t||[];this.fieldsArray=[];this.comment=r}o.fromJSON=function e(t,n){return new o(t,n.oneof,n.options,n.comment)};o.prototype.toJSON=function e(t){var n=t?Boolean(t.keepComments):false;return s.toObject(["options",this.options,"oneof",this.oneof,"comment",n?this.comment:undefined])};function a(e){if(e.parent)for(var t=0;t<e.fieldsArray.length;++t)if(!e.fieldsArray[t].parent)e.parent.add(e.fieldsArray[t])}o.prototype.add=function e(t){if(!(t instanceof r))throw TypeError("field must be a Field");if(t.parent&&t.parent!==this.parent)t.parent.remove(t);this.oneof.push(t.name);this.fieldsArray.push(t);t.partOf=this;a(this);return this};o.prototype.remove=function e(t){if(!(t instanceof r))throw TypeError("field must be a Field");var n=this.fieldsArray.indexOf(t);if(n<0)throw Error(t+" is not a member of "+this);this.fieldsArray.splice(n,1);n=this.oneof.indexOf(t.name);if(n>-1)this.oneof.splice(n,1);t.partOf=null;return this};o.prototype.onAdd=function e(t){i.prototype.onAdd.call(this,t);var n=this;for(var r=0;r<this.oneof.length;++r){var s=t.get(this.oneof[r]);if(s&&!s.partOf){s.partOf=n;n.fieldsArray.push(s)}}a(this)};o.prototype.onRemove=function e(t){for(var n=0,r;n<this.fieldsArray.length;++n)if((r=this.fieldsArray[n]).parent)r.parent.remove(r);i.prototype.onRemove.call(this,t)};o.d=function e(){var t=new Array(arguments.length),n=0;while(n<arguments.length)t[n]=arguments[n++];return function e(n,i){s.decorateType(n.constructor).add(new o(i,t));Object.defineProperty(n,i,{get:s.oneOfGetter(t),set:s.oneOfSetter(t)})}}},{16:16,24:24,37:37}],26:[function(e,t,n){"use strict";t.exports=C;C.filename=null;C.defaults={keepCase:false};var i=e(34),r=e(29),s=e(35),o=e(16),a=e(20),l=e(25),u=e(15),c=e(33),f=e(22),d=e(36),h=e(37);var p=/^[1-9][0-9]*$/,m=/^-?[1-9][0-9]*$/,g=/^0[x][0-9a-fA-F]+$/,v=/^-?0[x][0-9a-fA-F]+$/,y=/^0[0-7]+$/,b=/^-?0[0-7]+$/,w=/^(?![eE])[0-9]*(?:\.[0-9]*)?(?:[eE][+-]?[0-9]+)?$/,S=/^[a-zA-Z_][a-zA-Z_0-9]*$/,I=/^(?:\.?[a-zA-Z_][a-zA-Z_0-9]*)(?:\.[a-zA-Z_][a-zA-Z_0-9]*)*$/,k=/^(?:\.[a-zA-Z_][a-zA-Z_0-9]*)+$/;function C(e,t,n){if(!(t instanceof r)){n=t;t=new r}if(!n)n=C.defaults;var E=i(e,n.alternateCommentMode||false),_=E.next,x=E.push,T=E.peek,O=E.skip,M=E.cmnt;var D=true,A,P,L,R,H=false;var j=t;var N=n.keepCase?function(e){return e}:h.camelCase;function B(e,t,n){var i=C.filename;if(!n)C.filename=null;return Error("illegal "+(t||"token")+" '"+e+"' ("+(i?i+", ":"")+"line "+E.line+")")}function F(){var e=[],t;do{if((t=_())!=='"'&&t!=="'")throw B(t);e.push(_());O(t);t=T()}while(t==='"'||t==="'");return e.join("")}function U(e){var t=_();switch(t){case"'":case'"':x(t);return F();case"true":case"TRUE":return true;case"false":case"FALSE":return false}try{return $(t,true)}catch(n){if(e&&I.test(t))return t;throw B(t,"value")}}function W(e,t){var n,i;do{if(t&&((n=T())==='"'||n==="'"))e.push(F());else e.push([i=V(_()),O("to",true)?V(_()):i])}while(O(",",true));O(";")}function $(e,t){var n=1;if(e.charAt(0)==="-"){n=-1;e=e.substring(1)}switch(e){case"inf":case"INF":case"Inf":return n*Infinity;case"nan":case"NAN":case"Nan":case"NaN":return NaN;case"0":return 0}if(p.test(e))return n*parseInt(e,10);if(g.test(e))return n*parseInt(e,16);if(y.test(e))return n*parseInt(e,8);if(w.test(e))return n*parseFloat(e);throw B(e,"number",t)}function V(e,t){switch(e){case"max":case"MAX":case"Max":return 536870911;case"0":return 0}if(!t&&e.charAt(0)==="-")throw B(e,"id");if(m.test(e))return parseInt(e,10);if(v.test(e))return parseInt(e,16);if(b.test(e))return parseInt(e,8);throw B(e,"id")}function G(){if(A!==undefined)throw B("package");A=_();if(!I.test(A))throw B(A,"name");j=j.define(A);O(";")}function z(){var e=T();var t;switch(e){case"weak":t=L||(L=[]);_();break;case"public":_();default:t=P||(P=[]);break}e=F();O(";");t.push(e)}function X(){O("=");R=F();H=R==="proto3";if(!H&&R!=="proto2")throw B(R,"syntax");O(";")}function q(e,t){switch(t){case"option":ie(e,t);O(";");return true;case"message":Y(e,t);return true;case"enum":te(e,t);return true;case"service":ae(e,t);return true;case"extend":ue(e,t);return true}return false}function K(e,t,n){var i=E.line;if(e){e.comment=M();e.filename=C.filename}if(O("{",true)){var r;while((r=_())!=="}")t(r);O(";",true)}else{if(n)n();O(";");if(e&&typeof e.comment!=="string")e.comment=M(i)}}function Y(e,t){if(!S.test(t=_()))throw B(t,"type name");var n=new s(t);K(n,(function e(t){if(q(n,t))return;switch(t){case"map":Z(n,t);break;case"required":case"optional":case"repeated":J(n,t);break;case"oneof":ee(n,t);break;case"extensions":W(n.extensions||(n.extensions=[]));break;case"reserved":W(n.reserved||(n.reserved=[]),true);break;default:if(!H||!I.test(t))throw B(t);x(t);J(n,"optional");break}}));e.add(n)}function J(e,t,n){var i=_();if(i==="group"){Q(e,t);return}if(!I.test(i))throw B(i,"type");var r=_();if(!S.test(r))throw B(r,"name");r=N(r);O("=");var s=new o(r,V(_()),i,t,n);K(s,(function e(t){if(t==="option"){ie(s,t);O(";")}else throw B(t)}),(function e(){oe(s)}));e.add(s);if(!H&&s.repeated&&(d.packed[i]!==undefined||d.basic[i]===undefined))s.setOption("packed",false,true)}function Q(e,t){var n=_();if(!S.test(n))throw B(n,"name");var i=h.lcFirst(n);if(n===i)n=h.ucFirst(n);O("=");var r=V(_());var a=new s(n);a.group=true;var l=new o(i,r,n,t);l.filename=C.filename;K(a,(function e(t){switch(t){case"option":ie(a,t);O(";");break;case"required":case"optional":case"repeated":J(a,t);break;default:throw B(t)}}));e.add(a).add(l)}function Z(e){O("<");var t=_();if(d.mapKey[t]===undefined)throw B(t,"type");O(",");var n=_();if(!I.test(n))throw B(n,"type");O(">");var i=_();if(!S.test(i))throw B(i,"name");O("=");var r=new a(N(i),V(_()),t,n);K(r,(function e(t){if(t==="option"){ie(r,t);O(";")}else throw B(t)}),(function e(){oe(r)}));e.add(r)}function ee(e,t){if(!S.test(t=_()))throw B(t,"name");var n=new l(N(t));K(n,(function e(t){if(t==="option"){ie(n,t);O(";")}else{x(t);J(n,"optional")}}));e.add(n)}function te(e,t){if(!S.test(t=_()))throw B(t,"name");var n=new u(t);K(n,(function e(t){switch(t){case"option":ie(n,t);O(";");break;case"reserved":W(n.reserved||(n.reserved=[]),true);break;default:ne(n,t)}}));e.add(n)}function ne(e,t){if(!S.test(t))throw B(t,"name");O("=");var n=V(_(),true),i={};K(i,(function e(t){if(t==="option"){ie(i,t);O(";")}else throw B(t)}),(function e(){oe(i)}));e.add(t,n,i.comment)}function ie(e,t){var n=O("(",true);if(!I.test(t=_()))throw B(t,"name");var i=t;if(n){O(")");i="("+i+")";t=T();if(k.test(t)){i+=t;_()}}O("=");re(e,i)}function re(e,t){if(O("{",true)){do{if(!S.test(ce=_()))throw B(ce,"name");if(T()==="{")re(e,t+"."+ce);else{O(":");if(T()==="{")re(e,t+"."+ce);else se(e,t+"."+ce,U(true))}}while(!O("}",true))}else se(e,t,U(true))}function se(e,t,n){if(e.setOption)e.setOption(t,n)}function oe(e){if(O("[",true)){do{ie(e,"option")}while(O(",",true));O("]")}return e}function ae(e,t){if(!S.test(t=_()))throw B(t,"service name");var n=new c(t);K(n,(function e(t){if(q(n,t))return;if(t==="rpc")le(n,t);else throw B(t)}));e.add(n)}function le(e,t){var n=t;if(!S.test(t=_()))throw B(t,"name");var i=t,r,s,o,a;O("(");if(O("stream",true))s=true;if(!I.test(t=_()))throw B(t);r=t;O(")");O("returns");O("(");if(O("stream",true))a=true;if(!I.test(t=_()))throw B(t);o=t;O(")");var l=new f(i,n,r,o,s,a);K(l,(function e(t){if(t==="option"){ie(l,t);O(";")}else throw B(t)}));e.add(l)}function ue(e,t){if(!I.test(t=_()))throw B(t,"reference");var n=t;K(null,(function t(i){switch(i){case"required":case"repeated":case"optional":J(e,i,n);break;default:if(!H||!I.test(i))throw B(i);x(i);J(e,"optional",n);break}}))}var ce;while((ce=_())!==null){switch(ce){case"package":if(!D)throw B(ce);G();break;case"import":if(!D)throw B(ce);z();break;case"syntax":if(!D)throw B(ce);X();break;case"option":if(!D)throw B(ce);ie(j,ce);O(";");break;default:if(q(j,ce)){D=false;continue}throw B(ce)}}C.filename=null;return{package:A,imports:P,weakImports:L,syntax:R,root:t}}},{15:15,16:16,20:20,22:22,25:25,29:29,33:33,34:34,35:35,36:36,37:37}],27:[function(e,t,n){"use strict";t.exports=l;var i=e(39);var r;var s=i.LongBits,o=i.utf8;function a(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function l(e){this.buf=e;this.pos=0;this.len=e.length}var u=typeof Uint8Array!=="undefined"?function e(t){if(t instanceof Uint8Array||Array.isArray(t))return new l(t);throw Error("illegal buffer")}:function e(t){if(Array.isArray(t))return new l(t);throw Error("illegal buffer")};l.create=i.Buffer?function e(t){return(l.create=function e(t){return i.Buffer.isBuffer(t)?new r(t):u(t)})(t)}:u;l.prototype._slice=i.Array.prototype.subarray||i.Array.prototype.slice;l.prototype.uint32=function e(){var t=4294967295;return function e(){t=(this.buf[this.pos]&127)>>>0;if(this.buf[this.pos++]<128)return t;t=(t|(this.buf[this.pos]&127)<<7)>>>0;if(this.buf[this.pos++]<128)return t;t=(t|(this.buf[this.pos]&127)<<14)>>>0;if(this.buf[this.pos++]<128)return t;t=(t|(this.buf[this.pos]&127)<<21)>>>0;if(this.buf[this.pos++]<128)return t;t=(t|(this.buf[this.pos]&15)<<28)>>>0;if(this.buf[this.pos++]<128)return t;if((this.pos+=5)>this.len){this.pos=this.len;throw a(this,10)}return t}}();l.prototype.int32=function e(){return this.uint32()|0};l.prototype.sint32=function e(){var t=this.uint32();return t>>>1^-(t&1)|0};function c(){var e=new s(0,0);var t=0;if(this.len-this.pos>4){for(;t<4;++t){e.lo=(e.lo|(this.buf[this.pos]&127)<<t*7)>>>0;if(this.buf[this.pos++]<128)return e}e.lo=(e.lo|(this.buf[this.pos]&127)<<28)>>>0;e.hi=(e.hi|(this.buf[this.pos]&127)>>4)>>>0;if(this.buf[this.pos++]<128)return e;t=0}else{for(;t<3;++t){if(this.pos>=this.len)throw a(this);e.lo=(e.lo|(this.buf[this.pos]&127)<<t*7)>>>0;if(this.buf[this.pos++]<128)return e}e.lo=(e.lo|(this.buf[this.pos++]&127)<<t*7)>>>0;return e}if(this.len-this.pos>4){for(;t<5;++t){e.hi=(e.hi|(this.buf[this.pos]&127)<<t*7+3)>>>0;if(this.buf[this.pos++]<128)return e}}else{for(;t<5;++t){if(this.pos>=this.len)throw a(this);e.hi=(e.hi|(this.buf[this.pos]&127)<<t*7+3)>>>0;if(this.buf[this.pos++]<128)return e}}throw Error("invalid varint encoding")}l.prototype.bool=function e(){return this.uint32()!==0};function f(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}l.prototype.fixed32=function e(){if(this.pos+4>this.len)throw a(this,4);return f(this.buf,this.pos+=4)};l.prototype.sfixed32=function e(){if(this.pos+4>this.len)throw a(this,4);return f(this.buf,this.pos+=4)|0};function d(){if(this.pos+8>this.len)throw a(this,8);return new s(f(this.buf,this.pos+=4),f(this.buf,this.pos+=4))}l.prototype.float=function e(){if(this.pos+4>this.len)throw a(this,4);var t=i.float.readFloatLE(this.buf,this.pos);this.pos+=4;return t};l.prototype.double=function e(){if(this.pos+8>this.len)throw a(this,4);var t=i.float.readDoubleLE(this.buf,this.pos);this.pos+=8;return t};l.prototype.bytes=function e(){var t=this.uint32(),n=this.pos,i=this.pos+t;if(i>this.len)throw a(this,t);this.pos+=t;if(Array.isArray(this.buf))return this.buf.slice(n,i);return n===i?new this.buf.constructor(0):this._slice.call(this.buf,n,i)};l.prototype.string=function e(){var t=this.bytes();return o.read(t,0,t.length)};l.prototype.skip=function e(t){if(typeof t==="number"){if(this.pos+t>this.len)throw a(this,t);this.pos+=t}else{do{if(this.pos>=this.len)throw a(this)}while(this.buf[this.pos++]&128)}return this};l.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:do{if((e=this.uint32()&7)===4)break;this.skipType(e)}while(true);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this};l._configure=function(e){r=e;var t=i.Long?"toLong":"toNumber";i.merge(l.prototype,{int64:function e(){return c.call(this)[t](false)},uint64:function e(){return c.call(this)[t](true)},sint64:function e(){return c.call(this).zzDecode()[t](false)},fixed64:function e(){return d.call(this)[t](true)},sfixed64:function e(){return d.call(this)[t](false)}})}},{39:39}],28:[function(e,t,n){"use strict";t.exports=s;var i=e(27);(s.prototype=Object.create(i.prototype)).constructor=s;var r=e(39);function s(e){i.call(this,e)}if(r.Buffer)s.prototype._slice=r.Buffer.prototype.slice;s.prototype.string=function e(){var t=this.uint32();return this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+t,this.len))}},{27:27,39:39}],29:[function(e,t,n){"use strict";t.exports=f;var i=e(23);((f.prototype=Object.create(i.prototype)).constructor=f).className="Root";var r=e(16),s=e(15),o=e(25),a=e(37);var l,u,c;function f(e){i.call(this,"",e);this.deferred=[];this.files=[]}f.fromJSON=function e(t,n){if(!n)n=new f;if(t.options)n.setOptions(t.options);return n.addJSON(t.nested)};f.prototype.resolvePath=a.path.resolve;function d(){}f.prototype.load=function e(t,n,i){if(typeof n==="function"){i=n;n=undefined}var r=this;if(!i)return a.asPromise(e,r,t,n);var s=i===d;function o(e,t){if(!i)return;var n=i;i=null;if(s)throw e;n(e,t)}function l(e,t){try{if(a.isString(t)&&t.charAt(0)==="{")t=JSON.parse(t);if(!a.isString(t))r.setOptions(t.options).addJSON(t.nested);else{u.filename=e;var i=u(t,r,n),l,c=0;if(i.imports)for(;c<i.imports.length;++c)if(l=r.resolvePath(e,i.imports[c]))f(l);if(i.weakImports)for(c=0;c<i.weakImports.length;++c)if(l=r.resolvePath(e,i.weakImports[c]))f(l,true)}}catch(e){o(e)}if(!s&&!h)o(null,r)}function f(e,t){var n=e.lastIndexOf("google/protobuf/");if(n>-1){var u=e.substring(n);if(u in c)e=u}if(r.files.indexOf(e)>-1)return;r.files.push(e);if(e in c){if(s)l(e,c[e]);else{++h;setTimeout((function(){--h;l(e,c[e])}))}return}if(s){var f;try{f=a.fs.readFileSync(e).toString("utf8")}catch(e){if(!t)o(e);return}l(e,f)}else{++h;a.fetch(e,(function(n,s){--h;if(!i)return;if(n){if(!t)o(n);else if(!h)o(null,r);return}l(e,s)}))}}var h=0;if(a.isString(t))t=[t];for(var p=0,m;p<t.length;++p)if(m=r.resolvePath("",t[p]))f(m);if(s)return r;if(!h)o(null,r);return undefined};f.prototype.loadSync=function e(t,n){if(!a.isNode)throw Error("not supported");return this.load(t,n,d)};f.prototype.resolveAll=function e(){if(this.deferred.length)throw Error("unresolvable extensions: "+this.deferred.map((function(e){return"'extend "+e.extend+"' in "+e.parent.fullName})).join(", "));return i.prototype.resolveAll.call(this)};var h=/^[A-Z]/;function p(e,t){var n=t.parent.lookup(t.extend);if(n){var i=new r(t.fullName,t.id,t.type,t.rule,undefined,t.options);i.declaringField=t;t.extensionField=i;n.add(i);return true}return false}f.prototype._handleAdd=function e(t){if(t instanceof r){if(t.extend!==undefined&&!t.extensionField)if(!p(this,t))this.deferred.push(t)}else if(t instanceof s){if(h.test(t.name))t.parent[t.name]=t.values}else if(!(t instanceof o)){if(t instanceof l)for(var n=0;n<this.deferred.length;)if(p(this,this.deferred[n]))this.deferred.splice(n,1);else++n;for(var i=0;i<t.nestedArray.length;++i)this._handleAdd(t._nestedArray[i]);if(h.test(t.name))t.parent[t.name]=t}};f.prototype._handleRemove=function e(t){if(t instanceof r){if(t.extend!==undefined){if(t.extensionField){t.extensionField.parent.remove(t.extensionField);t.extensionField=null}else{var n=this.deferred.indexOf(t);if(n>-1)this.deferred.splice(n,1)}}}else if(t instanceof s){if(h.test(t.name))delete t.parent[t.name]}else if(t instanceof i){for(var o=0;o<t.nestedArray.length;++o)this._handleRemove(t._nestedArray[o]);if(h.test(t.name))delete t.parent[t.name]}};f._configure=function(e,t,n){l=e;u=t;c=n}},{15:15,16:16,23:23,25:25,37:37}],30:[function(e,t,n){"use strict";t.exports={}},{}],31:[function(e,t,n){"use strict";var i=n;i.Service=e(32)},{32:32}],32:[function(e,t,n){"use strict";t.exports=r;var i=e(39);(r.prototype=Object.create(i.EventEmitter.prototype)).constructor=r;function r(e,t,n){if(typeof e!=="function")throw TypeError("rpcImpl must be a function");i.EventEmitter.call(this);this.rpcImpl=e;this.requestDelimited=Boolean(t);this.responseDelimited=Boolean(n)}r.prototype.rpcCall=function e(t,n,r,s,o){if(!s)throw TypeError("request must be specified");var a=this;if(!o)return i.asPromise(e,a,t,n,r,s);if(!a.rpcImpl){setTimeout((function(){o(Error("already ended"))}),0);return undefined}try{return a.rpcImpl(t,n[a.requestDelimited?"encodeDelimited":"encode"](s).finish(),(function e(n,i){if(n){a.emit("error",n,t);return o(n)}if(i===null){a.end(true);return undefined}if(!(i instanceof r)){try{i=r[a.responseDelimited?"decodeDelimited":"decode"](i)}catch(n){a.emit("error",n,t);return o(n)}}a.emit("data",i,t);return o(null,i)}))}catch(e){a.emit("error",e,t);setTimeout((function(){o(e)}),0);return undefined}};r.prototype.end=function e(t){if(this.rpcImpl){if(!t)this.rpcImpl(null,null,null);this.rpcImpl=null;this.emit("end").off()}return this}},{39:39}],33:[function(e,t,n){"use strict";t.exports=a;var i=e(23);((a.prototype=Object.create(i.prototype)).constructor=a).className="Service";var r=e(22),s=e(37),o=e(31);function a(e,t){i.call(this,e,t);this.methods={};this._methodsArray=null}a.fromJSON=function e(t,n){var i=new a(t,n.options);if(n.methods)for(var s=Object.keys(n.methods),o=0;o<s.length;++o)i.add(r.fromJSON(s[o],n.methods[s[o]]));if(n.nested)i.addJSON(n.nested);i.comment=n.comment;return i};a.prototype.toJSON=function e(t){var n=i.prototype.toJSON.call(this,t);var r=t?Boolean(t.keepComments):false;return s.toObject(["options",n&&n.options||undefined,"methods",i.arrayToJSON(this.methodsArray,t)||{},"nested",n&&n.nested||undefined,"comment",r?this.comment:undefined])};Object.defineProperty(a.prototype,"methodsArray",{get:function(){return this._methodsArray||(this._methodsArray=s.toArray(this.methods))}});function l(e){e._methodsArray=null;return e}a.prototype.get=function e(t){return this.methods[t]||i.prototype.get.call(this,t)};a.prototype.resolveAll=function e(){var t=this.methodsArray;for(var n=0;n<t.length;++n)t[n].resolve();return i.prototype.resolve.call(this)};a.prototype.add=function e(t){if(this.get(t.name))throw Error("duplicate name '"+t.name+"' in "+this);if(t instanceof r){this.methods[t.name]=t;t.parent=this;return l(this)}return i.prototype.add.call(this,t)};a.prototype.remove=function e(t){if(t instanceof r){if(this.methods[t.name]!==t)throw Error(t+" is not a member of "+this);delete this.methods[t.name];t.parent=null;return l(this)}return i.prototype.remove.call(this,t)};a.prototype.create=function e(t,n,i){var r=new o.Service(t,n,i);for(var a=0,l;a<this.methodsArray.length;++a){var u=s.lcFirst((l=this._methodsArray[a]).resolve().name).replace(/[^$\w_]/g,"");r[u]=s.codegen(["r","c"],s.isReserved(u)?u+"_":u)("return this.rpcCall(m,q,s,r,c)")({m:l,q:l.resolvedRequestType.ctor,s:l.resolvedResponseType.ctor})}return r}},{22:22,23:23,31:31,37:37}],34:[function(e,t,n){"use strict";t.exports=h;var i=/[\s{}=;:[\],'"()<>]/g,r=/(?:"([^"\\]*(?:\\.[^"\\]*)*)")/g,s=/(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g;var o=/^ *[*/]+ */,a=/^\s*\*?\/*/,l=/\n/g,u=/\s/,c=/\\(.?)/g;var f={0:"\0",r:"\r",n:"\n",t:"\t"};function d(e){return e.replace(c,(function(e,t){switch(t){case"\\":case"":return t;default:return f[t]||""}}))}h.unescape=d;function h(e,t){e=e.toString();var n=0,c=e.length,f=1,h=null,p=null,m=0,g=false;var v=[];var y=null;function b(e){return Error("illegal "+e+" (line "+f+")")}function w(){var t=y==="'"?s:r;t.lastIndex=n-1;var i=t.exec(e);if(!i)throw b("string");n=t.lastIndex;_(y);y=null;return d(i[1])}function S(t){return e.charAt(t)}function I(n,i){h=e.charAt(n++);m=f;g=false;var r;if(t){r=2}else{r=3}var s=n-r,u;do{if(--s<0||(u=e.charAt(s))==="\n"){g=true;break}}while(u===" "||u==="\t");var c=e.substring(n,i).split(l);for(var d=0;d<c.length;++d)c[d]=c[d].replace(t?a:o,"").trim();p=c.join("\n").trim()}function k(t){var n=C(t);var i=e.substring(t,n);var r=/^\s*\/{1,2}/.test(i);return r}function C(e){var t=e;while(t<c&&S(t)!=="\n"){t++}return t}function E(){if(v.length>0)return v.shift();if(y)return w();var r,s,o,a,l;do{if(n===c)return null;r=false;while(u.test(o=S(n))){if(o==="\n")++f;if(++n===c)return null}if(S(n)==="/"){if(++n===c){throw b("comment")}if(S(n)==="/"){if(!t){l=S(a=n+1)==="/";while(S(++n)!=="\n"){if(n===c){return null}}++n;if(l){I(a,n-1)}++f;r=true}else{a=n;l=false;if(k(n)){l=true;do{n=C(n);if(n===c){break}n++}while(k(n))}else{n=Math.min(c,C(n)+1)}if(l){I(a,n)}f++;r=true}}else if((o=S(n))==="*"){a=n+1;l=t||S(a)==="*";do{if(o==="\n"){++f}if(++n===c){throw b("comment")}s=o;o=S(n)}while(s!=="*"||o!=="/");++n;if(l){I(a,n-2)}r=true}else{return"/"}}}while(r);var d=n;i.lastIndex=0;var h=i.test(S(d++));if(!h)while(d<c&&!i.test(S(d)))++d;var p=e.substring(n,n=d);if(p==='"'||p==="'")y=p;return p}function _(e){v.push(e)}function x(){if(!v.length){var e=E();if(e===null)return null;_(e)}return v[0]}function T(e,t){var n=x(),i=n===e;if(i){E();return true}if(!t)throw b("token '"+n+"', '"+e+"' expected");return false}function O(e){var n=null;if(e===undefined){if(m===f-1&&(t||h==="*"||g)){n=p}}else{if(m<e){x()}if(m===e&&!g&&(t||h==="/")){n=p}}return n}return Object.defineProperty({next:E,peek:x,push:_,skip:T,cmnt:O},"line",{get:function(){return f}})}},{}],35:[function(e,t,n){"use strict";t.exports=y;var i=e(23);((y.prototype=Object.create(i.prototype)).constructor=y).className="Type";var r=e(15),s=e(25),o=e(16),a=e(20),l=e(33),u=e(21),c=e(27),f=e(42),d=e(37),h=e(14),p=e(13),m=e(40),g=e(12),v=e(41);function y(e,t){i.call(this,e,t);this.fields={};this.oneofs=undefined;this.extensions=undefined;this.reserved=undefined;this.group=undefined;this._fieldsById=null;this._fieldsArray=null;this._oneofsArray=null;this._ctor=null}Object.defineProperties(y.prototype,{fieldsById:{get:function(){if(this._fieldsById)return this._fieldsById;this._fieldsById={};for(var e=Object.keys(this.fields),t=0;t<e.length;++t){var n=this.fields[e[t]],i=n.id;if(this._fieldsById[i])throw Error("duplicate id "+i+" in "+this);this._fieldsById[i]=n}return this._fieldsById}},fieldsArray:{get:function(){return this._fieldsArray||(this._fieldsArray=d.toArray(this.fields))}},oneofsArray:{get:function(){return this._oneofsArray||(this._oneofsArray=d.toArray(this.oneofs))}},ctor:{get:function(){return this._ctor||(this.ctor=y.generateConstructor(this)())},set:function(e){var t=e.prototype;if(!(t instanceof u)){(e.prototype=new u).constructor=e;d.merge(e.prototype,t)}e.$type=e.prototype.$type=this;d.merge(e,u,true);this._ctor=e;var n=0;for(;n<this.fieldsArray.length;++n)this._fieldsArray[n].resolve();var i={};for(n=0;n<this.oneofsArray.length;++n)i[this._oneofsArray[n].resolve().name]={get:d.oneOfGetter(this._oneofsArray[n].oneof),set:d.oneOfSetter(this._oneofsArray[n].oneof)};if(n)Object.defineProperties(e.prototype,i)}}});y.generateConstructor=function e(t){var n=d.codegen(["p"],t.name);for(var i=0,r;i<t.fieldsArray.length;++i)if((r=t._fieldsArray[i]).map)n("this%s={}",d.safeProp(r.name));else if(r.repeated)n("this%s=[]",d.safeProp(r.name));return n("if(p)for(var ks=Object.keys(p),i=0;i<ks.length;++i)if(p[ks[i]]!=null)")("this[ks[i]]=p[ks[i]]")};function b(e){e._fieldsById=e._fieldsArray=e._oneofsArray=null;delete e.encode;delete e.decode;delete e.verify;return e}y.fromJSON=function e(t,n){var u=new y(t,n.options);u.extensions=n.extensions;u.reserved=n.reserved;var c=Object.keys(n.fields),f=0;for(;f<c.length;++f)u.add((typeof n.fields[c[f]].keyType!=="undefined"?a.fromJSON:o.fromJSON)(c[f],n.fields[c[f]]));if(n.oneofs)for(c=Object.keys(n.oneofs),f=0;f<c.length;++f)u.add(s.fromJSON(c[f],n.oneofs[c[f]]));if(n.nested)for(c=Object.keys(n.nested),f=0;f<c.length;++f){var d=n.nested[c[f]];u.add((d.id!==undefined?o.fromJSON:d.fields!==undefined?y.fromJSON:d.values!==undefined?r.fromJSON:d.methods!==undefined?l.fromJSON:i.fromJSON)(c[f],d))}if(n.extensions&&n.extensions.length)u.extensions=n.extensions;if(n.reserved&&n.reserved.length)u.reserved=n.reserved;if(n.group)u.group=true;if(n.comment)u.comment=n.comment;return u};y.prototype.toJSON=function e(t){var n=i.prototype.toJSON.call(this,t);var r=t?Boolean(t.keepComments):false;return d.toObject(["options",n&&n.options||undefined,"oneofs",i.arrayToJSON(this.oneofsArray,t),"fields",i.arrayToJSON(this.fieldsArray.filter((function(e){return!e.declaringField})),t)||{},"extensions",this.extensions&&this.extensions.length?this.extensions:undefined,"reserved",this.reserved&&this.reserved.length?this.reserved:undefined,"group",this.group||undefined,"nested",n&&n.nested||undefined,"comment",r?this.comment:undefined])};y.prototype.resolveAll=function e(){var t=this.fieldsArray,n=0;while(n<t.length)t[n++].resolve();var r=this.oneofsArray;n=0;while(n<r.length)r[n++].resolve();return i.prototype.resolveAll.call(this)};y.prototype.get=function e(t){return this.fields[t]||this.oneofs&&this.oneofs[t]||this.nested&&this.nested[t]||null};y.prototype.add=function e(t){if(this.get(t.name))throw Error("duplicate name '"+t.name+"' in "+this);if(t instanceof o&&t.extend===undefined){if(this._fieldsById?this._fieldsById[t.id]:this.fieldsById[t.id])throw Error("duplicate id "+t.id+" in "+this);if(this.isReservedId(t.id))throw Error("id "+t.id+" is reserved in "+this);if(this.isReservedName(t.name))throw Error("name '"+t.name+"' is reserved in "+this);if(t.parent)t.parent.remove(t);this.fields[t.name]=t;t.message=this;t.onAdd(this);return b(this)}if(t instanceof s){if(!this.oneofs)this.oneofs={};this.oneofs[t.name]=t;t.onAdd(this);return b(this)}return i.prototype.add.call(this,t)};y.prototype.remove=function e(t){if(t instanceof o&&t.extend===undefined){if(!this.fields||this.fields[t.name]!==t)throw Error(t+" is not a member of "+this);delete this.fields[t.name];t.parent=null;t.onRemove(this);return b(this)}if(t instanceof s){if(!this.oneofs||this.oneofs[t.name]!==t)throw Error(t+" is not a member of "+this);delete this.oneofs[t.name];t.parent=null;t.onRemove(this);return b(this)}return i.prototype.remove.call(this,t)};y.prototype.isReservedId=function e(t){return i.isReservedId(this.reserved,t)};y.prototype.isReservedName=function e(t){return i.isReservedName(this.reserved,t)};y.prototype.create=function e(t){return new this.ctor(t)};y.prototype.setup=function e(){var t=this.fullName,n=[];for(var i=0;i<this.fieldsArray.length;++i)n.push(this._fieldsArray[i].resolve().resolvedType);this.encode=h(this)({Writer:f,types:n,util:d});this.decode=p(this)({Reader:c,types:n,util:d});this.verify=m(this)({types:n,util:d});this.fromObject=g.fromObject(this)({types:n,util:d});this.toObject=g.toObject(this)({types:n,util:d});var r=v[t];if(r){var s=Object.create(this);s.fromObject=this.fromObject;this.fromObject=r.fromObject.bind(s);s.toObject=this.toObject;this.toObject=r.toObject.bind(s)}return this};y.prototype.encode=function e(t,n){return this.setup().encode(t,n)};y.prototype.encodeDelimited=function e(t,n){return this.encode(t,n&&n.len?n.fork():n).ldelim()};y.prototype.decode=function e(t,n){return this.setup().decode(t,n)};y.prototype.decodeDelimited=function e(t){if(!(t instanceof c))t=c.create(t);return this.decode(t,t.uint32())};y.prototype.verify=function e(t){return this.setup().verify(t)};y.prototype.fromObject=function e(t){return this.setup().fromObject(t)};y.prototype.toObject=function e(t,n){return this.setup().toObject(t,n)};y.d=function e(t){return function e(n){d.decorateType(n,t)}}},{12:12,13:13,14:14,15:15,16:16,20:20,21:21,23:23,25:25,27:27,33:33,37:37,40:40,41:41,42:42}],36:[function(e,t,n){"use strict";var i=n;var r=e(37);var s=["double","float","int32","uint32","sint32","fixed32","sfixed32","int64","uint64","sint64","fixed64","sfixed64","bool","string","bytes"];function o(e,t){var n=0,i={};t|=0;while(n<e.length)i[s[n+t]]=e[n++];return i}i.basic=o([1,5,0,0,0,5,5,0,0,0,1,1,0,2,2]);i.defaults=o([0,0,0,0,0,0,0,0,0,0,0,0,false,"",r.emptyArray,null]);i.long=o([0,0,0,1,1],7);i.mapKey=o([0,0,0,5,5,0,0,0,1,1,0,2],2);i.packed=o([1,5,0,0,0,5,5,0,0,0,1,1,0])},{37:37}],37:[function(e,t,n){"use strict";var i=t.exports=e(39);var r=e(30);var s,o;i.codegen=e(3);i.fetch=e(5);i.path=e(8);i.fs=i.inquire("fs");i.toArray=function e(t){if(t){var n=Object.keys(t),i=new Array(n.length),r=0;while(r<n.length)i[r]=t[n[r++]];return i}return[]};i.toObject=function e(t){var n={},i=0;while(i<t.length){var r=t[i++],s=t[i++];if(s!==undefined)n[r]=s}return n};var a=/\\/g,l=/"/g;i.isReserved=function e(t){return/^(?:do|if|in|for|let|new|try|var|case|else|enum|eval|false|null|this|true|void|with|break|catch|class|const|super|throw|while|yield|delete|export|import|public|return|static|switch|typeof|default|extends|finally|package|private|continue|debugger|function|arguments|interface|protected|implements|instanceof)$/.test(t)};i.safeProp=function e(t){if(!/^[$\w_]+$/.test(t)||i.isReserved(t))return'["'+t.replace(a,"\\\\").replace(l,'\\"')+'"]';return"."+t};i.ucFirst=function e(t){return t.charAt(0).toUpperCase()+t.substring(1)};var u=/_([a-z])/g;i.camelCase=function e(t){return t.substring(0,1)+t.substring(1).replace(u,(function(e,t){return t.toUpperCase()}))};i.compareFieldsById=function e(t,n){return t.id-n.id};i.decorateType=function t(n,r){if(n.$type){if(r&&n.$type.name!==r){i.decorateRoot.remove(n.$type);n.$type.name=r;i.decorateRoot.add(n.$type)}return n.$type}if(!s)s=e(35);var o=new s(r||n.name);i.decorateRoot.add(o);o.ctor=n;Object.defineProperty(n,"$type",{value:o,enumerable:false});Object.defineProperty(n.prototype,"$type",{value:o,enumerable:false});return o};var c=0;i.decorateEnum=function t(n){if(n.$type)return n.$type;if(!o)o=e(15);var r=new o("Enum"+c++,n);i.decorateRoot.add(r);Object.defineProperty(n,"$type",{value:r,enumerable:false});return r};Object.defineProperty(i,"decorateRoot",{get:function(){return r["decorated"]||(r["decorated"]=new(e(29)))}})},{15:15,29:29,3:3,30:30,35:35,39:39,5:5,8:8}],38:[function(e,t,n){"use strict";t.exports=r;var i=e(39);function r(e,t){this.lo=e>>>0;this.hi=t>>>0}var s=r.zero=new r(0,0);s.toNumber=function(){return 0};s.zzEncode=s.zzDecode=function(){return this};s.length=function(){return 1};var o=r.zeroHash="\0\0\0\0\0\0\0\0";r.fromNumber=function e(t){if(t===0)return s;var n=t<0;if(n)t=-t;var i=t>>>0,o=(t-i)/4294967296>>>0;if(n){o=~o>>>0;i=~i>>>0;if(++i>4294967295){i=0;if(++o>4294967295)o=0}}return new r(i,o)};r.from=function e(t){if(typeof t==="number")return r.fromNumber(t);if(i.isString(t)){if(i.Long)t=i.Long.fromString(t);else return r.fromNumber(parseInt(t,10))}return t.low||t.high?new r(t.low>>>0,t.high>>>0):s};r.prototype.toNumber=function e(t){if(!t&&this.hi>>>31){var n=~this.lo+1>>>0,i=~this.hi>>>0;if(!n)i=i+1>>>0;return-(n+i*4294967296)}return this.lo+this.hi*4294967296};r.prototype.toLong=function e(t){return i.Long?new i.Long(this.lo|0,this.hi|0,Boolean(t)):{low:this.lo|0,high:this.hi|0,unsigned:Boolean(t)}};var a=String.prototype.charCodeAt;r.fromHash=function e(t){if(t===o)return s;return new r((a.call(t,0)|a.call(t,1)<<8|a.call(t,2)<<16|a.call(t,3)<<24)>>>0,(a.call(t,4)|a.call(t,5)<<8|a.call(t,6)<<16|a.call(t,7)<<24)>>>0)};r.prototype.toHash=function e(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)};r.prototype.zzEncode=function e(){var t=this.hi>>31;this.hi=((this.hi<<1|this.lo>>>31)^t)>>>0;this.lo=(this.lo<<1^t)>>>0;return this};r.prototype.zzDecode=function e(){var t=-(this.lo&1);this.lo=((this.lo>>>1|this.hi<<31)^t)>>>0;this.hi=(this.hi>>>1^t)>>>0;return this};r.prototype.length=function e(){var t=this.lo,n=(this.lo>>>28|this.hi<<4)>>>0,i=this.hi>>>24;return i===0?n===0?t<16384?t<128?1:2:t<2097152?3:4:n<16384?n<128?5:6:n<2097152?7:8:i<128?9:10}},{39:39}],39:[function(e,t,n){"use strict";var i=n;i.asPromise=e(1);i.base64=e(2);i.EventEmitter=e(4);i.float=e(6);i.inquire=e(7);i.utf8=e(10);i.pool=e(9);i.LongBits=e(38);i.emptyArray=Object.freeze?Object.freeze([]):[];i.emptyObject=Object.freeze?Object.freeze({}):{};i.isNode=Boolean(global.process&&global.process.versions&&global.process.versions.node);i.isInteger=Number.isInteger||function e(t){return typeof t==="number"&&isFinite(t)&&Math.floor(t)===t};i.isString=function e(t){return typeof t==="string"||t instanceof String};i.isObject=function e(t){return t&&typeof t==="object"};i.isset=i.isSet=function e(t,n){var i=t[n];if(i!=null&&t.hasOwnProperty(n))return typeof i!=="object"||(Array.isArray(i)?i.length:Object.keys(i).length)>0;return false};i.Buffer=function(){try{var e=i.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch(e){return null}}();i._Buffer_from=null;i._Buffer_allocUnsafe=null;i.newBuffer=function e(t){return typeof t==="number"?i.Buffer?i._Buffer_allocUnsafe(t):new i.Array(t):i.Buffer?i._Buffer_from(t):typeof Uint8Array==="undefined"?t:new Uint8Array(t)};i.Array=typeof Uint8Array!=="undefined"?Uint8Array:Array;i.Long=global.dcodeIO&&global.dcodeIO.Long||i.inquire("long");i.key2Re=/^true|false|0|1$/;i.key32Re=/^-?(?:0|[1-9][0-9]*)$/;i.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/;i.longToHash=function e(t){return t?i.LongBits.from(t).toHash():i.LongBits.zeroHash};i.longFromHash=function e(t,n){var r=i.LongBits.fromHash(t);if(i.Long)return i.Long.fromBits(r.lo,r.hi,n);return r.toNumber(Boolean(n))};function r(e,t,n){for(var i=Object.keys(t),r=0;r<i.length;++r)if(e[i[r]]===undefined||!n)e[i[r]]=t[i[r]];return e}i.merge=r;i.lcFirst=function e(t){return t.charAt(0).toLowerCase()+t.substring(1)};function s(e){function t(e,n){if(!(this instanceof t))return new t(e,n);Object.defineProperty(this,"message",{get:function(){return e}});if(Error.captureStackTrace)Error.captureStackTrace(this,t);else Object.defineProperty(this,"stack",{value:(new Error).stack||""});if(n)r(this,n)}(t.prototype=Object.create(Error.prototype)).constructor=t;Object.defineProperty(t.prototype,"name",{get:function(){return e}});t.prototype.toString=function e(){return this.name+": "+this.message};return t}i.newError=s;i.ProtocolError=s("ProtocolError");i.oneOfGetter=function e(t){var n={};for(var i=0;i<t.length;++i)n[t[i]]=1;return function(){for(var e=Object.keys(this),t=e.length-1;t>-1;--t)if(n[e[t]]===1&&this[e[t]]!==undefined&&this[e[t]]!==null)return e[t]}};i.oneOfSetter=function e(t){return function(e){for(var n=0;n<t.length;++n)if(t[n]!==e)delete this[t[n]]}};i.toJSONOptions={longs:String,enums:String,bytes:String,json:true};i._configure=function(){var e=i.Buffer;if(!e){i._Buffer_from=i._Buffer_allocUnsafe=null;return}i._Buffer_from=e.from!==Uint8Array.from&&e.from||function t(n,i){return new e(n,i)};i._Buffer_allocUnsafe=e.allocUnsafe||function t(n){return new e(n)}}},{1:1,10:10,2:2,38:38,4:4,6:6,7:7,9:9}],40:[function(e,t,n){"use strict";t.exports=l;var i=e(15),r=e(37);function s(e,t){return e.name+": "+t+(e.repeated&&t!=="array"?"[]":e.map&&t!=="object"?"{k:"+e.keyType+"}":"")+" expected"}function o(e,t,n,r){if(t.resolvedType){if(t.resolvedType instanceof i){e("switch(%s){",r)("default:")("return%j",s(t,"enum value"));for(var o=Object.keys(t.resolvedType.values),a=0;a<o.length;++a)e("case %i:",t.resolvedType.values[o[a]]);e("break")("}")}else{e("{")("var e=types[%i].verify(%s);",n,r)("if(e)")("return%j+e",t.name+".")("}")}}else{switch(t.type){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":e("if(!util.isInteger(%s))",r)("return%j",s(t,"integer"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":e("if(!util.isInteger(%s)&&!(%s&&util.isInteger(%s.low)&&util.isInteger(%s.high)))",r,r,r,r)("return%j",s(t,"integer|Long"));break;case"float":case"double":e('if(typeof %s!=="number")',r)("return%j",s(t,"number"));break;case"bool":e('if(typeof %s!=="boolean")',r)("return%j",s(t,"boolean"));break;case"string":e("if(!util.isString(%s))",r)("return%j",s(t,"string"));break;case"bytes":e('if(!(%s&&typeof %s.length==="number"||util.isString(%s)))',r,r,r)("return%j",s(t,"buffer"));break}}return e}function a(e,t,n){switch(t.keyType){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":e("if(!util.key32Re.test(%s))",n)("return%j",s(t,"integer key"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":e("if(!util.key64Re.test(%s))",n)("return%j",s(t,"integer|Long key"));break;case"bool":e("if(!util.key2Re.test(%s))",n)("return%j",s(t,"boolean key"));break}return e}function l(e){var t=r.codegen(["m"],e.name+"$verify")('if(typeof m!=="object"||m===null)')("return%j","object expected");var n=e.oneofsArray,i={};if(n.length)t("var p={}");for(var l=0;l<e.fieldsArray.length;++l){var u=e._fieldsArray[l].resolve(),c="m"+r.safeProp(u.name);if(u.optional)t("if(%s!=null&&m.hasOwnProperty(%j)){",c,u.name);if(u.map){t("if(!util.isObject(%s))",c)("return%j",s(u,"object"))("var k=Object.keys(%s)",c)("for(var i=0;i<k.length;++i){");a(t,u,"k[i]");o(t,u,l,c+"[k[i]]")("}")}else if(u.repeated){t("if(!Array.isArray(%s))",c)("return%j",s(u,"array"))("for(var i=0;i<%s.length;++i){",c);o(t,u,l,c+"[i]")("}")}else{if(u.partOf){var f=r.safeProp(u.partOf.name);if(i[u.partOf.name]===1)t("if(p%s===1)",f)("return%j",u.partOf.name+": multiple values");i[u.partOf.name]=1;t("p%s=1",f)}o(t,u,l,c)}if(u.optional)t("}")}return t("return null")}},{15:15,37:37}],41:[function(e,t,n){"use strict";var i=n;var r=e(21);i[".google.protobuf.Any"]={fromObject:function(e){if(e&&e["@type"]){var t=this.lookup(e["@type"]);if(t){var n=e["@type"].charAt(0)==="."?e["@type"].substr(1):e["@type"];return this.create({type_url:"/"+n,value:t.encode(t.fromObject(e)).finish()})}}return this.fromObject(e)},toObject:function(e,t){if(t&&t.json&&e.type_url&&e.value){var n=e.type_url.substring(e.type_url.lastIndexOf("/")+1);var i=this.lookup(n);if(i)e=i.decode(e.value)}if(!(e instanceof this.ctor)&&e instanceof r){var s=e.$type.toObject(e,t);s["@type"]=e.$type.fullName;return s}return this.toObject(e,t)}}},{21:21}],42:[function(e,t,n){"use strict";t.exports=f;var i=e(39);var r;var s=i.LongBits,o=i.base64,a=i.utf8;function l(e,t,n){this.fn=e;this.len=t;this.next=undefined;this.val=n}function u(){}function c(e){this.head=e.head;this.tail=e.tail;this.len=e.len;this.next=e.states}function f(){this.len=0;this.head=new l(u,0,0);this.tail=this.head;this.states=null}f.create=i.Buffer?function e(){return(f.create=function e(){return new r})()}:function e(){return new f};f.alloc=function e(t){return new i.Array(t)};if(i.Array!==Array)f.alloc=i.pool(f.alloc,i.Array.prototype.subarray);f.prototype._push=function e(t,n,i){this.tail=this.tail.next=new l(t,n,i);this.len+=n;return this};function d(e,t,n){t[n]=e&255}function h(e,t,n){while(e>127){t[n++]=e&127|128;e>>>=7}t[n]=e}function p(e,t){this.len=e;this.next=undefined;this.val=t}p.prototype=Object.create(l.prototype);p.prototype.fn=h;f.prototype.uint32=function e(t){this.len+=(this.tail=this.tail.next=new p((t=t>>>0)<128?1:t<16384?2:t<2097152?3:t<268435456?4:5,t)).len;return this};f.prototype.int32=function e(t){return t<0?this._push(m,10,s.fromNumber(t)):this.uint32(t)};f.prototype.sint32=function e(t){return this.uint32((t<<1^t>>31)>>>0)};function m(e,t,n){while(e.hi){t[n++]=e.lo&127|128;e.lo=(e.lo>>>7|e.hi<<25)>>>0;e.hi>>>=7}while(e.lo>127){t[n++]=e.lo&127|128;e.lo=e.lo>>>7}t[n++]=e.lo}f.prototype.uint64=function e(t){var n=s.from(t);return this._push(m,n.length(),n)};f.prototype.int64=f.prototype.uint64;f.prototype.sint64=function e(t){var n=s.from(t).zzEncode();return this._push(m,n.length(),n)};f.prototype.bool=function e(t){return this._push(d,1,t?1:0)};function g(e,t,n){t[n]=e&255;t[n+1]=e>>>8&255;t[n+2]=e>>>16&255;t[n+3]=e>>>24}f.prototype.fixed32=function e(t){return this._push(g,4,t>>>0)};f.prototype.sfixed32=f.prototype.fixed32;f.prototype.fixed64=function e(t){var n=s.from(t);return this._push(g,4,n.lo)._push(g,4,n.hi)};f.prototype.sfixed64=f.prototype.fixed64;f.prototype.float=function e(t){return this._push(i.float.writeFloatLE,4,t)};f.prototype.double=function e(t){return this._push(i.float.writeDoubleLE,8,t)};var v=i.Array.prototype.set?function e(t,n,i){n.set(t,i)}:function e(t,n,i){for(var r=0;r<t.length;++r)n[i+r]=t[r]};f.prototype.bytes=function e(t){var n=t.length>>>0;if(!n)return this._push(d,1,0);if(i.isString(t)){var r=f.alloc(n=o.length(t));o.decode(t,r,0);t=r}return this.uint32(n)._push(v,n,t)};f.prototype.string=function e(t){var n=a.length(t);return n?this.uint32(n)._push(a.write,n,t):this._push(d,1,0)};f.prototype.fork=function e(){this.states=new c(this);this.head=this.tail=new l(u,0,0);this.len=0;return this};f.prototype.reset=function e(){if(this.states){this.head=this.states.head;this.tail=this.states.tail;this.len=this.states.len;this.states=this.states.next}else{this.head=this.tail=new l(u,0,0);this.len=0}return this};f.prototype.ldelim=function e(){var t=this.head,n=this.tail,i=this.len;this.reset().uint32(i);if(i){this.tail.next=t.next;this.tail=n;this.len+=i}return this};f.prototype.finish=function e(){var t=this.head.next,n=this.constructor.alloc(this.len),i=0;while(t){t.fn(t.val,n,i);i+=t.len;t=t.next}return n};f._configure=function(e){r=e}},{39:39}],43:[function(e,t,n){"use strict";t.exports=o;var i=e(42);(o.prototype=Object.create(i.prototype)).constructor=o;var r=e(39);var s=r.Buffer;function o(){i.call(this)}o.alloc=function e(t){return(o.alloc=r._Buffer_allocUnsafe)(t)};var a=s&&s.prototype instanceof Uint8Array&&s.prototype.set.name==="set"?function e(t,n,i){n.set(t,i)}:function e(t,n,i){if(t.copy)t.copy(n,i,0,t.length);else for(var r=0;r<t.length;)n[i++]=t[r++]};o.prototype.bytes=function e(t){if(r.isString(t))t=r._Buffer_from(t,"base64");var n=t.length>>>0;this.uint32(n);if(n)this._push(a,n,t);return this};function l(e,t,n){if(e.length<40)r.utf8.write(e,t,n);else t.utf8Write(e,n)}o.prototype.string=function e(t){var n=s.byteLength(t);this.uint32(n);if(n)this._push(l,n,t);return this}},{39:39,42:42}]},{},[19])})(typeof window==="object"&&window||typeof self==="object"&&self||this);(function(e){"use strict";var t=e.Reader,n=e.Writer,i=e.util;var r=e.roots["push-server"]||(e.roots["push-server"]={});r.RequestBatch=function(){function e(e){this.requests=[];if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)if(e[t[n]]!=null)this[t[n]]=e[t[n]]}e.prototype.requests=i.emptyArray;e.create=function t(n){return new e(n)};e.encode=function e(t,i){if(!i)i=n.create();if(t.requests!=null&&t.requests.length)for(var s=0;s<t.requests.length;++s)r.Request.encode(t.requests[s],i.uint32(10).fork()).ldelim();return i};e.decode=function e(n,i){if(!(n instanceof t))n=t.create(n);var s=i===undefined?n.len:n.pos+i,o=new r.RequestBatch;while(n.pos<s){var a=n.uint32();switch(a>>>3){case 1:if(!(o.requests&&o.requests.length))o.requests=[];o.requests.push(r.Request.decode(n,n.uint32()));break;default:n.skipType(a&7);break}}return o};return e}();r.Request=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)if(e[t[n]]!=null)this[t[n]]=e[t[n]]}e.prototype.incomingMessages=null;e.prototype.channelStats=null;e.prototype.serverStats=null;var s;Object.defineProperty(e.prototype,"command",{get:i.oneOfGetter(s=["incomingMessages","channelStats","serverStats"]),set:i.oneOfSetter(s)});e.create=function t(n){return new e(n)};e.encode=function e(t,i){if(!i)i=n.create();if(t.incomingMessages!=null&&t.hasOwnProperty("incomingMessages"))r.IncomingMessagesRequest.encode(t.incomingMessages,i.uint32(10).fork()).ldelim();if(t.channelStats!=null&&t.hasOwnProperty("channelStats"))r.ChannelStatsRequest.encode(t.channelStats,i.uint32(18).fork()).ldelim();if(t.serverStats!=null&&t.hasOwnProperty("serverStats"))r.ServerStatsRequest.encode(t.serverStats,i.uint32(26).fork()).ldelim();return i};e.decode=function e(n,i){if(!(n instanceof t))n=t.create(n);var s=i===undefined?n.len:n.pos+i,o=new r.Request;while(n.pos<s){var a=n.uint32();switch(a>>>3){case 1:o.incomingMessages=r.IncomingMessagesRequest.decode(n,n.uint32());break;case 2:o.channelStats=r.ChannelStatsRequest.decode(n,n.uint32());break;case 3:o.serverStats=r.ServerStatsRequest.decode(n,n.uint32());break;default:n.skipType(a&7);break}}return o};return e}();r.IncomingMessagesRequest=function(){function e(e){this.messages=[];if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)if(e[t[n]]!=null)this[t[n]]=e[t[n]]}e.prototype.messages=i.emptyArray;e.create=function t(n){return new e(n)};e.encode=function e(t,i){if(!i)i=n.create();if(t.messages!=null&&t.messages.length)for(var s=0;s<t.messages.length;++s)r.IncomingMessage.encode(t.messages[s],i.uint32(10).fork()).ldelim();return i};e.decode=function e(n,i){if(!(n instanceof t))n=t.create(n);var s=i===undefined?n.len:n.pos+i,o=new r.IncomingMessagesRequest;while(n.pos<s){var a=n.uint32();switch(a>>>3){case 1:if(!(o.messages&&o.messages.length))o.messages=[];o.messages.push(r.IncomingMessage.decode(n,n.uint32()));break;default:n.skipType(a&7);break}}return o};return e}();r.IncomingMessage=function(){function e(e){this.receivers=[];if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)if(e[t[n]]!=null)this[t[n]]=e[t[n]]}e.prototype.receivers=i.emptyArray;e.prototype.sender=null;e.prototype.body="";e.prototype.expiry=0;e.prototype.type="";e.create=function t(n){return new e(n)};e.encode=function e(t,i){if(!i)i=n.create();if(t.receivers!=null&&t.receivers.length)for(var s=0;s<t.receivers.length;++s)r.Receiver.encode(t.receivers[s],i.uint32(10).fork()).ldelim();if(t.sender!=null&&t.hasOwnProperty("sender"))r.Sender.encode(t.sender,i.uint32(18).fork()).ldelim();if(t.body!=null&&t.hasOwnProperty("body"))i.uint32(26).string(t.body);if(t.expiry!=null&&t.hasOwnProperty("expiry"))i.uint32(32).uint32(t.expiry);if(t.type!=null&&t.hasOwnProperty("type"))i.uint32(42).string(t.type);return i};e.decode=function e(n,i){if(!(n instanceof t))n=t.create(n);var s=i===undefined?n.len:n.pos+i,o=new r.IncomingMessage;while(n.pos<s){var a=n.uint32();switch(a>>>3){case 1:if(!(o.receivers&&o.receivers.length))o.receivers=[];o.receivers.push(r.Receiver.decode(n,n.uint32()));break;case 2:o.sender=r.Sender.decode(n,n.uint32());break;case 3:o.body=n.string();break;case 4:o.expiry=n.uint32();break;case 5:o.type=n.string();break;default:n.skipType(a&7);break}}return o};return e}();r.ChannelStatsRequest=function(){function e(e){this.channels=[];if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)if(e[t[n]]!=null)this[t[n]]=e[t[n]]}e.prototype.channels=i.emptyArray;e.create=function t(n){return new e(n)};e.encode=function e(t,i){if(!i)i=n.create();if(t.channels!=null&&t.channels.length)for(var s=0;s<t.channels.length;++s)r.ChannelId.encode(t.channels[s],i.uint32(10).fork()).ldelim();return i};e.decode=function e(n,i){if(!(n instanceof t))n=t.create(n);var s=i===undefined?n.len:n.pos+i,o=new r.ChannelStatsRequest;while(n.pos<s){var a=n.uint32();switch(a>>>3){case 1:if(!(o.channels&&o.channels.length))o.channels=[];o.channels.push(r.ChannelId.decode(n,n.uint32()));break;default:n.skipType(a&7);break}}return o};return e}();r.ChannelId=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)if(e[t[n]]!=null)this[t[n]]=e[t[n]]}e.prototype.id=i.newBuffer([]);e.prototype.isPrivate=false;e.prototype.signature=i.newBuffer([]);e.create=function t(n){return new e(n)};e.encode=function e(t,i){if(!i)i=n.create();if(t.id!=null&&t.hasOwnProperty("id"))i.uint32(10).bytes(t.id);if(t.isPrivate!=null&&t.hasOwnProperty("isPrivate"))i.uint32(16).bool(t.isPrivate);if(t.signature!=null&&t.hasOwnProperty("signature"))i.uint32(26).bytes(t.signature);return i};e.decode=function e(n,i){if(!(n instanceof t))n=t.create(n);var s=i===undefined?n.len:n.pos+i,o=new r.ChannelId;while(n.pos<s){var a=n.uint32();switch(a>>>3){case 1:o.id=n.bytes();break;case 2:o.isPrivate=n.bool();break;case 3:o.signature=n.bytes();break;default:n.skipType(a&7);break}}return o};return e}();r.ServerStatsRequest=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)if(e[t[n]]!=null)this[t[n]]=e[t[n]]}e.create=function t(n){return new e(n)};e.encode=function e(t,i){if(!i)i=n.create();return i};e.decode=function e(n,i){if(!(n instanceof t))n=t.create(n);var s=i===undefined?n.len:n.pos+i,o=new r.ServerStatsRequest;while(n.pos<s){var a=n.uint32();switch(a>>>3){default:n.skipType(a&7);break}}return o};return e}();r.Sender=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)if(e[t[n]]!=null)this[t[n]]=e[t[n]]}e.prototype.type=0;e.prototype.id=i.newBuffer([]);e.create=function t(n){return new e(n)};e.encode=function e(t,i){if(!i)i=n.create();if(t.type!=null&&t.hasOwnProperty("type"))i.uint32(8).int32(t.type);if(t.id!=null&&t.hasOwnProperty("id"))i.uint32(18).bytes(t.id);return i};e.decode=function e(n,i){if(!(n instanceof t))n=t.create(n);var s=i===undefined?n.len:n.pos+i,o=new r.Sender;while(n.pos<s){var a=n.uint32();switch(a>>>3){case 1:o.type=n.int32();break;case 2:o.id=n.bytes();break;default:n.skipType(a&7);break}}return o};return e}();r.SenderType=function(){var e={},t=Object.create(e);t[e[0]="UNKNOWN"]=0;t[e[1]="CLIENT"]=1;t[e[2]="BACKEND"]=2;return t}();r.Receiver=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)if(e[t[n]]!=null)this[t[n]]=e[t[n]]}e.prototype.id=i.newBuffer([]);e.prototype.isPrivate=false;e.prototype.signature=i.newBuffer([]);e.create=function t(n){return new e(n)};e.encode=function e(t,i){if(!i)i=n.create();if(t.id!=null&&t.hasOwnProperty("id"))i.uint32(10).bytes(t.id);if(t.isPrivate!=null&&t.hasOwnProperty("isPrivate"))i.uint32(16).bool(t.isPrivate);if(t.signature!=null&&t.hasOwnProperty("signature"))i.uint32(26).bytes(t.signature);return i};e.decode=function e(n,i){if(!(n instanceof t))n=t.create(n);var s=i===undefined?n.len:n.pos+i,o=new r.Receiver;while(n.pos<s){var a=n.uint32();switch(a>>>3){case 1:o.id=n.bytes();break;case 2:o.isPrivate=n.bool();break;case 3:o.signature=n.bytes();break;default:n.skipType(a&7);break}}return o};return e}();r.ResponseBatch=function(){function e(e){this.responses=[];if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)if(e[t[n]]!=null)this[t[n]]=e[t[n]]}e.prototype.responses=i.emptyArray;e.create=function t(n){return new e(n)};e.encode=function e(t,i){if(!i)i=n.create();if(t.responses!=null&&t.responses.length)for(var s=0;s<t.responses.length;++s)r.Response.encode(t.responses[s],i.uint32(10).fork()).ldelim();return i};e.decode=function e(n,i){if(!(n instanceof t))n=t.create(n);var s=i===undefined?n.len:n.pos+i,o=new r.ResponseBatch;while(n.pos<s){var a=n.uint32();switch(a>>>3){case 1:if(!(o.responses&&o.responses.length))o.responses=[];o.responses.push(r.Response.decode(n,n.uint32()));break;default:n.skipType(a&7);break}}return o};return e}();r.Response=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)if(e[t[n]]!=null)this[t[n]]=e[t[n]]}e.prototype.outgoingMessages=null;e.prototype.channelStats=null;e.prototype.serverStats=null;var s;Object.defineProperty(e.prototype,"command",{get:i.oneOfGetter(s=["outgoingMessages","channelStats","serverStats"]),set:i.oneOfSetter(s)});e.create=function t(n){return new e(n)};e.encode=function e(t,i){if(!i)i=n.create();if(t.outgoingMessages!=null&&t.hasOwnProperty("outgoingMessages"))r.OutgoingMessagesResponse.encode(t.outgoingMessages,i.uint32(10).fork()).ldelim();if(t.channelStats!=null&&t.hasOwnProperty("channelStats"))r.ChannelStatsResponse.encode(t.channelStats,i.uint32(18).fork()).ldelim();if(t.serverStats!=null&&t.hasOwnProperty("serverStats"))r.JsonResponse.encode(t.serverStats,i.uint32(26).fork()).ldelim();return i};e.decode=function e(n,i){if(!(n instanceof t))n=t.create(n);var s=i===undefined?n.len:n.pos+i,o=new r.Response;while(n.pos<s){var a=n.uint32();switch(a>>>3){case 1:o.outgoingMessages=r.OutgoingMessagesResponse.decode(n,n.uint32());break;case 2:o.channelStats=r.ChannelStatsResponse.decode(n,n.uint32());break;case 3:o.serverStats=r.JsonResponse.decode(n,n.uint32());break;default:n.skipType(a&7);break}}return o};return e}();r.OutgoingMessagesResponse=function(){function e(e){this.messages=[];if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)if(e[t[n]]!=null)this[t[n]]=e[t[n]]}e.prototype.messages=i.emptyArray;e.create=function t(n){return new e(n)};e.encode=function e(t,i){if(!i)i=n.create();if(t.messages!=null&&t.messages.length)for(var s=0;s<t.messages.length;++s)r.OutgoingMessage.encode(t.messages[s],i.uint32(10).fork()).ldelim();return i};e.decode=function e(n,i){if(!(n instanceof t))n=t.create(n);var s=i===undefined?n.len:n.pos+i,o=new r.OutgoingMessagesResponse;while(n.pos<s){var a=n.uint32();switch(a>>>3){case 1:if(!(o.messages&&o.messages.length))o.messages=[];o.messages.push(r.OutgoingMessage.decode(n,n.uint32()));break;default:n.skipType(a&7);break}}return o};return e}();r.OutgoingMessage=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)if(e[t[n]]!=null)this[t[n]]=e[t[n]]}e.prototype.id=i.newBuffer([]);e.prototype.body="";e.prototype.expiry=0;e.prototype.created=0;e.prototype.sender=null;e.create=function t(n){return new e(n)};e.encode=function e(t,i){if(!i)i=n.create();if(t.id!=null&&t.hasOwnProperty("id"))i.uint32(10).bytes(t.id);if(t.body!=null&&t.hasOwnProperty("body"))i.uint32(18).string(t.body);if(t.expiry!=null&&t.hasOwnProperty("expiry"))i.uint32(24).uint32(t.expiry);if(t.created!=null&&t.hasOwnProperty("created"))i.uint32(37).fixed32(t.created);if(t.sender!=null&&t.hasOwnProperty("sender"))r.Sender.encode(t.sender,i.uint32(42).fork()).ldelim();return i};e.decode=function e(n,i){if(!(n instanceof t))n=t.create(n);var s=i===undefined?n.len:n.pos+i,o=new r.OutgoingMessage;while(n.pos<s){var a=n.uint32();switch(a>>>3){case 1:o.id=n.bytes();break;case 2:o.body=n.string();break;case 3:o.expiry=n.uint32();break;case 4:o.created=n.fixed32();break;case 5:o.sender=r.Sender.decode(n,n.uint32());break;default:n.skipType(a&7);break}}return o};return e}();r.ChannelStatsResponse=function(){function e(e){this.channels=[];if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)if(e[t[n]]!=null)this[t[n]]=e[t[n]]}e.prototype.channels=i.emptyArray;e.create=function t(n){return new e(n)};e.encode=function e(t,i){if(!i)i=n.create();if(t.channels!=null&&t.channels.length)for(var s=0;s<t.channels.length;++s)r.ChannelStats.encode(t.channels[s],i.uint32(10).fork()).ldelim();return i};e.decode=function e(n,i){if(!(n instanceof t))n=t.create(n);var s=i===undefined?n.len:n.pos+i,o=new r.ChannelStatsResponse;while(n.pos<s){var a=n.uint32();switch(a>>>3){case 1:if(!(o.channels&&o.channels.length))o.channels=[];o.channels.push(r.ChannelStats.decode(n,n.uint32()));break;default:n.skipType(a&7);break}}return o};return e}();r.ChannelStats=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)if(e[t[n]]!=null)this[t[n]]=e[t[n]]}e.prototype.id=i.newBuffer([]);e.prototype.isPrivate=false;e.prototype.isOnline=false;e.create=function t(n){return new e(n)};e.encode=function e(t,i){if(!i)i=n.create();if(t.id!=null&&t.hasOwnProperty("id"))i.uint32(10).bytes(t.id);if(t.isPrivate!=null&&t.hasOwnProperty("isPrivate"))i.uint32(16).bool(t.isPrivate);if(t.isOnline!=null&&t.hasOwnProperty("isOnline"))i.uint32(24).bool(t.isOnline);return i};e.decode=function e(n,i){if(!(n instanceof t))n=t.create(n);var s=i===undefined?n.len:n.pos+i,o=new r.ChannelStats;while(n.pos<s){var a=n.uint32();switch(a>>>3){case 1:o.id=n.bytes();break;case 2:o.isPrivate=n.bool();break;case 3:o.isOnline=n.bool();break;default:n.skipType(a&7);break}}return o};return e}();r.JsonResponse=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)if(e[t[n]]!=null)this[t[n]]=e[t[n]]}e.prototype.json="";e.create=function t(n){return new e(n)};e.encode=function e(t,i){if(!i)i=n.create();if(t.json!=null&&t.hasOwnProperty("json"))i.uint32(10).string(t.json);return i};e.decode=function e(n,i){if(!(n instanceof t))n=t.create(n);var s=i===undefined?n.len:n.pos+i,o=new r.JsonResponse;while(n.pos<s){var a=n.uint32();switch(a>>>3){case 1:o.json=n.string();break;default:n.skipType(a&7);break}}return o};return e}();return r})(typeof window==="object"&&typeof window.protobuf==="object"&&window.protobuf||typeof self==="object"&&typeof self.protobuf==="object"&&self.protobuf||typeof protobuf==="object"&&protobuf);(function(e){if(!e.BX){e.BX={}}var t=e.BX;t.Promise=function(e,t){this.state=null;this.value=null;this.reason=null;this.next=null;this.ctx=t||this;this.onFulfilled=[];this.onRejected=[]};t.Promise.prototype.fulfill=function(e){this.checkState();this.value=e;this.state=true;this.execute()};t.Promise.prototype.reject=function(e){this.checkState();this.reason=e;this.state=false;this.execute()};t.Promise.prototype.then=function(e,n){if(typeof e=="function"||e instanceof Function){this.onFulfilled.push(e)}if(typeof n=="function"||n instanceof Function){this.onRejected.push(n)}if(this.next===null){this.next=new t.Promise(null,this.ctx)}if(this.state!==null){this.execute()}return this.next};t.Promise.prototype.catch=function(e){if(typeof e=="function"||e instanceof Function){this.onRejected.push(e)}if(this.next===null){this.next=new t.Promise(null,this.ctx)}if(this.state!==null){this.execute()}return this.next};t.Promise.prototype.setAutoResolve=function(e,t){this.timer=setTimeout(function(){if(this.state===null){this[e?"fulfill":"reject"]()}}.bind(this),t||15)};t.Promise.prototype.cancelAutoResolve=function(){clearTimeout(this.timer)};t.Promise.prototype.resolve=function(e){var t=this;if(this===e){this.reject(new TypeError("Promise cannot fulfill or reject itself"))}else if(e&&e.toString()==="[object BX.Promise]"){e.then((function(e){t.fulfill(e)}),(function(e){t.reject(e)}))}else{this.fulfill(e)}};t.Promise.prototype.toString=function(){return"[object BX.Promise]"};t.Promise.prototype.execute=function(){if(this.state===null){return}var n=undefined;var i=undefined;var r=undefined;var s;if(this.state===true){if(this.onFulfilled.length){try{for(s=0;s<this.onFulfilled.length;s++){r=this.onFulfilled[s].apply(this.ctx,[this.value]);if(typeof r!="undefined"){n=r}}}catch(n){if("console"in e){console.dir(n)}if(typeof t.debug!=="undefined"){t.debug(n)}i=n}}else{n=this.value}}else if(this.state===false){if(this.onRejected.length){try{for(s=0;s<this.onRejected.length;s++){r=this.onRejected[s].apply(this.ctx,[this.reason]);if(typeof r!="undefined"){n=r}}}catch(n){if("console"in e){console.dir(n)}if(typeof t.debug!=="undefined"){t.debug(n)}i=n}}else{i=this.reason}}if(this.next!==null){if(typeof i!="undefined"){this.next.reject(i)}else if(typeof n!="undefined"){this.next.resolve(n)}}};t.Promise.prototype.checkState=function(){if(this.state!==null){throw new Error("You can not do fulfill() or reject() multiple times")}}})(window);"use strict";(function(){if(!window.BX){window.BX={}}else if(window.BX.RestClient){return}var e=window.BX;e.RestClient=function(e){e=e||{};this.endpoint=e.endpoint||"/rest";this.queryParams=e.queryParams||"";this.cors=e.cors===true};e.RestClient.prototype.callMethod=function(e,t,n,r,s){return i({method:e,data:t,callback:n,sendCallback:r,logTag:s,endpoint:this.endpoint,queryParams:this.queryParams,cors:this.cors})};e.RestClient.prototype.callBatch=function(e,t,r,s,o){var a=n.isArray(e)?[]:{};var l=0;var u=function(e){i.batch(e,t,r,s,this.endpoint,this.queryParams,this.cors,o)}.bind(this);for(var c in e){var f=null,d=null;if(!!e[c]&&e.hasOwnProperty(c)){if(n.isArray(e[c])){f=e[c][0];d=e[c][1]}else if(!!e[c].method){f=e[c].method;d=e[c].params}if(!!f){l++;a[c]=[f,d]}}}if(l>0){var h=function(e){return function(t){a[e]=a[e][0]+"?"+t;if(--l<=0)u(a)}};for(var p in a){if(a.hasOwnProperty(p)){i.prepareData(a[p][1],"",h(p))}}}};e.RestClient.prototype.setEndpoint=function(e){this.endpoint=e};e.RestClient.prototype.enableCorsRequest=function(e){this.cors=e===true};e.RestClient.prototype.setQueryParams=function(e){this.queryParams=e};if(typeof e.namespace!=="undefined"){var t=new e.RestClient;if(typeof e.rest=="undefined"){e.rest={}}e.rest.callMethod=function(e,n,i,r,s){return t.callMethod(e,n,i,r,s)};e.rest.callBatch=function(e,n,i,r,s){return t.callBatch(e,n,i,r,s)}}var n={isArray:function(e){return e&&Object.prototype.toString.call(e)=="[object Array]"},isFunction:function(e){return e===null?false:typeof e=="function"||e instanceof Function},isString:function(e){return e===""?true:e?typeof e=="string"||e instanceof String:false},isDomNode:function(e){return e&&typeof e=="object"&&"nodeType"in e},isDate:function(e){return e&&Object.prototype.toString.call(e)=="[object Date]"},buildQueryString:function(e){var t="";for(var n in e){if(!e.hasOwnProperty(n)){continue}var i=e[n];if(this.isArray(i)){i.forEach((function(e,i){t+=encodeURIComponent(n+"["+i+"]")+"="+encodeURIComponent(e)+"&"}))}else{t+=encodeURIComponent(n)+"="+encodeURIComponent(i)+"&"}}if(t.length>0){t=t.substr(0,t.length-1)}return t},clone:function(e,t){var n,i,r;if(t!==false)t=true;if(e===null)return null;if(this.isDomNode(e)){n=e.cloneNode(t)}else if(typeof e=="object"){if(this.isArray(e)){n=[];for(i=0,r=e.length;i<r;i++){if(typeof e[i]=="object"&&t)n[i]=this.clone(e[i],t);else n[i]=e[i]}}else{n={};if(e.constructor){if(this.isDate(e))n=new Date(e);else n=new e.constructor}for(i in e){if(typeof e[i]=="object"&&t)n[i]=this.clone(e[i],t);else n[i]=e[i]}}}else{n=e}return n}};var i=function(t){var s=!!t.callback&&n.isFunction(t.callback);var o=typeof e.Promise==="undefined"||s?null:new e.Promise;var a=t.sendCallback||function(){};var l=t.withoutRestoringCsrf||false;var u=t.loginAttempt||0;var c=i.xhr();var f=t.endpoint+"/"+i.escape(t.method)+".json"+(t.logTag?"?logTag="+t.logTag:"");c.open("POST",f);c.setRequestHeader("Content-Type","application/x-www-form-urlencoded");if(t.cors){c.withCredentials=true}var d=false;c.onprogress=function(){};c.ontimeout=function(){};c.timeout=0;c.onload=function(){if(d)return;c.onload=function(){};var n=i.isSuccess(c);var a=c.status;if(n){var f=c.responseText;if(f.length>0){try{f=JSON.parse(f)}catch(e){n=false}}if(a==401){if(f.extended_error==="user_not_authorized"&&u===0){if(f.sessid){console.warn("BX.rest: csrf-token has expired, replace to a new token");e.message({bitrix_sessid:f.sessid})}if("BXDesktopSystem"in window){console.warn("BX.rest: you are not authorized, trying to log in");t.loginAttempt=1;BXDesktopSystem.Login({success:function(){console.warn("BX.rest: successfully logged in, repeating request");if(!s){t.callback=function(e){if(e.error()){o.reject(e)}else{o.fulfill(e)}}}i(t)}});return true}}else if(f.sessid&&!l){e.message({bitrix_sessid:f.sessid});console.warn("BX.rest: your csrf-token has expired, send query with a new token");t.withoutRestoringCsrf=true;if(!s){t.callback=function(e){if(e.error()){o.reject(e)}else{o.fulfill(e)}}}i(t);return true}}else if(a==0){f={result:{},error:"ERROR_NETWORK",error_description:"A network error occurred while the request was being executed."}}else{if(a==200){if(f.length<=0){f={result:{},error:"BLANK_ANSWER",error_description:"Empty answer with correct http code, network error possible."}}}else if(f.length<=0){f={result:{},error:"BLANK_ANSWER_WITH_ERROR_CODE",error_description:"Empty answer with error http code: "+a}}}}c=null;if(n){var h=new r(f,t,a);if(s){t.callback.apply(window,[h])}else{if(h.error()){o.reject(h)}else{o.fulfill(h)}}}else{var h=new r({error:"ERROR_UNEXPECTED_ANSWER",error_description:"Server returned an unexpected response.",ex:{}},t,0);if(s){t.callback.apply(window,[h])}else{o.reject(h)}}};c.onerror=function(e){var n=new r({error:"ERROR_NETWORK",error_description:"A network error occurred while the request was being executed.",ex:e},t,0);if(s){t.callback.apply(window,[n])}else{o.reject(n)}};var h="";if(t.queryParams){h=n.buildQueryString(t.queryParams)}else if(typeof e.bitrix_sessid!=="undefined"){h="sessid="+e.bitrix_sessid()}if(typeof t.start!=="undefined"){h+="&start="+parseInt(t.start)}if(!!t.data){i.prepareData(t.data,"",(function(e){h+="&"+e;c.send(h);a(c)}))}else{c.send(h);a(c)}return s||!o?c:o};i.batch=function(e,t,s,o,a,l,u,c){return i({method:"batch",data:{halt:!!s?1:0,cmd:e},callback:function(i,s,o){if(!t){return false}var c=i.error();var f=i.data();var d=n.isArray(e)?[]:{};for(var h in e){if(!!e[h]&&e.hasOwnProperty(h)){if(n.isString(e[h])){var p=e[h].split("?")}else{p=[n.isArray(e[h])?e[h][0]:e[h].method,n.isArray(e[h])?e[h][1]:e[h].data]}if(f&&typeof f.result!=="undefined"&&(typeof f.result[h]!=="undefined"||typeof f.result_error[h]!=="undefined")){d[h]=new r({result:typeof f.result[h]!=="undefined"?f.result[h]:{},error:f.result_error[h]||undefined,total:f.result_total[h],time:f.result_time[h],next:f.result_next[h]},{method:p[0],data:p[1],callback:t,endpoint:a,queryParams:l,cors:u},i.status)}else if(c){d[h]=new r({result:{},error:c.ex,total:0},{method:p[0],data:p[1],callback:t,endpoint:a,queryParams:l,cors:u},i.status)}}}t.apply(window,[d])},sendCallback:o,endpoint:a,queryParams:l,cors:u,logTag:c})};i.xhr=function(){return new XMLHttpRequest};i.escape=function(e){return encodeURIComponent(e)};i.prepareData=function(e,t,r){var s="",o=[];if(n.isString(e)||e===null){r.call(document,e||"")}else{for(var l in e){if(!e.hasOwnProperty(l)){continue}var u=i.escape(l);if(t)u=t+"["+u+"]";if(typeof e[l]==="object"){if(n.isArray(e[l])&&e[l].length<=0){continue}o.push([u,e[l]])}else{if(s.length>0){s+="&"}if(typeof e[l]==="boolean"){s+=u+"="+(e[l]?1:0)}else{s+=u+"="+i.escape(e[l])}}}var c=o.length;if(c>0){var f=function(e){s+=(!!e?"&":"")+e;if(--c<=0){r.call(document,s)}};var d=c;for(var l=0;l<d;l++){if(n.isDomNode(o[l][1])){if(o[l][1].tagName.toUpperCase()==="INPUT"&&o[l][1].type==="file"){if(a.canUse()){a(o[l][1],function(e){return function(t){if(n.isArray(t)&&t.length>0){f(e+"[0]="+i.escape(t[0])+"&"+e+"[1]="+i.escape(t[1]))}else{f(e+"=")}}}(o[l][0]))}}else if(typeof o[l][1].value!=="undefined"){f(o[l][0]+"="+i.escape(o[l][1].value))}else{f("")}}else if(n.isDate(o[l][1])){f(o[l][0]+"="+i.escape(o[l][1].toJSON()))}else if(n.isArray(o[l][1])&&o[l][1].length<=0){f(o[l][0]+"=")}else{i.prepareData(o[l][1],o[l][0],f)}}}else{r.call(document,s)}}};i.isSuccess=function(e){return typeof e.status==="undefined"||e.status>=200&&e.status<300||e.status===304||e.status>=400&&e.status<500||e.status===1223||e.status===0};var r=function(e,t,i){this.answer=e;this.query=n.clone(t);this.status=i;if(typeof this.answer.next!=="undefined"){this.answer.next=parseInt(this.answer.next)}if(typeof this.answer.error!=="undefined"){this.answer.ex=new s(this.status,typeof this.answer.error==="string"?this.answer:this.answer.error)}};r.prototype.data=function(){return this.answer.result};r.prototype.time=function(){return this.answer.time};r.prototype.error=function(){return this.answer.ex};r.prototype.error_description=function(){return this.answer.error_description};r.prototype.more=function(){return!isNaN(this.answer.next)};r.prototype.total=function(){return parseInt(this.answer.total)};r.prototype.next=function(e){if(this.more()){this.query.start=this.answer.next;if(!!e&&n.isFunction(e)){this.query.callback=e}return i(this.query)}return false};var s=function(e,t){this.status=e;this.ex=t};s.prototype.getError=function(){return this.ex};s.prototype.getStatus=function(){return this.status};s.prototype.toString=function(){return this.ex.error+(!!this.ex.error_description?": "+this.ex.error_description:"")+" ("+this.status+")"};var o=function(e){var t=new Uint8Array(e);var n="";if(typeof t.forEach==="function"){t.forEach((function(e){n+=String.fromCharCode(e)}))}else{var i=t.length;for(var r=0;r<i;r+=1){n+=String.fromCharCode(t[r])}}return btoa(n)};var a=function(e,t){if(a.canUse()){var n=e.files,i=0,r=e.multiple?[]:null;for(var s=0,l;l=n[s];s++){var u=new window.FileReader;u.BXFILENAME=n[s].name;u.onload=function(e){e=e||window.event;var n=[this.BXFILENAME,o(e.target.result)];if(r===null)r=n;else r.push(n);if(--i<=0){t(r)}};u.readAsArrayBuffer(l)}i=s;if(i<=0){t(r)}}};a.canUse=function(){return!!window.FileReader}})();(function(){if(!window.BX){window.BX={}}else if(window.BX.PullClient){return}else if(!window.BX.RestClient){return}const e=window.BX;const t=window.protobuf;const n=19;const i=60;const r=30*60;const s=24*60*60;const o=6e4;const a=10;const l="bx-pull-session";const u=20;const c={WebSocket:"webSocket",LongPolling:"longPolling"};const f={Online:"online",Offline:"offline",Connecting:"connect"};const d={Unknown:0,Client:1,Backend:2};const h={Server:"server",Client:"client",Online:"online",Status:"status",Revision:"revision"};const p={NORMAL_CLOSURE:1e3,SERVER_DIE:1001,CONFIG_REPLACED:3e3,CHANNEL_EXPIRED:3001,SERVER_RESTARTED:3002,CONFIG_EXPIRED:3003,MANUAL:3004,WRONG_CHANNEL_ID:4010};const m={CHANNEL_EXPIRE:"CHANNEL_EXPIRE",CONFIG_EXPIRE:"CONFIG_EXPIRE",SERVER_RESTART:"SERVER_RESTART"};const g={Shared:"shared",Personal:"personal"};const v={api:{},channels:{},publicChannels:{},server:{timeShift:0},clientId:null,jwt:null};const y=t.roots["push-server"]["Response"];const b=t.roots["push-server"]["ResponseBatch"];const w=t.roots["push-server"]["Request"];const S=t.roots["push-server"]["RequestBatch"];const I=t.roots["push-server"]["IncomingMessagesRequest"];const k=t.roots["push-server"]["IncomingMessage"];const C=t.roots["push-server"]["Receiver"];const E="2.0";const _="ping";const x="pong";const T=5;const O={Parse:{code:-32700,message:"Parse error"},InvalidRequest:{code:-32600,message:"Invalid Request"},MethodNotFound:{code:-32601,message:"Method not found"},InvalidParams:{code:-32602,message:"Invalid params"},Internal:{code:-32603,message:"Internal error"}};const M={Publish:"publish",Subscribe:"subscribe"};const D={StatusChange:"internal:user_status"};class A{constructor(t){t=t||{};if(t.restApplication){if(typeof t.configGetMethod==="undefined"){t.configGetMethod="pull.application.config.get"}if(typeof t.skipCheckRevision==="undefined"){t.skipCheckRevision=true}if(typeof t.restApplication==="string"){t.siteId=t.restApplication}t.serverEnabled=true}this.context="master";this.guestMode=t.guestMode?t.guestMode:typeof e.message!=="undefined"&&e.message.pull_guest_mode?e.message.pull_guest_mode==="Y":false;this.guestUserId=t.guestUserId?t.guestUserId:typeof e.message!=="undefined"&&e.message.pull_guest_user_id?parseInt(e.message.pull_guest_user_id,10):0;if(this.guestMode&&this.guestUserId){this.userId=this.guestUserId}else{this.userId=t.userId?t.userId:typeof e.message!=="undefined"&&e.message.USER_ID?e.message.USER_ID:0}this.siteId=t.siteId?t.siteId:typeof e.message!=="undefined"&&e.message.SITE_ID?e.message.SITE_ID:"none";this.restClient=typeof t.restClient!=="undefined"?t.restClient:new e.RestClient(this.getRestClientOptions());this.enabled=typeof t.serverEnabled!=="undefined"?t.serverEnabled==="Y"||t.serverEnabled===true:typeof e.message!=="undefined"&&e.message.pull_server_enabled==="Y";this.unloading=false;this.starting=false;this.debug=false;this.connectionAttempt=0;this.connectionType=c.WebSocket;this.reconnectTimeout=null;this.restartTimeout=null;this.restoreWebSocketTimeout=null;this.configGetMethod=typeof t.configGetMethod!=="string"?"pull.config.get":t.configGetMethod;this.getPublicListMethod=typeof t.getPublicListMethod!=="string"?"pull.channel.public.list":t.getPublicListMethod;this.skipStorageInit=t.skipStorageInit===true;this.skipCheckRevision=t.skipCheckRevision===true;this._subscribers={};this.watchTagsQueue={};this.watchUpdateInterval=174e4;this.watchForceUpdateInterval=5e3;if(typeof t.configTimestamp!=="undefined"){this.configTimestamp=t.configTimestamp}else if(typeof e.message!=="undefined"&&e.message.pull_config_timestamp){this.configTimestamp=e.message.pull_config_timestamp}else{this.configTimestamp=0}this.session={mid:null,tag:null,time:null,history:{},lastMessageIds:[],messageCount:0};this._connectors={webSocket:null,longPolling:null};this.isSecure=document.location.href.indexOf("https")===0;this.config=null;this.storage=null;if(this.userId&&!this.skipStorageInit){this.storage=new N({userId:this.userId,siteId:this.siteId})}this.sharedConfig=new P({onWebSocketBlockChanged:this.onWebSocketBlockChanged.bind(this),storage:this.storage});this.channelManager=new j({restClient:this.restClient,getPublicListMethod:this.getPublicListMethod});this.notificationPopup=null;this.checkInterval=null;this.offlineTimeout=null;this.pingWaitTimeout=null;this.isManualDisconnect=false;this.loggingEnabled=this.sharedConfig.isLoggingEnabled();this.onPingTimeoutHandler=this.onPingTimeout.bind(this)}get connector(){return this._connectors[this.connectionType]}subscribe(e){if(!e){console.error(U.getDateForLog()+": Pull.subscribe: params for subscribe function is invalid. ");return function(){}}if(!U.isPlainObject(e)){return this.attachCommandHandler(e)}e=e||{};e.type=e.type||h.Server;e.command=e.command||null;if(e.type==h.Server||e.type==h.Client){if(typeof this._subscribers[e.type]==="undefined"){this._subscribers[e.type]={}}if(typeof this._subscribers[e.type][e.moduleId]==="undefined"){this._subscribers[e.type][e.moduleId]={callbacks:[],commands:{}}}if(e.command){if(typeof this._subscribers[e.type][e.moduleId]["commands"][e.command]==="undefined"){this._subscribers[e.type][e.moduleId]["commands"][e.command]=[]}this._subscribers[e.type][e.moduleId]["commands"][e.command].push(e.callback);return function(){this._subscribers[e.type][e.moduleId]["commands"][e.command]=this._subscribers[e.type][e.moduleId]["commands"][e.command].filter((t=>t!==e.callback))}.bind(this)}else{this._subscribers[e.type][e.moduleId]["callbacks"].push(e.callback);return function(){this._subscribers[e.type][e.moduleId]["callbacks"]=this._subscribers[e.type][e.moduleId]["callbacks"].filter((t=>t!==e.callback))}.bind(this)}}else{if(typeof this._subscribers[e.type]==="undefined"){this._subscribers[e.type]=[]}this._subscribers[e.type].push(e.callback);return function(){this._subscribers[e.type]=this._subscribers[e.type].filter((t=>t!==e.callback))}.bind(this)}}attachCommandHandler(e){if(typeof e.getModuleId!=="function"||typeof e.getModuleId()!=="string"){console.error(U.getDateForLog()+": Pull.attachCommandHandler: result of handler.getModuleId() is not a string.");return function(){}}let t=h.Server;if(typeof e.getSubscriptionType==="function"){t=e.getSubscriptionType()}return this.subscribe({type:t,moduleId:e.getModuleId(),callback:function(t){let n=null;if(typeof e.getMap==="function"){const i=e.getMap();if(i&&typeof i==="object"){if(typeof i[t.command]==="function"){n=i[t.command].bind(e)}else if(typeof i[t.command]==="string"&&typeof e[i[t.command]]==="function"){n=e[i[t.command]].bind(e)}}}if(!n){const i="handle"+t.command.charAt(0).toUpperCase()+t.command.slice(1);if(typeof e[i]==="function"){n=e[i].bind(e)}}if(n){if(this.debug&&this.context!=="master"){console.warn(U.getDateForLog()+": Pull.attachCommandHandler: receive command",t)}n(t.params,t.extra,t.command)}}.bind(this)})}emit(e){e=e||{};if(e.type==h.Server||e.type==h.Client){if(typeof this._subscribers[e.type]==="undefined"){this._subscribers[e.type]={}}if(typeof this._subscribers[e.type][e.moduleId]==="undefined"){this._subscribers[e.type][e.moduleId]={callbacks:[],commands:{}}}if(this._subscribers[e.type][e.moduleId]["callbacks"].length>0){this._subscribers[e.type][e.moduleId]["callbacks"].forEach((function(t){t(e.data,{type:e.type,moduleId:e.moduleId})}))}if(this._subscribers[e.type][e.moduleId]["commands"][e.data.command]&&this._subscribers[e.type][e.moduleId]["commands"][e.data.command].length>0){this._subscribers[e.type][e.moduleId]["commands"][e.data.command].forEach((function(t){t(e.data.params,e.data.extra,e.data.command,{type:e.type,moduleId:e.moduleId})}))}return true}else{if(typeof this._subscribers[e.type]==="undefined"){this._subscribers[e.type]=[]}if(this._subscribers[e.type].length<=0){return true}this._subscribers[e.type].forEach((function(t){t(e.data,{type:e.type})}));return true}}init(){this._connectors.webSocket=new R({parent:this,onOpen:this.onWebSocketOpen.bind(this),onMessage:this.onIncomingMessage.bind(this),onDisconnect:this.onWebSocketDisconnect.bind(this),onError:this.onWebSocketError.bind(this)});this._connectors.longPolling=new H({parent:this,onOpen:this.onLongPollingOpen.bind(this),onMessage:this.onIncomingMessage.bind(this),onDisconnect:this.onLongPollingDisconnect.bind(this),onError:this.onLongPollingError.bind(this)});this.connectionType=this.isWebSocketAllowed()?c.WebSocket:c.LongPolling;window.addEventListener("beforeunload",this.onBeforeUnload.bind(this));window.addEventListener("offline",this.onOffline.bind(this));window.addEventListener("online",this.onOnline.bind(this));if(e&&e.addCustomEvent){e.addCustomEvent("BXLinkOpened",this.connect.bind(this))}if(e&&e.desktop){e.addCustomEvent("onDesktopReload",(()=>{this.session.mid=null;this.session.tag=null;this.session.time=null}));e.desktop.addCustomEvent("BXLoginSuccess",(()=>this.restart(1e3,"Desktop login")))}this.jsonRpcAdapter=new B({connector:this._connectors.webSocket,handlers:{"incoming.message":this.handleRpcIncomingMessage.bind(this)}})}start(t){let n=true;if(this.isConnected()){return Promise.resolve(true)}if(this.starting&&this._startingPromise){return this._startingPromise}if(!this.userId&&typeof e.message!=="undefined"&&e.message.USER_ID){this.userId=e.message.USER_ID;if(!this.storage){this.storage=new N({userId:this.userId,siteId:this.siteId})}}if(this.siteId==="none"&&typeof e.message!=="undefined"&&e.message.SITE_ID){this.siteId=e.message.SITE_ID}let i=false;if(U.isPlainObject(t)){if(typeof t.skipReconnectToLastSession!=="undefined"){i=!!t.skipReconnectToLastSession;delete t.skipReconnectToLastSession}this.config=t;n=false}if(!this.enabled){return Promise.reject({ex:{error:"PULL_DISABLED",error_description:"Push & Pull server is disabled"}})}const r=(new Date).getTime();let s;if(!i&&this.storage){s=this.storage.get(l)}if(U.isPlainObject(s)&&s.hasOwnProperty("ttl")&&s.ttl>=r){this.session.mid=s.mid}this.starting=true;return new Promise(((e,t)=>{this._startingPromise={resolve:e,reject:t};this.loadConfig().then((i=>{this.setConfig(i,n);this.init();this.updateWatch();this.startCheckConfig();this.connect().then((()=>e(true)),(e=>t(e)))}),(e=>{this.starting=false;this.sendPullStatus(f.Offline);this.stopCheckConfig();console.error(U.getDateForLog()+": Pull: could not read push-server config. ",e);t(e)}))}))}getRestClientOptions(){let e={};if(this.guestMode&&this.guestUserId!==0){e.queryParams={pull_guest_id:this.guestUserId}}return e}setLastMessageId(e){this.session.mid=e}setPublicIds(e){return this.channelManager.setPublicIds(e)}sendMessage(e,t,n,i,r){const s={userList:e,body:{module_id:t,command:n,params:i},expiry:r};if(this.isJsonRpc()){return this.jsonRpcAdapter.executeOutgoingRpcCommand(M.Publish,s)}else{return this.sendMessageBatch([s])}}sendMessageToChannels(e,t,n,i,r){const s={channelList:e,body:{module_id:t,command:n,params:i},expiry:r};if(this.isJsonRpc()){return this.jsonRpcAdapter.executeOutgoingRpcCommand("publish",s)}else{return this.sendMessageBatch([s])}}sendMessageBatch(e){if(!this.isPublishingEnabled()){console.error("Client publishing is not supported or is disabled");return false}if(this.isJsonRpc()){let t=this.jsonRpcAdapter.createPublishRequest(e);return this.connector.send(JSON.stringify(t))}else{let t={};for(let n=0;n<e.length;n++){if(e[n].users){for(let i=0;i<e[n].users.length;i++){t[e[n].users[i]]=true}}}this.channelManager.getPublicIds(Object.keys(t)).then((t=>this.connector.send(this.encodeMessageBatch(e,t))))}}encodeMessageBatch(t,n){let i=[];t.forEach((function(t){const r=t.body;let s;if(t.userList){s=this.createMessageReceivers(t.userList,n)}else{s=[]}if(t.channelList){if(!e.type.isArray(t.channelList)){throw new Error("messageFields.publicChannels must be an array")}t.channelList.forEach(function(e){let t;let n;if(typeof e==="string"&&e.includes(".")){const i=e.toString().split(".");t=i[0];n=i[1]}else if(typeof e==="object"&&"publicId"in e&&"signature"in e){t=e.publicId;n=e.signature}else{throw new Error("Public channel MUST be either a string, formatted like \"{publicId}.{signature}\" or an object with fields 'publicId' and 'signature'")}s.push(C.create({id:this.encodeId(t),signature:this.encodeId(n)}))}.bind(this))}const o=k.create({receivers:s,body:JSON.stringify(r),expiry:t.expiry||0});i.push(o)}),this);const r=S.create({requests:[{incomingMessages:{messages:i}}]});return S.encode(r).finish()}createMessageReceivers(e,t){let n=[];for(let i=0;i<e.length;i++){let r=e[i];if(!t[r]||!t[r].publicId){throw new Error("Could not determine public id for user "+r)}n.push(C.create({id:this.encodeId(t[r].publicId),signature:this.encodeId(t[r].signature)}))}return n}subscribeUserStatusChange(){return this.executeSubscribeCommand([D.StatusChange])}executeSubscribeCommand(e){return this.jsonRpcAdapter.executeOutgoingRpcCommand(M.Subscribe,{channelList:e})}getUsersLastSeen(e){return this.jsonRpcAdapter.executeOutgoingRpcCommand("getUsersLastSeen",{userList:e})}scheduleRestart(e,t,n){clearTimeout(this.restartTimeout);if(!n||n<1){n=Math.ceil(Math.random()*30)+5}this.restartTimeout=setTimeout((()=>this.restart(e,t)),n)}restart(t,n){if(!t){t=p.NORMAL_CLOSURE}clearTimeout(this.restartTimeout);console.warn(U.getDateForLog()+": Pull: restarting with code "+t);this.disconnect(t,n);if(this.storage){this.storage.remove("bx-pull-config")}this.config=null;this.loadConfig().catch((t=>{console.error(U.getDateForLog()+": Pull: could not read push-server config",t);this.sendPullStatus(f.Offline);clearTimeout(this.reconnectTimeout);if(t.status==401||t.status==403){this.stopCheckConfig();if(e&&e.onCustomEvent){e.onCustomEvent(window,"onPullError",["AUTHORIZE_ERROR"])}}})).then((e=>{this.setConfig(e,true);this.updateWatch();this.startCheckConfig();return this.connect()})).catch((e=>{console.error(e)}))}loadConfig(){if(!this.config){this.config=Object.assign({},v);let e;if(this.storage){e=this.storage.get("bx-pull-config")}if(this.isConfigActual(e)&&this.checkRevision(e.api.revision_web)){return Promise.resolve(e)}else if(this.storage){this.storage.remove("bx-pull-config")}}else if(this.isConfigActual(this.config)&&this.checkRevision(this.config.api.revision_web)){return Promise.resolve(this.config)}else{this.config=Object.assign({},v)}return new Promise(((e,t)=>{this.restClient.callMethod(this.configGetMethod,{CACHE:"N"}).then((t=>{const n=t.data();let i;i=Math.floor((U.getTimestamp()-new Date(n.serverTime).getTime())/1e3);delete n.serverTime;let r=Object.assign({},n);r.server.timeShift=i;e(r)})).catch((e=>{const n=e.error();if(n.getError().error=="AUTHORIZE_ERROR"||n.getError().error=="WRONG_AUTH_TYPE"){n.status=403}t(n)}))}))}isConfigActual(e){if(!U.isPlainObject(e)){return false}if(e.server.config_timestamp<this.configTimestamp){return false}const t=new Date;const n=Object.keys(e.channels).length;if(n===0){return false}for(let n in e.channels){if(!e.channels.hasOwnProperty(n)){continue}const i=e.channels[n];const r=new Date(i.end);if(r<t){return false}}return true}startCheckConfig(){if(this.checkInterval){clearInterval(this.checkInterval)}this.checkInterval=setInterval(this.checkConfig.bind(this),o)}stopCheckConfig(){if(this.checkInterval){clearInterval(this.checkInterval)}this.checkInterval=null}checkConfig(){if(this.isConfigActual(this.config)){if(!this.checkRevision(this.config.api.revision_web)){return false}}else{this.logToConsole("Stale config detected. Restarting");this.restart(p.CONFIG_EXPIRED,"Config update required")}}setConfig(e,t){for(let t in e){if(e.hasOwnProperty(t)&&this.config.hasOwnProperty(t)){this.config[t]=e[t]}}if(e.publicChannels){this.setPublicIds(U.objectValues(e.publicChannels))}if(this.storage&&t){try{this.storage.set("bx-pull-config",e)}catch(e){if(localStorage&&localStorage.removeItem){localStorage.removeItem("history")}console.error(U.getDateForLog()+" Pull: Could not cache config in local storage. Error: ",e)}}}isWebSocketSupported(){return typeof window.WebSocket!=="undefined"}isWebSocketAllowed(){if(this.sharedConfig.isWebSocketBlocked()){return false}return this.isWebSocketEnabled()}isWebSocketEnabled(){if(!this.isWebSocketSupported()){return false}return this.config&&this.config.server&&this.config.server.websocket_enabled===true}isPublishingSupported(){return this.getServerVersion()>3}isPublishingEnabled(){if(!this.isPublishingSupported()){return false}return this.config&&this.config.server&&this.config.server.publish_enabled===true}isProtobufSupported(){return this.getServerVersion()==4&&!U.browser.IsIe()}isJsonRpc(){return this.getServerVersion()>=5}isSharedMode(){return this.getServerMode()==g.Shared}disconnect(e,t){if(this.connector){this.isManualDisconnect=true;this.connector.disconnect(e,t)}}stop(e,t){this.disconnect(e,t);this.stopCheckConfig()}reconnect(e,t,n){this.disconnect(e,t);n=n||1;this.scheduleReconnect(n)}restoreWebSocketConnection(){if(this.connectionType==c.WebSocket){return true}this._connectors.webSocket.connect()}scheduleReconnect(e){if(!this.enabled){return false}if(!e){if(this.connectionAttempt>3&&this.connectionType===c.WebSocket&&!this.sharedConfig.isLongPollingBlocked()){this.sharedConfig.setWebSocketBlocked(true);this.connectionType=c.LongPolling;this.connectionAttempt=1;e=1}else{e=this.getConnectionAttemptDelay(this.connectionAttempt)}}if(this.reconnectTimeout){clearTimeout(this.reconnectTimeout)}this.logToConsole("Pull: scheduling reconnection in "+e+" seconds; attempt # "+this.connectionAttempt);this.reconnectTimeout=setTimeout((()=>{this.connect().catch((e=>{console.error(e)}))}),e*1e3)}scheduleRestoreWebSocketConnection(){this.logToConsole("Pull: scheduling restoration of websocket connection in "+r+" seconds");if(this.restoreWebSocketTimeout){return}this.restoreWebSocketTimeout=setTimeout((()=>{this.restoreWebSocketTimeout=0;this.restoreWebSocketConnection()}),r*1e3)}connect(){if(!this.enabled){return Promise.reject()}if(this.connector.connected){return Promise.resolve()}if(this.reconnectTimeout){clearTimeout(this.reconnectTimeout)}this.sendPullStatus(f.Connecting);this.connectionAttempt++;return new Promise(((e,t)=>{this._connectPromise={resolve:e,reject:t};this.connector.connect()}))}onIncomingMessage(e){if(this.isJsonRpc()){e===_?this.onJsonRpcPing():this.jsonRpcAdapter.parseJsonRpcMessage(e)}else{const t=this.extractMessages(e);this.handleIncomingEvents(t)}}handleRpcIncomingMessage(e){this.session.mid=e.mid;let t=e.body;if(!e.body.extra){t.extra={}}t.extra.sender=e.sender;if("user_params"in e&&U.isPlainObject(e.user_params)){Object.assign(t.params,e.user_params)}if("dictionary"in e&&U.isPlainObject(e.dictionary)){Object.assign(t.params,e.dictionary)}if(this.checkDuplicate(e.mid)){this.addMessageToStat(t);this.trimDuplicates();this.broadcastMessage(t)}this.connector.send(`mack:${e.mid}`);return{}}onJsonRpcPing(){this.updatePingWaitTimeout();this.connector.send(x)}handleIncomingEvents(e){let t=[];if(e.length===0){this.session.mid=null;return}for(let n=0;n<e.length;n++){let i=e[n];this.updateSessionFromEvent(i);if(i.mid&&!this.checkDuplicate(i.mid)){continue}this.addMessageToStat(i.text);t.push(i.text)}this.trimDuplicates();this.broadcastMessages(t)}updateSessionFromEvent(e){this.session.mid=e.mid||null;this.session.tag=e.tag||null;this.session.time=e.time||null}checkDuplicate(e){if(this.session.lastMessageIds.includes(e)){console.warn("Duplicate message "+e+" skipped");return false}else{this.session.lastMessageIds.push(e);return true}}trimDuplicates(){if(this.session.lastMessageIds.length>a){this.session.lastMessageIds=this.session.lastMessageIds.slice(-a)}}addMessageToStat(e){if(!this.session.history[e.module_id]){this.session.history[e.module_id]={}}if(!this.session.history[e.module_id][e.command]){this.session.history[e.module_id][e.command]=0}this.session.history[e.module_id][e.command]++;this.session.messageCount++}extractMessages(e){if(e instanceof ArrayBuffer){return this.extractProtobufMessages(e)}else if(U.isNotEmptyString(e)){return this.extractPlainTextMessages(e)}}extractProtobufMessages(e){let t=[];try{let n=b.decode(new Uint8Array(e));for(let e=0;e<n.responses.length;e++){let i=n.responses[e];if(i.command!="outgoingMessages"){continue}let r=i.outgoingMessages.messages;for(let e=0;e<r.length;e++){const n=r[e];let i;try{i=JSON.parse(n.body)}catch(e){console.error(U.getDateForLog()+": Pull: Could not parse message body",e);continue}if(!i.extra){i.extra={}}i.extra.sender={type:n.sender.type};if(n.sender.id instanceof Uint8Array){i.extra.sender.id=this.decodeId(n.sender.id)}const s={mid:this.decodeId(n.id),text:i};t.push(s)}}}catch(e){console.error(U.getDateForLog()+": Pull: Could not parse message",e)}return t}extractPlainTextMessages(e){let t=[];const n=e.match(/#!NGINXNMS!#(.*?)#!NGINXNME!#/gm);if(n===null){text="\n========= PULL ERROR ===========\n"+"Error type: parseResponse error parsing message\n"+"\n"+"Data string: "+e+"\n"+"================================\n\n";console.warn(text);return t}for(let e=0;e<n.length;e++){n[e]=n[e].substring(12,n[e].length-12);if(n[e].length<=0){continue}let i;try{i=JSON.parse(n[e])}catch(e){continue}t.push(i)}return t}decodeId(e){if(!(e instanceof Uint8Array)){throw new Error("encodedId should be an instance of Uint8Array")}let t="";for(let n=0;n<e.length;n++){const i=e[n].toString(16);if(i.length===1){t+="0"}t+=i}return t}encodeId(e){if(!e){return new Uint8Array}let t=[];for(let n=0;n<e.length;n+=2){t.push(parseInt(e.substr(n,2),16))}return new Uint8Array(t)}broadcastMessages(e){e.forEach((e=>this.broadcastMessage(e)))}broadcastMessage(t){const n=t.module_id=t.module_id.toLowerCase();const i=t.command;if(!t.extra){t.extra={}}if(t.extra.server_time_unix){t.extra.server_time_ago=(U.getTimestamp()-t.extra.server_time_unix*1e3)/1e3-(this.config.server.timeShift?this.config.server.timeShift:0);t.extra.server_time_ago=t.extra.server_time_ago>0?t.extra.server_time_ago:0}this.logMessage(t);try{if(t.extra.sender&&t.extra.sender.type===d.Client){if(typeof e.onCustomEvent!=="undefined"){e.onCustomEvent(window,"onPullClientEvent-"+n,[i,t.params,t.extra],true);e.onCustomEvent(window,"onPullClientEvent",[n,i,t.params,t.extra],true)}this.emit({type:h.Client,moduleId:n,data:{command:i,params:U.clone(t.params),extra:U.clone(t.extra)}})}else if(n==="pull"){this.handleInternalPullEvent(i,t)}else if(n=="online"){if(t.extra.server_time_ago<240){if(typeof e.onCustomEvent!=="undefined"){e.onCustomEvent(window,"onPullOnlineEvent",[i,t.params,t.extra],true)}this.emit({type:h.Online,data:{command:i,params:U.clone(t.params),extra:U.clone(t.extra)}})}}else{if(typeof e.onCustomEvent!=="undefined"){e.onCustomEvent(window,"onPullEvent-"+n,[i,t.params,t.extra],true);e.onCustomEvent(window,"onPullEvent",[n,i,t.params,t.extra],true)}this.emit({type:h.Server,moduleId:n,data:{command:i,params:U.clone(t.params),extra:U.clone(t.extra)}})}}catch(n){if(typeof console=="object"){console.warn("\n========= PULL ERROR ===========\n"+"Error type: broadcastMessages execute error\n"+"Error event: ",n,"\n"+"Message: ",t,"\n"+"================================\n");if(typeof e.debug!=="undefined"){e.debug(n)}}}if(t.extra&&t.extra.revision_web){this.checkRevision(t.extra.revision_web)}}logToConsole(e){if(this.loggingEnabled){console.log(U.getDateForLog()+": "+e)}}logMessage(e){if(!this.debug){return}if(e.extra.sender&&e.extra.sender.type===d.Client){console.info("onPullClientEvent-"+e.module_id,e.command,e.params,e.extra)}else if(e.moduleId=="online"){console.info("onPullOnlineEvent",e.command,e.params,e.extra)}else{console.info("onPullEvent",e.module_id,e.command,e.params,e.extra)}}onLongPollingOpen(){this.unloading=false;this.starting=false;this.connectionAttempt=0;this.isManualDisconnect=false;this.sendPullStatus(f.Online);if(this.offlineTimeout){clearTimeout(this.offlineTimeout);this.offlineTimeout=null}this.logToConsole("Pull: Long polling connection with push-server opened");if(this.isWebSocketEnabled()){this.scheduleRestoreWebSocketConnection()}if(this._connectPromise){this._connectPromise.resolve()}}onWebSocketBlockChanged(e){const t=e.isWebSocketBlocked;if(t&&this.connectionType===c.WebSocket&&!this.isConnected()){clearTimeout(this.reconnectTimeout);this.connectionAttempt=0;this.connectionType=c.LongPolling;this.scheduleReconnect(1)}else if(!t&&this.connectionType===c.LongPolling){clearTimeout(this.reconnectTimeout);clearTimeout(this.restoreWebSocketTimeout);this.connectionAttempt=0;this.connectionType=c.WebSocket;this.scheduleReconnect(1)}}onWebSocketOpen(){this.unloading=false;this.starting=false;this.connectionAttempt=0;this.isManualDisconnect=false;this.sendPullStatus(f.Online);this.sharedConfig.setWebSocketBlocked(false);this.sharedConfig.setLongPollingBlocked(true);if(this.connectionType==c.LongPolling){this.connectionType=c.WebSocket;this._connectors.longPolling.disconnect()}if(this.offlineTimeout){clearTimeout(this.offlineTimeout);this.offlineTimeout=null}if(this.restoreWebSocketTimeout){clearTimeout(this.restoreWebSocketTimeout);this.restoreWebSocketTimeout=null}this.logToConsole("Pull: Websocket connection with push-server opened");if(this._connectPromise){this._connectPromise.resolve()}}onWebSocketDisconnect(e){if(this.connectionType===c.WebSocket){if(e.code!=p.CONFIG_EXPIRED&&e.code!=p.CHANNEL_EXPIRED&&e.code!=p.CONFIG_REPLACED){this.sendPullStatus(f.Offline)}else{this.offlineTimeout=setTimeout((()=>this.sendPullStatus(f.Offline)),5e3)}}if(!e){e={}}this.logToConsole("Pull: Websocket connection with push-server closed. Code: "+e.code+", reason: "+e.reason);if(!this.isManualDisconnect){if(e.code==p.WRONG_CHANNEL_ID){this.scheduleRestart(p.WRONG_CHANNEL_ID,"restarting to reload config")}else{this.scheduleReconnect()}}this.sharedConfig.setLongPollingBlocked(true);this.isManualDisconnect=false;this.clearPingWaitTimeout()}onWebSocketError(e){this.starting=false;if(this.connectionType===c.WebSocket){this.sendPullStatus(f.Offline)}console.error(U.getDateForLog()+": Pull: WebSocket connection error",e);this.scheduleReconnect();if(this._connectPromise){this._connectPromise.reject()}this.clearPingWaitTimeout()}onLongPollingDisconnect(e){if(this.connectionType===c.LongPolling){if(e.code!=p.CONFIG_EXPIRED&&e.code!=p.CHANNEL_EXPIRED&&e.code!=p.CONFIG_REPLACED){this.sendPullStatus(f.Offline)}else{this.offlineTimeout=setTimeout((()=>this.sendPullStatus(f.Offline)),5500)}}if(!e){e={}}this.logToConsole("Pull: Long polling connection with push-server closed. Code: "+e.code+", reason: "+e.reason);if(!this.isManualDisconnect){this.scheduleReconnect()}this.isManualDisconnect=false;this.clearPingWaitTimeout()}onLongPollingError(e){this.starting=false;if(this.connectionType===c.LongPolling){this.sendPullStatus(f.Offline)}console.error(U.getDateForLog()+": Pull: Long polling connection error",e);this.scheduleReconnect();if(this._connectPromise){this._connectPromise.reject()}this.clearPingWaitTimeout()}isConnected(){return this.connector?this.connector.connected:false}onBeforeUnload(){this.unloading=true;const e=U.clone(this.session);e.ttl=(new Date).getTime()+u*1e3;if(this.storage){try{this.storage.set(l,JSON.stringify(e),u)}catch(e){console.error(U.getDateForLog()+" Pull: Could not save session info in local storage. Error: ",e)}}this.scheduleReconnect(15)}onOffline(){this.disconnect("1000","offline")}onOnline(){this.connect()}handleInternalPullEvent(e,t){switch(e.toUpperCase()){case m.CHANNEL_EXPIRE:{if(t.params.action=="reconnect"){this.config.channels[t.params.channel.type]=t.params.new_channel;this.logToConsole("Pull: new config for "+t.params.channel.type+" channel set:\n",this.config.channels[t.params.channel.type]);this.reconnect(p.CONFIG_REPLACED,"config was replaced")}else{this.restart(p.CHANNEL_EXPIRED,"channel expired")}break}case m.CONFIG_EXPIRE:{this.restart(p.CONFIG_EXPIRED,"config expired");break}case m.SERVER_RESTART:{this.reconnect(p.SERVER_RESTARTED,"server was restarted",15);break}default:}}checkRevision(t){if(this.skipCheckRevision){return true}t=parseInt(t);if(t>0&&t!=n){this.enabled=false;if(typeof e.message!=="undefined"){this.showNotification(e.message("PULL_OLD_REVISION"))}this.disconnect(p.NORMAL_CLOSURE,"check_revision");if(typeof e.onCustomEvent!=="undefined"){e.onCustomEvent(window,"onPullRevisionUp",[t,n])}this.emit({type:h.Revision,data:{server:t,client:n}});this.logToConsole("Pull revision changed from "+n+" to "+t+". Reload required");return false}return true}showNotification(t){if(this.notificationPopup||typeof e.PopupWindow==="undefined"){return}this.notificationPopup=new e.PopupWindow("bx-notifier-popup-confirm",null,{zIndex:200,autoHide:false,closeByEsc:false,overlay:true,content:e.create("div",{props:{className:"bx-messenger-confirm"},html:t}),buttons:[new e.PopupWindowButton({text:e.message("JS_CORE_WINDOW_CLOSE"),className:"popup-window-button-decline",events:{click:()=>{this.notificationPopup.close()}}})],events:{onPopupClose:function(){this.destroy()},onPopupDestroy:()=>{this.notificationPopup=null}}});this.notificationPopup.show()}getRevision(){return this.config&&this.config.api?this.config.api.revision_web:null}getServerVersion(){return this.config&&this.config.server?this.config.server.version:0}getServerMode(){return this.config&&this.config.server?this.config.server.mode:null}getConfig(){return this.config}getDebugInfo(){if(!console||!console.info||!JSON||!JSON.stringify){return false}let e;if(this.config&&this.config.channels&&this.config.channels.private){e="ChannelID: "+this.config.channels.private.id+"\n"+"ChannelDie: "+this.config.channels.private.end+"\n"+("shared"in this.config.channels?"ChannelDieShared: "+this.config.channels.shared.end:"")}else{e="Config error: config is not loaded"}const t=JSON.stringify(this.watchTagsQueue);const n="\n========= PULL DEBUG ===========\n"+"UserId: "+this.userId+" "+(this.userId>0?"":"(guest)")+"\n"+(this.guestMode&&this.guestUserId!==0?"Guest userId: "+this.guestUserId+"\n":"")+"Browser online: "+(navigator.onLine?"Y":"N")+"\n"+"Connect: "+(this.isConnected()?"Y":"N")+"\n"+"Server type: "+(this.isSharedMode()?"cloud":"local")+"\n"+"WebSocket support: "+(this.isWebSocketSupported()?"Y":"N")+"\n"+"WebSocket connect: "+(this._connectors.webSocket&&this._connectors.webSocket.connected?"Y":"N")+"\n"+"WebSocket mode: "+(this._connectors.webSocket&&this._connectors.webSocket.socket?this._connectors.webSocket.socket.url.search("binaryMode=true")!=-1?"protobuf":"text":"-")+"\n"+"Try connect: "+(this.reconnectTimeout?"Y":"N")+"\n"+"Try number: "+this.connectionAttempt+"\n"+"\n"+"Path: "+(this.connector?this.connector.path:"-")+"\n"+e+"\n"+"\n"+"Last message: "+(this.session.mid>0?this.session.mid:"-")+"\n"+"Session history: "+JSON.stringify(this.session.history)+"\n"+"Watch tags: "+(t=="{}"?"-":t)+"\n"+"================================\n";return console.info(n)}enableLogging(e){if(e===undefined){e=true}e=e===true;this.sharedConfig.setLoggingEnabled(e);this.loggingEnabled=e}capturePullEvent(e){if(e===undefined){e=true}this.debug=e}getConnectionPath(e){let t;let i={};switch(e){case c.WebSocket:t=this.isSecure?this.config.server.websocket_secure:this.config.server.websocket;break;case c.LongPolling:t=this.isSecure?this.config.server.long_pooling_secure:this.config.server.long_polling;break;default:throw new Error("Unknown connection type "+e)}if(!U.isNotEmptyString(t)){return false}if(typeof this.config.jwt=="string"&&this.config.jwt!==""){i["token"]=this.config.jwt}else{let e=[];["private","shared"].forEach((t=>{if(typeof this.config.channels[t]!=="undefined"){e.push(this.config.channels[t].id)}}));if(e.length===0){return false}i["CHANNEL_ID"]=e.join("/")}if(this.isJsonRpc()){i.jsonRpc="true"}else if(this.isProtobufSupported()){i.binaryMode="true"}if(this.isSharedMode()){if(!this.config.clientId){throw new Error("Push-server is in shared mode, but clientId is not set")}i.clientId=this.config.clientId}if(this.session.mid){i.mid=this.session.mid}if(this.session.tag){i.tag=this.session.tag}if(this.session.time){i.time=this.session.time}i.revision=n;return t+"?"+U.buildQueryString(i)}getPublicationPath(){const e=this.isSecure?this.config.server.publish_secure:this.config.server.publish;if(!e){return""}let t=[];for(let e in this.config.channels){if(!this.config.channels.hasOwnProperty(e)){continue}t.push(this.config.channels[e].id)}const n={CHANNEL_ID:t.join("/")};return e+"?"+U.buildQueryString(n)}getConnectionAttemptDelay(e){let t;if(e<1){t=.5}else if(e<3){t=15}else if(e<5){t=45}else if(e<10){t=600}else{t=3600}return t+t*Math.random()*.2}sendPullStatus(t){if(this.unloading){return}if(typeof e.onCustomEvent!=="undefined"){e.onCustomEvent(window,"onPullStatus",[t])}this.emit({type:h.Status,data:{status:t}})}extendWatch(e,t){if(!e||this.watchTagsQueue[e]){return false}this.watchTagsQueue[e]=true;if(t){this.updateWatch(t)}}updateWatch(e){clearTimeout(this.watchUpdateTimeout);this.watchUpdateTimeout=setTimeout((()=>{const e=Object.keys(this.watchTagsQueue);if(e.length>0){this.restClient.callMethod("pull.watch.extend",{tags:e},(e=>{if(e.error()){this.updateWatch();return false}const t=e.data();for(let e in t){if(t.hasOwnProperty(e)&&!t[e]){this.clearWatch(e)}}this.updateWatch()}))}else{this.updateWatch()}}),e?this.watchForceUpdateInterval:this.watchUpdateInterval)}clearWatch(e){delete this.watchTagsQueue[e]}updatePingWaitTimeout(){clearTimeout(this.pingWaitTimeout);this.pingWaitTimeout=setTimeout(this.onPingTimeoutHandler,T*2*1e3)}clearPingWaitTimeout(){clearTimeout(this.pingWaitTimeout);this.pingWaitTimeout=null}onPingTimeout(){this.pingWaitTimeout=null;if(!this.enabled||!this.isConnected()){return}console.warn("No pings are received in "+T*2+" seconds. Reconnecting");this.disconnect("1000","connection stuck");this.scheduleReconnect()}setPrivateVar(){}returnPrivateVar(){}expireConfig(){}updateChannelID(){}tryConnect(){}tryConnectDelay(){}tryConnectSet(){}updateState(){}setUpdateStateStepCount(){}supportWebSocket(){return this.isWebSocketSupported()}isWebSoketConnected(){return this.isConnected()&&this.connectionType==c.WebSocket}getPullServerStatus(){return this.isConnected()}closeConfirm(){if(this.notificationPopup){this.notificationPopup.destroy()}}}class P{constructor(e){e=e||{};this.storage=e.storage||new N;this.ttl=24*60*60;this.lsKeys={websocketBlocked:"bx-pull-websocket-blocked",longPollingBlocked:"bx-pull-longpolling-blocked",loggingEnabled:"bx-pull-logging-enabled"};this.callbacks={onWebSocketBlockChanged:U.isFunction(e.onWebSocketBlockChanged)?e.onWebSocketBlockChanged:function(){}};if(this.storage){window.addEventListener("storage",this.onLocalStorageSet.bind(this))}}onLocalStorageSet(e){if(this.storage.compareKey(e.key,this.lsKeys.websocketBlocked)&&e.newValue!=e.oldValue){this.callbacks.onWebSocketBlockChanged({isWebSocketBlocked:this.isWebSocketBlocked()})}}isWebSocketBlocked(){if(!this.storage){return false}return this.storage.get(this.lsKeys.websocketBlocked,0)>U.getTimestamp()}setWebSocketBlocked(e){if(!this.storage){return false}try{this.storage.set(this.lsKeys.websocketBlocked,e?U.getTimestamp()+this.ttl:0)}catch(e){console.error(U.getDateForLog()+" Pull: Could not save WS_blocked flag in local storage. Error: ",e)}}isLongPollingBlocked(){if(!this.storage){return false}return this.storage.get(this.lsKeys.longPollingBlocked,0)>U.getTimestamp()}setLongPollingBlocked(e){if(!this.storage){return false}try{this.storage.set(this.lsKeys.longPollingBlocked,e?U.getTimestamp()+this.ttl:0)}catch(e){console.error(U.getDateForLog()+" Pull: Could not save LP_blocked flag in local storage. Error: ",e)}}isLoggingEnabled(){if(!this.storage){return false}return this.storage.get(this.lsKeys.loggingEnabled,0)>U.getTimestamp()}setLoggingEnabled(e){if(!this.storage){return false}try{this.storage.set(this.lsKeys.loggingEnabled,e?U.getTimestamp()+this.ttl:0)}catch(e){console.error("LocalStorage error: ",e);return false}}}class L{_connected=false;connectionType="";disconnectCode="";disconnectReason="";constructor(e){this.parent=e.parent;this.callbacks={onOpen:U.isFunction(e.onOpen)?e.onOpen:function(){},onDisconnect:U.isFunction(e.onDisconnect)?e.onDisconnect:function(){},onError:U.isFunction(e.onError)?e.onError:function(){},onMessage:U.isFunction(e.onMessage)?e.onMessage:function(){}}}get connected(){return this._connected}set connected(e){if(e==this._connected){return}this._connected=e;if(this._connected){this.callbacks.onOpen()}else{this.callbacks.onDisconnect({code:this.disconnectCode,reason:this.disconnectReason})}}get path(){return this.parent.getConnectionPath(this.connectionType)}}class R extends L{constructor(e){super(e);this.connectionType=c.WebSocket;this.socket=null;this.onSocketOpenHandler=this.onSocketOpen.bind(this);this.onSocketCloseHandler=this.onSocketClose.bind(this);this.onSocketErrorHandler=this.onSocketError.bind(this);this.onSocketMessageHandler=this.onSocketMessage.bind(this)}connect(){if(this.socket){if(this.socket.readyState===1){return true}else{this.socket.removeEventListener("open",this.onSocketOpenHandler);this.socket.removeEventListener("close",this.onSocketCloseHandler);this.socket.removeEventListener("error",this.onSocketErrorHandler);this.socket.removeEventListener("message",this.onSocketMessageHandler);this.socket.close();this.socket=null}}this.createSocket()}disconnect(e,t){if(this.socket!==null){this.socket.removeEventListener("open",this.onSocketOpenHandler);this.socket.removeEventListener("close",this.onSocketCloseHandler);this.socket.removeEventListener("error",this.onSocketErrorHandler);this.socket.removeEventListener("message",this.onSocketMessageHandler);this.socket.close(e,t)}this.socket=null;this.disconnectCode=e;this.disconnectReason=t;this.connected=false}createSocket(){if(this.socket){throw new Error("Socket already exists")}if(!this.path){throw new Error("Websocket connection path is not defined")}this.socket=new WebSocket(this.path);this.socket.binaryType="arraybuffer";this.socket.addEventListener("open",this.onSocketOpenHandler);this.socket.addEventListener("close",this.onSocketCloseHandler);this.socket.addEventListener("error",this.onSocketErrorHandler);this.socket.addEventListener("message",this.onSocketMessageHandler)}send(e){if(!this.socket||this.socket.readyState!==1){console.error(U.getDateForLog()+": Pull: WebSocket is not connected");return false}this.socket.send(e);return true}onSocketOpen(){this.connected=true}onSocketClose(e){this.socket=null;this.disconnectCode=e.code;this.disconnectReason=e.reason;this.connected=false}onSocketError(e){this.callbacks.onError(e)}onSocketMessage(e){this.callbacks.onMessage(e.data)}destroy(){if(this.socket){this.socket.close();this.socket=null}}}class H extends L{constructor(e){super(e);this.active=false;this.connectionType=c.LongPolling;this.requestTimeout=null;this.failureTimeout=null;this.xhr=this.createXhr();this.requestAborted=false}createXhr(){const e=new XMLHttpRequest;if(this.parent.isProtobufSupported()&&!this.parent.isJsonRpc()){e.responseType="arraybuffer"}e.addEventListener("readystatechange",this.onXhrReadyStateChange.bind(this));return e}connect(){this.active=true;this.performRequest()}disconnect(e,t){this.active=false;if(this.failureTimeout){clearTimeout(this.failureTimeout);this.failureTimeout=null}if(this.requestTimeout){clearTimeout(this.requestTimeout);this.requestTimeout=null}if(this.xhr){this.requestAborted=true;this.xhr.abort()}this.disconnectCode=e;this.disconnectReason=t;this.connected=false}performRequest(){if(!this.active){return}if(!this.path){throw new Error("Long polling connection path is not defined")}if(this.xhr.readyState!==0&&this.xhr.readyState!==4){return}clearTimeout(this.failureTimeout);clearTimeout(this.requestTimeout);this.failureTimeout=setTimeout((()=>{this.connected=true}),5e3);this.requestTimeout=setTimeout(this.onRequestTimeout.bind(this),i*1e3);this.xhr.open("GET",this.path);this.xhr.send()}onRequestTimeout(){this.requestAborted=true;this.xhr.abort();this.performRequest()}onXhrReadyStateChange(){if(this.xhr.readyState===4){if(!this.requestAborted||this.xhr.status==200){this.onResponse(this.xhr.response)}this.requestAborted=false}}send(e){const t=this.parent.getPublicationPath();if(!t){console.error(U.getDateForLog()+": Pull: publication path is empty");return false}let n=new XMLHttpRequest;n.open("POST",t);n.send(e)}onResponse(e){if(this.failureTimeout){clearTimeout(this.failureTimeout);this.failureTimeout=0}if(this.requestTimeout){clearTimeout(this.requestTimeout);this.requestTimeout=0}if(this.xhr.status==200){this.connected=true;if(U.isNotEmptyString(e)||e instanceof ArrayBuffer){this.callbacks.onMessage(e)}else{this.parent.session.mid=null}this.performRequest()}else if(this.xhr.status==304){this.connected=true;if(this.xhr.getResponseHeader("Expires")==="Thu, 01 Jan 1973 11:11:01 GMT"){const e=this.xhr.getResponseHeader("Last-Message-Id");if(U.isNotEmptyString(e)){this.parent.setLastMessageId(e)}}this.performRequest()}else{this.callbacks.onError("Could not connect to the server");this.connected=false}}}class j{constructor(t){this.publicIds={};this.restClient=typeof t.restClient!=="undefined"?t.restClient:e.rest;this.getPublicListMethod=t.getPublicListMethod}getPublicIds(e){const t=new Date;let n={};let i=[];for(let r=0;r<e.length;r++){const s=e[r];if(this.publicIds[s]&&this.publicIds[s]["end"]>t){n[s]=this.publicIds[s]}else{i.push(s)}}if(i.length===0){return Promise.resolve(n)}return new Promise((e=>{this.restClient.callMethod(this.getPublicListMethod,{users:i}).then((t=>{if(t.error()){return e({})}const r=t.data();this.setPublicIds(U.objectValues(r));i.forEach((e=>{n[e]=this.publicIds[e]}));e(n)}))}))}setPublicIds(e){for(let t=0;t<e.length;t++){const n=e[t];const i=n.user_id;this.publicIds[i]={userId:i,publicId:n.public_id,signature:n.signature,start:new Date(n.start),end:new Date(n.end)}}}}class N{constuctor(t){t=t||{};this.userId=t.userId?t.userId:typeof e.message!=="undefined"&&e.message.USER_ID?e.message.USER_ID:0;this.siteId=t.siteId?t.siteId:typeof e.message!=="undefined"&&e.message.SITE_ID?e.message.SITE_ID:"none"}set(e,t){if(typeof window.localStorage==="undefined"){return false}if(typeof t!="string"){if(t){t=JSON.stringify(t)}}return window.localStorage.setItem(this.getKey(e),t)}get(e,t){if(typeof window.localStorage==="undefined"){return t||null}const n=window.localStorage.getItem(this.getKey(e));if(n===null){return t||null}return JSON.parse(n)}remove(e){if(typeof window.localStorage==="undefined"){return false}return window.localStorage.removeItem(this.getKey(e))}getKey(e){return"bx-pull-"+this.userId+"-"+this.siteId+"-"+e}compareKey(e,t){return e===this.getKey(t)}}class B{idCounter=0;handlers={};rpcResponseAwaiters=new Map;constructor(e){this.connector=e.connector;if(U.isPlainObject(e.handlers)){for(let t in e.handlers){this.handle(t,e.handlers[t])}}}handle(e,t){this.handlers[e]=t}executeOutgoingRpcCommand(e,t,n){return new Promise(((i,r)=>{const s=this.createRequest(e,t,n);if(this.connector.send(JSON.stringify(s))){this.rpcResponseAwaiters.set(s.id,{resolve:i,reject:r})}else{r(new F("websocket is not connected"))}}))}executeOutgoingRpcBatch(e){let t=[];let n=[];e.forEach((({method:e,params:i,id:r})=>{const s=this.createRequest(e,i,r);t.push(s);n.push(new Promise(((e,t)=>this.rpcResponseAwaiters.set(s.id,{resolve:e,reject:t}))))}));this.connector.send(JSON.stringify(t));return n}processRpcResponse(e){if("id"in e&&this.rpcResponseAwaiters.has(e.id)){if("result"in e){this.rpcResponseAwaiters.get(e.id).resolve(e.result)}else if("error"in e){this.rpcResponseAwaiters.get(e.id).reject(e.error)}else{this.rpcResponseAwaiters.get(e.id).reject(new Error("wrong response structure"))}this.rpcResponseAwaiters.delete(e.id)}else{console.error("Received rpc response with unknown id",e)}}parseJsonRpcMessage(e){let t;try{t=JSON.parse(e)}catch(e){console.error(U.getDateForLog()+": Pull: Could not decode json rpc message",e)}if(U.isArray(t)){return this.executeIncomingRpcBatch(t)}else if(U.isJsonRpcRequest(t)){return this.executeIncomingRpcCommand(t)}else if(U.isJsonRpcResponse(t)){return this.processRpcResponse(t)}else{console.error(U.getDateForLog()+": Pull: unknown rpc packet",t)}}executeIncomingRpcCommand({method:e,params:t}){if(e in this.handlers){return this.handlers[e].call(this,t)}return{error:O.MethodNotFound}}executeIncomingRpcBatch(e){let t=[];for(let n of e){if("jsonrpc"in n){if("method"in n){let e=this.executeIncomingRpcCommand(n);if(e){e["jsonrpc"]=E;e["id"]=n["id"];t.push(e)}}else{this.processRpcResponse(n)}}else{console.error(U.getDateForLog()+": Pull: unknown rpc command in batch",n);t.push({jsonrpc:"2.0",error:O.InvalidRequest})}}return t}nextId(){return++this.idCounter}createPublishRequest(e){let t=e.map((e=>this.createRequest("publish",e)));if(t.length===0){return t[0]}return t}createRequest(e,t,n){if(!n){n=this.nextId()}return{jsonrpc:E,method:e,params:t,id:n}}}class F extends Error{constructor(e){super(e);this.name="ErrorNotConnected"}}const U={browser:{IsChrome:function(){return navigator.userAgent.toLowerCase().indexOf("chrome")!=-1},IsFirefox:function(){return navigator.userAgent.toLowerCase().indexOf("firefox")!=-1},IsIe:function(){return navigator.userAgent.match(/(Trident\/|MSIE\/)/)!==null}},getTimestamp:function(){return(new Date).getTime()},errorsToString:function(e){if(!this.isArray(e)){return""}else{return e.reduce((function(e,t){if(e!=""){e+="; "}return e+t.code+": "+t.message}),"")}},isString:function(e){return e===""?true:e?typeof e=="string"||e instanceof String:false},isArray:function(e){return e&&Object.prototype.toString.call(e)=="[object Array]"},isFunction:function(e){return e===null?false:typeof e=="function"||e instanceof Function},isDomNode:function(e){return e&&typeof e=="object"&&"nodeType"in e},isDate:function(e){return e&&Object.prototype.toString.call(e)=="[object Date]"},isPlainObject:function(e){if(!e||typeof e!=="object"||e.nodeType){return false}const t=Object.prototype.hasOwnProperty;try{if(e.constructor&&!t.call(e,"constructor")&&!t.call(e.constructor.prototype,"isPrototypeOf")){return false}}catch(e){return false}let n;for(n in e){}return typeof n==="undefined"||t.call(e,n)},isNotEmptyString:function(e){return this.isString(e)?e.length>0:false},isJsonRpcRequest:function(e){return typeof e==="object"&&e&&"jsonrpc"in e&&U.isNotEmptyString(e.jsonrpc)&&"method"in e&&U.isNotEmptyString(e.method)},isJsonRpcResponse:function(e){return typeof e==="object"&&e&&"jsonrpc"in e&&U.isNotEmptyString(e.jsonrpc)&&"id"in e&&("result"in e||"error"in e)},buildQueryString:function(e){let t="";for(let n in e){if(!e.hasOwnProperty(n)){continue}const i=e[n];if(U.isArray(i)){i.forEach(((e,i)=>{t+=encodeURIComponent(n+"["+i+"]")+"="+encodeURIComponent(e)+"&"}))}else{t+=encodeURIComponent(n)+"="+encodeURIComponent(i)+"&"}}if(t.length>0){t=t.substr(0,t.length-1)}return t},objectValues:function e(t){let n=[];for(let e in t){if(t.hasOwnProperty(e)&&t.propertyIsEnumerable(e)){n.push(t[e])}}return n},clone:function(e,t){let n,i,r;if(t!==false){t=true}if(e===null){return null}if(this.isDomNode(e)){n=e.cloneNode(t)}else if(typeof e=="object"){if(this.isArray(e)){n=[];for(i=0,r=e.length;i<r;i++){if(typeof e[i]=="object"&&t){n[i]=this.clone(e[i],t)}else{n[i]=e[i]}}}else{n={};if(e.constructor){if(this.isDate(e)){n=new Date(e)}else{n=new e.constructor}}for(i in e){if(!e.hasOwnProperty(i)){continue}if(typeof e[i]=="object"&&t){n[i]=this.clone(e[i],t)}else{n[i]=e[i]}}}}else{n=e}return n},getDateForLog:function(){const e=new Date;return e.getFullYear()+"-"+U.lpad(e.getMonth(),2,"0")+"-"+U.lpad(e.getDate(),2,"0")+" "+U.lpad(e.getHours(),2,"0")+":"+U.lpad(e.getMinutes(),2,"0")},lpad:function(e,t,n){e=e.toString();n=n||" ";if(e.length>t){return e}let i="";for(let r=0;r<t-e.length;r++){i+=n}return i+e}};if(typeof e.namespace!=="undefined"&&typeof e.PULL==="undefined"){e.PULL=new A}e.PullClient=A;e.PullClient.PullStatus=f;e.PullClient.SubscriptionType=h;e.PullClient.CloseReasons=p;e.PullClient.StorageManager=N})();(function(e,t,n,i){"use strict";n.WidgetBitrixVue.component("bx-pull-component-status",{props:{canReconnect:{default:false}},data:function e(){return{status:i.PullClient.PullStatus.Online,showed:null}},created:function e(){var t=this;this.isMac=navigator.userAgent.toLowerCase().includes("macintosh");this.setStatusTimeout=null;this.hideTimeout=null;this.pullUnSubscribe=function(){};if(this.$Bitrix.PullClient.get()){this.subscribe()}this.$Bitrix.eventEmitter.subscribe(n.WidgetBitrixVue.events.pullClientChange,(function(){return t.subscribe()}));window.component=this},beforeDestroy:function e(){this.pullUnSubscribe()},methods:{subscribe:function e(){var t=this;this.pullUnSubscribe();this.pullUnSubscribe=this.$Bitrix.PullClient.get().subscribe({type:i.PullClient.SubscriptionType.Status,callback:function e(n){return t.statusChange(n.status)}})},reconnect:function e(){if(this.canReconnect){this.$emit("reconnect")}else{location.reload()}},statusChange:function e(t){var n=this;clearTimeout(this.setStatusTimeout);if(this.status===t){return false}var r=[i.PullClient.PullStatus.Online,i.PullClient.PullStatus.Offline,i.PullClient.PullStatus.Connecting];if(r.indexOf(t)<0){return false}var s=500;if(t===i.PullClient.PullStatus.Connecting){s=5e3}else if(t===i.PullClient.PullStatus.Offline){s=2e3}this.setStatusTimeout=setTimeout((function(){n.status=t;n.showed=true}),s);return true},isMobile:function e(){return navigator.userAgent.toLowerCase().includes("android")||navigator.userAgent.toLowerCase().includes("webos")||navigator.userAgent.toLowerCase().includes("iphone")||navigator.userAgent.toLowerCase().includes("ipad")||navigator.userAgent.toLowerCase().includes("ipod")||navigator.userAgent.toLowerCase().includes("blackberry")||navigator.userAgent.toLowerCase().includes("windows phone")}},watch:{status:function e(){var t=this;clearTimeout(this.hideTimeout);if(this.status===i.PullClient.PullStatus.Online){clearTimeout(this.hideTimeout);this.hideTimeout=setTimeout((function(){return t.showed=false}),4e3)}}},computed:{connectionClass:function e(){var t="";if(this.showed===true){t="bx-pull-status-show"}else if(this.showed===false){t="bx-pull-status-hide"}if(this.status===i.PullClient.PullStatus.Online){t+=" bx-pull-status-online"}else if(this.status===i.PullClient.PullStatus.Offline){t+=" bx-pull-status-offline"}else if(this.status===i.PullClient.PullStatus.Connecting){t+=" bx-pull-status-connecting"}return t},connectionText:function e(){var t="";if(this.status===i.PullClient.PullStatus.Online){t=this.localize.BX_PULL_STATUS_ONLINE}else if(this.status===i.PullClient.PullStatus.Offline){t=this.localize.BX_PULL_STATUS_OFFLINE}else if(this.status===i.PullClient.PullStatus.Connecting){t=this.localize.BX_PULL_STATUS_CONNECTING}return t},button:function e(){var t="";var n="";if(this.canReconnect){n=this.localize.BX_PULL_STATUS_BUTTON_RECONNECT}else{t=this.isMac?"&#8984;+R":"Ctrl+R";n=this.localize.BX_PULL_STATUS_BUTTON_RELOAD}return{title:n,key:t}},localize:function e(){return n.WidgetBitrixVue.getFilteredPhrases("BX_PULL_STATUS_",this)}},template:'\n\t\t<div v-if="!isMobile()" :class="[\'bx-pull-status\', connectionClass]">\n\t\t\t<div class="bx-pull-status-wrap">\n\t\t\t\t<span class="bx-pull-status-text">{{connectionText}}</span>\n\t\t\t\t<span class="bx-pull-status-button" @click="reconnect">\n\t\t\t\t\t<span class="bx-pull-status-button-title">{{button.title}}</span>\n\t\t\t\t\t<span class="bx-pull-status-button-key" v-html="button.key"></span>\n\t\t\t\t</span>\n\t\t\t</div>\n\t\t</div>\n\t'})})(this.window=this.window||{},BX,BX,BX);(function(e,t){"use strict";if("IntersectionObserver"in e&&"IntersectionObserverEntry"in e&&"intersectionRatio"in e.IntersectionObserverEntry.prototype){if(!("isIntersecting"in e.IntersectionObserverEntry.prototype)){Object.defineProperty(e.IntersectionObserverEntry.prototype,"isIntersecting",{get:function(){return this.intersectionRatio>0}})}return}var n=[];function i(e){this.time=e.time;this.target=e.target;this.rootBounds=e.rootBounds;this.boundingClientRect=e.boundingClientRect;this.intersectionRect=e.intersectionRect||f();this.isIntersecting=!!e.intersectionRect;var t=this.boundingClientRect;var n=t.width*t.height;var i=this.intersectionRect;var r=i.width*i.height;if(n){this.intersectionRatio=r/n}else{this.intersectionRatio=this.isIntersecting?1:0}}function r(e,t){var n=t||{};if(typeof e!=="function"){throw new Error("callback must be a function")}if(n.root&&n.root.nodeType!==1){throw new Error("root must be an Element")}this._checkForIntersections=o(this._checkForIntersections.bind(this),this.THROTTLE_TIMEOUT);this._callback=e;this._observationTargets=[];this._queuedEntries=[];this._rootMarginValues=this._parseRootMargin(n.rootMargin);this.thresholds=this._initThresholds(n.threshold);this.root=n.root||null;this.rootMargin=this._rootMarginValues.map((function(e){return e.value+e.unit})).join(" ")}r.prototype.THROTTLE_TIMEOUT=100;r.prototype.POLL_INTERVAL=null;r.prototype.USE_MUTATION_OBSERVER=true;r.prototype.observe=function(e){var t=this._observationTargets.some((function(t){return t.element===e}));if(t){return}if(!(e&&e.nodeType===1)){throw new Error("target must be an Element")}this._registerInstance();this._observationTargets.push({element:e,entry:null});this._monitorIntersections();this._checkForIntersections()};r.prototype.unobserve=function(e){this._observationTargets=this._observationTargets.filter((function(t){return t.element!==e}));if(!this._observationTargets.length){this._unmonitorIntersections();this._unregisterInstance()}};r.prototype.disconnect=function(){this._observationTargets=[];this._unmonitorIntersections();this._unregisterInstance()};r.prototype.takeRecords=function(){var e=this._queuedEntries.slice();this._queuedEntries=[];return e};r.prototype._initThresholds=function(e){var t=e||[0];if(!Array.isArray(t)){t=[t]}return t.sort().filter((function(e,t,n){if(typeof e!=="number"||isNaN(e)||e<0||e>1){throw new Error("threshold must be a number between 0 and 1 inclusively")}return e!==n[t-1]}))};r.prototype._parseRootMargin=function(e){var t=e||"0px";var n=t.split(/\s+/).map((function(e){var t=/^(-?\d*\.?\d+)(px|%)$/.exec(e);if(!t){throw new Error("rootMargin must be specified in pixels or percent")}return{value:parseFloat(t[1]),unit:t[2]}}));n[1]=n[1]||n[0];n[2]=n[2]||n[0];n[3]=n[3]||n[1];return n};r.prototype._monitorIntersections=function(){if(!this._monitoringIntersections){this._monitoringIntersections=true;if(this.POLL_INTERVAL){this._monitoringInterval=setInterval(this._checkForIntersections,this.POLL_INTERVAL)}else{a(e,"resize",this._checkForIntersections,true);a(t,"scroll",this._checkForIntersections,true);if(this.USE_MUTATION_OBSERVER&&"MutationObserver"in e){this._domObserver=new MutationObserver(this._checkForIntersections);this._domObserver.observe(t,{attributes:true,childList:true,characterData:true,subtree:true})}}}};r.prototype._unmonitorIntersections=function(){if(this._monitoringIntersections){this._monitoringIntersections=false;clearInterval(this._monitoringInterval);this._monitoringInterval=null;l(e,"resize",this._checkForIntersections,true);l(t,"scroll",this._checkForIntersections,true);if(this._domObserver){this._domObserver.disconnect();this._domObserver=null}}};r.prototype._checkForIntersections=function(){var e=this._rootIsInDom();var t=e?this._getRootRect():f();this._observationTargets.forEach((function(n){var r=n.element;var o=c(r);var a=this._rootContainsTarget(r);var l=n.entry;var u=e&&a&&this._computeTargetAndRootIntersection(r,t);var f=n.entry=new i({time:s(),target:r,boundingClientRect:o,rootBounds:t,intersectionRect:u});if(!l){this._queuedEntries.push(f)}else if(e&&a){if(this._hasCrossedThreshold(l,f)){this._queuedEntries.push(f)}}else{if(l&&l.isIntersecting){this._queuedEntries.push(f)}}}),this);if(this._queuedEntries.length){this._callback(this.takeRecords(),this)}};r.prototype._computeTargetAndRootIntersection=function(n,i){if(e.getComputedStyle(n).display==="none"){return}var r=c(n);var s=h(n);var o=false;while(!o){var a=null;var l=s.nodeType===1?e.getComputedStyle(s):{};if(l.display=="none"){return}if(s===this.root||s===t){o=true;a=i}else{if(s!=t.body&&s!=t.documentElement&&l.overflow!="visible"){a=c(s)}}if(a){r=u(a,r);if(!r){break}}s=h(s)}return r};r.prototype._getRootRect=function(){var e;if(this.root){e=c(this.root)}else{var n=t.documentElement;var i=t.body;e={top:0,left:0,right:n.clientWidth||i.clientWidth,width:n.clientWidth||i.clientWidth,bottom:n.clientHeight||i.clientHeight,height:n.clientHeight||i.clientHeight}}return this._expandRectByRootMargin(e)};r.prototype._expandRectByRootMargin=function(e){var t=this._rootMarginValues.map((function(t,n){return t.unit==="px"?t.value:t.value*(n%2?e.width:e.height)/100}));var n={top:e.top-t[0],right:e.right+t[1],bottom:e.bottom+t[2],left:e.left-t[3]};n.width=n.right-n.left;n.height=n.bottom-n.top;return n};r.prototype._hasCrossedThreshold=function(e,t){var n=e&&e.isIntersecting?e.intersectionRatio||0:-1;var i=t.isIntersecting?t.intersectionRatio||0:-1;if(n===i){return}for(var r=0;r<this.thresholds.length;r++){var s=this.thresholds[r];if(s==n||s==i||s<n!==s<i){return true}}};r.prototype._rootIsInDom=function(){return!this.root||d(t,this.root)};r.prototype._rootContainsTarget=function(e){return d(this.root||t,e)};r.prototype._registerInstance=function(){if(n.indexOf(this)<0){n.push(this)}};r.prototype._unregisterInstance=function(){var e=n.indexOf(this);if(e!==-1){n.splice(e,1)}};function s(){return e.performance&&performance.now&&performance.now()}function o(e,t){var n=null;return function(){if(!n){n=setTimeout((function(){e();n=null}),t)}}}function a(e,t,n,i){if(typeof e.addEventListener=="function"){e.addEventListener(t,n,i||false)}else if(typeof e.attachEvent==="function"){e.attachEvent("on"+t,n)}}function l(e,t,n,i){if(typeof e.removeEventListener==="function"){e.removeEventListener(t,n,i||false)}else if(typeof e.detatchEvent==="function"){e.detatchEvent("on"+t,n)}}function u(e,t){var n=Math.max(e.top,t.top);var i=Math.min(e.bottom,t.bottom);var r=Math.max(e.left,t.left);var s=Math.min(e.right,t.right);var o=s-r;var a=i-n;return o>=0&&a>=0&&{top:n,bottom:i,left:r,right:s,width:o,height:a}}function c(e){var t;try{t=e.getBoundingClientRect()}catch(e){}if(!t){return f()}if(!(t.width&&t.height)){t={top:t.top,right:t.right,bottom:t.bottom,left:t.left,width:t.right-t.left,height:t.bottom-t.top}}return t}function f(){return{top:0,bottom:0,left:0,right:0,width:0,height:0}}function d(e,t){var n=t;while(n){if(n===e){return true}n=h(n)}return false}function h(e){var t=e.parentNode;if(t&&t.nodeType==11&&t.host){return t.host}return t}e.IntersectionObserver=r;e.IntersectionObserverEntry=i})(window,document);(function(e,t){"use strict";var n="bx-lazyload-watch";var i="bx-lazyload-loading";var r="bx-lazyload-success";var s="bx-lazyload-error";var o="bx-lazyload-hidden";var a="data:image/svg+xml,%3Csvg width='1px' height='1px' xmlns='http://www.w3.org/2000/svg'%3E%3C/svg%3E";var l=null;var u=function e(t,a){var u=t.dataset.lazyloadSuccessClass?t.dataset.lazyloadSuccessClass.split(" "):[];delete t.dataset.lazyloadSuccessClass;u=[r].concat(babelHelpers.toConsumableArray(u));var c=t.dataset.lazyloadErrorClass?t.dataset.lazyloadErrorClass.split(" "):[];delete t.dataset.lazyloadErrorClass;c=[s].concat(babelHelpers.toConsumableArray(c));t.classList.add(i);var f=new Image;f.src=t.dataset.lazyloadSrc;if(!t.dataset.lazyloadHiddenSrc){t.dataset.lazyloadHiddenSrc=t.src}f.onload=function(){var e;if(t.classList.contains(o)){return false}if(t.dataset.lazyloadSrc){t.src=t.dataset.lazyloadSrc}t.classList.remove(i);(e=t.classList).add.apply(e,babelHelpers.toConsumableArray(u));if(typeof t.lazyloadCallback==="function"){t.lazyloadCallback({element:t,state:"success"});delete t.lazyloadCallback}};f.onerror=function(){var e;if(t.classList.contains(o)){return false}t.classList.remove(i);(e=t.classList).add.apply(e,babelHelpers.toConsumableArray(c));t.title="";t.alt="";if(typeof t.lazyloadCallback==="function"){t.lazyloadCallback({element:t,state:"error"});delete t.lazyloadCallback}};if(typeof t.dataset.lazyloadDontHide!=="undefined"){t.classList.remove(n);delete t.dataset.lazyloadDontHide;if(l){l.unobserve(t)}}};if(typeof window.IntersectionObserver!=="undefined"){l=new IntersectionObserver((function(e,t){e.forEach((function(e){var t=e.target;if(e.isIntersecting){if(t.classList.contains(o)){if(t.dataset.lazyloadSrc){t.src=t.dataset.lazyloadSrc}t.classList.remove(o)}else if(t.classList.contains(n)){return true}else{t.classList.add(n);u(t)}}else{if(t.classList.contains(o)||!t.classList.contains(n)){return true}if(t.dataset.lazyloadHiddenSrc){t.src=t.dataset.lazyloadHiddenSrc}t.classList.remove(i);t.classList.add(o)}}))}),{threshold:[0,1]})}t.WidgetBitrixVue.directive("bx-lazyload",{bind:function e(t,n){if(babelHelpers["typeof"](n.value)==="object"&&typeof n.value.callback==="function"){t.lazyloadCallback=n.value.callback}if(!t.src||t.src===location.href.replace(location.hash,"")){t.src=a}if(l){l.observe(t)}else{u(t)}},componentUpdated:function e(t){if(!t.classList.contains(r)&&!t.classList.contains(s)&&!t.classList.contains(n)&&!t.classList.contains(i)){t.classList.add(i)}else if((t.classList.contains(r)||t.classList.contains(s))&&t.dataset.lazyloadSrc&&t.dataset.lazyloadSrc!==t.src){if(!t.dataset.lazyloadSrc.startsWith("http")){var o=document.createElement("a");o.href=t.dataset.lazyloadSrc;if(o.href===t.src){return}}u(t)}},unbind:function e(t){if(l){l.unobserve(t)}}})})(this.window=this.window||{},BX);this.BX=this.BX||{};(function(e){"use strict";
/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.
	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.
	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var t=function e(){t=Object.assign||function e(t){for(var n,i=1,r=arguments.length;i<r;i++){n=arguments[i];for(var s in n){if(Object.prototype.hasOwnProperty.call(n,s))t[s]=n[s]}}return t};return t.apply(this,arguments)};function n(e,t,n){if(n||arguments.length===2)for(var i=0,r=t.length,s;i<r;i++){if(s||!(i in t)){if(!s)s=Array.prototype.slice.call(t,0,i);s[i]=t[i]}}return e.concat(s||Array.prototype.slice.call(t))}var i=typeof globalThis!=="undefined"?globalThis:typeof self!=="undefined"?self:typeof window!=="undefined"?window:global;var r=Object.keys;var s=Array.isArray;if(typeof Promise!=="undefined"&&!i.Promise){i.Promise=Promise}function o(e,t){if(babelHelpers["typeof"](t)!=="object")return e;r(t).forEach((function(n){e[n]=t[n]}));return e}var a=Object.getPrototypeOf;var l={}.hasOwnProperty;function u(e,t){return l.call(e,t)}function c(e,t){if(typeof t==="function")t=t(a(e));if(babelHelpers["typeof"](t)!=="object")return;(typeof Reflect==="undefined"?r:Reflect.ownKeys)(t).forEach((function(n){d(e,n,t[n])}))}var f=Object.defineProperty;function d(e,t,n,i){f(e,t,o(n&&u(n,"get")&&typeof n.get==="function"?{get:n.get,set:n.set,configurable:true}:{value:n,configurable:true,writable:true},i))}function h(e){return{from:function t(n){e.prototype=Object.create(n.prototype);d(e.prototype,"constructor",e);return{extend:c.bind(null,e.prototype)}}}}var p=Object.getOwnPropertyDescriptor;function m(e,t){var n=p(e,t);var i;return n||(i=a(e))&&m(i,t)}var g=[].slice;function v(e,t,n){return g.call(e,t,n)}function y(e,t){return t(e)}function b(e){if(!e)throw new Error("Assertion Failed")}function w(e){if(i.setImmediate)setImmediate(e);else setTimeout(e,0)}function S(e,t){return e.reduce((function(e,n,i){var r=t(n,i);if(r)e[r[0]]=r[1];return e}),{})}function I(e,t,n){try{e.apply(null,n)}catch(e){t&&t(e)}}function k(e,t){if(u(e,t))return e[t];if(!t)return e;if(typeof t!=="string"){var n=[];for(var i=0,r=t.length;i<r;++i){var s=k(e,t[i]);n.push(s)}return n}var o=t.indexOf(".");if(o!==-1){var a=e[t.substr(0,o)];return a===undefined?undefined:k(a,t.substr(o+1))}return undefined}function C(e,t,n){if(!e||t===undefined)return;if("isFrozen"in Object&&Object.isFrozen(e))return;if(typeof t!=="string"&&"length"in t){b(typeof n!=="string"&&"length"in n);for(var i=0,r=t.length;i<r;++i){C(e,t[i],n[i])}}else{var o=t.indexOf(".");if(o!==-1){var a=t.substr(0,o);var l=t.substr(o+1);if(l===""){if(n===undefined){if(s(e)&&!isNaN(parseInt(a)))e.splice(a,1);else delete e[a]}else e[a]=n}else{var c=e[a];if(!c||!u(e,a))c=e[a]={};C(c,l,n)}}else{if(n===undefined){if(s(e)&&!isNaN(parseInt(t)))e.splice(t,1);else delete e[t]}else e[t]=n}}}function E(e,t){if(typeof t==="string")C(e,t,undefined);else if("length"in t)[].map.call(t,(function(t){C(e,t,undefined)}))}function _(e){var t={};for(var n in e){if(u(e,n))t[n]=e[n]}return t}var x=[].concat;function T(e){return x.apply([],e)}var O="Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(T([8,16,32,64].map((function(e){return["Int","Uint","Float"].map((function(t){return t+e+"Array"}))})))).filter((function(e){return i[e]}));var M=O.map((function(e){return i[e]}));S(O,(function(e){return[e,true]}));var D=null;function A(e){D=typeof WeakMap!=="undefined"&&new WeakMap;var t=P(e);D=null;return t}function P(e){if(!e||babelHelpers["typeof"](e)!=="object")return e;var t=D&&D.get(e);if(t)return t;if(s(e)){t=[];D&&D.set(e,t);for(var n=0,i=e.length;n<i;++n){t.push(P(e[n]))}}else if(M.indexOf(e.constructor)>=0){t=e}else{var r=a(e);t=r===Object.prototype?{}:Object.create(r);D&&D.set(e,t);for(var o in e){if(u(e,o)){t[o]=P(e[o])}}}return t}var L={}.toString;function R(e){return L.call(e).slice(8,-1)}var H=typeof Symbol!=="undefined"?Symbol.iterator:"@@iterator";var j=babelHelpers["typeof"](H)==="symbol"?function(e){var t;return e!=null&&(t=e[H])&&t.apply(e)}:function(){return null};var N={};function B(e){var t,n,i,r;if(arguments.length===1){if(s(e))return e.slice();if(this===N&&typeof e==="string")return[e];if(r=j(e)){n=[];while(i=r.next(),!i.done){n.push(i.value)}return n}if(e==null)return[e];t=e.length;if(typeof t==="number"){n=new Array(t);while(t--){n[t]=e[t]}return n}return[e]}t=arguments.length;n=new Array(t);while(t--){n[t]=arguments[t]}return n}var F=typeof Symbol!=="undefined"?function(e){return e[Symbol.toStringTag]==="AsyncFunction"}:function(){return false};var U=typeof location!=="undefined"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function W(e,t){U=e;$=t}var $=function e(){return true};var V=!new Error("").stack;function G(){if(V)try{throw new Error}catch(e){return e}return new Error}function z(e,t){var n=e.stack;if(!n)return"";t=t||0;if(n.indexOf(e.name)===0)t+=(e.name+e.message).split("\n").length;return n.split("\n").slice(t).filter($).map((function(e){return"\n"+e})).join("")}var X=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"];var q=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"];var K=X.concat(q);var Y={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function J(e,t){this._e=G();this.name=e;this.message=t}h(J).from(Error).extend({stack:{get:function e(){return this._stack||(this._stack=this.name+": "+this.message+z(this._e,2))}},toString:function e(){return this.name+": "+this.message}});function Q(e,t){return e+". Errors: "+Object.keys(t).map((function(e){return t[e].toString()})).filter((function(e,t,n){return n.indexOf(e)===t})).join("\n")}function Z(e,t,n,i){this._e=G();this.failures=t;this.failedKeys=i;this.successCount=n;this.message=Q(e,t)}h(Z).from(J);function ee(e,t){this._e=G();this.name="BulkError";this.failures=Object.keys(t).map((function(e){return t[e]}));this.failuresByPos=t;this.message=Q(e,t)}h(ee).from(J);var te=K.reduce((function(e,t){return e[t]=t+"Error",e}),{});var ne=J;var ie=K.reduce((function(e,t){var n=t+"Error";function i(e,i){this._e=G();this.name=n;if(!e){this.message=Y[t]||n;this.inner=null}else if(typeof e==="string"){this.message=""+e+(!i?"":"\n "+i);this.inner=i||null}else if(babelHelpers["typeof"](e)==="object"){this.message=e.name+" "+e.message;this.inner=e}}h(i).from(ne);e[t]=i;return e}),{});ie.Syntax=SyntaxError;ie.Type=TypeError;ie.Range=RangeError;var re=q.reduce((function(e,t){e[t+"Error"]=ie[t];return e}),{});function se(e,t){if(!e||e instanceof J||e instanceof TypeError||e instanceof SyntaxError||!e.name||!re[e.name])return e;var n=new re[e.name](t||e.message,e);if("stack"in e){d(n,"stack",{get:function e(){return this.inner.stack}})}return n}var oe=K.reduce((function(e,t){if(["Syntax","Type","Range"].indexOf(t)===-1)e[t+"Error"]=ie[t];return e}),{});oe.ModifyError=Z;oe.DexieError=J;oe.BulkError=ee;function ae(){}function le(e){return e}function ue(e,t){if(e==null||e===le)return t;return function(n){return t(e(n))}}function ce(e,t){return function(){e.apply(this,arguments);t.apply(this,arguments)}}function fe(e,t){if(e===ae)return t;return function(){var n=e.apply(this,arguments);if(n!==undefined)arguments[0]=n;var i=this.onsuccess,r=this.onerror;this.onsuccess=null;this.onerror=null;var s=t.apply(this,arguments);if(i)this.onsuccess=this.onsuccess?ce(i,this.onsuccess):i;if(r)this.onerror=this.onerror?ce(r,this.onerror):r;return s!==undefined?s:n}}function de(e,t){if(e===ae)return t;return function(){e.apply(this,arguments);var n=this.onsuccess,i=this.onerror;this.onsuccess=this.onerror=null;t.apply(this,arguments);if(n)this.onsuccess=this.onsuccess?ce(n,this.onsuccess):n;if(i)this.onerror=this.onerror?ce(i,this.onerror):i}}function he(e,t){if(e===ae)return t;return function(n){var i=e.apply(this,arguments);o(n,i);var r=this.onsuccess,s=this.onerror;this.onsuccess=null;this.onerror=null;var a=t.apply(this,arguments);if(r)this.onsuccess=this.onsuccess?ce(r,this.onsuccess):r;if(s)this.onerror=this.onerror?ce(s,this.onerror):s;return i===undefined?a===undefined?undefined:a:o(i,a)}}function pe(e,t){if(e===ae)return t;return function(){if(t.apply(this,arguments)===false)return false;return e.apply(this,arguments)}}function me(e,t){if(e===ae)return t;return function(){var n=e.apply(this,arguments);if(n&&typeof n.then==="function"){var i=this,r=arguments.length,s=new Array(r);while(r--){s[r]=arguments[r]}return n.then((function(){return t.apply(i,s)}))}return t.apply(this,arguments)}}var ge={};var ve=100,ye=20,be=100,we=typeof Promise==="undefined"?[]:function(){var e=Promise.resolve();if(typeof crypto==="undefined"||!crypto.subtle)return[e,a(e),e];var t=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[t,a(t),e]}(),Se=we[0],Ie=we[1],ke=we[2],Ce=Ie&&Ie.then;var Ee=Se&&Se.constructor;var _e=!!ke;var xe=false;var Te=ke?function(){ke.then(Je)}:i.setImmediate?setImmediate.bind(null,Je):i.MutationObserver?function(){var e=document.createElement("div");new MutationObserver((function(){Je();e=null})).observe(e,{attributes:true});e.setAttribute("i","1")}:function(){setTimeout(Je,0)};var Oe=function e(t,n){Ne.push([t,n]);if(De){Te();De=false}};var Me=true,De=true,Ae=[],Pe=[],Le=null,Re=le;var He={id:"global",global:true,ref:0,unhandleds:[],onunhandled:Et,pgp:false,env:{},finalize:function e(){this.unhandleds.forEach((function(e){try{Et(e[0],e[1])}catch(e){}}))}};var je=He;var Ne=[];var Be=0;var Fe=[];function Ue(e){if(babelHelpers["typeof"](this)!=="object")throw new TypeError("Promises must be constructed via new");this._listeners=[];this.onuncatched=ae;this._lib=false;var t=this._PSD=je;if(U){this._stackHolder=G();this._prev=null;this._numPrev=0}if(typeof e!=="function"){if(e!==ge)throw new TypeError("Not a function");this._state=arguments[1];this._value=arguments[2];if(this._state===false)Ge(this,this._value);return}this._state=null;this._value=null;++t.ref;Ve(this,e)}var We={get:function e(){var t=je,n=ct;function i(e,i){var r=this;var s=!t.global&&(t!==je||n!==ct);var o=s&&!pt();var a=new Ue((function(n,a){Xe(r,new $e(It(e,t,s,o),It(i,t,s,o),n,a,t))}));U&&Ye(a,this);return a}i.prototype=ge;return i},set:function e(t){d(this,"then",t&&t.prototype===ge?We:{get:function e(){return t},set:We.set})}};c(Ue.prototype,{then:We,_then:function e(t,n){Xe(this,new $e(null,null,t,n,je))},catch:function e(t){if(arguments.length===1)return this.then(null,t);var n=arguments[0],i=arguments[1];return typeof n==="function"?this.then(null,(function(e){return e instanceof n?i(e):rt(e)})):this.then(null,(function(e){return e&&e.name===n?i(e):rt(e)}))},finally:function e(t){return this.then((function(e){t();return e}),(function(e){t();return rt(e)}))},stack:{get:function e(){if(this._stack)return this._stack;try{xe=true;var t=Ke(this,[],ye);var n=t.join("\nFrom previous: ");if(this._state!==null)this._stack=n;return n}finally{xe=false}}},timeout:function e(t,n){var i=this;return t<Infinity?new Ue((function(e,r){var s=setTimeout((function(){return r(new ie.Timeout(n))}),t);i.then(e,r)["finally"](clearTimeout.bind(null,s))})):this}});if(typeof Symbol!=="undefined"&&Symbol.toStringTag)d(Ue.prototype,Symbol.toStringTag,"Dexie.Promise");He.env=bt();function $e(e,t,n,i,r){this.onFulfilled=typeof e==="function"?e:null;this.onRejected=typeof t==="function"?t:null;this.resolve=n;this.reject=i;this.psd=r}c(Ue,{all:function e(){var t=B.apply(null,arguments).map(mt);return new Ue((function(e,n){if(t.length===0)e([]);var i=t.length;t.forEach((function(r,s){return Ue.resolve(r).then((function(n){t[s]=n;if(!--i)e(t)}),n)}))}))},resolve:function e(t){if(t instanceof Ue)return t;if(t&&typeof t.then==="function")return new Ue((function(e,n){t.then(e,n)}));var n=new Ue(ge,true,t);Ye(n,Le);return n},reject:rt,race:function e(){var t=B.apply(null,arguments).map(mt);return new Ue((function(e,n){t.map((function(t){return Ue.resolve(t).then(e,n)}))}))},PSD:{get:function e(){return je},set:function e(t){return je=t}},totalEchoes:{get:function e(){return ct}},newPSD:dt,usePSD:wt,scheduler:{get:function e(){return Oe},set:function e(t){Oe=t}},rejectionMapper:{get:function e(){return Re},set:function e(t){Re=t}},follow:function e(t,n){return new Ue((function(e,i){return dt((function(e,n){var i=je;i.unhandleds=[];i.onunhandled=n;i.finalize=ce((function(){var t=this;tt((function(){t.unhandleds.length===0?e():n(t.unhandleds[0])}))}),i.finalize);t()}),n,e,i)}))}});if(Ee){if(Ee.allSettled)d(Ue,"allSettled",(function(){var e=B.apply(null,arguments).map(mt);return new Ue((function(t){if(e.length===0)t([]);var n=e.length;var i=new Array(n);e.forEach((function(e,r){return Ue.resolve(e).then((function(e){return i[r]={status:"fulfilled",value:e}}),(function(e){return i[r]={status:"rejected",reason:e}})).then((function(){return--n||t(i)}))}))}))}));if(Ee.any&&typeof AggregateError!=="undefined")d(Ue,"any",(function(){var e=B.apply(null,arguments).map(mt);return new Ue((function(t,n){if(e.length===0)n(new AggregateError([]));var i=e.length;var r=new Array(i);e.forEach((function(e,s){return Ue.resolve(e).then((function(e){return t(e)}),(function(e){r[s]=e;if(!--i)n(new AggregateError(r))}))}))}))}))}function Ve(e,t){try{t((function(t){if(e._state!==null)return;if(t===e)throw new TypeError("A promise cannot be resolved with itself.");var n=e._lib&&Qe();if(t&&typeof t.then==="function"){Ve(e,(function(e,n){t instanceof Ue?t._then(e,n):t.then(e,n)}))}else{e._state=true;e._value=t;ze(e)}if(n)Ze()}),Ge.bind(null,e))}catch(t){Ge(e,t)}}function Ge(e,t){Pe.push(t);if(e._state!==null)return;var n=e._lib&&Qe();t=Re(t);e._state=false;e._value=t;U&&t!==null&&babelHelpers["typeof"](t)==="object"&&!t._promise&&I((function(){var n=m(t,"stack");t._promise=e;d(t,"stack",{get:function i(){return xe?n&&(n.get?n.get.apply(t):n.value):e.stack}})}));nt(e);ze(e);if(n)Ze()}function ze(e){var t=e._listeners;e._listeners=[];for(var n=0,i=t.length;n<i;++n){Xe(e,t[n])}var r=e._PSD;--r.ref||r.finalize();if(Be===0){++Be;Oe((function(){if(--Be===0)et()}),[])}}function Xe(e,t){if(e._state===null){e._listeners.push(t);return}var n=e._state?t.onFulfilled:t.onRejected;if(n===null){return(e._state?t.resolve:t.reject)(e._value)}++t.psd.ref;++Be;Oe(qe,[n,e,t])}function qe(e,t,n){try{Le=t;var i,r=t._value;if(t._state){i=e(r)}else{if(Pe.length)Pe=[];i=e(r);if(Pe.indexOf(r)===-1)it(t)}n.resolve(i)}catch(e){n.reject(e)}finally{Le=null;if(--Be===0)et();--n.psd.ref||n.psd.finalize()}}function Ke(e,t,n){if(t.length===n)return t;var i="";if(e._state===false){var r=e._value,s,o;if(r!=null){s=r.name||"Error";o=r.message||r;i=z(r,0)}else{s=r;o=""}t.push(s+(o?": "+o:"")+i)}if(U){i=z(e._stackHolder,2);if(i&&t.indexOf(i)===-1)t.push(i);if(e._prev)Ke(e._prev,t,n)}return t}function Ye(e,t){var n=t?t._numPrev+1:0;if(n<ve){e._prev=t;e._numPrev=n}}function Je(){Qe()&&Ze()}function Qe(){var e=Me;Me=false;De=false;return e}function Ze(){var e,t,n;do{while(Ne.length>0){e=Ne;Ne=[];n=e.length;for(t=0;t<n;++t){var i=e[t];i[0].apply(null,i[1])}}}while(Ne.length>0);Me=true;De=true}function et(){var e=Ae;Ae=[];e.forEach((function(e){e._PSD.onunhandled.call(null,e._value,e)}));var t=Fe.slice(0);var n=t.length;while(n){t[--n]()}}function tt(e){function t(){e();Fe.splice(Fe.indexOf(t),1)}Fe.push(t);++Be;Oe((function(){if(--Be===0)et()}),[])}function nt(e){if(!Ae.some((function(t){return t._value===e._value})))Ae.push(e)}function it(e){var t=Ae.length;while(t){if(Ae[--t]._value===e._value){Ae.splice(t,1);return}}}function rt(e){return new Ue(ge,false,e)}function st(e,t){var n=je;return function(){var i=Qe(),r=je;try{yt(n,true);return e.apply(this,arguments)}catch(e){t&&t(e)}finally{yt(r,false);if(i)Ze()}}}var ot={awaits:0,echoes:0,id:0};var at=0;var lt=[];var ut=0;var ct=0;var ft=0;function dt(e,t,n,i){var r=je,s=Object.create(r);s.parent=r;s.ref=0;s.global=false;s.id=++ft;var a=He.env;s.env=_e?{Promise:Ue,PromiseProp:{value:Ue,configurable:true,writable:true},all:Ue.all,race:Ue.race,allSettled:Ue.allSettled,any:Ue.any,resolve:Ue.resolve,reject:Ue.reject,nthen:kt(a.nthen,s),gthen:kt(a.gthen,s)}:{};if(t)o(s,t);++r.ref;s.finalize=function(){--this.parent.ref||this.parent.finalize()};var l=wt(s,e,n,i);if(s.ref===0)s.finalize();return l}function ht(){if(!ot.id)ot.id=++at;++ot.awaits;ot.echoes+=be;return ot.id}function pt(){if(!ot.awaits)return false;if(--ot.awaits===0)ot.id=0;ot.echoes=ot.awaits*be;return true}if((""+Ce).indexOf("[native code]")===-1){ht=pt=ae}function mt(e){if(ot.echoes&&e&&e.constructor===Ee){ht();return e.then((function(e){pt();return e}),(function(e){pt();return _t(e)}))}return e}function gt(e){++ct;if(!ot.echoes||--ot.echoes===0){ot.echoes=ot.id=0}lt.push(je);yt(e,true)}function vt(){var e=lt[lt.length-1];lt.pop();yt(e,false)}function yt(e,t){var n=je;if(t?ot.echoes&&(!ut++||e!==je):ut&&(!--ut||e!==je)){St(t?gt.bind(null,e):vt)}if(e===je)return;je=e;if(n===He)He.env=bt();if(_e){var r=He.env.Promise;var s=e.env;Ie.then=s.nthen;r.prototype.then=s.gthen;if(n.global||e.global){Object.defineProperty(i,"Promise",s.PromiseProp);r.all=s.all;r.race=s.race;r.resolve=s.resolve;r.reject=s.reject;if(s.allSettled)r.allSettled=s.allSettled;if(s.any)r.any=s.any}}}function bt(){var e=i.Promise||Promise;return _e?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(i,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject,nthen:Ie.then,gthen:e.prototype.then}:{}}function wt(e,t,n,i,r){var s=je;try{yt(e,true);return t(n,i,r)}finally{yt(s,false)}}function St(e){Ce.call(Se,e)}function It(e,t,n,i){return typeof e!=="function"?e:function(){var r=je;if(n)ht();yt(t,true);try{return e.apply(this,arguments)}finally{yt(r,false);if(i)St(pt)}}}function kt(e,t){return function(n,i){return e.call(this,It(n,t),It(i,t))}}var Ct="unhandledrejection";function Et(e,t){var n;try{n=t.onuncatched(e)}catch(e){}if(n!==false)try{var r,s={promise:t,reason:e};if(i.document&&document.createEvent){r=document.createEvent("Event");r.initEvent(Ct,true,true);o(r,s)}else if(i.CustomEvent){r=new CustomEvent(Ct,{detail:s});o(r,s)}if(r&&i.dispatchEvent){dispatchEvent(r);if(!i.PromiseRejectionEvent&&i.onunhandledrejection)try{i.onunhandledrejection(r)}catch(e){}}if(U&&r&&!r.defaultPrevented){console.warn("Unhandled rejection: "+(e.stack||e))}}catch(e){}}var _t=Ue.reject;function xt(e,t,n,i){if(!e.idbdb||!e._state.openComplete&&!je.letThrough&&!e._vip){if(e._state.openComplete){return _t(new ie.DatabaseClosed(e._state.dbOpenError))}if(!e._state.isBeingOpened){if(!e._options.autoOpen)return _t(new ie.DatabaseClosed);e.open()["catch"](ae)}return e._state.dbReadyPromise.then((function(){return xt(e,t,n,i)}))}else{var r=e._createTransaction(t,n,e._dbSchema);try{r.create();e._state.PR1398_maxLoop=3}catch(r){if(r.name===te.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0){console.warn("Dexie: Need to reopen db");e._close();return e.open().then((function(){return xt(e,t,n,i)}))}return _t(r)}return r._promise(t,(function(e,t){return dt((function(){je.trans=r;return i(e,t,r)}))})).then((function(e){return r._completion.then((function(){return e}))}))}}var Tt="3.2.2";var Ot=String.fromCharCode(65535);var Mt=-Infinity;var Dt="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.";var At="String expected.";var Pt=[];var Lt=typeof navigator!=="undefined"&&/(MSIE|Trident|Edge)/.test(navigator.userAgent);var Rt=Lt;var Ht=Lt;var jt=function e(t){return!/(dexie\.js|dexie\.min\.js)/.test(t)};var Nt="__dbnames";var Bt="readonly";var Ft="readwrite";function Ut(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}var Wt={type:3,lower:-Infinity,lowerOpen:false,upper:[[]],upperOpen:false};function $t(e){return typeof e==="string"&&!/\./.test(e)?function(t){if(t[e]===undefined&&e in t){t=A(t);delete t[e]}return t}:function(e){return e}}var Vt=function(){function e(){}e.prototype._trans=function(e,t,n){var i=this._tx||je.trans;var r=this.name;function s(e,n,i){if(!i.schema[r])throw new ie.NotFound("Table "+r+" not part of transaction");return t(i.idbtrans,i)}var o=Qe();try{return i&&i.db===this.db?i===je.trans?i._promise(e,s,n):dt((function(){return i._promise(e,s,n)}),{trans:i,transless:je.transless||je}):xt(this.db,e,[this.name],s)}finally{if(o)Ze()}};e.prototype.get=function(e,t){var n=this;if(e&&e.constructor===Object)return this.where(e).first(t);return this._trans("readonly",(function(t){return n.core.get({trans:t,key:e}).then((function(e){return n.hook.reading.fire(e)}))})).then(t)};e.prototype.where=function(e){if(typeof e==="string")return new this.db.WhereClause(this,e);if(s(e))return new this.db.WhereClause(this,"["+e.join("+")+"]");var t=r(e);if(t.length===1)return this.where(t[0]).equals(e[t[0]]);var n=this.schema.indexes.concat(this.schema.primKey).filter((function(e){return e.compound&&t.every((function(t){return e.keyPath.indexOf(t)>=0}))&&e.keyPath.every((function(e){return t.indexOf(e)>=0}))}))[0];if(n&&this.db._maxKey!==Ot)return this.where(n.name).equals(n.keyPath.map((function(t){return e[t]})));if(!n&&U)console.warn("The query "+JSON.stringify(e)+" on "+this.name+" would benefit of a "+("compound index ["+t.join("+")+"]"));var i=this.schema.idxByName;var o=this.db._deps.indexedDB;function a(e,t){try{return o.cmp(e,t)===0}catch(e){return false}}var l=t.reduce((function(t,n){var r=t[0],o=t[1];var l=i[n];var u=e[n];return[r||l,r||!l?Ut(o,l&&l.multi?function(e){var t=k(e,n);return s(t)&&t.some((function(e){return a(u,e)}))}:function(e){return a(u,k(e,n))}):o]}),[null,null]),u=l[0],c=l[1];return u?this.where(u.name).equals(e[u.keyPath]).filter(c):n?this.filter(c):this.where(t).equals("")};e.prototype.filter=function(e){return this.toCollection().and(e)};e.prototype.count=function(e){return this.toCollection().count(e)};e.prototype.offset=function(e){return this.toCollection().offset(e)};e.prototype.limit=function(e){return this.toCollection().limit(e)};e.prototype.each=function(e){return this.toCollection().each(e)};e.prototype.toArray=function(e){return this.toCollection().toArray(e)};e.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))};e.prototype.orderBy=function(e){return new this.db.Collection(new this.db.WhereClause(this,s(e)?"["+e.join("+")+"]":e))};e.prototype.reverse=function(){return this.toCollection().reverse()};e.prototype.mapToClass=function(e){this.schema.mappedClass=e;var t=function t(n){if(!n)return n;var i=Object.create(e.prototype);for(var r in n){if(u(n,r))try{i[r]=n[r]}catch(e){}}return i};if(this.schema.readHook){this.hook.reading.unsubscribe(this.schema.readHook)}this.schema.readHook=t;this.hook("reading",t);return e};e.prototype.defineClass=function(){function e(e){o(this,e)}return this.mapToClass(e)};e.prototype.add=function(e,t){var n=this;var i=this.schema.primKey,r=i.auto,s=i.keyPath;var o=e;if(s&&r){o=$t(s)(e)}return this._trans("readwrite",(function(e){return n.core.mutate({trans:e,type:"add",keys:t!=null?[t]:null,values:[o]})})).then((function(e){return e.numFailures?Ue.reject(e.failures[0]):e.lastResult})).then((function(t){if(s){try{C(e,s,t)}catch(e){}}return t}))};e.prototype.update=function(e,t){if(babelHelpers["typeof"](e)==="object"&&!s(e)){var n=k(e,this.schema.primKey.keyPath);if(n===undefined)return _t(new ie.InvalidArgument("Given object does not contain its primary key"));try{if(typeof t!=="function"){r(t).forEach((function(n){C(e,n,t[n])}))}else{t(e,{value:e,primKey:n})}}catch(e){}return this.where(":id").equals(n).modify(t)}else{return this.where(":id").equals(e).modify(t)}};e.prototype.put=function(e,t){var n=this;var i=this.schema.primKey,r=i.auto,s=i.keyPath;var o=e;if(s&&r){o=$t(s)(e)}return this._trans("readwrite",(function(e){return n.core.mutate({trans:e,type:"put",values:[o],keys:t!=null?[t]:null})})).then((function(e){return e.numFailures?Ue.reject(e.failures[0]):e.lastResult})).then((function(t){if(s){try{C(e,s,t)}catch(e){}}return t}))};e.prototype["delete"]=function(e){var t=this;return this._trans("readwrite",(function(n){return t.core.mutate({trans:n,type:"delete",keys:[e]})})).then((function(e){return e.numFailures?Ue.reject(e.failures[0]):undefined}))};e.prototype.clear=function(){var e=this;return this._trans("readwrite",(function(t){return e.core.mutate({trans:t,type:"deleteRange",range:Wt})})).then((function(e){return e.numFailures?Ue.reject(e.failures[0]):undefined}))};e.prototype.bulkGet=function(e){var t=this;return this._trans("readonly",(function(n){return t.core.getMany({keys:e,trans:n}).then((function(e){return e.map((function(e){return t.hook.reading.fire(e)}))}))}))};e.prototype.bulkAdd=function(e,t,n){var i=this;var r=Array.isArray(t)?t:undefined;n=n||(r?undefined:t);var s=n?n.allKeys:undefined;return this._trans("readwrite",(function(t){var n=i.schema.primKey,o=n.auto,a=n.keyPath;if(a&&r)throw new ie.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(r&&r.length!==e.length)throw new ie.InvalidArgument("Arguments objects and keys must have the same length");var l=e.length;var u=a&&o?e.map($t(a)):e;return i.core.mutate({trans:t,type:"add",keys:r,values:u,wantResults:s}).then((function(e){var t=e.numFailures,n=e.results,r=e.lastResult,o=e.failures;var a=s?n:r;if(t===0)return a;throw new ee(i.name+".bulkAdd(): "+t+" of "+l+" operations failed",o)}))}))};e.prototype.bulkPut=function(e,t,n){var i=this;var r=Array.isArray(t)?t:undefined;n=n||(r?undefined:t);var s=n?n.allKeys:undefined;return this._trans("readwrite",(function(t){var n=i.schema.primKey,o=n.auto,a=n.keyPath;if(a&&r)throw new ie.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(r&&r.length!==e.length)throw new ie.InvalidArgument("Arguments objects and keys must have the same length");var l=e.length;var u=a&&o?e.map($t(a)):e;return i.core.mutate({trans:t,type:"put",keys:r,values:u,wantResults:s}).then((function(e){var t=e.numFailures,n=e.results,r=e.lastResult,o=e.failures;var a=s?n:r;if(t===0)return a;throw new ee(i.name+".bulkPut(): "+t+" of "+l+" operations failed",o)}))}))};e.prototype.bulkDelete=function(e){var t=this;var n=e.length;return this._trans("readwrite",(function(n){return t.core.mutate({trans:n,type:"delete",keys:e})})).then((function(e){var i=e.numFailures,r=e.lastResult,s=e.failures;if(i===0)return r;throw new ee(t.name+".bulkDelete(): "+i+" of "+n+" operations failed",s)}))};return e}();function Gt(e){var t={};var n=function n(i,r){if(r){var s=arguments.length,o=new Array(s-1);while(--s){o[s-1]=arguments[s]}t[i].subscribe.apply(null,o);return e}else if(typeof i==="string"){return t[i]}};n.addEventType=a;for(var i=1,o=arguments.length;i<o;++i){a(arguments[i])}return n;function a(e,i,r){if(babelHelpers["typeof"](e)==="object")return l(e);if(!i)i=pe;if(!r)r=ae;var s={subscribers:[],fire:r,subscribe:function e(t){if(s.subscribers.indexOf(t)===-1){s.subscribers.push(t);s.fire=i(s.fire,t)}},unsubscribe:function e(t){s.subscribers=s.subscribers.filter((function(e){return e!==t}));s.fire=s.subscribers.reduce(i,r)}};t[e]=n[e]=s;return s}function l(e){r(e).forEach((function(t){var n=e[t];if(s(n)){a(t,e[t][0],e[t][1])}else if(n==="asap"){var i=a(t,le,(function e(){var t=arguments.length,n=new Array(t);while(t--){n[t]=arguments[t]}i.subscribers.forEach((function(e){w((function t(){e.apply(null,n)}))}))}))}else throw new ie.InvalidArgument("Invalid event config")}))}}function zt(e,t){h(t).from({prototype:e});return t}function Xt(e){return zt(Vt.prototype,(function t(n,i,r){this.db=e;this._tx=r;this.name=n;this.schema=i;this.hook=e._allTables[n]?e._allTables[n].hook:Gt(null,{creating:[fe,ae],reading:[ue,le],updating:[he,ae],deleting:[de,ae]})}))}function qt(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function Kt(e,t){e.filter=Ut(e.filter,t)}function Yt(e,t,n){var i=e.replayFilter;e.replayFilter=i?function(){return Ut(i(),t())}:t;e.justLimit=n&&!i}function Jt(e,t){e.isMatch=Ut(e.isMatch,t)}function Qt(e,t){if(e.isPrimKey)return t.primaryKey;var n=t.getIndexByKeyPath(e.index);if(!n)throw new ie.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed");return n}function Zt(e,t,n){var i=Qt(e,t.schema);return t.openCursor({trans:n,values:!e.keysOnly,reverse:e.dir==="prev",unique:!!e.unique,query:{index:i,range:e.range}})}function en(e,t,n,i){var r=e.replayFilter?Ut(e.filter,e.replayFilter()):e.filter;if(!e.or){return tn(Zt(e,i,n),Ut(e.algorithm,r),t,!e.keysOnly&&e.valueMapper)}else{var s={};var o=function e(n,i,o){if(!r||r(i,o,(function(e){return i.stop(e)}),(function(e){return i.fail(e)}))){var a=i.primaryKey;var l=""+a;if(l==="[object ArrayBuffer]")l=""+new Uint8Array(a);if(!u(s,l)){s[l]=true;t(n,i,o)}}};return Promise.all([e.or._iterate(o,n),tn(Zt(e,i,n),e.algorithm,o,!e.keysOnly&&e.valueMapper)])}}function tn(e,t,n,i){var r=i?function(e,t,r){return n(i(e),t,r)}:n;var s=st(r);return e.then((function(e){if(e){return e.start((function(){var n=function t(){return e["continue"]()};if(!t||t(e,(function(e){return n=e}),(function(t){e.stop(t);n=ae}),(function(t){e.fail(t);n=ae})))s(e.value,e,(function(e){return n=e}));n()}))}}))}function nn(e,t){try{var n=on(e);var i=on(t);if(n!==i){if(n==="Array")return 1;if(i==="Array")return-1;if(n==="binary")return 1;if(i==="binary")return-1;if(n==="string")return 1;if(i==="string")return-1;if(n==="Date")return 1;if(i!=="Date")return NaN;return-1}switch(n){case"number":case"Date":case"string":return e>t?1:e<t?-1:0;case"binary":{return sn(an(e),an(t))}case"Array":return rn(e,t)}}catch(e){}return NaN}function rn(e,t){var n=e.length;var i=t.length;var r=n<i?n:i;for(var s=0;s<r;++s){var o=nn(e[s],t[s]);if(o!==0)return o}return n===i?0:n<i?-1:1}function sn(e,t){var n=e.length;var i=t.length;var r=n<i?n:i;for(var s=0;s<r;++s){if(e[s]!==t[s])return e[s]<t[s]?-1:1}return n===i?0:n<i?-1:1}function on(e){var t=babelHelpers["typeof"](e);if(t!=="object")return t;if(ArrayBuffer.isView(e))return"binary";var n=R(e);return n==="ArrayBuffer"?"binary":n}function an(e){if(e instanceof Uint8Array)return e;if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);return new Uint8Array(e)}var ln=function(){function e(){}e.prototype._read=function(e,t){var n=this._ctx;return n.error?n.table._trans(null,_t.bind(null,n.error)):n.table._trans("readonly",e).then(t)};e.prototype._write=function(e){var t=this._ctx;return t.error?t.table._trans(null,_t.bind(null,t.error)):t.table._trans("readwrite",e,"locked")};e.prototype._addAlgorithm=function(e){var t=this._ctx;t.algorithm=Ut(t.algorithm,e)};e.prototype._iterate=function(e,t){return en(this._ctx,e,t,this._ctx.table.core)};e.prototype.clone=function(e){var t=Object.create(this.constructor.prototype),n=Object.create(this._ctx);if(e)o(n,e);t._ctx=n;return t};e.prototype.raw=function(){this._ctx.valueMapper=null;return this};e.prototype.each=function(e){var t=this._ctx;return this._read((function(n){return en(t,e,n,t.table.core)}))};e.prototype.count=function(e){var t=this;return this._read((function(e){var n=t._ctx;var i=n.table.core;if(qt(n,true)){return i.count({trans:e,query:{index:Qt(n,i.schema),range:n.range}}).then((function(e){return Math.min(e,n.limit)}))}else{var r=0;return en(n,(function(){++r;return false}),e,i).then((function(){return r}))}})).then(e)};e.prototype.sortBy=function(e,t){var n=e.split(".").reverse(),i=n[0],r=n.length-1;function s(e,t){if(t)return s(e[n[t]],t-1);return e[i]}var o=this._ctx.dir==="next"?1:-1;function a(e,t){var n=s(e,r),i=s(t,r);return n<i?-o:n>i?o:0}return this.toArray((function(e){return e.sort(a)})).then(t)};e.prototype.toArray=function(e){var t=this;return this._read((function(e){var n=t._ctx;if(n.dir==="next"&&qt(n,true)&&n.limit>0){var i=n.valueMapper;var r=Qt(n,n.table.core.schema);return n.table.core.query({trans:e,limit:n.limit,values:true,query:{index:r,range:n.range}}).then((function(e){var t=e.result;return i?t.map(i):t}))}else{var s=[];return en(n,(function(e){return s.push(e)}),e,n.table.core).then((function(){return s}))}}),e)};e.prototype.offset=function(e){var t=this._ctx;if(e<=0)return this;t.offset+=e;if(qt(t)){Yt(t,(function(){var t=e;return function(e,n){if(t===0)return true;if(t===1){--t;return false}n((function(){e.advance(t);t=0}));return false}}))}else{Yt(t,(function(){var t=e;return function(){return--t<0}}))}return this};e.prototype.limit=function(e){this._ctx.limit=Math.min(this._ctx.limit,e);Yt(this._ctx,(function(){var t=e;return function(e,n,i){if(--t<=0)n(i);return t>=0}}),true);return this};e.prototype.until=function(e,t){Kt(this._ctx,(function(n,i,r){if(e(n.value)){i(r);return t}else{return true}}));return this};e.prototype.first=function(e){return this.limit(1).toArray((function(e){return e[0]})).then(e)};e.prototype.last=function(e){return this.reverse().first(e)};e.prototype.filter=function(e){Kt(this._ctx,(function(t){return e(t.value)}));Jt(this._ctx,e);return this};e.prototype.and=function(e){return this.filter(e)};e.prototype.or=function(e){return new this.db.WhereClause(this._ctx.table,e,this)};e.prototype.reverse=function(){this._ctx.dir=this._ctx.dir==="prev"?"next":"prev";if(this._ondirectionchange)this._ondirectionchange(this._ctx.dir);return this};e.prototype.desc=function(){return this.reverse()};e.prototype.eachKey=function(e){var t=this._ctx;t.keysOnly=!t.isMatch;return this.each((function(t,n){e(n.key,n)}))};e.prototype.eachUniqueKey=function(e){this._ctx.unique="unique";return this.eachKey(e)};e.prototype.eachPrimaryKey=function(e){var t=this._ctx;t.keysOnly=!t.isMatch;return this.each((function(t,n){e(n.primaryKey,n)}))};e.prototype.keys=function(e){var t=this._ctx;t.keysOnly=!t.isMatch;var n=[];return this.each((function(e,t){n.push(t.key)})).then((function(){return n})).then(e)};e.prototype.primaryKeys=function(e){var t=this._ctx;if(t.dir==="next"&&qt(t,true)&&t.limit>0){return this._read((function(e){var n=Qt(t,t.table.core.schema);return t.table.core.query({trans:e,values:false,limit:t.limit,query:{index:n,range:t.range}})})).then((function(e){var t=e.result;return t})).then(e)}t.keysOnly=!t.isMatch;var n=[];return this.each((function(e,t){n.push(t.primaryKey)})).then((function(){return n})).then(e)};e.prototype.uniqueKeys=function(e){this._ctx.unique="unique";return this.keys(e)};e.prototype.firstKey=function(e){return this.limit(1).keys((function(e){return e[0]})).then(e)};e.prototype.lastKey=function(e){return this.reverse().firstKey(e)};e.prototype.distinct=function(){var e=this._ctx,t=e.index&&e.table.schema.idxByName[e.index];if(!t||!t.multi)return this;var n={};Kt(this._ctx,(function(e){var t=e.primaryKey.toString();var i=u(n,t);n[t]=true;return!i}));return this};e.prototype.modify=function(e){var t=this;var n=this._ctx;return this._write((function(i){var s;if(typeof e==="function"){s=e}else{var o=r(e);var a=o.length;s=function t(n){var i=false;for(var r=0;r<a;++r){var s=o[r],l=e[s];if(k(n,s)!==l){C(n,s,l);i=true}}return i}}var l=n.table.core;var u=l.schema.primaryKey,c=u.outbound,f=u.extractKey;var d=t.db._options.modifyChunkSize||200;var h=[];var p=0;var m=[];var g=function e(t,n){var i=n.failures,s=n.numFailures;p+=t-s;for(var o=0,a=r(i);o<a.length;o++){var l=a[o];h.push(i[l])}};return t.clone().primaryKeys().then((function(t){var r=function r(o){var a=Math.min(d,t.length-o);return l.getMany({trans:i,keys:t.slice(o,o+a),cache:"immutable"}).then((function(u){var h=[];var p=[];var m=c?[]:null;var v=[];for(var y=0;y<a;++y){var b=u[y];var w={value:A(b),primKey:t[o+y]};if(s.call(w,w.value,w)!==false){if(w.value==null){v.push(t[o+y])}else if(!c&&nn(f(b),f(w.value))!==0){v.push(t[o+y]);h.push(w.value)}else{p.push(w.value);if(c)m.push(t[o+y])}}}var S=qt(n)&&n.limit===Infinity&&(typeof e!=="function"||e===un)&&{index:n.index,range:n.range};return Promise.resolve(h.length>0&&l.mutate({trans:i,type:"add",values:h}).then((function(e){for(var t in e.failures){v.splice(parseInt(t),1)}g(h.length,e)}))).then((function(){return(p.length>0||S&&babelHelpers["typeof"](e)==="object")&&l.mutate({trans:i,type:"put",keys:m,values:p,criteria:S,changeSpec:typeof e!=="function"&&e}).then((function(e){return g(p.length,e)}))})).then((function(){return(v.length>0||S&&e===un)&&l.mutate({trans:i,type:"delete",keys:v,criteria:S}).then((function(e){return g(v.length,e)}))})).then((function(){return t.length>o+a&&r(o+d)}))}))};return r(0).then((function(){if(h.length>0)throw new Z("Error modifying one or more objects",h,p,m);return t.length}))}))}))};e.prototype["delete"]=function(){var e=this._ctx,t=e.range;if(qt(e)&&(e.isPrimKey&&!Ht||t.type===3)){return this._write((function(n){var i=e.table.core.schema.primaryKey;var r=t;return e.table.core.count({trans:n,query:{index:i,range:r}}).then((function(t){return e.table.core.mutate({trans:n,type:"deleteRange",range:r}).then((function(e){var n=e.failures;e.lastResult;e.results;var i=e.numFailures;if(i)throw new Z("Could not delete some values",Object.keys(n).map((function(e){return n[e]})),t-i);return t-i}))}))}))}return this.modify(un)};return e}();var un=function e(t,n){return n.value=null};function cn(e){return zt(ln.prototype,(function t(n,i){this.db=e;var r=Wt,s=null;if(i)try{r=i()}catch(e){s=e}var o=n._ctx;var a=o.table;var l=a.hook.reading.fire;this._ctx={table:a,index:o.index,isPrimKey:!o.index||a.schema.primKey.keyPath&&o.index===a.schema.primKey.name,range:r,keysOnly:false,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:true,isMatch:null,offset:0,limit:Infinity,error:s,or:o.or,valueMapper:l!==le?l:null}}))}function fn(e,t){return e<t?-1:e===t?0:1}function dn(e,t){return e>t?-1:e===t?0:1}function hn(e,t,n){var i=e instanceof Sn?new e.Collection(e):e;i._ctx.error=n?new n(t):new TypeError(t);return i}function pn(e){return new e.Collection(e,(function(){return wn("")})).limit(0)}function mn(e){return e==="next"?function(e){return e.toUpperCase()}:function(e){return e.toLowerCase()}}function gn(e){return e==="next"?function(e){return e.toLowerCase()}:function(e){return e.toUpperCase()}}function vn(e,t,n,i,r,s){var o=Math.min(e.length,i.length);var a=-1;for(var l=0;l<o;++l){var u=t[l];if(u!==i[l]){if(r(e[l],n[l])<0)return e.substr(0,l)+n[l]+n.substr(l+1);if(r(e[l],i[l])<0)return e.substr(0,l)+i[l]+n.substr(l+1);if(a>=0)return e.substr(0,a)+t[a]+n.substr(a+1);return null}if(r(e[l],u)<0)a=l}if(o<i.length&&s==="next")return e+n.substr(e.length);if(o<e.length&&s==="prev")return e.substr(0,n.length);return a<0?null:e.substr(0,a)+i[a]+n.substr(a+1)}function yn(e,t,n,i){var r,s,o,a,l,u,c,f=n.length;if(!n.every((function(e){return typeof e==="string"}))){return hn(e,At)}function d(e){r=mn(e);s=gn(e);o=e==="next"?fn:dn;var t=n.map((function(e){return{lower:s(e),upper:r(e)}})).sort((function(e,t){return o(e.lower,t.lower)}));a=t.map((function(e){return e.upper}));l=t.map((function(e){return e.lower}));u=e;c=e==="next"?"":i}d("next");var h=new e.Collection(e,(function(){return bn(a[0],l[f-1]+i)}));h._ondirectionchange=function(e){d(e)};var p=0;h._addAlgorithm((function(e,n,i){var r=e.key;if(typeof r!=="string")return false;var d=s(r);if(t(d,l,p)){return true}else{var h=null;for(var m=p;m<f;++m){var g=vn(r,d,a[m],l[m],o,u);if(g===null&&h===null)p=m+1;else if(h===null||o(h,g)>0){h=g}}if(h!==null){n((function(){e["continue"](h+c)}))}else{n(i)}return false}}));return h}function bn(e,t,n,i){return{type:2,lower:e,upper:t,lowerOpen:n,upperOpen:i}}function wn(e){return{type:1,lower:e,upper:e}}var Sn=function(){function e(){}Object.defineProperty(e.prototype,"Collection",{get:function e(){return this._ctx.table.db.Collection},enumerable:false,configurable:true});e.prototype.between=function(e,t,n,i){n=n!==false;i=i===true;try{if(this._cmp(e,t)>0||this._cmp(e,t)===0&&(n||i)&&!(n&&i))return pn(this);return new this.Collection(this,(function(){return bn(e,t,!n,!i)}))}catch(e){return hn(this,Dt)}};e.prototype.equals=function(e){if(e==null)return hn(this,Dt);return new this.Collection(this,(function(){return wn(e)}))};e.prototype.above=function(e){if(e==null)return hn(this,Dt);return new this.Collection(this,(function(){return bn(e,undefined,true)}))};e.prototype.aboveOrEqual=function(e){if(e==null)return hn(this,Dt);return new this.Collection(this,(function(){return bn(e,undefined,false)}))};e.prototype.below=function(e){if(e==null)return hn(this,Dt);return new this.Collection(this,(function(){return bn(undefined,e,false,true)}))};e.prototype.belowOrEqual=function(e){if(e==null)return hn(this,Dt);return new this.Collection(this,(function(){return bn(undefined,e)}))};e.prototype.startsWith=function(e){if(typeof e!=="string")return hn(this,At);return this.between(e,e+Ot,true,true)};e.prototype.startsWithIgnoreCase=function(e){if(e==="")return this.startsWith(e);return yn(this,(function(e,t){return e.indexOf(t[0])===0}),[e],Ot)};e.prototype.equalsIgnoreCase=function(e){return yn(this,(function(e,t){return e===t[0]}),[e],"")};e.prototype.anyOfIgnoreCase=function(){var e=B.apply(N,arguments);if(e.length===0)return pn(this);return yn(this,(function(e,t){return t.indexOf(e)!==-1}),e,"")};e.prototype.startsWithAnyOfIgnoreCase=function(){var e=B.apply(N,arguments);if(e.length===0)return pn(this);return yn(this,(function(e,t){return t.some((function(t){return e.indexOf(t)===0}))}),e,Ot)};e.prototype.anyOf=function(){var e=this;var t=B.apply(N,arguments);var n=this._cmp;try{t.sort(n)}catch(e){return hn(this,Dt)}if(t.length===0)return pn(this);var i=new this.Collection(this,(function(){return bn(t[0],t[t.length-1])}));i._ondirectionchange=function(i){n=i==="next"?e._ascending:e._descending;t.sort(n)};var r=0;i._addAlgorithm((function(e,i,s){var o=e.key;while(n(o,t[r])>0){++r;if(r===t.length){i(s);return false}}if(n(o,t[r])===0){return true}else{i((function(){e["continue"](t[r])}));return false}}));return i};e.prototype.notEqual=function(e){return this.inAnyRange([[Mt,e],[e,this.db._maxKey]],{includeLowers:false,includeUppers:false})};e.prototype.noneOf=function(){var e=B.apply(N,arguments);if(e.length===0)return new this.Collection(this);try{e.sort(this._ascending)}catch(e){return hn(this,Dt)}var t=e.reduce((function(e,t){return e?e.concat([[e[e.length-1][1],t]]):[[Mt,t]]}),null);t.push([e[e.length-1],this.db._maxKey]);return this.inAnyRange(t,{includeLowers:false,includeUppers:false})};e.prototype.inAnyRange=function(e,t){var n=this;var i=this._cmp,r=this._ascending,s=this._descending,o=this._min,a=this._max;if(e.length===0)return pn(this);if(!e.every((function(e){return e[0]!==undefined&&e[1]!==undefined&&r(e[0],e[1])<=0}))){return hn(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",ie.InvalidArgument)}var l=!t||t.includeLowers!==false;var u=t&&t.includeUppers===true;function c(e,t){var n=0,r=e.length;for(;n<r;++n){var s=e[n];if(i(t[0],s[1])<0&&i(t[1],s[0])>0){s[0]=o(s[0],t[0]);s[1]=a(s[1],t[1]);break}}if(n===r)e.push(t);return e}var f=r;function d(e,t){return f(e[0],t[0])}var h;try{h=e.reduce(c,[]);h.sort(d)}catch(e){return hn(this,Dt)}var p=0;var m=u?function(e){return r(e,h[p][1])>0}:function(e){return r(e,h[p][1])>=0};var g=l?function(e){return s(e,h[p][0])>0}:function(e){return s(e,h[p][0])>=0};function v(e){return!m(e)&&!g(e)}var y=m;var b=new this.Collection(this,(function(){return bn(h[0][0],h[h.length-1][1],!l,!u)}));b._ondirectionchange=function(e){if(e==="next"){y=m;f=r}else{y=g;f=s}h.sort(d)};b._addAlgorithm((function(e,t,i){var s=e.key;while(y(s)){++p;if(p===h.length){t(i);return false}}if(v(s)){return true}else if(n._cmp(s,h[p][1])===0||n._cmp(s,h[p][0])===0){return false}else{t((function(){if(f===r)e["continue"](h[p][0]);else e["continue"](h[p][1])}));return false}}));return b};e.prototype.startsWithAnyOf=function(){var e=B.apply(N,arguments);if(!e.every((function(e){return typeof e==="string"}))){return hn(this,"startsWithAnyOf() only works with strings")}if(e.length===0)return pn(this);return this.inAnyRange(e.map((function(e){return[e,e+Ot]})))};return e}();function In(e){return zt(Sn.prototype,(function t(n,i,r){this.db=e;this._ctx={table:n,index:i===":id"?null:i,or:r};var s=e._deps.indexedDB;if(!s)throw new ie.MissingAPI;this._cmp=this._ascending=s.cmp.bind(s);this._descending=function(e,t){return s.cmp(t,e)};this._max=function(e,t){return s.cmp(e,t)>0?e:t};this._min=function(e,t){return s.cmp(e,t)<0?e:t};this._IDBKeyRange=e._deps.IDBKeyRange}))}function kn(e){return st((function(t){Cn(t);e(t.target.error);return false}))}function Cn(e){if(e.stopPropagation)e.stopPropagation();if(e.preventDefault)e.preventDefault()}var En="storagemutated";var _n="x-storagemutated-1";var xn=Gt(null,En);var Tn=function(){function e(){}e.prototype._lock=function(){b(!je.global);++this._reculock;if(this._reculock===1&&!je.global)je.lockOwnerFor=this;return this};e.prototype._unlock=function(){b(!je.global);if(--this._reculock===0){if(!je.global)je.lockOwnerFor=null;while(this._blockedFuncs.length>0&&!this._locked()){var e=this._blockedFuncs.shift();try{wt(e[1],e[0])}catch(e){}}}return this};e.prototype._locked=function(){return this._reculock&&je.lockOwnerFor!==this};e.prototype.create=function(e){var t=this;if(!this.mode)return this;var n=this.db.idbdb;var i=this.db._state.dbOpenError;b(!this.idbtrans);if(!e&&!n){switch(i&&i.name){case"DatabaseClosedError":throw new ie.DatabaseClosed(i);case"MissingAPIError":throw new ie.MissingAPI(i.message,i);default:throw new ie.OpenFailed(i)}}if(!this.active)throw new ie.TransactionInactive;b(this._completion._state===null);e=this.idbtrans=e||(this.db.core?this.db.core.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}):n.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}));e.onerror=st((function(n){Cn(n);t._reject(e.error)}));e.onabort=st((function(n){Cn(n);t.active&&t._reject(new ie.Abort(e.error));t.active=false;t.on("abort").fire(n)}));e.oncomplete=st((function(){t.active=false;t._resolve();if("mutatedParts"in e){xn.storagemutated.fire(e["mutatedParts"])}}));return this};e.prototype._promise=function(e,t,n){var i=this;if(e==="readwrite"&&this.mode!=="readwrite")return _t(new ie.ReadOnly("Transaction is readonly"));if(!this.active)return _t(new ie.TransactionInactive);if(this._locked()){return new Ue((function(r,s){i._blockedFuncs.push([function(){i._promise(e,t,n).then(r,s)},je])}))}else if(n){return dt((function(){var e=new Ue((function(e,n){i._lock();var r=t(e,n,i);if(r&&r.then)r.then(e,n)}));e["finally"]((function(){return i._unlock()}));e._lib=true;return e}))}else{var r=new Ue((function(e,n){var r=t(e,n,i);if(r&&r.then)r.then(e,n)}));r._lib=true;return r}};e.prototype._root=function(){return this.parent?this.parent._root():this};e.prototype.waitFor=function(e){var t=this._root();var n=Ue.resolve(e);if(t._waitingFor){t._waitingFor=t._waitingFor.then((function(){return n}))}else{t._waitingFor=n;t._waitingQueue=[];var i=t.idbtrans.objectStore(t.storeNames[0]);(function e(){++t._spinCount;while(t._waitingQueue.length){t._waitingQueue.shift()()}if(t._waitingFor)i.get(-Infinity).onsuccess=e})()}var r=t._waitingFor;return new Ue((function(e,i){n.then((function(n){return t._waitingQueue.push(st(e.bind(null,n)))}),(function(e){return t._waitingQueue.push(st(i.bind(null,e)))}))["finally"]((function(){if(t._waitingFor===r){t._waitingFor=null}}))}))};e.prototype.abort=function(){if(this.active){this.active=false;if(this.idbtrans)this.idbtrans.abort();this._reject(new ie.Abort)}};e.prototype.table=function(e){var t=this._memoizedTables||(this._memoizedTables={});if(u(t,e))return t[e];var n=this.schema[e];if(!n){throw new ie.NotFound("Table "+e+" not part of transaction")}var i=new this.db.Table(e,n,this);i.core=this.db.core.table(e);t[e]=i;return i};return e}();function On(e){return zt(Tn.prototype,(function t(n,i,r,s,o){var a=this;this.db=e;this.mode=n;this.storeNames=i;this.schema=r;this.chromeTransactionDurability=s;this.idbtrans=null;this.on=Gt(this,"complete","error","abort");this.parent=o||null;this.active=true;this._reculock=0;this._blockedFuncs=[];this._resolve=null;this._reject=null;this._waitingFor=null;this._waitingQueue=null;this._spinCount=0;this._completion=new Ue((function(e,t){a._resolve=e;a._reject=t}));this._completion.then((function(){a.active=false;a.on.complete.fire()}),(function(e){var t=a.active;a.active=false;a.on.error.fire(e);a.parent?a.parent._reject(e):t&&a.idbtrans&&a.idbtrans.abort();return _t(e)}))}))}function Mn(e,t,n,i,r,s,o){return{name:e,keyPath:t,unique:n,multi:i,auto:r,compound:s,src:(n&&!o?"&":"")+(i?"*":"")+(r?"++":"")+Dn(t)}}function Dn(e){return typeof e==="string"?e:e?"["+[].join.call(e,"+")+"]":""}function An(e,t,n){return{name:e,primKey:t,indexes:n,mappedClass:null,idxByName:S(n,(function(e){return[e.name,e]}))}}function Pn(e){return e.length===1?e[0]:e}var Ln=function e(t){try{t.only([[]]);Ln=function e(){return[[]]};return[[]]}catch(e){Ln=function e(){return Ot};return Ot}};function Rn(e){if(e==null){return function(){return undefined}}else if(typeof e==="string"){return Hn(e)}else{return function(t){return k(t,e)}}}function Hn(e){var t=e.split(".");if(t.length===1){return function(t){return t[e]}}else{return function(t){return k(t,e)}}}function jn(e){return[].slice.call(e)}var Nn=0;function Bn(e){return e==null?":id":typeof e==="string"?e:"["+e.join("+")+"]"}function Fn(e,t,n){function i(e,t){var n=jn(e.objectStoreNames);return{schema:{name:e.name,tables:n.map((function(e){return t.objectStore(e)})).map((function(e){var t=e.keyPath,n=e.autoIncrement;var i=s(t);var r=t==null;var o={};var a={name:e.name,primaryKey:{name:null,isPrimaryKey:true,outbound:r,compound:i,keyPath:t,autoIncrement:n,unique:true,extractKey:Rn(t)},indexes:jn(e.indexNames).map((function(t){return e.index(t)})).map((function(e){var t=e.name,n=e.unique,i=e.multiEntry,r=e.keyPath;var a=s(r);var l={name:t,compound:a,keyPath:r,unique:n,multiEntry:i,extractKey:Rn(r)};o[Bn(r)]=l;return l})),getIndexByKeyPath:function e(t){return o[Bn(t)]}};o[":id"]=a.primaryKey;if(t!=null){o[Bn(t)]=a.primaryKey}return a}))},hasGetAll:n.length>0&&"getAll"in t.objectStore(n[0])&&!(typeof navigator!=="undefined"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}function r(e){if(e.type===3)return null;if(e.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var n=e.lower,i=e.upper,r=e.lowerOpen,s=e.upperOpen;var o=n===undefined?i===undefined?null:t.upperBound(i,!!s):i===undefined?t.lowerBound(n,!!r):t.bound(n,i,!!r,!!s);return o}function o(e){var t=e.name;function n(e){var n=e.trans,i=e.type,s=e.keys,o=e.values,a=e.range;return new Promise((function(e,l){e=st(e);var u=n.objectStore(t);var c=u.keyPath==null;var f=i==="put"||i==="add";if(!f&&i!=="delete"&&i!=="deleteRange")throw new Error("Invalid operation type: "+i);var d=(s||o||{length:1}).length;if(s&&o&&s.length!==o.length){throw new Error("Given keys array must have same length as given values array.")}if(d===0)return e({numFailures:0,failures:{},results:[],lastResult:undefined});var h;var p=[];var m=[];var g=0;var v=function e(t){++g;Cn(t)};if(i==="deleteRange"){if(a.type===4)return e({numFailures:g,failures:m,results:[],lastResult:undefined});if(a.type===3)p.push(h=u.clear());else p.push(h=u["delete"](r(a)))}else{var y=f?c?[o,s]:[o,null]:[s,null],b=y[0],w=y[1];if(f){for(var S=0;S<d;++S){p.push(h=w&&w[S]!==undefined?u[i](b[S],w[S]):u[i](b[S]));h.onerror=v}}else{for(var S=0;S<d;++S){p.push(h=u[i](b[S]));h.onerror=v}}}var I=function t(n){var r=n.target.result;p.forEach((function(e,t){return e.error!=null&&(m[t]=e.error)}));e({numFailures:g,failures:m,results:i==="delete"?s:p.map((function(e){return e.result})),lastResult:r})};h.onerror=function(e){v(e);I(e)};h.onsuccess=I}))}function i(e){var n=e.trans,i=e.values,s=e.query,o=e.reverse,a=e.unique;return new Promise((function(e,l){e=st(e);var u=s.index,c=s.range;var f=n.objectStore(t);var d=u.isPrimaryKey?f:f.index(u.name);var h=o?a?"prevunique":"prev":a?"nextunique":"next";var p=i||!("openKeyCursor"in d)?d.openCursor(r(c),h):d.openKeyCursor(r(c),h);p.onerror=kn(l);p.onsuccess=st((function(t){var i=p.result;if(!i){e(null);return}i.___id=++Nn;i.done=false;var r=i["continue"].bind(i);var s=i.continuePrimaryKey;if(s)s=s.bind(i);var o=i.advance.bind(i);var a=function e(){throw new Error("Cursor not started")};var u=function e(){throw new Error("Cursor not stopped")};i.trans=n;i.stop=i["continue"]=i.continuePrimaryKey=i.advance=a;i.fail=st(l);i.next=function(){var e=this;var t=1;return this.start((function(){return t--?e["continue"]():e.stop()})).then((function(){return e}))};i.start=function(e){var t=new Promise((function(e,t){e=st(e);p.onerror=kn(t);i.fail=t;i.stop=function(t){i.stop=i["continue"]=i.continuePrimaryKey=i.advance=u;e(t)}}));var n=function t(){if(p.result){try{e()}catch(e){i.fail(e)}}else{i.done=true;i.start=function(){throw new Error("Cursor behind last entry")};i.stop()}};p.onsuccess=st((function(e){p.onsuccess=n;n()}));i["continue"]=r;i.continuePrimaryKey=s;i.advance=o;n();return t};e(i)}),l)}))}function s(e){return function(n){return new Promise((function(i,s){i=st(i);var o=n.trans,a=n.values,l=n.limit,u=n.query;var c=l===Infinity?undefined:l;var f=u.index,d=u.range;var h=o.objectStore(t);var p=f.isPrimaryKey?h:h.index(f.name);var m=r(d);if(l===0)return i({result:[]});if(e){var g=a?p.getAll(m,c):p.getAllKeys(m,c);g.onsuccess=function(e){return i({result:e.target.result})};g.onerror=kn(s)}else{var v=0;var y=a||!("openKeyCursor"in p)?p.openCursor(m):p.openKeyCursor(m);var b=[];y.onsuccess=function(e){var t=y.result;if(!t)return i({result:b});b.push(a?t.value:t.primaryKey);if(++v===l)return i({result:b});t["continue"]()};y.onerror=kn(s)}}))}}return{name:t,schema:e,mutate:n,getMany:function e(n){var i=n.trans,r=n.keys;return new Promise((function(e,n){e=st(e);var s=i.objectStore(t);var o=r.length;var a=new Array(o);var l=0;var u=0;var c;var f=function t(n){var i=n.target;if((a[i._pos]=i.result)!=null);if(++u===l)e(a)};var d=kn(n);for(var h=0;h<o;++h){var p=r[h];if(p!=null){c=s.get(r[h]);c._pos=h;c.onsuccess=f;c.onerror=d;++l}}if(l===0)e(a)}))},get:function e(n){var i=n.trans,r=n.key;return new Promise((function(e,n){e=st(e);var s=i.objectStore(t);var o=s.get(r);o.onsuccess=function(t){return e(t.target.result)};o.onerror=kn(n)}))},query:s(u),openCursor:i,count:function e(n){var i=n.query,s=n.trans;var o=i.index,a=i.range;return new Promise((function(e,n){var i=s.objectStore(t);var l=o.isPrimaryKey?i:i.index(o.name);var u=r(a);var c=u?l.count(u):l.count();c.onsuccess=st((function(t){return e(t.target.result)}));c.onerror=kn(n)}))}}}var a=i(e,n),l=a.schema,u=a.hasGetAll;var c=l.tables.map((function(e){return o(e)}));var f={};c.forEach((function(e){return f[e.name]=e}));return{stack:"dbcore",transaction:e.transaction.bind(e),table:function e(t){var n=f[t];if(!n)throw new Error("Table '"+t+"' not found");return f[t]},MIN_KEY:-Infinity,MAX_KEY:Ln(t),schema:l}}function Un(e,n){return n.reduce((function(e,n){var i=n.create;return t(t({},e),i(e))}),e)}function Wn(e,t,n,i){var r=n.IDBKeyRange;n.indexedDB;var s=Un(Fn(t,r,i),e.dbcore);return{dbcore:s}}function $n(e,t){var n=e._novip;var i=t.db;var r=Wn(n._middlewares,i,n._deps,t);n.core=r.dbcore;n.tables.forEach((function(e){var t=e.name;if(n.core.schema.tables.some((function(e){return e.name===t}))){e.core=n.core.table(t);if(n[t]instanceof n.Table){n[t].core=e.core}}}))}function Vn(e,t,n,i){var r=e._novip;n.forEach((function(e){var n=i[e];t.forEach((function(t){var i=m(t,e);if(!i||"value"in i&&i.value===undefined){if(t===r.Transaction.prototype||t instanceof r.Transaction){d(t,e,{get:function t(){return this.table(e)},set:function t(n){f(this,e,{value:n,writable:true,configurable:true,enumerable:true})}})}else{t[e]=new r.Table(e,n)}}}))}))}function Gn(e,t){var n=e._novip;t.forEach((function(e){for(var t in e){if(e[t]instanceof n.Table)delete e[t]}}))}function zn(e,t){return e._cfg.version-t._cfg.version}function Xn(e,t,n,i){var s=e._dbSchema;var o=e._createTransaction("readwrite",e._storeNames,s);o.create(n);o._completion["catch"](i);var a=o._reject.bind(o);var l=je.transless||je;dt((function(){je.trans=o;je.transless=l;if(t===0){r(s).forEach((function(e){Yn(n,e,s[e].primKey,s[e].indexes)}));$n(e,n);Ue.follow((function(){return e.on.populate.fire(o)}))["catch"](a)}else qn(e,t,o,n)["catch"](a)}))}function qn(e,t,n,i){var s=e._novip;var o=[];var a=s._versions;var l=s._dbSchema=ei(s,s.idbdb,i);var u=false;var c=a.filter((function(e){return e._cfg.version>=t}));c.forEach((function(e){o.push((function(){var o=l;var a=e._cfg.dbschema;ii(s,o,i);ii(s,a,i);l=s._dbSchema=a;var c=Kn(o,a);c.add.forEach((function(e){Yn(i,e[0],e[1].primKey,e[1].indexes)}));c.change.forEach((function(e){if(e.recreate){throw new ie.Upgrade("Not yet support for changing primary key")}else{var t=i.objectStore(e.name);e.add.forEach((function(e){return Zn(t,e)}));e.change.forEach((function(e){t.deleteIndex(e.name);Zn(t,e)}));e.del.forEach((function(e){return t.deleteIndex(e)}))}}));var f=e._cfg.contentUpgrade;if(f&&e._cfg.version>t){$n(s,i);n._memoizedTables={};u=true;var d=_(a);c.del.forEach((function(e){d[e]=o[e]}));Gn(s,[s.Transaction.prototype]);Vn(s,[s.Transaction.prototype],r(d),d);n.schema=d;var h=F(f);if(h){ht()}var p;var m=Ue.follow((function(){p=f(n);if(p){if(h){var e=pt.bind(null,null);p.then(e,e)}}}));return p&&typeof p.then==="function"?Ue.resolve(p):m.then((function(){return p}))}}));o.push((function(t){if(!u||!Rt){var i=e._cfg.dbschema;Qn(i,t)}Gn(s,[s.Transaction.prototype]);Vn(s,[s.Transaction.prototype],s._storeNames,s._dbSchema);n.schema=s._dbSchema}))}));function f(){return o.length?Ue.resolve(o.shift()(n.idbtrans)).then(f):Ue.resolve()}return f().then((function(){Jn(l,i)}))}function Kn(e,t){var n={del:[],add:[],change:[]};var i;for(i in e){if(!t[i])n.del.push(i)}for(i in t){var r=e[i],s=t[i];if(!r){n.add.push([i,s])}else{var o={name:i,def:s,recreate:false,del:[],add:[],change:[]};if(""+(r.primKey.keyPath||"")!==""+(s.primKey.keyPath||"")||r.primKey.auto!==s.primKey.auto&&!Lt){o.recreate=true;n.change.push(o)}else{var a=r.idxByName;var l=s.idxByName;var u=void 0;for(u in a){if(!l[u])o.del.push(u)}for(u in l){var c=a[u],f=l[u];if(!c)o.add.push(f);else if(c.src!==f.src)o.change.push(f)}if(o.del.length>0||o.add.length>0||o.change.length>0){n.change.push(o)}}}}return n}function Yn(e,t,n,i){var r=e.db.createObjectStore(t,n.keyPath?{keyPath:n.keyPath,autoIncrement:n.auto}:{autoIncrement:n.auto});i.forEach((function(e){return Zn(r,e)}));return r}function Jn(e,t){r(e).forEach((function(n){if(!t.db.objectStoreNames.contains(n)){Yn(t,n,e[n].primKey,e[n].indexes)}}))}function Qn(e,t){[].slice.call(t.db.objectStoreNames).forEach((function(n){return e[n]==null&&t.db.deleteObjectStore(n)}))}function Zn(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function ei(e,t,n){var i={};var r=v(t.objectStoreNames,0);r.forEach((function(e){var t=n.objectStore(e);var r=t.keyPath;var s=Mn(Dn(r),r||"",false,false,!!t.autoIncrement,r&&typeof r!=="string",true);var o=[];for(var a=0;a<t.indexNames.length;++a){var l=t.index(t.indexNames[a]);r=l.keyPath;var u=Mn(l.name,r,!!l.unique,!!l.multiEntry,false,r&&typeof r!=="string",false);o.push(u)}i[e]=An(e,s,o)}));return i}function ti(e,t,n){var i=e._novip;i.verno=t.version/10;var s=i._dbSchema=ei(i,t,n);i._storeNames=v(t.objectStoreNames,0);Vn(i,[i._allTables],r(s),s)}function ni(e,t){var n=ei(e,e.idbdb,t);var i=Kn(n,e._dbSchema);return!(i.add.length||i.change.some((function(e){return e.add.length||e.change.length})))}function ii(e,t,n){var r=e._novip;var s=n.db.objectStoreNames;for(var o=0;o<s.length;++o){var a=s[o];var l=n.objectStore(a);r._hasGetAll="getAll"in l;for(var u=0;u<l.indexNames.length;++u){var c=l.indexNames[u];var f=l.index(c).keyPath;var d=typeof f==="string"?f:"["+v(f).join("+")+"]";if(t[a]){var h=t[a].idxByName[d];if(h){h.name=c;delete t[a].idxByName[d];t[a].idxByName[c]=h}}}}if(typeof navigator!=="undefined"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&i.WorkerGlobalScope&&i instanceof i.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604){r._hasGetAll=false}}function ri(e){return e.split(",").map((function(e,t){e=e.trim();var n=e.replace(/([&*]|\+\+)/g,"");var i=/^\[/.test(n)?n.match(/^\[(.*)\]$/)[1].split("+"):n;return Mn(n,i||null,/\&/.test(e),/\*/.test(e),/\+\+/.test(e),s(i),t===0)}))}var si=function(){function e(){}e.prototype._parseStoresSpec=function(e,t){r(e).forEach((function(n){if(e[n]!==null){var i=ri(e[n]);var r=i.shift();if(r.multi)throw new ie.Schema("Primary key cannot be multi-valued");i.forEach((function(e){if(e.auto)throw new ie.Schema("Only primary key can be marked as autoIncrement (++)");if(!e.keyPath)throw new ie.Schema("Index must have a name and cannot be an empty string")}));t[n]=An(n,r,i)}}))};e.prototype.stores=function(e){var t=this.db;this._cfg.storesSource=this._cfg.storesSource?o(this._cfg.storesSource,e):e;var n=t._versions;var i={};var s={};n.forEach((function(e){o(i,e._cfg.storesSource);s=e._cfg.dbschema={};e._parseStoresSpec(i,s)}));t._dbSchema=s;Gn(t,[t._allTables,t,t.Transaction.prototype]);Vn(t,[t._allTables,t,t.Transaction.prototype,this._cfg.tables],r(s),s);t._storeNames=r(s);return this};e.prototype.upgrade=function(e){this._cfg.contentUpgrade=me(this._cfg.contentUpgrade||ae,e);return this};return e}();function oi(e){return zt(si.prototype,(function t(n){this.db=e;this._cfg={version:n,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}}))}function ai(e,t){var n=e["_dbNamesDB"];if(!n){n=e["_dbNamesDB"]=new Ni(Nt,{addons:[],indexedDB:e,IDBKeyRange:t});n.version(1).stores({dbnames:"name"})}return n.table("dbnames")}function li(e){return e&&typeof e.databases==="function"}function ui(e){var t=e.indexedDB,n=e.IDBKeyRange;return li(t)?Promise.resolve(t.databases()).then((function(e){return e.map((function(e){return e.name})).filter((function(e){return e!==Nt}))})):ai(t,n).toCollection().primaryKeys()}function ci(e,t){var n=e.indexedDB,i=e.IDBKeyRange;!li(n)&&t!==Nt&&ai(n,i).put({name:t})["catch"](ae)}function fi(e,t){var n=e.indexedDB,i=e.IDBKeyRange;!li(n)&&t!==Nt&&ai(n,i)["delete"](t)["catch"](ae)}function di(e){return dt((function(){je.letThrough=true;return e()}))}function hi(){var e=!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent);if(!e||!indexedDB.databases)return Promise.resolve();var t;return new Promise((function(e){var n=function t(){return indexedDB.databases()["finally"](e)};t=setInterval(n,100);n()}))["finally"]((function(){return clearInterval(t)}))}function pi(e){var t=e._state;var n=e._deps.indexedDB;if(t.isBeingOpened||e.idbdb)return t.dbReadyPromise.then((function(){return t.dbOpenError?_t(t.dbOpenError):e}));U&&(t.openCanceller._stackHolder=G());t.isBeingOpened=true;t.dbOpenError=null;t.openComplete=false;var i=t.openCanceller;function r(){if(t.openCanceller!==i)throw new ie.DatabaseClosed("db.open() was cancelled")}var s=t.dbReadyResolve,o=null,a=false;return Ue.race([i,(typeof navigator==="undefined"?Ue.resolve():hi()).then((function(){return new Ue((function(i,s){r();if(!n)throw new ie.MissingAPI;var l=e.name;var u=t.autoSchema?n.open(l):n.open(l,Math.round(e.verno*10));if(!u)throw new ie.MissingAPI;u.onerror=kn(s);u.onblocked=st(e._fireOnBlocked);u.onupgradeneeded=st((function(i){o=u.transaction;if(t.autoSchema&&!e._options.allowEmptyDB){u.onerror=Cn;o.abort();u.result.close();var r=n.deleteDatabase(l);r.onsuccess=r.onerror=st((function(){s(new ie.NoSuchDatabase("Database "+l+" doesnt exist"))}))}else{o.onerror=kn(s);var c=i.oldVersion>Math.pow(2,62)?0:i.oldVersion;a=c<1;e._novip.idbdb=u.result;Xn(e,c/10,o,s)}}),s);u.onsuccess=st((function(){o=null;var n=e._novip.idbdb=u.result;var r=v(n.objectStoreNames);if(r.length>0)try{var s=n.transaction(Pn(r),"readonly");if(t.autoSchema)ti(e,n,s);else{ii(e,e._dbSchema,s);if(!ni(e,s)){console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Some queries may fail.")}}$n(e,s)}catch(e){}Pt.push(e);n.onversionchange=st((function(n){t.vcFired=true;e.on("versionchange").fire(n)}));n.onclose=st((function(t){e.on("close").fire(t)}));if(a)ci(e._deps,l);i()}),s)}))}))]).then((function(){r();t.onReadyBeingFired=[];return Ue.resolve(di((function(){return e.on.ready.fire(e.vip)}))).then((function n(){if(t.onReadyBeingFired.length>0){var i=t.onReadyBeingFired.reduce(me,ae);t.onReadyBeingFired=[];return Ue.resolve(di((function(){return i(e.vip)}))).then(n)}}))}))["finally"]((function(){t.onReadyBeingFired=null;t.isBeingOpened=false})).then((function(){return e}))["catch"]((function(n){t.dbOpenError=n;try{o&&o.abort()}catch(e){}if(i===t.openCanceller){e._close()}return _t(n)}))["finally"]((function(){t.openComplete=true;s()}))}function mi(e){var t=function t(n){return e.next(n)},n=function t(n){return e["throw"](n)},i=o(t),r=o(n);function o(e){return function(t){var n=e(t),o=n.value;return n.done?o:!o||typeof o.then!=="function"?s(o)?Promise.all(o).then(i,r):i(o):o.then(i,r)}}return o(t)()}function gi(e,t,n){var i=arguments.length;if(i<2)throw new ie.InvalidArgument("Too few arguments");var r=new Array(i-1);while(--i){r[i-1]=arguments[i]}n=r.pop();var s=T(r);return[e,s,n]}function vi(e,t,n,i,r){return Ue.resolve().then((function(){var s=je.transless||je;var o=e._createTransaction(t,n,e._dbSchema,i);var a={trans:o,transless:s};if(i){o.idbtrans=i.idbtrans}else{try{o.create();e._state.PR1398_maxLoop=3}catch(i){if(i.name===te.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0){console.warn("Dexie: Need to reopen db");e._close();return e.open().then((function(){return vi(e,t,n,null,r)}))}return _t(i)}}var l=F(r);if(l){ht()}var u;var c=Ue.follow((function(){u=r.call(o,o);if(u){if(l){var e=pt.bind(null,null);u.then(e,e)}else if(typeof u.next==="function"&&typeof u["throw"]==="function"){u=mi(u)}}}),a);return(u&&typeof u.then==="function"?Ue.resolve(u).then((function(e){return o.active?e:_t(new ie.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))})):c.then((function(){return u}))).then((function(e){if(i)o._resolve();return o._completion.then((function(){return e}))}))["catch"]((function(e){o._reject(e);return _t(e)}))}))}function yi(e,t,n){var i=s(e)?e.slice():[e];for(var r=0;r<n;++r){i.push(t)}return i}function bi(e){return t(t({},e),{table:function n(i){var n=e.table(i);var r=n.schema;var s={};var o=[];function a(e,n,i){var r=Bn(e);var l=s[r]=s[r]||[];var u=e==null?0:typeof e==="string"?1:e.length;var c=n>0;var f=t(t({},i),{isVirtual:c,keyTail:n,keyLength:u,extractKey:Rn(e),unique:!c&&i.unique});l.push(f);if(!f.isPrimaryKey){o.push(f)}if(u>1){var d=u===2?e[0]:e.slice(0,u-1);a(d,n+1,i)}l.sort((function(e,t){return e.keyTail-t.keyTail}));return f}var l=a(r.primaryKey.keyPath,0,r.primaryKey);s[":id"]=[l];for(var u=0,c=r.indexes;u<c.length;u++){var f=c[u];a(f.keyPath,0,f)}function d(e){var t=s[Bn(e)];return t&&t[0]}function h(t,n){return{type:t.type===1?2:t.type,lower:yi(t.lower,t.lowerOpen?e.MAX_KEY:e.MIN_KEY,n),lowerOpen:true,upper:yi(t.upper,t.upperOpen?e.MIN_KEY:e.MAX_KEY,n),upperOpen:true}}function p(e){var n=e.query.index;return n.isVirtual?t(t({},e),{query:{index:n,range:h(e.query.range,n.keyTail)}}):e}var m=t(t({},n),{schema:t(t({},r),{primaryKey:l,indexes:o,getIndexByKeyPath:d}),count:function e(t){return n.count(p(t))},query:function e(t){return n.query(p(t))},openCursor:function t(i){var r=i.query.index,s=r.keyTail,o=r.isVirtual,a=r.keyLength;if(!o)return n.openCursor(i);function l(t){function n(n){n!=null?t["continue"](yi(n,i.reverse?e.MAX_KEY:e.MIN_KEY,s)):i.unique?t["continue"](t.key.slice(0,a).concat(i.reverse?e.MIN_KEY:e.MAX_KEY,s)):t["continue"]()}var r=Object.create(t,{continue:{value:n},continuePrimaryKey:{value:function n(i,r){t.continuePrimaryKey(yi(i,e.MAX_KEY,s),r)}},primaryKey:{get:function e(){return t.primaryKey}},key:{get:function e(){var n=t.key;return a===1?n[0]:n.slice(0,a)}},value:{get:function e(){return t.value}}});return r}return n.openCursor(p(i)).then((function(e){return e&&l(e)}))}});return m}})}var wi={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:bi};function Si(e,t,n,i){n=n||{};i=i||"";r(e).forEach((function(r){if(!u(t,r)){n[i+r]=undefined}else{var s=e[r],o=t[r];if(babelHelpers["typeof"](s)==="object"&&babelHelpers["typeof"](o)==="object"&&s&&o){var a=R(s);var l=R(o);if(a!==l){n[i+r]=t[r]}else if(a==="Object"){Si(s,o,n,i+r+".")}else if(s!==o){n[i+r]=t[r]}}else if(s!==o)n[i+r]=t[r]}}));r(t).forEach((function(r){if(!u(e,r)){n[i+r]=t[r]}}));return n}function Ii(e,t){if(t.type==="delete")return t.keys;return t.keys||t.values.map(e.extractKey)}var ki={stack:"dbcore",name:"HooksMiddleware",level:2,create:function e(i){return t(t({},i),{table:function e(r){var s=i.table(r);var o=s.schema.primaryKey;var a=t(t({},s),{mutate:function e(i){var a=je.trans;var l=a.table(r).hook,c=l.deleting,f=l.creating,d=l.updating;switch(i.type){case"add":if(f.fire===ae)break;return a._promise("readwrite",(function(){return h(i)}),true);case"put":if(f.fire===ae&&d.fire===ae)break;return a._promise("readwrite",(function(){return h(i)}),true);case"delete":if(c.fire===ae)break;return a._promise("readwrite",(function(){return h(i)}),true);case"deleteRange":if(c.fire===ae)break;return a._promise("readwrite",(function(){return p(i)}),true)}return s.mutate(i);function h(e){var i=je.trans;var r=e.keys||Ii(o,e);if(!r)throw new Error("Keys missing");e=e.type==="add"||e.type==="put"?t(t({},e),{keys:r}):t({},e);if(e.type!=="delete")e.values=n([],e.values,true);if(e.keys)e.keys=n([],e.keys,true);return Ci(s,e,r).then((function(t){var n=r.map((function(n,r){var s=t[r];var a={onerror:null,onsuccess:null};if(e.type==="delete"){c.fire.call(a,n,s,i)}else if(e.type==="add"||s===undefined){var l=f.fire.call(a,n,e.values[r],i);if(n==null&&l!=null){n=l;e.keys[r]=n;if(!o.outbound){C(e.values[r],o.keyPath,n)}}}else{var h=Si(s,e.values[r]);var p=d.fire.call(a,h,n,s,i);if(p){var m=e.values[r];Object.keys(p).forEach((function(e){if(u(m,e)){m[e]=p[e]}else{C(m,e,p[e])}}))}}return a}));return s.mutate(e).then((function(i){var s=i.failures,o=i.results,a=i.numFailures,l=i.lastResult;for(var u=0;u<r.length;++u){var c=o?o[u]:r[u];var f=n[u];if(c==null){f.onerror&&f.onerror(s[u])}else{f.onsuccess&&f.onsuccess(e.type==="put"&&t[u]?e.values[u]:c)}}return{failures:s,results:o,numFailures:a,lastResult:l}}))["catch"]((function(e){n.forEach((function(t){return t.onerror&&t.onerror(e)}));return Promise.reject(e)}))}))}function p(e){return m(e.trans,e.range,1e4)}function m(e,n,i){return s.query({trans:e,values:false,query:{index:o,range:n},limit:i}).then((function(r){var s=r.result;return h({type:"delete",keys:s,trans:e}).then((function(r){if(r.numFailures>0)return Promise.reject(r.failures[0]);if(s.length<i){return{failures:[],numFailures:0,lastResult:undefined}}else{return m(e,t(t({},n),{lower:s[s.length-1],lowerOpen:true}),i)}}))}))}}});return a}})}};function Ci(e,t,n){return t.type==="add"?Promise.resolve([]):e.getMany({trans:t.trans,keys:n,cache:"immutable"})}function Ei(e,t,n){try{if(!t)return null;if(t.keys.length<e.length)return null;var i=[];for(var r=0,s=0;r<t.keys.length&&s<e.length;++r){if(nn(t.keys[r],e[s])!==0)continue;i.push(n?A(t.values[r]):t.values[r]);++s}return i.length===e.length?i:null}catch(e){return null}}var _i={stack:"dbcore",level:-1,create:function e(n){return{table:function e(i){var e=n.table(i);return t(t({},e),{getMany:function t(n){if(!n.cache){return e.getMany(n)}var i=Ei(n.keys,n.trans["_cache"],n.cache==="clone");if(i){return Ue.resolve(i)}return e.getMany(n).then((function(e){n.trans["_cache"]={keys:n.keys,values:n.cache==="clone"?A(e):e};return e}))},mutate:function t(n){if(n.type!=="add")n.trans["_cache"]=null;return e.mutate(n)}})}}}};var xi;function Ti(e){return!("from"in e)}var Oi=function e(t,n){if(this){o(this,arguments.length?{d:1,from:t,to:arguments.length>1?n:t}:{d:0})}else{var i=new e;if(t&&"d"in t){o(i,t)}return i}};c(Oi.prototype,(xi={add:function e(t){Di(this,t);return this},addKey:function e(t){Mi(this,t,t);return this},addKeys:function e(t){var n=this;t.forEach((function(e){return Mi(n,e,e)}));return this}},xi[H]=function(){return Pi(this)},xi));function Mi(e,t,n){var i=nn(t,n);if(isNaN(i))return;if(i>0)throw RangeError();if(Ti(e))return o(e,{from:t,to:n,d:1});var r=e.l;var s=e.r;if(nn(n,e.from)<0){r?Mi(r,t,n):e.l={from:t,to:n,d:1,l:null,r:null};return Li(e)}if(nn(t,e.to)>0){s?Mi(s,t,n):e.r={from:t,to:n,d:1,l:null,r:null};return Li(e)}if(nn(t,e.from)<0){e.from=t;e.l=null;e.d=s?s.d+1:1}if(nn(n,e.to)>0){e.to=n;e.r=null;e.d=e.l?e.l.d+1:1}var a=!e.r;if(r&&!e.l){Di(e,r)}if(s&&a){Di(e,s)}}function Di(e,t){function n(e,t){var i=t.from,r=t.to,s=t.l,o=t.r;Mi(e,i,r);if(s)n(e,s);if(o)n(e,o)}if(!Ti(t))n(e,t)}function Ai(e,t){var n=Pi(t);var i=n.next();if(i.done)return false;var r=i.value;var s=Pi(e);var o=s.next(r.from);var a=o.value;while(!i.done&&!o.done){if(nn(a.from,r.to)<=0&&nn(a.to,r.from)>=0)return true;nn(r.from,a.from)<0?r=(i=n.next(a.from)).value:a=(o=s.next(r.from)).value}return false}function Pi(e){var t=Ti(e)?null:{s:0,n:e};return{next:function e(n){var i=arguments.length>0;while(t){switch(t.s){case 0:t.s=1;if(i){while(t.n.l&&nn(n,t.n.from)<0){t={up:t,n:t.n.l,s:1}}}else{while(t.n.l){t={up:t,n:t.n.l,s:1}}}case 1:t.s=2;if(!i||nn(n,t.n.to)<=0)return{value:t.n,done:false};case 2:if(t.n.r){t.s=3;t={up:t,n:t.n.r,s:0};continue}case 3:t=t.up}}return{done:true}}}}function Li(e){var n,i;var r=(((n=e.r)===null||n===void 0?void 0:n.d)||0)-(((i=e.l)===null||i===void 0?void 0:i.d)||0);var s=r>1?"r":r<-1?"l":"";if(s){var o=s==="r"?"l":"r";var a=t({},e);var l=e[s];e.from=l.from;e.to=l.to;e[s]=l[s];a[s]=l[o];e[o]=a;a.d=Ri(a)}e.d=Ri(e)}function Ri(e){var t=e.r,n=e.l;return(t?n?Math.max(t.d,n.d):t.d:n?n.d:0)+1}var Hi={stack:"dbcore",level:0,create:function e(n){var i=n.schema.name;var o=new Oi(n.MIN_KEY,n.MAX_KEY);return t(t({},n),{table:function e(a){var e=n.table(a);var l=e.schema;var u=l.primaryKey;var c=u.extractKey,f=u.outbound;var d=t(t({},e),{mutate:function t(n){var r=n.trans;var u=r.mutatedParts||(r.mutatedParts={});var c=function e(t){var n="idb://"+i+"/"+a+"/"+t;return u[n]||(u[n]=new Oi)};var f=c("");var d=c(":dels");var h=n.type;var p=n.type==="deleteRange"?[n.range]:n.type==="delete"?[n.keys]:n.values.length<50?[[],n.values]:[],m=p[0],g=p[1];var v=n.trans["_cache"];return e.mutate(n).then((function(e){if(s(m)){if(h!=="delete")m=e.results;f.addKeys(m);var t=Ei(m,v);if(!t&&h!=="add"){d.addKeys(m)}if(t||g){ji(c,l,t,g)}}else if(m){var n={from:m.lower,to:m.upper};d.add(n);f.add(n)}else{f.add(o);d.add(o);l.indexes.forEach((function(e){return c(e.name).add(o)}))}return e}))}});var h=function e(t){var i,r;var s=t.query,o=s.index,a=s.range;return[o,new Oi((i=a.lower)!==null&&i!==void 0?i:n.MIN_KEY,(r=a.upper)!==null&&r!==void 0?r:n.MAX_KEY)]};var p={get:function e(t){return[u,new Oi(t.key)]},getMany:function e(t){return[u,(new Oi).addKeys(t.keys)]},count:h,query:h,openCursor:h};r(p).forEach((function(n){d[n]=function(r){var s=je.subscr;if(s){var l=function e(t){var n="idb://"+i+"/"+a+"/"+t;return s[n]||(s[n]=new Oi)};var u=l("");var d=l(":dels");var h=p[n](r),m=h[0],g=h[1];l(m.name||"").add(g);if(!m.isPrimaryKey){if(n==="count"){d.add(o)}else{var v=n==="query"&&f&&r.values&&e.query(t(t({},r),{values:false}));return e[n].apply(this,arguments).then((function(e){if(n==="query"){if(f&&r.values){return v.then((function(t){var n=t.result;u.addKeys(n);return e}))}var t=r.values?e.result.map(c):e.result;if(r.values){u.addKeys(t)}else{d.addKeys(t)}}else if(n==="openCursor"){var i=e;var s=r.values;return i&&Object.create(i,{key:{get:function e(){d.addKey(i.primaryKey);return i.key}},primaryKey:{get:function e(){var t=i.primaryKey;d.addKey(t);return t}},value:{get:function e(){s&&u.addKey(i.primaryKey);return i.value}}})}return e}))}}}return e[n].apply(this,arguments)}}));return d}})}};function ji(e,t,n,i){function r(t){var r=e(t.name||"");function o(e){return e!=null?t.extractKey(e):null}var a=function e(n){return t.multiEntry&&s(n)?n.forEach((function(e){return r.addKey(e)})):r.addKey(n)};(n||i).forEach((function(e,t){var r=n&&o(n[t]);var s=i&&o(i[t]);if(nn(r,s)!==0){if(r!=null)a(r);if(s!=null)a(s)}}))}t.indexes.forEach(r)}var Ni=function(){function e(n,i){var r=this;this._middlewares={};this.verno=0;var s=e.dependencies;this._options=i=t({addons:e.addons,autoOpen:true,indexedDB:s.indexedDB,IDBKeyRange:s.IDBKeyRange},i);this._deps={indexedDB:i.indexedDB,IDBKeyRange:i.IDBKeyRange};var o=i.addons;this._dbSchema={};this._versions=[];this._storeNames=[];this._allTables={};this.idbdb=null;this._novip=this;var a={dbOpenError:null,isBeingOpened:false,onReadyBeingFired:null,openComplete:false,dbReadyResolve:ae,dbReadyPromise:null,cancelOpen:ae,openCanceller:null,autoSchema:true,PR1398_maxLoop:3};a.dbReadyPromise=new Ue((function(e){a.dbReadyResolve=e}));a.openCanceller=new Ue((function(e,t){a.cancelOpen=t}));this._state=a;this.name=n;this.on=Gt(this,"populate","blocked","versionchange","close",{ready:[me,ae]});this.on.ready.subscribe=y(this.on.ready.subscribe,(function(t){return function(n,i){e.vip((function(){var e=r._state;if(e.openComplete){if(!e.dbOpenError)Ue.resolve().then(n);if(i)t(n)}else if(e.onReadyBeingFired){e.onReadyBeingFired.push(n);if(i)t(n)}else{t(n);var s=r;if(!i)t((function e(){s.on.ready.unsubscribe(n);s.on.ready.unsubscribe(e)}))}}))}}));this.Collection=cn(this);this.Table=Xt(this);this.Transaction=On(this);this.Version=oi(this);this.WhereClause=In(this);this.on("versionchange",(function(e){if(e.newVersion>0)console.warn("Another connection wants to upgrade database '"+r.name+"'. Closing db now to resume the upgrade.");else console.warn("Another connection wants to delete database '"+r.name+"'. Closing db now to resume the delete request.");r.close()}));this.on("blocked",(function(e){if(!e.newVersion||e.newVersion<e.oldVersion)console.warn("Dexie.delete('"+r.name+"') was blocked");else console.warn("Upgrade '"+r.name+"' blocked by other connection holding version "+e.oldVersion/10)}));this._maxKey=Ln(i.IDBKeyRange);this._createTransaction=function(e,t,n,i){return new r.Transaction(e,t,n,r._options.chromeTransactionDurability,i)};this._fireOnBlocked=function(e){r.on("blocked").fire(e);Pt.filter((function(e){return e.name===r.name&&e!==r&&!e._state.vcFired})).map((function(t){return t.on("versionchange").fire(e)}))};this.use(wi);this.use(ki);this.use(Hi);this.use(_i);this.vip=Object.create(this,{_vip:{value:true}});o.forEach((function(e){return e(r)}))}e.prototype.version=function(e){if(isNaN(e)||e<.1)throw new ie.Type("Given version is not a positive number");e=Math.round(e*10)/10;if(this.idbdb||this._state.isBeingOpened)throw new ie.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);var t=this._versions;var n=t.filter((function(t){return t._cfg.version===e}))[0];if(n)return n;n=new this.Version(e);t.push(n);t.sort(zn);n.stores({});this._state.autoSchema=false;return n};e.prototype._whenReady=function(e){var t=this;return this.idbdb&&(this._state.openComplete||je.letThrough||this._vip)?e():new Ue((function(e,n){if(t._state.openComplete){return n(new ie.DatabaseClosed(t._state.dbOpenError))}if(!t._state.isBeingOpened){if(!t._options.autoOpen){n(new ie.DatabaseClosed);return}t.open()["catch"](ae)}t._state.dbReadyPromise.then(e,n)})).then(e)};e.prototype.use=function(e){var t=e.stack,n=e.create,i=e.level,r=e.name;if(r)this.unuse({stack:t,name:r});var s=this._middlewares[t]||(this._middlewares[t]=[]);s.push({stack:t,create:n,level:i==null?10:i,name:r});s.sort((function(e,t){return e.level-t.level}));return this};e.prototype.unuse=function(e){var t=e.stack,n=e.name,i=e.create;if(t&&this._middlewares[t]){this._middlewares[t]=this._middlewares[t].filter((function(e){return i?e.create!==i:n?e.name!==n:false}))}return this};e.prototype.open=function(){return pi(this)};e.prototype._close=function(){var e=this._state;var t=Pt.indexOf(this);if(t>=0)Pt.splice(t,1);if(this.idbdb){try{this.idbdb.close()}catch(e){}this._novip.idbdb=null}e.dbReadyPromise=new Ue((function(t){e.dbReadyResolve=t}));e.openCanceller=new Ue((function(t,n){e.cancelOpen=n}))};e.prototype.close=function(){this._close();var e=this._state;this._options.autoOpen=false;e.dbOpenError=new ie.DatabaseClosed;if(e.isBeingOpened)e.cancelOpen(e.dbOpenError)};e.prototype["delete"]=function(){var e=this;var t=arguments.length>0;var n=this._state;return new Ue((function(i,r){var s=function t(){e.close();var n=e._deps.indexedDB.deleteDatabase(e.name);n.onsuccess=st((function(){fi(e._deps,e.name);i()}));n.onerror=kn(r);n.onblocked=e._fireOnBlocked};if(t)throw new ie.InvalidArgument("Arguments not allowed in db.delete()");if(n.isBeingOpened){n.dbReadyPromise.then(s)}else{s()}}))};e.prototype.backendDB=function(){return this.idbdb};e.prototype.isOpen=function(){return this.idbdb!==null};e.prototype.hasBeenClosed=function(){var e=this._state.dbOpenError;return e&&e.name==="DatabaseClosed"};e.prototype.hasFailed=function(){return this._state.dbOpenError!==null};e.prototype.dynamicallyOpened=function(){return this._state.autoSchema};Object.defineProperty(e.prototype,"tables",{get:function e(){var t=this;return r(this._allTables).map((function(e){return t._allTables[e]}))},enumerable:false,configurable:true});e.prototype.transaction=function(){var e=gi.apply(this,arguments);return this._transaction.apply(this,e)};e.prototype._transaction=function(e,t,n){var i=this;var r=je.trans;if(!r||r.db!==this||e.indexOf("!")!==-1)r=null;var s=e.indexOf("?")!==-1;e=e.replace("!","").replace("?","");var o,a;try{a=t.map((function(e){var t=e instanceof i.Table?e.name:e;if(typeof t!=="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return t}));if(e=="r"||e===Bt)o=Bt;else if(e=="rw"||e==Ft)o=Ft;else throw new ie.InvalidArgument("Invalid transaction mode: "+e);if(r){if(r.mode===Bt&&o===Ft){if(s){r=null}else throw new ie.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY")}if(r){a.forEach((function(e){if(r&&r.storeNames.indexOf(e)===-1){if(s){r=null}else throw new ie.SubTransaction("Table "+e+" not included in parent transaction.")}}))}if(s&&r&&!r.active){r=null}}}catch(e){return r?r._promise(null,(function(t,n){n(e)})):_t(e)}var l=vi.bind(null,this,o,a,r,n);return r?r._promise(o,l,"lock"):je.trans?wt(je.transless,(function(){return i._whenReady(l)})):this._whenReady(l)};e.prototype.table=function(e){if(!u(this._allTables,e)){throw new ie.InvalidTable("Table "+e+" does not exist")}return this._allTables[e]};return e}();var Bi=typeof Symbol!=="undefined"&&"observable"in Symbol?Symbol.observable:"@@observable";var Fi=function(){function e(e){this._subscribe=e}e.prototype.subscribe=function(e,t,n){return this._subscribe(!e||typeof e==="function"?{next:e,error:t,complete:n}:e)};e.prototype[Bi]=function(){return this};return e}();function Ui(e,t){r(t).forEach((function(n){var i=e[n]||(e[n]=new Oi);Di(i,t[n])}));return e}function Wi(e){return new Fi((function(t){var n=F(e);function i(t){if(n){ht()}var i=function n(){return dt(e,{subscr:t,trans:null})};var r=je.trans?wt(je.transless,i):i();if(n){r.then(pt,pt)}return r}var s=false;var o={};var a={};var l={get closed(){return s},unsubscribe:function e(){s=true;xn.storagemutated.unsubscribe(d)}};t.start&&t.start(l);var u=false,c=false;function f(){return r(a).some((function(e){return o[e]&&Ai(o[e],a[e])}))}var d=function e(t){Ui(o,t);if(f()){h()}};var h=function e(){if(u||s)return;o={};var n={};var r=i(n);if(!c){xn(En,d);c=true}u=true;Promise.resolve(r).then((function(i){u=false;if(s)return;if(f()){e()}else{o={};a=n;t.next&&t.next(i)}}),(function(e){u=false;t.error&&t.error(e);l.unsubscribe()}))};h();return l}))}var $i;try{$i={indexedDB:i.indexedDB||i.mozIndexedDB||i.webkitIndexedDB||i.msIndexedDB,IDBKeyRange:i.IDBKeyRange||i.webkitIDBKeyRange}}catch(e){$i={indexedDB:null,IDBKeyRange:null}}var Vi=Ni;c(Vi,t(t({},oe),{delete:function e(t){var n=new Vi(t,{addons:[]});return n["delete"]()},exists:function e(t){return new Vi(t,{addons:[]}).open().then((function(e){e.close();return true}))["catch"]("NoSuchDatabaseError",(function(){return false}))},getDatabaseNames:function e(t){try{return ui(Vi.dependencies).then(t)}catch(e){return _t(new ie.MissingAPI)}},defineClass:function e(){function t(e){o(this,e)}return t},ignoreTransaction:function e(t){return je.trans?wt(je.transless,t):t()},vip:di,async:function e(t){return function(){try{var e=mi(t.apply(this,arguments));if(!e||typeof e.then!=="function")return Ue.resolve(e);return e}catch(e){return _t(e)}}},spawn:function e(t,n,i){try{var r=mi(t.apply(i,n||[]));if(!r||typeof r.then!=="function")return Ue.resolve(r);return r}catch(e){return _t(e)}},currentTransaction:{get:function e(){return je.trans||null}},waitFor:function e(t,n){var i=Ue.resolve(typeof t==="function"?Vi.ignoreTransaction(t):t).timeout(n||6e4);return je.trans?je.trans.waitFor(i):i},Promise:Ue,debug:{get:function e(){return U},set:function e(t){W(t,t==="dexie"?function(){return true}:jt)}},derive:h,extend:o,props:c,override:y,Events:Gt,on:xn,liveQuery:Wi,extendObservabilitySet:Ui,getByKeyPath:k,setByKeyPath:C,delByKeyPath:E,shallowClone:_,deepClone:A,getObjectDiff:Si,cmp:nn,asap:w,minKey:Mt,addons:[],connections:Pt,errnames:te,dependencies:$i,semVer:Tt,version:Tt.split(".").map((function(e){return parseInt(e)})).reduce((function(e,t,n){return e+t/Math.pow(10,n*2)}))}));Vi.maxKey=Ln(Vi.dependencies.IDBKeyRange);if(typeof dispatchEvent!=="undefined"&&typeof addEventListener!=="undefined"){xn(En,(function(e){if(!zi){var t;if(Lt){t=document.createEvent("CustomEvent");t.initCustomEvent(_n,true,true,e)}else{t=new CustomEvent(_n,{detail:e})}zi=true;dispatchEvent(t);zi=false}}));addEventListener(_n,(function(e){var t=e.detail;if(!zi){Gi(t)}}))}function Gi(e){var t=zi;try{zi=true;xn.storagemutated.fire(e)}finally{zi=t}}var zi=false;if(typeof BroadcastChannel!=="undefined"){var Xi=new BroadcastChannel(_n);xn(En,(function(e){if(!zi){Xi.postMessage(e)}}));Xi.onmessage=function(e){if(e.data)Gi(e.data)}}else if(typeof self!=="undefined"&&typeof navigator!=="undefined"){xn(En,(function(e){try{if(!zi){if(typeof localStorage!=="undefined"){localStorage.setItem(_n,JSON.stringify({trig:Math.random(),changedParts:e}))}if(babelHelpers["typeof"](self["clients"])==="object"){n([],self["clients"].matchAll({includeUncontrolled:true}),true).forEach((function(t){return t.postMessage({type:_n,changedParts:e})}))}}}catch(e){}}));if(typeof addEventListener!=="undefined"){addEventListener("storage",(function(e){if(e.key===_n){var t=JSON.parse(e.newValue);if(t)Gi(t.changedParts)}}))}var qi=self.document&&navigator.serviceWorker;if(qi){qi.addEventListener("message",Ki)}}function Ki(e){var t=e.data;if(t&&t.type===_n){Gi(t.changedParts)}}Ue.rejectionMapper=se;W(U,jt);window.BX.Dexie=Ni;e.Dexie=Ni;e.liveQuery=Wi;e.RangeSet=Oi;e.mergeRanges=Di;e.rangesOverlap=Ai})(this.BX.Dexie3=this.BX.Dexie3||{});(function(e,t,n,i,r){"use strict";function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){babelHelpers.defineProperty(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var a=function(){function e(t){babelHelpers.classCallCheck(this,e);if(typeof t!=="undefined"){this.restClient=t}else{this.restClient=new BX.RestClient}this.db=new r.Dexie("bx-ui-smiles");this.db.version(1).stores({sets:"id, parentId, name, type, image",smiles:"id, setId, name, image, typing, width, height, originalWidth, originalHeight, definition"})}babelHelpers.createClass(e,[{key:"loadFromCache",value:function e(){var t=this;var n=new BX.Promise;var i=[];var r=[];this.db.transaction("r",this.db.sets,this.db.smiles,(function(){t.db.sets.each((function(e){return t.db.smiles.where("setId").equals(e.id).first().then((function(t){i.push(o(o({},e),{},{image:t.image}))}))["catch"]((function(e){return n.reject(e)}))})).then((function(){return t.db.smiles.where("setId").equals(i[0].id).each((function(e){r.push(e)}))})).then((function(){var e={sets:i,smiles:r};n.resolve(e)}))["catch"]((function(e){return n.reject(e)}))}));return n}},{key:"loadFromServer",value:function e(){var t=this;var n=new BX.Promise;this.restClient.callMethod("smile.get").then((function(e){var i=[];var r=[];var s=e.data();var a={};s.smiles=s.smiles.map((function(e){if(!a[e.setId]){a[e.setId]=e.image}var t=e.width;if(e.definition=="HD"){t=t*2}else if(e.definition=="UHD"){t=t*4}var n=e.height;if(e.definition=="HD"){n=n*2}else if(e.definition=="UHD"){n=n*4}return o(o({},e),{},{originalWidth:t,originalHeight:n})}));s.sets.forEach((function(e){i.push(o(o({},e),{},{image:a[e.id]}))}));s.smiles.forEach((function(e){if(e.setId==i[0].id){r.push(e)}}));var l={sets:i,smiles:r};n.resolve(l);t.db.smiles.clear().then((function(){return t.db.sets.clear().then((function(){t.db.sets.bulkAdd(i);t.db.smiles.bulkAdd(s.smiles)}))["catch"]((function(e){return n.reject(e)}))}))["catch"]((function(e){return n.reject(e)}))}))["catch"]((function(e){return n.reject(e)}));return n}},{key:"changeSet",value:function e(t){var n=new BX.Promise;this.db.smiles.where("setId").equals(t).toArray((function(e){n.resolve(e)}))["catch"]((function(e){return n.reject(e)}));return n}}]);return e}();var l=[{id:1,code:"PEOPLE",showForWindows:true,emoji:[{symbol:"\ud83d\ude00"},{symbol:"\ud83d\ude03"},{symbol:"\ud83d\ude04"},{symbol:"\ud83d\ude01"},{symbol:"\ud83d\ude06"},{symbol:"\ud83d\ude05"},{symbol:"\ud83d\ude02"},{symbol:"\ud83e\udd23"},{symbol:"\ud83d\ude0a"},{symbol:"\ud83d\ude07"},{symbol:"\ud83d\ude42"},{symbol:"\ud83d\ude43"},{symbol:"\ud83d\ude09"},{symbol:"\ud83d\ude0c"},{symbol:"\ud83d\ude0d"},{symbol:"\ud83e\udd70"},{symbol:"\ud83d\ude18"},{symbol:"\ud83d\ude17"},{symbol:"\ud83d\ude19"},{symbol:"\ud83d\ude1a"},{symbol:"\ud83d\ude0b"},{symbol:"\ud83d\ude1b"},{symbol:"\ud83d\ude1d"},{symbol:"\ud83d\ude1c"},{symbol:"\ud83e\udd2a"},{symbol:"\ud83e\udd28"},{symbol:"\ud83e\uddd0"},{symbol:"\ud83e\udd13"},{symbol:"\ud83d\ude0e"},{symbol:"\ud83e\udd29"},{symbol:"\ud83e\udd73"},{symbol:"\ud83d\ude0f"},{symbol:"\ud83d\ude12"},{symbol:"\ud83d\ude1e"},{symbol:"\ud83d\ude14"},{symbol:"\ud83d\ude1f"},{symbol:"\ud83d\ude15"},{symbol:"\u2639"},{symbol:"\ud83d\ude41"},{symbol:"\ud83d\ude23"},{symbol:"\ud83d\ude2b"},{symbol:"\ud83d\ude29"},{symbol:"\ud83e\udd7a"},{symbol:"\ud83d\ude22"},{symbol:"\ud83d\ude2d"},{symbol:"\ud83d\ude24"},{symbol:"\ud83d\ude20"},{symbol:"\ud83d\ude21"},{symbol:"\ud83e\udd2c"},{symbol:"\ud83e\udd2f"},{symbol:"\ud83d\ude33"},{symbol:"\ud83e\udd75"},{symbol:"\ud83e\udd76"},{symbol:"\ud83d\ude31"},{symbol:"\ud83d\ude28"},{symbol:"\ud83d\ude30"},{symbol:"\ud83d\ude25"},{symbol:"\ud83d\ude13"},{symbol:"\ud83e\udd17"},{symbol:"\ud83e\udd14"},{symbol:"\ud83e\udd2d"},{symbol:"\ud83e\udd2b"},{symbol:"\ud83e\udd25"},{symbol:"\ud83d\ude36"},{symbol:"\ud83d\ude10"},{symbol:"\ud83d\ude11"},{symbol:"\ud83d\ude2c"},{symbol:"\ud83d\ude44"},{symbol:"\ud83d\ude2f"},{symbol:"\ud83d\ude26"},{symbol:"\ud83d\ude27"},{symbol:"\ud83d\ude2e"},{symbol:"\ud83d\ude32"},{symbol:"\ud83d\ude34"},{symbol:"\ud83e\udd24"},{symbol:"\ud83d\ude2a"},{symbol:"\ud83d\ude35"},{symbol:"\ud83e\udd10"},{symbol:"\ud83e\udd74"},{symbol:"\ud83e\udd22"},{symbol:"\ud83e\udd2e"},{symbol:"\ud83e\udd27"},{symbol:"\ud83d\ude37"},{symbol:"\ud83e\udd12"},{symbol:"\ud83e\udd15"},{symbol:"\ud83e\udd11"},{symbol:"\ud83e\udd20"},{symbol:"\ud83d\ude08"},{symbol:"\ud83d\udc7f"},{symbol:"\ud83d\udc79"},{symbol:"\ud83d\udc7a"},{symbol:"\ud83e\udd21"},{symbol:"\ud83d\udca9"},{symbol:"\ud83d\udc7b"},{symbol:"\u2620"},{symbol:"\ud83d\udc80"},{symbol:"\ud83d\udc7d"},{symbol:"\ud83d\udc7e"},{symbol:"\ud83e\udd16"},{symbol:"\ud83c\udf83"},{symbol:"\ud83d\ude3a"},{symbol:"\ud83d\ude38"},{symbol:"\ud83d\ude39"},{symbol:"\ud83d\ude3b"},{symbol:"\ud83d\ude3c"},{symbol:"\ud83d\ude3d"},{symbol:"\ud83d\ude40"},{symbol:"\ud83d\ude3f"},{symbol:"\ud83d\ude3e"},{symbol:"\ud83e\udd32"},{symbol:"\ud83d\udc50"},{symbol:"\ud83d\ude4c"},{symbol:"\ud83d\udc4f"},{symbol:"\ud83e\udd1d"},{symbol:"\ud83d\udc4d"},{symbol:"\ud83d\udc4e"},{symbol:"\ud83d\udc4a"},{symbol:"\u270a"},{symbol:"\ud83e\udd1b"},{symbol:"\ud83e\udd1c"},{symbol:"\ud83e\udd1e"},{symbol:"\u270c"},{symbol:"\ud83e\udd1f"},{symbol:"\ud83e\udd18"},{symbol:"\ud83d\udc4c"},{symbol:"\ud83d\udc48"},{symbol:"\ud83d\udc49"},{symbol:"\ud83d\udc46"},{symbol:"\ud83d\udc47"},{symbol:"\ud83e\udd1a"},{symbol:"\ud83d\udd90"},{symbol:"\ud83d\udd96"},{symbol:"\ud83d\udc4b"},{symbol:"\ud83e\udd19"},{symbol:"\ud83d\udcaa"},{symbol:"\ud83d\udd95"},{symbol:"\u270d"},{symbol:"\ud83d\ude4f"},{symbol:"\ud83e\uddb6"},{symbol:"\ud83e\uddb5"},{symbol:"\ud83d\udc84"},{symbol:"\ud83d\udc8b"},{symbol:"\ud83d\udc44"},{symbol:"\ud83e\uddb7"},{symbol:"\ud83d\udc45"},{symbol:"\ud83d\udc43"},{symbol:"\ud83d\udc63"},{symbol:"\ud83d\udc41"},{symbol:"\ud83d\udc40"},{symbol:"\ud83e\udde0"},{symbol:"\ud83d\udde3"},{symbol:"\ud83d\udc64"},{symbol:"\ud83d\udc65"},{symbol:"\ud83d\udc76"},{symbol:"\ud83d\udc67"},{symbol:"\ud83e\uddd2"},{symbol:"\ud83d\udc66"},{symbol:"\ud83d\udc69"},{symbol:"\ud83e\uddd1"},{symbol:"\ud83d\udc68"},{symbol:"\ud83d\udc71"},{symbol:"\ud83e\uddd4"},{symbol:"\ud83d\udc75"},{symbol:"\ud83e\uddd3"},{symbol:"\ud83d\udc74"},{symbol:"\ud83d\udc72"},{symbol:"\ud83d\udc73"},{symbol:"\ud83e\uddd5"},{symbol:"\ud83d\udc6e"},{symbol:"\ud83d\udc77"},{symbol:"\ud83d\udc82"},{symbol:"\ud83d\udd75"},{symbol:"\u2695"},{symbol:"\ud83c\udf3e"},{symbol:"\ud83c\udf73"},{symbol:"\ud83c\udf93"},{symbol:"\ud83c\udfa4"},{symbol:"\ud83c\udfeb"},{symbol:"\ud83c\udfed"},{symbol:"\ud83d\udcbb"},{symbol:"\ud83d\udcbc"},{symbol:"\ud83d\udc69"},{symbol:"\u2764"},{symbol:"\ud83d\udd27"},{symbol:"\ud83d\udd2c"},{symbol:"\ud83c\udfa8"},{symbol:"\ud83d\ude92"},{symbol:"\ud83d\ude80"},{symbol:"\ud83d\udc70"},{symbol:"\ud83e\udd35"},{symbol:"\ud83d\udc78"},{symbol:"\ud83e\udd34"},{symbol:"\ud83e\uddb8"},{symbol:"\ud83e\uddb9"},{symbol:"\ud83e\udd36"},{symbol:"\ud83c\udf85"},{symbol:"\ud83e\uddd9"},{symbol:"\ud83e\udddd"},{symbol:"\ud83e\udddb"},{symbol:"\ud83e\udddf"},{symbol:"\ud83e\uddde"},{symbol:"\ud83e\udddc"},{symbol:"\ud83e\uddda"},{symbol:"\ud83d\udc7c"},{symbol:"\ud83e\udd30"},{symbol:"\ud83e\udd31"},{symbol:"\ud83d\ude47"},{symbol:"\ud83d\udc81"},{symbol:"\ud83d\ude45"},{symbol:"\ud83d\ude46"},{symbol:"\ud83d\ude4b"},{symbol:"\ud83e\udd26"},{symbol:"\ud83e\udd37"},{symbol:"\ud83d\ude4e"},{symbol:"\ud83d\ude4d"},{symbol:"\ud83d\udc87"},{symbol:"\ud83d\udc86"},{symbol:"\ud83e\uddd6"},{symbol:"\ud83d\udc85"},{symbol:"\ud83e\udd33"},{symbol:"\ud83d\udc83"},{symbol:"\ud83d\udd7a"},{symbol:"\ud83d\udc6f"},{symbol:"\ud83d\udd74"},{symbol:"\ud83d\udeb6"},{symbol:"\ud83c\udfc3"},{symbol:"\ud83d\udc6b"},{symbol:"\ud83d\udc6d"},{symbol:"\ud83d\udc6c"},{symbol:"\ud83d\udc91"},{symbol:"\ud83d\udc8f"},{symbol:"\ud83d\udc6a"},{symbol:"\ud83e\uddf6"},{symbol:"\ud83e\uddf5"},{symbol:"\ud83e\udde5"},{symbol:"\ud83e\udd7c"},{symbol:"\ud83d\udc5a"},{symbol:"\ud83d\udc55"},{symbol:"\ud83d\udc56"},{symbol:"\ud83d\udc54"},{symbol:"\ud83d\udc57"},{symbol:"\ud83d\udc59"},{symbol:"\ud83d\udc58"},{symbol:"\ud83e\udd7f"},{symbol:"\ud83d\udc60"},{symbol:"\ud83d\udc61"},{symbol:"\ud83d\udc62"},{symbol:"\ud83d\udc5e"},{symbol:"\ud83d\udc5f"},{symbol:"\ud83e\udd7e"},{symbol:"\ud83e\udde6"},{symbol:"\ud83e\udde4"},{symbol:"\ud83e\udde3"},{symbol:"\ud83c\udfa9"},{symbol:"\ud83e\udde2"},{symbol:"\ud83d\udc52"},{symbol:"\ud83c\udf93"},{symbol:"\u26d1"},{symbol:"\ud83d\udc51"},{symbol:"\ud83d\udc8d"},{symbol:"\ud83d\udc5d"},{symbol:"\ud83d\udc5b"},{symbol:"\ud83d\udc5c"},{symbol:"\ud83d\udcbc"},{symbol:"\ud83c\udf92"},{symbol:"\ud83e\uddf3"},{symbol:"\ud83d\udc53"},{symbol:"\ud83d\udd76"},{symbol:"\ud83e\udd7d"},{symbol:"\ud83c\udf02"}]},{id:2,code:"ANIMALS",showForWindows:true,emoji:[{symbol:"\ud83d\udc36"},{symbol:"\ud83d\udc31"},{symbol:"\ud83d\udc2d"},{symbol:"\ud83d\udc39"},{symbol:"\ud83d\udc30"},{symbol:"\ud83e\udd8a"},{symbol:"\ud83d\udc3b"},{symbol:"\ud83d\udc3c"},{symbol:"\ud83d\udc28"},{symbol:"\ud83d\udc2f"},{symbol:"\ud83e\udd81"},{symbol:"\ud83d\udc2e"},{symbol:"\ud83d\udc37"},{symbol:"\ud83d\udc3d"},{symbol:"\ud83d\udc38"},{symbol:"\ud83d\udc35"},{symbol:"\ud83d\ude48"},{symbol:"\ud83d\ude49"},{symbol:"\ud83d\ude4a"},{symbol:"\ud83d\udc12"},{symbol:"\ud83d\udc14"},{symbol:"\ud83d\udc27"},{symbol:"\ud83d\udc26"},{symbol:"\ud83d\udc24"},{symbol:"\ud83d\udc23"},{symbol:"\ud83d\udc25"},{symbol:"\ud83e\udd86"},{symbol:"\ud83e\udd85"},{symbol:"\ud83e\udd89"},{symbol:"\ud83e\udd87"},{symbol:"\ud83d\udc3a"},{symbol:"\ud83d\udc17"},{symbol:"\ud83d\udc34"},{symbol:"\ud83e\udd84"},{symbol:"\ud83d\udc1d"},{symbol:"\ud83d\udc1b"},{symbol:"\ud83e\udd8b"},{symbol:"\ud83d\udc0c"},{symbol:"\ud83d\udc1e"},{symbol:"\ud83d\udc1c"},{symbol:"\ud83e\udd9f"},{symbol:"\ud83e\udd97"},{symbol:"\ud83d\udd77"},{symbol:"\ud83d\udd78"},{symbol:"\ud83e\udd82"},{symbol:"\ud83d\udc22"},{symbol:"\ud83d\udc0d"},{symbol:"\ud83e\udd8e"},{symbol:"\ud83e\udd96"},{symbol:"\ud83e\udd95"},{symbol:"\ud83d\udc19"},{symbol:"\ud83e\udd91"},{symbol:"\ud83e\udd90"},{symbol:"\ud83e\udd9e"},{symbol:"\ud83e\udd80"},{symbol:"\ud83d\udc21"},{symbol:"\ud83d\udc20"},{symbol:"\ud83d\udc1f"},{symbol:"\ud83d\udc2c"},{symbol:"\ud83d\udc33"},{symbol:"\ud83d\udc0b"},{symbol:"\ud83e\udd88"},{symbol:"\ud83d\udc0a"},{symbol:"\ud83d\udc05"},{symbol:"\ud83d\udc06"},{symbol:"\ud83e\udd93"},{symbol:"\ud83e\udd8d"},{symbol:"\ud83d\udc18"},{symbol:"\ud83e\udd9b"},{symbol:"\ud83e\udd8f"},{symbol:"\ud83d\udc2a"},{symbol:"\ud83d\udc2b"},{symbol:"\ud83e\udd92"},{symbol:"\ud83e\udd98"},{symbol:"\ud83d\udc03"},{symbol:"\ud83d\udc02"},{symbol:"\ud83d\udc04"},{symbol:"\ud83d\udc0e"},{symbol:"\ud83d\udc16"},{symbol:"\ud83d\udc0f"},{symbol:"\ud83d\udc11"},{symbol:"\ud83e\udd99"},{symbol:"\ud83d\udc10"},{symbol:"\ud83e\udd8c"},{symbol:"\ud83d\udc15"},{symbol:"\ud83d\udc29"},{symbol:"\ud83d\udc08"},{symbol:"\ud83d\udc13"},{symbol:"\ud83e\udd83"},{symbol:"\ud83e\udd9a"},{symbol:"\ud83e\udd9c"},{symbol:"\ud83e\udda2"},{symbol:"\ud83d\udd4a"},{symbol:"\ud83d\udc07"},{symbol:"\ud83e\udd9d"},{symbol:"\ud83e\udda1"},{symbol:"\ud83d\udc01"},{symbol:"\ud83d\udc00"},{symbol:"\ud83d\udc3f"},{symbol:"\ud83e\udd94"},{symbol:"\ud83d\udc3e"},{symbol:"\ud83d\udc09"},{symbol:"\ud83d\udc32"},{symbol:"\ud83c\udf35"},{symbol:"\ud83c\udf84"},{symbol:"\ud83c\udf32"},{symbol:"\ud83c\udf33"},{symbol:"\ud83c\udf34"},{symbol:"\ud83c\udf31"},{symbol:"\ud83c\udf3f"},{symbol:"\u2618"},{symbol:"\ud83c\udf40"},{symbol:"\ud83c\udf8d"},{symbol:"\ud83c\udf8b"},{symbol:"\ud83c\udf43"},{symbol:"\ud83c\udf42"},{symbol:"\ud83c\udf41"},{symbol:"\ud83c\udf44"},{symbol:"\ud83d\udc1a"},{symbol:"\ud83c\udf3e"},{symbol:"\ud83d\udc90"},{symbol:"\ud83c\udf37"},{symbol:"\ud83c\udf39"},{symbol:"\ud83e\udd40"},{symbol:"\ud83c\udf3a"},{symbol:"\ud83c\udf38"},{symbol:"\ud83c\udf3c"},{symbol:"\ud83c\udf3b"},{symbol:"\ud83c\udf1e"},{symbol:"\ud83c\udf1d"},{symbol:"\ud83c\udf1b"},{symbol:"\ud83c\udf1c"},{symbol:"\ud83c\udf1a"},{symbol:"\ud83c\udf15"},{symbol:"\ud83c\udf16"},{symbol:"\ud83c\udf17"},{symbol:"\ud83c\udf18"},{symbol:"\ud83c\udf11"},{symbol:"\ud83c\udf12"},{symbol:"\ud83c\udf13"},{symbol:"\ud83c\udf14"},{symbol:"\ud83c\udf19"},{symbol:"\ud83c\udf0e"},{symbol:"\ud83c\udf0d"},{symbol:"\ud83c\udf0f"},{symbol:"\ud83d\udcab"},{symbol:"\u2b50"},{symbol:"\ud83c\udf1f"},{symbol:"\u2728"},{symbol:"\u26a1"},{symbol:"\u2604"},{symbol:"\ud83d\udca5"},{symbol:"\ud83d\udd25"},{symbol:"\ud83c\udf2a"},{symbol:"\ud83c\udf08"},{symbol:"\u2600"},{symbol:"\ud83c\udf24"},{symbol:"\ud83c\udf25"},{symbol:"\ud83c\udf26"},{symbol:"\ud83c\udf27"},{symbol:"\ud83c\udf29"},{symbol:"\ud83c\udf28"},{symbol:"\u2744"},{symbol:"\u2603"},{symbol:"\u26c4"},{symbol:"\ud83c\udf2c"},{symbol:"\ud83d\udca8"},{symbol:"\ud83d\udca7"},{symbol:"\ud83d\udca6"},{symbol:"\u2614"},{symbol:"\u2602"},{symbol:"\ud83c\udf0a"},{symbol:"\ud83c\udf2b"}]},{id:3,code:"FOOD",showForWindows:true,emoji:[{symbol:"\ud83c\udf4f"},{symbol:"\ud83c\udf4e"},{symbol:"\ud83c\udf50"},{symbol:"\ud83c\udf4a"},{symbol:"\ud83c\udf4b"},{symbol:"\ud83c\udf4c"},{symbol:"\ud83c\udf49"},{symbol:"\ud83c\udf47"},{symbol:"\ud83c\udf53"},{symbol:"\ud83c\udf48"},{symbol:"\ud83c\udf52"},{symbol:"\ud83c\udf51"},{symbol:"\ud83e\udd6d"},{symbol:"\ud83c\udf4d"},{symbol:"\ud83e\udd65"},{symbol:"\ud83e\udd5d"},{symbol:"\ud83c\udf45"},{symbol:"\ud83c\udf46"},{symbol:"\ud83e\udd51"},{symbol:"\ud83e\udd66"},{symbol:"\ud83e\udd6c"},{symbol:"\ud83e\udd52"},{symbol:"\ud83c\udf36"},{symbol:"\ud83c\udf3d"},{symbol:"\ud83e\udd55"},{symbol:"\ud83e\udd54"},{symbol:"\ud83c\udf60"},{symbol:"\ud83e\udd50"},{symbol:"\ud83e\udd6f"},{symbol:"\ud83c\udf5e"},{symbol:"\ud83e\udd56"},{symbol:"\ud83e\udd68"},{symbol:"\ud83e\uddc0"},{symbol:"\ud83e\udd5a"},{symbol:"\ud83c\udf73"},{symbol:"\ud83e\udd5e"},{symbol:"\ud83e\udd53"},{symbol:"\ud83e\udd69"},{symbol:"\ud83c\udf57"},{symbol:"\ud83c\udf56"},{symbol:"\ud83e\uddb4"},{symbol:"\ud83c\udf2d"},{symbol:"\ud83c\udf54"},{symbol:"\ud83c\udf5f"},{symbol:"\ud83c\udf55"},{symbol:"\ud83e\udd6a"},{symbol:"\ud83e\udd59"},{symbol:"\ud83c\udf2e"},{symbol:"\ud83c\udf2f"},{symbol:"\ud83e\udd57"},{symbol:"\ud83e\udd58"},{symbol:"\ud83e\udd6b"},{symbol:"\ud83c\udf5d"},{symbol:"\ud83c\udf5c"},{symbol:"\ud83c\udf72"},{symbol:"\ud83c\udf5b"},{symbol:"\ud83c\udf63"},{symbol:"\ud83c\udf71"},{symbol:"\ud83e\udd5f"},{symbol:"\ud83c\udf64"},{symbol:"\ud83c\udf59"},{symbol:"\ud83c\udf5a"},{symbol:"\ud83c\udf58"},{symbol:"\ud83c\udf65"},{symbol:"\ud83e\udd60"},{symbol:"\ud83e\udd6e"},{symbol:"\ud83c\udf62"},{symbol:"\ud83c\udf61"},{symbol:"\ud83c\udf67"},{symbol:"\ud83c\udf68"},{symbol:"\ud83c\udf66"},{symbol:"\ud83e\udd67"},{symbol:"\ud83e\uddc1"},{symbol:"\ud83c\udf70"},{symbol:"\ud83c\udf82"},{symbol:"\ud83c\udf6e"},{symbol:"\ud83c\udf6d"},{symbol:"\ud83c\udf6c"},{symbol:"\ud83c\udf6b"},{symbol:"\ud83c\udf7f"},{symbol:"\ud83c\udf69"},{symbol:"\ud83c\udf6a"},{symbol:"\ud83c\udf30"},{symbol:"\ud83e\udd5c"},{symbol:"\ud83c\udf6f"},{symbol:"\ud83e\udd5b"},{symbol:"\ud83c\udf7c"},{symbol:"\u2615"},{symbol:"\ud83c\udf75"},{symbol:"\ud83e\udd64"},{symbol:"\ud83c\udf76"},{symbol:"\ud83c\udf7a"},{symbol:"\ud83c\udf7b"},{symbol:"\ud83e\udd42"},{symbol:"\ud83c\udf77"},{symbol:"\ud83e\udd43"},{symbol:"\ud83c\udf78"},{symbol:"\ud83c\udf79"},{symbol:"\ud83c\udf7e"},{symbol:"\ud83e\udd44"},{symbol:"\ud83c\udf74"},{symbol:"\ud83c\udf7d"},{symbol:"\ud83e\udd63"},{symbol:"\ud83e\udd61"},{symbol:"\ud83e\udd62"},{symbol:"\ud83e\uddc2"}]},{id:4,code:"HOBBY",showForWindows:true,emoji:[{symbol:"\u26bd"},{symbol:"\ud83c\udfc0"},{symbol:"\ud83c\udfc8"},{symbol:"\u26be"},{symbol:"\ud83e\udd4e"},{symbol:"\ud83c\udfbe"},{symbol:"\ud83c\udfd0"},{symbol:"\ud83c\udfc9"},{symbol:"\ud83e\udd4f"},{symbol:"\ud83c\udfb1"},{symbol:"\ud83c\udfd3"},{symbol:"\ud83c\udff8"},{symbol:"\ud83c\udfd2"},{symbol:"\ud83c\udfd1"},{symbol:"\ud83e\udd4d"},{symbol:"\ud83c\udfcf"},{symbol:"\ud83e\udd45"},{symbol:"\u26f3"},{symbol:"\ud83c\udff9"},{symbol:"\ud83c\udfa3"},{symbol:"\ud83e\udd4a"},{symbol:"\ud83e\udd4b"},{symbol:"\ud83c\udfbd"},{symbol:"\ud83d\udef9"},{symbol:"\ud83d\udef7"},{symbol:"\u26f8"},{symbol:"\ud83e\udd4c"},{symbol:"\ud83c\udfbf"},{symbol:"\u26f7"},{symbol:"\ud83c\udfc2"},{symbol:"\ud83c\udfcb"},{symbol:"\ud83e\udd3c"},{symbol:"\ud83e\udd38"},{symbol:"\u26f9"},{symbol:"\ud83e\udd3a"},{symbol:"\ud83e\udd3e"},{symbol:"\ud83c\udfcc"},{symbol:"\ud83c\udfc7"},{symbol:"\ud83e\uddd8"},{symbol:"\ud83c\udfc4"},{symbol:"\ud83c\udfca"},{symbol:"\ud83e\udd3d"},{symbol:"\ud83d\udea3"},{symbol:"\ud83e\uddd7"},{symbol:"\ud83d\udeb5"},{symbol:"\ud83d\udeb4"},{symbol:"\ud83c\udfc6"},{symbol:"\ud83e\udd47"},{symbol:"\ud83e\udd48"},{symbol:"\ud83e\udd49"},{symbol:"\ud83c\udfc5"},{symbol:"\ud83c\udf96"},{symbol:"\ud83c\udff5"},{symbol:"\ud83c\udf97"},{symbol:"\ud83c\udfab"},{symbol:"\ud83c\udf9f"},{symbol:"\ud83c\udfaa"},{symbol:"\ud83e\udd39"},{symbol:"\ud83c\udfad"},{symbol:"\ud83c\udfa8"},{symbol:"\ud83c\udfac"},{symbol:"\ud83c\udfa4"},{symbol:"\ud83c\udfa7"},{symbol:"\ud83c\udfbc"},{symbol:"\ud83c\udfb9"},{symbol:"\ud83e\udd41"},{symbol:"\ud83c\udfb7"},{symbol:"\ud83c\udfba"},{symbol:"\ud83c\udfb8"},{symbol:"\ud83c\udfbb"},{symbol:"\ud83c\udfb2"},{symbol:"\u265f"},{symbol:"\ud83c\udfaf"},{symbol:"\ud83c\udfb3"},{symbol:"\ud83c\udfae"},{symbol:"\ud83c\udfb0"},{symbol:"\ud83e\udde9"}]},{id:5,code:"TRAVEL",showForWindows:true,emoji:[{symbol:"\ud83d\ude97"},{symbol:"\ud83d\ude95"},{symbol:"\ud83d\ude99"},{symbol:"\ud83d\ude8c"},{symbol:"\ud83d\ude8e"},{symbol:"\ud83c\udfce"},{symbol:"\ud83d\ude93"},{symbol:"\ud83d\ude91"},{symbol:"\ud83d\ude92"},{symbol:"\ud83d\ude90"},{symbol:"\ud83d\ude9a"},{symbol:"\ud83d\ude9b"},{symbol:"\ud83d\ude9c"},{symbol:"\ud83d\udef4"},{symbol:"\ud83d\udeb2"},{symbol:"\ud83d\udef5"},{symbol:"\ud83c\udfcd"},{symbol:"\ud83d\udea8"},{symbol:"\ud83d\ude94"},{symbol:"\ud83d\ude8d"},{symbol:"\ud83d\ude98"},{symbol:"\ud83d\ude96"},{symbol:"\ud83d\udea1"},{symbol:"\ud83d\udea0"},{symbol:"\ud83d\ude9f"},{symbol:"\ud83d\ude83"},{symbol:"\ud83d\ude8b"},{symbol:"\ud83d\ude9e"},{symbol:"\ud83d\ude9d"},{symbol:"\ud83d\ude84"},{symbol:"\ud83d\ude85"},{symbol:"\ud83d\ude88"},{symbol:"\ud83d\ude82"},{symbol:"\ud83d\ude86"},{symbol:"\ud83d\ude87"},{symbol:"\ud83d\ude8a"},{symbol:"\ud83d\ude89"},{symbol:"\u2708"},{symbol:"\ud83d\udeeb"},{symbol:"\ud83d\udeec"},{symbol:"\ud83d\udee9"},{symbol:"\ud83d\udcba"},{symbol:"\ud83d\udef0"},{symbol:"\ud83d\ude80"},{symbol:"\ud83d\udef8"},{symbol:"\ud83d\ude81"},{symbol:"\ud83d\udef6"},{symbol:"\u26f5"},{symbol:"\ud83d\udea4"},{symbol:"\ud83d\udee5"},{symbol:"\ud83d\udef3"},{symbol:"\u26f4"},{symbol:"\ud83d\udea2"},{symbol:"\u2693"},{symbol:"\u26fd"},{symbol:"\ud83d\udea7"},{symbol:"\ud83d\udea6"},{symbol:"\ud83d\udea5"},{symbol:"\ud83d\ude8f"},{symbol:"\ud83d\uddfa"},{symbol:"\ud83d\uddff"},{symbol:"\ud83d\uddfd"},{symbol:"\ud83d\uddfc"},{symbol:"\ud83c\udff0"},{symbol:"\ud83c\udfef"},{symbol:"\ud83c\udfdf"},{symbol:"\ud83c\udfa1"},{symbol:"\ud83c\udfa2"},{symbol:"\ud83c\udfa0"},{symbol:"\u26f2"},{symbol:"\u26f1"},{symbol:"\ud83c\udfd6"},{symbol:"\ud83c\udfdd"},{symbol:"\ud83c\udfdc"},{symbol:"\ud83c\udf0b"},{symbol:"\u26f0"},{symbol:"\ud83c\udfd4"},{symbol:"\ud83d\uddfb"},{symbol:"\ud83c\udfd5"},{symbol:"\u26fa"},{symbol:"\ud83c\udfe0"},{symbol:"\ud83c\udfe1"},{symbol:"\ud83c\udfd8"},{symbol:"\ud83c\udfda"},{symbol:"\ud83c\udfd7"},{symbol:"\ud83c\udfed"},{symbol:"\ud83c\udfe2"},{symbol:"\ud83c\udfec"},{symbol:"\ud83c\udfe3"},{symbol:"\ud83c\udfe4"},{symbol:"\ud83c\udfe5"},{symbol:"\ud83c\udfe6"},{symbol:"\ud83c\udfe8"},{symbol:"\ud83c\udfea"},{symbol:"\ud83c\udfeb"},{symbol:"\ud83c\udfe9"},{symbol:"\ud83d\udc92"},{symbol:"\ud83c\udfdb"},{symbol:"\u26ea"},{symbol:"\ud83d\udd4c"},{symbol:"\ud83d\udd4d"},{symbol:"\ud83d\udd4b"},{symbol:"\u26e9"},{symbol:"\ud83d\udee4"},{symbol:"\ud83d\udee3"},{symbol:"\ud83d\uddfe"},{symbol:"\ud83c\udf91"},{symbol:"\ud83c\udfde"},{symbol:"\ud83c\udf05"},{symbol:"\ud83c\udf04"},{symbol:"\ud83c\udf20"},{symbol:"\ud83c\udf87"},{symbol:"\ud83c\udf86"},{symbol:"\ud83c\udf07"},{symbol:"\ud83c\udf06"},{symbol:"\ud83c\udfd9"},{symbol:"\ud83c\udf03"},{symbol:"\ud83c\udf0c"},{symbol:"\ud83c\udf09"},{symbol:"\ud83c\udf01"}]},{id:6,code:"OBJECTS",showForWindows:true,emoji:[{symbol:"\u231a"},{symbol:"\ud83d\udcf1"},{symbol:"\ud83d\udcf2"},{symbol:"\ud83d\udcbb"},{symbol:"\u2328"},{symbol:"\ud83d\udda5"},{symbol:"\ud83d\udda8"},{symbol:"\ud83d\uddb1"},{symbol:"\ud83d\uddb2"},{symbol:"\ud83d\udd79"},{symbol:"\ud83d\udddc"},{symbol:"\ud83d\udcbd"},{symbol:"\ud83d\udcbe"},{symbol:"\ud83d\udcbf"},{symbol:"\ud83d\udcc0"},{symbol:"\ud83d\udcfc"},{symbol:"\ud83d\udcf7"},{symbol:"\ud83d\udcf8"},{symbol:"\ud83d\udcf9"},{symbol:"\ud83c\udfa5"},{symbol:"\ud83d\udcfd"},{symbol:"\ud83c\udf9e"},{symbol:"\ud83d\udcde"},{symbol:"\u260e"},{symbol:"\ud83d\udcdf"},{symbol:"\ud83d\udce0"},{symbol:"\ud83d\udcfa"},{symbol:"\ud83d\udcfb"},{symbol:"\ud83c\udf99"},{symbol:"\ud83c\udf9a"},{symbol:"\ud83c\udf9b"},{symbol:"\ud83e\udded"},{symbol:"\u23f1"},{symbol:"\u23f2"},{symbol:"\u23f0"},{symbol:"\ud83d\udd70"},{symbol:"\u231b"},{symbol:"\u23f3"},{symbol:"\ud83d\udce1"},{symbol:"\ud83d\udd0b"},{symbol:"\ud83d\udd0c"},{symbol:"\ud83d\udca1"},{symbol:"\ud83d\udd26"},{symbol:"\ud83d\udd6f"},{symbol:"\ud83e\uddef"},{symbol:"\ud83d\udee2"},{symbol:"\ud83d\udcb8"},{symbol:"\ud83d\udcb5"},{symbol:"\ud83d\udcb4"},{symbol:"\ud83d\udcb6"},{symbol:"\ud83d\udcb7"},{symbol:"\ud83d\udcb0"},{symbol:"\ud83d\udcb3"},{symbol:"\ud83d\udc8e"},{symbol:"\u2696"},{symbol:"\ud83e\uddf0"},{symbol:"\ud83d\udd27"},{symbol:"\ud83d\udd28"},{symbol:"\u2692"},{symbol:"\ud83d\udee0"},{symbol:"\u26cf"},{symbol:"\ud83d\udd29"},{symbol:"\u2699"},{symbol:"\ud83e\uddf1"},{symbol:"\u26d3"},{symbol:"\ud83e\uddf2"},{symbol:"\ud83d\udd2b"},{symbol:"\ud83d\udca3"},{symbol:"\ud83e\udde8"},{symbol:"\ud83d\udd2a"},{symbol:"\ud83d\udde1"},{symbol:"\u2694"},{symbol:"\ud83d\udee1"},{symbol:"\ud83d\udeac"},{symbol:"\u26b0"},{symbol:"\u26b1"},{symbol:"\ud83c\udffa"},{symbol:"\ud83d\udd2e"},{symbol:"\ud83d\udcff"},{symbol:"\ud83e\uddff"},{symbol:"\ud83d\udc88"},{symbol:"\u2697"},{symbol:"\ud83d\udd2d"},{symbol:"\ud83d\udd2c"},{symbol:"\ud83d\udd73"},{symbol:"\ud83d\udc8a"},{symbol:"\ud83d\udc89"},{symbol:"\ud83e\uddec"},{symbol:"\ud83e\udda0"},{symbol:"\ud83e\uddeb"},{symbol:"\ud83e\uddea"},{symbol:"\ud83c\udf21"},{symbol:"\ud83e\uddf9"},{symbol:"\ud83e\uddfa"},{symbol:"\ud83e\uddfb"},{symbol:"\ud83d\udebd"},{symbol:"\ud83d\udeb0"},{symbol:"\ud83d\udebf"},{symbol:"\ud83d\udec1"},{symbol:"\ud83d\udec0"},{symbol:"\ud83e\uddfc"},{symbol:"\ud83e\uddfd"},{symbol:"\ud83e\uddf4"},{symbol:"\ud83d\udece"},{symbol:"\ud83d\udd11"},{symbol:"\ud83d\udddd"},{symbol:"\ud83d\udeaa"},{symbol:"\ud83d\udecb"},{symbol:"\ud83d\udecf"},{symbol:"\ud83d\udecc"},{symbol:"\ud83e\uddf8"},{symbol:"\ud83d\uddbc"},{symbol:"\ud83d\udecd"},{symbol:"\ud83d\uded2"},{symbol:"\ud83c\udf81"},{symbol:"\ud83c\udf88"},{symbol:"\ud83c\udf8f"},{symbol:"\ud83c\udf80"},{symbol:"\ud83c\udf8a"},{symbol:"\ud83c\udf89"},{symbol:"\ud83c\udf8e"},{symbol:"\ud83c\udfee"},{symbol:"\ud83c\udf90"},{symbol:"\ud83e\udde7"},{symbol:"\u2709"},{symbol:"\ud83d\udce9"},{symbol:"\ud83d\udce8"},{symbol:"\ud83d\udce7"},{symbol:"\ud83d\udc8c"},{symbol:"\ud83d\udce5"},{symbol:"\ud83d\udce4"},{symbol:"\ud83d\udce6"},{symbol:"\ud83c\udff7"},{symbol:"\ud83d\udcea"},{symbol:"\ud83d\udceb"},{symbol:"\ud83d\udcec"},{symbol:"\ud83d\udced"},{symbol:"\ud83d\udcee"},{symbol:"\ud83d\udcef"},{symbol:"\ud83d\udcdc"},{symbol:"\ud83d\udcc3"},{symbol:"\ud83d\udcc4"},{symbol:"\ud83d\udcd1"},{symbol:"\ud83e\uddfe"},{symbol:"\ud83d\udcca"},{symbol:"\ud83d\udcc8"},{symbol:"\ud83d\udcc9"},{symbol:"\ud83d\uddd2"},{symbol:"\ud83d\uddd3"},{symbol:"\ud83d\udcc6"},{symbol:"\ud83d\udcc5"},{symbol:"\ud83d\uddd1"},{symbol:"\ud83d\udcc7"},{symbol:"\ud83d\uddc3"},{symbol:"\ud83d\uddf3"},{symbol:"\ud83d\uddc4"},{symbol:"\ud83d\udccb"},{symbol:"\ud83d\udcc1"},{symbol:"\ud83d\udcc2"},{symbol:"\ud83d\uddc2"},{symbol:"\ud83d\uddde"},{symbol:"\ud83d\udcf0"},{symbol:"\ud83d\udcd3"},{symbol:"\ud83d\udcd4"},{symbol:"\ud83d\udcd2"},{symbol:"\ud83d\udcd5"},{symbol:"\ud83d\udcd7"},{symbol:"\ud83d\udcd8"},{symbol:"\ud83d\udcd9"},{symbol:"\ud83d\udcda"},{symbol:"\ud83d\udcd6"},{symbol:"\ud83d\udd16"},{symbol:"\ud83e\uddf7"},{symbol:"\ud83d\udd17"},{symbol:"\ud83d\udcce"},{symbol:"\ud83d\udd87"},{symbol:"\ud83d\udcd0"},{symbol:"\ud83d\udccf"},{symbol:"\ud83d\udccc"},{symbol:"\ud83d\udccd"},{symbol:"\u2702"},{symbol:"\ud83d\udd8a"},{symbol:"\ud83d\udd8b"},{symbol:"\u2712"},{symbol:"\ud83d\udd8c"},{symbol:"\ud83d\udd8d"},{symbol:"\ud83d\udcdd"},{symbol:"\u270f"},{symbol:"\ud83d\udd0d"},{symbol:"\ud83d\udd0e"},{symbol:"\ud83d\udd0f"},{symbol:"\ud83d\udd10"},{symbol:"\ud83d\udd12"},{symbol:"\ud83d\udd13"}]},{id:7,code:"SYMBOLS",showForWindows:true,emoji:[{symbol:"\u2764"},{symbol:"\ud83e\udde1"},{symbol:"\ud83d\udc9b"},{symbol:"\ud83d\udc9a"},{symbol:"\ud83d\udc99"},{symbol:"\ud83d\udc9c"},{symbol:"\ud83d\udda4"},{symbol:"\ud83d\udc94"},{symbol:"\u2763"},{symbol:"\ud83d\udc95"},{symbol:"\ud83d\udc9e"},{symbol:"\ud83d\udc93"},{symbol:"\ud83d\udc97"},{symbol:"\ud83d\udc96"},{symbol:"\ud83d\udc98"},{symbol:"\ud83d\udc9d"},{symbol:"\ud83d\udc9f"},{symbol:"\u262e"},{symbol:"\u271d"},{symbol:"\u262a"},{symbol:"\ud83d\udd49"},{symbol:"\u2638"},{symbol:"\u2721"},{symbol:"\ud83d\udd2f"},{symbol:"\ud83d\udd4e"},{symbol:"\u262f"},{symbol:"\u2626"},{symbol:"\ud83d\uded0"},{symbol:"\u26ce"},{symbol:"\u2648"},{symbol:"\u2649"},{symbol:"\u264a"},{symbol:"\u264b"},{symbol:"\u264c"},{symbol:"\u264d"},{symbol:"\u264e"},{symbol:"\u264f"},{symbol:"\u2650"},{symbol:"\u2651"},{symbol:"\u2652"},{symbol:"\u2653"},{symbol:"\ud83c\udd94"},{symbol:"\u269b"},{symbol:"\ud83c\ude51"},{symbol:"\u2622"},{symbol:"\u2623"},{symbol:"\ud83d\udcf4"},{symbol:"\ud83d\udcf3"},{symbol:"\ud83c\ude36"},{symbol:"\ud83c\ude1a"},{symbol:"\ud83c\ude38"},{symbol:"\ud83c\ude3a"},{symbol:"\ud83c\ude37"},{symbol:"\u2734"},{symbol:"\ud83c\udd9a"},{symbol:"\ud83d\udcae"},{symbol:"\ud83c\ude50"},{symbol:"\u3299"},{symbol:"\u3297"},{symbol:"\ud83c\ude34"},{symbol:"\ud83c\ude35"},{symbol:"\ud83c\ude39"},{symbol:"\ud83c\ude32"},{symbol:"\ud83c\udd70"},{symbol:"\ud83c\udd71"},{symbol:"\ud83c\udd8e"},{symbol:"\ud83c\udd91"},{symbol:"\ud83c\udd7e"},{symbol:"\ud83c\udd98"},{symbol:"\u274c"},{symbol:"\u2b55"},{symbol:"\ud83d\uded1"},{symbol:"\u26d4"},{symbol:"\ud83d\udcdb"},{symbol:"\ud83d\udeab"},{symbol:"\ud83d\udcaf"},{symbol:"\ud83d\udca2"},{symbol:"\u2668"},{symbol:"\ud83d\udeb7"},{symbol:"\ud83d\udeaf"},{symbol:"\ud83d\udeb3"},{symbol:"\ud83d\udeb1"},{symbol:"\ud83d\udd1e"},{symbol:"\ud83d\udcf5"},{symbol:"\ud83d\udead"},{symbol:"\u2757"},{symbol:"\u2755"},{symbol:"\u2753"},{symbol:"\u2754"},{symbol:"\u203c"},{symbol:"\u2049"},{symbol:"\ud83d\udd05"},{symbol:"\ud83d\udd06"},{symbol:"\u303d"},{symbol:"\u26a0"},{symbol:"\ud83d\udeb8"},{symbol:"\ud83d\udd31"},{symbol:"\u269c"},{symbol:"\ud83d\udd30"},{symbol:"\u267b"},{symbol:"\u2705"},{symbol:"\ud83c\ude2f"},{symbol:"\ud83d\udcb9"},{symbol:"\u2747"},{symbol:"\u2733"},{symbol:"\u274e"},{symbol:"\ud83c\udf10"},{symbol:"\ud83d\udca0"},{symbol:"\u24c2"},{symbol:"\ud83c\udf00"},{symbol:"\ud83d\udca4"},{symbol:"\ud83c\udfe7"},{symbol:"\ud83d\udebe"},{symbol:"\u267f"},{symbol:"\ud83c\udd7f"},{symbol:"\ud83c\ude33"},{symbol:"\ud83c\ude02"},{symbol:"\ud83d\udec2"},{symbol:"\ud83d\udec3"},{symbol:"\ud83d\udec4"},{symbol:"\ud83d\udec5"},{symbol:"\ud83d\udeb9"},{symbol:"\ud83d\udeba"},{symbol:"\ud83d\udebc"},{symbol:"\ud83d\udebb"},{symbol:"\ud83d\udeae"},{symbol:"\ud83c\udfa6"},{symbol:"\ud83d\udcf6"},{symbol:"\ud83c\ude01"},{symbol:"\ud83d\udd23"},{symbol:"\u2139"},{symbol:"\ud83d\udd24"},{symbol:"\ud83d\udd21"},{symbol:"\ud83d\udd20"},{symbol:"\ud83c\udd96"},{symbol:"\ud83c\udd97"},{symbol:"\ud83c\udd99"},{symbol:"\ud83c\udd92"},{symbol:"\ud83c\udd95"},{symbol:"\ud83c\udd93"},{symbol:"0"},{symbol:"1"},{symbol:"2"},{symbol:"3"},{symbol:"4"},{symbol:"5"},{symbol:"6"},{symbol:"7"},{symbol:"8"},{symbol:"9"},{symbol:"\ud83d\udd1f"},{symbol:"\ud83d\udd22"},{symbol:"#"},{symbol:"*"},{symbol:"\u23cf"},{symbol:"\u25b6"},{symbol:"\u23f8"},{symbol:"\u23ef"},{symbol:"\u23f9"},{symbol:"\u23fa"},{symbol:"\u23ed"},{symbol:"\u23ee"},{symbol:"\u23e9"},{symbol:"\u23ea"},{symbol:"\u23eb"},{symbol:"\u23ec"},{symbol:"\u25c0"},{symbol:"\ud83d\udd3c"},{symbol:"\ud83d\udd3d"},{symbol:"\u27a1"},{symbol:"\u2b05"},{symbol:"\u2b06"},{symbol:"\u2b07"},{symbol:"\u2197"},{symbol:"\u2198"},{symbol:"\u2199"},{symbol:"\u2196"},{symbol:"\u2195"},{symbol:"\u2194"},{symbol:"\u21aa"},{symbol:"\u21a9"},{symbol:"\u2934"},{symbol:"\u2935"},{symbol:"\ud83d\udd00"},{symbol:"\ud83d\udd01"},{symbol:"\ud83d\udd02"},{symbol:"\ud83d\udd04"},{symbol:"\ud83d\udd03"},{symbol:"\ud83c\udfb5"},{symbol:"\ud83c\udfb6"},{symbol:"\u2795"},{symbol:"\u2796"},{symbol:"\u2797"},{symbol:"\u2716"},{symbol:"\u267e"},{symbol:"\ud83d\udcb2"},{symbol:"\ud83d\udcb1"},{symbol:"\u2122"},{symbol:"\xa9"},{symbol:"\xae"},{symbol:"\ud83d\udc41"},{symbol:"\ud83d\udde8"},{symbol:"\ud83d\udd1a"},{symbol:"\ud83d\udd19"},{symbol:"\ud83d\udd1b"},{symbol:"\ud83d\udd1d"},{symbol:"\ud83d\udd1c"},{symbol:"\u3030"},{symbol:"\u27b0"},{symbol:"\u27bf"},{symbol:"\u2714"},{symbol:"\u2611"},{symbol:"\ud83d\udd18"},{symbol:"\u26aa"},{symbol:"\u26ab"},{symbol:"\ud83d\udd34"},{symbol:"\ud83d\udd35"},{symbol:"\ud83d\udd3a"},{symbol:"\ud83d\udd3b"},{symbol:"\ud83d\udd38"},{symbol:"\ud83d\udd39"},{symbol:"\ud83d\udd36"},{symbol:"\ud83d\udd37"},{symbol:"\ud83d\udd33"},{symbol:"\ud83d\udd32"},{symbol:"\u25aa"},{symbol:"\u25ab"},{symbol:"\u25fe"},{symbol:"\u25fd"},{symbol:"\u25fc"},{symbol:"\u25fb"},{symbol:"\u2b1b"},{symbol:"\u2b1c"},{symbol:"\ud83d\udd08"},{symbol:"\ud83d\udd07"},{symbol:"\ud83d\udd09"},{symbol:"\ud83d\udd0a"},{symbol:"\ud83d\udd14"},{symbol:"\ud83d\udd15"},{symbol:"\ud83d\udce3"},{symbol:"\ud83d\udce2"},{symbol:"\ud83d\udcac"},{symbol:"\ud83d\udcad"},{symbol:"\ud83d\uddef"},{symbol:"\u2660"},{symbol:"\u2663"},{symbol:"\u2665"},{symbol:"\u2666"},{symbol:"\ud83c\udccf"},{symbol:"\ud83c\udfb4"},{symbol:"\ud83c\udc04"},{symbol:"\ud83d\udd50"},{symbol:"\ud83d\udd51"},{symbol:"\ud83d\udd52"},{symbol:"\ud83d\udd53"},{symbol:"\ud83d\udd54"},{symbol:"\ud83d\udd55"},{symbol:"\ud83d\udd56"},{symbol:"\ud83d\udd57"},{symbol:"\ud83d\udd58"},{symbol:"\ud83d\udd59"},{symbol:"\ud83d\udd5a"},{symbol:"\ud83d\udd5b"},{symbol:"\ud83d\udd5c"},{symbol:"\ud83d\udd5d"},{symbol:"\ud83d\udd5e"},{symbol:"\ud83d\udd5f"},{symbol:"\ud83d\udd60"},{symbol:"\ud83d\udd61"},{symbol:"\ud83d\udd62"},{symbol:"\ud83d\udd63"},{symbol:"\ud83d\udd64"},{symbol:"\ud83d\udd65"},{symbol:"\ud83d\udd66"},{symbol:"\ud83d\udd67"}]},{id:8,code:"FLAGS",showForWindows:false,emoji:[{symbol:"\ud83c\udff3"},{symbol:"\ud83c\udff4"},{symbol:"\ud83c\udfc1"},{symbol:"\ud83d\udea9"},{symbol:"\ud83c\udff3\ufe0f\u200d\ud83c\udf08"},{symbol:"\ud83c\uddfa\ud83c\uddf3"},{symbol:"\ud83c\udde6\ud83c\uddeb"},{symbol:"\ud83c\udde6\ud83c\uddfd"},{symbol:"\ud83c\udde6\ud83c\uddf1"},{symbol:"\ud83c\udde9\ud83c\uddff"},{symbol:"\ud83c\udde6\ud83c\uddf8"},{symbol:"\ud83c\udde6\ud83c\udde9"},{symbol:"\ud83c\udde6\ud83c\uddf4"},{symbol:"\ud83c\udde6\ud83c\uddee"},{symbol:"\ud83c\udde6\ud83c\uddf6"},{symbol:"\ud83c\udde6\ud83c\uddec"},{symbol:"\ud83c\udde6\ud83c\uddf7"},{symbol:"\ud83c\udde6\ud83c\uddf2"},{symbol:"\ud83c\udde6\ud83c\uddfc"},{symbol:"\ud83c\udde6\ud83c\uddfa"},{symbol:"\ud83c\udde6\ud83c\uddf9"},{symbol:"\ud83c\udde6\ud83c\uddff"},{symbol:"\ud83c\udde7\ud83c\uddf8"},{symbol:"\ud83c\udde7\ud83c\udded"},{symbol:"\ud83c\udde7\ud83c\udde9"},{symbol:"\ud83c\udde7\ud83c\uddfe"},{symbol:"\ud83c\udde7\ud83c\uddea"},{symbol:"\ud83c\udde7\ud83c\uddff"},{symbol:"\ud83c\udde7\ud83c\uddef"},{symbol:"\ud83c\udde7\ud83c\uddf2"},{symbol:"\ud83c\udde7\ud83c\uddf9"},{symbol:"\ud83c\udde7\ud83c\uddf4"},{symbol:"\ud83c\udde7\ud83c\udde6"},{symbol:"\ud83c\udde7\ud83c\uddfc"},{symbol:"\ud83c\udde7\ud83c\uddf7"},{symbol:"\ud83c\uddee\ud83c\uddf4"},{symbol:"\ud83c\uddfb\ud83c\uddec"},{symbol:"\ud83c\udde7\ud83c\uddf3"},{symbol:"\ud83c\udde7\ud83c\uddec"},{symbol:"\ud83c\udde7\ud83c\uddeb"},{symbol:"\ud83c\udde7\ud83c\uddee"},{symbol:"\ud83c\uddf0\ud83c\udded"},{symbol:"\ud83c\udde8\ud83c\uddf2"},{symbol:"\ud83c\udde8\ud83c\udde6"},{symbol:"\ud83c\uddee\ud83c\udde8"},{symbol:"\ud83c\udde8\ud83c\uddfb"},{symbol:"\ud83c\udde7\ud83c\uddf6"},{symbol:"\ud83c\uddf0\ud83c\uddfe"},{symbol:"\ud83c\udde8\ud83c\uddeb"},{symbol:"\ud83c\uddf9\ud83c\udde9"},{symbol:"\ud83c\udde8\ud83c\uddf1"},{symbol:"\ud83c\udde8\ud83c\uddf3"},{symbol:"\ud83c\udde8\ud83c\uddfd"},{symbol:"\ud83c\udde8\ud83c\uddf4"},{symbol:"\ud83c\uddf0\ud83c\uddf2"},{symbol:"\ud83c\udde8\ud83c\uddec"},{symbol:"\ud83c\udde8\ud83c\udde9"},{symbol:"\ud83c\udde8\ud83c\uddf0"},{symbol:"\ud83c\udde8\ud83c\uddf7"},{symbol:"\ud83c\udde8\ud83c\uddee"},{symbol:"\ud83c\udded\ud83c\uddf7"},{symbol:"\ud83c\udde8\ud83c\uddfa"},{symbol:"\ud83c\udde8\ud83c\uddfc"},{symbol:"\ud83c\udde8\ud83c\uddfe"},{symbol:"\ud83c\udde8\ud83c\uddff"},{symbol:"\ud83c\udde9\ud83c\uddf0"},{symbol:"\ud83c\udde9\ud83c\uddef"},{symbol:"\ud83c\udde9\ud83c\uddf2"},{symbol:"\ud83c\udde9\ud83c\uddf4"},{symbol:"\ud83c\uddea\ud83c\udde8"},{symbol:"\ud83c\uddea\ud83c\uddec"},{symbol:"\ud83c\uddf8\ud83c\uddfb"},{symbol:"\ud83c\uddec\ud83c\uddf6"},{symbol:"\ud83c\uddea\ud83c\uddf7"},{symbol:"\ud83c\uddea\ud83c\uddf9"},{symbol:"\ud83c\uddea\ud83c\uddfa"},{symbol:"\ud83c\uddeb\ud83c\uddf0"},{symbol:"\ud83c\uddeb\ud83c\uddf4"},{symbol:"\ud83c\uddeb\ud83c\uddef"},{symbol:"\ud83c\uddeb\ud83c\uddee"},{symbol:"\ud83c\uddeb\ud83c\uddf7"},{symbol:"\ud83c\uddec\ud83c\uddeb"},{symbol:"\ud83c\uddf5\ud83c\uddeb"},{symbol:"\ud83c\uddec\ud83c\udde6"},{symbol:"\ud83c\uddec\ud83c\uddf2"},{symbol:"\ud83c\uddec\ud83c\uddea"},{symbol:"\ud83c\udde9\ud83c\uddea"},{symbol:"\ud83c\uddec\ud83c\udded"},{symbol:"\ud83c\uddec\ud83c\uddee"},{symbol:"\ud83c\uddec\ud83c\uddf7"},{symbol:"\ud83c\uddec\ud83c\uddf1"},{symbol:"\ud83c\uddec\ud83c\udde9"},{symbol:"\ud83c\uddec\ud83c\uddf5"},{symbol:"\ud83c\uddec\ud83c\uddfa"},{symbol:"\ud83c\uddec\ud83c\uddf9"},{symbol:"\ud83c\uddec\ud83c\uddf3"},{symbol:"\ud83c\uddec\ud83c\uddfc"},{symbol:"\ud83c\uddec\ud83c\uddfe"},{symbol:"\ud83c\udded\ud83c\uddf9"},{symbol:"\ud83c\udded\ud83c\uddf3"},{symbol:"\ud83c\udded\ud83c\uddf0"},{symbol:"\ud83c\udded\ud83c\uddfa"},{symbol:"\ud83c\uddee\ud83c\uddf8"},{symbol:"\ud83c\uddee\ud83c\uddf3"},{symbol:"\ud83c\uddee\ud83c\udde9"},{symbol:"\ud83c\uddee\ud83c\uddf7"},{symbol:"\ud83c\uddee\ud83c\uddf6"},{symbol:"\ud83c\uddee\ud83c\uddea"},{symbol:"\ud83c\uddee\ud83c\uddf2"},{symbol:"\ud83c\uddee\ud83c\uddf1"},{symbol:"\ud83c\uddee\ud83c\uddf9"},{symbol:"\ud83c\uddef\ud83c\uddf2"},{symbol:"\ud83c\uddef\ud83c\uddf5"},{symbol:"\ud83c\uddef\ud83c\uddea"},{symbol:"\ud83c\uddef\ud83c\uddf4"},{symbol:"\ud83c\uddf0\ud83c\uddff"},{symbol:"\ud83c\uddf0\ud83c\uddea"},{symbol:"\ud83c\uddf0\ud83c\uddee"},{symbol:"\ud83c\uddfd\ud83c\uddf0"},{symbol:"\ud83c\uddf0\ud83c\uddfc"},{symbol:"\ud83c\uddf0\ud83c\uddec"},{symbol:"\ud83c\uddf1\ud83c\udde6"},{symbol:"\ud83c\uddf1\ud83c\uddfb"},{symbol:"\ud83c\uddf1\ud83c\udde7"},{symbol:"\ud83c\uddf1\ud83c\uddf8"},{symbol:"\ud83c\uddf1\ud83c\uddf7"},{symbol:"\ud83c\uddf1\ud83c\uddfe"},{symbol:"\ud83c\uddf1\ud83c\uddee"},{symbol:"\ud83c\uddf1\ud83c\uddf9"},{symbol:"\ud83c\uddf1\ud83c\uddfa"},{symbol:"\ud83c\uddf2\ud83c\uddf4"},{symbol:"\ud83c\uddf2\ud83c\uddf0"},{symbol:"\ud83c\uddf2\ud83c\uddec"},{symbol:"\ud83c\uddf2\ud83c\uddfc"},{symbol:"\ud83c\uddf2\ud83c\uddfe"},{symbol:"\ud83c\uddf2\ud83c\uddfb"},{symbol:"\ud83c\uddf2\ud83c\uddf1"},{symbol:"\ud83c\uddf2\ud83c\uddf9"},{symbol:"\ud83c\uddf2\ud83c\udded"},{symbol:"\ud83c\uddf2\ud83c\uddf7"},{symbol:"\ud83c\uddf2\ud83c\uddfa"},{symbol:"\ud83c\uddfe\ud83c\uddf9"},{symbol:"\ud83c\uddf2\ud83c\uddfd"},{symbol:"\ud83c\uddeb\ud83c\uddf2"},{symbol:"\ud83c\uddf2\ud83c\udde9"},{symbol:"\ud83c\uddf2\ud83c\udde8"},{symbol:"\ud83c\uddf2\ud83c\uddf3"},{symbol:"\ud83c\uddf2\ud83c\uddea"},{symbol:"\ud83c\uddf2\ud83c\uddf8"},{symbol:"\ud83c\uddf2\ud83c\udde6"},{symbol:"\ud83c\uddf2\ud83c\uddff"},{symbol:"\ud83c\uddf3\ud83c\udde6"},{symbol:"\ud83c\uddf3\ud83c\uddf7"},{symbol:"\ud83c\uddf3\ud83c\uddf5"},{symbol:"\ud83c\uddf3\ud83c\uddf1"},{symbol:"\ud83c\uddf3\ud83c\udde8"},{symbol:"\ud83c\uddf3\ud83c\uddff"},{symbol:"\ud83c\uddf3\ud83c\uddee"},{symbol:"\ud83c\uddf3\ud83c\uddea"},{symbol:"\ud83c\uddf3\ud83c\uddec"},{symbol:"\ud83c\uddf3\ud83c\uddfa"},{symbol:"\ud83c\uddf3\ud83c\uddeb"},{symbol:"\ud83c\uddf0\ud83c\uddf5"},{symbol:"\ud83c\uddf2\ud83c\uddf5"},{symbol:"\ud83c\uddf3\ud83c\uddf4"},{symbol:"\ud83c\uddf4\ud83c\uddf2"},{symbol:"\ud83c\uddf5\ud83c\uddf0"},{symbol:"\ud83c\uddf5\ud83c\uddfc"},{symbol:"\ud83c\uddf5\ud83c\uddf8"},{symbol:"\ud83c\uddf5\ud83c\udde6"},{symbol:"\ud83c\uddf5\ud83c\uddec"},{symbol:"\ud83c\uddf5\ud83c\uddfe"},{symbol:"\ud83c\uddf5\ud83c\uddea"},{symbol:"\ud83c\uddf5\ud83c\udded"},{symbol:"\ud83c\uddf5\ud83c\uddf3"},{symbol:"\ud83c\uddf5\ud83c\uddf1"},{symbol:"\ud83c\uddf5\ud83c\uddf9"},{symbol:"\ud83c\uddf5\ud83c\uddf7"},{symbol:"\ud83c\uddf6\ud83c\udde6"},{symbol:"\ud83c\uddf7\ud83c\uddf4"},{symbol:"\ud83c\uddf7\ud83c\uddfa"},{symbol:"\ud83c\uddf7\ud83c\uddfc"},{symbol:"\ud83c\uddfc\ud83c\uddf8"},{symbol:"\ud83c\uddf8\ud83c\uddf2"},{symbol:"\ud83c\uddf8\ud83c\uddf9"},{symbol:"\ud83c\uddf8\ud83c\udde6"},{symbol:"\ud83c\uddf8\ud83c\uddf3"},{symbol:"\ud83c\uddf7\ud83c\uddf8"},{symbol:"\ud83c\uddf8\ud83c\udde8"},{symbol:"\ud83c\uddf8\ud83c\uddf1"},{symbol:"\ud83c\uddf8\ud83c\uddec"},{symbol:"\ud83c\uddf8\ud83c\uddfd"},{symbol:"\ud83c\uddf8\ud83c\uddf0"},{symbol:"\ud83c\uddf8\ud83c\uddee"},{symbol:"\ud83c\uddec\ud83c\uddf8"},{symbol:"\ud83c\uddf8\ud83c\udde7"},{symbol:"\ud83c\uddf8\ud83c\uddf4"},{symbol:"\ud83c\uddff\ud83c\udde6"},{symbol:"\ud83c\uddf0\ud83c\uddf7"},{symbol:"\ud83c\uddea\ud83c\uddf8"},{symbol:"\ud83c\uddf1\ud83c\uddf0"},{symbol:"\ud83c\uddf8\ud83c\udded"},{symbol:"\ud83c\uddf0\ud83c\uddf3"},{symbol:"\ud83c\uddf1\ud83c\udde8"},{symbol:"\ud83c\uddf5\ud83c\uddf2"},{symbol:"\ud83c\uddfb\ud83c\udde8"},{symbol:"\ud83c\uddf8\ud83c\udde9"},{symbol:"\ud83c\uddf8\ud83c\uddf7"},{symbol:"\ud83c\uddf8\ud83c\uddff"},{symbol:"\ud83c\uddf8\ud83c\uddea"},{symbol:"\ud83c\udde8\ud83c\udded"},{symbol:"\ud83c\uddf8\ud83c\uddfe"},{symbol:"\ud83c\uddf9\ud83c\uddfc"},{symbol:"\ud83c\uddf9\ud83c\uddef"},{symbol:"\ud83c\uddf9\ud83c\uddff"},{symbol:"\ud83c\uddf9\ud83c\udded"},{symbol:"\ud83c\uddf9\ud83c\uddf1"},{symbol:"\ud83c\uddf9\ud83c\uddec"},{symbol:"\ud83c\uddf9\ud83c\uddf0"},{symbol:"\ud83c\uddf9\ud83c\uddf4"},{symbol:"\ud83c\uddf9\ud83c\uddf3"},{symbol:"\ud83c\uddf9\ud83c\uddf7"},{symbol:"\ud83c\uddf9\ud83c\uddf2"},{symbol:"\ud83c\uddf9\ud83c\udde8"},{symbol:"\ud83c\uddf9\ud83c\uddfb"},{symbol:"\ud83c\uddfb\ud83c\uddee"},{symbol:"\ud83c\uddfa\ud83c\uddec"},{symbol:"\ud83c\uddfa\ud83c\udde6"},{symbol:"\ud83c\udde6\ud83c\uddea"},{symbol:"\ud83c\uddec\ud83c\udde7"},{symbol:"\ud83c\uddfa\ud83c\uddf8"},{symbol:"\ud83c\uddfa\ud83c\uddfe"},{symbol:"\ud83c\uddfa\ud83c\uddff"},{symbol:"\ud83c\uddfb\ud83c\uddfa"},{symbol:"\ud83c\uddfb\ud83c\udde6"},{symbol:"\ud83c\uddfb\ud83c\uddea"},{symbol:"\ud83c\uddfb\ud83c\uddf3"},{symbol:"\ud83c\uddfc\ud83c\uddeb"},{symbol:"\ud83c\uddea\ud83c\udded"},{symbol:"\ud83c\uddfe\ud83c\uddea"},{symbol:"\ud83c\uddff\ud83c\uddf2"},{symbol:"\ud83c\uddff\ud83c\uddfc"}]}];i.WidgetBitrixVue.component("bx-smiles",{data:function e(){return{smiles:[],sets:[],emoji:[],mode:"smile",emojiIcon:"\ud83d\ude0d"}},created:function e(){var t=this;this.setSelected=0;this.serverLoad=false;var n=this.$root.$bitrixRestClient||this.$Bitrix.RestClient.get();this.smilesController=new a(n);this.smilesController.loadFromCache().then((function(e){if(t.serverLoad)return true;t.smiles=e.smiles;t.sets=e.sets.map((function(e,n){e.selected=t.setSelected===n;return e}))}));this.smilesController.loadFromServer().then((function(e){t.smiles=e.smiles;t.sets=e.sets.map((function(e,n){e.selected=t.setSelected===n;return e}))}));this.emoji=l},methods:{selectSet:function e(t){var n=this;this.mode="smile";this.$emit("selectSet",{setId:t});this.smilesController.changeSet(t).then((function(e){n.smiles=e;n.sets.map((function(e){e.selected=e.id===t;if(e.selected){n.setSelected=t}return e}));n.$refs.elements.scrollTop=0}))},selectSmile:function e(t){this.$emit("selectSmile",{text:" "+t+" "})},switchToEmoji:function e(){this.mode="emoji";this.sets.map((function(e){e.selected=false}))},showCategory:function e(t){if(this.isWindows()){return t.showForWindows}else{return true}},isMac:function e(){return navigator.userAgent.toLowerCase().includes("macintosh")},isLinux:function e(){return navigator.userAgent.toLowerCase().includes("linux")},isWindows:function e(){return navigator.userAgent.toLowerCase().includes("windows")||!this.isMac()&&!this.isLinux()}},computed:{showEmoji:function e(){return this.$Bitrix.Loc.getMessage("UTF_MODE")==="Y"},isEmojiMode:function e(){return this.mode==="emoji"},isSmileMode:function e(){return this.mode==="smile"},emojiIconStyle:function e(){var t="bx-ui-smiles-set-emoji";if(this.isMac()){return t+="-mac"}else if(this.isLinux()){return t+="-linux"}else if(this.isWindows()){return t+="-win"}else{return t}}},template:'\n\t\t<div class="bx-ui-smiles-box">\n\t\t\t<div class="bx-ui-smiles-elements-wrap" ref="elements">\n\t\t\t\t<template v-if="!smiles.length">\n\t\t\t\t\t<svg class="bx-ui-smiles-loading-circular" viewBox="25 25 50 50">\n\t\t\t\t\t\t<circle class="bx-ui-smiles-loading-path" cx="50" cy="50" r="20" fill="none" stroke-miterlimit="10"/>\n\t\t\t\t\t\t<circle class="bx-ui-smiles-loading-inner-path" cx="50" cy="50" r="20" fill="none" stroke-miterlimit="10"/>\n\t\t\t\t\t</svg>\n\t\t\t\t</template>\n\t\t\t\t<template v-else-if="isSmileMode">\n\t\t\t\t\t<template v-for="smile in smiles">\n\t\t\t\t\t\t<div class="bx-ui-smiles-smile">\n\t\t\t\t\t\t\t<img v-bx-lazyload :key="smile.id"\n\t\t\t\t\t\t\t\tclass="bx-ui-smiles-smile-icon"\n\t\t\t\t\t\t\t\t:data-lazyload-src="smile.image"\n\t\t\t\t\t\t\t\tdata-lazyload-error-class="bx-ui-smiles-smile-icon-error"\n\t\t\t\t\t\t\t\t:title="smile.name"\n\t\t\t\t\t\t\t\t:style="{height: (smile.originalHeight*0.5)+\'px\', width: (smile.originalWidth*0.5)+\'px\'}"\n\t\t\t\t\t\t\t\t@click="selectSmile(smile.typing)"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</template>\n\t\t\t\t</template>\n\t\t\t\t<template v-else-if="isEmojiMode">\n\t\t\t\t\t<div v-for="category in emoji" class="bx-ui-smiles-emoji-wrap">\n\t\t\t\t\t\t<template v-if="showCategory(category)">\n\t\t\t\t\t\t\t<div class="bx-ui-smiles-category">\n\t\t\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage(\'UI_VUE_SMILES_EMOJI_CATEGORY_\' + category.code) }}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<template v-for="element in category.emoji">\n\t\t\t\t\t\t\t\t<div class="bx-ui-smiles-smile" style="font-size: 28px;">\n\t\t\t\t\t\t\t\t\t<div class="bx-ui-smiles-smile-icon" @click="selectSmile(element.symbol)">\n\t\t\t\t\t\t\t\t\t\t{{ element.symbol }}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t</div>\n\t\t\t<template v-if="sets.length > 1 || emoji && showEmoji">\n\t\t\t\t<div class="bx-ui-smiles-sets">\n\t\t\t\t\t<template v-for="set in sets">\n\t\t\t\t\t\t<div :class="[\'bx-ui-smiles-set\', {\'bx-ui-smiles-set-selected\': set.selected}]">\n\t\t\t\t\t\t\t<img v-bx-lazyload\n\t\t\t\t\t\t\t\t:key="set.id"\n\t\t\t\t\t\t\t\tclass="bx-ui-smiles-set-icon"\n\t\t\t\t\t\t\t\t:data-lazyload-src="set.image"\n\t\t\t\t\t\t\t\tdata-lazyload-error-class="bx-ui-smiles-set-icon-error"\n\t\t\t\t\t\t\t\t:title="set.name"\n\t\t\t\t\t\t\t\t@click="selectSet(set.id)"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</template>\n\t\t\t\t\t<div v-if="emoji && showEmoji" :class="[\'bx-ui-smiles-set\', {\'bx-ui-smiles-set-selected\': isEmojiMode}]">\n\t\t\t\t\t\t<div :class="[\'bx-ui-smiles-set-icon\', emojiIconStyle]" @click="switchToEmoji">\n\t\t\t\t\t\t \t{{ emojiIcon }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t</div>\n\t'})})(this.window=this.window||{},BX,window,BX,BX.Dexie3);
/*!
  * ProgressBar.js v1.1.0
  * (c) 2016 Kimmo Brunfeldt
  * @license MIT
  *
  * GitHub: https://kimmobrunfeldt.github.io/progressbar.js
  */(function(e){if(typeof window.BX==="undefined"){window.BX={}}window.BX.ProgressBarJs=e()})((function(){var e,t,n;return function(){function e(t,n,i){function r(o,a){if(!n[o]){if(!t[o]){var l="function"==typeof require&&require;if(!a&&l)return l(o,!0);if(s)return s(o,!0);var u=new Error("Cannot find module '"+o+"'");throw u.code="MODULE_NOT_FOUND",u}var c=n[o]={exports:{}};t[o][0].call(c.exports,(function(e){var n=t[o][1][e];return r(n||e)}),c,c.exports,e,t,n,i)}return n[o].exports}for(var s="function"==typeof require&&require,o=0;o<i.length;o++)r(i[o]);return r}return e}()({1:[function(t,n,i){
/*! Shifty 2.8.0 - https://github.com/jeremyckahn/shifty */
!function(t,r){"object"==typeof i&&"object"==typeof n?n.exports=r():"function"==typeof e&&e.amd?e("shifty",[],r):"object"==typeof i?i.shifty=r():t.shifty=r()}(window,(function(){return function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=3)}([function(e,t,n){"use strict";(function(e){n.d(t,"e",(function(){return p})),n.d(t,"c",(function(){return g})),n.d(t,"b",(function(){return v})),n.d(t,"a",(function(){return b})),n.d(t,"d",(function(){return w}));var i=n(1);function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},i=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),i.forEach((function(t){a(e,t,n[t])}))}return e}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var l="undefined"!=typeof window?window:e,u=l.requestAnimationFrame||l.webkitRequestAnimationFrame||l.oRequestAnimationFrame||l.msRequestAnimationFrame||l.mozCancelRequestAnimationFrame&&l.mozRequestAnimationFrame||setTimeout,c=function(){},f=null,d=null,h=o({},i),p=function(e,t,n,i,r,s,o){var a=e<s?0:(e-s)/r;for(var l in t){var u=o[l],c=u.call?u:h[u],f=n[l];t[l]=f+(i[l]-f)*c(a)}return t},m=function(e,t){var n=e._attachment,i=e._currentState,r=e._delay,s=e._easing,o=e._originalState,a=e._duration,l=e._step,u=e._targetState,c=e._timestamp,f=c+r+a,d=t>f?f:t,h=a-(f-d);d>=f?(l(u,n,h),e.stop(!0)):(e._applyFilter("beforeTween"),d<c+r?(d=1,a=1,c=1):c+=r,p(d,i,o,u,a,c,s),e._applyFilter("afterTween"),l(i,n,h))},g=function(){for(var e=b.now(),t=f;t;){var n=t._next;m(t,e),t=n}},v=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"linear",n={},i=s(t);if("string"===i||"function"===i)for(var r in e)n[r]=t;else for(var o in e)n[o]=t[o]||"linear";return n},y=function(e){if(e===f)(f=e._next)?f._previous=null:d=null;else if(e===d)(d=e._previous)?d._next=null:f=null;else{var t=e._previous,n=e._next;t._next=n,n._previous=t}e._previous=e._next=null},b=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._currentState=t,this._configured=!1,this._filters=[],this._timestamp=null,this._next=null,this._previous=null,n&&this.setConfig(n)}var t,n,i;return t=e,(n=[{key:"_applyFilter",value:function(e){var t=!0,n=!1,i=void 0;try{for(var r,s=this._filters[Symbol.iterator]();!(t=(r=s.next()).done);t=!0){var o=r.value[e];o&&o(this)}}catch(e){n=!0,i=e}finally{try{t||null==s.return||s.return()}finally{if(n)throw i}}}},{key:"tween",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,n=this._attachment,i=this._configured;return!t&&i||this.setConfig(t),this._pausedAtTime=null,this._timestamp=e.now(),this._start(this.get(),n),this.resume()}},{key:"setConfig",value:function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=n.attachment,r=n.delay,s=void 0===r?0:r,a=n.duration,l=void 0===a?500:a,u=n.easing,f=n.from,d=n.promise,h=void 0===d?Promise:d,p=n.start,m=void 0===p?c:p,g=n.step,y=void 0===g?c:g,b=n.to;this._configured=!0,this._attachment=i,this._isPlaying=!1,this._pausedAtTime=null,this._scheduleId=null,this._delay=s,this._start=m,this._step=y,this._duration=l,this._currentState=o({},f||this.get()),this._originalState=this.get(),this._targetState=o({},b||this.get());var w=this._currentState;this._targetState=o({},w,this._targetState),this._easing=v(w,u);var S=e.filters;for(var I in this._filters.length=0,S)S[I].doesApply(this)&&this._filters.push(S[I]);return this._applyFilter("tweenCreated"),this._promise=new h((function(e,n){t._resolve=e,t._reject=n})),this._promise.catch(c),this}},{key:"get",value:function(){return o({},this._currentState)}},{key:"set",value:function(e){this._currentState=e}},{key:"pause",value:function(){if(this._isPlaying)return this._pausedAtTime=e.now(),this._isPlaying=!1,y(this),this}},{key:"resume",value:function(){if(null===this._timestamp)return this.tween();if(this._isPlaying)return this._promise;var t=e.now();return this._pausedAtTime&&(this._timestamp+=t-this._pausedAtTime,this._pausedAtTime=null),this._isPlaying=!0,null===f?(f=this,d=this,function e(){f&&(u.call(l,e,1e3/60),g())}()):(this._previous=d,d._next=this,d=this),this._promise}},{key:"seek",value:function(t){t=Math.max(t,0);var n=e.now();return this._timestamp+t===0?this:(this._timestamp=n-t,this._isPlaying||m(this,n),this)}},{key:"stop",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this._attachment,n=this._currentState,i=this._easing,r=this._originalState,s=this._targetState;if(this._isPlaying)return this._isPlaying=!1,y(this),e?(this._applyFilter("beforeTween"),p(1,n,r,s,1,0,i),this._applyFilter("afterTween"),this._applyFilter("afterTweenEnd"),this._resolve(n,t)):this._reject(n,t),this}},{key:"isPlaying",value:function(){return this._isPlaying}},{key:"setScheduleFunction",value:function(t){e.setScheduleFunction(t)}},{key:"dispose",value:function(){for(var e in this)delete this[e]}}])&&r(t.prototype,n),i&&r(t,i),e}();function w(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=new b,n=t.tween(e);return n.tweenable=t,n}b.setScheduleFunction=function(e){return u=e},b.formulas=h,b.filters={},b.now=Date.now||function(){return+new Date}}).call(this,n(2))},function(e,t,n){"use strict";n.r(t),n.d(t,"linear",(function(){return i})),n.d(t,"easeInQuad",(function(){return r})),n.d(t,"easeOutQuad",(function(){return s})),n.d(t,"easeInOutQuad",(function(){return o})),n.d(t,"easeInCubic",(function(){return a})),n.d(t,"easeOutCubic",(function(){return l})),n.d(t,"easeInOutCubic",(function(){return u})),n.d(t,"easeInQuart",(function(){return c})),n.d(t,"easeOutQuart",(function(){return f})),n.d(t,"easeInOutQuart",(function(){return d})),n.d(t,"easeInQuint",(function(){return h})),n.d(t,"easeOutQuint",(function(){return p})),n.d(t,"easeInOutQuint",(function(){return m})),n.d(t,"easeInSine",(function(){return g})),n.d(t,"easeOutSine",(function(){return v})),n.d(t,"easeInOutSine",(function(){return y})),n.d(t,"easeInExpo",(function(){return b})),n.d(t,"easeOutExpo",(function(){return w})),n.d(t,"easeInOutExpo",(function(){return S})),n.d(t,"easeInCirc",(function(){return I})),n.d(t,"easeOutCirc",(function(){return k})),n.d(t,"easeInOutCirc",(function(){return C})),n.d(t,"easeOutBounce",(function(){return E})),n.d(t,"easeInBack",(function(){return _})),n.d(t,"easeOutBack",(function(){return x})),n.d(t,"easeInOutBack",(function(){return T})),n.d(t,"elastic",(function(){return O})),n.d(t,"swingFromTo",(function(){return M})),n.d(t,"swingFrom",(function(){return D})),n.d(t,"swingTo",(function(){return A})),n.d(t,"bounce",(function(){return P})),n.d(t,"bouncePast",(function(){return L})),n.d(t,"easeFromTo",(function(){return R})),n.d(t,"easeFrom",(function(){return H})),n.d(t,"easeTo",(function(){return j}));
/*!
 * All equations are adapted from Thomas Fuchs'
 * [Scripty2](https://github.com/madrobby/scripty2/blob/master/src/effects/transitions/penner.js).
 *
 * Based on Easing Equations (c) 2003 [Robert
 * Penner](http://www.robertpenner.com/), all rights reserved. This work is
 * [subject to terms](http://www.robertpenner.com/easing_terms_of_use.html).
 */
/*!
 *  TERMS OF USE - EASING EQUATIONS
 *  Open source under the BSD License.
 *  Easing Equations (c) 2003 Robert Penner, all rights reserved.
 */var i=function(e){return e},r=function(e){return Math.pow(e,2)},s=function(e){return-(Math.pow(e-1,2)-1)},o=function(e){return(e/=.5)<1?.5*Math.pow(e,2):-.5*((e-=2)*e-2)},a=function(e){return Math.pow(e,3)},l=function(e){return Math.pow(e-1,3)+1},u=function(e){return(e/=.5)<1?.5*Math.pow(e,3):.5*(Math.pow(e-2,3)+2)},c=function(e){return Math.pow(e,4)},f=function(e){return-(Math.pow(e-1,4)-1)},d=function(e){return(e/=.5)<1?.5*Math.pow(e,4):-.5*((e-=2)*Math.pow(e,3)-2)},h=function(e){return Math.pow(e,5)},p=function(e){return Math.pow(e-1,5)+1},m=function(e){return(e/=.5)<1?.5*Math.pow(e,5):.5*(Math.pow(e-2,5)+2)},g=function(e){return 1-Math.cos(e*(Math.PI/2))},v=function(e){return Math.sin(e*(Math.PI/2))},y=function(e){return-.5*(Math.cos(Math.PI*e)-1)},b=function(e){return 0===e?0:Math.pow(2,10*(e-1))},w=function(e){return 1===e?1:1-Math.pow(2,-10*e)},S=function(e){return 0===e?0:1===e?1:(e/=.5)<1?.5*Math.pow(2,10*(e-1)):.5*(2-Math.pow(2,-10*--e))},I=function(e){return-(Math.sqrt(1-e*e)-1)},k=function(e){return Math.sqrt(1-Math.pow(e-1,2))},C=function(e){return(e/=.5)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)},E=function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},_=function(e){var t=1.70158;return e*e*((t+1)*e-t)},x=function(e){var t=1.70158;return(e-=1)*e*((t+1)*e+t)+1},T=function(e){var t=1.70158;return(e/=.5)<1?e*e*((1+(t*=1.525))*e-t)*.5:.5*((e-=2)*e*((1+(t*=1.525))*e+t)+2)},O=function(e){return-1*Math.pow(4,-8*e)*Math.sin((6*e-1)*(2*Math.PI)/2)+1},M=function(e){var t=1.70158;return(e/=.5)<1?e*e*((1+(t*=1.525))*e-t)*.5:.5*((e-=2)*e*((1+(t*=1.525))*e+t)+2)},D=function(e){var t=1.70158;return e*e*((t+1)*e-t)},A=function(e){var t=1.70158;return(e-=1)*e*((t+1)*e+t)+1},P=function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},L=function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?2-(7.5625*(e-=1.5/2.75)*e+.75):e<2.5/2.75?2-(7.5625*(e-=2.25/2.75)*e+.9375):2-(7.5625*(e-=2.625/2.75)*e+.984375)},R=function(e){return(e/=.5)<1?.5*Math.pow(e,4):-.5*((e-=2)*Math.pow(e,3)-2)},H=function(e){return Math.pow(e,4)},j=function(e){return Math.pow(e,.25)}},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";n.r(t);var i={};n.r(i),n.d(i,"doesApply",(function(){return T})),n.d(i,"tweenCreated",(function(){return O})),n.d(i,"beforeTween",(function(){return M})),n.d(i,"afterTween",(function(){return D}));var r,s,o=n(0),a=/(\d|-|\.)/,l=/([^\-0-9.]+)/g,u=/[0-9.-]+/g,c=(r=u.source,s=/,\s*/.source,new RegExp("rgb\\(".concat(r).concat(s).concat(r).concat(s).concat(r,"\\)"),"g")),f=/^.*\(/,d=/#([0-9]|[a-f]){3,6}/gi,h=function(e,t){return e.map((function(e,n){return"_".concat(t,"_").concat(n)}))};function p(e){return parseInt(e,16)}var m=function(e){return"rgb(".concat((t=e,3===(t=t.replace(/#/,"")).length&&(t=(t=t.split(""))[0]+t[0]+t[1]+t[1]+t[2]+t[2]),[p(t.substr(0,2)),p(t.substr(2,2)),p(t.substr(4,2))]).join(","),")");var t},g=function(e,t,n){var i=t.match(e),r=t.replace(e,"VAL");return i&&i.forEach((function(e){return r=r.replace("VAL",n(e))})),r},v=function(e){for(var t in e){var n=e[t];"string"==typeof n&&n.match(d)&&(e[t]=g(d,n,m))}},y=function(e){var t=e.match(u).map(Math.floor),n=e.match(f)[0];return"".concat(n).concat(t.join(","),")")},b=function(e){return e.match(u)},w=function(e){var t,n,i={};for(var r in e){var s=e[r];"string"==typeof s&&(i[r]={formatString:(t=s,n=void 0,n=t.match(l),n?(1===n.length||t.charAt(0).match(a))&&n.unshift(""):n=["",""],n.join("VAL")),chunkNames:h(b(s),r)})}return i},S=function(e,t){var n=function(n){b(e[n]).forEach((function(i,r){return e[t[n].chunkNames[r]]=+i})),delete e[n]};for(var i in t)n(i)},I=function(e,t){var n={};return t.forEach((function(t){n[t]=e[t],delete e[t]})),n},k=function(e,t){return t.map((function(t){return e[t]}))},C=function(e,t){return t.forEach((function(t){return e=e.replace("VAL",+t.toFixed(4))})),e},E=function(e,t){for(var n in t){var i=t[n],r=i.chunkNames,s=i.formatString,o=C(s,k(I(e,r),r));e[n]=g(c,o,y)}},_=function(e,t){var n=function(n){var i=t[n].chunkNames,r=e[n];if("string"==typeof r){var s=r.split(" "),o=s[s.length-1];i.forEach((function(t,n){return e[t]=s[n]||o}))}else i.forEach((function(t){return e[t]=r}));delete e[n]};for(var i in t)n(i)},x=function(e,t){for(var n in t){var i=t[n].chunkNames,r=e[i[0]];e[n]="string"==typeof r?i.map((function(t){var n=e[t];return delete e[t],n})).join(" "):r}},T=function(e){var t=e._currentState;return Object.keys(t).some((function(e){return"string"==typeof t[e]}))};function O(e){var t=e._currentState;[t,e._originalState,e._targetState].forEach(v),e._tokenData=w(t)}function M(e){var t=e._currentState,n=e._originalState,i=e._targetState,r=e._easing,s=e._tokenData;_(r,s),[t,n,i].forEach((function(e){return S(e,s)}))}function D(e){var t=e._currentState,n=e._originalState,i=e._targetState,r=e._easing,s=e._tokenData;[t,n,i].forEach((function(e){return E(e,s)})),x(r,s)}function A(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var P=new o.a,L=o.a.filters,R=function(e,t,n,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},i=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),i.forEach((function(t){A(e,t,n[t])}))}return e}({},e),a=Object(o.b)(e,i);for(var l in P._filters.length=0,P.set({}),P._currentState=s,P._originalState=e,P._targetState=t,P._easing=a,L)L[l].doesApply(P)&&P._filters.push(L[l]);P._applyFilter("tweenCreated"),P._applyFilter("beforeTween");var u=Object(o.e)(n,s,e,t,1,r,a);return P._applyFilter("afterTween"),u};function H(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function j(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function N(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");var n=t.get(e);return n.get?n.get.call(e):n.value}var B=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),F.set(this,{writable:!0,value:[]});for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];n.forEach(this.add.bind(this))}var t,n,i;return t=e,(n=[{key:"add",value:function(e){return N(this,F).push(e),e}},{key:"remove",value:function(e){var t=N(this,F).indexOf(e);return~t&&N(this,F).splice(t,1),e}},{key:"empty",value:function(){return this.tweenables.map(this.remove.bind(this))}},{key:"isPlaying",value:function(){return N(this,F).some((function(e){return e.isPlaying()}))}},{key:"play",value:function(){return N(this,F).forEach((function(e){return e.tween()})),this}},{key:"pause",value:function(){return N(this,F).forEach((function(e){return e.pause()})),this}},{key:"resume",value:function(){return N(this,F).forEach((function(e){return e.resume()})),this}},{key:"stop",value:function(e){return N(this,F).forEach((function(t){return t.stop(e)})),this}},{key:"tweenables",get:function(){return H(N(this,F))}},{key:"promises",get:function(){return N(this,F).map((function(e){return e._promise}))}}])&&j(t.prototype,n),i&&j(t,i),e}(),F=new WeakMap;function U(e,t,n,i,r,s){var o=0,a=0,l=0,u=0,c=0,f=0,d=function(e){return((o*e+a)*e+l)*e},h=function(e){return e>=0?e:0-e};return o=1-(l=3*t)-(a=3*(i-t)-l),u=1-(f=3*n)-(c=3*(r-n)-f),function(e,t){return n=function(e,t){var n,i,r,s,u,c,f;for(r=e,c=0;c<8;c++){if(s=d(r)-e,h(s)<t)return r;if(h(u=(3*o*(f=r)+2*a)*f+l)<1e-6)break;r-=s/u}if((r=e)<(n=0))return n;if(r>(i=1))return i;for(;n<i;){if(s=d(r),h(s-e)<t)return r;e>s?n=r:i=r,r=.5*(i-n)+n}return r}(e,t),((u*n+c)*n+f)*n;var n}(e,function(e){return 1/(200*e)}(s))}var W=function(e,t,n,i,r){var s=function(e,t,n,i){return function(r){return U(r,e,t,n,i,1)}}(t,n,i,r);return s.displayName=e,s.x1=t,s.y1=n,s.x2=i,s.y2=r,o.a.formulas[e]=s},$=function(e){return delete o.a.formulas[e]};n.d(t,"processTweens",(function(){return o.c})),n.d(t,"Tweenable",(function(){return o.a})),n.d(t,"tween",(function(){return o.d})),n.d(t,"interpolate",(function(){return R})),n.d(t,"Scene",(function(){return B})),n.d(t,"setBezierFunction",(function(){return W})),n.d(t,"unsetBezierFunction",(function(){return $})),o.a.filters.token=i}])}))},{}],2:[function(e,t,n){var i=e("./shape");var r=e("./utils");var s=function e(t,n){this._pathTemplate="M 50,50 m 0,-{radius}"+" a {radius},{radius} 0 1 1 0,{2radius}"+" a {radius},{radius} 0 1 1 0,-{2radius}";this.containerAspectRatio=1;i.apply(this,arguments)};s.prototype=new i;s.prototype.constructor=s;s.prototype._pathString=function e(t){var n=t.strokeWidth;if(t.trailWidth&&t.trailWidth>t.strokeWidth){n=t.trailWidth}var i=50-n/2;return r.render(this._pathTemplate,{radius:i,"2radius":i*2})};s.prototype._trailString=function e(t){return this._pathString(t)};t.exports=s},{"./shape":7,"./utils":9}],3:[function(e,t,n){var i=e("./shape");var r=e("./utils");var s=function e(t,n){this._pathTemplate="M 0,{center} L 100,{center}";i.apply(this,arguments)};s.prototype=new i;s.prototype.constructor=s;s.prototype._initializeSvg=function e(t,n){t.setAttribute("viewBox","0 0 100 "+n.strokeWidth);t.setAttribute("preserveAspectRatio","none")};s.prototype._pathString=function e(t){return r.render(this._pathTemplate,{center:t.strokeWidth/2})};s.prototype._trailString=function e(t){return this._pathString(t)};t.exports=s},{"./shape":7,"./utils":9}],4:[function(e,t,n){t.exports={Line:e("./line"),Circle:e("./circle"),SemiCircle:e("./semicircle"),Square:e("./square"),Path:e("./path"),Shape:e("./shape"),utils:e("./utils")}},{"./circle":2,"./line":3,"./path":5,"./semicircle":6,"./shape":7,"./square":8,"./utils":9}],5:[function(e,t,n){var i=e("shifty");var r=e("./utils");var s=i.Tweenable;var o={easeIn:"easeInCubic",easeOut:"easeOutCubic",easeInOut:"easeInOutCubic"};var a=function e(t,n){if(!(this instanceof e)){throw new Error("Constructor was called without new keyword")}n=r.extend({delay:0,duration:800,easing:"linear",from:{},to:{},step:function(){}},n);var i;if(r.isString(t)){i=document.querySelector(t)}else{i=t}this.path=i;this._opts=n;this._tweenable=null;var s=this.path.getTotalLength();this.path.style.strokeDasharray=s+" "+s;this.set(0)};a.prototype.value=function e(){var t=this._getComputedDashOffset();var n=this.path.getTotalLength();var i=1-t/n;return parseFloat(i.toFixed(6),10)};a.prototype.set=function e(t){this.stop();this.path.style.strokeDashoffset=this._progressToOffset(t);var n=this._opts.step;if(r.isFunction(n)){var i=this._easing(this._opts.easing);var s=this._calculateTo(t,i);var o=this._opts.shape||this;n(s,o,this._opts.attachment)}};a.prototype.stop=function e(){this._stopTween();this.path.style.strokeDashoffset=this._getComputedDashOffset()};a.prototype.animate=function e(t,n,i){n=n||{};if(r.isFunction(n)){i=n;n={}}var o=r.extend({},n);var a=r.extend({},this._opts);n=r.extend(a,n);var l=this._easing(n.easing);var u=this._resolveFromAndTo(t,l,o);this.stop();this.path.getBoundingClientRect();var c=this._getComputedDashOffset();var f=this._progressToOffset(t);var d=this;this._tweenable=new s;this._tweenable.tween({from:r.extend({offset:c},u.from),to:r.extend({offset:f},u.to),duration:n.duration,delay:n.delay,easing:l,step:function(e){d.path.style.strokeDashoffset=e.offset;var t=n.shape||d;n.step(e,t,n.attachment)}}).then((function(e){if(r.isFunction(i)){i()}})).catch((function(e){}))};a.prototype._getComputedDashOffset=function e(){var t=window.getComputedStyle(this.path,null);var n=t.getPropertyValue("stroke-dashoffset");return n?parseFloat(n,10):0};a.prototype._progressToOffset=function e(t){var n=this.path.getTotalLength();return n-t*n};a.prototype._resolveFromAndTo=function e(t,n,i){if(i.from&&i.to){return{from:i.from,to:i.to}}return{from:this._calculateFrom(n),to:this._calculateTo(t,n)}};a.prototype._calculateFrom=function e(t){return i.interpolate(this._opts.from,this._opts.to,this.value(),t)};a.prototype._calculateTo=function e(t,n){return i.interpolate(this._opts.from,this._opts.to,t,n)};a.prototype._stopTween=function e(){if(this._tweenable!==null){this._tweenable.stop();this._tweenable=null}};a.prototype._easing=function e(t){if(o.hasOwnProperty(t)){return o[t]}return t};t.exports=a},{"./utils":9,shifty:1}],6:[function(e,t,n){var i=e("./shape");var r=e("./circle");var s=e("./utils");var o=function e(t,n){this._pathTemplate="M 50,50 m -{radius},0"+" a {radius},{radius} 0 1 1 {2radius},0";this.containerAspectRatio=2;i.apply(this,arguments)};o.prototype=new i;o.prototype.constructor=o;o.prototype._initializeSvg=function e(t,n){t.setAttribute("viewBox","0 0 100 50")};o.prototype._initializeTextContainer=function e(t,n,i){if(t.text.style){i.style.top="auto";i.style.bottom="0";if(t.text.alignToBottom){s.setStyle(i,"transform","translate(-50%, 0)")}else{s.setStyle(i,"transform","translate(-50%, 50%)")}}};o.prototype._pathString=r.prototype._pathString;o.prototype._trailString=r.prototype._trailString;t.exports=o},{"./circle":2,"./shape":7,"./utils":9}],7:[function(e,t,n){var i=e("./path");var r=e("./utils");var s="Object is destroyed";var o=function e(t,n){if(!(this instanceof e)){throw new Error("Constructor was called without new keyword")}if(arguments.length===0){return}this._opts=r.extend({color:"#555",strokeWidth:1,trailColor:null,trailWidth:null,fill:null,text:{style:{color:null,position:"absolute",left:"50%",top:"50%",padding:0,margin:0,transform:{prefix:true,value:"translate(-50%, -50%)"}},autoStyleContainer:true,alignToBottom:true,value:null,className:"progressbar-text"},svgStyle:{display:"block",width:"100%"},warnings:false},n,true);if(r.isObject(n)&&n.svgStyle!==undefined){this._opts.svgStyle=n.svgStyle}if(r.isObject(n)&&r.isObject(n.text)&&n.text.style!==undefined){this._opts.text.style=n.text.style}var s=this._createSvgView(this._opts);var o;if(r.isString(t)){o=document.querySelector(t)}else{o=t}if(!o){throw new Error("Container does not exist: "+t)}this._container=o;this._container.appendChild(s.svg);if(this._opts.warnings){this._warnContainerAspectRatio(this._container)}if(this._opts.svgStyle){r.setStyles(s.svg,this._opts.svgStyle)}this.svg=s.svg;this.path=s.path;this.trail=s.trail;this.text=null;var a=r.extend({attachment:undefined,shape:this},this._opts);this._progressPath=new i(s.path,a);if(r.isObject(this._opts.text)&&this._opts.text.value!==null){this.setText(this._opts.text.value)}};o.prototype.animate=function e(t,n,i){if(this._progressPath===null){throw new Error(s)}this._progressPath.animate(t,n,i)};o.prototype.stop=function e(){if(this._progressPath===null){throw new Error(s)}if(this._progressPath===undefined){return}this._progressPath.stop()};o.prototype.pause=function e(){if(this._progressPath===null){throw new Error(s)}if(this._progressPath===undefined){return}if(!this._progressPath._tweenable){return}this._progressPath._tweenable.pause()};o.prototype.resume=function e(){if(this._progressPath===null){throw new Error(s)}if(this._progressPath===undefined){return}if(!this._progressPath._tweenable){return}this._progressPath._tweenable.resume()};o.prototype.destroy=function e(){if(this._progressPath===null){throw new Error(s)}this.stop();this.svg.parentNode.removeChild(this.svg);this.svg=null;this.path=null;this.trail=null;this._progressPath=null;if(this.text!==null){this.text.parentNode.removeChild(this.text);this.text=null}};o.prototype.set=function e(t){if(this._progressPath===null){throw new Error(s)}this._progressPath.set(t)};o.prototype.value=function e(){if(this._progressPath===null){throw new Error(s)}if(this._progressPath===undefined){return 0}return this._progressPath.value()};o.prototype.setText=function e(t){if(this._progressPath===null){throw new Error(s)}if(this.text===null){this.text=this._createTextContainer(this._opts,this._container);this._container.appendChild(this.text)}if(r.isObject(t)){r.removeChildren(this.text);this.text.appendChild(t)}else{this.text.innerHTML=t}};o.prototype._createSvgView=function e(t){var n=document.createElementNS("http://www.w3.org/2000/svg","svg");this._initializeSvg(n,t);var i=null;if(t.trailColor||t.trailWidth){i=this._createTrail(t);n.appendChild(i)}var r=this._createPath(t);n.appendChild(r);return{svg:n,path:r,trail:i}};o.prototype._initializeSvg=function e(t,n){t.setAttribute("viewBox","0 0 100 100")};o.prototype._createPath=function e(t){var n=this._pathString(t);return this._createPathElement(n,t)};o.prototype._createTrail=function e(t){var n=this._trailString(t);var i=r.extend({},t);if(!i.trailColor){i.trailColor="#eee"}if(!i.trailWidth){i.trailWidth=i.strokeWidth}i.color=i.trailColor;i.strokeWidth=i.trailWidth;i.fill=null;return this._createPathElement(n,i)};o.prototype._createPathElement=function e(t,n){var i=document.createElementNS("http://www.w3.org/2000/svg","path");i.setAttribute("d",t);i.setAttribute("stroke",n.color);i.setAttribute("stroke-width",n.strokeWidth);if(n.fill){i.setAttribute("fill",n.fill)}else{i.setAttribute("fill-opacity","0")}return i};o.prototype._createTextContainer=function e(t,n){var i=document.createElement("div");i.className=t.text.className;var s=t.text.style;if(s){if(t.text.autoStyleContainer){n.style.position="relative"}r.setStyles(i,s);if(!s.color){i.style.color=t.color}}this._initializeTextContainer(t,n,i);return i};o.prototype._initializeTextContainer=function(e,t,n){};o.prototype._pathString=function e(t){throw new Error("Override this function for each progress bar")};o.prototype._trailString=function e(t){throw new Error("Override this function for each progress bar")};o.prototype._warnContainerAspectRatio=function e(t){if(!this.containerAspectRatio){return}var n=window.getComputedStyle(t,null);var i=parseFloat(n.getPropertyValue("width"),10);var s=parseFloat(n.getPropertyValue("height"),10);if(!r.floatEquals(this.containerAspectRatio,i/s)){console.warn("Incorrect aspect ratio of container","#"+t.id,"detected:",n.getPropertyValue("width")+"(width)","/",n.getPropertyValue("height")+"(height)","=",i/s);console.warn("Aspect ratio of should be",this.containerAspectRatio)}};t.exports=o},{"./path":5,"./utils":9}],8:[function(e,t,n){var i=e("./shape");var r=e("./utils");var s=function e(t,n){this._pathTemplate="M 0,{halfOfStrokeWidth}"+" L {width},{halfOfStrokeWidth}"+" L {width},{width}"+" L {halfOfStrokeWidth},{width}"+" L {halfOfStrokeWidth},{strokeWidth}";this._trailTemplate="M {startMargin},{halfOfStrokeWidth}"+" L {width},{halfOfStrokeWidth}"+" L {width},{width}"+" L {halfOfStrokeWidth},{width}"+" L {halfOfStrokeWidth},{halfOfStrokeWidth}";i.apply(this,arguments)};s.prototype=new i;s.prototype.constructor=s;s.prototype._pathString=function e(t){var n=100-t.strokeWidth/2;return r.render(this._pathTemplate,{width:n,strokeWidth:t.strokeWidth,halfOfStrokeWidth:t.strokeWidth/2})};s.prototype._trailString=function e(t){var n=100-t.strokeWidth/2;return r.render(this._trailTemplate,{width:n,strokeWidth:t.strokeWidth,halfOfStrokeWidth:t.strokeWidth/2,startMargin:t.strokeWidth/2-t.trailWidth/2})};t.exports=s},{"./shape":7,"./utils":9}],9:[function(e,t,n){var i="Webkit Moz O ms".split(" ");var r=.001;function s(e,t,n){e=e||{};t=t||{};n=n||false;for(var i in t){if(t.hasOwnProperty(i)){var r=e[i];var o=t[i];if(n&&h(r)&&h(o)){e[i]=s(r,o,n)}else{e[i]=o}}}return e}function o(e,t){var n=e;for(var i in t){if(t.hasOwnProperty(i)){var r=t[i];var s="\\{"+i+"\\}";var o=new RegExp(s,"g");n=n.replace(o,r)}}return n}function a(e,t,n){var r=e.style;for(var s=0;s<i.length;++s){var o=i[s];r[o+u(t)]=n}r[t]=n}function l(e,t){p(t,(function(t,n){if(t===null||t===undefined){return}if(h(t)&&t.prefix===true){a(e,n,t.value)}else{e.style[n]=t}}))}function u(e){return e.charAt(0).toUpperCase()+e.slice(1)}function c(e){return typeof e==="string"||e instanceof String}function f(e){return typeof e==="function"}function d(e){return Object.prototype.toString.call(e)==="[object Array]"}function h(e){if(d(e)){return false}var t=typeof e;return t==="object"&&!!e}function p(e,t){for(var n in e){if(e.hasOwnProperty(n)){var i=e[n];t(i,n)}}}function m(e,t){return Math.abs(e-t)<r}function g(e){while(e.firstChild){e.removeChild(e.firstChild)}}t.exports={extend:s,render:o,setStyle:a,setStyles:l,capitalize:u,isString:c,isFunction:f,isObject:h,forEachObject:p,floatEquals:m,removeChildren:g}},{}]},{},[4])(4)}));this.BX=this.BX||{};(function(e){"use strict";var t=function(){function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};babelHelpers.classCallCheck(this,e);this.container=t.container;if(this.container&&typeof t.blurElement==="undefined"){t.blurElement=this.container.firstElementChild}this.blurElement=t.blurElement;this.direction=e.direction[t.direction]?t.direction:e.direction.vertical;t.sizes=t.sizes&&babelHelpers["typeof"](t.sizes)==="object"?t.sizes:{};this.sizes={circle:t.sizes.circle?t.sizes.circle:54,progress:t.sizes.progress?t.sizes.progress:4,margin:t.sizes.margin?t.sizes.margin:0};t.labels=t.labels&&babelHelpers["typeof"](t.labels)==="object"?t.labels:{};this.labels={loading:t.labels.loading?t.labels.loading:"",completed:t.labels.completed?t.labels.completed:"",canceled:t.labels.canceled?t.labels.canceled:"",cancelTitle:t.labels.cancelTitle?t.labels.cancelTitle:"",megabyte:t.labels.megabyte?t.labels.megabyte:"MB"};this.cancelCallback=typeof t.cancelCallback==="function"?t.cancelCallback:null;this.destroyCallback=typeof t.destroyCallback==="function"?t.destroyCallback:null;this.icon=e.icon[t.icon]?t.icon:!this.cancelCallback?e.icon.cloud:e.icon.cancel;this.inited=!!this.container;this.destroing=false}babelHelpers.createClass(e,[{key:"start",value:function t(){var n=this;if(!this.inited){return false}clearTimeout(this.timeoutSetIcon);clearTimeout(this.timeout);this.active=true;this.canceled=false;this.cancelCallbackDisabled=false;this.wrapper=document.createElement("div");this.wrapper.classList.add("ui-file-progressbar-loader-wrapper");this.wrapper.innerHTML='\n\t\t\t<div class="ui-file-progressbar-loader">\n\t\t\t\t<div class="ui-file-progressbar-icon"></div>\n\t\t\t\t<div class="ui-file-progressbar-progress ui-file-progressbar-rotating"></div>\n\t\t\t</div>\n\t\t\t<div class="ui-file-progressbar-label">'.concat(this.labels.loading,"</div>\n\t\t");this.processLoader=this.wrapper.getElementsByClassName("ui-file-progressbar-loader")[0];this.processLoaderIcon=this.wrapper.getElementsByClassName("ui-file-progressbar-icon")[0];this.processStatus=this.wrapper.getElementsByClassName("ui-file-progressbar-progress")[0];this.proccesLabel=this.wrapper.getElementsByClassName("ui-file-progressbar-label")[0];if(this.direction===e.direction.horizontal){this.wrapper.classList.add("ui-file-progressbar-loader-horizontal")}this.container.classList.add("ui-file-progressbar-container-relative");this.container.insertBefore(this.wrapper,this.container.firstChild);if(this.blurElement){this.blurElement.classList.add("ui-file-progressbar-item-blurred")}var i="width: ".concat(this.sizes.circle,"px; height: ").concat(this.sizes.circle,"px;");if(this.sizes.margin){i=i+"margin: ".concat(this.sizes.margin,"px;");this.proccesLabel.style="margin: ".concat(this.sizes.margin,"px;")}this.processLoader.style=i;if(this.cancelCallback){this.processLoader.addEventListener("click",(function(e){if(n.cancelCallbackDisabled){return false}n.setProgress(0);if(n.labels.canceled){n.setProgressTitle(n.labels.canceled)}n.canceled=e;n.active=false;clearTimeout(n.timeout);n.timeout=setTimeout((function(){return n.destroy()}),1e3);return true}));if(this.labels.cancelTitle){this.processLoader.title=this.labels.cancelTitle}}if(!this.labels.loading){this.setProgressTitleVisibility(false)}this.setIcon(this.icon,true);this.bar=new BX.ProgressBarJs.Circle(this.processStatus,{easing:"linear",strokeWidth:this.sizes.progress,color:"#ffffff",from:{color:"#ffffff"},to:{color:"#ffffff"},step:function t(i,r){if(r.value()==1){clearTimeout(n.timeout);n.timeout=setTimeout((function(){if(n.labels.completed){n.setProgressTitle(n.labels.completed)}n.setIcon(e.icon.done);clearTimeout(n.timeout);n.timeout=setTimeout((function(){return n.destroy()}),1e3)}),200)}}})}},{key:"setCancelDisable",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:true;this.cancelCallbackDisabled=!!t;if(this.labels.cancelTitle){this.processLoader.title=this.cancelCallbackDisabled?"":this.labels.cancelTitle}}},{key:"setIcon",value:function t(n){var i=this;var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;this.processLoaderIcon.style.transform="scale(0)";clearTimeout(this.timeoutSetIcon);this.timeoutSetIcon=setTimeout((function(){i.processLoaderIcon.classList.remove("ui-file-progressbar-cancel","ui-file-progressbar-done","ui-file-progressbar-cloud","ui-file-progressbar-error");if(n===e.icon.done){i.processLoaderIcon.classList.add("ui-file-progressbar-done");i.processLoaderIcon.style.transform="scale(1)"}else if(n===e.icon.cancel){i.processLoaderIcon.classList.add("ui-file-progressbar-cancel");i.processLoaderIcon.style.transform="scale(1)"}else if(n===e.icon.error){i.processLoaderIcon.classList.add("ui-file-progressbar-error");i.processLoaderIcon.style.transform="scale(1)"}else{i.processLoaderIcon.classList.add("ui-file-progressbar-cloud");i.processLoaderIcon.style.transform="scale(1)"}}),r?0:200);return true}},{key:"setProgress",value:function e(t){if(!this.active||this.canceled){return false}this.bar.animate(t/100,{duration:500})}},{key:"setProgressTitle",value:function e(t){if(!this.proccesLabel){return false}this.proccesLabel.innerHTML=t}},{key:"setProgressTitleVisibility",value:function t(n){if(!this.proccesLabel){return}if(n){if(this.direction===e.direction.horizontal){this.wrapper.classList.add("ui-file-progressbar-loader-horizontal")}this.proccesLabel.style.display="block"}else{if(this.direction===e.direction.horizontal){this.wrapper.classList.remove("ui-file-progressbar-loader-horizontal")}this.proccesLabel.style.display="none"}}},{key:"setByteSent",value:function e(t,n){if(this.canceled){return false}this.setProgressTitle((t/1024/1024).toFixed(2)+" "+this.labels.megabyte+" "+" / "+(n/1024/1024).toFixed(2)+" "+this.labels.megabyte)}},{key:"destroy",value:function e(){var t=this;var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:true;clearTimeout(this.timeoutSetIcon);clearTimeout(this.timeout);if(this.destroing){return true}this.active=false;this.destroing=true;this.processLoader.style.transform="scale(0)";if(this.proccesLabel){this.proccesLabel.style.transform="scale(0)"}if(this.bar){this.bar.destroy()}if(this.blurElement){this.blurElement.classList.remove("ui-file-progressbar-item-blurred")}if(this.canceled&&!this.cancelCallbackDisabled){if(this.cancelCallback){this.cancelCallback(this.canceled)}this.canceled=false}if(n){this.timeout=setTimeout((function(){return t.destroyFinally()}),400)}else{this.destroyFinally()}}},{key:"destroyFinally",value:function e(){if(this.container){this.container.classList.remove("ui-file-progressbar-container-relative");this.container.removeChild(this.wrapper)}if(this.destroyCallback){this.destroyCallback()}}}]);return e}();t.direction={horizontal:"horizontal",vertical:"vertical"};t.icon={cloud:"cloud",cancel:"cancel",error:"error",done:"done"};e.Uploader=t})(this.BX.ProgressBarJs=this.BX.ProgressBarJs||{});(function(exports){"use strict";
/**
   * [js-md5]{@link https://github.com/emn178/js-md5}
   *
   * @namespace md5
   * @version 0.7.3
   * @author Chen, Yi-Cyuan [emn178@gmail.com]
   * @copyright Chen, Yi-Cyuan 2014-2017
   * @license MIT
   */var md5=function(){var ERROR="input is invalid type";var WINDOW=(typeof window==="undefined"?"undefined":babelHelpers.typeof(window))==="object";var root=WINDOW?window:{};if(root.JS_MD5_NO_WINDOW){WINDOW=false}var WEB_WORKER=!WINDOW&&(typeof self==="undefined"?"undefined":babelHelpers.typeof(self))==="object";var NODE_JS=!root.JS_MD5_NO_NODE_JS&&(typeof process==="undefined"?"undefined":babelHelpers.typeof(process))==="object"&&process.versions&&process.versions.node;if(NODE_JS){root=global}else if(WEB_WORKER){root=self}var COMMON_JS=!root.JS_MD5_NO_COMMON_JS&&(typeof module==="undefined"?"undefined":babelHelpers.typeof(module))==="object"&&module.exports;var AMD=typeof define==="function"&&define.amd;var ARRAY_BUFFER=!root.JS_MD5_NO_ARRAY_BUFFER&&typeof ArrayBuffer!=="undefined";var HEX_CHARS="0123456789abcdef".split("");var EXTRA=[128,32768,8388608,-2147483648];var SHIFT=[0,8,16,24];var OUTPUT_TYPES=["hex","array","digest","buffer","arrayBuffer","base64"];var BASE64_ENCODE_CHAR="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("");var blocks=[],buffer8;if(ARRAY_BUFFER){var buffer=new ArrayBuffer(68);buffer8=new Uint8Array(buffer);blocks=new Uint32Array(buffer)}if(root.JS_MD5_NO_NODE_JS||!Array.isArray){Array.isArray=function(e){return Object.prototype.toString.call(e)==="[object Array]"}}if(ARRAY_BUFFER&&(root.JS_MD5_NO_ARRAY_BUFFER_IS_VIEW||!ArrayBuffer.isView)){ArrayBuffer.isView=function(e){return babelHelpers.typeof(e)==="object"&&e.buffer&&e.buffer.constructor===ArrayBuffer}}var createOutputMethod=function e(t){return function(e){return new Md5(true).update(e)[t]()}};var createMethod=function e(){var t=createOutputMethod("hex");if(NODE_JS){t=nodeWrap(t)}t.create=function(){return new Md5};t.update=function(e){return t.create().update(e)};for(var n=0;n<OUTPUT_TYPES.length;++n){var i=OUTPUT_TYPES[n];t[i]=createOutputMethod(i)}return t};var nodeWrap=function nodeWrap(method){var crypto=eval("require('crypto')");var Buffer=eval("require('buffer').Buffer");var nodeMethod=function e(t){if(typeof t==="string"){return crypto.createHash("md5").update(t,"utf8").digest("hex")}else{if(t===null||t===undefined){throw ERROR}else if(t.constructor===ArrayBuffer){t=new Uint8Array(t)}}if(Array.isArray(t)||ArrayBuffer.isView(t)||t.constructor===Buffer){return crypto.createHash("md5").update(new Buffer(t)).digest("hex")}else{return method(t)}};return nodeMethod};function Md5(e){if(e){blocks[0]=blocks[16]=blocks[1]=blocks[2]=blocks[3]=blocks[4]=blocks[5]=blocks[6]=blocks[7]=blocks[8]=blocks[9]=blocks[10]=blocks[11]=blocks[12]=blocks[13]=blocks[14]=blocks[15]=0;this.blocks=blocks;this.buffer8=buffer8}else{if(ARRAY_BUFFER){var t=new ArrayBuffer(68);this.buffer8=new Uint8Array(t);this.blocks=new Uint32Array(t)}else{this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}}this.h0=this.h1=this.h2=this.h3=this.start=this.bytes=this.hBytes=0;this.finalized=this.hashed=false;this.first=true}Md5.prototype.update=function(e){if(this.finalized){return}var t,n=babelHelpers.typeof(e);if(n!=="string"){if(n==="object"){if(e===null){throw ERROR}else if(ARRAY_BUFFER&&e.constructor===ArrayBuffer){e=new Uint8Array(e)}else if(!Array.isArray(e)){if(!ARRAY_BUFFER||!ArrayBuffer.isView(e)){throw ERROR}}}else{throw ERROR}t=true}var i,r=0,s,o=e.length,a=this.blocks;var l=this.buffer8;while(r<o){if(this.hashed){this.hashed=false;a[0]=a[16];a[16]=a[1]=a[2]=a[3]=a[4]=a[5]=a[6]=a[7]=a[8]=a[9]=a[10]=a[11]=a[12]=a[13]=a[14]=a[15]=0}if(t){if(ARRAY_BUFFER){for(s=this.start;r<o&&s<64;++r){l[s++]=e[r]}}else{for(s=this.start;r<o&&s<64;++r){a[s>>2]|=e[r]<<SHIFT[s++&3]}}}else{if(ARRAY_BUFFER){for(s=this.start;r<o&&s<64;++r){i=e.charCodeAt(r);if(i<128){l[s++]=i}else if(i<2048){l[s++]=192|i>>6;l[s++]=128|i&63}else if(i<55296||i>=57344){l[s++]=224|i>>12;l[s++]=128|i>>6&63;l[s++]=128|i&63}else{i=65536+((i&1023)<<10|e.charCodeAt(++r)&1023);l[s++]=240|i>>18;l[s++]=128|i>>12&63;l[s++]=128|i>>6&63;l[s++]=128|i&63}}}else{for(s=this.start;r<o&&s<64;++r){i=e.charCodeAt(r);if(i<128){a[s>>2]|=i<<SHIFT[s++&3]}else if(i<2048){a[s>>2]|=(192|i>>6)<<SHIFT[s++&3];a[s>>2]|=(128|i&63)<<SHIFT[s++&3]}else if(i<55296||i>=57344){a[s>>2]|=(224|i>>12)<<SHIFT[s++&3];a[s>>2]|=(128|i>>6&63)<<SHIFT[s++&3];a[s>>2]|=(128|i&63)<<SHIFT[s++&3]}else{i=65536+((i&1023)<<10|e.charCodeAt(++r)&1023);a[s>>2]|=(240|i>>18)<<SHIFT[s++&3];a[s>>2]|=(128|i>>12&63)<<SHIFT[s++&3];a[s>>2]|=(128|i>>6&63)<<SHIFT[s++&3];a[s>>2]|=(128|i&63)<<SHIFT[s++&3]}}}}this.lastByteIndex=s;this.bytes+=s-this.start;if(s>=64){this.start=s-64;this.hash();this.hashed=true}else{this.start=s}}if(this.bytes>4294967295){this.hBytes+=this.bytes/4294967296<<0;this.bytes=this.bytes%4294967296}return this};Md5.prototype.finalize=function(){if(this.finalized){return}this.finalized=true;var e=this.blocks,t=this.lastByteIndex;e[t>>2]|=EXTRA[t&3];if(t>=56){if(!this.hashed){this.hash()}e[0]=e[16];e[16]=e[1]=e[2]=e[3]=e[4]=e[5]=e[6]=e[7]=e[8]=e[9]=e[10]=e[11]=e[12]=e[13]=e[14]=e[15]=0}e[14]=this.bytes<<3;e[15]=this.hBytes<<3|this.bytes>>>29;this.hash()};Md5.prototype.hash=function(){var e,t,n,i,r,s,o=this.blocks;if(this.first){e=o[0]-680876937;e=(e<<7|e>>>25)-271733879<<0;i=(-1732584194^e&2004318071)+o[1]-117830708;i=(i<<12|i>>>20)+e<<0;n=(-271733879^i&(e^-271733879))+o[2]-1126478375;n=(n<<17|n>>>15)+i<<0;t=(e^n&(i^e))+o[3]-1316259209;t=(t<<22|t>>>10)+n<<0}else{e=this.h0;t=this.h1;n=this.h2;i=this.h3;e+=(i^t&(n^i))+o[0]-680876936;e=(e<<7|e>>>25)+t<<0;i+=(n^e&(t^n))+o[1]-389564586;i=(i<<12|i>>>20)+e<<0;n+=(t^i&(e^t))+o[2]+606105819;n=(n<<17|n>>>15)+i<<0;t+=(e^n&(i^e))+o[3]-1044525330;t=(t<<22|t>>>10)+n<<0}e+=(i^t&(n^i))+o[4]-176418897;e=(e<<7|e>>>25)+t<<0;i+=(n^e&(t^n))+o[5]+1200080426;i=(i<<12|i>>>20)+e<<0;n+=(t^i&(e^t))+o[6]-1473231341;n=(n<<17|n>>>15)+i<<0;t+=(e^n&(i^e))+o[7]-45705983;t=(t<<22|t>>>10)+n<<0;e+=(i^t&(n^i))+o[8]+1770035416;e=(e<<7|e>>>25)+t<<0;i+=(n^e&(t^n))+o[9]-1958414417;i=(i<<12|i>>>20)+e<<0;n+=(t^i&(e^t))+o[10]-42063;n=(n<<17|n>>>15)+i<<0;t+=(e^n&(i^e))+o[11]-1990404162;t=(t<<22|t>>>10)+n<<0;e+=(i^t&(n^i))+o[12]+1804603682;e=(e<<7|e>>>25)+t<<0;i+=(n^e&(t^n))+o[13]-40341101;i=(i<<12|i>>>20)+e<<0;n+=(t^i&(e^t))+o[14]-1502002290;n=(n<<17|n>>>15)+i<<0;t+=(e^n&(i^e))+o[15]+1236535329;t=(t<<22|t>>>10)+n<<0;e+=(n^i&(t^n))+o[1]-165796510;e=(e<<5|e>>>27)+t<<0;i+=(t^n&(e^t))+o[6]-1069501632;i=(i<<9|i>>>23)+e<<0;n+=(e^t&(i^e))+o[11]+643717713;n=(n<<14|n>>>18)+i<<0;t+=(i^e&(n^i))+o[0]-373897302;t=(t<<20|t>>>12)+n<<0;e+=(n^i&(t^n))+o[5]-701558691;e=(e<<5|e>>>27)+t<<0;i+=(t^n&(e^t))+o[10]+38016083;i=(i<<9|i>>>23)+e<<0;n+=(e^t&(i^e))+o[15]-660478335;n=(n<<14|n>>>18)+i<<0;t+=(i^e&(n^i))+o[4]-405537848;t=(t<<20|t>>>12)+n<<0;e+=(n^i&(t^n))+o[9]+568446438;e=(e<<5|e>>>27)+t<<0;i+=(t^n&(e^t))+o[14]-1019803690;i=(i<<9|i>>>23)+e<<0;n+=(e^t&(i^e))+o[3]-187363961;n=(n<<14|n>>>18)+i<<0;t+=(i^e&(n^i))+o[8]+1163531501;t=(t<<20|t>>>12)+n<<0;e+=(n^i&(t^n))+o[13]-1444681467;e=(e<<5|e>>>27)+t<<0;i+=(t^n&(e^t))+o[2]-51403784;i=(i<<9|i>>>23)+e<<0;n+=(e^t&(i^e))+o[7]+1735328473;n=(n<<14|n>>>18)+i<<0;t+=(i^e&(n^i))+o[12]-1926607734;t=(t<<20|t>>>12)+n<<0;r=t^n;e+=(r^i)+o[5]-378558;e=(e<<4|e>>>28)+t<<0;i+=(r^e)+o[8]-2022574463;i=(i<<11|i>>>21)+e<<0;s=i^e;n+=(s^t)+o[11]+1839030562;n=(n<<16|n>>>16)+i<<0;t+=(s^n)+o[14]-35309556;t=(t<<23|t>>>9)+n<<0;r=t^n;e+=(r^i)+o[1]-1530992060;e=(e<<4|e>>>28)+t<<0;i+=(r^e)+o[4]+1272893353;i=(i<<11|i>>>21)+e<<0;s=i^e;n+=(s^t)+o[7]-155497632;n=(n<<16|n>>>16)+i<<0;t+=(s^n)+o[10]-1094730640;t=(t<<23|t>>>9)+n<<0;r=t^n;e+=(r^i)+o[13]+681279174;e=(e<<4|e>>>28)+t<<0;i+=(r^e)+o[0]-358537222;i=(i<<11|i>>>21)+e<<0;s=i^e;n+=(s^t)+o[3]-722521979;n=(n<<16|n>>>16)+i<<0;t+=(s^n)+o[6]+76029189;t=(t<<23|t>>>9)+n<<0;r=t^n;e+=(r^i)+o[9]-640364487;e=(e<<4|e>>>28)+t<<0;i+=(r^e)+o[12]-421815835;i=(i<<11|i>>>21)+e<<0;s=i^e;n+=(s^t)+o[15]+530742520;n=(n<<16|n>>>16)+i<<0;t+=(s^n)+o[2]-995338651;t=(t<<23|t>>>9)+n<<0;e+=(n^(t|~i))+o[0]-198630844;e=(e<<6|e>>>26)+t<<0;i+=(t^(e|~n))+o[7]+1126891415;i=(i<<10|i>>>22)+e<<0;n+=(e^(i|~t))+o[14]-1416354905;n=(n<<15|n>>>17)+i<<0;t+=(i^(n|~e))+o[5]-57434055;t=(t<<21|t>>>11)+n<<0;e+=(n^(t|~i))+o[12]+1700485571;e=(e<<6|e>>>26)+t<<0;i+=(t^(e|~n))+o[3]-1894986606;i=(i<<10|i>>>22)+e<<0;n+=(e^(i|~t))+o[10]-1051523;n=(n<<15|n>>>17)+i<<0;t+=(i^(n|~e))+o[1]-2054922799;t=(t<<21|t>>>11)+n<<0;e+=(n^(t|~i))+o[8]+1873313359;e=(e<<6|e>>>26)+t<<0;i+=(t^(e|~n))+o[15]-30611744;i=(i<<10|i>>>22)+e<<0;n+=(e^(i|~t))+o[6]-1560198380;n=(n<<15|n>>>17)+i<<0;t+=(i^(n|~e))+o[13]+1309151649;t=(t<<21|t>>>11)+n<<0;e+=(n^(t|~i))+o[4]-145523070;e=(e<<6|e>>>26)+t<<0;i+=(t^(e|~n))+o[11]-1120210379;i=(i<<10|i>>>22)+e<<0;n+=(e^(i|~t))+o[2]+718787259;n=(n<<15|n>>>17)+i<<0;t+=(i^(n|~e))+o[9]-343485551;t=(t<<21|t>>>11)+n<<0;if(this.first){this.h0=e+1732584193<<0;this.h1=t-271733879<<0;this.h2=n-1732584194<<0;this.h3=i+271733878<<0;this.first=false}else{this.h0=this.h0+e<<0;this.h1=this.h1+t<<0;this.h2=this.h2+n<<0;this.h3=this.h3+i<<0}};Md5.prototype.hex=function(){this.finalize();var e=this.h0,t=this.h1,n=this.h2,i=this.h3;return HEX_CHARS[e>>4&15]+HEX_CHARS[e&15]+HEX_CHARS[e>>12&15]+HEX_CHARS[e>>8&15]+HEX_CHARS[e>>20&15]+HEX_CHARS[e>>16&15]+HEX_CHARS[e>>28&15]+HEX_CHARS[e>>24&15]+HEX_CHARS[t>>4&15]+HEX_CHARS[t&15]+HEX_CHARS[t>>12&15]+HEX_CHARS[t>>8&15]+HEX_CHARS[t>>20&15]+HEX_CHARS[t>>16&15]+HEX_CHARS[t>>28&15]+HEX_CHARS[t>>24&15]+HEX_CHARS[n>>4&15]+HEX_CHARS[n&15]+HEX_CHARS[n>>12&15]+HEX_CHARS[n>>8&15]+HEX_CHARS[n>>20&15]+HEX_CHARS[n>>16&15]+HEX_CHARS[n>>28&15]+HEX_CHARS[n>>24&15]+HEX_CHARS[i>>4&15]+HEX_CHARS[i&15]+HEX_CHARS[i>>12&15]+HEX_CHARS[i>>8&15]+HEX_CHARS[i>>20&15]+HEX_CHARS[i>>16&15]+HEX_CHARS[i>>28&15]+HEX_CHARS[i>>24&15]};Md5.prototype.toString=Md5.prototype.hex;Md5.prototype.digest=function(){this.finalize();var e=this.h0,t=this.h1,n=this.h2,i=this.h3;return[e&255,e>>8&255,e>>16&255,e>>24&255,t&255,t>>8&255,t>>16&255,t>>24&255,n&255,n>>8&255,n>>16&255,n>>24&255,i&255,i>>8&255,i>>16&255,i>>24&255]};Md5.prototype.array=Md5.prototype.digest;Md5.prototype.arrayBuffer=function(){this.finalize();var e=new ArrayBuffer(16);var t=new Uint32Array(e);t[0]=this.h0;t[1]=this.h1;t[2]=this.h2;t[3]=this.h3;return e};Md5.prototype.buffer=Md5.prototype.arrayBuffer;Md5.prototype.base64=function(){var e,t,n,i="",r=this.array();for(var s=0;s<15;){e=r[s++];t=r[s++];n=r[s++];i+=BASE64_ENCODE_CHAR[e>>>2]+BASE64_ENCODE_CHAR[(e<<4|t>>>4)&63]+BASE64_ENCODE_CHAR[(t<<2|n>>>6)&63]+BASE64_ENCODE_CHAR[n&63]}e=r[s];i+=BASE64_ENCODE_CHAR[e>>>2]+BASE64_ENCODE_CHAR[e<<4&63]+"==";return i};return createMethod()}();exports.md5=md5})(this.BX=this.BX||{});(function(){if(typeof this.BX!=="undefined"&&typeof this.BX.WidgetVuex!=="undefined"){var e="3.6.2";if(this.BX.WidgetVuex.version!==e){console.warn("BX.WidgetVuex already loaded. Loaded: "+this.BX.WidgetVuex.version+", Skipped: "+e+". Version differences may cause errors!")}return}(function(e,t,n,i){"use strict";var r=function(){function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};babelHelpers.classCallCheck(this,e);this.siteId=t.siteId||"default";this.userId=t.userId||0;this.storage=t.storage||"default";this.name=t.name||"";this.code=(window.md5||i.md5)(this.siteId+"/"+this.userId+"/"+this.storage+"/"+this.name);this.db=new n.Dexie("bx-vuex-model");this.db.version(1).stores({data:"code, value"})}babelHelpers.createClass(e,[{key:"get",value:function e(){var t=this;return new Promise((function(e,n){t.db.data.where("code").equals(t.code).first().then((function(t){e(t?t.value:null)}),(function(e){n(e)}))}))}},{key:"set",value:function e(t){var n=this;return new Promise((function(e,i){n.db.data.put({code:n.code,value:t}).then((function(t){e(true)}),(function(e){i(e)}))}))}},{key:"clear",value:function e(){var t=this;return new Promise((function(e,n){t.db.data["delete"](t.code).then((function(t){e(true)}),(function(e){n(e)}))}))}}]);return e}();var s=function(){function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};babelHelpers.classCallCheck(this,e);this.siteId=t.siteId||"default";this.userId=t.userId||0;this.storage=t.storage||"default";this.name=t.name||"";this.enabled=false;if(typeof window.localStorage!=="undefined"){try{window.localStorage.setItem("__bx_test_ls_feature__","ok");if(window.localStorage.getItem("__bx_test_ls_feature__")==="ok"){window.localStorage.removeItem("__bx_test_ls_feature__");this.enabled=true}}catch(e){}}this.code="bx-vuex-"+(window.md5||i.md5)(this.siteId+"/"+this.userId+"/"+this.storage+"/"+this.name)}babelHelpers.createClass(e,[{key:"get",value:function e(){var t=this;return new Promise((function(e,n){if(!t.enabled){e(null);return true}var i=window.localStorage.getItem(t.code);if(typeof i!=="string"){e(null);return true}try{e(t.prepareValueAfterGet(JSON.parse(i)))}catch(e){n(e)}}))}},{key:"set",value:function e(t){var n=this;return new Promise((function(e,i){if(n.enabled){window.localStorage.setItem(n.code,JSON.stringify(n.prepareValueBeforeSet(t)))}e(true)}))}},{key:"clear",value:function e(){var t=this;return new Promise((function(e,n){if(t.enabled){window.localStorage.removeItem(t.code)}e(true)}))}},{key:"prepareValueAfterGet",value:function e(t){var n=this;if(t instanceof Array){t=t.map((function(e){return n.prepareValueAfterGet(e)}))}else if(t instanceof Date);else if(t&&babelHelpers["typeof"](t)==="object"){for(var i in t){if(t.hasOwnProperty(i)){t[i]=this.prepareValueAfterGet(t[i])}}}else if(typeof t==="string"){if(t.startsWith("#DT#")){t=new Date(t.substring(4))}}return t}},{key:"prepareValueBeforeSet",value:function e(t){var n=this;if(t instanceof Array){t=t.map((function(e){return n.prepareValueBeforeSet(e)}))}else if(t instanceof Date){t="#DT#"+t.toISOString()}else if(t&&babelHelpers["typeof"](t)==="object"){for(var i in t){if(t.hasOwnProperty(i)){t[i]=this.prepareValueBeforeSet(t[i])}}}return t}}]);return e}();var o=function(){function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};babelHelpers.classCallCheck(this,e);this.siteId=t.siteId||"default";this.userId=t.userId||0;this.storage=t.storage||"default";this.name=t.name||"";this.code=(window.md5||i.md5)(this.siteId+"/"+this.userId+"/"+this.storage+"/"+this.name);if(!this.isJnContext()&&typeof ApplicationStorage==="undefined"){console.error('ApplicationStorage is not defined, load "webcomponent/storage" extension.')}}babelHelpers.createClass(e,[{key:"get",value:function e(){var t=this;return new Promise((function(e,n){if(t.isJnContext()){var i=Application.sharedStorage.get(t.code);e(i?i:null)}else if(typeof ApplicationStorage!=="undefined"){ApplicationStorage.get(t.code,null).then((function(n){return e(t.prepareValueAfterGet(JSON.parse(n)))}))}else{e(null)}}))}},{key:"set",value:function e(t){var n=this;return new Promise((function(e,i){if(n.isJnContext()){Application.sharedStorage().set(n.code,JSON.stringify(n.prepareValueBeforeSet(t)));e()}else if(typeof ApplicationStorage!=="undefined"){ApplicationStorage.set(n.code,JSON.stringify(n.prepareValueBeforeSet(t))).then((function(t){return e()}))}else{e()}}))}},{key:"clear",value:function e(){return this.set(null)}},{key:"isJnContext",value:function e(){return typeof env!=="undefined"}},{key:"prepareValueAfterGet",value:function e(t){var n=this;if(t instanceof Array){t=t.map((function(e){return n.prepareValueAfterGet(e)}))}else if(t instanceof Date);else if(t&&babelHelpers["typeof"](t)==="object"){for(var i in t){if(t.hasOwnProperty(i)){t[i]=this.prepareValueAfterGet(t[i])}}}else if(typeof t==="string"){if(t.startsWith("#DT#")){t=new Date(t.substring(4))}}return t}},{key:"prepareValueBeforeSet",value:function e(t){var n=this;if(t instanceof Array){t=t.map((function(e){return n.prepareValueBeforeSet(e)}))}else if(t instanceof Date){t="#DT#"+t.toISOString()}else if(t&&babelHelpers["typeof"](t)==="object"){for(var i in t){if(t.hasOwnProperty(i)){t[i]=this.prepareValueBeforeSet(t[i])}}}return t}}]);return e}();var a=function(){babelHelpers.createClass(e,[{key:"getName",value:function e(){return""}},{key:"getState",value:function e(){return{}}},{key:"getElementState",value:function e(){return{}}},{key:"getStateSaveException",value:function e(){return undefined}},{key:"getGetters",value:function e(){return{}}},{key:"getActions",value:function e(){return{}}},{key:"getMutations",value:function e(){return{}}},{key:"validate",value:function e(t){return{}}},{key:"setVariables",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};if(!(babelHelpers["typeof"](t)==="object"&&t)){this.logger("error","VuexBuilderModel.setVars: passed variables is not a Object",store);return this}this.variables=t;return this}},{key:"getVariable",value:function e(t){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:undefined;if(!t){return n}var i=t.toString().split(".");if(i.length===1){return this.variables[i[0]]}var r;var s=Object.assign({},this.variables);for(var o=0;o<i.length;o++){if(typeof s[i[o]]!=="undefined"){s=r=s[i[o]]}else{r=n;break}}return r}},{key:"getNamespace",value:function e(){return this.namespace?this.namespace:this.getName()}},{key:"setNamespace",value:function e(t){this.namespace=t.toString();this.databaseConfig.name=this.namespace;return this}},{key:"useDatabase",value:function e(t){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};this.databaseConfig.active=!!t;var i=this.db===null;if(n.type){this.databaseConfig.type=n.type.toString();i=true}if(n.storage){this.databaseConfig.storage=n.storage.toString()}if(n.siteId){this.databaseConfig.siteId=n.siteId.toString()}if(n.userId){this.databaseConfig.userId=n.userId}if(typeof n.timeout==="number"){this.databaseConfig.timeout=n.timeout}if(!this.databaseConfig.active&&this.db!==null){this.databaseConfig.type=null;i=true}if(i){if(this.databaseConfig.type===u.DatabaseType.indexedDb){this.db=new r(this.databaseConfig)}else if(this.databaseConfig.type===u.DatabaseType.localStorage){this.db=new s(this.databaseConfig)}else if(this.databaseConfig.type===u.DatabaseType.jnSharedStorage){this.db=new o(this.databaseConfig)}else{this.db=null}}return this}},{key:"useNamespace",value:function e(n){if(t.WidgetBitrixVue.developerMode){if(n){console.warn("VuexBuilderModel: Method `useNamespace` is deprecated, please remove this call.")}else{console.error("VuexBuilderModel: Method `useNamespace` is deprecated, using VuexBuilder without namespaces is no longer supported.")}}return this}},{key:"getStore",value:function e(){return this.getModule()}},{key:"getModule",value:function e(){var t=this;return new Promise((function(e,n){var i=t.namespace?t.namespace:t.getName();if(!i){t.logger("error","VuexBuilderModel.getStore: current model can not be run in Vuex modules mode",t.getState());n()}if(t.db){t._getStoreFromDatabase().then((function(n){return e({namespace:i,module:t._createStore(n)})}))}else{e({namespace:i,module:t._createStore(t.getState())})}}))}},{key:"getModuleWithDefaultState",value:function e(){var t=this.namespace?this.namespace:this.getName();if(!t){this.logger("error","VuexBuilderModel.getStore: current model can not be run in Vuex modules mode",this.getState());return null}return{namespace:t,module:this._createStore(this.getState())}}},{key:"getSaveTimeout",value:function e(){return 150}},{key:"getLoadTimeout",value:function e(){return 1e3}},{key:"getLoadedState",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};return t}},{key:"saveState",value:function e(){var t=this;var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};if(!this.isSaveAvailable()){return true}this.lastSaveState=n;if(this.saveStateTimeout){this.logger("log","VuexModel.saveState: wait save...",this.getName());return true}this.logger("log","VuexModel.saveState: start saving",this.getName());var i=this.getSaveTimeout();if(typeof this.databaseConfig.timeout==="number"){i=this.databaseConfig.timeout}this.saveStateTimeout=setTimeout((function(){t.logger("log","VuexModel.saveState: saved!",t.getName());var e=t.lastSaveState;if(typeof e==="function"){e=e();if(babelHelpers["typeof"](e)!=="object"||!e){return false}}t.db.set(t.cloneState(e,t.getStateSaveException()));t.lastState=null;t.saveStateTimeout=null}),i);return true}},{key:"clearState",value:function e(){if(this.store){this.store.commit(this.getNamespace()+"/"+"vuexBuilderModelClearState");return true}return this.saveState(this.getState())}},{key:"clearDatabase",value:function e(){if(!this.isSaveAvailable()){return true}this.db.clear();return true}},{key:"isSaveAvailable",value:function e(){return this.db&&this.databaseConfig.active}},{key:"isSaveNeeded",value:function e(t){if(!this.isSaveAvailable()){return false}var n=function e(t){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;if(!n){return true}for(var i in t){if(!t.hasOwnProperty(i)){continue}if(typeof n[i]==="undefined"){return true}else if(babelHelpers["typeof"](n[i])==="object"&&n[i]){var r=e(t[i],n[i]);if(r){return true}}}return false};return n(t,this.getStateSaveException())}}],[{key:"create",value:function e(){return new this}}]);function e(){babelHelpers.classCallCheck(this,e);this.databaseConfig={type:u.DatabaseType.indexedDb,active:null,storage:"default",name:this.getName(),siteId:"default",userId:0,timeout:null};this.db=null;this.store=null;this.namespace=null;this.variables={}}babelHelpers.createClass(e,[{key:"setStore",value:function e(t){if(!(t instanceof re.Store)){this.logger("error","VuexBuilderModel.setStore: passed store is not a Vuex.Store",t);return this}this.store=t;return this}},{key:"_getStoreFromDatabase",value:function e(){var t=this;clearTimeout(this.cacheTimeout);return new Promise((function(e){var n=t.getLoadTimeout();if(n!==false&&typeof n==="number"){t.cacheTimeout=setTimeout((function(){t.logger("warn","VuexModel.getStoreFromDatabase: Cache loading timeout",t.getName());e(t.getState())}),n)}else{t.cacheTimeout=null}t.db.get().then((function(n){clearTimeout(t.cacheTimeout);n=t.getLoadedState(n?n:{});var i=t.getState();if(n){i=t._mergeState(i,n)}e(i)}),(function(n){clearTimeout(t.cacheTimeout);e(t.getState())}))}))}},{key:"_mergeState",value:function e(t,n){for(var i in t){if(!t.hasOwnProperty(i)){continue}if(typeof n[i]==="undefined"){n[i]=t[i]}else if(!(n[i]instanceof Array)&&babelHelpers["typeof"](n[i])==="object"&&n[i]&&babelHelpers["typeof"](t[i])==="object"&&t[i]){n[i]=Object.assign({},t[i],n[i])}}return n}},{key:"_createStore",value:function e(t){var n=this;var i={namespaced:true,state:t,getters:this.getGetters(),actions:this.getActions(),mutations:this.getMutations()};i.mutations.vuexBuilderModelClearState=function(e){e=Object.assign(e,n.getState());n.saveState(e)};return i}},{key:"cloneState",value:function e(t){var n=this;var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:undefined;var r;if(t instanceof Array){r=[].concat(t.map((function(e){return n.cloneState(e)})))}else if(t instanceof Date){r=new Date(t.toISOString())}else if(babelHelpers["typeof"](t)==="object"&&t){r={};for(var s in t){if(!t.hasOwnProperty(s)){continue}if(typeof i==="undefined"||typeof i[s]==="undefined"){r[s]=this.cloneState(t[s])}else if(babelHelpers["typeof"](i[s])==="object"&&i[s]){r[s]=this.cloneState(t[s],i[s])}}}else{r=t}return r}},{key:"logger",value:function e(t){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++){i[r-1]=arguments[r]}if(t==="error"){var s;(s=console).error.apply(s,i);return undefined}else if(typeof BX.WidgetVueDevTools==="undefined"){return undefined}if(t==="log"){var o;(o=console).log.apply(o,i)}else if(t==="info"){var a;(a=console).info.apply(a,i)}else if(t==="warn"){var l;(l=console).warn.apply(l,i)}}}],[{key:"convertToArray",value:function e(t){var n=[];for(var i in t){if(t.hasOwnProperty(i)){n.push(t[i])}}return n}}]);return e}();var l=Object.freeze({indexedDb:"indexedDb",localStorage:"localStorage",jnSharedStorage:"jnSharedStorage"});var u=function(){babelHelpers.createClass(e,null,[{key:"create",value:function e(){if(t.WidgetBitrixVue.developerMode){console.warn("VuexBuilder: Method VuexBuilder.create is deprecated, use VuexBuilder.init instead.")}return new this}},{key:"init",value:function e(t){if(t){if(!(t instanceof re.Store)){console.warn("VuexBuilder.init: passed store is not a Vuex.Store",t);return new this}}return new this(t)}}]);function e(t){babelHelpers.classCallCheck(this,e);this.models=[];this.databaseConfig={name:null,type:null,siteId:null,userId:null,timeout:null};this.store=t;this.builded=false}babelHelpers.createClass(e,[{key:"addModel",value:function e(t){if(this.builded){return this}if(!(t instanceof a)){console.error("BX.WidgetVuexBuilder.addModel: passed model is not a BX.WidgetVuexBuilderModel",t,name);return this}this.models.push(t);return this}},{key:"addDynamicModel",value:function e(t){var n=this;if(!(t instanceof a)){return new Promise((function(e,n){console.error("BX.WidgetVuexBuilder.addDynamicModel: passed model is not a BX.WidgetVuexBuilderModel",t);n("MODEL_ERROR")}))}if(this.store.hasModule(t.getNamespace())||this.models.find((function(e){return e.getNamespace()===t.getNamespace()}))){return new Promise((function(e,n){console.error("BX.WidgetVuexBuilder.addDynamicModel: model `"+t.getNamespace()+"` was not added because it is already registered.");n("DUPLICATE_MODEL")}))}this.models.push(t);if(this.databaseConfig.active&&t.databaseConfig.active!==false){t.useDatabase(true,this.databaseConfig)}else{t.useDatabase(false)}t.setStore(this.store);var i=t.getModule();return new Promise((function(e,t){i.then((function(t){n.store.registerModule(t.namespace,t.module);e()}),(function(e){console.error("BX.WidgetVuexBuilder.addDynamicModel: storage was not created due to runtime errors.",e?e:"");t("ERROR_IN_MODEL")}))}))}},{key:"removeDynamicModel",value:function e(t){if(!this.builded){console.error("BX.WidgetVuexBuilder.removeDynamicModel: you cannot use the method until builder is built.");return this}if(!this.store.hasModule(t)){console.error("BX.WidgetVuexBuilder.removeDynamicModel: module `"+t+"` not registered.");return this}this.models=this.models.filter((function(e){return e.getNamespace()!==t}));this.store.unregisterModule(t);return this}},{key:"useNamespace",value:function e(n){if(t.WidgetBitrixVue.developerMode){if(n){console.warn("VuexBuilder: Method `useNamespace` is deprecated, please remove this call.")}else{console.error("VuexBuilder: Method `useNamespace` is deprecated, using VuexBuilder without namespaces is no longer supported.")}}return this}},{key:"setDatabaseConfig",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};if(!(babelHelpers["typeof"](t)==="object"&&t)){return this}this.databaseConfig.active=true;this.databaseConfig.storage=t.name;this.databaseConfig.type=t.type||this.databaseConfig.type;this.databaseConfig.siteId=t.siteId||this.databaseConfig.siteId;this.databaseConfig.userId=t.userId||this.databaseConfig.userId;this.databaseConfig.timeout=typeof t.timeout!=="undefined"?t.timeout:this.databaseConfig.timeout;return this}},{key:"clearModelState",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;if(!this.builded){return new Promise((function(e,n){console.error("BX.WidgetVuexBuilder.clearModelState: you cannot use the method until builder is built.");if(typeof t!=="function"){n("BUILDER_NOT_BUILD")}}))}var n=[];this.models.forEach((function(e){n.push(e.clearState())}));return new Promise((function(e,i){Promise.all(n).then((function(n){e(true);if(typeof t==="function"){t(true)}}),(function(e){console.error("BX.WidgetVuexBuilder.clearModelState: storage was not clear due to runtime errors.",e?e:"");if(typeof t!=="function"){i("ERROR_WHILE_CLEARING")}}))}))}},{key:"clearDatabase",value:function e(){if(!this.builded){return new Promise((function(e,t){console.error("BX.WidgetVuexBuilder.clearModelState: you cannot use the method until builder is built.");t("BUILDER_NOT_BUILD")}))}this.models.forEach((function(e){return e.clearDatabase()}));return new Promise((function(e,t){return e(true)}))}},{key:"build",value:function e(){var t=this;var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;if(this.builded){return this}var i=[];if(!this.store){this.store=re.createStore()}this.models.forEach((function(e){if(t.databaseConfig.active&&e.databaseConfig.active!==false){e.useDatabase(true,t.databaseConfig)}e.setStore(t.store);i.push(e.getModule())}));return new Promise((function(e,r){Promise.all(i).then((function(i){i.forEach((function(e){t.store.registerModule(e.namespace,e.module)}));var r={store:t.store,models:t.models,builder:t};t.builded=true;if(typeof n==="function"){n(r)}e(r)}),(function(e){console.error("BX.WidgetVuexBuilder.create: storage was not created due to runtime errors.",e?e:"");if(typeof n!=="function"){r("ERROR_IN_MODEL")}}))}))}},{key:"syncBuild",value:function e(){var n=this;if(this.builded){return{store:this.store,models:this.models,builder:this}}if(!this.store){this.store=re.createStore()}if(this.databaseConfig.active){if(t.WidgetBitrixVue.developerMode){console.error("VuexBuilder: Method `syncBuild` creates storage in synchronous mode, the database does not work in this mode.")}this.databaseConfig.active=false}this.models.forEach((function(e){e.useDatabase(false);e.setStore(n.store);var t=e.getModuleWithDefaultState(),i=t.namespace,r=t.module;n.store.registerModule(i,r)}));this.builded=true;return{store:this.store,models:this.models,builder:this}}}]);return e}();u.DatabaseType=l;
/*!
	 * vuex v3.6.2
	 * (c) 2021 Evan You
	 * @license MIT
	 *
	 * @source: https://cdn.jsdelivr.net/npm/vuex@3.6.2/dist/vuex.esm.browser.js
	 */function c(e){var t=Number(e.version.split(".")[0]);if(t>=2){e.mixin({beforeCreate:i})}else{var n=e.prototype._init;e.prototype._init=function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};e.init=e.init?[i].concat(e.init):i;n.call(this,e)}}function i(){var e=this.$options;if(e.store){this.$store=typeof e.store==="function"?e.store():e.store}else if(e.parent&&e.parent.$store){this.$store=e.parent.$store}}}var f=typeof window!=="undefined"?window:typeof global!=="undefined"?global:{};var d=f.__VUE_DEVTOOLS_GLOBAL_HOOK__;function h(e){if(!d)return;e._devtoolHook=d;d.emit("vuex:init",e);d.on("vuex:travel-to-state",(function(t){e.replaceState(t)}));e.subscribe((function(e,t){d.emit("vuex:mutation",e,t)}),{prepend:true});e.subscribeAction((function(e,t){d.emit("vuex:action",e,t)}),{prepend:true})}function p(e,t){return e.filter(t)[0]}function m(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];if(e===null||babelHelpers["typeof"](e)!=="object"){return e}var n=p(t,(function(t){return t.original===e}));if(n){return n.copy}var i=Array.isArray(e)?[]:{};t.push({original:e,copy:i});Object.keys(e).forEach((function(n){i[n]=m(e[n],t)}));return i}function g(e,t){Object.keys(e).forEach((function(n){return t(e[n],n)}))}function v(e){return e!==null&&babelHelpers["typeof"](e)==="object"}function y(e){return e&&typeof e.then==="function"}function b(e,t){if(!e)throw new Error("[vuex] ".concat(t))}function w(e,t){return function(){return e(t)}}var S=function(){function e(t,n){babelHelpers.classCallCheck(this,e);this.runtime=n;this._children=Object.create(null);this._rawModule=t;var i=t.state;this.state=(typeof i==="function"?i():i)||{}}babelHelpers.createClass(e,[{key:"addChild",value:function e(t,n){this._children[t]=n}},{key:"removeChild",value:function e(t){delete this._children[t]}},{key:"getChild",value:function e(t){return this._children[t]}},{key:"hasChild",value:function e(t){return t in this._children}},{key:"update",value:function e(t){this._rawModule.namespaced=t.namespaced;if(t.actions){this._rawModule.actions=t.actions}if(t.mutations){this._rawModule.mutations=t.mutations}if(t.getters){this._rawModule.getters=t.getters}}},{key:"forEachChild",value:function e(t){g(this._children,t)}},{key:"forEachGetter",value:function e(t){if(this._rawModule.getters){g(this._rawModule.getters,t)}}},{key:"forEachAction",value:function e(t){if(this._rawModule.actions){g(this._rawModule.actions,t)}}},{key:"forEachMutation",value:function e(t){if(this._rawModule.mutations){g(this._rawModule.mutations,t)}}},{key:"namespaced",get:function e(){return!!this._rawModule.namespaced}}]);return e}();var I=function(){function e(t){babelHelpers.classCallCheck(this,e);this.register([],t,false)}babelHelpers.createClass(e,[{key:"get",value:function e(t){return t.reduce((function(e,t){return e.getChild(t)}),this.root)}},{key:"getNamespace",value:function e(t){var n=this.root;return t.reduce((function(e,t){n=n.getChild(t);return e+(n.namespaced?t+"/":"")}),"")}},{key:"update",value:function e(t){k([],this.root,t)}},{key:"register",value:function e(t,n){var i=this;var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:true;{x(t,n)}var s=new S(n,r);if(t.length===0){this.root=s}else{var o=this.get(t.slice(0,-1));o.addChild(t[t.length-1],s)}if(n.modules){g(n.modules,(function(e,n){i.register(t.concat(n),e,r)}))}}},{key:"unregister",value:function e(t){var n=this.get(t.slice(0,-1));var i=t[t.length-1];var r=n.getChild(i);if(!r){{console.warn("[vuex] trying to unregister module '".concat(i,"', which is ")+"not registered")}return}if(!r.runtime){return}n.removeChild(i)}},{key:"isRegistered",value:function e(t){var n=this.get(t.slice(0,-1));var i=t[t.length-1];if(n){return n.hasChild(i)}return false}}]);return e}();function k(e,t,n){{x(e,n)}t.update(n);if(n.modules){for(var i in n.modules){if(!t.getChild(i)){{console.warn("[vuex] trying to add a new module '".concat(i,"' on hot reloading, ")+"manual reload is needed")}return}k(e.concat(i),t.getChild(i),n.modules[i])}}}var C={assert:function e(t){return typeof t==="function"},expected:"function"};var E={assert:function e(t){return typeof t==="function"||babelHelpers["typeof"](t)==="object"&&typeof t.handler==="function"},expected:'function or object with "handler" function'};var _={getters:C,mutations:C,actions:E};function x(e,t){Object.keys(_).forEach((function(n){if(!t[n])return;var i=_[n];g(t[n],(function(t,r){b(i.assert(t),T(e,n,r,t,i.expected))}))}))}function T(e,t,n,i,r){var s="".concat(t," should be ").concat(r,' but "').concat(t,".").concat(n,'"');if(e.length>0){s+=' in module "'.concat(e.join("."),'"')}s+=" is ".concat(JSON.stringify(i),".");return s}var O=function(){function e(){var n=this;var i=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};babelHelpers.classCallCheck(this,e);if(!t.WidgetVueVendor&&typeof window!=="undefined"&&window.Vue){W(window.Vue)}{b(t.WidgetVueVendor,"must call Vue.use(Vuex) before creating a store instance.");b(typeof Promise!=="undefined","vuex requires a Promise polyfill in this browser.");b(this instanceof e,"store must be called with the new operator.")}var r=i.plugins,s=r===void 0?[]:r,o=i.strict,a=o===void 0?false:o;this._committing=false;this._actions=Object.create(null);this._actionSubscribers=[];this._mutations=Object.create(null);this._wrappedGetters=Object.create(null);this._modules=new I(i);this._modulesNamespaceMap=Object.create(null);this._subscribers=[];this._watcherVM=new t.WidgetVueVendor;this._makeLocalGettersCache=Object.create(null);var l=this;var u=this.dispatch,c=this.commit;this.dispatch=function e(t,n){return u.call(l,t,n)};this.commit=function e(t,n,i){return c.call(l,t,n,i)};this.strict=a;var f=this._modules.root.state;P(this,f,[],this._modules.root);A(this,f);s.forEach((function(e){return e(n)}));var d=i.devtools!==undefined?i.devtools:t.WidgetVueVendor.config.devtools;if(d){h(this)}}babelHelpers.createClass(e,[{key:"commit",value:function e(t,n,i){var r=this;var s=U(t,n,i),o=s.type,a=s.payload,l=s.options;var u={type:o,payload:a};var c=this._mutations[o];if(!c){{console.error("[vuex] unknown mutation type: ".concat(o))}return}this._withCommit((function(){c.forEach((function e(t){t(a)}))}));this._subscribers.slice().forEach((function(e){return e(u,r.state)}));if(l&&l.silent){console.warn("[vuex] mutation type: ".concat(o,". Silent option has been removed. ")+"Use the filter functionality in the vue-devtools")}}},{key:"dispatch",value:function e(t,n){var i=this;var r=U(t,n),s=r.type,o=r.payload;var a={type:s,payload:o};var l=this._actions[s];if(!l){{console.error("[vuex] unknown action type: ".concat(s))}return}try{this._actionSubscribers.slice().filter((function(e){return e.before})).forEach((function(e){return e.before(a,i.state)}))}catch(e){{console.warn("[vuex] error in before action subscribers: ");console.error(e)}}var u=l.length>1?Promise.all(l.map((function(e){return e(o)}))):l[0](o);return new Promise((function(e,t){u.then((function(t){try{i._actionSubscribers.filter((function(e){return e.after})).forEach((function(e){return e.after(a,i.state)}))}catch(e){{console.warn("[vuex] error in after action subscribers: ");console.error(e)}}e(t)}),(function(e){try{i._actionSubscribers.filter((function(e){return e.error})).forEach((function(t){return t.error(a,i.state,e)}))}catch(e){{console.warn("[vuex] error in error action subscribers: ");console.error(e)}}t(e)}))}))}},{key:"subscribe",value:function e(t,n){return M(t,this._subscribers,n)}},{key:"subscribeAction",value:function e(t,n){var i=typeof t==="function"?{before:t}:t;return M(i,this._actionSubscribers,n)}},{key:"watch",value:function e(t,n,i){var r=this;{b(typeof t==="function","store.watch only accepts a function.")}return this._watcherVM.$watch((function(){return t(r.state,r.getters)}),n,i)}},{key:"replaceState",value:function e(t){var n=this;this._withCommit((function(){n._vm._data.$$state=t}))}},{key:"registerModule",value:function e(t,n){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};if(typeof t==="string")t=[t];{b(Array.isArray(t),"module path must be a string or an Array.");b(t.length>0,"cannot register the root module by using registerModule.")}this._modules.register(t,n);P(this,this.state,t,this._modules.get(t),i.preserveState);A(this,this.state)}},{key:"unregisterModule",value:function e(n){var i=this;if(typeof n==="string")n=[n];{b(Array.isArray(n),"module path must be a string or an Array.")}this._modules.unregister(n);this._withCommit((function(){var e=F(i.state,n.slice(0,-1));t.WidgetVueVendor["delete"](e,n[n.length-1])}));D(this)}},{key:"hasModule",value:function e(t){if(typeof t==="string")t=[t];{b(Array.isArray(t),"module path must be a string or an Array.")}return this._modules.isRegistered(t)}},{key:"hotUpdate",value:function e(t){this._modules.update(t);D(this,true)}},{key:"_withCommit",value:function e(t){var n=this._committing;this._committing=true;t();this._committing=n}},{key:"state",get:function e(){return this._vm._data.$$state},set:function e(t){{b(false,"use store.replaceState() to explicit replace store state.")}}}]);return e}();function M(e,t,n){if(t.indexOf(e)<0){n&&n.prepend?t.unshift(e):t.push(e)}return function(){var n=t.indexOf(e);if(n>-1){t.splice(n,1)}}}function D(e,t){e._actions=Object.create(null);e._mutations=Object.create(null);e._wrappedGetters=Object.create(null);e._modulesNamespaceMap=Object.create(null);var n=e.state;P(e,n,[],e._modules.root,true);A(e,n,t)}function A(e,n,i){var r=e._vm;e.getters={};e._makeLocalGettersCache=Object.create(null);var s=e._wrappedGetters;var o={};g(s,(function(t,n){o[n]=w(t,e);Object.defineProperty(e.getters,n,{get:function t(){return e._vm[n]},enumerable:true})}));var a=t.WidgetVueVendor.config.silent;t.WidgetVueVendor.config.silent=true;e._vm=new t.WidgetVueVendor({data:{$$state:n},computed:o});t.WidgetVueVendor.config.silent=a;if(e.strict){B(e)}if(r){if(i){e._withCommit((function(){r._data.$$state=null}))}t.WidgetVueVendor.nextTick((function(){return r.$destroy()}))}}function P(e,n,i,r,s){var o=!i.length;var a=e._modules.getNamespace(i);if(r.namespaced){if(e._modulesNamespaceMap[a]&&true){console.error("[vuex] duplicate namespace ".concat(a," for the namespaced module ").concat(i.join("/")))}e._modulesNamespaceMap[a]=r}if(!o&&!s){var l=F(n,i.slice(0,-1));var u=i[i.length-1];e._withCommit((function(){{if(u in l){console.warn('[vuex] state field "'.concat(u,'" was overridden by a module with the same name at "').concat(i.join("."),'"'))}}t.WidgetVueVendor.set(l,u,r.state)}))}var c=r.context=L(e,a,i);r.forEachMutation((function(t,n){var i=a+n;H(e,i,t,c)}));r.forEachAction((function(t,n){var i=t.root?n:a+n;var r=t.handler||t;j(e,i,r,c)}));r.forEachGetter((function(t,n){var i=a+n;N(e,i,t,c)}));r.forEachChild((function(t,r){P(e,n,i.concat(r),t,s)}))}function L(e,t,n){var i=t==="";var r={dispatch:i?e.dispatch:function(n,i,r){var s=U(n,i,r);var o=s.payload,a=s.options;var l=s.type;if(!a||!a.root){l=t+l;if(!e._actions[l]){console.error("[vuex] unknown local action type: ".concat(s.type,", global type: ").concat(l));return}}return e.dispatch(l,o)},commit:i?e.commit:function(n,i,r){var s=U(n,i,r);var o=s.payload,a=s.options;var l=s.type;if(!a||!a.root){l=t+l;if(!e._mutations[l]){console.error("[vuex] unknown local mutation type: ".concat(s.type,", global type: ").concat(l));return}}e.commit(l,o,a)}};Object.defineProperties(r,{getters:{get:i?function(){return e.getters}:function(){return R(e,t)}},state:{get:function t(){return F(e.state,n)}}});return r}function R(e,t){if(!e._makeLocalGettersCache[t]){var n={};var i=t.length;Object.keys(e.getters).forEach((function(r){if(r.slice(0,i)!==t)return;var s=r.slice(i);Object.defineProperty(n,s,{get:function t(){return e.getters[r]},enumerable:true})}));e._makeLocalGettersCache[t]=n}return e._makeLocalGettersCache[t]}function H(e,t,n,i){var r=e._mutations[t]||(e._mutations[t]=[]);r.push((function t(r){n.call(e,i.state,r)}))}function j(e,t,n,i){var r=e._actions[t]||(e._actions[t]=[]);r.push((function t(r){var s=n.call(e,{dispatch:i.dispatch,commit:i.commit,getters:i.getters,state:i.state,rootGetters:e.getters,rootState:e.state},r);if(!y(s)){s=Promise.resolve(s)}if(e._devtoolHook){return s["catch"]((function(t){e._devtoolHook.emit("vuex:error",t);throw t}))}else{return s}}))}function N(e,t,n,i){if(e._wrappedGetters[t]){{console.error("[vuex] duplicate getter key: ".concat(t))}return}e._wrappedGetters[t]=function e(t){return n(i.state,i.getters,t.state,t.getters)}}function B(e){e._vm.$watch((function(){return this._data.$$state}),(function(){{b(e._committing,"do not mutate vuex store state outside mutation handlers.")}}),{deep:true,sync:true})}function F(e,t){return t.reduce((function(e,t){return e[t]}),e)}function U(e,t,n){if(v(e)&&e.type){n=t;t=e;e=e.type}{b(typeof e==="string","expects string as the type, but found ".concat(babelHelpers["typeof"](e),"."))}return{type:e,payload:t,options:n}}function W(e){c(e)}var $=Y((function(e,t){var n={};if(!K(t)){console.error("[vuex] mapState: mapper parameter must be either an Array or an Object")}q(t).forEach((function(t){var i=t.key,r=t.val;n[i]=function t(){var n=this.$store.state;var i=this.$store.getters;if(e){var s=J(this.$store,"mapState",e);if(!s){return}n=s.context.state;i=s.context.getters}return typeof r==="function"?r.call(this,n,i):n[r]};n[i].vuex=true}));return n}));var V=Y((function(e,t){var n={};if(!K(t)){console.error("[vuex] mapMutations: mapper parameter must be either an Array or an Object")}q(t).forEach((function(t){var i=t.key,r=t.val;n[i]=function t(){var n=this.$store.commit;if(e){var i=J(this.$store,"mapMutations",e);if(!i){return}n=i.context.commit}for(var s=arguments.length,o=new Array(s),a=0;a<s;a++){o[a]=arguments[a]}return typeof r==="function"?r.apply(this,[n].concat(o)):n.apply(this.$store,[r].concat(o))}}));return n}));var G=Y((function(e,t){var n={};if(!K(t)){console.error("[vuex] mapGetters: mapper parameter must be either an Array or an Object")}q(t).forEach((function(t){var i=t.key,r=t.val;r=e+r;n[i]=function t(){if(e&&!J(this.$store,"mapGetters",e)){return}if(!(r in this.$store.getters)){console.error("[vuex] unknown getter: ".concat(r));return}return this.$store.getters[r]};n[i].vuex=true}));return n}));var z=Y((function(e,t){var n={};if(!K(t)){console.error("[vuex] mapActions: mapper parameter must be either an Array or an Object")}q(t).forEach((function(t){var i=t.key,r=t.val;n[i]=function t(){var n=this.$store.dispatch;if(e){var i=J(this.$store,"mapActions",e);if(!i){return}n=i.context.dispatch}for(var s=arguments.length,o=new Array(s),a=0;a<s;a++){o[a]=arguments[a]}return typeof r==="function"?r.apply(this,[n].concat(o)):n.apply(this.$store,[r].concat(o))}}));return n}));var X=function e(t){return{mapState:$.bind(null,t),mapGetters:G.bind(null,t),mapMutations:V.bind(null,t),mapActions:z.bind(null,t)}};function q(e){if(!K(e)){return[]}return Array.isArray(e)?e.map((function(e){return{key:e,val:e}})):Object.keys(e).map((function(t){return{key:t,val:e[t]}}))}function K(e){return Array.isArray(e)||v(e)}function Y(e){return function(t,n){if(typeof t!=="string"){n=t;t=""}else if(t.charAt(t.length-1)!=="/"){t+="/"}return e(t,n)}}function J(e,t,n){var i=e._modulesNamespaceMap[n];if(!i){console.error("[vuex] module namespace not found in ".concat(t,"(): ").concat(n))}return i}function Q(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},t=e.collapsed,n=t===void 0?true:t,i=e.filter,r=i===void 0?function(e,t,n){return true}:i,s=e.transformer,o=s===void 0?function(e){return e}:s,a=e.mutationTransformer,l=a===void 0?function(e){return e}:a,u=e.actionFilter,c=u===void 0?function(e,t){return true}:u,f=e.actionTransformer,d=f===void 0?function(e){return e}:f,h=e.logMutations,p=h===void 0?true:h,g=e.logActions,v=g===void 0?true:g,y=e.logger,b=y===void 0?console:y;return function(e){var t=m(e.state);if(typeof b==="undefined"){return}if(p){e.subscribe((function(e,i){var s=m(i);if(r(e,t,s)){var a=te();var u=l(e);var c="mutation ".concat(e.type).concat(a);Z(b,c,n);b.log("%c prev state","color: #9E9E9E; font-weight: bold",o(t));b.log("%c mutation","color: #03A9F4; font-weight: bold",u);b.log("%c next state","color: #4CAF50; font-weight: bold",o(s));ee(b)}t=s}))}if(v){e.subscribeAction((function(e,t){if(c(e,t)){var i=te();var r=d(e);var s="action ".concat(e.type).concat(i);Z(b,s,n);b.log("%c action","color: #03A9F4; font-weight: bold",r);ee(b)}}))}}}function Z(e,t,n){var i=n?e.groupCollapsed:e.group;try{i.call(e,t)}catch(n){e.log(t)}}function ee(e){try{e.groupEnd()}catch(t){e.log("-- log end --")}}function te(){var e=new Date;return" @ ".concat(ie(e.getHours(),2),":").concat(ie(e.getMinutes(),2),":").concat(ie(e.getSeconds(),2),".").concat(ie(e.getMilliseconds(),3))}function ne(e,t){return new Array(t+1).join(e)}function ie(e,t){return ne("0",t-e.toString().length)+e}var re={Store:O,install:W,version:"3.6.2",mapState:$,mapMutations:V,mapGetters:G,mapActions:z,createNamespacedHelpers:X,createLogger:Q};re.store=function(e){return new O(e)};re.createStore=function(e){return new O(e)};t.WidgetVueVendor.use(re);e.WidgetVuexBuilder=u;e.WidgetVuexBuilderModel=a;e.WidgetVuex=re;e.WidgetVuexVendorV3=re;e.WidgetVuexVendor=re})(this.BX=this.BX||{},BX,BX.Dexie3,BX)})();this.BX=this.BX||{};this.BX.Messenger=this.BX.Messenger||{};(function(e){"use strict";function t(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function n(e){for(var n=1;n<arguments.length;n++){var i=null!=arguments[n]?arguments[n]:{};n%2?t(Object(i),!0).forEach((function(t){babelHelpers.defineProperty(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):t(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function i(e,t,n){r(e,t);t.set(e,n)}function r(e,t){if(t.has(e)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}var s=new WeakMap;var o=new WeakMap;var a=new WeakMap;var l=function(){function e(){babelHelpers.classCallCheck(this,e);i(this,s,{writable:true,value:{}});i(this,o,{writable:true,value:{}});i(this,a,{writable:true,value:{}});babelHelpers.classPrivateFieldSet(this,s,{desktop:true,log:false,info:false,warn:false,error:true,trace:true});babelHelpers.classPrivateFieldSet(this,o,babelHelpers.classPrivateFieldGet(this,s));this.__load()}babelHelpers.createClass(e,[{key:"setConfig",value:function e(t){for(var n in t){if(t.hasOwnProperty(n)&&typeof babelHelpers.classPrivateFieldGet(this,s)[n]!=="undefined"){babelHelpers.classPrivateFieldGet(this,s)[n]=!!t[n];babelHelpers.classPrivateFieldGet(this,o)[n]=!!t[n]}}this.__load()}},{key:"enable",value:function e(t){if(typeof babelHelpers.classPrivateFieldGet(this,s)[t]==="undefined"){return false}babelHelpers.classPrivateFieldGet(this,s)[t]=true;babelHelpers.classPrivateFieldGet(this,a)[t]=true;this.__save();return true}},{key:"disable",value:function e(t){if(typeof babelHelpers.classPrivateFieldGet(this,s)[t]==="undefined"){return false}babelHelpers.classPrivateFieldGet(this,s)[t]=false;babelHelpers.classPrivateFieldGet(this,a)[t]=false;this.__save();return true}},{key:"isEnabled",value:function e(t){return babelHelpers.classPrivateFieldGet(this,s)[t]===true}},{key:"desktop",value:function e(){if(this.isEnabled("desktop")){var t;for(var n=arguments.length,i=new Array(n),r=0;r<n;r++){i[r]=arguments[r]}(t=console).log.apply(t,[].concat(babelHelpers.toConsumableArray(this.__getStyles("desktop")),i))}}},{key:"log",value:function e(){if(this.isEnabled("log")){var t;for(var n=arguments.length,i=new Array(n),r=0;r<n;r++){i[r]=arguments[r]}(t=console).log.apply(t,[].concat(babelHelpers.toConsumableArray(this.__getStyles("log")),i))}}},{key:"info",value:function e(){if(this.isEnabled("info")){var t;for(var n=arguments.length,i=new Array(n),r=0;r<n;r++){i[r]=arguments[r]}(t=console).info.apply(t,[].concat(babelHelpers.toConsumableArray(this.__getStyles("info")),i))}}},{key:"warn",value:function e(){if(this.isEnabled("warn")){var t;for(var n=arguments.length,i=new Array(n),r=0;r<n;r++){i[r]=arguments[r]}(t=console).warn.apply(t,[].concat(babelHelpers.toConsumableArray(this.__getStyles("warn")),i))}}},{key:"error",value:function e(){if(this.isEnabled("error")){var t;for(var n=arguments.length,i=new Array(n),r=0;r<n;r++){i[r]=arguments[r]}(t=console).error.apply(t,[].concat(babelHelpers.toConsumableArray(this.__getStyles("error")),i))}}},{key:"trace",value:function e(){if(this.isEnabled("trace")){var t;(t=console).trace.apply(t,arguments)}}},{key:"__save",value:function e(){if(typeof window.localStorage!=="undefined"){try{var t={};for(var n in babelHelpers.classPrivateFieldGet(this,a)){if(babelHelpers.classPrivateFieldGet(this,a).hasOwnProperty(n)&&babelHelpers.classPrivateFieldGet(this,o)[n]!==babelHelpers.classPrivateFieldGet(this,a)[n]){t[n]=!!babelHelpers.classPrivateFieldGet(this,a)[n]}}console.warn(JSON.stringify(t));window.localStorage.setItem("bx-messenger-logger",JSON.stringify(t))}catch(e){}}}},{key:"__load",value:function e(){if(typeof window.localStorage!=="undefined"){try{var t=window.localStorage.getItem("bx-messenger-logger");if(typeof t==="string"){babelHelpers.classPrivateFieldSet(this,a,JSON.parse(t));babelHelpers.classPrivateFieldSet(this,s,n(n({},babelHelpers.classPrivateFieldGet(this,s)),babelHelpers.classPrivateFieldGet(this,a)))}}catch(e){}}}},{key:"__getStyles",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"all";var n={desktop:["%cDESKTOP","color: white; font-style: italic; background-color: #29619b; padding: 0 6px"],log:["%cLOG","color: #2a323b; font-style: italic; background-color: #ccc; padding: 0 6px"],info:["%cINFO","color: #fff; font-style: italic; background-color: #6b7f96; padding: 0 6px"],warn:["%cWARNING","color: white; font-style: italic; padding: 0 6px; border: 1px solid #f0a74f"],error:["%cERROR","color: white; font-style: italic; padding: 0 6px; border: 1px solid #8a3232"]};if(t==="all"){return n}if(n[t]){return n[t]}return[]}},{key:"__getRemoveString",value:function e(){var t=this.__getStyles();var n=[];for(var i in t){if(t.hasOwnProperty(i)){n.push(t[i][1])}}return n}}]);return e}();var u=new l;e.Logger=u})(this.BX.Messenger.Lib=this.BX.Messenger.Lib||{});this.BX=this.BX||{};this.BX.Messenger=this.BX.Messenger||{};(function(e){"use strict";var t=Object.freeze({groupTitle:"groupTitle",message:"message",recentTitle:"recentTitle",recentLinesTitle:"recentLinesTitle",readedTitle:"readedTitle",default:"default",vacationTitle:"vacationTitle"});var n=Object.freeze({mobile:"mobile",desktop:"desktop"});var i=Object.freeze({horizontal:"horizontal",portrait:"portrait"});var r=Object.freeze({none:"none",add:"delete",update:"update",delete:"delete",set:"set",setAfter:"after",setBefore:"before"});var s=Object.freeze({dialogues:50,messages:100});var o=Object.freeze({imMessageAdd:"im.message.add",imMessageUpdate:"im.message.update",imMessageDelete:"im.message.delete",imMessageLike:"im.message.like",imMessageCommand:"im.message.command",imMessageShare:"im.message.share",imChatGet:"im.chat.get",imChatLeave:"im.chat.leave",imChatMute:"im.chat.mute",imChatParentJoin:"im.chat.parent.join",imDialogGet:"im.dialog.get",imDialogMessagesGet:"im.dialog.messages.get",imDialogRead:"im.dialog.read",imDialogUnread:"im.dialog.unread",imDialogWriting:"im.dialog.writing",imUserGet:"im.user.get",imUserListGet:"im.user.list.get",imDiskFolderGet:"im.disk.folder.get",imDiskFileUpload:"disk.folder.uploadfile",imDiskFileCommit:"im.disk.file.commit",mobileBrowserConstGet:"mobile.browser.const.get",imRecentGet:"im.recent.get",imRecentList:"im.recent.list",imCallGetCallLimits:"im.call.getCallLimits",imNotifyGet:"im.notify.get",imNotifySchemaGet:"im.notify.schema.get"});var a=Object.freeze({imChatGet:"im.chat.get",imMessageAdd:"im.message.add",imDialogRead:"im.dialog.read",imDialogMessagesGet:"im.dialog.messages.get",imDialogMessagesGetInit:"im.dialog.messages.get.init",imDialogMessagesGetUnread:"im.dialog.messages.get.unread",imDiskFolderGet:"im.disk.folder.get",imDiskFileUpload:"disk.folder.uploadfile",imDiskFileCommit:"im.disk.file.commit",imUserGet:"im.user.get",imUserListGet:"im.user.list.get",mobileBrowserConstGet:"mobile.browser.const.get",imRecentGet:"im.recent.get",imRecentList:"im.recent.list",imCallGetCallLimits:"im.call.getCallLimits",imNotifyGet:"im.notify.get",imNotifySchemaGet:"im.notify.schema.get"});var l=Object.freeze({dialog:{open:"IM.Dialog:open",newMessage:"EventType.dialog.newMessage",scrollOnStart:"IM.Dialog:scrollOnStart",scrollToBottom:"IM.Dialog:scrollToBottom",readVisibleMessages:"IM.Dialog.readVisibleMessages",requestUnread:"IM.Dialog.requestUnread",readMessage:"IM.Dialog:readMessage",quoteMessage:"IM.Dialog:quoteMessage",clickOnCommand:"IM.Dialog:clickOnCommand",clickOnMention:"IM.Dialog:clickOnMention",clickOnUserName:"IM.Dialog:clickOnUserName",clickOnMessageMenu:"IM.Dialog:clickOnMessageMenu",clickOnMessageRetry:"IM.Dialog:clickOnMessageRetry",doubleClickOnMessage:"IM.Dialog:doubleClickOnMessage",clickOnUploadCancel:"IM.Dialog:clickOnUploadCancel",clickOnReadList:"IM.Dialog:clickOnReadList",setMessageReaction:"IM.Dialog:setMessageReaction",openMessageReactionList:"IM.Dialog:openMessageReactionList",clickOnKeyboardButton:"IM.Dialog:clickOnKeyboardButton",clickOnChatTeaser:"IM.Dialog:clickOnChatTeaser",clickOnDialog:"IM.Dialog:clickOnDialog",quotePanelClose:"IM.Dialog:quotePanelClose",beforeMobileKeyboard:"IM.Dialog:beforeMobileKeyboard",messagesSet:"IM.Dialog:messagesSet"},textarea:{focus:"IM.Textarea:focus",setFocus:"IM.Textarea:setFocus",blur:"IM.Textarea:blur",setBlur:"IM.Textarea:setBlur",keyUp:"IM.Textarea:keyUp",edit:"IM.Textarea:edit",insertText:"IM.Textarea:insertText",sendMessage:"IM.Textarea:sendMessage",fileSelected:"IM.Textarea:fileSelected",startWriting:"IM.Textarea:startWriting",stopWriting:"IM.Textarea:stopWriting",appButtonClick:"IM.Textarea:appButtonClick"},uploader:{addMessageWithFile:"IM.Uploader:addMessageWithFile"},conference:{setPasswordFocus:"IM.Conference:setPasswordFocus",hideSmiles:"IM.Conference:hideSmiles",requestPermissions:"IM.Conference:requestPermissions",waitForStart:"IM.Conference:waitForStart",userRenameFocus:"IM.Conference:userRenameFocus",userRenameBlur:"IM.Conference:userRenameBlur"},notification:{updateState:"IM.Notifications:restoreConnection"},mobile:{textarea:{setText:"IM.Mobile.Textarea:setText",setFocus:"IM.Mobile.Textarea:setFocus"},openUserList:"IM.Mobile:openUserList"}});var u=Object.freeze({private:"private",chat:"chat",open:"open",call:"call",crm:"crm"});var c=Object.freeze({lead:"lead",company:"company",contact:"contact",deal:"deal",none:"none"});var f=Object.freeze({listBody:"bx-im-dialog-list",listItem:"bx-im-dialog-list-item-reference",listItemName:"bx-im-dialog-list-item-name-reference",listItemBody:"bx-im-dialog-list-item-content-reference",listUnreadLoader:"bx-im-dialog-list-unread-loader-reference"});var d=Object.freeze({message:"message",delimiter:"delimiter",group:"group",historyLoader:"historyLoader",unreadLoader:"unreadLoader",button:"button",placeholder:"placeholder"});var h=Object.freeze({loading:"loading",empty:"empty",show:"show"});var p=Object.freeze({upload:"upload",wait:"wait",done:"done",error:"error"});var m=Object.freeze({image:"image",video:"video",audio:"audio",file:"file"});var g=Object.freeze({self:"self",opponent:"opponent",system:"system"});var v=Object.freeze({view:"view",edit:"edit",create:"create"});var y=Object.freeze({preparation:"preparation",call:"call"});var b=Object.freeze({userLimitReached:"userLimitReached",detectIntranetUser:"detectIntranetUser",bitrix24only:"bitrix24only",kickedFromCall:"kickedFromCall",unsupportedBrowser:"unsupportedBrowser",missingMicrophone:"missingMicrophone",unsafeConnection:"unsafeConnection",wrongAlias:"wrongAlias",notStarted:"notStarted",finished:"finished",userLeftCall:"userLeftCall",noSignalFromCamera:"noSignalFromCamera"});var w=Object.freeze({hidden:"hidden",chat:"chat",users:"users",split:"split"});var S=Object.freeze({Idle:"Idle",Busy:"Busy",Calling:"Calling",Unavailable:"Unavailable",Declined:"Declined",Ready:"Ready",Connecting:"Connecting",Connected:"Connected",Failed:"Failed"});var I={chat:"chat",open:"open",user:"user",notification:"notification"};var k={item:"item",placeholder:"placeholder"};var C={general:"general",pinned:"pinned"};var E={received:"received",delivered:"delivered",error:"error"};var _=Object.freeze({confirm:1,simple:3,placeholder:5});e.DateFormat=t;e.DeviceType=n;e.DeviceOrientation=i;e.MutationType=r;e.StorageLimit=s;e.RestMethod=o;e.RestMethodHandler=a;e.EventType=l;e.DialogType=u;e.DialogCrmType=c;e.DialogReferenceClassName=f;e.DialogTemplateType=d;e.DialogState=h;e.FileStatus=p;e.FileType=m;e.MessageType=g;e.ConferenceFieldState=v;e.ConferenceStateType=y;e.ConferenceErrorCode=b;e.ConferenceRightPanelMode=w;e.ConferenceUserState=S;e.ChatTypes=I;e.TemplateTypes=k;e.RecentSection=C;e.MessageStatus=E;e.NotificationTypesCodes=_})(this.BX.Messenger.Const=this.BX.Messenger.Const||{});(function(e){if(!e.BX){e.BX={}}if(!e.BX.Main){e.BX.Main={}}else if(e.BX.Main.Date){return}var t=e.BX;t.Main.Date=t.Main.DateTimeFormat={AM_PM_MODE:{UPPER:1,LOWER:2,NONE:false},format:function(e,t,i,r){var s=this;var o=n.isDate(t)?new Date(t.getTime()):n.isNumber(t)?new Date(t*1e3):new Date;var a=n.isDate(i)?new Date(i.getTime()):n.isNumber(i)?new Date(i*1e3):new Date;var l=!!r;if(n.isArray(e))return p(e,o,a,l);else if(!n.isNotEmptyString(e))return"";var u=(e.match(/{{([^{}]*)}}/g)||[]).map((function(e){return(e.match(/[^{}]+/)||[""])[0]}));if(u.length>0){u.forEach((function(t,n){e=e.replace("{{"+t+"}}","{{"+n+"}}")}))}var c=/\\?(sago|iago|isago|Hago|dago|mago|Yago|sdiff|idiff|Hdiff|ddiff|mdiff|Ydiff|sshort|ishort|Hshort|dshort|mhort|Yshort|yesterday|today|tommorow|tomorrow|[a-z])/gi;var f={d:function(){return n.strPadLeft(g(o).toString(),2,"0")},D:function(){return s._getMessage("DOW_"+I(o))},j:function(){return g(o)},l:function(){return s._getMessage("DAY_OF_WEEK_"+I(o))},N:function(){return I(o)||7},S:function(){if(g(o)%10==1&&g(o)!=11)return"st";else if(g(o)%10==2&&g(o)!=12)return"nd";else if(g(o)%10==3&&g(o)!=13)return"rd";else return"th"},w:function(){return I(o)},z:function(){var e=new Date(m(o),0,1);var t=new Date(m(o),v(o),g(o));return Math.ceil((t-e)/(24*3600*1e3))},W:function(){var e=new Date(o.getTime());var t=(I(o)+6)%7;k(e,g(e)-t+3);var i=e.getTime();C(e,0,1);if(I(e)!=4)C(e,0,1+(4-I(e)+7)%7);var r=1+Math.ceil((i-e)/(7*24*3600*1e3));return n.strPadLeft(r.toString(),2,"0")},F:function(){return s._getMessage("MONTH_"+(v(o)+1)+"_S")},f:function(){return s._getMessage("MONTH_"+(v(o)+1))},m:function(){return n.strPadLeft((v(o)+1).toString(),2,"0")},M:function(){return s._getMessage("MON_"+(v(o)+1))},n:function(){return v(o)+1},t:function(){var e=l?new Date(Date.UTC(m(o),v(o)+1,0)):new Date(m(o),v(o)+1,0);return g(e)},L:function(){var e=m(o);return e%4==0&&e%100!=0||e%400==0?1:0},o:function(){var e=new Date(o.getTime());k(e,g(e)-(I(o)+6)%7+3);return m(e)},Y:function(){return m(o)},y:function(){return m(o).toString().slice(2)},a:function(){return y(o)>11?"pm":"am"},A:function(){return y(o)>11?"PM":"AM"},B:function(){var e=(o.getUTCHours()+1)%24+o.getUTCMinutes()/60+o.getUTCSeconds()/3600;return n.strPadLeft(Math.floor(e*1e3/24).toString(),3,"0")},g:function(){return y(o)%12||12},G:function(){return y(o)},h:function(){return n.strPadLeft((y(o)%12||12).toString(),2,"0")},H:function(){return n.strPadLeft(y(o).toString(),2,"0")},i:function(){return n.strPadLeft(b(o).toString(),2,"0")},s:function(){return n.strPadLeft(w(o).toString(),2,"0")},u:function(){return n.strPadLeft((S(o)*1e3).toString(),6,"0")},e:function(){if(l)return"UTC";return""},I:function(){if(l)return 0;var e=new Date(m(o),0,1);var t=Date.UTC(m(o),0,1);var n=new Date(m(o),6,0);var i=Date.UTC(m(o),6,0);return 0+(e-t!==n-i)},O:function(){if(l)return"+0000";var e=o.getTimezoneOffset();var t=Math.abs(e);return(e>0?"-":"+")+n.strPadLeft((Math.floor(t/60)*100+t%60).toString(),4,"0")},P:function(){if(l)return"+00:00";var e=this.O();return e.substr(0,3)+":"+e.substr(3)},Z:function(){if(l)return 0;return-o.getTimezoneOffset()*60},c:function(){return"Y-m-d\\TH:i:sP".replace(c,_)},r:function(){return"D, d M Y H:i:s O".replace(c,_)},U:function(){return Math.floor(o.getTime()/1e3)},sago:function(){return E(x((a-o)/1e3),{0:"FD_SECOND_AGO_0",1:"FD_SECOND_AGO_1","10_20":"FD_SECOND_AGO_10_20",MOD_1:"FD_SECOND_AGO_MOD_1",MOD_2_4:"FD_SECOND_AGO_MOD_2_4",MOD_OTHER:"FD_SECOND_AGO_MOD_OTHER"})},sdiff:function(){return E(x((a-o)/1e3),{0:"FD_SECOND_DIFF_0",1:"FD_SECOND_DIFF_1","10_20":"FD_SECOND_DIFF_10_20",MOD_1:"FD_SECOND_DIFF_MOD_1",MOD_2_4:"FD_SECOND_DIFF_MOD_2_4",MOD_OTHER:"FD_SECOND_DIFF_MOD_OTHER"})},sshort:function(){return s._getMessage("FD_SECOND_SHORT").replace(/#VALUE#/g,x((a-o)/1e3))},iago:function(){return E(x((a-o)/60/1e3),{0:"FD_MINUTE_AGO_0",1:"FD_MINUTE_AGO_1","10_20":"FD_MINUTE_AGO_10_20",MOD_1:"FD_MINUTE_AGO_MOD_1",MOD_2_4:"FD_MINUTE_AGO_MOD_2_4",MOD_OTHER:"FD_MINUTE_AGO_MOD_OTHER"})},idiff:function(){return E(x((a-o)/60/1e3),{0:"FD_MINUTE_DIFF_0",1:"FD_MINUTE_DIFF_1","10_20":"FD_MINUTE_DIFF_10_20",MOD_1:"FD_MINUTE_DIFF_MOD_1",MOD_2_4:"FD_MINUTE_DIFF_MOD_2_4",MOD_OTHER:"FD_MINUTE_DIFF_MOD_OTHER"})},isago:function(){var e=x((a-o)/60/1e3);var t=E(e,{0:"FD_MINUTE_0",1:"FD_MINUTE_1","10_20":"FD_MINUTE_10_20",MOD_1:"FD_MINUTE_MOD_1",MOD_2_4:"FD_MINUTE_MOD_2_4",MOD_OTHER:"FD_MINUTE_MOD_OTHER"});t+=" ";var n=x((a-o)/1e3)-e*60;t+=E(n,{0:"FD_SECOND_AGO_0",1:"FD_SECOND_AGO_1","10_20":"FD_SECOND_AGO_10_20",MOD_1:"FD_SECOND_AGO_MOD_1",MOD_2_4:"FD_SECOND_AGO_MOD_2_4",MOD_OTHER:"FD_SECOND_AGO_MOD_OTHER"});return t},ishort:function(){return s._getMessage("FD_MINUTE_SHORT").replace(/#VALUE#/g,x((a-o)/60/1e3))},Hago:function(){return E(x((a-o)/60/60/1e3),{0:"FD_HOUR_AGO_0",1:"FD_HOUR_AGO_1","10_20":"FD_HOUR_AGO_10_20",MOD_1:"FD_HOUR_AGO_MOD_1",MOD_2_4:"FD_HOUR_AGO_MOD_2_4",MOD_OTHER:"FD_HOUR_AGO_MOD_OTHER"})},Hdiff:function(){return E(x((a-o)/60/60/1e3),{0:"FD_HOUR_DIFF_0",1:"FD_HOUR_DIFF_1","10_20":"FD_HOUR_DIFF_10_20",MOD_1:"FD_HOUR_DIFF_MOD_1",MOD_2_4:"FD_HOUR_DIFF_MOD_2_4",MOD_OTHER:"FD_HOUR_DIFF_MOD_OTHER"})},Hshort:function(){return s._getMessage("FD_HOUR_SHORT").replace(/#VALUE#/g,x((a-o)/60/60/1e3))},yesterday:function(){return s._getMessage("FD_YESTERDAY")},today:function(){return s._getMessage("FD_TODAY")},tommorow:function(){return s._getMessage("FD_TOMORROW")},tomorrow:function(){return s._getMessage("FD_TOMORROW")},dago:function(){return E(x((a-o)/60/60/24/1e3),{0:"FD_DAY_AGO_0",1:"FD_DAY_AGO_1","10_20":"FD_DAY_AGO_10_20",MOD_1:"FD_DAY_AGO_MOD_1",MOD_2_4:"FD_DAY_AGO_MOD_2_4",MOD_OTHER:"FD_DAY_AGO_MOD_OTHER"})},ddiff:function(){return E(x((a-o)/60/60/24/1e3),{0:"FD_DAY_DIFF_0",1:"FD_DAY_DIFF_1","10_20":"FD_DAY_DIFF_10_20",MOD_1:"FD_DAY_DIFF_MOD_1",MOD_2_4:"FD_DAY_DIFF_MOD_2_4",MOD_OTHER:"FD_DAY_DIFF_MOD_OTHER"})},dshort:function(){return s._getMessage("FD_DAY_SHORT").replace(/#VALUE#/g,x((a-o)/60/60/24/1e3))},mago:function(){return E(x((a-o)/60/60/24/31/1e3),{0:"FD_MONTH_AGO_0",1:"FD_MONTH_AGO_1","10_20":"FD_MONTH_AGO_10_20",MOD_1:"FD_MONTH_AGO_MOD_1",MOD_2_4:"FD_MONTH_AGO_MOD_2_4",MOD_OTHER:"FD_MONTH_AGO_MOD_OTHER"})},mdiff:function(){return E(x((a-o)/60/60/24/31/1e3),{0:"FD_MONTH_DIFF_0",1:"FD_MONTH_DIFF_1","10_20":"FD_MONTH_DIFF_10_20",MOD_1:"FD_MONTH_DIFF_MOD_1",MOD_2_4:"FD_MONTH_DIFF_MOD_2_4",MOD_OTHER:"FD_MONTH_DIFF_MOD_OTHER"})},mshort:function(){return s._getMessage("FD_MONTH_SHORT").replace(/#VALUE#/g,x((a-o)/60/60/24/31/1e3))},Yago:function(){return E(x((a-o)/60/60/24/365/1e3),{0:"FD_YEARS_AGO_0",1:"FD_YEARS_AGO_1","10_20":"FD_YEARS_AGO_10_20",MOD_1:"FD_YEARS_AGO_MOD_1",MOD_2_4:"FD_YEARS_AGO_MOD_2_4",MOD_OTHER:"FD_YEARS_AGO_MOD_OTHER"})},Ydiff:function(){return E(x((a-o)/60/60/24/365/1e3),{0:"FD_YEARS_DIFF_0",1:"FD_YEARS_DIFF_1","10_20":"FD_YEARS_DIFF_10_20",MOD_1:"FD_YEARS_DIFF_MOD_1",MOD_2_4:"FD_YEARS_DIFF_MOD_2_4",MOD_OTHER:"FD_YEARS_DIFF_MOD_OTHER"})},Yshort:function(){return E(x((a-o)/60/60/24/365/1e3),{0:"FD_YEARS_SHORT_0",1:"FD_YEARS_SHORT_1","10_20":"FD_YEARS_SHORT_10_20",MOD_1:"FD_YEARS_SHORT_MOD_1",MOD_2_4:"FD_YEARS_SHORT_MOD_2_4",MOD_OTHER:"FD_YEARS_SHORT_MOD_OTHER"})},x:function(){var e=s.isAmPmMode(true);var t=e===s.AM_PM_MODE.LOWER?"g:i a":e===s.AM_PM_MODE.UPPER?"g:i A":"H:i";return s.format([["tomorrow","tomorrow, "+t],["-",s.convertBitrixFormat(s._getMessage("FORMAT_DATETIME")).replace(/:s/g,"")],["s","sago"],["i","iago"],["today","today, "+t],["yesterday","yesterday, "+t],["",s.convertBitrixFormat(s._getMessage("FORMAT_DATETIME")).replace(/:s/g,"")]],o,a,l)},X:function(){var e=s.isAmPmMode(true);var t=e===s.AM_PM_MODE.LOWER?"g:i a":e===s.AM_PM_MODE.UPPER?"g:i A":"H:i";var n=s.format([["tomorrow","tomorrow"],["-",s.convertBitrixFormat(s._getMessage("FORMAT_DATE"))],["today","today"],["yesterday","yesterday"],["",s.convertBitrixFormat(s._getMessage("FORMAT_DATE"))]],o,a,l);var i=s.format([["tomorrow",t],["today",t],["yesterday",t],["",""]],o,a,l);if(i.length>0)return s._getMessage("FD_DAY_AT_TIME").replace(/#DAY#/g,n).replace(/#TIME#/g,i);else return n},Q:function(){var e=x((a-o)/60/60/24/1e3);if(e==0)return s._getMessage("FD_DAY_DIFF_1").replace(/#VALUE#/g,1);else return s.format([["d","ddiff"],["m","mdiff"],["","Ydiff"]],o,a)}};var d=false;if(e[0]&&e[0]=="^"){d=true;e=e.substr(1)}var h=e.replace(c,_);if(d){h=h.replace(/\s*00:00:00\s*/g,"").replace(/(\d\d:\d\d)(:00)/g,"$1").replace(/(\s*00:00\s*)(?!:)/g,"")}if(u.length>0){u.forEach((function(e,t){h=h.replace("{{"+t+"}}",e)}))}return h;function p(e,t,n,i){var r=x((n-t)/1e3);for(var o=0;o<e.length;o++){var a=e[o][0];var l=e[o][1];var u=null;if(a=="s"){if(r<60)return s.format(l,t,n,i)}else if((u=/^s(\d+)\>?(\d+)?/.exec(a))!=null){if(u[1]&&u[2]){if(r<u[1]&&r>u[2]){return s.format(l,t,n,i)}}else if(r<u[1]){return s.format(l,t,n,i)}}else if(a=="i"){if(r<60*60)return s.format(l,t,n,i)}else if((u=/^i(\d+)\>?(\d+)?/.exec(a))!=null){if(u[1]&&u[2]){if(r<u[1]*60&&r>u[2]*60){return s.format(l,t,n,i)}}else if(r<u[1]*60){return s.format(l,t,n,i)}}else if(a=="H"){if(r<24*60*60)return s.format(l,t,n,i)}else if((u=/^H(\d+)\>?(\d+)?/.exec(a))!=null){if(u[1]&&u[2]){if(r<u[1]*60*60&&r>u[2]*60*60){return s.format(l,t,n,i)}}else if(r<u[1]*60*60){return s.format(l,t,n,i)}}else if(a=="d"){if(r<31*24*60*60)return s.format(l,t,n,i)}else if((u=/^d(\d+)\>?(\d+)?/.exec(a))!=null){if(u[1]&&u[2]){if(r<u[1]*24*60*60&&r>u[2]*24*60*60){return s.format(l,t,n,i)}}else if(r<u[1]*24*60*60){return s.format(l,t,n,i)}}else if(a=="m"){if(r<365*24*60*60)return s.format(l,t,n,i)}else if((u=/^m(\d+)\>?(\d+)?/.exec(a))!=null){if(u[1]&&u[2]){if(r<u[1]*31*24*60*60&&r>u[2]*31*24*60*60){return s.format(l,t,n,i)}}else if(r<u[1]*31*24*60*60){return s.format(l,t,n,i)}}else if(a=="now"){if(t.getTime()==n.getTime()){return s.format(l,t,n,i)}}else if(a=="today"){var c=m(n),f=v(n),d=g(n);var h=i?new Date(Date.UTC(c,f,d,0,0,0,0)):new Date(c,f,d,0,0,0,0);var p=i?new Date(Date.UTC(c,f,d+1,0,0,0,0)):new Date(c,f,d+1,0,0,0,0);if(t>=h&&t<p)return s.format(l,t,n,i)}else if(a=="todayFuture"){var c=m(n),f=v(n),d=g(n);var h=n.getTime();var p=i?new Date(Date.UTC(c,f,d+1,0,0,0,0)):new Date(c,f,d+1,0,0,0,0);if(t>=h&&t<p)return s.format(l,t,n,i)}else if(a=="yesterday"){c=m(n);f=v(n);d=g(n);var y=i?new Date(Date.UTC(c,f,d-1,0,0,0,0)):new Date(c,f,d-1,0,0,0,0);var b=i?new Date(Date.UTC(c,f,d,0,0,0,0)):new Date(c,f,d,0,0,0,0);if(t>=y&&t<b)return s.format(l,t,n,i)}else if(a=="tommorow"||a=="tomorrow"){c=m(n);f=v(n);d=g(n);var w=i?new Date(Date.UTC(c,f,d+1,0,0,0,0)):new Date(c,f,d+1,0,0,0,0);var S=i?new Date(Date.UTC(c,f,d+2,0,0,0,0)):new Date(c,f,d+2,0,0,0,0);if(t>=w&&t<S)return s.format(l,t,n,i)}else if(a=="-"){if(r<0)return s.format(l,t,n,i)}}return e.length>0?s.format(e[e.length-1][1],t,n,i):""}function m(e){return l?e.getUTCFullYear():e.getFullYear()}function g(e){return l?e.getUTCDate():e.getDate()}function v(e){return l?e.getUTCMonth():e.getMonth()}function y(e){return l?e.getUTCHours():e.getHours()}function b(e){return l?e.getUTCMinutes():e.getMinutes()}function w(e){return l?e.getUTCSeconds():e.getSeconds()}function S(e){return l?e.getUTCMilliseconds():e.getMilliseconds()}function I(e){return l?e.getUTCDay():e.getDay()}function k(e,t){return l?e.setUTCDate(t):e.setDate(t)}function C(e,t,n){return l?e.setUTCMonth(t,n):e.setMonth(t,n)}function E(e,t){var n=e<100?Math.abs(e):Math.abs(e%100);var i=n%10;var r="";if(n==0)r=s._getMessage(t["0"]);else if(n==1)r=s._getMessage(t["1"]);else if(n>=10&&n<=20)r=s._getMessage(t["10_20"]);else if(i==1)r=s._getMessage(t["MOD_1"]);else if(2<=i&&i<=4)r=s._getMessage(t["MOD_2_4"]);else r=s._getMessage(t["MOD_OTHER"]);return r.replace(/#VALUE#/g,e)}function _(e,t){if(f[e])return f[e]();else return t}function x(e){return e>=0?Math.floor(e):Math.ceil(e)}},convertBitrixFormat:function(e){if(!n.isNotEmptyString(e))return"";return e.replace("YYYY","Y").replace("MMMM","F").replace("MM","m").replace("M","M").replace("DD","d").replace("G","g").replace(/GG/i,"G").replace("H","h").replace(/HH/i,"H").replace("MI","i").replace("SS","s").replace("TT","A").replace("T","a")},convertToUTC:function(e){if(!n.isDate(e))return null;return new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()))},getNewDate:function(e){return new Date(this.getBrowserTimestamp(e))},getBrowserTimestamp:function(e){e=parseInt(e,10);var t=new Date(e*1e3).getTimezoneOffset()*60;return(parseInt(e,10)+parseInt(this._getMessage("SERVER_TZ_OFFSET"))+t)*1e3},getServerTimestamp:function(e){e=parseInt(e,10);var t=new Date(e).getTimezoneOffset()*60;return Math.round(e/1e3-(parseInt(this._getMessage("SERVER_TZ_OFFSET"),10)+parseInt(t,10)))},formatLastActivityDate:function(e,t,n){var i=this.isAmPmMode(true);var r=i===this.AM_PM_MODE.LOWER?"g:i a":i===this.AM_PM_MODE.UPPER?"g:i A":"H:i";var s=[["tomorrow","#01#"+r],["now","#02#"],["todayFuture","#03#"+r],["yesterday","#04#"+r],["-",this.convertBitrixFormat(this._getMessage("FORMAT_DATETIME")).replace(/:s/g,"")],["s60","sago"],["i60","iago"],["H5","Hago"],["H24","#03#"+r],["d31","dago"],["m12>1","mago"],["m12>0","dago"],["","#05#"]];var o=this.format(s,e,t,n);var a=null;if((a=/^#(\d+)#(.*)/.exec(o))!=null){switch(a[1]){case"01":o=this._getMessage("FD_LAST_SEEN_TOMORROW").replace("#TIME#",a[2]);break;case"02":o=this._getMessage("FD_LAST_SEEN_NOW");break;case"03":o=this._getMessage("FD_LAST_SEEN_TODAY").replace("#TIME#",a[2]);break;case"04":o=this._getMessage("FD_LAST_SEEN_YESTERDAY").replace("#TIME#",a[2]);break;case"05":o=this._getMessage("FD_LAST_SEEN_MORE_YEAR");break;default:o=a[2];break}}return o},isAmPmMode:function(e){if(e===true){return this._getMessage("AMPM_MODE")}return this._getMessage("AMPM_MODE")!==false},_getMessage:function(e){return t.message(e)},parse:function(e,t,i,r){if(n.isNotEmptyString(e)){if(!i)i=this._getMessage("FORMAT_DATE");if(!r)r=this._getMessage("FORMAT_DATETIME");var s="";for(u=1;u<=12;u++){s=s+"|"+this._getMessage("MON_"+u)}var o=new RegExp("([0-9]+|[a-z]+"+s+")","ig"),a=e.match(o),l=i.match(/(DD|MI|MMMM|MM|M|YYYY)/gi),u,c,f=[],d=[],h={};if(!a){return null}if(a.length>l.length){l=r.match(/(DD|MI|MMMM|MM|M|YYYY|HH|H|SS|TT|T|GG|G)/gi)}for(u=0,c=a.length;u<c;u++){if(a[u].trim()!==""){f[f.length]=a[u]}}for(u=0,c=l.length;u<c;u++){if(l[u].trim()!==""){d[d.length]=l[u]}}var p=n.array_search("MMMM",d);if(p>0){f[p]=this.getMonthIndex(f[p]);d[p]="MM"}else{p=n.array_search("M",d);if(p>0){f[p]=this.getMonthIndex(f[p]);d[p]="MM"}}for(u=0,c=d.length;u<c;u++){var m=d[u].toUpperCase();h[m]=m==="T"||m==="TT"?f[u]:parseInt(f[u],10)}if(h["DD"]>0&&h["MM"]>0&&h["YYYY"]>0){var g=new Date;if(t){g.setUTCDate(1);g.setUTCFullYear(h["YYYY"]);g.setUTCMonth(h["MM"]-1);g.setUTCDate(h["DD"]);g.setUTCHours(0,0,0,0)}else{g.setDate(1);g.setFullYear(h["YYYY"]);g.setMonth(h["MM"]-1);g.setDate(h["DD"]);g.setHours(0,0,0,0)}if((!isNaN(h["HH"])||!isNaN(h["GG"])||!isNaN(h["H"])||!isNaN(h["G"]))&&!isNaN(h["MI"])){if(!isNaN(h["H"])||!isNaN(h["G"])){var v=(h["T"]||h["TT"]||"am").toUpperCase()==="PM",y=parseInt(h["H"]||h["G"]||0,10);if(v){h["HH"]=y+(y===12?0:12)}else{h["HH"]=y<12?y:0}}else{h["HH"]=parseInt(h["HH"]||h["GG"]||0,10)}if(isNaN(h["SS"]))h["SS"]=0;if(t){g.setUTCHours(h["HH"],h["MI"],h["SS"])}else{g.setHours(h["HH"],h["MI"],h["SS"])}}return g}}return null},getMonthIndex:function(e){var t,n=e.toUpperCase(),i=["jan","feb","mar","apr","may","jun","jul","aug","sep","oct","nov","dec"],r=["january","february","march","april","may","june","july","august","september","october","november","december"];for(t=1;t<=12;t++){if(n===this._getMessage("MON_"+t).toUpperCase()||n===this._getMessage("MONTH_"+t).toUpperCase()||n===i[t-1].toUpperCase()||n===r[t-1].toUpperCase()){return t}}return e}};var n={isDate:function(e){return e&&Object.prototype.toString.call(e)=="[object Date]"},isNumber:function(e){return e===0?true:e?typeof e=="number"||e instanceof Number:false},isArray:function(e){return e&&Object.prototype.toString.call(e)=="[object Array]"},isString:function(e){return e===""?true:e?typeof e=="string"||e instanceof String:false},isNotEmptyString:function(e){return this.isString(e)?e.length>0:false},strPadLeft:function(e,t,n){var i=e.length,r=n.length;if(i>=t)return e;for(;i<t;i+=r)e=n+e;return e},array_search:function(e,t){for(var n=0;n<t.length;n++){if(t[n]==e)return n}return-1}}})(window);this.BX=this.BX||{};this.BX.Messenger=this.BX.Messenger||{};(function(e,t){"use strict";var n={browser:{isSafari:function e(){if(this.isChrome()){return false}if(!navigator.userAgent.toLowerCase().includes("safari")){return false}return!this.isSafariBased()},isSafariBased:function e(){if(!navigator.userAgent.toLowerCase().includes("applewebkit")){return false}return navigator.userAgent.toLowerCase().includes("yabrowser")||navigator.userAgent.toLowerCase().includes("yaapp_ios_browser")||navigator.userAgent.toLowerCase().includes("crios")},isChrome:function e(){return navigator.userAgent.toLowerCase().includes("chrome")},isFirefox:function e(){return navigator.userAgent.toLowerCase().includes("firefox")},isIe:function e(){return navigator.userAgent.match(/(Trident\/|MSIE\/)/)!==null},findParent:function e(t,n){var i=n instanceof HTMLElement;if(!n||typeof n!=="string"&&!i){return null}for(;t&&t!==document;t=t.parentNode){if(typeof n==="string"){if(t.classList.contains(n)){return t}}else if(i){if(t===n){return t}}}return null}},platform:{isMac:function e(){return navigator.userAgent.toLowerCase().includes("macintosh")},isLinux:function e(){return navigator.userAgent.toLowerCase().includes("linux")},isWindows:function e(){return navigator.userAgent.toLowerCase().includes("windows")||!this.isMac()&&!this.isLinux()},isBitrixMobile:function e(){return navigator.userAgent.toLowerCase().includes("bitrixmobile")},isBitrixDesktop:function e(){return navigator.userAgent.toLowerCase().includes("bitrixdesktop")},getDesktopVersion:function e(){if(typeof this.getDesktopVersionStatic!=="undefined"){return this.getDesktopVersionStatic}if(typeof BXDesktopSystem==="undefined"){return 0}var t=BXDesktopSystem.GetProperty("versionParts");this.getDesktopVersionStatic=t[3];return this.getDesktopVersionStatic},isMobile:function e(){return this.isAndroid()||this.isIos()||this.isBitrixMobile()},isIos:function e(){return navigator.userAgent.toLowerCase().includes("iphone")||navigator.userAgent.toLowerCase().includes("ipad")},getIosVersion:function e(){if(!this.isIos()){return null}var t=navigator.userAgent.toLowerCase().match(/(iphone|ipad)(.+)(OS\s([0-9]+)([_.]([0-9]+))?)/i);if(!t||!t[4]){return null}return parseFloat(t[4]+"."+(t[6]?t[6]:0))},isAndroid:function e(){return navigator.userAgent.toLowerCase().includes("android")},openNewPage:function e(t){if(!t){return false}if(this.isBitrixMobile()){if(typeof BX.MobileTools!=="undefined"){var n=BX.MobileTools.resolveOpenFunction(t);if(n){n();return true}}app.openNewPage(t)}else{window.open(t,"_blank")}return true}},device:{isDesktop:function e(){return!this.isMobile()},isMobile:function e(){if(typeof this.isMobileStatic!=="undefined"){return this.isMobileStatic}this.isMobileStatic=navigator.userAgent.toLowerCase().includes("android")||navigator.userAgent.toLowerCase().includes("webos")||navigator.userAgent.toLowerCase().includes("iphone")||navigator.userAgent.toLowerCase().includes("ipad")||navigator.userAgent.toLowerCase().includes("ipod")||navigator.userAgent.toLowerCase().includes("blackberry")||navigator.userAgent.toLowerCase().includes("windows phone");return this.isMobileStatic},orientationHorizontal:"horizontal",orientationPortrait:"portrait",getOrientation:function e(){if(!this.isMobile()){return this.orientationHorizontal}return Math.abs(window.orientation)===0?this.orientationPortrait:this.orientationHorizontal}},types:{isString:function e(t){return t===""?true:t?typeof t=="string"||t instanceof String:false},isArray:function e(t){return t&&Object.prototype.toString.call(t)=="[object Array]"},isFunction:function e(t){return t===null?false:typeof t=="function"||t instanceof Function},isDomNode:function e(t){return t&&babelHelpers["typeof"](t)=="object"&&"nodeType"in t},isDate:function e(t){return t&&Object.prototype.toString.call(t)=="[object Date]"},isPlainObject:function e(t){if(!t||babelHelpers["typeof"](t)!=="object"||t.nodeType){return false}var n=Object.prototype.hasOwnProperty;try{if(t.constructor&&!n.call(t,"constructor")&&!n.call(t.constructor.prototype,"isPrototypeOf")){return false}}catch(e){return false}var i;return typeof i==="undefined"||n.call(t,i)},isUuidV4:function e(t){if(!this.isString(t)){return false}var n=new RegExp(/^[0-9A-F]{8}-[0-9A-F]{4}-4[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i);return t.search(n)===0}},dialog:{getChatIdByDialogId:function e(t){if(!this.isChatId(t)){return 0}return parseInt(t.toString().substr(4))},isChatId:function e(t){return t.toString().startsWith("chat")},isEmptyDialogId:function e(t){if(!t){return true}if(typeof t==="string"){if(t==="chat0"||t==="0"){return true}}return false}},text:{quote:function e(t,n){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var r=arguments.length>3&&arguments[3]!==undefined?arguments[3]:null;if(typeof t!=="string"){return t.toString()}if(!r){r=BX.message}t=t.replace(/\[USER=([0-9]{1,})](.*?)\[\/USER]/gi,(function(e,t,n){return n}));t=t.replace(/\[CHAT=(imol\|)?([0-9]{1,})](.*?)[\/CHAT]/gi,(function(e,t,n,i){return i}));t=t.replace(/\[CALL(?:=(.+?))?](.+?)?\[\/CALL]/gi,(function(e,t,n){return n?n:t}));t=t.replace(/\[ATTACH=([0-9]{1,})]/gi,(function(e,t,n){return t===1e4?"":"["+r["IM_UTILS_TEXT_ATTACH"]+"] "}));t=t.replace(/\[RATING=([1-5]{1})]/gi,(function(e,t){return"["+r.IM_F_RATING+"] "}));t=t.replace(/&nbsp;/gi," ");t=t.replace(/\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D([\s\S]*?)\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D/gim,"["+r["IM_UTILS_TEXT_QUOTE"]+"]");t=t.replace(/^(>>(.*)\n)/gi,"["+r["IM_UTILS_TEXT_QUOTE"]+"]\n");if(n&&n.FILE_ID&&n.FILE_ID.length>0){var s=[];n.FILE_ID.forEach((function(e){if(i[e].type==="image"){s.push(r["IM_UTILS_TEXT_IMAGE"])}else if(i[e].type==="audio"){s.push(r["IM_UTILS_TEXT_AUDIO"])}else if(i[e].type==="video"){s.push(r["IM_UTILS_TEXT_VIDEO"])}else{s.push(i[e].name)}}));if(s.length<=0){s.push(r["IM_UTILS_TEXT_FILE"])}t=s.join("\n")+t}else if(n&&n.ATTACH&&n.ATTACH.length>0){t="["+r["IM_UTILS_TEXT_ATTACH"]+"]\n"+t}if(t.length<=0){t=r["IM_UTILS_TEXT_DELETED"]}return t.trim()},purify:function e(t,n){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var r=arguments.length>3&&arguments[3]!==undefined?arguments[3]:null;if(typeof t!=="string"){return t.toString()}if(!r){r=BX.message}t=t.trim();if(t.startsWith("/me")){t=t.substr(4)}else if(t.startsWith("/loud")){t=t.substr(6)}t=t.replace(/<br><br \/>/gi,"<br />");t=t.replace(/<br \/><br>/gi,"<br />");var s=[];t=t.replace(/\[CODE\]\n?([\0-\uFFFF]*?)\[\/CODE\]/gi,(function(e,t){var n=s.length;s.push(t);return"####REPLACEMENT_CODE_"+n+"####"}));t=t.replace(/\[PUT(?:=(?:.+?))?\](?:.+?)?\[\/PUT]/gi,(function(e){return e.replace(/\[PUT(?:=(.+))?\](.+?)?\[\/PUT]/gi,(function(e,t,n){return n?n:t}))}));t=t.replace(/\[SEND(?:=(?:.+?))?\](?:.+?)?\[\/SEND]/gi,(function(e){return e.replace(/\[SEND(?:=(.+))?\](.+?)?\[\/SEND]/gi,(function(e,t,n){return n?n:t}))}));t=t.replace(/\[[buis]](.*?)\[\/[buis]]/gi,"$1");t=t.replace(/\[url](.*?)\[\/url]/gi,"$1");t=t.replace(/\[RATING=([1-5]{1})]/gi,(function(){return"["+r["IM_UTILS_TEXT_RATING"]+"] "}));t=t.replace(/\[ATTACH=([0-9]{1,})]/gi,(function(){return"["+r["IM_UTILS_TEXT_ATTACH"]+"] "}));t=t.replace(/\[USER=([0-9]{1,})](.*?)\[\/USER]/gi,"$2");t=t.replace(/\[CHAT=([0-9]{1,})](.*?)\[\/CHAT]/gi,"$2");t=t.replace(/\[SEND(?:=(?:.+?))?\](.+?)?\[\/SEND]/gi,"$1");t=t.replace(/\[PUT(?:=(?:.+?))?\](.+?)?\[\/PUT]/gi,"$1");t=t.replace(/\[CALL=(.*?)](.*?)\[\/CALL\]/gi,"$2");t=t.replace(/\[PCH=([0-9]{1,})](.*?)\[\/PCH]/gi,"$2");t=t.replace(/<img.*?data-code="([^"]*)".*?>/gi,"$1");t=t.replace(/<span.*?title="([^"]*)".*?>.*?<\/span>/gi,"($1)");t=t.replace(/<img.*?title="([^"]*)".*?>/gi,"($1)");t=t.replace(/\[ATTACH=([0-9]{1,})]/gi,(function(e,t,n){return t===1e4?"":"["+r["IM_UTILS_TEXT_ATTACH"]+"] "}));t=t.replace(/<s>([^"]*)<\/s>/gi," ");t=t.replace(/\[s]([^"]*)\[\/s]/gi," ");t=t.replace(/\[icon=([^\]]*)]/gi,(function(e){var t=e.match(/title=(.*[^\s\]])/i);if(t&&t[1]){t=t[1];if(t.indexOf("width=")>-1){t=t.substr(0,t.indexOf("width="))}if(t.indexOf("height=")>-1){t=t.substr(0,t.indexOf("height="))}if(t.indexOf("size=")>-1){t=t.substr(0,t.indexOf("size="))}if(t){t="("+t.trim()+")"}}else{t="("+r["IM_UTILS_TEXT_ICON"]+")"}return t}));s.forEach((function(e,n){t=t.replace("####REPLACEMENT_CODE_"+n+"####",e)}));t=t.replace(/\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D([\s\S]*?)\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D\x2D/gim,"["+r["IM_UTILS_TEXT_QUOTE"]+"] ");t=t.replace(/^(>>(.*)(\n)?)/gim,"["+r["IM_UTILS_TEXT_QUOTE"]+"] ");t=t.replace(/<\/?[^>]+>/gi,"");if(n&&n.FILE_ID&&n.FILE_ID.length>0){var o=[];if(babelHelpers["typeof"](i)==="object"){n.FILE_ID.forEach((function(e){if(typeof i[e]==="undefined");else if(i[e].type==="image"){o.push(r["IM_UTILS_TEXT_IMAGE"])}else if(i[e].type==="audio"){o.push(r["IM_UTILS_TEXT_AUDIO"])}else if(i[e].type==="video"){o.push(r["IM_UTILS_TEXT_VIDEO"])}else{o.push(i[e].name)}}))}if(o.length<=0){o.push(r["IM_UTILS_TEXT_FILE"])}t=o.join(" ")+t}else if(n&&(n.WITH_ATTACH||n.ATTACH&&n.ATTACH.length>0)){t="["+r["IM_UTILS_TEXT_ATTACH"]+"] "+t}else if(n&&n.WITH_FILE){t="["+r["IM_UTILS_TEXT_FILE"]+"] "+t}if(t.length<=0){t=r["IM_UTILS_TEXT_DELETED"]}return t.replace("\n"," ").trim()},htmlspecialchars:function e(t){if(typeof t!=="string"){return t}return t.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},htmlspecialcharsback:function e(t){if(typeof t!=="string"){return t}return t.replace(/\&quot;/g,'"').replace(/&#039;/g,"'").replace(/\&lt;/g,"<").replace(/\&gt;/g,">").replace(/\&amp;/g,"&").replace(/\&nbsp;/g," ")},getLocalizeForNumber:function e(t,n){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:"en";var r=arguments.length>3&&arguments[3]!==undefined?arguments[3]:null;if(!r){r=BX.message}var s=1;n=parseInt(n);if(n<0){n=n*-1}if(i){switch(i){case"de":case"en":s=n!==1?1:0;break;case"ru":case"ua":s=n%10===1&&n%100!==11?0:n%10>=2&&n%10<=4&&(n%100<10||n%100>=20)?1:2;break}}return r[t+"_PLURAL_"+s]}},date:{getFormatType:function e(){var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:t.DateFormat["default"];var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;if(!i){i=BX.message}var r=[];if(n===t.DateFormat.groupTitle){r=[["tommorow","tommorow"],["today","today"],["yesterday","yesterday"],["",i["IM_UTILS_FORMAT_DATE"]]]}else if(n===t.DateFormat.message){r=[["",i["IM_UTILS_FORMAT_TIME"]]]}else if(n===t.DateFormat.recentTitle){r=[["tommorow","today"],["today","today"],["yesterday","yesterday"],["",i["IM_UTILS_FORMAT_DATE_RECENT"]]]}else if(n===t.DateFormat.recentLinesTitle){r=[["tommorow","tommorow"],["today","today"],["yesterday","yesterday"],["",i["IM_UTILS_FORMAT_DATE_RECENT"]]]}else if(n===t.DateFormat.readedTitle){r=[["tommorow","tommorow, "+i["IM_UTILS_FORMAT_TIME"]],["today","today, "+i["IM_UTILS_FORMAT_TIME"]],["yesterday","yesterday, "+i["IM_UTILS_FORMAT_TIME"]],["",i["IM_UTILS_FORMAT_READED"]]]}else if(n===t.DateFormat.vacationTitle){r=[["",i["IM_UTILS_FORMAT_DATE_SHORT"]]]}else{r=[["tommorow","tommorow, "+i["IM_UTILS_FORMAT_TIME"]],["today","today, "+i["IM_UTILS_FORMAT_TIME"]],["yesterday","yesterday, "+i["IM_UTILS_FORMAT_TIME"]],["",i["IM_UTILS_FORMAT_DATE_TIME"]]]}return r},getDateFunction:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;if(this.dateFormatFunction){return this.dateFormatFunction}this.dateFormatFunction=Object.create(BX.Main.Date);if(t){this.dateFormatFunction._getMessage=function(e){return t[e]}}return this.dateFormatFunction},format:function e(n){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;if(!e){e=this.getFormatType(t.DateFormat["default"],i)}return this.getDateFunction(i).format(e,n)},cast:function e(t){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:new Date;var i=n;if(t instanceof Date){i=t}else if(typeof t==="string"){i=new Date(t)}else if(typeof t==="number"){i=new Date(t*1e3)}if(i instanceof Date&&Number.isNaN(i.getTime())){i=n}return i}},object:{countKeys:function e(t){var n=0;for(var i in t){if(t.hasOwnProperty(i)){n++}}return n}},user:{getLastDateText:function e(i){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;if(!i){return""}var s=n.date.getDateFunction(r);if(!r){r=BX.message||{}}var o="";var a={};if(i.bot||i.network){o=""}else if(i.absent&&!this.isMobileActive(i,r)){a=this.getOnlineStatus(i,r);o=r["IM_STATUS_VACATION_TITLE"].replace("#DATE#",s.format(n.date.getFormatType(t.DateFormat.vacationTitle,r),i.absent.getTime()/1e3));if(a.isOnline&&i.idle){o=r["IM_STATUS_AWAY_TITLE"].replace("#TIME#",this.getIdleText(i,r))+". "+o}else if(a.isOnline&&!a.lastSeenText){o=a.statusText+". "+o}else if(a.lastSeenText){if(!n.platform.isMobile()){o=o+". "+r["IM_LAST_SEEN_"+(i.gender==="F"?"F":"M")].replace("#POSITION#",o).replace("#LAST_SEEN#",a.lastSeenText)}}}else if(i.lastActivityDate){a=this.getOnlineStatus(i,r);if(a.isOnline&&i.idle&&!this.isMobileActive(i,r)){o=r["IM_STATUS_AWAY_TITLE"].replace("#TIME#",this.getIdleText(i,r))}else if(a.isOnline&&!a.lastSeenText){if(n.platform.isMobile()&&this.isMobileActive(i,r)){o=r["IM_STATUS_MOBILE"]}else{o=a.statusText}}else if(a.lastSeenText){if(n.platform.isMobile()){o=r["IM_LAST_SEEN_SHORT_"+(i.gender==="F"?"F":"M")].replace("#LAST_SEEN#",a.lastSeenText)}else{o=r["IM_LAST_SEEN_"+(i.gender==="F"?"F":"M")].replace("#POSITION#",o).replace("#LAST_SEEN#",a.lastSeenText)}}}return o},getIdleText:function e(t){var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;if(!t){return""}if(!t.idle){return""}return n.date.getDateFunction(i).format([["s60","sdiff"],["i60","idiff"],["H24","Hdiff"],["","ddiff"]],t.idle)},getOnlineStatus:function e(t){var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;var r={isOnline:false,status:"offline",statusText:i?i.IM_STATUS_OFFLINE:"offline",lastSeen:t.lastActivityDate,lastSeenText:""};if(!t.lastActivityDate||t.lastActivityDate.getTime()===0){return r}var s=new Date;r.isOnline=s.getTime()-t.lastActivityDate.getTime()<=this.getOnlineLimit(i)*1e3;r.status=r.isOnline?t.status:"offline";r.statusText=i&&i["IM_STATUS_"+r.status.toUpperCase()]?i["IM_STATUS_"+r.status.toUpperCase()]:r.status;if(i&&t.lastActivityDate.getTime()>0&&s.getTime()-t.lastActivityDate.getTime()>300*1e3){r.lastSeenText=n.date.getDateFunction(i).formatLastActivityDate(t.lastActivityDate)}return r},isMobileActive:function e(t){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;if(!t){return false}if(!n){n=BX.message||{}}return t.mobileLastDate&&new Date-t.mobileLastDate<this.getOnlineLimit(n)*1e3&&t.lastActivityDate-t.mobileLastDate<300*1e3},getOnlineLimit:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;if(!t){t=BX.message||{}}return t.LIMIT_ONLINE?parseInt(t.LIMIT_ONLINE):15*60}},isDarkColor:function e(t){if(!t||!t.match(/^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/)){return false}if(t.length===4){t=t.replace(/#([A-Fa-f0-9])/gi,"$1$1")}else{t=t.replace(/#([A-Fa-f0-9])/gi,"$1")}t=t.toLowerCase();var n=["#17a3ea","#00aeef","#00c4fb","#47d1e2","#75d900","#ffab00","#ff5752","#468ee5","#1eae43"];if(n.includes("#"+t)){return true}var i=parseInt(t,16);var r=i>>16&255;var s=i>>8&255;var o=i&255;var a=(r*299+s*587+o*114)/1e3;return a<128},hashCode:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"";var n=0;if(babelHelpers["typeof"](t)==="object"&&t){t=JSON.stringify(t)}else if(typeof t!=="string"){t=t.toString()}if(typeof t!=="string"){return n}for(var i=0;i<t.length;i++){var r=t.charCodeAt(i);n=(n<<5)-n+r;n=n&n}return n},versionCompare:function e(t,n){var i=/^([\d+\.]+)$/;if(!i.test(t)||!i.test(n)){return NaN}t=t.toString().split(".");n=n.toString().split(".");if(t.length<n.length){while(t.length<n.length){t.push(0)}}else if(n.length<t.length){while(n.length<t.length){n.push(0)}}for(var r=0;r<t.length;r++){if(t[r]>n[r]){return 1}else if(t[r]<n[r]){return-1}}return 0},throttle:function e(t,n){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:this;var r=null;var s=null;var o=function e(){t.apply(i,s);r=null};return function(){if(!r){s=arguments;r=setTimeout(o,n)}}},debounce:function e(t,n){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:this;var r=null;var s=null;var o=function e(){t.apply(i,s)};return function(){s=arguments;clearTimeout(r);r=setTimeout(o,n)}},getLogTrackingParams:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var n=[];var i=t.name,r=i===void 0?"tracking":i,s=t.data,o=s===void 0?[]:s,a=t.dialog,l=a===void 0?null:a,u=t.message,c=u===void 0?null:u,f=t.files,d=f===void 0?null:f;r=encodeURIComponent(r);if(o&&!(o instanceof Array)&&babelHelpers["typeof"](o)==="object"){var h=[];for(var p in o){if(o.hasOwnProperty(p)){h.push(encodeURIComponent(p)+"="+encodeURIComponent(o[p]))}}o=h}else if(!o instanceof Array){o=[]}if(l){n.push("timType="+l.type);if(l.type==="lines"){n.push("timLinesType="+l.entityId.split("|")[0])}}if(d){var m="file";if(d instanceof Array&&d[0]){m=d[0].type}else{m=d.type}n.push("timMessageType="+m)}else if(c){n.push("timMessageType=text")}if(this.platform.isBitrixMobile()){n.push("timDevice=bitrixMobile")}else if(this.platform.isBitrixDesktop()){n.push("timDevice=bitrixDesktop")}else if(this.platform.isIos()||this.platform.isAndroid()){n.push("timDevice=mobile")}else{n.push("timDevice=web")}return r+(o.length?"&"+o.join("&"):"")+(n.length?"&"+n.join("&"):"")}};e.Utils=n})(this.BX.Messenger.Lib=this.BX.Messenger.Lib||{},BX.Messenger.Const);this.BX=this.BX||{};this.BX.Messenger=this.BX.Messenger||{};(function(e,t,n,i,r,s,o,a){"use strict";var l=function(e){babelHelpers.inherits(t,e);function t(){babelHelpers.classCallCheck(this,t);return babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).apply(this,arguments))}babelHelpers.createClass(t,[{key:"getName",value:function e(){return"application"}},{key:"getState",value:function e(){return{common:{host:this.getVariable("common.host",location.protocol+"//"+location.host),siteId:this.getVariable("common.siteId","default"),userId:this.getVariable("common.userId",0),languageId:this.getVariable("common.languageId","en")},dialog:{dialogId:this.getVariable("dialog.dialogId","0"),chatId:this.getVariable("dialog.chatId",0),diskFolderId:this.getVariable("dialog.diskFolderId",0),messageLimit:this.getVariable("dialog.messageLimit",20),enableReadMessages:this.getVariable("dialog.enableReadMessages",true),messageExtraCount:0},disk:{enabled:false,maxFileSize:5242880},call:{serverEnabled:false,maxParticipants:24},mobile:{keyboardShow:false},device:{type:this.getVariable("device.type",a.DeviceType.desktop),orientation:this.getVariable("device.orientation",a.DeviceOrientation.portrait)},options:{quoteEnable:this.getVariable("options.quoteEnable",true),quoteFromRight:this.getVariable("options.quoteFromRight",true),autoplayVideo:this.getVariable("options.autoplayVideo",true),darkBackground:this.getVariable("options.darkBackground",false),showSmiles:false},error:{active:false,code:"",description:""}}}},{key:"getStateSaveException",value:function e(){return Object.assign({common:this.getVariable("saveException.common",null),dialog:this.getVariable("saveException.dialog",null),mobile:this.getVariable("saveException.mobile",null),device:this.getVariable("saveException.device",null),error:this.getVariable("saveException.error",null)})}},{key:"getActions",value:function e(){var t=this;return{set:function e(n,i){n.commit("set",t.validate(i))},showSmiles:function e(t,n){t.commit("showSmiles")},hideSmiles:function e(t,n){t.commit("hideSmiles")}}}},{key:"getMutations",value:function e(){var t=this;return{set:function e(n,i){var r=false;for(var s in i){if(!i.hasOwnProperty(s)){continue}for(var o in i[s]){if(!i[s].hasOwnProperty(o)){continue}n[s][o]=i[s][o];r=true}}if(r&&t.isSaveNeeded(i)){t.saveState(n)}},increaseDialogExtraCount:function e(t){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var i=n.count,r=i===void 0?1:i;t.dialog.messageExtraCount+=r},decreaseDialogExtraCount:function e(t){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var i=n.count,r=i===void 0?1:i;var s=t.dialog.messageExtraCount-r;if(s<=0){s=0}t.dialog.messageExtraCount=s},clearDialogExtraCount:function e(t){t.dialog.messageExtraCount=0},showSmiles:function e(t){t.options.showSmiles=true},hideSmiles:function e(t){t.options.showSmiles=false}}}},{key:"validate",value:function e(t){var n={};if(babelHelpers["typeof"](t.common)==="object"&&t.common){n.common={};if(typeof t.common.userId==="number"){n.common.userId=t.common.userId}if(typeof t.common.languageId==="string"){n.common.languageId=t.common.languageId}}if(babelHelpers["typeof"](t.dialog)==="object"&&t.dialog){n.dialog={};if(typeof t.dialog.dialogId==="number"){n.dialog.dialogId=t.dialog.dialogId.toString();n.dialog.chatId=0}else if(typeof t.dialog.dialogId==="string"){n.dialog.dialogId=t.dialog.dialogId;if(typeof t.dialog.chatId!=="number"){var i=t.dialog.dialogId;if(i.startsWith("chat")){i=t.dialog.dialogId.substr(4)}i=parseInt(i);n.dialog.chatId=!isNaN(i)?i:0;t.dialog.chatId=n.dialog.chatId}}if(typeof t.dialog.chatId==="number"){n.dialog.chatId=t.dialog.chatId}if(typeof t.dialog.diskFolderId==="number"){n.dialog.diskFolderId=t.dialog.diskFolderId}if(typeof t.dialog.messageLimit==="number"){n.dialog.messageLimit=t.dialog.messageLimit}if(typeof t.dialog.messageExtraCount==="number"){n.dialog.messageExtraCount=t.dialog.messageExtraCount}if(typeof t.dialog.enableReadMessages==="boolean"){n.dialog.enableReadMessages=t.dialog.enableReadMessages}}if(babelHelpers["typeof"](t.disk)==="object"&&t.disk){n.disk={};if(typeof t.disk.enabled==="boolean"){n.disk.enabled=t.disk.enabled}if(typeof t.disk.maxFileSize==="number"){n.disk.maxFileSize=t.disk.maxFileSize}}if(babelHelpers["typeof"](t.call)==="object"&&t.call){n.call={};if(typeof t.call.serverEnabled==="boolean"){n.call.serverEnabled=t.call.serverEnabled}if(typeof t.call.maxParticipants==="number"){n.call.maxParticipants=t.call.maxParticipants}}if(babelHelpers["typeof"](t.mobile)==="object"&&t.mobile){n.mobile={};if(typeof t.mobile.keyboardShow==="boolean"){n.mobile.keyboardShow=t.mobile.keyboardShow}}if(babelHelpers["typeof"](t.device)==="object"&&t.device){n.device={};if(typeof t.device.type==="string"&&typeof a.DeviceType[t.device.type]!=="undefined"){n.device.type=t.device.type}if(typeof t.device.orientation==="string"&&typeof a.DeviceOrientation[t.device.orientation]!=="undefined"){n.device.orientation=t.device.orientation}}if(babelHelpers["typeof"](t.error)==="object"&&t.error){if(typeof t.error.active==="boolean"){n.error={active:t.error.active,code:t.error.code.toString()||"",description:t.error.description.toString()||""}}}return n}}]);return t}(s.WidgetVuexBuilderModel);var u=function(e){babelHelpers.inherits(t,e);function t(){babelHelpers.classCallCheck(this,t);return babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).apply(this,arguments))}babelHelpers.createClass(t,[{key:"getName",value:function e(){return"conference"}},{key:"getState",value:function e(){return{common:{inited:false,passChecked:true,showChat:false,userCount:0,messageCount:0,userInCallCount:0,state:a.ConferenceStateType.preparation,callEnded:false,showSmiles:false,error:"",conferenceTitle:"",alias:"",permissionsRequested:false,conferenceStarted:null,conferenceStartDate:null,joinWithVideo:null,userReadyToJoin:false,isBroadcast:false,users:[],usersInCall:[],presenters:[],rightPanelMode:a.ConferenceRightPanelMode.hidden},user:{id:-1,hash:""}}}},{key:"getActions",value:function e(){return{showChat:function e(t,n){if(typeof n.newState!=="boolean"){return false}t.commit("showChat",n)},changeRightPanelMode:function e(t,n){if(!a.ConferenceRightPanelMode[n.mode]){return false}t.commit("changeRightPanelMode",n)},setPermissionsRequested:function e(t,n){if(typeof n.status!=="boolean"){return false}t.commit("setPermissionsRequested",n)},setPresenters:function e(t,n){if(!Array.isArray(n.presenters)){n.presenters=[n.presenters]}t.commit("setPresenters",n)},setUsers:function e(t,n){if(!Array.isArray(n.users)){n.users=[n.users]}t.commit("setUsers",n)},removeUsers:function e(t,n){if(!Array.isArray(n.users)){n.users=[n.users]}t.commit("removeUsers",n)},setUsersInCall:function e(t,n){if(!Array.isArray(n.users)){n.users=[n.users]}t.commit("setUsersInCall",n)},removeUsersInCall:function e(t,n){if(!Array.isArray(n.users)){n.users=[n.users]}t.commit("removeUsersInCall",n)},setConferenceTitle:function e(t,n){if(typeof n.conferenceTitle!=="string"){return false}t.commit("setConferenceTitle",n)},setBroadcastMode:function e(t,n){if(typeof n.broadcastMode!=="boolean"){return false}t.commit("setBroadcastMode",n)}}}},{key:"getMutations",value:function e(){var t=this;return{common:function e(t,n){if(typeof n.inited==="boolean"){t.common.inited=n.inited}if(typeof n.passChecked==="boolean"){t.common.passChecked=n.passChecked}if(typeof n.userCount==="number"||typeof n.userCount==="string"){t.common.userCount=parseInt(n.userCount)}if(typeof n.messageCount==="number"||typeof n.messageCount==="string"){t.common.messageCount=parseInt(n.messageCount)}if(typeof n.userInCallCount==="number"||typeof n.userInCallCount==="string"){t.common.userInCallCount=parseInt(n.userInCallCount)}if(typeof n.componentError==="string"){t.common.componentError=n.componentError}if(typeof n.isBroadcast==="boolean"){t.common.isBroadcast=n.isBroadcast}if(Array.isArray(n.presenters)){t.common.presenters=n.presenters}},user:function e(n,i){if(typeof i.id==="number"){n.user.id=i.id}if(typeof i.hash==="string"&&i.hash!==n.user.hash){n.user.hash=i.hash}if(t.isSaveNeeded({user:i})){t.saveState(n)}},showChat:function e(t,n){var i=n.newState;t.common.showChat=i},changeRightPanelMode:function e(t,n){var i=n.mode;t.common.rightPanelMode=i},setPermissionsRequested:function e(t,n){t.common.permissionsRequested=n.status},startCall:function e(t,n){t.common.state=a.ConferenceStateType.call;t.common.callEnded=false},endCall:function e(t,n){t.common.state=a.ConferenceStateType.preparation;t.common.callEnded=true},returnToPreparation:function e(t,n){t.common.state=a.ConferenceStateType.preparation},toggleSmiles:function e(t,n){t.common.showSmiles=!t.common.showSmiles},setError:function e(t,n){if(typeof n.errorCode==="string"){t.common.error=n.errorCode}},setConferenceTitle:function e(t,n){t.common.conferenceTitle=n.conferenceTitle},setBroadcastMode:function e(t,n){t.common.isBroadcast=n.broadcastMode},setAlias:function e(t,n){if(typeof n.alias==="string"){t.common.alias=n.alias}},setJoinType:function e(t,n){if(typeof n.joinWithVideo==="boolean"){t.common.joinWithVideo=n.joinWithVideo}},setConferenceStatus:function e(t,n){if(typeof n.conferenceStarted==="boolean"){t.common.conferenceStarted=n.conferenceStarted}},setConferenceStartDate:function e(t,n){if(n.conferenceStartDate instanceof Date){t.common.conferenceStartDate=n.conferenceStartDate}},setUserReadyToJoin:function e(t,n){t.common.userReadyToJoin=true},setPresenters:function e(t,n){if(n.replace){t.common.presenters=n.presenters}else{n.presenters.forEach((function(e){e=parseInt(e);if(!t.common.presenters.includes(e)){t.common.presenters.push(e)}}))}},setUsers:function e(t,n){n.users.forEach((function(e){e=parseInt(e);if(!t.common.users.includes(e)){t.common.users.push(e)}}))},removeUsers:function e(t,n){t.common.users=t.common.users.filter((function(e){return!n.users.includes(parseInt(e))}))},setUsersInCall:function e(t,n){n.users.forEach((function(e){e=parseInt(e);if(!t.common.usersInCall.includes(e)){t.common.usersInCall.push(e)}}))},removeUsersInCall:function e(t,n){t.common.usersInCall=t.common.usersInCall.filter((function(e){return!n.users.includes(parseInt(e))}))}}}},{key:"getStateSaveException",value:function e(){return{common:{inited:null,state:null,showSmiles:null,userCount:null,messageCount:null,userInCallCount:null,error:null,conferenceTitle:null,alias:null,conferenceStarted:null,conferenceStartDate:null,joinWithVideo:null,userReadyToJoin:null,rightPanelMode:null,presenters:null,users:null}}}}]);return t}(s.WidgetVuexBuilderModel);function c(e,t){var n=typeof Symbol!=="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=f(e))||t&&e&&typeof e.length==="number"){if(n)e=n;var i=0;var r=function e(){};return{s:r,n:function t(){if(i>=e.length)return{done:true};return{done:false,value:e[i++]}},e:function e(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s=true,o=false,a;return{s:function t(){n=n.call(e)},n:function e(){var t=n.next();s=t.done;return t},e:function e(t){o=true;a=t},f:function e(){try{if(!s&&n["return"]!=null)n["return"]()}finally{if(o)throw a}}}}function f(e,t){if(!e)return;if(typeof e==="string")return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor)n=e.constructor.name;if(n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return d(e,t)}function d(e,t){if(t==null||t>e.length)t=e.length;for(var n=0,i=new Array(t);n<t;n++){i[n]=e[n]}return i}var h={empty:"empty",equal:"equal",none:"none",found:"found",foundReverse:"foundReverse"};var p=function(e){babelHelpers.inherits(s,e);function s(){babelHelpers.classCallCheck(this,s);return babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(s).apply(this,arguments))}babelHelpers.createClass(s,[{key:"getName",value:function e(){return"messages"}},{key:"getState",value:function e(){return{created:0,collection:{},mutationType:{},saveMessageList:{},saveFileList:{},saveUserList:{},host:this.getVariable("host",location.protocol+"//"+location.host)}}},{key:"getElementState",value:function e(){return{templateId:0,templateType:"message",placeholderType:0,id:0,chatId:0,authorId:0,date:new Date,text:"",textConverted:"",params:{TYPE:"default",COMPONENT_ID:"bx-im-view-message"},push:false,unread:false,sending:false,error:false,retry:false,blink:false}}},{key:"getGetters",value:function e(){var t=this;return{getMutationType:function e(t){return function(e){if(!t.mutationType[e]){return{initialType:a.MutationType.none,appliedType:a.MutationType.none}}return t.mutationType[e]}},getLastId:function e(t){return function(e){if(!t.collection[e]||t.collection[e].length<=0){return null}var n=0;for(var i=0;i<t.collection[e].length;i++){var r=t.collection[e][i];if(r.push||r.sending||r.id.toString().startsWith("temporary")){continue}if(n<r.id){n=r.id}}return n?n:null}},getMessage:function e(t){return function(e,n){if(!t.collection[e]||t.collection[e].length<=0){return null}for(var i=t.collection[e].length-1;i>=0;i--){if(t.collection[e][i].id===n){return t.collection[e][i]}}return null}},get:function e(t){return function(e){if(!t.collection[e]||t.collection[e].length<=0){return[]}return t.collection[e]}},getBlank:function e(n){return function(e){return t.getElementState()}},getSaveFileList:function e(t){return function(e){return t.saveFileList}},getSaveUserList:function e(t){return function(e){return t.saveUserList}}}}},{key:"getActions",value:function e(){var t=this;return{add:function e(n,i){var r=t.validate(Object.assign({},i));r.params=Object.assign({},t.getElementState().params,r.params);if(i.id){if(n.state.collection[i.chatId]){var s=n.state.collection[i.chatId].length-1;for(var o=s;o>=0;o--){var a=n.state.collection[i.chatId][o];if(a.templateId===i.id){return}}}r.id=i.id}else{r.id="temporary"+(new Date).getTime()+n.state.created}r.templateId=r.id;r.unread=false;n.commit("add",Object.assign({},t.getElementState(),r));if(i.sending!==false){n.dispatch("actionStart",{id:r.id,chatId:r.chatId})}return r.id},actionStart:function e(t,n){if(/^\d+$/.test(n.id)){n.id=parseInt(n.id)}n.chatId=parseInt(n.chatId);r.WidgetVue.nextTick((function(){t.commit("update",{id:n.id,chatId:n.chatId,fields:{sending:true}})}))},actionError:function e(t,n){if(/^\d+$/.test(n.id)){n.id=parseInt(n.id)}n.chatId=parseInt(n.chatId);r.WidgetVue.nextTick((function(){t.commit("update",{id:n.id,chatId:n.chatId,fields:{sending:false,error:true,retry:n.retry!==false}})}))},actionFinish:function e(t,n){if(/^\d+$/.test(n.id)){n.id=parseInt(n.id)}n.chatId=parseInt(n.chatId);r.WidgetVue.nextTick((function(){t.commit("update",{id:n.id,chatId:n.chatId,fields:{sending:false,error:false,retry:false}})}))},set:function e(n,i){if(i instanceof Array){i=i.map((function(e){return t.prepareMessage(e,{host:n.state.host})}))}else{var r=t.prepareMessage(i,{host:n.state.host});(i=[]).push(r)}n.commit("set",{insertType:a.MutationType.set,data:i});return"set is done"},addPlaceholders:function e(n,i){if(i.placeholders instanceof Array){i.placeholders=i.placeholders.map((function(e){return t.prepareMessage(e,{host:n.state.host})}))}else{return false}var r=i.requestMode==="history"?a.MutationType.setBefore:a.MutationType.setAfter;if(r===a.MutationType.setBefore){i.placeholders=i.placeholders.reverse()}n.commit("set",{insertType:r,data:i.placeholders});return i.placeholders[0].id},clearPlaceholders:function e(t,n){t.commit("clearPlaceholders",n)},updatePlaceholders:function e(n,i){if(i.data instanceof Array){i.data=i.data.map((function(e){return t.prepareMessage(e,{host:n.state.host})}))}else{return false}n.commit("updatePlaceholders",i);return true},setAfter:function e(n,i){if(i instanceof Array){i=i.map((function(e){return t.prepareMessage(e)}))}else{var r=t.prepareMessage(i);(i=[]).push(r)}n.commit("set",{insertType:a.MutationType.setAfter,data:i})},setBefore:function e(n,i){if(i instanceof Array){i=i.map((function(e){return t.prepareMessage(e)}))}else{var r=t.prepareMessage(i);(i=[]).push(r)}n.commit("set",{insertType:a.MutationType.setBefore,data:i})},update:function e(n,i){if(/^\d+$/.test(i.id)){i.id=parseInt(i.id)}if(/^\d+$/.test(i.chatId)){i.chatId=parseInt(i.chatId)}n.commit("initCollection",{chatId:i.chatId});if(!n.state.collection[i.chatId]){return false}var r=n.state.collection[i.chatId].findIndex((function(e){return e.id===i.id}));if(r<0){return false}var s=t.validate(Object.assign({},i.fields));if(s.params){s.params=Object.assign({},t.getElementState().params,n.state.collection[i.chatId][r].params,s.params)}n.commit("update",{id:i.id,chatId:i.chatId,index:r,fields:s});if(i.fields.blink){setTimeout((function(){n.commit("update",{id:i.id,chatId:i.chatId,fields:{blink:false}})}),1e3)}return true},delete:function e(t,n){if(!(n.id instanceof Array)){n.id=[n.id]}n.id=n.id.map((function(e){if(/^\d+$/.test(e)){e=parseInt(e)}return e}));t.commit("delete",{chatId:n.chatId,elements:n.id});return true},clear:function e(t,n){n.chatId=parseInt(n.chatId);if(n.keepPlaceholders){t.commit("clearMessages",{chatId:n.chatId})}else{t.commit("clear",{chatId:n.chatId})}return true},applyMutationType:function e(t,n){n.chatId=parseInt(n.chatId);t.commit("applyMutationType",{chatId:n.chatId});return true},readMessages:function e(t,n){n.readId=parseInt(n.readId)||0;n.chatId=parseInt(n.chatId);if(typeof t.state.collection[n.chatId]==="undefined"){return{count:0}}var i=0;for(var r=t.state.collection[n.chatId].length-1;r>=0;r--){var s=t.state.collection[n.chatId][r];if(!s.unread)continue;if(n.readId===0||s.id<=n.readId){i++}}t.commit("readMessages",{chatId:n.chatId,readId:n.readId});return{count:i}},unreadMessages:function e(t,n){n.unreadId=parseInt(n.unreadId)||0;n.chatId=parseInt(n.chatId);if(typeof t.state.collection[n.chatId]==="undefined"||!n.unreadId){return{count:0}}var i=0;for(var r=t.state.collection[n.chatId].length-1;r>=0;r--){var s=t.state.collection[n.chatId][r];if(s.unread)continue;if(s.id>=n.unreadId){i++}}t.commit("unreadMessages",{chatId:n.chatId,unreadId:n.unreadId});return{count:i}}}}},{key:"getMutations",value:function e(){var i=this;return{initCollection:function e(t,n){return i.initCollection(t,n)},add:function e(n,r){i.initCollection(n,{chatId:r.chatId});n.collection[r.chatId].push(r);n.saveMessageList[r.chatId].push(r.id);n.created+=1;n.collection[r.chatId].sort((function(e,t){return e.id-t.id}));i.saveState(n,r.chatId);t.Logger.warn("Messages model: saving state after add")},clearPlaceholders:function e(t,n){if(!t.collection[n.chatId]){return false}t.collection[n.chatId]=t.collection[n.chatId].filter((function(e){return!e.id.toString().startsWith("placeholder")}))},updatePlaceholders:function e(n,r){var s="placeholder".concat(r.firstMessage);var o=n.collection[r.chatId].findIndex((function(e){return e.id===s}));if(o>=0){var a;n.collection[r.chatId].splice(o,r.amount);(a=n.collection[r.chatId]).splice.apply(a,[o,0].concat(babelHelpers.toConsumableArray(r.data)))}n.collection[r.chatId].sort((function(e,t){return e.id-t.id}));t.Logger.warn("Messages model: saving state after updating placeholders");i.saveState(n,r.chatId)},set:function e(r,o){t.Logger.warn("Messages model: set mutation",o);var l=[];var u=[];var f=false;o.data=s.getPayloadWithTempMessages(r,o);var d=o.insertType;if(o.insertType===a.MutationType.set){(function(){o.insertType=a.MutationType.setAfter;var e={};o.data.forEach((function(t){if(!e[t.chatId]){e[t.chatId]=[]}e[t.chatId].push(t.id)}));var n=function n(s){if(!e.hasOwnProperty(s))return"continue";i.initCollection(r,{chatId:s});t.Logger.warn("Messages model: messages before adding from request - ",r.collection[s].length);if(r.saveMessageList[s].length>e[s].length||e[s].length<a.StorageLimit.messages){r.collection[s]=r.collection[s].filter((function(t){return e[s].includes(t.id)}));r.saveMessageList[s]=r.saveMessageList[s].filter((function(t){return e[s].includes(t)}))}t.Logger.warn("Messages model: cache length",r.saveMessageList[s].length);var l=i.manageCacheBeforeSet(babelHelpers.toConsumableArray(r.saveMessageList[s].reverse()),e[s]);t.Logger.warn("Messages model: set intersection with cache",l);if(l.type===h.none){if(l.foundElements.length>0){r.collection[s]=r.collection[s].filter((function(e){return!l.foundElements.includes(e.id)}));r.saveMessageList[s]=r.saveMessageList[s].filter((function(e){return!l.foundElements.includes(e)}))}t.Logger.warn("Messages model: no intersection - removing cache");i.removeIntersectionCacheElements=r.collection[s].map((function(e){return e.id}));r.collection[s]=r.collection[s].filter((function(e){return!i.removeIntersectionCacheElements.includes(e.id)}));r.saveMessageList[s]=r.saveMessageList[s].filter((function(e){return!i.removeIntersectionCacheElements.includes(e)}));i.removeIntersectionCacheElements=[]}else if(l.type===h.foundReverse){t.Logger.warn("Messages model: found reverse intersection");o.insertType=a.MutationType.setBefore;o.data=o.data.reverse()}};for(var s in e){var l=n(s);if(l==="continue")continue}})()}t.Logger.warn("Messages model: adding messages to model",o.data);var p=c(o.data),m;try{var g=function e(){var t=m.value;i.initCollection(r,{chatId:t.chatId});var n=r.collection[t.chatId].findIndex((function(e){if(s.isTemporaryMessage(e)){return e.templateId===t.templateId}return e.id===t.id}));if(n>-1){r.collection[t.chatId][n]=Object.assign(r.collection[t.chatId][n],t)}else if(o.insertType===a.MutationType.setBefore){r.collection[t.chatId].unshift(t)}else if(o.insertType===a.MutationType.setAfter){r.collection[t.chatId].push(t)}l.push(t.chatId);if(i.store.getters["dialogues/canSaveChat"]&&i.store.getters["dialogues/canSaveChat"](t.chatId)){u.push(t.chatId)}};for(p.s();!(m=p.n()).done;){g()}}catch(e){p.e(e)}finally{p.f()}l=babelHelpers.toConsumableArray(new Set(l));u=babelHelpers.toConsumableArray(new Set(u));f=o.data.every((function(e){return e.push===true}));t.Logger.warn("Is it fake push message?",f);l.forEach((function(e){r.collection[e].sort((function(e,t){return e.id-t.id}));if(!f){t.Logger.warn("setting messagesSet = true for chatId = ",e);setTimeout((function(){n.EventEmitter.emit(a.EventType.dialog.messagesSet,{chatId:e});n.EventEmitter.emit(a.EventType.dialog.readVisibleMessages,{chatId:e})}),100)}}));if(d!==a.MutationType.setBefore){u.forEach((function(e){t.Logger.warn("Messages model: saving state after set");i.saveState(r,e)}))}},update:function e(n,r){i.initCollection(n,{chatId:r.chatId});var s=-1;if(typeof r.index!=="undefined"&&n.collection[r.chatId][r.index]){s=r.index}else{s=n.collection[r.chatId].findIndex((function(e){return e.id===r.id}))}if(s>=0){var o=n.saveMessageList[r.chatId].includes(n.collection[r.chatId][s].id)||r.fields.id&&!r.fields.id.toString().startsWith("temporary")&&n.collection[r.chatId][s].id.toString().startsWith("temporary");n.collection[r.chatId][s]=Object.assign(n.collection[r.chatId][s],r.fields);if(o){t.Logger.warn("Messages model: saving state after update");i.saveState(n,r.chatId)}}},delete:function e(n,r){i.initCollection(n,{chatId:r.chatId});n.collection[r.chatId]=n.collection[r.chatId].filter((function(e){return!r.elements.includes(e.id)}));if(n.saveMessageList[r.chatId].length>0){var s=c(r.elements),o;try{for(s.s();!(o=s.n()).done;){var a=o.value;if(n.saveMessageList[r.chatId].includes(a)){t.Logger.warn("Messages model: saving state after delete");i.saveState(n,r.chatId);break}}}catch(e){s.e(e)}finally{s.f()}}},clear:function e(t,n){i.initCollection(t,{chatId:n.chatId});t.collection[n.chatId]=[];t.saveMessageList[n.chatId]=[]},clearMessages:function e(t,n){i.initCollection(t,{chatId:n.chatId});t.collection[n.chatId]=t.collection[n.chatId].filter((function(e){return e.id.toString().startsWith("placeholder")}));t.saveMessageList[n.chatId]=[]},applyMutationType:function e(t,n){if(typeof t.mutationType[n.chatId]==="undefined"){r.WidgetVue.set(t.mutationType,n.chatId,{applied:false,initialType:a.MutationType.none,appliedType:a.MutationType.none,scrollStickToTop:0,scrollMessageId:0})}t.mutationType[n.chatId].applied=true},readMessages:function e(n,r){i.initCollection(n,{chatId:r.chatId});var s=false;for(var o=n.collection[r.chatId].length-1;o>=0;o--){var a=n.collection[r.chatId][o];if(!a.unread)continue;if(r.readId===0||a.id<=r.readId){n.collection[r.chatId][o]=Object.assign(n.collection[r.chatId][o],{unread:false});s=true}}if(s){t.Logger.warn("Messages model: saving state after reading");i.saveState(n,r.chatId)}},unreadMessages:function e(n,r){i.initCollection(n,{chatId:r.chatId});var s=false;for(var o=n.collection[r.chatId].length-1;o>=0;o--){var a=n.collection[r.chatId][o];if(a.unread)continue;if(a.id>=r.unreadId){n.collection[r.chatId][o]=Object.assign(n.collection[r.chatId][o],{unread:true});s=true}}if(s){t.Logger.warn("Messages model: saving state after unreading");i.saveState(n,r.chatId);i.updateSubordinateStates()}}}}},{key:"initCollection",value:function e(t,n){if(typeof n.chatId==="undefined"){return false}if(typeof n.chatId==="undefined"||typeof t.collection[n.chatId]!=="undefined"){return true}r.WidgetVue.set(t.collection,n.chatId,n.messages?[].concat(n.messages):[]);r.WidgetVue.set(t.saveMessageList,n.chatId,[]);r.WidgetVue.set(t.saveFileList,n.chatId,[]);r.WidgetVue.set(t.saveUserList,n.chatId,[]);return true}},{key:"prepareMessage",value:function e(t){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var i=this.validate(Object.assign({},t),n);i.params=Object.assign({},this.getElementState().params,i.params);if(!i.templateId){i.templateId=i.id}return Object.assign({},this.getElementState(),i)}},{key:"manageCacheBeforeSet",value:function e(n,i){var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;t.Logger.warn("manageCacheBeforeSet",n,i);var s={type:h.empty,foundElements:[],noneElements:[]};if(!n||n.length<=0){return s}var o=c(i),a;try{for(o.s();!(a=o.n()).done;){var l=a.value;if(n.includes(l)){if(s.type===h.empty){s.type=h.found}s.foundElements.push(l)}else{if(s.type===h.empty){s.type=h.none}s.noneElements.push(l)}}}catch(e){o.e(e)}finally{o.f()}if(s.type===h.found&&n.length===i.length&&s.foundElements.length===i.length){s.type=h.equal}else if(s.type===h.none&&!r&&s.foundElements.length>0){var u=this.manageCacheBeforeSet(n.reverse(),i.reverse(),true);if(u.type===h.found){u.type=h.foundReverse;return u}}return s}},{key:"updateSaveLists",value:function e(t,n){if(!this.isSaveAvailable()){return true}if(!n||!this.store.getters["dialogues/canSaveChat"]||!this.store.getters["dialogues/canSaveChat"](n)){return false}this.initCollection(t,{chatId:n});var i=0;var r=[];var s=[];var o=[];var l=this.store.getters["dialogues/getByChatId"](n);if(l&&l.type==="private"){o.push(parseInt(l.dialogId))}var u=0;for(var c=t.collection[n].length-1;c>=0;c--){if(t.collection[n][c].id.toString().startsWith("temporary")){continue}if(!t.collection[n][c].unread){u++}if(i>=a.StorageLimit.messages&&u>=50){break}r.unshift(t.collection[n][c].id);i++}r=r.slice(0,a.StorageLimit.messages);t.collection[n].filter((function(e){return r.includes(e.id)})).forEach((function(e){if(e.authorId>0){o.push(e.authorId)}if(e.params.FILE_ID instanceof Array){s=e.params.FILE_ID.concat(s)}}));t.saveMessageList[n]=r;t.saveFileList[n]=babelHelpers.toConsumableArray(new Set(s));t.saveUserList[n]=babelHelpers.toConsumableArray(new Set(o));return true}},{key:"getSaveTimeout",value:function e(){return 150}},{key:"saveState",value:function e(n,i){if(!this.updateSaveLists(n,i)){return false}babelHelpers.get(babelHelpers.getPrototypeOf(s.prototype),"saveState",this).call(this,(function(){var e={collection:{},saveMessageList:{},saveUserList:{},saveFileList:{}};var i=function i(r){if(!n.saveMessageList.hasOwnProperty(r)){return"continue"}if(!n.collection[r]){return"continue"}if(!e.collection[r]){e.collection[r]=[]}n.collection[r].filter((function(e){return n.saveMessageList[r].includes(e.id)})).forEach((function(t){if(t.templateType!=="placeholder"){e.collection[r].push(t)}}));t.Logger.warn("Cache after updating",e.collection[r]);e.saveMessageList[r]=n.saveMessageList[r];e.saveFileList[r]=n.saveFileList[r];e.saveUserList[r]=n.saveUserList[r]};for(var r in n.saveMessageList){var s=i(r);if(s==="continue")continue}return e}))}},{key:"updateSubordinateStates",value:function e(){this.store.dispatch("users/saveState");this.store.dispatch("files/saveState")}},{key:"validate",value:function e(t,n){var r={};if(typeof t.id==="number"){r.id=t.id}else if(typeof t.id==="string"){if(t.id.startsWith("temporary")||t.id.startsWith("placeholder")||i.Utils.types.isUuidV4(t.id)){r.id=t.id}else{r.id=parseInt(t.id)}}if(typeof t.uuid==="string"){r.templateId=t.uuid}else if(typeof t.templateId==="number"){r.templateId=t.templateId}else if(typeof t.templateId==="string"){if(t.templateId.startsWith("temporary")||i.Utils.types.isUuidV4(t.templateId)){r.templateId=t.templateId}else{r.templateId=parseInt(t.templateId)}}if(typeof t.templateType==="string"){r.templateType=t.templateType}if(typeof t.placeholderType==="number"){r.placeholderType=t.placeholderType}if(typeof t.chat_id!=="undefined"){t.chatId=t.chat_id}if(typeof t.chatId==="number"||typeof t.chatId==="string"){r.chatId=parseInt(t.chatId)}if(typeof t.date!=="undefined"){r.date=i.Utils.date.cast(t.date)}if(typeof t.textOriginal==="string"||typeof t.textOriginal==="number"){r.text=t.textOriginal.toString();if(typeof t.text==="string"||typeof t.text==="number"){r.textConverted=this.convertToHtml({text:t.text.toString(),isConverted:true})}}else{if(typeof t.text_converted!=="undefined"){t.textConverted=t.text_converted}if(typeof t.textConverted==="string"||typeof t.textConverted==="number"){r.textConverted=t.textConverted.toString()}if(typeof t.text==="string"||typeof t.text==="number"){r.text=t.text.toString();var s=typeof r.textConverted!=="undefined";r.textConverted=this.convertToHtml({text:s?r.textConverted:r.text,isConverted:s})}}if(typeof t.senderId!=="undefined"){t.authorId=t.senderId}else if(typeof t.author_id!=="undefined"){t.authorId=t.author_id}if(typeof t.authorId==="number"||typeof t.authorId==="string"){if(t.system===true||t.system==="Y"){r.authorId=0}else{r.authorId=parseInt(t.authorId)}}if(babelHelpers["typeof"](t.params)==="object"&&t.params!==null){var o=this.validateParams(t.params,n);if(o){r.params=o}}if(typeof t.push==="boolean"){r.push=t.push}if(typeof t.sending==="boolean"){r.sending=t.sending}if(typeof t.unread==="boolean"){r.unread=t.unread}if(typeof t.blink==="boolean"){r.blink=t.blink}if(typeof t.error==="boolean"||typeof t.error==="string"){r.error=t.error}if(typeof t.retry==="boolean"){r.retry=t.retry}return r}},{key:"validateParams",value:function e(t,n){var r={};try{for(var s in t){if(!t.hasOwnProperty(s)){continue}if(s==="COMPONENT_ID"){if(typeof t[s]==="string"&&BX.WidgetVue.isComponent(t[s])){r[s]=t[s]}}else if(s==="LIKE"){if(t[s]instanceof Array){r["REACTION"]={like:t[s].map((function(e){return parseInt(e)}))}}}else if(s==="CHAT_LAST_DATE"){r[s]=i.Utils.date.cast(t[s])}else if(s==="AVATAR"){if(t[s]){r[s]=t[s].startsWith("http")?t[s]:n.host+t[s]}}else if(s==="NAME"){if(t[s]){r[s]=t[s]}}else if(s==="LINK_ACTIVE"){if(t[s]){r[s]=t[s].map((function(e){return parseInt(e)}))}}else if(s==="ATTACH"){r[s]=this.decodeAttach(t[s])}else{r[s]=t[s]}}}catch(e){}var o=false;for(var a in r){if(!r.hasOwnProperty(a)){continue}o=true;break}return o?r:null}},{key:"convertToHtml",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var n=t.quote,i=n===void 0?true:n,r=t.image,s=r===void 0?true:r,o=t.text,a=o===void 0?"":o,l=t.isConverted,u=l===void 0?false:l,c=t.enableBigSmile,f=c===void 0?true:c;a=a.trim();if(!u){a=a.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}if(a.startsWith("/me")){a="<i>".concat(a.substr(4),"</i>")}else if(a.startsWith("/loud")){a="<b>".concat(a.substr(6),"</b>")}var d="&gt;&gt;";if(i&&a.indexOf(d)>=0){var h=a.split(u?"<br />":"\n");for(var p=0;p<h.length;p++){if(h[p].startsWith(d)){h[p]=h[p].replace(d,'<div class="bx-im-message-content-quote"><div class="bx-im-message-content-quote-wrap">');while(++p<h.length&&h[p].startsWith(d)){h[p]=h[p].replace(d,"")}h[p-1]+="</div></div><br>"}}a=h.join("<br />")}a=a.replace(/\n/gi,"<br />");a=a.replace(/\t/gi,"&nbsp;&nbsp;&nbsp;&nbsp;");a=this.decodeBbCode(a,false,f);if(i){a=a.replace(/------------------------------------------------------<br \/>(.*?)\[(.*?)\]<br \/>(.*?)------------------------------------------------------(<br \/>)?/g,(function(e,t,n,i,r,s){return(s>0?"<br>":"")+'<div class="bx-im-message-content-quote"><div class="bx-im-message-content-quote-wrap"><div class="bx-im-message-content-quote-name"><span class="bx-im-message-content-quote-name-text">'+t+'</span><span class="bx-im-message-content-quote-name-time">'+n+"</span></div>"+i+"</div></div><br />"}));a=a.replace(/------------------------------------------------------<br \/>(.*?)------------------------------------------------------(<br \/>)?/g,(function(e,t,n,i,r){return(r>0?"<br>":"")+'<div class="bx-im-message-content-quote"><div class="bx-im-message-content-quote-wrap">'+t+"</div></div><br />"}))}if(s){var m=false;a=a.replace(/<a(.*?)>(http[s]{0,1}:\/\/.*?)<\/a>/gi,(function(e,t,n,i){if(!n.match(/(\.(jpg|jpeg|png|gif|webp)\?|\.(jpg|jpeg|png|gif|webp)$)/i)||n.indexOf("/docs/pub/")>0||n.indexOf("logout=yes")>0){return e}else{m=true;return(i>0?"<br />":"")+"<a"+t+' target="_blank" class="bx-im-element-file-image"><img src="'+n+'" class="bx-im-element-file-image-source-text" onerror="BX.Messenger.Model.MessagesModel.hideErrorImage(this)"></a></span>'}}));if(m){a=a.replace(/<\/span>(\n?)<br(\s\/?)>/gi,"</span>").replace(/<br(\s\/?)>(\n?)<br(\s\/?)>(\n?)<span/gi,"<br /><span")}}if(f){a=a.replace(/^(\s*<img\s+src=[^>]+?data-code=[^>]+?data-definition="UHD"[^>]+?style="width:)(\d+)(px[^>]+?height:)(\d+)(px[^>]+?class="bx-smile"\s*\/?>\s*)$/,(function e(t,n,i,r,s,o){return n+parseInt(i,10)*1.7+r+parseInt(s,10)*1.7+o}))}if(a.substr(-6)=="<br />"){a=a.substr(0,a.length-6)}a=a.replace(/<br><br \/>/gi,"<br />");a=a.replace(/<br \/><br>/gi,"<br />");return a}},{key:"decodeBbCode",value:function e(t){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:true;return s.decodeBbCode({text:t,textOnly:n,enableBigSmile:i})}},{key:"decodeAttach",value:function e(t){var n=this;if(Array.isArray(t)){t.forEach((function(e){e=n.decodeAttach(e)}))}else if(babelHelpers["typeof"](t)==="object"&&t!==null){for(var r in t){if(t.hasOwnProperty(r)){t[r]=this.decodeAttach(t[r])}}}else{if(typeof t==="string"){t=i.Utils.text.htmlspecialcharsback(t)}}return t}}],[{key:"decodeBbCode",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var n=t.text,r=t.textOnly,s=r===void 0?false:r,o=t.enableBigSmile,a=o===void 0?true:o;var l=[];n=n.replace(/\[PUT(?:=(.+?))?\](.+?)?\[\/PUT\]/gi,(function(e){var t=l.length;l.push(e);return"####REPLACEMENT_PUT_"+t+"####"}));var u=[];n=n.replace(/\[SEND(?:=(.+?))?\](.+?)?\[\/SEND\]/gi,(function(e){var t=u.length;u.push(e);return"####REPLACEMENT_SEND_"+t+"####"}));var c=[];n=n.replace(/\[CODE\]\n?([\s\S]*?)\[\/CODE\]/gi,(function(e,t){var n=c.length;c.push(t);return"####REPLACEMENT_CODE_"+n+"####"}));n=n.replace(/\[url=([^\]]+)\](.*?)\[\/url\]/gi,(function(e,t,n){var r=document.createElement("a");r.href=i.Utils.text.htmlspecialcharsback(t);r.target="_blank";r.text=i.Utils.text.htmlspecialcharsback(n);var s=["http:","https:","ftp:","file:","tel:","callto:","mailto:","skype:","viber:"];if(s.indexOf(r.protocol)<=-1){return e}return r.outerHTML}));n=n.replace(/\[url\]([^\]]+)\[\/url\]/gi,(function(e,t){t=i.Utils.text.htmlspecialcharsback(t);var n=document.createElement("a");n.href=t;n.target="_blank";n.text=t;var r=["http:","https:","ftp:","file:","tel:","callto:","mailto:","skype:","viber:"];if(r.indexOf(n.protocol)<=-1){return e}return n.outerHTML}));n=n.replace(/\[LIKE\]/gi,'<span class="bx-smile bx-im-smile-like"></span>');n=n.replace(/\[DISLIKE\]/gi,'<span class="bx-smile bx-im-smile-dislike"></span>');n=n.replace(/\[BR\]/gi,"<br/>");n=n.replace(/\[([buis])\](.*?)\[(\/[buis])\]/gi,(function(e,t,n,i){return"<"+t+">"+n+"<"+i+">"}));n=n.replace(/\[CHAT=(imol\|)?([0-9]{1,})\](.*?)\[\/CHAT\]/gi,(function(e,t,n,i){return t?i:'<span class="bx-im-mention" data-type="CHAT" data-value="chat'+n+'">'+i+"</span>"}));n=n.replace(/\[CALL(?:=(.+?))?\](.+?)?\[\/CALL\]/gi,(function(e,t,n){return'<span class="bx-im-mention" data-type="CALL" data-value="'+i.Utils.text.htmlspecialchars(t)+'">'+n+"</span>"}));n=n.replace(/\[PCH=([0-9]{1,})\](.*?)\[\/PCH\]/gi,(function(e,t,n){return n}));var f=0;if(a){f=n.replace(/\[icon\=([^\]]*)\]/gi,"").trim().length}n=n.replace(/\[icon\=([^\]]*)\]/gi,(function(e){var t=e.match(/icon\=(\S+[^\s.,> )\];\'\"!?])/i);if(t&&t[1]){t=t[1]}else{return""}var n={src:t,border:0};var r=e.match(/size\=(\d+)/i);if(r&&r[1]){n["width"]=r[1];n["height"]=r[1]}else{var s=e.match(/width\=(\d+)/i);if(s&&s[1]){n["width"]=s[1]}var o=e.match(/height\=(\d+)/i);if(o&&o[1]){n["height"]=o[1]}if(n["width"]&&!n["height"]){n["height"]=n["width"]}else if(n["height"]&&!n["width"]){n["width"]=n["height"]}else if(n["height"]&&n["width"]);else{n["width"]=20;n["height"]=20}}n["width"]=n["width"]>100?100:n["width"];n["height"]=n["height"]>100?100:n["height"];if(a&&f===0&&n["width"]===n["height"]&&n["width"]===20){n["width"]=40;n["height"]=40}var l=e.match(/title\=(.*[^\s\]])/i);if(l&&l[1]){l=l[1];if(l.indexOf("width=")>-1){l=l.substr(0,l.indexOf("width="))}if(l.indexOf("height=")>-1){l=l.substr(0,l.indexOf("height="))}if(l.indexOf("size=")>-1){l=l.substr(0,l.indexOf("size="))}if(l){n["title"]=i.Utils.text.htmlspecialchars(l).trim();n["alt"]=n["title"]}}var u="";for(var c in n){if(n.hasOwnProperty(c)){u+=c+'="'+n[c]+'" '}}return'<img class="bx-smile bx-icon" '+u+">"}));u.forEach((function(e,t){n=n.replace("####REPLACEMENT_SEND_"+t+"####",e)}));n=n.replace(/\[SEND(?:=(?:.+?))?\](?:.+?)?\[\/SEND]/gi,(function(e){return e.replace(/\[SEND(?:=(.+))?\](.+?)?\[\/SEND]/gi,(function(e,t,n){var i="";n=n?n:t;t=(t?t:n).replace("<br />","\n");if(!s&&n){n=n.replace(/<([\w]+)[^>]*>(.*?)<\\1>/i,"$2",n);n=n.replace(/\[([\w]+)[^\]]*\](.*?)\[\/\1\]/i,"$2",n);t=t.split("####REPLACEMENT_PUT_").join("####REPLACEMENT_SP_");i="\x3c!--IM_COMMAND_START--\x3e"+'<span class="bx-im-message-command-wrap">'+'<span class="bx-im-message-command" data-entity="send">'+n+"</span>"+'<span class="bx-im-message-command-data">'+t+"</span>"+"</span>"+"\x3c!--IM_COMMAND_END--\x3e"}else{i=n}return i}))}));l.forEach((function(e,t){n=n.replace("####REPLACEMENT_PUT_"+t+"####",e)}));n=n.replace(/\[PUT(?:=(?:.+?))?\](?:.+?)?\[\/PUT]/gi,(function(e){return e.replace(/\[PUT(?:=(.+))?\](.+?)?\[\/PUT]/gi,(function(e,t,n){var i="";n=n?n:t;t=(t?t:n).replace("<br />","\n");if(!s&&n){n=n.replace(/<([\w]+)[^>]*>(.*?)<\/\1>/i,"$2",n);n=n.replace(/\[([\w]+)[^\]]*\](.*?)\[\/\1\]/i,"$2",n);i="\x3c!--IM_COMMAND_START--\x3e"+'<span class="bx-im-message-command-wrap">'+'<span class="bx-im-message-command" data-entity="put">'+n+"</span>"+'<span class="bx-im-message-command-data">'+t+"</span>"+"</span>"+"\x3c!--IM_COMMAND_END--\x3e"}else{i=n}return i}))}));c.forEach((function(e,t){n=n.replace("####REPLACEMENT_CODE_"+t+"####",!s?'<div class="bx-im-message-content-code">'+e+"</div>":e)}));if(u.length>0){do{u.forEach((function(e,t){n=n.replace("####REPLACEMENT_SEND_"+t+"####",e)}))}while(n.includes("####REPLACEMENT_SEND_"))}n=n.split("####REPLACEMENT_SP_").join("####REPLACEMENT_PUT_");if(l.length>0){do{l.forEach((function(e,t){n=n.replace("####REPLACEMENT_PUT_"+t+"####",e)}))}while(n.includes("####REPLACEMENT_PUT_"))}return n}},{key:"hideErrorImage",value:function e(t){if(t.parentNode&&t.parentNode){t.parentNode.innerHTML='<a href="'+t.src+'" target="_blank">'+t.src+"</a>"}return true}},{key:"isTemporaryMessage",value:function e(t){return t.id&&(i.Utils.types.isUuidV4(t.id)||t.id.toString().startsWith("temporary"))}},{key:"getPayloadWithTempMessages",value:function e(t,n){var r=babelHelpers.toConsumableArray(n.data);if(!i.Utils.platform.isBitrixMobile()){return r}if(!n.data||n.data.length<=0){return r}var o=n.data[0].chatId;if(!t.collection[o]){return r}t.collection[o].forEach((function(e){if(s.isTemporaryMessage(e)&&!s.existsInPayload(n,e.templateId)&&s.doesTaskExist(e)){r.push(e)}}));return r}},{key:"existsInPayload",value:function e(t,n){return t.data.find((function(e){return e.templateId===n}))}},{key:"doesTaskExist",value:function e(t){if(Array.isArray(t.params.FILE_ID)){var n=false;t.params.FILE_ID.forEach((function(e){if(!n){n=window.imDialogUploadTasks.find((function(t){return t.taskId.split("|")[1]===e}))}}));return!!n}if(t.templateId){var i=window.imDialogMessagesTasks.find((function(e){return e.taskId.split("|")[1]===t.templateId}));return!!i}return false}}]);return s}(s.WidgetVuexBuilderModel);function m(e,t){var n=typeof Symbol!=="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=g(e))||t&&e&&typeof e.length==="number"){if(n)e=n;var i=0;var r=function e(){};return{s:r,n:function t(){if(i>=e.length)return{done:true};return{done:false,value:e[i++]}},e:function e(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s=true,o=false,a;return{s:function t(){n=n.call(e)},n:function e(){var t=n.next();s=t.done;return t},e:function e(t){o=true;a=t},f:function e(){try{if(!s&&n["return"]!=null)n["return"]()}finally{if(o)throw a}}}}function g(e,t){if(!e)return;if(typeof e==="string")return v(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor)n=e.constructor.name;if(n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return v(e,t)}function v(e,t){if(t==null||t>e.length)t=e.length;for(var n=0,i=new Array(t);n<t;n++){i[n]=e[n]}return i}var y=function(e){babelHelpers.inherits(t,e);function t(){babelHelpers.classCallCheck(this,t);return babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).apply(this,arguments))}babelHelpers.createClass(t,[{key:"getName",value:function e(){return"dialogues"}},{key:"getState",value:function e(){return{host:this.getVariable("host",location.protocol+"//"+location.host),collection:{},saveDialogList:[],saveChatList:[]}}},{key:"getStateSaveException",value:function e(){return{host:null}}},{key:"getElementStateSaveException",value:function e(){return{writingList:null,quoteId:null}}},{key:"getElementState",value:function e(){return{dialogId:"0",chatId:0,counter:0,userCounter:0,messageCount:0,unreadId:0,lastMessageId:0,managerList:[],readedList:[],writingList:[],muteList:[],textareaMessage:"",quoteId:0,editId:0,init:false,name:"",owner:0,extranet:false,avatar:"",color:"#17A3EA",type:"chat",entityType:"",entityId:"",entityData1:"",entityData2:"",entityData3:"",dateCreate:new Date,restrictions:{avatar:true,extend:true,leave:true,leaveOwner:true,rename:true,send:true,userList:true,mute:true,call:true},public:{code:"",link:""}}}},{key:"getGetters",value:function e(){var t=this;return{get:function e(t){return function(e){if(!t.collection[e]){return null}return t.collection[e]}},getByChatId:function e(t){return function(e){e=parseInt(e);for(var n in t.collection){if(!t.collection.hasOwnProperty(n)){continue}if(t.collection[n].chatId===e){return t.collection[n]}}return null}},getBlank:function e(n){return function(e){return t.getElementState()}},getQuoteId:function e(t){return function(e){if(!t.collection[e]){return 0}return t.collection[e].quoteId}},getEditId:function e(t){return function(e){if(!t.collection[e]){return 0}return t.collection[e].editId}},canSaveChat:function e(t){return function(e){if(/^\d+$/.test(e)){e=parseInt(e)}return t.saveChatList.includes(parseInt(e))}},canSaveDialog:function e(t){return function(e){return t.saveDialogList.includes(e.toString())}},isPrivateDialog:function e(t){return function(e){e=e.toString();return t.collection[e.toString()]&&t.collection[e].type==="private"}}}}},{key:"getActions",value:function e(){var t=this;return{set:function e(n,i){if(i instanceof Array){i=i.map((function(e){return Object.assign({},t.validate(Object.assign({},e),{host:n.state.host}),{init:true})}))}else{var r=[];r.push(Object.assign({},t.validate(Object.assign({},i),{host:n.state.host}),{init:true}));i=r}n.commit("set",i)},update:function e(n,i){if(typeof n.state.collection[i.dialogId]==="undefined"||n.state.collection[i.dialogId].init===false){return true}n.commit("update",{dialogId:i.dialogId,fields:t.validate(Object.assign({},i.fields),{host:n.state.host})});return true},delete:function e(t,n){t.commit("delete",n.dialogId);return true},updateWriting:function e(n,i){if(typeof n.state.collection[i.dialogId]==="undefined"||n.state.collection[i.dialogId].init===false){return true}var r=n.state.collection[i.dialogId].writingList.findIndex((function(e){return e.userId===i.userId}));if(i.action){if(r>=0){return true}else{var s=[].concat(n.state.collection[i.dialogId].writingList);s.unshift({userId:i.userId,userName:i.userName});n.commit("update",{actionName:"updateWriting/1",dialogId:i.dialogId,fields:t.validate({writingList:s},{host:n.state.host})})}}else{if(r>=0){var o=n.state.collection[i.dialogId].writingList.filter((function(e){return e.userId!==i.userId}));n.commit("update",{actionName:"updateWriting/2",dialogId:i.dialogId,fields:t.validate({writingList:o},{host:n.state.host})});return true}else{return true}}return false},updateReaded:function e(n,i){if(typeof n.state.collection[i.dialogId]==="undefined"||n.state.collection[i.dialogId].init===false){return true}var r=n.state.collection[i.dialogId].readedList.filter((function(e){return e.userId!==i.userId}));if(i.action){r.push({userId:i.userId,userName:i.userName||"",messageId:i.messageId,date:i.date||new Date})}n.commit("update",{actionName:"updateReaded",dialogId:i.dialogId,fields:t.validate({readedList:r},{host:n.state.host})});return false},increaseCounter:function e(t,n){var i;if(typeof t.state.collection[n.dialogId]==="undefined"||t.state.collection[n.dialogId].init===false){return true}var r=t.state.collection[n.dialogId].counter;if(r===100){return true}var s=r+n.count;if(s>100){s=100}var o=(i=t.rootState.application)===null||i===void 0?void 0:i.common.userId;var a=o&&t.state.collection[n.dialogId].muteList.includes(o);t.commit("update",{actionName:"increaseCounter",dialogId:n.dialogId,dialogMuted:a,fields:{counter:s,previousCounter:r}});return false},decreaseCounter:function e(t,n){if(typeof t.state.collection[n.dialogId]==="undefined"||t.state.collection[n.dialogId].init===false){return true}var i=t.state.collection[n.dialogId].counter;if(i===100){return true}var r=i-n.count;if(r<0){r=0}var s=n.unreadId>t.state.collection[n.dialogId].unreadId?n.unreadId:t.state.collection[n.dialogId].unreadId;if(t.state.collection[n.dialogId].unreadId!==s||t.state.collection[n.dialogId].counter!==r){var o;var a=t.state.collection[n.dialogId].counter;if(r===0){s=0}var l=(o=t.rootState.application)===null||o===void 0?void 0:o.common.userId;var u=l&&t.state.collection[n.dialogId].muteList.includes(l);t.commit("update",{actionName:"decreaseCounter",dialogId:n.dialogId,dialogMuted:u,fields:{counter:r,previousCounter:a,unreadId:s}})}return false},increaseMessageCounter:function e(t,n){if(typeof t.state.collection[n.dialogId]==="undefined"||t.state.collection[n.dialogId].init===false){return true}var i=t.state.collection[n.dialogId].messageCount;t.commit("update",{actionName:"increaseMessageCount",dialogId:n.dialogId,fields:{messageCount:i+n.count}})},saveDialog:function e(t,n){if(typeof t.state.collection[n.dialogId]==="undefined"||t.state.collection[n.dialogId].init===false){return true}t.commit("saveDialog",{dialogId:n.dialogId,chatId:n.chatId});return false}}}},{key:"getMutations",value:function e(){var t=this;return{initCollection:function e(n,i){t.initCollection(n,i)},saveDialog:function e(n,i){if(!(i.chatId>0&&i.dialogId.length>0)){return false}var r=n.saveDialogList.filter((function(e){return e!==i.dialogId}));r.unshift(i.dialogId);r=r.slice(0,a.StorageLimit.dialogues);if(n.saveDialogList.join(",")===r.join(",")){return true}n.saveDialogList=r;var s=n.saveChatList.filter((function(e){return e!==i.chatId}));s.unshift(i.chatId);n.saveChatList=s.slice(0,a.StorageLimit.dialogues);t.saveState(n)},set:function e(n,i){var r=m(i),s;try{for(r.s();!(s=r.n()).done;){var o=s.value;t.initCollection(n,{dialogId:o.dialogId});n.collection[o.dialogId]=Object.assign(t.getElementState(),n.collection[o.dialogId],o)}}catch(e){r.e(e)}finally{r.f()}t.saveState(n)},update:function e(n,i){t.initCollection(n,i);n.collection[i.dialogId]=Object.assign(n.collection[i.dialogId],i.fields);t.saveState(n)},delete:function e(n,i){delete n.collection[i.dialogId];t.saveState(n)}}}},{key:"initCollection",value:function e(t,n){if(typeof t.collection[n.dialogId]!=="undefined"){return true}r.WidgetVue.set(t.collection,n.dialogId,this.getElementState());if(n.fields){t.collection[n.dialogId]=Object.assign(t.collection[n.dialogId],this.validate(Object.assign({},n.fields),{host:t.host}))}return true}},{key:"getSaveTimeout",value:function e(){return 100}},{key:"saveState",value:function e(){var n=this;var i=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};if(!this.isSaveAvailable()){return true}babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"saveState",this).call(this,(function(){var e={collection:{},saveDialogList:[].concat(i.saveDialogList),saveChatList:[].concat(i.saveChatList)};i.saveDialogList.forEach((function(t){if(!i.collection[t])return false;e.collection[t]=Object.assign(n.getElementState(),n.cloneState(i.collection[t],n.getElementStateSaveException()))}));return e}))}},{key:"validate",value:function e(t){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var r={};n.host=n.host||this.getState().host;if(typeof t.dialog_id!=="undefined"){t.dialogId=t.dialog_id}if(typeof t.dialogId==="number"||typeof t.dialogId==="string"){r.dialogId=t.dialogId.toString()}if(typeof t.chat_id!=="undefined"){t.chatId=t.chat_id}else if(typeof t.id!=="undefined"){t.chatId=t.id}if(typeof t.chatId==="number"||typeof t.chatId==="string"){r.chatId=parseInt(t.chatId)}if(typeof t.quoteId==="number"){r.quoteId=parseInt(t.quoteId)}if(typeof t.editId==="number"){r.editId=parseInt(t.editId)}if(typeof t.counter==="number"||typeof t.counter==="string"){r.counter=parseInt(t.counter)}if(typeof t.user_counter==="number"||typeof t.user_counter==="string"){r.userCounter=parseInt(t.user_counter)}if(typeof t.userCounter==="number"||typeof t.userCounter==="string"){r.userCounter=parseInt(t.userCounter)}if(typeof t.message_count==="number"||typeof t.message_count==="string"){r.messageCount=parseInt(t.message_count)}if(typeof t.messageCount==="number"||typeof t.messageCount==="string"){r.messageCount=parseInt(t.messageCount)}if(typeof t.unread_id!=="undefined"){t.unreadId=t.unread_id}if(typeof t.unreadId==="number"||typeof t.unreadId==="string"){r.unreadId=parseInt(t.unreadId)}if(typeof t.last_message_id!=="undefined"){t.lastMessageId=t.last_message_id}if(typeof t.lastMessageId==="number"||typeof t.lastMessageId==="string"){r.lastMessageId=parseInt(t.lastMessageId)}if(typeof t.readed_list!=="undefined"){t.readedList=t.readed_list}if(typeof t.readedList!=="undefined"){r.readedList=[];if(t.readedList instanceof Array){t.readedList.forEach((function(e){var t={};if(typeof e.user_id!=="undefined"){e.userId=e.user_id}if(typeof e.user_name!=="undefined"){e.userName=e.user_name}if(typeof e.message_id!=="undefined"){e.messageId=e.message_id}if(!e.userId||!e.userName||!e.messageId){return false}t.userId=parseInt(e.userId);t.userName=e.userName.toString();t.messageId=parseInt(e.messageId);t.date=i.Utils.date.cast(e.date);r.readedList.push(t)}))}}if(typeof t.writing_list!=="undefined"){t.writingList=t.writing_list}if(typeof t.writingList!=="undefined"){r.writingList=[];if(t.writingList instanceof Array){t.writingList.forEach((function(e){var t={};if(!e.userId){return false}t.userId=parseInt(e.userId);t.userName=i.Utils.text.htmlspecialcharsback(e.userName);r.writingList.push(t)}))}}if(typeof t.manager_list!=="undefined"){t.managerList=t.manager_list}if(typeof t.managerList!=="undefined"){r.managerList=[];if(t.managerList instanceof Array){t.managerList.forEach((function(e){e=parseInt(e);if(e>0){r.managerList.push(e)}}))}}if(typeof t.mute_list!=="undefined"){t.muteList=t.mute_list}if(typeof t.muteList!=="undefined"){r.muteList=[];if(t.muteList instanceof Array){t.muteList.forEach((function(e){e=parseInt(e);if(e>0){r.muteList.push(e)}}))}else if(babelHelpers["typeof"](t.muteList)==="object"){Object.entries(t.muteList).forEach((function(e){if(e[1]===true){var t=parseInt(e[0]);if(t>0){r.muteList.push(t)}}}))}}if(typeof t.textareaMessage!=="undefined"){r.textareaMessage=t.textareaMessage.toString()}if(typeof t.title!=="undefined"){t.name=t.title}if(typeof t.name==="string"||typeof t.name==="number"){r.name=i.Utils.text.htmlspecialcharsback(t.name.toString())}if(typeof t.owner!=="undefined"){t.ownerId=t.owner}if(typeof t.ownerId==="number"||typeof t.ownerId==="string"){r.ownerId=parseInt(t.ownerId)}if(typeof t.extranet==="boolean"){r.extranet=t.extranet}if(typeof t.avatar==="string"){var s;if(!t.avatar||t.avatar.endsWith("/js/im/images/blank.gif")){s=""}else if(t.avatar.startsWith("http")){s=t.avatar}else{s=n.host+t.avatar}if(s){r.avatar=encodeURI(s)}}if(typeof t.color==="string"){r.color=t.color.toString()}if(typeof t.type==="string"){r.type=t.type.toString()}if(typeof t.entity_type!=="undefined"){t.entityType=t.entity_type}if(typeof t.entityType==="string"){r.entityType=t.entityType.toString()}if(typeof t.entity_id!=="undefined"){t.entityId=t.entity_id}if(typeof t.entityId==="string"||typeof t.entityId==="number"){r.entityId=t.entityId.toString()}if(typeof t.entity_data_1!=="undefined"){t.entityData1=t.entity_data_1}if(typeof t.entityData1==="string"){r.entityData1=t.entityData1.toString()}if(typeof t.entity_data_2!=="undefined"){t.entityData2=t.entity_data_2}if(typeof t.entityData2==="string"){r.entityData2=t.entityData2.toString()}if(typeof t.entity_data_3!=="undefined"){t.entityData3=t.entity_data_3}if(typeof t.entityData3==="string"){r.entityData3=t.entityData3.toString()}if(typeof t.date_create!=="undefined"){t.dateCreate=t.date_create}if(typeof t.dateCreate!=="undefined"){r.dateCreate=i.Utils.date.cast(t.dateCreate)}if(typeof t.dateLastOpen!=="undefined"){r.dateLastOpen=i.Utils.date.cast(t.dateLastOpen)}if(babelHelpers["typeof"](t.restrictions)==="object"&&t.restrictions){r.restrictions={};if(typeof t.restrictions.avatar==="boolean"){r.restrictions.avatar=t.restrictions.avatar}if(typeof t.restrictions.extend==="boolean"){r.restrictions.extend=t.restrictions.extend}if(typeof t.restrictions.leave==="boolean"){r.restrictions.leave=t.restrictions.leave}if(typeof t.restrictions.leave_owner==="boolean"){r.restrictions.leaveOwner=t.restrictions.leave_owner}if(typeof t.restrictions.rename==="boolean"){r.restrictions.rename=t.restrictions.rename}if(typeof t.restrictions.send==="boolean"){r.restrictions.send=t.restrictions.send}if(typeof t.restrictions.user_list==="boolean"){r.restrictions.userList=t.restrictions.user_list}if(typeof t.restrictions.mute==="boolean"){r.restrictions.mute=t.restrictions.mute}if(typeof t.restrictions.call==="boolean"){r.restrictions.call=t.restrictions.call}}if(babelHelpers["typeof"](t["public"])==="object"&&t["public"]){r["public"]={};if(typeof t["public"].code==="string"){r["public"].code=t["public"].code}if(typeof t["public"].link==="string"){r["public"].link=t["public"].link}}return r}}]);return t}(s.WidgetVuexBuilderModel);function b(e,t){var n=typeof Symbol!=="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=w(e))||t&&e&&typeof e.length==="number"){if(n)e=n;var i=0;var r=function e(){};return{s:r,n:function t(){if(i>=e.length)return{done:true};return{done:false,value:e[i++]}},e:function e(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s=true,o=false,a;return{s:function t(){n=n.call(e)},n:function e(){var t=n.next();s=t.done;return t},e:function e(t){o=true;a=t},f:function e(){try{if(!s&&n["return"]!=null)n["return"]()}finally{if(o)throw a}}}}function w(e,t){if(!e)return;if(typeof e==="string")return S(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor)n=e.constructor.name;if(n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return S(e,t)}function S(e,t){if(t==null||t>e.length)t=e.length;for(var n=0,i=new Array(t);n<t;n++){i[n]=e[n]}return i}var I=function(e){babelHelpers.inherits(t,e);function t(){babelHelpers.classCallCheck(this,t);return babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).apply(this,arguments))}babelHelpers.createClass(t,[{key:"getName",value:function e(){return"users"}},{key:"getState",value:function e(){this.startOnlineCheckInterval();return{host:this.getVariable("host",location.protocol+"//"+location.host),collection:{},onlineList:[],mobileOnlineList:[],absentList:[]}}},{key:"getElementState",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var n=t.id,i=n===void 0?0:n,r=t.name,s=r===void 0?this.getVariable("default.name",""):r,o=t.firstName,a=o===void 0?this.getVariable("default.name",""):o,l=t.lastName,u=l===void 0?"":l;return{id:i,name:s,firstName:a,lastName:u,workPosition:"",color:"#048bd0",avatar:"",gender:"M",birthday:false,isBirthday:false,extranet:false,network:false,bot:false,connector:false,externalAuthId:"default",status:"online",idle:false,lastActivityDate:false,mobileLastDate:false,isOnline:false,isMobileOnline:false,absent:false,isAbsent:false,departments:[],phones:{workPhone:"",personalMobile:"",personalPhone:"",innerPhone:""},init:false}}},{key:"getGetters",value:function e(){var t=this;return{get:function e(n){return function(e){var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;e=parseInt(e);if(e<=0){if(i){e=0}else{return null}}if(!i&&(!n.collection[e]||!n.collection[e].init)){return null}if(!n.collection[e]){return t.getElementState({id:e})}return n.collection[e]}},getBlank:function e(n){return function(e){return t.getElementState(e)}},getList:function e(n){return function(e){var i=[];if(!Array.isArray(e)){return null}e.forEach((function(e){if(n.collection[e]){i.push(n.collection[e])}else{i.push(t.getElementState({id:e}))}}));return i}}}}},{key:"getActions",value:function e(){var t=this;return{set:function e(n,i){if(i instanceof Array){i=i.map((function(e){return Object.assign({},t.getElementState(),t.validate(Object.assign({},e),{host:n.state.host}),{init:true})}))}else{var r=[];r.push(Object.assign({},t.getElementState(),t.validate(Object.assign({},i),{host:n.state.host}),{init:true}));i=r}n.commit("set",i)},update:function e(n,i){i.id=parseInt(i.id);if(typeof n.state.collection[i.id]==="undefined"||n.state.collection[i.id].init===false){return true}n.commit("update",{id:i.id,fields:t.validate(Object.assign({},i.fields),{host:n.state.host})});return true},delete:function e(t,n){t.commit("delete",n.id);return true},saveState:function e(t,n){t.commit("saveState",{});return true}}}},{key:"getMutations",value:function e(){var t=this;return{set:function e(n,r){var s=b(r),o;try{var a=function e(){var r=o.value;t.initCollection(n,{id:r.id});n.collection[r.id]=Object.assign(n.collection[r.id],r);var s=i.Utils.user.getOnlineStatus(r);if(s.isOnline){n.collection[r.id].isOnline=true;t.addToOnlineList(n,r.id)}var a=i.Utils.user.isMobileActive(r);if(a){n.collection[r.id].isMobileOnline=true;t.addToMobileOnlineList(n,r.id)}if(r.birthday){var l=i.Utils.date.format(new Date,"d-m");if(r.birthday===l){n.collection[r.id].isBirthday=true;var u=t.getTimeToNextMidnight();setTimeout((function(){n.collection[r.id].isBirthday=false}),u)}}if(r.absent){r.isAbsent=true;if(!n.absentList.includes(r.id)){t.addToAbsentList(n,r.id);var c=t.getTimeToNextMidnight();var f=1e3*60*60*24;setTimeout((function(){setInterval((function(){return t.startAbsentCheckInterval(n)}),f)}),c)}}t.saveState(n)};for(s.s();!(o=s.n()).done;){a()}}catch(e){s.e(e)}finally{s.f()}},update:function e(n,r){t.initCollection(n,r);if(typeof r.fields.lastActivityDate!=="undefined"&&n.collection[r.id].lastActivityDate){var s=n.collection[r.id].lastActivityDate.getTime();var o=r.fields.lastActivityDate.getTime();if(o>s){var a=i.Utils.user.getOnlineStatus(r.fields);if(a.isOnline){n.collection[r.id].isOnline=true;t.addToOnlineList(n,r.fields.id)}}}if(typeof r.fields.mobileLastDate!=="undefined"&&n.collection[r.id].mobileLastDate!==r.fields.mobileLastDate){var l=i.Utils.user.isMobileActive(r.fields);if(l){n.collection[r.id].isMobileOnline=true;t.addToMobileOnlineList(n,r.fields.id)}}n.collection[r.id]=Object.assign(n.collection[r.id],r.fields);t.saveState(n)},delete:function e(n,i){delete n.collection[i.id];t.saveState(n)},saveState:function e(n,i){t.saveState(n)}}}},{key:"initCollection",value:function e(t,n){if(typeof t.collection[n.id]!=="undefined"){return true}r.WidgetVue.set(t.collection,n.id,this.getElementState());return true}},{key:"getSaveUserList",value:function e(){if(!this.db){return[]}if(!this.store.getters["messages/getSaveUserList"]){return[]}var t=this.store.getters["messages/getSaveUserList"]();if(!t){return[]}return t}},{key:"getSaveTimeout",value:function e(){return 250}},{key:"saveState",value:function e(n){var i=this;if(!this.isSaveAvailable()){return false}babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"saveState",this).call(this,(function(){var e=i.getSaveUserList();if(!e){return false}var t={collection:{}};var r={absent:true,idle:true,mobileLastDate:true,lastActivityDate:true};for(var s in e){if(!e.hasOwnProperty(s)){continue}e[s].forEach((function(e){if(!n.collection[e]){return false}t.collection[e]=i.cloneState(n.collection[e],r)}))}return t}))}},{key:"validate",value:function e(t){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var r={};n.host=n.host||this.getState().host;if(typeof t.id==="number"||typeof t.id==="string"){r.id=parseInt(t.id)}if(typeof t.first_name!=="undefined"){t.firstName=i.Utils.text.htmlspecialcharsback(t.first_name)}if(typeof t.last_name!=="undefined"){t.lastName=i.Utils.text.htmlspecialcharsback(t.last_name)}if(typeof t.name==="string"||typeof t.name==="number"){t.name=i.Utils.text.htmlspecialcharsback(t.name.toString());r.name=t.name}if(typeof t.firstName==="string"||typeof t.firstName==="number"){r.firstName=i.Utils.text.htmlspecialcharsback(t.firstName.toString())}if(typeof t.lastName==="string"||typeof t.lastName==="number"){r.lastName=i.Utils.text.htmlspecialcharsback(t.lastName.toString())}if(typeof t.work_position!=="undefined"){t.workPosition=t.work_position}if(typeof t.workPosition==="string"||typeof t.workPosition==="number"){r.workPosition=t.workPosition.toString()}if(typeof t.color==="string"){r.color=t.color}if(typeof t.avatar==="string"){var s;if(!t.avatar||t.avatar.endsWith("/js/im/images/blank.gif")){s=""}else if(t.avatar.startsWith("http")){s=t.avatar}else{s=n.host+t.avatar}if(s){r.avatar=encodeURI(s)}}if(typeof t.gender!=="undefined"){r.gender=t.gender==="F"?"F":"M"}if(typeof t.birthday==="string"){r.birthday=t.birthday}if(typeof t.extranet==="boolean"){r.extranet=t.extranet}if(typeof t.network==="boolean"){r.network=t.network}if(typeof t.bot==="boolean"){r.bot=t.bot}if(typeof t.connector==="boolean"){r.connector=t.connector}if(typeof t.external_auth_id!=="undefined"){t.externalAuthId=t.external_auth_id}if(typeof t.externalAuthId==="string"&&t.externalAuthId){r.externalAuthId=t.externalAuthId}if(typeof t.status==="string"){r.status=t.status}if(typeof t.idle!=="undefined"){r.idle=i.Utils.date.cast(t.idle,false)}if(typeof t.last_activity_date!=="undefined"){t.lastActivityDate=t.last_activity_date}if(typeof t.lastActivityDate!=="undefined"){r.lastActivityDate=i.Utils.date.cast(t.lastActivityDate,false)}if(typeof t.mobile_last_date!=="undefined"){t.mobileLastDate=t.mobile_last_date}if(typeof t.mobileLastDate!=="undefined"){r.mobileLastDate=i.Utils.date.cast(t.mobileLastDate,false)}if(typeof t.absent!=="undefined"){r.absent=i.Utils.date.cast(t.absent,false)}if(typeof t.departments!=="undefined"){r.departments=[];if(t.departments instanceof Array){t.departments.forEach((function(e){e=parseInt(e);if(e>0){r.departments.push(e)}}))}}if(babelHelpers["typeof"](t.phones)==="object"&&t.phones){r.phones={};if(typeof t.phones.work_phone!=="undefined"){t.phones.workPhone=t.phones.work_phone}if(typeof t.phones.workPhone==="string"||typeof t.phones.workPhone==="number"){r.phones.workPhone=t.phones.workPhone.toString()}if(typeof t.phones.personal_mobile!=="undefined"){t.phones.personalMobile=t.phones.personal_mobile}if(typeof t.phones.personalMobile==="string"||typeof t.phones.personalMobile==="number"){r.phones.personalMobile=t.phones.personalMobile.toString()}if(typeof t.phones.personal_phone!=="undefined"){t.phones.personalPhone=t.phones.personal_phone}if(typeof t.phones.personalPhone==="string"||typeof t.phones.personalPhone==="number"){r.phones.personalPhone=t.phones.personalPhone.toString()}if(typeof t.phones.inner_phone!=="undefined"){t.phones.innerPhone=t.phones.inner_phone}if(typeof t.phones.innerPhone==="string"||typeof t.phones.innerPhone==="number"){r.phones.innerPhone=t.phones.innerPhone.toString()}}return r}},{key:"addToOnlineList",value:function e(t,n){if(!t.onlineList.includes(n)){t.onlineList.push(n)}}},{key:"addToMobileOnlineList",value:function e(t,n){if(!t.mobileOnlineList.includes(n)){t.mobileOnlineList.push(n)}}},{key:"addToAbsentList",value:function e(t,n){if(!t.absentList.includes(n)){t.absentList.push(n)}}},{key:"getTimeToNextMidnight",value:function e(){var t=new Date((new Date).setHours(24,0,0)).getTime();return t-new Date}},{key:"startAbsentCheckInterval",value:function e(t){var n=b(t.absentList),i;try{var r=function e(){var n=i.value;var r=t.collection[n];if(!r){return"continue"}var s=(new Date).getTime();var o=new Date(t.collection[n].absent).getTime();if(o<=s){t.absentList=t.absentList.filter((function(e){return e!==n}));r.isAbsent=false}};for(n.s();!(i=n.n()).done;){var s=r();if(s==="continue")continue}}catch(e){n.e(e)}finally{n.f()}}},{key:"startOnlineCheckInterval",value:function e(){var t=this;var n=6e4;setInterval((function(){var e=b(t.store.state.users.onlineList),n;try{var r=function e(){var r=n.value;var s=t.store.state.users.collection[r];if(!s){return"continue"}var o=i.Utils.user.getOnlineStatus(s);if(o.isOnline){s.isOnline=true}else{s.isOnline=false;t.store.state.users.onlineList=t.store.state.users.onlineList.filter((function(e){return e!==r}))}};for(e.s();!(n=e.n()).done;){var s=r();if(s==="continue")continue}}catch(t){e.e(t)}finally{e.f()}var o=b(t.store.state.users.mobileOnlineList),a;try{var l=function e(){var n=a.value;var r=t.store.state.users.collection[n];if(!r){return"continue"}var s=i.Utils.user.isMobileActive(r);if(s){r.isMobileOnline=true}else{r.isMobileOnline=false;t.store.state.users.mobileOnlineList=t.store.state.users.mobileOnlineList.filter((function(e){return e!==n}))}};for(o.s();!(a=o.n()).done;){var u=l();if(u==="continue")continue}}catch(e){o.e(e)}finally{o.f()}}),n)}}]);return t}(s.WidgetVuexBuilderModel);function k(e,t){var n=typeof Symbol!=="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=C(e))||t&&e&&typeof e.length==="number"){if(n)e=n;var i=0;var r=function e(){};return{s:r,n:function t(){if(i>=e.length)return{done:true};return{done:false,value:e[i++]}},e:function e(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s=true,o=false,a;return{s:function t(){n=n.call(e)},n:function e(){var t=n.next();s=t.done;return t},e:function e(t){o=true;a=t},f:function e(){try{if(!s&&n["return"]!=null)n["return"]()}finally{if(o)throw a}}}}function C(e,t){if(!e)return;if(typeof e==="string")return E(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor)n=e.constructor.name;if(n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return E(e,t)}function E(e,t){if(t==null||t>e.length)t=e.length;for(var n=0,i=new Array(t);n<t;n++){i[n]=e[n]}return i}var _=function(e){babelHelpers.inherits(t,e);function t(){babelHelpers.classCallCheck(this,t);return babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).apply(this,arguments))}babelHelpers.createClass(t,[{key:"getName",value:function e(){return"files"}},{key:"getState",value:function e(){return{created:0,host:this.getVariable("host",location.protocol+"//"+location.host),collection:{},index:{}}}},{key:"getElementState",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var n=t.id,i=n===void 0?0:n,r=t.chatId,s=r===void 0?0:r,o=t.name,l=o===void 0?this.getVariable("default.name",""):o;return{id:i,chatId:s,name:l,templateId:i,date:new Date,type:"file",extension:"",icon:"empty",size:0,image:false,status:a.FileStatus.done,progress:100,authorId:0,authorName:"",urlPreview:"",urlShow:"",urlDownload:"",init:false,viewerAttrs:{}}}},{key:"getGetters",value:function e(){var t=this;return{get:function e(t){return function(e,n){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;if(!e||!n){return null}if(!t.index[e]||!t.index[e][n]){return null}if(!i&&!t.index[e][n].init){return null}return t.index[e][n]}},getList:function e(t){return function(e){if(!t.index[e]){return null}return t.index[e]}},getBlank:function e(n){return function(e){return t.getElementState(e)}}}}},{key:"getActions",value:function e(){var t=this;return{add:function e(n,i){var r=t.validate(Object.assign({},i),{host:n.state.host});if(i.id){r.id=i.id}else{r.id="temporary"+(new Date).getTime()+n.state.created}r.templateId=r.id;r.init=true;n.commit("add",Object.assign({},t.getElementState(),r));return r.id},set:function e(n,i){if(i instanceof Array){i=i.map((function(e){var i=t.validate(Object.assign({},e),{host:n.state.host});i.templateId=i.id;return Object.assign({},t.getElementState(),i,{init:true})}))}else{var r=t.validate(Object.assign({},i),{host:n.state.host});r.templateId=r.id;i=[];i.push(Object.assign({},t.getElementState(),r,{init:true}))}n.commit("set",{insertType:a.MutationType.setAfter,data:i})},setBefore:function e(n,i){if(i instanceof Array){i=i.map((function(e){var i=t.validate(Object.assign({},e),{host:n.state.host});i.templateId=i.id;return Object.assign({},t.getElementState(),i,{init:true})}))}else{var r=t.validate(Object.assign({},i),{host:n.state.host});r.templateId=r.id;i=[];i.push(Object.assign({},t.getElementState(),r,{init:true}))}n.commit("set",{actionName:"setBefore",insertType:a.MutationType.setBefore,data:i})},update:function e(n,i){var r=t.validate(Object.assign({},i.fields),{host:n.state.host});n.commit("initCollection",{chatId:i.chatId});var s=n.state.collection[i.chatId].findIndex((function(e){return e.id===i.id}));if(s<0){return false}n.commit("update",{id:i.id,chatId:i.chatId,index:s,fields:r});if(i.fields.blink){setTimeout((function(){n.commit("update",{id:i.id,chatId:i.chatId,fields:{blink:false}})}),1e3)}return true},delete:function e(t,n){t.commit("delete",{id:n.id,chatId:n.chatId});return true},saveState:function e(t,n){t.commit("saveState",{});return true}}}},{key:"getMutations",value:function e(){var t=this;return{initCollection:function e(n,i){t.initCollection(n,i)},add:function e(n,i){t.initCollection(n,i);n.collection[i.chatId].push(i);n.index[i.chatId][i.id]=i;n.created+=1;t.saveState(n)},set:function e(n,i){var r=k(i.data),s;try{var o=function e(){var r=s.value;t.initCollection(n,{chatId:r.chatId});var o=n.collection[r.chatId].findIndex((function(e){return e.id===r.id}));if(o>-1){delete r.templateId;n.collection[r.chatId][o]=Object.assign(n.collection[r.chatId][o],r)}else if(i.insertType===a.MutationType.setBefore){n.collection[r.chatId].unshift(r)}else{n.collection[r.chatId].push(r)}n.index[r.chatId][r.id]=r;t.saveState(n)};for(r.s();!(s=r.n()).done;){o()}}catch(e){r.e(e)}finally{r.f()}},update:function e(n,i){t.initCollection(n,i);var r=-1;if(typeof i.index!=="undefined"&&n.collection[i.chatId][i.index]){r=i.index}else{r=n.collection[i.chatId].findIndex((function(e){return e.id===i.id}))}if(r>=0){delete i.fields.templateId;var s=Object.assign(n.collection[i.chatId][r],i.fields);n.collection[i.chatId][r]=s;n.index[i.chatId][s.id]=s;t.saveState(n)}},delete:function e(n,i){t.initCollection(n,i);n.collection[i.chatId]=n.collection[i.chatId].filter((function(e){return e.id!==i.id}));delete n.index[i.chatId][i.id];t.saveState(n)},saveState:function e(n,i){t.saveState(n)}}}},{key:"initCollection",value:function e(t,n){if(typeof t.collection[n.chatId]!=="undefined"){return true}r.WidgetVue.set(t.collection,n.chatId,[]);r.WidgetVue.set(t.index,n.chatId,{});return true}},{key:"getLoadedState",value:function e(t){if(!t||babelHelpers["typeof"](t)!=="object"){return t}if(babelHelpers["typeof"](t.collection)!=="object"){return t}t.index={};var n=function e(n){if(!t.collection.hasOwnProperty(n)){return"continue"}t.index[n]={};t.collection[n].filter((function(e){return e!=null})).forEach((function(e){t.index[n][e.id]=e}))};for(var i in t.collection){var r=n(i);if(r==="continue")continue}return t}},{key:"getSaveFileList",value:function e(){if(!this.db){return[]}if(!this.store.getters["messages/getSaveFileList"]){return[]}var t=this.store.getters["messages/getSaveFileList"]();if(!t){return[]}return t}},{key:"getSaveTimeout",value:function e(){return 250}},{key:"saveState",value:function e(n){var i=this;if(!this.isSaveAvailable()){return false}babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"saveState",this).call(this,(function(){var e=i.getSaveFileList();if(!e){return false}var t={collection:{}};var r=function i(r){if(!e.hasOwnProperty(r)){return"continue"}e[r].forEach((function(e){if(!n.index[r]){return false}if(!n.index[r][e]){return false}if(!t.collection[r]){t.collection[r]=[]}t.collection[r].push(n.index[r][e])}))};for(var s in e){var o=r(s);if(o==="continue")continue}return t}))}},{key:"validate",value:function e(n){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var s={};r.host=r.host||this.getState().host;if(typeof n.id==="number"){s.id=n.id}else if(typeof n.id==="string"){if(n.id.startsWith("temporary")){s.id=n.id}else{s.id=parseInt(n.id)}}if(typeof n.templateId==="number"){s.templateId=n.templateId}else if(typeof n.templateId==="string"){if(n.templateId.startsWith("temporary")){s.templateId=n.templateId}else{s.templateId=parseInt(n.templateId)}}if(typeof n.chatId==="number"||typeof n.chatId==="string"){s.chatId=parseInt(n.chatId)}if(typeof n.date!=="undefined"){s.date=i.Utils.date.cast(n.date)}if(typeof n.type==="string"){s.type=n.type}if(typeof n.extension==="string"){s.extension=n.extension.toString();if(s.type==="image"){s.icon="img"}else if(s.type==="video"){s.icon="mov"}else{s.icon=t.getIconType(s.extension)}}if(typeof n.name==="string"||typeof n.name==="number"){s.name=n.name.toString()}if(typeof n.size==="number"||typeof n.size==="string"){s.size=parseInt(n.size)}if(typeof n.image==="boolean"){s.image=false}else if(babelHelpers["typeof"](n.image)==="object"&&n.image){s.image={width:0,height:0};if(typeof n.image.width==="string"||typeof n.image.width==="number"){s.image.width=parseInt(n.image.width)}if(typeof n.image.height==="string"||typeof n.image.height==="number"){s.image.height=parseInt(n.image.height)}if(s.image.width<=0||s.image.height<=0){s.image=false}}if(typeof n.status==="string"&&typeof a.FileStatus[n.status]!=="undefined"){s.status=n.status}if(typeof n.progress==="number"||typeof n.progress==="string"){s.progress=parseInt(n.progress)}if(typeof n.authorId==="number"||typeof n.authorId==="string"){s.authorId=parseInt(n.authorId)}if(typeof n.authorName==="string"||typeof n.authorName==="number"){s.authorName=n.authorName.toString()}if(typeof n.urlPreview==="string"){if(!n.urlPreview||n.urlPreview.startsWith("http")||n.urlPreview.startsWith("bx")||n.urlPreview.startsWith("file")||n.urlPreview.startsWith("blob")){s.urlPreview=n.urlPreview}else{s.urlPreview=r.host+n.urlPreview}}if(typeof n.urlDownload==="string"){if(!n.urlDownload||n.urlDownload.startsWith("http")||n.urlDownload.startsWith("bx")||n.urlPreview.startsWith("file")){s.urlDownload=n.urlDownload}else{s.urlDownload=r.host+n.urlDownload}}if(typeof n.urlShow==="string"){if(!n.urlShow||n.urlShow.startsWith("http")||n.urlShow.startsWith("bx")||n.urlShow.startsWith("file")){s.urlShow=n.urlShow}else{s.urlShow=r.host+n.urlShow}}if(babelHelpers["typeof"](n.viewerAttrs)==="object"){if(s.type==="image"&&!i.Utils.platform.isBitrixMobile()){s.viewerAttrs=n.viewerAttrs}if(s.type==="video"&&!i.Utils.platform.isBitrixMobile()&&s.size>t.maxDiskFileSize){s.viewerAttrs=n.viewerAttrs}}return s}}],[{key:"getType",value:function e(t){t=t.toString().toLowerCase().split(".").splice(-1)[0];switch(t){case"png":case"jpe":case"jpg":case"jpeg":case"gif":case"heic":case"bmp":case"webp":return a.FileType.image;case"mp4":case"mkv":case"webm":case"mpeg":case"hevc":case"avi":case"3gp":case"flv":case"m4v":case"ogg":case"wmv":case"mov":return a.FileType.video;case"mp3":return a.FileType.audio}return a.FileType.file}},{key:"getIconType",value:function e(t){var n="empty";switch(t.toString()){case"png":case"jpe":case"jpg":case"jpeg":case"gif":case"heic":case"bmp":case"webp":n="img";break;case"mp4":case"mkv":case"webm":case"mpeg":case"hevc":case"avi":case"3gp":case"flv":case"m4v":case"ogg":case"wmv":case"mov":n="mov";break;case"txt":n="txt";break;case"doc":case"docx":n="doc";break;case"xls":case"xlsx":n="xls";break;case"php":n="php";break;case"pdf":n="pdf";break;case"ppt":case"pptx":n="ppt";break;case"rar":n="rar";break;case"zip":case"7z":case"tar":case"gz":case"gzip":n="zip";break;case"set":n="set";break;case"conf":case"ini":case"plist":n="set";break}return n}}]);return t}(s.WidgetVuexBuilderModel);babelHelpers.defineProperty(_,"maxDiskFileSize",5242880);var x=function(e){babelHelpers.inherits(t,e);function t(){babelHelpers.classCallCheck(this,t);return babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).apply(this,arguments))}babelHelpers.createClass(t,[{key:"getName",value:function e(){return"recent"}},{key:"getState",value:function e(){return{host:this.getVariable("host",location.protocol+"//"+location.host),collection:[]}}},{key:"getElementState",value:function e(){return{id:0,templateId:"",template:a.TemplateTypes.item,chatType:a.ChatTypes.chat,sectionCode:a.RecentSection.general,avatar:"",color:"#048bd0",title:"",lines:{id:0,status:0},message:{id:0,text:"",date:new Date,senderId:0,status:a.MessageStatus.received},counter:0,pinned:false,chatId:0,userId:0}}},{key:"getGetters",value:function e(){var t=this;return{get:function e(n){return function(e){if(o.Type.isNumber(e)){e=e.toString()}var n=t.findItem(e);if(n){return n}return false}}}}},{key:"getActions",value:function e(){var t=this;return{set:function e(n,i){var r=[];if(i instanceof Array){r=i.map((function(e){return t.prepareItem(e,{host:n.state.host})}))}if(r.length===0){return false}r.forEach((function(e){var i=t.findItem(e.id);if(i){n.commit("update",{index:i.index,fields:e})}else{n.commit("add",{fields:e})}}));n.state.collection.sort(t.sortListByMessageDate)},addPlaceholders:function e(t,n){n.forEach((function(e){t.commit("addPlaceholder",{fields:e})}))},updatePlaceholders:function e(n,i){i.items=i.items.map((function(e){return t.prepareItem(e)}));i.items.forEach((function(e,r){var s="placeholder"+(i.firstMessage+r);var o=t.findItem(s,"templateId");var a=t.findItem(e.id);if(a){n.commit("update",{index:a.index,fields:e});n.commit("delete",{index:o.index})}else{n.commit("update",{index:o.index,fields:e})}}))},update:function e(n,i){if(typeof i.id==="string"&&!i.id.startsWith("chat")&&i.id!=="notify"){i.id=parseInt(i.id)}var r=t.findItem(i.id);if(!r){return false}i.fields=t.validate(Object.assign({},i.fields));n.commit("update",{index:r.index,fields:i.fields});n.state.collection.sort(t.sortListByMessageDate)},pin:function e(n,i){if(typeof i.id==="string"&&!i.id.startsWith("chat")&&i.id!=="notify"){i.id=parseInt(i.id)}var r=t.findItem(i.id);if(!r){return false}n.commit("update",{index:r.index,fields:Object.assign({},r.element,{pinned:i.action})});n.state.collection.sort(t.sortListByMessageDate)},clearPlaceholders:function e(t){t.commit("clearPlaceholders")},delete:function e(n,i){if(typeof i.id==="string"&&!i.id.startsWith("chat")&&i.id!=="notify"){i.id=parseInt(i.id)}var r=t.findItem(i.id);if(!r){return false}n.commit("delete",{index:r.index});n.state.collection.sort(t.sortListByMessageDate)}}}},{key:"getMutations",value:function e(){var t=this;return{add:function e(n,i){n.collection.push(Object.assign({},t.getElementState(),i.fields))},update:function e(t,n){t.collection.splice(n.index,1,Object.assign({},t.collection[n.index],n.fields))},delete:function e(t,n){t.collection.splice(n.index,1)},addPlaceholder:function e(n,i){n.collection.push(Object.assign({},t.getElementState(),i.fields))},clearPlaceholders:function e(t){t.collection=t.collection.filter((function(e){return!e.id.toString().startsWith("placeholder")}))}}}},{key:"validate",value:function e(t){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var r={};if(o.Type.isNumber(t.id)){r.id=t.id.toString()}if(o.Type.isStringFilled(t.id)){r.id=t.id}if(o.Type.isString(t.templateId)){r.templateId=t.templateId}if(o.Type.isString(t.template)){r.template=t.template}if(o.Type.isString(t.type)){if(t.type===a.ChatTypes.chat){if(t.chat.type===a.ChatTypes.open){r.chatType=a.ChatTypes.open}else if(t.chat.type===a.ChatTypes.chat){r.chatType=a.ChatTypes.chat}}else if(t.type===a.ChatTypes.user){r.chatType=a.ChatTypes.user}else if(t.type===a.ChatTypes.notification){r.chatType=a.ChatTypes.notification;t.title="Notifications"}else{r.chatType=a.ChatTypes.chat}}if(o.Type.isString(t.avatar)){var s;if(!t.avatar||t.avatar.endsWith("/js/im/images/blank.gif")){s=""}else if(t.avatar.startsWith("http")){s=t.avatar}else{s=n.host+t.avatar}if(s){r.avatar=encodeURI(s)}}if(o.Type.isString(t.color)){r.color=t.color}if(o.Type.isString(t.title)){r.title=t.title}if(o.Type.isPlainObject(t.message)){var l={};if(o.Type.isNumber(t.message.id)){l.id=t.message.id}if(o.Type.isString(t.message.text)){var u={};if(t.message.withAttach){u.WITH_ATTACH=true}else if(t.message.withFile){u.WITH_FILE=true}l.text=i.Utils.text.purify(t.message.text,u)}if(o.Type.isDate(t.message.date)||o.Type.isString(t.message.date)){l.date=t.message.date}if(o.Type.isNumber(t.message.author_id)){l.senderId=t.message.author_id}if(o.Type.isNumber(t.message.senderId)){l.senderId=t.message.senderId}if(o.Type.isStringFilled(t.message.status)){l.status=t.message.status}r.message=l}if(o.Type.isNumber(t.counter)){r.counter=t.counter}if(o.Type.isBoolean(t.pinned)){r.pinned=t.pinned}if(o.Type.isNumber(t.chatId)){r.chatId=t.chatId}if(o.Type.isNumber(t.userId)){r.userId=t.userId}return r}},{key:"sortListByMessageDate",value:function e(t,n){if(t.message&&n.message){var i=new Date(t.message.date).getTime();var r=new Date(n.message.date).getTime();return r-i}}},{key:"prepareItem",value:function e(t){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var i=this.validate(Object.assign({},t));return Object.assign({},this.getElementState(),i,n)}},{key:"findItem",value:function e(t){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"id";var i={};if(n==="id"&&o.Type.isNumber(t)){t=t.toString()}var r=this.store.state.recent.collection.findIndex((function(e,i){return e[n]===t}));if(r!==-1){i.index=r;i.element=this.store.state.recent.collection[r];return i}return false}}]);return t}(s.WidgetVuexBuilderModel);function T(e,t){var n=typeof Symbol!=="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=O(e))||t&&e&&typeof e.length==="number"){if(n)e=n;var i=0;var r=function e(){};return{s:r,n:function t(){if(i>=e.length)return{done:true};return{done:false,value:e[i++]}},e:function e(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s=true,o=false,a;return{s:function t(){n=n.call(e)},n:function e(){var t=n.next();s=t.done;return t},e:function e(t){o=true;a=t},f:function e(){try{if(!s&&n["return"]!=null)n["return"]()}finally{if(o)throw a}}}}function O(e,t){if(!e)return;if(typeof e==="string")return M(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor)n=e.constructor.name;if(n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return M(e,t)}function M(e,t){if(t==null||t>e.length)t=e.length;for(var n=0,i=new Array(t);n<t;n++){i[n]=e[n]}return i}var D=function(e){babelHelpers.inherits(t,e);function t(){babelHelpers.classCallCheck(this,t);return babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).apply(this,arguments))}babelHelpers.createClass(t,[{key:"getName",value:function e(){return"notifications"}},{key:"getState",value:function e(){return{collection:[],searchCollection:[],chat_id:0,total:0,host:this.getVariable("host",location.protocol+"//"+location.host),unreadCounter:0,schema:{}}}},{key:"getElementState",value:function e(){return{id:0,authorId:0,date:new Date,text:"",sectionCode:a.NotificationTypesCodes.simple,textConverted:"",title:"",unread:false,display:true,settingName:"im|default"}}},{key:"getGetters",value:function e(){var t=this;return{get:function e(t){return function(){return t.collection}},getById:function e(n){return function(e){if(o.Type.isString(e)){e=parseInt(e)}var i=t.findItemInArr(n.collection,e);if(!i.element){return false}return i.element}},getSearchItemById:function e(n){return function(e){if(o.Type.isString(e)){e=parseInt(e)}var i=t.findItemInArr(n.searchCollection,e);if(!i.element){return false}return i.element}},getBlank:function e(n){return function(e){return t.getElementState()}}}}},{key:"getActions",value:function e(){var t=this;return{set:function e(n,i){var r={notification:[]};if(i.notification instanceof Array){r.notification=i.notification.map((function(e){return t.prepareNotification(e,{host:n.state.host})}))}if(o.Type.isNumber(i.total)||o.Type.isString(i.total)){r.total=parseInt(i.total)}n.commit("set",r)},setSearchResults:function e(n,i){var r={notification:[]};if(!(i.notification instanceof Array)){return false}if(i.type==="local"){r.notification=i.notification}else{r.notification=i.notification.map((function(e){return t.prepareNotification(e,{host:n.state.host})}))}n.commit("setSearchResults",{data:r})},deleteSearchResults:function e(t,n){t.commit("deleteSearchResults")},setCounter:function e(t,n){if(o.Type.isNumber(n.unreadTotal)||o.Type.isString(n.unreadTotal)){var i=parseInt(n.unreadTotal);t.commit("setCounter",i)}},setTotal:function e(t,n){if(o.Type.isNumber(n.total)||o.Type.isString(n.total)){t.commit("setTotal",n.total)}},add:function e(n,i){var r=t.prepareNotification(i.data,{host:n.state.host});r.unread=true;var s=t.findItemInArr(n.state.collection,r.id);if(!s.element){n.commit("add",{data:r});n.commit("setTotal",n.state.total+1)}else{n.commit("update",{index:s.index,fields:Object.assign({},i.fields)})}},updatePlaceholders:function e(n,i){if(i.items instanceof Array){i.items=i.items.map((function(e){return t.prepareNotification(e)}))}else{return false}n.commit("updatePlaceholders",i);return true},clearPlaceholders:function e(t,n){t.commit("clearPlaceholders",n)},update:function e(n,i){var r=t.findItemInArr(n.state.collection,i.id);if(r.element){n.commit("update",{index:r.index,fields:Object.assign({},i.fields)})}if(i.searchMode){var s=t.findItemInArr(n.state.searchCollection,i.id);if(s.element){n.commit("update",{searchCollection:true,index:s.index,fields:Object.assign({},i.fields)})}}},read:function e(n,i){var r=T(i.ids),s;try{for(r.s();!(s=r.n()).done;){var o=s.value;var a=t.findItemInArr(n.state.collection,o);if(!a.element){return false}n.commit("read",{index:a.index,action:!i.action})}}catch(e){r.e(e)}finally{r.f()}},readAll:function e(t,n){t.commit("readAll")},delete:function e(n,i){var r=t.findItemInArr(n.state.collection,i.id);if(r.element){n.commit("delete",{searchCollection:false,index:r.index});n.commit("setTotal",n.state.total-1)}if(i.searchMode){var s=t.findItemInArr(n.state.searchCollection,i.id);if(s.element){n.commit("delete",{searchCollection:true,index:s.index})}}},deleteAll:function e(t,n){t.commit("deleteAll")},setSchema:function e(t,n){t.commit("setSchema",{data:n.data})}}}},{key:"getMutations",value:function e(){var t=this;return{set:function e(n,i){n.total=i.hasOwnProperty("total")?i.total:n.total;if(!i.hasOwnProperty("notification")||!o.Type.isArray(i.notification)){return}var r=T(i.notification),s;try{for(r.s();!(s=r.n()).done;){var a=s.value;var l=t.findItemInArr(n.collection,a.id);if(!l.element){n.collection.push(a)}else{if(a.unread!==n.collection[l.index].unread){a.unread=n.collection[l.index].unread;n.unreadCounter=a.unread===true?n.unreadCounter+1:n.unreadCounter-1}n.collection[l.index]=Object.assign(n.collection[l.index],a)}}}catch(e){r.e(e)}finally{r.f()}n.collection.sort(t.sortByType)},setSearchResults:function e(n,i){var r=T(i.data.notification),s;try{for(r.s();!(s=r.n()).done;){var o=s.value;var a=t.findItemInArr(n.searchCollection,o.id);if(!a.element){n.searchCollection.push(o)}else{n.searchCollection[a.index]=Object.assign(n.searchCollection[a.index],o)}}}catch(e){r.e(e)}finally{r.f()}},deleteAll:function e(t,n){t.collection=[]},deleteSearchResults:function e(t,n){t.searchCollection=[]},add:function e(n,i){var r=null;if(i.data.sectionCode===a.NotificationTypesCodes.confirm){n.collection.unshift(i.data)}else{for(var s=0;n.collection.length>s;s++){if(n.collection[s].sectionCode===a.NotificationTypesCodes.simple){r=s;break}}if(r===null){n.collection.push(i.data)}else{n.collection.splice(r,0,i.data)}}n.collection.sort(t.sortByType)},update:function e(t,n){var i=n.searchCollection?"searchCollection":"collection";r.WidgetVue.set(t[i],n.index,Object.assign({},t[i][n.index],n.fields))},delete:function e(t,n){var i=n.searchCollection?"searchCollection":"collection";t[i].splice(n.index,1)},read:function e(t,n){t.collection[n.index].unread=n.action},readAll:function e(t,n){for(var i=0;t.collection.length>i;i++){if(t.collection[i].sectionCode===a.NotificationTypesCodes.simple){t.collection[i].unread=false}}},updatePlaceholders:function e(n,i){var r=i.searchCollection?"searchCollection":"collection";i.items.forEach((function(e,t){var s="placeholder".concat(i.firstItem+t);var o=n[r].findIndex((function(e){return e.id===s}));var a=n[r].findIndex((function(t){return t.id===e.id}));if(a>=0){n[r][a]=Object.assign(n[r][a],e);n[r].splice(o,1)}else{n[r].splice(o,1,Object.assign({},e))}}));n[r].sort(t.sortByType)},clearPlaceholders:function e(t,n){t.collection=t.collection.filter((function(e){return!e.id.toString().startsWith("placeholder")}));t.searchCollection=t.searchCollection.filter((function(e){return!e.id.toString().startsWith("placeholder")}))},setCounter:function e(t,n){t.unreadCounter=n},setTotal:function e(t,n){t.total=n},setSchema:function e(t,n){t.schema=n.data}}}},{key:"validate",value:function e(t,n){var r={};if(o.Type.isString(t.id)||o.Type.isNumber(t.id)){r.id=t.id}if(!o.Type.isNil(t.date)){r.date=i.Utils.date.cast(t.date)}if(o.Type.isString(t.textOriginal)||o.Type.isNumber(t.textOriginal)){r.text=t.textOriginal.toString();if(o.Type.isString(t.text)||o.Type.isNumber(t.text)){r.textConverted=this.convertToHtml({text:t.text.toString()})}}else{if(!o.Type.isNil(t.text_converted)){t.textConverted=t.text_converted}if(o.Type.isString(t.textConverted)||o.Type.isNumber(t.textConverted)){r.textConverted=t.textConverted.toString()}if(o.Type.isString(t.text)||o.Type.isNumber(t.text)){r.text=t.text.toString();var s=!o.Type.isNil(r.textConverted);r.textConverted=this.convertToHtml({text:s?r.textConverted:r.text})}}if(o.Type.isNumber(t.author_id)){if(t.system===true||t.system==="Y"){r.authorId=0}else{r.authorId=t.author_id}}if(o.Type.isNumber(t.userId)){r.authorId=t.userId}if(o.Type.isObjectLike(t.params)){var l=this.validateParams(t.params);if(l){r.params=l}}if(!o.Type.isNil(t.notify_buttons)){r.notifyButtons=JSON.parse(t.notify_buttons)}if(!o.Type.isNil(t.buttons)){r.notifyButtons=t.buttons.map((function(e){return{COMMAND:"notifyConfirm",COMMAND_PARAMS:"".concat(r.id,"|").concat(e.VALUE),TEXT:"".concat(e.TITLE),TYPE:"BUTTON",DISPLAY:"LINE",BG_COLOR:e.VALUE==="Y"?"#8bc84b":"#ef4b57",TEXT_COLOR:"#fff"}}))}if(t.notify_type===a.NotificationTypesCodes.confirm||t.type===a.NotificationTypesCodes.confirm){r.sectionCode=a.NotificationTypesCodes.confirm}else if(t.type===a.NotificationTypesCodes.placeholder){r.sectionCode=a.NotificationTypesCodes.placeholder}if(!o.Type.isNil(t.notify_read)){r.unread=t.notify_read==="N"}if(!o.Type.isNil(t.read)){r.unread=t.read==="N"}if(o.Type.isString(t.setting_name)){r.settingName=t.setting_name}if(o.Type.isString(t.notify_title)&&t.notify_title.length>0){r.title=t.notify_title}if(o.Type.isString(t.title)&&t.title.length>0){r.title=t.title}return r}},{key:"validateParams",value:function e(t){var n={};try{for(var r in t){if(!t.hasOwnProperty(r)){continue}if(r==="COMPONENT_ID"){if(o.Type.isString(t[r])&&BX.WidgetVue.isComponent(t[r])){n[r]=t[r]}}else if(r==="LIKE"){if(t[r]instanceof Array){n["REACTION"]={like:t[r].map((function(e){return parseInt(e)}))}}}else if(r==="CHAT_LAST_DATE"){n[r]=i.Utils.date.cast(t[r])}else if(r==="AVATAR"){if(t[r]){n[r]=t[r].startsWith("http")?t[r]:options.host+t[r]}}else if(r==="NAME"){if(t[r]){n[r]=t[r]}}else{n[r]=t[r]}}}catch(e){}var s=false;for(var a in n){if(!n.hasOwnProperty(a)){continue}s=true;break}return s?n:null}},{key:"prepareNotification",value:function e(t){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var i=this.validate(Object.assign({},t));return Object.assign({},this.getElementState(),i,n)}},{key:"findItemInArr",value:function e(t,n){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:"id";var r={};var s=t.findIndex((function(e,t){return e[i]===n}));if(s!==-1){r.index=s;r.element=t[s]}return r}},{key:"sortByType",value:function e(t,n){if(t.sectionCode===a.NotificationTypesCodes.confirm&&n.sectionCode!==a.NotificationTypesCodes.confirm){return-1}else if(t.sectionCode!==a.NotificationTypesCodes.confirm&&n.sectionCode===a.NotificationTypesCodes.confirm){return 1}else{return n.id-t.id}}},{key:"convertToHtml",value:function e(){var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var r=n.text,s=r===void 0?"":r;s=s.trim();s=s.replace(/\n/gi,"<br />");s=s.replace(/\t/gi,"&nbsp;&nbsp;&nbsp;&nbsp;");s=t.decodeBbCode({text:s});if(i.Utils.platform.isBitrixDesktop()){s=s.replace(/<a(.*?)>(.*?)<\/a>/gi,(function(e,t,n){return"<a"+t.replace('target="_self"','target="_blank"')+' class="bx-im-notifications-item-link">'+n+"</a>"}))}return s}}],[{key:"decodeBbCode",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var n=t.text;n=n.replace(/\[url=([^\]]+)\](.*?)\[\/url\]/gi,(function(e,t,n){var r=document.createElement("a");r.href=i.Utils.text.htmlspecialcharsback(t);r.target="_blank";r.text=i.Utils.text.htmlspecialcharsback(n);var s=["http:","https:","ftp:","file:","tel:","callto:","mailto:","skype:","viber:"];if(s.indexOf(r.protocol)<=-1){return e}return r.outerHTML}));n=n.replace(/\[LIKE\]/gi,'<span class="bx-smile bx-im-smile-like"></span>');n=n.replace(/\[DISLIKE\]/gi,'<span class="bx-smile bx-im-smile-dislike"></span>');n=n.replace(/\[RATING\=([1-5]{1})\]/gi,(function(e,t){return BX.MessengerCommon.linesVoteHeadNodes(0,t,false).outerHTML}));n=n.replace(/\[BR\]/gi,"<br/>");n=n.replace(/\[([buis])\](.*?)\[(\/[buis])\]/gi,(function(e,t,n,i){return"<"+t+">"+n+"<"+i+">"}));n=n.replace(/\[CHAT=(imol\|)?([0-9]{1,})\](.*?)\[\/CHAT\]/gi,(function(e,t,n,i){n=parseInt(n);if(n<=0){return i}if(t){return'<span class="bx-im-mention" data-type="OPENLINES" data-value="'+n+'">'+i+"</span>"}else{return'<span class="bx-im-mention" data-type="CHAT" data-value="'+n+'">'+i+"</span>"}}));n=n.replace(/\[USER=([0-9]{1,})\](.*?)\[\/USER\]/gi,(function(e,t,n){var i="";t=parseInt(t);if(t>0&&typeof BXIM!="undefined"){i='<span class="bx-im-mention '.concat(t===+BXIM.userId?"bx-messenger-ajax-self":"",'" data-type="USER" data-value="').concat(t,'">').concat(n,"</span>")}else{i=n}return i}));n=n.replace(/\[PCH=([0-9]{1,})\](.*?)\[\/PCH\]/gi,(function(e,t,n){return n}));return n}}]);return t}(s.WidgetVuexBuilderModel);var A=function(e){babelHelpers.inherits(t,e);function t(){babelHelpers.classCallCheck(this,t);return babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).apply(this,arguments))}babelHelpers.createClass(t,[{key:"getName",value:function e(){return"call"}},{key:"getState",value:function e(){return{users:{}}}},{key:"getElementState",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};return{id:t.id?t.id:0,state:a.ConferenceUserState.Idle,talking:false,pinned:false,cameraState:false,microphoneState:false,screenState:false,floorRequestState:false}}},{key:"getGetters",value:function e(){var t=this;return{getUser:function e(n){return function(e){e=parseInt(e,10);if(!n.users[e]){return t.getElementState({id:e})}return n.users[e]}},getBlankUser:function e(n){return function(e){e=parseInt(e,10);return t.getElementState({id:e})}}}}},{key:"getActions",value:function e(){var t=this;return{updateUser:function e(n,i){i.id=parseInt(i.id,10);i.fields=Object.assign({},t.validate(i.fields));n.commit("updateUser",i)},unpinUser:function e(t,n){t.commit("unpinUser")}}}},{key:"getMutations",value:function e(){var t=this;return{updateUser:function e(n,i){if(!n.users[i.id]){r.WidgetVue.set(n.users,i.id,Object.assign(t.getElementState(),i.fields,{id:i.id}))}else{n.users[i.id]=Object.assign(n.users[i.id],i.fields)}},unpinUser:function e(t,n){var i=Object.values(t.users).find((function(e){return e.pinned===true}));if(i){t.users[i.id].pinned=false}}}}},{key:"validate",value:function e(t){var n={};if(o.Type.isNumber(t.id)||o.Type.isString(t.id)){n.id=parseInt(t.id,10)}if(a.ConferenceUserState[t.state]){n.state=t.state}if(o.Type.isBoolean(t.talking)){n.talking=t.talking}if(o.Type.isBoolean(t.pinned)){n.pinned=t.pinned}if(o.Type.isBoolean(t.cameraState)){n.cameraState=t.cameraState}if(o.Type.isBoolean(t.microphoneState)){n.microphoneState=t.microphoneState}if(o.Type.isBoolean(t.screenState)){n.screenState=t.screenState}if(o.Type.isBoolean(t.floorRequestState)){n.floorRequestState=t.floorRequestState}return n}},{key:"getStateSaveException",value:function e(){return{users:false}}}]);return t}(s.WidgetVuexBuilderModel);e.ApplicationModel=l;e.ConferenceModel=u;e.MessagesModel=p;e.DialoguesModel=y;e.UsersModel=I;e.FilesModel=_;e.RecentModel=x;e.NotificationsModel=D;e.CallModel=A})(this.BX.Messenger.Model=this.BX.Messenger.Model||{},BX.Messenger.Lib,BX.Event,BX.Messenger.Lib,BX,BX,BX,BX.Messenger.Const);(function(e,t,n,i,r){"use strict";var s=Object.freeze({play:"play",pause:"pause",stop:"stop",none:"none"});i.WidgetBitrixVue.component("bx-audioplayer",{props:{id:{default:0},src:{default:""},autoPlayNext:{default:true},background:{default:"light"}},data:function e(){return{isDark:false,preload:"none",loaded:false,loading:false,playAfterLoad:false,state:s.none,progress:0,progressInPixel:0,seek:0,timeCurrent:0,timeTotal:0}},created:function e(){this.preloadRequestSent=false;this.registeredId=0;this.registerPlayer(this.id);this.$Bitrix.eventEmitter.subscribe("ui:audioplayer:play",this.onPlay);this.$Bitrix.eventEmitter.subscribe("ui:audioplayer:stop",this.onStop);this.$Bitrix.eventEmitter.subscribe("ui:audioplayer:pause",this.onPause);this.$Bitrix.eventEmitter.subscribe("ui:audioplayer:preload",this.onPreload);this.isDark=this.background==="dark"},mounted:function e(){this.getObserver().observe(this.$refs.body)},beforeDestroy:function e(){this.unregisterPlayer();this.$Bitrix.eventEmitter.unsubscribe("ui:audioplayer:play",this.onPlay);this.$Bitrix.eventEmitter.unsubscribe("ui:audioplayer:stop",this.onStop);this.$Bitrix.eventEmitter.unsubscribe("ui:audioplayer:pause",this.onPause);this.$Bitrix.eventEmitter.unsubscribe("ui:audioplayer:preload",this.onPreload);this.getObserver().unobserve(this.$refs.body)},watch:{id:function e(t){this.registerPlayer(t)},progress:function e(t){if(t>70){this.preloadNext()}}},methods:{loadFile:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;if(this.loaded){return true}if(this.loading&&!t){return true}this.preload="auto";if(t){this.loading=true;if(this.source()){this.source().play()}}return true},clickToButton:function e(){if(!this.src){return false}if(this.state===s.play){this.pause()}else{this.play()}},play:function e(){if(!this.loaded){this.loadFile(true);return false}this.source().play()},pause:function e(){this.source().pause()},stop:function e(){this.state=s.stop;this.source().pause()},setPosition:function e(t){if(!this.loaded){this.loadFile(true);return false}var n=this.$refs.track.offsetWidth/100;this.setProgress(this.seek/n,this.seek);if(this.state!==s.play){this.state=s.pause}this.play();this.source().currentTime=this.timeTotal/100*this.progress},seeking:function e(t){if(!this.loaded){return false}this.seek=t.offsetX>0?t.offsetX:0;return true},setProgress:function e(t){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:-1;this.progress=t;this.progressInPixel=n>0?n:Math.round(this.$refs.track.offsetWidth/100*t)},formatTime:function e(t){t=Math.floor(t);var n=Math.floor(t/60/60);if(n>0){t-=n*60*60}var i=Math.floor(t/60);if(i>0){t-=i*60}return(n>0?n+":":"")+(n>0?i.toString().padStart(2,"0")+":":i+":")+t.toString().padStart(2,"0")},registerPlayer:function e(t){var n=this;if(t<=0){return false}var i=this.$Bitrix.Data.get("ui-audioplayer-id",[]);i=babelHelpers.toConsumableArray(new Set([].concat(babelHelpers.toConsumableArray(i),[t]))).filter((function(e){return e!==n.registeredId})).sort((function(e,t){return e-t}));this.$Bitrix.Data.set("ui-audioplayer-id",i);this.registeredId=t;return true},unregisterPlayer:function e(){var t=this;if(!this.registeredId){return true}var n=this.$Bitrix.Data.get("ui-audioplayer-id",[]).filter((function(e){return e!==t.registeredId}));this.$Bitrix.Data.set("ui-audioplayer-id",n);this.registeredId=0;return true},playNext:function e(){var t=this;if(!this.registeredId||!this.autoPlayNext){return false}var n=this.$Bitrix.Data.get("ui-audioplayer-id",[]).filter((function(e){return e>t.registeredId})).slice(0,1)[0];if(n){this.$Bitrix.eventEmitter.emit("ui:audioplayer:play",{id:n,start:true})}return true},preloadNext:function e(){var t=this;if(this.preloadRequestSent){return true}if(!this.registeredId||!this.autoPlayNext){return false}this.preloadRequestSent=true;var n=this.$Bitrix.Data.get("ui-audioplayer-id",[]).filter((function(e){return e>t.registeredId})).slice(0,1)[0];if(n){this.$Bitrix.eventEmitter.emit("ui:audioplayer:preload",{id:n})}return true},onPlay:function e(t){var n=t.getData();if(n.id!==this.id){return false}if(n.start){this.stop()}this.play()},onStop:function e(t){var n=t.getData();if(n.initiator===this.id){return false}this.stop()},onPause:function e(t){var n=t.getData();if(n.initiator===this.id){return false}this.pause()},onPreload:function e(t){var n=t.getData();if(n.id!==this.id){return false}this.loadFile()},source:function e(){return this.$refs.source},audioEventRouter:function e(t,n){if(t==="durationchange"||t==="loadeddata"||t==="loadedmetadata"){this.timeTotal=this.source().duration}else if(t==="abort"||t==="error"){console.error("BxAudioPlayer: load failed",this.id,n);this.loading=false;this.state=s.none;this.timeTotal=0;this.preload="none"}else if(t==="canplaythrough"){this.loading=false;this.loaded=true}else if(t==="timeupdate"){if(!this.source()){return}this.timeCurrent=this.source().currentTime;this.setProgress(Math.round(100/this.timeTotal*this.timeCurrent));if(this.state===s.play&&this.timeCurrent>=this.timeTotal){this.playNext()}}else if(t==="pause"){if(this.state!==s.stop){this.state=s.pause}}else if(t==="play"){this.state=s.play;if(this.state===s.stop){this.progress=0;this.timeCurrent=0}if(this.id>0){this.$Bitrix.eventEmitter.emit("ui:audioplayer:pause",{initiator:this.id})}}},getObserver:function e(){var t=this;if(this.observer){return this.observer}this.observer=new IntersectionObserver((function(e,n){e.forEach((function(e){if(e.isIntersecting){if(t.preload==="none"){t.preload="metadata";t.observer.unobserve(e.target)}}}))}),{threshold:[0,1]});return this.observer}},computed:{State:function e(){return s},seekPosition:function e(){if(!this.loaded&&!this.seek||this.isMobile){return"display: none"}return"left: ".concat(this.seek,"px;")},progressPosition:function e(){if(!this.loaded||this.state===s.none){return"width: 100%;"}return"width: ".concat(this.progressInPixel,"px;")},labelTime:function e(){if(!this.loaded&&!this.timeTotal){return"--:--"}var t;if(this.state===s.play){t=this.timeTotal-this.timeCurrent}else{t=this.timeTotal}return this.formatTime(t)},isMobile:function e(){var t=navigator.userAgent.toLowerCase();return t.includes("android")||t.includes("iphone")||t.includes("ipad")||t.includes("bitrixmobile")}},template:'\n\t\t<div :class="[\'ui-vue-audioplayer-container\', {\n\t\t\t\t\'ui-vue-audioplayer-container-dark\': isDark,\n\t\t\t\t\'ui-vue-audioplayer-container-mobile\': isMobile,\n\t\t\t}]" ref="body">\n\t\t\t<div class="ui-vue-audioplayer-controls-container">\n\t\t\t\t<button :class="[\'ui-vue-audioplayer-control\', {\n\t\t\t\t\t\'ui-vue-audioplayer-control-loader\': loading,\n\t\t\t\t\t\'ui-vue-audioplayer-control-play\': !loading && state !== State.play,\n\t\t\t\t\t\'ui-vue-audioplayer-control-pause\': !loading && state === State.play,\n\t\t\t\t}]" @click="clickToButton"></button>\n\t\t\t</div>\n\t\t\t<div class="ui-vue-audioplayer-timeline-container">\n\t\t\t\t<div class="ui-vue-audioplayer-track-container" @click="setPosition" ref="track">\n\t\t\t\t\t<div class="ui-vue-audioplayer-track-mask"></div>\n\t\t\t\t\t<div class="ui-vue-audioplayer-track" :style="progressPosition"></div>\n\t\t\t\t\t<div class="ui-vue-audioplayer-track-seek" :style="seekPosition"></div>\n\t\t\t\t\t<div class="ui-vue-audioplayer-track-event" @mousemove="seeking"></div>\n\t\t\t\t</div>\n\t\t\t\t<div class="ui-vue-audioplayer-timers-container">\n\t\t\t\t\t<div class="ui-vue-audioplayer-time-current">{{labelTime}}</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<audio v-if="src" :src="src" class="ui-vue-audioplayer-source" ref="source" :preload="preload"\n\t\t\t\t@abort="audioEventRouter(\'abort\', $event)"\n\t\t\t\t@error="audioEventRouter(\'error\', $event)"\n\t\t\t\t@suspend="audioEventRouter(\'suspend\', $event)"\n\t\t\t\t@canplay="audioEventRouter(\'canplay\', $event)"\n\t\t\t\t@canplaythrough="audioEventRouter(\'canplaythrough\', $event)"\n\t\t\t\t@durationchange="audioEventRouter(\'durationchange\', $event)"\n\t\t\t\t@loadeddata="audioEventRouter(\'loadeddata\', $event)"\n\t\t\t\t@loadedmetadata="audioEventRouter(\'loadedmetadata\', $event)"\n\t\t\t\t@timeupdate="audioEventRouter(\'timeupdate\', $event)"\n\t\t\t\t@play="audioEventRouter(\'play\', $event)"\n\t\t\t\t@playing="audioEventRouter(\'playing\', $event)"\n\t\t\t\t@pause="audioEventRouter(\'pause\', $event)"\n\t\t\t></audio>\n\t\t</div>\n\t'})})(this.window=this.window||{},BX,BX,BX,BX.Event);(function(e,t,n,i,r,s){"use strict";var o=Object.freeze({play:"play",pause:"pause",stop:"stop",none:"none"});r.WidgetBitrixVue.component("bx-socialvideo",{props:{id:{default:0},src:{default:""},preview:{default:""},autoplay:{default:true},containerClass:{default:null},containerStyle:{default:null},elementStyle:{default:null},showControls:{default:true}},data:function e(){return{preload:"none",previewLoaded:false,loaded:false,loading:false,playAfterLoad:false,enterFullscreen:false,playBeforeMute:2,state:o.none,progress:0,timeCurrent:0,timeTotal:0,muteFlag:true}},created:function e(){if(!this.preview){this.previewLoaded=true;this.preload="metadata"}this.$Bitrix.eventEmitter.subscribe("ui:socialvideo:unmute",this.onUnmute)},mounted:function e(){this.getObserver().observe(this.$refs.body)},beforeDestroy:function e(){this.$Bitrix.eventEmitter.unsubscribe("ui:socialvideo:unmute",this.onUnmute);this.getObserver().unobserve(this.$refs.body)},watch:{id:function e(t){this.registeredId=t}},methods:{loadFile:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;if(this.loaded){return true}if(this.loading){return true}this.preload="auto";this.loading=true;this.playAfterLoad=t;return true},clickToButton:function e(t){if(!this.src){return false}if(this.state===o.play){this.getObserver().unobserve(this.$refs.body);this.pause()}else{this.play()}t.stopPropagation()},clickToMute:function e(){if(!this.src){return false}if(!this.muteFlag){this.mute()}else{this.unmute()}event.stopPropagation()},click:function e(t){if(this.autoPlayDisabled){this.play();t.stopPropagation();return false}if(this.isMobile){if(this.source().webkitEnterFullscreen){this.unmute();this.enterFullscreen=true;this.source().webkitEnterFullscreen()}else if(this.source().requestFullscreen){this.unmute();this.enterFullscreen=true;this.source().requestFullscreen()}else{this.$emit("click",t)}}else{this.$emit("click",t)}t.stopPropagation()},play:function e(t){if(!this.loaded){this.loadFile(true);return false}if(!this.source()){return false}this.source().play()},pause:function e(){if(!this.source()){return false}this.playAfterLoad=false;this.source().pause()},stop:function e(){if(!this.source()){return false}this.state=o.stop;this.source().pause()},mute:function e(){if(!this.source()){return false}this.muteFlag=true;this.playBeforeMute=2;this.source().muted=true},unmute:function e(){if(!this.source()){return false}this.muteFlag=false;this.source().muted=false;if(this.id>0){this.$Bitrix.eventEmitter.emit("ui:socialvideo:unmute",{initiator:this.id})}},setProgress:function e(t){this.progress=t},formatTime:function e(t){t=Math.floor(t);var n=Math.floor(t/60/60);if(n>0){t-=n*60*60}var i=Math.floor(t/60);if(i>0){t-=i*60}return(n>0?n+":":"")+(n>0?i.toString().padStart(2,"0")+":":i+":")+t.toString().padStart(2,"0")},onUnmute:function e(t){t=t.getData();if(t.initiator===this.id){return false}this.mute()},source:function e(){return this.$refs.source},videoEventRouter:function e(t,n){if(t==="durationchange"||t==="loadeddata"){if(!this.source()){return false}this.timeTotal=this.source().duration}else if(t==="loadedmetadata"){if(!this.source()){return false}this.timeTotal=this.source().duration;this.loaded=true;if(this.playAfterLoad){this.play()}}else if(t==="abort"||t==="error"){console.error("BxSocialVideo: load failed",this.id,n);this.loading=false;this.state=o.none;this.timeTotal=0;this.preload="none"}else if(t==="canplaythrough"){this.loading=false;this.loaded=true;if(this.playAfterLoad){this.play()}}else if(t==="volumechange"){if(!this.source()){return false}if(this.source().muted){this.mute()}else{this.unmute()}}else if(t==="timeupdate"){if(!this.source()){return false}this.timeCurrent=this.source().currentTime;if(!this.muteFlag&&!this.enterFullscreen&&this.timeCurrent===0){if(this.playBeforeMute<=0){this.mute()}this.playBeforeMute-=1}this.setProgress(Math.round(100/this.timeTotal*this.timeCurrent))}else if(t==="pause"){if(this.state!==o.stop){this.state=o.pause}if(this.enterFullscreen){this.enterFullscreen=false;this.mute();this.play()}}else if(t==="play"){this.state=o.play;if(this.state===o.stop){this.progress=0;this.timeCurrent=0}if(this.enterFullscreen){this.enterFullscreen=false}}},getObserver:function e(){var t=this;if(this.observer){return this.observer}this.observer=new IntersectionObserver((function(e,n){if(t.autoPlayDisabled){return false}e.forEach((function(e){if(e.isIntersecting){t.play()}else{t.pause()}}))}),{threshold:[0,1]});return this.observer},lazyLoadCallback:function e(t){this.previewLoaded=t.state==="success"}},computed:{State:function e(){return o},autoPlayDisabled:function e(){return!this.autoplay&&this.state===o.none},showStartButton:function e(){return this.autoPlayDisabled&&this.previewLoaded},showInterface:function e(){return this.previewLoaded&&!this.showStartButton},labelTime:function e(){if(!this.loaded&&!this.timeTotal){return"--:--"}var t;if(this.state===o.play){t=this.timeTotal-this.timeCurrent}else{t=this.timeTotal}return this.formatTime(t)},isMobile:function e(){var t=navigator.userAgent.toLowerCase();return t.includes("android")||t.includes("iphone")||t.includes("ipad")||t.includes("bitrixmobile")}},template:'\n\t\t<div :class="[\'ui-vue-socialvideo\', containerClass, {\n\t\t\t\t\'ui-vue-socialvideo-mobile\': isMobile,\n\t\t\t}]" :style="containerStyle" @click="click">\n\t\t\t<transition name="ui-vue-socialvideo-animation-fade">\n\t\t\t\t<div v-if="showStartButton && showControls" class="ui-vue-socialvideo-button-start">\n\t\t\t\t\t<span class="ui-vue-socialvideo-button-start-icon"></span>\n\t\t\t\t</div>\n\t\t\t</transition>\n\t\t\t<transition name="ui-vue-socialvideo-animation-fade">\n\t\t\t\t<div v-if="showInterface && showControls" class="ui-vue-socialvideo-overlay-container">\n\t\t\t\t\t<div class="ui-vue-socialvideo-controls-container" @click="clickToButton">\n\t\t\t\t\t\t<button :class="[\'ui-vue-socialvideo-control\', {\n\t\t\t\t\t\t\t\'ui-vue-socialvideo-control-loader\': loading,\n\t\t\t\t\t\t\t\'ui-vue-socialvideo-control-play\': !loading && state !== State.play,\n\t\t\t\t\t\t\t\'ui-vue-socialvideo-control-pause\': !loading && state === State.play,\n\t\t\t\t\t\t}]"></button>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="ui-vue-socialvideo-info-container" @click="clickToMute">\n\t\t\t\t\t\t<span class="ui-vue-socialvideo-time-current">{{labelTime}}</span>\n\t\t\t\t\t\t<span :class="[\'ui-vue-socialvideo-sound\', {\n\t\t\t\t\t\t\t\'ui-vue-socialvideo-sound-on\': state !== State.none && !muteFlag,\n\t\t\t\t\t\t\t\'ui-vue-socialvideo-sound-off\': state !== State.none && muteFlag\n\t\t\t\t\t\t}]"></span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</transition>\n\t\t\t<div v-if="!preview" class="ui-vue-socialvideo-background" :style="{position: (src? \'absolute\': \'relative\')}"></div>\n\t\t\t<div class="ui-vue-socialvideo-container" ref="body">\n\t\t\t\t<img \n\t\t\t\t\tv-bx-lazyload="{callback: lazyLoadCallback}"\n\t\t\t\t\tdata-lazyload-dont-hide\n\t\t\t\t\tv-if="preview"\n\t\t\t\t\tclass="ui-vue-socialvideo-image-source"\n\t\t\t\t\t:data-lazyload-src="preview"\n\t\t\t\t\t:style="{position: (src? \'absolute\': \'relative\'), ...elementStyle}"\n\t\t\t\t/>\n\t\t\t\t<video \n\t\t\t\t\tv-if="src" :src="src" \n\t\t\t\t\tclass="ui-vue-socialvideo-source" \n\t\t\t\t\tref="source"\n\t\t\t\t\t:preload="preload" \n\t\t\t\t\tplaysinline\n\t\t\t\t\tloop \n\t\t\t\t\tmuted\n\t\t\t\t\t:style="{opacity: (loaded? 1: 0), ...elementStyle}"\n\t\t\t\t\t@abort="videoEventRouter(\'abort\', $event)"\n\t\t\t\t\t@error="videoEventRouter(\'error\', $event)"\n\t\t\t\t\t@suspend="videoEventRouter(\'suspend\', $event)"\n\t\t\t\t\t@canplay="videoEventRouter(\'canplay\', $event)"\n\t\t\t\t\t@canplaythrough="videoEventRouter(\'canplaythrough\', $event)"\n\t\t\t\t\t@durationchange="videoEventRouter(\'durationchange\', $event)"\n\t\t\t\t\t@loadeddata="videoEventRouter(\'loadeddata\', $event)"\n\t\t\t\t\t@loadedmetadata="videoEventRouter(\'loadedmetadata\', $event)"\n\t\t\t\t\t@volumechange="videoEventRouter(\'volumechange\', $event)"\n\t\t\t\t\t@timeupdate="videoEventRouter(\'timeupdate\', $event)"\n\t\t\t\t\t@play="videoEventRouter(\'play\', $event)"\n\t\t\t\t\t@playing="videoEventRouter(\'playing\', $event)"\n\t\t\t\t\t@pause="videoEventRouter(\'pause\', $event)"\n\t\t\t\t></video>\n\t\t\t</div>\n\t\t</div>\t\n\t'})})(this.window=this.window||{},BX,window,BX,BX,BX.Event);(function(e,t,n,i,r,s,o,a,l,u,c,f,d){"use strict";function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){babelHelpers.defineProperty(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}d.WidgetBitrixVue.component("bx-im-view-element-file",{mounted:function e(){this.createProgressbar()},beforeDestroy:function e(){this.removeProgressbar()},props:{userId:{default:0},messageType:{default:s.MessageType.self},file:{type:Object,default:i.FilesModel.create().getElementState}},methods:{download:function e(t){if(t.progress!==100){return false}if(BX.UI&&BX.UI.Viewer&&Object.keys(t.viewerAttrs).length>0){return false}if(t.type===s.FileType.image&&t.urlShow){if(f.Utils.platform.isBitrixMobile()){BXMobileApp.UI.Photo.show({photos:this.files.collection[this.application.dialog.chatId].filter((function(e){return e.type==="image"})).map((function(e){return{url:e.urlShow.replace("bxhttp","http")}})).reverse(),default_photo:t.urlShow.replace("bxhttp","http")})}else{window.open(t.urlShow,"_blank")}}else if(t.type===s.FileType.video&&t.urlShow){if(f.Utils.platform.isBitrixMobile()){app.openDocument({url:t.urlShow,name:t.name})}else{window.open(t.urlShow,"_blank")}}else if(t.urlDownload){if(f.Utils.platform.isBitrixMobile()){app.openDocument({url:t.urlDownload,name:t.name})}else{window.open(t.urlDownload,"_blank")}}else{if(f.Utils.platform.isBitrixMobile()){app.openDocument({url:t.urlShow,name:t.name})}else{window.open(t.urlShow,"_blank")}}},createProgressbar:function e(){var n=this;if(this.uploader){return true}if(this.file.progress===100){return false}var i=undefined;if(this.file.progress<0||this.file.type!==s.FileType.image&&this.file.type!==s.FileType.video){i=false}this.uploader=new t.Uploader({container:this.$refs.container,blurElement:i,direction:this.$refs.container.offsetHeight>54?t.Uploader.direction.vertical:t.Uploader.direction.horizontal,icon:this.file.progress<0?t.Uploader.icon.cloud:t.Uploader.icon.cancel,sizes:{circle:this.$refs.container.offsetHeight>54?54:38,progress:this.$refs.container.offsetHeight>54?4:8},labels:{loading:this.localize["IM_MESSENGER_ELEMENT_FILE_UPLOAD_LOADING"],completed:this.localize["IM_MESSENGER_ELEMENT_FILE_UPLOAD_COMPLETED"],canceled:this.localize["IM_MESSENGER_ELEMENT_FILE_UPLOAD_CANCELED"],cancelTitle:this.localize["IM_MESSENGER_ELEMENT_FILE_UPLOAD_CANCEL_TITLE"],megabyte:this.localize["IM_MESSENGER_ELEMENT_FILE_SIZE_MB"]},cancelCallback:this.file.progress<0?null:function(e){r.EventEmitter.emit(s.EventType.dialog.clickOnUploadCancel,{file:n.file,event:e})},destroyCallback:function e(){if(n.uploader){n.uploader=null}}});this.uploader.start();if(this.file.size&&this.file.size/1024/1024<=2||this.$refs.container.offsetHeight<=54&&this.$refs.container.offsetWidth<240){this.uploader.setProgressTitleVisibility(false)}this.updateProgressbar();return true},updateProgressbar:function e(){if(!this.uploader){var n=this.createProgressbar();if(!n){return false}}if(this.file.status===s.FileStatus.error){this.uploader.setProgress(0);this.uploader.setCancelDisable(false);this.uploader.setIcon(t.Uploader.icon.error);this.uploader.setProgressTitle(this.localize["IM_MESSENGER_ELEMENT_FILE_UPLOAD_ERROR"])}else if(this.file.status===s.FileStatus.wait){this.uploader.setProgress(this.file.progress>5?this.file.progress:5);this.uploader.setCancelDisable(true);this.uploader.setIcon(t.Uploader.icon.cloud);this.uploader.setProgressTitle(this.localize["IM_MESSENGER_ELEMENT_FILE_UPLOAD_SAVING"])}else if(this.file.progress===100){this.uploader.setProgress(100)}else if(this.file.progress===-1){this.uploader.setProgress(10);this.uploader.setProgressTitle(this.localize["IM_MESSENGER_ELEMENT_FILE_UPLOAD_WAITING"])}else{if(this.file.progress===0){this.uploader.setIcon(t.Uploader.icon.cancel)}var i=this.file.progress>5?this.file.progress:5;this.uploader.setProgress(i);if(this.file.size/1024/1024<=2){this.uploader.setProgressTitle(this.localize["IM_MESSENGER_ELEMENT_FILE_UPLOAD_LOADING"])}else{this.uploader.setByteSent(this.file.size/100*this.file.progress,this.file.size)}}},removeProgressbar:function e(){if(!this.uploader){return true}this.uploader.destroy(false);return true}},computed:p({FileStatus:function e(){return s.FileStatus},localize:function e(){return d.WidgetBitrixVue.getFilteredPhrases("IM_MESSENGER_ELEMENT_FILE_",this)},fileName:function e(){var t=70;if(this.file.name.length<t){return this.file.name}var n=10;var i=this.file.name.substring(this.file.name.length-1-(this.file.extension.length+1+n));var r=this.file.name.substring(0,t-i.length-3);return r.trim()+"..."+i.trim()},fileSize:function e(){var t=this.file.size;if(t<=0){return"&nbsp;"}var n=["BYTE","KB","MB","GB","TB"];var i=0;while(t>=1024&&i<4){t/=1024;i++}return Math.round(t)+" "+this.localize["IM_MESSENGER_ELEMENT_FILE_SIZE_"+n[i]]},uploadProgress:function e(){return this.file.status+" "+this.file.progress}},n.WidgetVuex.mapState({application:function e(t){return t.application},files:function e(t){return t.files}})),watch:{uploadProgress:function e(){this.updateProgressbar()}},template:'\n\t\t<div class="bx-im-element-file" @click="download(file, $event)" ref="container">\n\t\t\t<div class="bx-im-element-file-icon">\n\t\t\t\t<div :class="[\'ui-icon\', \'ui-icon-file-\'+file.icon]"><i></i></div>\n\t\t\t</div>\n\t\t\t<div class="bx-im-element-file-block">\n\t\t\t\t<div class="bx-im-element-file-name" :title="file.name">\n\t\t\t\t\t{{fileName}}\n\t\t\t\t</div>\n\t\t\t\t<div class="bx-im-element-file-size" v-html="fileSize"></div>\n\t\t\t</div>\n\t\t</div>\n\t'});d.WidgetVue.cloneComponent("bx-im-view-element-file-audio","bx-im-view-element-file",{computed:{background:function e(){return this.messageType===s.MessageType.self?"dark":"light"}},template:'\n\t\t<div :class="[\'bx-im-element-file-audio\', \'bx-im-element-file-audio-\'+messageType]" ref="container">\n\t\t\t<bx-audioplayer :id="file.id" :src="file.urlShow" :background="background"/>\n\t\t</div>\t\n\t'});d.WidgetVue.cloneComponent("bx-im-view-element-file-image","bx-im-view-element-file",{methods:{getImageSize:function e(t,n,i){var r;if(t>i){r=i/t}else{r=1}return{width:t*r,height:n*r}}},computed:{styleFileSizes:function e(){var t=this.getImageSize(this.file.image.width,this.file.image.height,280);return{width:t.width+"px",height:t.height+"px",backgroundSize:t.width<100||t.height<100?"contain":"initial"}},styleBoxSizes:function e(){if(parseInt(this.styleFileSizes.height)<=280){return{}}return{height:"280px"}},fileSource:function e(){return this.file.urlPreview}},template:'\n\t\t<div class="bx-im-element-file-image" @click="download(file, $event)" :style="styleBoxSizes" ref="container">\n\t\t\t<img v-bx-lazyload\n\t\t\t\tclass="bx-im-element-file-image-source"\n\t\t\t\t:data-lazyload-src="fileSource"\n\t\t\t\t:title="$Bitrix.Loc.getMessage(\'IM_MESSENGER_ELEMENT_FILE_SHOW_TITLE\').replace(\'#NAME#\', file.name).replace(\'#SIZE#\', fileSize)"\n\t\t\t\t:style="styleFileSizes"\n\t\t\t\t:data-viewer="file.viewerAttrs.viewer === null"\n\t\t\t\t:data-viewer-type="file.viewerAttrs.viewerType? file.viewerAttrs.viewerType: false"\n\t\t\t\t:data-src="file.viewerAttrs.src? file.viewerAttrs.src: false"\n\t\t\t\t:data-viewer-group-by="file.viewerAttrs.viewerGroupBy? file.viewerAttrs.viewerGroupBy: false"\n\t\t\t\t:data-title="file.viewerAttrs.title? file.viewerAttrs.title: false"\n\t\t\t\t:data-actions="file.viewerAttrs.actions? file.viewerAttrs.actions: false"\n\t\t\t/>\n\t\t</div>\n\t'});d.WidgetVue.cloneComponent("bx-im-view-element-file-video","bx-im-view-element-file",{methods:{getImageSize:function e(t,n,i){var r;if(t>i){r=i/t}else{r=1}return{width:t*r,height:n*r}}},computed:{isSafari:function e(){return f.Utils.browser.isSafari()||f.Utils.platform.isBitrixMobile()},styleBoxSizes:function e(){if(parseInt(this.styleVideoSizes.height)<=280){return{}}return{height:"280px"}},styleVideoSizes:function e(){if(!this.file.image){return{}}var t=this.getImageSize(this.file.image.width,this.file.image.height,280);return{width:t.width+"px",height:t.height+"px",backgroundSize:t.width<100||t.height<100?"contain":"initial"}},autoplay:function e(){return this.file.size<5e6&&this.application.options.autoplayVideo}},template:'\n\t\t<div :class="[\'bx-im-element-file-video\', {\'bx-im-element-file-video-safari\': isSafari}]" :style="styleBoxSizes" ref="container">\n\t\t\t<bx-socialvideo \n\t\t\t\t:id="file.id" \n\t\t\t\t:src="file.urlShow" \n\t\t\t\t:preview="file.urlPreview" \n\t\t\t\t:containerStyle="styleBoxSizes"\n\t\t\t\t:elementStyle="styleVideoSizes"\n\t\t\t\t:autoplay="autoplay"\n\t\t\t\t:showControls="!file.viewerAttrs.viewerType"\n\t\t\t\t:data-viewer="file.viewerAttrs.viewer === null"\n\t\t\t\t:data-viewer-type="file.viewerAttrs.viewerType? file.viewerAttrs.viewerType: false"\n\t\t\t\t:data-src="file.viewerAttrs.src? file.viewerAttrs.src: false"\n\t\t\t\t:data-viewer-group-by="file.viewerAttrs.viewerGroupBy? file.viewerAttrs.viewerGroupBy: false"\n\t\t\t\t:data-title="file.viewerAttrs.title? file.viewerAttrs.title: false"\n\t\t\t\t:data-actions="file.viewerAttrs.action? file.viewerAttrs.actions: false"\n\t\t\t\t@click="download(file, $event)"\n\t\t\t/>\n\t\t</div>\n\t'})})(this.window=this.window||{},BX.ProgressBarJs,BX,BX.Messenger.Model,BX.Event,BX.Messenger.Const,window,BX,window,BX,window,BX.Messenger.Lib,BX);(function(e,t,n,i,r,s,o){"use strict";var a={property:"DELIMITER",name:"bx-im-view-element-attach-delimiter",component:{props:{config:{type:Object,default:{}},color:{type:String,default:"transparent"}},computed:{styles:function e(){return{width:this.config.DELIMITER.SIZE?this.config.DELIMITER.SIZE+"px":"",backgroundColor:this.config.DELIMITER.COLOR?this.config.DELIMITER.COLOR:this.color}}},template:'<div class="bx-im-element-attach-type-delimiter" :style="styles"></div>'}};var l={property:"FILE",name:"bx-im-element-attach-file",component:{props:{config:{type:Object,default:{}},color:{type:String,default:"transparent"}},methods:{openLink:function e(t){s.Utils.platform.openNewPage(t.LINK)},file:function e(){return{name:this.config.FILE.NAME,extension:this.config.FILE.NAME.split(".").splice(-1)[0],size:this.config.FILE.SIZE}},fileName:function e(t){var n=70;if(!t.NAME||t.NAME.length<n){return t.NAME}var i=10;var r=t.NAME.split(".").splice(-1)[0];var s=t.NAME.substring(t.NAME.length-1-(r.length+1+i));var o=t.NAME.substring(0,n-s.length-3);return o.trim()+"..."+s.trim()},fileNameFull:function e(t){return t.NAME},fileSize:function e(t){var n=t.SIZE;if(n<=0){return""}var i=["BYTE","KB","MB","GB","TB"];var r=0;while(n>=1024&&r<4){n/=1024;r++}return Math.round(n)+" "+this.$Bitrix.Loc.getMessage("IM_MESSENGER_ATTACH_FILE_SIZE_"+i[r])},fileIcon:function e(t){return r.FilesModel.getIconType(t.NAME.split(".").splice(-1)[0])}},template:'\n\t\t\t<div class="bx-im-element-attach-type-file-element">\n\t\t\t\t<template v-for="(element, index) in config.FILE">\n\t\t\t\t\t<div class="bx-im-element-attach-type-file" @click="openLink(element)">\n\t\t\t\t\t\t<div class="bx-im-element-attach-type-file-icon">\n\t\t\t\t\t\t\t<div :class="[\'ui-icon\', \'ui-icon-file-\'+fileIcon(element)]"><i></i></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="bx-im-element-attach-type-file-block">\n\t\t\t\t\t\t\t<div class="bx-im-element-attach-type-file-name" :title="fileNameFull(element)">\n\t\t\t\t\t\t\t\t{{fileName(element)}}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="bx-im-element-attach-type-file-size">{{fileSize(element)}}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t</div>\n\t\t'}};var u={methods:{openLink:function e(t){var n=t.element;var i=t.event;if(!s.Utils.platform.isBitrixMobile()&&n.LINK){return}if(n.LINK&&i.target.tagName!=="A"){s.Utils.platform.openNewPage(n.LINK)}else if(!n.LINK){var r={id:null,type:null};if(n.hasOwnProperty("USER_ID")&&n.USER_ID>0){r.id=n.USER_ID;r.type="user"}if(n.hasOwnProperty("CHAT_ID")&&n.CHAT_ID>0){r.id=n.CHAT_ID;r.type="chat"}if(r.id&&r.type&&window.top["BXIM"]){var o=!BX.MessengerTheme.isDark();window.top["BXIM"].messenger.openPopupExternalData(i.target,r.type,o,{ID:r.id})}else if(navigator.userAgent.toLowerCase().includes("bitrixmobile")){var a="";if(r.type==="chat"){a="chat".concat(r.id)}else{a=r.id}if(a!==""){BXMobileApp.Events.postToComponent("onOpenDialog",[{dialogId:a},true],"im.recent")}}}}}};var c={property:"GRID",name:"bx-im-view-element-attach-grid",component:{mixins:[u],props:{config:{type:Object,default:{}},color:{type:String,default:"transparent"}},created:function e(){if(s.Utils.platform.isBitrixMobile()){this.maxCellWith=Math.floor(Math.min(screen.availWidth,screen.availHeight)/4)}else{this.maxCellWith=null}},methods:{getWidth:function e(t){if(t.DISPLAY!=="row"){return t.WIDTH?t.WIDTH+"px":""}if(!t.VALUE){return false}if(this.maxCellWith&&t.WIDTH>this.maxCellWith){return this.maxCellWith+"px"}return t.WIDTH?t.WIDTH+"px":""},getValue:function e(t){var n=this;if(!t.VALUE){return""}var i=s.Utils.text.htmlspecialchars(t.VALUE);i=i.replace(/\[USER=([0-9]{1,})\](.*?)\[\/USER\]/gi,(function(e,t,i){var r=n.$store.getters["users/get"](t);i=r?s.Utils.text.htmlspecialchars(r.name):i;return'<span class="bx-im-mention" data-type="USER" data-value="'+t+'">'+i+"</span>"}));return r.MessagesModel.decodeBbCode({text:i})}},template:'\n\t\t\t<div class="bx-im-element-attach-type-grid">\n\t\t\t\t<template v-for="(element, index) in config.GRID">\n\t\t\t\t\t<template v-if="element.DISPLAY.toLowerCase() === \'block\'">\n\t\t\t\t\t\t<div class="bx-im-element-attach-type-grid-display bx-im-element-attach-type-display-block" :style="{width: getWidth(element)}">\n\t\t\t\t\t\t\t<div class="bx-im-element-attach-type-grid-element-name">{{element.NAME}}</div>\n\t\t\t\t\t\t\t<template v-if="element.LINK">\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tclass="bx-im-element-attach-type-grid-element-value bx-im-element-attach-type-grid-element-value-link"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<a :href="element.LINK" target="_blank" @click="openLink({element: element, event: $event})" v-html="getValue(element)"></a>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t\t\t<div class="bx-im-element-attach-type-grid-element-value" v-html="getValue(element)"></div>\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</template>\n\t\t\t\t\t<template v-else-if="element.DISPLAY.toLowerCase() === \'line\'">\n\t\t\t\t\t\t<div class="bx-im-element-attach-type-grid-display bx-im-element-attach-type-display-card" :style="{width: getWidth(element)}">\n\t\t\t\t\t\t\t<div class="bx-im-element-attach-type-grid-element-name">{{element.NAME}}</div>\n\t\t\t\t\t\t\t<template v-if="element.LINK">\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tclass="bx-im-element-attach-type-grid-element-value bx-im-element-attach-type-grid-element-value-link"\n\t\t\t\t\t\t\t\t\t:style="{color: element.COLOR? element.COLOR: \'\'}"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<a :href="element.LINK" target="_blank" @click="openLink({element: element, event: $event})" v-html="getValue(element)"></a>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t\t\t<div class="bx-im-element-attach-type-grid-element-value" :style="{color: element.COLOR? element.COLOR: \'\'}" v-html="getValue(element)"></div>\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</template>\n\t\t\t\t\t<template v-else-if="element.DISPLAY.toLowerCase() === \'row\'">\n\t\t\t\t\t\t<div class="bx-im-element-attach-type-grid-display bx-im-element-attach-type-display-column">\n\t\t\t\t\t\t\t<table class="bx-im-element-attach-type-display-column-table">\n\t\t\t\t\t\t\t\t<tbody>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<template v-if="element.NAME">\n\t\t\t\t\t\t\t\t\t\t\t<td class="bx-im-element-attach-type-grid-element-name" :colspan="element.VALUE? 1: 2" :style="{width: getWidth(element)}">{{element.NAME}}</td>\n\t\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t\t\t<template v-if="element.VALUE">\n\t\t\t\t\t\t\t\t\t\t\t<template v-if="element.LINK">\n\t\t\t\t\t\t\t\t\t\t\t\t<td\n\t\t\t\t\t\t\t\t\t\t\t\t\tclass="bx-im-element-attach-type-grid-element-value bx-im-element-attach-type-grid-element-value-link"\n\t\t\t\t\t\t\t\t\t\t\t\t\t:colspan="element.NAME? 1: 2"\n\t\t\t\t\t\t\t\t\t\t\t\t\t:style="{color: element.COLOR? element.COLOR: \'\'}"\n\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<a :href="element.LINK" target="_blank" @click="openLink({element: element, event: $event})" v-html="getValue(element)"></a>\n\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t\t\t\t\t\t\t<td class="bx-im-element-attach-type-grid-element-value" :colspan="element.NAME? 1: 2" :style="{color: element.COLOR? element.COLOR: \'\'}" v-html="getValue(element)"></td>\n\t\t\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t</tbody>\n\t\t\t\t\t\t\t</table>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</template>\n\t\t\t\t</template>\n\t\t\t</div>\n\t\t'}};var f={property:"HTML",name:"bx-im-view-element-attach-html",component:{props:{config:{type:Object,default:{}},color:{type:String,default:"transparent"}},template:'<div class="bx-im-element-attach-type-html" v-html="config.HTML"></div>'}};var d={property:"IMAGE",name:"bx-im-view-element-attach-image",component:{props:{config:{type:Object,default:{}},color:{type:String,default:"transparent"}},methods:{open:function e(t){if(!t){return false}if(s.Utils.platform.isBitrixMobile()){BXMobileApp.UI.Photo.show({photos:[{url:t}],default_photo:t})}else{window.open(t,"_blank")}},getImageSize:function e(t,n,i){var r;if(t>i){r=i/t}else{r=1}return{width:t*r,height:n*r}},getElementSource:function e(t){return t.PREVIEW?t.PREVIEW:t.LINK},getElementTitle:function e(t){return s.Utils.text.htmlspecialcharsback(t.NAME)},lazyLoadCallback:function e(t){if(!t.element.style.width){t.element.style.width=t.element.offsetWidth+"px"}if(!t.element.style.height){t.element.style.height=t.element.offsetHeight+"px"}},styleFileSizes:function e(t){if(!(t.WIDTH&&t.HEIGHT)){return{maxHeight:"100%",backgroundSize:"contain"}}var n=this.getImageSize(t.WIDTH,t.HEIGHT,250);return{width:n.width+"px",height:n.height+"px",backgroundSize:n.width<100||n.height<100?"contain":"initial"}},styleBoxSizes:function e(t){if(!(t.WIDTH&&t.HEIGHT)){return{height:"150px"}}if(parseInt(this.styleFileSizes(t).height)<=250){return{}}return{height:"280px"}}},template:'\n\t\t\t<div class="bx-im-element-attach-type-image">\n\t\t\t\t<template v-for="(image, index) in config.IMAGE">\n\t\t\t\t\t<div class="bx-im-element-attach-type-image-block" @click="open(image.LINK)" :style="styleBoxSizes(image)" :key="index">\n\t\t\t\t\t\t<img v-bx-lazyload="{callback: lazyLoadCallback}"\n\t\t\t\t\t\t\tclass="bx-im-element-attach-type-image-source"\n\t\t\t\t\t\t\t:data-lazyload-src="getElementSource(image)"\n\t\t\t\t\t\t\t:style="styleFileSizes(image)"\n\t\t\t\t\t\t\t:title="getElementTitle(image)"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t</div>\n\t\t'}};var h={property:"LINK",name:"bx-im-view-element-attach-link",component:{mixins:[u],props:{config:{type:Object,default:{}},color:{type:String,default:"transparent"}},methods:{getImageConfig:function e(t){return{IMAGE:[{NAME:t.NAME,PREVIEW:t.PREVIEW,WIDTH:t.WIDTH,HEIGHT:t.HEIGHT}]}},getLinkName:function e(t){return t.NAME?t.NAME:t.LINK}},computed:{imageComponentName:function e(){return d.name}},components:babelHelpers.defineProperty({},d.name,d.component),template:'\n\t\t\t<div class="bx-im-element-attach-type-link">\n\t\t\t\t<template v-for="(element, index) in config.LINK">\n\t\t\t\t\t<div class="bx-im-element-attach-type-link-element" :key="index">\n\t\t\t\t\t\t<a \n\t\t\t\t\t\t\tv-if="element.LINK"\n\t\t\t\t\t\t\t:href="element.LINK"\n\t\t\t\t\t\t\ttarget="_blank"\n\t\t\t\t\t\t\tclass="bx-im-element-attach-type-link-name" \n\t\t\t\t\t\t\t@click="openLink({element: element, event: $event})"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{{getLinkName(element)}}\n\t\t\t\t\t\t</a>\n\t\t\t\t\t\t<span \n\t\t\t\t\t\t\tv-else\n\t\t\t\t\t\t\tclass="bx-im-element-attach-type-ajax-link"\n\t\t\t\t\t\t\t@click="openLink({element: element, event: $event})"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{{getLinkName(element)}}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<div v-if="element.DESC" class="bx-im-element-attach-type-link-desc">{{element.DESC}}</div>\n\t\t\t\t\t\t<div \n\t\t\t\t\t\t\tv-if="element.PREVIEW" \n\t\t\t\t\t\t\tclass="bx-im-element-attach-type-link-image"\n\t\t\t\t\t\t\t@click="openLink({element: element, event: $event})"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<component :is="imageComponentName" :config="getImageConfig(element)" :color="color"/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t</div>\n\t\t'}};var p={property:"MESSAGE",name:"bx-im-view-element-attach-message",component:{props:{config:{type:Object,default:{}},color:{type:String,default:"transparent"}},computed:{message:function e(){var t=this;var n=s.Utils.text.htmlspecialchars(this.config.MESSAGE);n=n.replace(/\[USER=([0-9]{1,})\](.*?)\[\/USER\]/gi,(function(e,n,i){var r=t.$store.getters["users/get"](n);i=r?s.Utils.text.htmlspecialchars(r.name):i;return'<span class="bx-im-mention" data-type="USER" data-value="'+n+'">'+i+"</span>"}));return r.MessagesModel.decodeBbCode({text:n})}},template:'<div class="bx-im-element-attach-type-message" v-html="message"></div>'}};var m={property:"RICH_LINK",name:"bx-im-view-element-attach-rich",component:{mixins:[u],props:{config:{type:Object,default:{}},color:{type:String,default:"transparent"}},methods:{getImageConfig:function e(t){return{IMAGE:[{NAME:t.NAME,PREVIEW:t.PREVIEW,WIDTH:t.WIDTH,HEIGHT:t.HEIGHT}]}}},computed:{imageComponentName:function e(){return d.name}},components:babelHelpers.defineProperty({},d.name,d.component),template:'\n\t\t\t<div class="bx-im-element-attach-type-rich">\n\t\t\t\t<template v-for="(element, index) in config.RICH_LINK">\n\t\t\t\t\t<div class="bx-im-element-attach-type-rich-element" :key="index">\n\t\t\t\t\t\t<div v-if="element.PREVIEW" class="bx-im-element-attach-type-rich-image" @click="openLink({element: element, event: $event})">\n\t\t\t\t\t\t\t<component :is="imageComponentName" :config="getImageConfig(element)" :color="color"/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="bx-im-element-attach-type-rich-name" @click="openLink({element: element, event: $event})">{{element.NAME}}</div>\n\t\t\t\t\t\t<div v-if="element.DESC" class="bx-im-element-attach-type-rich-desc">{{element.DESC}}</div>\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t</div>\n\t\t'}};var g={property:"USER",name:"bx-im-view-element-attach-user",component:{mixins:[u],props:{config:{type:Object,default:{}},color:{type:String,default:"transparent"}},methods:{getAvatarType:function e(t){if(t.AVATAR){return""}var n="user";if(t.AVATAR_TYPE==="CHAT"){n="chat"}else if(t.AVATAR_TYPE==="BOT"){n="bot"}return"bx-im-element-attach-type-user-avatar-type-"+n}},template:'\n\t\t\t<div class="bx-im-element-attach-type-user">\n\t\t\t\t<template v-for="(element, index) in config.USER">\n\t\t\t\t\t<div class="bx-im-element-attach-type-user-body">\n\t\t\t\t\t\t<div class="bx-im-element-attach-type-user-avatar">\n\t\t\t\t\t\t\t<div :class="[\'bx-im-element-attach-type-user-avatar-type\', getAvatarType(element)]" :style="{backgroundColor: element.AVATAR? \'\': color}">\n\t\t\t\t\t\t\t\t<img v-if="element.AVATAR" \n\t\t\t\t\t\t\t\t\tv-bx-lazyload\n\t\t\t\t\t\t\t\t\tclass="bx-im-element-attach-type-user-avatar-source"\n\t\t\t\t\t\t\t\t\t:data-lazyload-src="element.AVATAR"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<a\n\t\t\t\t\t\t\tv-if="element.LINK"\n\t\t\t\t\t\t\t:href="element.LINK" \n\t\t\t\t\t\t\tclass="bx-im-element-attach-type-user-name"\n\t\t\t\t\t\t\ttarget="_blank"\n\t\t\t\t\t\t\t@click="openLink({element: element, event: $event})"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{{element.NAME}}\n\t\t\t\t\t\t</a>\n\t\t\t\t\t\t<span v-else @click.prevent="openLink({element: element, event: $event})">\n\t\t\t\t\t\t\t{{element.NAME}}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t</div>\n\t\t'}};function v(e,t){var n=typeof Symbol!=="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=y(e))||t&&e&&typeof e.length==="number"){if(n)e=n;var i=0;var r=function e(){};return{s:r,n:function t(){if(i>=e.length)return{done:true};return{done:false,value:e[i++]}},e:function e(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s=true,o=false,a;return{s:function t(){n=n.call(e)},n:function e(){var t=n.next();s=t.done;return t},e:function e(t){o=true;a=t},f:function e(){try{if(!s&&n["return"]!=null)n["return"]()}finally{if(o)throw a}}}}function y(e,t){if(!e)return;if(typeof e==="string")return b(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor)n=e.constructor.name;if(n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return b(e,t)}function b(e,t){if(t==null||t>e.length)t=e.length;for(var n=0,i=new Array(t);n<t;n++){i[n]=e[n]}return i}var w=[a,l,c,f,d,h,p,m,g];var S={};w.forEach((function(e){S[e.name]=e.component}));o.WidgetBitrixVue.component("bx-im-view-element-attach",{props:{config:{type:Object,default:{}},baseColor:{type:String,default:"#17a3ea"}},methods:{getComponentForBlock:function e(t){var n=v(w),i;try{for(n.s();!(i=n.n()).done;){var r=i.value;if(typeof t[r.property]!=="undefined"){return r.name}}}catch(e){n.e(e)}finally{n.f()}return""}},computed:{color:function e(){if(typeof this.config.COLOR==="undefined"||!this.config.COLOR){return this.baseColor}if(this.config.COLOR==="transparent"){return""}return this.config.COLOR}},components:S,template:'\n\t\t<div class="bx-im-element-attach">\n\t\t\t<div v-if="color" class="bx-im-element-attach-border" :style="{borderColor: color}"></div>\n\t\t\t<div class="bx-im-element-attach-content">\n\t\t\t\t<template v-for="(block, index) in config.BLOCKS">\n\t\t\t\t\t<component :is="getComponentForBlock(block)" :config="block" :color="color" :key="index" />\n\t\t\t\t</template>\n\t\t\t</div>\n\t\t</div>\n\t'})})(this.window=this.window||{},BX,BX,window,BX.Messenger.Model,BX.Messenger.Lib,BX);(function(exports,ui_designTokens,ui_vue,im_lib_utils,im_lib_logger){"use strict";var _ButtonType=Object.freeze({newline:"NEWLINE",button:"BUTTON"});ui_vue.WidgetBitrixVue.component("bx-im-view-element-keyboard",{props:{buttons:{type:Array,default:function e(){return[]}},messageId:{default:0},userId:{default:0},dialogId:{default:0}},data:function e(){return{isMobile:im_lib_utils.Utils.platform.isMobile(),isBlocked:false,localButtons:[]}},created:function e(){this.localButtons=this.prepareButtons(this.buttons)},watch:{buttons:function e(){clearTimeout(this.recoverStateButton);this.isBlocked=false;this.localButtons=this.prepareButtons(this.buttons)}},methods:{click:function click(button){var _this=this;if(this.isBlocked){return false}if(button.DISABLED&&button.DISABLED==="Y"){return false}if(button.ACTION&&button.ACTION_VALUE.toString()){this.$emit("click",{action:"ACTION",params:{dialogId:this.dialogId,messageId:this.messageId,botId:button.BOT_ID,action:button.ACTION,value:button.ACTION_VALUE}})}else if(button.FUNCTION){var execFunction=button.FUNCTION.toString().replace("#MESSAGE_ID#",this.messageId).replace("#DIALOG_ID#",this.dialogId).replace("#USER_ID#",this.userId);eval(execFunction)}else if(button.APP_ID){im_lib_logger.Logger.warn("Messenger keyboard: open app is not implemented.")}else if(button.LINK){if(im_lib_utils.Utils.platform.isBitrixMobile()){app.openNewPage(button.LINK)}else{window.open(button.LINK,"_blank")}}else if(button.WAIT!=="Y"){if(button.BLOCK==="Y"){this.isBlocked=true}button.WAIT="Y";this.$emit("click",{action:"COMMAND",params:{dialogId:this.dialogId,messageId:this.messageId,botId:button.BOT_ID,command:button.COMMAND,params:button.COMMAND_PARAMS}});this.recoverStateButton=setTimeout((function(){_this.isBlocked=false;button.WAIT="N"}),1e4)}return true},getStyles:function e(t){var n={};if(t.WIDTH){n["width"]=t.WIDTH+"px"}else if(t.DISPLAY==="BLOCK"){n["width"]="225px"}if(t.BG_COLOR){n["backgroundColor"]=t.BG_COLOR}if(t.TEXT_COLOR){n["color"]=t.TEXT_COLOR}return n},prepareButtons:function e(t){return t.filter((function(e){if(!e.CONTEXT){return true}if(im_lib_utils.Utils.platform.isBitrixMobile()&&e.CONTEXT==="DESKTOP"){return false}if(!im_lib_utils.Utils.platform.isBitrixMobile()&&e.CONTEXT==="MOBILE"){return false}if(!im_lib_utils.Utils.platform.isBitrixMobile()&&(e.ACTION==="DIALOG"||e.ACTION==="CALL")){return false}return true}))}},computed:{ButtonType:function e(){return _ButtonType}},template:'\n\t\t<div :class="[\'bx-im-element-keyboard\', {\'bx-im-element-keyboard-mobile\': isMobile}]">\n\t\t\t<template v-for="(button, index) in localButtons">\n\t\t\t\t<div v-if="button.TYPE === ButtonType.newline" class="bx-im-element-keyboard-button-separator"></div>\n\t\t\t\t<span v-else-if="button.TYPE === ButtonType.button" :class="[\n\t\t\t\t\t\'bx-im-element-keyboard-button\', \n\t\t\t\t\t\'bx-im-element-keyboard-button-\'+button.DISPLAY.toLowerCase(), \n\t\t\t\t\t{\n\t\t\t\t\t\t\'bx-im-element-keyboard-button-disabled\': isBlocked || button.DISABLED === \'Y\',\n\t\t\t\t\t\t\'bx-im-element-keyboard-button-progress\': button.WAIT === \'Y\',\n\t\t\t\t\t}\n\t\t\t\t]" @click="click(button)">\n\t\t\t\t\t<span class="bx-im-element-keyboard-button-text" :style="getStyles(button)">{{button.TEXT}}</span>\n\t\t\t\t</span>\n\t\t\t</template>\n\t\t</div>\n\t'})})(this.window=this.window||{},BX,BX,BX.Messenger.Lib,BX.Messenger.Lib);(function(e,t,n,i){"use strict";n.WidgetBitrixVue.component("bx-im-view-element-chat-teaser",{props:{messageCounter:{default:0},messageLastDate:{default:0},languageId:{default:"en"}},computed:{formattedDate:function e(){return i.Utils.date.format(this.messageLastDate,null,this.$Bitrix.Loc.getMessages())},formattedCounter:function e(){return this.messageCounter+" "+i.Utils.text.getLocalizeForNumber("IM_MESSENGER_COMMENT",this.messageCounter,this.languageId,this.$Bitrix.Loc.getMessages())}},template:'\n\t\t<div class="bx-im-element-chat-teaser" @click="$emit(\'click\', $event)">\n\t\t\t<span class="bx-im-element-chat-teaser-join">{{$Bitrix.Loc.getMessage(\'IM_MESSENGER_COMMENT_OPEN\')}}</span>\n\t\t\t<span class="bx-im-element-chat-teaser-comment">\n\t\t\t\t<span class="bx-im-element-chat-teaser-counter">{{formattedCounter}}</span>, {{formattedDate}}\n\t\t\t</span>\n\t\t</div>\n\t'})})(this.window=this.window||{},BX,BX,BX.Messenger.Lib);(function(e,t,n,i){"use strict";var r=Object.freeze({none:"none",like:"like",kiss:"kiss",laugh:"laugh",wonder:"wonder",cry:"cry",angry:"angry"});var s=["like","kiss","laugh","wonder","cry","angry"];n.WidgetBitrixVue.component("bx-reaction",{props:{id:{default:""},values:{default:{}},userId:{default:0},openList:{default:true}},data:function e(){return{localValues:{},userReaction:r.none,buttonAnimate:false}},created:function e(){this.localValues=Object.assign({},this.values);i.EventEmitter.subscribe("ui:reaction:press",this.onPress)},destroy:function e(){i.EventEmitter.unsubscribe("ui:reaction:press",this.onPress)},watch:{values:function e(t){this.localValues=Object.assign({},t)}},methods:{list:function e(){if(this.openList);this.$emit("list",{values:this.localValues})},press:function e(){var t=this;var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:r.like;if(this.userReaction===r.none){if(!this.localValues[n]){this.localValues=Object.assign({},this.localValues,babelHelpers.defineProperty({},n,[]))}this.localValues[n].push(this.userId);this.buttonAnimate=true;setTimeout((function(){return t.buttonAnimate=false}),400);this.$emit("set",{action:"set",type:n})}else{if(this.localValues[this.userReaction]){this.localValues[this.userReaction]=this.localValues[this.userReaction].filter((function(e){return e!==t.userId}))}this.$emit("set",{action:"remove",type:this.userReaction})}},onPress:function e(t){var n=t.getData();if(!this.id||n.id!==this.id){return false}if(!n.emotion){n.emotion=r.like}this.press(n.emotion)}},computed:{types:function e(){var t=this;this.userReaction=r.none;return s.filter((function(e){if(typeof t.localValues[e]==="undefined"||!(t.localValues[e]instanceof Array)||t.localValues[e].length<=0){return false}if(t.userId>0&&t.userReaction===r.none&&t.localValues[e].includes(t.userId)){t.userReaction=e}return true})).map((function(e){return{type:e,count:t.localValues[e].length}}))},counter:function e(){return this.types.map((function(e){return e.count})).reduce((function(e,t){return e+t}),0)},isTypesShowed:function e(){if(this.counter<=0){return false}if(this.userReaction!==r.none&&this.counter===1){return false}return true},isMobile:function e(){var t=navigator.userAgent.toLowerCase();return t.includes("android")||t.includes("iphone")||t.includes("ipad")||t.includes("bitrixmobile")}},template:'\n\t\t<div :class="[\'ui-vue-reaction\', {\'ui-vue-reaction-mobile\': isMobile}]">\n\t\t\t<transition name="ui-vue-reaction-result-animation">\n\t\t\t\t<div v-if="isTypesShowed" class="ui-vue-reaction-result" @click="list">\n\t\t\t\t\t<transition-group tag="div" class="ui-vue-reaction-result-types" name="ui-vue-reaction-result-type-animation" >\n\t\t\t\t\t\t<span v-for="element in types" :class="[\'ui-vue-reaction-result-type\', \'ui-vue-reaction-icon-\'+element.type]" :key="element.type"></span>\n\t\t\t\t\t</transition-group>\t\n\t\t\t\t\t<div class="ui-vue-reaction-result-counter">{{counter}}</div>\n\t\t\t\t</div>\n\t\t\t</transition>\n\t\t\t<div v-if="userId > 0"  class="ui-vue-reaction-button" @click.prevent="press()">\n\t\t\t\t<div class="ui-vue-reaction-button-container">\n\t\t\t\t\t<div :class="[\'ui-vue-reaction-button-icon\', \'ui-vue-reaction-icon-\'+userReaction, {\'ui-vue-reaction-button-pressed\': buttonAnimate}]"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t'})})(this.window=this.window||{},BX,BX,BX.Event);(function(e,t,n,i,r,s,o,a,l,u,c,f,d,h){"use strict";function p(e,t){var n=typeof Symbol!=="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=m(e))||t&&e&&typeof e.length==="number"){if(n)e=n;var i=0;var r=function e(){};return{s:r,n:function t(){if(i>=e.length)return{done:true};return{done:false,value:e[i++]}},e:function e(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s=true,o=false,a;return{s:function t(){n=n.call(e)},n:function e(){var t=n.next();s=t.done;return t},e:function e(t){o=true;a=t},f:function e(){try{if(!s&&n["return"]!=null)n["return"]()}finally{if(o)throw a}}}}function m(e,t){if(!e)return;if(typeof e==="string")return g(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor)n=e.constructor.name;if(n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return g(e,t)}function g(e,t){if(t==null||t>e.length)t=e.length;for(var n=0,i=new Array(t);n<t;n++){i[n]=e[n]}return i}function v(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?v(Object(n),!0).forEach((function(t){babelHelpers.defineProperty(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var b=window.BX;var w=Object.freeze({default:"default",progress:"progress",image:"image",audio:"audio",video:"video",richLink:"richLink"});a.WidgetBitrixVue.component("bx-im-view-message-body",{props:{userId:{default:0},dialogId:{default:"0"},chatId:{default:0},messageType:{default:c.MessageType.self},message:{type:Object,default:u.MessagesModel.create().getElementState},enableReactions:{default:true},showName:{default:true},showAvatar:{default:true},referenceContentBodyClassName:{default:""},referenceContentNameClassName:{default:""}},created:function e(){this.dateFormatFunction=null;this.cacheFormatDate={}},methods:{clickByUserName:function e(t){if(this.showAvatar&&f.Utils.platform.isMobile()){return false}h.EventEmitter.emit(c.EventType.dialog.clickOnUserName,t)},clickByChatTeaser:function e(t){h.EventEmitter.emit(c.EventType.dialog.clickOnChatTeaser,{message:t.message,event:t.event})},clickByKeyboardButton:function e(t){h.EventEmitter.emit(c.EventType.dialog.clickOnKeyboardButton,y({message:t.message},t.event))},setReaction:function e(t){h.EventEmitter.emit(c.EventType.dialog.setMessageReaction,t)},openReactionList:function e(t){h.EventEmitter.emit(c.EventType.dialog.openMessageReactionList,t)},formatDate:function e(t){var n=t.toJSON().slice(0,10);if(this.cacheFormatDate[n]){return this.cacheFormatDate[n]}var i=f.Utils.date.getFormatType(b.Messenger.Const.DateFormat.message,this.$Bitrix.Loc.getMessages());this.cacheFormatDate[n]=this._getDateFormat().format(i,t);return this.cacheFormatDate[n]},_getDateFormat:function e(){var t=this;if(this.dateFormatFunction){return this.dateFormatFunction}this.dateFormatFunction=Object.create(b.Main.Date);this.dateFormatFunction._getMessage=function(e){return t.$Bitrix.Loc.getMessage(e)};return this.dateFormatFunction},isDesktop:function e(){return f.Utils.platform.isBitrixDesktop()},getDesktopVersion:function e(){return f.Utils.platform.getDesktopVersion()},isMobile:function e(){return f.Utils.platform.isBitrixMobile()}},computed:y({MessageType:function e(){return c.MessageType},ContentType:function e(){return w},contentType:function e(){if(this.filesData.length>0){var t=false;var n=false;var i=false;var r=false;var s=p(this.filesData),o;try{for(s.s();!(o=s.n()).done;){var a=o.value;if(a.progress<0){r=true;break}else if(a.type==="audio"){if(n||t){t=false;n=false;break}i=true}else if(a.type==="image"&&a.image){if(n||i){i=false;n=false;break}t=true}else if(a.type==="video"){if(t||i){i=false;t=false;break}n=true}else{i=false;t=false;n=false;break}}}catch(e){s.e(e)}finally{s.f()}if(r){return w.progress}else if(t){return w.image}else if(i){return w.audio}else if(n){return w.video}}return w["default"]},formattedDate:function e(){return this.formatDate(this.message.date)},messageText:function e(){var t=this;if(this.isDeleted){return this.$Bitrix.Loc.getMessage("IM_MESSENGER_MESSAGE_DELETED")}var n=this.message.textConverted;var i=this.message.params;var r=[];n=n.replace(/<!--IM_COMMAND_START-->([\0-\uFFFF]+?)<!--IM_COMMAND_END-->/gi,(function(e,t){var n=r.length;r.push(t);return"####REPLACEMENT_"+n+"####"}));n=n.replace(/\[USER=([0-9]{1,})\](.*?)\[\/USER\]/gi,(function(e,n,i){if(!i){var r=t.$store.getters["users/get"](n);i=r?f.Utils.text.htmlspecialchars(r.name):"User "+n}return'<span class="bx-im-mention" data-type="USER" data-value="'+n+'">'+i+"</span>"}));r.forEach((function(e,t){n=n.replace("####REPLACEMENT_"+t+"####",e)}));if(typeof i.LINK_ACTIVE!=="undefined"&&i.LINK_ACTIVE.length>0&&!i.LINK_ACTIVE.includes(this.userId)){n=n.replace(/<a.*?href="([^"]*)".*?>(.*?)<\/a>/gi,"$2")}return n},messageAttach:function e(){return this.message.params.ATTACH},messageReactions:function e(){return this.message.params.REACTION||{}},isEdited:function e(){return this.message.params.IS_EDITED==="Y"},isDeleted:function e(){return this.message.params.IS_DELETED==="Y"},chatColor:function e(){return this.dialog.type!==c.DialogType["private"]?this.dialog.color:this.user.color},dialog:function e(){var e=this.$store.getters["dialogues/get"](this.dialogId);return e?e:this.$store.getters["dialogues/getBlank"]()},user:function e(){return this.$store.getters["users/get"](this.message.authorId,true)},filesData:function e(){var t=this;var n=[];if(!this.message.params.FILE_ID||this.message.params.FILE_ID.length<=0){return n}this.message.params.FILE_ID.forEach((function(e){if(!e){return false}var i=t.$store.getters["files/get"](t.chatId,e,true);if(!i){t.$store.commit("files/set",{data:[t.$store.getters["files/getBlank"]({id:e,chatId:t.chatId})]});i=t.$store.getters["files/get"](t.chatId,e,true)}if(i){n.push(i)}}));return n},keyboardButtons:function e(){var t=false;if(!this.message.params.KEYBOARD||this.message.params.KEYBOARD==="N"){return t}return this.message.params.KEYBOARD},chatTeaser:function e(){if(typeof this.message.params.CHAT_ID==="undefined"||typeof this.message.params.CHAT_LAST_DATE==="undefined"||typeof this.message.params.CHAT_MESSAGE==="undefined"){return false}return{messageCounter:this.message.params.CHAT_MESSAGE,messageLastDate:this.message.params.CHAT_LAST_DATE,languageId:this.application.common.languageId}},userName:function e(){if(this.message.params.NAME){return d.Text.decode(this.message.params.NAME)}if(!this.showAvatar){return this.user.name}else{return this.user.firstName?this.user.firstName:this.user.name}},userColor:function e(){if(this.user.extranet){return"#CA7B00"}return this.user.color}},l.WidgetVuex.mapState({application:function e(t){return t.application}})),template:'\n\t\t<div class="bx-im-message-content-wrap">\n\t\t\t<template v-if="contentType == ContentType.default || contentType == ContentType.audio || contentType == ContentType.progress || (contentType !== ContentType.image && isDesktop() && getDesktopVersion() < 47)">\n\t\t\t\t<div class="bx-im-message-content">\n\t\t\t\t\t<span class="bx-im-message-content-box">\n\t\t\t\t\t\t<div class="bx-im-message-content-name-wrap">\n\t\t\t\t\t\t\t<template v-if="showName && user.extranet && messageType == MessageType.opponent">\n\t\t\t\t\t\t\t\t<div class="bx-im-message-extranet-icon"></div>\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t<template v-if="showName && messageType == MessageType.opponent">\n\t\t\t\t\t\t\t\t<div :class="[\'bx-im-message-content-name\', referenceContentNameClassName]" :style="{color: userColor}" @click="clickByUserName({user: user, event: $event})">{{userName}}</div>\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div :class="[\'bx-im-message-content-body\', referenceContentBodyClassName]">\n\t\t\t\t\t\t\t<template v-if="(contentType == ContentType.audio) && (!isDesktop() || (isDesktop() && getDesktopVersion() > 43))">\n\t\t\t\t\t\t\t\t<bx-im-view-element-file-audio v-for="file in filesData" :messageType="messageType" :file="file" :key="file.templateId"/>\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t\t\t<bx-im-view-element-file v-for="file in filesData" :messageType="messageType" :file="file" :key="file.templateId"/>\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t<div :class="[\'bx-im-message-content-body-wrap\', {\n\t\t\t\t\t\t\t\t\'bx-im-message-content-body-with-text\': messageText.length > 0,\n\t\t\t\t\t\t\t\t\'bx-im-message-content-body-without-text\': messageText.length <= 0,\n\t\t\t\t\t\t\t}]">\n\t\t\t\t\t\t\t\t<template v-if="messageText">\n\t\t\t\t\t\t\t\t\t<span class="bx-im-message-content-text" v-html="messageText"></span>\n\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t<template v-for="(config, id) in messageAttach">\n\t\t\t\t\t\t\t\t\t<bx-im-view-element-attach :baseColor="chatColor" :config="config" :key="id"/>\n\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t<span class="bx-im-message-content-params">\n\t\t\t\t\t\t\t\t\t<span class="bx-im-message-content-date">{{formattedDate}}</span>\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</span>\n\t\t\t\t\t<div v-if="!message.push && enableReactions && message.authorId" class="bx-im-message-content-reaction">\n\t\t\t\t\t\t<bx-reaction :id="\'message\'+message.id" :values="messageReactions" :userId="userId" :openList="false" @set="setReaction({message: message, reaction: $event})" @list="openReactionList({message: message, values: $event.values})"/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t\t<template v-else-if="contentType == ContentType.richLink">\n\t\t\t\t\x3c!-- richLink type markup --\x3e\n\t\t\t</template>\n\t\t\t<template v-else-if="contentType == ContentType.image || contentType == ContentType.video">\n\t\t\t\t<div class="bx-im-message-content bx-im-message-content-fit">\n\t\t\t\t\t<span class="bx-im-message-content-box">\n\t\t\t\t\t\t<template v-if="showName && messageType == MessageType.opponent">\n\t\t\t\t\t\t\t<div :class="[\'bx-im-message-content-name\', referenceContentNameClassName]" :style="{color: user.color}" @click="clickByUserName({user: user, event: $event})">{{!showAvatar? user.name: (user.firstName? user.firstName: user.name)}}</div>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t\t<div :class="[\'bx-im-message-content-body\', referenceContentBodyClassName]">\n\t\t\t\t\t\t\t<template v-if="contentType == ContentType.image">\n\t\t\t\t\t\t\t\t<bx-im-view-element-file-image v-for="file in filesData" :messageType="messageType" :file="file" :key="file.templateId"/>\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t<template v-else-if="contentType == ContentType.video">\n\t\t\t\t\t\t\t\t<bx-im-view-element-file-video v-for="file in filesData" :messageType="messageType" :file="file" :key="file.templateId"/>\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t<div :class="[\'bx-im-message-content-body-wrap\', {\n\t\t\t\t\t\t\t\t\'bx-im-message-content-body-with-text\': messageText.length > 0,\n\t\t\t\t\t\t\t\t\'bx-im-message-content-body-without-text\': messageText.length <= 0,\n\t\t\t\t\t\t\t}]">\n\t\t\t\t\t\t\t\t<template v-if="messageText">\n\t\t\t\t\t\t\t\t\t<span class="bx-im-message-content-text" v-html="messageText"></span>\n\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t<span class="bx-im-message-content-params">\n\t\t\t\t\t\t\t\t\t<span class="bx-im-message-content-date">{{formattedDate}}</span>\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</span>\n\t\t\t\t\t<div v-if="!message.push && enableReactions && message.authorId" class="bx-im-message-content-reaction">\n\t\t\t\t\t\t<bx-reaction :id="\'message\'+message.id" :values="messageReactions" :userId="userId" :openList="false" @set="setReaction({message: message, reaction: $event})" @list="openReactionList({message: message, values: $event.values})"/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t\t<template v-if="keyboardButtons">\n\t\t\t\t<bx-im-view-element-keyboard :buttons="keyboardButtons" :messageId="message.id" :userId="userId" :dialogId="dialogId" @click="clickByKeyboardButton({message: message, event: $event})"/>\n\t\t\t</template>\n\t\t\t<template v-if="chatTeaser">\n\t\t\t\t<bx-im-view-element-chat-teaser :messageCounter="chatTeaser.messageCounter" :messageLastDate="chatTeaser.messageLastDate" :languageId="chatTeaser.languageId" @click="clickByChatTeaser({message: message, event: $event})"/>\n\t\t\t</template>\n\t\t</div>\n\t'})})(this.window=this.window||{},BX,window,window,window,window,window,BX,BX,BX.Messenger.Model,BX.Messenger.Const,BX.Messenger.Lib,BX,BX.Event);this.BX=this.BX||{};this.BX.Messenger=this.BX.Messenger||{};(function(e){"use strict";var t=function(){function e(){babelHelpers.classCallCheck(this,e)}babelHelpers.createClass(e,null,[{key:"start",value:function e(t){var n=t.start,e=n===void 0?0:n,i=t.end,r=i===void 0?0:i,s=t.increment,o=s===void 0?20:s,a=t.callback,l=a===void 0?function(){}:a,u=t.duration,c=u===void 0?500:u,f=t.element,d=t.elementProperty;var h=r-e;var p=0;var m=function e(t,n,i,r){t/=r/2;if(t<1){return i/2*t*t+n}t--;return-i/2*(t*(t-2)-1)+n};var g=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){return window.setTimeout(e,1e3/60)};var v=null;var y=function t(){p+=o;f[d]=m(p,e,h,c);if(p<c){v=g(t)}else{if(l&&typeof l==="function"){l()}}return v};return y()}},{key:"cancel",value:function e(t){var n=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||function(e){clearTimeout(e)};n(t)}}]);return e}();t.frameIds={};e.Animation=t})(this.BX.Messenger.Lib=this.BX.Messenger.Lib||{});(function(e,t,n,i,r,s,o,a){"use strict";i.WidgetBitrixVue.component("bx-im-view-message",{props:{userId:{default:0},dialogId:{default:0},chatId:{default:0},enableReactions:{default:true},enableDateActions:{default:true},enableCreateContent:{default:true},enableGestureQuote:{default:true},enableGestureQuoteFromRight:{default:true},enableGestureMenu:{default:false},showAvatar:{default:true},showMenu:{default:true},showName:{default:true},showLargeFont:{default:true},capturedMoveEvent:{default:null},referenceContentClassName:{default:""},referenceContentBodyClassName:{default:""},referenceContentNameClassName:{default:""},message:{type:Object,default:n.MessagesModel.create().getElementState}},data:function e(){return{componentBodyId:"bx-im-view-message-body",drag:false,dragWidth:0,dragPosition:0,dragIconShowLeft:false,dragIconShowRight:false}},created:function e(){this.dragStartPositionX=0;this.dragStartPositionY=0;this.dragMovePositionX=0;this.dragMovePositionY=0},beforeDestroy:function e(){clearTimeout(this.dragStartTimeout1);clearTimeout(this.dragStartTimeout2);if(this.dragBackAnimation){o.Animation.cancel(this.dragBackAnimation)}},methods:{clickByAvatar:function e(t){a.EventEmitter.emit(r.EventType.dialog.clickOnUserName,t)},clickByMessageMenu:function e(t){a.EventEmitter.emit(r.EventType.dialog.clickOnMessageMenu,t)},clickByMessageRetry:function e(t){a.EventEmitter.emit(r.EventType.dialog.clickOnMessageRetry,t)},doubleClickByMessage:function e(t){a.EventEmitter.emit(r.EventType.dialog.doubleClickOnMessage,t)},gestureRouter:function e(t,n){this.gestureQuote(t,n);this.gestureMenu(t,n)},gestureMenu:function e(t,n){var i=this;if(!this.enableGestureMenu){return}if(t==="touchstart"){this.gestureMenuStarted=true;this.gestureMenuPreventTouchEnd=false;if(n.target.tagName==="A"){return false}this.gestureMenuStartPosition={x:n.changedTouches[0].clientX,y:n.changedTouches[0].clientY};this.gestureMenuTimeout=setTimeout((function(){i.gestureMenuPreventTouchEnd=true;i.clickByMessageMenu({message:i.message,event:n})}),500)}else if(t==="touchmove"){if(!this.gestureMenuStarted){return false}if(Math.abs(this.gestureMenuStartPosition.x-n.changedTouches[0].clientX)>=10||Math.abs(this.gestureMenuStartPosition.y-n.changedTouches[0].clientY)>=10){this.gestureMenuStarted=false;clearTimeout(this.gestureMenuTimeout)}}else if(t==="touchend"){if(!this.gestureMenuStarted){return false}this.gestureMenuStarted=false;clearTimeout(this.gestureMenuTimeout);if(this.gestureMenuPreventTouchEnd){n.preventDefault()}}},gestureQuote:function e(t,n){var i=this;var l=s.Utils.browser.findParent(n.target,"bx-im-message")||n.target;if(!this.enableGestureQuote||s.Utils.platform.isAndroid()){return}var u=this.enableGestureQuoteFromRight;var c=l.getBoundingClientRect().left+n.layerX;var f=l.getBoundingClientRect().top+n.layerY;if(t==="touchstart"){this.dragCheck=true;this.dragStartInitialX=l.getBoundingClientRect().left;this.dragStartInitialY=l.getBoundingClientRect().top;this.dragStartPositionX=c;this.dragStartPositionY=f;this.dragMovePositionX=null;this.dragMovePositionY=null;clearTimeout(this.dragStartTimeout1);clearTimeout(this.dragStartTimeout2);this.dragStartTimeout1=setTimeout((function(){if(i.dragMovePositionX!==null){if(Math.abs(i.dragStartPositionY-i.dragMovePositionY)>=10){i.dragCheck=false}}}),29);this.dragStartTimeout2=setTimeout((function(){i.dragCheck=false;if(Math.abs(i.dragStartPositionY-i.dragMovePositionY)>=10){return}if(i.dragMovePositionX===null){return}else if(u&&i.dragStartPositionX-i.dragMovePositionX<9){return}else if(!u&&i.dragStartPositionX-i.dragMovePositionX>9){return}o.Animation.cancel(i.dragBackAnimation);i.drag=true;i.$emit("dragMessage",{result:i.drag,event:n});i.dragWidth=i.$refs.body.offsetWidth}),80)}else if(t==="touchmove"){if(this.drag||!this.dragCheck){return false}this.dragMovePositionX=c;this.dragMovePositionY=f}else if(t==="touchend"){clearTimeout(this.dragStartTimeout1);clearTimeout(this.dragStartTimeout2);this.dragCheck=false;if(!this.drag){this.dragIconShowLeft=false;this.dragIconShowRight=false;return}o.Animation.cancel(this.dragBackAnimation);this.drag=false;this.$emit("dragMessage",{result:this.drag,event:n});if(this.enableGestureQuoteFromRight&&this.dragIconShowRight&&this.dragPosition!==0||!this.enableGestureQuoteFromRight&&this.dragIconShowLeft&&this.dragPosition!==this.dragStartInitialX){if(s.Utils.platform.isBitrixMobile()){setTimeout((function(){return app.exec("callVibration")}),200)}a.EventEmitter.emit(r.EventType.dialog.quoteMessage,{message:this.message})}this.dragIconShowLeft=false;this.dragIconShowRight=false;this.dragBackAnimation=o.Animation.start({start:this.dragPosition,end:this.dragStartInitialX,increment:20,duration:300,element:this,elementProperty:"dragPosition",callback:function e(){i.dragLayerPosition=undefined;i.dragWidth=0;i.dragPosition=0}})}}},watch:{capturedMoveEvent:function e(t){if(!this.drag||!t){return}var n=s.Utils.browser.findParent(t.target,"bx-im-message")||t.target;var i=n.getBoundingClientRect().left+t.layerX;if(typeof this.dragLayerPosition==="undefined"){this.dragLayerPosition=i}var r=this.dragLayerPosition-i;this.dragLayerPosition=i;this.dragPosition=this.dragPosition-r;if(this.enableGestureQuoteFromRight){var o=(this.showAvatar?30:0)+45;var a=this.showAvatar?30:30;if(this.dragPosition<-o){this.dragPosition=-o}else if(this.dragPosition<-a){if(!this.dragIconShowRight){this.dragIconShowRight=true}}else if(this.dragPosition>=0){this.dragPosition=0}}else{var l=60;var u=40;if(this.dragPosition<=this.dragStartInitialX){this.dragPosition=this.dragStartInitialX}else if(this.dragPosition>=l){this.dragPosition=l}else if(this.dragPosition>=u){if(!this.dragIconShowLeft){this.dragIconShowLeft=true}}}}},computed:{MessageType:function e(){return r.MessageType},dialog:function e(){var e=this.$store.getters["dialogues/get"](this.dialogId);return e?e:this.$store.getters["dialogues/getBlank"]()},type:function e(){if(this.message.system||this.message.authorId==0){return r.MessageType.system}else if(this.message.authorId===-1||this.message.authorId==this.userId){return r.MessageType.self}else{return r.MessageType.opponent}},userData:function e(){return this.$store.getters["users/get"](this.message.authorId,true)},userAvatar:function e(){if(this.message.params.AVATAR){return"url('".concat(this.message.params.AVATAR,"')")}if(this.userData.avatar){return"url('".concat(this.userData.avatar,"')")}return""},filesData:function e(){var t=this.$store.getters["files/getList"](this.chatId);return t?t:{}},isEdited:function e(){return this.message.params.IS_EDITED==="Y"},isDeleted:function e(){return this.message.params.IS_DELETED==="Y"},isLargeFont:function e(){return this.showLargeFont&&this.message.params.LARGE_FONT==="Y"}},template:'\n\t\t<div :class="[\'bx-im-message\', {\n\t\t\t\t\'bx-im-message-without-menu\': !showMenu,\n\t\t\t\t\'bx-im-message-without-avatar\': !showAvatar,\n\t\t\t\t\'bx-im-message-type-system\': type === MessageType.system,\n\t\t\t\t\'bx-im-message-type-self\': type === MessageType.self,\n\t\t\t\t\'bx-im-message-type-other\': type !== MessageType.self,\n\t\t\t\t\'bx-im-message-type-opponent\': type === MessageType.opponent,\n\t\t\t\t\'bx-im-message-status-error\': message.error,\n\t\t\t\t\'bx-im-message-status-unread\': message.unread,\n\t\t\t\t\'bx-im-message-status-blink\': message.blink,\n\t\t\t\t\'bx-im-message-status-edited\': isEdited,\n\t\t\t\t\'bx-im-message-status-deleted\': isDeleted,\n\t\t\t\t\'bx-im-message-large-font\': isLargeFont,\n\t\t\t}]" \n\t\t\t@touchstart="gestureRouter(\'touchstart\', $event)"\n\t\t\t@touchmove="gestureRouter(\'touchmove\', $event)"\n\t\t\t@touchend="gestureRouter(\'touchend\', $event)"\n\t\t\t@dblclick="doubleClickByMessage({message: message, event: $event})"\n\t\t\tref="body"\n\t\t\t:style="{\n\t\t\t\twidth: dragWidth > 0? dragWidth+\'px\': \'\', \n\t\t\t\tmarginLeft: (enableGestureQuoteFromRight && dragPosition < 0) || (!enableGestureQuoteFromRight && dragPosition > 0)? dragPosition+\'px\': \'\',\n\t\t\t}"\n\t\t>\n\t\t\t<template v-if="type === MessageType.self">\n\t\t\t\t<template v-if="dragIconShowRight">\n\t\t\t\t\t<div class="bx-im-message-reply bx-im-message-reply-right">\n\t\t\t\t\t\t<div class="bx-im-message-reply-icon"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</template> \n\t\t\t\t<div class="bx-im-message-box">\n\t\t\t\t\t<component :is="componentBodyId"\n\t\t\t\t\t\t:userId="userId" \n\t\t\t\t\t\t:message="message"\n\t\t\t\t\t\t:dialogId="dialogId"\n\t\t\t\t\t\t:chatId="chatId"\n\t\t\t\t\t\t:messageType="type"\n\t\t\t\t\t\t:showAvatar="showAvatar"\n\t\t\t\t\t\t:showName="showName"\n\t\t\t\t\t\t:enableReactions="enableReactions"\n\t\t\t\t\t\t:referenceContentBodyClassName="referenceContentBodyClassName"\n\t\t\t\t\t\t:referenceContentNameClassName="referenceContentNameClassName"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<div class="bx-im-message-box-status">\n\t\t\t\t\t<template v-if="message.sending">\n\t\t\t\t\t\t<div class="bx-im-message-sending"></div>\n\t\t\t\t\t</template>\n\t\t\t\t\t<transition name="bx-im-message-status-retry">\n\t\t\t\t\t\t<template v-if="!message.sending && message.error && message.retry">\n\t\t\t\t\t\t\t<div class="bx-im-message-status-retry" :title="$Bitrix.Loc.getMessage(\'IM_MESSENGER_MESSAGE_RETRY_TITLE\')" @click="clickByMessageRetry({message: message, event: $event})">\n\t\t\t\t\t\t\t\t<span class="bx-im-message-retry-icon"></span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</transition>\n\t\t\t\t\t<template v-if="showMenu && !message.sending && !message.error">\n\t\t\t\t\t\t<div class="bx-im-message-status-menu" :title="$Bitrix.Loc.getMessage(\'IM_MESSENGER_MESSAGE_MENU_TITLE\')" @click="clickByMessageMenu({message: message, event: $event})">\n\t\t\t\t\t\t\t<span class="bx-im-message-menu-icon"></span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</template> \n\t\t\t\t</div>\n\t\t\t\t<template v-if="dragIconShowLeft">\n\t\t\t\t\t<div class="bx-im-message-reply bx-im-message-reply-left">\n\t\t\t\t\t\t<div class="bx-im-message-reply-icon"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</template> \n\t\t\t</template>\n\t\t\t<template v-else-if="type !== MessageType.self">\n\t\t\t\t<template v-if="dragIconShowLeft">\n\t\t\t\t\t<div class="bx-im-message-reply bx-im-message-reply-left">\n\t\t\t\t\t\t<div class="bx-im-message-reply-icon"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</template> \n\t\t\t\t<template v-if="type === MessageType.opponent">\n\t\t\t\t\t<div v-if="showAvatar" class="bx-im-message-avatar" @click="clickByAvatar({user: userData, event: $event})">\n\t\t\t\t\t\t<div :class="[\'bx-im-message-avatar-image\', {\n\t\t\t\t\t\t\t\t\'bx-im-message-avatar-image-default\': !userData.avatar\n\t\t\t\t\t\t\t}]"\n\t\t\t\t\t\t\t:style="{\n\t\t\t\t\t\t\t\tbackgroundColor: !userData.avatar? userData.color: \'\', \n\t\t\t\t\t\t\t\tbackgroundImage: userAvatar\n\t\t\t\t\t\t\t}" \n\t\t\t\t\t\t\t:title="userData.name"\n\t\t\t\t\t\t></div>\t\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t\t<div class="bx-im-message-box">\n\t\t\t\t\t<component :is="componentBodyId"\n\t\t\t\t\t\t:message="message"\n\t\t\t\t\t\t:userId="userId" \n\t\t\t\t\t\t:dialogId="dialogId"\n\t\t\t\t\t\t:chatId="chatId"\n\t\t\t\t\t\t:messageType="type"\n\t\t\t\t\t\t:files="filesData"\n\t\t\t\t\t\t:showAvatar="showAvatar"\n\t\t\t\t\t\t:showName="showName"\n\t\t\t\t\t\t:enableReactions="enableReactions"\n\t\t\t\t\t\t:referenceContentBodyClassName="referenceContentBodyClassName"\n\t\t\t\t\t\t:referenceContentNameClassName="referenceContentNameClassName"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<div v-if="showMenu"  class="bx-im-message-menu" :title="$Bitrix.Loc.getMessage(\'IM_MESSENGER_MESSAGE_MENU_TITLE\')" @click="clickByMessageMenu({message: message, event: $event})">\n\t\t\t\t\t<span class="bx-im-message-menu-icon"></span>\n\t\t\t\t</div>\t\n\t\t\t\t<template v-if="dragIconShowRight">\n\t\t\t\t\t<div class="bx-im-message-reply bx-im-message-reply-right">\n\t\t\t\t\t\t<div class="bx-im-message-reply-icon"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</template> \n\t\t\t</template>\n\t\t</div>\n\t'})})(this.window=this.window||{},window,BX.Messenger.Model,BX,BX.Messenger.Const,BX.Messenger.Lib,BX.Messenger.Lib,BX.Event);this.BX=this.BX||{};(function(e,t,n,i,r,s,o,a,l,u,c,f,d){"use strict";var h=Object.freeze({read:"read",none:"none"});var p=Object.freeze({history:"history",unread:"unread"});var m=Object.freeze({groupTitle:"groupTitle",readedTitle:"readedTitle"});var g={props:["element"],created:function e(){var t=["self","opponent"];var n=Math.floor(Math.random()*t.length);this.mode=t[n]},computed:{itemClasses:function e(){var e=["im-skeleton-item","im-skeleton-item--sm","".concat(u.DialogReferenceClassName.listItem,"-").concat(this.element.id)];if(this.mode==="self"){e.push("im-skeleton-item-self")}else{e.push("im-skeleton-item-opponent")}return e}},template:'\n\t\t<div :class="itemClasses" :key="element.templateId">\n\t\t\t<div v-if="mode === \'opponent\'" class="im-skeleton-logo"></div>\n\t\t\t<div class="im-skeleton-content">\n\t\t\t\t<div class="im-skeleton-line-row">\n\t\t\t\t\t<div style="max-width: 70%" class="im-skeleton-line"></div>\n\t\t\t\t</div>\n\t\t\t\t<div class="im-skeleton-line-row">\n\t\t\t\t\t<div style="max-width: 100%" class="im-skeleton-line"></div>\n\t\t\t\t\t<div style="max-width: 26px; margin-left: auto;" class="im-skeleton-line"></div>\n\t\t\t\t</div>\n\t\t\t\t<div class="im-skeleton-like"></div>\n\t\t\t</div>\n\t\t</div>\n\t'};var v={props:["element"],created:function e(){var t=["self","opponent"];var n=Math.floor(Math.random()*t.length);this.mode=t[n]},computed:{itemClasses:function e(){var e=["im-skeleton-item","im-skeleton-item--md","".concat(u.DialogReferenceClassName.listItem,"-").concat(this.element.id)];if(this.mode==="self"){e.push("im-skeleton-item-self")}else{e.push("im-skeleton-item-opponent")}return e}},template:'\n\t\t<div :class="itemClasses" :key="element.templateId">\n\t\t\t<div v-if="mode === \'opponent\'" class="im-skeleton-logo"></div>\n\t\t\t<div class="im-skeleton-content">\n\t\t\t\t<div class="im-skeleton-line-row">\n\t\t\t\t\t<div style="max-width: 35%" class="im-skeleton-line"></div>\n\t\t\t\t</div>\n\t\t\t\t<div class="im-skeleton-line-row">\n\t\t\t\t\t<div style="max-width: 100%" class="im-skeleton-line"></div>\n\t\t\t\t</div>\n\t\t\t\t<div class="im-skeleton-line-row">\n\t\t\t\t\t<div style="max-width: 55%" class="im-skeleton-line"></div>\n\t\t\t\t\t<div style="max-width: 26px; margin-left: auto;" class="im-skeleton-line"></div>\n\t\t\t\t</div>\n\t\t\t\t<div class="im-skeleton-like"></div>\n\t\t\t</div>\n\t\t</div>\n\t'};var y={props:["element"],created:function e(){var t=["self","opponent"];var n=Math.floor(Math.random()*t.length);this.mode=t[n]},computed:{itemClasses:function e(){var e=["im-skeleton-item","im-skeleton-item--md","".concat(u.DialogReferenceClassName.listItem,"-").concat(this.element.id)];if(this.mode==="self"){e.push("im-skeleton-item-self")}else{e.push("im-skeleton-item-opponent")}return e}},template:'\n\t\t<div :class="itemClasses" :key="element.templateId">\n\t\t\t<div v-if="mode === \'opponent\'" class="im-skeleton-logo"></div>\n\t\t\t<div class="im-skeleton-content">\n\t\t\t\t<div class="im-skeleton-line-row">\n\t\t\t\t\t<div style="max-width: 35%" class="im-skeleton-line"></div>\n\t\t\t\t</div>\n\t\t\t\t<div class="im-skeleton-line-row">\n\t\t\t\t\t<div style="max-width: 100%" class="im-skeleton-line"></div>\n\t\t\t\t</div>\n\t\t\t\t<div class="im-skeleton-line-row">\n\t\t\t\t\t<div style="max-width: 55%" class="im-skeleton-line"></div>\n\t\t\t\t</div>\n\t\t\t\t<div class="im-skeleton-line-row">\n\t\t\t\t\t<div style="max-width: 26px; margin-left: auto;" class="im-skeleton-line"></div>\n\t\t\t\t</div>\n\t\t\t\t<div class="im-skeleton-like"></div>\n\t\t\t</div>\n\t\t</div>\n\t'};function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(Object(n),!0).forEach((function(t){babelHelpers.defineProperty(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var S={props:{userId:{type:Number,default:0},dialogId:{type:String,default:"0"},messageLimit:{type:Number,default:50},enableReadMessages:{type:Boolean,default:true},enableReactions:{type:Boolean,default:true},enableDateActions:{type:Boolean,default:true},enableCreateContent:{type:Boolean,default:true},enableGestureQuote:{type:Boolean,default:true},enableGestureQuoteFromRight:{type:Boolean,default:true},enableGestureMenu:{type:Boolean,default:false},showMessageUserName:{type:Boolean,default:true},showMessageAvatar:{type:Boolean,default:true},showMessageMenu:{type:Boolean,default:true}},components:{Placeholder1:g,Placeholder2:v,Placeholder3:y},data:function e(){return{messagesSet:false,scrollAnimating:false,showScrollButton:false,captureMove:false,capturedMoveEvent:null,lastMessageId:null,isRequestingHistory:false,historyPagesRequested:0,stopHistoryLoading:false,isRequestingUnread:false,unreadPagesRequested:0,placeholderCount:0,pagesLoaded:0}},created:function e(){o.Logger.warn("MessageList component is created");this.initParams();this.initEvents()},beforeDestroy:function e(){this.observers={};clearTimeout(this.scrollButtonShowTimeout);this.clearEvents()},mounted:function e(){this.windowFocused=r.Utils.platform.isBitrixMobile()?true:document.hasFocus();this.getMessageIdsForPagination();this.scrollOnStart()},watch:{dialogId:function e(t,n){var i=this;o.Logger.warn("new dialogId in message-list",t);this.messagesSet=false;this.$nextTick((function(){i.scrollOnStart()}))}},computed:w({TemplateType:function e(){return u.DialogTemplateType},ObserverType:function e(){return h},DialogReferenceClassName:function e(){return u.DialogReferenceClassName},localize:function e(){return l.WidgetBitrixVue.getFilteredPhrases("IM_MESSENGER_DIALOG_",this)},dialog:function e(){var e=this.$store.getters["dialogues/get"](this.dialogId);return e?e:this.$store.getters["dialogues/getBlank"]()},chatId:function e(){if(this.application){return this.application.dialog.chatId}},collection:function e(){return this.$store.getters["messages/get"](this.chatId)},formattedCollection:function e(){var t=this;this.lastMessageId=0;this.lastMessageAuthorId=0;this.firstUnreadMessageId=0;var n=0;var i={};var r=[];this.collection.forEach((function(e){if(t.messagesSet&&(t.lastHistoryMessageId===null||t.lastHistoryMessageId>e.id)){o.Logger.warn("setting new lastHistoryMessageId",e.id);t.lastHistoryMessageId=e.id}t.lastMessageId=e.id;var s=t.getDateGroup(e.date);if(!i[s.title]){i[s.title]=s.id;r.push(t.getDateGroupBlock(s.id,s.title))}else if(n!==e.authorId){r.push(t.getDelimiterBlock(e.id))}if(e.unread&&!t.firstUnreadMessageId){t.firstUnreadMessageId=e.id}r.push(e);n=e.authorId}));this.lastMessageAuthorId=n;return r},writingStatusText:function e(){var t=this;clearTimeout(this.scrollToTimeout);if(this.dialog.writingList.length===0){return""}if(!this.scrollChangedByUser&&!this.showScrollButton){this.scrollToTimeout=setTimeout((function(){return t.animatedScrollToPosition({duration:500})}),300)}var n=this.dialog.writingList.map((function(e){return e.userName})).join(", ");return this.localize["IM_MESSENGER_DIALOG_WRITES_MESSAGE"].replace("#USER#",n)},statusReaded:function e(){var t=this;clearTimeout(this.scrollToTimeout);if(this.dialog.readedList.length===0){return""}var n="";if(this.dialog.type===u.DialogType["private"]){var i=this.dialog.readedList[0];if(i.messageId===this.lastMessageId&&i.userId!==this.lastMessageAuthorId){var r=this.getDateFormat(m.readedTitle);var s=this.getDateObject().format(r,i.date);n=this.localize["IM_MESSENGER_DIALOG_MESSAGES_READED_USER"].replace("#DATE#",s)}}else{var o=this.dialog.readedList.filter((function(e){return e.messageId===t.lastMessageId&&e.userId!==t.lastMessageAuthorId}));if(o.length===1){n=this.localize["IM_MESSENGER_DIALOG_MESSAGES_READED_CHAT"].replace("#USERS#",o[0].userName)}else if(o.length>1){n=this.localize["IM_MESSENGER_DIALOG_MESSAGES_READED_CHAT"].replace("#USERS#",this.localize["IM_MESSENGER_DIALOG_MESSAGES_READED_CHAT_PLURAL"].replace("#USER#",o[0].userName).replace("#COUNT#",o.length-1).replace("[LINK]","").replace("[/LINK]",""))}}if(!n){return""}if(!this.scrollChangedByUser&&!this.showScrollButton){this.scrollToTimeout=setTimeout((function(){return t.animatedScrollToPosition({duration:500})}),300)}return n},unreadCounter:function e(){return this.dialog.counter>99?999:this.dialog.counter},formattedUnreadCounter:function e(){return this.unreadCounter>99?"99+":this.unreadCounter},scrollBlocked:function e(){if(this.application.device.type!==u.DeviceType.mobile){return false}return this.scrollAnimating||this.captureMove},isDarkBackground:function e(){return this.application.options.darkBackground},isMobile:function e(){return this.application.device.type===u.DeviceType.mobile},isRequestingData:function e(){return this.isRequestingHistory||this.isRequestingUnread},remainingHistoryPages:function e(){return Math.ceil((this.dialog.messageCount-this.collection.length)/this.historyMessageLimit)},remainingUnreadPages:function e(){if(this.isLastIdInCollection){return 0}return Math.ceil((this.dialog.messageCount-this.collection.length)/this.unreadMessageLimit)},unreadInCollection:function e(){return this.collection.filter((function(e){return e.unread===true}))},isLastIdInCollection:function e(){return this.collection.map((function(e){return e.id})).includes(this.dialog.lastMessageId)},showStatusPlaceholder:function e(){return!this.writingStatusText&&!this.statusReaded},bodyClasses:function e(){return[u.DialogReferenceClassName.listBody,{"bx-im-dialog-list-scroll-blocked":this.scrollBlocked,"bx-im-dialog-dark-background":this.isDarkBackground,"bx-im-dialog-mobile":this.isMobile}]}},d.WidgetVuex.mapState({application:function e(t){return t.application}})),methods:{initParams:function e(){this.placeholdersComposition=this.getPlaceholdersComposition();this.historyMessageLimit=50;this.unreadMessageLimit=50;this.showScrollButton=this.unreadCounter>0;this.scrollingDownThreshold=1e3;this.scrollingUpThreshold=1e3;this.messageScrollOffset=20;this.lastScroll=0;this.scrollChangedByUser=false;this.scrollButtonDiff=100;this.scrollButtonShowTimeout=null;this.scrollPositionChangeTime=(new Date).getTime();this.lastRequestTime=(new Date).getTime();this.observers={};this.lastAuthorId=0;this.lastHistoryMessageId=null;this.firstUnreadMessageId=null;this.lastUnreadMessageId=null;this.dateFormatFunction=null;this.cachedDateGroups={};this.readMessageQueue=[];this.readMessageTarget={};this.readVisibleMessagesDelayed=r.Utils.debounce(this.readVisibleMessages,50,this);this.requestHistoryDelayed=r.Utils.debounce(this.requestHistory,50,this)},initEvents:function e(){f.EventEmitter.subscribe(u.EventType.dialog.scrollOnStart,this.onScrollOnStart);f.EventEmitter.subscribe(u.EventType.dialog.scrollToBottom,this.onScrollToBottom);f.EventEmitter.subscribe(u.EventType.dialog.readVisibleMessages,this.onReadVisibleMessages);f.EventEmitter.subscribe(u.EventType.dialog.newMessage,this.onNewMessage);f.EventEmitter.subscribe(u.EventType.dialog.requestUnread,this.onExternalUnreadRequest);f.EventEmitter.subscribe(u.EventType.dialog.messagesSet,this.onMessagesSet);f.EventEmitter.subscribe(u.EventType.dialog.beforeMobileKeyboard,this.onBeforeMobileKeyboard);window.addEventListener("orientationchange",this.onOrientationChange);window.addEventListener("focus",this.onWindowFocus);window.addEventListener("blur",this.onWindowBlur);l.WidgetBitrixVue.event.$on("bitrixmobile:controller:focus",this.onWindowFocus);l.WidgetBitrixVue.event.$on("bitrixmobile:controller:blur",this.onWindowBlur)},clearEvents:function e(){f.EventEmitter.unsubscribe(u.EventType.dialog.scrollOnStart,this.onScrollOnStart);f.EventEmitter.unsubscribe(u.EventType.dialog.scrollToBottom,this.onScrollToBottom);f.EventEmitter.unsubscribe(u.EventType.dialog.readVisibleMessages,this.onReadVisibleMessages);f.EventEmitter.unsubscribe(u.EventType.dialog.newMessage,this.onNewMessage);f.EventEmitter.unsubscribe(u.EventType.dialog.requestUnread,this.onExternalUnreadRequest);f.EventEmitter.unsubscribe(u.EventType.dialog.messagesSet,this.onMessagesSet);f.EventEmitter.unsubscribe(u.EventType.dialog.beforeMobileKeyboard,this.onBeforeMobileKeyboard);window.removeEventListener("orientationchange",this.onOrientationChange);window.removeEventListener("focus",this.onWindowFocus);window.removeEventListener("blur",this.onWindowBlur);l.WidgetBitrixVue.event.$off("bitrixmobile:controller:focus",this.onWindowFocus);l.WidgetBitrixVue.event.$off("bitrixmobile:controller:blur",this.onWindowBlur)},onDialogClick:function e(t){if(l.WidgetBitrixVue.testNode(t.target,{className:"bx-im-message-command"})){this.onCommandClick(t)}else if(l.WidgetBitrixVue.testNode(t.target,{className:"bx-im-mention"})){this.onMentionClick(t)}this.windowFocused=true;f.EventEmitter.emit(u.EventType.dialog.clickOnDialog,{event:t})},onDialogMove:function e(t){if(!this.captureMove){return}this.capturedMoveEvent=t},onCommandClick:function e(t){var n="";if(t.target.dataset.entity==="send"||t.target.dataset.entity==="put"){n=t.target.nextSibling.innerHTML}else if(t.target.dataset.entity==="call"){n=t.target.dataset.command}f.EventEmitter.emit(u.EventType.dialog.clickOnCommand,{type:t.target.dataset.entity,value:n,event:t})},onMentionClick:function e(t){f.EventEmitter.emit(u.EventType.dialog.clickOnMention,{type:t.target.dataset.type,value:t.target.dataset.value,event:t})},onOrientationChange:function e(){var t=this;clearTimeout(this.scrollToTimeout);if(this.application.device.type!==u.DeviceType.mobile){return false}o.Logger.log("Orientation changed");if(!this.scrollChangedByUser){this.scrollToTimeout=setTimeout((function(){return t.scrollToBottom({force:true})}),300)}},onWindowFocus:function e(){this.windowFocused=true;this.readVisibleMessages();return true},onWindowBlur:function e(){this.windowFocused=false},onScrollToBottom:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},n=t.data,i=n===void 0?{chatId:0,force:false,cancelIfScrollChange:false,duration:null}:n;if(i.chatId!==this.chatId){return false}o.Logger.warn("onScrollToBottom",i);i.force=i.force===true;i.cancelIfScrollChange=i.cancelIfScrollChange===true;if(this.firstUnreadMessageId){o.Logger.warn("Dialog.onScrollToBottom: canceled - unread messages");return false}if(i.cancelIfScrollChange&&this.scrollChangedByUser&&this.scrollBeforeMobileKeyboard){var r=this.$refs.body;this.scrollAfterMobileKeyboard=r.scrollHeight-r.scrollTop-r.clientHeight;var s=this.scrollAfterMobileKeyboard-this.scrollBeforeMobileKeyboard;this.animatedScrollToPosition({start:r.scrollTop,end:r.scrollTop+s});return true}this.scrollToBottom(i);return true},onReadVisibleMessages:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},n=t.data,i=n===void 0?{chatId:0}:n;if(i.chatId!==this.chatId){return false}o.Logger.warn("onReadVisibleMessages");this.readVisibleMessagesDelayed();return true},onClickOnReadList:function e(t){var n=this;var i=this.dialog.readedList.filter((function(e){return e.messageId===n.lastMessageId&&e.userId!==n.lastMessageAuthorId}));f.EventEmitter.emit(u.EventType.dialog.clickOnReadList,{list:i,event:t})},onDragMessage:function e(t){if(!this.windowFocused){return false}this.captureMove=t.result;if(!t.result){this.capturedMoveEvent=null}},onScroll:function e(t){if(this.isScrolling){return false}clearTimeout(this.scrollToTimeout);this.currentScroll=t.target.scrollTop;var n=this.lastScroll<this.currentScroll;var i=!n;if(i&&this.scrollButtonClicked){o.Logger.warn("scrollUp - reset scroll button clicks");this.scrollButtonClicked=false}var r=t.target.scrollHeight-t.target.scrollTop-t.target.clientHeight;if(this.currentScroll>0&&n&&r<this.scrollingDownThreshold){this.onScrollDown()}else if(i&&this.currentScroll<=this.scrollingUpThreshold){this.onScrollUp()}this.lastScroll=this.currentScroll;this.scrollPositionChangeTime=(new Date).getTime();this.manageScrollButton(t)},onScrollDown:function e(){var t=this;if(!this.messagesSet||this.isLastIdInCollection){return false}if(this.isRequestingData&&this.remainingUnreadPages>0){this.drawPlaceholders(p.unread).then((function(){t.unreadPagesRequested+=1;o.Logger.warn("Already loading! Draw placeholders and add request, total - ",t.unreadPagesRequested)}))}else if(!this.isRequestingData&&this.remainingUnreadPages>0){o.Logger.warn("Starting new unread request");this.isRequestingUnread=true;this.drawPlaceholders(p.unread).then((function(){t.requestUnread()}))}},onScrollUp:function e(){var t=this;if(!this.messagesSet||this.stopHistoryLoading){return false}this.projectedPagesToLoad=1;if(!this.isMobile&&this.$refs.body.scrollTop<this.$refs.body.scrollHeight/4){this.projectedPagesToLoad=3}if(this.isRequestingData&&this.remainingHistoryPages>0){var n=this.$refs.body.scrollHeight;this.drawPlaceholders(p.history,this.projectedPagesToLoad).then((function(){if(!t.isOverflowAnchorSupported()){t.enableUserScroll()}t.historyPagesRequested+=t.projectedPagesToLoad;o.Logger.warn("Already loading! Draw placeholders and add request, total - ",t.historyPagesRequested)}));if(!this.isOverflowAnchorSupported()){o.Logger.warn("Disabling user scroll");this.$nextTick((function(){var e=t.$refs.body.scrollHeight-n;t.disableUserScroll();t.forceScrollToPosition(t.$refs.body.scrollTop+e)}))}}else if(!this.isRequestingData&&this.remainingHistoryPages>0){o.Logger.warn("Starting new history request");this.isRequestingHistory=true;var i=this.$refs.body.scrollHeight;this.drawPlaceholders(p.history,this.projectedPagesToLoad).then((function(){t.historyPagesRequested=t.projectedPagesToLoad-1;if(!t.isOverflowAnchorSupported()){t.enableUserScroll()}t.requestHistory()}));if(!this.isOverflowAnchorSupported()){o.Logger.warn("Disabling user scroll");this.$nextTick((function(){var e=t.$refs.body.scrollHeight-i;t.disableUserScroll();t.forceScrollToPosition(t.$refs.body.scrollTop+e)}))}}},isOverflowAnchorSupported:function e(){return!r.Utils.platform.isBitrixMobile()&&!r.Utils.browser.isIe()&&!r.Utils.browser.isSafari()&&!r.Utils.browser.isSafariBased()},disableUserScroll:function e(){this.$refs.body.classList.add("bx-im-dialog-list-scroll-blocked")},enableUserScroll:function e(){this.$refs.body.classList.remove("bx-im-dialog-list-scroll-blocked")},onScrollButtonClick:function e(){o.Logger.warn("Scroll button click",this.scrollButtonClicked);if(this.isRequestingData){return false}if(this.unreadCounter===0){this.scrollToBottom();return true}if(this.scrollButtonClicked&&this.remainingUnreadPages>0){o.Logger.warn("Second click on scroll button");this.scrollToLastPage();return true}this.scrollButtonClicked=true;this.scrollToBottom()},onNewMessage:function e(t){var n=this;var i=t.data,r=i.chatId,s=i.messageId;if(r!==this.chatId){return false}o.Logger.warn("Received new message from pull",s);if(this.showScrollButton){return false}this.$nextTick((function(){if(!n.windowFocused){var e=n.$refs["body"].scrollHeight-n.$refs["body"].clientHeight;if(n.currentScroll<e){n.showScrollButton=true}n.scrollToFirstUnreadMessage();return true}var t=n.getElementById(s);if(!t){return false}var i=n.$refs.body;if(t.clientHeight>i.clientHeight){n.scrollToMessage({messageId:s});return true}n.animatedScrollToPosition()}))},onMessagesSet:function e(t){var n=t.data;if(n.chatId!==this.chatId){return false}if(this.messagesSet===true){o.Logger.warn("messages are already set");return false}o.Logger.warn("onMessagesSet",n.chatId);this.messagesSet=true;var i=false;if(this.$refs.body.scrollTop<this.$refs.body.scrollHeight/2){i=true}this.scrollToBottom({force:i,cancelIfScrollChange:false})},onBeforeMobileKeyboard:function e(t){var n=t.data;var i=this.$refs.body;this.scrollBeforeMobileKeyboard=i.scrollHeight-i.scrollTop-i.clientHeight},onExternalUnreadRequest:function e(){var t=this;var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},i=n.data,r=i===void 0?{chatId:0}:i;if(r.chatId!==this.chatId){return false}o.Logger.warn("onExternalUnreadRequest");this.isRequestingUnread=true;this.drawPlaceholders(p.unread).then((function(){return t.requestUnread()}));this.externalUnreadRequestResolve=null;return new Promise((function(e,n){t.externalUnreadRequestResolve=e}))},onScrollOnStart:function e(t){var n=t.data;if(n.chatId!==this.chatId){return false}this.scrollOnStart({force:false})},scrollOnStart:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},n=t.force,i=n===void 0?true:n;o.Logger.warn("scrolling on start of dialog");var r=this.getFirstUnreadMessage();if(r){this.scrollToFirstUnreadMessage(r,i)}else{var s=this.$refs.body;this.forceScrollToPosition(s.scrollHeight-s.clientHeight)}},scrollToBottom:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},n=t.force,i=n===void 0?false:n,r=t.cancelIfScrollChange,s=r===void 0?false:r,a=t.duration,l=a===void 0?null:a;o.Logger.warn("scroll to bottom",i,s,l);if(s&&this.scrollChangedByUser){return false}var u=this.$refs.body;if(this.dialog.counter>0){var c=this.dialog.counter>1&&this.firstUnreadMessageId?this.firstUnreadMessageId:this.lastMessageId;this.scrollToFirstUnreadMessage(c,i);return true}this.showScrollButton=false;if(i){this.forceScrollToPosition(u.scrollHeight-u.clientHeight)}else{var f={};if(l){f.duration=l}this.animatedScrollToPosition(w({},f))}},scrollToFirstUnreadMessage:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;o.Logger.warn("scroll to first unread");var i=false;if(t!==null){i=this.getElementById(t)}if(!i){t=this.getFirstUnreadMessage()}this.scrollToMessage({messageId:t,force:n})},scrollToMessage:function e(t){var n=t.messageId,i=n===void 0?0:n,r=t.force,s=r===void 0?false:r,a=t.stickToTop,l=a===void 0?true:a;o.Logger.warn("scroll to message");var u=this.$refs.body;var c=this.getElementById(i);var f=0;if(!c){if(l){f=10}else{f=u.scrollHeight-u.clientHeight}}else if(l){f=c.offsetTop-this.messageScrollOffset/2}else{f=c.offsetTop+c.offsetHeight-u.clientHeight+this.messageScrollOffset/2}if(s){this.forceScrollToPosition(f)}else{this.animatedScrollToPosition({end:f})}return true},forceScrollToPosition:function e(t){o.Logger.warn("Force scroll to position - ",t);var n=this.$refs.body;if(!n){return false}if(this.animateScrollId){s.Animation.cancel(this.animateScrollId);this.scrollAnimating=false;this.animateScrollId=null}n.scrollTop=t},animatedScrollToPosition:function e(){var t=this;var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};o.Logger.warn("Animated scroll to - ",n);if(this.animateScrollId){s.Animation.cancel(this.animateScrollId);this.scrollAnimating=false}if(typeof n==="function"){n={callback:n}}var i=this.$refs.body;if(!i){if(n.callback&&typeof n.callback==="function"){n.callback()}this.animateScrollId=null;this.scrollAnimating=false;return true}if(r.Utils.platform.isIos()&&r.Utils.platform.getIosVersion()>12&&r.Utils.platform.getIosVersion()<13.2){i.scrollTop=i.scrollHeight-i.clientHeight;return true}var a=n,l=a.start,u=l===void 0?i.scrollTop:l,c=a.end,f=c===void 0?i.scrollHeight-i.clientHeight:c,d=a.increment,h=d===void 0?20:d,p=a.callback,m=a.duration,g=m===void 0?500:m;var v=this.$refs.container;if(v&&f-u>v.offsetHeight*3){u=f-v.offsetHeight*3;o.Logger.warn("Dialog.animatedScroll: Scroll trajectory has been reduced")}this.scrollAnimating=true;o.Logger.warn("Dialog.animatedScroll: User scroll blocked while scrolling");this.animateScrollId=s.Animation.start({start:u,end:f,increment:h,duration:g,element:i,elementProperty:"scrollTop",callback:function e(){t.animateScrollId=null;t.scrollAnimating=false;if(p&&typeof p==="function"){p()}}})},drawPlaceholders:function e(t){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;var i=t===p.history?this.historyMessageLimit:this.unreadMessageLimit;var r=this.generatePlaceholders(i,n);return this.$store.dispatch("messages/addPlaceholders",{placeholders:r,requestMode:t})},generatePlaceholders:function e(t,n){var i=[];for(var r=0;r<n;r++){for(var s=0;s<this.placeholdersComposition.length;s++){i.push({id:"placeholder".concat(this.placeholderCount),chatId:this.chatId,templateType:u.DialogTemplateType.placeholder,placeholderType:this.placeholdersComposition[s],unread:false});this.placeholderCount++}}return i},getPlaceholdersComposition:function e(){return[1,1,1,1,1,1,1,1,2,2,2,2,2,2,3,3,3,3,3,3,3,3].sort((function(){return.5-Math.random()}))},requestHistory:function e(){var t=this;return this.$Bitrix.RestClient.get().callMethod(u.RestMethod.imDialogMessagesGet,{chat_id:this.chatId,last_id:this.lastHistoryMessageId,limit:this.historyMessageLimit,convert_text:"Y"}).then((function(e){var n=e.data().messages;if(n.length>0){t.lastHistoryMessageId=n[n.length-1].id}if(n.length<t.historyMessageLimit){t.stopHistoryLoading=true}t.$Bitrix.Data.get("controller").executeRestAnswer(u.RestMethodHandler.imDialogMessagesGet,e);return new Promise((function(e,i){var r=t.$refs.body.scrollHeight;t.$store.dispatch("messages/updatePlaceholders",{chatId:t.chatId,data:n,firstMessage:t.pagesLoaded*t.placeholdersComposition.length,amount:t.placeholdersComposition.length}).then((function(){if(!t.isOverflowAnchorSupported()){t.enableUserScroll()}e()}));if(!t.isOverflowAnchorSupported()){o.Logger.warn("Disabling user scroll in updating placeholders");t.$nextTick((function(){var e=t.$refs.body.scrollHeight-r;t.disableUserScroll();t.forceScrollToPosition(t.$refs.body.scrollTop+e)}))}}))})).then((function(){t.pagesLoaded+=1;o.Logger.warn("History page loaded. Total loaded - ",t.pagesLoaded);return t.onAfterHistoryRequest()}))["catch"]((function(e){o.Logger.warn("Request history error",e)}))},onAfterHistoryRequest:function e(){var t=this;o.Logger.warn("onAfterHistoryRequest");if(this.stopHistoryLoading){o.Logger.warn("stopHistoryLoading, deleting all delayed requests");this.historyPagesRequested=0}if(this.historyPagesRequested>0){o.Logger.warn("We have delayed requests -",this.historyPagesRequested);this.historyPagesRequested--;return this.requestHistory()}else if(this.$refs.body.scrollTop<=this.scrollingUpThreshold&&this.remainingHistoryPages>0){o.Logger.warn("currentScroll <= scrollingUpThreshold, requesting next page and scrolling");return this.drawPlaceholders(p.history).then((function(e){t.scrollToMessage({messageId:e,force:true,stickToTop:false});return t.requestHistory()}))}else{o.Logger.warn("No more delayed requests, clearing placeholders");this.$store.dispatch("messages/clearPlaceholders",{chatId:this.chatId});this.isRequestingHistory=false;return true}},prepareUnreadRequestParams:function e(){var t;return t={},babelHelpers.defineProperty(t,u.RestMethodHandler.imDialogRead,[u.RestMethod.imDialogRead,{dialog_id:this.dialogId,message_id:this.lastUnreadMessageId}]),babelHelpers.defineProperty(t,u.RestMethodHandler.imChatGet,[u.RestMethod.imChatGet,{dialog_id:this.dialogId}]),babelHelpers.defineProperty(t,u.RestMethodHandler.imDialogMessagesGetUnread,[u.RestMethod.imDialogMessagesGet,{chat_id:this.chatId,first_id:this.lastUnreadMessageId,limit:this.unreadMessageLimit,convert_text:"Y"}]),t},requestUnread:function e(){var t=this;if(!this.lastUnreadMessageId){this.lastUnreadMessageId=this.$store.getters["messages/getLastId"](this.chatId)}if(!this.lastUnreadMessageId){return false}f.EventEmitter.emitAsync(u.EventType.dialog.readMessage,{id:this.lastUnreadMessageId,skipTimer:true,skipAjax:true}).then((function(){t.$Bitrix.RestClient.get().callBatch(t.prepareUnreadRequestParams(),(function(e){return t.onUnreadRequest(e)}))}))},onUnreadRequest:function e(t){var n=this;if(!t){o.Logger.warn("Unread request: callBatch error");return false}var i=t[u.RestMethodHandler.imChatGet];if(i.error()){o.Logger.warn("Unread request: imChatGet error",i.error());return false}this.$Bitrix.Data.get("controller").executeRestAnswer(u.RestMethodHandler.imChatGet,i);var r=t[u.RestMethodHandler.imDialogMessagesGetUnread];if(r.error()){o.Logger.warn("Unread request: imDialogMessagesGetUnread error",r.error());return false}var s=r.data().messages;if(s.length>0){this.lastUnreadMessageId=s[s.length-1].id}this.$Bitrix.Data.get("controller").executeRestAnswer(u.RestMethodHandler.imDialogMessagesGetUnread,r);this.$store.dispatch("messages/updatePlaceholders",{chatId:this.chatId,data:s,firstMessage:this.pagesLoaded*this.placeholdersComposition.length,amount:this.placeholdersComposition.length}).then((function(){n.pagesLoaded+=1;o.Logger.warn("Unread page loaded. Total loaded - ",n.pagesLoaded);return n.onAfterUnreadRequest()}))["catch"]((function(e){o.Logger.warn("Unread history error",e)}))},onAfterUnreadRequest:function e(){if(this.unreadPagesRequested>0){o.Logger.warn("We have delayed requests -",this.unreadPagesRequested);this.unreadPagesRequested--;return this.requestUnread()}else{o.Logger.warn("No more delayed requests, clearing placeholders");this.$store.dispatch("messages/clearPlaceholders",{chatId:this.chatId});this.isRequestingUnread=false;if(this.externalUnreadRequestResolve){this.externalUnreadRequestResolve()}return true}},scrollToLastPage:function e(){var t=this;o.Logger.warn("Load last page");this.drawPlaceholders(p.unread).then((function(){t.isScrolling=true;t.animatedScrollToPosition({callback:function e(){return t.onScrollToLastPage()}})}))},onScrollToLastPage:function e(){var t=this;this.showScrollButton=false;this.$store.dispatch("dialogues/update",{dialogId:this.dialogId,fields:{counter:0}});this.$store.dispatch("messages/clear",{chatId:this.chatId,keepPlaceholders:true});this.$Bitrix.RestClient.get().callBatch(this.prepareLastPageRequestParams(),(function(e){return t.onLastPageRequest(e)}))},prepareLastPageRequestParams:function e(){var t;return t={},babelHelpers.defineProperty(t,u.RestMethodHandler.imDialogRead,[u.RestMethod.imDialogRead,{dialog_id:this.dialogId}]),babelHelpers.defineProperty(t,u.RestMethodHandler.imChatGet,[u.RestMethod.imChatGet,{dialog_id:this.dialogId}]),babelHelpers.defineProperty(t,u.RestMethodHandler.imDialogMessagesGet,[u.RestMethod.imDialogMessagesGet,{chat_id:this.chatId,limit:this.unreadMessageLimit,convert_text:"Y"}]),t},onLastPageRequest:function e(t){var n=this;if(!t){o.Logger.warn("Last page request: callBatch error");return false}var i=t[u.RestMethodHandler.imChatGet];if(i.error()){o.Logger.warn("Last page request: imChatGet error",i.error());return false}this.$Bitrix.Data.get("controller").executeRestAnswer(u.RestMethodHandler.imChatGet,i);var r=t[u.RestMethodHandler.imDialogMessagesGet];if(r.error()){o.Logger.warn("Last page request: imDialogMessagesGet error",r.error());return false}var s=r.data().messages.reverse();this.$Bitrix.Data.get("controller").executeRestAnswer(u.RestMethodHandler.imDialogMessagesGet,r);this.$store.dispatch("messages/updatePlaceholders",{chatId:this.chatId,data:s,firstMessage:this.pagesLoaded*this.placeholdersComposition.length,amount:this.placeholdersComposition.length}).then((function(){n.lastHistoryMessageId=n.collection[0].id;n.pagesLoaded+=1;return n.$store.dispatch("messages/clearPlaceholders",{chatId:n.chatId})})).then((function(){n.scrollToBottom({force:true});n.stopHistoryLoading=false;n.isScrolling=false}))["catch"]((function(e){o.Logger.warn("Unread history error",e)}))},readVisibleMessages:function e(){var t=this;if(!this.windowFocused||!this.messagesSet){o.Logger.warn("reading is disabled!");return false}this.readMessageQueue=this.readMessageQueue.filter((function(e){if(t.readMessageTarget[e]){if(t.observers[h.read]){t.observers[h.read].unobserve(t.readMessageTarget[e])}delete t.readMessageTarget[e]}t.requestReadVisibleMessages(e);return false}))},requestReadVisibleMessages:function e(t){f.EventEmitter.emit(u.EventType.dialog.readMessage,{id:t})},getMessageIdsForPagination:function e(){if(this.unreadInCollection.length>0){this.lastUnreadMessageId=this.unreadInCollection[this.unreadInCollection.length-1].id}},getFirstUnreadMessage:function e(){var t=null;for(var n=this.collection.length-1;n>=0;n--){if(!this.collection[n].unread){break}t=this.collection[n].id}return t},manageScrollButton:function e(t){var n=this;var i=t.target.scrollHeight-t.target.clientHeight;this.scrollChangedByUser=this.currentScroll+this.scrollButtonDiff<i;clearTimeout(this.scrollButtonShowTimeout);this.scrollButtonShowTimeout=setTimeout((function(){if(n.scrollChangedByUser){if(!n.showScrollButton){n.showScrollButton=true}}else{if(n.showScrollButton&&n.remainingUnreadPages===0){n.showScrollButton=false}}}),200);if(t.target.scrollTop===t.target.scrollHeight-t.target.offsetHeight){clearTimeout(this.scrollButtonShowTimeout);if(this.showScrollButton&&this.remainingUnreadPages===0){this.showScrollButton=false}}},getDateObject:function e(){var t=this;if(this.dateFormatFunction){return this.dateFormatFunction}this.dateFormatFunction=Object.create(BX.Main.Date);this.dateFormatFunction._getMessage=function(e){return t.$Bitrix.Loc.getMessage(e)};return this.dateFormatFunction},getDateGroup:function e(t){var n=t.toJSON().slice(0,10);if(this.cachedDateGroups[n]){return this.cachedDateGroups[n]}var i=this.getDateFormat(m.groupTitle);this.cachedDateGroups[n]={id:n,title:this.getDateObject().format(i,t)};return this.cachedDateGroups[n]},getDateFormat:function e(t){return r.Utils.date.getFormatType(BX.Messenger.Const.DateFormat[t],this.$Bitrix.Loc.getMessages())},getDateGroupBlock:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"";return{templateId:"group"+t,templateType:u.DialogTemplateType.group,text:n}},getDelimiterBlock:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;return{templateId:"delimiter"+t,templateType:u.DialogTemplateType.delimiter}},getObserver:function e(t){var n=this;if(typeof window.IntersectionObserver==="undefined"||t.type===h.none){return{observe:function e(){},unobserve:function e(){}}}var i,r;i=function e(t){t.forEach((function(e){var t=false;if(e.isIntersecting){if(e.intersectionRatio>=.99){t=true}else if(e.intersectionRatio>0&&e.rootBounds.height<e.boundingClientRect.height+20&&e.intersectionRect.height>e.rootBounds.height/2){t=true}}if(t){n.readMessageQueue.push(e.target.dataset.messageId);n.readMessageTarget[e.target.dataset.messageId]=e.target}else{n.readMessageQueue=n.readMessageQueue.filter((function(t){return t!==e.target.dataset.messageId}));delete n.readMessageTarget[e.target.dataset.messageId]}if(n.enableReadMessages){n.readVisibleMessagesDelayed()}}))};r={root:this.$refs.body,threshold:new Array(101).fill(0).map((function(e,t){return t*.01}))};return new IntersectionObserver(i,r)},getElementClass:function e(t){var n=u.DialogReferenceClassName.listItem+"-"+t;return["bx-im-dialog-list-item",u.DialogReferenceClassName.listItem,n]},getElementById:function e(t){var n=this.$refs.body;var i=u.DialogReferenceClassName.listItem+"-"+t;return n.getElementsByClassName(i)[0]},getPlaceholderClass:function e(t){var n=u.DialogReferenceClassName.listItem+"-"+t;return["im-skeleton-item","im-skeleton-item-1","im-skeleton-item--sm",n]}},directives:{"bx-im-directive-dialog-observer":{inserted:function e(t,n,i){if(n.value===h.none){return false}if(!i.context.observers[n.value]){i.context.observers[n.value]=i.context.getObserver({type:n.value})}i.context.observers[n.value].observe(t);return true},unbind:function e(t,n,i){if(n.value===h.none){return true}if(i.context.observers[n.value]){i.context.observers[n.value].unobserve(t)}return true}}},template:'\n\t<div class="bx-im-dialog" @click="onDialogClick" @touchmove="onDialogMove" ref="container">\n\t\t<div :class="bodyClasses" @scroll.passive="onScroll" ref="body">\n\t\t\t\x3c!-- Main elements loop --\x3e\n\t\t\t<template v-for="(element, index) in formattedCollection">\n\t\t\t\t\x3c!-- Message --\x3e\n\t\t\t\t<template v-if="element.templateType === TemplateType.message">\n\t\t\t\t\t<div\n\t\t\t\t\t\t:class="getElementClass(element.id)"\n\t\t\t\t\t\t:data-message-id="element.id"\n\t\t\t\t\t\t:data-template-id="element.templateId"\n\t\t\t\t\t\t:data-type="element.templateType" \n\t\t\t\t\t\t:key="element.templateId"\n\t\t\t\t\t\tv-bx-im-directive-dialog-observer="element.unread? ObserverType.read: ObserverType.none"\n\t\t\t\t\t>\t\t\t\t\n\x3c!--\t\t\t\t\t  <div style="width: 200px; height: 50px; margin-top: 5px; background: #000; color: #fff;">{{ element.textConverted }}</div>--\x3e\n\t\t\t\t\t\t<component :is="element.params.COMPONENT_ID"\n\t\t\t\t\t\t\t:userId="userId" \n\t\t\t\t\t\t\t:dialogId="dialogId"\n\t\t\t\t\t\t\t:chatId="chatId"\n\t\t\t\t\t\t\t:message="element"\n\t\t\t\t\t\t\t:enableReactions="enableReactions"\n\t\t\t\t\t\t\t:enableDateActions="enableDateActions"\n\t\t\t\t\t\t\t:enableCreateContent="showMessageMenu"\n\t\t\t\t\t\t\t:enableGestureQuote="enableGestureQuote"\n\t\t\t\t\t\t\t:enableGestureQuoteFromRight="enableGestureQuoteFromRight"\n\t\t\t\t\t\t\t:enableGestureMenu="enableGestureMenu"\n\t\t\t\t\t\t\t:showName="showMessageUserName"\n\t\t\t\t\t\t\t:showAvatar="showMessageAvatar"\n\t\t\t\t\t\t\t:showMenu="showMessageMenu"\n\t\t\t\t\t\t\t:capturedMoveEvent="capturedMoveEvent"\n\t\t\t\t\t\t\t:referenceContentClassName="DialogReferenceClassName.listItem"\n\t\t\t\t\t\t\t:referenceContentBodyClassName="DialogReferenceClassName.listItemBody"\n\t\t\t\t\t\t\t:referenceContentNameClassName="DialogReferenceClassName.listItemName"\n\t\t\t\t\t\t\t@dragMessage="onDragMessage"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t\t\x3c!-- Date groups --\x3e\n\t\t\t\t<template v-else-if="element.templateType === TemplateType.group">\n\t\t\t\t\t<div class="bx-im-dialog-group" :data-template-id="element.templateId" :data-type="element.templateType" :key="element.templateId">\n\t\t\t\t\t\t<div class="bx-im-dialog-group-date">{{ element.text }}</div>\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t\t\x3c!-- Delimiters --\x3e\n\t\t\t\t<template v-else-if="element.templateType === TemplateType.delimiter">\n\t\t\t\t\t<div class="bx-im-dialog-delimiter" :data-template-id="element.templateId" :data-type="element.templateType" :key="element.templateId"></div>\n\t\t\t\t</template>\n\t\t\t\t\x3c!-- Placeholders --\x3e\n\t\t\t\t<template v-else-if="element.templateType === TemplateType.placeholder">\n\t\t\t\t\t<component :is="\'Placeholder\'+element.placeholderType" :element="element"/>\n\t\t\t\t</template>\n\t\t\t</template>\n\t\t\t\x3c!-- Writing and readed statuses --\x3e\n\t\t\t<transition name="bx-im-dialog-status">\n\t\t\t\t<template v-if="writingStatusText">\n\t\t\t\t\t<div class="bx-im-dialog-status">\n\t\t\t\t\t\t<span class="bx-im-dialog-status-writing"></span>\n\t\t\t\t\t\t{{ writingStatusText }}\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t\t<template v-else-if="statusReaded">\n\t\t\t\t\t<div class="bx-im-dialog-status" @click="onClickOnReadList">\n\t\t\t\t\t\t{{ statusReaded }}\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t</transition>\n\t\t\t<div v-if="showStatusPlaceholder" class="bx-im-dialog-status-placeholder"></div>\n\t\t</div>\n\t\t\x3c!-- Scroll button --\x3e\n\t\t<transition name="bx-im-dialog-scroll-button">\n\t\t\t<div v-show="showScrollButton || (unreadCounter > 0 && !isLastIdInCollection)" class="bx-im-dialog-scroll-button-box" @click="onScrollButtonClick">\n\t\t\t\t<div class="bx-im-dialog-scroll-button">\n\t\t\t\t\t<div v-show="unreadCounter" class="bx-im-dialog-scroll-button-counter">\n\t\t\t\t\t\t<div class="bx-im-dialog-scroll-button-counter-digit">{{ formattedUnreadCounter }}</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="bx-im-dialog-scroll-button-arrow"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</transition>\n\t</div>\n'};function I(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function k(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?I(Object(n),!0).forEach((function(t){babelHelpers.defineProperty(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):I(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var C={computed:k({},d.WidgetVuex.mapState({application:function e(t){return t.application}})),template:'\n\t\t<div class="bx-mobilechat-body">\n\t\t\t<div class="bx-mobilechat-warning-window">\n\t\t\t\t<div class="bx-mobilechat-warning-icon"></div>\n\t\t\t\t<template v-if="application.error.description">\n\t\t\t\t\t<div class="bx-mobilechat-help-title bx-mobilechat-help-title-sm bx-mobilechat-warning-msg" v-html="application.error.description"></div>\n\t\t\t\t</template>\n\t\t\t\t<template v-else>\n\t\t\t\t\t<div class="bx-mobilechat-help-title bx-mobilechat-help-title-md bx-mobilechat-warning-msg">{{$Bitrix.Loc.getMessage(\'IM_DIALOG_ERROR_TITLE\')}}</div>\n\t\t\t\t\t<div class="bx-mobilechat-help-title bx-mobilechat-help-title-sm bx-mobilechat-warning-msg">{{$Bitrix.Loc.getMessage(\'IM_DIALOG_ERROR_DESC\')}}</div>\n\t\t\t\t</template>\n\t\t\t</div>\n\t\t</div>\n\t'};var E={data:function e(){return{placeholdersComposition:[],placeholderTypes:[0,1],placeholderModes:["self","opponent"],placeholdersCount:20}},created:function e(){for(var t=0;t<this.placeholdersCount;t++){var n=Math.floor(Math.random()*this.placeholderTypes.length);var i=Math.floor(Math.random()*this.placeholderModes.length);this.placeholdersComposition.push({index:t,type:n,mode:this.placeholderModes[i],classes:this.getItemClasses(n,i)})}},methods:{getItemClasses:function e(t,n){var i=["im-skeleton-item"];if(this.placeholderModes[n]==="self"){i.push("im-skeleton-item-self")}else{i.push("im-skeleton-item-opponent")}if(t===0){i.push("im-skeleton-item--sm")}else{i.push("im-skeleton-item--md")}return i}},template:'\n\t\t<div class="bx-mobilechat-placeholder-wrap">\n\t\t\t<div class="bx-mobilechat-placeholder-wrap-visible">\n\t\t\t\t<template v-for="item in placeholdersComposition">\n\t\t\t\t\t<div :class="item.classes" :key="item.index">\n\t\t\t\t\t\t<div v-if="item.mode === \'opponent\'" class="im-skeleton-logo"></div>\n\t\t\t\t\t\t<div class="im-skeleton-content">\n\t\t\t\t\t\t\t<template v-if="item.type === 0">\n\t\t\t\t\t\t\t\t<div class="im-skeleton-line-row">\n\t\t\t\t\t\t\t\t\t<div style="max-width: 70%" class="im-skeleton-line"></div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class="im-skeleton-line-row">\n\t\t\t\t\t\t\t\t\t<div style="max-width: 100%" class="im-skeleton-line"></div>\n\t\t\t\t\t\t\t\t\t<div style="max-width: 26px; margin-left: auto;" class="im-skeleton-line"></div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t\t\t<div class="im-skeleton-line-row">\n\t\t\t\t\t\t\t\t\t<div style="max-width: 35%" class="im-skeleton-line"></div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class="im-skeleton-line-row">\n\t\t\t\t\t\t\t\t\t<div style="max-width: 100%" class="im-skeleton-line"></div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class="im-skeleton-line-row">\n\t\t\t\t\t\t\t\t\t<div style="max-width: 55%" class="im-skeleton-line"></div>\n\t\t\t\t\t\t\t\t\t<div style="max-width: 26px; margin-left: auto;" class="im-skeleton-line"></div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t<div class="im-skeleton-like"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t</div>\n\t\t</div>\n\t'};var _={template:'\n\t\t<div class="bx-mobilechat-loading-window">\n\t\t\t<h3 class="bx-mobilechat-help-title bx-mobilechat-help-title-md bx-mobilechat-loading-msg">\n\t\t  \t\t{{ $Bitrix.Loc.getMessage(\'IM_DIALOG_EMPTY\') }}\n\t\t\t</h3>\n\t\t</div>\n\t'};var x={props:{quotePanelData:{type:Object,default:function e(){return{id:0,title:"",description:"",color:""}}},canClose:{default:true}},methods:{close:function e(t){f.EventEmitter.emit(u.EventType.dialog.quotePanelClose,t)}},computed:{formattedTittle:function e(){return this.quotePanelData.title?this.quotePanelData.title.substr(0,255):this.$Bitrix.Loc.getMessage("IM_QUOTE_PANEL_DEFAULT_TITLE")},formattedDescription:function e(){return this.quotePanelData.description?this.quotePanelData.description.substr(0,255):""}},template:'\n\t<transition enter-active-class="bx-im-quote-panel-animation-show" leave-active-class="bx-im-quote-panel-animation-close">\t\t\t\t\n\t\t<div v-if="quotePanelData.id > 0" class="bx-im-quote-panel">\n\t\t\t<div class="bx-im-quote-panel-wrap">\n\t\t\t\t<div class="bx-im-quote-panel-box" :style="{borderLeftColor: quotePanelData.color}">\n\t\t\t\t\t<div class="bx-im-quote-panel-box-title" :style="{color: quotePanelData.color}">{{formattedTittle}}</div>\n\t\t\t\t\t<div class="bx-im-quote-panel-box-desc">{{formattedDescription}}</div>\n\t\t\t\t</div>\n\t\t\t\t<div v-if="canClose" class="bx-im-quote-panel-close" @click="close"></div>\n\t\t\t</div>\n\t\t</div>\n\t</transition>\n'};function T(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function O(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?T(Object(n),!0).forEach((function(t){babelHelpers.defineProperty(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):T(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}l.WidgetBitrixVue.component("bx-im-component-dialog",{components:{MessageList:S,ErrorState:C,LoadingState:E,EmptyState:_,QuotePanel:x},props:{userId:{default:0},dialogId:{default:0},skipDataRequest:{default:false},showLoadingState:{default:true},showEmptyState:{default:true},enableGestureQuote:{default:true},enableGestureQuoteFromRight:{default:true},enableGestureMenu:{default:false},showMessageUserName:{default:true},showMessageAvatar:{default:true}},data:function e(){return{messagesSet:false,dialogState:u.DialogState.loading}},created:function e(){f.EventEmitter.subscribe(u.EventType.dialog.messagesSet,this.onMessagesSet);this.onDialogOpen()},beforeDestroy:function e(){f.EventEmitter.unsubscribe(u.EventType.dialog.messagesSet,this.onMessagesSet)},watch:{dialogId:function e(t,n){o.Logger.warn("Switching dialogId from ",n," to ",t);this.messagesSet=false;this.onDialogOpen()}},computed:O(O({EventType:function e(){return u.EventType},DialogState:function e(){return u.DialogState},dialogWrapClasses:function e(){return["bx-mobilechat-wrapper",{"bx-mobilechat-chat-start":this.isDialogShowingMessages}]},dialogBoxClasses:function e(){return["bx-mobilechat-box",{"bx-mobilechat-box-dark-background":this.isDarkBackground}]},dialogBodyClasses:function e(){return["bx-mobilechat-body",{"bx-mobilechat-body-with-message":this.dialogState===u.DialogState.show}]},quotePanelData:function e(){var t={id:0,title:"",description:"",color:""};if(!this.isDialogShowingMessages||!this.dialog.quoteId){return t}var n=this.$store.getters["messages/getMessage"](this.dialog.chatId,this.dialog.quoteId);if(!n){return t}var i=this.$store.getters["users/get"](n.authorId);var s=this.$store.getters["files/getList"](this.dialog.chatId);return{id:this.dialog.quoteId,title:n.params.NAME?c.Text.decode(n.params.NAME):i?i.name:"",color:i?i.color:"",description:r.Utils.text.purify(n.text,n.params,s,this.localize)}},isLoading:function e(){if(!this.showLoadingState){return false}return!this.isChatIdInModel||this.isChatIdInModel&&!this.isMessagesModelInited&&!this.messagesSet},isEmpty:function e(){return this.showEmptyState&&this.messagesSet&&this.messageCollection.length===0},isChatIdInModel:function e(){var t=this.$store.state.dialogues.collection;return t[this.dialogId]&&t[this.dialogId].chatId>0},isMessagesModelInited:function e(){var t=this.$store.state.messages.collection;return t[this.chatId]},isDialogShowingMessages:function e(){var t=this.messageCollection&&this.messageCollection.length>0;if(t){this.dialogState=u.DialogState.show}else if(this.dialog&&this.dialog.init){this.dialogState=u.DialogState.empty}else{this.dialogState=u.DialogState.loading}return t},dialog:function e(){var e=this.$store.getters["dialogues/get"](this.application.dialog.dialogId);return e?e:this.$store.getters["dialogues/getBlank"]()},chatId:function e(){if(!this.application){return 0}return this.application.dialog.chatId},messageCollection:function e(){return this.$store.getters["messages/get"](this.application.dialog.chatId)},isDarkBackground:function e(){return this.application.options.darkBackground}},d.WidgetVuex.mapState({application:function e(t){return t.application}})),{},{localize:function e(){return l.WidgetBitrixVue.getFilteredPhrases(["IM_DIALOG_","IM_UTILS_","IM_MESSENGER_DIALOG_","IM_QUOTE_"],this)}}),methods:{prepareRequestDataQuery:function e(){var t;var n=(t={},babelHelpers.defineProperty(t,u.RestMethodHandler.mobileBrowserConstGet,[u.RestMethod.mobileBrowserConstGet,{}]),babelHelpers.defineProperty(t,u.RestMethodHandler.imChatGet,[u.RestMethod.imChatGet,{dialog_id:this.dialogId}]),babelHelpers.defineProperty(t,u.RestMethodHandler.imDialogMessagesGetInit,[u.RestMethod.imDialogMessagesGet,{dialog_id:this.dialogId,limit:this.getController().application.getRequestMessageLimit(),convert_text:"Y"}]),t);if(r.Utils.dialog.isChatId(this.dialogId)){n[u.RestMethodHandler.imUserGet]=[u.RestMethod.imUserGet,{}]}else{n[u.RestMethodHandler.imUserListGet]=[u.RestMethod.imUserListGet,{id:[this.userId,this.dialogId]}]}return n},requestData:function e(){var t=this;o.Logger.log("requesting dialog data");var n=this.prepareRequestDataQuery();this.$Bitrix.RestClient.get().callBatch(n,(function(e){if(!e){return false}var n=e[u.RestMethodHandler.mobileBrowserConstGet];if(!n.error()){t.executeRestAnswer(u.RestMethodHandler.mobileBrowserConstGet,n)}var i=e[u.RestMethodHandler.imUserGet];if(i&&!i.error()){t.executeRestAnswer(u.RestMethodHandler.imUserGet,i)}var r=e[u.RestMethodHandler.imUserListGet];if(r&&!r.error()){t.executeRestAnswer(u.RestMethodHandler.imUserListGet,r)}var s=e[u.RestMethodHandler.imChatGet];if(!s.error()){t.executeRestAnswer(u.RestMethodHandler.imChatGet,s)}var o=e[u.RestMethodHandler.imDialogMessagesGetInit];if(!o.error()){t.$store.dispatch("application/set",{dialog:{enableReadMessages:true}}).then((function(){t.executeRestAnswer(u.RestMethodHandler.imDialogMessagesGetInit,o)}))}}),false,false,r.Utils.getLogTrackingParams({name:"im.dialog",dialog:this.getController().application.getDialogData()}));return new Promise((function(e,t){return e()}))},onDialogOpen:function e(){if(this.isChatIdInModel){var t=this.$store.state.dialogues.collection;this.$store.commit("application/set",{dialog:{chatId:t[this.dialogId].chatId,dialogId:this.dialogId}})}if(!this.skipDataRequest){this.requestData()}},onMessagesSet:function e(t){var n=t.data;if(n.chatId!==this.chatId){return false}if(this.messagesSet===true){return false}this.messagesSet=true},getController:function e(){return this.$Bitrix.Data.get("controller")},executeRestAnswer:function e(t,n,i){this.getController().executeRestAnswer(t,n,i)}},template:'\n\t\t<div :class="dialogWrapClasses">\n\t\t\t<div :class="dialogBoxClasses" ref="chatBox">\n\t\t\t\t\x3c!-- Error state --\x3e\n\t\t\t\t<ErrorState v-if="application.error.active" />\n\t\t\t\t<template v-else>\n\t\t\t\t\t<div :class="dialogBodyClasses" key="with-message">\n\t\t\t\t\t\t\x3c!-- Loading state --\x3e\n\t\t\t\t\t  \t<LoadingState v-if="isLoading" />\n\t\t\t\t\t\t\x3c!-- Empty state --\x3e\n\t\t\t\t\t  \t<EmptyState v-else-if="isEmpty" />\n\t\t\t\t\t\t\x3c!-- Message list state --\x3e\n\t\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t\t<div class="bx-mobilechat-dialog">\n\t\t\t\t\t\t\t\t<MessageList\n\t\t\t\t\t\t\t\t\t:userId="userId" \n\t\t\t\t\t\t\t\t\t:dialogId="dialogId"\n\t\t\t\t\t\t\t\t\t:messageLimit="application.dialog.messageLimit"\n\t\t\t\t\t\t\t\t\t:enableReadMessages="application.dialog.enableReadMessages"\n\t\t\t\t\t\t\t\t\t:enableReactions="true"\n\t\t\t\t\t\t\t\t\t:enableDateActions="false"\n\t\t\t\t\t\t\t\t\t:enableCreateContent="false"\n\t\t\t\t\t\t\t\t\t:enableGestureQuote="enableGestureQuote"\n\t\t\t\t\t\t\t\t\t:enableGestureQuoteFromRight="enableGestureQuoteFromRight"\n\t\t\t\t\t\t\t\t\t:enableGestureMenu="enableGestureMenu"\n\t\t\t\t\t\t\t\t\t:showMessageUserName="showMessageUserName"\n\t\t\t\t\t\t\t\t\t:showMessageAvatar="showMessageAvatar"\n\t\t\t\t\t\t\t\t\t:showMessageMenu="false"\n\t\t\t\t\t\t\t\t />\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\x3c!-- Quote panel --\x3e\n\t\t\t\t\t\t\t<QuotePanel :quotePanelData="quotePanelData" />\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t</div>\n\t\t</div>\n\t'})})(this.BX.Messenger=this.BX.Messenger||{},BX,BX,window,BX.Messenger.Lib,BX.Messenger.Lib,BX.Messenger.Lib,BX,BX,BX.Messenger.Const,BX,BX.Event,BX);this.BX=this.BX||{};this.BX.Messenger=this.BX.Messenger||{};(function(e){"use strict";var t=function(){function e(){babelHelpers.classCallCheck(this,e);this.enabled=null;this.expireList=null;this.expireInterval=null}babelHelpers.createClass(e,[{key:"isEnabled",value:function e(){if(this.enabled!==null){return this.enabled}this.enabled=false;if(typeof window.localStorage!=="undefined"){try{window.localStorage.setItem("__bx_test_ls_feature__","ok");if(window.localStorage.getItem("__bx_test_ls_feature__")==="ok"){window.localStorage.removeItem("__bx_test_ls_feature__");this.enabled=true}}catch(e){}}if(this.enabled&&!this.expireInterval){try{var t=window.localStorage.getItem("bx-messenger-localstorage-expire");if(t){this.expireList=JSON.parse(t)}}catch(e){}clearInterval(this.expireInterval);this.expireInterval=setInterval(this._checkExpireInterval.bind(this),6e4)}return this.enabled}},{key:"set",value:function e(t,n,i,r){var s=arguments.length>4&&arguments[4]!==undefined?arguments[4]:0;if(!this.isEnabled()){return false}var o=null;if(s){o=new Date((new Date).getTime()+s*1e3)}var a=JSON.stringify({value:r,expire:o});if(window.localStorage.getItem(this._getKey(t,n,i))!==a){window.localStorage.setItem(this._getKey(t,n,i),a)}if(s){if(!this.expireList){this.expireList={}}this.expireList[this._getKey(t,n,i)]=o;window.localStorage.setItem("bx-messenger-localstorage-expire",JSON.stringify(this.expireList))}return true}},{key:"get",value:function e(t,n,i,r){if(!this.isEnabled()){return typeof r!=="undefined"?r:null}var s=window.localStorage.getItem(this._getKey(t,n,i));if(s===null){return typeof r!=="undefined"?r:null}try{s=JSON.parse(s);if(s&&typeof s.value!=="undefined"){if(!s.expire||new Date(s.expire)>new Date){s=s.value}else{window.localStorage.removeItem(this._getKey(t,n,i));if(this.expireList){delete this.expireList[this._getKey(t,n,i)]}return typeof r!=="undefined"?r:null}}else{return typeof r!=="undefined"?r:null}}catch(e){return typeof r!=="undefined"?r:null}return s}},{key:"remove",value:function e(t,n,i){if(!this.isEnabled()){return false}if(this.expireList){delete this.expireList[this._getKey(t,n,i)]}return window.localStorage.removeItem(this._getKey(t,n,i))}},{key:"_getKey",value:function e(t,n,i){return"bx-messenger-"+t+"-"+n+"-"+i}},{key:"_checkExpireInterval",value:function e(){if(!this.expireList)return true;var t=new Date;var n=0;for(var i in this.expireList){if(!this.expireList.hasOwnProperty(i)){continue}if(new Date(this.expireList[i])<=t){window.localStorage.removeItem(i);delete this.expireList[i]}else{n++}}if(n){window.localStorage.setItem("bx-messenger-localstorage-expire",JSON.stringify(this.expireList))}else{this.expireList=null;window.localStorage.removeItem("bx-messenger-localstorage-expire")}return true}}]);return e}();var n=new t;e.LocalStorage=n})(this.BX.Messenger.Lib=this.BX.Messenger.Lib||{});(function(e,t,n,i,r,s,o,a,l){"use strict";function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){babelHelpers.defineProperty(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}n.WidgetBitrixVue.component("bx-im-component-textarea",{props:{siteId:{default:"default"},userId:{default:0},dialogId:{default:0},enableCommand:{default:true},enableMention:{default:true},desktopMode:{default:false},enableEdit:{default:false},enableFile:{default:false},sendByEnter:{default:true},autoFocus:{default:null},writesEventLetter:{default:0},styles:{type:Object,default:function e(){return{}}}},data:function e(){return{placeholderMessage:"",currentMessage:"",previousMessage:"",commandListen:false,mentionListen:false,stylesDefault:Object.freeze({button:{backgroundColor:null,iconColor:null}})}},created:function e(){a.EventEmitter.subscribe(l.EventType.textarea.insertText,this.onInsertText);a.EventEmitter.subscribe(l.EventType.textarea.setFocus,this.onFocusSet);a.EventEmitter.subscribe(l.EventType.textarea.setBlur,this.onFocusClear);this.localStorage=i.LocalStorage;this.textareaHistory=this.localStorage.get(this.siteId,this.userId,"textarea-history",{});this.currentMessage=this.textareaHistory[this.dialogId]||"";this.placeholderMessage=this.currentMessage},beforeDestroy:function e(){a.EventEmitter.unsubscribe(l.EventType.textarea.insertText,this.onInsertText);a.EventEmitter.unsubscribe(l.EventType.textarea.setFocus,this.onFocusSet);a.EventEmitter.unsubscribe(l.EventType.textarea.setBlur,this.onFocusClear);clearTimeout(this.messageStoreTimeout);this.localStorage.set(this.siteId,this.userId,"textarea-history",this.textareaHistory);this.localStorage=null},computed:c({textareaClassName:function e(){return["bx-im-textarea",{"bx-im-textarea-dark-background":this.isDarkBackground,"bx-im-textarea-mobile":this.isMobile}]},buttonStyle:function e(){var t=Object.assign({},this.stylesDefault,this.styles);var n=false;if(t.button.iconColor){n=r.Utils.isDarkColor(t.button.iconColor)}else{n=!r.Utils.isDarkColor(t.button.backgroundColor)}t.button.className=n?"bx-im-textarea-send-button":"bx-im-textarea-send-button bx-im-textarea-send-button-bright-arrow";t.button.style=t.button.backgroundColor?"background-color: "+t.button.backgroundColor+";":"";return t},isDarkBackground:function e(){return this.application.options.darkBackground},isMobile:function e(){return this.application.device.type===l.DeviceType.mobile},localize:function e(){return n.WidgetBitrixVue.getFilteredPhrases("BX_MESSENGER_TEXTAREA_",this)},isIE11:function e(){return s.Browser.isIE11()}},o.WidgetVuex.mapState({application:function e(t){return t.application}})),directives:{"bx-im-focus":{inserted:function e(t,n){if(n.value===true||n.value===null&&!this.isMobile){t.focus()}}}},methods:{insertText:function e(t){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:"current";var r=arguments.length>3&&arguments[3]!==undefined?arguments[3]:"after";var s=arguments.length>4&&arguments[4]!==undefined?arguments[4]:true;var o=this.$refs.textarea;var a=o.selectionStart;var l=o.selectionEnd;if(i=="start"){if(n){t=t+"\n"}o.value=t+o.value;if(s){if(r=="after"){o.selectionStart=t.length;o.selectionEnd=o.selectionStart}else if(r=="before"){o.selectionStart=0;o.selectionEnd=o.selectionStart}}}else if(i=="current"){if(n){if(o.value.substring(0,a).trim().length>0){t="\n"+t}t=t+"\n"}else{if(o.value&&!o.value.endsWith(" ")){t=" "+t}}o.value=o.value.substring(0,a)+t+o.value.substring(l,o.value.length);if(s){if(r=="after"){o.selectionStart=a+t.length;o.selectionEnd=o.selectionStart}else if(r=="before"){o.selectionStart=a;o.selectionEnd=o.selectionStart}}}else if(i=="end"){if(n){if(o.value.substring(0,a).trim().length>0){t="\n"+t}t=t+"\n"}else{if(o.value&&!o.value.endsWith(" ")){t=" "+t}}o.value=o.value+t;if(s){if(r=="after"){o.selectionStart=o.value.length;o.selectionEnd=o.selectionStart}else if(r=="before"){o.selectionStart=o.value.length-t.length;o.selectionEnd=o.selectionStart}}}if(s){if(r=="start"){o.selectionStart=0;o.selectionEnd=0}else if(r=="end"){o.selectionStart=o.value.length;o.selectionEnd=o.selectionStart}o.focus()}this.textChangeEvent()},sendMessage:function e(t){t.preventDefault();a.EventEmitter.emit(l.EventType.textarea.sendMessage,{text:this.currentMessage.trim()});var n=this.$refs.textarea;if(n){n.value=""}if(this.autoFocus===null||this.autoFocus){n.focus()}this.textChangeEvent()},textChangeEvent:function e(){var t=this;var n=this.$refs.textarea;if(!n){return}var i=n.value.trim();if(this.currentMessage===i){return}if(this.writesEventLetter<=i.length){a.EventEmitter.emit(l.EventType.textarea.startWriting,{text:i})}this.previousMessage=this.currentMessage;this.previousSelectionStart=n.selectionStart;this.previousSelectionEnd=this.previousSelectionStart;this.currentMessage=i;if(i.toString().length>0){this.textareaHistory[this.dialogId]=i}else{delete this.textareaHistory[this.dialogId]}clearTimeout(this.messageStoreTimeout);this.messageStoreTimeout=setTimeout((function(){t.localStorage.set(t.siteId,t.userId,"textarea-history",t.textareaHistory,t.userId?0:10)}),500)},onKeyDown:function e(t){this.$emit("keydown",t);var n=t.target;var i=n.value.trim();var s=r.Utils.platform.isMac();var o=r.Utils.platform.isBitrixDesktop()||!r.Utils.browser.isChrome();if(this.commandListen);else if(this.mentionListen);else if(!(t.altKey&&t.ctrlKey)){if(this.enableMention&&t.shiftKey&&(t.keyCode==61||t.keyCode==50||t.keyCode==187||t.keyCode==187)||t.keyCode==107);else if(this.enableCommand&&(t.keyCode==191||t.keyCode==111||t.keyCode==220));}if(t.keyCode==27){if(n.value!=""&&n===document.activeElement){t.preventDefault();t.stopPropagation()}if(t.shiftKey){n.value=""}}else if(t.metaKey||t.ctrlKey){if(o&&t.key==="t"||!o&&t.key==="e"){t.preventDefault()}else if(["b","s","i","u"].includes(t.key)){var u=n.selectionStart;var c=n.selectionEnd;var f="["+t.key.toLowerCase()+"]";var d="[/"+t.key.toLowerCase()+"]";var h=n.value.substring(u,c);if(h.startsWith(f)&&h.endsWith(d)){h=h.substring(f.length,h.indexOf(d))}else{h=f+h+d}n.value=n.value.substring(0,u)+h+n.value.substring(c,n.value.length);n.selectionStart=u;n.selectionEnd=u+h.length;t.preventDefault()}}if(t.keyCode==9){this.insertText("\t");t.preventDefault()}else if(this.enableEdit&&t.keyCode==38&&i.length<=0){a.EventEmitter.emit(l.EventType.textarea.edit,{})}else if(t.keyCode==13){if(this.isMobile);else if(this.sendByEnter==true){if(t.ctrlKey||t.altKey||t.shiftKey){if(!t.shiftKey){this.insertText("\n")}}else if(i.length<=0){t.preventDefault()}else{this.sendMessage(t)}}else{if(t.ctrlKey==true){this.sendMessage(t)}else if(s&&(t.metaKey==true||t.altKey==true)){this.sendMessage(t)}}}else if((t.ctrlKey||t.metaKey)&&t.key=="z"){if(this.previousMessage){n.value=this.previousMessage;n.selectionStart=this.previousSelectionStart;n.selectionEnd=this.previousSelectionEnd;this.previousMessage="";t.preventDefault()}}},onKeyUp:function e(t){a.EventEmitter.emit(l.EventType.textarea.keyUp,{event:t,text:this.currentMessage});this.textChangeEvent()},onPaste:function e(t){this.$nextTick(this.textChangeEvent)},onInput:function e(t){this.textChangeEvent()},onFocus:function e(t){a.EventEmitter.emit(l.EventType.textarea.focus,t)},onBlur:function e(t){a.EventEmitter.emit(l.EventType.textarea.blur,t)},onAppButtonClick:function e(t,n){a.EventEmitter.emit(l.EventType.textarea.appButtonClick,{appId:t,event:n})},onInsertText:function e(t){var n=t.data,i=n===void 0?{}:n;if(!i.text){return false}this.insertText(i.text,i.breakline,i.position,i.cursor,i.focus);a.EventEmitter.emit(l.EventType.textarea.keyUp,{event:i,text:this.currentMessage});return true},onFocusSet:function e(){this.$refs.textarea.focus();return true},onFocusClear:function e(){this.$refs.textarea.blur();return true},onFileClick:function e(t){t.target.value=""},onFileSelect:function e(t){a.EventEmitter.emit(l.EventType.textarea.fileSelected,{fileChangeEvent:t,fileInput:t.target})},log:function e(t,n,i){console.warn(t);if(n==1){i.preventDefault()}},preventDefault:function e(t){t.preventDefault()}},template:'\n\t\t<div :class="textareaClassName">\n\t\t\t<div class="bx-im-textarea-box">\n\t\t\t\t<textarea ref="textarea" class="bx-im-textarea-input" @keydown="onKeyDown" @keyup="onKeyUp" @paste="onPaste" @input="onInput" @focus="onFocus" @blur="onBlur" v-bx-im-focus="autoFocus" :placeholder="localize.BX_MESSENGER_TEXTAREA_PLACEHOLDER">{{placeholderMessage}}</textarea>\n\t\t\t\t<transition enter-active-class="bx-im-textarea-send-button-show" leave-active-class="bx-im-textarea-send-button-hide">\n\t\t\t\t\t<button \n\t\t\t\t\t\tv-if="currentMessage" \n\t\t\t\t\t\t:class="buttonStyle.button.className" \n\t\t\t\t\t\t:style="buttonStyle.button.style" \n\t\t\t\t\t\t:title="localize.BX_MESSENGER_TEXTAREA_BUTTON_SEND"\n\t\t\t\t\t\t@click="sendMessage" \n\t\t\t\t\t\t@touchend="sendMessage" \n\t\t\t\t\t\t@mousedown="preventDefault" \n\t\t\t\t\t\t@touchstart="preventDefault" \n\t\t\t\t\t/>\n\t\t\t\t</transition>\n\t\t\t</div>\n\t\t\t<div class="bx-im-textarea-app-box">\n\t\t\t\t<label v-if="enableFile && !isIE11" class="bx-im-textarea-app-button bx-im-textarea-app-file" :title="localize.BX_MESSENGER_TEXTAREA_FILE">\n\t\t\t\t\t<input type="file" @click="onFileClick($event)" @change="onFileSelect($event)" multiple>\n\t\t\t\t</label>\n\t\t\t\t<button class="bx-im-textarea-app-button bx-im-textarea-app-smile" :title="localize.BX_MESSENGER_TEXTAREA_SMILE" @click="onAppButtonClick(\'smile\', $event)"></button>\n\t\t\t\t<button v-if="false" class="bx-im-textarea-app-button bx-im-textarea-app-gif" :title="localize.BX_MESSENGER_TEXTAREA_GIPHY" @click="onAppButtonClick(\'giphy\', $event)"></button>\n\t\t\t</div>\n\t\t</div>\n\t'})})(this.window=this.window||{},BX,BX,BX.Messenger.Lib,BX.Messenger.Lib,BX,BX,BX.Event,BX.Messenger.Const);(function(e,t,n,i,r,s){"use strict";function o(e){var t=[];for(var n in e){if(e.hasOwnProperty(n)){t.push(e[n])}}return t}var a=Object.freeze({none:"none",like:"like",dislike:"dislike"});var l=Object.freeze({russian:"ru",ukraine:"ua",world:"en"});var u=Object.freeze({none:"none",like:"like",smile:"smile",consent:"consent",welcome:"welcome",offline:"offline",history:"history"});var c=Object.freeze({topLeft:1,topMiddle:2,topBottom:3,bottomLeft:6,bottomMiddle:5,bottomRight:4});var f=Object.freeze({1:"top-left",2:"top-center",3:"top-right",6:"bottom-left",5:"bottom-center",4:"bottom-right"});var d=Object.freeze({width:435,height:557});var h=Object.freeze({width:340,height:435});var p=Object.freeze({configLoaded:"configLoaded",widgetOpen:"widgetOpen",widgetClose:"widgetClose",sessionStart:"sessionStart",sessionOperatorChange:"sessionOperatorChange",sessionFinish:"sessionFinish",operatorMessage:"operatorMessage",userForm:"userForm",userMessage:"userMessage",userFile:"userFile",userVote:"userVote",every:"every"});var m=o(p);var g=Object.freeze({widgetUserRegister:"imopenlines.widget.user.register",widgetChatCreate:"imopenlines.widget.chat.create",widgetConfigGet:"imopenlines.widget.config.get",widgetDialogGet:"imopenlines.widget.dialog.get",widgetDialogList:"imopenlines.widget.dialog.list",widgetUserGet:"imopenlines.widget.user.get",widgetUserConsentApply:"imopenlines.widget.user.consent.apply",widgetVoteSend:"imopenlines.widget.vote.send",widgetActionSend:"imopenlines.widget.action.send",pullServerTime:"server.time",pullConfigGet:"pull.config.get"});var v=o(g);var y=Object.freeze({guest:"guest"});var b=Object.freeze({new:0,skip:5,answer:10,client:20,clientAfterOperator:25,operator:40,waitClient:50,close:60,spam:65,duplicate:69,silentlyClose:75});var w=Object.freeze({showForm:"IMOL.Widget:showForm",hideForm:"IMOL.Widget:hideForm",processMessagesToSendQueue:"IMOL.Widget:processMessagesToSendQueue",requestData:"IMOL.Widget:requestData",showConsent:"IMOL.Widget:showConsent",acceptConsent:"IMOL.Widget:acceptConsent",consentAccepted:"IMOL.Widget:consentAccepted",declineConsent:"IMOL.Widget:declineConsent",consentDeclined:"IMOL.Widget:consentDeclined",sendDialogVote:"IMOL.Widget:sendDialogVote",createSession:"IMOL.Widget:createSession",openSession:"IMOL.Widget:openSession"});function S(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function I(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?S(Object(n),!0).forEach((function(t){babelHelpers.defineProperty(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):S(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var k=Object.freeze({none:"none",like:"like",welcome:"welcome",offline:"offline",history:"history"});var C=Object.freeze({none:"none",like:"like",dislike:"dislike"});t.WidgetBitrixVue.cloneComponent("bx-imopenlines-message","bx-im-view-message",{methods:{checkMessageParamsForForm:function e(){if(!this.message.params||!this.message.params.IMOL_FORM){return true}if(this.message.params.IMOL_FORM===k.like){if(parseInt(this.message.params.IMOL_VOTE)===this.widget.dialog.sessionId&&this.widget.dialog.userVote===C.none){s.EventEmitter.emit(w.showForm,{type:k.like,delayed:true})}}}},created:function e(){this.checkMessageParamsForForm()},computed:I({dialogNumber:function e(){if(!this.message.params){return false}if(!this.message.params.IMOL_SID){return false}return this.$Bitrix.Loc.getMessage("IMOL_MESSAGE_DIALOG_ID").replace("#ID#",this.message.params.IMOL_SID)},showMessage:function e(){if(!this.message.params){return true}if(this.message.params.IMOL_FORM&&this.message.params.IMOL_FORM==="like"){return false}return true}},n.WidgetVuex.mapState({widget:function e(t){return t.widget}})),template:'\n\t\t<div v-if="showMessage" class="bx-imopenlines-message">\n\t\t\t<div v-if="dialogNumber" class="bx-imopenlines-message-dialog-number">{{dialogNumber}}</div>\n\t\t\t#PARENT_TEMPLATE#\n\t\t</div>\n\t'})})(this.window=this.window||{},BX,BX,window,BX,BX.Event);(function(e,t,n){"use strict";function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){babelHelpers.defineProperty(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var s="Openlines";var o="livechat";t.WidgetBitrixVue.component("bx-imopenlines-form",{props:{message:{type:Object,required:false}},data:function e(){return{formSuccess:false,formError:false}},mounted:function e(){if(this.filledFormFlag){this.formSuccess=true}},computed:r({chatId:function e(){return this.application.dialog.chatId},formId:function e(){if(this.message){return String(this.message.params.CRM_FORM_ID)}if(this.widget.common.crmFormsSettings.welcomeFormId){return this.widget.common.crmFormsSettings.welcomeFormId}return""},formSec:function e(){if(this.message){return this.message.params.CRM_FORM_SEC}if(this.widget.common.crmFormsSettings.welcomeFormSec){return this.widget.common.crmFormsSettings.welcomeFormSec}return""},showForm:function e(){return this.formId&&this.formSec&&!this.formSuccess&&!this.formError},filledFormFlag:function e(){if(this.message){return this.message.params.CRM_FORM_FILLED==="Y"}return false},messageCount:function e(){return this.dialog.messageCount}},n.WidgetVuex.mapState({widget:function e(t){return t.widget},application:function e(t){return t.application},dialog:function e(t){return t.dialogues.collection[t.application.dialog.dialogId]}})),watch:{filledFormFlag:function e(t){if(t===true&&!this.formSuccess){this.formSuccess=true}},chatId:function e(t){if(t!==0&&this.widgetInitPromiseResolve){this.widgetInitPromiseResolve()}}},methods:{getCrmBindings:function e(){var t=this;return new Promise((function(e,n){t.$Bitrix.RestClient.get().callMethod("imopenlines.widget.crm.bindings.get",{OPENLINES_CODE:t.buildOpenlinesCode()}).then(e)["catch"](n)}))},onBeforeFormSubmit:function e(t){if(this.signedEntities&&this.signedEntities!==""){t.sign=this.signedEntities}},onFormSubmit:function e(t){var n=this;this.eventData=t;this.eventData.promise=this.eventData.promise.then((function(){return new Promise((function(e){if(n.chatId===0){new Promise((function(e,t){n.widgetInitPromiseResolve=e})).then((function(){n.setFormProperties();return e()}));n.getApplication().requestData()}else{if(n.widget.common.crmFormsSettings.welcomeFormDelay){n.getCrmBindings().then((function(t){n.signedEntities=t.data();n.setFormProperties();return e()}))["catch"]((function(e){console.error("Error getting CRM bindings",e)}))}else{n.setFormProperties();return e()}}}))}))},setFormProperties:function e(){if(!this.eventData){return false}this.eventData.form.setProperty("eventNamePostfix",s);this.eventData.form.setProperty("openlinesCode",this.buildOpenlinesCode());if(this.message){var t;this.eventData.form.setProperty("messageId",this.message.id);this.eventData.form.setProperty("isWelcomeForm",(t=this.message.params.IS_WELCOME_FORM)!==null&&t!==void 0?t:"N")}else{this.eventData.form.setProperty("isWelcomeForm","Y")}},buildOpenlinesCode:function e(){var t=0;if(this.dialog.entityId!==""){t=this.dialog.entityId.split("|")[0]}var n=this.dialog.chatId||0;var i=this.application.common.userId||0;return"".concat(o,"|").concat(t,"|").concat(n,"|").concat(i)},onFormSendSuccess:function e(){if(!this.message){this.$store.commit("widget/common",{dialogStart:true})}this.$emit("formSendSuccess");this.formSuccess=true},onFormSendError:function e(t){this.formError=true;this.$emit("formSendError",{error:t})},getSuccessText:function e(){return this.widget.common.crmFormsSettings.successText},getErrorText:function e(){return this.widget.common.crmFormsSettings.errorText},getApplication:function e(){return this.$Bitrix.Application.get()}},template:'\n\t\t<div class="bx-im-message bx-im-message-without-menu bx-im-message-without-avatar bx-imopenlines-form-wrapper">\n\t\t\t<div v-show="showForm" class="bx-imopenlines-form-content">\n\t\t\t\t<bx-crm-form\n\t\t\t\t\t:id="formId"\n\t\t\t\t\t:sec="formSec"\n\t\t\t\t\t:address="widget.common.host"\n\t\t\t\t\t:lang="application.common.languageId"\n\t\t\t\t\t@form:submit:post:before="onBeforeFormSubmit"\n\t\t\t\t\t@form:submit="onFormSubmit"\n\t\t\t\t\t@form:send:success="onFormSendSuccess"\n\t\t\t\t\t@form:send:error="onFormSendError"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div v-show="formSuccess" class="bx-imopenlines-form-result-container bx-imopenlines-form-success">\n\t\t\t\t<div class="bx-imopenlines-form-result-icon"></div>\n\t\t\t\t<div class="bx-imopenlines-form-result-title">\n\t\t\t\t\t{{ getSuccessText() }}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div v-show="formError" class="bx-imopenlines-form-result-container bx-imopenlines-form-error">\n\t\t\t\t<div class="bx-imopenlines-form-result-icon"></div>\n\t\t\t\t<div class="bx-imopenlines-form-result-title">\n\t\t\t\t\t{{ getErrorText() }}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t'})})(this.window=this.window||{},BX,BX);this.BX=this.BX||{};this.BX.Messenger=this.BX.Messenger||{};this.BX.Messenger.Provider=this.BX.Messenger.Provider||{};(function(e,t,n,i,r){"use strict";var s=function(){babelHelpers.createClass(e,null,[{key:"create",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};return new this(t)}}]);function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};babelHelpers.classCallCheck(this,e);if(babelHelpers["typeof"](t.controller)==="object"&&t.controller){this.controller=t.controller}if(babelHelpers["typeof"](t.store)==="object"&&t.store){this.store=t.store}}babelHelpers.createClass(e,[{key:"execute",value:function e(t,n){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};t="handle"+t.split(".").map((function(e){return e.charAt(0).toUpperCase()+e.slice(1)})).join("");if(n.error()){if(typeof this[t+"Error"]==="function"){return this[t+"Error"](n.error(),i)}}else{if(typeof this[t+"Success"]==="function"){return this[t+"Success"](n.data(),i)}}return typeof this[t]==="function"?this[t](n,i):null}}]);return e}();function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){babelHelpers.defineProperty(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var l=function(e){babelHelpers.inherits(s,e);function s(){babelHelpers.classCallCheck(this,s);return babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(s).apply(this,arguments))}babelHelpers.createClass(s,[{key:"handleImUserListGetSuccess",value:function e(n){this.store.dispatch("users/set",t.WidgetVuexBuilderModel.convertToArray(n))}},{key:"handleImUserGetSuccess",value:function e(t){this.store.dispatch("users/set",[t])}},{key:"handleImChatGetSuccess",value:function e(t){this.store.dispatch("dialogues/set",t)}},{key:"handleImDialogMessagesGetSuccess",value:function e(t){this.store.dispatch("users/set",t.users);this.store.dispatch("files/setBefore",this.controller.application.prepareFilesBeforeSave(t.files))}},{key:"handleImDialogMessagesGetInitSuccess",value:function e(t){this.store.dispatch("users/set",t.users);this.store.dispatch("files/set",this.controller.application.prepareFilesBeforeSave(t.files));if(t.messages.length===0&&t.chat_id){i.Logger.warn("setting messagesSet for empty chat",t.chat_id);setTimeout((function(){r.EventEmitter.emit(n.EventType.dialog.messagesSet,{chatId:t.chat_id})}),100)}else{this.store.dispatch("messages/set",t.messages.reverse())}}},{key:"handleImDialogMessagesGetUnreadSuccess",value:function e(t){this.store.dispatch("users/set",t.users);this.store.dispatch("files/set",this.controller.application.prepareFilesBeforeSave(t.files))}},{key:"handleImDiskFolderGetSuccess",value:function e(t){this.store.commit("application/set",{dialog:{diskFolderId:t.ID}})}},{key:"handleImMessageAddSuccess",value:function e(t,n){var i=this;this.store.dispatch("messages/update",{id:n.id,chatId:n.chatId,fields:{id:t,sending:false,error:false}}).then((function(){i.store.dispatch("messages/actionFinish",{id:t,chatId:n.chatId})}))}},{key:"handleImMessageAddError",value:function e(t,n){this.store.dispatch("messages/actionError",{id:n.id,chatId:n.chatId})}},{key:"handleImDiskFileCommitSuccess",value:function e(t,n){var i=this;this.store.dispatch("messages/update",{id:n.id,chatId:n.chatId,fields:{id:t["MESSAGE_ID"],sending:false,error:false}}).then((function(){i.store.dispatch("messages/actionFinish",{id:t["MESSAGE_ID"],chatId:n.chatId})}))}},{key:"handleImDiskFileCommitError",value:function e(t,i){this.store.dispatch("files/update",{chatId:i.chatId,id:i.file.id,fields:{status:n.FileStatus.error,progress:0}});this.store.dispatch("messages/actionError",{id:i.id,chatId:i.chatId,retry:false})}},{key:"handleImRecentListSuccess",value:function e(t,n){i.Logger.warn("Provider.Rest.handleImRecentGetSuccess",t);var r=[];var s=[];var o=[];t.items.forEach((function(e){var t=0;var n=0;if(e.user&&e.user.id>0){t=e.user.id;r.push(e.user)}if(e.chat){n=e.chat.id;s.push(Object.assign(e.chat,{dialogId:e.id}))}else{s.push(Object.assign({},{dialogId:e.id}))}o.push(a(a({},e),{},{avatar:e.avatar.url,color:e.avatar.color,userId:t,chatId:n}))}));this.store.dispatch("users/set",r);this.store.dispatch("dialogues/set",s);this.store.dispatch("recent/set",o)}}]);return s}(s);var u=function(e){babelHelpers.inherits(t,e);function t(e){var n;babelHelpers.classCallCheck(this,t);n=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this,e));n.application=e.application;return n}babelHelpers.createClass(t,[{key:"handleImChatGetSuccess",value:function e(t){this.store.commit("application/set",{dialog:{chatId:t.id,dialogId:t.dialog_id,diskFolderId:t.disk_folder_id}})}},{key:"handleImCallGetCallLimitsSuccess",value:function e(t){this.store.commit("application/set",{call:{serverEnabled:t.callServerEnabled,maxParticipants:t.maxParticipants}})}},{key:"handleImChatGetError",value:function e(t){if(t.ex.error==="ACCESS_ERROR"){i.Logger.error("MobileRestAnswerHandler.handleImChatGetError: ACCESS_ERROR")}}},{key:"handleImDialogMessagesGetInitSuccess",value:function e(t){}},{key:"handleImMessageAddSuccess",value:function e(t,n){console.warn("im.message.add success in dialog handler")}},{key:"handleImMessageAddError",value:function e(t,n){}},{key:"handleImDiskFileCommitSuccess",value:function e(t,n){}}]);return t}(s);e.BaseRestHandler=s;e.CoreRestHandler=l;e.DialogRestHandler=u})(this.BX.Messenger.Provider.Rest=this.BX.Messenger.Provider.Rest||{},BX,BX.Messenger.Const,BX.Messenger.Lib,BX.Event);(function(e){"use strict";if(typeof e.Promise==="undefined"||e.Promise.toString().indexOf("[native code]")===-1){var t="[[PromiseStatus]]";var n="[[PromiseValue]]";var i="pending";var r="internal pending";var s="resolved";var o="rejected";var a=function(e,o){if(e[t]===r){e=e[n]}if(e[t]===i){e.deferreds.push(o)}else{e.handled=true;setTimeout((function(){var i=e[t]===s?o.onFulfilled:o.onRejected;if(i){try{l(o.promise,i(e[n]))}catch(e){u(o.promise,e)}}else{if(e[t]===s){l(o.promise,e[n])}else{u(o.promise,e[n])}}}),0)}};var l=function(e,i){if(i===e){throw new TypeError("A promise cannot be resolved with it promise.")}try{if(i&&(typeof i==="object"||typeof i==="function")){if(i instanceof h){e[t]=r;e[n]=i;c(e);return}else if(typeof i.then==="function"){f(i.then.bind(i),e);return}}e[t]=s;e[n]=i;c(e)}catch(t){u(e,t)}};var u=function(e,i){e[t]=o;e[n]=i;c(e)};var c=function(e){if(e[t]===o&&e.deferreds.length===0){setTimeout((function(){if(!e.handled){console.error("Unhandled Promise Rejection: "+e[n])}}),0)}e.deferreds.forEach((function(t){a(e,t)}));e.deferreds=null};var f=function(e,t){var n=false;try{e(i,r)}catch(e){if(!n){n=true;u(t,e)}}function i(e){if(!n){n=true;l(t,e)}}function r(e){if(!n){n=true;u(t,e)}}};var d=function(e,t,n){this.onFulfilled=typeof e==="function"?e:null;this.onRejected=typeof t==="function"?t:null;this.promise=n};var h=function(e){this[t]=i;this[n]=null;this.handled=false;this.deferreds=[];f(e,this)};h.prototype["catch"]=function(e){return this.then(null,e)};h.prototype.then=function(e,t){var n=new h((function(){}));a(this,new d(e,t,n));return n};h.all=function(e){var t=[].slice.call(e);return new h((function(e,n){if(t.length===0){e(t)}else{var i=t.length;var r=function(s,o){try{if(o&&(typeof o==="object"||typeof o==="function")){if(typeof o.then==="function"){o.then.call(o,(function(e){r(s,e)}),n);return}}t[s]=o;if(--i===0){e(t)}}catch(e){n(e)}};for(var s=0;s<t.length;s++){r(s,t[s])}}}))};h.resolve=function(e){if(e&&typeof e==="object"&&e.constructor===h){return e}return new h((function(t){t(e)}))};h.reject=function(e){return new h((function(t,n){n(e)}))};h.race=function(e){return new h((function(t,n){for(var i=0,r=e.length;i<r;i++){e[i].then(t,n)}}))};e.Promise=h}})(window);this.BX=this.BX||{};this.BX.Ui=this.BX.Ui||{};this.BX.Ui.Vue=this.BX.Ui.Vue||{};this.BX.Ui.Vue.Components=this.BX.Ui.Vue.Components||{};(function(e,t){"use strict";function n(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function i(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?n(Object(i),!0).forEach((function(t){babelHelpers.defineProperty(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):n(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var r=null;t.WidgetVue.component("bx-crm-form",{props:{id:{type:String,required:true},sec:{type:String,required:true},lang:{type:String,required:true,default:"en"},address:{type:String,required:true,default:function e(){return window.location.origin}},design:{type:Object,required:false,default:function e(){return{compact:true}}}},data:function e(){return{message:"",isLoading:false,obj:{}}},beforeDestroy:function e(){if(this.obj.instance){this.obj.instance.destroy()}},mounted:function e(){var t=this;var n=function e(){t.isLoading=false;t.message="";t.obj.config.data.node=t.$el;t.obj.config.data.design=i(i({},t.obj.config.data.design),t.design);t.obj.instance=window.b24form.App.createForm24(t.obj.config,t.obj.config.data);t.obj.instance.subscribeAll((function(e,n,i){e=e||{};e.form=n;t.$emit("form:"+i,e)}))};this.isLoading=true;var s=null;if(window.fetch){var o=new FormData;o.append("id",this.id);o.append("sec",this.sec);s=fetch(this.address+"/bitrix/services/main/ajax.php?action=crm.site.form.get",{method:"POST",body:o,mode:"cors"})}else{this.message="error";return}s.then((function(e){return e.json()})).then((function(e){if(e.error){throw new Error(e.error_description)}t.obj.config=e.result.config;if(window.b24form&&window.b24form.App){n();return}if(!r){r=new Promise((function(t,n){var i=function e(){if(!window.b24form||!window.b24form||!window.b24form.App){setTimeout(e,200)}else{t()}};var r=document.createElement("script");r.src=e.result.loader.app.link;r.onload=i;r.onerror=n;document.head.appendChild(r)}))}r.then(n)["catch"]((function(e){t.message="App load failed:"+e}))}))["catch"]((function(e){t.isLoading=false;t.message=e}))},template:'\n\t\t<div>\n\t\t\t<div v-if="isLoading" class="ui-vue-crm-form-loading-container"></div>\n\t\t\t<div v-else-if="message">{{ message }}</div>\n\t\t</div>\n\t'})})(this.BX.Ui.Vue.Components.Crm=this.BX.Ui.Vue.Components.Crm||{},BX);this.BX=this.BX||{};this.BX.Messenger=this.BX.Messenger||{};this.BX.Messenger.Provider=this.BX.Messenger.Provider||{};(function(e,t,n,i,r,s){"use strict";function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){babelHelpers.defineProperty(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var l=function(){babelHelpers.createClass(e,null,[{key:"create",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};return new this(t)}}]);function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};babelHelpers.classCallCheck(this,e);if(babelHelpers["typeof"](t.controller)==="object"&&t.controller){this.controller=t.controller}if(babelHelpers["typeof"](t.store)==="object"&&t.store){this.store=t.store}this.option=babelHelpers["typeof"](t.store)==="object"&&t.store?t.store:{};if(!(babelHelpers["typeof"](this.option.handlingDialog)==="object"&&this.option.handlingDialog&&this.option.handlingDialog.chatId&&this.option.handlingDialog.dialogId)){this.option.handlingDialog=false}}babelHelpers.createClass(e,[{key:"getModuleId",value:function e(){return"im"}},{key:"getSubscriptionType",value:function e(){return s.PullClient.SubscriptionType.Server}},{key:"skipExecute",value:function e(t){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};if(!n.optionImportant){if(this.option.skip){i.Logger.info("Pull: command skipped while loading messages",t);return true}if(!this.option.handlingDialog){return false}}if(typeof t.chatId!=="undefined"||typeof t.dialogId!=="undefined"){if(typeof t.chatId!=="undefined"&&parseInt(t.chatId)===parseInt(this.option.handlingDialog.chatId)){return false}if(typeof t.dialogId!=="undefined"&&t.dialogId.toString()===this.option.handlingDialog.dialogId.toString()){return false}return true}return false}},{key:"handleMessage",value:function e(t,n){this.handleMessageAdd(t,n)}},{key:"handleMessageChat",value:function e(t,n){this.handleMessageAdd(t,n)}},{key:"handleMessageAdd",value:function e(s,o){var l=this;i.Logger.warn("handleMessageAdd",s);if(this.skipExecute(s,o)){return false}var u=this.store.state.messages.collection[s.chatId];if(!u){u=[]}var c=u.find((function(e){if(s.message.templateId&&e.id===s.message.templateId){return true}return e.id===s.message.id}));if(c&&s.message.push){return false}if(s.chat&&s.chat[s.chatId]){var f=this.store.getters["dialogues/getByChatId"](s.chatId);if(!f){var d=Object.assign({},s.chat[s.chatId],{dialogId:s.dialogId});this.store.dispatch("dialogues/set",d)}else{this.store.dispatch("dialogues/update",{dialogId:s.dialogId,fields:s.chat[s.chatId]})}}if(s.users){this.store.dispatch("users/set",t.WidgetVuexBuilderModel.convertToArray(s.users))}if(s.files){var h=this.controller.application.prepareFilesBeforeSave(t.WidgetVuexBuilderModel.convertToArray(s.files));h.forEach((function(e){if(h.length===1&&s.message.templateFileId&&l.store.state.files.index[s.chatId]&&l.store.state.files.index[s.chatId][s.message.templateFileId]){l.store.dispatch("files/update",{id:s.message.templateFileId,chatId:s.chatId,fields:e}).then((function(){r.EventEmitter.emit(n.EventType.dialog.scrollToBottom,{chatId:s.chatId,cancelIfScrollChange:true})}))}else{l.store.dispatch("files/set",e)}}))}if(c){i.Logger.warn("New message pull handler: we already have this message",s.message);this.store.dispatch("messages/update",{id:c.id,chatId:c.chatId,fields:a(a({},s.message),{},{sending:false,error:false})}).then((function(){if(!s.message.push){r.EventEmitter.emit(n.EventType.dialog.scrollToBottom,{chatId:c.chatId,cancelIfScrollChange:s.message.senderId!==l.controller.application.getUserId()})}}))}else if(this.controller.application.isUnreadMessagesLoaded()){i.Logger.warn("New message pull handler: we dont have this message",s.message);this.store.dispatch("messages/setAfter",a(a({},s.message),{},{unread:true})).then((function(){if(!s.message.push){r.EventEmitter.emit(n.EventType.dialog.newMessage,{chatId:s.message.chatId,messageId:s.message.id})}}))}this.controller.application.stopOpponentWriting({dialogId:s.dialogId,userId:s.message.senderId});if(s.message.senderId===this.controller.application.getUserId()){if(this.store.state.dialogues.collection[s.dialogId]&&this.store.state.dialogues.collection[s.dialogId].counter!==0){this.controller.restClient.callMethod("im.dialog.read",{dialog_id:s.dialogId}).then((function(){l.store.dispatch("messages/readMessages",{chatId:s.chatId}).then((function(e){r.EventEmitter.emit(n.EventType.dialog.scrollToBottom,{chatId:s.chatId,cancelIfScrollChange:false});l.store.dispatch("dialogues/update",{dialogId:s.dialogId,fields:{counter:0}})}))}))}}else if(s.message.senderId!==this.controller.application.getUserId()){this.store.dispatch("dialogues/increaseCounter",{dialogId:s.dialogId,count:1})}this.store.dispatch("dialogues/update",{dialogId:s.dialogId,fields:{lastMessageId:s.message.id}});this.store.dispatch("dialogues/increaseMessageCounter",{dialogId:s.dialogId,count:1})}},{key:"handleMessageUpdate",value:function e(t,n,i){this.execMessageUpdateOrDelete(t,n,i)}},{key:"handleMessageDelete",value:function e(t,n,i){this.execMessageUpdateOrDelete(t,n,i)}},{key:"execMessageUpdateOrDelete",value:function e(t,i,s){if(this.skipExecute(t,i)){return false}this.controller.application.stopOpponentWriting({dialogId:t.dialogId,userId:t.senderId});this.store.dispatch("messages/update",{id:t.id,chatId:t.chatId,fields:{text:s==="messageUpdate"?t.text:"",textOriginal:s==="messageUpdate"?t.textOriginal:"",params:t.params,blink:true}}).then((function(){r.EventEmitter.emit(n.EventType.dialog.scrollToBottom,{chatId:t.chatId,cancelIfScrollChange:true})}))}},{key:"handleMessageDeleteComplete",value:function e(t,n){if(this.skipExecute(t,n)){return false}this.store.dispatch("messages/delete",{id:t.id,chatId:t.chatId});this.controller.application.stopOpponentWriting({dialogId:t.dialogId,userId:t.senderId,action:false})}},{key:"handleMessageLike",value:function e(t,n){if(this.skipExecute(t,n)){return false}this.store.dispatch("messages/update",{id:t.id,chatId:t.chatId,fields:{params:{LIKE:t.users}}})}},{key:"handleChatOwner",value:function e(t,n){if(this.skipExecute(t,n)){return false}this.store.dispatch("dialogues/update",{dialogId:t.dialogId,fields:{ownerId:t.userId}})}},{key:"handleChatManagers",value:function e(t,n){if(this.skipExecute(t,n)){return false}this.store.dispatch("dialogues/update",{dialogId:t.dialogId,fields:{managerList:t.list}})}},{key:"handleChatUpdateParams",value:function e(t,n){if(this.skipExecute(t,n)){return false}this.store.dispatch("dialogues/update",{dialogId:t.dialogId,fields:t.params})}},{key:"handleChatUserAdd",value:function e(t,n){if(this.skipExecute(t,n)){return false}this.store.dispatch("dialogues/update",{dialogId:t.dialogId,fields:{userCounter:t.userCount}})}},{key:"handleChatUserLeave",value:function e(t,n){if(this.skipExecute(t,n)){return false}this.store.dispatch("dialogues/update",{dialogId:t.dialogId,fields:{userCounter:t.userCount}})}},{key:"handleMessageParamsUpdate",value:function e(t,i){if(this.skipExecute(t,i)){return false}this.store.dispatch("messages/update",{id:t.id,chatId:t.chatId,fields:{params:t.params}}).then((function(){r.EventEmitter.emit(n.EventType.dialog.scrollToBottom,{chatId:t.chatId,cancelIfScrollChange:true})}))}},{key:"handleStartWriting",value:function e(t,n){if(this.skipExecute(t,n)){return false}this.controller.application.startOpponentWriting(t)}},{key:"handleReadMessage",value:function e(t,n){var i=this;if(this.skipExecute(t,n)){return false}this.store.dispatch("messages/readMessages",{chatId:t.chatId,readId:t.lastId}).then((function(e){i.store.dispatch("dialogues/update",{dialogId:t.dialogId,fields:{counter:t.counter}})}))}},{key:"handleReadMessageChat",value:function e(t,n){this.handleReadMessage(t,n)}},{key:"handleReadMessageOpponent",value:function e(t,n){this.execReadMessageOpponent(t,n)}},{key:"handleReadMessageChatOpponent",value:function e(t,n){this.execReadMessageOpponent(t,n)}},{key:"execReadMessageOpponent",value:function e(t,n){if(this.skipExecute(t,n)){return false}this.store.dispatch("dialogues/updateReaded",{dialogId:t.dialogId,userId:t.userId,userName:t.userName,messageId:t.lastId,date:t.date,action:true})}},{key:"handleUnreadMessageOpponent",value:function e(t,n){this.execUnreadMessageOpponent(t,n)}},{key:"handleUnreadMessageChatOpponent",value:function e(t,n){this.execUnreadMessageOpponent(t,n)}},{key:"execUnreadMessageOpponent",value:function e(t,n){if(this.skipExecute(t,n)){return false}this.store.dispatch("dialogues/updateReaded",{dialogId:t.dialogId,userId:t.userId,action:false})}},{key:"handleFileUpload",value:function e(i,s){if(this.skipExecute(i,s)){return false}this.store.dispatch("files/set",this.controller.application.prepareFilesBeforeSave(t.WidgetVuexBuilderModel.convertToArray({file:i.fileParams}))).then((function(){r.EventEmitter.emit(n.EventType.dialog.scrollToBottom,{cancelIfScrollChange:true})}))}},{key:"handleChatMuteNotify",value:function e(t,n){var i=this.store.getters["dialogues/get"](t.dialogId);if(!i){return false}var r=i.muteList;var s=[];var o=this.store.state.application.common.userId;if(t.mute){s=[].concat(babelHelpers.toConsumableArray(r),[o])}else{s=r.filter((function(e){return e!==o}))}this.store.dispatch("dialogues/update",{dialogId:t.dialogId,fields:{muteList:s}})}},{key:"handleUserInvite",value:function e(t,n){if(!t.invited){this.store.dispatch("users/update",{id:t.userId,fields:t.user})}}}]);return e}();function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){babelHelpers.defineProperty(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var f=function(){babelHelpers.createClass(e,null,[{key:"create",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};return new this(t)}}]);function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};babelHelpers.classCallCheck(this,e);if(babelHelpers["typeof"](t.application)==="object"&&t.application){this.application=t.application}if(babelHelpers["typeof"](t.controller)==="object"&&t.controller){this.controller=t.controller}if(babelHelpers["typeof"](t.store)==="object"&&t.store){this.store=t.store}this.option=babelHelpers["typeof"](t.store)==="object"&&t.store?t.store:{}}babelHelpers.createClass(e,[{key:"getModuleId",value:function e(){return"im"}},{key:"getSubscriptionType",value:function e(){return s.PullClient.SubscriptionType.Server}},{key:"handleChatUserAdd",value:function e(t){if(t.dialogId!==this.store.state.application.dialog.dialogId){return false}var n=Object.values(t.users).map((function(e){return c(c({},e),{},{lastActivityDate:new Date})}));this.store.commit("conference/common",{userCount:t.userCount});this.store.dispatch("users/set",n);this.store.dispatch("conference/setUsers",{users:n.map((function(e){return e.id}))})}},{key:"handleChatUserLeave",value:function e(t){if(t.dialogId!==this.store.state.application.dialog.dialogId){return false}if(t.userId===this.controller.getUserId()){this.application.kickFromCall()}this.store.commit("conference/common",{userCount:t.userCount});this.store.dispatch("conference/removeUsers",{users:[t.userId]})}},{key:"handleCallUserNameUpdate",value:function e(t){var n=this.store.getters["users/get"](t.userId);if(!n){this.store.dispatch("users/set",{id:t.userId,lastActivityDate:new Date})}this.store.dispatch("users/update",{id:t.userId,fields:{name:t.name,lastActivityDate:new Date}})}},{key:"handleVideoconfShareUpdate",value:function e(t){if(t.dialogId===this.store.state.application.dialog.dialogId){this.store.dispatch("dialogues/update",{dialogId:t.dialogId,fields:{public:{code:t.newCode,link:t.newLink}}});this.application.changeVideoconfUrl(t.newLink)}}},{key:"handleMessageChat",value:function e(t){this.application.sendNewMessageNotify(t)}},{key:"handleChatRename",value:function e(t){if(t.chatId!==this.application.getChatId()){return false}this.store.dispatch("conference/setConferenceTitle",{conferenceTitle:t.name})}},{key:"handleConferenceUpdate",value:function e(t){if(t.chatId!==this.application.getChatId()){return false}if(t.isBroadcast!==""){this.store.dispatch("conference/setBroadcastMode",{broadcastMode:t.isBroadcast})}if(t.presenters.length>0){this.store.dispatch("conference/setPresenters",{presenters:t.presenters,replace:true})}}}]);return e}();function d(e,t){var n=typeof Symbol!=="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=h(e))||t&&e&&typeof e.length==="number"){if(n)e=n;var i=0;var r=function e(){};return{s:r,n:function t(){if(i>=e.length)return{done:true};return{done:false,value:e[i++]}},e:function e(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s=true,o=false,a;return{s:function t(){n=n.call(e)},n:function e(){var t=n.next();s=t.done;return t},e:function e(t){o=true;a=t},f:function e(){try{if(!s&&n["return"]!=null)n["return"]()}finally{if(o)throw a}}}}function h(e,t){if(!e)return;if(typeof e==="string")return p(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor)n=e.constructor.name;if(n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return p(e,t)}function p(e,t){if(t==null||t>e.length)t=e.length;for(var n=0,i=new Array(t);n<t;n++){i[n]=e[n]}return i}var m=function(){babelHelpers.createClass(e,null,[{key:"create",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};return new this(t)}}]);function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};babelHelpers.classCallCheck(this,e);if(babelHelpers["typeof"](t.application)==="object"&&t.application){this.application=t.application}if(babelHelpers["typeof"](t.controller)==="object"&&t.controller){this.controller=t.controller}if(babelHelpers["typeof"](t.store)==="object"&&t.store){this.store=t.store}this.option=babelHelpers["typeof"](t.store)==="object"&&t.store?t.store:{}}babelHelpers.createClass(e,[{key:"getModuleId",value:function e(){return"im"}},{key:"getSubscriptionType",value:function e(){return s.PullClient.SubscriptionType.Server}},{key:"handleNotifyAdd",value:function e(t,n){if(n.server_time_ago>30||t.onlyFlash===true){return false}var i=this.store.getters["users/get"](t.userId);if(!i){var r=[];r.push({id:t.userId,avatar:t.userAvatar,color:t.userColor,name:t.userName});this.store.dispatch("users/set",r)}this.store.dispatch("notifications/add",{data:t});this.store.dispatch("notifications/setCounter",{unreadTotal:t.counter});this.store.dispatch("recent/update",{id:"notify",fields:{message:{id:t.id,text:t.text,date:t.date},counter:t.counter}})}},{key:"handleNotifyConfirm",value:function e(t,n){if(n.server_time_ago>30){return false}this.store.dispatch("notifications/delete",{id:t.id});this.store.dispatch("notifications/setCounter",{unreadTotal:t.counter});this.updateRecentListOnDelete(t.counter)}},{key:"handleNotifyRead",value:function e(t,n){var i=this;if(n.server_time_ago>30){return false}t.list.forEach((function(e){i.store.dispatch("notifications/read",{ids:[e],action:true})}));this.store.dispatch("notifications/setCounter",{unreadTotal:t.counter});this.store.dispatch("recent/update",{id:"notify",fields:{counter:t.counter}})}},{key:"handleNotifyUnread",value:function e(t,n){var i=this;if(n.server_time_ago>30){return false}t.list.forEach((function(e){i.store.dispatch("notifications/read",{ids:[e],action:false})}));this.store.dispatch("notifications/setCounter",{unreadTotal:t.counter});this.store.dispatch("recent/update",{id:"notify",fields:{counter:t.counter}})}},{key:"handleNotifyDelete",value:function e(t,n){var i=this;if(n.server_time_ago>30){return false}var r=Object.keys(t.id).map((function(e){return parseInt(e,10)}));r.forEach((function(e){i.store.dispatch("notifications/delete",{id:e})}));this.updateRecentListOnDelete(t.counter);this.store.dispatch("notifications/setCounter",{unreadTotal:t.counter})}},{key:"updateRecentListOnDelete",value:function e(t){var n;var i=this.getLatest();if(i!==null){n={id:i.id,text:i.text,date:i.date}}else{var r=this.store.getters["recent/get"]("notify");if(r===false){return}n=r.element.message;n.text=this.controller.localize["IM_NOTIFICATIONS_DELETED_ITEM_STUB"]}this.store.dispatch("recent/update",{id:"notify",fields:{message:n,counter:t}})}},{key:"getLatest",value:function e(){var t={id:0};var n=d(this.store.state.notifications.collection),i;try{for(n.s();!(i=n.n()).done;){var r=i.value;if(r.id>t.id){t=r}}}catch(e){n.e(e)}finally{n.f()}if(t.id===0){return null}return t}}]);return e}();e.ImBasePullHandler=l;e.ImCallPullHandler=f;e.ImNotificationsPullHandler=m})(this.BX.Messenger.Provider.Pull=this.BX.Messenger.Provider.Pull||{},BX,BX.Messenger.Const,BX.Messenger.Lib,BX.Event,BX);this.BX=this.BX||{};this.BX.Messenger=this.BX.Messenger||{};(function(e){"use strict";var t=function(){function e(){babelHelpers.classCallCheck(this,e);this.list={};this.updateInterval=1e3;clearInterval(this.updateIntervalId);this.updateIntervalId=setInterval(this.worker.bind(this),this.updateInterval)}babelHelpers.createClass(e,[{key:"start",value:function e(t){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"default";var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:1;var r=arguments.length>3&&arguments[3]!==undefined?arguments[3]:null;var s=arguments.length>4&&arguments[4]!==undefined?arguments[4]:{};n=n==null?"default":n;i=parseFloat(i);if(isNaN(i)||i<=0){return false}i=i*1e3;if(typeof this.list[t]==="undefined"){this.list[t]={}}this.list[t][n]={dateStop:(new Date).getTime()+i,callback:typeof r==="function"?r:function(){},callbackParams:s};return true}},{key:"has",value:function e(t){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"default";n=n==null?"default":n;if(n.toString().length<=0||typeof this.list[t]==="undefined"){return false}return!!this.list[t][n]}},{key:"stop",value:function e(t){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"default";var i=arguments.length>2?arguments[2]:undefined;n=n==null?"default":n;if(n.toString().length<=0||typeof this.list[t]==="undefined"){return false}if(!this.list[t][n]){return true}if(i!==true){this.list[t][n]["callback"](n,this.list[t][n]["callbackParams"])}delete this.list[t][n];return true}},{key:"stopAll",value:function e(t){for(var n in this.list){if(this.list.hasOwnProperty(n)){for(var i in this.list[n]){if(this.list[n].hasOwnProperty(i)){this.stop(n,i,t)}}}}return true}},{key:"worker",value:function e(){for(var t in this.list){if(!this.list.hasOwnProperty(t)){continue}for(var n in this.list[t]){if(!this.list[t].hasOwnProperty(n)||this.list[t][n]["dateStop"]>new Date){continue}this.stop(t,n)}}return true}},{key:"clean",value:function e(){clearInterval(this.updateIntervalId);this.stopAll(true);return true}}]);return e}();e.Timer=t})(this.BX.Messenger.Lib=this.BX.Messenger.Lib||{});this.BX=this.BX||{};(function(e,t,n,i,r,s,o,a,l,u,c,f){"use strict";var d=function(){function e(){babelHelpers.classCallCheck(this,e);this.controller=null;this.timer=new a.Timer;this._prepareFilesBeforeSave=function(e){return e};this.defaultMessageLimit=50;this.requestMessageLimit=this.getDefaultMessageLimit();this.messageLastReadId={};this.messageReadQueue={}}babelHelpers.createClass(e,[{key:"setCoreController",value:function e(t){this.controller=t}},{key:"getSiteId",value:function e(){return this.controller.getStore().state.application.common.siteId}},{key:"getUserId",value:function e(){return this.controller.getStore().state.application.common.userId}},{key:"getLanguageId",value:function e(){return this.controller.getStore().state.application.common.languageId}},{key:"getCurrentUser",value:function e(){return this.controller.getStore().getters["users/get"](this.controller.getStore().state.application.common.userId,true)}},{key:"getChatId",value:function e(){return this.controller.getStore().state.application.dialog.chatId}},{key:"getDialogId",value:function e(){return this.controller.getStore().state.application.dialog.dialogId}},{key:"getData",value:function e(){return this.controller.getStore().state.application}},{key:"getDialogData",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.getDialogId();if(this.controller.getStore().state.dialogues.collection[t]){return this.controller.getStore().state.dialogues.collection[t]}return this.controller.getStore().getters["dialogues/getBlank"]()}},{key:"getDialogCrmData",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.getDialogId();var n={enabled:false,entityType:l.DialogCrmType.none,entityId:0};var i=this.getDialogData(t);if(i.type===l.DialogType.call){if(i.entityData1&&typeof i.entityData1==="string"){var r=i.entityData1.split("|"),s=babelHelpers.slicedToArray(r,3),o=s[0],a=s[1],u=s[2];if(o){a=a?a.toString().toLowerCase():l.DialogCrmType.none;n={enabled:o,entityType:a,entityId:u}}}}else if(i.type===l.DialogType.crm){var c=i.entityId.split("|"),f=babelHelpers.slicedToArray(c,2),d=f[0],h=f[1];d=d?d.toString().toLowerCase():l.DialogCrmType.none;n={enabled:true,entityType:d,entityId:h}}return n}},{key:"getDialogIdByChatId",value:function e(t){if(this.getDialogId()==="chat"+t){return this.getDialogId()}var n=this.controller.getStore().getters["dialogues/getByChatId"](t);if(!n){return 0}return n.dialogId}},{key:"getDiskFolderId",value:function e(){return this.controller.getStore().state.application.dialog.diskFolderId}},{key:"getDefaultMessageLimit",value:function e(){return this.defaultMessageLimit}},{key:"getRequestMessageLimit",value:function e(){return this.requestMessageLimit}},{key:"muteDialog",value:function e(){var t=this;var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.getDialogId();if(u.Utils.dialog.isEmptyDialogId(i)){return false}if(n===null){n=!this.isDialogMuted()}this.timer.start("muteDialog",i,.3,(function(e){t.controller.restClient.callMethod(l.RestMethod.imChatMute,{DIALOG_ID:i,ACTION:n?"Y":"N"})}));var r=[];if(n){r=this.getDialogData().muteList;r.push(this.getUserId())}else{r=this.getDialogData().muteList.filter((function(e){return e!==t.getUserId()}))}this.controller.getStore().dispatch("dialogues/update",{dialogId:i,fields:{muteList:r}});return true}},{key:"isDialogMuted",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.getDialogId();return this.getDialogData().muteList.includes(this.getUserId())}},{key:"isUnreadMessagesLoaded",value:function e(){var t=this.controller.getStore().state.dialogues.collection[this.getDialogId()];if(!t){return true}if(t.lastMessageId<=0){return true}var n=this.controller.getStore().state.messages.collection[this.getChatId()];if(!n||n.length<=0){return true}var i=0;for(var r=n.length-1;r>=0;r--){var s=n[r];if(typeof s.id==="number"){i=s.id;break}}return i>=t.lastMessageId}},{key:"prepareFilesBeforeSave",value:function e(t){return this._prepareFilesBeforeSave(t)}},{key:"setPrepareFilesBeforeSaveFunction",value:function e(t){this._prepareFilesBeforeSave=t.bind(this)}},{key:"showSmiles",value:function e(){this.store.dispatch("application/showSmiles")}},{key:"hideSmiles",value:function e(){this.store.dispatch("application/hideSmiles")}},{key:"startOpponentWriting",value:function e(t){var n=this;var i=t.dialogId,r=t.userId,s=t.userName;this.controller.getStore().dispatch("dialogues/updateWriting",{dialogId:i,userId:r,userName:s,action:true});this.timer.start("writingEnd",i+"|"+r,35,(function(e,t){var i=t.dialogId,r=t.userId;n.controller.getStore().dispatch("dialogues/updateWriting",{dialogId:i,userId:r,action:false})}),{dialogId:i,userId:r});return true}},{key:"stopOpponentWriting",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var n=t.dialogId,i=t.userId,r=t.userName;this.timer.stop("writingStart",n+"|"+i,true);this.timer.stop("writingEnd",n+"|"+i);return true}},{key:"startWriting",value:function e(){var t=this;var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.getDialogId();if(u.Utils.dialog.isEmptyDialogId(n)||this.timer.has("writes",n)){return false}this.timer.start("writes",n,28);this.timer.start("writesSend",n,5,(function(e){t.controller.restClient.callMethod(l.RestMethod.imDialogWriting,{DIALOG_ID:n})["catch"]((function(){t.timer.stop("writes",n)}))}))}},{key:"stopWriting",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.getDialogId();this.timer.stop("writes",t,true);this.timer.stop("writesSend",t,true)}},{key:"joinParentChat",value:function e(t,n){var i=this;return new Promise((function(e,r){if(!t||!n){return r()}if(typeof i.tempJoinChat==="undefined"){i.tempJoinChat={}}else if(i.tempJoinChat["wait"]){return r()}i.tempJoinChat["wait"]=true;i.controller.restClient.callMethod(l.RestMethod.imChatParentJoin,{DIALOG_ID:n,MESSAGE_ID:t}).then((function(){i.tempJoinChat["wait"]=false;i.tempJoinChat[n]=true;return e(n)}))["catch"]((function(){i.tempJoinChat["wait"]=false;return r()}))}))}},{key:"setTextareaMessage",value:function e(t){var n=t.message,i=n===void 0?"":n,r=t.dialogId,s=r===void 0?this.getDialogId():r;this.controller.getStore().dispatch("dialogues/update",{dialogId:s,fields:{textareaMessage:i}})}},{key:"setSendingMessageFlag",value:function e(t){this.controller.getStore().dispatch("messages/actionStart",{id:t,chatId:this.getChatId()})}},{key:"reactMessage",value:function e(t){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:"auto";this.controller.restClient.callMethod(l.RestMethod.imMessageLike,{MESSAGE_ID:t,ACTION:n==="auto"?"auto":n==="set"?"plus":"minus"})}},{key:"readMessage",value:function e(){var t=this;var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;var s=this.getChatId();if(typeof this.messageLastReadId[s]==="undefined"){this.messageLastReadId[s]=null}if(typeof this.messageReadQueue[s]==="undefined"){this.messageReadQueue[s]=[]}if(n){this.messageReadQueue[s].push(parseInt(n))}this.timer.stop("readMessage",s,true);this.timer.stop("readMessageServer",s,true);if(i){return this.readMessageExecute(s,r)}return new Promise((function(e,n){t.timer.start("readMessage",s,.1,(function(n,i){return t.readMessageExecute(n,r).then((function(t){return e(t)}))}))}))}},{key:"readMessageExecute",value:function e(t){var n=this;var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;return new Promise((function(e,r){if(n.messageReadQueue[t]){n.messageReadQueue[t]=n.messageReadQueue[t].filter((function(e){if(!n.messageLastReadId[t]){n.messageLastReadId[t]=e}else if(n.messageLastReadId[t]<e){n.messageLastReadId[t]=e}}))}var s=n.getDialogIdByChatId(t);var o=n.messageLastReadId[t]||0;if(o<=0){e({dialogId:s,lastId:0});return true}n.controller.getStore().dispatch("messages/readMessages",{chatId:t,readId:o}).then((function(r){n.controller.getStore().dispatch("dialogues/decreaseCounter",{dialogId:s,count:r.count});if(n.getChatId()===t&&n.controller.getStore().getters["dialogues/canSaveChat"]){var a=n.controller.getStore().getters["dialogues/get"](s);if(a.counter<=0){n.controller.getStore().commit("application/clearDialogExtraCount")}}if(i){e({dialogId:s,lastId:o})}else{n.timer.start("readMessageServer",t,.5,(function(){n.controller.restClient.callMethod(l.RestMethod.imDialogRead,{DIALOG_ID:s,MESSAGE_ID:o}).then((function(){return e({dialogId:s,lastId:o})}))["catch"]((function(){return e({dialogId:s,lastId:o})}))}))}}))["catch"]((function(){e()}))}))}},{key:"unreadMessage",value:function e(){var t=this;var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var r=this.getChatId();if(typeof this.messageLastReadId[r]==="undefined"){this.messageLastReadId[r]=null}if(typeof this.messageReadQueue[r]==="undefined"){this.messageReadQueue[r]=[]}if(n){this.messageReadQueue[r]=this.messageReadQueue[r].filter((function(e){return e<n}))}this.timer.stop("readMessage",r,true);this.timer.stop("readMessageServer",r,true);this.messageLastReadId[r]=n;this.controller.getStore().dispatch("messages/unreadMessages",{chatId:r,unreadId:this.messageLastReadId[r]}).then((function(e){var s=t.getDialogIdByChatId(r);t.controller.getStore().dispatch("dialogues/update",{dialogId:s,fields:{unreadId:n}});t.controller.getStore().dispatch("dialogues/increaseCounter",{dialogId:s,count:e.count});if(!i){t.controller.restClient.callMethod(l.RestMethod.imDialogUnread,{DIALOG_ID:s,MESSAGE_ID:t.messageLastReadId[r]})}}))["catch"]((function(){}))}},{key:"shareMessage",value:function e(t,n){this.controller.restClient.callMethod(l.RestMethod.imMessageShare,{DIALOG_ID:this.getDialogId(),MESSAGE_ID:t,TYPE:n});return true}},{key:"replyToUser",value:function e(t,n){return true}},{key:"openMessageReactionList",value:function e(t,n){return true}},{key:"emit",value:function e(t){var n;for(var i=arguments.length,r=new Array(i>1?i-1:0),s=1;s<i;s++){r[s-1]=arguments[s]}(n=c.WidgetVue.event).$emit.apply(n,[t].concat(r))}},{key:"listen",value:function e(t,n){c.WidgetVue.event.$on(t,n)}}]);return e}();function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){babelHelpers.defineProperty(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var m=function(){function e(){var t=this;var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};babelHelpers.classCallCheck(this,e);this.inited=false;this.initPromise=new Promise((function(e,n){t.initPromiseResolver=e}));this.offline=false;this.restAnswerHandler=[];this.vuexAdditionalModel=[];this.store=null;this.storeBuilder=null;this.init().then((function(){return t.prepareParams(n)})).then((function(){return t.initController()})).then((function(){return t.initLocalStorage()})).then((function(){return t.initStorage()})).then((function(){return t.initRestClient()})).then((function(){return t.initPullClient()})).then((function(){return t.initEnvironment()})).then((function(){return t.initComplete()}))["catch"]((function(e){f.Logger.error("error initializing core controller",e)}))}babelHelpers.createClass(e,[{key:"init",value:function e(){return Promise.resolve()}},{key:"prepareParams",value:function e(r){var s=this;if(typeof r.localize!=="undefined"){this.localize=r.localize}else{if(typeof BX!=="undefined"){this.localize=p({},BX.message)}else{this.localize={}}}if(typeof r.host!=="undefined"){this.host=r.host}else{this.host=location.origin}if(typeof r.userId!=="undefined"){var o=parseInt(r.userId);if(!isNaN(o)){this.userId=o}else{this.userId=0}}else{var a=this.getLocalize("USER_ID");this.userId=a?parseInt(a):0}if(typeof r.siteId!=="undefined"){if(typeof r.siteId==="string"&&r.siteId!==""){this.siteId=r.siteId}else{this.siteId="s1"}}else{this.siteId=this.getLocalize("SITE_ID")||"s1"}if(typeof r.siteDir!=="undefined"){if(typeof r.siteDir==="string"&&r.siteDir!==""){this.siteDir=r.siteDir}else{this.siteDir="s1"}}else{this.siteDir=this.getLocalize("SITE_DIR")||"s1"}if(typeof r.languageId!=="undefined"){if(typeof r.languageId==="string"&&r.languageId!==""){this.languageId=r.languageId}else{this.languageId="en"}}else{this.languageId=this.getLocalize("LANGUAGE_ID")||"en"}this.pullInstance=t.PullClient;this.pullClient=t.PULL;if(typeof r.pull!=="undefined"){if(typeof r.pull.instance!=="undefined"){this.pullInstance=r.pull.instance}if(typeof r.pull.client!=="undefined"){this.pullClient=r.pull.client}}this.restInstance=n.RestClient;this.restClient=n.rest;if(typeof r.rest!=="undefined"){if(typeof r.rest.instance!=="undefined"){this.restInstance=r.rest.instance}if(typeof r.rest.client!=="undefined"){this.restClient=r.rest.client}}this.vuexBuilder={database:false,databaseName:"desktop/im",databaseType:i.WidgetVuexBuilder.DatabaseType.indexedDb};if(typeof r.vuexBuilder!=="undefined"){if(typeof r.vuexBuilder.database!=="undefined"){this.vuexBuilder.database=r.vuexBuilder.database}if(typeof r.vuexBuilder.databaseName!=="undefined"){this.vuexBuilder.databaseName=r.vuexBuilder.databaseName}if(typeof r.vuexBuilder.databaseType!=="undefined"){this.vuexBuilder.databaseType=r.vuexBuilder.databaseType}if(typeof r.vuexBuilder.models!=="undefined"){r.vuexBuilder.models.forEach((function(e){s.addVuexModel(e)}))}}return Promise.resolve()}},{key:"initController",value:function e(){this.application=new d;this.application.setCoreController(this);return new Promise((function(e,t){return e()}))}},{key:"initLocalStorage",value:function e(){return new Promise((function(e,t){return e()}))}},{key:"initStorage",value:function e(){var t=this;var n={common:{host:this.getHost(),userId:this.getUserId(),siteId:this.getSiteId(),languageId:this.getLanguageId()},dialog:{messageLimit:this.application.getDefaultMessageLimit(),enableReadMessages:true},device:{type:u.Utils.device.isMobile()?l.DeviceType.mobile:l.DeviceType.desktop,orientation:u.Utils.device.getOrientation()}};var s=(new i.WidgetVuexBuilder).addModel(r.ApplicationModel.create().useDatabase(false).setVariables(n)).addModel(r.MessagesModel.create().useDatabase(this.vuexBuilder.database).setVariables({host:this.getHost()})).addModel(r.DialoguesModel.create().useDatabase(this.vuexBuilder.database).setVariables({host:this.getHost()})).addModel(r.FilesModel.create().useDatabase(this.vuexBuilder.database).setVariables({host:this.getHost(),default:{name:"File is deleted"}})).addModel(r.UsersModel.create().useDatabase(this.vuexBuilder.database).setVariables({host:this.getHost(),default:{name:"Anonymous"}})).addModel(r.RecentModel.create().useDatabase(false).setVariables({host:this.getHost()})).addModel(r.NotificationsModel.create().useDatabase(false).setVariables({host:this.getHost()}));this.vuexAdditionalModel.forEach((function(e){s.addModel(e)}));s.setDatabaseConfig({name:this.vuexBuilder.databaseName,type:this.vuexBuilder.databaseType,siteId:this.getSiteId(),userId:this.getUserId()});return s.build().then((function(e){t.store=e.store;t.storeBuilder=e.builder;return new Promise((function(e,t){return e()}))}))}},{key:"initRestClient",value:function e(t){this.addRestAnswerHandler(o.CoreRestHandler.create({store:this.store,controller:this}));return new Promise((function(e,t){return e()}))}},{key:"initPullClient",value:function e(){if(!this.pullClient){return false}this.pullClient.subscribe(this.pullBaseHandler=new s.ImBasePullHandler({store:this.store,controller:this}));this.pullClient.subscribe({type:this.pullInstance.SubscriptionType.Status,callback:this.eventStatusInteraction.bind(this)});this.pullClient.subscribe({type:this.pullInstance.SubscriptionType.Online,callback:this.eventOnlineInteraction.bind(this)});return new Promise((function(e,t){return e()}))}},{key:"initEnvironment",value:function e(t){var n=this;window.addEventListener("orientationchange",(function(){if(!n.store){return}n.store.commit("application/set",{device:{orientation:u.Utils.device.getOrientation()}});if(n.store.state.application.device.type===l.DeviceType.mobile&&n.store.state.application.device.orientation===l.DeviceOrientation.horizontal){document.activeElement.blur()}}));return new Promise((function(e,t){return e()}))}},{key:"initComplete",value:function e(){this.inited=true;this.initPromiseResolver(this)}},{key:"eventStatusInteraction",value:function e(t){if(t.status===this.pullInstance.PullStatus.Online){this.offline=false}else if(t.status===this.pullInstance.PullStatus.Offline){this.offline=true}}},{key:"eventOnlineInteraction",value:function e(t){if(t.command==="list"||t.command==="userStatus"){for(var n in t.params.users){if(!t.params.users.hasOwnProperty(n)){continue}this.store.dispatch("users/update",{id:t.params.users[n].id,fields:t.params.users[n]})}}}},{key:"executeRestAnswer",value:function e(t,n,i){f.Logger.warn("Core.controller.executeRestAnswer",t,n,i);this.restAnswerHandler.forEach((function(e){e.execute(t,n,i)}))}},{key:"createVue",value:function e(t){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var i=this;var r=function e(){};if(n.beforeCreate){r=n.beforeCreate}var s=function e(){};if(n.destroyed){s=n.destroyed}var o=function e(){};if(n.created){o=n.created}var a={store:this.store,beforeCreate:function e(){this.$bitrix.Data.set("controller",i);this.$bitrix.Application.set(t);this.$bitrix.Loc.setMessage(i.localize);if(i.restClient){this.$bitrix.RestClient.set(i.restClient)}if(i.pullClient){this.$bitrix.PullClient.set(i.pullClient)}r.bind(this)()},created:function e(){o.bind(this)()},destroyed:function e(){s.bind(this)()}};if(n.el){a.el=n.el}if(n.template){a.template=n.template}if(n.computed){a.computed=n.computed}if(n.data){a.data=n.data}var l=a.created;return new Promise((function(e,t){a.created=function(){l.bind(this)();e(this)};c.WidgetBitrixVue.createApp(a)}))}},{key:"getHost",value:function e(){return this.host}},{key:"setHost",value:function e(t){this.host=t;this.store.commit("application/set",{common:{host:t}})}},{key:"getUserId",value:function e(){return this.userId}},{key:"setUserId",value:function e(t){var n=parseInt(t);if(!isNaN(n)){this.userId=n}else{this.userId=0}this.store.commit("application/set",{common:{userId:t}})}},{key:"getSiteId",value:function e(){return this.siteId}},{key:"setSiteId",value:function e(t){if(typeof t==="string"&&t!==""){this.siteId=t}else{this.siteId="s1"}this.store.commit("application/set",{common:{siteId:this.siteId}})}},{key:"getLanguageId",value:function e(){return this.languageId}},{key:"setLanguageId",value:function e(t){if(typeof t==="string"&&t!==""){this.languageId=t}else{this.languageId="en"}this.store.commit("application/set",{common:{languageId:this.languageId}})}},{key:"getStore",value:function e(){return this.store}},{key:"getStoreBuilder",value:function e(){return this.storeBuilder}},{key:"addRestAnswerHandler",value:function e(t){this.restAnswerHandler.push(t)}},{key:"addVuexModel",value:function e(t){this.vuexAdditionalModel.push(t)}},{key:"isOnline",value:function e(){return!this.offline}},{key:"ready",value:function e(){if(this.inited){return Promise.resolve(this)}return this.initPromise}},{key:"setError",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"";var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"";f.Logger.error("Messenger.Application.error: ".concat(t," (").concat(n,")"));var i="";if(t.endsWith("LOCALIZED")){i=n}this.store.commit("application/set",{error:{active:true,code:t,description:i}})}},{key:"clearError",value:function e(){this.store.commit("application/set",{error:{active:false,code:"",description:""}})}},{key:"addLocalize",value:function e(t){if(babelHelpers["typeof"](t)!=="object"||!t){return false}for(var n in t){if(t.hasOwnProperty(n)){this.localize[n]=t[n]}}return true}},{key:"getLocalize",value:function e(t){var n="";if(typeof t==="undefined"){return this.localize}else if(typeof this.localize[t.toString()]==="undefined"){f.Logger.warn("Controller.Core.getLocalize: message with code '".concat(t.toString(),"' is undefined."))}else{n=this.localize[t]}return n}}]);return e}();e.Controller=m})(this.BX.Messenger=this.BX.Messenger||{},BX,BX,BX,BX.Messenger.Model,BX.Messenger.Provider.Pull,BX.Messenger.Provider.Rest,BX.Messenger.Lib,BX.Messenger.Const,BX.Messenger.Lib,BX,BX.Messenger.Lib);this.BX=this.BX||{};this.BX.Messenger=this.BX.Messenger||{};(function(e,t){"use strict";var n={get:function e(n,i){var r=n?n+"_"+i:i;if(navigator.cookieEnabled){var s=document.cookie.match(new RegExp("(?:^|; )"+r.replace(/([.$?*|{}()\[\]\\\/+^])/g,"\\$1")+"=([^;]*)"));if(s){return decodeURIComponent(s[1])}}if(t.LocalStorage.isEnabled()){var o=t.LocalStorage.get(n,0,i,undefined);if(typeof o!=="undefined"){return o}}if(typeof window.BX.GuestUserCookie==="undefined"){window.BX.GuestUserCookie={}}return window.BX.GuestUserCookie[r]},set:function e(n,i,r,s){s=s||{};var o=s.expires;if(typeof o=="number"&&o){var a=new Date;a.setTime(a.getTime()+o*1e3);o=s.expires=a}if(o&&o.toUTCString){s.expires=o.toUTCString()}r=encodeURIComponent(r);var l=n?n+"_"+i:i;var u=l+"="+r;for(var c in s){if(!s.hasOwnProperty(c)){continue}u+="; "+c;var f=s[c];if(f!==true){u+="="+f}}document.cookie=u;if(typeof window.BX.GuestUserCookie==="undefined"){BX.GuestUserCookie={}}window.BX.GuestUserCookie[l]=r;t.LocalStorage.set(n,0,i,r);return true}};e.Cookie=n})(this.BX.Messenger.Lib=this.BX.Messenger.Lib||{},BX.Messenger.Lib);this.BX=this.BX||{};this.BX.Messenger=this.BX.Messenger||{};(function(e,t,n){"use strict";var i=function(){function e(t){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};babelHelpers.classCallCheck(this,e);babelHelpers.defineProperty(this,"token",null);babelHelpers.defineProperty(this,"nextDataChunkToSend",null);babelHelpers.defineProperty(this,"readOffset",0);this.diskFolderId=t.diskFolderId;this.listener=t.listener;this.status=t.status;this.taskId=t.taskId;this.fileData=t.fileData;this.fileName=t.fileName||this.fileData.name;this.generateUniqueName=t.generateUniqueName;this.chunkSizeInBytes=t.chunkSize;this.previewBlob=t.previewBlob||null;this.requestToDelete=false;this.listener("onStartUpload",{id:this.taskId,file:this.fileData,previewData:this.previewBlob});this.host=n.host||null;this.actionUploadChunk=n.actionUploadChunk||"disk.api.content.upload";this.actionCommitFile=n.actionCommitFile||"disk.api.file.createByContent";this.actionRollbackUpload=n.actionRollbackUpload||"disk.api.content.rollbackUpload";this.customHeaders=n.customHeaders||null}babelHelpers.createClass(e,[{key:"uploadContent",value:function e(){var t=this;if(this.status===r.STATUSES.CANCELLED){return}this.status=r.STATUSES.PROGRESS;this.readNext();var n="".concat(this.host?this.host:"","\n\t\t\t/bitrix/services/main/ajax.php?action=").concat(this.actionUploadChunk,"\n\t\t\t&filename=").concat(this.fileName,"\n\t\t\t").concat(this.token?"&token="+this.token:"");var i="bytes "+this.readOffset+"-"+(this.readOffset+this.chunkSizeInBytes-1)+"/"+this.fileData.size;this.calculateProgress();var s={"Content-Type":this.fileData.type,"Content-Range":i};if(!this.customHeaders){s["X-Bitrix-Csrf-Token"]=BX.bitrix_sessid()}else{for(var o in this.customHeaders){if(this.customHeaders.hasOwnProperty(o)){s[o]=this.customHeaders[o]}}}fetch(n,{method:"POST",headers:s,credentials:"include",body:this.nextDataChunkToSend}).then((function(e){return e.json()})).then((function(e){if(e.errors.length>0){t.status=r.STATUSES.FAILED;t.listener("onUploadFileError",{id:t.taskId,result:e});console.error(e.errors[0].message)}else if(e.data.token){t.token=e.data.token;t.readOffset=t.readOffset+t.chunkSizeInBytes;if(!t.isEndOfFile()){t.uploadContent()}else{t.createFileFromUploadedChunks()}}}))["catch"]((function(e){t.status=r.STATUSES.FAILED;t.listener("onUploadFileError",{id:t.taskId,result:e})}))}},{key:"deleteContent",value:function e(){this.status=r.STATUSES.CANCELLED;this.requestToDelete=true;if(!this.token){console.error("Empty token.");return}var t="".concat(this.host?this.host:"","/bitrix/services/main/ajax.php?\n\t\taction=").concat(this.actionRollbackUpload,"&token=").concat(this.token);var n={};if(!this.customHeaders){n["X-Bitrix-Csrf-Token"]=BX.bitrix_sessid()}else{for(var i in this.customHeaders){if(this.customHeaders.hasOwnProperty(i)){n[i]=this.customHeaders[i]}}}fetch(t,{method:"POST",credentials:"include",headers:n}).then((function(e){return e.json()})).then((function(e){return console.log(e)}))["catch"]((function(e){return console.error(e)}))}},{key:"createFileFromUploadedChunks",value:function e(){var t=this;if(!this.token){console.error("Empty token.");return}if(this.requestToDelete){return}var n="".concat(this.host?this.host:"","/bitrix/services/main/ajax.php?action=").concat(this.actionCommitFile,"&filename=").concat(this.fileName)+"&folderId="+this.diskFolderId+"&contentId="+this.token+(this.generateUniqueName?"&generateUniqueName=true":"");var i={"X-Upload-Content-Type":this.fileData.type};if(!this.customHeaders){i["X-Bitrix-Csrf-Token"]=BX.bitrix_sessid()}else{for(var s in this.customHeaders){if(this.customHeaders.hasOwnProperty(s)){i[s]=this.customHeaders[s]}}}var o=new FormData;if(this.previewBlob){o.append("previewFile",this.previewBlob,"preview_"+this.fileName+".jpg")}fetch(n,{method:"POST",headers:i,credentials:"include",body:o}).then((function(e){return e.json()})).then((function(e){t.uploadResult=e;if(e.errors.length>0){t.status=r.STATUSES.FAILED;t.listener("onCreateFileError",{id:t.taskId,result:e});console.error(e.errors[0].message)}else{t.calculateProgress();t.status=r.STATUSES.DONE;t.listener("onComplete",{id:t.taskId,result:e})}}))["catch"]((function(e){t.status=r.STATUSES.FAILED;t.listener("onCreateFileError",{id:t.taskId,result:e})}))}},{key:"calculateProgress",value:function e(){this.progress=Math.round(this.readOffset*100/this.fileData.size);this.listener("onProgress",{id:this.taskId,progress:this.progress,readOffset:this.readOffset,fileSize:this.fileData.size})}},{key:"readNext",value:function e(){if(this.readOffset+this.chunkSizeInBytes>this.fileData.size){this.chunkSizeInBytes=this.fileData.size-this.readOffset}this.nextDataChunkToSend=this.fileData.slice(this.readOffset,this.readOffset+this.chunkSizeInBytes)}},{key:"isEndOfFile",value:function e(){return this.readOffset>=this.fileData.size}}]);return e}();var r=function(e){babelHelpers.inherits(t,e);function t(e){var n;babelHelpers.classCallCheck(this,t);n=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this));babelHelpers.defineProperty(babelHelpers.assertThisInitialized(n),"queue",[]);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(n),"isCloud",BX.message.isCloud);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(n),"phpUploadMaxFilesize",BX.message.phpUploadMaxFilesize);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(n),"phpPostMaxSize",BX.message.phpPostMaxSize);n.setEventNamespace("BX.Messenger.Lib.Uploader");n.generatePreview=e.generatePreview||false;if(e){n.inputNode=e.inputNode||null;n.dropNode=e.dropNode||null;n.fileMaxSize=e.fileMaxSize||null;n.fileMaxWidth=e.fileMaxWidth||null;n.fileMaxHeight=e.fileMaxHeight||null;if(e.sender){n.senderOptions={host:e.sender.host,actionUploadChunk:e.sender.actionUploadChunk,actionCommitFile:e.sender.actionCommitFile,actionRollbackUpload:e.sender.actionRollbackUpload,customHeaders:e.sender.customHeaders||null}}n.assignInput();n.assignDrop()}return n}babelHelpers.createClass(t,[{key:"setInputNode",value:function e(t){if(t instanceof HTMLInputElement||Array.isArray(t)){this.inputNode=t;this.assignInput()}}},{key:"addFilesFromEvent",value:function e(t){var n=this;Array.from(t.target.files).forEach((function(e){n.emitSelectedFile(e)}))}},{key:"getPreview",value:function e(n){var i=this;return new Promise((function(e,r){if(!i.generatePreview){e()}if(n instanceof File){if(n.type.startsWith("video")){t.getVideoPreviewBlob(n,10).then((function(e){return i.getImageDimensions(e)})).then((function(t){return e(t)}))["catch"]((function(e){return r(e)}))}else if(n.type.startsWith("image")){var s=new Blob([n],{type:n.type});i.getImageDimensions(s).then((function(t){return e(t)}))}else{e()}}else{r("Parameter 'file' is not instance of 'File'")}}))}},{key:"addTask",value:function e(n){var r=this;if(!this.isModernBrowser()){console.warn("Unsupported browser!");return}if(!this.checkTaskParams(n)){return}n.chunkSize=this.calculateChunkSize(n.chunkSize);n.listener=function(e,t){return r.onUploadEvent(e,t)};n.status=t.STATUSES.PENDING;var s=new i(n,this.senderOptions);this.queue.push(s);this.checkUploadQueue()}},{key:"deleteTask",value:function e(t){if(!t){return}this.queue=this.queue.filter((function(e){if(e.taskId===t){e.deleteContent();return false}return true}))}},{key:"getTask",value:function e(t){var n=this.queue.find((function(e){return e.taskId===t}));if(n){return{id:n.id,diskFolderId:n.diskFolderId,fileData:n.fileData,fileName:n.fileName,progress:n.progress,readOffset:n.readOffset,status:n.status,token:n.token,uploadResult:n.uploadResult}}return null}},{key:"checkUploadQueue",value:function e(){if(this.queue.length>0){var n=this.queue.filter((function(e){return e.status===t.STATUSES.PENDING}));if(n.length>0){n[0].uploadContent()}}}},{key:"onUploadEvent",value:function e(t,n){this.emit(t,n);this.checkUploadQueue()}},{key:"checkTaskParams",value:function e(t){if(!t.taskId){console.error("Empty Task ID.");return false}if(!t.fileData){console.error("Empty file data.");return false}if(!t.diskFolderId){console.error("Empty disk folder ID.");return false}if(this.fileMaxSize&&this.fileMaxSize<t.fileData.size){var n={maxFileSizeLimit:this.fileMaxSize,file:t.fileData};this.emit("onFileMaxSizeExceeded",n);return false}return true}},{key:"calculateChunkSize",value:function e(i){if(n.Type.isUndefined(this.isCloud)){return i}var r=0;if(i){r=i}if(this.isCloud==="Y"){r=r<t.CLOUD_MIN_CHUNK_SIZE?t.CLOUD_MIN_CHUNK_SIZE:r;r=r>t.CLOUD_MAX_CHUNK_SIZE?t.CLOUD_MAX_CHUNK_SIZE:r}else{var s=Math.min(this.phpPostMaxSize,this.phpUploadMaxFilesize);r=r<t.BOX_MIN_CHUNK_SIZE?t.BOX_MIN_CHUNK_SIZE:r;r=r>s?s:r}return r}},{key:"isModernBrowser",value:function e(){return typeof fetch!=="undefined"}},{key:"assignInput",value:function e(){var t=this;if(this.inputNode instanceof HTMLInputElement){this.setOnChangeEventListener(this.inputNode)}else if(Array.isArray(this.inputNode)){this.inputNode.forEach((function(e){if(e instanceof HTMLInputElement){t.setOnChangeEventListener(e)}}))}}},{key:"setOnChangeEventListener",value:function e(t){var n=this;t.addEventListener("change",(function(e){n.addFilesFromEvent(e)}),false)}},{key:"assignDrop",value:function e(){var t=this;if(this.dropNode instanceof HTMLElement){this.setDropEventListener(this.dropNode)}else if(Array.isArray(this.dropNode)){this.dropNode.forEach((function(e){if(e instanceof HTMLElement){t.setDropEventListener(e)}}))}}},{key:"setDropEventListener",value:function e(t){var n=this;t.addEventListener("drop",(function(e){e.preventDefault();e.stopPropagation();Array.from(e.dataTransfer.files).forEach((function(e){n.emitSelectedFile(e)}))}),false)}},{key:"emitSelectedFile",value:function e(t){var n=this;var i={file:t};this.getPreview(t).then((function(e){if(e){i["previewData"]=e.blob;i["previewDataWidth"]=e.width;i["previewDataHeight"]=e.height;if(n.fileMaxWidth||n.fileMaxHeight){var t=n.fileMaxWidth===null?false:n.fileMaxWidth<i["previewDataWidth"];var r=n.fileMaxHeight===null?false:n.fileMaxHeight<i["previewDataHeight"];if(t||r){var s={maxWidth:n.fileMaxWidth,maxHeight:n.fileMaxHeight,fileWidth:i["previewDataWidth"],fileHeight:i["previewDataHeight"]};n.emit("onFileMaxResolutionExceeded",s);return false}}}n.emit("onSelectFile",i)}))["catch"]((function(e){console.warn("Couldn't get preview for file ".concat(t.name,". Error: ").concat(e));n.emit("onSelectFile",i)}))}},{key:"getImageDimensions",value:function e(t){return new Promise((function(e,n){if(!t){n("getImageDimensions: fileBlob can't be empty")}var i=new Image;i.onload=function(){e({blob:t,width:i.width,height:i.height})};i.onerror=function(){n()};i.src=URL.createObjectURL(t)}))}}],[{key:"getVideoPreviewBlob",value:function e(t){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;return new Promise((function(e,i){var r=document.createElement("video");r.setAttribute("src",URL.createObjectURL(t));r.load();r.addEventListener("error",(function(e){i("Error while loading video file",e)}));r.addEventListener("loadedmetadata",(function(){if(r.duration<n){n=0}r.currentTime=n;r.addEventListener("seeked",(function(){var t=document.createElement("canvas");t.width=r.videoWidth;t.height=r.videoHeight;var n=t.getContext("2d");n.drawImage(r,0,0,t.width,t.height);n.canvas.toBlob((function(t){return e(t)}),"image/jpeg",1)}))}))}))}}]);return t}(t.EventEmitter);babelHelpers.defineProperty(r,"STATUSES",{PENDING:0,PROGRESS:1,DONE:2,CANCELLED:3,FAILED:4});babelHelpers.defineProperty(r,"BOX_MIN_CHUNK_SIZE",1024*1024);babelHelpers.defineProperty(r,"CLOUD_MIN_CHUNK_SIZE",1024*1024*5);babelHelpers.defineProperty(r,"CLOUD_MAX_CHUNK_SIZE",1024*1024*100);e.Uploader=r})(this.BX.Messenger.Lib=this.BX.Messenger.Lib||{},BX.Event,BX);this.BX=this.BX||{};this.BX.Messenger=this.BX.Messenger||{};(function(e){"use strict";var t=function(){function e(){babelHelpers.classCallCheck(this,e)}babelHelpers.createClass(e,null,[{key:"copy",value:function t(){var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"";var i=e.getStore();if(n){i.focus();i.value=n;i.selectionStart=0;document.execCommand("copy")}else{document.execCommand("copy");i.focus();document.execCommand("paste");n=i.value}e.removeStore();return n}},{key:"getStore",value:function t(){if(e.store){return e.store}e.store=document.createElement("textarea");e.store.style="position: absolute; opacity: 0; top: -1000px; left: -1000px;";document.body.insertBefore(e.store,document.body.firstChild);return e.store}},{key:"removeStore",value:function t(){if(!e.store){return true}document.body.removeChild(e.store);e.store=null;return true}}]);return e}();t.store=null;e.Clipboard=t})(this.BX.Messenger.Lib=this.BX.Messenger.Lib||{});this.BX=this.BX||{};(function(e,t,n,i,r,s,o,a,l){"use strict";var u=function(){function e(t){babelHelpers.classCallCheck(this,e);babelHelpers.defineProperty(this,"messagesToSend",[]);babelHelpers.defineProperty(this,"store",null);babelHelpers.defineProperty(this,"restClient",null);babelHelpers.defineProperty(this,"loc",null);this.controller=t.Data.get("controller");this.store=this.controller.store;this.restClient=t.RestClient.get();this.loc=t.Loc.messages;this.onSendMessageHandler=this.onSendMessage.bind(this);this.onClickOnMessageRetryHandler=this.onClickOnMessageRetry.bind(this);this.onClickOnCommandHandler=this.onClickOnCommand.bind(this);this.onClickOnKeyboardHandler=this.onClickOnKeyboard.bind(this);o.EventEmitter.subscribe(a.EventType.textarea.sendMessage,this.onSendMessageHandler);o.EventEmitter.subscribe(a.EventType.dialog.clickOnMessageRetry,this.onClickOnMessageRetryHandler);o.EventEmitter.subscribe(a.EventType.dialog.clickOnCommand,this.onClickOnCommandHandler);o.EventEmitter.subscribe(a.EventType.dialog.clickOnKeyboardButton,this.onClickOnKeyboardHandler)}babelHelpers.createClass(e,[{key:"onSendMessage",value:function e(t){var n=t.data;if(!n.text&&!n.file){return false}this.sendMessage(n.text,n.file)}},{key:"sendMessage",value:function e(){var t=this;var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"";var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;if(!n&&!i){return false}var r=this.store.getters["dialogues/getQuoteId"](this.getDialogId());if(r){var s=this.store.getters["messages/getMessage"](this.getChatId(),r);if(s){n=this.getMessageTextWithQuote(s,n);o.EventEmitter.emit(a.EventType.dialog.quotePanelClose)}}if(!this.controller.application.isUnreadMessagesLoaded()){this.sendMessageToServer({id:0,chatId:this.getChatId(),dialogId:this.getDialogId(),text:n,file:i});this.processQueue();return true}var l={};if(i){l.FILE_ID=[i.id]}this.addMessageToModel({text:n,params:l,sending:!i}).then((function(e){o.EventEmitter.emit(a.EventType.dialog.scrollToBottom,{chatId:t.getChatId(),cancelIfScrollChange:true});t.addMessageToQueue({messageId:e,text:n,file:i});t.processQueue()}))}},{key:"processQueue",value:function e(){var t=this;this.messagesToSend.filter((function(e){return!e.sending})).forEach((function(e){t.deleteFromQueue(e.id);e.sending=true;if(e.file){o.EventEmitter.emit(a.EventType.textarea.stopWriting);o.EventEmitter.emit(a.EventType.uploader.addMessageWithFile,e)}else{t.sendMessageToServer(e)}}))}},{key:"addMessageToModel",value:function e(t){var n=t.text,i=t.params,r=t.sending;return this.store.dispatch("messages/add",{chatId:this.getChatId(),authorId:this.getUserId(),text:n,params:i,sending:r})}},{key:"addMessageToQueue",value:function e(t){var n=t.messageId,i=t.text,r=t.file;this.messagesToSend.push({id:n,chatId:this.getChatId(),dialogId:this.getDialogId(),text:i,file:r,sending:false})}},{key:"sendMessageToServer",value:function e(t){var n=this;o.EventEmitter.emit(a.EventType.textarea.stopWriting);this.restClient.callMethod(a.RestMethod.imMessageAdd,{TEMPLATE_ID:t.id,DIALOG_ID:t.dialogId,MESSAGE:t.text},null,null).then((function(e){n.controller.executeRestAnswer(a.RestMethodHandler.imMessageAdd,e,t)}))["catch"]((function(e){n.controller.executeRestAnswer(a.RestMethodHandler.imMessageAdd,e,t);l.Logger.warn("SendMessageHandler: error during adding message",e)}))}},{key:"onClickOnMessageRetry",value:function e(t){var n=t.data;this.retrySendMessage(n.message)}},{key:"retrySendMessage",value:function e(t){this.addMessageToQueue({messageId:t.id,text:t.text,file:null});this.setSendingMessageFlag(t.id);this.processQueue()}},{key:"setSendingMessageFlag",value:function e(t){this.store.dispatch("messages/actionStart",{id:t,chatId:this.getChatId()})}},{key:"deleteFromQueue",value:function e(t){this.messagesToSend=this.messagesToSend.filter((function(e){return e.id!==t}))}},{key:"onClickOnCommand",value:function e(t){var n=t.data;if(n.type==="put"){this.handlePutAction(n.value)}else if(n.type==="send"){this.handleSendAction(n.value)}else{l.Logger.warn("SendMessageHandler: Unprocessed command",n)}}},{key:"onClickOnKeyboard",value:function e(t){var n=t.data;if(n.action==="ACTION"){var i=n.params,r=i.action,s=i.value;this.handleKeyboardAction(r,s)}if(n.action==="COMMAND"){var o=n.params,l=o.dialogId,u=o.messageId,c=o.botId,f=o.command,d=o.params;this.restClient.callMethod(a.RestMethod.imMessageCommand,{MESSAGE_ID:u,DIALOG_ID:l,BOT_ID:c,COMMAND:f,COMMAND_PARAMS:d})["catch"]((function(e){return console.error("SendMessageHandler: command processing error",e)}))}}},{key:"handleKeyboardAction",value:function e(n,i){switch(n){case"SEND":{this.handleSendAction(i);break}case"PUT":{this.handlePutAction(i);break}case"CALL":{break}case"COPY":{t.Clipboard.copy(i);BX.UI.Notification.Center.notify({content:this.loc["IM_DIALOG_CLIPBOARD_COPY_SUCCESS"],autoHideDelay:4e3});break}case"DIALOG":{break}default:{console.error("SendMessageHandler: unknown keyboard action")}}}},{key:"handlePutAction",value:function e(t){o.EventEmitter.emit(a.EventType.textarea.insertText,{text:"".concat(t," ")})}},{key:"handleSendAction",value:function e(t){var n=this;this.sendMessage(t);setTimeout((function(){o.EventEmitter.emit(a.EventType.dialog.scrollToBottom,{chatId:n.getChatId(),duration:300,cancelIfScrollChange:false})}),300)}},{key:"getMessageTextWithQuote",value:function e(t,n){var i=null;if(t.authorId){i=this.store.getters["users/get"](t.authorId)}var s=this.store.getters["files/getList"](this.getChatId());var o="-".repeat(54);var a=i&&i.name?i.name:this.loc["IM_QUOTE_PANEL_DEFAULT_TITLE"];var l=r.Utils.date.format(t.date,null,this.loc);var u=r.Utils.text.quote(t.text,t.params,s,this.loc);var c=[];c.push(o);c.push("".concat(a," [").concat(l,"]"));c.push(u);c.push(o);c.push(n);return c.join("\n")}},{key:"getChatId",value:function e(){return this.store.state.application.dialog.chatId}},{key:"getDialogId",value:function e(){return this.store.state.application.dialog.dialogId}},{key:"getUserId",value:function e(){return this.store.state.application.common.userId}},{key:"destroy",value:function e(){o.EventEmitter.unsubscribe(a.EventType.textarea.sendMessage,this.onSendMessageHandler);o.EventEmitter.unsubscribe(a.EventType.dialog.clickOnMessageRetry,this.onClickOnMessageRetryHandler);o.EventEmitter.unsubscribe(a.EventType.dialog.clickOnCommand,this.onClickOnCommandHandler);o.EventEmitter.unsubscribe(a.EventType.dialog.clickOnKeyboardButton,this.onClickOnKeyboardHandler)}}]);return e}();var c=function(){function e(t){babelHelpers.classCallCheck(this,e);babelHelpers.defineProperty(this,"messagesToRead",{});babelHelpers.defineProperty(this,"timer",null);babelHelpers.defineProperty(this,"store",null);babelHelpers.defineProperty(this,"restClient",null);this.store=t.Data.get("controller").store;this.restClient=t.RestClient.get();this.timer=new n.Timer;this.onReadMessageHandler=this.onReadMessage.bind(this);o.EventEmitter.subscribe(a.EventType.dialog.readMessage,this.onReadMessageHandler)}babelHelpers.createClass(e,[{key:"onReadMessage",value:function e(t){var n=t.data,i=n.id,r=i===void 0?null:i,s=n.skipTimer,o=s===void 0?false:s,a=n.skipAjax,l=a===void 0?false:a;return this.readMessage(r,o,l)}},{key:"readMessage",value:function e(t){var n=this;var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;var s=this.getChatId();if(t){if(!this.messagesToRead[s]){this.messagesToRead[s]=[]}this.messagesToRead[s].push(Number.parseInt(t,10))}this.timer.stop("readMessage",s,true);this.timer.stop("readMessageServer",s,true);if(i){return this.processMessagesToRead(s,r)}return new Promise((function(e,t){n.timer.start("readMessage",s,.1,(function(){n.processMessagesToRead(s,r).then((function(t){return e(t)}))["catch"](t)}))}))}},{key:"processMessagesToRead",value:function e(t){var n=this;var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var r=this.getMaxMessageIdFromQueue(t);delete this.messagesToRead[t];if(r<=0){return Promise.resolve()}return new Promise((function(e,s){n.readMessageOnClient(t,r).then((function(e){return n.decreaseChatCounter(t,e.count)})).then((function(){if(i){return e({chatId:t,lastId:r})}n.timer.start("readMessageServer",t,.5,(function(){n.readMessageOnServer(t,r).then((function(){e({chatId:t,lastId:r})}))["catch"](s)}))}))["catch"]((function(e){l.Logger.error("Reading messages error",e);s()}))}))}},{key:"getMaxMessageIdFromQueue",value:function e(t){var n=0;if(!this.messagesToRead[t]){return n}this.messagesToRead[t].forEach((function(e){if(n<e){n=e}}));return n}},{key:"readMessageOnClient",value:function e(t,n){return this.store.dispatch("messages/readMessages",{chatId:t,readId:n})}},{key:"readMessageOnServer",value:function e(t,n){return this.restClient.callMethod(a.RestMethod.imDialogRead,{DIALOG_ID:this.getDialogIdByChatId(t),MESSAGE_ID:n})}},{key:"decreaseChatCounter",value:function e(t,n){return this.store.dispatch("dialogues/decreaseCounter",{dialogId:this.getDialogIdByChatId(t),count:n})}},{key:"getChatId",value:function e(){return this.store.state.application.dialog.chatId}},{key:"getDialogIdByChatId",value:function e(t){var n=this.store.getters["dialogues/getByChatId"](t);if(!n){return 0}return n.dialogId}},{key:"getDialogId",value:function e(){return this.store.state.application.dialog.dialogId}},{key:"destroy",value:function e(){o.EventEmitter.unsubscribe(a.EventType.dialog.readMessage,this.onReadMessageHandler)}}]);return e}();var f=function(){function e(t){babelHelpers.classCallCheck(this,e);this.store=t.Data.get("controller").store;this.restClient=t.RestClient.get();this.onSetMessageReactionHandler=this.onSetMessageReaction.bind(this);this.onOpenMessageReactionListHandler=this.onOpenMessageReactionList.bind(this);o.EventEmitter.subscribe(a.EventType.dialog.setMessageReaction,this.onSetMessageReactionHandler);o.EventEmitter.subscribe(a.EventType.dialog.openMessageReactionList,this.onOpenMessageReactionListHandler)}babelHelpers.createClass(e,[{key:"onSetMessageReaction",value:function e(t){var n=t.data;this.reactToMessage(n.message.id,n.reaction)}},{key:"onOpenMessageReactionList",value:function e(t){var n=t.data;this.openMessageReactionList(n.message.id,n.values)}},{key:"reactToMessage",value:function t(n,i){var r=i.action||e.actions.auto;if(r!==e.actions.auto){r=r===e.actions.set?e.actions.plus:e.actions.minus}this.restClient.callMethod(a.RestMethod.imMessageLike,{MESSAGE_ID:n,ACTION:r})}},{key:"openMessageReactionList",value:function e(t,n){l.Logger.warn("Message reaction list not implemented yet!",t,n)}},{key:"destroy",value:function e(){o.EventEmitter.unsubscribe(a.EventType.dialog.setMessageReaction,this.onSetMessageReactionHandler);o.EventEmitter.unsubscribe(a.EventType.dialog.openMessageReactionList,this.onOpenMessageReactionListHandler)}}]);return e}();babelHelpers.defineProperty(f,"types",{none:"none",like:"like",kiss:"kiss",laugh:"laugh",wonder:"wonder",cry:"cry",angry:"angry"});babelHelpers.defineProperty(f,"actions",{auto:"auto",plus:"plus",minus:"minus",set:"set"});var d=function(){function e(t){babelHelpers.classCallCheck(this,e);this.store=t.Data.get("controller").store;this.onQuoteMessageHandler=this.onQuoteMessage.bind(this);this.onQuotePanelCloseHandler=this.onQuotePanelClose.bind(this);o.EventEmitter.subscribe(a.EventType.dialog.quoteMessage,this.onQuoteMessageHandler);o.EventEmitter.subscribe(a.EventType.dialog.quotePanelClose,this.onQuotePanelCloseHandler)}babelHelpers.createClass(e,[{key:"onQuoteMessage",value:function e(t){var n=t.data;this.quoteMessage(n.message.id)}},{key:"onQuotePanelClose",value:function e(){this.clearQuote()}},{key:"quoteMessage",value:function e(t){this.store.dispatch("dialogues/update",{dialogId:this.getDialogId(),fields:{quoteId:t}})}},{key:"clearQuote",value:function e(){this.store.dispatch("dialogues/update",{dialogId:this.getDialogId(),fields:{quoteId:0}})}},{key:"getDialogId",value:function e(){return this.store.state.application.dialog.dialogId}},{key:"destroy",value:function e(){o.EventEmitter.unsubscribe(a.EventType.dialog.quoteMessage,this.onQuoteMessageHandler);o.EventEmitter.unsubscribe(a.EventType.dialog.quotePanelClose,this.onQuotePanelCloseHandler)}}]);return e}();var h=function(){function e(t){babelHelpers.classCallCheck(this,e);babelHelpers.defineProperty(this,"store",null);babelHelpers.defineProperty(this,"restClient",null);babelHelpers.defineProperty(this,"timer",null);this.store=t.Data.get("controller").store;this.restClient=t.RestClient.get();this.timer=new n.Timer;this.subscribeToEvents()}babelHelpers.createClass(e,[{key:"subscribeToEvents",value:function e(){this.onStartWritingHandler=this.onStartWriting.bind(this);this.onStopWritingHandler=this.onStopWriting.bind(this);this.onAppButtonClickHandler=this.onAppButtonClick.bind(this);this.onFocusHandler=this.onFocus.bind(this);this.onBlurHandler=this.onBlur.bind(this);this.onKeyUpHandler=this.onKeyUp.bind(this);this.onEditHandler=this.onEdit.bind(this);o.EventEmitter.subscribe(a.EventType.textarea.startWriting,this.onStartWritingHandler);o.EventEmitter.subscribe(a.EventType.textarea.stopWriting,this.onStopWritingHandler);o.EventEmitter.subscribe(a.EventType.textarea.appButtonClick,this.onAppButtonClickHandler);o.EventEmitter.subscribe(a.EventType.textarea.focus,this.onFocusHandler);o.EventEmitter.subscribe(a.EventType.textarea.blur,this.onBlurHandler);o.EventEmitter.subscribe(a.EventType.textarea.keyUp,this.onKeyUpHandler);o.EventEmitter.subscribe(a.EventType.textarea.edit,this.onEditHandler)}},{key:"onStartWriting",value:function e(){this.startWriting()}},{key:"onStopWriting",value:function e(){this.stopWriting()}},{key:"onAppButtonClick",value:function e(){}},{key:"onFocus",value:function e(){}},{key:"onBlur",value:function e(){}},{key:"onKeyUp",value:function e(){}},{key:"onEdit",value:function e(){}},{key:"startWriting",value:function e(){var t=this;var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.getDialogId();if(r.Utils.dialog.isEmptyDialogId(n)||this.timer.has("writes",n)){return false}this.timer.start("writes",n,28);this.timer.start("writesSend",n,5,(function(){t.restClient.callMethod(a.RestMethod.imDialogWriting,{DIALOG_ID:n})["catch"]((function(){t.timer.stop("writes",n)}))}))}},{key:"stopWriting",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.getDialogId();this.timer.stop("writes",t,true);this.timer.stop("writesSend",t,true)}},{key:"getChatId",value:function e(){return this.store.state.application.dialog.chatId}},{key:"getDialogId",value:function e(){return this.store.state.application.dialog.dialogId}},{key:"getUserId",value:function e(){return this.store.state.application.common.userId}},{key:"getDiskFolderId",value:function e(){return this.store.state.application.dialog.diskFolderId}},{key:"destroy",value:function e(){o.EventEmitter.unsubscribe(a.EventType.textarea.startWriting,this.onStartWritingHandler);o.EventEmitter.unsubscribe(a.EventType.textarea.stopWriting,this.onStopWritingHandler);o.EventEmitter.unsubscribe(a.EventType.textarea.appButtonClick,this.onAppButtonClickHandler);o.EventEmitter.unsubscribe(a.EventType.textarea.focus,this.onFocusHandler);o.EventEmitter.unsubscribe(a.EventType.textarea.blur,this.onBlurHandler);o.EventEmitter.unsubscribe(a.EventType.textarea.keyUp,this.onKeyUpHandler);o.EventEmitter.unsubscribe(a.EventType.textarea.edit,this.onEditHandler)}}]);return e}();var p=function(){function e(t){babelHelpers.classCallCheck(this,e);babelHelpers.defineProperty(this,"controller",null);babelHelpers.defineProperty(this,"restClient",null);babelHelpers.defineProperty(this,"uploader",null);babelHelpers.defineProperty(this,"isRequestingDiskFolderId",false);this.controller=t.Data.get("controller");this.restClient=t.RestClient.get();this.initUploader();this.onTextareaFileSelectedHandler=this.onTextareaFileSelected.bind(this);this.addMessageWithFileHandler=this.addMessageWithFile.bind(this);this.onClickOnUploadCancelHandler=this.onClickOnUploadCancel.bind(this);o.EventEmitter.subscribe(a.EventType.textarea.fileSelected,this.onTextareaFileSelectedHandler);o.EventEmitter.subscribe(a.EventType.uploader.addMessageWithFile,this.addMessageWithFileHandler);o.EventEmitter.subscribe(a.EventType.dialog.clickOnUploadCancel,this.onClickOnUploadCancelHandler)}babelHelpers.createClass(e,[{key:"initUploader",value:function e(){this.uploader=new i.Uploader({generatePreview:true,sender:this.getUploaderSenderOptions()});this.uploader.subscribe("onStartUpload",this.onStartUploadHandler.bind(this));this.uploader.subscribe("onProgress",this.onProgressHandler.bind(this));this.uploader.subscribe("onSelectFile",this.onSelectFileHandler.bind(this));this.uploader.subscribe("onComplete",this.onCompleteHandler.bind(this));this.uploader.subscribe("onUploadFileError",this.onUploadFileErrorHandler.bind(this));this.uploader.subscribe("onCreateFileError",this.onCreateFileErrorHandler.bind(this))}},{key:"commitFile",value:function e(t,n){var i=this;this.restClient.callMethod(a.RestMethod.imDiskFileCommit,{chat_id:t.chatId,upload_id:t.uploadId,message:t.messageText,template_id:t.messageId,file_template_id:t.fileId},null,null).then((function(e){i.controller.executeRestAnswer(a.RestMethodHandler.imDiskFileCommit,e,n)}))["catch"]((function(e){i.controller.executeRestAnswer(a.RestMethodHandler.imDiskFileCommit,e,n)}));return true}},{key:"setUploadError",value:function e(t,n){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;this.controller.store.dispatch("files/update",{chatId:t,id:n,fields:{status:a.FileStatus.error,progress:0}});if(i){this.controller.store.dispatch("messages/actionError",{chatId:t,id:i,retry:false})}}},{key:"onTextareaFileSelected",value:function e(t){var n=t.data;var i=n&&n.fileChangeEvent&&n.fileChangeEvent.target.files.length>0?n.fileChangeEvent:"";if(!i){return false}this.uploadFile(i)}},{key:"addMessageWithFile",value:function e(t){var n=this;var i=t.getData();if(!this.getDiskFolderId()){this.requestDiskFolderId(i.chatId).then((function(){n.addMessageWithFile(t)}))["catch"]((function(e){l.Logger.error("addMessageWithFile error",e);return false}));return false}this.uploader.addTask({taskId:i.file.id,fileData:i.file.source.file,fileName:i.file.source.file.name,generateUniqueName:true,diskFolderId:this.getDiskFolderId(),previewBlob:i.file.previewBlob})}},{key:"uploadFile",value:function e(t){if(!t){return false}this.uploader.addFilesFromEvent(t)}},{key:"destroy",value:function e(){if(this.uploader){this.uploader.unsubscribeAll()}o.EventEmitter.unsubscribe(a.EventType.textarea.fileSelected,this.onTextareaFileSelectedHandler);o.EventEmitter.unsubscribe(a.EventType.uploader.addMessageWithFile,this.addMessageWithFileHandler);o.EventEmitter.unsubscribe(a.EventType.dialog.clickOnUploadCancel,this.onClickOnUploadCancelHandler)}},{key:"getChatId",value:function e(){return this.controller.store.state.application.dialog.chatId}},{key:"getDialogId",value:function e(){return this.controller.store.state.application.dialog.dialogId}},{key:"getDiskFolderId",value:function e(){return this.controller.store.state.application.dialog.diskFolderId}},{key:"getCurrentUser",value:function e(){return this.controller.store.getters["users/get"](this.controller.store.state.application.common.userId,true)}},{key:"getMessageByFileId",value:function e(t,n){var i=this.controller.store.getters["messages/get"](this.getChatId());var r=i.find((function(e){var n;if(s.Type.isArray((n=e.params)===null||n===void 0?void 0:n.FILE_ID)){return e.params.FILE_ID.includes(t)}return false}));if(!r){return}return{id:r.id,chatId:r.chatId,dialogId:this.getDialogId(),text:r.text,file:{id:t,source:n,previewBlob:n.previewData},sending:true}}},{key:"requestDiskFolderId",value:function e(t){var n=this;return new Promise((function(e,i){if(n.isRequestingDiskFolderId||n.getDiskFolderId()){n.isRequestingDiskFolderId=false;e();return}n.isRequestingDiskFolderId=true;n.restClient.callMethod(a.RestMethod.imDiskFolderGet,{chat_id:t}).then((function(t){n.isRequestingDiskFolderId=false;n.controller.executeRestAnswer(a.RestMethodHandler.imDiskFolderGet,t);e()}))["catch"]((function(e){n.isRequestingDiskFolderId=false;n.controller.executeRestAnswer(a.RestMethodHandler.imDiskFolderGet,e);i(e)}))}))}},{key:"onStartUploadHandler",value:function e(t){var n=t.getData();l.Logger.log("Uploader: onStartUpload",n);this.controller.store.dispatch("files/update",{chatId:this.getChatId(),id:n.id,fields:{status:a.FileStatus.upload,progress:0}})}},{key:"onProgressHandler",value:function e(t){var n=t.getData();l.Logger.log("Uploader: onProgress",n);this.controller.store.dispatch("files/update",{chatId:this.getChatId(),id:n.id,fields:{status:a.FileStatus.upload,progress:n.progress===100?99:n.progress}})}},{key:"onSelectFileHandler",value:function e(t){var n=t.getData();var i=n.file;l.Logger.log("Uploader: onSelectFile",n);var r="file";if(i.type.toString().startsWith("image")){r="image"}else if(i.type.toString().startsWith("video")){r="video"}this.controller.store.dispatch("files/add",{chatId:this.getChatId(),authorId:this.getCurrentUser().id,name:i.name,type:r,extension:i.name.split(".").splice(-1)[0],size:i.size,image:!n.previewData?false:{width:n.previewDataWidth,height:n.previewDataHeight},status:a.FileStatus.progress,progress:0,authorName:this.getCurrentUser().name,urlPreview:n.previewData?URL.createObjectURL(n.previewData):""}).then((function(e){o.EventEmitter.emit(a.EventType.textarea.sendMessage,{text:"",file:{id:e,source:n,previewBlob:n.previewData}})}))}},{key:"onCompleteHandler",value:function e(t){var n=t.getData();l.Logger.log("Uploader: onComplete",n);this.controller.store.dispatch("files/update",{chatId:this.getChatId(),id:n.id,fields:{status:a.FileStatus.wait,progress:100}});var i=this.getMessageByFileId(n.id,n);var r=this.controller.store.getters["files/get"](this.getChatId(),i.file.id,true).type;this.commitFile({chatId:this.getChatId(),uploadId:n.result.data.file.id,messageText:i.text,messageId:i.id,fileId:i.file.id,fileType:r},i)}},{key:"onUploadFileErrorHandler",value:function e(t){var n=t.getData();l.Logger.log("Uploader: onUploadFileError",n);var i=this.getMessageByFileId(n.id,n);if(i){this.setUploadError(this.getChatId(),i.file.id,i.id)}}},{key:"onCreateFileErrorHandler",value:function e(t){var n=t.getData();l.Logger.log("Uploader: onCreateFileError",n);var i=this.getMessageByFileId(n.id,n);if(i){this.setUploadError(this.getChatId(),i.file.id,i.id)}}},{key:"onClickOnUploadCancel",value:function e(t){var n=this;var i=t.data;var r=i.file.id;var s=i.file;var o=this.getMessageByFileId(r,s);if(!o){return}this.uploader.deleteTask(r);this.controller.store.dispatch("messages/delete",{chatId:this.getChatId(),id:o.id}).then((function(){n.controller.store.dispatch("files/delete",{chatId:n.getChatId(),id:o.file.id})}))}},{key:"getActionCommitFile",value:function e(){return null}},{key:"getActionUploadChunk",value:function e(){return null}},{key:"getUploaderSenderOptions",value:function e(){return{actionUploadChunk:this.getActionUploadChunk(),actionCommitFile:this.getActionCommitFile()}}}]);return e}();var m=function(e){babelHelpers.inherits(t,e);function t(e){var n;babelHelpers.classCallCheck(this,t);n=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this));babelHelpers.defineProperty(babelHelpers.assertThisInitialized(n),"isDragging",false);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(n),"minimumHeight",120);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(n),"maximumHeight",400);n.setEventNamespace("BX.IM.TextareaDragHandler");n.subscribeToEvents(e);if(r.Utils.device.isMobile()){n.maximumHeight=200}return n}babelHelpers.createClass(t,[{key:"subscribeToEvents",value:function e(t){var n=this;var i=s.Type.isObject(t)?t:{};Object.entries(i).forEach((function(e){var t=babelHelpers.slicedToArray(e,2),i=t[0],r=t[1];if(s.Type.isFunction(r)){n.subscribe(i,r)}}))}},{key:"onStartDrag",value:function e(t,n){if(this.isDragging){return}this.isDragging=true;t=t.changedTouches?t.changedTouches[0]:t;this.textareaDragCursorStartPoint=t.clientY;this.textareaDragHeightStartPoint=n;this.addTextareaDragEvents()}},{key:"onTextareaContinueDrag",value:function e(n){if(!this.isDragging){return}n=n.changedTouches?n.changedTouches[0]:n;this.textareaDragCursorControlPoint=n.clientY;var i=Math.min(this.textareaDragHeightStartPoint+this.textareaDragCursorStartPoint-this.textareaDragCursorControlPoint,this.maximumHeight);var r=Math.max(i,this.minimumHeight);this.emit(t.events.onHeightChange,{newHeight:r})}},{key:"onTextareaStopDrag",value:function e(){if(!this.isDragging){return}this.isDragging=false;this.removeTextareaDragEvents();this.emit(t.events.onStopDrag)}},{key:"addTextareaDragEvents",value:function e(){this.onContinueDragHandler=this.onTextareaContinueDrag.bind(this);this.onStopDragHandler=this.onTextareaStopDrag.bind(this);document.addEventListener("mousemove",this.onContinueDragHandler);document.addEventListener("touchmove",this.onContinueDragHandler);document.addEventListener("touchend",this.onStopDragHandler);document.addEventListener("mouseup",this.onStopDragHandler);document.addEventListener("mouseleave",this.onStopDragHandler)}},{key:"removeTextareaDragEvents",value:function e(){document.removeEventListener("mousemove",this.onContinueDragHandler);document.removeEventListener("touchmove",this.onContinueDragHandler);document.removeEventListener("touchend",this.onStopDragHandler);document.removeEventListener("mouseup",this.onStopDragHandler);document.removeEventListener("mouseleave",this.onStopDragHandler)}},{key:"destroy",value:function e(){this.removeTextareaDragEvents()}}]);return t}(o.EventEmitter);babelHelpers.defineProperty(m,"events",{onHeightChange:"onHeightChange",onStopDrag:"onStopDrag"});var g=function(){function e(t){babelHelpers.classCallCheck(this,e);babelHelpers.defineProperty(this,"restClient",null);this.restClient=t.RestClient.get();this.subscribeToEvents()}babelHelpers.createClass(e,[{key:"subscribeToEvents",value:function e(){this.clickOnMentionHandler=this.onClickOnMention.bind(this);this.clickOnUserNameHandler=this.onClickOnUserName.bind(this);this.clickOnMessageMenuHandler=this.onClickOnMessageMenu.bind(this);this.clickOnReadListHandler=this.onClickOnReadList.bind(this);this.clickOnChatTeaserHandler=this.onClickOnChatTeaser.bind(this);this.clickOnDialogHandler=this.onClickOnDialog.bind(this);o.EventEmitter.subscribe(a.EventType.dialog.clickOnMention,this.clickOnMentionHandler);o.EventEmitter.subscribe(a.EventType.dialog.clickOnUserName,this.clickOnUserNameHandler);o.EventEmitter.subscribe(a.EventType.dialog.clickOnMessageMenu,this.clickOnMessageMenuHandler);o.EventEmitter.subscribe(a.EventType.dialog.clickOnReadList,this.clickOnReadListHandler);o.EventEmitter.subscribe(a.EventType.dialog.clickOnChatTeaser,this.clickOnChatTeaserHandler);o.EventEmitter.subscribe(a.EventType.dialog.clickOnDialog,this.clickOnDialogHandler)}},{key:"onClickOnMention",value:function e(t){var n=t.data;if(n.type==="USER"){l.Logger.warn("DialogActionHandler: open user profile",n)}else if(n.type==="CHAT"){l.Logger.warn("DialogActionHandler: open dialog from mention click",n)}else if(n.type==="CALL"){l.Logger.warn("DialogActionHandler: open phone menu",n)}}},{key:"onClickOnUserName",value:function e(t){var n=t.data;o.EventEmitter.emit(a.EventType.textarea.insertText,{text:"".concat(n.user.name,", ")})}},{key:"onClickOnMessageMenu",value:function e(t){var n=t.data;l.Logger.warn("DialogActionHandler: open message menu",n)}},{key:"onClickOnReadList",value:function e(t){var n=t.data;l.Logger.warn("DialogActionHandler: open read list",n)}},{key:"onClickOnChatTeaser",value:function e(t){var n=t.data;this.joinParentChat(n.message.id,"chat".concat(n.message.params.CHAT_ID)).then((function(e){l.Logger.warn("DialogActionHandler: open dialog from teaser click",e)}))["catch"]((function(e){console.error("DialogActionHandler: error joining parent chat",e)}))}},{key:"onClickOnDialog",value:function e(){l.Logger.warn("DialogActionHandler: click on dialog")}},{key:"joinParentChat",value:function e(t,n){var i=this;return new Promise((function(e,r){if(!t||!n){return r()}if(typeof i.tempJoinChat==="undefined"){i.tempJoinChat={}}else if(i.tempJoinChat["wait"]){return r()}i.tempJoinChat["wait"]=true;i.restClient.callMethod(a.RestMethod.imChatParentJoin,{DIALOG_ID:n,MESSAGE_ID:t}).then((function(){i.tempJoinChat["wait"]=false;i.tempJoinChat[n]=true;return e(n)}))["catch"]((function(){i.tempJoinChat["wait"]=false;return r()}))}))}},{key:"unsubscribeEvents",value:function e(){o.EventEmitter.unsubscribe(a.EventType.dialog.clickOnMention,this.clickOnMentionHandler);o.EventEmitter.unsubscribe(a.EventType.dialog.clickOnUserName,this.clickOnUserNameHandler);o.EventEmitter.unsubscribe(a.EventType.dialog.clickOnMessageMenu,this.clickOnMessageMenuHandler);o.EventEmitter.unsubscribe(a.EventType.dialog.clickOnReadList,this.clickOnReadListHandler);o.EventEmitter.unsubscribe(a.EventType.dialog.clickOnChatTeaser,this.clickOnChatTeaserHandler);o.EventEmitter.unsubscribe(a.EventType.dialog.clickOnDialog,this.clickOnDialogHandler)}},{key:"destroy",value:function e(){this.unsubscribeEvents()}}]);return e}();e.TextareaHandler=h;e.TextareaDragHandler=m;e.TextareaUploadHandler=p;e.SendMessageHandler=u;e.ReadingHandler=c;e.ReactionHandler=f;e.QuoteHandler=d;e.DialogActionHandler=g})(this.BX.Messenger=this.BX.Messenger||{},BX.Messenger.Lib,BX.Messenger.Lib,BX.Messenger.Lib,BX.Messenger.Lib,BX,BX.Event,BX.Messenger.Const,BX.Messenger.Lib);(function(e,t,n,i,r,s,o,a,l,u,c,f,d,h,p,m,g,v,y,b,w,S,I,k,C,E,_,x){"use strict";function T(e){var t=[];for(var n in e){if(e.hasOwnProperty(n)){t.push(e[n])}}return t}var O=Object.freeze({none:"none",like:"like",dislike:"dislike"});var M=Object.freeze({russian:"ru",ukraine:"ua",world:"en"});var D=Object.freeze({none:"none",like:"like",smile:"smile",consent:"consent",welcome:"welcome",offline:"offline",history:"history"});var A=Object.freeze({topLeft:1,topMiddle:2,topBottom:3,bottomLeft:6,bottomMiddle:5,bottomRight:4});var P=Object.freeze({1:"top-left",2:"top-center",3:"top-right",6:"bottom-left",5:"bottom-center",4:"bottom-right"});var L=Object.freeze({width:435,height:557});var R=Object.freeze({width:340,height:435});var H=Object.freeze({configLoaded:"configLoaded",widgetOpen:"widgetOpen",widgetClose:"widgetClose",sessionStart:"sessionStart",sessionOperatorChange:"sessionOperatorChange",sessionFinish:"sessionFinish",operatorMessage:"operatorMessage",userForm:"userForm",userMessage:"userMessage",userFile:"userFile",userVote:"userVote",every:"every"});var j=T(H);var N=Object.freeze({widgetUserRegister:"imopenlines.widget.user.register",widgetChatCreate:"imopenlines.widget.chat.create",widgetConfigGet:"imopenlines.widget.config.get",widgetDialogGet:"imopenlines.widget.dialog.get",widgetDialogList:"imopenlines.widget.dialog.list",widgetUserGet:"imopenlines.widget.user.get",widgetUserConsentApply:"imopenlines.widget.user.consent.apply",widgetVoteSend:"imopenlines.widget.vote.send",widgetActionSend:"imopenlines.widget.action.send",pullServerTime:"server.time",pullConfigGet:"pull.config.get"});var B=T(N);var F=Object.freeze({guest:"guest"});var U=Object.freeze({new:0,skip:5,answer:10,client:20,clientAfterOperator:25,operator:40,waitClient:50,close:60,spam:65,duplicate:69,silentlyClose:75});var W=Object.freeze({showForm:"IMOL.Widget:showForm",hideForm:"IMOL.Widget:hideForm",processMessagesToSendQueue:"IMOL.Widget:processMessagesToSendQueue",requestData:"IMOL.Widget:requestData",showConsent:"IMOL.Widget:showConsent",acceptConsent:"IMOL.Widget:acceptConsent",consentAccepted:"IMOL.Widget:consentAccepted",declineConsent:"IMOL.Widget:declineConsent",consentDeclined:"IMOL.Widget:consentDeclined",sendDialogVote:"IMOL.Widget:sendDialogVote",createSession:"IMOL.Widget:createSession",openSession:"IMOL.Widget:openSession"});var $=function(e){babelHelpers.inherits(t,e);function t(){babelHelpers.classCallCheck(this,t);return babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).apply(this,arguments))}babelHelpers.createClass(t,[{key:"getName",value:function e(){return"widget"}},{key:"getState",value:function e(){return{common:{configId:0,configName:"",host:this.getVariable("common.host",location.protocol+"//"+location.host),pageMode:this.getVariable("common.pageMode",false),copyright:this.getVariable("common.copyright",true),copyrightUrl:this.getVariable("common.copyrightUrl","https://bitrix24.com"),location:this.getVariable("common.location",A.bottomRight),styles:{backgroundColor:this.getVariable("styles.backgroundColor","#17a3ea"),iconColor:this.getVariable("styles.iconColor","#ffffff")},vote:{enable:false,beforeFinish:true,messageText:this.getVariable("vote.messageText",""),messageLike:this.getVariable("vote.messageLike",""),messageDislike:this.getVariable("vote.messageDislike","")},textMessages:{bxLivechatOnlineLine1:this.getVariable("textMessages.bxLivechatOnlineLine1",""),bxLivechatOnlineLine2:this.getVariable("textMessages.bxLivechatOnlineLine2",""),bxLivechatOffline:this.getVariable("textMessages.bxLivechatOffline",""),bxLivechatTitle:""},online:false,operators:[],connectors:[],showForm:D.none,showed:false,reopen:false,dragged:false,textareaHeight:0,widgetHeight:0,widgetWidth:0,showConsent:false,consentUrl:"",dialogStart:false,watchTyping:false,showSessionId:false,isCreateSessionMode:false,crmFormsSettings:{useWelcomeForm:false,welcomeFormId:0,welcomeFormSec:"",welcomeFormDelay:false,welcomeFormFilled:false,successText:"",errorText:""}},dialog:{sessionId:0,sessionClose:true,sessionStatus:0,userVote:O.none,closeVote:false,userConsent:false,operatorChatId:0,operator:{id:0,name:"",firstName:"",lastName:"",workPosition:"",avatar:"",online:false}},user:{id:-1,hash:"",name:"",firstName:"",lastName:"",avatar:"",email:"",phone:"",www:"",gender:"M",position:""}}}},{key:"getStateSaveException",value:function e(){return{common:{host:null,pageMode:null,copyright:null,copyrightUrl:null,styles:null,dragged:null,showed:null,showConsent:null,showForm:null}}}},{key:"getMutations",value:function e(){var t=this;return{common:function e(n,i){if(typeof i.configId==="number"){n.common.configId=i.configId}if(typeof i.configName==="string"){n.common.configName=i.configName}if(typeof i.online==="boolean"){n.common.online=i.online}if(v.Utils.types.isPlainObject(i.vote)){if(typeof i.vote.enable==="boolean"){n.common.vote.enable=i.vote.enable}if(typeof i.vote.beforeFinish==="boolean"){n.common.vote.beforeFinish=i.vote.beforeFinish}if(typeof i.vote.messageText==="string"){n.common.vote.messageText=i.vote.messageText}if(typeof i.vote.messageLike==="string"){n.common.vote.messageLike=i.vote.messageLike}if(typeof i.vote.messageDislike==="string"){n.common.vote.messageDislike=i.vote.messageDislike}}if(v.Utils.types.isPlainObject(i.textMessages)){if(typeof i.textMessages.bxLivechatOnlineLine1==="string"&&i.textMessages.bxLivechatOnlineLine1!==""){n.common.textMessages.bxLivechatOnlineLine1=i.textMessages.bxLivechatOnlineLine1}if(typeof i.textMessages.bxLivechatOnlineLine2==="string"&&i.textMessages.bxLivechatOnlineLine2!==""){n.common.textMessages.bxLivechatOnlineLine2=i.textMessages.bxLivechatOnlineLine2}if(typeof i.textMessages.bxLivechatOffline==="string"&&i.textMessages.bxLivechatOffline!==""){n.common.textMessages.bxLivechatOffline=i.textMessages.bxLivechatOffline}if(typeof i.textMessages.bxLivechatTitle==="string"&&i.textMessages.bxLivechatTitle!==""){n.common.textMessages.bxLivechatTitle=i.textMessages.bxLivechatTitle}}if(typeof i.dragged==="boolean"){n.common.dragged=i.dragged}if(typeof i.textareaHeight==="number"){n.common.textareaHeight=i.textareaHeight}if(typeof i.widgetHeight==="number"){n.common.widgetHeight=i.widgetHeight}if(typeof i.widgetWidth==="number"){n.common.widgetWidth=i.widgetWidth}if(typeof i.showConsent==="boolean"){n.common.showConsent=i.showConsent}if(typeof i.consentUrl==="string"){n.common.consentUrl=i.consentUrl}if(typeof i.showed==="boolean"){n.common.showed=i.showed;i.reopen=v.Utils.device.isMobile()?false:i.showed}if(typeof i.reopen==="boolean"){n.common.reopen=i.reopen}if(typeof i.copyright==="boolean"){n.common.copyright=i.copyright}if(typeof i.dialogStart==="boolean"){n.common.dialogStart=i.dialogStart}if(typeof i.watchTyping==="boolean"){n.common.watchTyping=i.watchTyping}if(typeof i.showSessionId==="boolean"){n.common.showSessionId=i.showSessionId}if(i.operators instanceof Array){n.common.operators=i.operators}if(i.connectors instanceof Array){n.common.connectors=i.connectors}if(typeof i.showForm==="string"&&typeof D[i.showForm]!=="undefined"){if(i.showForm===D.like&&!!n.dialog.closeVote){i.showForm=D.none}n.common.showForm=i.showForm}if(typeof i.location==="number"&&typeof P[i.location]!=="undefined"){if(n.common.location!==i.location){n.common.widgetHeight=0;n.common.widgetWidth=0;n.common.location=i.location}}if(v.Utils.types.isPlainObject(i.crmFormsSettings)){if(typeof i.crmFormsSettings.useWelcomeForm==="string"){n.common.crmFormsSettings.useWelcomeForm=i.crmFormsSettings.useWelcomeForm==="Y"}if(typeof i.crmFormsSettings.welcomeFormId==="string"){n.common.crmFormsSettings.welcomeFormId=i.crmFormsSettings.welcomeFormId}if(typeof i.crmFormsSettings.welcomeFormSec==="string"){n.common.crmFormsSettings.welcomeFormSec=i.crmFormsSettings.welcomeFormSec}if(typeof i.crmFormsSettings.welcomeFormDelay==="string"){n.common.crmFormsSettings.welcomeFormDelay=i.crmFormsSettings.welcomeFormDelay==="Y"}if(typeof i.crmFormsSettings.successText==="string"&&i.crmFormsSettings.successText!==""){n.common.crmFormsSettings.successText=i.crmFormsSettings.successText}if(typeof i.crmFormsSettings.errorText==="string"&&i.crmFormsSettings.errorText!==""){n.common.crmFormsSettings.errorText=i.crmFormsSettings.errorText}}if(typeof i.isCreateSessionMode==="boolean"){n.common.isCreateSessionMode=i.isCreateSessionMode}if(t.isSaveNeeded({common:i})){t.saveState(n)}},dialog:function e(n,i){if(typeof i.sessionId==="number"){n.dialog.sessionId=i.sessionId}if(typeof i.sessionClose==="boolean"){n.dialog.sessionClose=i.sessionClose}if(typeof i.sessionStatus==="number"){n.dialog.sessionStatus=i.sessionStatus}if(typeof i.userConsent==="boolean"){n.dialog.userConsent=i.userConsent}if(typeof i.userVote==="string"&&typeof i.userVote!=="undefined"){n.dialog.userVote=i.userVote}if(typeof i.closeVote==="boolean"){n.dialog.closeVote=i.closeVote;if(!!i.closeVote&&n.common.showForm===D.like){n.common.showForm=D.none}}if(typeof i.operatorChatId==="number"){n.dialog.operatorChatId=i.operatorChatId}if(v.Utils.types.isPlainObject(i.operator)){if(typeof i.operator.id==="number"){n.dialog.operator.id=i.operator.id}if(typeof i.operator.name==="string"||typeof i.operator.name==="number"){n.dialog.operator.name=i.operator.name.toString()}if(typeof i.operator.lastName==="string"||typeof i.operator.lastName==="number"){n.dialog.operator.lastName=i.operator.lastName.toString()}if(typeof i.operator.firstName==="string"||typeof i.operator.firstName==="number"){n.dialog.operator.firstName=i.operator.firstName.toString()}if(typeof i.operator.workPosition==="string"||typeof i.operator.workPosition==="number"){n.dialog.operator.workPosition=i.operator.workPosition.toString()}if(typeof i.operator.avatar==="string"){if(!i.operator.avatar||i.operator.avatar.startsWith("http")){n.dialog.operator.avatar=i.operator.avatar}else{n.dialog.operator.avatar=n.common.host+i.operator.avatar}}if(typeof i.operator.online==="boolean"){n.dialog.operator.online=i.operator.online}}if(t.isSaveNeeded({dialog:i})){t.saveState(n)}},user:function e(n,i){if(typeof i.id==="number"){n.user.id=i.id}if(typeof i.hash==="string"&&i.hash!==n.user.hash){n.user.hash=i.hash;m.Cookie.set(null,"LIVECHAT_HASH",i.hash,{expires:365*86400,path:"/"})}if(typeof i.name==="string"||typeof i.name==="number"){n.user.name=i.name.toString()}if(typeof i.firstName==="string"||typeof i.firstName==="number"){n.user.firstName=i.firstName.toString()}if(typeof i.lastName==="string"||typeof i.lastName==="number"){n.user.lastName=i.lastName.toString()}if(typeof i.avatar==="string"){n.user.avatar=i.avatar}if(typeof i.email==="string"){n.user.email=i.email}if(typeof i.phone==="string"||typeof i.phone==="number"){n.user.phone=i.phone.toString()}if(typeof i.www==="string"){n.user.www=i.www}if(typeof i.gender==="string"){n.user.gender=i.gender}if(typeof i.position==="string"){n.user.position=i.position}if(t.isSaveNeeded({user:i})){t.saveState(n)}}}}},{key:"getActions",value:function e(){var t=this;return{show:function e(t){var n=t.commit;n("common",{showed:true})},setVoteDateFinish:function e(n,i){var r=n.commit,s=n.dispatch,o=n.state;if(!i){clearTimeout(t.setVoteDateTimeout);r("dialog",{closeVote:false});return true}var a=new Date(i).getTime()-(new Date).getTime();var l=1e4;clearTimeout(t.setVoteDateTimeout);if(i){if(a&&!o.dialog.closeVote){r("dialog",{closeVote:false})}var u=a;if(a>l){u=l}t.setVoteDateTimeout=setTimeout((function e(){u=new Date(i).getTime()-(new Date).getTime();if(u>0){if(u>l){u=l}setTimeout(e,u)}else{r("dialog",{closeVote:true})}}),u)}}}}}]);return t}(E.WidgetVuexBuilderModel);var V=function(){function e(t){babelHelpers.classCallCheck(this,e);this.queryAuthRestore=false;this.setAuthId(F.guest);this.restClient=new u.RestClient({endpoint:t.endpoint,queryParams:this.queryParams,cors:true})}babelHelpers.createClass(e,[{key:"setAuthId",value:function e(t){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"";if(babelHelpers["typeof"](this.queryParams)!=="object"){this.queryParams={}}if(t==F.guest||typeof t==="string"&&t.match(/^[a-f0-9]{32}$/)){this.queryParams.livechat_auth_id=t}else{console.error("%LiveChatRestClient.setAuthId: auth is not correct (%c".concat(t,"%c)"),"color: black;","font-weight: bold; color: red","color: black");return false}if(t==F.guest&&typeof n==="string"&&n.match(/^[a-f0-9]{32}$/)){this.queryParams.livechat_custom_auth_id=n}return true}},{key:"getAuthId",value:function e(){if(babelHelpers["typeof"](this.queryParams)!=="object"){this.queryParams={}}return this.queryParams.livechat_auth_id||null}},{key:"callMethod",value:function e(t,n,i,r){var s=this;var o=arguments.length>4&&arguments[4]!==undefined?arguments[4]:null;if(!o){o=v.Utils.getLogTrackingParams({name:t})}var a=new BX.Promise;this.restClient.callMethod(t,n,null,r,o).then((function(e){s.queryAuthRestore=false;a.fulfill(e)}))["catch"]((function(e){var i=e.error();if(i.ex.error=="LIVECHAT_AUTH_WIDGET_USER"){s.setAuthId(i.ex.hash);if(t===N.widgetUserRegister){console.warn("BX.LiveChatRestClient: ".concat(i.ex.error_description," (").concat(i.ex.error,")"));s.queryAuthRestore=false;a.reject(e);return false}if(!s.queryAuthRestore){console.warn("BX.LiveChatRestClient: your auth-token has expired, send query with a new token");s.queryAuthRestore=true;s.restClient.callMethod(t,n,null,r,o).then((function(e){s.queryAuthRestore=false;a.fulfill(e)}))["catch"]((function(e){s.queryAuthRestore=false;a.reject(e)}));return false}}s.queryAuthRestore=false;a.reject(e)}));return a}},{key:"callBatch",value:function e(t,n,i,r,s){var o=this;var a=function e(a){for(var l in t){if(!t.hasOwnProperty(l)){continue}var u=a[l].error();if(u&&u.ex.error=="LIVECHAT_AUTH_WIDGET_USER"){o.setAuthId(u.ex.hash);if(l===N.widgetUserRegister){console.warn("BX.LiveChatRestClient: ".concat(u.ex.error_description," (").concat(u.ex.error,")"));o.queryAuthRestore=false;n(a);return false}if(!o.queryAuthRestore){console.warn("BX.LiveChatRestClient: your auth-token has expired, send query with a new token");o.queryAuthRestore=true;o.restClient.callBatch(t,n,i,r,s);return false}}}o.queryAuthRestore=false;n(a);return true};return this.restClient.callBatch(t,a,i,r,s)}}]);return e}();var G=function(e){babelHelpers.inherits(t,e);function t(){var e;var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};babelHelpers.classCallCheck(this,t);e=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this,n));e.widget=n.widget;return e}babelHelpers.createClass(t,[{key:"handleImopenlinesWidgetConfigGetSuccess",value:function e(t){this.store.commit("widget/common",{configId:t.configId,configName:t.configName,vote:t.vote,textMessages:t.textMessages,operators:t.operators||[],online:t.online,consentUrl:t.consentUrl,connectors:t.connectors||[],watchTyping:t.watchTyping,showSessionId:t.showSessionId,crmFormsSettings:t.crmFormsSettings});this.store.commit("application/set",{disk:t.disk});this.widget.addLocalize(t.serverVariables);g.LocalStorage.set(this.widget.getSiteId(),0,"serverVariables",t.serverVariables||{})}},{key:"handleImopenlinesWidgetUserRegisterSuccess",value:function e(t){this.widget.restClient.setAuthId(t.hash);var n=[];if(typeof this.store.state.messages.collection[this.controller.application.getChatId()]!=="undefined"){n=this.store.state.messages.collection[this.controller.application.getChatId()]}this.store.commit("messages/initCollection",{chatId:t.chatId,messages:n});this.store.commit("dialogues/initCollection",{dialogId:t.dialogId,fields:{entityType:"LIVECHAT",type:"livechat"}});this.store.commit("application/set",{dialog:{chatId:t.chatId,dialogId:"chat"+t.chatId}})}},{key:"handleImopenlinesWidgetChatCreateSuccess",value:function e(t){this.widget.restClient.setAuthId(t.hash);this.store.commit("messages/initCollection",{chatId:t.chatId,messages:[]});this.store.commit("dialogues/initCollection",{dialogId:t.dialogId,fields:{entityType:"LIVECHAT",type:"livechat"}});this.store.commit("application/set",{dialog:{chatId:t.chatId,dialogId:"chat"+t.chatId}})}},{key:"handleImopenlinesWidgetUserGetSuccess",value:function e(t){this.store.commit("widget/user",{id:t.id,hash:t.hash,name:t.name,firstName:t.firstName,lastName:t.lastName,phone:t.phone,avatar:t.avatar,email:t.email,www:t.www,gender:t.gender,position:t.position});this.store.dispatch("users/set",[{id:t.id,name:t.name,firstName:t.firstName,lastName:t.lastName,avatar:t.avatar,gender:t.gender,workPosition:t.position}]);this.store.commit("application/set",{common:{userId:t.id}})}},{key:"handleImopenlinesWidgetDialogGetSuccess",value:function e(t){this.store.commit("messages/initCollection",{chatId:t.chatId});this.store.commit("widget/dialog",t);this.store.commit("application/set",{dialog:{chatId:t.chatId,dialogId:"chat"+t.chatId,diskFolderId:t.diskFolderId}});this.store.dispatch("widget/setVoteDateFinish",t.dateCloseVote)}},{key:"handleImDialogMessagesGetInitSuccess",value:function e(t){this.handleImDialogMessagesGetSuccess(t)}},{key:"handleImDialogMessagesGetSuccess",value:function e(t){if(t.messages&&t.messages.length>0&&!this.widget.isDialogStart()){this.store.commit("widget/common",{dialogStart:true});this.store.commit("widget/dialog",{userConsent:true})}}},{key:"handleImMessageAddSuccess",value:function e(t,n){this.widget.sendEvent({type:H.userMessage,data:{id:t,text:n.text}})}},{key:"handleImDiskFileCommitSuccess",value:function e(t,n){this.widget.sendEvent({type:H.userFile,data:{}})}}]);return t}(c.BaseRestHandler);var z=function(){babelHelpers.createClass(e,[{key:"getModuleId",value:function e(){return"im"}}],[{key:"create",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};return new this(t)}}]);function e(t){babelHelpers.classCallCheck(this,e);this.controller=t.controller;this.store=t.store;this.widget=t.widget}babelHelpers.createClass(e,[{key:"handleMessageChat",value:function e(t,n,i){if(t.message.senderId!=this.controller.application.getUserId()){this.widget.sendEvent({type:H.operatorMessage,data:t});if(!this.store.state.widget.common.showed&&!this.widget.onceShowed){this.widget.onceShowed=true;this.widget.open()}}}}]);return e}();var X=function(){babelHelpers.createClass(e,null,[{key:"create",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};return new this(t)}}]);function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};babelHelpers.classCallCheck(this,e);this.controller=t.controller;this.store=t.store;this.widget=t.widget}babelHelpers.createClass(e,[{key:"getModuleId",value:function e(){return"imopenlines"}},{key:"handleSessionStart",value:function e(t,n,i){this.store.commit("widget/dialog",{sessionId:t.sessionId,sessionClose:false,sessionStatus:0,userVote:O.none});this.store.dispatch("widget/setVoteDateFinish","");this.widget.sendEvent({type:H.sessionStart,data:{sessionId:t.sessionId}})}},{key:"handleSessionOperatorChange",value:function e(t,n,i){this.store.commit("widget/dialog",{operator:t.operator,operatorChatId:t.operatorChatId});this.widget.sendEvent({type:H.sessionOperatorChange,data:{operator:t.operator}})}},{key:"handleSessionStatus",value:function e(t,n,i){this.store.commit("widget/dialog",{sessionId:t.sessionId,sessionStatus:t.sessionStatus,sessionClose:t.sessionClose});this.widget.sendEvent({type:H.sessionStatus,data:{sessionId:t.sessionId,sessionStatus:t.sessionStatus}});if(t.sessionClose){this.widget.sendEvent({type:H.sessionFinish,data:{sessionId:t.sessionId,sessionStatus:t.sessionStatus}});if(!t.spam){this.store.commit("widget/dialog",{operator:{name:"",firstName:"",lastName:"",workPosition:"",avatar:"",online:false}})}}}},{key:"handleSessionDateCloseVote",value:function e(t,n,i){this.store.dispatch("widget/setVoteDateFinish",t.dateCloseVote)}}]);return e}();function q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function K(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?q(Object(n),!0).forEach((function(t){babelHelpers.defineProperty(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):q(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Y=function(){function e(){var t=this;var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};babelHelpers.classCallCheck(this,e);babelHelpers.defineProperty(this,"params",null);babelHelpers.defineProperty(this,"template",null);babelHelpers.defineProperty(this,"rootNode",null);babelHelpers.defineProperty(this,"restClient",null);babelHelpers.defineProperty(this,"pullClient",null);babelHelpers.defineProperty(this,"ready",true);babelHelpers.defineProperty(this,"inited",false);babelHelpers.defineProperty(this,"offline",false);babelHelpers.defineProperty(this,"widgetConfigRequest",null);babelHelpers.defineProperty(this,"userRegisterData",{});babelHelpers.defineProperty(this,"customData",[]);babelHelpers.defineProperty(this,"options",{checkSameDomain:true});babelHelpers.defineProperty(this,"subscribers",{});babelHelpers.defineProperty(this,"code","");babelHelpers.defineProperty(this,"host","");babelHelpers.defineProperty(this,"language","");babelHelpers.defineProperty(this,"copyright",true);babelHelpers.defineProperty(this,"copyrightUrl","");babelHelpers.defineProperty(this,"buttonInstance",null);babelHelpers.defineProperty(this,"localize",null);babelHelpers.defineProperty(this,"pageMode",null);this.params=n;this.messagesQueue=[];x.EventEmitter.subscribe(W.requestData,this.requestData.bind(this));x.EventEmitter.subscribe(W.createSession,this.createChat.bind(this));x.EventEmitter.subscribe(W.openSession,this.openSession.bind(this));this.initParams();this.initRestClient();this.initPullClient();this.initCore().then((function(){t.initWidget();t.initComplete()}))}babelHelpers.createClass(e,[{key:"initParams",value:function e(){this.rootNode=this.params.node||document.createElement("div");this.code=this.params.code||"";this.host=this.params.host||"";this.language=this.params.language||"en";this.copyright=this.params.copyright!==false;this.copyrightUrl=this.copyright&&this.params.copyrightUrl?this.params.copyrightUrl:"";if(this.params.buttonInstance&&babelHelpers["typeof"](this.params.buttonInstance)==="object"){this.buttonInstance=this.params.buttonInstance}if(this.params.pageMode&&babelHelpers["typeof"](this.params.pageMode)==="object"){this.pageMode={useBitrixLocalize:this.params.pageMode.useBitrixLocalize===true,placeholder:document.querySelector("#".concat(this.params.pageMode.placeholder))}}var t=this.checkRequiredFields();if(t.length>0){t.forEach((function(e){return console.warn(e)}));this.ready=false}this.setRootNode();this.localize=this.pageMode&&this.pageMode.useBitrixLocalize?window.BX.message:{};this.setLocalize()}},{key:"initRestClient",value:function e(){this.restClient=new V({endpoint:"".concat(this.host,"/rest")})}},{key:"initPullClient",value:function e(){this.pullClient=new d.PullClient({serverEnabled:true,userId:0,siteId:this.getSiteId(),restClient:this.restClient,skipStorageInit:true,configTimestamp:0,skipCheckRevision:true,getPublicListMethod:"imopenlines.widget.operator.get"})}},{key:"initCore",value:function e(){this.controller=new p.Controller({host:this.getHost(),siteId:this.getSiteId(),userId:0,languageId:this.language,pull:{client:this.pullClient},rest:{client:this.restClient},localize:this.localize,vuexBuilder:{database:!v.Utils.browser.isIe(),databaseName:"imol/widget",databaseType:E.WidgetVuexBuilder.DatabaseType.localStorage,models:[$.create().setVariables(this.getWidgetVariables())]}});return this.controller.ready()}},{key:"initWidget",value:function e(){this.restClient.setAuthId(this.getRestAuthId());this.setModelData();this.controller.application.setPrepareFilesBeforeSaveFunction(this.prepareFileData.bind(this));this.controller.addRestAnswerHandler(G.create({widget:this,store:this.controller.getStore(),controller:this.controller}))}},{key:"initComplete",value:function e(){window.dispatchEvent(new CustomEvent("onBitrixLiveChat",{detail:{widget:this,widgetCode:this.code,widgetHost:this.host}}));if(this.callStartFlag){this.start()}if(this.pageMode||this.callOpenFlag){this.open()}}},{key:"start",value:function e(){if(!this.controller||!this.controller.getStore()){this.callStartFlag=true;return true}if(this.isSessionActive()){this.requestWidgetData()}return true}},{key:"open",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};if(!this.controller.getStore()){this.callOpenFlag=true;return true}if(!t.openFromButton&&this.buttonInstance){this.buttonInstance.wm.showById("openline_livechat")}var n=this.checkForErrorsBeforeOpen(),i=n.error,r=n.stop;if(r){return false}if(!i&&!this.inited){this.requestWidgetData()}this.attachTemplate()}},{key:"requestWidgetData",value:function e(){var t=this;if(!this.ready){console.error("LiveChatWidget.start: widget code or host is not specified");return false}if(this.isUserReady()||this.isHashAvailable()){this.requestData();this.inited=true;this.fireInitEvent();return true}this.controller.restClient.callMethod(N.widgetConfigGet,{code:this.code},(function(e){t.widgetConfigRequest=e})).then((function(e){t.widgetConfigRequest=null;t.clearError();t.controller.executeRestAnswer(N.widgetConfigGet,e);if(!t.inited){t.inited=true;t.fireInitEvent()}}))["catch"]((function(e){t.widgetConfigRequest=null;t.setError(e.error().ex.error,e.error().ex.error_description)}));if(this.isConfigDataLoaded()){this.inited=true;this.fireInitEvent()}}},{key:"requestData",value:function e(){S.Logger.log("requesting data from widget");if(this.requestDataSend){return true}this.requestDataSend=true;if(this.widgetConfigRequest){this.widgetConfigRequest.abort()}var t=this.handleBatchRequestResult.bind(this);this.controller.restClient.callBatch(this.getDataRequestQuery(),t,false,false,v.Utils.getLogTrackingParams({name:"widget.init.config",dialog:this.controller.application.getDialogData()}))}},{key:"createChat",value:function e(){var t=this;return new Promise((function(e,n){t.controller.restClient.callBatch(t.getCreateChatRequestQuery(),(function(n){t.handleBatchCreateChatRequestResult(n).then((function(){e()}))}),false,false)}))}},{key:"handleBatchRequestResult",value:function e(t){var n=this;if(!t){this.requestDataSend=false;this.setError("EMPTY_RESPONSE","Server returned an empty response.");return false}this.handleConfigGet(t).then((function(){return n.handleUserGet(t)})).then((function(){return n.handleChatGet(t)})).then((function(){return n.handleDialogGet(t)})).then((function(){return n.handleDialogMessagesGet(t)})).then((function(){return n.handleUserRegister(t)})).then((function(){return n.handlePullRequests(t)}))["catch"]((function(e){var t=e.code,i=e.description;n.setError(t,i)}))["finally"]((function(){n.requestDataSend=false}))}},{key:"handleBatchCreateChatRequestResult",value:function e(t){var n=this;if(!t){this.requestDataSend=false;this.setError("EMPTY_RESPONSE","Server returned an empty response.");return false}return this.handleChatCreate(t).then((function(){return n.handleChatGet(t)})).then((function(){return n.handleDialogGet(t)}))["catch"]((function(e){var t=e.code,i=e.description;n.setError(t,i)}))["finally"]((function(){n.requestDataSend=false}))}},{key:"handleBatchOpenSessionRequestResult",value:function e(t){var n=this;if(!t){this.requestDataSend=false;this.setError("EMPTY_RESPONSE","Server returned an empty response.");return false}return this.handleChatGet(t).then((function(){return n.handleDialogGet(t)})).then((function(){return n.handleDialogMessagesGet(t)}))["catch"]((function(e){var t=e.code,i=e.description;n.setError(t,i)}))["finally"]((function(){n.requestDataSend=false}))}},{key:"getDataRequestQuery",value:function e(){var t=babelHelpers.defineProperty({},N.widgetConfigGet,[N.widgetConfigGet,{code:this.code}]);if(this.isUserRegistered()){t[N.widgetDialogGet]=[N.widgetDialogGet,{config_id:this.getConfigId(),trace_data:this.getCrmTraceData(),custom_data:this.getCustomData()}];t[k.RestMethodHandler.imChatGet]=[k.RestMethod.imChatGet,{dialog_id:"$result[".concat(N.widgetDialogGet,"][dialogId]")}];t[k.RestMethodHandler.imDialogMessagesGetInit]=[k.RestMethod.imDialogMessagesGet,{chat_id:"$result[".concat(N.widgetDialogGet,"][chatId]"),limit:this.controller.application.getRequestMessageLimit(),convert_text:"Y"}]}else{t[N.widgetUserRegister]=[N.widgetUserRegister,K({config_id:"$result[".concat(N.widgetConfigGet,"][configId]")},this.getUserRegisterFields())];t[k.RestMethodHandler.imChatGet]=[k.RestMethod.imChatGet,{dialog_id:"$result[".concat(N.widgetUserRegister,"][dialogId]")}];if(this.userRegisterData.hash||this.getUserHashCookie()){t[N.widgetDialogGet]=[N.widgetDialogGet,{config_id:"$result[".concat(N.widgetConfigGet,"][configId]"),trace_data:this.getCrmTraceData(),custom_data:this.getCustomData()}];t[k.RestMethodHandler.imDialogMessagesGetInit]=[k.RestMethod.imDialogMessagesGet,{chat_id:"$result[".concat(N.widgetDialogGet,"][chatId]"),limit:this.controller.application.getRequestMessageLimit(),convert_text:"Y"}]}if(this.isUserAgreeConsent()){t[N.widgetUserConsentApply]=[N.widgetUserConsentApply,{config_id:"$result[".concat(N.widgetConfigGet,"][configId]"),consent_url:location.href}]}}t[N.pullServerTime]=[N.pullServerTime,{}];t[N.pullConfigGet]=[N.pullConfigGet,{CACHE:"N"}];t[N.widgetUserGet]=[N.widgetUserGet,{}];return t}},{key:"getOpenSessionQuery",value:function e(t){var n=babelHelpers.defineProperty({},N.widgetDialogGet,[N.widgetDialogGet,{config_id:this.getConfigId(),chat_id:t}]);n[k.RestMethodHandler.imChatGet]=[k.RestMethod.imChatGet,{dialog_id:"chat".concat(t)}];n[k.RestMethodHandler.imDialogMessagesGetInit]=[k.RestMethod.imDialogMessagesGet,{chat_id:t,limit:50,convert_text:"Y"}];return n}},{key:"getCreateChatRequestQuery",value:function e(){var t={};t[N.widgetChatCreate]=[N.widgetChatCreate,K({config_id:this.getConfigId()},this.getUserRegisterFields())];t[k.RestMethodHandler.imChatGet]=[k.RestMethod.imChatGet,{dialog_id:"$result[".concat(N.widgetChatCreate,"][dialogId]")}];t[N.widgetDialogGet]=[N.widgetDialogGet,{config_id:this.getConfigId(),trace_data:this.getCrmTraceData(),custom_data:this.getCustomData()}];if(this.isUserAgreeConsent()){t[N.widgetUserConsentApply]=[N.widgetUserConsentApply,{config_id:this.getConfigId(),consent_url:location.href}]}t[N.pullServerTime]=[N.pullServerTime,{}];t[N.pullConfigGet]=[N.pullConfigGet,{CACHE:"N"}];t[N.widgetUserGet]=[N.widgetUserGet,{}];return t}},{key:"openSession",value:function e(t){var n=this;var i=t.getData();return new Promise((function(e,t){var r=n.controller.getStore().getters["dialogues/get"](i.session.dialogId);if(r){n.controller.getStore().commit("application/set",{dialog:{chatId:i.session.chatId,dialogId:i.session.dialogId,diskFolderId:0}});n.controller.getStore().commit("widget/common",{isCreateSessionMode:false});e();return}n.controller.restClient.callBatch(n.getOpenSessionQuery(i.session.chatId),(function(t){n.handleBatchOpenSessionRequestResult(t).then((function(){n.controller.getStore().commit("widget/common",{isCreateSessionMode:false});e()}))}),false,false)}))}},{key:"prepareFileData",value:function e(t){var n=this;if(!Array.isArray(t)){return t}return t.map((function(e){var t=(window.md5||y.md5)("".concat(n.getUserId(),"|").concat(e.id,"|").concat(n.getUserHash()));var i="livechat_auth_id=".concat(t,"&livechat_user_id=").concat(n.getUserId());if(e.urlPreview){e.urlPreview="".concat(e.urlPreview,"&").concat(i)}if(e.urlShow){e.urlShow="".concat(e.urlShow,"&").concat(i)}if(e.urlDownload){e.urlDownload="".concat(e.urlDownload,"&").concat(i)}return e}))}},{key:"checkRequiredFields",value:function e(){var t=[];if(typeof this.code==="string"&&this.code.length<=0){t.push("LiveChatWidget.constructor: code is not correct (".concat(this.code,")"))}if(typeof this.host==="string"&&(this.host.length<=0||!this.host.startsWith("http"))){t.push("LiveChatWidget.constructor: host is not correct (".concat(this.host,")"))}return t}},{key:"setRootNode",value:function e(){if(this.pageMode&&this.pageMode.placeholder){this.rootNode=this.pageMode.placeholder}else if(document.body.firstChild){document.body.insertBefore(this.rootNode,document.body.firstChild)}else{document.body.append(this.rootNode)}}},{key:"setLocalize",value:function e(){if(babelHelpers["typeof"](this.params.localize)==="object"){this.addLocalize(this.params.localize)}var t=g.LocalStorage.get(this.getSiteId(),0,"serverVariables",false);if(t){this.addLocalize(t)}}},{key:"getWidgetVariables",value:function e(){var t={common:{host:this.getHost(),pageMode:!!this.pageMode,copyright:this.copyright,copyrightUrl:this.copyrightUrl},vote:{messageText:this.getLocalize("BX_LIVECHAT_VOTE_TITLE"),messageLike:this.getLocalize("BX_LIVECHAT_VOTE_PLUS_TITLE"),messageDislike:this.getLocalize("BX_LIVECHAT_VOTE_MINUS_TITLE")},textMessages:{bxLivechatOnlineLine1:this.getLocalize("BX_LIVECHAT_ONLINE_LINE_1"),bxLivechatOnlineLine2:this.getLocalize("BX_LIVECHAT_ONLINE_LINE_2"),bxLivechatOffline:this.getLocalize("BX_LIVECHAT_OFFLINE")}};if(this.params.styles){t.styles={};if(this.params.styles.backgroundColor){t.styles.backgroundColor=this.params.styles.backgroundColor}if(this.params.styles.iconColor){t.styles.iconColor=this.params.styles.iconColor}}return t}},{key:"getRestAuthId",value:function e(){return this.isUserRegistered()?this.getUserHash():F.guest}},{key:"setModelData",value:function e(){if(this.params.location&&P[this.params.location]){this.controller.getStore().commit("widget/common",{location:this.params.location})}}},{key:"checkForErrorsBeforeOpen",value:function e(){var t={error:false,stop:false};if(!this.checkBrowserVersion()){this.setError("OLD_BROWSER_LOCALIZED",this.localize.BX_LIVECHAT_OLD_BROWSER);t.error=true}else if(v.Utils.versionCompare(_.WidgetVue.version(),"2.1")<0){alert(this.localize.BX_LIVECHAT_OLD_VUE);console.error("LiveChatWidget.error: OLD_VUE_VERSION (".concat(this.localize.BX_LIVECHAT_OLD_VUE_DEV.replace("#CURRENT_VERSION#",_.WidgetVue.version()),")"));t.error=true;t.stop=true}else if(this.isSameDomain()){this.setError("LIVECHAT_SAME_DOMAIN",this.localize.BX_LIVECHAT_SAME_DOMAIN);t.error=true}return t}},{key:"isSameDomain",value:function e(){if(typeof BX==="undefined"||!BX.isReady){return false}if(!this.options.checkSameDomain){return false}return this.host.lastIndexOf(".".concat(location.hostname))>-1}},{key:"checkBrowserVersion",value:function e(){if(v.Utils.platform.isIos()){var t=v.Utils.platform.getIosVersion();if(t&&t<=10){return false}}return true}},{key:"startPullClient",value:function e(t){var n=this;return new Promise((function(e,i){if(!n.getUserId()||!n.getSiteId()||!n.restClient){return i({ex:{error:"WIDGET_NOT_LOADED",error_description:"Widget is not loaded."}})}if(n.pullClientInited){if(!n.pullClient.isConnected()){n.pullClient.scheduleReconnect()}return e(true)}n.controller.userId=n.getUserId();n.pullClient.userId=n.getUserId();n.pullClient.configTimestamp=t?t.server.config_timestamp:0;n.pullClient.skipStorageInit=false;n.pullClient.storage=new d.PullClient.StorageManager({userId:n.getUserId(),siteId:n.getSiteId()});n.pullClient.subscribe(new z({store:n.controller.getStore(),controller:n.controller,widget:n}));n.pullClient.subscribe(new X({store:n.controller.getStore(),controller:n.controller,widget:n}));n.pullClient.subscribe({type:d.PullClient.SubscriptionType.Status,callback:n.eventStatusInteraction.bind(n)});n.pullConnectedFirstTime=n.pullClient.subscribe({type:d.PullClient.SubscriptionType.Status,callback:function t(i){if(i.status===d.PullClient.PullStatus.Online){e(true);n.pullConnectedFirstTime()}}});if(n.template){n.template.$Bitrix.PullClient.set(n.pullClient)}n.pullClient.start(K(K({},t),{},{skipReconnectToLastSession:true}))["catch"]((function(){i({ex:{error:"PULL_CONNECTION_ERROR",error_description:"Pull is not connected."}})}));n.pullClientInited=true}))}},{key:"stopPullClient",value:function e(){if(this.pullClient){this.pullClient.stop(d.PullClient.CloseReasons.MANUAL,"Closed manually")}}},{key:"recoverPullConnection",value:function e(){this.pullClient.restart(d.PullClient.CloseReasons.MANUAL,"Restart after click by connection status button.")}},{key:"eventStatusInteraction",value:function e(t){if(t.status===d.PullClient.PullStatus.Online){this.onPullOnlineStatus()}else if(t.status===d.PullClient.PullStatus.Offline){this.pullRequestMessage=true;this.offline=true}}},{key:"onPullOnlineStatus",value:function e(){var t=this;this.offline=false;if(this.pullRequestMessage){this.controller.pullBaseHandler.option.skip=true;S.Logger.warn("Requesting getDialogUnread after going online");x.EventEmitter.emitAsync(k.EventType.dialog.requestUnread,{chatId:this.controller.application.getChatId()}).then((function(){x.EventEmitter.emit(k.EventType.dialog.scrollOnStart,{chatId:t.controller.application.getChatId()});t.controller.pullBaseHandler.option.skip=false;x.EventEmitter.emit(W.processMessagesToSendQueue)}))["catch"]((function(){t.controller.pullBaseHandler.option.skip=false}));this.pullRequestMessage=false}else{x.EventEmitter.emit(k.EventType.dialog.readMessage);x.EventEmitter.emit(W.processMessagesToSendQueue)}}},{key:"attachTemplate",value:function e(){if(this.template){this.controller.getStore().commit("widget/common",{showed:true});return true}this.rootNode.innerHTML="";this.rootNode.append(document.createElement("div"));var t=this;return this.controller.createVue(t,{el:this.rootNode.firstChild,template:"<bx-livechat/>",beforeCreate:function e(){t.sendEvent({type:H.widgetOpen,data:{}});t.template=this;if(C.ZIndexManager!==undefined){var n=C.ZIndexManager.getOrAddStack(document.body);n.setBaseIndex(1e6);this.$bitrix.Data.set("zIndexStack",n)}},destroyed:function e(){t.sendEvent({type:H.widgetClose,data:{}});t.template=null;t.templateAttached=false;t.rootNode.innerHTML=""}}).then((function(){return new Promise((function(e,t){return e()}))}))}},{key:"detachTemplate",value:function e(){if(!this.template){return true}this.template.$destroy();return true}},{key:"mutateTemplateComponent",value:function e(t,n){return _.WidgetVue.mutateComponent(t,n)}},{key:"close",value:function e(){if(this.pageMode){return false}if(this.buttonInstance){this.buttonInstance.onWidgetClose()}this.detachTemplate()}},{key:"fireInitEvent",value:function e(){if(this.initEventFired){return true}this.sendEvent({type:H.configLoaded,data:{}});if(this.controller.getStore().state.widget.common.reopen){this.open()}this.initEventFired=true}},{key:"isUserRegistered",value:function e(){return!!this.getUserHash()}},{key:"isConfigDataLoaded",value:function e(){return this.controller.getStore().state.widget.common.configId}},{key:"isChatLoaded",value:function e(){return this.controller.getStore().state.application.dialog.chatId>0}},{key:"isSessionActive",value:function e(){return!this.controller.getStore().state.widget.dialog.sessionClose}},{key:"isUserAgreeConsent",value:function e(){return this.controller.getStore().state.widget.dialog.userConsent}},{key:"getCrmTraceData",value:function e(){var t="";if(!this.buttonInstance){return t}if(typeof this.buttonInstance.getTrace!=="function"){t=this.buttonInstance.getTrace()}else if(typeof this.buttonInstance.b24Tracker!=="undefined"&&typeof this.buttonInstance.b24Tracker.guest!=="undefined"){t=this.buttonInstance.b24Tracker.guest.getTrace()}return t}},{key:"getCustomData",value:function e(){var t=[];if(this.customData.length>0){t=this.customData}else{t=[{MESSAGE:this.localize.BX_LIVECHAT_EXTRA_SITE+": [URL]"+location.href+"[/URL]"}]}return JSON.stringify(t)}},{key:"isUserLoaded",value:function e(){return this.controller.getStore().state.widget.user.id>0}},{key:"isUserReady",value:function e(){return this.isConfigDataLoaded()&&this.isUserRegistered()}},{key:"isHashAvailable",value:function e(){return!this.isUserRegistered()&&(this.userRegisterData.hash||this.getUserHashCookie())}},{key:"getSiteId",value:function e(){return this.host.replace(/(http.?:\/\/)|([:.\\\/])/gm,"")+this.code}},{key:"getHost",value:function e(){return this.host}},{key:"getConfigId",value:function e(){return this.controller.getStore().state.widget.common.configId}},{key:"isDialogStart",value:function e(){return this.controller.getStore().state.widget.common.dialogStart}},{key:"getChatId",value:function e(){return this.controller.getStore().state.application.dialog.chatId}},{key:"getDialogId",value:function e(){return this.controller.getStore().state.application.dialog.dialogId}},{key:"getDiskFolderId",value:function e(){return this.controller.getStore().state.application.dialog.diskFolderId}},{key:"getDialogData",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.getDialogId();return this.controller.getStore().state.dialogues.collection[t]}},{key:"getSessionId",value:function e(){return this.controller.getStore().state.widget.dialog.sessionId}},{key:"isSessionClose",value:function e(){return this.controller.getStore().state.widget.dialog.sessionClose}},{key:"getUserHash",value:function e(){return this.controller.getStore().state.widget.user.hash}},{key:"getUserHashCookie",value:function e(){var t="";var n=m.Cookie.get(null,"LIVECHAT_HASH");if(typeof n==="string"&&n.match(/^[a-f0-9]{32}$/)){t=n}else{var i=m.Cookie.get(this.getSiteId(),"LIVECHAT_HASH");if(typeof i==="string"&&i.match(/^[a-f0-9]{32}$/)){t=i}}return t}},{key:"getUserId",value:function e(){return this.controller.getStore().state.widget.user.id}},{key:"getUserData",value:function e(){if(!this.controller||!this.controller.getStore()){console.error("LiveChatWidget.getUserData: method can be called after fired event - onBitrixLiveChat");return false}return this.controller.getStore().state.widget.user}},{key:"getUserRegisterFields",value:function e(){return{name:this.userRegisterData.name||"",last_name:this.userRegisterData.lastName||"",avatar:this.userRegisterData.avatar||"",email:this.userRegisterData.email||"",www:this.userRegisterData.www||"",gender:this.userRegisterData.gender||"",position:this.userRegisterData.position||"",user_hash:this.userRegisterData.hash||this.getUserHashCookie()||"",consent_url:this.controller.getStore().state.widget.common.consentUrl?location.href:"",trace_data:this.getCrmTraceData(),custom_data:this.getCustomData()}}},{key:"getWidgetLocationCode",value:function e(){return P[this.controller.getStore().state.widget.common.location]}},{key:"setUserRegisterData",value:function e(t){if(!this.controller||!this.controller.getStore()){console.error("LiveChatWidget.getUserData: method can be called after fired event - onBitrixLiveChat");return false}var n=["hash","name","lastName","avatar","email","www","gender","position"];if(!v.Utils.types.isPlainObject(t)){console.error("%cLiveChatWidget.setUserData: params is not a object","color: black;");return false}for(var i in this.userRegisterData){if(!this.userRegisterData.hasOwnProperty(i)){continue}if(!t[i]){delete this.userRegisterData[i]}}for(var r in t){if(!t.hasOwnProperty(r)){continue}if(n.indexOf(r)===-1){console.warn("%cLiveChatWidget.setUserData: user field is not set, because you are trying to set an unknown field (%c".concat(r,"%c)"),"color: black;","font-weight: bold; color: red","color: black");continue}this.userRegisterData[r]=t[r]}if(this.userRegisterData.hash&&this.getUserHash()&&this.userRegisterData.hash!==this.getUserHash()){this.setNewAuthToken(this.userRegisterData.hash)}}},{key:"setNewAuthToken",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"";this.controller.getStoreBuilder().clearModelState();m.Cookie.set(null,"LIVECHAT_HASH","",{expires:365*86400,path:"/"});this.controller.restClient.setAuthId(F.guest,t)}},{key:"setOption",value:function e(t,n){this.options[t]=n;return true}},{key:"setCustomData",value:function e(t){if(!this.controller||!this.controller.getStore()){console.error("LiveChatWidget.getUserData: method can be called after fired event - onBitrixLiveChat");return false}var n=[];if(t instanceof Array){t.forEach((function(e){if(e&&babelHelpers["typeof"](e)==="object"){n.push(e)}}));if(n.length<=0){console.error("LiveChatWidget.setCustomData: params is empty");return false}}else{if(!t){return false}n=[{MESSAGE:t}]}this.customData=this.customData.concat(n);return true}},{key:"setError",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"";var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"";console.error("LiveChatWidget.error: ".concat(t," (").concat(n,")"));var i="";if(t==="LIVECHAT_AUTH_FAILED"){i=this.getLocalize("BX_LIVECHAT_AUTH_FAILED").replace("#LINK_START#",'<a href="javascript:void();" onclick="location.reload()">').replace("#LINK_END#","</a>");this.setNewAuthToken()}else if(t==="LIVECHAT_AUTH_PORTAL_USER"){i=this.getLocalize("BX_LIVECHAT_PORTAL_USER_NEW").replace("#LINK_START#",'<a href="'+this.host+'">').replace("#LINK_END#","</a>")}else if(t==="LIVECHAT_SAME_DOMAIN"){i=this.getLocalize("BX_LIVECHAT_SAME_DOMAIN");var r=this.getLocalize("BX_LIVECHAT_SAME_DOMAIN_LINK");if(r){i+='<br><br><a href="'+r+'">'+this.getLocalize("BX_LIVECHAT_SAME_DOMAIN_MORE")+"</a>"}}else if(t.endsWith("LOCALIZED")){i=n}this.controller.getStore().commit("application/set",{error:{active:true,code:t,description:i}})}},{key:"clearError",value:function e(){this.controller.getStore().commit("application/set",{error:{active:false,code:"",description:""}})}},{key:"subscribe",value:function e(t){if(!v.Utils.types.isPlainObject(t)){console.error("%cLiveChatWidget.subscribe: params is not a object","color: black;");return false}if(!j.includes(t.type)){console.error("%cLiveChatWidget.subscribe: subscription type is not correct (%c".concat(t.type,"%c)"),"color: black;","font-weight: bold; color: red","color: black");return false}if(typeof t.callback!=="function"){console.error("%cLiveChatWidget.subscribe: callback is not a function (%c".concat(babelHelpers["typeof"](t.callback),"%c)"),"color: black;","font-weight: bold; color: red","color: black");return false}if(typeof this.subscribers[t.type]==="undefined"){this.subscribers[t.type]=[]}this.subscribers[t.type].push(t.callback);return function(){this.subscribers[t.type]=this.subscribers[t.type].filter((function(e){return e!==t.callback}))}.bind(this)}},{key:"sendEvent",value:function e(t){t=t||{};if(!t.type){return false}if(babelHelpers["typeof"](t.data)!=="object"||!t.data){t.data={}}if(this.subscribers[t.type]instanceof Array&&this.subscribers[t.type].length>0){this.subscribers[t.type].forEach((function(e){return e(t.data)}))}if(this.subscribers[H.every]instanceof Array&&this.subscribers[H.every].length>0){this.subscribers[H.every].forEach((function(e){return e({type:t.type,data:t.data})}))}return true}},{key:"addLocalize",value:function e(t){if(babelHelpers["typeof"](t)!=="object"||!t){return false}for(var n in t){if(t.hasOwnProperty(n)){this.localize[n]=t[n]}}return true}},{key:"getLocalize",value:function e(t){var n="";if(typeof t==="undefined"){return this.localize}else if(typeof this.localize[t.toString()]==="undefined"){console.warn("LiveChatWidget.getLocalize: message with code '".concat(t.toString(),"' is undefined."))}else{n=this.localize[t]}return n}},{key:"handleConfigGet",value:function e(t){var n=this;return new Promise((function(e,i){var r=t[N.widgetConfigGet];if(r&&r.error()){return i({code:r.error().ex.error,description:r.error().ex.error_description})}n.controller.executeRestAnswer(N.widgetConfigGet,r);e()}))}},{key:"handleUserGet",value:function e(t){var n=this;return new Promise((function(e,i){var r=t[N.widgetUserGet];if(r.error()){return i({code:r.error().ex.error,description:r.error().ex.error_description})}n.controller.executeRestAnswer(N.widgetUserGet,r);e()}))}},{key:"handleChatGet",value:function e(t){var n=this;return new Promise((function(e,i){var r=t[k.RestMethodHandler.imChatGet];if(r.error()){return i({code:r.error().ex.error,description:r.error().ex.error_description})}n.controller.executeRestAnswer(k.RestMethodHandler.imChatGet,r);e()}))}},{key:"handleDialogGet",value:function e(t){var n=this;return new Promise((function(e,i){var r=t[N.widgetDialogGet];if(!r){return e()}if(r.error()){return i({code:r.error().ex.error,description:r.error().ex.error_description})}n.controller.executeRestAnswer(N.widgetDialogGet,r);e()}))}},{key:"handleDialogMessagesGet",value:function e(t){var n=this;return new Promise((function(e,i){var r=t[k.RestMethodHandler.imDialogMessagesGetInit];if(!r){return e()}if(r.error()){return i({code:r.error().ex.error,description:r.error().ex.error_description})}n.controller.getStore().dispatch("dialogues/saveDialog",{dialogId:n.controller.application.getDialogId(),chatId:n.controller.application.getChatId()});n.controller.executeRestAnswer(k.RestMethodHandler.imDialogMessagesGetInit,r);e()}))}},{key:"handleUserRegister",value:function e(t){var n=this;return new Promise((function(e,i){var r=t[N.widgetUserRegister];if(!r){return e()}if(r.error()){return i({code:r.error().ex.error,description:r.error().ex.error_description})}n.controller.executeRestAnswer(N.widgetUserRegister,r);e()}))}},{key:"handleChatCreate",value:function e(t){var n=this;return new Promise((function(e,i){var r=t[N.widgetChatCreate];if(!r){return e()}if(r.error()){return i({code:r.error().ex.error,description:r.error().ex.error_description})}n.controller.executeRestAnswer(N.widgetChatCreate,r);e()}))}},{key:"handlePullRequests",value:function e(t){var n=this;return new Promise((function(e){var i=0;var r=t[N.pullServerTime];if(r&&!r.error()){i=Math.floor((Date.now()-new Date(r.data()).getTime())/1e3)}var s=null;var o=t[N.pullConfigGet];if(o&&!o.error()){s=o.data();s.server.timeShift=i}n.startPullClient(s).then((function(){x.EventEmitter.emit(W.processMessagesToSendQueue)}))["catch"]((function(e){n.setError(e.ex.error,e.ex.error_description)}))["finally"](e)}))}}]);return e}();var J=function(){function e(t){babelHelpers.classCallCheck(this,e);this.developerInfo="Do not use private methods.";this.__privateMethods__=new Y(t);this.__createLegacyMethods()}babelHelpers.createClass(e,[{key:"open",value:function e(t){return this.__privateMethods__.open(t)}},{key:"close",value:function e(){return this.__privateMethods__.close()}},{key:"showNotification",value:function e(t){return this.__privateMethods__.showNotification(t)}},{key:"getUserData",value:function e(){return this.__privateMethods__.getUserData()}},{key:"setUserRegisterData",value:function e(t){return this.__privateMethods__.setUserRegisterData(t)}},{key:"setCustomData",value:function e(t){return this.__privateMethods__.setCustomData(t)}},{key:"mutateTemplateComponent",value:function e(t,n){return this.__privateMethods__.mutateTemplateComponent(t,n)}},{key:"addLocalize",value:function e(t){return this.__privateMethods__.addLocalize(t)}},{key:"subscribe",value:function e(t){return this.__privateMethods__.subscribe(t)}},{key:"start",value:function e(){return this.__privateMethods__.start()}},{key:"__createLegacyMethods",value:function e(){var t=this;if(typeof window.BX.LiveChat==="undefined"){var n=document.createElement("a");n.href=this.__privateMethods__.host;var i=n.protocol+"//"+n.hostname+(n.port&&n.port!="80"&&n.port!="443"?":"+n.port:"");window.BX.LiveChat={openLiveChat:function e(){t.open({openFromButton:true})},closeLiveChat:function e(){t.close()},addEventListener:function e(n,r,s){if(r==="message"){t.subscribe({type:H.userMessage,callback:function e(t){s({origin:i,data:JSON.stringify({action:"sendMessage"}),event:t})}})}else{console.warn("Method BX.LiveChat.addEventListener is not supported, user new format for subscribe.")}},setCookie:function e(){},getCookie:function e(){},sourceDomain:i}}if(typeof window.BxLiveChatInit==="function"){var r=window.BxLiveChatInit();if(r.user){this.__privateMethods__.setUserRegisterData(r.user)}if(r.firstMessage){this.__privateMethods__.setCustomData(r.firstMessage)}}if(window.BxLiveChatLoader instanceof Array){window.BxLiveChatLoader.forEach((function(e){return e()}))}return true}}]);return e}();var Q=function(e){babelHelpers.inherits(t,e);function t(e){var n;babelHelpers.classCallCheck(this,t);n=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this,e));babelHelpers.defineProperty(babelHelpers.assertThisInitialized(n),"application",null);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(n),"storedMessage",null);n.application=e.Application.get();n.onProcessQueueHandler=n.processQueue.bind(babelHelpers.assertThisInitialized(n));n.onConsentAcceptedHandler=n.onConsentAccepted.bind(babelHelpers.assertThisInitialized(n));n.onConsentDeclinedHandler=n.onConsentDeclined.bind(babelHelpers.assertThisInitialized(n));x.EventEmitter.subscribe(W.processMessagesToSendQueue,n.onProcessQueueHandler);x.EventEmitter.subscribe(W.consentAccepted,n.onConsentAcceptedHandler);x.EventEmitter.subscribe(W.consentDeclined,n.onConsentDeclinedHandler);return n}babelHelpers.createClass(t,[{key:"destroy",value:function e(){babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"destroy",this).call(this);x.EventEmitter.unsubscribe(W.processMessagesToSendQueue,this.onProcessQueueHandler);x.EventEmitter.unsubscribe(W.consentAccepted,this.onConsentAcceptedHandler);x.EventEmitter.unsubscribe(W.consentDeclined,this.onConsentDeclinedHandler)}},{key:"onSendMessage",value:function e(t){var n=this;var i=t.data;i.focus=i.focus!==false;if(this.getWidgetData().common.showForm===D.smile){x.EventEmitter.emit(W.hideForm)}if(!this.getWidgetData().dialog.userConsent&&this.getWidgetData().common.consentUrl){if(i.text){this.storedMessage=i.text}x.EventEmitter.emit(W.showConsent);return false}i.text=i.text?i.text:this.storedMessage;if(!i.text&&!i.file){return false}x.EventEmitter.emit(W.hideForm);if(this.isCreateSessionMode()){x.EventEmitter.emit(W.hideForm);x.EventEmitter.emit(k.EventType.textarea.stopWriting);x.EventEmitter.emitAsync(W.createSession).then((function(){n.store.commit("widget/common",{isCreateSessionMode:false});n.sendMessage(i.text,i.file)}))}else{this.sendMessage(i.text,i.file)}if(i.focus){x.EventEmitter.emit(k.EventType.textarea.setFocus)}return true}},{key:"sendMessage",value:function e(){var t=this;var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"";var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;if(!n&&!i){return false}var r=this.store.getters["dialogues/getQuoteId"](this.getDialogId());if(r){var s=this.store.getters["messages/getMessage"](this.getChatId(),r);if(s){n=this.getMessageTextWithQuote(s,n);x.EventEmitter.emit(k.EventType.dialog.quotePanelClose)}}if(!this.controller.application.isUnreadMessagesLoaded()){this.sendMessageToServer({id:0,chatId:this.getChatId(),dialogId:this.getDialogId(),text:n,file:i});this.processQueue();return true}var o={};if(i){o.FILE_ID=[i.id]}this.addMessageToModel({text:n,params:o,sending:!i}).then((function(e){if(!t.isDialogStart()){t.store.commit("widget/common",{dialogStart:true})}x.EventEmitter.emit(k.EventType.dialog.scrollToBottom,{chatId:t.getChatId(),cancelIfScrollChange:true});t.addMessageToQueue({messageId:e,text:n,file:i});if(t.getChatId()){t.processQueue()}else{x.EventEmitter.emit(W.requestData)}}));return true}},{key:"onClickOnKeyboard",value:function e(t){var n=t.data;if(n.action==="ACTION"&&n.params.action==="LIVECHAT"){var i=n.params,r=i.dialogId,s=i.messageId,o=i.value;var a=JSON.parse(o);var l=Number.parseInt(a.SESSION_ID,10);if(l!==this.getSessionId()||this.isSessionClose()){console.error("WidgetSendMessageHandler",this.loc["BX_LIVECHAT_ACTION_EXPIRED"]);return false}this.restClient.callMethod(N.widgetActionSend,{MESSAGE_ID:s,DIALOG_ID:r,ACTION_VALUE:o})}if(n.action==="COMMAND"){var u=n.params,c=u.dialogId,f=u.messageId,d=u.botId,h=u.command,p=u.params;this.restClient.callMethod(k.RestMethod.imMessageCommand,{MESSAGE_ID:f,DIALOG_ID:c,BOT_ID:d,COMMAND:h,COMMAND_PARAMS:p})["catch"]((function(e){return console.error("WidgetSendMessageHandler: command processing error",e)}))}}},{key:"getWidgetData",value:function e(){return this.store.state.widget}},{key:"getChatId",value:function e(){return this.store.state.application.dialog.chatId}},{key:"getDialogId",value:function e(){return this.store.state.application.dialog.dialogId}},{key:"getUserId",value:function e(){return this.store.state.widget.user.id}},{key:"getMessageTextWithQuote",value:function e(t,n){var i=null;if(t.authorId){i=this.store.getters["users/get"](t.authorId)}var r=this.store.getters["files/getList"](this.getChatId());var s="-".repeat(54);var o=i&&i.name?i.name:this.loc["BX_LIVECHAT_SYSTEM_MESSAGE"];var a=v.Utils.date.format(t.date,null,this.loc);var l=v.Utils.text.quote(t.text,t.params,r,this.loc);var u=[];u.push(s);u.push("".concat(o," [").concat(a,"]"));u.push(l);u.push(s);u.push(n);return u.join("\n")}},{key:"addMessageToQueue",value:function e(t){var n=t.messageId,i=t.text,r=t.file;this.messagesToSend.push({id:n,chatId:this.getChatId(),dialogId:this.getDialogId(),text:i,file:r,sending:false})}},{key:"sendMessageToServer",value:function e(t){var n=this;x.EventEmitter.emit(k.EventType.textarea.stopWriting);if(t.chatId===0){t.chatId=this.getChatId()}this.restClient.callMethod(k.RestMethod.imMessageAdd,{TEMPLATE_ID:t.id,CHAT_ID:t.chatId,MESSAGE:t.text},null,null,v.Utils.getLogTrackingParams({name:k.RestMethod.imMessageAdd,data:{timMessageType:"text"},dialog:this.getDialogData()})).then((function(e){n.controller.executeRestAnswer(k.RestMethodHandler.imMessageAdd,e,t)}))["catch"]((function(e){n.controller.executeRestAnswer(k.RestMethodHandler.imMessageAdd,e,t);S.Logger.warn("Error during sending message",e)}));return true}},{key:"isDialogStart",value:function e(){return this.store.state.widget.common.dialogStart}},{key:"isCreateSessionMode",value:function e(){return this.store.state.widget.common.isCreateSessionMode}},{key:"getDialogData",value:function e(){var t=this.getDialogId();return this.store.state.dialogues.collection[t]}},{key:"getApplicationModel",value:function e(){return this.store.state.application}},{key:"getSessionId",value:function e(){return this.store.state.widget.dialog.sessionId}},{key:"isSessionClose",value:function e(){return this.store.state.widget.dialog.sessionClose}},{key:"processQueue",value:function e(){var t=this;if(this.application.offline){return false}this.messagesToSend.filter((function(e){return!e.sending})).forEach((function(e){t.deleteFromQueue(e.id);e.sending=true;if(e.file){x.EventEmitter.emit(k.EventType.textarea.stopWriting);x.EventEmitter.emit(k.EventType.uploader.addMessageWithFile,e)}else{t.sendMessageToServer(e)}}))}},{key:"onConsentAccepted",value:function e(){if(!this.storedMessage){return}var t=this.getApplicationModel().device.type!==k.DeviceType.mobile;this.onSendMessage({data:{focus:t}});this.storedMessage=""}},{key:"onConsentDeclined",value:function e(){if(!this.storedMessage){return}x.EventEmitter.emit(k.EventType.textarea.insertText,{text:this.storedMessage,focus:this.getApplicationModel().device.type!==k.DeviceType.mobile});this.storedMessage=""}}]);return t}(I.SendMessageHandler);var Z=function(e){babelHelpers.inherits(t,e);function t(e){var n;babelHelpers.classCallCheck(this,t);n=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this,e));babelHelpers.defineProperty(babelHelpers.assertThisInitialized(n),"application",null);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(n),"pullClient",null);n.application=e.Application.get();n.pullClient=e.PullClient.get();return n}babelHelpers.createClass(t,[{key:"onAppButtonClick",value:function e(t){var n=t.data;if(n.appId===D.smile){if(this.getWidgetModel().common.showForm===D.smile){x.EventEmitter.emit(W.hideForm)}else{x.EventEmitter.emit(W.showForm,{type:D.smile})}}else{x.EventEmitter.emit(k.EventType.textarea.setFocus)}}},{key:"onFocus",value:function e(){var t=this;if(this.getWidgetModel().common.copyright&&this.getApplicationModel().device.type===k.DeviceType.mobile){this.getWidgetModel().common.copyright=false}if(v.Utils.device.isMobile()){clearTimeout(this.onFocusScrollTimeout);this.onScrollHandler=this.onScroll.bind(this);this.onFocusScrollTimeout=setTimeout((function(){document.addEventListener("scroll",t.onScrollHandler)}),1e3)}}},{key:"onBlur",value:function e(){var t=this;if(!this.getWidgetModel().common.copyright&&this.getWidgetModel().common.copyright!==this.application.copyright){this.getWidgetModel().common.copyright=this.application.copyright;setTimeout((function(){x.EventEmitter.emit(k.EventType.dialog.scrollToBottom,{chatId:t.getChatId(),force:true})}),100)}if(v.Utils.device.isMobile()){clearTimeout(this.onFocusScrollTimeout);document.removeEventListener("scroll",this.onScrollHandler)}}},{key:"onKeyUp",value:function e(t){var n=t.data;if(this.canSendTypedText()){var i=this.getWidgetModel().dialog.sessionId;var r=this.getChatId();var s=this.getWidgetModel().user.id;var o=y.md5("".concat(i,"/").concat(r,"/").concat(s));var a=this.getWidgetModel().dialog.operator.id;var l=this.getWidgetModel().dialog.operatorChatId;this.pullClient.sendMessage([a],"imopenlines","linesMessageWrite",{text:n.text,infoString:o,operatorChatId:l})}}},{key:"canSendTypedText",value:function e(){return this.getWidgetModel().common.watchTyping&&this.getWidgetModel().dialog.sessionId&&!this.getWidgetModel().dialog.sessionClose&&this.getWidgetModel().dialog.operator.id&&this.getWidgetModel().dialog.operatorChatId&&this.pullClient.isPublishingEnabled()}},{key:"onScroll",value:function e(){clearTimeout(this.onScrollTimeout);this.onScrollTimeout=setTimeout((function(){x.EventEmitter.emit(k.EventType.textarea.setBlur,true)}),50)}},{key:"getWidgetModel",value:function e(){return this.store.state.widget}},{key:"getApplicationModel",value:function e(){return this.store.state.application}}]);return t}(I.TextareaHandler);var ee=function(e){babelHelpers.inherits(t,e);function t(e){var n;babelHelpers.classCallCheck(this,t);n=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this,e));babelHelpers.defineProperty(babelHelpers.assertThisInitialized(n),"storedFile",null);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(n),"widgetApplication",null);n.widgetApplication=e.Application.get();n.onConsentAcceptedHandler=n.onConsentAccepted.bind(babelHelpers.assertThisInitialized(n));n.onConsentDeclinedHandler=n.onConsentDeclined.bind(babelHelpers.assertThisInitialized(n));x.EventEmitter.subscribe(W.consentAccepted,n.onConsentAcceptedHandler);x.EventEmitter.subscribe(W.consentDeclined,n.onConsentDeclinedHandler);return n}babelHelpers.createClass(t,[{key:"destroy",value:function e(){babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"destroy",this).call(this);x.EventEmitter.unsubscribe(W.consentAccepted,this.onConsentAcceptedHandler);x.EventEmitter.unsubscribe(W.consentDeclined,this.onConsentDeclinedHandler)}},{key:"getUserId",value:function e(){return this.controller.store.state.widget.user.id}},{key:"getUserHash",value:function e(){return this.controller.store.state.widget.user.hash}},{key:"getHost",value:function e(){return this.controller.store.state.widget.common.host}},{key:"addMessageWithFile",value:function e(t){var n=this;var i=t.getData();if(!this.getDiskFolderId()){this.requestDiskFolderId(i.chatId).then((function(){n.addMessageWithFile(t)}))["catch"]((function(e){S.Logger.error("addMessageWithFile error",e);return false}));return false}this.uploader.senderOptions.customHeaders["Livechat-Dialog-Id"]=this.getDialogId();this.uploader.senderOptions.customHeaders["Livechat-Auth-Id"]=this.getUserHash();this.uploader.addTask({taskId:i.file.id,fileData:i.file.source.file,fileName:i.file.source.file.name,generateUniqueName:true,diskFolderId:this.getDiskFolderId(),previewBlob:i.file.previewBlob,chunkSize:this.widgetApplication.getLocalize("isCloud")?b.Uploader.CLOUD_MAX_CHUNK_SIZE:b.Uploader.BOX_MIN_CHUNK_SIZE})}},{key:"onTextareaFileSelected",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},n=t.data;var i=null;if(n&&n.fileChangeEvent&&n.fileChangeEvent.target.files.length>0){i=n.fileChangeEvent}else{i=this.storedFile}if(!i){return false}if(!this.controller.store.state.widget.dialog.userConsent&&this.controller.store.state.widget.common.consentUrl){this.storedFile=n.fileChangeEvent;x.EventEmitter.emit(W.showConsent);return false}this.uploadFile(i)}},{key:"uploadFile",value:function e(t){if(!t){return false}if(!this.getChatId()){x.EventEmitter.emit(W.requestData)}this.uploader.addFilesFromEvent(t)}},{key:"onConsentAccepted",value:function e(){if(!this.storedFile){return}this.onTextareaFileSelected();this.storedFile=""}},{key:"onConsentDeclined",value:function e(){if(!this.storedFile){return}this.storedFile=""}},{key:"getUploaderSenderOptions",value:function e(){return{host:this.getHost(),customHeaders:{"Livechat-Auth-Id":this.getUserHash()},actionUploadChunk:"imopenlines.widget.disk.upload",actionCommitFile:"imopenlines.widget.disk.commit",actionRollbackUpload:"imopenlines.widget.disk.rollbackUpload"}}}]);return t}(I.TextareaUploadHandler);var te=function(e){babelHelpers.inherits(t,e);function t(e){var n;babelHelpers.classCallCheck(this,t);n=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this,e));babelHelpers.defineProperty(babelHelpers.assertThisInitialized(n),"application",null);n.application=e.Application.get();return n}babelHelpers.createClass(t,[{key:"readMessage",value:function e(n){var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;if(this.application.offline){return false}return babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"readMessage",this).call(this,n,i,r)}}]);return t}(I.ReadingHandler);var ne=function(e){babelHelpers.inherits(t,e);function t(e){var n;var i=e.widgetLocation,r=e.availableWidth,s=e.availableHeight,o=e.events;babelHelpers.classCallCheck(this,t);n=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this));babelHelpers.defineProperty(babelHelpers.assertThisInitialized(n),"isResizing",false);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(n),"widgetLocation",null);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(n),"availableWidth",null);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(n),"availableHeight",null);n.setEventNamespace("BX.IMOL.WidgetResizeHandler");n.subscribeToEvents(o);n.widgetLocation=i;n.availableWidth=r;n.availableHeight=s;return n}babelHelpers.createClass(t,[{key:"subscribeToEvents",value:function e(t){var n=this;var i=w.Type.isObject(t)?t:{};Object.entries(i).forEach((function(e){var t=babelHelpers.slicedToArray(e,2),i=t[0],r=t[1];if(w.Type.isFunction(r)){n.subscribe(i,r)}}))}},{key:"startResize",value:function e(t,n,i){if(this.isResizing){return false}this.isResizing=true;t=t.changedTouches?t.changedTouches[0]:t;this.cursorStartPointY=t.clientY;this.cursorStartPointX=t.clientX;this.heightStartPoint=n;this.widthStartPoint=i;this.addWidgetResizeEvents()}},{key:"onContinueResize",value:function e(n){if(!this.isResizing){return false}n=n.changedTouches?n.changedTouches[0]:n;this.cursorControlPointY=n.clientY;this.cursorControlPointX=n.clientX;var i=this.isBottomLocation()?Math.min(this.heightStartPoint+this.cursorStartPointY-this.cursorControlPointY,this.availableHeight):Math.min(this.heightStartPoint-this.cursorStartPointY+this.cursorControlPointY,this.availableHeight);var r=Math.max(i,R.height);var s=this.isLeftLocation()?Math.min(this.widthStartPoint-this.cursorStartPointX+this.cursorControlPointX,this.availableWidth):Math.min(this.widthStartPoint+this.cursorStartPointX-this.cursorControlPointX,this.availableWidth);var o=Math.max(s,R.width);this.emit(t.events.onSizeChange,{newHeight:r,newWidth:o})}},{key:"onStopResize",value:function e(){if(!this.isResizing){return false}this.isResizing=false;this.removeWidgetResizeEvents();this.emit(t.events.onStopResize)}},{key:"setAvailableWidth",value:function e(t){this.availableWidth=t}},{key:"setAvailableHeight",value:function e(t){this.availableHeight=t}},{key:"addWidgetResizeEvents",value:function e(){this.onContinueResizeHandler=this.onContinueResize.bind(this);this.onStopResizeHandler=this.onStopResize.bind(this);document.addEventListener("mousemove",this.onContinueResizeHandler);document.addEventListener("mouseup",this.onStopResizeHandler);document.addEventListener("mouseleave",this.onStopResizeHandler)}},{key:"removeWidgetResizeEvents",value:function e(){document.removeEventListener("mousemove",this.onContinueResizeHandler);document.removeEventListener("mouseup",this.onStopResizeHandler);document.removeEventListener("mouseleave",this.onStopResizeHandler)}},{key:"isBottomLocation",value:function e(){return[A.bottomLeft,A.bottomMiddle,A.bottomRight].includes(this.widgetLocation)}},{key:"isLeftLocation",value:function e(){return[A.bottomLeft,A.topLeft,A.topMiddle].includes(this.widgetLocation)}},{key:"destroy",value:function e(){this.removeWidgetResizeEvents()}}]);return t}(x.EventEmitter);babelHelpers.defineProperty(ne,"events",{onSizeChange:"onSizeChange",onStopResize:"onStopResize"});var ie=function(){function e(t){babelHelpers.classCallCheck(this,e);babelHelpers.defineProperty(this,"store",null);babelHelpers.defineProperty(this,"restClient",null);babelHelpers.defineProperty(this,"application",null);this.store=t.Data.get("controller").store;this.restClient=t.RestClient.get();this.application=t.Application.get();this.subscribeToEvents()}babelHelpers.createClass(e,[{key:"subscribeToEvents",value:function e(){this.showConsentHandler=this.onShowConsent.bind(this);this.acceptConsentHandler=this.onAcceptConsent.bind(this);this.declineConsentHandler=this.onDeclineConsent.bind(this);x.EventEmitter.subscribe(W.showConsent,this.showConsentHandler);x.EventEmitter.subscribe(W.acceptConsent,this.acceptConsentHandler);x.EventEmitter.subscribe(W.declineConsent,this.declineConsentHandler)}},{key:"onShowConsent",value:function e(){this.showConsent()}},{key:"onAcceptConsent",value:function e(){this.acceptConsent()}},{key:"onDeclineConsent",value:function e(){this.declineConsent()}},{key:"showConsent",value:function e(){this.store.commit("widget/common",{showConsent:true})}},{key:"hideConsent",value:function e(){this.store.commit("widget/common",{showConsent:false})}},{key:"acceptConsent",value:function e(){this.hideConsent();this.sendConsentDecision(true);x.EventEmitter.emit(W.consentAccepted);if(this.getWidgetModel().common.showForm===D.none){x.EventEmitter.emit(k.EventType.textarea.setFocus)}}},{key:"declineConsent",value:function e(){x.EventEmitter.emit(W.hideForm);this.hideConsent();this.sendConsentDecision(false);x.EventEmitter.emit(W.consentDeclined);if(this.getApplicationModel().device.type!==k.DeviceType.mobile){x.EventEmitter.emit(k.EventType.textarea.setFocus)}}},{key:"sendConsentDecision",value:function e(t){this.store.commit("widget/dialog",{userConsent:t});if(t&&this.application.isUserRegistered()){this.restClient.callMethod(N.widgetUserConsentApply,{config_id:this.getWidgetModel().common.configId,consent_url:location.href})}}},{key:"getWidgetModel",value:function e(){return this.store.state.widget}},{key:"getApplicationModel",value:function e(){return this.store.state.application}},{key:"destroy",value:function e(){x.EventEmitter.unsubscribe(W.showConsent,this.showConsentHandler);x.EventEmitter.unsubscribe(W.acceptConsent,this.acceptConsentHandler);x.EventEmitter.unsubscribe(W.declineConsent,this.declineConsentHandler)}}]);return e}();var re=function(){function e(t){babelHelpers.classCallCheck(this,e);babelHelpers.defineProperty(this,"store",null);babelHelpers.defineProperty(this,"application",null);babelHelpers.defineProperty(this,"restClient",null);this.store=t.Data.get("controller").store;this.restClient=t.RestClient.get();this.application=t.Application.get();this.showFormHandler=this.onShowForm.bind(this);this.hideFormHandler=this.onHideForm.bind(this);this.sendVoteHandler=this.onSendVote.bind(this);x.EventEmitter.subscribe(W.showForm,this.showFormHandler);x.EventEmitter.subscribe(W.hideForm,this.hideFormHandler);x.EventEmitter.subscribe(W.sendDialogVote,this.sendVoteHandler)}babelHelpers.createClass(e,[{key:"onShowForm",value:function e(t){var n=this;var i=t.data;clearTimeout(this.showFormTimeout);if(i.type===D.like){if(i.delayed){this.showFormTimeout=setTimeout((function(){n.showLikeForm()}),5e3)}else{this.showLikeForm()}}else if(i.type===D.smile){this.showSmiles()}}},{key:"onHideForm",value:function e(){this.hideForm()}},{key:"onSendVote",value:function e(t){var n=t.data.vote;console.warn("VOTE",n);this.sendVote(n)}},{key:"showLikeForm",value:function e(){if(this.application.offline){return false}clearTimeout(this.showFormTimeout);if(!this.getWidgetModel().common.vote.enable){return false}if(this.getWidgetModel().dialog.sessionClose&&this.getWidgetModel().dialog.userVote!==O.none){return false}this.store.commit("widget/common",{showForm:D.like})}},{key:"showSmiles",value:function e(){this.store.commit("widget/common",{showForm:D.smile})}},{key:"sendVote",value:function e(t){var n=this;var i=this.getWidgetModel().dialog.sessionId;if(!i){return false}this.restClient.callMethod(N.widgetVoteSend,{SESSION_ID:i,ACTION:t})["catch"]((function(){n.store.commit("widget/dialog",{userVote:O.none})}));this.application.sendEvent({type:H.userVote,data:{vote:t}})}},{key:"hideForm",value:function e(){clearTimeout(this.showFormTimeout);if(this.getWidgetModel().common.showForm!==D.none){this.store.commit("widget/common",{showForm:D.none})}}},{key:"getWidgetModel",value:function e(){return this.store.state.widget}},{key:"destroy",value:function e(){x.EventEmitter.unsubscribe(W.showForm,this.showFormHandler);x.EventEmitter.unsubscribe(W.hideForm,this.hideFormHandler);x.EventEmitter.unsubscribe(W.sendDialogVote,this.sendVoteHandler)}}]);return e}();var se=function(e){babelHelpers.inherits(t,e);function t(){babelHelpers.classCallCheck(this,t);return babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).apply(this,arguments))}babelHelpers.createClass(t,[{key:"onOpenMessageReactionList",value:function e(t){var n=t.data;S.Logger.warn("Reactions list is blocked for the widget",n)}}]);return t}(I.ReactionHandler);var oe=function(){function e(t){babelHelpers.classCallCheck(this,e);babelHelpers.defineProperty(this,"store",null);babelHelpers.defineProperty(this,"application",null);this.store=t.Data.get("controller").store;this.application=t.Application.get()}babelHelpers.createClass(e,[{key:"getHtmlHistory",value:function e(){var t=this.getChatId();if(t<=0){console.error("WidgetHistoryHandler: Incorrect chatId value")}var n={chatId:this.getChatId()};this.requestControllerAction("imopenlines.widget.history.download",n).then(this.handleRequest.bind(this)).then(this.downloadHistory.bind(this))["catch"]((function(e){return console.error("WidgetHistoryHandler: fetch error.",e)}))}},{key:"requestControllerAction",value:function e(t,n){var i=this.application.host?this.application.host:"";var r="/bitrix/services/main/ajax.php";var s=new URL(r,i);s.searchParams.set("action",t);var o=new FormData;for(var a in n){if(n.hasOwnProperty(a)){o.append(a,n[a])}}return fetch(s,{method:"POST",headers:{"Livechat-Auth-Id":this.getUserHash()},body:o})}},{key:"handleRequest",value:function e(t){var n=t.headers.get("Content-Type");if(n.startsWith("application/json")){return t.json()}return t.blob()}},{key:"downloadHistory",value:function e(t){if(t instanceof Blob){var n=window.URL.createObjectURL(t);var i=document.createElement("a");i.href=n;i.download="".concat(this.getChatId(),".html");document.body.append(i);i.click();i.remove()}else if(t.hasOwnProperty("errors")){console.error("WidgetHistoryHandler: ".concat(t.errors[0]))}else{console.error("WidgetHistoryHandler: unknown error.")}}},{key:"getChatId",value:function e(){return this.store.state.application.dialog.chatId}},{key:"getUserHash",value:function e(){return this.store.state.widget.user.hash}},{key:"destroy",value:function e(){}}]);return e}();var ae=function(e){babelHelpers.inherits(t,e);function t(){babelHelpers.classCallCheck(this,t);return babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).apply(this,arguments))}babelHelpers.createClass(t,[{key:"onClickOnDialog",value:function e(){x.EventEmitter.emit(W.hideForm)}}]);return t}(I.DialogActionHandler);function le(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function ue(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?le(Object(n),!0).forEach((function(t){babelHelpers.defineProperty(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):le(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}_.WidgetBitrixVue.component("bx-livechat",{data:function e(){return{widgetAvailableHeight:0,widgetAvailableWidth:0,widgetCurrentHeight:0,widgetCurrentWidth:0,widgetIsResizing:false,textareaHeight:100,welcomeFormFilled:false,startNewChatMode:false}},computed:ue({FormType:function e(){return D},VoteType:function e(){return O},DeviceType:function e(){return k.DeviceType},EventType:function e(){return k.EventType},showTextarea:function e(){if(this.widget.common.isCreateSessionMode){return this.startNewChatMode}var t=this.widget.common.crmFormsSettings;if(!t.useWelcomeForm||!t.welcomeFormId){return true}else{return t.welcomeFormDelay?true:this.welcomeFormFilled}},showWelcomeForm:function e(){return this.widget.common.crmFormsSettings.useWelcomeForm&&!this.widget.common.crmFormsSettings.welcomeFormDelay&&this.widget.common.crmFormsSettings.welcomeFormId&&!this.welcomeFormFilled},textareaHeightStyle:function e(){return{flex:"0 0 ".concat(this.textareaHeight,"px")}},textareaBottomMargin:function e(){if(!this.widget.common.copyright&&!this.isBottomLocation()){return{marginBottom:"5px"}}return""},widgetHeightStyle:function e(){if(v.Utils.device.isMobile()||this.widget.common.pageMode){return}if(this.widgetAvailableHeight<L.height||this.widgetAvailableHeight<this.widgetCurrentHeight){this.widgetCurrentHeight=Math.max(this.widgetAvailableHeight,R.height)}return"".concat(this.widgetCurrentHeight,"px")},widgetWidthStyle:function e(){if(v.Utils.device.isMobile()||this.widget.common.pageMode){return}if(this.widgetAvailableWidth<L.width||this.widgetAvailableWidth<this.widgetCurrentWidth){this.widgetCurrentWidth=Math.max(this.widgetAvailableWidth,R.width)}return"".concat(this.widgetCurrentWidth,"px")},userSelectStyle:function e(){return this.widgetIsResizing?"none":"auto"},widgetMobileDisabled:function e(){if(this.application.device.type!==k.DeviceType.mobile){return false}if(this.application.device.orientation!==k.DeviceOrientation.horizontal){return false}if(navigator.userAgent.toString().includes("iPhone")){return true}else{return babelHelpers["typeof"](window.screen)!=="object"||window.screen.availHeight<800}},widgetPositionClass:function e(){var t=[];if(this.widget.common.pageMode){t.push("bx-livechat-page-mode")}else{t.push("bx-livechat-position-".concat(P[this.widget.common.location]))}return t},widgetLanguageClass:function e(){var t=[];if(this.application.common.languageId===M.russian){t.push("bx-livechat-logo-ru")}else if(this.application.common.languageId===M.ukraine){t.push("bx-livechat-logo-ua")}else{t.push("bx-livechat-logo-en")}return t},widgetPlatformClass:function e(){var t=[];if(v.Utils.device.isMobile()){t.push("bx-livechat-mobile")}else if(v.Utils.browser.isSafari()){t.push("bx-livechat-browser-safari")}else if(v.Utils.browser.isIe()){t.push("bx-livechat-browser-ie")}if(v.Utils.platform.isMac()){t.push("bx-livechat-mac")}else{t.push("bx-livechat-custom-scroll")}return t},widgetClassName:function e(){var t=[];t.push.apply(t,babelHelpers.toConsumableArray(this.widgetPositionClass).concat(babelHelpers.toConsumableArray(this.widgetLanguageClass),babelHelpers.toConsumableArray(this.widgetPlatformClass)));if(!this.widget.common.online){t.push("bx-livechat-offline-state")}if(this.widget.common.dragged){t.push("bx-livechat-drag-n-drop")}if(this.widget.common.dialogStart){t.push("bx-livechat-chat-start")}if(this.widget.dialog.operator.name&&!(this.application.device.type===k.DeviceType.mobile&&this.application.device.orientation===k.DeviceOrientation.horizontal)){t.push("bx-livechat-has-operator")}if(this.widget.common.styles.backgroundColor&&v.Utils.isDarkColor(this.widget.common.styles.iconColor)){t.push("bx-livechat-bright-header")}return t},showMessageDialog:function e(){return this.messageCollection.length>0},localize:function e(){return _.WidgetBitrixVue.getFilteredPhrases("BX_LIVECHAT_",this)}},E.WidgetVuex.mapState({widget:function e(t){return t.widget},application:function e(t){return t.application},dialog:function e(t){return t.dialogues.collection[t.application.dialog.dialogId]},messageCollection:function e(t){return t.messages.collection[t.application.dialog.chatId]}})),created:function e(){var t=this;S.Logger.warn("Livechat component created");this.onCreated().then((function(){t.subscribeToEvents();t.initEventHandlers()}))},mounted:function e(){if(this.widget.user.id>0){this.welcomeFormFilled=true}this.registerZIndex()},beforeDestroy:function e(){this.unsubscribeEvents();this.destroyHandlers();this.unregisterZIndex()},methods:{initEventHandlers:function e(){this.sendMessageHandler=new Q(this.$Bitrix);this.textareaHandler=new Z(this.$Bitrix);this.textareaUploadHandler=new ee(this.$Bitrix);this.readingHandler=new te(this.$Bitrix);this.consentHandler=new ie(this.$Bitrix);this.formHandler=new re(this.$Bitrix);this.textareaDragHandler=this.getTextareaDragHandler();this.resizeHandler=this.getWidgetResizeHandler();this.reactionHandler=new se(this.$Bitrix);this.historyHandler=new oe(this.$Bitrix);this.dialogActionHandler=new ae(this.$Bitrix)},destroyHandlers:function e(){this.sendMessageHandler.destroy();this.textareaHandler.destroy();this.textareaUploadHandler.destroy();this.readingHandler.destroy();this.consentHandler.destroy();this.formHandler.destroy();this.textareaDragHandler.destroy();this.resizeHandler.destroy();this.reactionHandler.destroy();this.historyHandler.destroy();this.dialogActionHandler.destroy()},subscribeToEvents:function e(){document.addEventListener("keydown",this.onWindowKeyDown);if(!v.Utils.device.isMobile()&&!this.widget.common.pageMode){this.getAvailableSpaceFunc=v.Utils.throttle(this.getAvailableSpace,50);window.addEventListener("resize",this.getAvailableSpaceFunc)}},unsubscribeEvents:function e(){document.removeEventListener("keydown",this.onWindowKeyDown);if(!v.Utils.device.isMobile()&&!this.widget.common.pageMode){window.removeEventListener("resize",this.getAvailableSpaceFunc)}},initMobileEnv:function e(){var t=this;var n=document.head.querySelectorAll("meta");var i=babelHelpers.toConsumableArray(n).find((function(e){return e.name==="viewport"}));if(i){this.viewPortMetaSiteNode=i;this.viewPortMetaSiteNode.remove()}else{this.createViewportMeta()}if(!this.viewPortMetaWidgetNode){this.viewPortMetaWidgetNode=document.createElement("meta");this.viewPortMetaWidgetNode.setAttribute("name","viewport");this.viewPortMetaWidgetNode.setAttribute("content","width=device-width, initial-scale=1.0, user-scalable=0");document.head.append(this.viewPortMetaWidgetNode)}document.body.classList.add("bx-livechat-mobile-state");if(v.Utils.browser.isSafariBased()){document.body.classList.add("bx-livechat-mobile-safari-based")}return new Promise((function(e){setTimeout((function(){t.$store.dispatch("widget/show").then(e)}),50)}))},createViewportMeta:function e(){var t=document.body.offsetWidth;if(t<window.innerWidth){t=window.innerWidth}if(t<1024){t=1024}this.viewPortMetaSiteNode=document.createElement("meta");this.viewPortMetaSiteNode.setAttribute("name","viewport");this.viewPortMetaSiteNode.setAttribute("content","width=".concat(t,", initial-scale=1.0, user-scalable=1"))},removeMobileEnv:function e(){document.body.classList.remove("bx-livechat-mobile-state");if(v.Utils.browser.isSafariBased()){document.body.classList.remove("bx-livechat-mobile-safari-based")}if(this.viewPortMetaWidgetNode){this.viewPortMetaWidgetNode.remove();this.viewPortMetaWidgetNode=null}if(this.viewPortMetaSiteNode){document.head.append(this.viewPortMetaSiteNode);this.viewPortMetaSiteNode=null}},onCreated:function e(){var t=this;return new Promise((function(e){if(v.Utils.device.isMobile()){t.initMobileEnv().then(e)}else{t.$store.dispatch("widget/show").then((function(){t.widgetCurrentHeight=L.height;t.widgetCurrentWidth=L.width;t.getAvailableSpace();t.widgetCurrentHeight=t.widget.common.widgetHeight||t.widgetCurrentHeight;t.widgetCurrentWidth=t.widget.common.widgetWidth||t.widgetCurrentWidth;e()}))}t.textareaHeight=t.widget.common.textareaHeight||t.textareaHeight;t.initCollections()}))},initCollections:function e(){this.$store.commit("files/initCollection",{chatId:this.getApplication().getChatId()});this.$store.commit("messages/initCollection",{chatId:this.getApplication().getChatId()});this.$store.commit("dialogues/initCollection",{dialogId:this.getApplication().getDialogId(),fields:{entityType:"LIVECHAT",type:"livechat"}})},onBeforeClose:function e(){if(v.Utils.device.isMobile()){this.removeMobileEnv()}},onAfterClose:function e(){this.getApplication().close()},onOpenMenu:function e(){this.historyHandler.getHtmlHistory()},onPullRequestConfig:function e(){this.getApplication().recoverPullConnection()},onSmilesSelectSmile:function e(t){x.EventEmitter.emit(k.EventType.textarea.insertText,{text:t.text})},onSmilesSelectSet:function e(){x.EventEmitter.emit(k.EventType.textarea.setFocus)},onWidgetStartDrag:function e(t){this.resizeHandler.startResize(t,this.widgetCurrentHeight,this.widgetCurrentWidth);this.widgetIsResizing=true;x.EventEmitter.emit(k.EventType.textarea.setBlur,true)},onWindowKeyDown:function e(t){if(t.keyCode!==27){return}if(this.widget.common.showForm!==D.none){this.$store.commit("widget/common",{showForm:D.none})}else if(this.widget.common.showConsent){x.EventEmitter.emit(W.declineConsent)}else{this.close()}t.preventDefault();t.stopPropagation();x.EventEmitter.emit(k.EventType.textarea.setFocus)},onWelcomeFormSendSuccess:function e(){this.welcomeFormFilled=true},onWelcomeFormSendError:function e(t){console.error("onWelcomeFormSendError",t);this.welcomeFormFilled=true},onTextareaStartDrag:function e(t){this.textareaDragHandler.onStartDrag(t,this.textareaHeight);x.EventEmitter.emit(k.EventType.textarea.setBlur,true)},openDialogList:function e(){this.$store.commit("widget/common",{isCreateSessionMode:!this.widget.common.isCreateSessionMode});this.startNewChatMode=false},onStartNewChat:function e(){this.startNewChatMode=true},getApplication:function e(){return this.$Bitrix.Application.get()},close:function e(){if(this.widget.common.pageMode){return false}this.onBeforeClose();this.$store.commit("widget/common",{showed:false})},getAvailableSpace:function e(){var t=50;if(this.isBottomLocation()){var n=this.$refs.widgetWrapper.getBoundingClientRect().bottom;var i=window.innerHeight-n;this.widgetAvailableHeight=window.innerHeight-t-i}else{var r=this.$refs.widgetWrapper.getBoundingClientRect().top;this.widgetAvailableHeight=window.innerHeight-t-r}this.widgetAvailableWidth=window.innerWidth-t*2;if(this.resizeHandler){this.resizeHandler.setAvailableWidth(this.widgetAvailableWidth);this.resizeHandler.setAvailableHeight(this.widgetAvailableHeight)}},getTextareaDragHandler:function e(){var t=this,n;return new I.TextareaDragHandler((n={},babelHelpers.defineProperty(n,I.TextareaDragHandler.events.onHeightChange,(function(e){var n=e.data;var i=n.newHeight;if(t.textareaHeight!==i){t.textareaHeight=i}})),babelHelpers.defineProperty(n,I.TextareaDragHandler.events.onStopDrag,(function(){t.$store.commit("widget/common",{textareaHeight:t.textareaHeight});x.EventEmitter.emit(k.EventType.dialog.scrollToBottom,{chatId:t.chatId,force:true})})),n))},getWidgetResizeHandler:function e(){var t=this,n;return new ne({widgetLocation:this.widget.common.location,availableWidth:this.widgetAvailableWidth,availableHeight:this.widgetAvailableHeight,events:(n={},babelHelpers.defineProperty(n,ne.events.onSizeChange,(function(e){var n=e.data;var i=n.newHeight,r=n.newWidth;if(t.widgetCurrentHeight!==i){t.widgetCurrentHeight=i}if(t.widgetCurrentWidth!==r){t.widgetCurrentWidth=r}})),babelHelpers.defineProperty(n,ne.events.onStopResize,(function(){t.widgetIsResizing=false;t.$store.commit("widget/common",{widgetHeight:t.widgetCurrentHeight,widgetWidth:t.widgetCurrentWidth})})),n)})},isBottomLocation:function e(){return[A.bottomLeft,A.bottomMiddle,A.bottomRight].includes(this.widget.common.location)},isPageMode:function e(){return this.widget.common.pageMode},registerZIndex:function e(){this.zIndexStackInstance=this.$Bitrix.Data.get("zIndexStack");if(this.zIndexStackInstance&&!!this.$refs.widgetWrapper){this.zIndexStackInstance.register(this.$refs.widgetWrapper)}},unregisterZIndex:function e(){if(this.zIndexStackInstance){this.zIndexStackInstance.unregister(this.$refs.widgetWrapper)}}},template:'\n\t\t<transition enter-active-class="bx-livechat-show" leave-active-class="bx-livechat-close" @after-leave="onAfterClose">\n\t\t\t<div\n\t\t\t\t:class="widgetClassName"\n\t\t\t\tv-if="widget.common.showed"\n\t\t\t\t:style="{height: widgetHeightStyle, width: widgetWidthStyle, userSelect: userSelectStyle}"\n\t\t\t\tclass="bx-livechat-wrapper bx-livechat-show"\n\t\t\t\tref="widgetWrapper"\n\t\t\t>\n\t\t\t\t<div class="bx-livechat-box">\n\t\t\t\t\t<div v-if="isBottomLocation() && !isPageMode()" class="bx-livechat-widget-resize-handle" @mousedown="onWidgetStartDrag"></div>\n\t\t\t\t\t<bx-livechat-head \n\t\t\t\t\t\t:isWidgetDisabled="widgetMobileDisabled" \n\t\t\t\t\t\t@openMenu="onOpenMenu" \n\t\t\t\t\t\t@close="close"\n\t\t\t\t\t\t@openDialogList="openDialogList"\n\t\t\t\t\t/>\n\t\t\t\t\t<template v-if="widgetMobileDisabled">\n\t\t\t\t\t\t<bx-livechat-body-orientation-disabled/>\n\t\t\t\t\t</template>\n\t\t\t\t\t<template v-else-if="application.error.active">\n\t\t\t\t\t\t<bx-livechat-body-error/>\n\t\t\t\t\t</template>\n\t\t\t\t\t<template v-else-if="!widget.common.configId">\n\t\t\t\t\t\t<div class="bx-livechat-body" key="loading-body">\n\t\t\t\t\t\t\t<bx-livechat-body-loading/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</template>\n\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t<div v-show="!widget.common.dialogStart" class="bx-livechat-body" :class="{\'bx-livechat-body-with-scroll\': showWelcomeForm}" key="welcome-body">\n\t\t\t\t\t\t\t<bx-imopenlines-form\n\t\t\t\t\t\t\t  v-show="showWelcomeForm"\n\t\t\t\t\t\t\t  @formSendSuccess="onWelcomeFormSendSuccess"\n\t\t\t\t\t\t\t  @formSendError="onWelcomeFormSendError"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<template v-if="!showWelcomeForm">\n\t\t\t\t\t\t\t\t<bx-livechat-body-operators/>\n\t\t\t\t\t\t\t\t<keep-alive include="bx-livechat-smiles">\n\t\t\t\t\t\t\t\t\t<template v-if="widget.common.showForm === FormType.smile">\n\t\t\t\t\t\t\t\t\t\t<bx-livechat-smiles @selectSmile="onSmilesSelectSmile" @selectSet="onSmilesSelectSet"/>\n\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t</keep-alive>\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<template v-if="widget.common.dialogStart">\n\t\t\t\t\t\t\t<bx-pull-component-status :canReconnect="true" @reconnect="onPullRequestConfig"/>\n\t\t\t\t\t\t\t<div :class="[\'bx-livechat-body\', {\'bx-livechat-body-with-message\': showMessageDialog}]" key="with-message">\n\t\t\t\t\t\t\t\t<template v-if="widget.common.isCreateSessionMode">\n\t\t\t\t\t\t\t\t\t<bx-livechat-dialogues-list @startNewChat="onStartNewChat"/>\n\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t<template v-else-if="showMessageDialog">\n\t\t\t\t\t\t\t\t\t<div class="bx-livechat-dialog">\n\t\t\t\t\t\t\t\t\t\t<bx-im-component-dialog\n\t\t\t\t\t\t\t\t\t\t\t:userId="application.common.userId"\n\t\t\t\t\t\t\t\t\t\t\t:dialogId="application.dialog.dialogId"\n\t\t\t\t\t\t\t\t\t\t\t:messageLimit="application.dialog.messageLimit"\n\t\t\t\t\t\t\t\t\t\t\t:enableReactions="true"\n\t\t\t\t\t\t\t\t\t\t\t:enableDateActions="false"\n\t\t\t\t\t\t\t\t\t\t\t:enableCreateContent="false"\n\t\t\t\t\t\t\t\t\t\t\t:enableGestureQuote="true"\n\t\t\t\t\t\t\t\t\t\t\t:enableGestureMenu="true"\n\t\t\t\t\t\t\t\t\t\t\t:showMessageAvatar="false"\n\t\t\t\t\t\t\t\t\t\t\t:showMessageMenu="false"\n\t\t\t\t\t\t\t\t\t\t\t:skipDataRequest="true"\n\t\t\t\t\t\t\t\t\t\t\t:showLoadingState="false"\n\t\t\t\t\t\t\t\t\t\t\t:showEmptyState="false"\n\t\t\t\t\t\t\t\t\t\t />\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t\t\t\t<bx-livechat-body-loading/>\n\t\t\t\t\t\t\t\t</template>\n\n\t\t\t\t\t\t\t\t<keep-alive include="bx-livechat-smiles">\n\t\t\t\t\t\t\t\t\t<template v-if="widget.common.showForm === FormType.like && widget.common.vote.enable">\n\t\t\t\t\t\t\t\t\t\t<bx-livechat-form-vote/>\n\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t\t<template v-else-if="widget.common.showForm === FormType.welcome">\n\t\t\t\t\t\t\t\t\t\t<bx-livechat-form-welcome/>\n\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t\t<template v-else-if="widget.common.showForm === FormType.offline">\n\t\t\t\t\t\t\t\t\t\t<bx-livechat-form-offline/>\n\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t\t<template v-else-if="widget.common.showForm === FormType.history">\n\t\t\t\t\t\t\t\t\t\t<bx-livechat-form-history/>\n\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t\t<template v-else-if="widget.common.showForm === FormType.smile">\n\t\t\t\t\t\t\t\t\t\t<bx-livechat-smiles @selectSmile="onSmilesSelectSmile" @selectSet="onSmilesSelectSet"/>\n\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t</keep-alive>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t\t<div v-if="showTextarea || startNewChatMode" class="bx-livechat-textarea" :style="[textareaHeightStyle, textareaBottomMargin]" ref="textarea">\n\t\t\t\t\t\t\t<div class="bx-livechat-textarea-resize-handle" @mousedown="onTextareaStartDrag" @touchstart="onTextareaStartDrag"></div>\n\t\t\t\t\t\t\t<bx-im-component-textarea\n\t\t\t\t\t\t\t\t:siteId="application.common.siteId"\n\t\t\t\t\t\t\t\t:userId="application.common.userId"\n\t\t\t\t\t\t\t\t:dialogId="application.dialog.dialogId"\n\t\t\t\t\t\t\t\t:writesEventLetter="3"\n\t\t\t\t\t\t\t\t:enableEdit="true"\n\t\t\t\t\t\t\t\t:enableCommand="false"\n\t\t\t\t\t\t\t\t:enableMention="false"\n\t\t\t\t\t\t\t\t:enableFile="application.disk.enabled"\n\t\t\t\t\t\t\t\t:autoFocus="application.device.type !== DeviceType.mobile"\n\t\t\t\t\t\t\t\t:styles="{button: {backgroundColor: widget.common.styles.backgroundColor, iconColor: widget.common.styles.iconColor}}"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div v-if="!widget.common.copyright && !isBottomLocation" class="bx-livechat-nocopyright-resize-wrap" style="position: relative;">\n\t\t\t\t\t\t\t<div class="bx-livechat-widget-resize-handle" @mousedown="onWidgetStartDrag"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<bx-livechat-form-consent />\n\t\t\t\t\t\t<template v-if="widget.common.copyright">\n\t\t\t\t\t\t\t<div class="bx-livechat-copyright">\n\t\t\t\t\t\t\t\t<template v-if="widget.common.copyrightUrl">\n\t\t\t\t\t\t\t\t\t<a class="bx-livechat-copyright-link" :href="widget.common.copyrightUrl" target="_blank">\n\t\t\t\t\t\t\t\t\t\t<span class="bx-livechat-logo-name">{{localize.BX_LIVECHAT_COPYRIGHT_TEXT}}</span>\n\t\t\t\t\t\t\t\t\t\t<span class="bx-livechat-logo-icon"></span>\n\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t\t\t\t<span class="bx-livechat-logo-name">{{localize.BX_LIVECHAT_COPYRIGHT_TEXT}}</span>\n\t\t\t\t\t\t\t\t\t<span class="bx-livechat-logo-icon"></span>\n\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t<div v-if="!isBottomLocation() && !isPageMode()" class="bx-livechat-widget-resize-handle" @mousedown="onWidgetStartDrag"></div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</template>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</transition>\n\t'});function ce(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function fe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ce(Object(n),!0).forEach((function(t){babelHelpers.defineProperty(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ce(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}_.WidgetBitrixVue.component("bx-livechat-body-error",{computed:fe({},E.WidgetVuex.mapState({application:function e(t){return t.application}})),template:'\n\t\t<div class="bx-livechat-body" key="error-body">\n\t\t\t<div class="bx-livechat-warning-window">\n\t\t\t\t<div class="bx-livechat-warning-icon"></div>\n\t\t\t\t<template v-if="application.error.description"> \n\t\t\t\t\t<div class="bx-livechat-help-title bx-livechat-help-title-sm bx-livechat-warning-msg" v-html="application.error.description"></div>\n\t\t\t\t</template> \n\t\t\t\t<template v-else>\n\t\t\t\t\t<div class="bx-livechat-help-title bx-livechat-help-title-md bx-livechat-warning-msg">{{$Bitrix.Loc.getMessage(\'BX_LIVECHAT_ERROR_TITLE\')}}</div>\n\t\t\t\t\t<div class="bx-livechat-help-title bx-livechat-help-title-sm bx-livechat-warning-msg">{{$Bitrix.Loc.getMessage(\'BX_LIVECHAT_ERROR_DESC\')}}</div>\n\t\t\t\t</template> \n\t\t\t</div>\n\t\t</div>\n\t'});function de(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function he(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?de(Object(n),!0).forEach((function(t){babelHelpers.defineProperty(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):de(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}_.WidgetBitrixVue.component("bx-livechat-head",{props:{isWidgetDisabled:{default:false}},data:function e(){return{multiDialog:false}},methods:{openDialogList:function e(){x.EventEmitter.emit(W.hideForm);this.$emit("openDialogList")},close:function e(t){this.$emit("close")},like:function e(){x.EventEmitter.emit(W.showForm,{type:D.like})},openMenu:function e(t){this.$emit("openMenu",t)}},computed:he({VoteType:function e(){return O},chatId:function e(){if(this.application){return this.application.dialog.chatId}},customBackgroundStyle:function e(t){return t.widget.common.styles.backgroundColor?"background-color: "+t.widget.common.styles.backgroundColor+"!important;":""},customBackgroundOnlineStyle:function e(t){return t.widget.common.styles.backgroundColor?"border-color: "+t.widget.common.styles.backgroundColor+"!important;":""},showName:function e(t){return t.widget.dialog.operator.firstName||t.widget.dialog.operator.lastName},voteActive:function e(t){if(!!t.widget.dialog.closeVote){return false}if(!t.widget.common.vote.beforeFinish&&t.widget.dialog.sessionStatus<U.waitClient){return false}if(!t.widget.dialog.sessionClose||t.widget.dialog.sessionClose&&t.widget.dialog.userVote===O.none){return true}if(t.widget.dialog.sessionClose&&t.widget.dialog.userVote!==O.none){return true}return false},chatTitle:function e(t){return t.widget.common.textMessages.bxLivechatTitle||t.widget.common.configName||this.localize.BX_LIVECHAT_TITLE},operatorName:function e(t){if(!this.showName)return"";return t.widget.dialog.operator.firstName?t.widget.dialog.operator.firstName:t.widget.dialog.operator.name},operatorDescription:function e(t){if(!this.showName){return""}var n=t.widget.dialog.operator.workPosition?t.widget.dialog.operator.workPosition:this.localize.BX_LIVECHAT_USER;if(t.widget.common.showSessionId&&t.widget.dialog.sessionId>=0){return this.localize.BX_LIVECHAT_OPERATOR_POSITION_AND_SESSION_ID.replace("#POSITION#",n).replace("#ID#",t.widget.dialog.sessionId)}return this.localize.BX_LIVECHAT_OPERATOR_POSITION_ONLY.replace("#POSITION#",n)},localize:function e(){return _.WidgetBitrixVue.getFilteredPhrases("BX_LIVECHAT_",this)},ie11:function e(){return C.Browser.isIE11()}},E.WidgetVuex.mapState({widget:function e(t){return t.widget},application:function e(t){return t.application}})),watch:{showName:function e(t){var n=this;if(t){setTimeout((function(){n.$root.$emit(k.EventType.dialog.scrollToBottom,{chatId:n.chatId})}),300)}}},template:'\n\t\t<div class="bx-livechat-head-wrap">\n\t\t\t<template v-if="isWidgetDisabled">\n\t\t\t\t<div class="bx-livechat-head" :style="customBackgroundStyle">\n\t\t\t\t\t<div class="bx-livechat-title">{{chatTitle}}</div>\n\t\t\t\t\t<div class="bx-livechat-control-box">\n\t\t\t\t\t\t<button v-if="!widget.common.pageMode" class="bx-livechat-control-btn bx-livechat-control-btn-close" :title="localize.BX_LIVECHAT_CLOSE_BUTTON" @click="close"></button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\t\n\t\t\t</template>\n\t\t\t<template v-else-if="application.error.active">\n\t\t\t\t<div class="bx-livechat-head" :style="customBackgroundStyle">\n\t\t\t\t\t<div class="bx-livechat-title">{{chatTitle}}</div>\n\t\t\t\t\t<div class="bx-livechat-control-box">\n\t\t\t\t\t\t<button v-if="!widget.common.pageMode" class="bx-livechat-control-btn bx-livechat-control-btn-close" :title="localize.BX_LIVECHAT_CLOSE_BUTTON" @click="close"></button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t\t<template v-else-if="!widget.common.configId">\n\t\t\t\t<div class="bx-livechat-head" :style="customBackgroundStyle">\n\t\t\t\t\t<div class="bx-livechat-title">{{chatTitle}}</div>\n\t\t\t\t\t<div class="bx-livechat-control-box">\n\t\t\t\t\t\t<button v-if="!widget.common.pageMode" class="bx-livechat-control-btn bx-livechat-control-btn-close" :title="localize.BX_LIVECHAT_CLOSE_BUTTON" @click="close"></button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</template>\t\t\t\n\t\t\t<template v-else>\n\t\t\t\t<div class="bx-livechat-head" :style="customBackgroundStyle">\n\t\t\t\t\t<template v-if="!showName">\n\t\t\t\t\t\t<div class="bx-livechat-title">{{chatTitle}}</div>\n\t\t\t\t\t</template>\n\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t<div class="bx-livechat-user bx-livechat-status-online">\n\t\t\t\t\t\t\t<template v-if="widget.dialog.operator.avatar">\n\t\t\t\t\t\t\t\t<div class="bx-livechat-user-icon" :style="\'background-image: url(\'+encodeURI(widget.dialog.operator.avatar)+\')\'">\n\t\t\t\t\t\t\t\t\t<div v-if="widget.dialog.operator.online" class="bx-livechat-user-status" :style="customBackgroundOnlineStyle"></div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t\t\t<div class="bx-livechat-user-icon">\n\t\t\t\t\t\t\t\t\t<div v-if="widget.dialog.operator.online" class="bx-livechat-user-status" :style="customBackgroundOnlineStyle"></div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="bx-livechat-user-info">\n\t\t\t\t\t\t\t<div class="bx-livechat-user-name">{{operatorName}}</div>\n\t\t\t\t\t\t\t<div class="bx-livechat-user-position">{{operatorDescription}}</div>\t\t\t\t\t\t\t\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</template>\n\t\t\t\t\t<div class="bx-livechat-control-box">\n\t\t\t\t\t\t<span class="bx-livechat-control-box-active" v-if="widget.common.dialogStart && widget.dialog.sessionId">\n\t\t\t\t\t\t\t<button v-if="widget.common.vote.enable && voteActive" :class="\'bx-livechat-control-btn bx-livechat-control-btn-like bx-livechat-dialog-vote-\'+(widget.dialog.userVote)" :title="localize.BX_LIVECHAT_VOTE_BUTTON" @click="like"></button>\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\tv-if="!ie11 && application.dialog.chatId > 0"\n\t\t\t\t\t\t\t\tclass="bx-livechat-control-btn bx-livechat-control-btn-menu"\n\t\t\t\t\t\t\t\t@click="openMenu"\n\t\t\t\t\t\t\t\t:title="localize.BX_LIVECHAT_DOWNLOAD_HISTORY"\n\t\t\t\t\t\t\t></button>\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\tv-if="multiDialog && application.dialog.chatId > 0"\n\t\t\t\t\t\t\t\tclass="bx-livechat-control-btn bx-livechat-control-btn-list"\n\t\t\t\t\t\t\t\t@click="openDialogList"\n\t\t\t\t\t\t\t></button>\n\t\t\t\t\t\t</span>\t\n\t\t\t\t\t\t<button v-if="!widget.common.pageMode" class="bx-livechat-control-btn bx-livechat-control-btn-close" :title="localize.BX_LIVECHAT_CLOSE_BUTTON" @click="close"></button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t</div>\n\t'});_.WidgetBitrixVue.component("bx-livechat-body-loading",{template:'\n\t\t<div class="bx-livechat-loading-window">\n\t\t\t<svg class="bx-livechat-loading-circular" viewBox="25 25 50 50">\n\t\t\t\t<circle class="bx-livechat-loading-path" cx="50" cy="50" r="20" fill="none" stroke-miterlimit="10"/>\n\t\t\t\t<circle class="bx-livechat-loading-inner-path" cx="50" cy="50" r="20" fill="none" stroke-miterlimit="10"/>\n\t\t\t</svg>\n\t\t\t<h3 class="bx-livechat-help-title bx-livechat-help-title-md bx-livechat-loading-msg">{{$Bitrix.Loc.getMessage(\'BX_LIVECHAT_LOADING\')}}</h3>\n\t\t</div>\n\t'});function pe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function me(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?pe(Object(n),!0).forEach((function(t){babelHelpers.defineProperty(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}_.WidgetBitrixVue.component("bx-livechat-body-operators",{computed:me({},E.WidgetVuex.mapState({widget:function e(t){return t.widget}})),template:'\n\t\t<div class="bx-livechat-help-container">\n\t\t\t<transition name="bx-livechat-animation-fade">\n\t\t\t\t<h2 v-if="widget.common.online" key="online" class="bx-livechat-help-title bx-livechat-help-title-lg">{{widget.common.textMessages.bxLivechatOnlineLine1}}<div class="bx-livechat-help-subtitle">{{widget.common.textMessages.bxLivechatOnlineLine2}}</div></h2>\n\t\t\t\t<h2 v-else key="offline" class="bx-livechat-help-title bx-livechat-help-title-sm">{{widget.common.textMessages.bxLivechatOffline}}</h2>\n\t\t\t</transition>\t\n\t\t\t<div class="bx-livechat-help-user">\n\t\t\t\t<template v-for="operator in widget.common.operators">\n\t\t\t\t\t<div class="bx-livechat-user" :key="operator.id">\n\t\t\t\t\t\t<template v-if="operator.avatar">\n\t\t\t\t\t\t\t<div class="bx-livechat-user-icon" :style="\'background-image: url(\'+encodeURI(operator.avatar)+\')\'"></div>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t\t<div class="bx-livechat-user-icon"></div>\n\t\t\t\t\t\t</template>\t\n\t\t\t\t\t\t<div class="bx-livechat-user-info">\n\t\t\t\t\t\t\t<div class="bx-livechat-user-name">{{operator.firstName? operator.firstName: operator.name}}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</template>\t\n\t\t\t</div>\n\t\t</div>\n\t'});function ge(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function ve(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ge(Object(n),!0).forEach((function(t){babelHelpers.defineProperty(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ge(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}_.WidgetBitrixVue.component("bx-livechat-dialogues-list",{data:function e(){return{newChatMode:false,sessionList:[],isLoading:false,pagesLoaded:0,hasMoreItemsToLoad:true,itemsPerPage:25}},computed:ve({},E.WidgetVuex.mapState({dialogues:function e(t){return t.dialogues}})),mounted:function e(){this.requestDialogList()},methods:{requestDialogList:function e(){var t=this;var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;this.isLoading=true;var i={CONFIG_ID:this.$Bitrix.Application.get().getConfigId()};if(n>0){i["OFFSET"]=n}return this.$Bitrix.Application.get().controller.restClient.callMethod(N.widgetDialogList,i).then((function(e){if(e.data().length===0||e.data().length<t.itemsPerPage){t.hasMoreItemsToLoad=false}t.pagesLoaded++;t.isLoading=false;t.sessionList=[].concat(babelHelpers.toConsumableArray(t.sessionList),babelHelpers.toConsumableArray(t.prepareSessionList(e.data())))}))["catch"]((function(e){console.warn("error",e)}))},prepareSessionList:function e(t){return Object.values(t).map((function(e){return{chatId:e.chatId,dialogId:e.dialogId,name:"Dialog #".concat(e.sessionId)}}))},openSession:function e(t){x.EventEmitter.emit(W.openSession,t)},startNewChat:function e(t){this.newChatMode=true;this.$emit("startNewChat",t)},isOneScreenRemaining:function e(t){return t.target.scrollTop+t.target.clientHeight>=t.target.scrollHeight-t.target.clientHeight},onScroll:function e(t){if(this.isOneScreenRemaining(t)){if(this.isLoading||!this.hasMoreItemsToLoad){return}var n=this.itemsPerPage*this.pagesLoaded;this.requestDialogList(n)}}},template:'\n\t<div class="bx-livechat-help-container" style=" height: 100%; display: flex; flex-direction: column; justify-content: space-between;">\n\t\t<div \n\t\t\tstyle="margin-top: 25px;overflow-y: scroll;position:relative"\n\t\t\t:style="{marginBottom: newChatMode ? 0 : \'10px\'}"\n\t\t\t@scroll="onScroll"\n\t\t>\n\t\t\t<div\n\t\t\t\tv-for="session in sessionList"\n\t\t\t\t:key="session.chatId"\n\t\t\t\tclass="bx-livechat-help-subtitle"\n\t\t\t\t@click="openSession({event: $event, session: session})"\n\t\t\t\tstyle="cursor: pointer; border: solid 1px black;border-radius: 10px;margin: 10px;padding: 5px;background-color: #0ae4ff">\n\t\t\t\t{{ session.name }}\n\t\t\t</div>\n\t\t\t<div v-if="isLoading" style="margin: 10px">Loading</div>\n\t\t</div>\n\t\t\n\t\t<div v-if="!newChatMode" style="margin-bottom: 10px;">\n\t\t\t<button \n\t\t\t\tclass="bx-livechat-btn" \n\t\t\t\tstyle="background-color: rgb(23, 163, 234); border-radius: 5px;width: 150px;" \n\t\t\t\t@click="startNewChat">\n\t\t\t\tStart new chat!\n\t\t\t</button>\n\t\t</div>\n\t</div>\n\t'});_.WidgetBitrixVue.component("bx-livechat-body-orientation-disabled",{template:'\n\t\t<div class="bx-livechat-body" key="orientation-head">\n\t\t\t<div class="bx-livechat-mobile-orientation-box">\n\t\t\t\t<div class="bx-livechat-mobile-orientation-icon"></div>\n\t\t\t\t<div class="bx-livechat-mobile-orientation-text">{{$Bitrix.Loc.getMessage(\'BX_LIVECHAT_MOBILE_ROTATE\')}}</div>\n\t\t\t</div>\n\t\t</div>\n\t'});function ye(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function be(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ye(Object(n),!0).forEach((function(t){babelHelpers.defineProperty(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ye(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}_.WidgetBitrixVue.component("bx-livechat-form-consent",{computed:be({},E.WidgetVuex.mapState({widget:function e(t){return t.widget}})),methods:{agree:function e(){x.EventEmitter.emit(W.acceptConsent)},disagree:function e(){x.EventEmitter.emit(W.declineConsent)},onShow:function e(t,n){t.classList.add("bx-livechat-consent-window-show");n()},onHide:function e(t,n){t.classList.remove("bx-livechat-consent-window-show");t.classList.add("bx-livechat-consent-window-close");setTimeout((function(){n()}),400)},onKeyDown:function e(t){if(t.keyCode==9){if(t.target===this.$refs.iframe){if(t.shiftKey){this.$refs.cancel.focus()}else{this.$refs.success.focus()}}else if(t.target===this.$refs.success){if(t.shiftKey){this.$refs.iframe.focus()}else{this.$refs.cancel.focus()}}else if(t.target===this.$refs.cancel){if(t.shiftKey){this.$refs.success.focus()}else{this.$refs.iframe.focus()}}t.preventDefault()}else if(t.keyCode==39||t.keyCode==37){if(t.target.nextElementSibling){t.target.nextElementSibling.focus()}else if(t.target.previousElementSibling){t.target.previousElementSibling.focus()}t.preventDefault()}}},directives:{focus:{inserted:function e(t,n){t.focus()}}},template:'\n\t\t<transition @enter="onShow" @leave="onHide">\n\t\t\t<template v-if="widget.common.showConsent && widget.common.consentUrl">\n\t\t\t\t<div class="bx-livechat-consent-window">\n\t\t\t\t\t<div class="bx-livechat-consent-window-title">{{$Bitrix.Loc.getMessage(\'BX_LIVECHAT_CONSENT_TITLE\')}}</div>\n\t\t\t\t\t<div class="bx-livechat-consent-window-content">\n\t\t\t\t\t\t<iframe class="bx-livechat-consent-window-content-iframe" ref="iframe" frameborder="0" marginheight="0"  marginwidth="0" allowtransparency="allow-same-origin" seamless="true" :src="widget.common.consentUrl" @keydown="onKeyDown"></iframe>\n\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\n\t\t\t\t\t<div class="bx-livechat-consent-window-btn-box">\n\t\t\t\t\t\t<button class="bx-livechat-btn bx-livechat-btn-success" ref="success" @click="agree" @keydown="onKeyDown" v-focus>{{$Bitrix.Loc.getMessage(\'BX_LIVECHAT_CONSENT_AGREE\')}}</button>\n\t\t\t\t\t\t<button class="bx-livechat-btn bx-livechat-btn-cancel" ref="cancel" @click="disagree" @keydown="onKeyDown">{{$Bitrix.Loc.getMessage(\'BX_LIVECHAT_CONSENT_DISAGREE\')}}</button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t</transition>\n\t'});function we(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function Se(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?we(Object(n),!0).forEach((function(t){babelHelpers.defineProperty(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):we(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}_.WidgetBitrixVue.component("bx-livechat-form-vote",{computed:Se({VoteType:function e(){return O}},E.WidgetVuex.mapState({widget:function e(t){return t.widget}})),methods:{userVote:function e(t){x.EventEmitter.emit(W.hideForm);this.$store.commit("widget/dialog",{userVote:t});x.EventEmitter.emit(W.sendDialogVote,{vote:t})},hideForm:function e(){x.EventEmitter.emit(W.hideForm)}},template:'\n\t\t<transition enter-active-class="bx-livechat-consent-window-show" leave-active-class="bx-livechat-form-close">\n\t\t\t<div class="bx-livechat-alert-box bx-livechat-form-rate-show" key="vote">\n\t\t\t\t<div class="bx-livechat-alert-close" @click="hideForm"></div>\n\t\t\t\t<div class="bx-livechat-alert-rate-box">\n\t\t\t\t\t<h4 class="bx-livechat-alert-title bx-livechat-alert-title-mdl">{{widget.common.vote.messageText}}</h4>\n\t\t\t\t\t<div class="bx-livechat-btn-box">\n\t\t\t\t\t\t<button class="bx-livechat-btn bx-livechat-btn-like" @click="userVote(VoteType.like)" :title="widget.common.vote.messageLike"></button>\n\t\t\t\t\t\t<button class="bx-livechat-btn bx-livechat-btn-dislike" @click="userVote(VoteType.dislike)" :title="widget.common.vote.messageDislike"></button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</transition>\t\n\t'});_.WidgetVue.cloneComponent("bx-livechat-smiles","bx-smiles",{methods:{hideForm:function e(){x.EventEmitter.emit(W.hideForm)}},template:'\n\t\t<transition enter-active-class="bx-livechat-consent-window-show" leave-active-class="bx-livechat-form-close">\n\t\t\t<div class="bx-livechat-alert-box bx-livechat-alert-box-zero-padding bx-livechat-form-show" key="vote">\n\t\t\t\t<div class="bx-livechat-alert-close" @click="hideForm"></div>\n\t\t\t\t<div class="bx-livechat-alert-smiles-box">\n\t\t\t\t\t#PARENT_TEMPLATE#\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</transition>\n\t'});BX.LiveChatWidget=J;BX.LiveChatWidget.VoteType=O;BX.LiveChatWidget.SubscriptionType=H;BX.LiveChatWidget.LocationStyle=P;BX.LiveChatWidget.Cookie=m.Cookie;window.dispatchEvent(new CustomEvent("onBitrixLiveChatSourceLoaded",{detail:{}}))})(this.window=this.window||{},BX,window,window,BX.Messenger,window,BX,window,window,BX,BX.Messenger.Provider.Rest,BX.Main,BX,BX.Ui.Vue.Components.Crm,BX.Messenger,BX.Messenger.Lib,BX.Messenger.Lib,BX.Messenger.Lib,BX,BX.Messenger.Lib,BX,BX.Messenger.Lib,BX.Messenger,BX.Messenger.Const,BX,BX,BX,BX.Event);
//# sourceMappingURL=script.map.js