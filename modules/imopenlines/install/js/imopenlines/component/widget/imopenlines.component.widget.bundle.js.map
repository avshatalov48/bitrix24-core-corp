{"version":3,"file":"imopenlines.component.widget.bundle.js","sources":["imopenlines.component.widget.js"],"sourcesContent":["import \"./imopenlines.component.widget.css\";\n\n/* region 00. Startup operations */\nconst GetObjectValues = function(source)\n{\n\tconst destination = [];\n\tfor (let value in source)\n\t{\n\t\tif (source.hasOwnProperty(value))\n\t\t{\n\t\t\tdestination.push(source[value]);\n\t\t}\n\t}\n\treturn destination;\n};\n/* endregion 00. Startup operations */\n\n/* region 01. Constants */\n\nconst VoteType = Object.freeze({\n\tnone: 'none',\n\tlike: 'like',\n\tdislike: 'dislike',\n});\n\nconst DeviceOrientation = Object.freeze({\n\thorizontal: 'horizontal',\n\tportrait: 'portrait',\n});\n\nconst DeviceType = Object.freeze({\n\tmobile: 'mobile',\n\tdesktop: 'desktop',\n});\n\nconst LanguageType = Object.freeze({\n\trussian: 'ru',\n\tukraine: 'ua',\n\tworld: 'en',\n});\n\nconst FormType = Object.freeze({\n\tnone: 'none',\n\tlike: 'like',\n\tsmile: 'smile',\n\tconsent: 'consent',\n\twelcome: 'welcome',\n\toffline: 'offline',\n\thistory: 'history',\n});\n\nconst LocationType = Object.freeze({\n\ttopLeft: 1,\n\ttopMiddle: 2,\n\ttopBottom: 3,\n\tbottomLeft: 6,\n\tbottomMiddle: 5,\n\tbottomRight: 4,\n});\n\nconst LocationStyle = Object.freeze({\n\t1: 'top-left',\n\t2: 'top-center',\n\t3: 'top-right',\n\t6: 'bottom-left',\n\t5: 'bottom-center',\n\t4: 'bottom-right',\n});\n\nconst SubscriptionType = Object.freeze({\n\tconfigLoaded: 'configLoaded',\n\twidgetOpen: 'widgetOpen',\n\twidgetClose: 'widgetClose',\n\tsessionStart: 'sessionStart',\n\tsessionOperatorChange: 'sessionOperatorChange',\n\tsessionFinish: 'sessionFinish',\n\toperatorMessage: 'operatorMessage',\n\tuserForm: 'userForm',\n\tuserMessage: 'userMessage',\n\tuserVote: 'userVote',\n\tevery: 'every',\n});\nconst SubscriptionTypeCheck = GetObjectValues(SubscriptionType);\n\nconst WidgetStore = Object.freeze({\n\tdialogData: 'widget/dialogData',\n\twidgetData: 'widget/widgetData',\n\tuserData: 'widget/userData',\n});\n\nconst MessengerStore = Object.freeze({\n\tmessages: BX.Messenger.Model.Messages.getName(),\n\tdialogues: BX.Messenger.Model.Dialogues.getName(),\n\tusers: BX.Messenger.Model.Users.getName(),\n\tfiles: BX.Messenger.Model.Files.getName(),\n});\n\nconst MessengerMessageStore = Object.freeze({\n\tinitCollection: MessengerStore.messages+'/initCollection',\n\tadd: MessengerStore.messages+'/add',\n\tset: MessengerStore.messages+'/set',\n\tsetBefore: MessengerStore.messages+'/setBefore',\n\tupdate: MessengerStore.messages+'/update',\n\tdelete: MessengerStore.messages+'/delete',\n\tactionStart: MessengerStore.messages+'/actionStart',\n\tactionFinish: MessengerStore.messages+'/actionFinish',\n\tactionError: MessengerStore.messages+'/actionError',\n\treadMessages: MessengerStore.messages+'/readMessages',\n});\n\nconst MessengerMessageGetters = Object.freeze({\n\tgetLastId: MessengerStore.messages+'/getLastId',\n});\n\nconst MessengerUserStore = Object.freeze({\n\tset: MessengerStore.users+'/set',\n\tupdate: MessengerStore.users+'/update',\n\tdelete: MessengerStore.users+'/delete',\n});\n\nconst MessengerFileStore = Object.freeze({\n\tinitCollection: MessengerStore.files+'/initCollection',\n\tset: MessengerStore.files+'/set',\n\tsetBefore: MessengerStore.files+'/setBefore',\n\tupdate: MessengerStore.files+'/update',\n\tdelete: MessengerStore.dialogues+'/delete',\n});\n\nconst MessengerDialogStore = Object.freeze({\n\tinitCollection: MessengerStore.dialogues+'/initCollection',\n\tset: MessengerStore.dialogues+'/set',\n\tupdate: MessengerStore.dialogues+'/update',\n\tupdateWriting: MessengerStore.dialogues+'/updateWriting',\n\tdecreaseCounter: MessengerStore.dialogues+'/decreaseCounter',\n\tincreaseCounter: MessengerStore.dialogues+'/increaseCounter',\n\tdelete: MessengerStore.dialogues+'/delete',\n});\n\n\nconst RestMethod = Object.freeze({\n\twidgetUserRegister: 'imopenlines.widget.user.register',\n\twidgetConfigGet: 'imopenlines.widget.config.get',\n\twidgetDialogGet: 'imopenlines.widget.dialog.get',\n\twidgetUserGet: 'imopenlines.widget.user.get',\n\twidgetUserConsentApply: 'imopenlines.widget.user.consent.apply',\n\twidgetVoteSend: 'imopenlines.widget.vote.send',\n\twidgetFormSend: 'imopenlines.widget.form.send',\n\n\tpullServerTime: 'server.time',\n\tpullConfigGet: 'pull.config.get',\n\n\timMessageAdd: 'im.message.add',\n\timMessageUpdate: 'im.message.update', // TODO: method is not implemented\n\timMessageDelete: 'im.message.delete', // TODO: method is  not implemented\n\timMessageLike: 'im.message.like', // TODO: method is  not implemented\n\timChatGet: 'im.chat.get',\n\timChatSendTyping: 'im.chat.sendTyping',\n\timDialogMessagesGet: 'im.dialog.messages.get',\n\timDialogMessagesUnread: 'im.dialog.messages.unread',\n\timDialogRead: 'im.dialog.read',\n\n\tdiskFolderGet: 'im.disk.folder.get',\n\tdiskFileUpload: 'disk.folder.uploadfile',\n\tdiskFileCommit: 'im.disk.file.commit',\n});\nconst RestMethodCheck = GetObjectValues(RestMethod);\n\nconst RestAuth = Object.freeze({\n\tguest: 'guest',\n});\n\n/* endregion 01. Constants */\n\n/* region 02. Widget public interface */\n\nclass LiveChatWidget\n{\n\tconstructor(config)\n\t{\n\t\tthis.developerInfo = 'Do not use private methods.';\n\t\tthis.__privateMethods__ = new LiveChatWidgetPrivate(config);\n\n\t\tthis.createLegacyMethods();\n\t}\n\n\topen(params)\n\t{\n\t\treturn this.__privateMethods__.open(params);\n\t}\n\n\tclose()\n\t{\n\t\treturn this.__privateMethods__.close();\n\t}\n\n\tshowNotification(params)\n\t{\n\t\treturn this.__privateMethods__.showNotification(params);\n\t}\n\n\tgetUserData()\n\t{\n\t\treturn this.__privateMethods__.getUserData();\n\t}\n\n\tsetUserRegisterData(params)\n\t{\n\t\treturn this.__privateMethods__.setUserRegisterData(params);\n\t}\n\n\tsetCustomData(params)\n\t{\n\t\treturn this.__privateMethods__.setCustomData(params);\n\t}\n\n\tmutateTemplateComponent(id, params)\n\t{\n\t\treturn this.__privateMethods__.mutateTemplateComponent(id, params);\n\t}\n\n\taddLocalize(phrases)\n\t{\n\t\treturn this.__privateMethods__.addLocalize(phrases);\n\t}\n\n\t/**\n\t *\n\t * @param params {Object}\n\t * @returns {Function|Boolean} - Unsubscribe callback function or False\n\t */\n\tsubscribe(params)\n\t{\n\t\treturn this.__privateMethods__.subscribe(params);\n\t}\n\n\tstart()\n\t{\n\t\treturn this.__privateMethods__.start();\n\t}\n\n\tcreateLegacyMethods()\n\t{\n\t\tif (typeof window.BX.LiveChat === 'undefined')\n\t\t{\n\t\t\tlet sourceHref = document.createElement('a');\n\t\t\tsourceHref.href = this.__privateMethods__.host;\n\n\t\t\tlet sourceDomain = sourceHref.protocol+'//'+sourceHref.hostname+(sourceHref.port && sourceHref.port != '80' && sourceHref.port != '443'? \":\"+sourceHref.port: \"\");\n\n\t\t\twindow.BX.LiveChat = {\n\t\t\t\topenLiveChat: () => {\n\t\t\t\t\tthis.open({openFromButton: true});\n\t\t\t\t},\n\t\t\t\tcloseLiveChat: () => {\n\t\t\t\t\tthis.close();\n\t\t\t\t},\n\t\t\t\taddEventListener: (el, eventName, handler) =>\n\t\t\t\t{\n\t\t\t\t\tif (eventName === 'message')\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.subscribe({\n\t\t\t\t\t\t\ttype: SubscriptionType.userMessage,\n\t\t\t\t\t\t\tcallback: function (event)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\thandler({origin: sourceDomain, data: JSON.stringify({action: 'sendMessage'}), event});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tconsole.warn('Method BX.LiveChat.addEventListener is not supported, user new format for subscribe.')\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tsetCookie: () => {},\n\t\t\t\tgetCookie: () => {},\n\t\t\t\tsourceDomain\n\t\t\t};\n\t\t}\n\n\t\tif (typeof window.BxLiveChatInit === 'function')\n\t\t{\n\t\t\tlet config = window.BxLiveChatInit();\n\n\t\t\tif (config.user)\n\t\t\t{\n\t\t\t\tthis.__privateMethods__.setUserRegisterData(config.user);\n\t\t\t}\n\t\t\tif (config.firstMessage)\n\t\t\t{\n\t\t\t\tthis.__privateMethods__.setCustomData(config.firstMessage)\n\t\t\t}\n\t\t}\n\n\t\tif (window.BxLiveChatLoader instanceof Array)\n\t\t{\n\t\t\twindow.BxLiveChatLoader.forEach(callback => callback());\n\t\t}\n\n\t\treturn true;\n\t}\n}\n\n/* endregion 02. Widget public interface */\n\n/* region 03. Widget private interface */\nclass LiveChatWidgetPrivate\n{\n/* region 03-01. Initialize and store data */\n\n\tconstructor(params = {})\n\t{\n\t\tthis.ready = true;\n\t\tthis.widgetDataRequested = false;\n\n\t\tthis.offline = false;\n\n\t\tthis.code = params.code || '';\n\t\tthis.host = params.host || '';\n\t\tthis.language = params.language || 'en';\n\t\tthis.copyright = params.copyright !== false;\n\t\tthis.copyrightUrl = this.copyright && params.copyrightUrl? params.copyrightUrl: '';\n\t\tthis.buttonInstance = typeof params.buttonInstance === 'object' && params.buttonInstance !== null? params.buttonInstance: null;\n\n\n\t\tthis.pageMode = typeof params.pageMode === 'object' && params.pageMode;\n\t\tif (this.pageMode)\n\t\t{\n\t\t\tthis.pageMode.useBitrixLocalize = params.pageMode.useBitrixLocalize === true;\n\t\t\tthis.pageMode.placeholder = document.getElementById(params.pageMode.placeholder);\n\t\t}\n\n\t\tif (typeof this.code === 'string')\n\t\t{\n\t\t\tif (this.code.length <= 0)\n\t\t\t{\n\t\t\t\tconsole.warn(`%cLiveChatWidget.constructor: code is not correct (%c${this.code}%c)`, \"color: black;\", \"font-weight: bold; color: red\", \"color: black\");\n\t\t\t\tthis.ready = false;\n\t\t\t}\n\t\t}\n\n\t\tif (typeof this.host === 'string')\n\t\t{\n\t\t\tif (this.host.length <= 0 || !this.host.startsWith('http'))\n\t\t\t{\n\t\t\t\tconsole.warn(`%cLiveChatWidget.constructor: host is not correct (%c${this.host}%c)`, \"color: black;\", \"font-weight: bold; color: red\", \"color: black\");\n\t\t\t\tthis.ready = false;\n\t\t\t}\n\t\t}\n\n\t\tthis.inited = false;\n\t\tthis.initEventFired = false;\n\n\t\tthis.restClient = null;\n\t\tthis.pullClient = null;\n\n\t\tthis.userRegisterData = {};\n\t\tthis.customData = [];\n\n\t\tthis.localize = this.pageMode && this.pageMode.useBitrixLocalize? BX.message: {};\n\t\tthis.subscribers = {};\n\t\tthis.dateFormat = null;\n\n\t\tthis.messagesQueue = [];\n\t\tthis.filesQueue = [];\n\t\tthis.filesQueueIndex = 0;\n\n\t\tthis.messageLastReadId = null;\n\t\tthis.messageReadQueue = [];\n\n\t\tthis.defaultMessageLimit = 20;\n\t\tthis.requestMessageLimit = this.defaultMessageLimit;\n\n\t\tthis.configRequestXhr = null;\n\n\t\tconst widgetData = {};\n\t\tif (params.location && typeof LocationStyle[params.location] !== 'undefined')\n\t\t{\n\t\t\twidgetData.location = params.location;\n\t\t}\n\t\tif (\n\t\t\tBX.Messenger.Utils.types.isPlainObject(params.styles)\n\t\t\t&& (params.styles.backgroundColor || params.styles.iconColor)\n\t\t)\n\t\t{\n\t\t\tif (typeof widgetData.styles === 'undefined')\n\t\t\t{\n\t\t\t\twidgetData.styles = {};\n\t\t\t}\n\t\t\tif (params.styles.backgroundColor)\n\t\t\t{\n\t\t\t\twidgetData.styles.backgroundColor = params.styles.backgroundColor;\n\t\t\t}\n\t\t\tif (params.styles.iconColor)\n\t\t\t{\n\t\t\t\twidgetData.styles.iconColor = params.styles.iconColor;\n\t\t\t}\n\t\t}\n\n\t\t/* store data */\n\t\tthis.store = new BX.Vuex.store({\n\t\t\tname: 'Bitrix LiveChat Widget ('+this.code+' / '+this.host+')',\n\t\t\tmodules: {\n\t\t\t\twidget: this.getWidgetStore({widgetData}),\n\t\t\t\t[MessengerStore.messages]: BX.Messenger.Model.Messages.getInstance().getStore(),\n\t\t\t\t[MessengerStore.dialogues]: BX.Messenger.Model.Dialogues.getInstance().getStore({host: this.host}),\n\t\t\t\t[MessengerStore.users]: BX.Messenger.Model.Users.getInstance().getStore({host: this.host}),\n\t\t\t\t[MessengerStore.files]: BX.Messenger.Model.Files.getInstance().getStore({host: this.host}),\n\t\t\t}\n\t\t});\n\n\t\tif (this.pageMode && this.pageMode.placeholder)\n\t\t{\n\t\t\tthis.rootNode = this.pageMode.placeholder;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.rootNode = document.createElement('div');\n\t\t\tif (document.body.firstChild)\n\t\t\t{\n\t\t\t\tdocument.body.insertBefore(this.rootNode, document.body.firstChild);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tdocument.body.appendChild(this.rootNode);\n\t\t\t}\n\t\t}\n\n\t\tthis.template = null;\n\n\t\twindow.addEventListener('orientationchange', () =>\n\t\t{\n\t\t\tthis.store.commit(WidgetStore.widgetData, {deviceOrientation: BX.Messenger.Utils.device.getOrientation()});\n\n\t\t\tif (\n\t\t\t\tthis.store.state.widget.widgetData.showed\n\t\t\t\t&& this.store.state.widget.widgetData.deviceType == DeviceType.mobile\n\t\t\t\t&& this.store.state.widget.widgetData.deviceOrientation == DeviceOrientation.horizontal\n\t\t\t)\n\t\t\t{\n\t\t\t\tdocument.activeElement.blur();\n\t\t\t}\n\t\t});\n\n\t\tlet serverVariables = BX.Messenger.LocalStorage.get(this.getSiteId(), 0, 'serverVariables', false);\n\t\tif (serverVariables)\n\t\t{\n\t\t\tthis.addLocalize(serverVariables);\n\t\t}\n\n\t\tthis.initRestClient();\n\n\t\twindow.dispatchEvent(new CustomEvent('onBitrixLiveChat', {detail: {\n\t\t\twidget: this,\n\t\t\twidgetCode: this.code,\n\t\t\twidgetHost: this.host,\n\t\t}}));\n\n\t\tif (this.pageMode)\n\t\t{\n\t\t\tthis.open();\n\t\t}\n\t}\n\n\tgetWidgetStore(params)\n\t{\n\t\t/* WIDGET DATA */\n\n\t\tlet widgetDataDefault = {\n\t\t\tsiteId: this.getSiteId(),\n\t\t\thost: this.getHost(),\n\t\t\tconfigId: 0,\n\t\t\tconfigName: '',\n\t\t\tvote: {\n\t\t\t\tenable: false,\n\t\t\t\tmessageText: this.getLocalize('BX_LIVECHAT_VOTE_TITLE'),\n\t\t\t\tmessageLike: this.getLocalize('BX_LIVECHAT_VOTE_PLUS_TITLE'),\n\t\t\t\tmessageDislike: this.getLocalize('BX_LIVECHAT_VOTE_MINUS_TITLE')\n\t\t\t},\n\t\t\tpageMode: false,\n\t\t\tlanguage: this.language,\n\t\t\tcopyright: this.copyright,\n\t\t\tcopyrightUrl: this.copyrightUrl,\n\t\t\tonline: false,\n\t\t\toperators: [],\n\t\t\tconnectors: [],\n\t\t\tdisk: {\n\t\t\t\tenabled: false,\n\t\t\t\tmaxFileSize: 5242880,\n\t\t\t},\n\t\t\tstyles: {\n\t\t\t\tbackgroundColor: '#17a3ea',\n\t\t\t\ticonColor: '#ffffff'\n\t\t\t},\n\t\t\tshowForm: FormType.none,\n\t\t\tuploadFile: false,\n\t\t\tdeviceType: DeviceType.desktop,\n\t\t\tdeviceOrientation: DeviceOrientation.portrait,\n\t\t\tlocation: LocationType.bottomRight,\n\t\t\tshowed: false,\n\t\t\treopen: false,\n\t\t\tdragged: false,\n\t\t\ttextareaHeight: 0,\n\t\t\tshowConsent: false,\n\t\t\tconsentUrl: '',\n\t\t\tdialogStart: false,\n\t\t\terror: {\n\t\t\t\tactive: false,\n\t\t\t\tcode: '',\n\t\t\t\tdescription: ''\n\t\t\t}\n\t\t};\n\n\t\tlet widgetData = BX.Messenger.LocalStorage.get(this.getSiteId(), 0, WidgetStore.widgetData, widgetDataDefault);\n\n\t\twidgetData.deviceType = BX.Messenger.Utils.device.isMobile()? DeviceType.mobile: DeviceType.desktop;\n\t\twidgetData.deviceOrientation = BX.Messenger.Utils.device.getOrientation();\n\t\twidgetData.language = this.language;\n\t\twidgetData.copyright = this.copyright;\n\t\twidgetData.copyrightUrl = this.copyrightUrl;\n\t\twidgetData.pageMode = this.pageMode !== false;\n\t\twidgetData.dragged = false;\n\t\twidgetData.showConsent = false;\n\t\twidgetData.showForm = FormType.none;\n\t\twidgetData.uploadFile = false;\n\t\twidgetData.error = {\n\t\t\tactive: false,\n\t\t\tcode: '',\n\t\t\tdescription: ''\n\t\t};\n\t\twidgetData.showed = false;\n\n\t\tif (BX.Messenger.Utils.types.isPlainObject(params.widgetData))\n\t\t{\n\t\t\tif (params.widgetData.location && typeof LocationStyle[params.widgetData.location] !== 'undefined')\n\t\t\t{\n\t\t\t\twidgetData.location = params.widgetData.location;\n\t\t\t}\n\t\t\tif (\n\t\t\t\tBX.Messenger.Utils.types.isPlainObject(params.widgetData.styles)\n\t\t\t\t&& (params.widgetData.styles.backgroundColor || params.widgetData.styles.iconColor)\n\t\t\t)\n\t\t\t{\n\t\t\t\tif (params.widgetData.styles.backgroundColor)\n\t\t\t\t{\n\t\t\t\t\twidgetData.styles.backgroundColor = params.widgetData.styles.backgroundColor;\n\t\t\t\t}\n\t\t\t\tif (params.widgetData.styles.iconColor)\n\t\t\t\t{\n\t\t\t\t\twidgetData.styles.iconColor = params.widgetData.styles.iconColor;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfor (let param in widgetDataDefault)\n\t\t{\n\t\t\tif (!widgetDataDefault.hasOwnProperty(param))\n\t\t\t\tcontinue;\n\n\t\t\tif (typeof widgetData[param] == 'undefined')\n\t\t\t{\n\t\t\t\twidgetData[param] = widgetDataDefault[param];\n\t\t\t}\n\t\t}\n\n\t\t/* DIALOG DATA */\n\t\tlet dialogDataDefault = {\n\t\t\tdialogId: 'chat0',\n\t\t\tchatId: 0,\n\t\t\tdiskFolderId: 0,\n\t\t\tsessionId: 0,\n\t\t\tsessionClose: true,\n\t\t\tuserVote: VoteType.none,\n\t\t\tuserConsent: false,\n\t\t\tmessageLimit: 0,\n\t\t\toperator: {\n\t\t\t\tname: '',\n\t\t\t\tfirstName: '',\n\t\t\t\tlastName: '',\n\t\t\t\tworkPosition: '',\n\t\t\t\tavatar: '',\n\t\t\t\tonline: false,\n\t\t\t}\n\t\t};\n\n\t\tlet dialogData = BX.Messenger.LocalStorage.get(this.getSiteId(), 0, WidgetStore.dialogData, dialogDataDefault);\n\n\t\tfor (let param in dialogDataDefault)\n\t\t{\n\t\t\tif (!dialogDataDefault.hasOwnProperty(param))\n\t\t\t\tcontinue;\n\n\t\t\tif (typeof dialogData[param] == 'undefined')\n\t\t\t{\n\t\t\t\tdialogData[param] = dialogDataDefault[param];\n\t\t\t}\n\t\t}\n\n\t\tdialogData.messageLimit = this.defaultMessageLimit;\n\n\t\t/* USER DATA */\n\t\tlet userDataDefault = {\n\t\t\tid: -1,\n\t\t\thash: '',\n\t\t\tname: '',\n\t\t\tfirstName: '',\n\t\t\tlastName: '',\n\t\t\tavatar: '',\n\t\t\temail: '',\n\t\t\tphone: '',\n\t\t\twww: '',\n\t\t\tgender: 'M',\n\t\t\tposition: '',\n\t\t};\n\n\t\tlet userData = BX.Messenger.LocalStorage.get(this.getSiteId(), 0, WidgetStore.userData, userDataDefault);\n\t\tif (!userData.hash)\n\t\t{\n\t\t\tlet userHash = this.getUserHashCookie();\n\t\t\tif (userHash)\n\t\t\t{\n\t\t\t\tuserData.hash = userHash;\n\t\t\t}\n\t\t}\n\n\t\tfor (let param in userDataDefault)\n\t\t{\n\t\t\tif (!userDataDefault.hasOwnProperty(param))\n\t\t\t\tcontinue;\n\n\t\t\tif (typeof userData[param] == 'undefined')\n\t\t\t{\n\t\t\t\tuserData[param] = userDataDefault[param];\n\t\t\t}\n\t\t}\n\n\t\t/* VUEX INIT DATA */\n\n\t\treturn {\n\t\t\tnamespaced: true,\n\t\t\tstate: {\n\t\t\t\twidgetData,\n\t\t\t\tdialogData,\n\t\t\t\tuserData\n\t\t\t},\n\t\t\tmutations: {\n\t\t\t\twidgetData: (state, params) =>\n\t\t\t\t{\n\t\t\t\t\tif (typeof params.configId === 'number')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.widgetData.configId = params.configId;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof params.configName === 'string')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.widgetData.configName = params.configName;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof params.language === 'string')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.widgetData.language = params.language;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof params.online === 'boolean')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.widgetData.online = params.online;\n\t\t\t\t\t}\n\t\t\t\t\tif (BX.Messenger.Utils.types.isPlainObject(params.vote))\n\t\t\t\t\t{\n\t\t\t\t\t\tif (typeof params.vote.enable === 'boolean')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tstate.widgetData.vote.enable = params.vote.enable;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (typeof params.vote.messageText === 'string')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tstate.widgetData.vote.messageText = params.vote.messageText;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (typeof params.vote.messageLike === 'string')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tstate.widgetData.vote.messageLike = params.vote.messageLike;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (typeof params.vote.messageDislike === 'string')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tstate.widgetData.vote.messageDislike = params.vote.messageDislike;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof params.dragged === 'boolean')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.widgetData.dragged = params.dragged;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof params.textareaHeight === 'number')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.widgetData.textareaHeight = params.textareaHeight;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof params.showConsent === 'boolean')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.widgetData.showConsent = params.showConsent;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof params.consentUrl === 'string')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.widgetData.consentUrl = params.consentUrl;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof params.showed === 'boolean')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.widgetData.showed = params.showed;\n\t\t\t\t\t\tstate.widgetData.reopen = params.showed;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof params.copyright === 'boolean')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.widgetData.copyright = params.copyright;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof params.dialogStart === 'boolean')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.widgetData.dialogStart = params.dialogStart;\n\t\t\t\t\t}\n\t\t\t\t\tif (BX.Messenger.Utils.types.isPlainObject(params.disk))\n\t\t\t\t\t{\n\t\t\t\t\t\tif (typeof params.disk.enabled === 'boolean')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tstate.widgetData.disk.enabled = params.disk.enabled;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (typeof params.disk.maxFileSize === 'number')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tstate.widgetData.disk.maxFileSize = params.disk.maxFileSize;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (BX.Messenger.Utils.types.isPlainObject(params.error) && typeof params.error.active === 'boolean')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.widgetData.error = {\n\t\t\t\t\t\t\tactive: params.error.active,\n\t\t\t\t\t\t\tcode: params.error.code || '',\n\t\t\t\t\t\t\tdescription: params.error.description || '',\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t\tif (params.operators instanceof Array)\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.widgetData.operators = params.operators;\n\t\t\t\t\t}\n\t\t\t\t\tif (params.connectors instanceof Array)\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.widgetData.connectors = params.connectors;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof params.uploadFilePlus !== 'undefined')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.widgetData.uploadFile = state.widgetData.uploadFile+1;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof params.uploadFileMinus !== 'undefined')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.widgetData.uploadFile = state.widgetData.uploadFile-1;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof params.showForm === 'string' && typeof FormType[params.showForm] !== 'undefined')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.widgetData.showForm = params.showForm;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof params.deviceType === 'string' && typeof DeviceType[params.deviceType] !== 'undefined')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.widgetData.deviceType = params.deviceType;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof params.deviceOrientation === 'string' && typeof DeviceOrientation[params.deviceOrientation] !== 'undefined')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.widgetData.deviceOrientation = params.deviceOrientation;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof params.location === 'number' && typeof LocationStyle[params.location] !== 'undefined')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.widgetData.location = params.location;\n\t\t\t\t\t}\n\n\t\t\t\t\tBX.Messenger.LocalStorage.set(state.widgetData.siteId, 0, WidgetStore.widgetData, state.widgetData);\n\t\t\t\t},\n\t\t\t\tdialogData: (state, params) =>\n\t\t\t\t{\n\t\t\t\t\tif (typeof params.chatId === 'number')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.dialogData.chatId = params.chatId;\n\t\t\t\t\t\tstate.dialogData.dialogId = params.chatId? 'chat'+params.chatId: 0;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof params.diskFolderId === 'number')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.dialogData.diskFolderId = params.diskFolderId;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof params.sessionId === 'number')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.dialogData.sessionId = params.sessionId;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof params.messageLimit === 'number')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.dialogData.messageLimit = params.messageLimit;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof params.sessionClose === 'boolean')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.dialogData.sessionClose = params.sessionClose;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof params.userConsent === 'boolean')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.dialogData.userConsent = params.userConsent;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof params.userVote === 'string' && typeof params.userVote !== 'undefined')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.dialogData.userVote = params.userVote;\n\t\t\t\t\t}\n\t\t\t\t\tif (BX.Messenger.Utils.types.isPlainObject(params.operator))\n\t\t\t\t\t{\n\t\t\t\t\t\tif (typeof params.operator.name === 'string' || typeof params.operator.name === 'number')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tstate.dialogData.operator.name = params.operator.name.toString();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (typeof params.operator.lastName === 'string' || typeof params.operator.lastName === 'number')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tstate.dialogData.operator.lastName = params.operator.lastName.toString();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (typeof params.operator.firstName === 'string' || typeof params.operator.firstName === 'number')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tstate.dialogData.operator.firstName = params.operator.firstName.toString();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (typeof params.operator.workPosition === 'string' || typeof params.operator.workPosition === 'number')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tstate.dialogData.operator.workPosition = params.operator.workPosition.toString();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (typeof params.operator.avatar === 'string')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (!params.operator.avatar || params.operator.avatar.startsWith('http'))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tstate.dialogData.operator.avatar = params.operator.avatar;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tstate.dialogData.operator.avatar = state.widgetData.host+params.operator.avatar;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (typeof params.operator.online === 'boolean')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tstate.dialogData.operator.online = params.operator.online;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tBX.Messenger.LocalStorage.set(state.widgetData.siteId, 0, WidgetStore.dialogData, state.dialogData);\n\t\t\t\t},\n\t\t\t\tuserData: (state, params) =>\n\t\t\t\t{\n\t\t\t\t\tif (typeof params.id === 'number')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.userData.id = params.id;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof params.hash === 'string' && params.hash !== state.userData.hash)\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.userData.hash = params.hash;\n\t\t\t\t\t\tCookie.set(null, 'LIVECHAT_HASH', params.hash, {expires: 365*86400, path: '/'});\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof params.name === 'string' || typeof params.name === 'number')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.userData.name = params.name.toString();\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof params.firstName === 'string' || typeof params.firstName === 'number')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.userData.firstName = params.firstName.toString();\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof params.lastName === 'string' || typeof params.lastName === 'number')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.userData.lastName = params.lastName.toString();\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof params.avatar === 'string')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.userData.avatar = params.avatar;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof params.email === 'string')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.userData.email = params.email;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof params.phone === 'string' || typeof params.phone === 'number')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.userData.phone = params.phone.toString();\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof params.www === 'string')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.userData.www = params.www;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof params.gender === 'string')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.userData.gender = params.gender;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof params.position === 'string')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.userData.position = params.position;\n\t\t\t\t\t}\n\t\t\t\t\tBX.Messenger.LocalStorage.set(state.widgetData.siteId, 0, WidgetStore.userData, state.userData);\n\t\t\t\t},\n\t\t\t}\n\t\t};\n\t}\n\n\tinitRestClient()\n\t{\n\t\tthis.restClient = new LiveChatRestClient({endpoint: this.host+'/rest'});\n\n\t\tif (this.isUserRegistered())\n\t\t{\n\t\t\tthis.restClient.setAuthId(this.getUserHash());\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.restClient.setAuthId(RestAuth.guest);\n\t\t}\n\t}\n\n\trequestWidgetData()\n\t{\n\t\tif (!this.isReady())\n\t\t{\n\t\t\tconsole.error('LiveChatWidget.start: widget code or host is not specified');\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.widgetDataRequested = true;\n\t\tif (!this.isUserRegistered() && this.userRegisterData.hash)\n\t\t{\n\t\t\tthis.requestData();\n\t\t\tthis.inited = true;\n\t\t\tthis.fireInitEvent();\n\t\t}\n\t\telse if (this.isConfigDataLoaded() && this.isUserRegistered())\n\t\t{\n\t\t\tthis.requestData();\n\t\t\tthis.inited = true;\n\t\t\tthis.fireInitEvent();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.restClient.callMethod(RestMethod.widgetConfigGet, {code: this.code}, (xhr) => {this.configRequestXhr = xhr}).then((result) => {\n\t\t\t\tthis.configRequestXhr = null;\n\t\t\t\tthis.clearError();\n\n\t\t\t\tthis.storeDataFromRest(RestMethod.widgetConfigGet, result.data());\n\n\t\t\t\tif (!this.inited)\n\t\t\t\t{\n\t\t\t\t\tthis.inited = true;\n\t\t\t\t\tthis.fireInitEvent();\n\t\t\t\t}\n\t\t\t}).catch(result => {\n\t\t\t\tthis.configRequestXhr = null;\n\n\t\t\t\tthis.setError(result.error().ex.error, result.error().ex.error_description);\n\t\t\t});\n\n\t\t\tif (this.isConfigDataLoaded())\n\t\t\t{\n\t\t\t\tthis.inited = true;\n\t\t\t\tthis.fireInitEvent();\n\t\t\t}\n\t\t}\n\n\t\tthis.timer = new BX.Messenger.Timer();\n\t}\n\n\trequestData()\n\t{\n\t\tif (this.requestDataSend)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tthis.requestDataSend = true;\n\n\t\tif (this.configRequestXhr)\n\t\t{\n\t\t\tthis.configRequestXhr.abort();\n\t\t}\n\n\t\tlet query = {\n\t\t\t[RestMethod.widgetConfigGet]: [RestMethod.widgetConfigGet, {code: this.code}]\n\t\t};\n\n\t\tif (this.isUserRegistered())\n\t\t{\n\t\t\tquery[RestMethod.widgetDialogGet] = [RestMethod.widgetDialogGet, {config_id: this.getConfigId(), trace_data: this.getCrmTraceData(), custom_data: this.getCustomData()}];\n\t\t\tquery[RestMethod.imChatGet] = [RestMethod.imChatGet, {dialog_id: '$result['+RestMethod.widgetDialogGet+'][dialogId]'}];\n\t\t\tquery[RestMethod.imDialogMessagesGet] = [RestMethod.imDialogMessagesGet, {chat_id: '$result['+RestMethod.widgetDialogGet+'][chatId]', limit: this.requestMessageLimit, convert_text: 'Y'}];\n\t\t}\n\t\telse\n\t\t{\n\t\t\tquery[RestMethod.widgetUserRegister] = [RestMethod.widgetUserRegister, {config_id: '$result['+RestMethod.widgetConfigGet+'][configId]', ...this.getUserRegisterFields()}];\n\t\t\tquery[RestMethod.imChatGet] = [RestMethod.imChatGet, {dialog_id: '$result['+RestMethod.widgetUserRegister+'][dialogId]'}];\n\n\t\t\tif (this.userRegisterData.hash)\n\t\t\t{\n\t\t\t\tquery[RestMethod.widgetDialogGet] = [RestMethod.widgetDialogGet, {config_id: '$result['+RestMethod.widgetConfigGet+'][configId]', trace_data: this.getCrmTraceData(), custom_data: this.getCustomData()}];\n\t\t\t\tquery[RestMethod.imDialogMessagesGet] = [RestMethod.imDialogMessagesGet, {chat_id: '$result['+RestMethod.widgetDialogGet+'][chatId]', limit: this.requestMessageLimit, convert_text: 'Y'}];\n\t\t\t}\n\t\t}\n\n\t\tquery[RestMethod.pullServerTime] = [RestMethod.pullServerTime, {}];\n\t\tquery[RestMethod.pullConfigGet] = [RestMethod.pullConfigGet, {'CACHE': 'N'}];\n\t\tquery[RestMethod.widgetUserGet] = [RestMethod.widgetUserGet, {}];\n\n\t\tthis.restClient.callBatch(query, (response) =>\n\t\t{\n\t\t\tif (!response)\n\t\t\t{\n\t\t\t\tthis.requestDataSend = false;\n\t\t\t\tthis.setError('EMPTY_RESPONSE', 'Server returned an empty response.');\n\t\t\t\treturn false;\n\t\t\t}\n\n\n\n\t\t\tlet configGet = response[RestMethod.widgetConfigGet];\n\t\t\tif (configGet && configGet.error())\n\t\t\t{\n\t\t\t\tthis.requestDataSend = false;\n\n\t\t\t\tthis.setError(configGet.error().ex.error, configGet.error().ex.error_description);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tthis.storeDataFromRest(RestMethod.widgetConfigGet, configGet.data());\n\n\t\t\tlet userGetResult = response[RestMethod.widgetUserGet];\n\t\t\tif (userGetResult.error())\n\t\t\t{\n\t\t\t\tthis.requestDataSend = false;\n\t\t\t\tthis.setError(userGetResult.error().ex.error, userGetResult.error().ex.error_description);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tthis.storeDataFromRest(RestMethod.widgetUserGet, userGetResult.data());\n\n\t\t\tlet chatGetResult = response[RestMethod.imChatGet];\n\t\t\tif (chatGetResult.error())\n\t\t\t{\n\t\t\t\tthis.requestDataSend = false;\n\t\t\t\tthis.setError(chatGetResult.error().ex.error, chatGetResult.error().ex.error_description);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tthis.storeDataFromRest(RestMethod.imChatGet, chatGetResult.data());\n\n\t\t\tlet dialogGetResult = response[RestMethod.widgetDialogGet];\n\t\t\tif (dialogGetResult)\n\t\t\t{\n\t\t\t\tif (dialogGetResult.error())\n\t\t\t\t{\n\t\t\t\t\tthis.requestDataSend = false;\n\t\t\t\t\tthis.setError(dialogGetResult.error().ex.error, dialogGetResult.error().ex.error_description);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tthis.storeDataFromRest(RestMethod.widgetDialogGet, dialogGetResult.data());\n\t\t\t}\n\n\t\t\tlet dialogMessagesGetResult = response[RestMethod.imDialogMessagesGet];\n\t\t\tif (dialogMessagesGetResult)\n\t\t\t{\n\t\t\t\tif (dialogMessagesGetResult.error())\n\t\t\t\t{\n\t\t\t\t\tthis.requestDataSend = false;\n\t\t\t\t\tthis.setError(dialogMessagesGetResult.error().ex.error, dialogMessagesGetResult.error().ex.error_description);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tthis.storeDataFromRest(RestMethod.imDialogMessagesGet, dialogMessagesGetResult.data());\n\t\t\t}\n\n\t\t\tlet userRegisterResult = response[RestMethod.widgetUserRegister];\n\t\t\tif (userRegisterResult)\n\t\t\t{\n\t\t\t\tif (userRegisterResult.error())\n\t\t\t\t{\n\t\t\t\t\tthis.requestDataSend = false;\n\t\t\t\t\tthis.setError(userRegisterResult.error().ex.error, userRegisterResult.error().ex.error_description);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tthis.storeDataFromRest(RestMethod.widgetUserRegister, userRegisterResult.data());\n\t\t\t}\n\n\t\t\tlet timeShift = 0;\n\n\t\t\tlet serverTimeResult = response[RestMethod.pullServerTime];\n\t\t\tif (serverTimeResult && !serverTimeResult.error())\n\t\t\t{\n\t\t\t\ttimeShift = Math.floor(((new Date()).getTime() - new Date(serverTimeResult.data()).getTime())/1000);\n\t\t\t}\n\n\t\t\tlet config = null;\n\t\t\tlet pullConfigResult = response[RestMethod.pullConfigGet];\n\t\t\tif (pullConfigResult && !pullConfigResult.error())\n\t\t\t{\n\t\t\t\tconfig = pullConfigResult.data();\n\t\t\t\tconfig.server.timeShift = timeShift;\n\t\t\t}\n\n\t\t\tthis.startPullClient(config).then(() => {\n\t\t\t\tthis.processSendMessages();\n\t\t\t\tthis.processSendFiles();\n\t\t\t}).catch((error) => {\n\t\t\t\tthis.setError(error.ex.error, error.ex.error_description);\n\t\t\t});\n\n\t\t\tthis.requestDataSend = false;\n\t\t}, false, false, BX.Messenger.Utils.getLogTrackingParams({name: 'widget.init.config', dialog: this.getDialogData()}));\n\t}\n\n\tstoreDataFromRest(type, result)\n\t{\n\t\tif (!RestMethodCheck.includes(type))\n\t\t{\n\t\t\tconsole.warn(`%cLiveChatWidget.storeDataFromRest: config is not set, because you are trying to set as unknown type (%c${type}%c)`, \"color: black;\", \"font-weight: bold; color: red\", \"color: black\");\n\t\t\treturn false;\n\t\t}\n\n\t\tif (type == RestMethod.widgetConfigGet)\n\t\t{\n\t\t\tthis.store.commit(WidgetStore.widgetData, {\n\t\t\t\tconfigId: result.configId,\n\t\t\t\tconfigName: result.configName,\n\t\t\t\tvote: result.vote,\n\t\t\t\toperators: result.operators || [],\n\t\t\t\tonline: result.online,\n\t\t\t\tconsentUrl: result.consentUrl,\n\t\t\t\tconnectors: result.connectors || [],\n\t\t\t\tdisk: result.disk,\n\t\t\t});\n\n\t\t\tthis.addLocalize(result.serverVariables);\n\t\t\tBX.Messenger.LocalStorage.set(this.getSiteId(), 0, 'serverVariables', result.serverVariables || {});\n\t\t}\n\t\telse if (type == RestMethod.widgetUserRegister)\n\t\t{\n\t\t\tthis.restClient.setAuthId(result.hash);\n\n\t\t\tlet previousData = [];\n\t\t\tif (typeof this.store.state[MessengerStore.messages].collection[this.getChatId()] !== 'undefined')\n\t\t\t{\n\t\t\t\tpreviousData = this.store.state[MessengerStore.messages].collection[this.getChatId()];\n\t\t\t}\n\t\t\tthis.store.commit(MessengerMessageStore.initCollection, {chatId: result.chatId, messages: previousData});\n\n\t\t\tthis.store.commit(MessengerDialogStore.initCollection, {dialogId: result.dialogId, fields: {\n\t\t\t\tentityType: 'LIVECHAT',\n\t\t\t\ttype: 'livechat'\n\t\t\t}});\n\n\t\t\tthis.store.commit(WidgetStore.dialogData, {\n\t\t\t\tchatId: result.chatId\n\t\t\t});\n\t\t}\n\t\telse if (type == RestMethod.imChatGet)\n\t\t{\n\t\t\tthis.store.dispatch(MessengerDialogStore.set, result);\n\t\t}\n\t\telse if (type == RestMethod.widgetUserGet)\n\t\t{\n\t\t\tthis.store.commit(WidgetStore.userData, {\n\t\t\t\tid: result.id,\n\t\t\t\thash: result.hash,\n\t\t\t\tname: result.name,\n\t\t\t\tfirstName: result.firstName,\n\t\t\t\tlastName: result.lastName,\n\t\t\t\tphone: result.phone,\n\t\t\t\tavatar: result.avatar,\n\t\t\t\temail: result.email,\n\t\t\t\twww: result.www,\n\t\t\t\tgender: result.gender,\n\t\t\t\tposition: result.position,\n\t\t\t});\n\t\t}\n\t\telse if (type == RestMethod.widgetDialogGet)\n\t\t{\n\t\t\tthis.store.commit(MessengerMessageStore.initCollection, {chatId: result.chatId});\n\n\t\t\tthis.store.commit(WidgetStore.dialogData, {\n\t\t\t\tchatId: result.chatId,\n\t\t\t\tdiskFolderId: result.diskFolderId,\n\t\t\t\tsessionId: result.sessionId,\n\t\t\t\tsessionClose: result.sessionClose,\n\t\t\t\tuserVote: result.userVote,\n\t\t\t\tuserConsent: result.userConsent,\n\t\t\t\toperator: result.operator\n\t\t\t});\n\t\t}\n\t\telse if (type == RestMethod.diskFolderGet)\n\t\t{\n\t\t\tthis.store.commit(WidgetStore.dialogData, {\n\t\t\t\tdiskFolderGet: result.ID\n\t\t\t});\n\t\t}\n\t\telse if (type == RestMethod.imDialogMessagesGet)\n\t\t{\n\t\t\tthis.store.dispatch(MessengerMessageStore.setBefore, result.messages);\n\t\t\tthis.store.dispatch(MessengerUserStore.set, result.users);\n\t\t\tthis.store.dispatch(MessengerFileStore.setBefore, this.prepareFileData(result.files));\n\n\t\t\tif (result.messages && result.messages.length > 0 && !this.isDialogStart())\n\t\t\t{\n\t\t\t\tthis.store.commit(WidgetStore.widgetData, {dialogStart:true});\n\t\t\t}\n\t\t}\n\t\telse if (type == RestMethod.imDialogMessagesUnread)\n\t\t{\n\t\t\tthis.store.dispatch(MessengerMessageStore.set, result.messages);\n\t\t\tthis.store.dispatch(MessengerUserStore.set, result.users);\n\t\t\tthis.store.dispatch(MessengerFileStore.set, this.prepareFileData(result.files));\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tprepareFileData(files)\n\t{\n\t\tif (Cookie.get(null, 'BITRIX_LIVECHAT_AUTH'))\n\t\t{\n\t\t\treturn files;\n\t\t}\n\n\t\treturn files.map(file =>\n\t\t{\n\t\t\tlet hash = md5(this.getUserId()+'|'+file.id+'|'+this.getUserHash());\n\t\t\tlet urlParam = 'livechat_auth_id='+hash+'&livechat_user_id='+this.getUserId();\n\t\t\tif (file.urlPreview)\n\t\t\t{\n\t\t\t\tfile.urlPreview = file.urlPreview+'&'+urlParam;\n\t\t\t}\n\t\t\tif (file.urlShow)\n\t\t\t{\n\t\t\t\tfile.urlShow = file.urlShow+'&'+urlParam;\n\t\t\t}\n\t\t\tif (file.urlDownload)\n\t\t\t{\n\t\t\t\tfile.urlDownload = file.urlDownload+'&'+urlParam;\n\t\t\t}\n\n\t\t\treturn file;\n\t\t});\n\t}\n\n\tcheckBrowserVersion()\n\t{\n\t\tif (BX.Messenger.Utils.platform.isIos())\n\t\t{\n\t\t\tlet version = BX.Messenger.Utils.platform.getIosVersion();\n\t\t\tif (version && version <= 10)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\treturn true;\n\t}\n\n/* endregion 03-01. Initialize and store data */\n\n/* region 03-02. Push & Pull */\n\n\tstartPullClient(config)\n\t{\n\t\tlet promise = new BX.Promise();\n\n\t\tif (this.pullClient)\n\t\t{\n\t\t\tif (!this.pullClient.isConnected())\n\t\t\t{\n\t\t\t\tthis.pullClient.scheduleReconnect();\n\t\t\t}\n\t\t\tpromise.resolve(true);\n\t\t\treturn promise;\n\t\t}\n\t\tif (!this.getUserId() || !this.getSiteId() || !this.restClient)\n\t\t{\n\t\t\tpromise.reject({\n\t\t\t\tex: { error: 'WIDGET_NOT_LOADED', error_description: 'Widget is not loaded.'}\n\t\t\t});\n\t\t\treturn promise;\n\t\t}\n\n\t\tthis.pullClient = new BX.PullClient({\n\t\t\tserverEnabled: true,\n\t\t\tuserId: this.getUserId(),\n\t\t\tsiteId: this.getSiteId(),\n\t\t\trestClient: this.restClient,\n\t\t\tconfigTimestamp: config? config.server.config_timestamp: 0,\n\t\t\tskipCheckRevision: true,\n\t\t});\n\t\tthis.pullClient.subscribe({\n\t\t\ttype: BX.PullClient.SubscriptionType.Server,\n\t\t\tmoduleId: 'im',\n\t\t\tcallback: this.eventMessengerInteraction.bind(this)\n\t\t});\n\t\tthis.pullClient.subscribe({\n\t\t\ttype: BX.PullClient.SubscriptionType.Server,\n\t\t\tmoduleId: 'imopenlines',\n\t\t\tcallback: this.eventLinesInteraction.bind(this)\n\t\t});\n\t\tthis.pullClient.subscribe({\n\t\t\ttype: BX.PullClient.SubscriptionType.Status,\n\t\t\tcallback: this.eventStatusInteraction.bind(this)\n\t\t});\n\n\t\tthis.pullConnectedFirstTime = this.pullClient.subscribe({\n\t\t\ttype: BX.PullClient.SubscriptionType.Status,\n\t\t\tcallback: (result) => {\n\t\t\t\tif (result.status == BX.PullClient.PullStatus.Online)\n\t\t\t\t{\n\t\t\t\t\tpromise.resolve(true);\n\t\t\t\t\tthis.pullConnectedFirstTime();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tif (this.template)\n\t\t{\n\t\t\tthis.template.$bitrixPullClient = this.pullClient;\n\t\t\tthis.template.$root.$emit('onBitrixPullClientInited');\n\t\t}\n\n\t\tthis.pullClient.start(config).catch(function(){\n\t\t\tpromise.reject({\n\t\t\t\tex: { error: 'PULL_CONNECTION_ERROR', error_description: 'Pull is not connected.'}\n\t\t\t});\n\t\t});\n\n\t\treturn promise;\n\t}\n\n\trecoverPullConnection()\n\t{\n\t\t// this.pullClient.session.mid = 0; // TODO specially for disable pull history, remove after recode im\n\t\tthis.pullClient.restart(BX.PullClient.CloseReasons.MANUAL, 'Restart after click by connection status button.');\n\t}\n\n\tstopPullClient()\n\t{\n\t\tif (this.pullClient)\n\t\t{\n\t\t\tthis.pullClient.stop(BX.PullClient.CloseReasons.MANUAL, 'Closed manually');\n\t\t}\n\t}\n\n\teventMessengerInteraction(data)\n\t{\n\t\tBX.Messenger.Logger.info('eventMessengerInteraction', data);\n\n\t\tif (data.command == \"messageChat\")\n\t\t{\n\t\t\tif (data.params.chat && data.params.chat[data.params.chatId])\n\t\t\t{\n\t\t\t\tthis.store.dispatch(MessengerDialogStore.update, {\n\t\t\t\t\tdialogId: 'chat'+data.params.chatId,\n\t\t\t\t\tfields: data.params.chat[data.params.chatId]\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (data.params.users)\n\t\t\t{\n\t\t\t\tthis.store.dispatch(MessengerUserStore.set, BX.Messenger.Model.Users.convertToArray(data.params.users));\n\t\t\t}\n\n\t\t\tif (data.params.files)\n\t\t\t{\n\t\t\t\tlet dataParamsFiles = BX.Messenger.Model.Files.convertToArray(data.params.files);\n\t\t\t\tthis.store.dispatch(MessengerFileStore.set, this.prepareFileData(dataParamsFiles));\n\t\t\t}\n\n\t\t\tlet collection = this.store.state[MessengerStore.messages].collection[this.getChatId()];\n\t\t\tif (!collection)\n\t\t\t{\n\t\t\t\tcollection = [];\n\t\t\t}\n\n\t\t\tlet update = false;\n\t\t\tif (data.params.message.tempId && collection.length > 0)\n\t\t\t{\n\t\t\t\tfor (let index = collection.length-1; index >= 0; index--)\n\t\t\t\t{\n\t\t\t\t\tif (collection[index].id == data.params.message.tempId)\n\t\t\t\t\t{\n\t\t\t\t\t\tupdate = true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (update)\n\t\t\t{\n\t\t\t\tthis.store.dispatch(MessengerMessageStore.update, {\n\t\t\t\t\tid: data.params.message.tempId,\n\t\t\t\t\tchatId: data.params.message.chatId,\n\t\t\t\t\tfields: data.params.message\n\t\t\t\t});\n\t\t\t}\n\t\t\telse if (this.isUnreadMessagesLoaded())\n\t\t\t{\n\t\t\t\tlet unreadCountInCollection = 0;\n\t\t\t\tif (collection.length > 0)\n\t\t\t\t{\n\t\t\t\t\tcollection.forEach(element => element.unread? unreadCountInCollection++: 0);\n\t\t\t\t}\n\n\t\t\t\tif (unreadCountInCollection > 0)\n\t\t\t\t{\n\t\t\t\t\tthis.store.commit(WidgetStore.dialogData, {\n\t\t\t\t\t\tmessageLimit: this.requestMessageLimit + unreadCountInCollection\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse if (this.getMessageLimit() != this.requestMessageLimit)\n\t\t\t\t{\n\t\t\t\t\tthis.store.commit(WidgetStore.dialogData, {\n\t\t\t\t\t\tmessageLimit: this.requestMessageLimit\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tthis.store.dispatch(MessengerMessageStore.set, {...data.params.message, unread: true});\n\t\t\t}\n\n\t\t\tthis.startWriting({\n\t\t\t\tdialogId: 'chat'+data.params.message.chatId,\n\t\t\t\tuserId: data.params.message.senderId,\n\t\t\t\taction: false\n\t\t\t});\n\n\t\t\tif (data.params.message.senderId == this.getUserId())\n\t\t\t{\n\t\t\t\tthis.store.dispatch(MessengerMessageStore.readMessages, {\n\t\t\t\t\tchatId: data.params.message.chatId\n\t\t\t\t}).then(result => {\n\t\t\t\t\tthis.store.dispatch(MessengerDialogStore.update, {\n\t\t\t\t\t\tdialogId: 'chat'+data.params.message.chatId,\n\t\t\t\t\t\tfields: {\n\t\t\t\t\t\t\tcounter: 0,\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.store.dispatch(MessengerDialogStore.increaseCounter, {\n\t\t\t\t\tdialogId: 'chat'+data.params.message.chatId,\n\t\t\t\t\tcount: 1,\n\t\t\t\t});\n\n\t\t\t\tthis.sendEvent({\n\t\t\t\t\ttype: SubscriptionType.operatorMessage,\n\t\t\t\t\tdata: data.params\n\t\t\t\t});\n\n\t\t\t\tif (!this.store.state.widget.widgetData.showed && !this.onceShowed)\n\t\t\t\t{\n\t\t\t\t\tthis.onceShowed = true;\n\t\t\t\t\tthis.open();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse if (data.command == \"messageUpdate\" || data.command == \"messageDelete\")\n\t\t{\n\t\t\tthis.store.dispatch(MessengerMessageStore.update, {\n\t\t\t\tid: data.params.id,\n\t\t\t\tchatId: data.params.chatId,\n\t\t\t\tfields: {\n\t\t\t\t\ttext: data.command == \"messageUpdate\"? data.params.text: '',\n\t\t\t\t\ttextOriginal: data.command == \"messageUpdate\"? data.params.textOriginal: '',\n\t\t\t\t\tparams: data.params.params,\n\t\t\t\t\tblink: true\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.startWriting({\n\t\t\t\tdialogId: data.params.dialogId,\n\t\t\t\tuserId: data.params.senderId,\n\t\t\t\taction: false\n\t\t\t});\n\t\t}\n\t\telse if (data.command == \"messageDeleteComplete\")\n\t\t{\n\t\t\tthis.store.dispatch(MessengerMessageStore.delete, {\n\t\t\t\tid: data.params.id,\n\t\t\t\tchatId: data.params.chatId,\n\t\t\t});\n\n\t\t\tthis.startWriting({\n\t\t\t\tdialogId: data.params.dialogId,\n\t\t\t\tuserId: data.params.senderId,\n\t\t\t\taction: false\n\t\t\t});\n\t\t}\n\t\telse if (data.command == \"messageParamsUpdate\")\n\t\t{\n\t\t\tthis.store.dispatch(MessengerMessageStore.update, {\n\t\t\t\tid: data.params.id,\n\t\t\t\tchatId: data.params.chatId,\n\t\t\t\tfields: {params: data.params.params}\n\t\t\t});\n\t\t}\n\t\telse if (data.command == \"startWriting\")\n\t\t{\n\t\t\tthis.startWriting(data.params);\n\t\t}\n\t\telse if (data.command == \"readMessageChat\")\n\t\t{\n\t\t\tthis.store.dispatch(MessengerMessageStore.readMessages, {\n\t\t\t\tchatId: data.params.chatId,\n\t\t\t\treadId: data.params.lastId\n\t\t\t}).then(result => {\n\t\t\t\tthis.store.dispatch(MessengerDialogStore.update, {\n\t\t\t\t\tdialogId: 'chat'+data.params.chatId,\n\t\t\t\t\tfields: {\n\t\t\t\t\t\tcounter: data.params.counter,\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t}\n\n\teventLinesInteraction(data)\n\t{\n\t\tBX.Messenger.Logger.info('eventLinesInteraction', data);\n\n\t\tif (data.command == \"sessionStart\")\n\t\t{\n\t\t\tthis.store.commit(WidgetStore.dialogData, {\n\t\t\t\tsessionId: data.params.sessionId,\n\t\t\t\tsessionClose: false,\n\t\t\t\tuserVote: VoteType.none,\n\t\t\t});\n\n\t\t\tthis.sendEvent({\n\t\t\t\ttype: SubscriptionType.sessionStart,\n\t\t\t\tdata: {\n\t\t\t\t\tsessionId: data.params.sessionId\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\telse if (data.command == \"sessionOperatorChange\")\n\t\t{\n\t\t\tthis.store.commit(WidgetStore.dialogData, {\n\t\t\t\toperator: data.params.operator\n\t\t\t});\n\n\t\t\tthis.sendEvent({\n\t\t\t\ttype: SubscriptionType.sessionOperatorChange,\n\t\t\t\tdata: {\n\t\t\t\t\toperator: data.params.operator\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\telse if (data.command == \"sessionFinish\")\n\t\t{\n\t\t\tthis.store.commit(WidgetStore.dialogData, {\n\t\t\t\tsessionId: data.params.sessionId,\n\t\t\t\tsessionClose: true,\n\t\t\t});\n\n\t\t\tthis.sendEvent({\n\t\t\t\ttype: SubscriptionType.sessionFinish,\n\t\t\t\tdata: {\n\t\t\t\t\tsessionId: data.params.sessionId\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (!data.params.spam)\n\t\t\t{\n\t\t\t\tthis.store.commit(WidgetStore.dialogData, {\n\t\t\t\t\toperator: {\n\t\t\t\t\t\tname: '',\n\t\t\t\t\t\tfirstName: '',\n\t\t\t\t\t\tlastName: '',\n\t\t\t\t\t\tworkPosition: '',\n\t\t\t\t\t\tavatar: '',\n\t\t\t\t\t\tonline: false,\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\teventStatusInteraction(data)\n\t{\n\t\tif (data.status === BX.PullClient.PullStatus.Online)\n\t\t{\n\t\t\tthis.offline = false;\n\n\t\t\tif (this.pullRequestMessage)\n\t\t\t{\n\t\t\t\tthis.getDialogUnread().then(() => {\n\t\t\t\t\tthis.readMessage();\n\t\t\t\t\tthis.processSendMessages();\n\t\t\t\t\tthis.processSendFiles();\n\t\t\t\t});\n\t\t\t\tthis.pullRequestMessage = false;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.readMessage();\n\t\t\t\tthis.processSendMessages();\n\t\t\t\tthis.processSendFiles();\n\t\t\t}\n\t\t}\n\t\telse if (data.status === BX.PullClient.PullStatus.Offline)\n\t\t{\n\t\t\tthis.pullRequestMessage = true;\n\t\t\tthis.offline = true;\n\t\t}\n\t}\n\n/* endregion 03-02. Push & Pull */\n\n/* region 03-03. Template engine */\n\n\tattachTemplate()\n\t{\n\t\tif (this.template)\n\t\t{\n\t\t\tthis.store.commit(WidgetStore.widgetData, {showed: true});\n\t\t\treturn true;\n\t\t}\n\n\t\tthis.rootNode.innerHTML = '';\n\t\tthis.rootNode.appendChild(document.createElement('div'));\n\n\t\tconst widgetContext = this;\n\t\tconst restClient = this.restClient;\n\t\tconst pullClient = this.pullClient;\n\n\t\tthis.template = BX.Vue.create({\n\t\t\tel: this.rootNode.firstChild,\n\t\t\tstore: this.store,\n\t\t\ttemplate: '<bx-livechat/>',\n\t\t\tbeforeCreate()\n\t\t\t{\n\t\t\t\tthis.$bitrixController = widgetContext;\n\t\t\t\tthis.$bitrixRestClient = restClient;\n\t\t\t\tthis.$bitrixPullClient = pullClient;\n\t\t\t\tthis.$bitrixMessages = widgetContext.localize;\n\n\t\t\t\twidgetContext.sendEvent({\n\t\t\t\t\ttype: SubscriptionType.widgetOpen,\n\t\t\t\t\tdata: {}\n\t\t\t\t});\n\t\t\t},\n\t\t\tdestroyed()\n\t\t\t{\n\t\t\t\twidgetContext.sendEvent({\n\t\t\t\t\ttype: SubscriptionType.widgetClose,\n\t\t\t\t\tdata: {}\n\t\t\t\t});\n\n\t\t\t\tthis.$bitrixController.template = null;\n\t\t\t\tthis.$bitrixController.templateAttached = false;\n\t\t\t\tthis.$bitrixController.rootNode.innerHTML = '';\n\n\t\t\t\tthis.$bitrixController = null;\n\t\t\t\tthis.$bitrixRestClient = null;\n\t\t\t\tthis.$bitrixPullClient = null;\n\t\t\t\tthis.$bitrixMessages = null;\n\t\t\t}\n\t\t});\n\n\t\treturn true;\n\t}\n\n\tdetachTemplate()\n\t{\n\t\tif (!this.template)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tthis.template.$destroy();\n\n\t\treturn true;\n\t}\n\n\tmutateTemplateComponent(id, params)\n\t{\n\t\treturn BX.Vue.mutateComponent(id, params);\n\t}\n\n/* endregion 03-03. Template engine */\n\n/* region 03-04. Rest methods */\n\n\taddMessage(text = '')\n\t{\n\t\tif (!text)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tBX.Messenger.Logger.warn('addMessage', text);\n\n\t\tif (!this.isUnreadMessagesLoaded())\n\t\t{\n\t\t\tthis.sendMessage({id: 0, text});\n\t\t\tthis.processSendMessages();\n\n\t\t\treturn true;\n\t\t}\n\n\t\tthis.store.dispatch(MessengerMessageStore.add, {\n\t\t\tchatId: this.getChatId(),\n\t\t\tauthorId: this.getUserId(),\n\t\t\ttext: text,\n\t\t}).then(messageId => {\n\n\t\t\tif (!this.isDialogStart())\n\t\t\t{\n\t\t\t\tthis.store.commit(WidgetStore.widgetData, {dialogStart:true});\n\t\t\t}\n\n\t\t\tthis.messagesQueue.push({\n\t\t\t\tid: messageId,\n\t\t\t\ttext,\n\t\t\t\tsending: false\n\t\t\t});\n\n\t\t\tif (this.getChatId())\n\t\t\t{\n\t\t\t\tthis.processSendMessages();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.requestData();\n\t\t\t}\n\t\t});\n\n\t\treturn true;\n\t}\n\n\taddFile(fileInput)\n\t{\n\t\tif (!fileInput)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tBX.Messenger.Logger.warn('addFile', fileInput.files[0].name, fileInput.files[0].size);\n\n\t\tif (!this.isDialogStart())\n\t\t{\n\t\t\tthis.store.commit(WidgetStore.widgetData, {dialogStart:true});\n\t\t}\n\n\t\tthis.filesQueue.push({\n\t\t\tid: this.filesQueueIndex,\n\t\t\tfileInput\n\t\t});\n\t\tthis.filesQueueIndex++;\n\n\t\tif (this.getChatId())\n\t\t{\n\t\t\tthis.processSendFiles();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.requestData();\n\t\t}\n\n\n\t\treturn true;\n\t}\n\n\twritesMessage()\n\t{\n\t\tif (\n\t\t\t!this.getChatId()\n\t\t\t|| this.timer.has('writes')\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.timer.start('writes', null, 28);\n\n\t\tthis.timer.start('writesSend', null, 5, (id) => {\n\t\t\tthis.restClient.callMethod(RestMethod.imChatSendTyping, {\n\t\t\t\t'CHAT_ID': this.getChatId()\n\t\t\t}).catch(() => {\n\t\t\t\tthis.timer.stop('writes', this.getChatId());\n\t\t\t});\n\t\t});\n\t}\n\n\tstopWritesMessage()\n\t{\n\t\tthis.timer.stop('writes');\n\t\tthis.timer.stop('writesSend');\n\t}\n\n\tprocessSendMessages()\n\t{\n\t\tif (this.offline)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.messagesQueue.filter(element => !element.sending).forEach(element => {\n\t\t\telement.sending = true;\n\t\t\tthis.sendMessage(element);\n\t\t});\n\n\t\treturn true;\n\t}\n\n\tprocessSendFiles()\n\t{\n\t\tif (this.offline)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.filesQueue.filter(element => !element.sending).forEach(element => {\n\t\t\telement.sending = true;\n\t\t\tthis.sendFile(element);\n\t\t});\n\n\t\treturn true;\n\t}\n\n\tsendMessage(message)\n\t{\n\t\tthis.stopWritesMessage();\n\t\tthis.restClient.callMethod(RestMethod.imMessageAdd, {\n\t\t\t'TEMP_ID': message.id,\n\t\t\t'CHAT_ID': this.getChatId(),\n\t\t\t'MESSAGE': message.text\n\t\t}, null, null, BX.Messenger.Utils.getLogTrackingParams({\n\t\t\tname: RestMethod.imMessageAdd,\n\t\t\tdata: {timMessageType: 'text'},\n\t\t\tdialog: this.getDialogData()\n\t\t})).then(response => {\n\t\t\tlet messageId = response.data();\n\t\t\tif (typeof messageId === \"number\")\n\t\t\t{\n\t\t\t\tthis.store.dispatch(MessengerMessageStore.update, {\n\t\t\t\t\tid:  message.id,\n\t\t\t\t\tchatId: this.getChatId(),\n\t\t\t\t\tfields: {\n\t\t\t\t\t\tid: messageId,\n\t\t\t\t\t\tsending: false,\n\t\t\t\t\t\terror: false,\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tthis.store.dispatch(MessengerMessageStore.actionFinish, {\n\t\t\t\t\tid: messageId,\n\t\t\t\t\tchatId: this.getChatId()\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.store.dispatch(MessengerMessageStore.actionError, {\n\t\t\t\t\tid: message.id,\n\t\t\t\t\tchatId: this.getChatId()\n\t\t\t\t});\n\t\t\t}\n\t\t\tthis.messagesQueue = this.messagesQueue.filter(el => el.id != message.id);\n\n\t\t\tthis.sendEvent({\n\t\t\t\ttype: SubscriptionType.userMessage,\n\t\t\t\tdata: {\n\t\t\t\t\tid: messageId,\n\t\t\t\t\ttext: message.text\n\t\t\t\t}\n\t\t\t});\n\t\t}).catch(error => {\n\t\t\tthis.store.dispatch(MessengerMessageStore.actionError, {\n\t\t\t\tid: message.id,\n\t\t\t\tchatId: this.getChatId()\n\t\t\t});\n\t\t\tthis.messagesQueue = this.messagesQueue.filter(el => el.id != message.id);\n\t\t});\n\t}\n\n\tsendFile(file)\n\t{\n\t\tlet fileName = file.fileInput.files[0].name;\n\t\tlet fileType = 'file'; // TODO set type by fileInput type\n\n\t\tlet diskFolderId = this.getDiskFolderId();\n\n\t\tlet query = {};\n\n\t\tif (diskFolderId)\n\t\t{\n\t\t\tquery[RestMethod.diskFileUpload] = [RestMethod.diskFileUpload, {\n\t\t\t\tid : diskFolderId,\n\t\t\t\tdata : {NAME : fileName},\n\t\t\t\tfileContent: file.fileInput,\n\t\t\t\tgenerateUniqueName: true\n\t\t\t}];\n\t\t}\n\t\telse\n\t\t{\n\t\t\tquery[RestMethod.diskFolderGet] = [RestMethod.diskFolderGet, {chat_id: this.getChatId()}];\n\t\t\tquery[RestMethod.diskFileUpload] = [RestMethod.diskFileUpload, {\n\t\t\t\tid : '$result[' + RestMethod.diskFolderGet + '][ID]',\n\t\t\t\tdata : {\n\t\t\t\t\tNAME : fileName\n\t\t\t\t},\n\t\t\t\tfileContent: file.fileInput,\n\t\t\t\tgenerateUniqueName: true\n\t\t\t}];\n\t\t}\n\t\tquery[RestMethod.diskFileCommit] = [RestMethod.diskFileCommit, {\n\t\t\tchat_id : this.getChatId(),\n\t\t\tupload_id : '$result[' + RestMethod.diskFileUpload + '][ID]',\n\t\t}];\n\n\t\tthis.store.commit(WidgetStore.widgetData, {uploadFilePlus: true}); // TODO remove this after create new load workflow\n\n\t\tthis.restClient.callBatch(query, (response) =>\n\t\t{\n\t\t\tthis.store.commit(WidgetStore.widgetData, {uploadFileMinus: true}); // TODO  remove this after create new load workflow\n\n\t\t\tif (!response)\n\t\t\t{\n\t\t\t\tthis.requestDataSend = false;\n\t\t\t\tthis.setError('EMPTY_RESPONSE', 'Server returned an empty response.');\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (!diskFolderId)\n\t\t\t{\n\t\t\t\tlet diskFolderGet = response[RestMethod.diskFolderGet];\n\t\t\t\tif (diskFolderGet && diskFolderGet.error())\n\t\t\t\t{\n\t\t\t\t\tconsole.warn(diskFolderGet.error().ex.error, diskFolderGet.error().ex.error_description);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tthis.storeDataFromRest(RestMethod.diskFolderGet, diskFolderGet.data());\n\t\t\t}\n\n\t\t\tlet diskFileUpload = response[RestMethod.diskFileUpload];\n\t\t\tif (diskFileUpload && diskFileUpload.error())\n\t\t\t{\n\t\t\t\tconsole.warn(diskFileUpload.error().ex.error, diskFileUpload.error().ex.error_description);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tBX.Messenger.Logger.log('upload success', diskFileUpload.data())\n\t\t\t}\n\n\t\t\tlet diskFileCommit = response[RestMethod.diskFileCommit];\n\t\t\tif (diskFileCommit && diskFileCommit.error())\n\t\t\t{\n\t\t\t\tconsole.warn(diskFileCommit.error().ex.error, diskFileCommit.error().ex.error_description);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tBX.Messenger.Logger.log('commit success', diskFileCommit.data())\n\t\t\t}\n\t\t}, false, false, BX.Messenger.Utils.getLogTrackingParams({\n\t\t\tname: RestMethod.diskFileCommit,\n\t\t\tdata: {timMessageType: fileType},\n\t\t\tdialog: this.getDialogData()\n\t\t}));\n\n\t\tthis.filesQueue = this.filesQueue.filter(el => el.id != file.id);\n\t}\n\n\tsendDialogVote(result)\n\t{\n\t\tif (!this.getSessionId())\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.restClient.callMethod(RestMethod.widgetVoteSend, {\n\t\t\t'SESSION_ID': this.getSessionId(),\n\t\t\t'ACTION': result\n\t\t}).catch((result) => {\n\t\t\tthis.store.commit(WidgetStore.dialogData, {userVote: VoteType.none});\n\t\t});\n\n\t\tthis.sendEvent({\n\t\t\ttype: SubscriptionType.userVote,\n\t\t\tdata: {\n\t\t\t\tvote: result\n\t\t\t}\n\t\t});\n\t}\n\n\tsendForm(type, fields)\n\t{\n\t\tBX.Messenger.Logger.info('LiveChatWidgetPrivate.sendForm:', type, fields);\n\n\t\tlet query = {\n\t\t\t[RestMethod.widgetFormSend]: [RestMethod.widgetFormSend, {\n\t\t\t\t'CHAT_ID': this.getChatId(),\n\t\t\t\t'FORM': type.toUpperCase(),\n\t\t\t\t'FIELDS': fields\n\t\t\t}],\n\t\t\t[RestMethod.widgetUserGet]: [RestMethod.widgetUserGet, {}]\n\t\t};\n\t\tthis.restClient.callBatch(query, (response) =>\n\t\t{\n\t\t\tif (!response)\n\t\t\t{\n\t\t\t\tthis.requestDataSend = false;\n\t\t\t\tthis.setError('EMPTY_RESPONSE', 'Server returned an empty response.');\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tlet userGetResult = response[RestMethod.widgetUserGet];\n\t\t\tif (userGetResult.error())\n\t\t\t{\n\t\t\t\tthis.requestDataSend = false;\n\t\t\t\tthis.setError(userGetResult.error().ex.error, userGetResult.error().ex.error_description);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tthis.storeDataFromRest(RestMethod.widgetUserGet, userGetResult.data());\n\n\t\t\tthis.sendEvent({\n\t\t\t\ttype: SubscriptionType.userForm,\n\t\t\t\tdata: {\n\t\t\t\t\tform: type,\n\t\t\t\t\tfields: fields\n\t\t\t\t}\n\t\t\t});\n\n\t\t}, false, false, BX.Messenger.Utils.getLogTrackingParams({name: RestMethod.widgetUserGet, dialog: this.getDialogData()}));\n\n\t}\n\n\tsendConsentDecision(result)\n\t{\n\t\tresult = result === true;\n\n\t\tthis.store.commit(WidgetStore.dialogData, {userConsent: result});\n\n\t\tif (result && this.isUserRegistered())\n\t\t{\n\t\t\tthis.restClient.callMethod(RestMethod.widgetUserConsentApply, {\n\t\t\t\tconfig_id: this.getConfigId(),\n\t\t\t\tconsent_url: location.href\n\t\t\t});\n\t\t}\n\t}\n\n\tgetDialogHistory(lastId, limit = this.requestMessageLimit)\n\t{\n\t\tthis.restClient.callMethod(RestMethod.imDialogMessagesGet, {\n\t\t\t'CHAT_ID': this.getChatId(),\n\t\t\t'LAST_ID': lastId,\n\t\t\t'LIMIT': limit,\n\t\t\t'CONVERT_TEXT': 'Y'\n\t\t}).then(result => {\n\t\t\tlet requestResult = result.data();\n\t\t\tthis.storeDataFromRest(RestMethod.imDialogMessagesGet, requestResult);\n\t\t\tthis.template.$emit('onDialogRequestHistoryResult', {count: requestResult.messages.length});\n\t\t}).catch(result => {\n\t\t\tthis.template.$emit('onDialogRequestHistoryResult', {error: result.error().ex});\n\t\t});\n\t}\n\n\tgetDialogUnread(lastId, limit = this.requestMessageLimit)\n\t{\n\t\tconst promise = new BX.Promise();\n\n\t\tif (!lastId)\n\t\t{\n\t\t\tlastId = this.store.getters[MessengerMessageGetters.getLastId](this.getChatId());\n\t\t}\n\n\t\tif (!lastId)\n\t\t{\n\t\t\tthis.template.$emit('onDialogRequestUnreadResult', {error: {error: 'LAST_ID_EMPTY', error_description: 'LastId is empty.'}});\n\t\t\tpromise.reject();\n\t\t\treturn promise;\n\t\t}\n\n\t\tlet query = {\n\t\t\t[RestMethod.imChatGet]: [RestMethod.imChatGet, {\n\t\t\t\tdialog_id: this.getDialogId()\n\t\t\t}],\n\t\t\t[RestMethod.imDialogMessagesUnread]: [RestMethod.imDialogMessagesGet, {\n\t\t\t\tchat_id: this.getChatId(),\n\t\t\t\tfirst_id: lastId,\n\t\t\t\tlimit: limit,\n\t\t\t\tconvert_text: 'Y'\n\t\t\t}]\n\t\t};\n\n\t\tthis.restClient.callBatch(query, (response) =>\n\t\t{\n\t\t\tif (!response)\n\t\t\t{\n\t\t\t\tthis.template.$emit('onDialogRequestUnreadResult', {error: {error: 'EMPTY_RESPONSE', error_description: 'Server returned an empty response.'}});\n\n\t\t\t\tpromise.reject();\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tlet chatGetResult = response[RestMethod.imChatGet];\n\t\t\tif (!chatGetResult.error())\n\t\t\t{\n\t\t\t\tthis.storeDataFromRest(RestMethod.imChatGet, chatGetResult.data());\n\t\t\t}\n\n\t\t\tlet dialogMessageUnread = response[RestMethod.imDialogMessagesUnread];\n\t\t\tif (dialogMessageUnread.error())\n\t\t\t{\n\t\t\t\tthis.template.$emit('onDialogRequestUnreadResult', {error: dialogMessageUnread.error().ex});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tlet dialogMessageUnreadResult = dialogMessageUnread.data();\n\t\t\t\tthis.storeDataFromRest(RestMethod.imDialogMessagesUnread, dialogMessageUnreadResult);\n\t\t\t\tthis.template.$emit('onDialogRequestUnreadResult', {count: dialogMessageUnreadResult.messages.length});\n\t\t\t}\n\n\t\t\tpromise.fulfill(response);\n\n\t\t}, false, false, BX.Messenger.Utils.getLogTrackingParams({name: RestMethod.imDialogMessagesUnread, dialog: this.getDialogData()}));\n\n\t\treturn promise;\n\t}\n\n\tretrySendMessage(message)\n\t{\n\t\tif (this.messagesQueue.find(el => el.id == message.id))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.messagesQueue.push({\n\t\t\tid: message.id,\n\t\t\ttext: message.text,\n\t\t\tsending: false\n\t\t});\n\n\t\tthis.store.dispatch(MessengerMessageStore.actionStart, {\n\t\t\tid: message.id,\n\t\t\tchatId: this.getChatId()\n\t\t});\n\n\t\tthis.processSendMessages();\n\t}\n\n\treadMessage(messageId)\n\t{\n\t\tif (messageId)\n\t\t{\n\t\t\tthis.messageReadQueue.push(parseInt(messageId));\n\t\t}\n\n\t\tif (this.offline)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.timer.start('readMessage', null, .1, (id, params) =>\n\t\t{\n\t\t\tthis.messageReadQueue = this.messageReadQueue.filter(elementId => {\n\t\t\t\tif (!this.messageLastReadId)\n\t\t\t\t{\n\t\t\t\t\tthis.messageLastReadId = elementId;\n\t\t\t\t}\n\t\t\t\telse if (this.messageLastReadId < elementId)\n\t\t\t\t{\n\t\t\t\t\tthis.messageLastReadId = elementId;\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t});\n\n\t\t\tif (this.messageLastReadId <= 0)\n\t\t\t{\n\t\t\t\treturn false\n\t\t\t}\n\n\t\t\tthis.store.dispatch(MessengerMessageStore.readMessages, {\n\t\t\t\tchatId: this.getChatId(),\n\t\t\t\treadId: this.messageLastReadId\n\t\t\t}).then(result => {\n\t\t\t\tthis.store.dispatch(MessengerDialogStore.decreaseCounter, {\n\t\t\t\t\tdialogId: this.getDialogId(),\n\t\t\t\t\tcount: result.count\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tthis.timer.start('readMessageServer', null, .5, (id, params) => {\n\t\t\t\tthis.restClient.callMethod(RestMethod.imDialogRead, {\n\t\t\t\t\t'DIALOG_ID': this.getDialogId(),\n\t\t\t\t\t'MESSAGE_ID': this.messageLastReadId\n\t\t\t\t})\n\t\t\t\t// TODO catch set message to unread status\n\t\t\t});\n\t\t});\n\t}\n\n/* endregion 05. Templates and template interaction */\n\n/* region 03-05. Messenger interaction and utils */\n\tstartWriting(params)\n\t{\n\t\tlet {dialogId, userId, userName, action = true} = params;\n\n\t\tif (action)\n\t\t{\n\t\t\tthis.store.dispatch(MessengerDialogStore.updateWriting, {\n\t\t\t\tdialogId,\n\t\t\t\tuserId,\n\t\t\t\tuserName,\n\t\t\t\taction : true\n\t\t\t});\n\n\t\t\tthis.timer.start('writingEnd', dialogId+'|'+userId, 35, (id, params) => {\n\t\t\t\tlet {dialogId, userId} = params;\n\t\t\t\tthis.store.dispatch(MessengerDialogStore.updateWriting, {\n\t\t\t\t\tdialogId,\n\t\t\t\t\tuserId,\n\t\t\t\t\taction: false\n\t\t\t\t});\n\t\t\t}, {dialogId, userId});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.timer.stop('writingStart', dialogId+'|'+userId, true);\n\t\t\tthis.timer.stop('writingEnd', dialogId+'|'+userId);\n\t\t}\n\t};\n/* endregion */\n\n/* region 03-06. Widget interaction and utils */\n\n\tstart()\n\t{\n\t\tif (this.isSessionActive())\n\t\t{\n\t\t\tthis.requestWidgetData();\n\t\t}\n\t}\n\n\topen(params = {})\n\t{\n\t\tif (!params.openFromButton && this.buttonInstance)\n\t\t{\n\t\t\tthis.buttonInstance.wm.showById('openline_livechat');\n\t\t}\n\n\t\tif (!this.checkBrowserVersion())\n\t\t{\n\t\t\tthis.setError('OLD_BROWSER_LOCALIZED', this.localize.BX_LIVECHAT_OLD_BROWSER);\n\t\t}\n\t\telse if (BX.Messenger.Utils.versionCompare(Vue.version, '2.1') < 0)\n\t\t{\n\t\t\talert(this.localize.BX_LIVECHAT_OLD_VUE);\n\t\t\tconsole.error(`LiveChatWidget.error: OLD_VUE_VERSION (${this.localize.BX_LIVECHAT_OLD_VUE_DEV.replace('#CURRENT_VERSION#', Vue.version)})`);\n\n\t\t\treturn false;\n\t\t}\n\t\telse if (!this.isWidgetDataRequested())\n\t\t{\n\t\t\tthis.requestWidgetData();\n\t\t}\n\n\t\tthis.attachTemplate();\n\t}\n\n\tclose()\n\t{\n\t\tif (this.pageMode)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tif (this.buttonInstance)\n\t\t{\n\t\t\tthis.buttonInstance.onWidgetClose();\n\t\t}\n\t\tthis.detachTemplate();\n\t}\n\n\tshowNotification(params)\n\t{\n\t\t// TODO show popup notification and set badge on button\n\t\t// operatorName\n\t\t// notificationText\n\t\t// counter\n\t}\n\n\tfireInitEvent()\n\t{\n\t\tif (this.initEventFired)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tthis.sendEvent({\n\t\t\ttype: SubscriptionType.configLoaded,\n\t\t\tdata: {}\n\t\t});\n\n\t\tif (this.store.state.widget.widgetData.reopen)\n\t\t{\n\t\t\tthis.open();\n\t\t}\n\n\t\tthis.initEventFired = true;\n\n\t\treturn true;\n\t}\n\n\tisReady()\n\t{\n\t\treturn this.ready;\n\t}\n\n\tisInited()\n\t{\n\t\treturn this.inited;\n\t}\n\n\tisUserRegistered()\n\t{\n\t\treturn !!this.getUserHash();\n\t}\n\n\tisConfigDataLoaded()\n\t{\n\t\treturn this.store.state.widget.widgetData.configId;\n\t}\n\n\tisWidgetDataRequested()\n\t{\n\t\treturn this.widgetDataRequested;\n\t}\n\n\tisChatLoaded()\n\t{\n\t\treturn this.store.state.widget.dialogData.chatId > 0;\n\t}\n\n\tisSessionActive()\n\t{\n\t\treturn !this.store.state.widget.dialogData.sessionClose;\n\t}\n\n\tgetCrmTraceData()\n\t{\n\t\tlet traceData = '';\n\n\t\tif (!this.buttonInstance)\n\t\t{\n\t\t\treturn traceData;\n\t\t}\n\n\t\tif (typeof this.buttonInstance.getTrace !== 'function')\n\t\t{\n\t\t\ttraceData = this.buttonInstance.getTrace();\n\t\t}\n\t\telse if (\n\t\t\ttypeof this.buttonInstance.b24Tracker !== 'undefined'\n\t\t\t&& typeof this.buttonInstance.b24Tracker.guest !== 'undefined'\n\t\t)\n\t\t{\n\t\t\ttraceData = this.buttonInstance.b24Tracker.guest.getTrace();\n\t\t}\n\n\t\treturn traceData;\n\t}\n\n\tgetCustomData()\n\t{\n\t\tlet customData = [];\n\n\t\tif (this.customData.length > 0)\n\t\t{\n\t\t\tcustomData = this.customData;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tcustomData = [{MESSAGE: this.localize.BX_LIVECHAT_EXTRA_SITE+': '+location.href}];\n\t\t}\n\n\t\treturn JSON.stringify(customData);\n\t}\n\n\tisUserLoaded()\n\t{\n\t\treturn this.store.state.widget.userData.id > 0;\n\t}\n\n\tgetSiteId()\n\t{\n\t\treturn this.host.replace(/(http.?:\\/\\/)|([:.\\\\\\/])/mg, \"\")+this.code;\n\t}\n\n\tgetMessageLimit()\n\t{\n\t\treturn this.store.state.widget.dialogData.messageLimit;\n\t}\n\n\tisUnreadMessagesLoaded()\n\t{\n\t\tlet dialog = this.store.state[MessengerStore.dialogues].collection[this.getDialogId()];\n\t\tif (!dialog)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tif (dialog.unreadLastId <= 0)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tlet collection = this.store.state[MessengerStore.messages].collection[this.getChatId()];\n\t\tif (!collection || collection.length <= 0)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tlet lastElementId = 0;\n\t\tfor (let index = collection.length-1; index >= 0; index--)\n\t\t{\n\t\t\tlet lastElement = collection[index];\n\t\t\tif (typeof lastElement.id === \"number\")\n\t\t\t{\n\t\t\t\tlastElementId = lastElement.id;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\treturn lastElementId >= dialog.unreadLastId;\n\t}\n\n\tgetHost()\n\t{\n\t\treturn this.host;\n\t}\n\n\tgetConfigId()\n\t{\n\t\treturn this.store.state.widget.widgetData.configId;\n\t}\n\n\tgetChatId()\n\t{\n\t\treturn this.store.state.widget.dialogData.chatId;\n\t}\n\n\tisDialogStart()\n\t{\n\t\treturn this.store.state.widget.widgetData.dialogStart;\n\t}\n\n\tgetDialogId()\n\t{\n\t\treturn 'chat'+this.getChatId();\n\t}\n\n\tgetDialogData(dialogId = this.getDialogId())\n\t{\n\t\treturn this.store.state[MessengerStore.dialogues].collection[dialogId];\n\t}\n\n\tgetDiskFolderId()\n\t{\n\t\treturn this.store.state.widget.dialogData.diskFolderId;\n\t}\n\n\tgetSessionId()\n\t{\n\t\treturn this.store.state.widget.dialogData.sessionId;\n\t}\n\n\tgetUserHash()\n\t{\n\t\treturn this.store.state.widget.userData.hash;\n\t}\n\n\tgetUserHashCookie()\n\t{\n\t\tlet userHash = '';\n\n\t\tlet cookie = Cookie.get(null, 'LIVECHAT_HASH');\n\t\tif (typeof cookie === 'string' && cookie.match(/^[a-f0-9]{32}$/))\n\t\t{\n\t\t\tuserHash= cookie;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tlet cookie = Cookie.get(this.getSiteId(), 'LIVECHAT_HASH');\n\t\t\tif (typeof cookie === 'string' && cookie.match(/^[a-f0-9]{32}$/))\n\t\t\t{\n\t\t\t\tuserHash = cookie;\n\t\t\t}\n\t\t}\n\n\t\treturn userHash;\n\t}\n\n\tgetUserId()\n\t{\n\t\treturn this.store.state.widget.userData.id;\n\t}\n\n\tgetUserData()\n\t{\n\t\treturn this.store.state.widget.userData;\n\t}\n\n\tgetUserRegisterFields()\n\t{\n\t\treturn {\n\t\t\t'name': this.userRegisterData.name || '',\n\t\t\t'last_name': this.userRegisterData.lastName || '',\n\t\t\t'avatar': this.userRegisterData.avatar || '',\n\t\t\t'email': this.userRegisterData.email || '',\n\t\t\t'www': this.userRegisterData.www || '',\n\t\t\t'gender': this.userRegisterData.gender || '',\n\t\t\t'position': this.userRegisterData.position || '',\n\t\t\t'user_hash': this.userRegisterData.hash || '',\n\t\t\t'consent_url': this.store.state.widget.widgetData.consentUrl? location.href: '',\n\t\t\t'trace_data': this.getCrmTraceData(),\n\t\t\t'custom_data': this.getCustomData()\n\t\t}\n\t}\n\n\tgetWidgetLocationCode()\n\t{\n\t\treturn LocationStyle[this.store.state.widget.widgetData.location];\n\t}\n\n\tsetUserRegisterData(params)\n\t{\n\t\tconst validUserFields = ['hash', 'name', 'lastName', 'avatar', 'email', 'www', 'gender', 'position'];\n\n\t\tif (!BX.Messenger.Utils.types.isPlainObject(params))\n\t\t{\n\t\t\tconsole.error(`%cLiveChatWidget.setUserData: params is not a object`, \"color: black;\");\n\t\t\treturn false;\n\t\t}\n\n\t\tfor (let field in this.userRegisterData)\n\t\t{\n\t\t\tif (!this.userRegisterData.hasOwnProperty(field))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (!params[field])\n\t\t\t{\n\t\t\t\tdelete this.userRegisterData[field];\n\t\t\t}\n\t\t}\n\n\t\tfor (let field in params)\n\t\t{\n\t\t\tif (!params.hasOwnProperty(field))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (validUserFields.indexOf(field) === -1)\n\t\t\t{\n\t\t\t\tconsole.warn(`%cLiveChatWidget.setUserData: user field is not set, because you are trying to set an unknown field (%c${field}%c)`, \"color: black;\", \"font-weight: bold; color: red\", \"color: black\");\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tthis.userRegisterData[field] = params[field];\n\t\t}\n\n\t\tif (\n\t\t\tthis.userRegisterData.hash\n\t\t\t&& this.getUserHash()\n\t\t\t&& this.userRegisterData.hash != this.getUserHash()\n\t\t)\n\t\t{\n\t\t\tthis.setNewAuthToken(this.userRegisterData.hash);\n\t\t}\n\t}\n\n\tsetNewAuthToken(authToken = '')\n\t{\n\t\tlet siteId = this.getSiteId();\n\n\t\tthis.store.commit(WidgetStore.userData, {\n\t\t\tid: 0,\n\t\t\thash: '',\n\t\t});\n\t\tthis.store.commit(WidgetStore.widgetData, {\n\t\t\tconfigId: 0,\n\t\t\tdialogStart: false,\n\t\t});\n\t\tthis.store.commit(WidgetStore.dialogData, {\n\t\t\tchatId: 0,\n\t\t\tdiskFolderId: 0,\n\t\t\tsessionId: 0,\n\t\t\tsessionClose: false,\n\t\t\tuserVote: false,\n\t\t\tuserConsent: false,\n\t\t});\n\n\t\tBX.LiveChatCookie = {};\n\t\tBX.Messenger.LocalStorage.remove(siteId, 0, WidgetStore.widgetData);\n\t\tBX.Messenger.LocalStorage.remove(siteId, 0, WidgetStore.dialogData);\n\t\tBX.Messenger.LocalStorage.remove(siteId, 0, WidgetStore.userData);\n\n\t\tCookie.set(null, 'LIVECHAT_HASH', '', {expires: 365*86400, path: '/'});\n\n\t\tthis.restClient.setAuthId(RestAuth.guest, authToken);\n\t}\n\n\tsetCustomData(params)\n\t{\n\t\tlet result = [];\n\t\tif (params instanceof Array)\n\t\t{\n\t\t\tparams.forEach(element =>\n\t\t\t{\n\t\t\t\tif (element && typeof element === 'object')\n\t\t\t\t{\n\t\t\t\t\tresult.push(element);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (result.length <= 0)\n\t\t\t{\n\t\t\t\tconsole.error('LiveChatWidget.setCustomData: params is empty');\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (!params)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tresult = [{'MESSAGE': params}]\n\t\t}\n\n\t\tthis.customData = this.customData.concat(result);\n\n\t\treturn true;\n\t}\n\n\tsetError(code = '', description = '')\n\t{\n\t\tconsole.error(`LiveChatWidget.error: ${code} (${description})`);\n\n\t\tlet localizeDescription = '';\n\t\tif (code == 'LIVECHAT_AUTH_FAILED')\n\t\t{\n\t\t\tlocalizeDescription = this.getLocalize('BX_LIVECHAT_AUTH_FAILED').replace('#LINK_START#', '<a href=\"#reload\" onclick=\"location.reload()\">').replace('#LINK_END#', '</a>');\n\t\t\tthis.setNewAuthToken();\n\t\t}\n\t\telse if (code == 'LIVECHAT_AUTH_PORTAL_USER')\n\t\t{\n\t\t\tlocalizeDescription = this.getLocalize('BX_LIVECHAT_PORTAL_USER_NEW').replace('#LINK_START#', '<a href=\"'+this.host+'\">').replace('#LINK_END#', '</a>')\n\t\t}\n\t\telse if (code.endsWith('LOCALIZED'))\n\t\t{\n\t\t\tlocalizeDescription = description;\n\t\t}\n\n\t\tthis.store.commit(WidgetStore.widgetData, {error: {active: true, code, description: localizeDescription}});\n\t}\n\n\tclearError()\n\t{\n\t\tthis.store.commit(WidgetStore.widgetData, {error: {active: false, code: '', description: ''}});\n\t}\n\n\t/**\n\t *\n\t * @param params {Object}\n\t * @returns {Function|Boolean} - Unsubscribe callback function or False\n\t */\n\tsubscribe(params)\n\t{\n\t\tif (!BX.Messenger.Utils.types.isPlainObject(params))\n\t\t{\n\t\t\tconsole.error(`%cLiveChatWidget.subscribe: params is not a object`, \"color: black;\");\n\t\t\treturn false;\n\t\t}\n\n\t\tif (!SubscriptionTypeCheck.includes(params.type))\n\t\t{\n\t\t\tconsole.error(`%cLiveChatWidget.subscribe: subscription type is not correct (%c${params.type}%c)`, \"color: black;\", \"font-weight: bold; color: red\", \"color: black\");\n\t\t\treturn false;\n\t\t}\n\n\t\tif (typeof params.callback !== 'function')\n\t\t{\n\t\t\tconsole.error(`%cLiveChatWidget.subscribe: callback is not a function (%c${typeof params.callback}%c)`, \"color: black;\", \"font-weight: bold; color: red\", \"color: black\");\n\t\t\treturn false;\n\t\t}\n\n\t\tif (typeof (this.subscribers[params.type]) === 'undefined')\n\t\t{\n\t\t\tthis.subscribers[params.type] = [];\n\t\t}\n\n\t\tthis.subscribers[params.type].push(params.callback);\n\n\t\treturn function () {\n\t\t\tthis.subscribers[params.type] = this.subscribers[params.type].filter(function(element) {\n\t\t\t\treturn element !== params.callback;\n\t\t\t});\n\t\t}.bind(this);\n\t}\n\n\t/**\n\t *\n\t * @param params {Object}\n\t * @returns {boolean}\n\t */\n\tsendEvent(params)\n\t{\n\t\tparams = params || {};\n\n\t\tif (!params.type)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tif (typeof params.data !== 'object' || !params.data)\n\t\t{\n\t\t\tparams.data = {};\n\t\t}\n\n\t\tif (this.subscribers[params.type] instanceof Array && this.subscribers[params.type].length > 0)\n\t\t{\n\t\t\tthis.subscribers[params.type].forEach(callback => callback(params.data));\n\t\t}\n\n\t\tif (this.subscribers[SubscriptionType.every] instanceof Array && this.subscribers[SubscriptionType.every].length > 0)\n\t\t{\n\t\t\tthis.subscribers[SubscriptionType.every].forEach(callback => callback({type: params.type, data: params.data}));\n\t\t}\n\n\t\treturn true;\n\t}\n\n\taddLocalize(phrases)\n\t{\n\t\tif (typeof phrases !== \"object\")\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tfor (let name in phrases)\n\t\t{\n\t\t\tif (phrases.hasOwnProperty(name))\n\t\t\t{\n\t\t\t\tthis.localize[name] = phrases[name];\n\t\t\t}\n\t\t}\n\n\t\treturn true;\n\t};\n\n\tgetLocalize(name)\n\t{\n\t\tlet phrase = '';\n\t\tif (typeof name === 'undefined')\n\t\t{\n\t\t\treturn this.localize;\n\t\t}\n\t\telse if (typeof this.localize[name.toString()] === 'undefined')\n\t\t{\n\t\t\tconsole.warn(`LiveChatWidget.getLocalize: message with code '${name.toString()}' is undefined.`)\n\t\t}\n\t\telse\n\t\t{\n\t\t\tphrase = this.localize[name];\n\t\t}\n\n\t\treturn phrase;\n\t}\n\n\tgetDateFormat()\n\t{\n\t\tif (this.dateFormat)\n\t\t{\n\t\t\treturn this.dateFormat;\n\t\t}\n\n\t\tthis.dateFormat = Object.create(BX.Main.Date);\n\t\tthis.dateFormat._getMessage = (phrase) => this.getLocalize(phrase);\n\n\t\treturn this.dateFormat;\n\t}\n\n\t/* endregion */\n}\n/* endregion 03. Widget private interface */\n\n\n\n\n/* region 04. Cookie function */\nconst Cookie =\n{\n\tget(siteId, name)\n\t{\n\t\tlet cookieName = siteId? siteId+'_'+name: name;\n\n\t\tif (navigator.cookieEnabled)\n\t\t{\n\t\t\tlet result = document.cookie.match(new RegExp(\n\t\t\t\t\"(?:^|; )\" + cookieName.replace(/([.$?*|{}()\\[\\]\\\\\\/+^])/g, '\\\\$1') + \"=([^;]*)\"\n\t\t\t));\n\n\t\t\tif (result)\n\t\t\t{\n\t\t\t\treturn decodeURIComponent(result[1]);\n\t\t\t}\n\t\t}\n\n\t\tif (BX.Messenger.LocalStorage.isEnabled())\n\t\t{\n\t\t\tlet result = BX.Messenger.LocalStorage.get(siteId, 0, name, undefined);\n\t\t\tif (typeof result !== 'undefined')\n\t\t\t{\n\t\t\t\treturn result;\n\t\t\t}\n\t\t}\n\n\t\tif (typeof BX.LiveChatCookie === 'undefined')\n\t\t{\n\t\t\tBX.LiveChatCookie = {};\n\t\t}\n\n\t\treturn BX.LiveChatCookie[cookieName];\n\t},\n\tset(siteId, name, value, options)\n\t{\n\t\toptions = options || {};\n\n\t\tlet expires = options.expires;\n\t\tif (typeof(expires) == \"number\" && expires)\n\t\t{\n\t\t\tlet currentDate = new Date();\n\t\t\tcurrentDate.setTime(currentDate.getTime() + expires * 1000);\n\t\t\texpires = options.expires = currentDate;\n\t\t}\n\n\t\tif (expires && expires.toUTCString)\n\t\t{\n\t\t\toptions.expires = expires.toUTCString();\n\t\t}\n\n\t\tvalue = encodeURIComponent(value);\n\n\t\tlet cookieName = siteId? siteId+'_'+name: name;\n\t\tlet updatedCookie = cookieName + \"=\" + value;\n\n\t\tfor (let propertyName in options)\n\t\t{\n\t\t\tif (!options.hasOwnProperty(propertyName))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tupdatedCookie += \"; \" + propertyName;\n\n\t\t\tlet propertyValue = options[propertyName];\n\t\t\tif (propertyValue !== true)\n\t\t\t{\n\t\t\t\tupdatedCookie += \"=\" + propertyValue;\n\t\t\t}\n\t\t}\n\n\t\tdocument.cookie = updatedCookie;\n\n\t\tif (typeof BX.LiveChatCookie === 'undefined')\n\t\t{\n\t\t\tBX.LiveChatCookie = {};\n\t\t}\n\n\t\tBX.LiveChatCookie[cookieName] = value;\n\t\tBX.Messenger.LocalStorage.set(siteId, 0, name, value);\n\n\t\treturn true;\n\t}\n};\n/* endregion 04. Cookie function */\n\n/* region 05. Rest client */\n\nclass LiveChatRestClient\n{\n\tconstructor(params)\n\t{\n\t\tthis.queryAuthRestore = false;\n\n\t\tthis.setAuthId(RestAuth.guest);\n\n\t\tthis.restClient = new BX.RestClient({\n\t\t\tendpoint: params.endpoint,\n\t\t\tqueryParams: this.queryParams,\n\t\t\tcors: true\n\t\t});\n\t}\n\n\tsetAuthId(authId, customAuthId = '')\n\t{\n\t\tif (typeof this.queryParams !== 'object')\n\t\t{\n\t\t\tthis.queryParams = {};\n\t\t}\n\n\t\tif (\n\t\t\tauthId == RestAuth.guest\n\t\t\t|| typeof authId === 'string' && authId.match(/^[a-f0-9]{32}$/)\n\t\t)\n\t\t{\n\t\t\tthis.queryParams.livechat_auth_id = authId;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconsole.error(`%LiveChatRestClient.setAuthId: auth is not correct (%c${authId}%c)`, \"color: black;\", \"font-weight: bold; color: red\", \"color: black\");\n\t\t\treturn false;\n\t\t}\n\n\t\tif (\n\t\t\tauthId == RestAuth.guest\n\t\t\t&& typeof customAuthId === 'string' && customAuthId.match(/^[a-f0-9]{32}$/)\n\t\t)\n\t\t{\n\t\t\tthis.queryParams.livechat_custom_auth_id = customAuthId;\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tgetAuthId()\n\t{\n\t\tif (typeof this.queryParams !== 'object')\n\t\t{\n\t\t\tthis.queryParams = {};\n\t\t}\n\n\t\treturn this.queryParams.livechat_auth_id || null;\n\t}\n\n\tcallMethod(method, params, callback, sendCallback, logTag = null)\n\t{\n\t\tif (!logTag)\n\t\t{\n\t\t\tlogTag = BX.Messenger.Utils.getLogTrackingParams({\n\t\t\t\tname: method,\n\t\t\t});\n\t\t}\n\n\t\tconst promise = new BX.Promise();\n\n\t\tthis.restClient.callMethod(method, params, null, sendCallback, logTag).then(result => {\n\n\t\t\tthis.queryAuthRestore = false;\n\t\t\tpromise.fulfill(result);\n\n\t\t}).catch(result => {\n\n\t\t\tlet error = result.error();\n\t\t\tif (error.ex.error == 'LIVECHAT_AUTH_WIDGET_USER')\n\t\t\t{\n\t\t\t\tthis.setAuthId(error.ex.hash);\n\n\t\t\t\tif (method === RestMethod.widgetUserRegister)\n\t\t\t\t{\n\t\t\t\t\tconsole.warn(`BX.LiveChatRestClient: ${error.ex.error_description} (${error.ex.error})`);\n\n\t\t\t\t\tthis.queryAuthRestore = false;\n\t\t\t\t\tpromise.reject(result);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tif (!this.queryAuthRestore)\n\t\t\t\t{\n\t\t\t\t\tconsole.warn('BX.LiveChatRestClient: your auth-token has expired, send query with a new token');\n\n\t\t\t\t\tthis.queryAuthRestore = true;\n\t\t\t\t\tthis.restClient.callMethod(method, params, null, sendCallback, logTag).then(result => {\n\t\t\t\t\t\tthis.queryAuthRestore = false;\n\t\t\t\t\t\tpromise.fulfill(result);\n\t\t\t\t\t}).catch(result => {\n\t\t\t\t\t\tthis.queryAuthRestore = false;\n\t\t\t\t\t\tpromise.reject(result);\n\t\t\t\t\t});\n\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.queryAuthRestore = false;\n\t\t\tpromise.reject(result);\n\t\t});\n\n\t\treturn promise;\n\t};\n\n\tcallBatch(calls, callback, bHaltOnError, sendCallback, logTag)\n\t{\n\t\tlet resultCallback = (result) =>\n\t\t{\n\t\t\tlet error = null;\n\t\t\tfor (let method in calls)\n\t\t\t{\n\t\t\t\tif (!calls.hasOwnProperty(method))\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tlet error = result[method].error();\n\t\t\t\tif (error && error.ex.error == 'LIVECHAT_AUTH_WIDGET_USER')\n\t\t\t\t{\n\t\t\t\t\tthis.setAuthId(error.ex.hash);\n\t\t\t\t\tif (method === RestMethod.widgetUserRegister)\n\t\t\t\t\t{\n\t\t\t\t\t\tconsole.warn(`BX.LiveChatRestClient: ${error.ex.error_description} (${error.ex.error})`);\n\n\t\t\t\t\t\tthis.queryAuthRestore = false;\n\t\t\t\t\t\tcallback(result);\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!this.queryAuthRestore)\n\t\t\t\t\t{\n\t\t\t\t\t\tconsole.warn('BX.LiveChatRestClient: your auth-token has expired, send query with a new token');\n\n\t\t\t\t\t\tthis.queryAuthRestore = true;\n\t\t\t\t\t\tthis.restClient.callBatch(calls, callback, bHaltOnError, sendCallback, logTag);\n\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.queryAuthRestore = false;\n\t\t\tcallback(result);\n\n\t\t\treturn true;\n\t\t};\n\n\t\treturn this.restClient.callBatch(calls, resultCallback, bHaltOnError, sendCallback, logTag);\n\t};\n}\n\n/* endregion 05. Rest client */\n\n/* region 06. Vue Components */\n\n/* region 06-01. bx-livechat component */\n/**\n * @notice Do not mutate or clone this component! It is under development.\n */\nBX.Vue.component('bx-livechat',\n{\n\tdata()\n\t{\n\t\treturn {\n\t\t\tviewPortMetaSiteNode: null,\n\t\t\tviewPortMetaWidgetNode: null,\n\t\t\tstoredMessage: '',\n\t\t\tstoredFile: null,\n\t\t\ttextareaFocused: false,\n\t\t\ttextareaDrag: false,\n\t\t\ttextareaHeight: 100,\n\t\t\ttextareaMinimumHeight: 100,\n\t\t\ttextareaMaximumHeight: BX.Messenger.Utils.device.isMobile()? 200: 300,\n\t\t\tchat: {\n\t\t\t\tid: 0\n\t\t\t},\n\t\t}\n\t},\n\tcreated()\n\t{\n\t\tthis.onCreated();\n\n\t\tdocument.addEventListener('keydown', this.onWindowKeyDown);\n\t\tthis.$root.$on('requestShowForm', this.onRequestShowForm);\n\t},\n\tbeforeDestroy()\n\t{\n\t\tdocument.removeEventListener('keydown', this.onWindowKeyDown);\n\t\tthis.$root.$off('requestShowForm', this.onRequestShowForm);\n\n\t\tthis.onTextareaDragEventRemove();\n\t},\n\tcomputed:\n\t{\n\t\tFormType: () => FormType,\n\t\tVoteType: () => VoteType,\n\t\tDeviceType: () => DeviceType,\n\t\ttextareaHeightStyle(state)\n\t\t{\n\t\t\treturn 'flex: 0 0 '+this.textareaHeight+'px;'\n\t\t},\n\t\tlocalize()\n\t\t{\n\t\t\treturn BX.Vue.getFilteredPhrases('BX_LIVECHAT_', this.$root.$bitrixMessages);\n\t\t},\n\t\twidgetMobileDisabled(state)\n\t\t{\n\t\t\tif (state.widgetData.deviceType == DeviceType.mobile)\n\t\t\t{\n\t\t\t\tif (navigator.userAgent.toString().includes('iPad'))\n\t\t\t\t{\n\t\t\t\t}\n\t\t\t\telse if (state.widgetData.deviceOrientation == DeviceOrientation.horizontal)\n\t\t\t\t{\n\t\t\t\t\tif (navigator.userAgent.toString().includes('iPhone'))\n\t\t\t\t\t{\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\treturn !(typeof window.screen === 'object' && window.screen.availHeight >= 800);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn false;\n\t\t},\n\t\twidgetClassName(state)\n\t\t{\n\t\t\tlet className = ['bx-livechat-wrapper'];\n\n\t\t\tclassName.push('bx-livechat-show');\n\n\t\t\tif (state.widgetData.pageMode)\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-page-mode');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-position-'+LocationStyle[state.widgetData.location]);\n\t\t\t}\n\n\t\t\tif (state.widgetData.language == LanguageType.russian)\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-logo-ru');\n\t\t\t}\n\t\t\telse if (state.widgetData.language == LanguageType.ukraine)\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-logo-ua');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-logo-en');\n\t\t\t}\n\n\t\t\tif (!state.widgetData.online)\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-offline-state');\n\t\t\t}\n\n\t\t\tif (state.widgetData.dragged)\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-drag-n-drop');\n\t\t\t}\n\n\t\t\tif (state.widgetData.dialogStart)\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-chat-start');\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\tstate.dialogData.operator.name\n\t\t\t\t&& !(state.widgetData.deviceType == DeviceType.mobile && state.widgetData.deviceOrientation == DeviceOrientation.horizontal)\n\t\t\t)\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-has-operator');\n\t\t\t}\n\n\t\t\tif (BX.Messenger.Utils.device.isMobile())\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-mobile');\n\t\t\t}\n\t\t\telse if (BX.Messenger.Utils.browser.isSafari())\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-browser-safari');\n\t\t\t}\n\t\t\telse if (BX.Messenger.Utils.browser.isIe())\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-browser-ie');\n\t\t\t}\n\n\t\t\tif (BX.Messenger.Utils.platform.isMac())\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-mac');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-custom-scroll');\n\t\t\t}\n\n\t\t\tif (state.widgetData.styles.backgroundColor && BX.Messenger.Utils.isDarkColor(state.widgetData.styles.iconColor))\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-bright-header');\n\t\t\t}\n\n\t\t\treturn className.join(' ');\n\t\t},\n\t\tshowMessageDialog()\n\t\t{\n\t\t\treturn this.messageCollection.length > 0;\n\t\t},\n\t\t...BX.Vuex.mapState({\n\t\t\twidgetData: state => state.widget.widgetData,\n\t\t\tuserData: state => state.widget.userData,\n\t\t\tdialogData: state => state.widget.dialogData,\n\t\t\tmessageCollection: state => state[MessengerStore.messages].collection[state.widget.dialogData.chatId]\n\t\t})\n\t},\n\twatch:\n\t{\n\t\tsessionClose(value)\n\t\t{\n\t\t\tBX.Messenger.Logger.log('sessionClose change', value);\n\t\t}\n\t},\n\tmethods:\n\t{\n\t\tclose(event)\n\t\t{\n\t\t\tif (this.$store.state.widget.widgetData.pageMode)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tthis.onBeforeClose();\n\t\t\tthis.$store.commit(WidgetStore.widgetData, {showed: false});\n\t\t},\n\t\tshowLikeForm()\n\t\t{\n\t\t\tif (this.offline)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tclearTimeout(this.showFormTimeout);\n\t\t\tif (!this.$store.state.widget.widgetData.vote.enable)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tif (\n\t\t\t\tthis.$store.state.widget.dialogData.sessionClose\n\t\t\t\t&& this.$store.state.widget.dialogData.userVote != VoteType.none\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tthis.$store.commit(WidgetStore.widgetData, {showForm: FormType.like});\n\t\t},\n\t\tshowWelcomeForm()\n\t\t{\n\t\t\tclearTimeout(this.showFormTimeout);\n\t\t\tthis.$store.commit(WidgetStore.widgetData, {showForm: FormType.welcome});\n\t\t},\n\t\tshowOfflineForm()\n\t\t{\n\t\t\tclearTimeout(this.showFormTimeout);\n\n\t\t\tif (this.$store.state.widget.dialogData.showForm !== FormType.welcome)\n\t\t\t{\n\t\t\t\tthis.$store.commit(WidgetStore.widgetData, {showForm: FormType.offline});\n\t\t\t}\n\t\t},\n\t\tshowHistoryForm()\n\t\t{\n\t\t\tclearTimeout(this.showFormTimeout);\n\t\t\tthis.$store.commit(WidgetStore.widgetData, {showForm: FormType.history});\n\t\t},\n\t\thideForm()\n\t\t{\n\t\t\tclearTimeout(this.showFormTimeout);\n\t\t\tthis.$store.commit(WidgetStore.widgetData, {showForm: FormType.none});\n\t\t},\n\t\tshowConsentWidow()\n\t\t{\n\t\t\tthis.$store.commit(WidgetStore.widgetData, {showConsent: true});\n\t\t},\n\t\tagreeConsentWidow()\n\t\t{\n\t\t\tthis.$store.commit(WidgetStore.widgetData, {showConsent: false});\n\n\t\t\tthis.$root.$bitrixController.sendConsentDecision(true);\n\n\t\t\tif (this.storedMessage || this.storedFile)\n\t\t\t{\n\t\t\t\tif (this.storedMessage)\n\t\t\t\t{\n\t\t\t\t\tthis.onTextareaSend({focus: this.widgetData.deviceType != DeviceType.mobile});\n\t\t\t\t\tthis.storedMessage = '';\n\t\t\t\t}\n\t\t\t\tif (this.storedFile)\n\t\t\t\t{\n\t\t\t\t\tthis.onTextareaFileSelected();\n\t\t\t\t\tthis.storedFile = '';\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (this.widgetData.showForm == FormType.none)\n\t\t\t{\n\t\t\t\tthis.$root.$emit('onMessengerTextareaFocus');\n\t\t\t}\n\t\t},\n\t\tdisagreeConsentWidow()\n\t\t{\n\t\t\tthis.$store.commit(WidgetStore.widgetData, {showForm : FormType.none});\n\t\t\tthis.$store.commit(WidgetStore.widgetData, {showConsent : false});\n\n\t\t\tthis.$root.$bitrixController.sendConsentDecision(false);\n\n\t\t\tif (this.storedMessage)\n\t\t\t{\n\t\t\t\tthis.$root.$emit('onMessengerTextareaInsertText', {\n\t\t\t\t\ttext: this.storedMessage,\n\t\t\t\t\tfocus: this.widgetData.deviceType != DeviceType.mobile\n\t\t\t\t});\n\t\t\t\tthis.storedMessage = '';\n\t\t\t}\n\t\t\tif (this.storedFile)\n\t\t\t{\n\t\t\t\tthis.storedFile = '';\n\t\t\t}\n\n\t\t\tif (this.widgetData.deviceType != DeviceType.mobile)\n\t\t\t{\n\t\t\t\tthis.$root.$emit('onMessengerTextareaFocus');\n\t\t\t}\n\t\t},\n\t\tlogEvent(name, ...params)\n\t\t{\n\t\t\tBX.Messenger.Logger.info(name, ...params);\n\t\t},\n\t\tonCreated()\n\t\t{\n\t\t\tif(BX.Messenger.Utils.device.isMobile())\n\t\t\t{\n\t\t\t\tlet viewPortMetaSiteNode = Array.from(\n\t\t\t\t\tdocument.head.getElementsByTagName('meta')\n\t\t\t\t).filter(element => element.name == 'viewport')[0];\n\n\t\t\t\tif (viewPortMetaSiteNode)\n\t\t\t\t{\n\t\t\t\t\tthis.viewPortMetaSiteNode = viewPortMetaSiteNode;\n\t\t\t\t\tdocument.head.removeChild(this.viewPortMetaSiteNode);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tlet contentWidth = document.body.offsetWidth;\n\t\t\t\t\tif (contentWidth < window.innerWidth)\n\t\t\t\t\t{\n\t\t\t\t\t\tcontentWidth = window.innerWidth;\n\t\t\t\t\t}\n\t\t\t\t\tif (contentWidth < 1024)\n\t\t\t\t\t{\n\t\t\t\t\t\tcontentWidth = 1024;\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.viewPortMetaSiteNode = document.createElement('meta');\n\t\t\t\t\tthis.viewPortMetaSiteNode.setAttribute('name', 'viewport');\n\t\t\t\t\tthis.viewPortMetaSiteNode.setAttribute('content', `width=${contentWidth}, initial-scale=1.0, user-scalable=1`);\n\t\t\t\t}\n\n\t\t\t\tif (!this.viewPortMetaWidgetNode)\n\t\t\t\t{\n\t\t\t\t\tthis.viewPortMetaWidgetNode = document.createElement('meta');\n\t\t\t\t\tthis.viewPortMetaWidgetNode.setAttribute('name', 'viewport');\n\t\t\t\t\tthis.viewPortMetaWidgetNode.setAttribute('content', 'width=device-width, initial-scale=1.0, user-scalable=0');\n\t\t\t\t\tdocument.head.appendChild(this.viewPortMetaWidgetNode);\n\t\t\t\t}\n\n\t\t\t\tdocument.body.classList.add('bx-livechat-mobile-state');\n\n\t\t\t\tif (BX.Messenger.Utils.browser.isSafariBased())\n\t\t\t\t{\n\t\t\t\t\tdocument.body.classList.add('bx-livechat-mobile-safari-based');\n\t\t\t\t}\n\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tthis.$store.commit(WidgetStore.widgetData, {showed: true});\n\t\t\t\t}, 50);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.$store.commit(WidgetStore.widgetData, {showed: true});\n\t\t\t}\n\n\t\t\tthis.textareaHeight = this.$store.state.widget.widgetData.textareaHeight || this.textareaHeight;\n\n\t\t\tthis.$store.commit(MessengerFileStore.initCollection, {chatId: this.$root.$bitrixController.getChatId()});\n\t\t\tthis.$store.commit(MessengerMessageStore.initCollection, {chatId: this.$root.$bitrixController.getChatId()});\n\t\t\tthis.$store.commit(MessengerDialogStore.initCollection, {dialogId: this.$root.$bitrixController.getDialogId(), fields: {\n\t\t\t\tentityType: 'LIVECHAT',\n\t\t\t\ttype: 'livechat'\n\t\t\t}});\n\t\t},\n\t\tonBeforeClose()\n\t\t{\n\t\t\tif(BX.Messenger.Utils.device.isMobile())\n\t\t\t{\n\t\t\t\tdocument.body.classList.remove('bx-livechat-mobile-state');\n\n\t\t\t\tif (BX.Messenger.Utils.browser.isSafariBased())\n\t\t\t\t{\n\t\t\t\t\tdocument.body.classList.remove('bx-livechat-mobile-safari-based');\n\t\t\t\t}\n\n\t\t\t\tif (this.viewPortMetaWidgetNode)\n\t\t\t\t{\n\t\t\t\t\tdocument.head.removeChild(this.viewPortMetaWidgetNode);\n\t\t\t\t\tthis.viewPortMetaWidgetNode = null;\n\t\t\t\t}\n\n\t\t\t\tif (this.viewPortMetaSiteNode)\n\t\t\t\t{\n\t\t\t\t\tdocument.head.appendChild(this.viewPortMetaSiteNode);\n\t\t\t\t\tthis.viewPortMetaSiteNode = null;\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tonAfterClose()\n\t\t{\n\t\t\tthis.$root.$bitrixController.close();\n\t\t},\n\t\tonRequestShowForm(event)\n\t\t{\n\t\t\tclearTimeout(this.showFormTimeout);\n\t\t\tif (event.type == FormType.welcome)\n\t\t\t{\n\t\t\t\tif (event.delayed)\n\t\t\t\t{\n\t\t\t\t\tthis.showFormTimeout = setTimeout(() => {\n\t\t\t\t\t\tthis.showWelcomeForm();\n\t\t\t\t\t}, 5000);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.showWelcomeForm();\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (event.type == FormType.offline)\n\t\t\t{\n\t\t\t\tif (event.delayed)\n\t\t\t\t{\n\t\t\t\t\tthis.showFormTimeout = setTimeout(() => {\n\t\t\t\t\t\tthis.showOfflineForm();\n\t\t\t\t\t}, 3000);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.showOfflineForm();\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (event.type == FormType.like)\n\t\t\t{\n\t\t\t\tif (event.delayed)\n\t\t\t\t{\n\t\t\t\t\tthis.showFormTimeout = setTimeout(() => {\n\t\t\t\t\t\tthis.showLikeForm();\n\t\t\t\t\t}, 5000);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.showLikeForm();\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tonDialogRequestHistory(event)\n\t\t{\n\t\t\tthis.$root.$bitrixController.getDialogHistory(event.lastId);\n\t\t},\n\t\tonDialogRequestUnread(event)\n\t\t{\n\t\t\tthis.$root.$bitrixController.getDialogUnread(event.lastId);\n\t\t},\n\t\tonDialogMessageClickByUserName(event)\n\t\t{\n\t\t\t// TODO name push to auto-replace mention holder - User Name -> [USER=274]User Name[/USER]\n\t\t\tthis.$root.$emit('onMessengerTextareaInsertText', {text: event.user.name+' '});\n\t\t},\n\t\tonDialogMessageClickByCommand(event)\n\t\t{\n\t\t\tif (event.type === 'put')\n\t\t\t{\n\t\t\t\tthis.$root.$emit('onMessengerTextareaInsertText', {text: event.value+' '});\n\t\t\t}\n\t\t\telse if (event.type === 'send')\n\t\t\t{\n\t\t\t\tthis.$root.$bitrixController.addMessage(event.value);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tBX.Messenger.Logger.warn('Unprocessed command', event);\n\t\t\t}\n\t\t},\n\t\tonDialogMessageMenuClick(event)\n\t\t{\n\t\t\tBX.Messenger.Logger.warn('Message menu:', event);\n\t\t},\n\t\tonDialogMessageRetryClick(event)\n\t\t{\n\t\t\tBX.Messenger.Logger.warn('Message retry:', event);\n\t\t\tthis.$root.$bitrixController.retrySendMessage(event.message);\n\t\t},\n\t\tonDialogReadMessage(event)\n\t\t{\n\t\t\tthis.$root.$bitrixController.readMessage(event.id);\n\t\t},\n\t\tonDialogClick(event)\n\t\t{\n\t\t\tthis.$store.commit(WidgetStore.widgetData, {showForm: FormType.none});\n\t\t},\n\t\tonTextareaSend(event)\n\t\t{\n\t\t\tevent.focus = event.focus !== false;\n\n\t\t\tif (this.widgetData.showForm == FormType.smile)\n\t\t\t{\n\t\t\t\tthis.$store.commit(WidgetStore.widgetData, {showForm: FormType.none});\n\t\t\t}\n\n\t\t\tif (!this.dialogData.userConsent && this.widgetData.consentUrl)\n\t\t\t{\n\t\t\t\tif (event.text)\n\t\t\t\t{\n\t\t\t\t\tthis.storedMessage = event.text;\n\t\t\t\t}\n\t\t\t\tthis.showConsentWidow();\n\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tevent.text = event.text? event.text: this.storedMessage;\n\t\t\tif (!event.text)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tthis.hideForm();\n\t\t\tthis.$root.$bitrixController.addMessage(event.text);\n\n\t\t\tif (event.focus)\n\t\t\t{\n\t\t\t\tthis.$root.$emit('onMessengerTextareaFocus');\n\t\t\t}\n\n\t\t\treturn true;\n\t\t},\n\t\tonTextareaWrites(event)\n\t\t{\n\t\t\tthis.$root.$bitrixController.writesMessage();\n\t\t},\n\t\tonTextareaFocus(event)\n\t\t{\n\t\t\tif (\n\t\t\t\tthis.widgetData.copyright &&\n\t\t\t\tthis.widgetData.deviceType == DeviceType.mobile\n\t\t\t)\n\t\t\t{\n\t\t\t\tthis.widgetData.copyright = false;\n\t\t\t}\n\t\t\tif (BX.Messenger.Utils.device.isMobile())\n\t\t\t{\n\t\t\t\tclearTimeout(this.onTextareaFocusScrollTimeout);\n\t\t\t\tthis.onTextareaFocusScrollTimeout = setTimeout(() => {\n\t\t\t\t\tdocument.addEventListener('scroll', this.onWindowScroll);\n\t\t\t\t}, 1000);\n\t\t\t}\n\t\t\tthis.textareaFocused = true;\n\t\t},\n\t\tonTextareaBlur(event)\n\t\t{\n\t\t\tif (!this.widgetData.copyright && this.widgetData.copyright !== this.$root.$bitrixController.copyright)\n\t\t\t{\n\t\t\t\tthis.widgetData.copyright = this.$root.$bitrixController.copyright;\n\t\t\t\tthis.$nextTick(() => {\n\t\t\t\t\tthis.$root.$emit('onMessengerDialogScrollToBottom', {force: true});\n\t\t\t\t});\n\t\t\t}\n\t\t\tif (BX.Messenger.Utils.device.isMobile())\n\t\t\t{\n\t\t\t\tclearTimeout(this.onTextareaFocusScrollTimeout);\n\t\t\t\tdocument.removeEventListener('scroll', this.onWindowScroll);\n\t\t\t}\n\n\t\t\tthis.textareaFocused = false;\n\t\t},\n\t\tonTextareaStartDrag(event)\n\t\t{\n\t\t\tif (this.textareaDrag)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tBX.Messenger.Logger.log('Livechat: textarea drag started');\n\n\t\t\tthis.textareaDrag = true;\n\n\t\t\tevent = event.changedTouches ? event.changedTouches[0] : event;\n\n\t\t\tthis.textareaDragCursorStartPoint = event.clientY;\n\t\t\tthis.textareaDragHeightStartPoint = this.textareaHeight;\n\n\t\t\tthis.onTextareaDragEventAdd();\n\n\t\t\tthis.$root.$emit('onMessengerTextareaBlur', true);\n\t\t},\n\t\tonTextareaContinueDrag(event)\n\t\t{\n\t\t\tif (!this.textareaDrag)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tevent = event.changedTouches ? event.changedTouches[0] : event;\n\n\t\t\tthis.textareaDragCursorControlPoint = event.clientY;\n\n\t\t\tlet textareaHeight = Math.max(\n\t\t\t\tMath.min(this.textareaDragHeightStartPoint + this.textareaDragCursorStartPoint - this.textareaDragCursorControlPoint, this.textareaMaximumHeight)\n\t\t\t, this.textareaMinimumHeight);\n\n\t\t\tBX.Messenger.Logger.log('Livechat: textarea drag', 'new: '+textareaHeight, 'curr: '+this.textareaHeight);\n\n\t\t\tif (this.textareaHeight != textareaHeight)\n\t\t\t{\n\t\t\t\tthis.textareaHeight = textareaHeight;\n\t\t\t}\n\t\t},\n\t\tonTextareaStopDrag()\n\t\t{\n\t\t\tif (!this.textareaDrag)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tBX.Messenger.Logger.log('Livechat: textarea drag ended');\n\n\t\t\tthis.textareaDrag = false;\n\n\t\t\tthis.onTextareaDragEventRemove();\n\n\t\t\tthis.$store.commit(WidgetStore.widgetData, {textareaHeight: this.textareaHeight});\n\t\t\tthis.$root.$emit('onMessengerDialogScrollToBottom', {force: true});\n\t\t},\n\t\tonTextareaDragEventAdd()\n\t\t{\n\t\t\tdocument.addEventListener('mousemove', this.onTextareaContinueDrag);\n\t\t\tdocument.addEventListener('touchmove', this.onTextareaContinueDrag);\n\t\t\tdocument.addEventListener('touchend', this.onTextareaStopDrag);\n\t\t\tdocument.addEventListener('mouseup', this.onTextareaStopDrag);\n\t\t\tdocument.addEventListener('mouseleave', this.onTextareaStopDrag);\n\t\t},\n\t\tonTextareaDragEventRemove()\n\t\t{\n\t\t\tdocument.removeEventListener('mousemove', this.onTextareaContinueDrag);\n\t\t\tdocument.removeEventListener('touchmove', this.onTextareaContinueDrag);\n\t\t\tdocument.removeEventListener('touchend', this.onTextareaStopDrag);\n\t\t\tdocument.removeEventListener('mouseup', this.onTextareaStopDrag);\n\t\t\tdocument.removeEventListener('mouseleave', this.onTextareaStopDrag);\n\t\t},\n\t\tonTextareaFileSelected(event)\n\t\t{\n\t\t\tlet fileInput = event && event.fileInput? event.fileInput: this.storedFile;\n\t\t\tif (!fileInput)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (fileInput.files[0].size > this.widgetData.disk.maxFileSize)\n\t\t\t{\n\t\t\t\t// TODO change alert to correct overlay window\n\t\t\t\talert(this.localize.BX_LIVECHAT_FILE_SIZE_EXCEEDED.replace('#LIMIT#', Math.round(this.widgetData.disk.maxFileSize/1024/1024)));\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (!this.dialogData.userConsent && this.widgetData.consentUrl)\n\t\t\t{\n\t\t\t\tthis.storedFile = event.fileInput;\n\t\t\t\tthis.showConsentWidow();\n\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tthis.$root.$bitrixController.addFile(fileInput);\n\t\t},\n\t\tonTextareaAppButtonClick(event)\n\t\t{\n\t\t\tif (event.appId == FormType.smile)\n\t\t\t{\n\t\t\t\tif (this.widgetData.showForm == FormType.smile)\n\t\t\t\t{\n\t\t\t\t\tthis.$store.commit(WidgetStore.widgetData, {showForm: FormType.none});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.$store.commit(WidgetStore.widgetData, {showForm: FormType.smile});\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.$root.$emit('onMessengerTextareaFocus');\n\t\t\t}\n\t\t},\n\t\tonPullRequestConfig(event)\n\t\t{\n\t\t\tthis.$root.$bitrixController.recoverPullConnection();\n\t\t},\n\t\tonSmilesSelectSmile(event)\n\t\t{\n\t\t\tthis.$root.$emit('onMessengerTextareaInsertText', {text: event.text});\n\t\t},\n\t\tonSmilesSelectSet()\n\t\t{\n\t\t\tthis.$root.$emit('onMessengerTextareaFocus');\n\t\t},\n\t\tonWindowKeyDown(event)\n\t\t{\n\t\t\tif (event.keyCode == 27)\n\t\t\t{\n\t\t\t\tif (this.widgetData.showForm != FormType.none)\n\t\t\t\t{\n\t\t\t\t\tthis.$store.commit(WidgetStore.widgetData, {showForm: FormType.none});\n\t\t\t\t}\n\t\t\t\telse if (this.widgetData.showConsent)\n\t\t\t\t{\n\t\t\t\t\tthis.disagreeConsentWidow();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.close();\n\t\t\t\t}\n\n\t\t\t\tevent.preventDefault();\n\t\t\t\tevent.stopPropagation();\n\n\t\t\t\tthis.$root.$emit('onMessengerTextareaFocus');\n\t\t\t}\n\t\t},\n\t\tonWindowScroll(event)\n\t\t{\n\t\t\tclearTimeout(this.onWindowScrollTimeout);\n\t\t\tthis.onWindowScrollTimeout = setTimeout(() => {\n\t\t\t\tthis.$root.$emit('onMessengerTextareaBlur', true);\n\t\t\t}, 50);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<transition enter-active-class=\"bx-livechat-show\" leave-active-class=\"bx-livechat-close\" @after-leave=\"onAfterClose\">\n\t\t\t<div :class=\"widgetClassName\" v-if=\"widgetData.showed\">\n\t\t\t\t<div class=\"bx-livechat-box\">\n\t\t\t\t\t<bx-livechat-head :isWidgetDisabled=\"widgetMobileDisabled\" @like=\"showLikeForm\" @history=\"showHistoryForm\" @close=\"close\"/>\n\t\t\t\t\t<template v-if=\"widgetMobileDisabled\">\n\t\t\t\t\t\t<bx-livechat-body-orientation-disabled/>\n\t\t\t\t\t</template>\n\t\t\t\t\t<template v-else-if=\"widgetData.error.active\">\n\t\t\t\t\t\t<bx-livechat-body-error/>\n\t\t\t\t\t</template>\n\t\t\t\t\t<template v-else-if=\"!widgetData.configId\">\n\t\t\t\t\t\t<div class=\"bx-livechat-body\" key=\"loading-body\">\n\t\t\t\t\t\t\t<bx-livechat-body-loading/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</template>\t\t\t\n\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t<template v-if=\"!widgetData.dialogStart\">\n\t\t\t\t\t\t\t<div class=\"bx-livechat-body\" key=\"welcome-body\">\n\t\t\t\t\t\t\t\t<bx-livechat-body-operators/>\n\t\t\t\t\t\t\t\t<keep-alive include=\"bx-livechat-smiles\">\n\t\t\t\t\t\t\t\t\t<template v-if=\"widgetData.showForm == FormType.smile\">\n\t\t\t\t\t\t\t\t\t\t<bx-livechat-smiles @selectSmile=\"onSmilesSelectSmile\" @selectSet=\"onSmilesSelectSet\"/>\t\n\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t</keep-alive>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t\t<template v-else-if=\"widgetData.dialogStart\">\n\t\t\t\t\t\t\t<bx-pull-status :canReconnect=\"true\" @reconnect=\"onPullRequestConfig\"/>\n\t\t\t\t\t\t\t<div :class=\"['bx-livechat-body', {'bx-livechat-body-with-message': showMessageDialog}]\" key=\"with-message\">\n\t\t\t\t\t\t\t\t<transition name=\"bx-livechat-animation-upload-file\">\n\t\t\t\t\t\t\t\t\t<template v-if=\"widgetData.uploadFile\">\n\t\t\t\t\t\t\t\t\t\t<div class=\"bx-livechat-file-upload\">\t\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"bx-livechat-file-upload-sending\"></div>\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"bx-livechat-file-upload-text\">{{localize.BX_LIVECHAT_FILE_UPLOAD}}</div>\n\t\t\t\t\t\t\t\t\t\t</div>\t\n\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t</transition>\t\n\t\t\t\t\t\t\t\t<template v-if=\"showMessageDialog\">\n\t\t\t\t\t\t\t\t\t<div class=\"bx-livechat-dialog\">\n\t\t\t\t\t\t\t\t\t\t<bx-messenger-dialog\n\t\t\t\t\t\t\t\t\t\t\t:userId=\"userData.id\" \n\t\t\t\t\t\t\t\t\t\t\t:dialogId=\"dialogData.dialogId\"\n\t\t\t\t\t\t\t\t\t\t\t:chatId=\"dialogData.chatId\"\n\t\t\t\t\t\t\t\t\t\t\t:messageLimit=\"dialogData.messageLimit\"\n\t\t\t\t\t\t\t\t\t\t\t:enableEmotions=\"false\"\n\t\t\t\t\t\t\t\t\t\t\t:enableDateActions=\"false\"\n\t\t\t\t\t\t\t\t\t\t\t:enableCreateContent=\"false\"\n\t\t\t\t\t\t\t\t\t\t\t:showMessageAvatar=\"false\"\n\t\t\t\t\t\t\t\t\t\t\t:showMessageMenu=\"false\"\n\t\t\t\t\t\t\t\t\t\t\tlistenEventScrollToBottom=\"onMessengerDialogScrollToBottom\"\n\t\t\t\t\t\t\t\t\t\t\tlistenEventRequestHistory=\"onDialogRequestHistoryResult\"\n\t\t\t\t\t\t\t\t\t\t\tlistenEventRequestUnread=\"onDialogRequestUnreadResult\"\n\t\t\t\t\t\t\t\t\t\t\t@readMessage=\"onDialogReadMessage\"\n\t\t\t\t\t\t\t\t\t\t\t@requestHistory=\"onDialogRequestHistory\"\n\t\t\t\t\t\t\t\t\t\t\t@requestUnread=\"onDialogRequestUnread\"\n\t\t\t\t\t\t\t\t\t\t\t@clickByCommand=\"onDialogMessageClickByCommand\"\n\t\t\t\t\t\t\t\t\t\t\t@clickByUserName=\"onDialogMessageClickByUserName\"\n\t\t\t\t\t\t\t\t\t\t\t@clickByMessageMenu=\"onDialogMessageMenuClick\"\n\t\t\t\t\t\t\t\t\t\t\t@clickByMessageRetry=\"onDialogMessageRetryClick\"\n\t\t\t\t\t\t\t\t\t\t\t@click=\"onDialogClick\"\n\t\t\t\t\t\t\t\t\t\t />\n\t\t\t\t\t\t\t\t\t</div>\t \n\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t\t\t\t<bx-livechat-body-loading/>\n\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t<keep-alive include=\"bx-livechat-smiles\">\n\t\t\t\t\t\t\t\t\t<template v-if=\"widgetData.showForm == FormType.like && widgetData.vote.enable\">\n\t\t\t\t\t\t\t\t\t\t<bx-livechat-form-vote/>\n\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t\t<template v-else-if=\"widgetData.showForm == FormType.welcome\">\n\t\t\t\t\t\t\t\t\t\t<bx-livechat-form-welcome/>\t\n\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t\t<template v-else-if=\"widgetData.showForm == FormType.offline\">\n\t\t\t\t\t\t\t\t\t\t<bx-livechat-form-offline/>\t\n\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t\t<template v-else-if=\"widgetData.showForm == FormType.history\">\n\t\t\t\t\t\t\t\t\t\t<bx-livechat-form-history/>\t\n\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t\t<template v-else-if=\"widgetData.showForm == FormType.smile\">\n\t\t\t\t\t\t\t\t\t\t<bx-livechat-smiles @selectSmile=\"onSmilesSelectSmile\" @selectSet=\"onSmilesSelectSet\"/>\t\n\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t</keep-alive>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</template>\t\n\t\t\t\t\t\t<div class=\"bx-livechat-textarea\" :style=\"textareaHeightStyle\" ref=\"textarea\">\n\t\t\t\t\t\t\t<div class=\"bx-livechat-textarea-resize-handle\" @mousedown=\"onTextareaStartDrag\" @touchstart=\"onTextareaStartDrag\"></div>\n\t\t\t\t\t\t\t<bx-messenger-textarea\n\t\t\t\t\t\t\t\t:siteId=\"widgetData.siteId\"\n\t\t\t\t\t\t\t\t:userId=\"userData.id\"\n\t\t\t\t\t\t\t\t:dialogId=\"dialogData.dialogId\"\n\t\t\t\t\t\t\t\t:writesEventLetter=\"3\"\n\t\t\t\t\t\t\t\t:enableEdit=\"true\"\n\t\t\t\t\t\t\t\t:enableCommand=\"false\"\n\t\t\t\t\t\t\t\t:enableMention=\"false\"\n\t\t\t\t\t\t\t\t:enableFile=\"widgetData.disk.enabled\"\n\t\t\t\t\t\t\t\t:autoFocus=\"widgetData.deviceType !== DeviceType.mobile\"\n\t\t\t\t\t\t\t\t:isMobile=\"widgetData.deviceType === DeviceType.mobile\"\n\t\t\t\t\t\t\t\t:styles=\"{button: {backgroundColor: widgetData.styles.backgroundColor, iconColor: widgetData.styles.iconColor}}\"\n\t\t\t\t\t\t\t\tlistenEventInsertText=\"onMessengerTextareaInsertText\"\n\t\t\t\t\t\t\t\tlistenEventFocus=\"onMessengerTextareaFocus\"\n\t\t\t\t\t\t\t\tlistenEventBlur=\"onMessengerTextareaBlur\"\n\t\t\t\t\t\t\t\t@writes=\"onTextareaWrites\" \n\t\t\t\t\t\t\t\t@send=\"onTextareaSend\" \n\t\t\t\t\t\t\t\t@focus=\"onTextareaFocus\" \n\t\t\t\t\t\t\t\t@blur=\"onTextareaBlur\" \n\t\t\t\t\t\t\t\t@edit=\"logEvent('edit message', $event)\"\n\t\t\t\t\t\t\t\t@fileSelected=\"onTextareaFileSelected\"\n\t\t\t\t\t\t\t\t@appButtonClick=\"onTextareaAppButtonClick\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<bx-livechat-form-consent @agree=\"agreeConsentWidow\" @disagree=\"disagreeConsentWidow\"/>\n\t\t\t\t\t\t<template v-if=\"widgetData.copyright\">\n\t\t\t\t\t\t\t<bx-livechat-footer/>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</template>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</transition>\n\t`\n});\n/* endregion 06-01. bx-livechat component */\n\n/* region 06-02. bx-livechat-head component */\nBX.Vue.component('bx-livechat-head',\n{\n\t/**\n\t * @emits 'close'\n\t * @emits 'like'\n\t * @emits 'history'\n\t */\n\tprops:\n\t{\n\t\tisWidgetDisabled: { default: false },\n\t},\n\tmethods:\n\t{\n\t\tclose(event)\n\t\t{\n\t\t\tthis.$emit('close');\n\t\t},\n\t\tlike(event)\n\t\t{\n\t\t\tthis.$emit('like');\n\t\t},\n\t\thistory(event)\n\t\t{\n\t\t\tthis.$emit('history');\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tVoteType: () => VoteType,\n\n\t\tcustomBackgroundStyle(state)\n\t\t{\n\t\t\treturn state.widgetData.styles.backgroundColor? 'background-color: '+state.widgetData.styles.backgroundColor+'!important;': '';\n\t\t},\n\t\tcustomBackgroundOnlineStyle(state)\n\t\t{\n\t\t\treturn state.widgetData.styles.backgroundColor? 'border-color: '+state.widgetData.styles.backgroundColor+'!important;': '';\n\t\t},\n\t\tshowName()\n\t\t{\n\t\t\treturn this.dialogData.operator.firstName || this.dialogData.operator.lastName;\n\t\t},\n\t\tlocalize()\n\t\t{\n\t\t\treturn BX.Vue.getFilteredPhrases('BX_LIVECHAT_', this.$root.$bitrixMessages);\n\t\t},\n\t\t...BX.Vuex.mapState({\n\t\t\twidgetData: state => state.widget.widgetData,\n\t\t\tdialogData: state => state.widget.dialogData\n\t\t})\n\t},\n\twatch:\n\t{\n\t\tshowName(value)\n\t\t{\n\t\t\tif (value)\n\t\t\t{\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tthis.$root.$emit('onMessengerDialogScrollToBottom');\n\t\t\t\t}, 300);\n\t\t\t}\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-livechat-head-wrap\">\n\t\t\t<template v-if=\"isWidgetDisabled\">\n\t\t\t\t<div class=\"bx-livechat-head\" :style=\"customBackgroundStyle\">\n\t\t\t\t\t<div class=\"bx-livechat-title\">{{widgetData.configName || localize.BX_LIVECHAT_TITLE}}</div>\n\t\t\t\t\t<div class=\"bx-livechat-control-box\">\n\t\t\t\t\t\t<button v-if=\"!widgetData.pageMode\" class=\"bx-livechat-control-btn bx-livechat-control-btn-close\" :title=\"localize.BX_LIVECHAT_CLOSE_BUTTON\" @click=\"close\"></button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\t\n\t\t\t</template>\n\t\t\t<template v-else-if=\"widgetData.error.active\">\n\t\t\t\t<div class=\"bx-livechat-head\" :style=\"customBackgroundStyle\">\n\t\t\t\t\t<div class=\"bx-livechat-title\">{{widgetData.configName || localize.BX_LIVECHAT_TITLE}}</div>\n\t\t\t\t\t<div class=\"bx-livechat-control-box\">\n\t\t\t\t\t\t<button v-if=\"!widgetData.pageMode\" class=\"bx-livechat-control-btn bx-livechat-control-btn-close\" :title=\"localize.BX_LIVECHAT_CLOSE_BUTTON\" @click=\"close\"></button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t\t<template v-else-if=\"!widgetData.configId\">\n\t\t\t\t<div class=\"bx-livechat-head\" :style=\"customBackgroundStyle\">\n\t\t\t\t\t<div class=\"bx-livechat-title\">{{widgetData.configName || localize.BX_LIVECHAT_TITLE}}</div>\n\t\t\t\t\t<div class=\"bx-livechat-control-box\">\n\t\t\t\t\t\t<button v-if=\"!widgetData.pageMode\" class=\"bx-livechat-control-btn bx-livechat-control-btn-close\" :title=\"localize.BX_LIVECHAT_CLOSE_BUTTON\" @click=\"close\"></button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</template>\t\t\t\n\t\t\t<template v-else>\n\t\t\t\t<div class=\"bx-livechat-head\" :style=\"customBackgroundStyle\">\n\t\t\t\t\t<template v-if=\"!showName\">\n\t\t\t\t\t\t<div class=\"bx-livechat-title\">{{widgetData.configName || localize.BX_LIVECHAT_TITLE}}</div>\n\t\t\t\t\t</template>\n\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t<div class=\"bx-livechat-user bx-livechat-status-online\">\n\t\t\t\t\t\t\t<template v-if=\"dialogData.operator.avatar\">\n\t\t\t\t\t\t\t\t<div class=\"bx-livechat-user-icon\" :style=\"'background-image: url('+encodeURI(dialogData.operator.avatar)+')'\">\n\t\t\t\t\t\t\t\t\t<div v-if=\"dialogData.operator.online\" class=\"bx-livechat-user-status\" :style=\"customBackgroundOnlineStyle\"></div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t\t\t<div class=\"bx-livechat-user-icon\">\n\t\t\t\t\t\t\t\t\t<div v-if=\"dialogData.operator.online\" class=\"bx-livechat-user-status\" :style=\"customBackgroundOnlineStyle\"></div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"bx-livechat-user-info\">\n\t\t\t\t\t\t\t<div class=\"bx-livechat-user-name\">{{dialogData.operator.firstName? dialogData.operator.firstName: dialogData.operator.name}}</div>\n\t\t\t\t\t\t\t<div class=\"bx-livechat-user-position\">{{dialogData.operator.workPosition? dialogData.operator.workPosition: localize.BX_LIVECHAT_USER}}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</template>\n\t\t\t\t\t<div class=\"bx-livechat-control-box\">\n\t\t\t\t\t\t<span class=\"bx-livechat-control-box-active\" v-if=\"widgetData.dialogStart && dialogData.sessionId\">\n\t\t\t\t\t\t\t<button v-if=\"widgetData.vote.enable && (!dialogData.sessionClose || dialogData.sessionClose && dialogData.userVote == VoteType.none)\" :class=\"'bx-livechat-control-btn bx-livechat-control-btn-like bx-livechat-dialog-vote-'+(dialogData.userVote)\" :title=\"localize.BX_LIVECHAT_VOTE_BUTTON\" @click=\"like\"></button>\n\t\t\t\t\t\t\t<button v-if=\"widgetData.vote.enable && dialogData.sessionClose && dialogData.userVote != VoteType.none\" :class=\"'bx-livechat-control-btn bx-livechat-control-btn-disabled bx-livechat-control-btn-like bx-livechat-dialog-vote-'+(dialogData.userVote)\"></button>\n\t\t\t\t\t\t\t<button class=\"bx-livechat-control-btn bx-livechat-control-btn-mail\" :title=\"localize.BX_LIVECHAT_MAIL_BUTTON_NEW\" @click=\"history\"></button>\n\t\t\t\t\t\t</span>\t\n\t\t\t\t\t\t<button v-if=\"!widgetData.pageMode\" class=\"bx-livechat-control-btn bx-livechat-control-btn-close\" :title=\"localize.BX_LIVECHAT_CLOSE_BUTTON\" @click=\"close\"></button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t</div>\n\t`\n});\n/* endregion 06-02. bx-livechat-head component */\n\n/* region 06-03. bx-livechat-body-orientation-disabled component */\nBX.Vue.component('bx-livechat-body-orientation-disabled',\n{\n\tcomputed:\n\t{\n\t\tlocalize()\n\t\t{\n\t\t\treturn  Object.freeze({\n\t\t\t\tBX_LIVECHAT_MOBILE_ROTATE: this.$root.$bitrixMessages.BX_LIVECHAT_MOBILE_ROTATE\n\t\t\t});\n\t\t}\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-livechat-body\" key=\"orientation-head\">\n\t\t\t<div class=\"bx-livechat-mobile-orientation-box\">\n\t\t\t\t<div class=\"bx-livechat-mobile-orientation-icon\"></div>\n\t\t\t\t<div class=\"bx-livechat-mobile-orientation-text\">{{localize.BX_LIVECHAT_MOBILE_ROTATE}}</div>\n\t\t\t</div>\n\t\t</div>\n\t`\n});\n/* endregion 06-03. bx-livechat-body-orientation-disabled component */\n\n/* region 06-04. bx-livechat-body-loading component */\nBX.Vue.component('bx-livechat-body-loading',\n{\n\tcomputed:\n\t{\n\t\tlocalize()\n\t\t{\n\t\t\treturn  Object.freeze({\n\t\t\t\tBX_LIVECHAT_LOADING: this.$root.$bitrixMessages.BX_LIVECHAT_LOADING\n\t\t\t});\n\t\t}\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-livechat-loading-window\">\n\t\t\t<svg class=\"bx-livechat-loading-circular\" viewBox=\"25 25 50 50\">\n\t\t\t\t<circle class=\"bx-livechat-loading-path\" cx=\"50\" cy=\"50\" r=\"20\" fill=\"none\" stroke-miterlimit=\"10\"/>\n\t\t\t\t<circle class=\"bx-livechat-loading-inner-path\" cx=\"50\" cy=\"50\" r=\"20\" fill=\"none\" stroke-miterlimit=\"10\"/>\n\t\t\t</svg>\n\t\t\t<h3 class=\"bx-livechat-help-title bx-livechat-help-title-md bx-livechat-loading-msg\">{{localize.BX_LIVECHAT_LOADING}}</h3>\n\t\t</div>\n\t`\n});\n/* endregion 06-04. bx-livechat-body-loading component */\n\n/* region 06-05. bx-livechat-body-operators component */\nBX.Vue.component('bx-livechat-body-operators',\n{\n\tcomputed:\n\t{\n\t\tlocalize()\n\t\t{\n\t\t\treturn BX.Vue.getFilteredPhrases('BX_LIVECHAT_', this.$root.$bitrixMessages);\n\t\t},\n\t\t...BX.Vuex.mapState({\n\t\t\twidgetData: state => state.widget.widgetData\n\t\t})\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-livechat-help-container\">\n\t\t\t<transition name=\"bx-livechat-animation-fade\">\n\t\t\t\t<h2 v-if=\"widgetData.online\" key=\"online\" class=\"bx-livechat-help-title bx-livechat-help-title-lg\">{{localize.BX_LIVECHAT_ONLINE_LINE_1}}<div class=\"bx-livechat-help-subtitle\">{{localize.BX_LIVECHAT_ONLINE_LINE_2}}</div></h2>\n\t\t\t\t<h2 v-else key=\"offline\" class=\"bx-livechat-help-title bx-livechat-help-title-sm\">{{localize.BX_LIVECHAT_OFFLINE}}</h2>\n\t\t\t</transition>\t\n\t\t\t<div class=\"bx-livechat-help-user\">\n\t\t\t\t<template v-for=\"operator in widgetData.operators\">\n\t\t\t\t\t<div class=\"bx-livechat-user\" :key=\"operator.id\">\n\t\t\t\t\t\t<template v-if=\"operator.avatar\">\n\t\t\t\t\t\t\t<div class=\"bx-livechat-user-icon\" :style=\"'background-image: url('+encodeURI(operator.avatar)+')'\"></div>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t\t<div class=\"bx-livechat-user-icon\"></div>\n\t\t\t\t\t\t</template>\t\n\t\t\t\t\t\t<div class=\"bx-livechat-user-info\">\n\t\t\t\t\t\t\t<div class=\"bx-livechat-user-name\">{{operator.firstName? operator.firstName: operator.name}}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</template>\t\n\t\t\t</div>\n\t\t</div>\n\t`\n});\n/* endregion 06-05. bx-livechat-body-operators component */\n\n/* region 06-06. bx-livechat-body-error component */\nBX.Vue.component('bx-livechat-body-error',\n{\n\tcomputed:\n\t{\n\t\tlocalize()\n\t\t{\n\t\t\treturn  Object.freeze({\n\t\t\t\tBX_LIVECHAT_ERROR_TITLE: this.$root.$bitrixMessages.BX_LIVECHAT_ERROR_TITLE,\n\t\t\t\tBX_LIVECHAT_ERROR_DESC: this.$root.$bitrixMessages.BX_LIVECHAT_ERROR_DESC\n\t\t\t});\n\t\t},\n\t\t...BX.Vuex.mapState({\n\t\t\twidgetData: state => state.widget.widgetData\n\t\t}),\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-livechat-body\" key=\"error-body\">\n\t\t\t<div class=\"bx-livechat-warning-window\">\n\t\t\t\t<div class=\"bx-livechat-warning-icon\"></div>\n\t\t\t\t<template v-if=\"widgetData.error.description\"> \n\t\t\t\t\t<div class=\"bx-livechat-help-title bx-livechat-help-title-sm bx-livechat-warning-msg\" v-html=\"widgetData.error.description\"></div>\n\t\t\t\t</template> \n\t\t\t\t<template v-else>\n\t\t\t\t\t<div class=\"bx-livechat-help-title bx-livechat-help-title-md bx-livechat-warning-msg\">{{localize.BX_LIVECHAT_ERROR_TITLE}}</div>\n\t\t\t\t\t<div class=\"bx-livechat-help-title bx-livechat-help-title-sm bx-livechat-warning-msg\">{{localize.BX_LIVECHAT_ERROR_DESC}}</div>\n\t\t\t\t</template> \n\t\t\t</div>\n\t\t</div>\n\t`\n});\n/* endregion 06-06. bx-livechat-body-error component */\n\n/* region 06-07. bx-livechat-smiles component */\nBX.Vue.cloneComponent('bx-livechat-smiles', 'bx-smiles',\n{\n\tmethods:\n\t{\n\t\thideForm(event)\n\t\t{\n\t\t\tthis.$parent.hideForm();\n\t\t},\n\t},\n\ttemplate: `\n\t\t<transition enter-active-class=\"bx-livechat-consent-window-show\" leave-active-class=\"bx-livechat-form-close\">\n\t\t\t<div class=\"bx-livechat-alert-box bx-livechat-alert-box-zero-padding bx-livechat-form-show\" key=\"vote\">\n\t\t\t\t<div class=\"bx-livechat-alert-close\" @click=\"hideForm\"></div>\n\t\t\t\t<div class=\"bx-livechat-alert-smiles-box\">\n\t\t\t\t\t#PARENT_TEMPLATE#\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</transition>\n\t`\n});\n/* endregion 06-07. bx-livechat-smiles component */\n\n/* region 06-08. bx-livechat-form-welcome component */\nBX.Vue.component('bx-livechat-form-welcome',\n{\n\tdata()\n\t{\n\t\treturn {\n\t\t\tfieldName: '',\n\t\t\tfieldEmail: '',\n\t\t\tfieldPhone: '',\n\t\t\tisFullForm: BX.Messenger.Utils.platform.isMobile()\n\t\t}\n\t},\n\twatch:\n\t{\n\t\tfieldName()\n\t\t{\n\t\t\tclearTimeout(this.showFormTimeout);\n\t\t\tthis.showFormTimeout = setTimeout(this.showFullForm, 1000);\n\n\t\t\tclearTimeout(this.fieldNameTimeout);\n\t\t\tthis.fieldNameTimeout = setTimeout(this.checkNameField, 300);\n\t\t},\n\t\tfieldEmail(value)\n\t\t{\n\t\t\tclearTimeout(this.fieldEmailTimeout);\n\t\t\tthis.fieldEmailTimeout = setTimeout(this.checkEmailField, 300);\n\t\t},\n\t\tfieldPhone(value)\n\t\t{\n\t\t\tclearTimeout(this.fieldPhoneTimeout);\n\t\t\tthis.fieldPhoneTimeout = setTimeout(this.checkPhoneField, 300);\n\t\t}\n\t},\n\tcomputed:\n\t{\n\t\tlocalize()\n\t\t{\n\t\t\treturn BX.Vue.getFilteredPhrases('BX_LIVECHAT_', this.$root.$bitrixMessages);\n\t\t},\n\t\t...BX.Vuex.mapState({\n\t\t\tuserData: state => state.widget.userData,\n\t\t})\n\t},\n\tcreated()\n\t{\n\t\tthis.fieldName = '' + this.userData.name;\n\t\tthis.fieldEmail = '' + this.userData.email;\n\t\tthis.fieldPhone = '' + this.userData.phone;\n\t},\n\tmethods:\n\t{\n\t\tformShowed()\n\t\t{\n\t\t\tif (!BX.Messenger.Utils.platform.isMobile())\n\t\t\t{\n\t\t\t\tthis.$refs.nameInput.focus();\n\t\t\t}\n\t\t},\n\t\tshowFullForm()\n\t\t{\n\t\t\tclearTimeout(this.showFormTimeout);\n\t\t\tthis.isFullForm = true;\n\t\t},\n\t\tsendForm()\n\t\t{\n\t\t\tlet name = this.fieldName;\n\t\t\tlet email = this.checkEmailField()? this.fieldEmail: '';\n\t\t\tlet phone = this.checkPhoneField()? this.fieldPhone: '';\n\n\t\t\tif (name || email || phone)\n\t\t\t{\n\t\t\t\tthis.$root.$bitrixController.sendForm(FormType.welcome, {name, email, phone});\n\t\t\t}\n\n\t\t\tthis.hideForm();\n\t\t},\n\t\thideForm(event)\n\t\t{\n\t\t\tclearTimeout(this.showFormTimeout);\n\t\t\tclearTimeout(this.fieldNameTimeout);\n\t\t\tclearTimeout(this.fieldEmailTimeout);\n\t\t\tclearTimeout(this.fieldPhoneTimeout);\n\n\t\t\tthis.$parent.hideForm();\n\t\t},\n\t\tonFieldEnterPress(event)\n\t\t{\n\t\t\tif (event.target === this.$refs.nameInput)\n\t\t\t{\n\t\t\t\tthis.showFullForm();\n\t\t\t\tthis.$refs.emailInput.focus();\n\t\t\t}\n\t\t\telse if (event.target === this.$refs.emailInput)\n\t\t\t{\n\t\t\t\tthis.$refs.phoneInput.focus();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.sendForm();\n\t\t\t}\n\n\t\t\tevent.preventDefault();\n\t\t},\n\t\tcheckNameField()\n\t\t{\n\t\t\tif (this.fieldName.length > 0)\n\t\t\t{\n\t\t\t\tif (this.$refs.name)\n\t\t\t\t{\n\t\t\t\t\tthis.$refs.name.classList.remove('ui-ctl-danger');\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (document.activeElement !== this.$refs.nameInput)\n\t\t\t\t{\n\t\t\t\t\tif (this.$refs.name)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$refs.name.classList.add('ui-ctl-danger');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\t\t},\n\t\tcheckEmailField()\n\t\t{\n\t\t\tif (this.fieldEmail.match(/^(.*)@(.*)\\.[a-zA-Z]{2,}$/))\n\t\t\t{\n\t\t\t\tif (this.$refs.email)\n\t\t\t\t{\n\t\t\t\t\tthis.$refs.email.classList.remove('ui-ctl-danger');\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (document.activeElement !== this.$refs.emailInput)\n\t\t\t\t{\n\t\t\t\t\tif (this.$refs.email)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$refs.email.classList.add('ui-ctl-danger');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\t\t},\n\t\tcheckPhoneField()\n\t\t{\n\t\t\tif (this.fieldPhone.match(/^(\\s*)?(\\+)?([- _():=+]?\\d[- _():=+]?){10,14}(\\s*)?$/))\n\t\t\t{\n\t\t\t\tif (this.$refs.phone)\n\t\t\t\t{\n\t\t\t\t\tthis.$refs.phone.classList.remove('ui-ctl-danger');\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (document.activeElement !== this.$refs.phoneInput)\n\t\t\t\t{\n\t\t\t\t\tif (this.$refs.phone)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$refs.phone.classList.add('ui-ctl-danger');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t},\n\ttemplate: `\n\t\t<transition enter-active-class=\"bx-livechat-consent-window-show\" leave-active-class=\"bx-livechat-form-close\" @after-enter=\"formShowed\">\n\t\t\t<div class=\"bx-livechat-alert-box bx-livechat-form-show\" key=\"welcome\">\t\n\t\t\t\t<div class=\"bx-livechat-alert-close\" @click=\"hideForm\"></div>\n\t\t\t\t<div class=\"bx-livechat-alert-form-box\">\n\t\t\t\t\t<h4 class=\"bx-livechat-alert-title bx-livechat-alert-title-sm\">{{localize.BX_LIVECHAT_ABOUT_TITLE}}</h4>\n\t\t\t\t\t<div class=\"bx-livechat-form-item ui-ctl ui-ctl-w100 ui-ctl-lg\" ref=\"name\">\n\t\t\t\t\t   <input type=\"text\" class=\"ui-ctl-element ui-ctl-textbox\" :placeholder=\"localize.BX_LIVECHAT_FIELD_NAME\" v-model=\"fieldName\" ref=\"nameInput\" @blur=\"checkNameField\" @keydown.enter=\"onFieldEnterPress\"  @keydown.tab=\"onFieldEnterPress\">\n\t\t\t\t\t</div>\n\t\t\t\t\t<div :class=\"['bx-livechat-form-short', {\n\t\t\t\t\t\t'bx-livechat-form-full': isFullForm,\n\t\t\t\t\t}]\">\n\t\t\t\t\t\t<div class=\"bx-livechat-form-item ui-ctl ui-ctl-after-icon ui-ctl-w100 ui-ctl-lg\" ref=\"email\">\n\t\t\t\t\t\t   <div class=\"ui-ctl-after ui-ctl-icon-mail bx-livechat-form-icon\" :title=\"localize.BX_LIVECHAT_FIELD_MAIL_TOOLTIP\"></div>\n\t\t\t\t\t\t   <input type=\"text\" class=\"ui-ctl-element ui-ctl-textbox\" :placeholder=\"localize.BX_LIVECHAT_FIELD_MAIL\" v-model=\"fieldEmail\" ref=\"emailInput\" @blur=\"checkEmailField\" @keydown.enter=\"onFieldEnterPress\">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"bx-livechat-form-item ui-ctl ui-ctl-after-icon ui-ctl-w100 ui-ctl-lg\" ref=\"phone\">\n\t\t\t\t\t\t   <div class=\"ui-ctl-after ui-ctl-icon-phone bx-livechat-form-icon\" :title=\"localize.BX_LIVECHAT_FIELD_PHONE_TOOLTIP\"></div>\n\t\t\t\t\t\t   <input type=\"text\" class=\"ui-ctl-element ui-ctl-textbox\" :placeholder=\"localize.BX_LIVECHAT_FIELD_PHONE\" v-model=\"fieldPhone\" ref=\"phoneInput\" @blur=\"checkPhoneField\" @keydown.enter=\"onFieldEnterPress\">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"bx-livechat-btn-box\">\n\t\t\t\t\t\t\t<button class=\"bx-livechat-btn bx-livechat-btn-success\" @click=\"sendForm\">{{localize.BX_LIVECHAT_ABOUT_SEND}}</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\t\n\t\t</transition>\t\n\t`\n});\n/* endregion 06-08. bx-livechat-form-welcome component */\n\nBX.Vue.cloneComponent('bx-livechat-form-offline', 'bx-livechat-form-welcome',\n{\n\tmethods:\n\t{\n\t\tformShowed()\n\t\t{\n\t\t\tif (!BX.Messenger.Utils.platform.isMobile())\n\t\t\t{\n\t\t\t\tthis.$refs.emailInput.focus();\n\t\t\t}\n\t\t},\n\t\tsendForm()\n\t\t{\n\t\t\tlet name = this.fieldName;\n\t\t\tlet email = this.checkEmailField()? this.fieldEmail: '';\n\t\t\tlet phone = this.checkPhoneField()? this.fieldPhone: '';\n\n\t\t\tif (name || email || phone)\n\t\t\t{\n\t\t\t\tthis.$root.$bitrixController.sendForm(FormType.offline, {name, email, phone});\n\t\t\t}\n\n\t\t\tthis.hideForm();\n\t\t},\n\t\tonFieldEnterPress(event)\n\t\t{\n\t\t\tif (event.target === this.$refs.emailInput)\n\t\t\t{\n\t\t\t\tthis.showFullForm();\n\t\t\t\tthis.$refs.phoneInput.focus();\n\t\t\t}\n\t\t\telse if (event.target === this.$refs.phoneInput)\n\t\t\t{\n\t\t\t\tthis.$refs.nameInput.focus();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.sendForm();\n\t\t\t}\n\n\t\t\tevent.preventDefault();\n\t\t},\n\t},\n\twatch:\n\t{\n\t\tfieldName()\n\t\t{\n\t\t\tclearTimeout(this.fieldNameTimeout);\n\t\t\tthis.fieldNameTimeout = setTimeout(this.checkNameField, 300);\n\t\t},\n\t\tfieldEmail()\n\t\t{\n\t\t\tclearTimeout(this.showFormTimeout);\n\t\t\tthis.showFormTimeout = setTimeout(this.showFullForm, 1000);\n\n\t\t\tclearTimeout(this.fieldEmailTimeout);\n\t\t\tthis.fieldEmailTimeout = setTimeout(this.checkEmailField, 300);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<transition enter-active-class=\"bx-livechat-consent-window-show\" leave-active-class=\"bx-livechat-form-close\" @after-enter=\"formShowed\">\n\t\t\t<div class=\"bx-livechat-alert-box bx-livechat-form-show\" key=\"welcome\">\t\n\t\t\t\t<div class=\"bx-livechat-alert-close\" @click=\"hideForm\"></div>\n\t\t\t\t<div class=\"bx-livechat-alert-form-box\">\n\t\t\t\t\t<h4 class=\"bx-livechat-alert-title bx-livechat-alert-title-sm\">{{localize.BX_LIVECHAT_OFFLINE_TITLE}}</h4>\n\t\t\t\t\t<div class=\"bx-livechat-form-item ui-ctl ui-ctl-after-icon ui-ctl-w100 ui-ctl-lg\" ref=\"email\">\n\t\t\t\t\t   <div class=\"ui-ctl-after ui-ctl-icon-mail bx-livechat-form-icon\" :title=\"localize.BX_LIVECHAT_FIELD_MAIL_TOOLTIP\"></div>\n\t\t\t\t\t   <input type=\"text\" class=\"ui-ctl-element ui-ctl-textbox\" :placeholder=\"localize.BX_LIVECHAT_FIELD_MAIL\" v-model=\"fieldEmail\" ref=\"emailInput\" @blur=\"checkEmailField\" @keydown.enter=\"onFieldEnterPress\">\n\t\t\t\t\t</div>\n\t\t\t\t\t<div :class=\"['bx-livechat-form-short', {\n\t\t\t\t\t\t'bx-livechat-form-full': isFullForm,\n\t\t\t\t\t}]\">\n\t\t\t\t\t\t<div class=\"bx-livechat-form-item ui-ctl ui-ctl-after-icon ui-ctl-w100 ui-ctl-lg\" ref=\"phone\">\n\t\t\t\t\t\t   <div class=\"ui-ctl-after ui-ctl-icon-phone bx-livechat-form-icon\" :title=\"localize.BX_LIVECHAT_FIELD_PHONE_TOOLTIP\"></div>\n\t\t\t\t\t\t   <input type=\"text\" class=\"ui-ctl-element ui-ctl-textbox\" :placeholder=\"localize.BX_LIVECHAT_FIELD_PHONE\" v-model=\"fieldPhone\" ref=\"phoneInput\" @blur=\"checkPhoneField\" @keydown.enter=\"onFieldEnterPress\">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"bx-livechat-form-item ui-ctl ui-ctl-w100 ui-ctl-lg\" ref=\"name\">\n\t\t\t\t\t\t   <input type=\"text\" class=\"ui-ctl-element ui-ctl-textbox\" :placeholder=\"localize.BX_LIVECHAT_FIELD_NAME\" v-model=\"fieldName\" ref=\"nameInput\" @blur=\"checkNameField\" @keydown.enter=\"onFieldEnterPress\"  @keydown.tab=\"onFieldEnterPress\">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"bx-livechat-btn-box\">\n\t\t\t\t\t\t\t<button class=\"bx-livechat-btn bx-livechat-btn-success\" @click=\"sendForm\">{{localize.BX_LIVECHAT_ABOUT_SEND}}</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\t\n\t\t</transition>\t\n\t`\n});\n\n/* region 06-09. bx-livechat-form-history component */\nBX.Vue.component('bx-livechat-form-history',\n{\n\tdata()\n\t{\n\t\treturn {\n\t\t\tfieldEmail: '',\n\t\t}\n\t},\n\twatch:\n\t{\n\t\tfieldEmail(value)\n\t\t{\n\t\t\tclearTimeout(this.fieldEmailTimeout);\n\t\t\tthis.fieldEmailTimeout = setTimeout(this.checkEmailField, 300);\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tlocalize()\n\t\t{\n\t\t\treturn BX.Vue.getFilteredPhrases('BX_LIVECHAT_', this.$root.$bitrixMessages);\n\t\t},\n\t\t...BX.Vuex.mapState({\n\t\t\tuserData: state => state.widget.userData,\n\t\t})\n\t},\n\tcreated()\n\t{\n\t\tthis.fieldEmail = '' + this.userData.email;\n\t},\n\tmethods:\n\t{\n\t\tformShowed()\n\t\t{\n\t\t\tif (!BX.Messenger.Utils.platform.isMobile())\n\t\t\t{\n\t\t\t\tthis.$refs.emailInput.focus();\n\t\t\t}\n\t\t},\n\t\tsendForm()\n\t\t{\n\t\t\tlet email = this.checkEmailField()? this.fieldEmail: '';\n\t\t\tif (email)\n\t\t\t{\n\t\t\t\tthis.$root.$bitrixController.sendForm(FormType.history, {email});\n\t\t\t}\n\n\t\t\tthis.hideForm();\n\t\t},\n\t\thideForm(event)\n\t\t{\n\t\t\tclearTimeout(this.fieldEmailTimeout);\n\t\t\tthis.$parent.hideForm();\n\t\t},\n\t\tonFieldEnterPress(event)\n\t\t{\n\t\t\tthis.sendForm();\n\t\t\tevent.preventDefault();\n\t\t},\n\t\tcheckEmailField()\n\t\t{\n\t\t\tif (this.fieldEmail.match(/^(.*)@(.*)\\.[a-zA-Z]{2,}$/))\n\t\t\t{\n\t\t\t\tif (this.$refs.email)\n\t\t\t\t{\n\t\t\t\t\tthis.$refs.email.classList.remove('ui-ctl-danger');\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (document.activeElement !== this.$refs.emailInput)\n\t\t\t\t{\n\t\t\t\t\tif (this.$refs.email)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$refs.email.classList.add('ui-ctl-danger');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\t\t},\n\t},\n\ttemplate: `\n\t\t<transition enter-active-class=\"bx-livechat-consent-window-show\" leave-active-class=\"bx-livechat-form-close\" @after-enter=\"formShowed\">\n\t\t\t<div class=\"bx-livechat-alert-box bx-livechat-form-show\" key=\"welcome\">\t\n\t\t\t\t<div class=\"bx-livechat-alert-close\" @click=\"hideForm\"></div>\n\t\t\t\t<div class=\"bx-livechat-alert-form-box\">\n\t\t\t\t\t<h4 class=\"bx-livechat-alert-title bx-livechat-alert-title-sm\">{{localize.BX_LIVECHAT_MAIL_TITLE_NEW}}</h4>\n\t\t\t\t\t<div class=\"bx-livechat-form-item ui-ctl ui-ctl-after-icon ui-ctl-w100 ui-ctl-lg\" ref=\"email\">\n\t\t\t\t\t   <div class=\"ui-ctl-after ui-ctl-icon-mail bx-livechat-form-icon\" :title=\"localize.BX_LIVECHAT_FIELD_MAIL_TOOLTIP\"></div>\n\t\t\t\t\t   <input type=\"text\" class=\"ui-ctl-element ui-ctl-textbox\" :placeholder=\"localize.BX_LIVECHAT_FIELD_MAIL\" v-model=\"fieldEmail\" ref=\"emailInput\" @blur=\"checkEmailField\" @keydown.enter=\"onFieldEnterPress\">\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"bx-livechat-btn-box\">\n\t\t\t\t\t\t<button class=\"bx-livechat-btn bx-livechat-btn-success\" @click=\"sendForm\">{{localize.BX_LIVECHAT_MAIL_BUTTON_NEW}}</button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\t\n\t\t</transition>\t\n\t`\n});\n/* endregion 06-09. bx-livechat-form component */\n\n/* region 06-10. bx-livechat-form-vote component */\nBX.Vue.component('bx-livechat-form-vote',\n{\n\tcomputed:\n\t{\n\t\tVoteType: () => VoteType,\n\n\t\tlocalize()\n\t\t{\n\t\t\treturn BX.Vue.getFilteredPhrases('BX_LIVECHAT_', this.$root.$bitrixMessages);\n\t\t},\n\t\t...BX.Vuex.mapState({\n\t\t\twidgetData: state => state.widget.widgetData,\n\t\t})\n\t},\n\tmethods: {\n\t\tuserVote(vote)\n\t\t{\n\t\t\tthis.$store.commit(WidgetStore.widgetData, {showForm: FormType.none});\n\t\t\tthis.$store.commit(WidgetStore.dialogData, {userVote: vote});\n\n\t\t\tthis.$root.$bitrixController.sendDialogVote(vote);\n\t\t},\n\t\thideForm(event)\n\t\t{\n\t\t\tthis.$parent.hideForm();\n\t\t},\n\t},\n\ttemplate: `\n\t\t<transition enter-active-class=\"bx-livechat-consent-window-show\" leave-active-class=\"bx-livechat-form-close\">\n\t\t\t<div class=\"bx-livechat-alert-box bx-livechat-form-rate-show\" key=\"vote\">\n\t\t\t\t<div class=\"bx-livechat-alert-close\" @click=\"hideForm\"></div>\n\t\t\t\t<div class=\"bx-livechat-alert-rate-box\">\n\t\t\t\t\t<h4 class=\"bx-livechat-alert-title bx-livechat-alert-title-mdl\">{{widgetData.vote.messageText}}</h4>\n\t\t\t\t\t<div class=\"bx-livechat-btn-box\">\n\t\t\t\t\t\t<button class=\"bx-livechat-btn bx-livechat-btn-like\" @click=\"userVote(VoteType.like)\" :title=\"widgetData.vote.messageLike\"></button>\n\t\t\t\t\t\t<button class=\"bx-livechat-btn bx-livechat-btn-dislike\" @click=\"userVote(VoteType.dislike)\" :title=\"widgetData.vote.messageDislike\"></button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</transition>\t\n\t`\n});\n/* endregion 06-10. bx-livechat-form-vote component */\n\n/* region 06-11. bx-livechat-form-consent component */\nBX.Vue.component('bx-livechat-form-consent',\n{\n\t/**\n\t * @emits 'agree' {event: object} -- 'event' - click event\n\t * @emits 'disagree' {event: object} -- 'event' - click event\n\t */\n\tcomputed:\n\t{\n\t\tlocalize()\n\t\t{\n\t\t\treturn BX.Vue.getFilteredPhrases('BX_LIVECHAT_', this.$root.$bitrixMessages);\n\t\t},\n\t\t...BX.Vuex.mapState({\n\t\t\twidgetData: state => state.widget.widgetData,\n\t\t})\n\t},\n\tmethods:\n\t{\n\t\tagree(event)\n\t\t{\n\t\t\tthis.$emit('agree', {event});\n\t\t},\n\t\tdisagree(event)\n\t\t{\n\t\t\tthis.$emit('disagree', {event});\n\t\t},\n\t\tonShow(element, done)\n\t\t{\n\t\t\telement.classList.add('bx-livechat-consent-window-show');\n\t\t\tdone();\n\t\t},\n\t\tonHide(element, done)\n\t\t{\n\t\t\telement.classList.remove('bx-livechat-consent-window-show');\n\t\t\telement.classList.add('bx-livechat-consent-window-close');\n\t\t\tsetTimeout(function() {\n\t\t\t\tdone();\n\t\t\t}, 400);\n\t\t},\n\t\tonKeyDown(event)\n\t\t{\n\t\t\tif (event.keyCode == 9)\n\t\t\t{\n\t\t\t\tif (event.target === this.$refs.iframe)\n\t\t\t\t{\n\t\t\t\t\tif (event.shiftKey)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$refs.cancel.focus();\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$refs.success.focus();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (event.target === this.$refs.success)\n\t\t\t\t{\n\t\t\t\t\tif (event.shiftKey)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$refs.iframe.focus();\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$refs.cancel.focus();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (event.target === this.$refs.cancel)\n\t\t\t\t{\n\t\t\t\t\tif (event.shiftKey)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$refs.success.focus();\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$refs.iframe.focus();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tevent.preventDefault();\n\t\t\t}\n\t\t\telse if (event.keyCode == 39 || event.keyCode == 37)\n\t\t\t{\n\t\t\t\tif (event.target.nextElementSibling)\n\t\t\t\t{\n\t\t\t\t\tevent.target.nextElementSibling.focus();\n\t\t\t\t}\n\t\t\t\telse if (event.target.previousElementSibling)\n\t\t\t\t{\n\t\t\t\t\tevent.target.previousElementSibling.focus();\n\t\t\t\t}\n\t\t\t\tevent.preventDefault();\n\t\t\t}\n\t\t},\n\t},\n\tdirectives:\n\t{\n\t\tfocus:\n\t\t{\n\t\t\tinserted(element, params)\n\t\t\t{\n\t\t\t\telement.focus();\n\t\t\t}\n\t\t}\n\t},\n\ttemplate: `\n\t\t<transition @enter=\"onShow\" @leave=\"onHide\">\n\t\t\t<template v-if=\"widgetData.showConsent && widgetData.consentUrl\">\n\t\t\t\t<div class=\"bx-livechat-consent-window\">\n\t\t\t\t\t<div class=\"bx-livechat-consent-window-title\">{{localize.BX_LIVECHAT_CONSENT_TITLE}}</div>\n\t\t\t\t\t<div class=\"bx-livechat-consent-window-content\">\n\t\t\t\t\t\t<iframe class=\"bx-livechat-consent-window-content-iframe\" ref=\"iframe\" frameborder=\"0\" marginheight=\"0\"  marginwidth=\"0\" allowtransparency=\"allow-same-origin\" seamless=\"true\" :src=\"widgetData.consentUrl\" @keydown=\"onKeyDown\"></iframe>\n\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\n\t\t\t\t\t<div class=\"bx-livechat-consent-window-btn-box\">\n\t\t\t\t\t\t<button class=\"bx-livechat-btn bx-livechat-btn-success\" ref=\"success\" @click=\"agree\" @keydown=\"onKeyDown\" v-focus>{{localize.BX_LIVECHAT_CONSENT_AGREE}}</button>\n\t\t\t\t\t\t<button class=\"bx-livechat-btn bx-livechat-btn-cancel\" ref=\"cancel\" @click=\"disagree\" @keydown=\"onKeyDown\">{{localize.BX_LIVECHAT_CONSENT_DISAGREE}}</button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t</transition>\n\t`\n});\n/* endregion 06-11. bx-livechat-form-consent component */\n\n/* region 06-12. bx-livechat-footer component */\nBX.Vue.component('bx-livechat-footer',\n{\n\tcomputed:\n\t{\n\t\tlocalize()\n\t\t{\n\t\t\treturn BX.Vue.getFilteredPhrases('BX_LIVECHAT_COPYRIGHT_', this.$root.$bitrixMessages);\n\t\t},\n\t\t...BX.Vuex.mapState({\n\t\t\twidgetData: state => state.widget.widgetData\n\t\t})\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-livechat-copyright\">\t\n\t\t\t<template v-if=\"widgetData.copyrightUrl\">\n\t\t\t\t<a :href=\"widgetData.copyrightUrl\" target=\"_blank\">\n\t\t\t\t\t<span class=\"bx-livechat-logo-name\">{{localize.BX_LIVECHAT_COPYRIGHT_TEXT}}</span>\n\t\t\t\t\t<span class=\"bx-livechat-logo-icon\"></span>\n\t\t\t\t</a>\n\t\t\t</template>\n\t\t\t<template v-else>\n\t\t\t\t<span class=\"bx-livechat-logo-name\">{{localize.BX_LIVECHAT_COPYRIGHT_TEXT}}</span>\n\t\t\t\t<span class=\"bx-livechat-logo-icon\"></span>\n\t\t\t</template>\n\t\t</div>\n\t`\n});\n/* endregion 06-12. bx-livechat-footer component */\n\n/* endregion 06. Vue Components */\n\n/* region 07. Initialize */\nif (!window.BX)\n{\n\twindow.BX = {};\n}\nif (!window.BX.LiveChatWidget)\n{\n\tBX.LiveChatWidget = LiveChatWidget;\n\tBX.LiveChatWidget.VoteType = VoteType;\n\tBX.LiveChatWidget.SubscriptionType = SubscriptionType;\n\tBX.LiveChatWidget.LocationStyle = LocationStyle;\n\tBX.LiveChatWidget.WidgetStore = WidgetStore;\n}\n\nwindow.dispatchEvent(new CustomEvent('onBitrixLiveChatSourceLoaded', {detail: {}}));\n/* endregion 07. Initialize */"],"names":["GetObjectValues","source","destination","value","hasOwnProperty","push","VoteType","Object","freeze","none","like","dislike","DeviceOrientation","horizontal","portrait","DeviceType","mobile","desktop","LanguageType","russian","ukraine","world","FormType","smile","consent","welcome","offline","history","LocationType","topLeft","topMiddle","topBottom","bottomLeft","bottomMiddle","bottomRight","LocationStyle","SubscriptionType","configLoaded","widgetOpen","widgetClose","sessionStart","sessionOperatorChange","sessionFinish","operatorMessage","userForm","userMessage","userVote","every","SubscriptionTypeCheck","WidgetStore","dialogData","widgetData","userData","MessengerStore","messages","BX","Messenger","Model","Messages","getName","dialogues","Dialogues","users","Users","files","Files","MessengerMessageStore","initCollection","add","set","setBefore","update","delete","actionStart","actionFinish","actionError","readMessages","MessengerMessageGetters","getLastId","MessengerUserStore","MessengerFileStore","MessengerDialogStore","updateWriting","decreaseCounter","increaseCounter","RestMethod","widgetUserRegister","widgetConfigGet","widgetDialogGet","widgetUserGet","widgetUserConsentApply","widgetVoteSend","widgetFormSend","pullServerTime","pullConfigGet","imMessageAdd","imMessageUpdate","imMessageDelete","imMessageLike","imChatGet","imChatSendTyping","imDialogMessagesGet","imDialogMessagesUnread","imDialogRead","diskFolderGet","diskFileUpload","diskFileCommit","RestMethodCheck","RestAuth","guest","LiveChatWidget","config","developerInfo","__privateMethods__","LiveChatWidgetPrivate","createLegacyMethods","params","open","close","showNotification","getUserData","setUserRegisterData","setCustomData","id","mutateTemplateComponent","phrases","addLocalize","subscribe","start","window","LiveChat","sourceHref","document","createElement","href","host","sourceDomain","protocol","hostname","port","openLiveChat","openFromButton","closeLiveChat","addEventListener","el","eventName","handler","type","callback","event","origin","data","JSON","stringify","action","console","warn","setCookie","getCookie","BxLiveChatInit","user","firstMessage","BxLiveChatLoader","Array","forEach","ready","widgetDataRequested","code","language","copyright","copyrightUrl","buttonInstance","pageMode","useBitrixLocalize","placeholder","getElementById","length","startsWith","inited","initEventFired","restClient","pullClient","userRegisterData","customData","localize","message","subscribers","dateFormat","messagesQueue","filesQueue","filesQueueIndex","messageLastReadId","messageReadQueue","defaultMessageLimit","requestMessageLimit","configRequestXhr","location","Utils","types","isPlainObject","styles","backgroundColor","iconColor","store","Vuex","name","modules","widget","getWidgetStore","getInstance","getStore","rootNode","body","firstChild","insertBefore","appendChild","template","commit","deviceOrientation","device","getOrientation","state","showed","deviceType","activeElement","blur","serverVariables","LocalStorage","get","getSiteId","initRestClient","dispatchEvent","CustomEvent","detail","widgetCode","widgetHost","widgetDataDefault","siteId","getHost","configId","configName","vote","enable","messageText","getLocalize","messageLike","messageDislike","online","operators","connectors","disk","enabled","maxFileSize","showForm","uploadFile","reopen","dragged","textareaHeight","showConsent","consentUrl","dialogStart","error","active","description","isMobile","param","dialogDataDefault","dialogId","chatId","diskFolderId","sessionId","sessionClose","userConsent","messageLimit","operator","firstName","lastName","workPosition","avatar","userDataDefault","hash","email","phone","www","gender","position","userHash","getUserHashCookie","namespaced","mutations","uploadFilePlus","uploadFileMinus","toString","Cookie","expires","path","LiveChatRestClient","endpoint","isUserRegistered","setAuthId","getUserHash","isReady","requestData","fireInitEvent","isConfigDataLoaded","callMethod","xhr","then","result","clearError","storeDataFromRest","catch","setError","ex","error_description","timer","Timer","requestDataSend","abort","query","config_id","getConfigId","trace_data","getCrmTraceData","custom_data","getCustomData","dialog_id","chat_id","limit","convert_text","getUserRegisterFields","callBatch","response","configGet","userGetResult","chatGetResult","dialogGetResult","dialogMessagesGetResult","userRegisterResult","timeShift","serverTimeResult","Math","floor","Date","getTime","pullConfigResult","server","startPullClient","processSendMessages","processSendFiles","getLogTrackingParams","dialog","getDialogData","includes","previousData","collection","getChatId","fields","entityType","dispatch","ID","prepareFileData","isDialogStart","map","file","md5","getUserId","urlParam","urlPreview","urlShow","urlDownload","platform","isIos","version","getIosVersion","promise","Promise","isConnected","scheduleReconnect","resolve","reject","PullClient","serverEnabled","userId","configTimestamp","config_timestamp","skipCheckRevision","Server","moduleId","eventMessengerInteraction","bind","eventLinesInteraction","Status","eventStatusInteraction","pullConnectedFirstTime","status","PullStatus","Online","$bitrixPullClient","$root","$emit","restart","CloseReasons","MANUAL","stop","Logger","info","command","chat","convertToArray","dataParamsFiles","tempId","index","isUnreadMessagesLoaded","unreadCountInCollection","element","unread","getMessageLimit","startWriting","senderId","counter","count","sendEvent","onceShowed","text","textOriginal","blink","readId","lastId","spam","pullRequestMessage","getDialogUnread","readMessage","Offline","innerHTML","widgetContext","Vue","create","beforeCreate","$bitrixController","$bitrixRestClient","$bitrixMessages","destroyed","templateAttached","$destroy","mutateComponent","sendMessage","authorId","messageId","sending","fileInput","size","has","filter","sendFile","stopWritesMessage","timMessageType","fileName","fileType","getDiskFolderId","NAME","fileContent","generateUniqueName","upload_id","log","getSessionId","toUpperCase","form","consent_url","requestResult","getters","getDialogId","first_id","dialogMessageUnread","dialogMessageUnreadResult","fulfill","find","parseInt","elementId","userName","isSessionActive","requestWidgetData","wm","showById","checkBrowserVersion","BX_LIVECHAT_OLD_BROWSER","versionCompare","alert","BX_LIVECHAT_OLD_VUE","BX_LIVECHAT_OLD_VUE_DEV","replace","isWidgetDataRequested","attachTemplate","onWidgetClose","detachTemplate","traceData","getTrace","b24Tracker","MESSAGE","BX_LIVECHAT_EXTRA_SITE","unreadLastId","lastElementId","lastElement","cookie","match","validUserFields","field","indexOf","setNewAuthToken","authToken","LiveChatCookie","remove","concat","localizeDescription","endsWith","phrase","Main","_getMessage","cookieName","navigator","cookieEnabled","RegExp","decodeURIComponent","isEnabled","undefined","options","currentDate","setTime","toUTCString","encodeURIComponent","updatedCookie","propertyName","propertyValue","queryAuthRestore","RestClient","queryParams","cors","authId","customAuthId","livechat_auth_id","livechat_custom_auth_id","method","sendCallback","logTag","calls","bHaltOnError","resultCallback","component","viewPortMetaSiteNode","viewPortMetaWidgetNode","storedMessage","storedFile","textareaFocused","textareaDrag","textareaMinimumHeight","textareaMaximumHeight","created","onCreated","onWindowKeyDown","$on","onRequestShowForm","beforeDestroy","removeEventListener","$off","onTextareaDragEventRemove","computed","textareaHeightStyle","getFilteredPhrases","widgetMobileDisabled","userAgent","screen","availHeight","widgetClassName","className","browser","isSafari","isIe","isMac","isDarkColor","join","showMessageDialog","messageCollection","mapState","watch","methods","$store","onBeforeClose","showLikeForm","clearTimeout","showFormTimeout","showWelcomeForm","showOfflineForm","showHistoryForm","hideForm","showConsentWidow","agreeConsentWidow","sendConsentDecision","onTextareaSend","focus","onTextareaFileSelected","disagreeConsentWidow","logEvent","from","head","getElementsByTagName","removeChild","contentWidth","offsetWidth","innerWidth","setAttribute","classList","isSafariBased","setTimeout","onAfterClose","delayed","onDialogRequestHistory","getDialogHistory","onDialogRequestUnread","onDialogMessageClickByUserName","onDialogMessageClickByCommand","addMessage","onDialogMessageMenuClick","onDialogMessageRetryClick","retrySendMessage","onDialogReadMessage","onDialogClick","onTextareaWrites","writesMessage","onTextareaFocus","onTextareaFocusScrollTimeout","onWindowScroll","onTextareaBlur","$nextTick","force","onTextareaStartDrag","changedTouches","textareaDragCursorStartPoint","clientY","textareaDragHeightStartPoint","onTextareaDragEventAdd","onTextareaContinueDrag","textareaDragCursorControlPoint","max","min","onTextareaStopDrag","BX_LIVECHAT_FILE_SIZE_EXCEEDED","round","addFile","onTextareaAppButtonClick","appId","onPullRequestConfig","recoverPullConnection","onSmilesSelectSmile","onSmilesSelectSet","keyCode","preventDefault","stopPropagation","onWindowScrollTimeout","props","isWidgetDisabled","default","customBackgroundStyle","customBackgroundOnlineStyle","showName","BX_LIVECHAT_MOBILE_ROTATE","BX_LIVECHAT_LOADING","BX_LIVECHAT_ERROR_TITLE","BX_LIVECHAT_ERROR_DESC","cloneComponent","$parent","fieldName","fieldEmail","fieldPhone","isFullForm","showFullForm","fieldNameTimeout","checkNameField","fieldEmailTimeout","checkEmailField","fieldPhoneTimeout","checkPhoneField","formShowed","$refs","nameInput","sendForm","onFieldEnterPress","target","emailInput","phoneInput","sendDialogVote","agree","disagree","onShow","done","onHide","onKeyDown","iframe","shiftKey","cancel","success","nextElementSibling","previousElementSibling","directives","inserted"],"mappings":"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"}