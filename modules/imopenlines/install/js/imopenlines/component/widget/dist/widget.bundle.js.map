{"version":3,"file":"widget.bundle.js","sources":["../src/const.js","../src/model.js","../src/utils/restclient.js","../src/rest.handler.js","../src/pull.handler.js","../src/widget.js","../src/public.js","../src/event-handler/widget-send-message-handler.js","../src/event-handler/widget-textarea-handler.js","../src/event-handler/widget-textarea-upload-handler.js","../src/event-handler/widget-reading-handler.js","../src/event-handler/widget-resize-handler.js","../src/event-handler/widget-consent-handler.js","../src/event-handler/widget-form-handler.js","../src/event-handler/widget-reaction-handler.js","../src/event-handler/widget-history-handler.js","../src/event-handler/widget-dialog-action-handler.js","../src/component/bx-livechat.js","../src/component/bx-livechat-body-error.js","../src/component/bx-livechat-body-head.js","../src/component/bx-livechat-body-loading.js","../src/component/bx-livechat-body-operators.js","../src/component/bx-livechat-dialogues-list.js","../src/component/bx-livechat-body-orientation-disabled.js","../src/component/bx-livechat-form-consent.js","../src/component/bx-livechat-form-vote.js","../src/component/bx-livechat-smiles.js","../src/registry.js"],"sourcesContent":["/**\n * Bitrix OpenLines widget\n * Widget constants\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nfunction GetObjectValues(source)\n{\n\tconst destination = [];\n\tfor (let value in source)\n\t{\n\t\tif (source.hasOwnProperty(value))\n\t\t{\n\t\t\tdestination.push(source[value]);\n\t\t}\n\t}\n\treturn destination;\n}\n\n/* region 01. Constants */\n\nexport const VoteType = Object.freeze({\n\tnone: 'none',\n\tlike: 'like',\n\tdislike: 'dislike',\n});\n\nexport const LanguageType = Object.freeze({\n\trussian: 'ru',\n\tukraine: 'ua',\n\tworld: 'en',\n});\n\nexport const FormType = Object.freeze({\n\tnone: 'none',\n\tlike: 'like',\n\tsmile: 'smile',\n\tconsent: 'consent',\n\twelcome: 'welcome',\n\toffline: 'offline',\n\thistory: 'history',\n});\n\nexport const LocationType = Object.freeze({\n\ttopLeft: 1,\n\ttopMiddle: 2,\n\ttopBottom: 3,\n\tbottomLeft: 6,\n\tbottomMiddle: 5,\n\tbottomRight: 4,\n});\n\nexport const LocationStyle = Object.freeze({\n\t1: 'top-left',\n\t2: 'top-center',\n\t3: 'top-right',\n\t6: 'bottom-left',\n\t5: 'bottom-center',\n\t4: 'bottom-right',\n});\n\nexport const WidgetBaseSize = Object.freeze({\n\twidth: 435,\n\theight: 557\n});\n\nexport const WidgetMinimumSize = Object.freeze({\n\twidth: 340,\n\theight: 435\n});\n\nexport const SubscriptionType = Object.freeze({\n\tconfigLoaded: 'configLoaded',\n\twidgetOpen: 'widgetOpen',\n\twidgetClose: 'widgetClose',\n\tsessionStart: 'sessionStart',\n\tsessionOperatorChange: 'sessionOperatorChange',\n\tsessionFinish: 'sessionFinish',\n\toperatorMessage: 'operatorMessage',\n\tuserForm: 'userForm',\n\tuserMessage: 'userMessage',\n\tuserFile: 'userFile',\n\tuserVote: 'userVote',\n\tevery: 'every',\n});\nexport const SubscriptionTypeCheck = GetObjectValues(SubscriptionType);\n\nexport const RestMethod = Object.freeze({\n\twidgetUserRegister: 'imopenlines.widget.user.register',\n\twidgetChatCreate: 'imopenlines.widget.chat.create',\n\twidgetConfigGet: 'imopenlines.widget.config.get',\n\twidgetDialogGet: 'imopenlines.widget.dialog.get',\n\twidgetDialogList: 'imopenlines.widget.dialog.list',\n\twidgetUserGet: 'imopenlines.widget.user.get',\n\twidgetUserConsentApply: 'imopenlines.widget.user.consent.apply',\n\twidgetVoteSend: 'imopenlines.widget.vote.send',\n\twidgetActionSend: 'imopenlines.widget.action.send',\n\tpullServerTime: 'server.time',\n\tpullConfigGet: 'pull.config.get',\n});\nexport const RestMethodCheck = GetObjectValues(RestMethod);\n\nexport const RestAuth = Object.freeze({\n\tguest: 'guest',\n});\n\nexport const SessionStatus = Object.freeze({\n\tnew: 0,\n\tskip: 5,\n\tanswer: 10,\n\tclient: 20,\n\tclientAfterOperator: 25,\n\toperator: 40,\n\twaitClient: 50,\n\tclose: 60,\n\tspam: 65,\n\tduplicate: 69,\n\tsilentlyClose: 75,\n});\n\nexport const WidgetEventType = Object.freeze({\n\tshowForm: 'IMOL.Widget:showForm',\n\thideForm: 'IMOL.Widget:hideForm',\n\tprocessMessagesToSendQueue: 'IMOL.Widget:processMessagesToSendQueue',\n\trequestData: 'IMOL.Widget:requestData',\n\tshowConsent: 'IMOL.Widget:showConsent',\n\tacceptConsent: 'IMOL.Widget:acceptConsent',\n\tconsentAccepted: 'IMOL.Widget:consentAccepted',\n\tdeclineConsent: 'IMOL.Widget:declineConsent',\n\tconsentDeclined: 'IMOL.Widget:consentDeclined',\n\tsendDialogVote: 'IMOL.Widget:sendDialogVote',\n\tcreateSession: 'IMOL.Widget:createSession',\n\topenSession: 'IMOL.Widget:openSession',\n});","/**\n * Bitrix OpenLines widget\n * Widget model (Vuex Builder model)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {VuexBuilderModel} from 'ui.vue.vuex';\n\nimport {Utils} from 'im.lib.utils';\nimport {Cookie} from \"im.lib.cookie\";\nimport {FormType, LocationStyle, LocationType, VoteType} from \"./const\";\n\nexport class WidgetModel extends VuexBuilderModel\n{\n\t/**\n\t * @inheritDoc\n\t */\n\tgetName()\n\t{\n\t\treturn 'widget';\n\t}\n\n\tgetState()\n\t{\n\t\treturn {\n\t\t\tcommon:\n\t\t\t{\n\t\t\t\tconfigId: 0,\n\t\t\t\tconfigName: '',\n\t\t\t\thost: this.getVariable('common.host', location.protocol+'//'+location.host),\n\t\t\t\tpageMode: this.getVariable('common.pageMode', false),\n\t\t\t\tcopyright: this.getVariable('common.copyright', true),\n\t\t\t\tcopyrightUrl: this.getVariable('common.copyrightUrl', 'https://bitrix24.com'),\n\t\t\t\tlocation: this.getVariable('common.location', LocationType.bottomRight),\n\t\t\t\tstyles: {\n\t\t\t\t\tbackgroundColor: this.getVariable('styles.backgroundColor', '#17a3ea'),\n\t\t\t\t\ticonColor: this.getVariable('styles.iconColor', '#ffffff')\n\t\t\t\t},\n\t\t\t\tvote: {\n\t\t\t\t\tenable: false,\n\t\t\t\t\tbeforeFinish: true,\n\t\t\t\t\tmessageText: this.getVariable('vote.messageText', ''),\n\t\t\t\t\tmessageLike: this.getVariable('vote.messageLike', ''),\n\t\t\t\t\tmessageDislike: this.getVariable('vote.messageDislike', '')\n\t\t\t\t},\n\t\t\t\ttextMessages: {\n\t\t\t\t\tbxLivechatOnlineLine1: this.getVariable('textMessages.bxLivechatOnlineLine1', ''),\n\t\t\t\t\tbxLivechatOnlineLine2: this.getVariable('textMessages.bxLivechatOnlineLine2', ''),\n\t\t\t\t\tbxLivechatOffline: this.getVariable('textMessages.bxLivechatOffline', ''),\n\t\t\t\t\tbxLivechatTitle: '',\n\t\t\t\t},\n\t\t\t\tonline: false,\n\t\t\t\toperators: [],\n\t\t\t\tconnectors: [],\n\t\t\t\tshowForm: FormType.none,\n\t\t\t\tshowed: false,\n\t\t\t\treopen: false,\n\t\t\t\tdragged: false,\n\t\t\t\ttextareaHeight: 0,\n\t\t\t\twidgetHeight: 0,\n\t\t\t\twidgetWidth: 0,\n\t\t\t\tshowConsent: false,\n\t\t\t\tconsentUrl: '',\n\t\t\t\tdialogStart: false,\n\t\t\t\twatchTyping: false,\n\t\t\t\tshowSessionId: false,\n\t\t\t\tisCreateSessionMode: false,\n\t\t\t\tcrmFormsSettings: {\n\t\t\t\t\tuseWelcomeForm: false,\n\t\t\t\t\twelcomeFormId: 0,\n\t\t\t\t\twelcomeFormSec: '',\n\t\t\t\t\twelcomeFormDelay: false,\n\t\t\t\t\twelcomeFormFilled: false,\n\t\t\t\t\tsuccessText: '',\n\t\t\t\t\terrorText: ''\n\t\t\t\t}\n\t\t\t},\n\t\t\tdialog:\n\t\t\t{\n\t\t\t\tsessionId: 0,\n\t\t\t\tsessionClose: true,\n\t\t\t\tsessionStatus: 0,\n\t\t\t\tuserVote: VoteType.none,\n\t\t\t\tcloseVote: false,\n\t\t\t\tuserConsent: false,\n\t\t\t\toperatorChatId: 0,\n\t\t\t\toperator: {\n\t\t\t\t\tid: 0,\n\t\t\t\t\tname: '',\n\t\t\t\t\tfirstName: '',\n\t\t\t\t\tlastName: '',\n\t\t\t\t\tworkPosition: '',\n\t\t\t\t\tavatar: '',\n\t\t\t\t\tonline: false,\n\t\t\t\t}\n\t\t\t},\n\t\t\tuser:\n\t\t\t{\n\t\t\t\tid: -1,\n\t\t\t\thash: '',\n\t\t\t\tname: '',\n\t\t\t\tfirstName: '',\n\t\t\t\tlastName: '',\n\t\t\t\tavatar: '',\n\t\t\t\temail: '',\n\t\t\t\tphone: '',\n\t\t\t\twww: '',\n\t\t\t\tgender: 'M',\n\t\t\t\tposition: '',\n\t\t\t},\n\t\t}\n\t}\n\n\tgetStateSaveException()\n\t{\n\t\treturn {\n\t\t\tcommon: {\n\t\t\t\thost: null,\n\t\t\t\tpageMode: null,\n\t\t\t\tcopyright: null,\n\t\t\t\tcopyrightUrl: null,\n\t\t\t\tstyles: null,\n\t\t\t\tdragged: null,\n\t\t\t\tshowed: null,\n\t\t\t\tshowConsent: null,\n\t\t\t\tshowForm: null,\n\t\t\t},\n\t\t}\n\t}\n\n\tgetMutations()\n\t{\n\t\treturn {\n\n\t\t\tcommon: (state, payload) =>\n\t\t\t{\n\t\t\t\tif (typeof payload.configId === 'number')\n\t\t\t\t{\n\t\t\t\t\tstate.common.configId = payload.configId;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.configName === 'string')\n\t\t\t\t{\n\t\t\t\t\tstate.common.configName = payload.configName;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.online === 'boolean')\n\t\t\t\t{\n\t\t\t\t\tstate.common.online = payload.online;\n\t\t\t\t}\n\t\t\t\tif (Utils.types.isPlainObject(payload.vote))\n\t\t\t\t{\n\t\t\t\t\tif (typeof payload.vote.enable === 'boolean')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.common.vote.enable = payload.vote.enable;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.vote.beforeFinish === 'boolean')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.common.vote.beforeFinish = payload.vote.beforeFinish;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.vote.messageText === 'string')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.common.vote.messageText = payload.vote.messageText;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.vote.messageLike === 'string')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.common.vote.messageLike = payload.vote.messageLike;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.vote.messageDislike === 'string')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.common.vote.messageDislike = payload.vote.messageDislike;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (Utils.types.isPlainObject(payload.textMessages))\n\t\t\t\t{\n\t\t\t\t\tif (typeof payload.textMessages.bxLivechatOnlineLine1 === 'string' && payload.textMessages.bxLivechatOnlineLine1 !== '')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.common.textMessages.bxLivechatOnlineLine1 = payload.textMessages.bxLivechatOnlineLine1;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.textMessages.bxLivechatOnlineLine2 === 'string' && payload.textMessages.bxLivechatOnlineLine2 !== '')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.common.textMessages.bxLivechatOnlineLine2 = payload.textMessages.bxLivechatOnlineLine2;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.textMessages.bxLivechatOffline === 'string' && payload.textMessages.bxLivechatOffline !== '')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.common.textMessages.bxLivechatOffline = payload.textMessages.bxLivechatOffline;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.textMessages.bxLivechatTitle === 'string' && payload.textMessages.bxLivechatTitle !== '')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.common.textMessages.bxLivechatTitle = payload.textMessages.bxLivechatTitle;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (typeof payload.dragged === 'boolean')\n\t\t\t\t{\n\t\t\t\t\tstate.common.dragged = payload.dragged;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.textareaHeight === 'number')\n\t\t\t\t{\n\t\t\t\t\tstate.common.textareaHeight = payload.textareaHeight;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.widgetHeight === 'number')\n\t\t\t\t{\n\t\t\t\t\tstate.common.widgetHeight = payload.widgetHeight;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.widgetWidth === 'number')\n\t\t\t\t{\n\t\t\t\t\tstate.common.widgetWidth = payload.widgetWidth;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.showConsent === 'boolean')\n\t\t\t\t{\n\t\t\t\t\tstate.common.showConsent = payload.showConsent;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.consentUrl === 'string')\n\t\t\t\t{\n\t\t\t\t\tstate.common.consentUrl = payload.consentUrl;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.showed === 'boolean')\n\t\t\t\t{\n\t\t\t\t\tstate.common.showed = payload.showed;\n\t\t\t\t\tpayload.reopen = Utils.device.isMobile()? false: payload.showed;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.reopen === 'boolean')\n\t\t\t\t{\n\t\t\t\t\tstate.common.reopen = payload.reopen;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.copyright === 'boolean')\n\t\t\t\t{\n\t\t\t\t\tstate.common.copyright = payload.copyright;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.dialogStart === 'boolean')\n\t\t\t\t{\n\t\t\t\t\tstate.common.dialogStart = payload.dialogStart;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.watchTyping === 'boolean')\n\t\t\t\t{\n\t\t\t\t\tstate.common.watchTyping = payload.watchTyping;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.showSessionId === 'boolean')\n\t\t\t\t{\n\t\t\t\t\tstate.common.showSessionId = payload.showSessionId;\n\t\t\t\t}\n\t\t\t\tif (payload.operators instanceof Array)\n\t\t\t\t{\n\t\t\t\t\tstate.common.operators = payload.operators;\n\t\t\t\t}\n\t\t\t\tif (payload.connectors instanceof Array)\n\t\t\t\t{\n\t\t\t\t\tstate.common.connectors = payload.connectors;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.showForm === 'string' && typeof FormType[payload.showForm] !== 'undefined')\n\t\t\t\t{\n\t\t\t\t\tif (payload.showForm === FormType.like && !!state.dialog.closeVote)\n\t\t\t\t\t{\n\t\t\t\t\t\tpayload.showForm = FormType.none;\n\t\t\t\t\t}\n\t\t\t\t\tstate.common.showForm = payload.showForm;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.location === 'number' && typeof LocationStyle[payload.location] !== 'undefined')\n\t\t\t\t{\n\t\t\t\t\tif (state.common.location !== payload.location)\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.common.widgetHeight = 0;\n\t\t\t\t\t\tstate.common.widgetWidth = 0;\n\t\t\t\t\t\tstate.common.location = payload.location;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (Utils.types.isPlainObject(payload.crmFormsSettings))\n\t\t\t\t{\n\t\t\t\t\tif (typeof payload.crmFormsSettings.useWelcomeForm === 'string')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.common.crmFormsSettings.useWelcomeForm = payload.crmFormsSettings.useWelcomeForm === 'Y';\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.crmFormsSettings.welcomeFormId === 'string')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.common.crmFormsSettings.welcomeFormId = payload.crmFormsSettings.welcomeFormId;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.crmFormsSettings.welcomeFormSec === 'string')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.common.crmFormsSettings.welcomeFormSec = payload.crmFormsSettings.welcomeFormSec;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.crmFormsSettings.welcomeFormDelay === 'string')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.common.crmFormsSettings.welcomeFormDelay = payload.crmFormsSettings.welcomeFormDelay === 'Y';\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.crmFormsSettings.successText === 'string' && payload.crmFormsSettings.successText !== '')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.common.crmFormsSettings.successText = payload.crmFormsSettings.successText;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.crmFormsSettings.errorText === 'string' && payload.crmFormsSettings.errorText !== '')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.common.crmFormsSettings.errorText = payload.crmFormsSettings.errorText;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (typeof payload.isCreateSessionMode === 'boolean')\n\t\t\t\t{\n\t\t\t\t\tstate.common.isCreateSessionMode = payload.isCreateSessionMode;\n\t\t\t\t}\n\n\t\t\t\tif (this.isSaveNeeded({common: payload}))\n\t\t\t\t{\n\t\t\t\t\tthis.saveState(state);\n\t\t\t\t}\n\t\t\t},\n\t\t\tdialog: (state, payload) =>\n\t\t\t{\n\t\t\t\tif (typeof payload.sessionId === 'number')\n\t\t\t\t{\n\t\t\t\t\tstate.dialog.sessionId = payload.sessionId;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.sessionClose === 'boolean')\n\t\t\t\t{\n\t\t\t\t\tstate.dialog.sessionClose = payload.sessionClose;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.sessionStatus === 'number')\n\t\t\t\t{\n\t\t\t\t\tstate.dialog.sessionStatus = payload.sessionStatus;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.userConsent === 'boolean')\n\t\t\t\t{\n\t\t\t\t\tstate.dialog.userConsent = payload.userConsent;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.userVote === 'string' && typeof payload.userVote !== 'undefined')\n\t\t\t\t{\n\t\t\t\t\tstate.dialog.userVote = payload.userVote;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.closeVote === 'boolean')\n\t\t\t\t{\n\t\t\t\t\tstate.dialog.closeVote = payload.closeVote;\n\n\t\t\t\t\tif (\n\t\t\t\t\t\t!!payload.closeVote\n\t\t\t\t\t\t&& state.common.showForm === FormType.like\n\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.common.showForm = FormType.none;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (typeof payload.operatorChatId === 'number')\n\t\t\t\t{\n\t\t\t\t\tstate.dialog.operatorChatId = payload.operatorChatId;\n\t\t\t\t}\n\t\t\t\tif (Utils.types.isPlainObject(payload.operator))\n\t\t\t\t{\n\t\t\t\t\tif (typeof payload.operator.id === 'number')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.dialog.operator.id = payload.operator.id;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.operator.name === 'string' || typeof payload.operator.name === 'number')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.dialog.operator.name = payload.operator.name.toString();\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.operator.lastName === 'string' || typeof payload.operator.lastName === 'number')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.dialog.operator.lastName = payload.operator.lastName.toString();\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.operator.firstName === 'string' || typeof payload.operator.firstName === 'number')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.dialog.operator.firstName = payload.operator.firstName.toString();\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.operator.workPosition === 'string' || typeof payload.operator.workPosition === 'number')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.dialog.operator.workPosition = payload.operator.workPosition.toString();\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.operator.avatar === 'string')\n\t\t\t\t\t{\n\t\t\t\t\t\tif (!payload.operator.avatar || payload.operator.avatar.startsWith('http'))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tstate.dialog.operator.avatar = payload.operator.avatar;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tstate.dialog.operator.avatar = state.common.host+payload.operator.avatar;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.operator.online === 'boolean')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.dialog.operator.online = payload.operator.online;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (this.isSaveNeeded({dialog: payload}))\n\t\t\t\t{\n\t\t\t\t\tthis.saveState(state);\n\t\t\t\t}\n\t\t\t},\n\t\t\tuser: (state, payload) =>\n\t\t\t{\n\t\t\t\tif (typeof payload.id === 'number')\n\t\t\t\t{\n\t\t\t\t\tstate.user.id = payload.id;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.hash === 'string' && payload.hash !== state.user.hash)\n\t\t\t\t{\n\t\t\t\t\tstate.user.hash = payload.hash;\n\t\t\t\t\tCookie.set(null, 'LIVECHAT_HASH', payload.hash, {expires: 365*86400, path: '/'});\n\t\t\t\t}\n\t\t\t\tif (typeof payload.name === 'string' || typeof payload.name === 'number')\n\t\t\t\t{\n\t\t\t\t\tstate.user.name = payload.name.toString();\n\t\t\t\t}\n\t\t\t\tif (typeof payload.firstName === 'string' || typeof payload.firstName === 'number')\n\t\t\t\t{\n\t\t\t\t\tstate.user.firstName = payload.firstName.toString();\n\t\t\t\t}\n\t\t\t\tif (typeof payload.lastName === 'string' || typeof payload.lastName === 'number')\n\t\t\t\t{\n\t\t\t\t\tstate.user.lastName = payload.lastName.toString();\n\t\t\t\t}\n\t\t\t\tif (typeof payload.avatar === 'string')\n\t\t\t\t{\n\t\t\t\t\tstate.user.avatar = payload.avatar;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.email === 'string')\n\t\t\t\t{\n\t\t\t\t\tstate.user.email = payload.email;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.phone === 'string' || typeof payload.phone === 'number')\n\t\t\t\t{\n\t\t\t\t\tstate.user.phone = payload.phone.toString();\n\t\t\t\t}\n\t\t\t\tif (typeof payload.www === 'string')\n\t\t\t\t{\n\t\t\t\t\tstate.user.www = payload.www;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.gender === 'string')\n\t\t\t\t{\n\t\t\t\t\tstate.user.gender = payload.gender;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.position === 'string')\n\t\t\t\t{\n\t\t\t\t\tstate.user.position = payload.position;\n\t\t\t\t}\n\n\t\t\t\tif (this.isSaveNeeded({user: payload}))\n\t\t\t\t{\n\t\t\t\t\tthis.saveState(state);\n\t\t\t\t}\n\t\t\t},\n\t\t}\n\t}\n\n\tgetActions()\n\t{\n\t\treturn {\n\t\t\tshow: ({ commit }) =>\n\t\t\t{\n\t\t\t\tcommit('common', {showed: true});\n\t\t\t},\n\t\t\tsetVoteDateFinish: ({ commit, dispatch, state }, payload) =>\n\t\t\t{\n\t\t\t\tif (!payload)\n\t\t\t\t{\n\t\t\t\t\tclearTimeout(this.setVoteDateTimeout);\n\t\t\t\t\tcommit('dialog', {closeVote: false});\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\tconst totalDelay = new Date(payload).getTime() - new Date().getTime();\n\t\t\t\tconst dayTimestamp = 10000;\n\t\t\t\tclearTimeout(this.setVoteDateTimeout);\n\n\t\t\t\tif (payload)\n\t\t\t\t{\n\t\t\t\t\tif (totalDelay && !state.dialog.closeVote)\n\t\t\t\t\t{\n\t\t\t\t\t\tcommit('dialog', {closeVote: false});\n\t\t\t\t\t}\n\n\t\t\t\t\tvar delay = totalDelay;\n\n\t\t\t\t\tif(totalDelay > dayTimestamp)\n\t\t\t\t\t{\n\t\t\t\t\t\tdelay = dayTimestamp;\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.setVoteDateTimeout = setTimeout(function requestCloseVote() {\n\t\t\t\t\t\tdelay = new Date(payload).getTime() - new Date().getTime();\n\t\t\t\t\t\tif(delay > 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif(delay > dayTimestamp)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tdelay = dayTimestamp;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tsetTimeout(requestCloseVote, delay);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcommit('dialog', {closeVote: true});\n\t\t\t\t\t\t}\n\t\t\t\t\t}, delay);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}","/**\n * Bitrix OpenLines widget\n * Rest client (base on BX.RestClient)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\n// TODO change BX.RestClient, BX.promise to import\n\nimport {Utils} from \"im.lib.utils\";\nimport {RestAuth, RestMethod} from \"../const\";\nimport {RestClient} from \"rest.client\";\n\nexport class WidgetRestClient\n{\n\tconstructor(params)\n\t{\n\t\tthis.queryAuthRestore = false;\n\n\t\tthis.setAuthId(RestAuth.guest);\n\n\t\tthis.restClient = new RestClient({\n\t\t\tendpoint: params.endpoint,\n\t\t\tqueryParams: this.queryParams,\n\t\t\tcors: true\n\t\t});\n\t}\n\n\tsetAuthId(authId, customAuthId = '')\n\t{\n\t\tif (typeof this.queryParams !== 'object')\n\t\t{\n\t\t\tthis.queryParams = {};\n\t\t}\n\n\t\tif (\n\t\t\tauthId == RestAuth.guest\n\t\t\t|| typeof authId === 'string' && authId.match(/^[a-f0-9]{32}$/)\n\t\t)\n\t\t{\n\t\t\tthis.queryParams.livechat_auth_id = authId;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconsole.error(`%LiveChatRestClient.setAuthId: auth is not correct (%c${authId}%c)`, \"color: black;\", \"font-weight: bold; color: red\", \"color: black\");\n\t\t\treturn false;\n\t\t}\n\n\t\tif (\n\t\t\tauthId == RestAuth.guest\n\t\t\t&& typeof customAuthId === 'string' && customAuthId.match(/^[a-f0-9]{32}$/)\n\t\t)\n\t\t{\n\t\t\tthis.queryParams.livechat_custom_auth_id = customAuthId;\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tgetAuthId()\n\t{\n\t\tif (typeof this.queryParams !== 'object')\n\t\t{\n\t\t\tthis.queryParams = {};\n\t\t}\n\n\t\treturn this.queryParams.livechat_auth_id || null;\n\t}\n\n\tcallMethod(method, params, callback, sendCallback, logTag = null)\n\t{\n\t\tif (!logTag)\n\t\t{\n\t\t\tlogTag = Utils.getLogTrackingParams({\n\t\t\t\tname: method,\n\t\t\t});\n\t\t}\n\n\t\tconst promise = new BX.Promise();\n\n\t\t// TODO: Callbacks methods will not work!\n\t\tthis.restClient.callMethod(method, params, null, sendCallback, logTag).then(result => {\n\n\t\t\tthis.queryAuthRestore = false;\n\t\t\tpromise.fulfill(result);\n\n\t\t}).catch(result => {\n\n\t\t\tlet error = result.error();\n\t\t\tif (error.ex.error == 'LIVECHAT_AUTH_WIDGET_USER')\n\t\t\t{\n\t\t\t\tthis.setAuthId(error.ex.hash);\n\n\t\t\t\tif (method === RestMethod.widgetUserRegister)\n\t\t\t\t{\n\t\t\t\t\tconsole.warn(`BX.LiveChatRestClient: ${error.ex.error_description} (${error.ex.error})`);\n\n\t\t\t\t\tthis.queryAuthRestore = false;\n\t\t\t\t\tpromise.reject(result);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tif (!this.queryAuthRestore)\n\t\t\t\t{\n\t\t\t\t\tconsole.warn('BX.LiveChatRestClient: your auth-token has expired, send query with a new token');\n\n\t\t\t\t\tthis.queryAuthRestore = true;\n\t\t\t\t\tthis.restClient.callMethod(method, params, null, sendCallback, logTag).then(result => {\n\t\t\t\t\t\tthis.queryAuthRestore = false;\n\t\t\t\t\t\tpromise.fulfill(result);\n\t\t\t\t\t}).catch(result => {\n\t\t\t\t\t\tthis.queryAuthRestore = false;\n\t\t\t\t\t\tpromise.reject(result);\n\t\t\t\t\t});\n\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.queryAuthRestore = false;\n\t\t\tpromise.reject(result);\n\t\t});\n\n\t\treturn promise;\n\t};\n\n\tcallBatch(calls, callback, bHaltOnError, sendCallback, logTag)\n\t{\n\t\tlet resultCallback = (result) =>\n\t\t{\n\t\t\tlet error = null;\n\t\t\tfor (let method in calls)\n\t\t\t{\n\t\t\t\tif (!calls.hasOwnProperty(method))\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tlet error = result[method].error();\n\t\t\t\tif (error && error.ex.error == 'LIVECHAT_AUTH_WIDGET_USER')\n\t\t\t\t{\n\t\t\t\t\tthis.setAuthId(error.ex.hash);\n\t\t\t\t\tif (method === RestMethod.widgetUserRegister)\n\t\t\t\t\t{\n\t\t\t\t\t\tconsole.warn(`BX.LiveChatRestClient: ${error.ex.error_description} (${error.ex.error})`);\n\n\t\t\t\t\t\tthis.queryAuthRestore = false;\n\t\t\t\t\t\tcallback(result);\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!this.queryAuthRestore)\n\t\t\t\t\t{\n\t\t\t\t\t\tconsole.warn('BX.LiveChatRestClient: your auth-token has expired, send query with a new token');\n\n\t\t\t\t\t\tthis.queryAuthRestore = true;\n\t\t\t\t\t\tthis.restClient.callBatch(calls, callback, bHaltOnError, sendCallback, logTag);\n\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.queryAuthRestore = false;\n\t\t\tcallback(result);\n\n\t\t\treturn true;\n\t\t};\n\n\t\treturn this.restClient.callBatch(calls, resultCallback, bHaltOnError, sendCallback, logTag);\n\t};\n}","/**\n * Bitrix OpenLines widget\n * Widget Rest answers (Rest Answer Handler)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {BaseRestHandler} from \"im.provider.rest\";\nimport {LocalStorage} from \"im.lib.localstorage\";\nimport {SubscriptionType} from \"./const\";\n\nclass WidgetRestAnswerHandler extends BaseRestHandler\n{\n\tconstructor(props = {})\n\t{\n\t\tsuper(props);\n\n\t\tthis.widget = props.widget;\n\t}\n\n\thandleImopenlinesWidgetConfigGetSuccess(data)\n\t{\n\t\tthis.store.commit('widget/common', {\n\t\t\tconfigId: data.configId,\n\t\t\tconfigName: data.configName,\n\t\t\tvote: data.vote,\n\t\t\ttextMessages: data.textMessages,\n\t\t\toperators: data.operators || [],\n\t\t\tonline: data.online,\n\t\t\tconsentUrl: data.consentUrl,\n\t\t\tconnectors: data.connectors || [],\n\t\t\twatchTyping: data.watchTyping,\n\t\t\tshowSessionId: data.showSessionId,\n\t\t\tcrmFormsSettings: data.crmFormsSettings\n\t\t});\n\n\t\tthis.store.commit('application/set', {disk: data.disk});\n\n\t\tthis.widget.addLocalize(data.serverVariables);\n\t\tLocalStorage.set(this.widget.getSiteId(), 0, 'serverVariables', data.serverVariables || {});\n\t}\n\n\thandleImopenlinesWidgetUserRegisterSuccess(data)\n\t{\n\t\tthis.widget.restClient.setAuthId(data.hash);\n\n\t\tlet previousData = [];\n\t\tif (typeof this.store.state.messages.collection[this.controller.application.getChatId()] !== 'undefined')\n\t\t{\n\t\t\tpreviousData = this.store.state.messages.collection[this.controller.application.getChatId()];\n\t\t}\n\t\tthis.store.commit('messages/initCollection', {chatId: data.chatId, messages: previousData});\n\n\t\tthis.store.commit('dialogues/initCollection', {dialogId: data.dialogId, fields: {\n\t\t\tentityType: 'LIVECHAT',\n\t\t\ttype: 'livechat'\n\t\t}});\n\n\t\tthis.store.commit('application/set', {dialog: {\n\t\t\tchatId: data.chatId,\n\t\t\tdialogId: 'chat'+data.chatId\n\t\t}});\n\t}\n\n\thandleImopenlinesWidgetChatCreateSuccess(data)\n\t{\n\t\tthis.widget.restClient.setAuthId(data.hash);\n\n\t\tthis.store.commit('messages/initCollection', {chatId: data.chatId, messages: []});\n\t\tthis.store.commit('dialogues/initCollection', {\n\t\t\tdialogId: data.dialogId, fields: {\n\t\t\t\tentityType: 'LIVECHAT',\n\t\t\t\ttype: 'livechat'\n\t\t\t}\n\t\t});\n\n\t\tthis.store.commit('application/set', {\n\t\t\tdialog: {\n\t\t\t\tchatId: data.chatId,\n\t\t\t\tdialogId: 'chat' + data.chatId\n\t\t\t}\n\t\t});\n\t}\n\n\thandleImopenlinesWidgetUserGetSuccess(data)\n\t{\n\t\tthis.store.commit('widget/user', {\n\t\t\tid: data.id,\n\t\t\thash: data.hash,\n\t\t\tname: data.name,\n\t\t\tfirstName: data.firstName,\n\t\t\tlastName: data.lastName,\n\t\t\tphone: data.phone,\n\t\t\tavatar: data.avatar,\n\t\t\temail: data.email,\n\t\t\twww: data.www,\n\t\t\tgender: data.gender,\n\t\t\tposition: data.position,\n\t\t});\n\t\tthis.store.dispatch('users/set', [{\n\t\t\tid: data.id,\n\t\t\tname: data.name,\n\t\t\tfirstName: data.firstName,\n\t\t\tlastName: data.lastName,\n\t\t\tavatar: data.avatar,\n\t\t\tgender: data.gender,\n\t\t\tworkPosition: data.position,\n\t\t}]);\n\t\tthis.store.commit('application/set', {common: {\n\t\t\tuserId: data.id\n\t\t}});\n\t}\n\n\thandleImopenlinesWidgetDialogGetSuccess(data)\n\t{\n\t\tthis.store.commit('messages/initCollection', {chatId: data.chatId});\n\n\t\tthis.store.commit('widget/dialog', data);\n\n\t\tthis.store.commit('application/set', {dialog: {\n\t\t\tchatId: data.chatId,\n\t\t\tdialogId: 'chat'+data.chatId,\n\t\t\tdiskFolderId: data.diskFolderId,\n\t\t}});\n\n\t\tthis.store.dispatch('widget/setVoteDateFinish', data.dateCloseVote);\n\t}\n\n\thandleImDialogMessagesGetInitSuccess(data)\n\t{\n\t\tthis.handleImDialogMessagesGetSuccess(data);\n\t}\n\n\thandleImDialogMessagesGetSuccess(data)\n\t{\n\t\tif (data.messages && data.messages.length > 0 && !this.widget.isDialogStart())\n\t\t{\n\t\t\tthis.store.commit('widget/common', {\n\t\t\t\tdialogStart: true\n\t\t\t});\n\t\t\tthis.store.commit('widget/dialog', {\n\t\t\t\tuserConsent: true\n\t\t\t});\n\t\t}\n\t}\n\n\thandleImMessageAddSuccess(messageId, message)\n\t{\n\t\tthis.widget.sendEvent({\n\t\t\ttype: SubscriptionType.userMessage,\n\t\t\tdata: {\n\t\t\t\tid: messageId,\n\t\t\t\ttext: message.text\n\t\t\t}\n\t\t});\n\t}\n\n\thandleImDiskFileCommitSuccess(result, message)\n\t{\n\t\tthis.widget.sendEvent({\n\t\t\ttype: SubscriptionType.userFile,\n\t\t\tdata: {}\n\t\t});\n\t}\n}\n\nexport {WidgetRestAnswerHandler};","/**\n * Bitrix OpenLines widget\n * Widget pull commands (Pull Command Handler)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {SubscriptionType, VoteType} from \"./const\";\n\nclass WidgetImPullCommandHandler\n{\n\tstatic create(params = {})\n\t{\n\t\treturn new this(params);\n\t}\n\n\tgetModuleId()\n\t{\n\t\treturn 'im';\n\t}\n\n\tconstructor(params)\n\t{\n\t\tthis.controller = params.controller;\n\t\tthis.store = params.store;\n\t\tthis.widget = params.widget;\n\t}\n\n\thandleMessageChat(params, extra, command)\n\t{\n\t\tif (params.message.senderId != this.controller.application.getUserId())\n\t\t{\n\t\t\tthis.widget.sendEvent({\n\t\t\t\ttype: SubscriptionType.operatorMessage,\n\t\t\t\tdata: params\n\t\t\t});\n\n\t\t\tif (!this.store.state.widget.common.showed && !this.widget.onceShowed)\n\t\t\t{\n\t\t\t\tthis.widget.onceShowed = true;\n\t\t\t\tthis.widget.open();\n\t\t\t}\n\t\t}\n\t}\n}\n\nclass WidgetImopenlinesPullCommandHandler\n{\n\tstatic create(params = {})\n\t{\n\t\treturn new this(params);\n\t}\n\n\tconstructor(params = {})\n\t{\n\t\tthis.controller = params.controller;\n\t\tthis.store = params.store;\n\t\tthis.widget = params.widget;\n\t}\n\n\tgetModuleId()\n\t{\n\t\treturn 'imopenlines';\n\t}\n\n\thandleSessionStart(params, extra, command)\n\t{\n\t\tthis.store.commit('widget/dialog', {\n\t\t\tsessionId: params.sessionId,\n\t\t\tsessionClose: false,\n\t\t\tsessionStatus: 0,\n\t\t\tuserVote: VoteType.none,\n\t\t});\n\n\t\tthis.store.dispatch('widget/setVoteDateFinish', '');\n\n\t\tthis.widget.sendEvent({\n\t\t\ttype: SubscriptionType.sessionStart,\n\t\t\tdata: {\n\t\t\t\tsessionId: params.sessionId\n\t\t\t}\n\t\t});\n\t}\n\n\thandleSessionOperatorChange(params, extra, command)\n\t{\n\t\tthis.store.commit('widget/dialog', {\n\t\t\toperator: params.operator,\n\t\t\toperatorChatId: params.operatorChatId\n\t\t});\n\n\t\tthis.widget.sendEvent({\n\t\t\ttype: SubscriptionType.sessionOperatorChange,\n\t\t\tdata: {\n\t\t\t\toperator: params.operator\n\t\t\t}\n\t\t});\n\t}\n\n\thandleSessionStatus(params, extra, command)\n\t{\n\t\tthis.store.commit('widget/dialog', {\n\t\t\tsessionId: params.sessionId,\n\t\t\tsessionStatus: params.sessionStatus,\n\t\t\tsessionClose: params.sessionClose,\n\t\t});\n\n\t\tthis.widget.sendEvent({\n\t\t\ttype: SubscriptionType.sessionStatus,\n\t\t\tdata: {\n\t\t\t\tsessionId: params.sessionId,\n\t\t\t\tsessionStatus: params.sessionStatus\n\t\t\t}\n\t\t});\n\n\t\tif (params.sessionClose)\n\t\t{\n\t\t\tthis.widget.sendEvent({\n\t\t\t\ttype: SubscriptionType.sessionFinish,\n\t\t\t\tdata: {\n\t\t\t\t\tsessionId: params.sessionId,\n\t\t\t\t\tsessionStatus: params.sessionStatus\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (!params.spam)\n\t\t\t{\n\t\t\t\tthis.store.commit('widget/dialog', {\n\t\t\t\t\toperator: {\n\t\t\t\t\t\tname: '',\n\t\t\t\t\t\tfirstName: '',\n\t\t\t\t\t\tlastName: '',\n\t\t\t\t\t\tworkPosition: '',\n\t\t\t\t\t\tavatar: '',\n\t\t\t\t\t\tonline: false,\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\thandleSessionDateCloseVote(params, extra, command)\n\t{\n\t\tthis.store.dispatch('widget/setVoteDateFinish', params.dateCloseVote);\n\t}\n}\n\nexport {\n\tWidgetImPullCommandHandler,\n\tWidgetImopenlinesPullCommandHandler,\n};","/**\n * Bitrix OpenLines widget\n * Widget private interface (base class)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2020 Bitrix\n */\n\n// widget files\nimport {\n\tLocationStyle,\n\tSubscriptionType,\n\tSubscriptionTypeCheck,\n\tRestMethod,\n\tRestAuth,\n\tWidgetEventType\n} from \"./const\";\n\nimport {WidgetModel} from \"./model\";\nimport {WidgetRestClient} from \"./utils/restclient\";\nimport {WidgetRestAnswerHandler} from \"./rest.handler\";\nimport {WidgetImPullCommandHandler, WidgetImopenlinesPullCommandHandler} from \"./pull.handler\";\n\n// main\nimport {md5} from \"main.md5\";\nimport \"main.date\";\n\n// pull\nimport {PullClient} from \"pull.client\";\n\n// ui\nimport {Vue} from \"ui.vue\";\nimport {VuexBuilder} from \"ui.vue.vuex\";\nimport 'ui.vue.components.crm.form';\n\n// messenger files\nimport {Controller} from 'im.controller';\nimport {\n\tRestMethod as ImRestMethod,\n\tRestMethodHandler as ImRestMethodHandler,\n\tEventType\n} from 'im.const';\n\nimport {Cookie} from \"im.lib.cookie\";\nimport {Utils} from \"im.lib.utils\";\nimport {LocalStorage} from \"im.lib.localstorage\";\nimport {Logger} from \"im.lib.logger\";\n\nimport { EventEmitter } from \"main.core.events\";\nimport { ZIndexManager } from \"main.core.minimal\";\n\nexport class Widget\n{\n/* region 01. Initialize and store data */\n\tparams: Object = null;\n\ttemplate: Object = null; // Vue instance\n\trootNode: Object = null;\n\n\trestClient: Object = null;\n\tpullClient: Object = null;\n\n\tready: boolean = true; // true if there are no initialization errors\n\tinited: boolean = false; // true if all preparations are done\n\toffline: boolean = false; // true if Pull-client is offline\n\twidgetConfigRequest: Object = null; // XHR-request from widget.config.get, can be aborted before completion\n\n\t// this block can be set from public config\n\tuserRegisterData: Object = {}; // user info\n\tcustomData: Array = []; // additional info to send to server\n\toptions: Object = { checkSameDomain: true };\n\tsubscribers: Object = {}; // external event subscribers\n\n\t// fields from params\n\tcode: string = ''; // livechat code\n\thost: string = '';\n\tlanguage: string = '';\n\tcopyright: boolean = true;\n\tcopyrightUrl: string = '';\n\tbuttonInstance: Object = null; // widget button\n\tlocalize: Object = null;\n\tpageMode: Object = null; // fullscreen livechat mode options\n\n\tconstructor(params = {})\n\t{\n\t\tthis.params = params;\n\n\t\t//TODO: remove\n\t\tthis.messagesQueue = [];\n\n\t\tEventEmitter.subscribe(WidgetEventType.requestData, this.requestData.bind(this));\n\t\tEventEmitter.subscribe(WidgetEventType.createSession, this.createChat.bind(this));\n\t\tEventEmitter.subscribe(WidgetEventType.openSession, this.openSession.bind(this));\n\n\t\tthis.initParams();\n\t\tthis.initRestClient();\n\t\tthis.initPullClient();\n\t\tthis.initCore().then(() => {\n\t\t\tthis.initWidget();\n\t\t\tthis.initComplete();\n\t\t});\n\t}\n\n\tinitParams()\n\t{\n\t\tthis.rootNode = this.params.node || document.createElement('div');\n\n\t\tthis.code = this.params.code || '';\n\t\tthis.host = this.params.host || '';\n\t\tthis.language = this.params.language || 'en';\n\t\tthis.copyright = this.params.copyright !== false;\n\t\tthis.copyrightUrl = (this.copyright && this.params.copyrightUrl) ? this.params.copyrightUrl: '';\n\t\tif (this.params.buttonInstance && typeof this.params.buttonInstance === 'object')\n\t\t{\n\t\t\tthis.buttonInstance = this.params.buttonInstance;\n\t\t}\n\n\t\tif (this.params.pageMode && typeof this.params.pageMode === 'object')\n\t\t{\n\t\t\tthis.pageMode = {\n\t\t\t\tuseBitrixLocalize: this.params.pageMode.useBitrixLocalize === true,\n\t\t\t\tplaceholder: document.querySelector(`#${this.params.pageMode.placeholder}`)\n\t\t\t};\n\t\t}\n\n\t\tconst errors = this.checkRequiredFields();\n\t\tif (errors.length > 0)\n\t\t{\n\t\t\terrors.forEach(error => console.warn(error));\n\t\t\tthis.ready = false;\n\t\t}\n\n\t\tthis.setRootNode();\n\n\t\tthis.localize = this.pageMode && this.pageMode.useBitrixLocalize? window.BX.message: {};\n\t\tthis.setLocalize();\n\t}\n\n\tinitRestClient()\n\t{\n\t\tthis.restClient = new WidgetRestClient({endpoint: `${this.host}/rest`});\n\t}\n\n\tinitPullClient()\n\t{\n\t\tthis.pullClient = new PullClient({\n\t\t\tserverEnabled: true,\n\t\t\tuserId: 0,\n\t\t\tsiteId: this.getSiteId(),\n\t\t\trestClient: this.restClient,\n\t\t\tskipStorageInit: true,\n\t\t\tconfigTimestamp: 0,\n\t\t\tskipCheckRevision: true,\n\t\t\tgetPublicListMethod: 'imopenlines.widget.operator.get',\n\t\t});\n\t}\n\n\tinitCore()\n\t{\n\t\tthis.controller = new Controller({\n\t\t\thost: this.getHost(),\n\t\t\tsiteId: this.getSiteId(),\n\t\t\tuserId: 0,\n\t\t\tlanguageId: this.language,\n\t\t\tpull: {client: this.pullClient},\n\t\t\trest: {client: this.restClient},\n\t\t\tlocalize: this.localize,\n\t\t\tvuexBuilder: {\n\t\t\t\tdatabase: !Utils.browser.isIe(),\n\t\t\t\tdatabaseName: 'imol/widget',\n\t\t\t\tdatabaseType: VuexBuilder.DatabaseType.localStorage,\n\t\t\t\tmodels: [\n\t\t\t\t\tWidgetModel.create().setVariables(this.getWidgetVariables())\n\t\t\t\t],\n\t\t\t}\n\t\t});\n\n\t\treturn this.controller.ready();\n\t}\n\n\tinitWidget()\n\t{\n\t\tthis.restClient.setAuthId(this.getRestAuthId());\n\t\tthis.setModelData();\n\t\t// TODO: move from controller\n\t\tthis.controller.application.setPrepareFilesBeforeSaveFunction(this.prepareFileData.bind(this));\n\n\t\tthis.controller.addRestAnswerHandler(\n\t\t\tWidgetRestAnswerHandler.create({\n\t\t\t\twidget: this,\n\t\t\t\tstore: this.controller.getStore(),\n\t\t\t\tcontroller: this.controller,\n\t\t\t})\n\t\t);\n\t}\n\n\t// if start or open methods were called before core init - we will have appropriate flags\n\t// for full-page livechat we always call open\n\tinitComplete()\n\t{\n\t\twindow.dispatchEvent(new CustomEvent('onBitrixLiveChat', {detail: {\n\t\t\twidget: this,\n\t\t\twidgetCode: this.code,\n\t\t\twidgetHost: this.host,\n\t\t}}));\n\n\t\tif (this.callStartFlag)\n\t\t{\n\t\t\tthis.start();\n\t\t}\n\n\t\tif (this.pageMode || this.callOpenFlag)\n\t\t{\n\t\t\tthis.open();\n\t\t}\n\t}\n\n\t// public method\n\t// initially called from imopenlines/lib/livechatmanager.php:16\n\t// if core is not ready yet - set flag and call start once again in this.initComplete()\n\tstart()\n\t{\n\t\tif (!this.controller || !this.controller.getStore())\n\t\t{\n\t\t\tthis.callStartFlag = true;\n\t\t\treturn true;\n\t\t}\n\n\t\tif (this.isSessionActive())\n\t\t{\n\t\t\tthis.requestWidgetData();\n\t\t}\n\n\t\treturn true;\n\t}\n\n\t// public method\n\t// if core is not ready yet - set flag and call start once again in this.initComplete()\n\t// if not inited yet - request widget data\n\topen(params = {})\n\t{\n\t\tif (!this.controller.getStore())\n\t\t{\n\t\t\tthis.callOpenFlag = true;\n\t\t\treturn true;\n\t\t}\n\n\t\tif (!params.openFromButton && this.buttonInstance)\n\t\t{\n\t\t\tthis.buttonInstance.wm.showById('openline_livechat');\n\t\t}\n\n\t\tconst {error, stop} = this.checkForErrorsBeforeOpen();\n\t\tif (stop)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tif (!error && !this.inited)\n\t\t{\n\t\t\tthis.requestWidgetData();\n\t\t}\n\n\t\tthis.attachTemplate();\n\t}\n\n\trequestWidgetData()\n\t{\n\t\tif (!this.ready)\n\t\t{\n\t\t\tconsole.error('LiveChatWidget.start: widget code or host is not specified');\n\t\t\treturn false;\n\t\t}\n\n\t\t// if user is registered or we have its hash - proceed to getting chat and messages\n\t\tif (this.isUserReady() || this.isHashAvailable())\n\t\t{\n\t\t\tthis.requestData();\n\t\t\tthis.inited = true;\n\t\t\tthis.fireInitEvent();\n\n\t\t\treturn true;\n\t\t}\n\n\t\t// if there is no info about user - we need to get config and wait for first message\n\t\tthis.controller.restClient.callMethod(\n\t\t\tRestMethod.widgetConfigGet,\n\t\t\t{code: this.code},\n\t\t\t(xhr) => { this.widgetConfigRequest = xhr; }\n\t\t).then((result) => {\n\t\t\tthis.widgetConfigRequest = null;\n\t\t\tthis.clearError();\n\n\t\t\tthis.controller.executeRestAnswer(RestMethod.widgetConfigGet, result);\n\n\t\t\tif (!this.inited)\n\t\t\t{\n\t\t\t\tthis.inited = true;\n\t\t\t\tthis.fireInitEvent();\n\t\t\t}\n\t\t}).catch(error => {\n\t\t\tthis.widgetConfigRequest = null;\n\t\t\tthis.setError(error.error().ex.error, error.error().ex.error_description);\n\t\t});\n\n\t\tif (this.isConfigDataLoaded())\n\t\t{\n\t\t\tthis.inited = true;\n\t\t\tthis.fireInitEvent();\n\t\t}\n\t}\n\n\t// get all other info (dialog, chat, messages etc)\n\trequestData()\n\t{\n\t\tLogger.log('requesting data from widget');\n\t\tif (this.requestDataSend)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tthis.requestDataSend = true;\n\n\t\t// if there is uncompleted widget.config.get request - abort it (because we will do it anyway)\n\t\tif (this.widgetConfigRequest)\n\t\t{\n\t\t\tthis.widgetConfigRequest.abort();\n\t\t}\n\n\t\tconst callback = this.handleBatchRequestResult.bind(this);\n\t\tthis.controller.restClient.callBatch(\n\t\t\tthis.getDataRequestQuery(),\n\t\t\tcallback,\n\t\t\tfalse,\n\t\t\tfalse,\n\t\t\tUtils.getLogTrackingParams(\n\t\t\t\t{\n\t\t\t\t\tname: 'widget.init.config',\n\t\t\t\t\tdialog: this.controller.application.getDialogData()\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t}\n\n\tcreateChat()\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.controller.restClient.callBatch(\n\t\t\t\tthis.getCreateChatRequestQuery(),\n\t\t\t\t(result) => {\n\t\t\t\t\tthis.handleBatchCreateChatRequestResult(result).then(() => {\n\t\t\t\t\t\tresolve();\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tfalse,\n\t\t\t\tfalse,\n\t\t\t);\n\t\t});\n\t}\n\n\thandleBatchRequestResult(response)\n\t{\n\t\tif (!response)\n\t\t{\n\t\t\tthis.requestDataSend = false;\n\t\t\tthis.setError('EMPTY_RESPONSE', 'Server returned an empty response.');\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.handleConfigGet(response)\n\t\t\t.then(() => this.handleUserGet(response))\n\t\t\t.then(() => this.handleChatGet(response))\n\t\t\t.then(() => this.handleDialogGet(response))\n\t\t\t.then(() => this.handleDialogMessagesGet(response))\n\t\t\t.then(() => this.handleUserRegister(response))\n\t\t\t.then(() => this.handlePullRequests(response))\n\t\t\t.catch(({code, description}) => {\n\t\t\t\tthis.setError(code, description);\n\t\t\t})\n\t\t\t.finally(() => {\n\t\t\t\tthis.requestDataSend = false;\n\t\t\t});\n\t}\n\n\thandleBatchCreateChatRequestResult(response)\n\t{\n\t\tif (!response)\n\t\t{\n\t\t\tthis.requestDataSend = false;\n\t\t\tthis.setError('EMPTY_RESPONSE', 'Server returned an empty response.');\n\t\t\treturn false;\n\t\t}\n\n\t\treturn this.handleChatCreate(response)\n\t\t\t.then(() => this.handleChatGet(response))\n\t\t\t.then(() => this.handleDialogGet(response))\n\t\t\t.catch(({code, description}) => {\n\t\t\t\tthis.setError(code, description);\n\t\t\t})\n\t\t\t.finally(() => {\n\t\t\t\tthis.requestDataSend = false;\n\t\t\t});\n\t}\n\n\thandleBatchOpenSessionRequestResult(response)\n\t{\n\t\tif (!response)\n\t\t{\n\t\t\tthis.requestDataSend = false;\n\t\t\tthis.setError('EMPTY_RESPONSE', 'Server returned an empty response.');\n\t\t\treturn false;\n\t\t}\n\n\t\treturn this.handleChatGet(response)\n\t\t\t.then(() => this.handleDialogGet(response))\n\t\t\t.then(() => this.handleDialogMessagesGet(response))\n\t\t\t.catch(({code, description}) => {\n\t\t\t\tthis.setError(code, description);\n\t\t\t})\n\t\t\t.finally(() => {\n\t\t\t\tthis.requestDataSend = false;\n\t\t\t});\n\t}\n\n\tgetDataRequestQuery(): Object\n\t{\n\t\t// always widget.config.get\n\t\tconst query = {\n\t\t\t[RestMethod.widgetConfigGet]: [RestMethod.widgetConfigGet, {code: this.code}]\n\t\t};\n\n\t\tif (this.isUserRegistered())\n\t\t{\n\t\t\t// widget.dialog.get\n\t\t\tquery[RestMethod.widgetDialogGet] = [\n\t\t\t\tRestMethod.widgetDialogGet,\n\t\t\t\t{\n\t\t\t\t\tconfig_id: this.getConfigId(),\n\t\t\t\t\ttrace_data: this.getCrmTraceData(),\n\t\t\t\t\tcustom_data: this.getCustomData()\n\t\t\t\t}\n\t\t\t];\n\n\t\t\t// im.chat.get\n\t\t\tquery[ImRestMethodHandler.imChatGet] = [\n\t\t\t\tImRestMethod.imChatGet,\n\t\t\t\t{\n\t\t\t\t\tdialog_id: `$result[${RestMethod.widgetDialogGet}][dialogId]`\n\t\t\t\t}\n\t\t\t];\n\n\t\t\t// im.dialog.messages.get\n\t\t\tquery[ImRestMethodHandler.imDialogMessagesGetInit] = [\n\t\t\t\tImRestMethod.imDialogMessagesGet,\n\t\t\t\t{\n\t\t\t\t\tchat_id: `$result[${RestMethod.widgetDialogGet}][chatId]`,\n\t\t\t\t\tlimit: this.controller.application.getRequestMessageLimit(),\n\t\t\t\t\tconvert_text: 'Y'\n\t\t\t\t}\n\t\t\t];\n\t\t}\n\t\telse\n\t\t{\n\t\t\t// widget.user.register\n\t\t\tquery[RestMethod.widgetUserRegister] = [\n\t\t\t\tRestMethod.widgetUserRegister,\n\t\t\t\t{\n\t\t\t\t\tconfig_id: `$result[${RestMethod.widgetConfigGet}][configId]`,\n\t\t\t\t\t...this.getUserRegisterFields()\n\t\t\t\t}\n\t\t\t];\n\n\t\t\t// im.chat.get\n\t\t\tquery[ImRestMethodHandler.imChatGet] = [\n\t\t\t\tImRestMethod.imChatGet,\n\t\t\t\t{dialog_id: `$result[${RestMethod.widgetUserRegister}][dialogId]`}\n\t\t\t];\n\n\t\t\tif (this.userRegisterData.hash || this.getUserHashCookie())\n\t\t\t{\n\t\t\t\t// widget.dialog.get\n\t\t\t\tquery[RestMethod.widgetDialogGet] = [\n\t\t\t\t\tRestMethod.widgetDialogGet,\n\t\t\t\t\t{\n\t\t\t\t\t\tconfig_id: `$result[${RestMethod.widgetConfigGet}][configId]`,\n\t\t\t\t\t\ttrace_data: this.getCrmTraceData(),\n\t\t\t\t\t\tcustom_data: this.getCustomData()\n\t\t\t\t\t}\n\t\t\t\t];\n\n\t\t\t\t// im.dialog.messages.get\n\t\t\t\tquery[ImRestMethodHandler.imDialogMessagesGetInit] = [\n\t\t\t\t\tImRestMethod.imDialogMessagesGet,\n\t\t\t\t\t{\n\t\t\t\t\t\tchat_id: `$result[${RestMethod.widgetDialogGet}][chatId]`,\n\t\t\t\t\t\tlimit: this.controller.application.getRequestMessageLimit(),\n\t\t\t\t\t\tconvert_text: 'Y'\n\t\t\t\t\t}\n\t\t\t\t];\n\t\t\t}\n\n\t\t\tif (this.isUserAgreeConsent())\n\t\t\t{\n\t\t\t\t// widget.user.consent.apply\n\t\t\t\tquery[RestMethod.widgetUserConsentApply] = [\n\t\t\t\t\tRestMethod.widgetUserConsentApply,\n\t\t\t\t\t{\n\t\t\t\t\t\tconfig_id: `$result[${RestMethod.widgetConfigGet}][configId]`,\n\t\t\t\t\t\tconsent_url: location.href\n\t\t\t\t\t}\n\t\t\t\t];\n\t\t\t}\n\t\t}\n\n\t\tquery[RestMethod.pullServerTime] = [RestMethod.pullServerTime, {}];\n\t\tquery[RestMethod.pullConfigGet] = [RestMethod.pullConfigGet, {'CACHE': 'N'}];\n\t\tquery[RestMethod.widgetUserGet] = [RestMethod.widgetUserGet, {}];\n\n\t\treturn query;\n\t}\n\n\tgetOpenSessionQuery(chatId): Object\n\t{\n\t\t// imopenlines.widget.dialog.get\n\t\tconst query = {\n\t\t\t[RestMethod.widgetDialogGet]: [RestMethod.widgetDialogGet, {\n\t\t\t\tconfig_id: this.getConfigId(),\n\t\t\t\tchat_id: chatId\n\t\t\t}]\n\t\t};\n\n\t\tquery[ImRestMethodHandler.imChatGet] = [\n\t\t\tImRestMethod.imChatGet,\n\t\t\t{\n\t\t\t\tdialog_id: `chat${chatId}`\n\t\t\t}\n\t\t];\n\n\t\t// im.dialog.messages.get\n\t\tquery[ImRestMethodHandler.imDialogMessagesGetInit] = [\n\t\t\tImRestMethod.imDialogMessagesGet,\n\t\t\t{\n\t\t\t\tchat_id: chatId,\n\t\t\t\tlimit: 50,\n\t\t\t\tconvert_text: 'Y'\n\t\t\t}\n\t\t];\n\n\t\treturn query;\n\t}\n\n\tgetCreateChatRequestQuery(): Object\n\t{\n\t\tconst query = {};\n\n\t\t// widget.chat.register\n\t\tquery[RestMethod.widgetChatCreate] = [\n\t\t\tRestMethod.widgetChatCreate,\n\t\t\t{\n\t\t\t\tconfig_id: this.getConfigId(),\n\t\t\t\t...this.getUserRegisterFields()\n\t\t\t}\n\t\t];\n\n\t\t// im.chat.get\n\t\tquery[ImRestMethodHandler.imChatGet] = [\n\t\t\tImRestMethod.imChatGet,\n\t\t\t{dialog_id: `$result[${RestMethod.widgetChatCreate}][dialogId]`}\n\t\t];\n\n\t\t// widget.dialog.get\n\t\tquery[RestMethod.widgetDialogGet] = [\n\t\t\tRestMethod.widgetDialogGet,\n\t\t\t{\n\t\t\t\tconfig_id: this.getConfigId(),\n\t\t\t\ttrace_data: this.getCrmTraceData(),\n\t\t\t\tcustom_data: this.getCustomData()\n\t\t\t}\n\t\t];\n\n\t\tif (this.isUserAgreeConsent())\n\t\t{\n\t\t\t// widget.user.consent.apply\n\t\t\tquery[RestMethod.widgetUserConsentApply] = [\n\t\t\t\tRestMethod.widgetUserConsentApply,\n\t\t\t\t{\n\t\t\t\t\tconfig_id: this.getConfigId(),\n\t\t\t\t\tconsent_url: location.href\n\t\t\t\t}\n\t\t\t];\n\t\t}\n\n\t\tquery[RestMethod.pullServerTime] = [RestMethod.pullServerTime, {}];\n\t\tquery[RestMethod.pullConfigGet] = [RestMethod.pullConfigGet, {'CACHE': 'N'}];\n\t\tquery[RestMethod.widgetUserGet] = [RestMethod.widgetUserGet, {}];\n\n\t\treturn query;\n\t}\n\n\topenSession(event)\n\t{\n\t\tconst eventData = event.getData();\n\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tconst dialog = this.controller.getStore().getters['dialogues/get'](eventData.session.dialogId);\n\t\t\tif (dialog)\n\t\t\t{\n\t\t\t\tthis.controller.getStore().commit('application/set', {dialog: {\n\t\t\t\t\t\tchatId: eventData.session.chatId,\n\t\t\t\t\t\tdialogId: eventData.session.dialogId,\n\t\t\t\t\t\tdiskFolderId: 0,\n\t\t\t\t\t}});\n\n\t\t\t\tthis.controller.getStore().commit('widget/common', {isCreateSessionMode: false});\n\n\t\t\t\tresolve();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.controller.restClient.callBatch(\n\t\t\t\tthis.getOpenSessionQuery(eventData.session.chatId),\n\t\t\t\t(result) => {\n\t\t\t\t\tthis.handleBatchOpenSessionRequestResult(result).then(() => {\n\t\t\t\t\t\tthis.controller.getStore().commit('widget/common', {isCreateSessionMode: false});\n\t\t\t\t\t\tresolve();\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tfalse,\n\t\t\t\tfalse,\n\t\t\t);\n\t\t});\n\t}\n\n\tprepareFileData(files)\n\t{\n\t\tif (!Array.isArray(files))\n\t\t{\n\t\t\treturn files;\n\t\t}\n\n\t\treturn files.map(file =>\n\t\t{\n\t\t\tconst hash = (window.md5 || md5)(`${this.getUserId()}|${file.id}|${this.getUserHash()}`);\n\t\t\tconst urlParam = `livechat_auth_id=${hash}&livechat_user_id=${this.getUserId()}`;\n\t\t\tif (file.urlPreview)\n\t\t\t{\n\t\t\t\tfile.urlPreview = `${file.urlPreview}&${urlParam}`;\n\t\t\t}\n\t\t\tif (file.urlShow)\n\t\t\t{\n\t\t\t\tfile.urlShow = `${file.urlShow}&${urlParam}`;\n\t\t\t}\n\t\t\tif (file.urlDownload)\n\t\t\t{\n\t\t\t\tfile.urlDownload = `${file.urlDownload}&${urlParam}`;\n\t\t\t}\n\n\t\t\treturn file;\n\t\t});\n\t}\n\n\tcheckRequiredFields(): Array\n\t{\n\t\tconst errors = [];\n\t\tif (typeof this.code === 'string' && this.code.length <= 0)\n\t\t{\n\t\t\terrors.push(`LiveChatWidget.constructor: code is not correct (${this.code})`);\n\t\t}\n\n\t\tif (typeof this.host === 'string' && (this.host.length <= 0 || !this.host.startsWith('http')))\n\t\t{\n\t\t\terrors.push(`LiveChatWidget.constructor: host is not correct (${this.host})`);\n\t\t}\n\n\t\treturn errors;\n\t}\n\n\tsetRootNode()\n\t{\n\t\tif (this.pageMode && this.pageMode.placeholder)\n\t\t{\n\t\t\tthis.rootNode = this.pageMode.placeholder;\n\t\t}\n\t\telse if (document.body.firstChild)\n\t\t{\n\t\t\tdocument.body.insertBefore(this.rootNode, document.body.firstChild);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tdocument.body.append(this.rootNode);\n\t\t}\n\t}\n\n\tsetLocalize()\n\t{\n\t\tif (typeof this.params.localize === 'object')\n\t\t{\n\t\t\tthis.addLocalize(this.params.localize);\n\t\t}\n\n\t\tconst serverVariables = LocalStorage.get(this.getSiteId(), 0, 'serverVariables', false);\n\t\tif (serverVariables)\n\t\t{\n\t\t\tthis.addLocalize(serverVariables);\n\t\t}\n\t}\n\n\tgetWidgetVariables(): Object\n\t{\n\t\tconst variables = {\n\t\t\tcommon: {\n\t\t\t\thost: this.getHost(),\n\t\t\t\tpageMode: !!this.pageMode,\n\t\t\t\tcopyright: this.copyright,\n\t\t\t\tcopyrightUrl: this.copyrightUrl,\n\t\t\t},\n\t\t\tvote: {\n\t\t\t\tmessageText: this.getLocalize('BX_LIVECHAT_VOTE_TITLE'),\n\t\t\t\tmessageLike: this.getLocalize('BX_LIVECHAT_VOTE_PLUS_TITLE'),\n\t\t\t\tmessageDislike: this.getLocalize('BX_LIVECHAT_VOTE_MINUS_TITLE'),\n\t\t\t},\n\t\t\ttextMessages: {\n\t\t\t\tbxLivechatOnlineLine1: this.getLocalize('BX_LIVECHAT_ONLINE_LINE_1'),\n\t\t\t\tbxLivechatOnlineLine2: this.getLocalize('BX_LIVECHAT_ONLINE_LINE_2'),\n\t\t\t\tbxLivechatOffline: this.getLocalize('BX_LIVECHAT_OFFLINE'),\n\t\t\t}\n\t\t};\n\n\t\tif (this.params.styles)\n\t\t{\n\t\t\tvariables.styles = {};\n\t\t\tif (this.params.styles.backgroundColor)\n\t\t\t{\n\t\t\t\tvariables.styles.backgroundColor = this.params.styles.backgroundColor;\n\t\t\t}\n\t\t\tif (this.params.styles.iconColor)\n\t\t\t{\n\t\t\t\tvariables.styles.iconColor = this.params.styles.iconColor;\n\t\t\t}\n\t\t}\n\n\t\treturn variables;\n\t}\n\n\tgetRestAuthId()\n\t{\n\t\treturn this.isUserRegistered() ? this.getUserHash() : RestAuth.guest;\n\t}\n\n\tsetModelData()\n\t{\n\t\tif (this.params.location && LocationStyle[this.params.location])\n\t\t{\n\t\t\tthis.controller.getStore().commit('widget/common', {location: this.params.location});\n\t\t}\n\t}\n\n\tcheckForErrorsBeforeOpen()\n\t{\n\t\tconst result = {\n\t\t\terror: false,\n\t\t\tstop: false\n\t\t};\n\n\t\tif (!this.checkBrowserVersion())\n\t\t{\n\t\t\tthis.setError('OLD_BROWSER_LOCALIZED', this.localize.BX_LIVECHAT_OLD_BROWSER);\n\t\t\tresult.error = true;\n\t\t}\n\t\telse if (Utils.versionCompare(Vue.version(), '2.1') < 0)\n\t\t{\n\t\t\talert(this.localize.BX_LIVECHAT_OLD_VUE);\n\t\t\tconsole.error(`LiveChatWidget.error: OLD_VUE_VERSION (${this.localize.BX_LIVECHAT_OLD_VUE_DEV.replace('#CURRENT_VERSION#', Vue.version())})`);\n\t\t\tresult.error = true;\n\t\t\tresult.stop = true;\n\t\t}\n\t\telse if (this.isSameDomain())\n\t\t{\n\t\t\tthis.setError('LIVECHAT_SAME_DOMAIN', this.localize.BX_LIVECHAT_SAME_DOMAIN);\n\t\t\tresult.error = true;\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tisSameDomain()\n\t{\n\t\tif (typeof BX === 'undefined' || !BX.isReady)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tif (!this.options.checkSameDomain)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\treturn this.host.lastIndexOf(`.${location.hostname}`) > -1;\n\t}\n\n\tcheckBrowserVersion()\n\t{\n\t\tif (Utils.platform.isIos())\n\t\t{\n\t\t\tlet version = Utils.platform.getIosVersion();\n\t\t\tif (version && version <= 10)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\treturn true;\n\t}\n\n/* endregion 01. Initialize and store data */\n\n/* region 02. Push & Pull */\n\n\tstartPullClient(config): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tif (!this.getUserId() || !this.getSiteId() || !this.restClient)\n\t\t\t{\n\t\t\t\treturn reject({\n\t\t\t\t\tex: { error: 'WIDGET_NOT_LOADED', error_description: 'Widget is not loaded.'}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (this.pullClientInited)\n\t\t\t{\n\t\t\t\tif (!this.pullClient.isConnected())\n\t\t\t\t{\n\t\t\t\t\tthis.pullClient.scheduleReconnect();\n\t\t\t\t}\n\t\t\t\treturn resolve(true);\n\t\t\t}\n\n\t\t\tthis.controller.userId = this.getUserId();\n\t\t\tthis.pullClient.userId = this.getUserId();\n\t\t\tthis.pullClient.configTimestamp = config? config.server.config_timestamp: 0;\n\t\t\tthis.pullClient.skipStorageInit = false;\n\t\t\tthis.pullClient.storage = new PullClient.StorageManager({\n\t\t\t\tuserId: this.getUserId(),\n\t\t\t\tsiteId: this.getSiteId()\n\t\t\t});\n\n\t\t\tthis.pullClient.subscribe(\n\t\t\t\tnew WidgetImPullCommandHandler({\n\t\t\t\t\tstore: this.controller.getStore(),\n\t\t\t\t\tcontroller: this.controller,\n\t\t\t\t\twidget: this,\n\t\t\t\t})\n\t\t\t);\n\t\t\tthis.pullClient.subscribe(\n\t\t\t\tnew WidgetImopenlinesPullCommandHandler({\n\t\t\t\t\tstore: this.controller.getStore(),\n\t\t\t\t\tcontroller: this.controller,\n\t\t\t\t\twidget: this,\n\t\t\t\t})\n\t\t\t);\n\n\t\t\tthis.pullClient.subscribe({\n\t\t\t\ttype: PullClient.SubscriptionType.Status,\n\t\t\t\tcallback: this.eventStatusInteraction.bind(this)\n\t\t\t});\n\n\t\t\tthis.pullConnectedFirstTime = this.pullClient.subscribe({\n\t\t\t\ttype: PullClient.SubscriptionType.Status,\n\t\t\t\tcallback: (result) => {\n\t\t\t\t\tif (result.status === PullClient.PullStatus.Online)\n\t\t\t\t\t{\n\t\t\t\t\t\tresolve(true);\n\t\t\t\t\t\tthis.pullConnectedFirstTime();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (this.template)\n\t\t\t{\n\t\t\t\tthis.template.$Bitrix.PullClient.set(this.pullClient);\n\t\t\t}\n\n\t\t\tthis.pullClient.start({\n\t\t\t\t...config,\n\t\t\t\tskipReconnectToLastSession: true\n\t\t\t}).catch(() => {\n\t\t\t\treject({\n\t\t\t\t\tex: { error: 'PULL_CONNECTION_ERROR', error_description: 'Pull is not connected.'}\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tthis.pullClientInited = true;\n\t\t});\n\t}\n\n\tstopPullClient()\n\t{\n\t\tif (this.pullClient)\n\t\t{\n\t\t\tthis.pullClient.stop(PullClient.CloseReasons.MANUAL, 'Closed manually');\n\t\t}\n\t}\n\n\trecoverPullConnection()\n\t{\n\t\t// this.pullClient.session.mid = 0; // TODO specially for disable pull history, remove after recode im\n\t\tthis.pullClient.restart(PullClient.CloseReasons.MANUAL, 'Restart after click by connection status button.');\n\t}\n\n\teventStatusInteraction(data)\n\t{\n\t\tif (data.status === PullClient.PullStatus.Online)\n\t\t{\n\t\t\tthis.onPullOnlineStatus();\n\t\t}\n\t\telse if (data.status === PullClient.PullStatus.Offline)\n\t\t{\n\t\t\tthis.pullRequestMessage = true;\n\t\t\tthis.offline = true;\n\t\t}\n\t}\n\n\tonPullOnlineStatus()\n\t{\n\t\tthis.offline = false;\n\n\t\t// if we go online after going offline - we need to request messages\n\t\tif (this.pullRequestMessage)\n\t\t{\n\t\t\tthis.controller.pullBaseHandler.option.skip = true;\n\n\t\t\tLogger.warn('Requesting getDialogUnread after going online');\n\t\t\tEventEmitter.emitAsync(EventType.dialog.requestUnread, {chatId: this.controller.application.getChatId()}).then(() => {\n\t\t\t\t\tEventEmitter.emit(EventType.dialog.scrollOnStart, {chatId: this.controller.application.getChatId()});\n\t\t\t\t\tthis.controller.pullBaseHandler.option.skip = false;\n\t\t\t\t\tEventEmitter.emit(WidgetEventType.processMessagesToSendQueue);\n\t\t\t\t})\n\t\t\t\t.catch(() => {\n\t\t\t\t\tthis.controller.pullBaseHandler.option.skip = false;\n\t\t\t\t});\n\n\t\t\tthis.pullRequestMessage = false;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tEventEmitter.emit(EventType.dialog.readMessage);\n\t\t\tEventEmitter.emit(WidgetEventType.processMessagesToSendQueue);\n\t\t}\n\t}\n\n/* endregion 02. Push & Pull */\n\n/* region 03. Template engine */\n\n\tattachTemplate()\n\t{\n\t\tif (this.template)\n\t\t{\n\t\t\tthis.controller.getStore().commit('widget/common', {showed: true});\n\t\t\treturn true;\n\t\t}\n\n\t\tthis.rootNode.innerHTML = '';\n\t\tthis.rootNode.append(document.createElement('div'));\n\n\t\tconst application = this;\n\n\t\treturn this.controller.createVue(application, {\n\t\t\tel: this.rootNode.firstChild,\n\t\t\ttemplate: '<bx-livechat/>',\n\t\t\tbeforeCreate()\n\t\t\t{\n\t\t\t\tapplication.sendEvent({\n\t\t\t\t\ttype: SubscriptionType.widgetOpen,\n\t\t\t\t\tdata: {}\n\t\t\t\t});\n\t\t\t\tapplication.template = this;\n\n\t\t\t\tif (ZIndexManager !== undefined)\n\t\t\t\t{\n\t\t\t\t\tconst stack = ZIndexManager.getOrAddStack(document.body);\n\t\t\t\t\tstack.setBaseIndex(1000000); // some big value\n\t\t\t\t\tthis.$bitrix.Data.set('zIndexStack', stack);\n\t\t\t\t}\n\t\t\t},\n\t\t\tdestroyed()\n\t\t\t{\n\t\t\t\tapplication.sendEvent({\n\t\t\t\t\ttype: SubscriptionType.widgetClose,\n\t\t\t\t\tdata: {}\n\t\t\t\t});\n\t\t\t\tapplication.template = null;\n\t\t\t\tapplication.templateAttached = false;\n\t\t\t\tapplication.rootNode.innerHTML = '';\n\t\t\t}\n\t\t}).then(() => {\n\t\t\treturn new Promise((resolve, reject) => resolve());\n\t\t});\n\t}\n\n\tdetachTemplate()\n\t{\n\t\tif (!this.template)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tthis.template.$destroy();\n\n\t\treturn true;\n\t}\n\n\t// public method\n\tmutateTemplateComponent(id, params)\n\t{\n\t\treturn Vue.mutateComponent(id, params);\n\t}\n\n/* endregion 03. Template engine */\n\n/* region 04. Widget interaction and utils */\n\n\t// public method\n\tclose()\n\t{\n\t\tif (this.pageMode)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tif (this.buttonInstance)\n\t\t{\n\t\t\tthis.buttonInstance.onWidgetClose();\n\t\t}\n\n\t\tthis.detachTemplate();\n\t}\n\n\tfireInitEvent()\n\t{\n\t\tif (this.initEventFired)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tthis.sendEvent({\n\t\t\ttype: SubscriptionType.configLoaded,\n\t\t\tdata: {}\n\t\t});\n\n\t\tif (this.controller.getStore().state.widget.common.reopen)\n\t\t{\n\t\t\tthis.open();\n\t\t}\n\n\t\tthis.initEventFired = true;\n\t}\n\n\tisUserRegistered()\n\t{\n\t\treturn !!this.getUserHash();\n\t}\n\n\tisConfigDataLoaded()\n\t{\n\t\treturn this.controller.getStore().state.widget.common.configId;\n\t}\n\n\tisChatLoaded()\n\t{\n\t\treturn this.controller.getStore().state.application.dialog.chatId > 0;\n\t}\n\n\tisSessionActive()\n\t{\n\t\treturn !this.controller.getStore().state.widget.dialog.sessionClose;\n\t}\n\n\tisUserAgreeConsent()\n\t{\n\t\treturn this.controller.getStore().state.widget.dialog.userConsent;\n\t}\n\n\tgetCrmTraceData()\n\t{\n\t\tlet traceData = '';\n\n\t\tif (!this.buttonInstance)\n\t\t{\n\t\t\treturn traceData;\n\t\t}\n\n\t\tif (typeof this.buttonInstance.getTrace !== 'function')\n\t\t{\n\t\t\ttraceData = this.buttonInstance.getTrace();\n\t\t}\n\t\telse if (\n\t\t\ttypeof this.buttonInstance.b24Tracker !== 'undefined'\n\t\t\t&& typeof this.buttonInstance.b24Tracker.guest !== 'undefined'\n\t\t)\n\t\t{\n\t\t\ttraceData = this.buttonInstance.b24Tracker.guest.getTrace();\n\t\t}\n\n\t\treturn traceData;\n\t}\n\n\tgetCustomData()\n\t{\n\t\tlet customData = [];\n\n\t\tif (this.customData.length > 0)\n\t\t{\n\t\t\tcustomData = this.customData;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tcustomData = [{MESSAGE: this.localize.BX_LIVECHAT_EXTRA_SITE+': [URL]'+location.href+'[/URL]'}];\n\t\t}\n\n\t\treturn JSON.stringify(customData);\n\t}\n\n\tisUserLoaded()\n\t{\n\t\treturn this.controller.getStore().state.widget.user.id > 0;\n\t}\n\n\tisUserReady()\n\t{\n\t\treturn this.isConfigDataLoaded() && this.isUserRegistered();\n\t}\n\n\tisHashAvailable()\n\t{\n\t\treturn !this.isUserRegistered()\n\t\t\t&& (this.userRegisterData.hash || this.getUserHashCookie());\n\t}\n\n\tgetSiteId()\n\t{\n\t\treturn this.host.replace(/(http.?:\\/\\/)|([:.\\\\\\/])/mg, \"\")+this.code;\n\t}\n\n\tgetHost()\n\t{\n\t\treturn this.host;\n\t}\n\n\tgetConfigId()\n\t{\n\t\treturn this.controller.getStore().state.widget.common.configId;\n\t}\n\n\tisDialogStart()\n\t{\n\t\treturn this.controller.getStore().state.widget.common.dialogStart;\n\t}\n\n\tgetChatId()\n\t{\n\t\treturn this.controller.getStore().state.application.dialog.chatId;\n\t}\n\n\tgetDialogId()\n\t{\n\t\treturn this.controller.getStore().state.application.dialog.dialogId;\n\t}\n\n\tgetDiskFolderId()\n\t{\n\t\treturn this.controller.getStore().state.application.dialog.diskFolderId;\n\t}\n\n\tgetDialogData(dialogId = this.getDialogId())\n\t{\n\t\treturn this.controller.getStore().state.dialogues.collection[dialogId];\n\t}\n\n\tgetSessionId()\n\t{\n\t\treturn this.controller.getStore().state.widget.dialog.sessionId;\n\t}\n\n\tisSessionClose()\n\t{\n\t\treturn this.controller.getStore().state.widget.dialog.sessionClose;\n\t}\n\n\tgetUserHash()\n\t{\n\t\treturn this.controller.getStore().state.widget.user.hash;\n\t}\n\n\tgetUserHashCookie()\n\t{\n\t\tlet userHash = '';\n\n\t\tlet cookie = Cookie.get(null, 'LIVECHAT_HASH');\n\t\tif (typeof cookie === 'string' && cookie.match(/^[a-f0-9]{32}$/))\n\t\t{\n\t\t\tuserHash= cookie;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tlet cookie = Cookie.get(this.getSiteId(), 'LIVECHAT_HASH');\n\t\t\tif (typeof cookie === 'string' && cookie.match(/^[a-f0-9]{32}$/))\n\t\t\t{\n\t\t\t\tuserHash = cookie;\n\t\t\t}\n\t\t}\n\n\t\treturn userHash;\n\t}\n\n\tgetUserId()\n\t{\n\t\treturn this.controller.getStore().state.widget.user.id;\n\t}\n\n\tgetUserData()\n\t{\n\t\tif (!this.controller || !this.controller.getStore())\n\t\t{\n\t\t\tconsole.error('LiveChatWidget.getUserData: method can be called after fired event - onBitrixLiveChat');\n\t\t\treturn false;\n\t\t}\n\n\t\treturn this.controller.getStore().state.widget.user;\n\t}\n\n\tgetUserRegisterFields()\n\t{\n\t\treturn {\n\t\t\t'name': this.userRegisterData.name || '',\n\t\t\t'last_name': this.userRegisterData.lastName || '',\n\t\t\t'avatar': this.userRegisterData.avatar || '',\n\t\t\t'email': this.userRegisterData.email || '',\n\t\t\t'www': this.userRegisterData.www || '',\n\t\t\t'gender': this.userRegisterData.gender || '',\n\t\t\t'position': this.userRegisterData.position || '',\n\t\t\t'user_hash': this.userRegisterData.hash || this.getUserHashCookie() || '',\n\t\t\t'consent_url': this.controller.getStore().state.widget.common.consentUrl? location.href: '',\n\t\t\t'trace_data': this.getCrmTraceData(),\n\t\t\t'custom_data': this.getCustomData()\n\t\t};\n\t}\n\n\tgetWidgetLocationCode()\n\t{\n\t\treturn LocationStyle[this.controller.getStore().state.widget.common.location];\n\t}\n\n\t// public method\n\tsetUserRegisterData(params)\n\t{\n\t\tif (!this.controller || !this.controller.getStore())\n\t\t{\n\t\t\tconsole.error('LiveChatWidget.getUserData: method can be called after fired event - onBitrixLiveChat');\n\t\t\treturn false;\n\t\t}\n\n\t\tconst validUserFields = ['hash', 'name', 'lastName', 'avatar', 'email', 'www', 'gender', 'position'];\n\n\t\tif (!Utils.types.isPlainObject(params))\n\t\t{\n\t\t\tconsole.error(`%cLiveChatWidget.setUserData: params is not a object`, \"color: black;\");\n\t\t\treturn false;\n\t\t}\n\n\t\tfor (let field in this.userRegisterData)\n\t\t{\n\t\t\tif (!this.userRegisterData.hasOwnProperty(field))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (!params[field])\n\t\t\t{\n\t\t\t\tdelete this.userRegisterData[field];\n\t\t\t}\n\t\t}\n\n\t\tfor (let field in params)\n\t\t{\n\t\t\tif (!params.hasOwnProperty(field))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (validUserFields.indexOf(field) === -1)\n\t\t\t{\n\t\t\t\tconsole.warn(`%cLiveChatWidget.setUserData: user field is not set, because you are trying to set an unknown field (%c${field}%c)`, \"color: black;\", \"font-weight: bold; color: red\", \"color: black\");\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tthis.userRegisterData[field] = params[field];\n\t\t}\n\n\t\tif (\n\t\t\tthis.userRegisterData.hash\n\t\t\t&& this.getUserHash()\n\t\t\t&& this.userRegisterData.hash !== this.getUserHash()\n\t\t)\n\t\t{\n\t\t\tthis.setNewAuthToken(this.userRegisterData.hash);\n\t\t}\n\t}\n\n\tsetNewAuthToken(authToken = '')\n\t{\n\t\tthis.controller.getStoreBuilder().clearModelState();\n\t\tCookie.set(null, 'LIVECHAT_HASH', '', {expires: 365*86400, path: '/'});\n\n\t\tthis.controller.restClient.setAuthId(RestAuth.guest, authToken);\n\t}\n\n\t// public method\n\tsetOption(name, value)\n\t{\n\t\tthis.options[name] = value;\n\t\treturn true;\n\t}\n\n\t// public method\n\tsetCustomData(params)\n\t{\n\t\tif (!this.controller || !this.controller.getStore())\n\t\t{\n\t\t\tconsole.error('LiveChatWidget.getUserData: method can be called after fired event - onBitrixLiveChat');\n\t\t\treturn false;\n\t\t}\n\n\t\tlet result = [];\n\t\tif (params instanceof Array)\n\t\t{\n\t\t\tparams.forEach(element =>\n\t\t\t{\n\t\t\t\tif (element && typeof element === 'object')\n\t\t\t\t{\n\t\t\t\t\tresult.push(element);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (result.length <= 0)\n\t\t\t{\n\t\t\t\tconsole.error('LiveChatWidget.setCustomData: params is empty');\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (!params)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tresult = [{'MESSAGE': params}]\n\t\t}\n\n\t\tthis.customData = this.customData.concat(result);\n\n\t\treturn true;\n\t}\n\n\tsetError(code = '', description = '')\n\t{\n\t\tconsole.error(`LiveChatWidget.error: ${code} (${description})`);\n\n\t\tlet localizeDescription = '';\n\t\tif (code === 'LIVECHAT_AUTH_FAILED')\n\t\t{\n\t\t\tlocalizeDescription = this.getLocalize('BX_LIVECHAT_AUTH_FAILED').replace('#LINK_START#', '<a href=\"javascript:void();\" onclick=\"location.reload()\">').replace('#LINK_END#', '</a>');\n\t\t\tthis.setNewAuthToken();\n\t\t}\n\t\telse if (code === 'LIVECHAT_AUTH_PORTAL_USER')\n\t\t{\n\t\t\tlocalizeDescription = this.getLocalize('BX_LIVECHAT_PORTAL_USER_NEW').replace('#LINK_START#', '<a href=\"'+this.host+'\">').replace('#LINK_END#', '</a>');\n\t\t}\n\t\telse if (code === 'LIVECHAT_SAME_DOMAIN')\n\t\t{\n\t\t\tlocalizeDescription = this.getLocalize('BX_LIVECHAT_SAME_DOMAIN');\n\t\t\tlet link = this.getLocalize('BX_LIVECHAT_SAME_DOMAIN_LINK');\n\t\t\tif (link)\n\t\t\t{\n\t\t\t\tlocalizeDescription += '<br><br><a href=\"'+link+'\">'+this.getLocalize('BX_LIVECHAT_SAME_DOMAIN_MORE')+'</a>';\n\t\t\t}\n\t\t}\n\t\telse if (code.endsWith('LOCALIZED'))\n\t\t{\n\t\t\tlocalizeDescription = description;\n\t\t}\n\n\t\tthis.controller.getStore().commit('application/set', {error: {\n\t\t\tactive: true,\n\t\t\tcode,\n\t\t\tdescription: localizeDescription\n\t\t}});\n\t}\n\n\tclearError()\n\t{\n\t\tthis.controller.getStore().commit('application/set', {error: {\n\t\t\tactive: false,\n\t\t\tcode: '',\n\t\t\tdescription: ''}\n\t\t});\n\t}\n\n\t// public method\n\tsubscribe(params)\n\t{\n\t\tif (!Utils.types.isPlainObject(params))\n\t\t{\n\t\t\tconsole.error(`%cLiveChatWidget.subscribe: params is not a object`, \"color: black;\");\n\t\t\treturn false;\n\t\t}\n\n\t\tif (!SubscriptionTypeCheck.includes(params.type))\n\t\t{\n\t\t\tconsole.error(`%cLiveChatWidget.subscribe: subscription type is not correct (%c${params.type}%c)`, \"color: black;\", \"font-weight: bold; color: red\", \"color: black\");\n\t\t\treturn false;\n\t\t}\n\n\t\tif (typeof params.callback !== 'function')\n\t\t{\n\t\t\tconsole.error(`%cLiveChatWidget.subscribe: callback is not a function (%c${typeof params.callback}%c)`, \"color: black;\", \"font-weight: bold; color: red\", \"color: black\");\n\t\t\treturn false;\n\t\t}\n\n\t\tif (typeof (this.subscribers[params.type]) === 'undefined')\n\t\t{\n\t\t\tthis.subscribers[params.type] = [];\n\t\t}\n\n\t\tthis.subscribers[params.type].push(params.callback);\n\n\t\treturn function () {\n\t\t\tthis.subscribers[params.type] = this.subscribers[params.type].filter(function(element) {\n\t\t\t\treturn element !== params.callback;\n\t\t\t});\n\t\t}.bind(this);\n\t}\n\n\tsendEvent(params)\n\t{\n\t\tparams = params || {};\n\n\t\tif (!params.type)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tif (typeof params.data !== 'object' || !params.data)\n\t\t{\n\t\t\tparams.data = {};\n\t\t}\n\n\t\tif (this.subscribers[params.type] instanceof Array && this.subscribers[params.type].length > 0)\n\t\t{\n\t\t\tthis.subscribers[params.type].forEach(callback => callback(params.data));\n\t\t}\n\n\t\tif (this.subscribers[SubscriptionType.every] instanceof Array && this.subscribers[SubscriptionType.every].length > 0)\n\t\t{\n\t\t\tthis.subscribers[SubscriptionType.every].forEach(callback => callback({type: params.type, data: params.data}));\n\t\t}\n\n\t\treturn true;\n\t}\n\n\t// public method\n\taddLocalize(phrases)\n\t{\n\t\tif (typeof phrases !== \"object\" || !phrases)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tfor (let name in phrases)\n\t\t{\n\t\t\tif (phrases.hasOwnProperty(name))\n\t\t\t{\n\t\t\t\tthis.localize[name] = phrases[name];\n\t\t\t}\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tgetLocalize(name)\n\t{\n\t\tlet phrase = '';\n\t\tif (typeof name === 'undefined')\n\t\t{\n\t\t\treturn this.localize;\n\t\t}\n\t\telse if (typeof this.localize[name.toString()] === 'undefined')\n\t\t{\n\t\t\tconsole.warn(`LiveChatWidget.getLocalize: message with code '${name.toString()}' is undefined.`)\n\t\t}\n\t\telse\n\t\t{\n\t\t\tphrase = this.localize[name];\n\t\t}\n\n\t\treturn phrase;\n\t}\n\n/* endregion 04. Widget interaction and utils */\n\n/* region 05. Rest batch handlers */\n\thandleConfigGet(response): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tconst configGet = response[RestMethod.widgetConfigGet];\n\t\t\tif (configGet && configGet.error())\n\t\t\t{\n\t\t\t\treturn reject({\n\t\t\t\t\tcode: configGet.error().ex.error,\n\t\t\t\t\tdescription: configGet.error().ex.error_description\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis.controller.executeRestAnswer(RestMethod.widgetConfigGet, configGet);\n\n\t\t\tresolve();\n\t\t});\n\t}\n\n\thandleUserGet(response): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tconst userGetResult = response[RestMethod.widgetUserGet];\n\t\t\tif (userGetResult.error())\n\t\t\t{\n\t\t\t\treturn reject({\n\t\t\t\t\tcode: userGetResult.error().ex.error,\n\t\t\t\t\tdescription: userGetResult.error().ex.error_description\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis.controller.executeRestAnswer(RestMethod.widgetUserGet, userGetResult);\n\n\t\t\tresolve();\n\t\t});\n\t}\n\n\thandleChatGet(response): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tconst chatGetResult = response[ImRestMethodHandler.imChatGet];\n\t\t\tif (chatGetResult.error())\n\t\t\t{\n\t\t\t\treturn reject({\n\t\t\t\t\tcode: chatGetResult.error().ex.error,\n\t\t\t\t\tdescription: chatGetResult.error().ex.error_description\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis.controller.executeRestAnswer(ImRestMethodHandler.imChatGet, chatGetResult);\n\n\t\t\tresolve();\n\t\t});\n\t}\n\n\thandleDialogGet(response): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tconst dialogGetResult = response[RestMethod.widgetDialogGet];\n\t\t\tif (!dialogGetResult)\n\t\t\t{\n\t\t\t\treturn resolve();\n\t\t\t}\n\n\t\t\tif (dialogGetResult.error())\n\t\t\t{\n\t\t\t\treturn reject({\n\t\t\t\t\tcode: dialogGetResult.error().ex.error,\n\t\t\t\t\tdescription: dialogGetResult.error().ex.error_description\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis.controller.executeRestAnswer(RestMethod.widgetDialogGet, dialogGetResult);\n\n\t\t\tresolve();\n\t\t});\n\t}\n\n\thandleDialogMessagesGet(response): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tconst dialogMessagesGetResult = response[ImRestMethodHandler.imDialogMessagesGetInit];\n\t\t\tif (!dialogMessagesGetResult)\n\t\t\t{\n\t\t\t\treturn resolve();\n\t\t\t}\n\n\t\t\tif (dialogMessagesGetResult.error())\n\t\t\t{\n\t\t\t\treturn reject({\n\t\t\t\t\tcode: dialogMessagesGetResult.error().ex.error,\n\t\t\t\t\tdescription: dialogMessagesGetResult.error().ex.error_description\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis.controller.getStore().dispatch('dialogues/saveDialog', {\n\t\t\t\tdialogId: this.controller.application.getDialogId(),\n\t\t\t\tchatId: this.controller.application.getChatId(),\n\t\t\t});\n\n\t\t\tthis.controller.executeRestAnswer(ImRestMethodHandler.imDialogMessagesGetInit, dialogMessagesGetResult);\n\n\t\t\tresolve();\n\t\t});\n\t}\n\n\thandleUserRegister(response): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tconst userRegisterResult = response[RestMethod.widgetUserRegister];\n\t\t\tif (!userRegisterResult)\n\t\t\t{\n\t\t\t\treturn resolve();\n\t\t\t}\n\n\t\t\tif (userRegisterResult.error())\n\t\t\t{\n\t\t\t\treturn reject({\n\t\t\t\t\tcode: userRegisterResult.error().ex.error,\n\t\t\t\t\tdescription: userRegisterResult.error().ex.error_description\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis.controller.executeRestAnswer(RestMethod.widgetUserRegister, userRegisterResult);\n\n\t\t\tresolve();\n\t\t});\n\t}\n\n\thandleChatCreate(response): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tconst chatCreateResult = response[RestMethod.widgetChatCreate];\n\t\t\tif (!chatCreateResult)\n\t\t\t{\n\t\t\t\treturn resolve();\n\t\t\t}\n\n\t\t\tif (chatCreateResult.error())\n\t\t\t{\n\t\t\t\treturn reject({\n\t\t\t\t\tcode: chatCreateResult.error().ex.error,\n\t\t\t\t\tdescription: chatCreateResult.error().ex.error_description\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis.controller.executeRestAnswer(RestMethod.widgetChatCreate, chatCreateResult);\n\n\t\t\tresolve();\n\t\t});\n\t}\n\n\thandlePullRequests(response): Promise\n\t{\n\t\treturn new Promise((resolve) => {\n\t\t\tlet timeShift = 0;\n\n\t\t\tconst serverTimeResult = response[RestMethod.pullServerTime];\n\t\t\tif (serverTimeResult && !serverTimeResult.error())\n\t\t\t{\n\t\t\t\ttimeShift = Math.floor((Date.now() - new Date(serverTimeResult.data()).getTime()) / 1000);\n\t\t\t}\n\n\t\t\tlet config = null;\n\t\t\tconst pullConfigResult = response[RestMethod.pullConfigGet];\n\t\t\tif (pullConfigResult && !pullConfigResult.error())\n\t\t\t{\n\t\t\t\tconfig = pullConfigResult.data();\n\t\t\t\tconfig.server.timeShift = timeShift;\n\t\t\t}\n\n\t\t\tthis.startPullClient(config).then(() => {\n\t\t\t\tEventEmitter.emit(WidgetEventType.processMessagesToSendQueue);\n\t\t\t}).catch((error) => {\n\t\t\t\tthis.setError(error.ex.error, error.ex.error_description);\n\t\t\t}).finally(resolve);\n\t\t});\n\t}\n/* endregion 05. Rest batch handlers */\n}","/**\n * Bitrix OpenLines widget\n * Widget public interface\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {Widget} from \"./widget\"\nimport {SubscriptionType} from \"./const\";\n\nexport class WidgetPublicManager\n{\n\tconstructor(config)\n\t{\n\t\tthis.developerInfo = 'Do not use private methods.';\n\t\tthis.__privateMethods__ = new Widget(config);\n\t\tthis.__createLegacyMethods();\n\t}\n\n\topen(params)\n\t{\n\t\treturn this.__privateMethods__.open(params);\n\t}\n\n\tclose()\n\t{\n\t\treturn this.__privateMethods__.close();\n\t}\n\n\tshowNotification(params)\n\t{\n\t\treturn this.__privateMethods__.showNotification(params);\n\t}\n\n\tgetUserData()\n\t{\n\t\treturn this.__privateMethods__.getUserData();\n\t}\n\n\tsetUserRegisterData(params)\n\t{\n\t\treturn this.__privateMethods__.setUserRegisterData(params);\n\t}\n\n\tsetCustomData(params)\n\t{\n\t\treturn this.__privateMethods__.setCustomData(params);\n\t}\n\n\tmutateTemplateComponent(id, params)\n\t{\n\t\treturn this.__privateMethods__.mutateTemplateComponent(id, params);\n\t}\n\n\taddLocalize(phrases)\n\t{\n\t\treturn this.__privateMethods__.addLocalize(phrases);\n\t}\n\n\t/**\n\t *\n\t * @param params {Object}\n\t * @returns {Function|Boolean} - Unsubscribe callback function or False\n\t */\n\tsubscribe(params)\n\t{\n\t\treturn this.__privateMethods__.subscribe(params);\n\t}\n\n\tstart()\n\t{\n\t\treturn this.__privateMethods__.start();\n\t}\n\n\t__createLegacyMethods()\n\t{\n\t\tif (typeof window.BX.LiveChat === 'undefined')\n\t\t{\n\t\t\tlet sourceHref = document.createElement('a');\n\t\t\tsourceHref.href = this.__privateMethods__.host;\n\n\t\t\tlet sourceDomain = sourceHref.protocol+'//'+sourceHref.hostname+(sourceHref.port && sourceHref.port != '80' && sourceHref.port != '443'? \":\"+sourceHref.port: \"\");\n\n\t\t\twindow.BX.LiveChat = {\n\t\t\t\topenLiveChat: () => {\n\t\t\t\t\tthis.open({openFromButton: true});\n\t\t\t\t},\n\t\t\t\tcloseLiveChat: () => {\n\t\t\t\t\tthis.close();\n\t\t\t\t},\n\t\t\t\taddEventListener: (el, eventName, handler) =>\n\t\t\t\t{\n\t\t\t\t\tif (eventName === 'message')\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.subscribe({\n\t\t\t\t\t\t\ttype: SubscriptionType.userMessage,\n\t\t\t\t\t\t\tcallback: function (event)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\thandler({origin: sourceDomain, data: JSON.stringify({action: 'sendMessage'}), event});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tconsole.warn('Method BX.LiveChat.addEventListener is not supported, user new format for subscribe.')\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tsetCookie: () => {},\n\t\t\t\tgetCookie: () => {},\n\t\t\t\tsourceDomain\n\t\t\t};\n\t\t}\n\n\t\tif (typeof window.BxLiveChatInit === 'function')\n\t\t{\n\t\t\tlet config = window.BxLiveChatInit();\n\n\t\t\tif (config.user)\n\t\t\t{\n\t\t\t\tthis.__privateMethods__.setUserRegisterData(config.user);\n\t\t\t}\n\t\t\tif (config.firstMessage)\n\t\t\t{\n\t\t\t\tthis.__privateMethods__.setCustomData(config.firstMessage)\n\t\t\t}\n\t\t}\n\n\t\tif (window.BxLiveChatLoader instanceof Array)\n\t\t{\n\t\t\twindow.BxLiveChatLoader.forEach(callback => callback());\n\t\t}\n\n\t\treturn true;\n\t}\n}","import {SendMessageHandler} from 'im.event-handler';\nimport {FormType, WidgetEventType, RestMethod as WidgetRestMethod} from '../const';\nimport {EventEmitter} from 'main.core.events';\nimport {DeviceType, EventType, RestMethod as ImRestMethod, RestMethodHandler} from 'im.const';\nimport {Utils} from 'im.lib.utils';\nimport {Logger} from 'im.lib.logger';\n\nexport class WidgetSendMessageHandler extends SendMessageHandler\n{\n\tapplication: Object = null;\n\tstoredMessage: string = null;\n\n\tconstructor($Bitrix)\n\t{\n\t\tsuper($Bitrix);\n\n\t\tthis.application = $Bitrix.Application.get();\n\n\t\tthis.onProcessQueueHandler = this.processQueue.bind(this);\n\t\tthis.onConsentAcceptedHandler = this.onConsentAccepted.bind(this);\n\t\tthis.onConsentDeclinedHandler = this.onConsentDeclined.bind(this);\n\n\t\tEventEmitter.subscribe(WidgetEventType.processMessagesToSendQueue, this.onProcessQueueHandler);\n\t\tEventEmitter.subscribe(WidgetEventType.consentAccepted, this.onConsentAcceptedHandler);\n\t\tEventEmitter.subscribe(WidgetEventType.consentDeclined, this.onConsentDeclinedHandler);\n\t}\n\n\tdestroy(): void\n\t{\n\t\tsuper.destroy();\n\t\tEventEmitter.unsubscribe(WidgetEventType.processMessagesToSendQueue, this.onProcessQueueHandler);\n\t\tEventEmitter.unsubscribe(WidgetEventType.consentAccepted, this.onConsentAcceptedHandler);\n\t\tEventEmitter.unsubscribe(WidgetEventType.consentDeclined, this.onConsentDeclinedHandler);\n\t}\n\n\tonSendMessage({data: event})\n\t{\n\t\tevent.focus = event.focus !== false;\n\n\t\t//hide smiles\n\t\tif (this.getWidgetData().common.showForm === FormType.smile)\n\t\t{\n\t\t\tEventEmitter.emit(WidgetEventType.hideForm);\n\t\t}\n\n\t\t//show consent window if needed\n\t\tif (!this.getWidgetData().dialog.userConsent && this.getWidgetData().common.consentUrl)\n\t\t{\n\t\t\tif (event.text)\n\t\t\t{\n\t\t\t\tthis.storedMessage = event.text;\n\t\t\t}\n\n\t\t\tEventEmitter.emit(WidgetEventType.showConsent);\n\n\t\t\treturn false;\n\t\t}\n\n\t\tevent.text = event.text ? event.text : this.storedMessage;\n\t\tif (!event.text && !event.file)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tEventEmitter.emit(WidgetEventType.hideForm);\n\n\t\tif (this.isCreateSessionMode())\n\t\t{\n\t\t\tEventEmitter.emit(WidgetEventType.hideForm);\n\t\t\tEventEmitter.emit(EventType.textarea.stopWriting);\n\t\t\tEventEmitter.emitAsync(WidgetEventType.createSession).then(() => {\n\t\t\t\tthis.store.commit('widget/common', {isCreateSessionMode: false});\n\t\t\t\tthis.sendMessage(event.text, event.file);\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.sendMessage(event.text, event.file);\n\t\t}\n\n\t\tif (event.focus)\n\t\t{\n\t\t\tEventEmitter.emit(EventType.textarea.setFocus);\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tsendMessage(text = '', file = null)\n\t{\n\t\tif (!text && !file)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst quoteId = this.store.getters['dialogues/getQuoteId'](this.getDialogId());\n\t\tif (quoteId)\n\t\t{\n\t\t\tconst quoteMessage = this.store.getters['messages/getMessage'](this.getChatId(), quoteId);\n\n\t\t\tif (quoteMessage)\n\t\t\t{\n\t\t\t\ttext = this.getMessageTextWithQuote(quoteMessage, text);\n\t\t\t\tEventEmitter.emit(EventType.dialog.quotePanelClose);\n\t\t\t}\n\t\t}\n\n\t\tif (!this.controller.application.isUnreadMessagesLoaded())\n\t\t{\n\t\t\tthis.sendMessageToServer({\n\t\t\t\tid: 0,\n\t\t\t\tchatId: this.getChatId(),\n\t\t\t\tdialogId: this.getDialogId(),\n\t\t\t\ttext,\n\t\t\t\tfile\n\t\t\t});\n\t\t\tthis.processQueue();\n\n\t\t\treturn true;\n\t\t}\n\n\t\tconst params = {};\n\t\tif (file)\n\t\t{\n\t\t\tparams.FILE_ID = [file.id];\n\t\t}\n\n\t\tthis.addMessageToModel({\n\t\t\ttext,\n\t\t\tparams,\n\t\t\tsending: !file\n\t\t}).then(messageId => {\n\t\t\tif (!this.isDialogStart())\n\t\t\t{\n\t\t\t\tthis.store.commit('widget/common', {dialogStart: true});\n\t\t\t}\n\n\t\t\tEventEmitter.emit(EventType.dialog.scrollToBottom, {\n\t\t\t\tchatId: this.getChatId(),\n\t\t\t\tcancelIfScrollChange: true\n\t\t\t});\n\n\t\t\tthis.addMessageToQueue({messageId, text, file});\n\n\t\t\tif (this.getChatId())\n\t\t\t{\n\t\t\t\tthis.processQueue();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tEventEmitter.emit(WidgetEventType.requestData);\n\t\t\t}\n\t\t});\n\n\t\treturn true;\n\t}\n\n\tonClickOnKeyboard({data: event})\n\t{\n\t\tif (event.action === 'ACTION' && event.params.action === 'LIVECHAT')\n\t\t{\n\t\t\tconst {dialogId, messageId, value} = event.params;\n\t\t\tconst values = JSON.parse(value);\n\n\t\t\tconst sessionId = Number.parseInt(values.SESSION_ID, 10);\n\t\t\tif (sessionId !== this.getSessionId() || this.isSessionClose())\n\t\t\t{\n\t\t\t\tconsole.error('WidgetSendMessageHandler', this.loc['BX_LIVECHAT_ACTION_EXPIRED']);\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tthis.restClient.callMethod(WidgetRestMethod.widgetActionSend, {\n\t\t\t\t'MESSAGE_ID': messageId,\n\t\t\t\t'DIALOG_ID': dialogId,\n\t\t\t\t'ACTION_VALUE': value,\n\t\t\t});\n\t\t}\n\n\t\tif (event.action === 'COMMAND')\n\t\t{\n\t\t\tconst {dialogId, messageId, botId, command, params} = event.params;\n\n\t\t\tthis.restClient.callMethod(ImRestMethod.imMessageCommand, {\n\t\t\t\t'MESSAGE_ID': messageId,\n\t\t\t\t'DIALOG_ID': dialogId,\n\t\t\t\t'BOT_ID': botId,\n\t\t\t\t'COMMAND': command,\n\t\t\t\t'COMMAND_PARAMS': params,\n\t\t\t}).catch(error => console.error('WidgetSendMessageHandler: command processing error', error));\n\t\t}\n\t}\n\n\tgetWidgetData(): Object\n\t{\n\t\treturn this.store.state.widget;\n\t}\n\n\tgetChatId(): number\n\t{\n\t\treturn this.store.state.application.dialog.chatId;\n\t}\n\n\tgetDialogId(): number | string\n\t{\n\t\treturn this.store.state.application.dialog.dialogId;\n\t}\n\n\tgetUserId(): number\n\t{\n\t\treturn this.store.state.widget.user.id;\n\t}\n\n\tgetMessageTextWithQuote(quoteMessage, text): string\n\t{\n\t\tlet user = null;\n\t\tif (quoteMessage.authorId)\n\t\t{\n\t\t\tuser = this.store.getters['users/get'](quoteMessage.authorId);\n\t\t}\n\n\t\tconst files = this.store.getters['files/getList'](this.getChatId());\n\n\t\tconst quoteDelimiter = '-'.repeat(54);\n\t\tconst quoteTitle = (user && user.name) ? user.name : this.loc['BX_LIVECHAT_SYSTEM_MESSAGE'];\n\t\tconst quoteDate = Utils.date.format(quoteMessage.date, null, this.loc);\n\t\tconst quoteContent = Utils.text.quote(quoteMessage.text, quoteMessage.params, files, this.loc);\n\n\t\tconst message = [];\n\t\tmessage.push(quoteDelimiter);\n\t\tmessage.push(`${quoteTitle} [${quoteDate}]`);\n\t\tmessage.push(quoteContent);\n\t\tmessage.push(quoteDelimiter);\n\t\tmessage.push(text);\n\n\t\treturn message.join(\"\\n\");\n\t}\n\n\taddMessageToQueue({messageId, text, file}): void\n\t{\n\t\tthis.messagesToSend.push({\n\t\t\tid: messageId,\n\t\t\tchatId: this.getChatId(),\n\t\t\tdialogId: this.getDialogId(),\n\t\t\ttext,\n\t\t\tfile,\n\t\t\tsending: false\n\t\t});\n\t}\n\n\tsendMessageToServer(message)\n\t{\n\t\tEventEmitter.emit(EventType.textarea.stopWriting);\n\n\t\t// first message, when we didn't have chat\n\t\tif (message.chatId === 0)\n\t\t{\n\t\t\tmessage.chatId = this.getChatId();\n\t\t}\n\n\t\tthis.restClient.callMethod(ImRestMethod.imMessageAdd, {\n\t\t\t'TEMPLATE_ID': message.id,\n\t\t\t'CHAT_ID': message.chatId,\n\t\t\t'MESSAGE': message.text\n\t\t}, null, null, Utils.getLogTrackingParams({\n\t\t\tname: ImRestMethod.imMessageAdd,\n\t\t\tdata: {timMessageType: 'text'},\n\t\t\tdialog: this.getDialogData()\n\t\t})).then(response => {\n\t\t\tthis.controller.executeRestAnswer(RestMethodHandler.imMessageAdd, response, message);\n\t\t}).catch(error => {\n\t\t\tthis.controller.executeRestAnswer(RestMethodHandler.imMessageAdd, error, message);\n\t\t\tLogger.warn('Error during sending message', error);\n\t\t});\n\n\t\treturn true;\n\t}\n\n\tisDialogStart(): boolean\n\t{\n\t\treturn this.store.state.widget.common.dialogStart;\n\t}\n\n\tisCreateSessionMode(): boolean\n\t{\n\t\treturn this.store.state.widget.common.isCreateSessionMode;\n\t}\n\n\tgetDialogData(): Object\n\t{\n\t\tconst dialogId = this.getDialogId();\n\n\t\treturn this.store.state.dialogues.collection[dialogId];\n\t}\n\n\tgetApplicationModel()\n\t{\n\t\treturn this.store.state.application;\n\t}\n\n\tgetSessionId()\n\t{\n\t\treturn this.store.state.widget.dialog.sessionId;\n\t}\n\n\tisSessionClose()\n\t{\n\t\treturn this.store.state.widget.dialog.sessionClose;\n\t}\n\n\tprocessQueue(): void\n\t{\n\t\tif (this.application.offline)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.messagesToSend.filter(element => !element.sending).forEach(element => {\n\t\t\tthis.deleteFromQueue(element.id);\n\t\t\telement.sending = true;\n\t\t\tif (element.file)\n\t\t\t{\n\t\t\t\tEventEmitter.emit(EventType.textarea.stopWriting);\n\t\t\t\tEventEmitter.emit(EventType.uploader.addMessageWithFile, element);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.sendMessageToServer(element);\n\t\t\t}\n\t\t});\n\t}\n\n\tonConsentAccepted()\n\t{\n\t\tif (!this.storedMessage)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst isFocusNeeded = this.getApplicationModel().device.type !== DeviceType.mobile;\n\t\tthis.onSendMessage({\n\t\t\tdata: {focus: isFocusNeeded}\n\t\t});\n\t\tthis.storedMessage = '';\n\t}\n\n\tonConsentDeclined()\n\t{\n\t\tif (!this.storedMessage)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tEventEmitter.emit(EventType.textarea.insertText, {\n\t\t\ttext: this.storedMessage,\n\t\t\tfocus: this.getApplicationModel().device.type !== DeviceType.mobile\n\t\t});\n\t\tthis.storedMessage = '';\n\t}\n}","import { TextareaHandler } from \"im.event-handler\";\nimport { EventEmitter } from \"main.core.events\";\nimport { DeviceType, EventType } from \"im.const\";\nimport { WidgetEventType, FormType } from \"../const\";\nimport { Utils } from \"im.lib.utils\";\nimport { md5 } from \"main.md5\";\n\nexport class WidgetTextareaHandler extends TextareaHandler\n{\n\tapplication: Object = null;\n\tpullClient: Object = null;\n\n\tconstructor($Bitrix)\n\t{\n\t\tsuper($Bitrix);\n\t\tthis.application = $Bitrix.Application.get();\n\t\tthis.pullClient = $Bitrix.PullClient.get();\n\t}\n\n\tonAppButtonClick({data: event})\n\t{\n\t\tif (event.appId === FormType.smile)\n\t\t{\n\t\t\tif (this.getWidgetModel().common.showForm === FormType.smile)\n\t\t\t{\n\t\t\t\tEventEmitter.emit(WidgetEventType.hideForm);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tEventEmitter.emit(WidgetEventType.showForm, {\n\t\t\t\t\ttype: FormType.smile\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tEventEmitter.emit(EventType.textarea.setFocus);\n\t\t}\n\t}\n\n\tonFocus()\n\t{\n\t\tif (\n\t\t\tthis.getWidgetModel().common.copyright\n\t\t\t&& this.getApplicationModel().device.type === DeviceType.mobile\n\t\t)\n\t\t{\n\t\t\tthis.getWidgetModel().common.copyright = false;\n\t\t}\n\n\t\tif (Utils.device.isMobile())\n\t\t{\n\t\t\tclearTimeout(this.onFocusScrollTimeout);\n\t\t\tthis.onScrollHandler = this.onScroll.bind(this);\n\t\t\tthis.onFocusScrollTimeout = setTimeout(() => {\n\t\t\t\tdocument.addEventListener('scroll', this.onScrollHandler);\n\t\t\t}, 1000);\n\t\t}\n\t}\n\n\tonBlur()\n\t{\n\t\tif (\n\t\t\t!this.getWidgetModel().common.copyright\n\t\t\t&& this.getWidgetModel().common.copyright !== this.application.copyright\n\t\t)\n\t\t{\n\t\t\tthis.getWidgetModel().common.copyright = this.application.copyright;\n\t\t\tsetTimeout(() => {\n\t\t\t\tEventEmitter.emit(EventType.dialog.scrollToBottom, {\n\t\t\t\t\tchatId: this.getChatId(),\n\t\t\t\t\tforce: true\n\t\t\t\t});\n\t\t\t}, 100);\n\t\t}\n\n\t\tif (Utils.device.isMobile())\n\t\t{\n\t\t\tclearTimeout(this.onFocusScrollTimeout);\n\t\t\tdocument.removeEventListener('scroll', this.onScrollHandler);\n\t\t}\n\t}\n\n\t// send typed client message to operator\n\tonKeyUp({data: event})\n\t{\n\t\tif (this.canSendTypedText())\n\t\t{\n\t\t\tconst {sessionId} = this.getWidgetModel().dialog;\n\t\t\tconst chatId = this.getChatId();\n\t\t\tconst userId = this.getWidgetModel().user.id;\n\t\t\tconst infoString = md5(`${sessionId}/${chatId}/${userId}`);\n\n\t\t\tconst operatorId = this.getWidgetModel().dialog.operator.id;\n\t\t\tconst {operatorChatId} = this.getWidgetModel().dialog;\n\t\t\tthis.pullClient.sendMessage([operatorId], 'imopenlines', 'linesMessageWrite', {\n\t\t\t\t\ttext: event.text,\n\t\t\t\t\tinfoString,\n\t\t\t\t\toperatorChatId: operatorChatId\n\t\t\t});\n\t\t}\n\t}\n\n\tcanSendTypedText()\n\t{\n\t\treturn this.getWidgetModel().common.watchTyping\n\t\t\t&& this.getWidgetModel().dialog.sessionId\n\t\t\t&& !this.getWidgetModel().dialog.sessionClose\n\t\t\t&& this.getWidgetModel().dialog.operator.id\n\t\t\t&& this.getWidgetModel().dialog.operatorChatId\n\t\t\t&& this.pullClient.isPublishingEnabled();\n\t}\n\n\tonScroll()\n\t{\n\t\tclearTimeout(this.onScrollTimeout);\n\t\tthis.onScrollTimeout = setTimeout(() => {\n\t\t\tEventEmitter.emit(EventType.textarea.setBlur, true);\n\t\t}, 50);\n\t}\n\n\tgetWidgetModel()\n\t{\n\t\treturn this.store.state.widget;\n\t}\n\n\tgetApplicationModel()\n\t{\n\t\treturn this.store.state.application;\n\t}\n}","import {TextareaUploadHandler} from 'im.event-handler';\nimport {Logger} from 'im.lib.logger';\nimport {EventEmitter} from 'main.core.events';\nimport {WidgetEventType} from '../const';\nimport {Uploader} from 'im.lib.uploader';\n\nexport class WidgetTextareaUploadHandler extends TextareaUploadHandler\n{\n\tstoredFile: Object = null;\n\twidgetApplication: Object = null;\n\n\tconstructor($Bitrix)\n\t{\n\t\tsuper($Bitrix);\n\t\tthis.widgetApplication = $Bitrix.Application.get();\n\n\t\tthis.onConsentAcceptedHandler = this.onConsentAccepted.bind(this);\n\t\tthis.onConsentDeclinedHandler = this.onConsentDeclined.bind(this);\n\t\tEventEmitter.subscribe(WidgetEventType.consentAccepted, this.onConsentAcceptedHandler);\n\t\tEventEmitter.subscribe(WidgetEventType.consentDeclined, this.onConsentDeclinedHandler);\n\t}\n\n\tdestroy(): void\n\t{\n\t\tsuper.destroy();\n\t\tEventEmitter.unsubscribe(WidgetEventType.consentAccepted, this.onConsentAcceptedHandler);\n\t\tEventEmitter.unsubscribe(WidgetEventType.consentDeclined, this.onConsentDeclinedHandler);\n\t}\n\n\tgetUserId(): number\n\t{\n\t\treturn this.controller.store.state.widget.user.id;\n\t}\n\n\tgetUserHash(): string\n\t{\n\t\treturn this.controller.store.state.widget.user.hash;\n\t}\n\n\tgetHost(): string\n\t{\n\t\treturn this.controller.store.state.widget.common.host;\n\t}\n\n\taddMessageWithFile(event)\n\t{\n\t\tconst message = event.getData();\n\t\tif (!this.getDiskFolderId())\n\t\t{\n\t\t\tthis.requestDiskFolderId(message.chatId).then(() => {\n\t\t\t\tthis.addMessageWithFile(event);\n\t\t\t}).catch(error => {\n\t\t\t\tLogger.error('addMessageWithFile error', error);\n\t\t\t\treturn false;\n\t\t\t});\n\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.uploader.senderOptions.customHeaders['Livechat-Dialog-Id'] = this.getDialogId();\n\t\tthis.uploader.senderOptions.customHeaders['Livechat-Auth-Id'] = this.getUserHash();\n\n\t\tthis.uploader.addTask({\n\t\t\ttaskId: message.file.id,\n\t\t\tfileData: message.file.source.file,\n\t\t\tfileName: message.file.source.file.name,\n\t\t\tgenerateUniqueName: true,\n\t\t\tdiskFolderId: this.getDiskFolderId(),\n\t\t\tpreviewBlob: message.file.previewBlob,\n\t\t\tchunkSize: this.widgetApplication.getLocalize('isCloud') ? Uploader.CLOUD_MAX_CHUNK_SIZE : Uploader.BOX_MIN_CHUNK_SIZE,\n\t\t});\n\t}\n\n\tonTextareaFileSelected({data: event} = {})\n\t{\n\t\tlet fileInputEvent = null;\n\t\tif (event && event.fileChangeEvent && event.fileChangeEvent.target.files.length > 0)\n\t\t{\n\t\t\tfileInputEvent = event.fileChangeEvent;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tfileInputEvent = this.storedFile;\n\t\t}\n\n\t\tif (!fileInputEvent)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tif (!this.controller.store.state.widget.dialog.userConsent && this.controller.store.state.widget.common.consentUrl)\n\t\t{\n\t\t\tthis.storedFile = event.fileChangeEvent;\n\t\t\tEventEmitter.emit(WidgetEventType.showConsent);\n\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.uploadFile(fileInputEvent);\n\t}\n\n\tuploadFile(event)\n\t{\n\t\tif (!event)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tif (!this.getChatId())\n\t\t{\n\t\t\tEventEmitter.emit(WidgetEventType.requestData);\n\t\t}\n\n\t\tthis.uploader.addFilesFromEvent(event);\n\t}\n\n\tonConsentAccepted()\n\t{\n\t\tif (!this.storedFile)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.onTextareaFileSelected();\n\t\tthis.storedFile = '';\n\t}\n\n\tonConsentDeclined()\n\t{\n\t\tif (!this.storedFile)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.storedFile = '';\n\t}\n\n\tgetUploaderSenderOptions()\n\t{\n\t\treturn {\n\t\t\thost: this.getHost(),\n\t\t\tcustomHeaders: {\n\t\t\t\t'Livechat-Auth-Id': this.getUserHash()\n\t\t\t},\n\t\t\tactionUploadChunk: 'imopenlines.widget.disk.upload',\n\t\t\tactionCommitFile: 'imopenlines.widget.disk.commit',\n\t\t\tactionRollbackUpload: 'imopenlines.widget.disk.rollbackUpload',\n\t\t};\n\t}\n}","import {ReadingHandler} from \"im.event-handler\";\n\nexport class WidgetReadingHandler extends ReadingHandler\n{\n\tapplication: Object = null;\n\n\tconstructor($Bitrix)\n\t{\n\t\tsuper($Bitrix);\n\t\tthis.application = $Bitrix.Application.get();\n\t}\n\n\treadMessage(messageId, skipTimer = false, skipAjax = false): Promise\n\t{\n\t\tif (this.application.offline)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\treturn super.readMessage(messageId, skipTimer, skipAjax);\n\t}\n}","import { LocationType, WidgetMinimumSize } from \"../const\";\nimport { EventEmitter } from \"main.core.events\";\nimport { Type } from \"main.core\";\n\nexport class WidgetResizeHandler extends EventEmitter\n{\n\tstatic events = {\n\t\tonSizeChange: 'onSizeChange',\n\t\tonStopResize: 'onStopResize'\n\t};\n\n\tisResizing: boolean = false;\n\twidgetLocation: number = null;\n\tavailableWidth: number = null;\n\tavailableHeight: number = null;\n\n\tconstructor({widgetLocation, availableWidth, availableHeight, events})\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.IMOL.WidgetResizeHandler');\n\t\tthis.subscribeToEvents(events);\n\n\t\tthis.widgetLocation = widgetLocation;\n\t\tthis.availableWidth = availableWidth;\n\t\tthis.availableHeight = availableHeight;\n\t}\n\n\tsubscribeToEvents(configEvents)\n\t{\n\t\tconst events = Type.isObject(configEvents) ? configEvents : {};\n\t\tObject.entries(events).forEach(([name, callback]) => {\n\t\t\tif (Type.isFunction(callback))\n\t\t\t{\n\t\t\t\tthis.subscribe(name, callback);\n\t\t\t}\n\t\t});\n\t}\n\n\tstartResize(event, currentHeight, currentWidth)\n\t{\n\t\tif (this.isResizing)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.isResizing = true;\n\t\tevent = event.changedTouches ? event.changedTouches[0] : event;\n\n\t\tthis.cursorStartPointY = event.clientY;\n\t\tthis.cursorStartPointX = event.clientX;\n\t\tthis.heightStartPoint = currentHeight;\n\t\tthis.widthStartPoint = currentWidth;\n\n\t\tthis.addWidgetResizeEvents();\n\t}\n\n\tonContinueResize(event)\n\t{\n\t\tif (!this.isResizing)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tevent = event.changedTouches ? event.changedTouches[0] : event;\n\n\t\tthis.cursorControlPointY = event.clientY;\n\t\tthis.cursorControlPointX = event.clientX;\n\n\t\tconst maxHeight = this.isBottomLocation()\n\t\t\t? Math.min(this.heightStartPoint + this.cursorStartPointY - this.cursorControlPointY, this.availableHeight)\n\t\t\t: Math.min(this.heightStartPoint - this.cursorStartPointY + this.cursorControlPointY, this.availableHeight)\n\t\t;\n\t\tconst height = Math.max(maxHeight, WidgetMinimumSize.height);\n\n\t\tconst maxWidth = this.isLeftLocation()\n\t\t\t? Math.min(this.widthStartPoint - this.cursorStartPointX + this.cursorControlPointX, this.availableWidth)\n\t\t\t: Math.min(this.widthStartPoint + this.cursorStartPointX - this.cursorControlPointX, this.availableWidth)\n\t\t;\n\t\tconst width = Math.max(maxWidth, WidgetMinimumSize.width);\n\n\t\tthis.emit(WidgetResizeHandler.events.onSizeChange, {newHeight: height, newWidth: width});\n\t}\n\n\tonStopResize()\n\t{\n\t\tif (!this.isResizing)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.isResizing = false;\n\t\tthis.removeWidgetResizeEvents();\n\n\t\tthis.emit(WidgetResizeHandler.events.onStopResize);\n\t}\n\n\tsetAvailableWidth(width)\n\t{\n\t\tthis.availableWidth = width;\n\t}\n\n\tsetAvailableHeight(height)\n\t{\n\t\tthis.availableHeight = height;\n\t}\n\n\taddWidgetResizeEvents()\n\t{\n\t\tthis.onContinueResizeHandler = this.onContinueResize.bind(this);\n\t\tthis.onStopResizeHandler = this.onStopResize.bind(this);\n\t\tdocument.addEventListener('mousemove', this.onContinueResizeHandler);\n\t\tdocument.addEventListener('mouseup', this.onStopResizeHandler);\n\t\tdocument.addEventListener('mouseleave', this.onStopResizeHandler);\n\t}\n\n\tremoveWidgetResizeEvents()\n\t{\n\t\tdocument.removeEventListener('mousemove', this.onContinueResizeHandler);\n\t\tdocument.removeEventListener('mouseup', this.onStopResizeHandler);\n\t\tdocument.removeEventListener('mouseleave', this.onStopResizeHandler);\n\t}\n\n\tisBottomLocation()\n\t{\n\t\treturn [LocationType.bottomLeft, LocationType.bottomMiddle, LocationType.bottomRight].includes(this.widgetLocation);\n\t}\n\n\tisLeftLocation()\n\t{\n\t\treturn [LocationType.bottomLeft, LocationType.topLeft, LocationType.topMiddle].includes(this.widgetLocation);\n\t}\n\n\tdestroy()\n\t{\n\t\tthis.removeWidgetResizeEvents();\n\t}\n}","import { EventEmitter } from \"main.core.events\";\nimport { WidgetEventType, FormType, RestMethod } from \"../const\";\nimport { DeviceType, EventType } from \"im.const\";\n\nexport class WidgetConsentHandler\n{\n\tstore: Object = null;\n\trestClient: Object = null;\n\tapplication: Object = null;\n\n\tconstructor($Bitrix)\n\t{\n\t\tthis.store = $Bitrix.Data.get('controller').store;\n\t\tthis.restClient = $Bitrix.RestClient.get();\n\t\tthis.application = $Bitrix.Application.get();\n\n\t\tthis.subscribeToEvents();\n\t}\n\n\tsubscribeToEvents()\n\t{\n\t\tthis.showConsentHandler = this.onShowConsent.bind(this);\n\t\tthis.acceptConsentHandler = this.onAcceptConsent.bind(this);\n\t\tthis.declineConsentHandler = this.onDeclineConsent.bind(this);\n\t\tEventEmitter.subscribe(WidgetEventType.showConsent, this.showConsentHandler);\n\t\tEventEmitter.subscribe(WidgetEventType.acceptConsent, this.acceptConsentHandler);\n\t\tEventEmitter.subscribe(WidgetEventType.declineConsent, this.declineConsentHandler);\n\t}\n\n\tonShowConsent()\n\t{\n\t\tthis.showConsent();\n\t}\n\n\tonAcceptConsent()\n\t{\n\t\tthis.acceptConsent();\n\t}\n\n\tonDeclineConsent()\n\t{\n\t\tthis.declineConsent();\n\t}\n\n\tshowConsent()\n\t{\n\t\tthis.store.commit('widget/common', {showConsent: true});\n\t}\n\n\thideConsent()\n\t{\n\t\tthis.store.commit('widget/common', {showConsent: false});\n\t}\n\n\tacceptConsent()\n\t{\n\t\tthis.hideConsent();\n\n\t\tthis.sendConsentDecision(true);\n\n\t\tEventEmitter.emit(WidgetEventType.consentAccepted);\n\n\t\tif (this.getWidgetModel().common.showForm === FormType.none)\n\t\t{\n\t\t\tEventEmitter.emit(EventType.textarea.setFocus);\n\t\t}\n\t}\n\n\tdeclineConsent()\n\t{\n\t\tEventEmitter.emit(WidgetEventType.hideForm);\n\t\tthis.hideConsent();\n\t\tthis.sendConsentDecision(false);\n\n\t\tEventEmitter.emit(WidgetEventType.consentDeclined);\n\n\t\tif (this.getApplicationModel().device.type !== DeviceType.mobile)\n\t\t{\n\t\t\tEventEmitter.emit(EventType.textarea.setFocus);\n\t\t}\n\t}\n\n\tsendConsentDecision(result)\n\t{\n\t\tthis.store.commit('widget/dialog', {userConsent: result});\n\n\t\tif (result && this.application.isUserRegistered())\n\t\t{\n\t\t\tthis.restClient.callMethod(RestMethod.widgetUserConsentApply, {\n\t\t\t\tconfig_id: this.getWidgetModel().common.configId,\n\t\t\t\tconsent_url: location.href\n\t\t\t});\n\t\t}\n\t}\n\n\tgetWidgetModel()\n\t{\n\t\treturn this.store.state.widget;\n\t}\n\n\tgetApplicationModel()\n\t{\n\t\treturn this.store.state.application;\n\t}\n\n\tdestroy()\n\t{\n\t\tEventEmitter.unsubscribe(WidgetEventType.showConsent, this.showConsentHandler);\n\t\tEventEmitter.unsubscribe(WidgetEventType.acceptConsent, this.acceptConsentHandler);\n\t\tEventEmitter.unsubscribe(WidgetEventType.declineConsent, this.declineConsentHandler);\n\t}\n}","import { EventEmitter } from \"main.core.events\";\nimport { WidgetEventType, FormType, RestMethod, SubscriptionType, VoteType } from \"../const\";\n\nexport class WidgetFormHandler\n{\n\tstore: Object = null;\n\tapplication: Object = null;\n\trestClient: Object = null;\n\n\tconstructor($Bitrix)\n\t{\n\t\tthis.store = $Bitrix.Data.get('controller').store;\n\t\tthis.restClient = $Bitrix.RestClient.get();\n\t\tthis.application = $Bitrix.Application.get();\n\n\t\tthis.showFormHandler = this.onShowForm.bind(this);\n\t\tthis.hideFormHandler = this.onHideForm.bind(this);\n\t\tthis.sendVoteHandler = this.onSendVote.bind(this);\n\t\tEventEmitter.subscribe(WidgetEventType.showForm, this.showFormHandler);\n\t\tEventEmitter.subscribe(WidgetEventType.hideForm, this.hideFormHandler);\n\t\tEventEmitter.subscribe(WidgetEventType.sendDialogVote, this.sendVoteHandler);\n\t}\n\n\tonShowForm({data: event})\n\t{\n\t\tclearTimeout(this.showFormTimeout);\n\t\tif (event.type === FormType.like)\n\t\t{\n\t\t\tif (event.delayed)\n\t\t\t{\n\t\t\t\tthis.showFormTimeout = setTimeout(() => {\n\t\t\t\t\tthis.showLikeForm();\n\t\t\t\t}, 5000);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.showLikeForm();\n\t\t\t}\n\t\t}\n\t\telse if (event.type === FormType.smile)\n\t\t{\n\t\t\tthis.showSmiles();\n\t\t}\n\t}\n\n\tonHideForm()\n\t{\n\t\tthis.hideForm();\n\t}\n\n\tonSendVote({data: {vote}})\n\t{\n\t\tconsole.warn('VOTE', vote);\n\t\tthis.sendVote(vote);\n\t}\n\n\tshowLikeForm()\n\t{\n\t\tif (this.application.offline)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tclearTimeout(this.showFormTimeout);\n\t\tif (!this.getWidgetModel().common.vote.enable)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tif (\n\t\t\tthis.getWidgetModel().dialog.sessionClose\n\t\t\t&& this.getWidgetModel().dialog.userVote !== VoteType.none\n\t\t)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.store.commit('widget/common', {showForm: FormType.like});\n\t}\n\n\tshowSmiles()\n\t{\n\t\tthis.store.commit('widget/common', {showForm: FormType.smile});\n\t}\n\n\tsendVote(vote)\n\t{\n\t\tconst {sessionId} = this.getWidgetModel().dialog;\n\t\tif (!sessionId)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.restClient.callMethod(RestMethod.widgetVoteSend, {\n\t\t\t'SESSION_ID': sessionId,\n\t\t\t'ACTION': vote\n\t\t}).catch(() => {\n\t\t\tthis.store.commit('widget/dialog', {userVote: VoteType.none});\n\t\t});\n\n\t\tthis.application.sendEvent({\n\t\t\ttype: SubscriptionType.userVote,\n\t\t\tdata: { vote }\n\t\t});\n\t}\n\n\thideForm()\n\t{\n\t\tclearTimeout(this.showFormTimeout);\n\n\t\tif (this.getWidgetModel().common.showForm !== FormType.none)\n\t\t{\n\t\t\tthis.store.commit('widget/common', {showForm: FormType.none});\n\t\t}\n\t}\n\n\tgetWidgetModel()\n\t{\n\t\treturn this.store.state.widget;\n\t}\n\n\tdestroy()\n\t{\n\t\tEventEmitter.unsubscribe(WidgetEventType.showForm, this.showFormHandler);\n\t\tEventEmitter.unsubscribe(WidgetEventType.hideForm, this.hideFormHandler);\n\t\tEventEmitter.unsubscribe(WidgetEventType.sendDialogVote, this.sendVoteHandler);\n\t}\n}","import { ReactionHandler } from 'im.event-handler';\nimport { Logger } from 'im.lib.logger';\n\nexport class WidgetReactionHandler extends ReactionHandler\n{\n\tonOpenMessageReactionList({data})\n\t{\n\t\tLogger.warn('Reactions list is blocked for the widget', data);\n\t}\n}","export class WidgetHistoryHandler\n{\n\tstore: Object = null;\n\tapplication: Object = null;\n\n\tconstructor($Bitrix)\n\t{\n\t\tthis.store = $Bitrix.Data.get('controller').store;\n\t\tthis.application = $Bitrix.Application.get();\n\t}\n\n\tgetHtmlHistory()\n\t{\n\t\tconst chatId = this.getChatId();\n\t\tif (chatId <= 0)\n\t\t{\n\t\t\tconsole.error('WidgetHistoryHandler: Incorrect chatId value');\n\t\t}\n\n\t\tconst config = { chatId: this.getChatId() };\n\t\tthis.requestControllerAction('imopenlines.widget.history.download', config)\n\t\t\t.then(this.handleRequest.bind(this))\n\t\t\t.then(this.downloadHistory.bind(this))\n\t\t\t.catch((error) => console.error('WidgetHistoryHandler: fetch error.', error));\n\t}\n\n\trequestControllerAction(action, config)\n\t{\n\t\tconst host = this.application.host ? this.application.host : '';\n\t\tconst ajaxEndpoint = '/bitrix/services/main/ajax.php';\n\n\t\tconst url = new URL(ajaxEndpoint, host);\n\t\turl.searchParams.set('action', action);\n\n\t\tconst formData = new FormData();\n\t\tfor (const key in config)\n\t\t{\n\t\t\tif (config.hasOwnProperty(key))\n\t\t\t{\n\t\t\t\tformData.append(key, config[key]);\n\t\t\t}\n\t\t}\n\n\t\treturn fetch(url, {\n\t\t\tmethod: 'POST',\n\t\t\theaders: {\n\t\t\t\t'Livechat-Auth-Id': this.getUserHash()\n\t\t\t},\n\t\t\tbody: formData\n\t\t});\n\t}\n\n\thandleRequest(response)\n\t{\n\t\tconst contentType = response.headers.get('Content-Type');\n\t\tif (contentType.startsWith('application/json'))\n\t\t{\n\t\t\treturn response.json();\n\t\t}\n\n\t\treturn response.blob();\n\t}\n\n\tdownloadHistory(result)\n\t{\n\t\tif (result instanceof Blob)\n\t\t{\n\t\t\tconst url = window.URL.createObjectURL(result);\n\t\t\tconst a = document.createElement('a');\n\t\t\ta.href = url;\n\t\t\ta.download = `${this.getChatId()}.html`;\n\t\t\tdocument.body.append(a);\n\t\t\ta.click();\n\t\t\ta.remove();\n\t\t}\n\t\telse if (result.hasOwnProperty('errors'))\n\t\t{\n\t\t\tconsole.error(`WidgetHistoryHandler: ${result.errors[0]}`);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconsole.error('WidgetHistoryHandler: unknown error.');\n\t\t}\n\t}\n\n\tgetChatId()\n\t{\n\t\treturn this.store.state.application.dialog.chatId;\n\t}\n\n\tgetUserHash()\n\t{\n\t\treturn this.store.state.widget.user.hash;\n\t}\n\n\tdestroy()\n\t{\n\t\t//\n\t}\n}","import { DialogActionHandler } from \"im.event-handler\";\nimport { EventEmitter } from \"main.core.events\";\nimport { WidgetEventType } from \"../const\";\n\nexport class WidgetDialogActionHandler extends DialogActionHandler\n{\n\tonClickOnDialog()\n\t{\n\t\tEventEmitter.emit(WidgetEventType.hideForm);\n\t}\n}","/**\n * Bitrix OpenLines widget\n * LiveChat base component (Vue component)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {BitrixVue} from 'ui.vue';\nimport {Vuex} from 'ui.vue.vuex';\nimport {Utils} from 'im.lib.utils';\nimport {Logger} from 'im.lib.logger';\nimport {\n\tFormType,\n\tVoteType,\n\tLocationStyle,\n\tLocationType,\n\tLanguageType,\n\tWidgetEventType,\n\tWidgetBaseSize,\n\tWidgetMinimumSize\n} from '../const';\nimport {DeviceType, DeviceOrientation, EventType} from 'im.const';\nimport {EventEmitter} from 'main.core.events';\n\nimport {WidgetSendMessageHandler} from '../event-handler/widget-send-message-handler';\nimport {WidgetTextareaHandler} from '../event-handler/widget-textarea-handler';\nimport {WidgetTextareaUploadHandler} from '../event-handler/widget-textarea-upload-handler';\nimport {WidgetReadingHandler} from '../event-handler/widget-reading-handler';\nimport {WidgetResizeHandler} from '../event-handler/widget-resize-handler';\nimport {WidgetConsentHandler} from '../event-handler/widget-consent-handler';\nimport {WidgetFormHandler} from '../event-handler/widget-form-handler';\nimport {TextareaDragHandler} from 'im.event-handler';\nimport {WidgetReactionHandler} from '../event-handler/widget-reaction-handler';\nimport {WidgetHistoryHandler} from '../event-handler/widget-history-handler';\nimport {WidgetDialogActionHandler} from '../event-handler/widget-dialog-action-handler';\n\nBitrixVue.component('bx-livechat',\n{\n\tdata()\n\t{\n\t\treturn {\n\t\t\t// sizes\n\t\t\twidgetAvailableHeight: 0,\n\t\t\twidgetAvailableWidth: 0,\n\t\t\twidgetCurrentHeight: 0,\n\t\t\twidgetCurrentWidth: 0,\n\t\t\twidgetIsResizing: false,\n\t\t\ttextareaHeight: 100,\n\t\t\t// welcome form\n\t\t\twelcomeFormFilled: false,\n\t\t\t// multi dialog\n\t\t\tstartNewChatMode: false,\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tFormType: () => FormType,\n\t\tVoteType: () => VoteType,\n\t\tDeviceType: () => DeviceType,\n\t\tEventType: () => EventType,\n\n\t\tshowTextarea()\n\t\t{\n\t\t\tif (this.widget.common.isCreateSessionMode)\n\t\t\t{\n\t\t\t\treturn this.startNewChatMode;\n\t\t\t}\n\n\t\t\tconst {crmFormsSettings} = this.widget.common;\n\n\t\t\t// show if we dont use welcome form\n\t\t\tif (!crmFormsSettings.useWelcomeForm || !crmFormsSettings.welcomeFormId)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t// show if we use welcome form with delay, otherwise check if it was filled\n\t\t\t\treturn crmFormsSettings.welcomeFormDelay ? true : this.welcomeFormFilled;\n\t\t\t}\n\t\t},\n\t\t// for welcome CRM-form before dialog start\n\t\tshowWelcomeForm()\n\t\t{\n\t\t\t//we are using welcome form, it doesnt have delay and it was not already filled\n\t\t\treturn this.widget.common.crmFormsSettings.useWelcomeForm\n\t\t\t\t&& !this.widget.common.crmFormsSettings.welcomeFormDelay\n\t\t\t\t&& this.widget.common.crmFormsSettings.welcomeFormId\n\t\t\t\t&& !this.welcomeFormFilled;\n\t\t},\n\t\ttextareaHeightStyle()\n\t\t{\n\t\t\treturn {flex: `0 0 ${this.textareaHeight}px`};\n\t\t},\n\t\ttextareaBottomMargin()\n\t\t{\n\t\t\tif (!this.widget.common.copyright && !this.isBottomLocation())\n\t\t\t{\n\t\t\t\treturn {marginBottom: '5px'};\n\t\t\t}\n\t\t\treturn '';\n\t\t},\n\t\twidgetHeightStyle()\n\t\t{\n\t\t\tif (Utils.device.isMobile() || this.widget.common.pageMode)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.widgetAvailableHeight < WidgetBaseSize.height || this.widgetAvailableHeight < this.widgetCurrentHeight)\n\t\t\t{\n\t\t\t\tthis.widgetCurrentHeight = Math.max(this.widgetAvailableHeight, WidgetMinimumSize.height);\n\t\t\t}\n\n\t\t\treturn `${this.widgetCurrentHeight}px`;\n\t\t},\n\t\twidgetWidthStyle()\n\t\t{\n\t\t\tif (Utils.device.isMobile() || this.widget.common.pageMode)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.widgetAvailableWidth < WidgetBaseSize.width || this.widgetAvailableWidth < this.widgetCurrentWidth)\n\t\t\t{\n\t\t\t\tthis.widgetCurrentWidth = Math.max(this.widgetAvailableWidth, WidgetMinimumSize.width);\n\t\t\t}\n\n\t\t\treturn `${this.widgetCurrentWidth}px`;\n\t\t},\n\t\tuserSelectStyle()\n\t\t{\n\t\t\treturn this.widgetIsResizing ? 'none' : 'auto';\n\t\t},\n\t\twidgetMobileDisabled()\n\t\t{\n\t\t\tif (this.application.device.type !== DeviceType.mobile)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (this.application.device.orientation !== DeviceOrientation.horizontal)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (navigator.userAgent.toString().includes('iPhone'))\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\treturn (typeof window.screen !== 'object') || window.screen.availHeight < 800;\n\t\t\t}\n\t\t},\n\t\twidgetPositionClass()\n\t\t{\n\t\t\tconst className = [];\n\n\t\t\tif (this.widget.common.pageMode)\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-page-mode');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tclassName.push(`bx-livechat-position-${LocationStyle[this.widget.common.location]}`);\n\t\t\t}\n\n\t\t\treturn className;\n\t\t},\n\t\twidgetLanguageClass()\n\t\t{\n\t\t\tconst className = [];\n\n\t\t\tif (this.application.common.languageId === LanguageType.russian)\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-logo-ru');\n\t\t\t}\n\t\t\telse if (this.application.common.languageId === LanguageType.ukraine)\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-logo-ua');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-logo-en');\n\t\t\t}\n\n\t\t\treturn className;\n\t\t},\n\t\twidgetPlatformClass()\n\t\t{\n\t\t\tconst className = [];\n\n\t\t\tif (Utils.device.isMobile())\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-mobile');\n\t\t\t}\n\t\t\telse if (Utils.browser.isSafari())\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-browser-safari');\n\t\t\t}\n\t\t\telse if (Utils.browser.isIe())\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-browser-ie');\n\t\t\t}\n\n\t\t\tif (Utils.platform.isMac())\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-mac');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-custom-scroll');\n\t\t\t}\n\n\t\t\treturn className;\n\t\t},\n\t\twidgetClassName()\n\t\t{\n\t\t\tconst className = [];\n\n\t\t\tclassName.push(...this.widgetPositionClass, ...this.widgetLanguageClass, ...this.widgetPlatformClass);\n\n\t\t\tif (!this.widget.common.online)\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-offline-state');\n\t\t\t}\n\n\t\t\tif (this.widget.common.dragged)\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-drag-n-drop');\n\t\t\t}\n\n\t\t\tif (this.widget.common.dialogStart)\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-chat-start');\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\tthis.widget.dialog.operator.name\n\t\t\t\t&& !(this.application.device.type === DeviceType.mobile && this.application.device.orientation === DeviceOrientation.horizontal)\n\t\t\t)\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-has-operator');\n\t\t\t}\n\n\t\t\tif (this.widget.common.styles.backgroundColor && Utils.isDarkColor(this.widget.common.styles.iconColor))\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-bright-header');\n\t\t\t}\n\n\t\t\treturn className;\n\t\t},\n\t\tshowMessageDialog()\n\t\t{\n\t\t\treturn this.messageCollection.length > 0;\n\t\t},\n\t\tlocalize()\n\t\t{\n\t\t\treturn BitrixVue.getFilteredPhrases('BX_LIVECHAT_', this);\n\t\t},\n\t\t...Vuex.mapState({\n\t\t\twidget: state => state.widget,\n\t\t\tapplication: state => state.application,\n\t\t\tdialog: state => state.dialogues.collection[state.application.dialog.dialogId],\n\t\t\tmessageCollection: state => state.messages.collection[state.application.dialog.chatId]\n\t\t})\n\t},\n\tcreated()\n\t{\n\t\tLogger.warn('Livechat component created');\n\t\t// we need to wait for initialization and widget opening to init logic handlers\n\t\tthis.onCreated().then(() => {\n\t\t\tthis.subscribeToEvents();\n\t\t\tthis.initEventHandlers();\n\t\t});\n\t},\n\tmounted()\n\t{\n\t\tif (this.widget.user.id > 0)\n\t\t{\n\t\t\tthis.welcomeFormFilled = true;\n\t\t}\n\t\tthis.registerZIndex();\n\t},\n\tbeforeDestroy()\n\t{\n\t\tthis.unsubscribeEvents();\n\t\tthis.destroyHandlers();\n\t\tthis.unregisterZIndex();\n\t},\n\tmethods:\n\t{\n\t\t// region initialization\n\t\tinitEventHandlers()\n\t\t{\n\t\t\tthis.sendMessageHandler = new WidgetSendMessageHandler(this.$Bitrix);\n\t\t\tthis.textareaHandler = new WidgetTextareaHandler(this.$Bitrix);\n\t\t\tthis.textareaUploadHandler = new WidgetTextareaUploadHandler(this.$Bitrix);\n\t\t\tthis.readingHandler = new WidgetReadingHandler(this.$Bitrix);\n\t\t\tthis.consentHandler = new WidgetConsentHandler(this.$Bitrix);\n\t\t\tthis.formHandler = new WidgetFormHandler(this.$Bitrix);\n\t\t\tthis.textareaDragHandler = this.getTextareaDragHandler();\n\t\t\tthis.resizeHandler = this.getWidgetResizeHandler();\n\t\t\tthis.reactionHandler = new WidgetReactionHandler(this.$Bitrix);\n\t\t\tthis.historyHandler = new WidgetHistoryHandler(this.$Bitrix);\n\t\t\tthis.dialogActionHandler = new WidgetDialogActionHandler(this.$Bitrix);\n\t\t},\n\t\tdestroyHandlers()\n\t\t{\n\t\t\tthis.sendMessageHandler.destroy();\n\t\t\tthis.textareaHandler.destroy();\n\t\t\tthis.textareaUploadHandler.destroy();\n\t\t\tthis.readingHandler.destroy();\n\t\t\tthis.consentHandler.destroy();\n\t\t\tthis.formHandler.destroy();\n\t\t\tthis.textareaDragHandler.destroy();\n\t\t\tthis.resizeHandler.destroy();\n\t\t\tthis.reactionHandler.destroy();\n\t\t\tthis.historyHandler.destroy();\n\t\t\tthis.dialogActionHandler.destroy();\n\t\t},\n\t\tsubscribeToEvents()\n\t\t{\n\t\t\tdocument.addEventListener('keydown', this.onWindowKeyDown);\n\n\t\t\tif (!Utils.device.isMobile() && !this.widget.common.pageMode)\n\t\t\t{\n\t\t\t\tthis.getAvailableSpaceFunc = Utils.throttle(this.getAvailableSpace, 50);\n\t\t\t\twindow.addEventListener('resize', this.getAvailableSpaceFunc);\n\t\t\t}\n\t\t},\n\t\tunsubscribeEvents()\n\t\t{\n\t\t\tdocument.removeEventListener('keydown', this.onWindowKeyDown);\n\n\t\t\tif (!Utils.device.isMobile() && !this.widget.common.pageMode)\n\t\t\t{\n\t\t\t\twindow.removeEventListener('resize', this.getAvailableSpaceFunc);\n\t\t\t}\n\t\t},\n\t\tinitMobileEnv(): Promise\n\t\t{\n\t\t\tconst metaTags = document.head.querySelectorAll('meta');\n\t\t\tconst viewPortMetaSiteNode = [...metaTags].find(element => element.name === 'viewport');\n\n\t\t\tif (viewPortMetaSiteNode)\n\t\t\t{\n\t\t\t\t// save tag and remove it from DOM\n\t\t\t\tthis.viewPortMetaSiteNode = viewPortMetaSiteNode;\n\t\t\t\tthis.viewPortMetaSiteNode.remove();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.createViewportMeta();\n\t\t\t}\n\n\t\t\tif (!this.viewPortMetaWidgetNode)\n\t\t\t{\n\t\t\t\tthis.viewPortMetaWidgetNode = document.createElement('meta');\n\t\t\t\tthis.viewPortMetaWidgetNode.setAttribute('name', 'viewport');\n\t\t\t\tthis.viewPortMetaWidgetNode.setAttribute('content', 'width=device-width, initial-scale=1.0, user-scalable=0');\n\t\t\t\tdocument.head.append(this.viewPortMetaWidgetNode);\n\t\t\t}\n\n\t\t\tdocument.body.classList.add('bx-livechat-mobile-state');\n\n\t\t\tif (Utils.browser.isSafariBased())\n\t\t\t{\n\t\t\t\tdocument.body.classList.add('bx-livechat-mobile-safari-based');\n\t\t\t}\n\n\t\t\treturn new Promise((resolve) => {\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tthis.$store.dispatch('widget/show').then(resolve);\n\t\t\t\t}, 50);\n\t\t\t});\n\t\t},\n\t\tcreateViewportMeta()\n\t\t{\n\t\t\tlet contentWidth = document.body.offsetWidth;\n\t\t\tif (contentWidth < window.innerWidth)\n\t\t\t{\n\t\t\t\tcontentWidth = window.innerWidth;\n\t\t\t}\n\t\t\tif (contentWidth < 1024)\n\t\t\t{\n\t\t\t\tcontentWidth = 1024;\n\t\t\t}\n\n\t\t\tthis.viewPortMetaSiteNode = document.createElement('meta');\n\t\t\tthis.viewPortMetaSiteNode.setAttribute('name', 'viewport');\n\t\t\tthis.viewPortMetaSiteNode.setAttribute('content', `width=${contentWidth}, initial-scale=1.0, user-scalable=1`);\n\t\t},\n\t\tremoveMobileEnv()\n\t\t{\n\t\t\tdocument.body.classList.remove('bx-livechat-mobile-state');\n\n\t\t\tif (Utils.browser.isSafariBased())\n\t\t\t{\n\t\t\t\tdocument.body.classList.remove('bx-livechat-mobile-safari-based');\n\t\t\t}\n\n\t\t\tif (this.viewPortMetaWidgetNode)\n\t\t\t{\n\t\t\t\tthis.viewPortMetaWidgetNode.remove();\n\t\t\t\tthis.viewPortMetaWidgetNode = null;\n\t\t\t}\n\n\t\t\tif (this.viewPortMetaSiteNode)\n\t\t\t{\n\t\t\t\tdocument.head.append(this.viewPortMetaSiteNode);\n\t\t\t\tthis.viewPortMetaSiteNode = null;\n\t\t\t}\n\t\t},\n\t\tonCreated(): Promise\n\t\t{\n\t\t\treturn new Promise((resolve) => {\n\t\t\t\tif (Utils.device.isMobile())\n\t\t\t\t{\n\t\t\t\t\tthis.initMobileEnv().then(resolve);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.$store.dispatch('widget/show').then(() => {\n\t\t\t\t\t\tthis.widgetCurrentHeight = WidgetBaseSize.height;\n\t\t\t\t\t\tthis.widgetCurrentWidth = WidgetBaseSize.width;\n\t\t\t\t\t\tthis.getAvailableSpace();\n\n\t\t\t\t\t\t// restore widget size from cache\n\t\t\t\t\t\tthis.widgetCurrentHeight = this.widget.common.widgetHeight || this.widgetCurrentHeight;\n\t\t\t\t\t\tthis.widgetCurrentWidth = this.widget.common.widgetWidth || this.widgetCurrentWidth;\n\n\t\t\t\t\t\tresolve();\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\t// restore textarea size from cache\n\t\t\t\tthis.textareaHeight = this.widget.common.textareaHeight || this.textareaHeight;\n\t\t\t\tthis.initCollections();\n\t\t\t});\n\t\t},\n\t\tinitCollections()\n\t\t{\n\t\t\tthis.$store.commit('files/initCollection', { chatId: this.getApplication().getChatId() });\n\t\t\tthis.$store.commit('messages/initCollection', { chatId: this.getApplication().getChatId() });\n\t\t\tthis.$store.commit('dialogues/initCollection', {\n\t\t\t\tdialogId: this.getApplication().getDialogId(),\n\t\t\t\tfields: {\n\t\t\t\t\tentityType: 'LIVECHAT',\n\t\t\t\t\ttype: 'livechat'\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\t// endregion initialization\n\t\t// region events\n\t\tonBeforeClose()\n\t\t{\n\t\t\tif (Utils.device.isMobile())\n\t\t\t{\n\t\t\t\tthis.removeMobileEnv();\n\t\t\t}\n\t\t},\n\t\tonAfterClose()\n\t\t{\n\t\t\tthis.getApplication().close();\n\t\t},\n\t\tonOpenMenu()\n\t\t{\n\t\t\tthis.historyHandler.getHtmlHistory();\n\t\t},\n\t\tonPullRequestConfig()\n\t\t{\n\t\t\tthis.getApplication().recoverPullConnection();\n\t\t},\n\t\tonSmilesSelectSmile(event)\n\t\t{\n\t\t\tEventEmitter.emit(EventType.textarea.insertText, {text: event.text});\n\t\t},\n\t\tonSmilesSelectSet()\n\t\t{\n\t\t\tEventEmitter.emit(EventType.textarea.setFocus);\n\t\t},\n\t\tonWidgetStartDrag(event)\n\t\t{\n\t\t\tthis.resizeHandler.startResize(event, this.widgetCurrentHeight, this.widgetCurrentWidth);\n\t\t\tthis.widgetIsResizing = true;\n\t\t\tEventEmitter.emit(EventType.textarea.setBlur, true);\n\t\t},\n\t\tonWindowKeyDown(event)\n\t\t{\n\t\t\t// not escape\n\t\t\tif (event.keyCode !== 27)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// hide form\n\t\t\tif (this.widget.common.showForm !== FormType.none)\n\t\t\t{\n\t\t\t\tthis.$store.commit('widget/common', {showForm: FormType.none});\n\t\t\t}\n\t\t\t// decline consent\n\t\t\telse if (this.widget.common.showConsent)\n\t\t\t{\n\t\t\t\tEventEmitter.emit(WidgetEventType.declineConsent);\n\t\t\t}\n\t\t\t// close widget\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.close();\n\t\t\t}\n\n\t\t\tevent.preventDefault();\n\t\t\tevent.stopPropagation();\n\n\t\t\tEventEmitter.emit(EventType.textarea.setFocus);\n\t\t},\n\t\tonWelcomeFormSendSuccess()\n\t\t{\n\t\t\tthis.welcomeFormFilled = true;\n\t\t},\n\t\tonWelcomeFormSendError(error)\n\t\t{\n\t\t\tconsole.error('onWelcomeFormSendError', error);\n\t\t\tthis.welcomeFormFilled = true;\n\t\t},\n\t\tonTextareaStartDrag(event)\n\t\t{\n\t\t\tthis.textareaDragHandler.onStartDrag(event, this.textareaHeight);\n\t\t\tEventEmitter.emit(EventType.textarea.setBlur, true);\n\t\t},\n\t\topenDialogList()\n\t\t{\n\t\t\tthis.$store.commit('widget/common', {isCreateSessionMode: !this.widget.common.isCreateSessionMode});\n\t\t\tthis.startNewChatMode = false;\n\t\t},\n\t\tonStartNewChat()\n\t\t{\n\t\t\tthis.startNewChatMode = true;\n\t\t},\n\t\t// endregion events\n\t\t// region helpers\n\t\tgetApplication()\n\t\t{\n\t\t\treturn this.$Bitrix.Application.get();\n\t\t},\n\t\tclose()\n\t\t{\n\t\t\tif (this.widget.common.pageMode)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tthis.onBeforeClose();\n\t\t\tthis.$store.commit('widget/common', {showed: false});\n\t\t},\n\t\t// how much width and height we have for resizing\n\t\tgetAvailableSpace()\n\t\t{\n\t\t\tconst widgetMargin = 50;\n\t\t\tif (this.isBottomLocation())\n\t\t\t{\n\t\t\t\tconst bottomPosition = this.$refs.widgetWrapper.getBoundingClientRect().bottom;\n\t\t\t\tconst widgetBottomMargin = window.innerHeight - bottomPosition;\n\t\t\t\tthis.widgetAvailableHeight = window.innerHeight - widgetMargin - widgetBottomMargin;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst topPosition = this.$refs.widgetWrapper.getBoundingClientRect().top;\n\t\t\t\tthis.widgetAvailableHeight = window.innerHeight - widgetMargin - topPosition;\n\t\t\t}\n\n\t\t\tthis.widgetAvailableWidth = window.innerWidth - widgetMargin * 2;\n\n\t\t\tif (this.resizeHandler)\n\t\t\t{\n\t\t\t\tthis.resizeHandler.setAvailableWidth(this.widgetAvailableWidth);\n\t\t\t\tthis.resizeHandler.setAvailableHeight(this.widgetAvailableHeight);\n\t\t\t}\n\t\t},\n\t\tgetTextareaDragHandler(): TextareaDragHandler\n\t\t{\n\t\t\treturn new TextareaDragHandler({\n\t\t\t\t[TextareaDragHandler.events.onHeightChange]: ({data}) => {\n\t\t\t\t\tconst {newHeight} = data;\n\t\t\t\t\tif (this.textareaHeight !== newHeight)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.textareaHeight = newHeight;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t[TextareaDragHandler.events.onStopDrag]: () => {\n\t\t\t\t\tthis.$store.commit('widget/common', {textareaHeight: this.textareaHeight});\n\t\t\t\t\tEventEmitter.emit(EventType.dialog.scrollToBottom, {chatId: this.chatId, force: true});\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tgetWidgetResizeHandler(): WidgetResizeHandler\n\t\t{\n\t\t\treturn new WidgetResizeHandler({\n\t\t\t\twidgetLocation: this.widget.common.location,\n\t\t\t\tavailableWidth: this.widgetAvailableWidth,\n\t\t\t\tavailableHeight: this.widgetAvailableHeight,\n\t\t\t\tevents: {\n\t\t\t\t\t[WidgetResizeHandler.events.onSizeChange]: ({data}) => {\n\t\t\t\t\t\tconst {newHeight, newWidth} = data;\n\t\t\t\t\t\tif (this.widgetCurrentHeight !== newHeight)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.widgetCurrentHeight = newHeight;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (this.widgetCurrentWidth !== newWidth)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.widgetCurrentWidth = newWidth;\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t[WidgetResizeHandler.events.onStopResize]: () => {\n\t\t\t\t\t\tthis.widgetIsResizing = false;\n\t\t\t\t\t\tthis.$store.commit('widget/common', {widgetHeight: this.widgetCurrentHeight, widgetWidth: this.widgetCurrentWidth});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tisBottomLocation()\n\t\t{\n\t\t\treturn [LocationType.bottomLeft, LocationType.bottomMiddle, LocationType.bottomRight].includes(this.widget.common.location);\n\t\t},\n\t\tisPageMode()\n\t\t{\n\t\t\treturn this.widget.common.pageMode;\n\t\t},\n\t\tregisterZIndex()\n\t\t{\n\t\t\tthis.zIndexStackInstance = this.$Bitrix.Data.get('zIndexStack');\n\t\t\tif (this.zIndexStackInstance && !!this.$refs.widgetWrapper)\n\t\t\t{\n\t\t\t\tthis.zIndexStackInstance.register(this.$refs.widgetWrapper);\n\t\t\t}\n\t\t},\n\t\tunregisterZIndex()\n\t\t{\n\t\t\tif (this.zIndexStackInstance)\n\t\t\t{\n\t\t\t\tthis.zIndexStackInstance.unregister(this.$refs.widgetWrapper);\n\t\t\t}\n\t\t}\n\t\t// endregion helpers\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<transition enter-active-class=\"bx-livechat-show\" leave-active-class=\"bx-livechat-close\" @after-leave=\"onAfterClose\">\n\t\t\t<div\n\t\t\t\t:class=\"widgetClassName\"\n\t\t\t\tv-if=\"widget.common.showed\"\n\t\t\t\t:style=\"{height: widgetHeightStyle, width: widgetWidthStyle, userSelect: userSelectStyle}\"\n\t\t\t\tclass=\"bx-livechat-wrapper bx-livechat-show\"\n\t\t\t\tref=\"widgetWrapper\"\n\t\t\t>\n\t\t\t\t<div class=\"bx-livechat-box\">\n\t\t\t\t\t<div v-if=\"isBottomLocation() && !isPageMode()\" class=\"bx-livechat-widget-resize-handle\" @mousedown=\"onWidgetStartDrag\"></div>\n\t\t\t\t\t<bx-livechat-head \n\t\t\t\t\t\t:isWidgetDisabled=\"widgetMobileDisabled\" \n\t\t\t\t\t\t@openMenu=\"onOpenMenu\" \n\t\t\t\t\t\t@close=\"close\"\n\t\t\t\t\t\t@openDialogList=\"openDialogList\"\n\t\t\t\t\t/>\n\t\t\t\t\t<template v-if=\"widgetMobileDisabled\">\n\t\t\t\t\t\t<bx-livechat-body-orientation-disabled/>\n\t\t\t\t\t</template>\n\t\t\t\t\t<template v-else-if=\"application.error.active\">\n\t\t\t\t\t\t<bx-livechat-body-error/>\n\t\t\t\t\t</template>\n\t\t\t\t\t<template v-else-if=\"!widget.common.configId\">\n\t\t\t\t\t\t<div class=\"bx-livechat-body\" key=\"loading-body\">\n\t\t\t\t\t\t\t<bx-livechat-body-loading/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</template>\n\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t<div v-show=\"!widget.common.dialogStart\" class=\"bx-livechat-body\" :class=\"{'bx-livechat-body-with-scroll': showWelcomeForm}\" key=\"welcome-body\">\n\t\t\t\t\t\t\t<bx-imopenlines-form\n\t\t\t\t\t\t\t  v-show=\"showWelcomeForm\"\n\t\t\t\t\t\t\t  @formSendSuccess=\"onWelcomeFormSendSuccess\"\n\t\t\t\t\t\t\t  @formSendError=\"onWelcomeFormSendError\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<template v-if=\"!showWelcomeForm\">\n\t\t\t\t\t\t\t\t<bx-livechat-body-operators/>\n\t\t\t\t\t\t\t\t<keep-alive include=\"bx-livechat-smiles\">\n\t\t\t\t\t\t\t\t\t<template v-if=\"widget.common.showForm === FormType.smile\">\n\t\t\t\t\t\t\t\t\t\t<bx-livechat-smiles @selectSmile=\"onSmilesSelectSmile\" @selectSet=\"onSmilesSelectSet\"/>\n\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t</keep-alive>\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<template v-if=\"widget.common.dialogStart\">\n\t\t\t\t\t\t\t<bx-pull-component-status :canReconnect=\"true\" @reconnect=\"onPullRequestConfig\"/>\n\t\t\t\t\t\t\t<div :class=\"['bx-livechat-body', {'bx-livechat-body-with-message': showMessageDialog}]\" key=\"with-message\">\n\t\t\t\t\t\t\t\t<template v-if=\"widget.common.isCreateSessionMode\">\n\t\t\t\t\t\t\t\t\t<bx-livechat-dialogues-list @startNewChat=\"onStartNewChat\"/>\n\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t<template v-else-if=\"showMessageDialog\">\n\t\t\t\t\t\t\t\t\t<div class=\"bx-livechat-dialog\">\n\t\t\t\t\t\t\t\t\t\t<bx-im-component-dialog\n\t\t\t\t\t\t\t\t\t\t\t:userId=\"application.common.userId\"\n\t\t\t\t\t\t\t\t\t\t\t:dialogId=\"application.dialog.dialogId\"\n\t\t\t\t\t\t\t\t\t\t\t:messageLimit=\"application.dialog.messageLimit\"\n\t\t\t\t\t\t\t\t\t\t\t:enableReactions=\"true\"\n\t\t\t\t\t\t\t\t\t\t\t:enableDateActions=\"false\"\n\t\t\t\t\t\t\t\t\t\t\t:enableCreateContent=\"false\"\n\t\t\t\t\t\t\t\t\t\t\t:enableGestureQuote=\"true\"\n\t\t\t\t\t\t\t\t\t\t\t:enableGestureMenu=\"true\"\n\t\t\t\t\t\t\t\t\t\t\t:showMessageAvatar=\"false\"\n\t\t\t\t\t\t\t\t\t\t\t:showMessageMenu=\"false\"\n\t\t\t\t\t\t\t\t\t\t\t:skipDataRequest=\"true\"\n\t\t\t\t\t\t\t\t\t\t\t:showLoadingState=\"false\"\n\t\t\t\t\t\t\t\t\t\t\t:showEmptyState=\"false\"\n\t\t\t\t\t\t\t\t\t\t />\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t\t\t\t<bx-livechat-body-loading/>\n\t\t\t\t\t\t\t\t</template>\n\n\t\t\t\t\t\t\t\t<keep-alive include=\"bx-livechat-smiles\">\n\t\t\t\t\t\t\t\t\t<template v-if=\"widget.common.showForm === FormType.like && widget.common.vote.enable\">\n\t\t\t\t\t\t\t\t\t\t<bx-livechat-form-vote/>\n\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t\t<template v-else-if=\"widget.common.showForm === FormType.welcome\">\n\t\t\t\t\t\t\t\t\t\t<bx-livechat-form-welcome/>\n\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t\t<template v-else-if=\"widget.common.showForm === FormType.offline\">\n\t\t\t\t\t\t\t\t\t\t<bx-livechat-form-offline/>\n\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t\t<template v-else-if=\"widget.common.showForm === FormType.history\">\n\t\t\t\t\t\t\t\t\t\t<bx-livechat-form-history/>\n\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t\t<template v-else-if=\"widget.common.showForm === FormType.smile\">\n\t\t\t\t\t\t\t\t\t\t<bx-livechat-smiles @selectSmile=\"onSmilesSelectSmile\" @selectSet=\"onSmilesSelectSet\"/>\n\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t</keep-alive>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t\t<div v-if=\"showTextarea || startNewChatMode\" class=\"bx-livechat-textarea\" :style=\"[textareaHeightStyle, textareaBottomMargin]\" ref=\"textarea\">\n\t\t\t\t\t\t\t<div class=\"bx-livechat-textarea-resize-handle\" @mousedown=\"onTextareaStartDrag\" @touchstart=\"onTextareaStartDrag\"></div>\n\t\t\t\t\t\t\t<bx-im-component-textarea\n\t\t\t\t\t\t\t\t:siteId=\"application.common.siteId\"\n\t\t\t\t\t\t\t\t:userId=\"application.common.userId\"\n\t\t\t\t\t\t\t\t:dialogId=\"application.dialog.dialogId\"\n\t\t\t\t\t\t\t\t:writesEventLetter=\"3\"\n\t\t\t\t\t\t\t\t:enableEdit=\"true\"\n\t\t\t\t\t\t\t\t:enableCommand=\"false\"\n\t\t\t\t\t\t\t\t:enableMention=\"false\"\n\t\t\t\t\t\t\t\t:enableFile=\"application.disk.enabled\"\n\t\t\t\t\t\t\t\t:autoFocus=\"application.device.type !== DeviceType.mobile\"\n\t\t\t\t\t\t\t\t:styles=\"{button: {backgroundColor: widget.common.styles.backgroundColor, iconColor: widget.common.styles.iconColor}}\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div v-if=\"!widget.common.copyright && !isBottomLocation\" class=\"bx-livechat-nocopyright-resize-wrap\" style=\"position: relative;\">\n\t\t\t\t\t\t\t<div class=\"bx-livechat-widget-resize-handle\" @mousedown=\"onWidgetStartDrag\"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<bx-livechat-form-consent />\n\t\t\t\t\t\t<template v-if=\"widget.common.copyright\">\n\t\t\t\t\t\t\t<div class=\"bx-livechat-copyright\">\n\t\t\t\t\t\t\t\t<template v-if=\"widget.common.copyrightUrl\">\n\t\t\t\t\t\t\t\t\t<a class=\"bx-livechat-copyright-link\" :href=\"widget.common.copyrightUrl\" target=\"_blank\">\n\t\t\t\t\t\t\t\t\t\t<span class=\"bx-livechat-logo-name\">{{localize.BX_LIVECHAT_COPYRIGHT_TEXT}}</span>\n\t\t\t\t\t\t\t\t\t\t<span class=\"bx-livechat-logo-icon\"></span>\n\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t\t\t\t<span class=\"bx-livechat-logo-name\">{{localize.BX_LIVECHAT_COPYRIGHT_TEXT}}</span>\n\t\t\t\t\t\t\t\t\t<span class=\"bx-livechat-logo-icon\"></span>\n\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t<div v-if=\"!isBottomLocation() && !isPageMode()\" class=\"bx-livechat-widget-resize-handle\" @mousedown=\"onWidgetStartDrag\"></div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</template>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</transition>\n\t`\n});\n","/**\n * Bitrix OpenLines widget\n * Body error component (Vue component)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {BitrixVue} from \"ui.vue\";\nimport {Vuex} from \"ui.vue.vuex\";\n\nBitrixVue.component('bx-livechat-body-error',\n{\n\tcomputed:\n\t{\n\t\t...Vuex.mapState({\n\t\t\tapplication: state => state.application\n\t\t}),\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-livechat-body\" key=\"error-body\">\n\t\t\t<div class=\"bx-livechat-warning-window\">\n\t\t\t\t<div class=\"bx-livechat-warning-icon\"></div>\n\t\t\t\t<template v-if=\"application.error.description\"> \n\t\t\t\t\t<div class=\"bx-livechat-help-title bx-livechat-help-title-sm bx-livechat-warning-msg\" v-html=\"application.error.description\"></div>\n\t\t\t\t</template> \n\t\t\t\t<template v-else>\n\t\t\t\t\t<div class=\"bx-livechat-help-title bx-livechat-help-title-md bx-livechat-warning-msg\">{{$Bitrix.Loc.getMessage('BX_LIVECHAT_ERROR_TITLE')}}</div>\n\t\t\t\t\t<div class=\"bx-livechat-help-title bx-livechat-help-title-sm bx-livechat-warning-msg\">{{$Bitrix.Loc.getMessage('BX_LIVECHAT_ERROR_DESC')}}</div>\n\t\t\t\t</template> \n\t\t\t</div>\n\t\t</div>\n\t`\n});\n","/**\n * Bitrix OpenLines widget\n * Head component (Vue component)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {BitrixVue} from 'ui.vue';\nimport {Vuex} from 'ui.vue.vuex';\nimport {WidgetEventType, FormType, SessionStatus, VoteType} from '../const';\nimport {EventType} from 'im.const';\nimport {Browser} from 'main.core.minimal';\nimport {EventEmitter} from 'main.core.events';\n\nBitrixVue.component('bx-livechat-head',\n{\n\t/**\n\t * @emits 'close'\n\t * @emits 'like'\n\t * @emits 'history'\n\t */\n\tprops:\n\t{\n\t\tisWidgetDisabled: { default: false },\n\t},\n\tdata()\n\t{\n\t\treturn {\n\t\t\tmultiDialog: false // disabled because of beta status\n\t\t};\n\t},\n\tmethods:\n\t{\n\t\topenDialogList()\n\t\t{\n\t\t\tEventEmitter.emit(WidgetEventType.hideForm);\n\t\t\tthis.$emit('openDialogList');\n\t\t},\n\t\tclose(event)\n\t\t{\n\t\t\tthis.$emit('close');\n\t\t},\n\t\tlike()\n\t\t{\n\t\t\tEventEmitter.emit(WidgetEventType.showForm, {\n\t\t\t\ttype: FormType.like\n\t\t\t});\n\t\t},\n\t\topenMenu(event)\n\t\t{\n\t\t\tthis.$emit('openMenu', event);\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tVoteType: () => VoteType,\n\n\t\tchatId()\n\t\t{\n\t\t\tif (this.application)\n\t\t\t{\n\t\t\t\treturn this.application.dialog.chatId;\n\t\t\t}\n\t\t},\n\n\t\tcustomBackgroundStyle(state)\n\t\t{\n\t\t\treturn state.widget.common.styles.backgroundColor? 'background-color: '+state.widget.common.styles.backgroundColor+'!important;': '';\n\t\t},\n\t\tcustomBackgroundOnlineStyle(state)\n\t\t{\n\t\t\treturn state.widget.common.styles.backgroundColor? 'border-color: '+state.widget.common.styles.backgroundColor+'!important;': '';\n\t\t},\n\t\tshowName(state)\n\t\t{\n\t\t\treturn state.widget.dialog.operator.firstName || state.widget.dialog.operator.lastName;\n\t\t},\n\t\tvoteActive(state)\n\t\t{\n\t\t\tif (!!state.widget.dialog.closeVote)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\t!state.widget.common.vote.beforeFinish\n\t\t\t\t&& state.widget.dialog.sessionStatus < SessionStatus.waitClient\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (!state.widget.dialog.sessionClose || state.widget.dialog.sessionClose && state.widget.dialog.userVote === VoteType.none)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tif (state.widget.dialog.sessionClose && state.widget.dialog.userVote !== VoteType.none)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\treturn false;\n\t\t},\n\t\tchatTitle(state)\n\t\t{\n\t\t\treturn state.widget.common.textMessages.bxLivechatTitle\n\t\t\t\t|| state.widget.common.configName\n\t\t\t\t|| this.localize.BX_LIVECHAT_TITLE\n\t\t},\n\t\toperatorName(state)\n\t\t{\n\t\t\tif (!this.showName)\n\t\t\t\treturn '';\n\n\t\t\treturn state.widget.dialog.operator.firstName? state.widget.dialog.operator.firstName: state.widget.dialog.operator.name\n\t\t},\n\t\toperatorDescription(state)\n\t\t{\n\t\t\tif (!this.showName)\n\t\t\t{\n\t\t\t\treturn '';\n\t\t\t}\n\n\t\t\tconst operatorPosition = state.widget.dialog.operator.workPosition? state.widget.dialog.operator.workPosition: this.localize.BX_LIVECHAT_USER;\n\n\t\t\tif (state.widget.common.showSessionId && state.widget.dialog.sessionId >= 0)\n\t\t\t{\n\t\t\t\treturn this.localize.BX_LIVECHAT_OPERATOR_POSITION_AND_SESSION_ID\n\t\t\t\t\t.replace(\"#POSITION#\", operatorPosition)\n\t\t\t\t\t.replace(\"#ID#\", state.widget.dialog.sessionId);\n\t\t\t}\n\n\t\t\treturn this.localize.BX_LIVECHAT_OPERATOR_POSITION_ONLY.replace(\"#POSITION#\", operatorPosition);\n\t\t},\n\n\t\tlocalize()\n\t\t{\n\t\t\treturn BitrixVue.getFilteredPhrases('BX_LIVECHAT_', this);\n\t\t},\n\n\t\tie11()\n\t\t{\n\t\t\treturn Browser.isIE11();\n\t\t},\n\t\t...Vuex.mapState({\n\t\t\twidget: state => state.widget,\n\t\t\tapplication: state => state.application,\n\t\t})\n\t},\n\twatch:\n\t{\n\t\tshowName(value)\n\t\t{\n\t\t\tif (value)\n\t\t\t{\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tthis.$root.$emit(EventType.dialog.scrollToBottom, {chatId: this.chatId});\n\t\t\t\t}, 300);\n\t\t\t}\n\t\t},\n\t},\n\t//language=Vue\n\ttemplate: `\n\t\t<div class=\"bx-livechat-head-wrap\">\n\t\t\t<template v-if=\"isWidgetDisabled\">\n\t\t\t\t<div class=\"bx-livechat-head\" :style=\"customBackgroundStyle\">\n\t\t\t\t\t<div class=\"bx-livechat-title\">{{chatTitle}}</div>\n\t\t\t\t\t<div class=\"bx-livechat-control-box\">\n\t\t\t\t\t\t<button v-if=\"!widget.common.pageMode\" class=\"bx-livechat-control-btn bx-livechat-control-btn-close\" :title=\"localize.BX_LIVECHAT_CLOSE_BUTTON\" @click=\"close\"></button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\t\n\t\t\t</template>\n\t\t\t<template v-else-if=\"application.error.active\">\n\t\t\t\t<div class=\"bx-livechat-head\" :style=\"customBackgroundStyle\">\n\t\t\t\t\t<div class=\"bx-livechat-title\">{{chatTitle}}</div>\n\t\t\t\t\t<div class=\"bx-livechat-control-box\">\n\t\t\t\t\t\t<button v-if=\"!widget.common.pageMode\" class=\"bx-livechat-control-btn bx-livechat-control-btn-close\" :title=\"localize.BX_LIVECHAT_CLOSE_BUTTON\" @click=\"close\"></button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t\t<template v-else-if=\"!widget.common.configId\">\n\t\t\t\t<div class=\"bx-livechat-head\" :style=\"customBackgroundStyle\">\n\t\t\t\t\t<div class=\"bx-livechat-title\">{{chatTitle}}</div>\n\t\t\t\t\t<div class=\"bx-livechat-control-box\">\n\t\t\t\t\t\t<button v-if=\"!widget.common.pageMode\" class=\"bx-livechat-control-btn bx-livechat-control-btn-close\" :title=\"localize.BX_LIVECHAT_CLOSE_BUTTON\" @click=\"close\"></button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</template>\t\t\t\n\t\t\t<template v-else>\n\t\t\t\t<div class=\"bx-livechat-head\" :style=\"customBackgroundStyle\">\n\t\t\t\t\t<template v-if=\"!showName\">\n\t\t\t\t\t\t<div class=\"bx-livechat-title\">{{chatTitle}}</div>\n\t\t\t\t\t</template>\n\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t<div class=\"bx-livechat-user bx-livechat-status-online\">\n\t\t\t\t\t\t\t<template v-if=\"widget.dialog.operator.avatar\">\n\t\t\t\t\t\t\t\t<div class=\"bx-livechat-user-icon\" :style=\"'background-image: url('+encodeURI(widget.dialog.operator.avatar)+')'\">\n\t\t\t\t\t\t\t\t\t<div v-if=\"widget.dialog.operator.online\" class=\"bx-livechat-user-status\" :style=\"customBackgroundOnlineStyle\"></div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t\t\t<div class=\"bx-livechat-user-icon\">\n\t\t\t\t\t\t\t\t\t<div v-if=\"widget.dialog.operator.online\" class=\"bx-livechat-user-status\" :style=\"customBackgroundOnlineStyle\"></div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"bx-livechat-user-info\">\n\t\t\t\t\t\t\t<div class=\"bx-livechat-user-name\">{{operatorName}}</div>\n\t\t\t\t\t\t\t<div class=\"bx-livechat-user-position\">{{operatorDescription}}</div>\t\t\t\t\t\t\t\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</template>\n\t\t\t\t\t<div class=\"bx-livechat-control-box\">\n\t\t\t\t\t\t<span class=\"bx-livechat-control-box-active\" v-if=\"widget.common.dialogStart && widget.dialog.sessionId\">\n\t\t\t\t\t\t\t<button v-if=\"widget.common.vote.enable && voteActive\" :class=\"'bx-livechat-control-btn bx-livechat-control-btn-like bx-livechat-dialog-vote-'+(widget.dialog.userVote)\" :title=\"localize.BX_LIVECHAT_VOTE_BUTTON\" @click=\"like\"></button>\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\tv-if=\"!ie11 && application.dialog.chatId > 0\"\n\t\t\t\t\t\t\t\tclass=\"bx-livechat-control-btn bx-livechat-control-btn-menu\"\n\t\t\t\t\t\t\t\t@click=\"openMenu\"\n\t\t\t\t\t\t\t\t:title=\"localize.BX_LIVECHAT_DOWNLOAD_HISTORY\"\n\t\t\t\t\t\t\t></button>\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\tv-if=\"multiDialog && application.dialog.chatId > 0\"\n\t\t\t\t\t\t\t\tclass=\"bx-livechat-control-btn bx-livechat-control-btn-list\"\n\t\t\t\t\t\t\t\t@click=\"openDialogList\"\n\t\t\t\t\t\t\t></button>\n\t\t\t\t\t\t</span>\t\n\t\t\t\t\t\t<button v-if=\"!widget.common.pageMode\" class=\"bx-livechat-control-btn bx-livechat-control-btn-close\" :title=\"localize.BX_LIVECHAT_CLOSE_BUTTON\" @click=\"close\"></button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t</div>\n\t`\n});","/**\n * Bitrix OpenLines widget\n * Body loading component (Vue component)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {BitrixVue} from \"ui.vue\";\n\nBitrixVue.component('bx-livechat-body-loading',\n{\n\ttemplate: `\n\t\t<div class=\"bx-livechat-loading-window\">\n\t\t\t<svg class=\"bx-livechat-loading-circular\" viewBox=\"25 25 50 50\">\n\t\t\t\t<circle class=\"bx-livechat-loading-path\" cx=\"50\" cy=\"50\" r=\"20\" fill=\"none\" stroke-miterlimit=\"10\"/>\n\t\t\t\t<circle class=\"bx-livechat-loading-inner-path\" cx=\"50\" cy=\"50\" r=\"20\" fill=\"none\" stroke-miterlimit=\"10\"/>\n\t\t\t</svg>\n\t\t\t<h3 class=\"bx-livechat-help-title bx-livechat-help-title-md bx-livechat-loading-msg\">{{$Bitrix.Loc.getMessage('BX_LIVECHAT_LOADING')}}</h3>\n\t\t</div>\n\t`\n});","/**\n * Bitrix OpenLines widget\n * Body operators component (Vue component)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {BitrixVue} from \"ui.vue\";\nimport {Vuex} from \"ui.vue.vuex\";\n\nBitrixVue.component('bx-livechat-body-operators',\n{\n\tcomputed:\n\t{\n\t\t...Vuex.mapState({\n\t\t\twidget: state => state.widget\n\t\t})\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-livechat-help-container\">\n\t\t\t<transition name=\"bx-livechat-animation-fade\">\n\t\t\t\t<h2 v-if=\"widget.common.online\" key=\"online\" class=\"bx-livechat-help-title bx-livechat-help-title-lg\">{{widget.common.textMessages.bxLivechatOnlineLine1}}<div class=\"bx-livechat-help-subtitle\">{{widget.common.textMessages.bxLivechatOnlineLine2}}</div></h2>\n\t\t\t\t<h2 v-else key=\"offline\" class=\"bx-livechat-help-title bx-livechat-help-title-sm\">{{widget.common.textMessages.bxLivechatOffline}}</h2>\n\t\t\t</transition>\t\n\t\t\t<div class=\"bx-livechat-help-user\">\n\t\t\t\t<template v-for=\"operator in widget.common.operators\">\n\t\t\t\t\t<div class=\"bx-livechat-user\" :key=\"operator.id\">\n\t\t\t\t\t\t<template v-if=\"operator.avatar\">\n\t\t\t\t\t\t\t<div class=\"bx-livechat-user-icon\" :style=\"'background-image: url('+encodeURI(operator.avatar)+')'\"></div>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t\t<div class=\"bx-livechat-user-icon\"></div>\n\t\t\t\t\t\t</template>\t\n\t\t\t\t\t\t<div class=\"bx-livechat-user-info\">\n\t\t\t\t\t\t\t<div class=\"bx-livechat-user-name\">{{operator.firstName? operator.firstName: operator.name}}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</template>\t\n\t\t\t</div>\n\t\t</div>\n\t`\n});","import {BitrixVue} from 'ui.vue';\nimport {Vuex} from 'ui.vue.vuex';\nimport {RestMethod, WidgetEventType} from '../const';\nimport {EventEmitter} from 'main.core.events';\n\nBitrixVue.component('bx-livechat-dialogues-list',\n{\n\tdata()\n\t{\n\t\treturn {\n\t\t\tnewChatMode: false,\n\t\t\tsessionList: [],\n\t\t\tisLoading: false,\n\t\t\tpagesLoaded: 0,\n\t\t\thasMoreItemsToLoad: true,\n\t\t\titemsPerPage: 25\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\t...Vuex.mapState({\n\t\t\tdialogues: state => state.dialogues\n\t\t})\n\t},\n\tmounted()\n\t{\n\t\tthis.requestDialogList();\n\t},\n\tmethods:\n\t{\n\t\trequestDialogList(offset = 0)\n\t\t{\n\t\t\tthis.isLoading = true;\n\n\t\t\tconst requestParams = {'CONFIG_ID': this.$Bitrix.Application.get().getConfigId()};\n\t\t\tif (offset > 0)\n\t\t\t{\n\t\t\t\trequestParams['OFFSET'] = offset;\n\t\t\t}\n\n\t\t\treturn this.$Bitrix.Application.get().controller.restClient.callMethod(\n\t\t\t\tRestMethod.widgetDialogList,\n\t\t\t\trequestParams\n\t\t\t).then(result => {\n\t\t\t\tif (result.data().length === 0 || result.data().length < this.itemsPerPage)\n\t\t\t\t{\n\t\t\t\t\tthis.hasMoreItemsToLoad = false;\n\t\t\t\t}\n\t\t\t\tthis.pagesLoaded++;\n\t\t\t\tthis.isLoading = false;\n\t\t\t\tthis.sessionList = [...this.sessionList, ...this.prepareSessionList(result.data())];\n\t\t\t}).catch(error => {\n\t\t\t\tconsole.warn('error', error);\n\t\t\t});\n\t\t},\n\t\tprepareSessionList(sessionList)\n\t\t{\n\t\t\treturn Object.values(sessionList).map(dialog => {\n\t\t\t\treturn {\n\t\t\t\t\tchatId: dialog.chatId,\n\t\t\t\t\tdialogId: dialog.dialogId,\n\t\t\t\t\tname: `Dialog #${dialog.sessionId}`\n\t\t\t\t};\n\t\t\t});\n\t\t},\n\n\t\topenSession(event)\n\t\t{\n\t\t\tEventEmitter.emit(WidgetEventType.openSession, event);\n\t\t},\n\n\t\tstartNewChat(event)\n\t\t{\n\t\t\tthis.newChatMode = true;\n\t\t\tthis.$emit('startNewChat', event);\n\t\t},\n\n\t\tisOneScreenRemaining(event)\n\t\t{\n\t\t\treturn event.target.scrollTop + event.target.clientHeight >= event.target.scrollHeight - event.target.clientHeight;\n\t\t},\n\n\t\tonScroll(event)\n\t\t{\n\t\t\tif (this.isOneScreenRemaining(event))\n\t\t\t{\n\t\t\t\tif (this.isLoading || !this.hasMoreItemsToLoad)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst offset = this.itemsPerPage * this.pagesLoaded;\n\t\t\t\tthis.requestDialogList(offset);\n\t\t\t}\n\t\t}\n\t},\n\t// language=Vue\n\ttemplate: `\n\t<div class=\"bx-livechat-help-container\" style=\" height: 100%; display: flex; flex-direction: column; justify-content: space-between;\">\n\t\t<div \n\t\t\tstyle=\"margin-top: 25px;overflow-y: scroll;position:relative\"\n\t\t\t:style=\"{marginBottom: newChatMode ? 0 : '10px'}\"\n\t\t\t@scroll=\"onScroll\"\n\t\t>\n\t\t\t<div\n\t\t\t\tv-for=\"session in sessionList\"\n\t\t\t\t:key=\"session.chatId\"\n\t\t\t\tclass=\"bx-livechat-help-subtitle\"\n\t\t\t\t@click=\"openSession({event: $event, session: session})\"\n\t\t\t\tstyle=\"cursor: pointer; border: solid 1px black;border-radius: 10px;margin: 10px;padding: 5px;background-color: #0ae4ff\">\n\t\t\t\t{{ session.name }}\n\t\t\t</div>\n\t\t\t<div v-if=\"isLoading\" style=\"margin: 10px\">Loading</div>\n\t\t</div>\n\t\t\n\t\t<div v-if=\"!newChatMode\" style=\"margin-bottom: 10px;\">\n\t\t\t<button \n\t\t\t\tclass=\"bx-livechat-btn\" \n\t\t\t\tstyle=\"background-color: rgb(23, 163, 234); border-radius: 5px;width: 150px;\" \n\t\t\t\t@click=\"startNewChat\">\n\t\t\t\tStart new chat!\n\t\t\t</button>\n\t\t</div>\n\t</div>\n\t`\n\t}\n);","/**\n * Bitrix OpenLines widget\n * Body orientation disabled component (Vue component)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {BitrixVue} from \"ui.vue\";\n\nBitrixVue.component('bx-livechat-body-orientation-disabled',\n{\n\ttemplate: `\n\t\t<div class=\"bx-livechat-body\" key=\"orientation-head\">\n\t\t\t<div class=\"bx-livechat-mobile-orientation-box\">\n\t\t\t\t<div class=\"bx-livechat-mobile-orientation-icon\"></div>\n\t\t\t\t<div class=\"bx-livechat-mobile-orientation-text\">{{$Bitrix.Loc.getMessage('BX_LIVECHAT_MOBILE_ROTATE')}}</div>\n\t\t\t</div>\n\t\t</div>\n\t`\n});","/**\n * Bitrix OpenLines widget\n * Form consent component (Vue component)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {BitrixVue} from \"ui.vue\";\nimport {Vuex} from \"ui.vue.vuex\";\nimport { EventEmitter } from \"main.core.events\";\nimport { WidgetEventType } from \"../const\";\n\nBitrixVue.component('bx-livechat-form-consent',\n{\n\tcomputed:\n\t{\n\t\t...Vuex.mapState({\n\t\t\twidget: state => state.widget,\n\t\t})\n\t},\n\tmethods:\n\t{\n\t\tagree()\n\t\t{\n\t\t\tEventEmitter.emit(WidgetEventType.acceptConsent);\n\t\t},\n\t\tdisagree()\n\t\t{\n\t\t\tEventEmitter.emit(WidgetEventType.declineConsent);\n\t\t},\n\t\tonShow(element, done)\n\t\t{\n\t\t\telement.classList.add('bx-livechat-consent-window-show');\n\t\t\tdone();\n\t\t},\n\t\tonHide(element, done)\n\t\t{\n\t\t\telement.classList.remove('bx-livechat-consent-window-show');\n\t\t\telement.classList.add('bx-livechat-consent-window-close');\n\t\t\tsetTimeout(function() {\n\t\t\t\tdone();\n\t\t\t}, 400);\n\t\t},\n\t\tonKeyDown(event)\n\t\t{\n\t\t\tif (event.keyCode == 9)\n\t\t\t{\n\t\t\t\tif (event.target === this.$refs.iframe)\n\t\t\t\t{\n\t\t\t\t\tif (event.shiftKey)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$refs.cancel.focus();\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$refs.success.focus();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (event.target === this.$refs.success)\n\t\t\t\t{\n\t\t\t\t\tif (event.shiftKey)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$refs.iframe.focus();\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$refs.cancel.focus();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (event.target === this.$refs.cancel)\n\t\t\t\t{\n\t\t\t\t\tif (event.shiftKey)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$refs.success.focus();\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$refs.iframe.focus();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tevent.preventDefault();\n\t\t\t}\n\t\t\telse if (event.keyCode == 39 || event.keyCode == 37)\n\t\t\t{\n\t\t\t\tif (event.target.nextElementSibling)\n\t\t\t\t{\n\t\t\t\t\tevent.target.nextElementSibling.focus();\n\t\t\t\t}\n\t\t\t\telse if (event.target.previousElementSibling)\n\t\t\t\t{\n\t\t\t\t\tevent.target.previousElementSibling.focus();\n\t\t\t\t}\n\t\t\t\tevent.preventDefault();\n\t\t\t}\n\t\t},\n\t},\n\tdirectives:\n\t{\n\t\tfocus:\n\t\t{\n\t\t\tinserted(element, params)\n\t\t\t{\n\t\t\t\telement.focus();\n\t\t\t}\n\t\t}\n\t},\n\ttemplate: `\n\t\t<transition @enter=\"onShow\" @leave=\"onHide\">\n\t\t\t<template v-if=\"widget.common.showConsent && widget.common.consentUrl\">\n\t\t\t\t<div class=\"bx-livechat-consent-window\">\n\t\t\t\t\t<div class=\"bx-livechat-consent-window-title\">{{$Bitrix.Loc.getMessage('BX_LIVECHAT_CONSENT_TITLE')}}</div>\n\t\t\t\t\t<div class=\"bx-livechat-consent-window-content\">\n\t\t\t\t\t\t<iframe class=\"bx-livechat-consent-window-content-iframe\" ref=\"iframe\" frameborder=\"0\" marginheight=\"0\"  marginwidth=\"0\" allowtransparency=\"allow-same-origin\" seamless=\"true\" :src=\"widget.common.consentUrl\" @keydown=\"onKeyDown\"></iframe>\n\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\n\t\t\t\t\t<div class=\"bx-livechat-consent-window-btn-box\">\n\t\t\t\t\t\t<button class=\"bx-livechat-btn bx-livechat-btn-success\" ref=\"success\" @click=\"agree\" @keydown=\"onKeyDown\" v-focus>{{$Bitrix.Loc.getMessage('BX_LIVECHAT_CONSENT_AGREE')}}</button>\n\t\t\t\t\t\t<button class=\"bx-livechat-btn bx-livechat-btn-cancel\" ref=\"cancel\" @click=\"disagree\" @keydown=\"onKeyDown\">{{$Bitrix.Loc.getMessage('BX_LIVECHAT_CONSENT_DISAGREE')}}</button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t</transition>\n\t`\n});","/**\n * Bitrix OpenLines widget\n * Form vote component (Vue component)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {BitrixVue} from \"ui.vue\";\nimport {Vuex} from \"ui.vue.vuex\";\nimport { VoteType, WidgetEventType } from \"../const\";\nimport { EventEmitter } from \"main.core.events\";\n\nBitrixVue.component('bx-livechat-form-vote',\n{\n\tcomputed:\n\t{\n\t\tVoteType: () => VoteType,\n\n\t\t...Vuex.mapState({\n\t\t\twidget: state => state.widget,\n\t\t})\n\t},\n\tmethods: {\n\t\tuserVote(vote)\n\t\t{\n\t\t\tEventEmitter.emit(WidgetEventType.hideForm);\n\t\t\tthis.$store.commit('widget/dialog', {userVote: vote});\n\n\t\t\tEventEmitter.emit(WidgetEventType.sendDialogVote, {vote});\n\t\t},\n\t\thideForm()\n\t\t{\n\t\t\tEventEmitter.emit(WidgetEventType.hideForm);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<transition enter-active-class=\"bx-livechat-consent-window-show\" leave-active-class=\"bx-livechat-form-close\">\n\t\t\t<div class=\"bx-livechat-alert-box bx-livechat-form-rate-show\" key=\"vote\">\n\t\t\t\t<div class=\"bx-livechat-alert-close\" :title=\"$Bitrix.Loc.getMessage('BX_LIVECHAT_VOTE_LATER')\" @click=\"hideForm\"></div>\n\t\t\t\t<div class=\"bx-livechat-alert-rate-box\">\n\t\t\t\t\t<h4 class=\"bx-livechat-alert-title bx-livechat-alert-title-mdl\">{{widget.common.vote.messageText}}</h4>\n\t\t\t\t\t<div class=\"bx-livechat-btn-box\">\n\t\t\t\t\t\t<button class=\"bx-livechat-btn bx-livechat-btn-like\" @click=\"userVote(VoteType.like)\" :title=\"widget.common.vote.messageLike\"></button>\n\t\t\t\t\t\t<button class=\"bx-livechat-btn bx-livechat-btn-dislike\" @click=\"userVote(VoteType.dislike)\" :title=\"widget.common.vote.messageDislike\"></button>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"bx-livechat-alert-later\"><span class=\"bx-livechat-alert-later-btn\" @click=\"hideForm\">{{$Bitrix.Loc.getMessage('BX_LIVECHAT_VOTE_LATER')}}</span></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</transition>\t\n\t`\n});","/**\n * Bitrix OpenLines widget\n * Smiles component (Vue component)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {Vue} from \"ui.vue\";\nimport { EventEmitter } from \"main.core.events\";\nimport { WidgetEventType } from \"../const\";\nimport 'ui.vue.components.smiles';\n\nVue.cloneComponent('bx-livechat-smiles', 'bx-smiles',\n{\n\tmethods:\n\t{\n\t\thideForm()\n\t\t{\n\t\t\tEventEmitter.emit(WidgetEventType.hideForm);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<transition enter-active-class=\"bx-livechat-consent-window-show\" leave-active-class=\"bx-livechat-form-close\">\n\t\t\t<div class=\"bx-livechat-alert-box bx-livechat-alert-box-zero-padding bx-livechat-form-show\" key=\"vote\">\n\t\t\t\t<div class=\"bx-livechat-alert-close\" @click=\"hideForm\"></div>\n\t\t\t\t<div class=\"bx-livechat-alert-smiles-box\">\n\t\t\t\t\t#PARENT_TEMPLATE#\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</transition>\n\t`\n});","/**\n * Bitrix OpenLines widget\n * Widget component & controller\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\n// core\nimport 'main.polyfill.customevent';\n\n// vue components\nimport 'pull.component.status';\nimport 'ui.vue.components.smiles';\nimport 'im.component.dialog';\nimport 'im.component.textarea';\nimport 'im.view.quotepanel';\nimport 'imopenlines.component.message';\nimport 'imopenlines.component.form';\n\n// widget files\nimport \"./widget.css\";\nimport {VoteType, LocationStyle, SubscriptionType} from \"./const\";\n\n// widget utils\nimport {Cookie} from \"im.lib.cookie\";\nimport {WidgetPublicManager} from \"./public\";\n\n// widget components\nimport \"./component/bx-livechat\";\nimport \"./component/bx-livechat-body-error\";\nimport \"./component/bx-livechat-body-head\";\nimport \"./component/bx-livechat-body-loading\";\nimport \"./component/bx-livechat-body-operators\";\nimport \"./component/bx-livechat-dialogues-list\";\nimport \"./component/bx-livechat-body-orientation-disabled\";\nimport \"./component/bx-livechat-form-consent\";\nimport \"./component/bx-livechat-form-vote\";\nimport \"./component/bx-livechat-smiles\";\n\n\nBX.LiveChatWidget = WidgetPublicManager;\nBX.LiveChatWidget.VoteType = VoteType;\nBX.LiveChatWidget.SubscriptionType = SubscriptionType;\nBX.LiveChatWidget.LocationStyle = LocationStyle;\nBX.LiveChatWidget.Cookie = Cookie;\n\nwindow.dispatchEvent(new CustomEvent('onBitrixLiveChatSourceLoaded', {detail: {}}));\n"],"names":["GetObjectValues","source","destination","value","hasOwnProperty","push","VoteType","Object","freeze","none","like","dislike","LanguageType","russian","ukraine","world","FormType","smile","consent","welcome","offline","history","LocationType","topLeft","topMiddle","topBottom","bottomLeft","bottomMiddle","bottomRight","LocationStyle","WidgetBaseSize","width","height","WidgetMinimumSize","SubscriptionType","configLoaded","widgetOpen","widgetClose","sessionStart","sessionOperatorChange","sessionFinish","operatorMessage","userForm","userMessage","userFile","userVote","every","SubscriptionTypeCheck","RestMethod","widgetUserRegister","widgetChatCreate","widgetConfigGet","widgetDialogGet","widgetDialogList","widgetUserGet","widgetUserConsentApply","widgetVoteSend","widgetActionSend","pullServerTime","pullConfigGet","RestMethodCheck","RestAuth","guest","SessionStatus","skip","answer","client","clientAfterOperator","operator","waitClient","close","spam","duplicate","silentlyClose","WidgetEventType","showForm","hideForm","processMessagesToSendQueue","requestData","showConsent","acceptConsent","consentAccepted","declineConsent","consentDeclined","sendDialogVote","createSession","openSession","WidgetModel","common","configId","configName","host","getVariable","location","protocol","pageMode","copyright","copyrightUrl","styles","backgroundColor","iconColor","vote","enable","beforeFinish","messageText","messageLike","messageDislike","textMessages","bxLivechatOnlineLine1","bxLivechatOnlineLine2","bxLivechatOffline","bxLivechatTitle","online","operators","connectors","showed","reopen","dragged","textareaHeight","widgetHeight","widgetWidth","consentUrl","dialogStart","watchTyping","showSessionId","isCreateSessionMode","crmFormsSettings","useWelcomeForm","welcomeFormId","welcomeFormSec","welcomeFormDelay","welcomeFormFilled","successText","errorText","dialog","sessionId","sessionClose","sessionStatus","closeVote","userConsent","operatorChatId","id","name","firstName","lastName","workPosition","avatar","user","hash","email","phone","www","gender","position","state","payload","Utils","types","isPlainObject","device","isMobile","Array","isSaveNeeded","saveState","toString","startsWith","Cookie","set","expires","path","show","commit","setVoteDateFinish","dispatch","clearTimeout","setVoteDateTimeout","totalDelay","Date","getTime","dayTimestamp","delay","setTimeout","requestCloseVote","VuexBuilderModel","WidgetRestClient","params","queryAuthRestore","setAuthId","restClient","RestClient","endpoint","queryParams","cors","authId","customAuthId","match","livechat_auth_id","console","error","livechat_custom_auth_id","method","callback","sendCallback","logTag","getLogTrackingParams","promise","BX","Promise","callMethod","then","result","fulfill","ex","warn","error_description","reject","calls","bHaltOnError","resultCallback","callBatch","WidgetRestAnswerHandler","props","widget","data","store","disk","addLocalize","serverVariables","LocalStorage","getSiteId","previousData","messages","collection","controller","application","getChatId","chatId","dialogId","fields","entityType","type","userId","diskFolderId","dateCloseVote","handleImDialogMessagesGetSuccess","length","isDialogStart","messageId","message","sendEvent","text","BaseRestHandler","WidgetImPullCommandHandler","extra","command","senderId","getUserId","onceShowed","open","WidgetImopenlinesPullCommandHandler","Widget","checkSameDomain","messagesQueue","EventEmitter","subscribe","bind","createChat","initParams","initRestClient","initPullClient","initCore","initWidget","initComplete","rootNode","node","document","createElement","code","language","buttonInstance","useBitrixLocalize","placeholder","querySelector","errors","checkRequiredFields","forEach","ready","setRootNode","localize","window","setLocalize","pullClient","PullClient","serverEnabled","siteId","skipStorageInit","configTimestamp","skipCheckRevision","getPublicListMethod","Controller","getHost","languageId","pull","rest","vuexBuilder","database","browser","isIe","databaseName","databaseType","VuexBuilder","DatabaseType","localStorage","models","create","setVariables","getWidgetVariables","getRestAuthId","setModelData","setPrepareFilesBeforeSaveFunction","prepareFileData","addRestAnswerHandler","getStore","dispatchEvent","CustomEvent","detail","widgetCode","widgetHost","callStartFlag","start","callOpenFlag","isSessionActive","requestWidgetData","openFromButton","wm","showById","checkForErrorsBeforeOpen","stop","inited","attachTemplate","isUserReady","isHashAvailable","fireInitEvent","xhr","widgetConfigRequest","clearError","executeRestAnswer","setError","isConfigDataLoaded","Logger","log","requestDataSend","abort","handleBatchRequestResult","getDataRequestQuery","getDialogData","resolve","getCreateChatRequestQuery","handleBatchCreateChatRequestResult","response","handleConfigGet","handleUserGet","handleChatGet","handleDialogGet","handleDialogMessagesGet","handleUserRegister","handlePullRequests","description","handleChatCreate","query","isUserRegistered","config_id","getConfigId","trace_data","getCrmTraceData","custom_data","getCustomData","ImRestMethodHandler","imChatGet","ImRestMethod","dialog_id","imDialogMessagesGetInit","imDialogMessagesGet","chat_id","limit","getRequestMessageLimit","convert_text","getUserRegisterFields","userRegisterData","getUserHashCookie","isUserAgreeConsent","consent_url","href","event","eventData","getData","getters","session","getOpenSessionQuery","handleBatchOpenSessionRequestResult","files","isArray","map","file","md5","getUserHash","urlParam","urlPreview","urlShow","urlDownload","body","firstChild","insertBefore","append","get","variables","getLocalize","checkBrowserVersion","BX_LIVECHAT_OLD_BROWSER","versionCompare","Vue","version","alert","BX_LIVECHAT_OLD_VUE","BX_LIVECHAT_OLD_VUE_DEV","replace","isSameDomain","BX_LIVECHAT_SAME_DOMAIN","isReady","options","lastIndexOf","hostname","platform","isIos","getIosVersion","config","pullClientInited","isConnected","scheduleReconnect","server","config_timestamp","storage","StorageManager","Status","eventStatusInteraction","pullConnectedFirstTime","status","PullStatus","Online","template","$Bitrix","skipReconnectToLastSession","CloseReasons","MANUAL","restart","onPullOnlineStatus","Offline","pullRequestMessage","pullBaseHandler","option","emitAsync","EventType","requestUnread","emit","scrollOnStart","readMessage","innerHTML","createVue","el","beforeCreate","ZIndexManager","undefined","stack","getOrAddStack","setBaseIndex","$bitrix","Data","destroyed","templateAttached","$destroy","mutateComponent","onWidgetClose","detachTemplate","initEventFired","traceData","getTrace","b24Tracker","customData","MESSAGE","BX_LIVECHAT_EXTRA_SITE","JSON","stringify","getDialogId","dialogues","userHash","cookie","validUserFields","field","indexOf","setNewAuthToken","authToken","getStoreBuilder","clearModelState","element","concat","localizeDescription","link","endsWith","active","includes","subscribers","filter","phrases","phrase","configGet","userGetResult","chatGetResult","dialogGetResult","dialogMessagesGetResult","userRegisterResult","chatCreateResult","timeShift","serverTimeResult","Math","floor","now","pullConfigResult","startPullClient","WidgetPublicManager","developerInfo","__privateMethods__","__createLegacyMethods","showNotification","getUserData","setUserRegisterData","setCustomData","mutateTemplateComponent","LiveChat","sourceHref","sourceDomain","port","openLiveChat","closeLiveChat","addEventListener","eventName","handler","origin","action","setCookie","getCookie","BxLiveChatInit","firstMessage","BxLiveChatLoader","WidgetSendMessageHandler","Application","onProcessQueueHandler","processQueue","onConsentAcceptedHandler","onConsentAccepted","onConsentDeclinedHandler","onConsentDeclined","unsubscribe","focus","getWidgetData","storedMessage","textarea","stopWriting","sendMessage","setFocus","quoteId","quoteMessage","getMessageTextWithQuote","quotePanelClose","isUnreadMessagesLoaded","sendMessageToServer","FILE_ID","addMessageToModel","sending","scrollToBottom","cancelIfScrollChange","addMessageToQueue","values","parse","Number","parseInt","SESSION_ID","getSessionId","isSessionClose","loc","WidgetRestMethod","botId","imMessageCommand","authorId","quoteDelimiter","repeat","quoteTitle","quoteDate","date","format","quoteContent","quote","join","messagesToSend","imMessageAdd","timMessageType","RestMethodHandler","deleteFromQueue","uploader","addMessageWithFile","isFocusNeeded","getApplicationModel","DeviceType","mobile","onSendMessage","insertText","SendMessageHandler","WidgetTextareaHandler","appId","getWidgetModel","onFocusScrollTimeout","onScrollHandler","onScroll","force","removeEventListener","canSendTypedText","infoString","operatorId","isPublishingEnabled","onScrollTimeout","setBlur","TextareaHandler","WidgetTextareaUploadHandler","widgetApplication","getDiskFolderId","requestDiskFolderId","senderOptions","customHeaders","addTask","taskId","fileData","fileName","generateUniqueName","previewBlob","chunkSize","Uploader","CLOUD_MAX_CHUNK_SIZE","BOX_MIN_CHUNK_SIZE","fileInputEvent","fileChangeEvent","target","storedFile","uploadFile","addFilesFromEvent","onTextareaFileSelected","actionUploadChunk","actionCommitFile","actionRollbackUpload","TextareaUploadHandler","WidgetReadingHandler","skipTimer","skipAjax","ReadingHandler","WidgetResizeHandler","widgetLocation","availableWidth","availableHeight","events","setEventNamespace","subscribeToEvents","configEvents","Type","isObject","entries","isFunction","currentHeight","currentWidth","isResizing","changedTouches","cursorStartPointY","clientY","cursorStartPointX","clientX","heightStartPoint","widthStartPoint","addWidgetResizeEvents","cursorControlPointY","cursorControlPointX","maxHeight","isBottomLocation","min","max","maxWidth","isLeftLocation","onSizeChange","newHeight","newWidth","removeWidgetResizeEvents","onStopResize","onContinueResizeHandler","onContinueResize","onStopResizeHandler","WidgetConsentHandler","showConsentHandler","onShowConsent","acceptConsentHandler","onAcceptConsent","declineConsentHandler","onDeclineConsent","hideConsent","sendConsentDecision","WidgetFormHandler","showFormHandler","onShowForm","hideFormHandler","onHideForm","sendVoteHandler","onSendVote","showFormTimeout","delayed","showLikeForm","showSmiles","sendVote","WidgetReactionHandler","ReactionHandler","WidgetHistoryHandler","requestControllerAction","handleRequest","downloadHistory","ajaxEndpoint","url","URL","searchParams","formData","FormData","key","fetch","headers","contentType","json","blob","Blob","createObjectURL","a","download","click","remove","WidgetDialogActionHandler","DialogActionHandler","BitrixVue","component","widgetAvailableHeight","widgetAvailableWidth","widgetCurrentHeight","widgetCurrentWidth","widgetIsResizing","startNewChatMode","computed","showTextarea","showWelcomeForm","textareaHeightStyle","flex","textareaBottomMargin","marginBottom","widgetHeightStyle","widgetWidthStyle","userSelectStyle","widgetMobileDisabled","orientation","DeviceOrientation","horizontal","navigator","userAgent","screen","availHeight","widgetPositionClass","className","widgetLanguageClass","widgetPlatformClass","isSafari","isMac","widgetClassName","isDarkColor","showMessageDialog","messageCollection","getFilteredPhrases","Vuex","mapState","created","onCreated","initEventHandlers","mounted","registerZIndex","beforeDestroy","unsubscribeEvents","destroyHandlers","unregisterZIndex","methods","sendMessageHandler","textareaHandler","textareaUploadHandler","readingHandler","consentHandler","formHandler","textareaDragHandler","getTextareaDragHandler","resizeHandler","getWidgetResizeHandler","reactionHandler","historyHandler","dialogActionHandler","destroy","onWindowKeyDown","getAvailableSpaceFunc","throttle","getAvailableSpace","initMobileEnv","metaTags","head","querySelectorAll","viewPortMetaSiteNode","find","createViewportMeta","viewPortMetaWidgetNode","setAttribute","classList","add","isSafariBased","$store","contentWidth","offsetWidth","innerWidth","removeMobileEnv","initCollections","getApplication","onBeforeClose","onAfterClose","onOpenMenu","getHtmlHistory","onPullRequestConfig","recoverPullConnection","onSmilesSelectSmile","onSmilesSelectSet","onWidgetStartDrag","startResize","keyCode","preventDefault","stopPropagation","onWelcomeFormSendSuccess","onWelcomeFormSendError","onTextareaStartDrag","onStartDrag","openDialogList","onStartNewChat","widgetMargin","bottomPosition","$refs","widgetWrapper","getBoundingClientRect","bottom","widgetBottomMargin","innerHeight","topPosition","top","setAvailableWidth","setAvailableHeight","TextareaDragHandler","onHeightChange","onStopDrag","isPageMode","zIndexStackInstance","register","unregister","isWidgetDisabled","multiDialog","$emit","openMenu","customBackgroundStyle","customBackgroundOnlineStyle","showName","voteActive","chatTitle","BX_LIVECHAT_TITLE","operatorName","operatorDescription","operatorPosition","BX_LIVECHAT_USER","BX_LIVECHAT_OPERATOR_POSITION_AND_SESSION_ID","BX_LIVECHAT_OPERATOR_POSITION_ONLY","ie11","Browser","isIE11","watch","$root","newChatMode","sessionList","isLoading","pagesLoaded","hasMoreItemsToLoad","itemsPerPage","requestDialogList","offset","requestParams","prepareSessionList","startNewChat","isOneScreenRemaining","scrollTop","clientHeight","scrollHeight","agree","disagree","onShow","done","onHide","onKeyDown","iframe","shiftKey","cancel","success","nextElementSibling","previousElementSibling","directives","inserted","cloneComponent","LiveChatWidget"],"mappings":"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"}