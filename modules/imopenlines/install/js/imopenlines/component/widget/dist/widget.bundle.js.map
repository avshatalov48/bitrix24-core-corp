{"version":3,"file":"widget.bundle.js","sources":["../src/const.js","../src/model.js","../src/utils/restclient.js","../src/rest.handler.js","../src/pull.handler.js","../src/widget.js","../src/public.js","../src/component/bx-livechat.js","../src/component/bx-livechat-body-error.js","../src/component/bx-livechat-body-head.js","../src/component/bx-livechat-body-loading.js","../src/component/bx-livechat-body-operators.js","../src/component/bx-livechat-body-orientation-disabled.js","../src/component/bx-livechat-form-consent.js","../src/component/bx-livechat-form-history.js","../src/component/bx-livechat-form-offline.js","../src/component/bx-livechat-form-vote.js","../src/component/bx-livechat-form-welcome.js","../src/component/bx-livechat-smiles.js","../src/component/bx-livechat-footer.js","../src/registry.js"],"sourcesContent":["/**\n * Bitrix OpenLines widget\n * Widget constants\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nfunction GetObjectValues(source)\n{\n\tconst destination = [];\n\tfor (let value in source)\n\t{\n\t\tif (source.hasOwnProperty(value))\n\t\t{\n\t\t\tdestination.push(source[value]);\n\t\t}\n\t}\n\treturn destination;\n}\n\n/* region 01. Constants */\n\nexport const VoteType = Object.freeze({\n\tnone: 'none',\n\tlike: 'like',\n\tdislike: 'dislike',\n});\n\nexport const LanguageType = Object.freeze({\n\trussian: 'ru',\n\tukraine: 'ua',\n\tworld: 'en',\n});\n\nexport const FormType = Object.freeze({\n\tnone: 'none',\n\tlike: 'like',\n\tsmile: 'smile',\n\tconsent: 'consent',\n\twelcome: 'welcome',\n\toffline: 'offline',\n\thistory: 'history',\n});\n\nexport const LocationType = Object.freeze({\n\ttopLeft: 1,\n\ttopMiddle: 2,\n\ttopBottom: 3,\n\tbottomLeft: 6,\n\tbottomMiddle: 5,\n\tbottomRight: 4,\n});\n\nexport const LocationStyle = Object.freeze({\n\t1: 'top-left',\n\t2: 'top-center',\n\t3: 'top-right',\n\t6: 'bottom-left',\n\t5: 'bottom-center',\n\t4: 'bottom-right',\n});\n\nexport const SubscriptionType = Object.freeze({\n\tconfigLoaded: 'configLoaded',\n\twidgetOpen: 'widgetOpen',\n\twidgetClose: 'widgetClose',\n\tsessionStart: 'sessionStart',\n\tsessionOperatorChange: 'sessionOperatorChange',\n\tsessionFinish: 'sessionFinish',\n\toperatorMessage: 'operatorMessage',\n\tuserForm: 'userForm',\n\tuserMessage: 'userMessage',\n\tuserFile: 'userFile',\n\tuserVote: 'userVote',\n\tevery: 'every',\n});\nexport const SubscriptionTypeCheck = GetObjectValues(SubscriptionType);\n\nexport const RestMethod = Object.freeze({\n\twidgetUserRegister: 'imopenlines.widget.user.register',\n\twidgetConfigGet: 'imopenlines.widget.config.get',\n\twidgetDialogGet: 'imopenlines.widget.dialog.get',\n\twidgetUserGet: 'imopenlines.widget.user.get',\n\twidgetUserConsentApply: 'imopenlines.widget.user.consent.apply',\n\twidgetVoteSend: 'imopenlines.widget.vote.send',\n\twidgetFormSend: 'imopenlines.widget.form.send',\n\n\tpullServerTime: 'server.time',\n\tpullConfigGet: 'pull.config.get',\n});\nexport const RestMethodCheck = GetObjectValues(RestMethod);\n\nexport const RestAuth = Object.freeze({\n\tguest: 'guest',\n});\n\nexport const SessionStatus = Object.freeze({\n\tnew: 0,\n\tskip: 5,\n\tanswer: 10,\n\tclient: 20,\n\tclientAfterOperator: 25,\n\toperator: 40,\n\twaitClient: 50,\n\tclose: 60,\n\tspam: 65,\n\tduplicate: 69,\n\tsilentlyClose: 75,\n});","/**\n * Bitrix OpenLines widget\n * Widget model (Vuex Builder model)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {VuexBuilderModel} from 'ui.vue.vuex';\n\nimport {Utils} from 'im.lib.utils';\nimport {Cookie} from \"im.lib.cookie\";\nimport {FormType, LocationStyle, LocationType, VoteType} from \"./const\";\n\nexport class WidgetModel extends VuexBuilderModel\n{\n\t/**\n\t * @inheritDoc\n\t */\n\tgetName()\n\t{\n\t\treturn 'widget';\n\t}\n\n\tgetState()\n\t{\n\t\treturn {\n\t\t\tcommon:\n\t\t\t{\n\t\t\t\tconfigId: 0,\n\t\t\t\tconfigName: '',\n\t\t\t\thost: this.getVariable('common.host', location.protocol+'//'+location.host),\n\t\t\t\tpageMode: this.getVariable('common.pageMode', false),\n\t\t\t\tcopyright: this.getVariable('common.copyright', true),\n\t\t\t\tcopyrightUrl: this.getVariable('common.copyrightUrl', 'https://bitrix24.com'),\n\t\t\t\tlocation: this.getVariable('common.location', LocationType.bottomRight),\n\t\t\t\tstyles: {\n\t\t\t\t\tbackgroundColor: this.getVariable('styles.backgroundColor', '#17a3ea'),\n\t\t\t\t\ticonColor: this.getVariable('styles.iconColor', '#ffffff')\n\t\t\t\t},\n\t\t\t\tvote: {\n\t\t\t\t\tenable: false,\n\t\t\t\t\tbeforeFinish: true,\n\t\t\t\t\tmessageText: this.getVariable('vote.messageText', ''),\n\t\t\t\t\tmessageLike: this.getVariable('vote.messageLike', ''),\n\t\t\t\t\tmessageDislike: this.getVariable('vote.messageDislike', '')\n\t\t\t\t},\n\t\t\t\ttextMessages: {\n\t\t\t\t\tbxLivechatOnlineLine1: this.getVariable('textMessages.bxLivechatOnlineLine1', ''),\n\t\t\t\t\tbxLivechatOnlineLine2: this.getVariable('textMessages.bxLivechatOnlineLine2', ''),\n\t\t\t\t\tbxLivechatOffline: this.getVariable('textMessages.bxLivechatOffline', ''),\n\t\t\t\t\tbxLivechatTitle: '',\n\t\t\t\t},\n\t\t\t\tonline: false,\n\t\t\t\toperators: [],\n\t\t\t\tconnectors: [],\n\t\t\t\tshowForm: FormType.none,\n\t\t\t\tshowed: false,\n\t\t\t\treopen: false,\n\t\t\t\tdragged: false,\n\t\t\t\ttextareaHeight: 0,\n\t\t\t\twidgetHeight: 0,\n\t\t\t\twidgetWidth: 0,\n\t\t\t\tshowConsent: false,\n\t\t\t\tconsentUrl: '',\n\t\t\t\tdialogStart: false,\n\t\t\t\twatchTyping: false,\n\t\t\t},\n\t\t\tdialog:\n\t\t\t{\n\t\t\t\tsessionId: 0,\n\t\t\t\tsessionClose: true,\n\t\t\t\tsessionStatus: 0,\n\t\t\t\tuserVote: VoteType.none,\n\t\t\t\tuserConsent: false,\n\t\t\t\toperatorChatId: 0,\n\t\t\t\toperator: {\n\t\t\t\t\tid: 0,\n\t\t\t\t\tname: '',\n\t\t\t\t\tfirstName: '',\n\t\t\t\t\tlastName: '',\n\t\t\t\t\tworkPosition: '',\n\t\t\t\t\tavatar: '',\n\t\t\t\t\tonline: false,\n\t\t\t\t}\n\t\t\t},\n\t\t\tuser:\n\t\t\t{\n\t\t\t\tid: -1,\n\t\t\t\thash: '',\n\t\t\t\tname: '',\n\t\t\t\tfirstName: '',\n\t\t\t\tlastName: '',\n\t\t\t\tavatar: '',\n\t\t\t\temail: '',\n\t\t\t\tphone: '',\n\t\t\t\twww: '',\n\t\t\t\tgender: 'M',\n\t\t\t\tposition: '',\n\t\t\t},\n\t\t}\n\t}\n\n\tgetStateSaveException()\n\t{\n\t\treturn {\n\t\t\tcommon: {\n\t\t\t\thost: null,\n\t\t\t\tpageMode: null,\n\t\t\t\tcopyright: null,\n\t\t\t\tcopyrightUrl: null,\n\t\t\t\tstyles: null,\n\t\t\t\tdragged: null,\n\t\t\t\tshowed: null,\n\t\t\t\tshowConsent: null,\n\t\t\t\tshowForm: null,\n\t\t\t},\n\t\t}\n\t}\n\n\tgetMutations()\n\t{\n\t\treturn {\n\n\t\t\tcommon: (state, payload) =>\n\t\t\t{\n\t\t\t\tif (typeof payload.configId === 'number')\n\t\t\t\t{\n\t\t\t\t\tstate.common.configId = payload.configId;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.configName === 'string')\n\t\t\t\t{\n\t\t\t\t\tstate.common.configName = payload.configName;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.online === 'boolean')\n\t\t\t\t{\n\t\t\t\t\tstate.common.online = payload.online;\n\t\t\t\t}\n\t\t\t\tif (Utils.types.isPlainObject(payload.vote))\n\t\t\t\t{\n\t\t\t\t\tif (typeof payload.vote.enable === 'boolean')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.common.vote.enable = payload.vote.enable;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.vote.beforeFinish === 'boolean')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.common.vote.beforeFinish = payload.vote.beforeFinish;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.vote.messageText === 'string')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.common.vote.messageText = payload.vote.messageText;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.vote.messageLike === 'string')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.common.vote.messageLike = payload.vote.messageLike;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.vote.messageDislike === 'string')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.common.vote.messageDislike = payload.vote.messageDislike;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (Utils.types.isPlainObject(payload.textMessages))\n\t\t\t\t{\n\t\t\t\t\tif (typeof payload.textMessages.bxLivechatOnlineLine1 === 'string' && payload.textMessages.bxLivechatOnlineLine1 !== '')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.common.textMessages.bxLivechatOnlineLine1 = payload.textMessages.bxLivechatOnlineLine1;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.textMessages.bxLivechatOnlineLine2 === 'string' && payload.textMessages.bxLivechatOnlineLine2 !== '')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.common.textMessages.bxLivechatOnlineLine2 = payload.textMessages.bxLivechatOnlineLine2;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.textMessages.bxLivechatOffline === 'string' && payload.textMessages.bxLivechatOffline !== '')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.common.textMessages.bxLivechatOffline = payload.textMessages.bxLivechatOffline;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.textMessages.bxLivechatTitle === 'string' && payload.textMessages.bxLivechatTitle !== '')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.common.textMessages.bxLivechatTitle = payload.textMessages.bxLivechatTitle;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (typeof payload.dragged === 'boolean')\n\t\t\t\t{\n\t\t\t\t\tstate.common.dragged = payload.dragged;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.textareaHeight === 'number')\n\t\t\t\t{\n\t\t\t\t\tstate.common.textareaHeight = payload.textareaHeight;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.widgetHeight === 'number')\n\t\t\t\t{\n\t\t\t\t\tstate.common.widgetHeight = payload.widgetHeight;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.widgetWidth === 'number')\n\t\t\t\t{\n\t\t\t\t\tstate.common.widgetWidth = payload.widgetWidth;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.showConsent === 'boolean')\n\t\t\t\t{\n\t\t\t\t\tstate.common.showConsent = payload.showConsent;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.consentUrl === 'string')\n\t\t\t\t{\n\t\t\t\t\tstate.common.consentUrl = payload.consentUrl;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.showed === 'boolean')\n\t\t\t\t{\n\t\t\t\t\tstate.common.showed = payload.showed;\n\t\t\t\t\tpayload.reopen = Utils.device.isMobile()? false: payload.showed;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.reopen === 'boolean')\n\t\t\t\t{\n\t\t\t\t\tstate.common.reopen = payload.reopen;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.copyright === 'boolean')\n\t\t\t\t{\n\t\t\t\t\tstate.common.copyright = payload.copyright;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.dialogStart === 'boolean')\n\t\t\t\t{\n\t\t\t\t\tstate.common.dialogStart = payload.dialogStart;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.watchTyping === 'boolean')\n\t\t\t\t{\n\t\t\t\t\tstate.common.watchTyping = payload.watchTyping;\n\t\t\t\t}\n\t\t\t\tif (payload.operators instanceof Array)\n\t\t\t\t{\n\t\t\t\t\tstate.common.operators = payload.operators;\n\t\t\t\t}\n\t\t\t\tif (payload.connectors instanceof Array)\n\t\t\t\t{\n\t\t\t\t\tstate.common.connectors = payload.connectors;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.showForm === 'string' && typeof FormType[payload.showForm] !== 'undefined')\n\t\t\t\t{\n\t\t\t\t\tstate.common.showForm = payload.showForm;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.location === 'number' && typeof LocationStyle[payload.location] !== 'undefined')\n\t\t\t\t{\n\t\t\t\t\tif (state.common.location !== payload.location)\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.common.widgetHeight = 0;\n\t\t\t\t\t\tstate.common.widgetWidth = 0;\n\t\t\t\t\t\tstate.common.location = payload.location;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (this.isSaveNeeded({common: payload}))\n\t\t\t\t{\n\t\t\t\t\tthis.saveState(state);\n\t\t\t\t}\n\t\t\t},\n\t\t\tdialog: (state, payload) =>\n\t\t\t{\n\t\t\t\tif (typeof payload.sessionId === 'number')\n\t\t\t\t{\n\t\t\t\t\tstate.dialog.sessionId = payload.sessionId;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.sessionClose === 'boolean')\n\t\t\t\t{\n\t\t\t\t\tstate.dialog.sessionClose = payload.sessionClose;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.sessionStatus === 'number')\n\t\t\t\t{\n\t\t\t\t\tstate.dialog.sessionStatus = payload.sessionStatus;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.userConsent === 'boolean')\n\t\t\t\t{\n\t\t\t\t\tstate.dialog.userConsent = payload.userConsent;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.userVote === 'string' && typeof payload.userVote !== 'undefined')\n\t\t\t\t{\n\t\t\t\t\tstate.dialog.userVote = payload.userVote;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.operatorChatId === 'number')\n\t\t\t\t{\n\t\t\t\t\tstate.dialog.operatorChatId = payload.operatorChatId;\n\t\t\t\t}\n\t\t\t\tif (Utils.types.isPlainObject(payload.operator))\n\t\t\t\t{\n\t\t\t\t\tif (typeof payload.operator.id === 'number')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.dialog.operator.id = payload.operator.id;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.operator.name === 'string' || typeof payload.operator.name === 'number')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.dialog.operator.name = payload.operator.name.toString();\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.operator.lastName === 'string' || typeof payload.operator.lastName === 'number')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.dialog.operator.lastName = payload.operator.lastName.toString();\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.operator.firstName === 'string' || typeof payload.operator.firstName === 'number')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.dialog.operator.firstName = payload.operator.firstName.toString();\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.operator.workPosition === 'string' || typeof payload.operator.workPosition === 'number')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.dialog.operator.workPosition = payload.operator.workPosition.toString();\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.operator.avatar === 'string')\n\t\t\t\t\t{\n\t\t\t\t\t\tif (!payload.operator.avatar || payload.operator.avatar.startsWith('http'))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tstate.dialog.operator.avatar = payload.operator.avatar;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tstate.dialog.operator.avatar = state.common.host+payload.operator.avatar;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.operator.online === 'boolean')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.dialog.operator.online = payload.operator.online;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (this.isSaveNeeded({dialog: payload}))\n\t\t\t\t{\n\t\t\t\t\tthis.saveState(state);\n\t\t\t\t}\n\t\t\t},\n\t\t\tuser: (state, payload) =>\n\t\t\t{\n\t\t\t\tif (typeof payload.id === 'number')\n\t\t\t\t{\n\t\t\t\t\tstate.user.id = payload.id;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.hash === 'string' && payload.hash !== state.user.hash)\n\t\t\t\t{\n\t\t\t\t\tstate.user.hash = payload.hash;\n\t\t\t\t\tCookie.set(null, 'LIVECHAT_HASH', payload.hash, {expires: 365*86400, path: '/'});\n\t\t\t\t}\n\t\t\t\tif (typeof payload.name === 'string' || typeof payload.name === 'number')\n\t\t\t\t{\n\t\t\t\t\tstate.user.name = payload.name.toString();\n\t\t\t\t}\n\t\t\t\tif (typeof payload.firstName === 'string' || typeof payload.firstName === 'number')\n\t\t\t\t{\n\t\t\t\t\tstate.user.firstName = payload.firstName.toString();\n\t\t\t\t}\n\t\t\t\tif (typeof payload.lastName === 'string' || typeof payload.lastName === 'number')\n\t\t\t\t{\n\t\t\t\t\tstate.user.lastName = payload.lastName.toString();\n\t\t\t\t}\n\t\t\t\tif (typeof payload.avatar === 'string')\n\t\t\t\t{\n\t\t\t\t\tstate.user.avatar = payload.avatar;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.email === 'string')\n\t\t\t\t{\n\t\t\t\t\tstate.user.email = payload.email;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.phone === 'string' || typeof payload.phone === 'number')\n\t\t\t\t{\n\t\t\t\t\tstate.user.phone = payload.phone.toString();\n\t\t\t\t}\n\t\t\t\tif (typeof payload.www === 'string')\n\t\t\t\t{\n\t\t\t\t\tstate.user.www = payload.www;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.gender === 'string')\n\t\t\t\t{\n\t\t\t\t\tstate.user.gender = payload.gender;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.position === 'string')\n\t\t\t\t{\n\t\t\t\t\tstate.user.position = payload.position;\n\t\t\t\t}\n\n\t\t\t\tif (this.isSaveNeeded({user: payload}))\n\t\t\t\t{\n\t\t\t\t\tthis.saveState(state);\n\t\t\t\t}\n\t\t\t},\n\t\t}\n\t}\n\n\tgetActions()\n\t{\n\t\treturn {\n\t\t\tshow: ({ commit }) =>\n\t\t\t{\n\t\t\t\tcommit('common', {showed: true});\n\t\t\t}\n\t\t}\n\t}\n}","/**\n * Bitrix OpenLines widget\n * Rest client (base on BX.RestClient)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\n// TODO change BX.RestClient, BX.promise to import\n\nimport {Utils} from \"im.lib.utils\";\nimport {RestAuth, RestMethod} from \"../const\";\nimport {RestClient} from \"rest.client\";\n\nexport class WidgetRestClient\n{\n\tconstructor(params)\n\t{\n\t\tthis.queryAuthRestore = false;\n\n\t\tthis.setAuthId(RestAuth.guest);\n\n\t\tthis.restClient = new RestClient({\n\t\t\tendpoint: params.endpoint,\n\t\t\tqueryParams: this.queryParams,\n\t\t\tcors: true\n\t\t});\n\t}\n\n\tsetAuthId(authId, customAuthId = '')\n\t{\n\t\tif (typeof this.queryParams !== 'object')\n\t\t{\n\t\t\tthis.queryParams = {};\n\t\t}\n\n\t\tif (\n\t\t\tauthId == RestAuth.guest\n\t\t\t|| typeof authId === 'string' && authId.match(/^[a-f0-9]{32}$/)\n\t\t)\n\t\t{\n\t\t\tthis.queryParams.livechat_auth_id = authId;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconsole.error(`%LiveChatRestClient.setAuthId: auth is not correct (%c${authId}%c)`, \"color: black;\", \"font-weight: bold; color: red\", \"color: black\");\n\t\t\treturn false;\n\t\t}\n\n\t\tif (\n\t\t\tauthId == RestAuth.guest\n\t\t\t&& typeof customAuthId === 'string' && customAuthId.match(/^[a-f0-9]{32}$/)\n\t\t)\n\t\t{\n\t\t\tthis.queryParams.livechat_custom_auth_id = customAuthId;\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tgetAuthId()\n\t{\n\t\tif (typeof this.queryParams !== 'object')\n\t\t{\n\t\t\tthis.queryParams = {};\n\t\t}\n\n\t\treturn this.queryParams.livechat_auth_id || null;\n\t}\n\n\tcallMethod(method, params, callback, sendCallback, logTag = null)\n\t{\n\t\tif (!logTag)\n\t\t{\n\t\t\tlogTag = Utils.getLogTrackingParams({\n\t\t\t\tname: method,\n\t\t\t});\n\t\t}\n\n\t\tconst promise = new BX.Promise();\n\n\t\t// TODO: Callbacks methods will not work!\n\t\tthis.restClient.callMethod(method, params, null, sendCallback, logTag).then(result => {\n\n\t\t\tthis.queryAuthRestore = false;\n\t\t\tpromise.fulfill(result);\n\n\t\t}).catch(result => {\n\n\t\t\tlet error = result.error();\n\t\t\tif (error.ex.error == 'LIVECHAT_AUTH_WIDGET_USER')\n\t\t\t{\n\t\t\t\tthis.setAuthId(error.ex.hash);\n\n\t\t\t\tif (method === RestMethod.widgetUserRegister)\n\t\t\t\t{\n\t\t\t\t\tconsole.warn(`BX.LiveChatRestClient: ${error.ex.error_description} (${error.ex.error})`);\n\n\t\t\t\t\tthis.queryAuthRestore = false;\n\t\t\t\t\tpromise.reject(result);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tif (!this.queryAuthRestore)\n\t\t\t\t{\n\t\t\t\t\tconsole.warn('BX.LiveChatRestClient: your auth-token has expired, send query with a new token');\n\n\t\t\t\t\tthis.queryAuthRestore = true;\n\t\t\t\t\tthis.restClient.callMethod(method, params, null, sendCallback, logTag).then(result => {\n\t\t\t\t\t\tthis.queryAuthRestore = false;\n\t\t\t\t\t\tpromise.fulfill(result);\n\t\t\t\t\t}).catch(result => {\n\t\t\t\t\t\tthis.queryAuthRestore = false;\n\t\t\t\t\t\tpromise.reject(result);\n\t\t\t\t\t});\n\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.queryAuthRestore = false;\n\t\t\tpromise.reject(result);\n\t\t});\n\n\t\treturn promise;\n\t};\n\n\tcallBatch(calls, callback, bHaltOnError, sendCallback, logTag)\n\t{\n\t\tlet resultCallback = (result) =>\n\t\t{\n\t\t\tlet error = null;\n\t\t\tfor (let method in calls)\n\t\t\t{\n\t\t\t\tif (!calls.hasOwnProperty(method))\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tlet error = result[method].error();\n\t\t\t\tif (error && error.ex.error == 'LIVECHAT_AUTH_WIDGET_USER')\n\t\t\t\t{\n\t\t\t\t\tthis.setAuthId(error.ex.hash);\n\t\t\t\t\tif (method === RestMethod.widgetUserRegister)\n\t\t\t\t\t{\n\t\t\t\t\t\tconsole.warn(`BX.LiveChatRestClient: ${error.ex.error_description} (${error.ex.error})`);\n\n\t\t\t\t\t\tthis.queryAuthRestore = false;\n\t\t\t\t\t\tcallback(result);\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!this.queryAuthRestore)\n\t\t\t\t\t{\n\t\t\t\t\t\tconsole.warn('BX.LiveChatRestClient: your auth-token has expired, send query with a new token');\n\n\t\t\t\t\t\tthis.queryAuthRestore = true;\n\t\t\t\t\t\tthis.restClient.callBatch(calls, callback, bHaltOnError, sendCallback, logTag);\n\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.queryAuthRestore = false;\n\t\t\tcallback(result);\n\n\t\t\treturn true;\n\t\t};\n\n\t\treturn this.restClient.callBatch(calls, resultCallback, bHaltOnError, sendCallback, logTag);\n\t};\n}","/**\n * Bitrix OpenLines widget\n * Widget Rest answers (Rest Answer Handler)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {BaseRestHandler} from \"im.provider.rest\";\nimport {LocalStorage} from \"im.lib.localstorage\";\nimport {SubscriptionType} from \"./const\";\n\nclass WidgetRestAnswerHandler extends BaseRestHandler\n{\n\tconstructor(props = {})\n\t{\n\t\tsuper(props);\n\n\t\tthis.widget = props.widget;\n\t}\n\n\thandleImopenlinesWidgetConfigGetSuccess(data)\n\t{\n\t\tthis.store.commit('widget/common', {\n\t\t\tconfigId: data.configId,\n\t\t\tconfigName: data.configName,\n\t\t\tvote: data.vote,\n\t\t\ttextMessages: data.textMessages,\n\t\t\toperators: data.operators || [],\n\t\t\tonline: data.online,\n\t\t\tconsentUrl: data.consentUrl,\n\t\t\tconnectors: data.connectors || [],\n\t\t\twatchTyping: data.watchTyping,\n\t\t});\n\n\t\tthis.store.commit('application/set', {disk: data.disk});\n\n\t\tthis.widget.addLocalize(data.serverVariables);\n\t\tLocalStorage.set(this.widget.getSiteId(), 0, 'serverVariables', data.serverVariables || {});\n\t}\n\n\thandleImopenlinesWidgetUserRegisterSuccess(data)\n\t{\n\t\tthis.widget.restClient.setAuthId(data.hash);\n\n\t\tlet previousData = [];\n\t\tif (typeof this.store.state.messages.collection[this.controller.application.getChatId()] !== 'undefined')\n\t\t{\n\t\t\tpreviousData = this.store.state.messages.collection[this.controller.application.getChatId()];\n\t\t}\n\t\tthis.store.commit('messages/initCollection', {chatId: data.chatId, messages: previousData});\n\n\t\tthis.store.commit('dialogues/initCollection', {dialogId: data.dialogId, fields: {\n\t\t\tentityType: 'LIVECHAT',\n\t\t\ttype: 'livechat'\n\t\t}});\n\n\t\tthis.store.commit('application/set', {dialog: {\n\t\t\tchatId: data.chatId,\n\t\t\tdialogId: 'chat'+data.chatId\n\t\t}});\n\t}\n\n\thandleImopenlinesWidgetUserGetSuccess(data)\n\t{\n\t\tthis.store.commit('widget/user', {\n\t\t\tid: data.id,\n\t\t\thash: data.hash,\n\t\t\tname: data.name,\n\t\t\tfirstName: data.firstName,\n\t\t\tlastName: data.lastName,\n\t\t\tphone: data.phone,\n\t\t\tavatar: data.avatar,\n\t\t\temail: data.email,\n\t\t\twww: data.www,\n\t\t\tgender: data.gender,\n\t\t\tposition: data.position,\n\t\t});\n\t\tthis.store.dispatch('users/set', [{\n\t\t\tid: data.id,\n\t\t\tname: data.name,\n\t\t\tfirstName: data.firstName,\n\t\t\tlastName: data.lastName,\n\t\t\tavatar: data.avatar,\n\t\t\tgender: data.gender,\n\t\t\tworkPosition: data.position,\n\t\t}]);\n\t\tthis.store.commit('application/set', {common: {\n\t\t\tuserId: data.id\n\t\t}});\n\t}\n\n\thandleImopenlinesWidgetDialogGetSuccess(data)\n\t{\n\t\tthis.store.commit('messages/initCollection', {chatId: data.chatId});\n\n\t\tthis.store.commit('widget/dialog', data);\n\n\t\tthis.store.commit('application/set', {dialog: {\n\t\t\tchatId: data.chatId,\n\t\t\tdialogId: 'chat'+data.chatId,\n\t\t\tdiskFolderId: data.diskFolderId,\n\t\t}});\n\t}\n\n\thandleImDialogMessagesGetInitSuccess(data)\n\t{\n\t\tthis.handleImDialogMessagesGetSuccess(data);\n\t}\n\n\thandleImDialogMessagesGetSuccess(data)\n\t{\n\t\tif (data.messages && data.messages.length > 0 && !this.widget.isDialogStart())\n\t\t{\n\t\t\tthis.store.commit('widget/common', {\n\t\t\t\tdialogStart: true\n\t\t\t});\n\t\t\tthis.store.commit('widget/dialog', {\n\t\t\t\tuserConsent: true\n\t\t\t});\n\t\t}\n\t}\n\n\thandleImMessageAddSuccess(messageId, message)\n\t{\n\t\tthis.widget.messagesQueue = this.widget.messagesQueue.filter(el => el.id != message.id);\n\n\t\tthis.widget.sendEvent({\n\t\t\ttype: SubscriptionType.userMessage,\n\t\t\tdata: {\n\t\t\t\tid: messageId,\n\t\t\t\ttext: message.text\n\t\t\t}\n\t\t});\n\t}\n\n\thandleImMessageAddError(error, message)\n\t{\n\t\tthis.widget.messagesQueue = this.widget.messagesQueue.filter(el => el.id != message.id);\n\t}\n\n\thandleImDiskFileCommitSuccess(result, message)\n\t{\n\t\tthis.widget.messagesQueue = this.widget.messagesQueue.filter(el => el.id != message.id);\n\n\t\tthis.widget.sendEvent({\n\t\t\ttype: SubscriptionType.userFile,\n\t\t\tdata: {}\n\t\t});\n\t}\n}\n\nexport {WidgetRestAnswerHandler};","/**\n * Bitrix OpenLines widget\n * Widget pull commands (Pull Command Handler)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {SubscriptionType, VoteType} from \"./const\";\n\nclass WidgetImPullCommandHandler\n{\n\tstatic create(params = {})\n\t{\n\t\treturn new this(params);\n\t}\n\n\tgetModuleId()\n\t{\n\t\treturn 'im';\n\t}\n\n\tconstructor(params)\n\t{\n\t\tthis.controller = params.controller;\n\t\tthis.store = params.store;\n\t\tthis.widget = params.widget;\n\t}\n\n\thandleMessageChat(params, extra, command)\n\t{\n\t\tif (params.message.senderId != this.controller.application.getUserId())\n\t\t{\n\t\t\tthis.widget.sendEvent({\n\t\t\t\ttype: SubscriptionType.operatorMessage,\n\t\t\t\tdata: params\n\t\t\t});\n\n\t\t\tif (!this.store.state.widget.common.showed && !this.widget.onceShowed)\n\t\t\t{\n\t\t\t\tthis.widget.onceShowed = true;\n\t\t\t\tthis.widget.open();\n\t\t\t}\n\t\t}\n\t}\n}\n\nclass WidgetImopenlinesPullCommandHandler\n{\n\tstatic create(params = {})\n\t{\n\t\treturn new this(params);\n\t}\n\n\tconstructor(params = {})\n\t{\n\t\tthis.controller = params.controller;\n\t\tthis.store = params.store;\n\t\tthis.widget = params.widget;\n\t}\n\n\tgetModuleId()\n\t{\n\t\treturn 'imopenlines';\n\t}\n\n\thandleSessionStart(params, extra, command)\n\t{\n\t\tthis.store.commit('widget/dialog', {\n\t\t\tsessionId: params.sessionId,\n\t\t\tsessionClose: false,\n\t\t\tsessionStatus: 0,\n\t\t\tuserVote: VoteType.none,\n\t\t});\n\n\t\tthis.widget.sendEvent({\n\t\t\ttype: SubscriptionType.sessionStart,\n\t\t\tdata: {\n\t\t\t\tsessionId: params.sessionId\n\t\t\t}\n\t\t});\n\t}\n\n\thandleSessionOperatorChange(params, extra, command)\n\t{\n\t\tthis.store.commit('widget/dialog', {\n\t\t\toperator: params.operator,\n\t\t\toperatorChatId: params.operatorChatId\n\t\t});\n\n\t\tthis.widget.sendEvent({\n\t\t\ttype: SubscriptionType.sessionOperatorChange,\n\t\t\tdata: {\n\t\t\t\toperator: params.operator\n\t\t\t}\n\t\t});\n\t}\n\n\thandleSessionStatus(params, extra, command)\n\t{\n\t\tthis.store.commit('widget/dialog', {\n\t\t\tsessionId: params.sessionId,\n\t\t\tsessionStatus: params.sessionStatus,\n\t\t\tsessionClose: params.sessionClose,\n\t\t});\n\n\t\tthis.widget.sendEvent({\n\t\t\ttype: SubscriptionType.sessionStatus,\n\t\t\tdata: {\n\t\t\t\tsessionId: params.sessionId,\n\t\t\t\tsessionStatus: params.sessionStatus\n\t\t\t}\n\t\t});\n\n\t\tif (params.sessionClose)\n\t\t{\n\t\t\tthis.widget.sendEvent({\n\t\t\t\ttype: SubscriptionType.sessionFinish,\n\t\t\t\tdata: {\n\t\t\t\t\tsessionId: params.sessionId,\n\t\t\t\t\tsessionStatus: params.sessionStatus\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (!params.spam)\n\t\t\t{\n\t\t\t\tthis.store.commit('widget/dialog', {\n\t\t\t\t\toperator: {\n\t\t\t\t\t\tname: '',\n\t\t\t\t\t\tfirstName: '',\n\t\t\t\t\t\tlastName: '',\n\t\t\t\t\t\tworkPosition: '',\n\t\t\t\t\t\tavatar: '',\n\t\t\t\t\t\tonline: false,\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n}\n\nexport {\n\tWidgetImPullCommandHandler,\n\tWidgetImopenlinesPullCommandHandler,\n};","/**\n * Bitrix OpenLines widget\n * Widget private interface (base class)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2020 Bitrix\n */\n\n// widget files\nimport {\n\tVoteType,\n\tLocationStyle,\n\tSubscriptionType,\n\tSubscriptionTypeCheck,\n\tRestMethod,\n\tRestAuth,\n} from \"./const\";\n\nimport {WidgetModel} from \"./model\";\nimport {WidgetRestClient} from \"./utils/restclient\"\nimport {WidgetRestAnswerHandler} from \"./rest.handler\";\nimport {WidgetImPullCommandHandler, WidgetImopenlinesPullCommandHandler} from \"./pull.handler\";\n\n// main\nimport {md5} from \"main.md5\";\nimport \"main.date\";\n\n// pull\nimport {PullClient} from \"pull.client\";\n\n// ui\nimport {Vue} from \"ui.vue\";\nimport {VuexBuilder} from \"ui.vue.vuex\";\n\n// messenger files\nimport {Controller} from 'im.controller';\nimport {\n\tRestMethod as ImRestMethod,\n\tRestMethodHandler as ImRestMethodHandler,\n\tEventType,\n\tFileStatus\n} from 'im.const';\n\nimport {Cookie} from \"im.lib.cookie\";\nimport {Utils} from \"im.lib.utils\";\nimport {LocalStorage} from \"im.lib.localstorage\";\nimport {Logger} from \"im.lib.logger\";\n\n// TODO change BX.Promise, BX.Main.Date to IMPORT\n\nexport class Widget\n{\n/* region 01. Initialize and store data */\n\n\tconstructor(params = {})\n\t{\n\t\tthis.params = params;\n\n\t\tthis.template = null;\n\t\tthis.rootNode = this.params.node || document.createElement('div');\n\n\t\tthis.messagesQueue = [];\n\n\t\tthis.ready = true;\n\t\tthis.widgetDataRequested = false;\n\t\tthis.offline = false;\n\n\t\tthis.inited = false;\n\t\tthis.initEventFired = false;\n\n\t\tthis.restClient = null;\n\n\t\tthis.userRegisterData = {};\n\t\tthis.customData = [];\n\n\t\tthis.subscribers = {};\n\n\t\tthis.configRequestXhr = null;\n\n\t\tthis.initParams()\n\t\t\t.then(() => this.initRestClient())\n\t\t\t.then(() => this.initPullClient())\n\t\t\t.then(() => this.initCore())\n\t\t\t.then(() => this.initWidget())\n\t\t\t.then(() => this.initComplete())\n\t\t;\n\t}\n\n\tinitParams()\n\t{\n\t\tthis.code = this.params.code || '';\n\t\tthis.host = this.params.host || '';\n\t\tthis.language = this.params.language || 'en';\n\t\tthis.copyright = this.params.copyright !== false;\n\t\tthis.copyrightUrl = this.copyright && this.params.copyrightUrl? this.params.copyrightUrl: '';\n\t\tthis.buttonInstance = typeof this.params.buttonInstance === 'object' && this.params.buttonInstance !== null? this.params.buttonInstance: null;\n\n\t\tthis.pageMode = typeof this.params.pageMode === 'object' && this.params.pageMode;\n\t\tif (this.pageMode)\n\t\t{\n\t\t\tthis.pageMode.useBitrixLocalize = this.params.pageMode.useBitrixLocalize === true;\n\t\t\tthis.pageMode.placeholder = document.getElementById(this.params.pageMode.placeholder);\n\t\t}\n\n\t\tif (typeof this.code === 'string')\n\t\t{\n\t\t\tif (this.code.length <= 0)\n\t\t\t{\n\t\t\t\tconsole.warn(`%cLiveChatWidget.constructor: code is not correct (%c${this.code}%c)`, \"color: black;\", \"font-weight: bold; color: red\", \"color: black\");\n\t\t\t\tthis.ready = false;\n\t\t\t}\n\t\t}\n\n\t\tif (typeof this.host === 'string')\n\t\t{\n\t\t\tif (this.host.length <= 0 || !this.host.startsWith('http'))\n\t\t\t{\n\t\t\t\tconsole.warn(`%cLiveChatWidget.constructor: host is not correct (%c${this.host}%c)`, \"color: black;\", \"font-weight: bold; color: red\", \"color: black\");\n\t\t\t\tthis.ready = false;\n\t\t\t}\n\t\t}\n\n\t\tif (this.pageMode && this.pageMode.placeholder)\n\t\t{\n\t\t\tthis.rootNode = this.pageMode.placeholder;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (document.body.firstChild)\n\t\t\t{\n\t\t\t\tdocument.body.insertBefore(this.rootNode, document.body.firstChild);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tdocument.body.appendChild(this.rootNode);\n\t\t\t}\n\t\t}\n\n\t\tthis.localize = this.pageMode && this.pageMode.useBitrixLocalize? window.BX.message: {};\n\t\tif (typeof this.params.localize === 'object')\n\t\t{\n\t\t\tthis.addLocalize(this.params.localize);\n\t\t}\n\n\t\tlet serverVariables = LocalStorage.get(this.getSiteId(), 0, 'serverVariables', false);\n\t\tif (serverVariables)\n\t\t{\n\t\t\tthis.addLocalize(serverVariables);\n\t\t}\n\n\t\treturn new Promise((resolve, reject) => resolve());\n\t}\n\n\tinitRestClient()\n\t{\n\t\tthis.restClient = new WidgetRestClient({endpoint: this.host+'/rest'});\n\n\t\treturn new Promise((resolve, reject) => resolve());\n\t}\n\n\tinitPullClient()\n\t{\n\t\tthis.pullClient = new PullClient({\n\t\t\tserverEnabled: true,\n\t\t\tuserId: 0,\n\t\t\tsiteId: this.getSiteId(),\n\t\t\trestClient: this.restClient,\n\t\t\tskipStorageInit: true,\n\t\t\tconfigTimestamp: 0,\n\t\t\tskipCheckRevision: true,\n\t\t\tgetPublicListMethod: 'imopenlines.widget.operator.get',\n\t\t});\n\t\tthis.pullClientInited = false;\n\n\t\treturn new Promise((resolve, reject) => resolve());\n\t}\n\n\tinitCore()\n\t{\n\t\tlet widgetVariables = {\n\t\t\tcommon: {\n\t\t\t\thost: this.getHost(),\n\t\t\t\tpageMode: this.pageMode !== false,\n\t\t\t\tcopyright: this.copyright,\n\t\t\t\tcopyrightUrl: this.copyrightUrl,\n\t\t\t},\n\t\t\tvote: {\n\t\t\t\tmessageText: this.getLocalize('BX_LIVECHAT_VOTE_TITLE'),\n\t\t\t\tmessageLike: this.getLocalize('BX_LIVECHAT_VOTE_PLUS_TITLE'),\n\t\t\t\tmessageDislike: this.getLocalize('BX_LIVECHAT_VOTE_MINUS_TITLE'),\n\t\t\t},\n\t\t\ttextMessages: {\n\t\t\t\tbxLivechatOnlineLine1: this.getLocalize('BX_LIVECHAT_ONLINE_LINE_1'),\n\t\t\t\tbxLivechatOnlineLine2: this.getLocalize('BX_LIVECHAT_ONLINE_LINE_2'),\n\t\t\t\tbxLivechatOffline: this.getLocalize('BX_LIVECHAT_OFFLINE'),\n\t\t\t}\n\t\t};\n\t\tif (\n\t\t\tUtils.types.isPlainObject(this.params.styles)\n\t\t\t&& (this.params.styles.backgroundColor || this.params.styles.iconColor)\n\t\t)\n\t\t{\n\t\t\twidgetVariables.styles = {};\n\t\t\tif (this.params.styles.backgroundColor)\n\t\t\t{\n\t\t\t\twidgetVariables.styles.backgroundColor = this.params.styles.backgroundColor;\n\t\t\t}\n\t\t\tif (this.params.styles.iconColor)\n\t\t\t{\n\t\t\t\twidgetVariables.styles.iconColor = this.params.styles.iconColor;\n\t\t\t}\n\t\t}\n\n\t\tthis.controller = new Controller({\n\t\t\thost: this.getHost(),\n\t\t\tsiteId: this.getSiteId(),\n\t\t\tuserId: 0,\n\t\t\tlanguageId: this.language,\n\t\t\tpull: {client: this.pullClient},\n\t\t\trest: {client: this.restClient},\n\t\t\tlocalize: this.localize,\n\t\t\tvuexBuilder: {\n\t\t\t\tdatabase: !Utils.browser.isIe(),\n\t\t\t\tdatabaseName: 'imol/widget',\n\t\t\t\tdatabaseType: VuexBuilder.DatabaseType.localStorage,\n\t\t\t\tmodels: [\n\t\t\t\t\tWidgetModel.create().setVariables(widgetVariables)\n\t\t\t\t],\n\t\t\t}\n\t\t});\n\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.controller.ready().then(() => resolve());\n\t\t});\n\t}\n\n\tinitWidget()\n\t{\n\t\tif (this.isUserRegistered())\n\t\t{\n\t\t\tthis.restClient.setAuthId(this.getUserHash());\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.restClient.setAuthId(RestAuth.guest);\n\t\t}\n\n\t\tif (this.params.location && typeof LocationStyle[this.params.location] !== 'undefined')\n\t\t{\n\t\t\tthis.controller.getStore().commit('widget/common', {location: this.params.location});\n\t\t}\n\n\t\tthis.controller.application.setPrepareFilesBeforeSaveFunction(this.prepareFileData.bind(this));\n\n\t\tthis.controller.addRestAnswerHandler(\n\t\t\tWidgetRestAnswerHandler.create({\n\t\t\t\twidget: this,\n\t\t\t\tstore: this.controller.getStore(),\n\t\t\t\tcontroller: this.controller,\n\t\t\t})\n\t\t);\n\n\t\treturn new Promise((resolve, reject) => resolve());\n\t}\n\n\tinitComplete()\n\t{\n\t\twindow.dispatchEvent(new CustomEvent('onBitrixLiveChat', {detail: {\n\t\t\twidget: this,\n\t\t\twidgetCode: this.code,\n\t\t\twidgetHost: this.host,\n\t\t}}));\n\n\t\tif (this.callStartFlag)\n\t\t{\n\t\t\tthis.start();\n\t\t}\n\n\t\tif (this.pageMode || this.callOpenFlag)\n\t\t{\n\t\t\tthis.open();\n\t\t}\n\n\t\treturn new Promise((resolve, reject) => resolve());\n\t}\n\n\trequestWidgetData()\n\t{\n\t\tif (!this.isReady())\n\t\t{\n\t\t\tconsole.error('LiveChatWidget.start: widget code or host is not specified');\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.widgetDataRequested = true;\n\t\tif (\n\t\t\t!this.isUserRegistered() && (\n\t\t\t\tthis.userRegisterData.hash\n\t\t\t\t|| this.getUserHashCookie()\n\t\t\t)\n\t\t)\n\t\t{\n\t\t\tthis.requestData();\n\t\t\tthis.inited = true;\n\t\t\tthis.fireInitEvent();\n\t\t}\n\t\telse if (this.isConfigDataLoaded() && this.isUserRegistered())\n\t\t{\n\t\t\tthis.requestData();\n\t\t\tthis.inited = true;\n\t\t\tthis.fireInitEvent();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.controller.restClient.callMethod(RestMethod.widgetConfigGet, {code: this.code}, (xhr) => {this.configRequestXhr = xhr}).then((result) => {\n\t\t\t\tthis.configRequestXhr = null;\n\t\t\t\tthis.clearError();\n\n\t\t\t\tthis.controller.executeRestAnswer(RestMethod.widgetConfigGet, result);\n\n\t\t\t\tif (!this.inited)\n\t\t\t\t{\n\t\t\t\t\tthis.inited = true;\n\t\t\t\t\tthis.fireInitEvent();\n\t\t\t\t}\n\t\t\t}).catch(result => {\n\t\t\t\tthis.configRequestXhr = null;\n\n\t\t\t\tthis.setError(result.error().ex.error, result.error().ex.error_description);\n\t\t\t});\n\n\t\t\tif (this.isConfigDataLoaded())\n\t\t\t{\n\t\t\t\tthis.inited = true;\n\t\t\t\tthis.fireInitEvent();\n\t\t\t}\n\t\t}\n\t}\n\n\trequestData()\n\t{\n\t\tif (this.requestDataSend)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tthis.requestDataSend = true;\n\n\t\tif (this.configRequestXhr)\n\t\t{\n\t\t\tthis.configRequestXhr.abort();\n\t\t}\n\n\t\tlet query = {\n\t\t\t[RestMethod.widgetConfigGet]: [RestMethod.widgetConfigGet, {code: this.code}]\n\t\t};\n\n\t\tif (this.isUserRegistered())\n\t\t{\n\t\t\tquery[RestMethod.widgetDialogGet] = [RestMethod.widgetDialogGet, {config_id: this.getConfigId(), trace_data: this.getCrmTraceData(), custom_data: this.getCustomData()}];\n\t\t\tquery[ImRestMethodHandler.imChatGet] = [ImRestMethod.imChatGet, {dialog_id: '$result['+RestMethod.widgetDialogGet+'][dialogId]'}];\n\t\t\tquery[ImRestMethodHandler.imDialogMessagesGetInit] = [ImRestMethod.imDialogMessagesGet, {chat_id: '$result['+RestMethod.widgetDialogGet+'][chatId]', limit: this.controller.application.getRequestMessageLimit(), convert_text: 'Y'}];\n\t\t}\n\t\telse\n\t\t{\n\t\t\tquery[RestMethod.widgetUserRegister] = [RestMethod.widgetUserRegister, {config_id: '$result['+RestMethod.widgetConfigGet+'][configId]', ...this.getUserRegisterFields()}];\n\t\t\tquery[ImRestMethodHandler.imChatGet] = [ImRestMethod.imChatGet, {dialog_id: '$result['+RestMethod.widgetUserRegister+'][dialogId]'}];\n\n\t\t\tif (this.userRegisterData.hash || this.getUserHashCookie())\n\t\t\t{\n\t\t\t\tquery[RestMethod.widgetDialogGet] = [RestMethod.widgetDialogGet, {config_id: '$result['+RestMethod.widgetConfigGet+'][configId]', trace_data: this.getCrmTraceData(), custom_data: this.getCustomData()}];\n\t\t\t\tquery[ImRestMethodHandler.imDialogMessagesGetInit] = [ImRestMethod.imDialogMessagesGet, {chat_id: '$result['+RestMethod.widgetDialogGet+'][chatId]', limit: this.controller.application.getRequestMessageLimit(), convert_text: 'Y'}];\n\t\t\t}\n\t\t\tif (this.isUserAgreeConsent())\n\t\t\t{\n\t\t\t\tquery[RestMethod.widgetUserConsentApply] = [RestMethod.widgetUserConsentApply, {config_id: '$result['+RestMethod.widgetConfigGet+'][configId]', consent_url: location.href}];\n\t\t\t}\n\t\t}\n\n\t\tquery[RestMethod.pullServerTime] = [RestMethod.pullServerTime, {}];\n\t\tquery[RestMethod.pullConfigGet] = [RestMethod.pullConfigGet, {'CACHE': 'N'}];\n\t\tquery[RestMethod.widgetUserGet] = [RestMethod.widgetUserGet, {}];\n\n\t\tthis.controller.restClient.callBatch(query, (response) =>\n\t\t{\n\t\t\tif (!response)\n\t\t\t{\n\t\t\t\tthis.requestDataSend = false;\n\t\t\t\tthis.setError('EMPTY_RESPONSE', 'Server returned an empty response.');\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tlet configGet = response[RestMethod.widgetConfigGet];\n\t\t\tif (configGet && configGet.error())\n\t\t\t{\n\t\t\t\tthis.requestDataSend = false;\n\n\t\t\t\tthis.setError(configGet.error().ex.error, configGet.error().ex.error_description);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tthis.controller.executeRestAnswer(RestMethod.widgetConfigGet, configGet);\n\n\t\t\tlet userGetResult = response[RestMethod.widgetUserGet];\n\t\t\tif (userGetResult.error())\n\t\t\t{\n\t\t\t\tthis.requestDataSend = false;\n\t\t\t\tthis.setError(userGetResult.error().ex.error, userGetResult.error().ex.error_description);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tthis.controller.executeRestAnswer(RestMethod.widgetUserGet, userGetResult);\n\n\t\t\tlet chatGetResult = response[ImRestMethodHandler.imChatGet];\n\t\t\tif (chatGetResult.error())\n\t\t\t{\n\t\t\t\tthis.requestDataSend = false;\n\t\t\t\tthis.setError(chatGetResult.error().ex.error, chatGetResult.error().ex.error_description);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tthis.controller.executeRestAnswer(ImRestMethodHandler.imChatGet, chatGetResult);\n\n\t\t\tlet dialogGetResult = response[RestMethod.widgetDialogGet];\n\t\t\tif (dialogGetResult)\n\t\t\t{\n\t\t\t\tif (dialogGetResult.error())\n\t\t\t\t{\n\t\t\t\t\tthis.requestDataSend = false;\n\t\t\t\t\tthis.setError(dialogGetResult.error().ex.error, dialogGetResult.error().ex.error_description);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tthis.controller.executeRestAnswer(RestMethod.widgetDialogGet, dialogGetResult);\n\t\t\t}\n\n\t\t\tlet dialogMessagesGetResult = response[ImRestMethodHandler.imDialogMessagesGetInit];\n\t\t\tif (dialogMessagesGetResult)\n\t\t\t{\n\t\t\t\tif (dialogMessagesGetResult.error())\n\t\t\t\t{\n\t\t\t\t\tthis.requestDataSend = false;\n\t\t\t\t\tthis.setError(dialogMessagesGetResult.error().ex.error, dialogMessagesGetResult.error().ex.error_description);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tthis.controller.getStore().dispatch('dialogues/saveDialog', {\n\t\t\t\t\tdialogId: this.controller.application.getDialogId(),\n\t\t\t\t\tchatId: this.controller.application.getChatId(),\n\t\t\t\t});\n\n\t\t\t\tthis.controller.executeRestAnswer(ImRestMethodHandler.imDialogMessagesGetInit, dialogMessagesGetResult);\n\t\t\t}\n\n\t\t\tlet userRegisterResult = response[RestMethod.widgetUserRegister];\n\t\t\tif (userRegisterResult)\n\t\t\t{\n\t\t\t\tif (userRegisterResult.error())\n\t\t\t\t{\n\t\t\t\t\tthis.requestDataSend = false;\n\t\t\t\t\tthis.setError(userRegisterResult.error().ex.error, userRegisterResult.error().ex.error_description);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tthis.controller.executeRestAnswer(RestMethod.widgetUserRegister, userRegisterResult);\n\t\t\t}\n\n\t\t\tlet timeShift = 0;\n\n\t\t\tlet serverTimeResult = response[RestMethod.pullServerTime];\n\t\t\tif (serverTimeResult && !serverTimeResult.error())\n\t\t\t{\n\t\t\t\ttimeShift = Math.floor(((new Date()).getTime() - new Date(serverTimeResult.data()).getTime())/1000);\n\t\t\t}\n\n\t\t\tlet config = null;\n\t\t\tlet pullConfigResult = response[RestMethod.pullConfigGet];\n\t\t\tif (pullConfigResult && !pullConfigResult.error())\n\t\t\t{\n\t\t\t\tconfig = pullConfigResult.data();\n\t\t\t\tconfig.server.timeShift = timeShift;\n\t\t\t}\n\n\t\t\tthis.startPullClient(config).then(() => {\n\t\t\t\tthis.processSendMessages();\n\t\t\t}).catch((error) => {\n\t\t\t\tthis.setError(error.ex.error, error.ex.error_description);\n\t\t\t});\n\n\t\t\tthis.requestDataSend = false;\n\t\t}, false, false, Utils.getLogTrackingParams({name: 'widget.init.config', dialog: this.controller.application.getDialogData()}));\n\t}\n\n\tprepareFileData(files)\n\t{\n\t\tif (!Utils.types.isArray(files))\n\t\t{\n\t\t\treturn files;\n\t\t}\n\n\t\treturn files.map(file =>\n\t\t{\n\t\t\tlet hash = (window.md5 || md5)(this.getUserId()+'|'+file.id+'|'+this.getUserHash());\n\t\t\tlet urlParam = 'livechat_auth_id='+hash+'&livechat_user_id='+this.getUserId();\n\t\t\tif (file.urlPreview)\n\t\t\t{\n\t\t\t\tfile.urlPreview = file.urlPreview+'&'+urlParam;\n\t\t\t}\n\t\t\tif (file.urlShow)\n\t\t\t{\n\t\t\t\tfile.urlShow = file.urlShow+'&'+urlParam;\n\t\t\t}\n\t\t\tif (file.urlDownload)\n\t\t\t{\n\t\t\t\tfile.urlDownload = file.urlDownload+'&'+urlParam;\n\t\t\t}\n\n\t\t\treturn file;\n\t\t});\n\t}\n\n\tcheckBrowserVersion()\n\t{\n\t\tif (Utils.platform.isIos())\n\t\t{\n\t\t\tlet version = Utils.platform.getIosVersion();\n\t\t\tif (version && version <= 10)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\treturn true;\n\t}\n\n/* endregion 01. Initialize and store data */\n\n/* region 02. Push & Pull */\n\n\tstartPullClient(config)\n\t{\n\t\tlet promise = new BX.Promise();\n\n\t\tif (!this.getUserId() || !this.getSiteId() || !this.restClient)\n\t\t{\n\t\t\tpromise.reject({\n\t\t\t\tex: { error: 'WIDGET_NOT_LOADED', error_description: 'Widget is not loaded.'}\n\t\t\t});\n\t\t\treturn promise;\n\t\t}\n\n\t\tif (this.pullClientInited)\n\t\t{\n\t\t\tif (!this.pullClient.isConnected())\n\t\t\t{\n\t\t\t\tthis.pullClient.scheduleReconnect();\n\t\t\t}\n\t\t\tpromise.resolve(true);\n\t\t\treturn promise;\n\t\t}\n\n\t\tthis.controller.userId = this.getUserId();\n\t\tthis.pullClient.userId = this.getUserId();\n\t\tthis.pullClient.configTimestamp = config? config.server.config_timestamp: 0;\n\t\tthis.pullClient.skipStorageInit = false;\n\t\tthis.pullClient.storage = PullClient.StorageManager({\n\t\t\tuserId: this.getUserId(),\n\t\t\tsiteId: this.getSiteId()\n\t\t});\n\n\t\tthis.pullClient.subscribe(\n\t\t\tnew WidgetImPullCommandHandler({\n\t\t\t\tstore: this.controller.getStore(),\n\t\t\t\tcontroller: this.controller,\n\t\t\t\twidget: this,\n\t\t\t})\n\t\t);\n\t\tthis.pullClient.subscribe(\n\t\t\tnew WidgetImopenlinesPullCommandHandler({\n\t\t\t\tstore: this.controller.getStore(),\n\t\t\t\tcontroller: this.controller,\n\t\t\t\twidget: this,\n\t\t\t})\n\t\t);\n\n\t\tthis.pullClient.subscribe({\n\t\t\ttype: PullClient.SubscriptionType.Status,\n\t\t\tcallback: this.eventStatusInteraction.bind(this)\n\t\t});\n\n\t\tthis.pullConnectedFirstTime = this.pullClient.subscribe({\n\t\t\ttype: PullClient.SubscriptionType.Status,\n\t\t\tcallback: (result) => {\n\t\t\t\tif (result.status === PullClient.PullStatus.Online)\n\t\t\t\t{\n\t\t\t\t\tpromise.resolve(true);\n\t\t\t\t\tthis.pullConnectedFirstTime();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tif (this.template)\n\t\t{\n\t\t\tthis.template.$root.$bitrixPullClient = this.pullClient;\n\t\t\tthis.template.$root.$emit('onBitrixPullClientInited', this.pullClient);\n\t\t}\n\n\t\tthis.pullClient.start({\n\t\t\t...config,\n\t\t\tskipReconnectToLastSession: true\n\t\t}).catch(function(){\n\t\t\tpromise.reject({\n\t\t\t\tex: { error: 'PULL_CONNECTION_ERROR', error_description: 'Pull is not connected.'}\n\t\t\t});\n\t\t});\n\n\t\tthis.pullClientInited = true;\n\n\t\treturn promise;\n\t}\n\n\tstopPullClient()\n\t{\n\t\tif (this.pullClient)\n\t\t{\n\t\t\tthis.pullClient.stop(PullClient.CloseReasons.MANUAL, 'Closed manually');\n\t\t}\n\t}\n\n\trecoverPullConnection()\n\t{\n\t\t// this.pullClient.session.mid = 0; // TODO specially for disable pull history, remove after recode im\n\t\tthis.pullClient.restart(PullClient.CloseReasons.MANUAL, 'Restart after click by connection status button.');\n\t}\n\n\teventStatusInteraction(data)\n\t{\n\t\tif (data.status === PullClient.PullStatus.Online)\n\t\t{\n\t\t\tthis.offline = false;\n\n\t\t\tif (this.pullRequestMessage)\n\t\t\t{\n\t\t\t\tthis.getDialogUnread().then(() => {\n\t\t\t\t\tthis.processSendMessages();\n\t\t\t\t});\n\t\t\t\tthis.pullRequestMessage = false;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.readMessage();\n\t\t\t\tthis.processSendMessages();\n\t\t\t}\n\t\t}\n\t\telse if (data.status === PullClient.PullStatus.Offline)\n\t\t{\n\t\t\tthis.pullRequestMessage = true;\n\t\t\tthis.offline = true;\n\t\t}\n\t}\n\n/* endregion 02. Push & Pull */\n\n/* region 03. Template engine */\n\n\tattachTemplate()\n\t{\n\t\tif (this.template)\n\t\t{\n\t\t\tthis.controller.getStore().commit('widget/common', {showed: true});\n\t\t\treturn true;\n\t\t}\n\n\t\tthis.rootNode.innerHTML = '';\n\t\tthis.rootNode.appendChild(document.createElement('div'));\n\n\t\tlet application = this;\n\n\t\treturn this.controller.createVue(application, {\n\t\t\tel: this.rootNode.firstChild,\n\t\t\ttemplate: '<bx-livechat/>',\n\t\t\tbeforeCreate()\n\t\t\t{\n\t\t\t\tapplication.sendEvent({\n\t\t\t\t\ttype: SubscriptionType.widgetOpen,\n\t\t\t\t\tdata: {}\n\t\t\t\t});\n\t\t\t},\n\t\t\tdestroyed()\n\t\t\t{\n\t\t\t\tapplication.sendEvent({\n\t\t\t\t\ttype: SubscriptionType.widgetClose,\n\t\t\t\t\tdata: {}\n\t\t\t\t});\n\t\t\t\tapplication.template = null;\n\t\t\t\tapplication.templateAttached = false;\n\t\t\t\tapplication.rootNode.innerHTML = '';\n\t\t\t}\n\t\t}).then(vue => {\n\t\t\tthis.template = vue;\n\t\t\treturn new Promise((resolve, reject) => resolve());\n\t\t});\n\t}\n\n\tdetachTemplate()\n\t{\n\t\tif (!this.template)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tthis.template.$destroy();\n\n\t\treturn true;\n\t}\n\n\tmutateTemplateComponent(id, params)\n\t{\n\t\treturn Vue.mutateComponent(id, params);\n\t}\n\n/* endregion 03. Template engine */\n\n/* region 04. Rest methods */\n\n\taddMessage(text = '', file = null)\n\t{\n\t\tif (!text && !file)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tLogger.warn('addMessage', text, file);\n\n\t\tif (!this.controller.application.isUnreadMessagesLoaded())\n\t\t{\n\t\t\tthis.sendMessage({id: 0, text, file});\n\t\t\tthis.processSendMessages();\n\n\t\t\treturn true;\n\t\t}\n\n\t\tthis.controller.getStore().commit('application/increaseDialogExtraCount');\n\n\t\tlet params = {};\n\t\tif (file)\n\t\t{\n\t\t\tparams.FILE_ID = [file.id];\n\t\t}\n\n\t\tthis.controller.getStore().dispatch('messages/add', {\n\t\t\tchatId: this.getChatId(),\n\t\t\tauthorId: this.getUserId(),\n\t\t\ttext: text,\n\t\t\tparams,\n\t\t\tsending: !file,\n\t\t}).then(messageId => {\n\n\t\t\tif (!this.isDialogStart())\n\t\t\t{\n\t\t\t\tthis.controller.getStore().commit('widget/common', {dialogStart:true});\n\t\t\t}\n\n\t\t\tthis.messagesQueue.push({\n\t\t\t\tid: messageId,\n\t\t\t\ttext,\n\t\t\t\tfile,\n\t\t\t\tsending: false\n\t\t\t});\n\n\t\t\tif (this.getChatId())\n\t\t\t{\n\t\t\t\tthis.processSendMessages();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.requestData();\n\t\t\t}\n\t\t});\n\n\t\treturn true;\n\t}\n\n\tuploadFile(fileInput)\n\t{\n\t\tif (!fileInput)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tLogger.warn('addFile', fileInput.files[0].name, fileInput.files[0].size, fileInput.files[0]);\n\n\t\tlet file = fileInput.files[0];\n\n\t\tlet fileType = 'file';\n\t\tif (file.type.toString().startsWith('image'))\n\t\t{\n\t\t\tfileType = 'image';\n\t\t}\n\n\t\tif (!this.controller.application.isUnreadMessagesLoaded())\n\t\t{\n\t\t\tthis.addMessage('', {id: 0, source: fileInput});\n\t\t\treturn true;\n\t\t}\n\n\t\tthis.controller.getStore().dispatch('files/add', {\n\t\t\tchatId: this.getChatId(),\n\t\t\tauthorId: this.getUserId(),\n\t\t\tname: file.name,\n\t\t\ttype: fileType,\n\t\t\textension: file.name.split('.').splice(-1)[0],\n\t\t\tsize: file.size,\n\t\t\timage: false,\n\t\t\tstatus: FileStatus.upload,\n\t\t\tprogress: 0,\n\t\t\tauthorName: this.controller.application.getCurrentUser().name,\n\t\t\turlPreview: \"\",\n\t\t}).then(fileId => this.addMessage('', {id: fileId, source: fileInput}));\n\n\t\treturn true;\n\t}\n\n\tcancelUploadFile(fileId)\n\t{\n\t\tlet element = this.messagesQueue.find(element => element.file && element.file.id === fileId);\n\t\tif (element)\n\t\t{\n\t\t\tif (element.xhr)\n\t\t\t{\n\t\t\t\telement.xhr.abort();\n\t\t\t}\n\t\t\tthis.controller.getStore().dispatch('messages/delete', {\n\t\t\t\tchatId: this.getChatId(),\n\t\t\t\tid: element.id,\n\t\t\t}).then(() => {\n\t\t\t\tthis.controller.getStore().dispatch('files/delete', {\n\t\t\t\t\tchatId: this.getChatId(),\n\t\t\t\t\tid: element.file.id,\n\t\t\t\t});\n\t\t\t\tthis.messagesQueue = this.messagesQueue.filter(el => el.id !== element.id);\n\t\t\t});\n\t\t}\n\t}\n\n\tprocessSendMessages()\n\t{\n\t\tif (this.offline)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.messagesQueue.filter(element => !element.sending).forEach(element => {\n\t\t\telement.sending = true;\n\t\t\tif (element.file)\n\t\t\t{\n\t\t\t\tthis.sendMessageWithFile(element);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.sendMessage(element);\n\t\t\t}\n\t\t});\n\n\t\treturn true;\n\t}\n\n\tsendMessage(message)\n\t{\n\t\tthis.controller.application.stopWriting();\n\n\t\tlet quiteId = this.controller.getStore().getters['dialogues/getQuoteId'](this.getDialogId());\n\t\tif (quiteId)\n\t\t{\n\t\t\tlet quoteMessage = this.controller.getStore().getters['messages/getMessage'](this.getChatId(), quiteId);\n\t\t\tif (quoteMessage)\n\t\t\t{\n\t\t\t\tlet user = this.controller.getStore().getters['users/get'](quoteMessage.authorId);\n\n\t\t\t\tlet newMessage = [];\n\t\t\t\tnewMessage.push(\"------------------------------------------------------\");\n\t\t\t\tnewMessage.push((user.name? user.name: this.getLocalize('BX_LIVECHAT_SYSTEM_MESSAGE')));\n\t\t\t\tnewMessage.push(quoteMessage.text);\n\t\t\t\tnewMessage.push('------------------------------------------------------');\n\t\t\t\tnewMessage.push(message.text);\n\t\t\t\tmessage.text = newMessage.join(\"\\n\");\n\n\t\t\t\tthis.quoteMessageClear();\n\t\t\t}\n\t\t}\n\n\t\tmessage.chatId = this.getChatId();\n\n\t\tthis.controller.restClient.callMethod(ImRestMethod.imMessageAdd, {\n\t\t\t'TEMPLATE_ID': message.id,\n\t\t\t'CHAT_ID': message.chatId,\n\t\t\t'MESSAGE': message.text\n\t\t}, null, null, Utils.getLogTrackingParams({\n\t\t\tname: ImRestMethod.imMessageAdd,\n\t\t\tdata: {timMessageType: 'text'},\n\t\t\tdialog: this.getDialogData()\n\t\t})).then(response => {\n\t\t\tthis.controller.executeRestAnswer(ImRestMethodHandler.imMessageAdd, response, message);\n\t\t}).catch(error => {\n\t\t\tthis.controller.executeRestAnswer(ImRestMethodHandler.imMessageAdd, error, message);\n\t\t});\n\n\t\treturn true;\n\t}\n\n\tsendMessageWithFile(message)\n\t{\n\t\tthis.controller.application.stopWriting();\n\n\t\tlet fileType = this.controller.getStore().getters['files/get'](this.getChatId(), message.file.id, true).type;\n\n\t\tlet diskFolderId = this.getDiskFolderId();\n\n\t\tlet query = {};\n\n\t\tif (diskFolderId)\n\t\t{\n\t\t\tquery[ImRestMethodHandler.imDiskFileUpload] = [ImRestMethod.imDiskFileUpload, {\n\t\t\t\tid : diskFolderId,\n\t\t\t\tdata : {NAME : message.file.source.files[0].name},\n\t\t\t\tfileContent: message.file.source,\n\t\t\t\tgenerateUniqueName: true\n\t\t\t}];\n\t\t}\n\t\telse\n\t\t{\n\t\t\tquery[ImRestMethodHandler.imDiskFolderGet] = [ImRestMethod.imDiskFolderGet, {chat_id: this.getChatId()}];\n\t\t\tquery[ImRestMethodHandler.imDiskFileUpload] = [ImRestMethod.imDiskFileUpload, {\n\t\t\t\tid: '$result[' + ImRestMethodHandler.imDiskFolderGet + '][ID]',\n\t\t\t\tdata: {\n\t\t\t\t\tNAME: message.file.source.files[0].name\n\t\t\t\t},\n\t\t\t\tfileContent: message.file.source,\n\t\t\t\tgenerateUniqueName: true\n\t\t\t}];\n\t\t}\n\n\t\tthis.controller.restClient.callBatch(query, (response) =>\n\t\t{\n\t\t\tif (!response)\n\t\t\t{\n\t\t\t\tthis.requestDataSend = false;\n\t\t\t\tconsole.warn('EMPTY_RESPONSE', 'Server returned an empty response. [1]');\n\t\t\t\tthis.fileError(this.getChatId, message.file.id, message.id);\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (!diskFolderId)\n\t\t\t{\n\t\t\t\tlet diskFolderGet = response[ImRestMethodHandler.imDiskFolderGet];\n\t\t\t\tif (diskFolderGet && diskFolderGet.error())\n\t\t\t\t{\n\t\t\t\t\tconsole.warn(diskFolderGet.error().ex.error, diskFolderGet.error().ex.error_description);\n\t\t\t\t\tthis.fileError(this.getChatId(), message.file.id, message.id);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tthis.controller.executeRestAnswer(ImRestMethodHandler.imDiskFolderGet, diskFolderGet);\n\t\t\t}\n\n\t\t\tlet diskId = 0;\n\t\t\tlet diskFileUpload = response[ImRestMethodHandler.imDiskFileUpload];\n\t\t\tif (diskFileUpload)\n\t\t\t{\n\t\t\t\tlet result = diskFileUpload.data();\n\t\t\t\tif (diskFileUpload.error())\n\t\t\t\t{\n\t\t\t\t\tconsole.warn(diskFileUpload.error().ex.error, diskFileUpload.error().ex.error_description);\n\t\t\t\t\tthis.fileError(this.getChatId(), message.file.id, message.id);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\telse if (!result)\n\t\t\t\t{\n\t\t\t\t\tconsole.warn('EMPTY_RESPONSE', 'Server returned an empty response. [2]');\n\t\t\t\t\tthis.fileError(this.getChatId(), message.file.id, message.id);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tdiskId = result.ID;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconsole.warn('EMPTY_RESPONSE', 'Server returned an empty response. [3]');\n\t\t\t\tthis.fileError(this.getChatId(), message.file.id, message.id);\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tmessage.chatId = this.getChatId();\n\n\t\t\tthis.controller.getStore().dispatch('files/update', {\n\t\t\t\tchatId: message.chatId,\n\t\t\t\tid: message.file.id,\n\t\t\t\tfields: {\n\t\t\t\t\tstatus: FileStatus.wait,\n\t\t\t\t\tprogress: 95\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.fileCommit({\n\t\t\t\tchatId: message.chatId,\n\t\t\t\tuploadId: diskId,\n\t\t\t\tmessageText: message.text,\n\t\t\t\tmessageId: message.id,\n\t\t\t\tfileId: message.file.id,\n\t\t\t\tfileType\n\t\t\t}, message);\n\n\t\t}, false, (xhr) => {message.xhr = xhr}, Utils.getLogTrackingParams({\n\t\t\tname: ImRestMethodHandler.imDiskFileCommit,\n\t\t\tdata: {timMessageType: fileType},\n\t\t\tdialog: this.getDialogData()\n\t\t}));\n\t}\n\n\tfileError(chatId, fileId, messageId = 0)\n\t{\n\t\tthis.controller.getStore().dispatch('files/update', {\n\t\t\tchatId: chatId,\n\t\t\tid: fileId,\n\t\t\tfields: {\n\t\t\t\tstatus: FileStatus.error,\n\t\t\t\tprogress: 0\n\t\t\t}\n\t\t});\n\t\tif (messageId)\n\t\t{\n\t\t\tthis.controller.getStore().dispatch('messages/actionError', {\n\t\t\t\tchatId: chatId,\n\t\t\t\tid: messageId,\n\t\t\t\tretry: false,\n\t\t\t});\n\t\t}\n\t}\n\n\tfileCommit(params, message)\n\t{\n\t\tthis.controller.restClient.callMethod(ImRestMethod.imDiskFileCommit, {\n\t\t\tchat_id: params.chatId,\n\t\t\tupload_id: params.uploadId,\n\t\t\tmessage: params.messageText,\n\t\t\ttemplate_id: params.messageId,\n\t\t\tfile_template_id: params.fileId,\n\t\t}, null, null, Utils.getLogTrackingParams({\n\t\t\tname: ImRestMethod.imDiskFileCommit,\n\t\t\tdata: {timMessageType: params.fileType},\n\t\t\tdialog: this.getDialogData()\n\t\t})).then(response => {\n\t\t\tthis.controller.executeRestAnswer(ImRestMethodHandler.imDiskFileCommit, response, message);\n\t\t}).catch(error => {\n\t\t\tthis.controller.executeRestAnswer(ImRestMethodHandler.imDiskFileCommit, error, message);\n\t\t});\n\n\t\treturn true;\n\t}\n\n\tgetDialogHistory(lastId, limit = this.controller.application.getRequestMessageLimit())\n\t{\n\t\tthis.controller.restClient.callMethod(ImRestMethod.imDialogMessagesGet, {\n\t\t\t'CHAT_ID': this.getChatId(),\n\t\t\t'LAST_ID': lastId,\n\t\t\t'LIMIT': limit,\n\t\t\t'CONVERT_TEXT': 'Y'\n\t\t}).then(result => {\n\t\t\tthis.controller.executeRestAnswer(ImRestMethodHandler.imDialogMessagesGet, result);\n\t\t\tthis.template.$emit(EventType.dialog.requestHistoryResult, {count: result.data().messages.length});\n\t\t}).catch(result => {\n\t\t\tthis.template.$emit(EventType.dialog.requestHistoryResult, {error: result.error().ex});\n\t\t});\n\t}\n\n\tgetDialogUnread(lastId, limit = this.controller.application.getRequestMessageLimit())\n\t{\n\t\tconst promise = new BX.Promise();\n\n\t\tif (!lastId)\n\t\t{\n\t\t\tlastId = this.controller.getStore().getters['messages/getLastId'](this.controller.application.getChatId());\n\t\t}\n\n\t\tif (!lastId)\n\t\t{\n\t\t\tthis.template.$emit(EventType.dialog.requestUnreadResult, {error: {error: 'LAST_ID_EMPTY', error_description: 'LastId is empty.'}});\n\t\t\tpromise.reject();\n\t\t\treturn promise;\n\t\t}\n\n\t\tthis.controller.application.readMessage(lastId, true, true).then(() =>\n\t\t{\n\t\t\tlet query = {\n\t\t\t\t[ImRestMethodHandler.imDialogRead]: [ImRestMethod.imDialogRead, {\n\t\t\t\t\tdialog_id: this.getDialogId(),\n\t\t\t\t\tmessage_id: lastId\n\t\t\t\t}],\n\t\t\t\t[ImRestMethodHandler.imChatGet]: [ImRestMethod.imChatGet, {\n\t\t\t\t\tdialog_id: this.getDialogId()\n\t\t\t\t}],\n\t\t\t\t[ImRestMethodHandler.imDialogMessagesGetUnread]: [ImRestMethod.imDialogMessagesGet, {\n\t\t\t\t\tchat_id: this.getChatId(),\n\t\t\t\t\tfirst_id: lastId,\n\t\t\t\t\tlimit: limit,\n\t\t\t\t\tconvert_text: 'Y'\n\t\t\t\t}]\n\t\t\t};\n\n\t\t\tthis.controller.restClient.callBatch(query, (response) =>\n\t\t\t{\n\t\t\t\tif (!response)\n\t\t\t\t{\n\t\t\t\t\tthis.template.$emit(EventType.dialog.requestUnreadResult, {error: {error: 'EMPTY_RESPONSE', error_description: 'Server returned an empty response.'}});\n\n\t\t\t\t\tpromise.reject();\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tlet chatGetResult = response[ImRestMethodHandler.imChatGet];\n\t\t\t\tif (!chatGetResult.error())\n\t\t\t\t{\n\t\t\t\t\tthis.controller.executeRestAnswer(ImRestMethodHandler.imChatGet, chatGetResult);\n\t\t\t\t}\n\n\t\t\t\tlet dialogMessageUnread = response[ImRestMethodHandler.imDialogMessagesGetUnread];\n\t\t\t\tif (dialogMessageUnread.error())\n\t\t\t\t{\n\t\t\t\t\tthis.template.$emit(EventType.dialog.requestUnreadResult, {error: dialogMessageUnread.error().ex});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.controller.executeRestAnswer(ImRestMethodHandler.imDialogMessagesGetUnread, dialogMessageUnread);\n\t\t\t\t\tthis.template.$emit(EventType.dialog.requestUnreadResult, {\n\t\t\t\t\t\tfirstMessageId: dialogMessageUnread.data().messages.length > 0? dialogMessageUnread.data().messages[0].id: 0,\n\t\t\t\t\t\tcount: dialogMessageUnread.data().messages.length\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tpromise.fulfill(response);\n\n\t\t\t}, false, false, Utils.getLogTrackingParams({name: ImRestMethodHandler.imDialogMessagesGetUnread, dialog: this.getDialogData()}));\n\t\t});\n\n\t\treturn promise;\n\t}\n\n\tretrySendMessage(message)\n\t{\n\t\tif (this.messagesQueue.find(el => el.id === message.id))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.messagesQueue.push({\n\t\t\tid: message.id,\n\t\t\ttext: message.text,\n\t\t\tsending: false\n\t\t});\n\n\t\tthis.controller.application.setSendingMessageFlag(message.id);\n\n\t\tthis.processSendMessages();\n\t}\n\n\treadMessage(messageId)\n\t{\n\t\tif (this.offline)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\treturn this.controller.application.readMessage(messageId);\n\t}\n\n\tquoteMessage(id)\n\t{\n\t\tthis.controller.getStore().dispatch('dialogues/update', {\n\t\t\tdialogId: this.controller.application.getDialogId(),\n\t\t\tfields: {\n\t\t\t\tquoteId: id\n\t\t\t}\n\t\t});\n\t}\n\n\treactMessage(id, reaction)\n\t{\n\t\tthis.controller.application.reactMessage(id, reaction.type, reaction.action);\n\t}\n\n\texecMessageKeyboardCommand(data)\n\t{\n\t\tif (data.action !== 'COMMAND')\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tlet {dialogId, messageId, botId, command, params} = data.params;\n\n\t\tthis.controller.restClient.callMethod(ImRestMethod.imMessageCommand, {\n\t\t\t'MESSAGE_ID': messageId,\n\t\t\t'DIALOG_ID': dialogId,\n\t\t\t'BOT_ID': botId,\n\t\t\t'COMMAND': command,\n\t\t\t'COMMAND_PARAMS': params,\n\t\t});\n\n\t\treturn true;\n\t}\n\n\tquoteMessageClear()\n\t{\n\t\tthis.controller.getStore().dispatch('dialogues/update', {\n\t\t\tdialogId: this.controller.application.getDialogId(),\n\t\t\tfields: {\n\t\t\t\tquoteId: 0\n\t\t\t}\n\t\t});\n\t}\n\n\tsendDialogVote(result)\n\t{\n\t\tif (!this.getSessionId())\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.controller.restClient.callMethod(RestMethod.widgetVoteSend, {\n\t\t\t'SESSION_ID': this.getSessionId(),\n\t\t\t'ACTION': result\n\t\t}).catch((result) => {\n\t\t\tthis.controller.getStore().commit('widget/dialog', {userVote: VoteType.none});\n\t\t});\n\n\t\tthis.sendEvent({\n\t\t\ttype: SubscriptionType.userVote,\n\t\t\tdata: {\n\t\t\t\tvote: result\n\t\t\t}\n\t\t});\n\t}\n\n\tsendForm(type, fields)\n\t{\n\t\tLogger.info('LiveChatWidgetPrivate.sendForm:', type, fields);\n\n\t\tlet query = {\n\t\t\t[RestMethod.widgetFormSend]: [RestMethod.widgetFormSend, {\n\t\t\t\t'CHAT_ID': this.getChatId(),\n\t\t\t\t'FORM': type.toUpperCase(),\n\t\t\t\t'FIELDS': fields\n\t\t\t}],\n\t\t\t[RestMethod.widgetUserGet]: [RestMethod.widgetUserGet, {}]\n\t\t};\n\t\tthis.controller.restClient.callBatch(query, (response) =>\n\t\t{\n\t\t\tif (!response)\n\t\t\t{\n\t\t\t\tthis.requestDataSend = false;\n\t\t\t\tthis.setError('EMPTY_RESPONSE', 'Server returned an empty response.');\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tlet userGetResult = response[RestMethod.widgetUserGet];\n\t\t\tif (userGetResult.error())\n\t\t\t{\n\t\t\t\tthis.requestDataSend = false;\n\t\t\t\tthis.setError(userGetResult.error().ex.error, userGetResult.error().ex.error_description);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tthis.controller.executeRestAnswer(RestMethod.widgetUserGet, userGetResult);\n\n\t\t\tthis.sendEvent({\n\t\t\t\ttype: SubscriptionType.userForm,\n\t\t\t\tdata: {\n\t\t\t\t\tform: type,\n\t\t\t\t\tfields: fields\n\t\t\t\t}\n\t\t\t});\n\n\t\t}, false, false, Utils.getLogTrackingParams({name: RestMethod.widgetUserGet, dialog: this.getDialogData()}));\n\n\t}\n\n\tsendConsentDecision(result)\n\t{\n\t\tresult = result === true;\n\n\t\tthis.controller.getStore().commit('widget/dialog', {userConsent: result});\n\n\t\tif (result && this.isUserRegistered())\n\t\t{\n\t\t\tthis.controller.restClient.callMethod(RestMethod.widgetUserConsentApply, {\n\t\t\t\tconfig_id: this.getConfigId(),\n\t\t\t\tconsent_url: location.href\n\t\t\t});\n\t\t}\n\t}\n\n/* endregion 05. Templates and template interaction */\n\n/* region 05. Widget interaction and utils */\n\n\tstart()\n\t{\n\t\tif (!this.controller || !this.controller.getStore())\n\t\t{\n\t\t\tthis.callStartFlag = true;\n\t\t\treturn true;\n\t\t}\n\n\t\tif (this.isSessionActive())\n\t\t{\n\t\t\tthis.requestWidgetData();\n\t\t}\n\n\t\treturn true;\n\t}\n\n\topen(params = {})\n\t{\n\t\tclearTimeout(this.openTimeout);\n\t\tif (!this.controller.getStore())\n\t\t{\n\t\t\tthis.callOpenFlag = true;\n\t\t\treturn true;\n\t\t}\n\n\t\tif (!params.openFromButton && this.buttonInstance)\n\t\t{\n\t\t\tthis.buttonInstance.wm.showById('openline_livechat');\n\t\t}\n\n\t\tif (!this.checkBrowserVersion())\n\t\t{\n\t\t\tthis.setError('OLD_BROWSER_LOCALIZED', this.localize.BX_LIVECHAT_OLD_BROWSER);\n\t\t}\n\t\telse if (Utils.versionCompare(Vue.version(), '2.1') < 0)\n\t\t{\n\t\t\talert(this.localize.BX_LIVECHAT_OLD_VUE);\n\t\t\tconsole.error(`LiveChatWidget.error: OLD_VUE_VERSION (${this.localize.BX_LIVECHAT_OLD_VUE_DEV.replace('#CURRENT_VERSION#', Vue.version())})`);\n\n\t\t\treturn false;\n\t\t}\n\t\telse if (!this.isWidgetDataRequested())\n\t\t{\n\t\t\tthis.requestWidgetData();\n\t\t}\n\n\t\tthis.attachTemplate();\n\t}\n\n\tclose()\n\t{\n\t\tif (this.pageMode)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tif (this.buttonInstance)\n\t\t{\n\t\t\tthis.buttonInstance.onWidgetClose();\n\t\t}\n\n\t\tthis.detachTemplate();\n\t}\n\n\tshowNotification(params)\n\t{\n\t\tif (!this.controller.getStore())\n\t\t{\n\t\t\tconsole.error('LiveChatWidget.showNotification: method can be called after fired event - onBitrixLiveChat');\n\t\t\treturn false;\n\t\t}\n\t\t// TODO show popup notification and set badge on button\n\t\t// operatorName\n\t\t// notificationText\n\t\t// counter\n\t}\n\n\tfireInitEvent()\n\t{\n\t\tif (this.initEventFired)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tthis.sendEvent({\n\t\t\ttype: SubscriptionType.configLoaded,\n\t\t\tdata: {}\n\t\t});\n\n\t\tif (this.controller.getStore().state.widget.common.reopen)\n\t\t{\n\t\t\tthis.open();\n\t\t}\n\n\t\tthis.initEventFired = true;\n\n\t\treturn true;\n\t}\n\n\tisReady()\n\t{\n\t\treturn this.ready;\n\t}\n\n\tisInited()\n\t{\n\t\treturn this.inited;\n\t}\n\n\tisUserRegistered()\n\t{\n\t\treturn !!this.getUserHash();\n\t}\n\n\tisConfigDataLoaded()\n\t{\n\t\treturn this.controller.getStore().state.widget.common.configId;\n\t}\n\n\tisWidgetDataRequested()\n\t{\n\t\treturn this.widgetDataRequested;\n\t}\n\n\tisChatLoaded()\n\t{\n\t\treturn this.controller.getStore().state.application.dialog.chatId > 0;\n\t}\n\n\tisSessionActive()\n\t{\n\t\treturn !this.controller.getStore().state.widget.dialog.sessionClose;\n\t}\n\n\tisUserAgreeConsent()\n\t{\n\t\treturn this.controller.getStore().state.widget.dialog.userConsent;\n\t}\n\n\tgetCrmTraceData()\n\t{\n\t\tlet traceData = '';\n\n\t\tif (!this.buttonInstance)\n\t\t{\n\t\t\treturn traceData;\n\t\t}\n\n\t\tif (typeof this.buttonInstance.getTrace !== 'function')\n\t\t{\n\t\t\ttraceData = this.buttonInstance.getTrace();\n\t\t}\n\t\telse if (\n\t\t\ttypeof this.buttonInstance.b24Tracker !== 'undefined'\n\t\t\t&& typeof this.buttonInstance.b24Tracker.guest !== 'undefined'\n\t\t)\n\t\t{\n\t\t\ttraceData = this.buttonInstance.b24Tracker.guest.getTrace();\n\t\t}\n\n\t\treturn traceData;\n\t}\n\n\tgetCustomData()\n\t{\n\t\tlet customData = [];\n\n\t\tif (this.customData.length > 0)\n\t\t{\n\t\t\tcustomData = this.customData;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tcustomData = [{MESSAGE: this.localize.BX_LIVECHAT_EXTRA_SITE+': '+location.href}];\n\t\t}\n\n\t\treturn JSON.stringify(customData);\n\t}\n\n\tisUserLoaded()\n\t{\n\t\treturn this.controller.getStore().state.widget.user.id > 0;\n\t}\n\n\tgetSiteId()\n\t{\n\t\treturn this.host.replace(/(http.?:\\/\\/)|([:.\\\\\\/])/mg, \"\")+this.code;\n\t}\n\n\tgetHost()\n\t{\n\t\treturn this.host;\n\t}\n\n\tgetConfigId()\n\t{\n\t\treturn this.controller.getStore().state.widget.common.configId;\n\t}\n\n\tisDialogStart()\n\t{\n\t\treturn this.controller.getStore().state.widget.common.dialogStart;\n\t}\n\n\tgetChatId()\n\t{\n\t\treturn this.controller.getStore().state.application.dialog.chatId;\n\t}\n\n\tgetDialogId()\n\t{\n\t\treturn this.controller.getStore().state.application.dialog.dialogId;\n\t}\n\n\tgetDiskFolderId()\n\t{\n\t\treturn this.controller.getStore().state.application.dialog.diskFolderId;\n\t}\n\n\tgetDialogData(dialogId = this.getDialogId())\n\t{\n\t\treturn this.controller.getStore().state.dialogues.collection[dialogId];\n\t}\n\n\tgetSessionId()\n\t{\n\t\treturn this.controller.getStore().state.widget.dialog.sessionId;\n\t}\n\n\tgetUserHash()\n\t{\n\t\treturn this.controller.getStore().state.widget.user.hash;\n\t}\n\n\tgetUserHashCookie()\n\t{\n\t\tlet userHash = '';\n\n\t\tlet cookie = Cookie.get(null, 'LIVECHAT_HASH');\n\t\tif (typeof cookie === 'string' && cookie.match(/^[a-f0-9]{32}$/))\n\t\t{\n\t\t\tuserHash= cookie;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tlet cookie = Cookie.get(this.getSiteId(), 'LIVECHAT_HASH');\n\t\t\tif (typeof cookie === 'string' && cookie.match(/^[a-f0-9]{32}$/))\n\t\t\t{\n\t\t\t\tuserHash = cookie;\n\t\t\t}\n\t\t}\n\n\t\treturn userHash;\n\t}\n\n\tgetUserId()\n\t{\n\t\treturn this.controller.getStore().state.widget.user.id;\n\t}\n\n\tgetUserData()\n\t{\n\t\tif (!this.controller.getStore())\n\t\t{\n\t\t\tconsole.error('LiveChatWidget.getUserData: method can be called after fired event - onBitrixLiveChat');\n\t\t\treturn false;\n\t\t}\n\n\t\treturn this.controller.getStore().state.widget.user;\n\t}\n\n\tgetUserRegisterFields()\n\t{\n\t\treturn {\n\t\t\t'name': this.userRegisterData.name || '',\n\t\t\t'last_name': this.userRegisterData.lastName || '',\n\t\t\t'avatar': this.userRegisterData.avatar || '',\n\t\t\t'email': this.userRegisterData.email || '',\n\t\t\t'www': this.userRegisterData.www || '',\n\t\t\t'gender': this.userRegisterData.gender || '',\n\t\t\t'position': this.userRegisterData.position || '',\n\t\t\t'user_hash': this.userRegisterData.hash || this.getUserHashCookie() || '',\n\t\t\t'consent_url': this.controller.getStore().state.widget.common.consentUrl? location.href: '',\n\t\t\t'trace_data': this.getCrmTraceData(),\n\t\t\t'custom_data': this.getCustomData()\n\t\t}\n\t}\n\n\tgetWidgetLocationCode()\n\t{\n\t\treturn LocationStyle[this.controller.getStore().state.widget.common.location];\n\t}\n\n\tsetUserRegisterData(params)\n\t{\n\t\tif (!this.controller.getStore())\n\t\t{\n\t\t\tconsole.error('LiveChatWidget.getUserData: method can be called after fired event - onBitrixLiveChat');\n\t\t\treturn false;\n\t\t}\n\n\t\tconst validUserFields = ['hash', 'name', 'lastName', 'avatar', 'email', 'www', 'gender', 'position'];\n\n\t\tif (!Utils.types.isPlainObject(params))\n\t\t{\n\t\t\tconsole.error(`%cLiveChatWidget.setUserData: params is not a object`, \"color: black;\");\n\t\t\treturn false;\n\t\t}\n\n\t\tfor (let field in this.userRegisterData)\n\t\t{\n\t\t\tif (!this.userRegisterData.hasOwnProperty(field))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (!params[field])\n\t\t\t{\n\t\t\t\tdelete this.userRegisterData[field];\n\t\t\t}\n\t\t}\n\n\t\tfor (let field in params)\n\t\t{\n\t\t\tif (!params.hasOwnProperty(field))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (validUserFields.indexOf(field) === -1)\n\t\t\t{\n\t\t\t\tconsole.warn(`%cLiveChatWidget.setUserData: user field is not set, because you are trying to set an unknown field (%c${field}%c)`, \"color: black;\", \"font-weight: bold; color: red\", \"color: black\");\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tthis.userRegisterData[field] = params[field];\n\t\t}\n\n\t\tif (\n\t\t\tthis.userRegisterData.hash\n\t\t\t&& this.getUserHash()\n\t\t\t&& this.userRegisterData.hash !== this.getUserHash()\n\t\t)\n\t\t{\n\t\t\tthis.setNewAuthToken(this.userRegisterData.hash);\n\t\t}\n\t}\n\n\tsetNewAuthToken(authToken = '')\n\t{\n\t\tthis.controller.getStoreBuilder().clearModelState();\n\t\tCookie.set(null, 'LIVECHAT_HASH', '', {expires: 365*86400, path: '/'});\n\n\t\tthis.controller.restClient.setAuthId(RestAuth.guest, authToken);\n\t}\n\n\tsetCustomData(params)\n\t{\n\t\tif (!this.controller.getStore())\n\t\t{\n\t\t\tconsole.error('LiveChatWidget.getUserData: method can be called after fired event - onBitrixLiveChat');\n\t\t\treturn false;\n\t\t}\n\n\n\t\tlet result = [];\n\t\tif (params instanceof Array)\n\t\t{\n\t\t\tparams.forEach(element =>\n\t\t\t{\n\t\t\t\tif (element && typeof element === 'object')\n\t\t\t\t{\n\t\t\t\t\tresult.push(element);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (result.length <= 0)\n\t\t\t{\n\t\t\t\tconsole.error('LiveChatWidget.setCustomData: params is empty');\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (!params)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tresult = [{'MESSAGE': params}]\n\t\t}\n\n\t\tthis.customData = this.customData.concat(result);\n\n\t\treturn true;\n\t}\n\n\tsetError(code = '', description = '')\n\t{\n\t\tconsole.error(`LiveChatWidget.error: ${code} (${description})`);\n\n\t\tlet localizeDescription = '';\n\t\tif (code === 'LIVECHAT_AUTH_FAILED')\n\t\t{\n\t\t\tlocalizeDescription = this.getLocalize('BX_LIVECHAT_AUTH_FAILED').replace('#LINK_START#', '<a href=\"javascript:void();\" onclick=\"location.reload()\">').replace('#LINK_END#', '</a>');\n\t\t\tthis.setNewAuthToken();\n\t\t}\n\t\telse if (code === 'LIVECHAT_AUTH_PORTAL_USER')\n\t\t{\n\t\t\tlocalizeDescription = this.getLocalize('BX_LIVECHAT_PORTAL_USER_NEW').replace('#LINK_START#', '<a href=\"'+this.host+'\">').replace('#LINK_END#', '</a>')\n\t\t}\n\t\telse if (code.endsWith('LOCALIZED'))\n\t\t{\n\t\t\tlocalizeDescription = description;\n\t\t}\n\n\t\tthis.controller.getStore().commit('application/set', {error: {\n\t\t\tactive: true,\n\t\t\tcode,\n\t\t\tdescription: localizeDescription\n\t\t}});\n\t}\n\n\tclearError()\n\t{\n\t\tthis.controller.getStore().commit('application/set', {error: {\n\t\t\tactive: false,\n\t\t\tcode: '',\n\t\t\tdescription: ''}\n\t\t});\n\t}\n\n\t/**\n\t *\n\t * @param params {Object}\n\t * @returns {Function|Boolean} - Unsubscribe callback function or False\n\t */\n\tsubscribe(params)\n\t{\n\t\tif (!Utils.types.isPlainObject(params))\n\t\t{\n\t\t\tconsole.error(`%cLiveChatWidget.subscribe: params is not a object`, \"color: black;\");\n\t\t\treturn false;\n\t\t}\n\n\t\tif (!SubscriptionTypeCheck.includes(params.type))\n\t\t{\n\t\t\tconsole.error(`%cLiveChatWidget.subscribe: subscription type is not correct (%c${params.type}%c)`, \"color: black;\", \"font-weight: bold; color: red\", \"color: black\");\n\t\t\treturn false;\n\t\t}\n\n\t\tif (typeof params.callback !== 'function')\n\t\t{\n\t\t\tconsole.error(`%cLiveChatWidget.subscribe: callback is not a function (%c${typeof params.callback}%c)`, \"color: black;\", \"font-weight: bold; color: red\", \"color: black\");\n\t\t\treturn false;\n\t\t}\n\n\t\tif (typeof (this.subscribers[params.type]) === 'undefined')\n\t\t{\n\t\t\tthis.subscribers[params.type] = [];\n\t\t}\n\n\t\tthis.subscribers[params.type].push(params.callback);\n\n\t\treturn function () {\n\t\t\tthis.subscribers[params.type] = this.subscribers[params.type].filter(function(element) {\n\t\t\t\treturn element !== params.callback;\n\t\t\t});\n\t\t}.bind(this);\n\t}\n\n\t/**\n\t *\n\t * @param params {Object}\n\t * @returns {boolean}\n\t */\n\tsendEvent(params)\n\t{\n\t\tparams = params || {};\n\n\t\tif (!params.type)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tif (typeof params.data !== 'object' || !params.data)\n\t\t{\n\t\t\tparams.data = {};\n\t\t}\n\n\t\tif (this.subscribers[params.type] instanceof Array && this.subscribers[params.type].length > 0)\n\t\t{\n\t\t\tthis.subscribers[params.type].forEach(callback => callback(params.data));\n\t\t}\n\n\t\tif (this.subscribers[SubscriptionType.every] instanceof Array && this.subscribers[SubscriptionType.every].length > 0)\n\t\t{\n\t\t\tthis.subscribers[SubscriptionType.every].forEach(callback => callback({type: params.type, data: params.data}));\n\t\t}\n\n\t\treturn true;\n\t}\n\n\taddLocalize(phrases)\n\t{\n\t\tif (typeof phrases !== \"object\" || !phrases)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tfor (let name in phrases)\n\t\t{\n\t\t\tif (phrases.hasOwnProperty(name))\n\t\t\t{\n\t\t\t\tthis.localize[name] = phrases[name];\n\t\t\t}\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tgetLocalize(name)\n\t{\n\t\tlet phrase = '';\n\t\tif (typeof name === 'undefined')\n\t\t{\n\t\t\treturn this.localize;\n\t\t}\n\t\telse if (typeof this.localize[name.toString()] === 'undefined')\n\t\t{\n\t\t\tconsole.warn(`LiveChatWidget.getLocalize: message with code '${name.toString()}' is undefined.`)\n\t\t}\n\t\telse\n\t\t{\n\t\t\tphrase = this.localize[name];\n\t\t}\n\n\t\treturn phrase;\n\t}\n\n/* endregion 05. Widget interaction and utils */\n}","/**\n * Bitrix OpenLines widget\n * Widget public interface\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {Widget} from \"./widget\"\nimport {SubscriptionType} from \"./const\";\n\nexport class WidgetPublicManager\n{\n\tconstructor(config)\n\t{\n\t\tthis.developerInfo = 'Do not use private methods.';\n\t\tthis.__privateMethods__ = new Widget(config);\n\t\tthis.__createLegacyMethods();\n\t}\n\n\topen(params)\n\t{\n\t\treturn this.__privateMethods__.open(params);\n\t}\n\n\tclose()\n\t{\n\t\treturn this.__privateMethods__.close();\n\t}\n\n\tshowNotification(params)\n\t{\n\t\treturn this.__privateMethods__.showNotification(params);\n\t}\n\n\tgetUserData()\n\t{\n\t\treturn this.__privateMethods__.getUserData();\n\t}\n\n\tsetUserRegisterData(params)\n\t{\n\t\treturn this.__privateMethods__.setUserRegisterData(params);\n\t}\n\n\tsetCustomData(params)\n\t{\n\t\treturn this.__privateMethods__.setCustomData(params);\n\t}\n\n\tmutateTemplateComponent(id, params)\n\t{\n\t\treturn this.__privateMethods__.mutateTemplateComponent(id, params);\n\t}\n\n\taddLocalize(phrases)\n\t{\n\t\treturn this.__privateMethods__.addLocalize(phrases);\n\t}\n\n\t/**\n\t *\n\t * @param params {Object}\n\t * @returns {Function|Boolean} - Unsubscribe callback function or False\n\t */\n\tsubscribe(params)\n\t{\n\t\treturn this.__privateMethods__.subscribe(params);\n\t}\n\n\tstart()\n\t{\n\t\treturn this.__privateMethods__.start();\n\t}\n\n\t__createLegacyMethods()\n\t{\n\t\tif (typeof window.BX.LiveChat === 'undefined')\n\t\t{\n\t\t\tlet sourceHref = document.createElement('a');\n\t\t\tsourceHref.href = this.__privateMethods__.host;\n\n\t\t\tlet sourceDomain = sourceHref.protocol+'//'+sourceHref.hostname+(sourceHref.port && sourceHref.port != '80' && sourceHref.port != '443'? \":\"+sourceHref.port: \"\");\n\n\t\t\twindow.BX.LiveChat = {\n\t\t\t\topenLiveChat: () => {\n\t\t\t\t\tthis.open({openFromButton: true});\n\t\t\t\t},\n\t\t\t\tcloseLiveChat: () => {\n\t\t\t\t\tthis.close();\n\t\t\t\t},\n\t\t\t\taddEventListener: (el, eventName, handler) =>\n\t\t\t\t{\n\t\t\t\t\tif (eventName === 'message')\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.subscribe({\n\t\t\t\t\t\t\ttype: SubscriptionType.userMessage,\n\t\t\t\t\t\t\tcallback: function (event)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\thandler({origin: sourceDomain, data: JSON.stringify({action: 'sendMessage'}), event});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tconsole.warn('Method BX.LiveChat.addEventListener is not supported, user new format for subscribe.')\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tsetCookie: () => {},\n\t\t\t\tgetCookie: () => {},\n\t\t\t\tsourceDomain\n\t\t\t};\n\t\t}\n\n\t\tif (typeof window.BxLiveChatInit === 'function')\n\t\t{\n\t\t\tlet config = window.BxLiveChatInit();\n\n\t\t\tif (config.user)\n\t\t\t{\n\t\t\t\tthis.__privateMethods__.setUserRegisterData(config.user);\n\t\t\t}\n\t\t\tif (config.firstMessage)\n\t\t\t{\n\t\t\t\tthis.__privateMethods__.setCustomData(config.firstMessage)\n\t\t\t}\n\t\t}\n\n\t\tif (window.BxLiveChatLoader instanceof Array)\n\t\t{\n\t\t\twindow.BxLiveChatLoader.forEach(callback => callback());\n\t\t}\n\n\t\treturn true;\n\t}\n}","/**\n * Bitrix OpenLines widget\n * LiveChat base component (Vue component)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {Vue} from \"ui.vue\";\nimport {Vuex} from \"ui.vue.vuex\";\nimport {Utils} from \"im.lib.utils\";\nimport {Logger} from \"im.lib.logger\";\nimport {FormType, VoteType, LocationStyle, LocationType, LanguageType} from \"../const\";\nimport {DeviceType, DeviceOrientation, EventType} from \"im.const\";\nimport {md5} from \"main.md5\";\n\n/**\n * @notice Do not mutate or clone this component! It is under development.\n */\n\nVue.component('bx-livechat',\n{\n\tdata()\n\t{\n\t\treturn {\n\t\t\tviewPortMetaSiteNode: null,\n\t\t\tviewPortMetaWidgetNode: null,\n\t\t\tstoredMessage: '',\n\t\t\tstoredFile: null,\n\t\t\twidgetMinimumHeight: 435,\n\t\t\twidgetMinimumWidth: 340,\n\t\t\twidgetBaseHeight: 557,\n\t\t\twidgetBaseWidth: 435,\n\t\t\twidgetMargin: 50,\n\t\t\twidgetAvailableHeight: 0,\n\t\t\twidgetAvailableWidth: 0,\n\t\t\twidgetCurrentHeight: 0,\n\t\t\twidgetCurrentWidth: 0,\n\t\t\twidgetDrag: false,\n\t\t\ttextareaFocused: false,\n\t\t\ttextareaDrag: false,\n\t\t\ttextareaHeight: 100,\n\t\t\ttextareaMinimumHeight: 100,\n\t\t\ttextareaMaximumHeight: Utils.device.isMobile()? 200: 300,\n\t\t}\n\t},\n\tcreated()\n\t{\n\t\tthis.onCreated();\n\n\t\tdocument.addEventListener('keydown', this.onWindowKeyDown);\n\t\tif(!Utils.device.isMobile() && !this.widget.common.pageMode)\n\t\t{\n\t\t\twindow.addEventListener('resize', this.getAvailableSpaceFunc = Utils.throttle(this.getAvailableSpace, 50));\n\t\t}\n\t\tthis.$root.$on('requestShowForm', this.onRequestShowForm);\n\t},\n\tbeforeDestroy()\n\t{\n\t\tdocument.removeEventListener('keydown', this.onWindowKeyDown);\n\t\tif(!Utils.device.isMobile() && !this.widget.common.pageMode)\n\t\t{\n\t\t\twindow.removeEventListener('resize', this.getAvailableSpaceFunc);\n\t\t}\n\t\tthis.$root.$off('requestShowForm', this.onRequestShowForm);\n\n\t\tthis.onTextareaDragEventRemove();\n\t},\n\tcomputed:\n\t{\n\t\tFormType: () => FormType,\n\t\tVoteType: () => VoteType,\n\t\tDeviceType: () => DeviceType,\n\t\tEventType: () => EventType,\n\n\t\ttextareaHeightStyle(state)\n\t\t{\n\t\t\treturn {flex: '0 0 '+this.textareaHeight+'px'};\n\t\t},\n\t\ttextAreaBottomMargin()\n\t\t{\n\t\t\tif (!this.widget.common.copyright && !this.isBottomLocation)\n\t\t\t{\n\t\t\t\treturn {marginBottom: '5px'};\n\t\t\t}\n\t\t\treturn '';\n\t\t},\n\t\twidgetBaseSizes()\n\t\t{\n\t\t\treturn {\n\t\t\t\twidth: this.widgetBaseWidth,\n\t\t\t\theight: this.widgetBaseHeight,\n\t\t\t}\n\t\t},\n\t\twidgetHeightStyle()\n\t\t{\n\t\t\tif(Utils.device.isMobile() || this.widget.common.pageMode)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.widgetAvailableHeight < this.widgetBaseSizes.height || this.widgetAvailableHeight < this.widgetCurrentHeight)\n\t\t\t{\n\t\t\t\tthis.widgetCurrentHeight = Math.max(this.widgetAvailableHeight, this.widgetMinimumHeight);\n\t\t\t}\n\n\t\t\treturn this.widgetCurrentHeight+'px';\n\t\t},\n\t\twidgetWidthStyle()\n\t\t{\n\t\t\tif(Utils.device.isMobile() || this.widget.common.pageMode)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.widgetAvailableWidth < this.widgetBaseSizes.width || this.widgetAvailableWidth < this.widgetCurrentWidth)\n\t\t\t{\n\t\t\t\tthis.widgetCurrentWidth = Math.max(this.widgetAvailableWidth, this.widgetMinimumWidth);\n\t\t\t}\n\n\t\t\treturn this.widgetCurrentWidth+'px';\n\t\t},\n\t\tuserSelectStyle()\n\t\t{\n\t\t\treturn this.widgetDrag ? 'none' : 'auto';\n\t\t},\n\t\tisBottomLocation()\n\t\t{\n\t\t\treturn [LocationType.bottomLeft, LocationType.bottomMiddle, LocationType.bottomRight].includes(this.widget.common.location);\n\t\t},\n\t\tisLeftLocation()\n\t\t{\n\t\t\treturn [LocationType.bottomLeft, LocationType.topLeft, LocationType.topMiddle].includes(this.widget.common.location);\n\t\t},\n\t\tlocalize()\n\t\t{\n\t\t\treturn Vue.getFilteredPhrases('BX_LIVECHAT_', this.$root.$bitrixMessages);\n\t\t},\n\t\twidgetMobileDisabled(state)\n\t\t{\n\t\t\tif (state.application.device.type === DeviceType.mobile)\n\t\t\t{\n\t\t\t\tif (navigator.userAgent.toString().includes('iPad'))\n\t\t\t\t{\n\t\t\t\t}\n\t\t\t\telse if (state.application.device.orientation === DeviceOrientation.horizontal)\n\t\t\t\t{\n\t\t\t\t\tif (navigator.userAgent.toString().includes('iPhone'))\n\t\t\t\t\t{\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\treturn !(typeof window.screen === 'object' && window.screen.availHeight >= 800);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn false;\n\t\t},\n\t\twidgetClassName(state)\n\t\t{\n\t\t\tlet className = ['bx-livechat-wrapper'];\n\n\t\t\tclassName.push('bx-livechat-show');\n\n\t\t\tif (state.widget.common.pageMode)\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-page-mode');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-position-'+LocationStyle[state.widget.common.location]);\n\t\t\t}\n\n\t\t\tif (state.application.common.languageId === LanguageType.russian)\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-logo-ru');\n\t\t\t}\n\t\t\telse if (state.application.common.languageId === LanguageType.ukraine)\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-logo-ua');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-logo-en');\n\t\t\t}\n\n\t\t\tif (!state.widget.common.online)\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-offline-state');\n\t\t\t}\n\n\t\t\tif (state.widget.common.dragged)\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-drag-n-drop');\n\t\t\t}\n\n\t\t\tif (state.widget.common.dialogStart)\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-chat-start');\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\tstate.widget.dialog.operator.name\n\t\t\t\t&& !(state.application.device.type === DeviceType.mobile && state.application.device.orientation === DeviceOrientation.horizontal)\n\t\t\t)\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-has-operator');\n\t\t\t}\n\n\t\t\tif (Utils.device.isMobile())\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-mobile');\n\t\t\t}\n\t\t\telse if (Utils.browser.isSafari())\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-browser-safari');\n\t\t\t}\n\t\t\telse if (Utils.browser.isIe())\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-browser-ie');\n\t\t\t}\n\n\t\t\tif (Utils.platform.isMac())\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-mac');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-custom-scroll');\n\t\t\t}\n\n\t\t\tif (state.widget.common.styles.backgroundColor && Utils.isDarkColor(state.widget.common.styles.iconColor))\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-bright-header');\n\t\t\t}\n\n\t\t\treturn className.join(' ');\n\t\t},\n\t\tshowMessageDialog()\n\t\t{\n\t\t\treturn this.messageCollection.length > 0;\n\t\t},\n\t\tquotePanelData()\n\t\t{\n\t\t\tlet result = {\n\t\t\t\tid: 0,\n\t\t\t\ttitle: '',\n\t\t\t\tdescription: '',\n\t\t\t\tcolor: ''\n\t\t\t};\n\t\t\tif (!this.dialog.quoteId)\n\t\t\t{\n\t\t\t\treturn result;\n\t\t\t}\n\n\t\t\tlet message = this.$store.getters['messages/getMessage'](this.dialog.chatId, this.dialog.quoteId);\n\t\t\tif (!message)\n\t\t\t{\n\t\t\t\treturn result;\n\t\t\t}\n\n\t\t\tlet user = this.$store.getters['users/get'](message.authorId);\n\n\t\t\tresult = {\n\t\t\t\tid: this.dialog.quoteId,\n\t\t\t\ttitle: user? user.name: '',\n\t\t\t\tcolor: user? user.color: '',\n\t\t\t\tdescription: message.textConverted? message.textConverted: this.localize.BX_LIVECHAT_FILE_MESSAGE\n\t\t\t};\n\n\t\t\treturn result;\n\t\t},\n\t\t...Vuex.mapState({\n\t\t\twidget: state => state.widget,\n\t\t\tapplication: state => state.application,\n\t\t\tdialog: state => state.dialogues.collection[state.application.dialog.dialogId],\n\t\t\tmessageCollection: state => state.messages.collection[state.application.dialog.chatId]\n\t\t})\n\t},\n\twatch:\n\t{\n\t\tsessionClose(value)\n\t\t{\n\t\t\tLogger.log('sessionClose change', value);\n\t\t}\n\t},\n\tmethods:\n\t{\n\t\tclose(event)\n\t\t{\n\t\t\tif (this.widget.common.pageMode)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tthis.onBeforeClose();\n\t\t\tthis.$store.commit('widget/common', {showed: false});\n\t\t},\n\t\tgetAvailableSpace()\n\t\t{\n\t\t\tif (this.isBottomLocation)\n\t\t\t{\n\t\t\t\tlet bottomPosition = this.$refs.widgetWrapper.getBoundingClientRect().bottom;\n\t\t\t\tlet widgetBottomMargin = window.innerHeight - bottomPosition;\n\t\t\t\tthis.widgetAvailableHeight = window.innerHeight - this.widgetMargin - widgetBottomMargin;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tlet topPosition = this.$refs.widgetWrapper.getBoundingClientRect().top;\n\t\t\t\tthis.widgetAvailableHeight = window.innerHeight - this.widgetMargin - topPosition;\n\t\t\t}\n\n\t\t\tthis.widgetAvailableWidth = window.innerWidth - this.widgetMargin * 2;\n\t\t},\n\t\tshowLikeForm()\n\t\t{\n\t\t\tif (this.offline)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tclearTimeout(this.showFormTimeout);\n\t\t\tif (!this.widget.common.vote.enable)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tif (\n\t\t\t\tthis.widget.dialog.sessionClose\n\t\t\t\t&& this.widget.dialog.userVote !== VoteType.none\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tthis.$store.commit('widget/common', {showForm: FormType.like});\n\t\t},\n\t\tshowWelcomeForm()\n\t\t{\n\t\t\tclearTimeout(this.showFormTimeout);\n\t\t\tthis.$store.commit('widget/common', {showForm: FormType.welcome});\n\t\t},\n\t\tshowOfflineForm()\n\t\t{\n\t\t\tclearTimeout(this.showFormTimeout);\n\n\t\t\tif (this.widget.dialog.showForm !== FormType.welcome)\n\t\t\t{\n\t\t\t\tthis.$store.commit('widget/common', {showForm: FormType.offline});\n\t\t\t}\n\t\t},\n\t\tshowHistoryForm()\n\t\t{\n\t\t\tclearTimeout(this.showFormTimeout);\n\t\t\tthis.$store.commit('widget/common', {showForm: FormType.history});\n\t\t},\n\t\thideForm()\n\t\t{\n\t\t\tclearTimeout(this.showFormTimeout);\n\n\t\t\tif (this.widget.common.showForm !== FormType.none)\n\t\t\t{\n\t\t\t\tthis.$store.commit('widget/common', {showForm: FormType.none});\n\t\t\t}\n\t\t},\n\t\tshowConsentWidow()\n\t\t{\n\t\t\tthis.$store.commit('widget/common', {showConsent: true});\n\t\t},\n\t\tagreeConsentWidow()\n\t\t{\n\t\t\tthis.$store.commit('widget/common', {showConsent: false});\n\n\t\t\tthis.$root.$bitrixApplication.sendConsentDecision(true);\n\n\t\t\tif (this.storedMessage || this.storedFile)\n\t\t\t{\n\t\t\t\tif (this.storedMessage)\n\t\t\t\t{\n\t\t\t\t\tthis.onTextareaSend({focus: this.application.device.type !== DeviceType.mobile});\n\t\t\t\t\tthis.storedMessage = '';\n\t\t\t\t}\n\t\t\t\tif (this.storedFile)\n\t\t\t\t{\n\t\t\t\t\tthis.onTextareaFileSelected();\n\t\t\t\t\tthis.storedFile = '';\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (this.widget.common.showForm === FormType.none)\n\t\t\t{\n\t\t\t\tthis.$root.$emit(EventType.textarea.focus);\n\t\t\t}\n\t\t},\n\t\tdisagreeConsentWidow()\n\t\t{\n\t\t\tthis.$store.commit('widget/common', {showForm : FormType.none});\n\t\t\tthis.$store.commit('widget/common', {showConsent : false});\n\n\t\t\tthis.$root.$bitrixApplication.sendConsentDecision(false);\n\n\t\t\tif (this.storedMessage)\n\t\t\t{\n\t\t\t\tthis.$root.$emit(EventType.textarea.insertText, {\n\t\t\t\t\ttext: this.storedMessage,\n\t\t\t\t\tfocus: this.application.device.type !== DeviceType.mobile\n\t\t\t\t});\n\t\t\t\tthis.storedMessage = '';\n\t\t\t}\n\t\t\tif (this.storedFile)\n\t\t\t{\n\t\t\t\tthis.storedFile = '';\n\t\t\t}\n\n\t\t\tif (this.application.device.type !== DeviceType.mobile)\n\t\t\t{\n\t\t\t\tthis.$root.$emit(EventType.textarea.focus);\n\t\t\t}\n\t\t},\n\t\tlogEvent(name, ...params)\n\t\t{\n\t\t\tLogger.info(name, ...params);\n\t\t},\n\t\tonCreated()\n\t\t{\n\t\t\tif(Utils.device.isMobile())\n\t\t\t{\n\t\t\t\tlet viewPortMetaSiteNode = Array.from(\n\t\t\t\t\tdocument.head.getElementsByTagName('meta')\n\t\t\t\t).filter(element => element.name === 'viewport')[0];\n\n\t\t\t\tif (viewPortMetaSiteNode)\n\t\t\t\t{\n\t\t\t\t\tthis.viewPortMetaSiteNode = viewPortMetaSiteNode;\n\t\t\t\t\tdocument.head.removeChild(this.viewPortMetaSiteNode);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tlet contentWidth = document.body.offsetWidth;\n\t\t\t\t\tif (contentWidth < window.innerWidth)\n\t\t\t\t\t{\n\t\t\t\t\t\tcontentWidth = window.innerWidth;\n\t\t\t\t\t}\n\t\t\t\t\tif (contentWidth < 1024)\n\t\t\t\t\t{\n\t\t\t\t\t\tcontentWidth = 1024;\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.viewPortMetaSiteNode = document.createElement('meta');\n\t\t\t\t\tthis.viewPortMetaSiteNode.setAttribute('name', 'viewport');\n\t\t\t\t\tthis.viewPortMetaSiteNode.setAttribute('content', `width=${contentWidth}, initial-scale=1.0, user-scalable=1`);\n\t\t\t\t}\n\n\t\t\t\tif (!this.viewPortMetaWidgetNode)\n\t\t\t\t{\n\t\t\t\t\tthis.viewPortMetaWidgetNode = document.createElement('meta');\n\t\t\t\t\tthis.viewPortMetaWidgetNode.setAttribute('name', 'viewport');\n\t\t\t\t\tthis.viewPortMetaWidgetNode.setAttribute('content', 'width=device-width, initial-scale=1.0, user-scalable=0');\n\t\t\t\t\tdocument.head.appendChild(this.viewPortMetaWidgetNode);\n\t\t\t\t}\n\n\t\t\t\tdocument.body.classList.add('bx-livechat-mobile-state');\n\n\t\t\t\tif (Utils.browser.isSafariBased())\n\t\t\t\t{\n\t\t\t\t\tdocument.body.classList.add('bx-livechat-mobile-safari-based');\n\t\t\t\t}\n\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tthis.$store.dispatch('widget/show');\n\t\t\t\t}, 50);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.$store.dispatch('widget/show').then(() => {\n\t\t\t\t\tthis.widgetCurrentHeight = this.widgetBaseSizes.height;\n\t\t\t\t\tthis.widgetCurrentWidth = this.widgetBaseSizes.width;\n\t\t\t\t\tthis.getAvailableSpace();\n\n\t\t\t\t\tthis.widgetCurrentHeight = this.widget.common.widgetHeight || this.widgetCurrentHeight;\n\t\t\t\t\tthis.widgetCurrentWidth = this.widget.common.widgetWidth || this.widgetCurrentWidth;\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis.textareaHeight = this.widget.common.textareaHeight || this.textareaHeight;\n\n\t\t\tthis.$store.commit('files/initCollection', {chatId: this.$root.$bitrixApplication.getChatId()});\n\t\t\tthis.$store.commit('messages/initCollection', {chatId: this.$root.$bitrixApplication.getChatId()});\n\t\t\tthis.$store.commit('dialogues/initCollection', {dialogId: this.$root.$bitrixApplication.getDialogId(), fields: {\n\t\t\t\tentityType: 'LIVECHAT',\n\t\t\t\ttype: 'livechat'\n\t\t\t}});\n\t\t},\n\t\tonBeforeClose()\n\t\t{\n\t\t\tif(Utils.device.isMobile())\n\t\t\t{\n\t\t\t\tdocument.body.classList.remove('bx-livechat-mobile-state');\n\n\t\t\t\tif (Utils.browser.isSafariBased())\n\t\t\t\t{\n\t\t\t\t\tdocument.body.classList.remove('bx-livechat-mobile-safari-based');\n\t\t\t\t}\n\n\t\t\t\tif (this.viewPortMetaWidgetNode)\n\t\t\t\t{\n\t\t\t\t\tdocument.head.removeChild(this.viewPortMetaWidgetNode);\n\t\t\t\t\tthis.viewPortMetaWidgetNode = null;\n\t\t\t\t}\n\n\t\t\t\tif (this.viewPortMetaSiteNode)\n\t\t\t\t{\n\t\t\t\t\tdocument.head.appendChild(this.viewPortMetaSiteNode);\n\t\t\t\t\tthis.viewPortMetaSiteNode = null;\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tonAfterClose()\n\t\t{\n\t\t\tthis.$root.$bitrixApplication.close();\n\t\t},\n\t\tonRequestShowForm(event)\n\t\t{\n\t\t\tclearTimeout(this.showFormTimeout);\n\t\t\tif (event.type === FormType.welcome)\n\t\t\t{\n\t\t\t\tif (event.delayed)\n\t\t\t\t{\n\t\t\t\t\tthis.showFormTimeout = setTimeout(() => {\n\t\t\t\t\t\tthis.showWelcomeForm();\n\t\t\t\t\t}, 5000);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.showWelcomeForm();\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (event.type === FormType.offline)\n\t\t\t{\n\t\t\t\tif (event.delayed)\n\t\t\t\t{\n\t\t\t\t\tthis.showFormTimeout = setTimeout(() => {\n\t\t\t\t\t\tthis.showOfflineForm();\n\t\t\t\t\t}, 3000);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.showOfflineForm();\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (event.type === FormType.like)\n\t\t\t{\n\t\t\t\tif (event.delayed)\n\t\t\t\t{\n\t\t\t\t\tthis.showFormTimeout = setTimeout(() => {\n\t\t\t\t\t\tthis.showLikeForm();\n\t\t\t\t\t}, 5000);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.showLikeForm();\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tonDialogRequestHistory(event)\n\t\t{\n\t\t\tthis.$root.$bitrixApplication.getDialogHistory(event.lastId);\n\t\t},\n\t\tonDialogRequestUnread(event)\n\t\t{\n\t\t\tthis.$root.$bitrixApplication.getDialogUnread(event.lastId);\n\t\t},\n\t\tonDialogMessageClickByUserName(event)\n\t\t{\n\t\t\t// TODO name push to auto-replace mention holder - User Name -> [USER=274]User Name[/USER]\n\t\t\tthis.$root.$emit(EventType.textarea.insertText, {text: event.user.name+' '});\n\t\t},\n\t\tonDialogMessageClickByUploadCancel(event)\n\t\t{\n\t\t\tthis.$root.$bitrixApplication.cancelUploadFile(event.file.id);\n\t\t},\n\t\tonDialogMessageClickByKeyboardButton(event)\n\t\t{\n\t\t\tthis.$root.$bitrixApplication.execMessageKeyboardCommand(event);\n\t\t},\n\t\tonDialogMessageClickByCommand(event)\n\t\t{\n\t\t\tif (event.type === 'put')\n\t\t\t{\n\t\t\t\tthis.$root.$emit(EventType.textarea.insertText, {text: event.value+' '});\n\t\t\t}\n\t\t\telse if (event.type === 'send')\n\t\t\t{\n\t\t\t\tthis.$root.$bitrixApplication.addMessage(event.value);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tLogger.warn('Unprocessed command', event);\n\t\t\t}\n\t\t},\n\t\tonDialogMessageMenuClick(event)\n\t\t{\n\t\t\tLogger.warn('Message menu:', event);\n\t\t},\n\t\tonDialogMessageRetryClick(event)\n\t\t{\n\t\t\tLogger.warn('Message retry:', event);\n\t\t\tthis.$root.$bitrixApplication.retrySendMessage(event.message);\n\t\t},\n\t\tonDialogReadMessage(event)\n\t\t{\n\t\t\tthis.$root.$bitrixApplication.readMessage(event.id);\n\t\t},\n\t\tonDialogQuoteMessage(event)\n\t\t{\n\t\t\tthis.$root.$bitrixApplication.quoteMessage(event.message.id);\n\t\t},\n\t\tonDialogMessageReactionSet(event)\n\t\t{\n\t\t\tthis.$root.$bitrixApplication.reactMessage(event.message.id, event.reaction);\n\t\t},\n\t\tonDialogClick(event)\n\t\t{\n\t\t\tif (this.widget.common.showForm !== FormType.none)\n\t\t\t{\n\t\t\t\tthis.$store.commit('widget/common', {showForm: FormType.none});\n\t\t\t}\n\t\t},\n\t\tonTextareaKeyUp(event)\n\t\t{\n\t\t\tif (\n\t\t\t\tthis.widget.common.watchTyping\n\t\t\t\t&& this.widget.dialog.sessionId\n\t\t\t\t&& !this.widget.dialog.sessionClose\n\t\t\t\t&& this.widget.dialog.operator.id\n\t\t\t\t&& this.widget.dialog.operatorChatId\n\t\t\t\t&& this.$root.$bitrixPullClient.isPublishingEnabled()\n\t\t\t)\n\t\t\t{\n\t\t\t\tlet infoString = md5(\n\t\t\t\t\tthis.widget.dialog.sessionId\n\t\t\t\t\t+ '/' + this.application.dialog.chatId\n\t\t\t\t\t+ '/' + this.widget.user.id\n\t\t\t\t);\n\t\t\t\tthis.$root.$bitrixPullClient.sendMessage(\n\t\t\t\t\t[this.widget.dialog.operator.id],\n\t\t\t\t\t'imopenlines',\n\t\t\t\t\t'linesMessageWrite',\n\t\t\t\t\t{\n\t\t\t\t\t\ttext: event.text,\n\t\t\t\t\t\tinfoString,\n\t\t\t\t\t\toperatorChatId: this.widget.dialog.operatorChatId\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t},\n\t\tonTextareaSend(event)\n\t\t{\n\t\t\tevent.focus = event.focus !== false;\n\n\t\t\tif (this.widget.common.showForm === FormType.smile)\n\t\t\t{\n\t\t\t\tthis.$store.commit('widget/common', {showForm: FormType.none});\n\t\t\t}\n\n\t\t\tif (!this.widget.dialog.userConsent && this.widget.common.consentUrl)\n\t\t\t{\n\t\t\t\tif (event.text)\n\t\t\t\t{\n\t\t\t\t\tthis.storedMessage = event.text;\n\t\t\t\t}\n\t\t\t\tthis.showConsentWidow();\n\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tevent.text = event.text? event.text: this.storedMessage;\n\t\t\tif (!event.text)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tthis.hideForm();\n\t\t\tthis.$root.$bitrixApplication.addMessage(event.text);\n\n\t\t\tif (event.focus)\n\t\t\t{\n\t\t\t\tthis.$root.$emit(EventType.textarea.focus);\n\t\t\t}\n\n\t\t\treturn true;\n\t\t},\n\t\tonTextareaWrites(event)\n\t\t{\n\t\t\tthis.$root.$bitrixController.application.startWriting();\n\t\t},\n\t\tonTextareaFocus(event)\n\t\t{\n\t\t\tif (\n\t\t\t\tthis.widget.common.copyright &&\n\t\t\t\tthis.application.device.type === DeviceType.mobile\n\t\t\t)\n\t\t\t{\n\t\t\t\tthis.widget.common.copyright = false;\n\t\t\t}\n\t\t\tif (Utils.device.isMobile())\n\t\t\t{\n\t\t\t\tclearTimeout(this.onTextareaFocusScrollTimeout);\n\t\t\t\tthis.onTextareaFocusScrollTimeout = setTimeout(() => {\n\t\t\t\t\tdocument.addEventListener('scroll', this.onWindowScroll);\n\t\t\t\t}, 1000);\n\t\t\t}\n\t\t\tthis.textareaFocused = true;\n\t\t},\n\t\tonTextareaBlur(event)\n\t\t{\n\t\t\tif (!this.widget.common.copyright && this.widget.common.copyright !== this.$root.$bitrixApplication.copyright)\n\t\t\t{\n\t\t\t\tthis.widget.common.copyright = this.$root.$bitrixApplication.copyright;\n\t\t\t\tthis.$nextTick(() => {\n\t\t\t\t\tthis.$root.$emit(EventType.dialog.scrollToBottom, {force: true});\n\t\t\t\t});\n\t\t\t}\n\t\t\tif (Utils.device.isMobile())\n\t\t\t{\n\t\t\t\tclearTimeout(this.onTextareaFocusScrollTimeout);\n\t\t\t\tdocument.removeEventListener('scroll', this.onWindowScroll);\n\t\t\t}\n\n\t\t\tthis.textareaFocused = false;\n\t\t},\n\t\tonTextareaStartDrag(event)\n\t\t{\n\t\t\tif (this.textareaDrag)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tLogger.log('Livechat: textarea drag started');\n\n\t\t\tthis.textareaDrag = true;\n\n\t\t\tevent = event.changedTouches ? event.changedTouches[0] : event;\n\n\t\t\tthis.textareaDragCursorStartPoint = event.clientY;\n\t\t\tthis.textareaDragHeightStartPoint = this.textareaHeight;\n\n\t\t\tthis.onTextareaDragEventAdd();\n\n\t\t\tthis.$root.$emit(EventType.textarea.blur, true);\n\t\t},\n\t\tonTextareaContinueDrag(event)\n\t\t{\n\t\t\tif (!this.textareaDrag)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tevent = event.changedTouches ? event.changedTouches[0] : event;\n\n\t\t\tthis.textareaDragCursorControlPoint = event.clientY;\n\n\t\t\tlet textareaHeight = Math.max(\n\t\t\t\tMath.min(this.textareaDragHeightStartPoint + this.textareaDragCursorStartPoint - this.textareaDragCursorControlPoint, this.textareaMaximumHeight)\n\t\t\t, this.textareaMinimumHeight);\n\n\t\t\tLogger.log('Livechat: textarea drag', 'new: '+textareaHeight, 'curr: '+this.textareaHeight);\n\n\t\t\tif (this.textareaHeight !== textareaHeight)\n\t\t\t{\n\t\t\t\tthis.textareaHeight = textareaHeight;\n\t\t\t}\n\t\t},\n\t\tonTextareaStopDrag()\n\t\t{\n\t\t\tif (!this.textareaDrag)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tLogger.log('Livechat: textarea drag ended');\n\n\t\t\tthis.textareaDrag = false;\n\n\t\t\tthis.onTextareaDragEventRemove();\n\n\t\t\tthis.$store.commit('widget/common', {textareaHeight: this.textareaHeight});\n\t\t\tthis.$root.$emit(EventType.dialog.scrollToBottom, {force: true});\n\t\t},\n\t\tonTextareaDragEventAdd()\n\t\t{\n\t\t\tdocument.addEventListener('mousemove', this.onTextareaContinueDrag);\n\t\t\tdocument.addEventListener('touchmove', this.onTextareaContinueDrag);\n\t\t\tdocument.addEventListener('touchend', this.onTextareaStopDrag);\n\t\t\tdocument.addEventListener('mouseup', this.onTextareaStopDrag);\n\t\t\tdocument.addEventListener('mouseleave', this.onTextareaStopDrag);\n\t\t},\n\t\tonTextareaDragEventRemove()\n\t\t{\n\t\t\tdocument.removeEventListener('mousemove', this.onTextareaContinueDrag);\n\t\t\tdocument.removeEventListener('touchmove', this.onTextareaContinueDrag);\n\t\t\tdocument.removeEventListener('touchend', this.onTextareaStopDrag);\n\t\t\tdocument.removeEventListener('mouseup', this.onTextareaStopDrag);\n\t\t\tdocument.removeEventListener('mouseleave', this.onTextareaStopDrag);\n\t\t},\n\t\tonTextareaFileSelected(event)\n\t\t{\n\t\t\tlet fileInput = event && event.fileInput? event.fileInput: this.storedFile;\n\t\t\tif (!fileInput)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (fileInput.files[0].size > this.application.disk.maxFileSize)\n\t\t\t{\n\t\t\t\t// TODO change alert to correct overlay window\n\t\t\t\talert(this.localize.BX_LIVECHAT_FILE_SIZE_EXCEEDED.replace('#LIMIT#', Math.round(this.application.disk.maxFileSize/1024/1024)));\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (!this.widget.dialog.userConsent && this.widget.common.consentUrl)\n\t\t\t{\n\t\t\t\tthis.storedFile = event.fileInput;\n\t\t\t\tthis.showConsentWidow();\n\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tthis.$root.$bitrixApplication.uploadFile(fileInput);\n\t\t},\n\t\tonTextareaAppButtonClick(event)\n\t\t{\n\t\t\tif (event.appId === FormType.smile)\n\t\t\t{\n\t\t\t\tif (this.widget.common.showForm === FormType.smile)\n\t\t\t\t{\n\t\t\t\t\tthis.$store.commit('widget/common', {showForm: FormType.none});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.$store.commit('widget/common', {showForm: FormType.smile});\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.$root.$emit(EventType.textarea.focus);\n\t\t\t}\n\t\t},\n\t\tonPullRequestConfig(event)\n\t\t{\n\t\t\tthis.$root.$bitrixApplication.recoverPullConnection();\n\t\t},\n\t\tonSmilesSelectSmile(event)\n\t\t{\n\t\t\tthis.$root.$emit(EventType.textarea.insertText, {text: event.text});\n\t\t},\n\t\tonSmilesSelectSet()\n\t\t{\n\t\t\tthis.$root.$emit(EventType.textarea.focus);\n\t\t},\n\t\tonQuotePanelClose()\n\t\t{\n\t\t\tthis.$root.$bitrixApplication.quoteMessageClear();\n\t\t},\n\t\tonWidgetStartDrag(event)\n\t\t{\n\t\t\tif (this.widgetDrag)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.widgetDrag = true;\n\n\t\t\tevent = event.changedTouches ? event.changedTouches[0] : event;\n\n\t\t\tthis.widgetDragCursorStartPointY = event.clientY;\n\t\t\tthis.widgetDragCursorStartPointX = event.clientX;\n\t\t\tthis.widgetDragHeightStartPoint = this.widgetCurrentHeight;\n\t\t\tthis.widgetDragWidthStartPoint = this.widgetCurrentWidth;\n\n\t\t\tthis.onWidgetDragEventAdd();\n\t\t},\n\t\tonWidgetContinueDrag(event)\n\t\t{\n\t\t\tif (!this.widgetDrag)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tevent = event.changedTouches ? event.changedTouches[0] : event;\n\n\t\t\tthis.widgetDragCursorControlPointY = event.clientY;\n\t\t\tthis.widgetDragCursorControlPointX = event.clientX;\n\n\t\t\tlet widgetHeight = 0;\n\n\t\t\tif (this.isBottomLocation)\n\t\t\t{\n\t\t\t\twidgetHeight = Math.max(\n\t\t\t\t\tMath.min(this.widgetDragHeightStartPoint + this.widgetDragCursorStartPointY - this.widgetDragCursorControlPointY, this.widgetAvailableHeight),\n\t\t\t\t\tthis.widgetMinimumHeight\n\t\t\t\t);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\twidgetHeight = Math.max(\n\t\t\t\t\tMath.min(this.widgetDragHeightStartPoint - this.widgetDragCursorStartPointY + this.widgetDragCursorControlPointY, this.widgetAvailableHeight),\n\t\t\t\t\tthis.widgetMinimumHeight\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tlet widgetWidth = 0;\n\t\t\tif (this.isLeftLocation)\n\t\t\t{\n\t\t\t\twidgetWidth = Math.max(\n\t\t\t\t\tMath.min(this.widgetDragWidthStartPoint - this.widgetDragCursorStartPointX + this.widgetDragCursorControlPointX, this.widgetAvailableWidth),\n\t\t\t\t\tthis.widgetMinimumWidth\n\t\t\t\t);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\twidgetWidth = Math.max(\n\t\t\t\t\tMath.min(this.widgetDragWidthStartPoint + this.widgetDragCursorStartPointX - this.widgetDragCursorControlPointX, this.widgetAvailableWidth),\n\t\t\t\t\tthis.widgetMinimumWidth\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tif (this.widgetCurrentHeight !== widgetHeight)\n\t\t\t{\n\t\t\t\tthis.widgetCurrentHeight = widgetHeight;\n\t\t\t}\n\n\t\t\tif (this.widgetCurrentWidth !== widgetWidth)\n\t\t\t{\n\t\t\t\tthis.widgetCurrentWidth = widgetWidth;\n\t\t\t}\n\t\t},\n\t\tonWidgetStopDrag()\n\t\t{\n\t\t\tif (!this.widgetDrag)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.widgetDrag = false;\n\n\t\t\tthis.onWidgetDragEventRemove();\n\n\t\t\tthis.$store.commit('widget/common', {widgetHeight: this.widgetCurrentHeight, widgetWidth: this.widgetCurrentWidth});\n\t\t},\n\t\tonWidgetDragEventAdd()\n\t\t{\n\t\t\tdocument.addEventListener('mousemove', this.onWidgetContinueDrag);\n\t\t\tdocument.addEventListener('mouseup', this.onWidgetStopDrag);\n\t\t\tdocument.addEventListener('mouseleave', this.onWidgetStopDrag);\n\t\t},\n\t\tonWidgetDragEventRemove()\n\t\t{\n\t\t\tdocument.removeEventListener('mousemove', this.onWidgetContinueDrag);\n\t\t\tdocument.removeEventListener('mouseup', this.onWidgetStopDrag);\n\t\t\tdocument.removeEventListener('mouseleave', this.onWidgetStopDrag);\n\t\t},\n\t\tonWindowKeyDown(event)\n\t\t{\n\t\t\tif (event.keyCode === 27)\n\t\t\t{\n\t\t\t\tif (this.widget.common.showForm !== FormType.none)\n\t\t\t\t{\n\t\t\t\t\tthis.$store.commit('widget/common', {showForm: FormType.none});\n\t\t\t\t}\n\t\t\t\telse if (this.widget.common.showConsent)\n\t\t\t\t{\n\t\t\t\t\tthis.disagreeConsentWidow();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.close();\n\t\t\t\t}\n\n\t\t\t\tevent.preventDefault();\n\t\t\t\tevent.stopPropagation();\n\n\t\t\t\tthis.$root.$emit(EventType.textarea.focus);\n\t\t\t}\n\t\t},\n\t\tonWindowScroll(event)\n\t\t{\n\t\t\tclearTimeout(this.onWindowScrollTimeout);\n\t\t\tthis.onWindowScrollTimeout = setTimeout(() => {\n\t\t\t\tthis.$root.$emit(EventType.textarea.blur, true);\n\t\t\t}, 50);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<transition enter-active-class=\"bx-livechat-show\" leave-active-class=\"bx-livechat-close\" @after-leave=\"onAfterClose\">\n\t\t\t<div :class=\"widgetClassName\" v-if=\"widget.common.showed\" :style=\"{height: widgetHeightStyle, width: widgetWidthStyle, userSelect: userSelectStyle}\" ref=\"widgetWrapper\">\n\t\t\t\t<div class=\"bx-livechat-box\">\n\t\t\t\t\t<div v-if=\"isBottomLocation\" class=\"bx-livechat-widget-resize-handle\" @mousedown=\"onWidgetStartDrag\"></div>\n\t\t\t\t\t<bx-livechat-head :isWidgetDisabled=\"widgetMobileDisabled\" @like=\"showLikeForm\" @history=\"showHistoryForm\" @close=\"close\"/>\n\t\t\t\t\t<template v-if=\"widgetMobileDisabled\">\n\t\t\t\t\t\t<bx-livechat-body-orientation-disabled/>\n\t\t\t\t\t</template>\n\t\t\t\t\t<template v-else-if=\"application.error.active\">\n\t\t\t\t\t\t<bx-livechat-body-error/>\n\t\t\t\t\t</template>\n\t\t\t\t\t<template v-else-if=\"!widget.common.configId\">\n\t\t\t\t\t\t<div class=\"bx-livechat-body\" key=\"loading-body\">\n\t\t\t\t\t\t\t<bx-livechat-body-loading/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</template>\t\t\t\n\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t<template v-if=\"!widget.common.dialogStart\">\n\t\t\t\t\t\t\t<div class=\"bx-livechat-body\" key=\"welcome-body\">\n\t\t\t\t\t\t\t\t<bx-livechat-body-operators/>\n\t\t\t\t\t\t\t\t<keep-alive include=\"bx-livechat-smiles\">\n\t\t\t\t\t\t\t\t\t<template v-if=\"widget.common.showForm == FormType.smile\">\n\t\t\t\t\t\t\t\t\t\t<bx-livechat-smiles @selectSmile=\"onSmilesSelectSmile\" @selectSet=\"onSmilesSelectSet\"/>\t\n\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t</keep-alive>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t\t<template v-else-if=\"widget.common.dialogStart\">\n\t\t\t\t\t\t\t<bx-pull-component-status :canReconnect=\"true\" @reconnect=\"onPullRequestConfig\"/>\n\t\t\t\t\t\t\t<div :class=\"['bx-livechat-body', {'bx-livechat-body-with-message': showMessageDialog}]\" key=\"with-message\">\n\t\t\t\t\t\t\t\t<template v-if=\"showMessageDialog\">\n\t\t\t\t\t\t\t\t\t<div class=\"bx-livechat-dialog\">\n\t\t\t\t\t\t\t\t\t\t<bx-im-view-dialog\n\t\t\t\t\t\t\t\t\t\t\t:userId=\"application.common.userId\" \n\t\t\t\t\t\t\t\t\t\t\t:dialogId=\"application.dialog.dialogId\"\n\t\t\t\t\t\t\t\t\t\t\t:chatId=\"application.dialog.chatId\"\n\t\t\t\t\t\t\t\t\t\t\t:messageLimit=\"application.dialog.messageLimit\"\n\t\t\t\t\t\t\t\t\t\t\t:messageExtraCount=\"application.dialog.messageExtraCount\"\n\t\t\t\t\t\t\t\t\t\t\t:enableReactions=\"true\"\n\t\t\t\t\t\t\t\t\t\t\t:enableDateActions=\"false\"\n\t\t\t\t\t\t\t\t\t\t\t:enableCreateContent=\"false\"\n\t\t\t\t\t\t\t\t\t\t\t:enableGestureQuote=\"true\"\n\t\t\t\t\t\t\t\t\t\t\t:enableGestureMenu=\"true\"\n\t\t\t\t\t\t\t\t\t\t\t:showMessageAvatar=\"false\"\n\t\t\t\t\t\t\t\t\t\t\t:showMessageMenu=\"false\"\n\t\t\t\t\t\t\t\t\t\t\t:listenEventScrollToBottom=\"EventType.dialog.scrollToBottom\"\n\t\t\t\t\t\t\t\t\t\t\t:listenEventRequestHistory=\"EventType.dialog.requestHistoryResult\"\n\t\t\t\t\t\t\t\t\t\t\t:listenEventRequestUnread=\"EventType.dialog.requestUnreadResult\"\n\t\t\t\t\t\t\t\t\t\t\t@readMessage=\"onDialogReadMessage\"\n\t\t\t\t\t\t\t\t\t\t\t@requestHistory=\"onDialogRequestHistory\"\n\t\t\t\t\t\t\t\t\t\t\t@requestUnread=\"onDialogRequestUnread\"\n\t\t\t\t\t\t\t\t\t\t\t@quoteMessage=\"onDialogQuoteMessage\"\n\t\t\t\t\t\t\t\t\t\t\t@clickByCommand=\"onDialogMessageClickByCommand\"\n\t\t\t\t\t\t\t\t\t\t\t@clickByUserName=\"onDialogMessageClickByUserName\"\n\t\t\t\t\t\t\t\t\t\t\t@clickByUploadCancel=\"onDialogMessageClickByUploadCancel\"\n\t\t\t\t\t\t\t\t\t\t\t@clickByKeyboardButton=\"onDialogMessageClickByKeyboardButton\"\n\t\t\t\t\t\t\t\t\t\t\t@clickByMessageMenu=\"onDialogMessageMenuClick\"\n\t\t\t\t\t\t\t\t\t\t\t@clickByMessageRetry=\"onDialogMessageRetryClick\"\n\t\t\t\t\t\t\t\t\t\t\t@setMessageReaction=\"onDialogMessageReactionSet\"\n\t\t\t\t\t\t\t\t\t\t\t@click=\"onDialogClick\"\n\t\t\t\t\t\t\t\t\t\t />\n\t\t\t\t\t\t\t\t\t</div>\t \n\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t\t\t\t<bx-livechat-body-loading/>\n\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t<bx-im-view-quote-panel :id=\"quotePanelData.id\" :title=\"quotePanelData.title\" :description=\"quotePanelData.description\" :color=\"quotePanelData.color\" @close=\"onQuotePanelClose\"/>\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t<keep-alive include=\"bx-livechat-smiles\">\n\t\t\t\t\t\t\t\t\t<template v-if=\"widget.common.showForm == FormType.like && widget.common.vote.enable\">\n\t\t\t\t\t\t\t\t\t\t<bx-livechat-form-vote/>\n\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t\t<template v-else-if=\"widget.common.showForm == FormType.welcome\">\n\t\t\t\t\t\t\t\t\t\t<bx-livechat-form-welcome/>\t\n\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t\t<template v-else-if=\"widget.common.showForm == FormType.offline\">\n\t\t\t\t\t\t\t\t\t\t<bx-livechat-form-offline/>\t\n\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t\t<template v-else-if=\"widget.common.showForm == FormType.history\">\n\t\t\t\t\t\t\t\t\t\t<bx-livechat-form-history/>\t\n\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t\t<template v-else-if=\"widget.common.showForm == FormType.smile\">\n\t\t\t\t\t\t\t\t\t\t<bx-livechat-smiles @selectSmile=\"onSmilesSelectSmile\" @selectSet=\"onSmilesSelectSet\"/>\t\n\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t</keep-alive>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</template>\t\n\t\t\t\t\t\t<div class=\"bx-livechat-textarea\" :style=\"[textareaHeightStyle, textAreaBottomMargin]\" ref=\"textarea\">\n\t\t\t\t\t\t\t<div class=\"bx-livechat-textarea-resize-handle\" @mousedown=\"onTextareaStartDrag\" @touchstart=\"onTextareaStartDrag\"></div>\n\t\t\t\t\t\t\t<bx-im-view-textarea\n\t\t\t\t\t\t\t\t:siteId=\"application.common.siteId\"\n\t\t\t\t\t\t\t\t:userId=\"application.common.userId\"\n\t\t\t\t\t\t\t\t:dialogId=\"application.dialog.dialogId\"\n\t\t\t\t\t\t\t\t:writesEventLetter=\"3\"\n\t\t\t\t\t\t\t\t:enableEdit=\"true\"\n\t\t\t\t\t\t\t\t:enableCommand=\"false\"\n\t\t\t\t\t\t\t\t:enableMention=\"false\"\n\t\t\t\t\t\t\t\t:enableFile=\"application.disk.enabled\"\n\t\t\t\t\t\t\t\t:autoFocus=\"application.device.type !== DeviceType.mobile\"\n\t\t\t\t\t\t\t\t:styles=\"{button: {backgroundColor: widget.common.styles.backgroundColor, iconColor: widget.common.styles.iconColor}}\"\n\t\t\t\t\t\t\t\t:listenEventInsertText=\"EventType.textarea.insertText\"\n\t\t\t\t\t\t\t\t:listenEventFocus=\"EventType.textarea.focus\"\n\t\t\t\t\t\t\t\t:listenEventBlur=\"EventType.textarea.blur\"\n\t\t\t\t\t\t\t\t@writes=\"onTextareaWrites\" \n\t\t\t\t\t\t\t\t@send=\"onTextareaSend\" \n\t\t\t\t\t\t\t\t@focus=\"onTextareaFocus\" \n\t\t\t\t\t\t\t\t@blur=\"onTextareaBlur\"\n\t\t\t\t\t\t\t\t@keyup=\"onTextareaKeyUp\" \n\t\t\t\t\t\t\t\t@edit=\"logEvent('edit message', $event)\"\n\t\t\t\t\t\t\t\t@fileSelected=\"onTextareaFileSelected\"\n\t\t\t\t\t\t\t\t@appButtonClick=\"onTextareaAppButtonClick\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div v-if=\"!widget.common.copyright && !isBottomLocation\" class=\"bx-livechat-nocopyright-resize-wrap\" style=\"position: relative;\">\n\t\t\t\t\t\t\t<div class=\"bx-livechat-widget-resize-handle\" @mousedown=\"onWidgetStartDrag\"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<bx-livechat-form-consent @agree=\"agreeConsentWidow\" @disagree=\"disagreeConsentWidow\"/>\n\t\t\t\t\t\t<template v-if=\"widget.common.copyright\">\n\t\t\t\t\t\t\t<div class=\"bx-livechat-copyright\">\t\n\t\t\t\t\t\t\t\t<template v-if=\"widget.common.copyrightUrl\">\n\t\t\t\t\t\t\t\t\t<a class=\"bx-livechat-copyright-link\" :href=\"widget.common.copyrightUrl\" target=\"_blank\">\n\t\t\t\t\t\t\t\t\t\t<span class=\"bx-livechat-logo-name\">{{localize.BX_LIVECHAT_COPYRIGHT_TEXT}}</span>\n\t\t\t\t\t\t\t\t\t\t<span class=\"bx-livechat-logo-icon\"></span>\n\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t\t\t\t<span class=\"bx-livechat-logo-name\">{{localize.BX_LIVECHAT_COPYRIGHT_TEXT}}</span>\n\t\t\t\t\t\t\t\t\t<span class=\"bx-livechat-logo-icon\"></span>\n\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t<div v-if=\"!isBottomLocation\" class=\"bx-livechat-widget-resize-handle\" @mousedown=\"onWidgetStartDrag\"></div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</template>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</transition>\n\t`\n});","/**\n * Bitrix OpenLines widget\n * Body error component (Vue component)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {Vue} from \"ui.vue\";\nimport {Vuex} from \"ui.vue.vuex\";\n\nVue.component('bx-livechat-body-error',\n{\n\tcomputed:\n\t{\n\t\tlocalize()\n\t\t{\n\t\t\treturn  Object.freeze({\n\t\t\t\tBX_LIVECHAT_ERROR_TITLE: this.$root.$bitrixMessages.BX_LIVECHAT_ERROR_TITLE,\n\t\t\t\tBX_LIVECHAT_ERROR_DESC: this.$root.$bitrixMessages.BX_LIVECHAT_ERROR_DESC\n\t\t\t});\n\t\t},\n\t\t...Vuex.mapState({\n\t\t\tapplication: state => state.application\n\t\t}),\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-livechat-body\" key=\"error-body\">\n\t\t\t<div class=\"bx-livechat-warning-window\">\n\t\t\t\t<div class=\"bx-livechat-warning-icon\"></div>\n\t\t\t\t<template v-if=\"application.error.description\"> \n\t\t\t\t\t<div class=\"bx-livechat-help-title bx-livechat-help-title-sm bx-livechat-warning-msg\" v-html=\"application.error.description\"></div>\n\t\t\t\t</template> \n\t\t\t\t<template v-else>\n\t\t\t\t\t<div class=\"bx-livechat-help-title bx-livechat-help-title-md bx-livechat-warning-msg\">{{localize.BX_LIVECHAT_ERROR_TITLE}}</div>\n\t\t\t\t\t<div class=\"bx-livechat-help-title bx-livechat-help-title-sm bx-livechat-warning-msg\">{{localize.BX_LIVECHAT_ERROR_DESC}}</div>\n\t\t\t\t</template> \n\t\t\t</div>\n\t\t</div>\n\t`\n});\n","/**\n * Bitrix OpenLines widget\n * Head component (Vue component)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {Vue} from \"ui.vue\";\nimport {Vuex} from \"ui.vue.vuex\";\nimport { SessionStatus, VoteType } from \"../const\";\nimport {EventType} from \"im.const\";\n\nVue.component('bx-livechat-head',\n{\n\t/**\n\t * @emits 'close'\n\t * @emits 'like'\n\t * @emits 'history'\n\t */\n\tprops:\n\t{\n\t\tisWidgetDisabled: { default: false },\n\t},\n\tmethods:\n\t{\n\t\tclose(event)\n\t\t{\n\t\t\tthis.$emit('close');\n\t\t},\n\t\tlike(event)\n\t\t{\n\t\t\tthis.$emit('like');\n\t\t},\n\t\thistory(event)\n\t\t{\n\t\t\tthis.$emit('history');\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tVoteType: () => VoteType,\n\n\t\tcustomBackgroundStyle(state)\n\t\t{\n\t\t\treturn state.widget.common.styles.backgroundColor? 'background-color: '+state.widget.common.styles.backgroundColor+'!important;': '';\n\t\t},\n\t\tcustomBackgroundOnlineStyle(state)\n\t\t{\n\t\t\treturn state.widget.common.styles.backgroundColor? 'border-color: '+state.widget.common.styles.backgroundColor+'!important;': '';\n\t\t},\n\t\tshowName(state)\n\t\t{\n\t\t\treturn state.widget.dialog.operator.firstName || state.widget.dialog.operator.lastName;\n\t\t},\n\t\tvoteActive(state)\n\t\t{\n\t\t\tif (\n\t\t\t\t!state.widget.common.vote.beforeFinish\n\t\t\t\t&& state.widget.dialog.sessionStatus < SessionStatus.waitClient\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (!state.widget.dialog.sessionClose || state.widget.dialog.sessionClose && state.widget.dialog.userVote === VoteType.none)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tif (state.widget.dialog.sessionClose && state.widget.dialog.userVote !== VoteType.none)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\treturn false;\n\t\t},\n\t\tchatTitle(state)\n\t\t{\n\t\t\treturn state.widget.common.textMessages.bxLivechatTitle\n\t\t\t\t|| state.widget.common.configName\n\t\t\t\t|| this.localize.BX_LIVECHAT_TITLE\n\t\t},\n\t\toperatorName(state)\n\t\t{\n\t\t\tif (!this.showName)\n\t\t\t\treturn '';\n\n\t\t\treturn state.widget.dialog.operator.firstName? state.widget.dialog.operator.firstName: state.widget.dialog.operator.name\n\t\t},\n\t\toperatorDescription(state)\n\t\t{\n\t\t\tif (!this.showName)\n\t\t\t\treturn '';\n\n\t\t\treturn state.widget.dialog.operator.workPosition? state.widget.dialog.operator.workPosition: this.localize.BX_LIVECHAT_USER;\n\t\t},\n\t\tlocalize()\n\t\t{\n\t\t\treturn Vue.getFilteredPhrases('BX_LIVECHAT_', this.$root.$bitrixMessages);\n\t\t},\n\t\t...Vuex.mapState({\n\t\t\twidget: state => state.widget,\n\t\t\tapplication: state => state.application,\n\t\t})\n\t},\n\twatch:\n\t{\n\t\tshowName(value)\n\t\t{\n\t\t\tif (value)\n\t\t\t{\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tthis.$root.$emit(EventType.dialog.scrollToBottom);\n\t\t\t\t}, 300);\n\t\t\t}\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-livechat-head-wrap\">\n\t\t\t<template v-if=\"isWidgetDisabled\">\n\t\t\t\t<div class=\"bx-livechat-head\" :style=\"customBackgroundStyle\">\n\t\t\t\t\t<div class=\"bx-livechat-title\">{{chatTitle}}</div>\n\t\t\t\t\t<div class=\"bx-livechat-control-box\">\n\t\t\t\t\t\t<button v-if=\"!widget.common.pageMode\" class=\"bx-livechat-control-btn bx-livechat-control-btn-close\" :title=\"localize.BX_LIVECHAT_CLOSE_BUTTON\" @click=\"close\"></button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\t\n\t\t\t</template>\n\t\t\t<template v-else-if=\"application.error.active\">\n\t\t\t\t<div class=\"bx-livechat-head\" :style=\"customBackgroundStyle\">\n\t\t\t\t\t<div class=\"bx-livechat-title\">{{chatTitle}}</div>\n\t\t\t\t\t<div class=\"bx-livechat-control-box\">\n\t\t\t\t\t\t<button v-if=\"!widget.common.pageMode\" class=\"bx-livechat-control-btn bx-livechat-control-btn-close\" :title=\"localize.BX_LIVECHAT_CLOSE_BUTTON\" @click=\"close\"></button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t\t<template v-else-if=\"!widget.common.configId\">\n\t\t\t\t<div class=\"bx-livechat-head\" :style=\"customBackgroundStyle\">\n\t\t\t\t\t<div class=\"bx-livechat-title\">{{chatTitle}}</div>\n\t\t\t\t\t<div class=\"bx-livechat-control-box\">\n\t\t\t\t\t\t<button v-if=\"!widget.common.pageMode\" class=\"bx-livechat-control-btn bx-livechat-control-btn-close\" :title=\"localize.BX_LIVECHAT_CLOSE_BUTTON\" @click=\"close\"></button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</template>\t\t\t\n\t\t\t<template v-else>\n\t\t\t\t<div class=\"bx-livechat-head\" :style=\"customBackgroundStyle\">\n\t\t\t\t\t<template v-if=\"!showName\">\n\t\t\t\t\t\t<div class=\"bx-livechat-title\">{{chatTitle}}</div>\n\t\t\t\t\t</template>\n\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t<div class=\"bx-livechat-user bx-livechat-status-online\">\n\t\t\t\t\t\t\t<template v-if=\"widget.dialog.operator.avatar\">\n\t\t\t\t\t\t\t\t<div class=\"bx-livechat-user-icon\" :style=\"'background-image: url('+encodeURI(widget.dialog.operator.avatar)+')'\">\n\t\t\t\t\t\t\t\t\t<div v-if=\"widget.dialog.operator.online\" class=\"bx-livechat-user-status\" :style=\"customBackgroundOnlineStyle\"></div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t\t\t<div class=\"bx-livechat-user-icon\">\n\t\t\t\t\t\t\t\t\t<div v-if=\"widget.dialog.operator.online\" class=\"bx-livechat-user-status\" :style=\"customBackgroundOnlineStyle\"></div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"bx-livechat-user-info\">\n\t\t\t\t\t\t\t<div class=\"bx-livechat-user-name\">{{operatorName}}</div>\n\t\t\t\t\t\t\t<div class=\"bx-livechat-user-position\">{{operatorDescription}}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</template>\n\t\t\t\t\t<div class=\"bx-livechat-control-box\">\n\t\t\t\t\t\t<span class=\"bx-livechat-control-box-active\" v-if=\"widget.common.dialogStart && widget.dialog.sessionId\">\n\t\t\t\t\t\t\t<button v-if=\"widget.common.vote.enable && voteActive\" :class=\"'bx-livechat-control-btn bx-livechat-control-btn-like bx-livechat-dialog-vote-'+(widget.dialog.userVote)\" :title=\"localize.BX_LIVECHAT_VOTE_BUTTON\" @click=\"like\"></button>\n\t\t\t\t\t\t\t<button class=\"bx-livechat-control-btn bx-livechat-control-btn-mail\" :title=\"localize.BX_LIVECHAT_MAIL_BUTTON_NEW\" @click=\"history\"></button>\n\t\t\t\t\t\t</span>\t\n\t\t\t\t\t\t<button v-if=\"!widget.common.pageMode\" class=\"bx-livechat-control-btn bx-livechat-control-btn-close\" :title=\"localize.BX_LIVECHAT_CLOSE_BUTTON\" @click=\"close\"></button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t</div>\n\t`\n});","/**\n * Bitrix OpenLines widget\n * Body loading component (Vue component)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {Vue} from \"ui.vue\";\n\nVue.component('bx-livechat-body-loading',\n{\n\tcomputed:\n\t{\n\t\tlocalize()\n\t\t{\n\t\t\treturn  Object.freeze({\n\t\t\t\tBX_LIVECHAT_LOADING: this.$root.$bitrixMessages.BX_LIVECHAT_LOADING\n\t\t\t});\n\t\t}\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-livechat-loading-window\">\n\t\t\t<svg class=\"bx-livechat-loading-circular\" viewBox=\"25 25 50 50\">\n\t\t\t\t<circle class=\"bx-livechat-loading-path\" cx=\"50\" cy=\"50\" r=\"20\" fill=\"none\" stroke-miterlimit=\"10\"/>\n\t\t\t\t<circle class=\"bx-livechat-loading-inner-path\" cx=\"50\" cy=\"50\" r=\"20\" fill=\"none\" stroke-miterlimit=\"10\"/>\n\t\t\t</svg>\n\t\t\t<h3 class=\"bx-livechat-help-title bx-livechat-help-title-md bx-livechat-loading-msg\">{{localize.BX_LIVECHAT_LOADING}}</h3>\n\t\t</div>\n\t`\n});","/**\n * Bitrix OpenLines widget\n * Body operators component (Vue component)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {Vue} from \"ui.vue\";\nimport {Vuex} from \"ui.vue.vuex\";\n\nVue.component('bx-livechat-body-operators',\n{\n\tcomputed:\n\t{\n\t\tlocalize()\n\t\t{\n\t\t\treturn Vue.getFilteredPhrases('BX_LIVECHAT_', this.$root.$bitrixMessages);\n\t\t},\n\t\t...Vuex.mapState({\n\t\t\twidget: state => state.widget\n\t\t})\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-livechat-help-container\">\n\t\t\t<transition name=\"bx-livechat-animation-fade\">\n\t\t\t\t<h2 v-if=\"widget.common.online\" key=\"online\" class=\"bx-livechat-help-title bx-livechat-help-title-lg\">{{widget.common.textMessages.bxLivechatOnlineLine1}}<div class=\"bx-livechat-help-subtitle\">{{widget.common.textMessages.bxLivechatOnlineLine2}}</div></h2>\n\t\t\t\t<h2 v-else key=\"offline\" class=\"bx-livechat-help-title bx-livechat-help-title-sm\">{{widget.common.textMessages.bxLivechatOffline}}</h2>\n\t\t\t</transition>\t\n\t\t\t<div class=\"bx-livechat-help-user\">\n\t\t\t\t<template v-for=\"operator in widget.common.operators\">\n\t\t\t\t\t<div class=\"bx-livechat-user\" :key=\"operator.id\">\n\t\t\t\t\t\t<template v-if=\"operator.avatar\">\n\t\t\t\t\t\t\t<div class=\"bx-livechat-user-icon\" :style=\"'background-image: url('+encodeURI(operator.avatar)+')'\"></div>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t\t<div class=\"bx-livechat-user-icon\"></div>\n\t\t\t\t\t\t</template>\t\n\t\t\t\t\t\t<div class=\"bx-livechat-user-info\">\n\t\t\t\t\t\t\t<div class=\"bx-livechat-user-name\">{{operator.firstName? operator.firstName: operator.name}}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</template>\t\n\t\t\t</div>\n\t\t</div>\n\t`\n});","/**\n * Bitrix OpenLines widget\n * Body orientation disabled component (Vue component)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {Vue} from \"ui.vue\";\n\nVue.component('bx-livechat-body-orientation-disabled',\n{\n\tcomputed:\n\t{\n\t\tlocalize()\n\t\t{\n\t\t\treturn  Object.freeze({\n\t\t\t\tBX_LIVECHAT_MOBILE_ROTATE: this.$root.$bitrixMessages.BX_LIVECHAT_MOBILE_ROTATE\n\t\t\t});\n\t\t}\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-livechat-body\" key=\"orientation-head\">\n\t\t\t<div class=\"bx-livechat-mobile-orientation-box\">\n\t\t\t\t<div class=\"bx-livechat-mobile-orientation-icon\"></div>\n\t\t\t\t<div class=\"bx-livechat-mobile-orientation-text\">{{localize.BX_LIVECHAT_MOBILE_ROTATE}}</div>\n\t\t\t</div>\n\t\t</div>\n\t`\n});","/**\n * Bitrix OpenLines widget\n * Form consent component (Vue component)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {Vue} from \"ui.vue\";\nimport {Vuex} from \"ui.vue.vuex\";\n\nVue.component('bx-livechat-form-consent',\n{\n\t/**\n\t * @emits 'agree' {event: object} -- 'event' - click event\n\t * @emits 'disagree' {event: object} -- 'event' - click event\n\t */\n\tcomputed:\n\t{\n\t\tlocalize()\n\t\t{\n\t\t\treturn Vue.getFilteredPhrases('BX_LIVECHAT_', this.$root.$bitrixMessages);\n\t\t},\n\t\t...Vuex.mapState({\n\t\t\twidget: state => state.widget,\n\t\t})\n\t},\n\tmethods:\n\t{\n\t\tagree(event)\n\t\t{\n\t\t\tthis.$emit('agree', {event});\n\t\t},\n\t\tdisagree(event)\n\t\t{\n\t\t\tthis.$emit('disagree', {event});\n\t\t},\n\t\tonShow(element, done)\n\t\t{\n\t\t\telement.classList.add('bx-livechat-consent-window-show');\n\t\t\tdone();\n\t\t},\n\t\tonHide(element, done)\n\t\t{\n\t\t\telement.classList.remove('bx-livechat-consent-window-show');\n\t\t\telement.classList.add('bx-livechat-consent-window-close');\n\t\t\tsetTimeout(function() {\n\t\t\t\tdone();\n\t\t\t}, 400);\n\t\t},\n\t\tonKeyDown(event)\n\t\t{\n\t\t\tif (event.keyCode == 9)\n\t\t\t{\n\t\t\t\tif (event.target === this.$refs.iframe)\n\t\t\t\t{\n\t\t\t\t\tif (event.shiftKey)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$refs.cancel.focus();\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$refs.success.focus();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (event.target === this.$refs.success)\n\t\t\t\t{\n\t\t\t\t\tif (event.shiftKey)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$refs.iframe.focus();\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$refs.cancel.focus();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (event.target === this.$refs.cancel)\n\t\t\t\t{\n\t\t\t\t\tif (event.shiftKey)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$refs.success.focus();\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$refs.iframe.focus();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tevent.preventDefault();\n\t\t\t}\n\t\t\telse if (event.keyCode == 39 || event.keyCode == 37)\n\t\t\t{\n\t\t\t\tif (event.target.nextElementSibling)\n\t\t\t\t{\n\t\t\t\t\tevent.target.nextElementSibling.focus();\n\t\t\t\t}\n\t\t\t\telse if (event.target.previousElementSibling)\n\t\t\t\t{\n\t\t\t\t\tevent.target.previousElementSibling.focus();\n\t\t\t\t}\n\t\t\t\tevent.preventDefault();\n\t\t\t}\n\t\t},\n\t},\n\tdirectives:\n\t{\n\t\tfocus:\n\t\t{\n\t\t\tinserted(element, params)\n\t\t\t{\n\t\t\t\telement.focus();\n\t\t\t}\n\t\t}\n\t},\n\ttemplate: `\n\t\t<transition @enter=\"onShow\" @leave=\"onHide\">\n\t\t\t<template v-if=\"widget.common.showConsent && widget.common.consentUrl\">\n\t\t\t\t<div class=\"bx-livechat-consent-window\">\n\t\t\t\t\t<div class=\"bx-livechat-consent-window-title\">{{localize.BX_LIVECHAT_CONSENT_TITLE}}</div>\n\t\t\t\t\t<div class=\"bx-livechat-consent-window-content\">\n\t\t\t\t\t\t<iframe class=\"bx-livechat-consent-window-content-iframe\" ref=\"iframe\" frameborder=\"0\" marginheight=\"0\"  marginwidth=\"0\" allowtransparency=\"allow-same-origin\" seamless=\"true\" :src=\"widget.common.consentUrl\" @keydown=\"onKeyDown\"></iframe>\n\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\n\t\t\t\t\t<div class=\"bx-livechat-consent-window-btn-box\">\n\t\t\t\t\t\t<button class=\"bx-livechat-btn bx-livechat-btn-success\" ref=\"success\" @click=\"agree\" @keydown=\"onKeyDown\" v-focus>{{localize.BX_LIVECHAT_CONSENT_AGREE}}</button>\n\t\t\t\t\t\t<button class=\"bx-livechat-btn bx-livechat-btn-cancel\" ref=\"cancel\" @click=\"disagree\" @keydown=\"onKeyDown\">{{localize.BX_LIVECHAT_CONSENT_DISAGREE}}</button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t</transition>\n\t`\n});","/**\n * Bitrix OpenLines widget\n * Form history component (Vue component)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport 'ui.icons';\nimport 'ui.forms';\n\nimport {Vue} from \"ui.vue\";\nimport {Vuex} from \"ui.vue.vuex\";\nimport {Utils} from \"im.lib.utils\";\nimport {FormType} from \"../const\";\n\nVue.component('bx-livechat-form-history',\n{\n\tdata()\n\t{\n\t\treturn {\n\t\t\tfieldEmail: '',\n\t\t}\n\t},\n\twatch:\n\t{\n\t\tfieldEmail(value)\n\t\t{\n\t\t\tclearTimeout(this.fieldEmailTimeout);\n\t\t\tthis.fieldEmailTimeout = setTimeout(this.checkEmailField, 300);\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tlocalize()\n\t\t{\n\t\t\treturn Vue.getFilteredPhrases('BX_LIVECHAT_', this.$root.$bitrixMessages);\n\t\t},\n\t\t...Vuex.mapState({\n\t\t\twidget: state => state.widget,\n\t\t})\n\t},\n\tcreated()\n\t{\n\t\tthis.fieldEmail = '' + this.widget.user.email;\n\t},\n\tmethods:\n\t{\n\t\tformShowed()\n\t\t{\n\t\t\tif (!Utils.platform.isMobile())\n\t\t\t{\n\t\t\t\tthis.$refs.emailInput.focus();\n\t\t\t}\n\t\t},\n\t\tsendForm()\n\t\t{\n\t\t\tlet email = this.checkEmailField()? this.fieldEmail: '';\n\t\t\tif (email)\n\t\t\t{\n\t\t\t\tthis.$root.$bitrixApplication.sendForm(FormType.history, {email});\n\t\t\t}\n\n\t\t\tthis.hideForm();\n\t\t},\n\t\thideForm(event)\n\t\t{\n\t\t\tclearTimeout(this.fieldEmailTimeout);\n\t\t\tthis.$parent.hideForm();\n\t\t},\n\t\tonFieldEnterPress(event)\n\t\t{\n\t\t\tthis.sendForm();\n\t\t\tevent.preventDefault();\n\t\t},\n\t\tcheckEmailField()\n\t\t{\n\t\t\tif (this.fieldEmail.match(/^(.*)@(.*)\\.[a-zA-Z]{2,}$/))\n\t\t\t{\n\t\t\t\tif (this.$refs.email)\n\t\t\t\t{\n\t\t\t\t\tthis.$refs.email.classList.remove('ui-ctl-danger');\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (document.activeElement !== this.$refs.emailInput)\n\t\t\t\t{\n\t\t\t\t\tif (this.$refs.email)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$refs.email.classList.add('ui-ctl-danger');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\t\t},\n\t},\n\ttemplate: `\n\t\t<transition enter-active-class=\"bx-livechat-consent-window-show\" leave-active-class=\"bx-livechat-form-close\" @after-enter=\"formShowed\">\n\t\t\t<div class=\"bx-livechat-alert-box bx-livechat-form-show\" key=\"welcome\">\t\n\t\t\t\t<div class=\"bx-livechat-alert-close\" @click=\"hideForm\"></div>\n\t\t\t\t<div class=\"bx-livechat-alert-form-box\">\n\t\t\t\t\t<h4 class=\"bx-livechat-alert-title bx-livechat-alert-title-sm\">{{localize.BX_LIVECHAT_MAIL_TITLE_NEW}}</h4>\n\t\t\t\t\t<div class=\"bx-livechat-form-item ui-ctl ui-ctl-after-icon ui-ctl-w100 ui-ctl-lg\" ref=\"email\">\n\t\t\t\t\t   <div class=\"ui-ctl-after ui-ctl-icon-mail bx-livechat-form-icon\" :title=\"localize.BX_LIVECHAT_FIELD_MAIL_TOOLTIP\"></div>\n\t\t\t\t\t   <input type=\"text\" class=\"ui-ctl-element ui-ctl-textbox\" :placeholder=\"localize.BX_LIVECHAT_FIELD_MAIL\" v-model=\"fieldEmail\" ref=\"emailInput\" @blur=\"checkEmailField\" @keydown.enter=\"onFieldEnterPress\">\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"bx-livechat-btn-box\">\n\t\t\t\t\t\t<button class=\"bx-livechat-btn bx-livechat-btn-success\" @click=\"sendForm\">{{localize.BX_LIVECHAT_MAIL_BUTTON_NEW}}</button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\t\n\t\t</transition>\t\n\t`\n});","/**\n * Bitrix OpenLines widget\n * Form offline component (Vue component)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport 'ui.icons';\nimport 'ui.forms';\n\nimport {Vue} from \"ui.vue\";\nimport {Utils} from \"im.lib.utils\";\nimport {FormType} from \"../const\";\n\nVue.cloneComponent('bx-livechat-form-offline', 'bx-livechat-form-welcome',\n{\n\tmethods:\n\t{\n\t\tformShowed()\n\t\t{\n\t\t\tif (!Utils.platform.isMobile())\n\t\t\t{\n\t\t\t\tthis.$refs.emailInput.focus();\n\t\t\t}\n\t\t},\n\t\tsendForm()\n\t\t{\n\t\t\tlet name = this.fieldName;\n\t\t\tlet email = this.checkEmailField()? this.fieldEmail: '';\n\t\t\tlet phone = this.checkPhoneField()? this.fieldPhone: '';\n\n\t\t\tif (name || email || phone)\n\t\t\t{\n\t\t\t\tthis.$root.$bitrixApplication.sendForm(FormType.offline, {name, email, phone});\n\t\t\t}\n\n\t\t\tthis.hideForm();\n\t\t},\n\t\tonFieldEnterPress(event)\n\t\t{\n\t\t\tif (event.target === this.$refs.emailInput)\n\t\t\t{\n\t\t\t\tthis.showFullForm();\n\t\t\t\tthis.$refs.phoneInput.focus();\n\t\t\t}\n\t\t\telse if (event.target === this.$refs.phoneInput)\n\t\t\t{\n\t\t\t\tthis.$refs.nameInput.focus();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.sendForm();\n\t\t\t}\n\n\t\t\tevent.preventDefault();\n\t\t},\n\t},\n\twatch:\n\t{\n\t\tfieldName()\n\t\t{\n\t\t\tclearTimeout(this.fieldNameTimeout);\n\t\t\tthis.fieldNameTimeout = setTimeout(this.checkNameField, 300);\n\t\t},\n\t\tfieldEmail()\n\t\t{\n\t\t\tclearTimeout(this.showFormTimeout);\n\t\t\tthis.showFormTimeout = setTimeout(this.showFullForm, 1000);\n\n\t\t\tclearTimeout(this.fieldEmailTimeout);\n\t\t\tthis.fieldEmailTimeout = setTimeout(this.checkEmailField, 300);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<transition enter-active-class=\"bx-livechat-consent-window-show\" leave-active-class=\"bx-livechat-form-close\" @after-enter=\"formShowed\">\n\t\t\t<div class=\"bx-livechat-alert-box bx-livechat-form-show\" key=\"welcome\">\t\n\t\t\t\t<div class=\"bx-livechat-alert-close\" @click=\"hideForm\"></div>\n\t\t\t\t<div class=\"bx-livechat-alert-form-box\">\n\t\t\t\t\t<h4 class=\"bx-livechat-alert-title bx-livechat-alert-title-sm\">{{localize.BX_LIVECHAT_OFFLINE_TITLE}}</h4>\n\t\t\t\t\t<div class=\"bx-livechat-form-item ui-ctl ui-ctl-after-icon ui-ctl-w100 ui-ctl-lg\" ref=\"email\">\n\t\t\t\t\t   <div class=\"ui-ctl-after ui-ctl-icon-mail bx-livechat-form-icon\" :title=\"localize.BX_LIVECHAT_FIELD_MAIL_TOOLTIP\"></div>\n\t\t\t\t\t   <input type=\"text\" class=\"ui-ctl-element ui-ctl-textbox\" :placeholder=\"localize.BX_LIVECHAT_FIELD_MAIL\" v-model=\"fieldEmail\" ref=\"emailInput\" @blur=\"checkEmailField\" @keydown.enter=\"onFieldEnterPress\">\n\t\t\t\t\t</div>\n\t\t\t\t\t<div :class=\"['bx-livechat-form-short', {\n\t\t\t\t\t\t'bx-livechat-form-full': isFullForm,\n\t\t\t\t\t}]\">\n\t\t\t\t\t\t<div class=\"bx-livechat-form-item ui-ctl ui-ctl-after-icon ui-ctl-w100 ui-ctl-lg\" ref=\"phone\">\n\t\t\t\t\t\t   <div class=\"ui-ctl-after ui-ctl-icon-phone bx-livechat-form-icon\" :title=\"localize.BX_LIVECHAT_FIELD_PHONE_TOOLTIP\"></div>\n\t\t\t\t\t\t   <input type=\"text\" class=\"ui-ctl-element ui-ctl-textbox\" :placeholder=\"localize.BX_LIVECHAT_FIELD_PHONE\" v-model=\"fieldPhone\" ref=\"phoneInput\" @blur=\"checkPhoneField\" @keydown.enter=\"onFieldEnterPress\">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"bx-livechat-form-item ui-ctl ui-ctl-w100 ui-ctl-lg\" ref=\"name\">\n\t\t\t\t\t\t   <input type=\"text\" class=\"ui-ctl-element ui-ctl-textbox\" :placeholder=\"localize.BX_LIVECHAT_FIELD_NAME\" v-model=\"fieldName\" ref=\"nameInput\" @blur=\"checkNameField\" @keydown.enter=\"onFieldEnterPress\"  @keydown.tab=\"onFieldEnterPress\">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"bx-livechat-btn-box\">\n\t\t\t\t\t\t\t<button class=\"bx-livechat-btn bx-livechat-btn-success\" @click=\"sendForm\">{{localize.BX_LIVECHAT_ABOUT_SEND}}</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\t\n\t\t</transition>\t\n\t`\n});","/**\n * Bitrix OpenLines widget\n * Form vote component (Vue component)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {Vue} from \"ui.vue\";\nimport {Vuex} from \"ui.vue.vuex\";\nimport {VoteType, FormType} from \"../const\";\n\nVue.component('bx-livechat-form-vote',\n{\n\tcomputed:\n\t{\n\t\tVoteType: () => VoteType,\n\n\t\tlocalize()\n\t\t{\n\t\t\treturn Vue.getFilteredPhrases('BX_LIVECHAT_', this.$root.$bitrixMessages);\n\t\t},\n\t\t...Vuex.mapState({\n\t\t\twidget: state => state.widget,\n\t\t})\n\t},\n\tmethods: {\n\t\tuserVote(vote)\n\t\t{\n\t\t\tthis.$store.commit('widget/common', {showForm: FormType.none});\n\t\t\tthis.$store.commit('widget/dialog', {userVote: vote});\n\n\t\t\tthis.$root.$bitrixApplication.sendDialogVote(vote);\n\t\t},\n\t\thideForm(event)\n\t\t{\n\t\t\tthis.$parent.hideForm();\n\t\t},\n\t},\n\ttemplate: `\n\t\t<transition enter-active-class=\"bx-livechat-consent-window-show\" leave-active-class=\"bx-livechat-form-close\">\n\t\t\t<div class=\"bx-livechat-alert-box bx-livechat-form-rate-show\" key=\"vote\">\n\t\t\t\t<div class=\"bx-livechat-alert-close\" @click=\"hideForm\"></div>\n\t\t\t\t<div class=\"bx-livechat-alert-rate-box\">\n\t\t\t\t\t<h4 class=\"bx-livechat-alert-title bx-livechat-alert-title-mdl\">{{widget.common.vote.messageText}}</h4>\n\t\t\t\t\t<div class=\"bx-livechat-btn-box\">\n\t\t\t\t\t\t<button class=\"bx-livechat-btn bx-livechat-btn-like\" @click=\"userVote(VoteType.like)\" :title=\"widget.common.vote.messageLike\"></button>\n\t\t\t\t\t\t<button class=\"bx-livechat-btn bx-livechat-btn-dislike\" @click=\"userVote(VoteType.dislike)\" :title=\"widget.common.vote.messageDislike\"></button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</transition>\t\n\t`\n});","/**\n * Bitrix OpenLines widget\n * Form welcome component (Vue component)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport 'ui.icons';\nimport 'ui.forms';\n\nimport {Vue} from \"ui.vue\";\nimport {Vuex} from \"ui.vue.vuex\";\nimport {Utils} from \"im.lib.utils\";\nimport {FormType} from \"../const\";\n\nVue.component('bx-livechat-form-welcome',\n{\n\tdata()\n\t{\n\t\treturn {\n\t\t\tfieldName: '',\n\t\t\tfieldEmail: '',\n\t\t\tfieldPhone: '',\n\t\t\tisFullForm: Utils.platform.isMobile()\n\t\t}\n\t},\n\twatch:\n\t{\n\t\tfieldName()\n\t\t{\n\t\t\tclearTimeout(this.showFormTimeout);\n\t\t\tthis.showFormTimeout = setTimeout(this.showFullForm, 1000);\n\n\t\t\tclearTimeout(this.fieldNameTimeout);\n\t\t\tthis.fieldNameTimeout = setTimeout(this.checkNameField, 300);\n\t\t},\n\t\tfieldEmail(value)\n\t\t{\n\t\t\tclearTimeout(this.fieldEmailTimeout);\n\t\t\tthis.fieldEmailTimeout = setTimeout(this.checkEmailField, 300);\n\t\t},\n\t\tfieldPhone(value)\n\t\t{\n\t\t\tclearTimeout(this.fieldPhoneTimeout);\n\t\t\tthis.fieldPhoneTimeout = setTimeout(this.checkPhoneField, 300);\n\t\t}\n\t},\n\tcomputed:\n\t{\n\t\tlocalize()\n\t\t{\n\t\t\treturn Vue.getFilteredPhrases('BX_LIVECHAT_', this.$root.$bitrixMessages);\n\t\t},\n\t\t...Vuex.mapState({\n\t\t\twidget: state => state.widget,\n\t\t})\n\t},\n\tcreated()\n\t{\n\t\tthis.fieldName = '' + this.widget.user.name;\n\t\tthis.fieldEmail = '' + this.widget.user.email;\n\t\tthis.fieldPhone = '' + this.widget.user.phone;\n\t},\n\tmethods:\n\t{\n\t\tformShowed()\n\t\t{\n\t\t\tif (!Utils.platform.isMobile())\n\t\t\t{\n\t\t\t\tthis.$refs.nameInput.focus();\n\t\t\t}\n\t\t},\n\t\tshowFullForm()\n\t\t{\n\t\t\tclearTimeout(this.showFormTimeout);\n\t\t\tthis.isFullForm = true;\n\t\t},\n\t\tsendForm()\n\t\t{\n\t\t\tlet name = this.fieldName;\n\t\t\tlet email = this.checkEmailField()? this.fieldEmail: '';\n\t\t\tlet phone = this.checkPhoneField()? this.fieldPhone: '';\n\n\t\t\tif (name || email || phone)\n\t\t\t{\n\t\t\t\tthis.$root.$bitrixApplication.sendForm(FormType.welcome, {name, email, phone});\n\t\t\t}\n\n\t\t\tthis.hideForm();\n\t\t},\n\t\thideForm(event)\n\t\t{\n\t\t\tclearTimeout(this.showFormTimeout);\n\t\t\tclearTimeout(this.fieldNameTimeout);\n\t\t\tclearTimeout(this.fieldEmailTimeout);\n\t\t\tclearTimeout(this.fieldPhoneTimeout);\n\n\t\t\tthis.$parent.hideForm();\n\t\t},\n\t\tonFieldEnterPress(event)\n\t\t{\n\t\t\tif (event.target === this.$refs.nameInput)\n\t\t\t{\n\t\t\t\tthis.showFullForm();\n\t\t\t\tthis.$refs.emailInput.focus();\n\t\t\t}\n\t\t\telse if (event.target === this.$refs.emailInput)\n\t\t\t{\n\t\t\t\tthis.$refs.phoneInput.focus();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.sendForm();\n\t\t\t}\n\n\t\t\tevent.preventDefault();\n\t\t},\n\t\tcheckNameField()\n\t\t{\n\t\t\tif (this.fieldName.length > 0)\n\t\t\t{\n\t\t\t\tif (this.$refs.name)\n\t\t\t\t{\n\t\t\t\t\tthis.$refs.name.classList.remove('ui-ctl-danger');\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (document.activeElement !== this.$refs.nameInput)\n\t\t\t\t{\n\t\t\t\t\tif (this.$refs.name)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$refs.name.classList.add('ui-ctl-danger');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\t\t},\n\t\tcheckEmailField()\n\t\t{\n\t\t\tif (this.fieldEmail.match(/^(.*)@(.*)\\.[a-zA-Z]{2,}$/))\n\t\t\t{\n\t\t\t\tif (this.$refs.email)\n\t\t\t\t{\n\t\t\t\t\tthis.$refs.email.classList.remove('ui-ctl-danger');\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (document.activeElement !== this.$refs.emailInput)\n\t\t\t\t{\n\t\t\t\t\tif (this.$refs.email)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$refs.email.classList.add('ui-ctl-danger');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\t\t},\n\t\tcheckPhoneField()\n\t\t{\n\t\t\tif (this.fieldPhone.match(/^(\\s*)?(\\+)?([- _():=+]?\\d[- _():=+]?){10,14}(\\s*)?$/))\n\t\t\t{\n\t\t\t\tif (this.$refs.phone)\n\t\t\t\t{\n\t\t\t\t\tthis.$refs.phone.classList.remove('ui-ctl-danger');\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (document.activeElement !== this.$refs.phoneInput)\n\t\t\t\t{\n\t\t\t\t\tif (this.$refs.phone)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$refs.phone.classList.add('ui-ctl-danger');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t},\n\ttemplate: `\n\t\t<transition enter-active-class=\"bx-livechat-consent-window-show\" leave-active-class=\"bx-livechat-form-close\" @after-enter=\"formShowed\">\n\t\t\t<div class=\"bx-livechat-alert-box bx-livechat-form-show\" key=\"welcome\">\t\n\t\t\t\t<div class=\"bx-livechat-alert-close\" @click=\"hideForm\"></div>\n\t\t\t\t<div class=\"bx-livechat-alert-form-box\">\n\t\t\t\t\t<h4 class=\"bx-livechat-alert-title bx-livechat-alert-title-sm\">{{localize.BX_LIVECHAT_ABOUT_TITLE}}</h4>\n\t\t\t\t\t<div class=\"bx-livechat-form-item ui-ctl ui-ctl-w100 ui-ctl-lg\" ref=\"name\">\n\t\t\t\t\t   <input type=\"text\" class=\"ui-ctl-element ui-ctl-textbox\" :placeholder=\"localize.BX_LIVECHAT_FIELD_NAME\" v-model=\"fieldName\" ref=\"nameInput\" @blur=\"checkNameField\" @keydown.enter=\"onFieldEnterPress\"  @keydown.tab=\"onFieldEnterPress\">\n\t\t\t\t\t</div>\n\t\t\t\t\t<div :class=\"['bx-livechat-form-short', {\n\t\t\t\t\t\t'bx-livechat-form-full': isFullForm,\n\t\t\t\t\t}]\">\n\t\t\t\t\t\t<div class=\"bx-livechat-form-item ui-ctl ui-ctl-after-icon ui-ctl-w100 ui-ctl-lg\" ref=\"email\">\n\t\t\t\t\t\t   <div class=\"ui-ctl-after ui-ctl-icon-mail bx-livechat-form-icon\" :title=\"localize.BX_LIVECHAT_FIELD_MAIL_TOOLTIP\"></div>\n\t\t\t\t\t\t   <input type=\"text\" class=\"ui-ctl-element ui-ctl-textbox\" :placeholder=\"localize.BX_LIVECHAT_FIELD_MAIL\" v-model=\"fieldEmail\" ref=\"emailInput\" @blur=\"checkEmailField\" @keydown.enter=\"onFieldEnterPress\">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"bx-livechat-form-item ui-ctl ui-ctl-after-icon ui-ctl-w100 ui-ctl-lg\" ref=\"phone\">\n\t\t\t\t\t\t   <div class=\"ui-ctl-after ui-ctl-icon-phone bx-livechat-form-icon\" :title=\"localize.BX_LIVECHAT_FIELD_PHONE_TOOLTIP\"></div>\n\t\t\t\t\t\t   <input type=\"text\" class=\"ui-ctl-element ui-ctl-textbox\" :placeholder=\"localize.BX_LIVECHAT_FIELD_PHONE\" v-model=\"fieldPhone\" ref=\"phoneInput\" @blur=\"checkPhoneField\" @keydown.enter=\"onFieldEnterPress\">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"bx-livechat-btn-box\">\n\t\t\t\t\t\t\t<button class=\"bx-livechat-btn bx-livechat-btn-success\" @click=\"sendForm\">{{localize.BX_LIVECHAT_ABOUT_SEND}}</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\t\n\t\t</transition>\t\n\t`\n});","/**\n * Bitrix OpenLines widget\n * Smiles component (Vue component)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {Vue} from \"ui.vue\";\n\nVue.cloneComponent('bx-livechat-smiles', 'bx-smiles',\n{\n\tmethods:\n\t{\n\t\thideForm(event)\n\t\t{\n\t\t\tthis.$parent.hideForm();\n\t\t},\n\t},\n\ttemplate: `\n\t\t<transition enter-active-class=\"bx-livechat-consent-window-show\" leave-active-class=\"bx-livechat-form-close\">\n\t\t\t<div class=\"bx-livechat-alert-box bx-livechat-alert-box-zero-padding bx-livechat-form-show\" key=\"vote\">\n\t\t\t\t<div class=\"bx-livechat-alert-close\" @click=\"hideForm\"></div>\n\t\t\t\t<div class=\"bx-livechat-alert-smiles-box\">\n\t\t\t\t\t#PARENT_TEMPLATE#\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</transition>\n\t`\n});","/**\n * Bitrix OpenLines widget\n * Footer component (Vue component)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {Vue} from \"ui.vue\";\nimport {Vuex} from \"ui.vue.vuex\";\n\nVue.component('bx-livechat-footer',\n{\n\tcomputed:\n\t{\n\t\tlocalize()\n\t\t{\n\t\t\treturn Vue.getFilteredPhrases('BX_LIVECHAT_COPYRIGHT_', this.$root.$bitrixMessages);\n\t\t},\n\t\t...Vuex.mapState({\n\t\t\twidget: state => state.widget\n\t\t})\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-livechat-copyright\">\t\n\t\t\t<template v-if=\"widget.common.copyrightUrl\">\n\t\t\t\t<a :href=\"widget.common.copyrightUrl\" target=\"_blank\">\n\t\t\t\t\t<span class=\"bx-livechat-logo-name\">{{localize.BX_LIVECHAT_COPYRIGHT_TEXT}}</span>\n\t\t\t\t\t<span class=\"bx-livechat-logo-icon\"></span>\n\t\t\t\t</a>\n\t\t\t</template>\n\t\t\t<template v-else>\n\t\t\t\t<span class=\"bx-livechat-logo-name\">{{localize.BX_LIVECHAT_COPYRIGHT_TEXT}}</span>\n\t\t\t\t<span class=\"bx-livechat-logo-icon\"></span>\n\t\t\t</template>\n\t\t</div>\n\t`\n});\n","/**\n * Bitrix OpenLines widget\n * Widget component & controller\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\n// core\n\nimport 'main.polyfill.customevent';\n\n// vue components\nimport 'pull.component.status';\nimport 'ui.vue.components.smiles';\nimport 'im.view.dialog';\nimport 'im.view.textarea';\nimport 'im.view.quotepanel';\nimport 'imopenlines.component.message';\nimport 'imopenlines.component.form';\n\n// widget files\nimport \"./widget.css\";\nimport {VoteType, LocationStyle, SubscriptionType} from \"./const\";\n\n// widget utils\nimport {Cookie} from \"im.lib.cookie\";\nimport {WidgetPublicManager} from \"./public\";\n\n// widget components\n\nimport \"./component/bx-livechat\";\nimport \"./component/bx-livechat-body-error\";\nimport \"./component/bx-livechat-body-head\";\nimport \"./component/bx-livechat-body-loading\";\nimport \"./component/bx-livechat-body-operators\";\nimport \"./component/bx-livechat-body-orientation-disabled\";\nimport \"./component/bx-livechat-form-consent\";\nimport \"./component/bx-livechat-form-history\";\nimport \"./component/bx-livechat-form-offline\";\nimport \"./component/bx-livechat-form-vote\";\nimport \"./component/bx-livechat-form-welcome\";\nimport \"./component/bx-livechat-smiles\";\nimport \"./component/bx-livechat-footer\";\n\n\nBX.LiveChatWidget = WidgetPublicManager;\nBX.LiveChatWidget.VoteType = VoteType;\nBX.LiveChatWidget.SubscriptionType = SubscriptionType;\nBX.LiveChatWidget.LocationStyle = LocationStyle;\nBX.LiveChatWidget.Cookie = Cookie;\n\nwindow.dispatchEvent(new CustomEvent('onBitrixLiveChatSourceLoaded', {detail: {}}));"],"names":["GetObjectValues","source","destination","value","hasOwnProperty","push","VoteType","Object","freeze","none","like","dislike","LanguageType","russian","ukraine","world","FormType","smile","consent","welcome","offline","history","LocationType","topLeft","topMiddle","topBottom","bottomLeft","bottomMiddle","bottomRight","LocationStyle","SubscriptionType","configLoaded","widgetOpen","widgetClose","sessionStart","sessionOperatorChange","sessionFinish","operatorMessage","userForm","userMessage","userFile","userVote","every","SubscriptionTypeCheck","RestMethod","widgetUserRegister","widgetConfigGet","widgetDialogGet","widgetUserGet","widgetUserConsentApply","widgetVoteSend","widgetFormSend","pullServerTime","pullConfigGet","RestMethodCheck","RestAuth","guest","SessionStatus","new","skip","answer","client","clientAfterOperator","operator","waitClient","close","spam","duplicate","silentlyClose","WidgetModel","common","configId","configName","host","getVariable","location","protocol","pageMode","copyright","copyrightUrl","styles","backgroundColor","iconColor","vote","enable","beforeFinish","messageText","messageLike","messageDislike","textMessages","bxLivechatOnlineLine1","bxLivechatOnlineLine2","bxLivechatOffline","bxLivechatTitle","online","operators","connectors","showForm","showed","reopen","dragged","textareaHeight","widgetHeight","widgetWidth","showConsent","consentUrl","dialogStart","watchTyping","dialog","sessionId","sessionClose","sessionStatus","userConsent","operatorChatId","id","name","firstName","lastName","workPosition","avatar","user","hash","email","phone","www","gender","position","state","payload","Utils","types","isPlainObject","device","isMobile","Array","isSaveNeeded","saveState","toString","startsWith","Cookie","set","expires","path","show","commit","VuexBuilderModel","WidgetRestClient","params","queryAuthRestore","setAuthId","restClient","RestClient","endpoint","queryParams","cors","authId","customAuthId","match","livechat_auth_id","console","error","livechat_custom_auth_id","method","callback","sendCallback","logTag","getLogTrackingParams","promise","BX","Promise","callMethod","then","result","fulfill","catch","ex","warn","error_description","reject","calls","bHaltOnError","resultCallback","callBatch","WidgetRestAnswerHandler","props","widget","data","store","disk","addLocalize","serverVariables","LocalStorage","getSiteId","previousData","messages","collection","controller","application","getChatId","chatId","dialogId","fields","entityType","type","dispatch","userId","diskFolderId","handleImDialogMessagesGetSuccess","length","isDialogStart","messageId","message","messagesQueue","filter","el","sendEvent","text","BaseRestHandler","WidgetImPullCommandHandler","extra","command","senderId","getUserId","onceShowed","open","WidgetImopenlinesPullCommandHandler","Widget","template","rootNode","node","document","createElement","ready","widgetDataRequested","inited","initEventFired","userRegisterData","customData","subscribers","configRequestXhr","initParams","initRestClient","initPullClient","initCore","initWidget","initComplete","code","language","buttonInstance","useBitrixLocalize","placeholder","getElementById","body","firstChild","insertBefore","appendChild","localize","window","get","resolve","pullClient","PullClient","serverEnabled","siteId","skipStorageInit","configTimestamp","skipCheckRevision","getPublicListMethod","pullClientInited","widgetVariables","getHost","getLocalize","Controller","languageId","pull","rest","vuexBuilder","database","browser","isIe","databaseName","databaseType","VuexBuilder","DatabaseType","localStorage","models","create","setVariables","isUserRegistered","getUserHash","getStore","setPrepareFilesBeforeSaveFunction","prepareFileData","bind","addRestAnswerHandler","dispatchEvent","CustomEvent","detail","widgetCode","widgetHost","callStartFlag","start","callOpenFlag","isReady","getUserHashCookie","requestData","fireInitEvent","isConfigDataLoaded","xhr","clearError","executeRestAnswer","setError","requestDataSend","abort","query","config_id","getConfigId","trace_data","getCrmTraceData","custom_data","getCustomData","ImRestMethodHandler","imChatGet","ImRestMethod","dialog_id","imDialogMessagesGetInit","imDialogMessagesGet","chat_id","limit","getRequestMessageLimit","convert_text","getUserRegisterFields","isUserAgreeConsent","consent_url","href","response","configGet","userGetResult","chatGetResult","dialogGetResult","dialogMessagesGetResult","getDialogId","userRegisterResult","timeShift","serverTimeResult","Math","floor","Date","getTime","config","pullConfigResult","server","startPullClient","processSendMessages","getDialogData","files","isArray","map","file","md5","urlParam","urlPreview","urlShow","urlDownload","platform","isIos","version","getIosVersion","isConnected","scheduleReconnect","config_timestamp","storage","StorageManager","subscribe","Status","eventStatusInteraction","pullConnectedFirstTime","status","PullStatus","Online","$root","$bitrixPullClient","$emit","skipReconnectToLastSession","stop","CloseReasons","MANUAL","restart","pullRequestMessage","getDialogUnread","readMessage","Offline","innerHTML","createVue","beforeCreate","destroyed","templateAttached","vue","$destroy","Vue","mutateComponent","Logger","isUnreadMessagesLoaded","sendMessage","FILE_ID","authorId","sending","fileInput","size","fileType","addMessage","extension","split","splice","image","FileStatus","upload","progress","authorName","getCurrentUser","fileId","element","find","forEach","sendMessageWithFile","stopWriting","quiteId","getters","quoteMessage","newMessage","join","quoteMessageClear","imMessageAdd","timMessageType","getDiskFolderId","imDiskFileUpload","NAME","fileContent","generateUniqueName","imDiskFolderGet","fileError","diskFolderGet","diskId","diskFileUpload","ID","wait","fileCommit","uploadId","imDiskFileCommit","retry","upload_id","template_id","file_template_id","lastId","EventType","requestHistoryResult","count","requestUnreadResult","imDialogRead","message_id","imDialogMessagesGetUnread","first_id","dialogMessageUnread","firstMessageId","setSendingMessageFlag","quoteId","reaction","reactMessage","action","botId","imMessageCommand","getSessionId","info","toUpperCase","form","isSessionActive","requestWidgetData","clearTimeout","openTimeout","openFromButton","wm","showById","checkBrowserVersion","BX_LIVECHAT_OLD_BROWSER","versionCompare","alert","BX_LIVECHAT_OLD_VUE","BX_LIVECHAT_OLD_VUE_DEV","replace","isWidgetDataRequested","attachTemplate","onWidgetClose","detachTemplate","traceData","getTrace","b24Tracker","MESSAGE","BX_LIVECHAT_EXTRA_SITE","JSON","stringify","dialogues","userHash","cookie","validUserFields","field","indexOf","setNewAuthToken","authToken","getStoreBuilder","clearModelState","concat","description","localizeDescription","endsWith","active","includes","phrases","phrase","WidgetPublicManager","developerInfo","__privateMethods__","__createLegacyMethods","showNotification","getUserData","setUserRegisterData","setCustomData","mutateTemplateComponent","LiveChat","sourceHref","sourceDomain","hostname","port","openLiveChat","closeLiveChat","addEventListener","eventName","handler","event","origin","setCookie","getCookie","BxLiveChatInit","firstMessage","BxLiveChatLoader","component","viewPortMetaSiteNode","viewPortMetaWidgetNode","storedMessage","storedFile","widgetMinimumHeight","widgetMinimumWidth","widgetBaseHeight","widgetBaseWidth","widgetMargin","widgetAvailableHeight","widgetAvailableWidth","widgetCurrentHeight","widgetCurrentWidth","widgetDrag","textareaFocused","textareaDrag","textareaMinimumHeight","textareaMaximumHeight","created","onCreated","onWindowKeyDown","getAvailableSpaceFunc","throttle","getAvailableSpace","$on","onRequestShowForm","beforeDestroy","removeEventListener","$off","onTextareaDragEventRemove","computed","DeviceType","textareaHeightStyle","flex","textAreaBottomMargin","isBottomLocation","marginBottom","widgetBaseSizes","width","height","widgetHeightStyle","max","widgetWidthStyle","userSelectStyle","isLeftLocation","getFilteredPhrases","$bitrixMessages","widgetMobileDisabled","mobile","navigator","userAgent","orientation","DeviceOrientation","horizontal","screen","availHeight","widgetClassName","className","isSafari","isMac","isDarkColor","showMessageDialog","messageCollection","quotePanelData","title","color","$store","textConverted","BX_LIVECHAT_FILE_MESSAGE","Vuex","mapState","watch","log","methods","onBeforeClose","bottomPosition","$refs","widgetWrapper","getBoundingClientRect","bottom","widgetBottomMargin","innerHeight","topPosition","top","innerWidth","showLikeForm","showFormTimeout","showWelcomeForm","showOfflineForm","showHistoryForm","hideForm","showConsentWidow","agreeConsentWidow","$bitrixApplication","sendConsentDecision","onTextareaSend","focus","onTextareaFileSelected","textarea","disagreeConsentWidow","insertText","logEvent","from","head","getElementsByTagName","removeChild","contentWidth","offsetWidth","setAttribute","classList","add","isSafariBased","setTimeout","remove","onAfterClose","delayed","onDialogRequestHistory","getDialogHistory","onDialogRequestUnread","onDialogMessageClickByUserName","onDialogMessageClickByUploadCancel","cancelUploadFile","onDialogMessageClickByKeyboardButton","execMessageKeyboardCommand","onDialogMessageClickByCommand","onDialogMessageMenuClick","onDialogMessageRetryClick","retrySendMessage","onDialogReadMessage","onDialogQuoteMessage","onDialogMessageReactionSet","onDialogClick","onTextareaKeyUp","isPublishingEnabled","infoString","onTextareaWrites","$bitrixController","startWriting","onTextareaFocus","onTextareaFocusScrollTimeout","onWindowScroll","onTextareaBlur","$nextTick","scrollToBottom","force","onTextareaStartDrag","changedTouches","textareaDragCursorStartPoint","clientY","textareaDragHeightStartPoint","onTextareaDragEventAdd","blur","onTextareaContinueDrag","textareaDragCursorControlPoint","min","onTextareaStopDrag","maxFileSize","BX_LIVECHAT_FILE_SIZE_EXCEEDED","round","uploadFile","onTextareaAppButtonClick","appId","onPullRequestConfig","recoverPullConnection","onSmilesSelectSmile","onSmilesSelectSet","onQuotePanelClose","onWidgetStartDrag","widgetDragCursorStartPointY","widgetDragCursorStartPointX","clientX","widgetDragHeightStartPoint","widgetDragWidthStartPoint","onWidgetDragEventAdd","onWidgetContinueDrag","widgetDragCursorControlPointY","widgetDragCursorControlPointX","onWidgetStopDrag","onWidgetDragEventRemove","keyCode","preventDefault","stopPropagation","onWindowScrollTimeout","BX_LIVECHAT_ERROR_TITLE","BX_LIVECHAT_ERROR_DESC","isWidgetDisabled","default","customBackgroundStyle","customBackgroundOnlineStyle","showName","voteActive","chatTitle","BX_LIVECHAT_TITLE","operatorName","operatorDescription","BX_LIVECHAT_USER","BX_LIVECHAT_LOADING","BX_LIVECHAT_MOBILE_ROTATE","agree","disagree","onShow","done","onHide","onKeyDown","target","iframe","shiftKey","cancel","success","nextElementSibling","previousElementSibling","directives","inserted","fieldEmail","fieldEmailTimeout","checkEmailField","formShowed","emailInput","sendForm","$parent","onFieldEnterPress","activeElement","cloneComponent","fieldName","checkPhoneField","fieldPhone","showFullForm","phoneInput","nameInput","fieldNameTimeout","checkNameField","sendDialogVote","isFullForm","fieldPhoneTimeout","LiveChatWidget"],"mappings":"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"}