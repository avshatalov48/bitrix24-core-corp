{"version":3,"file":"widget.bundle.js","sources":["../src/const.js","../src/utils/cookie.js","../src/model.js","../src/utils/restclient.js","../src/rest.handler.js","../src/pull.handler.js","../src/widget.js","../src/public.js","../src/component/bx-livechat.js","../src/component/bx-livechat-body-error.js","../src/component/bx-livechat-body-head.js","../src/component/bx-livechat-body-loading.js","../src/component/bx-livechat-body-operators.js","../src/component/bx-livechat-body-orientation-disabled.js","../src/component/bx-livechat-form-consent.js","../src/component/bx-livechat-form-history.js","../src/component/bx-livechat-form-offline.js","../src/component/bx-livechat-form-vote.js","../src/component/bx-livechat-form-welcome.js","../src/component/bx-livechat-smiles.js","../src/component/bx-livechat-footer.js","../src/registry.js"],"sourcesContent":["/**\n * Bitrix OpenLines widget\n * Widget constants\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nfunction GetObjectValues(source)\n{\n\tconst destination = [];\n\tfor (let value in source)\n\t{\n\t\tif (source.hasOwnProperty(value))\n\t\t{\n\t\t\tdestination.push(source[value]);\n\t\t}\n\t}\n\treturn destination;\n}\n\n/* region 01. Constants */\n\nexport const VoteType = Object.freeze({\n\tnone: 'none',\n\tlike: 'like',\n\tdislike: 'dislike',\n});\n\nexport const LanguageType = Object.freeze({\n\trussian: 'ru',\n\tukraine: 'ua',\n\tworld: 'en',\n});\n\nexport const FormType = Object.freeze({\n\tnone: 'none',\n\tlike: 'like',\n\tsmile: 'smile',\n\tconsent: 'consent',\n\twelcome: 'welcome',\n\toffline: 'offline',\n\thistory: 'history',\n});\n\nexport const LocationType = Object.freeze({\n\ttopLeft: 1,\n\ttopMiddle: 2,\n\ttopBottom: 3,\n\tbottomLeft: 6,\n\tbottomMiddle: 5,\n\tbottomRight: 4,\n});\n\nexport const LocationStyle = Object.freeze({\n\t1: 'top-left',\n\t2: 'top-center',\n\t3: 'top-right',\n\t6: 'bottom-left',\n\t5: 'bottom-center',\n\t4: 'bottom-right',\n});\n\nexport const SubscriptionType = Object.freeze({\n\tconfigLoaded: 'configLoaded',\n\twidgetOpen: 'widgetOpen',\n\twidgetClose: 'widgetClose',\n\tsessionStart: 'sessionStart',\n\tsessionOperatorChange: 'sessionOperatorChange',\n\tsessionFinish: 'sessionFinish',\n\toperatorMessage: 'operatorMessage',\n\tuserForm: 'userForm',\n\tuserMessage: 'userMessage',\n\tuserFile: 'userFile',\n\tuserVote: 'userVote',\n\tevery: 'every',\n});\nexport const SubscriptionTypeCheck = GetObjectValues(SubscriptionType);\n\nexport const RestMethod = Object.freeze({\n\twidgetUserRegister: 'imopenlines.widget.user.register',\n\twidgetConfigGet: 'imopenlines.widget.config.get',\n\twidgetDialogGet: 'imopenlines.widget.dialog.get',\n\twidgetUserGet: 'imopenlines.widget.user.get',\n\twidgetUserConsentApply: 'imopenlines.widget.user.consent.apply',\n\twidgetVoteSend: 'imopenlines.widget.vote.send',\n\twidgetFormSend: 'imopenlines.widget.form.send',\n\n\tpullServerTime: 'server.time',\n\tpullConfigGet: 'pull.config.get',\n});\nexport const RestMethodCheck = GetObjectValues(RestMethod);\n\nexport const RestAuth = Object.freeze({\n\tguest: 'guest',\n});\n\nexport const SessionStatus = Object.freeze({\n\tnew: 0,\n\tskip: 5,\n\tanswer: 10,\n\tclient: 20,\n\tclientAfterOperator: 25,\n\toperator: 40,\n\twaitClient: 50,\n\tclose: 60,\n\tspam: 65,\n\tduplicate: 69,\n\tsilentlyClose: 75,\n});","/**\n * Bitrix OpenLines widget\n * Cookie manager\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {LocalStorage} from \"im.tools.localstorage\";\n\nexport const Cookie =\n{\n\tget(siteId, name)\n\t{\n\t\tlet cookieName = siteId? siteId+'_'+name: name;\n\n\t\tif (navigator.cookieEnabled)\n\t\t{\n\t\t\tlet result = document.cookie.match(new RegExp(\n\t\t\t\t\"(?:^|; )\" + cookieName.replace(/([.$?*|{}()\\[\\]\\\\\\/+^])/g, '\\\\$1') + \"=([^;]*)\"\n\t\t\t));\n\n\t\t\tif (result)\n\t\t\t{\n\t\t\t\treturn decodeURIComponent(result[1]);\n\t\t\t}\n\t\t}\n\n\t\tif (LocalStorage.isEnabled())\n\t\t{\n\t\t\tlet result = LocalStorage.get(siteId, 0, name, undefined);\n\t\t\tif (typeof result !== 'undefined')\n\t\t\t{\n\t\t\t\treturn result;\n\t\t\t}\n\t\t}\n\n\t\tif (typeof window.BX.LiveChatCookie === 'undefined')\n\t\t{\n\t\t\twindow.BX.LiveChatCookie = {};\n\t\t}\n\n\t\treturn window.BX.LiveChatCookie[cookieName];\n\t},\n\tset(siteId, name, value, options)\n\t{\n\t\toptions = options || {};\n\n\t\tlet expires = options.expires;\n\t\tif (typeof(expires) == \"number\" && expires)\n\t\t{\n\t\t\tlet currentDate = new Date();\n\t\t\tcurrentDate.setTime(currentDate.getTime() + expires * 1000);\n\t\t\texpires = options.expires = currentDate;\n\t\t}\n\n\t\tif (expires && expires.toUTCString)\n\t\t{\n\t\t\toptions.expires = expires.toUTCString();\n\t\t}\n\n\t\tvalue = encodeURIComponent(value);\n\n\t\tlet cookieName = siteId? siteId+'_'+name: name;\n\t\tlet updatedCookie = cookieName + \"=\" + value;\n\n\t\tfor (let propertyName in options)\n\t\t{\n\t\t\tif (!options.hasOwnProperty(propertyName))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tupdatedCookie += \"; \" + propertyName;\n\n\t\t\tlet propertyValue = options[propertyName];\n\t\t\tif (propertyValue !== true)\n\t\t\t{\n\t\t\t\tupdatedCookie += \"=\" + propertyValue;\n\t\t\t}\n\t\t}\n\n\t\tdocument.cookie = updatedCookie;\n\n\t\tif (typeof window.BX.LiveChatCookie === 'undefined')\n\t\t{\n\t\t\tBX.LiveChatCookie = {};\n\t\t}\n\n\t\twindow.BX.LiveChatCookie[cookieName] = value;\n\t\tLocalStorage.set(siteId, 0, name, value);\n\n\t\treturn true;\n\t}\n};","/**\n * Bitrix OpenLines widget\n * Widget model (Vuex Builder model)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {VuexBuilderModel} from 'ui.vue.vuex';\n\nimport {Utils} from 'im.utils';\nimport {Cookie} from './utils/cookie';\nimport {FormType, LocationStyle, LocationType, VoteType} from \"./const\";\n\nexport class WidgetModel extends VuexBuilderModel\n{\n\t/**\n\t * @inheritDoc\n\t */\n\tgetName()\n\t{\n\t\treturn 'widget';\n\t}\n\n\tgetState()\n\t{\n\t\treturn {\n\t\t\tcommon:\n\t\t\t{\n\t\t\t\tconfigId: 0,\n\t\t\t\tconfigName: '',\n\t\t\t\thost: this.getVariable('common.host', location.protocol+'//'+location.host),\n\t\t\t\tpageMode: this.getVariable('common.pageMode', false),\n\t\t\t\tcopyright: this.getVariable('common.copyright', true),\n\t\t\t\tcopyrightUrl: this.getVariable('common.copyrightUrl', 'https://bitrix24.com'),\n\t\t\t\tlocation: this.getVariable('common.location', LocationType.bottomRight),\n\t\t\t\tstyles: {\n\t\t\t\t\tbackgroundColor: this.getVariable('styles.backgroundColor', '#17a3ea'),\n\t\t\t\t\ticonColor: this.getVariable('styles.iconColor', '#ffffff')\n\t\t\t\t},\n\t\t\t\tvote: {\n\t\t\t\t\tenable: false,\n\t\t\t\t\tbeforeFinish: true,\n\t\t\t\t\tmessageText: this.getVariable('vote.messageText', ''),\n\t\t\t\t\tmessageLike: this.getVariable('vote.messageLike', ''),\n\t\t\t\t\tmessageDislike: this.getVariable('vote.messageDislike', '')\n\t\t\t\t},\n\t\t\t\ttextMessages: {\n\t\t\t\t\tbxLivechatOnlineLine1: this.getVariable('textMessages.bxLivechatOnlineLine1', ''),\n\t\t\t\t\tbxLivechatOnlineLine2: this.getVariable('textMessages.bxLivechatOnlineLine2', ''),\n\t\t\t\t\tbxLivechatOffline: this.getVariable('textMessages.bxLivechatOffline', '')\n\t\t\t\t},\n\t\t\t\tonline: false,\n\t\t\t\toperators: [],\n\t\t\t\tconnectors: [],\n\t\t\t\tshowForm: FormType.none,\n\t\t\t\tshowed: false,\n\t\t\t\treopen: false,\n\t\t\t\tdragged: false,\n\t\t\t\ttextareaHeight: 0,\n\t\t\t\tshowConsent: false,\n\t\t\t\tconsentUrl: '',\n\t\t\t\tdialogStart: false,\n\t\t\t},\n\t\t\tdialog:\n\t\t\t{\n\t\t\t\tsessionId: 0,\n\t\t\t\tsessionClose: true,\n\t\t\t\tsessionStatus: 0,\n\t\t\t\tuserVote: VoteType.none,\n\t\t\t\tuserConsent: false,\n\t\t\t\toperator: {\n\t\t\t\t\tname: '',\n\t\t\t\t\tfirstName: '',\n\t\t\t\t\tlastName: '',\n\t\t\t\t\tworkPosition: '',\n\t\t\t\t\tavatar: '',\n\t\t\t\t\tonline: false,\n\t\t\t\t}\n\t\t\t},\n\t\t\tuser:\n\t\t\t{\n\t\t\t\tid: -1,\n\t\t\t\thash: '',\n\t\t\t\tname: '',\n\t\t\t\tfirstName: '',\n\t\t\t\tlastName: '',\n\t\t\t\tavatar: '',\n\t\t\t\temail: '',\n\t\t\t\tphone: '',\n\t\t\t\twww: '',\n\t\t\t\tgender: 'M',\n\t\t\t\tposition: '',\n\t\t\t},\n\t\t}\n\t}\n\n\tgetStateSaveException()\n\t{\n\t\treturn {\n\t\t\tcommon: {\n\t\t\t\thost: null,\n\t\t\t\tpageMode: null,\n\t\t\t\tcopyright: null,\n\t\t\t\tcopyrightUrl: null,\n\t\t\t\tstyles: null,\n\t\t\t\tdragged: null,\n\t\t\t\tshowed: null,\n\t\t\t\tshowConsent: null,\n\t\t\t\tshowForm: null,\n\t\t\t\tlocation: null,\n\t\t\t},\n\t\t}\n\t}\n\n\tgetMutations()\n\t{\n\t\treturn {\n\n\t\t\tcommon: (state, payload) =>\n\t\t\t{\n\t\t\t\tif (typeof payload.configId === 'number')\n\t\t\t\t{\n\t\t\t\t\tstate.common.configId = payload.configId;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.configName === 'string')\n\t\t\t\t{\n\t\t\t\t\tstate.common.configName = payload.configName;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.online === 'boolean')\n\t\t\t\t{\n\t\t\t\t\tstate.common.online = payload.online;\n\t\t\t\t}\n\t\t\t\tif (Utils.types.isPlainObject(payload.vote))\n\t\t\t\t{\n\t\t\t\t\tif (typeof payload.vote.enable === 'boolean')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.common.vote.enable = payload.vote.enable;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.vote.beforeFinish === 'boolean')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.common.vote.beforeFinish = payload.vote.beforeFinish;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.vote.messageText === 'string')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.common.vote.messageText = payload.vote.messageText;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.vote.messageLike === 'string')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.common.vote.messageLike = payload.vote.messageLike;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.vote.messageDislike === 'string')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.common.vote.messageDislike = payload.vote.messageDislike;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (Utils.types.isPlainObject(payload.textMessages))\n\t\t\t\t{\n\t\t\t\t\tif (typeof payload.textMessages.bxLivechatOnlineLine1 === 'string' && payload.textMessages.bxLivechatOnlineLine1 !== '')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.common.textMessages.bxLivechatOnlineLine1 = payload.textMessages.bxLivechatOnlineLine1;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.textMessages.bxLivechatOnlineLine2 === 'string' && payload.textMessages.bxLivechatOnlineLine2 !== '')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.common.textMessages.bxLivechatOnlineLine2 = payload.textMessages.bxLivechatOnlineLine2;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.textMessages.bxLivechatOffline === 'string' && payload.textMessages.bxLivechatOffline !== '')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.common.textMessages.bxLivechatOffline = payload.textMessages.bxLivechatOffline;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (typeof payload.dragged === 'boolean')\n\t\t\t\t{\n\t\t\t\t\tstate.common.dragged = payload.dragged;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.textareaHeight === 'number')\n\t\t\t\t{\n\t\t\t\t\tstate.common.textareaHeight = payload.textareaHeight;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.showConsent === 'boolean')\n\t\t\t\t{\n\t\t\t\t\tstate.common.showConsent = payload.showConsent;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.consentUrl === 'string')\n\t\t\t\t{\n\t\t\t\t\tstate.common.consentUrl = payload.consentUrl;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.showed === 'boolean')\n\t\t\t\t{\n\t\t\t\t\tstate.common.showed = payload.showed;\n\t\t\t\t\tpayload.reopen = Utils.device.isMobile()? false: payload.showed;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.reopen === 'boolean')\n\t\t\t\t{\n\t\t\t\t\tstate.common.reopen = payload.reopen;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.copyright === 'boolean')\n\t\t\t\t{\n\t\t\t\t\tstate.common.copyright = payload.copyright;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.dialogStart === 'boolean')\n\t\t\t\t{\n\t\t\t\t\tstate.common.dialogStart = payload.dialogStart;\n\t\t\t\t}\n\t\t\t\tif (payload.operators instanceof Array)\n\t\t\t\t{\n\t\t\t\t\tstate.common.operators = payload.operators;\n\t\t\t\t}\n\t\t\t\tif (payload.connectors instanceof Array)\n\t\t\t\t{\n\t\t\t\t\tstate.common.connectors = payload.connectors;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.showForm === 'string' && typeof FormType[payload.showForm] !== 'undefined')\n\t\t\t\t{\n\t\t\t\t\tstate.common.showForm = payload.showForm;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.location === 'number' && typeof LocationStyle[payload.location] !== 'undefined')\n\t\t\t\t{\n\t\t\t\t\tstate.common.location = payload.location;\n\t\t\t\t}\n\n\t\t\t\tif (this.isSaveNeeded({common: payload}))\n\t\t\t\t{\n\t\t\t\t\tthis.saveState(state);\n\t\t\t\t}\n\t\t\t},\n\t\t\tdialog: (state, payload) =>\n\t\t\t{\n\t\t\t\tif (typeof payload.sessionId === 'number')\n\t\t\t\t{\n\t\t\t\t\tstate.dialog.sessionId = payload.sessionId;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.sessionClose === 'boolean')\n\t\t\t\t{\n\t\t\t\t\tstate.dialog.sessionClose = payload.sessionClose;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.sessionStatus === 'number')\n\t\t\t\t{\n\t\t\t\t\tstate.dialog.sessionStatus = payload.sessionStatus;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.userConsent === 'boolean')\n\t\t\t\t{\n\t\t\t\t\tstate.dialog.userConsent = payload.userConsent;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.userVote === 'string' && typeof payload.userVote !== 'undefined')\n\t\t\t\t{\n\t\t\t\t\tstate.dialog.userVote = payload.userVote;\n\t\t\t\t}\n\t\t\t\tif (Utils.types.isPlainObject(payload.operator))\n\t\t\t\t{\n\t\t\t\t\tif (typeof payload.operator.name === 'string' || typeof payload.operator.name === 'number')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.dialog.operator.name = payload.operator.name.toString();\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.operator.lastName === 'string' || typeof payload.operator.lastName === 'number')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.dialog.operator.lastName = payload.operator.lastName.toString();\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.operator.firstName === 'string' || typeof payload.operator.firstName === 'number')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.dialog.operator.firstName = payload.operator.firstName.toString();\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.operator.workPosition === 'string' || typeof payload.operator.workPosition === 'number')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.dialog.operator.workPosition = payload.operator.workPosition.toString();\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.operator.avatar === 'string')\n\t\t\t\t\t{\n\t\t\t\t\t\tif (!payload.operator.avatar || payload.operator.avatar.startsWith('http'))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tstate.dialog.operator.avatar = payload.operator.avatar;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tstate.dialog.operator.avatar = state.common.host+payload.operator.avatar;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.operator.online === 'boolean')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.dialog.operator.online = payload.operator.online;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (this.isSaveNeeded({dialog: payload}))\n\t\t\t\t{\n\t\t\t\t\tthis.saveState(state);\n\t\t\t\t}\n\t\t\t},\n\t\t\tuser: (state, payload) =>\n\t\t\t{\n\t\t\t\tif (typeof payload.id === 'number')\n\t\t\t\t{\n\t\t\t\t\tstate.user.id = payload.id;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.hash === 'string' && payload.hash !== state.user.hash)\n\t\t\t\t{\n\t\t\t\t\tstate.user.hash = payload.hash;\n\t\t\t\t\tCookie.set(null, 'LIVECHAT_HASH', payload.hash, {expires: 365*86400, path: '/'});\n\t\t\t\t}\n\t\t\t\tif (typeof payload.name === 'string' || typeof payload.name === 'number')\n\t\t\t\t{\n\t\t\t\t\tstate.user.name = payload.name.toString();\n\t\t\t\t}\n\t\t\t\tif (typeof payload.firstName === 'string' || typeof payload.firstName === 'number')\n\t\t\t\t{\n\t\t\t\t\tstate.user.firstName = payload.firstName.toString();\n\t\t\t\t}\n\t\t\t\tif (typeof payload.lastName === 'string' || typeof payload.lastName === 'number')\n\t\t\t\t{\n\t\t\t\t\tstate.user.lastName = payload.lastName.toString();\n\t\t\t\t}\n\t\t\t\tif (typeof payload.avatar === 'string')\n\t\t\t\t{\n\t\t\t\t\tstate.user.avatar = payload.avatar;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.email === 'string')\n\t\t\t\t{\n\t\t\t\t\tstate.user.email = payload.email;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.phone === 'string' || typeof payload.phone === 'number')\n\t\t\t\t{\n\t\t\t\t\tstate.user.phone = payload.phone.toString();\n\t\t\t\t}\n\t\t\t\tif (typeof payload.www === 'string')\n\t\t\t\t{\n\t\t\t\t\tstate.user.www = payload.www;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.gender === 'string')\n\t\t\t\t{\n\t\t\t\t\tstate.user.gender = payload.gender;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.position === 'string')\n\t\t\t\t{\n\t\t\t\t\tstate.user.position = payload.position;\n\t\t\t\t}\n\n\t\t\t\tif (this.isSaveNeeded({user: payload}))\n\t\t\t\t{\n\t\t\t\t\tthis.saveState(state);\n\t\t\t\t}\n\t\t\t},\n\t\t}\n\t}\n}","/**\n * Bitrix OpenLines widget\n * Rest client (base on BX.RestClient)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\n// TODO change BX.RestClient, BX.promise to import\n\nimport {Utils} from \"im.utils\";\nimport {RestAuth, RestMethod} from \"../const\";\nimport {RestClient} from \"rest.client\";\n\nexport class WidgetRestClient\n{\n\tconstructor(params)\n\t{\n\t\tthis.queryAuthRestore = false;\n\n\t\tthis.setAuthId(RestAuth.guest);\n\n\t\tthis.restClient = new RestClient({\n\t\t\tendpoint: params.endpoint,\n\t\t\tqueryParams: this.queryParams,\n\t\t\tcors: true\n\t\t});\n\t}\n\n\tsetAuthId(authId, customAuthId = '')\n\t{\n\t\tif (typeof this.queryParams !== 'object')\n\t\t{\n\t\t\tthis.queryParams = {};\n\t\t}\n\n\t\tif (\n\t\t\tauthId == RestAuth.guest\n\t\t\t|| typeof authId === 'string' && authId.match(/^[a-f0-9]{32}$/)\n\t\t)\n\t\t{\n\t\t\tthis.queryParams.livechat_auth_id = authId;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconsole.error(`%LiveChatRestClient.setAuthId: auth is not correct (%c${authId}%c)`, \"color: black;\", \"font-weight: bold; color: red\", \"color: black\");\n\t\t\treturn false;\n\t\t}\n\n\t\tif (\n\t\t\tauthId == RestAuth.guest\n\t\t\t&& typeof customAuthId === 'string' && customAuthId.match(/^[a-f0-9]{32}$/)\n\t\t)\n\t\t{\n\t\t\tthis.queryParams.livechat_custom_auth_id = customAuthId;\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tgetAuthId()\n\t{\n\t\tif (typeof this.queryParams !== 'object')\n\t\t{\n\t\t\tthis.queryParams = {};\n\t\t}\n\n\t\treturn this.queryParams.livechat_auth_id || null;\n\t}\n\n\tcallMethod(method, params, callback, sendCallback, logTag = null)\n\t{\n\t\tif (!logTag)\n\t\t{\n\t\t\tlogTag = Utils.getLogTrackingParams({\n\t\t\t\tname: method,\n\t\t\t});\n\t\t}\n\n\t\tconst promise = new BX.Promise();\n\n\t\tthis.restClient.callMethod(method, params, null, sendCallback, logTag).then(result => {\n\n\t\t\tthis.queryAuthRestore = false;\n\t\t\tpromise.fulfill(result);\n\n\t\t}).catch(result => {\n\n\t\t\tlet error = result.error();\n\t\t\tif (error.ex.error == 'LIVECHAT_AUTH_WIDGET_USER')\n\t\t\t{\n\t\t\t\tthis.setAuthId(error.ex.hash);\n\n\t\t\t\tif (method === RestMethod.widgetUserRegister)\n\t\t\t\t{\n\t\t\t\t\tconsole.warn(`BX.LiveChatRestClient: ${error.ex.error_description} (${error.ex.error})`);\n\n\t\t\t\t\tthis.queryAuthRestore = false;\n\t\t\t\t\tpromise.reject(result);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tif (!this.queryAuthRestore)\n\t\t\t\t{\n\t\t\t\t\tconsole.warn('BX.LiveChatRestClient: your auth-token has expired, send query with a new token');\n\n\t\t\t\t\tthis.queryAuthRestore = true;\n\t\t\t\t\tthis.restClient.callMethod(method, params, null, sendCallback, logTag).then(result => {\n\t\t\t\t\t\tthis.queryAuthRestore = false;\n\t\t\t\t\t\tpromise.fulfill(result);\n\t\t\t\t\t}).catch(result => {\n\t\t\t\t\t\tthis.queryAuthRestore = false;\n\t\t\t\t\t\tpromise.reject(result);\n\t\t\t\t\t});\n\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.queryAuthRestore = false;\n\t\t\tpromise.reject(result);\n\t\t});\n\n\t\treturn promise;\n\t};\n\n\tcallBatch(calls, callback, bHaltOnError, sendCallback, logTag)\n\t{\n\t\tlet resultCallback = (result) =>\n\t\t{\n\t\t\tlet error = null;\n\t\t\tfor (let method in calls)\n\t\t\t{\n\t\t\t\tif (!calls.hasOwnProperty(method))\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tlet error = result[method].error();\n\t\t\t\tif (error && error.ex.error == 'LIVECHAT_AUTH_WIDGET_USER')\n\t\t\t\t{\n\t\t\t\t\tthis.setAuthId(error.ex.hash);\n\t\t\t\t\tif (method === RestMethod.widgetUserRegister)\n\t\t\t\t\t{\n\t\t\t\t\t\tconsole.warn(`BX.LiveChatRestClient: ${error.ex.error_description} (${error.ex.error})`);\n\n\t\t\t\t\t\tthis.queryAuthRestore = false;\n\t\t\t\t\t\tcallback(result);\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!this.queryAuthRestore)\n\t\t\t\t\t{\n\t\t\t\t\t\tconsole.warn('BX.LiveChatRestClient: your auth-token has expired, send query with a new token');\n\n\t\t\t\t\t\tthis.queryAuthRestore = true;\n\t\t\t\t\t\tthis.restClient.callBatch(calls, callback, bHaltOnError, sendCallback, logTag);\n\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.queryAuthRestore = false;\n\t\t\tcallback(result);\n\n\t\t\treturn true;\n\t\t};\n\n\t\treturn this.restClient.callBatch(calls, resultCallback, bHaltOnError, sendCallback, logTag);\n\t};\n}","/**\n * Bitrix OpenLines widget\n * Widget Rest answers (Rest Answer Handler)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {BaseRestAnswerHandler} from \"im.provider.rest\";\nimport {LocalStorage} from \"im.tools.localstorage\";\nimport {SubscriptionType} from \"./const\";\n\nclass WidgetRestAnswerHandler extends BaseRestAnswerHandler\n{\n\tconstructor(props = {})\n\t{\n\t\tsuper(props);\n\n\t\tthis.widget = props.widget;\n\t}\n\n\thandleImopenlinesWidgetConfigGetSuccess(data)\n\t{\n\t\tthis.store.commit('widget/common', {\n\t\t\tconfigId: data.configId,\n\t\t\tconfigName: data.configName,\n\t\t\tvote: data.vote,\n\t\t\ttextMessages: data.textMessages,\n\t\t\toperators: data.operators || [],\n\t\t\tonline: data.online,\n\t\t\tconsentUrl: data.consentUrl,\n\t\t\tconnectors: data.connectors || [],\n\t\t});\n\n\t\tthis.store.commit('application/set', {disk: data.disk});\n\n\t\tthis.widget.addLocalize(data.serverVariables);\n\t\tLocalStorage.set(this.widget.getSiteId(), 0, 'serverVariables', data.serverVariables || {});\n\t}\n\n\thandleImopenlinesWidgetUserRegisterSuccess(data)\n\t{\n\t\tthis.widget.restClient.setAuthId(data.hash);\n\n\t\tlet previousData = [];\n\t\tif (typeof this.store.state.messages.collection[this.controller.getChatId()] !== 'undefined')\n\t\t{\n\t\t\tpreviousData = this.store.state.messages.collection[this.controller.getChatId()];\n\t\t}\n\t\tthis.store.commit('messages/initCollection', {chatId: data.chatId, messages: previousData});\n\n\t\tthis.store.commit('dialogues/initCollection', {dialogId: data.dialogId, fields: {\n\t\t\tentityType: 'LIVECHAT',\n\t\t\ttype: 'livechat'\n\t\t}});\n\n\t\tthis.store.commit('application/set', {dialog: {\n\t\t\tchatId: data.chatId,\n\t\t\tdialogId: 'chat'+data.chatId\n\t\t}});\n\t}\n\n\thandleImopenlinesWidgetUserGetSuccess(data)\n\t{\n\t\tthis.store.commit('widget/user', {\n\t\t\tid: data.id,\n\t\t\thash: data.hash,\n\t\t\tname: data.name,\n\t\t\tfirstName: data.firstName,\n\t\t\tlastName: data.lastName,\n\t\t\tphone: data.phone,\n\t\t\tavatar: data.avatar,\n\t\t\temail: data.email,\n\t\t\twww: data.www,\n\t\t\tgender: data.gender,\n\t\t\tposition: data.position,\n\t\t});\n\t\tthis.store.dispatch('users/set', [{\n\t\t\tid: data.id,\n\t\t\tname: data.name,\n\t\t\tfirstName: data.firstName,\n\t\t\tlastName: data.lastName,\n\t\t\tavatar: data.avatar,\n\t\t\tgender: data.gender,\n\t\t\tworkPosition: data.position,\n\t\t}]);\n\t\tthis.store.commit('application/set', {common: {\n\t\t\tuserId: data.id\n\t\t}});\n\t}\n\n\thandleImopenlinesWidgetDialogGetSuccess(data)\n\t{\n\t\tthis.store.commit('messages/initCollection', {chatId: data.chatId});\n\n\t\tthis.store.commit('widget/dialog', data);\n\n\n\t\tthis.store.commit('application/set', {dialog: {\n\t\t\tchatId: data.chatId,\n\t\t\tdialogId: 'chat'+data.chatId,\n\t\t\tdiskFolderId: data.diskFolderId,\n\t\t}});\n\t}\n\n\thandleImDialogMessagesGetSuccess(data)\n\t{\n\t\tif (data.messages && data.messages.length > 0 && !this.widget.isDialogStart())\n\t\t{\n\t\t\tthis.store.commit('widget/common', {\n\t\t\t\tdialogStart:true\n\t\t\t});\n\t\t}\n\t}\n\n\thandleImMessageAddSuccess(messageId, message)\n\t{\n\t\tthis.widget.messagesQueue = this.widget.messagesQueue.filter(el => el.id != message.id);\n\n\t\tthis.widget.sendEvent({\n\t\t\ttype: SubscriptionType.userMessage,\n\t\t\tdata: {\n\t\t\t\tid: messageId,\n\t\t\t\ttext: message.text\n\t\t\t}\n\t\t});\n\t}\n\n\thandleImMessageAddError(error, message)\n\t{\n\t\tthis.widget.messagesQueue = this.widget.messagesQueue.filter(el => el.id != message.id);\n\t}\n\n\thandleImDiskFileCommitSuccess(result, message)\n\t{\n\t\tthis.widget.messagesQueue = this.widget.messagesQueue.filter(el => el.id != message.id);\n\n\t\tthis.widget.sendEvent({\n\t\t\ttype: SubscriptionType.userFile,\n\t\t\tdata: {}\n\t\t});\n\t}\n}\n\nexport {WidgetRestAnswerHandler};","/**\n * Bitrix OpenLines widget\n * Widget pull commands (Pull Command Handler)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {SubscriptionType, VoteType} from \"./const\";\n\nclass WidgetImPullCommandHandler\n{\n\tstatic create(params = {})\n\t{\n\t\treturn new this(params);\n\t}\n\n\tgetModuleId()\n\t{\n\t\treturn 'im';\n\t}\n\n\tconstructor(params)\n\t{\n\t\tthis.controller = params.controller;\n\t\tthis.store = params.store;\n\t\tthis.widget = params.widget;\n\t}\n\n\thandleMessageChat(params, extra, command)\n\t{\n\t\tif (params.message.senderId != this.controller.getUserId())\n\t\t{\n\t\t\tthis.widget.sendEvent({\n\t\t\t\ttype: SubscriptionType.operatorMessage,\n\t\t\t\tdata: params\n\t\t\t});\n\n\t\t\tif (!this.store.state.widget.common.showed && !this.widget.onceShowed)\n\t\t\t{\n\t\t\t\tthis.widget.onceShowed = true;\n\t\t\t\tthis.widget.open();\n\t\t\t}\n\t\t}\n\t}\n}\n\nclass WidgetImopenlinesPullCommandHandler\n{\n\tstatic create(params = {})\n\t{\n\t\treturn new this(params);\n\t}\n\n\tconstructor(params = {})\n\t{\n\t\tthis.controller = params.controller;\n\t\tthis.store = params.store;\n\t\tthis.widget = params.widget;\n\t}\n\n\tgetModuleId()\n\t{\n\t\treturn 'imopenlines';\n\t}\n\n\thandleSessionStart(params, extra, command)\n\t{\n\t\tthis.store.commit('widget/dialog', {\n\t\t\tsessionId: params.sessionId,\n\t\t\tsessionClose: false,\n\t\t\tsessionStatus: 0,\n\t\t\tuserVote: VoteType.none,\n\t\t});\n\n\t\tthis.widget.sendEvent({\n\t\t\ttype: SubscriptionType.sessionStart,\n\t\t\tdata: {\n\t\t\t\tsessionId: params.sessionId\n\t\t\t}\n\t\t});\n\t}\n\n\thandleSessionOperatorChange(params, extra, command)\n\t{\n\t\tthis.store.commit('widget/dialog', {\n\t\t\toperator: params.operator\n\t\t});\n\n\t\tthis.widget.sendEvent({\n\t\t\ttype: SubscriptionType.sessionOperatorChange,\n\t\t\tdata: {\n\t\t\t\toperator: params.operator\n\t\t\t}\n\t\t});\n\t}\n\n\thandleSessionStatus(params, extra, command)\n\t{\n\t\tthis.store.commit('widget/dialog', {\n\t\t\tsessionId: params.sessionId,\n\t\t\tsessionStatus: params.sessionStatus,\n\t\t\tsessionClose: true,\n\t\t});\n\n\t\tthis.widget.sendEvent({\n\t\t\ttype: SubscriptionType.sessionStatus,\n\t\t\tdata: {\n\t\t\t\tsessionId: params.sessionId,\n\t\t\t\tsessionStatus: params.sessionStatus\n\t\t\t}\n\t\t});\n\t}\n\n\thandleSessionFinish(params, extra, command)\n\t{\n\t\tthis.store.commit('widget/dialog', {\n\t\t\tsessionId: params.sessionId,\n\t\t\tsessionStatus: params.sessionStatus,\n\t\t\tsessionClose: true,\n\t\t});\n\n\t\tthis.widget.sendEvent({\n\t\t\ttype: SubscriptionType.sessionFinish,\n\t\t\tdata: {\n\t\t\t\tsessionId: params.sessionId,\n\t\t\t\tsessionStatus: params.sessionStatus\n\t\t\t}\n\t\t});\n\n\t\tif (!params.spam)\n\t\t{\n\t\t\tthis.store.commit('widget/dialog', {\n\t\t\t\toperator: {\n\t\t\t\t\tname: '',\n\t\t\t\t\tfirstName: '',\n\t\t\t\t\tlastName: '',\n\t\t\t\t\tworkPosition: '',\n\t\t\t\t\tavatar: '',\n\t\t\t\t\tonline: false,\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n}\n\nexport {\n\tWidgetImPullCommandHandler,\n\tWidgetImopenlinesPullCommandHandler,\n};","/**\n * Bitrix OpenLines widget\n * Widget private interface (base class)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\n// widget files\nimport {\n\tVoteType,\n\tLocationStyle,\n\tSubscriptionType,\n\tSubscriptionTypeCheck,\n\tRestMethod,\n\tRestAuth,\n} from \"./const\";\n\nimport {WidgetModel} from \"./model\";\nimport {WidgetRestClient} from \"./utils/restclient\"\nimport {WidgetRestAnswerHandler} from \"./rest.handler\";\nimport {WidgetImPullCommandHandler, WidgetImopenlinesPullCommandHandler} from \"./pull.handler\";\n\n// main\nimport {md5} from \"main.md5\";\nimport \"main.date\";\n\n// pull\nimport {PullClient} from \"pull.client\";\n\n// ui\nimport {Vue} from \"ui.vue\";\nimport {VuexBuilder} from \"ui.vue.vuex\";\nimport {Cookie} from \"./utils/cookie\";\n\n// messenger files\nimport {ApplicationModel, MessagesModel, DialoguesModel, UsersModel, FilesModel} from 'im.model';\nimport {ApplicationController} from 'im.controller';\nimport {\n\tDeviceType,\n\tDeviceOrientation,\n\tRestMethod as ImRestMethod,\n\tRestMethodHandler as ImRestMethodHandler,\n\tEventType,\n\tFileStatus\n} from 'im.const';\nimport {Utils} from \"im.utils\";\nimport {LocalStorage} from \"im.tools.localstorage\";\nimport {ImRestAnswerHandler} from \"im.provider.rest\";\nimport {ImPullCommandHandler} from \"im.provider.pull\";\nimport {Logger} from \"im.tools.logger\";\n\n// TODO change BX.Promise, BX.Main.Date to IMPORT\n\nexport class Widget\n{\n/* region 01. Initialize and store data */\n\n\tconstructor(params = {})\n\t{\n\t\tthis.ready = true;\n\t\tthis.widgetDataRequested = false;\n\n\t\tthis.offline = false;\n\n\t\tthis.code = params.code || '';\n\t\tthis.host = params.host || '';\n\t\tthis.language = params.language || 'en';\n\t\tthis.copyright = params.copyright !== false;\n\t\tthis.copyrightUrl = this.copyright && params.copyrightUrl? params.copyrightUrl: '';\n\t\tthis.buttonInstance = typeof params.buttonInstance === 'object' && params.buttonInstance !== null? params.buttonInstance: null;\n\n\t\tthis.pageMode = typeof params.pageMode === 'object' && params.pageMode;\n\t\tif (this.pageMode)\n\t\t{\n\t\t\tthis.pageMode.useBitrixLocalize = params.pageMode.useBitrixLocalize === true;\n\t\t\tthis.pageMode.placeholder = document.getElementById(params.pageMode.placeholder);\n\t\t}\n\n\t\tif (typeof this.code === 'string')\n\t\t{\n\t\t\tif (this.code.length <= 0)\n\t\t\t{\n\t\t\t\tconsole.warn(`%cLiveChatWidget.constructor: code is not correct (%c${this.code}%c)`, \"color: black;\", \"font-weight: bold; color: red\", \"color: black\");\n\t\t\t\tthis.ready = false;\n\t\t\t}\n\t\t}\n\n\t\tif (typeof this.host === 'string')\n\t\t{\n\t\t\tif (this.host.length <= 0 || !this.host.startsWith('http'))\n\t\t\t{\n\t\t\t\tconsole.warn(`%cLiveChatWidget.constructor: host is not correct (%c${this.host}%c)`, \"color: black;\", \"font-weight: bold; color: red\", \"color: black\");\n\t\t\t\tthis.ready = false;\n\t\t\t}\n\t\t}\n\n\t\tthis.inited = false;\n\t\tthis.initEventFired = false;\n\n\t\tthis.restClient = null;\n\n\t\tthis.userRegisterData = {};\n\t\tthis.customData = [];\n\n\t\tthis.localize = this.pageMode && this.pageMode.useBitrixLocalize? window.BX.message: {};\n\t\tif (typeof params.localize === 'object')\n\t\t{\n\t\t\tthis.addLocalize(params.localize);\n\t\t}\n\n\t\tthis.subscribers = {};\n\t\tthis.dateFormat = null;\n\n\t\tthis.messagesQueue = [];\n\n\t\tthis.configRequestXhr = null;\n\n\t\tif (this.pageMode && this.pageMode.placeholder)\n\t\t{\n\t\t\tthis.rootNode = this.pageMode.placeholder;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.rootNode = document.createElement('div');\n\t\t\tif (document.body.firstChild)\n\t\t\t{\n\t\t\t\tdocument.body.insertBefore(this.rootNode, document.body.firstChild);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tdocument.body.appendChild(this.rootNode);\n\t\t\t}\n\t\t}\n\n\t\tthis.template = null;\n\n\t\twindow.addEventListener('orientationchange', () =>\n\t\t{\n\t\t\tif (!this.store)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.store.commit('application/set', {device: {\n\t\t\t\torientation: Utils.device.getOrientation()\n\t\t\t}});\n\n\t\t\tif (\n\t\t\t\tthis.store.state.widget.common.showed\n\t\t\t\t&& this.store.state.application.device.type === DeviceType.mobile\n\t\t\t\t&& this.store.state.application.device.orientation === DeviceOrientation.horizontal\n\t\t\t)\n\t\t\t{\n\t\t\t\tdocument.activeElement.blur();\n\t\t\t}\n\t\t});\n\n\t\tlet serverVariables = LocalStorage.get(this.getSiteId(), 0, 'serverVariables', false);\n\t\tif (serverVariables)\n\t\t{\n\t\t\tthis.addLocalize(serverVariables);\n\t\t}\n\n\t\tlet widgetVariables = {\n\t\t\tcommon: {\n\t\t\t\thost: this.getHost(),\n\t\t\t\tpageMode: this.pageMode !== false,\n\t\t\t\tcopyright: this.copyright,\n\t\t\t\tcopyrightUrl: this.copyrightUrl,\n\t\t\t},\n\t\t\tvote: {\n\t\t\t\tmessageText: this.getLocalize('BX_LIVECHAT_VOTE_TITLE'),\n\t\t\t\tmessageLike: this.getLocalize('BX_LIVECHAT_VOTE_PLUS_TITLE'),\n\t\t\t\tmessageDislike: this.getLocalize('BX_LIVECHAT_VOTE_MINUS_TITLE'),\n\t\t\t},\n\t\t\ttextMessages: {\n\t\t\t\tbxLivechatOnlineLine1: this.getLocalize('BX_LIVECHAT_ONLINE_LINE_1'),\n\t\t\t\tbxLivechatOnlineLine2: this.getLocalize('BX_LIVECHAT_ONLINE_LINE_2'),\n\t\t\t\tbxLivechatOffline: this.getLocalize('BX_LIVECHAT_OFFLINE'),\n\t\t\t}\n\t\t};\n\t\tif (params.location && typeof LocationStyle[params.location] !== 'undefined')\n\t\t{\n\t\t\twidgetVariables.common.location = params.location;\n\t\t}\n\t\tif (\n\t\t\tUtils.types.isPlainObject(params.styles)\n\t\t\t&& (params.styles.backgroundColor || params.styles.iconColor)\n\t\t)\n\t\t{\n\t\t\twidgetVariables.styles = {};\n\t\t\tif (params.styles.backgroundColor)\n\t\t\t{\n\t\t\t\twidgetVariables.styles.backgroundColor = params.styles.backgroundColor;\n\t\t\t}\n\t\t\tif (params.styles.iconColor)\n\t\t\t{\n\t\t\t\twidgetVariables.styles.iconColor = params.styles.iconColor;\n\t\t\t}\n\t\t}\n\n\t\tthis.controller = new ApplicationController();\n\n\t\tlet applicationVariables = {\n\t\t\tcommon: {\n\t\t\t\thost: this.getHost(),\n\t\t\t\tsiteId: this.getSiteId(),\n\t\t\t\tlanguageId: this.language,\n\t\t\t},\n\t\t\tdevice: {\n\t\t\t\ttype: Utils.device.isMobile()? DeviceType.mobile: DeviceType.desktop,\n\t\t\t\torientation: Utils.device.getOrientation(),\n\t\t\t},\n\t\t\tdialog: {\n\t\t\t\tmessageLimit: this.controller.getDefaultMessageLimit()\n\t\t\t},\n\t\t\tsaveException: {\n\t\t\t\tcommon: {\n\t\t\t\t\thost: null,\n\t\t\t\t\tsiteId: null,\n\t\t\t\t\tlanguageId: null,\n\t\t\t\t},\n\t\t\t\tdialog: {\n\t\t\t\t\tmessageLimit: null,\n\t\t\t\t\tmessageExtraCount: null,\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tlet cacheDialogues = !Utils.browser.isIe();\n\n\t\tnew VuexBuilder()\n\t\t\t.addModel(WidgetModel.create().setVariables(widgetVariables))\n\t\t\t.addModel(ApplicationModel.create().setVariables(applicationVariables))\n\t\t\t.addModel(DialoguesModel.create().useDatabase(cacheDialogues).setVariables({host: this.host}))\n\t\t\t.addModel(MessagesModel.create().useDatabase(cacheDialogues))\n\t\t\t.addModel(FilesModel.create().useDatabase(cacheDialogues).setVariables({host: this.host, default: {name: this.getLocalize('IM_MESSENGER_MESSAGE_FILE_DELETED')}}))\n\t\t\t.addModel(UsersModel.create().useDatabase(cacheDialogues).setVariables({host: this.host, default: {name: this.getLocalize('IM_MESSENGER_MESSAGE_USER_ANONYM')}}))\n\t\t\t.setDatabaseConfig({\n\t\t\t\tname: 'imol/widget',\n\t\t\t\ttype: VuexBuilder.DatabaseType.localStorage,\n\t\t\t\tsiteId: this.getSiteId(),\n\t\t\t})\n\t\t.build(result => {\n\n\t\t\tthis.store = result.store;\n\t\t\tthis.storeCollector = result.builder;\n\n\t\t\tthis.initRestClient();\n\n\t\t\tthis.controller.setStore(this.store);\n\t\t\tthis.controller.setRestClient(this.restClient);\n\n\t\t\tthis.controller.setPrepareFilesBeforeSaveFunction(this.prepareFileData.bind(this));\n\n\t\t\tthis.imRestAnswer = ImRestAnswerHandler.create({\n\t\t\t\tstore: this.store,\n\t\t\t\tcontroller: this.controller,\n\t\t\t});\n\t\t\tthis.widgetRestAnswer = WidgetRestAnswerHandler.create({\n\t\t\t\twidget: this,\n\t\t\t\tstore: this.store,\n\t\t\t\tcontroller: this.controller,\n\t\t\t});\n\n\t\t\twindow.dispatchEvent(new CustomEvent('onBitrixLiveChat', {detail: {\n\t\t\t\twidget: this,\n\t\t\t\twidgetCode: this.code,\n\t\t\t\twidgetHost: this.host,\n\t\t\t}}));\n\n\t\t\tif (this.callStartFlag)\n\t\t\t{\n\t\t\t\tthis.start();\n\t\t\t}\n\n\t\t\tif (this.pageMode || this.callOpenFlag)\n\t\t\t{\n\t\t\t\tthis.open();\n\t\t\t}\n\t\t});\n\t}\n\n\tinitRestClient()\n\t{\n\t\tthis.restClient = new WidgetRestClient({endpoint: this.host+'/rest'});\n\n\t\tif (this.isUserRegistered())\n\t\t{\n\t\t\tthis.restClient.setAuthId(this.getUserHash());\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.restClient.setAuthId(RestAuth.guest);\n\t\t}\n\t}\n\n\trequestWidgetData()\n\t{\n\t\tif (!this.isReady())\n\t\t{\n\t\t\tconsole.error('LiveChatWidget.start: widget code or host is not specified');\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.widgetDataRequested = true;\n\t\tif (\n\t\t\t!this.isUserRegistered() && (\n\t\t\t\tthis.userRegisterData.hash\n\t\t\t\t|| this.getUserHashCookie()\n\t\t\t)\n\t\t)\n\t\t{\n\t\t\tthis.requestData();\n\t\t\tthis.inited = true;\n\t\t\tthis.fireInitEvent();\n\t\t}\n\t\telse if (this.isConfigDataLoaded() && this.isUserRegistered())\n\t\t{\n\t\t\tthis.requestData();\n\t\t\tthis.inited = true;\n\t\t\tthis.fireInitEvent();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.restClient.callMethod(RestMethod.widgetConfigGet, {code: this.code}, (xhr) => {this.configRequestXhr = xhr}).then((result) => {\n\t\t\t\tthis.configRequestXhr = null;\n\t\t\t\tthis.clearError();\n\n\t\t\t\tthis.executeRestAnswer(RestMethod.widgetConfigGet, result);\n\n\t\t\t\tif (!this.inited)\n\t\t\t\t{\n\t\t\t\t\tthis.inited = true;\n\t\t\t\t\tthis.fireInitEvent();\n\t\t\t\t}\n\t\t\t}).catch(result => {\n\t\t\t\tthis.configRequestXhr = null;\n\n\t\t\t\tthis.setError(result.error().ex.error, result.error().ex.error_description);\n\t\t\t});\n\n\t\t\tif (this.isConfigDataLoaded())\n\t\t\t{\n\t\t\t\tthis.inited = true;\n\t\t\t\tthis.fireInitEvent();\n\t\t\t}\n\t\t}\n\t}\n\n\trequestData()\n\t{\n\t\tif (this.requestDataSend)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tthis.requestDataSend = true;\n\n\t\tif (this.configRequestXhr)\n\t\t{\n\t\t\tthis.configRequestXhr.abort();\n\t\t}\n\n\t\tlet query = {\n\t\t\t[RestMethod.widgetConfigGet]: [RestMethod.widgetConfigGet, {code: this.code}]\n\t\t};\n\n\t\tif (this.isUserRegistered())\n\t\t{\n\t\t\tquery[RestMethod.widgetDialogGet] = [RestMethod.widgetDialogGet, {config_id: this.getConfigId(), trace_data: this.getCrmTraceData(), custom_data: this.getCustomData()}];\n\t\t\tquery[ImRestMethodHandler.imChatGet] = [ImRestMethod.imChatGet, {dialog_id: '$result['+RestMethod.widgetDialogGet+'][dialogId]'}];\n\t\t\tquery[ImRestMethodHandler.imDialogMessagesGetInit] = [ImRestMethod.imDialogMessagesGet, {chat_id: '$result['+RestMethod.widgetDialogGet+'][chatId]', limit: this.controller.getRequestMessageLimit(), convert_text: 'Y'}];\n\t\t}\n\t\telse\n\t\t{\n\t\t\tquery[RestMethod.widgetUserRegister] = [RestMethod.widgetUserRegister, {config_id: '$result['+RestMethod.widgetConfigGet+'][configId]', ...this.getUserRegisterFields()}];\n\t\t\tquery[ImRestMethodHandler.imChatGet] = [ImRestMethod.imChatGet, {dialog_id: '$result['+RestMethod.widgetUserRegister+'][dialogId]'}];\n\n\t\t\tif (this.userRegisterData.hash || this.getUserHashCookie())\n\t\t\t{\n\t\t\t\tquery[RestMethod.widgetDialogGet] = [RestMethod.widgetDialogGet, {config_id: '$result['+RestMethod.widgetConfigGet+'][configId]', trace_data: this.getCrmTraceData(), custom_data: this.getCustomData()}];\n\t\t\t\tquery[ImRestMethodHandler.imDialogMessagesGetInit] = [ImRestMethod.imDialogMessagesGet, {chat_id: '$result['+RestMethod.widgetDialogGet+'][chatId]', limit: this.controller.getRequestMessageLimit(), convert_text: 'Y'}];\n\t\t\t}\n\t\t\tif (this.isUserAgreeConsent())\n\t\t\t{\n\t\t\t\tquery[RestMethod.widgetUserConsentApply] = [RestMethod.widgetUserConsentApply, {config_id: '$result['+RestMethod.widgetConfigGet+'][configId]', consent_url: location.href}];\n\t\t\t}\n\t\t}\n\n\t\tquery[RestMethod.pullServerTime] = [RestMethod.pullServerTime, {}];\n\t\tquery[RestMethod.pullConfigGet] = [RestMethod.pullConfigGet, {'CACHE': 'N'}];\n\t\tquery[RestMethod.widgetUserGet] = [RestMethod.widgetUserGet, {}];\n\n\t\tthis.restClient.callBatch(query, (response) =>\n\t\t{\n\t\t\tif (!response)\n\t\t\t{\n\t\t\t\tthis.requestDataSend = false;\n\t\t\t\tthis.setError('EMPTY_RESPONSE', 'Server returned an empty response.');\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tlet configGet = response[RestMethod.widgetConfigGet];\n\t\t\tif (configGet && configGet.error())\n\t\t\t{\n\t\t\t\tthis.requestDataSend = false;\n\n\t\t\t\tthis.setError(configGet.error().ex.error, configGet.error().ex.error_description);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tthis.executeRestAnswer(RestMethod.widgetConfigGet, configGet);\n\n\t\t\tlet userGetResult = response[RestMethod.widgetUserGet];\n\t\t\tif (userGetResult.error())\n\t\t\t{\n\t\t\t\tthis.requestDataSend = false;\n\t\t\t\tthis.setError(userGetResult.error().ex.error, userGetResult.error().ex.error_description);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tthis.executeRestAnswer(RestMethod.widgetUserGet, userGetResult);\n\n\t\t\tlet chatGetResult = response[ImRestMethodHandler.imChatGet];\n\t\t\tif (chatGetResult.error())\n\t\t\t{\n\t\t\t\tthis.requestDataSend = false;\n\t\t\t\tthis.setError(chatGetResult.error().ex.error, chatGetResult.error().ex.error_description);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tthis.executeRestAnswer(ImRestMethodHandler.imChatGet, chatGetResult);\n\n\t\t\tlet dialogGetResult = response[RestMethod.widgetDialogGet];\n\t\t\tif (dialogGetResult)\n\t\t\t{\n\t\t\t\tif (dialogGetResult.error())\n\t\t\t\t{\n\t\t\t\t\tthis.requestDataSend = false;\n\t\t\t\t\tthis.setError(dialogGetResult.error().ex.error, dialogGetResult.error().ex.error_description);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tthis.executeRestAnswer(RestMethod.widgetDialogGet, dialogGetResult);\n\t\t\t}\n\n\t\t\tlet dialogMessagesGetResult = response[ImRestMethodHandler.imDialogMessagesGetInit];\n\t\t\tif (dialogMessagesGetResult)\n\t\t\t{\n\t\t\t\tif (dialogMessagesGetResult.error())\n\t\t\t\t{\n\t\t\t\t\tthis.requestDataSend = false;\n\t\t\t\t\tthis.setError(dialogMessagesGetResult.error().ex.error, dialogMessagesGetResult.error().ex.error_description);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tthis.store.dispatch('dialogues/saveDialog', {\n\t\t\t\t\tdialogId: this.controller.getDialogId(),\n\t\t\t\t\tchatId: this.controller.getChatId(),\n\t\t\t\t});\n\n\t\t\t\tthis.executeRestAnswer(ImRestMethodHandler.imDialogMessagesGetInit, dialogMessagesGetResult);\n\t\t\t}\n\n\t\t\tlet userRegisterResult = response[RestMethod.widgetUserRegister];\n\t\t\tif (userRegisterResult)\n\t\t\t{\n\t\t\t\tif (userRegisterResult.error())\n\t\t\t\t{\n\t\t\t\t\tthis.requestDataSend = false;\n\t\t\t\t\tthis.setError(userRegisterResult.error().ex.error, userRegisterResult.error().ex.error_description);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tthis.executeRestAnswer(RestMethod.widgetUserRegister, userRegisterResult);\n\t\t\t}\n\n\t\t\tlet timeShift = 0;\n\n\t\t\tlet serverTimeResult = response[RestMethod.pullServerTime];\n\t\t\tif (serverTimeResult && !serverTimeResult.error())\n\t\t\t{\n\t\t\t\ttimeShift = Math.floor(((new Date()).getTime() - new Date(serverTimeResult.data()).getTime())/1000);\n\t\t\t}\n\n\t\t\tlet config = null;\n\t\t\tlet pullConfigResult = response[RestMethod.pullConfigGet];\n\t\t\tif (pullConfigResult && !pullConfigResult.error())\n\t\t\t{\n\t\t\t\tconfig = pullConfigResult.data();\n\t\t\t\tconfig.server.timeShift = timeShift;\n\t\t\t}\n\n\t\t\tthis.startPullClient(config).then(() => {\n\t\t\t\tthis.processSendMessages();\n\t\t\t}).catch((error) => {\n\t\t\t\tthis.setError(error.ex.error, error.ex.error_description);\n\t\t\t});\n\n\t\t\tthis.requestDataSend = false;\n\t\t}, false, false, Utils.getLogTrackingParams({name: 'widget.init.config', dialog: this.controller.getDialogData()}));\n\t}\n\n\texecuteRestAnswer(command, result, extra)\n\t{\n\t\tthis.imRestAnswer.execute(command, result, extra);\n\t\tthis.widgetRestAnswer.execute(command, result, extra);\n\t}\n\n\tprepareFileData(files)\n\t{\n\t\tif (Cookie.get(null, 'BITRIX_LIVECHAT_AUTH'))\n\t\t{\n\t\t\treturn files;\n\t\t}\n\n\t\tif (!Utils.types.isArray(files))\n\t\t{\n\t\t\treturn files;\n\t\t}\n\n\t\treturn files.map(file =>\n\t\t{\n\t\t\tlet hash = (window.md5 || md5)(this.getUserId()+'|'+file.id+'|'+this.getUserHash());\n\t\t\tlet urlParam = 'livechat_auth_id='+hash+'&livechat_user_id='+this.getUserId();\n\t\t\tif (file.urlPreview)\n\t\t\t{\n\t\t\t\tfile.urlPreview = file.urlPreview+'&'+urlParam;\n\t\t\t}\n\t\t\tif (file.urlShow)\n\t\t\t{\n\t\t\t\tfile.urlShow = file.urlShow+'&'+urlParam;\n\t\t\t}\n\t\t\tif (file.urlDownload)\n\t\t\t{\n\t\t\t\tfile.urlDownload = file.urlDownload+'&'+urlParam;\n\t\t\t}\n\n\t\t\treturn file;\n\t\t});\n\t}\n\n\tcheckBrowserVersion()\n\t{\n\t\tif (Utils.platform.isIos())\n\t\t{\n\t\t\tlet version = Utils.platform.getIosVersion();\n\t\t\tif (version && version <= 10)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\treturn true;\n\t}\n\n/* endregion 01. Initialize and store data */\n\n/* region 02. Push & Pull */\n\n\tstartPullClient(config)\n\t{\n\t\tlet promise = new BX.Promise();\n\n\t\tif (this.pullClient)\n\t\t{\n\t\t\tif (!this.pullClient.isConnected())\n\t\t\t{\n\t\t\t\tthis.pullClient.scheduleReconnect();\n\t\t\t}\n\t\t\tpromise.resolve(true);\n\t\t\treturn promise;\n\t\t}\n\t\tif (!this.getUserId() || !this.getSiteId() || !this.restClient)\n\t\t{\n\t\t\tpromise.reject({\n\t\t\t\tex: { error: 'WIDGET_NOT_LOADED', error_description: 'Widget is not loaded.'}\n\t\t\t});\n\t\t\treturn promise;\n\t\t}\n\n\t\tthis.pullClient = new PullClient({\n\t\t\tserverEnabled: true,\n\t\t\tuserId: this.getUserId(),\n\t\t\tsiteId: this.getSiteId(),\n\t\t\trestClient: this.restClient,\n\t\t\tconfigTimestamp: config? config.server.config_timestamp: 0,\n\t\t\tskipCheckRevision: true,\n\t\t});\n\n\t\tthis.pullClient.subscribe(\n\t\t\tnew ImPullCommandHandler({\n\t\t\t\tstore: this.store,\n\t\t\t\tcontroller: this.controller,\n\t\t\t})\n\t\t);\n\t\tthis.pullClient.subscribe(\n\t\t\tnew WidgetImPullCommandHandler({\n\t\t\t\tstore: this.store,\n\t\t\t\tcontroller: this.controller,\n\t\t\t\twidget: this,\n\t\t\t})\n\t\t);\n\t\tthis.pullClient.subscribe(\n\t\t\tnew WidgetImopenlinesPullCommandHandler({\n\t\t\t\tstore: this.store,\n\t\t\t\tcontroller: this.controller,\n\t\t\t\twidget: this,\n\t\t\t})\n\t\t);\n\n\t\tthis.pullClient.subscribe({\n\t\t\ttype: PullClient.SubscriptionType.Status,\n\t\t\tcallback: this.eventStatusInteraction.bind(this)\n\t\t});\n\n\t\tthis.pullConnectedFirstTime = this.pullClient.subscribe({\n\t\t\ttype: PullClient.SubscriptionType.Status,\n\t\t\tcallback: (result) => {\n\t\t\t\tif (result.status === PullClient.PullStatus.Online)\n\t\t\t\t{\n\t\t\t\t\tpromise.resolve(true);\n\t\t\t\t\tthis.pullConnectedFirstTime();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tif (this.template)\n\t\t{\n\t\t\tthis.template.$root.$bitrixPullClient = this.pullClient;\n\t\t\tthis.template.$root.$emit('onBitrixPullClientInited', this.pullClient);\n\t\t}\n\n\t\tthis.pullClient.start({\n\t\t\t...config,\n\t\t\tskipReconnectToLastSession: true\n\t\t}).catch(function(){\n\t\t\tpromise.reject({\n\t\t\t\tex: { error: 'PULL_CONNECTION_ERROR', error_description: 'Pull is not connected.'}\n\t\t\t});\n\t\t});\n\n\t\treturn promise;\n\t}\n\n\tstopPullClient()\n\t{\n\t\tif (this.pullClient)\n\t\t{\n\t\t\tthis.pullClient.stop(PullClient.CloseReasons.MANUAL, 'Closed manually');\n\t\t}\n\t}\n\n\trecoverPullConnection()\n\t{\n\t\t// this.pullClient.session.mid = 0; // TODO specially for disable pull history, remove after recode im\n\t\tthis.pullClient.restart(PullClient.CloseReasons.MANUAL, 'Restart after click by connection status button.');\n\t}\n\n\teventStatusInteraction(data)\n\t{\n\t\tif (data.status === PullClient.PullStatus.Online)\n\t\t{\n\t\t\tthis.offline = false;\n\n\t\t\tif (this.pullRequestMessage)\n\t\t\t{\n\t\t\t\tthis.getDialogUnread().then(() => {\n\t\t\t\t\tthis.processSendMessages();\n\t\t\t\t});\n\t\t\t\tthis.pullRequestMessage = false;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.readMessage();\n\t\t\t\tthis.processSendMessages();\n\t\t\t}\n\t\t}\n\t\telse if (data.status === PullClient.PullStatus.Offline)\n\t\t{\n\t\t\tthis.pullRequestMessage = true;\n\t\t\tthis.offline = true;\n\t\t}\n\t}\n\n/* endregion 02. Push & Pull */\n\n/* region 03. Template engine */\n\n\tattachTemplate()\n\t{\n\t\tif (this.template)\n\t\t{\n\t\t\tthis.store.commit('widget/common', {showed: true});\n\t\t\treturn true;\n\t\t}\n\n\t\tthis.rootNode.innerHTML = '';\n\t\tthis.rootNode.appendChild(document.createElement('div'));\n\n\t\tconst widgetContext = this;\n\t\tconst controller = this.controller;\n\t\tconst restClient = this.restClient;\n\t\tconst pullClient = this.pullClient || null;\n\n\t\tthis.template = Vue.create({\n\t\t\tel: this.rootNode.firstChild,\n\t\t\tstore: this.store,\n\t\t\ttemplate: '<bx-livechat/>',\n\t\t\tbeforeCreate()\n\t\t\t{\n\t\t\t\tthis.$bitrixWidget = widgetContext;\n\t\t\t\tthis.$bitrixController = controller;\n\t\t\t\tthis.$bitrixRestClient = restClient;\n\t\t\t\tthis.$bitrixPullClient = pullClient;\n\t\t\t\tthis.$bitrixMessages = widgetContext.localize;\n\n\t\t\t\twidgetContext.sendEvent({\n\t\t\t\t\ttype: SubscriptionType.widgetOpen,\n\t\t\t\t\tdata: {}\n\t\t\t\t});\n\t\t\t},\n\t\t\tdestroyed()\n\t\t\t{\n\t\t\t\twidgetContext.sendEvent({\n\t\t\t\t\ttype: SubscriptionType.widgetClose,\n\t\t\t\t\tdata: {}\n\t\t\t\t});\n\n\t\t\t\tthis.$bitrixWidget.template = null;\n\t\t\t\tthis.$bitrixWidget.templateAttached = false;\n\t\t\t\tthis.$bitrixWidget.rootNode.innerHTML = '';\n\n\t\t\t\tthis.$bitrixWidget = null;\n\t\t\t\tthis.$bitrixRestClient = null;\n\t\t\t\tthis.$bitrixPullClient = null;\n\t\t\t\tthis.$bitrixMessages = null;\n\t\t\t}\n\t\t});\n\n\t\tthis.controller.setTemplateEngine(this.template);\n\n\t\treturn true;\n\t}\n\n\tdetachTemplate()\n\t{\n\t\tif (!this.template)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tthis.template.$destroy();\n\n\t\treturn true;\n\t}\n\n\tmutateTemplateComponent(id, params)\n\t{\n\t\treturn Vue.mutateComponent(id, params);\n\t}\n\n/* endregion 03. Template engine */\n\n/* region 04. Rest methods */\n\n\taddMessage(text = '', file = null)\n\t{\n\t\tif (!text && !file)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tLogger.warn('addMessage', text, file);\n\n\t\tif (!this.controller.isUnreadMessagesLoaded())\n\t\t{\n\t\t\tthis.sendMessage({id: 0, text, file});\n\t\t\tthis.processSendMessages();\n\n\t\t\treturn true;\n\t\t}\n\n\t\tthis.store.commit('application/increaseDialogExtraCount');\n\n\t\tlet params = {};\n\t\tif (file)\n\t\t{\n\t\t\tparams.FILE_ID = [file.id];\n\t\t}\n\n\t\tthis.store.dispatch('messages/add', {\n\t\t\tchatId: this.getChatId(),\n\t\t\tauthorId: this.getUserId(),\n\t\t\ttext: text,\n\t\t\tparams,\n\t\t\tsending: !file,\n\t\t}).then(messageId => {\n\n\t\t\tif (!this.isDialogStart())\n\t\t\t{\n\t\t\t\tthis.store.commit('widget/common', {dialogStart:true});\n\t\t\t}\n\n\t\t\tthis.messagesQueue.push({\n\t\t\t\tid: messageId,\n\t\t\t\ttext,\n\t\t\t\tfile,\n\t\t\t\tsending: false\n\t\t\t});\n\n\t\t\tif (this.getChatId())\n\t\t\t{\n\t\t\t\tthis.processSendMessages();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.requestData();\n\t\t\t}\n\t\t});\n\n\t\treturn true;\n\t}\n\n\tuploadFile(fileInput)\n\t{\n\t\tif (!fileInput)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tLogger.warn('addFile', fileInput.files[0].name, fileInput.files[0].size, fileInput.files[0]);\n\n\t\tlet file = fileInput.files[0];\n\n\t\tlet fileType = 'file';\n\t\tif (file.type.toString().startsWith('image'))\n\t\t{\n\t\t\tfileType = 'image';\n\t\t}\n\n\t\tif (!this.controller.isUnreadMessagesLoaded())\n\t\t{\n\t\t\tthis.addMessage('', {id: 0, source: fileInput});\n\t\t\treturn true;\n\t\t}\n\n\t\tthis.store.dispatch('files/add', {\n\t\t\tchatId: this.getChatId(),\n\t\t\tauthorId: this.getUserId(),\n\t\t\tname: file.name,\n\t\t\ttype: fileType,\n\t\t\textension: file.name.split('.').splice(-1)[0],\n\t\t\tsize: file.size,\n\t\t\timage: false,\n\t\t\tstatus: FileStatus.upload,\n\t\t\tprogress: 0,\n\t\t\tauthorName: this.controller.getCurrentUser().name,\n\t\t\turlPreview: \"\",\n\t\t}).then(fileId => this.addMessage('', {id: fileId, source: fileInput}));\n\n\t\treturn true;\n\t}\n\n\tcancelUploadFile(fileId)\n\t{\n\t\tlet element = this.messagesQueue.find(element => element.file && element.file.id === fileId);\n\t\tif (element)\n\t\t{\n\t\t\tif (element.xhr)\n\t\t\t{\n\t\t\t\telement.xhr.abort();\n\t\t\t}\n\t\t\tthis.store.dispatch('messages/delete', {\n\t\t\t\tchatId: this.getChatId(),\n\t\t\t\tid: element.id,\n\t\t\t}).then(() => {\n\t\t\t\tthis.store.dispatch('files/delete', {\n\t\t\t\t\tchatId: this.getChatId(),\n\t\t\t\t\tid: element.file.id,\n\t\t\t\t});\n\t\t\t\tthis.messagesQueue = this.messagesQueue.filter(el => el.id !== element.id);\n\t\t\t});\n\t\t}\n\t}\n\n\tprocessSendMessages()\n\t{\n\t\tif (this.offline)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.messagesQueue.filter(element => !element.sending).forEach(element => {\n\t\t\telement.sending = true;\n\t\t\tif (element.file)\n\t\t\t{\n\t\t\t\tthis.sendMessageWithFile(element);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.sendMessage(element);\n\t\t\t}\n\t\t});\n\n\t\treturn true;\n\t}\n\n\tsendMessage(message)\n\t{\n\t\tthis.controller.stopWriting();\n\n\t\tlet quiteId = this.store.getters['dialogues/getQuoteId'](this.getDialogId());\n\t\tif (quiteId)\n\t\t{\n\t\t\tlet quoteMessage = this.store.getters['messages/getMessage'](this.getChatId(), quiteId);\n\t\t\tif (quoteMessage)\n\t\t\t{\n\t\t\t\tlet user = this.store.getters['users/get'](quoteMessage.authorId);\n\n\t\t\t\tlet newMessage = [];\n\t\t\t\tnewMessage.push(\"------------------------------------------------------\");\n\t\t\t\tnewMessage.push((user.name? user.name: this.getLocalize('BX_LIVECHAT_SYSTEM_MESSAGE')));\n\t\t\t\tnewMessage.push(quoteMessage.text);\n\t\t\t\tnewMessage.push('------------------------------------------------------');\n\t\t\t\tnewMessage.push(message.text);\n\t\t\t\tmessage.text = newMessage.join(\"\\n\");\n\n\t\t\t\tthis.quoteMessageClear();\n\t\t\t}\n\t\t}\n\n\t\tmessage.chatId = this.getChatId();\n\n\t\tthis.restClient.callMethod(ImRestMethod.imMessageAdd, {\n\t\t\t'TEMPLATE_ID': message.id,\n\t\t\t'CHAT_ID': message.chatId,\n\t\t\t'MESSAGE': message.text\n\t\t}, null, null, Utils.getLogTrackingParams({\n\t\t\tname: ImRestMethod.imMessageAdd,\n\t\t\tdata: {timMessageType: 'text'},\n\t\t\tdialog: this.getDialogData()\n\t\t})).then(response => {\n\t\t\tthis.executeRestAnswer(ImRestMethodHandler.imMessageAdd, response, message);\n\t\t}).catch(error => {\n\t\t\tthis.executeRestAnswer(ImRestMethodHandler.imMessageAdd, error, message);\n\t\t});\n\n\t\treturn true;\n\t}\n\n\tsendMessageWithFile(message)\n\t{\n\t\tthis.controller.stopWriting();\n\n\t\tlet fileType = this.store.getters['files/get'](this.getChatId(), message.file.id, true).type;\n\n\t\tlet diskFolderId = this.getDiskFolderId();\n\n\t\tlet query = {};\n\n\t\tif (diskFolderId)\n\t\t{\n\t\t\tquery[ImRestMethodHandler.imDiskFileUpload] = [ImRestMethod.imDiskFileUpload, {\n\t\t\t\tid : diskFolderId,\n\t\t\t\tdata : {NAME : message.file.source.files[0].name},\n\t\t\t\tfileContent: message.file.source,\n\t\t\t\tgenerateUniqueName: true\n\t\t\t}];\n\t\t}\n\t\telse\n\t\t{\n\t\t\tquery[ImRestMethodHandler.imDiskFolderGet] = [ImRestMethod.imDiskFolderGet, {chat_id: this.getChatId()}];\n\t\t\tquery[ImRestMethodHandler.imDiskFileUpload] = [ImRestMethod.imDiskFileUpload, {\n\t\t\t\tid: '$result[' + ImRestMethodHandler.imDiskFolderGet + '][ID]',\n\t\t\t\tdata: {\n\t\t\t\t\tNAME: message.file.source.files[0].name\n\t\t\t\t},\n\t\t\t\tfileContent: message.file.source,\n\t\t\t\tgenerateUniqueName: true\n\t\t\t}];\n\t\t}\n\n\t\tthis.restClient.callBatch(query, (response) =>\n\t\t{\n\t\t\tif (!response)\n\t\t\t{\n\t\t\t\tthis.requestDataSend = false;\n\t\t\t\tconsole.warn('EMPTY_RESPONSE', 'Server returned an empty response. [1]');\n\t\t\t\tthis.fileError(this.getChatId, message.file.id, message.id);\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (!diskFolderId)\n\t\t\t{\n\t\t\t\tlet diskFolderGet = response[ImRestMethodHandler.imDiskFolderGet];\n\t\t\t\tif (diskFolderGet && diskFolderGet.error())\n\t\t\t\t{\n\t\t\t\t\tconsole.warn(diskFolderGet.error().ex.error, diskFolderGet.error().ex.error_description);\n\t\t\t\t\tthis.fileError(this.getChatId(), message.file.id, message.id);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tthis.executeRestAnswer(ImRestMethodHandler.imDiskFolderGet, diskFolderGet);\n\t\t\t}\n\n\t\t\tlet diskId = 0;\n\t\t\tlet diskFileUpload = response[ImRestMethodHandler.imDiskFileUpload];\n\t\t\tif (diskFileUpload)\n\t\t\t{\n\t\t\t\tlet result = diskFileUpload.data();\n\t\t\t\tif (diskFileUpload.error())\n\t\t\t\t{\n\t\t\t\t\tconsole.warn(diskFileUpload.error().ex.error, diskFileUpload.error().ex.error_description);\n\t\t\t\t\tthis.fileError(this.getChatId(), message.file.id, message.id);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\telse if (!result)\n\t\t\t\t{\n\t\t\t\t\tconsole.warn('EMPTY_RESPONSE', 'Server returned an empty response. [2]');\n\t\t\t\t\tthis.fileError(this.getChatId(), message.file.id, message.id);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tdiskId = result.ID;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconsole.warn('EMPTY_RESPONSE', 'Server returned an empty response. [3]');\n\t\t\t\tthis.fileError(this.getChatId(), message.file.id, message.id);\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tmessage.chatId = this.getChatId();\n\n\t\t\tthis.store.dispatch('files/update', {\n\t\t\t\tchatId: message.chatId,\n\t\t\t\tid: message.file.id,\n\t\t\t\tfields: {\n\t\t\t\t\tstatus: FileStatus.wait,\n\t\t\t\t\tprogress: 95\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.fileCommit({\n\t\t\t\tchatId: message.chatId,\n\t\t\t\tuploadId: diskId,\n\t\t\t\tmessageText: message.text,\n\t\t\t\tmessageId: message.id,\n\t\t\t\tfileId: message.file.id,\n\t\t\t\tfileType\n\t\t\t}, message);\n\n\t\t}, false, (xhr) => {message.xhr = xhr}, Utils.getLogTrackingParams({\n\t\t\tname: ImRestMethodHandler.imDiskFileCommit,\n\t\t\tdata: {timMessageType: fileType},\n\t\t\tdialog: this.getDialogData()\n\t\t}));\n\t}\n\n\tfileError(chatId, fileId, messageId = 0)\n\t{\n\t\tthis.store.dispatch('files/update', {\n\t\t\tchatId: chatId,\n\t\t\tid: fileId,\n\t\t\tfields: {\n\t\t\t\tstatus: FileStatus.error,\n\t\t\t\tprogress: 0\n\t\t\t}\n\t\t});\n\t\tif (messageId)\n\t\t{\n\t\t\tthis.store.dispatch('messages/actionError', {\n\t\t\t\tchatId: chatId,\n\t\t\t\tid: messageId,\n\t\t\t\tretry: false,\n\t\t\t});\n\t\t}\n\t}\n\n\tfileCommit(params, message)\n\t{\n\t\tthis.restClient.callMethod(ImRestMethod.imDiskFileCommit, {\n\t\t\tchat_id: params.chatId,\n\t\t\tupload_id: params.uploadId,\n\t\t\tmessage: params.messageText,\n\t\t\ttemplate_id: params.messageId,\n\t\t\tfile_template_id: params.fileId,\n\t\t}, null, null, Utils.getLogTrackingParams({\n\t\t\tname: ImRestMethod.imDiskFileCommit,\n\t\t\tdata: {timMessageType: params.fileType},\n\t\t\tdialog: this.getDialogData()\n\t\t})).then(response => {\n\t\t\tthis.executeRestAnswer(ImRestMethodHandler.imDiskFileCommit, response, message);\n\t\t}).catch(error => {\n\t\t\tthis.executeRestAnswer(ImRestMethodHandler.imDiskFileCommit, error, message);\n\t\t});\n\n\t\treturn true;\n\t}\n\n\tgetDialogHistory(lastId, limit = this.controller.getRequestMessageLimit())\n\t{\n\t\tthis.restClient.callMethod(ImRestMethod.imDialogMessagesGet, {\n\t\t\t'CHAT_ID': this.getChatId(),\n\t\t\t'LAST_ID': lastId,\n\t\t\t'LIMIT': limit,\n\t\t\t'CONVERT_TEXT': 'Y'\n\t\t}).then(result => {\n\t\t\tthis.executeRestAnswer(ImRestMethodHandler.imDialogMessagesGet, result);\n\t\t\tthis.template.$emit(EventType.dialog.requestHistoryResult, {count: result.data().messages.length});\n\t\t}).catch(result => {\n\t\t\tthis.template.$emit(EventType.dialog.requestHistoryResult, {error: result.error().ex});\n\t\t});\n\t}\n\n\tgetDialogUnread(lastId, limit = this.controller.getRequestMessageLimit())\n\t{\n\t\tconst promise = new BX.Promise();\n\n\t\tif (!lastId)\n\t\t{\n\t\t\tlastId = this.store.getters['messages/getLastId'](this.controller.getChatId());\n\t\t}\n\n\t\tif (!lastId)\n\t\t{\n\t\t\tthis.template.$emit(EventType.dialog.requestUnreadResult, {error: {error: 'LAST_ID_EMPTY', error_description: 'LastId is empty.'}});\n\t\t\tpromise.reject();\n\t\t\treturn promise;\n\t\t}\n\n\t\tthis.controller.readMessage(lastId, true, true).then(() =>\n\t\t{\n\t\t\tlet query = {\n\t\t\t\t[ImRestMethodHandler.imDialogRead]: [ImRestMethod.imDialogRead, {\n\t\t\t\t\tdialog_id: this.getDialogId(),\n\t\t\t\t\tmessage_id: lastId\n\t\t\t\t}],\n\t\t\t\t[ImRestMethodHandler.imChatGet]: [ImRestMethod.imChatGet, {\n\t\t\t\t\tdialog_id: this.getDialogId()\n\t\t\t\t}],\n\t\t\t\t[ImRestMethodHandler.imDialogMessagesGetUnread]: [ImRestMethod.imDialogMessagesGet, {\n\t\t\t\t\tchat_id: this.getChatId(),\n\t\t\t\t\tfirst_id: lastId,\n\t\t\t\t\tlimit: limit,\n\t\t\t\t\tconvert_text: 'Y'\n\t\t\t\t}]\n\t\t\t};\n\n\t\t\tthis.restClient.callBatch(query, (response) =>\n\t\t\t{\n\t\t\t\tif (!response)\n\t\t\t\t{\n\t\t\t\t\tthis.template.$emit(EventType.dialog.requestUnreadResult, {error: {error: 'EMPTY_RESPONSE', error_description: 'Server returned an empty response.'}});\n\n\t\t\t\t\tpromise.reject();\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tlet chatGetResult = response[ImRestMethodHandler.imChatGet];\n\t\t\t\tif (!chatGetResult.error())\n\t\t\t\t{\n\t\t\t\t\tthis.executeRestAnswer(ImRestMethodHandler.imChatGet, chatGetResult);\n\t\t\t\t}\n\n\t\t\t\tlet dialogMessageUnread = response[ImRestMethodHandler.imDialogMessagesGetUnread];\n\t\t\t\tif (dialogMessageUnread.error())\n\t\t\t\t{\n\t\t\t\t\tthis.template.$emit(EventType.dialog.requestUnreadResult, {error: dialogMessageUnread.error().ex});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.executeRestAnswer(ImRestMethodHandler.imDialogMessagesGetUnread, dialogMessageUnread);\n\t\t\t\t\tthis.template.$emit(EventType.dialog.requestUnreadResult, {\n\t\t\t\t\t\tfirstMessageId: dialogMessageUnread.data().messages.length > 0? dialogMessageUnread.data().messages[0].id: 0,\n\t\t\t\t\t\tcount: dialogMessageUnread.data().messages.length\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tpromise.fulfill(response);\n\n\t\t\t}, false, false, Utils.getLogTrackingParams({name: ImRestMethodHandler.imDialogMessagesGetUnread, dialog: this.getDialogData()}));\n\t\t});\n\n\t\treturn promise;\n\t}\n\n\tretrySendMessage(message)\n\t{\n\t\tif (this.messagesQueue.find(el => el.id === message.id))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.messagesQueue.push({\n\t\t\tid: message.id,\n\t\t\ttext: message.text,\n\t\t\tsending: false\n\t\t});\n\n\t\tthis.controller.setSendingMessageFlag(message.id);\n\n\t\tthis.processSendMessages();\n\t}\n\n\treadMessage(messageId)\n\t{\n\t\tif (this.offline)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\treturn this.controller.readMessage(messageId);\n\t}\n\n\tquoteMessage(id)\n\t{\n\t\tthis.store.dispatch('dialogues/update', {\n\t\t\tdialogId: this.controller.getDialogId(),\n\t\t\tfields: {\n\t\t\t\tquoteId: id\n\t\t\t}\n\t\t});\n\t}\n\n\treactMessage(id, reaction)\n\t{\n\t\tthis.controller.reactMessage(id, reaction.type, reaction.action);\n\t}\n\n\texecMessageKeyboardCommand(data)\n\t{\n\t\tif (data.action !== 'COMMAND')\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tlet {dialogId, messageId, botId, command, params} = data.params;\n\n\t\tthis.restClient.callMethod(ImRestMethod.imMessageCommand, {\n\t\t\t'MESSAGE_ID': messageId,\n\t\t\t'DIALOG_ID': dialogId,\n\t\t\t'BOT_ID': botId,\n\t\t\t'COMMAND': command,\n\t\t\t'COMMAND_PARAMS': params,\n\t\t});\n\n\t\treturn true;\n\t}\n\n\tquoteMessageClear()\n\t{\n\t\tthis.store.dispatch('dialogues/update', {\n\t\t\tdialogId: this.controller.getDialogId(),\n\t\t\tfields: {\n\t\t\t\tquoteId: 0\n\t\t\t}\n\t\t});\n\t}\n\n\tsendDialogVote(result)\n\t{\n\t\tif (!this.getSessionId())\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.restClient.callMethod(RestMethod.widgetVoteSend, {\n\t\t\t'SESSION_ID': this.getSessionId(),\n\t\t\t'ACTION': result\n\t\t}).catch((result) => {\n\t\t\tthis.store.commit('widget/dialog', {userVote: VoteType.none});\n\t\t});\n\n\t\tthis.sendEvent({\n\t\t\ttype: SubscriptionType.userVote,\n\t\t\tdata: {\n\t\t\t\tvote: result\n\t\t\t}\n\t\t});\n\t}\n\n\tsendForm(type, fields)\n\t{\n\t\tLogger.info('LiveChatWidgetPrivate.sendForm:', type, fields);\n\n\t\tlet query = {\n\t\t\t[RestMethod.widgetFormSend]: [RestMethod.widgetFormSend, {\n\t\t\t\t'CHAT_ID': this.getChatId(),\n\t\t\t\t'FORM': type.toUpperCase(),\n\t\t\t\t'FIELDS': fields\n\t\t\t}],\n\t\t\t[RestMethod.widgetUserGet]: [RestMethod.widgetUserGet, {}]\n\t\t};\n\t\tthis.restClient.callBatch(query, (response) =>\n\t\t{\n\t\t\tif (!response)\n\t\t\t{\n\t\t\t\tthis.requestDataSend = false;\n\t\t\t\tthis.setError('EMPTY_RESPONSE', 'Server returned an empty response.');\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tlet userGetResult = response[RestMethod.widgetUserGet];\n\t\t\tif (userGetResult.error())\n\t\t\t{\n\t\t\t\tthis.requestDataSend = false;\n\t\t\t\tthis.setError(userGetResult.error().ex.error, userGetResult.error().ex.error_description);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tthis.executeRestAnswer(RestMethod.widgetUserGet, userGetResult);\n\n\t\t\tthis.sendEvent({\n\t\t\t\ttype: SubscriptionType.userForm,\n\t\t\t\tdata: {\n\t\t\t\t\tform: type,\n\t\t\t\t\tfields: fields\n\t\t\t\t}\n\t\t\t});\n\n\t\t}, false, false, Utils.getLogTrackingParams({name: RestMethod.widgetUserGet, dialog: this.getDialogData()}));\n\n\t}\n\n\tsendConsentDecision(result)\n\t{\n\t\tresult = result === true;\n\n\t\tthis.store.commit('widget/dialog', {userConsent: result});\n\n\t\tif (result && this.isUserRegistered())\n\t\t{\n\t\t\tthis.restClient.callMethod(RestMethod.widgetUserConsentApply, {\n\t\t\t\tconfig_id: this.getConfigId(),\n\t\t\t\tconsent_url: location.href\n\t\t\t});\n\t\t}\n\t}\n\n/* endregion 05. Templates and template interaction */\n\n/* region 05. Widget interaction and utils */\n\n\tstart()\n\t{\n\t\tif (!this.store)\n\t\t{\n\t\t\tthis.callStartFlag = true;\n\t\t\treturn true;\n\t\t}\n\n\t\tif (this.isSessionActive())\n\t\t{\n\t\t\tthis.requestWidgetData();\n\t\t}\n\n\t\treturn true;\n\t}\n\n\topen(params = {})\n\t{\n\t\tclearTimeout(this.openTimeout);\n\t\tif (!this.store)\n\t\t{\n\t\t\tthis.callOpenFlag = true;\n\t\t\treturn true;\n\t\t}\n\n\t\tif (!params.openFromButton && this.buttonInstance)\n\t\t{\n\t\t\tthis.buttonInstance.wm.showById('openline_livechat');\n\t\t}\n\n\t\tif (!this.checkBrowserVersion())\n\t\t{\n\t\t\tthis.setError('OLD_BROWSER_LOCALIZED', this.localize.BX_LIVECHAT_OLD_BROWSER);\n\t\t}\n\t\telse if (Utils.versionCompare(Vue.version(), '2.1') < 0)\n\t\t{\n\t\t\talert(this.localize.BX_LIVECHAT_OLD_VUE);\n\t\t\tconsole.error(`LiveChatWidget.error: OLD_VUE_VERSION (${this.localize.BX_LIVECHAT_OLD_VUE_DEV.replace('#CURRENT_VERSION#', Vue.version())})`);\n\n\t\t\treturn false;\n\t\t}\n\t\telse if (!this.isWidgetDataRequested())\n\t\t{\n\t\t\tthis.requestWidgetData();\n\t\t}\n\n\t\tthis.attachTemplate();\n\t}\n\n\tclose()\n\t{\n\t\tif (this.pageMode)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tif (this.buttonInstance)\n\t\t{\n\t\t\tthis.buttonInstance.onWidgetClose();\n\t\t}\n\n\t\tthis.detachTemplate();\n\t}\n\n\tshowNotification(params)\n\t{\n\t\tif (!this.store)\n\t\t{\n\t\t\tconsole.error('LiveChatWidget.showNotification: method can be called after fired event - onBitrixLiveChat');\n\t\t\treturn false;\n\t\t}\n\t\t// TODO show popup notification and set badge on button\n\t\t// operatorName\n\t\t// notificationText\n\t\t// counter\n\t}\n\n\tfireInitEvent()\n\t{\n\t\tif (this.initEventFired)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tthis.sendEvent({\n\t\t\ttype: SubscriptionType.configLoaded,\n\t\t\tdata: {}\n\t\t});\n\n\t\tif (this.store.state.widget.common.reopen)\n\t\t{\n\t\t\tthis.open();\n\t\t}\n\n\t\tthis.initEventFired = true;\n\n\t\treturn true;\n\t}\n\n\tisReady()\n\t{\n\t\treturn this.ready;\n\t}\n\n\tisInited()\n\t{\n\t\treturn this.inited;\n\t}\n\n\tisUserRegistered()\n\t{\n\t\treturn !!this.getUserHash();\n\t}\n\n\tisConfigDataLoaded()\n\t{\n\t\treturn this.store.state.widget.common.configId;\n\t}\n\n\tisWidgetDataRequested()\n\t{\n\t\treturn this.widgetDataRequested;\n\t}\n\n\tisChatLoaded()\n\t{\n\t\treturn this.store.state.application.dialog.chatId > 0;\n\t}\n\n\tisSessionActive()\n\t{\n\t\treturn !this.store.state.widget.dialog.sessionClose;\n\t}\n\n\tisUserAgreeConsent()\n\t{\n\t\treturn this.store.state.widget.dialog.userConsent;\n\t}\n\n\tgetCrmTraceData()\n\t{\n\t\tlet traceData = '';\n\n\t\tif (!this.buttonInstance)\n\t\t{\n\t\t\treturn traceData;\n\t\t}\n\n\t\tif (typeof this.buttonInstance.getTrace !== 'function')\n\t\t{\n\t\t\ttraceData = this.buttonInstance.getTrace();\n\t\t}\n\t\telse if (\n\t\t\ttypeof this.buttonInstance.b24Tracker !== 'undefined'\n\t\t\t&& typeof this.buttonInstance.b24Tracker.guest !== 'undefined'\n\t\t)\n\t\t{\n\t\t\ttraceData = this.buttonInstance.b24Tracker.guest.getTrace();\n\t\t}\n\n\t\treturn traceData;\n\t}\n\n\tgetCustomData()\n\t{\n\t\tlet customData = [];\n\n\t\tif (this.customData.length > 0)\n\t\t{\n\t\t\tcustomData = this.customData;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tcustomData = [{MESSAGE: this.localize.BX_LIVECHAT_EXTRA_SITE+': '+location.href}];\n\t\t}\n\n\t\treturn JSON.stringify(customData);\n\t}\n\n\tisUserLoaded()\n\t{\n\t\treturn this.store.state.widget.user.id > 0;\n\t}\n\n\tgetSiteId()\n\t{\n\t\treturn this.host.replace(/(http.?:\\/\\/)|([:.\\\\\\/])/mg, \"\")+this.code;\n\t}\n\n\tgetHost()\n\t{\n\t\treturn this.host;\n\t}\n\n\tgetConfigId()\n\t{\n\t\treturn this.store.state.widget.common.configId;\n\t}\n\n\tisDialogStart()\n\t{\n\t\treturn this.store.state.widget.common.dialogStart;\n\t}\n\n\tgetChatId()\n\t{\n\t\treturn this.store.state.application.dialog.chatId;\n\t}\n\n\tgetDialogId()\n\t{\n\t\treturn this.store.state.application.dialog.dialogId;\n\t}\n\n\tgetDiskFolderId()\n\t{\n\t\treturn this.store.state.application.dialog.diskFolderId;\n\t}\n\n\tgetDialogData(dialogId = this.getDialogId())\n\t{\n\t\treturn this.store.state.dialogues.collection[dialogId];\n\t}\n\n\tgetSessionId()\n\t{\n\t\treturn this.store.state.widget.dialog.sessionId;\n\t}\n\n\tgetUserHash()\n\t{\n\t\treturn this.store.state.widget.user.hash;\n\t}\n\n\tgetUserHashCookie()\n\t{\n\t\tlet userHash = '';\n\n\t\tlet cookie = Cookie.get(null, 'LIVECHAT_HASH');\n\t\tif (typeof cookie === 'string' && cookie.match(/^[a-f0-9]{32}$/))\n\t\t{\n\t\t\tuserHash= cookie;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tlet cookie = Cookie.get(this.getSiteId(), 'LIVECHAT_HASH');\n\t\t\tif (typeof cookie === 'string' && cookie.match(/^[a-f0-9]{32}$/))\n\t\t\t{\n\t\t\t\tuserHash = cookie;\n\t\t\t}\n\t\t}\n\n\t\treturn userHash;\n\t}\n\n\tgetUserId()\n\t{\n\t\treturn this.store.state.widget.user.id;\n\t}\n\n\tgetUserData()\n\t{\n\t\tif (!this.store)\n\t\t{\n\t\t\tconsole.error('LiveChatWidget.getUserData: method can be called after fired event - onBitrixLiveChat');\n\t\t\treturn false;\n\t\t}\n\n\t\treturn this.store.state.widget.user;\n\t}\n\n\tgetUserRegisterFields()\n\t{\n\t\treturn {\n\t\t\t'name': this.userRegisterData.name || '',\n\t\t\t'last_name': this.userRegisterData.lastName || '',\n\t\t\t'avatar': this.userRegisterData.avatar || '',\n\t\t\t'email': this.userRegisterData.email || '',\n\t\t\t'www': this.userRegisterData.www || '',\n\t\t\t'gender': this.userRegisterData.gender || '',\n\t\t\t'position': this.userRegisterData.position || '',\n\t\t\t'user_hash': this.userRegisterData.hash || this.getUserHashCookie() || '',\n\t\t\t'consent_url': this.store.state.widget.common.consentUrl? location.href: '',\n\t\t\t'trace_data': this.getCrmTraceData(),\n\t\t\t'custom_data': this.getCustomData()\n\t\t}\n\t}\n\n\tgetWidgetLocationCode()\n\t{\n\t\treturn LocationStyle[this.store.state.widget.common.location];\n\t}\n\n\tsetUserRegisterData(params)\n\t{\n\t\tif (!this.store)\n\t\t{\n\t\t\tconsole.error('LiveChatWidget.getUserData: method can be called after fired event - onBitrixLiveChat');\n\t\t\treturn false;\n\t\t}\n\n\t\tconst validUserFields = ['hash', 'name', 'lastName', 'avatar', 'email', 'www', 'gender', 'position'];\n\n\t\tif (!Utils.types.isPlainObject(params))\n\t\t{\n\t\t\tconsole.error(`%cLiveChatWidget.setUserData: params is not a object`, \"color: black;\");\n\t\t\treturn false;\n\t\t}\n\n\t\tfor (let field in this.userRegisterData)\n\t\t{\n\t\t\tif (!this.userRegisterData.hasOwnProperty(field))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (!params[field])\n\t\t\t{\n\t\t\t\tdelete this.userRegisterData[field];\n\t\t\t}\n\t\t}\n\n\t\tfor (let field in params)\n\t\t{\n\t\t\tif (!params.hasOwnProperty(field))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (validUserFields.indexOf(field) === -1)\n\t\t\t{\n\t\t\t\tconsole.warn(`%cLiveChatWidget.setUserData: user field is not set, because you are trying to set an unknown field (%c${field}%c)`, \"color: black;\", \"font-weight: bold; color: red\", \"color: black\");\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tthis.userRegisterData[field] = params[field];\n\t\t}\n\n\t\tif (\n\t\t\tthis.userRegisterData.hash\n\t\t\t&& this.getUserHash()\n\t\t\t&& this.userRegisterData.hash !== this.getUserHash()\n\t\t)\n\t\t{\n\t\t\tthis.setNewAuthToken(this.userRegisterData.hash);\n\t\t}\n\t}\n\n\tsetNewAuthToken(authToken = '')\n\t{\n\t\tthis.storeCollector.clearModelState();\n\t\tCookie.set(null, 'LIVECHAT_HASH', '', {expires: 365*86400, path: '/'});\n\n\t\tthis.restClient.setAuthId(RestAuth.guest, authToken);\n\t}\n\n\tsetCustomData(params)\n\t{\n\t\tif (!this.store)\n\t\t{\n\t\t\tconsole.error('LiveChatWidget.getUserData: method can be called after fired event - onBitrixLiveChat');\n\t\t\treturn false;\n\t\t}\n\n\n\t\tlet result = [];\n\t\tif (params instanceof Array)\n\t\t{\n\t\t\tparams.forEach(element =>\n\t\t\t{\n\t\t\t\tif (element && typeof element === 'object')\n\t\t\t\t{\n\t\t\t\t\tresult.push(element);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (result.length <= 0)\n\t\t\t{\n\t\t\t\tconsole.error('LiveChatWidget.setCustomData: params is empty');\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (!params)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tresult = [{'MESSAGE': params}]\n\t\t}\n\n\t\tthis.customData = this.customData.concat(result);\n\n\t\treturn true;\n\t}\n\n\tsetError(code = '', description = '')\n\t{\n\t\tconsole.error(`LiveChatWidget.error: ${code} (${description})`);\n\n\t\tlet localizeDescription = '';\n\t\tif (code === 'LIVECHAT_AUTH_FAILED')\n\t\t{\n\t\t\tlocalizeDescription = this.getLocalize('BX_LIVECHAT_AUTH_FAILED').replace('#LINK_START#', '<a href=\"javascript:void();\" onclick=\"location.reload()\">').replace('#LINK_END#', '</a>');\n\t\t\tthis.setNewAuthToken();\n\t\t}\n\t\telse if (code === 'LIVECHAT_AUTH_PORTAL_USER')\n\t\t{\n\t\t\tlocalizeDescription = this.getLocalize('BX_LIVECHAT_PORTAL_USER_NEW').replace('#LINK_START#', '<a href=\"'+this.host+'\">').replace('#LINK_END#', '</a>')\n\t\t}\n\t\telse if (code.endsWith('LOCALIZED'))\n\t\t{\n\t\t\tlocalizeDescription = description;\n\t\t}\n\n\t\tthis.store.commit('application/set', {error: {\n\t\t\tactive: true,\n\t\t\tcode,\n\t\t\tdescription: localizeDescription\n\t\t}});\n\t}\n\n\tclearError()\n\t{\n\t\tthis.store.commit('application/set', {error: {\n\t\t\tactive: false,\n\t\t\tcode: '',\n\t\t\tdescription: ''}\n\t\t});\n\t}\n\n\t/**\n\t *\n\t * @param params {Object}\n\t * @returns {Function|Boolean} - Unsubscribe callback function or False\n\t */\n\tsubscribe(params)\n\t{\n\t\tif (!Utils.types.isPlainObject(params))\n\t\t{\n\t\t\tconsole.error(`%cLiveChatWidget.subscribe: params is not a object`, \"color: black;\");\n\t\t\treturn false;\n\t\t}\n\n\t\tif (!SubscriptionTypeCheck.includes(params.type))\n\t\t{\n\t\t\tconsole.error(`%cLiveChatWidget.subscribe: subscription type is not correct (%c${params.type}%c)`, \"color: black;\", \"font-weight: bold; color: red\", \"color: black\");\n\t\t\treturn false;\n\t\t}\n\n\t\tif (typeof params.callback !== 'function')\n\t\t{\n\t\t\tconsole.error(`%cLiveChatWidget.subscribe: callback is not a function (%c${typeof params.callback}%c)`, \"color: black;\", \"font-weight: bold; color: red\", \"color: black\");\n\t\t\treturn false;\n\t\t}\n\n\t\tif (typeof (this.subscribers[params.type]) === 'undefined')\n\t\t{\n\t\t\tthis.subscribers[params.type] = [];\n\t\t}\n\n\t\tthis.subscribers[params.type].push(params.callback);\n\n\t\treturn function () {\n\t\t\tthis.subscribers[params.type] = this.subscribers[params.type].filter(function(element) {\n\t\t\t\treturn element !== params.callback;\n\t\t\t});\n\t\t}.bind(this);\n\t}\n\n\t/**\n\t *\n\t * @param params {Object}\n\t * @returns {boolean}\n\t */\n\tsendEvent(params)\n\t{\n\t\tparams = params || {};\n\n\t\tif (!params.type)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tif (typeof params.data !== 'object' || !params.data)\n\t\t{\n\t\t\tparams.data = {};\n\t\t}\n\n\t\tif (this.subscribers[params.type] instanceof Array && this.subscribers[params.type].length > 0)\n\t\t{\n\t\t\tthis.subscribers[params.type].forEach(callback => callback(params.data));\n\t\t}\n\n\t\tif (this.subscribers[SubscriptionType.every] instanceof Array && this.subscribers[SubscriptionType.every].length > 0)\n\t\t{\n\t\t\tthis.subscribers[SubscriptionType.every].forEach(callback => callback({type: params.type, data: params.data}));\n\t\t}\n\n\t\treturn true;\n\t}\n\n\taddLocalize(phrases)\n\t{\n\t\tif (typeof phrases !== \"object\" || !phrases)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tfor (let name in phrases)\n\t\t{\n\t\t\tif (phrases.hasOwnProperty(name))\n\t\t\t{\n\t\t\t\tthis.localize[name] = phrases[name];\n\t\t\t}\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tgetLocalize(name)\n\t{\n\t\tlet phrase = '';\n\t\tif (typeof name === 'undefined')\n\t\t{\n\t\t\treturn this.localize;\n\t\t}\n\t\telse if (typeof this.localize[name.toString()] === 'undefined')\n\t\t{\n\t\t\tconsole.warn(`LiveChatWidget.getLocalize: message with code '${name.toString()}' is undefined.`)\n\t\t}\n\t\telse\n\t\t{\n\t\t\tphrase = this.localize[name];\n\t\t}\n\n\t\treturn phrase;\n\t}\n\n/* endregion 05. Widget interaction and utils */\n}","/**\n * Bitrix OpenLines widget\n * Widget public interface\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {Widget} from \"./widget\"\nimport {SubscriptionType} from \"./const\";\n\nexport class WidgetPublicManager\n{\n\tconstructor(config)\n\t{\n\t\tthis.developerInfo = 'Do not use private methods.';\n\t\tthis.__privateMethods__ = new Widget(config);\n\t\tthis.__createLegacyMethods();\n\t}\n\n\topen(params)\n\t{\n\t\treturn this.__privateMethods__.open(params);\n\t}\n\n\tclose()\n\t{\n\t\treturn this.__privateMethods__.close();\n\t}\n\n\tshowNotification(params)\n\t{\n\t\treturn this.__privateMethods__.showNotification(params);\n\t}\n\n\tgetUserData()\n\t{\n\t\treturn this.__privateMethods__.getUserData();\n\t}\n\n\tsetUserRegisterData(params)\n\t{\n\t\treturn this.__privateMethods__.setUserRegisterData(params);\n\t}\n\n\tsetCustomData(params)\n\t{\n\t\treturn this.__privateMethods__.setCustomData(params);\n\t}\n\n\tmutateTemplateComponent(id, params)\n\t{\n\t\treturn this.__privateMethods__.mutateTemplateComponent(id, params);\n\t}\n\n\taddLocalize(phrases)\n\t{\n\t\treturn this.__privateMethods__.addLocalize(phrases);\n\t}\n\n\t/**\n\t *\n\t * @param params {Object}\n\t * @returns {Function|Boolean} - Unsubscribe callback function or False\n\t */\n\tsubscribe(params)\n\t{\n\t\treturn this.__privateMethods__.subscribe(params);\n\t}\n\n\tstart()\n\t{\n\t\treturn this.__privateMethods__.start();\n\t}\n\n\t__createLegacyMethods()\n\t{\n\t\tif (typeof window.BX.LiveChat === 'undefined')\n\t\t{\n\t\t\tlet sourceHref = document.createElement('a');\n\t\t\tsourceHref.href = this.__privateMethods__.host;\n\n\t\t\tlet sourceDomain = sourceHref.protocol+'//'+sourceHref.hostname+(sourceHref.port && sourceHref.port != '80' && sourceHref.port != '443'? \":\"+sourceHref.port: \"\");\n\n\t\t\twindow.BX.LiveChat = {\n\t\t\t\topenLiveChat: () => {\n\t\t\t\t\tthis.open({openFromButton: true});\n\t\t\t\t},\n\t\t\t\tcloseLiveChat: () => {\n\t\t\t\t\tthis.close();\n\t\t\t\t},\n\t\t\t\taddEventListener: (el, eventName, handler) =>\n\t\t\t\t{\n\t\t\t\t\tif (eventName === 'message')\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.subscribe({\n\t\t\t\t\t\t\ttype: SubscriptionType.userMessage,\n\t\t\t\t\t\t\tcallback: function (event)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\thandler({origin: sourceDomain, data: JSON.stringify({action: 'sendMessage'}), event});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tconsole.warn('Method BX.LiveChat.addEventListener is not supported, user new format for subscribe.')\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tsetCookie: () => {},\n\t\t\t\tgetCookie: () => {},\n\t\t\t\tsourceDomain\n\t\t\t};\n\t\t}\n\n\t\tif (typeof window.BxLiveChatInit === 'function')\n\t\t{\n\t\t\tlet config = window.BxLiveChatInit();\n\n\t\t\tif (config.user)\n\t\t\t{\n\t\t\t\tthis.__privateMethods__.setUserRegisterData(config.user);\n\t\t\t}\n\t\t\tif (config.firstMessage)\n\t\t\t{\n\t\t\t\tthis.__privateMethods__.setCustomData(config.firstMessage)\n\t\t\t}\n\t\t}\n\n\t\tif (window.BxLiveChatLoader instanceof Array)\n\t\t{\n\t\t\twindow.BxLiveChatLoader.forEach(callback => callback());\n\t\t}\n\n\t\treturn true;\n\t}\n}","/**\n * Bitrix OpenLines widget\n * LiveChat base component (Vue component)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {Vue} from \"ui.vue\";\nimport {Vuex} from \"ui.vue.vuex\";\nimport {Utils} from \"im.utils\";\nimport {Logger} from \"im.tools.logger\";\nimport {FormType, VoteType, LocationStyle, LanguageType} from \"../const\";\nimport {DeviceType, DeviceOrientation, EventType} from \"im.const\";\n\n/**\n * @notice Do not mutate or clone this component! It is under development.\n */\n\nVue.component('bx-livechat',\n{\n\tdata()\n\t{\n\t\treturn {\n\t\t\tviewPortMetaSiteNode: null,\n\t\t\tviewPortMetaWidgetNode: null,\n\t\t\tstoredMessage: '',\n\t\t\tstoredFile: null,\n\t\t\ttextareaFocused: false,\n\t\t\ttextareaDrag: false,\n\t\t\ttextareaHeight: 100,\n\t\t\ttextareaMinimumHeight: 100,\n\t\t\ttextareaMaximumHeight: Utils.device.isMobile()? 200: 300,\n\t\t}\n\t},\n\tcreated()\n\t{\n\t\tthis.onCreated();\n\n\t\tdocument.addEventListener('keydown', this.onWindowKeyDown);\n\t\tthis.$root.$on('requestShowForm', this.onRequestShowForm);\n\t},\n\tbeforeDestroy()\n\t{\n\t\tdocument.removeEventListener('keydown', this.onWindowKeyDown);\n\t\tthis.$root.$off('requestShowForm', this.onRequestShowForm);\n\n\t\tthis.onTextareaDragEventRemove();\n\t},\n\tcomputed:\n\t{\n\t\tFormType: () => FormType,\n\t\tVoteType: () => VoteType,\n\t\tDeviceType: () => DeviceType,\n\t\tEventType: () => EventType,\n\n\t\ttextareaHeightStyle(state)\n\t\t{\n\t\t\treturn 'flex: 0 0 '+this.textareaHeight+'px;'\n\t\t},\n\t\tlocalize()\n\t\t{\n\t\t\treturn Vue.getFilteredPhrases('BX_LIVECHAT_', this.$root.$bitrixMessages);\n\t\t},\n\t\twidgetMobileDisabled(state)\n\t\t{\n\t\t\tif (state.application.device.type === DeviceType.mobile)\n\t\t\t{\n\t\t\t\tif (navigator.userAgent.toString().includes('iPad'))\n\t\t\t\t{\n\t\t\t\t}\n\t\t\t\telse if (state.application.device.orientation === DeviceOrientation.horizontal)\n\t\t\t\t{\n\t\t\t\t\tif (navigator.userAgent.toString().includes('iPhone'))\n\t\t\t\t\t{\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\treturn !(typeof window.screen === 'object' && window.screen.availHeight >= 800);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn false;\n\t\t},\n\t\twidgetClassName(state)\n\t\t{\n\t\t\tlet className = ['bx-livechat-wrapper'];\n\n\t\t\tclassName.push('bx-livechat-show');\n\n\t\t\tif (state.widget.common.pageMode)\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-page-mode');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-position-'+LocationStyle[state.widget.common.location]);\n\t\t\t}\n\n\t\t\tif (state.application.common.languageId === LanguageType.russian)\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-logo-ru');\n\t\t\t}\n\t\t\telse if (state.application.common.languageId === LanguageType.ukraine)\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-logo-ua');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-logo-en');\n\t\t\t}\n\n\t\t\tif (!state.widget.common.online)\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-offline-state');\n\t\t\t}\n\n\t\t\tif (state.widget.common.dragged)\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-drag-n-drop');\n\t\t\t}\n\n\t\t\tif (state.widget.common.dialogStart)\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-chat-start');\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\tstate.widget.dialog.operator.name\n\t\t\t\t&& !(state.application.device.type === DeviceType.mobile && state.application.device.orientation === DeviceOrientation.horizontal)\n\t\t\t)\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-has-operator');\n\t\t\t}\n\n\t\t\tif (Utils.device.isMobile())\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-mobile');\n\t\t\t}\n\t\t\telse if (Utils.browser.isSafari())\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-browser-safari');\n\t\t\t}\n\t\t\telse if (Utils.browser.isIe())\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-browser-ie');\n\t\t\t}\n\n\t\t\tif (Utils.platform.isMac())\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-mac');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-custom-scroll');\n\t\t\t}\n\n\t\t\tif (state.widget.common.styles.backgroundColor && Utils.isDarkColor(state.widget.common.styles.iconColor))\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-bright-header');\n\t\t\t}\n\n\t\t\treturn className.join(' ');\n\t\t},\n\t\tshowMessageDialog()\n\t\t{\n\t\t\treturn this.messageCollection.length > 0;\n\t\t},\n\t\tquotePanelData()\n\t\t{\n\t\t\tlet result = {\n\t\t\t\tid: 0,\n\t\t\t\ttitle: '',\n\t\t\t\tdescription: '',\n\t\t\t\tcolor: ''\n\t\t\t};\n\t\t\tif (!this.dialog.quoteId)\n\t\t\t{\n\t\t\t\treturn result;\n\t\t\t}\n\n\t\t\tlet message = this.$store.getters['messages/getMessage'](this.dialog.chatId, this.dialog.quoteId);\n\t\t\tif (!message)\n\t\t\t{\n\t\t\t\treturn result;\n\t\t\t}\n\n\t\t\tlet user = this.$store.getters['users/get'](message.authorId);\n\n\t\t\tresult = {\n\t\t\t\tid: this.dialog.quoteId,\n\t\t\t\ttitle: user? user.name: '',\n\t\t\t\tcolor: user? user.color: '',\n\t\t\t\tdescription: message.textConverted? message.textConverted: this.localize.BX_LIVECHAT_FILE_MESSAGE\n\t\t\t};\n\n\t\t\treturn result;\n\t\t},\n\t\t...Vuex.mapState({\n\t\t\twidget: state => state.widget,\n\t\t\tapplication: state => state.application,\n\t\t\tdialog: state => state.dialogues.collection[state.application.dialog.dialogId],\n\t\t\tmessageCollection: state => state.messages.collection[state.application.dialog.chatId]\n\t\t})\n\t},\n\twatch:\n\t{\n\t\tsessionClose(value)\n\t\t{\n\t\t\tLogger.log('sessionClose change', value);\n\t\t}\n\t},\n\tmethods:\n\t{\n\t\tclose(event)\n\t\t{\n\t\t\tif (this.widget.common.pageMode)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tthis.onBeforeClose();\n\t\t\tthis.$store.commit('widget/common', {showed: false});\n\t\t},\n\t\tshowLikeForm()\n\t\t{\n\t\t\tif (this.offline)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tclearTimeout(this.showFormTimeout);\n\t\t\tif (!this.widget.common.vote.enable)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tif (\n\t\t\t\tthis.widget.dialog.sessionClose\n\t\t\t\t&& this.widget.dialog.userVote !== VoteType.none\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tthis.$store.commit('widget/common', {showForm: FormType.like});\n\t\t},\n\t\tshowWelcomeForm()\n\t\t{\n\t\t\tclearTimeout(this.showFormTimeout);\n\t\t\tthis.$store.commit('widget/common', {showForm: FormType.welcome});\n\t\t},\n\t\tshowOfflineForm()\n\t\t{\n\t\t\tclearTimeout(this.showFormTimeout);\n\n\t\t\tif (this.widget.dialog.showForm !== FormType.welcome)\n\t\t\t{\n\t\t\t\tthis.$store.commit('widget/common', {showForm: FormType.offline});\n\t\t\t}\n\t\t},\n\t\tshowHistoryForm()\n\t\t{\n\t\t\tclearTimeout(this.showFormTimeout);\n\t\t\tthis.$store.commit('widget/common', {showForm: FormType.history});\n\t\t},\n\t\thideForm()\n\t\t{\n\t\t\tclearTimeout(this.showFormTimeout);\n\n\t\t\tif (this.widget.common.showForm !== FormType.none)\n\t\t\t{\n\t\t\t\tthis.$store.commit('widget/common', {showForm: FormType.none});\n\t\t\t}\n\t\t},\n\t\tshowConsentWidow()\n\t\t{\n\t\t\tthis.$store.commit('widget/common', {showConsent: true});\n\t\t},\n\t\tagreeConsentWidow()\n\t\t{\n\t\t\tthis.$store.commit('widget/common', {showConsent: false});\n\n\t\t\tthis.$root.$bitrixWidget.sendConsentDecision(true);\n\n\t\t\tif (this.storedMessage || this.storedFile)\n\t\t\t{\n\t\t\t\tif (this.storedMessage)\n\t\t\t\t{\n\t\t\t\t\tthis.onTextareaSend({focus: this.application.device.type !== DeviceType.mobile});\n\t\t\t\t\tthis.storedMessage = '';\n\t\t\t\t}\n\t\t\t\tif (this.storedFile)\n\t\t\t\t{\n\t\t\t\t\tthis.onTextareaFileSelected();\n\t\t\t\t\tthis.storedFile = '';\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (this.widget.common.showForm === FormType.none)\n\t\t\t{\n\t\t\t\tthis.$root.$emit(EventType.textarea.focus);\n\t\t\t}\n\t\t},\n\t\tdisagreeConsentWidow()\n\t\t{\n\t\t\tthis.$store.commit('widget/common', {showForm : FormType.none});\n\t\t\tthis.$store.commit('widget/common', {showConsent : false});\n\n\t\t\tthis.$root.$bitrixWidget.sendConsentDecision(false);\n\n\t\t\tif (this.storedMessage)\n\t\t\t{\n\t\t\t\tthis.$root.$emit(EventType.textarea.insertText, {\n\t\t\t\t\ttext: this.storedMessage,\n\t\t\t\t\tfocus: this.application.device.type !== DeviceType.mobile\n\t\t\t\t});\n\t\t\t\tthis.storedMessage = '';\n\t\t\t}\n\t\t\tif (this.storedFile)\n\t\t\t{\n\t\t\t\tthis.storedFile = '';\n\t\t\t}\n\n\t\t\tif (this.application.device.type !== DeviceType.mobile)\n\t\t\t{\n\t\t\t\tthis.$root.$emit(EventType.textarea.focus);\n\t\t\t}\n\t\t},\n\t\tlogEvent(name, ...params)\n\t\t{\n\t\t\tLogger.info(name, ...params);\n\t\t},\n\t\tonCreated()\n\t\t{\n\t\t\tif(Utils.device.isMobile())\n\t\t\t{\n\t\t\t\tlet viewPortMetaSiteNode = Array.from(\n\t\t\t\t\tdocument.head.getElementsByTagName('meta')\n\t\t\t\t).filter(element => element.name === 'viewport')[0];\n\n\t\t\t\tif (viewPortMetaSiteNode)\n\t\t\t\t{\n\t\t\t\t\tthis.viewPortMetaSiteNode = viewPortMetaSiteNode;\n\t\t\t\t\tdocument.head.removeChild(this.viewPortMetaSiteNode);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tlet contentWidth = document.body.offsetWidth;\n\t\t\t\t\tif (contentWidth < window.innerWidth)\n\t\t\t\t\t{\n\t\t\t\t\t\tcontentWidth = window.innerWidth;\n\t\t\t\t\t}\n\t\t\t\t\tif (contentWidth < 1024)\n\t\t\t\t\t{\n\t\t\t\t\t\tcontentWidth = 1024;\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.viewPortMetaSiteNode = document.createElement('meta');\n\t\t\t\t\tthis.viewPortMetaSiteNode.setAttribute('name', 'viewport');\n\t\t\t\t\tthis.viewPortMetaSiteNode.setAttribute('content', `width=${contentWidth}, initial-scale=1.0, user-scalable=1`);\n\t\t\t\t}\n\n\t\t\t\tif (!this.viewPortMetaWidgetNode)\n\t\t\t\t{\n\t\t\t\t\tthis.viewPortMetaWidgetNode = document.createElement('meta');\n\t\t\t\t\tthis.viewPortMetaWidgetNode.setAttribute('name', 'viewport');\n\t\t\t\t\tthis.viewPortMetaWidgetNode.setAttribute('content', 'width=device-width, initial-scale=1.0, user-scalable=0');\n\t\t\t\t\tdocument.head.appendChild(this.viewPortMetaWidgetNode);\n\t\t\t\t}\n\n\t\t\t\tdocument.body.classList.add('bx-livechat-mobile-state');\n\n\t\t\t\tif (Utils.browser.isSafariBased())\n\t\t\t\t{\n\t\t\t\t\tdocument.body.classList.add('bx-livechat-mobile-safari-based');\n\t\t\t\t}\n\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tthis.$store.commit('widget/common', {showed: true});\n\t\t\t\t}, 50);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.$store.commit('widget/common', {showed: true});\n\t\t\t}\n\n\t\t\tthis.textareaHeight = this.widget.common.textareaHeight || this.textareaHeight;\n\n\t\t\tthis.$store.commit('files/initCollection', {chatId: this.$root.$bitrixWidget.getChatId()});\n\t\t\tthis.$store.commit('messages/initCollection', {chatId: this.$root.$bitrixWidget.getChatId()});\n\t\t\tthis.$store.commit('dialogues/initCollection', {dialogId: this.$root.$bitrixWidget.getDialogId(), fields: {\n\t\t\t\tentityType: 'LIVECHAT',\n\t\t\t\ttype: 'livechat'\n\t\t\t}});\n\t\t},\n\t\tonBeforeClose()\n\t\t{\n\t\t\tif(Utils.device.isMobile())\n\t\t\t{\n\t\t\t\tdocument.body.classList.remove('bx-livechat-mobile-state');\n\n\t\t\t\tif (Utils.browser.isSafariBased())\n\t\t\t\t{\n\t\t\t\t\tdocument.body.classList.remove('bx-livechat-mobile-safari-based');\n\t\t\t\t}\n\n\t\t\t\tif (this.viewPortMetaWidgetNode)\n\t\t\t\t{\n\t\t\t\t\tdocument.head.removeChild(this.viewPortMetaWidgetNode);\n\t\t\t\t\tthis.viewPortMetaWidgetNode = null;\n\t\t\t\t}\n\n\t\t\t\tif (this.viewPortMetaSiteNode)\n\t\t\t\t{\n\t\t\t\t\tdocument.head.appendChild(this.viewPortMetaSiteNode);\n\t\t\t\t\tthis.viewPortMetaSiteNode = null;\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tonAfterClose()\n\t\t{\n\t\t\tthis.$root.$bitrixWidget.close();\n\t\t},\n\t\tonRequestShowForm(event)\n\t\t{\n\t\t\tclearTimeout(this.showFormTimeout);\n\t\t\tif (event.type === FormType.welcome)\n\t\t\t{\n\t\t\t\tif (event.delayed)\n\t\t\t\t{\n\t\t\t\t\tthis.showFormTimeout = setTimeout(() => {\n\t\t\t\t\t\tthis.showWelcomeForm();\n\t\t\t\t\t}, 5000);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.showWelcomeForm();\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (event.type === FormType.offline)\n\t\t\t{\n\t\t\t\tif (event.delayed)\n\t\t\t\t{\n\t\t\t\t\tthis.showFormTimeout = setTimeout(() => {\n\t\t\t\t\t\tthis.showOfflineForm();\n\t\t\t\t\t}, 3000);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.showOfflineForm();\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (event.type === FormType.like)\n\t\t\t{\n\t\t\t\tif (event.delayed)\n\t\t\t\t{\n\t\t\t\t\tthis.showFormTimeout = setTimeout(() => {\n\t\t\t\t\t\tthis.showLikeForm();\n\t\t\t\t\t}, 5000);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.showLikeForm();\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tonDialogRequestHistory(event)\n\t\t{\n\t\t\tthis.$root.$bitrixWidget.getDialogHistory(event.lastId);\n\t\t},\n\t\tonDialogRequestUnread(event)\n\t\t{\n\t\t\tthis.$root.$bitrixWidget.getDialogUnread(event.lastId);\n\t\t},\n\t\tonDialogMessageClickByUserName(event)\n\t\t{\n\t\t\t// TODO name push to auto-replace mention holder - User Name -> [USER=274]User Name[/USER]\n\t\t\tthis.$root.$emit(EventType.textarea.insertText, {text: event.user.name+' '});\n\t\t},\n\t\tonDialogMessageClickByUploadCancel(event)\n\t\t{\n\t\t\tthis.$root.$bitrixWidget.cancelUploadFile(event.file.id);\n\t\t},\n\t\tonDialogMessageClickByKeyboardButton(event)\n\t\t{\n\t\t\tthis.$root.$bitrixWidget.execMessageKeyboardCommand(event);\n\t\t},\n\t\tonDialogMessageClickByCommand(event)\n\t\t{\n\t\t\tif (event.type === 'put')\n\t\t\t{\n\t\t\t\tthis.$root.$emit(EventType.textarea.insertText, {text: event.value+' '});\n\t\t\t}\n\t\t\telse if (event.type === 'send')\n\t\t\t{\n\t\t\t\tthis.$root.$bitrixWidget.addMessage(event.value);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tLogger.warn('Unprocessed command', event);\n\t\t\t}\n\t\t},\n\t\tonDialogMessageMenuClick(event)\n\t\t{\n\t\t\tLogger.warn('Message menu:', event);\n\t\t},\n\t\tonDialogMessageRetryClick(event)\n\t\t{\n\t\t\tLogger.warn('Message retry:', event);\n\t\t\tthis.$root.$bitrixWidget.retrySendMessage(event.message);\n\t\t},\n\t\tonDialogReadMessage(event)\n\t\t{\n\t\t\tthis.$root.$bitrixWidget.readMessage(event.id);\n\t\t},\n\t\tonDialogQuoteMessage(event)\n\t\t{\n\t\t\tthis.$root.$bitrixWidget.quoteMessage(event.message.id);\n\t\t},\n\t\tonDialogMessageReactionSet(event)\n\t\t{\n\t\t\tthis.$root.$bitrixWidget.reactMessage(event.message.id, event.reaction);\n\t\t},\n\t\tonDialogClick(event)\n\t\t{\n\t\t\tif (this.widget.common.showForm !== FormType.none)\n\t\t\t{\n\t\t\t\tthis.$store.commit('widget/common', {showForm: FormType.none});\n\t\t\t}\n\t\t},\n\t\tonTextareaSend(event)\n\t\t{\n\t\t\tevent.focus = event.focus !== false;\n\n\t\t\tif (this.widget.common.showForm === FormType.smile)\n\t\t\t{\n\t\t\t\tthis.$store.commit('widget/common', {showForm: FormType.none});\n\t\t\t}\n\n\t\t\tif (!this.widget.dialog.userConsent && this.widget.common.consentUrl)\n\t\t\t{\n\t\t\t\tif (event.text)\n\t\t\t\t{\n\t\t\t\t\tthis.storedMessage = event.text;\n\t\t\t\t}\n\t\t\t\tthis.showConsentWidow();\n\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tevent.text = event.text? event.text: this.storedMessage;\n\t\t\tif (!event.text)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tthis.hideForm();\n\t\t\tthis.$root.$bitrixWidget.addMessage(event.text);\n\n\t\t\tif (event.focus)\n\t\t\t{\n\t\t\t\tthis.$root.$emit(EventType.textarea.focus);\n\t\t\t}\n\n\t\t\treturn true;\n\t\t},\n\t\tonTextareaWrites(event)\n\t\t{\n\t\t\tthis.$root.$bitrixController.startWriting();\n\t\t},\n\t\tonTextareaFocus(event)\n\t\t{\n\t\t\tif (\n\t\t\t\tthis.widget.common.copyright &&\n\t\t\t\tthis.application.device.type === DeviceType.mobile\n\t\t\t)\n\t\t\t{\n\t\t\t\tthis.widget.common.copyright = false;\n\t\t\t}\n\t\t\tif (Utils.device.isMobile())\n\t\t\t{\n\t\t\t\tclearTimeout(this.onTextareaFocusScrollTimeout);\n\t\t\t\tthis.onTextareaFocusScrollTimeout = setTimeout(() => {\n\t\t\t\t\tdocument.addEventListener('scroll', this.onWindowScroll);\n\t\t\t\t}, 1000);\n\t\t\t}\n\t\t\tthis.textareaFocused = true;\n\t\t},\n\t\tonTextareaBlur(event)\n\t\t{\n\t\t\tif (!this.widget.common.copyright && this.widget.common.copyright !== this.$root.$bitrixWidget.copyright)\n\t\t\t{\n\t\t\t\tthis.widget.common.copyright = this.$root.$bitrixWidget.copyright;\n\t\t\t\tthis.$nextTick(() => {\n\t\t\t\t\tthis.$root.$emit(EventType.dialog.scrollToBottom, {force: true});\n\t\t\t\t});\n\t\t\t}\n\t\t\tif (Utils.device.isMobile())\n\t\t\t{\n\t\t\t\tclearTimeout(this.onTextareaFocusScrollTimeout);\n\t\t\t\tdocument.removeEventListener('scroll', this.onWindowScroll);\n\t\t\t}\n\n\t\t\tthis.textareaFocused = false;\n\t\t},\n\t\tonTextareaStartDrag(event)\n\t\t{\n\t\t\tif (this.textareaDrag)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tLogger.log('Livechat: textarea drag started');\n\n\t\t\tthis.textareaDrag = true;\n\n\t\t\tevent = event.changedTouches ? event.changedTouches[0] : event;\n\n\t\t\tthis.textareaDragCursorStartPoint = event.clientY;\n\t\t\tthis.textareaDragHeightStartPoint = this.textareaHeight;\n\n\t\t\tthis.onTextareaDragEventAdd();\n\n\t\t\tthis.$root.$emit(EventType.textarea.blur, true);\n\t\t},\n\t\tonTextareaContinueDrag(event)\n\t\t{\n\t\t\tif (!this.textareaDrag)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tevent = event.changedTouches ? event.changedTouches[0] : event;\n\n\t\t\tthis.textareaDragCursorControlPoint = event.clientY;\n\n\t\t\tlet textareaHeight = Math.max(\n\t\t\t\tMath.min(this.textareaDragHeightStartPoint + this.textareaDragCursorStartPoint - this.textareaDragCursorControlPoint, this.textareaMaximumHeight)\n\t\t\t, this.textareaMinimumHeight);\n\n\t\t\tLogger.log('Livechat: textarea drag', 'new: '+textareaHeight, 'curr: '+this.textareaHeight);\n\n\t\t\tif (this.textareaHeight !== textareaHeight)\n\t\t\t{\n\t\t\t\tthis.textareaHeight = textareaHeight;\n\t\t\t}\n\t\t},\n\t\tonTextareaStopDrag()\n\t\t{\n\t\t\tif (!this.textareaDrag)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tLogger.log('Livechat: textarea drag ended');\n\n\t\t\tthis.textareaDrag = false;\n\n\t\t\tthis.onTextareaDragEventRemove();\n\n\t\t\tthis.$store.commit('widget/common', {textareaHeight: this.textareaHeight});\n\t\t\tthis.$root.$emit(EventType.dialog.scrollToBottom, {force: true});\n\t\t},\n\t\tonTextareaDragEventAdd()\n\t\t{\n\t\t\tdocument.addEventListener('mousemove', this.onTextareaContinueDrag);\n\t\t\tdocument.addEventListener('touchmove', this.onTextareaContinueDrag);\n\t\t\tdocument.addEventListener('touchend', this.onTextareaStopDrag);\n\t\t\tdocument.addEventListener('mouseup', this.onTextareaStopDrag);\n\t\t\tdocument.addEventListener('mouseleave', this.onTextareaStopDrag);\n\t\t},\n\t\tonTextareaDragEventRemove()\n\t\t{\n\t\t\tdocument.removeEventListener('mousemove', this.onTextareaContinueDrag);\n\t\t\tdocument.removeEventListener('touchmove', this.onTextareaContinueDrag);\n\t\t\tdocument.removeEventListener('touchend', this.onTextareaStopDrag);\n\t\t\tdocument.removeEventListener('mouseup', this.onTextareaStopDrag);\n\t\t\tdocument.removeEventListener('mouseleave', this.onTextareaStopDrag);\n\t\t},\n\t\tonTextareaFileSelected(event)\n\t\t{\n\t\t\tlet fileInput = event && event.fileInput? event.fileInput: this.storedFile;\n\t\t\tif (!fileInput)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (fileInput.files[0].size > this.application.disk.maxFileSize)\n\t\t\t{\n\t\t\t\t// TODO change alert to correct overlay window\n\t\t\t\talert(this.localize.BX_LIVECHAT_FILE_SIZE_EXCEEDED.replace('#LIMIT#', Math.round(this.application.disk.maxFileSize/1024/1024)));\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (!this.widget.dialog.userConsent && this.widget.common.consentUrl)\n\t\t\t{\n\t\t\t\tthis.storedFile = event.fileInput;\n\t\t\t\tthis.showConsentWidow();\n\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tthis.$root.$bitrixWidget.uploadFile(fileInput);\n\t\t},\n\t\tonTextareaAppButtonClick(event)\n\t\t{\n\t\t\tif (event.appId === FormType.smile)\n\t\t\t{\n\t\t\t\tif (this.widget.common.showForm === FormType.smile)\n\t\t\t\t{\n\t\t\t\t\tthis.$store.commit('widget/common', {showForm: FormType.none});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.$store.commit('widget/common', {showForm: FormType.smile});\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.$root.$emit(EventType.textarea.focus);\n\t\t\t}\n\t\t},\n\t\tonPullRequestConfig(event)\n\t\t{\n\t\t\tthis.$root.$bitrixWidget.recoverPullConnection();\n\t\t},\n\t\tonSmilesSelectSmile(event)\n\t\t{\n\t\t\tthis.$root.$emit(EventType.textarea.insertText, {text: event.text});\n\t\t},\n\t\tonSmilesSelectSet()\n\t\t{\n\t\t\tthis.$root.$emit(EventType.textarea.focus);\n\t\t},\n\t\tonQuotePanelClose()\n\t\t{\n\t\t\tthis.$root.$bitrixWidget.quoteMessageClear();\n\t\t},\n\t\tonWindowKeyDown(event)\n\t\t{\n\t\t\tif (event.keyCode === 27)\n\t\t\t{\n\t\t\t\tif (this.widget.common.showForm !== FormType.none)\n\t\t\t\t{\n\t\t\t\t\tthis.$store.commit('widget/common', {showForm: FormType.none});\n\t\t\t\t}\n\t\t\t\telse if (this.widget.common.showConsent)\n\t\t\t\t{\n\t\t\t\t\tthis.disagreeConsentWidow();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.close();\n\t\t\t\t}\n\n\t\t\t\tevent.preventDefault();\n\t\t\t\tevent.stopPropagation();\n\n\t\t\t\tthis.$root.$emit(EventType.textarea.focus);\n\t\t\t}\n\t\t},\n\t\tonWindowScroll(event)\n\t\t{\n\t\t\tclearTimeout(this.onWindowScrollTimeout);\n\t\t\tthis.onWindowScrollTimeout = setTimeout(() => {\n\t\t\t\tthis.$root.$emit(EventType.textarea.blur, true);\n\t\t\t}, 50);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<transition enter-active-class=\"bx-livechat-show\" leave-active-class=\"bx-livechat-close\" @after-leave=\"onAfterClose\">\n\t\t\t<div :class=\"widgetClassName\" v-if=\"widget.common.showed\">\n\t\t\t\t<div class=\"bx-livechat-box\">\n\t\t\t\t\t<bx-livechat-head :isWidgetDisabled=\"widgetMobileDisabled\" @like=\"showLikeForm\" @history=\"showHistoryForm\" @close=\"close\"/>\n\t\t\t\t\t<template v-if=\"widgetMobileDisabled\">\n\t\t\t\t\t\t<bx-livechat-body-orientation-disabled/>\n\t\t\t\t\t</template>\n\t\t\t\t\t<template v-else-if=\"application.error.active\">\n\t\t\t\t\t\t<bx-livechat-body-error/>\n\t\t\t\t\t</template>\n\t\t\t\t\t<template v-else-if=\"!widget.common.configId\">\n\t\t\t\t\t\t<div class=\"bx-livechat-body\" key=\"loading-body\">\n\t\t\t\t\t\t\t<bx-livechat-body-loading/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</template>\t\t\t\n\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t<template v-if=\"!widget.common.dialogStart\">\n\t\t\t\t\t\t\t<div class=\"bx-livechat-body\" key=\"welcome-body\">\n\t\t\t\t\t\t\t\t<bx-livechat-body-operators/>\n\t\t\t\t\t\t\t\t<keep-alive include=\"bx-livechat-smiles\">\n\t\t\t\t\t\t\t\t\t<template v-if=\"widget.common.showForm == FormType.smile\">\n\t\t\t\t\t\t\t\t\t\t<bx-livechat-smiles @selectSmile=\"onSmilesSelectSmile\" @selectSet=\"onSmilesSelectSet\"/>\t\n\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t</keep-alive>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t\t<template v-else-if=\"widget.common.dialogStart\">\n\t\t\t\t\t\t\t<bx-pull-status :canReconnect=\"true\" @reconnect=\"onPullRequestConfig\"/>\n\t\t\t\t\t\t\t<div :class=\"['bx-livechat-body', {'bx-livechat-body-with-message': showMessageDialog}]\" key=\"with-message\">\n\t\t\t\t\t\t\t\t<template v-if=\"showMessageDialog\">\n\t\t\t\t\t\t\t\t\t<div class=\"bx-livechat-dialog\">\n\t\t\t\t\t\t\t\t\t\t<bx-messenger-dialog\n\t\t\t\t\t\t\t\t\t\t\t:userId=\"application.common.userId\" \n\t\t\t\t\t\t\t\t\t\t\t:dialogId=\"application.dialog.dialogId\"\n\t\t\t\t\t\t\t\t\t\t\t:chatId=\"application.dialog.chatId\"\n\t\t\t\t\t\t\t\t\t\t\t:messageLimit=\"application.dialog.messageLimit\"\n\t\t\t\t\t\t\t\t\t\t\t:messageExtraCount=\"application.dialog.messageExtraCount\"\n\t\t\t\t\t\t\t\t\t\t\t:enableReactions=\"true\"\n\t\t\t\t\t\t\t\t\t\t\t:enableDateActions=\"false\"\n\t\t\t\t\t\t\t\t\t\t\t:enableCreateContent=\"false\"\n\t\t\t\t\t\t\t\t\t\t\t:enableGestureQuote=\"true\"\n\t\t\t\t\t\t\t\t\t\t\t:enableGestureMenu=\"true\"\n\t\t\t\t\t\t\t\t\t\t\t:showMessageAvatar=\"false\"\n\t\t\t\t\t\t\t\t\t\t\t:showMessageMenu=\"false\"\n\t\t\t\t\t\t\t\t\t\t\t:listenEventScrollToBottom=\"EventType.dialog.scrollToBottom\"\n\t\t\t\t\t\t\t\t\t\t\t:listenEventRequestHistory=\"EventType.dialog.requestHistoryResult\"\n\t\t\t\t\t\t\t\t\t\t\t:listenEventRequestUnread=\"EventType.dialog.requestUnreadResult\"\n\t\t\t\t\t\t\t\t\t\t\t@readMessage=\"onDialogReadMessage\"\n\t\t\t\t\t\t\t\t\t\t\t@requestHistory=\"onDialogRequestHistory\"\n\t\t\t\t\t\t\t\t\t\t\t@requestUnread=\"onDialogRequestUnread\"\n\t\t\t\t\t\t\t\t\t\t\t@quoteMessage=\"onDialogQuoteMessage\"\n\t\t\t\t\t\t\t\t\t\t\t@clickByCommand=\"onDialogMessageClickByCommand\"\n\t\t\t\t\t\t\t\t\t\t\t@clickByUserName=\"onDialogMessageClickByUserName\"\n\t\t\t\t\t\t\t\t\t\t\t@clickByUploadCancel=\"onDialogMessageClickByUploadCancel\"\n\t\t\t\t\t\t\t\t\t\t\t@clickByKeyboardButton=\"onDialogMessageClickByKeyboardButton\"\n\t\t\t\t\t\t\t\t\t\t\t@clickByMessageMenu=\"onDialogMessageMenuClick\"\n\t\t\t\t\t\t\t\t\t\t\t@clickByMessageRetry=\"onDialogMessageRetryClick\"\n\t\t\t\t\t\t\t\t\t\t\t@setMessageReaction=\"onDialogMessageReactionSet\"\n\t\t\t\t\t\t\t\t\t\t\t@click=\"onDialogClick\"\n\t\t\t\t\t\t\t\t\t\t />\n\t\t\t\t\t\t\t\t\t</div>\t \n\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t\t\t\t<bx-livechat-body-loading/>\n\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t<bx-messenger-quote-panel :id=\"quotePanelData.id\" :title=\"quotePanelData.title\" :description=\"quotePanelData.description\" :color=\"quotePanelData.color\" @close=\"onQuotePanelClose\"/>\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t<keep-alive include=\"bx-livechat-smiles\">\n\t\t\t\t\t\t\t\t\t<template v-if=\"widget.common.showForm == FormType.like && widget.common.vote.enable\">\n\t\t\t\t\t\t\t\t\t\t<bx-livechat-form-vote/>\n\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t\t<template v-else-if=\"widget.common.showForm == FormType.welcome\">\n\t\t\t\t\t\t\t\t\t\t<bx-livechat-form-welcome/>\t\n\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t\t<template v-else-if=\"widget.common.showForm == FormType.offline\">\n\t\t\t\t\t\t\t\t\t\t<bx-livechat-form-offline/>\t\n\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t\t<template v-else-if=\"widget.common.showForm == FormType.history\">\n\t\t\t\t\t\t\t\t\t\t<bx-livechat-form-history/>\t\n\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t\t<template v-else-if=\"widget.common.showForm == FormType.smile\">\n\t\t\t\t\t\t\t\t\t\t<bx-livechat-smiles @selectSmile=\"onSmilesSelectSmile\" @selectSet=\"onSmilesSelectSet\"/>\t\n\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t</keep-alive>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</template>\t\n\t\t\t\t\t\t<div class=\"bx-livechat-textarea\" :style=\"textareaHeightStyle\" ref=\"textarea\">\n\t\t\t\t\t\t\t<div class=\"bx-livechat-textarea-resize-handle\" @mousedown=\"onTextareaStartDrag\" @touchstart=\"onTextareaStartDrag\"></div>\n\t\t\t\t\t\t\t<bx-messenger-textarea\n\t\t\t\t\t\t\t\t:siteId=\"application.common.siteId\"\n\t\t\t\t\t\t\t\t:userId=\"application.common.userId\"\n\t\t\t\t\t\t\t\t:dialogId=\"application.dialog.dialogId\"\n\t\t\t\t\t\t\t\t:writesEventLetter=\"3\"\n\t\t\t\t\t\t\t\t:enableEdit=\"true\"\n\t\t\t\t\t\t\t\t:enableCommand=\"false\"\n\t\t\t\t\t\t\t\t:enableMention=\"false\"\n\t\t\t\t\t\t\t\t:enableFile=\"application.disk.enabled\"\n\t\t\t\t\t\t\t\t:autoFocus=\"application.device.type !== DeviceType.mobile\"\n\t\t\t\t\t\t\t\t:styles=\"{button: {backgroundColor: widget.common.styles.backgroundColor, iconColor: widget.common.styles.iconColor}}\"\n\t\t\t\t\t\t\t\t:listenEventInsertText=\"EventType.textarea.insertText\"\n\t\t\t\t\t\t\t\t:listenEventFocus=\"EventType.textarea.focus\"\n\t\t\t\t\t\t\t\t:listenEventBlur=\"EventType.textarea.blur\"\n\t\t\t\t\t\t\t\t@writes=\"onTextareaWrites\" \n\t\t\t\t\t\t\t\t@send=\"onTextareaSend\" \n\t\t\t\t\t\t\t\t@focus=\"onTextareaFocus\" \n\t\t\t\t\t\t\t\t@blur=\"onTextareaBlur\" \n\t\t\t\t\t\t\t\t@edit=\"logEvent('edit message', $event)\"\n\t\t\t\t\t\t\t\t@fileSelected=\"onTextareaFileSelected\"\n\t\t\t\t\t\t\t\t@appButtonClick=\"onTextareaAppButtonClick\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<bx-livechat-form-consent @agree=\"agreeConsentWidow\" @disagree=\"disagreeConsentWidow\"/>\n\t\t\t\t\t\t<template v-if=\"widget.common.copyright\">\n\t\t\t\t\t\t\t<bx-livechat-footer/>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</template>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</transition>\n\t`\n});","/**\n * Bitrix OpenLines widget\n * Body error component (Vue component)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {Vue} from \"ui.vue\";\nimport {Vuex} from \"ui.vue.vuex\";\n\nVue.component('bx-livechat-body-error',\n{\n\tcomputed:\n\t{\n\t\tlocalize()\n\t\t{\n\t\t\treturn  Object.freeze({\n\t\t\t\tBX_LIVECHAT_ERROR_TITLE: this.$root.$bitrixMessages.BX_LIVECHAT_ERROR_TITLE,\n\t\t\t\tBX_LIVECHAT_ERROR_DESC: this.$root.$bitrixMessages.BX_LIVECHAT_ERROR_DESC\n\t\t\t});\n\t\t},\n\t\t...Vuex.mapState({\n\t\t\tapplication: state => state.application\n\t\t}),\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-livechat-body\" key=\"error-body\">\n\t\t\t<div class=\"bx-livechat-warning-window\">\n\t\t\t\t<div class=\"bx-livechat-warning-icon\"></div>\n\t\t\t\t<template v-if=\"application.error.description\"> \n\t\t\t\t\t<div class=\"bx-livechat-help-title bx-livechat-help-title-sm bx-livechat-warning-msg\" v-html=\"application.error.description\"></div>\n\t\t\t\t</template> \n\t\t\t\t<template v-else>\n\t\t\t\t\t<div class=\"bx-livechat-help-title bx-livechat-help-title-md bx-livechat-warning-msg\">{{localize.BX_LIVECHAT_ERROR_TITLE}}</div>\n\t\t\t\t\t<div class=\"bx-livechat-help-title bx-livechat-help-title-sm bx-livechat-warning-msg\">{{localize.BX_LIVECHAT_ERROR_DESC}}</div>\n\t\t\t\t</template> \n\t\t\t</div>\n\t\t</div>\n\t`\n});\n","/**\n * Bitrix OpenLines widget\n * Head component (Vue component)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {Vue} from \"ui.vue\";\nimport {Vuex} from \"ui.vue.vuex\";\nimport { SessionStatus, VoteType } from \"../const\";\nimport {EventType} from \"im.const\";\n\nVue.component('bx-livechat-head',\n{\n\t/**\n\t * @emits 'close'\n\t * @emits 'like'\n\t * @emits 'history'\n\t */\n\tprops:\n\t{\n\t\tisWidgetDisabled: { default: false },\n\t},\n\tmethods:\n\t{\n\t\tclose(event)\n\t\t{\n\t\t\tthis.$emit('close');\n\t\t},\n\t\tlike(event)\n\t\t{\n\t\t\tthis.$emit('like');\n\t\t},\n\t\thistory(event)\n\t\t{\n\t\t\tthis.$emit('history');\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tVoteType: () => VoteType,\n\n\t\tcustomBackgroundStyle(state)\n\t\t{\n\t\t\treturn state.widget.common.styles.backgroundColor? 'background-color: '+state.widget.common.styles.backgroundColor+'!important;': '';\n\t\t},\n\t\tcustomBackgroundOnlineStyle(state)\n\t\t{\n\t\t\treturn state.widget.common.styles.backgroundColor? 'border-color: '+state.widget.common.styles.backgroundColor+'!important;': '';\n\t\t},\n\t\tshowName(state)\n\t\t{\n\t\t\treturn state.widget.dialog.operator.firstName || state.widget.dialog.operator.lastName;\n\t\t},\n\t\tvoteActive(state)\n\t\t{\n\t\t\tif (\n\t\t\t\t!state.widget.common.vote.beforeFinish\n\t\t\t\t&& state.widget.dialog.sessionStatus < SessionStatus.waitClient\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (!state.widget.dialog.sessionClose || state.widget.dialog.sessionClose && state.widget.dialog.userVote === VoteType.none)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tif (state.widget.dialog.sessionClose && state.widget.dialog.userVote !== VoteType.none)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\treturn false;\n\t\t},\n\t\tlocalize()\n\t\t{\n\t\t\treturn Vue.getFilteredPhrases('BX_LIVECHAT_', this.$root.$bitrixMessages);\n\t\t},\n\t\t...Vuex.mapState({\n\t\t\twidget: state => state.widget,\n\t\t\tapplication: state => state.application,\n\t\t})\n\t},\n\twatch:\n\t{\n\t\tshowName(value)\n\t\t{\n\t\t\tif (value)\n\t\t\t{\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tthis.$root.$emit(EventType.dialog.scrollToBottom);\n\t\t\t\t}, 300);\n\t\t\t}\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-livechat-head-wrap\">\n\t\t\t<template v-if=\"isWidgetDisabled\">\n\t\t\t\t<div class=\"bx-livechat-head\" :style=\"customBackgroundStyle\">\n\t\t\t\t\t<div class=\"bx-livechat-title\">{{widget.common.configName || localize.BX_LIVECHAT_TITLE}}</div>\n\t\t\t\t\t<div class=\"bx-livechat-control-box\">\n\t\t\t\t\t\t<button v-if=\"!widget.common.pageMode\" class=\"bx-livechat-control-btn bx-livechat-control-btn-close\" :title=\"localize.BX_LIVECHAT_CLOSE_BUTTON\" @click=\"close\"></button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\t\n\t\t\t</template>\n\t\t\t<template v-else-if=\"application.error.active\">\n\t\t\t\t<div class=\"bx-livechat-head\" :style=\"customBackgroundStyle\">\n\t\t\t\t\t<div class=\"bx-livechat-title\">{{widget.common.configName || localize.BX_LIVECHAT_TITLE}}</div>\n\t\t\t\t\t<div class=\"bx-livechat-control-box\">\n\t\t\t\t\t\t<button v-if=\"!widget.common.pageMode\" class=\"bx-livechat-control-btn bx-livechat-control-btn-close\" :title=\"localize.BX_LIVECHAT_CLOSE_BUTTON\" @click=\"close\"></button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t\t<template v-else-if=\"!widget.common.configId\">\n\t\t\t\t<div class=\"bx-livechat-head\" :style=\"customBackgroundStyle\">\n\t\t\t\t\t<div class=\"bx-livechat-title\">{{widget.common.configName || localize.BX_LIVECHAT_TITLE}}</div>\n\t\t\t\t\t<div class=\"bx-livechat-control-box\">\n\t\t\t\t\t\t<button v-if=\"!widget.common.pageMode\" class=\"bx-livechat-control-btn bx-livechat-control-btn-close\" :title=\"localize.BX_LIVECHAT_CLOSE_BUTTON\" @click=\"close\"></button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</template>\t\t\t\n\t\t\t<template v-else>\n\t\t\t\t<div class=\"bx-livechat-head\" :style=\"customBackgroundStyle\">\n\t\t\t\t\t<template v-if=\"!showName\">\n\t\t\t\t\t\t<div class=\"bx-livechat-title\">{{widget.common.configName || localize.BX_LIVECHAT_TITLE}}</div>\n\t\t\t\t\t</template>\n\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t<div class=\"bx-livechat-user bx-livechat-status-online\">\n\t\t\t\t\t\t\t<template v-if=\"widget.dialog.operator.avatar\">\n\t\t\t\t\t\t\t\t<div class=\"bx-livechat-user-icon\" :style=\"'background-image: url('+encodeURI(widget.dialog.operator.avatar)+')'\">\n\t\t\t\t\t\t\t\t\t<div v-if=\"widget.dialog.operator.online\" class=\"bx-livechat-user-status\" :style=\"customBackgroundOnlineStyle\"></div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t\t\t<div class=\"bx-livechat-user-icon\">\n\t\t\t\t\t\t\t\t\t<div v-if=\"widget.dialog.operator.online\" class=\"bx-livechat-user-status\" :style=\"customBackgroundOnlineStyle\"></div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"bx-livechat-user-info\">\n\t\t\t\t\t\t\t<div class=\"bx-livechat-user-name\">{{widget.dialog.operator.firstName? widget.dialog.operator.firstName: widget.dialog.operator.name}}</div>\n\t\t\t\t\t\t\t<div class=\"bx-livechat-user-position\">{{widget.dialog.operator.workPosition? widget.dialog.operator.workPosition: localize.BX_LIVECHAT_USER}}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</template>\n\t\t\t\t\t<div class=\"bx-livechat-control-box\">\n\t\t\t\t\t\t<span class=\"bx-livechat-control-box-active\" v-if=\"widget.common.dialogStart && widget.dialog.sessionId\">\n\t\t\t\t\t\t\t<button v-if=\"widget.common.vote.enable && voteActive\" :class=\"'bx-livechat-control-btn bx-livechat-control-btn-like bx-livechat-dialog-vote-'+(widget.dialog.userVote)\" :title=\"localize.BX_LIVECHAT_VOTE_BUTTON\" @click=\"like\"></button>\n\t\t\t\t\t\t\t<button class=\"bx-livechat-control-btn bx-livechat-control-btn-mail\" :title=\"localize.BX_LIVECHAT_MAIL_BUTTON_NEW\" @click=\"history\"></button>\n\t\t\t\t\t\t</span>\t\n\t\t\t\t\t\t<button v-if=\"!widget.common.pageMode\" class=\"bx-livechat-control-btn bx-livechat-control-btn-close\" :title=\"localize.BX_LIVECHAT_CLOSE_BUTTON\" @click=\"close\"></button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t</div>\n\t`\n});","/**\n * Bitrix OpenLines widget\n * Body loading component (Vue component)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {Vue} from \"ui.vue\";\n\nVue.component('bx-livechat-body-loading',\n{\n\tcomputed:\n\t{\n\t\tlocalize()\n\t\t{\n\t\t\treturn  Object.freeze({\n\t\t\t\tBX_LIVECHAT_LOADING: this.$root.$bitrixMessages.BX_LIVECHAT_LOADING\n\t\t\t});\n\t\t}\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-livechat-loading-window\">\n\t\t\t<svg class=\"bx-livechat-loading-circular\" viewBox=\"25 25 50 50\">\n\t\t\t\t<circle class=\"bx-livechat-loading-path\" cx=\"50\" cy=\"50\" r=\"20\" fill=\"none\" stroke-miterlimit=\"10\"/>\n\t\t\t\t<circle class=\"bx-livechat-loading-inner-path\" cx=\"50\" cy=\"50\" r=\"20\" fill=\"none\" stroke-miterlimit=\"10\"/>\n\t\t\t</svg>\n\t\t\t<h3 class=\"bx-livechat-help-title bx-livechat-help-title-md bx-livechat-loading-msg\">{{localize.BX_LIVECHAT_LOADING}}</h3>\n\t\t</div>\n\t`\n});","/**\n * Bitrix OpenLines widget\n * Body operators component (Vue component)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {Vue} from \"ui.vue\";\nimport {Vuex} from \"ui.vue.vuex\";\n\nVue.component('bx-livechat-body-operators',\n{\n\tcomputed:\n\t{\n\t\tlocalize()\n\t\t{\n\t\t\treturn Vue.getFilteredPhrases('BX_LIVECHAT_', this.$root.$bitrixMessages);\n\t\t},\n\t\t...Vuex.mapState({\n\t\t\twidget: state => state.widget\n\t\t})\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-livechat-help-container\">\n\t\t\t<transition name=\"bx-livechat-animation-fade\">\n\t\t\t\t<h2 v-if=\"widget.common.online\" key=\"online\" class=\"bx-livechat-help-title bx-livechat-help-title-lg\">{{widget.common.textMessages.bxLivechatOnlineLine1}}<div class=\"bx-livechat-help-subtitle\">{{widget.common.textMessages.bxLivechatOnlineLine2}}</div></h2>\n\t\t\t\t<h2 v-else key=\"offline\" class=\"bx-livechat-help-title bx-livechat-help-title-sm\">{{widget.common.textMessages.bxLivechatOffline}}</h2>\n\t\t\t</transition>\t\n\t\t\t<div class=\"bx-livechat-help-user\">\n\t\t\t\t<template v-for=\"operator in widget.common.operators\">\n\t\t\t\t\t<div class=\"bx-livechat-user\" :key=\"operator.id\">\n\t\t\t\t\t\t<template v-if=\"operator.avatar\">\n\t\t\t\t\t\t\t<div class=\"bx-livechat-user-icon\" :style=\"'background-image: url('+encodeURI(operator.avatar)+')'\"></div>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t\t<div class=\"bx-livechat-user-icon\"></div>\n\t\t\t\t\t\t</template>\t\n\t\t\t\t\t\t<div class=\"bx-livechat-user-info\">\n\t\t\t\t\t\t\t<div class=\"bx-livechat-user-name\">{{operator.firstName? operator.firstName: operator.name}}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</template>\t\n\t\t\t</div>\n\t\t</div>\n\t`\n});","/**\n * Bitrix OpenLines widget\n * Body orientation disabled component (Vue component)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {Vue} from \"ui.vue\";\n\nVue.component('bx-livechat-body-orientation-disabled',\n{\n\tcomputed:\n\t{\n\t\tlocalize()\n\t\t{\n\t\t\treturn  Object.freeze({\n\t\t\t\tBX_LIVECHAT_MOBILE_ROTATE: this.$root.$bitrixMessages.BX_LIVECHAT_MOBILE_ROTATE\n\t\t\t});\n\t\t}\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-livechat-body\" key=\"orientation-head\">\n\t\t\t<div class=\"bx-livechat-mobile-orientation-box\">\n\t\t\t\t<div class=\"bx-livechat-mobile-orientation-icon\"></div>\n\t\t\t\t<div class=\"bx-livechat-mobile-orientation-text\">{{localize.BX_LIVECHAT_MOBILE_ROTATE}}</div>\n\t\t\t</div>\n\t\t</div>\n\t`\n});","/**\n * Bitrix OpenLines widget\n * Form consent component (Vue component)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {Vue} from \"ui.vue\";\nimport {Vuex} from \"ui.vue.vuex\";\n\nVue.component('bx-livechat-form-consent',\n{\n\t/**\n\t * @emits 'agree' {event: object} -- 'event' - click event\n\t * @emits 'disagree' {event: object} -- 'event' - click event\n\t */\n\tcomputed:\n\t{\n\t\tlocalize()\n\t\t{\n\t\t\treturn Vue.getFilteredPhrases('BX_LIVECHAT_', this.$root.$bitrixMessages);\n\t\t},\n\t\t...Vuex.mapState({\n\t\t\twidget: state => state.widget,\n\t\t})\n\t},\n\tmethods:\n\t{\n\t\tagree(event)\n\t\t{\n\t\t\tthis.$emit('agree', {event});\n\t\t},\n\t\tdisagree(event)\n\t\t{\n\t\t\tthis.$emit('disagree', {event});\n\t\t},\n\t\tonShow(element, done)\n\t\t{\n\t\t\telement.classList.add('bx-livechat-consent-window-show');\n\t\t\tdone();\n\t\t},\n\t\tonHide(element, done)\n\t\t{\n\t\t\telement.classList.remove('bx-livechat-consent-window-show');\n\t\t\telement.classList.add('bx-livechat-consent-window-close');\n\t\t\tsetTimeout(function() {\n\t\t\t\tdone();\n\t\t\t}, 400);\n\t\t},\n\t\tonKeyDown(event)\n\t\t{\n\t\t\tif (event.keyCode == 9)\n\t\t\t{\n\t\t\t\tif (event.target === this.$refs.iframe)\n\t\t\t\t{\n\t\t\t\t\tif (event.shiftKey)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$refs.cancel.focus();\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$refs.success.focus();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (event.target === this.$refs.success)\n\t\t\t\t{\n\t\t\t\t\tif (event.shiftKey)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$refs.iframe.focus();\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$refs.cancel.focus();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (event.target === this.$refs.cancel)\n\t\t\t\t{\n\t\t\t\t\tif (event.shiftKey)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$refs.success.focus();\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$refs.iframe.focus();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tevent.preventDefault();\n\t\t\t}\n\t\t\telse if (event.keyCode == 39 || event.keyCode == 37)\n\t\t\t{\n\t\t\t\tif (event.target.nextElementSibling)\n\t\t\t\t{\n\t\t\t\t\tevent.target.nextElementSibling.focus();\n\t\t\t\t}\n\t\t\t\telse if (event.target.previousElementSibling)\n\t\t\t\t{\n\t\t\t\t\tevent.target.previousElementSibling.focus();\n\t\t\t\t}\n\t\t\t\tevent.preventDefault();\n\t\t\t}\n\t\t},\n\t},\n\tdirectives:\n\t{\n\t\tfocus:\n\t\t{\n\t\t\tinserted(element, params)\n\t\t\t{\n\t\t\t\telement.focus();\n\t\t\t}\n\t\t}\n\t},\n\ttemplate: `\n\t\t<transition @enter=\"onShow\" @leave=\"onHide\">\n\t\t\t<template v-if=\"widget.common.showConsent && widget.common.consentUrl\">\n\t\t\t\t<div class=\"bx-livechat-consent-window\">\n\t\t\t\t\t<div class=\"bx-livechat-consent-window-title\">{{localize.BX_LIVECHAT_CONSENT_TITLE}}</div>\n\t\t\t\t\t<div class=\"bx-livechat-consent-window-content\">\n\t\t\t\t\t\t<iframe class=\"bx-livechat-consent-window-content-iframe\" ref=\"iframe\" frameborder=\"0\" marginheight=\"0\"  marginwidth=\"0\" allowtransparency=\"allow-same-origin\" seamless=\"true\" :src=\"widget.common.consentUrl\" @keydown=\"onKeyDown\"></iframe>\n\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\n\t\t\t\t\t<div class=\"bx-livechat-consent-window-btn-box\">\n\t\t\t\t\t\t<button class=\"bx-livechat-btn bx-livechat-btn-success\" ref=\"success\" @click=\"agree\" @keydown=\"onKeyDown\" v-focus>{{localize.BX_LIVECHAT_CONSENT_AGREE}}</button>\n\t\t\t\t\t\t<button class=\"bx-livechat-btn bx-livechat-btn-cancel\" ref=\"cancel\" @click=\"disagree\" @keydown=\"onKeyDown\">{{localize.BX_LIVECHAT_CONSENT_DISAGREE}}</button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t</transition>\n\t`\n});","/**\n * Bitrix OpenLines widget\n * Form history component (Vue component)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport 'ui.icons';\nimport 'ui.forms';\n\nimport {Vue} from \"ui.vue\";\nimport {Vuex} from \"ui.vue.vuex\";\nimport {Utils} from \"im.utils\";\nimport {FormType} from \"../const\";\n\nVue.component('bx-livechat-form-history',\n{\n\tdata()\n\t{\n\t\treturn {\n\t\t\tfieldEmail: '',\n\t\t}\n\t},\n\twatch:\n\t{\n\t\tfieldEmail(value)\n\t\t{\n\t\t\tclearTimeout(this.fieldEmailTimeout);\n\t\t\tthis.fieldEmailTimeout = setTimeout(this.checkEmailField, 300);\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tlocalize()\n\t\t{\n\t\t\treturn Vue.getFilteredPhrases('BX_LIVECHAT_', this.$root.$bitrixMessages);\n\t\t},\n\t\t...Vuex.mapState({\n\t\t\twidget: state => state.widget,\n\t\t})\n\t},\n\tcreated()\n\t{\n\t\tthis.fieldEmail = '' + this.widget.user.email;\n\t},\n\tmethods:\n\t{\n\t\tformShowed()\n\t\t{\n\t\t\tif (!Utils.platform.isMobile())\n\t\t\t{\n\t\t\t\tthis.$refs.emailInput.focus();\n\t\t\t}\n\t\t},\n\t\tsendForm()\n\t\t{\n\t\t\tlet email = this.checkEmailField()? this.fieldEmail: '';\n\t\t\tif (email)\n\t\t\t{\n\t\t\t\tthis.$root.$bitrixWidget.sendForm(FormType.history, {email});\n\t\t\t}\n\n\t\t\tthis.hideForm();\n\t\t},\n\t\thideForm(event)\n\t\t{\n\t\t\tclearTimeout(this.fieldEmailTimeout);\n\t\t\tthis.$parent.hideForm();\n\t\t},\n\t\tonFieldEnterPress(event)\n\t\t{\n\t\t\tthis.sendForm();\n\t\t\tevent.preventDefault();\n\t\t},\n\t\tcheckEmailField()\n\t\t{\n\t\t\tif (this.fieldEmail.match(/^(.*)@(.*)\\.[a-zA-Z]{2,}$/))\n\t\t\t{\n\t\t\t\tif (this.$refs.email)\n\t\t\t\t{\n\t\t\t\t\tthis.$refs.email.classList.remove('ui-ctl-danger');\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (document.activeElement !== this.$refs.emailInput)\n\t\t\t\t{\n\t\t\t\t\tif (this.$refs.email)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$refs.email.classList.add('ui-ctl-danger');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\t\t},\n\t},\n\ttemplate: `\n\t\t<transition enter-active-class=\"bx-livechat-consent-window-show\" leave-active-class=\"bx-livechat-form-close\" @after-enter=\"formShowed\">\n\t\t\t<div class=\"bx-livechat-alert-box bx-livechat-form-show\" key=\"welcome\">\t\n\t\t\t\t<div class=\"bx-livechat-alert-close\" @click=\"hideForm\"></div>\n\t\t\t\t<div class=\"bx-livechat-alert-form-box\">\n\t\t\t\t\t<h4 class=\"bx-livechat-alert-title bx-livechat-alert-title-sm\">{{localize.BX_LIVECHAT_MAIL_TITLE_NEW}}</h4>\n\t\t\t\t\t<div class=\"bx-livechat-form-item ui-ctl ui-ctl-after-icon ui-ctl-w100 ui-ctl-lg\" ref=\"email\">\n\t\t\t\t\t   <div class=\"ui-ctl-after ui-ctl-icon-mail bx-livechat-form-icon\" :title=\"localize.BX_LIVECHAT_FIELD_MAIL_TOOLTIP\"></div>\n\t\t\t\t\t   <input type=\"text\" class=\"ui-ctl-element ui-ctl-textbox\" :placeholder=\"localize.BX_LIVECHAT_FIELD_MAIL\" v-model=\"fieldEmail\" ref=\"emailInput\" @blur=\"checkEmailField\" @keydown.enter=\"onFieldEnterPress\">\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"bx-livechat-btn-box\">\n\t\t\t\t\t\t<button class=\"bx-livechat-btn bx-livechat-btn-success\" @click=\"sendForm\">{{localize.BX_LIVECHAT_MAIL_BUTTON_NEW}}</button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\t\n\t\t</transition>\t\n\t`\n});","/**\n * Bitrix OpenLines widget\n * Form offline component (Vue component)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport 'ui.icons';\nimport 'ui.forms';\n\nimport {Vue} from \"ui.vue\";\nimport {Utils} from \"im.utils\";\nimport {FormType} from \"../const\";\n\nVue.cloneComponent('bx-livechat-form-offline', 'bx-livechat-form-welcome',\n{\n\tmethods:\n\t{\n\t\tformShowed()\n\t\t{\n\t\t\tif (!Utils.platform.isMobile())\n\t\t\t{\n\t\t\t\tthis.$refs.emailInput.focus();\n\t\t\t}\n\t\t},\n\t\tsendForm()\n\t\t{\n\t\t\tlet name = this.fieldName;\n\t\t\tlet email = this.checkEmailField()? this.fieldEmail: '';\n\t\t\tlet phone = this.checkPhoneField()? this.fieldPhone: '';\n\n\t\t\tif (name || email || phone)\n\t\t\t{\n\t\t\t\tthis.$root.$bitrixWidget.sendForm(FormType.offline, {name, email, phone});\n\t\t\t}\n\n\t\t\tthis.hideForm();\n\t\t},\n\t\tonFieldEnterPress(event)\n\t\t{\n\t\t\tif (event.target === this.$refs.emailInput)\n\t\t\t{\n\t\t\t\tthis.showFullForm();\n\t\t\t\tthis.$refs.phoneInput.focus();\n\t\t\t}\n\t\t\telse if (event.target === this.$refs.phoneInput)\n\t\t\t{\n\t\t\t\tthis.$refs.nameInput.focus();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.sendForm();\n\t\t\t}\n\n\t\t\tevent.preventDefault();\n\t\t},\n\t},\n\twatch:\n\t{\n\t\tfieldName()\n\t\t{\n\t\t\tclearTimeout(this.fieldNameTimeout);\n\t\t\tthis.fieldNameTimeout = setTimeout(this.checkNameField, 300);\n\t\t},\n\t\tfieldEmail()\n\t\t{\n\t\t\tclearTimeout(this.showFormTimeout);\n\t\t\tthis.showFormTimeout = setTimeout(this.showFullForm, 1000);\n\n\t\t\tclearTimeout(this.fieldEmailTimeout);\n\t\t\tthis.fieldEmailTimeout = setTimeout(this.checkEmailField, 300);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<transition enter-active-class=\"bx-livechat-consent-window-show\" leave-active-class=\"bx-livechat-form-close\" @after-enter=\"formShowed\">\n\t\t\t<div class=\"bx-livechat-alert-box bx-livechat-form-show\" key=\"welcome\">\t\n\t\t\t\t<div class=\"bx-livechat-alert-close\" @click=\"hideForm\"></div>\n\t\t\t\t<div class=\"bx-livechat-alert-form-box\">\n\t\t\t\t\t<h4 class=\"bx-livechat-alert-title bx-livechat-alert-title-sm\">{{localize.BX_LIVECHAT_OFFLINE_TITLE}}</h4>\n\t\t\t\t\t<div class=\"bx-livechat-form-item ui-ctl ui-ctl-after-icon ui-ctl-w100 ui-ctl-lg\" ref=\"email\">\n\t\t\t\t\t   <div class=\"ui-ctl-after ui-ctl-icon-mail bx-livechat-form-icon\" :title=\"localize.BX_LIVECHAT_FIELD_MAIL_TOOLTIP\"></div>\n\t\t\t\t\t   <input type=\"text\" class=\"ui-ctl-element ui-ctl-textbox\" :placeholder=\"localize.BX_LIVECHAT_FIELD_MAIL\" v-model=\"fieldEmail\" ref=\"emailInput\" @blur=\"checkEmailField\" @keydown.enter=\"onFieldEnterPress\">\n\t\t\t\t\t</div>\n\t\t\t\t\t<div :class=\"['bx-livechat-form-short', {\n\t\t\t\t\t\t'bx-livechat-form-full': isFullForm,\n\t\t\t\t\t}]\">\n\t\t\t\t\t\t<div class=\"bx-livechat-form-item ui-ctl ui-ctl-after-icon ui-ctl-w100 ui-ctl-lg\" ref=\"phone\">\n\t\t\t\t\t\t   <div class=\"ui-ctl-after ui-ctl-icon-phone bx-livechat-form-icon\" :title=\"localize.BX_LIVECHAT_FIELD_PHONE_TOOLTIP\"></div>\n\t\t\t\t\t\t   <input type=\"text\" class=\"ui-ctl-element ui-ctl-textbox\" :placeholder=\"localize.BX_LIVECHAT_FIELD_PHONE\" v-model=\"fieldPhone\" ref=\"phoneInput\" @blur=\"checkPhoneField\" @keydown.enter=\"onFieldEnterPress\">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"bx-livechat-form-item ui-ctl ui-ctl-w100 ui-ctl-lg\" ref=\"name\">\n\t\t\t\t\t\t   <input type=\"text\" class=\"ui-ctl-element ui-ctl-textbox\" :placeholder=\"localize.BX_LIVECHAT_FIELD_NAME\" v-model=\"fieldName\" ref=\"nameInput\" @blur=\"checkNameField\" @keydown.enter=\"onFieldEnterPress\"  @keydown.tab=\"onFieldEnterPress\">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"bx-livechat-btn-box\">\n\t\t\t\t\t\t\t<button class=\"bx-livechat-btn bx-livechat-btn-success\" @click=\"sendForm\">{{localize.BX_LIVECHAT_ABOUT_SEND}}</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\t\n\t\t</transition>\t\n\t`\n});","/**\n * Bitrix OpenLines widget\n * Form vote component (Vue component)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {Vue} from \"ui.vue\";\nimport {Vuex} from \"ui.vue.vuex\";\nimport {VoteType, FormType} from \"../const\";\n\nVue.component('bx-livechat-form-vote',\n{\n\tcomputed:\n\t{\n\t\tVoteType: () => VoteType,\n\n\t\tlocalize()\n\t\t{\n\t\t\treturn Vue.getFilteredPhrases('BX_LIVECHAT_', this.$root.$bitrixMessages);\n\t\t},\n\t\t...Vuex.mapState({\n\t\t\twidget: state => state.widget,\n\t\t})\n\t},\n\tmethods: {\n\t\tuserVote(vote)\n\t\t{\n\t\t\tthis.$store.commit('widget/common', {showForm: FormType.none});\n\t\t\tthis.$store.commit('widget/dialog', {userVote: vote});\n\n\t\t\tthis.$root.$bitrixWidget.sendDialogVote(vote);\n\t\t},\n\t\thideForm(event)\n\t\t{\n\t\t\tthis.$parent.hideForm();\n\t\t},\n\t},\n\ttemplate: `\n\t\t<transition enter-active-class=\"bx-livechat-consent-window-show\" leave-active-class=\"bx-livechat-form-close\">\n\t\t\t<div class=\"bx-livechat-alert-box bx-livechat-form-rate-show\" key=\"vote\">\n\t\t\t\t<div class=\"bx-livechat-alert-close\" @click=\"hideForm\"></div>\n\t\t\t\t<div class=\"bx-livechat-alert-rate-box\">\n\t\t\t\t\t<h4 class=\"bx-livechat-alert-title bx-livechat-alert-title-mdl\">{{widget.common.vote.messageText}}</h4>\n\t\t\t\t\t<div class=\"bx-livechat-btn-box\">\n\t\t\t\t\t\t<button class=\"bx-livechat-btn bx-livechat-btn-like\" @click=\"userVote(VoteType.like)\" :title=\"widget.common.vote.messageLike\"></button>\n\t\t\t\t\t\t<button class=\"bx-livechat-btn bx-livechat-btn-dislike\" @click=\"userVote(VoteType.dislike)\" :title=\"widget.common.vote.messageDislike\"></button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</transition>\t\n\t`\n});","/**\n * Bitrix OpenLines widget\n * Form welcome component (Vue component)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport 'ui.icons';\nimport 'ui.forms';\n\nimport {Vue} from \"ui.vue\";\nimport {Vuex} from \"ui.vue.vuex\";\nimport {Utils} from \"im.utils\";\nimport {FormType} from \"../const\";\n\nVue.component('bx-livechat-form-welcome',\n{\n\tdata()\n\t{\n\t\treturn {\n\t\t\tfieldName: '',\n\t\t\tfieldEmail: '',\n\t\t\tfieldPhone: '',\n\t\t\tisFullForm: Utils.platform.isMobile()\n\t\t}\n\t},\n\twatch:\n\t{\n\t\tfieldName()\n\t\t{\n\t\t\tclearTimeout(this.showFormTimeout);\n\t\t\tthis.showFormTimeout = setTimeout(this.showFullForm, 1000);\n\n\t\t\tclearTimeout(this.fieldNameTimeout);\n\t\t\tthis.fieldNameTimeout = setTimeout(this.checkNameField, 300);\n\t\t},\n\t\tfieldEmail(value)\n\t\t{\n\t\t\tclearTimeout(this.fieldEmailTimeout);\n\t\t\tthis.fieldEmailTimeout = setTimeout(this.checkEmailField, 300);\n\t\t},\n\t\tfieldPhone(value)\n\t\t{\n\t\t\tclearTimeout(this.fieldPhoneTimeout);\n\t\t\tthis.fieldPhoneTimeout = setTimeout(this.checkPhoneField, 300);\n\t\t}\n\t},\n\tcomputed:\n\t{\n\t\tlocalize()\n\t\t{\n\t\t\treturn Vue.getFilteredPhrases('BX_LIVECHAT_', this.$root.$bitrixMessages);\n\t\t},\n\t\t...Vuex.mapState({\n\t\t\twidget: state => state.widget,\n\t\t})\n\t},\n\tcreated()\n\t{\n\t\tthis.fieldName = '' + this.widget.user.name;\n\t\tthis.fieldEmail = '' + this.widget.user.email;\n\t\tthis.fieldPhone = '' + this.widget.user.phone;\n\t},\n\tmethods:\n\t{\n\t\tformShowed()\n\t\t{\n\t\t\tif (!Utils.platform.isMobile())\n\t\t\t{\n\t\t\t\tthis.$refs.nameInput.focus();\n\t\t\t}\n\t\t},\n\t\tshowFullForm()\n\t\t{\n\t\t\tclearTimeout(this.showFormTimeout);\n\t\t\tthis.isFullForm = true;\n\t\t},\n\t\tsendForm()\n\t\t{\n\t\t\tlet name = this.fieldName;\n\t\t\tlet email = this.checkEmailField()? this.fieldEmail: '';\n\t\t\tlet phone = this.checkPhoneField()? this.fieldPhone: '';\n\n\t\t\tif (name || email || phone)\n\t\t\t{\n\t\t\t\tthis.$root.$bitrixWidget.sendForm(FormType.welcome, {name, email, phone});\n\t\t\t}\n\n\t\t\tthis.hideForm();\n\t\t},\n\t\thideForm(event)\n\t\t{\n\t\t\tclearTimeout(this.showFormTimeout);\n\t\t\tclearTimeout(this.fieldNameTimeout);\n\t\t\tclearTimeout(this.fieldEmailTimeout);\n\t\t\tclearTimeout(this.fieldPhoneTimeout);\n\n\t\t\tthis.$parent.hideForm();\n\t\t},\n\t\tonFieldEnterPress(event)\n\t\t{\n\t\t\tif (event.target === this.$refs.nameInput)\n\t\t\t{\n\t\t\t\tthis.showFullForm();\n\t\t\t\tthis.$refs.emailInput.focus();\n\t\t\t}\n\t\t\telse if (event.target === this.$refs.emailInput)\n\t\t\t{\n\t\t\t\tthis.$refs.phoneInput.focus();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.sendForm();\n\t\t\t}\n\n\t\t\tevent.preventDefault();\n\t\t},\n\t\tcheckNameField()\n\t\t{\n\t\t\tif (this.fieldName.length > 0)\n\t\t\t{\n\t\t\t\tif (this.$refs.name)\n\t\t\t\t{\n\t\t\t\t\tthis.$refs.name.classList.remove('ui-ctl-danger');\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (document.activeElement !== this.$refs.nameInput)\n\t\t\t\t{\n\t\t\t\t\tif (this.$refs.name)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$refs.name.classList.add('ui-ctl-danger');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\t\t},\n\t\tcheckEmailField()\n\t\t{\n\t\t\tif (this.fieldEmail.match(/^(.*)@(.*)\\.[a-zA-Z]{2,}$/))\n\t\t\t{\n\t\t\t\tif (this.$refs.email)\n\t\t\t\t{\n\t\t\t\t\tthis.$refs.email.classList.remove('ui-ctl-danger');\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (document.activeElement !== this.$refs.emailInput)\n\t\t\t\t{\n\t\t\t\t\tif (this.$refs.email)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$refs.email.classList.add('ui-ctl-danger');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\t\t},\n\t\tcheckPhoneField()\n\t\t{\n\t\t\tif (this.fieldPhone.match(/^(\\s*)?(\\+)?([- _():=+]?\\d[- _():=+]?){10,14}(\\s*)?$/))\n\t\t\t{\n\t\t\t\tif (this.$refs.phone)\n\t\t\t\t{\n\t\t\t\t\tthis.$refs.phone.classList.remove('ui-ctl-danger');\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (document.activeElement !== this.$refs.phoneInput)\n\t\t\t\t{\n\t\t\t\t\tif (this.$refs.phone)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$refs.phone.classList.add('ui-ctl-danger');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t},\n\ttemplate: `\n\t\t<transition enter-active-class=\"bx-livechat-consent-window-show\" leave-active-class=\"bx-livechat-form-close\" @after-enter=\"formShowed\">\n\t\t\t<div class=\"bx-livechat-alert-box bx-livechat-form-show\" key=\"welcome\">\t\n\t\t\t\t<div class=\"bx-livechat-alert-close\" @click=\"hideForm\"></div>\n\t\t\t\t<div class=\"bx-livechat-alert-form-box\">\n\t\t\t\t\t<h4 class=\"bx-livechat-alert-title bx-livechat-alert-title-sm\">{{localize.BX_LIVECHAT_ABOUT_TITLE}}</h4>\n\t\t\t\t\t<div class=\"bx-livechat-form-item ui-ctl ui-ctl-w100 ui-ctl-lg\" ref=\"name\">\n\t\t\t\t\t   <input type=\"text\" class=\"ui-ctl-element ui-ctl-textbox\" :placeholder=\"localize.BX_LIVECHAT_FIELD_NAME\" v-model=\"fieldName\" ref=\"nameInput\" @blur=\"checkNameField\" @keydown.enter=\"onFieldEnterPress\"  @keydown.tab=\"onFieldEnterPress\">\n\t\t\t\t\t</div>\n\t\t\t\t\t<div :class=\"['bx-livechat-form-short', {\n\t\t\t\t\t\t'bx-livechat-form-full': isFullForm,\n\t\t\t\t\t}]\">\n\t\t\t\t\t\t<div class=\"bx-livechat-form-item ui-ctl ui-ctl-after-icon ui-ctl-w100 ui-ctl-lg\" ref=\"email\">\n\t\t\t\t\t\t   <div class=\"ui-ctl-after ui-ctl-icon-mail bx-livechat-form-icon\" :title=\"localize.BX_LIVECHAT_FIELD_MAIL_TOOLTIP\"></div>\n\t\t\t\t\t\t   <input type=\"text\" class=\"ui-ctl-element ui-ctl-textbox\" :placeholder=\"localize.BX_LIVECHAT_FIELD_MAIL\" v-model=\"fieldEmail\" ref=\"emailInput\" @blur=\"checkEmailField\" @keydown.enter=\"onFieldEnterPress\">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"bx-livechat-form-item ui-ctl ui-ctl-after-icon ui-ctl-w100 ui-ctl-lg\" ref=\"phone\">\n\t\t\t\t\t\t   <div class=\"ui-ctl-after ui-ctl-icon-phone bx-livechat-form-icon\" :title=\"localize.BX_LIVECHAT_FIELD_PHONE_TOOLTIP\"></div>\n\t\t\t\t\t\t   <input type=\"text\" class=\"ui-ctl-element ui-ctl-textbox\" :placeholder=\"localize.BX_LIVECHAT_FIELD_PHONE\" v-model=\"fieldPhone\" ref=\"phoneInput\" @blur=\"checkPhoneField\" @keydown.enter=\"onFieldEnterPress\">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"bx-livechat-btn-box\">\n\t\t\t\t\t\t\t<button class=\"bx-livechat-btn bx-livechat-btn-success\" @click=\"sendForm\">{{localize.BX_LIVECHAT_ABOUT_SEND}}</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\t\n\t\t</transition>\t\n\t`\n});","/**\n * Bitrix OpenLines widget\n * Smiles component (Vue component)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {Vue} from \"ui.vue\";\n\nVue.cloneComponent('bx-livechat-smiles', 'bx-smiles',\n{\n\tmethods:\n\t{\n\t\thideForm(event)\n\t\t{\n\t\t\tthis.$parent.hideForm();\n\t\t},\n\t},\n\ttemplate: `\n\t\t<transition enter-active-class=\"bx-livechat-consent-window-show\" leave-active-class=\"bx-livechat-form-close\">\n\t\t\t<div class=\"bx-livechat-alert-box bx-livechat-alert-box-zero-padding bx-livechat-form-show\" key=\"vote\">\n\t\t\t\t<div class=\"bx-livechat-alert-close\" @click=\"hideForm\"></div>\n\t\t\t\t<div class=\"bx-livechat-alert-smiles-box\">\n\t\t\t\t\t#PARENT_TEMPLATE#\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</transition>\n\t`\n});","/**\n * Bitrix OpenLines widget\n * Footer component (Vue component)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {Vue} from \"ui.vue\";\nimport {Vuex} from \"ui.vue.vuex\";\n\nVue.component('bx-livechat-footer',\n{\n\tcomputed:\n\t{\n\t\tlocalize()\n\t\t{\n\t\t\treturn Vue.getFilteredPhrases('BX_LIVECHAT_COPYRIGHT_', this.$root.$bitrixMessages);\n\t\t},\n\t\t...Vuex.mapState({\n\t\t\twidget: state => state.widget\n\t\t})\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-livechat-copyright\">\t\n\t\t\t<template v-if=\"widget.common.copyrightUrl\">\n\t\t\t\t<a :href=\"widget.common.copyrightUrl\" target=\"_blank\">\n\t\t\t\t\t<span class=\"bx-livechat-logo-name\">{{localize.BX_LIVECHAT_COPYRIGHT_TEXT}}</span>\n\t\t\t\t\t<span class=\"bx-livechat-logo-icon\"></span>\n\t\t\t\t</a>\n\t\t\t</template>\n\t\t\t<template v-else>\n\t\t\t\t<span class=\"bx-livechat-logo-name\">{{localize.BX_LIVECHAT_COPYRIGHT_TEXT}}</span>\n\t\t\t\t<span class=\"bx-livechat-logo-icon\"></span>\n\t\t\t</template>\n\t\t</div>\n\t`\n});\n","/**\n * Bitrix OpenLines widget\n * Widget component & controller\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\n// core\n\nimport 'main.polyfill.customevent';\n\n// vue components\nimport 'pull.components.status';\nimport 'ui.vue.components.smiles';\nimport 'im.component.dialog';\nimport 'im.component.textarea';\nimport 'im.component.quotepanel';\nimport 'imopenlines.component.message';\nimport 'imopenlines.component.form';\n\n// widget files\nimport \"./widget.css\";\nimport {VoteType, LocationStyle, SubscriptionType} from \"./const\";\n\n// widget utils\nimport {Cookie} from \"./utils/cookie\";\nimport {WidgetPublicManager} from \"./public\";\n\n// widget components\n\nimport \"./component/bx-livechat\";\nimport \"./component/bx-livechat-body-error\";\nimport \"./component/bx-livechat-body-head\";\nimport \"./component/bx-livechat-body-loading\";\nimport \"./component/bx-livechat-body-operators\";\nimport \"./component/bx-livechat-body-orientation-disabled\";\nimport \"./component/bx-livechat-form-consent\";\nimport \"./component/bx-livechat-form-history\";\nimport \"./component/bx-livechat-form-offline\";\nimport \"./component/bx-livechat-form-vote\";\nimport \"./component/bx-livechat-form-welcome\";\nimport \"./component/bx-livechat-smiles\";\nimport \"./component/bx-livechat-footer\";\n\n\nBX.LiveChatWidget = WidgetPublicManager;\nBX.LiveChatWidget.VoteType = VoteType;\nBX.LiveChatWidget.SubscriptionType = SubscriptionType;\nBX.LiveChatWidget.LocationStyle = LocationStyle;\nBX.LiveChatWidget.Cookie = Cookie;\n\nwindow.dispatchEvent(new CustomEvent('onBitrixLiveChatSourceLoaded', {detail: {}}));"],"names":["GetObjectValues","source","destination","value","hasOwnProperty","push","VoteType","Object","freeze","none","like","dislike","LanguageType","russian","ukraine","world","FormType","smile","consent","welcome","offline","history","LocationType","topLeft","topMiddle","topBottom","bottomLeft","bottomMiddle","bottomRight","LocationStyle","SubscriptionType","configLoaded","widgetOpen","widgetClose","sessionStart","sessionOperatorChange","sessionFinish","operatorMessage","userForm","userMessage","userFile","userVote","every","SubscriptionTypeCheck","RestMethod","widgetUserRegister","widgetConfigGet","widgetDialogGet","widgetUserGet","widgetUserConsentApply","widgetVoteSend","widgetFormSend","pullServerTime","pullConfigGet","RestMethodCheck","RestAuth","guest","SessionStatus","new","skip","answer","client","clientAfterOperator","operator","waitClient","close","spam","duplicate","silentlyClose","Cookie","get","siteId","name","cookieName","navigator","cookieEnabled","result","document","cookie","match","RegExp","replace","decodeURIComponent","LocalStorage","isEnabled","undefined","window","BX","LiveChatCookie","set","options","expires","currentDate","Date","setTime","getTime","toUTCString","encodeURIComponent","updatedCookie","propertyName","propertyValue","WidgetModel","common","configId","configName","host","getVariable","location","protocol","pageMode","copyright","copyrightUrl","styles","backgroundColor","iconColor","vote","enable","beforeFinish","messageText","messageLike","messageDislike","textMessages","bxLivechatOnlineLine1","bxLivechatOnlineLine2","bxLivechatOffline","online","operators","connectors","showForm","showed","reopen","dragged","textareaHeight","showConsent","consentUrl","dialogStart","dialog","sessionId","sessionClose","sessionStatus","userConsent","firstName","lastName","workPosition","avatar","user","id","hash","email","phone","www","gender","position","state","payload","Utils","types","isPlainObject","device","isMobile","Array","isSaveNeeded","saveState","toString","startsWith","path","VuexBuilderModel","WidgetRestClient","params","queryAuthRestore","setAuthId","restClient","RestClient","endpoint","queryParams","cors","authId","customAuthId","livechat_auth_id","console","error","livechat_custom_auth_id","method","callback","sendCallback","logTag","getLogTrackingParams","promise","Promise","callMethod","then","fulfill","catch","ex","warn","error_description","reject","calls","bHaltOnError","resultCallback","callBatch","WidgetRestAnswerHandler","props","widget","data","store","commit","disk","addLocalize","serverVariables","getSiteId","previousData","messages","collection","controller","getChatId","chatId","dialogId","fields","entityType","type","dispatch","userId","diskFolderId","length","isDialogStart","messageId","message","messagesQueue","filter","el","sendEvent","text","BaseRestAnswerHandler","WidgetImPullCommandHandler","extra","command","senderId","getUserId","onceShowed","open","WidgetImopenlinesPullCommandHandler","Widget","ready","widgetDataRequested","code","language","buttonInstance","useBitrixLocalize","placeholder","getElementById","inited","initEventFired","userRegisterData","customData","localize","subscribers","dateFormat","configRequestXhr","rootNode","createElement","body","firstChild","insertBefore","appendChild","template","addEventListener","orientation","getOrientation","application","DeviceType","mobile","DeviceOrientation","horizontal","activeElement","blur","widgetVariables","getHost","getLocalize","ApplicationController","applicationVariables","languageId","desktop","messageLimit","getDefaultMessageLimit","saveException","messageExtraCount","cacheDialogues","browser","isIe","VuexBuilder","addModel","create","setVariables","ApplicationModel","DialoguesModel","useDatabase","MessagesModel","FilesModel","default","UsersModel","setDatabaseConfig","DatabaseType","localStorage","build","storeCollector","builder","initRestClient","setStore","setRestClient","setPrepareFilesBeforeSaveFunction","prepareFileData","bind","imRestAnswer","ImRestAnswerHandler","widgetRestAnswer","dispatchEvent","CustomEvent","detail","widgetCode","widgetHost","callStartFlag","start","callOpenFlag","isUserRegistered","getUserHash","isReady","getUserHashCookie","requestData","fireInitEvent","isConfigDataLoaded","xhr","clearError","executeRestAnswer","setError","requestDataSend","abort","query","config_id","getConfigId","trace_data","getCrmTraceData","custom_data","getCustomData","ImRestMethodHandler","imChatGet","ImRestMethod","dialog_id","imDialogMessagesGetInit","imDialogMessagesGet","chat_id","limit","getRequestMessageLimit","convert_text","getUserRegisterFields","isUserAgreeConsent","consent_url","href","response","configGet","userGetResult","chatGetResult","dialogGetResult","dialogMessagesGetResult","getDialogId","userRegisterResult","timeShift","serverTimeResult","Math","floor","config","pullConfigResult","server","startPullClient","processSendMessages","getDialogData","execute","files","isArray","map","file","md5","urlParam","urlPreview","urlShow","urlDownload","platform","isIos","version","getIosVersion","pullClient","isConnected","scheduleReconnect","resolve","PullClient","serverEnabled","configTimestamp","config_timestamp","skipCheckRevision","subscribe","ImPullCommandHandler","Status","eventStatusInteraction","pullConnectedFirstTime","status","PullStatus","Online","$root","$bitrixPullClient","$emit","skipReconnectToLastSession","stop","CloseReasons","MANUAL","restart","pullRequestMessage","getDialogUnread","readMessage","Offline","innerHTML","widgetContext","Vue","beforeCreate","$bitrixWidget","$bitrixController","$bitrixRestClient","$bitrixMessages","destroyed","templateAttached","setTemplateEngine","$destroy","mutateComponent","Logger","isUnreadMessagesLoaded","sendMessage","FILE_ID","authorId","sending","fileInput","size","fileType","addMessage","extension","split","splice","image","FileStatus","upload","progress","authorName","getCurrentUser","fileId","element","find","forEach","sendMessageWithFile","stopWriting","quiteId","getters","quoteMessage","newMessage","join","quoteMessageClear","imMessageAdd","timMessageType","getDiskFolderId","imDiskFileUpload","NAME","fileContent","generateUniqueName","imDiskFolderGet","fileError","diskFolderGet","diskId","diskFileUpload","ID","wait","fileCommit","uploadId","imDiskFileCommit","retry","upload_id","template_id","file_template_id","lastId","EventType","requestHistoryResult","count","requestUnreadResult","imDialogRead","message_id","imDialogMessagesGetUnread","first_id","dialogMessageUnread","firstMessageId","setSendingMessageFlag","quoteId","reaction","reactMessage","action","botId","imMessageCommand","getSessionId","info","toUpperCase","form","isSessionActive","requestWidgetData","clearTimeout","openTimeout","openFromButton","wm","showById","checkBrowserVersion","BX_LIVECHAT_OLD_BROWSER","versionCompare","alert","BX_LIVECHAT_OLD_VUE","BX_LIVECHAT_OLD_VUE_DEV","isWidgetDataRequested","attachTemplate","onWidgetClose","detachTemplate","traceData","getTrace","b24Tracker","MESSAGE","BX_LIVECHAT_EXTRA_SITE","JSON","stringify","dialogues","userHash","validUserFields","field","indexOf","setNewAuthToken","authToken","clearModelState","concat","description","localizeDescription","endsWith","active","includes","phrases","phrase","WidgetPublicManager","developerInfo","__privateMethods__","__createLegacyMethods","showNotification","getUserData","setUserRegisterData","setCustomData","mutateTemplateComponent","LiveChat","sourceHref","sourceDomain","hostname","port","openLiveChat","closeLiveChat","eventName","handler","event","origin","setCookie","getCookie","BxLiveChatInit","firstMessage","BxLiveChatLoader","component","viewPortMetaSiteNode","viewPortMetaWidgetNode","storedMessage","storedFile","textareaFocused","textareaDrag","textareaMinimumHeight","textareaMaximumHeight","created","onCreated","onWindowKeyDown","$on","onRequestShowForm","beforeDestroy","removeEventListener","$off","onTextareaDragEventRemove","computed","textareaHeightStyle","getFilteredPhrases","widgetMobileDisabled","userAgent","screen","availHeight","widgetClassName","className","isSafari","isMac","isDarkColor","showMessageDialog","messageCollection","quotePanelData","title","color","$store","textConverted","BX_LIVECHAT_FILE_MESSAGE","Vuex","mapState","watch","log","methods","onBeforeClose","showLikeForm","showFormTimeout","showWelcomeForm","showOfflineForm","showHistoryForm","hideForm","showConsentWidow","agreeConsentWidow","sendConsentDecision","onTextareaSend","focus","onTextareaFileSelected","textarea","disagreeConsentWidow","insertText","logEvent","from","head","getElementsByTagName","removeChild","contentWidth","offsetWidth","innerWidth","setAttribute","classList","add","isSafariBased","setTimeout","remove","onAfterClose","delayed","onDialogRequestHistory","getDialogHistory","onDialogRequestUnread","onDialogMessageClickByUserName","onDialogMessageClickByUploadCancel","cancelUploadFile","onDialogMessageClickByKeyboardButton","execMessageKeyboardCommand","onDialogMessageClickByCommand","onDialogMessageMenuClick","onDialogMessageRetryClick","retrySendMessage","onDialogReadMessage","onDialogQuoteMessage","onDialogMessageReactionSet","onDialogClick","onTextareaWrites","startWriting","onTextareaFocus","onTextareaFocusScrollTimeout","onWindowScroll","onTextareaBlur","$nextTick","scrollToBottom","force","onTextareaStartDrag","changedTouches","textareaDragCursorStartPoint","clientY","textareaDragHeightStartPoint","onTextareaDragEventAdd","onTextareaContinueDrag","textareaDragCursorControlPoint","max","min","onTextareaStopDrag","maxFileSize","BX_LIVECHAT_FILE_SIZE_EXCEEDED","round","uploadFile","onTextareaAppButtonClick","appId","onPullRequestConfig","recoverPullConnection","onSmilesSelectSmile","onSmilesSelectSet","onQuotePanelClose","keyCode","preventDefault","stopPropagation","onWindowScrollTimeout","BX_LIVECHAT_ERROR_TITLE","BX_LIVECHAT_ERROR_DESC","isWidgetDisabled","customBackgroundStyle","customBackgroundOnlineStyle","showName","voteActive","BX_LIVECHAT_LOADING","BX_LIVECHAT_MOBILE_ROTATE","agree","disagree","onShow","done","onHide","onKeyDown","target","$refs","iframe","shiftKey","cancel","success","nextElementSibling","previousElementSibling","directives","inserted","fieldEmail","fieldEmailTimeout","checkEmailField","formShowed","emailInput","sendForm","$parent","onFieldEnterPress","cloneComponent","fieldName","checkPhoneField","fieldPhone","showFullForm","phoneInput","nameInput","fieldNameTimeout","checkNameField","sendDialogVote","isFullForm","fieldPhoneTimeout","LiveChatWidget"],"mappings":"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"}