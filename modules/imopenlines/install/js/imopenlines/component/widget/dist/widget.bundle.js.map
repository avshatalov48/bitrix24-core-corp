{"version":3,"file":"widget.bundle.js","sources":["../src/const.js","../src/model.js","../src/utils/restclient.js","../src/rest.handler.js","../src/pull.handler.js","../src/widget.js","../src/public.js","../src/component/bx-livechat.js","../src/component/bx-livechat-body-error.js","../src/component/bx-livechat-body-head.js","../src/component/bx-livechat-body-loading.js","../src/component/bx-livechat-body-operators.js","../src/component/bx-livechat-body-orientation-disabled.js","../src/component/bx-livechat-form-consent.js","../src/component/bx-livechat-form-history.js","../src/component/bx-livechat-form-offline.js","../src/component/bx-livechat-form-vote.js","../src/component/bx-livechat-form-welcome.js","../src/component/bx-livechat-smiles.js","../src/registry.js"],"sourcesContent":["/**\n * Bitrix OpenLines widget\n * Widget constants\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nfunction GetObjectValues(source)\n{\n\tconst destination = [];\n\tfor (let value in source)\n\t{\n\t\tif (source.hasOwnProperty(value))\n\t\t{\n\t\t\tdestination.push(source[value]);\n\t\t}\n\t}\n\treturn destination;\n}\n\n/* region 01. Constants */\n\nexport const VoteType = Object.freeze({\n\tnone: 'none',\n\tlike: 'like',\n\tdislike: 'dislike',\n});\n\nexport const LanguageType = Object.freeze({\n\trussian: 'ru',\n\tukraine: 'ua',\n\tworld: 'en',\n});\n\nexport const FormType = Object.freeze({\n\tnone: 'none',\n\tlike: 'like',\n\tsmile: 'smile',\n\tconsent: 'consent',\n\twelcome: 'welcome',\n\toffline: 'offline',\n\thistory: 'history',\n});\n\nexport const LocationType = Object.freeze({\n\ttopLeft: 1,\n\ttopMiddle: 2,\n\ttopBottom: 3,\n\tbottomLeft: 6,\n\tbottomMiddle: 5,\n\tbottomRight: 4,\n});\n\nexport const LocationStyle = Object.freeze({\n\t1: 'top-left',\n\t2: 'top-center',\n\t3: 'top-right',\n\t6: 'bottom-left',\n\t5: 'bottom-center',\n\t4: 'bottom-right',\n});\n\nexport const SubscriptionType = Object.freeze({\n\tconfigLoaded: 'configLoaded',\n\twidgetOpen: 'widgetOpen',\n\twidgetClose: 'widgetClose',\n\tsessionStart: 'sessionStart',\n\tsessionOperatorChange: 'sessionOperatorChange',\n\tsessionFinish: 'sessionFinish',\n\toperatorMessage: 'operatorMessage',\n\tuserForm: 'userForm',\n\tuserMessage: 'userMessage',\n\tuserFile: 'userFile',\n\tuserVote: 'userVote',\n\tevery: 'every',\n});\nexport const SubscriptionTypeCheck = GetObjectValues(SubscriptionType);\n\nexport const RestMethod = Object.freeze({\n\twidgetUserRegister: 'imopenlines.widget.user.register',\n\twidgetConfigGet: 'imopenlines.widget.config.get',\n\twidgetDialogGet: 'imopenlines.widget.dialog.get',\n\twidgetUserGet: 'imopenlines.widget.user.get',\n\twidgetUserConsentApply: 'imopenlines.widget.user.consent.apply',\n\twidgetVoteSend: 'imopenlines.widget.vote.send',\n\twidgetFormSend: 'imopenlines.widget.form.send',\n\twidgetActionSend: 'imopenlines.widget.action.send',\n\tpullServerTime: 'server.time',\n\tpullConfigGet: 'pull.config.get',\n});\nexport const RestMethodCheck = GetObjectValues(RestMethod);\n\nexport const RestAuth = Object.freeze({\n\tguest: 'guest',\n});\n\nexport const SessionStatus = Object.freeze({\n\tnew: 0,\n\tskip: 5,\n\tanswer: 10,\n\tclient: 20,\n\tclientAfterOperator: 25,\n\toperator: 40,\n\twaitClient: 50,\n\tclose: 60,\n\tspam: 65,\n\tduplicate: 69,\n\tsilentlyClose: 75,\n});","/**\n * Bitrix OpenLines widget\n * Widget model (Vuex Builder model)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {VuexBuilderModel} from 'ui.vue.vuex';\n\nimport {Utils} from 'im.lib.utils';\nimport {Cookie} from \"im.lib.cookie\";\nimport {FormType, LocationStyle, LocationType, VoteType} from \"./const\";\n\nexport class WidgetModel extends VuexBuilderModel\n{\n\t/**\n\t * @inheritDoc\n\t */\n\tgetName()\n\t{\n\t\treturn 'widget';\n\t}\n\n\tgetState()\n\t{\n\t\treturn {\n\t\t\tcommon:\n\t\t\t{\n\t\t\t\tconfigId: 0,\n\t\t\t\tconfigName: '',\n\t\t\t\thost: this.getVariable('common.host', location.protocol+'//'+location.host),\n\t\t\t\tpageMode: this.getVariable('common.pageMode', false),\n\t\t\t\tcopyright: this.getVariable('common.copyright', true),\n\t\t\t\tcopyrightUrl: this.getVariable('common.copyrightUrl', 'https://bitrix24.com'),\n\t\t\t\tlocation: this.getVariable('common.location', LocationType.bottomRight),\n\t\t\t\tstyles: {\n\t\t\t\t\tbackgroundColor: this.getVariable('styles.backgroundColor', '#17a3ea'),\n\t\t\t\t\ticonColor: this.getVariable('styles.iconColor', '#ffffff')\n\t\t\t\t},\n\t\t\t\tvote: {\n\t\t\t\t\tenable: false,\n\t\t\t\t\tbeforeFinish: true,\n\t\t\t\t\tmessageText: this.getVariable('vote.messageText', ''),\n\t\t\t\t\tmessageLike: this.getVariable('vote.messageLike', ''),\n\t\t\t\t\tmessageDislike: this.getVariable('vote.messageDislike', '')\n\t\t\t\t},\n\t\t\t\ttextMessages: {\n\t\t\t\t\tbxLivechatOnlineLine1: this.getVariable('textMessages.bxLivechatOnlineLine1', ''),\n\t\t\t\t\tbxLivechatOnlineLine2: this.getVariable('textMessages.bxLivechatOnlineLine2', ''),\n\t\t\t\t\tbxLivechatOffline: this.getVariable('textMessages.bxLivechatOffline', ''),\n\t\t\t\t\tbxLivechatTitle: '',\n\t\t\t\t},\n\t\t\t\tonline: false,\n\t\t\t\toperators: [],\n\t\t\t\tconnectors: [],\n\t\t\t\tshowForm: FormType.none,\n\t\t\t\tshowed: false,\n\t\t\t\treopen: false,\n\t\t\t\tdragged: false,\n\t\t\t\ttextareaHeight: 0,\n\t\t\t\twidgetHeight: 0,\n\t\t\t\twidgetWidth: 0,\n\t\t\t\tshowConsent: false,\n\t\t\t\tconsentUrl: '',\n\t\t\t\tdialogStart: false,\n\t\t\t\twatchTyping: false,\n\t\t\t\tshowSessionId: false,\n\t\t\t},\n\t\t\tdialog:\n\t\t\t{\n\t\t\t\tsessionId: 0,\n\t\t\t\tsessionClose: true,\n\t\t\t\tsessionStatus: 0,\n\t\t\t\tuserVote: VoteType.none,\n\t\t\t\tuserConsent: false,\n\t\t\t\toperatorChatId: 0,\n\t\t\t\toperator: {\n\t\t\t\t\tid: 0,\n\t\t\t\t\tname: '',\n\t\t\t\t\tfirstName: '',\n\t\t\t\t\tlastName: '',\n\t\t\t\t\tworkPosition: '',\n\t\t\t\t\tavatar: '',\n\t\t\t\t\tonline: false,\n\t\t\t\t}\n\t\t\t},\n\t\t\tuser:\n\t\t\t{\n\t\t\t\tid: -1,\n\t\t\t\thash: '',\n\t\t\t\tname: '',\n\t\t\t\tfirstName: '',\n\t\t\t\tlastName: '',\n\t\t\t\tavatar: '',\n\t\t\t\temail: '',\n\t\t\t\tphone: '',\n\t\t\t\twww: '',\n\t\t\t\tgender: 'M',\n\t\t\t\tposition: '',\n\t\t\t},\n\t\t}\n\t}\n\n\tgetStateSaveException()\n\t{\n\t\treturn {\n\t\t\tcommon: {\n\t\t\t\thost: null,\n\t\t\t\tpageMode: null,\n\t\t\t\tcopyright: null,\n\t\t\t\tcopyrightUrl: null,\n\t\t\t\tstyles: null,\n\t\t\t\tdragged: null,\n\t\t\t\tshowed: null,\n\t\t\t\tshowConsent: null,\n\t\t\t\tshowForm: null,\n\t\t\t},\n\t\t}\n\t}\n\n\tgetMutations()\n\t{\n\t\treturn {\n\n\t\t\tcommon: (state, payload) =>\n\t\t\t{\n\t\t\t\tif (typeof payload.configId === 'number')\n\t\t\t\t{\n\t\t\t\t\tstate.common.configId = payload.configId;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.configName === 'string')\n\t\t\t\t{\n\t\t\t\t\tstate.common.configName = payload.configName;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.online === 'boolean')\n\t\t\t\t{\n\t\t\t\t\tstate.common.online = payload.online;\n\t\t\t\t}\n\t\t\t\tif (Utils.types.isPlainObject(payload.vote))\n\t\t\t\t{\n\t\t\t\t\tif (typeof payload.vote.enable === 'boolean')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.common.vote.enable = payload.vote.enable;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.vote.beforeFinish === 'boolean')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.common.vote.beforeFinish = payload.vote.beforeFinish;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.vote.messageText === 'string')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.common.vote.messageText = payload.vote.messageText;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.vote.messageLike === 'string')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.common.vote.messageLike = payload.vote.messageLike;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.vote.messageDislike === 'string')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.common.vote.messageDislike = payload.vote.messageDislike;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (Utils.types.isPlainObject(payload.textMessages))\n\t\t\t\t{\n\t\t\t\t\tif (typeof payload.textMessages.bxLivechatOnlineLine1 === 'string' && payload.textMessages.bxLivechatOnlineLine1 !== '')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.common.textMessages.bxLivechatOnlineLine1 = payload.textMessages.bxLivechatOnlineLine1;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.textMessages.bxLivechatOnlineLine2 === 'string' && payload.textMessages.bxLivechatOnlineLine2 !== '')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.common.textMessages.bxLivechatOnlineLine2 = payload.textMessages.bxLivechatOnlineLine2;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.textMessages.bxLivechatOffline === 'string' && payload.textMessages.bxLivechatOffline !== '')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.common.textMessages.bxLivechatOffline = payload.textMessages.bxLivechatOffline;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.textMessages.bxLivechatTitle === 'string' && payload.textMessages.bxLivechatTitle !== '')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.common.textMessages.bxLivechatTitle = payload.textMessages.bxLivechatTitle;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (typeof payload.dragged === 'boolean')\n\t\t\t\t{\n\t\t\t\t\tstate.common.dragged = payload.dragged;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.textareaHeight === 'number')\n\t\t\t\t{\n\t\t\t\t\tstate.common.textareaHeight = payload.textareaHeight;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.widgetHeight === 'number')\n\t\t\t\t{\n\t\t\t\t\tstate.common.widgetHeight = payload.widgetHeight;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.widgetWidth === 'number')\n\t\t\t\t{\n\t\t\t\t\tstate.common.widgetWidth = payload.widgetWidth;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.showConsent === 'boolean')\n\t\t\t\t{\n\t\t\t\t\tstate.common.showConsent = payload.showConsent;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.consentUrl === 'string')\n\t\t\t\t{\n\t\t\t\t\tstate.common.consentUrl = payload.consentUrl;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.showed === 'boolean')\n\t\t\t\t{\n\t\t\t\t\tstate.common.showed = payload.showed;\n\t\t\t\t\tpayload.reopen = Utils.device.isMobile()? false: payload.showed;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.reopen === 'boolean')\n\t\t\t\t{\n\t\t\t\t\tstate.common.reopen = payload.reopen;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.copyright === 'boolean')\n\t\t\t\t{\n\t\t\t\t\tstate.common.copyright = payload.copyright;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.dialogStart === 'boolean')\n\t\t\t\t{\n\t\t\t\t\tstate.common.dialogStart = payload.dialogStart;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.watchTyping === 'boolean')\n\t\t\t\t{\n\t\t\t\t\tstate.common.watchTyping = payload.watchTyping;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.showSessionId === 'boolean')\n\t\t\t\t{\n\t\t\t\t\tstate.common.showSessionId = payload.showSessionId;\n\t\t\t\t}\n\t\t\t\tif (payload.operators instanceof Array)\n\t\t\t\t{\n\t\t\t\t\tstate.common.operators = payload.operators;\n\t\t\t\t}\n\t\t\t\tif (payload.connectors instanceof Array)\n\t\t\t\t{\n\t\t\t\t\tstate.common.connectors = payload.connectors;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.showForm === 'string' && typeof FormType[payload.showForm] !== 'undefined')\n\t\t\t\t{\n\t\t\t\t\tstate.common.showForm = payload.showForm;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.location === 'number' && typeof LocationStyle[payload.location] !== 'undefined')\n\t\t\t\t{\n\t\t\t\t\tif (state.common.location !== payload.location)\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.common.widgetHeight = 0;\n\t\t\t\t\t\tstate.common.widgetWidth = 0;\n\t\t\t\t\t\tstate.common.location = payload.location;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (this.isSaveNeeded({common: payload}))\n\t\t\t\t{\n\t\t\t\t\tthis.saveState(state);\n\t\t\t\t}\n\t\t\t},\n\t\t\tdialog: (state, payload) =>\n\t\t\t{\n\t\t\t\tif (typeof payload.sessionId === 'number')\n\t\t\t\t{\n\t\t\t\t\tstate.dialog.sessionId = payload.sessionId;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.sessionClose === 'boolean')\n\t\t\t\t{\n\t\t\t\t\tstate.dialog.sessionClose = payload.sessionClose;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.sessionStatus === 'number')\n\t\t\t\t{\n\t\t\t\t\tstate.dialog.sessionStatus = payload.sessionStatus;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.userConsent === 'boolean')\n\t\t\t\t{\n\t\t\t\t\tstate.dialog.userConsent = payload.userConsent;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.userVote === 'string' && typeof payload.userVote !== 'undefined')\n\t\t\t\t{\n\t\t\t\t\tstate.dialog.userVote = payload.userVote;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.operatorChatId === 'number')\n\t\t\t\t{\n\t\t\t\t\tstate.dialog.operatorChatId = payload.operatorChatId;\n\t\t\t\t}\n\t\t\t\tif (Utils.types.isPlainObject(payload.operator))\n\t\t\t\t{\n\t\t\t\t\tif (typeof payload.operator.id === 'number')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.dialog.operator.id = payload.operator.id;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.operator.name === 'string' || typeof payload.operator.name === 'number')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.dialog.operator.name = payload.operator.name.toString();\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.operator.lastName === 'string' || typeof payload.operator.lastName === 'number')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.dialog.operator.lastName = payload.operator.lastName.toString();\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.operator.firstName === 'string' || typeof payload.operator.firstName === 'number')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.dialog.operator.firstName = payload.operator.firstName.toString();\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.operator.workPosition === 'string' || typeof payload.operator.workPosition === 'number')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.dialog.operator.workPosition = payload.operator.workPosition.toString();\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.operator.avatar === 'string')\n\t\t\t\t\t{\n\t\t\t\t\t\tif (!payload.operator.avatar || payload.operator.avatar.startsWith('http'))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tstate.dialog.operator.avatar = payload.operator.avatar;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tstate.dialog.operator.avatar = state.common.host+payload.operator.avatar;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.operator.online === 'boolean')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.dialog.operator.online = payload.operator.online;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (this.isSaveNeeded({dialog: payload}))\n\t\t\t\t{\n\t\t\t\t\tthis.saveState(state);\n\t\t\t\t}\n\t\t\t},\n\t\t\tuser: (state, payload) =>\n\t\t\t{\n\t\t\t\tif (typeof payload.id === 'number')\n\t\t\t\t{\n\t\t\t\t\tstate.user.id = payload.id;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.hash === 'string' && payload.hash !== state.user.hash)\n\t\t\t\t{\n\t\t\t\t\tstate.user.hash = payload.hash;\n\t\t\t\t\tCookie.set(null, 'LIVECHAT_HASH', payload.hash, {expires: 365*86400, path: '/'});\n\t\t\t\t}\n\t\t\t\tif (typeof payload.name === 'string' || typeof payload.name === 'number')\n\t\t\t\t{\n\t\t\t\t\tstate.user.name = payload.name.toString();\n\t\t\t\t}\n\t\t\t\tif (typeof payload.firstName === 'string' || typeof payload.firstName === 'number')\n\t\t\t\t{\n\t\t\t\t\tstate.user.firstName = payload.firstName.toString();\n\t\t\t\t}\n\t\t\t\tif (typeof payload.lastName === 'string' || typeof payload.lastName === 'number')\n\t\t\t\t{\n\t\t\t\t\tstate.user.lastName = payload.lastName.toString();\n\t\t\t\t}\n\t\t\t\tif (typeof payload.avatar === 'string')\n\t\t\t\t{\n\t\t\t\t\tstate.user.avatar = payload.avatar;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.email === 'string')\n\t\t\t\t{\n\t\t\t\t\tstate.user.email = payload.email;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.phone === 'string' || typeof payload.phone === 'number')\n\t\t\t\t{\n\t\t\t\t\tstate.user.phone = payload.phone.toString();\n\t\t\t\t}\n\t\t\t\tif (typeof payload.www === 'string')\n\t\t\t\t{\n\t\t\t\t\tstate.user.www = payload.www;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.gender === 'string')\n\t\t\t\t{\n\t\t\t\t\tstate.user.gender = payload.gender;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.position === 'string')\n\t\t\t\t{\n\t\t\t\t\tstate.user.position = payload.position;\n\t\t\t\t}\n\n\t\t\t\tif (this.isSaveNeeded({user: payload}))\n\t\t\t\t{\n\t\t\t\t\tthis.saveState(state);\n\t\t\t\t}\n\t\t\t},\n\t\t}\n\t}\n\n\tgetActions()\n\t{\n\t\treturn {\n\t\t\tshow: ({ commit }) =>\n\t\t\t{\n\t\t\t\tcommit('common', {showed: true});\n\t\t\t}\n\t\t}\n\t}\n}","/**\n * Bitrix OpenLines widget\n * Rest client (base on BX.RestClient)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\n// TODO change BX.RestClient, BX.promise to import\n\nimport {Utils} from \"im.lib.utils\";\nimport {RestAuth, RestMethod} from \"../const\";\nimport {RestClient} from \"rest.client\";\n\nexport class WidgetRestClient\n{\n\tconstructor(params)\n\t{\n\t\tthis.queryAuthRestore = false;\n\n\t\tthis.setAuthId(RestAuth.guest);\n\n\t\tthis.restClient = new RestClient({\n\t\t\tendpoint: params.endpoint,\n\t\t\tqueryParams: this.queryParams,\n\t\t\tcors: true\n\t\t});\n\t}\n\n\tsetAuthId(authId, customAuthId = '')\n\t{\n\t\tif (typeof this.queryParams !== 'object')\n\t\t{\n\t\t\tthis.queryParams = {};\n\t\t}\n\n\t\tif (\n\t\t\tauthId == RestAuth.guest\n\t\t\t|| typeof authId === 'string' && authId.match(/^[a-f0-9]{32}$/)\n\t\t)\n\t\t{\n\t\t\tthis.queryParams.livechat_auth_id = authId;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconsole.error(`%LiveChatRestClient.setAuthId: auth is not correct (%c${authId}%c)`, \"color: black;\", \"font-weight: bold; color: red\", \"color: black\");\n\t\t\treturn false;\n\t\t}\n\n\t\tif (\n\t\t\tauthId == RestAuth.guest\n\t\t\t&& typeof customAuthId === 'string' && customAuthId.match(/^[a-f0-9]{32}$/)\n\t\t)\n\t\t{\n\t\t\tthis.queryParams.livechat_custom_auth_id = customAuthId;\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tgetAuthId()\n\t{\n\t\tif (typeof this.queryParams !== 'object')\n\t\t{\n\t\t\tthis.queryParams = {};\n\t\t}\n\n\t\treturn this.queryParams.livechat_auth_id || null;\n\t}\n\n\tcallMethod(method, params, callback, sendCallback, logTag = null)\n\t{\n\t\tif (!logTag)\n\t\t{\n\t\t\tlogTag = Utils.getLogTrackingParams({\n\t\t\t\tname: method,\n\t\t\t});\n\t\t}\n\n\t\tconst promise = new BX.Promise();\n\n\t\t// TODO: Callbacks methods will not work!\n\t\tthis.restClient.callMethod(method, params, null, sendCallback, logTag).then(result => {\n\n\t\t\tthis.queryAuthRestore = false;\n\t\t\tpromise.fulfill(result);\n\n\t\t}).catch(result => {\n\n\t\t\tlet error = result.error();\n\t\t\tif (error.ex.error == 'LIVECHAT_AUTH_WIDGET_USER')\n\t\t\t{\n\t\t\t\tthis.setAuthId(error.ex.hash);\n\n\t\t\t\tif (method === RestMethod.widgetUserRegister)\n\t\t\t\t{\n\t\t\t\t\tconsole.warn(`BX.LiveChatRestClient: ${error.ex.error_description} (${error.ex.error})`);\n\n\t\t\t\t\tthis.queryAuthRestore = false;\n\t\t\t\t\tpromise.reject(result);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tif (!this.queryAuthRestore)\n\t\t\t\t{\n\t\t\t\t\tconsole.warn('BX.LiveChatRestClient: your auth-token has expired, send query with a new token');\n\n\t\t\t\t\tthis.queryAuthRestore = true;\n\t\t\t\t\tthis.restClient.callMethod(method, params, null, sendCallback, logTag).then(result => {\n\t\t\t\t\t\tthis.queryAuthRestore = false;\n\t\t\t\t\t\tpromise.fulfill(result);\n\t\t\t\t\t}).catch(result => {\n\t\t\t\t\t\tthis.queryAuthRestore = false;\n\t\t\t\t\t\tpromise.reject(result);\n\t\t\t\t\t});\n\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.queryAuthRestore = false;\n\t\t\tpromise.reject(result);\n\t\t});\n\n\t\treturn promise;\n\t};\n\n\tcallBatch(calls, callback, bHaltOnError, sendCallback, logTag)\n\t{\n\t\tlet resultCallback = (result) =>\n\t\t{\n\t\t\tlet error = null;\n\t\t\tfor (let method in calls)\n\t\t\t{\n\t\t\t\tif (!calls.hasOwnProperty(method))\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tlet error = result[method].error();\n\t\t\t\tif (error && error.ex.error == 'LIVECHAT_AUTH_WIDGET_USER')\n\t\t\t\t{\n\t\t\t\t\tthis.setAuthId(error.ex.hash);\n\t\t\t\t\tif (method === RestMethod.widgetUserRegister)\n\t\t\t\t\t{\n\t\t\t\t\t\tconsole.warn(`BX.LiveChatRestClient: ${error.ex.error_description} (${error.ex.error})`);\n\n\t\t\t\t\t\tthis.queryAuthRestore = false;\n\t\t\t\t\t\tcallback(result);\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!this.queryAuthRestore)\n\t\t\t\t\t{\n\t\t\t\t\t\tconsole.warn('BX.LiveChatRestClient: your auth-token has expired, send query with a new token');\n\n\t\t\t\t\t\tthis.queryAuthRestore = true;\n\t\t\t\t\t\tthis.restClient.callBatch(calls, callback, bHaltOnError, sendCallback, logTag);\n\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.queryAuthRestore = false;\n\t\t\tcallback(result);\n\n\t\t\treturn true;\n\t\t};\n\n\t\treturn this.restClient.callBatch(calls, resultCallback, bHaltOnError, sendCallback, logTag);\n\t};\n}","/**\n * Bitrix OpenLines widget\n * Widget Rest answers (Rest Answer Handler)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {BaseRestHandler} from \"im.provider.rest\";\nimport {LocalStorage} from \"im.lib.localstorage\";\nimport {SubscriptionType} from \"./const\";\n\nclass WidgetRestAnswerHandler extends BaseRestHandler\n{\n\tconstructor(props = {})\n\t{\n\t\tsuper(props);\n\n\t\tthis.widget = props.widget;\n\t}\n\n\thandleImopenlinesWidgetConfigGetSuccess(data)\n\t{\n\t\tthis.store.commit('widget/common', {\n\t\t\tconfigId: data.configId,\n\t\t\tconfigName: data.configName,\n\t\t\tvote: data.vote,\n\t\t\ttextMessages: data.textMessages,\n\t\t\toperators: data.operators || [],\n\t\t\tonline: data.online,\n\t\t\tconsentUrl: data.consentUrl,\n\t\t\tconnectors: data.connectors || [],\n\t\t\twatchTyping: data.watchTyping,\n\t\t\tshowSessionId: data.showSessionId,\n\t\t});\n\n\t\tthis.store.commit('application/set', {disk: data.disk});\n\n\t\tthis.widget.addLocalize(data.serverVariables);\n\t\tLocalStorage.set(this.widget.getSiteId(), 0, 'serverVariables', data.serverVariables || {});\n\t}\n\n\thandleImopenlinesWidgetUserRegisterSuccess(data)\n\t{\n\t\tthis.widget.restClient.setAuthId(data.hash);\n\n\t\tlet previousData = [];\n\t\tif (typeof this.store.state.messages.collection[this.controller.application.getChatId()] !== 'undefined')\n\t\t{\n\t\t\tpreviousData = this.store.state.messages.collection[this.controller.application.getChatId()];\n\t\t}\n\t\tthis.store.commit('messages/initCollection', {chatId: data.chatId, messages: previousData});\n\n\t\tthis.store.commit('dialogues/initCollection', {dialogId: data.dialogId, fields: {\n\t\t\tentityType: 'LIVECHAT',\n\t\t\ttype: 'livechat'\n\t\t}});\n\n\t\tthis.store.commit('application/set', {dialog: {\n\t\t\tchatId: data.chatId,\n\t\t\tdialogId: 'chat'+data.chatId\n\t\t}});\n\t}\n\n\thandleImopenlinesWidgetUserGetSuccess(data)\n\t{\n\t\tthis.store.commit('widget/user', {\n\t\t\tid: data.id,\n\t\t\thash: data.hash,\n\t\t\tname: data.name,\n\t\t\tfirstName: data.firstName,\n\t\t\tlastName: data.lastName,\n\t\t\tphone: data.phone,\n\t\t\tavatar: data.avatar,\n\t\t\temail: data.email,\n\t\t\twww: data.www,\n\t\t\tgender: data.gender,\n\t\t\tposition: data.position,\n\t\t});\n\t\tthis.store.dispatch('users/set', [{\n\t\t\tid: data.id,\n\t\t\tname: data.name,\n\t\t\tfirstName: data.firstName,\n\t\t\tlastName: data.lastName,\n\t\t\tavatar: data.avatar,\n\t\t\tgender: data.gender,\n\t\t\tworkPosition: data.position,\n\t\t}]);\n\t\tthis.store.commit('application/set', {common: {\n\t\t\tuserId: data.id\n\t\t}});\n\t}\n\n\thandleImopenlinesWidgetDialogGetSuccess(data)\n\t{\n\t\tthis.store.commit('messages/initCollection', {chatId: data.chatId});\n\n\t\tthis.store.commit('widget/dialog', data);\n\n\t\tthis.store.commit('application/set', {dialog: {\n\t\t\tchatId: data.chatId,\n\t\t\tdialogId: 'chat'+data.chatId,\n\t\t\tdiskFolderId: data.diskFolderId,\n\t\t}});\n\t}\n\n\thandleImDialogMessagesGetInitSuccess(data)\n\t{\n\t\tthis.handleImDialogMessagesGetSuccess(data);\n\t}\n\n\thandleImDialogMessagesGetSuccess(data)\n\t{\n\t\tif (data.messages && data.messages.length > 0 && !this.widget.isDialogStart())\n\t\t{\n\t\t\tthis.store.commit('widget/common', {\n\t\t\t\tdialogStart: true\n\t\t\t});\n\t\t\tthis.store.commit('widget/dialog', {\n\t\t\t\tuserConsent: true\n\t\t\t});\n\t\t}\n\t}\n\n\thandleImMessageAddSuccess(messageId, message)\n\t{\n\t\tthis.widget.messagesQueue = this.widget.messagesQueue.filter(el => el.id != message.id);\n\n\t\tthis.widget.sendEvent({\n\t\t\ttype: SubscriptionType.userMessage,\n\t\t\tdata: {\n\t\t\t\tid: messageId,\n\t\t\t\ttext: message.text\n\t\t\t}\n\t\t});\n\t}\n\n\thandleImMessageAddError(error, message)\n\t{\n\t\tthis.widget.messagesQueue = this.widget.messagesQueue.filter(el => el.id != message.id);\n\t}\n\n\thandleImDiskFileCommitSuccess(result, message)\n\t{\n\t\tthis.widget.messagesQueue = this.widget.messagesQueue.filter(el => el.id != message.id);\n\n\t\tthis.widget.sendEvent({\n\t\t\ttype: SubscriptionType.userFile,\n\t\t\tdata: {}\n\t\t});\n\t}\n}\n\nexport {WidgetRestAnswerHandler};","/**\n * Bitrix OpenLines widget\n * Widget pull commands (Pull Command Handler)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {SubscriptionType, VoteType} from \"./const\";\n\nclass WidgetImPullCommandHandler\n{\n\tstatic create(params = {})\n\t{\n\t\treturn new this(params);\n\t}\n\n\tgetModuleId()\n\t{\n\t\treturn 'im';\n\t}\n\n\tconstructor(params)\n\t{\n\t\tthis.controller = params.controller;\n\t\tthis.store = params.store;\n\t\tthis.widget = params.widget;\n\t}\n\n\thandleMessageChat(params, extra, command)\n\t{\n\t\tif (params.message.senderId != this.controller.application.getUserId())\n\t\t{\n\t\t\tthis.widget.sendEvent({\n\t\t\t\ttype: SubscriptionType.operatorMessage,\n\t\t\t\tdata: params\n\t\t\t});\n\n\t\t\tif (!this.store.state.widget.common.showed && !this.widget.onceShowed)\n\t\t\t{\n\t\t\t\tthis.widget.onceShowed = true;\n\t\t\t\tthis.widget.open();\n\t\t\t}\n\t\t}\n\t}\n}\n\nclass WidgetImopenlinesPullCommandHandler\n{\n\tstatic create(params = {})\n\t{\n\t\treturn new this(params);\n\t}\n\n\tconstructor(params = {})\n\t{\n\t\tthis.controller = params.controller;\n\t\tthis.store = params.store;\n\t\tthis.widget = params.widget;\n\t}\n\n\tgetModuleId()\n\t{\n\t\treturn 'imopenlines';\n\t}\n\n\thandleSessionStart(params, extra, command)\n\t{\n\t\tthis.store.commit('widget/dialog', {\n\t\t\tsessionId: params.sessionId,\n\t\t\tsessionClose: false,\n\t\t\tsessionStatus: 0,\n\t\t\tuserVote: VoteType.none,\n\t\t});\n\n\t\tthis.widget.sendEvent({\n\t\t\ttype: SubscriptionType.sessionStart,\n\t\t\tdata: {\n\t\t\t\tsessionId: params.sessionId\n\t\t\t}\n\t\t});\n\t}\n\n\thandleSessionOperatorChange(params, extra, command)\n\t{\n\t\tthis.store.commit('widget/dialog', {\n\t\t\toperator: params.operator,\n\t\t\toperatorChatId: params.operatorChatId\n\t\t});\n\n\t\tthis.widget.sendEvent({\n\t\t\ttype: SubscriptionType.sessionOperatorChange,\n\t\t\tdata: {\n\t\t\t\toperator: params.operator\n\t\t\t}\n\t\t});\n\t}\n\n\thandleSessionStatus(params, extra, command)\n\t{\n\t\tthis.store.commit('widget/dialog', {\n\t\t\tsessionId: params.sessionId,\n\t\t\tsessionStatus: params.sessionStatus,\n\t\t\tsessionClose: params.sessionClose,\n\t\t});\n\n\t\tthis.widget.sendEvent({\n\t\t\ttype: SubscriptionType.sessionStatus,\n\t\t\tdata: {\n\t\t\t\tsessionId: params.sessionId,\n\t\t\t\tsessionStatus: params.sessionStatus\n\t\t\t}\n\t\t});\n\n\t\tif (params.sessionClose)\n\t\t{\n\t\t\tthis.widget.sendEvent({\n\t\t\t\ttype: SubscriptionType.sessionFinish,\n\t\t\t\tdata: {\n\t\t\t\t\tsessionId: params.sessionId,\n\t\t\t\t\tsessionStatus: params.sessionStatus\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (!params.spam)\n\t\t\t{\n\t\t\t\tthis.store.commit('widget/dialog', {\n\t\t\t\t\toperator: {\n\t\t\t\t\t\tname: '',\n\t\t\t\t\t\tfirstName: '',\n\t\t\t\t\t\tlastName: '',\n\t\t\t\t\t\tworkPosition: '',\n\t\t\t\t\t\tavatar: '',\n\t\t\t\t\t\tonline: false,\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n}\n\nexport {\n\tWidgetImPullCommandHandler,\n\tWidgetImopenlinesPullCommandHandler,\n};","/**\n * Bitrix OpenLines widget\n * Widget private interface (base class)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2020 Bitrix\n */\n\n// widget files\nimport {\n\tVoteType,\n\tLocationStyle,\n\tSubscriptionType,\n\tSubscriptionTypeCheck,\n\tRestMethod,\n\tRestAuth,\n} from \"./const\";\n\nimport {WidgetModel} from \"./model\";\nimport {WidgetRestClient} from \"./utils/restclient\"\nimport {WidgetRestAnswerHandler} from \"./rest.handler\";\nimport {WidgetImPullCommandHandler, WidgetImopenlinesPullCommandHandler} from \"./pull.handler\";\n\n// main\nimport {md5} from \"main.md5\";\nimport \"main.date\";\n\n// pull\nimport {PullClient} from \"pull.client\";\n\n// ui\nimport {Vue} from \"ui.vue\";\nimport {VuexBuilder} from \"ui.vue.vuex\";\n\n// messenger files\nimport {Controller} from 'im.controller';\nimport {\n\tRestMethod as ImRestMethod,\n\tRestMethodHandler as ImRestMethodHandler,\n\tEventType,\n\tFileStatus\n} from 'im.const';\n\nimport {Cookie} from \"im.lib.cookie\";\nimport {Utils} from \"im.lib.utils\";\nimport {LocalStorage} from \"im.lib.localstorage\";\nimport {Logger} from \"im.lib.logger\";\n\nimport {Uploader} from \"im.lib.uploader\";\n\n// TODO change BX.Promise, BX.Main.Date to IMPORT\n\nexport class Widget\n{\n/* region 01. Initialize and store data */\n\n\tconstructor(params = {})\n\t{\n\t\tthis.params = params;\n\n\t\tthis.template = null;\n\t\tthis.rootNode = this.params.node || document.createElement('div');\n\n\t\tthis.messagesQueue = [];\n\n\t\tthis.ready = true;\n\t\tthis.widgetDataRequested = false;\n\t\tthis.offline = false;\n\n\t\tthis.inited = false;\n\t\tthis.initEventFired = false;\n\n\t\tthis.restClient = null;\n\n\t\tthis.userRegisterData = {};\n\t\tthis.customData = [];\n\n\t\tthis.subscribers = {};\n\n\t\tthis.configRequestXhr = null;\n\n\t\tthis.initParams()\n\t\t\t.then(() => this.initRestClient())\n\t\t\t.then(() => this.initPullClient())\n\t\t\t.then(() => this.initCore())\n\t\t\t.then(() => this.initWidget())\n\t\t\t.then(() => this.initUploader())\n\t\t\t.then(() => this.initComplete())\n\t\t;\n\t}\n\n\tinitParams()\n\t{\n\t\tthis.code = this.params.code || '';\n\t\tthis.host = this.params.host || '';\n\t\tthis.language = this.params.language || 'en';\n\t\tthis.copyright = this.params.copyright !== false;\n\t\tthis.copyrightUrl = this.copyright && this.params.copyrightUrl? this.params.copyrightUrl: '';\n\t\tthis.buttonInstance = typeof this.params.buttonInstance === 'object' && this.params.buttonInstance !== null? this.params.buttonInstance: null;\n\n\t\tthis.pageMode = typeof this.params.pageMode === 'object' && this.params.pageMode;\n\t\tif (this.pageMode)\n\t\t{\n\t\t\tthis.pageMode.useBitrixLocalize = this.params.pageMode.useBitrixLocalize === true;\n\t\t\tthis.pageMode.placeholder = document.getElementById(this.params.pageMode.placeholder);\n\t\t}\n\n\t\tif (typeof this.code === 'string')\n\t\t{\n\t\t\tif (this.code.length <= 0)\n\t\t\t{\n\t\t\t\tconsole.warn(`%cLiveChatWidget.constructor: code is not correct (%c${this.code}%c)`, \"color: black;\", \"font-weight: bold; color: red\", \"color: black\");\n\t\t\t\tthis.ready = false;\n\t\t\t}\n\t\t}\n\n\t\tif (typeof this.host === 'string')\n\t\t{\n\t\t\tif (this.host.length <= 0 || !this.host.startsWith('http'))\n\t\t\t{\n\t\t\t\tconsole.warn(`%cLiveChatWidget.constructor: host is not correct (%c${this.host}%c)`, \"color: black;\", \"font-weight: bold; color: red\", \"color: black\");\n\t\t\t\tthis.ready = false;\n\t\t\t}\n\t\t}\n\n\t\tif (this.pageMode && this.pageMode.placeholder)\n\t\t{\n\t\t\tthis.rootNode = this.pageMode.placeholder;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (document.body.firstChild)\n\t\t\t{\n\t\t\t\tdocument.body.insertBefore(this.rootNode, document.body.firstChild);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tdocument.body.appendChild(this.rootNode);\n\t\t\t}\n\t\t}\n\n\t\tthis.localize = this.pageMode && this.pageMode.useBitrixLocalize? window.BX.message: {};\n\t\tif (typeof this.params.localize === 'object')\n\t\t{\n\t\t\tthis.addLocalize(this.params.localize);\n\t\t}\n\n\t\tlet serverVariables = LocalStorage.get(this.getSiteId(), 0, 'serverVariables', false);\n\t\tif (serverVariables)\n\t\t{\n\t\t\tthis.addLocalize(serverVariables);\n\t\t}\n\n\t\treturn new Promise((resolve, reject) => resolve());\n\t}\n\n\tinitRestClient()\n\t{\n\t\tthis.restClient = new WidgetRestClient({endpoint: this.host+'/rest'});\n\n\t\treturn new Promise((resolve, reject) => resolve());\n\t}\n\n\tinitPullClient()\n\t{\n\t\tthis.pullClient = new PullClient({\n\t\t\tserverEnabled: true,\n\t\t\tuserId: 0,\n\t\t\tsiteId: this.getSiteId(),\n\t\t\trestClient: this.restClient,\n\t\t\tskipStorageInit: true,\n\t\t\tconfigTimestamp: 0,\n\t\t\tskipCheckRevision: true,\n\t\t\tgetPublicListMethod: 'imopenlines.widget.operator.get',\n\t\t});\n\t\tthis.pullClientInited = false;\n\n\t\treturn new Promise((resolve, reject) => resolve());\n\t}\n\n\tinitCore()\n\t{\n\t\tlet widgetVariables = {\n\t\t\tcommon: {\n\t\t\t\thost: this.getHost(),\n\t\t\t\tpageMode: this.pageMode !== false,\n\t\t\t\tcopyright: this.copyright,\n\t\t\t\tcopyrightUrl: this.copyrightUrl,\n\t\t\t},\n\t\t\tvote: {\n\t\t\t\tmessageText: this.getLocalize('BX_LIVECHAT_VOTE_TITLE'),\n\t\t\t\tmessageLike: this.getLocalize('BX_LIVECHAT_VOTE_PLUS_TITLE'),\n\t\t\t\tmessageDislike: this.getLocalize('BX_LIVECHAT_VOTE_MINUS_TITLE'),\n\t\t\t},\n\t\t\ttextMessages: {\n\t\t\t\tbxLivechatOnlineLine1: this.getLocalize('BX_LIVECHAT_ONLINE_LINE_1'),\n\t\t\t\tbxLivechatOnlineLine2: this.getLocalize('BX_LIVECHAT_ONLINE_LINE_2'),\n\t\t\t\tbxLivechatOffline: this.getLocalize('BX_LIVECHAT_OFFLINE'),\n\t\t\t}\n\t\t};\n\t\tif (\n\t\t\tUtils.types.isPlainObject(this.params.styles)\n\t\t\t&& (this.params.styles.backgroundColor || this.params.styles.iconColor)\n\t\t)\n\t\t{\n\t\t\twidgetVariables.styles = {};\n\t\t\tif (this.params.styles.backgroundColor)\n\t\t\t{\n\t\t\t\twidgetVariables.styles.backgroundColor = this.params.styles.backgroundColor;\n\t\t\t}\n\t\t\tif (this.params.styles.iconColor)\n\t\t\t{\n\t\t\t\twidgetVariables.styles.iconColor = this.params.styles.iconColor;\n\t\t\t}\n\t\t}\n\n\t\tthis.controller = new Controller({\n\t\t\thost: this.getHost(),\n\t\t\tsiteId: this.getSiteId(),\n\t\t\tuserId: 0,\n\t\t\tlanguageId: this.language,\n\t\t\tpull: {client: this.pullClient},\n\t\t\trest: {client: this.restClient},\n\t\t\tlocalize: this.localize,\n\t\t\tvuexBuilder: {\n\t\t\t\tdatabase: !Utils.browser.isIe(),\n\t\t\t\tdatabaseName: 'imol/widget',\n\t\t\t\tdatabaseType: VuexBuilder.DatabaseType.localStorage,\n\t\t\t\tmodels: [\n\t\t\t\t\tWidgetModel.create().setVariables(widgetVariables)\n\t\t\t\t],\n\t\t\t}\n\t\t});\n\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.controller.ready().then(() => resolve());\n\t\t});\n\t}\n\n\tinitWidget()\n\t{\n\t\tif (this.isUserRegistered())\n\t\t{\n\t\t\tthis.restClient.setAuthId(this.getUserHash());\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.restClient.setAuthId(RestAuth.guest);\n\t\t}\n\n\t\tif (this.params.location && typeof LocationStyle[this.params.location] !== 'undefined')\n\t\t{\n\t\t\tthis.controller.getStore().commit('widget/common', {location: this.params.location});\n\t\t}\n\n\t\tthis.controller.application.setPrepareFilesBeforeSaveFunction(this.prepareFileData.bind(this));\n\n\t\tthis.controller.addRestAnswerHandler(\n\t\t\tWidgetRestAnswerHandler.create({\n\t\t\t\twidget: this,\n\t\t\t\tstore: this.controller.getStore(),\n\t\t\t\tcontroller: this.controller,\n\t\t\t})\n\t\t);\n\n\t\treturn new Promise((resolve, reject) => resolve());\n\t}\n\n\tinitUploader()\n\t{\n\t\tthis.uploader = new Uploader({\n\t\t\tgeneratePreview: true,\n\t\t\tsender: {\n\t\t\t\thost: this.host,\n\t\t\t\tcustomHeaders: {\n\t\t\t\t\t'Livechat-Auth-Id': this.getUserHash()\n\t\t\t\t},\n\t\t\t\tactionUploadChunk: 'imopenlines.widget.disk.upload',\n\t\t\t\tactionCommitFile: 'imopenlines.widget.disk.commit',\n\t\t\t\tactionRollbackUpload: 'imopenlines.widget.disk.rollbackUpload',\n\t\t\t}\n\t\t});\n\n\t\tthis.uploader.subscribe('onStartUpload', event => {\n\t\t\tconst eventData = event.getData();\n\t\t\tLogger.log('Uploader: onStartUpload', eventData);\n\n\t\t\tthis.controller.getStore().dispatch('files/update', {\n\t\t\t\tchatId: this.getChatId(),\n\t\t\t\tid: eventData.id,\n\t\t\t\tfields: {\n\t\t\t\t\tstatus: FileStatus.upload,\n\t\t\t\t\tprogress: 0\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\n\t\tthis.uploader.subscribe('onProgress', (event) => {\n\t\t\tconst eventData = event.getData();\n\t\t\tLogger.log('Uploader: onProgress', eventData);\n\n\t\t\tthis.controller.getStore().dispatch('files/update', {\n\t\t\t\tchatId: this.getChatId(),\n\t\t\t\tid: eventData.id,\n\t\t\t\tfields: {\n\t\t\t\t\tstatus: FileStatus.upload,\n\t\t\t\t\tprogress: (eventData.progress === 100 ? 99 : eventData.progress),\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\n\t\tthis.uploader.subscribe('onSelectFile', (event) => {\n\t\t\tconst eventData = event.getData();\n\t\t\tconst file = eventData.file;\n\t\t\tLogger.log('Uploader: onSelectFile', eventData);\n\n\t\t\tlet fileType = 'file';\n\t\t\tif (file.type.toString().startsWith('image'))\n\t\t\t{\n\t\t\t\tfileType = 'image';\n\t\t\t}\n\t\t\telse if (file.type.toString().startsWith('video'))\n\t\t\t{\n\t\t\t\tfileType = 'video';\n\t\t\t}\n\n\t\t\tthis.controller.getStore().dispatch('files/add', {\n\t\t\t\tchatId: this.getChatId(),\n\t\t\t\tauthorId: this.getUserId(),\n\t\t\t\tname: eventData.file.name,\n\t\t\t\ttype: fileType,\n\t\t\t\textension: file.name.split('.').splice(-1)[0],\n\t\t\t\tsize: eventData.file.size,\n\t\t\t\timage: !eventData.previewData? false: {\n\t\t\t\t\twidth: eventData.previewDataWidth,\n\t\t\t\t\theight: eventData.previewDataHeight,\n\t\t\t\t},\n\t\t\t\tstatus: FileStatus.upload,\n\t\t\t\tprogress: 0,\n\t\t\t\tauthorName: this.controller.application.getCurrentUser().name,\n\t\t\t\turlPreview: eventData.previewData? URL.createObjectURL(eventData.previewData) : \"\",\n\t\t\t}).then(fileId => {\n\t\t\t\tthis.addMessage('', {id: fileId, source: eventData, previewBlob: eventData.previewData})\n\t\t\t});\n\t\t});\n\n\t\tthis.uploader.subscribe('onComplete', (event) => {\n\t\t\tconst eventData = event.getData();\n\t\t\tLogger.log('Uploader: onComplete', eventData);\n\n\t\t\tthis.controller.getStore().dispatch('files/update', {\n\t\t\t\tchatId: this.getChatId(),\n\t\t\t\tid: eventData.id,\n\t\t\t\tfields: {\n\t\t\t\t\tstatus: FileStatus.wait,\n\t\t\t\t\tprogress: 100\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tconst message = this.messagesQueue.find(message => {\n\t\t\t\treturn message.file.id === eventData.id\n\t\t\t});\n\t\t\tconst fileType = this.controller.getStore().getters['files/get'](this.getChatId(), message.file.id, true).type;\n\n\t\t\tthis.fileCommit({\n\t\t\t\tchatId: this.getChatId(),\n\t\t\t\tuploadId: eventData.result.data.file.id,\n\t\t\t\tmessageText: message.text,\n\t\t\t\tmessageId: message.id,\n\t\t\t\tfileId: message.file.id,\n\t\t\t\tfileType\n\t\t\t}, message);\n\t\t});\n\n\t\tthis.uploader.subscribe('onUploadFileError', (event) => {\n\t\t\tconst eventData = event.getData();\n\t\t\tLogger.log('Uploader: onUploadFileError', eventData);\n\n\t\t\tconst message = this.messagesQueue.find(message => {\n\t\t\t\treturn message.file.id === eventData.id\n\t\t\t});\n\n\t\t\tif (typeof message === 'undefined')\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.fileError(this.getChatId(), message.file.id, message.id);\n\t\t});\n\n\t\tthis.uploader.subscribe('onCreateFileError', (event) => {\n\t\t\tconst eventData = event.getData();\n\t\t\tLogger.log('Uploader: onCreateFileError', eventData);\n\n\t\t\tconst message = this.messagesQueue.find(message => {\n\t\t\t\treturn message.file.id === eventData.id\n\t\t\t});\n\n\t\t\tthis.fileError(this.getChatId(), message.file.id, message.id);\n\t\t});\n\n\t\treturn new Promise((resolve, reject) => resolve());\n\t}\n\n\tinitComplete()\n\t{\n\t\twindow.dispatchEvent(new CustomEvent('onBitrixLiveChat', {detail: {\n\t\t\twidget: this,\n\t\t\twidgetCode: this.code,\n\t\t\twidgetHost: this.host,\n\t\t}}));\n\n\t\tif (this.callStartFlag)\n\t\t{\n\t\t\tthis.start();\n\t\t}\n\n\t\tif (this.pageMode || this.callOpenFlag)\n\t\t{\n\t\t\tthis.open();\n\t\t}\n\n\t\treturn new Promise((resolve, reject) => resolve());\n\t}\n\n\trequestWidgetData()\n\t{\n\t\tif (!this.isReady())\n\t\t{\n\t\t\tconsole.error('LiveChatWidget.start: widget code or host is not specified');\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.widgetDataRequested = true;\n\t\tif (\n\t\t\t!this.isUserRegistered() && (\n\t\t\t\tthis.userRegisterData.hash\n\t\t\t\t|| this.getUserHashCookie()\n\t\t\t)\n\t\t)\n\t\t{\n\t\t\tthis.requestData();\n\t\t\tthis.inited = true;\n\t\t\tthis.fireInitEvent();\n\t\t}\n\t\telse if (this.isConfigDataLoaded() && this.isUserRegistered())\n\t\t{\n\t\t\tthis.requestData();\n\t\t\tthis.inited = true;\n\t\t\tthis.fireInitEvent();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.controller.restClient.callMethod(RestMethod.widgetConfigGet, {code: this.code}, (xhr) => {this.configRequestXhr = xhr}).then((result) => {\n\t\t\t\tthis.configRequestXhr = null;\n\t\t\t\tthis.clearError();\n\n\t\t\t\tthis.controller.executeRestAnswer(RestMethod.widgetConfigGet, result);\n\n\t\t\t\tif (!this.inited)\n\t\t\t\t{\n\t\t\t\t\tthis.inited = true;\n\t\t\t\t\tthis.fireInitEvent();\n\t\t\t\t}\n\t\t\t}).catch(result => {\n\t\t\t\tthis.configRequestXhr = null;\n\n\t\t\t\tthis.setError(result.error().ex.error, result.error().ex.error_description);\n\t\t\t});\n\n\t\t\tif (this.isConfigDataLoaded())\n\t\t\t{\n\t\t\t\tthis.inited = true;\n\t\t\t\tthis.fireInitEvent();\n\t\t\t}\n\t\t}\n\t}\n\n\trequestData()\n\t{\n\t\tif (this.requestDataSend)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tthis.requestDataSend = true;\n\n\t\tif (this.configRequestXhr)\n\t\t{\n\t\t\tthis.configRequestXhr.abort();\n\t\t}\n\n\t\tlet query = {\n\t\t\t[RestMethod.widgetConfigGet]: [RestMethod.widgetConfigGet, {code: this.code}]\n\t\t};\n\n\t\tif (this.isUserRegistered())\n\t\t{\n\t\t\tquery[RestMethod.widgetDialogGet] = [RestMethod.widgetDialogGet, {config_id: this.getConfigId(), trace_data: this.getCrmTraceData(), custom_data: this.getCustomData()}];\n\t\t\tquery[ImRestMethodHandler.imChatGet] = [ImRestMethod.imChatGet, {dialog_id: '$result['+RestMethod.widgetDialogGet+'][dialogId]'}];\n\t\t\tquery[ImRestMethodHandler.imDialogMessagesGetInit] = [ImRestMethod.imDialogMessagesGet, {chat_id: '$result['+RestMethod.widgetDialogGet+'][chatId]', limit: this.controller.application.getRequestMessageLimit(), convert_text: 'Y'}];\n\t\t}\n\t\telse\n\t\t{\n\t\t\tquery[RestMethod.widgetUserRegister] = [RestMethod.widgetUserRegister, {config_id: '$result['+RestMethod.widgetConfigGet+'][configId]', ...this.getUserRegisterFields()}];\n\t\t\tquery[ImRestMethodHandler.imChatGet] = [ImRestMethod.imChatGet, {dialog_id: '$result['+RestMethod.widgetUserRegister+'][dialogId]'}];\n\n\t\t\tif (this.userRegisterData.hash || this.getUserHashCookie())\n\t\t\t{\n\t\t\t\tquery[RestMethod.widgetDialogGet] = [RestMethod.widgetDialogGet, {config_id: '$result['+RestMethod.widgetConfigGet+'][configId]', trace_data: this.getCrmTraceData(), custom_data: this.getCustomData()}];\n\t\t\t\tquery[ImRestMethodHandler.imDialogMessagesGetInit] = [ImRestMethod.imDialogMessagesGet, {chat_id: '$result['+RestMethod.widgetDialogGet+'][chatId]', limit: this.controller.application.getRequestMessageLimit(), convert_text: 'Y'}];\n\t\t\t}\n\t\t\tif (this.isUserAgreeConsent())\n\t\t\t{\n\t\t\t\tquery[RestMethod.widgetUserConsentApply] = [RestMethod.widgetUserConsentApply, {config_id: '$result['+RestMethod.widgetConfigGet+'][configId]', consent_url: location.href}];\n\t\t\t}\n\t\t}\n\n\t\tquery[RestMethod.pullServerTime] = [RestMethod.pullServerTime, {}];\n\t\tquery[RestMethod.pullConfigGet] = [RestMethod.pullConfigGet, {'CACHE': 'N'}];\n\t\tquery[RestMethod.widgetUserGet] = [RestMethod.widgetUserGet, {}];\n\n\t\tthis.controller.restClient.callBatch(query, (response) =>\n\t\t{\n\t\t\tif (!response)\n\t\t\t{\n\t\t\t\tthis.requestDataSend = false;\n\t\t\t\tthis.setError('EMPTY_RESPONSE', 'Server returned an empty response.');\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tlet configGet = response[RestMethod.widgetConfigGet];\n\t\t\tif (configGet && configGet.error())\n\t\t\t{\n\t\t\t\tthis.requestDataSend = false;\n\n\t\t\t\tthis.setError(configGet.error().ex.error, configGet.error().ex.error_description);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tthis.controller.executeRestAnswer(RestMethod.widgetConfigGet, configGet);\n\n\t\t\tlet userGetResult = response[RestMethod.widgetUserGet];\n\t\t\tif (userGetResult.error())\n\t\t\t{\n\t\t\t\tthis.requestDataSend = false;\n\t\t\t\tthis.setError(userGetResult.error().ex.error, userGetResult.error().ex.error_description);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tthis.controller.executeRestAnswer(RestMethod.widgetUserGet, userGetResult);\n\n\t\t\tlet chatGetResult = response[ImRestMethodHandler.imChatGet];\n\t\t\tif (chatGetResult.error())\n\t\t\t{\n\t\t\t\tthis.requestDataSend = false;\n\t\t\t\tthis.setError(chatGetResult.error().ex.error, chatGetResult.error().ex.error_description);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tthis.controller.executeRestAnswer(ImRestMethodHandler.imChatGet, chatGetResult);\n\n\t\t\tlet dialogGetResult = response[RestMethod.widgetDialogGet];\n\t\t\tif (dialogGetResult)\n\t\t\t{\n\t\t\t\tif (dialogGetResult.error())\n\t\t\t\t{\n\t\t\t\t\tthis.requestDataSend = false;\n\t\t\t\t\tthis.setError(dialogGetResult.error().ex.error, dialogGetResult.error().ex.error_description);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tthis.controller.executeRestAnswer(RestMethod.widgetDialogGet, dialogGetResult);\n\t\t\t}\n\n\t\t\tlet dialogMessagesGetResult = response[ImRestMethodHandler.imDialogMessagesGetInit];\n\t\t\tif (dialogMessagesGetResult)\n\t\t\t{\n\t\t\t\tif (dialogMessagesGetResult.error())\n\t\t\t\t{\n\t\t\t\t\tthis.requestDataSend = false;\n\t\t\t\t\tthis.setError(dialogMessagesGetResult.error().ex.error, dialogMessagesGetResult.error().ex.error_description);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tthis.controller.getStore().dispatch('dialogues/saveDialog', {\n\t\t\t\t\tdialogId: this.controller.application.getDialogId(),\n\t\t\t\t\tchatId: this.controller.application.getChatId(),\n\t\t\t\t});\n\n\t\t\t\tthis.controller.executeRestAnswer(ImRestMethodHandler.imDialogMessagesGetInit, dialogMessagesGetResult);\n\t\t\t}\n\n\t\t\tlet userRegisterResult = response[RestMethod.widgetUserRegister];\n\t\t\tif (userRegisterResult)\n\t\t\t{\n\t\t\t\tif (userRegisterResult.error())\n\t\t\t\t{\n\t\t\t\t\tthis.requestDataSend = false;\n\t\t\t\t\tthis.setError(userRegisterResult.error().ex.error, userRegisterResult.error().ex.error_description);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tthis.controller.executeRestAnswer(RestMethod.widgetUserRegister, userRegisterResult);\n\t\t\t}\n\n\t\t\tlet timeShift = 0;\n\n\t\t\tlet serverTimeResult = response[RestMethod.pullServerTime];\n\t\t\tif (serverTimeResult && !serverTimeResult.error())\n\t\t\t{\n\t\t\t\ttimeShift = Math.floor(((new Date()).getTime() - new Date(serverTimeResult.data()).getTime())/1000);\n\t\t\t}\n\n\t\t\tlet config = null;\n\t\t\tlet pullConfigResult = response[RestMethod.pullConfigGet];\n\t\t\tif (pullConfigResult && !pullConfigResult.error())\n\t\t\t{\n\t\t\t\tconfig = pullConfigResult.data();\n\t\t\t\tconfig.server.timeShift = timeShift;\n\t\t\t}\n\n\t\t\tthis.startPullClient(config).then(() => {\n\t\t\t\tthis.processSendMessages();\n\t\t\t}).catch((error) => {\n\t\t\t\tthis.setError(error.ex.error, error.ex.error_description);\n\t\t\t});\n\n\t\t\tthis.requestDataSend = false;\n\t\t}, false, false, Utils.getLogTrackingParams({name: 'widget.init.config', dialog: this.controller.application.getDialogData()}));\n\t}\n\n\tprepareFileData(files)\n\t{\n\t\tif (!Utils.types.isArray(files))\n\t\t{\n\t\t\treturn files;\n\t\t}\n\n\t\treturn files.map(file =>\n\t\t{\n\t\t\tlet hash = (window.md5 || md5)(this.getUserId()+'|'+file.id+'|'+this.getUserHash());\n\t\t\tlet urlParam = 'livechat_auth_id='+hash+'&livechat_user_id='+this.getUserId();\n\t\t\tif (file.urlPreview)\n\t\t\t{\n\t\t\t\tfile.urlPreview = file.urlPreview+'&'+urlParam;\n\t\t\t}\n\t\t\tif (file.urlShow)\n\t\t\t{\n\t\t\t\tfile.urlShow = file.urlShow+'&'+urlParam;\n\t\t\t}\n\t\t\tif (file.urlDownload)\n\t\t\t{\n\t\t\t\tfile.urlDownload = file.urlDownload+'&'+urlParam;\n\t\t\t}\n\n\t\t\treturn file;\n\t\t});\n\t}\n\n\tcheckBrowserVersion()\n\t{\n\t\tif (Utils.platform.isIos())\n\t\t{\n\t\t\tlet version = Utils.platform.getIosVersion();\n\t\t\tif (version && version <= 10)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\treturn true;\n\t}\n\n/* endregion 01. Initialize and store data */\n\n/* region 02. Push & Pull */\n\n\tstartPullClient(config)\n\t{\n\t\tlet promise = new BX.Promise();\n\n\t\tif (!this.getUserId() || !this.getSiteId() || !this.restClient)\n\t\t{\n\t\t\tpromise.reject({\n\t\t\t\tex: { error: 'WIDGET_NOT_LOADED', error_description: 'Widget is not loaded.'}\n\t\t\t});\n\t\t\treturn promise;\n\t\t}\n\n\t\tif (this.pullClientInited)\n\t\t{\n\t\t\tif (!this.pullClient.isConnected())\n\t\t\t{\n\t\t\t\tthis.pullClient.scheduleReconnect();\n\t\t\t}\n\t\t\tpromise.resolve(true);\n\t\t\treturn promise;\n\t\t}\n\n\t\tthis.controller.userId = this.getUserId();\n\t\tthis.pullClient.userId = this.getUserId();\n\t\tthis.pullClient.configTimestamp = config? config.server.config_timestamp: 0;\n\t\tthis.pullClient.skipStorageInit = false;\n\t\tthis.pullClient.storage = PullClient.StorageManager({\n\t\t\tuserId: this.getUserId(),\n\t\t\tsiteId: this.getSiteId()\n\t\t});\n\n\t\tthis.pullClient.subscribe(\n\t\t\tnew WidgetImPullCommandHandler({\n\t\t\t\tstore: this.controller.getStore(),\n\t\t\t\tcontroller: this.controller,\n\t\t\t\twidget: this,\n\t\t\t})\n\t\t);\n\t\tthis.pullClient.subscribe(\n\t\t\tnew WidgetImopenlinesPullCommandHandler({\n\t\t\t\tstore: this.controller.getStore(),\n\t\t\t\tcontroller: this.controller,\n\t\t\t\twidget: this,\n\t\t\t})\n\t\t);\n\n\t\tthis.pullClient.subscribe({\n\t\t\ttype: PullClient.SubscriptionType.Status,\n\t\t\tcallback: this.eventStatusInteraction.bind(this)\n\t\t});\n\n\t\tthis.pullConnectedFirstTime = this.pullClient.subscribe({\n\t\t\ttype: PullClient.SubscriptionType.Status,\n\t\t\tcallback: (result) => {\n\t\t\t\tif (result.status === PullClient.PullStatus.Online)\n\t\t\t\t{\n\t\t\t\t\tpromise.resolve(true);\n\t\t\t\t\tthis.pullConnectedFirstTime();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tif (this.template)\n\t\t{\n\t\t\tthis.template.$root.$bitrixPullClient = this.pullClient;\n\t\t\tthis.template.$root.$emit('onBitrixPullClientInited', this.pullClient);\n\t\t}\n\n\t\tthis.pullClient.start({\n\t\t\t...config,\n\t\t\tskipReconnectToLastSession: true\n\t\t}).catch(function(){\n\t\t\tpromise.reject({\n\t\t\t\tex: { error: 'PULL_CONNECTION_ERROR', error_description: 'Pull is not connected.'}\n\t\t\t});\n\t\t});\n\n\t\tthis.pullClientInited = true;\n\n\t\treturn promise;\n\t}\n\n\tstopPullClient()\n\t{\n\t\tif (this.pullClient)\n\t\t{\n\t\t\tthis.pullClient.stop(PullClient.CloseReasons.MANUAL, 'Closed manually');\n\t\t}\n\t}\n\n\trecoverPullConnection()\n\t{\n\t\t// this.pullClient.session.mid = 0; // TODO specially for disable pull history, remove after recode im\n\t\tthis.pullClient.restart(PullClient.CloseReasons.MANUAL, 'Restart after click by connection status button.');\n\t}\n\n\teventStatusInteraction(data)\n\t{\n\t\tif (data.status === PullClient.PullStatus.Online)\n\t\t{\n\t\t\tthis.offline = false;\n\n\t\t\tif (this.pullRequestMessage)\n\t\t\t{\n\t\t\t\tthis.getDialogUnread().then(() => {\n\t\t\t\t\tthis.processSendMessages();\n\t\t\t\t});\n\t\t\t\tthis.pullRequestMessage = false;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.readMessage();\n\t\t\t\tthis.processSendMessages();\n\t\t\t}\n\t\t}\n\t\telse if (data.status === PullClient.PullStatus.Offline)\n\t\t{\n\t\t\tthis.pullRequestMessage = true;\n\t\t\tthis.offline = true;\n\t\t}\n\t}\n\n/* endregion 02. Push & Pull */\n\n/* region 03. Template engine */\n\n\tattachTemplate()\n\t{\n\t\tif (this.template)\n\t\t{\n\t\t\tthis.controller.getStore().commit('widget/common', {showed: true});\n\t\t\treturn true;\n\t\t}\n\n\t\tthis.rootNode.innerHTML = '';\n\t\tthis.rootNode.appendChild(document.createElement('div'));\n\n\t\tlet application = this;\n\n\t\treturn this.controller.createVue(application, {\n\t\t\tel: this.rootNode.firstChild,\n\t\t\ttemplate: '<bx-livechat/>',\n\t\t\tbeforeCreate()\n\t\t\t{\n\t\t\t\tapplication.sendEvent({\n\t\t\t\t\ttype: SubscriptionType.widgetOpen,\n\t\t\t\t\tdata: {}\n\t\t\t\t});\n\t\t\t},\n\t\t\tdestroyed()\n\t\t\t{\n\t\t\t\tapplication.sendEvent({\n\t\t\t\t\ttype: SubscriptionType.widgetClose,\n\t\t\t\t\tdata: {}\n\t\t\t\t});\n\t\t\t\tapplication.template = null;\n\t\t\t\tapplication.templateAttached = false;\n\t\t\t\tapplication.rootNode.innerHTML = '';\n\t\t\t}\n\t\t}).then(vue => {\n\t\t\tthis.template = vue;\n\t\t\treturn new Promise((resolve, reject) => resolve());\n\t\t});\n\t}\n\n\tdetachTemplate()\n\t{\n\t\tif (!this.template)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tthis.template.$destroy();\n\n\t\treturn true;\n\t}\n\n\tmutateTemplateComponent(id, params)\n\t{\n\t\treturn Vue.mutateComponent(id, params);\n\t}\n\n/* endregion 03. Template engine */\n\n/* region 04. Rest methods */\n\n\taddMessage(text = '', file = null)\n\t{\n\t\tif (!text && !file)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tLogger.warn('addMessage', text, file);\n\n\t\tif (!this.controller.application.isUnreadMessagesLoaded())\n\t\t{\n\t\t\tthis.sendMessage({id: 0, text, file});\n\t\t\tthis.processSendMessages();\n\n\t\t\treturn true;\n\t\t}\n\n\t\tthis.controller.getStore().commit('application/increaseDialogExtraCount');\n\n\t\tlet params = {};\n\t\tif (file)\n\t\t{\n\t\t\tparams.FILE_ID = [file.id];\n\t\t}\n\n\t\tthis.controller.getStore().dispatch('messages/add', {\n\t\t\tchatId: this.getChatId(),\n\t\t\tauthorId: this.getUserId(),\n\t\t\ttext: text,\n\t\t\tparams,\n\t\t\tsending: !file,\n\t\t}).then(messageId => {\n\n\t\t\tif (!this.isDialogStart())\n\t\t\t{\n\t\t\t\tthis.controller.getStore().commit('widget/common', {dialogStart:true});\n\t\t\t}\n\n\t\t\tthis.messagesQueue.push({\n\t\t\t\tid: messageId,\n\t\t\t\ttext,\n\t\t\t\tfile,\n\t\t\t\tsending: false\n\t\t\t});\n\n\t\t\tif (this.getChatId())\n\t\t\t{\n\t\t\t\tthis.processSendMessages();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.requestData();\n\t\t\t}\n\t\t});\n\n\t\treturn true;\n\t}\n\n\tuploadFile(event)\n\t{\n\t\tif (!event)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tif (!this.getChatId())\n\t\t{\n\t\t\tthis.requestData();\n\t\t}\n\n\t\tthis.uploader.addFilesFromEvent(event);\n\t}\n\n\tcancelUploadFile(fileId)\n\t{\n\t\tlet element = this.messagesQueue.find(element => element.file && element.file.id === fileId);\n\t\tif (element)\n\t\t{\n\t\t\tthis.uploader.deleteTask(fileId);\n\n\t\t\tif (element.xhr)\n\t\t\t{\n\t\t\t\telement.xhr.abort();\n\t\t\t}\n\t\t\tthis.controller.getStore().dispatch('messages/delete', {\n\t\t\t\tchatId: this.getChatId(),\n\t\t\t\tid: element.id,\n\t\t\t}).then(() => {\n\t\t\t\tthis.controller.getStore().dispatch('files/delete', {\n\t\t\t\t\tchatId: this.getChatId(),\n\t\t\t\t\tid: element.file.id,\n\t\t\t\t});\n\t\t\t\tthis.messagesQueue = this.messagesQueue.filter(el => el.id !== element.id);\n\t\t\t});\n\t\t}\n\t}\n\n\tprocessSendMessages()\n\t{\n\t\tif (!this.getDiskFolderId())\n\t\t{\n\t\t\tthis.requestDiskFolderId().then(() => {\n\t\t\t\tthis.processSendMessages();\n\t\t\t}).catch(() => {\n\t\t\t\tLogger.warn('uploadFile', 'Error get disk folder id');\n\t\t\t\treturn false;\n\t\t\t});\n\n\t\t\treturn false;\n\t\t}\n\n\t\tif (this.offline)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.messagesQueue.filter(element => !element.sending).forEach(element => {\n\t\t\telement.sending = true;\n\t\t\tif (element.file)\n\t\t\t{\n\t\t\t\tthis.sendMessageWithFile(element);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.sendMessage(element);\n\t\t\t}\n\t\t});\n\n\t\treturn true;\n\t}\n\n\tsendMessage(message)\n\t{\n\t\tthis.controller.application.stopWriting();\n\n\t\tlet quiteId = this.controller.getStore().getters['dialogues/getQuoteId'](this.getDialogId());\n\t\tif (quiteId)\n\t\t{\n\t\t\tlet quoteMessage = this.controller.getStore().getters['messages/getMessage'](this.getChatId(), quiteId);\n\t\t\tif (quoteMessage)\n\t\t\t{\n\t\t\t\tlet user = this.controller.getStore().getters['users/get'](quoteMessage.authorId);\n\n\t\t\t\tlet newMessage = [];\n\t\t\t\tnewMessage.push(\"------------------------------------------------------\");\n\t\t\t\tnewMessage.push((user.name? user.name: this.getLocalize('BX_LIVECHAT_SYSTEM_MESSAGE')));\n\t\t\t\tnewMessage.push(quoteMessage.text);\n\t\t\t\tnewMessage.push('------------------------------------------------------');\n\t\t\t\tnewMessage.push(message.text);\n\t\t\t\tmessage.text = newMessage.join(\"\\n\");\n\n\t\t\t\tthis.quoteMessageClear();\n\t\t\t}\n\t\t}\n\n\t\tmessage.chatId = this.getChatId();\n\n\t\tthis.controller.restClient.callMethod(ImRestMethod.imMessageAdd, {\n\t\t\t'TEMPLATE_ID': message.id,\n\t\t\t'CHAT_ID': message.chatId,\n\t\t\t'MESSAGE': message.text\n\t\t}, null, null, Utils.getLogTrackingParams({\n\t\t\tname: ImRestMethod.imMessageAdd,\n\t\t\tdata: {timMessageType: 'text'},\n\t\t\tdialog: this.getDialogData()\n\t\t})).then(response => {\n\t\t\tthis.controller.executeRestAnswer(ImRestMethodHandler.imMessageAdd, response, message);\n\t\t}).catch(error => {\n\t\t\tthis.controller.executeRestAnswer(ImRestMethodHandler.imMessageAdd, error, message);\n\t\t});\n\n\t\treturn true;\n\t}\n\n\tsendMessageWithFile(message)\n\t{\n\t\tthis.controller.application.stopWriting();\n\n\t\tconst diskFolderId = this.getDiskFolderId();\n\t\tmessage.chatId = this.getChatId();\n\n\t\tthis.uploader.senderOptions.customHeaders['Livechat-Dialog-Id'] = message.chatId;\n\t\tthis.uploader.senderOptions.customHeaders['Livechat-Auth-Id'] = this.getUserHash();\n\n\t\tthis.uploader.addTask({\n\t\t\ttaskId: message.file.id,\n\t\t\tfileData: message.file.source.file,\n\t\t\tfileName: message.file.source.file.name,\n\t\t\tgenerateUniqueName: true,\n\t\t\tdiskFolderId: diskFolderId,\n\t\t\tpreviewBlob: message.file.previewBlob,\n\t\t});\n\t}\n\n\tfileError(chatId, fileId, messageId = 0)\n\t{\n\t\tthis.controller.getStore().dispatch('files/update', {\n\t\t\tchatId: chatId,\n\t\t\tid: fileId,\n\t\t\tfields: {\n\t\t\t\tstatus: FileStatus.error,\n\t\t\t\tprogress: 0\n\t\t\t}\n\t\t});\n\t\tif (messageId)\n\t\t{\n\t\t\tthis.controller.getStore().dispatch('messages/actionError', {\n\t\t\t\tchatId: chatId,\n\t\t\t\tid: messageId,\n\t\t\t\tretry: false,\n\t\t\t});\n\t\t}\n\t}\n\n\trequestDiskFolderId()\n\t{\n\t\tif (this.requestDiskFolderPromise)\n\t\t{\n\t\t\treturn this.requestDiskFolderPromise;\n\t\t}\n\n\t\tthis.requestDiskFolderPromise = new Promise((resolve, reject) =>\n\t\t{\n\t\t\tif (\n\t\t\t\tthis.flagRequestDiskFolderIdSended\n\t\t\t\t|| this.getDiskFolderId()\n\t\t\t)\n\t\t\t{\n\t\t\t\tthis.flagRequestDiskFolderIdSended = false;\n\t\t\t\tresolve();\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tthis.flagRequestDiskFolderIdSended = true;\n\n\t\t\tthis.controller.restClient.callMethod(ImRestMethod.imDiskFolderGet, {chat_id: this.controller.application.getChatId()}).then(response => {\n\t\t\t\tthis.controller.executeRestAnswer(ImRestMethodHandler.imDiskFolderGet, response);\n\t\t\t\tthis.flagRequestDiskFolderIdSended = false;\n\t\t\t\tresolve();\n\t\t\t}).catch(error => {\n\t\t\t\tthis.flagRequestDiskFolderIdSended = false;\n\t\t\t\tthis.controller.executeRestAnswer(ImRestMethodHandler.imDiskFolderGet, error);\n\t\t\t\treject();\n\t\t\t});\n\t\t});\n\n\t\treturn this.requestDiskFolderPromise;\n\t}\n\n\tfileCommit(params, message)\n\t{\n\t\tthis.controller.restClient.callMethod(ImRestMethod.imDiskFileCommit, {\n\t\t\tchat_id: params.chatId,\n\t\t\tupload_id: params.uploadId,\n\t\t\tmessage: params.messageText,\n\t\t\ttemplate_id: params.messageId,\n\t\t\tfile_template_id: params.fileId,\n\t\t}, null, null, Utils.getLogTrackingParams({\n\t\t\tname: ImRestMethod.imDiskFileCommit,\n\t\t\tdata: {timMessageType: params.fileType},\n\t\t\tdialog: this.getDialogData()\n\t\t})).then(response => {\n\t\t\tthis.controller.executeRestAnswer(ImRestMethodHandler.imDiskFileCommit, response, message);\n\t\t}).catch(error => {\n\t\t\tthis.controller.executeRestAnswer(ImRestMethodHandler.imDiskFileCommit, error, message);\n\t\t});\n\n\t\treturn true;\n\t}\n\n\tgetDialogHistory(lastId, limit = this.controller.application.getRequestMessageLimit())\n\t{\n\t\tthis.controller.restClient.callMethod(ImRestMethod.imDialogMessagesGet, {\n\t\t\t'CHAT_ID': this.getChatId(),\n\t\t\t'LAST_ID': lastId,\n\t\t\t'LIMIT': limit,\n\t\t\t'CONVERT_TEXT': 'Y'\n\t\t}).then(result => {\n\t\t\tthis.controller.executeRestAnswer(ImRestMethodHandler.imDialogMessagesGet, result);\n\t\t\tthis.template.$emit(EventType.dialog.requestHistoryResult, {count: result.data().messages.length});\n\t\t}).catch(result => {\n\t\t\tthis.template.$emit(EventType.dialog.requestHistoryResult, {error: result.error().ex});\n\t\t});\n\t}\n\n\tgetDialogUnread(lastId, limit = this.controller.application.getRequestMessageLimit())\n\t{\n\t\tconst promise = new BX.Promise();\n\n\t\tif (!lastId)\n\t\t{\n\t\t\tlastId = this.controller.getStore().getters['messages/getLastId'](this.controller.application.getChatId());\n\t\t}\n\n\t\tif (!lastId)\n\t\t{\n\t\t\tthis.template.$emit(EventType.dialog.requestUnreadResult, {error: {error: 'LAST_ID_EMPTY', error_description: 'LastId is empty.'}});\n\t\t\tpromise.reject();\n\t\t\treturn promise;\n\t\t}\n\n\t\tthis.controller.application.readMessage(lastId, true, true).then(() =>\n\t\t{\n\t\t\tlet query = {\n\t\t\t\t[ImRestMethodHandler.imDialogRead]: [ImRestMethod.imDialogRead, {\n\t\t\t\t\tdialog_id: this.getDialogId(),\n\t\t\t\t\tmessage_id: lastId\n\t\t\t\t}],\n\t\t\t\t[ImRestMethodHandler.imChatGet]: [ImRestMethod.imChatGet, {\n\t\t\t\t\tdialog_id: this.getDialogId()\n\t\t\t\t}],\n\t\t\t\t[ImRestMethodHandler.imDialogMessagesGetUnread]: [ImRestMethod.imDialogMessagesGet, {\n\t\t\t\t\tchat_id: this.getChatId(),\n\t\t\t\t\tfirst_id: lastId,\n\t\t\t\t\tlimit: limit,\n\t\t\t\t\tconvert_text: 'Y'\n\t\t\t\t}]\n\t\t\t};\n\n\t\t\tthis.controller.restClient.callBatch(query, (response) =>\n\t\t\t{\n\t\t\t\tif (!response)\n\t\t\t\t{\n\t\t\t\t\tthis.template.$emit(EventType.dialog.requestUnreadResult, {error: {error: 'EMPTY_RESPONSE', error_description: 'Server returned an empty response.'}});\n\n\t\t\t\t\tpromise.reject();\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tlet chatGetResult = response[ImRestMethodHandler.imChatGet];\n\t\t\t\tif (!chatGetResult.error())\n\t\t\t\t{\n\t\t\t\t\tthis.controller.executeRestAnswer(ImRestMethodHandler.imChatGet, chatGetResult);\n\t\t\t\t}\n\n\t\t\t\tlet dialogMessageUnread = response[ImRestMethodHandler.imDialogMessagesGetUnread];\n\t\t\t\tif (dialogMessageUnread.error())\n\t\t\t\t{\n\t\t\t\t\tthis.template.$emit(EventType.dialog.requestUnreadResult, {error: dialogMessageUnread.error().ex});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.controller.executeRestAnswer(ImRestMethodHandler.imDialogMessagesGetUnread, dialogMessageUnread);\n\t\t\t\t\tthis.template.$emit(EventType.dialog.requestUnreadResult, {\n\t\t\t\t\t\tfirstMessageId: dialogMessageUnread.data().messages.length > 0? dialogMessageUnread.data().messages[0].id: 0,\n\t\t\t\t\t\tcount: dialogMessageUnread.data().messages.length\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tpromise.fulfill(response);\n\n\t\t\t}, false, false, Utils.getLogTrackingParams({name: ImRestMethodHandler.imDialogMessagesGetUnread, dialog: this.getDialogData()}));\n\t\t});\n\n\t\treturn promise;\n\t}\n\n\tretrySendMessage(message)\n\t{\n\t\tif (this.messagesQueue.find(el => el.id === message.id))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.messagesQueue.push({\n\t\t\tid: message.id,\n\t\t\ttext: message.text,\n\t\t\tsending: false\n\t\t});\n\n\t\tthis.controller.application.setSendingMessageFlag(message.id);\n\n\t\tthis.processSendMessages();\n\t}\n\n\treadMessage(messageId)\n\t{\n\t\tif (this.offline)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\treturn this.controller.application.readMessage(messageId);\n\t}\n\n\tquoteMessage(id)\n\t{\n\t\tthis.controller.getStore().dispatch('dialogues/update', {\n\t\t\tdialogId: this.controller.application.getDialogId(),\n\t\t\tfields: {\n\t\t\t\tquoteId: id\n\t\t\t}\n\t\t});\n\t}\n\n\treactMessage(id, reaction)\n\t{\n\t\tthis.controller.application.reactMessage(id, reaction.type, reaction.action);\n\t}\n\n\texecMessageKeyboardCommand(data)\n\t{\n\t\tif (data.action === 'ACTION' && data.params.action === 'LIVECHAT')\n\t\t{\n\t\t\tlet {dialogId, messageId} = data.params;\n\t\t\tlet values = JSON.parse(data.params.value);\n\n\t\t\tlet sessionId = parseInt(values.SESSION_ID);\n\t\t\tif (sessionId !== this.getSessionId())\n\t\t\t{\n\t\t\t\talert(this.localize.BX_LIVECHAT_ACTION_EXPIRED);\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tthis.controller.restClient.callMethod(RestMethod.widgetActionSend, {\n\t\t\t\t'MESSAGE_ID': messageId,\n\t\t\t\t'DIALOG_ID': dialogId,\n\t\t\t\t'ACTION_VALUE': data.params.value,\n\t\t\t});\n\n\t\t\treturn true;\n\t\t}\n\n\t\tif (data.action !== 'COMMAND')\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tlet {dialogId, messageId, botId, command, params} = data.params;\n\n\t\tthis.controller.restClient.callMethod(ImRestMethod.imMessageCommand, {\n\t\t\t'MESSAGE_ID': messageId,\n\t\t\t'DIALOG_ID': dialogId,\n\t\t\t'BOT_ID': botId,\n\t\t\t'COMMAND': command,\n\t\t\t'COMMAND_PARAMS': params,\n\t\t});\n\n\t\treturn true;\n\t}\n\n\tquoteMessageClear()\n\t{\n\t\tthis.controller.getStore().dispatch('dialogues/update', {\n\t\t\tdialogId: this.controller.application.getDialogId(),\n\t\t\tfields: {\n\t\t\t\tquoteId: 0\n\t\t\t}\n\t\t});\n\t}\n\n\tsendDialogVote(result)\n\t{\n\t\tif (!this.getSessionId())\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.controller.restClient.callMethod(RestMethod.widgetVoteSend, {\n\t\t\t'SESSION_ID': this.getSessionId(),\n\t\t\t'ACTION': result\n\t\t}).catch((result) => {\n\t\t\tthis.controller.getStore().commit('widget/dialog', {userVote: VoteType.none});\n\t\t});\n\n\t\tthis.sendEvent({\n\t\t\ttype: SubscriptionType.userVote,\n\t\t\tdata: {\n\t\t\t\tvote: result\n\t\t\t}\n\t\t});\n\t}\n\n\tsendForm(type, fields)\n\t{\n\t\tLogger.info('LiveChatWidgetPrivate.sendForm:', type, fields);\n\n\t\tlet query = {\n\t\t\t[RestMethod.widgetFormSend]: [RestMethod.widgetFormSend, {\n\t\t\t\t'CHAT_ID': this.getChatId(),\n\t\t\t\t'FORM': type.toUpperCase(),\n\t\t\t\t'FIELDS': fields\n\t\t\t}],\n\t\t\t[RestMethod.widgetUserGet]: [RestMethod.widgetUserGet, {}]\n\t\t};\n\t\tthis.controller.restClient.callBatch(query, (response) =>\n\t\t{\n\t\t\tif (!response)\n\t\t\t{\n\t\t\t\tthis.requestDataSend = false;\n\t\t\t\tthis.setError('EMPTY_RESPONSE', 'Server returned an empty response.');\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tlet userGetResult = response[RestMethod.widgetUserGet];\n\t\t\tif (userGetResult.error())\n\t\t\t{\n\t\t\t\tthis.requestDataSend = false;\n\t\t\t\tthis.setError(userGetResult.error().ex.error, userGetResult.error().ex.error_description);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tthis.controller.executeRestAnswer(RestMethod.widgetUserGet, userGetResult);\n\n\t\t\tthis.sendEvent({\n\t\t\t\ttype: SubscriptionType.userForm,\n\t\t\t\tdata: {\n\t\t\t\t\tform: type,\n\t\t\t\t\tfields: fields\n\t\t\t\t}\n\t\t\t});\n\n\t\t}, false, false, Utils.getLogTrackingParams({name: RestMethod.widgetUserGet, dialog: this.getDialogData()}));\n\n\t}\n\n\tsendConsentDecision(result)\n\t{\n\t\tresult = result === true;\n\n\t\tthis.controller.getStore().commit('widget/dialog', {userConsent: result});\n\n\t\tif (result && this.isUserRegistered())\n\t\t{\n\t\t\tthis.controller.restClient.callMethod(RestMethod.widgetUserConsentApply, {\n\t\t\t\tconfig_id: this.getConfigId(),\n\t\t\t\tconsent_url: location.href\n\t\t\t});\n\t\t}\n\t}\n\n/* endregion 05. Templates and template interaction */\n\n/* region 05. Widget interaction and utils */\n\n\tstart()\n\t{\n\t\tif (!this.controller || !this.controller.getStore())\n\t\t{\n\t\t\tthis.callStartFlag = true;\n\t\t\treturn true;\n\t\t}\n\n\t\tif (this.isSessionActive())\n\t\t{\n\t\t\tthis.requestWidgetData();\n\t\t}\n\n\t\treturn true;\n\t}\n\n\topen(params = {})\n\t{\n\t\tclearTimeout(this.openTimeout);\n\t\tif (!this.controller.getStore())\n\t\t{\n\t\t\tthis.callOpenFlag = true;\n\t\t\treturn true;\n\t\t}\n\n\t\tif (!params.openFromButton && this.buttonInstance)\n\t\t{\n\t\t\tthis.buttonInstance.wm.showById('openline_livechat');\n\t\t}\n\n\t\tif (!this.checkBrowserVersion())\n\t\t{\n\t\t\tthis.setError('OLD_BROWSER_LOCALIZED', this.localize.BX_LIVECHAT_OLD_BROWSER);\n\t\t}\n\t\telse if (Utils.versionCompare(Vue.version(), '2.1') < 0)\n\t\t{\n\t\t\talert(this.localize.BX_LIVECHAT_OLD_VUE);\n\t\t\tconsole.error(`LiveChatWidget.error: OLD_VUE_VERSION (${this.localize.BX_LIVECHAT_OLD_VUE_DEV.replace('#CURRENT_VERSION#', Vue.version())})`);\n\n\t\t\treturn false;\n\t\t}\n\t\telse if (!this.isWidgetDataRequested())\n\t\t{\n\t\t\tthis.requestWidgetData();\n\t\t}\n\n\t\tthis.attachTemplate();\n\t}\n\n\tclose()\n\t{\n\t\tif (this.pageMode)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tif (this.buttonInstance)\n\t\t{\n\t\t\tthis.buttonInstance.onWidgetClose();\n\t\t}\n\n\t\tthis.detachTemplate();\n\t}\n\n\tshowNotification(params)\n\t{\n\t\tif (!this.controller.getStore())\n\t\t{\n\t\t\tconsole.error('LiveChatWidget.showNotification: method can be called after fired event - onBitrixLiveChat');\n\t\t\treturn false;\n\t\t}\n\t\t// TODO show popup notification and set badge on button\n\t\t// operatorName\n\t\t// notificationText\n\t\t// counter\n\t}\n\n\tfireInitEvent()\n\t{\n\t\tif (this.initEventFired)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tthis.sendEvent({\n\t\t\ttype: SubscriptionType.configLoaded,\n\t\t\tdata: {}\n\t\t});\n\n\t\tif (this.controller.getStore().state.widget.common.reopen)\n\t\t{\n\t\t\tthis.open();\n\t\t}\n\n\t\tthis.initEventFired = true;\n\n\t\treturn true;\n\t}\n\n\tisReady()\n\t{\n\t\treturn this.ready;\n\t}\n\n\tisInited()\n\t{\n\t\treturn this.inited;\n\t}\n\n\tisUserRegistered()\n\t{\n\t\treturn !!this.getUserHash();\n\t}\n\n\tisConfigDataLoaded()\n\t{\n\t\treturn this.controller.getStore().state.widget.common.configId;\n\t}\n\n\tisWidgetDataRequested()\n\t{\n\t\treturn this.widgetDataRequested;\n\t}\n\n\tisChatLoaded()\n\t{\n\t\treturn this.controller.getStore().state.application.dialog.chatId > 0;\n\t}\n\n\tisSessionActive()\n\t{\n\t\treturn !this.controller.getStore().state.widget.dialog.sessionClose;\n\t}\n\n\tisUserAgreeConsent()\n\t{\n\t\treturn this.controller.getStore().state.widget.dialog.userConsent;\n\t}\n\n\tgetCrmTraceData()\n\t{\n\t\tlet traceData = '';\n\n\t\tif (!this.buttonInstance)\n\t\t{\n\t\t\treturn traceData;\n\t\t}\n\n\t\tif (typeof this.buttonInstance.getTrace !== 'function')\n\t\t{\n\t\t\ttraceData = this.buttonInstance.getTrace();\n\t\t}\n\t\telse if (\n\t\t\ttypeof this.buttonInstance.b24Tracker !== 'undefined'\n\t\t\t&& typeof this.buttonInstance.b24Tracker.guest !== 'undefined'\n\t\t)\n\t\t{\n\t\t\ttraceData = this.buttonInstance.b24Tracker.guest.getTrace();\n\t\t}\n\n\t\treturn traceData;\n\t}\n\n\tgetCustomData()\n\t{\n\t\tlet customData = [];\n\n\t\tif (this.customData.length > 0)\n\t\t{\n\t\t\tcustomData = this.customData;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tcustomData = [{MESSAGE: this.localize.BX_LIVECHAT_EXTRA_SITE+': [URL]'+location.href+'[/URL]'}];\n\t\t}\n\n\t\treturn JSON.stringify(customData);\n\t}\n\n\tisUserLoaded()\n\t{\n\t\treturn this.controller.getStore().state.widget.user.id > 0;\n\t}\n\n\tgetSiteId()\n\t{\n\t\treturn this.host.replace(/(http.?:\\/\\/)|([:.\\\\\\/])/mg, \"\")+this.code;\n\t}\n\n\tgetHost()\n\t{\n\t\treturn this.host;\n\t}\n\n\tgetConfigId()\n\t{\n\t\treturn this.controller.getStore().state.widget.common.configId;\n\t}\n\n\tisDialogStart()\n\t{\n\t\treturn this.controller.getStore().state.widget.common.dialogStart;\n\t}\n\n\tgetChatId()\n\t{\n\t\treturn this.controller.getStore().state.application.dialog.chatId;\n\t}\n\n\tgetDialogId()\n\t{\n\t\treturn this.controller.getStore().state.application.dialog.dialogId;\n\t}\n\n\tgetDiskFolderId()\n\t{\n\t\treturn this.controller.getStore().state.application.dialog.diskFolderId;\n\t}\n\n\tgetDialogData(dialogId = this.getDialogId())\n\t{\n\t\treturn this.controller.getStore().state.dialogues.collection[dialogId];\n\t}\n\n\tgetSessionId()\n\t{\n\t\treturn this.controller.getStore().state.widget.dialog.sessionId;\n\t}\n\n\tgetUserHash()\n\t{\n\t\treturn this.controller.getStore().state.widget.user.hash;\n\t}\n\n\tgetUserHashCookie()\n\t{\n\t\tlet userHash = '';\n\n\t\tlet cookie = Cookie.get(null, 'LIVECHAT_HASH');\n\t\tif (typeof cookie === 'string' && cookie.match(/^[a-f0-9]{32}$/))\n\t\t{\n\t\t\tuserHash= cookie;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tlet cookie = Cookie.get(this.getSiteId(), 'LIVECHAT_HASH');\n\t\t\tif (typeof cookie === 'string' && cookie.match(/^[a-f0-9]{32}$/))\n\t\t\t{\n\t\t\t\tuserHash = cookie;\n\t\t\t}\n\t\t}\n\n\t\treturn userHash;\n\t}\n\n\tgetUserId()\n\t{\n\t\treturn this.controller.getStore().state.widget.user.id;\n\t}\n\n\tgetUserData()\n\t{\n\t\tif (!this.controller.getStore())\n\t\t{\n\t\t\tconsole.error('LiveChatWidget.getUserData: method can be called after fired event - onBitrixLiveChat');\n\t\t\treturn false;\n\t\t}\n\n\t\treturn this.controller.getStore().state.widget.user;\n\t}\n\n\tgetUserRegisterFields()\n\t{\n\t\treturn {\n\t\t\t'name': this.userRegisterData.name || '',\n\t\t\t'last_name': this.userRegisterData.lastName || '',\n\t\t\t'avatar': this.userRegisterData.avatar || '',\n\t\t\t'email': this.userRegisterData.email || '',\n\t\t\t'www': this.userRegisterData.www || '',\n\t\t\t'gender': this.userRegisterData.gender || '',\n\t\t\t'position': this.userRegisterData.position || '',\n\t\t\t'user_hash': this.userRegisterData.hash || this.getUserHashCookie() || '',\n\t\t\t'consent_url': this.controller.getStore().state.widget.common.consentUrl? location.href: '',\n\t\t\t'trace_data': this.getCrmTraceData(),\n\t\t\t'custom_data': this.getCustomData()\n\t\t}\n\t}\n\n\tgetWidgetLocationCode()\n\t{\n\t\treturn LocationStyle[this.controller.getStore().state.widget.common.location];\n\t}\n\n\tsetUserRegisterData(params)\n\t{\n\t\tif (!this.controller.getStore())\n\t\t{\n\t\t\tconsole.error('LiveChatWidget.getUserData: method can be called after fired event - onBitrixLiveChat');\n\t\t\treturn false;\n\t\t}\n\n\t\tconst validUserFields = ['hash', 'name', 'lastName', 'avatar', 'email', 'www', 'gender', 'position'];\n\n\t\tif (!Utils.types.isPlainObject(params))\n\t\t{\n\t\t\tconsole.error(`%cLiveChatWidget.setUserData: params is not a object`, \"color: black;\");\n\t\t\treturn false;\n\t\t}\n\n\t\tfor (let field in this.userRegisterData)\n\t\t{\n\t\t\tif (!this.userRegisterData.hasOwnProperty(field))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (!params[field])\n\t\t\t{\n\t\t\t\tdelete this.userRegisterData[field];\n\t\t\t}\n\t\t}\n\n\t\tfor (let field in params)\n\t\t{\n\t\t\tif (!params.hasOwnProperty(field))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (validUserFields.indexOf(field) === -1)\n\t\t\t{\n\t\t\t\tconsole.warn(`%cLiveChatWidget.setUserData: user field is not set, because you are trying to set an unknown field (%c${field}%c)`, \"color: black;\", \"font-weight: bold; color: red\", \"color: black\");\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tthis.userRegisterData[field] = params[field];\n\t\t}\n\n\t\tif (\n\t\t\tthis.userRegisterData.hash\n\t\t\t&& this.getUserHash()\n\t\t\t&& this.userRegisterData.hash !== this.getUserHash()\n\t\t)\n\t\t{\n\t\t\tthis.setNewAuthToken(this.userRegisterData.hash);\n\t\t}\n\t}\n\n\tsetNewAuthToken(authToken = '')\n\t{\n\t\tthis.controller.getStoreBuilder().clearModelState();\n\t\tCookie.set(null, 'LIVECHAT_HASH', '', {expires: 365*86400, path: '/'});\n\n\t\tthis.controller.restClient.setAuthId(RestAuth.guest, authToken);\n\t}\n\n\tsetCustomData(params)\n\t{\n\t\tif (!this.controller.getStore())\n\t\t{\n\t\t\tconsole.error('LiveChatWidget.getUserData: method can be called after fired event - onBitrixLiveChat');\n\t\t\treturn false;\n\t\t}\n\n\n\t\tlet result = [];\n\t\tif (params instanceof Array)\n\t\t{\n\t\t\tparams.forEach(element =>\n\t\t\t{\n\t\t\t\tif (element && typeof element === 'object')\n\t\t\t\t{\n\t\t\t\t\tresult.push(element);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (result.length <= 0)\n\t\t\t{\n\t\t\t\tconsole.error('LiveChatWidget.setCustomData: params is empty');\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (!params)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tresult = [{'MESSAGE': params}]\n\t\t}\n\n\t\tthis.customData = this.customData.concat(result);\n\n\t\treturn true;\n\t}\n\n\tsetError(code = '', description = '')\n\t{\n\t\tconsole.error(`LiveChatWidget.error: ${code} (${description})`);\n\n\t\tlet localizeDescription = '';\n\t\tif (code === 'LIVECHAT_AUTH_FAILED')\n\t\t{\n\t\t\tlocalizeDescription = this.getLocalize('BX_LIVECHAT_AUTH_FAILED').replace('#LINK_START#', '<a href=\"javascript:void();\" onclick=\"location.reload()\">').replace('#LINK_END#', '</a>');\n\t\t\tthis.setNewAuthToken();\n\t\t}\n\t\telse if (code === 'LIVECHAT_AUTH_PORTAL_USER')\n\t\t{\n\t\t\tlocalizeDescription = this.getLocalize('BX_LIVECHAT_PORTAL_USER_NEW').replace('#LINK_START#', '<a href=\"'+this.host+'\">').replace('#LINK_END#', '</a>')\n\t\t}\n\t\telse if (code.endsWith('LOCALIZED'))\n\t\t{\n\t\t\tlocalizeDescription = description;\n\t\t}\n\n\t\tthis.controller.getStore().commit('application/set', {error: {\n\t\t\tactive: true,\n\t\t\tcode,\n\t\t\tdescription: localizeDescription\n\t\t}});\n\t}\n\n\tclearError()\n\t{\n\t\tthis.controller.getStore().commit('application/set', {error: {\n\t\t\tactive: false,\n\t\t\tcode: '',\n\t\t\tdescription: ''}\n\t\t});\n\t}\n\n\t/**\n\t *\n\t * @param params {Object}\n\t * @returns {Function|Boolean} - Unsubscribe callback function or False\n\t */\n\tsubscribe(params)\n\t{\n\t\tif (!Utils.types.isPlainObject(params))\n\t\t{\n\t\t\tconsole.error(`%cLiveChatWidget.subscribe: params is not a object`, \"color: black;\");\n\t\t\treturn false;\n\t\t}\n\n\t\tif (!SubscriptionTypeCheck.includes(params.type))\n\t\t{\n\t\t\tconsole.error(`%cLiveChatWidget.subscribe: subscription type is not correct (%c${params.type}%c)`, \"color: black;\", \"font-weight: bold; color: red\", \"color: black\");\n\t\t\treturn false;\n\t\t}\n\n\t\tif (typeof params.callback !== 'function')\n\t\t{\n\t\t\tconsole.error(`%cLiveChatWidget.subscribe: callback is not a function (%c${typeof params.callback}%c)`, \"color: black;\", \"font-weight: bold; color: red\", \"color: black\");\n\t\t\treturn false;\n\t\t}\n\n\t\tif (typeof (this.subscribers[params.type]) === 'undefined')\n\t\t{\n\t\t\tthis.subscribers[params.type] = [];\n\t\t}\n\n\t\tthis.subscribers[params.type].push(params.callback);\n\n\t\treturn function () {\n\t\t\tthis.subscribers[params.type] = this.subscribers[params.type].filter(function(element) {\n\t\t\t\treturn element !== params.callback;\n\t\t\t});\n\t\t}.bind(this);\n\t}\n\n\t/**\n\t *\n\t * @param params {Object}\n\t * @returns {boolean}\n\t */\n\tsendEvent(params)\n\t{\n\t\tparams = params || {};\n\n\t\tif (!params.type)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tif (typeof params.data !== 'object' || !params.data)\n\t\t{\n\t\t\tparams.data = {};\n\t\t}\n\n\t\tif (this.subscribers[params.type] instanceof Array && this.subscribers[params.type].length > 0)\n\t\t{\n\t\t\tthis.subscribers[params.type].forEach(callback => callback(params.data));\n\t\t}\n\n\t\tif (this.subscribers[SubscriptionType.every] instanceof Array && this.subscribers[SubscriptionType.every].length > 0)\n\t\t{\n\t\t\tthis.subscribers[SubscriptionType.every].forEach(callback => callback({type: params.type, data: params.data}));\n\t\t}\n\n\t\treturn true;\n\t}\n\n\taddLocalize(phrases)\n\t{\n\t\tif (typeof phrases !== \"object\" || !phrases)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tfor (let name in phrases)\n\t\t{\n\t\t\tif (phrases.hasOwnProperty(name))\n\t\t\t{\n\t\t\t\tthis.localize[name] = phrases[name];\n\t\t\t}\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tgetLocalize(name)\n\t{\n\t\tlet phrase = '';\n\t\tif (typeof name === 'undefined')\n\t\t{\n\t\t\treturn this.localize;\n\t\t}\n\t\telse if (typeof this.localize[name.toString()] === 'undefined')\n\t\t{\n\t\t\tconsole.warn(`LiveChatWidget.getLocalize: message with code '${name.toString()}' is undefined.`)\n\t\t}\n\t\telse\n\t\t{\n\t\t\tphrase = this.localize[name];\n\t\t}\n\n\t\treturn phrase;\n\t}\n\n/* endregion 05. Widget interaction and utils */\n}","/**\n * Bitrix OpenLines widget\n * Widget public interface\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {Widget} from \"./widget\"\nimport {SubscriptionType} from \"./const\";\n\nexport class WidgetPublicManager\n{\n\tconstructor(config)\n\t{\n\t\tthis.developerInfo = 'Do not use private methods.';\n\t\tthis.__privateMethods__ = new Widget(config);\n\t\tthis.__createLegacyMethods();\n\t}\n\n\topen(params)\n\t{\n\t\treturn this.__privateMethods__.open(params);\n\t}\n\n\tclose()\n\t{\n\t\treturn this.__privateMethods__.close();\n\t}\n\n\tshowNotification(params)\n\t{\n\t\treturn this.__privateMethods__.showNotification(params);\n\t}\n\n\tgetUserData()\n\t{\n\t\treturn this.__privateMethods__.getUserData();\n\t}\n\n\tsetUserRegisterData(params)\n\t{\n\t\treturn this.__privateMethods__.setUserRegisterData(params);\n\t}\n\n\tsetCustomData(params)\n\t{\n\t\treturn this.__privateMethods__.setCustomData(params);\n\t}\n\n\tmutateTemplateComponent(id, params)\n\t{\n\t\treturn this.__privateMethods__.mutateTemplateComponent(id, params);\n\t}\n\n\taddLocalize(phrases)\n\t{\n\t\treturn this.__privateMethods__.addLocalize(phrases);\n\t}\n\n\t/**\n\t *\n\t * @param params {Object}\n\t * @returns {Function|Boolean} - Unsubscribe callback function or False\n\t */\n\tsubscribe(params)\n\t{\n\t\treturn this.__privateMethods__.subscribe(params);\n\t}\n\n\tstart()\n\t{\n\t\treturn this.__privateMethods__.start();\n\t}\n\n\t__createLegacyMethods()\n\t{\n\t\tif (typeof window.BX.LiveChat === 'undefined')\n\t\t{\n\t\t\tlet sourceHref = document.createElement('a');\n\t\t\tsourceHref.href = this.__privateMethods__.host;\n\n\t\t\tlet sourceDomain = sourceHref.protocol+'//'+sourceHref.hostname+(sourceHref.port && sourceHref.port != '80' && sourceHref.port != '443'? \":\"+sourceHref.port: \"\");\n\n\t\t\twindow.BX.LiveChat = {\n\t\t\t\topenLiveChat: () => {\n\t\t\t\t\tthis.open({openFromButton: true});\n\t\t\t\t},\n\t\t\t\tcloseLiveChat: () => {\n\t\t\t\t\tthis.close();\n\t\t\t\t},\n\t\t\t\taddEventListener: (el, eventName, handler) =>\n\t\t\t\t{\n\t\t\t\t\tif (eventName === 'message')\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.subscribe({\n\t\t\t\t\t\t\ttype: SubscriptionType.userMessage,\n\t\t\t\t\t\t\tcallback: function (event)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\thandler({origin: sourceDomain, data: JSON.stringify({action: 'sendMessage'}), event});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tconsole.warn('Method BX.LiveChat.addEventListener is not supported, user new format for subscribe.')\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tsetCookie: () => {},\n\t\t\t\tgetCookie: () => {},\n\t\t\t\tsourceDomain\n\t\t\t};\n\t\t}\n\n\t\tif (typeof window.BxLiveChatInit === 'function')\n\t\t{\n\t\t\tlet config = window.BxLiveChatInit();\n\n\t\t\tif (config.user)\n\t\t\t{\n\t\t\t\tthis.__privateMethods__.setUserRegisterData(config.user);\n\t\t\t}\n\t\t\tif (config.firstMessage)\n\t\t\t{\n\t\t\t\tthis.__privateMethods__.setCustomData(config.firstMessage)\n\t\t\t}\n\t\t}\n\n\t\tif (window.BxLiveChatLoader instanceof Array)\n\t\t{\n\t\t\twindow.BxLiveChatLoader.forEach(callback => callback());\n\t\t}\n\n\t\treturn true;\n\t}\n}","/**\n * Bitrix OpenLines widget\n * LiveChat base component (Vue component)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {Vue} from \"ui.vue\";\nimport {Vuex} from \"ui.vue.vuex\";\nimport {Utils} from \"im.lib.utils\";\nimport {Logger} from \"im.lib.logger\";\nimport {FormType, VoteType, LocationStyle, LocationType, LanguageType} from \"../const\";\nimport {DeviceType, DeviceOrientation, EventType} from \"im.const\";\nimport {md5} from \"main.md5\";\n\n/**\n * @notice Do not mutate or clone this component! It is under development.\n */\n\nVue.component('bx-livechat',\n{\n\tdata()\n\t{\n\t\treturn {\n\t\t\tviewPortMetaSiteNode: null,\n\t\t\tviewPortMetaWidgetNode: null,\n\t\t\tstoredMessage: '',\n\t\t\tstoredFile: null,\n\t\t\twidgetMinimumHeight: 435,\n\t\t\twidgetMinimumWidth: 340,\n\t\t\twidgetBaseHeight: 557,\n\t\t\twidgetBaseWidth: 435,\n\t\t\twidgetMargin: 50,\n\t\t\twidgetAvailableHeight: 0,\n\t\t\twidgetAvailableWidth: 0,\n\t\t\twidgetCurrentHeight: 0,\n\t\t\twidgetCurrentWidth: 0,\n\t\t\twidgetDrag: false,\n\t\t\ttextareaFocused: false,\n\t\t\ttextareaDrag: false,\n\t\t\ttextareaHeight: 100,\n\t\t\ttextareaMinimumHeight: 100,\n\t\t\ttextareaMaximumHeight: Utils.device.isMobile()? 200: 300,\n\t\t}\n\t},\n\tcreated()\n\t{\n\t\tthis.onCreated();\n\n\t\tdocument.addEventListener('keydown', this.onWindowKeyDown);\n\t\tif(!Utils.device.isMobile() && !this.widget.common.pageMode)\n\t\t{\n\t\t\twindow.addEventListener('resize', this.getAvailableSpaceFunc = Utils.throttle(this.getAvailableSpace, 50));\n\t\t}\n\t\tthis.$root.$on('requestShowForm', this.onRequestShowForm);\n\t},\n\tbeforeDestroy()\n\t{\n\t\tdocument.removeEventListener('keydown', this.onWindowKeyDown);\n\t\tif(!Utils.device.isMobile() && !this.widget.common.pageMode)\n\t\t{\n\t\t\twindow.removeEventListener('resize', this.getAvailableSpaceFunc);\n\t\t}\n\t\tthis.$root.$off('requestShowForm', this.onRequestShowForm);\n\n\t\tthis.onTextareaDragEventRemove();\n\t},\n\tcomputed:\n\t{\n\t\tFormType: () => FormType,\n\t\tVoteType: () => VoteType,\n\t\tDeviceType: () => DeviceType,\n\t\tEventType: () => EventType,\n\n\t\ttextareaHeightStyle(state)\n\t\t{\n\t\t\treturn {flex: '0 0 '+this.textareaHeight+'px'};\n\t\t},\n\t\ttextAreaBottomMargin()\n\t\t{\n\t\t\tif (!this.widget.common.copyright && !this.isBottomLocation)\n\t\t\t{\n\t\t\t\treturn {marginBottom: '5px'};\n\t\t\t}\n\t\t\treturn '';\n\t\t},\n\t\twidgetBaseSizes()\n\t\t{\n\t\t\treturn {\n\t\t\t\twidth: this.widgetBaseWidth,\n\t\t\t\theight: this.widgetBaseHeight,\n\t\t\t}\n\t\t},\n\t\twidgetHeightStyle()\n\t\t{\n\t\t\tif(Utils.device.isMobile() || this.widget.common.pageMode)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.widgetAvailableHeight < this.widgetBaseSizes.height || this.widgetAvailableHeight < this.widgetCurrentHeight)\n\t\t\t{\n\t\t\t\tthis.widgetCurrentHeight = Math.max(this.widgetAvailableHeight, this.widgetMinimumHeight);\n\t\t\t}\n\n\t\t\treturn this.widgetCurrentHeight+'px';\n\t\t},\n\t\twidgetWidthStyle()\n\t\t{\n\t\t\tif(Utils.device.isMobile() || this.widget.common.pageMode)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.widgetAvailableWidth < this.widgetBaseSizes.width || this.widgetAvailableWidth < this.widgetCurrentWidth)\n\t\t\t{\n\t\t\t\tthis.widgetCurrentWidth = Math.max(this.widgetAvailableWidth, this.widgetMinimumWidth);\n\t\t\t}\n\n\t\t\treturn this.widgetCurrentWidth+'px';\n\t\t},\n\t\tuserSelectStyle()\n\t\t{\n\t\t\treturn this.widgetDrag ? 'none' : 'auto';\n\t\t},\n\t\tisBottomLocation()\n\t\t{\n\t\t\treturn [LocationType.bottomLeft, LocationType.bottomMiddle, LocationType.bottomRight].includes(this.widget.common.location);\n\t\t},\n\t\tisLeftLocation()\n\t\t{\n\t\t\treturn [LocationType.bottomLeft, LocationType.topLeft, LocationType.topMiddle].includes(this.widget.common.location);\n\t\t},\n\t\tlocalize()\n\t\t{\n\t\t\treturn Vue.getFilteredPhrases('BX_LIVECHAT_', this.$root.$bitrixMessages);\n\t\t},\n\t\twidgetMobileDisabled(state)\n\t\t{\n\t\t\tif (state.application.device.type === DeviceType.mobile)\n\t\t\t{\n\t\t\t\tif (navigator.userAgent.toString().includes('iPad'))\n\t\t\t\t{\n\t\t\t\t}\n\t\t\t\telse if (state.application.device.orientation === DeviceOrientation.horizontal)\n\t\t\t\t{\n\t\t\t\t\tif (navigator.userAgent.toString().includes('iPhone'))\n\t\t\t\t\t{\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\treturn !(typeof window.screen === 'object' && window.screen.availHeight >= 800);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn false;\n\t\t},\n\t\twidgetClassName(state)\n\t\t{\n\t\t\tlet className = ['bx-livechat-wrapper'];\n\n\t\t\tclassName.push('bx-livechat-show');\n\n\t\t\tif (state.widget.common.pageMode)\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-page-mode');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-position-'+LocationStyle[state.widget.common.location]);\n\t\t\t}\n\n\t\t\tif (state.application.common.languageId === LanguageType.russian)\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-logo-ru');\n\t\t\t}\n\t\t\telse if (state.application.common.languageId === LanguageType.ukraine)\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-logo-ua');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-logo-en');\n\t\t\t}\n\n\t\t\tif (!state.widget.common.online)\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-offline-state');\n\t\t\t}\n\n\t\t\tif (state.widget.common.dragged)\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-drag-n-drop');\n\t\t\t}\n\n\t\t\tif (state.widget.common.dialogStart)\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-chat-start');\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\tstate.widget.dialog.operator.name\n\t\t\t\t&& !(state.application.device.type === DeviceType.mobile && state.application.device.orientation === DeviceOrientation.horizontal)\n\t\t\t)\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-has-operator');\n\t\t\t}\n\n\t\t\tif (Utils.device.isMobile())\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-mobile');\n\t\t\t}\n\t\t\telse if (Utils.browser.isSafari())\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-browser-safari');\n\t\t\t}\n\t\t\telse if (Utils.browser.isIe())\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-browser-ie');\n\t\t\t}\n\n\t\t\tif (Utils.platform.isMac())\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-mac');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-custom-scroll');\n\t\t\t}\n\n\t\t\tif (state.widget.common.styles.backgroundColor && Utils.isDarkColor(state.widget.common.styles.iconColor))\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-bright-header');\n\t\t\t}\n\n\t\t\treturn className.join(' ');\n\t\t},\n\t\tshowMessageDialog()\n\t\t{\n\t\t\treturn this.messageCollection.length > 0;\n\t\t},\n\t\tquotePanelData()\n\t\t{\n\t\t\tlet result = {\n\t\t\t\tid: 0,\n\t\t\t\ttitle: '',\n\t\t\t\tdescription: '',\n\t\t\t\tcolor: ''\n\t\t\t};\n\t\t\tif (!this.dialog.quoteId)\n\t\t\t{\n\t\t\t\treturn result;\n\t\t\t}\n\n\t\t\tlet message = this.$store.getters['messages/getMessage'](this.dialog.chatId, this.dialog.quoteId);\n\t\t\tif (!message)\n\t\t\t{\n\t\t\t\treturn result;\n\t\t\t}\n\n\t\t\tlet user = this.$store.getters['users/get'](message.authorId);\n\n\t\t\tresult = {\n\t\t\t\tid: this.dialog.quoteId,\n\t\t\t\ttitle: user? user.name: '',\n\t\t\t\tcolor: user? user.color: '',\n\t\t\t\tdescription: message.textConverted? message.textConverted: this.localize.BX_LIVECHAT_FILE_MESSAGE\n\t\t\t};\n\n\t\t\treturn result;\n\t\t},\n\t\t...Vuex.mapState({\n\t\t\twidget: state => state.widget,\n\t\t\tapplication: state => state.application,\n\t\t\tdialog: state => state.dialogues.collection[state.application.dialog.dialogId],\n\t\t\tmessageCollection: state => state.messages.collection[state.application.dialog.chatId]\n\t\t})\n\t},\n\twatch:\n\t{\n\t\tsessionClose(value)\n\t\t{\n\t\t\tLogger.log('sessionClose change', value);\n\t\t}\n\t},\n\tmethods:\n\t{\n\t\tclose(event)\n\t\t{\n\t\t\tif (this.widget.common.pageMode)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tthis.onBeforeClose();\n\t\t\tthis.$store.commit('widget/common', {showed: false});\n\t\t},\n\t\tgetAvailableSpace()\n\t\t{\n\t\t\tif (this.isBottomLocation)\n\t\t\t{\n\t\t\t\tlet bottomPosition = this.$refs.widgetWrapper.getBoundingClientRect().bottom;\n\t\t\t\tlet widgetBottomMargin = window.innerHeight - bottomPosition;\n\t\t\t\tthis.widgetAvailableHeight = window.innerHeight - this.widgetMargin - widgetBottomMargin;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tlet topPosition = this.$refs.widgetWrapper.getBoundingClientRect().top;\n\t\t\t\tthis.widgetAvailableHeight = window.innerHeight - this.widgetMargin - topPosition;\n\t\t\t}\n\n\t\t\tthis.widgetAvailableWidth = window.innerWidth - this.widgetMargin * 2;\n\t\t},\n\t\tshowLikeForm()\n\t\t{\n\t\t\tif (this.offline)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tclearTimeout(this.showFormTimeout);\n\t\t\tif (!this.widget.common.vote.enable)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tif (\n\t\t\t\tthis.widget.dialog.sessionClose\n\t\t\t\t&& this.widget.dialog.userVote !== VoteType.none\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tthis.$store.commit('widget/common', {showForm: FormType.like});\n\t\t},\n\t\tshowWelcomeForm()\n\t\t{\n\t\t\tclearTimeout(this.showFormTimeout);\n\t\t\tthis.$store.commit('widget/common', {showForm: FormType.welcome});\n\t\t},\n\t\tshowOfflineForm()\n\t\t{\n\t\t\tclearTimeout(this.showFormTimeout);\n\n\t\t\tif (this.widget.dialog.showForm !== FormType.welcome)\n\t\t\t{\n\t\t\t\tthis.$store.commit('widget/common', {showForm: FormType.offline});\n\t\t\t}\n\t\t},\n\t\tshowHistoryForm()\n\t\t{\n\t\t\tclearTimeout(this.showFormTimeout);\n\t\t\tthis.$store.commit('widget/common', {showForm: FormType.history});\n\t\t},\n\t\thideForm()\n\t\t{\n\t\t\tclearTimeout(this.showFormTimeout);\n\n\t\t\tif (this.widget.common.showForm !== FormType.none)\n\t\t\t{\n\t\t\t\tthis.$store.commit('widget/common', {showForm: FormType.none});\n\t\t\t}\n\t\t},\n\t\tshowConsentWidow()\n\t\t{\n\t\t\tthis.$store.commit('widget/common', {showConsent: true});\n\t\t},\n\t\tagreeConsentWidow()\n\t\t{\n\t\t\tthis.$store.commit('widget/common', {showConsent: false});\n\n\t\t\tthis.$root.$bitrixApplication.sendConsentDecision(true);\n\n\t\t\tif (this.storedMessage || this.storedFile)\n\t\t\t{\n\t\t\t\tif (this.storedMessage)\n\t\t\t\t{\n\t\t\t\t\tthis.onTextareaSend({focus: this.application.device.type !== DeviceType.mobile});\n\t\t\t\t\tthis.storedMessage = '';\n\t\t\t\t}\n\t\t\t\tif (this.storedFile)\n\t\t\t\t{\n\t\t\t\t\tthis.onTextareaFileSelected();\n\t\t\t\t\tthis.storedFile = '';\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (this.widget.common.showForm === FormType.none)\n\t\t\t{\n\t\t\t\tthis.$root.$emit(EventType.textarea.focus);\n\t\t\t}\n\t\t},\n\t\tdisagreeConsentWidow()\n\t\t{\n\t\t\tthis.$store.commit('widget/common', {showForm : FormType.none});\n\t\t\tthis.$store.commit('widget/common', {showConsent : false});\n\n\t\t\tthis.$root.$bitrixApplication.sendConsentDecision(false);\n\n\t\t\tif (this.storedMessage)\n\t\t\t{\n\t\t\t\tthis.$root.$emit(EventType.textarea.insertText, {\n\t\t\t\t\ttext: this.storedMessage,\n\t\t\t\t\tfocus: this.application.device.type !== DeviceType.mobile\n\t\t\t\t});\n\t\t\t\tthis.storedMessage = '';\n\t\t\t}\n\t\t\tif (this.storedFile)\n\t\t\t{\n\t\t\t\tthis.storedFile = '';\n\t\t\t}\n\n\t\t\tif (this.application.device.type !== DeviceType.mobile)\n\t\t\t{\n\t\t\t\tthis.$root.$emit(EventType.textarea.focus);\n\t\t\t}\n\t\t},\n\t\tlogEvent(name, ...params)\n\t\t{\n\t\t\tLogger.info(name, ...params);\n\t\t},\n\t\tonCreated()\n\t\t{\n\t\t\tif(Utils.device.isMobile())\n\t\t\t{\n\t\t\t\tlet viewPortMetaSiteNode = Array.from(\n\t\t\t\t\tdocument.head.getElementsByTagName('meta')\n\t\t\t\t).filter(element => element.name === 'viewport')[0];\n\n\t\t\t\tif (viewPortMetaSiteNode)\n\t\t\t\t{\n\t\t\t\t\tthis.viewPortMetaSiteNode = viewPortMetaSiteNode;\n\t\t\t\t\tdocument.head.removeChild(this.viewPortMetaSiteNode);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tlet contentWidth = document.body.offsetWidth;\n\t\t\t\t\tif (contentWidth < window.innerWidth)\n\t\t\t\t\t{\n\t\t\t\t\t\tcontentWidth = window.innerWidth;\n\t\t\t\t\t}\n\t\t\t\t\tif (contentWidth < 1024)\n\t\t\t\t\t{\n\t\t\t\t\t\tcontentWidth = 1024;\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.viewPortMetaSiteNode = document.createElement('meta');\n\t\t\t\t\tthis.viewPortMetaSiteNode.setAttribute('name', 'viewport');\n\t\t\t\t\tthis.viewPortMetaSiteNode.setAttribute('content', `width=${contentWidth}, initial-scale=1.0, user-scalable=1`);\n\t\t\t\t}\n\n\t\t\t\tif (!this.viewPortMetaWidgetNode)\n\t\t\t\t{\n\t\t\t\t\tthis.viewPortMetaWidgetNode = document.createElement('meta');\n\t\t\t\t\tthis.viewPortMetaWidgetNode.setAttribute('name', 'viewport');\n\t\t\t\t\tthis.viewPortMetaWidgetNode.setAttribute('content', 'width=device-width, initial-scale=1.0, user-scalable=0');\n\t\t\t\t\tdocument.head.appendChild(this.viewPortMetaWidgetNode);\n\t\t\t\t}\n\n\t\t\t\tdocument.body.classList.add('bx-livechat-mobile-state');\n\n\t\t\t\tif (Utils.browser.isSafariBased())\n\t\t\t\t{\n\t\t\t\t\tdocument.body.classList.add('bx-livechat-mobile-safari-based');\n\t\t\t\t}\n\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tthis.$store.dispatch('widget/show');\n\t\t\t\t}, 50);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.$store.dispatch('widget/show').then(() => {\n\t\t\t\t\tthis.widgetCurrentHeight = this.widgetBaseSizes.height;\n\t\t\t\t\tthis.widgetCurrentWidth = this.widgetBaseSizes.width;\n\t\t\t\t\tthis.getAvailableSpace();\n\n\t\t\t\t\tthis.widgetCurrentHeight = this.widget.common.widgetHeight || this.widgetCurrentHeight;\n\t\t\t\t\tthis.widgetCurrentWidth = this.widget.common.widgetWidth || this.widgetCurrentWidth;\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis.textareaHeight = this.widget.common.textareaHeight || this.textareaHeight;\n\n\t\t\tthis.$store.commit('files/initCollection', {chatId: this.$root.$bitrixApplication.getChatId()});\n\t\t\tthis.$store.commit('messages/initCollection', {chatId: this.$root.$bitrixApplication.getChatId()});\n\t\t\tthis.$store.commit('dialogues/initCollection', {dialogId: this.$root.$bitrixApplication.getDialogId(), fields: {\n\t\t\t\tentityType: 'LIVECHAT',\n\t\t\t\ttype: 'livechat'\n\t\t\t}});\n\t\t},\n\t\tonBeforeClose()\n\t\t{\n\t\t\tif(Utils.device.isMobile())\n\t\t\t{\n\t\t\t\tdocument.body.classList.remove('bx-livechat-mobile-state');\n\n\t\t\t\tif (Utils.browser.isSafariBased())\n\t\t\t\t{\n\t\t\t\t\tdocument.body.classList.remove('bx-livechat-mobile-safari-based');\n\t\t\t\t}\n\n\t\t\t\tif (this.viewPortMetaWidgetNode)\n\t\t\t\t{\n\t\t\t\t\tdocument.head.removeChild(this.viewPortMetaWidgetNode);\n\t\t\t\t\tthis.viewPortMetaWidgetNode = null;\n\t\t\t\t}\n\n\t\t\t\tif (this.viewPortMetaSiteNode)\n\t\t\t\t{\n\t\t\t\t\tdocument.head.appendChild(this.viewPortMetaSiteNode);\n\t\t\t\t\tthis.viewPortMetaSiteNode = null;\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tonAfterClose()\n\t\t{\n\t\t\tthis.$root.$bitrixApplication.close();\n\t\t},\n\t\tonRequestShowForm(event)\n\t\t{\n\t\t\tclearTimeout(this.showFormTimeout);\n\t\t\tif (event.type === FormType.welcome)\n\t\t\t{\n\t\t\t\tif (event.delayed)\n\t\t\t\t{\n\t\t\t\t\tthis.showFormTimeout = setTimeout(() => {\n\t\t\t\t\t\tthis.showWelcomeForm();\n\t\t\t\t\t}, 5000);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.showWelcomeForm();\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (event.type === FormType.offline)\n\t\t\t{\n\t\t\t\tif (event.delayed)\n\t\t\t\t{\n\t\t\t\t\tthis.showFormTimeout = setTimeout(() => {\n\t\t\t\t\t\tthis.showOfflineForm();\n\t\t\t\t\t}, 3000);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.showOfflineForm();\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (event.type === FormType.like)\n\t\t\t{\n\t\t\t\tif (event.delayed)\n\t\t\t\t{\n\t\t\t\t\tthis.showFormTimeout = setTimeout(() => {\n\t\t\t\t\t\tthis.showLikeForm();\n\t\t\t\t\t}, 5000);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.showLikeForm();\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tonDialogRequestHistory(event)\n\t\t{\n\t\t\tthis.$root.$bitrixApplication.getDialogHistory(event.lastId);\n\t\t},\n\t\tonDialogRequestUnread(event)\n\t\t{\n\t\t\tthis.$root.$bitrixApplication.getDialogUnread(event.lastId);\n\t\t},\n\t\tonDialogMessageClickByUserName(event)\n\t\t{\n\t\t\t// TODO name push to auto-replace mention holder - User Name -> [USER=274]User Name[/USER]\n\t\t\tthis.$root.$emit(EventType.textarea.insertText, {text: event.user.name+' '});\n\t\t},\n\t\tonDialogMessageClickByUploadCancel(event)\n\t\t{\n\t\t\tthis.$root.$bitrixApplication.cancelUploadFile(event.file.id);\n\t\t},\n\t\tonDialogMessageClickByKeyboardButton(event)\n\t\t{\n\t\t\tthis.$root.$bitrixApplication.execMessageKeyboardCommand(event);\n\t\t},\n\t\tonDialogMessageClickByCommand(event)\n\t\t{\n\t\t\tif (event.type === 'put')\n\t\t\t{\n\t\t\t\tthis.$root.$emit(EventType.textarea.insertText, {text: event.value+' '});\n\t\t\t}\n\t\t\telse if (event.type === 'send')\n\t\t\t{\n\t\t\t\tthis.$root.$bitrixApplication.addMessage(event.value);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tLogger.warn('Unprocessed command', event);\n\t\t\t}\n\t\t},\n\t\tonDialogMessageMenuClick(event)\n\t\t{\n\t\t\tLogger.warn('Message menu:', event);\n\t\t},\n\t\tonDialogMessageRetryClick(event)\n\t\t{\n\t\t\tLogger.warn('Message retry:', event);\n\t\t\tthis.$root.$bitrixApplication.retrySendMessage(event.message);\n\t\t},\n\t\tonDialogReadMessage(event)\n\t\t{\n\t\t\tthis.$root.$bitrixApplication.readMessage(event.id);\n\t\t},\n\t\tonDialogQuoteMessage(event)\n\t\t{\n\t\t\tthis.$root.$bitrixApplication.quoteMessage(event.message.id);\n\t\t},\n\t\tonDialogMessageReactionSet(event)\n\t\t{\n\t\t\tthis.$root.$bitrixApplication.reactMessage(event.message.id, event.reaction);\n\t\t},\n\t\tonDialogClick(event)\n\t\t{\n\t\t\tif (this.widget.common.showForm !== FormType.none)\n\t\t\t{\n\t\t\t\tthis.$store.commit('widget/common', {showForm: FormType.none});\n\t\t\t}\n\t\t},\n\t\tonTextareaKeyUp(event)\n\t\t{\n\t\t\tif (\n\t\t\t\tthis.widget.common.watchTyping\n\t\t\t\t&& this.widget.dialog.sessionId\n\t\t\t\t&& !this.widget.dialog.sessionClose\n\t\t\t\t&& this.widget.dialog.operator.id\n\t\t\t\t&& this.widget.dialog.operatorChatId\n\t\t\t\t&& this.$root.$bitrixPullClient.isPublishingEnabled()\n\t\t\t)\n\t\t\t{\n\t\t\t\tlet infoString = md5(\n\t\t\t\t\tthis.widget.dialog.sessionId\n\t\t\t\t\t+ '/' + this.application.dialog.chatId\n\t\t\t\t\t+ '/' + this.widget.user.id\n\t\t\t\t);\n\t\t\t\tthis.$root.$bitrixPullClient.sendMessage(\n\t\t\t\t\t[this.widget.dialog.operator.id],\n\t\t\t\t\t'imopenlines',\n\t\t\t\t\t'linesMessageWrite',\n\t\t\t\t\t{\n\t\t\t\t\t\ttext: event.text,\n\t\t\t\t\t\tinfoString,\n\t\t\t\t\t\toperatorChatId: this.widget.dialog.operatorChatId\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t},\n\t\tonTextareaSend(event)\n\t\t{\n\t\t\tevent.focus = event.focus !== false;\n\n\t\t\tif (this.widget.common.showForm === FormType.smile)\n\t\t\t{\n\t\t\t\tthis.$store.commit('widget/common', {showForm: FormType.none});\n\t\t\t}\n\n\t\t\tif (!this.widget.dialog.userConsent && this.widget.common.consentUrl)\n\t\t\t{\n\t\t\t\tif (event.text)\n\t\t\t\t{\n\t\t\t\t\tthis.storedMessage = event.text;\n\t\t\t\t}\n\t\t\t\tthis.showConsentWidow();\n\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tevent.text = event.text? event.text: this.storedMessage;\n\t\t\tif (!event.text)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tthis.hideForm();\n\t\t\tthis.$root.$bitrixApplication.addMessage(event.text);\n\n\t\t\tif (event.focus)\n\t\t\t{\n\t\t\t\tthis.$root.$emit(EventType.textarea.focus);\n\t\t\t}\n\n\t\t\treturn true;\n\t\t},\n\t\tonTextareaWrites(event)\n\t\t{\n\t\t\tthis.$root.$bitrixController.application.startWriting();\n\t\t},\n\t\tonTextareaFocus(event)\n\t\t{\n\t\t\tif (\n\t\t\t\tthis.widget.common.copyright &&\n\t\t\t\tthis.application.device.type === DeviceType.mobile\n\t\t\t)\n\t\t\t{\n\t\t\t\tthis.widget.common.copyright = false;\n\t\t\t}\n\t\t\tif (Utils.device.isMobile())\n\t\t\t{\n\t\t\t\tclearTimeout(this.onTextareaFocusScrollTimeout);\n\t\t\t\tthis.onTextareaFocusScrollTimeout = setTimeout(() => {\n\t\t\t\t\tdocument.addEventListener('scroll', this.onWindowScroll);\n\t\t\t\t}, 1000);\n\t\t\t}\n\t\t\tthis.textareaFocused = true;\n\t\t},\n\t\tonTextareaBlur(event)\n\t\t{\n\t\t\tif (!this.widget.common.copyright && this.widget.common.copyright !== this.$root.$bitrixApplication.copyright)\n\t\t\t{\n\t\t\t\tthis.widget.common.copyright = this.$root.$bitrixApplication.copyright;\n\t\t\t\tthis.$nextTick(() => {\n\t\t\t\t\tthis.$root.$emit(EventType.dialog.scrollToBottom, {force: true});\n\t\t\t\t});\n\t\t\t}\n\t\t\tif (Utils.device.isMobile())\n\t\t\t{\n\t\t\t\tclearTimeout(this.onTextareaFocusScrollTimeout);\n\t\t\t\tdocument.removeEventListener('scroll', this.onWindowScroll);\n\t\t\t}\n\n\t\t\tthis.textareaFocused = false;\n\t\t},\n\t\tonTextareaStartDrag(event)\n\t\t{\n\t\t\tif (this.textareaDrag)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tLogger.log('Livechat: textarea drag started');\n\n\t\t\tthis.textareaDrag = true;\n\n\t\t\tevent = event.changedTouches ? event.changedTouches[0] : event;\n\n\t\t\tthis.textareaDragCursorStartPoint = event.clientY;\n\t\t\tthis.textareaDragHeightStartPoint = this.textareaHeight;\n\n\t\t\tthis.onTextareaDragEventAdd();\n\n\t\t\tthis.$root.$emit(EventType.textarea.blur, true);\n\t\t},\n\t\tonTextareaContinueDrag(event)\n\t\t{\n\t\t\tif (!this.textareaDrag)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tevent = event.changedTouches ? event.changedTouches[0] : event;\n\n\t\t\tthis.textareaDragCursorControlPoint = event.clientY;\n\n\t\t\tlet textareaHeight = Math.max(\n\t\t\t\tMath.min(this.textareaDragHeightStartPoint + this.textareaDragCursorStartPoint - this.textareaDragCursorControlPoint, this.textareaMaximumHeight)\n\t\t\t, this.textareaMinimumHeight);\n\n\t\t\tLogger.log('Livechat: textarea drag', 'new: '+textareaHeight, 'curr: '+this.textareaHeight);\n\n\t\t\tif (this.textareaHeight !== textareaHeight)\n\t\t\t{\n\t\t\t\tthis.textareaHeight = textareaHeight;\n\t\t\t}\n\t\t},\n\t\tonTextareaStopDrag()\n\t\t{\n\t\t\tif (!this.textareaDrag)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tLogger.log('Livechat: textarea drag ended');\n\n\t\t\tthis.textareaDrag = false;\n\n\t\t\tthis.onTextareaDragEventRemove();\n\n\t\t\tthis.$store.commit('widget/common', {textareaHeight: this.textareaHeight});\n\t\t\tthis.$root.$emit(EventType.dialog.scrollToBottom, {force: true});\n\t\t},\n\t\tonTextareaDragEventAdd()\n\t\t{\n\t\t\tdocument.addEventListener('mousemove', this.onTextareaContinueDrag);\n\t\t\tdocument.addEventListener('touchmove', this.onTextareaContinueDrag);\n\t\t\tdocument.addEventListener('touchend', this.onTextareaStopDrag);\n\t\t\tdocument.addEventListener('mouseup', this.onTextareaStopDrag);\n\t\t\tdocument.addEventListener('mouseleave', this.onTextareaStopDrag);\n\t\t},\n\t\tonTextareaDragEventRemove()\n\t\t{\n\t\t\tdocument.removeEventListener('mousemove', this.onTextareaContinueDrag);\n\t\t\tdocument.removeEventListener('touchmove', this.onTextareaContinueDrag);\n\t\t\tdocument.removeEventListener('touchend', this.onTextareaStopDrag);\n\t\t\tdocument.removeEventListener('mouseup', this.onTextareaStopDrag);\n\t\t\tdocument.removeEventListener('mouseleave', this.onTextareaStopDrag);\n\t\t},\n\t\tonTextareaFileSelected(event)\n\t\t{\n\t\t\tlet fileInputEvent = null;\n\t\t\tif (event && event.fileChangeEvent && event.fileChangeEvent.target.files.length > 0)\n\t\t\t{\n\t\t\t\tfileInputEvent = event.fileChangeEvent;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tfileInputEvent =  this.storedFile;\n\t\t\t}\n\n\t\t\tif (!fileInputEvent)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (!this.widget.dialog.userConsent && this.widget.common.consentUrl)\n\t\t\t{\n\t\t\t\tthis.storedFile = event.fileChangeEvent;\n\t\t\t\tthis.showConsentWidow();\n\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tthis.$root.$bitrixApplication.uploadFile(fileInputEvent);\n\t\t},\n\t\tonTextareaAppButtonClick(event)\n\t\t{\n\t\t\tif (event.appId === FormType.smile)\n\t\t\t{\n\t\t\t\tif (this.widget.common.showForm === FormType.smile)\n\t\t\t\t{\n\t\t\t\t\tthis.$store.commit('widget/common', {showForm: FormType.none});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.$store.commit('widget/common', {showForm: FormType.smile});\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.$root.$emit(EventType.textarea.focus);\n\t\t\t}\n\t\t},\n\t\tonPullRequestConfig(event)\n\t\t{\n\t\t\tthis.$root.$bitrixApplication.recoverPullConnection();\n\t\t},\n\t\tonSmilesSelectSmile(event)\n\t\t{\n\t\t\tthis.$root.$emit(EventType.textarea.insertText, {text: event.text});\n\t\t},\n\t\tonSmilesSelectSet()\n\t\t{\n\t\t\tthis.$root.$emit(EventType.textarea.focus);\n\t\t},\n\t\tonQuotePanelClose()\n\t\t{\n\t\t\tthis.$root.$bitrixApplication.quoteMessageClear();\n\t\t},\n\t\tonWidgetStartDrag(event)\n\t\t{\n\t\t\tif (this.widgetDrag)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.widgetDrag = true;\n\n\t\t\tevent = event.changedTouches ? event.changedTouches[0] : event;\n\n\t\t\tthis.widgetDragCursorStartPointY = event.clientY;\n\t\t\tthis.widgetDragCursorStartPointX = event.clientX;\n\t\t\tthis.widgetDragHeightStartPoint = this.widgetCurrentHeight;\n\t\t\tthis.widgetDragWidthStartPoint = this.widgetCurrentWidth;\n\n\t\t\tthis.onWidgetDragEventAdd();\n\t\t},\n\t\tonWidgetContinueDrag(event)\n\t\t{\n\t\t\tif (!this.widgetDrag)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tevent = event.changedTouches ? event.changedTouches[0] : event;\n\n\t\t\tthis.widgetDragCursorControlPointY = event.clientY;\n\t\t\tthis.widgetDragCursorControlPointX = event.clientX;\n\n\t\t\tlet widgetHeight = 0;\n\n\t\t\tif (this.isBottomLocation)\n\t\t\t{\n\t\t\t\twidgetHeight = Math.max(\n\t\t\t\t\tMath.min(this.widgetDragHeightStartPoint + this.widgetDragCursorStartPointY - this.widgetDragCursorControlPointY, this.widgetAvailableHeight),\n\t\t\t\t\tthis.widgetMinimumHeight\n\t\t\t\t);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\twidgetHeight = Math.max(\n\t\t\t\t\tMath.min(this.widgetDragHeightStartPoint - this.widgetDragCursorStartPointY + this.widgetDragCursorControlPointY, this.widgetAvailableHeight),\n\t\t\t\t\tthis.widgetMinimumHeight\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tlet widgetWidth = 0;\n\t\t\tif (this.isLeftLocation)\n\t\t\t{\n\t\t\t\twidgetWidth = Math.max(\n\t\t\t\t\tMath.min(this.widgetDragWidthStartPoint - this.widgetDragCursorStartPointX + this.widgetDragCursorControlPointX, this.widgetAvailableWidth),\n\t\t\t\t\tthis.widgetMinimumWidth\n\t\t\t\t);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\twidgetWidth = Math.max(\n\t\t\t\t\tMath.min(this.widgetDragWidthStartPoint + this.widgetDragCursorStartPointX - this.widgetDragCursorControlPointX, this.widgetAvailableWidth),\n\t\t\t\t\tthis.widgetMinimumWidth\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tif (this.widgetCurrentHeight !== widgetHeight)\n\t\t\t{\n\t\t\t\tthis.widgetCurrentHeight = widgetHeight;\n\t\t\t}\n\n\t\t\tif (this.widgetCurrentWidth !== widgetWidth)\n\t\t\t{\n\t\t\t\tthis.widgetCurrentWidth = widgetWidth;\n\t\t\t}\n\t\t},\n\t\tonWidgetStopDrag()\n\t\t{\n\t\t\tif (!this.widgetDrag)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.widgetDrag = false;\n\n\t\t\tthis.onWidgetDragEventRemove();\n\n\t\t\tthis.$store.commit('widget/common', {widgetHeight: this.widgetCurrentHeight, widgetWidth: this.widgetCurrentWidth});\n\t\t},\n\t\tonWidgetDragEventAdd()\n\t\t{\n\t\t\tdocument.addEventListener('mousemove', this.onWidgetContinueDrag);\n\t\t\tdocument.addEventListener('mouseup', this.onWidgetStopDrag);\n\t\t\tdocument.addEventListener('mouseleave', this.onWidgetStopDrag);\n\t\t},\n\t\tonWidgetDragEventRemove()\n\t\t{\n\t\t\tdocument.removeEventListener('mousemove', this.onWidgetContinueDrag);\n\t\t\tdocument.removeEventListener('mouseup', this.onWidgetStopDrag);\n\t\t\tdocument.removeEventListener('mouseleave', this.onWidgetStopDrag);\n\t\t},\n\t\tonWindowKeyDown(event)\n\t\t{\n\t\t\tif (event.keyCode === 27)\n\t\t\t{\n\t\t\t\tif (this.widget.common.showForm !== FormType.none)\n\t\t\t\t{\n\t\t\t\t\tthis.$store.commit('widget/common', {showForm: FormType.none});\n\t\t\t\t}\n\t\t\t\telse if (this.widget.common.showConsent)\n\t\t\t\t{\n\t\t\t\t\tthis.disagreeConsentWidow();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.close();\n\t\t\t\t}\n\n\t\t\t\tevent.preventDefault();\n\t\t\t\tevent.stopPropagation();\n\n\t\t\t\tthis.$root.$emit(EventType.textarea.focus);\n\t\t\t}\n\t\t},\n\t\tonWindowScroll(event)\n\t\t{\n\t\t\tclearTimeout(this.onWindowScrollTimeout);\n\t\t\tthis.onWindowScrollTimeout = setTimeout(() => {\n\t\t\t\tthis.$root.$emit(EventType.textarea.blur, true);\n\t\t\t}, 50);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<transition enter-active-class=\"bx-livechat-show\" leave-active-class=\"bx-livechat-close\" @after-leave=\"onAfterClose\">\n\t\t\t<div :class=\"widgetClassName\" v-if=\"widget.common.showed\" :style=\"{height: widgetHeightStyle, width: widgetWidthStyle, userSelect: userSelectStyle}\" ref=\"widgetWrapper\">\n\t\t\t\t<div class=\"bx-livechat-box\">\n\t\t\t\t\t<div v-if=\"isBottomLocation\" class=\"bx-livechat-widget-resize-handle\" @mousedown=\"onWidgetStartDrag\"></div>\n\t\t\t\t\t<bx-livechat-head :isWidgetDisabled=\"widgetMobileDisabled\" @like=\"showLikeForm\" @history=\"showHistoryForm\" @close=\"close\"/>\n\t\t\t\t\t<template v-if=\"widgetMobileDisabled\">\n\t\t\t\t\t\t<bx-livechat-body-orientation-disabled/>\n\t\t\t\t\t</template>\n\t\t\t\t\t<template v-else-if=\"application.error.active\">\n\t\t\t\t\t\t<bx-livechat-body-error/>\n\t\t\t\t\t</template>\n\t\t\t\t\t<template v-else-if=\"!widget.common.configId\">\n\t\t\t\t\t\t<div class=\"bx-livechat-body\" key=\"loading-body\">\n\t\t\t\t\t\t\t<bx-livechat-body-loading/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</template>\t\t\t\n\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t<template v-if=\"!widget.common.dialogStart\">\n\t\t\t\t\t\t\t<div class=\"bx-livechat-body\" key=\"welcome-body\">\n\t\t\t\t\t\t\t\t<bx-livechat-body-operators/>\n\t\t\t\t\t\t\t\t<keep-alive include=\"bx-livechat-smiles\">\n\t\t\t\t\t\t\t\t\t<template v-if=\"widget.common.showForm == FormType.smile\">\n\t\t\t\t\t\t\t\t\t\t<bx-livechat-smiles @selectSmile=\"onSmilesSelectSmile\" @selectSet=\"onSmilesSelectSet\"/>\t\n\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t</keep-alive>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t\t<template v-else-if=\"widget.common.dialogStart\">\n\t\t\t\t\t\t\t<bx-pull-component-status :canReconnect=\"true\" @reconnect=\"onPullRequestConfig\"/>\n\t\t\t\t\t\t\t<div :class=\"['bx-livechat-body', {'bx-livechat-body-with-message': showMessageDialog}]\" key=\"with-message\">\n\t\t\t\t\t\t\t\t<template v-if=\"showMessageDialog\">\n\t\t\t\t\t\t\t\t\t<div class=\"bx-livechat-dialog\">\n\t\t\t\t\t\t\t\t\t\t<bx-im-view-dialog\n\t\t\t\t\t\t\t\t\t\t\t:userId=\"application.common.userId\" \n\t\t\t\t\t\t\t\t\t\t\t:dialogId=\"application.dialog.dialogId\"\n\t\t\t\t\t\t\t\t\t\t\t:chatId=\"application.dialog.chatId\"\n\t\t\t\t\t\t\t\t\t\t\t:messageLimit=\"application.dialog.messageLimit\"\n\t\t\t\t\t\t\t\t\t\t\t:messageExtraCount=\"application.dialog.messageExtraCount\"\n\t\t\t\t\t\t\t\t\t\t\t:enableReactions=\"true\"\n\t\t\t\t\t\t\t\t\t\t\t:enableDateActions=\"false\"\n\t\t\t\t\t\t\t\t\t\t\t:enableCreateContent=\"false\"\n\t\t\t\t\t\t\t\t\t\t\t:enableGestureQuote=\"true\"\n\t\t\t\t\t\t\t\t\t\t\t:enableGestureMenu=\"true\"\n\t\t\t\t\t\t\t\t\t\t\t:showMessageAvatar=\"false\"\n\t\t\t\t\t\t\t\t\t\t\t:showMessageMenu=\"false\"\n\t\t\t\t\t\t\t\t\t\t\t:listenEventScrollToBottom=\"EventType.dialog.scrollToBottom\"\n\t\t\t\t\t\t\t\t\t\t\t:listenEventRequestHistory=\"EventType.dialog.requestHistoryResult\"\n\t\t\t\t\t\t\t\t\t\t\t:listenEventRequestUnread=\"EventType.dialog.requestUnreadResult\"\n\t\t\t\t\t\t\t\t\t\t\t@readMessage=\"onDialogReadMessage\"\n\t\t\t\t\t\t\t\t\t\t\t@requestHistory=\"onDialogRequestHistory\"\n\t\t\t\t\t\t\t\t\t\t\t@requestUnread=\"onDialogRequestUnread\"\n\t\t\t\t\t\t\t\t\t\t\t@quoteMessage=\"onDialogQuoteMessage\"\n\t\t\t\t\t\t\t\t\t\t\t@clickByCommand=\"onDialogMessageClickByCommand\"\n\t\t\t\t\t\t\t\t\t\t\t@clickByUserName=\"onDialogMessageClickByUserName\"\n\t\t\t\t\t\t\t\t\t\t\t@clickByUploadCancel=\"onDialogMessageClickByUploadCancel\"\n\t\t\t\t\t\t\t\t\t\t\t@clickByKeyboardButton=\"onDialogMessageClickByKeyboardButton\"\n\t\t\t\t\t\t\t\t\t\t\t@clickByMessageMenu=\"onDialogMessageMenuClick\"\n\t\t\t\t\t\t\t\t\t\t\t@clickByMessageRetry=\"onDialogMessageRetryClick\"\n\t\t\t\t\t\t\t\t\t\t\t@setMessageReaction=\"onDialogMessageReactionSet\"\n\t\t\t\t\t\t\t\t\t\t\t@click=\"onDialogClick\"\n\t\t\t\t\t\t\t\t\t\t />\n\t\t\t\t\t\t\t\t\t</div>\t \n\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t\t\t\t<bx-livechat-body-loading/>\n\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t<bx-im-view-quote-panel :id=\"quotePanelData.id\" :title=\"quotePanelData.title\" :description=\"quotePanelData.description\" :color=\"quotePanelData.color\" @close=\"onQuotePanelClose\"/>\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t<keep-alive include=\"bx-livechat-smiles\">\n\t\t\t\t\t\t\t\t\t<template v-if=\"widget.common.showForm == FormType.like && widget.common.vote.enable\">\n\t\t\t\t\t\t\t\t\t\t<bx-livechat-form-vote/>\n\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t\t<template v-else-if=\"widget.common.showForm == FormType.welcome\">\n\t\t\t\t\t\t\t\t\t\t<bx-livechat-form-welcome/>\t\n\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t\t<template v-else-if=\"widget.common.showForm == FormType.offline\">\n\t\t\t\t\t\t\t\t\t\t<bx-livechat-form-offline/>\t\n\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t\t<template v-else-if=\"widget.common.showForm == FormType.history\">\n\t\t\t\t\t\t\t\t\t\t<bx-livechat-form-history/>\t\n\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t\t<template v-else-if=\"widget.common.showForm == FormType.smile\">\n\t\t\t\t\t\t\t\t\t\t<bx-livechat-smiles @selectSmile=\"onSmilesSelectSmile\" @selectSet=\"onSmilesSelectSet\"/>\t\n\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t</keep-alive>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</template>\t\n\t\t\t\t\t\t<div class=\"bx-livechat-textarea\" :style=\"[textareaHeightStyle, textAreaBottomMargin]\" ref=\"textarea\">\n\t\t\t\t\t\t\t<div class=\"bx-livechat-textarea-resize-handle\" @mousedown=\"onTextareaStartDrag\" @touchstart=\"onTextareaStartDrag\"></div>\n\t\t\t\t\t\t\t<bx-im-view-textarea\n\t\t\t\t\t\t\t\t:siteId=\"application.common.siteId\"\n\t\t\t\t\t\t\t\t:userId=\"application.common.userId\"\n\t\t\t\t\t\t\t\t:dialogId=\"application.dialog.dialogId\"\n\t\t\t\t\t\t\t\t:writesEventLetter=\"3\"\n\t\t\t\t\t\t\t\t:enableEdit=\"true\"\n\t\t\t\t\t\t\t\t:enableCommand=\"false\"\n\t\t\t\t\t\t\t\t:enableMention=\"false\"\n\t\t\t\t\t\t\t\t:enableFile=\"application.disk.enabled\"\n\t\t\t\t\t\t\t\t:autoFocus=\"application.device.type !== DeviceType.mobile\"\n\t\t\t\t\t\t\t\t:styles=\"{button: {backgroundColor: widget.common.styles.backgroundColor, iconColor: widget.common.styles.iconColor}}\"\n\t\t\t\t\t\t\t\t:listenEventInsertText=\"EventType.textarea.insertText\"\n\t\t\t\t\t\t\t\t:listenEventFocus=\"EventType.textarea.focus\"\n\t\t\t\t\t\t\t\t:listenEventBlur=\"EventType.textarea.blur\"\n\t\t\t\t\t\t\t\t@writes=\"onTextareaWrites\" \n\t\t\t\t\t\t\t\t@send=\"onTextareaSend\" \n\t\t\t\t\t\t\t\t@focus=\"onTextareaFocus\" \n\t\t\t\t\t\t\t\t@blur=\"onTextareaBlur\"\n\t\t\t\t\t\t\t\t@keyup=\"onTextareaKeyUp\" \n\t\t\t\t\t\t\t\t@edit=\"logEvent('edit message', $event)\"\n\t\t\t\t\t\t\t\t@fileSelected=\"onTextareaFileSelected\"\n\t\t\t\t\t\t\t\t@appButtonClick=\"onTextareaAppButtonClick\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div v-if=\"!widget.common.copyright && !isBottomLocation\" class=\"bx-livechat-nocopyright-resize-wrap\" style=\"position: relative;\">\n\t\t\t\t\t\t\t<div class=\"bx-livechat-widget-resize-handle\" @mousedown=\"onWidgetStartDrag\"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<bx-livechat-form-consent @agree=\"agreeConsentWidow\" @disagree=\"disagreeConsentWidow\"/>\n\t\t\t\t\t\t<template v-if=\"widget.common.copyright\">\n\t\t\t\t\t\t\t<div class=\"bx-livechat-copyright\">\t\n\t\t\t\t\t\t\t\t<template v-if=\"widget.common.copyrightUrl\">\n\t\t\t\t\t\t\t\t\t<a class=\"bx-livechat-copyright-link\" :href=\"widget.common.copyrightUrl\" target=\"_blank\">\n\t\t\t\t\t\t\t\t\t\t<span class=\"bx-livechat-logo-name\">{{localize.BX_LIVECHAT_COPYRIGHT_TEXT}}</span>\n\t\t\t\t\t\t\t\t\t\t<span class=\"bx-livechat-logo-icon\"></span>\n\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t\t\t\t<span class=\"bx-livechat-logo-name\">{{localize.BX_LIVECHAT_COPYRIGHT_TEXT}}</span>\n\t\t\t\t\t\t\t\t\t<span class=\"bx-livechat-logo-icon\"></span>\n\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t<div v-if=\"!isBottomLocation\" class=\"bx-livechat-widget-resize-handle\" @mousedown=\"onWidgetStartDrag\"></div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</template>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</transition>\n\t`\n});","/**\n * Bitrix OpenLines widget\n * Body error component (Vue component)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {Vue} from \"ui.vue\";\nimport {Vuex} from \"ui.vue.vuex\";\n\nVue.component('bx-livechat-body-error',\n{\n\tcomputed:\n\t{\n\t\tlocalize()\n\t\t{\n\t\t\treturn  Object.freeze({\n\t\t\t\tBX_LIVECHAT_ERROR_TITLE: this.$root.$bitrixMessages.BX_LIVECHAT_ERROR_TITLE,\n\t\t\t\tBX_LIVECHAT_ERROR_DESC: this.$root.$bitrixMessages.BX_LIVECHAT_ERROR_DESC\n\t\t\t});\n\t\t},\n\t\t...Vuex.mapState({\n\t\t\tapplication: state => state.application\n\t\t}),\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-livechat-body\" key=\"error-body\">\n\t\t\t<div class=\"bx-livechat-warning-window\">\n\t\t\t\t<div class=\"bx-livechat-warning-icon\"></div>\n\t\t\t\t<template v-if=\"application.error.description\"> \n\t\t\t\t\t<div class=\"bx-livechat-help-title bx-livechat-help-title-sm bx-livechat-warning-msg\" v-html=\"application.error.description\"></div>\n\t\t\t\t</template> \n\t\t\t\t<template v-else>\n\t\t\t\t\t<div class=\"bx-livechat-help-title bx-livechat-help-title-md bx-livechat-warning-msg\">{{localize.BX_LIVECHAT_ERROR_TITLE}}</div>\n\t\t\t\t\t<div class=\"bx-livechat-help-title bx-livechat-help-title-sm bx-livechat-warning-msg\">{{localize.BX_LIVECHAT_ERROR_DESC}}</div>\n\t\t\t\t</template> \n\t\t\t</div>\n\t\t</div>\n\t`\n});\n","/**\n * Bitrix OpenLines widget\n * Head component (Vue component)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {Vue} from \"ui.vue\";\nimport {Vuex} from \"ui.vue.vuex\";\nimport { SessionStatus, VoteType } from \"../const\";\nimport {EventType} from \"im.const\";\n\nVue.component('bx-livechat-head',\n{\n\t/**\n\t * @emits 'close'\n\t * @emits 'like'\n\t * @emits 'history'\n\t */\n\tprops:\n\t{\n\t\tisWidgetDisabled: { default: false },\n\t},\n\tmethods:\n\t{\n\t\tclose(event)\n\t\t{\n\t\t\tthis.$emit('close');\n\t\t},\n\t\tlike(event)\n\t\t{\n\t\t\tthis.$emit('like');\n\t\t},\n\t\thistory(event)\n\t\t{\n\t\t\tthis.$emit('history');\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tVoteType: () => VoteType,\n\n\t\tcustomBackgroundStyle(state)\n\t\t{\n\t\t\treturn state.widget.common.styles.backgroundColor? 'background-color: '+state.widget.common.styles.backgroundColor+'!important;': '';\n\t\t},\n\t\tcustomBackgroundOnlineStyle(state)\n\t\t{\n\t\t\treturn state.widget.common.styles.backgroundColor? 'border-color: '+state.widget.common.styles.backgroundColor+'!important;': '';\n\t\t},\n\t\tshowName(state)\n\t\t{\n\t\t\treturn state.widget.dialog.operator.firstName || state.widget.dialog.operator.lastName;\n\t\t},\n\t\tvoteActive(state)\n\t\t{\n\t\t\tif (\n\t\t\t\t!state.widget.common.vote.beforeFinish\n\t\t\t\t&& state.widget.dialog.sessionStatus < SessionStatus.waitClient\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (!state.widget.dialog.sessionClose || state.widget.dialog.sessionClose && state.widget.dialog.userVote === VoteType.none)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tif (state.widget.dialog.sessionClose && state.widget.dialog.userVote !== VoteType.none)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\treturn false;\n\t\t},\n\t\tchatTitle(state)\n\t\t{\n\t\t\treturn state.widget.common.textMessages.bxLivechatTitle\n\t\t\t\t|| state.widget.common.configName\n\t\t\t\t|| this.localize.BX_LIVECHAT_TITLE\n\t\t},\n\t\toperatorName(state)\n\t\t{\n\t\t\tif (!this.showName)\n\t\t\t\treturn '';\n\n\t\t\treturn state.widget.dialog.operator.firstName? state.widget.dialog.operator.firstName: state.widget.dialog.operator.name\n\t\t},\n\t\toperatorDescription(state)\n\t\t{\n\t\t\tif (!this.showName)\n\t\t\t{\n\t\t\t\treturn '';\n\t\t\t}\n\n\t\t\tconst operatorPosition = state.widget.dialog.operator.workPosition? state.widget.dialog.operator.workPosition: this.localize.BX_LIVECHAT_USER;\n\n\t\t\tif (state.widget.common.showSessionId && state.widget.dialog.sessionId >= 0)\n\t\t\t{\n\t\t\t\treturn this.localize.BX_LIVECHAT_OPERATOR_POSITION_AND_SESSION_ID\n\t\t\t\t\t.replace(\"#POSITION#\", operatorPosition)\n\t\t\t\t\t.replace(\"#ID#\", state.widget.dialog.sessionId);\n\t\t\t}\n\n\t\t\treturn this.localize.BX_LIVECHAT_OPERATOR_POSITION_ONLY.replace(\"#POSITION#\", operatorPosition);\n\t\t},\n\n\t\tlocalize()\n\t\t{\n\t\t\treturn Vue.getFilteredPhrases('BX_LIVECHAT_', this.$root.$bitrixMessages);\n\t\t},\n\t\t...Vuex.mapState({\n\t\t\twidget: state => state.widget,\n\t\t\tapplication: state => state.application,\n\t\t})\n\t},\n\twatch:\n\t{\n\t\tshowName(value)\n\t\t{\n\t\t\tif (value)\n\t\t\t{\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tthis.$root.$emit(EventType.dialog.scrollToBottom);\n\t\t\t\t}, 300);\n\t\t\t}\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-livechat-head-wrap\">\n\t\t\t<template v-if=\"isWidgetDisabled\">\n\t\t\t\t<div class=\"bx-livechat-head\" :style=\"customBackgroundStyle\">\n\t\t\t\t\t<div class=\"bx-livechat-title\">{{chatTitle}}</div>\n\t\t\t\t\t<div class=\"bx-livechat-control-box\">\n\t\t\t\t\t\t<button v-if=\"!widget.common.pageMode\" class=\"bx-livechat-control-btn bx-livechat-control-btn-close\" :title=\"localize.BX_LIVECHAT_CLOSE_BUTTON\" @click=\"close\"></button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\t\n\t\t\t</template>\n\t\t\t<template v-else-if=\"application.error.active\">\n\t\t\t\t<div class=\"bx-livechat-head\" :style=\"customBackgroundStyle\">\n\t\t\t\t\t<div class=\"bx-livechat-title\">{{chatTitle}}</div>\n\t\t\t\t\t<div class=\"bx-livechat-control-box\">\n\t\t\t\t\t\t<button v-if=\"!widget.common.pageMode\" class=\"bx-livechat-control-btn bx-livechat-control-btn-close\" :title=\"localize.BX_LIVECHAT_CLOSE_BUTTON\" @click=\"close\"></button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t\t<template v-else-if=\"!widget.common.configId\">\n\t\t\t\t<div class=\"bx-livechat-head\" :style=\"customBackgroundStyle\">\n\t\t\t\t\t<div class=\"bx-livechat-title\">{{chatTitle}}</div>\n\t\t\t\t\t<div class=\"bx-livechat-control-box\">\n\t\t\t\t\t\t<button v-if=\"!widget.common.pageMode\" class=\"bx-livechat-control-btn bx-livechat-control-btn-close\" :title=\"localize.BX_LIVECHAT_CLOSE_BUTTON\" @click=\"close\"></button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</template>\t\t\t\n\t\t\t<template v-else>\n\t\t\t\t<div class=\"bx-livechat-head\" :style=\"customBackgroundStyle\">\n\t\t\t\t\t<template v-if=\"!showName\">\n\t\t\t\t\t\t<div class=\"bx-livechat-title\">{{chatTitle}}</div>\n\t\t\t\t\t</template>\n\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t<div class=\"bx-livechat-user bx-livechat-status-online\">\n\t\t\t\t\t\t\t<template v-if=\"widget.dialog.operator.avatar\">\n\t\t\t\t\t\t\t\t<div class=\"bx-livechat-user-icon\" :style=\"'background-image: url('+encodeURI(widget.dialog.operator.avatar)+')'\">\n\t\t\t\t\t\t\t\t\t<div v-if=\"widget.dialog.operator.online\" class=\"bx-livechat-user-status\" :style=\"customBackgroundOnlineStyle\"></div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t\t\t<div class=\"bx-livechat-user-icon\">\n\t\t\t\t\t\t\t\t\t<div v-if=\"widget.dialog.operator.online\" class=\"bx-livechat-user-status\" :style=\"customBackgroundOnlineStyle\"></div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"bx-livechat-user-info\">\n\t\t\t\t\t\t\t<div class=\"bx-livechat-user-name\">{{operatorName}}</div>\n\t\t\t\t\t\t\t<div class=\"bx-livechat-user-position\">{{operatorDescription}}</div>\t\t\t\t\t\t\t\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</template>\n\t\t\t\t\t<div class=\"bx-livechat-control-box\">\n\t\t\t\t\t\t<span class=\"bx-livechat-control-box-active\" v-if=\"widget.common.dialogStart && widget.dialog.sessionId\">\n\t\t\t\t\t\t\t<button v-if=\"widget.common.vote.enable && voteActive\" :class=\"'bx-livechat-control-btn bx-livechat-control-btn-like bx-livechat-dialog-vote-'+(widget.dialog.userVote)\" :title=\"localize.BX_LIVECHAT_VOTE_BUTTON\" @click=\"like\"></button>\n\t\t\t\t\t\t\t<button v-if=\"false\" class=\"bx-livechat-control-btn bx-livechat-control-btn-mail\" :title=\"localize.BX_LIVECHAT_MAIL_BUTTON_NEW\" @click=\"history\"></button>\n\t\t\t\t\t\t</span>\t\n\t\t\t\t\t\t<button v-if=\"!widget.common.pageMode\" class=\"bx-livechat-control-btn bx-livechat-control-btn-close\" :title=\"localize.BX_LIVECHAT_CLOSE_BUTTON\" @click=\"close\"></button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t</div>\n\t`\n});","/**\n * Bitrix OpenLines widget\n * Body loading component (Vue component)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {Vue} from \"ui.vue\";\n\nVue.component('bx-livechat-body-loading',\n{\n\tcomputed:\n\t{\n\t\tlocalize()\n\t\t{\n\t\t\treturn  Object.freeze({\n\t\t\t\tBX_LIVECHAT_LOADING: this.$root.$bitrixMessages.BX_LIVECHAT_LOADING\n\t\t\t});\n\t\t}\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-livechat-loading-window\">\n\t\t\t<svg class=\"bx-livechat-loading-circular\" viewBox=\"25 25 50 50\">\n\t\t\t\t<circle class=\"bx-livechat-loading-path\" cx=\"50\" cy=\"50\" r=\"20\" fill=\"none\" stroke-miterlimit=\"10\"/>\n\t\t\t\t<circle class=\"bx-livechat-loading-inner-path\" cx=\"50\" cy=\"50\" r=\"20\" fill=\"none\" stroke-miterlimit=\"10\"/>\n\t\t\t</svg>\n\t\t\t<h3 class=\"bx-livechat-help-title bx-livechat-help-title-md bx-livechat-loading-msg\">{{localize.BX_LIVECHAT_LOADING}}</h3>\n\t\t</div>\n\t`\n});","/**\n * Bitrix OpenLines widget\n * Body operators component (Vue component)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {Vue} from \"ui.vue\";\nimport {Vuex} from \"ui.vue.vuex\";\n\nVue.component('bx-livechat-body-operators',\n{\n\tcomputed:\n\t{\n\t\tlocalize()\n\t\t{\n\t\t\treturn Vue.getFilteredPhrases('BX_LIVECHAT_', this.$root.$bitrixMessages);\n\t\t},\n\t\t...Vuex.mapState({\n\t\t\twidget: state => state.widget\n\t\t})\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-livechat-help-container\">\n\t\t\t<transition name=\"bx-livechat-animation-fade\">\n\t\t\t\t<h2 v-if=\"widget.common.online\" key=\"online\" class=\"bx-livechat-help-title bx-livechat-help-title-lg\">{{widget.common.textMessages.bxLivechatOnlineLine1}}<div class=\"bx-livechat-help-subtitle\">{{widget.common.textMessages.bxLivechatOnlineLine2}}</div></h2>\n\t\t\t\t<h2 v-else key=\"offline\" class=\"bx-livechat-help-title bx-livechat-help-title-sm\">{{widget.common.textMessages.bxLivechatOffline}}</h2>\n\t\t\t</transition>\t\n\t\t\t<div class=\"bx-livechat-help-user\">\n\t\t\t\t<template v-for=\"operator in widget.common.operators\">\n\t\t\t\t\t<div class=\"bx-livechat-user\" :key=\"operator.id\">\n\t\t\t\t\t\t<template v-if=\"operator.avatar\">\n\t\t\t\t\t\t\t<div class=\"bx-livechat-user-icon\" :style=\"'background-image: url('+encodeURI(operator.avatar)+')'\"></div>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t\t<div class=\"bx-livechat-user-icon\"></div>\n\t\t\t\t\t\t</template>\t\n\t\t\t\t\t\t<div class=\"bx-livechat-user-info\">\n\t\t\t\t\t\t\t<div class=\"bx-livechat-user-name\">{{operator.firstName? operator.firstName: operator.name}}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</template>\t\n\t\t\t</div>\n\t\t</div>\n\t`\n});","/**\n * Bitrix OpenLines widget\n * Body orientation disabled component (Vue component)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {Vue} from \"ui.vue\";\n\nVue.component('bx-livechat-body-orientation-disabled',\n{\n\tcomputed:\n\t{\n\t\tlocalize()\n\t\t{\n\t\t\treturn  Object.freeze({\n\t\t\t\tBX_LIVECHAT_MOBILE_ROTATE: this.$root.$bitrixMessages.BX_LIVECHAT_MOBILE_ROTATE\n\t\t\t});\n\t\t}\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-livechat-body\" key=\"orientation-head\">\n\t\t\t<div class=\"bx-livechat-mobile-orientation-box\">\n\t\t\t\t<div class=\"bx-livechat-mobile-orientation-icon\"></div>\n\t\t\t\t<div class=\"bx-livechat-mobile-orientation-text\">{{localize.BX_LIVECHAT_MOBILE_ROTATE}}</div>\n\t\t\t</div>\n\t\t</div>\n\t`\n});","/**\n * Bitrix OpenLines widget\n * Form consent component (Vue component)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {Vue} from \"ui.vue\";\nimport {Vuex} from \"ui.vue.vuex\";\n\nVue.component('bx-livechat-form-consent',\n{\n\t/**\n\t * @emits 'agree' {event: object} -- 'event' - click event\n\t * @emits 'disagree' {event: object} -- 'event' - click event\n\t */\n\tcomputed:\n\t{\n\t\tlocalize()\n\t\t{\n\t\t\treturn Vue.getFilteredPhrases('BX_LIVECHAT_', this.$root.$bitrixMessages);\n\t\t},\n\t\t...Vuex.mapState({\n\t\t\twidget: state => state.widget,\n\t\t})\n\t},\n\tmethods:\n\t{\n\t\tagree(event)\n\t\t{\n\t\t\tthis.$emit('agree', {event});\n\t\t},\n\t\tdisagree(event)\n\t\t{\n\t\t\tthis.$emit('disagree', {event});\n\t\t},\n\t\tonShow(element, done)\n\t\t{\n\t\t\telement.classList.add('bx-livechat-consent-window-show');\n\t\t\tdone();\n\t\t},\n\t\tonHide(element, done)\n\t\t{\n\t\t\telement.classList.remove('bx-livechat-consent-window-show');\n\t\t\telement.classList.add('bx-livechat-consent-window-close');\n\t\t\tsetTimeout(function() {\n\t\t\t\tdone();\n\t\t\t}, 400);\n\t\t},\n\t\tonKeyDown(event)\n\t\t{\n\t\t\tif (event.keyCode == 9)\n\t\t\t{\n\t\t\t\tif (event.target === this.$refs.iframe)\n\t\t\t\t{\n\t\t\t\t\tif (event.shiftKey)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$refs.cancel.focus();\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$refs.success.focus();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (event.target === this.$refs.success)\n\t\t\t\t{\n\t\t\t\t\tif (event.shiftKey)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$refs.iframe.focus();\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$refs.cancel.focus();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (event.target === this.$refs.cancel)\n\t\t\t\t{\n\t\t\t\t\tif (event.shiftKey)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$refs.success.focus();\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$refs.iframe.focus();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tevent.preventDefault();\n\t\t\t}\n\t\t\telse if (event.keyCode == 39 || event.keyCode == 37)\n\t\t\t{\n\t\t\t\tif (event.target.nextElementSibling)\n\t\t\t\t{\n\t\t\t\t\tevent.target.nextElementSibling.focus();\n\t\t\t\t}\n\t\t\t\telse if (event.target.previousElementSibling)\n\t\t\t\t{\n\t\t\t\t\tevent.target.previousElementSibling.focus();\n\t\t\t\t}\n\t\t\t\tevent.preventDefault();\n\t\t\t}\n\t\t},\n\t},\n\tdirectives:\n\t{\n\t\tfocus:\n\t\t{\n\t\t\tinserted(element, params)\n\t\t\t{\n\t\t\t\telement.focus();\n\t\t\t}\n\t\t}\n\t},\n\ttemplate: `\n\t\t<transition @enter=\"onShow\" @leave=\"onHide\">\n\t\t\t<template v-if=\"widget.common.showConsent && widget.common.consentUrl\">\n\t\t\t\t<div class=\"bx-livechat-consent-window\">\n\t\t\t\t\t<div class=\"bx-livechat-consent-window-title\">{{localize.BX_LIVECHAT_CONSENT_TITLE}}</div>\n\t\t\t\t\t<div class=\"bx-livechat-consent-window-content\">\n\t\t\t\t\t\t<iframe class=\"bx-livechat-consent-window-content-iframe\" ref=\"iframe\" frameborder=\"0\" marginheight=\"0\"  marginwidth=\"0\" allowtransparency=\"allow-same-origin\" seamless=\"true\" :src=\"widget.common.consentUrl\" @keydown=\"onKeyDown\"></iframe>\n\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\n\t\t\t\t\t<div class=\"bx-livechat-consent-window-btn-box\">\n\t\t\t\t\t\t<button class=\"bx-livechat-btn bx-livechat-btn-success\" ref=\"success\" @click=\"agree\" @keydown=\"onKeyDown\" v-focus>{{localize.BX_LIVECHAT_CONSENT_AGREE}}</button>\n\t\t\t\t\t\t<button class=\"bx-livechat-btn bx-livechat-btn-cancel\" ref=\"cancel\" @click=\"disagree\" @keydown=\"onKeyDown\">{{localize.BX_LIVECHAT_CONSENT_DISAGREE}}</button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t</transition>\n\t`\n});","/**\n * Bitrix OpenLines widget\n * Form history component (Vue component)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport 'ui.icons';\nimport 'ui.forms';\n\nimport {Vue} from \"ui.vue\";\nimport {Vuex} from \"ui.vue.vuex\";\nimport {Utils} from \"im.lib.utils\";\nimport {FormType} from \"../const\";\n\nVue.component('bx-livechat-form-history',\n{\n\tdata()\n\t{\n\t\treturn {\n\t\t\tfieldEmail: '',\n\t\t}\n\t},\n\twatch:\n\t{\n\t\tfieldEmail(value)\n\t\t{\n\t\t\tclearTimeout(this.fieldEmailTimeout);\n\t\t\tthis.fieldEmailTimeout = setTimeout(this.checkEmailField, 300);\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tlocalize()\n\t\t{\n\t\t\treturn Vue.getFilteredPhrases('BX_LIVECHAT_', this.$root.$bitrixMessages);\n\t\t},\n\t\t...Vuex.mapState({\n\t\t\twidget: state => state.widget,\n\t\t})\n\t},\n\tcreated()\n\t{\n\t\tthis.fieldEmail = '' + this.widget.user.email;\n\t},\n\tmethods:\n\t{\n\t\tformShowed()\n\t\t{\n\t\t\tif (!Utils.platform.isMobile())\n\t\t\t{\n\t\t\t\tthis.$refs.emailInput.focus();\n\t\t\t}\n\t\t},\n\t\tsendForm()\n\t\t{\n\t\t\tlet email = this.checkEmailField()? this.fieldEmail: '';\n\t\t\tif (email)\n\t\t\t{\n\t\t\t\tthis.$root.$bitrixApplication.sendForm(FormType.history, {email});\n\t\t\t}\n\n\t\t\tthis.hideForm();\n\t\t},\n\t\thideForm(event)\n\t\t{\n\t\t\tclearTimeout(this.fieldEmailTimeout);\n\t\t\tthis.$parent.hideForm();\n\t\t},\n\t\tonFieldEnterPress(event)\n\t\t{\n\t\t\tthis.sendForm();\n\t\t\tevent.preventDefault();\n\t\t},\n\t\tcheckEmailField()\n\t\t{\n\t\t\tif (this.fieldEmail.match(/^(.*)@(.*)\\.[a-zA-Z]{2,}$/))\n\t\t\t{\n\t\t\t\tif (this.$refs.email)\n\t\t\t\t{\n\t\t\t\t\tthis.$refs.email.classList.remove('ui-ctl-danger');\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (document.activeElement !== this.$refs.emailInput)\n\t\t\t\t{\n\t\t\t\t\tif (this.$refs.email)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$refs.email.classList.add('ui-ctl-danger');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\t\t},\n\t},\n\ttemplate: `\n\t\t<transition enter-active-class=\"bx-livechat-consent-window-show\" leave-active-class=\"bx-livechat-form-close\" @after-enter=\"formShowed\">\n\t\t\t<div v-if=\"false\" class=\"bx-livechat-alert-box bx-livechat-form-show\" key=\"welcome\">\t\n\t\t\t\t<div class=\"bx-livechat-alert-close\" @click=\"hideForm\"></div>\n\t\t\t\t<div class=\"bx-livechat-alert-form-box\">\n\t\t\t\t\t<h4 class=\"bx-livechat-alert-title bx-livechat-alert-title-sm\">{{localize.BX_LIVECHAT_MAIL_TITLE_NEW}}</h4>\n\t\t\t\t\t<div class=\"bx-livechat-form-item ui-ctl ui-ctl-after-icon ui-ctl-w100 ui-ctl-lg\" ref=\"email\">\n\t\t\t\t\t   <div class=\"ui-ctl-after ui-ctl-icon-mail bx-livechat-form-icon\" :title=\"localize.BX_LIVECHAT_FIELD_MAIL_TOOLTIP\"></div>\n\t\t\t\t\t   <input type=\"text\" class=\"ui-ctl-element ui-ctl-textbox\" :placeholder=\"localize.BX_LIVECHAT_FIELD_MAIL\" v-model=\"fieldEmail\" ref=\"emailInput\" @blur=\"checkEmailField\" @keydown.enter=\"onFieldEnterPress\">\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"bx-livechat-btn-box\">\n\t\t\t\t\t\t<button class=\"bx-livechat-btn bx-livechat-btn-success\" @click=\"sendForm\">{{localize.BX_LIVECHAT_MAIL_BUTTON_NEW}}</button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\t\n\t\t</transition>\t\n\t`\n});","/**\n * Bitrix OpenLines widget\n * Form offline component (Vue component)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport 'ui.icons';\nimport 'ui.forms';\n\nimport {Vue} from \"ui.vue\";\nimport {Utils} from \"im.lib.utils\";\nimport {FormType} from \"../const\";\n\nVue.cloneComponent('bx-livechat-form-offline', 'bx-livechat-form-welcome',\n{\n\tmethods:\n\t{\n\t\tformShowed()\n\t\t{\n\t\t\tif (!Utils.platform.isMobile())\n\t\t\t{\n\t\t\t\tthis.$refs.emailInput.focus();\n\t\t\t}\n\t\t},\n\t\tsendForm()\n\t\t{\n\t\t\tlet name = this.fieldName;\n\t\t\tlet email = this.checkEmailField()? this.fieldEmail: '';\n\t\t\tlet phone = this.checkPhoneField()? this.fieldPhone: '';\n\n\t\t\tif (name || email || phone)\n\t\t\t{\n\t\t\t\tthis.$root.$bitrixApplication.sendForm(FormType.offline, {name, email, phone});\n\t\t\t}\n\n\t\t\tthis.hideForm();\n\t\t},\n\t\tonFieldEnterPress(event)\n\t\t{\n\t\t\tif (event.target === this.$refs.emailInput)\n\t\t\t{\n\t\t\t\tthis.showFullForm();\n\t\t\t\tthis.$refs.phoneInput.focus();\n\t\t\t}\n\t\t\telse if (event.target === this.$refs.phoneInput)\n\t\t\t{\n\t\t\t\tthis.$refs.nameInput.focus();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.sendForm();\n\t\t\t}\n\n\t\t\tevent.preventDefault();\n\t\t},\n\t},\n\twatch:\n\t{\n\t\tfieldName()\n\t\t{\n\t\t\tclearTimeout(this.fieldNameTimeout);\n\t\t\tthis.fieldNameTimeout = setTimeout(this.checkNameField, 300);\n\t\t},\n\t\tfieldEmail()\n\t\t{\n\t\t\tclearTimeout(this.showFormTimeout);\n\t\t\tthis.showFormTimeout = setTimeout(this.showFullForm, 1000);\n\n\t\t\tclearTimeout(this.fieldEmailTimeout);\n\t\t\tthis.fieldEmailTimeout = setTimeout(this.checkEmailField, 300);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<transition enter-active-class=\"bx-livechat-consent-window-show\" leave-active-class=\"bx-livechat-form-close\" @after-enter=\"formShowed\">\n\t\t\t<div class=\"bx-livechat-alert-box bx-livechat-form-show\" key=\"welcome\">\t\n\t\t\t\t<div class=\"bx-livechat-alert-close\" @click=\"hideForm\"></div>\n\t\t\t\t<div class=\"bx-livechat-alert-form-box\">\n\t\t\t\t\t<h4 class=\"bx-livechat-alert-title bx-livechat-alert-title-sm\">{{localize.BX_LIVECHAT_OFFLINE_TITLE}}</h4>\n\t\t\t\t\t<div class=\"bx-livechat-form-item ui-ctl ui-ctl-after-icon ui-ctl-w100 ui-ctl-lg\" ref=\"email\">\n\t\t\t\t\t   <div class=\"ui-ctl-after ui-ctl-icon-mail bx-livechat-form-icon\" :title=\"localize.BX_LIVECHAT_FIELD_MAIL_TOOLTIP\"></div>\n\t\t\t\t\t   <input type=\"text\" class=\"ui-ctl-element ui-ctl-textbox\" :placeholder=\"localize.BX_LIVECHAT_FIELD_MAIL\" v-model=\"fieldEmail\" ref=\"emailInput\" @blur=\"checkEmailField\" @keydown.enter=\"onFieldEnterPress\">\n\t\t\t\t\t</div>\n\t\t\t\t\t<div :class=\"['bx-livechat-form-short', {\n\t\t\t\t\t\t'bx-livechat-form-full': isFullForm,\n\t\t\t\t\t}]\">\n\t\t\t\t\t\t<div class=\"bx-livechat-form-item ui-ctl ui-ctl-after-icon ui-ctl-w100 ui-ctl-lg\" ref=\"phone\">\n\t\t\t\t\t\t   <div class=\"ui-ctl-after ui-ctl-icon-phone bx-livechat-form-icon\" :title=\"localize.BX_LIVECHAT_FIELD_PHONE_TOOLTIP\"></div>\n\t\t\t\t\t\t   <input type=\"text\" class=\"ui-ctl-element ui-ctl-textbox\" :placeholder=\"localize.BX_LIVECHAT_FIELD_PHONE\" v-model=\"fieldPhone\" ref=\"phoneInput\" @blur=\"checkPhoneField\" @keydown.enter=\"onFieldEnterPress\">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"bx-livechat-form-item ui-ctl ui-ctl-w100 ui-ctl-lg\" ref=\"name\">\n\t\t\t\t\t\t   <input type=\"text\" class=\"ui-ctl-element ui-ctl-textbox\" :placeholder=\"localize.BX_LIVECHAT_FIELD_NAME\" v-model=\"fieldName\" ref=\"nameInput\" @blur=\"checkNameField\" @keydown.enter=\"onFieldEnterPress\"  @keydown.tab=\"onFieldEnterPress\">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"bx-livechat-btn-box\">\n\t\t\t\t\t\t\t<button class=\"bx-livechat-btn bx-livechat-btn-success\" @click=\"sendForm\">{{localize.BX_LIVECHAT_ABOUT_SEND}}</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\t\n\t\t</transition>\t\n\t`\n});","/**\n * Bitrix OpenLines widget\n * Form vote component (Vue component)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {Vue} from \"ui.vue\";\nimport {Vuex} from \"ui.vue.vuex\";\nimport {VoteType, FormType} from \"../const\";\n\nVue.component('bx-livechat-form-vote',\n{\n\tcomputed:\n\t{\n\t\tVoteType: () => VoteType,\n\n\t\tlocalize()\n\t\t{\n\t\t\treturn Vue.getFilteredPhrases('BX_LIVECHAT_', this.$root.$bitrixMessages);\n\t\t},\n\t\t...Vuex.mapState({\n\t\t\twidget: state => state.widget,\n\t\t})\n\t},\n\tmethods: {\n\t\tuserVote(vote)\n\t\t{\n\t\t\tthis.$store.commit('widget/common', {showForm: FormType.none});\n\t\t\tthis.$store.commit('widget/dialog', {userVote: vote});\n\n\t\t\tthis.$root.$bitrixApplication.sendDialogVote(vote);\n\t\t},\n\t\thideForm(event)\n\t\t{\n\t\t\tthis.$parent.hideForm();\n\t\t},\n\t},\n\ttemplate: `\n\t\t<transition enter-active-class=\"bx-livechat-consent-window-show\" leave-active-class=\"bx-livechat-form-close\">\n\t\t\t<div class=\"bx-livechat-alert-box bx-livechat-form-rate-show\" key=\"vote\">\n\t\t\t\t<div class=\"bx-livechat-alert-close\" @click=\"hideForm\"></div>\n\t\t\t\t<div class=\"bx-livechat-alert-rate-box\">\n\t\t\t\t\t<h4 class=\"bx-livechat-alert-title bx-livechat-alert-title-mdl\">{{widget.common.vote.messageText}}</h4>\n\t\t\t\t\t<div class=\"bx-livechat-btn-box\">\n\t\t\t\t\t\t<button class=\"bx-livechat-btn bx-livechat-btn-like\" @click=\"userVote(VoteType.like)\" :title=\"widget.common.vote.messageLike\"></button>\n\t\t\t\t\t\t<button class=\"bx-livechat-btn bx-livechat-btn-dislike\" @click=\"userVote(VoteType.dislike)\" :title=\"widget.common.vote.messageDislike\"></button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</transition>\t\n\t`\n});","/**\n * Bitrix OpenLines widget\n * Form welcome component (Vue component)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport 'ui.icons';\nimport 'ui.forms';\n\nimport {Vue} from \"ui.vue\";\nimport {Vuex} from \"ui.vue.vuex\";\nimport {Utils} from \"im.lib.utils\";\nimport {FormType} from \"../const\";\n\nVue.component('bx-livechat-form-welcome',\n{\n\tdata()\n\t{\n\t\treturn {\n\t\t\tfieldName: '',\n\t\t\tfieldEmail: '',\n\t\t\tfieldPhone: '',\n\t\t\tisFullForm: Utils.platform.isMobile()\n\t\t}\n\t},\n\twatch:\n\t{\n\t\tfieldName()\n\t\t{\n\t\t\tclearTimeout(this.showFormTimeout);\n\t\t\tthis.showFormTimeout = setTimeout(this.showFullForm, 1000);\n\n\t\t\tclearTimeout(this.fieldNameTimeout);\n\t\t\tthis.fieldNameTimeout = setTimeout(this.checkNameField, 300);\n\t\t},\n\t\tfieldEmail(value)\n\t\t{\n\t\t\tclearTimeout(this.fieldEmailTimeout);\n\t\t\tthis.fieldEmailTimeout = setTimeout(this.checkEmailField, 300);\n\t\t},\n\t\tfieldPhone(value)\n\t\t{\n\t\t\tclearTimeout(this.fieldPhoneTimeout);\n\t\t\tthis.fieldPhoneTimeout = setTimeout(this.checkPhoneField, 300);\n\t\t}\n\t},\n\tcomputed:\n\t{\n\t\tlocalize()\n\t\t{\n\t\t\treturn Vue.getFilteredPhrases('BX_LIVECHAT_', this.$root.$bitrixMessages);\n\t\t},\n\t\t...Vuex.mapState({\n\t\t\twidget: state => state.widget,\n\t\t})\n\t},\n\tcreated()\n\t{\n\t\tthis.fieldName = '' + this.widget.user.name;\n\t\tthis.fieldEmail = '' + this.widget.user.email;\n\t\tthis.fieldPhone = '' + this.widget.user.phone;\n\t},\n\tmethods:\n\t{\n\t\tformShowed()\n\t\t{\n\t\t\tif (!Utils.platform.isMobile())\n\t\t\t{\n\t\t\t\tthis.$refs.nameInput.focus();\n\t\t\t}\n\t\t},\n\t\tshowFullForm()\n\t\t{\n\t\t\tclearTimeout(this.showFormTimeout);\n\t\t\tthis.isFullForm = true;\n\t\t},\n\t\tsendForm()\n\t\t{\n\t\t\tlet name = this.fieldName;\n\t\t\tlet email = this.checkEmailField()? this.fieldEmail: '';\n\t\t\tlet phone = this.checkPhoneField()? this.fieldPhone: '';\n\n\t\t\tif (name || email || phone)\n\t\t\t{\n\t\t\t\tthis.$root.$bitrixApplication.sendForm(FormType.welcome, {name, email, phone});\n\t\t\t}\n\n\t\t\tthis.hideForm();\n\t\t},\n\t\thideForm(event)\n\t\t{\n\t\t\tclearTimeout(this.showFormTimeout);\n\t\t\tclearTimeout(this.fieldNameTimeout);\n\t\t\tclearTimeout(this.fieldEmailTimeout);\n\t\t\tclearTimeout(this.fieldPhoneTimeout);\n\n\t\t\tthis.$parent.hideForm();\n\t\t},\n\t\tonFieldEnterPress(event)\n\t\t{\n\t\t\tif (event.target === this.$refs.nameInput)\n\t\t\t{\n\t\t\t\tthis.showFullForm();\n\t\t\t\tthis.$refs.emailInput.focus();\n\t\t\t}\n\t\t\telse if (event.target === this.$refs.emailInput)\n\t\t\t{\n\t\t\t\tthis.$refs.phoneInput.focus();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.sendForm();\n\t\t\t}\n\n\t\t\tevent.preventDefault();\n\t\t},\n\t\tcheckNameField()\n\t\t{\n\t\t\tif (this.fieldName.length > 0)\n\t\t\t{\n\t\t\t\tif (this.$refs.name)\n\t\t\t\t{\n\t\t\t\t\tthis.$refs.name.classList.remove('ui-ctl-danger');\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (document.activeElement !== this.$refs.nameInput)\n\t\t\t\t{\n\t\t\t\t\tif (this.$refs.name)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$refs.name.classList.add('ui-ctl-danger');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\t\t},\n\t\tcheckEmailField()\n\t\t{\n\t\t\tif (this.fieldEmail.match(/^(.*)@(.*)\\.[a-zA-Z]{2,}$/))\n\t\t\t{\n\t\t\t\tif (this.$refs.email)\n\t\t\t\t{\n\t\t\t\t\tthis.$refs.email.classList.remove('ui-ctl-danger');\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (document.activeElement !== this.$refs.emailInput)\n\t\t\t\t{\n\t\t\t\t\tif (this.$refs.email)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$refs.email.classList.add('ui-ctl-danger');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\t\t},\n\t\tcheckPhoneField()\n\t\t{\n\t\t\tif (this.fieldPhone.match(/^(\\s*)?(\\+)?([- _():=+]?\\d[- _():=+]?){10,14}(\\s*)?$/))\n\t\t\t{\n\t\t\t\tif (this.$refs.phone)\n\t\t\t\t{\n\t\t\t\t\tthis.$refs.phone.classList.remove('ui-ctl-danger');\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (document.activeElement !== this.$refs.phoneInput)\n\t\t\t\t{\n\t\t\t\t\tif (this.$refs.phone)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$refs.phone.classList.add('ui-ctl-danger');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t},\n\ttemplate: `\n\t\t<transition enter-active-class=\"bx-livechat-consent-window-show\" leave-active-class=\"bx-livechat-form-close\" @after-enter=\"formShowed\">\n\t\t\t<div class=\"bx-livechat-alert-box bx-livechat-form-show\" key=\"welcome\">\t\n\t\t\t\t<div class=\"bx-livechat-alert-close\" @click=\"hideForm\"></div>\n\t\t\t\t<div class=\"bx-livechat-alert-form-box\">\n\t\t\t\t\t<h4 class=\"bx-livechat-alert-title bx-livechat-alert-title-sm\">{{localize.BX_LIVECHAT_ABOUT_TITLE}}</h4>\n\t\t\t\t\t<div class=\"bx-livechat-form-item ui-ctl ui-ctl-w100 ui-ctl-lg\" ref=\"name\">\n\t\t\t\t\t   <input type=\"text\" class=\"ui-ctl-element ui-ctl-textbox\" :placeholder=\"localize.BX_LIVECHAT_FIELD_NAME\" v-model=\"fieldName\" ref=\"nameInput\" @blur=\"checkNameField\" @keydown.enter=\"onFieldEnterPress\"  @keydown.tab=\"onFieldEnterPress\">\n\t\t\t\t\t</div>\n\t\t\t\t\t<div :class=\"['bx-livechat-form-short', {\n\t\t\t\t\t\t'bx-livechat-form-full': isFullForm,\n\t\t\t\t\t}]\">\n\t\t\t\t\t\t<div class=\"bx-livechat-form-item ui-ctl ui-ctl-after-icon ui-ctl-w100 ui-ctl-lg\" ref=\"email\">\n\t\t\t\t\t\t   <div class=\"ui-ctl-after ui-ctl-icon-mail bx-livechat-form-icon\" :title=\"localize.BX_LIVECHAT_FIELD_MAIL_TOOLTIP\"></div>\n\t\t\t\t\t\t   <input type=\"text\" class=\"ui-ctl-element ui-ctl-textbox\" :placeholder=\"localize.BX_LIVECHAT_FIELD_MAIL\" v-model=\"fieldEmail\" ref=\"emailInput\" @blur=\"checkEmailField\" @keydown.enter=\"onFieldEnterPress\">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"bx-livechat-form-item ui-ctl ui-ctl-after-icon ui-ctl-w100 ui-ctl-lg\" ref=\"phone\">\n\t\t\t\t\t\t   <div class=\"ui-ctl-after ui-ctl-icon-phone bx-livechat-form-icon\" :title=\"localize.BX_LIVECHAT_FIELD_PHONE_TOOLTIP\"></div>\n\t\t\t\t\t\t   <input type=\"text\" class=\"ui-ctl-element ui-ctl-textbox\" :placeholder=\"localize.BX_LIVECHAT_FIELD_PHONE\" v-model=\"fieldPhone\" ref=\"phoneInput\" @blur=\"checkPhoneField\" @keydown.enter=\"onFieldEnterPress\">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"bx-livechat-btn-box\">\n\t\t\t\t\t\t\t<button class=\"bx-livechat-btn bx-livechat-btn-success\" @click=\"sendForm\">{{localize.BX_LIVECHAT_ABOUT_SEND}}</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\t\n\t\t</transition>\t\n\t`\n});","/**\n * Bitrix OpenLines widget\n * Smiles component (Vue component)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {Vue} from \"ui.vue\";\n\nVue.cloneComponent('bx-livechat-smiles', 'bx-smiles',\n{\n\tmethods:\n\t{\n\t\thideForm(event)\n\t\t{\n\t\t\tthis.$parent.hideForm();\n\t\t},\n\t},\n\ttemplate: `\n\t\t<transition enter-active-class=\"bx-livechat-consent-window-show\" leave-active-class=\"bx-livechat-form-close\">\n\t\t\t<div class=\"bx-livechat-alert-box bx-livechat-alert-box-zero-padding bx-livechat-form-show\" key=\"vote\">\n\t\t\t\t<div class=\"bx-livechat-alert-close\" @click=\"hideForm\"></div>\n\t\t\t\t<div class=\"bx-livechat-alert-smiles-box\">\n\t\t\t\t\t#PARENT_TEMPLATE#\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</transition>\n\t`\n});","/**\n * Bitrix OpenLines widget\n * Widget component & controller\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\n// core\n\nimport 'main.polyfill.customevent';\n\n// vue components\nimport 'pull.component.status';\nimport 'ui.vue.components.smiles';\nimport 'im.view.dialog';\nimport 'im.view.textarea';\nimport 'im.view.quotepanel';\nimport 'imopenlines.component.message';\nimport 'imopenlines.component.form';\n\n// widget files\nimport \"./widget.css\";\nimport {VoteType, LocationStyle, SubscriptionType} from \"./const\";\n\n// widget utils\nimport {Cookie} from \"im.lib.cookie\";\nimport {WidgetPublicManager} from \"./public\";\n\n// widget components\n\nimport \"./component/bx-livechat\";\nimport \"./component/bx-livechat-body-error\";\nimport \"./component/bx-livechat-body-head\";\nimport \"./component/bx-livechat-body-loading\";\nimport \"./component/bx-livechat-body-operators\";\nimport \"./component/bx-livechat-body-orientation-disabled\";\nimport \"./component/bx-livechat-form-consent\";\nimport \"./component/bx-livechat-form-history\";\nimport \"./component/bx-livechat-form-offline\";\nimport \"./component/bx-livechat-form-vote\";\nimport \"./component/bx-livechat-form-welcome\";\nimport \"./component/bx-livechat-smiles\";\n\n\nBX.LiveChatWidget = WidgetPublicManager;\nBX.LiveChatWidget.VoteType = VoteType;\nBX.LiveChatWidget.SubscriptionType = SubscriptionType;\nBX.LiveChatWidget.LocationStyle = LocationStyle;\nBX.LiveChatWidget.Cookie = Cookie;\n\nwindow.dispatchEvent(new CustomEvent('onBitrixLiveChatSourceLoaded', {detail: {}}));"],"names":["GetObjectValues","source","destination","value","hasOwnProperty","push","VoteType","Object","freeze","none","like","dislike","LanguageType","russian","ukraine","world","FormType","smile","consent","welcome","offline","history","LocationType","topLeft","topMiddle","topBottom","bottomLeft","bottomMiddle","bottomRight","LocationStyle","SubscriptionType","configLoaded","widgetOpen","widgetClose","sessionStart","sessionOperatorChange","sessionFinish","operatorMessage","userForm","userMessage","userFile","userVote","every","SubscriptionTypeCheck","RestMethod","widgetUserRegister","widgetConfigGet","widgetDialogGet","widgetUserGet","widgetUserConsentApply","widgetVoteSend","widgetFormSend","widgetActionSend","pullServerTime","pullConfigGet","RestMethodCheck","RestAuth","guest","SessionStatus","new","skip","answer","client","clientAfterOperator","operator","waitClient","close","spam","duplicate","silentlyClose","WidgetModel","common","configId","configName","host","getVariable","location","protocol","pageMode","copyright","copyrightUrl","styles","backgroundColor","iconColor","vote","enable","beforeFinish","messageText","messageLike","messageDislike","textMessages","bxLivechatOnlineLine1","bxLivechatOnlineLine2","bxLivechatOffline","bxLivechatTitle","online","operators","connectors","showForm","showed","reopen","dragged","textareaHeight","widgetHeight","widgetWidth","showConsent","consentUrl","dialogStart","watchTyping","showSessionId","dialog","sessionId","sessionClose","sessionStatus","userConsent","operatorChatId","id","name","firstName","lastName","workPosition","avatar","user","hash","email","phone","www","gender","position","state","payload","Utils","types","isPlainObject","device","isMobile","Array","isSaveNeeded","saveState","toString","startsWith","Cookie","set","expires","path","show","commit","VuexBuilderModel","WidgetRestClient","params","queryAuthRestore","setAuthId","restClient","RestClient","endpoint","queryParams","cors","authId","customAuthId","match","livechat_auth_id","console","error","livechat_custom_auth_id","method","callback","sendCallback","logTag","getLogTrackingParams","promise","BX","Promise","callMethod","then","result","fulfill","catch","ex","warn","error_description","reject","calls","bHaltOnError","resultCallback","callBatch","WidgetRestAnswerHandler","props","widget","data","store","disk","addLocalize","serverVariables","LocalStorage","getSiteId","previousData","messages","collection","controller","application","getChatId","chatId","dialogId","fields","entityType","type","dispatch","userId","diskFolderId","handleImDialogMessagesGetSuccess","length","isDialogStart","messageId","message","messagesQueue","filter","el","sendEvent","text","BaseRestHandler","WidgetImPullCommandHandler","extra","command","senderId","getUserId","onceShowed","open","WidgetImopenlinesPullCommandHandler","Widget","template","rootNode","node","document","createElement","ready","widgetDataRequested","inited","initEventFired","userRegisterData","customData","subscribers","configRequestXhr","initParams","initRestClient","initPullClient","initCore","initWidget","initUploader","initComplete","code","language","buttonInstance","useBitrixLocalize","placeholder","getElementById","body","firstChild","insertBefore","appendChild","localize","window","get","resolve","pullClient","PullClient","serverEnabled","siteId","skipStorageInit","configTimestamp","skipCheckRevision","getPublicListMethod","pullClientInited","widgetVariables","getHost","getLocalize","Controller","languageId","pull","rest","vuexBuilder","database","browser","isIe","databaseName","databaseType","VuexBuilder","DatabaseType","localStorage","models","create","setVariables","isUserRegistered","getUserHash","getStore","setPrepareFilesBeforeSaveFunction","prepareFileData","bind","addRestAnswerHandler","uploader","Uploader","generatePreview","sender","customHeaders","actionUploadChunk","actionCommitFile","actionRollbackUpload","subscribe","event","eventData","getData","Logger","log","status","FileStatus","upload","progress","file","fileType","authorId","extension","split","splice","size","image","previewData","width","previewDataWidth","height","previewDataHeight","authorName","getCurrentUser","urlPreview","URL","createObjectURL","fileId","addMessage","previewBlob","wait","find","getters","fileCommit","uploadId","fileError","dispatchEvent","CustomEvent","detail","widgetCode","widgetHost","callStartFlag","start","callOpenFlag","isReady","getUserHashCookie","requestData","fireInitEvent","isConfigDataLoaded","xhr","clearError","executeRestAnswer","setError","requestDataSend","abort","query","config_id","getConfigId","trace_data","getCrmTraceData","custom_data","getCustomData","ImRestMethodHandler","imChatGet","ImRestMethod","dialog_id","imDialogMessagesGetInit","imDialogMessagesGet","chat_id","limit","getRequestMessageLimit","convert_text","getUserRegisterFields","isUserAgreeConsent","consent_url","href","response","configGet","userGetResult","chatGetResult","dialogGetResult","dialogMessagesGetResult","getDialogId","userRegisterResult","timeShift","serverTimeResult","Math","floor","Date","getTime","config","pullConfigResult","server","startPullClient","processSendMessages","getDialogData","files","isArray","map","md5","urlParam","urlShow","urlDownload","platform","isIos","version","getIosVersion","isConnected","scheduleReconnect","config_timestamp","storage","StorageManager","Status","eventStatusInteraction","pullConnectedFirstTime","PullStatus","Online","$root","$bitrixPullClient","$emit","skipReconnectToLastSession","stop","CloseReasons","MANUAL","restart","pullRequestMessage","getDialogUnread","readMessage","Offline","innerHTML","createVue","beforeCreate","destroyed","templateAttached","vue","$destroy","Vue","mutateComponent","isUnreadMessagesLoaded","sendMessage","FILE_ID","sending","addFilesFromEvent","element","deleteTask","getDiskFolderId","requestDiskFolderId","forEach","sendMessageWithFile","stopWriting","quiteId","quoteMessage","newMessage","join","quoteMessageClear","imMessageAdd","timMessageType","senderOptions","addTask","taskId","fileData","fileName","generateUniqueName","retry","requestDiskFolderPromise","flagRequestDiskFolderIdSended","imDiskFolderGet","imDiskFileCommit","upload_id","template_id","file_template_id","lastId","EventType","requestHistoryResult","count","requestUnreadResult","imDialogRead","message_id","imDialogMessagesGetUnread","first_id","dialogMessageUnread","firstMessageId","setSendingMessageFlag","quoteId","reaction","reactMessage","action","values","JSON","parse","parseInt","SESSION_ID","getSessionId","alert","BX_LIVECHAT_ACTION_EXPIRED","botId","imMessageCommand","info","toUpperCase","form","isSessionActive","requestWidgetData","clearTimeout","openTimeout","openFromButton","wm","showById","checkBrowserVersion","BX_LIVECHAT_OLD_BROWSER","versionCompare","BX_LIVECHAT_OLD_VUE","BX_LIVECHAT_OLD_VUE_DEV","replace","isWidgetDataRequested","attachTemplate","onWidgetClose","detachTemplate","traceData","getTrace","b24Tracker","MESSAGE","BX_LIVECHAT_EXTRA_SITE","stringify","dialogues","userHash","cookie","validUserFields","field","indexOf","setNewAuthToken","authToken","getStoreBuilder","clearModelState","concat","description","localizeDescription","endsWith","active","includes","phrases","phrase","WidgetPublicManager","developerInfo","__privateMethods__","__createLegacyMethods","showNotification","getUserData","setUserRegisterData","setCustomData","mutateTemplateComponent","LiveChat","sourceHref","sourceDomain","hostname","port","openLiveChat","closeLiveChat","addEventListener","eventName","handler","origin","setCookie","getCookie","BxLiveChatInit","firstMessage","BxLiveChatLoader","component","viewPortMetaSiteNode","viewPortMetaWidgetNode","storedMessage","storedFile","widgetMinimumHeight","widgetMinimumWidth","widgetBaseHeight","widgetBaseWidth","widgetMargin","widgetAvailableHeight","widgetAvailableWidth","widgetCurrentHeight","widgetCurrentWidth","widgetDrag","textareaFocused","textareaDrag","textareaMinimumHeight","textareaMaximumHeight","created","onCreated","onWindowKeyDown","getAvailableSpaceFunc","throttle","getAvailableSpace","$on","onRequestShowForm","beforeDestroy","removeEventListener","$off","onTextareaDragEventRemove","computed","DeviceType","textareaHeightStyle","flex","textAreaBottomMargin","isBottomLocation","marginBottom","widgetBaseSizes","widgetHeightStyle","max","widgetWidthStyle","userSelectStyle","isLeftLocation","getFilteredPhrases","$bitrixMessages","widgetMobileDisabled","mobile","navigator","userAgent","orientation","DeviceOrientation","horizontal","screen","availHeight","widgetClassName","className","isSafari","isMac","isDarkColor","showMessageDialog","messageCollection","quotePanelData","title","color","$store","textConverted","BX_LIVECHAT_FILE_MESSAGE","Vuex","mapState","watch","methods","onBeforeClose","bottomPosition","$refs","widgetWrapper","getBoundingClientRect","bottom","widgetBottomMargin","innerHeight","topPosition","top","innerWidth","showLikeForm","showFormTimeout","showWelcomeForm","showOfflineForm","showHistoryForm","hideForm","showConsentWidow","agreeConsentWidow","$bitrixApplication","sendConsentDecision","onTextareaSend","focus","onTextareaFileSelected","textarea","disagreeConsentWidow","insertText","logEvent","from","head","getElementsByTagName","removeChild","contentWidth","offsetWidth","setAttribute","classList","add","isSafariBased","setTimeout","remove","onAfterClose","delayed","onDialogRequestHistory","getDialogHistory","onDialogRequestUnread","onDialogMessageClickByUserName","onDialogMessageClickByUploadCancel","cancelUploadFile","onDialogMessageClickByKeyboardButton","execMessageKeyboardCommand","onDialogMessageClickByCommand","onDialogMessageMenuClick","onDialogMessageRetryClick","retrySendMessage","onDialogReadMessage","onDialogQuoteMessage","onDialogMessageReactionSet","onDialogClick","onTextareaKeyUp","isPublishingEnabled","infoString","onTextareaWrites","$bitrixController","startWriting","onTextareaFocus","onTextareaFocusScrollTimeout","onWindowScroll","onTextareaBlur","$nextTick","scrollToBottom","force","onTextareaStartDrag","changedTouches","textareaDragCursorStartPoint","clientY","textareaDragHeightStartPoint","onTextareaDragEventAdd","blur","onTextareaContinueDrag","textareaDragCursorControlPoint","min","onTextareaStopDrag","fileInputEvent","fileChangeEvent","target","uploadFile","onTextareaAppButtonClick","appId","onPullRequestConfig","recoverPullConnection","onSmilesSelectSmile","onSmilesSelectSet","onQuotePanelClose","onWidgetStartDrag","widgetDragCursorStartPointY","widgetDragCursorStartPointX","clientX","widgetDragHeightStartPoint","widgetDragWidthStartPoint","onWidgetDragEventAdd","onWidgetContinueDrag","widgetDragCursorControlPointY","widgetDragCursorControlPointX","onWidgetStopDrag","onWidgetDragEventRemove","keyCode","preventDefault","stopPropagation","onWindowScrollTimeout","BX_LIVECHAT_ERROR_TITLE","BX_LIVECHAT_ERROR_DESC","isWidgetDisabled","default","customBackgroundStyle","customBackgroundOnlineStyle","showName","voteActive","chatTitle","BX_LIVECHAT_TITLE","operatorName","operatorDescription","operatorPosition","BX_LIVECHAT_USER","BX_LIVECHAT_OPERATOR_POSITION_AND_SESSION_ID","BX_LIVECHAT_OPERATOR_POSITION_ONLY","BX_LIVECHAT_LOADING","BX_LIVECHAT_MOBILE_ROTATE","agree","disagree","onShow","done","onHide","onKeyDown","iframe","shiftKey","cancel","success","nextElementSibling","previousElementSibling","directives","inserted","fieldEmail","fieldEmailTimeout","checkEmailField","formShowed","emailInput","sendForm","$parent","onFieldEnterPress","activeElement","cloneComponent","fieldName","checkPhoneField","fieldPhone","showFullForm","phoneInput","nameInput","fieldNameTimeout","checkNameField","sendDialogVote","isFullForm","fieldPhoneTimeout","LiveChatWidget"],"mappings":"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"}