{"version":3,"file":"widget.bundle.js","sources":["../src/const.js","../src/utils/cookie.js","../src/model.js","../src/utils/restclient.js","../src/rest.handler.js","../src/pull.handler.js","../src/widget.js","../src/public.js","../src/component/bx-livechat.js","../src/component/bx-livechat-body-error.js","../src/component/bx-livechat-body-head.js","../src/component/bx-livechat-body-loading.js","../src/component/bx-livechat-body-operators.js","../src/component/bx-livechat-body-orientation-disabled.js","../src/component/bx-livechat-form-consent.js","../src/component/bx-livechat-form-history.js","../src/component/bx-livechat-form-offline.js","../src/component/bx-livechat-form-vote.js","../src/component/bx-livechat-form-welcome.js","../src/component/bx-livechat-smiles.js","../src/component/bx-livechat-footer.js","../src/registry.js"],"sourcesContent":["/**\n * Bitrix OpenLines widget\n * Widget constants\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nfunction GetObjectValues(source)\n{\n\tconst destination = [];\n\tfor (let value in source)\n\t{\n\t\tif (source.hasOwnProperty(value))\n\t\t{\n\t\t\tdestination.push(source[value]);\n\t\t}\n\t}\n\treturn destination;\n}\n\n/* region 01. Constants */\n\nexport const VoteType = Object.freeze({\n\tnone: 'none',\n\tlike: 'like',\n\tdislike: 'dislike',\n});\n\nexport const LanguageType = Object.freeze({\n\trussian: 'ru',\n\tukraine: 'ua',\n\tworld: 'en',\n});\n\nexport const FormType = Object.freeze({\n\tnone: 'none',\n\tlike: 'like',\n\tsmile: 'smile',\n\tconsent: 'consent',\n\twelcome: 'welcome',\n\toffline: 'offline',\n\thistory: 'history',\n});\n\nexport const LocationType = Object.freeze({\n\ttopLeft: 1,\n\ttopMiddle: 2,\n\ttopBottom: 3,\n\tbottomLeft: 6,\n\tbottomMiddle: 5,\n\tbottomRight: 4,\n});\n\nexport const LocationStyle = Object.freeze({\n\t1: 'top-left',\n\t2: 'top-center',\n\t3: 'top-right',\n\t6: 'bottom-left',\n\t5: 'bottom-center',\n\t4: 'bottom-right',\n});\n\nexport const SubscriptionType = Object.freeze({\n\tconfigLoaded: 'configLoaded',\n\twidgetOpen: 'widgetOpen',\n\twidgetClose: 'widgetClose',\n\tsessionStart: 'sessionStart',\n\tsessionOperatorChange: 'sessionOperatorChange',\n\tsessionFinish: 'sessionFinish',\n\toperatorMessage: 'operatorMessage',\n\tuserForm: 'userForm',\n\tuserMessage: 'userMessage',\n\tuserVote: 'userVote',\n\tevery: 'every',\n});\nexport const SubscriptionTypeCheck = GetObjectValues(SubscriptionType);\n\nexport const RestMethod = Object.freeze({\n\twidgetUserRegister: 'imopenlines.widget.user.register',\n\twidgetConfigGet: 'imopenlines.widget.config.get',\n\twidgetDialogGet: 'imopenlines.widget.dialog.get',\n\twidgetUserGet: 'imopenlines.widget.user.get',\n\twidgetUserConsentApply: 'imopenlines.widget.user.consent.apply',\n\twidgetVoteSend: 'imopenlines.widget.vote.send',\n\twidgetFormSend: 'imopenlines.widget.form.send',\n\n\tpullServerTime: 'server.time',\n\tpullConfigGet: 'pull.config.get',\n});\nexport const RestMethodCheck = GetObjectValues(RestMethod);\n\nexport const RestAuth = Object.freeze({\n\tguest: 'guest',\n});","/**\n * Bitrix OpenLines widget\n * Cookie manager\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {LocalStorage} from \"im.tools.localstorage\";\n\nexport const Cookie =\n{\n\tget(siteId, name)\n\t{\n\t\tlet cookieName = siteId? siteId+'_'+name: name;\n\n\t\tif (navigator.cookieEnabled)\n\t\t{\n\t\t\tlet result = document.cookie.match(new RegExp(\n\t\t\t\t\"(?:^|; )\" + cookieName.replace(/([.$?*|{}()\\[\\]\\\\\\/+^])/g, '\\\\$1') + \"=([^;]*)\"\n\t\t\t));\n\n\t\t\tif (result)\n\t\t\t{\n\t\t\t\treturn decodeURIComponent(result[1]);\n\t\t\t}\n\t\t}\n\n\t\tif (LocalStorage.isEnabled())\n\t\t{\n\t\t\tlet result = LocalStorage.get(siteId, 0, name, undefined);\n\t\t\tif (typeof result !== 'undefined')\n\t\t\t{\n\t\t\t\treturn result;\n\t\t\t}\n\t\t}\n\n\t\tif (typeof window.BX.LiveChatCookie === 'undefined')\n\t\t{\n\t\t\twindow.BX.LiveChatCookie = {};\n\t\t}\n\n\t\treturn window.BX.LiveChatCookie[cookieName];\n\t},\n\tset(siteId, name, value, options)\n\t{\n\t\toptions = options || {};\n\n\t\tlet expires = options.expires;\n\t\tif (typeof(expires) == \"number\" && expires)\n\t\t{\n\t\t\tlet currentDate = new Date();\n\t\t\tcurrentDate.setTime(currentDate.getTime() + expires * 1000);\n\t\t\texpires = options.expires = currentDate;\n\t\t}\n\n\t\tif (expires && expires.toUTCString)\n\t\t{\n\t\t\toptions.expires = expires.toUTCString();\n\t\t}\n\n\t\tvalue = encodeURIComponent(value);\n\n\t\tlet cookieName = siteId? siteId+'_'+name: name;\n\t\tlet updatedCookie = cookieName + \"=\" + value;\n\n\t\tfor (let propertyName in options)\n\t\t{\n\t\t\tif (!options.hasOwnProperty(propertyName))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tupdatedCookie += \"; \" + propertyName;\n\n\t\t\tlet propertyValue = options[propertyName];\n\t\t\tif (propertyValue !== true)\n\t\t\t{\n\t\t\t\tupdatedCookie += \"=\" + propertyValue;\n\t\t\t}\n\t\t}\n\n\t\tdocument.cookie = updatedCookie;\n\n\t\tif (typeof window.BX.LiveChatCookie === 'undefined')\n\t\t{\n\t\t\tBX.LiveChatCookie = {};\n\t\t}\n\n\t\twindow.BX.LiveChatCookie[cookieName] = value;\n\t\tLocalStorage.set(siteId, 0, name, value);\n\n\t\treturn true;\n\t}\n};","/**\n * Bitrix OpenLines widget\n * Widget model (Vuex Builder model)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {VuexBuilderModel} from 'ui.vue.vuex';\n\nimport {Utils} from 'im.utils';\nimport {Cookie} from './utils/cookie';\nimport {FormType, LocationStyle, LocationType, VoteType} from \"./const\";\n\nexport class WidgetModel extends VuexBuilderModel\n{\n\t/**\n\t * @inheritDoc\n\t */\n\tgetName()\n\t{\n\t\treturn 'widget';\n\t}\n\n\tgetState()\n\t{\n\t\treturn {\n\t\t\tcommon:\n\t\t\t{\n\t\t\t\tconfigId: 0,\n\t\t\t\tconfigName: '',\n\t\t\t\thost: this.getVariable('common.host', location.protocol+'//'+location.host),\n\t\t\t\tpageMode: this.getVariable('common.pageMode', false),\n\t\t\t\tcopyright: this.getVariable('common.copyright', true),\n\t\t\t\tcopyrightUrl: this.getVariable('common.copyrightUrl', 'https://bitrix24.com'),\n\t\t\t\tlocation: this.getVariable('common.location', LocationType.bottomRight),\n\t\t\t\tstyles: {\n\t\t\t\t\tbackgroundColor: this.getVariable('styles.backgroundColor', '#17a3ea'),\n\t\t\t\t\ticonColor: this.getVariable('styles.iconColor', '#ffffff')\n\t\t\t\t},\n\t\t\t\tvote: {\n\t\t\t\t\tenable: false,\n\t\t\t\t\tmessageText: this.getVariable('vote.messageText', ''),\n\t\t\t\t\tmessageLike: this.getVariable('vote.messageLike', ''),\n\t\t\t\t\tmessageDislike: this.getVariable('vote.messageDislike', '')\n\t\t\t\t},\n\t\t\t\ttextMessages: {\n\t\t\t\t\tbxLivechatOnlineLine1: this.getVariable('textMessages.bxLivechatOnlineLine1', ''),\n\t\t\t\t\tbxLivechatOnlineLine2: this.getVariable('textMessages.bxLivechatOnlineLine2', ''),\n\t\t\t\t\tbxLivechatOffline: this.getVariable('textMessages.bxLivechatOffline', '')\n\t\t\t\t},\n\t\t\t\tonline: false,\n\t\t\t\toperators: [],\n\t\t\t\tconnectors: [],\n\t\t\t\tshowForm: FormType.none,\n\t\t\t\tuploadFile: false,\n\t\t\t\tshowed: false,\n\t\t\t\treopen: false,\n\t\t\t\tdragged: false,\n\t\t\t\ttextareaHeight: 0,\n\t\t\t\tshowConsent: false,\n\t\t\t\tconsentUrl: '',\n\t\t\t\tdialogStart: false,\n\t\t\t},\n\t\t\tdialog:\n\t\t\t{\n\t\t\t\tsessionId: 0,\n\t\t\t\tsessionClose: true,\n\t\t\t\tuserVote: VoteType.none,\n\t\t\t\tuserConsent: false,\n\t\t\t\toperator: {\n\t\t\t\t\tname: '',\n\t\t\t\t\tfirstName: '',\n\t\t\t\t\tlastName: '',\n\t\t\t\t\tworkPosition: '',\n\t\t\t\t\tavatar: '',\n\t\t\t\t\tonline: false,\n\t\t\t\t}\n\t\t\t},\n\t\t\tuser:\n\t\t\t{\n\t\t\t\tid: -1,\n\t\t\t\thash: '',\n\t\t\t\tname: '',\n\t\t\t\tfirstName: '',\n\t\t\t\tlastName: '',\n\t\t\t\tavatar: '',\n\t\t\t\temail: '',\n\t\t\t\tphone: '',\n\t\t\t\twww: '',\n\t\t\t\tgender: 'M',\n\t\t\t\tposition: '',\n\t\t\t},\n\t\t}\n\t}\n\n\tgetStateSaveException()\n\t{\n\t\treturn {\n\t\t\tcommon: {\n\t\t\t\thost: null,\n\t\t\t\tpageMode: null,\n\t\t\t\tcopyright: null,\n\t\t\t\tcopyrightUrl: null,\n\t\t\t\tstyles: null,\n\t\t\t\tdragged: null,\n\t\t\t\tshowed: null,\n\t\t\t\tshowConsent: null,\n\t\t\t\tshowForm: null,\n\t\t\t\tuploadFile: null,\n\t\t\t\tlocation: null,\n\t\t\t},\n\t\t}\n\t}\n\n\tgetMutations()\n\t{\n\t\treturn {\n\n\t\t\tcommon: (state, payload) =>\n\t\t\t{\n\t\t\t\tif (typeof payload.configId === 'number')\n\t\t\t\t{\n\t\t\t\t\tstate.common.configId = payload.configId;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.configName === 'string')\n\t\t\t\t{\n\t\t\t\t\tstate.common.configName = payload.configName;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.online === 'boolean')\n\t\t\t\t{\n\t\t\t\t\tstate.common.online = payload.online;\n\t\t\t\t}\n\t\t\t\tif (Utils.types.isPlainObject(payload.vote))\n\t\t\t\t{\n\t\t\t\t\tif (typeof payload.vote.enable === 'boolean')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.common.vote.enable = payload.vote.enable;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.vote.messageText === 'string')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.common.vote.messageText = payload.vote.messageText;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.vote.messageLike === 'string')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.common.vote.messageLike = payload.vote.messageLike;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.vote.messageDislike === 'string')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.common.vote.messageDislike = payload.vote.messageDislike;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (Utils.types.isPlainObject(payload.textMessages))\n\t\t\t\t{\n\t\t\t\t\tif (typeof payload.textMessages.bxLivechatOnlineLine1 === 'string')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.common.textMessages.bxLivechatOnlineLine1 = payload.textMessages.bxLivechatOnlineLine1;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.textMessages.bxLivechatOnlineLine2 === 'string')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.common.textMessages.bxLivechatOnlineLine2 = payload.textMessages.bxLivechatOnlineLine2;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.textMessages.bxLivechatOffline === 'string')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.common.textMessages.bxLivechatOffline = payload.textMessages.bxLivechatOffline;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (typeof payload.dragged === 'boolean')\n\t\t\t\t{\n\t\t\t\t\tstate.common.dragged = payload.dragged;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.textareaHeight === 'number')\n\t\t\t\t{\n\t\t\t\t\tstate.common.textareaHeight = payload.textareaHeight;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.showConsent === 'boolean')\n\t\t\t\t{\n\t\t\t\t\tstate.common.showConsent = payload.showConsent;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.consentUrl === 'string')\n\t\t\t\t{\n\t\t\t\t\tstate.common.consentUrl = payload.consentUrl;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.showed === 'boolean')\n\t\t\t\t{\n\t\t\t\t\tstate.common.showed = payload.showed;\n\t\t\t\t\tpayload.reopen = payload.showed;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.reopen === 'boolean')\n\t\t\t\t{\n\t\t\t\t\tstate.common.reopen = payload.showed;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.copyright === 'boolean')\n\t\t\t\t{\n\t\t\t\t\tstate.common.copyright = payload.copyright;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.dialogStart === 'boolean')\n\t\t\t\t{\n\t\t\t\t\tstate.common.dialogStart = payload.dialogStart;\n\t\t\t\t}\n\t\t\t\tif (payload.operators instanceof Array)\n\t\t\t\t{\n\t\t\t\t\tstate.common.operators = payload.operators;\n\t\t\t\t}\n\t\t\t\tif (payload.connectors instanceof Array)\n\t\t\t\t{\n\t\t\t\t\tstate.common.connectors = payload.connectors;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.uploadFilePlus !== 'undefined')\n\t\t\t\t{\n\t\t\t\t\tstate.common.uploadFile = state.common.uploadFile+1;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.uploadFileMinus !== 'undefined')\n\t\t\t\t{\n\t\t\t\t\tstate.common.uploadFile = state.common.uploadFile-1;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.showForm === 'string' && typeof FormType[payload.showForm] !== 'undefined')\n\t\t\t\t{\n\t\t\t\t\tstate.common.showForm = payload.showForm;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.location === 'number' && typeof LocationStyle[payload.location] !== 'undefined')\n\t\t\t\t{\n\t\t\t\t\tstate.common.location = payload.location;\n\t\t\t\t}\n\n\t\t\t\tif (this.isSaveNeeded({common: payload}))\n\t\t\t\t{\n\t\t\t\t\tthis.saveState(state);\n\t\t\t\t}\n\t\t\t},\n\t\t\tdialog: (state, payload) =>\n\t\t\t{\n\t\t\t\tif (typeof payload.sessionId === 'number')\n\t\t\t\t{\n\t\t\t\t\tstate.dialog.sessionId = payload.sessionId;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.sessionClose === 'boolean')\n\t\t\t\t{\n\t\t\t\t\tstate.dialog.sessionClose = payload.sessionClose;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.userConsent === 'boolean')\n\t\t\t\t{\n\t\t\t\t\tstate.dialog.userConsent = payload.userConsent;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.userVote === 'string' && typeof payload.userVote !== 'undefined')\n\t\t\t\t{\n\t\t\t\t\tstate.dialog.userVote = payload.userVote;\n\t\t\t\t}\n\t\t\t\tif (Utils.types.isPlainObject(payload.operator))\n\t\t\t\t{\n\t\t\t\t\tif (typeof payload.operator.name === 'string' || typeof payload.operator.name === 'number')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.dialog.operator.name = payload.operator.name.toString();\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.operator.lastName === 'string' || typeof payload.operator.lastName === 'number')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.dialog.operator.lastName = payload.operator.lastName.toString();\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.operator.firstName === 'string' || typeof payload.operator.firstName === 'number')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.dialog.operator.firstName = payload.operator.firstName.toString();\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.operator.workPosition === 'string' || typeof payload.operator.workPosition === 'number')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.dialog.operator.workPosition = payload.operator.workPosition.toString();\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.operator.avatar === 'string')\n\t\t\t\t\t{\n\t\t\t\t\t\tif (!payload.operator.avatar || payload.operator.avatar.startsWith('http'))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tstate.dialog.operator.avatar = payload.operator.avatar;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tstate.dialog.operator.avatar = state.common.host+payload.operator.avatar;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.operator.online === 'boolean')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.dialog.operator.online = payload.operator.online;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (this.isSaveNeeded({dialog: payload}))\n\t\t\t\t{\n\t\t\t\t\tthis.saveState(state);\n\t\t\t\t}\n\t\t\t},\n\t\t\tuser: (state, payload) =>\n\t\t\t{\n\t\t\t\tif (typeof payload.id === 'number')\n\t\t\t\t{\n\t\t\t\t\tstate.user.id = payload.id;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.hash === 'string' && payload.hash !== state.user.hash)\n\t\t\t\t{\n\t\t\t\t\tstate.user.hash = payload.hash;\n\t\t\t\t\tCookie.set(null, 'LIVECHAT_HASH', payload.hash, {expires: 365*86400, path: '/'});\n\t\t\t\t}\n\t\t\t\tif (typeof payload.name === 'string' || typeof payload.name === 'number')\n\t\t\t\t{\n\t\t\t\t\tstate.user.name = payload.name.toString();\n\t\t\t\t}\n\t\t\t\tif (typeof payload.firstName === 'string' || typeof payload.firstName === 'number')\n\t\t\t\t{\n\t\t\t\t\tstate.user.firstName = payload.firstName.toString();\n\t\t\t\t}\n\t\t\t\tif (typeof payload.lastName === 'string' || typeof payload.lastName === 'number')\n\t\t\t\t{\n\t\t\t\t\tstate.user.lastName = payload.lastName.toString();\n\t\t\t\t}\n\t\t\t\tif (typeof payload.avatar === 'string')\n\t\t\t\t{\n\t\t\t\t\tstate.user.avatar = payload.avatar;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.email === 'string')\n\t\t\t\t{\n\t\t\t\t\tstate.user.email = payload.email;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.phone === 'string' || typeof payload.phone === 'number')\n\t\t\t\t{\n\t\t\t\t\tstate.user.phone = payload.phone.toString();\n\t\t\t\t}\n\t\t\t\tif (typeof payload.www === 'string')\n\t\t\t\t{\n\t\t\t\t\tstate.user.www = payload.www;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.gender === 'string')\n\t\t\t\t{\n\t\t\t\t\tstate.user.gender = payload.gender;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.position === 'string')\n\t\t\t\t{\n\t\t\t\t\tstate.user.position = payload.position;\n\t\t\t\t}\n\n\t\t\t\tif (this.isSaveNeeded({user: payload}))\n\t\t\t\t{\n\t\t\t\t\tthis.saveState(state);\n\t\t\t\t}\n\t\t\t},\n\t\t}\n\t}\n}","/**\n * Bitrix OpenLines widget\n * Rest client (base on BX.RestClient)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\n// TODO change BX.RestClient, BX.promise to import\n\nimport {Utils} from \"im.utils\";\nimport {RestAuth, RestMethod} from \"../const\";\nimport {RestClient} from \"rest.client\";\n\nexport class WidgetRestClient\n{\n\tconstructor(params)\n\t{\n\t\tthis.queryAuthRestore = false;\n\n\t\tthis.setAuthId(RestAuth.guest);\n\n\t\tthis.restClient = new RestClient({\n\t\t\tendpoint: params.endpoint,\n\t\t\tqueryParams: this.queryParams,\n\t\t\tcors: true\n\t\t});\n\t}\n\n\tsetAuthId(authId, customAuthId = '')\n\t{\n\t\tif (typeof this.queryParams !== 'object')\n\t\t{\n\t\t\tthis.queryParams = {};\n\t\t}\n\n\t\tif (\n\t\t\tauthId == RestAuth.guest\n\t\t\t|| typeof authId === 'string' && authId.match(/^[a-f0-9]{32}$/)\n\t\t)\n\t\t{\n\t\t\tthis.queryParams.livechat_auth_id = authId;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconsole.error(`%LiveChatRestClient.setAuthId: auth is not correct (%c${authId}%c)`, \"color: black;\", \"font-weight: bold; color: red\", \"color: black\");\n\t\t\treturn false;\n\t\t}\n\n\t\tif (\n\t\t\tauthId == RestAuth.guest\n\t\t\t&& typeof customAuthId === 'string' && customAuthId.match(/^[a-f0-9]{32}$/)\n\t\t)\n\t\t{\n\t\t\tthis.queryParams.livechat_custom_auth_id = customAuthId;\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tgetAuthId()\n\t{\n\t\tif (typeof this.queryParams !== 'object')\n\t\t{\n\t\t\tthis.queryParams = {};\n\t\t}\n\n\t\treturn this.queryParams.livechat_auth_id || null;\n\t}\n\n\tcallMethod(method, params, callback, sendCallback, logTag = null)\n\t{\n\t\tif (!logTag)\n\t\t{\n\t\t\tlogTag = Utils.getLogTrackingParams({\n\t\t\t\tname: method,\n\t\t\t});\n\t\t}\n\n\t\tconst promise = new BX.Promise();\n\n\t\tthis.restClient.callMethod(method, params, null, sendCallback, logTag).then(result => {\n\n\t\t\tthis.queryAuthRestore = false;\n\t\t\tpromise.fulfill(result);\n\n\t\t}).catch(result => {\n\n\t\t\tlet error = result.error();\n\t\t\tif (error.ex.error == 'LIVECHAT_AUTH_WIDGET_USER')\n\t\t\t{\n\t\t\t\tthis.setAuthId(error.ex.hash);\n\n\t\t\t\tif (method === RestMethod.widgetUserRegister)\n\t\t\t\t{\n\t\t\t\t\tconsole.warn(`BX.LiveChatRestClient: ${error.ex.error_description} (${error.ex.error})`);\n\n\t\t\t\t\tthis.queryAuthRestore = false;\n\t\t\t\t\tpromise.reject(result);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tif (!this.queryAuthRestore)\n\t\t\t\t{\n\t\t\t\t\tconsole.warn('BX.LiveChatRestClient: your auth-token has expired, send query with a new token');\n\n\t\t\t\t\tthis.queryAuthRestore = true;\n\t\t\t\t\tthis.restClient.callMethod(method, params, null, sendCallback, logTag).then(result => {\n\t\t\t\t\t\tthis.queryAuthRestore = false;\n\t\t\t\t\t\tpromise.fulfill(result);\n\t\t\t\t\t}).catch(result => {\n\t\t\t\t\t\tthis.queryAuthRestore = false;\n\t\t\t\t\t\tpromise.reject(result);\n\t\t\t\t\t});\n\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.queryAuthRestore = false;\n\t\t\tpromise.reject(result);\n\t\t});\n\n\t\treturn promise;\n\t};\n\n\tcallBatch(calls, callback, bHaltOnError, sendCallback, logTag)\n\t{\n\t\tlet resultCallback = (result) =>\n\t\t{\n\t\t\tlet error = null;\n\t\t\tfor (let method in calls)\n\t\t\t{\n\t\t\t\tif (!calls.hasOwnProperty(method))\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tlet error = result[method].error();\n\t\t\t\tif (error && error.ex.error == 'LIVECHAT_AUTH_WIDGET_USER')\n\t\t\t\t{\n\t\t\t\t\tthis.setAuthId(error.ex.hash);\n\t\t\t\t\tif (method === RestMethod.widgetUserRegister)\n\t\t\t\t\t{\n\t\t\t\t\t\tconsole.warn(`BX.LiveChatRestClient: ${error.ex.error_description} (${error.ex.error})`);\n\n\t\t\t\t\t\tthis.queryAuthRestore = false;\n\t\t\t\t\t\tcallback(result);\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!this.queryAuthRestore)\n\t\t\t\t\t{\n\t\t\t\t\t\tconsole.warn('BX.LiveChatRestClient: your auth-token has expired, send query with a new token');\n\n\t\t\t\t\t\tthis.queryAuthRestore = true;\n\t\t\t\t\t\tthis.restClient.callBatch(calls, callback, bHaltOnError, sendCallback, logTag);\n\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.queryAuthRestore = false;\n\t\t\tcallback(result);\n\n\t\t\treturn true;\n\t\t};\n\n\t\treturn this.restClient.callBatch(calls, resultCallback, bHaltOnError, sendCallback, logTag);\n\t};\n}","/**\n * Bitrix OpenLines widget\n * Widget Rest answers (Rest Answer Handler)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {BaseRestAnswerHandler} from \"im.provider.rest\";\nimport {LocalStorage} from \"im.tools.localstorage\";\nimport {SubscriptionType} from \"./const\";\n\nclass WidgetRestAnswerHandler extends BaseRestAnswerHandler\n{\n\tconstructor(props = {})\n\t{\n\t\tsuper(props);\n\n\t\tthis.widget = props.widget;\n\t}\n\n\thandleImopenlinesWidgetConfigGetSuccess(data)\n\t{\n\t\tthis.store.commit('widget/common', {\n\t\t\tconfigId: data.configId,\n\t\t\tconfigName: data.configName,\n\t\t\tvote: data.vote,\n\t\t\ttextMessages: data.textMessages,\n\t\t\toperators: data.operators || [],\n\t\t\tonline: data.online,\n\t\t\tconsentUrl: data.consentUrl,\n\t\t\tconnectors: data.connectors || [],\n\t\t});\n\n\t\tthis.store.commit('application/set', {disk: data.disk});\n\n\t\tthis.widget.addLocalize(data.serverVariables);\n\t\tLocalStorage.set(this.widget.getSiteId(), 0, 'serverVariables', data.serverVariables || {});\n\t}\n\n\thandleImopenlinesWidgetUserRegisterSuccess(data)\n\t{\n\t\tthis.widget.restClient.setAuthId(data.hash);\n\n\t\tlet previousData = [];\n\t\tif (typeof this.store.state.messages.collection[this.controller.getChatId()] !== 'undefined')\n\t\t{\n\t\t\tpreviousData = this.store.state.messages.collection[this.controller.getChatId()];\n\t\t}\n\t\tthis.store.commit('messages/initCollection', {chatId: data.chatId, messages: previousData});\n\n\t\tthis.store.commit('dialogues/initCollection', {dialogId: data.dialogId, fields: {\n\t\t\tentityType: 'LIVECHAT',\n\t\t\ttype: 'livechat'\n\t\t}});\n\n\t\tthis.store.commit('application/set', {dialog: {\n\t\t\tchatId: data.chatId,\n\t\t\tdialogId: 'chat'+data.chatId\n\t\t}});\n\t}\n\n\thandleImopenlinesWidgetUserGetSuccess(data)\n\t{\n\t\tthis.store.commit('widget/user', {\n\t\t\tid: data.id,\n\t\t\thash: data.hash,\n\t\t\tname: data.name,\n\t\t\tfirstName: data.firstName,\n\t\t\tlastName: data.lastName,\n\t\t\tphone: data.phone,\n\t\t\tavatar: data.avatar,\n\t\t\temail: data.email,\n\t\t\twww: data.www,\n\t\t\tgender: data.gender,\n\t\t\tposition: data.position,\n\t\t});\n\t\tthis.store.commit('application/set', {common: {\n\t\t\tuserId: data.id\n\t\t}});\n\t}\n\n\thandleImopenlinesWidgetDialogGetSuccess(data)\n\t{\n\t\tthis.store.commit('messages/initCollection', {chatId: data.chatId});\n\n\t\tthis.store.commit('widget/dialog', {\n\t\t\tsessionId: data.sessionId,\n\t\t\tsessionClose: data.sessionClose,\n\t\t\tuserVote: data.userVote,\n\t\t\tuserConsent: data.userConsent,\n\t\t\toperator: data.operator\n\t\t});\n\t\tthis.store.commit('application/set', {dialog: {\n\t\t\tchatId: data.chatId,\n\t\t\tdialogId: 'chat'+data.chatId,\n\t\t\tdiskFolderId: data.diskFolderId,\n\t\t}});\n\t}\n\n\thandleImDialogMessagesGetSuccess(data)\n\t{\n\t\tif (data.messages && data.messages.length > 0 && !this.widget.isDialogStart())\n\t\t{\n\t\t\tthis.store.commit('widget/common', {\n\t\t\t\tdialogStart:true\n\t\t\t});\n\t\t}\n\t}\n\n\thandleImMessageAddSuccess(messageId, message)\n\t{\n\t\tthis.widget.messagesQueue = this.widget.messagesQueue.filter(el => el.id != message.id);\n\n\t\tthis.widget.sendEvent({\n\t\t\ttype: SubscriptionType.userMessage,\n\t\t\tdata: {\n\t\t\t\tid: messageId,\n\t\t\t\ttext: message.text\n\t\t\t}\n\t\t});\n\t}\n\n\thandleImMessageAddError(error, message)\n\t{\n\t\tthis.widget.messagesQueue = this.widget.messagesQueue.filter(el => el.id != message.id);\n\t}\n}\n\nexport {WidgetRestAnswerHandler};","/**\n * Bitrix OpenLines widget\n * Widget pull commands (Pull Command Handler)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {SubscriptionType, VoteType} from \"./const\";\n\nclass WidgetImPullCommandHandler\n{\n\tstatic create(params = {})\n\t{\n\t\treturn new this(params);\n\t}\n\n\tgetModuleId()\n\t{\n\t\treturn 'im';\n\t}\n\n\tconstructor(params)\n\t{\n\t\tthis.controller = params.controller;\n\t\tthis.store = params.store;\n\t\tthis.widget = params.widget;\n\t}\n\n\thandleMessageChat(params, extra, command)\n\t{\n\t\tif (params.message.senderId != this.controller.getUserId())\n\t\t{\n\t\t\tthis.widget.sendEvent({\n\t\t\t\ttype: SubscriptionType.operatorMessage,\n\t\t\t\tdata: params\n\t\t\t});\n\n\t\t\tif (!this.store.state.widget.common.showed && !this.widget.onceShowed)\n\t\t\t{\n\t\t\t\tthis.widget.onceShowed = true;\n\t\t\t\tthis.widget.open();\n\t\t\t}\n\t\t}\n\t}\n}\n\nclass WidgetImopenlinesPullCommandHandler\n{\n\tstatic create(params = {})\n\t{\n\t\treturn new this(params);\n\t}\n\n\tconstructor(params = {})\n\t{\n\t\tthis.controller = params.controller;\n\t\tthis.store = params.store;\n\t\tthis.widget = params.widget;\n\t}\n\n\tgetModuleId()\n\t{\n\t\treturn 'imopenlines';\n\t}\n\n\thandleSessionStart(params, extra, command)\n\t{\n\t\tthis.store.commit('widget/dialog', {\n\t\t\tsessionId: params.sessionId,\n\t\t\tsessionClose: false,\n\t\t\tuserVote: VoteType.none,\n\t\t});\n\n\t\tthis.widget.sendEvent({\n\t\t\ttype: SubscriptionType.sessionStart,\n\t\t\tdata: {\n\t\t\t\tsessionId: params.sessionId\n\t\t\t}\n\t\t});\n\t}\n\n\thandleSessionOperatorChange(params, extra, command)\n\t{\n\t\tthis.store.commit('widget/dialog', {\n\t\t\toperator: params.operator\n\t\t});\n\n\t\tthis.widget.sendEvent({\n\t\t\ttype: SubscriptionType.sessionOperatorChange,\n\t\t\tdata: {\n\t\t\t\toperator: params.operator\n\t\t\t}\n\t\t});\n\t}\n\n\thandleSessionFinish(params, extra, command)\n\t{\n\t\tthis.store.commit('widget/dialog', {\n\t\t\tsessionId: params.sessionId,\n\t\t\tsessionClose: true,\n\t\t});\n\n\t\tthis.widget.sendEvent({\n\t\t\ttype: SubscriptionType.sessionFinish,\n\t\t\tdata: {\n\t\t\t\tsessionId: params.sessionId\n\t\t\t}\n\t\t});\n\n\t\tif (!params.spam)\n\t\t{\n\t\t\tthis.store.commit('widget/dialog', {\n\t\t\t\toperator: {\n\t\t\t\t\tname: '',\n\t\t\t\t\tfirstName: '',\n\t\t\t\t\tlastName: '',\n\t\t\t\t\tworkPosition: '',\n\t\t\t\t\tavatar: '',\n\t\t\t\t\tonline: false,\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n}\n\nexport {\n\tWidgetImPullCommandHandler,\n\tWidgetImopenlinesPullCommandHandler,\n};","/**\n * Bitrix OpenLines widget\n * Widget private interface (base class)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\n// widget files\nimport {\n\tVoteType,\n\tLocationStyle,\n\tSubscriptionType,\n\tSubscriptionTypeCheck,\n\tRestMethod,\n\tRestAuth,\n} from \"./const\";\n\nimport {WidgetModel} from \"./model\";\nimport {WidgetRestClient} from \"./utils/restclient\"\nimport {WidgetRestAnswerHandler} from \"./rest.handler\";\nimport {WidgetImPullCommandHandler, WidgetImopenlinesPullCommandHandler} from \"./pull.handler\";\n\n// main\nimport {md5} from \"main.md5\";\nimport \"main.date\";\n\n// pull\nimport {PullClient} from \"pull.client\";\n\n// ui\nimport {Vue} from \"ui.vue\";\nimport {VuexBuilder} from \"ui.vue.vuex\";\nimport {Cookie} from \"./utils/cookie\";\n\n// messenger files\nimport {ApplicationModel, MessagesModel, DialoguesModel, UsersModel, FilesModel} from 'im.model';\nimport {ApplicationController} from 'im.controller';\nimport {DeviceType, DeviceOrientation, RestMethod as ImRestMethod} from 'im.const';\nimport {Utils} from \"im.utils\";\nimport {LocalStorage} from \"im.tools.localstorage\";\nimport {ImRestAnswerHandler} from \"im.provider.rest\";\nimport {ImPullCommandHandler} from \"im.provider.pull\";\nimport {Logger} from \"im.tools.logger\";\n\n// TODO change BX.Promise, BX.Main.Date to IMPORT\n\nexport class Widget\n{\n/* region 01. Initialize and store data */\n\n\tconstructor(params = {})\n\t{\n\t\tthis.ready = true;\n\t\tthis.widgetDataRequested = false;\n\n\t\tthis.offline = false;\n\n\t\tthis.code = params.code || '';\n\t\tthis.host = params.host || '';\n\t\tthis.language = params.language || 'en';\n\t\tthis.copyright = params.copyright !== false;\n\t\tthis.copyrightUrl = this.copyright && params.copyrightUrl? params.copyrightUrl: '';\n\t\tthis.buttonInstance = typeof params.buttonInstance === 'object' && params.buttonInstance !== null? params.buttonInstance: null;\n\n\t\tthis.pageMode = typeof params.pageMode === 'object' && params.pageMode;\n\t\tif (this.pageMode)\n\t\t{\n\t\t\tthis.pageMode.useBitrixLocalize = params.pageMode.useBitrixLocalize === true;\n\t\t\tthis.pageMode.placeholder = document.getElementById(params.pageMode.placeholder);\n\t\t}\n\n\t\tif (typeof this.code === 'string')\n\t\t{\n\t\t\tif (this.code.length <= 0)\n\t\t\t{\n\t\t\t\tconsole.warn(`%cLiveChatWidget.constructor: code is not correct (%c${this.code}%c)`, \"color: black;\", \"font-weight: bold; color: red\", \"color: black\");\n\t\t\t\tthis.ready = false;\n\t\t\t}\n\t\t}\n\n\t\tif (typeof this.host === 'string')\n\t\t{\n\t\t\tif (this.host.length <= 0 || !this.host.startsWith('http'))\n\t\t\t{\n\t\t\t\tconsole.warn(`%cLiveChatWidget.constructor: host is not correct (%c${this.host}%c)`, \"color: black;\", \"font-weight: bold; color: red\", \"color: black\");\n\t\t\t\tthis.ready = false;\n\t\t\t}\n\t\t}\n\n\t\tthis.inited = false;\n\t\tthis.initEventFired = false;\n\n\t\tthis.restClient = null;\n\n\t\tthis.userRegisterData = {};\n\t\tthis.customData = [];\n\n\t\tthis.localize = this.pageMode && this.pageMode.useBitrixLocalize? window.BX.message: {};\n\t\tif (typeof params.localize === 'object')\n\t\t{\n\t\t\tthis.addLocalize(params.localize);\n\t\t}\n\n\t\tthis.subscribers = {};\n\t\tthis.dateFormat = null;\n\n\t\tthis.messagesQueue = [];\n\t\tthis.filesQueue = [];\n\t\tthis.filesQueueIndex = 0;\n\n\t\tthis.configRequestXhr = null;\n\n\t\tif (this.pageMode && this.pageMode.placeholder)\n\t\t{\n\t\t\tthis.rootNode = this.pageMode.placeholder;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.rootNode = document.createElement('div');\n\t\t\tif (document.body.firstChild)\n\t\t\t{\n\t\t\t\tdocument.body.insertBefore(this.rootNode, document.body.firstChild);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tdocument.body.appendChild(this.rootNode);\n\t\t\t}\n\t\t}\n\n\t\tthis.template = null;\n\n\t\twindow.addEventListener('orientationchange', () =>\n\t\t{\n\t\t\tif (!this.store)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.store.commit('application/set', {device: {\n\t\t\t\torientation: Utils.device.getOrientation()\n\t\t\t}});\n\n\t\t\tif (\n\t\t\t\tthis.store.state.widget.common.showed\n\t\t\t\t&& this.store.state.application.device.type == DeviceType.mobile\n\t\t\t\t&& this.store.state.application.device.orientation == DeviceOrientation.horizontal\n\t\t\t)\n\t\t\t{\n\t\t\t\tdocument.activeElement.blur();\n\t\t\t}\n\t\t});\n\n\t\tlet serverVariables = LocalStorage.get(this.getSiteId(), 0, 'serverVariables', false);\n\t\tif (serverVariables)\n\t\t{\n\t\t\tthis.addLocalize(serverVariables);\n\t\t}\n\n\t\tlet widgetVariables = {\n\t\t\tcommon: {\n\t\t\t\thost: this.getHost(),\n\t\t\t\tpageMode: this.pageMode !== false,\n\t\t\t\tcopyright: this.copyright,\n\t\t\t\tcopyrightUrl: this.copyrightUrl,\n\t\t\t},\n\t\t\tvote: {\n\t\t\t\tmessageText: this.getLocalize('BX_LIVECHAT_VOTE_TITLE'),\n\t\t\t\tmessageLike: this.getLocalize('BX_LIVECHAT_VOTE_PLUS_TITLE'),\n\t\t\t\tmessageDislike: this.getLocalize('BX_LIVECHAT_VOTE_MINUS_TITLE'),\n\t\t\t},\n\t\t\ttextMessages: {\n\t\t\t\tbxLivechatOnlineLine1: this.getLocalize('BX_LIVECHAT_ONLINE_LINE_1'),\n\t\t\t\tbxLivechatOnlineLine2: this.getLocalize('BX_LIVECHAT_ONLINE_LINE_2'),\n\t\t\t\tbxLivechatOffline: this.getLocalize('BX_LIVECHAT_OFFLINE'),\n\t\t\t}\n\t\t};\n\t\tif (params.location && typeof LocationStyle[params.location] !== 'undefined')\n\t\t{\n\t\t\twidgetVariables.common.location = params.location;\n\t\t}\n\t\tif (\n\t\t\tUtils.types.isPlainObject(params.styles)\n\t\t\t&& (params.styles.backgroundColor || params.styles.iconColor)\n\t\t)\n\t\t{\n\t\t\twidgetVariables.styles = {};\n\t\t\tif (params.styles.backgroundColor)\n\t\t\t{\n\t\t\t\twidgetVariables.styles.backgroundColor = params.styles.backgroundColor;\n\t\t\t}\n\t\t\tif (params.styles.iconColor)\n\t\t\t{\n\t\t\t\twidgetVariables.styles.iconColor = params.styles.iconColor;\n\t\t\t}\n\t\t}\n\n\t\tthis.controller = new ApplicationController();\n\n\t\tlet applicationVariables = {\n\t\t\tcommon: {\n\t\t\t\thost: this.getHost(),\n\t\t\t\tsiteId: this.getSiteId(),\n\t\t\t\tlanguageId: this.language,\n\t\t\t},\n\t\t\tdevice: {\n\t\t\t\ttype: Utils.device.isMobile()? DeviceType.mobile: DeviceType.desktop,\n\t\t\t\torientation: Utils.device.getOrientation(),\n\t\t\t},\n\t\t\tdialog: {\n\t\t\t\tmessageLimit: this.controller.getDefaultMessageLimit()\n\t\t\t}\n\t\t};\n\n\t\tnew VuexBuilder()\n\t\t\t.addModel(WidgetModel.create().setVariables(widgetVariables))\n\t\t\t.addModel(ApplicationModel.create().setVariables(applicationVariables))\n\t\t\t.addModel(MessagesModel.create())\n\t\t\t.addModel(DialoguesModel.create().setVariables({host: this.host}).useDatabase(false))\n\t\t\t.addModel(UsersModel.create().setVariables({host: this.host, defaultName: this.getLocalize('IM_MESSENGER_MESSAGE_USER_ANONYM')}).useDatabase(false))\n\t\t\t.addModel(FilesModel.create().setVariables({host: this.host}).useDatabase(false))\n\t\t\t.setDatabaseConfig({\n\t\t\t\tname: 'imol/widget',\n\t\t\t\ttype: VuexBuilder.DatabaseType.localStorage,\n\t\t\t\tsiteId: this.getSiteId(),\n\t\t\t})\n\t\t.build(result => {\n\n\t\t\tthis.store = result.store;\n\t\t\tthis.storeCollector = result.builder;\n\n\t\t\tthis.initRestClient();\n\n\t\t\tthis.controller.setVuexStore(this.store);\n\t\t\tthis.controller.setRestClient(this.restClient);\n\n\t\t\tthis.controller.setPrepareFilesBeforeSaveFunction(this.prepareFileData.bind(this));\n\n\t\t\tthis.imRestAnswer = ImRestAnswerHandler.create({\n\t\t\t\tstore: this.store,\n\t\t\t\tcontroller: this.controller,\n\t\t\t});\n\t\t\tthis.widgetRestAnswer = WidgetRestAnswerHandler.create({\n\t\t\t\twidget: this,\n\t\t\t\tstore: this.store,\n\t\t\t\tcontroller: this.controller,\n\t\t\t});\n\n\t\t\twindow.dispatchEvent(new CustomEvent('onBitrixLiveChat', {detail: {\n\t\t\t\twidget: this,\n\t\t\t\twidgetCode: this.code,\n\t\t\t\twidgetHost: this.host,\n\t\t\t}}));\n\n\t\t\tif (this.callStartFlag)\n\t\t\t{\n\t\t\t\tthis.start();\n\t\t\t}\n\n\t\t\tif (this.pageMode || this.callOpenFlag)\n\t\t\t{\n\t\t\t\tthis.open();\n\t\t\t}\n\t\t});\n\t}\n\n\tinitRestClient()\n\t{\n\t\tthis.restClient = new WidgetRestClient({endpoint: this.host+'/rest'});\n\n\t\tif (this.isUserRegistered())\n\t\t{\n\t\t\tthis.restClient.setAuthId(this.getUserHash());\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.restClient.setAuthId(RestAuth.guest);\n\t\t}\n\t}\n\n\trequestWidgetData()\n\t{\n\t\tif (!this.isReady())\n\t\t{\n\t\t\tconsole.error('LiveChatWidget.start: widget code or host is not specified');\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.widgetDataRequested = true;\n\t\tif (\n\t\t\t!this.isUserRegistered() && (\n\t\t\t\tthis.userRegisterData.hash\n\t\t\t\t|| this.getUserHashCookie()\n\t\t\t)\n\t\t)\n\t\t{\n\t\t\tthis.requestData();\n\t\t\tthis.inited = true;\n\t\t\tthis.fireInitEvent();\n\t\t}\n\t\telse if (this.isConfigDataLoaded() && this.isUserRegistered())\n\t\t{\n\t\t\tthis.requestData();\n\t\t\tthis.inited = true;\n\t\t\tthis.fireInitEvent();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.restClient.callMethod(RestMethod.widgetConfigGet, {code: this.code}, (xhr) => {this.configRequestXhr = xhr}).then((result) => {\n\t\t\t\tthis.configRequestXhr = null;\n\t\t\t\tthis.clearError();\n\n\t\t\t\tthis.executeRestAnswer(RestMethod.widgetConfigGet, result);\n\n\t\t\t\tif (!this.inited)\n\t\t\t\t{\n\t\t\t\t\tthis.inited = true;\n\t\t\t\t\tthis.fireInitEvent();\n\t\t\t\t}\n\t\t\t}).catch(result => {\n\t\t\t\tthis.configRequestXhr = null;\n\n\t\t\t\tthis.setError(result.error().ex.error, result.error().ex.error_description);\n\t\t\t});\n\n\t\t\tif (this.isConfigDataLoaded())\n\t\t\t{\n\t\t\t\tthis.inited = true;\n\t\t\t\tthis.fireInitEvent();\n\t\t\t}\n\t\t}\n\t}\n\n\trequestData()\n\t{\n\t\tif (this.requestDataSend)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tthis.requestDataSend = true;\n\n\t\tif (this.configRequestXhr)\n\t\t{\n\t\t\tthis.configRequestXhr.abort();\n\t\t}\n\n\t\tlet query = {\n\t\t\t[RestMethod.widgetConfigGet]: [RestMethod.widgetConfigGet, {code: this.code}]\n\t\t};\n\n\t\tif (this.isUserRegistered())\n\t\t{\n\t\t\tquery[RestMethod.widgetDialogGet] = [RestMethod.widgetDialogGet, {config_id: this.getConfigId(), trace_data: this.getCrmTraceData(), custom_data: this.getCustomData()}];\n\t\t\tquery[ImRestMethod.imChatGet] = [ImRestMethod.imChatGet, {dialog_id: '$result['+RestMethod.widgetDialogGet+'][dialogId]'}];\n\t\t\tquery[ImRestMethod.imDialogMessagesGet] = [ImRestMethod.imDialogMessagesGet, {chat_id: '$result['+RestMethod.widgetDialogGet+'][chatId]', limit: this.controller.getRequestMessageLimit(), convert_text: 'Y'}];\n\t\t}\n\t\telse\n\t\t{\n\t\t\tquery[RestMethod.widgetUserRegister] = [RestMethod.widgetUserRegister, {config_id: '$result['+RestMethod.widgetConfigGet+'][configId]', ...this.getUserRegisterFields()}];\n\t\t\tquery[ImRestMethod.imChatGet] = [ImRestMethod.imChatGet, {dialog_id: '$result['+RestMethod.widgetUserRegister+'][dialogId]'}];\n\n\t\t\tif (this.userRegisterData.hash || this.getUserHashCookie())\n\t\t\t{\n\t\t\t\tquery[RestMethod.widgetDialogGet] = [RestMethod.widgetDialogGet, {config_id: '$result['+RestMethod.widgetConfigGet+'][configId]', trace_data: this.getCrmTraceData(), custom_data: this.getCustomData()}];\n\t\t\t\tquery[ImRestMethod.imDialogMessagesGet] = [ImRestMethod.imDialogMessagesGet, {chat_id: '$result['+RestMethod.widgetDialogGet+'][chatId]', limit: this.controller.getRequestMessageLimit(), convert_text: 'Y'}];\n\t\t\t}\n\t\t\tif (this.isUserAgreeConsent())\n\t\t\t{\n\t\t\t\tquery[RestMethod.widgetUserConsentApply] = [RestMethod.widgetUserConsentApply, {config_id: '$result['+RestMethod.widgetConfigGet+'][configId]', consent_url: location.href}];\n\t\t\t}\n\t\t}\n\n\t\tquery[RestMethod.pullServerTime] = [RestMethod.pullServerTime, {}];\n\t\tquery[RestMethod.pullConfigGet] = [RestMethod.pullConfigGet, {'CACHE': 'N'}];\n\t\tquery[RestMethod.widgetUserGet] = [RestMethod.widgetUserGet, {}];\n\n\t\tthis.restClient.callBatch(query, (response) =>\n\t\t{\n\t\t\tif (!response)\n\t\t\t{\n\t\t\t\tthis.requestDataSend = false;\n\t\t\t\tthis.setError('EMPTY_RESPONSE', 'Server returned an empty response.');\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tlet configGet = response[RestMethod.widgetConfigGet];\n\t\t\tif (configGet && configGet.error())\n\t\t\t{\n\t\t\t\tthis.requestDataSend = false;\n\n\t\t\t\tthis.setError(configGet.error().ex.error, configGet.error().ex.error_description);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tthis.executeRestAnswer(RestMethod.widgetConfigGet, configGet);\n\n\t\t\tlet userGetResult = response[RestMethod.widgetUserGet];\n\t\t\tif (userGetResult.error())\n\t\t\t{\n\t\t\t\tthis.requestDataSend = false;\n\t\t\t\tthis.setError(userGetResult.error().ex.error, userGetResult.error().ex.error_description);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tthis.executeRestAnswer(RestMethod.widgetUserGet, userGetResult);\n\n\t\t\tlet chatGetResult = response[ImRestMethod.imChatGet];\n\t\t\tif (chatGetResult.error())\n\t\t\t{\n\t\t\t\tthis.requestDataSend = false;\n\t\t\t\tthis.setError(chatGetResult.error().ex.error, chatGetResult.error().ex.error_description);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tthis.executeRestAnswer(ImRestMethod.imChatGet, chatGetResult);\n\n\t\t\tlet dialogGetResult = response[RestMethod.widgetDialogGet];\n\t\t\tif (dialogGetResult)\n\t\t\t{\n\t\t\t\tif (dialogGetResult.error())\n\t\t\t\t{\n\t\t\t\t\tthis.requestDataSend = false;\n\t\t\t\t\tthis.setError(dialogGetResult.error().ex.error, dialogGetResult.error().ex.error_description);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tthis.executeRestAnswer(RestMethod.widgetDialogGet, dialogGetResult);\n\t\t\t}\n\n\t\t\tlet dialogMessagesGetResult = response[ImRestMethod.imDialogMessagesGet];\n\t\t\tif (dialogMessagesGetResult)\n\t\t\t{\n\t\t\t\tif (dialogMessagesGetResult.error())\n\t\t\t\t{\n\t\t\t\t\tthis.requestDataSend = false;\n\t\t\t\t\tthis.setError(dialogMessagesGetResult.error().ex.error, dialogMessagesGetResult.error().ex.error_description);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tthis.executeRestAnswer(ImRestMethod.imDialogMessagesGet, dialogMessagesGetResult);\n\t\t\t}\n\n\t\t\tlet userRegisterResult = response[RestMethod.widgetUserRegister];\n\t\t\tif (userRegisterResult)\n\t\t\t{\n\t\t\t\tif (userRegisterResult.error())\n\t\t\t\t{\n\t\t\t\t\tthis.requestDataSend = false;\n\t\t\t\t\tthis.setError(userRegisterResult.error().ex.error, userRegisterResult.error().ex.error_description);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tthis.executeRestAnswer(RestMethod.widgetUserRegister, userRegisterResult);\n\t\t\t}\n\n\t\t\tlet timeShift = 0;\n\n\t\t\tlet serverTimeResult = response[RestMethod.pullServerTime];\n\t\t\tif (serverTimeResult && !serverTimeResult.error())\n\t\t\t{\n\t\t\t\ttimeShift = Math.floor(((new Date()).getTime() - new Date(serverTimeResult.data()).getTime())/1000);\n\t\t\t}\n\n\t\t\tlet config = null;\n\t\t\tlet pullConfigResult = response[RestMethod.pullConfigGet];\n\t\t\tif (pullConfigResult && !pullConfigResult.error())\n\t\t\t{\n\t\t\t\tconfig = pullConfigResult.data();\n\t\t\t\tconfig.server.timeShift = timeShift;\n\t\t\t}\n\n\t\t\tthis.startPullClient(config).then(() => {\n\t\t\t\tthis.processSendMessages();\n\t\t\t\tthis.processSendFiles();\n\t\t\t}).catch((error) => {\n\t\t\t\tthis.setError(error.ex.error, error.ex.error_description);\n\t\t\t});\n\n\t\t\tthis.requestDataSend = false;\n\t\t}, false, false, Utils.getLogTrackingParams({name: 'widget.init.config', dialog: this.getDialogData()}));\n\t}\n\n\texecuteRestAnswer(command, result, extra)\n\t{\n\t\tthis.imRestAnswer.execute(command, result, extra);\n\t\tthis.widgetRestAnswer.execute(command, result, extra);\n\t}\n\n\tprepareFileData(files)\n\t{\n\t\tif (Cookie.get(null, 'BITRIX_LIVECHAT_AUTH'))\n\t\t{\n\t\t\treturn files;\n\t\t}\n\n\t\treturn files.map(file =>\n\t\t{\n\t\t\tlet hash = (window.md5 || md5)(this.getUserId()+'|'+file.id+'|'+this.getUserHash());\n\t\t\tlet urlParam = 'livechat_auth_id='+hash+'&livechat_user_id='+this.getUserId();\n\t\t\tif (file.urlPreview)\n\t\t\t{\n\t\t\t\tfile.urlPreview = file.urlPreview+'&'+urlParam;\n\t\t\t}\n\t\t\tif (file.urlShow)\n\t\t\t{\n\t\t\t\tfile.urlShow = file.urlShow+'&'+urlParam;\n\t\t\t}\n\t\t\tif (file.urlDownload)\n\t\t\t{\n\t\t\t\tfile.urlDownload = file.urlDownload+'&'+urlParam;\n\t\t\t}\n\n\t\t\treturn file;\n\t\t});\n\t}\n\n\tcheckBrowserVersion()\n\t{\n\t\tif (Utils.platform.isIos())\n\t\t{\n\t\t\tlet version = Utils.platform.getIosVersion();\n\t\t\tif (version && version <= 10)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\treturn true;\n\t}\n\n/* endregion 01. Initialize and store data */\n\n/* region 02. Push & Pull */\n\n\tstartPullClient(config)\n\t{\n\t\tlet promise = new BX.Promise();\n\n\t\tif (this.pullClient)\n\t\t{\n\t\t\tif (!this.pullClient.isConnected())\n\t\t\t{\n\t\t\t\tthis.pullClient.scheduleReconnect();\n\t\t\t}\n\t\t\tpromise.resolve(true);\n\t\t\treturn promise;\n\t\t}\n\t\tif (!this.getUserId() || !this.getSiteId() || !this.restClient)\n\t\t{\n\t\t\tpromise.reject({\n\t\t\t\tex: { error: 'WIDGET_NOT_LOADED', error_description: 'Widget is not loaded.'}\n\t\t\t});\n\t\t\treturn promise;\n\t\t}\n\n\t\tthis.pullClient = new PullClient({\n\t\t\tserverEnabled: true,\n\t\t\tuserId: this.getUserId(),\n\t\t\tsiteId: this.getSiteId(),\n\t\t\trestClient: this.restClient,\n\t\t\tconfigTimestamp: config? config.server.config_timestamp: 0,\n\t\t\tskipCheckRevision: true,\n\t\t});\n\n\t\tthis.pullClient.subscribe(\n\t\t\tnew ImPullCommandHandler({\n\t\t\t\tstore: this.store,\n\t\t\t\tcontroller: this.controller,\n\t\t\t})\n\t\t);\n\t\tthis.pullClient.subscribe(\n\t\t\tnew WidgetImPullCommandHandler({\n\t\t\t\tstore: this.store,\n\t\t\t\tcontroller: this.controller,\n\t\t\t\twidget: this,\n\t\t\t})\n\t\t);\n\t\tthis.pullClient.subscribe(\n\t\t\tnew WidgetImopenlinesPullCommandHandler({\n\t\t\t\tstore: this.store,\n\t\t\t\tcontroller: this.controller,\n\t\t\t\twidget: this,\n\t\t\t})\n\t\t);\n\n\t\tthis.pullClient.subscribe({\n\t\t\ttype: PullClient.SubscriptionType.Status,\n\t\t\tcallback: this.eventStatusInteraction.bind(this)\n\t\t});\n\n\t\tthis.pullConnectedFirstTime = this.pullClient.subscribe({\n\t\t\ttype: PullClient.SubscriptionType.Status,\n\t\t\tcallback: (result) => {\n\t\t\t\tif (result.status == PullClient.PullStatus.Online)\n\t\t\t\t{\n\t\t\t\t\tpromise.resolve(true);\n\t\t\t\t\tthis.pullConnectedFirstTime();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tif (this.template)\n\t\t{\n\t\t\tthis.template.$root.$bitrixPullClient = this.pullClient;\n\t\t\tthis.template.$root.$emit('onBitrixPullClientInited', this.pullClient);\n\t\t}\n\n\t\tthis.pullClient.start(config).catch(function(){\n\t\t\tpromise.reject({\n\t\t\t\tex: { error: 'PULL_CONNECTION_ERROR', error_description: 'Pull is not connected.'}\n\t\t\t});\n\t\t});\n\n\t\treturn promise;\n\t}\n\n\tstopPullClient()\n\t{\n\t\tif (this.pullClient)\n\t\t{\n\t\t\tthis.pullClient.stop(PullClient.CloseReasons.MANUAL, 'Closed manually');\n\t\t}\n\t}\n\n\trecoverPullConnection()\n\t{\n\t\t// this.pullClient.session.mid = 0; // TODO specially for disable pull history, remove after recode im\n\t\tthis.pullClient.restart(PullClient.CloseReasons.MANUAL, 'Restart after click by connection status button.');\n\t}\n\n\teventStatusInteraction(data)\n\t{\n\t\tif (data.status === PullClient.PullStatus.Online)\n\t\t{\n\t\t\tthis.offline = false;\n\n\t\t\tif (this.pullRequestMessage)\n\t\t\t{\n\t\t\t\tthis.getDialogUnread().then(() => {\n\t\t\t\t\tthis.readMessage();\n\t\t\t\t\tthis.processSendMessages();\n\t\t\t\t\tthis.processSendFiles();\n\t\t\t\t});\n\t\t\t\tthis.pullRequestMessage = false;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.readMessage();\n\t\t\t\tthis.processSendMessages();\n\t\t\t\tthis.processSendFiles();\n\t\t\t}\n\t\t}\n\t\telse if (data.status === PullClient.PullStatus.Offline)\n\t\t{\n\t\t\tthis.pullRequestMessage = true;\n\t\t\tthis.offline = true;\n\t\t}\n\t}\n\n/* endregion 02. Push & Pull */\n\n/* region 03. Template engine */\n\n\tattachTemplate()\n\t{\n\t\tif (this.template)\n\t\t{\n\t\t\tthis.store.commit('widget/common', {showed: true});\n\t\t\treturn true;\n\t\t}\n\n\t\tthis.rootNode.innerHTML = '';\n\t\tthis.rootNode.appendChild(document.createElement('div'));\n\n\t\tconst widgetContext = this;\n\t\tconst controller = this.controller;\n\t\tconst restClient = this.restClient;\n\t\tconst pullClient = this.pullClient || null;\n\n\t\tthis.template = Vue.create({\n\t\t\tel: this.rootNode.firstChild,\n\t\t\tstore: this.store,\n\t\t\ttemplate: '<bx-livechat/>',\n\t\t\tbeforeCreate()\n\t\t\t{\n\t\t\t\tthis.$bitrixWidget = widgetContext;\n\t\t\t\tthis.$bitrixController = controller;\n\t\t\t\tthis.$bitrixRestClient = restClient;\n\t\t\t\tthis.$bitrixPullClient = pullClient;\n\t\t\t\tthis.$bitrixMessages = widgetContext.localize;\n\n\t\t\t\twidgetContext.sendEvent({\n\t\t\t\t\ttype: SubscriptionType.widgetOpen,\n\t\t\t\t\tdata: {}\n\t\t\t\t});\n\t\t\t},\n\t\t\tdestroyed()\n\t\t\t{\n\t\t\t\twidgetContext.sendEvent({\n\t\t\t\t\ttype: SubscriptionType.widgetClose,\n\t\t\t\t\tdata: {}\n\t\t\t\t});\n\n\t\t\t\tthis.$bitrixWidget.template = null;\n\t\t\t\tthis.$bitrixWidget.templateAttached = false;\n\t\t\t\tthis.$bitrixWidget.rootNode.innerHTML = '';\n\n\t\t\t\tthis.$bitrixWidget = null;\n\t\t\t\tthis.$bitrixRestClient = null;\n\t\t\t\tthis.$bitrixPullClient = null;\n\t\t\t\tthis.$bitrixMessages = null;\n\t\t\t}\n\t\t});\n\n\t\treturn true;\n\t}\n\n\tdetachTemplate()\n\t{\n\t\tif (!this.template)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tthis.template.$destroy();\n\n\t\treturn true;\n\t}\n\n\tmutateTemplateComponent(id, params)\n\t{\n\t\treturn Vue.mutateComponent(id, params);\n\t}\n\n/* endregion 03. Template engine */\n\n/* region 04. Rest methods */\n\n\taddMessage(text = '')\n\t{\n\t\tif (!text)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tLogger.warn('addMessage', text);\n\n\t\tif (!this.controller.isUnreadMessagesLoaded())\n\t\t{\n\t\t\tthis.sendMessage({id: 0, text});\n\t\t\tthis.processSendMessages();\n\n\t\t\treturn true;\n\t\t}\n\n\t\tthis.store.dispatch('messages/add', {\n\t\t\tchatId: this.getChatId(),\n\t\t\tauthorId: this.getUserId(),\n\t\t\ttext: text,\n\t\t}).then(messageId => {\n\n\t\t\tif (!this.isDialogStart())\n\t\t\t{\n\t\t\t\tthis.store.commit('widget/common', {dialogStart:true});\n\t\t\t}\n\n\t\t\tthis.messagesQueue.push({\n\t\t\t\tid: messageId,\n\t\t\t\ttext,\n\t\t\t\tsending: false\n\t\t\t});\n\n\t\t\tif (this.getChatId())\n\t\t\t{\n\t\t\t\tthis.processSendMessages();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.requestData();\n\t\t\t}\n\n\t\t});\n\n\t\treturn true;\n\t}\n\n\taddFile(fileInput)\n\t{\n\t\tif (!fileInput)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tLogger.warn('addFile', fileInput.files[0].name, fileInput.files[0].size);\n\n\t\tif (!this.isDialogStart())\n\t\t{\n\t\t\tthis.store.commit('widget/common', {dialogStart:true});\n\t\t}\n\n\t\tthis.filesQueue.push({\n\t\t\tid: this.filesQueueIndex,\n\t\t\tfileInput\n\t\t});\n\t\tthis.filesQueueIndex++;\n\n\t\tif (this.getChatId())\n\t\t{\n\t\t\tthis.processSendFiles();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.requestData();\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tprocessSendMessages()\n\t{\n\t\tif (this.offline)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.messagesQueue.filter(element => !element.sending).forEach(element => {\n\t\t\telement.sending = true;\n\t\t\tthis.sendMessage(element);\n\t\t});\n\n\t\treturn true;\n\t}\n\n\tprocessSendFiles()\n\t{\n\t\tif (this.offline)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.filesQueue.filter(element => !element.sending).forEach(element => {\n\t\t\telement.sending = true;\n\t\t\tthis.sendFile(element);\n\t\t});\n\n\t\treturn true;\n\t}\n\n\tsendMessage(message)\n\t{\n\t\tthis.controller.stopWriting();\n\n\t\tthis.restClient.callMethod(ImRestMethod.imMessageAdd, {\n\t\t\t'TEMP_ID': message.id,\n\t\t\t'CHAT_ID': this.getChatId(),\n\t\t\t'MESSAGE': message.text\n\t\t}, null, null, Utils.getLogTrackingParams({\n\t\t\tname: ImRestMethod.imMessageAdd,\n\t\t\tdata: {timMessageType: 'text'},\n\t\t\tdialog: this.getDialogData()\n\t\t})).then(response => {\n\t\t\tthis.executeRestAnswer(ImRestMethod.imMessageAdd, response, message);\n\t\t}).catch(error => {\n\t\t\tthis.executeRestAnswer(ImRestMethod.imMessageAdd, error, message);\n\t\t});\n\t}\n\n\tsendFile(file)\n\t{\n\t\tlet fileName = file.fileInput.files[0].name;\n\t\tlet fileType = 'file'; // TODO set type by fileInput type\n\n\t\tlet diskFolderId = this.getDiskFolderId();\n\n\t\tlet query = {};\n\n\t\tif (diskFolderId)\n\t\t{\n\t\t\tquery[ImRestMethod.imDiskFileUpload] = [ImRestMethod.imDiskFileUpload, {\n\t\t\t\tid : diskFolderId,\n\t\t\t\tdata : {NAME : fileName},\n\t\t\t\tfileContent: file.fileInput,\n\t\t\t\tgenerateUniqueName: true\n\t\t\t}];\n\t\t}\n\t\telse\n\t\t{\n\t\t\tquery[ImRestMethod.imDiskFolderGet] = [ImRestMethod.imDiskFolderGet, {chat_id: this.getChatId()}];\n\t\t\tquery[ImRestMethod.imDiskFileUpload] = [ImRestMethod.imDiskFileUpload, {\n\t\t\t\tid : '$result[' + ImRestMethod.imDiskFolderGet + '][ID]',\n\t\t\t\tdata : {\n\t\t\t\t\tNAME : fileName\n\t\t\t\t},\n\t\t\t\tfileContent: file.fileInput,\n\t\t\t\tgenerateUniqueName: true\n\t\t\t}];\n\t\t}\n\t\tquery[ImRestMethod.imDiskFileCommit] = [ImRestMethod.imDiskFileCommit, {\n\t\t\tchat_id : this.getChatId(),\n\t\t\tupload_id : '$result[' + ImRestMethod.imDiskFileUpload + '][ID]',\n\t\t}];\n\n\t\tthis.store.commit('widget/common', {uploadFilePlus: true}); // TODO remove this after create new file-loader\n\n\t\tthis.restClient.callBatch(query, (response) =>\n\t\t{\n\t\t\tthis.store.commit('widget/common', {uploadFileMinus: true}); // TODO  remove this after create new file-loader\n\n\t\t\tif (!response)\n\t\t\t{\n\t\t\t\tthis.requestDataSend = false;\n\t\t\t\tthis.setError('EMPTY_RESPONSE', 'Server returned an empty response.');\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (!diskFolderId)\n\t\t\t{\n\t\t\t\tlet diskFolderGet = response[ImRestMethod.imDiskFolderGet];\n\t\t\t\tif (diskFolderGet && diskFolderGet.error())\n\t\t\t\t{\n\t\t\t\t\tconsole.warn(diskFolderGet.error().ex.error, diskFolderGet.error().ex.error_description);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tthis.executeRestAnswer(ImRestMethod.imDiskFolderGet, diskFolderGet);\n\t\t\t}\n\n\t\t\tlet diskFileUpload = response[ImRestMethod.imDiskFileUpload];\n\t\t\tif (diskFileUpload && diskFileUpload.error())\n\t\t\t{\n\t\t\t\tconsole.warn(diskFileUpload.error().ex.error, diskFileUpload.error().ex.error_description);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tLogger.log('upload success', diskFileUpload.data())\n\t\t\t}\n\n\t\t\tlet diskFileCommit = response[ImRestMethod.imDiskFileCommit];\n\t\t\tif (diskFileCommit && diskFileCommit.error())\n\t\t\t{\n\t\t\t\tconsole.warn(diskFileCommit.error().ex.error, diskFileCommit.error().ex.error_description);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tLogger.log('commit success', diskFileCommit.data())\n\t\t\t}\n\t\t}, false, false, Utils.getLogTrackingParams({\n\t\t\tname: ImRestMethod.imDiskFileCommit,\n\t\t\tdata: {timMessageType: fileType},\n\t\t\tdialog: this.getDialogData()\n\t\t}));\n\n\t\tthis.filesQueue = this.filesQueue.filter(el => el.id != file.id);\n\t}\n\n\tgetDialogHistory(lastId, limit = this.controller.getRequestMessageLimit())\n\t{\n\t\tthis.restClient.callMethod(ImRestMethod.imDialogMessagesGet, {\n\t\t\t'CHAT_ID': this.getChatId(),\n\t\t\t'LAST_ID': lastId,\n\t\t\t'LIMIT': limit,\n\t\t\t'CONVERT_TEXT': 'Y'\n\t\t}).then(result => {\n\t\t\tthis.executeRestAnswer(ImRestMethod.imDialogMessagesGet, result);\n\t\t\tthis.template.$emit('onDialogRequestHistoryResult', {count: result.data().messages.length});\n\t\t}).catch(result => {\n\t\t\tthis.template.$emit('onDialogRequestHistoryResult', {error: result.error().ex});\n\t\t});\n\t}\n\n\tgetDialogUnread(lastId, limit = this.controller.getRequestMessageLimit())\n\t{\n\t\tconst promise = new BX.Promise();\n\n\t\tif (!lastId)\n\t\t{\n\t\t\tlastId = this.store.getters['messages/getLastId'](this.getChatId());\n\t\t}\n\n\t\tif (!lastId)\n\t\t{\n\t\t\tthis.template.$emit('onDialogRequestUnreadResult', {error: {error: 'LAST_ID_EMPTY', error_description: 'LastId is empty.'}});\n\t\t\tpromise.reject();\n\t\t\treturn promise;\n\t\t}\n\n\t\tlet query = {\n\t\t\t[ImRestMethod.imChatGet]: [ImRestMethod.imChatGet, {\n\t\t\t\tdialog_id: this.getDialogId()\n\t\t\t}],\n\t\t\t[ImRestMethod.imDialogMessagesUnread]: [ImRestMethod.imDialogMessagesGet, {\n\t\t\t\tchat_id: this.getChatId(),\n\t\t\t\tfirst_id: lastId,\n\t\t\t\tlimit: limit,\n\t\t\t\tconvert_text: 'Y'\n\t\t\t}]\n\t\t};\n\n\t\tthis.restClient.callBatch(query, (response) =>\n\t\t{\n\t\t\tif (!response)\n\t\t\t{\n\t\t\t\tthis.template.$emit('onDialogRequestUnreadResult', {error: {error: 'EMPTY_RESPONSE', error_description: 'Server returned an empty response.'}});\n\n\t\t\t\tpromise.reject();\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tlet chatGetResult = response[ImRestMethod.imChatGet];\n\t\t\tif (!chatGetResult.error())\n\t\t\t{\n\t\t\t\tthis.executeRestAnswer(ImRestMethod.imChatGet, chatGetResult);\n\t\t\t}\n\n\t\t\tlet dialogMessageUnread = response[ImRestMethod.imDialogMessagesUnread];\n\t\t\tif (dialogMessageUnread.error())\n\t\t\t{\n\t\t\t\tthis.template.$emit('onDialogRequestUnreadResult', {error: dialogMessageUnread.error().ex});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.executeRestAnswer(ImRestMethod.imDialogMessagesUnread, dialogMessageUnread);\n\t\t\t\tthis.template.$emit('onDialogRequestUnreadResult', {count: dialogMessageUnread.data().messages.length});\n\t\t\t}\n\n\t\t\tpromise.fulfill(response);\n\n\t\t}, false, false, Utils.getLogTrackingParams({name: ImRestMethod.imDialogMessagesUnread, dialog: this.getDialogData()}));\n\n\t\treturn promise;\n\t}\n\n\tretrySendMessage(message)\n\t{\n\t\tif (this.messagesQueue.find(el => el.id == message.id))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.messagesQueue.push({\n\t\t\tid: message.id,\n\t\t\ttext: message.text,\n\t\t\tsending: false\n\t\t});\n\n\t\tthis.controller.setSendingMessageFlag(message.id);\n\n\t\tthis.processSendMessages();\n\t}\n\n\treadMessage(messageId)\n\t{\n\t\tif (this.offline)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\treturn this.controller.readMessage(messageId);\n\t}\n\n\tsendDialogVote(result)\n\t{\n\t\tif (!this.getSessionId())\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.restClient.callMethod(RestMethod.widgetVoteSend, {\n\t\t\t'SESSION_ID': this.getSessionId(),\n\t\t\t'ACTION': result\n\t\t}).catch((result) => {\n\t\t\tthis.store.commit('widget/dialog', {userVote: VoteType.none});\n\t\t});\n\n\t\tthis.sendEvent({\n\t\t\ttype: SubscriptionType.userVote,\n\t\t\tdata: {\n\t\t\t\tvote: result\n\t\t\t}\n\t\t});\n\t}\n\n\tsendForm(type, fields)\n\t{\n\t\tLogger.info('LiveChatWidgetPrivate.sendForm:', type, fields);\n\n\t\tlet query = {\n\t\t\t[RestMethod.widgetFormSend]: [RestMethod.widgetFormSend, {\n\t\t\t\t'CHAT_ID': this.getChatId(),\n\t\t\t\t'FORM': type.toUpperCase(),\n\t\t\t\t'FIELDS': fields\n\t\t\t}],\n\t\t\t[RestMethod.widgetUserGet]: [RestMethod.widgetUserGet, {}]\n\t\t};\n\t\tthis.restClient.callBatch(query, (response) =>\n\t\t{\n\t\t\tif (!response)\n\t\t\t{\n\t\t\t\tthis.requestDataSend = false;\n\t\t\t\tthis.setError('EMPTY_RESPONSE', 'Server returned an empty response.');\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tlet userGetResult = response[RestMethod.widgetUserGet];\n\t\t\tif (userGetResult.error())\n\t\t\t{\n\t\t\t\tthis.requestDataSend = false;\n\t\t\t\tthis.setError(userGetResult.error().ex.error, userGetResult.error().ex.error_description);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tthis.executeRestAnswer(RestMethod.widgetUserGet, userGetResult);\n\n\t\t\tthis.sendEvent({\n\t\t\t\ttype: SubscriptionType.userForm,\n\t\t\t\tdata: {\n\t\t\t\t\tform: type,\n\t\t\t\t\tfields: fields\n\t\t\t\t}\n\t\t\t});\n\n\t\t}, false, false, Utils.getLogTrackingParams({name: RestMethod.widgetUserGet, dialog: this.getDialogData()}));\n\n\t}\n\n\tsendConsentDecision(result)\n\t{\n\t\tresult = result === true;\n\n\t\tthis.store.commit('widget/dialog', {userConsent: result});\n\n\t\tif (result && this.isUserRegistered())\n\t\t{\n\t\t\tthis.restClient.callMethod(RestMethod.widgetUserConsentApply, {\n\t\t\t\tconfig_id: this.getConfigId(),\n\t\t\t\tconsent_url: location.href\n\t\t\t});\n\t\t}\n\t}\n\n/* endregion 05. Templates and template interaction */\n\n/* region 05. Widget interaction and utils */\n\n\tstart()\n\t{\n\t\tif (!this.store)\n\t\t{\n\t\t\tthis.callStartFlag = true;\n\t\t\treturn true;\n\t\t}\n\n\t\tif (this.isSessionActive())\n\t\t{\n\t\t\tthis.requestWidgetData();\n\t\t}\n\n\t\treturn true;\n\t}\n\n\topen(params = {})\n\t{\n\t\tclearTimeout(this.openTimeout);\n\t\tif (!this.store)\n\t\t{\n\t\t\tthis.callOpenFlag = true;\n\t\t\treturn true;\n\t\t}\n\n\t\tif (!params.openFromButton && this.buttonInstance)\n\t\t{\n\t\t\tthis.buttonInstance.wm.showById('openline_livechat');\n\t\t}\n\n\t\tif (!this.checkBrowserVersion())\n\t\t{\n\t\t\tthis.setError('OLD_BROWSER_LOCALIZED', this.localize.BX_LIVECHAT_OLD_BROWSER);\n\t\t}\n\t\telse if (Utils.versionCompare(Vue.version(), '2.1') < 0)\n\t\t{\n\t\t\talert(this.localize.BX_LIVECHAT_OLD_VUE);\n\t\t\tconsole.error(`LiveChatWidget.error: OLD_VUE_VERSION (${this.localize.BX_LIVECHAT_OLD_VUE_DEV.replace('#CURRENT_VERSION#', Vue.version())})`);\n\n\t\t\treturn false;\n\t\t}\n\t\telse if (!this.isWidgetDataRequested())\n\t\t{\n\t\t\tthis.requestWidgetData();\n\t\t}\n\n\t\tthis.attachTemplate();\n\t}\n\n\tclose()\n\t{\n\t\tif (this.pageMode)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tif (this.buttonInstance)\n\t\t{\n\t\t\tthis.buttonInstance.onWidgetClose();\n\t\t}\n\n\t\tthis.detachTemplate();\n\t}\n\n\tshowNotification(params)\n\t{\n\t\tif (!this.store)\n\t\t{\n\t\t\tconsole.error('LiveChatWidget.showNotification: method can be called after fired event - onBitrixLiveChat');\n\t\t\treturn false;\n\t\t}\n\t\t// TODO show popup notification and set badge on button\n\t\t// operatorName\n\t\t// notificationText\n\t\t// counter\n\t}\n\n\tfireInitEvent()\n\t{\n\t\tif (this.initEventFired)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tthis.sendEvent({\n\t\t\ttype: SubscriptionType.configLoaded,\n\t\t\tdata: {}\n\t\t});\n\n\t\tif (this.store.state.widget.common.reopen)\n\t\t{\n\t\t\tthis.open();\n\t\t}\n\n\t\tthis.initEventFired = true;\n\n\t\treturn true;\n\t}\n\n\tisReady()\n\t{\n\t\treturn this.ready;\n\t}\n\n\tisInited()\n\t{\n\t\treturn this.inited;\n\t}\n\n\tisUserRegistered()\n\t{\n\t\treturn !!this.getUserHash();\n\t}\n\n\tisConfigDataLoaded()\n\t{\n\t\treturn this.store.state.widget.common.configId;\n\t}\n\n\tisWidgetDataRequested()\n\t{\n\t\treturn this.widgetDataRequested;\n\t}\n\n\tisChatLoaded()\n\t{\n\t\treturn this.store.state.application.dialog.chatId > 0;\n\t}\n\n\tisSessionActive()\n\t{\n\t\treturn !this.store.state.widget.dialog.sessionClose;\n\t}\n\n\tisUserAgreeConsent()\n\t{\n\t\treturn this.store.state.widget.dialog.userConsent;\n\t}\n\n\tgetCrmTraceData()\n\t{\n\t\tlet traceData = '';\n\n\t\tif (!this.buttonInstance)\n\t\t{\n\t\t\treturn traceData;\n\t\t}\n\n\t\tif (typeof this.buttonInstance.getTrace !== 'function')\n\t\t{\n\t\t\ttraceData = this.buttonInstance.getTrace();\n\t\t}\n\t\telse if (\n\t\t\ttypeof this.buttonInstance.b24Tracker !== 'undefined'\n\t\t\t&& typeof this.buttonInstance.b24Tracker.guest !== 'undefined'\n\t\t)\n\t\t{\n\t\t\ttraceData = this.buttonInstance.b24Tracker.guest.getTrace();\n\t\t}\n\n\t\treturn traceData;\n\t}\n\n\tgetCustomData()\n\t{\n\t\tlet customData = [];\n\n\t\tif (this.customData.length > 0)\n\t\t{\n\t\t\tcustomData = this.customData;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tcustomData = [{MESSAGE: this.localize.BX_LIVECHAT_EXTRA_SITE+': '+location.href}];\n\t\t}\n\n\t\treturn JSON.stringify(customData);\n\t}\n\n\tisUserLoaded()\n\t{\n\t\treturn this.store.state.widget.user.id > 0;\n\t}\n\n\tgetSiteId()\n\t{\n\t\treturn this.host.replace(/(http.?:\\/\\/)|([:.\\\\\\/])/mg, \"\")+this.code;\n\t}\n\n\tgetHost()\n\t{\n\t\treturn this.host;\n\t}\n\n\tgetConfigId()\n\t{\n\t\treturn this.store.state.widget.common.configId;\n\t}\n\n\tgetChatId()\n\t{\n\t\treturn this.store.state.application.dialog.chatId;\n\t}\n\n\tisDialogStart()\n\t{\n\t\treturn this.store.state.widget.common.dialogStart;\n\t}\n\n\tgetDialogId()\n\t{\n\t\treturn this.store.state.application.dialog.dialogId;\n\t}\n\n\tgetDialogData(dialogId = this.getDialogId())\n\t{\n\t\treturn this.store.state.dialogues.collection[dialogId];\n\t}\n\n\tgetDiskFolderId()\n\t{\n\t\treturn this.store.state.application.dialog.diskFolderId;\n\t}\n\n\tgetSessionId()\n\t{\n\t\treturn this.store.state.widget.dialog.sessionId;\n\t}\n\n\tgetUserHash()\n\t{\n\t\treturn this.store.state.widget.user.hash;\n\t}\n\n\tgetUserHashCookie()\n\t{\n\t\tlet userHash = '';\n\n\t\tlet cookie = Cookie.get(null, 'LIVECHAT_HASH');\n\t\tif (typeof cookie === 'string' && cookie.match(/^[a-f0-9]{32}$/))\n\t\t{\n\t\t\tuserHash= cookie;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tlet cookie = Cookie.get(this.getSiteId(), 'LIVECHAT_HASH');\n\t\t\tif (typeof cookie === 'string' && cookie.match(/^[a-f0-9]{32}$/))\n\t\t\t{\n\t\t\t\tuserHash = cookie;\n\t\t\t}\n\t\t}\n\n\t\treturn userHash;\n\t}\n\n\tgetUserId()\n\t{\n\t\treturn this.store.state.widget.user.id;\n\t}\n\n\tgetUserData()\n\t{\n\t\tif (!this.store)\n\t\t{\n\t\t\tconsole.error('LiveChatWidget.getUserData: method can be called after fired event - onBitrixLiveChat');\n\t\t\treturn false;\n\t\t}\n\n\t\treturn this.store.state.widget.user;\n\t}\n\n\tgetUserRegisterFields()\n\t{\n\t\treturn {\n\t\t\t'name': this.userRegisterData.name || '',\n\t\t\t'last_name': this.userRegisterData.lastName || '',\n\t\t\t'avatar': this.userRegisterData.avatar || '',\n\t\t\t'email': this.userRegisterData.email || '',\n\t\t\t'www': this.userRegisterData.www || '',\n\t\t\t'gender': this.userRegisterData.gender || '',\n\t\t\t'position': this.userRegisterData.position || '',\n\t\t\t'user_hash': this.userRegisterData.hash || '',\n\t\t\t'consent_url': this.store.state.widget.common.consentUrl? location.href: '',\n\t\t\t'trace_data': this.getCrmTraceData(),\n\t\t\t'custom_data': this.getCustomData()\n\t\t}\n\t}\n\n\tgetWidgetLocationCode()\n\t{\n\t\treturn LocationStyle[this.store.state.widget.common.location];\n\t}\n\n\tsetUserRegisterData(params)\n\t{\n\t\tif (!this.store)\n\t\t{\n\t\t\tconsole.error('LiveChatWidget.getUserData: method can be called after fired event - onBitrixLiveChat');\n\t\t\treturn false;\n\t\t}\n\n\t\tconst validUserFields = ['hash', 'name', 'lastName', 'avatar', 'email', 'www', 'gender', 'position'];\n\n\t\tif (!Utils.types.isPlainObject(params))\n\t\t{\n\t\t\tconsole.error(`%cLiveChatWidget.setUserData: params is not a object`, \"color: black;\");\n\t\t\treturn false;\n\t\t}\n\n\t\tfor (let field in this.userRegisterData)\n\t\t{\n\t\t\tif (!this.userRegisterData.hasOwnProperty(field))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (!params[field])\n\t\t\t{\n\t\t\t\tdelete this.userRegisterData[field];\n\t\t\t}\n\t\t}\n\n\t\tfor (let field in params)\n\t\t{\n\t\t\tif (!params.hasOwnProperty(field))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (validUserFields.indexOf(field) === -1)\n\t\t\t{\n\t\t\t\tconsole.warn(`%cLiveChatWidget.setUserData: user field is not set, because you are trying to set an unknown field (%c${field}%c)`, \"color: black;\", \"font-weight: bold; color: red\", \"color: black\");\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tthis.userRegisterData[field] = params[field];\n\t\t}\n\n\t\tif (\n\t\t\tthis.userRegisterData.hash\n\t\t\t&& this.getUserHash()\n\t\t\t&& this.userRegisterData.hash != this.getUserHash()\n\t\t)\n\t\t{\n\t\t\tthis.setNewAuthToken(this.userRegisterData.hash);\n\t\t}\n\t}\n\n\tsetNewAuthToken(authToken = '')\n\t{\n\t\tlet siteId = this.getSiteId();\n\t\tthis.storeCollector.clearModelState();\n\t\tCookie.set(null, 'LIVECHAT_HASH', '', {expires: 365*86400, path: '/'});\n\n\t\tthis.restClient.setAuthId(RestAuth.guest, authToken);\n\t}\n\n\tsetCustomData(params)\n\t{\n\t\tif (!this.store)\n\t\t{\n\t\t\tconsole.error('LiveChatWidget.getUserData: method can be called after fired event - onBitrixLiveChat');\n\t\t\treturn false;\n\t\t}\n\n\n\t\tlet result = [];\n\t\tif (params instanceof Array)\n\t\t{\n\t\t\tparams.forEach(element =>\n\t\t\t{\n\t\t\t\tif (element && typeof element === 'object')\n\t\t\t\t{\n\t\t\t\t\tresult.push(element);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (result.length <= 0)\n\t\t\t{\n\t\t\t\tconsole.error('LiveChatWidget.setCustomData: params is empty');\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (!params)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tresult = [{'MESSAGE': params}]\n\t\t}\n\n\t\tthis.customData = this.customData.concat(result);\n\n\t\treturn true;\n\t}\n\n\tsetError(code = '', description = '')\n\t{\n\t\tconsole.error(`LiveChatWidget.error: ${code} (${description})`);\n\n\t\tlet localizeDescription = '';\n\t\tif (code == 'LIVECHAT_AUTH_FAILED')\n\t\t{\n\t\t\tlocalizeDescription = this.getLocalize('BX_LIVECHAT_AUTH_FAILED').replace('#LINK_START#', '<a href=\"javascript:void();\" onclick=\"location.reload()\">').replace('#LINK_END#', '</a>');\n\t\t\tthis.setNewAuthToken();\n\t\t}\n\t\telse if (code == 'LIVECHAT_AUTH_PORTAL_USER')\n\t\t{\n\t\t\tlocalizeDescription = this.getLocalize('BX_LIVECHAT_PORTAL_USER_NEW').replace('#LINK_START#', '<a href=\"'+this.host+'\">').replace('#LINK_END#', '</a>')\n\t\t}\n\t\telse if (code.endsWith('LOCALIZED'))\n\t\t{\n\t\t\tlocalizeDescription = description;\n\t\t}\n\n\t\tthis.store.commit('application/set', {error: {\n\t\t\tactive: true,\n\t\t\tcode,\n\t\t\tdescription: localizeDescription\n\t\t}});\n\t}\n\n\tclearError()\n\t{\n\t\tthis.store.commit('application/set', {error: {\n\t\t\tactive: false,\n\t\t\tcode: '',\n\t\t\tdescription: ''}\n\t\t});\n\t}\n\n\t/**\n\t *\n\t * @param params {Object}\n\t * @returns {Function|Boolean} - Unsubscribe callback function or False\n\t */\n\tsubscribe(params)\n\t{\n\t\tif (!Utils.types.isPlainObject(params))\n\t\t{\n\t\t\tconsole.error(`%cLiveChatWidget.subscribe: params is not a object`, \"color: black;\");\n\t\t\treturn false;\n\t\t}\n\n\t\tif (!SubscriptionTypeCheck.includes(params.type))\n\t\t{\n\t\t\tconsole.error(`%cLiveChatWidget.subscribe: subscription type is not correct (%c${params.type}%c)`, \"color: black;\", \"font-weight: bold; color: red\", \"color: black\");\n\t\t\treturn false;\n\t\t}\n\n\t\tif (typeof params.callback !== 'function')\n\t\t{\n\t\t\tconsole.error(`%cLiveChatWidget.subscribe: callback is not a function (%c${typeof params.callback}%c)`, \"color: black;\", \"font-weight: bold; color: red\", \"color: black\");\n\t\t\treturn false;\n\t\t}\n\n\t\tif (typeof (this.subscribers[params.type]) === 'undefined')\n\t\t{\n\t\t\tthis.subscribers[params.type] = [];\n\t\t}\n\n\t\tthis.subscribers[params.type].push(params.callback);\n\n\t\treturn function () {\n\t\t\tthis.subscribers[params.type] = this.subscribers[params.type].filter(function(element) {\n\t\t\t\treturn element !== params.callback;\n\t\t\t});\n\t\t}.bind(this);\n\t}\n\n\t/**\n\t *\n\t * @param params {Object}\n\t * @returns {boolean}\n\t */\n\tsendEvent(params)\n\t{\n\t\tparams = params || {};\n\n\t\tif (!params.type)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tif (typeof params.data !== 'object' || !params.data)\n\t\t{\n\t\t\tparams.data = {};\n\t\t}\n\n\t\tif (this.subscribers[params.type] instanceof Array && this.subscribers[params.type].length > 0)\n\t\t{\n\t\t\tthis.subscribers[params.type].forEach(callback => callback(params.data));\n\t\t}\n\n\t\tif (this.subscribers[SubscriptionType.every] instanceof Array && this.subscribers[SubscriptionType.every].length > 0)\n\t\t{\n\t\t\tthis.subscribers[SubscriptionType.every].forEach(callback => callback({type: params.type, data: params.data}));\n\t\t}\n\n\t\treturn true;\n\t}\n\n\taddLocalize(phrases)\n\t{\n\t\tif (typeof phrases !== \"object\" || !phrases)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tfor (let name in phrases)\n\t\t{\n\t\t\tif (phrases.hasOwnProperty(name))\n\t\t\t{\n\t\t\t\tthis.localize[name] = phrases[name];\n\t\t\t}\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tgetLocalize(name)\n\t{\n\t\tlet phrase = '';\n\t\tif (typeof name === 'undefined')\n\t\t{\n\t\t\treturn this.localize;\n\t\t}\n\t\telse if (typeof this.localize[name.toString()] === 'undefined')\n\t\t{\n\t\t\tconsole.warn(`LiveChatWidget.getLocalize: message with code '${name.toString()}' is undefined.`)\n\t\t}\n\t\telse\n\t\t{\n\t\t\tphrase = this.localize[name];\n\t\t}\n\n\t\treturn phrase;\n\t}\n\n/* endregion 05. Widget interaction and utils */\n}","/**\n * Bitrix OpenLines widget\n * Widget public interface\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {Widget} from \"./widget\"\n\nexport class WidgetPublicManager\n{\n\tconstructor(config)\n\t{\n\t\tthis.developerInfo = 'Do not use private methods.';\n\t\tthis.__privateMethods__ = new Widget(config);\n\t\tthis.__createLegacyMethods();\n\t}\n\n\topen(params)\n\t{\n\t\treturn this.__privateMethods__.open(params);\n\t}\n\n\tclose()\n\t{\n\t\treturn this.__privateMethods__.close();\n\t}\n\n\tshowNotification(params)\n\t{\n\t\treturn this.__privateMethods__.showNotification(params);\n\t}\n\n\tgetUserData()\n\t{\n\t\treturn this.__privateMethods__.getUserData();\n\t}\n\n\tsetUserRegisterData(params)\n\t{\n\t\treturn this.__privateMethods__.setUserRegisterData(params);\n\t}\n\n\tsetCustomData(params)\n\t{\n\t\treturn this.__privateMethods__.setCustomData(params);\n\t}\n\n\tmutateTemplateComponent(id, params)\n\t{\n\t\treturn this.__privateMethods__.mutateTemplateComponent(id, params);\n\t}\n\n\taddLocalize(phrases)\n\t{\n\t\treturn this.__privateMethods__.addLocalize(phrases);\n\t}\n\n\t/**\n\t *\n\t * @param params {Object}\n\t * @returns {Function|Boolean} - Unsubscribe callback function or False\n\t */\n\tsubscribe(params)\n\t{\n\t\treturn this.__privateMethods__.subscribe(params);\n\t}\n\n\tstart()\n\t{\n\t\treturn this.__privateMethods__.start();\n\t}\n\n\t__createLegacyMethods()\n\t{\n\t\tif (typeof window.BX.LiveChat === 'undefined')\n\t\t{\n\t\t\tlet sourceHref = document.createElement('a');\n\t\t\tsourceHref.href = this.__privateMethods__.host;\n\n\t\t\tlet sourceDomain = sourceHref.protocol+'//'+sourceHref.hostname+(sourceHref.port && sourceHref.port != '80' && sourceHref.port != '443'? \":\"+sourceHref.port: \"\");\n\n\t\t\twindow.BX.LiveChat = {\n\t\t\t\topenLiveChat: () => {\n\t\t\t\t\tthis.open({openFromButton: true});\n\t\t\t\t},\n\t\t\t\tcloseLiveChat: () => {\n\t\t\t\t\tthis.close();\n\t\t\t\t},\n\t\t\t\taddEventListener: (el, eventName, handler) =>\n\t\t\t\t{\n\t\t\t\t\tif (eventName === 'message')\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.subscribe({\n\t\t\t\t\t\t\ttype: SubscriptionType.userMessage,\n\t\t\t\t\t\t\tcallback: function (event)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\thandler({origin: sourceDomain, data: JSON.stringify({action: 'sendMessage'}), event});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tconsole.warn('Method BX.LiveChat.addEventListener is not supported, user new format for subscribe.')\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tsetCookie: () => {},\n\t\t\t\tgetCookie: () => {},\n\t\t\t\tsourceDomain\n\t\t\t};\n\t\t}\n\n\t\tif (typeof window.BxLiveChatInit === 'function')\n\t\t{\n\t\t\tlet config = window.BxLiveChatInit();\n\n\t\t\tif (config.user)\n\t\t\t{\n\t\t\t\tthis.__privateMethods__.setUserRegisterData(config.user);\n\t\t\t}\n\t\t\tif (config.firstMessage)\n\t\t\t{\n\t\t\t\tthis.__privateMethods__.setCustomData(config.firstMessage)\n\t\t\t}\n\t\t}\n\n\t\tif (window.BxLiveChatLoader instanceof Array)\n\t\t{\n\t\t\twindow.BxLiveChatLoader.forEach(callback => callback());\n\t\t}\n\n\t\treturn true;\n\t}\n}","/**\n * Bitrix OpenLines widget\n * LiveChat base component (Vue component)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {Vue} from \"ui.vue\";\nimport {Vuex} from \"ui.vue.vuex\";\nimport {Utils} from \"im.utils\";\nimport {Logger} from \"im.tools.logger\";\nimport {FormType, VoteType, LocationStyle, LanguageType} from \"../const\";\nimport {DeviceType, DeviceOrientation} from \"im.const\";\n\n/**\n * @notice Do not mutate or clone this component! It is under development.\n */\n\nVue.component('bx-livechat',\n{\n\tdata()\n\t{\n\t\treturn {\n\t\t\tviewPortMetaSiteNode: null,\n\t\t\tviewPortMetaWidgetNode: null,\n\t\t\tstoredMessage: '',\n\t\t\tstoredFile: null,\n\t\t\ttextareaFocused: false,\n\t\t\ttextareaDrag: false,\n\t\t\ttextareaHeight: 100,\n\t\t\ttextareaMinimumHeight: 100,\n\t\t\ttextareaMaximumHeight: Utils.device.isMobile()? 200: 300,\n\t\t}\n\t},\n\tcreated()\n\t{\n\t\tthis.onCreated();\n\n\t\tdocument.addEventListener('keydown', this.onWindowKeyDown);\n\t\tthis.$root.$on('requestShowForm', this.onRequestShowForm);\n\t},\n\tbeforeDestroy()\n\t{\n\t\tdocument.removeEventListener('keydown', this.onWindowKeyDown);\n\t\tthis.$root.$off('requestShowForm', this.onRequestShowForm);\n\n\t\tthis.onTextareaDragEventRemove();\n\t},\n\tcomputed:\n\t{\n\t\tFormType: () => FormType,\n\t\tVoteType: () => VoteType,\n\t\tDeviceType: () => DeviceType,\n\t\ttextareaHeightStyle(state)\n\t\t{\n\t\t\treturn 'flex: 0 0 '+this.textareaHeight+'px;'\n\t\t},\n\t\tlocalize()\n\t\t{\n\t\t\treturn Vue.getFilteredPhrases('BX_LIVECHAT_', this.$root.$bitrixMessages);\n\t\t},\n\t\twidgetMobileDisabled(state)\n\t\t{\n\t\t\tif (state.application.device.type == DeviceType.mobile)\n\t\t\t{\n\t\t\t\tif (navigator.userAgent.toString().includes('iPad'))\n\t\t\t\t{\n\t\t\t\t}\n\t\t\t\telse if (state.application.device.orientation == DeviceOrientation.horizontal)\n\t\t\t\t{\n\t\t\t\t\tif (navigator.userAgent.toString().includes('iPhone'))\n\t\t\t\t\t{\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\treturn !(typeof window.screen === 'object' && window.screen.availHeight >= 800);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn false;\n\t\t},\n\t\twidgetClassName(state)\n\t\t{\n\t\t\tlet className = ['bx-livechat-wrapper'];\n\n\t\t\tclassName.push('bx-livechat-show');\n\n\t\t\tif (state.widget.common.pageMode)\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-page-mode');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-position-'+LocationStyle[state.widget.common.location]);\n\t\t\t}\n\n\t\t\tif (state.application.common.languageId == LanguageType.russian)\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-logo-ru');\n\t\t\t}\n\t\t\telse if (state.application.common.languageId == LanguageType.ukraine)\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-logo-ua');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-logo-en');\n\t\t\t}\n\n\t\t\tif (!state.widget.common.online)\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-offline-state');\n\t\t\t}\n\n\t\t\tif (state.widget.common.dragged)\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-drag-n-drop');\n\t\t\t}\n\n\t\t\tif (state.widget.common.dialogStart)\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-chat-start');\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\tstate.widget.dialog.operator.name\n\t\t\t\t&& !(state.application.device.type == DeviceType.mobile && state.application.device.orientation == DeviceOrientation.horizontal)\n\t\t\t)\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-has-operator');\n\t\t\t}\n\n\t\t\tif (Utils.device.isMobile())\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-mobile');\n\t\t\t}\n\t\t\telse if (Utils.browser.isSafari())\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-browser-safari');\n\t\t\t}\n\t\t\telse if (Utils.browser.isIe())\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-browser-ie');\n\t\t\t}\n\n\t\t\tif (Utils.platform.isMac())\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-mac');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-custom-scroll');\n\t\t\t}\n\n\t\t\tif (state.widget.common.styles.backgroundColor && Utils.isDarkColor(state.widget.common.styles.iconColor))\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-bright-header');\n\t\t\t}\n\n\t\t\treturn className.join(' ');\n\t\t},\n\t\tshowMessageDialog()\n\t\t{\n\t\t\treturn this.messageCollection.length > 0;\n\t\t},\n\t\t...Vuex.mapState({\n\t\t\twidget: state => state.widget,\n\t\t\tapplication: state => state.application,\n\t\t\tmessageCollection: state => state.messages.collection[state.application.dialog.chatId]\n\t\t})\n\t},\n\twatch:\n\t{\n\t\tsessionClose(value)\n\t\t{\n\t\t\tLogger.log('sessionClose change', value);\n\t\t}\n\t},\n\tmethods:\n\t{\n\t\tclose(event)\n\t\t{\n\t\t\tif (this.widget.common.pageMode)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tthis.onBeforeClose();\n\t\t\tthis.$store.commit('widget/common', {showed: false});\n\t\t},\n\t\tshowLikeForm()\n\t\t{\n\t\t\tif (this.offline)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tclearTimeout(this.showFormTimeout);\n\t\t\tif (!this.widget.common.vote.enable)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tif (\n\t\t\t\tthis.widget.dialog.sessionClose\n\t\t\t\t&& this.widget.dialog.userVote != VoteType.none\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tthis.$store.commit('widget/common', {showForm: FormType.like});\n\t\t},\n\t\tshowWelcomeForm()\n\t\t{\n\t\t\tclearTimeout(this.showFormTimeout);\n\t\t\tthis.$store.commit('widget/common', {showForm: FormType.welcome});\n\t\t},\n\t\tshowOfflineForm()\n\t\t{\n\t\t\tclearTimeout(this.showFormTimeout);\n\n\t\t\tif (this.widget.dialog.showForm !== FormType.welcome)\n\t\t\t{\n\t\t\t\tthis.$store.commit('widget/common', {showForm: FormType.offline});\n\t\t\t}\n\t\t},\n\t\tshowHistoryForm()\n\t\t{\n\t\t\tclearTimeout(this.showFormTimeout);\n\t\t\tthis.$store.commit('widget/common', {showForm: FormType.history});\n\t\t},\n\t\thideForm()\n\t\t{\n\t\t\tclearTimeout(this.showFormTimeout);\n\t\t\tthis.$store.commit('widget/common', {showForm: FormType.none});\n\t\t},\n\t\tshowConsentWidow()\n\t\t{\n\t\t\tthis.$store.commit('widget/common', {showConsent: true});\n\t\t},\n\t\tagreeConsentWidow()\n\t\t{\n\t\t\tthis.$store.commit('widget/common', {showConsent: false});\n\n\t\t\tthis.$root.$bitrixWidget.sendConsentDecision(true);\n\n\t\t\tif (this.storedMessage || this.storedFile)\n\t\t\t{\n\t\t\t\tif (this.storedMessage)\n\t\t\t\t{\n\t\t\t\t\tthis.onTextareaSend({focus: this.application.device.type != DeviceType.mobile});\n\t\t\t\t\tthis.storedMessage = '';\n\t\t\t\t}\n\t\t\t\tif (this.storedFile)\n\t\t\t\t{\n\t\t\t\t\tthis.onTextareaFileSelected();\n\t\t\t\t\tthis.storedFile = '';\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (this.widget.common.showForm == FormType.none)\n\t\t\t{\n\t\t\t\tthis.$root.$emit('onMessengerTextareaFocus');\n\t\t\t}\n\t\t},\n\t\tdisagreeConsentWidow()\n\t\t{\n\t\t\tthis.$store.commit('widget/common', {showForm : FormType.none});\n\t\t\tthis.$store.commit('widget/common', {showConsent : false});\n\n\t\t\tthis.$root.$bitrixWidget.sendConsentDecision(false);\n\n\t\t\tif (this.storedMessage)\n\t\t\t{\n\t\t\t\tthis.$root.$emit('onMessengerTextareaInsertText', {\n\t\t\t\t\ttext: this.storedMessage,\n\t\t\t\t\tfocus: this.application.device.type != DeviceType.mobile\n\t\t\t\t});\n\t\t\t\tthis.storedMessage = '';\n\t\t\t}\n\t\t\tif (this.storedFile)\n\t\t\t{\n\t\t\t\tthis.storedFile = '';\n\t\t\t}\n\n\t\t\tif (this.application.device.type != DeviceType.mobile)\n\t\t\t{\n\t\t\t\tthis.$root.$emit('onMessengerTextareaFocus');\n\t\t\t}\n\t\t},\n\t\tlogEvent(name, ...params)\n\t\t{\n\t\t\tLogger.info(name, ...params);\n\t\t},\n\t\tonCreated()\n\t\t{\n\t\t\tif(Utils.device.isMobile())\n\t\t\t{\n\t\t\t\tlet viewPortMetaSiteNode = Array.from(\n\t\t\t\t\tdocument.head.getElementsByTagName('meta')\n\t\t\t\t).filter(element => element.name == 'viewport')[0];\n\n\t\t\t\tif (viewPortMetaSiteNode)\n\t\t\t\t{\n\t\t\t\t\tthis.viewPortMetaSiteNode = viewPortMetaSiteNode;\n\t\t\t\t\tdocument.head.removeChild(this.viewPortMetaSiteNode);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tlet contentWidth = document.body.offsetWidth;\n\t\t\t\t\tif (contentWidth < window.innerWidth)\n\t\t\t\t\t{\n\t\t\t\t\t\tcontentWidth = window.innerWidth;\n\t\t\t\t\t}\n\t\t\t\t\tif (contentWidth < 1024)\n\t\t\t\t\t{\n\t\t\t\t\t\tcontentWidth = 1024;\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.viewPortMetaSiteNode = document.createElement('meta');\n\t\t\t\t\tthis.viewPortMetaSiteNode.setAttribute('name', 'viewport');\n\t\t\t\t\tthis.viewPortMetaSiteNode.setAttribute('content', `width=${contentWidth}, initial-scale=1.0, user-scalable=1`);\n\t\t\t\t}\n\n\t\t\t\tif (!this.viewPortMetaWidgetNode)\n\t\t\t\t{\n\t\t\t\t\tthis.viewPortMetaWidgetNode = document.createElement('meta');\n\t\t\t\t\tthis.viewPortMetaWidgetNode.setAttribute('name', 'viewport');\n\t\t\t\t\tthis.viewPortMetaWidgetNode.setAttribute('content', 'width=device-width, initial-scale=1.0, user-scalable=0');\n\t\t\t\t\tdocument.head.appendChild(this.viewPortMetaWidgetNode);\n\t\t\t\t}\n\n\t\t\t\tdocument.body.classList.add('bx-livechat-mobile-state');\n\n\t\t\t\tif (Utils.browser.isSafariBased())\n\t\t\t\t{\n\t\t\t\t\tdocument.body.classList.add('bx-livechat-mobile-safari-based');\n\t\t\t\t}\n\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tthis.$store.commit('widget/common', {showed: true});\n\t\t\t\t}, 50);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.$store.commit('widget/common', {showed: true});\n\t\t\t}\n\n\t\t\tthis.textareaHeight = this.widget.common.textareaHeight || this.textareaHeight;\n\n\t\t\tthis.$store.commit('files/initCollection', {chatId: this.$root.$bitrixWidget.getChatId()});\n\t\t\tthis.$store.commit('messages/initCollection', {chatId: this.$root.$bitrixWidget.getChatId()});\n\t\t\tthis.$store.commit('dialogues/initCollection', {dialogId: this.$root.$bitrixWidget.getDialogId(), fields: {\n\t\t\t\tentityType: 'LIVECHAT',\n\t\t\t\ttype: 'livechat'\n\t\t\t}});\n\t\t},\n\t\tonBeforeClose()\n\t\t{\n\t\t\tif(Utils.device.isMobile())\n\t\t\t{\n\t\t\t\tdocument.body.classList.remove('bx-livechat-mobile-state');\n\n\t\t\t\tif (Utils.browser.isSafariBased())\n\t\t\t\t{\n\t\t\t\t\tdocument.body.classList.remove('bx-livechat-mobile-safari-based');\n\t\t\t\t}\n\n\t\t\t\tif (this.viewPortMetaWidgetNode)\n\t\t\t\t{\n\t\t\t\t\tdocument.head.removeChild(this.viewPortMetaWidgetNode);\n\t\t\t\t\tthis.viewPortMetaWidgetNode = null;\n\t\t\t\t}\n\n\t\t\t\tif (this.viewPortMetaSiteNode)\n\t\t\t\t{\n\t\t\t\t\tdocument.head.appendChild(this.viewPortMetaSiteNode);\n\t\t\t\t\tthis.viewPortMetaSiteNode = null;\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tonAfterClose()\n\t\t{\n\t\t\tthis.$root.$bitrixWidget.close();\n\t\t},\n\t\tonRequestShowForm(event)\n\t\t{\n\t\t\tclearTimeout(this.showFormTimeout);\n\t\t\tif (event.type == FormType.welcome)\n\t\t\t{\n\t\t\t\tif (event.delayed)\n\t\t\t\t{\n\t\t\t\t\tthis.showFormTimeout = setTimeout(() => {\n\t\t\t\t\t\tthis.showWelcomeForm();\n\t\t\t\t\t}, 5000);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.showWelcomeForm();\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (event.type == FormType.offline)\n\t\t\t{\n\t\t\t\tif (event.delayed)\n\t\t\t\t{\n\t\t\t\t\tthis.showFormTimeout = setTimeout(() => {\n\t\t\t\t\t\tthis.showOfflineForm();\n\t\t\t\t\t}, 3000);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.showOfflineForm();\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (event.type == FormType.like)\n\t\t\t{\n\t\t\t\tif (event.delayed)\n\t\t\t\t{\n\t\t\t\t\tthis.showFormTimeout = setTimeout(() => {\n\t\t\t\t\t\tthis.showLikeForm();\n\t\t\t\t\t}, 5000);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.showLikeForm();\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tonDialogRequestHistory(event)\n\t\t{\n\t\t\tthis.$root.$bitrixWidget.getDialogHistory(event.lastId);\n\t\t},\n\t\tonDialogRequestUnread(event)\n\t\t{\n\t\t\tthis.$root.$bitrixWidget.getDialogUnread(event.lastId);\n\t\t},\n\t\tonDialogMessageClickByUserName(event)\n\t\t{\n\t\t\t// TODO name push to auto-replace mention holder - User Name -> [USER=274]User Name[/USER]\n\t\t\tthis.$root.$emit('onMessengerTextareaInsertText', {text: event.user.name+' '});\n\t\t},\n\t\tonDialogMessageClickByCommand(event)\n\t\t{\n\t\t\tif (event.type === 'put')\n\t\t\t{\n\t\t\t\tthis.$root.$emit('onMessengerTextareaInsertText', {text: event.value+' '});\n\t\t\t}\n\t\t\telse if (event.type === 'send')\n\t\t\t{\n\t\t\t\tthis.$root.$bitrixWidget.addMessage(event.value);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tLogger.warn('Unprocessed command', event);\n\t\t\t}\n\t\t},\n\t\tonDialogMessageMenuClick(event)\n\t\t{\n\t\t\tLogger.warn('Message menu:', event);\n\t\t},\n\t\tonDialogMessageRetryClick(event)\n\t\t{\n\t\t\tLogger.warn('Message retry:', event);\n\t\t\tthis.$root.$bitrixWidget.retrySendMessage(event.message);\n\t\t},\n\t\tonDialogReadMessage(event)\n\t\t{\n\t\t\tthis.$root.$bitrixWidget.readMessage(event.id);\n\t\t},\n\t\tonDialogClick(event)\n\t\t{\n\t\t\tthis.$store.commit('widget/common', {showForm: FormType.none});\n\t\t},\n\t\tonTextareaSend(event)\n\t\t{\n\t\t\tevent.focus = event.focus !== false;\n\n\t\t\tif (this.widget.common.showForm == FormType.smile)\n\t\t\t{\n\t\t\t\tthis.$store.commit('widget/common', {showForm: FormType.none});\n\t\t\t}\n\n\t\t\tif (!this.widget.dialog.userConsent && this.widget.common.consentUrl)\n\t\t\t{\n\t\t\t\tif (event.text)\n\t\t\t\t{\n\t\t\t\t\tthis.storedMessage = event.text;\n\t\t\t\t}\n\t\t\t\tthis.showConsentWidow();\n\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tevent.text = event.text? event.text: this.storedMessage;\n\t\t\tif (!event.text)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tthis.hideForm();\n\t\t\tthis.$root.$bitrixWidget.addMessage(event.text);\n\n\t\t\tif (event.focus)\n\t\t\t{\n\t\t\t\tthis.$root.$emit('onMessengerTextareaFocus');\n\t\t\t}\n\n\t\t\treturn true;\n\t\t},\n\t\tonTextareaWrites(event)\n\t\t{\n\t\t\tthis.$root.$bitrixController.startWriting();\n\t\t},\n\t\tonTextareaFocus(event)\n\t\t{\n\t\t\tif (\n\t\t\t\tthis.widget.common.copyright &&\n\t\t\t\tthis.application.device.type == DeviceType.mobile\n\t\t\t)\n\t\t\t{\n\t\t\t\tthis.widget.common.copyright = false;\n\t\t\t}\n\t\t\tif (Utils.device.isMobile())\n\t\t\t{\n\t\t\t\tclearTimeout(this.onTextareaFocusScrollTimeout);\n\t\t\t\tthis.onTextareaFocusScrollTimeout = setTimeout(() => {\n\t\t\t\t\tdocument.addEventListener('scroll', this.onWindowScroll);\n\t\t\t\t}, 1000);\n\t\t\t}\n\t\t\tthis.textareaFocused = true;\n\t\t},\n\t\tonTextareaBlur(event)\n\t\t{\n\t\t\tif (!this.widget.common.copyright && this.widget.common.copyright !== this.$root.$bitrixWidget.copyright)\n\t\t\t{\n\t\t\t\tthis.widget.common.copyright = this.$root.$bitrixWidget.copyright;\n\t\t\t\tthis.$nextTick(() => {\n\t\t\t\t\tthis.$root.$emit('onMessengerDialogScrollToBottom', {force: true});\n\t\t\t\t});\n\t\t\t}\n\t\t\tif (Utils.device.isMobile())\n\t\t\t{\n\t\t\t\tclearTimeout(this.onTextareaFocusScrollTimeout);\n\t\t\t\tdocument.removeEventListener('scroll', this.onWindowScroll);\n\t\t\t}\n\n\t\t\tthis.textareaFocused = false;\n\t\t},\n\t\tonTextareaStartDrag(event)\n\t\t{\n\t\t\tif (this.textareaDrag)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tLogger.log('Livechat: textarea drag started');\n\n\t\t\tthis.textareaDrag = true;\n\n\t\t\tevent = event.changedTouches ? event.changedTouches[0] : event;\n\n\t\t\tthis.textareaDragCursorStartPoint = event.clientY;\n\t\t\tthis.textareaDragHeightStartPoint = this.textareaHeight;\n\n\t\t\tthis.onTextareaDragEventAdd();\n\n\t\t\tthis.$root.$emit('onMessengerTextareaBlur', true);\n\t\t},\n\t\tonTextareaContinueDrag(event)\n\t\t{\n\t\t\tif (!this.textareaDrag)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tevent = event.changedTouches ? event.changedTouches[0] : event;\n\n\t\t\tthis.textareaDragCursorControlPoint = event.clientY;\n\n\t\t\tlet textareaHeight = Math.max(\n\t\t\t\tMath.min(this.textareaDragHeightStartPoint + this.textareaDragCursorStartPoint - this.textareaDragCursorControlPoint, this.textareaMaximumHeight)\n\t\t\t, this.textareaMinimumHeight);\n\n\t\t\tLogger.log('Livechat: textarea drag', 'new: '+textareaHeight, 'curr: '+this.textareaHeight);\n\n\t\t\tif (this.textareaHeight != textareaHeight)\n\t\t\t{\n\t\t\t\tthis.textareaHeight = textareaHeight;\n\t\t\t}\n\t\t},\n\t\tonTextareaStopDrag()\n\t\t{\n\t\t\tif (!this.textareaDrag)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tLogger.log('Livechat: textarea drag ended');\n\n\t\t\tthis.textareaDrag = false;\n\n\t\t\tthis.onTextareaDragEventRemove();\n\n\t\t\tthis.$store.commit('widget/common', {textareaHeight: this.textareaHeight});\n\t\t\tthis.$root.$emit('onMessengerDialogScrollToBottom', {force: true});\n\t\t},\n\t\tonTextareaDragEventAdd()\n\t\t{\n\t\t\tdocument.addEventListener('mousemove', this.onTextareaContinueDrag);\n\t\t\tdocument.addEventListener('touchmove', this.onTextareaContinueDrag);\n\t\t\tdocument.addEventListener('touchend', this.onTextareaStopDrag);\n\t\t\tdocument.addEventListener('mouseup', this.onTextareaStopDrag);\n\t\t\tdocument.addEventListener('mouseleave', this.onTextareaStopDrag);\n\t\t},\n\t\tonTextareaDragEventRemove()\n\t\t{\n\t\t\tdocument.removeEventListener('mousemove', this.onTextareaContinueDrag);\n\t\t\tdocument.removeEventListener('touchmove', this.onTextareaContinueDrag);\n\t\t\tdocument.removeEventListener('touchend', this.onTextareaStopDrag);\n\t\t\tdocument.removeEventListener('mouseup', this.onTextareaStopDrag);\n\t\t\tdocument.removeEventListener('mouseleave', this.onTextareaStopDrag);\n\t\t},\n\t\tonTextareaFileSelected(event)\n\t\t{\n\t\t\tlet fileInput = event && event.fileInput? event.fileInput: this.storedFile;\n\t\t\tif (!fileInput)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (fileInput.files[0].size > this.application.disk.maxFileSize)\n\t\t\t{\n\t\t\t\t// TODO change alert to correct overlay window\n\t\t\t\talert(this.localize.BX_LIVECHAT_FILE_SIZE_EXCEEDED.replace('#LIMIT#', Math.round(this.application.disk.maxFileSize/1024/1024)));\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (!this.widget.dialog.userConsent && this.widget.common.consentUrl)\n\t\t\t{\n\t\t\t\tthis.storedFile = event.fileInput;\n\t\t\t\tthis.showConsentWidow();\n\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tthis.$root.$bitrixWidget.addFile(fileInput);\n\t\t},\n\t\tonTextareaAppButtonClick(event)\n\t\t{\n\t\t\tif (event.appId == FormType.smile)\n\t\t\t{\n\t\t\t\tif (this.widget.common.showForm == FormType.smile)\n\t\t\t\t{\n\t\t\t\t\tthis.$store.commit('widget/common', {showForm: FormType.none});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.$store.commit('widget/common', {showForm: FormType.smile});\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.$root.$emit('onMessengerTextareaFocus');\n\t\t\t}\n\t\t},\n\t\tonPullRequestConfig(event)\n\t\t{\n\t\t\tthis.$root.$bitrixWidget.recoverPullConnection();\n\t\t},\n\t\tonSmilesSelectSmile(event)\n\t\t{\n\t\t\tthis.$root.$emit('onMessengerTextareaInsertText', {text: event.text});\n\t\t},\n\t\tonSmilesSelectSet()\n\t\t{\n\t\t\tthis.$root.$emit('onMessengerTextareaFocus');\n\t\t},\n\t\tonWindowKeyDown(event)\n\t\t{\n\t\t\tif (event.keyCode == 27)\n\t\t\t{\n\t\t\t\tif (this.widget.common.showForm != FormType.none)\n\t\t\t\t{\n\t\t\t\t\tthis.$store.commit('widget/common', {showForm: FormType.none});\n\t\t\t\t}\n\t\t\t\telse if (this.widget.common.showConsent)\n\t\t\t\t{\n\t\t\t\t\tthis.disagreeConsentWidow();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.close();\n\t\t\t\t}\n\n\t\t\t\tevent.preventDefault();\n\t\t\t\tevent.stopPropagation();\n\n\t\t\t\tthis.$root.$emit('onMessengerTextareaFocus');\n\t\t\t}\n\t\t},\n\t\tonWindowScroll(event)\n\t\t{\n\t\t\tclearTimeout(this.onWindowScrollTimeout);\n\t\t\tthis.onWindowScrollTimeout = setTimeout(() => {\n\t\t\t\tthis.$root.$emit('onMessengerTextareaBlur', true);\n\t\t\t}, 50);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<transition enter-active-class=\"bx-livechat-show\" leave-active-class=\"bx-livechat-close\" @after-leave=\"onAfterClose\">\n\t\t\t<div :class=\"widgetClassName\" v-if=\"widget.common.showed\">\n\t\t\t\t<div class=\"bx-livechat-box\">\n\t\t\t\t\t<bx-livechat-head :isWidgetDisabled=\"widgetMobileDisabled\" @like=\"showLikeForm\" @history=\"showHistoryForm\" @close=\"close\"/>\n\t\t\t\t\t<template v-if=\"widgetMobileDisabled\">\n\t\t\t\t\t\t<bx-livechat-body-orientation-disabled/>\n\t\t\t\t\t</template>\n\t\t\t\t\t<template v-else-if=\"application.error.active\">\n\t\t\t\t\t\t<bx-livechat-body-error/>\n\t\t\t\t\t</template>\n\t\t\t\t\t<template v-else-if=\"!widget.common.configId\">\n\t\t\t\t\t\t<div class=\"bx-livechat-body\" key=\"loading-body\">\n\t\t\t\t\t\t\t<bx-livechat-body-loading/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</template>\t\t\t\n\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t<template v-if=\"!widget.common.dialogStart\">\n\t\t\t\t\t\t\t<div class=\"bx-livechat-body\" key=\"welcome-body\">\n\t\t\t\t\t\t\t\t<bx-livechat-body-operators/>\n\t\t\t\t\t\t\t\t<keep-alive include=\"bx-livechat-smiles\">\n\t\t\t\t\t\t\t\t\t<template v-if=\"widget.common.showForm == FormType.smile\">\n\t\t\t\t\t\t\t\t\t\t<bx-livechat-smiles @selectSmile=\"onSmilesSelectSmile\" @selectSet=\"onSmilesSelectSet\"/>\t\n\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t</keep-alive>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t\t<template v-else-if=\"widget.common.dialogStart\">\n\t\t\t\t\t\t\t<bx-pull-status :canReconnect=\"true\" @reconnect=\"onPullRequestConfig\"/>\n\t\t\t\t\t\t\t<div :class=\"['bx-livechat-body', {'bx-livechat-body-with-message': showMessageDialog}]\" key=\"with-message\">\n\t\t\t\t\t\t\t\t<transition name=\"bx-livechat-animation-upload-file\">\n\t\t\t\t\t\t\t\t\t<template v-if=\"widget.common.uploadFile\">\n\t\t\t\t\t\t\t\t\t\t<div class=\"bx-livechat-file-upload\">\t\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"bx-livechat-file-upload-sending\"></div>\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"bx-livechat-file-upload-text\">{{localize.BX_LIVECHAT_FILE_UPLOAD}}</div>\n\t\t\t\t\t\t\t\t\t\t</div>\t\n\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t</transition>\t\n\t\t\t\t\t\t\t\t<template v-if=\"showMessageDialog\">\n\t\t\t\t\t\t\t\t\t<div class=\"bx-livechat-dialog\">\n\t\t\t\t\t\t\t\t\t\t<bx-messenger-dialog\n\t\t\t\t\t\t\t\t\t\t\t:userId=\"application.common.userId\" \n\t\t\t\t\t\t\t\t\t\t\t:dialogId=\"application.dialog.dialogId\"\n\t\t\t\t\t\t\t\t\t\t\t:chatId=\"application.dialog.chatId\"\n\t\t\t\t\t\t\t\t\t\t\t:messageLimit=\"application.dialog.messageLimit\"\n\t\t\t\t\t\t\t\t\t\t\t:enableEmotions=\"false\"\n\t\t\t\t\t\t\t\t\t\t\t:enableDateActions=\"false\"\n\t\t\t\t\t\t\t\t\t\t\t:enableCreateContent=\"false\"\n\t\t\t\t\t\t\t\t\t\t\t:showMessageAvatar=\"false\"\n\t\t\t\t\t\t\t\t\t\t\t:showMessageMenu=\"false\"\n\t\t\t\t\t\t\t\t\t\t\tlistenEventScrollToBottom=\"onMessengerDialogScrollToBottom\"\n\t\t\t\t\t\t\t\t\t\t\tlistenEventRequestHistory=\"onDialogRequestHistoryResult\"\n\t\t\t\t\t\t\t\t\t\t\tlistenEventRequestUnread=\"onDialogRequestUnreadResult\"\n\t\t\t\t\t\t\t\t\t\t\t@readMessage=\"onDialogReadMessage\"\n\t\t\t\t\t\t\t\t\t\t\t@requestHistory=\"onDialogRequestHistory\"\n\t\t\t\t\t\t\t\t\t\t\t@requestUnread=\"onDialogRequestUnread\"\n\t\t\t\t\t\t\t\t\t\t\t@clickByCommand=\"onDialogMessageClickByCommand\"\n\t\t\t\t\t\t\t\t\t\t\t@clickByUserName=\"onDialogMessageClickByUserName\"\n\t\t\t\t\t\t\t\t\t\t\t@clickByMessageMenu=\"onDialogMessageMenuClick\"\n\t\t\t\t\t\t\t\t\t\t\t@clickByMessageRetry=\"onDialogMessageRetryClick\"\n\t\t\t\t\t\t\t\t\t\t\t@click=\"onDialogClick\"\n\t\t\t\t\t\t\t\t\t\t />\n\t\t\t\t\t\t\t\t\t</div>\t \n\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t\t\t\t<bx-livechat-body-loading/>\n\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t<keep-alive include=\"bx-livechat-smiles\">\n\t\t\t\t\t\t\t\t\t<template v-if=\"widget.common.showForm == FormType.like && widget.common.vote.enable\">\n\t\t\t\t\t\t\t\t\t\t<bx-livechat-form-vote/>\n\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t\t<template v-else-if=\"widget.common.showForm == FormType.welcome\">\n\t\t\t\t\t\t\t\t\t\t<bx-livechat-form-welcome/>\t\n\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t\t<template v-else-if=\"widget.common.showForm == FormType.offline\">\n\t\t\t\t\t\t\t\t\t\t<bx-livechat-form-offline/>\t\n\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t\t<template v-else-if=\"widget.common.showForm == FormType.history\">\n\t\t\t\t\t\t\t\t\t\t<bx-livechat-form-history/>\t\n\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t\t<template v-else-if=\"widget.common.showForm == FormType.smile\">\n\t\t\t\t\t\t\t\t\t\t<bx-livechat-smiles @selectSmile=\"onSmilesSelectSmile\" @selectSet=\"onSmilesSelectSet\"/>\t\n\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t</keep-alive>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</template>\t\n\t\t\t\t\t\t<div class=\"bx-livechat-textarea\" :style=\"textareaHeightStyle\" ref=\"textarea\">\n\t\t\t\t\t\t\t<div class=\"bx-livechat-textarea-resize-handle\" @mousedown=\"onTextareaStartDrag\" @touchstart=\"onTextareaStartDrag\"></div>\n\t\t\t\t\t\t\t<bx-messenger-textarea\n\t\t\t\t\t\t\t\t:siteId=\"application.common.siteId\"\n\t\t\t\t\t\t\t\t:userId=\"application.common.userId\"\n\t\t\t\t\t\t\t\t:dialogId=\"application.dialog.dialogId\"\n\t\t\t\t\t\t\t\t:writesEventLetter=\"3\"\n\t\t\t\t\t\t\t\t:enableEdit=\"true\"\n\t\t\t\t\t\t\t\t:enableCommand=\"false\"\n\t\t\t\t\t\t\t\t:enableMention=\"false\"\n\t\t\t\t\t\t\t\t:enableFile=\"application.disk.enabled\"\n\t\t\t\t\t\t\t\t:autoFocus=\"application.device.type !== DeviceType.mobile\"\n\t\t\t\t\t\t\t\t:styles=\"{button: {backgroundColor: widget.common.styles.backgroundColor, iconColor: widget.common.styles.iconColor}}\"\n\t\t\t\t\t\t\t\tlistenEventInsertText=\"onMessengerTextareaInsertText\"\n\t\t\t\t\t\t\t\tlistenEventFocus=\"onMessengerTextareaFocus\"\n\t\t\t\t\t\t\t\tlistenEventBlur=\"onMessengerTextareaBlur\"\n\t\t\t\t\t\t\t\t@writes=\"onTextareaWrites\" \n\t\t\t\t\t\t\t\t@send=\"onTextareaSend\" \n\t\t\t\t\t\t\t\t@focus=\"onTextareaFocus\" \n\t\t\t\t\t\t\t\t@blur=\"onTextareaBlur\" \n\t\t\t\t\t\t\t\t@edit=\"logEvent('edit message', $event)\"\n\t\t\t\t\t\t\t\t@fileSelected=\"onTextareaFileSelected\"\n\t\t\t\t\t\t\t\t@appButtonClick=\"onTextareaAppButtonClick\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<bx-livechat-form-consent @agree=\"agreeConsentWidow\" @disagree=\"disagreeConsentWidow\"/>\n\t\t\t\t\t\t<template v-if=\"widget.common.copyright\">\n\t\t\t\t\t\t\t<bx-livechat-footer/>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</template>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</transition>\n\t`\n});","/**\n * Bitrix OpenLines widget\n * Body error component (Vue component)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {Vue} from \"ui.vue\";\nimport {Vuex} from \"ui.vue.vuex\";\n\nVue.component('bx-livechat-body-error',\n{\n\tcomputed:\n\t{\n\t\tlocalize()\n\t\t{\n\t\t\treturn  Object.freeze({\n\t\t\t\tBX_LIVECHAT_ERROR_TITLE: this.$root.$bitrixMessages.BX_LIVECHAT_ERROR_TITLE,\n\t\t\t\tBX_LIVECHAT_ERROR_DESC: this.$root.$bitrixMessages.BX_LIVECHAT_ERROR_DESC\n\t\t\t});\n\t\t},\n\t\t...Vuex.mapState({\n\t\t\tapplication: state => state.application\n\t\t}),\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-livechat-body\" key=\"error-body\">\n\t\t\t<div class=\"bx-livechat-warning-window\">\n\t\t\t\t<div class=\"bx-livechat-warning-icon\"></div>\n\t\t\t\t<template v-if=\"application.error.description\"> \n\t\t\t\t\t<div class=\"bx-livechat-help-title bx-livechat-help-title-sm bx-livechat-warning-msg\" v-html=\"application.error.description\"></div>\n\t\t\t\t</template> \n\t\t\t\t<template v-else>\n\t\t\t\t\t<div class=\"bx-livechat-help-title bx-livechat-help-title-md bx-livechat-warning-msg\">{{localize.BX_LIVECHAT_ERROR_TITLE}}</div>\n\t\t\t\t\t<div class=\"bx-livechat-help-title bx-livechat-help-title-sm bx-livechat-warning-msg\">{{localize.BX_LIVECHAT_ERROR_DESC}}</div>\n\t\t\t\t</template> \n\t\t\t</div>\n\t\t</div>\n\t`\n});\n","/**\n * Bitrix OpenLines widget\n * Head component (Vue component)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {Vue} from \"ui.vue\";\nimport {Vuex} from \"ui.vue.vuex\";\nimport {VoteType} from \"../const\";\n\nVue.component('bx-livechat-head',\n{\n\t/**\n\t * @emits 'close'\n\t * @emits 'like'\n\t * @emits 'history'\n\t */\n\tprops:\n\t{\n\t\tisWidgetDisabled: { default: false },\n\t},\n\tmethods:\n\t{\n\t\tclose(event)\n\t\t{\n\t\t\tthis.$emit('close');\n\t\t},\n\t\tlike(event)\n\t\t{\n\t\t\tthis.$emit('like');\n\t\t},\n\t\thistory(event)\n\t\t{\n\t\t\tthis.$emit('history');\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tVoteType: () => VoteType,\n\n\t\tcustomBackgroundStyle(state)\n\t\t{\n\t\t\treturn state.widget.common.styles.backgroundColor? 'background-color: '+state.widget.common.styles.backgroundColor+'!important;': '';\n\t\t},\n\t\tcustomBackgroundOnlineStyle(state)\n\t\t{\n\t\t\treturn state.widget.common.styles.backgroundColor? 'border-color: '+state.widget.common.styles.backgroundColor+'!important;': '';\n\t\t},\n\t\tshowName()\n\t\t{\n\t\t\treturn this.widget.dialog.operator.firstName || this.widget.dialog.operator.lastName;\n\t\t},\n\t\tlocalize()\n\t\t{\n\t\t\treturn Vue.getFilteredPhrases('BX_LIVECHAT_', this.$root.$bitrixMessages);\n\t\t},\n\t\t...Vuex.mapState({\n\t\t\twidget: state => state.widget,\n\t\t\tapplication: state => state.application,\n\t\t})\n\t},\n\twatch:\n\t{\n\t\tshowName(value)\n\t\t{\n\t\t\tif (value)\n\t\t\t{\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tthis.$root.$emit('onMessengerDialogScrollToBottom');\n\t\t\t\t}, 300);\n\t\t\t}\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-livechat-head-wrap\">\n\t\t\t<template v-if=\"isWidgetDisabled\">\n\t\t\t\t<div class=\"bx-livechat-head\" :style=\"customBackgroundStyle\">\n\t\t\t\t\t<div class=\"bx-livechat-title\">{{widget.common.configName || localize.BX_LIVECHAT_TITLE}}</div>\n\t\t\t\t\t<div class=\"bx-livechat-control-box\">\n\t\t\t\t\t\t<button v-if=\"!widget.common.pageMode\" class=\"bx-livechat-control-btn bx-livechat-control-btn-close\" :title=\"localize.BX_LIVECHAT_CLOSE_BUTTON\" @click=\"close\"></button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\t\n\t\t\t</template>\n\t\t\t<template v-else-if=\"application.error.active\">\n\t\t\t\t<div class=\"bx-livechat-head\" :style=\"customBackgroundStyle\">\n\t\t\t\t\t<div class=\"bx-livechat-title\">{{widget.common.configName || localize.BX_LIVECHAT_TITLE}}</div>\n\t\t\t\t\t<div class=\"bx-livechat-control-box\">\n\t\t\t\t\t\t<button v-if=\"!widget.common.pageMode\" class=\"bx-livechat-control-btn bx-livechat-control-btn-close\" :title=\"localize.BX_LIVECHAT_CLOSE_BUTTON\" @click=\"close\"></button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t\t<template v-else-if=\"!widget.common.configId\">\n\t\t\t\t<div class=\"bx-livechat-head\" :style=\"customBackgroundStyle\">\n\t\t\t\t\t<div class=\"bx-livechat-title\">{{widget.common.configName || localize.BX_LIVECHAT_TITLE}}</div>\n\t\t\t\t\t<div class=\"bx-livechat-control-box\">\n\t\t\t\t\t\t<button v-if=\"!widget.common.pageMode\" class=\"bx-livechat-control-btn bx-livechat-control-btn-close\" :title=\"localize.BX_LIVECHAT_CLOSE_BUTTON\" @click=\"close\"></button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</template>\t\t\t\n\t\t\t<template v-else>\n\t\t\t\t<div class=\"bx-livechat-head\" :style=\"customBackgroundStyle\">\n\t\t\t\t\t<template v-if=\"!showName\">\n\t\t\t\t\t\t<div class=\"bx-livechat-title\">{{widget.common.configName || localize.BX_LIVECHAT_TITLE}}</div>\n\t\t\t\t\t</template>\n\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t<div class=\"bx-livechat-user bx-livechat-status-online\">\n\t\t\t\t\t\t\t<template v-if=\"widget.dialog.operator.avatar\">\n\t\t\t\t\t\t\t\t<div class=\"bx-livechat-user-icon\" :style=\"'background-image: url('+encodeURI(widget.dialog.operator.avatar)+')'\">\n\t\t\t\t\t\t\t\t\t<div v-if=\"widget.dialog.operator.online\" class=\"bx-livechat-user-status\" :style=\"customBackgroundOnlineStyle\"></div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t\t\t<div class=\"bx-livechat-user-icon\">\n\t\t\t\t\t\t\t\t\t<div v-if=\"widget.dialog.operator.online\" class=\"bx-livechat-user-status\" :style=\"customBackgroundOnlineStyle\"></div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"bx-livechat-user-info\">\n\t\t\t\t\t\t\t<div class=\"bx-livechat-user-name\">{{widget.dialog.operator.firstName? widget.dialog.operator.firstName: widget.dialog.operator.name}}</div>\n\t\t\t\t\t\t\t<div class=\"bx-livechat-user-position\">{{widget.dialog.operator.workPosition? widget.dialog.operator.workPosition: localize.BX_LIVECHAT_USER}}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</template>\n\t\t\t\t\t<div class=\"bx-livechat-control-box\">\n\t\t\t\t\t\t<span class=\"bx-livechat-control-box-active\" v-if=\"widget.common.dialogStart && widget.dialog.sessionId\">\n\t\t\t\t\t\t\t<button v-if=\"widget.common.vote.enable && (!widget.dialog.sessionClose || widget.dialog.sessionClose && widget.dialog.userVote == VoteType.none)\" :class=\"'bx-livechat-control-btn bx-livechat-control-btn-like bx-livechat-dialog-vote-'+(widget.dialog.userVote)\" :title=\"localize.BX_LIVECHAT_VOTE_BUTTON\" @click=\"like\"></button>\n\t\t\t\t\t\t\t<button v-if=\"widget.common.vote.enable && widget.dialog.sessionClose && widget.dialog.userVote != VoteType.none\" :class=\"'bx-livechat-control-btn bx-livechat-control-btn-disabled bx-livechat-control-btn-like bx-livechat-dialog-vote-'+(widget.dialog.userVote)\"></button>\n\t\t\t\t\t\t\t<button class=\"bx-livechat-control-btn bx-livechat-control-btn-mail\" :title=\"localize.BX_LIVECHAT_MAIL_BUTTON_NEW\" @click=\"history\"></button>\n\t\t\t\t\t\t</span>\t\n\t\t\t\t\t\t<button v-if=\"!widget.common.pageMode\" class=\"bx-livechat-control-btn bx-livechat-control-btn-close\" :title=\"localize.BX_LIVECHAT_CLOSE_BUTTON\" @click=\"close\"></button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t</div>\n\t`\n});","/**\n * Bitrix OpenLines widget\n * Body loading component (Vue component)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {Vue} from \"ui.vue\";\n\nVue.component('bx-livechat-body-loading',\n{\n\tcomputed:\n\t{\n\t\tlocalize()\n\t\t{\n\t\t\treturn  Object.freeze({\n\t\t\t\tBX_LIVECHAT_LOADING: this.$root.$bitrixMessages.BX_LIVECHAT_LOADING\n\t\t\t});\n\t\t}\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-livechat-loading-window\">\n\t\t\t<svg class=\"bx-livechat-loading-circular\" viewBox=\"25 25 50 50\">\n\t\t\t\t<circle class=\"bx-livechat-loading-path\" cx=\"50\" cy=\"50\" r=\"20\" fill=\"none\" stroke-miterlimit=\"10\"/>\n\t\t\t\t<circle class=\"bx-livechat-loading-inner-path\" cx=\"50\" cy=\"50\" r=\"20\" fill=\"none\" stroke-miterlimit=\"10\"/>\n\t\t\t</svg>\n\t\t\t<h3 class=\"bx-livechat-help-title bx-livechat-help-title-md bx-livechat-loading-msg\">{{localize.BX_LIVECHAT_LOADING}}</h3>\n\t\t</div>\n\t`\n});","/**\n * Bitrix OpenLines widget\n * Body operators component (Vue component)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {Vue} from \"ui.vue\";\nimport {Vuex} from \"ui.vue.vuex\";\n\nVue.component('bx-livechat-body-operators',\n{\n\tcomputed:\n\t{\n\t\tlocalize()\n\t\t{\n\t\t\treturn Vue.getFilteredPhrases('BX_LIVECHAT_', this.$root.$bitrixMessages);\n\t\t},\n\t\t...Vuex.mapState({\n\t\t\twidget: state => state.widget\n\t\t})\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-livechat-help-container\">\n\t\t\t<transition name=\"bx-livechat-animation-fade\">\n\t\t\t\t<h2 v-if=\"widget.common.online\" key=\"online\" class=\"bx-livechat-help-title bx-livechat-help-title-lg\">{{widget.common.textMessages.bxLivechatOnlineLine1}}<div class=\"bx-livechat-help-subtitle\">{{widget.common.textMessages.bxLivechatOnlineLine2}}</div></h2>\n\t\t\t\t<h2 v-else key=\"offline\" class=\"bx-livechat-help-title bx-livechat-help-title-sm\">{{widget.common.textMessages.bxLivechatOffline}}</h2>\n\t\t\t</transition>\t\n\t\t\t<div class=\"bx-livechat-help-user\">\n\t\t\t\t<template v-for=\"operator in widget.common.operators\">\n\t\t\t\t\t<div class=\"bx-livechat-user\" :key=\"operator.id\">\n\t\t\t\t\t\t<template v-if=\"operator.avatar\">\n\t\t\t\t\t\t\t<div class=\"bx-livechat-user-icon\" :style=\"'background-image: url('+encodeURI(operator.avatar)+')'\"></div>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t\t<div class=\"bx-livechat-user-icon\"></div>\n\t\t\t\t\t\t</template>\t\n\t\t\t\t\t\t<div class=\"bx-livechat-user-info\">\n\t\t\t\t\t\t\t<div class=\"bx-livechat-user-name\">{{operator.firstName? operator.firstName: operator.name}}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</template>\t\n\t\t\t</div>\n\t\t</div>\n\t`\n});","/**\n * Bitrix OpenLines widget\n * Body orientation disabled component (Vue component)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {Vue} from \"ui.vue\";\n\nVue.component('bx-livechat-body-orientation-disabled',\n{\n\tcomputed:\n\t{\n\t\tlocalize()\n\t\t{\n\t\t\treturn  Object.freeze({\n\t\t\t\tBX_LIVECHAT_MOBILE_ROTATE: this.$root.$bitrixMessages.BX_LIVECHAT_MOBILE_ROTATE\n\t\t\t});\n\t\t}\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-livechat-body\" key=\"orientation-head\">\n\t\t\t<div class=\"bx-livechat-mobile-orientation-box\">\n\t\t\t\t<div class=\"bx-livechat-mobile-orientation-icon\"></div>\n\t\t\t\t<div class=\"bx-livechat-mobile-orientation-text\">{{localize.BX_LIVECHAT_MOBILE_ROTATE}}</div>\n\t\t\t</div>\n\t\t</div>\n\t`\n});","/**\n * Bitrix OpenLines widget\n * Form consent component (Vue component)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {Vue} from \"ui.vue\";\nimport {Vuex} from \"ui.vue.vuex\";\n\nVue.component('bx-livechat-form-consent',\n{\n\t/**\n\t * @emits 'agree' {event: object} -- 'event' - click event\n\t * @emits 'disagree' {event: object} -- 'event' - click event\n\t */\n\tcomputed:\n\t{\n\t\tlocalize()\n\t\t{\n\t\t\treturn Vue.getFilteredPhrases('BX_LIVECHAT_', this.$root.$bitrixMessages);\n\t\t},\n\t\t...Vuex.mapState({\n\t\t\twidget: state => state.widget,\n\t\t})\n\t},\n\tmethods:\n\t{\n\t\tagree(event)\n\t\t{\n\t\t\tthis.$emit('agree', {event});\n\t\t},\n\t\tdisagree(event)\n\t\t{\n\t\t\tthis.$emit('disagree', {event});\n\t\t},\n\t\tonShow(element, done)\n\t\t{\n\t\t\telement.classList.add('bx-livechat-consent-window-show');\n\t\t\tdone();\n\t\t},\n\t\tonHide(element, done)\n\t\t{\n\t\t\telement.classList.remove('bx-livechat-consent-window-show');\n\t\t\telement.classList.add('bx-livechat-consent-window-close');\n\t\t\tsetTimeout(function() {\n\t\t\t\tdone();\n\t\t\t}, 400);\n\t\t},\n\t\tonKeyDown(event)\n\t\t{\n\t\t\tif (event.keyCode == 9)\n\t\t\t{\n\t\t\t\tif (event.target === this.$refs.iframe)\n\t\t\t\t{\n\t\t\t\t\tif (event.shiftKey)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$refs.cancel.focus();\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$refs.success.focus();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (event.target === this.$refs.success)\n\t\t\t\t{\n\t\t\t\t\tif (event.shiftKey)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$refs.iframe.focus();\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$refs.cancel.focus();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (event.target === this.$refs.cancel)\n\t\t\t\t{\n\t\t\t\t\tif (event.shiftKey)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$refs.success.focus();\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$refs.iframe.focus();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tevent.preventDefault();\n\t\t\t}\n\t\t\telse if (event.keyCode == 39 || event.keyCode == 37)\n\t\t\t{\n\t\t\t\tif (event.target.nextElementSibling)\n\t\t\t\t{\n\t\t\t\t\tevent.target.nextElementSibling.focus();\n\t\t\t\t}\n\t\t\t\telse if (event.target.previousElementSibling)\n\t\t\t\t{\n\t\t\t\t\tevent.target.previousElementSibling.focus();\n\t\t\t\t}\n\t\t\t\tevent.preventDefault();\n\t\t\t}\n\t\t},\n\t},\n\tdirectives:\n\t{\n\t\tfocus:\n\t\t{\n\t\t\tinserted(element, params)\n\t\t\t{\n\t\t\t\telement.focus();\n\t\t\t}\n\t\t}\n\t},\n\ttemplate: `\n\t\t<transition @enter=\"onShow\" @leave=\"onHide\">\n\t\t\t<template v-if=\"widget.common.showConsent && widget.common.consentUrl\">\n\t\t\t\t<div class=\"bx-livechat-consent-window\">\n\t\t\t\t\t<div class=\"bx-livechat-consent-window-title\">{{localize.BX_LIVECHAT_CONSENT_TITLE}}</div>\n\t\t\t\t\t<div class=\"bx-livechat-consent-window-content\">\n\t\t\t\t\t\t<iframe class=\"bx-livechat-consent-window-content-iframe\" ref=\"iframe\" frameborder=\"0\" marginheight=\"0\"  marginwidth=\"0\" allowtransparency=\"allow-same-origin\" seamless=\"true\" :src=\"widget.common.consentUrl\" @keydown=\"onKeyDown\"></iframe>\n\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\n\t\t\t\t\t<div class=\"bx-livechat-consent-window-btn-box\">\n\t\t\t\t\t\t<button class=\"bx-livechat-btn bx-livechat-btn-success\" ref=\"success\" @click=\"agree\" @keydown=\"onKeyDown\" v-focus>{{localize.BX_LIVECHAT_CONSENT_AGREE}}</button>\n\t\t\t\t\t\t<button class=\"bx-livechat-btn bx-livechat-btn-cancel\" ref=\"cancel\" @click=\"disagree\" @keydown=\"onKeyDown\">{{localize.BX_LIVECHAT_CONSENT_DISAGREE}}</button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t</transition>\n\t`\n});","/**\n * Bitrix OpenLines widget\n * Form history component (Vue component)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport 'ui.icons';\nimport 'ui.forms';\n\nimport {Vue} from \"ui.vue\";\nimport {Vuex} from \"ui.vue.vuex\";\nimport {Utils} from \"im.utils\";\nimport {FormType} from \"../const\";\n\nVue.component('bx-livechat-form-history',\n{\n\tdata()\n\t{\n\t\treturn {\n\t\t\tfieldEmail: '',\n\t\t}\n\t},\n\twatch:\n\t{\n\t\tfieldEmail(value)\n\t\t{\n\t\t\tclearTimeout(this.fieldEmailTimeout);\n\t\t\tthis.fieldEmailTimeout = setTimeout(this.checkEmailField, 300);\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tlocalize()\n\t\t{\n\t\t\treturn Vue.getFilteredPhrases('BX_LIVECHAT_', this.$root.$bitrixMessages);\n\t\t},\n\t\t...Vuex.mapState({\n\t\t\twidget: state => state.widget,\n\t\t})\n\t},\n\tcreated()\n\t{\n\t\tthis.fieldEmail = '' + this.widget.user.email;\n\t},\n\tmethods:\n\t{\n\t\tformShowed()\n\t\t{\n\t\t\tif (!Utils.platform.isMobile())\n\t\t\t{\n\t\t\t\tthis.$refs.emailInput.focus();\n\t\t\t}\n\t\t},\n\t\tsendForm()\n\t\t{\n\t\t\tlet email = this.checkEmailField()? this.fieldEmail: '';\n\t\t\tif (email)\n\t\t\t{\n\t\t\t\tthis.$root.$bitrixWidget.sendForm(FormType.history, {email});\n\t\t\t}\n\n\t\t\tthis.hideForm();\n\t\t},\n\t\thideForm(event)\n\t\t{\n\t\t\tclearTimeout(this.fieldEmailTimeout);\n\t\t\tthis.$parent.hideForm();\n\t\t},\n\t\tonFieldEnterPress(event)\n\t\t{\n\t\t\tthis.sendForm();\n\t\t\tevent.preventDefault();\n\t\t},\n\t\tcheckEmailField()\n\t\t{\n\t\t\tif (this.fieldEmail.match(/^(.*)@(.*)\\.[a-zA-Z]{2,}$/))\n\t\t\t{\n\t\t\t\tif (this.$refs.email)\n\t\t\t\t{\n\t\t\t\t\tthis.$refs.email.classList.remove('ui-ctl-danger');\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (document.activeElement !== this.$refs.emailInput)\n\t\t\t\t{\n\t\t\t\t\tif (this.$refs.email)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$refs.email.classList.add('ui-ctl-danger');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\t\t},\n\t},\n\ttemplate: `\n\t\t<transition enter-active-class=\"bx-livechat-consent-window-show\" leave-active-class=\"bx-livechat-form-close\" @after-enter=\"formShowed\">\n\t\t\t<div class=\"bx-livechat-alert-box bx-livechat-form-show\" key=\"welcome\">\t\n\t\t\t\t<div class=\"bx-livechat-alert-close\" @click=\"hideForm\"></div>\n\t\t\t\t<div class=\"bx-livechat-alert-form-box\">\n\t\t\t\t\t<h4 class=\"bx-livechat-alert-title bx-livechat-alert-title-sm\">{{localize.BX_LIVECHAT_MAIL_TITLE_NEW}}</h4>\n\t\t\t\t\t<div class=\"bx-livechat-form-item ui-ctl ui-ctl-after-icon ui-ctl-w100 ui-ctl-lg\" ref=\"email\">\n\t\t\t\t\t   <div class=\"ui-ctl-after ui-ctl-icon-mail bx-livechat-form-icon\" :title=\"localize.BX_LIVECHAT_FIELD_MAIL_TOOLTIP\"></div>\n\t\t\t\t\t   <input type=\"text\" class=\"ui-ctl-element ui-ctl-textbox\" :placeholder=\"localize.BX_LIVECHAT_FIELD_MAIL\" v-model=\"fieldEmail\" ref=\"emailInput\" @blur=\"checkEmailField\" @keydown.enter=\"onFieldEnterPress\">\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"bx-livechat-btn-box\">\n\t\t\t\t\t\t<button class=\"bx-livechat-btn bx-livechat-btn-success\" @click=\"sendForm\">{{localize.BX_LIVECHAT_MAIL_BUTTON_NEW}}</button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\t\n\t\t</transition>\t\n\t`\n});","/**\n * Bitrix OpenLines widget\n * Form offline component (Vue component)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport 'ui.icons';\nimport 'ui.forms';\n\nimport {Vue} from \"ui.vue\";\nimport {Utils} from \"im.utils\";\nimport {FormType} from \"../const\";\n\nVue.cloneComponent('bx-livechat-form-offline', 'bx-livechat-form-welcome',\n{\n\tmethods:\n\t{\n\t\tformShowed()\n\t\t{\n\t\t\tif (!Utils.platform.isMobile())\n\t\t\t{\n\t\t\t\tthis.$refs.emailInput.focus();\n\t\t\t}\n\t\t},\n\t\tsendForm()\n\t\t{\n\t\t\tlet name = this.fieldName;\n\t\t\tlet email = this.checkEmailField()? this.fieldEmail: '';\n\t\t\tlet phone = this.checkPhoneField()? this.fieldPhone: '';\n\n\t\t\tif (name || email || phone)\n\t\t\t{\n\t\t\t\tthis.$root.$bitrixWidget.sendForm(FormType.offline, {name, email, phone});\n\t\t\t}\n\n\t\t\tthis.hideForm();\n\t\t},\n\t\tonFieldEnterPress(event)\n\t\t{\n\t\t\tif (event.target === this.$refs.emailInput)\n\t\t\t{\n\t\t\t\tthis.showFullForm();\n\t\t\t\tthis.$refs.phoneInput.focus();\n\t\t\t}\n\t\t\telse if (event.target === this.$refs.phoneInput)\n\t\t\t{\n\t\t\t\tthis.$refs.nameInput.focus();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.sendForm();\n\t\t\t}\n\n\t\t\tevent.preventDefault();\n\t\t},\n\t},\n\twatch:\n\t{\n\t\tfieldName()\n\t\t{\n\t\t\tclearTimeout(this.fieldNameTimeout);\n\t\t\tthis.fieldNameTimeout = setTimeout(this.checkNameField, 300);\n\t\t},\n\t\tfieldEmail()\n\t\t{\n\t\t\tclearTimeout(this.showFormTimeout);\n\t\t\tthis.showFormTimeout = setTimeout(this.showFullForm, 1000);\n\n\t\t\tclearTimeout(this.fieldEmailTimeout);\n\t\t\tthis.fieldEmailTimeout = setTimeout(this.checkEmailField, 300);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<transition enter-active-class=\"bx-livechat-consent-window-show\" leave-active-class=\"bx-livechat-form-close\" @after-enter=\"formShowed\">\n\t\t\t<div class=\"bx-livechat-alert-box bx-livechat-form-show\" key=\"welcome\">\t\n\t\t\t\t<div class=\"bx-livechat-alert-close\" @click=\"hideForm\"></div>\n\t\t\t\t<div class=\"bx-livechat-alert-form-box\">\n\t\t\t\t\t<h4 class=\"bx-livechat-alert-title bx-livechat-alert-title-sm\">{{localize.BX_LIVECHAT_OFFLINE_TITLE}}</h4>\n\t\t\t\t\t<div class=\"bx-livechat-form-item ui-ctl ui-ctl-after-icon ui-ctl-w100 ui-ctl-lg\" ref=\"email\">\n\t\t\t\t\t   <div class=\"ui-ctl-after ui-ctl-icon-mail bx-livechat-form-icon\" :title=\"localize.BX_LIVECHAT_FIELD_MAIL_TOOLTIP\"></div>\n\t\t\t\t\t   <input type=\"text\" class=\"ui-ctl-element ui-ctl-textbox\" :placeholder=\"localize.BX_LIVECHAT_FIELD_MAIL\" v-model=\"fieldEmail\" ref=\"emailInput\" @blur=\"checkEmailField\" @keydown.enter=\"onFieldEnterPress\">\n\t\t\t\t\t</div>\n\t\t\t\t\t<div :class=\"['bx-livechat-form-short', {\n\t\t\t\t\t\t'bx-livechat-form-full': isFullForm,\n\t\t\t\t\t}]\">\n\t\t\t\t\t\t<div class=\"bx-livechat-form-item ui-ctl ui-ctl-after-icon ui-ctl-w100 ui-ctl-lg\" ref=\"phone\">\n\t\t\t\t\t\t   <div class=\"ui-ctl-after ui-ctl-icon-phone bx-livechat-form-icon\" :title=\"localize.BX_LIVECHAT_FIELD_PHONE_TOOLTIP\"></div>\n\t\t\t\t\t\t   <input type=\"text\" class=\"ui-ctl-element ui-ctl-textbox\" :placeholder=\"localize.BX_LIVECHAT_FIELD_PHONE\" v-model=\"fieldPhone\" ref=\"phoneInput\" @blur=\"checkPhoneField\" @keydown.enter=\"onFieldEnterPress\">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"bx-livechat-form-item ui-ctl ui-ctl-w100 ui-ctl-lg\" ref=\"name\">\n\t\t\t\t\t\t   <input type=\"text\" class=\"ui-ctl-element ui-ctl-textbox\" :placeholder=\"localize.BX_LIVECHAT_FIELD_NAME\" v-model=\"fieldName\" ref=\"nameInput\" @blur=\"checkNameField\" @keydown.enter=\"onFieldEnterPress\"  @keydown.tab=\"onFieldEnterPress\">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"bx-livechat-btn-box\">\n\t\t\t\t\t\t\t<button class=\"bx-livechat-btn bx-livechat-btn-success\" @click=\"sendForm\">{{localize.BX_LIVECHAT_ABOUT_SEND}}</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\t\n\t\t</transition>\t\n\t`\n});","/**\n * Bitrix OpenLines widget\n * Form vote component (Vue component)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {Vue} from \"ui.vue\";\nimport {Vuex} from \"ui.vue.vuex\";\nimport {VoteType, FormType} from \"../const\";\n\nVue.component('bx-livechat-form-vote',\n{\n\tcomputed:\n\t{\n\t\tVoteType: () => VoteType,\n\n\t\tlocalize()\n\t\t{\n\t\t\treturn Vue.getFilteredPhrases('BX_LIVECHAT_', this.$root.$bitrixMessages);\n\t\t},\n\t\t...Vuex.mapState({\n\t\t\twidget: state => state.widget,\n\t\t})\n\t},\n\tmethods: {\n\t\tuserVote(vote)\n\t\t{\n\t\t\tthis.$store.commit('widget/common', {showForm: FormType.none});\n\t\t\tthis.$store.commit('widget/dialog', {userVote: vote});\n\n\t\t\tthis.$root.$bitrixWidget.sendDialogVote(vote);\n\t\t},\n\t\thideForm(event)\n\t\t{\n\t\t\tthis.$parent.hideForm();\n\t\t},\n\t},\n\ttemplate: `\n\t\t<transition enter-active-class=\"bx-livechat-consent-window-show\" leave-active-class=\"bx-livechat-form-close\">\n\t\t\t<div class=\"bx-livechat-alert-box bx-livechat-form-rate-show\" key=\"vote\">\n\t\t\t\t<div class=\"bx-livechat-alert-close\" @click=\"hideForm\"></div>\n\t\t\t\t<div class=\"bx-livechat-alert-rate-box\">\n\t\t\t\t\t<h4 class=\"bx-livechat-alert-title bx-livechat-alert-title-mdl\">{{widget.common.vote.messageText}}</h4>\n\t\t\t\t\t<div class=\"bx-livechat-btn-box\">\n\t\t\t\t\t\t<button class=\"bx-livechat-btn bx-livechat-btn-like\" @click=\"userVote(VoteType.like)\" :title=\"widget.common.vote.messageLike\"></button>\n\t\t\t\t\t\t<button class=\"bx-livechat-btn bx-livechat-btn-dislike\" @click=\"userVote(VoteType.dislike)\" :title=\"widget.common.vote.messageDislike\"></button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</transition>\t\n\t`\n});","/**\n * Bitrix OpenLines widget\n * Form welcome component (Vue component)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport 'ui.icons';\nimport 'ui.forms';\n\nimport {Vue} from \"ui.vue\";\nimport {Vuex} from \"ui.vue.vuex\";\nimport {Utils} from \"im.utils\";\nimport {FormType} from \"../const\";\n\nVue.component('bx-livechat-form-welcome',\n{\n\tdata()\n\t{\n\t\treturn {\n\t\t\tfieldName: '',\n\t\t\tfieldEmail: '',\n\t\t\tfieldPhone: '',\n\t\t\tisFullForm: Utils.platform.isMobile()\n\t\t}\n\t},\n\twatch:\n\t{\n\t\tfieldName()\n\t\t{\n\t\t\tclearTimeout(this.showFormTimeout);\n\t\t\tthis.showFormTimeout = setTimeout(this.showFullForm, 1000);\n\n\t\t\tclearTimeout(this.fieldNameTimeout);\n\t\t\tthis.fieldNameTimeout = setTimeout(this.checkNameField, 300);\n\t\t},\n\t\tfieldEmail(value)\n\t\t{\n\t\t\tclearTimeout(this.fieldEmailTimeout);\n\t\t\tthis.fieldEmailTimeout = setTimeout(this.checkEmailField, 300);\n\t\t},\n\t\tfieldPhone(value)\n\t\t{\n\t\t\tclearTimeout(this.fieldPhoneTimeout);\n\t\t\tthis.fieldPhoneTimeout = setTimeout(this.checkPhoneField, 300);\n\t\t}\n\t},\n\tcomputed:\n\t{\n\t\tlocalize()\n\t\t{\n\t\t\treturn Vue.getFilteredPhrases('BX_LIVECHAT_', this.$root.$bitrixMessages);\n\t\t},\n\t\t...Vuex.mapState({\n\t\t\twidget: state => state.widget,\n\t\t})\n\t},\n\tcreated()\n\t{\n\t\tthis.fieldName = '' + this.widget.user.name;\n\t\tthis.fieldEmail = '' + this.widget.user.email;\n\t\tthis.fieldPhone = '' + this.widget.user.phone;\n\t},\n\tmethods:\n\t{\n\t\tformShowed()\n\t\t{\n\t\t\tif (!Utils.platform.isMobile())\n\t\t\t{\n\t\t\t\tthis.$refs.nameInput.focus();\n\t\t\t}\n\t\t},\n\t\tshowFullForm()\n\t\t{\n\t\t\tclearTimeout(this.showFormTimeout);\n\t\t\tthis.isFullForm = true;\n\t\t},\n\t\tsendForm()\n\t\t{\n\t\t\tlet name = this.fieldName;\n\t\t\tlet email = this.checkEmailField()? this.fieldEmail: '';\n\t\t\tlet phone = this.checkPhoneField()? this.fieldPhone: '';\n\n\t\t\tif (name || email || phone)\n\t\t\t{\n\t\t\t\tthis.$root.$bitrixWidget.sendForm(FormType.welcome, {name, email, phone});\n\t\t\t}\n\n\t\t\tthis.hideForm();\n\t\t},\n\t\thideForm(event)\n\t\t{\n\t\t\tclearTimeout(this.showFormTimeout);\n\t\t\tclearTimeout(this.fieldNameTimeout);\n\t\t\tclearTimeout(this.fieldEmailTimeout);\n\t\t\tclearTimeout(this.fieldPhoneTimeout);\n\n\t\t\tthis.$parent.hideForm();\n\t\t},\n\t\tonFieldEnterPress(event)\n\t\t{\n\t\t\tif (event.target === this.$refs.nameInput)\n\t\t\t{\n\t\t\t\tthis.showFullForm();\n\t\t\t\tthis.$refs.emailInput.focus();\n\t\t\t}\n\t\t\telse if (event.target === this.$refs.emailInput)\n\t\t\t{\n\t\t\t\tthis.$refs.phoneInput.focus();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.sendForm();\n\t\t\t}\n\n\t\t\tevent.preventDefault();\n\t\t},\n\t\tcheckNameField()\n\t\t{\n\t\t\tif (this.fieldName.length > 0)\n\t\t\t{\n\t\t\t\tif (this.$refs.name)\n\t\t\t\t{\n\t\t\t\t\tthis.$refs.name.classList.remove('ui-ctl-danger');\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (document.activeElement !== this.$refs.nameInput)\n\t\t\t\t{\n\t\t\t\t\tif (this.$refs.name)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$refs.name.classList.add('ui-ctl-danger');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\t\t},\n\t\tcheckEmailField()\n\t\t{\n\t\t\tif (this.fieldEmail.match(/^(.*)@(.*)\\.[a-zA-Z]{2,}$/))\n\t\t\t{\n\t\t\t\tif (this.$refs.email)\n\t\t\t\t{\n\t\t\t\t\tthis.$refs.email.classList.remove('ui-ctl-danger');\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (document.activeElement !== this.$refs.emailInput)\n\t\t\t\t{\n\t\t\t\t\tif (this.$refs.email)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$refs.email.classList.add('ui-ctl-danger');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\t\t},\n\t\tcheckPhoneField()\n\t\t{\n\t\t\tif (this.fieldPhone.match(/^(\\s*)?(\\+)?([- _():=+]?\\d[- _():=+]?){10,14}(\\s*)?$/))\n\t\t\t{\n\t\t\t\tif (this.$refs.phone)\n\t\t\t\t{\n\t\t\t\t\tthis.$refs.phone.classList.remove('ui-ctl-danger');\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (document.activeElement !== this.$refs.phoneInput)\n\t\t\t\t{\n\t\t\t\t\tif (this.$refs.phone)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$refs.phone.classList.add('ui-ctl-danger');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t},\n\ttemplate: `\n\t\t<transition enter-active-class=\"bx-livechat-consent-window-show\" leave-active-class=\"bx-livechat-form-close\" @after-enter=\"formShowed\">\n\t\t\t<div class=\"bx-livechat-alert-box bx-livechat-form-show\" key=\"welcome\">\t\n\t\t\t\t<div class=\"bx-livechat-alert-close\" @click=\"hideForm\"></div>\n\t\t\t\t<div class=\"bx-livechat-alert-form-box\">\n\t\t\t\t\t<h4 class=\"bx-livechat-alert-title bx-livechat-alert-title-sm\">{{localize.BX_LIVECHAT_ABOUT_TITLE}}</h4>\n\t\t\t\t\t<div class=\"bx-livechat-form-item ui-ctl ui-ctl-w100 ui-ctl-lg\" ref=\"name\">\n\t\t\t\t\t   <input type=\"text\" class=\"ui-ctl-element ui-ctl-textbox\" :placeholder=\"localize.BX_LIVECHAT_FIELD_NAME\" v-model=\"fieldName\" ref=\"nameInput\" @blur=\"checkNameField\" @keydown.enter=\"onFieldEnterPress\"  @keydown.tab=\"onFieldEnterPress\">\n\t\t\t\t\t</div>\n\t\t\t\t\t<div :class=\"['bx-livechat-form-short', {\n\t\t\t\t\t\t'bx-livechat-form-full': isFullForm,\n\t\t\t\t\t}]\">\n\t\t\t\t\t\t<div class=\"bx-livechat-form-item ui-ctl ui-ctl-after-icon ui-ctl-w100 ui-ctl-lg\" ref=\"email\">\n\t\t\t\t\t\t   <div class=\"ui-ctl-after ui-ctl-icon-mail bx-livechat-form-icon\" :title=\"localize.BX_LIVECHAT_FIELD_MAIL_TOOLTIP\"></div>\n\t\t\t\t\t\t   <input type=\"text\" class=\"ui-ctl-element ui-ctl-textbox\" :placeholder=\"localize.BX_LIVECHAT_FIELD_MAIL\" v-model=\"fieldEmail\" ref=\"emailInput\" @blur=\"checkEmailField\" @keydown.enter=\"onFieldEnterPress\">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"bx-livechat-form-item ui-ctl ui-ctl-after-icon ui-ctl-w100 ui-ctl-lg\" ref=\"phone\">\n\t\t\t\t\t\t   <div class=\"ui-ctl-after ui-ctl-icon-phone bx-livechat-form-icon\" :title=\"localize.BX_LIVECHAT_FIELD_PHONE_TOOLTIP\"></div>\n\t\t\t\t\t\t   <input type=\"text\" class=\"ui-ctl-element ui-ctl-textbox\" :placeholder=\"localize.BX_LIVECHAT_FIELD_PHONE\" v-model=\"fieldPhone\" ref=\"phoneInput\" @blur=\"checkPhoneField\" @keydown.enter=\"onFieldEnterPress\">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"bx-livechat-btn-box\">\n\t\t\t\t\t\t\t<button class=\"bx-livechat-btn bx-livechat-btn-success\" @click=\"sendForm\">{{localize.BX_LIVECHAT_ABOUT_SEND}}</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\t\n\t\t</transition>\t\n\t`\n});","/**\n * Bitrix OpenLines widget\n * Smiles component (Vue component)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {Vue} from \"ui.vue\";\n\nVue.cloneComponent('bx-livechat-smiles', 'bx-smiles',\n{\n\tmethods:\n\t{\n\t\thideForm(event)\n\t\t{\n\t\t\tthis.$parent.hideForm();\n\t\t},\n\t},\n\ttemplate: `\n\t\t<transition enter-active-class=\"bx-livechat-consent-window-show\" leave-active-class=\"bx-livechat-form-close\">\n\t\t\t<div class=\"bx-livechat-alert-box bx-livechat-alert-box-zero-padding bx-livechat-form-show\" key=\"vote\">\n\t\t\t\t<div class=\"bx-livechat-alert-close\" @click=\"hideForm\"></div>\n\t\t\t\t<div class=\"bx-livechat-alert-smiles-box\">\n\t\t\t\t\t#PARENT_TEMPLATE#\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</transition>\n\t`\n});","/**\n * Bitrix OpenLines widget\n * Footer component (Vue component)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {Vue} from \"ui.vue\";\nimport {Vuex} from \"ui.vue.vuex\";\n\nVue.component('bx-livechat-footer',\n{\n\tcomputed:\n\t{\n\t\tlocalize()\n\t\t{\n\t\t\treturn Vue.getFilteredPhrases('BX_LIVECHAT_COPYRIGHT_', this.$root.$bitrixMessages);\n\t\t},\n\t\t...Vuex.mapState({\n\t\t\twidget: state => state.widget\n\t\t})\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-livechat-copyright\">\t\n\t\t\t<template v-if=\"widget.common.copyrightUrl\">\n\t\t\t\t<a :href=\"widget.common.copyrightUrl\" target=\"_blank\">\n\t\t\t\t\t<span class=\"bx-livechat-logo-name\">{{localize.BX_LIVECHAT_COPYRIGHT_TEXT}}</span>\n\t\t\t\t\t<span class=\"bx-livechat-logo-icon\"></span>\n\t\t\t\t</a>\n\t\t\t</template>\n\t\t\t<template v-else>\n\t\t\t\t<span class=\"bx-livechat-logo-name\">{{localize.BX_LIVECHAT_COPYRIGHT_TEXT}}</span>\n\t\t\t\t<span class=\"bx-livechat-logo-icon\"></span>\n\t\t\t</template>\n\t\t</div>\n\t`\n});\n","/**\n * Bitrix OpenLines widget\n * Widget component & controller\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\n// core\n\nimport 'main.polyfill.customevent';\n\n// vue components\nimport 'pull.components.status';\nimport 'ui.vue.components.smiles';\nimport 'im.component.dialog';\nimport 'im.component.textarea';\nimport 'imopenlines.component.message';\n\n// widget files\nimport \"./widget.css\";\nimport {VoteType, LocationStyle, SubscriptionType} from \"./const\";\n\n// widget utils\nimport {Cookie} from \"./utils/cookie\";\nimport {WidgetPublicManager} from \"./public\";\n\n// widget components\n\nimport \"./component/bx-livechat\";\nimport \"./component/bx-livechat-body-error\";\nimport \"./component/bx-livechat-body-head\";\nimport \"./component/bx-livechat-body-loading\";\nimport \"./component/bx-livechat-body-operators\";\nimport \"./component/bx-livechat-body-orientation-disabled\";\nimport \"./component/bx-livechat-form-consent\";\nimport \"./component/bx-livechat-form-history\";\nimport \"./component/bx-livechat-form-offline\";\nimport \"./component/bx-livechat-form-vote\";\nimport \"./component/bx-livechat-form-welcome\";\nimport \"./component/bx-livechat-smiles\";\nimport \"./component/bx-livechat-footer\";\n\n\nBX.LiveChatWidget = WidgetPublicManager;\nBX.LiveChatWidget.VoteType = VoteType;\nBX.LiveChatWidget.SubscriptionType = SubscriptionType;\nBX.LiveChatWidget.LocationStyle = LocationStyle;\nBX.LiveChatWidget.Cookie = Cookie;\n\nwindow.dispatchEvent(new CustomEvent('onBitrixLiveChatSourceLoaded', {detail: {}}));"],"names":["GetObjectValues","source","destination","value","hasOwnProperty","push","VoteType","Object","freeze","none","like","dislike","LanguageType","russian","ukraine","world","FormType","smile","consent","welcome","offline","history","LocationType","topLeft","topMiddle","topBottom","bottomLeft","bottomMiddle","bottomRight","LocationStyle","SubscriptionType","configLoaded","widgetOpen","widgetClose","sessionStart","sessionOperatorChange","sessionFinish","operatorMessage","userForm","userMessage","userVote","every","SubscriptionTypeCheck","RestMethod","widgetUserRegister","widgetConfigGet","widgetDialogGet","widgetUserGet","widgetUserConsentApply","widgetVoteSend","widgetFormSend","pullServerTime","pullConfigGet","RestMethodCheck","RestAuth","guest","Cookie","get","siteId","name","cookieName","navigator","cookieEnabled","result","document","cookie","match","RegExp","replace","decodeURIComponent","LocalStorage","isEnabled","undefined","window","BX","LiveChatCookie","set","options","expires","currentDate","Date","setTime","getTime","toUTCString","encodeURIComponent","updatedCookie","propertyName","propertyValue","WidgetModel","common","configId","configName","host","getVariable","location","protocol","pageMode","copyright","copyrightUrl","styles","backgroundColor","iconColor","vote","enable","messageText","messageLike","messageDislike","textMessages","bxLivechatOnlineLine1","bxLivechatOnlineLine2","bxLivechatOffline","online","operators","connectors","showForm","uploadFile","showed","reopen","dragged","textareaHeight","showConsent","consentUrl","dialogStart","dialog","sessionId","sessionClose","userConsent","operator","firstName","lastName","workPosition","avatar","user","id","hash","email","phone","www","gender","position","state","payload","Utils","types","isPlainObject","Array","uploadFilePlus","uploadFileMinus","isSaveNeeded","saveState","toString","startsWith","path","VuexBuilderModel","WidgetRestClient","params","queryAuthRestore","setAuthId","restClient","RestClient","endpoint","queryParams","cors","authId","customAuthId","livechat_auth_id","console","error","livechat_custom_auth_id","method","callback","sendCallback","logTag","getLogTrackingParams","promise","Promise","callMethod","then","fulfill","catch","ex","warn","error_description","reject","calls","bHaltOnError","resultCallback","callBatch","WidgetRestAnswerHandler","props","widget","data","store","commit","disk","addLocalize","serverVariables","getSiteId","previousData","messages","collection","controller","getChatId","chatId","dialogId","fields","entityType","type","userId","diskFolderId","length","isDialogStart","messageId","message","messagesQueue","filter","el","sendEvent","text","BaseRestAnswerHandler","WidgetImPullCommandHandler","extra","command","senderId","getUserId","onceShowed","open","WidgetImopenlinesPullCommandHandler","spam","Widget","ready","widgetDataRequested","code","language","buttonInstance","useBitrixLocalize","placeholder","getElementById","inited","initEventFired","userRegisterData","customData","localize","subscribers","dateFormat","filesQueue","filesQueueIndex","configRequestXhr","rootNode","createElement","body","firstChild","insertBefore","appendChild","template","addEventListener","device","orientation","getOrientation","application","DeviceType","mobile","DeviceOrientation","horizontal","activeElement","blur","widgetVariables","getHost","getLocalize","ApplicationController","applicationVariables","languageId","isMobile","desktop","messageLimit","getDefaultMessageLimit","VuexBuilder","addModel","create","setVariables","ApplicationModel","MessagesModel","DialoguesModel","useDatabase","UsersModel","defaultName","FilesModel","setDatabaseConfig","DatabaseType","localStorage","build","storeCollector","builder","initRestClient","setVuexStore","setRestClient","setPrepareFilesBeforeSaveFunction","prepareFileData","bind","imRestAnswer","ImRestAnswerHandler","widgetRestAnswer","dispatchEvent","CustomEvent","detail","widgetCode","widgetHost","callStartFlag","start","callOpenFlag","isUserRegistered","getUserHash","isReady","getUserHashCookie","requestData","fireInitEvent","isConfigDataLoaded","xhr","clearError","executeRestAnswer","setError","requestDataSend","abort","query","config_id","getConfigId","trace_data","getCrmTraceData","custom_data","getCustomData","ImRestMethod","imChatGet","dialog_id","imDialogMessagesGet","chat_id","limit","getRequestMessageLimit","convert_text","getUserRegisterFields","isUserAgreeConsent","consent_url","href","response","configGet","userGetResult","chatGetResult","dialogGetResult","dialogMessagesGetResult","userRegisterResult","timeShift","serverTimeResult","Math","floor","config","pullConfigResult","server","startPullClient","processSendMessages","processSendFiles","getDialogData","execute","files","map","file","md5","urlParam","urlPreview","urlShow","urlDownload","platform","isIos","version","getIosVersion","pullClient","isConnected","scheduleReconnect","resolve","PullClient","serverEnabled","configTimestamp","config_timestamp","skipCheckRevision","subscribe","ImPullCommandHandler","Status","eventStatusInteraction","pullConnectedFirstTime","status","PullStatus","Online","$root","$bitrixPullClient","$emit","stop","CloseReasons","MANUAL","restart","pullRequestMessage","getDialogUnread","readMessage","Offline","innerHTML","widgetContext","Vue","beforeCreate","$bitrixWidget","$bitrixController","$bitrixRestClient","$bitrixMessages","destroyed","templateAttached","$destroy","mutateComponent","Logger","isUnreadMessagesLoaded","sendMessage","dispatch","authorId","sending","fileInput","size","element","forEach","sendFile","stopWriting","imMessageAdd","timMessageType","fileName","fileType","getDiskFolderId","imDiskFileUpload","NAME","fileContent","generateUniqueName","imDiskFolderGet","imDiskFileCommit","upload_id","diskFolderGet","diskFileUpload","log","diskFileCommit","lastId","count","getters","getDialogId","imDialogMessagesUnread","first_id","dialogMessageUnread","find","setSendingMessageFlag","getSessionId","info","toUpperCase","form","isSessionActive","requestWidgetData","clearTimeout","openTimeout","openFromButton","wm","showById","checkBrowserVersion","BX_LIVECHAT_OLD_BROWSER","versionCompare","alert","BX_LIVECHAT_OLD_VUE","BX_LIVECHAT_OLD_VUE_DEV","isWidgetDataRequested","attachTemplate","onWidgetClose","detachTemplate","traceData","getTrace","b24Tracker","MESSAGE","BX_LIVECHAT_EXTRA_SITE","JSON","stringify","dialogues","userHash","validUserFields","field","indexOf","setNewAuthToken","authToken","clearModelState","concat","description","localizeDescription","endsWith","active","includes","phrases","phrase","WidgetPublicManager","developerInfo","__privateMethods__","__createLegacyMethods","close","showNotification","getUserData","setUserRegisterData","setCustomData","mutateTemplateComponent","LiveChat","sourceHref","sourceDomain","hostname","port","openLiveChat","closeLiveChat","eventName","handler","event","origin","action","setCookie","getCookie","BxLiveChatInit","firstMessage","BxLiveChatLoader","component","viewPortMetaSiteNode","viewPortMetaWidgetNode","storedMessage","storedFile","textareaFocused","textareaDrag","textareaMinimumHeight","textareaMaximumHeight","created","onCreated","onWindowKeyDown","$on","onRequestShowForm","beforeDestroy","removeEventListener","$off","onTextareaDragEventRemove","computed","textareaHeightStyle","getFilteredPhrases","widgetMobileDisabled","userAgent","screen","availHeight","widgetClassName","className","browser","isSafari","isIe","isMac","isDarkColor","join","showMessageDialog","messageCollection","Vuex","mapState","watch","methods","onBeforeClose","$store","showLikeForm","showFormTimeout","showWelcomeForm","showOfflineForm","showHistoryForm","hideForm","showConsentWidow","agreeConsentWidow","sendConsentDecision","onTextareaSend","focus","onTextareaFileSelected","disagreeConsentWidow","logEvent","from","head","getElementsByTagName","removeChild","contentWidth","offsetWidth","innerWidth","setAttribute","classList","add","isSafariBased","setTimeout","remove","onAfterClose","delayed","onDialogRequestHistory","getDialogHistory","onDialogRequestUnread","onDialogMessageClickByUserName","onDialogMessageClickByCommand","addMessage","onDialogMessageMenuClick","onDialogMessageRetryClick","retrySendMessage","onDialogReadMessage","onDialogClick","onTextareaWrites","startWriting","onTextareaFocus","onTextareaFocusScrollTimeout","onWindowScroll","onTextareaBlur","$nextTick","force","onTextareaStartDrag","changedTouches","textareaDragCursorStartPoint","clientY","textareaDragHeightStartPoint","onTextareaDragEventAdd","onTextareaContinueDrag","textareaDragCursorControlPoint","max","min","onTextareaStopDrag","maxFileSize","BX_LIVECHAT_FILE_SIZE_EXCEEDED","round","addFile","onTextareaAppButtonClick","appId","onPullRequestConfig","recoverPullConnection","onSmilesSelectSmile","onSmilesSelectSet","keyCode","preventDefault","stopPropagation","onWindowScrollTimeout","BX_LIVECHAT_ERROR_TITLE","BX_LIVECHAT_ERROR_DESC","isWidgetDisabled","default","customBackgroundStyle","customBackgroundOnlineStyle","showName","BX_LIVECHAT_LOADING","BX_LIVECHAT_MOBILE_ROTATE","agree","disagree","onShow","done","onHide","onKeyDown","target","$refs","iframe","shiftKey","cancel","success","nextElementSibling","previousElementSibling","directives","inserted","fieldEmail","fieldEmailTimeout","checkEmailField","formShowed","emailInput","sendForm","$parent","onFieldEnterPress","cloneComponent","fieldName","checkPhoneField","fieldPhone","showFullForm","phoneInput","nameInput","fieldNameTimeout","checkNameField","sendDialogVote","isFullForm","fieldPhoneTimeout","LiveChatWidget"],"mappings":"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"}