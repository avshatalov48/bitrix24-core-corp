{"version":3,"file":"widget.bundle.js","sources":["../src/const.js","../src/model.js","../src/utils/restclient.js","../src/rest.handler.js","../src/pull.handler.js","../src/widget.js","../src/public.js","../src/component/bx-livechat.js","../src/component/bx-livechat-body-error.js","../src/component/bx-livechat-body-head.js","../src/component/bx-livechat-body-loading.js","../src/component/bx-livechat-body-operators.js","../src/component/bx-livechat-body-orientation-disabled.js","../src/component/bx-livechat-form-consent.js","../src/component/bx-livechat-form-history.js","../src/component/bx-livechat-form-offline.js","../src/component/bx-livechat-form-vote.js","../src/component/bx-livechat-form-welcome.js","../src/component/bx-livechat-smiles.js","../src/registry.js"],"sourcesContent":["/**\n * Bitrix OpenLines widget\n * Widget constants\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nfunction GetObjectValues(source)\n{\n\tconst destination = [];\n\tfor (let value in source)\n\t{\n\t\tif (source.hasOwnProperty(value))\n\t\t{\n\t\t\tdestination.push(source[value]);\n\t\t}\n\t}\n\treturn destination;\n}\n\n/* region 01. Constants */\n\nexport const VoteType = Object.freeze({\n\tnone: 'none',\n\tlike: 'like',\n\tdislike: 'dislike',\n});\n\nexport const LanguageType = Object.freeze({\n\trussian: 'ru',\n\tukraine: 'ua',\n\tworld: 'en',\n});\n\nexport const FormType = Object.freeze({\n\tnone: 'none',\n\tlike: 'like',\n\tsmile: 'smile',\n\tconsent: 'consent',\n\twelcome: 'welcome',\n\toffline: 'offline',\n\thistory: 'history',\n});\n\nexport const LocationType = Object.freeze({\n\ttopLeft: 1,\n\ttopMiddle: 2,\n\ttopBottom: 3,\n\tbottomLeft: 6,\n\tbottomMiddle: 5,\n\tbottomRight: 4,\n});\n\nexport const LocationStyle = Object.freeze({\n\t1: 'top-left',\n\t2: 'top-center',\n\t3: 'top-right',\n\t6: 'bottom-left',\n\t5: 'bottom-center',\n\t4: 'bottom-right',\n});\n\nexport const SubscriptionType = Object.freeze({\n\tconfigLoaded: 'configLoaded',\n\twidgetOpen: 'widgetOpen',\n\twidgetClose: 'widgetClose',\n\tsessionStart: 'sessionStart',\n\tsessionOperatorChange: 'sessionOperatorChange',\n\tsessionFinish: 'sessionFinish',\n\toperatorMessage: 'operatorMessage',\n\tuserForm: 'userForm',\n\tuserMessage: 'userMessage',\n\tuserFile: 'userFile',\n\tuserVote: 'userVote',\n\tevery: 'every',\n});\nexport const SubscriptionTypeCheck = GetObjectValues(SubscriptionType);\n\nexport const RestMethod = Object.freeze({\n\twidgetUserRegister: 'imopenlines.widget.user.register',\n\twidgetConfigGet: 'imopenlines.widget.config.get',\n\twidgetDialogGet: 'imopenlines.widget.dialog.get',\n\twidgetUserGet: 'imopenlines.widget.user.get',\n\twidgetUserConsentApply: 'imopenlines.widget.user.consent.apply',\n\twidgetVoteSend: 'imopenlines.widget.vote.send',\n\twidgetFormSend: 'imopenlines.widget.form.send',\n\twidgetActionSend: 'imopenlines.widget.action.send',\n\tpullServerTime: 'server.time',\n\tpullConfigGet: 'pull.config.get',\n});\nexport const RestMethodCheck = GetObjectValues(RestMethod);\n\nexport const RestAuth = Object.freeze({\n\tguest: 'guest',\n});\n\nexport const SessionStatus = Object.freeze({\n\tnew: 0,\n\tskip: 5,\n\tanswer: 10,\n\tclient: 20,\n\tclientAfterOperator: 25,\n\toperator: 40,\n\twaitClient: 50,\n\tclose: 60,\n\tspam: 65,\n\tduplicate: 69,\n\tsilentlyClose: 75,\n});\n\nexport const EventType = Object.freeze({\n\trequestShowForm: 'IMOL.Widget:requestShowForm',\n});","/**\n * Bitrix OpenLines widget\n * Widget model (Vuex Builder model)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {VuexBuilderModel} from 'ui.vue.vuex';\n\nimport {Utils} from 'im.lib.utils';\nimport {Cookie} from \"im.lib.cookie\";\nimport {FormType, LocationStyle, LocationType, VoteType} from \"./const\";\n\nexport class WidgetModel extends VuexBuilderModel\n{\n\t/**\n\t * @inheritDoc\n\t */\n\tgetName()\n\t{\n\t\treturn 'widget';\n\t}\n\n\tgetState()\n\t{\n\t\treturn {\n\t\t\tcommon:\n\t\t\t{\n\t\t\t\tconfigId: 0,\n\t\t\t\tconfigName: '',\n\t\t\t\thost: this.getVariable('common.host', location.protocol+'//'+location.host),\n\t\t\t\tpageMode: this.getVariable('common.pageMode', false),\n\t\t\t\tcopyright: this.getVariable('common.copyright', true),\n\t\t\t\tcopyrightUrl: this.getVariable('common.copyrightUrl', 'https://bitrix24.com'),\n\t\t\t\tlocation: this.getVariable('common.location', LocationType.bottomRight),\n\t\t\t\tstyles: {\n\t\t\t\t\tbackgroundColor: this.getVariable('styles.backgroundColor', '#17a3ea'),\n\t\t\t\t\ticonColor: this.getVariable('styles.iconColor', '#ffffff')\n\t\t\t\t},\n\t\t\t\tvote: {\n\t\t\t\t\tenable: false,\n\t\t\t\t\tbeforeFinish: true,\n\t\t\t\t\tmessageText: this.getVariable('vote.messageText', ''),\n\t\t\t\t\tmessageLike: this.getVariable('vote.messageLike', ''),\n\t\t\t\t\tmessageDislike: this.getVariable('vote.messageDislike', '')\n\t\t\t\t},\n\t\t\t\ttextMessages: {\n\t\t\t\t\tbxLivechatOnlineLine1: this.getVariable('textMessages.bxLivechatOnlineLine1', ''),\n\t\t\t\t\tbxLivechatOnlineLine2: this.getVariable('textMessages.bxLivechatOnlineLine2', ''),\n\t\t\t\t\tbxLivechatOffline: this.getVariable('textMessages.bxLivechatOffline', ''),\n\t\t\t\t\tbxLivechatTitle: '',\n\t\t\t\t},\n\t\t\t\tonline: false,\n\t\t\t\toperators: [],\n\t\t\t\tconnectors: [],\n\t\t\t\tshowForm: FormType.none,\n\t\t\t\tshowed: false,\n\t\t\t\treopen: false,\n\t\t\t\tdragged: false,\n\t\t\t\ttextareaHeight: 0,\n\t\t\t\twidgetHeight: 0,\n\t\t\t\twidgetWidth: 0,\n\t\t\t\tshowConsent: false,\n\t\t\t\tconsentUrl: '',\n\t\t\t\tdialogStart: false,\n\t\t\t\twatchTyping: false,\n\t\t\t\tshowSessionId: false,\n\t\t\t},\n\t\t\tdialog:\n\t\t\t{\n\t\t\t\tsessionId: 0,\n\t\t\t\tsessionClose: true,\n\t\t\t\tsessionStatus: 0,\n\t\t\t\tuserVote: VoteType.none,\n\t\t\t\tcloseVote: false,\n\t\t\t\tuserConsent: false,\n\t\t\t\toperatorChatId: 0,\n\t\t\t\toperator: {\n\t\t\t\t\tid: 0,\n\t\t\t\t\tname: '',\n\t\t\t\t\tfirstName: '',\n\t\t\t\t\tlastName: '',\n\t\t\t\t\tworkPosition: '',\n\t\t\t\t\tavatar: '',\n\t\t\t\t\tonline: false,\n\t\t\t\t}\n\t\t\t},\n\t\t\tuser:\n\t\t\t{\n\t\t\t\tid: -1,\n\t\t\t\thash: '',\n\t\t\t\tname: '',\n\t\t\t\tfirstName: '',\n\t\t\t\tlastName: '',\n\t\t\t\tavatar: '',\n\t\t\t\temail: '',\n\t\t\t\tphone: '',\n\t\t\t\twww: '',\n\t\t\t\tgender: 'M',\n\t\t\t\tposition: '',\n\t\t\t},\n\t\t}\n\t}\n\n\tgetStateSaveException()\n\t{\n\t\treturn {\n\t\t\tcommon: {\n\t\t\t\thost: null,\n\t\t\t\tpageMode: null,\n\t\t\t\tcopyright: null,\n\t\t\t\tcopyrightUrl: null,\n\t\t\t\tstyles: null,\n\t\t\t\tdragged: null,\n\t\t\t\tshowed: null,\n\t\t\t\tshowConsent: null,\n\t\t\t\tshowForm: null,\n\t\t\t},\n\t\t}\n\t}\n\n\tgetMutations()\n\t{\n\t\treturn {\n\n\t\t\tcommon: (state, payload) =>\n\t\t\t{\n\t\t\t\tif (typeof payload.configId === 'number')\n\t\t\t\t{\n\t\t\t\t\tstate.common.configId = payload.configId;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.configName === 'string')\n\t\t\t\t{\n\t\t\t\t\tstate.common.configName = payload.configName;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.online === 'boolean')\n\t\t\t\t{\n\t\t\t\t\tstate.common.online = payload.online;\n\t\t\t\t}\n\t\t\t\tif (Utils.types.isPlainObject(payload.vote))\n\t\t\t\t{\n\t\t\t\t\tif (typeof payload.vote.enable === 'boolean')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.common.vote.enable = payload.vote.enable;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.vote.beforeFinish === 'boolean')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.common.vote.beforeFinish = payload.vote.beforeFinish;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.vote.messageText === 'string')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.common.vote.messageText = payload.vote.messageText;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.vote.messageLike === 'string')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.common.vote.messageLike = payload.vote.messageLike;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.vote.messageDislike === 'string')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.common.vote.messageDislike = payload.vote.messageDislike;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (Utils.types.isPlainObject(payload.textMessages))\n\t\t\t\t{\n\t\t\t\t\tif (typeof payload.textMessages.bxLivechatOnlineLine1 === 'string' && payload.textMessages.bxLivechatOnlineLine1 !== '')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.common.textMessages.bxLivechatOnlineLine1 = payload.textMessages.bxLivechatOnlineLine1;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.textMessages.bxLivechatOnlineLine2 === 'string' && payload.textMessages.bxLivechatOnlineLine2 !== '')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.common.textMessages.bxLivechatOnlineLine2 = payload.textMessages.bxLivechatOnlineLine2;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.textMessages.bxLivechatOffline === 'string' && payload.textMessages.bxLivechatOffline !== '')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.common.textMessages.bxLivechatOffline = payload.textMessages.bxLivechatOffline;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.textMessages.bxLivechatTitle === 'string' && payload.textMessages.bxLivechatTitle !== '')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.common.textMessages.bxLivechatTitle = payload.textMessages.bxLivechatTitle;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (typeof payload.dragged === 'boolean')\n\t\t\t\t{\n\t\t\t\t\tstate.common.dragged = payload.dragged;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.textareaHeight === 'number')\n\t\t\t\t{\n\t\t\t\t\tstate.common.textareaHeight = payload.textareaHeight;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.widgetHeight === 'number')\n\t\t\t\t{\n\t\t\t\t\tstate.common.widgetHeight = payload.widgetHeight;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.widgetWidth === 'number')\n\t\t\t\t{\n\t\t\t\t\tstate.common.widgetWidth = payload.widgetWidth;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.showConsent === 'boolean')\n\t\t\t\t{\n\t\t\t\t\tstate.common.showConsent = payload.showConsent;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.consentUrl === 'string')\n\t\t\t\t{\n\t\t\t\t\tstate.common.consentUrl = payload.consentUrl;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.showed === 'boolean')\n\t\t\t\t{\n\t\t\t\t\tstate.common.showed = payload.showed;\n\t\t\t\t\tpayload.reopen = Utils.device.isMobile()? false: payload.showed;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.reopen === 'boolean')\n\t\t\t\t{\n\t\t\t\t\tstate.common.reopen = payload.reopen;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.copyright === 'boolean')\n\t\t\t\t{\n\t\t\t\t\tstate.common.copyright = payload.copyright;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.dialogStart === 'boolean')\n\t\t\t\t{\n\t\t\t\t\tstate.common.dialogStart = payload.dialogStart;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.watchTyping === 'boolean')\n\t\t\t\t{\n\t\t\t\t\tstate.common.watchTyping = payload.watchTyping;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.showSessionId === 'boolean')\n\t\t\t\t{\n\t\t\t\t\tstate.common.showSessionId = payload.showSessionId;\n\t\t\t\t}\n\t\t\t\tif (payload.operators instanceof Array)\n\t\t\t\t{\n\t\t\t\t\tstate.common.operators = payload.operators;\n\t\t\t\t}\n\t\t\t\tif (payload.connectors instanceof Array)\n\t\t\t\t{\n\t\t\t\t\tstate.common.connectors = payload.connectors;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.showForm === 'string' && typeof FormType[payload.showForm] !== 'undefined')\n\t\t\t\t{\n\t\t\t\t\tif (payload.showForm === FormType.like && !!state.dialog.closeVote)\n\t\t\t\t\t{\n\t\t\t\t\t\tpayload.showForm = FormType.none;\n\t\t\t\t\t}\n\t\t\t\t\tstate.common.showForm = payload.showForm;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.location === 'number' && typeof LocationStyle[payload.location] !== 'undefined')\n\t\t\t\t{\n\t\t\t\t\tif (state.common.location !== payload.location)\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.common.widgetHeight = 0;\n\t\t\t\t\t\tstate.common.widgetWidth = 0;\n\t\t\t\t\t\tstate.common.location = payload.location;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (this.isSaveNeeded({common: payload}))\n\t\t\t\t{\n\t\t\t\t\tthis.saveState(state);\n\t\t\t\t}\n\t\t\t},\n\t\t\tdialog: (state, payload) =>\n\t\t\t{\n\t\t\t\tif (typeof payload.sessionId === 'number')\n\t\t\t\t{\n\t\t\t\t\tstate.dialog.sessionId = payload.sessionId;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.sessionClose === 'boolean')\n\t\t\t\t{\n\t\t\t\t\tstate.dialog.sessionClose = payload.sessionClose;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.sessionStatus === 'number')\n\t\t\t\t{\n\t\t\t\t\tstate.dialog.sessionStatus = payload.sessionStatus;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.userConsent === 'boolean')\n\t\t\t\t{\n\t\t\t\t\tstate.dialog.userConsent = payload.userConsent;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.userVote === 'string' && typeof payload.userVote !== 'undefined')\n\t\t\t\t{\n\t\t\t\t\tstate.dialog.userVote = payload.userVote;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.closeVote === 'boolean')\n\t\t\t\t{\n\t\t\t\t\tstate.dialog.closeVote = payload.closeVote;\n\n\t\t\t\t\tif (\n\t\t\t\t\t\t!!payload.closeVote\n\t\t\t\t\t\t&& state.common.showForm === FormType.like\n\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.common.showForm = FormType.none;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (typeof payload.operatorChatId === 'number')\n\t\t\t\t{\n\t\t\t\t\tstate.dialog.operatorChatId = payload.operatorChatId;\n\t\t\t\t}\n\t\t\t\tif (Utils.types.isPlainObject(payload.operator))\n\t\t\t\t{\n\t\t\t\t\tif (typeof payload.operator.id === 'number')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.dialog.operator.id = payload.operator.id;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.operator.name === 'string' || typeof payload.operator.name === 'number')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.dialog.operator.name = payload.operator.name.toString();\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.operator.lastName === 'string' || typeof payload.operator.lastName === 'number')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.dialog.operator.lastName = payload.operator.lastName.toString();\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.operator.firstName === 'string' || typeof payload.operator.firstName === 'number')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.dialog.operator.firstName = payload.operator.firstName.toString();\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.operator.workPosition === 'string' || typeof payload.operator.workPosition === 'number')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.dialog.operator.workPosition = payload.operator.workPosition.toString();\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.operator.avatar === 'string')\n\t\t\t\t\t{\n\t\t\t\t\t\tif (!payload.operator.avatar || payload.operator.avatar.startsWith('http'))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tstate.dialog.operator.avatar = payload.operator.avatar;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tstate.dialog.operator.avatar = state.common.host+payload.operator.avatar;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.operator.online === 'boolean')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.dialog.operator.online = payload.operator.online;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (this.isSaveNeeded({dialog: payload}))\n\t\t\t\t{\n\t\t\t\t\tthis.saveState(state);\n\t\t\t\t}\n\t\t\t},\n\t\t\tuser: (state, payload) =>\n\t\t\t{\n\t\t\t\tif (typeof payload.id === 'number')\n\t\t\t\t{\n\t\t\t\t\tstate.user.id = payload.id;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.hash === 'string' && payload.hash !== state.user.hash)\n\t\t\t\t{\n\t\t\t\t\tstate.user.hash = payload.hash;\n\t\t\t\t\tCookie.set(null, 'LIVECHAT_HASH', payload.hash, {expires: 365*86400, path: '/'});\n\t\t\t\t}\n\t\t\t\tif (typeof payload.name === 'string' || typeof payload.name === 'number')\n\t\t\t\t{\n\t\t\t\t\tstate.user.name = payload.name.toString();\n\t\t\t\t}\n\t\t\t\tif (typeof payload.firstName === 'string' || typeof payload.firstName === 'number')\n\t\t\t\t{\n\t\t\t\t\tstate.user.firstName = payload.firstName.toString();\n\t\t\t\t}\n\t\t\t\tif (typeof payload.lastName === 'string' || typeof payload.lastName === 'number')\n\t\t\t\t{\n\t\t\t\t\tstate.user.lastName = payload.lastName.toString();\n\t\t\t\t}\n\t\t\t\tif (typeof payload.avatar === 'string')\n\t\t\t\t{\n\t\t\t\t\tstate.user.avatar = payload.avatar;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.email === 'string')\n\t\t\t\t{\n\t\t\t\t\tstate.user.email = payload.email;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.phone === 'string' || typeof payload.phone === 'number')\n\t\t\t\t{\n\t\t\t\t\tstate.user.phone = payload.phone.toString();\n\t\t\t\t}\n\t\t\t\tif (typeof payload.www === 'string')\n\t\t\t\t{\n\t\t\t\t\tstate.user.www = payload.www;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.gender === 'string')\n\t\t\t\t{\n\t\t\t\t\tstate.user.gender = payload.gender;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.position === 'string')\n\t\t\t\t{\n\t\t\t\t\tstate.user.position = payload.position;\n\t\t\t\t}\n\n\t\t\t\tif (this.isSaveNeeded({user: payload}))\n\t\t\t\t{\n\t\t\t\t\tthis.saveState(state);\n\t\t\t\t}\n\t\t\t},\n\t\t}\n\t}\n\n\tgetActions()\n\t{\n\t\treturn {\n\t\t\tshow: ({ commit }) =>\n\t\t\t{\n\t\t\t\tcommit('common', {showed: true});\n\t\t\t},\n\t\t\tsetVoteDateFinish: ({ commit, dispatch, state }, payload) =>\n\t\t\t{\n\t\t\t\tif (!payload)\n\t\t\t\t{\n\t\t\t\t\tclearTimeout(this.setVoteDateTimeout);\n\t\t\t\t\tcommit('dialog', {closeVote: false});\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\tconst totalDelay = new Date(payload).getTime() - new Date().getTime();\n\t\t\t\tconst dayTimestamp = 10000;\n\t\t\t\tclearTimeout(this.setVoteDateTimeout);\n\n\t\t\t\tif (payload)\n\t\t\t\t{\n\t\t\t\t\tif (totalDelay && !state.dialog.closeVote)\n\t\t\t\t\t{\n\t\t\t\t\t\tcommit('dialog', {closeVote: false});\n\t\t\t\t\t}\n\n\t\t\t\t\tvar delay = totalDelay;\n\n\t\t\t\t\tif(totalDelay > dayTimestamp)\n\t\t\t\t\t{\n\t\t\t\t\t\tdelay = dayTimestamp;\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.setVoteDateTimeout = setTimeout(function requestCloseVote() {\n\t\t\t\t\t\tdelay = new Date(payload).getTime() - new Date().getTime();\n\t\t\t\t\t\tif(delay > 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif(delay > dayTimestamp)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tdelay = dayTimestamp;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tsetTimeout(requestCloseVote, delay);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcommit('dialog', {closeVote: true});\n\t\t\t\t\t\t}\n\t\t\t\t\t}, delay);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}","/**\n * Bitrix OpenLines widget\n * Rest client (base on BX.RestClient)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\n// TODO change BX.RestClient, BX.promise to import\n\nimport {Utils} from \"im.lib.utils\";\nimport {RestAuth, RestMethod} from \"../const\";\nimport {RestClient} from \"rest.client\";\n\nexport class WidgetRestClient\n{\n\tconstructor(params)\n\t{\n\t\tthis.queryAuthRestore = false;\n\n\t\tthis.setAuthId(RestAuth.guest);\n\n\t\tthis.restClient = new RestClient({\n\t\t\tendpoint: params.endpoint,\n\t\t\tqueryParams: this.queryParams,\n\t\t\tcors: true\n\t\t});\n\t}\n\n\tsetAuthId(authId, customAuthId = '')\n\t{\n\t\tif (typeof this.queryParams !== 'object')\n\t\t{\n\t\t\tthis.queryParams = {};\n\t\t}\n\n\t\tif (\n\t\t\tauthId == RestAuth.guest\n\t\t\t|| typeof authId === 'string' && authId.match(/^[a-f0-9]{32}$/)\n\t\t)\n\t\t{\n\t\t\tthis.queryParams.livechat_auth_id = authId;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconsole.error(`%LiveChatRestClient.setAuthId: auth is not correct (%c${authId}%c)`, \"color: black;\", \"font-weight: bold; color: red\", \"color: black\");\n\t\t\treturn false;\n\t\t}\n\n\t\tif (\n\t\t\tauthId == RestAuth.guest\n\t\t\t&& typeof customAuthId === 'string' && customAuthId.match(/^[a-f0-9]{32}$/)\n\t\t)\n\t\t{\n\t\t\tthis.queryParams.livechat_custom_auth_id = customAuthId;\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tgetAuthId()\n\t{\n\t\tif (typeof this.queryParams !== 'object')\n\t\t{\n\t\t\tthis.queryParams = {};\n\t\t}\n\n\t\treturn this.queryParams.livechat_auth_id || null;\n\t}\n\n\tcallMethod(method, params, callback, sendCallback, logTag = null)\n\t{\n\t\tif (!logTag)\n\t\t{\n\t\t\tlogTag = Utils.getLogTrackingParams({\n\t\t\t\tname: method,\n\t\t\t});\n\t\t}\n\n\t\tconst promise = new BX.Promise();\n\n\t\t// TODO: Callbacks methods will not work!\n\t\tthis.restClient.callMethod(method, params, null, sendCallback, logTag).then(result => {\n\n\t\t\tthis.queryAuthRestore = false;\n\t\t\tpromise.fulfill(result);\n\n\t\t}).catch(result => {\n\n\t\t\tlet error = result.error();\n\t\t\tif (error.ex.error == 'LIVECHAT_AUTH_WIDGET_USER')\n\t\t\t{\n\t\t\t\tthis.setAuthId(error.ex.hash);\n\n\t\t\t\tif (method === RestMethod.widgetUserRegister)\n\t\t\t\t{\n\t\t\t\t\tconsole.warn(`BX.LiveChatRestClient: ${error.ex.error_description} (${error.ex.error})`);\n\n\t\t\t\t\tthis.queryAuthRestore = false;\n\t\t\t\t\tpromise.reject(result);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tif (!this.queryAuthRestore)\n\t\t\t\t{\n\t\t\t\t\tconsole.warn('BX.LiveChatRestClient: your auth-token has expired, send query with a new token');\n\n\t\t\t\t\tthis.queryAuthRestore = true;\n\t\t\t\t\tthis.restClient.callMethod(method, params, null, sendCallback, logTag).then(result => {\n\t\t\t\t\t\tthis.queryAuthRestore = false;\n\t\t\t\t\t\tpromise.fulfill(result);\n\t\t\t\t\t}).catch(result => {\n\t\t\t\t\t\tthis.queryAuthRestore = false;\n\t\t\t\t\t\tpromise.reject(result);\n\t\t\t\t\t});\n\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.queryAuthRestore = false;\n\t\t\tpromise.reject(result);\n\t\t});\n\n\t\treturn promise;\n\t};\n\n\tcallBatch(calls, callback, bHaltOnError, sendCallback, logTag)\n\t{\n\t\tlet resultCallback = (result) =>\n\t\t{\n\t\t\tlet error = null;\n\t\t\tfor (let method in calls)\n\t\t\t{\n\t\t\t\tif (!calls.hasOwnProperty(method))\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tlet error = result[method].error();\n\t\t\t\tif (error && error.ex.error == 'LIVECHAT_AUTH_WIDGET_USER')\n\t\t\t\t{\n\t\t\t\t\tthis.setAuthId(error.ex.hash);\n\t\t\t\t\tif (method === RestMethod.widgetUserRegister)\n\t\t\t\t\t{\n\t\t\t\t\t\tconsole.warn(`BX.LiveChatRestClient: ${error.ex.error_description} (${error.ex.error})`);\n\n\t\t\t\t\t\tthis.queryAuthRestore = false;\n\t\t\t\t\t\tcallback(result);\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!this.queryAuthRestore)\n\t\t\t\t\t{\n\t\t\t\t\t\tconsole.warn('BX.LiveChatRestClient: your auth-token has expired, send query with a new token');\n\n\t\t\t\t\t\tthis.queryAuthRestore = true;\n\t\t\t\t\t\tthis.restClient.callBatch(calls, callback, bHaltOnError, sendCallback, logTag);\n\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.queryAuthRestore = false;\n\t\t\tcallback(result);\n\n\t\t\treturn true;\n\t\t};\n\n\t\treturn this.restClient.callBatch(calls, resultCallback, bHaltOnError, sendCallback, logTag);\n\t};\n}","/**\n * Bitrix OpenLines widget\n * Widget Rest answers (Rest Answer Handler)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {BaseRestHandler} from \"im.provider.rest\";\nimport {LocalStorage} from \"im.lib.localstorage\";\nimport {SubscriptionType} from \"./const\";\n\nclass WidgetRestAnswerHandler extends BaseRestHandler\n{\n\tconstructor(props = {})\n\t{\n\t\tsuper(props);\n\n\t\tthis.widget = props.widget;\n\t}\n\n\thandleImopenlinesWidgetConfigGetSuccess(data)\n\t{\n\t\tthis.store.commit('widget/common', {\n\t\t\tconfigId: data.configId,\n\t\t\tconfigName: data.configName,\n\t\t\tvote: data.vote,\n\t\t\ttextMessages: data.textMessages,\n\t\t\toperators: data.operators || [],\n\t\t\tonline: data.online,\n\t\t\tconsentUrl: data.consentUrl,\n\t\t\tconnectors: data.connectors || [],\n\t\t\twatchTyping: data.watchTyping,\n\t\t\tshowSessionId: data.showSessionId,\n\t\t});\n\n\t\tthis.store.commit('application/set', {disk: data.disk});\n\n\t\tthis.widget.addLocalize(data.serverVariables);\n\t\tLocalStorage.set(this.widget.getSiteId(), 0, 'serverVariables', data.serverVariables || {});\n\t}\n\n\thandleImopenlinesWidgetUserRegisterSuccess(data)\n\t{\n\t\tthis.widget.restClient.setAuthId(data.hash);\n\n\t\tlet previousData = [];\n\t\tif (typeof this.store.state.messages.collection[this.controller.application.getChatId()] !== 'undefined')\n\t\t{\n\t\t\tpreviousData = this.store.state.messages.collection[this.controller.application.getChatId()];\n\t\t}\n\t\tthis.store.commit('messages/initCollection', {chatId: data.chatId, messages: previousData});\n\n\t\tthis.store.commit('dialogues/initCollection', {dialogId: data.dialogId, fields: {\n\t\t\tentityType: 'LIVECHAT',\n\t\t\ttype: 'livechat'\n\t\t}});\n\n\t\tthis.store.commit('application/set', {dialog: {\n\t\t\tchatId: data.chatId,\n\t\t\tdialogId: 'chat'+data.chatId\n\t\t}});\n\t}\n\n\thandleImopenlinesWidgetUserGetSuccess(data)\n\t{\n\t\tthis.store.commit('widget/user', {\n\t\t\tid: data.id,\n\t\t\thash: data.hash,\n\t\t\tname: data.name,\n\t\t\tfirstName: data.firstName,\n\t\t\tlastName: data.lastName,\n\t\t\tphone: data.phone,\n\t\t\tavatar: data.avatar,\n\t\t\temail: data.email,\n\t\t\twww: data.www,\n\t\t\tgender: data.gender,\n\t\t\tposition: data.position,\n\t\t});\n\t\tthis.store.dispatch('users/set', [{\n\t\t\tid: data.id,\n\t\t\tname: data.name,\n\t\t\tfirstName: data.firstName,\n\t\t\tlastName: data.lastName,\n\t\t\tavatar: data.avatar,\n\t\t\tgender: data.gender,\n\t\t\tworkPosition: data.position,\n\t\t}]);\n\t\tthis.store.commit('application/set', {common: {\n\t\t\tuserId: data.id\n\t\t}});\n\t}\n\n\thandleImopenlinesWidgetDialogGetSuccess(data)\n\t{\n\t\tthis.store.commit('messages/initCollection', {chatId: data.chatId});\n\n\t\tthis.store.commit('widget/dialog', data);\n\n\t\tthis.store.commit('application/set', {dialog: {\n\t\t\tchatId: data.chatId,\n\t\t\tdialogId: 'chat'+data.chatId,\n\t\t\tdiskFolderId: data.diskFolderId,\n\t\t}});\n\n\t\tthis.store.dispatch('widget/setVoteDateFinish', data.dateCloseVote);\n\t}\n\n\thandleImDialogMessagesGetInitSuccess(data)\n\t{\n\t\tthis.handleImDialogMessagesGetSuccess(data);\n\t}\n\n\thandleImDialogMessagesGetSuccess(data)\n\t{\n\t\tif (data.messages && data.messages.length > 0 && !this.widget.isDialogStart())\n\t\t{\n\t\t\tthis.store.commit('widget/common', {\n\t\t\t\tdialogStart: true\n\t\t\t});\n\t\t\tthis.store.commit('widget/dialog', {\n\t\t\t\tuserConsent: true\n\t\t\t});\n\t\t}\n\t}\n\n\thandleImMessageAddSuccess(messageId, message)\n\t{\n\t\tthis.widget.messagesQueue = this.widget.messagesQueue.filter(el => el.id != message.id);\n\n\t\tthis.widget.sendEvent({\n\t\t\ttype: SubscriptionType.userMessage,\n\t\t\tdata: {\n\t\t\t\tid: messageId,\n\t\t\t\ttext: message.text\n\t\t\t}\n\t\t});\n\t}\n\n\thandleImMessageAddError(error, message)\n\t{\n\t\tthis.widget.messagesQueue = this.widget.messagesQueue.filter(el => el.id != message.id);\n\t}\n\n\thandleImDiskFileCommitSuccess(result, message)\n\t{\n\t\tthis.widget.messagesQueue = this.widget.messagesQueue.filter(el => el.id != message.id);\n\n\t\tthis.widget.sendEvent({\n\t\t\ttype: SubscriptionType.userFile,\n\t\t\tdata: {}\n\t\t});\n\t}\n}\n\nexport {WidgetRestAnswerHandler};","/**\n * Bitrix OpenLines widget\n * Widget pull commands (Pull Command Handler)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {SubscriptionType, VoteType} from \"./const\";\n\nclass WidgetImPullCommandHandler\n{\n\tstatic create(params = {})\n\t{\n\t\treturn new this(params);\n\t}\n\n\tgetModuleId()\n\t{\n\t\treturn 'im';\n\t}\n\n\tconstructor(params)\n\t{\n\t\tthis.controller = params.controller;\n\t\tthis.store = params.store;\n\t\tthis.widget = params.widget;\n\t}\n\n\thandleMessageChat(params, extra, command)\n\t{\n\t\tif (params.message.senderId != this.controller.application.getUserId())\n\t\t{\n\t\t\tthis.widget.sendEvent({\n\t\t\t\ttype: SubscriptionType.operatorMessage,\n\t\t\t\tdata: params\n\t\t\t});\n\n\t\t\tif (!this.store.state.widget.common.showed && !this.widget.onceShowed)\n\t\t\t{\n\t\t\t\tthis.widget.onceShowed = true;\n\t\t\t\tthis.widget.open();\n\t\t\t}\n\t\t}\n\t}\n}\n\nclass WidgetImopenlinesPullCommandHandler\n{\n\tstatic create(params = {})\n\t{\n\t\treturn new this(params);\n\t}\n\n\tconstructor(params = {})\n\t{\n\t\tthis.controller = params.controller;\n\t\tthis.store = params.store;\n\t\tthis.widget = params.widget;\n\t}\n\n\tgetModuleId()\n\t{\n\t\treturn 'imopenlines';\n\t}\n\n\thandleSessionStart(params, extra, command)\n\t{\n\t\tthis.store.commit('widget/dialog', {\n\t\t\tsessionId: params.sessionId,\n\t\t\tsessionClose: false,\n\t\t\tsessionStatus: 0,\n\t\t\tuserVote: VoteType.none,\n\t\t});\n\n\t\tthis.store.dispatch('widget/setVoteDateFinish', '');\n\n\t\tthis.widget.sendEvent({\n\t\t\ttype: SubscriptionType.sessionStart,\n\t\t\tdata: {\n\t\t\t\tsessionId: params.sessionId\n\t\t\t}\n\t\t});\n\t}\n\n\thandleSessionOperatorChange(params, extra, command)\n\t{\n\t\tthis.store.commit('widget/dialog', {\n\t\t\toperator: params.operator,\n\t\t\toperatorChatId: params.operatorChatId\n\t\t});\n\n\t\tthis.widget.sendEvent({\n\t\t\ttype: SubscriptionType.sessionOperatorChange,\n\t\t\tdata: {\n\t\t\t\toperator: params.operator\n\t\t\t}\n\t\t});\n\t}\n\n\thandleSessionStatus(params, extra, command)\n\t{\n\t\tthis.store.commit('widget/dialog', {\n\t\t\tsessionId: params.sessionId,\n\t\t\tsessionStatus: params.sessionStatus,\n\t\t\tsessionClose: params.sessionClose,\n\t\t});\n\n\t\tthis.widget.sendEvent({\n\t\t\ttype: SubscriptionType.sessionStatus,\n\t\t\tdata: {\n\t\t\t\tsessionId: params.sessionId,\n\t\t\t\tsessionStatus: params.sessionStatus\n\t\t\t}\n\t\t});\n\n\t\tif (params.sessionClose)\n\t\t{\n\t\t\tthis.widget.sendEvent({\n\t\t\t\ttype: SubscriptionType.sessionFinish,\n\t\t\t\tdata: {\n\t\t\t\t\tsessionId: params.sessionId,\n\t\t\t\t\tsessionStatus: params.sessionStatus\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (!params.spam)\n\t\t\t{\n\t\t\t\tthis.store.commit('widget/dialog', {\n\t\t\t\t\toperator: {\n\t\t\t\t\t\tname: '',\n\t\t\t\t\t\tfirstName: '',\n\t\t\t\t\t\tlastName: '',\n\t\t\t\t\t\tworkPosition: '',\n\t\t\t\t\t\tavatar: '',\n\t\t\t\t\t\tonline: false,\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\thandleSessionDateCloseVote(params, extra, command)\n\t{\n\t\tthis.store.dispatch('widget/setVoteDateFinish', params.dateCloseVote);\n\t}\n}\n\nexport {\n\tWidgetImPullCommandHandler,\n\tWidgetImopenlinesPullCommandHandler,\n};","/**\n * Bitrix OpenLines widget\n * Widget private interface (base class)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2020 Bitrix\n */\n\n// widget files\nimport {\n\tVoteType,\n\tLocationStyle,\n\tSubscriptionType,\n\tSubscriptionTypeCheck,\n\tRestMethod,\n\tRestAuth,\n} from \"./const\";\n\nimport {WidgetModel} from \"./model\";\nimport {WidgetRestClient} from \"./utils/restclient\"\nimport {WidgetRestAnswerHandler} from \"./rest.handler\";\nimport {WidgetImPullCommandHandler, WidgetImopenlinesPullCommandHandler} from \"./pull.handler\";\n\n// main\nimport {md5} from \"main.md5\";\nimport \"main.date\";\n\n// pull\nimport {PullClient} from \"pull.client\";\n\n// ui\nimport {Vue} from \"ui.vue\";\nimport {VuexBuilder} from \"ui.vue.vuex\";\n\n// messenger files\nimport {Controller} from 'im.controller';\nimport {\n\tRestMethod as ImRestMethod,\n\tRestMethodHandler as ImRestMethodHandler,\n\tEventType,\n\tFileStatus\n} from 'im.const';\n\nimport {Cookie} from \"im.lib.cookie\";\nimport {Utils} from \"im.lib.utils\";\nimport {LocalStorage} from \"im.lib.localstorage\";\nimport {Logger} from \"im.lib.logger\";\n\nimport {Uploader} from \"im.lib.uploader\";\nimport { EventEmitter } from \"main.core.events\";\nimport { ZIndexManager } from \"main.core.minimal\";\n\n// TODO change BX.Promise, BX.Main.Date to IMPORT\n\nexport class Widget\n{\n/* region 01. Initialize and store data */\n\n\tconstructor(params = {})\n\t{\n\t\tthis.params = params;\n\n\t\tthis.template = null;\n\t\tthis.rootNode = this.params.node || document.createElement('div');\n\n\t\tthis.messagesQueue = [];\n\n\t\tthis.ready = true;\n\t\tthis.widgetDataRequested = false;\n\t\tthis.offline = false;\n\n\t\tthis.inited = false;\n\t\tthis.initEventFired = false;\n\n\t\tthis.restClient = null;\n\n\t\tthis.userRegisterData = {};\n\t\tthis.customData = [];\n\n\t\tthis.subscribers = {};\n\n\t\tthis.configRequestXhr = null;\n\n\t\tthis.initParams()\n\t\t\t.then(() => this.initRestClient())\n\t\t\t.then(() => this.initPullClient())\n\t\t\t.then(() => this.initCore())\n\t\t\t.then(() => this.initWidget())\n\t\t\t.then(() => this.initUploader())\n\t\t\t.then(() => this.initComplete())\n\t\t;\n\t}\n\n\tinitParams()\n\t{\n\t\tthis.code = this.params.code || '';\n\t\tthis.host = this.params.host || '';\n\t\tthis.language = this.params.language || 'en';\n\t\tthis.copyright = this.params.copyright !== false;\n\t\tthis.copyrightUrl = this.copyright && this.params.copyrightUrl? this.params.copyrightUrl: '';\n\t\tthis.buttonInstance = typeof this.params.buttonInstance === 'object' && this.params.buttonInstance !== null? this.params.buttonInstance: null;\n\n\t\tthis.pageMode = typeof this.params.pageMode === 'object' && this.params.pageMode;\n\t\tif (this.pageMode)\n\t\t{\n\t\t\tthis.pageMode.useBitrixLocalize = this.params.pageMode.useBitrixLocalize === true;\n\t\t\tthis.pageMode.placeholder = document.getElementById(this.params.pageMode.placeholder);\n\t\t}\n\n\t\tif (typeof this.code === 'string')\n\t\t{\n\t\t\tif (this.code.length <= 0)\n\t\t\t{\n\t\t\t\tconsole.warn(`%cLiveChatWidget.constructor: code is not correct (%c${this.code}%c)`, \"color: black;\", \"font-weight: bold; color: red\", \"color: black\");\n\t\t\t\tthis.ready = false;\n\t\t\t}\n\t\t}\n\n\t\tif (typeof this.host === 'string')\n\t\t{\n\t\t\tif (this.host.length <= 0 || !this.host.startsWith('http'))\n\t\t\t{\n\t\t\t\tconsole.warn(`%cLiveChatWidget.constructor: host is not correct (%c${this.host}%c)`, \"color: black;\", \"font-weight: bold; color: red\", \"color: black\");\n\t\t\t\tthis.ready = false;\n\t\t\t}\n\t\t}\n\n\t\tif (this.pageMode && this.pageMode.placeholder)\n\t\t{\n\t\t\tthis.rootNode = this.pageMode.placeholder;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (document.body.firstChild)\n\t\t\t{\n\t\t\t\tdocument.body.insertBefore(this.rootNode, document.body.firstChild);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tdocument.body.appendChild(this.rootNode);\n\t\t\t}\n\t\t}\n\n\t\tthis.localize = this.pageMode && this.pageMode.useBitrixLocalize? window.BX.message: {};\n\t\tif (typeof this.params.localize === 'object')\n\t\t{\n\t\t\tthis.addLocalize(this.params.localize);\n\t\t}\n\n\t\tlet serverVariables = LocalStorage.get(this.getSiteId(), 0, 'serverVariables', false);\n\t\tif (serverVariables)\n\t\t{\n\t\t\tthis.addLocalize(serverVariables);\n\t\t}\n\n\t\treturn new Promise((resolve, reject) => resolve());\n\t}\n\n\tinitRestClient()\n\t{\n\t\tthis.restClient = new WidgetRestClient({endpoint: this.host+'/rest'});\n\n\t\treturn new Promise((resolve, reject) => resolve());\n\t}\n\n\tinitPullClient()\n\t{\n\t\tthis.pullClient = new PullClient({\n\t\t\tserverEnabled: true,\n\t\t\tuserId: 0,\n\t\t\tsiteId: this.getSiteId(),\n\t\t\trestClient: this.restClient,\n\t\t\tskipStorageInit: true,\n\t\t\tconfigTimestamp: 0,\n\t\t\tskipCheckRevision: true,\n\t\t\tgetPublicListMethod: 'imopenlines.widget.operator.get',\n\t\t});\n\t\tthis.pullClientInited = false;\n\n\t\treturn new Promise((resolve, reject) => resolve());\n\t}\n\n\tinitCore()\n\t{\n\t\tlet widgetVariables = {\n\t\t\tcommon: {\n\t\t\t\thost: this.getHost(),\n\t\t\t\tpageMode: this.pageMode !== false,\n\t\t\t\tcopyright: this.copyright,\n\t\t\t\tcopyrightUrl: this.copyrightUrl,\n\t\t\t},\n\t\t\tvote: {\n\t\t\t\tmessageText: this.getLocalize('BX_LIVECHAT_VOTE_TITLE'),\n\t\t\t\tmessageLike: this.getLocalize('BX_LIVECHAT_VOTE_PLUS_TITLE'),\n\t\t\t\tmessageDislike: this.getLocalize('BX_LIVECHAT_VOTE_MINUS_TITLE'),\n\t\t\t},\n\t\t\ttextMessages: {\n\t\t\t\tbxLivechatOnlineLine1: this.getLocalize('BX_LIVECHAT_ONLINE_LINE_1'),\n\t\t\t\tbxLivechatOnlineLine2: this.getLocalize('BX_LIVECHAT_ONLINE_LINE_2'),\n\t\t\t\tbxLivechatOffline: this.getLocalize('BX_LIVECHAT_OFFLINE'),\n\t\t\t}\n\t\t};\n\t\tif (\n\t\t\tUtils.types.isPlainObject(this.params.styles)\n\t\t\t&& (this.params.styles.backgroundColor || this.params.styles.iconColor)\n\t\t)\n\t\t{\n\t\t\twidgetVariables.styles = {};\n\t\t\tif (this.params.styles.backgroundColor)\n\t\t\t{\n\t\t\t\twidgetVariables.styles.backgroundColor = this.params.styles.backgroundColor;\n\t\t\t}\n\t\t\tif (this.params.styles.iconColor)\n\t\t\t{\n\t\t\t\twidgetVariables.styles.iconColor = this.params.styles.iconColor;\n\t\t\t}\n\t\t}\n\n\t\tthis.controller = new Controller({\n\t\t\thost: this.getHost(),\n\t\t\tsiteId: this.getSiteId(),\n\t\t\tuserId: 0,\n\t\t\tlanguageId: this.language,\n\t\t\tpull: {client: this.pullClient},\n\t\t\trest: {client: this.restClient},\n\t\t\tlocalize: this.localize,\n\t\t\tvuexBuilder: {\n\t\t\t\tdatabase: !Utils.browser.isIe(),\n\t\t\t\tdatabaseName: 'imol/widget',\n\t\t\t\tdatabaseType: VuexBuilder.DatabaseType.localStorage,\n\t\t\t\tmodels: [\n\t\t\t\t\tWidgetModel.create().setVariables(widgetVariables)\n\t\t\t\t],\n\t\t\t}\n\t\t});\n\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.controller.ready().then(() => resolve());\n\t\t});\n\t}\n\n\tinitWidget()\n\t{\n\t\tif (this.isUserRegistered())\n\t\t{\n\t\t\tthis.restClient.setAuthId(this.getUserHash());\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.restClient.setAuthId(RestAuth.guest);\n\t\t}\n\n\t\tif (this.params.location && typeof LocationStyle[this.params.location] !== 'undefined')\n\t\t{\n\t\t\tthis.controller.getStore().commit('widget/common', {location: this.params.location});\n\t\t}\n\n\t\tthis.controller.application.setPrepareFilesBeforeSaveFunction(this.prepareFileData.bind(this));\n\n\t\tthis.controller.addRestAnswerHandler(\n\t\t\tWidgetRestAnswerHandler.create({\n\t\t\t\twidget: this,\n\t\t\t\tstore: this.controller.getStore(),\n\t\t\t\tcontroller: this.controller,\n\t\t\t})\n\t\t);\n\n\t\treturn new Promise((resolve, reject) => resolve());\n\t}\n\n\tinitUploader()\n\t{\n\t\tthis.uploader = new Uploader({\n\t\t\tgeneratePreview: true,\n\t\t\tsender: {\n\t\t\t\thost: this.host,\n\t\t\t\tcustomHeaders: {\n\t\t\t\t\t'Livechat-Auth-Id': this.getUserHash()\n\t\t\t\t},\n\t\t\t\tactionUploadChunk: 'imopenlines.widget.disk.upload',\n\t\t\t\tactionCommitFile: 'imopenlines.widget.disk.commit',\n\t\t\t\tactionRollbackUpload: 'imopenlines.widget.disk.rollbackUpload',\n\t\t\t}\n\t\t});\n\n\t\tthis.uploader.subscribe('onStartUpload', event => {\n\t\t\tconst eventData = event.getData();\n\t\t\tLogger.log('Uploader: onStartUpload', eventData);\n\n\t\t\tthis.controller.getStore().dispatch('files/update', {\n\t\t\t\tchatId: this.getChatId(),\n\t\t\t\tid: eventData.id,\n\t\t\t\tfields: {\n\t\t\t\t\tstatus: FileStatus.upload,\n\t\t\t\t\tprogress: 0\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\n\t\tthis.uploader.subscribe('onProgress', (event) => {\n\t\t\tconst eventData = event.getData();\n\t\t\tLogger.log('Uploader: onProgress', eventData);\n\n\t\t\tthis.controller.getStore().dispatch('files/update', {\n\t\t\t\tchatId: this.getChatId(),\n\t\t\t\tid: eventData.id,\n\t\t\t\tfields: {\n\t\t\t\t\tstatus: FileStatus.upload,\n\t\t\t\t\tprogress: (eventData.progress === 100 ? 99 : eventData.progress),\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\n\t\tthis.uploader.subscribe('onSelectFile', (event) => {\n\t\t\tconst eventData = event.getData();\n\t\t\tconst file = eventData.file;\n\t\t\tLogger.log('Uploader: onSelectFile', eventData);\n\n\t\t\tlet fileType = 'file';\n\t\t\tif (file.type.toString().startsWith('image'))\n\t\t\t{\n\t\t\t\tfileType = 'image';\n\t\t\t}\n\t\t\telse if (file.type.toString().startsWith('video'))\n\t\t\t{\n\t\t\t\tfileType = 'video';\n\t\t\t}\n\n\t\t\tthis.controller.getStore().dispatch('files/add', {\n\t\t\t\tchatId: this.getChatId(),\n\t\t\t\tauthorId: this.getUserId(),\n\t\t\t\tname: eventData.file.name,\n\t\t\t\ttype: fileType,\n\t\t\t\textension: file.name.split('.').splice(-1)[0],\n\t\t\t\tsize: eventData.file.size,\n\t\t\t\timage: !eventData.previewData? false: {\n\t\t\t\t\twidth: eventData.previewDataWidth,\n\t\t\t\t\theight: eventData.previewDataHeight,\n\t\t\t\t},\n\t\t\t\tstatus: FileStatus.upload,\n\t\t\t\tprogress: 0,\n\t\t\t\tauthorName: this.controller.application.getCurrentUser().name,\n\t\t\t\turlPreview: eventData.previewData? URL.createObjectURL(eventData.previewData) : \"\",\n\t\t\t}).then(fileId => {\n\t\t\t\tthis.addMessage('', {id: fileId, source: eventData, previewBlob: eventData.previewData})\n\t\t\t});\n\t\t});\n\n\t\tthis.uploader.subscribe('onComplete', (event) => {\n\t\t\tconst eventData = event.getData();\n\t\t\tLogger.log('Uploader: onComplete', eventData);\n\n\t\t\tthis.controller.getStore().dispatch('files/update', {\n\t\t\t\tchatId: this.getChatId(),\n\t\t\t\tid: eventData.id,\n\t\t\t\tfields: {\n\t\t\t\t\tstatus: FileStatus.wait,\n\t\t\t\t\tprogress: 100\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tconst message = this.messagesQueue.find(message => {\n\t\t\t\treturn message.file.id === eventData.id\n\t\t\t});\n\t\t\tconst fileType = this.controller.getStore().getters['files/get'](this.getChatId(), message.file.id, true).type;\n\n\t\t\tthis.fileCommit({\n\t\t\t\tchatId: this.getChatId(),\n\t\t\t\tuploadId: eventData.result.data.file.id,\n\t\t\t\tmessageText: message.text,\n\t\t\t\tmessageId: message.id,\n\t\t\t\tfileId: message.file.id,\n\t\t\t\tfileType\n\t\t\t}, message);\n\t\t});\n\n\t\tthis.uploader.subscribe('onUploadFileError', (event) => {\n\t\t\tconst eventData = event.getData();\n\t\t\tLogger.log('Uploader: onUploadFileError', eventData);\n\n\t\t\tconst message = this.messagesQueue.find(message => {\n\t\t\t\treturn message.file.id === eventData.id\n\t\t\t});\n\n\t\t\tif (typeof message === 'undefined')\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.fileError(this.getChatId(), message.file.id, message.id);\n\t\t});\n\n\t\tthis.uploader.subscribe('onCreateFileError', (event) => {\n\t\t\tconst eventData = event.getData();\n\t\t\tLogger.log('Uploader: onCreateFileError', eventData);\n\n\t\t\tconst message = this.messagesQueue.find(message => {\n\t\t\t\treturn message.file.id === eventData.id\n\t\t\t});\n\n\t\t\tthis.fileError(this.getChatId(), message.file.id, message.id);\n\t\t});\n\n\t\treturn new Promise((resolve, reject) => resolve());\n\t}\n\n\tinitComplete()\n\t{\n\t\twindow.dispatchEvent(new CustomEvent('onBitrixLiveChat', {detail: {\n\t\t\twidget: this,\n\t\t\twidgetCode: this.code,\n\t\t\twidgetHost: this.host,\n\t\t}}));\n\n\t\tif (this.callStartFlag)\n\t\t{\n\t\t\tthis.start();\n\t\t}\n\n\t\tif (this.pageMode || this.callOpenFlag)\n\t\t{\n\t\t\tthis.open();\n\t\t}\n\n\t\treturn new Promise((resolve, reject) => resolve());\n\t}\n\n\trequestWidgetData()\n\t{\n\t\tif (!this.isReady())\n\t\t{\n\t\t\tconsole.error('LiveChatWidget.start: widget code or host is not specified');\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.widgetDataRequested = true;\n\t\tif (\n\t\t\t!this.isUserRegistered() && (\n\t\t\t\tthis.userRegisterData.hash\n\t\t\t\t|| this.getUserHashCookie()\n\t\t\t)\n\t\t)\n\t\t{\n\t\t\tthis.requestData();\n\t\t\tthis.inited = true;\n\t\t\tthis.fireInitEvent();\n\t\t}\n\t\telse if (this.isConfigDataLoaded() && this.isUserRegistered())\n\t\t{\n\t\t\tthis.requestData();\n\t\t\tthis.inited = true;\n\t\t\tthis.fireInitEvent();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.controller.restClient.callMethod(RestMethod.widgetConfigGet, {code: this.code}, (xhr) => {this.configRequestXhr = xhr}).then((result) => {\n\t\t\t\tthis.configRequestXhr = null;\n\t\t\t\tthis.clearError();\n\n\t\t\t\tthis.controller.executeRestAnswer(RestMethod.widgetConfigGet, result);\n\n\t\t\t\tif (!this.inited)\n\t\t\t\t{\n\t\t\t\t\tthis.inited = true;\n\t\t\t\t\tthis.fireInitEvent();\n\t\t\t\t}\n\t\t\t}).catch(result => {\n\t\t\t\tthis.configRequestXhr = null;\n\n\t\t\t\tthis.setError(result.error().ex.error, result.error().ex.error_description);\n\t\t\t});\n\n\t\t\tif (this.isConfigDataLoaded())\n\t\t\t{\n\t\t\t\tthis.inited = true;\n\t\t\t\tthis.fireInitEvent();\n\t\t\t}\n\t\t}\n\t}\n\n\trequestData()\n\t{\n\t\tLogger.log('requesting data from widget');\n\t\tif (this.requestDataSend)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tthis.requestDataSend = true;\n\n\t\tif (this.configRequestXhr)\n\t\t{\n\t\t\tthis.configRequestXhr.abort();\n\t\t}\n\n\t\tlet query = {\n\t\t\t[RestMethod.widgetConfigGet]: [RestMethod.widgetConfigGet, {code: this.code}]\n\t\t};\n\n\t\tif (this.isUserRegistered())\n\t\t{\n\t\t\tquery[RestMethod.widgetDialogGet] = [RestMethod.widgetDialogGet, {config_id: this.getConfigId(), trace_data: this.getCrmTraceData(), custom_data: this.getCustomData()}];\n\t\t\tquery[ImRestMethodHandler.imChatGet] = [ImRestMethod.imChatGet, {dialog_id: '$result['+RestMethod.widgetDialogGet+'][dialogId]'}];\n\t\t\tquery[ImRestMethodHandler.imDialogMessagesGetInit] = [ImRestMethod.imDialogMessagesGet, {chat_id: '$result['+RestMethod.widgetDialogGet+'][chatId]', limit: this.controller.application.getRequestMessageLimit(), convert_text: 'Y'}];\n\t\t}\n\t\telse\n\t\t{\n\t\t\tquery[RestMethod.widgetUserRegister] = [RestMethod.widgetUserRegister, {config_id: '$result['+RestMethod.widgetConfigGet+'][configId]', ...this.getUserRegisterFields()}];\n\t\t\tquery[ImRestMethodHandler.imChatGet] = [ImRestMethod.imChatGet, {dialog_id: '$result['+RestMethod.widgetUserRegister+'][dialogId]'}];\n\n\t\t\tif (this.userRegisterData.hash || this.getUserHashCookie())\n\t\t\t{\n\t\t\t\tquery[RestMethod.widgetDialogGet] = [RestMethod.widgetDialogGet, {config_id: '$result['+RestMethod.widgetConfigGet+'][configId]', trace_data: this.getCrmTraceData(), custom_data: this.getCustomData()}];\n\t\t\t\tquery[ImRestMethodHandler.imDialogMessagesGetInit] = [ImRestMethod.imDialogMessagesGet, {chat_id: '$result['+RestMethod.widgetDialogGet+'][chatId]', limit: this.controller.application.getRequestMessageLimit(), convert_text: 'Y'}];\n\t\t\t}\n\t\t\tif (this.isUserAgreeConsent())\n\t\t\t{\n\t\t\t\tquery[RestMethod.widgetUserConsentApply] = [RestMethod.widgetUserConsentApply, {config_id: '$result['+RestMethod.widgetConfigGet+'][configId]', consent_url: location.href}];\n\t\t\t}\n\t\t}\n\n\t\tquery[RestMethod.pullServerTime] = [RestMethod.pullServerTime, {}];\n\t\tquery[RestMethod.pullConfigGet] = [RestMethod.pullConfigGet, {'CACHE': 'N'}];\n\t\tquery[RestMethod.widgetUserGet] = [RestMethod.widgetUserGet, {}];\n\n\t\tthis.controller.restClient.callBatch(query, (response) =>\n\t\t{\n\t\t\tif (!response)\n\t\t\t{\n\t\t\t\tthis.requestDataSend = false;\n\t\t\t\tthis.setError('EMPTY_RESPONSE', 'Server returned an empty response.');\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tlet configGet = response[RestMethod.widgetConfigGet];\n\t\t\tif (configGet && configGet.error())\n\t\t\t{\n\t\t\t\tthis.requestDataSend = false;\n\n\t\t\t\tthis.setError(configGet.error().ex.error, configGet.error().ex.error_description);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tthis.controller.executeRestAnswer(RestMethod.widgetConfigGet, configGet);\n\n\t\t\tlet userGetResult = response[RestMethod.widgetUserGet];\n\t\t\tif (userGetResult.error())\n\t\t\t{\n\t\t\t\tthis.requestDataSend = false;\n\t\t\t\tthis.setError(userGetResult.error().ex.error, userGetResult.error().ex.error_description);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tthis.controller.executeRestAnswer(RestMethod.widgetUserGet, userGetResult);\n\n\t\t\tlet chatGetResult = response[ImRestMethodHandler.imChatGet];\n\t\t\tif (chatGetResult.error())\n\t\t\t{\n\t\t\t\tthis.requestDataSend = false;\n\t\t\t\tthis.setError(chatGetResult.error().ex.error, chatGetResult.error().ex.error_description);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tthis.controller.executeRestAnswer(ImRestMethodHandler.imChatGet, chatGetResult);\n\n\t\t\tlet dialogGetResult = response[RestMethod.widgetDialogGet];\n\t\t\tif (dialogGetResult)\n\t\t\t{\n\t\t\t\tif (dialogGetResult.error())\n\t\t\t\t{\n\t\t\t\t\tthis.requestDataSend = false;\n\t\t\t\t\tthis.setError(dialogGetResult.error().ex.error, dialogGetResult.error().ex.error_description);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tthis.controller.executeRestAnswer(RestMethod.widgetDialogGet, dialogGetResult);\n\t\t\t}\n\n\t\t\tlet dialogMessagesGetResult = response[ImRestMethodHandler.imDialogMessagesGetInit];\n\t\t\tif (dialogMessagesGetResult)\n\t\t\t{\n\t\t\t\tif (dialogMessagesGetResult.error())\n\t\t\t\t{\n\t\t\t\t\tthis.requestDataSend = false;\n\t\t\t\t\tthis.setError(dialogMessagesGetResult.error().ex.error, dialogMessagesGetResult.error().ex.error_description);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tthis.controller.getStore().dispatch('dialogues/saveDialog', {\n\t\t\t\t\tdialogId: this.controller.application.getDialogId(),\n\t\t\t\t\tchatId: this.controller.application.getChatId(),\n\t\t\t\t});\n\n\t\t\t\tthis.controller.executeRestAnswer(ImRestMethodHandler.imDialogMessagesGetInit, dialogMessagesGetResult);\n\t\t\t}\n\n\t\t\tlet userRegisterResult = response[RestMethod.widgetUserRegister];\n\t\t\tif (userRegisterResult)\n\t\t\t{\n\t\t\t\tif (userRegisterResult.error())\n\t\t\t\t{\n\t\t\t\t\tthis.requestDataSend = false;\n\t\t\t\t\tthis.setError(userRegisterResult.error().ex.error, userRegisterResult.error().ex.error_description);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tthis.controller.executeRestAnswer(RestMethod.widgetUserRegister, userRegisterResult);\n\t\t\t}\n\n\t\t\tlet timeShift = 0;\n\n\t\t\tlet serverTimeResult = response[RestMethod.pullServerTime];\n\t\t\tif (serverTimeResult && !serverTimeResult.error())\n\t\t\t{\n\t\t\t\ttimeShift = Math.floor(((new Date()).getTime() - new Date(serverTimeResult.data()).getTime())/1000);\n\t\t\t}\n\n\t\t\tlet config = null;\n\t\t\tlet pullConfigResult = response[RestMethod.pullConfigGet];\n\t\t\tif (pullConfigResult && !pullConfigResult.error())\n\t\t\t{\n\t\t\t\tconfig = pullConfigResult.data();\n\t\t\t\tconfig.server.timeShift = timeShift;\n\t\t\t}\n\n\t\t\tthis.startPullClient(config).then(() => {\n\t\t\t\tthis.processSendMessages();\n\t\t\t}).catch((error) => {\n\t\t\t\tthis.setError(error.ex.error, error.ex.error_description);\n\t\t\t});\n\n\t\t\tthis.requestDataSend = false;\n\t\t}, false, false, Utils.getLogTrackingParams({name: 'widget.init.config', dialog: this.controller.application.getDialogData()}));\n\t}\n\n\tprepareFileData(files)\n\t{\n\t\tif (!Utils.types.isArray(files))\n\t\t{\n\t\t\treturn files;\n\t\t}\n\n\t\treturn files.map(file =>\n\t\t{\n\t\t\tlet hash = (window.md5 || md5)(this.getUserId()+'|'+file.id+'|'+this.getUserHash());\n\t\t\tlet urlParam = 'livechat_auth_id='+hash+'&livechat_user_id='+this.getUserId();\n\t\t\tif (file.urlPreview)\n\t\t\t{\n\t\t\t\tfile.urlPreview = file.urlPreview+'&'+urlParam;\n\t\t\t}\n\t\t\tif (file.urlShow)\n\t\t\t{\n\t\t\t\tfile.urlShow = file.urlShow+'&'+urlParam;\n\t\t\t}\n\t\t\tif (file.urlDownload)\n\t\t\t{\n\t\t\t\tfile.urlDownload = file.urlDownload+'&'+urlParam;\n\t\t\t}\n\n\t\t\treturn file;\n\t\t});\n\t}\n\n\tcheckBrowserVersion()\n\t{\n\t\tif (Utils.platform.isIos())\n\t\t{\n\t\t\tlet version = Utils.platform.getIosVersion();\n\t\t\tif (version && version <= 10)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\treturn true;\n\t}\n\n/* endregion 01. Initialize and store data */\n\n/* region 02. Push & Pull */\n\n\tstartPullClient(config)\n\t{\n\t\tlet promise = new BX.Promise();\n\n\t\tif (!this.getUserId() || !this.getSiteId() || !this.restClient)\n\t\t{\n\t\t\tpromise.reject({\n\t\t\t\tex: { error: 'WIDGET_NOT_LOADED', error_description: 'Widget is not loaded.'}\n\t\t\t});\n\t\t\treturn promise;\n\t\t}\n\n\t\tif (this.pullClientInited)\n\t\t{\n\t\t\tif (!this.pullClient.isConnected())\n\t\t\t{\n\t\t\t\tthis.pullClient.scheduleReconnect();\n\t\t\t}\n\t\t\tpromise.resolve(true);\n\t\t\treturn promise;\n\t\t}\n\n\t\tthis.controller.userId = this.getUserId();\n\t\tthis.pullClient.userId = this.getUserId();\n\t\tthis.pullClient.configTimestamp = config? config.server.config_timestamp: 0;\n\t\tthis.pullClient.skipStorageInit = false;\n\t\tthis.pullClient.storage = PullClient.StorageManager({\n\t\t\tuserId: this.getUserId(),\n\t\t\tsiteId: this.getSiteId()\n\t\t});\n\n\t\tthis.pullClient.subscribe(\n\t\t\tnew WidgetImPullCommandHandler({\n\t\t\t\tstore: this.controller.getStore(),\n\t\t\t\tcontroller: this.controller,\n\t\t\t\twidget: this,\n\t\t\t})\n\t\t);\n\t\tthis.pullClient.subscribe(\n\t\t\tnew WidgetImopenlinesPullCommandHandler({\n\t\t\t\tstore: this.controller.getStore(),\n\t\t\t\tcontroller: this.controller,\n\t\t\t\twidget: this,\n\t\t\t})\n\t\t);\n\n\t\tthis.pullClient.subscribe({\n\t\t\ttype: PullClient.SubscriptionType.Status,\n\t\t\tcallback: this.eventStatusInteraction.bind(this)\n\t\t});\n\n\t\tthis.pullConnectedFirstTime = this.pullClient.subscribe({\n\t\t\ttype: PullClient.SubscriptionType.Status,\n\t\t\tcallback: (result) => {\n\t\t\t\tif (result.status === PullClient.PullStatus.Online)\n\t\t\t\t{\n\t\t\t\t\tpromise.resolve(true);\n\t\t\t\t\tthis.pullConnectedFirstTime();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tif (this.template)\n\t\t{\n\t\t\tthis.template.$Bitrix.PullClient.set(this.pullClient);\n\t\t}\n\n\t\tthis.pullClient.start({\n\t\t\t...config,\n\t\t\tskipReconnectToLastSession: true\n\t\t}).catch(function(){\n\t\t\tpromise.reject({\n\t\t\t\tex: { error: 'PULL_CONNECTION_ERROR', error_description: 'Pull is not connected.'}\n\t\t\t});\n\t\t});\n\n\t\tthis.pullClientInited = true;\n\n\t\treturn promise;\n\t}\n\n\tstopPullClient()\n\t{\n\t\tif (this.pullClient)\n\t\t{\n\t\t\tthis.pullClient.stop(PullClient.CloseReasons.MANUAL, 'Closed manually');\n\t\t}\n\t}\n\n\trecoverPullConnection()\n\t{\n\t\t// this.pullClient.session.mid = 0; // TODO specially for disable pull history, remove after recode im\n\t\tthis.pullClient.restart(PullClient.CloseReasons.MANUAL, 'Restart after click by connection status button.');\n\t}\n\n\teventStatusInteraction(data)\n\t{\n\t\tif (data.status === PullClient.PullStatus.Online)\n\t\t{\n\t\t\tthis.offline = false;\n\n\t\t\tif (this.pullRequestMessage)\n\t\t\t{\n\t\t\t\tthis.controller.pullBaseHandler.option.skip = true;\n\n\t\t\t\tLogger.warn('Requesting getDialogUnread after going online');\n\t\t\t\tEventEmitter.emitAsync(EventType.dialog.requestUnread, {chatId: this.controller.application.getChatId()}).then(() => {\n\t\t\t\t\tEventEmitter.emit(EventType.dialog.scrollOnStart, {chatId: this.controller.application.getChatId()});\n\t\t\t\t\tthis.controller.pullBaseHandler.option.skip = false;\n\t\t\t\t\tthis.processSendMessages();\n\t\t\t\t})\n\t\t\t\t.catch(() => {\n\t\t\t\t\tthis.controller.pullBaseHandler.option.skip = false;\n\t\t\t\t});\n\n\t\t\t\tthis.pullRequestMessage = false;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.readMessage();\n\t\t\t\tthis.processSendMessages();\n\t\t\t}\n\t\t}\n\t\telse if (data.status === PullClient.PullStatus.Offline)\n\t\t{\n\t\t\tthis.pullRequestMessage = true;\n\t\t\tthis.offline = true;\n\t\t}\n\t}\n\n/* endregion 02. Push & Pull */\n\n/* region 03. Template engine */\n\n\tattachTemplate()\n\t{\n\t\tif (this.template)\n\t\t{\n\t\t\tthis.controller.getStore().commit('widget/common', {showed: true});\n\t\t\treturn true;\n\t\t}\n\n\t\tthis.rootNode.innerHTML = '';\n\t\tthis.rootNode.appendChild(document.createElement('div'));\n\n\t\tlet application = this;\n\n\t\treturn this.controller.createVue(application, {\n\t\t\tel: this.rootNode.firstChild,\n\t\t\ttemplate: '<bx-livechat/>',\n\t\t\tbeforeCreate()\n\t\t\t{\n\t\t\t\tapplication.sendEvent({\n\t\t\t\t\ttype: SubscriptionType.widgetOpen,\n\t\t\t\t\tdata: {}\n\t\t\t\t});\n\t\t\t\tapplication.template = this;\n\n\t\t\t\tif (ZIndexManager !== undefined)\n\t\t\t\t{\n\t\t\t\t\tconst stack = ZIndexManager.getOrAddStack(document.body);\n\t\t\t\t\tstack.setBaseIndex(1000000); // some big value\n\t\t\t\t\tthis.$bitrix.Data.set('zIndexStack', stack);\n\t\t\t\t}\n\t\t\t},\n\t\t\tdestroyed()\n\t\t\t{\n\t\t\t\tapplication.sendEvent({\n\t\t\t\t\ttype: SubscriptionType.widgetClose,\n\t\t\t\t\tdata: {}\n\t\t\t\t});\n\t\t\t\tapplication.template = null;\n\t\t\t\tapplication.templateAttached = false;\n\t\t\t\tapplication.rootNode.innerHTML = '';\n\t\t\t}\n\t\t}).then(() => {\n\t\t\treturn new Promise((resolve, reject) => resolve());\n\t\t});\n\t}\n\n\tdetachTemplate()\n\t{\n\t\tif (!this.template)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tthis.template.$destroy();\n\n\t\treturn true;\n\t}\n\n\tmutateTemplateComponent(id, params)\n\t{\n\t\treturn Vue.mutateComponent(id, params);\n\t}\n\n/* endregion 03. Template engine */\n\n/* region 04. Rest methods */\n\n\taddMessage(text = '', file = null)\n\t{\n\t\tif (!text && !file)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst quoteId = this.controller.getStore().getters['dialogues/getQuoteId'](this.controller.application.getDialogId());\n\t\tif (quoteId)\n\t\t{\n\t\t\tconst quoteMessage = this.controller.getStore().getters['messages/getMessage'](this.controller.application.getChatId(), quoteId);\n\t\t\tif (quoteMessage)\n\t\t\t{\n\t\t\t\tlet user = null;\n\t\t\t\tif (quoteMessage.authorId)\n\t\t\t\t{\n\t\t\t\t\tuser = this.controller.getStore().getters['users/get'](quoteMessage.authorId);\n\t\t\t\t}\n\n\t\t\t\tconst files = this.controller.getStore().getters['files/getList'](this.controller.application.getChatId());\n\n\t\t\t\tconst message = [];\n\t\t\t\tmessage.push('-'.repeat(54));\n\t\t\t\tmessage.push((user && user.name? user.name: this.getLocalize('BX_LIVECHAT_SYSTEM_MESSAGE'))+' ['+Utils.date.format(quoteMessage.date, null, this.getLocalize())+']');\n\t\t\t\tmessage.push(Utils.text.quote(quoteMessage.text, quoteMessage.params, files, this.getLocalize()));\n\t\t\t\tmessage.push('-'.repeat(54));\n\t\t\t\tmessage.push(text);\n\t\t\t\ttext = message.join(\"\\n\");\n\n\t\t\t\tthis.quoteMessageClear();\n\t\t\t}\n\t\t}\n\n\t\tLogger.warn('addMessage', text, file);\n\n\t\tif (!this.controller.application.isUnreadMessagesLoaded())\n\t\t{\n\t\t\tthis.sendMessage({id: 0, text, file});\n\t\t\tthis.processSendMessages();\n\n\t\t\treturn true;\n\t\t}\n\n\t\tlet params = {};\n\t\tif (file)\n\t\t{\n\t\t\tparams.FILE_ID = [file.id];\n\t\t}\n\n\t\tthis.controller.getStore().dispatch('messages/add', {\n\t\t\tchatId: this.getChatId(),\n\t\t\tauthorId: this.getUserId(),\n\t\t\ttext: text,\n\t\t\tparams,\n\t\t\tsending: !file,\n\t\t}).then(messageId => {\n\t\t\tif (!this.isDialogStart())\n\t\t\t{\n\t\t\t\tthis.controller.getStore().commit('widget/common', {dialogStart:true});\n\t\t\t}\n\n\t\t\tEventEmitter.emit(EventType.dialog.scrollToBottom, {chatId: this.getChatId(), cancelIfScrollChange: true});\n\n\t\t\tthis.messagesQueue.push({\n\t\t\t\tid: messageId,\n\t\t\t\ttext,\n\t\t\t\tfile,\n\t\t\t\tsending: false\n\t\t\t});\n\n\t\t\tif (this.getChatId())\n\t\t\t{\n\t\t\t\tthis.processSendMessages();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.requestData();\n\t\t\t}\n\t\t});\n\n\t\treturn true;\n\t}\n\n\tuploadFile(event)\n\t{\n\t\tif (!event)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tif (!this.getChatId())\n\t\t{\n\t\t\tthis.requestData();\n\t\t}\n\n\t\tthis.uploader.addFilesFromEvent(event);\n\t}\n\n\tcancelUploadFile(fileId)\n\t{\n\t\tlet element = this.messagesQueue.find(element => element.file && element.file.id === fileId);\n\t\tif (element)\n\t\t{\n\t\t\tthis.uploader.deleteTask(fileId);\n\n\t\t\tif (element.xhr)\n\t\t\t{\n\t\t\t\telement.xhr.abort();\n\t\t\t}\n\t\t\tthis.controller.getStore().dispatch('messages/delete', {\n\t\t\t\tchatId: this.getChatId(),\n\t\t\t\tid: element.id,\n\t\t\t}).then(() => {\n\t\t\t\tthis.controller.getStore().dispatch('files/delete', {\n\t\t\t\t\tchatId: this.getChatId(),\n\t\t\t\t\tid: element.file.id,\n\t\t\t\t});\n\t\t\t\tthis.messagesQueue = this.messagesQueue.filter(el => el.id !== element.id);\n\t\t\t});\n\t\t}\n\t}\n\n\tprocessSendMessages()\n\t{\n\t\tif (!this.getDiskFolderId())\n\t\t{\n\t\t\tthis.requestDiskFolderId().then(() => {\n\t\t\t\tthis.processSendMessages();\n\t\t\t}).catch(() => {\n\t\t\t\tLogger.warn('uploadFile', 'Error get disk folder id');\n\t\t\t\treturn false;\n\t\t\t});\n\n\t\t\treturn false;\n\t\t}\n\n\t\tif (this.offline)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.messagesQueue.filter(element => !element.sending).forEach(element => {\n\t\t\telement.sending = true;\n\t\t\tif (element.file)\n\t\t\t{\n\t\t\t\tthis.sendMessageWithFile(element);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.sendMessage(element);\n\t\t\t}\n\t\t});\n\n\t\treturn true;\n\t}\n\n\tsendMessage(message)\n\t{\n\t\tthis.controller.application.stopWriting();\n\n\t\tlet quiteId = this.controller.getStore().getters['dialogues/getQuoteId'](this.getDialogId());\n\t\tif (quiteId)\n\t\t{\n\t\t\tlet quoteMessage = this.controller.getStore().getters['messages/getMessage'](this.getChatId(), quiteId);\n\t\t\tif (quoteMessage)\n\t\t\t{\n\t\t\t\tlet user = this.controller.getStore().getters['users/get'](quoteMessage.authorId);\n\n\t\t\t\tlet newMessage = [];\n\t\t\t\tnewMessage.push(\"------------------------------------------------------\");\n\t\t\t\tnewMessage.push((user.name? user.name: this.getLocalize('BX_LIVECHAT_SYSTEM_MESSAGE')));\n\t\t\t\tnewMessage.push(quoteMessage.text);\n\t\t\t\tnewMessage.push('------------------------------------------------------');\n\t\t\t\tnewMessage.push(message.text);\n\t\t\t\tmessage.text = newMessage.join(\"\\n\");\n\n\t\t\t\tthis.quoteMessageClear();\n\t\t\t}\n\t\t}\n\n\t\tmessage.chatId = this.getChatId();\n\n\t\tthis.controller.restClient.callMethod(ImRestMethod.imMessageAdd, {\n\t\t\t'TEMPLATE_ID': message.id,\n\t\t\t'CHAT_ID': message.chatId,\n\t\t\t'MESSAGE': message.text\n\t\t}, null, null, Utils.getLogTrackingParams({\n\t\t\tname: ImRestMethod.imMessageAdd,\n\t\t\tdata: {timMessageType: 'text'},\n\t\t\tdialog: this.getDialogData()\n\t\t})).then(response => {\n\t\t\tthis.controller.executeRestAnswer(ImRestMethodHandler.imMessageAdd, response, message);\n\t\t}).catch(error => {\n\t\t\tthis.controller.executeRestAnswer(ImRestMethodHandler.imMessageAdd, error, message);\n\t\t});\n\n\t\treturn true;\n\t}\n\n\tsendMessageWithFile(message)\n\t{\n\t\tthis.controller.application.stopWriting();\n\n\t\tconst diskFolderId = this.getDiskFolderId();\n\t\tmessage.chatId = this.getChatId();\n\n\t\tthis.uploader.senderOptions.customHeaders['Livechat-Dialog-Id'] = message.chatId;\n\t\tthis.uploader.senderOptions.customHeaders['Livechat-Auth-Id'] = this.getUserHash();\n\n\t\tthis.uploader.addTask({\n\t\t\ttaskId: message.file.id,\n\t\t\tfileData: message.file.source.file,\n\t\t\tfileName: message.file.source.file.name,\n\t\t\tgenerateUniqueName: true,\n\t\t\tdiskFolderId: diskFolderId,\n\t\t\tpreviewBlob: message.file.previewBlob,\n\t\t\tchunkSize: this.localize.isCloud ? Uploader.CLOUD_MAX_CHUNK_SIZE : Uploader.BOX_MIN_CHUNK_SIZE,\n\t\t});\n\t}\n\n\tfileError(chatId, fileId, messageId = 0)\n\t{\n\t\tthis.controller.getStore().dispatch('files/update', {\n\t\t\tchatId: chatId,\n\t\t\tid: fileId,\n\t\t\tfields: {\n\t\t\t\tstatus: FileStatus.error,\n\t\t\t\tprogress: 0\n\t\t\t}\n\t\t});\n\t\tif (messageId)\n\t\t{\n\t\t\tthis.controller.getStore().dispatch('messages/actionError', {\n\t\t\t\tchatId: chatId,\n\t\t\t\tid: messageId,\n\t\t\t\tretry: false,\n\t\t\t});\n\t\t}\n\t}\n\n\trequestDiskFolderId()\n\t{\n\t\tif (this.requestDiskFolderPromise)\n\t\t{\n\t\t\treturn this.requestDiskFolderPromise;\n\t\t}\n\n\t\tthis.requestDiskFolderPromise = new Promise((resolve, reject) =>\n\t\t{\n\t\t\tif (\n\t\t\t\tthis.flagRequestDiskFolderIdSended\n\t\t\t\t|| this.getDiskFolderId()\n\t\t\t)\n\t\t\t{\n\t\t\t\tthis.flagRequestDiskFolderIdSended = false;\n\t\t\t\tresolve();\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tthis.flagRequestDiskFolderIdSended = true;\n\n\t\t\tthis.controller.restClient.callMethod(ImRestMethod.imDiskFolderGet, {chat_id: this.controller.application.getChatId()}).then(response => {\n\t\t\t\tthis.controller.executeRestAnswer(ImRestMethodHandler.imDiskFolderGet, response);\n\t\t\t\tthis.flagRequestDiskFolderIdSended = false;\n\t\t\t\tresolve();\n\t\t\t}).catch(error => {\n\t\t\t\tthis.flagRequestDiskFolderIdSended = false;\n\t\t\t\tthis.controller.executeRestAnswer(ImRestMethodHandler.imDiskFolderGet, error);\n\t\t\t\treject();\n\t\t\t});\n\t\t});\n\n\t\treturn this.requestDiskFolderPromise;\n\t}\n\n\tfileCommit(params, message)\n\t{\n\t\tthis.controller.restClient.callMethod(ImRestMethod.imDiskFileCommit, {\n\t\t\tchat_id: params.chatId,\n\t\t\tupload_id: params.uploadId,\n\t\t\tmessage: params.messageText,\n\t\t\ttemplate_id: params.messageId,\n\t\t\tfile_template_id: params.fileId,\n\t\t}, null, null, Utils.getLogTrackingParams({\n\t\t\tname: ImRestMethod.imDiskFileCommit,\n\t\t\tdata: {timMessageType: params.fileType},\n\t\t\tdialog: this.getDialogData()\n\t\t})).then(response => {\n\t\t\tthis.controller.executeRestAnswer(ImRestMethodHandler.imDiskFileCommit, response, message);\n\t\t}).catch(error => {\n\t\t\tthis.controller.executeRestAnswer(ImRestMethodHandler.imDiskFileCommit, error, message);\n\t\t});\n\n\t\treturn true;\n\t}\n\n\tgetDialogHistory(lastId, limit = this.controller.application.getRequestMessageLimit())\n\t{\n\t\tthis.controller.restClient.callMethod(ImRestMethod.imDialogMessagesGet, {\n\t\t\t'CHAT_ID': this.getChatId(),\n\t\t\t'LAST_ID': lastId,\n\t\t\t'LIMIT': limit,\n\t\t\t'CONVERT_TEXT': 'Y'\n\t\t}).then(result => {\n\t\t\tthis.controller.executeRestAnswer(ImRestMethodHandler.imDialogMessagesGet, result);\n\t\t\tthis.template.$emit(EventType.dialog.requestHistoryResult, {count: result.data().messages.length});\n\t\t}).catch(result => {\n\t\t\tthis.template.$emit(EventType.dialog.requestHistoryResult, {error: result.error().ex});\n\t\t});\n\t}\n\n\tgetDialogUnread(lastId, limit = this.controller.application.getRequestMessageLimit())\n\t{\n\t\tconst promise = new BX.Promise();\n\n\t\tif (!lastId)\n\t\t{\n\t\t\tlastId = this.controller.getStore().getters['messages/getLastId'](this.controller.application.getChatId());\n\t\t}\n\n\t\tif (!lastId)\n\t\t{\n\t\t\tthis.template.$emit(EventType.dialog.requestUnreadResult, {error: {error: 'LAST_ID_EMPTY', error_description: 'LastId is empty.'}});\n\t\t\tpromise.reject();\n\t\t\treturn promise;\n\t\t}\n\n\t\tthis.controller.application.readMessage(lastId, true, true).then(() =>\n\t\t{\n\t\t\tlet query = {\n\t\t\t\t[ImRestMethodHandler.imDialogRead]: [ImRestMethod.imDialogRead, {\n\t\t\t\t\tdialog_id: this.getDialogId(),\n\t\t\t\t\tmessage_id: lastId\n\t\t\t\t}],\n\t\t\t\t[ImRestMethodHandler.imChatGet]: [ImRestMethod.imChatGet, {\n\t\t\t\t\tdialog_id: this.getDialogId()\n\t\t\t\t}],\n\t\t\t\t[ImRestMethodHandler.imDialogMessagesGetUnread]: [ImRestMethod.imDialogMessagesGet, {\n\t\t\t\t\tchat_id: this.getChatId(),\n\t\t\t\t\tfirst_id: lastId,\n\t\t\t\t\tlimit: limit,\n\t\t\t\t\tconvert_text: 'Y'\n\t\t\t\t}]\n\t\t\t};\n\n\t\t\tthis.controller.restClient.callBatch(query, (response) =>\n\t\t\t{\n\t\t\t\tif (!response)\n\t\t\t\t{\n\t\t\t\t\tthis.template.$emit(EventType.dialog.requestUnreadResult, {error: {error: 'EMPTY_RESPONSE', error_description: 'Server returned an empty response.'}});\n\n\t\t\t\t\tpromise.reject();\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tlet chatGetResult = response[ImRestMethodHandler.imChatGet];\n\t\t\t\tif (!chatGetResult.error())\n\t\t\t\t{\n\t\t\t\t\tthis.controller.executeRestAnswer(ImRestMethodHandler.imChatGet, chatGetResult);\n\t\t\t\t}\n\n\t\t\t\tlet dialogMessageUnread = response[ImRestMethodHandler.imDialogMessagesGetUnread];\n\t\t\t\tif (dialogMessageUnread.error())\n\t\t\t\t{\n\t\t\t\t\tthis.template.$emit(EventType.dialog.requestUnreadResult, {error: dialogMessageUnread.error().ex});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.controller.executeRestAnswer(ImRestMethodHandler.imDialogMessagesGetUnread, dialogMessageUnread);\n\t\t\t\t\tthis.template.$emit(EventType.dialog.requestUnreadResult, {\n\t\t\t\t\t\tfirstMessageId: dialogMessageUnread.data().messages.length > 0? dialogMessageUnread.data().messages[0].id: 0,\n\t\t\t\t\t\tcount: dialogMessageUnread.data().messages.length\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tpromise.fulfill(response);\n\n\t\t\t}, false, false, Utils.getLogTrackingParams({name: ImRestMethodHandler.imDialogMessagesGetUnread, dialog: this.getDialogData()}));\n\t\t});\n\n\t\treturn promise;\n\t}\n\n\tretrySendMessage(message)\n\t{\n\t\tif (this.messagesQueue.find(el => el.id === message.id))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.messagesQueue.push({\n\t\t\tid: message.id,\n\t\t\ttext: message.text,\n\t\t\tsending: false\n\t\t});\n\n\t\tthis.controller.application.setSendingMessageFlag(message.id);\n\n\t\tthis.processSendMessages();\n\t}\n\n\treadMessage(messageId)\n\t{\n\t\tif (this.offline)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\treturn this.controller.application.readMessage(messageId);\n\t}\n\n\treactMessage(id, reaction)\n\t{\n\t\tthis.controller.application.reactMessage(id, reaction.type, reaction.action);\n\t}\n\n\texecMessageKeyboardCommand(data)\n\t{\n\t\tif (data.action === 'ACTION' && data.params.action === 'LIVECHAT')\n\t\t{\n\t\t\tlet {dialogId, messageId} = data.params;\n\t\t\tlet values = JSON.parse(data.params.value);\n\n\t\t\tlet sessionId = parseInt(values.SESSION_ID);\n\t\t\tif (sessionId !== this.getSessionId() || this.isSessionClose())\n\t\t\t{\n\t\t\t\talert(this.localize.BX_LIVECHAT_ACTION_EXPIRED);\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tthis.controller.restClient.callMethod(RestMethod.widgetActionSend, {\n\t\t\t\t'MESSAGE_ID': messageId,\n\t\t\t\t'DIALOG_ID': dialogId,\n\t\t\t\t'ACTION_VALUE': data.params.value,\n\t\t\t});\n\n\t\t\treturn true;\n\t\t}\n\n\t\tif (data.action !== 'COMMAND')\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tlet {dialogId, messageId, botId, command, params} = data.params;\n\n\t\tthis.controller.restClient.callMethod(ImRestMethod.imMessageCommand, {\n\t\t\t'MESSAGE_ID': messageId,\n\t\t\t'DIALOG_ID': dialogId,\n\t\t\t'BOT_ID': botId,\n\t\t\t'COMMAND': command,\n\t\t\t'COMMAND_PARAMS': params,\n\t\t});\n\n\t\treturn true;\n\t}\n\n\tquoteMessageClear()\n\t{\n\t\tthis.controller.getStore().dispatch('dialogues/update', {\n\t\t\tdialogId: this.controller.application.getDialogId(),\n\t\t\tfields: {\n\t\t\t\tquoteId: 0\n\t\t\t}\n\t\t});\n\t}\n\n\tsendDialogVote(result)\n\t{\n\t\tif (!this.getSessionId())\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.controller.restClient.callMethod(RestMethod.widgetVoteSend, {\n\t\t\t'SESSION_ID': this.getSessionId(),\n\t\t\t'ACTION': result\n\t\t}).catch((result) => {\n\t\t\tthis.controller.getStore().commit('widget/dialog', {userVote: VoteType.none});\n\t\t});\n\n\t\tthis.sendEvent({\n\t\t\ttype: SubscriptionType.userVote,\n\t\t\tdata: {\n\t\t\t\tvote: result\n\t\t\t}\n\t\t});\n\t}\n\n\tsendForm(type, fields)\n\t{\n\t\tLogger.info('LiveChatWidgetPrivate.sendForm:', type, fields);\n\n\t\tlet query = {\n\t\t\t[RestMethod.widgetFormSend]: [RestMethod.widgetFormSend, {\n\t\t\t\t'CHAT_ID': this.getChatId(),\n\t\t\t\t'FORM': type.toUpperCase(),\n\t\t\t\t'FIELDS': fields\n\t\t\t}],\n\t\t\t[RestMethod.widgetUserGet]: [RestMethod.widgetUserGet, {}]\n\t\t};\n\t\tthis.controller.restClient.callBatch(query, (response) =>\n\t\t{\n\t\t\tif (!response)\n\t\t\t{\n\t\t\t\tthis.requestDataSend = false;\n\t\t\t\tthis.setError('EMPTY_RESPONSE', 'Server returned an empty response.');\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tlet userGetResult = response[RestMethod.widgetUserGet];\n\t\t\tif (userGetResult.error())\n\t\t\t{\n\t\t\t\tthis.requestDataSend = false;\n\t\t\t\tthis.setError(userGetResult.error().ex.error, userGetResult.error().ex.error_description);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tthis.controller.executeRestAnswer(RestMethod.widgetUserGet, userGetResult);\n\n\t\t\tthis.sendEvent({\n\t\t\t\ttype: SubscriptionType.userForm,\n\t\t\t\tdata: {\n\t\t\t\t\tform: type,\n\t\t\t\t\tfields: fields\n\t\t\t\t}\n\t\t\t});\n\n\t\t}, false, false, Utils.getLogTrackingParams({name: RestMethod.widgetUserGet, dialog: this.getDialogData()}));\n\n\t}\n\n\tgetHtmlHistory()\n\t{\n\t\tconst chatId = this.getChatId();\n\t\tif (chatId <= 0)\n\t\t{\n\t\t\tconsole.error('Incorrect chatId value');\n\t\t}\n\n\t\tconst config = {\n\t\t\tchatId: this.getChatId()\n\t\t};\n\t\tthis.requestControllerAction('imopenlines.widget.history.download', config)\n\t\t\t.then(response => {\n\t\t\t\tconst contentType = response.headers.get('Content-Type');\n\t\t\t\tif (contentType.startsWith('application/json'))\n\t\t\t\t{\n\t\t\t\t\treturn response.json();\n\t\t\t\t}\n\n\t\t\t\treturn response.blob();\n\t\t\t})\n\t\t\t.then(result => {\n\t\t\t\tif (result instanceof Blob)\n\t\t\t\t{\n\t\t\t\t\tconst url = window.URL.createObjectURL(result);\n\t\t\t\t\tconst a = document.createElement('a');\n\t\t\t\t\ta.href = url;\n\t\t\t\t\ta.download = chatId + '.html';\n\t\t\t\t\tdocument.body.appendChild(a);\n\t\t\t\t\ta.click();\n\t\t\t\t\ta.remove();\n\t\t\t\t}\n\t\t\t\telse if (result.hasOwnProperty('errors'))\n\t\t\t\t{\n\t\t\t\t\tconsole.error(result.errors[0]);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tconsole.error('Unknown error.');\n\t\t\t\t}\n\t\t\t})\n\t\t\t.catch(() => console.error('Fetch error.'));\n\t}\n\n\t/**\n\t * Basic method to run actions.\n\t * If you need to extend it, check BX.ajax.runAction to extend this method.\n\t */\n\trequestControllerAction(action, config)\n\t{\n\t\tconst host = this.host ? this.host : '';\n\t\tconst ajaxEndpoint = '/bitrix/services/main/ajax.php';\n\n\t\tconst url = new URL(ajaxEndpoint, host);\n\t\turl.searchParams.set('action', action);\n\n\t\tconst formData = new FormData();\n\t\tfor (const key in config)\n\t\t{\n\t\t\tif (config.hasOwnProperty(key))\n\t\t\t{\n\t\t\t\tformData.append(key, config[key]);\n\t\t\t}\n\t\t}\n\n\t\treturn fetch(url, {\n\t\t\tmethod: 'POST',\n\t\t\theaders: {\n\t\t\t\t'Livechat-Auth-Id': this.getUserHash()\n\t\t\t},\n\t\t\tbody: formData\n\t\t})\n\t}\n\n\tsendConsentDecision(result)\n\t{\n\t\tresult = result === true;\n\n\t\tthis.controller.getStore().commit('widget/dialog', {userConsent: result});\n\n\t\tif (result && this.isUserRegistered())\n\t\t{\n\t\t\tthis.controller.restClient.callMethod(RestMethod.widgetUserConsentApply, {\n\t\t\t\tconfig_id: this.getConfigId(),\n\t\t\t\tconsent_url: location.href\n\t\t\t});\n\t\t}\n\t}\n\n/* endregion 05. Templates and template interaction */\n\n/* region 05. Widget interaction and utils */\n\n\tstart()\n\t{\n\t\tif (!this.controller || !this.controller.getStore())\n\t\t{\n\t\t\tthis.callStartFlag = true;\n\t\t\treturn true;\n\t\t}\n\n\t\tif (this.isSessionActive())\n\t\t{\n\t\t\tthis.requestWidgetData();\n\t\t}\n\n\t\treturn true;\n\t}\n\n\topen(params = {})\n\t{\n\t\tclearTimeout(this.openTimeout);\n\t\tif (!this.controller.getStore())\n\t\t{\n\t\t\tthis.callOpenFlag = true;\n\t\t\treturn true;\n\t\t}\n\n\t\tif (!params.openFromButton && this.buttonInstance)\n\t\t{\n\t\t\tthis.buttonInstance.wm.showById('openline_livechat');\n\t\t}\n\n\t\tif (!this.checkBrowserVersion())\n\t\t{\n\t\t\tthis.setError('OLD_BROWSER_LOCALIZED', this.localize.BX_LIVECHAT_OLD_BROWSER);\n\t\t}\n\t\telse if (Utils.versionCompare(Vue.version(), '2.1') < 0)\n\t\t{\n\t\t\talert(this.localize.BX_LIVECHAT_OLD_VUE);\n\t\t\tconsole.error(`LiveChatWidget.error: OLD_VUE_VERSION (${this.localize.BX_LIVECHAT_OLD_VUE_DEV.replace('#CURRENT_VERSION#', Vue.version())})`);\n\n\t\t\treturn false;\n\t\t}\n\t\telse if (!this.isWidgetDataRequested())\n\t\t{\n\t\t\tthis.requestWidgetData();\n\t\t}\n\n\t\tthis.attachTemplate();\n\t}\n\n\tclose()\n\t{\n\t\tif (this.pageMode)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tif (this.buttonInstance)\n\t\t{\n\t\t\tthis.buttonInstance.onWidgetClose();\n\t\t}\n\n\t\tthis.detachTemplate();\n\t}\n\n\tshowNotification(params)\n\t{\n\t\tif (!this.controller || !this.controller.getStore())\n\t\t{\n\t\t\tconsole.error('LiveChatWidget.showNotification: method can be called after fired event - onBitrixLiveChat');\n\t\t\treturn false;\n\t\t}\n\t\t// TODO show popup notification and set badge on button\n\t\t// operatorName\n\t\t// notificationText\n\t\t// counter\n\t}\n\n\tfireInitEvent()\n\t{\n\t\tif (this.initEventFired)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tthis.sendEvent({\n\t\t\ttype: SubscriptionType.configLoaded,\n\t\t\tdata: {}\n\t\t});\n\n\t\tif (this.controller.getStore().state.widget.common.reopen)\n\t\t{\n\t\t\tthis.open();\n\t\t}\n\n\t\tthis.initEventFired = true;\n\n\t\treturn true;\n\t}\n\n\tisReady()\n\t{\n\t\treturn this.ready;\n\t}\n\n\tisInited()\n\t{\n\t\treturn this.inited;\n\t}\n\n\tisUserRegistered()\n\t{\n\t\treturn !!this.getUserHash();\n\t}\n\n\tisConfigDataLoaded()\n\t{\n\t\treturn this.controller.getStore().state.widget.common.configId;\n\t}\n\n\tisWidgetDataRequested()\n\t{\n\t\treturn this.widgetDataRequested;\n\t}\n\n\tisChatLoaded()\n\t{\n\t\treturn this.controller.getStore().state.application.dialog.chatId > 0;\n\t}\n\n\tisSessionActive()\n\t{\n\t\treturn !this.controller.getStore().state.widget.dialog.sessionClose;\n\t}\n\n\tisUserAgreeConsent()\n\t{\n\t\treturn this.controller.getStore().state.widget.dialog.userConsent;\n\t}\n\n\tgetCrmTraceData()\n\t{\n\t\tlet traceData = '';\n\n\t\tif (!this.buttonInstance)\n\t\t{\n\t\t\treturn traceData;\n\t\t}\n\n\t\tif (typeof this.buttonInstance.getTrace !== 'function')\n\t\t{\n\t\t\ttraceData = this.buttonInstance.getTrace();\n\t\t}\n\t\telse if (\n\t\t\ttypeof this.buttonInstance.b24Tracker !== 'undefined'\n\t\t\t&& typeof this.buttonInstance.b24Tracker.guest !== 'undefined'\n\t\t)\n\t\t{\n\t\t\ttraceData = this.buttonInstance.b24Tracker.guest.getTrace();\n\t\t}\n\n\t\treturn traceData;\n\t}\n\n\tgetCustomData()\n\t{\n\t\tlet customData = [];\n\n\t\tif (this.customData.length > 0)\n\t\t{\n\t\t\tcustomData = this.customData;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tcustomData = [{MESSAGE: this.localize.BX_LIVECHAT_EXTRA_SITE+': [URL]'+location.href+'[/URL]'}];\n\t\t}\n\n\t\treturn JSON.stringify(customData);\n\t}\n\n\tisUserLoaded()\n\t{\n\t\treturn this.controller.getStore().state.widget.user.id > 0;\n\t}\n\n\tgetSiteId()\n\t{\n\t\treturn this.host.replace(/(http.?:\\/\\/)|([:.\\\\\\/])/mg, \"\")+this.code;\n\t}\n\n\tgetHost()\n\t{\n\t\treturn this.host;\n\t}\n\n\tgetConfigId()\n\t{\n\t\treturn this.controller.getStore().state.widget.common.configId;\n\t}\n\n\tisDialogStart()\n\t{\n\t\treturn this.controller.getStore().state.widget.common.dialogStart;\n\t}\n\n\tgetChatId()\n\t{\n\t\treturn this.controller.getStore().state.application.dialog.chatId;\n\t}\n\n\tgetDialogId()\n\t{\n\t\treturn this.controller.getStore().state.application.dialog.dialogId;\n\t}\n\n\tgetDiskFolderId()\n\t{\n\t\treturn this.controller.getStore().state.application.dialog.diskFolderId;\n\t}\n\n\tgetDialogData(dialogId = this.getDialogId())\n\t{\n\t\treturn this.controller.getStore().state.dialogues.collection[dialogId];\n\t}\n\n\tgetSessionId()\n\t{\n\t\treturn this.controller.getStore().state.widget.dialog.sessionId;\n\t}\n\n\tisSessionClose()\n\t{\n\t\treturn this.controller.getStore().state.widget.dialog.sessionClose;\n\t}\n\n\tgetUserHash()\n\t{\n\t\treturn this.controller.getStore().state.widget.user.hash;\n\t}\n\n\tgetUserHashCookie()\n\t{\n\t\tlet userHash = '';\n\n\t\tlet cookie = Cookie.get(null, 'LIVECHAT_HASH');\n\t\tif (typeof cookie === 'string' && cookie.match(/^[a-f0-9]{32}$/))\n\t\t{\n\t\t\tuserHash= cookie;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tlet cookie = Cookie.get(this.getSiteId(), 'LIVECHAT_HASH');\n\t\t\tif (typeof cookie === 'string' && cookie.match(/^[a-f0-9]{32}$/))\n\t\t\t{\n\t\t\t\tuserHash = cookie;\n\t\t\t}\n\t\t}\n\n\t\treturn userHash;\n\t}\n\n\tgetUserId()\n\t{\n\t\treturn this.controller.getStore().state.widget.user.id;\n\t}\n\n\tgetUserData()\n\t{\n\t\tif (!this.controller || !this.controller.getStore())\n\t\t{\n\t\t\tconsole.error('LiveChatWidget.getUserData: method can be called after fired event - onBitrixLiveChat');\n\t\t\treturn false;\n\t\t}\n\n\t\treturn this.controller.getStore().state.widget.user;\n\t}\n\n\tgetUserRegisterFields()\n\t{\n\t\treturn {\n\t\t\t'name': this.userRegisterData.name || '',\n\t\t\t'last_name': this.userRegisterData.lastName || '',\n\t\t\t'avatar': this.userRegisterData.avatar || '',\n\t\t\t'email': this.userRegisterData.email || '',\n\t\t\t'www': this.userRegisterData.www || '',\n\t\t\t'gender': this.userRegisterData.gender || '',\n\t\t\t'position': this.userRegisterData.position || '',\n\t\t\t'user_hash': this.userRegisterData.hash || this.getUserHashCookie() || '',\n\t\t\t'consent_url': this.controller.getStore().state.widget.common.consentUrl? location.href: '',\n\t\t\t'trace_data': this.getCrmTraceData(),\n\t\t\t'custom_data': this.getCustomData()\n\t\t}\n\t}\n\n\tgetWidgetLocationCode()\n\t{\n\t\treturn LocationStyle[this.controller.getStore().state.widget.common.location];\n\t}\n\n\tsetUserRegisterData(params)\n\t{\n\t\tif (!this.controller || !this.controller.getStore())\n\t\t{\n\t\t\tconsole.error('LiveChatWidget.getUserData: method can be called after fired event - onBitrixLiveChat');\n\t\t\treturn false;\n\t\t}\n\n\t\tconst validUserFields = ['hash', 'name', 'lastName', 'avatar', 'email', 'www', 'gender', 'position'];\n\n\t\tif (!Utils.types.isPlainObject(params))\n\t\t{\n\t\t\tconsole.error(`%cLiveChatWidget.setUserData: params is not a object`, \"color: black;\");\n\t\t\treturn false;\n\t\t}\n\n\t\tfor (let field in this.userRegisterData)\n\t\t{\n\t\t\tif (!this.userRegisterData.hasOwnProperty(field))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (!params[field])\n\t\t\t{\n\t\t\t\tdelete this.userRegisterData[field];\n\t\t\t}\n\t\t}\n\n\t\tfor (let field in params)\n\t\t{\n\t\t\tif (!params.hasOwnProperty(field))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (validUserFields.indexOf(field) === -1)\n\t\t\t{\n\t\t\t\tconsole.warn(`%cLiveChatWidget.setUserData: user field is not set, because you are trying to set an unknown field (%c${field}%c)`, \"color: black;\", \"font-weight: bold; color: red\", \"color: black\");\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tthis.userRegisterData[field] = params[field];\n\t\t}\n\n\t\tif (\n\t\t\tthis.userRegisterData.hash\n\t\t\t&& this.getUserHash()\n\t\t\t&& this.userRegisterData.hash !== this.getUserHash()\n\t\t)\n\t\t{\n\t\t\tthis.setNewAuthToken(this.userRegisterData.hash);\n\t\t}\n\t}\n\n\tsetNewAuthToken(authToken = '')\n\t{\n\t\tthis.controller.getStoreBuilder().clearModelState();\n\t\tCookie.set(null, 'LIVECHAT_HASH', '', {expires: 365*86400, path: '/'});\n\n\t\tthis.controller.restClient.setAuthId(RestAuth.guest, authToken);\n\t}\n\n\tsetCustomData(params)\n\t{\n\t\tif (!this.controller || !this.controller.getStore())\n\t\t{\n\t\t\tconsole.error('LiveChatWidget.getUserData: method can be called after fired event - onBitrixLiveChat');\n\t\t\treturn false;\n\t\t}\n\n\n\t\tlet result = [];\n\t\tif (params instanceof Array)\n\t\t{\n\t\t\tparams.forEach(element =>\n\t\t\t{\n\t\t\t\tif (element && typeof element === 'object')\n\t\t\t\t{\n\t\t\t\t\tresult.push(element);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (result.length <= 0)\n\t\t\t{\n\t\t\t\tconsole.error('LiveChatWidget.setCustomData: params is empty');\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (!params)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tresult = [{'MESSAGE': params}]\n\t\t}\n\n\t\tthis.customData = this.customData.concat(result);\n\n\t\treturn true;\n\t}\n\n\tsetError(code = '', description = '')\n\t{\n\t\tconsole.error(`LiveChatWidget.error: ${code} (${description})`);\n\n\t\tlet localizeDescription = '';\n\t\tif (code === 'LIVECHAT_AUTH_FAILED')\n\t\t{\n\t\t\tlocalizeDescription = this.getLocalize('BX_LIVECHAT_AUTH_FAILED').replace('#LINK_START#', '<a href=\"javascript:void();\" onclick=\"location.reload()\">').replace('#LINK_END#', '</a>');\n\t\t\tthis.setNewAuthToken();\n\t\t}\n\t\telse if (code === 'LIVECHAT_AUTH_PORTAL_USER')\n\t\t{\n\t\t\tlocalizeDescription = this.getLocalize('BX_LIVECHAT_PORTAL_USER_NEW').replace('#LINK_START#', '<a href=\"'+this.host+'\">').replace('#LINK_END#', '</a>')\n\t\t}\n\t\telse if (code.endsWith('LOCALIZED'))\n\t\t{\n\t\t\tlocalizeDescription = description;\n\t\t}\n\n\t\tthis.controller.getStore().commit('application/set', {error: {\n\t\t\tactive: true,\n\t\t\tcode,\n\t\t\tdescription: localizeDescription\n\t\t}});\n\t}\n\n\tclearError()\n\t{\n\t\tthis.controller.getStore().commit('application/set', {error: {\n\t\t\tactive: false,\n\t\t\tcode: '',\n\t\t\tdescription: ''}\n\t\t});\n\t}\n\n\t/**\n\t *\n\t * @param params {Object}\n\t * @returns {Function|Boolean} - Unsubscribe callback function or False\n\t */\n\tsubscribe(params)\n\t{\n\t\tif (!Utils.types.isPlainObject(params))\n\t\t{\n\t\t\tconsole.error(`%cLiveChatWidget.subscribe: params is not a object`, \"color: black;\");\n\t\t\treturn false;\n\t\t}\n\n\t\tif (!SubscriptionTypeCheck.includes(params.type))\n\t\t{\n\t\t\tconsole.error(`%cLiveChatWidget.subscribe: subscription type is not correct (%c${params.type}%c)`, \"color: black;\", \"font-weight: bold; color: red\", \"color: black\");\n\t\t\treturn false;\n\t\t}\n\n\t\tif (typeof params.callback !== 'function')\n\t\t{\n\t\t\tconsole.error(`%cLiveChatWidget.subscribe: callback is not a function (%c${typeof params.callback}%c)`, \"color: black;\", \"font-weight: bold; color: red\", \"color: black\");\n\t\t\treturn false;\n\t\t}\n\n\t\tif (typeof (this.subscribers[params.type]) === 'undefined')\n\t\t{\n\t\t\tthis.subscribers[params.type] = [];\n\t\t}\n\n\t\tthis.subscribers[params.type].push(params.callback);\n\n\t\treturn function () {\n\t\t\tthis.subscribers[params.type] = this.subscribers[params.type].filter(function(element) {\n\t\t\t\treturn element !== params.callback;\n\t\t\t});\n\t\t}.bind(this);\n\t}\n\n\t/**\n\t *\n\t * @param params {Object}\n\t * @returns {boolean}\n\t */\n\tsendEvent(params)\n\t{\n\t\tparams = params || {};\n\n\t\tif (!params.type)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tif (typeof params.data !== 'object' || !params.data)\n\t\t{\n\t\t\tparams.data = {};\n\t\t}\n\n\t\tif (this.subscribers[params.type] instanceof Array && this.subscribers[params.type].length > 0)\n\t\t{\n\t\t\tthis.subscribers[params.type].forEach(callback => callback(params.data));\n\t\t}\n\n\t\tif (this.subscribers[SubscriptionType.every] instanceof Array && this.subscribers[SubscriptionType.every].length > 0)\n\t\t{\n\t\t\tthis.subscribers[SubscriptionType.every].forEach(callback => callback({type: params.type, data: params.data}));\n\t\t}\n\n\t\treturn true;\n\t}\n\n\taddLocalize(phrases)\n\t{\n\t\tif (typeof phrases !== \"object\" || !phrases)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tfor (let name in phrases)\n\t\t{\n\t\t\tif (phrases.hasOwnProperty(name))\n\t\t\t{\n\t\t\t\tthis.localize[name] = phrases[name];\n\t\t\t}\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tgetLocalize(name)\n\t{\n\t\tlet phrase = '';\n\t\tif (typeof name === 'undefined')\n\t\t{\n\t\t\treturn this.localize;\n\t\t}\n\t\telse if (typeof this.localize[name.toString()] === 'undefined')\n\t\t{\n\t\t\tconsole.warn(`LiveChatWidget.getLocalize: message with code '${name.toString()}' is undefined.`)\n\t\t}\n\t\telse\n\t\t{\n\t\t\tphrase = this.localize[name];\n\t\t}\n\n\t\treturn phrase;\n\t}\n\n/* endregion 05. Widget interaction and utils */\n}\n","/**\n * Bitrix OpenLines widget\n * Widget public interface\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {Widget} from \"./widget\"\nimport {SubscriptionType} from \"./const\";\n\nexport class WidgetPublicManager\n{\n\tconstructor(config)\n\t{\n\t\tthis.developerInfo = 'Do not use private methods.';\n\t\tthis.__privateMethods__ = new Widget(config);\n\t\tthis.__createLegacyMethods();\n\t}\n\n\topen(params)\n\t{\n\t\treturn this.__privateMethods__.open(params);\n\t}\n\n\tclose()\n\t{\n\t\treturn this.__privateMethods__.close();\n\t}\n\n\tshowNotification(params)\n\t{\n\t\treturn this.__privateMethods__.showNotification(params);\n\t}\n\n\tgetUserData()\n\t{\n\t\treturn this.__privateMethods__.getUserData();\n\t}\n\n\tsetUserRegisterData(params)\n\t{\n\t\treturn this.__privateMethods__.setUserRegisterData(params);\n\t}\n\n\tsetCustomData(params)\n\t{\n\t\treturn this.__privateMethods__.setCustomData(params);\n\t}\n\n\tmutateTemplateComponent(id, params)\n\t{\n\t\treturn this.__privateMethods__.mutateTemplateComponent(id, params);\n\t}\n\n\taddLocalize(phrases)\n\t{\n\t\treturn this.__privateMethods__.addLocalize(phrases);\n\t}\n\n\t/**\n\t *\n\t * @param params {Object}\n\t * @returns {Function|Boolean} - Unsubscribe callback function or False\n\t */\n\tsubscribe(params)\n\t{\n\t\treturn this.__privateMethods__.subscribe(params);\n\t}\n\n\tstart()\n\t{\n\t\treturn this.__privateMethods__.start();\n\t}\n\n\t__createLegacyMethods()\n\t{\n\t\tif (typeof window.BX.LiveChat === 'undefined')\n\t\t{\n\t\t\tlet sourceHref = document.createElement('a');\n\t\t\tsourceHref.href = this.__privateMethods__.host;\n\n\t\t\tlet sourceDomain = sourceHref.protocol+'//'+sourceHref.hostname+(sourceHref.port && sourceHref.port != '80' && sourceHref.port != '443'? \":\"+sourceHref.port: \"\");\n\n\t\t\twindow.BX.LiveChat = {\n\t\t\t\topenLiveChat: () => {\n\t\t\t\t\tthis.open({openFromButton: true});\n\t\t\t\t},\n\t\t\t\tcloseLiveChat: () => {\n\t\t\t\t\tthis.close();\n\t\t\t\t},\n\t\t\t\taddEventListener: (el, eventName, handler) =>\n\t\t\t\t{\n\t\t\t\t\tif (eventName === 'message')\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.subscribe({\n\t\t\t\t\t\t\ttype: SubscriptionType.userMessage,\n\t\t\t\t\t\t\tcallback: function (event)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\thandler({origin: sourceDomain, data: JSON.stringify({action: 'sendMessage'}), event});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tconsole.warn('Method BX.LiveChat.addEventListener is not supported, user new format for subscribe.')\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tsetCookie: () => {},\n\t\t\t\tgetCookie: () => {},\n\t\t\t\tsourceDomain\n\t\t\t};\n\t\t}\n\n\t\tif (typeof window.BxLiveChatInit === 'function')\n\t\t{\n\t\t\tlet config = window.BxLiveChatInit();\n\n\t\t\tif (config.user)\n\t\t\t{\n\t\t\t\tthis.__privateMethods__.setUserRegisterData(config.user);\n\t\t\t}\n\t\t\tif (config.firstMessage)\n\t\t\t{\n\t\t\t\tthis.__privateMethods__.setCustomData(config.firstMessage)\n\t\t\t}\n\t\t}\n\n\t\tif (window.BxLiveChatLoader instanceof Array)\n\t\t{\n\t\t\twindow.BxLiveChatLoader.forEach(callback => callback());\n\t\t}\n\n\t\treturn true;\n\t}\n}","/**\n * Bitrix OpenLines widget\n * LiveChat base component (Vue component)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {BitrixVue} from \"ui.vue\";\nimport {Vuex} from \"ui.vue.vuex\";\nimport {Utils} from \"im.lib.utils\";\nimport {Logger} from \"im.lib.logger\";\nimport {FormType, VoteType, LocationStyle, LocationType, LanguageType, EventType as WidgetEventType} from \"../const\";\nimport { DeviceType, DeviceOrientation, EventType, RestMethod as ImRestMethod } from \"im.const\";\nimport {\n\tDialogCore, TextareaCore, TextareaUploadFile, DialogReadMessages, DialogClickOnCommand, DialogClickOnUserName,\n\tDialogClickOnKeyboardButton, DialogClickOnMessageMenu, DialogClickOnMessageRetry, DialogSetMessageReaction,\n\tDialogClickOnUploadCancel\n} from 'im.mixin';\nimport {md5} from \"main.md5\";\nimport {EventEmitter} from \"main.core.events\";\n\n/**\n * @notice Do not mutate or clone this component! It is under development.\n */\nBitrixVue.component('bx-livechat',\n{\n\tmixins: [\n\t\tDialogCore, TextareaCore, TextareaUploadFile, DialogReadMessages, DialogClickOnCommand, DialogClickOnUserName,\n\t\tDialogClickOnKeyboardButton, DialogClickOnMessageMenu, DialogClickOnMessageRetry, DialogSetMessageReaction,\n\t\tDialogClickOnUploadCancel\n\t],\n\tdata()\n\t{\n\t\treturn {\n\t\t\tviewPortMetaSiteNode: null,\n\t\t\tviewPortMetaWidgetNode: null,\n\t\t\tstoredMessage: '',\n\t\t\tstoredFile: null,\n\t\t\twidgetMinimumHeight: 435,\n\t\t\twidgetMinimumWidth: 340,\n\t\t\twidgetBaseHeight: 557,\n\t\t\twidgetBaseWidth: 435,\n\t\t\twidgetMargin: 50,\n\t\t\twidgetAvailableHeight: 0,\n\t\t\twidgetAvailableWidth: 0,\n\t\t\twidgetCurrentHeight: 0,\n\t\t\twidgetCurrentWidth: 0,\n\t\t\twidgetDrag: false,\n\t\t\ttextareaFocused: false,\n\t\t\ttextareaDrag: false,\n\t\t\ttextareaHeight: 100,\n\t\t\ttextareaMinimumHeight: 100,\n\t\t\ttextareaMaximumHeight: Utils.device.isMobile()? 200: 300,\n\t\t\tzIndexStackInstance: null,\n\t\t}\n\t},\n\tcreated()\n\t{\n\t\tLogger.warn('bx-livechat created');\n\t\tthis.onCreated();\n\n\t\tdocument.addEventListener('keydown', this.onWindowKeyDown);\n\t\tif(!Utils.device.isMobile() && !this.widget.common.pageMode)\n\t\t{\n\t\t\twindow.addEventListener('resize', this.getAvailableSpaceFunc = Utils.throttle(this.getAvailableSpace, 50));\n\t\t}\n\t\tEventEmitter.subscribe(WidgetEventType.requestShowForm, this.onRequestShowForm);\n\t},\n\tmounted()\n\t{\n\t\tthis.zIndexStackInstance = this.$Bitrix.Data.get('zIndexStack');\n\t\tif (this.zIndexStackInstance && !!this.$refs.widgetWrapper)\n\t\t{\n\t\t\tthis.zIndexStackInstance.register(this.$refs.widgetWrapper);\n\t\t}\n\t},\n\tbeforeDestroy()\n\t{\n\t\tif (this.zIndexStackInstance)\n\t\t{\n\t\t\tthis.zIndexStackInstance.unregister(this.$refs.widgetWrapper);\n\t\t}\n\t\tdocument.removeEventListener('keydown', this.onWindowKeyDown);\n\t\tif(!Utils.device.isMobile() && !this.widget.common.pageMode)\n\t\t{\n\t\t\twindow.removeEventListener('resize', this.getAvailableSpaceFunc);\n\t\t}\n\t\tEventEmitter.unsubscribe(WidgetEventType.requestShowForm, this.onRequestShowForm);\n\n\t\tthis.onTextareaDragEventRemove();\n\t},\n\tcomputed:\n\t{\n\t\tFormType: () => FormType,\n\t\tVoteType: () => VoteType,\n\t\tDeviceType: () => DeviceType,\n\t\tEventType: () => EventType,\n\n\t\ttextareaHeightStyle(state)\n\t\t{\n\t\t\treturn {flex: '0 0 '+this.textareaHeight+'px'};\n\t\t},\n\t\ttextareaBottomMargin()\n\t\t{\n\t\t\tif (!this.widget.common.copyright && !this.isBottomLocation)\n\t\t\t{\n\t\t\t\treturn {marginBottom: '5px'};\n\t\t\t}\n\t\t\treturn '';\n\t\t},\n\t\twidgetBaseSizes()\n\t\t{\n\t\t\treturn {\n\t\t\t\twidth: this.widgetBaseWidth,\n\t\t\t\theight: this.widgetBaseHeight,\n\t\t\t}\n\t\t},\n\t\twidgetHeightStyle()\n\t\t{\n\t\t\tif(Utils.device.isMobile() || this.widget.common.pageMode)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.widgetAvailableHeight < this.widgetBaseSizes.height || this.widgetAvailableHeight < this.widgetCurrentHeight)\n\t\t\t{\n\t\t\t\tthis.widgetCurrentHeight = Math.max(this.widgetAvailableHeight, this.widgetMinimumHeight);\n\t\t\t}\n\n\t\t\treturn this.widgetCurrentHeight+'px';\n\t\t},\n\t\twidgetWidthStyle()\n\t\t{\n\t\t\tif(Utils.device.isMobile() || this.widget.common.pageMode)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.widgetAvailableWidth < this.widgetBaseSizes.width || this.widgetAvailableWidth < this.widgetCurrentWidth)\n\t\t\t{\n\t\t\t\tthis.widgetCurrentWidth = Math.max(this.widgetAvailableWidth, this.widgetMinimumWidth);\n\t\t\t}\n\n\t\t\treturn this.widgetCurrentWidth+'px';\n\t\t},\n\t\tuserSelectStyle()\n\t\t{\n\t\t\treturn this.widgetDrag ? 'none' : 'auto';\n\t\t},\n\t\tisBottomLocation()\n\t\t{\n\t\t\treturn [LocationType.bottomLeft, LocationType.bottomMiddle, LocationType.bottomRight].includes(this.widget.common.location);\n\t\t},\n\t\tisLeftLocation()\n\t\t{\n\t\t\treturn [LocationType.bottomLeft, LocationType.topLeft, LocationType.topMiddle].includes(this.widget.common.location);\n\t\t},\n\t\tlocalize()\n\t\t{\n\t\t\treturn BitrixVue.getFilteredPhrases('BX_LIVECHAT_', this);\n\t\t},\n\t\twidgetMobileDisabled(state)\n\t\t{\n\t\t\tif (state.application.device.type === DeviceType.mobile)\n\t\t\t{\n\t\t\t\tif (navigator.userAgent.toString().includes('iPad'))\n\t\t\t\t{\n\t\t\t\t}\n\t\t\t\telse if (state.application.device.orientation === DeviceOrientation.horizontal)\n\t\t\t\t{\n\t\t\t\t\tif (navigator.userAgent.toString().includes('iPhone'))\n\t\t\t\t\t{\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\treturn !(typeof window.screen === 'object' && window.screen.availHeight >= 800);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn false;\n\t\t},\n\t\twidgetClassName(state)\n\t\t{\n\t\t\tlet className = ['bx-livechat-wrapper'];\n\n\t\t\tclassName.push('bx-livechat-show');\n\n\t\t\tif (state.widget.common.pageMode)\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-page-mode');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-position-'+LocationStyle[state.widget.common.location]);\n\t\t\t}\n\n\t\t\tif (state.application.common.languageId === LanguageType.russian)\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-logo-ru');\n\t\t\t}\n\t\t\telse if (state.application.common.languageId === LanguageType.ukraine)\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-logo-ua');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-logo-en');\n\t\t\t}\n\n\t\t\tif (!state.widget.common.online)\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-offline-state');\n\t\t\t}\n\n\t\t\tif (state.widget.common.dragged)\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-drag-n-drop');\n\t\t\t}\n\n\t\t\tif (state.widget.common.dialogStart)\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-chat-start');\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\tstate.widget.dialog.operator.name\n\t\t\t\t&& !(state.application.device.type === DeviceType.mobile && state.application.device.orientation === DeviceOrientation.horizontal)\n\t\t\t)\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-has-operator');\n\t\t\t}\n\n\t\t\tif (Utils.device.isMobile())\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-mobile');\n\t\t\t}\n\t\t\telse if (Utils.browser.isSafari())\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-browser-safari');\n\t\t\t}\n\t\t\telse if (Utils.browser.isIe())\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-browser-ie');\n\t\t\t}\n\n\t\t\tif (Utils.platform.isMac())\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-mac');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-custom-scroll');\n\t\t\t}\n\n\t\t\tif (state.widget.common.styles.backgroundColor && Utils.isDarkColor(state.widget.common.styles.iconColor))\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-bright-header');\n\t\t\t}\n\n\t\t\treturn className.join(' ');\n\t\t},\n\t\tshowMessageDialog()\n\t\t{\n\t\t\treturn this.messageCollection.length > 0;\n\t\t},\n\t\t...Vuex.mapState({\n\t\t\twidget: state => state.widget,\n\t\t\tapplication: state => state.application,\n\t\t\tdialog: state => state.dialogues.collection[state.application.dialog.dialogId],\n\t\t\tmessageCollection: state => state.messages.collection[state.application.dialog.chatId]\n\t\t})\n\t},\n\twatch:\n\t{\n\t\tsessionClose(value)\n\t\t{\n\t\t\tLogger.log('sessionClose change', value);\n\t\t},\n\t\t//Redefined for uploadFile mixin\n\t\tdialogInited(newValue)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\t},\n\tmethods:\n\t{\n\t\tgetRestClient()\n\t\t{\n\t\t\treturn this.$Bitrix.RestClient.get();\n\t\t},\n\t\tgetApplication()\n\t\t{\n\t\t\treturn this.$Bitrix.Application.get();\n\t\t},\n\t\tonSendMessage({data: event})\n\t\t{\n\t\t\tevent.focus = event.focus !== false;s\n\n\t\t\t//hide smiles\n\t\t\tif (this.widget.common.showForm === FormType.smile)\n\t\t\t{\n\t\t\t\tthis.$store.commit('widget/common', {showForm: FormType.none});\n\t\t\t}\n\n\t\t\t//show consent window if needed\n\t\t\tif (!this.widget.dialog.userConsent && this.widget.common.consentUrl)\n\t\t\t{\n\t\t\t\tif (event.text)\n\t\t\t\t{\n\t\t\t\t\tthis.storedMessage = event.text;\n\t\t\t\t}\n\t\t\t\tthis.showConsentWidow();\n\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tevent.text = event.text? event.text: this.storedMessage;\n\t\t\tif (!event.text)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tthis.hideForm();\n\t\t\tthis.getApplication().addMessage(event.text);\n\n\t\t\tif (event.focus)\n\t\t\t{\n\t\t\t\tEventEmitter.emit(EventType.textarea.setFocus);\n\t\t\t}\n\n\t\t\treturn true;\n\t\t},\n\t\tclose(event)\n\t\t{\n\t\t\tif (this.widget.common.pageMode)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tthis.onBeforeClose();\n\t\t\tthis.$store.commit('widget/common', {showed: false});\n\t\t},\n\t\tgetAvailableSpace()\n\t\t{\n\t\t\tif (this.isBottomLocation)\n\t\t\t{\n\t\t\t\tlet bottomPosition = this.$refs.widgetWrapper.getBoundingClientRect().bottom;\n\t\t\t\tlet widgetBottomMargin = window.innerHeight - bottomPosition;\n\t\t\t\tthis.widgetAvailableHeight = window.innerHeight - this.widgetMargin - widgetBottomMargin;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tlet topPosition = this.$refs.widgetWrapper.getBoundingClientRect().top;\n\t\t\t\tthis.widgetAvailableHeight = window.innerHeight - this.widgetMargin - topPosition;\n\t\t\t}\n\n\t\t\tthis.widgetAvailableWidth = window.innerWidth - this.widgetMargin * 2;\n\t\t},\n\t\tshowLikeForm()\n\t\t{\n\t\t\tif (this.offline)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tclearTimeout(this.showFormTimeout);\n\t\t\tif (!this.widget.common.vote.enable)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tif (\n\t\t\t\tthis.widget.dialog.sessionClose\n\t\t\t\t&& this.widget.dialog.userVote !== VoteType.none\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tthis.$store.commit('widget/common', {showForm: FormType.like});\n\t\t},\n\t\tshowWelcomeForm()\n\t\t{\n\t\t\tclearTimeout(this.showFormTimeout);\n\t\t\tthis.$store.commit('widget/common', {showForm: FormType.welcome});\n\t\t},\n\t\tshowOfflineForm()\n\t\t{\n\t\t\tclearTimeout(this.showFormTimeout);\n\n\t\t\tif (this.widget.dialog.showForm !== FormType.welcome)\n\t\t\t{\n\t\t\t\tthis.$store.commit('widget/common', {showForm: FormType.offline});\n\t\t\t}\n\t\t},\n\t\tshowHistoryForm()\n\t\t{\n\t\t\tclearTimeout(this.showFormTimeout);\n\t\t\tthis.$store.commit('widget/common', {showForm: FormType.history});\n\t\t},\n\t\tonOpenMenu(event)\n\t\t{\n\t\t\tthis.getApplication().getHtmlHistory();\n\t\t},\n\t\thideForm()\n\t\t{\n\t\t\tclearTimeout(this.showFormTimeout);\n\n\t\t\tif (this.widget.common.showForm !== FormType.none)\n\t\t\t{\n\t\t\t\tthis.$store.commit('widget/common', {showForm: FormType.none});\n\t\t\t}\n\t\t},\n\t\tshowConsentWidow()\n\t\t{\n\t\t\tthis.$store.commit('widget/common', {showConsent: true});\n\t\t},\n\t\tagreeConsentWidow()\n\t\t{\n\t\t\tthis.$store.commit('widget/common', {showConsent: false});\n\n\t\t\tthis.getApplication().sendConsentDecision(true);\n\n\t\t\tif (this.storedMessage || this.storedFile)\n\t\t\t{\n\t\t\t\tif (this.storedMessage)\n\t\t\t\t{\n\t\t\t\t\tthis.onSendMessage({data: {focus: this.application.device.type !== DeviceType.mobile}});\n\t\t\t\t\tthis.storedMessage = '';\n\t\t\t\t}\n\t\t\t\tif (this.storedFile)\n\t\t\t\t{\n\t\t\t\t\tthis.onTextareaFileSelected();\n\t\t\t\t\tthis.storedFile = '';\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (this.widget.common.showForm === FormType.none)\n\t\t\t{\n\t\t\t\tEventEmitter.emit(EventType.textarea.setFocus);\n\t\t\t}\n\t\t},\n\t\tdisagreeConsentWidow()\n\t\t{\n\t\t\tthis.$store.commit('widget/common', {showForm : FormType.none});\n\t\t\tthis.$store.commit('widget/common', {showConsent : false});\n\n\t\t\tthis.getApplication().sendConsentDecision(false);\n\n\t\t\tif (this.storedMessage)\n\t\t\t{\n\t\t\t\tEventEmitter.emit(EventType.textarea.insertText, {\n\t\t\t\t\ttext: this.storedMessage,\n\t\t\t\t\tfocus: this.application.device.type !== DeviceType.mobile\n\t\t\t\t});\n\t\t\t\tthis.storedMessage = '';\n\t\t\t}\n\t\t\tif (this.storedFile)\n\t\t\t{\n\t\t\t\tthis.storedFile = '';\n\t\t\t}\n\n\t\t\tif (this.application.device.type !== DeviceType.mobile)\n\t\t\t{\n\t\t\t\tEventEmitter.emit(EventType.textarea.setFocus);\n\t\t\t}\n\t\t},\n\t\tlogEvent(name, ...params)\n\t\t{\n\t\t\tLogger.info(name, ...params);\n\t\t},\n\t\tonCreated()\n\t\t{\n\t\t\tif(Utils.device.isMobile())\n\t\t\t{\n\t\t\t\tlet viewPortMetaSiteNode = Array.from(\n\t\t\t\t\tdocument.head.getElementsByTagName('meta')\n\t\t\t\t).filter(element => element.name === 'viewport')[0];\n\n\t\t\t\tif (viewPortMetaSiteNode)\n\t\t\t\t{\n\t\t\t\t\tthis.viewPortMetaSiteNode = viewPortMetaSiteNode;\n\t\t\t\t\tdocument.head.removeChild(this.viewPortMetaSiteNode);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tlet contentWidth = document.body.offsetWidth;\n\t\t\t\t\tif (contentWidth < window.innerWidth)\n\t\t\t\t\t{\n\t\t\t\t\t\tcontentWidth = window.innerWidth;\n\t\t\t\t\t}\n\t\t\t\t\tif (contentWidth < 1024)\n\t\t\t\t\t{\n\t\t\t\t\t\tcontentWidth = 1024;\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.viewPortMetaSiteNode = document.createElement('meta');\n\t\t\t\t\tthis.viewPortMetaSiteNode.setAttribute('name', 'viewport');\n\t\t\t\t\tthis.viewPortMetaSiteNode.setAttribute('content', `width=${contentWidth}, initial-scale=1.0, user-scalable=1`);\n\t\t\t\t}\n\n\t\t\t\tif (!this.viewPortMetaWidgetNode)\n\t\t\t\t{\n\t\t\t\t\tthis.viewPortMetaWidgetNode = document.createElement('meta');\n\t\t\t\t\tthis.viewPortMetaWidgetNode.setAttribute('name', 'viewport');\n\t\t\t\t\tthis.viewPortMetaWidgetNode.setAttribute('content', 'width=device-width, initial-scale=1.0, user-scalable=0');\n\t\t\t\t\tdocument.head.appendChild(this.viewPortMetaWidgetNode);\n\t\t\t\t}\n\n\t\t\t\tdocument.body.classList.add('bx-livechat-mobile-state');\n\n\t\t\t\tif (Utils.browser.isSafariBased())\n\t\t\t\t{\n\t\t\t\t\tdocument.body.classList.add('bx-livechat-mobile-safari-based');\n\t\t\t\t}\n\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tthis.$store.dispatch('widget/show');\n\t\t\t\t}, 50);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.$store.dispatch('widget/show').then(() => {\n\t\t\t\t\tthis.widgetCurrentHeight = this.widgetBaseSizes.height;\n\t\t\t\t\tthis.widgetCurrentWidth = this.widgetBaseSizes.width;\n\t\t\t\t\tthis.getAvailableSpace();\n\n\t\t\t\t\tthis.widgetCurrentHeight = this.widget.common.widgetHeight || this.widgetCurrentHeight;\n\t\t\t\t\tthis.widgetCurrentWidth = this.widget.common.widgetWidth || this.widgetCurrentWidth;\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis.textareaHeight = this.widget.common.textareaHeight || this.textareaHeight;\n\n\t\t\tthis.$store.commit('files/initCollection', {chatId: this.getApplication().getChatId()});\n\t\t\tthis.$store.commit('messages/initCollection', {chatId: this.getApplication().getChatId()});\n\t\t\tthis.$store.commit('dialogues/initCollection', {dialogId: this.getApplication().getDialogId(), fields: {\n\t\t\t\tentityType: 'LIVECHAT',\n\t\t\t\ttype: 'livechat'\n\t\t\t}});\n\t\t},\n\t\tonBeforeClose()\n\t\t{\n\t\t\tif(Utils.device.isMobile())\n\t\t\t{\n\t\t\t\tdocument.body.classList.remove('bx-livechat-mobile-state');\n\n\t\t\t\tif (Utils.browser.isSafariBased())\n\t\t\t\t{\n\t\t\t\t\tdocument.body.classList.remove('bx-livechat-mobile-safari-based');\n\t\t\t\t}\n\n\t\t\t\tif (this.viewPortMetaWidgetNode)\n\t\t\t\t{\n\t\t\t\t\tdocument.head.removeChild(this.viewPortMetaWidgetNode);\n\t\t\t\t\tthis.viewPortMetaWidgetNode = null;\n\t\t\t\t}\n\n\t\t\t\tif (this.viewPortMetaSiteNode)\n\t\t\t\t{\n\t\t\t\t\tdocument.head.appendChild(this.viewPortMetaSiteNode);\n\t\t\t\t\tthis.viewPortMetaSiteNode = null;\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tonAfterClose()\n\t\t{\n\t\t\tthis.getApplication().close();\n\t\t},\n\t\tonRequestShowForm({data: event})\n\t\t{\n\t\t\tclearTimeout(this.showFormTimeout);\n\t\t\tif (event.type === FormType.welcome)\n\t\t\t{\n\t\t\t\tif (event.delayed)\n\t\t\t\t{\n\t\t\t\t\tthis.showFormTimeout = setTimeout(() => {\n\t\t\t\t\t\tthis.showWelcomeForm();\n\t\t\t\t\t}, 5000);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.showWelcomeForm();\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (event.type === FormType.offline)\n\t\t\t{\n\t\t\t\tif (event.delayed)\n\t\t\t\t{\n\t\t\t\t\tthis.showFormTimeout = setTimeout(() => {\n\t\t\t\t\t\tthis.showOfflineForm();\n\t\t\t\t\t}, 3000);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.showOfflineForm();\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (event.type === FormType.like)\n\t\t\t{\n\t\t\t\tif (event.delayed)\n\t\t\t\t{\n\t\t\t\t\tthis.showFormTimeout = setTimeout(() => {\n\t\t\t\t\t\tthis.showLikeForm();\n\t\t\t\t\t}, 5000);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.showLikeForm();\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tonDialogRequestHistory(event)\n\t\t{\n\t\t\tthis.getApplication().getDialogHistory(event.lastId);\n\t\t},\n\t\tonDialogRequestUnread(event)\n\t\t{\n\t\t\tthis.getApplication().getDialogUnread(event.lastId);\n\t\t},\n\t\tonClickOnUserName({data: event})\n\t\t{\n\t\t\t// TODO name push to auto-replace mention holder - User Name -> [USER=274]User Name[/USER]\n\t\t\tEventEmitter.emit(EventType.textarea.insertText, {text: event.user.name + ', '});\n\t\t},\n\t\tonClickOnUploadCancel({data: event})\n\t\t{\n\t\t\tthis.getApplication().cancelUploadFile(event.file.id);\n\t\t},\n\t\tonClickOnKeyboardButton({data: event})\n\t\t{\n\t\t\tthis.getApplication().execMessageKeyboardCommand(event);\n\t\t},\n\t\tonClickOnCommand({data: event})\n\t\t{\n\t\t\tif (event.type === 'put')\n\t\t\t{\n\t\t\t\tEventEmitter.emit(EventType.textarea.insertText, {text: event.value + ' '});\n\t\t\t}\n\t\t\telse if (event.type === 'send')\n\t\t\t{\n\t\t\t\tthis.getApplication().addMessage(event.value);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tLogger.warn('Unprocessed command', event);\n\t\t\t}\n\t\t},\n\t\tonClickOnMessageMenu({data: event})\n\t\t{\n\t\t\tLogger.warn('Message menu:', event);\n\t\t},\n\t\tonClickOnMessageRetry({data: event})\n\t\t{\n\t\t\tLogger.warn('Message retry:', event);\n\t\t\tthis.getApplication().retrySendMessage(event.message);\n\t\t},\n\t\tonReadMessage({data: event})\n\t\t{\n\t\t\tthis.getApplication().readMessage(event.id);\n\t\t},\n\t\tonSetMessageReaction({data: event})\n\t\t{\n\t\t\tthis.getApplication().reactMessage(event.message.id, event.reaction);\n\t\t},\n\t\tonClickOnDialog({data: event})\n\t\t{\n\t\t\tif (this.widget.common.showForm !== FormType.none)\n\t\t\t{\n\t\t\t\tthis.$store.commit('widget/common', {showForm: FormType.none});\n\t\t\t}\n\t\t},\n\t\tonTextareaKeyUp({data: event})\n\t\t{\n\t\t\tif (\n\t\t\t\tthis.widget.common.watchTyping\n\t\t\t\t&& this.widget.dialog.sessionId\n\t\t\t\t&& !this.widget.dialog.sessionClose\n\t\t\t\t&& this.widget.dialog.operator.id\n\t\t\t\t&& this.widget.dialog.operatorChatId\n\t\t\t\t&& this.$Bitrix.PullClient.get().isPublishingEnabled()\n\t\t\t)\n\t\t\t{\n\t\t\t\tlet infoString = md5(\n\t\t\t\t\tthis.widget.dialog.sessionId\n\t\t\t\t\t+ '/' + this.application.dialog.chatId\n\t\t\t\t\t+ '/' + this.widget.user.id\n\t\t\t\t);\n\t\t\t\tthis.$Bitrix.PullClient.get().sendMessage(\n\t\t\t\t\t[this.widget.dialog.operator.id],\n\t\t\t\t\t'imopenlines',\n\t\t\t\t\t'linesMessageWrite',\n\t\t\t\t\t{\n\t\t\t\t\t\ttext: event.text,\n\t\t\t\t\t\tinfoString,\n\t\t\t\t\t\toperatorChatId: this.widget.dialog.operatorChatId\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t},\n\t\tonTextareaFocus({data: event})\n\t\t{\n\t\t\tif (\n\t\t\t\tthis.widget.common.copyright &&\n\t\t\t\tthis.application.device.type === DeviceType.mobile\n\t\t\t)\n\t\t\t{\n\t\t\t\tthis.widget.common.copyright = false;\n\t\t\t}\n\t\t\tif (Utils.device.isMobile())\n\t\t\t{\n\t\t\t\tclearTimeout(this.onTextareaFocusScrollTimeout);\n\t\t\t\tthis.onTextareaFocusScrollTimeout = setTimeout(() => {\n\t\t\t\t\tdocument.addEventListener('scroll', this.onWindowScroll);\n\t\t\t\t}, 1000);\n\t\t\t}\n\t\t\tthis.textareaFocused = true;\n\t\t},\n\t\tonTextareaBlur({data: event})\n\t\t{\n\t\t\tif (!this.widget.common.copyright && this.widget.common.copyright !== this.getApplication().copyright)\n\t\t\t{\n\t\t\t\tthis.widget.common.copyright = this.getApplication().copyright;\n\t\t\t\tthis.$nextTick(() => {\n\t\t\t\t\tEventEmitter.emit(EventType.dialog.scrollToBottom, {chatId: this.chatId, force: true});\n\t\t\t\t});\n\t\t\t}\n\t\t\tif (Utils.device.isMobile())\n\t\t\t{\n\t\t\t\tclearTimeout(this.onTextareaFocusScrollTimeout);\n\t\t\t\tdocument.removeEventListener('scroll', this.onWindowScroll);\n\t\t\t}\n\n\t\t\tthis.textareaFocused = false;\n\t\t},\n\t\tonTextareaStartDrag(event)\n\t\t{\n\t\t\tif (this.textareaDrag)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tLogger.log('Livechat: textarea drag started');\n\n\t\t\tthis.textareaDrag = true;\n\n\t\t\tevent = event.changedTouches ? event.changedTouches[0] : event;\n\n\t\t\tthis.textareaDragCursorStartPoint = event.clientY;\n\t\t\tthis.textareaDragHeightStartPoint = this.textareaHeight;\n\n\t\t\tthis.onTextareaDragEventAdd();\n\n\t\t\tEventEmitter.emit(EventType.textarea.setBlur, true);\n\t\t},\n\t\tonTextareaContinueDrag(event)\n\t\t{\n\t\t\tif (!this.textareaDrag)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tevent = event.changedTouches ? event.changedTouches[0] : event;\n\n\t\t\tthis.textareaDragCursorControlPoint = event.clientY;\n\n\t\t\tlet textareaHeight = Math.max(\n\t\t\t\tMath.min(this.textareaDragHeightStartPoint + this.textareaDragCursorStartPoint - this.textareaDragCursorControlPoint, this.textareaMaximumHeight)\n\t\t\t, this.textareaMinimumHeight);\n\n\t\t\tLogger.log('Livechat: textarea drag', 'new: '+textareaHeight, 'curr: '+this.textareaHeight);\n\n\t\t\tif (this.textareaHeight !== textareaHeight)\n\t\t\t{\n\t\t\t\tthis.textareaHeight = textareaHeight;\n\t\t\t}\n\t\t},\n\t\tonTextareaStopDrag()\n\t\t{\n\t\t\tif (!this.textareaDrag)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tLogger.log('Livechat: textarea drag ended');\n\n\t\t\tthis.textareaDrag = false;\n\n\t\t\tthis.onTextareaDragEventRemove();\n\n\t\t\tthis.$store.commit('widget/common', {textareaHeight: this.textareaHeight});\n\t\t\tEventEmitter.emit(EventType.dialog.scrollToBottom, {chatId: this.chatId, force: true});\n\t\t},\n\t\tonTextareaDragEventAdd()\n\t\t{\n\t\t\tdocument.addEventListener('mousemove', this.onTextareaContinueDrag);\n\t\t\tdocument.addEventListener('touchmove', this.onTextareaContinueDrag);\n\t\t\tdocument.addEventListener('touchend', this.onTextareaStopDrag);\n\t\t\tdocument.addEventListener('mouseup', this.onTextareaStopDrag);\n\t\t\tdocument.addEventListener('mouseleave', this.onTextareaStopDrag);\n\t\t},\n\t\tonTextareaDragEventRemove()\n\t\t{\n\t\t\tdocument.removeEventListener('mousemove', this.onTextareaContinueDrag);\n\t\t\tdocument.removeEventListener('touchmove', this.onTextareaContinueDrag);\n\t\t\tdocument.removeEventListener('touchend', this.onTextareaStopDrag);\n\t\t\tdocument.removeEventListener('mouseup', this.onTextareaStopDrag);\n\t\t\tdocument.removeEventListener('mouseleave', this.onTextareaStopDrag);\n\t\t},\n\t\tonTextareaFileSelected({data: event} = {})\n\t\t{\n\t\t\tlet fileInputEvent = null;\n\t\t\tif (event && event.fileChangeEvent && event.fileChangeEvent.target.files.length > 0)\n\t\t\t{\n\t\t\t\tfileInputEvent = event.fileChangeEvent;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tfileInputEvent =  this.storedFile;\n\t\t\t}\n\n\t\t\tif (!fileInputEvent)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (!this.widget.dialog.userConsent && this.widget.common.consentUrl)\n\t\t\t{\n\t\t\t\tthis.storedFile = event.fileChangeEvent;\n\t\t\t\tthis.showConsentWidow();\n\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tthis.getApplication().uploadFile(fileInputEvent);\n\t\t},\n\t\tonTextareaAppButtonClick({data: event})\n\t\t{\n\t\t\tif (event.appId === FormType.smile)\n\t\t\t{\n\t\t\t\tif (this.widget.common.showForm === FormType.smile)\n\t\t\t\t{\n\t\t\t\t\tthis.$store.commit('widget/common', {showForm: FormType.none});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.$store.commit('widget/common', {showForm: FormType.smile});\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tEventEmitter.emit(EventType.textarea.setFocus);\n\t\t\t}\n\t\t},\n\t\tonTextareaEdit({data: event})\n\t\t{\n\t\t\tthis.logEvent('edit message', event);\n\t\t},\n\t\tonPullRequestConfig(event)\n\t\t{\n\t\t\tthis.getApplication().recoverPullConnection();\n\t\t},\n\t\tonSmilesSelectSmile(event)\n\t\t{\n\t\t\tEventEmitter.emit(EventType.textarea.insertText, {text: event.text});\n\t\t},\n\t\tonSmilesSelectSet()\n\t\t{\n\t\t\tEventEmitter.emit(EventType.textarea.setFocus);\n\t\t},\n\t\tonWidgetStartDrag(event)\n\t\t{\n\t\t\tif (this.widgetDrag)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.widgetDrag = true;\n\n\t\t\tevent = event.changedTouches ? event.changedTouches[0] : event;\n\n\t\t\tthis.widgetDragCursorStartPointY = event.clientY;\n\t\t\tthis.widgetDragCursorStartPointX = event.clientX;\n\t\t\tthis.widgetDragHeightStartPoint = this.widgetCurrentHeight;\n\t\t\tthis.widgetDragWidthStartPoint = this.widgetCurrentWidth;\n\n\t\t\tthis.onWidgetDragEventAdd();\n\t\t},\n\t\tonWidgetContinueDrag(event)\n\t\t{\n\t\t\tif (!this.widgetDrag)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tevent = event.changedTouches ? event.changedTouches[0] : event;\n\n\t\t\tthis.widgetDragCursorControlPointY = event.clientY;\n\t\t\tthis.widgetDragCursorControlPointX = event.clientX;\n\n\t\t\tlet widgetHeight = 0;\n\n\t\t\tif (this.isBottomLocation)\n\t\t\t{\n\t\t\t\twidgetHeight = Math.max(\n\t\t\t\t\tMath.min(this.widgetDragHeightStartPoint + this.widgetDragCursorStartPointY - this.widgetDragCursorControlPointY, this.widgetAvailableHeight),\n\t\t\t\t\tthis.widgetMinimumHeight\n\t\t\t\t);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\twidgetHeight = Math.max(\n\t\t\t\t\tMath.min(this.widgetDragHeightStartPoint - this.widgetDragCursorStartPointY + this.widgetDragCursorControlPointY, this.widgetAvailableHeight),\n\t\t\t\t\tthis.widgetMinimumHeight\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tlet widgetWidth = 0;\n\t\t\tif (this.isLeftLocation)\n\t\t\t{\n\t\t\t\twidgetWidth = Math.max(\n\t\t\t\t\tMath.min(this.widgetDragWidthStartPoint - this.widgetDragCursorStartPointX + this.widgetDragCursorControlPointX, this.widgetAvailableWidth),\n\t\t\t\t\tthis.widgetMinimumWidth\n\t\t\t\t);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\twidgetWidth = Math.max(\n\t\t\t\t\tMath.min(this.widgetDragWidthStartPoint + this.widgetDragCursorStartPointX - this.widgetDragCursorControlPointX, this.widgetAvailableWidth),\n\t\t\t\t\tthis.widgetMinimumWidth\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tif (this.widgetCurrentHeight !== widgetHeight)\n\t\t\t{\n\t\t\t\tthis.widgetCurrentHeight = widgetHeight;\n\t\t\t}\n\n\t\t\tif (this.widgetCurrentWidth !== widgetWidth)\n\t\t\t{\n\t\t\t\tthis.widgetCurrentWidth = widgetWidth;\n\t\t\t}\n\t\t},\n\t\tonWidgetStopDrag()\n\t\t{\n\t\t\tif (!this.widgetDrag)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.widgetDrag = false;\n\n\t\t\tthis.onWidgetDragEventRemove();\n\n\t\t\tthis.$store.commit('widget/common', {widgetHeight: this.widgetCurrentHeight, widgetWidth: this.widgetCurrentWidth});\n\t\t},\n\t\tonWidgetDragEventAdd()\n\t\t{\n\t\t\tdocument.addEventListener('mousemove', this.onWidgetContinueDrag);\n\t\t\tdocument.addEventListener('mouseup', this.onWidgetStopDrag);\n\t\t\tdocument.addEventListener('mouseleave', this.onWidgetStopDrag);\n\t\t},\n\t\tonWidgetDragEventRemove()\n\t\t{\n\t\t\tdocument.removeEventListener('mousemove', this.onWidgetContinueDrag);\n\t\t\tdocument.removeEventListener('mouseup', this.onWidgetStopDrag);\n\t\t\tdocument.removeEventListener('mouseleave', this.onWidgetStopDrag);\n\t\t},\n\t\tonWindowKeyDown(event)\n\t\t{\n\t\t\tif (event.keyCode === 27)\n\t\t\t{\n\t\t\t\tif (this.widget.common.showForm !== FormType.none)\n\t\t\t\t{\n\t\t\t\t\tthis.$store.commit('widget/common', {showForm: FormType.none});\n\t\t\t\t}\n\t\t\t\telse if (this.widget.common.showConsent)\n\t\t\t\t{\n\t\t\t\t\tthis.disagreeConsentWidow();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.close();\n\t\t\t\t}\n\n\t\t\t\tevent.preventDefault();\n\t\t\t\tevent.stopPropagation();\n\n\t\t\t\tEventEmitter.emit(EventType.textarea.setFocus);\n\t\t\t}\n\t\t},\n\t\tonWindowScroll(event)\n\t\t{\n\t\t\tclearTimeout(this.onWindowScrollTimeout);\n\t\t\tthis.onWindowScrollTimeout = setTimeout(() => {\n\t\t\t\tEventEmitter.emit(EventType.textarea.setBlur, true);\n\t\t\t}, 50);\n\t\t},\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<transition enter-active-class=\"bx-livechat-show\" leave-active-class=\"bx-livechat-close\" @after-leave=\"onAfterClose\">\n\t\t\t<div :class=\"widgetClassName\" v-if=\"widget.common.showed\" :style=\"{height: widgetHeightStyle, width: widgetWidthStyle, userSelect: userSelectStyle}\" ref=\"widgetWrapper\">\n\t\t\t\t<div class=\"bx-livechat-box\">\n\t\t\t\t\t<div v-if=\"isBottomLocation\" class=\"bx-livechat-widget-resize-handle\" @mousedown=\"onWidgetStartDrag\"></div>\n\t\t\t\t\t<bx-livechat-head :isWidgetDisabled=\"widgetMobileDisabled\" @like=\"showLikeForm\" @openMenu=\"onOpenMenu\" @close=\"close\"/>\n\t\t\t\t\t<template v-if=\"widgetMobileDisabled\">\n\t\t\t\t\t\t<bx-livechat-body-orientation-disabled/>\n\t\t\t\t\t</template>\n\t\t\t\t\t<template v-else-if=\"application.error.active\">\n\t\t\t\t\t\t<bx-livechat-body-error/>\n\t\t\t\t\t</template>\n\t\t\t\t\t<template v-else-if=\"!widget.common.configId\">\n\t\t\t\t\t\t<div class=\"bx-livechat-body\" key=\"loading-body\">\n\t\t\t\t\t\t\t<bx-livechat-body-loading/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</template>\t\t\t\n\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t<template v-if=\"!widget.common.dialogStart\">\n\t\t\t\t\t\t\t<div class=\"bx-livechat-body\" key=\"welcome-body\">\n\t\t\t\t\t\t\t\t<bx-livechat-body-operators/>\n\t\t\t\t\t\t\t\t<keep-alive include=\"bx-livechat-smiles\">\n\t\t\t\t\t\t\t\t\t<template v-if=\"widget.common.showForm === FormType.smile\">\n\t\t\t\t\t\t\t\t\t\t<bx-livechat-smiles @selectSmile=\"onSmilesSelectSmile\" @selectSet=\"onSmilesSelectSet\"/>\t\n\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t</keep-alive>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t\t<template v-else-if=\"widget.common.dialogStart\">\n\t\t\t\t\t\t\t<bx-pull-component-status :canReconnect=\"true\" @reconnect=\"onPullRequestConfig\"/>\n\t\t\t\t\t\t\t<div :class=\"['bx-livechat-body', {'bx-livechat-body-with-message': showMessageDialog}]\" key=\"with-message\">\n\t\t\t\t\t\t\t\t<template v-if=\"showMessageDialog\">\n\t\t\t\t\t\t\t\t\t<div class=\"bx-livechat-dialog\">\n\t\t\t\t\t\t\t\t\t\t<bx-im-component-dialog\n\t\t\t\t\t\t\t\t\t\t\t:userId=\"application.common.userId\" \n\t\t\t\t\t\t\t\t\t\t\t:dialogId=\"application.dialog.dialogId\"\n\t\t\t\t\t\t\t\t\t\t\t:messageLimit=\"application.dialog.messageLimit\"\n\t\t\t\t\t\t\t\t\t\t\t:enableReactions=\"true\"\n\t\t\t\t\t\t\t\t\t\t\t:enableDateActions=\"false\"\n\t\t\t\t\t\t\t\t\t\t\t:enableCreateContent=\"false\"\n\t\t\t\t\t\t\t\t\t\t\t:enableGestureQuote=\"true\"\n\t\t\t\t\t\t\t\t\t\t\t:enableGestureMenu=\"true\"\n\t\t\t\t\t\t\t\t\t\t\t:showMessageAvatar=\"false\"\n\t\t\t\t\t\t\t\t\t\t\t:showMessageMenu=\"false\"\n\t\t\t\t\t\t\t\t\t\t\t:skipDataRequest=\"true\"\n\t\t\t\t\t\t\t\t\t\t\t:showLoadingState=\"false\"\n\t\t\t\t\t\t\t\t\t\t\t:showEmptyState=\"false\"\n\t\t\t\t\t\t\t\t\t\t />\n\t\t\t\t\t\t\t\t\t</div>\t \n\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t\t\t\t<bx-livechat-body-loading/>\n\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t  \n\t\t\t\t\t\t\t\t<keep-alive include=\"bx-livechat-smiles\">\n\t\t\t\t\t\t\t\t\t<template v-if=\"widget.common.showForm === FormType.like && widget.common.vote.enable\">\n\t\t\t\t\t\t\t\t\t\t<bx-livechat-form-vote/>\n\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t\t<template v-else-if=\"widget.common.showForm === FormType.welcome\">\n\t\t\t\t\t\t\t\t\t\t<bx-livechat-form-welcome/>\t\n\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t\t<template v-else-if=\"widget.common.showForm === FormType.offline\">\n\t\t\t\t\t\t\t\t\t\t<bx-livechat-form-offline/>\t\n\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t\t<template v-else-if=\"widget.common.showForm === FormType.history\">\n\t\t\t\t\t\t\t\t\t\t<bx-livechat-form-history/>\t\n\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t\t<template v-else-if=\"widget.common.showForm === FormType.smile\">\n\t\t\t\t\t\t\t\t\t\t<bx-livechat-smiles @selectSmile=\"onSmilesSelectSmile\" @selectSet=\"onSmilesSelectSet\"/>\t\n\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t</keep-alive>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</template>\t\n\t\t\t\t\t\t<div class=\"bx-livechat-textarea\" :style=\"[textareaHeightStyle, textareaBottomMargin]\" ref=\"textarea\">\n\t\t\t\t\t\t\t<div class=\"bx-livechat-textarea-resize-handle\" @mousedown=\"onTextareaStartDrag\" @touchstart=\"onTextareaStartDrag\"></div>\n\t\t\t\t\t\t\t<bx-im-component-textarea\n\t\t\t\t\t\t\t\t:siteId=\"application.common.siteId\"\n\t\t\t\t\t\t\t\t:userId=\"application.common.userId\"\n\t\t\t\t\t\t\t\t:dialogId=\"application.dialog.dialogId\"\n\t\t\t\t\t\t\t\t:writesEventLetter=\"3\"\n\t\t\t\t\t\t\t\t:enableEdit=\"true\"\n\t\t\t\t\t\t\t\t:enableCommand=\"false\"\n\t\t\t\t\t\t\t\t:enableMention=\"false\"\n\t\t\t\t\t\t\t\t:enableFile=\"application.disk.enabled\"\n\t\t\t\t\t\t\t\t:autoFocus=\"application.device.type !== DeviceType.mobile\"\n\t\t\t\t\t\t\t\t:styles=\"{button: {backgroundColor: widget.common.styles.backgroundColor, iconColor: widget.common.styles.iconColor}}\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div v-if=\"!widget.common.copyright && !isBottomLocation\" class=\"bx-livechat-nocopyright-resize-wrap\" style=\"position: relative;\">\n\t\t\t\t\t\t\t<div class=\"bx-livechat-widget-resize-handle\" @mousedown=\"onWidgetStartDrag\"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<bx-livechat-form-consent @agree=\"agreeConsentWidow\" @disagree=\"disagreeConsentWidow\"/>\n\t\t\t\t\t\t<template v-if=\"widget.common.copyright\">\n\t\t\t\t\t\t\t<div class=\"bx-livechat-copyright\">\t\n\t\t\t\t\t\t\t\t<template v-if=\"widget.common.copyrightUrl\">\n\t\t\t\t\t\t\t\t\t<a class=\"bx-livechat-copyright-link\" :href=\"widget.common.copyrightUrl\" target=\"_blank\">\n\t\t\t\t\t\t\t\t\t\t<span class=\"bx-livechat-logo-name\">{{localize.BX_LIVECHAT_COPYRIGHT_TEXT}}</span>\n\t\t\t\t\t\t\t\t\t\t<span class=\"bx-livechat-logo-icon\"></span>\n\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t\t\t\t<span class=\"bx-livechat-logo-name\">{{localize.BX_LIVECHAT_COPYRIGHT_TEXT}}</span>\n\t\t\t\t\t\t\t\t\t<span class=\"bx-livechat-logo-icon\"></span>\n\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t<div v-if=\"!isBottomLocation\" class=\"bx-livechat-widget-resize-handle\" @mousedown=\"onWidgetStartDrag\"></div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</template>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</transition>\n\t`\n});","/**\n * Bitrix OpenLines widget\n * Body error component (Vue component)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {BitrixVue} from \"ui.vue\";\nimport {Vuex} from \"ui.vue.vuex\";\n\nBitrixVue.component('bx-livechat-body-error',\n{\n\tcomputed:\n\t{\n\t\t...Vuex.mapState({\n\t\t\tapplication: state => state.application\n\t\t}),\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-livechat-body\" key=\"error-body\">\n\t\t\t<div class=\"bx-livechat-warning-window\">\n\t\t\t\t<div class=\"bx-livechat-warning-icon\"></div>\n\t\t\t\t<template v-if=\"application.error.description\"> \n\t\t\t\t\t<div class=\"bx-livechat-help-title bx-livechat-help-title-sm bx-livechat-warning-msg\" v-html=\"application.error.description\"></div>\n\t\t\t\t</template> \n\t\t\t\t<template v-else>\n\t\t\t\t\t<div class=\"bx-livechat-help-title bx-livechat-help-title-md bx-livechat-warning-msg\">{{$Bitrix.Loc.getMessage('BX_LIVECHAT_ERROR_TITLE')}}</div>\n\t\t\t\t\t<div class=\"bx-livechat-help-title bx-livechat-help-title-sm bx-livechat-warning-msg\">{{$Bitrix.Loc.getMessage('BX_LIVECHAT_ERROR_DESC')}}</div>\n\t\t\t\t</template> \n\t\t\t</div>\n\t\t</div>\n\t`\n});\n","/**\n * Bitrix OpenLines widget\n * Head component (Vue component)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {BitrixVue} from \"ui.vue\";\nimport {Vuex} from \"ui.vue.vuex\";\nimport { SessionStatus, VoteType } from \"../const\";\nimport {EventType} from \"im.const\";\nimport { Browser } from \"main.core.minimal\";\n\nBitrixVue.component('bx-livechat-head',\n{\n\t/**\n\t * @emits 'close'\n\t * @emits 'like'\n\t * @emits 'history'\n\t */\n\tprops:\n\t{\n\t\tisWidgetDisabled: { default: false },\n\t},\n\tmethods:\n\t{\n\t\tclose(event)\n\t\t{\n\t\t\tthis.$emit('close');\n\t\t},\n\t\tlike(event)\n\t\t{\n\t\t\tthis.$emit('like');\n\t\t},\n\t\topenMenu(event)\n\t\t{\n\t\t\tthis.$emit('openMenu', event);\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tVoteType: () => VoteType,\n\n\t\tchatId()\n\t\t{\n\t\t\tif (this.application)\n\t\t\t{\n\t\t\t\treturn this.application.dialog.chatId;\n\t\t\t}\n\t\t},\n\n\t\tcustomBackgroundStyle(state)\n\t\t{\n\t\t\treturn state.widget.common.styles.backgroundColor? 'background-color: '+state.widget.common.styles.backgroundColor+'!important;': '';\n\t\t},\n\t\tcustomBackgroundOnlineStyle(state)\n\t\t{\n\t\t\treturn state.widget.common.styles.backgroundColor? 'border-color: '+state.widget.common.styles.backgroundColor+'!important;': '';\n\t\t},\n\t\tshowName(state)\n\t\t{\n\t\t\treturn state.widget.dialog.operator.firstName || state.widget.dialog.operator.lastName;\n\t\t},\n\t\tvoteActive(state)\n\t\t{\n\t\t\tif (!!state.widget.dialog.closeVote)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\t!state.widget.common.vote.beforeFinish\n\t\t\t\t&& state.widget.dialog.sessionStatus < SessionStatus.waitClient\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (!state.widget.dialog.sessionClose || state.widget.dialog.sessionClose && state.widget.dialog.userVote === VoteType.none)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tif (state.widget.dialog.sessionClose && state.widget.dialog.userVote !== VoteType.none)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\treturn false;\n\t\t},\n\t\tchatTitle(state)\n\t\t{\n\t\t\treturn state.widget.common.textMessages.bxLivechatTitle\n\t\t\t\t|| state.widget.common.configName\n\t\t\t\t|| this.localize.BX_LIVECHAT_TITLE\n\t\t},\n\t\toperatorName(state)\n\t\t{\n\t\t\tif (!this.showName)\n\t\t\t\treturn '';\n\n\t\t\treturn state.widget.dialog.operator.firstName? state.widget.dialog.operator.firstName: state.widget.dialog.operator.name\n\t\t},\n\t\toperatorDescription(state)\n\t\t{\n\t\t\tif (!this.showName)\n\t\t\t{\n\t\t\t\treturn '';\n\t\t\t}\n\n\t\t\tconst operatorPosition = state.widget.dialog.operator.workPosition? state.widget.dialog.operator.workPosition: this.localize.BX_LIVECHAT_USER;\n\n\t\t\tif (state.widget.common.showSessionId && state.widget.dialog.sessionId >= 0)\n\t\t\t{\n\t\t\t\treturn this.localize.BX_LIVECHAT_OPERATOR_POSITION_AND_SESSION_ID\n\t\t\t\t\t.replace(\"#POSITION#\", operatorPosition)\n\t\t\t\t\t.replace(\"#ID#\", state.widget.dialog.sessionId);\n\t\t\t}\n\n\t\t\treturn this.localize.BX_LIVECHAT_OPERATOR_POSITION_ONLY.replace(\"#POSITION#\", operatorPosition);\n\t\t},\n\n\t\tlocalize()\n\t\t{\n\t\t\treturn BitrixVue.getFilteredPhrases('BX_LIVECHAT_', this);\n\t\t},\n\n\t\tie11()\n\t\t{\n\t\t\treturn Browser.isIE11();\n\t\t},\n\t\t...Vuex.mapState({\n\t\t\twidget: state => state.widget,\n\t\t\tapplication: state => state.application,\n\t\t})\n\t},\n\twatch:\n\t{\n\t\tshowName(value)\n\t\t{\n\t\t\tif (value)\n\t\t\t{\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tthis.$root.$emit(EventType.dialog.scrollToBottom, {chatId: this.chatId});\n\t\t\t\t}, 300);\n\t\t\t}\n\t\t},\n\t},\n\t//language=Vue\n\ttemplate: `\n\t\t<div class=\"bx-livechat-head-wrap\">\n\t\t\t<template v-if=\"isWidgetDisabled\">\n\t\t\t\t<div class=\"bx-livechat-head\" :style=\"customBackgroundStyle\">\n\t\t\t\t\t<div class=\"bx-livechat-title\">{{chatTitle}}</div>\n\t\t\t\t\t<div class=\"bx-livechat-control-box\">\n\t\t\t\t\t\t<button v-if=\"!widget.common.pageMode\" class=\"bx-livechat-control-btn bx-livechat-control-btn-close\" :title=\"localize.BX_LIVECHAT_CLOSE_BUTTON\" @click=\"close\"></button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\t\n\t\t\t</template>\n\t\t\t<template v-else-if=\"application.error.active\">\n\t\t\t\t<div class=\"bx-livechat-head\" :style=\"customBackgroundStyle\">\n\t\t\t\t\t<div class=\"bx-livechat-title\">{{chatTitle}}</div>\n\t\t\t\t\t<div class=\"bx-livechat-control-box\">\n\t\t\t\t\t\t<button v-if=\"!widget.common.pageMode\" class=\"bx-livechat-control-btn bx-livechat-control-btn-close\" :title=\"localize.BX_LIVECHAT_CLOSE_BUTTON\" @click=\"close\"></button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t\t<template v-else-if=\"!widget.common.configId\">\n\t\t\t\t<div class=\"bx-livechat-head\" :style=\"customBackgroundStyle\">\n\t\t\t\t\t<div class=\"bx-livechat-title\">{{chatTitle}}</div>\n\t\t\t\t\t<div class=\"bx-livechat-control-box\">\n\t\t\t\t\t\t<button v-if=\"!widget.common.pageMode\" class=\"bx-livechat-control-btn bx-livechat-control-btn-close\" :title=\"localize.BX_LIVECHAT_CLOSE_BUTTON\" @click=\"close\"></button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</template>\t\t\t\n\t\t\t<template v-else>\n\t\t\t\t<div class=\"bx-livechat-head\" :style=\"customBackgroundStyle\">\n\t\t\t\t\t<template v-if=\"!showName\">\n\t\t\t\t\t\t<div class=\"bx-livechat-title\">{{chatTitle}}</div>\n\t\t\t\t\t</template>\n\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t<div class=\"bx-livechat-user bx-livechat-status-online\">\n\t\t\t\t\t\t\t<template v-if=\"widget.dialog.operator.avatar\">\n\t\t\t\t\t\t\t\t<div class=\"bx-livechat-user-icon\" :style=\"'background-image: url('+encodeURI(widget.dialog.operator.avatar)+')'\">\n\t\t\t\t\t\t\t\t\t<div v-if=\"widget.dialog.operator.online\" class=\"bx-livechat-user-status\" :style=\"customBackgroundOnlineStyle\"></div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t\t\t<div class=\"bx-livechat-user-icon\">\n\t\t\t\t\t\t\t\t\t<div v-if=\"widget.dialog.operator.online\" class=\"bx-livechat-user-status\" :style=\"customBackgroundOnlineStyle\"></div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"bx-livechat-user-info\">\n\t\t\t\t\t\t\t<div class=\"bx-livechat-user-name\">{{operatorName}}</div>\n\t\t\t\t\t\t\t<div class=\"bx-livechat-user-position\">{{operatorDescription}}</div>\t\t\t\t\t\t\t\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</template>\n\t\t\t\t\t<div class=\"bx-livechat-control-box\">\n\t\t\t\t\t\t<span class=\"bx-livechat-control-box-active\" v-if=\"widget.common.dialogStart && widget.dialog.sessionId\">\n\t\t\t\t\t\t\t<button v-if=\"widget.common.vote.enable && voteActive\" :class=\"'bx-livechat-control-btn bx-livechat-control-btn-like bx-livechat-dialog-vote-'+(widget.dialog.userVote)\" :title=\"localize.BX_LIVECHAT_VOTE_BUTTON\" @click=\"like\"></button>\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\tv-if=\"!ie11 && application.dialog.chatId > 0\"\n\t\t\t\t\t\t\t\tclass=\"bx-livechat-control-btn bx-livechat-control-btn-menu\"\n\t\t\t\t\t\t\t\t@click=\"openMenu\"\n\t\t\t\t\t\t\t\t:title=\"localize.BX_LIVECHAT_DOWNLOAD_HISTORY\"\n\t\t\t\t\t\t\t></button>\n\t\t\t\t\t\t</span>\t\n\t\t\t\t\t\t<button v-if=\"!widget.common.pageMode\" class=\"bx-livechat-control-btn bx-livechat-control-btn-close\" :title=\"localize.BX_LIVECHAT_CLOSE_BUTTON\" @click=\"close\"></button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t</div>\n\t`\n});","/**\n * Bitrix OpenLines widget\n * Body loading component (Vue component)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {BitrixVue} from \"ui.vue\";\n\nBitrixVue.component('bx-livechat-body-loading',\n{\n\ttemplate: `\n\t\t<div class=\"bx-livechat-loading-window\">\n\t\t\t<svg class=\"bx-livechat-loading-circular\" viewBox=\"25 25 50 50\">\n\t\t\t\t<circle class=\"bx-livechat-loading-path\" cx=\"50\" cy=\"50\" r=\"20\" fill=\"none\" stroke-miterlimit=\"10\"/>\n\t\t\t\t<circle class=\"bx-livechat-loading-inner-path\" cx=\"50\" cy=\"50\" r=\"20\" fill=\"none\" stroke-miterlimit=\"10\"/>\n\t\t\t</svg>\n\t\t\t<h3 class=\"bx-livechat-help-title bx-livechat-help-title-md bx-livechat-loading-msg\">{{$Bitrix.Loc.getMessage('BX_LIVECHAT_LOADING')}}</h3>\n\t\t</div>\n\t`\n});","/**\n * Bitrix OpenLines widget\n * Body operators component (Vue component)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {BitrixVue} from \"ui.vue\";\nimport {Vuex} from \"ui.vue.vuex\";\n\nBitrixVue.component('bx-livechat-body-operators',\n{\n\tcomputed:\n\t{\n\t\t...Vuex.mapState({\n\t\t\twidget: state => state.widget\n\t\t})\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-livechat-help-container\">\n\t\t\t<transition name=\"bx-livechat-animation-fade\">\n\t\t\t\t<h2 v-if=\"widget.common.online\" key=\"online\" class=\"bx-livechat-help-title bx-livechat-help-title-lg\">{{widget.common.textMessages.bxLivechatOnlineLine1}}<div class=\"bx-livechat-help-subtitle\">{{widget.common.textMessages.bxLivechatOnlineLine2}}</div></h2>\n\t\t\t\t<h2 v-else key=\"offline\" class=\"bx-livechat-help-title bx-livechat-help-title-sm\">{{widget.common.textMessages.bxLivechatOffline}}</h2>\n\t\t\t</transition>\t\n\t\t\t<div class=\"bx-livechat-help-user\">\n\t\t\t\t<template v-for=\"operator in widget.common.operators\">\n\t\t\t\t\t<div class=\"bx-livechat-user\" :key=\"operator.id\">\n\t\t\t\t\t\t<template v-if=\"operator.avatar\">\n\t\t\t\t\t\t\t<div class=\"bx-livechat-user-icon\" :style=\"'background-image: url('+encodeURI(operator.avatar)+')'\"></div>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t\t<div class=\"bx-livechat-user-icon\"></div>\n\t\t\t\t\t\t</template>\t\n\t\t\t\t\t\t<div class=\"bx-livechat-user-info\">\n\t\t\t\t\t\t\t<div class=\"bx-livechat-user-name\">{{operator.firstName? operator.firstName: operator.name}}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</template>\t\n\t\t\t</div>\n\t\t</div>\n\t`\n});","/**\n * Bitrix OpenLines widget\n * Body orientation disabled component (Vue component)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {BitrixVue} from \"ui.vue\";\n\nBitrixVue.component('bx-livechat-body-orientation-disabled',\n{\n\ttemplate: `\n\t\t<div class=\"bx-livechat-body\" key=\"orientation-head\">\n\t\t\t<div class=\"bx-livechat-mobile-orientation-box\">\n\t\t\t\t<div class=\"bx-livechat-mobile-orientation-icon\"></div>\n\t\t\t\t<div class=\"bx-livechat-mobile-orientation-text\">{{$Bitrix.Loc.getMessage('BX_LIVECHAT_MOBILE_ROTATE')}}</div>\n\t\t\t</div>\n\t\t</div>\n\t`\n});","/**\n * Bitrix OpenLines widget\n * Form consent component (Vue component)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {BitrixVue} from \"ui.vue\";\nimport {Vuex} from \"ui.vue.vuex\";\n\nBitrixVue.component('bx-livechat-form-consent',\n{\n\t/**\n\t * @emits 'agree' {event: object} -- 'event' - click event\n\t * @emits 'disagree' {event: object} -- 'event' - click event\n\t */\n\tcomputed:\n\t{\n\t\t...Vuex.mapState({\n\t\t\twidget: state => state.widget,\n\t\t})\n\t},\n\tmethods:\n\t{\n\t\tagree(event)\n\t\t{\n\t\t\tthis.$emit('agree', {event});\n\t\t},\n\t\tdisagree(event)\n\t\t{\n\t\t\tthis.$emit('disagree', {event});\n\t\t},\n\t\tonShow(element, done)\n\t\t{\n\t\t\telement.classList.add('bx-livechat-consent-window-show');\n\t\t\tdone();\n\t\t},\n\t\tonHide(element, done)\n\t\t{\n\t\t\telement.classList.remove('bx-livechat-consent-window-show');\n\t\t\telement.classList.add('bx-livechat-consent-window-close');\n\t\t\tsetTimeout(function() {\n\t\t\t\tdone();\n\t\t\t}, 400);\n\t\t},\n\t\tonKeyDown(event)\n\t\t{\n\t\t\tif (event.keyCode == 9)\n\t\t\t{\n\t\t\t\tif (event.target === this.$refs.iframe)\n\t\t\t\t{\n\t\t\t\t\tif (event.shiftKey)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$refs.cancel.focus();\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$refs.success.focus();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (event.target === this.$refs.success)\n\t\t\t\t{\n\t\t\t\t\tif (event.shiftKey)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$refs.iframe.focus();\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$refs.cancel.focus();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (event.target === this.$refs.cancel)\n\t\t\t\t{\n\t\t\t\t\tif (event.shiftKey)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$refs.success.focus();\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$refs.iframe.focus();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tevent.preventDefault();\n\t\t\t}\n\t\t\telse if (event.keyCode == 39 || event.keyCode == 37)\n\t\t\t{\n\t\t\t\tif (event.target.nextElementSibling)\n\t\t\t\t{\n\t\t\t\t\tevent.target.nextElementSibling.focus();\n\t\t\t\t}\n\t\t\t\telse if (event.target.previousElementSibling)\n\t\t\t\t{\n\t\t\t\t\tevent.target.previousElementSibling.focus();\n\t\t\t\t}\n\t\t\t\tevent.preventDefault();\n\t\t\t}\n\t\t},\n\t},\n\tdirectives:\n\t{\n\t\tfocus:\n\t\t{\n\t\t\tinserted(element, params)\n\t\t\t{\n\t\t\t\telement.focus();\n\t\t\t}\n\t\t}\n\t},\n\ttemplate: `\n\t\t<transition @enter=\"onShow\" @leave=\"onHide\">\n\t\t\t<template v-if=\"widget.common.showConsent && widget.common.consentUrl\">\n\t\t\t\t<div class=\"bx-livechat-consent-window\">\n\t\t\t\t\t<div class=\"bx-livechat-consent-window-title\">{{$Bitrix.Loc.getMessage('BX_LIVECHAT_CONSENT_TITLE')}}</div>\n\t\t\t\t\t<div class=\"bx-livechat-consent-window-content\">\n\t\t\t\t\t\t<iframe class=\"bx-livechat-consent-window-content-iframe\" ref=\"iframe\" frameborder=\"0\" marginheight=\"0\"  marginwidth=\"0\" allowtransparency=\"allow-same-origin\" seamless=\"true\" :src=\"widget.common.consentUrl\" @keydown=\"onKeyDown\"></iframe>\n\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\n\t\t\t\t\t<div class=\"bx-livechat-consent-window-btn-box\">\n\t\t\t\t\t\t<button class=\"bx-livechat-btn bx-livechat-btn-success\" ref=\"success\" @click=\"agree\" @keydown=\"onKeyDown\" v-focus>{{$Bitrix.Loc.getMessage('BX_LIVECHAT_CONSENT_AGREE')}}</button>\n\t\t\t\t\t\t<button class=\"bx-livechat-btn bx-livechat-btn-cancel\" ref=\"cancel\" @click=\"disagree\" @keydown=\"onKeyDown\">{{$Bitrix.Loc.getMessage('BX_LIVECHAT_CONSENT_DISAGREE')}}</button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t</transition>\n\t`\n});","/**\n * Bitrix OpenLines widget\n * Form history component (Vue component)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport 'ui.icons';\nimport 'ui.forms';\n\nimport {BitrixVue} from \"ui.vue\";\nimport {Vuex} from \"ui.vue.vuex\";\nimport {Utils} from \"im.lib.utils\";\nimport {FormType} from \"../const\";\n\nBitrixVue.component('bx-livechat-form-history',\n{\n\tdata()\n\t{\n\t\treturn {\n\t\t\tfieldEmail: '',\n\t\t}\n\t},\n\twatch:\n\t{\n\t\tfieldEmail(value)\n\t\t{\n\t\t\tclearTimeout(this.fieldEmailTimeout);\n\t\t\tthis.fieldEmailTimeout = setTimeout(this.checkEmailField, 300);\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\t...Vuex.mapState({\n\t\t\twidget: state => state.widget,\n\t\t})\n\t},\n\tcreated()\n\t{\n\t\tthis.fieldEmail = '' + this.widget.user.email;\n\t},\n\tmethods:\n\t{\n\t\tformShowed()\n\t\t{\n\t\t\tif (!Utils.platform.isMobile())\n\t\t\t{\n\t\t\t\tthis.$refs.emailInput.focus();\n\t\t\t}\n\t\t},\n\t\tsendForm()\n\t\t{\n\t\t\tlet email = this.checkEmailField()? this.fieldEmail: '';\n\t\t\tif (email)\n\t\t\t{\n\t\t\t\tthis.$Bitrix.Application.get().sendForm(FormType.history, {email});\n\t\t\t}\n\n\t\t\tthis.hideForm();\n\t\t},\n\t\thideForm(event)\n\t\t{\n\t\t\tclearTimeout(this.fieldEmailTimeout);\n\t\t\tthis.$parent.hideForm();\n\t\t},\n\t\tonFieldEnterPress(event)\n\t\t{\n\t\t\tthis.sendForm();\n\t\t\tevent.preventDefault();\n\t\t},\n\t\tcheckEmailField()\n\t\t{\n\t\t\tif (this.fieldEmail.match(/^(.*)@(.*)\\.[a-zA-Z]{2,}$/))\n\t\t\t{\n\t\t\t\tif (this.$refs.email)\n\t\t\t\t{\n\t\t\t\t\tthis.$refs.email.classList.remove('ui-ctl-danger');\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (document.activeElement !== this.$refs.emailInput)\n\t\t\t\t{\n\t\t\t\t\tif (this.$refs.email)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$refs.email.classList.add('ui-ctl-danger');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\t\t},\n\t},\n\ttemplate: `\n\t\t<transition enter-active-class=\"bx-livechat-consent-window-show\" leave-active-class=\"bx-livechat-form-close\" @after-enter=\"formShowed\">\n\t\t\t<div v-if=\"false\" class=\"bx-livechat-alert-box bx-livechat-form-show\" key=\"welcome\">\t\n\t\t\t\t<div class=\"bx-livechat-alert-close\" @click=\"hideForm\"></div>\n\t\t\t\t<div class=\"bx-livechat-alert-form-box\">\n\t\t\t\t\t<h4 class=\"bx-livechat-alert-title bx-livechat-alert-title-sm\">{{$Bitrix.Loc.getMessage('BX_LIVECHAT_MAIL_TITLE_NEW')}}</h4>\n\t\t\t\t\t<div class=\"bx-livechat-form-item ui-ctl ui-ctl-after-icon ui-ctl-w100 ui-ctl-lg\" ref=\"email\">\n\t\t\t\t\t   <div class=\"ui-ctl-after ui-ctl-icon-mail bx-livechat-form-icon\" :title=\"$Bitrix.Loc.getMessage('BX_LIVECHAT_FIELD_MAIL_TOOLTIP')\"></div>\n\t\t\t\t\t   <input type=\"text\" class=\"ui-ctl-element ui-ctl-textbox\" :placeholder=\"$Bitrix.Loc.getMessage('BX_LIVECHAT_FIELD_MAIL')\" v-model=\"fieldEmail\" ref=\"emailInput\" @blur=\"checkEmailField\" @keydown.enter=\"onFieldEnterPress\">\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"bx-livechat-btn-box\">\n\t\t\t\t\t\t<button class=\"bx-livechat-btn bx-livechat-btn-success\" @click=\"sendForm\">{{$Bitrix.Loc.getMessage('BX_LIVECHAT_MAIL_BUTTON_NEW')}}</button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\t\n\t\t</transition>\t\n\t`\n});","/**\n * Bitrix OpenLines widget\n * Form offline component (Vue component)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport 'ui.icons';\nimport 'ui.forms';\n\nimport {Vue} from \"ui.vue\";\nimport {Utils} from \"im.lib.utils\";\nimport {FormType} from \"../const\";\n\nVue.cloneComponent('bx-livechat-form-offline', 'bx-livechat-form-welcome',\n{\n\tmethods:\n\t{\n\t\tformShowed()\n\t\t{\n\t\t\tif (!Utils.platform.isMobile())\n\t\t\t{\n\t\t\t\tthis.$refs.emailInput.focus();\n\t\t\t}\n\t\t},\n\t\tsendForm()\n\t\t{\n\t\t\tlet name = this.fieldName;\n\t\t\tlet email = this.checkEmailField()? this.fieldEmail: '';\n\t\t\tlet phone = this.checkPhoneField()? this.fieldPhone: '';\n\n\t\t\tif (name || email || phone)\n\t\t\t{\n\t\t\t\tthis.$Bitrix.Application.get().sendForm(FormType.offline, {name, email, phone});\n\t\t\t}\n\n\t\t\tthis.hideForm();\n\t\t},\n\t\tonFieldEnterPress(event)\n\t\t{\n\t\t\tif (event.target === this.$refs.emailInput)\n\t\t\t{\n\t\t\t\tthis.showFullForm();\n\t\t\t\tthis.$refs.phoneInput.focus();\n\t\t\t}\n\t\t\telse if (event.target === this.$refs.phoneInput)\n\t\t\t{\n\t\t\t\tthis.$refs.nameInput.focus();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.sendForm();\n\t\t\t}\n\n\t\t\tevent.preventDefault();\n\t\t},\n\t},\n\twatch:\n\t{\n\t\tfieldName()\n\t\t{\n\t\t\tclearTimeout(this.fieldNameTimeout);\n\t\t\tthis.fieldNameTimeout = setTimeout(this.checkNameField, 300);\n\t\t},\n\t\tfieldEmail()\n\t\t{\n\t\t\tclearTimeout(this.showFormTimeout);\n\t\t\tthis.showFormTimeout = setTimeout(this.showFullForm, 1000);\n\n\t\t\tclearTimeout(this.fieldEmailTimeout);\n\t\t\tthis.fieldEmailTimeout = setTimeout(this.checkEmailField, 300);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<transition enter-active-class=\"bx-livechat-consent-window-show\" leave-active-class=\"bx-livechat-form-close\" @after-enter=\"formShowed\">\n\t\t\t<div class=\"bx-livechat-alert-box bx-livechat-form-show\" key=\"welcome\">\t\n\t\t\t\t<div class=\"bx-livechat-alert-close\" @click=\"hideForm\"></div>\n\t\t\t\t<div class=\"bx-livechat-alert-form-box\">\n\t\t\t\t\t<h4 class=\"bx-livechat-alert-title bx-livechat-alert-title-sm\">{{localize.BX_LIVECHAT_OFFLINE_TITLE}}</h4>\n\t\t\t\t\t<div class=\"bx-livechat-form-item ui-ctl ui-ctl-after-icon ui-ctl-w100 ui-ctl-lg\" ref=\"email\">\n\t\t\t\t\t   <div class=\"ui-ctl-after ui-ctl-icon-mail bx-livechat-form-icon\" :title=\"localize.BX_LIVECHAT_FIELD_MAIL_TOOLTIP\"></div>\n\t\t\t\t\t   <input type=\"text\" class=\"ui-ctl-element ui-ctl-textbox\" :placeholder=\"localize.BX_LIVECHAT_FIELD_MAIL\" v-model=\"fieldEmail\" ref=\"emailInput\" @blur=\"checkEmailField\" @keydown.enter=\"onFieldEnterPress\">\n\t\t\t\t\t</div>\n\t\t\t\t\t<div :class=\"['bx-livechat-form-short', {\n\t\t\t\t\t\t'bx-livechat-form-full': isFullForm,\n\t\t\t\t\t}]\">\n\t\t\t\t\t\t<div class=\"bx-livechat-form-item ui-ctl ui-ctl-after-icon ui-ctl-w100 ui-ctl-lg\" ref=\"phone\">\n\t\t\t\t\t\t   <div class=\"ui-ctl-after ui-ctl-icon-phone bx-livechat-form-icon\" :title=\"localize.BX_LIVECHAT_FIELD_PHONE_TOOLTIP\"></div>\n\t\t\t\t\t\t   <input type=\"text\" class=\"ui-ctl-element ui-ctl-textbox\" :placeholder=\"localize.BX_LIVECHAT_FIELD_PHONE\" v-model=\"fieldPhone\" ref=\"phoneInput\" @blur=\"checkPhoneField\" @keydown.enter=\"onFieldEnterPress\">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"bx-livechat-form-item ui-ctl ui-ctl-w100 ui-ctl-lg\" ref=\"name\">\n\t\t\t\t\t\t   <input type=\"text\" class=\"ui-ctl-element ui-ctl-textbox\" :placeholder=\"localize.BX_LIVECHAT_FIELD_NAME\" v-model=\"fieldName\" ref=\"nameInput\" @blur=\"checkNameField\" @keydown.enter=\"onFieldEnterPress\"  @keydown.tab=\"onFieldEnterPress\">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"bx-livechat-btn-box\">\n\t\t\t\t\t\t\t<button class=\"bx-livechat-btn bx-livechat-btn-success\" @click=\"sendForm\">{{localize.BX_LIVECHAT_ABOUT_SEND}}</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\t\n\t\t</transition>\t\n\t`\n});","/**\n * Bitrix OpenLines widget\n * Form vote component (Vue component)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {BitrixVue} from \"ui.vue\";\nimport {Vuex} from \"ui.vue.vuex\";\nimport {VoteType, FormType} from \"../const\";\n\nBitrixVue.component('bx-livechat-form-vote',\n{\n\tcomputed:\n\t{\n\t\tVoteType: () => VoteType,\n\n\t\t...Vuex.mapState({\n\t\t\twidget: state => state.widget,\n\t\t})\n\t},\n\tmethods: {\n\t\tuserVote(vote)\n\t\t{\n\t\t\tthis.$store.commit('widget/common', {showForm: FormType.none});\n\t\t\tthis.$store.commit('widget/dialog', {userVote: vote});\n\n\t\t\tthis.$Bitrix.Application.get().sendDialogVote(vote);\n\t\t},\n\t\thideForm(event)\n\t\t{\n\t\t\tthis.$parent.hideForm();\n\t\t},\n\t},\n\ttemplate: `\n\t\t<transition enter-active-class=\"bx-livechat-consent-window-show\" leave-active-class=\"bx-livechat-form-close\">\n\t\t\t<div class=\"bx-livechat-alert-box bx-livechat-form-rate-show\" key=\"vote\">\n\t\t\t\t<div class=\"bx-livechat-alert-close\" @click=\"hideForm\"></div>\n\t\t\t\t<div class=\"bx-livechat-alert-rate-box\">\n\t\t\t\t\t<h4 class=\"bx-livechat-alert-title bx-livechat-alert-title-mdl\">{{widget.common.vote.messageText}}</h4>\n\t\t\t\t\t<div class=\"bx-livechat-btn-box\">\n\t\t\t\t\t\t<button class=\"bx-livechat-btn bx-livechat-btn-like\" @click=\"userVote(VoteType.like)\" :title=\"widget.common.vote.messageLike\"></button>\n\t\t\t\t\t\t<button class=\"bx-livechat-btn bx-livechat-btn-dislike\" @click=\"userVote(VoteType.dislike)\" :title=\"widget.common.vote.messageDislike\"></button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</transition>\t\n\t`\n});","/**\n * Bitrix OpenLines widget\n * Form welcome component (Vue component)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport 'ui.icons';\nimport 'ui.forms';\n\nimport {BitrixVue} from \"ui.vue\";\nimport {Vuex} from \"ui.vue.vuex\";\nimport {Utils} from \"im.lib.utils\";\nimport {FormType} from \"../const\";\n\nBitrixVue.component('bx-livechat-form-welcome',\n{\n\tdata()\n\t{\n\t\treturn {\n\t\t\tfieldName: '',\n\t\t\tfieldEmail: '',\n\t\t\tfieldPhone: '',\n\t\t\tisFullForm: Utils.platform.isMobile()\n\t\t}\n\t},\n\twatch:\n\t{\n\t\tfieldName()\n\t\t{\n\t\t\tclearTimeout(this.showFormTimeout);\n\t\t\tthis.showFormTimeout = setTimeout(this.showFullForm, 1000);\n\n\t\t\tclearTimeout(this.fieldNameTimeout);\n\t\t\tthis.fieldNameTimeout = setTimeout(this.checkNameField, 300);\n\t\t},\n\t\tfieldEmail(value)\n\t\t{\n\t\t\tclearTimeout(this.fieldEmailTimeout);\n\t\t\tthis.fieldEmailTimeout = setTimeout(this.checkEmailField, 300);\n\t\t},\n\t\tfieldPhone(value)\n\t\t{\n\t\t\tclearTimeout(this.fieldPhoneTimeout);\n\t\t\tthis.fieldPhoneTimeout = setTimeout(this.checkPhoneField, 300);\n\t\t}\n\t},\n\tcomputed:\n\t{\n\t\tlocalize()\n\t\t{\n\t\t\treturn BitrixVue.getFilteredPhrases('BX_LIVECHAT_', this);\n\t\t},\n\t\t...Vuex.mapState({\n\t\t\twidget: state => state.widget,\n\t\t})\n\t},\n\tcreated()\n\t{\n\t\tthis.fieldName = '' + this.widget.user.name;\n\t\tthis.fieldEmail = '' + this.widget.user.email;\n\t\tthis.fieldPhone = '' + this.widget.user.phone;\n\t},\n\tmethods:\n\t{\n\t\tformShowed()\n\t\t{\n\t\t\tif (!Utils.platform.isMobile())\n\t\t\t{\n\t\t\t\tthis.$refs.nameInput.focus();\n\t\t\t}\n\t\t},\n\t\tshowFullForm()\n\t\t{\n\t\t\tclearTimeout(this.showFormTimeout);\n\t\t\tthis.isFullForm = true;\n\t\t},\n\t\tsendForm()\n\t\t{\n\t\t\tlet name = this.fieldName;\n\t\t\tlet email = this.checkEmailField()? this.fieldEmail: '';\n\t\t\tlet phone = this.checkPhoneField()? this.fieldPhone: '';\n\n\t\t\tif (name || email || phone)\n\t\t\t{\n\t\t\t\tthis.$Bitrix.Application.get().sendForm(FormType.welcome, {name, email, phone});\n\t\t\t}\n\n\t\t\tthis.hideForm();\n\t\t},\n\t\thideForm(event)\n\t\t{\n\t\t\tclearTimeout(this.showFormTimeout);\n\t\t\tclearTimeout(this.fieldNameTimeout);\n\t\t\tclearTimeout(this.fieldEmailTimeout);\n\t\t\tclearTimeout(this.fieldPhoneTimeout);\n\n\t\t\tthis.$parent.hideForm();\n\t\t},\n\t\tonFieldEnterPress(event)\n\t\t{\n\t\t\tif (event.target === this.$refs.nameInput)\n\t\t\t{\n\t\t\t\tthis.showFullForm();\n\t\t\t\tthis.$refs.emailInput.focus();\n\t\t\t}\n\t\t\telse if (event.target === this.$refs.emailInput)\n\t\t\t{\n\t\t\t\tthis.$refs.phoneInput.focus();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.sendForm();\n\t\t\t}\n\n\t\t\tevent.preventDefault();\n\t\t},\n\t\tcheckNameField()\n\t\t{\n\t\t\tif (this.fieldName.length > 0)\n\t\t\t{\n\t\t\t\tif (this.$refs.name)\n\t\t\t\t{\n\t\t\t\t\tthis.$refs.name.classList.remove('ui-ctl-danger');\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (document.activeElement !== this.$refs.nameInput)\n\t\t\t\t{\n\t\t\t\t\tif (this.$refs.name)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$refs.name.classList.add('ui-ctl-danger');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\t\t},\n\t\tcheckEmailField()\n\t\t{\n\t\t\tif (this.fieldEmail.match(/^(.*)@(.*)\\.[a-zA-Z]{2,}$/))\n\t\t\t{\n\t\t\t\tif (this.$refs.email)\n\t\t\t\t{\n\t\t\t\t\tthis.$refs.email.classList.remove('ui-ctl-danger');\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (document.activeElement !== this.$refs.emailInput)\n\t\t\t\t{\n\t\t\t\t\tif (this.$refs.email)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$refs.email.classList.add('ui-ctl-danger');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\t\t},\n\t\tcheckPhoneField()\n\t\t{\n\t\t\tif (this.fieldPhone.match(/^(\\s*)?(\\+)?([- _():=+]?\\d[- _():=+]?){10,14}(\\s*)?$/))\n\t\t\t{\n\t\t\t\tif (this.$refs.phone)\n\t\t\t\t{\n\t\t\t\t\tthis.$refs.phone.classList.remove('ui-ctl-danger');\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (document.activeElement !== this.$refs.phoneInput)\n\t\t\t\t{\n\t\t\t\t\tif (this.$refs.phone)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$refs.phone.classList.add('ui-ctl-danger');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t},\n\ttemplate: `\n\t\t<transition enter-active-class=\"bx-livechat-consent-window-show\" leave-active-class=\"bx-livechat-form-close\" @after-enter=\"formShowed\">\n\t\t\t<div class=\"bx-livechat-alert-box bx-livechat-form-show\" key=\"welcome\">\t\n\t\t\t\t<div class=\"bx-livechat-alert-close\" @click=\"hideForm\"></div>\n\t\t\t\t<div class=\"bx-livechat-alert-form-box\">\n\t\t\t\t\t<h4 class=\"bx-livechat-alert-title bx-livechat-alert-title-sm\">{{localize.BX_LIVECHAT_ABOUT_TITLE}}</h4>\n\t\t\t\t\t<div class=\"bx-livechat-form-item ui-ctl ui-ctl-w100 ui-ctl-lg\" ref=\"name\">\n\t\t\t\t\t   <input type=\"text\" class=\"ui-ctl-element ui-ctl-textbox\" :placeholder=\"localize.BX_LIVECHAT_FIELD_NAME\" v-model=\"fieldName\" ref=\"nameInput\" @blur=\"checkNameField\" @keydown.enter=\"onFieldEnterPress\"  @keydown.tab=\"onFieldEnterPress\">\n\t\t\t\t\t</div>\n\t\t\t\t\t<div :class=\"['bx-livechat-form-short', {\n\t\t\t\t\t\t'bx-livechat-form-full': isFullForm,\n\t\t\t\t\t}]\">\n\t\t\t\t\t\t<div class=\"bx-livechat-form-item ui-ctl ui-ctl-after-icon ui-ctl-w100 ui-ctl-lg\" ref=\"email\">\n\t\t\t\t\t\t   <div class=\"ui-ctl-after ui-ctl-icon-mail bx-livechat-form-icon\" :title=\"localize.BX_LIVECHAT_FIELD_MAIL_TOOLTIP\"></div>\n\t\t\t\t\t\t   <input type=\"text\" class=\"ui-ctl-element ui-ctl-textbox\" :placeholder=\"localize.BX_LIVECHAT_FIELD_MAIL\" v-model=\"fieldEmail\" ref=\"emailInput\" @blur=\"checkEmailField\" @keydown.enter=\"onFieldEnterPress\">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"bx-livechat-form-item ui-ctl ui-ctl-after-icon ui-ctl-w100 ui-ctl-lg\" ref=\"phone\">\n\t\t\t\t\t\t   <div class=\"ui-ctl-after ui-ctl-icon-phone bx-livechat-form-icon\" :title=\"localize.BX_LIVECHAT_FIELD_PHONE_TOOLTIP\"></div>\n\t\t\t\t\t\t   <input type=\"text\" class=\"ui-ctl-element ui-ctl-textbox\" :placeholder=\"localize.BX_LIVECHAT_FIELD_PHONE\" v-model=\"fieldPhone\" ref=\"phoneInput\" @blur=\"checkPhoneField\" @keydown.enter=\"onFieldEnterPress\">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"bx-livechat-btn-box\">\n\t\t\t\t\t\t\t<button class=\"bx-livechat-btn bx-livechat-btn-success\" @click=\"sendForm\">{{localize.BX_LIVECHAT_ABOUT_SEND}}</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\t\n\t\t</transition>\t\n\t`\n});","/**\n * Bitrix OpenLines widget\n * Smiles component (Vue component)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {Vue} from \"ui.vue\";\n\nVue.cloneComponent('bx-livechat-smiles', 'bx-smiles',\n{\n\tmethods:\n\t{\n\t\thideForm(event)\n\t\t{\n\t\t\tthis.$parent.hideForm();\n\t\t},\n\t},\n\ttemplate: `\n\t\t<transition enter-active-class=\"bx-livechat-consent-window-show\" leave-active-class=\"bx-livechat-form-close\">\n\t\t\t<div class=\"bx-livechat-alert-box bx-livechat-alert-box-zero-padding bx-livechat-form-show\" key=\"vote\">\n\t\t\t\t<div class=\"bx-livechat-alert-close\" @click=\"hideForm\"></div>\n\t\t\t\t<div class=\"bx-livechat-alert-smiles-box\">\n\t\t\t\t\t#PARENT_TEMPLATE#\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</transition>\n\t`\n});","/**\n * Bitrix OpenLines widget\n * Widget component & controller\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\n// core\nimport 'main.polyfill.customevent';\n\n// vue components\nimport 'pull.component.status';\nimport 'ui.vue.components.smiles';\nimport 'im.component.dialog';\nimport 'im.component.textarea';\nimport 'im.view.quotepanel';\nimport 'imopenlines.component.message';\nimport 'imopenlines.component.form';\n\n// widget files\nimport \"./widget.css\";\nimport {VoteType, LocationStyle, SubscriptionType} from \"./const\";\n\n// widget utils\nimport {Cookie} from \"im.lib.cookie\";\nimport {WidgetPublicManager} from \"./public\";\n\n// widget components\n\nimport \"./component/bx-livechat\";\nimport \"./component/bx-livechat-body-error\";\nimport \"./component/bx-livechat-body-head\";\nimport \"./component/bx-livechat-body-loading\";\nimport \"./component/bx-livechat-body-operators\";\nimport \"./component/bx-livechat-body-orientation-disabled\";\nimport \"./component/bx-livechat-form-consent\";\nimport \"./component/bx-livechat-form-history\";\nimport \"./component/bx-livechat-form-offline\";\nimport \"./component/bx-livechat-form-vote\";\nimport \"./component/bx-livechat-form-welcome\";\nimport \"./component/bx-livechat-smiles\";\n\n\nBX.LiveChatWidget = WidgetPublicManager;\nBX.LiveChatWidget.VoteType = VoteType;\nBX.LiveChatWidget.SubscriptionType = SubscriptionType;\nBX.LiveChatWidget.LocationStyle = LocationStyle;\nBX.LiveChatWidget.Cookie = Cookie;\n\nwindow.dispatchEvent(new CustomEvent('onBitrixLiveChatSourceLoaded', {detail: {}}));"],"names":["GetObjectValues","source","destination","value","hasOwnProperty","push","VoteType","Object","freeze","none","like","dislike","LanguageType","russian","ukraine","world","FormType","smile","consent","welcome","offline","history","LocationType","topLeft","topMiddle","topBottom","bottomLeft","bottomMiddle","bottomRight","LocationStyle","SubscriptionType","configLoaded","widgetOpen","widgetClose","sessionStart","sessionOperatorChange","sessionFinish","operatorMessage","userForm","userMessage","userFile","userVote","every","SubscriptionTypeCheck","RestMethod","widgetUserRegister","widgetConfigGet","widgetDialogGet","widgetUserGet","widgetUserConsentApply","widgetVoteSend","widgetFormSend","widgetActionSend","pullServerTime","pullConfigGet","RestMethodCheck","RestAuth","guest","SessionStatus","new","skip","answer","client","clientAfterOperator","operator","waitClient","close","spam","duplicate","silentlyClose","EventType","requestShowForm","WidgetModel","common","configId","configName","host","getVariable","location","protocol","pageMode","copyright","copyrightUrl","styles","backgroundColor","iconColor","vote","enable","beforeFinish","messageText","messageLike","messageDislike","textMessages","bxLivechatOnlineLine1","bxLivechatOnlineLine2","bxLivechatOffline","bxLivechatTitle","online","operators","connectors","showForm","showed","reopen","dragged","textareaHeight","widgetHeight","widgetWidth","showConsent","consentUrl","dialogStart","watchTyping","showSessionId","dialog","sessionId","sessionClose","sessionStatus","closeVote","userConsent","operatorChatId","id","name","firstName","lastName","workPosition","avatar","user","hash","email","phone","www","gender","position","state","payload","Utils","types","isPlainObject","device","isMobile","Array","isSaveNeeded","saveState","toString","startsWith","Cookie","set","expires","path","show","commit","setVoteDateFinish","dispatch","clearTimeout","setVoteDateTimeout","totalDelay","Date","getTime","dayTimestamp","delay","setTimeout","requestCloseVote","VuexBuilderModel","WidgetRestClient","params","queryAuthRestore","setAuthId","restClient","RestClient","endpoint","queryParams","cors","authId","customAuthId","match","livechat_auth_id","console","error","livechat_custom_auth_id","method","callback","sendCallback","logTag","getLogTrackingParams","promise","BX","Promise","callMethod","then","result","fulfill","catch","ex","warn","error_description","reject","calls","bHaltOnError","resultCallback","callBatch","WidgetRestAnswerHandler","props","widget","data","store","disk","addLocalize","serverVariables","LocalStorage","getSiteId","previousData","messages","collection","controller","application","getChatId","chatId","dialogId","fields","entityType","type","userId","diskFolderId","dateCloseVote","handleImDialogMessagesGetSuccess","length","isDialogStart","messageId","message","messagesQueue","filter","el","sendEvent","text","BaseRestHandler","WidgetImPullCommandHandler","extra","command","senderId","getUserId","onceShowed","open","WidgetImopenlinesPullCommandHandler","Widget","template","rootNode","node","document","createElement","ready","widgetDataRequested","inited","initEventFired","userRegisterData","customData","subscribers","configRequestXhr","initParams","initRestClient","initPullClient","initCore","initWidget","initUploader","initComplete","code","language","buttonInstance","useBitrixLocalize","placeholder","getElementById","body","firstChild","insertBefore","appendChild","localize","window","get","resolve","pullClient","PullClient","serverEnabled","siteId","skipStorageInit","configTimestamp","skipCheckRevision","getPublicListMethod","pullClientInited","widgetVariables","getHost","getLocalize","Controller","languageId","pull","rest","vuexBuilder","database","browser","isIe","databaseName","databaseType","VuexBuilder","DatabaseType","localStorage","models","create","setVariables","isUserRegistered","getUserHash","getStore","setPrepareFilesBeforeSaveFunction","prepareFileData","bind","addRestAnswerHandler","uploader","Uploader","generatePreview","sender","customHeaders","actionUploadChunk","actionCommitFile","actionRollbackUpload","subscribe","event","eventData","getData","Logger","log","status","FileStatus","upload","progress","file","fileType","authorId","extension","split","splice","size","image","previewData","width","previewDataWidth","height","previewDataHeight","authorName","getCurrentUser","urlPreview","URL","createObjectURL","fileId","addMessage","previewBlob","wait","find","getters","fileCommit","uploadId","fileError","dispatchEvent","CustomEvent","detail","widgetCode","widgetHost","callStartFlag","start","callOpenFlag","isReady","getUserHashCookie","requestData","fireInitEvent","isConfigDataLoaded","xhr","clearError","executeRestAnswer","setError","requestDataSend","abort","query","config_id","getConfigId","trace_data","getCrmTraceData","custom_data","getCustomData","ImRestMethodHandler","imChatGet","ImRestMethod","dialog_id","imDialogMessagesGetInit","imDialogMessagesGet","chat_id","limit","getRequestMessageLimit","convert_text","getUserRegisterFields","isUserAgreeConsent","consent_url","href","response","configGet","userGetResult","chatGetResult","dialogGetResult","dialogMessagesGetResult","getDialogId","userRegisterResult","timeShift","serverTimeResult","Math","floor","config","pullConfigResult","server","startPullClient","processSendMessages","getDialogData","files","isArray","map","md5","urlParam","urlShow","urlDownload","platform","isIos","version","getIosVersion","isConnected","scheduleReconnect","config_timestamp","storage","StorageManager","Status","eventStatusInteraction","pullConnectedFirstTime","PullStatus","Online","$Bitrix","skipReconnectToLastSession","stop","CloseReasons","MANUAL","restart","pullRequestMessage","pullBaseHandler","option","EventEmitter","emitAsync","requestUnread","emit","scrollOnStart","readMessage","Offline","innerHTML","createVue","beforeCreate","ZIndexManager","undefined","stack","getOrAddStack","setBaseIndex","$bitrix","Data","destroyed","templateAttached","$destroy","Vue","mutateComponent","quoteId","quoteMessage","repeat","date","format","quote","join","quoteMessageClear","isUnreadMessagesLoaded","sendMessage","FILE_ID","sending","scrollToBottom","cancelIfScrollChange","addFilesFromEvent","element","deleteTask","getDiskFolderId","requestDiskFolderId","forEach","sendMessageWithFile","stopWriting","quiteId","newMessage","imMessageAdd","timMessageType","senderOptions","addTask","taskId","fileData","fileName","generateUniqueName","chunkSize","isCloud","CLOUD_MAX_CHUNK_SIZE","BOX_MIN_CHUNK_SIZE","retry","requestDiskFolderPromise","flagRequestDiskFolderIdSended","imDiskFolderGet","imDiskFileCommit","upload_id","template_id","file_template_id","lastId","$emit","requestHistoryResult","count","requestUnreadResult","imDialogRead","message_id","imDialogMessagesGetUnread","first_id","dialogMessageUnread","firstMessageId","setSendingMessageFlag","reaction","reactMessage","action","values","JSON","parse","parseInt","SESSION_ID","getSessionId","isSessionClose","alert","BX_LIVECHAT_ACTION_EXPIRED","botId","imMessageCommand","info","toUpperCase","form","requestControllerAction","contentType","headers","json","blob","Blob","url","a","download","click","remove","errors","ajaxEndpoint","searchParams","formData","FormData","key","append","fetch","isSessionActive","requestWidgetData","openTimeout","openFromButton","wm","showById","checkBrowserVersion","BX_LIVECHAT_OLD_BROWSER","versionCompare","BX_LIVECHAT_OLD_VUE","BX_LIVECHAT_OLD_VUE_DEV","replace","isWidgetDataRequested","attachTemplate","onWidgetClose","detachTemplate","traceData","getTrace","b24Tracker","MESSAGE","BX_LIVECHAT_EXTRA_SITE","stringify","dialogues","userHash","cookie","validUserFields","field","indexOf","setNewAuthToken","authToken","getStoreBuilder","clearModelState","concat","description","localizeDescription","endsWith","active","includes","phrases","phrase","WidgetPublicManager","developerInfo","__privateMethods__","__createLegacyMethods","showNotification","getUserData","setUserRegisterData","setCustomData","mutateTemplateComponent","LiveChat","sourceHref","sourceDomain","hostname","port","openLiveChat","closeLiveChat","addEventListener","eventName","handler","origin","setCookie","getCookie","BxLiveChatInit","firstMessage","BxLiveChatLoader","BitrixVue","component","mixins","DialogCore","TextareaCore","TextareaUploadFile","DialogReadMessages","DialogClickOnCommand","DialogClickOnUserName","DialogClickOnKeyboardButton","DialogClickOnMessageMenu","DialogClickOnMessageRetry","DialogSetMessageReaction","DialogClickOnUploadCancel","viewPortMetaSiteNode","viewPortMetaWidgetNode","storedMessage","storedFile","widgetMinimumHeight","widgetMinimumWidth","widgetBaseHeight","widgetBaseWidth","widgetMargin","widgetAvailableHeight","widgetAvailableWidth","widgetCurrentHeight","widgetCurrentWidth","widgetDrag","textareaFocused","textareaDrag","textareaMinimumHeight","textareaMaximumHeight","zIndexStackInstance","created","onCreated","onWindowKeyDown","getAvailableSpaceFunc","throttle","getAvailableSpace","WidgetEventType","onRequestShowForm","mounted","$refs","widgetWrapper","register","beforeDestroy","unregister","removeEventListener","unsubscribe","onTextareaDragEventRemove","computed","DeviceType","textareaHeightStyle","flex","textareaBottomMargin","isBottomLocation","marginBottom","widgetBaseSizes","widgetHeightStyle","max","widgetWidthStyle","userSelectStyle","isLeftLocation","getFilteredPhrases","widgetMobileDisabled","mobile","navigator","userAgent","orientation","DeviceOrientation","horizontal","screen","availHeight","widgetClassName","className","isSafari","isMac","isDarkColor","showMessageDialog","messageCollection","Vuex","mapState","watch","dialogInited","newValue","methods","getRestClient","getApplication","Application","onSendMessage","focus","s","$store","showConsentWidow","hideForm","textarea","setFocus","onBeforeClose","bottomPosition","getBoundingClientRect","bottom","widgetBottomMargin","innerHeight","topPosition","top","innerWidth","showLikeForm","showFormTimeout","showWelcomeForm","showOfflineForm","showHistoryForm","onOpenMenu","getHtmlHistory","agreeConsentWidow","sendConsentDecision","onTextareaFileSelected","disagreeConsentWidow","insertText","logEvent","from","head","getElementsByTagName","removeChild","contentWidth","offsetWidth","setAttribute","classList","add","isSafariBased","onAfterClose","delayed","onDialogRequestHistory","getDialogHistory","onDialogRequestUnread","getDialogUnread","onClickOnUserName","onClickOnUploadCancel","cancelUploadFile","onClickOnKeyboardButton","execMessageKeyboardCommand","onClickOnCommand","onClickOnMessageMenu","onClickOnMessageRetry","retrySendMessage","onReadMessage","onSetMessageReaction","onClickOnDialog","onTextareaKeyUp","isPublishingEnabled","infoString","onTextareaFocus","onTextareaFocusScrollTimeout","onWindowScroll","onTextareaBlur","$nextTick","force","onTextareaStartDrag","changedTouches","textareaDragCursorStartPoint","clientY","textareaDragHeightStartPoint","onTextareaDragEventAdd","setBlur","onTextareaContinueDrag","textareaDragCursorControlPoint","min","onTextareaStopDrag","fileInputEvent","fileChangeEvent","target","uploadFile","onTextareaAppButtonClick","appId","onTextareaEdit","onPullRequestConfig","recoverPullConnection","onSmilesSelectSmile","onSmilesSelectSet","onWidgetStartDrag","widgetDragCursorStartPointY","widgetDragCursorStartPointX","clientX","widgetDragHeightStartPoint","widgetDragWidthStartPoint","onWidgetDragEventAdd","onWidgetContinueDrag","widgetDragCursorControlPointY","widgetDragCursorControlPointX","onWidgetStopDrag","onWidgetDragEventRemove","keyCode","preventDefault","stopPropagation","onWindowScrollTimeout","isWidgetDisabled","default","openMenu","customBackgroundStyle","customBackgroundOnlineStyle","showName","voteActive","chatTitle","BX_LIVECHAT_TITLE","operatorName","operatorDescription","operatorPosition","BX_LIVECHAT_USER","BX_LIVECHAT_OPERATOR_POSITION_AND_SESSION_ID","BX_LIVECHAT_OPERATOR_POSITION_ONLY","ie11","Browser","isIE11","$root","agree","disagree","onShow","done","onHide","onKeyDown","iframe","shiftKey","cancel","success","nextElementSibling","previousElementSibling","directives","inserted","fieldEmail","fieldEmailTimeout","checkEmailField","formShowed","emailInput","sendForm","$parent","onFieldEnterPress","activeElement","cloneComponent","fieldName","checkPhoneField","fieldPhone","showFullForm","phoneInput","nameInput","fieldNameTimeout","checkNameField","sendDialogVote","isFullForm","fieldPhoneTimeout","LiveChatWidget"],"mappings":"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"}