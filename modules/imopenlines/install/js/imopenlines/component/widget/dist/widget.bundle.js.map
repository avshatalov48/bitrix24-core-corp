{"version":3,"file":"widget.bundle.js","sources":["../src/const.js","../src/model.js","../src/utils/restclient.js","../src/rest.handler.js","../src/pull.handler.js","../src/widget.js","../src/public.js","../src/component/bx-livechat.js","../src/component/bx-livechat-body-error.js","../src/component/bx-livechat-body-head.js","../src/component/bx-livechat-body-loading.js","../src/component/bx-livechat-body-operators.js","../src/component/bx-livechat-body-orientation-disabled.js","../src/component/bx-livechat-form-consent.js","../src/component/bx-livechat-form-vote.js","../src/component/bx-livechat-smiles.js","../src/registry.js"],"sourcesContent":["/**\n * Bitrix OpenLines widget\n * Widget constants\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nfunction GetObjectValues(source)\n{\n\tconst destination = [];\n\tfor (let value in source)\n\t{\n\t\tif (source.hasOwnProperty(value))\n\t\t{\n\t\t\tdestination.push(source[value]);\n\t\t}\n\t}\n\treturn destination;\n}\n\n/* region 01. Constants */\n\nexport const VoteType = Object.freeze({\n\tnone: 'none',\n\tlike: 'like',\n\tdislike: 'dislike',\n});\n\nexport const LanguageType = Object.freeze({\n\trussian: 'ru',\n\tukraine: 'ua',\n\tworld: 'en',\n});\n\nexport const FormType = Object.freeze({\n\tnone: 'none',\n\tlike: 'like',\n\tsmile: 'smile',\n\tconsent: 'consent',\n\twelcome: 'welcome',\n\toffline: 'offline',\n\thistory: 'history',\n});\n\nexport const LocationType = Object.freeze({\n\ttopLeft: 1,\n\ttopMiddle: 2,\n\ttopBottom: 3,\n\tbottomLeft: 6,\n\tbottomMiddle: 5,\n\tbottomRight: 4,\n});\n\nexport const LocationStyle = Object.freeze({\n\t1: 'top-left',\n\t2: 'top-center',\n\t3: 'top-right',\n\t6: 'bottom-left',\n\t5: 'bottom-center',\n\t4: 'bottom-right',\n});\n\nexport const SubscriptionType = Object.freeze({\n\tconfigLoaded: 'configLoaded',\n\twidgetOpen: 'widgetOpen',\n\twidgetClose: 'widgetClose',\n\tsessionStart: 'sessionStart',\n\tsessionOperatorChange: 'sessionOperatorChange',\n\tsessionFinish: 'sessionFinish',\n\toperatorMessage: 'operatorMessage',\n\tuserForm: 'userForm',\n\tuserMessage: 'userMessage',\n\tuserFile: 'userFile',\n\tuserVote: 'userVote',\n\tevery: 'every',\n});\nexport const SubscriptionTypeCheck = GetObjectValues(SubscriptionType);\n\nexport const RestMethod = Object.freeze({\n\twidgetUserRegister: 'imopenlines.widget.user.register',\n\twidgetConfigGet: 'imopenlines.widget.config.get',\n\twidgetDialogGet: 'imopenlines.widget.dialog.get',\n\twidgetUserGet: 'imopenlines.widget.user.get',\n\twidgetUserConsentApply: 'imopenlines.widget.user.consent.apply',\n\twidgetVoteSend: 'imopenlines.widget.vote.send',\n\twidgetActionSend: 'imopenlines.widget.action.send',\n\tpullServerTime: 'server.time',\n\tpullConfigGet: 'pull.config.get',\n});\nexport const RestMethodCheck = GetObjectValues(RestMethod);\n\nexport const RestAuth = Object.freeze({\n\tguest: 'guest',\n});\n\nexport const SessionStatus = Object.freeze({\n\tnew: 0,\n\tskip: 5,\n\tanswer: 10,\n\tclient: 20,\n\tclientAfterOperator: 25,\n\toperator: 40,\n\twaitClient: 50,\n\tclose: 60,\n\tspam: 65,\n\tduplicate: 69,\n\tsilentlyClose: 75,\n});\n\nexport const EventType = Object.freeze({\n\trequestShowForm: 'IMOL.Widget:requestShowForm',\n});","/**\n * Bitrix OpenLines widget\n * Widget model (Vuex Builder model)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {VuexBuilderModel} from 'ui.vue.vuex';\n\nimport {Utils} from 'im.lib.utils';\nimport {Cookie} from \"im.lib.cookie\";\nimport {FormType, LocationStyle, LocationType, VoteType} from \"./const\";\n\nexport class WidgetModel extends VuexBuilderModel\n{\n\t/**\n\t * @inheritDoc\n\t */\n\tgetName()\n\t{\n\t\treturn 'widget';\n\t}\n\n\tgetState()\n\t{\n\t\treturn {\n\t\t\tcommon:\n\t\t\t{\n\t\t\t\tconfigId: 0,\n\t\t\t\tconfigName: '',\n\t\t\t\thost: this.getVariable('common.host', location.protocol+'//'+location.host),\n\t\t\t\tpageMode: this.getVariable('common.pageMode', false),\n\t\t\t\tcopyright: this.getVariable('common.copyright', true),\n\t\t\t\tcopyrightUrl: this.getVariable('common.copyrightUrl', 'https://bitrix24.com'),\n\t\t\t\tlocation: this.getVariable('common.location', LocationType.bottomRight),\n\t\t\t\tstyles: {\n\t\t\t\t\tbackgroundColor: this.getVariable('styles.backgroundColor', '#17a3ea'),\n\t\t\t\t\ticonColor: this.getVariable('styles.iconColor', '#ffffff')\n\t\t\t\t},\n\t\t\t\tvote: {\n\t\t\t\t\tenable: false,\n\t\t\t\t\tbeforeFinish: true,\n\t\t\t\t\tmessageText: this.getVariable('vote.messageText', ''),\n\t\t\t\t\tmessageLike: this.getVariable('vote.messageLike', ''),\n\t\t\t\t\tmessageDislike: this.getVariable('vote.messageDislike', '')\n\t\t\t\t},\n\t\t\t\ttextMessages: {\n\t\t\t\t\tbxLivechatOnlineLine1: this.getVariable('textMessages.bxLivechatOnlineLine1', ''),\n\t\t\t\t\tbxLivechatOnlineLine2: this.getVariable('textMessages.bxLivechatOnlineLine2', ''),\n\t\t\t\t\tbxLivechatOffline: this.getVariable('textMessages.bxLivechatOffline', ''),\n\t\t\t\t\tbxLivechatTitle: '',\n\t\t\t\t},\n\t\t\t\tonline: false,\n\t\t\t\toperators: [],\n\t\t\t\tconnectors: [],\n\t\t\t\tshowForm: FormType.none,\n\t\t\t\tshowed: false,\n\t\t\t\treopen: false,\n\t\t\t\tdragged: false,\n\t\t\t\ttextareaHeight: 0,\n\t\t\t\twidgetHeight: 0,\n\t\t\t\twidgetWidth: 0,\n\t\t\t\tshowConsent: false,\n\t\t\t\tconsentUrl: '',\n\t\t\t\tdialogStart: false,\n\t\t\t\twatchTyping: false,\n\t\t\t\tshowSessionId: false,\n\t\t\t\tcrmFormsSettings: {\n\t\t\t\t\tuseWelcomeForm: false,\n\t\t\t\t\twelcomeFormId: 0,\n\t\t\t\t\twelcomeFormSec: '',\n\t\t\t\t\twelcomeFormDelay: false,\n\t\t\t\t\twelcomeFormFilled: false,\n\t\t\t\t\tsuccessText: '',\n\t\t\t\t\terrorText: ''\n\t\t\t\t}\n\t\t\t},\n\t\t\tdialog:\n\t\t\t{\n\t\t\t\tsessionId: 0,\n\t\t\t\tsessionClose: true,\n\t\t\t\tsessionStatus: 0,\n\t\t\t\tuserVote: VoteType.none,\n\t\t\t\tcloseVote: false,\n\t\t\t\tuserConsent: false,\n\t\t\t\toperatorChatId: 0,\n\t\t\t\toperator: {\n\t\t\t\t\tid: 0,\n\t\t\t\t\tname: '',\n\t\t\t\t\tfirstName: '',\n\t\t\t\t\tlastName: '',\n\t\t\t\t\tworkPosition: '',\n\t\t\t\t\tavatar: '',\n\t\t\t\t\tonline: false,\n\t\t\t\t}\n\t\t\t},\n\t\t\tuser:\n\t\t\t{\n\t\t\t\tid: -1,\n\t\t\t\thash: '',\n\t\t\t\tname: '',\n\t\t\t\tfirstName: '',\n\t\t\t\tlastName: '',\n\t\t\t\tavatar: '',\n\t\t\t\temail: '',\n\t\t\t\tphone: '',\n\t\t\t\twww: '',\n\t\t\t\tgender: 'M',\n\t\t\t\tposition: '',\n\t\t\t},\n\t\t}\n\t}\n\n\tgetStateSaveException()\n\t{\n\t\treturn {\n\t\t\tcommon: {\n\t\t\t\thost: null,\n\t\t\t\tpageMode: null,\n\t\t\t\tcopyright: null,\n\t\t\t\tcopyrightUrl: null,\n\t\t\t\tstyles: null,\n\t\t\t\tdragged: null,\n\t\t\t\tshowed: null,\n\t\t\t\tshowConsent: null,\n\t\t\t\tshowForm: null,\n\t\t\t},\n\t\t}\n\t}\n\n\tgetMutations()\n\t{\n\t\treturn {\n\n\t\t\tcommon: (state, payload) =>\n\t\t\t{\n\t\t\t\tif (typeof payload.configId === 'number')\n\t\t\t\t{\n\t\t\t\t\tstate.common.configId = payload.configId;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.configName === 'string')\n\t\t\t\t{\n\t\t\t\t\tstate.common.configName = payload.configName;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.online === 'boolean')\n\t\t\t\t{\n\t\t\t\t\tstate.common.online = payload.online;\n\t\t\t\t}\n\t\t\t\tif (Utils.types.isPlainObject(payload.vote))\n\t\t\t\t{\n\t\t\t\t\tif (typeof payload.vote.enable === 'boolean')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.common.vote.enable = payload.vote.enable;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.vote.beforeFinish === 'boolean')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.common.vote.beforeFinish = payload.vote.beforeFinish;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.vote.messageText === 'string')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.common.vote.messageText = payload.vote.messageText;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.vote.messageLike === 'string')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.common.vote.messageLike = payload.vote.messageLike;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.vote.messageDislike === 'string')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.common.vote.messageDislike = payload.vote.messageDislike;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (Utils.types.isPlainObject(payload.textMessages))\n\t\t\t\t{\n\t\t\t\t\tif (typeof payload.textMessages.bxLivechatOnlineLine1 === 'string' && payload.textMessages.bxLivechatOnlineLine1 !== '')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.common.textMessages.bxLivechatOnlineLine1 = payload.textMessages.bxLivechatOnlineLine1;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.textMessages.bxLivechatOnlineLine2 === 'string' && payload.textMessages.bxLivechatOnlineLine2 !== '')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.common.textMessages.bxLivechatOnlineLine2 = payload.textMessages.bxLivechatOnlineLine2;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.textMessages.bxLivechatOffline === 'string' && payload.textMessages.bxLivechatOffline !== '')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.common.textMessages.bxLivechatOffline = payload.textMessages.bxLivechatOffline;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.textMessages.bxLivechatTitle === 'string' && payload.textMessages.bxLivechatTitle !== '')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.common.textMessages.bxLivechatTitle = payload.textMessages.bxLivechatTitle;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (typeof payload.dragged === 'boolean')\n\t\t\t\t{\n\t\t\t\t\tstate.common.dragged = payload.dragged;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.textareaHeight === 'number')\n\t\t\t\t{\n\t\t\t\t\tstate.common.textareaHeight = payload.textareaHeight;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.widgetHeight === 'number')\n\t\t\t\t{\n\t\t\t\t\tstate.common.widgetHeight = payload.widgetHeight;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.widgetWidth === 'number')\n\t\t\t\t{\n\t\t\t\t\tstate.common.widgetWidth = payload.widgetWidth;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.showConsent === 'boolean')\n\t\t\t\t{\n\t\t\t\t\tstate.common.showConsent = payload.showConsent;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.consentUrl === 'string')\n\t\t\t\t{\n\t\t\t\t\tstate.common.consentUrl = payload.consentUrl;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.showed === 'boolean')\n\t\t\t\t{\n\t\t\t\t\tstate.common.showed = payload.showed;\n\t\t\t\t\tpayload.reopen = Utils.device.isMobile()? false: payload.showed;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.reopen === 'boolean')\n\t\t\t\t{\n\t\t\t\t\tstate.common.reopen = payload.reopen;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.copyright === 'boolean')\n\t\t\t\t{\n\t\t\t\t\tstate.common.copyright = payload.copyright;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.dialogStart === 'boolean')\n\t\t\t\t{\n\t\t\t\t\tstate.common.dialogStart = payload.dialogStart;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.watchTyping === 'boolean')\n\t\t\t\t{\n\t\t\t\t\tstate.common.watchTyping = payload.watchTyping;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.showSessionId === 'boolean')\n\t\t\t\t{\n\t\t\t\t\tstate.common.showSessionId = payload.showSessionId;\n\t\t\t\t}\n\t\t\t\tif (payload.operators instanceof Array)\n\t\t\t\t{\n\t\t\t\t\tstate.common.operators = payload.operators;\n\t\t\t\t}\n\t\t\t\tif (payload.connectors instanceof Array)\n\t\t\t\t{\n\t\t\t\t\tstate.common.connectors = payload.connectors;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.showForm === 'string' && typeof FormType[payload.showForm] !== 'undefined')\n\t\t\t\t{\n\t\t\t\t\tif (payload.showForm === FormType.like && !!state.dialog.closeVote)\n\t\t\t\t\t{\n\t\t\t\t\t\tpayload.showForm = FormType.none;\n\t\t\t\t\t}\n\t\t\t\t\tstate.common.showForm = payload.showForm;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.location === 'number' && typeof LocationStyle[payload.location] !== 'undefined')\n\t\t\t\t{\n\t\t\t\t\tif (state.common.location !== payload.location)\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.common.widgetHeight = 0;\n\t\t\t\t\t\tstate.common.widgetWidth = 0;\n\t\t\t\t\t\tstate.common.location = payload.location;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (Utils.types.isPlainObject(payload.crmFormsSettings))\n\t\t\t\t{\n\t\t\t\t\tif (typeof payload.crmFormsSettings.useWelcomeForm === 'string')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.common.crmFormsSettings.useWelcomeForm = payload.crmFormsSettings.useWelcomeForm === 'Y';\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.crmFormsSettings.welcomeFormId === 'string')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.common.crmFormsSettings.welcomeFormId = payload.crmFormsSettings.welcomeFormId;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.crmFormsSettings.welcomeFormSec === 'string')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.common.crmFormsSettings.welcomeFormSec = payload.crmFormsSettings.welcomeFormSec;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.crmFormsSettings.welcomeFormDelay === 'string')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.common.crmFormsSettings.welcomeFormDelay = payload.crmFormsSettings.welcomeFormDelay === 'Y';\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.crmFormsSettings.successText === 'string' && payload.crmFormsSettings.successText !== '')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.common.crmFormsSettings.successText = payload.crmFormsSettings.successText;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.crmFormsSettings.errorText === 'string' && payload.crmFormsSettings.errorText !== '')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.common.crmFormsSettings.errorText = payload.crmFormsSettings.errorText;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (this.isSaveNeeded({common: payload}))\n\t\t\t\t{\n\t\t\t\t\tthis.saveState(state);\n\t\t\t\t}\n\t\t\t},\n\t\t\tdialog: (state, payload) =>\n\t\t\t{\n\t\t\t\tif (typeof payload.sessionId === 'number')\n\t\t\t\t{\n\t\t\t\t\tstate.dialog.sessionId = payload.sessionId;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.sessionClose === 'boolean')\n\t\t\t\t{\n\t\t\t\t\tstate.dialog.sessionClose = payload.sessionClose;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.sessionStatus === 'number')\n\t\t\t\t{\n\t\t\t\t\tstate.dialog.sessionStatus = payload.sessionStatus;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.userConsent === 'boolean')\n\t\t\t\t{\n\t\t\t\t\tstate.dialog.userConsent = payload.userConsent;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.userVote === 'string' && typeof payload.userVote !== 'undefined')\n\t\t\t\t{\n\t\t\t\t\tstate.dialog.userVote = payload.userVote;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.closeVote === 'boolean')\n\t\t\t\t{\n\t\t\t\t\tstate.dialog.closeVote = payload.closeVote;\n\n\t\t\t\t\tif (\n\t\t\t\t\t\t!!payload.closeVote\n\t\t\t\t\t\t&& state.common.showForm === FormType.like\n\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.common.showForm = FormType.none;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (typeof payload.operatorChatId === 'number')\n\t\t\t\t{\n\t\t\t\t\tstate.dialog.operatorChatId = payload.operatorChatId;\n\t\t\t\t}\n\t\t\t\tif (Utils.types.isPlainObject(payload.operator))\n\t\t\t\t{\n\t\t\t\t\tif (typeof payload.operator.id === 'number')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.dialog.operator.id = payload.operator.id;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.operator.name === 'string' || typeof payload.operator.name === 'number')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.dialog.operator.name = payload.operator.name.toString();\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.operator.lastName === 'string' || typeof payload.operator.lastName === 'number')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.dialog.operator.lastName = payload.operator.lastName.toString();\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.operator.firstName === 'string' || typeof payload.operator.firstName === 'number')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.dialog.operator.firstName = payload.operator.firstName.toString();\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.operator.workPosition === 'string' || typeof payload.operator.workPosition === 'number')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.dialog.operator.workPosition = payload.operator.workPosition.toString();\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.operator.avatar === 'string')\n\t\t\t\t\t{\n\t\t\t\t\t\tif (!payload.operator.avatar || payload.operator.avatar.startsWith('http'))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tstate.dialog.operator.avatar = payload.operator.avatar;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tstate.dialog.operator.avatar = state.common.host+payload.operator.avatar;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof payload.operator.online === 'boolean')\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.dialog.operator.online = payload.operator.online;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (this.isSaveNeeded({dialog: payload}))\n\t\t\t\t{\n\t\t\t\t\tthis.saveState(state);\n\t\t\t\t}\n\t\t\t},\n\t\t\tuser: (state, payload) =>\n\t\t\t{\n\t\t\t\tif (typeof payload.id === 'number')\n\t\t\t\t{\n\t\t\t\t\tstate.user.id = payload.id;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.hash === 'string' && payload.hash !== state.user.hash)\n\t\t\t\t{\n\t\t\t\t\tstate.user.hash = payload.hash;\n\t\t\t\t\tCookie.set(null, 'LIVECHAT_HASH', payload.hash, {expires: 365*86400, path: '/'});\n\t\t\t\t}\n\t\t\t\tif (typeof payload.name === 'string' || typeof payload.name === 'number')\n\t\t\t\t{\n\t\t\t\t\tstate.user.name = payload.name.toString();\n\t\t\t\t}\n\t\t\t\tif (typeof payload.firstName === 'string' || typeof payload.firstName === 'number')\n\t\t\t\t{\n\t\t\t\t\tstate.user.firstName = payload.firstName.toString();\n\t\t\t\t}\n\t\t\t\tif (typeof payload.lastName === 'string' || typeof payload.lastName === 'number')\n\t\t\t\t{\n\t\t\t\t\tstate.user.lastName = payload.lastName.toString();\n\t\t\t\t}\n\t\t\t\tif (typeof payload.avatar === 'string')\n\t\t\t\t{\n\t\t\t\t\tstate.user.avatar = payload.avatar;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.email === 'string')\n\t\t\t\t{\n\t\t\t\t\tstate.user.email = payload.email;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.phone === 'string' || typeof payload.phone === 'number')\n\t\t\t\t{\n\t\t\t\t\tstate.user.phone = payload.phone.toString();\n\t\t\t\t}\n\t\t\t\tif (typeof payload.www === 'string')\n\t\t\t\t{\n\t\t\t\t\tstate.user.www = payload.www;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.gender === 'string')\n\t\t\t\t{\n\t\t\t\t\tstate.user.gender = payload.gender;\n\t\t\t\t}\n\t\t\t\tif (typeof payload.position === 'string')\n\t\t\t\t{\n\t\t\t\t\tstate.user.position = payload.position;\n\t\t\t\t}\n\n\t\t\t\tif (this.isSaveNeeded({user: payload}))\n\t\t\t\t{\n\t\t\t\t\tthis.saveState(state);\n\t\t\t\t}\n\t\t\t},\n\t\t}\n\t}\n\n\tgetActions()\n\t{\n\t\treturn {\n\t\t\tshow: ({ commit }) =>\n\t\t\t{\n\t\t\t\tcommit('common', {showed: true});\n\t\t\t},\n\t\t\tsetVoteDateFinish: ({ commit, dispatch, state }, payload) =>\n\t\t\t{\n\t\t\t\tif (!payload)\n\t\t\t\t{\n\t\t\t\t\tclearTimeout(this.setVoteDateTimeout);\n\t\t\t\t\tcommit('dialog', {closeVote: false});\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\tconst totalDelay = new Date(payload).getTime() - new Date().getTime();\n\t\t\t\tconst dayTimestamp = 10000;\n\t\t\t\tclearTimeout(this.setVoteDateTimeout);\n\n\t\t\t\tif (payload)\n\t\t\t\t{\n\t\t\t\t\tif (totalDelay && !state.dialog.closeVote)\n\t\t\t\t\t{\n\t\t\t\t\t\tcommit('dialog', {closeVote: false});\n\t\t\t\t\t}\n\n\t\t\t\t\tvar delay = totalDelay;\n\n\t\t\t\t\tif(totalDelay > dayTimestamp)\n\t\t\t\t\t{\n\t\t\t\t\t\tdelay = dayTimestamp;\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.setVoteDateTimeout = setTimeout(function requestCloseVote() {\n\t\t\t\t\t\tdelay = new Date(payload).getTime() - new Date().getTime();\n\t\t\t\t\t\tif(delay > 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif(delay > dayTimestamp)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tdelay = dayTimestamp;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tsetTimeout(requestCloseVote, delay);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcommit('dialog', {closeVote: true});\n\t\t\t\t\t\t}\n\t\t\t\t\t}, delay);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}","/**\n * Bitrix OpenLines widget\n * Rest client (base on BX.RestClient)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\n// TODO change BX.RestClient, BX.promise to import\n\nimport {Utils} from \"im.lib.utils\";\nimport {RestAuth, RestMethod} from \"../const\";\nimport {RestClient} from \"rest.client\";\n\nexport class WidgetRestClient\n{\n\tconstructor(params)\n\t{\n\t\tthis.queryAuthRestore = false;\n\n\t\tthis.setAuthId(RestAuth.guest);\n\n\t\tthis.restClient = new RestClient({\n\t\t\tendpoint: params.endpoint,\n\t\t\tqueryParams: this.queryParams,\n\t\t\tcors: true\n\t\t});\n\t}\n\n\tsetAuthId(authId, customAuthId = '')\n\t{\n\t\tif (typeof this.queryParams !== 'object')\n\t\t{\n\t\t\tthis.queryParams = {};\n\t\t}\n\n\t\tif (\n\t\t\tauthId == RestAuth.guest\n\t\t\t|| typeof authId === 'string' && authId.match(/^[a-f0-9]{32}$/)\n\t\t)\n\t\t{\n\t\t\tthis.queryParams.livechat_auth_id = authId;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconsole.error(`%LiveChatRestClient.setAuthId: auth is not correct (%c${authId}%c)`, \"color: black;\", \"font-weight: bold; color: red\", \"color: black\");\n\t\t\treturn false;\n\t\t}\n\n\t\tif (\n\t\t\tauthId == RestAuth.guest\n\t\t\t&& typeof customAuthId === 'string' && customAuthId.match(/^[a-f0-9]{32}$/)\n\t\t)\n\t\t{\n\t\t\tthis.queryParams.livechat_custom_auth_id = customAuthId;\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tgetAuthId()\n\t{\n\t\tif (typeof this.queryParams !== 'object')\n\t\t{\n\t\t\tthis.queryParams = {};\n\t\t}\n\n\t\treturn this.queryParams.livechat_auth_id || null;\n\t}\n\n\tcallMethod(method, params, callback, sendCallback, logTag = null)\n\t{\n\t\tif (!logTag)\n\t\t{\n\t\t\tlogTag = Utils.getLogTrackingParams({\n\t\t\t\tname: method,\n\t\t\t});\n\t\t}\n\n\t\tconst promise = new BX.Promise();\n\n\t\t// TODO: Callbacks methods will not work!\n\t\tthis.restClient.callMethod(method, params, null, sendCallback, logTag).then(result => {\n\n\t\t\tthis.queryAuthRestore = false;\n\t\t\tpromise.fulfill(result);\n\n\t\t}).catch(result => {\n\n\t\t\tlet error = result.error();\n\t\t\tif (error.ex.error == 'LIVECHAT_AUTH_WIDGET_USER')\n\t\t\t{\n\t\t\t\tthis.setAuthId(error.ex.hash);\n\n\t\t\t\tif (method === RestMethod.widgetUserRegister)\n\t\t\t\t{\n\t\t\t\t\tconsole.warn(`BX.LiveChatRestClient: ${error.ex.error_description} (${error.ex.error})`);\n\n\t\t\t\t\tthis.queryAuthRestore = false;\n\t\t\t\t\tpromise.reject(result);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tif (!this.queryAuthRestore)\n\t\t\t\t{\n\t\t\t\t\tconsole.warn('BX.LiveChatRestClient: your auth-token has expired, send query with a new token');\n\n\t\t\t\t\tthis.queryAuthRestore = true;\n\t\t\t\t\tthis.restClient.callMethod(method, params, null, sendCallback, logTag).then(result => {\n\t\t\t\t\t\tthis.queryAuthRestore = false;\n\t\t\t\t\t\tpromise.fulfill(result);\n\t\t\t\t\t}).catch(result => {\n\t\t\t\t\t\tthis.queryAuthRestore = false;\n\t\t\t\t\t\tpromise.reject(result);\n\t\t\t\t\t});\n\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.queryAuthRestore = false;\n\t\t\tpromise.reject(result);\n\t\t});\n\n\t\treturn promise;\n\t};\n\n\tcallBatch(calls, callback, bHaltOnError, sendCallback, logTag)\n\t{\n\t\tlet resultCallback = (result) =>\n\t\t{\n\t\t\tlet error = null;\n\t\t\tfor (let method in calls)\n\t\t\t{\n\t\t\t\tif (!calls.hasOwnProperty(method))\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tlet error = result[method].error();\n\t\t\t\tif (error && error.ex.error == 'LIVECHAT_AUTH_WIDGET_USER')\n\t\t\t\t{\n\t\t\t\t\tthis.setAuthId(error.ex.hash);\n\t\t\t\t\tif (method === RestMethod.widgetUserRegister)\n\t\t\t\t\t{\n\t\t\t\t\t\tconsole.warn(`BX.LiveChatRestClient: ${error.ex.error_description} (${error.ex.error})`);\n\n\t\t\t\t\t\tthis.queryAuthRestore = false;\n\t\t\t\t\t\tcallback(result);\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!this.queryAuthRestore)\n\t\t\t\t\t{\n\t\t\t\t\t\tconsole.warn('BX.LiveChatRestClient: your auth-token has expired, send query with a new token');\n\n\t\t\t\t\t\tthis.queryAuthRestore = true;\n\t\t\t\t\t\tthis.restClient.callBatch(calls, callback, bHaltOnError, sendCallback, logTag);\n\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.queryAuthRestore = false;\n\t\t\tcallback(result);\n\n\t\t\treturn true;\n\t\t};\n\n\t\treturn this.restClient.callBatch(calls, resultCallback, bHaltOnError, sendCallback, logTag);\n\t};\n}","/**\n * Bitrix OpenLines widget\n * Widget Rest answers (Rest Answer Handler)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {BaseRestHandler} from \"im.provider.rest\";\nimport {LocalStorage} from \"im.lib.localstorage\";\nimport {SubscriptionType} from \"./const\";\n\nclass WidgetRestAnswerHandler extends BaseRestHandler\n{\n\tconstructor(props = {})\n\t{\n\t\tsuper(props);\n\n\t\tthis.widget = props.widget;\n\t}\n\n\thandleImopenlinesWidgetConfigGetSuccess(data)\n\t{\n\t\tthis.store.commit('widget/common', {\n\t\t\tconfigId: data.configId,\n\t\t\tconfigName: data.configName,\n\t\t\tvote: data.vote,\n\t\t\ttextMessages: data.textMessages,\n\t\t\toperators: data.operators || [],\n\t\t\tonline: data.online,\n\t\t\tconsentUrl: data.consentUrl,\n\t\t\tconnectors: data.connectors || [],\n\t\t\twatchTyping: data.watchTyping,\n\t\t\tshowSessionId: data.showSessionId,\n\t\t\tcrmFormsSettings: data.crmFormsSettings\n\t\t});\n\n\t\tthis.store.commit('application/set', {disk: data.disk});\n\n\t\tthis.widget.addLocalize(data.serverVariables);\n\t\tLocalStorage.set(this.widget.getSiteId(), 0, 'serverVariables', data.serverVariables || {});\n\t}\n\n\thandleImopenlinesWidgetUserRegisterSuccess(data)\n\t{\n\t\tthis.widget.restClient.setAuthId(data.hash);\n\n\t\tlet previousData = [];\n\t\tif (typeof this.store.state.messages.collection[this.controller.application.getChatId()] !== 'undefined')\n\t\t{\n\t\t\tpreviousData = this.store.state.messages.collection[this.controller.application.getChatId()];\n\t\t}\n\t\tthis.store.commit('messages/initCollection', {chatId: data.chatId, messages: previousData});\n\n\t\tthis.store.commit('dialogues/initCollection', {dialogId: data.dialogId, fields: {\n\t\t\tentityType: 'LIVECHAT',\n\t\t\ttype: 'livechat'\n\t\t}});\n\n\t\tthis.store.commit('application/set', {dialog: {\n\t\t\tchatId: data.chatId,\n\t\t\tdialogId: 'chat'+data.chatId\n\t\t}});\n\t}\n\n\thandleImopenlinesWidgetUserGetSuccess(data)\n\t{\n\t\tthis.store.commit('widget/user', {\n\t\t\tid: data.id,\n\t\t\thash: data.hash,\n\t\t\tname: data.name,\n\t\t\tfirstName: data.firstName,\n\t\t\tlastName: data.lastName,\n\t\t\tphone: data.phone,\n\t\t\tavatar: data.avatar,\n\t\t\temail: data.email,\n\t\t\twww: data.www,\n\t\t\tgender: data.gender,\n\t\t\tposition: data.position,\n\t\t});\n\t\tthis.store.dispatch('users/set', [{\n\t\t\tid: data.id,\n\t\t\tname: data.name,\n\t\t\tfirstName: data.firstName,\n\t\t\tlastName: data.lastName,\n\t\t\tavatar: data.avatar,\n\t\t\tgender: data.gender,\n\t\t\tworkPosition: data.position,\n\t\t}]);\n\t\tthis.store.commit('application/set', {common: {\n\t\t\tuserId: data.id\n\t\t}});\n\t}\n\n\thandleImopenlinesWidgetDialogGetSuccess(data)\n\t{\n\t\tthis.store.commit('messages/initCollection', {chatId: data.chatId});\n\n\t\tthis.store.commit('widget/dialog', data);\n\n\t\tthis.store.commit('application/set', {dialog: {\n\t\t\tchatId: data.chatId,\n\t\t\tdialogId: 'chat'+data.chatId,\n\t\t\tdiskFolderId: data.diskFolderId,\n\t\t}});\n\n\t\tthis.store.dispatch('widget/setVoteDateFinish', data.dateCloseVote);\n\t}\n\n\thandleImDialogMessagesGetInitSuccess(data)\n\t{\n\t\tthis.handleImDialogMessagesGetSuccess(data);\n\t}\n\n\thandleImDialogMessagesGetSuccess(data)\n\t{\n\t\tif (data.messages && data.messages.length > 0 && !this.widget.isDialogStart())\n\t\t{\n\t\t\tthis.store.commit('widget/common', {\n\t\t\t\tdialogStart: true\n\t\t\t});\n\t\t\tthis.store.commit('widget/dialog', {\n\t\t\t\tuserConsent: true\n\t\t\t});\n\t\t}\n\t}\n\n\thandleImMessageAddSuccess(messageId, message)\n\t{\n\t\tthis.widget.messagesQueue = this.widget.messagesQueue.filter(el => el.id != message.id);\n\n\t\tthis.widget.sendEvent({\n\t\t\ttype: SubscriptionType.userMessage,\n\t\t\tdata: {\n\t\t\t\tid: messageId,\n\t\t\t\ttext: message.text\n\t\t\t}\n\t\t});\n\t}\n\n\thandleImMessageAddError(error, message)\n\t{\n\t\tthis.widget.messagesQueue = this.widget.messagesQueue.filter(el => el.id != message.id);\n\t}\n\n\thandleImDiskFileCommitSuccess(result, message)\n\t{\n\t\tthis.widget.messagesQueue = this.widget.messagesQueue.filter(el => el.id != message.id);\n\n\t\tthis.widget.sendEvent({\n\t\t\ttype: SubscriptionType.userFile,\n\t\t\tdata: {}\n\t\t});\n\t}\n}\n\nexport {WidgetRestAnswerHandler};","/**\n * Bitrix OpenLines widget\n * Widget pull commands (Pull Command Handler)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {SubscriptionType, VoteType} from \"./const\";\n\nclass WidgetImPullCommandHandler\n{\n\tstatic create(params = {})\n\t{\n\t\treturn new this(params);\n\t}\n\n\tgetModuleId()\n\t{\n\t\treturn 'im';\n\t}\n\n\tconstructor(params)\n\t{\n\t\tthis.controller = params.controller;\n\t\tthis.store = params.store;\n\t\tthis.widget = params.widget;\n\t}\n\n\thandleMessageChat(params, extra, command)\n\t{\n\t\tif (params.message.senderId != this.controller.application.getUserId())\n\t\t{\n\t\t\tthis.widget.sendEvent({\n\t\t\t\ttype: SubscriptionType.operatorMessage,\n\t\t\t\tdata: params\n\t\t\t});\n\n\t\t\tif (!this.store.state.widget.common.showed && !this.widget.onceShowed)\n\t\t\t{\n\t\t\t\tthis.widget.onceShowed = true;\n\t\t\t\tthis.widget.open();\n\t\t\t}\n\t\t}\n\t}\n}\n\nclass WidgetImopenlinesPullCommandHandler\n{\n\tstatic create(params = {})\n\t{\n\t\treturn new this(params);\n\t}\n\n\tconstructor(params = {})\n\t{\n\t\tthis.controller = params.controller;\n\t\tthis.store = params.store;\n\t\tthis.widget = params.widget;\n\t}\n\n\tgetModuleId()\n\t{\n\t\treturn 'imopenlines';\n\t}\n\n\thandleSessionStart(params, extra, command)\n\t{\n\t\tthis.store.commit('widget/dialog', {\n\t\t\tsessionId: params.sessionId,\n\t\t\tsessionClose: false,\n\t\t\tsessionStatus: 0,\n\t\t\tuserVote: VoteType.none,\n\t\t});\n\n\t\tthis.store.dispatch('widget/setVoteDateFinish', '');\n\n\t\tthis.widget.sendEvent({\n\t\t\ttype: SubscriptionType.sessionStart,\n\t\t\tdata: {\n\t\t\t\tsessionId: params.sessionId\n\t\t\t}\n\t\t});\n\t}\n\n\thandleSessionOperatorChange(params, extra, command)\n\t{\n\t\tthis.store.commit('widget/dialog', {\n\t\t\toperator: params.operator,\n\t\t\toperatorChatId: params.operatorChatId\n\t\t});\n\n\t\tthis.widget.sendEvent({\n\t\t\ttype: SubscriptionType.sessionOperatorChange,\n\t\t\tdata: {\n\t\t\t\toperator: params.operator\n\t\t\t}\n\t\t});\n\t}\n\n\thandleSessionStatus(params, extra, command)\n\t{\n\t\tthis.store.commit('widget/dialog', {\n\t\t\tsessionId: params.sessionId,\n\t\t\tsessionStatus: params.sessionStatus,\n\t\t\tsessionClose: params.sessionClose,\n\t\t});\n\n\t\tthis.widget.sendEvent({\n\t\t\ttype: SubscriptionType.sessionStatus,\n\t\t\tdata: {\n\t\t\t\tsessionId: params.sessionId,\n\t\t\t\tsessionStatus: params.sessionStatus\n\t\t\t}\n\t\t});\n\n\t\tif (params.sessionClose)\n\t\t{\n\t\t\tthis.widget.sendEvent({\n\t\t\t\ttype: SubscriptionType.sessionFinish,\n\t\t\t\tdata: {\n\t\t\t\t\tsessionId: params.sessionId,\n\t\t\t\t\tsessionStatus: params.sessionStatus\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (!params.spam)\n\t\t\t{\n\t\t\t\tthis.store.commit('widget/dialog', {\n\t\t\t\t\toperator: {\n\t\t\t\t\t\tname: '',\n\t\t\t\t\t\tfirstName: '',\n\t\t\t\t\t\tlastName: '',\n\t\t\t\t\t\tworkPosition: '',\n\t\t\t\t\t\tavatar: '',\n\t\t\t\t\t\tonline: false,\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\thandleSessionDateCloseVote(params, extra, command)\n\t{\n\t\tthis.store.dispatch('widget/setVoteDateFinish', params.dateCloseVote);\n\t}\n}\n\nexport {\n\tWidgetImPullCommandHandler,\n\tWidgetImopenlinesPullCommandHandler,\n};","/**\n * Bitrix OpenLines widget\n * Widget private interface (base class)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2020 Bitrix\n */\n\n// widget files\nimport {\n\tVoteType,\n\tLocationStyle,\n\tSubscriptionType,\n\tSubscriptionTypeCheck,\n\tRestMethod,\n\tRestAuth,\n} from \"./const\";\n\nimport {WidgetModel} from \"./model\";\nimport {WidgetRestClient} from \"./utils/restclient\"\nimport {WidgetRestAnswerHandler} from \"./rest.handler\";\nimport {WidgetImPullCommandHandler, WidgetImopenlinesPullCommandHandler} from \"./pull.handler\";\n\n// main\nimport {md5} from \"main.md5\";\nimport \"main.date\";\n\n// pull\nimport {PullClient} from \"pull.client\";\n\n// ui\nimport {Vue} from \"ui.vue\";\nimport {VuexBuilder} from \"ui.vue.vuex\";\nimport 'ui.vue.components.crm.form';\n\n// messenger files\nimport {Controller} from 'im.controller';\nimport {\n\tRestMethod as ImRestMethod,\n\tRestMethodHandler as ImRestMethodHandler,\n\tEventType,\n\tFileStatus\n} from 'im.const';\n\nimport {Cookie} from \"im.lib.cookie\";\nimport {Utils} from \"im.lib.utils\";\nimport {LocalStorage} from \"im.lib.localstorage\";\nimport {Logger} from \"im.lib.logger\";\n\nimport {Uploader} from \"im.lib.uploader\";\nimport { EventEmitter } from \"main.core.events\";\nimport { ZIndexManager } from \"main.core.minimal\";\n\n// TODO change BX.Promise, BX.Main.Date to IMPORT\n\nexport class Widget\n{\n/* region 01. Initialize and store data */\n\n\tconstructor(params = {})\n\t{\n\t\tthis.params = params;\n\n\t\tthis.template = null;\n\t\tthis.rootNode = this.params.node || document.createElement('div');\n\n\t\tthis.messagesQueue = [];\n\n\t\tthis.ready = true;\n\t\tthis.widgetDataRequested = false;\n\t\tthis.offline = false;\n\n\t\tthis.inited = false;\n\t\tthis.initEventFired = false;\n\n\t\tthis.restClient = null;\n\n\t\tthis.userRegisterData = {};\n\t\tthis.customData = [];\n\n\t\tthis.options = {\n\t\t\tcheckSameDomain: true\n\t\t};\n\n\t\tthis.subscribers = {};\n\n\t\tthis.configRequestXhr = null;\n\n\t\tthis.initParams()\n\t\t\t.then(() => this.initRestClient())\n\t\t\t.then(() => this.initPullClient())\n\t\t\t.then(() => this.initCore())\n\t\t\t.then(() => this.initWidget())\n\t\t\t.then(() => this.initUploader())\n\t\t\t.then(() => this.initComplete())\n\t\t;\n\t}\n\n\tinitParams()\n\t{\n\t\tthis.code = this.params.code || '';\n\t\tthis.host = this.params.host || '';\n\t\tthis.language = this.params.language || 'en';\n\t\tthis.copyright = this.params.copyright !== false;\n\t\tthis.copyrightUrl = this.copyright && this.params.copyrightUrl? this.params.copyrightUrl: '';\n\t\tthis.buttonInstance = typeof this.params.buttonInstance === 'object' && this.params.buttonInstance !== null? this.params.buttonInstance: null;\n\n\t\tthis.pageMode = typeof this.params.pageMode === 'object' && this.params.pageMode;\n\t\tif (this.pageMode)\n\t\t{\n\t\t\tthis.pageMode.useBitrixLocalize = this.params.pageMode.useBitrixLocalize === true;\n\t\t\tthis.pageMode.placeholder = document.getElementById(this.params.pageMode.placeholder);\n\t\t}\n\n\t\tif (typeof this.code === 'string')\n\t\t{\n\t\t\tif (this.code.length <= 0)\n\t\t\t{\n\t\t\t\tconsole.warn(`%cLiveChatWidget.constructor: code is not correct (%c${this.code}%c)`, \"color: black;\", \"font-weight: bold; color: red\", \"color: black\");\n\t\t\t\tthis.ready = false;\n\t\t\t}\n\t\t}\n\n\t\tif (typeof this.host === 'string')\n\t\t{\n\t\t\tif (this.host.length <= 0 || !this.host.startsWith('http'))\n\t\t\t{\n\t\t\t\tconsole.warn(`%cLiveChatWidget.constructor: host is not correct (%c${this.host}%c)`, \"color: black;\", \"font-weight: bold; color: red\", \"color: black\");\n\t\t\t\tthis.ready = false;\n\t\t\t}\n\t\t}\n\n\t\tif (this.pageMode && this.pageMode.placeholder)\n\t\t{\n\t\t\tthis.rootNode = this.pageMode.placeholder;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (document.body.firstChild)\n\t\t\t{\n\t\t\t\tdocument.body.insertBefore(this.rootNode, document.body.firstChild);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tdocument.body.appendChild(this.rootNode);\n\t\t\t}\n\t\t}\n\n\t\tthis.localize = this.pageMode && this.pageMode.useBitrixLocalize? window.BX.message: {};\n\t\tif (typeof this.params.localize === 'object')\n\t\t{\n\t\t\tthis.addLocalize(this.params.localize);\n\t\t}\n\n\t\tlet serverVariables = LocalStorage.get(this.getSiteId(), 0, 'serverVariables', false);\n\t\tif (serverVariables)\n\t\t{\n\t\t\tthis.addLocalize(serverVariables);\n\t\t}\n\n\t\treturn new Promise((resolve, reject) => resolve());\n\t}\n\n\tinitRestClient()\n\t{\n\t\tthis.restClient = new WidgetRestClient({endpoint: this.host+'/rest'});\n\n\t\treturn new Promise((resolve, reject) => resolve());\n\t}\n\n\tinitPullClient()\n\t{\n\t\tthis.pullClient = new PullClient({\n\t\t\tserverEnabled: true,\n\t\t\tuserId: 0,\n\t\t\tsiteId: this.getSiteId(),\n\t\t\trestClient: this.restClient,\n\t\t\tskipStorageInit: true,\n\t\t\tconfigTimestamp: 0,\n\t\t\tskipCheckRevision: true,\n\t\t\tgetPublicListMethod: 'imopenlines.widget.operator.get',\n\t\t});\n\t\tthis.pullClientInited = false;\n\n\t\treturn new Promise((resolve, reject) => resolve());\n\t}\n\n\tinitCore()\n\t{\n\t\tlet widgetVariables = {\n\t\t\tcommon: {\n\t\t\t\thost: this.getHost(),\n\t\t\t\tpageMode: this.pageMode !== false,\n\t\t\t\tcopyright: this.copyright,\n\t\t\t\tcopyrightUrl: this.copyrightUrl,\n\t\t\t},\n\t\t\tvote: {\n\t\t\t\tmessageText: this.getLocalize('BX_LIVECHAT_VOTE_TITLE'),\n\t\t\t\tmessageLike: this.getLocalize('BX_LIVECHAT_VOTE_PLUS_TITLE'),\n\t\t\t\tmessageDislike: this.getLocalize('BX_LIVECHAT_VOTE_MINUS_TITLE'),\n\t\t\t},\n\t\t\ttextMessages: {\n\t\t\t\tbxLivechatOnlineLine1: this.getLocalize('BX_LIVECHAT_ONLINE_LINE_1'),\n\t\t\t\tbxLivechatOnlineLine2: this.getLocalize('BX_LIVECHAT_ONLINE_LINE_2'),\n\t\t\t\tbxLivechatOffline: this.getLocalize('BX_LIVECHAT_OFFLINE'),\n\t\t\t}\n\t\t};\n\t\tif (\n\t\t\tUtils.types.isPlainObject(this.params.styles)\n\t\t\t&& (this.params.styles.backgroundColor || this.params.styles.iconColor)\n\t\t)\n\t\t{\n\t\t\twidgetVariables.styles = {};\n\t\t\tif (this.params.styles.backgroundColor)\n\t\t\t{\n\t\t\t\twidgetVariables.styles.backgroundColor = this.params.styles.backgroundColor;\n\t\t\t}\n\t\t\tif (this.params.styles.iconColor)\n\t\t\t{\n\t\t\t\twidgetVariables.styles.iconColor = this.params.styles.iconColor;\n\t\t\t}\n\t\t}\n\n\t\tthis.controller = new Controller({\n\t\t\thost: this.getHost(),\n\t\t\tsiteId: this.getSiteId(),\n\t\t\tuserId: 0,\n\t\t\tlanguageId: this.language,\n\t\t\tpull: {client: this.pullClient},\n\t\t\trest: {client: this.restClient},\n\t\t\tlocalize: this.localize,\n\t\t\tvuexBuilder: {\n\t\t\t\tdatabase: !Utils.browser.isIe(),\n\t\t\t\tdatabaseName: 'imol/widget',\n\t\t\t\tdatabaseType: VuexBuilder.DatabaseType.localStorage,\n\t\t\t\tmodels: [\n\t\t\t\t\tWidgetModel.create().setVariables(widgetVariables)\n\t\t\t\t],\n\t\t\t}\n\t\t});\n\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.controller.ready().then(() => resolve());\n\t\t});\n\t}\n\n\tinitWidget()\n\t{\n\t\tif (this.isUserRegistered())\n\t\t{\n\t\t\tthis.restClient.setAuthId(this.getUserHash());\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.restClient.setAuthId(RestAuth.guest);\n\t\t}\n\n\t\tif (this.params.location && typeof LocationStyle[this.params.location] !== 'undefined')\n\t\t{\n\t\t\tthis.controller.getStore().commit('widget/common', {location: this.params.location});\n\t\t}\n\n\t\tthis.controller.application.setPrepareFilesBeforeSaveFunction(this.prepareFileData.bind(this));\n\n\t\tthis.controller.addRestAnswerHandler(\n\t\t\tWidgetRestAnswerHandler.create({\n\t\t\t\twidget: this,\n\t\t\t\tstore: this.controller.getStore(),\n\t\t\t\tcontroller: this.controller,\n\t\t\t})\n\t\t);\n\n\t\treturn new Promise((resolve, reject) => resolve());\n\t}\n\n\tinitUploader()\n\t{\n\t\tthis.uploader = new Uploader({\n\t\t\tgeneratePreview: true,\n\t\t\tsender: {\n\t\t\t\thost: this.host,\n\t\t\t\tcustomHeaders: {\n\t\t\t\t\t'Livechat-Auth-Id': this.getUserHash()\n\t\t\t\t},\n\t\t\t\tactionUploadChunk: 'imopenlines.widget.disk.upload',\n\t\t\t\tactionCommitFile: 'imopenlines.widget.disk.commit',\n\t\t\t\tactionRollbackUpload: 'imopenlines.widget.disk.rollbackUpload',\n\t\t\t}\n\t\t});\n\n\t\tthis.uploader.subscribe('onStartUpload', event => {\n\t\t\tconst eventData = event.getData();\n\t\t\tLogger.log('Uploader: onStartUpload', eventData);\n\n\t\t\tthis.controller.getStore().dispatch('files/update', {\n\t\t\t\tchatId: this.getChatId(),\n\t\t\t\tid: eventData.id,\n\t\t\t\tfields: {\n\t\t\t\t\tstatus: FileStatus.upload,\n\t\t\t\t\tprogress: 0\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\n\t\tthis.uploader.subscribe('onProgress', (event) => {\n\t\t\tconst eventData = event.getData();\n\t\t\tLogger.log('Uploader: onProgress', eventData);\n\n\t\t\tthis.controller.getStore().dispatch('files/update', {\n\t\t\t\tchatId: this.getChatId(),\n\t\t\t\tid: eventData.id,\n\t\t\t\tfields: {\n\t\t\t\t\tstatus: FileStatus.upload,\n\t\t\t\t\tprogress: (eventData.progress === 100 ? 99 : eventData.progress),\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\n\t\tthis.uploader.subscribe('onSelectFile', (event) => {\n\t\t\tconst eventData = event.getData();\n\t\t\tconst file = eventData.file;\n\t\t\tLogger.log('Uploader: onSelectFile', eventData);\n\n\t\t\tlet fileType = 'file';\n\t\t\tif (file.type.toString().startsWith('image'))\n\t\t\t{\n\t\t\t\tfileType = 'image';\n\t\t\t}\n\t\t\telse if (file.type.toString().startsWith('video'))\n\t\t\t{\n\t\t\t\tfileType = 'video';\n\t\t\t}\n\n\t\t\tthis.controller.getStore().dispatch('files/add', {\n\t\t\t\tchatId: this.getChatId(),\n\t\t\t\tauthorId: this.getUserId(),\n\t\t\t\tname: eventData.file.name,\n\t\t\t\ttype: fileType,\n\t\t\t\textension: file.name.split('.').splice(-1)[0],\n\t\t\t\tsize: eventData.file.size,\n\t\t\t\timage: !eventData.previewData? false: {\n\t\t\t\t\twidth: eventData.previewDataWidth,\n\t\t\t\t\theight: eventData.previewDataHeight,\n\t\t\t\t},\n\t\t\t\tstatus: FileStatus.upload,\n\t\t\t\tprogress: 0,\n\t\t\t\tauthorName: this.controller.application.getCurrentUser().name,\n\t\t\t\turlPreview: eventData.previewData? URL.createObjectURL(eventData.previewData) : \"\",\n\t\t\t}).then(fileId => {\n\t\t\t\tthis.addMessage('', {id: fileId, source: eventData, previewBlob: eventData.previewData})\n\t\t\t});\n\t\t});\n\n\t\tthis.uploader.subscribe('onComplete', (event) => {\n\t\t\tconst eventData = event.getData();\n\t\t\tLogger.log('Uploader: onComplete', eventData);\n\n\t\t\tthis.controller.getStore().dispatch('files/update', {\n\t\t\t\tchatId: this.getChatId(),\n\t\t\t\tid: eventData.id,\n\t\t\t\tfields: {\n\t\t\t\t\tstatus: FileStatus.wait,\n\t\t\t\t\tprogress: 100\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tconst message = this.messagesQueue.find(message => {\n\t\t\t\treturn message.file.id === eventData.id\n\t\t\t});\n\t\t\tconst fileType = this.controller.getStore().getters['files/get'](this.getChatId(), message.file.id, true).type;\n\n\t\t\tthis.fileCommit({\n\t\t\t\tchatId: this.getChatId(),\n\t\t\t\tuploadId: eventData.result.data.file.id,\n\t\t\t\tmessageText: message.text,\n\t\t\t\tmessageId: message.id,\n\t\t\t\tfileId: message.file.id,\n\t\t\t\tfileType\n\t\t\t}, message);\n\t\t});\n\n\t\tthis.uploader.subscribe('onUploadFileError', (event) => {\n\t\t\tconst eventData = event.getData();\n\t\t\tLogger.log('Uploader: onUploadFileError', eventData);\n\n\t\t\tconst message = this.messagesQueue.find(message => {\n\t\t\t\treturn message.file.id === eventData.id\n\t\t\t});\n\n\t\t\tif (typeof message === 'undefined')\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.fileError(this.getChatId(), message.file.id, message.id);\n\t\t});\n\n\t\tthis.uploader.subscribe('onCreateFileError', (event) => {\n\t\t\tconst eventData = event.getData();\n\t\t\tLogger.log('Uploader: onCreateFileError', eventData);\n\n\t\t\tconst message = this.messagesQueue.find(message => {\n\t\t\t\treturn message.file.id === eventData.id\n\t\t\t});\n\n\t\t\tthis.fileError(this.getChatId(), message.file.id, message.id);\n\t\t});\n\n\t\treturn new Promise((resolve, reject) => resolve());\n\t}\n\n\tinitComplete()\n\t{\n\t\twindow.dispatchEvent(new CustomEvent('onBitrixLiveChat', {detail: {\n\t\t\twidget: this,\n\t\t\twidgetCode: this.code,\n\t\t\twidgetHost: this.host,\n\t\t}}));\n\n\t\tif (this.callStartFlag)\n\t\t{\n\t\t\tthis.start();\n\t\t}\n\n\t\tif (this.pageMode || this.callOpenFlag)\n\t\t{\n\t\t\tthis.open();\n\t\t}\n\n\t\treturn new Promise((resolve, reject) => resolve());\n\t}\n\n\trequestWidgetData()\n\t{\n\t\tif (!this.isReady())\n\t\t{\n\t\t\tconsole.error('LiveChatWidget.start: widget code or host is not specified');\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.widgetDataRequested = true;\n\t\tif (\n\t\t\t!this.isUserRegistered() && (\n\t\t\t\tthis.userRegisterData.hash\n\t\t\t\t|| this.getUserHashCookie()\n\t\t\t)\n\t\t)\n\t\t{\n\t\t\tthis.requestData();\n\t\t\tthis.inited = true;\n\t\t\tthis.fireInitEvent();\n\t\t}\n\t\telse if (this.isConfigDataLoaded() && this.isUserRegistered())\n\t\t{\n\t\t\tthis.requestData();\n\t\t\tthis.inited = true;\n\t\t\tthis.fireInitEvent();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.controller.restClient.callMethod(RestMethod.widgetConfigGet, {code: this.code}, (xhr) => {this.configRequestXhr = xhr}).then((result) => {\n\t\t\t\tthis.configRequestXhr = null;\n\t\t\t\tthis.clearError();\n\n\t\t\t\tthis.controller.executeRestAnswer(RestMethod.widgetConfigGet, result);\n\n\t\t\t\tif (!this.inited)\n\t\t\t\t{\n\t\t\t\t\tthis.inited = true;\n\t\t\t\t\tthis.fireInitEvent();\n\t\t\t\t}\n\t\t\t}).catch(result => {\n\t\t\t\tthis.configRequestXhr = null;\n\n\t\t\t\tthis.setError(result.error().ex.error, result.error().ex.error_description);\n\t\t\t});\n\n\t\t\tif (this.isConfigDataLoaded())\n\t\t\t{\n\t\t\t\tthis.inited = true;\n\t\t\t\tthis.fireInitEvent();\n\t\t\t}\n\t\t}\n\t}\n\n\trequestData()\n\t{\n\t\tLogger.log('requesting data from widget');\n\t\tif (this.requestDataSend)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tthis.requestDataSend = true;\n\n\t\tif (this.configRequestXhr)\n\t\t{\n\t\t\tthis.configRequestXhr.abort();\n\t\t}\n\n\t\tlet query = {\n\t\t\t[RestMethod.widgetConfigGet]: [RestMethod.widgetConfigGet, {code: this.code}]\n\t\t};\n\n\t\tif (this.isUserRegistered())\n\t\t{\n\t\t\tquery[RestMethod.widgetDialogGet] = [RestMethod.widgetDialogGet, {config_id: this.getConfigId(), trace_data: this.getCrmTraceData(), custom_data: this.getCustomData()}];\n\t\t\tquery[ImRestMethodHandler.imChatGet] = [ImRestMethod.imChatGet, {dialog_id: '$result['+RestMethod.widgetDialogGet+'][dialogId]'}];\n\t\t\tquery[ImRestMethodHandler.imDialogMessagesGetInit] = [ImRestMethod.imDialogMessagesGet, {chat_id: '$result['+RestMethod.widgetDialogGet+'][chatId]', limit: this.controller.application.getRequestMessageLimit(), convert_text: 'Y'}];\n\t\t}\n\t\telse\n\t\t{\n\t\t\tquery[RestMethod.widgetUserRegister] = [RestMethod.widgetUserRegister, {config_id: '$result['+RestMethod.widgetConfigGet+'][configId]', ...this.getUserRegisterFields()}];\n\t\t\tquery[ImRestMethodHandler.imChatGet] = [ImRestMethod.imChatGet, {dialog_id: '$result['+RestMethod.widgetUserRegister+'][dialogId]'}];\n\n\t\t\tif (this.userRegisterData.hash || this.getUserHashCookie())\n\t\t\t{\n\t\t\t\tquery[RestMethod.widgetDialogGet] = [RestMethod.widgetDialogGet, {config_id: '$result['+RestMethod.widgetConfigGet+'][configId]', trace_data: this.getCrmTraceData(), custom_data: this.getCustomData()}];\n\t\t\t\tquery[ImRestMethodHandler.imDialogMessagesGetInit] = [ImRestMethod.imDialogMessagesGet, {chat_id: '$result['+RestMethod.widgetDialogGet+'][chatId]', limit: this.controller.application.getRequestMessageLimit(), convert_text: 'Y'}];\n\t\t\t}\n\t\t\tif (this.isUserAgreeConsent())\n\t\t\t{\n\t\t\t\tquery[RestMethod.widgetUserConsentApply] = [RestMethod.widgetUserConsentApply, {config_id: '$result['+RestMethod.widgetConfigGet+'][configId]', consent_url: location.href}];\n\t\t\t}\n\t\t}\n\n\t\tquery[RestMethod.pullServerTime] = [RestMethod.pullServerTime, {}];\n\t\tquery[RestMethod.pullConfigGet] = [RestMethod.pullConfigGet, {'CACHE': 'N'}];\n\t\tquery[RestMethod.widgetUserGet] = [RestMethod.widgetUserGet, {}];\n\n\t\tthis.controller.restClient.callBatch(query, (response) =>\n\t\t{\n\t\t\tif (!response)\n\t\t\t{\n\t\t\t\tthis.requestDataSend = false;\n\t\t\t\tthis.setError('EMPTY_RESPONSE', 'Server returned an empty response.');\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tlet configGet = response[RestMethod.widgetConfigGet];\n\t\t\tif (configGet && configGet.error())\n\t\t\t{\n\t\t\t\tthis.requestDataSend = false;\n\n\t\t\t\tthis.setError(configGet.error().ex.error, configGet.error().ex.error_description);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tthis.controller.executeRestAnswer(RestMethod.widgetConfigGet, configGet);\n\n\t\t\tlet userGetResult = response[RestMethod.widgetUserGet];\n\t\t\tif (userGetResult.error())\n\t\t\t{\n\t\t\t\tthis.requestDataSend = false;\n\t\t\t\tthis.setError(userGetResult.error().ex.error, userGetResult.error().ex.error_description);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tthis.controller.executeRestAnswer(RestMethod.widgetUserGet, userGetResult);\n\n\t\t\tlet chatGetResult = response[ImRestMethodHandler.imChatGet];\n\t\t\tif (chatGetResult.error())\n\t\t\t{\n\t\t\t\tthis.requestDataSend = false;\n\t\t\t\tthis.setError(chatGetResult.error().ex.error, chatGetResult.error().ex.error_description);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tthis.controller.executeRestAnswer(ImRestMethodHandler.imChatGet, chatGetResult);\n\n\t\t\tlet dialogGetResult = response[RestMethod.widgetDialogGet];\n\t\t\tif (dialogGetResult)\n\t\t\t{\n\t\t\t\tif (dialogGetResult.error())\n\t\t\t\t{\n\t\t\t\t\tthis.requestDataSend = false;\n\t\t\t\t\tthis.setError(dialogGetResult.error().ex.error, dialogGetResult.error().ex.error_description);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tthis.controller.executeRestAnswer(RestMethod.widgetDialogGet, dialogGetResult);\n\t\t\t}\n\n\t\t\tlet dialogMessagesGetResult = response[ImRestMethodHandler.imDialogMessagesGetInit];\n\t\t\tif (dialogMessagesGetResult)\n\t\t\t{\n\t\t\t\tif (dialogMessagesGetResult.error())\n\t\t\t\t{\n\t\t\t\t\tthis.requestDataSend = false;\n\t\t\t\t\tthis.setError(dialogMessagesGetResult.error().ex.error, dialogMessagesGetResult.error().ex.error_description);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tthis.controller.getStore().dispatch('dialogues/saveDialog', {\n\t\t\t\t\tdialogId: this.controller.application.getDialogId(),\n\t\t\t\t\tchatId: this.controller.application.getChatId(),\n\t\t\t\t});\n\n\t\t\t\tthis.controller.executeRestAnswer(ImRestMethodHandler.imDialogMessagesGetInit, dialogMessagesGetResult);\n\t\t\t}\n\n\t\t\tlet userRegisterResult = response[RestMethod.widgetUserRegister];\n\t\t\tif (userRegisterResult)\n\t\t\t{\n\t\t\t\tif (userRegisterResult.error())\n\t\t\t\t{\n\t\t\t\t\tthis.requestDataSend = false;\n\t\t\t\t\tthis.setError(userRegisterResult.error().ex.error, userRegisterResult.error().ex.error_description);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tthis.controller.executeRestAnswer(RestMethod.widgetUserRegister, userRegisterResult);\n\t\t\t}\n\n\t\t\tlet timeShift = 0;\n\n\t\t\tlet serverTimeResult = response[RestMethod.pullServerTime];\n\t\t\tif (serverTimeResult && !serverTimeResult.error())\n\t\t\t{\n\t\t\t\ttimeShift = Math.floor(((new Date()).getTime() - new Date(serverTimeResult.data()).getTime())/1000);\n\t\t\t}\n\n\t\t\tlet config = null;\n\t\t\tlet pullConfigResult = response[RestMethod.pullConfigGet];\n\t\t\tif (pullConfigResult && !pullConfigResult.error())\n\t\t\t{\n\t\t\t\tconfig = pullConfigResult.data();\n\t\t\t\tconfig.server.timeShift = timeShift;\n\t\t\t}\n\n\t\t\tthis.startPullClient(config).then(() => {\n\t\t\t\tthis.processSendMessages();\n\t\t\t}).catch((error) => {\n\t\t\t\tthis.setError(error.ex.error, error.ex.error_description);\n\t\t\t});\n\n\t\t\tthis.requestDataSend = false;\n\t\t}, false, false, Utils.getLogTrackingParams({name: 'widget.init.config', dialog: this.controller.application.getDialogData()}));\n\t}\n\n\tprepareFileData(files)\n\t{\n\t\tif (!Utils.types.isArray(files))\n\t\t{\n\t\t\treturn files;\n\t\t}\n\n\t\treturn files.map(file =>\n\t\t{\n\t\t\tlet hash = (window.md5 || md5)(this.getUserId()+'|'+file.id+'|'+this.getUserHash());\n\t\t\tlet urlParam = 'livechat_auth_id='+hash+'&livechat_user_id='+this.getUserId();\n\t\t\tif (file.urlPreview)\n\t\t\t{\n\t\t\t\tfile.urlPreview = file.urlPreview+'&'+urlParam;\n\t\t\t}\n\t\t\tif (file.urlShow)\n\t\t\t{\n\t\t\t\tfile.urlShow = file.urlShow+'&'+urlParam;\n\t\t\t}\n\t\t\tif (file.urlDownload)\n\t\t\t{\n\t\t\t\tfile.urlDownload = file.urlDownload+'&'+urlParam;\n\t\t\t}\n\n\t\t\treturn file;\n\t\t});\n\t}\n\n\tcheckBrowserVersion()\n\t{\n\t\tif (Utils.platform.isIos())\n\t\t{\n\t\t\tlet version = Utils.platform.getIosVersion();\n\t\t\tif (version && version <= 10)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tisSameDomain()\n\t{\n\t\tif (typeof BX === 'undefined' || !BX.isReady)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tif (!this.options.checkSameDomain)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\treturn this.host.lastIndexOf('.'+location.hostname) > -1;\n\t}\n\n/* endregion 01. Initialize and store data */\n\n/* region 02. Push & Pull */\n\n\tstartPullClient(config)\n\t{\n\t\tlet promise = new BX.Promise();\n\n\t\tif (!this.getUserId() || !this.getSiteId() || !this.restClient)\n\t\t{\n\t\t\tpromise.reject({\n\t\t\t\tex: { error: 'WIDGET_NOT_LOADED', error_description: 'Widget is not loaded.'}\n\t\t\t});\n\t\t\treturn promise;\n\t\t}\n\n\t\tif (this.pullClientInited)\n\t\t{\n\t\t\tif (!this.pullClient.isConnected())\n\t\t\t{\n\t\t\t\tthis.pullClient.scheduleReconnect();\n\t\t\t}\n\t\t\tpromise.resolve(true);\n\t\t\treturn promise;\n\t\t}\n\n\t\tthis.controller.userId = this.getUserId();\n\t\tthis.pullClient.userId = this.getUserId();\n\t\tthis.pullClient.configTimestamp = config? config.server.config_timestamp: 0;\n\t\tthis.pullClient.skipStorageInit = false;\n\t\tthis.pullClient.storage = PullClient.StorageManager({\n\t\t\tuserId: this.getUserId(),\n\t\t\tsiteId: this.getSiteId()\n\t\t});\n\n\t\tthis.pullClient.subscribe(\n\t\t\tnew WidgetImPullCommandHandler({\n\t\t\t\tstore: this.controller.getStore(),\n\t\t\t\tcontroller: this.controller,\n\t\t\t\twidget: this,\n\t\t\t})\n\t\t);\n\t\tthis.pullClient.subscribe(\n\t\t\tnew WidgetImopenlinesPullCommandHandler({\n\t\t\t\tstore: this.controller.getStore(),\n\t\t\t\tcontroller: this.controller,\n\t\t\t\twidget: this,\n\t\t\t})\n\t\t);\n\n\t\tthis.pullClient.subscribe({\n\t\t\ttype: PullClient.SubscriptionType.Status,\n\t\t\tcallback: this.eventStatusInteraction.bind(this)\n\t\t});\n\n\t\tthis.pullConnectedFirstTime = this.pullClient.subscribe({\n\t\t\ttype: PullClient.SubscriptionType.Status,\n\t\t\tcallback: (result) => {\n\t\t\t\tif (result.status === PullClient.PullStatus.Online)\n\t\t\t\t{\n\t\t\t\t\tpromise.resolve(true);\n\t\t\t\t\tthis.pullConnectedFirstTime();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tif (this.template)\n\t\t{\n\t\t\tthis.template.$Bitrix.PullClient.set(this.pullClient);\n\t\t}\n\n\t\tthis.pullClient.start({\n\t\t\t...config,\n\t\t\tskipReconnectToLastSession: true\n\t\t}).catch(function(){\n\t\t\tpromise.reject({\n\t\t\t\tex: { error: 'PULL_CONNECTION_ERROR', error_description: 'Pull is not connected.'}\n\t\t\t});\n\t\t});\n\n\t\tthis.pullClientInited = true;\n\n\t\treturn promise;\n\t}\n\n\tstopPullClient()\n\t{\n\t\tif (this.pullClient)\n\t\t{\n\t\t\tthis.pullClient.stop(PullClient.CloseReasons.MANUAL, 'Closed manually');\n\t\t}\n\t}\n\n\trecoverPullConnection()\n\t{\n\t\t// this.pullClient.session.mid = 0; // TODO specially for disable pull history, remove after recode im\n\t\tthis.pullClient.restart(PullClient.CloseReasons.MANUAL, 'Restart after click by connection status button.');\n\t}\n\n\teventStatusInteraction(data)\n\t{\n\t\tif (data.status === PullClient.PullStatus.Online)\n\t\t{\n\t\t\tthis.offline = false;\n\n\t\t\tif (this.pullRequestMessage)\n\t\t\t{\n\t\t\t\tthis.controller.pullBaseHandler.option.skip = true;\n\n\t\t\t\tLogger.warn('Requesting getDialogUnread after going online');\n\t\t\t\tEventEmitter.emitAsync(EventType.dialog.requestUnread, {chatId: this.controller.application.getChatId()}).then(() => {\n\t\t\t\t\tEventEmitter.emit(EventType.dialog.scrollOnStart, {chatId: this.controller.application.getChatId()});\n\t\t\t\t\tthis.controller.pullBaseHandler.option.skip = false;\n\t\t\t\t\tthis.processSendMessages();\n\t\t\t\t})\n\t\t\t\t.catch(() => {\n\t\t\t\t\tthis.controller.pullBaseHandler.option.skip = false;\n\t\t\t\t});\n\n\t\t\t\tthis.pullRequestMessage = false;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.readMessage();\n\t\t\t\tthis.processSendMessages();\n\t\t\t}\n\t\t}\n\t\telse if (data.status === PullClient.PullStatus.Offline)\n\t\t{\n\t\t\tthis.pullRequestMessage = true;\n\t\t\tthis.offline = true;\n\t\t}\n\t}\n\n/* endregion 02. Push & Pull */\n\n/* region 03. Template engine */\n\n\tattachTemplate()\n\t{\n\t\tif (this.template)\n\t\t{\n\t\t\tthis.controller.getStore().commit('widget/common', {showed: true});\n\t\t\treturn true;\n\t\t}\n\n\t\tthis.rootNode.innerHTML = '';\n\t\tthis.rootNode.appendChild(document.createElement('div'));\n\n\t\tlet application = this;\n\n\t\treturn this.controller.createVue(application, {\n\t\t\tel: this.rootNode.firstChild,\n\t\t\ttemplate: '<bx-livechat/>',\n\t\t\tbeforeCreate()\n\t\t\t{\n\t\t\t\tapplication.sendEvent({\n\t\t\t\t\ttype: SubscriptionType.widgetOpen,\n\t\t\t\t\tdata: {}\n\t\t\t\t});\n\t\t\t\tapplication.template = this;\n\n\t\t\t\tif (ZIndexManager !== undefined)\n\t\t\t\t{\n\t\t\t\t\tconst stack = ZIndexManager.getOrAddStack(document.body);\n\t\t\t\t\tstack.setBaseIndex(1000000); // some big value\n\t\t\t\t\tthis.$bitrix.Data.set('zIndexStack', stack);\n\t\t\t\t}\n\t\t\t},\n\t\t\tdestroyed()\n\t\t\t{\n\t\t\t\tapplication.sendEvent({\n\t\t\t\t\ttype: SubscriptionType.widgetClose,\n\t\t\t\t\tdata: {}\n\t\t\t\t});\n\t\t\t\tapplication.template = null;\n\t\t\t\tapplication.templateAttached = false;\n\t\t\t\tapplication.rootNode.innerHTML = '';\n\t\t\t}\n\t\t}).then(() => {\n\t\t\treturn new Promise((resolve, reject) => resolve());\n\t\t});\n\t}\n\n\tdetachTemplate()\n\t{\n\t\tif (!this.template)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tthis.template.$destroy();\n\n\t\treturn true;\n\t}\n\n\tmutateTemplateComponent(id, params)\n\t{\n\t\treturn Vue.mutateComponent(id, params);\n\t}\n\n/* endregion 03. Template engine */\n\n/* region 04. Rest methods */\n\n\taddMessage(text = '', file = null)\n\t{\n\t\tif (!text && !file)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst quoteId = this.controller.getStore().getters['dialogues/getQuoteId'](this.controller.application.getDialogId());\n\t\tif (quoteId)\n\t\t{\n\t\t\tconst quoteMessage = this.controller.getStore().getters['messages/getMessage'](this.controller.application.getChatId(), quoteId);\n\t\t\tif (quoteMessage)\n\t\t\t{\n\t\t\t\tlet user = null;\n\t\t\t\tif (quoteMessage.authorId)\n\t\t\t\t{\n\t\t\t\t\tuser = this.controller.getStore().getters['users/get'](quoteMessage.authorId);\n\t\t\t\t}\n\n\t\t\t\tconst files = this.controller.getStore().getters['files/getList'](this.controller.application.getChatId());\n\n\t\t\t\tconst message = [];\n\t\t\t\tmessage.push('-'.repeat(54));\n\t\t\t\tmessage.push((user && user.name? user.name: this.getLocalize('BX_LIVECHAT_SYSTEM_MESSAGE'))+' ['+Utils.date.format(quoteMessage.date, null, this.getLocalize())+']');\n\t\t\t\tmessage.push(Utils.text.quote(quoteMessage.text, quoteMessage.params, files, this.getLocalize()));\n\t\t\t\tmessage.push('-'.repeat(54));\n\t\t\t\tmessage.push(text);\n\t\t\t\ttext = message.join(\"\\n\");\n\n\t\t\t\tthis.quoteMessageClear();\n\t\t\t}\n\t\t}\n\n\t\tLogger.warn('addMessage', text, file);\n\n\t\tif (!this.controller.application.isUnreadMessagesLoaded())\n\t\t{\n\t\t\tthis.sendMessage({id: 0, text, file});\n\t\t\tthis.processSendMessages();\n\n\t\t\treturn true;\n\t\t}\n\n\t\tlet params = {};\n\t\tif (file)\n\t\t{\n\t\t\tparams.FILE_ID = [file.id];\n\t\t}\n\n\t\tthis.controller.getStore().dispatch('messages/add', {\n\t\t\tchatId: this.getChatId(),\n\t\t\tauthorId: this.getUserId(),\n\t\t\ttext: text,\n\t\t\tparams,\n\t\t\tsending: !file,\n\t\t}).then(messageId => {\n\t\t\tif (!this.isDialogStart())\n\t\t\t{\n\t\t\t\tthis.controller.getStore().commit('widget/common', {dialogStart:true});\n\t\t\t}\n\n\t\t\tEventEmitter.emit(EventType.dialog.scrollToBottom, {chatId: this.getChatId(), cancelIfScrollChange: true});\n\n\t\t\tthis.messagesQueue.push({\n\t\t\t\tid: messageId,\n\t\t\t\ttext,\n\t\t\t\tfile,\n\t\t\t\tsending: false\n\t\t\t});\n\n\t\t\tif (this.getChatId())\n\t\t\t{\n\t\t\t\tthis.processSendMessages();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.requestData();\n\t\t\t}\n\t\t});\n\n\t\treturn true;\n\t}\n\n\tuploadFile(event)\n\t{\n\t\tif (!event)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tif (!this.getChatId())\n\t\t{\n\t\t\tthis.requestData();\n\t\t}\n\n\t\tthis.uploader.addFilesFromEvent(event);\n\t}\n\n\tcancelUploadFile(fileId)\n\t{\n\t\tlet element = this.messagesQueue.find(element => element.file && element.file.id === fileId);\n\t\tif (element)\n\t\t{\n\t\t\tthis.uploader.deleteTask(fileId);\n\n\t\t\tif (element.xhr)\n\t\t\t{\n\t\t\t\telement.xhr.abort();\n\t\t\t}\n\t\t\tthis.controller.getStore().dispatch('messages/delete', {\n\t\t\t\tchatId: this.getChatId(),\n\t\t\t\tid: element.id,\n\t\t\t}).then(() => {\n\t\t\t\tthis.controller.getStore().dispatch('files/delete', {\n\t\t\t\t\tchatId: this.getChatId(),\n\t\t\t\t\tid: element.file.id,\n\t\t\t\t});\n\t\t\t\tthis.messagesQueue = this.messagesQueue.filter(el => el.id !== element.id);\n\t\t\t});\n\t\t}\n\t}\n\n\tprocessSendMessages()\n\t{\n\t\tif (!this.getDiskFolderId())\n\t\t{\n\t\t\tthis.requestDiskFolderId().then(() => {\n\t\t\t\tthis.processSendMessages();\n\t\t\t}).catch(() => {\n\t\t\t\tLogger.warn('uploadFile', 'Error get disk folder id');\n\t\t\t\treturn false;\n\t\t\t});\n\n\t\t\treturn false;\n\t\t}\n\n\t\tif (this.offline)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.messagesQueue.filter(element => !element.sending).forEach(element => {\n\t\t\telement.sending = true;\n\t\t\tif (element.file)\n\t\t\t{\n\t\t\t\tthis.sendMessageWithFile(element);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.sendMessage(element);\n\t\t\t}\n\t\t});\n\n\t\treturn true;\n\t}\n\n\tsendMessage(message)\n\t{\n\t\tthis.controller.application.stopWriting();\n\n\t\tlet quiteId = this.controller.getStore().getters['dialogues/getQuoteId'](this.getDialogId());\n\t\tif (quiteId)\n\t\t{\n\t\t\tlet quoteMessage = this.controller.getStore().getters['messages/getMessage'](this.getChatId(), quiteId);\n\t\t\tif (quoteMessage)\n\t\t\t{\n\t\t\t\tlet user = this.controller.getStore().getters['users/get'](quoteMessage.authorId);\n\n\t\t\t\tlet newMessage = [];\n\t\t\t\tnewMessage.push(\"------------------------------------------------------\");\n\t\t\t\tnewMessage.push((user.name? user.name: this.getLocalize('BX_LIVECHAT_SYSTEM_MESSAGE')));\n\t\t\t\tnewMessage.push(quoteMessage.text);\n\t\t\t\tnewMessage.push('------------------------------------------------------');\n\t\t\t\tnewMessage.push(message.text);\n\t\t\t\tmessage.text = newMessage.join(\"\\n\");\n\n\t\t\t\tthis.quoteMessageClear();\n\t\t\t}\n\t\t}\n\n\t\tmessage.chatId = this.getChatId();\n\n\t\tthis.controller.restClient.callMethod(ImRestMethod.imMessageAdd, {\n\t\t\t'TEMPLATE_ID': message.id,\n\t\t\t'CHAT_ID': message.chatId,\n\t\t\t'MESSAGE': message.text\n\t\t}, null, null, Utils.getLogTrackingParams({\n\t\t\tname: ImRestMethod.imMessageAdd,\n\t\t\tdata: {timMessageType: 'text'},\n\t\t\tdialog: this.getDialogData()\n\t\t})).then(response => {\n\t\t\tthis.controller.executeRestAnswer(ImRestMethodHandler.imMessageAdd, response, message);\n\t\t}).catch(error => {\n\t\t\tthis.controller.executeRestAnswer(ImRestMethodHandler.imMessageAdd, error, message);\n\t\t});\n\n\t\treturn true;\n\t}\n\n\tsendMessageWithFile(message)\n\t{\n\t\tthis.controller.application.stopWriting();\n\n\t\tconst diskFolderId = this.getDiskFolderId();\n\t\tmessage.chatId = this.getChatId();\n\n\t\tthis.uploader.senderOptions.customHeaders['Livechat-Dialog-Id'] = message.chatId;\n\t\tthis.uploader.senderOptions.customHeaders['Livechat-Auth-Id'] = this.getUserHash();\n\n\t\tthis.uploader.addTask({\n\t\t\ttaskId: message.file.id,\n\t\t\tfileData: message.file.source.file,\n\t\t\tfileName: message.file.source.file.name,\n\t\t\tgenerateUniqueName: true,\n\t\t\tdiskFolderId: diskFolderId,\n\t\t\tpreviewBlob: message.file.previewBlob,\n\t\t\tchunkSize: this.localize.isCloud ? Uploader.CLOUD_MAX_CHUNK_SIZE : Uploader.BOX_MIN_CHUNK_SIZE,\n\t\t});\n\t}\n\n\tfileError(chatId, fileId, messageId = 0)\n\t{\n\t\tthis.controller.getStore().dispatch('files/update', {\n\t\t\tchatId: chatId,\n\t\t\tid: fileId,\n\t\t\tfields: {\n\t\t\t\tstatus: FileStatus.error,\n\t\t\t\tprogress: 0\n\t\t\t}\n\t\t});\n\t\tif (messageId)\n\t\t{\n\t\t\tthis.controller.getStore().dispatch('messages/actionError', {\n\t\t\t\tchatId: chatId,\n\t\t\t\tid: messageId,\n\t\t\t\tretry: false,\n\t\t\t});\n\t\t}\n\t}\n\n\trequestDiskFolderId()\n\t{\n\t\tif (this.requestDiskFolderPromise)\n\t\t{\n\t\t\treturn this.requestDiskFolderPromise;\n\t\t}\n\n\t\tthis.requestDiskFolderPromise = new Promise((resolve, reject) =>\n\t\t{\n\t\t\tif (\n\t\t\t\tthis.flagRequestDiskFolderIdSended\n\t\t\t\t|| this.getDiskFolderId()\n\t\t\t)\n\t\t\t{\n\t\t\t\tthis.flagRequestDiskFolderIdSended = false;\n\t\t\t\tresolve();\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tthis.flagRequestDiskFolderIdSended = true;\n\n\t\t\tthis.controller.restClient.callMethod(ImRestMethod.imDiskFolderGet, {chat_id: this.controller.application.getChatId()}).then(response => {\n\t\t\t\tthis.controller.executeRestAnswer(ImRestMethodHandler.imDiskFolderGet, response);\n\t\t\t\tthis.flagRequestDiskFolderIdSended = false;\n\t\t\t\tresolve();\n\t\t\t}).catch(error => {\n\t\t\t\tthis.flagRequestDiskFolderIdSended = false;\n\t\t\t\tthis.controller.executeRestAnswer(ImRestMethodHandler.imDiskFolderGet, error);\n\t\t\t\treject();\n\t\t\t});\n\t\t});\n\n\t\treturn this.requestDiskFolderPromise;\n\t}\n\n\tfileCommit(params, message)\n\t{\n\t\tthis.controller.restClient.callMethod(ImRestMethod.imDiskFileCommit, {\n\t\t\tchat_id: params.chatId,\n\t\t\tupload_id: params.uploadId,\n\t\t\tmessage: params.messageText,\n\t\t\ttemplate_id: params.messageId,\n\t\t\tfile_template_id: params.fileId,\n\t\t}, null, null, Utils.getLogTrackingParams({\n\t\t\tname: ImRestMethod.imDiskFileCommit,\n\t\t\tdata: {timMessageType: params.fileType},\n\t\t\tdialog: this.getDialogData()\n\t\t})).then(response => {\n\t\t\tthis.controller.executeRestAnswer(ImRestMethodHandler.imDiskFileCommit, response, message);\n\t\t}).catch(error => {\n\t\t\tthis.controller.executeRestAnswer(ImRestMethodHandler.imDiskFileCommit, error, message);\n\t\t});\n\n\t\treturn true;\n\t}\n\n\tgetDialogHistory(lastId, limit = this.controller.application.getRequestMessageLimit())\n\t{\n\t\tthis.controller.restClient.callMethod(ImRestMethod.imDialogMessagesGet, {\n\t\t\t'CHAT_ID': this.getChatId(),\n\t\t\t'LAST_ID': lastId,\n\t\t\t'LIMIT': limit,\n\t\t\t'CONVERT_TEXT': 'Y'\n\t\t}).then(result => {\n\t\t\tthis.controller.executeRestAnswer(ImRestMethodHandler.imDialogMessagesGet, result);\n\t\t\tthis.template.$emit(EventType.dialog.requestHistoryResult, {count: result.data().messages.length});\n\t\t}).catch(result => {\n\t\t\tthis.template.$emit(EventType.dialog.requestHistoryResult, {error: result.error().ex});\n\t\t});\n\t}\n\n\tgetDialogUnread(lastId, limit = this.controller.application.getRequestMessageLimit())\n\t{\n\t\tconst promise = new BX.Promise();\n\n\t\tif (!lastId)\n\t\t{\n\t\t\tlastId = this.controller.getStore().getters['messages/getLastId'](this.controller.application.getChatId());\n\t\t}\n\n\t\tif (!lastId)\n\t\t{\n\t\t\tthis.template.$emit(EventType.dialog.requestUnreadResult, {error: {error: 'LAST_ID_EMPTY', error_description: 'LastId is empty.'}});\n\t\t\tpromise.reject();\n\t\t\treturn promise;\n\t\t}\n\n\t\tthis.controller.application.readMessage(lastId, true, true).then(() =>\n\t\t{\n\t\t\tlet query = {\n\t\t\t\t[ImRestMethodHandler.imDialogRead]: [ImRestMethod.imDialogRead, {\n\t\t\t\t\tdialog_id: this.getDialogId(),\n\t\t\t\t\tmessage_id: lastId\n\t\t\t\t}],\n\t\t\t\t[ImRestMethodHandler.imChatGet]: [ImRestMethod.imChatGet, {\n\t\t\t\t\tdialog_id: this.getDialogId()\n\t\t\t\t}],\n\t\t\t\t[ImRestMethodHandler.imDialogMessagesGetUnread]: [ImRestMethod.imDialogMessagesGet, {\n\t\t\t\t\tchat_id: this.getChatId(),\n\t\t\t\t\tfirst_id: lastId,\n\t\t\t\t\tlimit: limit,\n\t\t\t\t\tconvert_text: 'Y'\n\t\t\t\t}]\n\t\t\t};\n\n\t\t\tthis.controller.restClient.callBatch(query, (response) =>\n\t\t\t{\n\t\t\t\tif (!response)\n\t\t\t\t{\n\t\t\t\t\tthis.template.$emit(EventType.dialog.requestUnreadResult, {error: {error: 'EMPTY_RESPONSE', error_description: 'Server returned an empty response.'}});\n\n\t\t\t\t\tpromise.reject();\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tlet chatGetResult = response[ImRestMethodHandler.imChatGet];\n\t\t\t\tif (!chatGetResult.error())\n\t\t\t\t{\n\t\t\t\t\tthis.controller.executeRestAnswer(ImRestMethodHandler.imChatGet, chatGetResult);\n\t\t\t\t}\n\n\t\t\t\tlet dialogMessageUnread = response[ImRestMethodHandler.imDialogMessagesGetUnread];\n\t\t\t\tif (dialogMessageUnread.error())\n\t\t\t\t{\n\t\t\t\t\tthis.template.$emit(EventType.dialog.requestUnreadResult, {error: dialogMessageUnread.error().ex});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.controller.executeRestAnswer(ImRestMethodHandler.imDialogMessagesGetUnread, dialogMessageUnread);\n\t\t\t\t\tthis.template.$emit(EventType.dialog.requestUnreadResult, {\n\t\t\t\t\t\tfirstMessageId: dialogMessageUnread.data().messages.length > 0? dialogMessageUnread.data().messages[0].id: 0,\n\t\t\t\t\t\tcount: dialogMessageUnread.data().messages.length\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tpromise.fulfill(response);\n\n\t\t\t}, false, false, Utils.getLogTrackingParams({name: ImRestMethodHandler.imDialogMessagesGetUnread, dialog: this.getDialogData()}));\n\t\t});\n\n\t\treturn promise;\n\t}\n\n\tretrySendMessage(message)\n\t{\n\t\tif (this.messagesQueue.find(el => el.id === message.id))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.messagesQueue.push({\n\t\t\tid: message.id,\n\t\t\ttext: message.text,\n\t\t\tsending: false\n\t\t});\n\n\t\tthis.controller.application.setSendingMessageFlag(message.id);\n\n\t\tthis.processSendMessages();\n\t}\n\n\treadMessage(messageId)\n\t{\n\t\tif (this.offline)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\treturn this.controller.application.readMessage(messageId);\n\t}\n\n\treactMessage(id, reaction)\n\t{\n\t\tthis.controller.application.reactMessage(id, reaction.type, reaction.action);\n\t}\n\n\texecMessageKeyboardCommand(data)\n\t{\n\t\tif (data.action === 'ACTION' && data.params.action === 'LIVECHAT')\n\t\t{\n\t\t\tlet {dialogId, messageId} = data.params;\n\t\t\tlet values = JSON.parse(data.params.value);\n\n\t\t\tlet sessionId = parseInt(values.SESSION_ID);\n\t\t\tif (sessionId !== this.getSessionId() || this.isSessionClose())\n\t\t\t{\n\t\t\t\talert(this.localize.BX_LIVECHAT_ACTION_EXPIRED);\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tthis.controller.restClient.callMethod(RestMethod.widgetActionSend, {\n\t\t\t\t'MESSAGE_ID': messageId,\n\t\t\t\t'DIALOG_ID': dialogId,\n\t\t\t\t'ACTION_VALUE': data.params.value,\n\t\t\t});\n\n\t\t\treturn true;\n\t\t}\n\n\t\tif (data.action !== 'COMMAND')\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tlet {dialogId, messageId, botId, command, params} = data.params;\n\n\t\tthis.controller.restClient.callMethod(ImRestMethod.imMessageCommand, {\n\t\t\t'MESSAGE_ID': messageId,\n\t\t\t'DIALOG_ID': dialogId,\n\t\t\t'BOT_ID': botId,\n\t\t\t'COMMAND': command,\n\t\t\t'COMMAND_PARAMS': params,\n\t\t});\n\n\t\treturn true;\n\t}\n\n\tquoteMessageClear()\n\t{\n\t\tthis.controller.getStore().dispatch('dialogues/update', {\n\t\t\tdialogId: this.controller.application.getDialogId(),\n\t\t\tfields: {\n\t\t\t\tquoteId: 0\n\t\t\t}\n\t\t});\n\t}\n\n\tsendDialogVote(result)\n\t{\n\t\tif (!this.getSessionId())\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.controller.restClient.callMethod(RestMethod.widgetVoteSend, {\n\t\t\t'SESSION_ID': this.getSessionId(),\n\t\t\t'ACTION': result\n\t\t}).catch((result) => {\n\t\t\tthis.controller.getStore().commit('widget/dialog', {userVote: VoteType.none});\n\t\t});\n\n\t\tthis.sendEvent({\n\t\t\ttype: SubscriptionType.userVote,\n\t\t\tdata: {\n\t\t\t\tvote: result\n\t\t\t}\n\t\t});\n\t}\n\n\tgetHtmlHistory()\n\t{\n\t\tconst chatId = this.getChatId();\n\t\tif (chatId <= 0)\n\t\t{\n\t\t\tconsole.error('Incorrect chatId value');\n\t\t}\n\n\t\tconst config = {\n\t\t\tchatId: this.getChatId()\n\t\t};\n\t\tthis.requestControllerAction('imopenlines.widget.history.download', config)\n\t\t\t.then(response => {\n\t\t\t\tconst contentType = response.headers.get('Content-Type');\n\t\t\t\tif (contentType.startsWith('application/json'))\n\t\t\t\t{\n\t\t\t\t\treturn response.json();\n\t\t\t\t}\n\n\t\t\t\treturn response.blob();\n\t\t\t})\n\t\t\t.then(result => {\n\t\t\t\tif (result instanceof Blob)\n\t\t\t\t{\n\t\t\t\t\tconst url = window.URL.createObjectURL(result);\n\t\t\t\t\tconst a = document.createElement('a');\n\t\t\t\t\ta.href = url;\n\t\t\t\t\ta.download = chatId + '.html';\n\t\t\t\t\tdocument.body.appendChild(a);\n\t\t\t\t\ta.click();\n\t\t\t\t\ta.remove();\n\t\t\t\t}\n\t\t\t\telse if (result.hasOwnProperty('errors'))\n\t\t\t\t{\n\t\t\t\t\tconsole.error(result.errors[0]);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tconsole.error('Unknown error.');\n\t\t\t\t}\n\t\t\t})\n\t\t\t.catch(() => console.error('Fetch error.'));\n\t}\n\n\t/**\n\t * Basic method to run actions.\n\t * If you need to extend it, check BX.ajax.runAction to extend this method.\n\t */\n\trequestControllerAction(action, config)\n\t{\n\t\tconst host = this.host ? this.host : '';\n\t\tconst ajaxEndpoint = '/bitrix/services/main/ajax.php';\n\n\t\tconst url = new URL(ajaxEndpoint, host);\n\t\turl.searchParams.set('action', action);\n\n\t\tconst formData = new FormData();\n\t\tfor (const key in config)\n\t\t{\n\t\t\tif (config.hasOwnProperty(key))\n\t\t\t{\n\t\t\t\tformData.append(key, config[key]);\n\t\t\t}\n\t\t}\n\n\t\treturn fetch(url, {\n\t\t\tmethod: 'POST',\n\t\t\theaders: {\n\t\t\t\t'Livechat-Auth-Id': this.getUserHash()\n\t\t\t},\n\t\t\tbody: formData\n\t\t})\n\t}\n\n\tsendConsentDecision(result)\n\t{\n\t\tresult = result === true;\n\n\t\tthis.controller.getStore().commit('widget/dialog', {userConsent: result});\n\n\t\tif (result && this.isUserRegistered())\n\t\t{\n\t\t\tthis.controller.restClient.callMethod(RestMethod.widgetUserConsentApply, {\n\t\t\t\tconfig_id: this.getConfigId(),\n\t\t\t\tconsent_url: location.href\n\t\t\t});\n\t\t}\n\t}\n\n/* endregion 05. Templates and template interaction */\n\n/* region 05. Widget interaction and utils */\n\n\tstart()\n\t{\n\t\tif (!this.controller || !this.controller.getStore())\n\t\t{\n\t\t\tthis.callStartFlag = true;\n\t\t\treturn true;\n\t\t}\n\n\t\tif (this.isSessionActive())\n\t\t{\n\t\t\tthis.requestWidgetData();\n\t\t}\n\n\t\treturn true;\n\t}\n\n\topen(params = {})\n\t{\n\t\tclearTimeout(this.openTimeout);\n\t\tif (!this.controller.getStore())\n\t\t{\n\t\t\tthis.callOpenFlag = true;\n\t\t\treturn true;\n\t\t}\n\n\t\tif (!params.openFromButton && this.buttonInstance)\n\t\t{\n\t\t\tthis.buttonInstance.wm.showById('openline_livechat');\n\t\t}\n\n\t\tif (!this.checkBrowserVersion())\n\t\t{\n\t\t\tthis.setError('OLD_BROWSER_LOCALIZED', this.localize.BX_LIVECHAT_OLD_BROWSER);\n\t\t}\n\t\telse if (Utils.versionCompare(Vue.version(), '2.1') < 0)\n\t\t{\n\t\t\talert(this.localize.BX_LIVECHAT_OLD_VUE);\n\t\t\tconsole.error(`LiveChatWidget.error: OLD_VUE_VERSION (${this.localize.BX_LIVECHAT_OLD_VUE_DEV.replace('#CURRENT_VERSION#', Vue.version())})`);\n\n\t\t\treturn false;\n\t\t}\n\t\telse if (this.isSameDomain())\n\t\t{\n\t\t\tthis.setError('LIVECHAT_SAME_DOMAIN', this.localize.BX_LIVECHAT_SAME_DOMAIN);\n\t\t}\n\t\telse if (!this.isWidgetDataRequested())\n\t\t{\n\t\t\tthis.requestWidgetData();\n\t\t}\n\n\t\tthis.attachTemplate();\n\t}\n\n\tclose()\n\t{\n\t\tif (this.pageMode)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tif (this.buttonInstance)\n\t\t{\n\t\t\tthis.buttonInstance.onWidgetClose();\n\t\t}\n\n\t\tthis.detachTemplate();\n\t}\n\n\tshowNotification(params)\n\t{\n\t\tif (!this.controller || !this.controller.getStore())\n\t\t{\n\t\t\tconsole.error('LiveChatWidget.showNotification: method can be called after fired event - onBitrixLiveChat');\n\t\t\treturn false;\n\t\t}\n\t\t// TODO show popup notification and set badge on button\n\t\t// operatorName\n\t\t// notificationText\n\t\t// counter\n\t}\n\n\tfireInitEvent()\n\t{\n\t\tif (this.initEventFired)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tthis.sendEvent({\n\t\t\ttype: SubscriptionType.configLoaded,\n\t\t\tdata: {}\n\t\t});\n\n\t\tif (this.controller.getStore().state.widget.common.reopen)\n\t\t{\n\t\t\tthis.open();\n\t\t}\n\n\t\tthis.initEventFired = true;\n\n\t\treturn true;\n\t}\n\n\tisReady()\n\t{\n\t\treturn this.ready;\n\t}\n\n\tisInited()\n\t{\n\t\treturn this.inited;\n\t}\n\n\tisUserRegistered()\n\t{\n\t\treturn !!this.getUserHash();\n\t}\n\n\tisConfigDataLoaded()\n\t{\n\t\treturn this.controller.getStore().state.widget.common.configId;\n\t}\n\n\tisWidgetDataRequested()\n\t{\n\t\treturn this.widgetDataRequested;\n\t}\n\n\tisChatLoaded()\n\t{\n\t\treturn this.controller.getStore().state.application.dialog.chatId > 0;\n\t}\n\n\tisSessionActive()\n\t{\n\t\treturn !this.controller.getStore().state.widget.dialog.sessionClose;\n\t}\n\n\tisUserAgreeConsent()\n\t{\n\t\treturn this.controller.getStore().state.widget.dialog.userConsent;\n\t}\n\n\tgetCrmTraceData()\n\t{\n\t\tlet traceData = '';\n\n\t\tif (!this.buttonInstance)\n\t\t{\n\t\t\treturn traceData;\n\t\t}\n\n\t\tif (typeof this.buttonInstance.getTrace !== 'function')\n\t\t{\n\t\t\ttraceData = this.buttonInstance.getTrace();\n\t\t}\n\t\telse if (\n\t\t\ttypeof this.buttonInstance.b24Tracker !== 'undefined'\n\t\t\t&& typeof this.buttonInstance.b24Tracker.guest !== 'undefined'\n\t\t)\n\t\t{\n\t\t\ttraceData = this.buttonInstance.b24Tracker.guest.getTrace();\n\t\t}\n\n\t\treturn traceData;\n\t}\n\n\tgetCustomData()\n\t{\n\t\tlet customData = [];\n\n\t\tif (this.customData.length > 0)\n\t\t{\n\t\t\tcustomData = this.customData;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tcustomData = [{MESSAGE: this.localize.BX_LIVECHAT_EXTRA_SITE+': [URL]'+location.href+'[/URL]'}];\n\t\t}\n\n\t\treturn JSON.stringify(customData);\n\t}\n\n\tisUserLoaded()\n\t{\n\t\treturn this.controller.getStore().state.widget.user.id > 0;\n\t}\n\n\tgetSiteId()\n\t{\n\t\treturn this.host.replace(/(http.?:\\/\\/)|([:.\\\\\\/])/mg, \"\")+this.code;\n\t}\n\n\tgetHost()\n\t{\n\t\treturn this.host;\n\t}\n\n\tgetConfigId()\n\t{\n\t\treturn this.controller.getStore().state.widget.common.configId;\n\t}\n\n\tisDialogStart()\n\t{\n\t\treturn this.controller.getStore().state.widget.common.dialogStart;\n\t}\n\n\tgetChatId()\n\t{\n\t\treturn this.controller.getStore().state.application.dialog.chatId;\n\t}\n\n\tgetDialogId()\n\t{\n\t\treturn this.controller.getStore().state.application.dialog.dialogId;\n\t}\n\n\tgetDiskFolderId()\n\t{\n\t\treturn this.controller.getStore().state.application.dialog.diskFolderId;\n\t}\n\n\tgetDialogData(dialogId = this.getDialogId())\n\t{\n\t\treturn this.controller.getStore().state.dialogues.collection[dialogId];\n\t}\n\n\tgetSessionId()\n\t{\n\t\treturn this.controller.getStore().state.widget.dialog.sessionId;\n\t}\n\n\tisSessionClose()\n\t{\n\t\treturn this.controller.getStore().state.widget.dialog.sessionClose;\n\t}\n\n\tgetUserHash()\n\t{\n\t\treturn this.controller.getStore().state.widget.user.hash;\n\t}\n\n\tgetUserHashCookie()\n\t{\n\t\tlet userHash = '';\n\n\t\tlet cookie = Cookie.get(null, 'LIVECHAT_HASH');\n\t\tif (typeof cookie === 'string' && cookie.match(/^[a-f0-9]{32}$/))\n\t\t{\n\t\t\tuserHash= cookie;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tlet cookie = Cookie.get(this.getSiteId(), 'LIVECHAT_HASH');\n\t\t\tif (typeof cookie === 'string' && cookie.match(/^[a-f0-9]{32}$/))\n\t\t\t{\n\t\t\t\tuserHash = cookie;\n\t\t\t}\n\t\t}\n\n\t\treturn userHash;\n\t}\n\n\tgetUserId()\n\t{\n\t\treturn this.controller.getStore().state.widget.user.id;\n\t}\n\n\tgetUserData()\n\t{\n\t\tif (!this.controller || !this.controller.getStore())\n\t\t{\n\t\t\tconsole.error('LiveChatWidget.getUserData: method can be called after fired event - onBitrixLiveChat');\n\t\t\treturn false;\n\t\t}\n\n\t\treturn this.controller.getStore().state.widget.user;\n\t}\n\n\tgetUserRegisterFields()\n\t{\n\t\treturn {\n\t\t\t'name': this.userRegisterData.name || '',\n\t\t\t'last_name': this.userRegisterData.lastName || '',\n\t\t\t'avatar': this.userRegisterData.avatar || '',\n\t\t\t'email': this.userRegisterData.email || '',\n\t\t\t'www': this.userRegisterData.www || '',\n\t\t\t'gender': this.userRegisterData.gender || '',\n\t\t\t'position': this.userRegisterData.position || '',\n\t\t\t'user_hash': this.userRegisterData.hash || this.getUserHashCookie() || '',\n\t\t\t'consent_url': this.controller.getStore().state.widget.common.consentUrl? location.href: '',\n\t\t\t'trace_data': this.getCrmTraceData(),\n\t\t\t'custom_data': this.getCustomData()\n\t\t}\n\t}\n\n\tgetWidgetLocationCode()\n\t{\n\t\treturn LocationStyle[this.controller.getStore().state.widget.common.location];\n\t}\n\n\tsetUserRegisterData(params)\n\t{\n\t\tif (!this.controller || !this.controller.getStore())\n\t\t{\n\t\t\tconsole.error('LiveChatWidget.getUserData: method can be called after fired event - onBitrixLiveChat');\n\t\t\treturn false;\n\t\t}\n\n\t\tconst validUserFields = ['hash', 'name', 'lastName', 'avatar', 'email', 'www', 'gender', 'position'];\n\n\t\tif (!Utils.types.isPlainObject(params))\n\t\t{\n\t\t\tconsole.error(`%cLiveChatWidget.setUserData: params is not a object`, \"color: black;\");\n\t\t\treturn false;\n\t\t}\n\n\t\tfor (let field in this.userRegisterData)\n\t\t{\n\t\t\tif (!this.userRegisterData.hasOwnProperty(field))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (!params[field])\n\t\t\t{\n\t\t\t\tdelete this.userRegisterData[field];\n\t\t\t}\n\t\t}\n\n\t\tfor (let field in params)\n\t\t{\n\t\t\tif (!params.hasOwnProperty(field))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (validUserFields.indexOf(field) === -1)\n\t\t\t{\n\t\t\t\tconsole.warn(`%cLiveChatWidget.setUserData: user field is not set, because you are trying to set an unknown field (%c${field}%c)`, \"color: black;\", \"font-weight: bold; color: red\", \"color: black\");\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tthis.userRegisterData[field] = params[field];\n\t\t}\n\n\t\tif (\n\t\t\tthis.userRegisterData.hash\n\t\t\t&& this.getUserHash()\n\t\t\t&& this.userRegisterData.hash !== this.getUserHash()\n\t\t)\n\t\t{\n\t\t\tthis.setNewAuthToken(this.userRegisterData.hash);\n\t\t}\n\t}\n\n\tsetNewAuthToken(authToken = '')\n\t{\n\t\tthis.controller.getStoreBuilder().clearModelState();\n\t\tCookie.set(null, 'LIVECHAT_HASH', '', {expires: 365*86400, path: '/'});\n\n\t\tthis.controller.restClient.setAuthId(RestAuth.guest, authToken);\n\t}\n\n\tsetOption(name, value)\n\t{\n\t\tthis.options[name] = value;\n\t\treturn true;\n\t}\n\n\tsetCustomData(params)\n\t{\n\t\tif (!this.controller || !this.controller.getStore())\n\t\t{\n\t\t\tconsole.error('LiveChatWidget.getUserData: method can be called after fired event - onBitrixLiveChat');\n\t\t\treturn false;\n\t\t}\n\n\n\t\tlet result = [];\n\t\tif (params instanceof Array)\n\t\t{\n\t\t\tparams.forEach(element =>\n\t\t\t{\n\t\t\t\tif (element && typeof element === 'object')\n\t\t\t\t{\n\t\t\t\t\tresult.push(element);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (result.length <= 0)\n\t\t\t{\n\t\t\t\tconsole.error('LiveChatWidget.setCustomData: params is empty');\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (!params)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tresult = [{'MESSAGE': params}]\n\t\t}\n\n\t\tthis.customData = this.customData.concat(result);\n\n\t\treturn true;\n\t}\n\n\tsetError(code = '', description = '')\n\t{\n\t\tconsole.error(`LiveChatWidget.error: ${code} (${description})`);\n\n\t\tlet localizeDescription = '';\n\t\tif (code === 'LIVECHAT_AUTH_FAILED')\n\t\t{\n\t\t\tlocalizeDescription = this.getLocalize('BX_LIVECHAT_AUTH_FAILED').replace('#LINK_START#', '<a href=\"javascript:void();\" onclick=\"location.reload()\">').replace('#LINK_END#', '</a>');\n\t\t\tthis.setNewAuthToken();\n\t\t}\n\t\telse if (code === 'LIVECHAT_AUTH_PORTAL_USER')\n\t\t{\n\t\t\tlocalizeDescription = this.getLocalize('BX_LIVECHAT_PORTAL_USER_NEW').replace('#LINK_START#', '<a href=\"'+this.host+'\">').replace('#LINK_END#', '</a>');\n\t\t}\n\t\telse if (code === 'LIVECHAT_SAME_DOMAIN')\n\t\t{\n\t\t\tlocalizeDescription = this.getLocalize('BX_LIVECHAT_SAME_DOMAIN');\n\t\t\tlet link = this.getLocalize('BX_LIVECHAT_SAME_DOMAIN_LINK');\n\t\t\tif (link)\n\t\t\t{\n\t\t\t\tlocalizeDescription += '<br><br><a href=\"'+link+'\">'+this.getLocalize('BX_LIVECHAT_SAME_DOMAIN_MORE')+'</a>';\n\t\t\t}\n\t\t}\n\t\telse if (code.endsWith('LOCALIZED'))\n\t\t{\n\t\t\tlocalizeDescription = description;\n\t\t}\n\n\t\tthis.controller.getStore().commit('application/set', {error: {\n\t\t\tactive: true,\n\t\t\tcode,\n\t\t\tdescription: localizeDescription\n\t\t}});\n\t}\n\n\tclearError()\n\t{\n\t\tthis.controller.getStore().commit('application/set', {error: {\n\t\t\tactive: false,\n\t\t\tcode: '',\n\t\t\tdescription: ''}\n\t\t});\n\t}\n\n\t/**\n\t *\n\t * @param params {Object}\n\t * @returns {Function|Boolean} - Unsubscribe callback function or False\n\t */\n\tsubscribe(params)\n\t{\n\t\tif (!Utils.types.isPlainObject(params))\n\t\t{\n\t\t\tconsole.error(`%cLiveChatWidget.subscribe: params is not a object`, \"color: black;\");\n\t\t\treturn false;\n\t\t}\n\n\t\tif (!SubscriptionTypeCheck.includes(params.type))\n\t\t{\n\t\t\tconsole.error(`%cLiveChatWidget.subscribe: subscription type is not correct (%c${params.type}%c)`, \"color: black;\", \"font-weight: bold; color: red\", \"color: black\");\n\t\t\treturn false;\n\t\t}\n\n\t\tif (typeof params.callback !== 'function')\n\t\t{\n\t\t\tconsole.error(`%cLiveChatWidget.subscribe: callback is not a function (%c${typeof params.callback}%c)`, \"color: black;\", \"font-weight: bold; color: red\", \"color: black\");\n\t\t\treturn false;\n\t\t}\n\n\t\tif (typeof (this.subscribers[params.type]) === 'undefined')\n\t\t{\n\t\t\tthis.subscribers[params.type] = [];\n\t\t}\n\n\t\tthis.subscribers[params.type].push(params.callback);\n\n\t\treturn function () {\n\t\t\tthis.subscribers[params.type] = this.subscribers[params.type].filter(function(element) {\n\t\t\t\treturn element !== params.callback;\n\t\t\t});\n\t\t}.bind(this);\n\t}\n\n\t/**\n\t *\n\t * @param params {Object}\n\t * @returns {boolean}\n\t */\n\tsendEvent(params)\n\t{\n\t\tparams = params || {};\n\n\t\tif (!params.type)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tif (typeof params.data !== 'object' || !params.data)\n\t\t{\n\t\t\tparams.data = {};\n\t\t}\n\n\t\tif (this.subscribers[params.type] instanceof Array && this.subscribers[params.type].length > 0)\n\t\t{\n\t\t\tthis.subscribers[params.type].forEach(callback => callback(params.data));\n\t\t}\n\n\t\tif (this.subscribers[SubscriptionType.every] instanceof Array && this.subscribers[SubscriptionType.every].length > 0)\n\t\t{\n\t\t\tthis.subscribers[SubscriptionType.every].forEach(callback => callback({type: params.type, data: params.data}));\n\t\t}\n\n\t\treturn true;\n\t}\n\n\taddLocalize(phrases)\n\t{\n\t\tif (typeof phrases !== \"object\" || !phrases)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tfor (let name in phrases)\n\t\t{\n\t\t\tif (phrases.hasOwnProperty(name))\n\t\t\t{\n\t\t\t\tthis.localize[name] = phrases[name];\n\t\t\t}\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tgetLocalize(name)\n\t{\n\t\tlet phrase = '';\n\t\tif (typeof name === 'undefined')\n\t\t{\n\t\t\treturn this.localize;\n\t\t}\n\t\telse if (typeof this.localize[name.toString()] === 'undefined')\n\t\t{\n\t\t\tconsole.warn(`LiveChatWidget.getLocalize: message with code '${name.toString()}' is undefined.`)\n\t\t}\n\t\telse\n\t\t{\n\t\t\tphrase = this.localize[name];\n\t\t}\n\n\t\treturn phrase;\n\t}\n\n/* endregion 05. Widget interaction and utils */\n}\n","/**\n * Bitrix OpenLines widget\n * Widget public interface\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {Widget} from \"./widget\"\nimport {SubscriptionType} from \"./const\";\n\nexport class WidgetPublicManager\n{\n\tconstructor(config)\n\t{\n\t\tthis.developerInfo = 'Do not use private methods.';\n\t\tthis.__privateMethods__ = new Widget(config);\n\t\tthis.__createLegacyMethods();\n\t}\n\n\topen(params)\n\t{\n\t\treturn this.__privateMethods__.open(params);\n\t}\n\n\tclose()\n\t{\n\t\treturn this.__privateMethods__.close();\n\t}\n\n\tshowNotification(params)\n\t{\n\t\treturn this.__privateMethods__.showNotification(params);\n\t}\n\n\tgetUserData()\n\t{\n\t\treturn this.__privateMethods__.getUserData();\n\t}\n\n\tsetUserRegisterData(params)\n\t{\n\t\treturn this.__privateMethods__.setUserRegisterData(params);\n\t}\n\n\tsetCustomData(params)\n\t{\n\t\treturn this.__privateMethods__.setCustomData(params);\n\t}\n\n\tmutateTemplateComponent(id, params)\n\t{\n\t\treturn this.__privateMethods__.mutateTemplateComponent(id, params);\n\t}\n\n\taddLocalize(phrases)\n\t{\n\t\treturn this.__privateMethods__.addLocalize(phrases);\n\t}\n\n\t/**\n\t *\n\t * @param params {Object}\n\t * @returns {Function|Boolean} - Unsubscribe callback function or False\n\t */\n\tsubscribe(params)\n\t{\n\t\treturn this.__privateMethods__.subscribe(params);\n\t}\n\n\tstart()\n\t{\n\t\treturn this.__privateMethods__.start();\n\t}\n\n\t__createLegacyMethods()\n\t{\n\t\tif (typeof window.BX.LiveChat === 'undefined')\n\t\t{\n\t\t\tlet sourceHref = document.createElement('a');\n\t\t\tsourceHref.href = this.__privateMethods__.host;\n\n\t\t\tlet sourceDomain = sourceHref.protocol+'//'+sourceHref.hostname+(sourceHref.port && sourceHref.port != '80' && sourceHref.port != '443'? \":\"+sourceHref.port: \"\");\n\n\t\t\twindow.BX.LiveChat = {\n\t\t\t\topenLiveChat: () => {\n\t\t\t\t\tthis.open({openFromButton: true});\n\t\t\t\t},\n\t\t\t\tcloseLiveChat: () => {\n\t\t\t\t\tthis.close();\n\t\t\t\t},\n\t\t\t\taddEventListener: (el, eventName, handler) =>\n\t\t\t\t{\n\t\t\t\t\tif (eventName === 'message')\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.subscribe({\n\t\t\t\t\t\t\ttype: SubscriptionType.userMessage,\n\t\t\t\t\t\t\tcallback: function (event)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\thandler({origin: sourceDomain, data: JSON.stringify({action: 'sendMessage'}), event});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tconsole.warn('Method BX.LiveChat.addEventListener is not supported, user new format for subscribe.')\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tsetCookie: () => {},\n\t\t\t\tgetCookie: () => {},\n\t\t\t\tsourceDomain\n\t\t\t};\n\t\t}\n\n\t\tif (typeof window.BxLiveChatInit === 'function')\n\t\t{\n\t\t\tlet config = window.BxLiveChatInit();\n\n\t\t\tif (config.user)\n\t\t\t{\n\t\t\t\tthis.__privateMethods__.setUserRegisterData(config.user);\n\t\t\t}\n\t\t\tif (config.firstMessage)\n\t\t\t{\n\t\t\t\tthis.__privateMethods__.setCustomData(config.firstMessage)\n\t\t\t}\n\t\t}\n\n\t\tif (window.BxLiveChatLoader instanceof Array)\n\t\t{\n\t\t\twindow.BxLiveChatLoader.forEach(callback => callback());\n\t\t}\n\n\t\treturn true;\n\t}\n}","/**\n * Bitrix OpenLines widget\n * LiveChat base component (Vue component)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {BitrixVue} from \"ui.vue\";\nimport {Vuex} from \"ui.vue.vuex\";\nimport {Utils} from \"im.lib.utils\";\nimport {Logger} from \"im.lib.logger\";\nimport {FormType, VoteType, LocationStyle, LocationType, LanguageType, EventType as WidgetEventType} from \"../const\";\nimport { DeviceType, DeviceOrientation, EventType, RestMethod as ImRestMethod } from \"im.const\";\nimport {\n\tDialogCore, TextareaCore, TextareaUploadFile, DialogReadMessages, DialogClickOnCommand, DialogClickOnUserName,\n\tDialogClickOnKeyboardButton, DialogClickOnMessageMenu, DialogClickOnMessageRetry, DialogSetMessageReaction,\n\tDialogClickOnUploadCancel\n} from 'im.mixin';\nimport {md5} from \"main.md5\";\nimport {EventEmitter} from \"main.core.events\";\n\n/**\n * @notice Do not mutate or clone this component! It is under development.\n */\nBitrixVue.component('bx-livechat',\n{\n\tmixins: [\n\t\tDialogCore, TextareaCore, TextareaUploadFile, DialogReadMessages, DialogClickOnCommand, DialogClickOnUserName,\n\t\tDialogClickOnKeyboardButton, DialogClickOnMessageMenu, DialogClickOnMessageRetry, DialogSetMessageReaction,\n\t\tDialogClickOnUploadCancel\n\t],\n\tdata()\n\t{\n\t\treturn {\n\t\t\tviewPortMetaSiteNode: null,\n\t\t\tviewPortMetaWidgetNode: null,\n\t\t\tstoredMessage: '',\n\t\t\tstoredFile: null,\n\t\t\twidgetMinimumHeight: 435,\n\t\t\twidgetMinimumWidth: 340,\n\t\t\twidgetBaseHeight: 557,\n\t\t\twidgetBaseWidth: 435,\n\t\t\twidgetMargin: 50,\n\t\t\twidgetAvailableHeight: 0,\n\t\t\twidgetAvailableWidth: 0,\n\t\t\twidgetCurrentHeight: 0,\n\t\t\twidgetCurrentWidth: 0,\n\t\t\twidgetDrag: false,\n\t\t\ttextareaFocused: false,\n\t\t\ttextareaDrag: false,\n\t\t\ttextareaHeight: 100,\n\t\t\ttextareaMinimumHeight: 100,\n\t\t\ttextareaMaximumHeight: Utils.device.isMobile()? 200: 300,\n\t\t\tzIndexStackInstance: null,\n\t\t\twelcomeFormFilled: false\n\t\t}\n\t},\n\tcreated()\n\t{\n\t\tLogger.warn('bx-livechat created');\n\t\tthis.onCreated();\n\n\t\tdocument.addEventListener('keydown', this.onWindowKeyDown);\n\t\tif(!Utils.device.isMobile() && !this.widget.common.pageMode)\n\t\t{\n\t\t\twindow.addEventListener('resize', this.getAvailableSpaceFunc = Utils.throttle(this.getAvailableSpace, 50));\n\t\t}\n\t\tEventEmitter.subscribe(WidgetEventType.requestShowForm, this.onRequestShowForm);\n\t},\n\tmounted()\n\t{\n\t\tif (this.widget.user.id > 0)\n\t\t{\n\t\t\tthis.welcomeFormFilled = true;\n\t\t}\n\t\tthis.zIndexStackInstance = this.$Bitrix.Data.get('zIndexStack');\n\t\tif (this.zIndexStackInstance && !!this.$refs.widgetWrapper)\n\t\t{\n\t\t\tthis.zIndexStackInstance.register(this.$refs.widgetWrapper);\n\t\t}\n\t},\n\tbeforeDestroy()\n\t{\n\t\tif (this.zIndexStackInstance)\n\t\t{\n\t\t\tthis.zIndexStackInstance.unregister(this.$refs.widgetWrapper);\n\t\t}\n\t\tdocument.removeEventListener('keydown', this.onWindowKeyDown);\n\t\tif(!Utils.device.isMobile() && !this.widget.common.pageMode)\n\t\t{\n\t\t\twindow.removeEventListener('resize', this.getAvailableSpaceFunc);\n\t\t}\n\t\tEventEmitter.unsubscribe(WidgetEventType.requestShowForm, this.onRequestShowForm);\n\n\t\tthis.onTextareaDragEventRemove();\n\t},\n\tcomputed:\n\t{\n\t\tFormType: () => FormType,\n\t\tVoteType: () => VoteType,\n\t\tDeviceType: () => DeviceType,\n\t\tEventType: () => EventType,\n\n\t\tshowTextarea()\n\t\t{\n\t\t\tconst crmFormsSettings = this.widget.common.crmFormsSettings;\n\n\t\t\t// show if we dont use welcome form\n\t\t\tif (!crmFormsSettings.useWelcomeForm || !crmFormsSettings.welcomeFormId)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t// show if we use welcome form with delay\n\t\t\t\tif (crmFormsSettings.welcomeFormDelay)\n\t\t\t\t{\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\treturn this.welcomeFormFilled;\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tshowWelcomeForm()\n\t\t{\n\t\t\t//we are using welcome form, it has delay and it was not already filled\n\t\t\treturn this.widget.common.crmFormsSettings.useWelcomeForm\n\t\t\t\t&& !this.widget.common.crmFormsSettings.welcomeFormDelay\n\t\t\t\t&& this.widget.common.crmFormsSettings.welcomeFormId\n\t\t\t\t&& !this.welcomeFormFilled\n\t\t},\n\t\ttextareaHeightStyle()\n\t\t{\n\t\t\treturn {flex: '0 0 '+this.textareaHeight+'px'};\n\t\t},\n\t\ttextareaBottomMargin()\n\t\t{\n\t\t\tif (!this.widget.common.copyright && !this.isBottomLocation)\n\t\t\t{\n\t\t\t\treturn {marginBottom: '5px'};\n\t\t\t}\n\t\t\treturn '';\n\t\t},\n\t\twidgetBaseSizes()\n\t\t{\n\t\t\treturn {\n\t\t\t\twidth: this.widgetBaseWidth,\n\t\t\t\theight: this.widgetBaseHeight,\n\t\t\t}\n\t\t},\n\t\twidgetHeightStyle()\n\t\t{\n\t\t\tif(Utils.device.isMobile() || this.widget.common.pageMode)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.widgetAvailableHeight < this.widgetBaseSizes.height || this.widgetAvailableHeight < this.widgetCurrentHeight)\n\t\t\t{\n\t\t\t\tthis.widgetCurrentHeight = Math.max(this.widgetAvailableHeight, this.widgetMinimumHeight);\n\t\t\t}\n\n\t\t\treturn this.widgetCurrentHeight+'px';\n\t\t},\n\t\twidgetWidthStyle()\n\t\t{\n\t\t\tif(Utils.device.isMobile() || this.widget.common.pageMode)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.widgetAvailableWidth < this.widgetBaseSizes.width || this.widgetAvailableWidth < this.widgetCurrentWidth)\n\t\t\t{\n\t\t\t\tthis.widgetCurrentWidth = Math.max(this.widgetAvailableWidth, this.widgetMinimumWidth);\n\t\t\t}\n\n\t\t\treturn this.widgetCurrentWidth+'px';\n\t\t},\n\t\tuserSelectStyle()\n\t\t{\n\t\t\treturn this.widgetDrag ? 'none' : 'auto';\n\t\t},\n\t\tisBottomLocation()\n\t\t{\n\t\t\treturn [LocationType.bottomLeft, LocationType.bottomMiddle, LocationType.bottomRight].includes(this.widget.common.location);\n\t\t},\n\t\tisLeftLocation()\n\t\t{\n\t\t\treturn [LocationType.bottomLeft, LocationType.topLeft, LocationType.topMiddle].includes(this.widget.common.location);\n\t\t},\n\t\tlocalize()\n\t\t{\n\t\t\treturn BitrixVue.getFilteredPhrases('BX_LIVECHAT_', this);\n\t\t},\n\t\twidgetMobileDisabled(state)\n\t\t{\n\t\t\tif (state.application.device.type === DeviceType.mobile)\n\t\t\t{\n\t\t\t\tif (navigator.userAgent.toString().includes('iPad'))\n\t\t\t\t{\n\t\t\t\t}\n\t\t\t\telse if (state.application.device.orientation === DeviceOrientation.horizontal)\n\t\t\t\t{\n\t\t\t\t\tif (navigator.userAgent.toString().includes('iPhone'))\n\t\t\t\t\t{\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\treturn !(typeof window.screen === 'object' && window.screen.availHeight >= 800);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn false;\n\t\t},\n\t\twidgetClassName(state)\n\t\t{\n\t\t\tlet className = ['bx-livechat-wrapper'];\n\n\t\t\tclassName.push('bx-livechat-show');\n\n\t\t\tif (state.widget.common.pageMode)\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-page-mode');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-position-'+LocationStyle[state.widget.common.location]);\n\t\t\t}\n\n\t\t\tif (state.application.common.languageId === LanguageType.russian)\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-logo-ru');\n\t\t\t}\n\t\t\telse if (state.application.common.languageId === LanguageType.ukraine)\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-logo-ua');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-logo-en');\n\t\t\t}\n\n\t\t\tif (!state.widget.common.online)\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-offline-state');\n\t\t\t}\n\n\t\t\tif (state.widget.common.dragged)\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-drag-n-drop');\n\t\t\t}\n\n\t\t\tif (state.widget.common.dialogStart)\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-chat-start');\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\tstate.widget.dialog.operator.name\n\t\t\t\t&& !(state.application.device.type === DeviceType.mobile && state.application.device.orientation === DeviceOrientation.horizontal)\n\t\t\t)\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-has-operator');\n\t\t\t}\n\n\t\t\tif (Utils.device.isMobile())\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-mobile');\n\t\t\t}\n\t\t\telse if (Utils.browser.isSafari())\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-browser-safari');\n\t\t\t}\n\t\t\telse if (Utils.browser.isIe())\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-browser-ie');\n\t\t\t}\n\n\t\t\tif (Utils.platform.isMac())\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-mac');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-custom-scroll');\n\t\t\t}\n\n\t\t\tif (state.widget.common.styles.backgroundColor && Utils.isDarkColor(state.widget.common.styles.iconColor))\n\t\t\t{\n\t\t\t\tclassName.push('bx-livechat-bright-header');\n\t\t\t}\n\n\t\t\treturn className.join(' ');\n\t\t},\n\t\tshowMessageDialog()\n\t\t{\n\t\t\treturn this.messageCollection.length > 0;\n\t\t},\n\t\t...Vuex.mapState({\n\t\t\twidget: state => state.widget,\n\t\t\tapplication: state => state.application,\n\t\t\tdialog: state => state.dialogues.collection[state.application.dialog.dialogId],\n\t\t\tmessageCollection: state => state.messages.collection[state.application.dialog.chatId]\n\t\t})\n\t},\n\twatch:\n\t{\n\t\tsessionClose(value)\n\t\t{\n\t\t\tLogger.log('sessionClose change', value);\n\t\t},\n\t\t//Redefined for uploadFile mixin\n\t\tdialogInited(newValue)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\t},\n\tmethods:\n\t{\n\t\tgetRestClient()\n\t\t{\n\t\t\treturn this.$Bitrix.RestClient.get();\n\t\t},\n\t\tgetApplication()\n\t\t{\n\t\t\treturn this.$Bitrix.Application.get();\n\t\t},\n\t\tonSendMessage({data: event})\n\t\t{\n\t\t\tevent.focus = event.focus !== false;s\n\n\t\t\t//hide smiles\n\t\t\tif (this.widget.common.showForm === FormType.smile)\n\t\t\t{\n\t\t\t\tthis.$store.commit('widget/common', {showForm: FormType.none});\n\t\t\t}\n\n\t\t\t//show consent window if needed\n\t\t\tif (!this.widget.dialog.userConsent && this.widget.common.consentUrl)\n\t\t\t{\n\t\t\t\tif (event.text)\n\t\t\t\t{\n\t\t\t\t\tthis.storedMessage = event.text;\n\t\t\t\t}\n\t\t\t\tthis.showConsentWidow();\n\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tevent.text = event.text? event.text: this.storedMessage;\n\t\t\tif (!event.text)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tthis.hideForm();\n\t\t\tthis.getApplication().addMessage(event.text);\n\n\t\t\tif (event.focus)\n\t\t\t{\n\t\t\t\tEventEmitter.emit(EventType.textarea.setFocus);\n\t\t\t}\n\n\t\t\treturn true;\n\t\t},\n\t\tclose(event)\n\t\t{\n\t\t\tif (this.widget.common.pageMode)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tthis.onBeforeClose();\n\t\t\tthis.$store.commit('widget/common', {showed: false});\n\t\t},\n\t\tgetAvailableSpace()\n\t\t{\n\t\t\tif (this.isBottomLocation)\n\t\t\t{\n\t\t\t\tlet bottomPosition = this.$refs.widgetWrapper.getBoundingClientRect().bottom;\n\t\t\t\tlet widgetBottomMargin = window.innerHeight - bottomPosition;\n\t\t\t\tthis.widgetAvailableHeight = window.innerHeight - this.widgetMargin - widgetBottomMargin;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tlet topPosition = this.$refs.widgetWrapper.getBoundingClientRect().top;\n\t\t\t\tthis.widgetAvailableHeight = window.innerHeight - this.widgetMargin - topPosition;\n\t\t\t}\n\n\t\t\tthis.widgetAvailableWidth = window.innerWidth - this.widgetMargin * 2;\n\t\t},\n\t\tshowLikeForm()\n\t\t{\n\t\t\tif (this.offline)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tclearTimeout(this.showFormTimeout);\n\t\t\tif (!this.widget.common.vote.enable)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tif (\n\t\t\t\tthis.widget.dialog.sessionClose\n\t\t\t\t&& this.widget.dialog.userVote !== VoteType.none\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tthis.$store.commit('widget/common', {showForm: FormType.like});\n\t\t},\n\t\tonOpenMenu(event)\n\t\t{\n\t\t\tthis.getApplication().getHtmlHistory();\n\t\t},\n\t\thideForm()\n\t\t{\n\t\t\tclearTimeout(this.showFormTimeout);\n\n\t\t\tif (this.widget.common.showForm !== FormType.none)\n\t\t\t{\n\t\t\t\tthis.$store.commit('widget/common', {showForm: FormType.none});\n\t\t\t}\n\t\t},\n\t\tshowConsentWidow()\n\t\t{\n\t\t\tthis.$store.commit('widget/common', {showConsent: true});\n\t\t},\n\t\tagreeConsentWidow()\n\t\t{\n\t\t\tthis.$store.commit('widget/common', {showConsent: false});\n\n\t\t\tthis.getApplication().sendConsentDecision(true);\n\n\t\t\tif (this.storedMessage || this.storedFile)\n\t\t\t{\n\t\t\t\tif (this.storedMessage)\n\t\t\t\t{\n\t\t\t\t\tthis.onSendMessage({data: {focus: this.application.device.type !== DeviceType.mobile}});\n\t\t\t\t\tthis.storedMessage = '';\n\t\t\t\t}\n\t\t\t\tif (this.storedFile)\n\t\t\t\t{\n\t\t\t\t\tthis.onTextareaFileSelected();\n\t\t\t\t\tthis.storedFile = '';\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (this.widget.common.showForm === FormType.none)\n\t\t\t{\n\t\t\t\tEventEmitter.emit(EventType.textarea.setFocus);\n\t\t\t}\n\t\t},\n\t\tdisagreeConsentWidow()\n\t\t{\n\t\t\tthis.$store.commit('widget/common', {showForm : FormType.none});\n\t\t\tthis.$store.commit('widget/common', {showConsent : false});\n\n\t\t\tthis.getApplication().sendConsentDecision(false);\n\n\t\t\tif (this.storedMessage)\n\t\t\t{\n\t\t\t\tEventEmitter.emit(EventType.textarea.insertText, {\n\t\t\t\t\ttext: this.storedMessage,\n\t\t\t\t\tfocus: this.application.device.type !== DeviceType.mobile\n\t\t\t\t});\n\t\t\t\tthis.storedMessage = '';\n\t\t\t}\n\t\t\tif (this.storedFile)\n\t\t\t{\n\t\t\t\tthis.storedFile = '';\n\t\t\t}\n\n\t\t\tif (this.application.device.type !== DeviceType.mobile)\n\t\t\t{\n\t\t\t\tEventEmitter.emit(EventType.textarea.setFocus);\n\t\t\t}\n\t\t},\n\t\tlogEvent(name, ...params)\n\t\t{\n\t\t\tLogger.info(name, ...params);\n\t\t},\n\t\tonCreated()\n\t\t{\n\t\t\tif(Utils.device.isMobile())\n\t\t\t{\n\t\t\t\tlet viewPortMetaSiteNode = Array.from(\n\t\t\t\t\tdocument.head.getElementsByTagName('meta')\n\t\t\t\t).filter(element => element.name === 'viewport')[0];\n\n\t\t\t\tif (viewPortMetaSiteNode)\n\t\t\t\t{\n\t\t\t\t\tthis.viewPortMetaSiteNode = viewPortMetaSiteNode;\n\t\t\t\t\tdocument.head.removeChild(this.viewPortMetaSiteNode);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tlet contentWidth = document.body.offsetWidth;\n\t\t\t\t\tif (contentWidth < window.innerWidth)\n\t\t\t\t\t{\n\t\t\t\t\t\tcontentWidth = window.innerWidth;\n\t\t\t\t\t}\n\t\t\t\t\tif (contentWidth < 1024)\n\t\t\t\t\t{\n\t\t\t\t\t\tcontentWidth = 1024;\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.viewPortMetaSiteNode = document.createElement('meta');\n\t\t\t\t\tthis.viewPortMetaSiteNode.setAttribute('name', 'viewport');\n\t\t\t\t\tthis.viewPortMetaSiteNode.setAttribute('content', `width=${contentWidth}, initial-scale=1.0, user-scalable=1`);\n\t\t\t\t}\n\n\t\t\t\tif (!this.viewPortMetaWidgetNode)\n\t\t\t\t{\n\t\t\t\t\tthis.viewPortMetaWidgetNode = document.createElement('meta');\n\t\t\t\t\tthis.viewPortMetaWidgetNode.setAttribute('name', 'viewport');\n\t\t\t\t\tthis.viewPortMetaWidgetNode.setAttribute('content', 'width=device-width, initial-scale=1.0, user-scalable=0');\n\t\t\t\t\tdocument.head.appendChild(this.viewPortMetaWidgetNode);\n\t\t\t\t}\n\n\t\t\t\tdocument.body.classList.add('bx-livechat-mobile-state');\n\n\t\t\t\tif (Utils.browser.isSafariBased())\n\t\t\t\t{\n\t\t\t\t\tdocument.body.classList.add('bx-livechat-mobile-safari-based');\n\t\t\t\t}\n\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tthis.$store.dispatch('widget/show');\n\t\t\t\t}, 50);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.$store.dispatch('widget/show').then(() => {\n\t\t\t\t\tthis.widgetCurrentHeight = this.widgetBaseSizes.height;\n\t\t\t\t\tthis.widgetCurrentWidth = this.widgetBaseSizes.width;\n\t\t\t\t\tthis.getAvailableSpace();\n\n\t\t\t\t\tthis.widgetCurrentHeight = this.widget.common.widgetHeight || this.widgetCurrentHeight;\n\t\t\t\t\tthis.widgetCurrentWidth = this.widget.common.widgetWidth || this.widgetCurrentWidth;\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis.textareaHeight = this.widget.common.textareaHeight || this.textareaHeight;\n\n\t\t\tthis.$store.commit('files/initCollection', {chatId: this.getApplication().getChatId()});\n\t\t\tthis.$store.commit('messages/initCollection', {chatId: this.getApplication().getChatId()});\n\t\t\tthis.$store.commit('dialogues/initCollection', {dialogId: this.getApplication().getDialogId(), fields: {\n\t\t\t\tentityType: 'LIVECHAT',\n\t\t\t\ttype: 'livechat'\n\t\t\t}});\n\t\t},\n\t\tonBeforeClose()\n\t\t{\n\t\t\tif(Utils.device.isMobile())\n\t\t\t{\n\t\t\t\tdocument.body.classList.remove('bx-livechat-mobile-state');\n\n\t\t\t\tif (Utils.browser.isSafariBased())\n\t\t\t\t{\n\t\t\t\t\tdocument.body.classList.remove('bx-livechat-mobile-safari-based');\n\t\t\t\t}\n\n\t\t\t\tif (this.viewPortMetaWidgetNode)\n\t\t\t\t{\n\t\t\t\t\tdocument.head.removeChild(this.viewPortMetaWidgetNode);\n\t\t\t\t\tthis.viewPortMetaWidgetNode = null;\n\t\t\t\t}\n\n\t\t\t\tif (this.viewPortMetaSiteNode)\n\t\t\t\t{\n\t\t\t\t\tdocument.head.appendChild(this.viewPortMetaSiteNode);\n\t\t\t\t\tthis.viewPortMetaSiteNode = null;\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tonAfterClose()\n\t\t{\n\t\t\tthis.getApplication().close();\n\t\t},\n\t\tonRequestShowForm({data: event})\n\t\t{\n\t\t\tclearTimeout(this.showFormTimeout);\n\t\t\tif (event.type === FormType.like)\n\t\t\t{\n\t\t\t\tif (event.delayed)\n\t\t\t\t{\n\t\t\t\t\tthis.showFormTimeout = setTimeout(() => {\n\t\t\t\t\t\tthis.showLikeForm();\n\t\t\t\t\t}, 5000);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.showLikeForm();\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tonDialogRequestHistory(event)\n\t\t{\n\t\t\tthis.getApplication().getDialogHistory(event.lastId);\n\t\t},\n\t\tonDialogRequestUnread(event)\n\t\t{\n\t\t\tthis.getApplication().getDialogUnread(event.lastId);\n\t\t},\n\t\tonClickOnUserName({data: event})\n\t\t{\n\t\t\t// TODO name push to auto-replace mention holder - User Name -> [USER=274]User Name[/USER]\n\t\t\tEventEmitter.emit(EventType.textarea.insertText, {text: event.user.name + ', '});\n\t\t},\n\t\tonClickOnUploadCancel({data: event})\n\t\t{\n\t\t\tthis.getApplication().cancelUploadFile(event.file.id);\n\t\t},\n\t\tonClickOnKeyboardButton({data: event})\n\t\t{\n\t\t\tthis.getApplication().execMessageKeyboardCommand(event);\n\t\t},\n\t\tonClickOnCommand({data: event})\n\t\t{\n\t\t\tif (event.type === 'put')\n\t\t\t{\n\t\t\t\tEventEmitter.emit(EventType.textarea.insertText, {text: event.value + ' '});\n\t\t\t}\n\t\t\telse if (event.type === 'send')\n\t\t\t{\n\t\t\t\tthis.getApplication().addMessage(event.value);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tLogger.warn('Unprocessed command', event);\n\t\t\t}\n\t\t},\n\t\tonClickOnMessageMenu({data: event})\n\t\t{\n\t\t\tLogger.warn('Message menu:', event);\n\t\t},\n\t\tonClickOnMessageRetry({data: event})\n\t\t{\n\t\t\tLogger.warn('Message retry:', event);\n\t\t\tthis.getApplication().retrySendMessage(event.message);\n\t\t},\n\t\tonReadMessage({data: event})\n\t\t{\n\t\t\tthis.getApplication().readMessage(event.id);\n\t\t},\n\t\tonSetMessageReaction({data: event})\n\t\t{\n\t\t\tthis.getApplication().reactMessage(event.message.id, event.reaction);\n\t\t},\n\t\tonClickOnDialog({data: event})\n\t\t{\n\t\t\tif (this.widget.common.showForm !== FormType.none)\n\t\t\t{\n\t\t\t\tthis.$store.commit('widget/common', {showForm: FormType.none});\n\t\t\t}\n\t\t},\n\t\tonTextareaKeyUp({data: event})\n\t\t{\n\t\t\tif (\n\t\t\t\tthis.widget.common.watchTyping\n\t\t\t\t&& this.widget.dialog.sessionId\n\t\t\t\t&& !this.widget.dialog.sessionClose\n\t\t\t\t&& this.widget.dialog.operator.id\n\t\t\t\t&& this.widget.dialog.operatorChatId\n\t\t\t\t&& this.$Bitrix.PullClient.get().isPublishingEnabled()\n\t\t\t)\n\t\t\t{\n\t\t\t\tlet infoString = md5(\n\t\t\t\t\tthis.widget.dialog.sessionId\n\t\t\t\t\t+ '/' + this.application.dialog.chatId\n\t\t\t\t\t+ '/' + this.widget.user.id\n\t\t\t\t);\n\t\t\t\tthis.$Bitrix.PullClient.get().sendMessage(\n\t\t\t\t\t[this.widget.dialog.operator.id],\n\t\t\t\t\t'imopenlines',\n\t\t\t\t\t'linesMessageWrite',\n\t\t\t\t\t{\n\t\t\t\t\t\ttext: event.text,\n\t\t\t\t\t\tinfoString,\n\t\t\t\t\t\toperatorChatId: this.widget.dialog.operatorChatId\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t},\n\t\tonTextareaFocus({data: event})\n\t\t{\n\t\t\tif (\n\t\t\t\tthis.widget.common.copyright &&\n\t\t\t\tthis.application.device.type === DeviceType.mobile\n\t\t\t)\n\t\t\t{\n\t\t\t\tthis.widget.common.copyright = false;\n\t\t\t}\n\t\t\tif (Utils.device.isMobile())\n\t\t\t{\n\t\t\t\tclearTimeout(this.onTextareaFocusScrollTimeout);\n\t\t\t\tthis.onTextareaFocusScrollTimeout = setTimeout(() => {\n\t\t\t\t\tdocument.addEventListener('scroll', this.onWindowScroll);\n\t\t\t\t}, 1000);\n\t\t\t}\n\t\t\tthis.textareaFocused = true;\n\t\t},\n\t\tonTextareaBlur({data: event})\n\t\t{\n\t\t\tif (!this.widget.common.copyright && this.widget.common.copyright !== this.getApplication().copyright)\n\t\t\t{\n\t\t\t\tthis.widget.common.copyright = this.getApplication().copyright;\n\t\t\t\tthis.$nextTick(() => {\n\t\t\t\t\tEventEmitter.emit(EventType.dialog.scrollToBottom, {chatId: this.chatId, force: true});\n\t\t\t\t});\n\t\t\t}\n\t\t\tif (Utils.device.isMobile())\n\t\t\t{\n\t\t\t\tclearTimeout(this.onTextareaFocusScrollTimeout);\n\t\t\t\tdocument.removeEventListener('scroll', this.onWindowScroll);\n\t\t\t}\n\n\t\t\tthis.textareaFocused = false;\n\t\t},\n\t\tonTextareaStartDrag(event)\n\t\t{\n\t\t\tif (this.textareaDrag)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tLogger.log('Livechat: textarea drag started');\n\n\t\t\tthis.textareaDrag = true;\n\n\t\t\tevent = event.changedTouches ? event.changedTouches[0] : event;\n\n\t\t\tthis.textareaDragCursorStartPoint = event.clientY;\n\t\t\tthis.textareaDragHeightStartPoint = this.textareaHeight;\n\n\t\t\tthis.onTextareaDragEventAdd();\n\n\t\t\tEventEmitter.emit(EventType.textarea.setBlur, true);\n\t\t},\n\t\tonTextareaContinueDrag(event)\n\t\t{\n\t\t\tif (!this.textareaDrag)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tevent = event.changedTouches ? event.changedTouches[0] : event;\n\n\t\t\tthis.textareaDragCursorControlPoint = event.clientY;\n\n\t\t\tlet textareaHeight = Math.max(\n\t\t\t\tMath.min(this.textareaDragHeightStartPoint + this.textareaDragCursorStartPoint - this.textareaDragCursorControlPoint, this.textareaMaximumHeight)\n\t\t\t, this.textareaMinimumHeight);\n\n\t\t\tLogger.log('Livechat: textarea drag', 'new: '+textareaHeight, 'curr: '+this.textareaHeight);\n\n\t\t\tif (this.textareaHeight !== textareaHeight)\n\t\t\t{\n\t\t\t\tthis.textareaHeight = textareaHeight;\n\t\t\t}\n\t\t},\n\t\tonTextareaStopDrag()\n\t\t{\n\t\t\tif (!this.textareaDrag)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tLogger.log('Livechat: textarea drag ended');\n\n\t\t\tthis.textareaDrag = false;\n\n\t\t\tthis.onTextareaDragEventRemove();\n\n\t\t\tthis.$store.commit('widget/common', {textareaHeight: this.textareaHeight});\n\t\t\tEventEmitter.emit(EventType.dialog.scrollToBottom, {chatId: this.chatId, force: true});\n\t\t},\n\t\tonTextareaDragEventAdd()\n\t\t{\n\t\t\tdocument.addEventListener('mousemove', this.onTextareaContinueDrag);\n\t\t\tdocument.addEventListener('touchmove', this.onTextareaContinueDrag);\n\t\t\tdocument.addEventListener('touchend', this.onTextareaStopDrag);\n\t\t\tdocument.addEventListener('mouseup', this.onTextareaStopDrag);\n\t\t\tdocument.addEventListener('mouseleave', this.onTextareaStopDrag);\n\t\t},\n\t\tonTextareaDragEventRemove()\n\t\t{\n\t\t\tdocument.removeEventListener('mousemove', this.onTextareaContinueDrag);\n\t\t\tdocument.removeEventListener('touchmove', this.onTextareaContinueDrag);\n\t\t\tdocument.removeEventListener('touchend', this.onTextareaStopDrag);\n\t\t\tdocument.removeEventListener('mouseup', this.onTextareaStopDrag);\n\t\t\tdocument.removeEventListener('mouseleave', this.onTextareaStopDrag);\n\t\t},\n\t\tonTextareaFileSelected({data: event} = {})\n\t\t{\n\t\t\tlet fileInputEvent = null;\n\t\t\tif (event && event.fileChangeEvent && event.fileChangeEvent.target.files.length > 0)\n\t\t\t{\n\t\t\t\tfileInputEvent = event.fileChangeEvent;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tfileInputEvent =  this.storedFile;\n\t\t\t}\n\n\t\t\tif (!fileInputEvent)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (!this.widget.dialog.userConsent && this.widget.common.consentUrl)\n\t\t\t{\n\t\t\t\tthis.storedFile = event.fileChangeEvent;\n\t\t\t\tthis.showConsentWidow();\n\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tthis.getApplication().uploadFile(fileInputEvent);\n\t\t},\n\t\tonTextareaAppButtonClick({data: event})\n\t\t{\n\t\t\tif (event.appId === FormType.smile)\n\t\t\t{\n\t\t\t\tif (this.widget.common.showForm === FormType.smile)\n\t\t\t\t{\n\t\t\t\t\tthis.$store.commit('widget/common', {showForm: FormType.none});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.$store.commit('widget/common', {showForm: FormType.smile});\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tEventEmitter.emit(EventType.textarea.setFocus);\n\t\t\t}\n\t\t},\n\t\tonTextareaEdit({data: event})\n\t\t{\n\t\t\tthis.logEvent('edit message', event);\n\t\t},\n\t\tonPullRequestConfig(event)\n\t\t{\n\t\t\tthis.getApplication().recoverPullConnection();\n\t\t},\n\t\tonSmilesSelectSmile(event)\n\t\t{\n\t\t\tEventEmitter.emit(EventType.textarea.insertText, {text: event.text});\n\t\t},\n\t\tonSmilesSelectSet()\n\t\t{\n\t\t\tEventEmitter.emit(EventType.textarea.setFocus);\n\t\t},\n\t\tonWidgetStartDrag(event)\n\t\t{\n\t\t\tif (this.widgetDrag)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.widgetDrag = true;\n\n\t\t\tevent = event.changedTouches ? event.changedTouches[0] : event;\n\n\t\t\tthis.widgetDragCursorStartPointY = event.clientY;\n\t\t\tthis.widgetDragCursorStartPointX = event.clientX;\n\t\t\tthis.widgetDragHeightStartPoint = this.widgetCurrentHeight;\n\t\t\tthis.widgetDragWidthStartPoint = this.widgetCurrentWidth;\n\n\t\t\tthis.onWidgetDragEventAdd();\n\t\t},\n\t\tonWidgetContinueDrag(event)\n\t\t{\n\t\t\tif (!this.widgetDrag)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tevent = event.changedTouches ? event.changedTouches[0] : event;\n\n\t\t\tthis.widgetDragCursorControlPointY = event.clientY;\n\t\t\tthis.widgetDragCursorControlPointX = event.clientX;\n\n\t\t\tlet widgetHeight = 0;\n\n\t\t\tif (this.isBottomLocation)\n\t\t\t{\n\t\t\t\twidgetHeight = Math.max(\n\t\t\t\t\tMath.min(this.widgetDragHeightStartPoint + this.widgetDragCursorStartPointY - this.widgetDragCursorControlPointY, this.widgetAvailableHeight),\n\t\t\t\t\tthis.widgetMinimumHeight\n\t\t\t\t);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\twidgetHeight = Math.max(\n\t\t\t\t\tMath.min(this.widgetDragHeightStartPoint - this.widgetDragCursorStartPointY + this.widgetDragCursorControlPointY, this.widgetAvailableHeight),\n\t\t\t\t\tthis.widgetMinimumHeight\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tlet widgetWidth = 0;\n\t\t\tif (this.isLeftLocation)\n\t\t\t{\n\t\t\t\twidgetWidth = Math.max(\n\t\t\t\t\tMath.min(this.widgetDragWidthStartPoint - this.widgetDragCursorStartPointX + this.widgetDragCursorControlPointX, this.widgetAvailableWidth),\n\t\t\t\t\tthis.widgetMinimumWidth\n\t\t\t\t);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\twidgetWidth = Math.max(\n\t\t\t\t\tMath.min(this.widgetDragWidthStartPoint + this.widgetDragCursorStartPointX - this.widgetDragCursorControlPointX, this.widgetAvailableWidth),\n\t\t\t\t\tthis.widgetMinimumWidth\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tif (this.widgetCurrentHeight !== widgetHeight)\n\t\t\t{\n\t\t\t\tthis.widgetCurrentHeight = widgetHeight;\n\t\t\t}\n\n\t\t\tif (this.widgetCurrentWidth !== widgetWidth)\n\t\t\t{\n\t\t\t\tthis.widgetCurrentWidth = widgetWidth;\n\t\t\t}\n\t\t},\n\t\tonWidgetStopDrag()\n\t\t{\n\t\t\tif (!this.widgetDrag)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.widgetDrag = false;\n\n\t\t\tthis.onWidgetDragEventRemove();\n\n\t\t\tthis.$store.commit('widget/common', {widgetHeight: this.widgetCurrentHeight, widgetWidth: this.widgetCurrentWidth});\n\t\t},\n\t\tonWidgetDragEventAdd()\n\t\t{\n\t\t\tdocument.addEventListener('mousemove', this.onWidgetContinueDrag);\n\t\t\tdocument.addEventListener('mouseup', this.onWidgetStopDrag);\n\t\t\tdocument.addEventListener('mouseleave', this.onWidgetStopDrag);\n\t\t},\n\t\tonWidgetDragEventRemove()\n\t\t{\n\t\t\tdocument.removeEventListener('mousemove', this.onWidgetContinueDrag);\n\t\t\tdocument.removeEventListener('mouseup', this.onWidgetStopDrag);\n\t\t\tdocument.removeEventListener('mouseleave', this.onWidgetStopDrag);\n\t\t},\n\t\tonWindowKeyDown(event)\n\t\t{\n\t\t\tif (event.keyCode === 27)\n\t\t\t{\n\t\t\t\tif (this.widget.common.showForm !== FormType.none)\n\t\t\t\t{\n\t\t\t\t\tthis.$store.commit('widget/common', {showForm: FormType.none});\n\t\t\t\t}\n\t\t\t\telse if (this.widget.common.showConsent)\n\t\t\t\t{\n\t\t\t\t\tthis.disagreeConsentWidow();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.close();\n\t\t\t\t}\n\n\t\t\t\tevent.preventDefault();\n\t\t\t\tevent.stopPropagation();\n\n\t\t\t\tEventEmitter.emit(EventType.textarea.setFocus);\n\t\t\t}\n\t\t},\n\t\tonWindowScroll(event)\n\t\t{\n\t\t\tclearTimeout(this.onWindowScrollTimeout);\n\t\t\tthis.onWindowScrollTimeout = setTimeout(() => {\n\t\t\t\tEventEmitter.emit(EventType.textarea.setBlur, true);\n\t\t\t}, 50);\n\t\t},\n\t\tonWelcomeFormSendSuccess()\n\t\t{\n\t\t\tthis.welcomeFormFilled = true;\n\t\t},\n\t\tonWelcomeFormSendError(error)\n\t\t{\n\t\t\tconsole.error('onWelcomeFormSendError', error);\n\t\t\tthis.welcomeFormFilled = true;\n\t\t}\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<transition enter-active-class=\"bx-livechat-show\" leave-active-class=\"bx-livechat-close\" @after-leave=\"onAfterClose\">\n\t\t\t<div :class=\"widgetClassName\" v-if=\"widget.common.showed\" :style=\"{height: widgetHeightStyle, width: widgetWidthStyle, userSelect: userSelectStyle}\" ref=\"widgetWrapper\">\n\t\t\t\t<div class=\"bx-livechat-box\">\n\t\t\t\t\t<div v-if=\"isBottomLocation\" class=\"bx-livechat-widget-resize-handle\" @mousedown=\"onWidgetStartDrag\"></div>\n\t\t\t\t\t<bx-livechat-head :isWidgetDisabled=\"widgetMobileDisabled\" @like=\"showLikeForm\" @openMenu=\"onOpenMenu\" @close=\"close\"/>\n\t\t\t\t\t<template v-if=\"widgetMobileDisabled\">\n\t\t\t\t\t\t<bx-livechat-body-orientation-disabled/>\n\t\t\t\t\t</template>\n\t\t\t\t\t<template v-else-if=\"application.error.active\">\n\t\t\t\t\t\t<bx-livechat-body-error/>\n\t\t\t\t\t</template>\n\t\t\t\t\t<template v-else-if=\"!widget.common.configId\">\n\t\t\t\t\t\t<div class=\"bx-livechat-body\" key=\"loading-body\">\n\t\t\t\t\t\t\t<bx-livechat-body-loading/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</template>\n\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t<div v-show=\"!widget.common.dialogStart\" class=\"bx-livechat-body\" :class=\"{'bx-livechat-body-with-scroll': showWelcomeForm}\" key=\"welcome-body\">\n\t\t\t\t\t\t\t<bx-imopenlines-form\n\t\t\t\t\t\t\t  v-show=\"showWelcomeForm\"\n\t\t\t\t\t\t\t  @formSendSuccess=\"onWelcomeFormSendSuccess\"\n\t\t\t\t\t\t\t  @formSendError=\"onWelcomeFormSendError\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<template v-if=\"!showWelcomeForm\">\n\t\t\t\t\t\t\t\t<bx-livechat-body-operators/>\n\t\t\t\t\t\t\t\t<keep-alive include=\"bx-livechat-smiles\">\n\t\t\t\t\t\t\t\t\t<template v-if=\"widget.common.showForm === FormType.smile\">\n\t\t\t\t\t\t\t\t\t\t<bx-livechat-smiles @selectSmile=\"onSmilesSelectSmile\" @selectSet=\"onSmilesSelectSet\"/>\n\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t</keep-alive>\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<template v-if=\"widget.common.dialogStart\">\n\t\t\t\t\t\t\t<bx-pull-component-status :canReconnect=\"true\" @reconnect=\"onPullRequestConfig\"/>\n\t\t\t\t\t\t\t<div :class=\"['bx-livechat-body', {'bx-livechat-body-with-message': showMessageDialog}]\" key=\"with-message\">\n\t\t\t\t\t\t\t\t<template v-if=\"showMessageDialog\">\n\t\t\t\t\t\t\t\t\t<div class=\"bx-livechat-dialog\">\n\t\t\t\t\t\t\t\t\t\t<bx-im-component-dialog\n\t\t\t\t\t\t\t\t\t\t\t:userId=\"application.common.userId\"\n\t\t\t\t\t\t\t\t\t\t\t:dialogId=\"application.dialog.dialogId\"\n\t\t\t\t\t\t\t\t\t\t\t:messageLimit=\"application.dialog.messageLimit\"\n\t\t\t\t\t\t\t\t\t\t\t:enableReactions=\"true\"\n\t\t\t\t\t\t\t\t\t\t\t:enableDateActions=\"false\"\n\t\t\t\t\t\t\t\t\t\t\t:enableCreateContent=\"false\"\n\t\t\t\t\t\t\t\t\t\t\t:enableGestureQuote=\"true\"\n\t\t\t\t\t\t\t\t\t\t\t:enableGestureMenu=\"true\"\n\t\t\t\t\t\t\t\t\t\t\t:showMessageAvatar=\"false\"\n\t\t\t\t\t\t\t\t\t\t\t:showMessageMenu=\"false\"\n\t\t\t\t\t\t\t\t\t\t\t:skipDataRequest=\"true\"\n\t\t\t\t\t\t\t\t\t\t\t:showLoadingState=\"false\"\n\t\t\t\t\t\t\t\t\t\t\t:showEmptyState=\"false\"\n\t\t\t\t\t\t\t\t\t\t />\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t\t\t\t<bx-livechat-body-loading/>\n\t\t\t\t\t\t\t\t</template>\n\n\t\t\t\t\t\t\t\t<keep-alive include=\"bx-livechat-smiles\">\n\t\t\t\t\t\t\t\t\t<template v-if=\"widget.common.showForm === FormType.like && widget.common.vote.enable\">\n\t\t\t\t\t\t\t\t\t\t<bx-livechat-form-vote/>\n\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t\t<template v-else-if=\"widget.common.showForm === FormType.welcome\">\n\t\t\t\t\t\t\t\t\t\t<bx-livechat-form-welcome/>\n\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t\t<template v-else-if=\"widget.common.showForm === FormType.offline\">\n\t\t\t\t\t\t\t\t\t\t<bx-livechat-form-offline/>\n\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t\t<template v-else-if=\"widget.common.showForm === FormType.history\">\n\t\t\t\t\t\t\t\t\t\t<bx-livechat-form-history/>\n\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t\t<template v-else-if=\"widget.common.showForm === FormType.smile\">\n\t\t\t\t\t\t\t\t\t\t<bx-livechat-smiles @selectSmile=\"onSmilesSelectSmile\" @selectSet=\"onSmilesSelectSet\"/>\n\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t</keep-alive>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t\t<div v-if=\"showTextarea\" class=\"bx-livechat-textarea\" :style=\"[textareaHeightStyle, textareaBottomMargin]\" ref=\"textarea\">\n\t\t\t\t\t\t\t<div class=\"bx-livechat-textarea-resize-handle\" @mousedown=\"onTextareaStartDrag\" @touchstart=\"onTextareaStartDrag\"></div>\n\t\t\t\t\t\t\t<bx-im-component-textarea\n\t\t\t\t\t\t\t\t:siteId=\"application.common.siteId\"\n\t\t\t\t\t\t\t\t:userId=\"application.common.userId\"\n\t\t\t\t\t\t\t\t:dialogId=\"application.dialog.dialogId\"\n\t\t\t\t\t\t\t\t:writesEventLetter=\"3\"\n\t\t\t\t\t\t\t\t:enableEdit=\"true\"\n\t\t\t\t\t\t\t\t:enableCommand=\"false\"\n\t\t\t\t\t\t\t\t:enableMention=\"false\"\n\t\t\t\t\t\t\t\t:enableFile=\"application.disk.enabled\"\n\t\t\t\t\t\t\t\t:autoFocus=\"application.device.type !== DeviceType.mobile\"\n\t\t\t\t\t\t\t\t:styles=\"{button: {backgroundColor: widget.common.styles.backgroundColor, iconColor: widget.common.styles.iconColor}}\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div v-if=\"!widget.common.copyright && !isBottomLocation\" class=\"bx-livechat-nocopyright-resize-wrap\" style=\"position: relative;\">\n\t\t\t\t\t\t\t<div class=\"bx-livechat-widget-resize-handle\" @mousedown=\"onWidgetStartDrag\"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<bx-livechat-form-consent @agree=\"agreeConsentWidow\" @disagree=\"disagreeConsentWidow\"/>\n\t\t\t\t\t\t<template v-if=\"widget.common.copyright\">\n\t\t\t\t\t\t\t<div class=\"bx-livechat-copyright\">\n\t\t\t\t\t\t\t\t<template v-if=\"widget.common.copyrightUrl\">\n\t\t\t\t\t\t\t\t\t<a class=\"bx-livechat-copyright-link\" :href=\"widget.common.copyrightUrl\" target=\"_blank\">\n\t\t\t\t\t\t\t\t\t\t<span class=\"bx-livechat-logo-name\">{{localize.BX_LIVECHAT_COPYRIGHT_TEXT}}</span>\n\t\t\t\t\t\t\t\t\t\t<span class=\"bx-livechat-logo-icon\"></span>\n\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t\t\t\t<span class=\"bx-livechat-logo-name\">{{localize.BX_LIVECHAT_COPYRIGHT_TEXT}}</span>\n\t\t\t\t\t\t\t\t\t<span class=\"bx-livechat-logo-icon\"></span>\n\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t<div v-if=\"!isBottomLocation\" class=\"bx-livechat-widget-resize-handle\" @mousedown=\"onWidgetStartDrag\"></div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</template>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</transition>\n\t`\n});\n","/**\n * Bitrix OpenLines widget\n * Body error component (Vue component)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {BitrixVue} from \"ui.vue\";\nimport {Vuex} from \"ui.vue.vuex\";\n\nBitrixVue.component('bx-livechat-body-error',\n{\n\tcomputed:\n\t{\n\t\t...Vuex.mapState({\n\t\t\tapplication: state => state.application\n\t\t}),\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-livechat-body\" key=\"error-body\">\n\t\t\t<div class=\"bx-livechat-warning-window\">\n\t\t\t\t<div class=\"bx-livechat-warning-icon\"></div>\n\t\t\t\t<template v-if=\"application.error.description\"> \n\t\t\t\t\t<div class=\"bx-livechat-help-title bx-livechat-help-title-sm bx-livechat-warning-msg\" v-html=\"application.error.description\"></div>\n\t\t\t\t</template> \n\t\t\t\t<template v-else>\n\t\t\t\t\t<div class=\"bx-livechat-help-title bx-livechat-help-title-md bx-livechat-warning-msg\">{{$Bitrix.Loc.getMessage('BX_LIVECHAT_ERROR_TITLE')}}</div>\n\t\t\t\t\t<div class=\"bx-livechat-help-title bx-livechat-help-title-sm bx-livechat-warning-msg\">{{$Bitrix.Loc.getMessage('BX_LIVECHAT_ERROR_DESC')}}</div>\n\t\t\t\t</template> \n\t\t\t</div>\n\t\t</div>\n\t`\n});\n","/**\n * Bitrix OpenLines widget\n * Head component (Vue component)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {BitrixVue} from \"ui.vue\";\nimport {Vuex} from \"ui.vue.vuex\";\nimport { SessionStatus, VoteType } from \"../const\";\nimport {EventType} from \"im.const\";\nimport { Browser } from \"main.core.minimal\";\n\nBitrixVue.component('bx-livechat-head',\n{\n\t/**\n\t * @emits 'close'\n\t * @emits 'like'\n\t * @emits 'history'\n\t */\n\tprops:\n\t{\n\t\tisWidgetDisabled: { default: false },\n\t},\n\tmethods:\n\t{\n\t\tclose(event)\n\t\t{\n\t\t\tthis.$emit('close');\n\t\t},\n\t\tlike(event)\n\t\t{\n\t\t\tthis.$emit('like');\n\t\t},\n\t\topenMenu(event)\n\t\t{\n\t\t\tthis.$emit('openMenu', event);\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tVoteType: () => VoteType,\n\n\t\tchatId()\n\t\t{\n\t\t\tif (this.application)\n\t\t\t{\n\t\t\t\treturn this.application.dialog.chatId;\n\t\t\t}\n\t\t},\n\n\t\tcustomBackgroundStyle(state)\n\t\t{\n\t\t\treturn state.widget.common.styles.backgroundColor? 'background-color: '+state.widget.common.styles.backgroundColor+'!important;': '';\n\t\t},\n\t\tcustomBackgroundOnlineStyle(state)\n\t\t{\n\t\t\treturn state.widget.common.styles.backgroundColor? 'border-color: '+state.widget.common.styles.backgroundColor+'!important;': '';\n\t\t},\n\t\tshowName(state)\n\t\t{\n\t\t\treturn state.widget.dialog.operator.firstName || state.widget.dialog.operator.lastName;\n\t\t},\n\t\tvoteActive(state)\n\t\t{\n\t\t\tif (!!state.widget.dialog.closeVote)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\t!state.widget.common.vote.beforeFinish\n\t\t\t\t&& state.widget.dialog.sessionStatus < SessionStatus.waitClient\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (!state.widget.dialog.sessionClose || state.widget.dialog.sessionClose && state.widget.dialog.userVote === VoteType.none)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tif (state.widget.dialog.sessionClose && state.widget.dialog.userVote !== VoteType.none)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\treturn false;\n\t\t},\n\t\tchatTitle(state)\n\t\t{\n\t\t\treturn state.widget.common.textMessages.bxLivechatTitle\n\t\t\t\t|| state.widget.common.configName\n\t\t\t\t|| this.localize.BX_LIVECHAT_TITLE\n\t\t},\n\t\toperatorName(state)\n\t\t{\n\t\t\tif (!this.showName)\n\t\t\t\treturn '';\n\n\t\t\treturn state.widget.dialog.operator.firstName? state.widget.dialog.operator.firstName: state.widget.dialog.operator.name\n\t\t},\n\t\toperatorDescription(state)\n\t\t{\n\t\t\tif (!this.showName)\n\t\t\t{\n\t\t\t\treturn '';\n\t\t\t}\n\n\t\t\tconst operatorPosition = state.widget.dialog.operator.workPosition? state.widget.dialog.operator.workPosition: this.localize.BX_LIVECHAT_USER;\n\n\t\t\tif (state.widget.common.showSessionId && state.widget.dialog.sessionId >= 0)\n\t\t\t{\n\t\t\t\treturn this.localize.BX_LIVECHAT_OPERATOR_POSITION_AND_SESSION_ID\n\t\t\t\t\t.replace(\"#POSITION#\", operatorPosition)\n\t\t\t\t\t.replace(\"#ID#\", state.widget.dialog.sessionId);\n\t\t\t}\n\n\t\t\treturn this.localize.BX_LIVECHAT_OPERATOR_POSITION_ONLY.replace(\"#POSITION#\", operatorPosition);\n\t\t},\n\n\t\tlocalize()\n\t\t{\n\t\t\treturn BitrixVue.getFilteredPhrases('BX_LIVECHAT_', this);\n\t\t},\n\n\t\tie11()\n\t\t{\n\t\t\treturn Browser.isIE11();\n\t\t},\n\t\t...Vuex.mapState({\n\t\t\twidget: state => state.widget,\n\t\t\tapplication: state => state.application,\n\t\t})\n\t},\n\twatch:\n\t{\n\t\tshowName(value)\n\t\t{\n\t\t\tif (value)\n\t\t\t{\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tthis.$root.$emit(EventType.dialog.scrollToBottom, {chatId: this.chatId});\n\t\t\t\t}, 300);\n\t\t\t}\n\t\t},\n\t},\n\t//language=Vue\n\ttemplate: `\n\t\t<div class=\"bx-livechat-head-wrap\">\n\t\t\t<template v-if=\"isWidgetDisabled\">\n\t\t\t\t<div class=\"bx-livechat-head\" :style=\"customBackgroundStyle\">\n\t\t\t\t\t<div class=\"bx-livechat-title\">{{chatTitle}}</div>\n\t\t\t\t\t<div class=\"bx-livechat-control-box\">\n\t\t\t\t\t\t<button v-if=\"!widget.common.pageMode\" class=\"bx-livechat-control-btn bx-livechat-control-btn-close\" :title=\"localize.BX_LIVECHAT_CLOSE_BUTTON\" @click=\"close\"></button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\t\n\t\t\t</template>\n\t\t\t<template v-else-if=\"application.error.active\">\n\t\t\t\t<div class=\"bx-livechat-head\" :style=\"customBackgroundStyle\">\n\t\t\t\t\t<div class=\"bx-livechat-title\">{{chatTitle}}</div>\n\t\t\t\t\t<div class=\"bx-livechat-control-box\">\n\t\t\t\t\t\t<button v-if=\"!widget.common.pageMode\" class=\"bx-livechat-control-btn bx-livechat-control-btn-close\" :title=\"localize.BX_LIVECHAT_CLOSE_BUTTON\" @click=\"close\"></button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t\t<template v-else-if=\"!widget.common.configId\">\n\t\t\t\t<div class=\"bx-livechat-head\" :style=\"customBackgroundStyle\">\n\t\t\t\t\t<div class=\"bx-livechat-title\">{{chatTitle}}</div>\n\t\t\t\t\t<div class=\"bx-livechat-control-box\">\n\t\t\t\t\t\t<button v-if=\"!widget.common.pageMode\" class=\"bx-livechat-control-btn bx-livechat-control-btn-close\" :title=\"localize.BX_LIVECHAT_CLOSE_BUTTON\" @click=\"close\"></button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</template>\t\t\t\n\t\t\t<template v-else>\n\t\t\t\t<div class=\"bx-livechat-head\" :style=\"customBackgroundStyle\">\n\t\t\t\t\t<template v-if=\"!showName\">\n\t\t\t\t\t\t<div class=\"bx-livechat-title\">{{chatTitle}}</div>\n\t\t\t\t\t</template>\n\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t<div class=\"bx-livechat-user bx-livechat-status-online\">\n\t\t\t\t\t\t\t<template v-if=\"widget.dialog.operator.avatar\">\n\t\t\t\t\t\t\t\t<div class=\"bx-livechat-user-icon\" :style=\"'background-image: url('+encodeURI(widget.dialog.operator.avatar)+')'\">\n\t\t\t\t\t\t\t\t\t<div v-if=\"widget.dialog.operator.online\" class=\"bx-livechat-user-status\" :style=\"customBackgroundOnlineStyle\"></div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t\t\t<div class=\"bx-livechat-user-icon\">\n\t\t\t\t\t\t\t\t\t<div v-if=\"widget.dialog.operator.online\" class=\"bx-livechat-user-status\" :style=\"customBackgroundOnlineStyle\"></div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"bx-livechat-user-info\">\n\t\t\t\t\t\t\t<div class=\"bx-livechat-user-name\">{{operatorName}}</div>\n\t\t\t\t\t\t\t<div class=\"bx-livechat-user-position\">{{operatorDescription}}</div>\t\t\t\t\t\t\t\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</template>\n\t\t\t\t\t<div class=\"bx-livechat-control-box\">\n\t\t\t\t\t\t<span class=\"bx-livechat-control-box-active\" v-if=\"widget.common.dialogStart && widget.dialog.sessionId\">\n\t\t\t\t\t\t\t<button v-if=\"widget.common.vote.enable && voteActive\" :class=\"'bx-livechat-control-btn bx-livechat-control-btn-like bx-livechat-dialog-vote-'+(widget.dialog.userVote)\" :title=\"localize.BX_LIVECHAT_VOTE_BUTTON\" @click=\"like\"></button>\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\tv-if=\"!ie11 && application.dialog.chatId > 0\"\n\t\t\t\t\t\t\t\tclass=\"bx-livechat-control-btn bx-livechat-control-btn-menu\"\n\t\t\t\t\t\t\t\t@click=\"openMenu\"\n\t\t\t\t\t\t\t\t:title=\"localize.BX_LIVECHAT_DOWNLOAD_HISTORY\"\n\t\t\t\t\t\t\t></button>\n\t\t\t\t\t\t</span>\t\n\t\t\t\t\t\t<button v-if=\"!widget.common.pageMode\" class=\"bx-livechat-control-btn bx-livechat-control-btn-close\" :title=\"localize.BX_LIVECHAT_CLOSE_BUTTON\" @click=\"close\"></button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t</div>\n\t`\n});","/**\n * Bitrix OpenLines widget\n * Body loading component (Vue component)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {BitrixVue} from \"ui.vue\";\n\nBitrixVue.component('bx-livechat-body-loading',\n{\n\ttemplate: `\n\t\t<div class=\"bx-livechat-loading-window\">\n\t\t\t<svg class=\"bx-livechat-loading-circular\" viewBox=\"25 25 50 50\">\n\t\t\t\t<circle class=\"bx-livechat-loading-path\" cx=\"50\" cy=\"50\" r=\"20\" fill=\"none\" stroke-miterlimit=\"10\"/>\n\t\t\t\t<circle class=\"bx-livechat-loading-inner-path\" cx=\"50\" cy=\"50\" r=\"20\" fill=\"none\" stroke-miterlimit=\"10\"/>\n\t\t\t</svg>\n\t\t\t<h3 class=\"bx-livechat-help-title bx-livechat-help-title-md bx-livechat-loading-msg\">{{$Bitrix.Loc.getMessage('BX_LIVECHAT_LOADING')}}</h3>\n\t\t</div>\n\t`\n});","/**\n * Bitrix OpenLines widget\n * Body operators component (Vue component)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {BitrixVue} from \"ui.vue\";\nimport {Vuex} from \"ui.vue.vuex\";\n\nBitrixVue.component('bx-livechat-body-operators',\n{\n\tcomputed:\n\t{\n\t\t...Vuex.mapState({\n\t\t\twidget: state => state.widget\n\t\t})\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-livechat-help-container\">\n\t\t\t<transition name=\"bx-livechat-animation-fade\">\n\t\t\t\t<h2 v-if=\"widget.common.online\" key=\"online\" class=\"bx-livechat-help-title bx-livechat-help-title-lg\">{{widget.common.textMessages.bxLivechatOnlineLine1}}<div class=\"bx-livechat-help-subtitle\">{{widget.common.textMessages.bxLivechatOnlineLine2}}</div></h2>\n\t\t\t\t<h2 v-else key=\"offline\" class=\"bx-livechat-help-title bx-livechat-help-title-sm\">{{widget.common.textMessages.bxLivechatOffline}}</h2>\n\t\t\t</transition>\t\n\t\t\t<div class=\"bx-livechat-help-user\">\n\t\t\t\t<template v-for=\"operator in widget.common.operators\">\n\t\t\t\t\t<div class=\"bx-livechat-user\" :key=\"operator.id\">\n\t\t\t\t\t\t<template v-if=\"operator.avatar\">\n\t\t\t\t\t\t\t<div class=\"bx-livechat-user-icon\" :style=\"'background-image: url('+encodeURI(operator.avatar)+')'\"></div>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t\t<div class=\"bx-livechat-user-icon\"></div>\n\t\t\t\t\t\t</template>\t\n\t\t\t\t\t\t<div class=\"bx-livechat-user-info\">\n\t\t\t\t\t\t\t<div class=\"bx-livechat-user-name\">{{operator.firstName? operator.firstName: operator.name}}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</template>\t\n\t\t\t</div>\n\t\t</div>\n\t`\n});","/**\n * Bitrix OpenLines widget\n * Body orientation disabled component (Vue component)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {BitrixVue} from \"ui.vue\";\n\nBitrixVue.component('bx-livechat-body-orientation-disabled',\n{\n\ttemplate: `\n\t\t<div class=\"bx-livechat-body\" key=\"orientation-head\">\n\t\t\t<div class=\"bx-livechat-mobile-orientation-box\">\n\t\t\t\t<div class=\"bx-livechat-mobile-orientation-icon\"></div>\n\t\t\t\t<div class=\"bx-livechat-mobile-orientation-text\">{{$Bitrix.Loc.getMessage('BX_LIVECHAT_MOBILE_ROTATE')}}</div>\n\t\t\t</div>\n\t\t</div>\n\t`\n});","/**\n * Bitrix OpenLines widget\n * Form consent component (Vue component)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {BitrixVue} from \"ui.vue\";\nimport {Vuex} from \"ui.vue.vuex\";\n\nBitrixVue.component('bx-livechat-form-consent',\n{\n\t/**\n\t * @emits 'agree' {event: object} -- 'event' - click event\n\t * @emits 'disagree' {event: object} -- 'event' - click event\n\t */\n\tcomputed:\n\t{\n\t\t...Vuex.mapState({\n\t\t\twidget: state => state.widget,\n\t\t})\n\t},\n\tmethods:\n\t{\n\t\tagree(event)\n\t\t{\n\t\t\tthis.$emit('agree', {event});\n\t\t},\n\t\tdisagree(event)\n\t\t{\n\t\t\tthis.$emit('disagree', {event});\n\t\t},\n\t\tonShow(element, done)\n\t\t{\n\t\t\telement.classList.add('bx-livechat-consent-window-show');\n\t\t\tdone();\n\t\t},\n\t\tonHide(element, done)\n\t\t{\n\t\t\telement.classList.remove('bx-livechat-consent-window-show');\n\t\t\telement.classList.add('bx-livechat-consent-window-close');\n\t\t\tsetTimeout(function() {\n\t\t\t\tdone();\n\t\t\t}, 400);\n\t\t},\n\t\tonKeyDown(event)\n\t\t{\n\t\t\tif (event.keyCode == 9)\n\t\t\t{\n\t\t\t\tif (event.target === this.$refs.iframe)\n\t\t\t\t{\n\t\t\t\t\tif (event.shiftKey)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$refs.cancel.focus();\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$refs.success.focus();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (event.target === this.$refs.success)\n\t\t\t\t{\n\t\t\t\t\tif (event.shiftKey)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$refs.iframe.focus();\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$refs.cancel.focus();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (event.target === this.$refs.cancel)\n\t\t\t\t{\n\t\t\t\t\tif (event.shiftKey)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$refs.success.focus();\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$refs.iframe.focus();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tevent.preventDefault();\n\t\t\t}\n\t\t\telse if (event.keyCode == 39 || event.keyCode == 37)\n\t\t\t{\n\t\t\t\tif (event.target.nextElementSibling)\n\t\t\t\t{\n\t\t\t\t\tevent.target.nextElementSibling.focus();\n\t\t\t\t}\n\t\t\t\telse if (event.target.previousElementSibling)\n\t\t\t\t{\n\t\t\t\t\tevent.target.previousElementSibling.focus();\n\t\t\t\t}\n\t\t\t\tevent.preventDefault();\n\t\t\t}\n\t\t},\n\t},\n\tdirectives:\n\t{\n\t\tfocus:\n\t\t{\n\t\t\tinserted(element, params)\n\t\t\t{\n\t\t\t\telement.focus();\n\t\t\t}\n\t\t}\n\t},\n\ttemplate: `\n\t\t<transition @enter=\"onShow\" @leave=\"onHide\">\n\t\t\t<template v-if=\"widget.common.showConsent && widget.common.consentUrl\">\n\t\t\t\t<div class=\"bx-livechat-consent-window\">\n\t\t\t\t\t<div class=\"bx-livechat-consent-window-title\">{{$Bitrix.Loc.getMessage('BX_LIVECHAT_CONSENT_TITLE')}}</div>\n\t\t\t\t\t<div class=\"bx-livechat-consent-window-content\">\n\t\t\t\t\t\t<iframe class=\"bx-livechat-consent-window-content-iframe\" ref=\"iframe\" frameborder=\"0\" marginheight=\"0\"  marginwidth=\"0\" allowtransparency=\"allow-same-origin\" seamless=\"true\" :src=\"widget.common.consentUrl\" @keydown=\"onKeyDown\"></iframe>\n\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\n\t\t\t\t\t<div class=\"bx-livechat-consent-window-btn-box\">\n\t\t\t\t\t\t<button class=\"bx-livechat-btn bx-livechat-btn-success\" ref=\"success\" @click=\"agree\" @keydown=\"onKeyDown\" v-focus>{{$Bitrix.Loc.getMessage('BX_LIVECHAT_CONSENT_AGREE')}}</button>\n\t\t\t\t\t\t<button class=\"bx-livechat-btn bx-livechat-btn-cancel\" ref=\"cancel\" @click=\"disagree\" @keydown=\"onKeyDown\">{{$Bitrix.Loc.getMessage('BX_LIVECHAT_CONSENT_DISAGREE')}}</button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t</transition>\n\t`\n});","/**\n * Bitrix OpenLines widget\n * Form vote component (Vue component)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {BitrixVue} from \"ui.vue\";\nimport {Vuex} from \"ui.vue.vuex\";\nimport {VoteType, FormType} from \"../const\";\n\nBitrixVue.component('bx-livechat-form-vote',\n{\n\tcomputed:\n\t{\n\t\tVoteType: () => VoteType,\n\n\t\t...Vuex.mapState({\n\t\t\twidget: state => state.widget,\n\t\t})\n\t},\n\tmethods: {\n\t\tuserVote(vote)\n\t\t{\n\t\t\tthis.$store.commit('widget/common', {showForm: FormType.none});\n\t\t\tthis.$store.commit('widget/dialog', {userVote: vote});\n\n\t\t\tthis.$Bitrix.Application.get().sendDialogVote(vote);\n\t\t},\n\t\thideForm(event)\n\t\t{\n\t\t\tthis.$parent.hideForm();\n\t\t},\n\t},\n\ttemplate: `\n\t\t<transition enter-active-class=\"bx-livechat-consent-window-show\" leave-active-class=\"bx-livechat-form-close\">\n\t\t\t<div class=\"bx-livechat-alert-box bx-livechat-form-rate-show\" key=\"vote\">\n\t\t\t\t<div class=\"bx-livechat-alert-close\" @click=\"hideForm\"></div>\n\t\t\t\t<div class=\"bx-livechat-alert-rate-box\">\n\t\t\t\t\t<h4 class=\"bx-livechat-alert-title bx-livechat-alert-title-mdl\">{{widget.common.vote.messageText}}</h4>\n\t\t\t\t\t<div class=\"bx-livechat-btn-box\">\n\t\t\t\t\t\t<button class=\"bx-livechat-btn bx-livechat-btn-like\" @click=\"userVote(VoteType.like)\" :title=\"widget.common.vote.messageLike\"></button>\n\t\t\t\t\t\t<button class=\"bx-livechat-btn bx-livechat-btn-dislike\" @click=\"userVote(VoteType.dislike)\" :title=\"widget.common.vote.messageDislike\"></button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</transition>\t\n\t`\n});","/**\n * Bitrix OpenLines widget\n * Smiles component (Vue component)\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\nimport {Vue} from \"ui.vue\";\n\nVue.cloneComponent('bx-livechat-smiles', 'bx-smiles',\n{\n\tmethods:\n\t{\n\t\thideForm(event)\n\t\t{\n\t\t\tthis.$parent.hideForm();\n\t\t},\n\t},\n\ttemplate: `\n\t\t<transition enter-active-class=\"bx-livechat-consent-window-show\" leave-active-class=\"bx-livechat-form-close\">\n\t\t\t<div class=\"bx-livechat-alert-box bx-livechat-alert-box-zero-padding bx-livechat-form-show\" key=\"vote\">\n\t\t\t\t<div class=\"bx-livechat-alert-close\" @click=\"hideForm\"></div>\n\t\t\t\t<div class=\"bx-livechat-alert-smiles-box\">\n\t\t\t\t\t#PARENT_TEMPLATE#\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</transition>\n\t`\n});","/**\n * Bitrix OpenLines widget\n * Widget component & controller\n *\n * @package bitrix\n * @subpackage imopenlines\n * @copyright 2001-2019 Bitrix\n */\n\n// core\nimport 'main.polyfill.customevent';\n\n// vue components\nimport 'pull.component.status';\nimport 'ui.vue.components.smiles';\nimport 'im.component.dialog';\nimport 'im.component.textarea';\nimport 'im.view.quotepanel';\nimport 'imopenlines.component.message';\nimport 'imopenlines.component.form';\n\n// widget files\nimport \"./widget.css\";\nimport {VoteType, LocationStyle, SubscriptionType} from \"./const\";\n\n// widget utils\nimport {Cookie} from \"im.lib.cookie\";\nimport {WidgetPublicManager} from \"./public\";\n\n// widget components\nimport \"./component/bx-livechat\";\nimport \"./component/bx-livechat-body-error\";\nimport \"./component/bx-livechat-body-head\";\nimport \"./component/bx-livechat-body-loading\";\nimport \"./component/bx-livechat-body-operators\";\nimport \"./component/bx-livechat-body-orientation-disabled\";\nimport \"./component/bx-livechat-form-consent\";\nimport \"./component/bx-livechat-form-vote\";\nimport \"./component/bx-livechat-smiles\";\n\n\nBX.LiveChatWidget = WidgetPublicManager;\nBX.LiveChatWidget.VoteType = VoteType;\nBX.LiveChatWidget.SubscriptionType = SubscriptionType;\nBX.LiveChatWidget.LocationStyle = LocationStyle;\nBX.LiveChatWidget.Cookie = Cookie;\n\nwindow.dispatchEvent(new CustomEvent('onBitrixLiveChatSourceLoaded', {detail: {}}));\n"],"names":["GetObjectValues","source","destination","value","hasOwnProperty","push","VoteType","Object","freeze","none","like","dislike","LanguageType","russian","ukraine","world","FormType","smile","consent","welcome","offline","history","LocationType","topLeft","topMiddle","topBottom","bottomLeft","bottomMiddle","bottomRight","LocationStyle","SubscriptionType","configLoaded","widgetOpen","widgetClose","sessionStart","sessionOperatorChange","sessionFinish","operatorMessage","userForm","userMessage","userFile","userVote","every","SubscriptionTypeCheck","RestMethod","widgetUserRegister","widgetConfigGet","widgetDialogGet","widgetUserGet","widgetUserConsentApply","widgetVoteSend","widgetActionSend","pullServerTime","pullConfigGet","RestMethodCheck","RestAuth","guest","SessionStatus","new","skip","answer","client","clientAfterOperator","operator","waitClient","close","spam","duplicate","silentlyClose","EventType","requestShowForm","WidgetModel","common","configId","configName","host","getVariable","location","protocol","pageMode","copyright","copyrightUrl","styles","backgroundColor","iconColor","vote","enable","beforeFinish","messageText","messageLike","messageDislike","textMessages","bxLivechatOnlineLine1","bxLivechatOnlineLine2","bxLivechatOffline","bxLivechatTitle","online","operators","connectors","showForm","showed","reopen","dragged","textareaHeight","widgetHeight","widgetWidth","showConsent","consentUrl","dialogStart","watchTyping","showSessionId","crmFormsSettings","useWelcomeForm","welcomeFormId","welcomeFormSec","welcomeFormDelay","welcomeFormFilled","successText","errorText","dialog","sessionId","sessionClose","sessionStatus","closeVote","userConsent","operatorChatId","id","name","firstName","lastName","workPosition","avatar","user","hash","email","phone","www","gender","position","state","payload","Utils","types","isPlainObject","device","isMobile","Array","isSaveNeeded","saveState","toString","startsWith","Cookie","set","expires","path","show","commit","setVoteDateFinish","dispatch","clearTimeout","setVoteDateTimeout","totalDelay","Date","getTime","dayTimestamp","delay","setTimeout","requestCloseVote","VuexBuilderModel","WidgetRestClient","params","queryAuthRestore","setAuthId","restClient","RestClient","endpoint","queryParams","cors","authId","customAuthId","match","livechat_auth_id","console","error","livechat_custom_auth_id","method","callback","sendCallback","logTag","getLogTrackingParams","promise","BX","Promise","callMethod","then","result","fulfill","catch","ex","warn","error_description","reject","calls","bHaltOnError","resultCallback","callBatch","WidgetRestAnswerHandler","props","widget","data","store","disk","addLocalize","serverVariables","LocalStorage","getSiteId","previousData","messages","collection","controller","application","getChatId","chatId","dialogId","fields","entityType","type","userId","diskFolderId","dateCloseVote","handleImDialogMessagesGetSuccess","length","isDialogStart","messageId","message","messagesQueue","filter","el","sendEvent","text","BaseRestHandler","WidgetImPullCommandHandler","extra","command","senderId","getUserId","onceShowed","open","WidgetImopenlinesPullCommandHandler","Widget","template","rootNode","node","document","createElement","ready","widgetDataRequested","inited","initEventFired","userRegisterData","customData","options","checkSameDomain","subscribers","configRequestXhr","initParams","initRestClient","initPullClient","initCore","initWidget","initUploader","initComplete","code","language","buttonInstance","useBitrixLocalize","placeholder","getElementById","body","firstChild","insertBefore","appendChild","localize","window","get","resolve","pullClient","PullClient","serverEnabled","siteId","skipStorageInit","configTimestamp","skipCheckRevision","getPublicListMethod","pullClientInited","widgetVariables","getHost","getLocalize","Controller","languageId","pull","rest","vuexBuilder","database","browser","isIe","databaseName","databaseType","VuexBuilder","DatabaseType","localStorage","models","create","setVariables","isUserRegistered","getUserHash","getStore","setPrepareFilesBeforeSaveFunction","prepareFileData","bind","addRestAnswerHandler","uploader","Uploader","generatePreview","sender","customHeaders","actionUploadChunk","actionCommitFile","actionRollbackUpload","subscribe","event","eventData","getData","Logger","log","status","FileStatus","upload","progress","file","fileType","authorId","extension","split","splice","size","image","previewData","width","previewDataWidth","height","previewDataHeight","authorName","getCurrentUser","urlPreview","URL","createObjectURL","fileId","addMessage","previewBlob","wait","find","getters","fileCommit","uploadId","fileError","dispatchEvent","CustomEvent","detail","widgetCode","widgetHost","callStartFlag","start","callOpenFlag","isReady","getUserHashCookie","requestData","fireInitEvent","isConfigDataLoaded","xhr","clearError","executeRestAnswer","setError","requestDataSend","abort","query","config_id","getConfigId","trace_data","getCrmTraceData","custom_data","getCustomData","ImRestMethodHandler","imChatGet","ImRestMethod","dialog_id","imDialogMessagesGetInit","imDialogMessagesGet","chat_id","limit","getRequestMessageLimit","convert_text","getUserRegisterFields","isUserAgreeConsent","consent_url","href","response","configGet","userGetResult","chatGetResult","dialogGetResult","dialogMessagesGetResult","getDialogId","userRegisterResult","timeShift","serverTimeResult","Math","floor","config","pullConfigResult","server","startPullClient","processSendMessages","getDialogData","files","isArray","map","md5","urlParam","urlShow","urlDownload","platform","isIos","version","getIosVersion","lastIndexOf","hostname","isConnected","scheduleReconnect","config_timestamp","storage","StorageManager","Status","eventStatusInteraction","pullConnectedFirstTime","PullStatus","Online","$Bitrix","skipReconnectToLastSession","stop","CloseReasons","MANUAL","restart","pullRequestMessage","pullBaseHandler","option","EventEmitter","emitAsync","requestUnread","emit","scrollOnStart","readMessage","Offline","innerHTML","createVue","beforeCreate","ZIndexManager","undefined","stack","getOrAddStack","setBaseIndex","$bitrix","Data","destroyed","templateAttached","$destroy","Vue","mutateComponent","quoteId","quoteMessage","repeat","date","format","quote","join","quoteMessageClear","isUnreadMessagesLoaded","sendMessage","FILE_ID","sending","scrollToBottom","cancelIfScrollChange","addFilesFromEvent","element","deleteTask","getDiskFolderId","requestDiskFolderId","forEach","sendMessageWithFile","stopWriting","quiteId","newMessage","imMessageAdd","timMessageType","senderOptions","addTask","taskId","fileData","fileName","generateUniqueName","chunkSize","isCloud","CLOUD_MAX_CHUNK_SIZE","BOX_MIN_CHUNK_SIZE","retry","requestDiskFolderPromise","flagRequestDiskFolderIdSended","imDiskFolderGet","imDiskFileCommit","upload_id","template_id","file_template_id","lastId","$emit","requestHistoryResult","count","requestUnreadResult","imDialogRead","message_id","imDialogMessagesGetUnread","first_id","dialogMessageUnread","firstMessageId","setSendingMessageFlag","reaction","reactMessage","action","values","JSON","parse","parseInt","SESSION_ID","getSessionId","isSessionClose","alert","BX_LIVECHAT_ACTION_EXPIRED","botId","imMessageCommand","requestControllerAction","contentType","headers","json","blob","Blob","url","a","download","click","remove","errors","ajaxEndpoint","searchParams","formData","FormData","key","append","fetch","isSessionActive","requestWidgetData","openTimeout","openFromButton","wm","showById","checkBrowserVersion","BX_LIVECHAT_OLD_BROWSER","versionCompare","BX_LIVECHAT_OLD_VUE","BX_LIVECHAT_OLD_VUE_DEV","replace","isSameDomain","BX_LIVECHAT_SAME_DOMAIN","isWidgetDataRequested","attachTemplate","onWidgetClose","detachTemplate","traceData","getTrace","b24Tracker","MESSAGE","BX_LIVECHAT_EXTRA_SITE","stringify","dialogues","userHash","cookie","validUserFields","field","indexOf","setNewAuthToken","authToken","getStoreBuilder","clearModelState","concat","description","localizeDescription","link","endsWith","active","includes","phrases","phrase","WidgetPublicManager","developerInfo","__privateMethods__","__createLegacyMethods","showNotification","getUserData","setUserRegisterData","setCustomData","mutateTemplateComponent","LiveChat","sourceHref","sourceDomain","port","openLiveChat","closeLiveChat","addEventListener","eventName","handler","origin","setCookie","getCookie","BxLiveChatInit","firstMessage","BxLiveChatLoader","BitrixVue","component","mixins","DialogCore","TextareaCore","TextareaUploadFile","DialogReadMessages","DialogClickOnCommand","DialogClickOnUserName","DialogClickOnKeyboardButton","DialogClickOnMessageMenu","DialogClickOnMessageRetry","DialogSetMessageReaction","DialogClickOnUploadCancel","viewPortMetaSiteNode","viewPortMetaWidgetNode","storedMessage","storedFile","widgetMinimumHeight","widgetMinimumWidth","widgetBaseHeight","widgetBaseWidth","widgetMargin","widgetAvailableHeight","widgetAvailableWidth","widgetCurrentHeight","widgetCurrentWidth","widgetDrag","textareaFocused","textareaDrag","textareaMinimumHeight","textareaMaximumHeight","zIndexStackInstance","created","onCreated","onWindowKeyDown","getAvailableSpaceFunc","throttle","getAvailableSpace","WidgetEventType","onRequestShowForm","mounted","$refs","widgetWrapper","register","beforeDestroy","unregister","removeEventListener","unsubscribe","onTextareaDragEventRemove","computed","DeviceType","showTextarea","showWelcomeForm","textareaHeightStyle","flex","textareaBottomMargin","isBottomLocation","marginBottom","widgetBaseSizes","widgetHeightStyle","max","widgetWidthStyle","userSelectStyle","isLeftLocation","getFilteredPhrases","widgetMobileDisabled","mobile","navigator","userAgent","orientation","DeviceOrientation","horizontal","screen","availHeight","widgetClassName","className","isSafari","isMac","isDarkColor","showMessageDialog","messageCollection","Vuex","mapState","watch","dialogInited","newValue","methods","getRestClient","getApplication","Application","onSendMessage","focus","s","$store","showConsentWidow","hideForm","textarea","setFocus","onBeforeClose","bottomPosition","getBoundingClientRect","bottom","widgetBottomMargin","innerHeight","topPosition","top","innerWidth","showLikeForm","showFormTimeout","onOpenMenu","getHtmlHistory","agreeConsentWidow","sendConsentDecision","onTextareaFileSelected","disagreeConsentWidow","insertText","logEvent","info","from","head","getElementsByTagName","removeChild","contentWidth","offsetWidth","setAttribute","classList","add","isSafariBased","onAfterClose","delayed","onDialogRequestHistory","getDialogHistory","onDialogRequestUnread","getDialogUnread","onClickOnUserName","onClickOnUploadCancel","cancelUploadFile","onClickOnKeyboardButton","execMessageKeyboardCommand","onClickOnCommand","onClickOnMessageMenu","onClickOnMessageRetry","retrySendMessage","onReadMessage","onSetMessageReaction","onClickOnDialog","onTextareaKeyUp","isPublishingEnabled","infoString","onTextareaFocus","onTextareaFocusScrollTimeout","onWindowScroll","onTextareaBlur","$nextTick","force","onTextareaStartDrag","changedTouches","textareaDragCursorStartPoint","clientY","textareaDragHeightStartPoint","onTextareaDragEventAdd","setBlur","onTextareaContinueDrag","textareaDragCursorControlPoint","min","onTextareaStopDrag","fileInputEvent","fileChangeEvent","target","uploadFile","onTextareaAppButtonClick","appId","onTextareaEdit","onPullRequestConfig","recoverPullConnection","onSmilesSelectSmile","onSmilesSelectSet","onWidgetStartDrag","widgetDragCursorStartPointY","widgetDragCursorStartPointX","clientX","widgetDragHeightStartPoint","widgetDragWidthStartPoint","onWidgetDragEventAdd","onWidgetContinueDrag","widgetDragCursorControlPointY","widgetDragCursorControlPointX","onWidgetStopDrag","onWidgetDragEventRemove","keyCode","preventDefault","stopPropagation","onWindowScrollTimeout","onWelcomeFormSendSuccess","onWelcomeFormSendError","isWidgetDisabled","default","openMenu","customBackgroundStyle","customBackgroundOnlineStyle","showName","voteActive","chatTitle","BX_LIVECHAT_TITLE","operatorName","operatorDescription","operatorPosition","BX_LIVECHAT_USER","BX_LIVECHAT_OPERATOR_POSITION_AND_SESSION_ID","BX_LIVECHAT_OPERATOR_POSITION_ONLY","ie11","Browser","isIE11","$root","agree","disagree","onShow","done","onHide","onKeyDown","iframe","shiftKey","cancel","success","nextElementSibling","previousElementSibling","directives","inserted","sendDialogVote","$parent","cloneComponent","LiveChatWidget"],"mappings":"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"}