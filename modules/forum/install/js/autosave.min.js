window.ForumFormAutosave=function(e){var o=e.formID||null;if(!o)return;var t=BX(o);if(!t)return;var n=e.controlID||"POST_MESSAGE";var r=e.iconClass||"postFormAutosave";var a=e.actionClass||"postFormAutorestore";var i=e.actionText||BX.message("AUTOSAVE_R");var s=e.recoverMessage||"";var d=null;var u=BX.create("A",{attrs:{href:"javascript:void(0)"},props:{className:r+" bx-core-autosave bx-core-autosave-ready",title:BX.message("AUTOSAVE_T")}});var c=null;var v=BX.findChild(t,{className:/forum-reply-header|reviews-reply-header|comments-reply-header/},true,true);if(typeof v=="undefined"||v===null||v.length<1)return false;var l=v[v.length-1];if(!!l)l.insertBefore(u,l.children[0]);else t.insertBefore(u,t.children[0]);var f=function(e,o){var t=e.Init.bind(e);if(window.oLHE){window.oLHE.fAutosave=e;BX.bind(window.oLHE.pEditorDocument,"keydown",t);BX.bind(window.oLHE.pTextarea,"keydown",t);BX.addCustomEvent(window.oLHE,"OnChangeView",function(){if(this.sEditorMode==="html"){BX.bind(this.pEditorDocument,"keydown",t)}})}else if(window.LHEPostForm&&window.LHEPostForm.getEditor&&window.LHEPostForm.getEditor(n)){var r=window.LHEPostForm.getEditor(n);r.fAutosave=e;BX.addCustomEvent(r,"OnContentChanged",t)}else if(o<10){setTimeout(f,500,e,o+1)}};BX.addCustomEvent(t,"onAutoSavePrepare",function(e,o){e.DISABLE_STANDARD_NOTIFY=true;BX.bind(u,"click",e.Save.bind(e));setTimeout(f,500,e,0)});BX.addCustomEvent(t,"onAutoSave",function(e,o){BX.removeClass(u,"bx-core-autosave-edited");BX.removeClass(u,"bx-core-autosave-ready");BX.addClass(u,"bx-core-autosave-saving");if(!window.oLHE)return;o[n+"_type"]=window.oLHE.sEditorMode;var t="";if(window.oLHE.sEditorMode=="code")t=window.oLHE.GetCodeEditorContent();else t=window.oLHE.GetEditorContent();o[n]=t});BX.addCustomEvent(t,"onAutoSaveFinished",function(e,o){o=parseInt(o);if(!isNaN(o)){setTimeout(function(){BX.removeClass(u,"bx-core-autosave-saving");BX.addClass(u,"bx-core-autosave-ready")},1e3);u.title=BX.message("AUTOSAVE_L").replace("#DATE#",BX.formatDate(new Date(o*1e3)))}});BX.addCustomEvent(t,"onAutoSaveInit",function(){BX.removeClass(u,"bx-core-autosave-ready");BX.addClass(u,"bx-core-autosave-edited")});BX.addCustomEvent(t,"onAutoSaveRestoreFound",function(e,o){if(BX.util.trim(o[n]).length<1)return;else if(t.children[1].className=="forum-notify-bar")return;_ob=e;d=BX.create("DIV",{props:{className:"forum-notify-bar"},children:[BX.create("DIV",{props:{className:"forum-notify-close"},children:[BX.create("A",{events:{click:function(){if(!!d)BX.remove(d);return false}}})]}),BX.create("DIV",{props:{className:"forum-notify-text"},children:[BX.create("SPAN",{text:s}),BX.create("A",{attrs:{href:"javascript:void(0)"},props:{className:a},text:i,events:{click:function(){_ob.Restore();return false}}})]})]});t.insertBefore(d,t.children[1])});BX.addCustomEvent(t,"onAutoSaveRestore",function(e,o){if(!window.oLHE||!o[n])return;window.oLHE.SetView(o[n+"_type"]);if(!!window.oLHE.sourseBut)window.oLHE.sourseBut.Check(o[n+"_type"]=="code");if(o[n+"_type"]=="code")window.oLHE.SetContent(o[n]);else window.oLHE.SetEditorContent(o[n]);f(e)});BX.addCustomEvent(t,"onAutoSaveRestoreFinished",function(e,o){if(!!d)BX.remove(d)})};BX.onCustomEvent(window,"onScriptForumAutosaveLoaded",[]);
//# sourceMappingURL=autosave.map.js