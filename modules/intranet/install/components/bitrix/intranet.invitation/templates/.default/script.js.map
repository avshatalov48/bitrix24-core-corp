{"version":3,"file":"script.js","sources":["src/submit.js","src/self-register.js","src/phone.js","src/row.js","src/selector.js","src/active-directory.js","src/analytics.js","src/form.js"],"sourcesContent":["import { Type, Validation, Loc, Dom, Event, Tag } from 'main.core';\nimport {EventEmitter} from \"main.core.events\";\nimport {Popup} from 'main.popup';\nimport { CreateButton, CancelButton } from 'ui.buttons';\n\nexport class Submit extends EventEmitter\n{\n\tconstructor(parent)\n\t{\n\t\tsuper();\n\t\tthis.waitingResponse = false;\n\t\tthis.parent = parent;\n\t\tthis.setEventNamespace(\"BX.Intranet.Invitation.Submit\");\n\t\tthis.parent.subscribe(\"onButtonClick\", (event) => {});\n\t}\n\n\tparseEmailAndPhone(form)\n\t{\n\t\tif (!Type.isDomNode(form))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet errorInputData = [];\n\t\tlet items = [];\n\t\tconst phoneExp = /^[\\d+][\\d\\(\\)\\ -]{4,22}\\d$/;\n\t\tconst rows = Array.prototype.slice.call(form.querySelectorAll(\".js-form-row\"));\n\n\t\t(rows || []).forEach((row) => {\n\t\t\tconst emailInput = row.querySelector(\"input[name='EMAIL[]']\");\n\t\t\tconst phoneInput = row.querySelector(\"input[name='PHONE[]']\");\n\t\t\tconst nameInput = row.querySelector(\"input[name='NAME[]']\");\n\t\t\tconst lastNameInput = row.querySelector(\"input[name='LAST_NAME[]']\");\n\t\t\tconst emailValue = emailInput.value.trim();\n\n\t\t\tif (this.parent.isInvitationBySmsAvailable && Type.isDomNode(phoneInput))\n\t\t\t{\n\t\t\t\tconst phoneValue = phoneInput.value.trim();\n\t\t\t\tif (phoneValue)\n\t\t\t\t{\n\t\t\t\t\tif (!phoneExp.test(String(phoneValue).toLowerCase()))\n\t\t\t\t\t{\n\t\t\t\t\t\terrorInputData.push(phoneValue);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tconst phoneCountryInput = row.querySelector(\"input[name='PHONE_COUNTRY[]']\");\n\t\t\t\t\t\titems.push({\n\t\t\t\t\t\t\t\"PHONE\": phoneValue,\n\t\t\t\t\t\t\t\"PHONE_COUNTRY\": phoneCountryInput.value.trim(),\n\t\t\t\t\t\t\t\"NAME\": nameInput.value,\n\t\t\t\t\t\t\t\"LAST_NAME\": lastNameInput.value\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (emailValue)\n\t\t\t{\n\t\t\t\tif (Validation.isEmail(emailValue))\n\t\t\t\t{\n\t\t\t\t\titems.push({\n\t\t\t\t\t\t\"EMAIL\": emailValue,\n\t\t\t\t\t\t\"NAME\": nameInput.value,\n\t\t\t\t\t\t\"LAST_NAME\": lastNameInput.value\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\terrorInputData.push(emailValue);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn [items, errorInputData];\n\t}\n\n\tgetGroupAndDepartmentData(requestData)\n\t{\n\t\tconst selector = this.parent.selector;\n\t\tconst selectorItems = selector.getItems();\n\n\t\tif (selectorItems[\"departments\"].length > 0)\n\t\t{\n\t\t\trequestData[\"UF_DEPARTMENT\"] = selectorItems[\"departments\"];\n\t\t}\n\n\t\tif (selectorItems[\"projects\"].length > 0)\n\t\t{\n\t\t\trequestData[\"SONET_GROUPS_CODE\"] = selectorItems[\"projects\"];\n\t\t}\n\t}\n\n\tsubmitInvite()\n\t{\n\t\tconst inviteForm = this.parent.contentBlocks[\"invite\"].querySelector(\"form\");\n\t\tlet [items, errorInputData] = [...this.parseEmailAndPhone(inviteForm)];\n\n\t\tif (errorInputData.length > 0)\n\t\t{\n\t\t\tconst event = new Event.BaseEvent({data: {error: Loc.getMessage(\"INTRANET_INVITE_DIALOG_EMAIL_OR_PHONE_VALIDATE_ERROR\") + \": \" + errorInputData.join(', ')}});\n\t\t\tthis.emit(\"onInputError\", event);\n\t\t\treturn;\n\t\t}\n\n\t\tif (items.length <= 0)\n\t\t{\n\t\t\tconst event = new Event.BaseEvent({data: {error: Loc.getMessage(\"INTRANET_INVITE_DIALOG_EMAIL_OR_PHONE_EMPTY_ERROR\")}});\n\t\t\tthis.emit(\"onInputError\", event);\n\t\t\treturn;\n\t\t}\n\n\t\tconst requestData = {\n\t\t\t\"ITEMS\": items\n\t\t};\n\n\t\tconst analyticsLabel = {\n\t\t\t\"INVITATION_TYPE\": \"invite\",\n\t\t\t\"INVITATION_COUNT\": items.length\n\t\t};\n\n\t\tthis.sendAction(\"invite\", requestData, analyticsLabel);\n\t}\n\n\tsubmitInviteWithGroupDp()\n\t{\n\t\tconst inviteWithGroupDpForm = this.parent.contentBlocks[\"invite-with-group-dp\"].querySelector(\"form\");\n\t\tlet [items, errorInputData] = [...this.parseEmailAndPhone(inviteWithGroupDpForm)];\n\n\t\tif (errorInputData.length > 0)\n\t\t{\n\t\t\tthis.parent.showErrorMessage(Loc.getMessage(\"INTRANET_INVITE_DIALOG_EMAIL_OR_PHONE_VALIDATE_ERROR\") + \": \" + errorInputData.join(', '));\n\t\t\treturn;\n\t\t}\n\n\t\tif (items.length <= 0)\n\t\t{\n\t\t\tconst event = new Event.BaseEvent({data: {\n\t\t\t\terror: Loc.getMessage(\"INTRANET_INVITE_DIALOG_EMAIL_OR_PHONE_EMPTY_ERROR\")}\n\t\t\t});\n\t\t\tthis.emit(\"onInputError\", event);\n\t\t\treturn;\n\t\t}\n\n\t\tlet requestData = {\n\t\t\t\"ITEMS\": items\n\t\t};\n\t\tthis.getGroupAndDepartmentData(requestData);\n\n\t\tconst analyticsLabel = {\n\t\t\t\"INVITATION_TYPE\": \"withGroupOrDepartment\",\n\t\t\t\"INVITATION_COUNT\": items.length\n\t\t};\n\n\t\tthis.sendAction(\"inviteWithGroupDp\", requestData, analyticsLabel);\n\t}\n\n\tsubmitSelf()\n\t{\n\t\tconst selfForm = this.parent.contentBlocks[\"self\"].querySelector(\"form\");\n\t\tlet obRequestData = {\n\t\t\t\"allow_register\": selfForm[\"allow_register\"].value,\n\t\t\t\"allow_register_confirm\": selfForm[\"allow_register_confirm\"].checked ? \"Y\" : \"N\",\n\t\t\t\"allow_register_secret\": selfForm[\"allow_register_secret\"].value,\n\t\t\t\"allow_register_whitelist\": selfForm[\"allow_register_whitelist\"].value,\n\t\t};\n\n\t\tthis.sendAction(\"self\", obRequestData);\n\t}\n\n\tsubmitExtranet()\n\t{\n\t\tconst extranetForm = this.parent.contentBlocks[\"extranet\"].querySelector(\"form\");\n\t\tlet [items, errorInputData] = [...this.parseEmailAndPhone(extranetForm)];\n\n\t\tif (errorInputData.length > 0)\n\t\t{\n\t\t\tthis.parent.showErrorMessage(Loc.getMessage(\"INTRANET_INVITE_DIALOG_EMAIL_OR_PHONE_VALIDATE_ERROR\") + \": \" + errorInputData.join(', '));\n\t\t\treturn;\n\t\t}\n\n\t\tif (items.length <= 0)\n\t\t{\n\t\t\tconst event = new Event.BaseEvent({data: {\n\t\t\t\terror: Loc.getMessage(\"INTRANET_INVITE_DIALOG_EMAIL_OR_PHONE_EMPTY_ERROR\")}\n\t\t\t});\n\t\t\tthis.emit(\"onInputError\", event);\n\t\t\treturn;\n\t\t}\n\n\t\tlet requestData = {\n\t\t\t\"ITEMS\": items\n\t\t};\n\t\tthis.getGroupAndDepartmentData(requestData);\n\n\t\tconst analyticsLabel = {\n\t\t\t\"INVITATION_TYPE\": \"extranet\",\n\t\t\t\"INVITATION_COUNT\": items.length\n\t\t};\n\n\t\tthis.sendAction(\"extranet\", requestData, analyticsLabel);\n\t}\n\n\tsubmitIntegrator()\n\t{\n\t\tthis.getIntegratorConfirmPopup().show();\n\t}\n\n\tgetIntegratorConfirmPopup(): Popup\n\t{\n\t\tconst integratorForm = this.parent.contentBlocks.integrator.querySelector('form');\n\t\tconst obRequestData = {\n\t\t\tintegrator_email: integratorForm.integrator_email.value,\n\t\t};\n\t\tconst analyticsLabel = {\n\t\t\tINVITATION_TYPE: 'integrator',\n\t\t};\n\n\t\tconst message = Tag.render`\n\t\t\t<div class=\"invite-integrator-confirm-message\">\n\t\t\t\t${Loc.getMessage('INTRANET_INVITE_DIALOG_CONFIRM_INTEGRATOR_DESCRIPTION')}\n\t\t\t</div>\n\t\t`;\n\t\tconst moreLink = message.querySelector('span');\n\t\tEvent.bind(moreLink, 'click', () => {\n\t\t\ttop.BX.Helper.show('redirect=detail&code=20682986');\n\t\t});\n\n\t\tconst popup = new Popup({\n\t\t\tid: 'integrator-confirm-invitation-popup',\n\t\t\tmaxWidth: 500,\n\t\t\tcloseIcon: false,\n\t\t\toverlay: true,\n\t\t\tcontentPadding: 10,\n\t\t\ttitleBar: Loc.getMessage('INTRANET_INVITE_DIALOG_CONFIRM_INTEGRATOR_TITLE'),\n\t\t\tcontent: message,\n\t\t\toffsetLeft : 100,\n\t\t\tbuttons: [\n\t\t\t\tnew CreateButton({\n\t\t\t\t\ttext: Loc.getMessage('INTRANET_INVITE_DIALOG_CONFIRM_INTEGRATOR_BUTTON_YES'),\n\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\tpopup.close();\n\t\t\t\t\t\tthis.sendAction('inviteIntegrator', obRequestData, analyticsLabel);\n\t\t\t\t\t},\n\t\t\t\t}),\n\t\t\t\tnew CancelButton({\n\t\t\t\t\ttext: Loc.getMessage('INTRANET_INVITE_DIALOG_CONFIRM_INTEGRATOR_BUTTON_NO'),\n\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\tpopup.close();\n\t\t\t\t\t},\n\t\t\t\t}),\n\t\t\t],\n\t\t\tevents: {\n\t\t\t\tonClose: () => {\n\t\t\t\t\tpopup.destroy();\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\n\t\treturn popup;\n\t}\n\n\tsubmitMassInvite()\n\t{\n\t\tconst massInviteForm = this.parent.contentBlocks[\"mass-invite\"].querySelector(\"form\");\n\n\t\tconst obRequestData = {\n\t\t\t\"ITEMS\": massInviteForm[\"mass_invite_emails\"].value\n\t\t};\n\n\t\tconst analyticsLabel = {\n\t\t\t\"INVITATION_TYPE\": \"mass\"\n\t\t};\n\t\tthis.sendAction(\"massInvite\", obRequestData, analyticsLabel);\n\t}\n\n\tsubmitAdd()\n\t{\n\t\tconst addForm = this.parent.contentBlocks[\"add\"].querySelector(\"form\");\n\n\t\tlet requestData = {\n\t\t\t\"ADD_EMAIL\": addForm[\"ADD_EMAIL\"].value,\n\t\t\t\"ADD_NAME\": addForm[\"ADD_NAME\"].value,\n\t\t\t\"ADD_LAST_NAME\": addForm[\"ADD_LAST_NAME\"].value,\n\t\t\t\"ADD_POSITION\": addForm[\"ADD_POSITION\"].value,\n\t\t\t\"ADD_SEND_PASSWORD\": (\n\t\t\t\taddForm[\"ADD_SEND_PASSWORD\"]\n\t\t\t\t&& !!addForm[\"ADD_SEND_PASSWORD\"].checked\n\t\t\t\t\t? addForm[\"ADD_SEND_PASSWORD\"].value\n\t\t\t\t\t: \"N\"\n\t\t\t),\n\t\t};\n\t\tthis.getGroupAndDepartmentData(requestData);\n\n\t\tconst analyticsLabel = {\n\t\t\t\"INVITATION_TYPE\": \"add\"\n\t\t};\n\t\tthis.sendAction(\"add\", requestData, analyticsLabel);\n\t}\n\n\tsendAction(action, requestData, analyticsLabel)\n\t{\n\t\tthis.disableSubmitButton(true);\n\t\trequestData[\"userOptions\"] = this.parent.userOptions;\n\t\trequestData[\"analyticsData\"] = this.parent.analyticsLabel;\n\n\t\tBX.ajax.runComponentAction(this.parent.componentName, action, {\n\t\t\tsignedParameters: this.parent.signedParameters,\n\t\t\tmode: \"ajax\",\n\t\t\tdata: requestData,\n\t\t\tanalyticsLabel: analyticsLabel,\n\t\t}).then((response) => {\n\n\t\t\tthis.disableSubmitButton(false);\n\n\t\t\tif (response.data)\n\t\t\t{\n\t\t\t\tif (action === \"self\")\n\t\t\t\t{\n\t\t\t\t\tthis.parent.showSuccessMessage(response.data);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.parent.changeContent(\"success\");\n\t\t\t\t\tthis.sendSuccessEvent(response.data);\n\t\t\t\t}\n\t\t\t}\n\n\t\t}, (response) => {\n\n\t\t\tthis.disableSubmitButton(false);\n\n\t\t\tif (response.data == \"user_limit\")\n\t\t\t{\n\t\t\t\tB24.licenseInfoPopup.show(\n\t\t\t\t\t\"featureID\",\n\t\t\t\t\tBX.message(\"BX24_INVITE_DIALOG_USERS_LIMIT_TITLE\"),\n\t\t\t\t\tBX.message(\"BX24_INVITE_DIALOG_USERS_LIMIT_TEXT\")\n\t\t\t\t);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.parent.showErrorMessage(response.errors[0].message);\n\t\t\t}\n\t\t});\n\t}\n\n\tdisableSubmitButton(isDisable)\n\t{\n\t\tconst button = this.parent.button;\n\n\t\tif (!Type.isDomNode(button) || !Type.isBoolean(isDisable))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (isDisable)\n\t\t{\n\t\t\tthis.waitingResponse = true;\n\t\t\tDom.addClass(button, [\"ui-btn-wait\", \"invite-cursor-auto\"]);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.waitingResponse = false;\n\t\t\tDom.removeClass(button, [\"ui-btn-wait\", \"invite-cursor-auto\"]);\n\t\t}\n\t}\n\n\tsendSuccessEvent(users)\n\t{\n\t\tBX.SidePanel.Instance.postMessageAll(window, \"BX.Intranet.Invitation:onAdd\", { users: users });\n\t}\n}\n","import {Event, Type, Dom, Text, Loc} from \"main.core\";\nimport {Switcher} from 'ui.switcher';\n\nexport class SelfRegister\n{\n\tconstructor(parent)\n\t{\n\t\tthis.parent = parent;\n\n\t\tif (Type.isDomNode(this.parent.contentBlocks[\"self\"]))\n\t\t{\n\t\t\tthis.selfBlock = this.parent.contentBlocks[\"self\"];\n\t\t\tthis.bindActions();\n\n\t\t\tconst switcherNode = this.selfBlock.querySelector('.invite-dialog-fast-reg-control-switcher');\n\t\t\tthis.switcher = new Switcher({\n\t\t\t\tinputName: 'allow_register',\n\t\t\t\tid: 'allow_register',\n\t\t\t\tchecked: parent.isSelfRegisterEnabled,\n\t\t\t\tnode: switcherNode,\n\t\t\t\thandlers: {\n\t\t\t\t\ttoggled: this.toggleSettings.bind(this),\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\t}\n\n\tbindActions()\n\t{\n\t\tconst regenerateButton = this.selfBlock.querySelector(\"[data-role='selfRegenerateSecretButton']\");\n\t\tif (Type.isDomNode(regenerateButton))\n\t\t{\n\t\t\tEvent.bind(regenerateButton, 'click',() => {\n\t\t\t\tthis.parent.activateButton();\n\t\t\t\tthis.regenerateSecret(this.parent.regenerateUrlBase);\n\t\t\t});\n\t\t}\n\n\t\tconst copyRegisterUrlButton = this.selfBlock.querySelector(\"[data-role='copyRegisterUrlButton']\");\n\t\tif (Type.isDomNode(copyRegisterUrlButton))\n\t\t{\n\t\t\tEvent.bind(copyRegisterUrlButton, 'click', () => {\n\t\t\t\tthis.copyRegisterUrl();\n\t\t\t});\n\t\t}\n\n\t\tconst allowRegisterConfirm = this.selfBlock.querySelector(\"[data-role='allowRegisterConfirm']\");\n\t\tif (Type.isDomNode(allowRegisterConfirm))\n\t\t{\n\t\t\tEvent.bind(allowRegisterConfirm, 'change', () => {\n\t\t\t\tthis.parent.activateButton();\n\t\t\t\tthis.toggleWhiteList(allowRegisterConfirm);\n\t\t\t});\n\t\t}\n\n\t\tconst selfWhiteList = this.selfBlock.querySelector(\"[data-role='selfWhiteList']\");\n\t\tif (Type.isDomNode(selfWhiteList))\n\t\t{\n\t\t\tEvent.bind(selfWhiteList, 'input', () => {\n\t\t\t\tthis.parent.activateButton();\n\t\t\t});\n\t\t}\n\t}\n\n\tregenerateSecret(registerUrl)\n\t{\n\t\tconst value = Text.getRandom(8);\n\n\t\tconst allowRegisterSecretNode = this.selfBlock.querySelector(\"[data-role='allowRegisterSecret']\");\n\t\tif (Type.isDomNode(allowRegisterSecretNode))\n\t\t{\n\t\t\tallowRegisterSecretNode.value = value || '';\n\t\t}\n\n\t\tconst allowRegisterUrlNode = this.selfBlock.querySelector(\"[data-role='allowRegisterUrl']\");\n\t\tif (Type.isDomNode(allowRegisterUrlNode) && registerUrl)\n\t\t{\n\t\t\tallowRegisterUrlNode.value = registerUrl + (value || 'yes');\n\t\t}\n\t}\n\n\tcopyRegisterUrl()\n\t{\n\t\tconst allowRegisterUrlNode = this.selfBlock.querySelector(\"[data-role='allowRegisterUrl']\");\n\t\tif (Type.isDomNode(allowRegisterUrlNode))\n\t\t{\n\t\t\tBX.clipboard.copy(allowRegisterUrlNode.value);\n\t\t\tthis.showHintPopup(Loc.getMessage(\"BX24_INVITE_DIALOG_COPY_URL\"), allowRegisterUrlNode);\n\n\t\t\tBX.ajax.runAction('intranet.controller.invite.copyregisterurl', {\n\t\t\t\tdata: {}\n\t\t\t}).then(function (response) {}, function (response) {});\n\n\t\t\tthis.parent.analytics.send();\n\t\t}\n\t}\n\n\tshowHintPopup(message, bindNode)\n\t{\n\t\tif (!Type.isDomNode(bindNode) || !message)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tnew BX.PopupWindow('inviteHint' + Text.getRandom(8), bindNode, {\n\t\t\tcontent: message,\n\t\t\tzIndex: 15000,\n\t\t\tangle: true,\n\t\t\toffsetTop: 0,\n\t\t\toffsetLeft: 50,\n\t\t\tcloseIcon: false,\n\t\t\tautoHide: true,\n\t\t\tdarkMode: true,\n\t\t\toverlay: false,\n\t\t\tmaxWidth: 400,\n\t\t\tevents: {\n\t\t\t\tonAfterPopupShow: function () {\n\t\t\t\t\tsetTimeout(function () {\n\t\t\t\t\t\tthis.close();\n\t\t\t\t\t}.bind(this), 4000);\n\t\t\t\t}\n\t\t\t}\n\t\t}).show();\n\t}\n\n\ttoggleSettings()\n\t{\n\t\tthis.parent.activateButton();\n\t\tconst controlBlock = this.selfBlock.querySelector(\".js-invite-dialog-fast-reg-control-container\");\n\t\tif (Type.isDomNode(controlBlock))\n\t\t{\n\t\t\tif (!Dom.hasClass(controlBlock, 'disallow-registration'))\n\t\t\t{\n\t\t\t\tconst switcher = controlBlock.querySelector(\"[data-role='self-switcher']\");\n\t\t\t\tthis.showHintPopup(Loc.getMessage(\"INTRANET_INVITE_DIALOG_SELF_OFF_HINT\"), switcher);\n\t\t\t}\n\t\t\tDom.toggleClass(controlBlock, 'disallow-registration');\n\t\t}\n\n\t\tconst settingsBlock = this.selfBlock.querySelector(\"[data-role='selfSettingsBlock']\");\n\t\tif (Type.isDomNode(settingsBlock))\n\t\t{\n\t\t\tDom.style(settingsBlock, 'display', this.switcher.checked ? 'block' : 'none');\n\t\t}\n\t}\n\n\ttoggleWhiteList(inputElement)\n\t{\n\t\tconst selfWhiteList = this.selfBlock.querySelector(\"[data-role='selfWhiteList']\");\n\t\tif (Type.isDomNode(selfWhiteList))\n\t\t{\n\t\t\tDom.style(selfWhiteList, 'display', inputElement.checked ? 'block' : 'none');\n\t\t}\n\t}\n}","import {Dom, Type, Tag, Event} from \"main.core\";\n\nexport class Phone\n{\n\tconstructor(parent)\n\t{\n\t\tthis.parent = parent;\n\n\t\tthis.count = 0;\n\t\tthis.index = 0;\n\t\tthis.maxCount = 5;\n\t\tthis.inputStack = [];\n\t}\n\n\trenderPhoneRow(inputNode)\n\t{\n\t\tif(this.count >= this.maxCount)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (!Type.isDomNode(inputNode))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst num = inputNode.getAttribute(\"data-num\");\n\n\t\tif (inputNode.parentNode.querySelector(\"#phone_number_\" + num))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst element = Tag.render`\n\t\t\t<span style=\"z-index: 3;\" class=\"ui-ctl-before\" data-role=\"phone-block\">\n\t\t\t\t<input type=\"hidden\" name=\"PHONE_COUNTRY[]\" id=\"phone_country_${num}\" value=\"\">\n\t\t\t\t<input type=\"hidden\" name=\"PHONE[]\" id=\"phone_number_${num}\" value=\"\">\n\t\t\t\t<div class=\"invite-dialog-phone-flag-block\" data-role=\"flag\">\n\t\t\t\t\t<span data-role=\"phone_flag_${num}\" style=\"pointer-events: none;\"></span>\n\t\t\t\t</div>\n\t\t\t\t<input class=\"invite-dialog-phone-input\" type=\"hidden\" id=\"phone_input_${num}\" value=\"\">&nbsp;\n\t\t\t</span>\n\t\t`;\n\n\t\tinputNode.style.paddingLeft = \"57px\";\n\t\tDom.append(element, inputNode.parentNode);\n\n\t\tconst flagNode = inputNode.parentNode.querySelector(\"[data-role='flag']\");\n\t\tif (Type.isDomNode(flagNode))\n\t\t{\n\t\t\tEvent.bind(inputNode.parentNode.querySelector(\"[data-role='flag']\"), 'click', () => {\n\t\t\t\tthis.showCountrySelector(num);\n\t\t\t});\n\t\t}\n\n\t\tlet changeCallback = function(i, inputNode)\n\t\t{\n\t\t\treturn function(e)\n\t\t\t{\n\t\t\t\tinputNode.parentNode.querySelector('#phone_number_' + i).value = e.value;\n\t\t\t\tinputNode.parentNode.querySelector('#phone_country_' + i).value = e.country;\n\t\t\t}\n\t\t};\n\n\t\tthis.inputStack[num] = new BX.PhoneNumber.Input({\n\t\t\tnode: inputNode,\n\t\t\tflagNode: inputNode.parentNode.querySelector(\"[data-role='phone_flag_\"+ num +\"']\"),\n\t\t\tflagSize: 16,\n\t\t\tonChange: changeCallback(num, inputNode)\n\t\t});\n\n\t\t//for ctrl+v paste\n\t\tconst id = setInterval(() => {\n\t\t\tif (\n\t\t\t\t!inputNode.parentNode?.querySelector('#phone_number_' + num).value\n\t\t\t\t|| !inputNode.parentNode?.querySelector('#phone_country_' + num).value\n\t\t\t)\n\t\t\t{\n\t\t\t\tchangeCallback(num, inputNode)({\n\t\t\t\t\tvalue: this.inputStack[num].getValue(),\n\t\t\t\t\tcountry: this.inputStack[num].formatter ? this.inputStack[num].getCountry() : null,\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tclearInterval(id);\n\t\t\t}\n\t\t}, 1000);\n\t}\n\n\tshowCountrySelector(i)\n\t{\n\t\tthis.inputStack[i]._onFlagClick();\n\t}\n}","import {Event, Type, Dom, Tag, Loc} from \"main.core\";\nimport {Phone} from \"./phone\";\n\nexport class Row\n{\n\tconstructor(parent, params)\n\t{\n\t\tthis.parent = parent;\n\t\tthis.contentBlock = params.contentBlock;\n\t\tthis.inputNum = 0;\n\n\t\tif (Type.isDomNode(this.contentBlock))\n\t\t{\n\t\t\tthis.rowsContainer = this.contentBlock.querySelector(\"[data-role='rows-container']\");\n\t\t\tthis.bindActions();\n\t\t}\n\n\t\tif (this.parent.isInvitationBySmsAvailable)\n\t\t{\n\t\t\tthis.phoneObj = new Phone(this);\n\t\t}\n\t}\n\n\tbindActions()\n\t{\n\t\tconst moreButton = this.contentBlock.querySelector(\"[data-role='invite-more']\");\n\t\tif (Type.isDomNode(moreButton))\n\t\t{\n\t\t\tEvent.unbindAll(moreButton);\n\t\t\tEvent.bind(moreButton, 'click', () => {\n\t\t\t\tthis.renderInputRow();\n\t\t\t});\n\t\t}\n\n\t\tconst massInviteButton = this.contentBlock.querySelector(\"[data-role='invite-mass']\");\n\t\tif (Type.isDomNode(massInviteButton))\n\t\t{\n\t\t\tEvent.unbindAll(massInviteButton);\n\t\t\tEvent.bind(massInviteButton, 'click', () => {\n\t\t\t\tconst massMenuNode = document.querySelector(\"[data-role='menu-mass-invite']\");\n\t\t\t\tif (Type.isDomNode(massMenuNode))\n\t\t\t\t{\n\t\t\t\t\tBX.fireEvent(massMenuNode, 'click');\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tcheckPhoneInput(element)\n\t{\n\t\tconst phoneExp = /^[\\d+][\\d\\(\\)\\ -]{2,14}\\d$/;\n\n\t\tif (element.value && phoneExp.test(String(element.value).toLowerCase()))\n\t\t{\n\t\t\tthis.phoneObj.renderPhoneRow(element);\n\t\t}\n\t}\n\n\tbindPhoneChecker(element)\n\t{\n\t\tif (this.parent.isInvitationBySmsAvailable && Type.isDomNode(element))\n\t\t{\n\t\t\tconst inputNodes = Array.prototype.slice.call(element.querySelectorAll(\".js-email-phone-input\"));\n\t\t\tif (inputNodes)\n\t\t\t{\n\t\t\t\tinputNodes.forEach(element => {\n\t\t\t\t\tEvent.bind(element, 'input', () => {\n\t\t\t\t\t\tthis.checkPhoneInput(element);\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\tbindCloseIcons(container)\n\t{\n\t\tconst inputNodes = Array.prototype.slice.call(container.querySelectorAll(\"input\"));\n\n\t\t(inputNodes || []).forEach((node) => {\n\t\t\tlet closeIcon = node.nextElementSibling;\n\n\t\t\tEvent.bind(node, 'input', () => {\n\t\t\t\tDom.style(closeIcon, 'display', node.value !== \"\" ? \"block\" : \"none\");\n\t\t\t});\n\n\t\t\tEvent.bind(closeIcon, 'click', (event) => {\n\t\t\t\tevent.preventDefault();\n\n\t\t\t\tif (Type.isDomNode(node.parentNode))\n\t\t\t\t{\n\t\t\t\t\tconst phoneBlock = node.parentNode.querySelector('input.ui-ctl-element');\n\n\t\t\t\t\tif (Type.isDomNode(phoneBlock))\n\t\t\t\t\t{\n\t\t\t\t\t\tconst newInput = Tag.render`\n\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\tname=\"${phoneBlock.name}\"\n\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\tmaxlength=\"50\"\n\t\t\t\t\t\t\t\tdata-num=\"${node.getAttribute('data-num')}\"\n\t\t\t\t\t\t\t\tclass=\"ui-ctl-element js-email-phone-input\"\n\t\t\t\t\t\t\t\tplaceholder=\"${phoneBlock.placeholder}\"\n\t\t\t\t\t\t\t/>`;\n\n\t\t\t\t\t\tDom.replace(phoneBlock, newInput);\n\t\t\t\t\t\tthis.bindCloseIcons(newInput.parentNode);\n\t\t\t\t\t\tthis.bindPhoneChecker(newInput.parentNode);\n\t\t\t\t\t\tDom.remove(phoneBlock);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tDom.style(closeIcon, 'display', \"none\");\n\t\t\t});\n\t\t});\n\t}\n\n\trenderInviteInputs(numRows = 3)\n\t{\n\t\tDom.clean(this.rowsContainer);\n\t\tfor (let i = 0; i < numRows; i++)\n\t\t{\n\t\t\tthis.renderInputRow(i === 0);\n\t\t}\n\t}\n\n\trenderInputRow(showTitles = false)\n\t{\n\t\tlet emailTitle, nameTitle, lastNameTitle;\n\n\t\tif (showTitles)\n\t\t{\n\t\t\temailTitle = `\n\t\t\t\t<div class=\"ui-ctl-label-text\">\n\t\t\t\t\t${Loc.getMessage(\"INTRANET_INVITE_DIALOG_EMAIL_OR_PHONE_INPUT\")}\n\t\t\t\t</div>`;\n\n\t\t\tnameTitle = `\n\t\t\t\t<div class=\"ui-ctl-label-text\">\n\t\t\t\t\t${Loc.getMessage(\"BX24_INVITE_DIALOG_ADD_NAME_TITLE\")}\n\t\t\t\t</div>`;\n\n\t\t\tlastNameTitle = `\n\t\t\t\t<div class=\"ui-ctl-label-text\">\n\t\t\t\t\t${Loc.getMessage(\"BX24_INVITE_DIALOG_ADD_LAST_NAME_TITLE\")}\n\t\t\t\t</div>`;\n\n\t\t}\n\n\t\tconst element = Tag.render`\n\t\t\t<div class=\"invite-form-row js-form-row\">\n\t\t\t\t<div class=\"invite-form-col\">\n\t\t\t\t\t${showTitles ? emailTitle: ''}\n\t\t\t\t\t<div class=\"ui-ctl ui-ctl-w100 ui-ctl-textbox ui-ctl-block ui-ctl-after-icon\">\n\t\t\t\t\t\t<input \n\t\t\t\t\t\t\tname=\"EMAIL[]\" \n\t\t\t\t\t\t\ttype=\"text\" \n\t\t\t\t\t\t\tmaxlength=\"50\"\n\t\t\t\t\t\t\tdata-num=\"${this.inputNum++}\" \n\t\t\t\t\t\t\tclass=\"ui-ctl-element js-email-phone-input\" \n\t\t\t\t\t\t\tplaceholder=\"${Loc.getMessage('INTRANET_INVITE_DIALOG_EMAIL_OR_PHONE_INPUT')}\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<button type=\"button\" class=\"ui-ctl-after ui-ctl-icon-clear\" style=\"display: none\"></button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"invite-form-col\">\n\t\t\t\t\t${showTitles ? nameTitle: ''}\n\t\t\t\t\t<div class=\"ui-ctl ui-ctl-w100 ui-ctl-textbox ui-ctl-block ui-ctl-after-icon\">\n\t\t\t\t\t\t<input name=\"NAME[]\" type=\"text\" class=\"ui-ctl-element js-email-name-input\" placeholder=\"${Loc.getMessage('BX24_INVITE_DIALOG_ADD_NAME_TITLE')}\">\n\t\t\t\t\t\t<button type=\"button\" class=\"ui-ctl-after ui-ctl-icon-clear\" style=\"display: none\"></button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"invite-form-col\">\n\t\t\t\t\t${showTitles ? lastNameTitle: ''}\n\t\t\t\t\t<div class=\"ui-ctl ui-ctl-w100 ui-ctl-textbox ui-ctl-block ui-ctl-after-icon\">\n\t\t\t\t\t\t<input name=\"LAST_NAME[]\" type=\"text\" class=\"ui-ctl-element js-email-last-name-input\" placeholder=\"${Loc.getMessage('BX24_INVITE_DIALOG_ADD_LAST_NAME_TITLE')}\">\n\t\t\t\t\t\t<button type=\"button\" class=\"ui-ctl-after ui-ctl-icon-clear\" style=\"display: none\"></button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tDom.append(element, this.rowsContainer);\n\t\tthis.bindCloseIcons(element);\n\t\tthis.bindPhoneChecker(element);\n\t}\n\n\trenderRegisterInputs()\n\t{\n\t\tDom.clean(this.rowsContainer);\n\t\tconst element = Tag.render`\n\t\t\t<div>\n\t\t\t\t<div class=\"invite-form-row\">\n\t\t\t\t\t<div class=\"invite-form-col\">\n\t\t\t\t\t\t<div class=\"ui-ctl-label-text\">${Loc.getMessage(\"BX24_INVITE_DIALOG_ADD_NAME_TITLE\")}</div>\n\t\t\t\t\t\t<div class=\"ui-ctl ui-ctl-w100 ui-ctl-textbox ui-ctl-block ui-ctl-after-icon\">\n\t\t\t\t\t\t\t<input type=\"text\" name=\"ADD_NAME\" id=\"ADD_NAME\" class=\"ui-ctl-element\">\n\t\t\t\t\t\t\t<button type=\"button\" class=\"ui-ctl-after ui-ctl-icon-clear\" style=\"display: none\"></button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"invite-form-row\">\n\t\t\t\t\t<div class=\"invite-form-col\">\n\t\t\t\t\t\t<div class=\"ui-ctl-label-text\">${Loc.getMessage(\"BX24_INVITE_DIALOG_ADD_LAST_NAME_TITLE\")}</div>\n\t\t\t\t\t\t<div class=\"ui-ctl ui-ctl-w100 ui-ctl-textbox ui-ctl-block ui-ctl-after-icon\">\n\t\t\t\t\t\t\t<input type=\"text\" name=\"ADD_LAST_NAME\" id=\"ADD_LAST_NAME\" class=\"ui-ctl-element\">\n\t\t\t\t\t\t\t<button type=\"button\" class=\"ui-ctl-after ui-ctl-icon-clear\" style=\"display: none\"></button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"invite-form-row\">\n\t\t\t\t\t<div class=\"invite-form-col\">\n\t\t\t\t\t\t<div class=\"ui-ctl-label-text\">${Loc.getMessage(\"BX24_INVITE_DIALOG_ADD_EMAIL_TITLE\")}</div>\n\t\t\t\t\t\t<div class=\"ui-ctl ui-ctl-w100 ui-ctl-textbox ui-ctl-block ui-ctl-after-icon\">\n\t\t\t\t\t\t\t<input type=\"text\" name=\"ADD_EMAIL\" id=\"ADD_EMAIL\" class=\"ui-ctl-element\" maxlength=\"50\">\n\t\t\t\t\t\t\t<button type=\"button\" class=\"ui-ctl-after ui-ctl-icon-clear\" style=\"display: none\"></button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"invite-form-row\">\n\t\t\t\t\t<div class=\"invite-form-col\">\n\t\t\t\t\t\t<div class=\"ui-ctl-label-text\">${Loc.getMessage(\"BX24_INVITE_DIALOG_ADD_POSITION_TITLE\")}</div>\n\t\t\t\t\t\t<div class=\"ui-ctl ui-ctl-w100 ui-ctl-textbox ui-ctl-block ui-ctl-after-icon\">\n\t\t\t\t\t\t\t<input type=\"text\" name=\"ADD_POSITION\" id=\"ADD_POSITION\" class=\"ui-ctl-element\">\n\t\t\t\t\t\t\t<button type=\"button\" class=\"ui-ctl-after ui-ctl-icon-clear\" style=\"display: none\"></button>\n\t\t\t\t\t\t</div>\t\t\t\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tDom.append(element, this.rowsContainer);\n\t\tthis.bindCloseIcons(element);\n\t}\n\n\trenderIntegratorInput()\n\t{\n\t\tDom.clean(this.rowsContainer);\n\t\tconst element = Tag.render`\n\t\t\t<div class=\"invite-form-row\">\n\t\t\t\t<div class=\"invite-form-col\">\n\t\t\t\t\t<div class=\"ui-ctl-label-text\">${Loc.getMessage(\"INTRANET_INVITE_DIALOG_INTEGRATOR_EMAIL\")}</div>\n\t\t\t\t\t<div class=\"ui-ctl ui-ctl-w100 ui-ctl-textbox ui-ctl-block ui-ctl-after-icon\">\n\t\t\t\t\t\t<input \n\t\t\t\t\t\t\ttype=\"text\" \n\t\t\t\t\t\t\tclass=\"ui-ctl-element\" \n\t\t\t\t\t\t\tvalue=\"\" \n\t\t\t\t\t\t\tmaxlength=\"50\"\n\t\t\t\t\t\t\tname=\"integrator_email\" \n\t\t\t\t\t\t\tid=\"integrator_email\" \n\t\t\t\t\t\t\tplaceholder=\"${Loc.getMessage(\"INTRANET_INVITE_DIALOG_INTEGRATOR_EMAIL\")}\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<button type=\"button\" class=\"ui-ctl-after ui-ctl-icon-clear\" style=\"display: none\"></button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tDom.append(element, this.rowsContainer);\n\t\tthis.bindCloseIcons(element);\n\t}\n}\n","import {Type, Dom} from \"main.core\";\nimport {TagSelector} from 'ui.entity-selector';\n\nexport class Selector\n{\n\tconstructor(parent, params)\n\t{\n\t\tthis.parent = parent;\n\t\tthis.contentBlock = params.contentBlock;\n\t\tthis.options = params.options;\n\t\tthis.entities = [];\n\n\t\tthis.prepareOptions();\n\t}\n\n\tprepareOptions()\n\t{\n\t\tfor (let type in this.options)\n\t\t{\n\t\t\tif (!this.options.hasOwnProperty(type))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (type === \"department\" && !!this.options[type])\n\t\t\t{\n\t\t\t\tthis.entities.push({\n\t\t\t\t\tid: \"department\",\n\t\t\t\t\toptions: {\n\t\t\t\t\t\tselectMode: \"departmentsOnly\",\n\t\t\t\t\t\tallowOnlyUserDepartments: !(!!this.options[\"isAdmin\"] && this.options[\"isAdmin\"] === true),\n\t\t\t\t\t\tallowSelectRootDepartment: true,\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (type === \"project\" && !!this.options[type])\n\t\t\t{\n\t\t\t\tconst options = {\n\t\t\t\t\tfillRecentTab: true,\n\t\t\t\t};\n\t\t\t\tif (\n\t\t\t\t\tObject.prototype.hasOwnProperty.call(this.options, 'projectLimitExceeded')\n\t\t\t\t\t&& Object.prototype.hasOwnProperty.call(this.options, 'projectLimitFeatureId')\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\toptions.lockProjectLink = this.options.projectLimitExceeded;\n\t\t\t\t\toptions.lockProjectLinkFeatureId = this.options.projectLimitFeatureId;\n\t\t\t\t}\n\n\t\t\t\tconst optionValue = {\n\t\t\t\t\tid: 'project',\n\t\t\t\t\toptions,\n\t\t\t\t};\n\n\t\t\t\tif (this.options[type] === \"extranet\")\n\t\t\t\t{\n\t\t\t\t\toptionValue[\"options\"][\"extranet\"] = true;\n\t\t\t\t}\n\t\t\t\tthis.entities.push(optionValue);\n\t\t\t}\n\t\t}\n\t}\n\n\trender()\n\t{\n\t\tconst preselectedItems = [];\n\n\t\tif (\n\t\t\tthis.options.hasOwnProperty('projectId')\n\t\t\t&& this.options.projectId > 0\n\t\t)\n\t\t{\n\t\t\tpreselectedItems.push(['project', this.options.projectId])\n\t\t}\n\n\t\tthis.tagSelector = new TagSelector({\n\t\t\tdialogOptions: {\n\t\t\t\tpreselectedItems: preselectedItems,\n\t\t\t\tentities: this.entities,\n\t\t\t\tcontext: 'INTRANET_INVITATION'\n\t\t\t}\n\t\t});\n\n\t\tif (Type.isDomNode(this.contentBlock))\n\t\t{\n\t\t\tDom.clean(this.contentBlock);\n\t\t\tthis.tagSelector.renderTo(this.contentBlock);\n\t\t}\n\t}\n\n\tgetItems()\n\t{\n\t\tlet departments = [];\n\t\tlet projects = [];\n\t\tconst tagSelectorItems = this.tagSelector.getDialog().getSelectedItems();\n\n\t\ttagSelectorItems.forEach(item => {\n\t\t\tconst id = parseInt(item.getId());\n\t\t\tconst type = item.getEntityId();\n\n\t\t\tif (type === \"department\")\n\t\t\t{\n\t\t\t\tdepartments.push(id);\n\t\t\t}\n\t\t\telse if (type === \"project\")\n\t\t\t{\n\t\t\t\tprojects.push(id);\n\t\t\t}\n\t\t});\n\n\t\treturn {\n\t\t\tdepartments: departments,\n\t\t\tprojects: projects\n\t\t};\n\t}\n}","export class ActiveDirectory\n{\n\tconstructor(parent)\n\t{\n\t\tthis.parent = parent;\n\t}\n\n\tshowForm()\n\t{\n\t\tBX.UI.Feedback.Form.open(\n\t\t\t{\n\t\t\t\tid: 'intranet-active-directory',\n\t\t\t\tdefaultForm: {id: 309, sec: 'fbc0n3'}\n\t\t\t}\n\t\t);\n\t}\n}","import { Event, Type } from 'main.core';\nimport { sendData } from 'ui.analytics';\n\nexport class Analytics\n{\n\tstatic TOOLS = 'Invitation';\n\tstatic CATEGORY_INVITATION = 'invitation';\n\tstatic EVENT_COPY = 'copy_invitation_link';\n\tstatic ADMIN_ALLOW_MODE_Y = 'askAdminToAllow_Y';\n\tstatic ADMIN_ALLOW_MODE_N = 'askAdminToAllow_N';\n\tstatic IS_ADMIN_Y = 'isAdmin_Y';\n\tstatic IS_ADMIN_N = 'isAdmin_N';\n\n\tstatic EVENT_TAB_VIEW = 'tab_view';\n\tstatic TAB_EMAIL = 'tab_by_email';\n\tstatic TAB_MASS = 'tab_mass';\n\tstatic TAB_DEPARTMENT = 'tab_department';\n\tstatic TAB_INTEGRATOR = 'tab_integrator';\n\tstatic TAB_LINK = 'by_link';\n\tstatic TAB_REGISTRATION = 'registration';\n\tstatic TAB_AD = 'AD';\n\n\t#cSection: Object;\n\t#isAdmin: boolean;\n\n\tconstructor(cSection: Object, isAdmin: boolean)\n\t{\n\t\tthis.#cSection = cSection;\n\t\tthis.#isAdmin = isAdmin;\n\t}\n\n\t#getAdminAllowMode(): string\n\t{\n\t\treturn document.querySelector('#allow_register_confirm').checked\n\t\t\t? Analytics.ADMIN_ALLOW_MODE_Y\n\t\t\t: Analytics.ADMIN_ALLOW_MODE_N;\n\t}\n\n\t#getIsAdmin(): string\n\t{\n\t\treturn this.#isAdmin ? Analytics.IS_ADMIN_Y : Analytics.IS_ADMIN_N;\n\t}\n\n\t#getCSection(): string\n\t{\n\t\treturn this.#cSection.source;\n\t}\n\n\tsend(): void\n\t{\n\t\tsendData({\n\t\t\ttool: Analytics.TOOLS,\n\t\t\tcategory: Analytics.CATEGORY_INVITATION,\n\t\t\tevent: Analytics.EVENT_COPY,\n\t\t\tc_section: this.#getCSection(),\n\t\t\tp1: this.#getIsAdmin(),\n\t\t\tp2: this.#getAdminAllowMode(),\n\t\t});\n\t}\n\n\tsendTabData(section, subSection): void\n\t{\n\t\tif (!section)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tsendData({\n\t\t\ttool: Analytics.TOOLS,\n\t\t\tcategory: Analytics.CATEGORY_INVITATION,\n\t\t\tevent: Analytics.EVENT_TAB_VIEW,\n\t\t\tc_section: section,\n\t\t\tc_sub_section: subSection\n\t\t});\n\t}\n}\n","import {Type, Dom, Event, Loc} from 'main.core';\nimport {Submit} from './submit';\nimport {SelfRegister} from './self-register';\nimport {Row} from \"./row\";\nimport {Selector} from \"./selector\";\nimport {EventEmitter} from \"main.core.events\";\nimport {ActiveDirectory} from \"./active-directory\";\nimport { Analytics } from './analytics';\n\nexport default class Form extends EventEmitter\n{\n\tconstructor(formParams)\n\t{\n\t\tsuper();\n\t\tconst params = Type.isPlainObject(formParams) ? formParams : {};\n\n\t\tthis.signedParameters = params.signedParameters;\n\t\tthis.componentName = params.componentName;\n\n\t\tthis.menuContainer = params.menuContainerNode;\n\t\tthis.contentContainer = params.contentContainerNode;\n\t\tthis.contentBlocks = {};\n\t\tthis.userOptions = params.userOptions;\n\n\t\tthis.isExtranetInstalled = params.isExtranetInstalled === \"Y\";\n\t\tthis.isCloud = params.isCloud === \"Y\";\n\t\tthis.isAdmin = params.isAdmin === \"Y\";\n\t\tthis.isInvitationBySmsAvailable = params.isInvitationBySmsAvailable === \"Y\";\n\t\tthis.isCreatorEmailConfirmed = params.isCreatorEmailConfirmed === \"Y\";\n\t\tthis.regenerateUrlBase = params.regenerateUrlBase;\n\t\tthis.firstInvitationBlock = params.firstInvitationBlock;\n\t\tthis.isSelfRegisterEnabled = params.isSelfRegisterEnabled;\n\t\tthis.analyticsLabel = params.analyticsLabel;\n\t\tthis.projectLimitExceeded = Type.isBoolean(params.projectLimitExceeded) ? params.projectLimitExceeded : true;\n\t\tthis.projectLimitFeatureId = Type.isString(params.projectLimitFeatureId) ? params.projectLimitFeatureId : '';\n\n\t\tif (Type.isDomNode(this.contentContainer))\n\t\t{\n\t\t\tconst blocks = Array.prototype.slice.call(\n\t\t\t\tthis.contentContainer.querySelectorAll(\".js-intranet-invitation-block\")\n\t\t\t);\n\t\t\t(blocks || []).forEach((block) => {\n\t\t\t\tlet blockType = block.getAttribute(\"data-role\");\n\t\t\t\tblockType = blockType.replace(\"-block\", \"\");\n\t\t\t\tthis.contentBlocks[blockType] = block;\n\t\t\t});\n\n\t\t\tthis.errorMessageBlock = this.contentContainer.querySelector(\"[data-role='error-message']\");\n\t\t\tthis.successMessageBlock = this.contentContainer.querySelector(\"[data-role='success-message']\");\n\n\t\t\tBX.UI.Hint.init(this.contentContainer);\n\t\t}\n\n\t\tthis.button = document.querySelector(\"#intranet-invitation-btn\");\n\n\t\tif (Type.isDomNode(this.menuContainer))\n\t\t{\n\t\t\tthis.menuItems = Array.prototype.slice.call(this.menuContainer.querySelectorAll(\"a\"));\n\n\t\t\t(this.menuItems || []).forEach((item) => {\n\t\t\t\tEvent.bind(item, 'click', () => {\n\t\t\t\t\tthis.changeContent(item.getAttribute('data-action'));\n\t\t\t\t});\n\n\t\t\t\tif (item.getAttribute('data-action') === this.firstInvitationBlock)\n\t\t\t\t{\n\t\t\t\t\tBX.fireEvent(item, 'click');\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tthis.submit = new Submit(this);\n\t\tthis.submit.subscribe('onInputError', (event) => {\n\t\t\tthis.showErrorMessage(event.data.error);\n\t\t});\n\n\t\tthis.analytics = new Analytics(this.analyticsLabel, this.isAdmin);\n\n\t\tif (this.isCloud)\n\t\t{\n\t\t\tthis.selfRegister = new SelfRegister(this);\n\t\t}\n\n\t\tthis.arrowBox = document.querySelector('.invite-wrap-decal-arrow');\n\t\tif (Type.isDomNode(this.arrowBox))\n\t\t{\n\t\t\tthis.arrowRect = this.arrowBox.getBoundingClientRect();\n\t\t\tthis.arrowHeight = this.arrowRect.height;\n\t\t\tthis.setSetupArrow();\n\t\t}\n\t}\n\n\trenderSelector(params)\n\t{\n\t\tthis.selector = new Selector(this, params);\n\t\tthis.selector.render();\n\t}\n\n\tgetSubSection()\n\t{\n\t\tconst regex = /analyticsLabel\\[source]=(\\w*)&/gm;\n\t\tlet match = regex.exec(decodeURI(window.location));\n\t\tif (match?.length > 1)\n\t\t{\n\t\t\treturn match[1];\n\t\t}\n\t\treturn null;\n\t}\n\n\tchangeContent(action)\n\t{\n\t\tthis.hideErrorMessage();\n\t\tthis.hideSuccessMessage();\n\t\tlet section = this.getSubSection();\n\t\tlet subSection = \"\";\n\n\t\tif (action.length > 0)\n\t\t{\n\t\t\tif (action === 'active-directory')\n\t\t\t{\n\t\t\t\tif (!this.activeDirectory)\n\t\t\t\t{\n\t\t\t\t\tthis.activeDirectory = new ActiveDirectory(this);\n\t\t\t\t}\n\n\t\t\t\tthis.activeDirectory.showForm();\n\t\t\t\tthis.analytics.sendTabData(Analytics.TAB_AD);\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst projectId = (\n\t\t\t\tthis.userOptions.hasOwnProperty('groupId')\n\t\t\t\t\t? parseInt(this.userOptions.groupId, 10)\n\t\t\t\t\t: 0\n\t\t\t);\n\n\t\t\tfor (let type in this.contentBlocks)\n\t\t\t{\n\t\t\t\tlet block = this.contentBlocks[type];\n\n\t\t\t\tif (type === action)\n\t\t\t\t{\n\t\t\t\t\tDom.removeClass(block, 'invite-block-hidden');\n\t\t\t\t\tDom.addClass(block, 'invite-block-shown');\n\n\t\t\t\t\tconst params = {\n\t\t\t\t\t\tcontentBlock: this.contentBlocks[action]\n\t\t\t\t\t};\n\t\t\t\t\tconst row = new Row(this, params);\n\n\t\t\t\t\tif (action === 'invite')\n\t\t\t\t\t{\n\t\t\t\t\t\tsubSection = Analytics.TAB_EMAIL;\n\t\t\t\t\t\trow.renderInviteInputs(5);\n\t\t\t\t\t}\n\t\t\t\t\telse if (action === 'invite-with-group-dp')\n\t\t\t\t\t{\n\t\t\t\t\t\tsubSection = Analytics.TAB_DEPARTMENT;\n\t\t\t\t\t\trow.renderInviteInputs(3);\n\n\t\t\t\t\t\tconst selectorParams = {\n\t\t\t\t\t\t\tcontentBlock: this.contentBlocks[action]\n\t\t\t\t\t\t\t\t.querySelector(\"[data-role='entity-selector-container']\"),\n\t\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\t\tdepartment: true,\n\t\t\t\t\t\t\t\tproject: true,\n\t\t\t\t\t\t\t\tprojectId: projectId,\n\t\t\t\t\t\t\t\tisAdmin: this.isAdmin,\n\t\t\t\t\t\t\t\tprojectLimitExceeded: this.projectLimitExceeded,\n\t\t\t\t\t\t\t\tprojectLimitFeatureId: this.projectLimitFeatureId,\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t};\n\t\t\t\t\t\tthis.renderSelector(selectorParams);\n\t\t\t\t\t}\n\t\t\t\t\telse if (action === 'extranet')\n\t\t\t\t\t{\n\t\t\t\t\t\trow.renderInviteInputs(3);\n\n\t\t\t\t\t\tconst selectorParams = {\n\t\t\t\t\t\t\tcontentBlock: this.contentBlocks[action]\n\t\t\t\t\t\t\t\t.querySelector(\"[data-role='entity-selector-container']\"),\n\t\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\t\tdepartment: false,\n\t\t\t\t\t\t\t\tproject: \"extranet\",\n\t\t\t\t\t\t\t\tprojectId: projectId,\n\t\t\t\t\t\t\t\tisAdmin: this.isAdmin,\n\t\t\t\t\t\t\t\tprojectLimitExceeded: this.projectLimitExceeded,\n\t\t\t\t\t\t\t\tprojectLimitFeatureId: this.projectLimitFeatureId,\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t};\n\t\t\t\t\t\tthis.renderSelector(selectorParams);\n\t\t\t\t\t}\n\t\t\t\t\telse if (action === \"add\")\n\t\t\t\t\t{\n\t\t\t\t\t\tsubSection = Analytics.TAB_REGISTRATION;\n\t\t\t\t\t\trow.renderRegisterInputs();\n\n\t\t\t\t\t\tconst selectorParams = {\n\t\t\t\t\t\t\tcontentBlock: this.contentBlocks[action]\n\t\t\t\t\t\t\t\t.querySelector(\"[data-role='entity-selector-container']\"),\n\t\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\t\tdepartment: true,\n\t\t\t\t\t\t\t\tproject: true,\n\t\t\t\t\t\t\t\tprojectId: projectId,\n\t\t\t\t\t\t\t\tisAdmin: this.isAdmin,\n\t\t\t\t\t\t\t\tprojectLimitExceeded: this.projectLimitExceeded,\n\t\t\t\t\t\t\t\tprojectLimitFeatureId: this.projectLimitFeatureId,\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t};\n\t\t\t\t\t\tthis.renderSelector(selectorParams);\n\t\t\t\t\t}\n\t\t\t\t\telse if (action === \"integrator\")\n\t\t\t\t\t{\n\t\t\t\t\t\tsubSection = Analytics.TAB_INTEGRATOR;\n\t\t\t\t\t\trow.renderIntegratorInput();\n\t\t\t\t\t}\n\t\t\t\t\telse if (action === \"self\")\n\t\t\t\t\t{\n\t\t\t\t\t\tsubSection = Analytics.TAB_LINK;\n\t\t\t\t\t}\n\t\t\t\t\telse if (action === \"mass-invite\")\n\t\t\t\t\t{\n\t\t\t\t\t\tsubSection = Analytics.TAB_MASS;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tDom.removeClass(block, 'invite-block-shown');\n\t\t\t\t\tDom.addClass(block, 'invite-block-hidden');\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (this.analytics)\n\t\t\t{\n\t\t\t\tthis.analytics.sendTabData(section, subSection);\n\t\t\t}\n\t\t\tthis.changeButton(action);\n\t\t}\n\t}\n\n\tchangeButton(action)\n\t{\n\t\tEvent.unbindAll(this.button, 'click');\n\n\t\tif (!this.isCreatorEmailConfirmed)\n\t\t{\n\t\t\tEvent.bind(this.button, 'click', () => {\n\t\t\t\tthis.showErrorMessage(Loc.getMessage('INTRANET_INVITE_DIALOG_CONFIRM_CREATOR_EMAIL_ERROR'));\n\t\t\t});\n\t\t\treturn;\n\t\t}\n\n\t\tthis.activateButton();\n\n\t\tif (action === \"invite\")\n\t\t{\n\t\t\tthis.button.innerText = Loc.getMessage('BX24_INVITE_DIALOG_ACTION_INVITE');\n\n\t\t\tEvent.bind(this.button, 'click',() => {\n\t\t\t\tif (!this.submit.waitingResponse) {\n\t\t\t\t\tthis.submit.submitInvite();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\telse if (action === \"mass-invite\")\n\t\t{\n\t\t\tthis.button.innerText = Loc.getMessage('BX24_INVITE_DIALOG_ACTION_INVITE');\n\n\t\t\tEvent.bind(this.button, 'click',() => {\n\t\t\t\tif (!this.submit.waitingResponse) {\n\t\t\t\t\tthis.submit.submitMassInvite();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\telse if (action === \"invite-with-group-dp\")\n\t\t{\n\t\t\tthis.button.innerText = Loc.getMessage('BX24_INVITE_DIALOG_ACTION_INVITE');\n\n\t\t\tEvent.bind(this.button, 'click', () => {\n\t\t\t\tif (!this.submit.waitingResponse) {\n\t\t\t\t\tthis.submit.submitInviteWithGroupDp();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\telse if (action === \"add\")\n\t\t{\n\t\t\tthis.button.innerText = Loc.getMessage('BX24_INVITE_DIALOG_ACTION_ADD');\n\n\t\t\tEvent.bind(this.button, 'click', () => {\n\t\t\t\tif (!this.submit.waitingResponse) {\n\t\t\t\t\tthis.submit.submitAdd();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\telse if (action === \"self\")\n\t\t{\n\t\t\tthis.button.innerText = Loc.getMessage('BX24_INVITE_DIALOG_ACTION_SAVE');\n\t\t\tthis.disableButton();\n\n\t\t\tEvent.bind(this.button, 'click', () => {\n\t\t\t\tif (this.isButtonActive())\n\t\t\t\t{\n\t\t\t\t\tthis.submit.submitSelf();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\telse if (action === \"integrator\")\n\t\t{\n\t\t\tthis.button.innerText = Loc.getMessage('BX24_INVITE_DIALOG_ACTION_INVITE');\n\n\t\t\tEvent.bind(this.button, 'click', () => {\n\t\t\t\tif (!this.submit.waitingResponse) {\n\t\t\t\t\tthis.submit.submitIntegrator();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\telse if (action === \"extranet\")\n\t\t{\n\t\t\tthis.button.innerText = Loc.getMessage('BX24_INVITE_DIALOG_ACTION_INVITE');\n\n\t\t\tEvent.bind(this.button, 'click', () => {\n\t\t\t\tif (!this.submit.waitingResponse) {\n\t\t\t\t\tthis.submit.submitExtranet();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\telse if (action === \"success\")\n\t\t{\n\t\t\tthis.button.innerText = Loc.getMessage('BX24_INVITE_DIALOG_ACTION_INVITE_MORE');\n\n\t\t\tEvent.bind(this.button, 'click', () => {\n\t\t\t\tBX.fireEvent(this.menuItems[0], 'click');\n\t\t\t});\n\t\t}\n\t}\n\n\tdisableButton()\n\t{\n\t\tDom.addClass(this.button, \"ui-btn-disabled\");\n\t}\n\n\tactivateButton()\n\t{\n\t\tDom.removeClass(this.button, \"ui-btn-disabled\");\n\t}\n\n\tisButtonActive()\n\t{\n\t\treturn !Dom.hasClass(this.button, \"ui-btn-disabled\");\n\t}\n\n\tshowSuccessMessage(successText)\n\t{\n\t\tthis.hideErrorMessage();\n\n\t\tif (Type.isDomNode(this.successMessageBlock))\n\t\t{\n\t\t\tthis.successMessageBlock.style.display = \"block\";\n\t\t\tconst alert = this.successMessageBlock.querySelector(\".ui-alert-message\");\n\t\t\tif (Type.isDomNode(alert))\n\t\t\t{\n\t\t\t\talert.innerHTML = BX.util.htmlspecialchars(successText);\n\t\t\t}\n\t\t}\n\t}\n\n\thideSuccessMessage()\n\t{\n\t\tif (Type.isDomNode(this.successMessageBlock))\n\t\t{\n\t\t\tthis.successMessageBlock.style.display = \"none\";\n\t\t}\n\t}\n\n\tshowErrorMessage(errorText)\n\t{\n\t\tthis.hideSuccessMessage();\n\n\t\tif (Type.isDomNode(this.errorMessageBlock) && errorText)\n\t\t{\n\t\t\tthis.errorMessageBlock.style.display = \"block\";\n\t\t\tconst alert = this.errorMessageBlock.querySelector(\".ui-alert-message\");\n\t\t\tif (Type.isDomNode(alert))\n\t\t\t{\n\t\t\t\talert.innerHTML = BX.util.htmlspecialchars(errorText);\n\t\t\t}\n\t\t}\n\t}\n\n\thideErrorMessage()\n\t{\n\t\tif (Type.isDomNode(this.errorMessageBlock))\n\t\t{\n\t\t\tthis.errorMessageBlock.style.display = \"none\";\n\t\t}\n\t}\n\n\tgetSetupArrow()\n\t{\n\t\tthis.body = document.querySelector('.invite-body');\n\t\tthis.panelConfirmBtn = document.getElementById('intranet-invitation-btn');\n\t\tthis.sliderContent = document.querySelector('.ui-page-slider-workarea');\n\t\tthis.sliderHeader = document.querySelector('.ui-side-panel-wrap-title-wrap');\n\t\tthis.buttonPanel = document.querySelector('.ui-button-panel');\n\t\tthis.inviteButton = document.querySelector('.invite-form-buttons');\n\n\t\tthis.sliderHeaderHeight = this.sliderHeader.getBoundingClientRect().height;\n\t\tthis.buttonPanelRect = this.buttonPanel.getBoundingClientRect();\n\t\tthis.panelRect = this.panelConfirmBtn.getBoundingClientRect();\n\t\tthis.btnWidth = Math.ceil(this.panelRect.width);\n\t\tthis.arrowWidth = Math.ceil(this.arrowRect.width);\n\t\tthis.sliderContentRect = this.sliderContent.getBoundingClientRect();\n\n\t\tthis.bodyHeight = this.body.getBoundingClientRect().height - this.buttonPanelRect.height + this.sliderHeaderHeight;\n\t\tthis.contentHeight = this.arrowHeight + this.sliderContentRect.height + this.buttonPanelRect.height + this.sliderHeaderHeight - 65;\n\t}\n\n\tupdateArrow()\n\t{\n\t\tthis.bodyHeight = this.body.getBoundingClientRect().height - this.buttonPanelRect.height + this.sliderHeaderHeight;\n\t\tthis.contentHeight = this.arrowHeight + this.sliderContentRect.height + this.buttonPanelRect.height + this.sliderHeaderHeight - 65;\n\t\tthis.contentHeight > this.bodyHeight ? this.body.classList.add('js-intranet-invitation-arrow-hide') : this.body.classList.remove('js-intranet-invitation-arrow-hide');\n\t}\n\n\tsetSetupArrow()\n\t{\n\t\tthis.getSetupArrow();\n\t\tconst btnPadding = 40;\n\t\tthis.arrowBox.style.left = (this.panelRect.left + (this.btnWidth / 2) - (this.arrowWidth / 2) - btnPadding) + 'px';\n\t\tthis.contentHeight > this.bodyHeight ? this.body.classList.add('js-intranet-invitation-arrow-hide') : this.body.classList.remove('js-intranet-invitation-arrow-hide');\n\n\t\twindow.addEventListener('resize', function() {\n\t\t\tif (window.innerWidth <= 1100)\n\t\t\t{\n\t\t\t\tthis.arrowBox.style.left = (this.panelRect.left + (this.btnWidth / 2) - (this.arrowWidth / 2) - btnPadding) + 'px';\n\t\t\t}\n\t\t\tthis.getSetupArrow();\n\t\t\tthis.updateArrow();\n\t\t}.bind(this))\n\n\t\tthis.inviteButton.addEventListener('click', function() {\n\t\t\tthis.getSetupArrow();\n\t\t\tthis.updateArrow();\n\t\t}.bind(this))\n\t}\n}\n"],"names":["Submit","parent","waitingResponse","setEventNamespace","subscribe","event","form","Type","isDomNode","errorInputData","items","phoneExp","rows","Array","prototype","slice","call","querySelectorAll","forEach","row","emailInput","querySelector","phoneInput","nameInput","lastNameInput","emailValue","value","trim","isInvitationBySmsAvailable","phoneValue","test","String","toLowerCase","push","phoneCountryInput","Validation","isEmail","requestData","selector","selectorItems","getItems","length","inviteForm","contentBlocks","parseEmailAndPhone","Event","BaseEvent","data","error","Loc","getMessage","join","emit","analyticsLabel","sendAction","inviteWithGroupDpForm","showErrorMessage","getGroupAndDepartmentData","selfForm","obRequestData","checked","extranetForm","getIntegratorConfirmPopup","show","integratorForm","integrator","integrator_email","INVITATION_TYPE","message","Tag","render","moreLink","bind","top","BX","Helper","popup","Popup","id","maxWidth","closeIcon","overlay","contentPadding","titleBar","content","offsetLeft","buttons","CreateButton","text","onclick","close","CancelButton","events","onClose","destroy","massInviteForm","addForm","action","disableSubmitButton","userOptions","ajax","runComponentAction","componentName","signedParameters","mode","then","response","showSuccessMessage","changeContent","sendSuccessEvent","B24","licenseInfoPopup","errors","isDisable","button","isBoolean","Dom","addClass","removeClass","users","SidePanel","Instance","postMessageAll","window","EventEmitter","SelfRegister","selfBlock","bindActions","switcherNode","switcher","Switcher","inputName","isSelfRegisterEnabled","node","handlers","toggled","toggleSettings","regenerateButton","activateButton","regenerateSecret","regenerateUrlBase","copyRegisterUrlButton","copyRegisterUrl","allowRegisterConfirm","toggleWhiteList","selfWhiteList","registerUrl","Text","getRandom","allowRegisterSecretNode","allowRegisterUrlNode","clipboard","copy","showHintPopup","runAction","analytics","send","bindNode","PopupWindow","zIndex","angle","offsetTop","autoHide","darkMode","onAfterPopupShow","setTimeout","controlBlock","hasClass","toggleClass","settingsBlock","style","inputElement","Phone","count","index","maxCount","inputStack","inputNode","num","getAttribute","parentNode","element","paddingLeft","append","flagNode","showCountrySelector","changeCallback","i","e","country","PhoneNumber","Input","flagSize","onChange","setInterval","getValue","formatter","getCountry","clearInterval","_onFlagClick","Row","params","contentBlock","inputNum","rowsContainer","phoneObj","moreButton","unbindAll","renderInputRow","massInviteButton","massMenuNode","document","fireEvent","renderPhoneRow","inputNodes","checkPhoneInput","container","nextElementSibling","preventDefault","phoneBlock","newInput","name","placeholder","replace","bindCloseIcons","bindPhoneChecker","remove","numRows","clean","showTitles","emailTitle","nameTitle","lastNameTitle","Selector","options","entities","prepareOptions","type","hasOwnProperty","selectMode","allowOnlyUserDepartments","allowSelectRootDepartment","fillRecentTab","Object","lockProjectLink","projectLimitExceeded","lockProjectLinkFeatureId","projectLimitFeatureId","optionValue","preselectedItems","projectId","tagSelector","TagSelector","dialogOptions","context","renderTo","departments","projects","tagSelectorItems","getDialog","getSelectedItems","item","parseInt","getId","getEntityId","ActiveDirectory","UI","Feedback","Form","open","defaultForm","sec","Analytics","cSection","isAdmin","sendData","tool","TOOLS","category","CATEGORY_INVITATION","EVENT_COPY","c_section","p1","p2","section","subSection","EVENT_TAB_VIEW","c_sub_section","ADMIN_ALLOW_MODE_Y","ADMIN_ALLOW_MODE_N","IS_ADMIN_Y","IS_ADMIN_N","source","formParams","isPlainObject","menuContainer","menuContainerNode","contentContainer","contentContainerNode","isExtranetInstalled","isCloud","isCreatorEmailConfirmed","firstInvitationBlock","isString","blocks","block","blockType","errorMessageBlock","successMessageBlock","Hint","init","menuItems","submit","selfRegister","arrowBox","arrowRect","getBoundingClientRect","arrowHeight","height","setSetupArrow","regex","match","exec","decodeURI","location","hideErrorMessage","hideSuccessMessage","getSubSection","activeDirectory","showForm","sendTabData","TAB_AD","groupId","TAB_EMAIL","renderInviteInputs","TAB_DEPARTMENT","selectorParams","department","project","renderSelector","TAB_REGISTRATION","renderRegisterInputs","TAB_INTEGRATOR","renderIntegratorInput","TAB_LINK","TAB_MASS","changeButton","innerText","submitInvite","submitMassInvite","submitInviteWithGroupDp","submitAdd","disableButton","isButtonActive","submitSelf","submitIntegrator","submitExtranet","successText","display","alert","innerHTML","util","htmlspecialchars","errorText","body","panelConfirmBtn","getElementById","sliderContent","sliderHeader","buttonPanel","inviteButton","sliderHeaderHeight","buttonPanelRect","panelRect","btnWidth","Math","ceil","width","arrowWidth","sliderContentRect","bodyHeight","contentHeight","classList","add","getSetupArrow","btnPadding","left","addEventListener","innerWidth","updateArrow"],"mappings":"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"}