this.BX=this.BX||{};this.BX.Intranet=this.BX.Intranet||{};(function(t,e,n){"use strict";var i=function(t){babelHelpers.inherits(n,t);function n(t){var e;babelHelpers.classCallCheck(this,n);e=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(n).call(this));e.parent=t;e.setEventNamespace("BX.Intranet.Invitation.Submit");e.parent.subscribe("onButtonClick",function(t){});return e}babelHelpers.createClass(n,[{key:"parseEmailAndPhone",value:function t(n){var i=this;if(!e.Type.isDomNode(n)){return}var s=[];var r=[];var a=/^[\d+][\d\(\)\ -]{4,22}\d$/;var o=Array.prototype.slice.call(n.querySelectorAll(".js-form-row"));(o||[]).forEach(function(t){var n=t.querySelector("input[name='EMAIL[]']");var o=t.querySelector("input[name='PHONE[]']");var l=t.querySelector("input[name='NAME[]']");var c=t.querySelector("input[name='LAST_NAME[]']");var u=n.value.trim();if(i.parent.isInvitationBySmsAvailable&&e.Type.isDomNode(o)){var d=o.value.trim();if(d){if(!a.test(String(d).toLowerCase())){s.push(d)}else{var v=t.querySelector("input[name='PHONE_COUNTRY[]']");r.push({PHONE:d,PHONE_COUNTRY:v.value.trim(),NAME:l.value,LAST_NAME:c.value})}}}else if(u){if(e.Validation.isEmail(u)){r.push({EMAIL:u,NAME:l.value,LAST_NAME:c.value})}else{s.push(u)}}});return[r,s]}},{key:"prepareGroupAndDepartmentData",value:function t(n,i){var s=[];var r=[];function a(t){var e=t.value;if(e.match(/^SG(\d+)$/)){s.push(e)}else if(e.match(/^DR(\d+)$/)){r.push(parseInt(e.replace("DR","")))}else if(e.match(/^D(\d+)$/)){r.push(parseInt(e.replace("D","")))}}for(var o=0,l=n.length;o<l;o++){if(e.Type.isArrayLike(n[o])){n[o].forEach(function(t){a(t)})}else{a(n[o])}}return{groups:s,departments:r}}},{key:"submitInvite",value:function t(){var n=this.parent.contentBlocks["invite"].querySelector("form");var i=babelHelpers.toConsumableArray(this.parseEmailAndPhone(n)),s=i[0],r=i[1];if(r.length>0){var a=new e.Event.BaseEvent({data:{error:e.Loc.getMessage("INTRANET_INVITE_DIALOG_EMAIL_OR_PHONE_VALIDATE_ERROR")+": "+r.join(", ")}});this.emit("onInputError",a);return}if(s.length<=0){var o=new e.Event.BaseEvent({data:{error:e.Loc.getMessage("INTRANET_INVITE_DIALOG_EMAIL_OR_PHONE_EMPTY_ERROR")}});this.emit("onInputError",o);return}var l={ITEMS:s};this.sendAction("invite",l)}},{key:"submitInviteWithGroupDp",value:function t(){var n=this.parent.contentBlocks["invite-with-group-dp"].querySelector("form");var i=babelHelpers.toConsumableArray(this.parseEmailAndPhone(n)),s=i[0],r=i[1];if(r.length>0){this.parent.showErrorMessage(e.Loc.getMessage("INTRANET_INVITE_DIALOG_EMAIL_OR_PHONE_VALIDATE_ERROR")+": "+r.join(", "));return}if(s.length<=0){var a=new e.Event.BaseEvent({data:{error:e.Loc.getMessage("INTRANET_INVITE_DIALOG_EMAIL_OR_PHONE_EMPTY_ERROR")}});this.emit("onInputError",a);return}var o={ITEMS:s};if(!e.Type.isUndefined(n["GROUP_AND_DEPARTMENT[]"])){var l;if(typeof n["GROUP_AND_DEPARTMENT[]"].value=="undefined"){l=n["GROUP_AND_DEPARTMENT[]"]}else{l=[n["GROUP_AND_DEPARTMENT[]"]]}var c=this.prepareGroupAndDepartmentData(l,n);if(e.Type.isArray(c["groups"])){o["SONET_GROUPS_CODE"]=c["groups"]}if(e.Type.isArray(c["departments"])){o["UF_DEPARTMENT"]=c["departments"]}}this.sendAction("inviteWithGroupDp",o)}},{key:"submitSelf",value:function t(){var e=this.parent.contentBlocks["self"].querySelector("form");var n={allow_register:e["allow_register"].checked?"Y":"N",allow_register_confirm:e["allow_register_confirm"].checked?"Y":"N",allow_register_secret:e["allow_register_secret"].value,allow_register_whitelist:e["allow_register_whitelist"].value};this.sendAction("self",n)}},{key:"submitExtranet",value:function t(){var n=this.parent.contentBlocks["extranet"].querySelector("form");var i=babelHelpers.toConsumableArray(this.parseEmailAndPhone(n)),s=i[0],r=i[1];if(r.length>0){this.parent.showErrorMessage(e.Loc.getMessage("INTRANET_INVITE_DIALOG_EMAIL_OR_PHONE_VALIDATE_ERROR")+": "+r.join(", "));return}if(s.length<=0){var a=new e.Event.BaseEvent({data:{error:e.Loc.getMessage("INTRANET_INVITE_DIALOG_EMAIL_OR_PHONE_EMPTY_ERROR")}});this.emit("onInputError",a);return}var o={ITEMS:s};if(!e.Type.isUndefined(n["GROUP_AND_DEPARTMENT[]"])){var l;if(typeof n["GROUP_AND_DEPARTMENT[]"].value=="undefined"){l=n["GROUP_AND_DEPARTMENT[]"]}else{l=[n["GROUP_AND_DEPARTMENT[]"]]}var c=this.prepareGroupAndDepartmentData(l,n);if(e.Type.isArray(c["groups"])){o["SONET_GROUPS_CODE"]=c["groups"]}}this.sendAction("extranet",o)}},{key:"submitIntegrator",value:function t(){var e=this.parent.contentBlocks["integrator"].querySelector("form");var n={integrator_email:e["integrator_email"].value};this.sendAction("inviteIntegrator",n)}},{key:"submitMassInvite",value:function t(){var e=this.parent.contentBlocks["mass-invite"].querySelector("form");var n={ITEMS:e["mass_invite_emails"].value};this.sendAction("massInvite",n)}},{key:"submitAdd",value:function t(){var n=this.parent.contentBlocks["add"].querySelector("form");var i={ADD_EMAIL:n["ADD_EMAIL"].value,ADD_NAME:n["ADD_NAME"].value,ADD_LAST_NAME:n["ADD_LAST_NAME"].value,ADD_POSITION:n["ADD_POSITION"].value,ADD_SEND_PASSWORD:n["ADD_SEND_PASSWORD"]&&!!n["ADD_SEND_PASSWORD"].checked?n["ADD_SEND_PASSWORD"].value:"N"};if(!e.Type.isUndefined(n["GROUP_AND_DEPARTMENT[]"])){var s;if(typeof n["GROUP_AND_DEPARTMENT[]"].value=="undefined"){s=n["GROUP_AND_DEPARTMENT[]"]}else{s=[n["GROUP_AND_DEPARTMENT[]"]]}var r=this.prepareGroupAndDepartmentData(s,n);if(e.Type.isArray(r["groups"])){i["SONET_GROUPS_CODE"]=r["groups"]}if(e.Type.isArray(r["departments"])){i["DEPARTMENT_ID"]=r["departments"]}}this.sendAction("add",i)}},{key:"sendAction",value:function t(e,n){this.disableSubmitButton(true);n["userOptions"]=this.parent.userOptions;BX.ajax.runComponentAction(this.parent.componentName,e,{signedParameters:this.parent.signedParameters,mode:"ajax",data:n}).then(function(t){this.disableSubmitButton(false);if(t.data){if(e==="self"){this.parent.showSuccessMessage(t.data)}else{this.parent.changeContent("success");this.sendSuccessEvent(t.data)}}}.bind(this),function(t){this.disableSubmitButton(false);if(t.data=="user_limit"){B24.licenseInfoPopup.show("featureID",BX.message("BX24_INVITE_DIALOG_USERS_LIMIT_TITLE"),BX.message("BX24_INVITE_DIALOG_USERS_LIMIT_TEXT"))}else{this.parent.showErrorMessage(t.errors[0].message)}}.bind(this))}},{key:"disableSubmitButton",value:function t(n){var i=this.parent.button;if(!e.Type.isDomNode(i)||!e.Type.isBoolean(n)){return}if(n){e.Dom.addClass(i,"ui-btn-wait");i.style.cursor="auto"}else{e.Dom.removeClass(i,"ui-btn-wait");i.style.cursor="pointer"}}},{key:"sendSuccessEvent",value:function t(e){BX.SidePanel.Instance.postMessageAll(window,"BX.Intranet.Invitation:onAdd",{users:e})}}]);return n}(n.EventEmitter);var s=function(){function t(n){babelHelpers.classCallCheck(this,t);this.parent=n;if(e.Type.isDomNode(this.parent.contentBlocks["self"])){this.selfBlock=this.parent.contentBlocks["self"];this.bindActions()}}babelHelpers.createClass(t,[{key:"bindActions",value:function t(){var n=this;var i=this.selfBlock.querySelector("[data-role='selfRegenerateSecretButton']");if(e.Type.isDomNode(i)){e.Event.bind(i,"click",BX.delegate(function(){n.regenerateSecret(n.parent.regenerateUrlBase)},this))}var s=this.selfBlock.querySelector("[data-role='copyRegisterUrlButton']");if(e.Type.isDomNode(s)){e.Event.bind(s,"click",BX.delegate(function(){n.copyRegisterUrl()},this))}var r=this.selfBlock.querySelector("[data-role='selfToggleSettingsButton']");if(e.Type.isDomNode(r)){e.Event.bind(r,"change",function(){n.toggleSettings(r)})}}},{key:"regenerateSecret",value:function t(n){var i=e.Text.getRandom(8);var s=this.selfBlock.querySelector("[data-role='allowRegisterSecret']");if(e.Type.isDomNode(s)){s.value=i||""}var r=this.selfBlock.querySelector("[data-role='allowRegisterUrl']");if(e.Type.isDomNode(r)&&n){r.value=n+(i||"yes")}}},{key:"copyRegisterUrl",value:function t(){var n=this.selfBlock.querySelector("[data-role='allowRegisterUrl']");if(e.Type.isDomNode(n)){BX.clipboard.copy(n.value);this.showHintPopup(e.Loc.getMessage("BX24_INVITE_DIALOG_COPY_URL"),n);BX.ajax.runAction("intranet.controller.invite.copyregisterurl",{data:{}}).then(function(t){},function(t){})}}},{key:"showHintPopup",value:function t(n,i){if(!e.Type.isDomNode(i)||!n){return}new BX.PopupWindow("inviteHint"+e.Text.getRandom(8),i,{content:n,zIndex:15e3,angle:true,offsetTop:0,offsetLeft:50,closeIcon:false,autoHide:true,darkMode:true,overlay:false,maxWidth:400,events:{onAfterPopupShow:function t(){setTimeout(function(){this.close()}.bind(this),4e3)}}}).show()}},{key:"toggleSettings",value:function t(n){var i=this.selfBlock.querySelector(".js-invite-dialog-fast-reg-control-container");if(e.Type.isDomNode(i)){if(!e.Dom.hasClass(i,"disallow-registration")){var s=i.querySelector("[data-role='self-switcher']");this.showHintPopup(e.Loc.getMessage("INTRANET_INVITE_DIALOG_SELF_OFF_HINT"),s)}e.Dom.toggleClass(i,"disallow-registration")}var r=this.selfBlock.querySelector("[data-role='selfSettingsBlock']");if(e.Type.isDomNode(r)){e.Dom.style(r,"display",n.checked?"block":"none")}}}]);return t}();function r(){var t=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<span style="z-index: 3;" class="ui-ctl-before" data-role="phone-block">\n\t\t\t\t<input type="hidden" name="PHONE_COUNTRY[]" id="phone_country_','" value="">\n\t\t\t\t<input type="hidden" name="PHONE[]" id="phone_number_','" value="">\n\t\t\t\t<div class="invite-dialog-phone-flag-block" data-role="flag">\n\t\t\t\t\t<span data-role="phone_flag_','" style="pointer-events: none;"></span>\n\t\t\t\t</div>\n\t\t\t\t<input class="invite-dialog-phone-input" type="hidden" id="phone_input_','" value="">&nbsp;\n\t\t\t</span>\n\t\t']);r=function e(){return t};return t}var a=function(){function t(e){babelHelpers.classCallCheck(this,t);this.parent=e;this.count=0;this.index=0;this.maxCount=5;this.inputStack=[]}babelHelpers.createClass(t,[{key:"renderPhoneRow",value:function t(n){var i=this;if(this.count>=this.maxCount){return}if(!e.Type.isDomNode(n)){return}var s=n.getAttribute("data-num");if(n.parentNode.querySelector("#phone_number_"+s)){return}var a=e.Tag.render(r(),s,s,s,s);n.style.paddingLeft="57px";e.Dom.append(a,n.parentNode);var o=n.parentNode.querySelector("[data-role='flag']");if(e.Type.isDomNode(o)){e.Event.bind(n.parentNode.querySelector("[data-role='flag']"),"click",function(){i.showCountrySelector(s)})}var l=function t(e,n){return function(t){n.parentNode.querySelector("#phone_number_"+e).value=t.value;n.parentNode.querySelector("#phone_country_"+e).value=t.country}};this.inputStack[s]=new BX.PhoneNumber.Input({node:n,flagNode:n.parentNode.querySelector("[data-role='phone_flag_"+s+"']"),flagSize:16,onChange:l(s,n)});setTimeout(function(){if(!n.parentNode.querySelector("#phone_number_"+s).value){l(s,n)({value:i.inputStack[s].getValue(),country:i.inputStack[s].getCountry()})}},100)}},{key:"showCountrySelector",value:function t(e){this.inputStack[e]._onFlagClick()}}]);return t}();function o(){var t=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="invite-form-row">\n\t\t\t\t<div class="invite-form-col">\n\t\t\t\t\t<div class="ui-ctl-label-text">','</div>\n\t\t\t\t\t<div class="ui-ctl ui-ctl-w100 ui-ctl-textbox ui-ctl-block ui-ctl-after-icon">\n\t\t\t\t\t\t<input \n\t\t\t\t\t\t\ttype="text" \n\t\t\t\t\t\t\tclass="ui-ctl-element" \n\t\t\t\t\t\t\tvalue="" \n\t\t\t\t\t\t\tmaxlength="50"\n\t\t\t\t\t\t\tname="integrator_email" \n\t\t\t\t\t\t\tid="integrator_email" \n\t\t\t\t\t\t\tplaceholder="','"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<button class="ui-ctl-after ui-ctl-icon-clear" style="display: none"></button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t']);o=function e(){return t};return t}function l(){var t=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div>\n\t\t\t\t<div class="invite-form-row">\n\t\t\t\t\t<div class="invite-form-col">\n\t\t\t\t\t\t<div class="ui-ctl-label-text">','</div>\n\t\t\t\t\t\t<div class="ui-ctl ui-ctl-w100 ui-ctl-textbox ui-ctl-block ui-ctl-after-icon">\n\t\t\t\t\t\t\t<input type="text" name="ADD_NAME" id="ADD_NAME" class="ui-ctl-element">\n\t\t\t\t\t\t\t<button class="ui-ctl-after ui-ctl-icon-clear" style="display: none"></button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="invite-form-row">\n\t\t\t\t\t<div class="invite-form-col">\n\t\t\t\t\t\t<div class="ui-ctl-label-text">','</div>\n\t\t\t\t\t\t<div class="ui-ctl ui-ctl-w100 ui-ctl-textbox ui-ctl-block ui-ctl-after-icon">\n\t\t\t\t\t\t\t<input type="text" name="ADD_LAST_NAME" id="ADD_LAST_NAME" class="ui-ctl-element">\n\t\t\t\t\t\t\t<button class="ui-ctl-after ui-ctl-icon-clear" style="display: none"></button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="invite-form-row">\n\t\t\t\t\t<div class="invite-form-col">\n\t\t\t\t\t\t<div class="ui-ctl-label-text">','</div>\n\t\t\t\t\t\t<div class="ui-ctl ui-ctl-w100 ui-ctl-textbox ui-ctl-block ui-ctl-after-icon">\n\t\t\t\t\t\t\t<input type="text" name="ADD_EMAIL" id="ADD_EMAIL" class="ui-ctl-element" maxlength="50">\n\t\t\t\t\t\t\t<button class="ui-ctl-after ui-ctl-icon-clear" style="display: none"></button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="invite-form-row">\n\t\t\t\t\t<div class="invite-form-col">\n\t\t\t\t\t\t<div class="ui-ctl-label-text">','</div>\n\t\t\t\t\t\t<div class="ui-ctl ui-ctl-w100 ui-ctl-textbox ui-ctl-block ui-ctl-after-icon">\n\t\t\t\t\t\t\t<input type="text" name="ADD_POSITION" id="ADD_POSITION" class="ui-ctl-element">\n\t\t\t\t\t\t\t<button class="ui-ctl-after ui-ctl-icon-clear" style="display: none"></button>\n\t\t\t\t\t\t</div>\t\t\t\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t']);l=function e(){return t};return t}function c(){var t=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="invite-form-row js-form-row">\n\t\t\t\t<div class="invite-form-col">\n\t\t\t\t\t','\n\t\t\t\t\t<div class="ui-ctl ui-ctl-w100 ui-ctl-textbox ui-ctl-block ui-ctl-after-icon">\n\t\t\t\t\t\t<input \n\t\t\t\t\t\t\tname="EMAIL[]" \n\t\t\t\t\t\t\ttype="text" \n\t\t\t\t\t\t\tmaxlength="50"\n\t\t\t\t\t\t\tdata-num="','" \n\t\t\t\t\t\t\tclass="ui-ctl-element js-email-phone-input" \n\t\t\t\t\t\t\tplaceholder="','"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<button class="ui-ctl-after ui-ctl-icon-clear" style="display: none"></button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="invite-form-col">\n\t\t\t\t\t','\n\t\t\t\t\t<div class="ui-ctl ui-ctl-w100 ui-ctl-textbox ui-ctl-block ui-ctl-after-icon">\n\t\t\t\t\t\t<input name="NAME[]" type="text" class="ui-ctl-element" placeholder="','">\n\t\t\t\t\t\t<button class="ui-ctl-after ui-ctl-icon-clear" style="display: none"></button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="invite-form-col">\n\t\t\t\t\t','\n\t\t\t\t\t<div class="ui-ctl ui-ctl-w100 ui-ctl-textbox ui-ctl-block ui-ctl-after-icon">\n\t\t\t\t\t\t<input name="LAST_NAME[]" type="text" class="ui-ctl-element" placeholder="','">\n\t\t\t\t\t\t<button class="ui-ctl-after ui-ctl-icon-clear" style="display: none"></button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t']);c=function e(){return t};return t}function u(){var t=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\tname="EMAIL[]"\n\t\t\t\t\t\t\t\ttype="text"\n\t\t\t\t\t\t\t\tmaxlength="50"\n\t\t\t\t\t\t\t\tdata-num="','"\n\t\t\t\t\t\t\t\tclass="ui-ctl-element js-email-phone-input"\n\t\t\t\t\t\t\t\tplaceholder="','"\n\t\t\t\t\t\t\t/>']);u=function e(){return t};return t}var d=function(){function t(n,i){babelHelpers.classCallCheck(this,t);this.parent=n;this.contentBlock=i.contentBlock;this.inputNum=0;if(e.Type.isDomNode(this.contentBlock)){this.rowsContainer=this.contentBlock.querySelector("[data-role='rows-container']");this.bindActions()}if(this.parent.isInvitationBySmsAvailable){this.phoneObj=new a(this)}}babelHelpers.createClass(t,[{key:"bindActions",value:function t(){var n=this;var i=this.contentBlock.querySelector("[data-role='invite-more']");if(e.Type.isDomNode(i)){e.Event.unbindAll(i);e.Event.bind(i,"click",function(){n.renderInputRow()})}var s=this.contentBlock.querySelector("[data-role='invite-mass']");if(e.Type.isDomNode(s)){e.Event.unbindAll(s);e.Event.bind(s,"click",function(){var t=document.querySelector("[data-role='menu-mass-invite']");if(e.Type.isDomNode(t)){BX.fireEvent(t,"click")}})}}},{key:"checkPhoneInput",value:function t(e){var n=/^[\d+][\d\(\)\ -]{2,14}\d$/;if(e.value&&n.test(String(e.value).toLowerCase())){this.phoneObj.renderPhoneRow(e)}}},{key:"bindPhoneChecker",value:function t(n){var i=this;if(this.parent.isInvitationBySmsAvailable&&e.Type.isDomNode(n)){var s=Array.prototype.slice.call(n.querySelectorAll(".js-email-phone-input"));if(s){s.forEach(function(t){e.Event.bind(t,"input",function(){i.checkPhoneInput(t)})})}}}},{key:"bindCloseIcons",value:function t(n){var i=this;var s=Array.prototype.slice.call(n.querySelectorAll("input"));(s||[]).forEach(function(t){var n=t.nextElementSibling;e.Event.bind(t,"input",function(){e.Dom.style(n,"display",t.value!==""?"block":"none")});e.Event.bind(n,"click",function(s){s.preventDefault();t.value="";if(e.Type.isDomNode(t.parentNode)){var r=t.parentNode.querySelector("[data-role='phone-block']");if(e.Type.isDomNode(r)){var a=e.Tag.render(u(),t.getAttribute("data-num"),e.Loc.getMessage("INTRANET_INVITE_DIALOG_EMAIL_OR_PHONE_INPUT"));e.Dom.replace(t,a);i.bindCloseIcons(a.parentNode);i.bindPhoneChecker(a.parentNode);e.Dom.remove(r)}}e.Dom.style(n,"display","none")})})}},{key:"renderInviteInputs",value:function t(){var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:3;e.Dom.clean(this.rowsContainer);for(var i=0;i<n;i++){this.renderInputRow(i===0)}}},{key:"renderInputRow",value:function t(){var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;var i,s,r;if(n){i='\n\t\t\t\t<div class="ui-ctl-label-text">\n\t\t\t\t\t'.concat(e.Loc.getMessage("INTRANET_INVITE_DIALOG_EMAIL_OR_PHONE_INPUT"),"\n\t\t\t\t</div>");s='\n\t\t\t\t<div class="ui-ctl-label-text">\n\t\t\t\t\t'.concat(e.Loc.getMessage("BX24_INVITE_DIALOG_ADD_NAME_TITLE"),"\n\t\t\t\t</div>");r='\n\t\t\t\t<div class="ui-ctl-label-text">\n\t\t\t\t\t'.concat(e.Loc.getMessage("BX24_INVITE_DIALOG_ADD_LAST_NAME_TITLE"),"\n\t\t\t\t</div>")}var a=e.Tag.render(c(),n?i:"",this.inputNum++,e.Loc.getMessage("INTRANET_INVITE_DIALOG_EMAIL_OR_PHONE_INPUT"),n?s:"",e.Loc.getMessage("BX24_INVITE_DIALOG_ADD_NAME_TITLE"),n?r:"",e.Loc.getMessage("BX24_INVITE_DIALOG_ADD_LAST_NAME_TITLE"));e.Dom.append(a,this.rowsContainer);this.bindCloseIcons(a);this.bindPhoneChecker(a)}},{key:"renderRegisterInputs",value:function t(){e.Dom.clean(this.rowsContainer);var n=e.Tag.render(l(),e.Loc.getMessage("BX24_INVITE_DIALOG_ADD_NAME_TITLE"),e.Loc.getMessage("BX24_INVITE_DIALOG_ADD_LAST_NAME_TITLE"),e.Loc.getMessage("BX24_INVITE_DIALOG_ADD_EMAIL_TITLE"),e.Loc.getMessage("BX24_INVITE_DIALOG_ADD_POSITION_TITLE"));e.Dom.append(n,this.rowsContainer);this.bindCloseIcons(n)}},{key:"renderIntegratorInput",value:function t(){e.Dom.clean(this.rowsContainer);var n=e.Tag.render(o(),e.Loc.getMessage("INTRANET_INVITE_DIALOG_INTEGRATOR_EMAIL"),e.Loc.getMessage("INTRANET_INVITE_DIALOG_INTEGRATOR_EMAIL"));e.Dom.append(n,this.rowsContainer);this.bindCloseIcons(n)}}]);return t}();var v=function(t){babelHelpers.inherits(n,t);function n(t){var r;babelHelpers.classCallCheck(this,n);r=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(n).call(this));var a=e.Type.isPlainObject(t)?t:{};r.signedParameters=a.signedParameters;r.componentName=a.componentName;r.menuContainer=a.menuContainerNode;r.contentContainer=a.contentContainerNode;r.contentBlocks={};r.userOptions=a.userOptions;r.isExtranetInstalled=a.isExtranetInstalled==="Y";r.isCloud=a.isCloud==="Y";r.isInvitationBySmsAvailable=a.isInvitationBySmsAvailable==="Y";r.isCreatorEmailConfirmed=a.isCreatorEmailConfirmed==="Y";r.regenerateUrlBase=a.regenerateUrlBase;if(e.Type.isDomNode(r.contentContainer)){var o=Array.prototype.slice.call(r.contentContainer.querySelectorAll(".js-intranet-invitation-block"));(o||[]).forEach(function(t){var e=t.getAttribute("data-role");e=e.replace("-block","");r.contentBlocks[e]=t});r.errorMessageBlock=r.contentContainer.querySelector("[data-role='error-message']");r.successMessageBlock=r.contentContainer.querySelector("[data-role='success-message']");BX.UI.Hint.init(r.contentContainer)}r.button=document.querySelector("#intranet-invitation-btn");if(e.Type.isDomNode(r.menuContainer)){r.menuItems=Array.prototype.slice.call(r.menuContainer.querySelectorAll("a"));(r.menuItems||[]).forEach(function(t){e.Event.bind(t,"click",function(){r.changeContent(t.getAttribute("data-action"))})});r.changeContent(r.menuItems[0].getAttribute("data-action"))}r.submit=new i(babelHelpers.assertThisInitialized(r));r.submit.subscribe("onInputError",function(t){r.showErrorMessage(t.data.error)});if(r.isCloud){r.selfRegister=new s(babelHelpers.assertThisInitialized(r))}return r}babelHelpers.createClass(n,[{key:"changeContent",value:function t(n){this.hideErrorMessage();this.hideSuccessMessage();if(n.length>0){for(var i in this.contentBlocks){var s=this.contentBlocks[i];if(i===n){e.Dom.removeClass(s,"invite-block-hidden");e.Dom.addClass(s,"invite-block-shown");var r={contentBlock:this.contentBlocks[n]};var a=new d(this,r);if(n==="invite"){a.renderInviteInputs(5)}else if(n==="invite-with-group-dp"){a.renderInviteInputs(3)}else if(n==="extranet"){a.renderInviteInputs(3)}else if(n==="add"){a.renderRegisterInputs()}else if(n==="integrator"){a.renderIntegratorInput()}}else{e.Dom.removeClass(s,"invite-block-shown");e.Dom.addClass(s,"invite-block-hidden")}}this.changeButton(n)}}},{key:"changeButton",value:function t(n){var i=this;e.Event.unbindAll(this.button,"click");if(!this.isCreatorEmailConfirmed){e.Event.bind(this.button,"click",function(){i.showErrorMessage(e.Loc.getMessage("INTRANET_INVITE_DIALOG_CONFIRM_CREATOR_EMAIL_ERROR"))});return}if(n==="invite"){this.button.innerText=e.Loc.getMessage("BX24_INVITE_DIALOG_ACTION_INVITE");e.Event.bind(this.button,"click",function(){i.submit.submitInvite()})}else if(n==="mass-invite"){this.button.innerText=e.Loc.getMessage("BX24_INVITE_DIALOG_ACTION_INVITE");e.Event.bind(this.button,"click",function(){i.submit.submitMassInvite()})}else if(n==="invite-with-group-dp"){this.button.innerText=e.Loc.getMessage("BX24_INVITE_DIALOG_ACTION_INVITE");e.Event.bind(this.button,"click",function(){i.submit.submitInviteWithGroupDp()})}else if(n==="add"){this.button.innerText=e.Loc.getMessage("BX24_INVITE_DIALOG_ACTION_ADD");e.Event.bind(this.button,"click",function(){i.submit.submitAdd()})}else if(n==="self"){this.button.innerText=e.Loc.getMessage("BX24_INVITE_DIALOG_ACTION_SAVE");e.Event.bind(this.button,"click",function(){i.submit.submitSelf()})}else if(n==="integrator"){this.button.innerText=e.Loc.getMessage("BX24_INVITE_DIALOG_ACTION_INVITE");e.Event.bind(this.button,"click",function(){i.submit.submitIntegrator()})}else if(n==="extranet"){this.button.innerText=e.Loc.getMessage("BX24_INVITE_DIALOG_ACTION_INVITE");e.Event.bind(this.button,"click",function(){i.submit.submitExtranet()})}else if(n==="success"){this.button.innerText=e.Loc.getMessage("BX24_INVITE_DIALOG_ACTION_INVITE_MORE");e.Event.bind(this.button,"click",function(){BX.fireEvent(i.menuItems[0],"click")})}}},{key:"showSuccessMessage",value:function t(n){this.hideErrorMessage();if(e.Type.isDomNode(this.successMessageBlock)){this.successMessageBlock.style.display="block";var i=this.successMessageBlock.querySelector(".ui-alert-message");if(e.Type.isDomNode(i)){i.innerHTML=BX.util.htmlspecialchars(n)}}}},{key:"hideSuccessMessage",value:function t(){if(e.Type.isDomNode(this.successMessageBlock)){this.successMessageBlock.style.display="none"}}},{key:"showErrorMessage",value:function t(n){this.hideSuccessMessage();if(e.Type.isDomNode(this.errorMessageBlock)&&n){this.errorMessageBlock.style.display="block";var i=this.errorMessageBlock.querySelector(".ui-alert-message");if(e.Type.isDomNode(i)){i.innerHTML=BX.util.htmlspecialchars(n)}}}},{key:"hideErrorMessage",value:function t(){if(e.Type.isDomNode(this.errorMessageBlock)){this.errorMessageBlock.style.display="none"}}}]);return n}(n.EventEmitter);t.Form=v})(this.BX.Intranet.Invitation=this.BX.Intranet.Invitation||{},BX,BX.Event);
//# sourceMappingURL=script.map.js