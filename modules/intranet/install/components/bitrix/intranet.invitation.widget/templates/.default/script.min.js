this.BX=this.BX||{};(function(t,e,n,i,a,r,s,o){"use strict";var l=function(){function t(){babelHelpers.classCallCheck(this,t)}babelHelpers.createClass(t,null,[{key:"send",value:function n(i){e.sendData({tool:t.TOOLS,category:t.CATEGORY_INVITATION,event:i,p1:t.isAdmin?"isAdmin_Y":"isAdmin_N"})}},{key:"sendCreateCollab",value:function n(){e.sendData({tool:"im",category:"collab",event:"click_create_new",c_section:t.SECTION_POPUP,p2:"user_intranet"})}}]);return t}();babelHelpers.defineProperty(l,"TOOLS","headerPopup");babelHelpers.defineProperty(l,"TOOLS_LEGACY","Invitation");babelHelpers.defineProperty(l,"CATEGORY_INVITATION","invitation");babelHelpers.defineProperty(l,"CATEGORY_INVITATION_LEGACY","invitation");babelHelpers.defineProperty(l,"EVENT_NAME_LEGACY","drawer_open");babelHelpers.defineProperty(l,"SECTION_POPUP","headerPopup");babelHelpers.defineProperty(l,"EVENT_SHOW","show");babelHelpers.defineProperty(l,"EVENT_OPEN_SLIDER_INVITATION","drawer_open");babelHelpers.defineProperty(l,"EVENT_OPEN_STRUCTURE","vis_structure_open");babelHelpers.defineProperty(l,"EVENT_OPEN_USER_LIST","company_open");babelHelpers.defineProperty(l,"EVENT_OPEN_SLIDER_EXTRANET_INVITATION","extranetinvitation_open");babelHelpers.defineProperty(l,"isAdmin",false);function c(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function u(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?c(Object(n),!0).forEach((function(e){babelHelpers.defineProperty(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var p=function(t){babelHelpers.inherits(e,t);function e(t){var n;babelHelpers.classCallCheck(this,e);n=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(e).call(this));babelHelpers.defineProperty(babelHelpers.assertThisInitialized(n),"cache",new s.Cache.MemoryCache);n.setOptions(t);n.analytics=new l;return n}babelHelpers.createClass(e,[{key:"setOptions",value:function t(e){this.cache.set("options",u({},e))}},{key:"getOptions",value:function t(){return this.cache.get("options",{})}},{key:"getLayout",value:function t(){throw new Error("Must be implemented in a child class")}},{key:"showInfoHelper",value:function t(e){BX.UI.InfoHelper.show(e);this.sendAnalytics(e)}},{key:"sendAnalytics",value:function t(e){s.ajax.runAction("intranet.invitationwidget.analyticsLabel",{data:{},analyticsLabel:{helperCode:e,headerPopup:"Y"}})}},{key:"getHintPopup",value:function t(e,n,i){return this.cache.remember(i,(function(){return new a.Popup("bx-hint-".concat(s.Text.getRandom()),n,{content:e,className:"bx-invitation-warning",zIndex:15e3,angle:true,offsetTop:0,offsetLeft:40,closeIcon:false,autoHide:true,darkMode:true,overlay:false,maxWidth:300,events:{onShow:function t(e){r.EventEmitter.emit(r.EventEmitter.GLOBAL_TARGET,"BX.Intranet.InvitationWidget.HintPopup:show",new r.BaseEvent({data:{popup:e.target}}));var n=setTimeout((function(){e.target.close()}),4e3);r.EventEmitter.subscribeOnce(r.EventEmitter.GLOBAL_TARGET,"BX.Intranet.InvitationWidget.HintPopup:close",(function(){clearTimeout(n)}))},onClose:function t(){r.EventEmitter.emit(r.EventEmitter.GLOBAL_TARGET,"BX.Intranet.InvitationWidget.HintPopup:close")}}})}))}},{key:"showHintPopup",value:function t(e,n,i){this.getHintPopup(e,n,i).toggle()}},{key:"showInvitationPlace",value:function t(e,n,i){if(this.getOptions().isAdmin){this.showInvitationSlider(i)}else{if(this.getOptions().isInvitationAvailable){this.showInvitationSlider(i)}else{this.showHintPopup(e,n,"hint-"+i)}}}},{key:"showInvitationSlider",value:function t(e){var n=this.getOptions().invitationLink;if(e==="extranet"){n="".concat(n,"&firstInvitationBlock=extranet");l.send(l.EVENT_OPEN_SLIDER_EXTRANET_INVITATION)}else{l.send(l.EVENT_OPEN_SLIDER_INVITATION)}BX.SidePanel.Instance.open(n,{cacheable:false,allowChangeHistory:false,width:1100})}},{key:"getConfig",value:function t(){return{html:this.getLayout()}}}]);return e}(r.EventEmitter);var v;var b=function(t){babelHelpers.inherits(e,t);function e(t){var n;babelHelpers.classCallCheck(this,e);n=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(e).call(this,t));n.setEventNamespace("BX.Intranet.InvitationWidget.InvitationContent");n.setOptions(t);return n}babelHelpers.createClass(e,[{key:"getConfig",value:function t(){return{html:this.getLayout(),backgroundColor:"#14bfd5"}}},{key:"getLayout",value:function t(){var e=this;return this.cache.remember("layout",(function(){var t=function t(n){n.stopPropagation();e.showInvitationPlace(s.Loc.getMessage("INTRANET_INVITATION_WIDGET_DISABLED_TEXT"),n.target,"default-invitation")};var n=function t(){e.showInfoHelper("limit_why_team_invites")};return s.Tag.render(v||(v=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div class="intranet-invitation-widget-invite">\n\t\t\t\t\t<div class="intranet-invitation-widget-invite-main">\n\t\t\t\t\t\t<div class="intranet-invitation-widget-inner">\n\t\t\t\t\t\t\t<div class="intranet-invitation-widget-content">\n\t\t\t\t\t\t\t\t<div class="intranet-invitation-widget-item-icon intranet-invitation-widget-item-icon--invite"></div>\n\t\t\t\t\t\t\t\t<div class="intranet-invitation-widget-item-content">\n\t\t\t\t\t\t\t\t\t<div class="intranet-invitation-widget-item-name">\n\t\t\t\t\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t\t\t\t\t','\n\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div class="intranet-invitation-widget-item-link">\n\t\t\t\t\t\t\t\t\t\t<span onclick="','" class="intranet-invitation-widget-item-link-text">\n\t\t\t\t\t\t\t\t\t\t\t','\n\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<a onclick="','" class="intranet-invitation-widget-item-btn intranet-invitation-widget-item-btn--invite"> \n\t\t\t\t\t\t\t\t',"\n\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t"])),s.Loc.getMessage("INTRANET_INVITATION_WIDGET_INVITE_EMPLOYEE"),n,s.Loc.getMessage("INTRANET_INVITATION_WIDGET_DESC"),t,s.Loc.getMessage("INTRANET_INVITATION_WIDGET_INVITE"))}))}}]);return e}(p);var d;function h(t,e){g(t,e);e.add(t)}function g(t,e){if(e.has(t)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}function m(t,e,n){if(!e.has(t)){throw new TypeError("attempted to get private field on non-instance")}return n}var f=new WeakSet;var T=new WeakSet;var I=new WeakSet;var w=new WeakSet;var E=new WeakSet;var O=function(t){babelHelpers.inherits(e,t);function e(t){var n;babelHelpers.classCallCheck(this,e);n=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(e).call(this,t));h(babelHelpers.assertThisInitialized(n),E);h(babelHelpers.assertThisInitialized(n),w);h(babelHelpers.assertThisInitialized(n),I);h(babelHelpers.assertThisInitialized(n),T);h(babelHelpers.assertThisInitialized(n),f);n.setEventNamespace("BX.Intranet.InvitationWidget.StructureContent");return n}babelHelpers.createClass(e,[{key:"getConfig",value:function t(){m(this,T,C).call(this);if(this.getOptions().shouldShowStructureCounter){r.EventEmitter.subscribeOnce("HR.company-structure:first-popup-showed",m(this,E,P).bind(this))}return{html:this.getLayout(),flex:3}}},{key:"getLayout",value:function t(){var e=this;return this.cache.remember("layout",(function(){var t=function t(){l.send(l.EVENT_OPEN_STRUCTURE)};return s.Tag.render(d||(d=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div class="intranet-invitation-widget-item intranet-invitation-widget-item--company intranet-invitation-widget-item--active">\n\t\t\t\t\t<div class="intranet-invitation-widget-item-logo"></div>\n\t\t\t\t\t<div class="intranet-invitation-widget-item-content">\n\t\t\t\t\t\t<div class="intranet-invitation-widget-item-name">\n\t\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t\t','\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<a onclick="','" href="','" class="intranet-invitation-widget-item-btn"> \n\t\t\t\t\t\t\t',"\n\t\t\t\t\t\t</a>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t"])),s.Loc.getMessage("INTRANET_INVITATION_WIDGET_STRUCTURE"),t,e.getOptions().link,s.Loc.getMessage("INTRANET_INVITATION_WIDGET_EDIT"))}))}}]);return e}(p);function y(){var t=this;return this.cache.remember("counter-wrapper",(function(){return t.getLayout().querySelector(".intranet-invitation-widget-item-name")}))}function C(){if(m(this,w,N).call(this)>0){s.Dom.addClass(m(this,I,H).call(this).getContainer(),"invitation-structure-counter");m(this,I,H).call(this).renderTo(m(this,f,y).call(this))}}function H(){var t=this;return this.cache.remember("counter",(function(){return new i.Counter({value:m(t,w,N).call(t),color:i.Counter.Color.DANGER})}))}function N(){return this.getOptions().shouldShowStructureCounter?1:0}function P(){var t=m(this,I,H).call(this).value;if(!s.Type.isNumber(t)){return}if(!this.getOptions().shouldShowStructureCounter){return}this.getOptions().shouldShowStructureCounter=false;m(this,I,H).call(this).destroy();this.cache["delete"]("counter")}var _,A,L;function k(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function S(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?k(Object(n),!0).forEach((function(e){babelHelpers.defineProperty(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):k(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function R(t,e){W(t,e);e.add(t)}function G(t,e,n){W(t,e);e.set(t,n)}function W(t,e){if(e.has(t)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}function B(t,e,n){if(!e.has(t)){throw new TypeError("attempted to get private field on non-instance")}return n}var D=new WeakMap;var M=new WeakSet;var z=new WeakSet;var j=new WeakSet;var X=new WeakSet;var V=function(t){babelHelpers.inherits(e,t);function e(t){var n;babelHelpers.classCallCheck(this,e);n=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(e).call(this,t));R(babelHelpers.assertThisInitialized(n),X);R(babelHelpers.assertThisInitialized(n),j);R(babelHelpers.assertThisInitialized(n),z);R(babelHelpers.assertThisInitialized(n),M);G(babelHelpers.assertThisInitialized(n),D,{writable:true,value:void 0});n.setEventNamespace("BX.Intranet.InvitationWidget.EmployeesContent");return n}babelHelpers.createClass(e,[{key:"getConfig",value:function t(){var e=this;return{html:this.getOptions().awaitData.then((function(t){e.setOptions(S(S({},t.data.users),e.getOptions()));B(e,M,x).call(e);return e.getLayout()})),flex:5,sizeLoader:55}}},{key:"getLayout",value:function t(){var e=this;return this.cache.remember("layout",(function(){return s.Tag.render(_||(_=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div class="intranet-invitation-widget-item intranet-invitation-widget-item--emp ','">\n\t\t\t\t\t<div class="intranet-invitation-widget-inner">\n\t\t\t\t\t\t<div class="intranet-invitation-widget-content">\n\t\t\t\t\t\t\t<div class="intranet-invitation-widget-item-content">\n\t\t\t\t\t\t\t\t<div onclick="','" class="intranet-invitation-widget-item-progress ','"/>\n\t\t\t\t\t\t\t\t<div class="intranet-invitation-widget-employees">\n\t\t\t\t\t\t\t\t\t<div onclick="','" class="intranet-invitation-widget-item-name">\n\t\t\t\t\t\t\t\t\t\t<span style="margin-right: 2px;">\n\t\t\t\t\t\t\t\t\t\t\t','\n\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div onclick="','" class="intranet-invitation-widget-item-num">\n\t\t\t\t\t\t\t\t\t\t',"\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t","\n\t\t\t\t\t\t\t","\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t"])),e.getOptions().isLimit?"intranet-invitation-widget-item--emp-alert":null,e.showUserList(),e.getOptions().isLimit?"intranet-invitation-widget-item-progress--crit":"intranet-invitation-widget-item-progress--full",e.showUserList(),s.Loc.getMessage("INTRANET_INVITATION_WIDGET_EMPLOYEES"),e.showUserList(),e.getOptions().currentUserCountMessage,e.getDetail(),e.getOptions().isAdmin?e.getSelectorRights():null)}))}},{key:"getDetail",value:function t(){var e=this;return this.cache.remember("detail",(function(){var t="";if(Number(e.getOptions().maxUserCount)===0){t=s.Loc.getMessage("INTRANET_INVITATION_WIDGET_EMPLOYEES_NO_LIMIT")}else if(e.getOptions().isLimit){t=s.Loc.getMessage("INTRANET_INVITATION_WIDGET_EMPLOYEES_LIMIT")}else{t=e.getOptions().leftCountMessage}return s.Tag.render(A||(A=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div onclick="','" class="intranet-invitation-widget-item-detail">\n\t\t\t\t\t<span class="intranet-invitation-widget-item-link-text">\n\t\t\t\t\t\t',"\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t"])),e.showUserList(),t)}))}},{key:"showUserList",value:function t(){return this.cache.remember("showUserList",(function(){return function(){l.send(l.EVENT_OPEN_USER_LIST);document.location.href="/company/"}}))}},{key:"getSelectorRights",value:function t(){var e=this;return this.cache.remember("selector-rights",(function(){var t=function t(n){n.stopPropagation();e.getRightsMenu(n.target).toggle()};var n=s.Tag.render(L||(L=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div onclick="','" class="intranet-invitation-widget-item-menu"></div>\n\t\t\t'])),t);e.subscribe("right-selected",(function(t){var i=e.getRightsMenu(n);i.close();i.destroy();if(t.data.type){e.cache["delete"]("menu-rights");babelHelpers.classPrivateFieldSet(e,D,t.data.type)}}));return n}))}},{key:"getRightsMenu",value:function t(e){var n=this;return this.cache.remember("menu-rights",(function(){return new a.Menu("menu-rights-".concat(s.Text.getRandom()),e,n.getMenuRightsItems(),{autoHide:true,offsetLeft:10,offsetTop:0,angle:true,className:"license-right-popup-men",events:{onPopupShow:function t(e){r.EventEmitter.emit(r.EventEmitter.GLOBAL_TARGET,n.getEventNamespace()+":showRightMenu",new r.BaseEvent({data:{popup:e}}))},onPopupClose:function t(e){r.EventEmitter.emit(r.EventEmitter.GLOBAL_TARGET,n.getEventNamespace()+":closeRightMenu",new r.BaseEvent({data:{popup:e}}))},onPopupFirstShow:function t(e){r.EventEmitter.subscribe(r.EventEmitter.GLOBAL_TARGET,"SidePanel.Slider:onOpenStart",(function(){e.close()}))}}})}))}},{key:"getMenuRightsItems",value:function t(){var e=this;if(!babelHelpers.classPrivateFieldGet(this,D)){babelHelpers.classPrivateFieldSet(this,D,this.getOptions().rightType)}return[{text:s.Loc.getMessage("INTRANET_INVITATION_WIDGET_SETTING_ALL_INVITE"),className:babelHelpers.classPrivateFieldGet(this,D)==="all"?"menu-popup-item-accept":"",onclick:function t(){e.saveInvitationRightSetting("all").then((function(){e.emit("right-selected",new r.BaseEvent({data:{type:"all"}}))}))}},{text:s.Loc.getMessage("INTRANET_INVITATION_WIDGET_SETTING_ADMIN_INVITE"),className:babelHelpers.classPrivateFieldGet(this,D)==="admin"?"menu-popup-item-accept":"",onclick:function t(){e.saveInvitationRightSetting("admin").then((function(){e.emit("right-selected",new r.BaseEvent({data:{type:"admin"}}))}))}}]}},{key:"saveInvitationRightSetting",value:function t(e){return s.ajax.runAction("intranet.invitationwidget.saveInvitationRight",{data:{type:e}})}}]);return e}(p);function x(){if(this.getOptions().invitationCounter>0){B(this,j,F).call(this).renderTo(B(this,X,Y).call(this))}BX.addCustomEvent("onPullEvent-main",B(this,z,U).bind(this))}function U(t,e){if(t==="user_counter"&&e[BX.message("SITE_ID")]){var n=BX.clone(e[BX.message("SITE_ID")]);var i=n[this.getOptions().counterId];if(!s.Type.isNumber(i)){return}B(this,j,F).call(this).update(i);this.getOptions().invitationCounter=i;if(i>0){B(this,j,F).call(this).renderTo(B(this,X,Y).call(this))}else{B(this,j,F).call(this).destroy();this.cache["delete"]("counter")}}}function F(){var t=this;return this.cache.remember("counter",(function(){return new i.Counter({value:Number(t.getOptions().invitationCounter),color:i.Counter.Color.DANGER})}))}function Y(){var t=this;return this.cache.remember("counter-wrapper",(function(){return t.getLayout().querySelector(".intranet-invitation-widget-item-name")}))}var q,J;function K(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function Q(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?K(Object(n),!0).forEach((function(e){babelHelpers.defineProperty(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):K(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Z=function(t){babelHelpers.inherits(e,t);function e(t){var n;babelHelpers.classCallCheck(this,e);n=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(e).call(this,t));babelHelpers.defineProperty(babelHelpers.assertThisInitialized(n),"articleCode","6770709");n.setEventNamespace("BX.Intranet.InvitationWidget.ExtranetContent");return n}babelHelpers.createClass(e,[{key:"getConfig",value:function t(){var e=this;return{html:this.getOptions().awaitData.then((function(t){e.setOptions(Q(Q({},t.data.users),e.getOptions()));return e.getLayout()})),minHeight:"55px",sizeLoader:37,marginBottom:24,secondary:true}}},{key:"getLayout",value:function t(){var e=this;return this.cache.remember("layout",(function(){var t=function t(n){n.stopPropagation();e.showInvitationPlace(s.Loc.getMessage("INTRANET_INVITATION_WIDGET_DISABLED_TEXT"),n.target,"extranet")};var n=function t(){BX.Helper.show("redirect=detail&code=".concat(e.articleCode));e.sendAnalytics(e.articleCode)};return s.Tag.render(q||(q=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div class="','">\n\t\t\t\t\t<div class="intranet-invitation-widget-content">\n\t\t\t\t\t\t<div class="intranet-invitation-widget-item-icon intranet-invitation-widget-item-icon--ext"></div>\n\t\t\t\t\t\t<div class="intranet-invitation-widget-item-content">\n\t\t\t\t\t\t\t<div class="intranet-invitation-widget-item-name">\n\t\t\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t\t\t','\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="intranet-invitation-widget-item-link">\n\t\t\t\t\t\t\t\t<span onclick="','" class="intranet-invitation-widget-item-link-text">\n\t\t\t\t\t\t\t\t\t',"\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t",'\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<button onclick="','" class="intranet-invitation-widget-item-btn">\n\t\t\t\t\t\t',"\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t"])),e.getWrapperClass(),s.Loc.getMessage("INTRANET_INVITATION_WIDGET_EXTRANET"),n,s.Loc.getMessage("INTRANET_INVITATION_WIDGET_EXTRANET_DESC"),e.getCountUserMessage(),t,s.Loc.getMessage("INTRANET_INVITATION_WIDGET_INVITE"))}))}},{key:"getWrapperClass",value:function t(){var e=this;return this.cache.remember("wrapper-class",(function(){var t="intranet-invitation-widget-item intranet-invitation-widget-item--wide";if(e.getOptions().currentExtranetUserCount>0){return t+" intranet-invitation-widget-item--active"}return t}))}},{key:"getCountUserMessage",value:function t(){var e=this;return this.cache.remember("count-user-message",(function(){if(e.getOptions().currentExtranetUserCount>0){return s.Tag.render(J||(J=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<div class="intranet-invitation-widget-item-ext-users">\n\t\t\t\t\t\t',"\n\t\t\t\t\t</div>\n\t\t\t\t"])),e.getOptions().currentExtranetUserCountMessage)}return null}))}}]);return e}(p);var $;function tt(t,e,n){et(t,e);e.set(t,n)}function et(t,e){if(e.has(t)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}var nt=new WeakMap;var it=function(t){babelHelpers.inherits(e,t);function e(t){var n;babelHelpers.classCallCheck(this,e);n=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(e).call(this,t));babelHelpers.defineProperty(babelHelpers.assertThisInitialized(n),"articleCode","22706764");tt(babelHelpers.assertThisInitialized(n),nt,{writable:true,value:void 0});n.setEventNamespace("BX.Intranet.InvitationWidget.CollabContent");return n}babelHelpers.createClass(e,[{key:"getConfig",value:function t(){var e=this;return{html:this.getOptions().awaitData.then((function(t){var n=t.Messenger,i=t.CreatableChat;babelHelpers.classPrivateFieldSet(e,nt,(function(){n.openChatCreation(i.collab);l.sendCreateCollab()}));return e.getLayout()})),minHeight:"55px",sizeLoader:37,marginBottom:24,secondary:true}}},{key:"getLayout",value:function t(){var e=this;return this.cache.remember("layout",(function(){var t=function t(n){babelHelpers.classPrivateFieldGet(e,nt).call(e);n.stopPropagation()};var n=function t(){BX.Helper.show("redirect=detail&code=".concat(e.articleCode));e.sendAnalytics(e.articleCode)};return s.Tag.render($||($=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div class="','">\n\t\t\t\t\t<div class="intranet-invitation-widget-content">\n\t\t\t\t\t\t<div class="intranet-invitation-widget-item-icon intranet-invitation-widget-item-icon--collab">\n\t\t\t\t\t\t\t<div class="ui-icon-set --collab"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="intranet-invitation-widget-item-content">\n\t\t\t\t\t\t\t<div class="intranet-invitation-widget-item-name">\n\t\t\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t\t\t','\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="intranet-invitation-widget-item-link">\n\t\t\t\t\t\t\t\t<span onclick="','" class="intranet-invitation-widget-item-link-text">\n\t\t\t\t\t\t\t\t\t','\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<button onclick="','" class="intranet-invitation-widget-item-btn intranet-invitation-widget-item-btn--collab">\n\t\t\t\t\t\t',"\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t"])),e.getWrapperClass(),s.Loc.getMessage("INTRANET_INVITATION_WIDGET_COLLAB"),n,s.Loc.getMessage("INTRANET_INVITATION_WIDGET_COLLAB_DESC"),t,s.Loc.getMessage("INTRANET_INVITATION_WIDGET_COLLAB_CREATE"))}))}},{key:"getWrapperClass",value:function t(){return this.cache.remember("wrapper-class",(function(){return"intranet-invitation-widget-item intranet-invitation-widget-item--wide intranet-invitation-widget-item--collab"}))}}]);return e}(p);var at,rt;var st=function(t){babelHelpers.inherits(e,t);function e(){babelHelpers.classCallCheck(this,e);return babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(e).apply(this,arguments))}babelHelpers.createClass(e,[{key:"getLoader",value:function t(){return this.cache.remember("loader",(function(){return new o.Loader({size:45})}))}},{key:"getComponentContent",value:function t(){var e=this;return this.cache.remember("component-content",(function(){var t=s.Tag.render(at||(at=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div data-role="invitation-widget-ustat-online" class="invitation-widget-ustat-online"/>\n\t\t\t'])));s.Dom.style(t,"min-height","70px");e.getLoader().show(t);s.ajax.runAction("intranet.invitationwidget.getUserOnlineComponent").then((function(n){e.getLoader().hide();var i=n.data.assets;BX.load([].concat(babelHelpers.toConsumableArray(i["css"]),babelHelpers.toConsumableArray(i["js"])),(function(){s.Runtime.html(null,babelHelpers.toConsumableArray(i["string"]).join("\n"),{useAdjacentHTML:true}).then((function(){s.Runtime.html(t,n.data.html).then((function(){e.getLoader().destroy()}))}))}))}));return t}))}},{key:"getLayout",value:function t(){var e=this;return this.cache.remember("layout",(function(){return s.Tag.render(rt||(rt=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div class="intranet-invitation-widget-item intranet-invitation-widget-item--wide intranet-invitation-widget-item--no-padding">\n\t\t\t\t\t',"\n\t\t\t\t</div>\n\t\t\t"])),e.getComponentContent())}))}}]);return e}(p);function ot(t,e){ct(t,e);e.add(t)}function lt(t,e,n){ct(t,e);e.set(t,n)}function ct(t,e){if(e.has(t)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}function ut(t,e,n){if(!e.has(t)){throw new TypeError("attempted to get private field on non-instance")}return n}var pt=new WeakMap;var vt=new WeakSet;var bt=new WeakSet;var dt=new WeakSet;var ht=new WeakSet;var gt=new WeakSet;var mt=new WeakSet;var ft=new WeakSet;var Tt=new WeakSet;var It=new WeakSet;var wt=new WeakSet;var Et=function(t){babelHelpers.inherits(e,t);function e(t){var n;babelHelpers.classCallCheck(this,e);n=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(e).call(this));ot(babelHelpers.assertThisInitialized(n),wt);ot(babelHelpers.assertThisInitialized(n),It);ot(babelHelpers.assertThisInitialized(n),Tt);ot(babelHelpers.assertThisInitialized(n),ft);ot(babelHelpers.assertThisInitialized(n),mt);ot(babelHelpers.assertThisInitialized(n),gt);ot(babelHelpers.assertThisInitialized(n),ht);ot(babelHelpers.assertThisInitialized(n),dt);ot(babelHelpers.assertThisInitialized(n),bt);ot(babelHelpers.assertThisInitialized(n),vt);lt(babelHelpers.assertThisInitialized(n),pt,{writable:true,value:new s.Cache.MemoryCache});n.setEventNamespace("BX.Intranet.InvitationWidget.Popup");n.setOptions(t);ut(babelHelpers.assertThisInitialized(n),wt,kt).call(babelHelpers.assertThisInitialized(n));return n}babelHelpers.createClass(e,[{key:"setOptions",value:function t(e){babelHelpers.classPrivateFieldGet(this,pt).set("options",e)}},{key:"getOptions",value:function t(){return babelHelpers.classPrivateFieldGet(this,pt).get("options",{})}},{key:"show",value:function t(){this.getPopup().show()}},{key:"close",value:function t(){this.getPopup().close()}},{key:"getPopup",value:function t(){var e=this;return babelHelpers.classPrivateFieldGet(this,pt).remember("popup",(function(){return new n.PopupComponentsMaker({id:"invitation-popup",target:e.getOptions().target,width:350,content:ut(e,bt,yt).call(e)})}))}}]);return e}(r.EventEmitter);function Ot(){return babelHelpers.classPrivateFieldGet(this,pt).remember("await-data",(function(){return new Promise((function(t,e){s.ajax.runAction("intranet.invitationwidget.getData",{data:{},analyticsLabel:{headerPopup:"Y"}}).then(t)["catch"](e)}))}))}function yt(){var t=this;return babelHelpers.classPrivateFieldGet(this,pt).remember("content",(function(){return[ut(t,dt,Ct).call(t).getConfig(),{html:[ut(t,ht,Ht).call(t).getConfig(),ut(t,gt,Nt).call(t).getConfig()],marginBottom:24},t.getOptions().isExtranetAvailable?ut(t,mt,Pt).call(t).getConfig():null,t.getOptions().isCollabAvailable?ut(t,ft,_t).call(t).getConfig():null,ut(t,Tt,At).call(t).getConfig()]}))}function Ct(){var t=this;return babelHelpers.classPrivateFieldGet(this,pt).remember("invitation-content",(function(){return new b({isAdmin:t.getOptions().isAdmin,invitationLink:t.getOptions().params.invitationLink,isInvitationAvailable:t.getOptions().isInvitationAvailable})}))}function Ht(){var t=this;return babelHelpers.classPrivateFieldGet(this,pt).remember("structure-content",(function(){return new O({link:t.getOptions().params.structureLink,shouldShowStructureCounter:t.getOptions().params.shouldShowStructureCounter})}))}function Nt(){var t=this;return babelHelpers.classPrivateFieldGet(this,pt).remember("employees-content",(function(){return new V({isAdmin:t.getOptions().isAdmin,awaitData:ut(t,vt,Ot).call(t),invitationCounter:t.getOptions().params.invitationCounter,counterId:t.getOptions().params.counterId})}))}function Pt(){var t=this;return babelHelpers.classPrivateFieldGet(this,pt).remember("extranet-content",(function(){return new Z({isAdmin:t.getOptions().isAdmin,awaitData:ut(t,vt,Ot).call(t),invitationLink:t.getOptions().params.invitationLink,isInvitationAvailable:t.getOptions().isInvitationAvailable})}))}function _t(){var t=this;return babelHelpers.classPrivateFieldGet(this,pt).remember("collab-content",(function(){return new it({isAdmin:t.getOptions().isAdmin,awaitData:s.Runtime.loadExtension("im.public","im.v2.component.content.chat-forms.forms")})}))}function At(){return babelHelpers.classPrivateFieldGet(this,pt).remember("user-online-content",(function(){return new st}))}function Lt(){var t=this;return babelHelpers.classPrivateFieldGet(this,pt).remember("popup-container",(function(){return t.getPopup().getPopup().getPopupContainer()}))}function kt(){var t=this;var e=function e(n){if(n.data.popup){setTimeout((function(){s.Event.bind(ut(t,It,Lt).call(t),"click",(function(){n.data.popup.close()}))}),100)}};var n=function e(){t.close()};r.EventEmitter.subscribe(r.EventEmitter.GLOBAL_TARGET,"BX.Intranet.InvitationWidget.EmployeesContent:showRightMenu",e);r.EventEmitter.subscribe(r.EventEmitter.GLOBAL_TARGET,"BX.Intranet.InvitationWidget.HintPopup:show",e);r.EventEmitter.subscribe(r.EventEmitter.GLOBAL_TARGET,"BX.Intranet.UstatOnline:showPopup",e);r.EventEmitter.subscribe(r.EventEmitter.GLOBAL_TARGET,"SidePanel.Slider:onOpenStart",n)}function St(t,e){Gt(t,e);e.add(t)}function Rt(t,e,n){Gt(t,e);e.set(t,n)}function Gt(t,e){if(e.has(t)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}function Wt(t,e,n){if(!e.has(t)){throw new TypeError("attempted to get private field on non-instance")}return n}var Bt=new WeakMap;var Dt=new WeakSet;var Mt=new WeakSet;var zt=new WeakSet;var jt=new WeakSet;var Xt=new WeakSet;var Vt=new WeakSet;var xt=new WeakSet;var Ut=function(t){babelHelpers.inherits(e,t);function e(t){var n;babelHelpers.classCallCheck(this,e);n=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(e).call(this));St(babelHelpers.assertThisInitialized(n),xt);St(babelHelpers.assertThisInitialized(n),Vt);St(babelHelpers.assertThisInitialized(n),Xt);St(babelHelpers.assertThisInitialized(n),jt);St(babelHelpers.assertThisInitialized(n),zt);St(babelHelpers.assertThisInitialized(n),Mt);St(babelHelpers.assertThisInitialized(n),Dt);Rt(babelHelpers.assertThisInitialized(n),Bt,{writable:true,value:new s.Cache.MemoryCache});n.setEventNamespace("BX.Intranet.InvitationWidget");n.setOptions(t);l.isAdmin=n.getOptions().isCurrentUserAdmin;s.Event.bind(n.getOptions().button,"click",(function(){l.send(l.EVENT_SHOW);Wt(babelHelpers.assertThisInitialized(n),Xt,Kt).call(babelHelpers.assertThisInitialized(n)).show()}));r.EventEmitter.subscribe(r.EventEmitter.GLOBAL_TARGET,"BX.Bitrix24.NotifyPanel:showInvitationWidget",(function(){Wt(babelHelpers.assertThisInitialized(n),Xt,Kt).call(babelHelpers.assertThisInitialized(n)).show()}));Wt(babelHelpers.assertThisInitialized(n),Dt,Ft).call(babelHelpers.assertThisInitialized(n));return n}babelHelpers.createClass(e,[{key:"setOptions",value:function t(e){babelHelpers.classPrivateFieldGet(this,Bt).set("options",e)}},{key:"getOptions",value:function t(){return babelHelpers.classPrivateFieldGet(this,Bt).get("options",{})}}]);return e}(r.EventEmitter);function Ft(){if(this.getOptions().invitationCounter>0){Wt(this,jt,Jt).call(this).renderTo(Wt(this,zt,qt).call(this))}BX.addCustomEvent("onPullEvent-main",Wt(this,Mt,Yt).bind(this));if(this.getOptions().shouldShowStructureCounter){r.EventEmitter.subscribeOnce("HR.company-structure:first-popup-showed",Wt(this,xt,Zt).bind(this))}}function Yt(t,e){if(t==="user_counter"&&e[BX.message("SITE_ID")]){var n=BX.clone(e[BX.message("SITE_ID")]);var i=n[this.getOptions().counterId];if(!s.Type.isNumber(i)){return}if(this.getOptions().shouldShowStructureCounter){i++}Wt(this,jt,Jt).call(this).update(i);this.getOptions().invitationCounter=i;if(i>0){Wt(this,jt,Jt).call(this).renderTo(Wt(this,zt,qt).call(this))}else{Wt(this,jt,Jt).call(this).destroy();babelHelpers.classPrivateFieldGet(this,Bt)["delete"]("counter")}}}function qt(){var t=this;return babelHelpers.classPrivateFieldGet(this,Bt).remember("counter-wrapper",(function(){return t.getOptions().button.querySelector(".invitation-widget-counter")}))}function Jt(){var t=this;return babelHelpers.classPrivateFieldGet(this,Bt).remember("counter",(function(){return new i.Counter({value:Wt(t,Vt,Qt).call(t),color:i.Counter.Color.DANGER})}))}function Kt(){var t=this;return babelHelpers.classPrivateFieldGet(this,Bt).remember("popup",(function(){return new Et({isAdmin:t.getOptions().isCurrentUserAdmin,target:t.getOptions().button,isExtranetAvailable:t.getOptions().isExtranetAvailable,isCollabAvailable:t.getOptions().isCollabAvailable,isInvitationAvailable:t.getOptions().isInvitationAvailable,params:{structureLink:t.getOptions().structureLink,invitationLink:t.getOptions().invitationLink,invitationCounter:t.getOptions().invitationCounter,counterId:t.getOptions().counterId,shouldShowStructureCounter:t.getOptions().shouldShowStructureCounter}})}))}function Qt(){var t;var e=Number(this.getOptions().invitationCounter);if((t=this.getOptions().shouldShowStructureCounter)!==null&&t!==void 0?t:false){e++}return e}function Zt(){var t=Wt(this,jt,Jt).call(this).value;if(!s.Type.isNumber(t)){return}if(!this.getOptions().shouldShowStructureCounter){return}t--;this.getOptions().shouldShowStructureCounter=false;Wt(this,jt,Jt).call(this).update(t);this.getOptions().invitationCounter=t;if(t>0){Wt(this,jt,Jt).call(this).renderTo(Wt(this,zt,qt).call(this))}else{Wt(this,jt,Jt).call(this).destroy();babelHelpers.classPrivateFieldGet(this,Bt)["delete"]("counter")}}t.InvitationWidget=Ut})(this.BX.Intranet=this.BX.Intranet||{},BX.UI.Analytics,BX.UI,BX.UI,BX.Main,BX.Event,BX,BX);
//# sourceMappingURL=script.map.js