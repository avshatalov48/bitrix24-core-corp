this.BX=this.BX||{};(function(t,e,n,i,a,r,s,o){"use strict";var l=function(){function t(){babelHelpers.classCallCheck(this,t)}babelHelpers.createClass(t,[{key:"sendLegacy",value:function n(i){e.sendData({tool:t.TOOLS_LEGACY,category:t.CATEGORY_INVITATION_LEGACY,event:t.EVENT_NAME_LEGACY,c_section:i,p1:t.isAdmin?"isAdmin_Y":"isAdmin_N"})}}],[{key:"send",value:function n(i){e.sendData({tool:t.TOOLS,category:t.CATEGORY_INVITATION,event:i,p1:t.isAdmin?"isAdmin_Y":"isAdmin_N"})}}]);return t}();babelHelpers.defineProperty(l,"TOOLS","headerPopup");babelHelpers.defineProperty(l,"TOOLS_LEGACY","Invitation");babelHelpers.defineProperty(l,"CATEGORY_INVITATION","invitation");babelHelpers.defineProperty(l,"CATEGORY_INVITATION_LEGACY","invitation");babelHelpers.defineProperty(l,"EVENT_NAME_LEGACY","drawer_open");babelHelpers.defineProperty(l,"SECTION_POPUP","headerPopup");babelHelpers.defineProperty(l,"EVENT_SHOW","show");babelHelpers.defineProperty(l,"EVENT_OPEN_SLIDER_INVITATION","drawer_open");babelHelpers.defineProperty(l,"EVENT_OPEN_STRUCTURE","vis_structure_open");babelHelpers.defineProperty(l,"EVENT_OPEN_USER_LIST","company_open");babelHelpers.defineProperty(l,"EVENT_OPEN_SLIDER_EXTRANET_INVITATION","extranetinvitation_open");babelHelpers.defineProperty(l,"isAdmin",false);function c(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function u(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?c(Object(n),!0).forEach((function(e){babelHelpers.defineProperty(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var p=function(t){babelHelpers.inherits(e,t);function e(t){var n;babelHelpers.classCallCheck(this,e);n=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(e).call(this));babelHelpers.defineProperty(babelHelpers.assertThisInitialized(n),"cache",new s.Cache.MemoryCache);n.setOptions(t);n.analytics=new l;return n}babelHelpers.createClass(e,[{key:"setOptions",value:function t(e){this.cache.set("options",u({},e))}},{key:"getOptions",value:function t(){return this.cache.get("options",{})}},{key:"getLayout",value:function t(){throw new Error("Must be implemented in a child class")}},{key:"showInfoHelper",value:function t(e){BX.UI.InfoHelper.show(e);this.sendAnalytics(e)}},{key:"sendAnalytics",value:function t(e){s.ajax.runAction("intranet.invitationwidget.analyticsLabel",{data:{},analyticsLabel:{helperCode:e,headerPopup:"Y"}})}},{key:"getHintPopup",value:function t(e,n,i){return this.cache.remember(i,(function(){return new a.Popup("bx-hint-".concat(s.Text.getRandom()),n,{content:e,className:"bx-invitation-warning",zIndex:15e3,angle:true,offsetTop:0,offsetLeft:40,closeIcon:false,autoHide:true,darkMode:true,overlay:false,maxWidth:300,events:{onShow:function t(e){r.EventEmitter.emit(r.EventEmitter.GLOBAL_TARGET,"BX.Intranet.InvitationWidget.HintPopup:show",new r.BaseEvent({data:{popup:e.target}}));var n=setTimeout((function(){e.target.close()}),4e3);r.EventEmitter.subscribeOnce(r.EventEmitter.GLOBAL_TARGET,"BX.Intranet.InvitationWidget.HintPopup:close",(function(){clearTimeout(n)}))},onClose:function t(){r.EventEmitter.emit(r.EventEmitter.GLOBAL_TARGET,"BX.Intranet.InvitationWidget.HintPopup:close")}}})}))}},{key:"showHintPopup",value:function t(e,n,i){this.getHintPopup(e,n,i).toggle()}},{key:"showInvitationPlace",value:function t(e,n,i){if(this.getOptions().isAdmin){this.showInvitationSlider(i)}else{if(this.getOptions().isInvitationAvailable){this.showInvitationSlider(i)}else{this.showHintPopup(e,n,"hint-"+i)}}}},{key:"showInvitationSlider",value:function t(e){var n=this.getOptions().invitationLink;if(e==="extranet"){n="".concat(n,"&firstInvitationBlock=extranet");l.send(l.EVENT_OPEN_SLIDER_EXTRANET_INVITATION)}else{l.send(l.EVENT_OPEN_SLIDER_INVITATION)}this.analytics.sendLegacy(l.SECTION_POPUP);BX.SidePanel.Instance.open(n,{cacheable:false,allowChangeHistory:false,width:1100})}},{key:"getConfig",value:function t(){return{html:this.getLayout()}}}]);return e}(r.EventEmitter);var v;var b=function(t){babelHelpers.inherits(e,t);function e(t){var n;babelHelpers.classCallCheck(this,e);n=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(e).call(this,t));n.setEventNamespace("BX.Intranet.InvitationWidget.InvitationContent");n.setOptions(t);return n}babelHelpers.createClass(e,[{key:"getConfig",value:function t(){return{html:this.getLayout(),backgroundColor:"#14bfd5"}}},{key:"getLayout",value:function t(){var e=this;return this.cache.remember("layout",(function(){var t=function t(n){n.stopPropagation();e.showInvitationPlace(s.Loc.getMessage("INTRANET_INVITATION_WIDGET_DISABLED_TEXT"),n.target,"default-invitation")};var n=function t(){e.showInfoHelper("limit_why_team_invites")};return s.Tag.render(v||(v=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div class="intranet-invitation-widget-invite">\n\t\t\t\t\t<div class="intranet-invitation-widget-invite-main">\n\t\t\t\t\t\t<div class="intranet-invitation-widget-inner">\n\t\t\t\t\t\t\t<div class="intranet-invitation-widget-content">\n\t\t\t\t\t\t\t\t<div class="intranet-invitation-widget-item-icon intranet-invitation-widget-item-icon--invite"></div>\n\t\t\t\t\t\t\t\t<div class="intranet-invitation-widget-item-content">\n\t\t\t\t\t\t\t\t\t<div class="intranet-invitation-widget-item-name">\n\t\t\t\t\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t\t\t\t\t','\n\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div class="intranet-invitation-widget-item-link">\n\t\t\t\t\t\t\t\t\t\t<span onclick="','" class="intranet-invitation-widget-item-link-text">\n\t\t\t\t\t\t\t\t\t\t\t','\n\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<a onclick="','" class="intranet-invitation-widget-item-btn intranet-invitation-widget-item-btn--invite"> \n\t\t\t\t\t\t\t\t',"\n\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t"])),s.Loc.getMessage("INTRANET_INVITATION_WIDGET_INVITE_EMPLOYEE"),n,s.Loc.getMessage("INTRANET_INVITATION_WIDGET_DESC"),t,s.Loc.getMessage("INTRANET_INVITATION_WIDGET_INVITE"))}))}}]);return e}(p);var d;var g=function(t){babelHelpers.inherits(e,t);function e(t){var n;babelHelpers.classCallCheck(this,e);n=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(e).call(this,t));n.setEventNamespace("BX.Intranet.InvitationWidget.StructureContent");return n}babelHelpers.createClass(e,[{key:"getConfig",value:function t(){return{html:this.getLayout(),flex:3}}},{key:"getLayout",value:function t(){var e=this;return this.cache.remember("layout",(function(){var t=function t(){l.send(l.EVENT_OPEN_STRUCTURE)};return s.Tag.render(d||(d=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div class="intranet-invitation-widget-item intranet-invitation-widget-item--company intranet-invitation-widget-item--active">\n\t\t\t\t\t<div class="intranet-invitation-widget-item-logo"></div>\n\t\t\t\t\t<div class="intranet-invitation-widget-item-content">\n\t\t\t\t\t\t<div class="intranet-invitation-widget-item-name">\n\t\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t\t','\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<a onclick="','" href="','" class="intranet-invitation-widget-item-btn"> \n\t\t\t\t\t\t\t',"\n\t\t\t\t\t\t</a>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t"])),s.Loc.getMessage("INTRANET_INVITATION_WIDGET_STRUCTURE"),t,e.getOptions().link,s.Loc.getMessage("INTRANET_INVITATION_WIDGET_EDIT"))}))}}]);return e}(p);var h,m,f;function T(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function I(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?T(Object(n),!0).forEach((function(e){babelHelpers.defineProperty(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):T(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function E(t,e){w(t,e);e.add(t)}function O(t,e,n){w(t,e);e.set(t,n)}function w(t,e){if(e.has(t)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}function y(t,e,n){if(!e.has(t)){throw new TypeError("attempted to get private field on non-instance")}return n}var H=new WeakMap;var N=new WeakSet;var P=new WeakSet;var _=new WeakSet;var C=new WeakSet;var A=function(t){babelHelpers.inherits(e,t);function e(t){var n;babelHelpers.classCallCheck(this,e);n=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(e).call(this,t));E(babelHelpers.assertThisInitialized(n),C);E(babelHelpers.assertThisInitialized(n),_);E(babelHelpers.assertThisInitialized(n),P);E(babelHelpers.assertThisInitialized(n),N);O(babelHelpers.assertThisInitialized(n),H,{writable:true,value:void 0});n.setEventNamespace("BX.Intranet.InvitationWidget.EmployeesContent");return n}babelHelpers.createClass(e,[{key:"getConfig",value:function t(){var e=this;return{html:this.getOptions().awaitData.then((function(t){e.setOptions(I(I({},t.data.users),e.getOptions()));y(e,N,L).call(e);return e.getLayout()})),flex:5,sizeLoader:55}}},{key:"getLayout",value:function t(){var e=this;return this.cache.remember("layout",(function(){return s.Tag.render(h||(h=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div class="intranet-invitation-widget-item intranet-invitation-widget-item--emp ','">\n\t\t\t\t\t<div class="intranet-invitation-widget-inner">\n\t\t\t\t\t\t<div class="intranet-invitation-widget-content">\n\t\t\t\t\t\t\t<div class="intranet-invitation-widget-item-content">\n\t\t\t\t\t\t\t\t<div onclick="','" class="intranet-invitation-widget-item-progress ','"/>\n\t\t\t\t\t\t\t\t<div class="intranet-invitation-widget-employees">\n\t\t\t\t\t\t\t\t\t<div onclick="','" class="intranet-invitation-widget-item-name">\n\t\t\t\t\t\t\t\t\t\t<span style="margin-right: 2px;">\n\t\t\t\t\t\t\t\t\t\t\t','\n\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div onclick="','" class="intranet-invitation-widget-item-num">\n\t\t\t\t\t\t\t\t\t\t',"\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t","\n\t\t\t\t\t\t\t","\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t"])),e.getOptions().isLimit?"intranet-invitation-widget-item--emp-alert":null,e.showUserList(),e.getOptions().isLimit?"intranet-invitation-widget-item-progress--crit":"intranet-invitation-widget-item-progress--full",e.showUserList(),s.Loc.getMessage("INTRANET_INVITATION_WIDGET_EMPLOYEES"),e.showUserList(),e.getOptions().currentUserCountMessage,e.getDetail(),e.getOptions().isAdmin?e.getSelectorRights():null)}))}},{key:"getDetail",value:function t(){var e=this;return this.cache.remember("detail",(function(){var t="";if(Number(e.getOptions().maxUserCount)===0){t=s.Loc.getMessage("INTRANET_INVITATION_WIDGET_EMPLOYEES_NO_LIMIT")}else if(e.getOptions().isLimit){t=s.Loc.getMessage("INTRANET_INVITATION_WIDGET_EMPLOYEES_LIMIT")}else{t=e.getOptions().leftCountMessage}return s.Tag.render(m||(m=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div onclick="','" class="intranet-invitation-widget-item-detail">\n\t\t\t\t\t<span class="intranet-invitation-widget-item-link-text">\n\t\t\t\t\t\t',"\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t"])),e.showUserList(),t)}))}},{key:"showUserList",value:function t(){return this.cache.remember("showUserList",(function(){return function(){l.send(l.EVENT_OPEN_USER_LIST);document.location.href="/company/"}}))}},{key:"getSelectorRights",value:function t(){var e=this;return this.cache.remember("selector-rights",(function(){var t=function t(n){n.stopPropagation();e.getRightsMenu(n.target).toggle()};var n=s.Tag.render(f||(f=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div onclick="','" class="intranet-invitation-widget-item-menu"></div>\n\t\t\t'])),t);e.subscribe("right-selected",(function(t){var i=e.getRightsMenu(n);i.close();i.destroy();if(t.data.type){e.cache["delete"]("menu-rights");babelHelpers.classPrivateFieldSet(e,H,t.data.type)}}));return n}))}},{key:"getRightsMenu",value:function t(e){var n=this;return this.cache.remember("menu-rights",(function(){return new a.Menu("menu-rights-".concat(s.Text.getRandom()),e,n.getMenuRightsItems(),{autoHide:true,offsetLeft:10,offsetTop:0,angle:true,className:"license-right-popup-men",events:{onPopupShow:function t(e){r.EventEmitter.emit(r.EventEmitter.GLOBAL_TARGET,n.getEventNamespace()+":showRightMenu",new r.BaseEvent({data:{popup:e}}))},onPopupClose:function t(e){r.EventEmitter.emit(r.EventEmitter.GLOBAL_TARGET,n.getEventNamespace()+":closeRightMenu",new r.BaseEvent({data:{popup:e}}))},onPopupFirstShow:function t(e){r.EventEmitter.subscribe(r.EventEmitter.GLOBAL_TARGET,"SidePanel.Slider:onOpenStart",(function(){e.close()}))}}})}))}},{key:"getMenuRightsItems",value:function t(){var e=this;if(!babelHelpers.classPrivateFieldGet(this,H)){babelHelpers.classPrivateFieldSet(this,H,this.getOptions().rightType)}return[{text:s.Loc.getMessage("INTRANET_INVITATION_WIDGET_SETTING_ALL_INVITE"),className:babelHelpers.classPrivateFieldGet(this,H)==="all"?"menu-popup-item-accept":"",onclick:function t(){e.saveInvitationRightSetting("all").then((function(){e.emit("right-selected",new r.BaseEvent({data:{type:"all"}}))}))}},{text:s.Loc.getMessage("INTRANET_INVITATION_WIDGET_SETTING_ADMIN_INVITE"),className:babelHelpers.classPrivateFieldGet(this,H)==="admin"?"menu-popup-item-accept":"",onclick:function t(){e.saveInvitationRightSetting("admin").then((function(){e.emit("right-selected",new r.BaseEvent({data:{type:"admin"}}))}))}}]}},{key:"saveInvitationRightSetting",value:function t(e){return s.ajax.runAction("intranet.invitationwidget.saveInvitationRight",{data:{type:e}})}}]);return e}(p);function L(){if(this.getOptions().invitationCounter>0){y(this,_,S).call(this).renderTo(y(this,C,R).call(this))}BX.addCustomEvent("onPullEvent-main",y(this,P,k).bind(this))}function k(t,e){if(t==="user_counter"&&e[BX.message("SITE_ID")]){var n=BX.clone(e[BX.message("SITE_ID")]);var i=n[this.getOptions().counterId];if(!s.Type.isNumber(i)){return}y(this,_,S).call(this).update(i);this.getOptions().invitationCounter=i;if(i>0){y(this,_,S).call(this).renderTo(y(this,C,R).call(this))}else{y(this,_,S).call(this).destroy();this.cache["delete"]("counter")}}}function S(){var t=this;return this.cache.remember("counter",(function(){return new i.Counter({value:Number(t.getOptions().invitationCounter),color:i.Counter.Color.DANGER})}))}function R(){var t=this;return this.cache.remember("counter-wrapper",(function(){return t.getLayout().querySelector(".intranet-invitation-widget-item-name")}))}var G,B;function D(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function W(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?D(Object(n),!0).forEach((function(e){babelHelpers.defineProperty(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):D(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var M=function(t){babelHelpers.inherits(e,t);function e(t){var n;babelHelpers.classCallCheck(this,e);n=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(e).call(this,t));babelHelpers.defineProperty(babelHelpers.assertThisInitialized(n),"articleCode","6770709");n.setEventNamespace("BX.Intranet.InvitationWidget.ExtranetContent");return n}babelHelpers.createClass(e,[{key:"getConfig",value:function t(){var e=this;return{html:this.getOptions().awaitData.then((function(t){e.setOptions(W(W({},t.data.users),e.getOptions()));return e.getLayout()})),minHeight:"55px",sizeLoader:37,marginBottom:24,secondary:true}}},{key:"getLayout",value:function t(){var e=this;return this.cache.remember("layout",(function(){var t=function t(n){n.stopPropagation();e.showInvitationPlace(s.Loc.getMessage("INTRANET_INVITATION_WIDGET_DISABLED_TEXT"),n.target,"extranet")};var n=function t(){BX.Helper.show("redirect=detail&code=".concat(e.articleCode));e.sendAnalytics(e.articleCode)};return s.Tag.render(G||(G=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div class="','">\n\t\t\t\t\t<div class="intranet-invitation-widget-content">\n\t\t\t\t\t\t<div class="intranet-invitation-widget-item-icon intranet-invitation-widget-item-icon--ext"></div>\n\t\t\t\t\t\t<div class="intranet-invitation-widget-item-content">\n\t\t\t\t\t\t\t<div class="intranet-invitation-widget-item-name">\n\t\t\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t\t\t','\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="intranet-invitation-widget-item-link">\n\t\t\t\t\t\t\t\t<span onclick="','" class="intranet-invitation-widget-item-link-text">\n\t\t\t\t\t\t\t\t\t',"\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t",'\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<button onclick="','" class="intranet-invitation-widget-item-btn">\n\t\t\t\t\t\t',"\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t"])),e.getWrapperClass(),s.Loc.getMessage("INTRANET_INVITATION_WIDGET_EXTRANET"),n,s.Loc.getMessage("INTRANET_INVITATION_WIDGET_EXTRANET_DESC"),e.getCountUserMessage(),t,s.Loc.getMessage("INTRANET_INVITATION_WIDGET_INVITE"))}))}},{key:"getWrapperClass",value:function t(){var e=this;return this.cache.remember("wrapper-class",(function(){var t="intranet-invitation-widget-item intranet-invitation-widget-item--wide";if(e.getOptions().currentExtranetUserCount>0){return t+" intranet-invitation-widget-item--active"}return t}))}},{key:"getCountUserMessage",value:function t(){var e=this;return this.cache.remember("count-user-message",(function(){if(e.getOptions().currentExtranetUserCount>0){return s.Tag.render(B||(B=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<div class="intranet-invitation-widget-item-ext-users">\n\t\t\t\t\t\t',"\n\t\t\t\t\t</div>\n\t\t\t\t"])),e.getOptions().currentExtranetUserCountMessage)}return null}))}}]);return e}(p);var j,X;var V=function(t){babelHelpers.inherits(e,t);function e(){babelHelpers.classCallCheck(this,e);return babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(e).apply(this,arguments))}babelHelpers.createClass(e,[{key:"getLoader",value:function t(){return this.cache.remember("loader",(function(){return new o.Loader({size:45})}))}},{key:"getComponentContent",value:function t(){var e=this;return this.cache.remember("component-content",(function(){var t=s.Tag.render(j||(j=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div data-role="invitation-widget-ustat-online" class="invitation-widget-ustat-online"/>\n\t\t\t'])));s.Dom.style(t,"min-height","70px");e.getLoader().show(t);s.ajax.runAction("intranet.invitationwidget.getUserOnlineComponent").then((function(n){e.getLoader().hide();var i=n.data.assets;BX.load([].concat(babelHelpers.toConsumableArray(i["css"]),babelHelpers.toConsumableArray(i["js"])),(function(){s.Runtime.html(null,babelHelpers.toConsumableArray(i["string"]).join("\n"),{useAdjacentHTML:true}).then((function(){s.Runtime.html(t,n.data.html).then((function(){e.getLoader().destroy()}))}))}))}));return t}))}},{key:"getLayout",value:function t(){var e=this;return this.cache.remember("layout",(function(){return s.Tag.render(X||(X=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div class="intranet-invitation-widget-item intranet-invitation-widget-item--wide intranet-invitation-widget-item--no-padding">\n\t\t\t\t\t',"\n\t\t\t\t</div>\n\t\t\t"])),e.getComponentContent())}))}}]);return e}(p);function z(t,e){U(t,e);e.add(t)}function x(t,e,n){U(t,e);e.set(t,n)}function U(t,e){if(e.has(t)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}function F(t,e,n){if(!e.has(t)){throw new TypeError("attempted to get private field on non-instance")}return n}var Y=new WeakMap;var q=new WeakSet;var J=new WeakSet;var K=new WeakSet;var Q=new WeakSet;var Z=new WeakSet;var $=new WeakSet;var tt=new WeakSet;var et=new WeakSet;var nt=new WeakSet;var it=function(t){babelHelpers.inherits(e,t);function e(t){var n;babelHelpers.classCallCheck(this,e);n=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(e).call(this));z(babelHelpers.assertThisInitialized(n),nt);z(babelHelpers.assertThisInitialized(n),et);z(babelHelpers.assertThisInitialized(n),tt);z(babelHelpers.assertThisInitialized(n),$);z(babelHelpers.assertThisInitialized(n),Z);z(babelHelpers.assertThisInitialized(n),Q);z(babelHelpers.assertThisInitialized(n),K);z(babelHelpers.assertThisInitialized(n),J);z(babelHelpers.assertThisInitialized(n),q);x(babelHelpers.assertThisInitialized(n),Y,{writable:true,value:new s.Cache.MemoryCache});n.setEventNamespace("BX.Intranet.InvitationWidget.Popup");n.setOptions(t);F(babelHelpers.assertThisInitialized(n),nt,vt).call(babelHelpers.assertThisInitialized(n));return n}babelHelpers.createClass(e,[{key:"setOptions",value:function t(e){babelHelpers.classPrivateFieldGet(this,Y).set("options",e)}},{key:"getOptions",value:function t(){return babelHelpers.classPrivateFieldGet(this,Y).get("options",{})}},{key:"show",value:function t(){this.getPopup().show()}},{key:"close",value:function t(){this.getPopup().close()}},{key:"getPopup",value:function t(){var e=this;return babelHelpers.classPrivateFieldGet(this,Y).remember("popup",(function(){return new n.PopupComponentsMaker({id:"invitation-popup",target:e.getOptions().target,width:350,content:F(e,J,rt).call(e)})}))}}]);return e}(r.EventEmitter);function at(){return babelHelpers.classPrivateFieldGet(this,Y).remember("await-data",(function(){return new Promise((function(t,e){s.ajax.runAction("intranet.invitationwidget.getData",{data:{},analyticsLabel:{headerPopup:"Y"}}).then(t)["catch"](e)}))}))}function rt(){var t=this;return babelHelpers.classPrivateFieldGet(this,Y).remember("content",(function(){return[F(t,K,st).call(t).getConfig(),{html:[F(t,Q,ot).call(t).getConfig(),F(t,Z,lt).call(t).getConfig()],marginBottom:24},t.getOptions().isExtranetAvailable?F(t,$,ct).call(t).getConfig():null,F(t,tt,ut).call(t).getConfig()]}))}function st(){var t=this;return babelHelpers.classPrivateFieldGet(this,Y).remember("invitation-content",(function(){return new b({isAdmin:t.getOptions().isAdmin,invitationLink:t.getOptions().params.invitationLink,isInvitationAvailable:t.getOptions().isInvitationAvailable})}))}function ot(){var t=this;return babelHelpers.classPrivateFieldGet(this,Y).remember("structure-content",(function(){return new g({link:t.getOptions().params.structureLink})}))}function lt(){var t=this;return babelHelpers.classPrivateFieldGet(this,Y).remember("employees-content",(function(){return new A({isAdmin:t.getOptions().isAdmin,awaitData:F(t,q,at).call(t),invitationCounter:t.getOptions().params.invitationCounter,counterId:t.getOptions().params.counterId})}))}function ct(){var t=this;return babelHelpers.classPrivateFieldGet(this,Y).remember("extranet-content",(function(){return new M({isAdmin:t.getOptions().isAdmin,awaitData:F(t,q,at).call(t),invitationLink:t.getOptions().params.invitationLink,isInvitationAvailable:t.getOptions().isInvitationAvailable})}))}function ut(){return babelHelpers.classPrivateFieldGet(this,Y).remember("user-online-content",(function(){return new V}))}function pt(){var t=this;return babelHelpers.classPrivateFieldGet(this,Y).remember("popup-container",(function(){return t.getPopup().getPopup().getPopupContainer()}))}function vt(){var t=this;var e=function e(n){if(n.data.popup){setTimeout((function(){s.Event.bind(F(t,et,pt).call(t),"click",(function(){n.data.popup.close()}))}),100)}};var n=function e(){t.close()};r.EventEmitter.subscribe(r.EventEmitter.GLOBAL_TARGET,"BX.Intranet.InvitationWidget.EmployeesContent:showRightMenu",e);r.EventEmitter.subscribe(r.EventEmitter.GLOBAL_TARGET,"BX.Intranet.InvitationWidget.HintPopup:show",e);r.EventEmitter.subscribe(r.EventEmitter.GLOBAL_TARGET,"BX.Intranet.UstatOnline:showPopup",e);r.EventEmitter.subscribe(r.EventEmitter.GLOBAL_TARGET,"SidePanel.Slider:onOpenStart",n)}function bt(t,e){gt(t,e);e.add(t)}function dt(t,e,n){gt(t,e);e.set(t,n)}function gt(t,e){if(e.has(t)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}function ht(t,e,n){if(!e.has(t)){throw new TypeError("attempted to get private field on non-instance")}return n}var mt=new WeakMap;var ft=new WeakSet;var Tt=new WeakSet;var It=new WeakSet;var Et=new WeakSet;var Ot=new WeakSet;var wt=function(t){babelHelpers.inherits(e,t);function e(t){var n;babelHelpers.classCallCheck(this,e);n=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(e).call(this));bt(babelHelpers.assertThisInitialized(n),Ot);bt(babelHelpers.assertThisInitialized(n),Et);bt(babelHelpers.assertThisInitialized(n),It);bt(babelHelpers.assertThisInitialized(n),Tt);bt(babelHelpers.assertThisInitialized(n),ft);dt(babelHelpers.assertThisInitialized(n),mt,{writable:true,value:new s.Cache.MemoryCache});n.setEventNamespace("BX.Intranet.InvitationWidget");n.setOptions(t);l.isAdmin=n.getOptions().isCurrentUserAdmin;s.Event.bind(n.getOptions().button,"click",(function(){l.send(l.EVENT_SHOW);ht(babelHelpers.assertThisInitialized(n),Ot,_t).call(babelHelpers.assertThisInitialized(n)).show()}));r.EventEmitter.subscribe(r.EventEmitter.GLOBAL_TARGET,"BX.Bitrix24.NotifyPanel:showInvitationWidget",(function(){ht(babelHelpers.assertThisInitialized(n),Ot,_t).call(babelHelpers.assertThisInitialized(n)).show()}));ht(babelHelpers.assertThisInitialized(n),ft,yt).call(babelHelpers.assertThisInitialized(n));return n}babelHelpers.createClass(e,[{key:"setOptions",value:function t(e){babelHelpers.classPrivateFieldGet(this,mt).set("options",e)}},{key:"getOptions",value:function t(){return babelHelpers.classPrivateFieldGet(this,mt).get("options",{})}}]);return e}(r.EventEmitter);function yt(){if(this.getOptions().invitationCounter>0){ht(this,Et,Pt).call(this).renderTo(ht(this,It,Nt).call(this))}BX.addCustomEvent("onPullEvent-main",ht(this,Tt,Ht).bind(this))}function Ht(t,e){if(t==="user_counter"&&e[BX.message("SITE_ID")]){var n=BX.clone(e[BX.message("SITE_ID")]);var i=n[this.getOptions().counterId];if(!s.Type.isNumber(i)){return}ht(this,Et,Pt).call(this).update(i);this.getOptions().invitationCounter=i;if(i>0){ht(this,Et,Pt).call(this).renderTo(ht(this,It,Nt).call(this))}else{ht(this,Et,Pt).call(this).destroy();babelHelpers.classPrivateFieldGet(this,mt)["delete"]("counter")}}}function Nt(){var t=this;return babelHelpers.classPrivateFieldGet(this,mt).remember("counter-wrapper",(function(){return t.getOptions().button.querySelector(".invitation-widget-counter")}))}function Pt(){var t=this;return babelHelpers.classPrivateFieldGet(this,mt).remember("counter",(function(){return new i.Counter({value:Number(t.getOptions().invitationCounter),color:i.Counter.Color.DANGER})}))}function _t(){var t=this;return babelHelpers.classPrivateFieldGet(this,mt).remember("popup",(function(){return new it({isAdmin:t.getOptions().isCurrentUserAdmin,target:t.getOptions().button,isExtranetAvailable:t.getOptions().isExtranetAvailable,isInvitationAvailable:t.getOptions().isInvitationAvailable,params:{structureLink:t.getOptions().structureLink,invitationLink:t.getOptions().invitationLink,invitationCounter:t.getOptions().invitationCounter,counterId:t.getOptions().counterId}})}))}t.InvitationWidget=wt})(this.BX.Intranet=this.BX.Intranet||{},BX.UI.Analytics,BX.UI,BX.UI,BX.Main,BX.Event,BX,BX);
//# sourceMappingURL=script.map.js