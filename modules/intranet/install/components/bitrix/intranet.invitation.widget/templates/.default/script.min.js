this.BX=this.BX||{};this.BX.Intranet=this.BX.Intranet||{};(function(t,e,n,i,s){"use strict";var o={props:{size:{type:Number,default:85}},template:"\n\t\t<div></div>\n\t",mounted:function t(){this.loader=new e.Loader({target:this.$el,size:this.size});this.loader.show()},beforeDestroy:function t(){this.loader.destroy()}};var a={props:["isCrurrentUserAdmin"],computed:{localize:function t(e){return s.Vue.getFilteredPhrases("INTRANET_INVITATION_WIDGET_")}},methods:{showPopup:function t(e){var s=this;i.Event.EventEmitter.emit("BX.Intranet.InvitationWidget:stopPopupMouseOut");this.getInvitationRightSetting().then(function(t){var i=[{text:s.localize.INTRANET_INVITATION_WIDGET_SETTING_ALL_INVITE,className:t==="all"?"menu-popup-item-accept":"",onclick:function t(){s.saveInvitationRightSetting("all");s.popupMenu.close()}},{text:s.localize.INTRANET_INVITATION_WIDGET_SETTING_ADMIN_INVITE,className:t==="admin"?"menu-popup-item-accept":"",onclick:function t(){s.saveInvitationRightSetting("admin");s.popupMenu.close()}}];s.popupMenu=new n.Menu({bindElement:e.target,items:i,offsetLeft:10,offsetTop:0,angle:true,className:"license-right-popup-menu"});s.popupMenu.show()})},saveInvitationRightSetting:function t(e){BX.ajax.runAction("intranet.invitationwidget.saveInvitationRight",{data:{type:e}})},getInvitationRightSetting:function t(){return new Promise(function(t,e){BX.ajax.runAction("intranet.invitationwidget.getInvitationRight",{data:{}}).then(function(e){t(e.data)})})}},template:'\n\t\t<div class="license-widget-item-menu" @click="showPopup"></div>\n\t'};var l={components:{LoaderComponent:o},props:["isCrurrentUserAdmin"],computed:{localize:function t(e){return s.Vue.getFilteredPhrases("INTRANET_INVITATION_WIDGET_")}},methods:{getComponentContent:function t(){var e=this;BX.ajax.runAction("intranet.invitationwidget.getUserOnlineComponent",{data:{}}).then(function(t){e.showComponentData(t)},function(t){})},showComponentData:function t(e){new Promise(function(t,n){if(e.data.hasOwnProperty("assets")&&e.data.assets["css"].length){BX.load(e.data.assets["css"],function(){if(e.data.assets["js"].length){BX.load(e.data.assets["js"],function(){if(e.data.assets["string"].length){for(var n=0;n<e.data.assets["string"].length;n++){BX.html(null,e.data.assets["string"][n])}}t()})}})}}).then(function(){var t=document.querySelector("[data-role='invitation-widget-ustat-online']");var n=BX.prop.getString(e.data,"html","");BX.html(t,n)})}},template:'\n\t\t<div data-role="invitation-widget-ustat-online" class="invitation-widget-ustat-online">\n\t\t\t<LoaderComponent\n\t\t\t\t:size="40"\n\t\t\t></LoaderComponent>\n\t\t\t{{getComponentContent()}}\n\t\t</div>\n\t'};var r={components:{RightsComponent:a,UserOnlineComponent:l},props:["isCrurrentUserAdmin","invitationLink","structureLink","users","isInvitationAvailable","isExtranetAvailable"],computed:{localize:function t(e){return s.Vue.getFilteredPhrases("INTRANET_INVITATION_WIDGET_")}},methods:{showInvitationSlider:function t(e,n){if(this.isInvitationAvailable){var s=this.invitationLink;if(n==="extranet"){s="".concat(s,"&firstInvitationBlock=extranet")}BX.SidePanel.Instance.open(s,{cacheable:false,allowChangeHistory:false,width:1100});i.Event.EventEmitter.emit("BX.Intranet.InvitationWidget:showInvitationSlider")}else{this.showHintPopup(this.localize.INTRANET_INVITATION_WIDGET_DISABLED_TEXT,e.target)}},showHintPopup:function t(e,n){if(!i.Type.isDomNode(n)||!e){return}new BX.PopupWindow("inviteHint"+i.Text.getRandom(8),n,{content:e,zIndex:15e3,angle:true,offsetTop:0,offsetLeft:50,closeIcon:false,autoHide:true,darkMode:true,overlay:false,maxWidth:400,events:{onAfterPopupShow:function t(){setTimeout(function(){this.close()}.bind(this),4e3)}}}).show()},sendAnalytics:function t(e){BX.ajax.runAction("intranet.invitationwidget.analyticsLabel",{data:{},analyticsLabel:{helperCode:e,headerPopup:"Y"}}).then(function(t){},function(t){})},showInvitationHelper:function t(){var e="limit_why_team_invites";BX.UI.InfoHelper.show(e);this.sendAnalytics(e)},showExtranetHelper:function t(){var e="6770709";BX.Helper.show("redirect=detail&code=".concat(e));this.sendAnalytics(e)}},template:'\n\t\t<div class="license-widget license-widget--invite">\n\t\t\t<div class="license-widget-invite license-widget-item-margin-bottom-1x">\n\t\t\t\t<div class="license-widget-invite-main">\n\t\t\t\t\t<div class="license-widget-inner">\n\t\t\t\t\t\t<div class="license-widget-content">\n\t\t\t\t\t\t\t<div class="license-widget-item-icon license-widget-item-icon--invite"></div>\n\t\t\t\t\t\t\t<div class="license-widget-item-content">\n\t\t\t\t\t\t\t\t<div class="license-widget-item-name">\n\t\t\t\t\t\t\t\t\t<span>{{ localize.INTRANET_INVITATION_WIDGET_INVITE_EMPLOYEE }}</span>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class="license-widget-item-link">\n\t\t\t\t\t\t\t\t\t<span class="license-widget-item-link-text" @click="showInvitationHelper">\n\t\t\t\t\t\t\t\t\t\t{{ localize.INTRANET_INVITATION_WIDGET_DESC }}\n\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<a \n\t\t\t\t\t\t\tdata-role="invitationPopupButton"\n\t\t\t\t\t\t\tclass="license-widget-item-btn license-widget-item-btn--invite"\n\t\t\t\t\t\t\t@click="showInvitationSlider" \n\t\t\t\t\t\t> \n\t\t\t\t\t\t\t{{ localize.INTRANET_INVITATION_WIDGET_INVITE }} \n\t\t\t\t\t\t</a>\t\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t\n\t\t\t<div class="license-widget-block license-widget-item-margin-bottom-2x">\n\t\t\t\t<div class="license-widget-item license-widget-item--company license-widget-item--active">\n\t\t\t\t\t<div class="license-widget-item-logo"></div>\n\t\t\t\t\t<div class="license-widget-item-content">\n\t\t\t\t\t\t<div class="license-widget-item-name">\n\t\t\t\t\t\t\t<span>{{ localize.INTRANET_INVITATION_WIDGET_STRUCTURE }}</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<a :href="structureLink" class="license-widget-item-btn"> \n\t\t\t\t\t\t\t{{ localize.INTRANET_INVITATION_WIDGET_EDIT }} \n\t\t\t\t\t\t</a>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\n\t\t\t\t<div \n\t\t\t\t\tclass="license-widget-item license-widget-item--emp"\n\t\t\t\t\t:class="{ \'license-widget-item--emp-alert\' : users.isLimit }"\n\t\t\t\t>\n\t\t\t\t\t<div class="license-widget-inner">\n\t\t\t\t\t\t<div class="license-widget-content">\n\t\t\t\t\t\t\t<div class="license-widget-item-content">\n\t\t\t\t\t\t\t\t<div \n\t\t\t\t\t\t\t\t\tclass="license-widget-item-progress"\n\t\t\t\t\t\t\t\t\t:class="[\n\t\t\t\t\t\t\t\t\t\tusers.isLimit \n\t\t\t\t\t\t\t\t\t\t? \'license-widget-item-progress--crit\' \n\t\t\t\t\t\t\t\t\t\t: \'license-widget-item-progress--full\'\n\t\t\t\t\t\t\t\t\t]"\n\t\t\t\t\t\t\t\t></div>\n\t\t\t\t\t\t\t\t<div class="license-widget-employees">\n\t\t\t\t\t\t\t\t\t<div class="license-widget-item-name">\n\t\t\t\t\t\t\t\t\t\t<span>{{ localize.INTRANET_INVITATION_WIDGET_EMPLOYEES }}</span>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div class="license-widget-item-num">\n\t\t\t\t\t\t\t\t\t\t{{ users.currentUserCountMessage }}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\t\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\x3c!--<div class="license-widget-item-menu"></div>--\x3e\n\t\t\t\t\t\t\n\t\t\t\t\t\t\t<div class="license-widget-item-detail">\n\t\t\t\t\t\t\t\t<span \n\t\t\t\t\t\t\t\t\tv-if="users.maxUserCount == 0" \n\t\t\t\t\t\t\t\t\tkey="employeeCount"\n\t\t\t\t\t\t\t\t\tclass="license-widget-item-link-text"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{{ localize.INTRANET_INVITATION_WIDGET_EMPLOYEES_NO_LIMIT }}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t<span \n\t\t\t\t\t\t\t\t\tv-else-if="users.isLimit"\n\t\t\t\t\t\t\t\t\tkey="employeeCount" \n\t\t\t\t\t\t\t\t\tclass="license-widget-item-link-text"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{{ localize.INTRANET_INVITATION_WIDGET_EMPLOYEES_LIMIT }}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t<span \n\t\t\t\t\t\t\t\t\tv-else-if="!users.isLimit" \n\t\t\t\t\t\t\t\t\tkey="employeeCount"\n\t\t\t\t\t\t\t\t\tclass="license-widget-item-link-text"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{{ users.leftCountMessage }}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<RightsComponent\n\t\t\t\t\t\t\t\tv-if="isCrurrentUserAdmin"\n\t\t\t\t\t\t\t></RightsComponent>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t\n\t\t\t<div \n\t\t\t\tv-if="isExtranetAvailable"\n\t\t\t\tkey="extranetBlock"\n\t\t\t\tclass="license-widget-item license-widget-item--wide"\n\t\t\t\t:class="{ \'license-widget-item--active\' : users.currentExtranetUserCount > 0 }"\n\t\t\t>\n\t\t\t\t<div class="license-widget-inner">\n\t\t\t\t\t<div class="license-widget-content">\n\t\t\t\t\t\t<div class="license-widget-item-icon license-widget-item-icon--ext"></div>\n\t\t\t\t\t\t<div class="license-widget-item-content">\n\t\t\t\t\t\t\t<div class="license-widget-item-name">\n\t\t\t\t\t\t\t\t<span>{{ localize.INTRANET_INVITATION_WIDGET_EXTRANET }}</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="license-widget-item-link">\n\t\t\t\t\t\t\t\t<a class="license-widget-item-link-text" @click="showExtranetHelper">\n\t\t\t\t\t\t\t\t\t{{ localize.INTRANET_INVITATION_WIDGET_EXTRANET_DESC }}\n\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div \n\t\t\t\t\t\t\t\tv-if="users.currentExtranetUserCount > 0" \n\t\t\t\t\t\t\t\tkey="extranetEmployeeCount"\n\t\t\t\t\t\t\t\tclass="license-widget-item-ext-users"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{{ users.currentExtranetUserCountMessage }}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<button \n\t\t\t\t\t\tclass="license-widget-item-btn" \t\n\t\t\t\t\t\ttype="button" \n\t\t\t\t\t\t@click="showInvitationSlider($event, \'extranet\')"\n\t\t\t\t\t>\n\t\t\t\t\t\t{{ localize.INTRANET_INVITATION_WIDGET_INVITE }}\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class="license-widget-item license-widget-item--wide license-widget-item--no-padding">\n\t\t\t\t<UserOnlineComponent></UserOnlineComponent>\n\t\t\t</div>\n\t\t</div>\n\t'};var c={components:{LoaderComponent:o,ContentComponent:r},props:["isCrurrentUserAdmin"],data:function t(){return{loaded:false,loading:true,invitationLink:"",structureLink:"",isInvitationAvailable:true,users:[]}},mounted:function t(){this.getData()},methods:{getData:function t(){var e=this;BX.ajax.runAction("intranet.invitationwidget.getData",{data:{},analyticsLabel:{headerPopup:"Y"}}).then(function(t){e.invitationLink=t.data.invitationLink;e.structureLink=t.data.structureLink;e.isInvitationAvailable=t.data.isInvitationAvailable;e.isExtranetAvailable=t.data.isExtranetAvailable;e.users=t.data.users;e.loaded=true;e.loading=false},function(t){})}},template:'\n\t\t<div>\n\t\t\t<LoaderComponent v-if="loading" :size="100" />\n\t\t\t<ContentComponent \n\t\t\t\tv-if="!loading && loaded"\n\t\t\t\t:invitationLink="invitationLink"\n\t\t\t\t:structureLink="structureLink"\n\t\t\t\t:isInvitationAvailable="isInvitationAvailable"\n\t\t\t\t:isExtranetAvailable="isExtranetAvailable"\n\t\t\t\t:users="users"\n\t\t\t\t:isCrurrentUserAdmin="isCrurrentUserAdmin"\n\t\t\t>\n\t\t\t</ContentComponent>\n\t\t</div>\n\t'};function u(t,e,n){d(t,e);e.set(t,n)}function d(t,e){if(e.has(t)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}var p=i.Reflection.namespace("BX.Intranet");var v=new WeakMap;var m=function(){function t(e){var n=this;babelHelpers.classCallCheck(this,t);u(this,v,{writable:true,value:void 0});this.node=e.wrapper;this.isCrurrentUserAdmin=e.isCrurrentUserAdmin==="Y";this.enterTimeout=null;this.leaveTimeout=null;this.popupLeaveTimeout=null;this.stopMouseLeave=false;this.renderButton();i.Event.EventEmitter.subscribe("BX.Intranet.InvitationWidget:showInvitationSlider",function(t){n.closePopup()});i.Event.EventEmitter.subscribe("BX.Intranet.InvitationWidget:stopPopupMouseOut",function(t){n.stopMouseLeave=true})}babelHelpers.createClass(t,[{key:"renderButton",value:function t(){var e=this;babelHelpers.classPrivateFieldSet(this,v,s.Vue.create({el:this.node,data:function t(){return{}},computed:{localize:function t(e){return s.Vue.getFilteredPhrases("INTRANET_INVITATION_WIDGET_")}},methods:{onMouseOver:function t(n){clearTimeout(e.enterTimeout);e.enterTimeout=setTimeout(function(){e.enterTimeout=null;e.initPopup(n.target)},500)},onMouseOut:function t(){if(e.enterTimeout!==null){clearTimeout(e.enterTimeout);e.enterTimeout=null;return}e.leaveTimeout=setTimeout(function(){if(!e.stopMouseLeave){e.closePopup()}},500)},togglePopup:function t(n){if(e.popup){if(e.popup.isShown()){e.closePopup()}else{e.initPopup(n.target)}}}},template:'\n\t\t\t\t<button \n\t\t\t\t\tclass="ui-btn ui-btn-round license-btn license-btn-primary" \n\t\t\t\t\t@mouseover="onMouseOver"\n\t\t\t\t\t@mouseout="onMouseOut"\n\t\t\t\t\t@click="togglePopup"\n\t\t\t\t>{{ localize.INTRANET_INVITATION_WIDGET_INVITE }}</button>\n\t\t\t'}))}},{key:"initPopup",value:function t(e){var n=this;this.popup=new B24.PopupBlur({autoHide:true,closeByEsc:true,contentPadding:0,padding:0,minWidth:350,minHeight:220,offsetLeft:-150,animation:{showClassName:"popup-with-radius-show",closeClassName:"popup-with-radius-close",closeAnimationType:"animation"},className:"popup-with-radius",angle:{position:"top",offset:235},bindElement:e,content:this.renderPopupContent(),events:{onPopupClose:function t(){n.popup.destroy()}}});this.initEvents();this.popup.show()}},{key:"initEvents",value:function t(){var e=this;this.popup.getPopupContainer().addEventListener("mouseenter",function(){clearTimeout(e.enterTimeout);clearTimeout(e.leaveTimeout);clearTimeout(e.popupLeaveTimeout)});this.popup.getPopupContainer().addEventListener("mouseleave",function(t){e.popupLeaveTimeout=setTimeout(function(){if(!e.stopMouseLeave){e.closePopup()}},500)})}},{key:"renderPopupContent",value:function t(){var e=this;var n=s.Vue.create({el:document.createElement("div"),components:{PopupWrapperComponent:c},data:function t(){return{isCrurrentUserAdmin:e.isCrurrentUserAdmin}},computed:{localize:function t(e){return s.Vue.getFilteredPhrases("INTRANET_INVITATION_WIDGET_")}},template:'\n\t\t\t\t<PopupWrapperComponent\n\t\t\t\t\t:isCrurrentUserAdmin="isCrurrentUserAdmin"\n\t\t\t\t/>'});return n.$el}},{key:"closePopup",value:function t(){if(this.popup){this.popup.close()}}}]);return t}();p.InvitationWidget=m})(this.BX.Intranet.LicenseWidget=this.BX.Intranet.LicenseWidget||{},BX,BX.Main,BX,BX);
//# sourceMappingURL=script.map.js