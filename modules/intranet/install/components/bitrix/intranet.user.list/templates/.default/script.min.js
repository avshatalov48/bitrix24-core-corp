(function(){var t=BX.namespace("BX.Intranet.UserList");if(t.Manager){return}t.Manager=function(t){this.init(t)};t.Manager.prototype={init:function(t){this.gridId=t.gridId;this.invitationLink=t.invitationLink;BX.addCustomEvent("SidePanel.Slider:onMessage",function(t){if(t.getEventId()==="userProfileSlider::reloadList"){BX.Main.gridManager.reload(this.gridId)}}.bind(this));const e=BX.PopupWindowManager.getPopupById("userGridSettingsMenu");this.sortButton=e.getContentContainer().querySelector('[data-unqid="user-grid-sort-btn"]');BX.addCustomEvent("BX.Main.grid:sort",(()=>{BX.removeClass(this.sortButton,"menu-popup-item-accept")}));BX.addCustomEvent("onPullEvent-intranet",this.onPullEvent.bind(this))},setSort(t){BX.addClass(this.sortButton,"menu-popup-item-accept");BX.Intranet.UserList.GridManager.setSort(t)},onPullEvent:function(t,e){if(e.userId&&t){const n=BX.Main.gridManager.getById(this.gridId)?.instance;const i=n?.getRows().getById(e.userId);switch(t){case"userInitialized":case"userDeleted":i?.update();break;case"userRegister":n?.addRow(e.userId);break;default:break}}},showInvitation:function(){BX.SidePanel.Instance.open(this.invitationLink,{cacheable:false,allowChangeHistory:false})}};t.Toolbar=function(t){this.id="";this.menuItems=null;this.menuId=null;this.menu=null;this.menuOpened=false;this.menuPopup=null;this.componentName=null;this.initialize(t)};t.Toolbar.prototype={initialize:function(t){this.id=t.id;this.menuItems=t.menuItems;this.componentName=t.componentName;if(BX.type.isNotEmptyString(t.menuButtonId)&&BX(t.menuButtonId)){BX.bind(BX(t.menuButtonId),"click",function(t){this.menuButtonClick(t.currentTarget)}.bind(this))}},getId:function(){return this._id},getSetting:function(t,e){return this._settings.getParam(t,e)},_onMenuClose:function(){var t={menu:this._menu};BX.onCustomEvent(window,"CrmInterfaceToolbarMenuClose",[this,t])},menuButtonClick:function(t){this.openMenu(t)},openMenu:function(t){if(this.menuOpened){this.closeMenu();return}if(!BX.type.isArray(this.menuItems)){return}var e=[];var n="";for(var i=0;i<this.menuItems.length;i++){var o=this.menuItems[i];if(typeof o.SEPARATOR!=="undefined"&&o.SEPARATOR){e.push({SEPARATOR:true});continue}if(!BX.type.isNotEmptyString(o.TYPE)){continue}if(BX.type.isNotEmptyString(o.LINK)){n='window.location.href = "'+o.LINK+'"; return false;'}e.push({text:BX.type.isNotEmptyString(o.TITLE)?o.TITLE:"",onclick:n})}this.menuId=this.id.toLowerCase()+"_menu";BX.PopupMenu.show(this.menuId,t,e,{autoHide:true,closeByEsc:true,offsetTop:0,offsetLeft:0,events:{onPopupShow:BX.delegate(this.onPopupShow,this),onPopupClose:BX.delegate(this.onPopupClose,this),onPopupDestroy:BX.delegate(this.onPopupDestroy,this)}});this.menuPopup=BX.PopupMenu.currentItem},closeMenu:function(){if(this.menuPopup){if(this.menuPopup.popupWindow){this.menuPopup.popupWindow.destroy()}}},onPopupShow:function(){this.menuOpened=true},onPopupClose:function(){this.closeMenu()},onPopupDestroy:function(){this.menuOpened=false;this.menuPopup=null;if(typeof BX.PopupMenu.Data[this.menuId]!=="undefined"){delete BX.PopupMenu.Data[this.menuId]}}}})();
//# sourceMappingURL=script.map.js