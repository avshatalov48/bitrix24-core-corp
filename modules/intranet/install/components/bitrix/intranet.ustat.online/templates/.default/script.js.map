{"version":3,"file":"script.js","sources":["src/popup.js","src/timeman.js","src/index.js"],"sourcesContent":["import {Type, Event, Loc, Text, Tag, Dom} from 'main.core';\nimport {Popup} from 'main.popup';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\n\nexport class UserPopup\n{\n\tconstructor(parent)\n\t{\n\t\tthis.parent = parent;\n\t\tthis.signedParameters = this.parent.signedParameters;\n\t\tthis.componentName = this.parent.componentName;\n\t\tthis.userInnerBlockNode = this.parent.userInnerBlockNode || \"\";\n\t\tthis.timemanNode = this.parent.timemanNode;\n\t\tthis.circleNode = this.parent.circleNode || \"\";\n\t\tthis.isPopupShown = false;\n\t\tthis.popupCurrentPage = {};\n\t\tthis.renderedUsers = [];\n\n\t\tEvent.bind(this.userInnerBlockNode, 'click', () => {\n\t\t\tthis.showPopup('getAllOnlineUser', this.userInnerBlockNode);\n\t\t});\n\n\t\tEvent.bind(this.circleNode, 'click', () => {\n\t\t\tthis.showPopup('getAllOnlineUser', this.circleNode, -5);\n\t\t});\n\n\t\tif (this.parent.isTimemanAvailable && Type.isDomNode(this.parent.timemanNode))\n\t\t{\n\t\t\tlet openedNode = this.timemanNode.querySelector('.js-ustat-online-timeman-opened-block');\n\t\t\tlet closedNode = this.timemanNode.querySelector('.js-ustat-online-timeman-closed-block');\n\n\t\t\tEvent.bind(openedNode, 'click', () => {\n\t\t\t\tthis.showPopup('getOpenedTimemanUser', openedNode);\n\t\t\t});\n\n\t\t\tEvent.bind(closedNode, 'click', () => {\n\t\t\t\tthis.showPopup('getClosedTimemanUser', closedNode);\n\t\t\t});\n\t\t}\n\t}\n\n\tgetPopupTitle(action)\n\t{\n\t\tlet title = \"\";\n\n\t\tif (action === \"getAllOnlineUser\")\n\t\t{\n\t\t\ttitle = Loc.getMessage(\"INTRANET_USTAT_ONLINE_USERS\");\n\t\t}\n\t\telse if (action === \"getOpenedTimemanUser\")\n\t\t{\n\t\t\ttitle = Loc.getMessage(\"INTRANET_USTAT_ONLINE_STARTED_DAY\");\n\t\t}\n\t\telse if (action === \"getClosedTimemanUser\")\n\t\t{\n\t\t\ttitle = Loc.getMessage(\"INTRANET_USTAT_ONLINE_FINISHED_DAY\");\n\t\t}\n\n\t\treturn title;\n\t}\n\n\tshowPopup(action, bindNode, topOffset)\n\t{\n\t\tif (this.isPopupShown)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (Type.isUndefined(topOffset))\n\t\t{\n\t\t\ttopOffset = 7;\n\t\t}\n\n\t\tthis.popupCurrentPage[action] = 1;\n\t\tthis.popupInnerContainer = \"\";\n\t\tthis.renderedUsers = [];\n\n\t\tthis.allOnlineUserPopup = new Popup(`intranet-ustat-online-popup-${Text.getRandom()}`, bindNode, {\n\t\t\tlightShadow : true,\n\t\t\toffsetLeft: action === 'getClosedTimemanUser' ? -60 : -22,\n\t\t\toffsetTop: topOffset,\n\t\t\tautoHide: true,\n\t\t\tcloseByEsc: true,\n\t\t\tbindOptions: {\n\t\t\t\tposition: 'bottom'\n\t\t\t},\n\t\t\tanimationOptions: {\n\t\t\t\tshow: {\n\t\t\t\t\ttype: 'opacity-transform'\n\t\t\t\t},\n\t\t\t\tclose: {\n\t\t\t\t\ttype: 'opacity'\n\t\t\t\t}\n\t\t\t},\n\t\t\tevents : {\n\t\t\t\tonPopupDestroy: () => {\n\t\t\t\t\tthis.isPopupShown = false;\n\t\t\t\t},\n\t\t\t\tonPopupClose: () => {\n\t\t\t\t\tthis.allOnlineUserPopup.destroy();\n\t\t\t\t},\n\t\t\t\tonAfterPopupShow: (popup) => {\n\t\t\t\t\tEventEmitter.emit(EventEmitter.GLOBAL_TARGET, 'BX.Intranet.UstatOnline:showPopup', new BaseEvent({\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\tpopup: popup,\n\t\t\t\t\t\t}\n\t\t\t\t\t}));\n\n\t\t\t\t\tlet popupContent = Tag.render`\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<span class=\"intranet-ustat-online-popup-name-title\">\n\t\t\t\t\t\t\t\t${this.getPopupTitle(action)}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t<div class=\"intranet-ustat-online-popup-container\">\n\t\t\t\t\t\t\t\t<div class=\"intranet-ustat-online-popup-content\">\n\t\t\t\t\t\t\t\t\t<div class=\"intranet-ustat-online-popup-content-box\">\n\t\t\t\t\t\t\t\t\t\t<div class=\"intranet-ustat-online-popup-inner\"></div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t`;\n\n\t\t\t\t\tpopup.contentContainer.appendChild(popupContent);\n\t\t\t\t\tthis.popupInnerContainer = popupContent.querySelector(\".intranet-ustat-online-popup-inner\");\n\t\t\t\t\tthis.loader = this.showLoader({\n\t\t\t\t\t\tnode: popupContent.querySelector(\".intranet-ustat-online-popup-content\"),\n\t\t\t\t\t\tloader: null,\n\t\t\t\t\t\tsize: 40\n\t\t\t\t\t});\n\t\t\t\t\tthis.showUsersInPopup(action);\n\t\t\t\t\tthis.isPopupShown = true;\n\t\t\t\t},\n\t\t\t\tonPopupFirstShow: (popup) => {\n\t\t\t\t\tEventEmitter.subscribe(EventEmitter.GLOBAL_TARGET, 'SidePanel.Slider:onOpenStart', () => {\n\t\t\t\t\t\tpopup.close();\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t},\n\t\t\tclassName: 'intranet-ustat-online-popup'\n\t\t});\n\n\t\tthis.popupScroll(action);\n\t\tthis.allOnlineUserPopup.show();\n\t}\n\n\tpopupScroll(action)\n\t{\n\t\tif (!Type.isDomNode(this.popupInnerContainer))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tEvent.bind(this.popupInnerContainer, 'scroll', () => {\n\t\t\tif (this.popupInnerContainer.scrollTop > (this.popupInnerContainer.scrollHeight - this.popupInnerContainer.offsetHeight) / 1.5)\n\t\t\t{\n\t\t\t\tthis.showUsersInPopup(action);\n\t\t\t\tEvent.unbindAll(this.popupInnerContainer, 'scroll');\n\t\t\t}\n\t\t});\n\t};\n\n\tshowUsersInPopup(action)\n\t{\n\t\tif (\n\t\t\taction !== 'getAllOnlineUser'\n\t\t\t&& action !== 'getOpenedTimemanUser'\n\t\t\t&& action !== 'getClosedTimemanUser'\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tBX.ajax.runComponentAction(this.componentName, action, {\n\t\t\tsignedParameters: this.signedParameters,\n\t\t\tmode: 'class',\n\t\t\tdata: {\n\t\t\t\tpageNum: this.popupCurrentPage[action]\n\t\t\t}\n\t\t}).then((response) => {\n\t\t\tif (response.data)\n\t\t\t{\n\t\t\t\tthis.renderPopupUsers(response.data);\n\t\t\t\tthis.popupCurrentPage[action]++;\n\t\t\t\tthis.popupScroll(action);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (!this.popupInnerContainer.hasChildNodes())\n\t\t\t\t{\n\t\t\t\t\tthis.popupInnerContainer.innerText = Loc.getMessage('INTRANET_USTAT_ONLINE_EMPTY');\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.hideLoader({loader: this.loader});\n\t\t}, (response) =>{\n\t\t\tthis.hideLoader({loader: this.loader});\n\t\t});\n\t}\n\n\trenderPopupUsers(users)\n\t{\n\t\tif (\n\t\t\t!this.allOnlineUserPopup\n\t\t\t|| !Type.isDomNode(this.popupInnerContainer)\n\t\t\t|| !Type.isObjectLike(users)\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tfor (let i in users)\n\t\t{\n\t\t\tif (!users.hasOwnProperty(i) || this.renderedUsers.indexOf(users[i]['ID']) >= 0)\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tthis.renderedUsers.push(users[i]['ID']);\n\n\t\t\tlet avatarIcon = \"<i></i>\";\n\n\t\t\tif (Type.isString(users[i]['AVATAR']) && users[i]['AVATAR'])\n\t\t\t{\n\t\t\t\tavatarIcon = `<i style=\"background-image: url('${encodeURI(users[i]['AVATAR'])}')\"></i>`;\n\t\t\t}\n\n\t\t\tconst userNode = Tag.render`\n\t\t\t\t<a \n\t\t\t\t\tclass=\"intranet-ustat-online-popup-item\"\n\t\t\t\t\thref=\"${users[i]['PATH_TO_USER_PROFILE']}\" \n\t\t\t\t\ttarget=\"_blank\"\n\t\t\t\t>\n\t\t\t\t\t<span class=\"intranet-ustat-online-popup-avatar-new\">\n\t\t\t\t\t\t<div class=\"ui-icon ui-icon-common-user intranet-ustat-online-popup-avatar-img\">\n\t\t\t\t\t\t\t${avatarIcon}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<span class=\"intranet-ustat-online-popup-avatar-status-icon\"></span>\n\t\t\t\t\t</span>\n\t\t\t\t\t<span class=\"intranet-ustat-online-popup-name\">\n\t\t\t\t\t\t${users[i]['NAME']}\n\t\t\t\t\t</span>\n\t\t\t\t</a>\n\t\t\t`;\n\n\t\t\tthis.popupInnerContainer.appendChild(userNode);\n\t\t}\n\t}\n\n\tshowLoader(params)\n\t{\n\t\tlet loader = null;\n\n\t\tif (params.node)\n\t\t{\n\t\t\tif (params.loader === null)\n\t\t\t{\n\t\t\t\tloader = new BX.Loader({\n\t\t\t\t\ttarget: params.node,\n\t\t\t\t\tsize: params.hasOwnProperty(\"size\") ? params.size : 40\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tloader = params.loader;\n\t\t\t}\n\n\t\t\tloader.show();\n\t\t}\n\n\t\treturn loader;\n\t}\n\n\thideLoader(params)\n\t{\n\t\tif (params.loader !== null)\n\t\t{\n\t\t\tparams.loader.hide();\n\t\t}\n\n\t\tif (params.node)\n\t\t{\n\t\t\tDom.clean(params.node);\n\t\t}\n\n\t\tif (params.loader !== null)\n\t\t{\n\t\t\tparams.loader = null;\n\t\t}\n\t}\n}","import {Type, Dom} from 'main.core';\nimport {PULL} from \"pull.client\";\n\nexport class Timeman\n{\n\tconstructor(parent)\n\t{\n\t\tthis.parent = parent;\n\t\tthis.signedParameters = this.parent.signedParameters;\n\t\tthis.componentName = this.parent.componentName;\n\t\tthis.isTimemanAvailable = this.parent.isTimemanAvailable;\n\t\tthis.timemanNode = this.parent.timemanNode;\n\t\tthis.containerNode = this.parent.ustatOnlineContainerNode;\n\n\t\tif (this.isTimemanAvailable && Type.isDomNode(this.timemanNode))\n\t\t{\n\t\t\tthis.timemanValueNodes = this.timemanNode.querySelectorAll('.intranet-ustat-online-value');\n\t\t\tthis.timemanTextNodes =  this.timemanNode.querySelectorAll('.js-ustat-online-timeman-text');\n\n\t\t\tthis.resizeTimemanText();\n\t\t\tthis.subscribePullEvent();\n\t\t}\n\t}\n\n\tresizeTimemanText()\n\t{\n\t\tif (!Type.isDomNode(this.timemanNode))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet textSum = 0;\n\t\tlet valueSum = 0;\n\n\t\tif (Type.isArrayLike(this.timemanTextNodes))\n\t\t{\n\t\t\tfor (let text of this.timemanTextNodes)\n\t\t\t{\n\t\t\t\tlet textItems = text.textContent.length;\n\t\t\t\ttextSum += textItems;\n\t\t\t}\n\t\t}\n\n\t\tif (Type.isArrayLike(this.timemanValueNodes))\n\t\t{\n\t\t\tfor (let value of this.timemanValueNodes)\n\t\t\t{\n\t\t\t\tlet valueItems = value.textContent.length;\n\t\t\t\tvalueSum += valueItems;\n\t\t\t}\n\t\t}\n\n\t\tif (textSum >= 17 && valueSum >= 6 || textSum >= 19 && valueSum >= 4)\n\t\t{\n\t\t\tDom.addClass(this.timemanNode, 'intranet-ustat-online-info-text-resize');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.removeClass(this.timemanNode, 'intranet-ustat-online-info-text-resize');\n\t\t}\n\t}\n\n\tredrawTimeman(data)\n\t{\n\t\tif (data.hasOwnProperty(\"OPENED\"))\n\t\t{\n\t\t\tlet openedNode = this.containerNode.querySelector('.js-ustat-online-timeman-opened');\n\t\t\tif (Type.isDomNode(openedNode))\n\t\t\t{\n\t\t\t\topenedNode.innerHTML = data[\"OPENED\"];\n\t\t\t}\n\t\t}\n\n\t\tif (data.hasOwnProperty(\"CLOSED\"))\n\t\t{\n\t\t\tlet closedNode = this.containerNode.querySelector('.js-ustat-online-timeman-closed');\n\t\t\tif (Type.isDomNode(closedNode))\n\t\t\t{\n\t\t\t\tclosedNode.innerHTML = data[\"CLOSED\"];\n\t\t\t}\n\t\t}\n\n\t\tthis.resizeTimemanText();\n\t}\n\n\tcheckTimeman()\n\t{\n\t\tBX.ajax.runComponentAction(this.componentName, \"checkTimeman\", {\n\t\t\tsignedParameters: this.signedParameters,\n\t\t\tmode: 'class'\n\t\t}).then((response) => {\n\t\t\tif (response.data)\n\t\t\t{\n\t\t\t\tthis.redrawTimeman(response.data);\n\t\t\t}\n\t\t});\n\t}\n\n\tsubscribePullEvent()\n\t{\n\t\tPULL.subscribe({\n\t\t\tmoduleId: 'intranet',\n\t\t\tcommand: 'timemanDayInfo',\n\t\t\tcallback: (data) =>\n\t\t\t{\n\t\t\t\tthis.redrawTimeman(data);\n\t\t\t}\n\t\t});\n\t}\n}","import {Type, Dom, Reflection, Event} from 'main.core';\nimport {rest} from \"rest.client\";\nimport \"pull.client\";\nimport {UserPopup} from './popup';\nimport {Timeman} from './timeman';\nimport {Circle} from 'ui.graph.circle';\n\nconst namespace = Reflection.namespace('BX.Intranet');\n\nclass UstatOnline\n{\n\tconstructor(params)\n\t{\n\t\tthis.signedParameters = params.signedParameters;\n\t\tthis.componentName = params.componentName;\n\t\tthis.ustatOnlineContainerNode = params.ustatOnlineContainerNode || \"\";\n\t\tthis.maxUserToShow = params.maxUserToShow;\n\t\tthis.maxOnlineUserCountToday = params.maxOnlineUserCountToday;\n\t\tthis.currentUserId = parseInt(params.currentUserId);\n\t\tthis.isTimemanAvailable = params.isTimemanAvailable === \"Y\";\n\t\tthis.isFullAnimationMode = params.isFullAnimationMode === \"Y\";\n\t\tthis.limitOnlineSeconds = params.limitOnlineSeconds;\n\t\tthis.renderingFinished = true;\n\n\t\tif (!Type.isDomNode(this.ustatOnlineContainerNode))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.userBlockNode = this.ustatOnlineContainerNode.querySelector('.intranet-ustat-online-icon-box');\n\t\tthis.userInnerBlockNode = this.ustatOnlineContainerNode.querySelector('.intranet-ustat-online-icon-inner');\n\t\tthis.circleNode = this.ustatOnlineContainerNode.querySelector('.ui-graph-circle');\n\t\tthis.timemanNode = this.ustatOnlineContainerNode.querySelector('.intranet-ustat-online-info');\n\n\t\tlet users = params.users;\n\t\tlet allOnlineUserIdToday = params.allOnlineUserIdToday;\n\n\t\tthis.users = users.map(user => {\n\t\t\tuser.id = parseInt(user.id);\n\t\t\tuser.offline_date = this.getOfflineDate(user.last_activity_date);\n\t\t\treturn user;\n\t\t});\n\n\t\tthis.allOnlineUserIdToday = allOnlineUserIdToday.map(id => {\n\t\t\treturn parseInt(id);\n\t\t});\n\n\t\tthis.online = [].concat(this.users);\n\t\tthis.counter = 0;\n\n\t\t//-------------- for IndexedDb\n\t\tthis.ITEMS = {\n\t\t\tobClientDb: null,\n\t\t\tobClientDbData: {},\n\t\t\tobClientDbDataSearchIndex: {},\n\t\t\tbMenuInitialized: false,\n\t\t\tinitialized: {\n\t\t\t\tsonetgroups: false,\n\t\t\t\tmenuitems: false\n\t\t\t},\n\t\t\toDbSearchResult: {}\n\t\t};\n\n\t\tBX.Finder(false, 'searchTitle', [], {}, this);\n\t\tBX.onCustomEvent(this, 'initFinderDb', [ this.ITEMS, 'searchTitle', null, ['users'], this ]);\n\t\t//---------------\n\n\t\tif (Type.isDomNode(this.ustatOnlineContainerNode))\n\t\t{\n\t\t\tBX.UI.Hint.init(this.ustatOnlineContainerNode);\n\t\t}\n\n\t\tnew UserPopup(this);\n\t\tthis.timemanObj = new Timeman(this);\n\n\t\tconst now = new Date();\n\t\tthis.currentDate = new Date(now.getFullYear(), now.getMonth(), now.getDate()).valueOf();\n\n\t\tthis.checkOnline();\n\n\t\tif (this.isFullAnimationMode)\n\t\t{\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.subscribePullEvent();\n\t\t\t}, 3000);\n\n\t\t\tsetInterval(() => this.checkOnline(), 60000);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tBX.addCustomEvent(window, \"onImUpdateUstatOnline\", BX.proxy(this.updateOnlineRestrictedMode, this));\n\t\t}\n\t}\n\n\tupdateOnlineRestrictedMode(data)\n\t{\n\t\tthis.counter = data.count;\n\t\tthis.maxOnlineUserCountToday = data.count;\n\t\tthis.online = data.users;\n\t\tthis.redrawOnline();\n\t}\n\n\tgetOfflineDate(date)\n\t{\n\t\treturn date? new Date(date).getTime() + parseInt(this.limitOnlineSeconds)*1000: null;\n\t}\n\n\tcheckOnline()\n\t{\n\t\tthis.online = this.online.filter(user => {\n\t\t\treturn (user && (user.offline_date > +new Date() || user.id === this.currentUserId));\n\t\t});\n\n\t\tlet prevCounter = this.counter;\n\n\t\tif (this.online.length > 0)\n\t\t{\n\t\t\tthis.counter = this.online.map(el => 1).reduce(count => count + 1);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.counter = 0;\n\t\t}\n\n\t\tif (this.checkNewDay() || prevCounter !== this.counter)\n\t\t{\n\t\t\tthis.redrawOnline();\n\t\t}\n\t}\n\n\tcheckNewDay()\n\t{\n\t\tconst now = new Date();\n\t\tconst today = new Date(now.getFullYear(), now.getMonth(), now.getDate()).valueOf();\n\n\t\tif (this.currentDate < today) //new day\n\t\t{\n\t\t\tthis.maxOnlineUserCountToday = this.online.length;\n\n\t\t\tif (this.isTimemanAvailable)\n\t\t\t{\n\t\t\t\tthis.timemanObj.checkTimeman();\n\t\t\t}\n\n\t\t\tthis.currentDate = today;\n\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tsetUserOnline(params)\n\t{\n\t\tconst userId = this.getNumberUserId(params.id);\n\n\t\tthis.findUser(userId).then(user => {\n\t\t\tuser.id = this.getNumberUserId(user.id);\n\n\t\t\tif (typeof params.last_activity_date !== \"undefined\")\n\t\t\t{\n\t\t\t\tuser.last_activity_date = params.last_activity_date;\n\t\t\t}\n\n\t\t\tif (user.isExtranet !== \"Y\")\n\t\t\t{\n\t\t\t\tthis.setUserToLocal(user);\n\t\t\t\tthis.checkOnline();\n\t\t\t}\n\t\t}).catch(error => {});\n\t}\n\n\tsetUserToLocal(user)\n\t{\n\t\tuser.offline_date = this.getOfflineDate(user.last_activity_date);\n\n\t\tthis.users = this.users.filter(element => element.id !== user.id);\n\t\tthis.users.push(user);\n\n\t\tlet isUserOnline = false;\n\t\tthis.online.forEach((element) => {\n\t\t\tif (element.id === user.id)\n\t\t\t{\n\t\t\t\tisUserOnline = true;\n\t\t\t}\n\t\t});\n\n\t\tif (!isUserOnline)\n\t\t{\n\t\t\tthis.online.unshift(user);\n\t\t}\n\n\t\tif (this.allOnlineUserIdToday.indexOf(user.id) === -1)\n\t\t{\n\t\t\tthis.allOnlineUserIdToday.push(user.id);\n\t\t\tthis.maxOnlineUserCountToday++;\n\t\t}\n\t}\n\n\tsetUserOnlineMultiply(list)\n\t{\n\t\tlet requestUserList = [];\n\t\tlet counterFindUser = 0;\n\t\tlet promises = [];\n\n\t\tlist.forEach(user => {\n\n\t\t\tlet userId = parseInt(user.id);\n\t\t\tpromises.push(new Promise((resolve, reject) => {\n\t\t\t\tthis.findUser(userId, true).then(user => {\n\t\t\t\t\tcounterFindUser++;\n\t\t\t\t\tthis.setUserToLocal(user);\n\t\t\t\t\tresolve();\n\t\t\t\t}).catch(error => {\n\t\t\t\t\trequestUserList.push(userId);\n\t\t\t\t\tresolve();\n\t\t\t\t});\n\t\t\t}));\n\t\t});\n\n\t\tPromise.all(promises).then(() => {\n\t\t\tif (requestUserList.length <= 0)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tconst requestCount = this.maxUserToShow-counterFindUser;\n\n\t\t\tif (requestCount <= 0)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\trequestUserList = requestUserList.slice(0, requestCount);\n\n\t\t\tBX.rest.callMethod('im.user.list.get', {ID: requestUserList}).then(result => {\n\t\t\t\tlet collection = result.data();\n\t\t\t\tif (!collection)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tfor (let userId in collection)\n\t\t\t\t{\n\t\t\t\t\tif (!collection.hasOwnProperty(userId))\n\t\t\t\t\t{\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst userData = collection[userId];\n\t\t\t\t\tif (!userData)\n\t\t\t\t\t{\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\tlet user = {};\n\t\t\t\t\tuser.id = parseInt(userData.id);\n\t\t\t\t\tuser.name = userData.name;\n\t\t\t\t\tuser.avatar = BX.MessengerCommon.isBlankAvatar(userData.avatar)? '': userData.avatar;\n\t\t\t\t\tuser.last_activity_date = userData.last_activity_date;\n\n\t\t\t\t\tthis.setUserToLocal(user);\n\t\t\t\t}\n\t\t\t}).catch(error => {});\n\t\t});\n\t}\n\n\tfindUser(userId, skipRest = false)\n\t{\n\t\tuserId = parseInt(userId);\n\n\t\treturn new Promise((resolve, reject) => {\n\n\t\t\tlet user = null;\n\n\t\t\tuser = this.users.find(element => element.id === userId);\n\t\t\tif (user)\n\t\t\t{\n\t\t\t\tresolve(user);\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tuser = this.getUserFromMessenger(userId);\n\t\t\tif (user)\n\t\t\t{\n\t\t\t\tresolve(user);\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tthis.getUserFromDb(userId).then(user => {\n\t\t\t\tresolve(user);\n\t\t\t\treturn true;\n\t\t\t}).catch(error => {\n\n\t\t\t\tif (skipRest)\n\t\t\t\t{\n\t\t\t\t\treject(null);\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\tthis.getUserFromServer(userId).then(user => {\n\t\t\t\t\tthis.addUserToDb(user);\n\t\t\t\t\tresolve(user);\n\t\t\t\t}).catch(error => {\n\t\t\t\t\treject(null);\n\t\t\t\t});\n\t\t\t});\n\n\t\t\treturn true;\n\t\t});\n\t}\n\n\tgetUserFromMessenger(userId)\n\t{\n\t\tif (typeof window.BX.MessengerCommon === 'undefined')\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tlet result = BX.MessengerCommon.getUser(userId);\n\t\tif (!result)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tlet user = {\n\t\t\tid: parseInt(result.id),\n\t\t\tname: result.name,\n\t\t\tavatar: BX.MessengerCommon.isBlankAvatar(result.avatar)? '': result.avatar,\n\t\t\tlast_activity_date: null,\n\t\t};\n\n\t\tif (result.last_activity_date instanceof Date)\n\t\t{\n\t\t\tuser.last_activity_date = result.last_activity_date.toISOString()\n\t\t}\n\t\tif (typeof result.last_activity_date === 'string')\n\t\t{\n\t\t\tuser.last_activity_date = result.last_activity_date\n\t\t}\n\n\t\treturn user;\n\t}\n\n\tgetUserFromDb(userId)\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tBX.indexedDB.getValue(this.ITEMS.obClientDb, \"users\", \"U\" + userId).then((user) => {\n\t\t\t\tif (user && typeof user === 'object')\n\t\t\t\t{\n\t\t\t\t\tif (user.hasOwnProperty(\"entityId\"))\n\t\t\t\t\t{\n\t\t\t\t\t\tuser.id = this.getNumberUserId(user.entityId);\n\t\t\t\t\t}\n\t\t\t\t\tresolve(user);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tresolve(null);\n\t\t\t\t}\n\t\t\t}).catch(error => {\n\t\t\t\treject(null);\n\t\t\t});\n\t\t});\n\t}\n\n\taddUserToDb(user)\n\t{\n\t\tuser.id = \"U\" + user.id;\n\t\tBX.indexedDB.addValue(this.ITEMS.obClientDb, 'users', user);\n\t}\n\n\tgetUserFromServer(userId)\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\n\t\t\tif (typeof window.BX.MessengerCommon === 'undefined')\n\t\t\t{\n\t\t\t\tresolve(null);\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\trest.callMethod('im.user.get', {id: userId}).then(result => {\n\t\t\t\tif (result.data() && result.data().external_auth_id !== \"__controller\")\n\t\t\t\t{\n\t\t\t\t\tlet user = {};\n\t\t\t\t\tuser.id = parseInt(result.data().id);\n\t\t\t\t\tuser.name = result.data().name;\n\t\t\t\t\tuser.avatar = BX.MessengerCommon.isBlankAvatar(result.data().avatar)? '': result.data().avatar;\n\t\t\t\t\tuser.last_activity_date = result.data().last_activity_date;\n\t\t\t\t\tuser.isExtranet = result.data().extranet ? \"Y\" : \"N\";\n\t\t\t\t\tuser.active = \"Y\";\n\t\t\t\t\tuser.entityId = parseInt(result.data().id);\n\n\t\t\t\t\tresolve(user);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tresolve(null);\n\t\t\t\t}\n\t\t\t}).catch(error => {\n\t\t\t\tresolve(null);\n\t\t\t});\n\t\t});\n\t}\n\n\tsubscribePullEvent()\n\t{\n\t\tBX.PULL.subscribe({\n\t\t\ttype: 'online',\n\t\t\tcallback: (data) =>\n\t\t\t{\n\t\t\t\tif (data.command === 'userStatus')\n\t\t\t\t{\n\t\t\t\t\tfor (let userId in data.params.users)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (!data.params.users.hasOwnProperty(userId))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis.setUserOnline(data.params.users[userId]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t/*else if (data.command === 'list')\n\t\t\t\t{\n\t\t\t\t\tlet list = [];\n\n\t\t\t\t\tfor (let userId in data.params.users)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (data.params.users.hasOwnProperty(userId))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlist.push({\n\t\t\t\t\t\t\t\tid: data.params.users[userId].id,\n\t\t\t\t\t\t\t\tlast_activity_date: data.params.users[userId].last_activity_date\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.setUserOnlineMultiply(list);\n\t\t\t\t}*/\n\t\t\t}\n\t\t});\n\t}\n\n\tgetNumberUserId(id)\n\t{\n\t\tif (!id)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet userId = String(id);\n\t\tuserId = userId.replace('U', '');\n\t\treturn parseInt(userId);\n\t}\n\n\tisDocumentVisible()\n\t{\n\t\treturn document.visibilityState === 'visible';\n\t}\n\n\tredrawOnline()\n\t{\n\t\tthis.showCircleAnimation(this.circleNode, this.counter, this.maxOnlineUserCountToday);\n\t\tif (this.renderingFinished)\n\t\t{\n\t\t\tthis.renderingFinished = false;\n\t\t\tthis.renderAllUser();\n\t\t}\n\t}\n\n\trenderAllUser()\n\t{\n\t\tlet renderedUserIds = [];\n\t\tlet newUserIds = [];\n\n\t\tthis.online.forEach((item) => {\n\t\t\tnewUserIds.push(parseInt(item.id));\n\t\t});\n\n\t\tconst onlineToShow = newUserIds.slice(0, this.maxUserToShow);\n\n\t\tlet renderedUserNodes = this.userBlockNode.querySelectorAll(\".js-ustat-online-user\");\n\n\t\tif (this.online.length > 100 && renderedUserNodes.length >= this.maxUserToShow)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tfor (let item in renderedUserNodes)\n\t\t{\n\t\t\tif (!renderedUserNodes.hasOwnProperty(item))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tlet renderedItemId = parseInt(renderedUserNodes[item].getAttribute(\"data-user-id\"));\n\n\t\t\tif (newUserIds.indexOf(renderedItemId) === -1)\n\t\t\t{\n\t\t\t\tif (Type.isDomNode(renderedUserNodes[item]))\n\t\t\t\t{\n\t\t\t\t\tDom.remove(renderedUserNodes[item]); //remove offline avatars\n\t\t\t\t\t/*renderedUserNodes[item].classList.add('intranet-ustat-online-icon-hide');\n\t\t\t\t\tsetTimeout( () => {\n\n\t\t\t\t\t}, 800);*/\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\trenderedUserIds.push(parseInt(renderedItemId));\n\t\t\t}\n\t\t}\n\n\t\trenderedUserNodes = this.userBlockNode.querySelectorAll(\".js-ustat-online-user\");\n\n\t\tlet renderedUserCount = renderedUserNodes.length;\n\t\tconst showAnimation = renderedUserCount !== 0;\n\t\tthis.userIndex = this.online.length;\n\n\t\tlet stepRender = (i) => {\n\t\t\tif (i >= this.maxUserToShow || i >= this.online.length)\n\t\t\t{\n\t\t\t\tthis.renderingFinished = true;\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tnew Promise((resolve) => {\n\t\t\t\tlet item = this.online[i];\n\n\t\t\t\tif (renderedUserIds.indexOf(item.id) >= 0)\n\t\t\t\t{\n\t\t\t\t\tresolve();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (renderedUserCount < this.maxUserToShow)\n\t\t\t\t{\n\t\t\t\t\tif (showAnimation)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.userIndex++;\n\t\t\t\t\t}\n\t\t\t\t\tthis.renderUser(item, showAnimation);\n\t\t\t\t\trenderedUserIds.push(item.id);\n\t\t\t\t\trenderedUserCount++;\n\t\t\t\t\tif (!showAnimation)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.userIndex = this.userIndex - 1;\n\t\t\t\t\t}\n\n\t\t\t\t\tresolve();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tconst elements = this.userBlockNode.querySelectorAll(\".js-ustat-online-user\");\n\t\t\t\t\tconst firstElement = elements[0];\n\t\t\t\t\tlet lastElement = \"\";\n\n\t\t\t\t\tfor (let i = elements.length - 1; i >= 0; i--)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (Type.isDomNode(elements[i]))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst elementUserId = parseInt(elements[i].getAttribute(\"data-user-id\"));\n\t\t\t\t\t\t\tif (onlineToShow.indexOf(elementUserId) === -1)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tlastElement = elements[i];\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (Type.isDomNode(lastElement))\n\t\t\t\t\t{\n\t\t\t\t\t\tconst removedUserId = parseInt(lastElement.getAttribute(\"data-user-id\"));\n\n\t\t\t\t\t\tDom.removeClass(lastElement, 'intranet-ustat-online-icon-show');\n\t\t\t\t\t\tif (this.isDocumentVisible())\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tDom.addClass(lastElement, 'intranet-ustat-online-icon-hide');\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis.userIndex = parseInt(firstElement.style.zIndex);\n\t\t\t\t\t\tthis.userIndex++;\n\n\t\t\t\t\t\tthis.renderUser(item, showAnimation);\n\t\t\t\t\t\trenderedUserIds = renderedUserIds.filter(id => id !== removedUserId);\n\t\t\t\t\t\trenderedUserIds.push(item.id);\n\n\t\t\t\t\t\tif (this.isDocumentVisible())\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tEvent.bind(lastElement, 'animationend', (event) => {\n\t\t\t\t\t\t\t\tDom.remove(lastElement);\n\t\t\t\t\t\t\t\tresolve();\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tDom.remove(lastElement);\n\t\t\t\t\t\t\tresolve();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tresolve();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}).then(() => {\n\t\t\t\tstepRender(++i);\n\t\t\t});\n\t\t};\n\n\t\tstepRender(0);\n\t}\n\n\trenderUser(user, showAnimation)\n\t{\n\t\tif (!user || typeof user !== 'object')\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet userStyle = \"\";\n\t\tif (user.avatar)\n\t\t{\n\t\t\tuserStyle = 'background-image: url(\"' + encodeURI(user.avatar) + '\");';\n\t\t}\n\n\t\tconst userId = this.getNumberUserId(user.id);\n\n\t\tlet itemsClasses = `ui-icon ui-icon-common-user intranet-ustat-online-icon js-ustat-online-user\n\t\t\t${showAnimation && this.isDocumentVisible() ? ' intranet-ustat-online-icon-show' : ''}`;\n\n\t\tthis.userItem = BX.create('span', {\n\t\t\tattrs: {\n\t\t\t\tclassName: itemsClasses,\n\t\t\t\t\"data-user-id\" : userId\n\t\t\t},\n\t\t\tstyle: {\n\t\t\t\tzIndex: this.userIndex\n\t\t\t},\n\t\t\tchildren: [\n\t\t\t\tBX.create('i', {\n\t\t\t\t\tattrs: { style: userStyle}\n\t\t\t\t})\n\t\t\t]\n\t\t});\n\n\t\tif (showAnimation)\n\t\t{\n\t\t\tDom.prepend(this.userItem, this.userInnerBlockNode);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.userInnerBlockNode.appendChild(this.userItem);\n\t\t}\n\t}\n\n\tshowCircleAnimation(circleNode, currentUserOnlineCount, maxUserOnlineCount)\n\t{\n\t\tmaxUserOnlineCount = parseInt(maxUserOnlineCount);\n\t\tcurrentUserOnlineCount = parseInt(currentUserOnlineCount);\n\n\t\tif (currentUserOnlineCount <= 0)\n\t\t{\n\t\t\tcurrentUserOnlineCount = 1;\n\t\t}\n\n\t\tif (currentUserOnlineCount > maxUserOnlineCount)\n\t\t{\n\t\t\tmaxUserOnlineCount = currentUserOnlineCount;\n\t\t}\n\n\t\tlet progressPercent = (currentUserOnlineCount*100)/maxUserOnlineCount;\n\n\t\tif (!this.circle)\n\t\t{\n\t\t\tthis.circle = new Circle(\n\t\t\t\tcircleNode,\n\t\t\t\t68,\n\t\t\t\tprogressPercent,\n\t\t\t\tcurrentUserOnlineCount,\n\t\t\t\ttrue,\n\t\t\t);\n\t\t\tthis.circle.show();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.circle.updateCounter(progressPercent, currentUserOnlineCount);\n\t\t}\n\t}\n}\n\nnamespace.UstatOnline = UstatOnline;\nexport {UstatOnline};\n"],"names":["UserPopup","parent","signedParameters","componentName","userInnerBlockNode","timemanNode","circleNode","isPopupShown","popupCurrentPage","renderedUsers","Event","bind","showPopup","isTimemanAvailable","Type","isDomNode","openedNode","querySelector","closedNode","action","title","Loc","getMessage","bindNode","topOffset","isUndefined","popupInnerContainer","allOnlineUserPopup","Popup","Text","getRandom","lightShadow","offsetLeft","offsetTop","autoHide","closeByEsc","bindOptions","position","animationOptions","show","type","close","events","onPopupDestroy","onPopupClose","destroy","onAfterPopupShow","popup","EventEmitter","emit","GLOBAL_TARGET","BaseEvent","data","popupContent","Tag","render","getPopupTitle","contentContainer","appendChild","loader","showLoader","node","size","showUsersInPopup","onPopupFirstShow","subscribe","className","popupScroll","scrollTop","scrollHeight","offsetHeight","unbindAll","BX","ajax","runComponentAction","mode","pageNum","then","response","renderPopupUsers","hasChildNodes","innerText","hideLoader","users","isObjectLike","i","hasOwnProperty","indexOf","push","avatarIcon","isString","encodeURI","userNode","params","Loader","target","hide","Dom","clean","Timeman","containerNode","ustatOnlineContainerNode","timemanValueNodes","querySelectorAll","timemanTextNodes","resizeTimemanText","subscribePullEvent","textSum","valueSum","isArrayLike","text","textItems","textContent","length","value","valueItems","addClass","removeClass","innerHTML","redrawTimeman","PULL","moduleId","command","callback","namespace","Reflection","UstatOnline","maxUserToShow","maxOnlineUserCountToday","currentUserId","parseInt","isFullAnimationMode","limitOnlineSeconds","renderingFinished","userBlockNode","allOnlineUserIdToday","map","user","id","offline_date","getOfflineDate","last_activity_date","online","concat","counter","ITEMS","obClientDb","obClientDbData","obClientDbDataSearchIndex","bMenuInitialized","initialized","sonetgroups","menuitems","oDbSearchResult","Finder","onCustomEvent","UI","Hint","init","timemanObj","now","Date","currentDate","getFullYear","getMonth","getDate","valueOf","checkOnline","setTimeout","setInterval","addCustomEvent","window","proxy","updateOnlineRestrictedMode","count","redrawOnline","date","getTime","filter","prevCounter","el","reduce","checkNewDay","today","checkTimeman","userId","getNumberUserId","findUser","isExtranet","setUserToLocal","error","element","isUserOnline","forEach","unshift","list","requestUserList","counterFindUser","promises","Promise","resolve","reject","all","requestCount","slice","rest","callMethod","ID","result","collection","userData","name","avatar","MessengerCommon","isBlankAvatar","skipRest","find","getUserFromMessenger","getUserFromDb","getUserFromServer","addUserToDb","getUser","toISOString","indexedDB","getValue","entityId","addValue","external_auth_id","extranet","active","setUserOnline","String","replace","document","visibilityState","showCircleAnimation","renderAllUser","renderedUserIds","newUserIds","item","onlineToShow","renderedUserNodes","renderedItemId","getAttribute","remove","renderedUserCount","showAnimation","userIndex","stepRender","renderUser","elements","firstElement","lastElement","elementUserId","removedUserId","isDocumentVisible","style","zIndex","event","userStyle","itemsClasses","userItem","create","attrs","children","prepend","currentUserOnlineCount","maxUserOnlineCount","progressPercent","circle","Circle","updateCounter"],"mappings":"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"}