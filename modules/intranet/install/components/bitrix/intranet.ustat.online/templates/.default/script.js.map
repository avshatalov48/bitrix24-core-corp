{"version":3,"file":"script.js","sources":["src/popup.js","src/timeman.js","src/index.js"],"sourcesContent":["import {Type, Event, Loc, Text, Tag, Dom} from 'main.core';\nimport {Popup} from 'main.popup';\n\nexport class UserPopup\n{\n\tconstructor(parent)\n\t{\n\t\tthis.parent = parent;\n\t\tthis.signedParameters = this.parent.signedParameters;\n\t\tthis.componentName = this.parent.componentName;\n\t\tthis.userInnerBlockNode = this.parent.userInnerBlockNode || \"\";\n\t\tthis.timemanNode = this.parent.timemanNode;\n\t\tthis.circleNode = this.parent.circleNode || \"\";\n\t\tthis.isPopupShown = false;\n\t\tthis.popupCurrentPage = {};\n\t\tthis.renderedUsers = [];\n\n\t\tEvent.bind(this.userInnerBlockNode, 'click', () => {\n\t\t\tthis.showPopup('getAllOnlineUser', this.userInnerBlockNode);\n\t\t});\n\n\t\tEvent.bind(this.circleNode, 'click', () => {\n\t\t\tthis.showPopup('getAllOnlineUser', this.circleNode, -5);\n\t\t});\n\n\t\tif (this.parent.isTimemanAvailable && Type.isDomNode(this.parent.timemanNode))\n\t\t{\n\t\t\tlet openedNode = this.timemanNode.querySelector('.js-ustat-online-timeman-opened-block');\n\t\t\tlet closedNode = this.timemanNode.querySelector('.js-ustat-online-timeman-closed-block');\n\n\t\t\tEvent.bind(openedNode, 'click', () => {\n\t\t\t\tthis.showPopup('getOpenedTimemanUser', openedNode);\n\t\t\t});\n\n\t\t\tEvent.bind(closedNode, 'click', () => {\n\t\t\t\tthis.showPopup('getClosedTimemanUser', closedNode);\n\t\t\t});\n\t\t}\n\t}\n\n\tgetPopupTitle(action)\n\t{\n\t\tlet title = \"\";\n\n\t\tif (action === \"getAllOnlineUser\")\n\t\t{\n\t\t\ttitle = Loc.getMessage(\"INTRANET_USTAT_ONLINE_USERS\");\n\t\t}\n\t\telse if (action === \"getOpenedTimemanUser\")\n\t\t{\n\t\t\ttitle = Loc.getMessage(\"INTRANET_USTAT_ONLINE_STARTED_DAY\");\n\t\t}\n\t\telse if (action === \"getClosedTimemanUser\")\n\t\t{\n\t\t\ttitle = Loc.getMessage(\"INTRANET_USTAT_ONLINE_FINISHED_DAY\");\n\t\t}\n\n\t\treturn title;\n\t}\n\n\tshowPopup(action, bindNode, topOffset)\n\t{\n\t\tif (this.isPopupShown)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (Type.isUndefined(topOffset))\n\t\t{\n\t\t\ttopOffset = 7;\n\t\t}\n\n\t\tthis.popupCurrentPage[action] = 1;\n\t\tthis.popupInnerContainer = \"\";\n\t\tthis.renderedUsers = [];\n\n\t\tthis.allOnlineUserPopup = new Popup(`intranet-ustat-online-popup-${Text.getRandom()}`, bindNode, {\n\t\t\tlightShadow : true,\n\t\t\toffsetLeft: action === 'getClosedTimemanUser' ? -60 : -22,\n\t\t\toffsetTop: topOffset,\n\t\t\tautoHide: true,\n\t\t\tcloseByEsc: true,\n\t\t\tbindOptions: {\n\t\t\t\tposition: 'bottom'\n\t\t\t},\n\t\t\tanimationOptions: {\n\t\t\t\tshow: {\n\t\t\t\t\ttype: 'opacity-transform'\n\t\t\t\t},\n\t\t\t\tclose: {\n\t\t\t\t\ttype: 'opacity'\n\t\t\t\t}\n\t\t\t},\n\t\t\tevents : {\n\t\t\t\tonPopupDestroy: () => {\n\t\t\t\t\tthis.isPopupShown = false;\n\t\t\t\t},\n\t\t\t\tonPopupClose: () => {\n\t\t\t\t\tthis.allOnlineUserPopup.destroy();\n\t\t\t\t},\n\t\t\t\tonAfterPopupShow: (popup) => {\n\n\t\t\t\t\tlet popupContent = Tag.render`\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<span class=\"intranet-ustat-online-popup-name-title\">\n\t\t\t\t\t\t\t\t${this.getPopupTitle(action)}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t<div class=\"intranet-ustat-online-popup-container\">\n\t\t\t\t\t\t\t\t<div class=\"intranet-ustat-online-popup-content\">\n\t\t\t\t\t\t\t\t\t<div class=\"intranet-ustat-online-popup-content-box\">\n\t\t\t\t\t\t\t\t\t\t<div class=\"intranet-ustat-online-popup-inner\"></div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t`;\n\n\t\t\t\t\tpopup.contentContainer.appendChild(popupContent);\n\t\t\t\t\tthis.popupInnerContainer = popupContent.querySelector(\".intranet-ustat-online-popup-inner\");\n\t\t\t\t\tthis.loader = this.showLoader({\n\t\t\t\t\t\tnode: popupContent.querySelector(\".intranet-ustat-online-popup-content\"),\n\t\t\t\t\t\tloader: null,\n\t\t\t\t\t\tsize: 40\n\t\t\t\t\t});\n\t\t\t\t\tthis.showUsersInPopup(action);\n\t\t\t\t\tthis.isPopupShown = true;\n\t\t\t\t}\n\t\t\t},\n\t\t\tclassName: 'intranet-ustat-online-popup'\n\t\t});\n\n\t\tthis.popupScroll(action);\n\t\tthis.allOnlineUserPopup.show();\n\t}\n\n\tpopupScroll(action)\n\t{\n\t\tif (!Type.isDomNode(this.popupInnerContainer))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tEvent.bind(this.popupInnerContainer, 'scroll', () => {\n\t\t\tif (this.popupInnerContainer.scrollTop > (this.popupInnerContainer.scrollHeight - this.popupInnerContainer.offsetHeight) / 1.5)\n\t\t\t{\n\t\t\t\tthis.showUsersInPopup(action);\n\t\t\t\tEvent.unbindAll(this.popupInnerContainer, 'scroll');\n\t\t\t}\n\t\t});\n\t};\n\n\tshowUsersInPopup(action)\n\t{\n\t\tif (\n\t\t\taction !== 'getAllOnlineUser'\n\t\t\t&& action !== 'getOpenedTimemanUser'\n\t\t\t&& action !== 'getClosedTimemanUser'\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tBX.ajax.runComponentAction(this.componentName, action, {\n\t\t\tsignedParameters: this.signedParameters,\n\t\t\tmode: 'class',\n\t\t\tdata: {\n\t\t\t\tpageNum: this.popupCurrentPage[action]\n\t\t\t}\n\t\t}).then((response) => {\n\t\t\tif (response.data)\n\t\t\t{\n\t\t\t\tthis.renderPopupUsers(response.data);\n\t\t\t\tthis.popupCurrentPage[action]++;\n\t\t\t\tthis.popupScroll(action);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (!this.popupInnerContainer.hasChildNodes())\n\t\t\t\t{\n\t\t\t\t\tthis.popupInnerContainer.innerText = Loc.getMessage('INTRANET_USTAT_ONLINE_EMPTY');\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.hideLoader({loader: this.loader});\n\t\t}, (response) =>{\n\t\t\tthis.hideLoader({loader: this.loader});\n\t\t});\n\t}\n\n\trenderPopupUsers(users)\n\t{\n\t\tif (\n\t\t\t!this.allOnlineUserPopup\n\t\t\t|| !Type.isDomNode(this.popupInnerContainer)\n\t\t\t|| !Type.isObjectLike(users)\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tfor (let i in users)\n\t\t{\n\t\t\tif (!users.hasOwnProperty(i) || this.renderedUsers.indexOf(users[i]['ID']) >= 0)\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tthis.renderedUsers.push(users[i]['ID']);\n\n\t\t\tlet avatarIcon = \"<i></i>\";\n\n\t\t\tif (Type.isString(users[i]['AVATAR']) && users[i]['AVATAR'])\n\t\t\t{\n\t\t\t\tavatarIcon = `<i style=\"background-image: url('${encodeURI(users[i]['AVATAR'])}')\"></i>`;\n\t\t\t}\n\n\t\t\tconst userNode = Tag.render`\n\t\t\t\t<a \n\t\t\t\t\tclass=\"intranet-ustat-online-popup-item\"\n\t\t\t\t\thref=\"${users[i]['PATH_TO_USER_PROFILE']}\" \n\t\t\t\t\ttarget=\"_blank\"\n\t\t\t\t>\n\t\t\t\t\t<span class=\"intranet-ustat-online-popup-avatar-new\">\n\t\t\t\t\t\t<div class=\"ui-icon ui-icon-common-user intranet-ustat-online-popup-avatar-img\">\n\t\t\t\t\t\t\t${avatarIcon}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<span class=\"intranet-ustat-online-popup-avatar-status-icon\"></span>\n\t\t\t\t\t</span>\n\t\t\t\t\t<span class=\"intranet-ustat-online-popup-name\">\n\t\t\t\t\t\t${users[i]['NAME']}\n\t\t\t\t\t</span>\n\t\t\t\t</a>\n\t\t\t`;\n\n\t\t\tthis.popupInnerContainer.appendChild(userNode);\n\t\t}\n\t}\n\n\tshowLoader(params)\n\t{\n\t\tlet loader = null;\n\n\t\tif (params.node)\n\t\t{\n\t\t\tif (params.loader === null)\n\t\t\t{\n\t\t\t\tloader = new BX.Loader({\n\t\t\t\t\ttarget: params.node,\n\t\t\t\t\tsize: params.hasOwnProperty(\"size\") ? params.size : 40\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tloader = params.loader;\n\t\t\t}\n\n\t\t\tloader.show();\n\t\t}\n\n\t\treturn loader;\n\t}\n\n\thideLoader(params)\n\t{\n\t\tif (params.loader !== null)\n\t\t{\n\t\t\tparams.loader.hide();\n\t\t}\n\n\t\tif (params.node)\n\t\t{\n\t\t\tDom.clean(params.node);\n\t\t}\n\n\t\tif (params.loader !== null)\n\t\t{\n\t\t\tparams.loader = null;\n\t\t}\n\t}\n}","import {Type, Dom} from 'main.core';\nimport {PULL} from \"pull.client\";\n\nexport class Timeman\n{\n\tconstructor(parent)\n\t{\n\t\tthis.parent = parent;\n\t\tthis.signedParameters = this.parent.signedParameters;\n\t\tthis.componentName = this.parent.componentName;\n\t\tthis.isTimemanAvailable = this.parent.isTimemanAvailable;\n\t\tthis.timemanNode = this.parent.timemanNode;\n\t\tthis.containerNode = this.parent.ustatOnlineContainerNode;\n\n\t\tif (this.isTimemanAvailable && Type.isDomNode(this.timemanNode))\n\t\t{\n\t\t\tthis.timemanValueNodes = this.timemanNode.querySelectorAll('.intranet-ustat-online-value');\n\t\t\tthis.timemanTextNodes =  this.timemanNode.querySelectorAll('.js-ustat-online-timeman-text');\n\n\t\t\tthis.resizeTimemanText();\n\t\t\tthis.subscribePullEvent();\n\t\t}\n\t}\n\n\tresizeTimemanText()\n\t{\n\t\tif (!Type.isDomNode(this.timemanNode))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet textSum = 0;\n\t\tlet valueSum = 0;\n\n\t\tif (Type.isArrayLike(this.timemanTextNodes))\n\t\t{\n\t\t\tfor (let text of this.timemanTextNodes)\n\t\t\t{\n\t\t\t\tlet textItems = text.textContent.length;\n\t\t\t\ttextSum += textItems;\n\t\t\t}\n\t\t}\n\n\t\tif (Type.isArrayLike(this.timemanValueNodes))\n\t\t{\n\t\t\tfor (let value of this.timemanValueNodes)\n\t\t\t{\n\t\t\t\tlet valueItems = value.textContent.length;\n\t\t\t\tvalueSum += valueItems;\n\t\t\t}\n\t\t}\n\n\t\tif (textSum >= 17 && valueSum >= 6 || textSum >= 19 && valueSum >= 4)\n\t\t{\n\t\t\tDom.addClass(this.timemanNode, 'intranet-ustat-online-info-text-resize');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.removeClass(this.timemanNode, 'intranet-ustat-online-info-text-resize');\n\t\t}\n\t}\n\n\tredrawTimeman(data)\n\t{\n\t\tif (data.hasOwnProperty(\"OPENED\"))\n\t\t{\n\t\t\tlet openedNode = this.containerNode.querySelector('.js-ustat-online-timeman-opened');\n\t\t\tif (Type.isDomNode(openedNode))\n\t\t\t{\n\t\t\t\topenedNode.innerHTML = data[\"OPENED\"];\n\t\t\t}\n\t\t}\n\n\t\tif (data.hasOwnProperty(\"CLOSED\"))\n\t\t{\n\t\t\tlet closedNode = this.containerNode.querySelector('.js-ustat-online-timeman-closed');\n\t\t\tif (Type.isDomNode(closedNode))\n\t\t\t{\n\t\t\t\tclosedNode.innerHTML = data[\"CLOSED\"];\n\t\t\t}\n\t\t}\n\n\t\tthis.resizeTimemanText();\n\t}\n\n\tcheckTimeman()\n\t{\n\t\tBX.ajax.runComponentAction(this.componentName, \"checkTimeman\", {\n\t\t\tsignedParameters: this.signedParameters,\n\t\t\tmode: 'class'\n\t\t}).then((response) => {\n\t\t\tif (response.data)\n\t\t\t{\n\t\t\t\tthis.redrawTimeman(response.data);\n\t\t\t}\n\t\t});\n\t}\n\n\tsubscribePullEvent()\n\t{\n\t\tPULL.subscribe({\n\t\t\tmoduleId: 'intranet',\n\t\t\tcommand: 'timemanDayInfo',\n\t\t\tcallback: (data) =>\n\t\t\t{\n\t\t\t\tthis.redrawTimeman(data);\n\t\t\t}\n\t\t});\n\t}\n}","import {Type, Dom, Reflection, Event} from 'main.core';\nimport {rest} from \"rest.client\";\nimport \"pull.client\";\nimport {UserPopup} from './popup';\nimport {Timeman} from './timeman';\nimport {Circle} from 'ui.graph.circle';\n\nconst namespace = Reflection.namespace('BX.Intranet');\n\nclass UstatOnline\n{\n\tconstructor(params)\n\t{\n\t\tthis.signedParameters = params.signedParameters;\n\t\tthis.componentName = params.componentName;\n\t\tthis.ustatOnlineContainerNode = params.ustatOnlineContainerNode || \"\";\n\t\tthis.maxUserToShow = params.maxUserToShow;\n\t\tthis.maxOnlineUserCountToday = params.maxOnlineUserCountToday;\n\t\tthis.currentUserId = parseInt(params.currentUserId);\n\t\tthis.isTimemanAvailable = params.isTimemanAvailable === \"Y\";\n\t\tthis.isFullAnimationMode = params.isFullAnimationMode === \"Y\";\n\t\tthis.limitOnlineSeconds = params.limitOnlineSeconds;\n\t\tthis.renderingFinished = true;\n\n\t\tif (!Type.isDomNode(this.ustatOnlineContainerNode))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.userBlockNode = this.ustatOnlineContainerNode.querySelector('.intranet-ustat-online-icon-box');\n\t\tthis.userInnerBlockNode = this.ustatOnlineContainerNode.querySelector('.intranet-ustat-online-icon-inner');\n\t\tthis.circleNode = this.ustatOnlineContainerNode.querySelector('.ui-graph-circle');\n\t\tthis.timemanNode = this.ustatOnlineContainerNode.querySelector('.intranet-ustat-online-info');\n\n\t\tlet users = params.users;\n\t\tlet allOnlineUserIdToday = params.allOnlineUserIdToday;\n\n\t\tthis.users = users.map(user => {\n\t\t\tuser.id = parseInt(user.id);\n\t\t\tuser.offline_date = this.getOfflineDate(user.last_activity_date);\n\t\t\treturn user;\n\t\t});\n\n\t\tthis.allOnlineUserIdToday = allOnlineUserIdToday.map(id => {\n\t\t\treturn parseInt(id);\n\t\t});\n\n\t\tthis.online = [].concat(this.users);\n\t\tthis.counter = 0;\n\n\t\t//-------------- for IndexedDb\n\t\tthis.ITEMS = {\n\t\t\tobClientDb: null,\n\t\t\tobClientDbData: {},\n\t\t\tobClientDbDataSearchIndex: {},\n\t\t\tbMenuInitialized: false,\n\t\t\tinitialized: {\n\t\t\t\tsonetgroups: false,\n\t\t\t\tmenuitems: false\n\t\t\t},\n\t\t\toDbSearchResult: {}\n\t\t};\n\n\t\tBX.Finder(false, 'searchTitle', [], {}, this);\n\t\tBX.onCustomEvent(this, 'initFinderDb', [ this.ITEMS, 'searchTitle', null, ['users'], this ]);\n\t\t//---------------\n\n\t\tif (Type.isDomNode(this.ustatOnlineContainerNode))\n\t\t{\n\t\t\tBX.UI.Hint.init(this.ustatOnlineContainerNode);\n\t\t}\n\n\t\tnew UserPopup(this);\n\t\tthis.timemanObj = new Timeman(this);\n\n\t\tconst now = new Date();\n\t\tthis.currentDate = new Date(now.getFullYear(), now.getMonth(), now.getDate()).valueOf();\n\n\t\tthis.checkOnline();\n\n\t\tif (this.isFullAnimationMode)\n\t\t{\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.subscribePullEvent();\n\t\t\t}, 3000);\n\n\t\t\tsetInterval(() => this.checkOnline(), 60000);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tBX.addCustomEvent(window, \"onImUpdateUstatOnline\", BX.proxy(this.updateOnlineRestrictedMode, this));\n\t\t}\n\t}\n\n\tupdateOnlineRestrictedMode(data)\n\t{\n\t\tthis.counter = data.count;\n\t\tthis.maxOnlineUserCountToday = data.count;\n\t\tthis.online = data.users;\n\t\tthis.redrawOnline();\n\t}\n\n\tgetOfflineDate(date)\n\t{\n\t\treturn date? new Date(date).getTime() + parseInt(this.limitOnlineSeconds)*1000: null;\n\t}\n\n\tcheckOnline()\n\t{\n\t\tthis.online = this.online.filter(user => {\n\t\t\treturn (user && (user.offline_date > +new Date() || user.id === this.currentUserId));\n\t\t});\n\n\t\tlet prevCounter = this.counter;\n\n\t\tif (this.online.length > 0)\n\t\t{\n\t\t\tthis.counter = this.online.map(el => 1).reduce(count => count + 1);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.counter = 0;\n\t\t}\n\n\t\tif (this.checkNewDay() || prevCounter !== this.counter)\n\t\t{\n\t\t\tthis.redrawOnline();\n\t\t}\n\t}\n\n\tcheckNewDay()\n\t{\n\t\tconst now = new Date();\n\t\tconst today = new Date(now.getFullYear(), now.getMonth(), now.getDate()).valueOf();\n\n\t\tif (this.currentDate < today) //new day\n\t\t{\n\t\t\tthis.maxOnlineUserCountToday = this.online.length;\n\n\t\t\tif (this.isTimemanAvailable)\n\t\t\t{\n\t\t\t\tthis.timemanObj.checkTimeman();\n\t\t\t}\n\n\t\t\tthis.currentDate = today;\n\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tsetUserOnline(params)\n\t{\n\t\tconst userId = this.getNumberUserId(params.id);\n\n\t\tthis.findUser(userId).then(user => {\n\t\t\tuser.id = this.getNumberUserId(user.id);\n\n\t\t\tif (typeof params.last_activity_date !== \"undefined\")\n\t\t\t{\n\t\t\t\tuser.last_activity_date = params.last_activity_date;\n\t\t\t}\n\n\t\t\tif (user.isExtranet !== \"Y\")\n\t\t\t{\n\t\t\t\tthis.setUserToLocal(user);\n\t\t\t\tthis.checkOnline();\n\t\t\t}\n\t\t}).catch(error => {});\n\t}\n\n\tsetUserToLocal(user)\n\t{\n\t\tuser.offline_date = this.getOfflineDate(user.last_activity_date);\n\n\t\tthis.users = this.users.filter(element => element.id !== user.id);\n\t\tthis.users.push(user);\n\n\t\tlet isUserOnline = false;\n\t\tthis.online.forEach((element) => {\n\t\t\tif (element.id === user.id)\n\t\t\t{\n\t\t\t\tisUserOnline = true;\n\t\t\t}\n\t\t});\n\n\t\tif (!isUserOnline)\n\t\t{\n\t\t\tthis.online.unshift(user);\n\t\t}\n\n\t\tif (this.allOnlineUserIdToday.indexOf(user.id) === -1)\n\t\t{\n\t\t\tthis.allOnlineUserIdToday.push(user.id);\n\t\t\tthis.maxOnlineUserCountToday++;\n\t\t}\n\t}\n\n\tsetUserOnlineMultiply(list)\n\t{\n\t\tlet requestUserList = [];\n\t\tlet counterFindUser = 0;\n\t\tlet promises = [];\n\n\t\tlist.forEach(user => {\n\n\t\t\tlet userId = parseInt(user.id);\n\t\t\tpromises.push(new Promise((resolve, reject) => {\n\t\t\t\tthis.findUser(userId, true).then(user => {\n\t\t\t\t\tcounterFindUser++;\n\t\t\t\t\tthis.setUserToLocal(user);\n\t\t\t\t\tresolve();\n\t\t\t\t}).catch(error => {\n\t\t\t\t\trequestUserList.push(userId);\n\t\t\t\t\tresolve();\n\t\t\t\t});\n\t\t\t}));\n\t\t});\n\n\t\tPromise.all(promises).then(() => {\n\t\t\tif (requestUserList.length <= 0)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tconst requestCount = this.maxUserToShow-counterFindUser;\n\n\t\t\tif (requestCount <= 0)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\trequestUserList = requestUserList.slice(0, requestCount);\n\n\t\t\tBX.rest.callMethod('im.user.list.get', {ID: requestUserList}).then(result => {\n\t\t\t\tlet collection = result.data();\n\t\t\t\tif (!collection)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tfor (let userId in collection)\n\t\t\t\t{\n\t\t\t\t\tif (!collection.hasOwnProperty(userId))\n\t\t\t\t\t{\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst userData = collection[userId];\n\t\t\t\t\tif (!userData)\n\t\t\t\t\t{\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\tlet user = {};\n\t\t\t\t\tuser.id = parseInt(userData.id);\n\t\t\t\t\tuser.name = userData.name;\n\t\t\t\t\tuser.avatar = BX.MessengerCommon.isBlankAvatar(userData.avatar)? '': userData.avatar;\n\t\t\t\t\tuser.last_activity_date = userData.last_activity_date;\n\n\t\t\t\t\tthis.setUserToLocal(user);\n\t\t\t\t}\n\t\t\t}).catch(error => {});\n\t\t});\n\t}\n\n\tfindUser(userId, skipRest = false)\n\t{\n\t\tuserId = parseInt(userId);\n\n\t\treturn new Promise((resolve, reject) => {\n\n\t\t\tlet user = null;\n\n\t\t\tuser = this.users.find(element => element.id === userId);\n\t\t\tif (user)\n\t\t\t{\n\t\t\t\tresolve(user);\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tuser = this.getUserFromMessenger(userId);\n\t\t\tif (user)\n\t\t\t{\n\t\t\t\tresolve(user);\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tthis.getUserFromDb(userId).then(user => {\n\t\t\t\tresolve(user);\n\t\t\t\treturn true;\n\t\t\t}).catch(error => {\n\n\t\t\t\tif (skipRest)\n\t\t\t\t{\n\t\t\t\t\treject(null);\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\tthis.getUserFromServer(userId).then(user => {\n\t\t\t\t\tthis.addUserToDb(user);\n\t\t\t\t\tresolve(user);\n\t\t\t\t}).catch(error => {\n\t\t\t\t\treject(null);\n\t\t\t\t});\n\t\t\t});\n\n\t\t\treturn true;\n\t\t});\n\t}\n\n\tgetUserFromMessenger(userId)\n\t{\n\t\tif (typeof window.BX.MessengerCommon === 'undefined')\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tlet result = BX.MessengerCommon.getUser(userId);\n\t\tif (!result)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tlet user = {\n\t\t\tid: parseInt(result.id),\n\t\t\tname: result.name,\n\t\t\tavatar: BX.MessengerCommon.isBlankAvatar(result.avatar)? '': result.avatar,\n\t\t\tlast_activity_date: null,\n\t\t};\n\n\t\tif (result.last_activity_date instanceof Date)\n\t\t{\n\t\t\tuser.last_activity_date = result.last_activity_date.toISOString()\n\t\t}\n\t\tif (typeof result.last_activity_date === 'string')\n\t\t{\n\t\t\tuser.last_activity_date = result.last_activity_date\n\t\t}\n\n\t\treturn user;\n\t}\n\n\tgetUserFromDb(userId)\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tBX.indexedDB.getValue(this.ITEMS.obClientDb, \"users\", \"U\" + userId).then((user) => {\n\t\t\t\tif (user && typeof user === 'object')\n\t\t\t\t{\n\t\t\t\t\tif (user.hasOwnProperty(\"entityId\"))\n\t\t\t\t\t{\n\t\t\t\t\t\tuser.id = this.getNumberUserId(user.entityId);\n\t\t\t\t\t}\n\t\t\t\t\tresolve(user);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tresolve(null);\n\t\t\t\t}\n\t\t\t}).catch(error => {\n\t\t\t\treject(null);\n\t\t\t});\n\t\t});\n\t}\n\n\taddUserToDb(user)\n\t{\n\t\tuser.id = \"U\" + user.id;\n\t\tBX.indexedDB.addValue(this.ITEMS.obClientDb, 'users', user);\n\t}\n\n\tgetUserFromServer(userId)\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\n\t\t\tif (typeof window.BX.MessengerCommon === 'undefined')\n\t\t\t{\n\t\t\t\tresolve(null);\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\trest.callMethod('im.user.get', {id: userId}).then(result => {\n\t\t\t\tif (result.data() && result.data().external_auth_id !== \"__controller\")\n\t\t\t\t{\n\t\t\t\t\tlet user = {};\n\t\t\t\t\tuser.id = parseInt(result.data().id);\n\t\t\t\t\tuser.name = result.data().name;\n\t\t\t\t\tuser.avatar = BX.MessengerCommon.isBlankAvatar(result.data().avatar)? '': result.data().avatar;\n\t\t\t\t\tuser.last_activity_date = result.data().last_activity_date;\n\t\t\t\t\tuser.isExtranet = result.data().extranet ? \"Y\" : \"N\";\n\t\t\t\t\tuser.active = \"Y\";\n\t\t\t\t\tuser.entityId = parseInt(result.data().id);\n\n\t\t\t\t\tresolve(user);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tresolve(null);\n\t\t\t\t}\n\t\t\t}).catch(error => {\n\t\t\t\tresolve(null);\n\t\t\t});\n\t\t});\n\t}\n\n\tsubscribePullEvent()\n\t{\n\t\tBX.PULL.subscribe({\n\t\t\ttype: 'online',\n\t\t\tcallback: (data) =>\n\t\t\t{\n\t\t\t\tif (data.command === 'userStatus')\n\t\t\t\t{\n\t\t\t\t\tfor (let userId in data.params.users)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (!data.params.users.hasOwnProperty(userId))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis.setUserOnline(data.params.users[userId]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t/*else if (data.command === 'list')\n\t\t\t\t{\n\t\t\t\t\tlet list = [];\n\n\t\t\t\t\tfor (let userId in data.params.users)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (data.params.users.hasOwnProperty(userId))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlist.push({\n\t\t\t\t\t\t\t\tid: data.params.users[userId].id,\n\t\t\t\t\t\t\t\tlast_activity_date: data.params.users[userId].last_activity_date\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.setUserOnlineMultiply(list);\n\t\t\t\t}*/\n\t\t\t}\n\t\t});\n\t}\n\n\tgetNumberUserId(id)\n\t{\n\t\tif (!id)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet userId = String(id);\n\t\tuserId = userId.replace('U', '');\n\t\treturn parseInt(userId);\n\t}\n\n\tisDocumentVisible()\n\t{\n\t\treturn document.visibilityState === 'visible';\n\t}\n\n\tredrawOnline()\n\t{\n\t\tthis.showCircleAnimation(this.circleNode, this.counter, this.maxOnlineUserCountToday);\n\t\tif (this.renderingFinished)\n\t\t{\n\t\t\tthis.renderingFinished = false;\n\t\t\tthis.renderAllUser();\n\t\t}\n\t}\n\n\trenderAllUser()\n\t{\n\t\tlet renderedUserIds = [];\n\t\tlet newUserIds = [];\n\n\t\tthis.online.forEach((item) => {\n\t\t\tnewUserIds.push(parseInt(item.id));\n\t\t});\n\n\t\tconst onlineToShow = newUserIds.slice(0, this.maxUserToShow);\n\n\t\tlet renderedUserNodes = this.userBlockNode.querySelectorAll(\".js-ustat-online-user\");\n\n\t\tif (this.online.length > 100 && renderedUserNodes.length >= this.maxUserToShow)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tfor (let item in renderedUserNodes)\n\t\t{\n\t\t\tif (!renderedUserNodes.hasOwnProperty(item))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tlet renderedItemId = parseInt(renderedUserNodes[item].getAttribute(\"data-user-id\"));\n\n\t\t\tif (newUserIds.indexOf(renderedItemId) === -1)\n\t\t\t{\n\t\t\t\tif (Type.isDomNode(renderedUserNodes[item]))\n\t\t\t\t{\n\t\t\t\t\tDom.remove(renderedUserNodes[item]); //remove offline avatars\n\t\t\t\t\t/*renderedUserNodes[item].classList.add('intranet-ustat-online-icon-hide');\n\t\t\t\t\tsetTimeout( () => {\n\n\t\t\t\t\t}, 800);*/\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\trenderedUserIds.push(parseInt(renderedItemId));\n\t\t\t}\n\t\t}\n\n\t\trenderedUserNodes = this.userBlockNode.querySelectorAll(\".js-ustat-online-user\");\n\n\t\tlet renderedUserCount = renderedUserNodes.length;\n\t\tconst showAnimation = renderedUserCount !== 0;\n\t\tthis.userIndex = this.online.length;\n\n\t\tlet stepRender = (i) => {\n\t\t\tif (i >= this.maxUserToShow || i >= this.online.length)\n\t\t\t{\n\t\t\t\tthis.renderingFinished = true;\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tnew Promise((resolve) => {\n\t\t\t\tlet item = this.online[i];\n\n\t\t\t\tif (renderedUserIds.indexOf(item.id) >= 0)\n\t\t\t\t{\n\t\t\t\t\tresolve();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (renderedUserCount < this.maxUserToShow)\n\t\t\t\t{\n\t\t\t\t\tif (showAnimation)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.userIndex++;\n\t\t\t\t\t}\n\t\t\t\t\tthis.renderUser(item, showAnimation);\n\t\t\t\t\trenderedUserIds.push(item.id);\n\t\t\t\t\trenderedUserCount++;\n\t\t\t\t\tif (!showAnimation)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.userIndex = this.userIndex - 1;\n\t\t\t\t\t}\n\n\t\t\t\t\tresolve();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tconst elements = this.userBlockNode.querySelectorAll(\".js-ustat-online-user\");\n\t\t\t\t\tconst firstElement = elements[0];\n\t\t\t\t\tlet lastElement = \"\";\n\n\t\t\t\t\tfor (let i = elements.length - 1; i >= 0; i--)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (Type.isDomNode(elements[i]))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst elementUserId = parseInt(elements[i].getAttribute(\"data-user-id\"));\n\t\t\t\t\t\t\tif (onlineToShow.indexOf(elementUserId) === -1)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tlastElement = elements[i];\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (Type.isDomNode(lastElement))\n\t\t\t\t\t{\n\t\t\t\t\t\tconst removedUserId = parseInt(lastElement.getAttribute(\"data-user-id\"));\n\n\t\t\t\t\t\tDom.removeClass(lastElement, 'intranet-ustat-online-icon-show');\n\t\t\t\t\t\tif (this.isDocumentVisible())\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tDom.addClass(lastElement, 'intranet-ustat-online-icon-hide');\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis.userIndex = parseInt(firstElement.style.zIndex);\n\t\t\t\t\t\tthis.userIndex++;\n\n\t\t\t\t\t\tthis.renderUser(item, showAnimation);\n\t\t\t\t\t\trenderedUserIds = renderedUserIds.filter(id => id !== removedUserId);\n\t\t\t\t\t\trenderedUserIds.push(item.id);\n\n\t\t\t\t\t\tif (this.isDocumentVisible())\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tEvent.bind(lastElement, 'animationend', (event) => {\n\t\t\t\t\t\t\t\tDom.remove(lastElement);\n\t\t\t\t\t\t\t\tresolve();\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tDom.remove(lastElement);\n\t\t\t\t\t\t\tresolve();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tresolve();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}).then(() => {\n\t\t\t\tstepRender(++i);\n\t\t\t});\n\t\t};\n\n\t\tstepRender(0);\n\t}\n\n\trenderUser(user, showAnimation)\n\t{\n\t\tif (!user || typeof user !== 'object')\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet userStyle = \"\";\n\t\tif (user.avatar)\n\t\t{\n\t\t\tuserStyle = 'background-image: url(\"' + encodeURI(user.avatar) + '\");';\n\t\t}\n\n\t\tconst userId = this.getNumberUserId(user.id);\n\n\t\tlet itemsClasses = `ui-icon ui-icon-common-user intranet-ustat-online-icon js-ustat-online-user\n\t\t\t${showAnimation && this.isDocumentVisible() ? ' intranet-ustat-online-icon-show' : ''}`;\n\n\t\tthis.userItem = BX.create('span', {\n\t\t\tattrs: {\n\t\t\t\tclassName: itemsClasses,\n\t\t\t\t\"data-user-id\" : userId\n\t\t\t},\n\t\t\tstyle: {\n\t\t\t\tzIndex: this.userIndex\n\t\t\t},\n\t\t\tchildren: [\n\t\t\t\tBX.create('i', {\n\t\t\t\t\tattrs: { style: userStyle}\n\t\t\t\t})\n\t\t\t]\n\t\t});\n\n\t\tif (showAnimation)\n\t\t{\n\t\t\tDom.prepend(this.userItem, this.userInnerBlockNode);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.userInnerBlockNode.appendChild(this.userItem);\n\t\t}\n\t}\n\n\tshowCircleAnimation(circleNode, currentUserOnlineCount, maxUserOnlineCount)\n\t{\n\t\tmaxUserOnlineCount = parseInt(maxUserOnlineCount);\n\t\tcurrentUserOnlineCount = parseInt(currentUserOnlineCount);\n\n\t\tif (currentUserOnlineCount <= 0)\n\t\t{\n\t\t\tcurrentUserOnlineCount = 1;\n\t\t}\n\n\t\tif (currentUserOnlineCount > maxUserOnlineCount)\n\t\t{\n\t\t\tmaxUserOnlineCount = currentUserOnlineCount;\n\t\t}\n\n\t\tlet progressPercent = (currentUserOnlineCount*100)/maxUserOnlineCount;\n\n\t\tif (!this.circle)\n\t\t{\n\t\t\tthis.circle = new Circle(\n\t\t\t\tcircleNode,\n\t\t\t\t68,\n\t\t\t\tprogressPercent,\n\t\t\t\tcurrentUserOnlineCount,\n\t\t\t\ttrue,\n\t\t\t);\n\t\t\tthis.circle.show();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.circle.updateCounter(progressPercent, currentUserOnlineCount);\n\t\t}\n\t}\n}\n\nnamespace.UstatOnline = UstatOnline;\nexport {UstatOnline};\n"],"names":["UserPopup","parent","signedParameters","componentName","userInnerBlockNode","timemanNode","circleNode","isPopupShown","popupCurrentPage","renderedUsers","Event","bind","showPopup","isTimemanAvailable","Type","isDomNode","openedNode","querySelector","closedNode","action","title","Loc","getMessage","bindNode","topOffset","isUndefined","popupInnerContainer","allOnlineUserPopup","Popup","Text","getRandom","lightShadow","offsetLeft","offsetTop","autoHide","closeByEsc","bindOptions","position","animationOptions","show","type","close","events","onPopupDestroy","onPopupClose","destroy","onAfterPopupShow","popup","popupContent","Tag","render","getPopupTitle","contentContainer","appendChild","loader","showLoader","node","size","showUsersInPopup","className","popupScroll","scrollTop","scrollHeight","offsetHeight","unbindAll","BX","ajax","runComponentAction","mode","data","pageNum","then","response","renderPopupUsers","hasChildNodes","innerText","hideLoader","users","isObjectLike","i","hasOwnProperty","indexOf","push","avatarIcon","isString","encodeURI","userNode","params","Loader","target","hide","Dom","clean","Timeman","containerNode","ustatOnlineContainerNode","timemanValueNodes","querySelectorAll","timemanTextNodes","resizeTimemanText","subscribePullEvent","textSum","valueSum","isArrayLike","text","textItems","textContent","length","value","valueItems","addClass","removeClass","innerHTML","redrawTimeman","PULL","subscribe","moduleId","command","callback","namespace","Reflection","UstatOnline","maxUserToShow","maxOnlineUserCountToday","currentUserId","parseInt","isFullAnimationMode","limitOnlineSeconds","renderingFinished","userBlockNode","allOnlineUserIdToday","map","user","id","offline_date","getOfflineDate","last_activity_date","online","concat","counter","ITEMS","obClientDb","obClientDbData","obClientDbDataSearchIndex","bMenuInitialized","initialized","sonetgroups","menuitems","oDbSearchResult","Finder","onCustomEvent","UI","Hint","init","timemanObj","now","Date","currentDate","getFullYear","getMonth","getDate","valueOf","checkOnline","setTimeout","setInterval","addCustomEvent","window","proxy","updateOnlineRestrictedMode","count","redrawOnline","date","getTime","filter","prevCounter","el","reduce","checkNewDay","today","checkTimeman","userId","getNumberUserId","findUser","isExtranet","setUserToLocal","error","element","isUserOnline","forEach","unshift","list","requestUserList","counterFindUser","promises","Promise","resolve","reject","all","requestCount","slice","rest","callMethod","ID","result","collection","userData","name","avatar","MessengerCommon","isBlankAvatar","skipRest","find","getUserFromMessenger","getUserFromDb","getUserFromServer","addUserToDb","getUser","toISOString","indexedDB","getValue","entityId","addValue","external_auth_id","extranet","active","setUserOnline","String","replace","document","visibilityState","showCircleAnimation","renderAllUser","renderedUserIds","newUserIds","item","onlineToShow","renderedUserNodes","renderedItemId","getAttribute","remove","renderedUserCount","showAnimation","userIndex","stepRender","renderUser","elements","firstElement","lastElement","elementUserId","removedUserId","isDocumentVisible","style","zIndex","event","userStyle","itemsClasses","userItem","create","attrs","children","prepend","currentUserOnlineCount","maxUserOnlineCount","progressPercent","circle","Circle","updateCounter"],"mappings":"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"}