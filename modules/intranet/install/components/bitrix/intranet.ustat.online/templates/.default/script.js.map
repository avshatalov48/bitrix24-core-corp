{"version":3,"file":"script.js","sources":["src/popup.js","src/index.js"],"sourcesContent":["import {Type, Event, Loc} from 'main.core';\n\nexport class Popup\n{\n\tconstructor(parent)\n\t{\n\t\tthis.parent = parent;\n\t\tthis.signedParameters = this.parent.signedParameters;\n\t\tthis.componentName = this.parent.componentName;\n\t\tthis.userInnerBlockNode = this.parent.userInnerBlockNode || \"\";\n\t\tthis.circleNode = this.parent.circleNode || \"\";\n\t\tthis.isPopupShown = false;\n\t\tthis.popupCurrentPage = {};\n\t\tthis.renderedUsers = [];\n\n\t\tEvent.bind(this.userInnerBlockNode, 'click', () => {\n\t\t\tthis.showPopup('getAllOnlineUser', this.userInnerBlockNode);\n\t\t});\n\n\t\tEvent.bind(this.circleNode, 'click', () => {\n\t\t\tthis.showPopup('getAllOnlineUser', this.circleNode, -5);\n\t\t});\n\n\t\tif (this.parent.isTimemanAvailable && Type.isDomNode(this.parent.timemanNode))\n\t\t{\n\t\t\tlet openedNode = this.parent.timemanNode.querySelector('.js-ustat-online-timeman-opened-block');\n\t\t\tlet closedNode = this.parent.timemanNode.querySelector('.js-ustat-online-timeman-closed-block');\n\n\t\t\tEvent.bind(openedNode, 'click', () => {\n\t\t\t\tthis.showPopup('getOpenedTimemanUser', openedNode);\n\t\t\t});\n\n\t\t\tEvent.bind(closedNode, 'click', () => {\n\t\t\t\tthis.showPopup('getClosedTimemanUser', closedNode);\n\t\t\t});\n\t\t}\n\t}\n\n\tgetPopupTitle(action)\n\t{\n\t\tlet title = \"\";\n\t\tif (action === \"getAllOnlineUser\")\n\t\t{\n\t\t\ttitle = Loc.getMessage(\"INTRANET_USTAT_ONLINE_USERS\");\n\t\t}\n\t\telse if (action === \"getOpenedTimemanUser\")\n\t\t{\n\t\t\ttitle = Loc.getMessage(\"INTRANET_USTAT_ONLINE_STARTED_DAY\");\n\t\t}\n\t\telse if (action === \"getClosedTimemanUser\")\n\t\t{\n\t\t\ttitle = Loc.getMessage(\"INTRANET_USTAT_ONLINE_FINISHED_DAY\");\n\t\t}\n\n\t\treturn title;\n\t}\n\n\tshowPopup(action, bindNode, topOffset)\n\t{\n\t\tif (this.isPopupShown)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (Type.isUndefined(topOffset))\n\t\t{\n\t\t\ttopOffset = 7;\n\t\t}\n\n\t\tthis.popupCurrentPage[action] = 1;\n\t\tthis.popupInnerContainer = \"\";\n\t\tthis.renderedUsers = [];\n\n\t\tthis.allOnlineUserPopup = new BX.PopupWindow('intranet-ustat-online-popup', bindNode, {\n\t\t\tlightShadow : true,\n\t\t\toffsetLeft: action === 'getClosedTimemanUser' ? -60 : -22,\n\t\t\toffsetTop: topOffset,\n\t\t\tautoHide: true,\n\t\t\tcloseByEsc: true,\n\t\t\tbindOptions: {\n\t\t\t\tposition: 'bottom'\n\t\t\t},\n\t\t\tanimationOptions: {\n\t\t\t\tshow: {\n\t\t\t\t\ttype: 'opacity-transform'\n\t\t\t\t},\n\t\t\t\tclose: {\n\t\t\t\t\ttype: 'opacity'\n\t\t\t\t}\n\t\t\t},\n\t\t\tevents : {\n\t\t\t\tonPopupDestroy : function() {\n\t\t\t\t\tthis.isPopupShown = false;\n\t\t\t\t}.bind(this),\n\t\t\t\tonPopupClose: function() {\n\t\t\t\t\tthis.destroy();\n\t\t\t\t},\n\t\t\t\tonAfterPopupShow: function(popup)\n\t\t\t\t{\n\t\t\t\t\tlet popupContent = popup.contentContainer;\n\n\t\t\t\t\tlet popupContainer = BX.create('div', {\n\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\tclassName: 'intranet-ustat-online-popup-container'\n\t\t\t\t\t\t},\n\t\t\t\t\t});\n\n\t\t\t\t\tlet popupTitle = BX.create('span', {\n\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\tclassName: 'intranet-ustat-online-popup-name-title'\n\t\t\t\t\t\t},\n\t\t\t\t\t\ttext: this.getPopupTitle(action)\n\t\t\t\t\t});\n\n\t\t\t\t\tthis.popupInnerContainer = BX.create('div', {\n\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\tclassName: 'intranet-ustat-online-popup-inner'\n\t\t\t\t\t\t},\n\t\t\t\t\t});\n\n\t\t\t\t\tlet popupInnerContent = BX.create('div', {\n\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\tclassName: 'intranet-ustat-online-popup-content'\n\t\t\t\t\t\t},\n\t\t\t\t\t});\n\n\t\t\t\t\tlet popupInnerContentBox = BX.create('div', {\n\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\tclassName: 'intranet-ustat-online-popup-content-box'\n\t\t\t\t\t\t},\n\t\t\t\t\t});\n\n\t\t\t\t\tpopupContent.appendChild(popupTitle);\n\t\t\t\t\tpopupContent.appendChild(popupContainer);\n\t\t\t\t\tpopupContainer.appendChild(popupInnerContent);\n\t\t\t\t\tpopupInnerContent.appendChild(popupInnerContentBox);\n\t\t\t\t\tpopupInnerContentBox.appendChild(this.popupInnerContainer);\n\n\t\t\t\t\tthis.loader = this.showLoader({node: popupInnerContent, loader: null, size: 40});\n\t\t\t\t\tthis.showUsersInPopup(action);\n\n\t\t\t\t\tthis.isPopupShown = true;\n\n\t\t\t\t}.bind(this)\n\t\t\t},\n\t\t\tclassName: 'intranet-ustat-online-popup'\n\t\t});\n\n\t\t/*BX.bind(BX('intranet-ustat-online-popup'), 'mouseout' , BX.delegate(function() {\n\t\t\tclearTimeout(this.popupTimeout);\n\t\t\tthis.popupTimeout = setTimeout(BX.delegate(function() {\n\t\t\t\tthis.allOnlineUserPopup.close();\n\t\t\t}, this), 1000);\n\t\t}, this));\n\n\t\tBX.bind(BX('intranet-ustat-online-popup'), 'mouseover' , BX.delegate(function() {\n\t\t\tclearTimeout(this.popupTimeout);\n\t\t\tclearTimeout(this.mouseLeaveTimeoutId);\n\t\t}, this));\n\n\t\tBX.bind(this.userInnerBlockNode, 'mouseleave' , BX.delegate(function() {\n\t\t\tthis.mouseLeaveTimeoutId = setTimeout(BX.delegate(function() {\n\t\t\t\tthis.allOnlineUserPopup.close();\n\t\t\t}, this), 1000);\n\t\t}, this));*/\n\n\t\tthis.popupScroll(action);\n\n\t\tthis.allOnlineUserPopup.show();\n\t}\n\n\tpopupScroll(action)\n\t{\n\t\tif (!BX.type.isDomNode(this.popupInnerContainer))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tBX.bind(this.popupInnerContainer, 'scroll', BX.delegate(function() {\n\t\t\tvar _this = BX.proxy_context;\n\t\t\tif (_this.scrollTop > (_this.scrollHeight - _this.offsetHeight) / 1.5)\n\t\t\t{\n\t\t\t\tthis.showUsersInPopup(action);\n\t\t\t\tBX.unbindAll(_this);\n\t\t\t}\n\t\t}, this));\n\t};\n\n\tshowUsersInPopup(action)\n\t{\n\t\tif (\n\t\t\taction !== 'getAllOnlineUser'\n\t\t\t&& action !== 'getOpenedTimemanUser'\n\t\t\t&& action !== 'getClosedTimemanUser'\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tBX.ajax.runComponentAction(this.componentName, action, {\n\t\t\tsignedParameters: this.signedParameters,\n\t\t\tmode: 'class',\n\t\t\tdata: {\n\t\t\t\tpageNum: this.popupCurrentPage[action]\n\t\t\t}\n\t\t}).then(function (response) {\n\t\t\tif (response.data)\n\t\t\t{\n\t\t\t\tthis.renderPopupUsers(response.data);\n\t\t\t\tthis.popupCurrentPage[action]++;\n\t\t\t\tthis.popupScroll(action);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (!this.popupInnerContainer.hasChildNodes())\n\t\t\t\t{\n\t\t\t\t\tthis.popupInnerContainer.innerText = Loc.getMessage('INTRANET_USTAT_ONLINE_EMPTY');\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.hideLoader({loader: this.loader});\n\t\t}.bind(this), function (response) {\n\t\t\tthis.hideLoader({loader: this.loader});\n\t\t}.bind(this));\n\t}\n\n\trenderPopupUsers(users)\n\t{\n\t\tif (!this.allOnlineUserPopup || !BX.type.isDomNode(this.popupInnerContainer))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (!users || typeof users !== \"object\")\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tfor (var i in users)\n\t\t{\n\t\t\tif (!users.hasOwnProperty(i))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (this.renderedUsers.indexOf(users[i]['ID']) >= 0)\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tthis.renderedUsers.push(users[i]['ID']);\n\n\t\t\tlet avatarNode;\n\n\t\t\tif (BX.type.isNotEmptyString(users[i]['AVATAR']))\n\t\t\t{\n\t\t\t\tavatarNode = BX.create(\"div\", {\n\t\t\t\t\tprops: {className: \"ui-icon ui-icon-common-user intranet-ustat-online-popup-avatar-img\"},\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tBX.create('i', {\n\t\t\t\t\t\t\tstyle : { backgroundImage : \"url('\" + users[i]['AVATAR'] + \"')\"}\n\t\t\t\t\t\t})\n\t\t\t\t\t]\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tavatarNode = BX.create(\"div\", {\n\t\t\t\t\tprops: {className: \"ui-icon ui-icon-common-user intranet-ustat-online-popup-avatar-img\"},\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tBX.create('i', {})\n\t\t\t\t\t]\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis.popupInnerContainer.appendChild(\n\t\t\t\tBX.create(\"A\", {\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\thref: users[i]['PATH_TO_USER_PROFILE'],\n\t\t\t\t\t\ttarget: '_blank',\n\t\t\t\t\t},\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tclassName: \"intranet-ustat-online-popup-item\"\n\t\t\t\t\t},\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tBX.create(\"SPAN\", {\n\t\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\t\tclassName: \"intranet-ustat-online-popup-avatar-new\"\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tchildren: [\n\t\t\t\t\t\t\t\tavatarNode,\n\t\t\t\t\t\t\t\tBX.create(\"SPAN\", {\n\t\t\t\t\t\t\t\t\tprops: {className: \"intranet-ustat-online-popup-avatar-status-icon\"}\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tBX.create(\"SPAN\", {\n\t\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\t\tclassName: \"intranet-ustat-online-popup-name\"\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\thtml: users[i]['NAME']\n\t\t\t\t\t\t})\n\t\t\t\t\t]\n\t\t\t\t})\n\t\t\t);\n\t\t}\n\n\t}\n\n\tshowLoader(params)\n\t{\n\t\tvar loader = null;\n\n\t\tif (params.node)\n\t\t{\n\t\t\tif (params.loader === null)\n\t\t\t{\n\t\t\t\tloader = new BX.Loader({\n\t\t\t\t\ttarget: params.node,\n\t\t\t\t\tsize: params.hasOwnProperty(\"size\") ? params.size : 40\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tloader = params.loader;\n\t\t\t}\n\n\t\t\tloader.show();\n\t\t}\n\n\t\treturn loader;\n\t}\n\n\thideLoader(params)\n\t{\n\t\tif (params.loader !== null)\n\t\t{\n\t\t\tparams.loader.hide();\n\t\t}\n\n\t\tif (params.node)\n\t\t{\n\t\t\tBX.cleanNode(params.node);\n\t\t}\n\n\t\tif (params.loader !== null)\n\t\t{\n\t\t\tparams.loader = null;\n\t\t}\n\t}\n}","import {Popup} from './popup';\n\nimport {Type, Dom, Reflection, Event} from 'main.core';\nimport {rest} from \"rest.client\";\nimport {PULL, PullClient} from \"pull.client\";\n\nconst namespace = Reflection.namespace('BX.Intranet');\n\nclass UstatOnline\n{\n\tconstructor(params)\n\t{\n\t\tthis.signedParameters = params.signedParameters;\n\t\tthis.componentName = params.componentName;\n\t\tthis.userBlockNode = params.userBlockNode || \"\";\n\t\tthis.userInnerBlockNode = params.userInnerBlockNode || \"\";\n\t\tthis.circleNode = params.circleNode || \"\";\n\t\tthis.timemanNode = params.timemanNode || \"\";\n\t\tthis.ustatOnlineContainerNode = params.ustatOnlineContainerNode || \"\";\n\t\tthis.maxUserToShow = 7;\n\t\tthis.maxOnlineUserCountToday = params.maxOnlineUserCountToday;\n\t\tthis.currentUserId = parseInt(params.currentUserId);\n\t\tthis.isTimemanAvailable = params.isTimemanAvailable === \"Y\";\n\t\tthis.limitOnlineSeconds = params.limitOnlineSeconds;\n\t\tthis.renderingFinished = true;\n\n\t\tlet users = params.users;\n\t\tlet allOnlineUserIdToday = params.allOnlineUserIdToday;\n\n\t\tthis.users = users.map(user => {\n\t\t\tuser.id = parseInt(user.id);\n\t\t\tuser.offline_date = this.getOfflineDate(user.last_activity_date);\n\t\t\treturn user;\n\t\t});\n\n\t\tthis.allOnlineUserIdToday = allOnlineUserIdToday.map(id => {\n\t\t\treturn parseInt(id);\n\t\t});\n\n\t\tthis.online = [].concat(this.users);\n\n\t\tthis.counter = 0;\n\n\t\t//-------------- for IndexedDb\n\t\tthis.ITEMS = {\n\t\t\tobClientDb: null,\n\t\t\tobClientDbData: {},\n\t\t\tobClientDbDataSearchIndex: {},\n\t\t\tbMenuInitialized: false,\n\t\t\tinitialized: {\n\t\t\t\tsonetgroups: false,\n\t\t\t\tmenuitems: false\n\t\t\t},\n\t\t\toDbSearchResult: {}\n\t\t};\n\n\t\tBX.Finder(false, 'searchTitle', [], {}, this);\n\t\tBX.onCustomEvent(this, 'initFinderDb', [ this.ITEMS, 'searchTitle', null, ['users'], this ]);\n\t\t//---------------\n\n\t\tif (Type.isDomNode(this.ustatOnlineContainerNode))\n\t\t{\n\t\t\tBX.UI.Hint.init(this.ustatOnlineContainerNode);\n\t\t}\n\n\t\tnew Popup(this);\n\n\t\tlet now = new Date();\n\t\tthis.currentDate = new Date(now.getFullYear(), now.getMonth(), now.getDate()).valueOf();\n\n\t\tthis.checkOnline();\n\n\t\tif (this.isTimemanAvailable && Type.isDomNode(this.timemanNode))\n\t\t{\n\t\t\tthis.timemanValueNodes = this.timemanNode.querySelectorAll('.intranet-ustat-online-value');\n\t\t\tthis.timemanTextNodes =  this.timemanNode.querySelectorAll('.js-ustat-online-timeman-text');\n\n\t\t\tthis.resizeTimemanText();\n\t\t}\n\n\t\tsetTimeout(() => {\n\t\t\tthis.subscribePullEvent();\n\t\t}, 3000);\n\n\t\tsetInterval(() => this.checkOnline(), 60000);\n\t}\n\n\tgetOfflineDate(date)\n\t{\n\t\treturn date? new Date(date).getTime() + parseInt(this.limitOnlineSeconds)*1000: null;\n\t}\n\n\tcheckOnline()\n\t{\n\t\tthis.online = this.online.filter(user => {\n\t\t\treturn (user && (user.offline_date > +new Date() || user.id === this.currentUserId));\n\t\t});\n\n\t\tlet prevCounter = this.counter;\n\n\t\tif (this.online.length > 0)\n\t\t{\n\t\t\tthis.counter = this.online.map(el => 1).reduce(count => count + 1);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.counter = 0;\n\t\t}\n\n\t\tif (this.checkNewDay() || prevCounter !== this.counter)\n\t\t{\n\t\t\tthis.redrawOnline();\n\t\t}\n\t}\n\n\tcheckNewDay()\n\t{\n\t\tlet now = new Date();\n\t\tlet today = new Date(now.getFullYear(), now.getMonth(), now.getDate()).valueOf();\n\n\t\tif (this.currentDate < today) //new day\n\t\t{\n\t\t\tthis.maxOnlineUserCountToday = this.online.length;\n\n\t\t\tif (this.isTimemanAvailable)\n\t\t\t{\n\t\t\t\tthis.checkTimeman();\n\t\t\t}\n\n\t\t\tthis.currentDate = today;\n\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tcheckTimeman()\n\t{\n\t\tBX.ajax.runComponentAction(this.componentName, \"checkTimeman\", {\n\t\t\tsignedParameters: this.signedParameters,\n\t\t\tmode: 'class'\n\t\t}).then(function (response) {\n\t\t\tif (response.data)\n\t\t\t{\n\t\t\t\tthis.redrawTimeman(response.data);\n\t\t\t}\n\t\t}.bind(this), function (response) {\n\n\t\t}.bind(this));\n\t}\n\n\tsetUserOnline(params)\n\t{\n\t\tlet userId = this.getNumberUserId(params.id);\n\n\t\tthis.findUser(userId).then(user => {\n\t\t\tuser.id = this.getNumberUserId(user.id);\n\n\t\t\tif (typeof params.last_activity_date !== \"undefined\")\n\t\t\t{\n\t\t\t\tuser.last_activity_date = params.last_activity_date;\n\t\t\t}\n\n\t\t\tif (user.isExtranet !== \"Y\")\n\t\t\t{\n\t\t\t\tthis.setUserToLocal(user);\n\t\t\t\tthis.checkOnline();\n\t\t\t}\n\t\t}).catch(error => {});\n\t}\n\n\tsetUserToLocal(user)\n\t{\n\t\tuser.offline_date = this.getOfflineDate(user.last_activity_date);\n\n\t\tthis.users = this.users.filter(element => element.id !== user.id);\n\t\tthis.users.push(user);\n\n\t\tlet isUserOnline = false;\n\t\tthis.online.forEach((element) => {\n\t\t\tif (element.id === user.id)\n\t\t\t{\n\t\t\t\tisUserOnline = true;\n\t\t\t}\n\t\t});\n\t\tif (!isUserOnline)\n\t\t{\n\t\t\tthis.online.unshift(user);\n\t\t}\n\n\t\tif (this.allOnlineUserIdToday.indexOf(user.id) === -1)\n\t\t{\n\t\t\tthis.allOnlineUserIdToday.push(user.id);\n\t\t\tthis.maxOnlineUserCountToday++;\n\t\t}\n\t}\n\n\tsetUserOnlineMultiply(list)\n\t{\n\t\tlet requestUserList = [];\n\t\tlet counterFindUser = 0;\n\t\tlet promises = [];\n\n\t\tlist.forEach(user => {\n\n\t\t\tlet userId = parseInt(user.id);\n\t\t\tpromises.push(new Promise((resolve, reject) => {\n\t\t\t\tthis.findUser(userId, true).then(user => {\n\t\t\t\t\tcounterFindUser++;\n\t\t\t\t\tthis.setUserToLocal(user);\n\t\t\t\t\tresolve();\n\t\t\t\t}).catch(error => {\n\t\t\t\t\trequestUserList.push(userId);\n\t\t\t\t\tresolve();\n\t\t\t\t});\n\t\t\t}));\n\t\t});\n\n\t\tPromise.all(promises).then(() => {\n\t\t\tif (requestUserList.length <= 0)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tlet requestCount = this.maxUserToShow-counterFindUser;\n\t\t\tif (requestCount <= 0)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\trequestUserList = requestUserList.slice(0, requestCount);\n\n\t\t\tBX.rest.callMethod('im.user.list.get', {ID: requestUserList}).then(result => {\n\t\t\t\tlet collection = result.data();\n\t\t\t\tif (!collection)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tfor (let userId in collection)\n\t\t\t\t{\n\t\t\t\t\tif (!collection.hasOwnProperty(userId))\n\t\t\t\t\t{\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\tlet userData = collection[userId];\n\t\t\t\t\tif (!userData)\n\t\t\t\t\t{\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\tlet user = {};\n\t\t\t\t\tuser.id = parseInt(userData.id);\n\t\t\t\t\tuser.name = userData.name;\n\t\t\t\t\tuser.avatar = BX.MessengerCommon.isBlankAvatar(userData.avatar)? '': userData.avatar;\n\t\t\t\t\tuser.last_activity_date = userData.last_activity_date;\n\n\t\t\t\t\tthis.setUserToLocal(user);\n\t\t\t\t}\n\t\t\t}).catch(error => {});\n\t\t});\n\t}\n\n\tfindUser(userId, skipRest = false)\n\t{\n\t\tuserId = parseInt(userId);\n\n\t\treturn new Promise((resolve, reject) => {\n\n\t\t\tlet user = null;\n\n\t\t\tuser = this.users.find(element => element.id === userId);\n\t\t\tif (user)\n\t\t\t{\n\t\t\t\tresolve(user);\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tuser = this.getUserFromMessenger(userId);\n\t\t\tif (user)\n\t\t\t{\n\t\t\t\tresolve(user);\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tthis.getUserFromDb(userId).then(user => {\n\t\t\t\tresolve(user);\n\t\t\t\treturn true;\n\t\t\t}).catch(error => {\n\n\t\t\t\tif (skipRest)\n\t\t\t\t{\n\t\t\t\t\treject(null);\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\tthis.getUserFromServer(userId).then(user => {\n\t\t\t\t\tthis.addUserToDb(user);\n\t\t\t\t\tresolve(user);\n\t\t\t\t}).catch(error => {\n\t\t\t\t\treject(null);\n\t\t\t\t});\n\t\t\t});\n\n\t\t\treturn true;\n\t\t});\n\t}\n\n\tgetUserFromMessenger(userId)\n\t{\n\t\tif (typeof window.BX.MessengerCommon === 'undefined')\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tlet result = BX.MessengerCommon.getUser(userId);\n\t\tif (!result)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tlet user = {\n\t\t\tid: parseInt(result.id),\n\t\t\tname: result.name,\n\t\t\tavatar: BX.MessengerCommon.isBlankAvatar(result.avatar)? '': result.avatar,\n\t\t\tlast_activity_date: null,\n\t\t};\n\n\t\tif (result.last_activity_date instanceof Date)\n\t\t{\n\t\t\tuser.last_activity_date = result.last_activity_date.toISOString()\n\t\t}\n\t\tif (typeof result.last_activity_date === 'string')\n\t\t{\n\t\t\tuser.last_activity_date = result.last_activity_date\n\t\t}\n\n\t\treturn user;\n\t}\n\n\tgetUserFromDb(userId)\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tBX.indexedDB.getValue(this.ITEMS.obClientDb, \"users\", \"U\" + userId).then((user) => {\n\t\t\t\tif (user && typeof user === 'object')\n\t\t\t\t{\n\t\t\t\t\tif (user.hasOwnProperty(\"entityId\"))\n\t\t\t\t\t{\n\t\t\t\t\t\tuser.id = this.getNumberUserId(user.entityId);\n\t\t\t\t\t}\n\t\t\t\t\tresolve(user);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tresolve(null);\n\t\t\t\t}\n\t\t\t}).catch(error => {\n\t\t\t\treject(null);\n\t\t\t});\n\t\t});\n\t}\n\n\taddUserToDb(user)\n\t{\n\t\tuser.id = \"U\" + user.id;\n\t\tBX.indexedDB.addValue(this.ITEMS.obClientDb, 'users', user);\n\t}\n\n\tgetUserFromServer(userId)\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\n\t\t\tif (typeof window.BX.MessengerCommon === 'undefined')\n\t\t\t{\n\t\t\t\tresolve(null);\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\trest.callMethod('im.user.get', {id: userId}).then(result => {\n\t\t\t\tif (result.data() && result.data().external_auth_id !== \"__controller\")\n\t\t\t\t{\n\t\t\t\t\tlet user = {};\n\t\t\t\t\tuser.id = parseInt(result.data().id);\n\t\t\t\t\tuser.name = result.data().name;\n\t\t\t\t\tuser.avatar = BX.MessengerCommon.isBlankAvatar(result.data().avatar)? '': result.data().avatar;\n\t\t\t\t\tuser.last_activity_date = result.data().last_activity_date;\n\t\t\t\t\tuser.isExtranet = result.data().extranet ? \"Y\" : \"N\";\n\t\t\t\t\tuser.active = \"Y\";\n\t\t\t\t\tuser.entityId = parseInt(result.data().id);\n\n\t\t\t\t\tresolve(user);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tresolve(null);\n\t\t\t\t}\n\t\t\t}).catch(error => {\n\t\t\t\tresolve(null);\n\t\t\t});\n\t\t});\n\t}\n\n\tsubscribePullEvent()\n\t{\n\t\tPULL.subscribe({\n\t\t\ttype: PullClient.SubscriptionType.Online,\n\t\t\tcallback: (data) =>\n\t\t\t{\n\t\t\t\tif (data.command === 'userStatus')\n\t\t\t\t{\n\t\t\t\t\tfor (let userId in data.params.users)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (!data.params.users.hasOwnProperty(userId))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis.setUserOnline(data.params.users[userId]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t/*else if (data.command === 'list')\n\t\t\t\t{\n\t\t\t\t\tlet list = [];\n\n\t\t\t\t\tfor (let userId in data.params.users)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (data.params.users.hasOwnProperty(userId))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlist.push({\n\t\t\t\t\t\t\t\tid: data.params.users[userId].id,\n\t\t\t\t\t\t\t\tlast_activity_date: data.params.users[userId].last_activity_date\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.setUserOnlineMultiply(list);\n\t\t\t\t}*/\n\t\t\t}\n\t\t});\n\n\t\tPULL.subscribe({\n\t\t\tmoduleId: 'intranet',\n\t\t\tcommand: 'timemanDayInfo',\n\t\t\tcallback: (data) =>\n\t\t\t{\n\t\t\t\tthis.redrawTimeman(data);\n\t\t\t}\n\t\t});\n\t}\n\n\tredrawTimeman(data)\n\t{\n\t\tif (data.hasOwnProperty(\"OPENED\"))\n\t\t{\n\t\t\tlet openedNode = document.querySelector('.js-ustat-online-timeman-opened');\n\t\t\tif (BX.type.isDomNode(openedNode))\n\t\t\t{\n\t\t\t\topenedNode.innerHTML = data[\"OPENED\"];\n\t\t\t}\n\t\t}\n\n\t\tif (data.hasOwnProperty(\"CLOSED\"))\n\t\t{\n\t\t\tlet closedNode = document.querySelector('.js-ustat-online-timeman-closed');\n\t\t\tif (BX.type.isDomNode(closedNode))\n\t\t\t{\n\t\t\t\tclosedNode.innerHTML = data[\"CLOSED\"];\n\t\t\t}\n\t\t}\n\n\t\tthis.resizeTimemanText();\n\t}\n\n\tresizeTimemanText()\n\t{\n\t\tif (!Type.isDomNode(this.timemanNode))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet textSum = 0;\n\t\tlet valueSum = 0;\n\n\t\tif (Type.isArrayLike(this.timemanTextNodes))\n\t\t{\n\t\t\tfor (let text of this.timemanTextNodes)\n\t\t\t{\n\t\t\t\tlet textItems = text.textContent.length;\n\t\t\t\ttextSum += textItems;\n\t\t\t}\n\t\t}\n\n\t\tif (Type.isArrayLike(this.timemanValueNodes))\n\t\t{\n\t\t\tfor (let value of this.timemanValueNodes)\n\t\t\t{\n\t\t\t\tlet valueItems = value.textContent.length;\n\t\t\t\tvalueSum += valueItems;\n\t\t\t}\n\t\t}\n\n\t\tif (textSum >= 17 && valueSum >= 6 || textSum >= 19 && valueSum >= 4)\n\t\t{\n\t\t\tDom.addClass(this.timemanNode, 'intranet-ustat-online-info-text-resize');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.removeClass(this.timemanNode, 'intranet-ustat-online-info-text-resize');\n\t\t}\n\t}\n\n\tgetNumberUserId(id)\n\t{\n\t\tif (!id)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet userId = String(id);\n\t\tuserId = userId.replace('U', '');\n\t\treturn parseInt(userId);\n\t}\n\n\tredrawOnline()\n\t{\n\t\tthis.showCircleAnimation(this.circleNode, this.counter, this.maxOnlineUserCountToday);\n\t\tif (this.renderingFinished)\n\t\t{\n\t\t\tthis.renderingFinished = false;\n\t\t\tthis.renderAllUser();\n\t\t}\n\t}\n\n\trenderAllUser()\n\t{\n\t\tlet renderedUserIds = [];\n\t\tlet newUserIds = [];\n\n\t\tthis.online.forEach((item) => {\n\t\t\tnewUserIds.push(parseInt(item.id));\n\t\t});\n\n\t\tconst onlineToShow = newUserIds.slice(0, this.maxUserToShow);\n\n\t\tlet renderedUserNodes = this.userBlockNode.querySelectorAll(\".js-ustat-online-user\");\n\n\t\tif (renderedUserNodes)\n\t\t{\n\t\t\tfor (let item in renderedUserNodes)\n\t\t\t{\n\t\t\t\tif (!renderedUserNodes.hasOwnProperty(item))\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tlet renderedItemId = parseInt(renderedUserNodes[item].getAttribute(\"data-user-id\"));\n\n\t\t\t\tif (newUserIds.indexOf(renderedItemId) === -1)\n\t\t\t\t{\n\t\t\t\t\tif (Type.isDomNode(renderedUserNodes[item]))\n\t\t\t\t\t{\n\t\t\t\t\t\tDom.remove(renderedUserNodes[item]); //remove offline avatars\n\t\t\t\t\t\t/*renderedUserNodes[item].classList.add('intranet-ustat-online-icon-hide');\n\t\t\t\t\t\tsetTimeout( () => {\n\n\t\t\t\t\t\t}, 800);*/\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\trenderedUserIds.push(parseInt(renderedItemId));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\trenderedUserNodes = this.userBlockNode.querySelectorAll(\".js-ustat-online-user\");\n\n\t\tlet renderedUserCount = renderedUserNodes.length;\n\t\tconst showAnimation = renderedUserCount !== 0;\n\t\tthis.userIndex = this.online.length;\n\n\t\tlet stepRender = (i) => {\n\t\t\tif (i >= this.maxUserToShow || i >= this.online.length)\n\t\t\t{\n\t\t\t\tthis.renderingFinished = true;\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tnew Promise((resolve) => {\n\t\t\t\tlet item = this.online[i];\n\n\t\t\t\tif (renderedUserIds.indexOf(item.id) >= 0)\n\t\t\t\t{\n\t\t\t\t\tresolve();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (renderedUserCount < this.maxUserToShow)\n\t\t\t\t{\n\t\t\t\t\tif (showAnimation)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.userIndex++;\n\t\t\t\t\t}\n\t\t\t\t\tthis.renderUser(item, showAnimation);\n\t\t\t\t\trenderedUserIds.push(item.id);\n\t\t\t\t\trenderedUserCount++;\n\t\t\t\t\tif (!showAnimation)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.userIndex = this.userIndex - 1;\n\t\t\t\t\t}\n\n\t\t\t\t\tresolve();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tconst elements = this.userBlockNode.querySelectorAll(\".js-ustat-online-user\");\n\t\t\t\t\tconst firstElement = elements[0];\n\t\t\t\t\tlet lastElement = \"\";\n\n\t\t\t\t\tfor (let i = elements.length - 1; i >= 0; i--)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (Type.isDomNode(elements[i]))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst elementUserId = parseInt(elements[i].getAttribute(\"data-user-id\"));\n\t\t\t\t\t\t\tif (onlineToShow.indexOf(elementUserId) === -1)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tlastElement = elements[i];\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (Type.isDomNode(lastElement))\n\t\t\t\t\t{\n\t\t\t\t\t\tconst removedUserId = parseInt(lastElement.getAttribute(\"data-user-id\"));\n\n\t\t\t\t\t\tDom.removeClass(lastElement, 'intranet-ustat-online-icon-show');\n\t\t\t\t\t\tDom.addClass(lastElement, 'intranet-ustat-online-icon-hide');\n\n\t\t\t\t\t\tthis.userIndex = parseInt(firstElement.style.zIndex);\n\t\t\t\t\t\tthis.userIndex++;\n\n\t\t\t\t\t\tthis.renderUser(item, showAnimation);\n\t\t\t\t\t\trenderedUserIds = renderedUserIds.filter(id => id !== removedUserId);\n\t\t\t\t\t\trenderedUserIds.push(item.id);\n\n\t\t\t\t\t\tEvent.bind(lastElement, 'animationend', (event) => {\n\t\t\t\t\t\t\tDom.remove(lastElement);\n\t\t\t\t\t\t\tresolve();\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tresolve();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}).then(() => {\n\t\t\t\tstepRender(++i);\n\t\t\t});\n\t\t};\n\n\t\tstepRender(0);\n\t}\n\n\trenderUser(user, showAnimation)\n\t{\n\t\tif (!user || typeof user !== 'object')\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet userStyle = \"\";\n\t\tif (user.avatar)\n\t\t{\n\t\t\tuserStyle = 'background-image: url(\"' + user.avatar + '\");';\n\t\t}\n\n\t\tconst userId = this.getNumberUserId(user.id);\n\n\t\tlet itemsClasses = `ui-icon ui-icon-common-user intranet-ustat-online-icon js-ustat-online-user\n\t\t\t${showAnimation ? ' intranet-ustat-online-icon-show' : ''}`;\n\n\t\tthis.userItem = BX.create('span', {\n\t\t\tattrs: {\n\t\t\t\tclassName: itemsClasses,\n\t\t\t\t\"data-user-id\" : userId\n\t\t\t},\n\t\t\tstyle: {\n\t\t\t\tzIndex: this.userIndex\n\t\t\t},\n\t\t\tchildren: [\n\t\t\t\tBX.create('i', {\n\t\t\t\t\tattrs: { style: userStyle}\n\t\t\t\t})\n\t\t\t]\n\t\t});\n\n\t\tif (showAnimation)\n\t\t{\n\t\t\tDom.prepend(this.userItem, this.userInnerBlockNode);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.userInnerBlockNode.appendChild(this.userItem);\n\t\t}\n\t}\n\n\tshowCircleAnimation(circleNode, currentUserOnlineCount, maxUserOnlineCount)\n\t{\n\t\tmaxUserOnlineCount = parseInt(maxUserOnlineCount);\n\t\tcurrentUserOnlineCount = parseInt(currentUserOnlineCount);\n\n\t\tif (currentUserOnlineCount <= 0)\n\t\t{\n\t\t\tcurrentUserOnlineCount = 1;\n\t\t}\n\n\t\tif (currentUserOnlineCount > maxUserOnlineCount)\n\t\t{\n\t\t\tmaxUserOnlineCount = currentUserOnlineCount;\n\t\t}\n\n\t\tlet progressPercent = (currentUserOnlineCount*100)/maxUserOnlineCount;\n\n\t\tif (!this.circle)\n\t\t{\n\t\t\tthis.circle = new BX.UI.Graph.Circle(circleNode, 68, progressPercent, currentUserOnlineCount);\n\t\t\tthis.circle.show();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.circle.updateCounter(progressPercent, currentUserOnlineCount);\n\t\t}\n\t}\n}\n\nnamespace.UstatOnline = UstatOnline;\n"],"names":["Popup","parent","signedParameters","componentName","userInnerBlockNode","circleNode","isPopupShown","popupCurrentPage","renderedUsers","Event","bind","showPopup","isTimemanAvailable","Type","isDomNode","timemanNode","openedNode","querySelector","closedNode","action","title","Loc","getMessage","bindNode","topOffset","isUndefined","popupInnerContainer","allOnlineUserPopup","BX","PopupWindow","lightShadow","offsetLeft","offsetTop","autoHide","closeByEsc","bindOptions","position","animationOptions","show","type","close","events","onPopupDestroy","onPopupClose","destroy","onAfterPopupShow","popup","popupContent","contentContainer","popupContainer","create","props","className","popupTitle","text","getPopupTitle","popupInnerContent","popupInnerContentBox","appendChild","loader","showLoader","node","size","showUsersInPopup","popupScroll","delegate","_this","proxy_context","scrollTop","scrollHeight","offsetHeight","unbindAll","ajax","runComponentAction","mode","data","pageNum","then","response","renderPopupUsers","hasChildNodes","innerText","hideLoader","users","i","hasOwnProperty","indexOf","push","avatarNode","isNotEmptyString","children","style","backgroundImage","attrs","href","target","html","params","Loader","hide","cleanNode","namespace","Reflection","UstatOnline","userBlockNode","ustatOnlineContainerNode","maxUserToShow","maxOnlineUserCountToday","currentUserId","parseInt","limitOnlineSeconds","renderingFinished","allOnlineUserIdToday","map","user","id","offline_date","getOfflineDate","last_activity_date","online","concat","counter","ITEMS","obClientDb","obClientDbData","obClientDbDataSearchIndex","bMenuInitialized","initialized","sonetgroups","menuitems","oDbSearchResult","Finder","onCustomEvent","UI","Hint","init","now","Date","currentDate","getFullYear","getMonth","getDate","valueOf","checkOnline","timemanValueNodes","querySelectorAll","timemanTextNodes","resizeTimemanText","setTimeout","subscribePullEvent","setInterval","date","getTime","filter","prevCounter","length","el","reduce","count","checkNewDay","redrawOnline","today","checkTimeman","redrawTimeman","userId","getNumberUserId","findUser","isExtranet","setUserToLocal","catch","error","element","isUserOnline","forEach","unshift","list","requestUserList","counterFindUser","promises","Promise","resolve","reject","all","requestCount","slice","rest","callMethod","ID","result","collection","userData","name","avatar","MessengerCommon","isBlankAvatar","skipRest","find","getUserFromMessenger","getUserFromDb","getUserFromServer","addUserToDb","window","getUser","toISOString","indexedDB","getValue","entityId","addValue","external_auth_id","extranet","active","PULL","subscribe","PullClient","SubscriptionType","Online","callback","command","setUserOnline","moduleId","document","innerHTML","textSum","valueSum","isArrayLike","textItems","textContent","value","valueItems","Dom","addClass","removeClass","String","replace","showCircleAnimation","renderAllUser","renderedUserIds","newUserIds","item","onlineToShow","renderedUserNodes","renderedItemId","getAttribute","remove","renderedUserCount","showAnimation","userIndex","stepRender","renderUser","elements","firstElement","lastElement","elementUserId","removedUserId","zIndex","event","userStyle","itemsClasses","userItem","prepend","currentUserOnlineCount","maxUserOnlineCount","progressPercent","circle","Graph","Circle","updateCounter"],"mappings":"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"}