this.BX=this.BX||{};this.BX.Mobile=this.BX.Mobile||{};this.BX.Mobile.Field=this.BX.Mobile.Field||{};(function(e){"use strict";var t=window.BX,i=window.BXMobileApp;var s=function(){var e=function e(i,s,l){this.click=t.delegate(this.click,this);this.callback=t.delegate(this.callback,this);this.drop=t.delegate(this.drop,this);this.select=t(i);this.container=this.select.nextElementSibling;this.eventNode=t(s);this.useOnChangeEvent=l||false;t.bind(this.eventNode,"click",this.click);this.multiple=i.hasAttribute("multiple");this.showDrop=!(i.hasAttribute("bx-can-drop")&&i.getAttribute("bx-can-drop").toString()=="false");this.urls={list:t.message("SITE_DIR")+"mobile/index.php?mobile_action=get_user_list",profile:t.message("interface_form_user_url")};this.actualizeNodes()};e.prototype={click:function e(i){this.show();return t.PreventDefault(i)},show:function e(){new i.UI.Table({url:this.urls.list,table_settings:{callback:this.callback,markmode:true,multiple:this.multiple,return_full_mode:true,skipSpecialChars:true,modal:true,alphabet_index:true,outsection:false,okname:t.message("interface_form_select"),cancelname:t.message("interface_form_cancel")}},"users").show()},drop:function e(){var i=t.proxy_context,s=i.id.replace(this.select.id+"_del_","");for(var l=0;l<this.select.options.length;l++){if(this.select.options[l].value===s){t.remove(t.findParent(i,{tagName:"DIV",className:"mobile-grid-field-select-user-item-outer"}));t.remove(this.select.options[l])}}if(this.select.options.length<=0&&!this.multiple){this.eventNode.innerHTML=t.message("interface_form_select")}if(this.useOnChangeEvent){t.onCustomEvent(this,"onChange",[this,this.select])}},actualizeNodes:function e(){for(var i=0;i<this.select.options.length;i++){if(t(this.select.id+"_del_"+this.select.options[i].value)){t.bind(t(this.select.id+"_del_"+this.select.options[i].value),"click",this.drop)}}},buildNodes:function e(i){var s="",l="",n,o=[];for(var a=0;a<this.select.options.length;a++){o.push(this.select.options[a].value.toString())}for(var r=0;r<Math.min(this.multiple?i.length:1,i.length);r++){n=i[r];if(o.includes(n["ID"])){continue}s+='<option value="'+n["ID"]+'" selected>'+n["NAME"]+"</option>";l+=['<div class="mobile-grid-field-select-user-item-outer">','<div class="mobile-grid-field-select-user-item">',this.showDrop?'<del id="'+this.select.id+"_del_"+n["ID"]+'"></del>':"",'<div class="avatar"',n["IMAGE"]?" style=\"background-image:url('"+n["IMAGE"]+"')\"":"","></div>","<span onclick=\"BXMobileApp.Events.postToComponent('onUserProfileOpen', "+[n["ID"]]+", 'communication');\">"+n["NAME"]+"</span>","</div>","</div>"].join("").replace(" style=\"background-image:url('')\"","")}if(l!==""){this.select.innerHTML=(this.multiple?this.select.innerHTML:"")+s;this.container.innerHTML=(this.multiple?this.container.innerHTML:"")+l;if(this.select.innerHTML!==""&&!this.multiple){this.eventNode.innerHTML=t.message("interface_form_change")}if(this.useOnChangeEvent){t.onCustomEvent(this,"onChange",[this,this.select])}var c=0,h=t.proxy(function(){if(c<100){if(this.container.childNodes.length>0){this.actualizeNodes()}else if(c++){setTimeout(h,50)}}},this);setTimeout(h,50)}},callback:function e(t){if(t&&t.a_users){this.buildNodes(t.a_users)}}};return e}();window.app.exec("enableCaptureKeyboard",true);t.Mobile.Field.SelectUser=function(e){this.useOnChangeEvent=e["useOnChangeEvent"]||false;this.init(e)};t.Mobile.Field.SelectUser.prototype={__proto__:t.Mobile.Field.prototype,bindElement:function e(i){var l=null;if(t(i)){l=new s(i,t("".concat(i.id,"_select")),this.useOnChangeEvent)}return l}}})(this.BX.Mobile.Field.SelectUser=this.BX.Mobile.Field.SelectUser||{});
//# sourceMappingURL=mobile.map.js