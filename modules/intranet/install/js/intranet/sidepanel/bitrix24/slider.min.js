(function(){"use strict";BX.namespace("BX.Intranet.Bitrix24");BX.Intranet.Bitrix24.Slider=function(e,t){BX.SidePanel.Slider.apply(this,arguments);this.handleWindowResize=this.handleWindowResize.bind(this);this.handleMessengerOpen=this.handleMessengerOpen.bind(this);this.handleHelperShow=this.handleHelperShow.bind(this);this.handlePanelClick=this.handlePanelClick.bind(this);this.handleMessengerClose=this.handleMessengerClose.bind(this)};BX.Intranet.Bitrix24.Slider.prototype={__proto__:BX.SidePanel.Slider.prototype,constructor:BX.Intranet.Bitrix24.Slider,applyHacks:function(){if(BX.MessengerWindow){BX.MessengerWindow.closePopup()}else if(window.BXIM){window.BXIM.closeMessenger()}this.adjustBackgroundSize();var e=window.innerWidth-document.documentElement.clientWidth;var t=window.innerHeight-document.documentElement.clientHeight;if(this.getImBar()){var i=BX.pos(this.getImBar());this.getImBar().style.position="absolute";this.getImBar().originalTop=this.getImBar().style.top;this.getImBar().style.top=i.top+"px";this.getImBar().style.height=i.height+t+"px";this.getImBar().style.right=-window.pageXOffset+"px";this.getImBar().dataset.lockRedraw=true;BX.addClass(this.getImBar(),"bx-im-bar-default");BX.addClass(this.getHelpBlock(),"help-block-default");this.getImBar().style.borderRight=e+"px solid #eef2f4";var n=Math.max(document.body.scrollWidth,document.documentElement.scrollWidth,document.body.offsetWidth,document.documentElement.offsetWidth,document.body.clientWidth,document.documentElement.clientWidth);this.getHelpBlock().style.borderRight=e+"px solid #eef2f4";var r=window.innerWidth-document.documentElement.clientWidth;if(e===0&&r!==0){e=r}this.getHelpBlock().style.right=-e+(n-document.documentElement.clientWidth-window.pageXOffset)+"px"}if(this.getPanel()){this.getPanel().style.cssText+="margin-right: -"+e+"px !important";BX("bx-panel-userinfo").style.cssText+="padding-right:"+e+"px !important";BX("bx-panel-site-toolbar").style.cssText+="padding-right:"+e+"px !important";this.getPanel().addEventListener("click",this.handlePanelClick,true)}this.getHeader().style.paddingRight=e+"px";this.getHeader().style.marginRight="-"+e+"px";BX.addCustomEvent("OnMessengerWindowShowPopup",this.handleMessengerOpen);BX.addCustomEvent("BX.Helper:onShow",this.handleHelperShow);BX.bind(window,"resize",this.handleWindowResize);return true},resetHacks:function(){this.getHeader().style.cssText="";this.resetBackgroundSize();if(this.getImBar()){this.getImBar().style.removeProperty("z-index");this.getImBar().style.removeProperty("width");this.getImBar().style.removeProperty("right");this.getImBar().style.removeProperty("height");this.getImBar().style.removeProperty("position");this.getImBar().style.top=this.getImBar().originalTop;this.getImBar().dataset.lockRedraw=false;BX.removeClass(this.getImBar(),"bx-im-bar-default");BX.removeClass(this.getHelpBlock(),"help-block-default");this.getImBar().style.removeProperty("border-right");this.getHelpBlock().style.removeProperty("border-right");this.getHelpBlock().style.removeProperty("right")}if(this.getPanel()){this.getPanel().style.removeProperty("z-index");this.getPanel().style.removeProperty("margin-right");BX("bx-panel-userinfo").style.removeProperty("padding-right");BX("bx-panel-site-toolbar").style.removeProperty("padding-right");this.getPanel().removeEventListener("click",this.handlePanelClick,true)}BX.removeCustomEvent("OnMessengerWindowShowPopup",this.handleMessengerOpen);BX.removeCustomEvent("BX.Helper:onShow",this.handleHelperShow);BX.unbind(window,"resize",this.handleWindowResize)},adjustBackgroundSize:function(){var e=BX.getClass("BX.Intranet.Bitrix24.ThemePicker.Singleton");if(!e){return}var t=e.getAppliedTheme();if(t&&t.resizable===true){if(t.video){this.adjustVideoSize()}else if(t.width>0&&t.height>0){this.adjustImageSize(t.width,t.height)}}},adjustImageSize:function(e,t){var i=document.documentElement.clientWidth;var n=document.documentElement.clientHeight;var r=t/e;var s=n/i;var o=s>r?n/r:i;var l=s>r?n:i*r;document.body.style.backgroundSize=o+"px "+l+"px"},adjustVideoSize:function(){var e=BX.getClass("BX.Intranet.Bitrix24.ThemePicker.Singleton");if(!e){return}var t=e.getVideoContainer();if(t){t.style.right=window.innerWidth-document.documentElement.clientWidth+"px"}},resetBackgroundSize:function(){document.body.style.removeProperty("background-size");var e=BX.getClass("BX.Intranet.Bitrix24.ThemePicker.Singleton");if(e){var t=e.getVideoContainer();if(t){t.style.removeProperty("right")}}},getTopBoundary:function(){var e=BX.getClass("BX.UI.Viewer.Instance");if(e&&e.isOpen()){return 0}else{return this.getPanel()?BX.pos(this.getPanel()).bottom:0}},getLeftBoundary:function(){var e=BX.browser.IsMobile()?window.innerWidth:document.documentElement.clientWidth;return e<1160?0:240},getRightBoundary:function(){var e=BX.getClass("BX.UI.Viewer.Instance");if(e&&e.isOpen()){return 0}else{var t=BX.browser.IsMobile()?window.innerWidth:document.documentElement.clientWidth;return this.getImBar()?t-BX.pos(this.getImBar()).left:0}},handleWindowResize:function(){this.adjustBackgroundSize();if(this.getImBar()){var e=this.getImBar().getBoundingClientRect();this.getImBar().style.height=document.documentElement.clientHeight-e.top+"px"}},handleHelperShow:function(){BX.SidePanel.Instance.closeAll(true)},handleMessengerOpen:function(){if(this.isOpen()){BX.SidePanel.Instance.hide();BX.addCustomEvent("OnMessengerWindowClosePopup",this.handleMessengerClose)}},handleMessengerClose:function(){BX.SidePanel.Instance.unhide();if(BX.SidePanel.Instance.getTopSlider()){BX.SidePanel.Instance.getTopSlider().focus()}BX.removeCustomEvent("OnMessengerWindowClosePopup",this.handleMessengerClose)},handlePanelClick:function(){BX.SidePanel.Instance.closeAll()},getPanel:function(){return BX("bx-panel",true)},getHeader:function(){return BX("header",true)},getImBar:function(){return BX("bx-im-bar",true)},getHelpBlock:function(){return BX("bx-help-block",true)}};BX.SidePanel.Manager.registerSliderClass("BX.Intranet.Bitrix24.Slider");BX.namespace("BX.Bitrix24");Object.defineProperty(BX.Bitrix24,"Slider",{get:function(){return BX.SidePanel.Instance}});Object.defineProperty(BX.Bitrix24,"PageSlider",{get:function(){return BX.SidePanel.Instance}})})();