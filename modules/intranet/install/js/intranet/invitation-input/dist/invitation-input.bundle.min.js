this.BX=this.BX||{},function(e,s,t,a,i){"use strict";var r=babelHelpers.classPrivateFieldLooseKey("groupId"),l=babelHelpers.classPrivateFieldLooseKey("users");class o extends class{invite(){throw new Error('Implement the method "invite" in the child class')}}{constructor(e,s){super(),Object.defineProperty(this,r,{writable:!0,value:void 0}),Object.defineProperty(this,l,{writable:!0,value:void 0}),babelHelpers.classPrivateFieldLooseBase(this,r)[r]=e,babelHelpers.classPrivateFieldLooseBase(this,l)[l]=s}invite(){return i.ajax.runAction("intranet.invite.inviteUsersToCollab",{data:{collabId:babelHelpers.classPrivateFieldLooseBase(this,r)[r],users:babelHelpers.classPrivateFieldLooseBase(this,l)[l]}})}}let n,b,c=e=>e;var d=babelHelpers.classPrivateFieldLooseKey("cache"),p=babelHelpers.classPrivateFieldLooseKey("invalidPhoneNumbersTagIds"),h=babelHelpers.classPrivateFieldLooseKey("isReadySendInvitation"),v=babelHelpers.classPrivateFieldLooseKey("invite"),P=babelHelpers.classPrivateFieldLooseKey("getPreparedUserList"),g=babelHelpers.classPrivateFieldLooseKey("getErrorTags"),u=babelHelpers.classPrivateFieldLooseKey("setReadySaveState"),L=babelHelpers.classPrivateFieldLooseKey("setUnreadySaveState"),T=babelHelpers.classPrivateFieldLooseKey("isInvitationByPhoneAvailable"),y=babelHelpers.classPrivateFieldLooseKey("getPhoneParser"),B=babelHelpers.classPrivateFieldLooseKey("getDefaultPlaceholder"),H=babelHelpers.classPrivateFieldLooseKey("getDefaultValidationMessage"),F=babelHelpers.classPrivateFieldLooseKey("getEmptyValidationMessage"),f=babelHelpers.classPrivateFieldLooseKey("onAfterTagRemove"),I=babelHelpers.classPrivateFieldLooseKey("onBeforeTagAdd"),E=babelHelpers.classPrivateFieldLooseKey("setErrorStateForTag"),O=babelHelpers.classPrivateFieldLooseKey("onEnter"),N=babelHelpers.classPrivateFieldLooseKey("onBlur"),m=babelHelpers.classPrivateFieldLooseKey("onInput"),_=babelHelpers.classPrivateFieldLooseKey("getEntityTypeByValue"),S=babelHelpers.classPrivateFieldLooseKey("addTagByValue"),A=babelHelpers.classPrivateFieldLooseKey("parseValue"),j=babelHelpers.classPrivateFieldLooseKey("isPhone"),K=babelHelpers.classPrivateFieldLooseKey("addErrorBlockByMessage"),x=babelHelpers.classPrivateFieldLooseKey("removeErrorBlock"),w=babelHelpers.classPrivateFieldLooseKey("createErrorBlockByMessage");class C extends t.EventEmitter{constructor(){super(),Object.defineProperty(this,w,{value:le}),Object.defineProperty(this,x,{value:re}),Object.defineProperty(this,K,{value:ie}),Object.defineProperty(this,j,{value:ae}),Object.defineProperty(this,A,{value:te}),Object.defineProperty(this,S,{value:se}),Object.defineProperty(this,_,{value:ee}),Object.defineProperty(this,m,{value:Z}),Object.defineProperty(this,N,{value:Q}),Object.defineProperty(this,O,{value:J}),Object.defineProperty(this,E,{value:z}),Object.defineProperty(this,I,{value:Y}),Object.defineProperty(this,f,{value:q}),Object.defineProperty(this,F,{value:$}),Object.defineProperty(this,H,{value:k}),Object.defineProperty(this,B,{value:G}),Object.defineProperty(this,y,{value:X}),Object.defineProperty(this,T,{value:W}),Object.defineProperty(this,L,{value:U}),Object.defineProperty(this,u,{value:R}),Object.defineProperty(this,g,{value:V}),Object.defineProperty(this,P,{value:D}),Object.defineProperty(this,v,{value:M}),Object.defineProperty(this,d,{writable:!0,value:new i.Cache.MemoryCache}),Object.defineProperty(this,p,{writable:!0,value:[]}),Object.defineProperty(this,h,{writable:!0,value:!1}),this.setEventNamespace("BX.Intranet.InvitationInput")}getTagSelector(){return babelHelpers.classPrivateFieldLooseBase(this,d)[d].remember("tagSelector",(()=>new a.TagSelector({id:"intranet-invitation-input-"+Math.random(4),showTextBox:!0,showAddButton:!1,placeholder:babelHelpers.classPrivateFieldLooseBase(this,B)[B](),tagTextColor:"#1E8D36",tagBgColor:"#D4FDB0",tagMaxWidth:200,events:{onAfterTagRemove:babelHelpers.classPrivateFieldLooseBase(this,f)[f].bind(this),onBeforeTagAdd:babelHelpers.classPrivateFieldLooseBase(this,I)[I].bind(this),onEnter:babelHelpers.classPrivateFieldLooseBase(this,O)[O].bind(this),onBlur:babelHelpers.classPrivateFieldLooseBase(this,N)[N].bind(this),onInput:babelHelpers.classPrivateFieldLooseBase(this,m)[m].bind(this)}})))}isReadySendInvitation(){return babelHelpers.classPrivateFieldLooseBase(this,h)[h]}render(){return babelHelpers.classPrivateFieldLooseBase(this,d)[d].remember("node",(()=>(this.getTagSelector().renderTo(this.getWrapper()),this.getTagSelector().focusTextBox(),this.getWrapper())))}renderTo(e){i.Dom.append(this.render(),e)}getWrapper(){return babelHelpers.classPrivateFieldLooseBase(this,d)[d].remember("wrapper",(()=>i.Tag.render(n||(n=c`
				<div class="intranet-invitation-wrapper">
			`))))}inviteToGroup(e){const s=new o(e,babelHelpers.classPrivateFieldLooseBase(this,P)[P]());return babelHelpers.classPrivateFieldLooseBase(this,v)[v](s)}}function M(e){return new Promise(((s,t)=>{babelHelpers.classPrivateFieldLooseBase(this,x)[x](),babelHelpers.classPrivateFieldLooseBase(this,g)[g]().length>0?(babelHelpers.classPrivateFieldLooseBase(this,K)[K](babelHelpers.classPrivateFieldLooseBase(this,H)[H]()),t(babelHelpers.classPrivateFieldLooseBase(this,H)[H]())):0===this.getTagSelector().getTags().length?(babelHelpers.classPrivateFieldLooseBase(this,K)[K](babelHelpers.classPrivateFieldLooseBase(this,F)[F]()),t(babelHelpers.classPrivateFieldLooseBase(this,F)[F]())):e.invite().then((()=>{this.getTagSelector().removeTags(),babelHelpers.classPrivateFieldLooseBase(this,L)[L](),s()})).catch((e=>{babelHelpers.classPrivateFieldLooseBase(this,K)[K](e.errors[0].message),t(e.errors[0].message)}))}))}function D(){babelHelpers.classPrivateFieldLooseBase(this,x)[x]();const e=this.getTagSelector().getTags(),s=[];return e.forEach((e=>{"email"===e.getEntityType()&&s.push({email:e.getTitle()}),"phone"===e.getEntityType()&&babelHelpers.classPrivateFieldLooseBase(this,T)[T]()&&!babelHelpers.classPrivateFieldLooseBase(this,p)[p].includes(e.getId())&&s.push({phone:e.getTitle()})})),s}function V(){const e=this.getTagSelector().getTags(),s=[];return e.forEach((e=>{"error"===e.getEntityType()&&s.push(e),"phone"===e.getEntityType()&&babelHelpers.classPrivateFieldLooseBase(this,T)[T]()&&babelHelpers.classPrivateFieldLooseBase(this,p)[p].includes(e.getId())&&s.push(e)})),s}function R(){this.emit("onReadySave"),babelHelpers.classPrivateFieldLooseBase(this,h)[h]=!0}function U(){this.emit("onUnreadySave"),babelHelpers.classPrivateFieldLooseBase(this,h)[h]=!1}function W(){const e=i.Extension.getSettings("intranet.invitation-input");return Boolean(null==e?void 0:e.isInvitationByPhoneAvailable)}function X(){return BX.PhoneNumberParser.getInstance()}function G(){return babelHelpers.classPrivateFieldLooseBase(this,T)[T]()?i.Loc.getMessage("INTRANET_INVITATION_INPUT_PLACEHOLDER_WITH_PHONE"):i.Loc.getMessage("INTRANET_INVITATION_INPUT_PLACEHOLDER")}function k(){return babelHelpers.classPrivateFieldLooseBase(this,T)[T]()?i.Loc.getMessage("INTRANET_INVITATION_INPUT_VALIDATION_MESSAGE_WITH_PHONE"):i.Loc.getMessage("INTRANET_INVITATION_INPUT_VALIDATION_MESSAGE")}function $(){return babelHelpers.classPrivateFieldLooseBase(this,T)[T]()?i.Loc.getMessage("INTRANET_INVITATION_INPUT_EMPTY_MESSAGE_WITH_PHONE"):i.Loc.getMessage("INTRANET_INVITATION_INPUT_EMPTY_MESSAGE")}function q(e){const s=e.getTarget().getTags(),t=s.filter((e=>"error"===e.getEntityType()));0===t.length&&babelHelpers.classPrivateFieldLooseBase(this,x)[x](),0===s.length?babelHelpers.classPrivateFieldLooseBase(this,L)[L]():0===t.length&&babelHelpers.classPrivateFieldLooseBase(this,u)[u]()}function Y(e){const{tag:s}=e.getData();e.target.getTextBox().placeholder="",babelHelpers.classPrivateFieldLooseBase(this,u)[u](),"error"===s.getEntityType()&&babelHelpers.classPrivateFieldLooseBase(this,E)[E](s),"phone"===s.getEntityType()&&babelHelpers.classPrivateFieldLooseBase(this,y)[y]().parse(s.getTitle()).then((e=>{e.valid?s.setTitle(e.rawNumber):(babelHelpers.classPrivateFieldLooseBase(this,E)[E](s),babelHelpers.classPrivateFieldLooseBase(this,p)[p].push(s.getId())),s.render()})).catch((()=>{}))}function z(e){e.setTextColor("#E92F2A"),e.setBgColor("#FFDCDB")}function J(e){const s=e.getTarget().getTextBoxValue();s&&!/^\s*$/.test(s)&&babelHelpers.classPrivateFieldLooseBase(this,S)[S](s)}function Q(e){babelHelpers.classPrivateFieldLooseBase(this,O)[O](e)}function Z(e){babelHelpers.classPrivateFieldLooseBase(this,u)[u]();const s=e.target,t=e.getData().event,a=[" ",","];let i=s.getTextBoxValue();const r=a.indexOf(t.data);if(-1===r)return;const l=a[r];i.endsWith(l)&&(i=i.slice(0,-1)),i&&babelHelpers.classPrivateFieldLooseBase(this,S)[S](i)}function ee(e){const s=!!babelHelpers.classPrivateFieldLooseBase(this,T)[T]()&&babelHelpers.classPrivateFieldLooseBase(this,j)[j](e);return i.Validation.isEmail(e)&&/^[^@]+@[^@]+\.[^@]+$/.test(e)?"email":s?"phone":"error"}function se(e){const s=this.getTagSelector();babelHelpers.classPrivateFieldLooseBase(this,A)[A](e).forEach((e=>{s.addTag({id:e,title:e,entityId:"invitation-tag",entityType:babelHelpers.classPrivateFieldLooseBase(this,_)[_](e)})})),s.clearTextBox()}function te(e){return e.split(/[\s,]+/).filter((e=>e.length>0))}function ae(e){return BX.PhoneNumber.getValidNumberRegex().test(e)}function ie(e){if(this.getWrapper().querySelector(".intranet-invitation-input-error__wrapper"))return;const s=babelHelpers.classPrivateFieldLooseBase(this,w)[w](e);this.getWrapper().append(s),babelHelpers.classPrivateFieldLooseBase(this,L)[L](),i.Dom.hasClass(this.getTagSelector().getOuterContainer(),"--error")||i.Dom.addClass(this.getTagSelector().getOuterContainer(),"--error")}function re(){const e=this.getWrapper().querySelector(".intranet-invitation-input-error__wrapper");e&&e.remove(),i.Dom.hasClass(this.getTagSelector().getOuterContainer(),"--error")&&i.Dom.removeClass(this.getTagSelector().getOuterContainer(),"--error")}function le(e){return i.Tag.render(b||(b=c`
			<div class="intranet-invitation-input-error__wrapper">
				<span class="ui-icon-set --warning"></span>
				<span class="intranet-invitation-input-error__text">${0}</span>
			</div>
		`),e)}e.InvitationInput=C}(this.BX.Intranet=this.BX.Intranet||{},BX.Cache,BX.Event,BX.UI.EntitySelector,BX);
//# sourceMappingURL=invitation-input.bundle.map.js