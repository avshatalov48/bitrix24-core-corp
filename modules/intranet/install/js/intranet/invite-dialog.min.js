(function(){if(!!BX.InviteDialog){return}BX.InviteDialog={bInit:false,popup:null,arParams:{},lastTab:"invite",lastUserTypeSuffix:"",sonetGroupSelector:null,popupHint:{},selectorIdList:[]};BX.InviteDialog.Init=function(e){this.signedParameters=e.signedParameters;this.componentName=e.componentName;if(e){BX.InviteDialog.arParams=e}if(BX.InviteDialog.bInit){return}BX.InviteDialog.bInit=true;BX.addCustomEvent(window,"BX.Main.SelectorV2:afterInitDialog",function(e){if(!BX.util.in_array(e.id,this.selectorIdList)){this.selectorIdList.push(e.id)}}.bind(this))};BX.InviteDialog.showMessage=function(e,t){if(BX("invite-dialog-error-block")){BX("invite-dialog-error-block").style.display="none"}if(BX("intranet-dialog-tabs")){if(typeof t!="undefined"&&t&&t.length>0){BX("intranet-dialog-tabs").parentNode.appendChild(BX.create("div",{props:{className:"webform-round-corners webform-error-block"},attrs:{id:"invite-dialog-error-block"},style:{"margin-top":"10px"},children:[BX.create("div",{props:{className:"webform-corners-top"},children:[BX.create("div",{props:{className:"webform-left-corner"}}),BX.create("div",{props:{className:"webform-right-corner"}})]}),BX.create("div",{props:{className:"webform-content"},attrs:{id:"invite-dialog-error-content"},html:t}),BX.create("div",{props:{className:"webform-corners-bottom"},children:[BX.create("div",{props:{className:"webform-left-corner"}}),BX.create("div",{props:{className:"webform-right-corner"}})]})]}))}BX("intranet-dialog-tabs").parentNode.appendChild(BX.create("table",{children:[BX.create("tr",{children:[BX.create("td",{props:{className:"invite-dialog-inv-form",style:"min-height:100px; min-width: 420px; vertical-align:center; text-align: center;font-size: 13px;"},html:e})]}),BX.create("tr",{children:[BX.create("td",{props:{className:"invite-dialog-inv-form",style:"min-height:100px; min-width: 420px; vertical-align:center; text-align: center;font-size: 13px;"},html:"<span class='popup-window-button popup-window-button-accept'>"+BX.message(BX.InviteDialog.lastTab=="add"?"BX24_INVITE_DIALOG_CONTINUE_ADD_BUTTON":"BX24_INVITE_DIALOG_CONTINUE_INVITE_BUTTON")+"</span>",events:{click:function(){B24.Bitrix24InviteDialog.loadForm()}}})]})],props:{style:"min-height:100px; min-width: 420px; margin: 0 0 9px 0;"}}));BX.cleanNode(BX("intranet-dialog-tabs"),true)}};BX.InviteDialog.showError=function(e){if(BX("invite-dialog-error-block")){BX("invite-dialog-error-block").style.display="block";if(BX("invite-dialog-error-content")){BX("invite-dialog-error-content").innerHTML=e}}};BX.InviteDialog.bindInviteDialogStructureLink=function(e){if(typeof e=="undefined"||e==null){return}BX.bind(e,"click",function(t){if(!t)t=window.event;if(inviteDialogDepartmentPopup===null){inviteDialogDepartmentPopup=new BX.PopupWindow("invite-dialog-department-popup",e,{offsetTop:1,autoHide:true,angle:{position:"top",offset:50},content:BX("INVITE_DEPARTMENT_selector_content"),zIndex:1200,buttons:[]})}if(!inviteDialogDepartmentPopup.isShown()){inviteDialogDepartmentPopup.setBindElement(BX("invite-dialog-"+this.lastTab+"-structure-link"));inviteDialogDepartmentPopup.show()}BX.PopupMenu.destroy("invite-dialog-usertype-popup");this.closeSelectorPopups();t.stopPropagation();return t.preventDefault()}.bind(this))};BX.InviteDialog.bindInviteDialogSonetGroupLink=function(e){if(typeof e=="undefined"||e==null){return}BX.bind(e,"click",function(e){var t=BX("invite-dialog-"+this.lastTab+this.lastUserTypeSuffix+"-sonetgroup-container-post");if(t){t.style.display="block"}if(BX("invite-dialog-"+this.lastTab+this.lastUserTypeSuffix+"-sonetgroup-container-post")){this.closeSelectorPopups()}e.stopPropagation();e.preventDefault()}.bind(this))};BX.InviteDialog.closeSelectorPopups=function(){var e=null;for(var t=0;t<this.selectorIdList.length;t++){e=BX.UI.SelectorManager.instances[this.selectorIdList[t]];if(BX.type.isNotEmptyObject(e)){e.closeAllPopups()}}};BX.InviteDialog.onInviteDialogUserTypeSelect=function(e){if(e!="extranet"){e="employee"}BX.InviteDialog.lastUserTypeSuffix=e=="employee"?"":"-extranet";BX.InviteDialog.sonetGroupSelector=BX("invite-dialog-"+BX.InviteDialog.lastTab+BX.InviteDialog.lastUserTypeSuffix+"-sonetgroup-container-post").getAttribute("data-selector-name");BX("invite-dialog-"+BX.InviteDialog.lastTab+"-usertype-block-employee").style.display=e=="employee"?"block":"none";if(BX("invite-dialog-"+BX.InviteDialog.lastTab+"-usertype-block-extranet")){BX("invite-dialog-"+BX.InviteDialog.lastTab+"-usertype-block-extranet").style.display=e=="employee"?"none":"block"}if(e=="extranet"){BX("invite-dialog-"+BX.InviteDialog.lastTab+"-extranet-sonetgroup-container-post").style.display="block";BX("invite-dialog-"+BX.InviteDialog.lastTab+"-sonetgroup-container-post").style.display="none";var t=BX("invite-dialog-"+BX.InviteDialog.lastTab+BX.InviteDialog.lastUserTypeSuffix+"-sonetgroup-container-post").getAttribute("data-selector-name");if(BX.type.isNotEmptyString(t)){var i=BX.UI.SelectorManager.instances[t];if(BX.type.isNotEmptyObject(i)){i.setOption("allowAdd","Y","SONETGROUPS");i.setOption("newGroupType","extranet","SONETGROUPS")}}}else{BX("invite-dialog-"+BX.InviteDialog.lastTab+"-sonetgroup-container-post").style.display="block";BX("invite-dialog-"+BX.InviteDialog.lastTab+"-extranet-sonetgroup-container-post").style.display="none"}if(BX("intranet-dialog-tab-content-"+BX.InviteDialog.lastTab)){BX("intranet-dialog-tab-content-"+BX.InviteDialog.lastTab).setAttribute("data-user-type",e)}BX.PopupMenu.destroy("invite-dialog-usertype-popup");if(BX.InviteDialog.lastTab=="add"&&BX("invite-dialog-mailbox-container")){BX("invite-dialog-mailbox-container").style.display=e=="extranet"?"none":"block"}};BX.InviteDialog.bindInviteDialogUserTypeLink=function(e,t){t=!!t;if(typeof e=="undefined"||e==null){return}BX.bind(e,"click",function(i){BX.PopupMenu.destroy("invite-dialog-usertype-popup");var n=[{text:BX.message("inviteDialogTitleEmployee"),id:"invite-dialog-usertype-popup-employee-title",className:"menu-popup-no-icon",onclick:function(){BX.InviteDialog.onInviteDialogUserTypeSelect("employee")}}];if(t){n.push({text:BX.message("inviteDialogTitleExtranet"),id:"invite-dialog-usertype-popup-extranet-title",className:"menu-popup-no-icon",onclick:function(){BX.InviteDialog.onInviteDialogUserTypeSelect("extranet")}})}var o={offsetLeft:-14,offsetTop:4,zIndex:1200,lightShadow:false,angle:{position:"top",offset:50},events:{onPopupShow:function(e){}}};BX.PopupMenu.show("invite-dialog-usertype-popup",e,n,o)})};BX.InviteDialog.bindInviteDialogChangeTab=function(e){if(typeof e=="undefined"||e==null){return}BX.bind(e,"click",function(t){if(!t)t=window.event;var i=e.getAttribute("data-action");if(i.length>0){this.lastTab=i;for(var n=0;n<arTabs.length;n++){if(arTabs[n].id=="intranet-dialog-tab-"+this.lastTab){BX.addClass(arTabs[n],"popup-window-tab-selected")}else{BX.removeClass(arTabs[n],"popup-window-tab-selected")}}for(n=0;n<arTabsContent.length;n++){if(arTabsContent[n].id=="intranet-dialog-tab-content-"+this.lastTab){BX.addClass(arTabsContent[n],"popup-window-tab-content-selected")}else{BX.removeClass(arTabsContent[n],"popup-window-tab-content-selected")}}if(BX("invite-dialog-"+i+this.lastUserTypeSuffix+"-sonetgroup-container-post")){this.sonetGroupSelector=BX("invite-dialog-"+i+this.lastUserTypeSuffix+"-sonetgroup-container-post").getAttribute("data-selector-name")}this.closeSelectorPopups();if(inviteDialogDepartmentPopup!=null){inviteDialogDepartmentPopup.close()}BX.PopupMenu.destroy("invite-dialog-usertype-popup");var o=window.BX?window:window.top.BX?window.top:null;if(o){o.B24.Bitrix24InviteDialog.popup.setTitleBar(o.BX.message("BX24_INVITE_TITLE_"+(i=="invite"||i=="invite-phone"||i=="self"?"INVITE":"ADD")))}}t.stopPropagation();return t.preventDefault()}.bind(this))};BX.InviteDialog.getEmail1=function(){var e="";if(BX("ADD_EMAIL")){e=BX("ADD_EMAIL").value}return e};BX.InviteDialog.getEmail2=function(){var e="";if(BX("ADD_MAILBOX_ACTION")&&BX("ADD_MAILBOX_ACTION").value=="connect"&&BX("ADD_MAILBOX_USER_connect")){var t=BX("ADD_MAILBOX_USER_connect").options[BX("ADD_MAILBOX_USER_connect").selectedIndex].value;var i=typeof BX("ADD_MAILBOX_DOMAIN_connect").options!="undefined"?BX("ADD_MAILBOX_DOMAIN_connect").options[BX("ADD_MAILBOX_DOMAIN_connect").selectedIndex].getAttribute("data-service-id"):BX("ADD_MAILBOX_SERVICE_connect").value;if(typeof i!="undefined"&&parseInt(i)>0&&typeof arConnectMailServicesDomains[i]!="undefined"){e=t+"@"+arConnectMailServicesDomains[i]}}return e};BX.InviteDialog.setEmail2=function(e,t){if(!BX("ADD_SEND_PASSWORD")||!BX("ADD_SEND_PASSWORD_EMAIL")){return}if(t.length>0){if(e.length<=0){BX("ADD_SEND_PASSWORD").disabled=false;BX("ADD_SEND_PASSWORD_EMAIL").innerHTML="<br>("+BX.util.htmlspecialchars(t)+")"}}else{if(e.length<=0){BX("ADD_SEND_PASSWORD_EMAIL").innerHTML="";BX("ADD_SEND_PASSWORD").checked=false;BX("ADD_SEND_PASSWORD").disabled=true}else{BX("ADD_SEND_PASSWORD").disabled=false;BX("ADD_SEND_PASSWORD_EMAIL").innerHTML="<br>("+BX.util.htmlspecialchars(e)+")"}}};BX.InviteDialog.setEmail1=function(e,t){if(!BX("ADD_SEND_PASSWORD")||!BX("ADD_SEND_PASSWORD_EMAIL")){return}if(e.length>0){BX("ADD_SEND_PASSWORD_EMAIL").innerHTML="<br>("+BX.util.htmlspecialchars(e)+")";BX("ADD_SEND_PASSWORD").disabled=false}else{if(t.length>0){BX("ADD_SEND_PASSWORD").disabled=false;BX("ADD_SEND_PASSWORD_EMAIL").innerHTML="<br>("+BX.util.htmlspecialchars(t)+")"}else{BX("ADD_SEND_PASSWORD_EMAIL").innerHTML="";BX("ADD_SEND_PASSWORD").checked=false;BX("ADD_SEND_PASSWORD").disabled=true}}};BX.InviteDialog.bindSendPasswordEmail=function(){if(!BX("ADD_SEND_PASSWORD")||!BX("ADD_SEND_PASSWORD_EMAIL")){return}if(BX("ADD_EMAIL")){BX.bind(BX("ADD_EMAIL"),"bxchange",function(){var e=BX.InviteDialog.getEmail1();var t=BX.InviteDialog.getEmail2();BX.InviteDialog.setEmail1(e,t)})}if(BX("ADD_MAILBOX_USER_connect")){BX.bind(BX("ADD_MAILBOX_USER_connect"),"change",function(){var e=BX.InviteDialog.getEmail1();var t=BX.InviteDialog.getEmail2();BX.InviteDialog.setEmail2(e,t)})}if(BX("ADD_MAILBOX_DOMAIN_connect")){BX.bind(BX("ADD_MAILBOX_DOMAIN_connect"),"change",function(){var e=BX.InviteDialog.getEmail1();var t=BX.InviteDialog.getEmail2();BX.InviteDialog.setEmail2(e,t)})}};BX.InviteDialog.bindInviteDialogSubmit=function(e){if(typeof e=="undefined"||e==null){return}var t=BX.findParent(e,{tagName:"form"});if(BX.type.isDomNode(t)){t.onsubmit=function(){return false}}BX.bind(e,"click",function(t){if(!t)t=window.event;this.closeSelectorPopups();BX.PopupMenu.destroy("invite-dialog-usertype-popup");var i=null;var n=[];var o=null;switch(e.id){case"invite-dialog-self-button-submit":i={action:"self",allow_register:document.forms.SELF_DIALOG_FORM["allow_register"].checked?"Y":"N",allow_register_confirm:document.forms.SELF_DIALOG_FORM["allow_register_confirm"].value,allow_register_secret:document.forms.SELF_DIALOG_FORM["allow_register_secret"].value,allow_register_whitelist:document.forms.SELF_DIALOG_FORM["allow_register_whitelist"].value,allow_register_text:document.forms.SELF_DIALOG_FORM["allow_register_text"].value,sessid:BX.bitrix_sessid()};this.selfSubmitAction(i,e);return;case"invite-dialog-invite-button-submit":if(typeof document.forms.INVITE_DIALOG_FORM["SONET_GROUPS[]"]!="undefined"){if(typeof document.forms.INVITE_DIALOG_FORM["SONET_GROUPS[]"].value=="undefined"){n=document.forms.INVITE_DIALOG_FORM["SONET_GROUPS[]"]}else{n=[document.forms.INVITE_DIALOG_FORM["SONET_GROUPS[]"]]}}i={EMAIL:document.forms.INVITE_DIALOG_FORM["EMAIL"].value,MESSAGE_TEXT:document.forms.INVITE_DIALOG_FORM["MESSAGE_TEXT"].value,DEPARTMENT_ID:BX("intranet-dialog-tab-content-invite").getAttribute("data-user-type")=="extranet"?0:document.forms.INVITE_DIALOG_FORM["DEPARTMENT_ID"].value};o=BX.InviteDialog.processSonetGroupsInput(n,document.forms.INVITE_DIALOG_FORM);if(o.arCode.length>0){i.SONET_GROUPS_CODE=o.arCode}if(typeof o.arName=="object"&&Object.keys(o.arName).length>0){i.SONET_GROUPS_NAME=o.arName}this.inviteAction(i,e);return;case"invite-dialog-invite-phone-button-submit":if(typeof document.forms.INVITE_DIALOG_FORM_PHONE["SONET_GROUPS[]"]!="undefined"){if(typeof document.forms.INVITE_DIALOG_FORM_PHONE["SONET_GROUPS[]"].value=="undefined"){n=document.forms.INVITE_DIALOG_FORM_PHONE["SONET_GROUPS[]"]}else{n=[document.forms.INVITE_DIALOG_FORM_PHONE["SONET_GROUPS[]"]]}}var a=document.forms.INVITE_DIALOG_FORM_PHONE["PHONE[]"];var l=document.forms.INVITE_DIALOG_FORM_PHONE["PHONE_COUNTRY[]"];var s=[];var r=[];if(a){if(typeof a.length==="undefined"){a=[a];l=[l]}a.forEach(function(e,t){var i=BX.util.trim(e.value);if(i.length>0){s.push(i);r.push(l[t].value)}})}i={action:"invite-phone",PHONE:s,PHONE_COUNTRY:r,MESSAGE_TEXT:document.forms.INVITE_DIALOG_FORM_PHONE["MESSAGE_TEXT"].value,DEPARTMENT_ID:BX("intranet-dialog-tab-content-invite-phone").getAttribute("data-user-type")=="extranet"?0:document.forms.INVITE_DIALOG_FORM_PHONE["DEPARTMENT_ID"].value,sessid:BX.bitrix_sessid()};o=BX.InviteDialog.processSonetGroupsInput(n,document.forms.INVITE_DIALOG_FORM_PHONE);if(o.arCode.length>0){i.SONET_GROUPS_CODE=o.arCode}if(typeof o.arName=="object"&&Object.keys(o.arName).length>0){i.SONET_GROUPS_NAME=o.arName}this.inviteByPhoneAction(i,e);return;case"invite-dialog-add-button-submit":if(typeof document.forms.ADD_DIALOG_FORM["SONET_GROUPS[]"]!="undefined"){if(typeof document.forms.ADD_DIALOG_FORM["SONET_GROUPS[]"].value=="undefined"){n=document.forms.ADD_DIALOG_FORM["SONET_GROUPS[]"]}else{n=[document.forms.ADD_DIALOG_FORM["SONET_GROUPS[]"]]}}i={action:"add",ADD_EMAIL:document.forms.ADD_DIALOG_FORM["ADD_EMAIL"].value,ADD_NAME:document.forms.ADD_DIALOG_FORM["ADD_NAME"].value,ADD_LAST_NAME:document.forms.ADD_DIALOG_FORM["ADD_LAST_NAME"].value,ADD_POSITION:document.forms.ADD_DIALOG_FORM["ADD_POSITION"].value,ADD_SEND_PASSWORD:document.forms.ADD_DIALOG_FORM["ADD_SEND_PASSWORD"]&&!!document.forms.ADD_DIALOG_FORM["ADD_SEND_PASSWORD"].checked?document.forms.ADD_DIALOG_FORM["ADD_SEND_PASSWORD"].value:"N",DEPARTMENT_ID:BX("intranet-dialog-tab-content-add").getAttribute("data-user-type")=="extranet"?0:document.forms.ADD_DIALOG_FORM["DEPARTMENT_ID"].value,sessid:BX.bitrix_sessid()};o=BX.InviteDialog.processSonetGroupsInput(n,document.forms.ADD_DIALOG_FORM);if(o.arCode.length>0){i.SONET_GROUPS_CODE=o.arCode}if(typeof o.arName=="object"&&Object.keys(o.arName).length>0){i.SONET_GROUPS_NAME=o.arName}if(BX("ADD_MAILBOX_ACTION")&&BX.util.in_array(BX("ADD_MAILBOX_ACTION").value,["create","connect"])){i.ADD_MAILBOX_ACTION=BX("ADD_MAILBOX_ACTION").value;if(BX("ADD_MAILBOX_ACTION").value=="create"){i.ADD_MAILBOX_PASSWORD=BX("ADD_MAILBOX_PASSWORD").value;i.ADD_MAILBOX_PASSWORD_CONFIRM=BX("ADD_MAILBOX_PASSWORD_CONFIRM").value;i.ADD_MAILBOX_DOMAIN=BX("ADD_MAILBOX_DOMAIN_create").value;i.ADD_MAILBOX_USER=BX("ADD_MAILBOX_USER_create").value;i.ADD_MAILBOX_SERVICE=typeof BX("ADD_MAILBOX_DOMAIN_create").options!="undefined"?BX("ADD_MAILBOX_DOMAIN_create").options[BX("ADD_MAILBOX_DOMAIN_create").selectedIndex].getAttribute("data-service-id"):BX("ADD_MAILBOX_SERVICE_create").value}else if(BX("ADD_MAILBOX_ACTION").value=="connect"){i.ADD_MAILBOX_USER=BX("ADD_MAILBOX_USER_connect").value;i.ADD_MAILBOX_DOMAIN=BX("ADD_MAILBOX_DOMAIN_connect").value;i.ADD_MAILBOX_SERVICE=typeof BX("ADD_MAILBOX_DOMAIN_connect").options!="undefined"?BX("ADD_MAILBOX_DOMAIN_connect").options[BX("ADD_MAILBOX_DOMAIN_connect").selectedIndex].getAttribute("data-service-id"):BX("ADD_MAILBOX_SERVICE_connect").value}}this.addAction(i,e);return;case"invite-dialog-integrator-button-submit":i={action:"integrator",integrator_email:document.forms.INTEGRATOR_DIALOG_FORM["integrator_email"].value,sessid:BX.bitrix_sessid()};if(document.forms.INTEGRATOR_DIALOG_FORM["INTEGRATOR_MESSAGE_TEXT"]){i["integrator_message_text"]=document.forms.INTEGRATOR_DIALOG_FORM["INTEGRATOR_MESSAGE_TEXT"].value}this.inviteIntegratorAction(i,e);return}if(i){BX.InviteDialog.disableSubmitButton(true,e);var u=BX.message("inviteDialogSubmitUrl");u=BX.util.add_url_param(u,{b24statForm:"inviteDialog",b24statAction:i.action});if(i.action=="self"){u=BX.util.add_url_param(u,{b24statValue:i.allow_register})}else if(i.action=="invite"){u=BX.util.add_url_param(u,{b24statValue:BX.type.isDomNode(document.forms.INVITE_DIALOG_FORM["MESSAGE_TEXT_DEFAULT"])&&BX.type.isNotEmptyString(document.forms.INVITE_DIALOG_FORM["MESSAGE_TEXT_DEFAULT"].value)&&document.forms.INVITE_DIALOG_FORM["MESSAGE_TEXT_DEFAULT"].value!=i.MESSAGE_TEXT?"Y":"N",b24statExtranet:parseInt(i.DEPARTMENT_ID)<=0?"Y":"N"})}else if(i.action=="add"){u=BX.util.add_url_param(u,{b24statExtranet:parseInt(i.DEPARTMENT_ID)<=0?"Y":"N"})}BX.ajax({url:u,method:"POST",dataType:"json",data:i,onsuccess:function(t){BX.InviteDialog.disableSubmitButton(false,e);if(typeof t["ERROR"]!="undefined"&&t["ERROR"].length>0){if(t.hasOwnProperty("TYPE")&&t["TYPE"]=="userLimit"){B24.licenseInfoPopup.show("featureID",BX.message("BX24_INVITE_DIALOG_USERS_LIMIT_TITLE"),BX.message("BX24_INVITE_DIALOG_USERS_LIMIT_TEXT"))}else{BX.InviteDialog.showError(t["ERROR"])}}else if(typeof t["MESSAGE"]!="undefined"&&t["MESSAGE"].length>0){BX.InviteDialog.showMessage(t["MESSAGE"],typeof t["WARNING"]!="undefined"&&t["WARNING"].length>0?t["WARNING"]:false)}},onfailure:function(t){BX.InviteDialog.disableSubmitButton(false,e);BX.InviteDialog.showError(t["ERROR"])}})}t.stopPropagation();return t.preventDefault()}.bind(this))};BX.InviteDialog.inviteAction=function(e,t){BX.InviteDialog.disableSubmitButton(true,t);BX.ajax.runComponentAction(this.componentName,"invite",{signedParameters:this.signedParameters,mode:"ajax",data:e}).then(function(e){BX.InviteDialog.disableSubmitButton(false,t);if(e.data){BX.InviteDialog.showMessage(e.data)}}.bind(this),function(e){BX.InviteDialog.disableSubmitButton(false,t);if(e.data=="user_limit"){B24.licenseInfoPopup.show("featureID",BX.message("BX24_INVITE_DIALOG_USERS_LIMIT_TITLE"),BX.message("BX24_INVITE_DIALOG_USERS_LIMIT_TEXT"))}else{BX.InviteDialog.showError(e.errors[0].message)}}.bind(this))};BX.InviteDialog.inviteByPhoneAction=function(e,t){BX.InviteDialog.disableSubmitButton(true,t);BX.ajax.runComponentAction(this.componentName,"inviteByPhone",{signedParameters:this.signedParameters,mode:"ajax",data:e}).then(function(e){BX.InviteDialog.disableSubmitButton(false,t);if(e.data){BX.InviteDialog.showMessage(e.data)}}.bind(this),function(e){BX.InviteDialog.disableSubmitButton(false,t);if(e.data=="user_limit"){B24.licenseInfoPopup.show("featureID",BX.message("BX24_INVITE_DIALOG_USERS_LIMIT_TITLE"),BX.message("BX24_INVITE_DIALOG_USERS_LIMIT_TEXT"))}else{BX.InviteDialog.showError(e.errors[0].message)}}.bind(this))};BX.InviteDialog.addAction=function(e,t){BX.InviteDialog.disableSubmitButton(true,t);BX.ajax.runComponentAction(this.componentName,"add",{signedParameters:this.signedParameters,mode:"ajax",data:e}).then(function(e){BX.InviteDialog.disableSubmitButton(false,t);if(e.data){BX.InviteDialog.showMessage(e.data)}}.bind(this),function(e){BX.InviteDialog.disableSubmitButton(false,t);if(e.data=="user_limit"){B24.licenseInfoPopup.show("featureID",BX.message("BX24_INVITE_DIALOG_USERS_LIMIT_TITLE"),BX.message("BX24_INVITE_DIALOG_USERS_LIMIT_TEXT"))}else{BX.InviteDialog.showError(e.errors[0].message)}}.bind(this))};BX.InviteDialog.selfSubmitAction=function(e,t){BX.InviteDialog.disableSubmitButton(true,t);BX.ajax.runComponentAction(this.componentName,"self",{signedParameters:this.signedParameters,mode:"ajax",data:e}).then(function(e){BX.InviteDialog.disableSubmitButton(false,t);if(e.data){BX.InviteDialog.showMessage(e.data)}}.bind(this),function(e){BX.InviteDialog.disableSubmitButton(false,t)}.bind(this))};BX.InviteDialog.inviteIntegratorAction=function(e,t){BX.InviteDialog.disableSubmitButton(true,t);BX.ajax.runComponentAction(this.componentName,"inviteIntegrator",{signedParameters:this.signedParameters,mode:"ajax",data:e}).then(function(e){BX.InviteDialog.disableSubmitButton(false,t);if(e.data){BX.InviteDialog.showMessage(e.data)}}.bind(this),function(e){BX.InviteDialog.disableSubmitButton(false,t);BX.InviteDialog.showError(e.errors[0].message)}.bind(this))};BX.InviteDialog.bindInviteDialogClose=function(e){if(typeof e=="undefined"||e==null){return}BX.bind(e,"click",function(e){if(!e)e=window.event;BX.InviteDialog.onInviteDialogClose(true);e.stopPropagation();return e.preventDefault()})};BX.InviteDialog.onInviteDialogClose=function(e){e=!!e;this.closeSelectorPopups();if(inviteDialogDepartmentPopup!=null){inviteDialogDepartmentPopup.destroy()}if(e&&B24.Bitrix24InviteDialog.popup!=null){B24.Bitrix24InviteDialog.popup.close()}BX.InviteDialog.lastTab="invite"};BX.InviteDialog.onMailboxAction=function(e){if(e!="connect"){e="create"}var t=e=="connect"?"create":"connect";if(BX("invite-dialog-mailbox-container")){BX.removeClass(BX("invite-dialog-mailbox-container"),"invite-dialog-box-info-set-inactive")}if(BX("invite-dialog-mailbox-content-"+e)){BX("invite-dialog-mailbox-content-"+e).style.display="block"}if(BX("invite-dialog-mailbox-content-"+t)){BX("invite-dialog-mailbox-content-"+t).style.display="none"}if(BX("invite-dialog-mailbox-action-"+e)){BX.addClass(BX("invite-dialog-mailbox-action-"+e),"invite-dialog-box-info-btn-active")}if(BX("invite-dialog-mailbox-action-"+t)){BX.removeClass(BX("invite-dialog-mailbox-action-"+t),"invite-dialog-box-info-btn-active")}if(BX("ADD_MAILBOX_ACTION")){BX("ADD_MAILBOX_ACTION").value=e}var i=BX.InviteDialog.getEmail1();var n=e=="connect"?BX.InviteDialog.getEmail2():"";BX.InviteDialog.setEmail2(i,n)};BX.InviteDialog.onMailboxRollup=function(){if(BX("invite-dialog-mailbox-container")){BX.addClass(BX("invite-dialog-mailbox-container"),"invite-dialog-box-info-set-inactive")}if(BX("invite-dialog-mailbox-action-create")){BX.removeClass(BX("invite-dialog-mailbox-action-create"),"invite-dialog-box-info-btn-active")}if(BX("invite-dialog-mailbox-action-connect")){BX.removeClass(BX("invite-dialog-mailbox-action-connect"),"invite-dialog-box-info-btn-active")}if(BX("ADD_MAILBOX_ACTION")){BX("ADD_MAILBOX_ACTION").value=""}var e=BX.InviteDialog.getEmail1();var t="";BX.InviteDialog.setEmail2(e,t)};BX.InviteDialog.onMailboxServiceSelect=function(e){if(e){var t=e.options[e.selectedIndex].getAttribute("data-service-id");var i=e.options[e.selectedIndex].getAttribute("data-domain");if(BX("ADD_MAILBOX_USER_connect")){BX.cleanNode(BX("ADD_MAILBOX_USER_connect"))}if(i.length>0&&typeof arMailServicesUsers[i]!="undefined"){for(var n=0;n<arMailServicesUsers[i].length;n++){BX("ADD_MAILBOX_USER_connect").appendChild(BX.create("OPTION",{props:{value:arMailServicesUsers[i][n]},attrs:{"data-service-id":t},text:arMailServicesUsers[i][n]}))}}}};BX.InviteDialog.disableSubmitButton=function(e,t){e=!!e;if(t){if(e){BX.addClass(t,"popup-window-button-disabled");BX.addClass(t,"popup-window-button-wait");t.style.cursor="auto"}else{BX.removeClass(t,"popup-window-button-disabled");BX.removeClass(t,"popup-window-button-wait");t.style.cursor="pointer"}}};BX.InviteDialog.processSonetGroupsInput=function(e,t){var i={arName:[],arCode:[]};var n=null;for(var o=0,a=e.length;o<a;o++){if(typeof e[o].tagName=="undefined"){for(var l=0,s=e[o].length;l<s;l++){if(typeof e[o][l]!="undefined"&&e[o][l].value.length>0){n=e[o][l].value;i.arCode.push(n);if(typeof t.elements["SONET_GROUPS_NAME["+n+"]"]!="undefined"&&typeof t.elements["SONET_GROUPS_NAME["+n+"]"].value!="undefined"){i.arName[n]=t.elements["SONET_GROUPS_NAME["+n+"]"].value}}}}else{if(typeof e[o]!="undefined"&&e[o].value.length>0){n=e[o].value;i.arCode.push(n);if(typeof t.elements["SONET_GROUPS_NAME["+n+"]"]!="undefined"&&typeof t.elements["SONET_GROUPS_NAME["+n+"]"].value!="undefined"){i.arName[n]=t.elements["SONET_GROUPS_NAME["+n+"]"].value}}}}return i};BX.InviteDialog.initHint=function(e){var t=BX(e);if(t){t.setAttribute("data-id",t);BX.bind(t,"mouseover",BX.proxy(function(){var e=BX.proxy_context.getAttribute("data-id");var t=BX.proxy_context.getAttribute("data-text");this.showHint(e,BX.proxy_context,t)},this));BX.bind(t,"mouseout",BX.proxy(function(){var e=BX.proxy_context.getAttribute("data-id");this.hideHint(e)},this))}};BX.InviteDialog.showHint=function(e,t,i){if(this.popupHint[e]){this.popupHint[e].close()}this.popupHint[e]=new BX.PopupWindow("invite-dialog-help"+e,t,{lightShadow:true,autoHide:false,darkMode:true,offsetLeft:0,offsetTop:2,bindOptions:{position:"top"},zIndex:1100,events:{onPopupClose:function(){this.destroy()}},content:BX.create("div",{attrs:{style:"padding-right: 5px; width: 250px;"},html:i})});this.popupHint[e].setAngle({offset:13,position:"bottom"});this.popupHint[e].show();return true};BX.InviteDialog.hideHint=function(e){this.popupHint[e].close();this.popupHint[e]=null};BX.InviteDialog.regenerateSecret=function(e){var t=BX.util.getRandomString(8);if(BX.type.isDomNode(BX("allow_register_secret"))){BX("allow_register_secret").value=t||""}if(BX.type.isDomNode(BX("allow_register_url"))&&e){BX("allow_register_url").value=e+(t||"yes")}};BX.InviteDialog.copyRegisterUrl=function(){if(BX.type.isDomNode(BX("allow_register_url"))){BX.clipboard.copy(BX("allow_register_url").value);var e=new BX.PopupWindow("inviteCopyRegisterUrl",BX("allow_register_url"),{content:BX.message("BX24_INVITE_DIALOG_COPY_URL"),zIndex:15e3,angle:true,offsetTop:0,offsetLeft:50,closeIcon:false,autoHide:true,darkMode:true,overlay:false,events:{onAfterPopupShow:function(){setTimeout(function(){this.close()}.bind(this),1500)}}});e.show();BX.ajax.runAction("intranet.controller.invite.copyregisterurl",{data:{}}).then(function(e){}.bind(this),function(e){}.bind(this))}};BX.InviteDialog.toggleSettings=function(){if(BX.type.isDomNode(BX("intranet-dialog-tab-content-self-hidden-block"))){BX.toggle(BX("intranet-dialog-tab-content-self-hidden-block"))}}})();
//# sourceMappingURL=invite-dialog.map.js