(function(){"use strict";BX.namespace("BX.Intranet");BX.Intranet.NotifyDialog=function(t){if(!BX.type.isPlainObject(t)){throw new Error('BX.Intranet.Notify: "options" is not an object.')}if(!BX.type.isArray(t.listUserData)){throw new Error('BX.Intranet.Notify: "listUserData" is not an array.')}if(!BX.type.isNotEmptyString(t.notificationHandlerUrl)){throw new Error('BX.Intranet.Notify: "notificationHandlerUrl" is required.')}this.listUserData=t.listUserData;this.notificationHandlerUrl=t.notificationHandlerUrl;this.postData=t.postData||{};var e,i,n,o;if(t.popupTexts){e=t.popupTexts.hasOwnProperty("title")&&BX.type.isNotEmptyString(t.popupTexts.title)?t.popupTexts.title:"Title";i=t.popupTexts.hasOwnProperty("header")&&BX.type.isNotEmptyString(t.popupTexts.header)?t.popupTexts.header:"Header";n=t.popupTexts.hasOwnProperty("description")&&BX.type.isNotEmptyString(t.popupTexts.description)?t.popupTexts.description:"Description";o=t.popupTexts.hasOwnProperty("sendButton")&&BX.type.isNotEmptyString(t.popupTexts.sendButton)?t.popupTexts.sendButton:"SendButton"}else{e="Title";i="Header";n="Description";o="SendButton"}this.popupTexts={title:e,header:i,description:n,sendButton:o};this.closePopupAfterNotify=t.closePopupAfterNotify==="Y";this.init()};BX.Intranet.NotifyDialog.prototype.constructor=BX.Intranet.NotifyDialog;BX.Intranet.NotifyDialog.prototype.init=function(){this.popup=null;this.createPopup()};BX.Intranet.NotifyDialog.prototype.setUsersForNotify=function(t){if(!BX.type.isArray(t)){throw new Error('BX.Intranet.Notify: "listUserData" is not an array.')}this.listUserData=t;this.popup=null};BX.Intranet.NotifyDialog.prototype.show=function(){if(this.popup===null){this.createPopup()}this.popup.show()};BX.Intranet.NotifyDialog.prototype.sendNotify=function(){var t=BX.proxy_context.dataset.id;BX.addClass(BX("intranet-notify-dialog-button-"+t),"webform-small-button-wait");this.postData["SITE_ID"]=BX.message("SITE_ID");this.postData["sessid"]=BX.bitrix_sessid();this.postData["userId"]=t;BX.ajax({method:"POST",dataType:"json",url:this.notificationHandlerUrl,data:this.postData,onsuccess:BX.proxy(function(e){if(e.status==="success"){BX.hide(BX("intranet-notify-dialog-button-"+t));BX("intranet-notify-dialog-success-"+t).innerHTML=BX.message("INTRANET_NOTIFY_DIALOG_NOTIFY_SUCCESS");if(this.closePopupAfterNotify){setTimeout(BX.proxy(function(){this.popup.destroy()},this),1e3)}}BX.removeClass(BX("intranet-notify-dialog-button-"+t),"webform-small-button-wait")},this)})};BX.Intranet.NotifyDialog.prototype.createPopup=function(){this.popup=new BX.PopupWindow("intranet-notify-popup",null,{content:this.createContent(),overlay:true,closeIcon:{marginRight:"4px",marginTop:"9px"},closeByEsc:true,buttons:[new BX.PopupWindowButton({text:BX.message("INTRANET_NOTIFY_DIALOG_BUTTON_CLOSE"),events:{click:BX.proxy(function(){this.popup.destroy()},this)}})]});this.listUserData.forEach(function(t){BX.bind(BX("intranet-notify-dialog-button-"+t.id),"click",BX.proxy(this.sendNotify,this))},this)};BX.Intranet.NotifyDialog.prototype.createContent=function(){var t,e;e=BX.create("div",{children:[BX.create("span",{props:{className:"intranet-notify-dialog-header"},children:[BX.create("span",{props:{innerHTML:"!",className:"intranet-notify-dialog-exclamation-point-icon"}}),BX.create("span",{props:{innerHTML:BX.util.htmlspecialchars(this.popupTexts.header)}})]}),BX.create("div",{props:{className:"intranet-notify-dialog-description"},html:BX.util.htmlspecialchars(this.popupTexts.description)}),BX.create("span",{props:{className:"intranet-notify-dialog-title-who-notify"},html:BX.message("INTRANET_NOTIFY_DIALOG_TITLE_WHO_NOTIFY")})]});this.listUserData.forEach(function(t){var i=[];if(t.img){i.push(BX.create("img",{attrs:{src:t.img}}))}e.appendChild(BX.create("div",{props:{className:"intranet-notify-dialog-user"},children:[BX.create("span",{props:{className:"intranet-notify-dialog-user-avatar"},children:[BX.create("span",{props:{className:"intranet-notify-dialog-user-avatar-inner"},children:i})]}),BX.create("span",{props:{className:"intranet-notify-dialog-user-info"},children:[BX.create("span",{html:BX.util.htmlspecialchars(t.name)})]}),BX.create("span",{props:{id:"intranet-notify-dialog-success-"+parseInt(t.id),className:"intranet-notify-dialog-success"}}),BX.create("span",{props:{id:"intranet-notify-dialog-button-"+parseInt(t.id),className:"webform-small-button intranet-notify-dialog-small-button "+"webform-small-button-blue"},attrs:{"data-id":parseInt(t.id)},html:BX.util.htmlspecialchars(this.popupTexts.sendButton)})]}))},this);t=BX.create("div",{props:{className:"intranet-notify-dialog-container"},children:[BX.create("div",{props:{className:"intranet-notify-dialog-title"},text:this.popupTexts.title}),BX.create("div",{props:{className:"intranet-notify-dialog-content"},children:[e]})]});return t}})();
//# sourceMappingURL=notify_dialog.map.js