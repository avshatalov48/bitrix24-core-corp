this.BX=this.BX||{};this.BX.Intranet=this.BX.Intranet||{};(function(e,t){"use strict";var n=function(){function e(){var n=this;var o=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};babelHelpers.classCallCheck(this,e);this.signedParameters=o.signedParameters;this.componentName=o.componentName;this.loader=null;this.container=o.contentContainer;this.userId=o.userId;this.currentPage=o.currentPage;this.menuContainer=o.menuContainer;this.changeContent(this.currentPage);if(t.Type.isDomNode(this.menuContainer)){this.menuItems=this.menuContainer.querySelectorAll("a");(this.menuItems||[]).forEach((function(e){t.Event.bind(e,"click",(function(){n.changeContent(e.getAttribute("data-action"))}))}))}BX.addCustomEvent("BX.Security.UserOtpInit:afterOtpSetup",function(e){this.showOtpConnectedComponent()}.bind(this))}babelHelpers.createClass(e,[{key:"changeContent",value:function e(t){if(!t){return}switch(t){case"auth":case"otpConnected":case"socnetEmail":var n={userId:this.userId};this.sendAction(t,n);break;case"otp":case"appPasswords":case"synchronize":case"mailingAgreement":case"sso":this.sendAction(t,{});break;case"recoveryCodes":this.showRecoveryCodesComponent();break;case"socserv":this.showSocservComponent();break}}},{key:"clearHtml",value:function e(){BX.html(this.container,"");var n=document.getElementsByClassName("ui-entity-wrap");if(n&&n[0]){t.Dom.remove(n[0])}}},{key:"sendAction",value:function e(t,n){this.clearHtml();this.loader=this.showLoader({node:this.container,loader:null,size:100});BX.ajax.runComponentAction(this.componentName,t,{signedParameters:this.signedParameters,mode:"ajax",data:n}).then(function(e){this.showComponentData(e,t)}.bind(this),function(e){this.showErrorPopup(e["errors"][0].message);this.hideLoader({loader:this.loader})}.bind(this))}},{key:"showOtpComponent",value:function e(){this.changeContent("otp")}},{key:"showOtpConnectedComponent",value:function e(){this.changeContent("otpConnected")}},{key:"showRecoveryCodesComponent",value:function e(t){if(!t){t=""}this.sendAction("recoveryCodes",{componentMode:t})}},{key:"showSocservComponent",value:function e(){this.clearHtml();var t=document.querySelector("[data-action='socserv']");if(BX.type.isDomNode(t)){var n=BX.data(t,"url");if(top.BX.SidePanel.Instance.open(n,{cacheable:false,width:840})){top.BX.addCustomEvent(top.BX.SidePanel.Instance.getSlider(n),"SidePanel.Slider:onClose",BX.proxy((function(){var e=document.querySelector("[data-action='auth']");if(BX.type.isDomNode(e)){e.click()}}),this))}}}},{key:"showComponentData",value:function e(t,n){var o=BX.prop.getArray(t,"errors",[]);if(o.length>0){this.showErrorPopup(t["errors"][0].message);return}if(!t.data){this.showErrorPopup("Unknown error");this.hideLoader({loader:this.loader});return}var a=new Promise(BX.delegate((function(e,n){if(t.data.hasOwnProperty("assets")&&t.data.assets["css"].length){BX.load(t.data.assets["css"],(function(){if(t.data.assets["js"].length){BX.load(t.data.assets["js"],(function(){if(t.data.assets["string"].length){for(var n=0;n<t.data.assets["string"].length;n++){BX.html(null,t.data.assets["string"][n])}}e()}))}}))}}),this));a.then(BX.delegate((function(){var e=BX.prop.getString(t.data,"html","");BX.html(this.container,e);var o=BX.prop.getString(BX.prop.getObject(t.data,"additionalParams",""),"pageTitle","");BX.html(BX("pagetitle"),o);top.history.pushState(null,"","?page="+n)}),this))}},{key:"showLoader",value:function e(t){var n=null;if(t.node){if(t.loader===null){n=new BX.Loader({target:t.node,size:t.hasOwnProperty("size")?t.size:40})}else{n=t.loader}n.show()}return n}},{key:"hideLoader",value:function e(n){if(n.loader!==null){n.loader.hide()}if(n.node){t.Dom.clean(n.node)}if(n.loader!==null){n.loader=null}}},{key:"showErrorPopup",value:function e(t){if(!t){return}BX.PopupWindowManager.create({id:"intranet-user-profile-error-popup",content:BX.create("div",{props:{style:"max-width: 450px"},html:BX.util.htmlspecialchars(t)}),closeIcon:true,lightShadow:true,offsetLeft:100,overlay:false,contentPadding:10}).show()}}]);return e}();e.Security=n})(this.BX.Intranet.UserProfile=this.BX.Intranet.UserProfile||{},BX);
//# sourceMappingURL=security.bundle.map.js