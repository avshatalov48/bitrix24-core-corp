(function(){BX.namespace("BX.Intranet.UserProfile.Security");BX.Intranet.UserProfile.Security={init:function(e){this.signedParameters=e.signedParameters;this.componentName=e.componentName;this.loader=null;this.container=BX("intranet-user-profile-security-content");this.userId=e.userId;this.currentPage=e.currentPage;if(this.currentPage=="auth"){this.showAuthComponent()}else if(this.currentPage=="security"){this.showOtpConnectedComponent()}else if(this.currentPage=="otp"){this.showOtpComponent()}else if(this.currentPage=="app_passwords"){this.showPasswordsComponent()}else if(this.currentPage=="synchronize"){this.showSynchronizeComponent()}else if(this.currentPage=="socnet_email"){this.showSocnetEmailComponent()}else if(this.currentPage=="recovery_codes"){this.showRecoveryCodesComponent()}else if(this.currentPage=="socserv"){this.showSocservComponent()}var t=document.querySelector("[data-role='otp']");if(BX.type.isDomNode(t)){BX.bind(t,"click",function(e){e.preventDefault();this.showOtpComponent()}.bind(this))}var o=document.querySelector("[data-role='security']");if(BX.type.isDomNode(o)){BX.bind(o,"click",function(e){e.preventDefault();this.showOtpConnectedComponent()}.bind(this))}var n=document.querySelector("[data-role='app_passwords']");if(BX.type.isDomNode(n)){BX.bind(n,"click",function(e){e.preventDefault();this.showPasswordsComponent()}.bind(this))}var s=document.querySelector("[data-role='synchronize']");if(BX.type.isDomNode(s)){BX.bind(s,"click",function(e){e.preventDefault();this.showSynchronizeComponent()}.bind(this))}var i=document.querySelector("[data-role='auth']");if(BX.type.isDomNode(i)){BX.bind(i,"click",function(e){e.preventDefault();this.showAuthComponent()}.bind(this))}var r=document.querySelector("[data-role='socnet_email']");if(BX.type.isDomNode(r)){BX.bind(r,"click",function(e){e.preventDefault();this.showSocnetEmailComponent()}.bind(this))}var a=document.querySelector("[data-role='socserv']");if(BX.type.isDomNode(a)){BX.bind(a,"click",function(e){e.preventDefault();this.showSocservComponent()}.bind(this))}BX.addCustomEvent("BX.Security.UserOtpInit:afterOtpSetup",function(e){this.showOtpConnectedComponent()}.bind(this))},clearHtml:function(){BX.html(this.container,"");var e=document.getElementsByClassName("ui-entity-wrap");if(e&&e[0]){BX.remove(e[0])}},showAuthComponent:function(){this.clearHtml();this.loader=this.showLoader({node:this.container,loader:null,size:100});BX.ajax.runComponentAction(this.componentName,"showAuth",{signedParameters:this.signedParameters,mode:"ajax",data:{userId:this.userId}}).then(function(e){this.showComponentData(e,"auth")}.bind(this),function(e){this.showErrorPopup(e["errors"][0].message);this.hideLoader({loader:this.loader})}.bind(this))},showSocnetEmailComponent:function(){this.clearHtml();this.loader=this.showLoader({node:this.container,loader:null,size:100});BX.ajax.runComponentAction(this.componentName,"showSocnetEmail",{signedParameters:this.signedParameters,mode:"ajax",data:{userId:this.userId}}).then(function(e){this.showComponentData(e,"socnet_email")}.bind(this),function(e){this.showErrorPopup(e["errors"][0].message);this.hideLoader({loader:this.loader})}.bind(this))},showOtpComponent:function(){this.clearHtml();this.loader=this.showLoader({node:this.container,loader:null,size:100});BX.ajax.runComponentAction(this.componentName,"showSecurity",{signedParameters:this.signedParameters,mode:"ajax",data:{}}).then(function(e){this.showComponentData(e,"otp")}.bind(this),function(e){this.showErrorPopup(e["errors"][0].message);this.hideLoader({loader:this.loader})}.bind(this))},showOtpConnectedComponent:function(){this.clearHtml();this.loader=this.showLoader({node:this.container,loader:null,size:100});BX.ajax.runComponentAction(this.componentName,"showOtpConnected",{signedParameters:this.signedParameters,mode:"ajax",data:{userId:this.userId}}).then(function(e){this.showComponentData(e,"security")}.bind(this),function(e){this.showErrorPopup(e["errors"][0].message);this.hideLoader({loader:this.loader})}.bind(this))},showRecoveryCodesComponent:function(e){if(!e){e=""}this.clearHtml();this.loader=this.showLoader({node:this.container,loader:null,size:100});BX.ajax.runComponentAction(this.componentName,"showRecoveryCodes",{signedParameters:this.signedParameters,mode:"ajax",data:{componentMode:e}}).then(function(e){this.showComponentData(e,"recovery_codes")}.bind(this),function(e){this.showErrorPopup(e["errors"][0].message);this.hideLoader({loader:this.loader})}.bind(this))},showPasswordsComponent:function(){this.clearHtml();this.loader=this.showLoader({node:this.container,loader:null,size:100});BX.ajax.runComponentAction(this.componentName,"showPasswords",{signedParameters:this.signedParameters,mode:"ajax",data:{}}).then(function(e){this.showComponentData(e,"app_passwords")}.bind(this),function(e){this.showErrorPopup(e["errors"][0].message);this.hideLoader({loader:this.loader})}.bind(this))},showSynchronizeComponent:function(){this.clearHtml();this.loader=this.showLoader({node:this.container,loader:null,size:100});BX.ajax.runComponentAction(this.componentName,"showSynchronize",{signedParameters:this.signedParameters,mode:"ajax",data:{}}).then(function(e){this.showComponentData(e,"synchronize")}.bind(this),function(e){this.showErrorPopup(e["errors"][0].message);this.hideLoader({loader:this.loader})}.bind(this))},showSocservComponent:function(){this.clearHtml();var e=document.querySelector("[data-role='socserv']");if(BX.type.isDomNode(e)){var t=BX.data(e,"url");if(top.BX.SidePanel.Instance.open(t,{cacheable:false,width:840})){top.BX.addCustomEvent(top.BX.SidePanel.Instance.getSlider(t),"SidePanel.Slider:onClose",BX.proxy(function(){var e=document.querySelector("[data-role='auth']");if(BX.type.isDomNode(e)){e.click()}},this))}}},showComponentData:function(e,t){var o=BX.prop.getArray(e,"errors",[]);if(o.length>0){this.showErrorPopup(e["errors"][0].message);return}if(!e.data){this.showErrorPopup("Unknown error");this.hideLoader({loader:this.loader});return}var n=new Promise(BX.delegate(function(t,o){if(e.data.hasOwnProperty("assets")&&e.data.assets["css"].length){BX.load(e.data.assets["css"],function(){if(e.data.assets["js"].length){BX.load(e.data.assets["js"],function(){if(e.data.assets["string"].length){for(var o=0;o<e.data.assets["string"].length;o++){BX.html(null,e.data.assets["string"][o])}}t()})}})}},this));n.then(BX.delegate(function(){var o=BX.prop.getString(e.data,"html","");BX.html(this.container,o);var n=BX.prop.getString(BX.prop.getObject(e.data,"additionalParams",""),"pageTitle","");BX.html(BX("pagetitle"),n);top.history.pushState(null,"","?page="+t)},this))},showLoader:function(e){var t=null;if(e.node){if(e.loader===null){t=new BX.Loader({target:e.node,size:e.hasOwnProperty("size")?e.size:40})}else{t=e.loader}t.show()}return t},hideLoader:function(e){if(e.loader!==null){e.loader.hide()}if(e.node){BX.cleanNode(e.node)}if(e.loader!==null){e.loader=null}},showErrorPopup:function(e){if(!e){return}BX.PopupWindowManager.create({id:"intranet-user-profile-error-popup",content:BX.create("div",{props:{style:"max-width: 450px"},html:e}),closeIcon:true,lightShadow:true,offsetLeft:100,overlay:false,contentPadding:10}).show()}}})();
//# sourceMappingURL=intranet.security.map.js