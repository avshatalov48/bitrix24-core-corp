(function(){"use strict";BX.namespace("BX.Intranet.Helper.Notification");BX.Intranet.Helper.Notification.Loader=function(t){this.params=t||{};this.errors=[];this.helper={};this.baseLoadScriptDelay=60*60*6;this.lsTimeParamName="intranet_helper_notification_loader_time";this.lsDelayParamName="intranet_helper_notification_loader_delay";this.init()};BX.Intranet.Helper.Notification.Loader.prototype={init:function(){this.initParams();this.defineB24Helper();this.initDelay();this.checkLoadScript()},defineB24Helper:function(){if(BX&&BX.Helper){this.helper=BX.Helper}},initDelay:function(){this.loadScriptDelayInSeconds=this.getDelayFromValue(localStorage.getItem(this.lsDelayParamName))},initParams:function(){this.timeNow=this.params.timeNow||"";this.lastCheckNotificationsTime=this.params.lastCheckNotificationsTime||"";this.currentNotificationsString=this.params.currentNotificationsString||"";this.managerScriptUrl=this.params.managerScriptUrl||"";this.maxScriptCacheTime=this.params.maxScriptCacheTime||this.baseLoadScriptDelay;if(!BX.type.isNotEmptyString(this.managerScriptUrl)){this.addError({code:"PARAMS_REQUIRED",data:{paramName:"managerScriptUrl"}})}},loadManagerScript:function(){var t=parseInt(localStorage.getItem(this.lsTimeParamName));if(isNaN(t)){t=0}var i=new Date;var e=new Date;i.setTime(t);if((e.getTime()-i.getTime())/1e3>this.loadScriptDelayInSeconds){t=e.getTime();localStorage.setItem(this.lsTimeParamName,t.toString())}BX.loadScript(BX.util.add_url_param(this.managerScriptUrl,{actual:t}))},checkLoadScript:function(){if(!this.hasErrors()){this.loadManagerScript()}},addError:function(t){this.errors.push(t)},hasErrors:function(){return this.errors.length>0},getAjaxUrl:function(){return this.helper.ajaxUrl||""},getHelpUrl:function(){return this.helper.helpUrl||""},getNotifyData:function(){return this.helper.notifyData||{}},getTimeNow:function(){return this.timeNow},getLastCheckNotificationsTime:function(){return this.lastCheckNotificationsTime},getCurrentNotificationsString:function(){return this.currentNotificationsString},getDelayFromValue:function(t){var i=parseInt(t);if(isNaN(i)){i=this.baseLoadScriptDelay}else if(i<=0||i>this.maxScriptCacheTime){i=this.baseLoadScriptDelay}return i},setDelay:function(t){localStorage.setItem(this.lsDelayParamName,this.getDelayFromValue(t).toString())}}})();