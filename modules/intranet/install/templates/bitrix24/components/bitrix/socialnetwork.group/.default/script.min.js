(function(){"use strict";BX.namespace("BX.Bitrix24");if(window["B24SGControl"]){return}window.B24SGControl=function(){this.instance=null;this.groupId=null;this.slider=false};window.B24SGControl.getInstance=function(){if(window.B24SGControl.instance==null){window.B24SGControl.instance=new B24SGControl}return window.B24SGControl.instance};window.B24SGControl.prototype={init:function(o){if(typeof o=="undefined"||typeof o.groupId=="undefined"||parseInt(o.groupId)<=0){return}this.groupId=parseInt(o.groupId);this.slider=!!o.slider;if(BX("bx-group-join-submit")){BX.bind(BX("bx-group-join-submit"),"click",BX.delegate(this.sendJoinRequest,this))}},sendJoinRequest:function(o){BX.SocialnetworkUICommon.hideError(BX("bx-group-join-error"));BX.SocialnetworkUICommon.showButtonWait(BX("bx-group-join-submit"));BX.ajax({url:BX("bx-group-join-submit").getAttribute("bx-request-url"),method:"POST",dataType:"json",data:{groupID:this.groupId,MESSAGE:BX("bx-group-join-message")?BX("bx-group-join-message").value:"",ajax_request:"Y",save:"Y",sessid:BX.bitrix_sessid()},onsuccess:function(o){BX.SocialnetworkUICommon.hideButtonWait(BX("bx-group-join-submit"));if(BX.type.isNotEmptyString(o.MESSAGE)&&o.MESSAGE=="SUCCESS"&&BX.type.isNotEmptyString(o.URL)){BX.addClass(BX("bx-group-join-form"),"sonet-group-user-request-form-invisible");BX.onCustomEvent(window.top,"sonetGroupEvent",[{code:"afterJoinRequestSend",data:{groupId:this.groupId}}]);if(this.slider){location.href=BX.Uri.addParam(o.URL,{IFRAME:"Y"})}else{top.location.href=o.URL}}else if(typeof o.MESSAGE!="undefined"&&o.MESSAGE=="ERROR"&&typeof o.ERROR_MESSAGE!="undefined"&&o.ERROR_MESSAGE.length>0){BX.SocialnetworkUICommon.showError(o.ERROR_MESSAGE,BX("bx-group-join-error"))}}.bind(this),onfailure:function(){BX.SocialnetworkUICommon.showError(BX.message("SONET_C6_T_AJAX_ERROR"),BX("bx-group-join-error"));BX.SocialnetworkUICommon.hideButtonWait(BX("bx-group-join-submit"))}.bind(this)})}}})();
//# sourceMappingURL=script.map.js