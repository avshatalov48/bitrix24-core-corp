this.BX=this.BX||{};this.BX.Intranet=this.BX.Intranet||{};(function(e,t){"use strict";var n=function(){function e(t){babelHelpers.classCallCheck(this,e);this.parent=t}babelHelpers.createClass(e,[{key:"showSelfItemPopup",value:function e(t,n){var i=false;if(babelHelpers.typeof(n)==="object"&&n){i=true}var s=BX.create("form",{attrs:{name:"menuAddToFavoriteForm"},children:[BX.create("label",{attrs:{for:"menuPageToFavoriteName",className:"menu-form-label"},html:BX.message("MENU_ITEM_NAME")}),BX.create("input",{attrs:{value:i?n.text:"",name:"menuPageToFavoriteName",type:"text",className:"menu-form-input"}}),BX.create("br"),BX.create("br"),BX.create("label",{attrs:{for:"menuPageToFavoriteLink",className:"menu-form-label"},html:BX.message("MENU_ITEM_LINK")}),BX.create("input",{attrs:{value:i?n.link:"",name:"menuPageToFavoriteLink",type:"text",className:"menu-form-input"}}),BX.create("br"),BX.create("br"),BX.create("input",{attrs:{value:"",name:"menuOpenInNewPage",type:"checkbox",checked:!i||n.openInNewPage?"checked":"",id:"menuOpenInNewPage"}}),BX.create("label",{attrs:{for:"menuOpenInNewPage",className:"menu-form-label"},html:BX.message("MENU_OPEN_IN_NEW_PAGE")})]});if(i){s.appendChild(BX.create("input",{attrs:{name:"menuItemId",type:"hidden",value:n.id}}))}var a;BX.PopupWindowManager.create("menu-self-item-popup",t,{closeIcon:true,offsetTop:1,offsetLeft:20,lightShadow:true,draggable:{restrict:true},closeByEsc:true,titleBar:i?BX.message("MENU_EDIT_SELF_PAGE"):BX.message("MENU_ADD_SELF_PAGE"),content:s,buttons:[a=new BX.PopupWindowButton({text:i?BX.message("MENU_SAVE_BUTTON"):BX.message("MENU_ADD_BUTTON"),className:"popup-window-button-create",events:{click:BX.proxy(function(){var e=document.forms["menuAddToFavoriteForm"];var t=e.elements["menuPageToFavoriteName"];var s=e.elements["menuPageToFavoriteLink"];var o=e.elements["menuOpenInNewPage"].checked;var r=BX.util.trim(t.value);var u=this.parent.refineUrl(s.value);if(!r||!u){if(!u){BX.addClass(s,"menu-form-input-error");s.focus()}if(!r){BX.addClass(t,"menu-form-input-error");t.focus()}}else{BX.addClass(a.buttonNode,"popup-window-button-wait");BX.removeClass(t,"menu-form-input-error");BX.removeClass(s,"menu-form-input-error");var l={text:r,link:u,openInNewPage:o?"Y":"N"};if(i){l.id=n.id}this.saveSelfItem(i?"edit":"add",l)}},this)}}),new BX.PopupWindowButtonLink({text:BX.message("MENU_CANCEL"),className:"popup-window-button-link-cancel",events:{click:function e(){this.popupWindow.close()}}})],events:{onPopupClose:function e(){BX.PopupWindowManager.getCurrentPopup().destroy()},onPopupShow:function e(){var t=document.forms["menuAddToFavoriteForm"];var n=t.elements["menuPageToFavoriteName"];n&&setTimeout(function(){n.focus()},100)}}}).show()}},{key:"saveSelfItem",value:function e(t,n){var i=this;BX.ajax.runAction("intranet.leftmenu.".concat(t==="edit"?"update":"add","SelfItem"),{data:{itemData:n},analyticsLabel:{type:"self"}}).then(function(e){var s={text:n.text,link:n.link,type:"self",openInNewPage:n.openInNewPage==="Y"?"Y":"N"};if(t==="add"&&e.data.hasOwnProperty("itemId")){s.id=e.data.itemId;i.parent.generateItemHtml(s)}else if(t==="edit"){s.id=n.id;i.parent.updateItemHtml(s)}BX.PopupWindowManager.getCurrentPopup().destroy()},function(e){i.parent.showConfirmWindow({alertMode:true,titleBar:BX.message("MENU_ERROR_OCCURRED"),content:e.errors[0].message})})}},{key:"deleteSelfItem",value:function e(t){var n=this;var i=BX("bx_left_menu_"+t);if(!BX.type.isDomNode(i))return;if(i.getAttribute("data-delete-perm")==="A"){this.parent.allItemObj.deleteItemFromAll(t)}BX.ajax.runAction("intranet.leftmenu.deleteSelfItem",{data:{menuItemId:t}}).then(function(e){BX.remove(i)},function(e){n.parent.showError(i)})}}]);return e}();var i=function(){function e(t){babelHelpers.classCallCheck(this,e);this.parent=t}babelHelpers.createClass(e,[{key:"addStandardItem",value:function e(t){var n=this;var i=t.itemInfo;var s=t.startX;var a=t.startY;var o=!t.context||t.context===top.window;var r=false;if(babelHelpers.typeof(i)!=="object"){r=true;this.parent.checkCurrentPageInTopMenu();if(this.parent.isCurrentPageStandard&&BX.type.isDomNode(this.parent.topMenuSelectedNode)){var u=this.parent.topMenuSelectedNode.getBoundingClientRect();s=u.left;a=u.top;i={id:this.parent.topItemSelectedObj.DATA_ID,text:this.parent.topItemSelectedObj.TEXT,link:BX.type.isNotEmptyString(this.parent.currentPagePath)?this.parent.currentPagePath:this.parent.topItemSelectedObj.URL,counterId:this.parent.topItemSelectedObj.COUNTER_ID,counterValue:this.parent.topItemSelectedObj.COUNTER,isStandardItem:true,subLink:this.parent.topItemSelectedObj.SUB_LINK}}else{var l=BX.type.isNotEmptyString(t.pageTitle)?t.pageTitle:document.getElementById("pagetitle").innerText;var m="";if(BX.type.isNotEmptyString(t.pageLink)){m=t.pageLink}else{m=BX.type.isNotEmptyString(this.parent.currentPagePath)?this.parent.currentPagePath:document.location.pathname+document.location.search}i={text:l,link:m,isStandardItem:false}}}if(!s||!a){var d=BX("pagetitle").getBoundingClientRect();s=d.left;a=d.top}BX.ajax.runAction("intranet.leftmenu.addStandartItem",{data:{itemData:i}}).then(function(e){if(e.data.hasOwnProperty("itemId")){i.id=e.data.itemId;BX.onCustomEvent("BX.Bitrix24.LeftMenuClass:onMenuItemAdded",[i,n]);n.animateTopItemToLeft(i,s,a,o);n.onStandardItemChangedSuccess({isCurrentPage:r,isActive:true,context:t.context});n.parent.isCurrentPageInLeftMenu=true}},function(e){n.parent.showConfirmWindow({alertMode:true,titleBar:BX.message("MENU_ERROR_OCCURRED"),content:e.errors[0].message})})}},{key:"deleteStandardItem",value:function e(t){var n=this;var i=t.itemId;var s=!t.context||t.context===top.window;var a={};this.parent.checkCurrentPageInTopMenu();if(i&&BX.type.isDomNode(BX("bx_left_menu_"+i))){a={id:i}}else if(this.parent.isCurrentPageStandard&&this.parent.topItemSelectedObj.DATA_ID){a={id:this.parent.topItemSelectedObj.DATA_ID}}else{a={link:BX.type.isNotEmptyString(t.pageLink)?t.pageLink:document.location.pathname+document.location.search}}BX.ajax.runAction("intranet.leftmenu.deleteStandartItem",{data:{itemData:a}}).then(function(e){if(e.data.hasOwnProperty("itemId")){BX.onCustomEvent("BX.Bitrix24.LeftMenuClass:onMenuItemDeleted",[e.data,n]);var a=BX("bx_left_menu_"+e.data.itemId);if(!BX.type.isDomNode(a))return;if(a.getAttribute("data-delete-perm")==="A"){n.parent.allItemObj.deleteItemFromAll(e.data.itemId)}n.onStandardItemChangedSuccess({isCurrentPage:!i,isActive:false,context:t.context});n.animateTopItemFromLeft("bx_left_menu_"+e.data.itemId,s);n.isCurrentPageInLeftMenu=false}},function(e){n.parent.showConfirmWindow({alertMode:true,titleBar:BX.message("MENU_ERROR_OCCURRED"),content:e.errors[0].message})})}},{key:"updateStandardItem",value:function e(t){var n=this;BX.ajax.runAction("intranet.leftmenu.updateStandartItem",{data:{itemText:t.text,itemId:t.id}}).then(function(e){n.parent.updateItemHtml(t);BX.PopupWindowManager.getCurrentPopup().destroy()},function(e){n.parent.showConfirmWindow({alertMode:true,titleBar:BX.message("MENU_ERROR_OCCURRED"),content:e.errors[0].message})})}},{key:"showStandardEditItemPopup",value:function e(t,n){var i=false;if(babelHelpers.typeof(n)==="object"&&n){i=true}var s=BX.create("form",{attrs:{name:"menuAddToFavoriteForm"},children:[BX.create("label",{attrs:{for:"menuPageToFavoriteName",className:"menu-form-label"},html:BX.message("MENU_ITEM_NAME")}),BX.create("input",{attrs:{value:i?n.text:"",name:"menuPageToFavoriteName",type:"text",className:"menu-form-input"}}),BX.create("input",{attrs:{name:"menuItemId",type:"hidden",value:n.id}})]});BX.PopupWindowManager.create("menu-standard-item-popup-edit",t,{closeIcon:true,offsetTop:1,lightShadow:true,draggable:{restrict:true},closeByEsc:true,titleBar:BX.message("MENU_RENAME_ITEM"),content:s,buttons:[new BX.PopupWindowButton({text:BX.message("MENU_SAVE_BUTTON"),className:"popup-window-button-create",events:{click:BX.proxy(function(){var e=document.forms["menuAddToFavoriteForm"];var t=e.elements["menuPageToFavoriteName"];var i=BX.util.trim(t.value);if(!i){BX.addClass(t,"menu-form-input-error");t.focus()}else{BX.removeClass(t,"menu-form-input-error");var s={text:i,id:n.id};this.updateStandardItem(s)}},this)}}),new BX.PopupWindowButtonLink({text:BX.message("MENU_CANCEL"),className:"popup-window-button-link-cancel",events:{click:function e(){BX.PopupWindowManager.getCurrentPopup().destroy()}}})],events:{onPopupClose:function e(){BX.PopupWindowManager.getCurrentPopup().destroy()}}}).show()}},{key:"onStandardItemChangedSuccess",value:function e(t){if(t.isCurrentPage){BX.onCustomEvent("BX.Bitrix24.LeftMenuClass:onStandardItemChangedSuccess",[{isActive:t.isActive,context:t.context}])}}},{key:"animateTopItemToLeft",value:function e(t,n,i,s){if(babelHelpers.typeof(t)!=="object")return;var a=BX.create("div",{text:t.text,attrs:{style:"position: absolute; z-index: 1000;"}});a.style.top=i+25+"px";document.body.appendChild(a);var o=this.parent.menuItemsBlock.getBoundingClientRect().bottom;if(this.parent.areMoreItemsShowed()){o-=BX("left-menu-hidden-items-list").offsetHeight}if(!s){BX.remove(a);t.type="standard";this.isCurrentPageInLeftMenu=true;this.parent.generateItemHtml(t);this.parent.saveItemsSort({type:"standard"});return}new BX.easing({duration:500,start:{left:n},finish:{left:30},transition:BX.easing.makeEaseOut(BX.easing.transitions.quart),step:function e(t){a.style.left=t.left+"px"},complete:BX.proxy(function(){new BX.easing({duration:500,start:{top:i+25},finish:{top:o},transition:BX.easing.makeEaseOut(BX.easing.transitions.quart),step:function e(t){a.style.top=t.top+"px"},complete:BX.proxy(function(){BX.remove(a);t.type="standard";this.isCurrentPageInLeftMenu=true;this.parent.generateItemHtml(t);this.parent.saveItemsSort({type:"standard"})},this)}).animate()},this)}).animate()}},{key:"animateTopItemFromLeft",value:function e(t,n){if(!BX.type.isDomNode(BX(t))){return}if(!n){BX.remove(BX(t));this.isCurrentPageInLeftMenu=false;this.parent.saveItemsSort({type:"standard"});return}new BX.easing({duration:700,start:{left:BX(t).offsetLeft,opacity:1},finish:{left:400,opacity:0},transition:BX.easing.makeEaseOut(BX.easing.transitions.quart),step:function e(n){BX(t).style.paddingLeft=n.left+"px";BX(t).style.opacity=n.opacity},complete:BX.proxy(function(){BX.remove(BX(t));this.parent.isCurrentPageInLeftMenu=false;this.parent.saveItemsSort({type:"standard"})},this)}).animate()}}]);return e}();var s=function(){function e(t){babelHelpers.classCallCheck(this,e);this.parent=t}babelHelpers.createClass(e,[{key:"addItemToAll",value:function e(t){var n=this;var i=BX("bx_left_menu_"+t);if(!BX.type.isDomNode(i))return;var s=i.getAttribute("data-link"),a=i.querySelector("[data-role='item-text']"),o=a.innerText,r=i.getAttribute("data-counter-id"),u=BX.findChild(i,{tagName:"a"},true,false),l=BX.type.isDomNode(u)&&u.hasAttribute("target")&&u.getAttribute("target")==="_blank";BX.ajax.runAction("intranet.leftmenu.addItemToAll",{data:{itemInfo:{id:t,link:s,text:o,counterId:r,openInNewPage:l?"Y":"N"}}}).then(function(e){i.setAttribute("data-delete-perm","A");n.parent.showMessage(i,BX.message("MENU_ITEM_WAS_ADDED_TO_ALL"))},function(e){n.parent.showError(i)})}},{key:"deleteItemFromAll",value:function e(t){var n=this;var i=BX("bx_left_menu_"+t);if(!BX.type.isDomNode(i))return;BX.ajax.runAction("intranet.leftmenu.deleteItemFromAll",{data:{menu_item_id:t}}).then(function(e){i.setAttribute("data-delete-perm","Y");n.parent.showMessage(i,BX.message("MENU_ITEM_WAS_DELETED_FROM_ALL"))},function(e){n.parent.showError(i)})}},{key:"deleteCustomItemFromAll",value:function e(t){var n=this;var i=BX("bx_left_menu_"+t);if(!BX.type.isDomNode(i))return;var s=i.getAttribute("data-type");if(s!=="custom")return;BX.ajax.runAction("intranet.leftmenu.deleteCustomItemFromAll",{data:{menu_item_id:t}}).then(function(e){BX.remove(i)},function(e){n.parent.showError(i)})}}]);return e}();var a=function(){function e(t){babelHelpers.classCallCheck(this,e);this.parent=t}babelHelpers.createClass(e,[{key:"initPreset",value:function e(){var t=BX("left-menu-preset-popup");if(!BX.type.isDomNode(t))return;this.presetItems=t.getElementsByClassName("js-left-menu-preset-item");if(babelHelpers.typeof(this.presetItems)=="object"){for(var n=0;n<this.presetItems.length;n++){BX.bind(this.presetItems[n],"click",BX.proxy(function(){this.selectPreset(BX.proxy_context)},this))}}}},{key:"selectPreset",value:function e(t){for(var n=0;n<this.presetItems.length;n++){BX.removeClass(this.presetItems[n],"left-menu-popup-selected")}if(BX.type.isDomNode(t)){BX.addClass(t,"left-menu-popup-selected")}}},{key:"getCurrentPreset",value:function e(){var t=document.forms["left-menu-preset-form"];if(!t){return""}var n=t.elements["presetType"];for(var i=0;i<n.length;i++){if(n[i].checked){return n[i].value}}return""}},{key:"showPresetPopupFunction",value:function e(t){BX.ready(function(){var e=null;BX.PopupWindowManager.create("menu-preset-popup",null,{closeIcon:false,offsetTop:1,overlay:true,lightShadow:true,contentColor:"white",draggable:{restrict:true},closeByEsc:false,content:BX("left-menu-preset-popup"),buttons:[e=new BX.PopupWindowButton({text:BX.message("MENU_CONFIRM_BUTTON"),className:"popup-window-button-create",events:{click:BX.proxy(function(){if(BX.hasClass(e.buttonNode,"popup-window-button-wait")){return}BX.addClass(e.buttonNode,"popup-window-button-wait");var n=document.forms["left-menu-preset-form"];var i="";if(n){var s=n.elements["presetType"];for(var a=0;a<s.length;a++){if(s[a].checked){i=s[a].value;break}}}BX.ajax.runAction("intranet.leftmenu.setPreset",{data:{preset:i,mode:t==="global"?"global":"personal"},analyticsLabel:{preset:this.getCurrentPreset(),first:t==="global"?"y":""}}).then(function(e){if(e.data.hasOwnProperty("url")){document.location.href=e.data.url}else{document.location.reload()}},function(){document.location.reload()})},this)}}),new BX.PopupWindowButton({text:BX.message("MENU_DELAY_BUTTON"),events:{click:BX.proxy(function(){BX.ajax.runAction("intranet.leftmenu.delaySetPreset",{data:{},analyticsLabel:{preset:this.getCurrentPreset(),first:t==="global"?"y":""}});BX.proxy_context.popupWindow.close();if(this.showImportConfiguration){this.parent.showImportConfigurationSlider()}},this)}})]}).show();this.initPreset()}.bind(this))}},{key:"showCustomPresetPopup",value:function e(){var t=BX.create("form",{attrs:{id:"customPresetForm",style:"min-width: 350px"},children:[BX.create("div",{attrs:{style:"margin: 15px 0 15px 9px;"},children:[BX.create("input",{attrs:{type:"radio",name:"customPresetSettings",id:"customPresetCurrentUser",value:"currentUser"}}),BX.create("label",{attrs:{for:"customPresetCurrentUser"},html:BX.message("MENU_CUSTOM_PRESET_CURRENT_USER")})]}),BX.create("div",{attrs:{style:"margin: 0 0 38px 9px;"},children:[BX.create("input",{attrs:{type:"radio",name:"customPresetSettings",id:"customPresetNewUser",value:"newUser",checked:"checked"}}),BX.create("label",{attrs:{for:"customPresetNewUser"},html:BX.message("MENU_CUSTOM_PRESET_NEW_USER")})]}),BX.create("hr",{attrs:{style:"background-color: #edeef0; border: none; color:  #edeef0; height: 1px;"}})]});var n=[],i=[],s=[],a="";var o=BX.findChildren(this.parent.menuContainer,{className:"menu-item-block"},true);for(var r=0;r<o.length;r++){if(r==0){a=o[r].getAttribute("data-link")}if(o[r].getAttribute("data-status")=="show"){n.push(o[r].getAttribute("data-id"))}else if(o[r].getAttribute("data-status")=="hide"){i.push(o[r].getAttribute("data-id"))}if(o[r].getAttribute("data-type")=="self"||o[r].getAttribute("data-type")=="standard"||o[r].getAttribute("data-type")=="custom"){var u=o[r].querySelector("[data-role='item-text']");var l={ID:o[r].getAttribute("data-id"),LINK:o[r].getAttribute("data-link"),TEXT:BX.util.htmlspecialcharsback(u.innerHTML)};if(o[r].getAttribute("data-new-page")=="Y"){l.NEW_PAGE="Y"}s.push(l)}}this.menuItemsCustomSort={show:n,hide:i};var m;BX.PopupWindowManager.create("menu-custom-preset-popup",null,{closeIcon:true,offsetTop:1,overlay:true,contentColor:"white",contentNoPaddings:true,lightShadow:true,draggable:{restrict:true},closeByEsc:true,titleBar:BX.message("MENU_CUSTOM_PRESET_POPUP_TITLE"),content:t,buttons:[m=new BX.PopupWindowButton({text:BX.message("MENU_SAVE_BUTTON"),className:"popup-window-button-create",events:{click:BX.proxy(function(){var e=this;if(BX.hasClass(m.buttonNode,"popup-window-button-wait")){return}BX.addClass(m.buttonNode,"popup-window-button-wait");var t=BX("customPresetForm");if(BX.type.isDomNode(t)){var n=t.elements["customPresetSettings"].value}BX.ajax.runAction("intranet.leftmenu.saveCustomPreset",{data:{userApply:n,itemsSort:this.menuItemsCustomSort,customItems:s,firstItemLink:a},analyticsLabel:{preset:"customPreset"}}).then(function(t){BX.removeClass(m.buttonNode,"popup-window-button-wait");BX.PopupWindowManager._currentPopup.close();e.parent.customPresetExists=true;BX.PopupWindowManager.create("menu-custom-preset-success-popup",null,{closeIcon:true,contentColor:"white",titleBar:BX.message("MENU_CUSTOM_PRESET_POPUP_TITLE"),content:BX.message("MENU_CUSTOM_PRESET_SUCCESS")}).show()},function(e){})},this),close:function e(){this.popupWindow.destroy()}}}),new BX.PopupWindowButton({text:BX.message("MENU_CANCEL"),className:"popup-window-button-link popup-window-button-link-cancel",events:{click:function e(){this.popupWindow.close()}}})]}).show()}}]);return e}();var o=function(){function e(t,n){babelHelpers.classCallCheck(this,e);this.parent=t;this.allCountersInMenu={};this.livefeedCounter={decrementStack:0,value:0};this.hiddenCounters=n.hiddenCounters||[];this.allCounters=n.allCounters||{}}babelHelpers.createClass(e,[{key:"updateCounters",value:function e(t,n){n=n!==false;var i=0;for(var s in t){if(!t.hasOwnProperty(s)){continue}this.allCounters[s]=t[s];var a=BX(s==="**"?"menu-counter-live-feed":"menu-counter-"+s.toLowerCase(),true);if(a){if(s==="**"){this.livefeedCounter.value=t[s];if(t[s]<=0){this.livefeedCounter.decrementStack=0}i=this.livefeedCounter.value-this.livefeedCounter.decrementStack}else{i=t[s]}this.allCountersInMenu[s]=i;if(i>0){a.innerHTML=i>99?"99+":i;BX.addClass(a.parentNode.parentNode.parentNode,"menu-item-with-index")}else{BX.removeClass(a.parentNode.parentNode.parentNode,"menu-item-with-index");if(i<0){var o=BX("menu-counter-warning-"+s.toLowerCase());if(o){o.style.display="inline-block"}}}if(n){BX.localStorage.set("lmc-"+s,t[s],5)}}}var r=0;for(var u=0,l=this.hiddenCounters.length;u<l;u++){if(this.allCounters[this.hiddenCounters[u]]){r+=+this.allCounters[this.hiddenCounters[u]]}}if(BX.type.isDomNode(BX("menu-hidden-counter"))){if(r>0){BX.removeClass(BX("menu-hidden-counter"),"menu-hidden-counter")}else{BX.addClass(BX("menu-hidden-counter"),"menu-hidden-counter")}BX("menu-hidden-counter").innerHTML=r>99?"99+":r}this.updateDesktopCounter()}},{key:"updateDesktopCounter",value:function e(){if(typeof BXIM==="undefined"){return}var t=0;for(var n in this.allCountersInMenu){if(n!=="im-message"){t+=parseInt(this.allCountersInMenu[n])}}if(t<0){t=0}else if(t>99){t="99"}BXIM.desktop.setBrowserIconBadge(t)}},{key:"decrementCounter",value:function e(t,n){if(!t)return;n=parseInt(n);if(t.id=="menu-counter-live-feed"){this.livefeedCounter.decrementStack+=n;var i=this.livefeedCounter.value-this.livefeedCounter.decrementStack;if(i>0){t.innerHTML=i}else{BX.removeClass(t.parentNode.parentNode.parentNode,"menu-item-with-index")}}}},{key:"recountHiddenCounters",value:function e(){var t=0;var n=BX.findChildren(BX("left-menu-hidden-items-list"),{className:"menu-item-block"},true);this.hiddenCounters=[];if(n){for(var i=0,s=n.length;i<s;i++){var a=n[i].getAttribute("data-counter-id");this.hiddenCounters.push(a);if(this.allCounters[a]){t+=Number(this.allCounters[a])}}}if(t>0){BX.removeClass(BX("menu-hidden-counter"),"menu-hidden-counter")}else{BX.addClass(BX("menu-hidden-counter"),"menu-hidden-counter")}BX("menu-hidden-counter").innerHTML=t>99?"99+":t}}]);return e}();var r=function(){function e(t){babelHelpers.classCallCheck(this,e);this.parent=t}babelHelpers.createClass(e,[{key:"showItemWarning",value:function e(t){t=BX.type.isPlainObject(t)?t:{};var n=BX.type.isNotEmptyString(t.itemId)?t.itemId:"";var i=BX("bx_left_menu_"+n);if(!BX.type.isDomNode(i)){return}this.removeItemWarning(n);var s=BX.create("a",{props:{className:"menu-post-warn-icon"},attrs:{title:BX.type.isNotEmptyString(t.title)?t.title:""},events:BX.type.isNotEmptyObject(t.events)?t.events:{}});var a=i.querySelector(".menu-item-link");if(a){BX.addClass(i,"menu-item-warning-state");a.appendChild(s)}}},{key:"removeItemWarning",value:function e(t){var n=BX("bx_left_menu_"+t);if(!BX.type.isDomNode(n)){return}var i=n.querySelector(".menu-post-warn-icon");if(i){BX.remove(i)}BX.removeClass(n,"menu-item-warning-state")}}]);return e}();var u=t.Reflection.namespace("BX.Intranet");var l=function(){function e(t){babelHelpers.classCallCheck(this,e);t=babelHelpers.typeof(t)==="object"?t:{};this.ajaxPath=t.ajaxPath||null;this.isAdmin=t.isAdmin==="Y";this.isBitrix24=t.isBitrix24==="Y";this.siteId=t.siteId||null;this.siteDir=t.siteDir||null;this.isExtranet=t.isExtranet==="Y";this.isCompositeMode=t.isCompositeMode===true;this.isCollapsedMode=t.isCollapsedMode===true;this.activeItemsId=[];this.isCurrentPageInLeftMenu=false;this.currentPagePath=null;this.menuSelectedNode=null;this.showPresetPopup=t.showPresetPopup==="Y";this.showImportConfiguration=t.showImportConfiguration==="Y";this.urlImportConfiguration=t.urlImportConfiguration||"";this.isCustomPresetAvailable=t.isCustomPresetAvailable==="Y";this.customPresetExists=t.customPresetExists==="Y";this.isCurrentPageStandard=false;this.topMenuSelectedNode=null;this.topItemSelectedObj=null;this.isPublicConverted=t.isPublicConverted==="Y";this.lastScrollOffset=0;this.logoMaskNeeded=null;this.islogoMaskMode=false;this.isScrollMode=false;this.scrollModeThreshold=20;this.menuContainer=document.getElementById("menu-items-block");if(!this.menuContainer){return false}this.templateHeaderHeight=null;this.menuHeader=this.menuContainer.querySelector(".menu-items-header");this.menuBody=this.menuContainer.querySelector(".menu-items-body");this.menuMoreButton=this.menuContainer.querySelector(".menu-favorites-more-btn");this.menuItemsBlock=this.menuContainer.querySelector(".menu-items");this.inviteEmployeesBox=this.menuContainer.querySelector(".menu-invite-employees");this.licenseBox=this.menuContainer.querySelector(".menu-license-all-container");this.settingsBox=this.menuContainer.querySelector(".menu-settings-btn");this.settingsIconBox=this.settingsBox.querySelector(".menu-settings-icon-box");this.settingsBtnText=this.settingsBox.querySelector(".menu-settings-btn-text");this.settingsSaveBtn=this.menuContainer.querySelector(".menu-settings-save-btn");this.timeout={};this.highlight(document.location.pathname+document.location.search);this.makeTextIcons();this.handleMenuItemMouseEnter=this.handleMenuItemMouseEnter.bind(this);this.handleMenuItemMouseClick=this.handleMenuItemMouseClick.bind(this);this.templateHeaderHeight=null;this.fixedAdminPanelHeight=0;this.adminPanel=BX("bx-panel");this.adminPanelHeight=null;if(this.adminPanel){var r=BX.getClass("BX.admin.panel.state");if(r&&r.fixed){this.fixedAdminPanelHeight=this.getAdminPanelHeight()}BX.addCustomEvent("onTopPanelCollapse",this.handleAdminPanelCollapse.bind(this));BX.addCustomEvent("onTopPanelFix",this.handleAdminPanelFix.bind(this));this.adjustAdminPanel()}document.addEventListener("scroll",this.handleDocumentScroll.bind(this));this.slidingModeTimeoutId=null;BX.bind(this.menuContainer,"dblclick",this.handleMenuDoubleClick.bind(this));BX.bind(this.menuContainer,"mouseenter",this.handleMenuMouseEnter.bind(this));BX.bind(this.menuContainer,"mouseleave",this.handleMenuMouseLeave.bind(this));BX.bind(this.menuContainer,"transitionend",this.handleSlidingTransitionEnd.bind(this));this.isMenuMouseEnterBlocked=false;this.isMenuMouseLeaveBlocked=false;this.mainTable=document.querySelector(".bx-layout-table");this.header=document.querySelector("#header");this.headerBurger=this.header.querySelector(".menu-switcher");this.headerLogo=this.header.querySelector(".logo");this.headerLogoBlock=this.header.querySelector(".header-logo-block");this.headerSettings=this.header.querySelector(".header-logo-block-settings");this.menuHeaderLogo=this.menuHeader.querySelector(".logo");this.menuHeaderBurger=this.menuHeader.querySelector(".menu-switcher");this.menuHeaderTitle=this.menuHeader.querySelector(".menu-items-header-title");if(this.headerSettings){BX.bind(this.headerLogoBlock,"mouseenter",this.handleHeaderLogoMouserEnter.bind(this));BX.bind(this.headerLogoBlock,"mouseleave",this.handleHeaderLogoMouserLeave.bind(this));BX.bind(this.menuHeader,"mouseenter",this.handleHeaderLogoMouserEnter.bind(this));BX.bind(this.menuHeader,"mouseleave",this.handleHeaderLogoMouserLeave.bind(this))}BX.bind(this.menuHeaderBurger,"click",this.handleBurgerClick.bind(this));BX.bind(this.menuHeaderTitle,"click",this.handleBurgerClick.bind(this,true));this.siteMapItem=this.menuContainer.querySelector(".menu-sitemap-btn");if(this.siteMapItem){BX.bind(this.siteMapItem,"click",this.handleSiteMapClick.bind(this));BX.bind(this.siteMapItem,"click",this.handleMenuItemMouseClick);BX.bind(this.siteMapItem,"mouseenter",this.handleMenuItemMouseEnter)}this.upButton=this.menuContainer.querySelector(".menu-btn-arrow-up");BX.bind(this.upButton,"click",this.handleUpButtonClick.bind(this));BX.bind(this.upButton,"mouseenter",this.handleUpButtonMouseEnter.bind(this));BX.bind(this.upButton,"mouseleave",this.handleUpButtonMouseLeave.bind(this));BX.bind(BX("left-menu-hidden-separator"),"click",BX.proxy(this.showHideMoreItems,this));BX.bind(this.menuMoreButton,"click",BX.proxy(this.showHideMoreItems,this));BX.bind(this.settingsBox,"mouseenter",this.handleMenuItemMouseEnter);BX.bind(this.settingsBox,"click",this.showSettingsPopup.bind(this));BX.bind(this.settingsBox,"click",this.handleMenuItemMouseClick);BX.bind(this.settingsSaveBtn,"click",function(){this.applyEditMode()}.bind(this));if(this.inviteEmployeesBox){BX.bind(this.inviteEmployeesBox,"mouseenter",this.handleMenuItemMouseEnter)}if(this.licenseBox){BX.bind(this.licenseBox,"mouseenter",this.handleMenuItemMouseEnter)}jsDD.Enable();if(BX.type.isDomNode(this.menuItemsBlock)){var u=this.menuItemsBlock.getElementsByClassName("menu-item-block");for(var l=0;l<u.length;l++){u[l].onbxdragstart=BX.proxy(this.menuItemDragStart,this);u[l].onbxdrag=BX.proxy(this.menuItemDragMove,this);u[l].onbxdragstop=BX.proxy(this.menuItemDragStop,this);u[l].onbxdraghover=BX.proxy(this.menuItemDragHover,this);jsDD.registerDest(u[l],100);jsDD.registerObject(u[l]);BX.bind(u[l],"mouseenter",this.handleMenuItemMouseEnter);BX.bind(u[l],"click",this.handleMenuItemMouseClick)}}this.selfItemObj=new n(this);this.standartItemObj=new i(this);this.allItemObj=new s(this);this.presetObj=new a(this);this.countersObj=new o(this,{allCounters:t.allCounters,hiddenCounters:t.hiddenCounters});BX.addCustomEvent("BX.Bitrix24.GroupPanel:onOpen",this.handleGroupPanelOpen.bind(this));BX.addCustomEvent("BX.Bitrix24.GroupPanel:onClose",this.handleGroupPanelClose.bind(this));BX.addCustomEvent("BX.Main.InterfaceButtons:onFirstItemChange",BX.proxy(function(e,t){this.onTopMenuFirstItemChange(e,t)},this));BX.addCustomEvent("BX.Main.InterfaceButtons:onHideLastVisibleItem",BX.proxy(function(e){this.showMessage(e,BX.message("MENU_TOP_ITEM_LAST_HIDDEN"))},this));BX.addCustomEvent("BX.Main.InterfaceButtons:onBeforeCreateEditMenu",function(e,t,n){var i=BX.type.isDomNode(BX("bx_left_menu_"+t.DATA_ID));e.addMenuItem({text:BX.message(i?"MENU_DELETE_FROM_LEFT_MENU":"MENU_ADD_TO_LEFT_MENU"),onclick:function(n,s){var a={id:t.DATA_ID,text:BX.util.htmlspecialcharsback(t.TEXT),subLink:t.SUB_LINK,counterId:t.COUNTER_ID,counterValue:t.COUNTER};var o=document.createElement("a");o.href=t.URL;a.link=BX.util.htmlspecialcharsback(o.pathname+o.search);a.link=a.link[0]!=="/"?"/"+a.link:a.link;if(i){this.standartItemObj.deleteStandardItem({itemId:t.DATA_ID})}else{var r="",u="";if(BX.type.isDomNode(t.NODE)){var l=t.NODE.getBoundingClientRect();r=l.left;u=l.top}this.standartItemObj.addStandardItem({itemInfo:a,startX:r,startY:u})}BX.PopupMenu.destroy(e.id)}.bind(this)})}.bind(this));top.BX.addCustomEvent("UI.Toolbar:onRequestMenuItemData",function(e){this.onRequestMenuItemData(e)}.bind(this));BX.addCustomEvent("UI.Toolbar:onStarClick",function(e){this.onToolbarStarClick(e)}.bind(this));BX.addCustomEvent("BX.Main.InterfaceButtons:onBeforeResetMenu",function(e){e.push(function(){var e=new BX.Promise;BX.ajax.runAction("intranet.leftmenu.clearCache",{data:{}}).then(function(t){e.fulfill()},function(t){e.reject("Error: "+t.errors[0].message)});return e}.bind(this))}.bind(this));if(this.showPresetPopup){this.presetObj.showPresetPopupFunction("global")}else{if(this.showImportConfiguration){this.showImportConfigurationSlider()}}this.menuSelectedNode=BX.findChild(this.menuContainer,{className:"menu-item-active"},true,false);if(BX.type.isDomNode(this.menuSelectedNode)){var m=this.menuSelectedNode.getAttribute("data-link")}var d=document.location.pathname;var c=document.location.pathname+document.location.search;if(m===d||m===c){this.isCurrentPageInLeftMenu=true}this.handleDocumentScroll();return true}babelHelpers.createClass(e,[{key:"isEditMode",value:function e(){return BX.hasClass(this.menuContainer,"menu-favorites-editable")}},{key:"isCollapsed",value:function e(){return this.isCollapsedMode}},{key:"switchToEditMode",value:function e(){if(this.isEditMode()){return}this.toggle(true);BX.addClass(this.menuContainer,"menu-favorites-editable");var t=this.menuContainer.querySelectorAll(".menu-item-active");for(var n=0;n<t.length;n++){BX.removeClass(t[n],"menu-item-active");this.activeItemsId.push(t[n].id)}}},{key:"applyEditMode",value:function e(){if(!this.isEditMode()){return}BX.removeClass(this.menuContainer,"menu-favorites-editable");for(var t in this.activeItemsId){BX.addClass(BX(this.activeItemsId[t]),"menu-item-active")}this.activeItemsId=[]}},{key:"areMoreItemsShowed",value:function e(){return BX.hasClass(BX("left-menu-hidden-items-block"),"menu-item-favorites-more-open")?true:false}},{key:"animateShowingHiddenItems",value:function e(){var t=BX("left-menu-hidden-items-block");if(!BX.hasClass(t,"menu-item-favorites-more-open")){t.style.height="0px";t.style.opacity=0;n(true,t,t.scrollHeight)}else{n(false,t,t.offsetHeight)}function n(e,t,n){t.style.overflow="hidden";new BX.easing({duration:200,start:{opacity:e?0:100,height:e?0:n},finish:{opacity:e?100:0,height:e?n:0},transition:BX.easing.transitions.linear,step:function e(n){t.style.opacity=n.opacity/100;t.style.height=n.height+"px"},complete:function e(){BX.toggleClass(BX("left-menu-hidden-items-block"),"menu-item-favorites-more-open");t.style.overflow="";t.style.height=""}}).animate()}}},{key:"showHideMoreItems",value:function e(t){if(this.isEditMode())return;if(t!==false){this.animateShowingHiddenItems()}else{BX.toggleClass(BX("left-menu-hidden-items-block"),"menu-item-favorites-more-open")}BX.toggleClass(this.menuMoreButton,"menu-favorites-more-btn-open");var n=BX("menu-more-btn-text");if(n){if(n.innerHTML===BX.message("more_items_hide")){n.innerHTML=BX.message("more_items_show")}else{n.innerHTML=BX.message("more_items_hide")}}}},{key:"openMenuPopup",value:function e(t,n){var i=BX("bx_left_menu_"+n);if(!BX.type.isDomNode(i))return;var s=[];var a=i.getAttribute("data-delete-perm");var o=i.getAttribute("data-type");if(i.getAttribute("data-status")==="show"){s.push({text:BX.message("hide_item"),className:"menu-popup-no-icon",onclick:BX.proxy(function(){var e=BX.proxy_context;e.popupWindow.close();this.hideItem(n);BX.PopupMenu.destroy("popup_"+n)},this)})}if(i.getAttribute("data-status")==="hide"){s.push({text:BX.message("show_item"),className:"menu-popup-no-icon",onclick:BX.proxy(function(){var e=BX.proxy_context;e.popupWindow.close();this.showItem(n);BX.PopupMenu.destroy("popup_"+n)},this)})}if(!this.isExtranet&&o!=="self"&&BX.previousSibling(i).id!="left-menu-empty-item"&&this.isPublicConverted){s.push({text:BX.message("MENU_SET_MAIN_PAGE"),className:"menu-popup-no-icon",onclick:BX.proxy(function(){var e=BX.proxy_context;e.popupWindow.close();this.setMainPage(n);BX.PopupMenu.destroy("popup_"+n)},this)})}if(o==="self"){s.push({text:BX.message("MENU_DELETE_SELF_ITEM"),className:"menu-popup-no-icon",onclick:BX.proxy(function(){var e=BX.proxy_context;e.popupWindow.close();this.showConfirmWindow({id:"left-menu-delete-self-item",titleBar:BX.message("MENU_DELETE_SELF_ITEM"),okButtonText:BX.message("MENU_DELETE"),content:BX.message("MENU_DELETE_SELF_ITEM_CONFIRM"),onsuccess:BX.proxy(function(){this.selfItemObj.deleteSelfItem(n);BX.PopupMenu.destroy("popup_"+n)},this),onfailure:BX.proxy(function(){BX.PopupMenu.destroy("popup_"+n)},this)})},this)});s.push({text:BX.message("MENU_EDIT_ITEM"),className:"menu-popup-no-icon",onclick:BX.proxy(function(){var e=BX.proxy_context;e.popupWindow.close();var s=BX.findChild(i,{tagName:"a"},true,false);var a={id:n,text:i.querySelector("[data-role='item-text']").innerText,link:i.getAttribute("data-link"),openInNewPage:s.getAttribute("target")=="_blank"};this.selfItemObj.showSelfItemPopup(t,a);BX.PopupMenu.destroy("popup_"+n)},this)})}if(o==="standard"){s.push({text:BX.message("MENU_RENAME_ITEM"),className:"menu-popup-no-icon",onclick:BX.proxy(function(){var e={id:n,text:i.querySelector("[data-role='item-text']").innerText};this.standartItemObj.showStandardEditItemPopup(t,e);BX.PopupMenu.destroy("popup_"+n)},this)});s.push({text:BX.message("MENU_REMOVE_STANDARD_ITEM"),className:"menu-popup-no-icon",onclick:BX.proxy(function(){var e=BX.proxy_context;e.popupWindow.close();this.standartItemObj.deleteStandardItem({itemId:n});BX.PopupMenu.destroy("popup_"+n)},this)})}if(this.isAdmin){if(a==="Y"){s.push({text:BX.message("MENU_ADD_ITEM_TO_ALL"),className:"menu-popup-no-icon",onclick:BX.proxy(function(){this.allItemObj.addItemToAll(n);BX.PopupMenu.destroy("popup_"+n)},this)})}if(a==="A"){if(o==="custom"){s.push({text:BX.message("MENU_DELETE_CUSTOM_ITEM_FROM_ALL"),className:"menu-popup-no-icon",onclick:BX.proxy(function(){this.allItemObj.deleteCustomItemFromAll(n);BX.PopupMenu.destroy("popup_"+n)},this)})}else{s.push({text:BX.message("MENU_DELETE_ITEM_FROM_ALL"),className:"menu-popup-no-icon",onclick:BX.proxy(function(){this.allItemObj.deleteItemFromAll(n);BX.PopupMenu.destroy("popup_"+n)},this)})}}}s.push({text:this.isEditMode()?BX.message("MENU_EDIT_READY_FULL"):BX.message("MENU_SETTINGS_MODE"),className:"menu-popup-no-icon",onclick:BX.proxy(function(){BX.PopupMenu.destroy("popup_"+n);this.isEditMode()?this.applyEditMode():this.switchToEditMode()},this)});BX.PopupMenu.show({id:"popup_"+n,bindElement:t,items:s,offsetTop:0,offsetLeft:12,angle:true,events:{onPopupShow:function(){this.isMenuMouseLeaveBlocked=true;BX.addClass(i,"menu-item-block-hover")}.bind(this),onPopupClose:function(){this.isMenuMouseLeaveBlocked=false;BX.removeClass(i,"menu-item-block-hover")}.bind(this),onPopupDestroy:function(){this.isMenuMouseLeaveBlocked=false;BX.removeClass(i,"menu-item-block-hover")}.bind(this)}})}},{key:"showSettingsPopup",value:function e(t){var n="leftMenuSettingsPopup";if(BX.PopupMenu.getMenuById(n)){BX.PopupMenu.destroy(n);return}var i=this;var s="default";if(BX.type.isDomNode(this.menuSelectedNode)){s=this.menuSelectedNode.getAttribute("data-type")}if(this.isCurrentPageInLeftMenu&&s==="default"){a={text:BX.message(this.isCurrentPageInLeftMenu?"MENU_DELETE_PAGE_FROM_LEFT_MENU":"MENU_ADD_PAGE_TO_LEFT_MENU"),className:"menu-popup-no-icon menu-popup-disable-text"}}else{var a={text:BX.message(this.isCurrentPageInLeftMenu?"MENU_DELETE_PAGE_FROM_LEFT_MENU":"MENU_ADD_PAGE_TO_LEFT_MENU"),className:"menu-popup-no-icon",onclick:BX.proxy(function(){BX.proxy_context.popupWindow.close();if(this.isCurrentPageInLeftMenu){this.standartItemObj.deleteStandardItem({})}else{this.standartItemObj.addStandardItem({})}},this)}}var o=[{text:BX.message("SORT_ITEMS"),className:"menu-popup-no-icon",onclick:function e(){this.popupWindow.close();i.switchToEditMode()}},{text:this.isCollapsedMode?BX.message("MENU_EXPAND"):BX.message("MENU_COLLAPSE"),className:"menu-popup-no-icon",onclick:BX.proxy(function(){BX.proxy_context.popupWindow.close();this.toggle()},this)},a,{text:BX.message("MENU_ADD_SELF_PAGE"),className:"menu-popup-no-icon",onclick:BX.proxy(function(){BX.proxy_context.popupWindow.close();this.selfItemObj.showSelfItemPopup(this.settingsBox)},this)}];if(!this.isExtranet){o.push({text:BX.message("MENU_SET_DEFAULT2"),className:"menu-popup-no-icon",onclick:function e(){this.popupWindow.close();i.setDefaultMenu(true)}})}o.push({text:BX.message("MENU_SET_DEFAULT"),className:"menu-popup-no-icon",onclick:function e(){this.popupWindow.close();i.setDefaultMenu()}});if(this.isAdmin){var r=BX.message("MENU_SAVE_CUSTOM_PRESET");var u=!this.isCustomPresetAvailable;if(u){r+="<span class='menu-lock-icon'></span>"}o.push({html:r,className:"menu-popup-no-icon"+(u?" menu-popup-disable-text":""),onclick:function e(){this.popupWindow.close();if(u){BX.UI.InfoHelper.show("limit_office_menu_to_all")}else{i.presetObj.showCustomPresetPopup()}}})}BX.PopupMenu.show(n,this.settingsBox,o,{offsetTop:0,offsetLeft:50,angle:true,events:{onPopupShow:function(){this.isMenuMouseLeaveBlocked=true}.bind(this),onPopupClose:function(){this.isMenuMouseLeaveBlocked=false;this.switchToSlidingMode(false);BX.PopupMenu.destroy(n)}.bind(this),onPopupDestroy:function(){this.isMenuMouseLeaveBlocked=false;this.switchToSlidingMode(false)}.bind(this)}})}},{key:"showMessage",value:function e(t,n,i){var s=BX.PopupWindowManager.create("left-menu-message",t,{content:'<div class="left-menu-message-popup">'+n+"</div>",darkMode:true,offsetTop:i==="right"?-45:2,offsetLeft:i==="right"?215:0,angle:i==="right"?{position:"left"}:true,events:{onPopupClose:function e(){if(s){s.destroy();s=null}}},autoHide:true});s.show();setTimeout(function(){if(s){s.destroy();s=null}},3e3)}},{key:"showError",value:function e(t){this.showMessage(t,BX.message("edit_error"))}},{key:"onTopMenuFirstItemChange",value:function e(t,n){if(!t)return;var i=n.getAttribute("data-top-menu-id");var s=this.menuItemsBlock.querySelector("[data-top-menu-id='"+i+"']");if(BX.type.isDomNode(s)){s.setAttribute("data-link",t);var a=BX.findChild(s,{tagName:"a",className:"menu-item-link"},true,false);if(a){a.setAttribute("href",t)}}if(BX.type.isDomNode(n)){this.showMessage(n,BX.message("MENU_ITEM_MAIN_SECTION_PAGE"))}if(BX.type.isDomNode(s)&&BX.previousSibling(s)===BX("left-menu-empty-item")){BX.ajax.runAction("intranet.leftmenu.setFirstPage",{data:{firstPageUrl:t}})}else{BX.ajax.runAction("intranet.leftmenu.clearCache",{data:{}})}}},{key:"refineUrl",value:function e(t){t=BX.util.trim(t);if(!BX.type.isNotEmptyString(t)){return""}if(!t.match(/^https?:\/\//i)&&!t.match(/^\//i)){t="http://"+t}else{var n=document.createElement("a");n.href=t;if(document.location.host===n.host){t=n.pathname+n.search+n.hash}}return t}},{key:"updateCounters",value:function e(t,n){this.countersObj.updateCounters(t,n)}},{key:"decrementCounter",value:function e(t,n){this.countersObj.decrementCounter(t,n)}},{key:"checkMoreButton",value:function e(t){var n=this.menuMoreButton;if(t===true||t===false){if(t){BX.removeClass(n,"menu-favorites-more-btn-hidden")}else{BX.addClass(n,"menu-favorites-more-btn-hidden")}return t}var i=BX("left-menu-hidden-items-list").getElementsByClassName("menu-item-block");if(i.length>0){BX.removeClass(n,"menu-favorites-more-btn-hidden");return true}else{BX.addClass(n,"menu-favorites-more-btn-hidden");return false}}},{key:"hideItem",value:function e(t){var n=BX("bx_left_menu_"+t);if(!BX.type.isDomNode(n))return;n.setAttribute("data-status","hide");BX("left-menu-hidden-items-list").appendChild(n);this.checkMoreButton(true);if(n.getAttribute("data-counter-id")){this.countersObj.recountHiddenCounters()}this.saveItemsSort({type:"hide",itemId:t})}},{key:"showItem",value:function e(t){var n=BX("bx_left_menu_"+t);if(!BX.type.isDomNode(n))return;if(BX.type.isDomNode(this.menuItemsBlock)){n.setAttribute("data-status","show");this.menuItemsBlock.insertBefore(n,BX("left-menu-hidden-items-block"))}this.checkMoreButton();if(n.getAttribute("data-counter-id")){this.countersObj.recountHiddenCounters()}this.saveItemsSort({type:"show",itemId:t})}},{key:"saveItemsSort",value:function e(t){var n=[],i=[],s="";var a=BX.findChildren(this.menuContainer,{className:"menu-item-block"},true);for(var o=0;o<a.length;o++){if(o===0){s=a[o].getAttribute("data-link")}if(a[o].getAttribute("data-status")==="show"){n.push(a[o].getAttribute("data-id"))}else if(a[o].getAttribute("data-status")==="hide"){i.push(a[o].getAttribute("data-id"))}}var r={show:n,hide:i};BX.ajax.runAction("intranet.leftmenu.saveItemsSort",{data:{items:r,firstItemLink:s},analyticsLabel:t})}},{key:"showItemWarning",value:function e(t){if(!this.itemWarningObj){this.itemWarningObj=new r(this)}this.itemWarningObj.showItemWarning(t)}},{key:"removeItemWarning",value:function e(t){if(!this.itemWarningObj){this.itemWarningObj=new r(this)}this.itemWarningObj.removeItemWarning(t)}},{key:"generateItemHtml",value:function e(t){if(!(babelHelpers.typeof(t)=="object"&&t))return;var n=[BX.create("span",{attrs:{className:"menu-item-icon-box"},children:[BX.create("span",{attrs:{className:"menu-item-icon"},text:this.getShortName(t.text)})]}),BX.create("span",{text:t.text,attrs:{className:"menu-item-link-text","data-role":"item-text"}})];var i=BX.type.isNotEmptyString(t.counterId);if(i){n.push(BX.create("span",{attrs:{className:"menu-item-index-wrap"},children:[BX.create("span",{attrs:{className:"menu-item-index",id:"menu-counter-"+t.counterId},html:t.counterValue})]}))}var s={href:t.link,className:"menu-item-link",target:t.openInNewPage==="Y"?"_blank":""};if(t.link.indexOf(BX.message("SITE_DIR")+"workgroups/group/")===0){s["data-slider-ignore-autobinding"]=true}var a=BX.create("li",{attrs:{className:"menu-item-block menu-item-no-icon-state "+(i&&t.counterValue?" menu-item-with-index":""),id:"bx_left_menu_"+t.id,"data-type":t.type==="standard"?"standard":"self","data-delete-perm":"Y","data-id":t.id,"data-link":t.link,"data-status":"show","data-new-page":t.openInNewPage==="Y"?"Y":"N"},children:[BX.create("span",{attrs:{className:"menu-fav-editable-btn menu-favorites-btn"},children:[BX.create("span",{attrs:{className:"menu-favorites-btn-icon"}})],events:{click:BX.proxy(function(){this.openMenuPopup(BX.proxy_context,t.id)},this)}}),BX.create("span",{attrs:{className:"menu-favorites-btn menu-favorites-draggable"},children:[BX.create("span",{attrs:{className:"menu-fav-draggable-icon"}})],events:{onmousedown:function e(){BX.addClass(this.parentNode,"menu-item-draggable")},onmouseup:function e(){BX.removeClass(this.parentNode,"menu-item-draggable")}}}),BX.create("a",{attrs:s,children:n})]});if(BX.type.isDomNode(this.menuItemsBlock)){this.menuItemsBlock.insertBefore(a,BX("left-menu-hidden-items-block"))}a.onbxdragstart=BX.proxy(this.menuItemDragStart,this);a.onbxdrag=BX.proxy(this.menuItemDragMove,this);a.onbxdragstop=BX.proxy(this.menuItemDragStop,this);a.onbxdraghover=BX.proxy(this.menuItemDragHover,this);jsDD.registerDest(a,100);jsDD.registerObject(a)}},{key:"updateItemHtml",value:function e(t){if(!(babelHelpers.typeof(t)=="object"&&t))return;var n=BX("bx_left_menu_"+t.id);if(!BX.type.isDomNode(n))return;if(t.link){n.setAttribute("data-link",t.link);var i=BX.findChild(n,{tagName:"a"},true,false);if(BX.type.isDomNode(i)){i.setAttribute("href",t.link);if(t.hasOwnProperty("openInNewPage")){i.setAttribute("target",t.openInNewPage=="Y"?"_blank":"");n.setAttribute("data-new-page",t.openInNewPage=="Y"?"Y":"N")}}}if(t.text){var s=n.querySelector("[data-role='item-text']");if(BX.type.isDomNode(s)){s.textContent=t.text;var a=n.querySelector(".menu-item-icon");if(a){a.textContent=this.getShortName(s.textContent)}}}}},{key:"setMainPage",value:function e(t){var n=BX("bx_left_menu_"+t);if(!BX.type.isDomNode(n))return;if(BX.type.isDomNode(this.menuItemsBlock)){if(n.getAttribute("data-status")=="hide"){n.setAttribute("data-status","show")}var i=n.offsetTop;var s=BX.create("div",{attrs:{className:"menu-draggable-wrap"},style:{top:i}});var a=n.nextElementSibling;if(a){n.parentNode.insertBefore(s,a)}else{n.parentNode.appendChild(s)}s.appendChild(n);BX.addClass(n,"menu-item-draggable");new BX.easing({duration:500,start:{top:i},finish:{top:0},transition:BX.easing.makeEaseOut(BX.easing.transitions.quart),step:function e(t){s.style.top=t.top+"px"},complete:BX.proxy(function(){this.menuItemsBlock.insertBefore(n,BX("left-menu-empty-item").nextSibling);BX.removeClass(n,"menu-item-draggable");BX.remove(s);this.saveItemsSort({type:"mainPage",itemId:t})},this)}).animate()}}},{key:"showConfirmWindow",value:function e(t){t=t||{};var n=BX.type.isNotEmptyString(t.id)?t.id:BX.util.getRandomString();var i=BX.PopupWindowManager.create(n,null,{content:'<div class="left-menu-confirm-popup">'+(BX.type.isNotEmptyString(t.content)?t.content:"")+"</div>",titleBar:BX.type.isNotEmptyString(t.titleBar)?t.titleBar:false,closeByEsc:true,closeIcon:true,draggable:true,buttons:[new BX.PopupWindowButton({text:BX.type.isNotEmptyString(t.okButtonText)?t.okButtonText:"OK",className:"popup-window-button-create",events:{click:function e(){if(BX.type.isFunction(t.onsuccess)){t.onsuccess()}this.popupWindow.destroy()}}}),t.alertMode!==true?new BX.PopupWindowButtonLink({text:BX.type.isNotEmptyString(t.cancelButtonText)?t.cancelButtonText:BX.message("MENU_CANCEL"),className:"popup-window-button-link-cancel",events:{click:function e(){if(BX.type.isFunction(t.onfailure)){t.onfailure()}this.popupWindow.destroy()}}}):null]});i.show()}},{key:"setDefaultMenu",value:function e(t){if(this.isExtranet||t!==true){if(!confirm(BX.message("MENU_SET_DEFAULT_CONFIRM")))return;BX.ajax.runAction("intranet.leftmenu.setDefaultMenu",{data:{},analyticsLabel:{defaultMenu:"Y"}}).then(function(){document.location.reload()})}else{this.presetObj.showPresetPopupFunction("personal")}}},{key:"menuItemDragStart",value:function e(){BX.onCustomEvent("BX.Bitrix24.LeftMenuClass:onDragStart");var t=BX.proxy_context;if(BX.type.isDomNode(this.menuItemsBlock)){var n=this.menuItemsBlock.getElementsByClassName("menu-item-block");for(var i=0;i<n.length;i++){jsDD.registerDest(n[i],100);jsDD.registerObject(n[i])}}if(t.getAttribute("data-type")==="self"){jsDD.unregisterDest(BX("left-menu-empty-item"))}else{jsDD.registerDest(BX("left-menu-empty-item"),100)}jsDD.registerDest(BX("left-menu-hidden-empty-item"),100);jsDD.registerDest(BX("left-menu-hidden-separator"),100);if(!this.isEditMode()){this.areMoreItemsShowedState=this.areMoreItemsShowed();if(!this.areMoreItemsShowedState){this.showHideMoreItems()}}this.itemHeight=t.offsetHeight;BX.addClass(t,"menu-item-draggable");BX.addClass(this.menuContainer,"menu-drag-mode");this.itemDomBlank=t.parentNode.insertBefore(BX.create("div",{style:{height:"0px"}}),t);this.itemMoveBlank=BX.create("div",{style:{height:this.itemHeight+"px"}});this.draggableBlock=BX.create("div",{attrs:{className:"menu-draggable-wrap"},children:[t]});this.menuItemsBlockCoord=BX.pos(this.menuItemsBlock);this.menuItemsBlock.style.position="relative";this.menuItemsBlock.appendChild(this.draggableBlock)}},{key:"menuItemDragMove",value:function e(t,n){n-=this.menuItemsBlockCoord.top;var i=this.menuItemsBlock.offsetHeight;if(n<0)n=0;if(n>i-this.itemHeight)n=i-this.itemHeight;this.draggableBlock.style.top=n-5+"px"}},{key:"menuItemDragHover",value:function e(t,n,i){var s=BX.proxy_context;if(t==s){this.itemDomBlank.parentNode.insertBefore(this.itemMoveBlank,this.itemDomBlank)}else if((s.getAttribute("data-type")=="self"||s.getAttribute("data-disable-first-item")=="Y")&&t.id==="left-menu-empty-item"){return}else{if(BX.findParent(t,{className:"menu-items"})){if(BX.nextSibling(t))t.parentNode.insertBefore(this.itemMoveBlank,BX.nextSibling(t));else t.parentNode.appendChild(this.itemMoveBlank)}}}},{key:"menuItemDragStop",value:function e(){var t=BX.proxy_context;BX.removeClass(this.menuContainer,"menu-drag-mode");BX.removeClass(t,"menu-item-draggable");var n=BX.findChild(this.menuContainer,{className:"menu-item-block"},true,false);if(BX.type.isDomNode(n)&&n.getAttribute("data-type")=="self"){this.showMessage(n,BX.message("MENU_SELF_ITEM_FIRST_ERROR"),"right");this.menuItemsBlock.replaceChild(t,this.itemDomBlank)}else if(n.getAttribute("data-disable-first-item")=="Y"){this.showMessage(n,BX.message("MENU_FIRST_ITEM_ERROR"),"right");this.menuItemsBlock.replaceChild(t,this.itemDomBlank)}else if(this.itemMoveBlank&&BX.findParent(this.itemMoveBlank,{className:"menu-items"})){this.itemMoveBlank.parentNode.replaceChild(t,this.itemMoveBlank);if(t.parentNode.id=="left-menu-hidden-items-list"){if(t.getAttribute("data-status")=="show"&&t.getAttribute("data-counter-id")){this.countersObj.recountHiddenCounters()}t.setAttribute("data-status","hide")}else{if(t.getAttribute("data-status")=="hide"&&t.getAttribute("data-counter-id")){this.countersObj.recountHiddenCounters()}t.setAttribute("data-status","show")}var i={type:"sort"};var s=BX.previousSibling(t);if(BX.type.isDomNode(s)&&s.id=="left-menu-empty-item"&&!this.isExtranet){this.showMessage(t,BX.message("MENU_ITEM_MAIN_PAGE"),"right");i={type:"mainPage",itemId:t.getAttribute("data-id")}}this.checkMoreButton();this.saveItemsSort(i)}else{this.menuItemsBlock.replaceChild(t,this.itemDomBlank)}BX.remove(this.draggableBlock);BX.remove(this.itemDomBlank);BX.remove(this.itemMoveBlank);jsDD.enableDest(t);this.menuItemsBlock.style.position="static";if(!this.isEditMode()&&!this.areMoreItemsShowedState){this.showHideMoreItems()}this.draggableBlock=null;this.menuItemsBlockCoord=null;this.itemDomBlank=null;this.itemMoveBlank=null;this.areMoreItemsShowedState=null;jsDD.refreshDestArea()}},{key:"clearCompositeCache",value:function e(){BX.ajax.runAction("intranet.leftmenu.clearCache",{data:{}})}},{key:"adjustAdminPanel",value:function e(){if(!this.adminPanel){return}var t=this.adminPanel.getBoundingClientRect();if(t.bottom>0){this.menuContainer.style.top=Math.max(t.bottom,this.fixedAdminPanelHeight)+"px"}else{this.menuContainer.style.top=Math.max(0,this.fixedAdminPanelHeight)+"px"}}},{key:"handleBurgerClick",value:function e(t){this.menuHeaderBurger.classList.add("menu-switcher-hover");this.toggle(t,function(){this.isMenuMouseEnterBlocked=true;setTimeout(function(){this.menuHeaderBurger.classList.remove("menu-switcher-hover");this.isMenuMouseEnterBlocked=false}.bind(this),100)}.bind(this))}},{key:"handleMenuMouseEnter",value:function e(t){if(!this.isCollapsed()){return}if(!this.isMenuMouseEnterBlocked){if(this.slidingModeTimeoutId){clearTimeout(this.slidingModeTimeoutId)}this.slidingModeTimeoutId=setTimeout(function(){this.slidingModeTimeoutId=null;this.switchToSlidingMode(true)}.bind(this),400)}}},{key:"handleMenuMouseLeave",value:function e(t){clearTimeout(this.slidingModeTimeoutId);this.slidingModeTimeoutId=null;if(!this.isMenuMouseLeaveBlocked){this.switchToSlidingMode(false)}}},{key:"handleMenuDoubleClick",value:function e(t){if(t.target===this.menuBody){this.toggle()}}},{key:"handleHeaderLogoMouserEnter",value:function e(t){BX.addClass(this.headerSettings,"header-logo-block-settings-show")}},{key:"handleHeaderLogoMouserLeave",value:function e(t){if(!this.headerSettings.hasAttribute("data-rename-portal")){BX.removeClass(this.headerSettings,"header-logo-block-settings-show")}}},{key:"handleAdminPanelCollapse",value:function e(t){this.adminPanelHeight=null;if(BX.admin.panel.isFixed()){this.fixedAdminPanelHeight=this.getAdminPanelHeight()}this.adjustAdminPanel()}},{key:"handleAdminPanelFix",value:function e(t){if(t){this.fixedAdminPanelHeight=this.getAdminPanelHeight()}else{this.fixedAdminPanelHeight=0}this.adjustAdminPanel()}},{key:"handleSiteMapClick",value:function e(){this.switchToSlidingMode(false);BX.SidePanel.Instance.open("bitrix24-sitemap",{cacheable:false,contentCallback:function e(){var t=new BX.Promise;t.fulfill(BX("sitemap").innerHTML);return t}})}},{key:"handleUpButtonClick",value:function e(){this.isMenuMouseEnterBlocked=true;if(this.isUpButtonReversed()){window.scrollTo(0,this.lastScrollOffset);this.lastScrollOffset=0;this.unreverseUpButton()}else{this.lastScrollOffset=window.pageYOffset;window.scrollTo(0,0);this.reverseUpButton()}setTimeout(function(){clearTimeout(this.slidingModeTimeoutId);this.slidingModeTimeoutId=null;this.isMenuMouseEnterBlocked=false}.bind(this),100)}},{key:"handleUpButtonMouseEnter",value:function e(){this.isMenuMouseEnterBlocked=true;clearTimeout(this.slidingModeTimeoutId);this.slidingModeTimeoutId=null}},{key:"handleUpButtonMouseLeave",value:function e(){this.isMenuMouseEnterBlocked=false}},{key:"handleMenuItemMouseEnter",value:function e(t){this.handleMenuMouseEnter(t)}},{key:"handleMenuItemMouseClick",value:function e(t){if(this.isCollapsed()){clearTimeout(this.slidingModeTimeoutId);this.slidingModeTimeoutId=null}}},{key:"handleDocumentScroll",value:function e(){this.adjustAdminPanel();this.applyScrollMode();if(window.pageYOffset>document.documentElement.clientHeight){this.showUpButton();if(this.isUpButtonReversed()){this.unreverseUpButton();this.lastScrollOffset=0}}else{if(!this.isUpButtonReversed()){this.hideUpButton()}}if(window.pageXOffset>0){this.menuContainer.style.left=-window.pageXOffset+"px";this.upButton.style.left=-window.pageXOffset+(this.isCollapsed()?0:172)+"px"}else{this.menuContainer.style.removeProperty("left");this.upButton.style.removeProperty("left")}}},{key:"handleGroupPanelOpen",value:function e(){this.isMenuMouseLeaveBlocked=true}},{key:"handleGroupPanelClose",value:function e(){this.isMenuMouseLeaveBlocked=false}},{key:"showUpButton",value:function e(){this.menuContainer.classList.add("menu-up-button-active")}},{key:"hideUpButton",value:function e(){this.menuContainer.classList.remove("menu-up-button-active")}},{key:"reverseUpButton",value:function e(){this.menuContainer.classList.add("menu-up-button-reverse")}},{key:"unreverseUpButton",value:function e(){this.menuContainer.classList.remove("menu-up-button-reverse")}},{key:"isUpButtonReversed",value:function e(){return this.menuContainer.classList.contains("menu-up-button-reverse")}},{key:"isDefaultTheme",value:function e(){return document.body.classList.contains("bitrix24-default-theme")}},{key:"getTopPadding",value:function e(){return this.isDefaultTheme()?0:9}},{key:"getAdminPanelHeight",value:function e(){if(this.adminPanelHeight!==null){return this.adminPanelHeight}if(this.adminPanel){this.adminPanelHeight=this.adminPanel.offsetHeight}else{this.adminPanelHeight=0}return this.adminPanelHeight}},{key:"getTemplateHeaderHeight",value:function e(){if(this.templateHeaderHeight===null){var t=BX("header");if(t){this.templateHeaderHeight=t.offsetHeight}}return this.templateHeaderHeight?this.templateHeaderHeight:0}},{key:"switchToSlidingMode",value:function e(t,n){if(t===false){if(this.slidingModeTimeoutId){clearTimeout(this.slidingModeTimeoutId);this.slidingModeTimeoutId=null}if(BX.hasClass(this.mainTable,"menu-sliding-mode")){if(n!==true){BX.addClass(this.mainTable,"menu-sliding-closing-mode")}BX.removeClass(this.mainTable,"menu-sliding-mode menu-sliding-opening-mode")}}else if(this.isCollapsedMode&&!BX.hasClass(this.mainTable,"menu-sliding-mode")){BX.removeClass(this.mainTable,"menu-sliding-closing-mode");if(n!==true){BX.addClass(this.mainTable,"menu-sliding-opening-mode")}BX.addClass(this.mainTable,"menu-sliding-mode")}}},{key:"handleSlidingTransitionEnd",value:function e(t){if(t.target===this.menuContainer){BX.removeClass(this.mainTable,"menu-sliding-opening-mode menu-sliding-closing-mode")}}},{key:"switchToScrollMode",value:function e(t){if(t===false){if(this.isScrollMode===true){BX.removeClass(this.mainTable,"menu-scroll-mode");this.isScrollMode=false}}else{if(this.isScrollMode===false){BX.addClass(this.mainTable,"menu-scroll-mode");this.isScrollMode=true}}}},{key:"switchToLogoMaskMode",value:function e(t){if(t===false){if(this.islogoMaskMode===true){BX.removeClass(this.mainTable,"menu-logo-mask-mode");this.islogoMaskMode=false}}else{if(this.islogoMaskMode===false){BX.addClass(this.mainTable,"menu-logo-mask-mode");this.islogoMaskMode=true}}}},{key:"applyScrollMode",value:function e(){if(this.isLogoMaskNeeded()){this.switchToLogoMaskMode(true)}var t=this.scrollModeThreshold;if(this.fixedAdminPanelHeight===0&&this.adminPanel){t+=this.getAdminPanelHeight()}if(window.pageYOffset>t){this.switchToScrollMode(true)}else{this.switchToScrollMode(false)}}},{key:"isLogoMaskNeeded",value:function e(){if(this.logoMaskNeeded===null){if(this.menuHeaderLogo.querySelector(".logo-image-container")){this.logoMaskNeeded=false}else{var t=this.menuHeaderLogo;if(t.offsetWidth===0){t=this.headerLogo}this.logoMaskNeeded=t.offsetWidth>200}}return this.logoMaskNeeded}},{key:"toggle",value:function e(t,n){var i=BX("layout-left-column");if(!i){return}var s=!BX.hasClass(this.mainTable,"menu-collapsed-mode");if(t===true&&s||t===false&&!s||BX.hasClass(this.mainTable,"menu-animation-mode")){return}if(this.isEditMode()){this.applyEditMode()}BX.onCustomEvent("BX.Bitrix24.LeftMenuClass:onMenuToggle",[t,this]);var a=this.menuHeader.querySelector(".logo-image-container");if(a){var o=this.header.querySelector(".logo-image-container").offsetWidth;if(o>0){a.style.width=o+"px"}}this.isMenuMouseEnterBlocked=true;this.switchToSlidingMode(false,true);this.applyScrollMode();i.style.overflow="hidden";BX.addClass(this.mainTable,"menu-animation-mode "+(s?"menu-animation-closing-mode":"menu-animation-opening-mode"));var r=[].slice.call(i.querySelectorAll(".menu-item-link"));var u=i.querySelector(".menu-collapsed-more-btn");var l=i.querySelector(".menu-default-more-btn");var m=i.querySelector(".menu-sitemap-icon-box");var d=i.querySelector(".menu-sitemap-btn-text");var c=i.querySelector(".menu-invite-employees-text");var h=i.querySelector(".menu-invite-icon-box");var p=i.querySelector(".menu-license-all-container");var f=i.querySelector(".menu-license-all-default");if(f){var B=f.offsetHeight}var g=i.querySelector(".menu-license-all-collapsed");var v=i.querySelector(".menu-item-separator");var y=i.querySelector(".menu-item-index-more");var X=this.mainTable.querySelector(".page-header");var b=document.getElementById("bx-im-bar");var M=b?b.offsetWidth:0;new BX.easing({duration:300,start:{translateIcon:s?-100:0,translateText:s?0:-100,translateMoreBtn:s?0:-84,translateLicenseBtn:s?0:-100,heightLicenseBtn:s?B:40,burgerMenuWidth:s?33:66,sidebarWidth:s?240:66,opacity:s?100:0,opacityRevert:s?0:100},finish:{translateIcon:s?0:-100,translateText:s?-100:-18,translateMoreBtn:s?-84:0,translateLicenseBtn:s?-100:0,heightLicenseBtn:s?40:B,burgerMenuWidth:s?66:33,sidebarWidth:s?66:240,opacity:s?0:100,opacityRevert:s?100:0},transition:BX.easing.makeEaseOut(BX.easing.transitions.quart),step:function(e){i.style.width=e.sidebarWidth+"px";this.menuContainer.style.width=e.sidebarWidth+"px";this.menuHeaderBurger.style.width=e.burgerMenuWidth+"px";this.headerBurger.style.width=e.burgerMenuWidth+"px";if(X){X.style.maxWidth="calc(100vw - "+e.sidebarWidth+"px - "+M+"px)"}if(s){if(m){m.style.transform="translateX("+e.translateIcon+"px)";m.style.opacity=e.opacityRevert/100}if(d){d.style.transform="translateX("+e.translateText+"px)";d.style.opacity=e.opacity/100}if(h){h.style.transform="translateX("+e.translateIcon+"px)";h.style.opacity=e.opacityRevert/100}if(c){c.style.transform="translateX("+e.translateText+"px)";c.style.opacity=e.opacity/100}this.settingsIconBox.style.transform="translateX("+e.translateIcon+"px)";this.settingsIconBox.style.opacity=e.opacityRevert/100;this.settingsBtnText.style.transform="translateX("+e.translateText+"px)";this.settingsBtnText.style.opacity=e.opacity/100;u.style.transform="translateX("+e.translateIcon+"px)";u.style.opacity=e.opacityRevert/100;l.style.transform="translateX("+e.translateMoreBtn+"px)";l.style.opacity=e.opacity/100;if(y){y.style.transform="translateX("+e.translateIcon+"px)";y.style.opacity=e.opacityRevert/100}if(p){f.style.transform="translateX("+e.translateLicenseBtn+"px)";f.style.opacity=e.opacity/100;f.style.height=e.heightLicenseBtn+"px";g.style.transform="translateX("+e.translateIcon+"px)";g.style.opacity=e.opacityRevert/100}r.forEach(function(t){var n=t.querySelector(".menu-item-icon-box");var i=t.querySelector(".menu-item-link-text");var s=t.querySelector(".menu-item-index");i.style.transform="translateX("+e.translateText+"px)";i.style.opacity=e.opacity/100;n.style.transform="translateX("+e.translateIcon+"px)";n.style.opacity=e.opacityRevert/100;if(s){s.style.transform="translateX("+e.translateIcon+"px)";s.style.opacity=e.opacityRevert/100}})}else{v.style.opacity=0;if(m){m.style.transform="translateX("+e.translateIcon+"px)";m.style.opacity=e.opacityRevert/100}if(d){d.style.transform="translateX("+e.translateText+"px)";d.style.opacity=e.opacity/100}if(h){h.style.transform="translateX("+e.translateIcon+"px)";h.style.opacity=e.opacityRevert/100}if(c){c.style.transform="translateX("+e.translateText+"px)";c.style.opacity=e.opacity/100}this.settingsIconBox.style.transform="translateX("+e.translateIcon+"px)";this.settingsIconBox.style.opacity=e.opacityRevert/100;this.settingsBtnText.style.transform="translateX("+e.translateText+"px)";this.settingsBtnText.style.opacity=e.opacity/100;u.style.transform="translateX("+e.translateIcon+"px)";u.style.opacity=e.opacityRevert/100;l.style.transform="translateX("+e.translateMoreBtn+"px)";l.style.opacity=e.opacity/100;if(y){y.style.transform="translateX("+e.translateText+"px)"}if(p){f.style.transform="translateX("+e.translateLicenseBtn+"px)";f.style.opacity=e.opacity/100;f.style.height=e.heightLicenseBtn+"px";g.style.transform="translateX("+e.translateIcon+"px)";g.style.opacity=e.opacityRevert/100}r.forEach(function(t){var n=t.querySelector(".menu-item-icon-box");var i=t.querySelector(".menu-item-link-text");var s=t.querySelector(".menu-item-index");i.style.transform="translateX("+e.translateText+"px)";i.style.opacity=e.opacity/100;i.style.display="inline-block";n.style.transform="translateX("+e.translateIcon+"px)";n.style.opacity=e.opacityRevert/100;if(s){s.style.transform="translateX("+e.translateText+"px)"}})}var t=document.createEvent("Event");t.initEvent("resize",true,true);window.dispatchEvent(t)}.bind(this),complete:function(){if(s){this.isCollapsedMode=true;BX.addClass(this.mainTable,"menu-collapsed-mode")}else{this.isCollapsedMode=false;BX.removeClass(this.mainTable,"menu-collapsed-mode")}BX.removeClass(this.mainTable,"menu-animation-mode menu-animation-opening-mode menu-animation-closing-mode");var e=[i,v,this.menuHeaderBurger,this.headerBurger,this.settingsIconBox,this.settingsBtnText,l,u,a,m,d,h,c,y,f,g,this.menuContainer,X];e.forEach(function(e){if(e){e.style.cssText=""}});r.forEach(function(e){var t=e.querySelector(".menu-item-icon-box");var n=e.querySelector(".menu-item-link-text");var i=e.querySelector(".menu-item-index");e.style.cssText="";n.style.cssText="";t.style.cssText="";if(i){i.style.cssText=""}});this.isMenuMouseEnterBlocked=false;this.adjustAdminPanel();if(BX.type.isFunction(n)){n()}var t=s?"collapseMenu":"expandMenu";BX.ajax.runAction("intranet.leftmenu.".concat(t),{data:{},analyticsLabel:{type:t}});var o=document.createEvent("Event");o.initEvent("resize",true,true);window.dispatchEvent(o)}.bind(this)}).animate()}},{key:"highlight",value:function e(t){if(!BX.type.isNotEmptyString(t)||!this.menuContainer){return false}var n=this.menuContainer.getElementsByTagName("li");var i=-1;var s=-1;var a=-1;for(var o=0,r=n.length;o<r;o++){var u=[];var l=n[o].getAttribute("data-link");if(BX.type.isNotEmptyString(l)){var m=n[o].getAttribute("data-type");u.push({priority:BX.util.in_array(m,["standard","admin"])?3:2,url:l})}var d=n[o].getAttribute("data-all-links");if(BX.type.isNotEmptyString(d)){d.split(",").forEach(function(e){e=BX.util.trim(e);if(BX.type.isNotEmptyString(e)){u.push({priority:1,url:e})}})}for(var c=0,h=u.length;c<h;c++){var p=u[c].url;var f=u[c].priority;var B=this.isItemSelected(p,t);if(B){var g=p.length;if(g>s||g===s&&f>a){i=o;s=g;a=f}}}}if(i<0){return}var v=n[i];BX.addClass(v,"menu-item-active");var y=v.parentNode.parentNode;if(BX.hasClass(y,"menu-item-favorites-more")&&!BX.hasClass(y,"menu-item-favorites-more-open")){this.showHideMoreItems(false)}return true}},{key:"makeTextIcons",value:function e(){var t=this.menuContainer.getElementsByTagName("li");for(var n=0,i=t.length;n<i;n++){var s=t[n];var a=!s.classList.contains("menu-item-no-icon-state");if(a){continue}var o=s.querySelector(".menu-item-icon");var r=s.querySelector(".menu-item-link-text");if(o&&r){o.textContent=this.getShortName(r.textContent)}}}},{key:"getShortName",value:function e(t){if(!BX.type.isString(t)||!BX.type.isNotEmptyString(t.trim())){return"..."}var n="";t=t.replace(/['`".,:;~|{}*^$#@&+\-=?!()[\]<>\n\r]+/g,"").trim();if(!BX.type.isNotEmptyString(t)){n=t.substring(0,2)}else if(t.length===2){n=t}var i=t.split(/[\s,]+/);if(i.length<=1){n=t.substring(0,1)}else if(i.length===2){n=i[0].substring(0,1)+i[1].substring(0,1)}else{var s=i[0];var a=i[1];for(var o=1;o<i.length;o++){if(i[o].length>3){a=i[o];break}}n=s.substring(0,1)+a.substring(0,1)}return n.toUpperCase()}},{key:"getSelectedItem",value:function e(t,n){if(!BX.type.isNotEmptyString(t)||!this.menuContainer){return false}var i=this.menuContainer.getElementsByTagName("li");var s=-1;var a=-1;var o=null;for(var r=0,u=i.length;r<u;r++){var l=[];if(n){var m=i[r].getAttribute("data-all-links");if(BX.type.isNotEmptyString(m)){l=l.concat(m.split(","))}}else{var d=i[r].getAttribute("data-link");if(BX.type.isNotEmptyString(d)){l.push(d)}}for(var c=0,h=l.length;c<h;c++){var p=l[c];if(!BX.type.isNotEmptyString(p)){continue}var f=this.isItemSelected(p,t);if(f){var B=p.length;if(B>a){s=r;o=l[c];a=B}}}}return s>=0?i[s]:null}},{key:"isItemSelected",value:function e(t,n){var i=n;var s=n.indexOf("?");if(s!==-1){n=n.substring(0,s)}var a=this.getUrlWithIndex(n);t=t.replace(/(\/index\.php)($|\?)/,"$2");if(n.indexOf(t)===0||a.indexOf(t)===0){return true}s=t.indexOf("?");if(s===-1){return false}var o=t.substring(0,s);if(o!==n&&o!==a){return false}var r=true;var u=this.getUrlParams(t);var l=this.getUrlParams(i);for(var m in u){if(!u.hasOwnProperty(m)){continue}var d=u[m];var c=typeof l[m]!=="undefined"?l[m]:[];for(var h=0;h<d.length;h++){var p=d[h];if(!BX.util.in_array(p,c)){r=false;break}}}return r}},{key:"getUrlParams",value:function e(t){var n={};var i=t.indexOf("?");if(i===-1){return n}var s=t.substring(i+1).split("&");for(var a=0;a<s.length;a++){var o=s[a];var r=o.indexOf("=");if(r===0){continue}var u=r===-1?o:o.substring(0,r);u=u.replace("[]","");var l=r===-1?"":o.substring(r+1);if(n[u]){n[u].push(l)}else{n[u]=[l]}}return n}},{key:"getUrlWithIndex",value:function e(t){if(!BX.type.isNotEmptyString(t)){t=""}var n=t.indexOf("?");var i=n>=0?"?"+t.substring(n+1):"";var s=n>=0?t.substring(0,n):t;if(s.match(/\.php$/)){return t}if(s.slice(-1)!=="/"){s+="/"}return s+"index.php"+i}},{key:"checkCurrentPageInTopMenu",value:function e(){var t=document.location.pathname+document.location.search;if(BX.Main&&BX.Main.interfaceButtonsManager){var n=BX.Main.interfaceButtonsManager.getObjects();var i=Object.keys(n);if(i[0]){var s=n[i[0]];this.topItemSelectedObj=s.getActive();if(babelHelpers.typeof(this.topItemSelectedObj)==="object"&&this.topItemSelectedObj){if(this.topItemSelectedObj.hasOwnProperty("NODE")){this.topMenuSelectedNode=this.topItemSelectedObj.NODE}var a=document.createElement("a");a.href=this.topItemSelectedObj.URL;var o=a.pathname[0]!=="/"?"/"+a.pathname:a.pathname;this.topItemSelectedObj.URL=BX.util.htmlspecialcharsback(o+a.search);this.topItemSelectedObj.TEXT=BX.util.htmlspecialcharsback(this.topItemSelectedObj.TEXT);this.isCurrentPageStandard=this.topItemSelectedObj.URL===t&&this.topItemSelectedObj.URL.indexOf("workgroups")===-1}}}return this.isCurrentPageStandard}},{key:"checkLinkInMenu",value:function e(t){if(!BX.type.isNotEmptyString(t))return;if(BX.type.isDomNode(this.menuItemsBlock)){var n=this.menuItemsBlock.getElementsByClassName("menu-item-block");for(var i=0;i<n.length;i++){if(n[i].getAttribute("data-link")==t)return n[i]}}return false}},{key:"getStructureForHelper",value:function e(){var t={menu:{}};if(BX.type.isDomNode(this.menuContainer)){var n=["show","hide"];for(var i in n){var s=this.menuContainer.querySelectorAll("[data-status='"+n[i]+"']");if(s){var a=[];for(var o=0,r=s.length;o<r;o++){if(s[o].getAttribute("data-type")!="default"){continue}a.push(s[o].getAttribute("data-id"))}}t[n[i]]=a}}return t}},{key:"initPagetitleStar",value:function e(){this.checkCurrentPageInTopMenu();return true}},{key:"onRequestMenuItemData",value:function e(t){BX.onCustomEvent("BX.Bitrix24.LeftMenuClass:onSendMenuItemData",[{currentPageInMenu:this.checkLinkInMenu(t.currentFullPath),context:t.context}])}},{key:"onToolbarStarClick",value:function e(t){if(t.isActive){this.standartItemObj.deleteStandardItem({context:t.context,pageLink:t.pageLink})}else{this.standartItemObj.addStandardItem({context:t.context,pageTitle:t.pageTitle,pageLink:t.pageLink})}}},{key:"showImportConfigurationSlider",value:function e(){if(this.urlImportConfiguration!==""){BX.SidePanel.Instance.open(this.urlImportConfiguration)}}},{key:"showLoader",value:function e(){var t=BX.create("div",{html:'<div style="display: block" class="intranet-loader-container"> <svg class="intranet-loader-circular" viewBox="25 25 50 50"> <circle class="intranet-loader-path" cx="50" cy="50" r="20" fill="none" stroke-miterlimit="10" /> </svg> </div>'});document.body.appendChild(t)}}]);return e}();u.LeftMenu=l})(this.BX.Intranet.LeftMenu=this.BX.Intranet.LeftMenu||{},BX);
//# sourceMappingURL=script.map.js