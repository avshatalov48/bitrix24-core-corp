{"version":3,"file":"script.js","sources":["src/options.js","src/controllers/default-controller.js","src/controllers/preset-custom-controller.js","src/utils/admin-panel.js","src/utils.js","src/controllers/preset-default-controller.js","src/controllers/settings-controller.js","src/backend.js","src/items/item.js","src/items/item-user-favorites.js","src/items/item-user-self.js","src/items/item-admin-shared.js","src/items/item-admin-custom.js","src/items/item-main-page.js","src/items/item-system.js","src/items/item-group.js","src/items/item-group-system.js","src/items/index.js","src/items/item-active.js","src/controllers/items-controller.js","src/controllers/item-director.js","src/analytics.js","src/menu.js"],"sourcesContent":["import {Type} from 'main.core';\n\nexport default class Options {\n\tstatic version = '2021.10';\n\tstatic eventNameSpace = 'BX.Intranet.LeftMenu:';\n\tstatic eventName(name) {\n\t\treturn ['BX.Intranet.LeftMenu:', ...(Type.isStringFilled(name) ? [name] : name)].join(':')\n\t}\n\n\tstatic isExtranet = false;\n\tstatic isAdmin = false;\n\tstatic isCustomPresetRestricted = false;\n\tstatic settingsPath = null;\n\tstatic isMainPageEnabled = false;\n\n\tstatic availablePresetTools = null;\n}","import {Loc} from 'main.core';\nimport {Menu, MenuItem} from 'main.popup';\nimport {EventEmitter, BaseEvent} from 'main.core.events';\nimport Options from '../options';\n\nexport default class DefaultController\n{\n\tcontainer;\n\t#popup = null;\n\n\tconstructor(\n\t\tcontainer, {\n\t\t\tevents\n\t\t}\n\t)\n\t{\n\t\tthis.container = container;\n\t\tif (events)\n\t\t{\n\t\t\tArray\n\t\t\t\t.from(Object.keys(events))\n\t\t\t\t.forEach((key) => {\n\t\t\t\t\tEventEmitter.subscribe(this, Options.eventName(key), events[key])\n\t\t\t\t})\n\t\t\t;\n\t\t}\n\t}\n\n\tgetContainer(): ?Element\n\t{\n\t\treturn this.container;\n\t}\n\n\tcreatePopup(): Popup\n\t{\n\n\t}\n\n\tgetPopup()\n\t{\n\t\treturn this.#popup;\n\t}\n\n\tshow()\n\t{\n\t\tif (this.#popup === null)\n\t\t{\n\t\t\tthis.#popup = this.createPopup(...arguments);\n\t\t\tEventEmitter.subscribe(this.#popup, 'onClose', () => {\n\t\t\t\tEventEmitter.emit(this, Options.eventName('onClose'));\n\t\t\t});\n\t\t\tEventEmitter.subscribe(this.#popup, 'onShow', () => {\n\t\t\t\tEventEmitter.emit(this, Options.eventName('onShow'));\n\t\t\t});\n\t\t\tEventEmitter.subscribe(this.#popup, 'onDestroy', () => {\n\t\t\t\tthis.#popup = null;\n\t\t\t});\n\t\t}\n\t\tthis.#popup.show()\n\t}\n\n\thide()\n\t{\n\t\tif (this.#popup)\n\t\t{\n\t\t\tthis.#popup.close();\n\t\t}\n\t}\n}","import {Loc, Tag} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport {PopupManager} from 'main.popup';\nimport DefaultController from './default-controller';\nimport Options from \"../options\";\nimport {CancelButton, SaveButton} from 'ui.buttons';\n\nexport default class PresetCustomController extends DefaultController\n{\n\tisReady: boolean = true;\n\n\tcreatePopup()\n\t{\n\t\tconst form = Tag.render`\n\t\t\t<form id=\"customPresetForm\" style=\"min-width: 350px;\">\n\t\t\t\t<div style=\"margin: 15px 0 15px 9px;\">\n\t\t\t\t\t<input type=\"radio\" name=\"userScope\" id=\"customPresetCurrentUser\" value=\"currentUser\">\n\t\t\t\t\t<label for=\"customPresetCurrentUser\">${Loc.getMessage(\"MENU_CUSTOM_PRESET_CURRENT_USER\")}</label>\n\t\t\t\t</div>\n\t\t\t\t<div style=\"margin: 0 0 38px 9px;\">\n\t\t\t\t\t<input type=\"radio\" name=\"userScope\" id=\"customPresetNewUser\" value=\"newUser\" checked>\n\t\t\t\t\t<label for=\"customPresetNewUser\">${Loc.getMessage(\"MENU_CUSTOM_PRESET_NEW_USER\")}</label>\n\t\t\t\t</div>\n\t\t\t\t<hr style=\"background-color: #edeef0; border: none; color:  #edeef0; height: 1px;\">\n\t\t\t</form>`\n\t\t;\n\n\t\tlet button;\n\t\treturn PopupManager.create(\n\t\t\tthis.constructor.toString(), null, {\n\t\t\toverlay: true,\n\t\t\tcontentColor : \"white\",\n\t\t\tcontentNoPaddings : true,\n\t\t\tlightShadow: true,\n\t\t\tdraggable: {restrict: true},\n\t\t\tcloseByEsc: true,\n\t\t\ttitleBar: Loc.getMessage(\"MENU_CUSTOM_PRESET_POPUP_TITLE\"),\n\t\t\toffsetTop: 1,\n\t\t\toffsetLeft: 20,\n\t\t\tcacheable: false,\n\t\t\tcloseIcon: true,\n\t\t\tcontent: form,\n\t\t\tbuttons: [\n\t\t\t\t(button = new SaveButton({ onclick: () => {\n\t\t\t\t\tif (this.isReady === false)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tbutton.setWaiting(true);\n\t\t\t\t\tthis.isReady = false;\n\t\t\t\t\tEventEmitter.emit(this, Options.eventName('onPresetIsSet'), form.elements[\"userScope\"].value === 'newUser')\n\t\t\t\t\t\t.forEach((promise) => {\n\t\t\t\t\t\t\tpromise\n\t\t\t\t\t\t\t\t.then(() => {\n\t\t\t\t\t\t\t\t\tbutton.setWaiting(false);\n\t\t\t\t\t\t\t\t\tthis.hide();\n\t\t\t\t\t\t\t\t\tPopupManager.create(\"menu-custom-preset-success-popup\", null, {\n\t\t\t\t\t\t\t\t\t\tcloseIcon: true,\n\t\t\t\t\t\t\t\t\t\tcontentColor : \"white\",\n\t\t\t\t\t\t\t\t\t\ttitleBar: Loc.getMessage(\"MENU_CUSTOM_PRESET_POPUP_TITLE\"),\n\t\t\t\t\t\t\t\t\t\tcontent: Loc.getMessage(\"MENU_CUSTOM_PRESET_SUCCESS\")\n\t\t\t\t\t\t\t\t\t}).show();\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t.catch(() => {\n\t\t\t\t\t\t\t\t\tconsole.log('Error!!')\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t})\n\t\t\t\t\t;\n\t\t\t\t\tthis.isReady = true;\n\t\t\t\t}})),\n\t\t\t\tnew CancelButton({ onclick: () => { this.hide();} }),\n\t\t\t]\n\t\t});\n\t}\n}","import {EventEmitter} from 'main.core.events';\nimport Options from \"../options\";\nexport default class AdminPanel\n{\n\tstatic #instance: AdminPanel = null;\n\tcontainer: Element;\n\n\tconstructor()\n\t{\n\t\tthis.container = BX(\"bx-panel\");\n\t\tif (this.container)\n\t\t{\n\t\t\tthis.bindEvents();\n\t\t}\n\t}\n\n\tbindEvents()\n\t{\n\t\tBX.addCustomEvent(\"onTopPanelCollapse\", function(isCollapsed)\n\t\t{\n\t\t\tEventEmitter.emit(this, Options.eventName('onPanelHasChanged'), this.top);\n\t\t}.bind(this));\n\n\t\tBX.addCustomEvent(\"onTopPanelFix\", function() {\n\t\t\tEventEmitter.emit(this, Options.eventName('onPanelHasChanged'), this.top);\n\t\t}.bind(this));\n\t}\n\n\tget height(): number\n\t{\n\t\treturn this.container ? this.container.offsetHeight : 0;\n\t}\n\n\tget fixedHeight(): number\n\t{\n\t\tconst adminPanelState = BX.getClass(\"BX.admin.panel.state\");\n\t\tif (adminPanelState && adminPanelState.fixed)\n\t\t{\n\t\t\treturn this.height;\n\t\t}\n\t\treturn 0;\n\t}\n\n\tget top()\n\t{\n\t\tif (this.container)\n\t\t{\n\t\t\tconst rect = this.container.getBoundingClientRect();\n\n\t\t\tif (rect.bottom > 0)\n\t\t\t{\n\t\t\t\treturn Math.max(rect.bottom, this.fixedHeight);\n\t\t\t}\n\t\t\treturn Math.max(0, this.fixedHeight);\n\t\t}\n\t\treturn 0;\n\t}\n\n\tstatic getInstance()\n\t{\n\t\tif (!this.#instance)\n\t\t{\n\t\t\tthis.#instance = new AdminPanel();\n\t\t}\n\t\treturn this.#instance;\n\t}\n}","import {Loc, Uri} from 'main.core';\nimport AdminPanel from \"./utils/admin-panel\";\n\nexport default class Utils {\n\tstatic #curPage = null;\n\tstatic #curUri = null;\n\n\tstatic getCurPage(): ?String\n\t{\n\t\tif (this.#curPage === null)\n\t\t{\n\t\t\tthis.#curPage = document.location.pathname + document.location.search;\n\t\t}\n\t\treturn this.#curPage === '' ? null : this.#curPage;\n\t}\n\n\tstatic getCurUri(): Uri\n\t{\n\t\tif (this.#curUri === null)\n\t\t{\n\t\t\tthis.#curUri = new Uri(document.location.href);\n\t\t}\n\t\treturn this.#curUri;\n\t}\n\n\tstatic catchError(response) {\n\t\tBX.UI.Notification.Center.notify({\n\t\t\tcontent: [Loc.getMessage(\"MENU_ERROR_OCCURRED\"),\n\t\t\t\t(response.errors ? ': ' + response.errors[0].message : '')].join(' '),\n\t\t\tposition: 'bottom-left',\n\t\t\tcategory: 'menu-self-item-popup',\n\t\t\tautoHideDelay: 3000\n\t\t});\n\t}\n\tstatic refineUrl(url)\n\t{\n\t\turl = String(url).trim();\n\t\tif (url !== '')\n\t\t{\n\t\t\tif (!url.match(/^https?:\\/\\//i) && !url.match(/^\\//i))\n\t\t\t{\n\t\t\t\t//for external links like \"google.com\" (without a protocol)\n\t\t\t\turl = \"http://\" + url;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tvar link = document.createElement(\"a\");\n\t\t\t\tlink.href = url;\n\n\t\t\t\tif (document.location.host === link.host)\n\t\t\t\t{\n\t\t\t\t\t// http://portal.com/path/ => /path/\n\t\t\t\t\turl = link.pathname + link.search + link.hash;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn url;\n\t}\n\n\tstatic get adminPanel(): AdminPanel\n\t{\n\t\treturn AdminPanel.getInstance();\n\t}\n}","import {Loc, Tag} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport {PopupManager} from 'main.popup';\nimport DefaultController from './default-controller';\nimport Options from \"../options\";\nimport Utils from \"../utils\";\nimport {CancelButton, CreateButton} from 'ui.buttons';\nimport {MessageBox, MessageBoxButtons} from \"ui.dialogs.messagebox\";\n\nexport default class PresetDefaultController extends DefaultController\n{\n\tisReady: boolean = true;\n\t#unavailableToolPopup: ?MessageBox;\n\t#mode: string;\n\n\tcreatePopup(mode): Popup\n\t{\n\t\tlet button;\n\t\tthis.#mode = mode;\n\t\tconst content = document.querySelector('#left-menu-preset-popup').cloneNode(true);\n\t\treturn PopupManager.create(\n\t\t\tthis.constructor.name.toString(), null, {\n\t\t\toverlay: true,\n\t\t\tcontentColor : \"white\",\n\t\t\tcontentNoPaddings : true,\n\t\t\tlightShadow: true,\n\t\t\tdraggable: {restrict: true},\n\t\t\tcloseByEsc: true,\n\t\t\toffsetTop: 1,\n\t\t\toffsetLeft: 20,\n\t\t\tcacheable: false,\n\t\t\tcloseIcon: true,\n\t\t\tcontent: content,\n\t\t\tevents: {\n\t\t\t\tonFirstShow: () => {\n\t\t\t\t\t[...content.querySelectorAll('.js-left-menu-preset-item')]\n\t\t\t\t\t\t.forEach((node) => {\n\t\t\t\t\t\t\tnode.addEventListener('click', () => {\n\t\t\t\t\t\t\t\t[...content.querySelectorAll('.js-left-menu-preset-item')]\n\t\t\t\t\t\t\t\t\t.forEach((otherNode) => {\n\t\t\t\t\t\t\t\t\t\totherNode.classList[otherNode === node ? 'add' : 'remove']('left-menu-popup-selected');\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t;\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t})\n\t\t\t\t\t;\n\t\t\t\t}\n\t\t\t},\n\t\t\tbuttons: [\n\t\t\t\t(button = new CreateButton({\n\t\t\t\t\ttext: Loc.getMessage('MENU_CONFIRM_BUTTON'),\n\t\t\t\t\tonclick: () => {\n\t\t\t\t\tif (button.isWaiting())\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tbutton.setWaiting(true);\n\t\t\t\t\tconst currentPreset = this.getSelectedPreset();\n\n\t\t\t\t\tif (!Options.isAdmin && Options.availablePresetTools && Options.availablePresetTools[currentPreset] === false)\n\t\t\t\t\t{\n\t\t\t\t\t\tbutton.setWaiting(false);\n\t\t\t\t\t\tthis.showUnavailableToolPopup();\n\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tEventEmitter.emit(this, Options.eventName('onPresetIsSet'),\n\t\t\t\t\t\t{presetId: currentPreset, mode})\n\t\t\t\t\t\t.forEach((promise) => {\n\t\t\t\t\t\t\tpromise\n\t\t\t\t\t\t\t\t.then((response) => {\n\t\t\t\t\t\t\t\t\tbutton.setWaiting(false);\n\t\t\t\t\t\t\t\t\tthis.hide();\n\t\t\t\t\t\t\t\t\tif (response.data.hasOwnProperty(\"url\"))\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tdocument.location.href = response.data.url;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tdocument.location.reload();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t.catch(Utils.catchError)\n\t\t\t\t\t\t\t;\n\t\t\t\t\t\t})\n\t\t\t\t\t;\n\t\t\t\t}})),\n\t\t\t\tnew CancelButton({\n\t\t\t\t\ttext: Loc.getMessage('MENU_DELAY_BUTTON'),\n\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\tEventEmitter.emit(this, Options.eventName('onPresetIsPostponed'), {mode});\n\t\t\t\t\t\tthis.hide();\n\t\t\t\t\t} }),\n\t\t\t]\n\t\t});\n\t}\n\n\tgetMode(): string\n\t{\n\t\treturn this.#mode;\n\t}\n\n\tgetSelectedPreset()\n\t{\n\t\tlet currentPreset = '';\n\t\tif (document.forms['left-menu-preset-form'])\n\t\t{\n\t\t\t[...document.forms['left-menu-preset-form']\n\t\t\t\t.elements['presetType']]\n\t\t\t\t.forEach((node) => {\n\t\t\t\t\tif (node.checked)\n\t\t\t\t\t{\n\t\t\t\t\t\tcurrentPreset = node.value;\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t;\n\t\t}\n\n\t\treturn currentPreset;\n\t}\n\n\tshowUnavailableToolPopup(): void\n\t{\n\t\tif (!(this.#unavailableToolPopup instanceof MessageBox))\n\t\t{\n\t\t\tthis.#unavailableToolPopup = MessageBox.create({\n\t\t\t\tmessage: Loc.getMessage('MENU_UNAVAILABLE_TOOL_POPUP_DESCRIPTION'),\n\t\t\t\tbuttons: MessageBoxButtons.OK,\n\t\t\t});\n\t\t}\n\n\t\tthis.#unavailableToolPopup.show();\n\t}\n}","import {Loc} from 'main.core';\nimport {Menu, MenuItem} from 'main.popup';\nimport {EventEmitter, BaseEvent} from 'main.core.events';\nimport Options from '../options';\nimport DefaultController from './default-controller';\n\nexport default class SettingsController extends DefaultController\n{\n\tmenuId = 'leftMenuSettingsPopup';\n\n\tcreatePopup()\n\t{\n\t\tconst menu = new Menu({\n\t\t\tbindElement: this.container,\n\t\t\titems: this.getItems(),\n\t\t\tangle: true,\n\t\t\toffsetTop: 0,\n\t\t\toffsetLeft: 50,\n\t\t\t// cacheable: false,\n\t\t});\n\t\treturn menu.getPopupWindow();\n\t}\n\n\tgetItems(): Array\n\t{\n\t\tconst menuItems = [];\n\t\tArray.from(...EventEmitter.emit(this,\n\t\t\tOptions.eventName('onGettingSettingMenuItems'),\n\t\t)).forEach(({text, html, onclick, className}) => {\n\t\t\tif (!text && !html)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tmenuItems.push(Object.assign(html ? {\n\t\t\t\thtml: html\n\t\t\t} : {\n\t\t\t\ttext : text}, {\n\t\t\t\tclassName: [\"menu-popup-no-icon\", className ?? ''].join(' '),\n\t\t\t\tonclick: (event, item) => {\n\t\t\t\t\titem.getMenuWindow().close();\n\t\t\t\t\tonclick(event, item);\n\t\t\t\t}\n\t\t\t}));\n\t\t});\n\t\treturn menuItems;\n\t}\n}","import {ajax, Loc} from 'main.core';\nimport Options from './options';\n\nexport default class Backend {\n\n\tstatic toggleMenu(collapse) {\n\t\tif (Loc.getMessage('USER_ID') <= 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\treturn ajax.runAction(`intranet.leftmenu.${collapse ? \"collapseMenu\" : \"expandMenu\"}`, {\n\t\t\tdata: {},\n\t\t\tanalyticsLabel: { leftmenu: {action: collapse ? \"collapseMenu\" : \"expandMenu\"} }\n\t\t});\n\t}\n\n\tstatic saveSelfItemMenu(itemData) {\n\t\tconst action =  itemData.id > 0 ? \"update\" : \"add\";\n\t\treturn ajax.runAction(`intranet.leftmenu.${action}SelfItem`, {\n\t\t\tdata: {itemData: itemData },\n\t\t\tanalyticsLabel: { leftmenu: {action: 'selfItemAddOrUpdate'} }\n\t\t});\n\t}\n\n\tstatic deleteSelfITem(id) {\n\t\treturn ajax.runAction('intranet.leftmenu.deleteSelfItem', {\n\t\t\tdata: {menuItemId: id},\n\t\t\tanalyticsLabel: {leftmenu: {action: 'selfItemDelete'}}\n\t\t});\n\t}\n\n\tstatic addFavoritesItemMenu(itemData) {\n\t\treturn ajax.runAction('intranet.leftmenu.addStandartItem', {\n\t\t\tdata: { itemData: itemData },\n\t\t\tanalyticsLabel: {leftmenu: {action: 'standardItemAdd'}}\n\t\t});\n\t}\n\n\tstatic deleteFavoritesItemMenu(itemData) {\n\t\treturn ajax.runAction('intranet.leftmenu.deleteStandartItem', {\n\t\t\tdata: { itemData: itemData },\n\t\t\tanalyticsLabel: {leftmenu: {action: 'standardItemDelete'}}\n\t\t});\n\t}\n\n\tstatic updateFavoritesItemMenu(itemData) {\n\t\treturn ajax.runAction('intranet.leftmenu.updateStandartItem', {\n\t\t\tdata: {\n\t\t\t\titemText: itemData.text,\n\t\t\t\titemId: itemData.id,\n\t\t\t},\n\t\t\tanalyticsLabel: {leftmenu: {action: 'standardItemUpdate'}}\n\t\t})\n\t}\n\tstatic addAdminSharedItemMenu(itemData) {\n\t\treturn ajax.runAction('intranet.leftmenu.addItemToAll', {\n\t\t\tdata: { itemInfo: itemData },\n\t\t\tanalyticsLabel: {leftmenu: {action: 'adminItemAdd'}}\n\t\t});\n\t}\n\n\tstatic deleteAdminSharedItemMenu(id) {\n\t\treturn ajax.runAction('intranet.leftmenu.deleteItemFromAll', {\n\t\t\tdata: { menu_item_id: id},\n\t\t\tanalyticsLabel: {leftmenu: {action: 'adminItemDelete'}}\n\t\t});\n\t}\n\n\tstatic saveItemsSort(menuItems, firstItemLink, analyticsLabel)\n\t{\n\t\treturn ajax.runAction('intranet.leftmenu.saveItemsSort', {\n\t\t\tdata: {\n\t\t\t\titems: menuItems,\n\t\t\t\tfirstItemLink: firstItemLink,\n\t\t\t\tversion: Options.version\n\t\t\t},\n\t\t\tanalyticsLabel: {leftmenu: analyticsLabel}\n\t\t});\n\t}\n\n\tstatic setFirstPage(firstPageLink)\n\t{\n\t\treturn ajax.runAction('intranet.leftmenu.setFirstPage', {\n\t\t\tdata: {firstPageUrl: firstPageLink},\n\t\t\tanalyticsLabel: {leftmenu: {action: 'mainPageIsSet'}}\n\t\t})\n\t}\n\n\tstatic setDefaultPreset()\n\t{\n\t\treturn ajax.runAction('intranet.leftmenu.setDefaultMenu', {\n\t\t\tdata: {},\n\t\t\tanalyticsLabel: {leftmenu: {action: 'defaultMenuIsSet'}}\n\t\t});\n\t}\n\n\tstatic setCustomPreset(forNewUsersOnly, itemsSort, customItems, firstItemLink)\n\t{\n\t\treturn ajax.runAction('intranet.leftmenu.saveCustomPreset', {\n\t\t\tdata: {\n\t\t\t\tuserApply: forNewUsersOnly === true ? 'newUser' : 'currentUser',\n\t\t\t\titemsSort: itemsSort,\n\t\t\t\tcustomItems: customItems,\n\t\t\t\tfirstItemLink: firstItemLink,\n\t\t\t\tversion: Options.version\n\t\t\t},\n\t\t\tanalyticsLabel: { leftmenu: {action: 'customPresetIsSet'} }\n\t\t});\n\t}\n\n\tstatic deleteCustomItem(id)\n\t{\n\t\treturn ajax.runAction('intranet.leftmenu.deleteCustomItemFromAll', {\n\t\t\tdata: {menu_item_id: id},\n\t\t\tanalyticsLabel: {leftmenu: {action: 'customItemDelete'}}\n\t\t});\n\t}\n\n\tstatic setSystemPreset(mode, presetId)\n\t{\n\t\treturn ajax.runAction('intranet.leftmenu.setPreset', {\n\t\t\tdata: {\n\t\t\t\tpreset: presetId,\n\t\t\t\tmode: mode === 'global' ? 'global' : 'personal'\n\t\t\t},\n\t\t\tanalyticsLabel: {\n\t\t\t\tleftmenu: {\n\t\t\t\t\taction: 'systemPresetIsSet',\n\t\t\t\t\tpresetId: presetId,\n\t\t\t\t\tmode: mode,\n\t\t\t\t\tanalyticsFirst: mode === 'global' ? 'y' : 'n'\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tstatic postponeSystemPreset(mode)\n\t{\n\t\treturn ajax.runAction('intranet.leftmenu.delaySetPreset', {\n\t\t\tdata: {},\n\t\t\tanalyticsLabel: {\n\t\t\t\tleftmenu: {\n\t\t\t\t\taction: 'systemPresetIsPostponed',\n\t\t\t\t\tmode: mode,\n\t\t\t\t\tanalyticsFirst: mode === 'global' ? 'y' : 'n'\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tstatic clearCache()\n\t{\n\t\treturn ajax.runAction('intranet.leftmenu.clearCache', {\n\t\t\tdata: {},\n\t\t\tanalyticsLabel: { leftmenu: {action: 'clearCache'} }\n\t\t});\n\t}\n\n\tstatic expandGroup(id)\n\t{\n\t\tif (Loc.getMessage('USER_ID') <= 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\treturn ajax.runAction('intranet.leftmenu.expandMenuGroup', {\n\t\t\tdata: {id},\n\t\t\tanalyticsLabel: { leftmenu: {action: 'expandMenuGroup' }}\n\t\t});\n\t}\n\n\tstatic collapseGroup(id)\n\t{\n\t\tif (Loc.getMessage('USER_ID') <= 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\treturn ajax.runAction('intranet.leftmenu.collapseMenuGroup', {\n\t\t\tdata: {id},\n\t\t\tanalyticsLabel: { leftmenu: {action: 'collapseMenuGroup' }}\n\t\t});\n\t}\n}","import {Event, Uri, Type, Loc, Text, Tag} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport {PopupManager, Menu, MenuItem} from 'main.popup';\nimport Options from \"../options\";\nimport Utils from \"../utils\";\nimport {SaveButton, CancelButton} from 'ui.buttons';\n\nexport default class Item\n{\n\tstatic code = 'abstract';\n\n\tparentContainer: Element;\n\tcontainer: Element;\n\tlinks = [];\n\tisDraggable = true;\n\tstorage: Array = [];\n\n\tconstructor(parentContainer, container)\n\t{\n\t\tthis.parentContainer = parentContainer;\n\t\tthis.container = container;\n\t\tthis.init();\n\n\t\tthis.onDeleteAsFavorites = this.onDeleteAsFavorites.bind(this);\n\t\tsetTimeout(() => {\n\t\t\tEventEmitter.subscribe(EventEmitter.GLOBAL_TARGET, Options.eventName('onItemDeleteAsFavorites'), this.onDeleteAsFavorites);\n\t\t\tEventEmitter.incrementMaxListeners(EventEmitter.GLOBAL_TARGET, Options.eventName('onItemDeleteAsFavorites'));\n\t\t\tEventEmitter.subscribe(this, Options.eventName('onItemDelete'), this.destroy.bind(this));\n\t\t}, 0);\n\t\tthis.showError = this.showError.bind(this);\n\t\tthis.showMessage = this.showMessage.bind(this);\n\t}\n\n\tgetId(): string\n\t{\n\t\treturn this.container.dataset.id;\n\t}\n\n\tgetCode(): string\n\t{\n\t\treturn this.constructor.code;\n\t}\n\n\tgetName()\n\t{\n\t\treturn this.container.querySelector(\"[data-role='item-text']\").textContent;\n\t}\n\n\tcanDelete(): boolean\n\t{\n\t\treturn false;\n\t}\n\n\tdelete()\n\t{\n\t\t// Just do it.\n\t}\n\n\tinit()\n\t{\n\t\tthis.links = [];\n\t\tif (\n\t\t\tthis.container.hasAttribute('data-link')\n\t\t\t&& Type.isStringFilled(this.container.getAttribute(\"data-link\"))\n\t\t)\n\t\t{\n\t\t\tthis.links.push(\n\t\t\t\tthis.container.getAttribute(\"data-link\")\n\t\t\t);\n\t\t}\n\n\t\tif (this.container\n\t\t\t.hasAttribute(\"data-all-links\"))\n\t\t{\n\t\t\tthis.container\n\t\t\t\t.getAttribute(\"data-all-links\")\n\t\t\t\t.split(\",\")\n\t\t\t\t.forEach((link) => {\n\t\t\t\t\tlink = String(link).trim();\n\t\t\t\t\tif (Type.isStringFilled(link))\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.links.push(\n\t\t\t\t\t\t\tlink\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t;\n\t\t}\n\t\tthis.makeTextIcons();\n\t\tthis.storage = this.container.dataset.storage.split(',');\n\t}\n\n\tupdate({link, openInNewPage, text})\n\t{\n\t\topenInNewPage = (openInNewPage === 'Y' ? 'Y' : 'N');\n\n\t\tif (this.container.hasAttribute('data-link'))\n\t\t{\n\t\t\tthis.container.setAttribute('data-link', Text.encode(link));\n\t\t\tthis.container.setAttribute('data-new-page', openInNewPage);\n\t\t}\n\n\t\tconst linkNode = this.container.querySelector('a');\n\t\tif (linkNode)\n\t\t{\n\t\t\tif (Type.isString(link))\n\t\t\t{\n\t\t\t\tlinkNode.setAttribute('href', Text.encode(link));\n\t\t\t}\n\n\t\t\tlinkNode.setAttribute('target', openInNewPage === 'Y' ? '_blank' : '_self');\n\t\t}\n\t\tthis.container.querySelector(\"[data-role='item-text']\").innerHTML = Text.encode(text);\n\t\tthis.init();\n\t}\n\n\tdestroy()\n\t{\n\t\tEventEmitter.unsubscribe(EventEmitter.GLOBAL_TARGET, Options.eventName('onItemDeleteAsFavorites'), this.onDeleteAsFavorites);\n\t\tEventEmitter.decrementMaxListeners(EventEmitter.GLOBAL_TARGET, 'onItemDeleteAsFavorites');\n\t}\n\n\tgetSimilarToUrl(currentUri: Uri): Array\n\t{\n\t\tconst result = [];\n\n\t\tthis.links.forEach((link, index) => {\n\t\t\tif (areUrlsEqual(link, currentUri))\n\t\t\t{\n\t\t\t\tresult.push({\n\t\t\t\t\tpriority: index > 0 ? 0 : 1, // main link is in higher priority\n\t\t\t\t\turl: link\n\t\t\t\t})\n\t\t\t}\n\t\t});\n\t\treturn result;\n\t}\n\n\tmakeTextIcons()\n\t{\n\t\tif (!this.container.classList.contains(\"menu-item-no-icon-state\"))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst icon = this.container.querySelector(\".menu-item-icon\");\n\t\tconst text = this.container.querySelector(\".menu-item-link-text\");\n\n\t\tif (icon && text)\n\t\t{\n\t\t\ticon.textContent = getShortName(text.textContent);\n\t\t}\n\t}\n\n\tgetCounterValue(): ?number\n\t{\n\t\tconst node = this.container.querySelector('[data-role=\"counter\"]');\n\t\tif (!node)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\t\treturn parseInt(node.dataset.counterValue);\n\t}\n\n\tupdateCounter(counterValue)\n\t{\n\t\tconst node = this.container.querySelector('[data-role=\"counter\"]');\n\t\tif (!node)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tconst oldValue = parseInt(node.dataset.counterValue) || 0;\n\t\tnode.dataset.counterValue = counterValue;\n\n\t\tif (counterValue > 0)\n\t\t{\n\t\t\tnode.innerHTML = (counterValue > 99 ? '99+' : counterValue);\n\t\t\tthis.container.classList.add('menu-item-with-index');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tnode.innerHTML = '';\n\t\t\tthis.container.classList.remove('menu-item-with-index');\n\t\t\tif (counterValue < 0) // TODO need to know what it means\n\t\t\t{\n\t\t\t\tconst warning = BX('menu-counter-warning-' + this.getId());\n\t\t\t\tif (warning)\n\t\t\t\t{\n\t\t\t\t\twarning.style.display = 'inline-block';\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn {oldValue, newValue: counterValue};\n\t}\n\n\tmarkAsActive()\n\t{\n\t\tconsole.error('This action is only for the group');\n\t}\n\n\tshowWarning(title, events)\n\t{\n\t\tthis.removeWarning();\n\t\tconst link = this.container.querySelector(\"a.menu-item-link\");\n\t\tif (!link)\n\t\t{\n\t\t\treturn\n\t\t}\n\t\ttitle = title ? Text.encode(title) : '';\n\t\tconst node = Tag.render`<a class=\"menu-post-warn-icon\" title=\"${title}\"></a>`;\n\t\tif (events)\n\t\t{\n\t\t\tObject.keys(events).forEach((key) => {\n\t\t\t\tEvent.bind(node, key, events[key]);\n\t\t\t});\n\t\t}\n\t\tthis.container.classList.add(\"menu-item-warning-state\");\n\t\tlink.appendChild(node);\n\t}\n\n\tremoveWarning()\n\t{\n\t\tif (!this.container.classList.contains('menu-item-warning-state'))\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tthis.container.classList.remove('menu-item-warning-state');\n\t\tlet node;\n\t\twhile (node = this.container.querySelector(\"a.menu-post-warn-icon\"))\n\t\t{\n\t\t\tnode.parentNode.removeChild(node);\n\t\t}\n\t}\n\n\tshowMessagePopup;\n\tshowMessage(message)\n\t{\n\t\tif (this.showMessagePopup)\n\t\t{\n\t\t\tthis.showMessagePopup.close();\n\t\t}\n\t\tthis.showMessagePopup = PopupManager.create(\"left-menu-message\", this.container,\n\t\t\t{\n\t\t\t\tcontent: '<div class=\"left-menu-message-popup\">' + message + '</div>',\n\t\t\t\tdarkMode: true,\n\t\t\t\toffsetTop: 2,\n\t\t\t\toffsetLeft: 0,\n\t\t\t\tangle: true,\n\t\t\t\tevents: {\n\t\t\t\t\tonClose: () => { this.showMessagePopup = null;}\n\t\t\t\t},\n\t\t\t\tautoHide: true\n\t\t\t});\n\n\t\tthis.showMessagePopup.show();\n\n\t\tsetTimeout(() => { if (this.showMessagePopup) {this.showMessagePopup.close()} }, 3000);\n\t}\n\n\tshowError(response)\n\t{\n\t\tconst errors = [];\n\t\tif (response.errors)\n\t\t{\n\t\t\terrors.push(response.errors[0].message);\n\t\t}\n\t\telse if (response instanceof TypeError)\n\t\t{\n\t\t\terrors.push(response.message);\n\t\t}\n\n\t\tconst message = [Loc.getMessage(\"MENU_ERROR_OCCURRED\"), ...errors].join(' ');\n\t\tthis.showMessage(message);\n\t}\n\n\tgetDropDownActions(): Array\n\t{\n\t\treturn [];\n\t}\n\n\tgetEditFields(): Object\n\t{\n\t\treturn {id: this.getId(), text: this.getName()};\n\t}\n\n\tonDeleteAsFavorites({data})\n\t{\n\t\tif (String(data.id) === String(this.getId()))\n\t\t{\n\t\t\tif (this.getCode() === 'standard'/* instanceof ItemUserFavorites*/)\n\t\t\t{\n\t\t\t\tEventEmitter.emit(this, Options.eventName('onItemDelete'), {\n\t\t\t\t\titem: this,\n\t\t\t\t\tanimate: true\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.storage = [...this.storage].filter((v) => {return v !== 'standard'});\n\t\t\t\tthis.container.dataset.storage = this.storage.join(',');\n\t\t\t}\n\t\t\tEventEmitter.unsubscribe(EventEmitter.GLOBAL_TARGET, Options.eventName('onItemDeleteAsFavorites'), this.onDeleteAsFavorites);\n\t\t\tEventEmitter.decrementMaxListeners(EventEmitter.GLOBAL_TARGET, Options.eventName('onItemDeleteAsFavorites'));\n\t\t\t}\n\t}\n\n\tstatic detect(node)\n\t{\n\t\treturn node.getAttribute(\"data-role\") !== 'group' &&\n\t\t\tnode.getAttribute(\"data-type\") === this.code;\n\t}\n\n\tstatic createNode({id, text, link, openInNewPage, counterId, counterValue, topMenuId})\n\t{\n\t\tid = Text.encode(id);\n\t\ttext = Text.encode(text);\n\t\tlink = Text.encode(link);\n\t\tcounterId = counterId ? Text.encode(counterId) : '';\n\t\tcounterValue = counterValue ? parseInt(counterValue) : 0;\n\t\topenInNewPage = openInNewPage === 'Y' ? 'Y' : 'N';\n\t\treturn Tag.render`<li \n\t\t\tid=\"bx_left_menu_${id}\" \n\t\t\tdata-status=\"show\" \n\t\t\tdata-id=\"${id}\" \n\t\t\tdata-role=\"item\"\n\t\t\tdata-storage=\"\" \n\t\t\tdata-counter-id=\"${counterId}\" \n\t\t\tdata-link=\"${link}\" \n\t\t\tdata-all-links=\"\" \n\t\t\tdata-type=\"${this.code}\" \n\t\t\tdata-delete-perm=\"Y\" \n\t\t\t${topMenuId ? `data-top-menu-id=\"${Text.encode(topMenuId)}\"` : \"\"}\n\t\t\tdata-new-page=\"${openInNewPage}\" \n\t\t\tclass=\"menu-item-block menu-item-no-icon-state\">\n\t\t\t\t<span class=\"menu-favorites-btn menu-favorites-draggable\">\n\t\t\t\t\t<span class=\"menu-fav-draggable-icon\"></span>\n\t\t\t\t</span>\n\t\t\t\t<a class=\"menu-item-link\" data-slider-ignore-autobinding=\"true\" href=\"${link}\" target=\"${openInNewPage === 'Y' ? '_blank' : '_self'}\">\n\t\t\t\t\t<span class=\"menu-item-icon-box\">\n\t\t\t\t\t\t<span class=\"menu-item-icon\">W</span>\n\t\t\t\t\t</span>\n\t\t\t\t\t<span class=\"menu-item-link-text \" data-role=\"item-text\">${text}</span>\n\t\t\t\t\t${counterId ? \n\t\t\t\t\t`<span class=\"menu-item-index-wrap\">\n\t\t\t\t\t\t<span data-role=\"counter\"\n\t\t\t\t\t\t\tdata-counter-value=\"${counterValue}\" class=\"menu-item-index\" id=\"menu-counter-${counterId}\">${counterValue}</span>\n\t\t\t\t\t</span>` : '' }\n\t\t\t\t</a>\n\t\t\t\t<span data-role=\"item-edit-control\" class=\"menu-fav-editable-btn menu-favorites-btn\">\n\t\t\t\t\t<span class=\"menu-favorites-btn-icon\"></span>\n\t\t\t\t</span>\n\t\t\t</li>`;\n\t}\n\n\t//region Edition for siblings\n\tstatic backendSaveItem(itemInfo): Promise\n\t{\n\t\tthrow 'Function backendSaveItem must be replaced';\n\t}\n\tstatic popup: Popup;\n\tstatic showUpdate(item: Item)\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.showForm(item.container, item.getEditFields(), resolve, reject);\n\t\t});\n\t}\n\tstatic checkForm(form: HTMLFormElement): boolean\n\t{\n\t\tif (String(form.elements[\"text\"].value).trim().length <= 0)\n\t\t{\n\t\t\tform.elements[\"text\"].classList.add('menu-form-input-error');\n\t\t\tform.elements[\"text\"].focus();\n\t\t\treturn false;\n\t\t}\n\t\tif (form.elements[\"link\"])\n\t\t{\n\t\t\tif (String(form.elements[\"link\"].value).trim().length <= 0 ||\n\t\t\t\tUtils.refineUrl(form.elements[\"link\"].value).length <= 0)\n\t\t\t{\n\t\t\t\tform.elements[\"link\"].classList.add('menu-form-input-error');\n\t\t\t\tform.elements[\"link\"].focus();\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tform.elements[\"link\"].value = Utils.refineUrl(form.elements[\"link\"].value);\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t}\n\tstatic showForm(bindElement, itemInfo, resolve, reject)\n\t{\n\t\tif (this.popup)\n\t\t{\n\t\t\tthis.popup.close();\n\t\t}\n\n\t\tconst isEditMode = itemInfo.id !== '';\n\t\tconst form = Tag.render`\n<form name=\"menuAddToFavoriteForm\">\n\t<input type=\"hidden\" name=\"id\" value=\"${Text.encode(itemInfo.id || '')}\">\n\t<label for=\"menuPageToFavoriteName\" class=\"menu-form-label\">${Loc.getMessage(\"MENU_ITEM_NAME\")}</label>\n\t<input name=\"text\" type=\"text\" id=\"menuPageToFavoriteName\" class=\"menu-form-input\" value=\"${Text.encode(itemInfo.text || '')}\" >\n\t${itemInfo['link'] !== undefined ? `<br><br>\n\t<label for=\"menuPageToFavoriteLink\" class=\"menu-form-label\">${Loc.getMessage(\"MENU_ITEM_LINK\")}</label>\n\t<input name=\"link\" id=\"menuPageToFavoriteLink\" type=\"text\" class=\"menu-form-input\" value=\"${Text.encode(itemInfo.link)}\" >` : ''}\n\t${itemInfo['openInNewPage'] !== undefined ? `<br><br>\n\t<input name=\"openInNewPage\" id=\"menuOpenInNewPage\" type=\"checkbox\" value=\"Y\" ${itemInfo.openInNewPage === 'Y' ? 'checked' : ''} >\n\t<label for=\"menuOpenInNewPage\" class=\"menu-form-label\">${Loc.getMessage(\"MENU_OPEN_IN_NEW_PAGE\")}</label>` : ''}\n</form>`;\n\t\tObject.keys(itemInfo)\n\t\t\t.forEach((key) => {\n\t\t\t\tif (['id', 'text', 'link', 'openInNewPage'].indexOf(key) < 0)\n\t\t\t\t{\n\t\t\t\t\tconst name = Text.encode(key);\n\t\t\t\t\tconst value = Text.encode(itemInfo[key]);\n\t\t\t\t\tform.appendChild(\n\t\t\t\t\t\tTag.render`<input type=\"hidden\" name=\"${name}\" value=\"${value}\">`\n\t\t\t\t\t)\n\t\t\t\t}\n\t\t\t})\n\t\t;\n\n\t\tthis.popup = PopupManager.create('menu-self-item-popup', bindElement, {\n\t\t\tclassName: 'menu-self-item-popup',\n\t\t\ttitleBar: (itemInfo['link'] === undefined ? Loc.getMessage(\"MENU_RENAME_ITEM\") : (\n\t\t\t\tisEditMode ? Loc.getMessage(\"MENU_EDIT_SELF_PAGE\") : Loc.getMessage(\"MENU_ADD_SELF_PAGE\")\n\t\t\t)),\n\t\t\toffsetTop: 1,\n\t\t\toffsetLeft: 20,\n\t\t\tcacheable: false,\n\t\t\tcloseIcon: true,\n\t\t\tlightShadow: true,\n\t\t\tdraggable: {restrict: true},\n\t\t\tcloseByEsc: true,\n\t\t\tcontent: form,\n\t\t\tbuttons: [\n\t\t\t\tnew SaveButton({ onclick: () => {\n\t\t\t\t\t\tif (this.checkForm(form))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst itemInfoToSave = {};\n\t\t\t\t\t\t\t[...form.elements].forEach((node) => {\n\t\t\t\t\t\t\t\titemInfoToSave[node.name] = node.value;\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tif (form.elements['openInNewPage'])\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\titemInfoToSave['openInNewPage'] = form.elements[\"openInNewPage\"].checked ? 'Y' : 'N';\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tthis\n\t\t\t\t\t\t\t\t.backendSaveItem(itemInfoToSave)\n\t\t\t\t\t\t\t\t.then(() => {\n\t\t\t\t\t\t\t\t\tresolve(itemInfoToSave);\n\t\t\t\t\t\t\t\t\tthis.popup.close();\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t.catch(Utils.catchError);\n\t\t\t\t\t\t}\n\t\t\t\t\t} } ),\n\t\t\t\tnew CancelButton({ onclick: () => { this.popup.close();} }),\n\t\t\t]\n\t\t});\n\t\tthis.popup.show();\n\t}\n\t//endregion\n}\n\nfunction areUrlsEqual(url, currentUri: Uri)\n{\n\tconst checkedUri = new Uri(url);\n\tconst checkedUrlBrief = checkedUri.getPath().replace('/index.php', '').replace('/index.html', '');\n\n\tconst currentUrlBrief = currentUri.getPath().replace('/index.php', '').replace('/index.html', '');\n\n\tif (\n\t\tcheckedUri.getHost() !== ''\n\t\t&&\n\t\tcheckedUri.getHost() !== currentUri.getHost()\n\t)\n\t{\n\t\treturn false;\n\t}\n\tif (currentUrlBrief.indexOf(checkedUrlBrief) !== 0)\n\t{\n\t\treturn false;\n\t}\n\treturn true;\n}\n\nfunction getShortName(name)\n{\n\tif (!Type.isStringFilled(name))\n\t{\n\t\treturn \"...\";\n\t}\n\n\tname = name.replace(/['`\".,:;~|{}*^$#@&+\\-=?!()[\\]<>\\n\\r]+/g, \"\").trim();\n\tif (name.length <= 0)\n\t{\n\t\treturn '...';\n\t}\n\n\tlet shortName;\n\tlet words = name.split(/[\\s,]+/);\n\tif (words.length <= 1)\n\t{\n\t\tshortName = name.substring(0, 1);\n\t}\n\telse if (words.length === 2)\n\t{\n\t\tshortName = words[0].substring(0, 1) + words[1].substring(0, 1);\n\t}\n\telse\n\t{\n\t\tlet firstWord = words[0];\n\t\tlet secondWord = words[1];\n\n\t\tfor (let i = 1; i < words.length; i++)\n\t\t{\n\t\t\tif (words[i].length > 3)\n\t\t\t{\n\t\t\t\tsecondWord = words[i];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tshortName = firstWord.substring(0, 1) + secondWord.substring(0, 1);\n\t}\n\n\treturn shortName.toUpperCase();\n}\n","import {Loc, Text, Tag} from 'main.core';\nimport {EventEmitter, BaseEvent} from 'main.core.events';\nimport {PopupManager} from 'main.popup'\nimport Item from './item';\nimport Utils from '../utils';\nimport Backend from '../backend';\nimport Options from \"../options\";\nimport ItemAdminShared from \"./item-admin-shared\";\n\nexport default class ItemUserFavorites extends Item\n{\n\tstatic code = 'standard';\n\tstatic #currentPageInTopMenu = null;\n\n\tcanDelete(): boolean\n\t{\n\t\treturn true;\n\t}\n\n\tdelete()\n\t{\n\t\tBackend\n\t\t\t.deleteFavoritesItemMenu({id: this.getId(), storage: this.storage})\n\t\t\t.then(() => {\n\t\t\t\tthis.destroy();\n\t\t\t\tEventEmitter.emit(this, Options.eventName('onItemDelete'), {animate: true});\n\t\t\t\tconst context = this.getSimilarToUrl(\n\t\t\t\t\tUtils.getCurUri()\n\t\t\t\t).length > 0 ? window : {'doesnotmatter': ''};\n\n\t\t\t\tBX.onCustomEvent(\"BX.Bitrix24.LeftMenuClass:onMenuItemDeleted\", [{id: this.getId()}, this]);\n\t\t\t\tBX.onCustomEvent('BX.Bitrix24.LeftMenuClass:onStandardItemChangedSuccess', [{\n\t\t\t\t\tisActive: false,\n\t\t\t\t\tcontext: context\n\t\t\t\t}]);\n\t\t\t});\n\t}\n\n\tgetDropDownActions(): Array\n\t{\n\t\tconst contextMenuItems = [];\n\t\tcontextMenuItems.push({\n\t\t\ttext: Loc.getMessage(\"MENU_RENAME_ITEM\"),\n\t\t\tonclick: () => {\n\t\t\t\tthis.constructor\n\t\t\t\t\t.showUpdate(this)\n\t\t\t\t\t.then(this.update.bind(this))\n\t\t\t\t\t.catch(this.showError);\n\t\t\t}\n\t\t});\n\t\tcontextMenuItems.push({\n\t\t\ttext: Loc.getMessage(\"MENU_REMOVE_STANDARD_ITEM\"),\n\t\t\tonclick: () => {\n\t\t\t\tthis.delete();\n\t\t\t}\n\t\t});\n\n\t\tif (Options.isAdmin)\n\t\t{\n\t\t\tcontextMenuItems.push({\n\t\t\t\ttext: Loc.getMessage(\"MENU_ADD_ITEM_TO_ALL\"),\n\t\t\t\tonclick: () => {\n\t\t\t\t\tconst itemLinkNode = this.container.querySelector('a');\n\t\t\t\t\tBackend\n\t\t\t\t\t\t.addAdminSharedItemMenu({\n\t\t\t\t\t\t\tid: this.getId(),\n\t\t\t\t\t\t\tlink: this.links[0],\n\t\t\t\t\t\t\ttext: this.getName(),\n\t\t\t\t\t\t\tcounterId: this.container.dataset.counterId,\n\t\t\t\t\t\t\topenInNewPage: itemLinkNode && itemLinkNode.getAttribute(\"target\") === \"_blank\" ? \"Y\" : \"N\"\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.then(() => {\n\t\t\t\t\t\t\tthis.showMessage(Loc.getMessage('MENU_ITEM_WAS_ADDED_TO_ALL'));\n\t\t\t\t\t\t\tthis.container.dataset.type = ItemAdminShared.code;\n\t\t\t\t\t\t\tthis.storage.push(ItemUserFavorites.code);\n\t\t\t\t\t\t\tthis.container.dataset.storage = this.storage.join(',');\n\t\t\t\t\t\t\tEventEmitter.emit(this, Options.eventName('onItemConvert'), this);\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.catch(this.showError);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\treturn contextMenuItems;\n\t}\n\n\tstatic backendSaveItem(itemInfoToSave): Promise\n\t{\n\t\treturn Backend.updateFavoritesItemMenu(itemInfoToSave);\n\t}\n\n\tstatic getActiveTopMenuItem()\n\t{\n\t\tif (this.#currentPageInTopMenu)\n\t\t{\n\t\t\treturn this.#currentPageInTopMenu;\n\t\t}\n\n\t\tif (!BX.Main\n\t\t\t|| !BX.Main.interfaceButtonsManager)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst firstTopMenuInstance = Array.from(\n\t\t\tObject.values(\n\t\t\t\tBX.Main.interfaceButtonsManager\n\t\t\t\t\t.getObjects()\n\t\t\t)\n\t\t).shift();\n\n\t\tif (firstTopMenuInstance)\n\t\t{\n\t\t\tconst topMenuItem = firstTopMenuInstance.getActive();\n\n\t\t\tif (topMenuItem && typeof topMenuItem === \"object\")\n\t\t\t{\n\t\t\t\tconst link = document.createElement(\"a\");\n\t\t\t\tlink.href = topMenuItem['URL'];\n\t\t\t\t//IE11 omits slash in the pathname\n\t\t\t\tconst path = link.pathname[0] !== \"/\" ? (\"/\" + link.pathname) : link.pathname;\n\n\t\t\t\tthis.#currentPageInTopMenu = {\n\t\t\t\t\tID: topMenuItem['ID'] || null,\n\t\t\t\t\tNODE: topMenuItem['NODE'] || null,\n\t\t\t\t\tURL: path + link.search,\n\t\t\t\t\tTEXT: topMenuItem['TEXT'],\n\t\t\t\t\tDATA_ID: topMenuItem['DATA_ID'],\n\t\t\t\t\tCOUNTER_ID: topMenuItem['COUNTER_ID'],\n\t\t\t\t\tCOUNTER: topMenuItem['COUNTER'],\n\t\t\t\t\tSUB_LINK: topMenuItem['SUB_LINK'],\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\n\t\treturn this.#currentPageInTopMenu;\n\t}\n\n\tstatic isCurrentPageStandard(topMenuPoint): boolean\n\t{\n\t\tif (topMenuPoint && topMenuPoint['URL'])\n\t\t{\n\t\t\tconst currentFullPath = document.location.pathname + document.location.search;\n\t\t\treturn topMenuPoint.URL === currentFullPath && topMenuPoint.URL.indexOf('workgroups') < 0;\n\t\t}\n\t\treturn false;\n\t}\n\n\tstatic saveCurrentPage({pageTitle, pageLink})\n\t{\n\t\tconst topMenuPoint = this.getActiveTopMenuItem();\n\t\tlet itemInfo, startX, startY;\n\n\t\tif (topMenuPoint\n\t\t\t&& topMenuPoint.NODE\n\t\t\t&& this.isCurrentPageStandard(topMenuPoint)\n\t\t\t&& (pageLink === Utils.getCurPage() || pageLink === topMenuPoint.URL || !pageLink)\n\t\t)\n\t\t{\n\t\t\tconst menuNodeCoord = topMenuPoint.NODE.getBoundingClientRect();\n\t\t\tstartX = menuNodeCoord.left;\n\t\t\tstartY = menuNodeCoord.top;\n\n\t\t\titemInfo = {\n\t\t\t\tid: topMenuPoint.DATA_ID,\n\t\t\t\ttext: pageTitle || topMenuPoint.TEXT,\n\t\t\t\tlink: Utils.getCurPage() || topMenuPoint.URL,\n\t\t\t\tcounterId: topMenuPoint.COUNTER_ID,\n\t\t\t\tcounterValue: topMenuPoint.COUNTER,\n\t\t\t\tisStandardItem: true,\n\t\t\t\tsubLink: topMenuPoint.SUB_LINK\n\t\t\t};\n\t\t}\n\t\telse\n\t\t{\n\t\t\titemInfo = {\n\t\t\t\ttext: pageTitle || document.getElementById('pagetitle').innerText,\n\t\t\t\tlink: pageLink || Utils.getCurPage(),\n\t\t\t\tisStandardItem: pageLink === Utils.getCurPage()\n\t\t\t};\n\t\t\tconst titleCoord = BX(\"pagetitle\").getBoundingClientRect();\n\t\t\tstartX = titleCoord.left;\n\t\t\tstartY = titleCoord.top\n\t\t}\n\n\t\treturn Backend\n\t\t\t.addFavoritesItemMenu(itemInfo)\n\t\t\t.then(({data: {itemId}}) => {\n\t\t\t\titemInfo.id = itemId;\n\t\t\t\titemInfo.topMenuId = itemInfo.id;\n\t\t\t\treturn {node: this.createNode(itemInfo), animateFromPoint: {startX, startY}, itemInfo: itemInfo};\n\t\t\t})\n\t\t;\n\t}\n\n\tstatic deleteCurrentPage({pageLink})\n\t{\n\t\tconst topPoint = this.getActiveTopMenuItem();\n\n\t\tvar itemInfo = {}, startX, startY;\n\n\t\tif (topPoint && this.isCurrentPageStandard(topPoint))\n\t\t{\n\t\t\titemInfo['id'] = topPoint.DATA_ID;\n\n\t\t\tconst menuNodeCoord = topPoint.NODE.getBoundingClientRect();\n\t\t\tstartX = menuNodeCoord.left;\n\t\t\tstartY = menuNodeCoord.top;\n\t\t}\n\t\telse\n\t\t{\n\t\t\titemInfo['link'] = pageLink || Utils.getCurPage();\n\t\t\tconst titleCoord = BX(\"pagetitle\").getBoundingClientRect();\n\t\t\tstartX = titleCoord.left;\n\t\t\tstartY = titleCoord.top\n\t\t}\n\t\treturn Backend\n\t\t\t.deleteFavoritesItemMenu(itemInfo)\n\t\t\t.then(({data}) => {\n\t\t\t\tif (!itemInfo.id && data && data['itemId'])\n\t\t\t\t{\n\t\t\t\t\titemInfo.id = data['itemId'];\n\t\t\t\t}\n\t\t\t\tEventEmitter.emit(EventEmitter.GLOBAL_TARGET, Options.eventName('onItemDeleteAsFavorites'), {id: itemInfo.id});\n\t\t\t\treturn {itemInfo: itemInfo, animateToPoint: {startX, startY}};\n\t\t\t});\n\t}\n\n\tstatic saveStandardPage({DATA_ID, TEXT, SUB_LINK, COUNTER_ID, COUNTER, NODE, URL})\n\t{\n\t\tconst itemInfo = {\n\t\t\tid: DATA_ID,\n\t\t\ttext: TEXT,\n\t\t\tlink: URL,\n\t\t\tsubLink: SUB_LINK,\n\t\t\tcounterId: COUNTER_ID,\n\t\t\tcounterValue: COUNTER\n\t\t};\n\n\t\tconst pos = NODE.getBoundingClientRect();\n\t\tconst startX = pos.left;\n\t\tconst startY = pos.top\n\t\treturn Backend\n\t\t\t.addFavoritesItemMenu(itemInfo)\n\t\t\t.then(({data: {itemId}}) => {\n\t\t\t\titemInfo.id = itemId;\n\t\t\t\titemInfo.topMenuId = itemInfo.id;\n\n\t\t\t\tconst topPoint = this.getActiveTopMenuItem();\n\t\t\t\tBX.onCustomEvent(\"BX.Bitrix24.LeftMenuClass:onMenuItemAdded\", [itemInfo, this]);\n\t\t\t\tBX.onCustomEvent('BX.Bitrix24.LeftMenuClass:onStandardItemChangedSuccess', [{\n\t\t\t\t\tisActive: true,\n\t\t\t\t\tcontext: topPoint && topPoint.DATA_ID === DATA_ID ? window : null,\n\t\t\t\t}]);\n\n\t\t\t\treturn {node: this.createNode(itemInfo), animateFromPoint: {startX, startY}};\n\t\t\t})\n\t\t;\n\t}\n\n\tstatic deleteStandardPage({DATA_ID})\n\t{\n\t\tconst itemInfo = {id: DATA_ID};\n\t\treturn Backend\n\t\t\t.deleteFavoritesItemMenu(itemInfo)\n\t\t\t.then(() => {\n\t\t\t\tEventEmitter.emit(EventEmitter.GLOBAL_TARGET, Options.eventName('onItemDeleteAsFavorites'), {id: itemInfo.id});\n\t\t\t\tBX.onCustomEvent(\"BX.Bitrix24.LeftMenuClass:onMenuItemDeleted\", [itemInfo, this]);\n\t\t\t\tBX.onCustomEvent('BX.Bitrix24.LeftMenuClass:onStandardItemChangedSuccess', [{\n\t\t\t\t\tisActive: false,\n\t\t\t\t}]);\n\t\t\t\treturn {itemInfo: itemInfo};\n\t\t\t});\n\t}\n}\n","import {Loc, Text} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport Item from './item';\nimport Backend from \"../backend\";\nimport Options from \"../options\";\nimport {MessageBox} from 'ui.dialogs.messagebox';\nimport ItemUserFavorites from \"./item-user-favorites\";\nimport ItemAdminShared from \"./item-admin-shared\";\n\nexport default class ItemUserSelf extends Item\n{\n\tstatic code = 'self';\n\n\tcanDelete(): boolean\n\t{\n\t\treturn true;\n\t}\n\n\tdelete()\n\t{\n\t\treturn Backend\n\t\t\t.deleteSelfITem(this.getId())\n\t\t\t.then(() => {\n\t\t\t\tif (this.storage.indexOf(ItemUserFavorites.code) >= 0)\n\t\t\t\t{\n\t\t\t\t\tBackend.deleteFavoritesItemMenu({id: this.getId()});\n\t\t\t\t}\n\t\t\t\tEventEmitter.emit(this, Options.eventName('onItemDelete'), {animate: true});\n\t\t\t})\n\t\t\t.catch(this.showError)\n\t\t;\n\t}\n\n\tgetDropDownActions(): Array\n\t{\n\t\tconst contextMenuItems = [];\n\t\tcontextMenuItems.push({\n\t\t\ttext: Loc.getMessage(\"MENU_EDIT_ITEM\"),\n\t\t\tonclick: () => {\n\t\t\t\tthis.constructor\n\t\t\t\t\t.showUpdate(this)\n\t\t\t\t\t.then(this.update.bind(this))\n\t\t\t\t\t.catch(this.showError);\n\t\t\t}\n\t\t});\n\t\tcontextMenuItems.push({\n\t\t\ttext: Loc.getMessage('MENU_DELETE_SELF_ITEM'),\n\t\t\tonclick: () => {\n\t\t\t\tMessageBox.confirm(\n\t\t\t\t\tLoc.getMessage('MENU_DELETE_SELF_ITEM_CONFIRM'),\n\t\t\t\t\tLoc.getMessage('MENU_DELETE_SELF_ITEM'),\n\t\t\t\t\t(messageBox) => {\n\t\t\t\t\t\tthis.delete();\n\t\t\t\t\t\tmessageBox.close();\n\t\t\t\t\t},\n\t\t\t\t\tLoc.getMessage('MENU_DELETE'),\n\t\t\t\t);\n\t\t\t}\n\t\t});\n\t\tif (Options.isAdmin)\n\t\t{\n\t\t\tcontextMenuItems.push({\n\t\t\t\ttext: Loc.getMessage(\"MENU_ADD_ITEM_TO_ALL\"),\n\t\t\t\tonclick: () => {\n\t\t\t\t\tconst itemLinkNode = this.container.querySelector('a');\n\t\t\t\t\tBackend\n\t\t\t\t\t\t.addAdminSharedItemMenu({\n\t\t\t\t\t\t\tid: this.getId(),\n\t\t\t\t\t\t\tlink: this.links[0],\n\t\t\t\t\t\t\ttext: this.getName(),\n\t\t\t\t\t\t\tcounterId: this.container.dataset.counterId,\n\t\t\t\t\t\t\topenInNewPage: itemLinkNode && itemLinkNode.getAttribute(\"target\") === \"_blank\" ? \"Y\" : \"N\"\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.then(() => {\n\t\t\t\t\t\t\tthis.showMessage(Loc.getMessage('MENU_ITEM_WAS_ADDED_TO_ALL'));\n\t\t\t\t\t\t\tthis.container.dataset.type = ItemAdminShared.code;\n\t\t\t\t\t\t\tthis.storage.push(ItemUserSelf.code);\n\t\t\t\t\t\t\tthis.container.dataset.storage = this.storage.join(',');\n\t\t\t\t\t\t\tEventEmitter.emit(this, Options.eventName('onItemConvert'), this);\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.catch(this.showError);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\treturn contextMenuItems;\n\t}\n\n\tgetEditFields(): Object\n\t{\n\t\treturn {id: this.getId(), text: this.getName(), link: this.links[0],  openInNewPage: this.container.getAttribute('data-new-page')};\n\t}\n\n\tstatic backendSaveItem(itemInfo): Promise\n\t{\n\t\treturn Backend.saveSelfItemMenu(itemInfo)\n\t\t\t.then(({data}) => {\n\t\t\t\tif (data && data['itemId'])\n\t\t\t\t{\n\t\t\t\t\titemInfo.id = data['itemId'];\n\t\t\t\t}\n\t\t\t\treturn itemInfo;\n\t\t\t});\n\t}\n\n\tstatic showAdd(bindElement)\n\t{\n\t\treturn new Promise((resolve1, reject2) => {\n\t\t\tthis.showForm(\n\t\t\t\tbindElement,\n\t\t\t\t{id: 0, name: '', link: '', openInNewPage: 'Y'},\n\t\t\t\tresolve1, reject2\n\t\t\t)\n\t\t})\n\t\t.then((itemInfo) => {\n\t\t\treturn {node: this.createNode(itemInfo)}\n\t\t});\n\t}\n}\n\n","import {Tag, Loc} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport Item from './item';\nimport Backend from \"../backend\";\nimport Options from \"../options\";\nimport ItemUserFavorites from \"./item-user-favorites\";\nimport ItemUserSelf from \"./item-user-self\";\nimport Utils from \"../utils\";\n\nexport default class ItemAdminShared extends Item\n{\n\tstatic code = 'admin';\n\n\tcanDelete(): boolean\n\t{\n\t\treturn this.container.dataset.deletePerm === 'Y';\n\t}\n\n\tdelete()\n\t{\n\t\tBackend\n\t\t\t.deleteAdminSharedItemMenu(this.getId())\n\t\t\t.then(() => {\n\t\t\t\tif (this.storage.indexOf(ItemUserFavorites.code) >= 0)\n\t\t\t\t{\n\t\t\t\t\tBackend.deleteFavoritesItemMenu({id: this.getId()});\n\t\t\t\t}\n\t\t\t\tif (this.storage.indexOf(ItemUserSelf.code) >= 0)\n\t\t\t\t{\n\t\t\t\t\tBackend.deleteSelfITem(this.getId());\n\t\t\t\t}\n\t\t\t\tEventEmitter.emit(this, Options.eventName('onItemDelete'), {animate: true});\n\t\t\t})\n\t\t\t.catch(this.showError)\n\t\t;\n\t}\n\n\tgetDropDownActions(): Array\n\t{\n\t\tif (!this.canDelete())\n\t\t{\n\t\t\treturn [];\n\t\t}\n\n\t\tconst contextMenuItems = [];\n/*\t\tcontextMenuItems.push({\n\t\t\ttext: Loc.getMessage(\"MENU_RENAME_ITEM\"),\n\t\t\tonclick: () => {\n\t\t\t\tthis.constructor\n\t\t\t\t\t.showUpdate(this)\n\t\t\t\t\t.then(this.update.bind(this))\n\t\t\t\t\t.catch(this.showError.bind(this));\n\t\t\t}\n\t\t});\n*/\n\n\t\tif (this.storage.filter((value) => {return value === ItemUserFavorites.code || value === ItemUserSelf.code;}).length > 0)\n\t\t{\n\t\t\tcontextMenuItems.push({\n\t\t\t\ttext: Loc.getMessage('MENU_REMOVE_STANDARD_ITEM'),\n\t\t\t\tonclick: this.delete.bind(this)\n\t\t\t});\n\t\t\tcontextMenuItems.push({\n\t\t\t\ttext: Loc.getMessage('MENU_DELETE_CUSTOM_ITEM_FROM_ALL'),\n\t\t\t\tonclick: () => {\n\t\t\t\t\tBackend\n\t\t\t\t\t\t.deleteAdminSharedItemMenu(this.getId())\n\t\t\t\t\t\t.then(() => {\n\t\t\t\t\t\t\tthis.showMessage(Loc.getMessage('MENU_ITEM_WAS_DELETED_FROM_ALL'));\n\t\t\t\t\t\t\tconst codeToConvert = this.storage.indexOf(ItemUserSelf.code) >= 0 ? ItemUserSelf.code : ItemUserFavorites.code;\n\t\t\t\t\t\t\tthis.container.dataset.type = codeToConvert;\n\t\t\t\t\t\t\tthis.container.dataset.storage = this.storage.filter((v) => {return v !== codeToConvert}).join(',');\n\t\t\t\t\t\t\tEventEmitter.emit(this, Options.eventName('onItemConvert'), this);\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.catch(this.showError);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tcontextMenuItems.push({\n\t\t\t\ttext: Loc.getMessage(\"MENU_DELETE_CUSTOM_ITEM_FROM_ALL\"),\n\t\t\t\tonclick: this.delete.bind(this)\n\t\t\t});\n\t\t}\n\t\treturn contextMenuItems;\n\t}\n}","import {Loc} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport Item from './item';\nimport Backend from \"../backend\";\nimport Options from \"../options\";\nimport ItemUserFavorites from \"./item-user-favorites\";\n\nexport default class ItemAdminCustom extends Item\n{\n\tstatic code = 'custom';\n\n\tcanDelete(): boolean\n\t{\n\t\treturn this.container.dataset.deletePerm === 'Y';\n\t}\n\n\tdelete()\n\t{\n\t\tif (this.canDelete())\n\t\t{\n\t\t\tBackend\n\t\t\t\t.deleteCustomItem(this.getId())\n\t\t\t\t.then(() => {\n\t\t\t\t\tif (this.storage.indexOf(ItemUserFavorites.code) >= 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tBackend.deleteFavoritesItemMenu({id: this.getId()});\n\t\t\t\t\t}\n\t\t\t\t\tEventEmitter.emit(this, Options.eventName('onItemDelete'), {animate: true});\n\t\t\t\t})\n\t\t\t\t.catch(this.showError)\n\t\t\t;\n\t\t}\n\t}\n\n\tgetDropDownActions(): Array\n\t{\n\t\tconst actions = [];\n\t\tif (this.canDelete())\n\t\t{\n\t\t\tactions.push({\n\t\t\t\ttext: Loc.getMessage(\"MENU_DELETE_ITEM_FROM_ALL\"),\n\t\t\t\tonclick: this.delete.bind(this)\n\t\t\t});\n\t\t}\n\t\treturn actions;\n\t}\n}","import Item from './item';\n\nexport class ItemMainPage extends Item\n{\n\tstatic code = 'main';\n\n\tcanDelete(): boolean\n\t{\n\t\treturn false;\n\t}\n\n\topenSettings(): void\n\t{\n\t\tBX.SidePanel.Instance.open('/settings/configs/?analyticContext=left_menu&page=mainpage');\n\t}\n}\n","import Item from './item';\n\nexport default class ItemSystem extends Item\n{\n\tstatic code = 'default';\n\n\tcanDelete(): boolean\n\t{\n\t\treturn false;\n\t}\n}\n","import Item from './item';\nimport Backend from '../backend';\nimport { Dom, Text } from 'main.core';\n\nexport default class ItemGroup extends Item\n{\n\tstatic code = 'group';\n\tgroupContainer: Element;\n\n\tconstructor()\n\t{\n\t\tsuper(...arguments);\n\t\tthis.container.addEventListener('click', this.toggleAndSave.bind(this), true);\n\t\tthis.container.addEventListener('mouseleave', () => {\n\t\t\tDom.removeClass(this.container, 'menu-item-group-actioned');\n\t\t});\n\t\tthis.groupContainer = this.container.parentNode.querySelector(`[data-group-id=\"${this.getId()}\"]`);\n\t\tif (this.container.getAttribute('data-collapse-mode') === 'collapsed')\n\t\t{\n\t\t\tthis.groupContainer.style.display = 'none';\n\t\t}\n\t\tsetTimeout(() => {\n\t\t\tthis.updateCounter();\n\t\t}, 0);\n\t}\n\n\ttoggleAndSave(event)\n\t{\n\t\tevent.preventDefault();\n\t\tevent.stopPropagation();\n\t\tif (this.container.getAttribute('data-collapse-mode') === 'collapsed')\n\t\t{\n\t\t\tBackend.expandGroup(this.getId());\n\t\t\tthis\n\t\t\t\t.expand()\n\t\t\t\t.then(() => {\n\t\t\t\t\tthis.container.setAttribute('data-collapse-mode', 'expanded');\n\t\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tBackend.collapseGroup(this.getId());\n\t\t\tthis\n\t\t\t\t.collapse()\n\t\t\t\t.then(() => {\n\t\t\t\t\tthis.container.setAttribute('data-collapse-mode', 'collapsed');\n\t\t\t\t});\n\t\t}\n\t\treturn false;\n\t}\n\n\tcheckAndCorrect(): ItemGroup\n\t{\n\t\tconst groupContainer = this.groupContainer;\n\n\t\tif (groupContainer.parentNode === this.container)\n\t\t{\n\t\t\tDom.insertAfter(groupContainer, this.container);\n\t\t}\n\t\t[...groupContainer\n\t\t\t.querySelectorAll(`.menu-item-block`)\n\t\t].forEach((node) => {\n\t\t\tnode.setAttribute('data-status', this.container.getAttribute(\"data-status\"));\n\t\t});\n\t\treturn this;\n\t}\n\n\t#collapsingAnimation;\n\tcollapse(hideGroupContainer): Promise\n\t{\n\t\treturn new Promise((resolve) => {\n\t\t\tconst groupContainer = this.groupContainer;\n\n\t\t\tif (this.#collapsingAnimation)\n\t\t\t{\n\t\t\t\tthis.#collapsingAnimation.stop();\n\t\t\t}\n\n\t\t\tgroupContainer.style.overflow = 'hidden';\n\t\t\tDom.addClass(this.container, 'menu-item-group-collapsing');\n\t\t\tDom.addClass(this.container, 'menu-item-group-actioned');\n\t\t\tDom.addClass(groupContainer, 'menu-item-group-collapsing');\n\t\t\tconst slideParams = {\n\t\t\t\theight: groupContainer.offsetHeight,\n\t\t\t\tdisplay: groupContainer.style.display\n\t\t\t};\n\n\t\t\tthis.#collapsingAnimation = (new BX.easing({\n\t\t\t\tduration: 500,\n\t\t\t\tstart: {height: slideParams.height, opacity: 100},\n\t\t\t\tfinish: {height: 0, opacity: 0},\n\t\t\t\ttransition: BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\t\tstep: function (state) {\n\t\t\t\t\tgroupContainer.style.height = state.height + 'px';\n\t\t\t\t\tgroupContainer.style.opacity = state.opacity / 100;\n\t\t\t\t},\n\t\t\t\tcomplete: () => {\n\t\t\t\t\tgroupContainer.style.display = 'none';\n\t\t\t\t\tgroupContainer.style.opacity = 'auto';\n\t\t\t\t\tgroupContainer.style.height = 'auto';\n\n\t\t\t\t\tif (this.container.getAttribute('data-contains-active-item') === 'Y')\n\t\t\t\t\t{\n\t\t\t\t\t\tDom.addClass(this.container, 'menu-item-active');\n\t\t\t\t\t}\n\t\t\t\t\tDom.removeClass(this.container, 'menu-item-group-collapsing');\n\t\t\t\t\tDom.removeClass(groupContainer, 'menu-item-group-collapsing');\n\t\t\t\t\tthis.#collapsingAnimation = null;\n\t\t\t\t\tif (hideGroupContainer === true)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.container.appendChild(groupContainer);\n\t\t\t\t\t}\n\t\t\t\t\tresolve();\n\t\t\t\t}\n\t\t\t}));\n\t\t\tthis.#collapsingAnimation.animate();\n\t\t});\n\t}\n\n\texpand(checkAttribute): Promise\n\t{\n\t\treturn new Promise((resolve) => {\n\t\t\tconst container = this.container;\n\t\t\tconst groupContainer = this.groupContainer;\n\n\t\t\tif (checkAttribute === true\n\t\t\t\t&& container.getAttribute('data-collapse-mode') === 'collapsed')\n\t\t\t{\n\t\t\t\treturn resolve();\n\t\t\t}\n\t\t\tconst contentHeight = groupContainer.querySelectorAll('li').length * container.offsetHeight;\n\t\t\tDom.addClass(container, 'menu-item-group-expanding');\n\t\t\tDom.addClass(container, 'menu-item-group-actioned');\n\t\t\tDom.addClass(groupContainer, 'menu-item-group-expanding');\n\n\t\t\tif (groupContainer.parentNode === this.container)\n\t\t\t{\n\t\t\t\tDom.insertAfter(groupContainer, this.container);\n\t\t\t}\n\n\t\t\tgroupContainer.style.display = 'block';\n\t\t\tthis.#collapsingAnimation = (new BX.easing({\n\t\t\t\tduration: 500,\n\t\t\t\tstart: {height: 0, opacity: 0},\n\t\t\t\tfinish: {height: contentHeight, opacity: 100},\n\t\t\t\ttransition: BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\t\tstep: function (state) {\n\t\t\t\t\tgroupContainer.style.height = state.height + 'px';\n\t\t\t\t\tgroupContainer.style.opacity = state.opacity / 100;\n\t\t\t\t},\n\t\t\t\tcomplete: function () {\n\t\t\t\t\tDom.removeClass(container, 'menu-item-group-expanding menu-item-active');\n\t\t\t\t\tDom.removeClass(groupContainer, 'menu-item-group-expanding');\n\t\t\t\t\tgroupContainer.style.height = 'auto';\n\t\t\t\t\tgroupContainer.style.opacity = 'auto';\n\t\t\t\t\tresolve();\n\t\t\t\t}\n\t\t\t}));\n\t\t\tthis.#collapsingAnimation.animate();\n\t\t});\n\t}\n\n\tcanDelete(): boolean\n\t{\n\t\treturn false;\n\t}\n\n\tupdateCounter()\n\t{\n\t\tlet counterValue = 0;\n\t\t[...this.container\n\t\t\t.parentNode\n\t\t\t.querySelector(`[data-group-id=\"${this.getId()}\"]`)\n\t\t\t.querySelectorAll('[data-role=\"counter\"]')]\n\t\t\t.forEach((node) => {\n\t\t\t\tcounterValue += Text.toNumber(node.dataset.counterValue);\n\t\t\t});\n\t\tconst node = this.container.querySelector('[data-role=\"counter\"]');\n\n\t\tif (counterValue > 0)\n\t\t{\n\t\t\tnode.innerHTML = (counterValue > 99 ? '99+' : counterValue);\n\t\t\tthis.container.classList.add('menu-item-with-index');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tnode.innerHTML = '';\n\t\t\tthis.container.classList.remove('menu-item-with-index');\n\t\t}\n\t}\n\n\tmarkAsActive()\n\t{\n\t\tthis.container.setAttribute('data-contains-active-item', 'Y');\n\t\tif (this.container.getAttribute('data-collapse-mode') === 'collapsed')\n\t\t\tDom.addClass(this.container, 'menu-item-active');\n\t}\n\n\tmarkAsInactive()\n\t{\n\t\tthis.container.removeAttribute('data-contains-active-item');\n\t\tDom.removeClass(this.container, 'menu-item-active');\n\t}\n\n\tisActive()\n\t{\n\t\treturn this.container.getAttribute('data-contains-active-item') === 'Y';\n\t}\n\n\tstatic detect(node)\n\t{\n\t\treturn node.getAttribute(\"data-role\") === 'group' &&\n\t\t\tnode.getAttribute(\"data-type\") === this.code;\n\t}\n}\n","import {Uri, Type} from 'main.core';\nimport {EventEmitter} from 'main.core.event';\nimport ItemGroup from './item-group';\n\nexport default class ItemGroupSystem extends ItemGroup\n{\n\tconstructor() {\n\t\tsuper(...arguments);\n\n\t\tthis.container\n\t\t\t.querySelector('[data-role=\"item-edit-control\"]')\n\t\t\t.style.display = 'none';\n\t}\n\tstatic code = 'system_group';\n}\n","import Item from './item';\nimport ItemAdminShared from './item-admin-shared';\nimport ItemAdminCustom from './item-admin-custom';\nimport { ItemMainPage } from './item-main-page';\nimport ItemUserFavorites from './item-user-favorites';\nimport ItemUserSelf from './item-user-self';\nimport ItemSystem from './item-system';\nimport ItemGroup from './item-group';\nimport ItemGroupSystem from './item-group-system';\n\nconst itemMappings = [\n\tItem,\n\tItemAdminShared,\n\tItemUserFavorites,\n\tItemAdminCustom,\n\tItemUserSelf,\n\tItemSystem,\n\tItemGroup,\n\tItemGroupSystem,\n\tItemMainPage,\n];\n\nexport default function getItem(itemData): Item\n{\n\tlet itemClassName = Item;\n\titemMappings.forEach((itemClass) => {\n\t\tif (itemClass.detect(itemData))\n\t\t{\n\t\t\titemClassName = itemClass;\n\t\t}\n\t});\n\treturn itemClassName;\n}","import {Runtime, Uri} from 'main.core';\nimport Item from './item'\nimport ItemSystem from './item-system'\ntype ActiveLink = {\n\tpriority: number,\n\turl: string,\n\turi: Uri\n};\nexport default class ItemActive\n{\n\titem: ?Item;\n\t#link: ?ActiveLink;\n\t#actualLink: Uri;\n\n\tconstructor()\n\t{\n\t\tthis.#actualLink = new Uri(window.location.href);\n\t}\n\n\tcheckAndSet(item: Item, links: Array): boolean\n\t{\n\t\t/*\n\t\tCustom items have more priority than standard items.\n\t\tExample:\n\t\t\tCalendar (standard item)\n\t\t\t\tdata-link=\"/company/personal/user/1/calendar/\"\n\t\t\t\tdata-all-links=\"/company/personal/user/1/calendar/,/calendar/\n\n\t\t\tCompany Calendar (custom item)\n\t\t\t\t data-link=\"/calendar/\"\n\n\t\tWe've got two items with the identical link /calendar/'.\n\t\t*/\n\t\tif (item === this.item)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tlet theMostOfTheLinks = this.#link;\n\t\tlinks.forEach((link) => {\n\t\t\tconst linkUri = new Uri(link.url);\n\t\t\tlet changeActiveItem = false;\n\t\t\tif (!theMostOfTheLinks\n\t\t\t\t||\n\t\t\t\ttheMostOfTheLinks.uri.getPath().length < linkUri.getPath().length)\n\t\t\t{\n\t\t\t\tchangeActiveItem = true;\n\t\t\t}\n\t\t\telse if (theMostOfTheLinks.uri.getPath().length === linkUri.getPath().length)\n\t\t\t{\n\t\t\t\tconst actualParams = this.#actualLink.getQueryParams();\n\t\t\t\tconst maxCount = Object.keys(actualParams).length;\n\t\t\t\tconst theMostOfTheLinkServiceData = {\n\t\t\t\t\tparams: theMostOfTheLinks.uri.getQueryParams(),\n\t\t\t\t\tmismatches: maxCount\n\t\t\t\t};\n\t\t\t\tconst comparedLinkParams = {\n\t\t\t\t\tparams: linkUri.getQueryParams(),\n\t\t\t\t\tmismatches: maxCount\n\t\t\t\t};\n\t\t\t\tArray.from(\n\t\t\t\t\tObject.keys(actualParams)\n\t\t\t\t).forEach((key) => {\n\t\t\t\t\tif (String(actualParams[key]) === String(theMostOfTheLinkServiceData.params[key]))\n\t\t\t\t\t{\n\t\t\t\t\t\ttheMostOfTheLinkServiceData.mismatches--;\n\t\t\t\t\t}\n\t\t\t\t\tif (String(actualParams[key]) === String(comparedLinkParams.params[key]))\n\t\t\t\t\t{\n\t\t\t\t\t\tcomparedLinkParams.mismatches--;\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tif (link.priority > 0 && item instanceof ItemSystem)\n\t\t\t\t{\n\t\t\t\t\tlink.priority += 1;\n\t\t\t\t}\n\n\t\t\t\tif (theMostOfTheLinkServiceData.mismatches > comparedLinkParams.mismatches\n\t\t\t\t\t|| theMostOfTheLinks.priority < link.priority)\n\t\t\t\t{\n\t\t\t\t\tchangeActiveItem = true;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (changeActiveItem)\n\t\t\t{\n\t\t\t\ttheMostOfTheLinks = {\n\t\t\t\t\tpriority: link.priority,\n\t\t\t\t\turl: link.url,\n\t\t\t\t\turi: linkUri,\n\t\t\t\t};\n\t\t\t}\n\t\t});\n\n\t\tif (theMostOfTheLinks !== this.#link)\n\t\t{\n\t\t\tif (this.item)\n\t\t\t{\n\t\t\t\tthis.unhighlight(this.item);\n\t\t\t}\n\t\t\tthis.#link = theMostOfTheLinks;\n\t\t\tthis.item = item;\n\n\t\t\tthis.highlight();\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tcheckAndUnset(item: Item)\n\t{\n\t\tif (item instanceof Item && item === this.item)\n\t\t{\n\t\t\tthis.unhighlight(this.item);\n\t\t\tthis.item = null;\n\t\t\tthis.#link = null;\n\t\t}\n\t}\n\n\thighlight()\n\t{\n\t\tif (this.item)\n\t\t{\n\t\t\tthis.item.container.classList.add('menu-item-active');\n\n\t\t\tlet parent = this.item.container.closest('[data-role=\"group-content\"]');\n\t\t\tlet parentContainer;\n\t\t\twhile (parent)\n\t\t\t{\n\t\t\t\tparentContainer = parent.parentNode.querySelector(`[data-id=\"${parent.getAttribute('data-group-id')}\"]`);\n\t\t\t\tif (parentContainer)\n\t\t\t\t{\n\t\t\t\t\tparentContainer.setAttribute('data-contains-active-item', 'Y');\n\t\t\t\t\tif (parentContainer.getAttribute('data-collapse-mode') === 'collapsed')\n\t\t\t\t\t{\n\t\t\t\t\t\tparentContainer.classList.add('menu-item-active');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tparent = parent.closest('[data-relo=\"group-content\"]');\n\t\t\t}\n\t\t}\n\t}\n\n\tunhighlight(item: ?Item): ?Item\n\t{\n\t\tif (!(item instanceof Item))\n\t\t{\n\t\t\titem = this.item;\n\t\t}\n\t\tif (item instanceof Item)\n\t\t{\n\t\t\titem.container.classList.remove('menu-item-active');\n\t\t\tlet parent = item.container.closest('[data-role=\"group-content\"]');\n\t\t\tlet parentContainer;\n\t\t\twhile (parent)\n\t\t\t{\n\t\t\t\tparentContainer = parent.parentNode.querySelector(`[data-id=\"${parent.getAttribute('data-group-id')}\"]`);\n\t\t\t\tif (parentContainer)\n\t\t\t\t{\n\t\t\t\t\tparentContainer.removeAttribute('data-contains-active-item');\n\t\t\t\t\tparentContainer.classList.remove('menu-item-active');\n\t\t\t\t}\n\t\t\t\tparent = parent.closest('[data-relo=\"group-content\"]');\n\t\t\t}\n\t\t\treturn item;\n\t\t}\n\t\treturn null;\n\t}\n}\n","import {Loc, Type, Dom, Text} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport getItem from '../items/index';\nimport Item from '../items/item';\nimport ItemActive from '../items/item-active';\nimport { ItemMainPage } from '../items/item-main-page';\nimport ItemUserSelf from '../items/item-user-self';\nimport ItemUserFavorites from '../items/item-user-favorites';\nimport Options from \"../options\";\nimport DefaultController from \"./default-controller\";\nimport Utils from \"../utils\";\nimport Backend from \"../backend\";\nimport ItemAdminCustom from \"../items/item-admin-custom\";\nimport {Menu, MenuItem} from 'main.popup';\nimport ItemGroup from \"../items/item-group\";\n\nimport { DesktopApi } from 'im.v2.lib.desktop-api';\n\nexport default class ItemsController extends DefaultController{\n\tparentContainer: Element;\n\tcontainer: Element;\n\thiddenContainer: Element;\n\titems: Map = new Map();\n\t#activeItem: ItemActive = new ItemActive;\n\t#isEditMode = false;\n\n\tconstructor(container, {events})\n\t{\n\t\tsuper(container, {events});\n\t\tthis.parentContainer = container;\n\t\tthis.container = container.querySelector(\".menu-items\");\n\n\t\tthis.hiddenContainer = container\n\t\t\t.querySelector('#left-menu-hidden-items-block');\n\n\t\tcontainer\n\t\t\t.querySelectorAll('li.menu-item-block')\n\t\t\t.forEach(this.registerItem.bind(this))\n\t\t;\n\t\tcontainer\n\t\t\t.querySelector('#left-menu-hidden-separator')\n\t\t\t.addEventListener('click', this.toggleHiddenContainer.bind(this))\n\t\t;\n\n\t\tif (this.getActiveItem()\n\t\t\t&& this.getActiveItem().container\n\t\t\t\t.getAttribute('data-status') === 'hide'\n\t\t)\n\t\t{\n\t\t\tthis.#showHiddenContainer(false);\n\t\t}\n\t}\n\n\tregisterItem(node): Item\n\t{\n\t\tconst itemClass = getItem(node);\n\t\tconst item = new itemClass(this.container, node);\n\t\tthis.items.set(item.getId(), item);\n\n\t\tif (!(item instanceof ItemMainPage))\n\t\t{\n\t\t\tthis.#registerDND(item);\n\t\t}\n\n\t\tif (this.#activeItem.checkAndSet(\n\t\t\titem,\n\t\t\titem.getSimilarToUrl(\n\t\t\t\tUtils.getCurUri()\n\t\t\t)\n\t\t) === true)\n\t\t{\n\t\t\tlet parentItem = this.#getParentItemFor(item);\n\t\t\twhile (parentItem)\n\t\t\t{\n\t\t\t\tparentItem.markAsActive();\n\t\t\t\tparentItem = this.#getParentItemFor(parentItem);\n\t\t\t}\n\t\t}\n\n\t\tEventEmitter.subscribe(item, Options.eventName('onItemDelete'), ({data}) => {this.deleteItem(item, data)});\n\t\tEventEmitter.subscribe(item, Options.eventName('onItemConvert'), ({data}) => {this.convertItem(item, data)});\n\n\t\t[...item.container.querySelectorAll('a')]\n\t\t\t.forEach((node) => {\n\t\t\t\tnode.addEventListener('click', (event) => {\n\t\t\t\t\tif (this.#isEditMode === true)\n\t\t\t\t\t{\n\t\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}, true)\n\t\t\t})\n\t\t;\n\t\titem.container\n\t\t\t.querySelector('[data-role=\"item-edit-control\"]')\n\t\t\t?.addEventListener('click', (event) => {\n\t\t\t\tthis.openItemMenu(item, event.target)\n\t\t\t});\n\t\treturn item;\n\t}\n\n\tunregisterItem(item: Item)\n\t{\n\t\tif (!this.items.has(item.getId()))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.items.delete(item.getId());\n\n\t\tthis.#activeItem.checkAndUnset(\n\t\t\titem,\n\t\t\titem.getSimilarToUrl(\n\t\t\t\tUtils.getCurUri()\n\t\t\t)\n\t\t);\n\n\t\tEventEmitter.unsubscribeAll(item, Options.eventName('onItemDelete'));\n\t\tEventEmitter.unsubscribeAll(item, Options.eventName('onItemConvert'));\n\t\titem.container.parentNode.replaceChild(item.container.cloneNode(true), item.container);\n\t}\n\n\tget isEditMode()\n\t{\n\t\treturn this.#isEditMode;\n\t}\n\n\tswitchToEditMode()\n\t{\n\t\tif (this.#isEditMode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#isEditMode = true;\n\n\t\tEventEmitter.emit(\n\t\t\tthis,\n\t\t\tOptions.eventName('EditMode'),\n\t\t);\n\t}\n\n\tswitchToViewMode()\n\t{\n\t\tif (!this.#isEditMode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#isEditMode = false;\n\n\t\tEventEmitter.emit(\n\t\t\tthis,\n\t\t\tOptions.eventName('ViewMode'),\n\t\t);\n\t}\n\n\tisHiddenContainerVisible()\n\t{\n\t\treturn this.hiddenContainer.classList.contains('menu-item-favorites-more-open');\n\t}\n\n\ttoggleHiddenContainer(animate)\n\t{\n\t\tif (this.hiddenContainer.classList.contains('menu-item-favorites-more-open'))\n\t\t{\n\t\t\tthis.#hideHiddenContainer(animate);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.#showHiddenContainer(animate);\n\t\t}\n\t}\n\n\t#showHiddenContainer(animate)\n\t{\n\t\tEventEmitter.emit(\n\t\t\tthis,\n\t\t\tOptions.eventName('onHiddenBlockIsVisible')\n\t\t);\n\t\tif (animate === false)\n\t\t{\n\t\t\treturn this.hiddenContainer.classList.add('menu-item-favorites-more-open');\n\t\t}\n\n\t\tthis.hiddenContainer.style.height = \"0px\";\n\t\tthis.hiddenContainer.style.opacity = 0;\n\t\tthis.#animation(true, this.hiddenContainer, this.hiddenContainer.scrollHeight);\n\t}\n\n\t#hideHiddenContainer(animate)\n\t{\n\t\tEventEmitter.emit(\n\t\t\tthis,\n\t\t\tOptions.eventName('onHiddenBlockIsHidden')\n\t\t);\n\t\tif (animate === false)\n\t\t{\n\t\t\treturn this.hiddenContainer.classList.remove('menu-item-favorites-more-open');\n\t\t}\n\t\tthis.#animation(false, this.hiddenContainer, this.hiddenContainer.offsetHeight);\n\t}\n\n\t#animation(opening, hiddenBlock, maxHeight)\n\t{\n\t\thiddenBlock.style.overflow = \"hidden\";\n\t\t(new BX.easing({\n\t\t\tduration: 200,\n\t\t\tstart: {opacity: opening ? 0 : 100, height: opening ? 0 : maxHeight},\n\t\t\tfinish: {opacity: opening ? 100 : 0, height: opening ? maxHeight : 0},\n\t\t\ttransition: BX.easing.transitions.linear,\n\t\t\tstep: function (state) {\n\t\t\t\thiddenBlock.style.opacity = state.opacity / 100;\n\t\t\t\thiddenBlock.style.height = state.height + \"px\";\n\t\t\t},\n\t\t\tcomplete: function () {\n\t\t\t\tif (opening)\n\t\t\t\t{\n\t\t\t\t\thiddenBlock.classList.add('menu-item-favorites-more-open');\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\thiddenBlock.classList.remove('menu-item-favorites-more-open');\n\t\t\t\t}\n\t\t\t\thiddenBlock.style.opacity = \"\";\n\t\t\t\thiddenBlock.style.overflow = \"\";\n\t\t\t\thiddenBlock.style.height = \"\";\n\t\t\t}\n\n\t\t})).animate();\n\t}\n\n\tsetItemAsAMainPage(item: Item)\n\t{\n\t\tconst node = item.container;\n\t\tnode.setAttribute(\"data-status\", \"show\");\n\t\tconst startTop = node.offsetTop;\n\t\tconst dragElement = Dom.create(\"div\", {\n\t\t\tattrs: {className: \"menu-draggable-wrap\"},\n\t\t\tstyle: {top: startTop}\n\t\t});\n\n\t\tconst insertBeforeElement = node.nextElementSibling;\n\t\tif (insertBeforeElement)\n\t\t{\n\t\t\tnode.parentNode.insertBefore(dragElement, insertBeforeElement);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tnode.parentNode.appendChild(dragElement);\n\t\t}\n\n\t\tdragElement.appendChild(node);\n\n\t\tDom.addClass(node, \"menu-item-draggable\");\n\n\t\t(new BX.easing({\n\t\t\tduration: 500,\n\t\t\tstart: {top: startTop},\n\t\t\tfinish: {top: 0},\n\t\t\ttransition: BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\tstep: function (state) { dragElement.style.top = state.top + \"px\"; },\n\t\t\tcomplete: () => {\n\t\t\t\tthis.container.insertBefore(node, BX(\"left-menu-empty-item\").nextSibling);\n\t\t\t\tDom.removeClass(node, \"menu-item-draggable\");\n\t\t\t\tDom.remove(dragElement);\n\t\t\t\tthis.#saveItemsSort({\n\t\t\t\t\taction: 'mainPageIsSet',\n\t\t\t\t\titemId: item.getId()\n\t\t\t\t});\n\t\t\t}\n\t\t})).animate();\n\t}\n\n\tshowItem(item: Item)\n\t{\n\t\tconst oldParent = this.#getParentItemFor(item);\n\t\tconst container = this.container;\n\n\t\titem.container.setAttribute('data-status', 'show');\n\t\tif (this.#canChangePaternity(item))\n\t\t{\n\t\t\tcontainer.appendChild(item.container);\n\t\t\tthis.#refreshActivity(item, oldParent);\n\t\t}\n\t\telse if (oldParent)\n\t\t{\n\t\t\tcontainer.appendChild(oldParent.container);\n\t\t\toldParent.container.setAttribute('data-status', 'show');\n\t\t\tcontainer.appendChild(oldParent.groupContainer);\n\t\t}\n\n\t\tif (this.hiddenContainer.querySelector('.menu-item-block') === null)\n\t\t{\n\t\t\tEventEmitter.emit(this, Options.eventName('onHiddenBlockIsEmpty'));\n\t\t\tthis.#hideHiddenContainer(false);\n\t\t}\n\n\t\tthis.#recalculateCounters(item);\n\t\tthis.#saveItemsSort({\n\t\t\taction: 'showItem',\n\t\t\titemId: item.getId()\n\t\t});\n\t}\n\n\thideItem(item: Item)\n\t{\n\t\tconst oldParent = this.#getParentItemFor(item);\n\t\tconst container = this.hiddenContainer.querySelector('#left-menu-hidden-items-list');\n\t\tconst emitEvent = container.querySelector('.menu-item-block') === null;\n\n\t\titem.container.setAttribute('data-status', 'hide');\n\t\tif (this.#canChangePaternity(item))\n\t\t{\n\t\t\tcontainer.appendChild(item.container);\n\t\t\tthis.#refreshActivity(item, oldParent);\n\t\t}\n\t\telse if (oldParent)\n\t\t{\n\t\t\tcontainer.appendChild(oldParent.container);\n\t\t\toldParent.container.setAttribute('data-status', 'hide');\n\t\t\tcontainer.appendChild(oldParent.groupContainer);\n\t\t}\n\n\t\tif (emitEvent)\n\t\t{\n\t\t\tEventEmitter.emit(this, Options.eventName('onHiddenBlockIsNotEmpty'));\n\t\t}\n\n\t\tthis.#recalculateCounters(item);\n\n\t\tthis.#saveItemsSort({\n\t\t\taction: 'hideItem',\n\t\t\titemId: item.getId()\n\t\t});\n\t}\n\n\t#recalculateCounters(item: Item)\n\t{\n\t\tlet counterValue = 0;\n\t\tif (item.container.querySelector('[data-role=\"counter\"]'))\n\t\t{\n\t\t\tcounterValue = item.container.querySelector('[data-role=\"counter\"]').dataset.counterValue;\n\t\t}\n\t\tif (counterValue <= 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\t[...this.items.entries()]\n\t\t\t.forEach(([id, itemGroup]) => {\n\t\t\t\tif (itemGroup instanceof ItemGroup)\n\t\t\t\t{\n\t\t\t\t\titemGroup.updateCounter();\n\t\t\t\t}\n\t\t\t})\n\t\t;\n\n\t\tlet hiddenCounterValue = 0;\n\t\t[...this.parentContainer\n\t\t\t.querySelectorAll(`.menu-item-block[data-status=\"hide\"][data-role='item']`)\n\t\t].forEach((node) => {\n\t\t\t\tconst counterNode = node.querySelector('[data-role=\"counter\"]');\n\t\t\t\tif (counterNode)\n\t\t\t\t{\n\t\t\t\t\thiddenCounterValue += parseInt(counterNode.dataset.counterValue);\n\t\t\t\t}\n\t\t\t})\n\t\t;\n\n\t\tconst hiddenCounterNode = this.parentContainer.querySelector('#menu-hidden-counter');\n\t\thiddenCounterNode.dataset.counterValue = Math.max(0, hiddenCounterValue);\n\t\tif (hiddenCounterNode.dataset.counterValue > 0)\n\t\t{\n\t\t\thiddenCounterNode.classList.remove('menu-hidden-counter');\n\t\t\thiddenCounterNode.innerHTML = hiddenCounterNode.dataset.counterValue > 99 ? '99+' : hiddenCounterNode.dataset.counterValue;\n\t\t}\n\t\telse\n\t\t{\n\t\t\thiddenCounterNode.classList.add('menu-hidden-counter');\n\t\t\thiddenCounterNode.innerHTML = '';\n\t\t}\n\t}\n\n\t#refreshActivity(item: Item, oldParent:? ItemGroup)\n\t{\n\t\tif (this.getActiveItem() !== item)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst newParent = this.#getParentItemFor(item);\n\n\t\tif (oldParent !== newParent)\n\t\t{\n\t\t\tif (oldParent instanceof ItemGroup)\n\t\t\t{\n\t\t\t\toldParent.markAsInactive();\n\t\t\t}\n\t\t\tif (newParent instanceof ItemGroup)\n\t\t\t{\n\t\t\t\tnewParent.markAsActive();\n\t\t\t}\n\t\t}\n\t}\n\n\t#updateCountersLastValue = null\n\tupdateCounters(counters, send)\n\t{\n\t\tconst countersDynamic = {};\n\t\tsend = send !== false;\n\t\t[...Object.entries(counters)]\n\t\t\t.forEach(([counterId, counterValue]) => {\n\t\t\t\t[...this.#getItemsByCounterId(counterId)]\n\t\t\t\t\t.forEach((item) => {\n\t\t\t\t\t\tconst {oldValue, newValue} = item.updateCounter(counterValue);\n\t\t\t\t\t\tconst state = item.container.getAttribute('data-status');\n\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t(counterId.indexOf('crm_') < 0 || counterId.indexOf('crm_all') >= 0)\n\t\t\t\t\t\t\t&&\n\t\t\t\t\t\t\t(counterId.indexOf('tasks_') < 0 || counterId.indexOf('tasks_total') >= 0)\n\t\t\t\t\t\t)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcountersDynamic[state] = countersDynamic[state] || 0;\n\t\t\t\t\t\t\tcountersDynamic[state] += (newValue - oldValue);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tlet parentItem = this.#getParentItemFor(item);\n\t\t\t\t\t\twhile (parentItem)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tparentItem.updateCounter();\n\t\t\t\t\t\t\tparentItem = this.#getParentItemFor(parentItem);\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t;\n\n\t\t\t\tif (send)\n\t\t\t\t{\n\t\t\t\t\tBX.localStorage.set('lmc-' + counterId, counterValue, 5);\n\t\t\t\t}\n\t\t\t})\n\t\t;\n\n\t\tif (countersDynamic['hide'] !== undefined && countersDynamic['hide'] !== 0)\n\t\t{\n\t\t\tconst hiddenCounterNode = this.parentContainer.querySelector('#menu-hidden-counter');\n\t\t\thiddenCounterNode.dataset.counterValue = Math.max(0, Number(hiddenCounterNode.dataset.counterValue) + Number(countersDynamic['hide']));\n\t\t\tif (hiddenCounterNode.dataset.counterValue > 0)\n\t\t\t{\n\t\t\t\thiddenCounterNode.classList.remove('menu-hidden-counter');\n\t\t\t\thiddenCounterNode.innerHTML = hiddenCounterNode.dataset.counterValue > 99 ? '99+' : hiddenCounterNode.dataset.counterValue;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\thiddenCounterNode.classList.add('menu-hidden-counter');\n\t\t\t\thiddenCounterNode.innerHTML = '';\n\t\t\t}\n\t\t}\n\n\t\tif (typeof BXIM !== 'undefined')\n\t\t{\n\t\t\tif (this.#updateCountersLastValue === null)\n\t\t\t{\n\t\t\t\tthis.#updateCountersLastValue = 0;\n\t\t\t\t[...this.items.entries()]\n\t\t\t\t\t.forEach(([id, item]) => {\n\t\t\t\t\t\tif (item instanceof ItemGroup)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconst res = item.getCounterValue();\n\n\t\t\t\t\t\tif (res > 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlet counterId = 'doesNotMatter';\n\t\t\t\t\t\t\tif (id.indexOf('menu_crm') >= 0 || id.indexOf('menu_tasks') >= 0)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tconst counterNode = item.container.querySelector('[data-role=\"counter\"]');\n\t\t\t\t\t\t\t\tif (counterNode)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tcounterId = counterNode.id;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\tcounterId === 'doesNotMatter'\n\t\t\t\t\t\t\t\t|| counterId.indexOf('crm_all') >= 0\n\t\t\t\t\t\t\t\t|| counterId.indexOf('tasks_total') >= 0\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.#updateCountersLastValue += res;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.#updateCountersLastValue += (countersDynamic['show'] !== undefined ? countersDynamic['show'] : 0);\n\t\t\t\tthis.#updateCountersLastValue += (countersDynamic['hide'] !== undefined ? countersDynamic['hide'] : 0);\n\t\t\t}\n\t\t\tconst visibleValue = (this.#updateCountersLastValue > 99 ? '99+' : (\n\t\t\t\tthis.#updateCountersLastValue < 0 ? '0' : this.#updateCountersLastValue\n\t\t\t));\n\n\t\t\tif (DesktopApi.isDesktop())\n\t\t\t{\n\t\t\t\tDesktopApi.setBrowserIconBadge(visibleValue);\n\t\t\t}\n\t\t}\n\n\t\t[...this.items.entries()]\n\t\t\t.forEach(([id, itemGroup]) => {\n\t\t\t\tif (itemGroup instanceof ItemGroup)\n\t\t\t\t{\n\t\t\t\t\titemGroup.updateCounter();\n\t\t\t\t}\n\t\t\t})\n\t\t;\n\t}\n\n\tdecrementCounter(counters)\n\t{\n\t\t[...Object.entries(counters)]\n\t\t\t.forEach(([counterId, counterValue]) => {\n\t\t\t\tconst item = this.#getItemsByCounterId(counterId).shift();\n\t\t\t\tif (item)\n\t\t\t\t{\n\t\t\t\t\tconst value = item.getCounterValue();\n\t\t\t\t\tcounters[counterId] = value > counterValue ? (value - counterValue) : 0;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tdelete counters[counterId];\n\t\t\t\t}\n\t\t\t})\n\t\t;\n\t\tthis.updateCounters(counters, false);\n\t}\n\n\t#getItemsByCounterId(counterId: string)\n\t{\n\t\tconst result = [];\n\t\t[...this.items.values()]\n\t\t\t.forEach((item: Item) => {\n\t\t\t\tconst node = item.container.querySelector('[data-role=\"counter\"]');\n\t\t\t\tif (node && node.id.indexOf(counterId) >= 0)\n\t\t\t\t{\n\t\t\t\t\tresult.push(item);\n\t\t\t\t}\n\t\t\t});\n\t\treturn result;\n\t}\n\n\t#getItemsToSave()\n\t{\n\t\tconst saveSortItems = {\n\t\t\tshow: [],\n\t\t\thide: [],\n\t\t};\n\t\tconst customItems = [];\n\n\t\tlet firstItemLink = null;\n\t\t['show', 'hide']\n\t\t\t.forEach((state) => {\n\t\t\t\tlet items = saveSortItems[state];\n\t\t\t\tlet currentGroupId = null;\n\t\t\t\tconst chain = [];\n\n\t\t\t\tArray.from(\n\t\t\t\t\tthis.parentContainer\n\t\t\t\t\t\t.querySelectorAll(`.menu-item-block[data-status=\"${state}\"]`)\n\t\t\t\t).forEach((node) =>\n\t\t\t\t{\n\t\t\t\t\tif (node.dataset.role === 'group')\n\t\t\t\t\t{\n\t\t\t\t\t\tconst groupId = node.parentNode.hasAttribute('data-group-id') ?\n\t\t\t\t\t\t\tnode.parentNode.getAttribute('data-group-id') : null;\n\t\t\t\t\t\titems = saveSortItems[state];\n\t\t\t\t\t\tlet groupItem\n\t\t\t\t\t\twhile (groupItem = chain.pop())\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (groupItem['group_id'] === groupId)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tchain.push(groupItem);\n\t\t\t\t\t\t\t\titems = groupItem.items;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconst item = {\n\t\t\t\t\t\t\tgroup_id: node.dataset.id,\n\t\t\t\t\t\t\titems: []\n\t\t\t\t\t\t};\n\t\t\t\t\t\titems.push(item);\n\t\t\t\t\t\tchain.push(item);\n\t\t\t\t\t\titems = item.items;\n\t\t\t\t\t\tcurrentGroupId = node.dataset.id;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tif ([ItemAdminCustom.code, ItemUserSelf.code, ItemUserFavorites.code]\n\t\t\t\t\t\t\t.indexOf(node.getAttribute('data-type')) >= 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst item = {\n\t\t\t\t\t\t\t\tID: node.getAttribute('data-id'),\n\t\t\t\t\t\t\t\tLINK: node.getAttribute('data-link'),\n\t\t\t\t\t\t\t\tTEXT: Text.decode(node.querySelector(\"[data-role='item-text']\").innerHTML)\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tif (node.getAttribute(\"data-new-page\") === \"Y\")\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\titem.NEW_PAGE = \"Y\";\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tcustomItems.push(item);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (firstItemLink === null && Type.isStringFilled(node.getAttribute(\"data-link\")))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tfirstItemLink = node.getAttribute(\"data-link\");\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (node.closest(`[data-group-id=\"${currentGroupId}\"][data-role=\"group-content\"]`))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\titems.push(node.dataset.id);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst groupId = node.parentNode.hasAttribute('data-group-id') ?\n\t\t\t\t\t\t\t\tnode.parentNode.getAttribute('data-group-id') : null;\n\t\t\t\t\t\t\titems = saveSortItems[state];\n\t\t\t\t\t\t\tlet groupItem\n\t\t\t\t\t\t\twhile (groupItem = chain.pop())\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tif (groupItem['group_id'] === groupId)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tchain.push(groupItem);\n\t\t\t\t\t\t\t\t\titems = groupItem.items;\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\titems.push(node.dataset.id);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t})\n\t\t;\n\t\treturn {saveSortItems, firstItemLink, customItems};\n\t}\n\n\t#saveItemsSort(analyticsLabel)\n\t{\n\t\tconst {saveSortItems, firstItemLink} = this.#getItemsToSave();\n\t\tBackend.saveItemsSort(saveSortItems, firstItemLink, analyticsLabel || {action: 'sortItem'});\n\t}\n\n\taddItem({node, animateFromPoint})\n\t{\n\t\tif (!(node instanceof Element))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst styleValue = node.style.display;\n\t\tif (animateFromPoint)\n\t\t{\n\t\t\tnode.dataset.styleDisplay = node.style.display;\n\t\t\tnode.style.display = 'none';\n\t\t}\n\t\tif (this.items.has(node.dataset.id) && node.dataset.type === ItemUserFavorites.code)\n\t\t{\n\t\t\tconst item = this.items.get(node.dataset.id);\n\t\t\titem.storage.push(ItemUserFavorites.code);\n\t\t\titem.container.dataset.storage = item.storage.join(',');\n\t\t\tnode = item.container;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.container.appendChild(node);\n\t\t\tthis.registerItem(node);\n\t\t\tthis.#saveItemsSort();\n\t\t}\n\n\t\tif (animateFromPoint)\n\t\t{\n\t\t\tthis\n\t\t\t\t.#animateTopItemToLeft(node, animateFromPoint)\n\t\t\t\t.then(() => {\n\t\t\t\t\tnode.style.display = node.dataset.styleDisplay;\n\t\t\t\t})\n\t\t\t;\n\t\t}\n\t}\n\n\tupdateItem(data)\n\t{\n\t\tlet {id} = data;\n\t\tif (this.items.has(id))\n\t\t{\n\t\t\tthis.items\n\t\t\t\t.get(id)\n\t\t\t\t.update(data)\n\t\t\t;\n\t\t}\n\t}\n\n\tdeleteItem(item: Item, {animate})\n\t{\n\t\tthis.items.delete(item.getId());\n\t\tthis.#activeItem.checkAndUnset(item);\n\n\t\tif (item instanceof ItemUserFavorites || animate)\n\t\t{\n\t\t\tthis\n\t\t\t\t.#animateTopItemFromLeft(item.container)\n\t\t\t\t.then(() => {\n\t\t\t\t\titem.container.parentNode.removeChild(item.container);\n\t\t\t\t\tthis.#saveItemsSort();\n\t\t\t\t})\n\t\t\t;\n\t\t}\n\t\telse if (item.container)\n\t\t{\n\t\t\titem.container.parentNode.removeChild(item.container);\n\t\t\tthis.#saveItemsSort();\n\t\t}\n\t}\n\n\tconvertItem(item: Item)\n\t{\n\t\tthis.unregisterItem(item);\n\t\tthis.registerItem(this.parentContainer.querySelector(`li.menu-item-block[data-id=\"${item.getId()}\"]`));\n\t}\n\n\tgetActiveItem(): ?Item\n\t{\n\t\treturn this.#activeItem.item;\n\t}\n\n\t#getParentItemFor(item: Item): ?ItemGroup\n\t{\n\t\tif (!(item instanceof Item))\n\t\t{\n\t\t\treturn null;\n\t\t}\n\t\tconst parentContainer = item.container.closest('[data-role=\"group-content\"]');\n\t\tif (parentContainer && this.items.has(parentContainer.getAttribute('data-group-id')))\n\t\t{\n\t\t\treturn this.items.get(parentContainer.getAttribute('data-group-id'));\n\t\t}\n\t\treturn null;\n\t}\n\n\t#canChangePaternity(item: Item): boolean\n\t{\n\t\tif (item instanceof ItemGroup)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\t\tconst oldParent = this.#getParentItemFor(item);\n\t\tif (oldParent instanceof ItemGroup\n\t\t\t&& item.container.parentNode.querySelectorAll('li.menu-item-block').length <= 1\n\t\t)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t}\n\n\texport()\n\t{\n\t\treturn this.#getItemsToSave();\n\t}\n\n\t//region DropdownActions\n\t#openItemMenuPopup;\n\topenItemMenu(item: Item, target)\n\t{\n\t\tif (this.#openItemMenuPopup)\n\t\t{\n\t\t\tthis.#openItemMenuPopup.close();\n\t\t}\n\t\tconst contextMenuItems = [];\n\t\t// region hide/show item\n\n\t\tif (item instanceof ItemMainPage)\n\t\t{\n\t\t\tcontextMenuItems.push({\n\t\t\t\ttext: Loc.getMessage('MENU_OPEN_SETTINGS_MAIN_PAGE'),\n\t\t\t\tonclick: () => {\n\t\t\t\t\titem.openSettings();\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\t\telse if (item.container.getAttribute(\"data-status\") === \"show\")\n\t\t{\n\t\t\tcontextMenuItems.push({\n\t\t\t\ttext: Loc.getMessage(\"hide_item\"),\n\t\t\t\tonclick: () => {\n\t\t\t\t\tthis.hideItem(item);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tcontextMenuItems.push({\n\t\t\t\ttext: Loc.getMessage(\"show_item\"),\n\t\t\t\tonclick: (target, contextMenuItem) => {\n\t\t\t\t\tthis.showItem(item);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\t//endregion\n\n\t\t//region set as main page\n\t\tif (\n\t\t\t!Options.isExtranet\n\t\t\t&& !Options.isMainPageEnabled\n\t\t\t&& !(item instanceof ItemUserSelf)\n\t\t\t&& !(item instanceof ItemGroup)\n\t\t\t&& this.container.querySelector('li.menu-item-block[data-role=\"item\"]') !== item.container\n\t\t)\n\t\t{\n\t\t\tcontextMenuItems.push({\n\t\t\t\ttext: Loc.getMessage(\"MENU_SET_MAIN_PAGE\"),\n\t\t\t\tonclick: () => {\n\t\t\t\t\tthis.setItemAsAMainPage(item);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\t//endregion\n\n\t\titem\n\t\t\t.getDropDownActions()\n\t\t\t.forEach((actionItem) => {\n\t\t\t\tcontextMenuItems.push(actionItem);\n\t\t\t});\n\n\t\tif (!(item instanceof ItemMainPage))\n\t\t{\n\t\t\tcontextMenuItems.push({\n\t\t\t\ttext: this.#isEditMode ? Loc.getMessage(\"MENU_EDIT_READY_FULL\") : Loc.getMessage(\"MENU_SETTINGS_MODE\"),\n\t\t\t\tonclick: () => {\n\t\t\t\t\tthis.#isEditMode ? this.switchToViewMode() : this.switchToEditMode();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tcontextMenuItems.forEach((item) => {\n\t\t\titem['className'] = [\"menu-popup-no-icon\", item['className'] ?? ''].join(' ');\n\t\t\tconst {onclick} = item;\n\t\t\titem['onclick'] = (event, item) => {\n\t\t\t\titem.getMenuWindow().close();\n\t\t\t\tonclick.call(event, item);\n\t\t\t};\n\t\t});\n\t\tthis.#openItemMenuPopup = new Menu({\n\t\t\tbindElement: target,\n\t\t\titems: contextMenuItems,\n\t\t\toffsetTop: 0,\n\t\t\toffsetLeft: 12,\n\t\t\tangle: true,\n\t\t\tevents: {\n\t\t\t\tonClose: () => {\n\t\t\t\t\tEventEmitter.emit(this, Options.eventName('onClose'));\n\t\t\t\t\titem.container.classList.remove('menu-item-block-hover');\n\t\t\t\t\tthis.#openItemMenuPopup = null;\n\t\t\t\t},\n\t\t\t\tonShow: () => {\n\t\t\t\t\titem.container.classList.add('menu-item-block-hover');\n\t\t\t\t\tEventEmitter.emit(this, Options.eventName('onShow'));\n\t\t\t\t},\n\t\t\t}\n\t\t});\n\t\tthis.#openItemMenuPopup.show();\n\t}\n\t//endregion\n\n\t//region Visible sliding\n\t#animateTopItemToLeft(node, animateFromPoint)\n\t{\n\t\treturn new Promise((resolve) => {\n\t\t\tlet {startX, startY} = animateFromPoint;\n\t\t\tconst topMenuNode = document.createElement('DIV');\n\t\t\ttopMenuNode.style = `position: absolute; z-index: 1000; top: ${startY + 25}px;`\n\n\t\t\tconst cloneNode = node.cloneNode(true);\n\t\t\tcloneNode.style.display = node.dataset.styleDisplay;\n\t\t\tdocument.body.appendChild(topMenuNode);\n\t\t\ttopMenuNode.appendChild(cloneNode);\n\n\t\t\tlet finishY = this.hiddenContainer.getBoundingClientRect().top;\n\n\t\t\t(new BX.easing({\n\t\t\t\tduration: 500,\n\t\t\t\tstart: {left: startX},\n\t\t\t\tfinish: {left: 30},\n\t\t\t\ttransition: BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\t\tstep: function (state) {\n\t\t\t\t\ttopMenuNode.style.left = state.left + \"px\";\n\t\t\t\t},\n\t\t\t\tcomplete: () => {\n\t\t\t\t\t(new BX.easing({\n\t\t\t\t\t\tduration: 500,\n\t\t\t\t\t\tstart: {top: startY + 25},\n\t\t\t\t\t\tfinish: {top: finishY},\n\t\t\t\t\t\ttransition: BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\t\t\t\tstep: function (state) {\n\t\t\t\t\t\t\ttopMenuNode.style.top = state.top + \"px\";\n\t\t\t\t\t\t},\n\t\t\t\t\t\tcomplete: () => {\n\t\t\t\t\t\t\tDom.remove(topMenuNode);\n\t\t\t\t\t\t\tresolve();\n\t\t\t\t\t\t}\n\t\t\t\t\t})).animate();\n\t\t\t\t}\n\t\t\t})).animate();\n\t\t});\n\t}\n\t#animateTopItemFromLeft(node)\n\t{\n\t\treturn new Promise((resolve) => {\n\t\t\t(new BX.easing({\n\t\t\t\tduration: 700,\n\t\t\t\tstart: {left: node.offsetLeft, opacity: 1},\n\t\t\t\tfinish: {left: 400, opacity: 0},\n\t\t\t\ttransition: BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\t\tstep: function (state) {\n\t\t\t\t\tnode.style.paddingLeft = state.left + \"px\";\n\t\t\t\t\tnode.style.opacity = state.opacity;\n\t\t\t\t},\n\t\t\t\tcomplete: function () {\n\t\t\t\t\tresolve();\n\t\t\t\t}\n\t\t\t})).animate();\n\t\t});\n\t}\n\t//endregion\n\n\t/* region D&D */\n\t#registerDND(item)\n\t{\n\t\t//drag&drop\n\t\tjsDD.Enable();\n\t\titem.container.onbxdragstart = this.#menuItemDragStart.bind(this, item);\n\t\titem.container.onbxdrag = (x, y) => { this.#menuItemDragMove(/*item,*/ x, y); };\n\t\titem.container.onbxdraghover = (dest, x, y) => { this.#menuItemDragHover(/*item, */dest, x, y); };\n\t\titem.container.onbxdragstop = this.#menuItemDragStop.bind(this, item);\n\t\tjsDD.registerObject(item.container);\n\t}\n\n\t#menuItemDragStart(item)\n\t{\n\t\tEventEmitter.emit(EventEmitter.GLOBAL_TARGET, 'BX.Bitrix24.LeftMenuClass:onDragStart');\n\n\t\tif (!(item instanceof ItemGroup)\n\t\t\t&& item.container.parentNode.querySelectorAll('li.menu-item-block').length <= 1\n\t\t\t&& this.#getParentItemFor(item) !== null\n\t\t)\n\t\t{\n\t\t\titem = this.#getParentItemFor(item);\n\t\t}\n\n\t\tEventEmitter.emit(\n\t\t\tthis,\n\t\t\tOptions.eventName('onDragModeOn')\n\t\t);\n\n\t\tthis.dnd = {\n\t\t\tcontainer: this.container.parentNode,\n\t\t\titemDomBlank: Dom.create('div', {\n\t\t\t\tstyle: {\n\t\t\t\t\tdisplay: 'none',\n\t\t\t\t\t// border: '2px solid navy'\n\t\t\t\t}}),\n\t\t\titemMoveBlank: Dom.create('div', {\n\t\t\t\tstyle: {\n\t\t\t\t\theight: item.container.offsetHeight + 'px',\n\t\t\t\t\t// border: '2px solid red',\n\t\t\t\t}}\n\t\t\t),\n\t\t\tdraggableBlock: Dom.create('div', {             //div to move\n\t\t\t\tattrs: {\n\t\t\t\t\tclassName: \"menu-draggable-wrap\",\n\t\t\t\t},\n\t\t\t\tstyle: {\n\t\t\t\t\ttop: [(\n\t\t\t\t\t\titem.container.offsetTop - item.container.offsetHeight\n\t\t\t\t\t), 'px'].join(''),\n\t\t\t\t\t// border: '2px solid black'\n\t\t\t\t}\n\t\t\t}),\n\t\t\titem: item,\n\t\t\toldParent: this.#getParentItemFor(item),\n\t\t\tisHiddenContainerVisible: this.isHiddenContainerVisible()\n\t\t}\n\n\t\tthis.#showHiddenContainer(false);\n\n\t\tconst registerItems = () => {\n\t\t\t[...this.parentContainer\n\t\t\t\t.querySelectorAll('li.menu-item-block')]\n\t\t\t\t.forEach((node) => {\n\t\t\t\t\tif (item instanceof ItemGroup\n\t\t\t\t\t\t&& this.#getParentItemFor(\n\t\t\t\t\t\t\tthis.items.get(node.getAttribute('data-id'))\n\t\t\t\t\t\t) !== null)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tjsDD.registerDest(node, 100);\n\t\t\t\t});\n\n\t\t\tconst firstNode = this.parentContainer\n\t\t\t\t.querySelector(\"#left-menu-empty-item\");\n\t\t\tif (item instanceof ItemUserSelf)\n\t\t\t{\n\t\t\t\tjsDD.unregisterDest(firstNode);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tjsDD.registerDest(firstNode, 100);\n\t\t\t}\n\t\t\tjsDD.registerDest(this.parentContainer\n\t\t\t\t.querySelector(\"#left-menu-hidden-empty-item\"), 100);\n\t\t\tjsDD.registerDest(this.parentContainer\n\t\t\t\t.querySelector(\"#left-menu-hidden-separator\"), 100);\n\t\t};\n\n\t\tif (item instanceof ItemGroup)\n\t\t{\n\t\t\titem\n\t\t\t\t.collapse(true)\n\t\t\t\t.then(() => {\n\t\t\t\t\tif (this.dnd)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.dnd.pos = BX.pos(this.container.parentNode);\n\t\t\t\t\t\tregisterItems();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tregisterItems();\n\t\t}\n\n\t\tconst dragElement = item.container;\n\t\tDom.addClass(this.dnd.container, \"menu-drag-mode\")\n\t\tDom.addClass(dragElement, \"menu-item-draggable\");\n\t\tdragElement\n\t\t\t.parentNode\n\t\t\t.insertBefore(this.dnd.itemDomBlank, dragElement); //remember original item place\n\t\tdragElement\n\t\t\t.parentNode\n\t\t\t.insertBefore(this.dnd.itemMoveBlank, dragElement); //empty div\n\t\tthis.dnd.draggableBlock.appendChild(item.container);\n\n\t\tthis.dnd.container.style.position = 'relative';\n\t\tthis.dnd.container.appendChild(this.dnd.draggableBlock);\n\t\tthis.dnd.pos = BX.pos(this.container.parentNode);\n\t}\n\n\t#menuItemDragMove(/*item,*/ x, y)\n\t{\n\t\tconst item = this.dnd.item;\n\t\tvar menuItemsBlockHeight = this.dnd.pos.height;\n\t\ty = Math.max(0, y - this.dnd.pos.top);\n\t\tthis.dnd.draggableBlock.style.top = [\n\t\t\tMath.min(menuItemsBlockHeight - item.container.offsetHeight, y) - 5,\n\t\t\t'px'\n\t\t].join('');\n\t}\n\n\t#menuItemDragHover(/*item, */dest, x, y)\n\t{\n\t\tconst item = this.dnd.item;\n\t\tconst dragElement = item.container;\n\n\t\tif (dest === dragElement)\n\t\t{\n\t\t\tthis.dnd.itemDomBlank\n\t\t\t\t.parentNode.insertBefore(this.dnd.itemMoveBlank, this.dnd.itemDomBlank);\n\t\t\treturn;\n\t\t}\n\n\t\tif (dest.id === \"left-menu-empty-item\" &&\n\t\t\t(\n\t\t\t\tdragElement.getAttribute(\"data-type\") === \"self\"\n\t\t\t\t|| dragElement.getAttribute(\"data-disable-first-item\") === \"Y\"\n\t\t\t)\n\t\t)\n\t\t{\n\t\t\treturn; // self-item cannot be moved on the first place\n\t\t}\n\n\t\tif (dest.getAttribute('data-role') === 'group')\n\t\t{\n\t\t\tconst groupHolder = dest.parentNode.querySelector(`[data-group-id=\"${dest.getAttribute('data-id')}\"]`);\n\t\t\tif (dest.getAttribute('data-collapse-mode') === 'collapsed')\n\t\t\t{\n\t\t\t\tDom.insertAfter(this.dnd.itemMoveBlank, groupHolder);\n\t\t\t}\n\t\t\telse if (item instanceof ItemGroup)\n\t\t\t{\n\t\t\t\tDom.insertBefore(this.dnd.itemMoveBlank, dest);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tDom.prepend(this.dnd.itemMoveBlank, groupHolder.querySelector('ul'));\n\t\t\t}\n\t\t}\n\t\telse if (this.dnd.container.contains(dest))\n\t\t{\n\t\t\tlet itemPlaceHolder = dest;\n\t\t\tif (item instanceof ItemGroup &&\n\t\t\t\tdest.closest('[data-role=\"group-content\"]'))\n\t\t\t{\n\t\t\t\titemPlaceHolder = dest.closest('[data-role=\"group-content\"]');\n\t\t\t}\n\t\t\tDom.insertAfter(this.dnd.itemMoveBlank, itemPlaceHolder);\n\t\t}\n\t}\n\n\t#menuItemDragStop(/*item*/)\n\t{\n\t\tconst item = this.dnd.item;\n\t\tconsole.log(item);\n\t\tconst oldParent = this.dnd.oldParent;\n\n\t\tconst dragElement = item.container;\n\n\t\tDom.removeClass(this.dnd.container, \"menu-drag-mode\");\n\t\tDom.removeClass(dragElement, \"menu-item-draggable\");\n\t\tthis.dnd.container.style.position = '';\n\n\t\tlet error = null;\n\t\tlet onHiddenBlockIsEmptyEmitted = false;\n\t\tif (this.parentContainer.querySelector('.menu-item-block') === item.container)\n\t\t{\n\t\t\tif (item instanceof ItemUserSelf)\n\t\t\t{\n\t\t\t\terror = Loc.getMessage('MENU_SELF_ITEM_FIRST_ERROR');\n\t\t\t}\n\t\t\telse if (item.container.getAttribute(\"data-disable-first-item\") === \"Y\")\n\t\t\t{\n\t\t\t\terror = Loc.getMessage(\"MENU_FIRST_ITEM_ERROR\");\n\t\t\t}\n\t\t}\n\t\tif (error !== null)\n\t\t{\n\t\t\tthis.dnd.itemDomBlank.parentNode.replaceChild(dragElement, this.dnd.itemDomBlank);\n\t\t\titem.showMessage(error);\n\t\t}\n\t\telse if (!this.dnd.container.contains(this.dnd.itemMoveBlank))\n\t\t{\n\t\t\tthis.dnd.itemDomBlank.parentNode.replaceChild(dragElement, this.dnd.itemDomBlank);\n\t\t}\n\t\telse\n\t\t{\n\t\t\ttry {\n\t\t\t\tthis.dnd.itemMoveBlank.parentNode.replaceChild(dragElement, this.dnd.itemMoveBlank);\n\n\t\t\t\tif (this.hiddenContainer.contains(dragElement))\n\t\t\t\t{\n\t\t\t\t\titem.container.setAttribute(\"data-status\", \"hide\");\n\t\t\t\t\tif (this.dnd.itemDomBlank.closest('#left-menu-hidden-items-block') === null\n\t\t\t\t\t\t&& this.hiddenContainer.querySelectorAll('.menu-item-block').length === 1)\n\t\t\t\t\t{\n\t\t\t\t\t\tEventEmitter.emit(this, Options.eventName('onHiddenBlockIsNotEmpty'));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\titem.container.setAttribute(\"data-status\", \"show\");\n\t\t\t\t\tif (this.hiddenContainer.querySelectorAll('.menu-item-block').length <= 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tonHiddenBlockIsEmptyEmitted = true;\n\t\t\t\t\t\tEventEmitter.emit(this, Options.eventName('onHiddenBlockIsEmpty'));\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (item instanceof ItemGroup)\n\t\t\t\t{\n\t\t\t\t\titem\n\t\t\t\t\t\t.checkAndCorrect()\n\t\t\t\t\t\t.expand(true);\n\t\t\t\t}\n\t\t\t\tthis.#refreshActivity(item, oldParent);\n\t\t\t\tthis.#recalculateCounters(item);\n\n\t\t\t\tconst analyticsLabel = {action: 'sortItem'};\n\t\t\t\tif (this.parentContainer.querySelector('.menu-item-block') === item.container\n\t\t\t\t\t&& !this.isExtranet)\n\t\t\t\t{\n\t\t\t\t\titem.showMessage(Loc.getMessage(\"MENU_ITEM_MAIN_PAGE\"));\n\t\t\t\t\tanalyticsLabel.action = 'mainPage';\n\t\t\t\t\tanalyticsLabel.itemId = item.getId();\n\t\t\t\t}\n\t\t\t\tthis.#saveItemsSort(analyticsLabel);\n\t\t\t}\n\t\t\tcatch(e)\n\t\t\t{\n\t\t\t\tthis.dnd.itemDomBlank.parentNode.replaceChild(dragElement, this.dnd.itemDomBlank);\n\t\t\t}\n\t\t}\n\n\t\tDom.remove(this.dnd.draggableBlock);\n\t\tDom.remove(this.dnd.itemDomBlank);\n\t\tDom.remove(this.dnd.itemMoveBlank);\n\n\t\tjsDD.enableDest(dragElement);\n\t\tthis.container.style.position = 'static';\n\t\tif (!this.dnd.isHiddenContainerVisible || onHiddenBlockIsEmptyEmitted === true)\n\t\t{\n\t\t\tthis.#hideHiddenContainer(false);\n\t\t}\n\t\tdelete this.dnd;\n\n\t\t[...this.parentContainer\n\t\t\t.querySelectorAll('li.menu-item-block')]\n\t\t\t.forEach((node) => {\n\t\t\t\tjsDD.registerDest(node);\n\t\t\t});\n\t\tconst firstNode = this.parentContainer\n\t\t\t.querySelector(\"#left-menu-empty-item\");\n\t\tjsDD.unregisterDest(firstNode);\n\t\tjsDD.unregisterDest(this.parentContainer\n\t\t\t.querySelector(\"#left-menu-hidden-empty-item\"));\n\t\tjsDD.unregisterDest(this.parentContainer\n\t\t\t.querySelector(\"#left-menu-hidden-separator\"));\n\t\tjsDD.refreshDestArea();\n\t\tEventEmitter.emit(\n\t\t\tthis,\n\t\t\tOptions.eventName('onDragModeOff')\n\t\t);\n\t}\n\t/*endregion*/\n}\n","import {Text, Tag, Loc} from 'main.core';\nimport {PopupManager, Popup} from 'main.popup';\nimport {EventEmitter} from 'main.core.events';\nimport Backend from '../backend';\nimport Options from '../options';\nimport DefaultController from './default-controller';\nimport ItemUserSelf from '../items/item-user-self';\nimport ItemUserFavorites from \"../items/item-user-favorites\";\nimport Utils from \"../utils\";\n\nexport default class ItemDirector extends DefaultController\n{\n\n\tconstructor(container, params)\n\t{\n\t\tsuper(container, params);\n\t}\n\n\tsaveCurrentPage(page: ?Object)\n\t{\n\t\treturn ItemUserFavorites\n\t\t\t.saveCurrentPage(page)\n\t\t\t.then((data) => {\n\t\t\t\tEventEmitter.emit(\n\t\t\t\t\tthis,\n\t\t\t\t\tOptions.eventName('onItemHasBeenAdded'),\n\t\t\t\t\tdata\n\t\t\t\t);\n\t\t\t\treturn data;\n\t\t\t})\n\t\t\t.catch(Utils.catchError);\n\t}\n\n\tsaveStandardPage(topItem)\n\t{\n\t\treturn ItemUserFavorites\n\t\t\t.saveStandardPage(topItem)\n\t\t\t.then((data) => {\n\t\t\t\tEventEmitter.emit(\n\t\t\t\t\tthis,\n\t\t\t\t\tOptions.eventName('onItemHasBeenAdded'),\n\t\t\t\t\tdata\n\t\t\t\t);\n\t\t\t\treturn data;\n\t\t\t})\n\t\t\t.catch(Utils.catchError);\n\t}\n\n\tdeleteCurrentPage({pageLink})\n\t{\n\t\treturn ItemUserFavorites\n\t\t\t.deleteCurrentPage({pageLink})\n\t\t\t.then((data) => {\n\n\t\t\t\tEventEmitter.emit(this,\n\t\t\t\t\tOptions.eventName('onItemHasBeenDeleted'),\n\t\t\t\t\tdata\n\t\t\t\t);\n\t\t\t\treturn data;\n\t\t\t})\n\t\t\t.catch(Utils.catchError);\n\t}\n\n\tdeleteStandardPage(topItem)\n\t{\n\t\treturn ItemUserFavorites\n\t\t\t.deleteStandardPage(topItem)\n\t\t\t.then((data) => {\n\t\t\t\tEventEmitter.emit(this,\n\t\t\t\t\tOptions.eventName('onItemHasBeenDeleted'),\n\t\t\t\t\tdata\n\t\t\t\t);\n\t\t\t\treturn data;\n\t\t\t})\n\t\t\t.catch(Utils.catchError);\n\t}\n\n\tshowAddToSelf(bindElement)\n\t{\n\t\tItemUserSelf\n\t\t\t.showAdd(bindElement)\n\t\t\t.then((data) => {\n\t\t\t\tEventEmitter.emit(this,\n\t\t\t\t\tOptions.eventName('onItemHasBeenAdded'),\n\t\t\t\t\tdata\n\t\t\t\t);\n\t\t\t}).catch(Utils.catchError);\n\t}\n}\n","import { sendData } from 'ui.analytics';\n\nexport class Analytics\n{\n\t#isAdmin: boolean;\n\n\tconstructor(isAdmin: boolean) {\n\t\tthis.#isAdmin = isAdmin ? AnalyticUserRole.ADMIN : AnalyticUserRole.NOT_ADMIN;\n\t}\n\n\tsendSetCustomPreset()\n\t{\n\t\tsendData({\n\t\t\ttool: AnalyticTool,\n\t\t\tcategory: AnalyticCategory.MENU,\n\t\t\tevent: AnalyticEvent.SET,\n\t\t\ttype: 'custom',\n\t\t\tc_section: AnalyticSection.MENU,\n\t\t\tp1: this.#isAdmin,\n\t\t});\n\t}\n\n\tsendSetPreset(presetId: string, isPersonal: boolean, action)\n\t{\n\t\tsendData({\n\t\t\ttype: presetId,\n\t\t\tevent: isPersonal ? AnalyticEvent.CHANGE : AnalyticEvent.SELECT,\n\t\t\ttool: AnalyticTool,\n\t\t\tcategory: isPersonal ? AnalyticCategory.MENU : AnalyticCategory.TOOL,\n\t\t\tc_section: isPersonal ? AnalyticSection.MENU : AnalyticSection.POPUP,\n\t\t\tc_element: action,\n\t\t\tp1: this.#isAdmin,\n\t\t});\n\t}\n\n\tsendClose()\n\t{\n\t\tsendData({\n\t\t\tevent: AnalyticEvent.SHOW,\n\t\t\ttool: AnalyticTool,\n\t\t\tcategory: AnalyticCategory.TOOL,\n\t\t\tc_section: AnalyticSection.POPUP,\n\t\t});\n\t}\n}\n\nconst AnalyticCategory = {\n\tTOOL: 'main_tool',\n\tMENU: 'main_menu',\n};\n\nconst AnalyticEvent = {\n\tSHOW: 'window_show',\n\tSELECT: 'select',\n\tCHANGE: 'change',\n\tSET: 'menu_set',\n};\n\nconst AnalyticUserRole = {\n\tADMIN: 'isAdmin_Y',\n\tNOT_ADMIN: 'isAdmin_N',\n};\n\nconst AnalyticSection = {\n\tPOPUP: 'menu_popup',\n\tPRESET: 'preset',\n\tQUALIFICATION: 'qualification',\n\tSETTINGS: 'settings',\n\tMENU: 'main_menu',\n};\n\nexport const AnalyticActions = {\n\tCONFIRM: 'confirm',\n\tLATER: 'later',\n\tCLOSE: 'close',\n\tSAVE: 'save',\n\tSKIP: 'skip',\n};\n\nconst AnalyticTool = 'intranet';\n","import {Cache, Loc, ajax, Type, Dom} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport {PopupManager, MenuItem} from 'main.popup';\nimport PresetCustomController from './controllers/preset-custom-controller';\nimport PresetDefaultController from './controllers/preset-default-controller';\nimport SettingsController from './controllers/settings-controller';\nimport Options from './options';\nimport Backend from './backend';\nimport ItemsController from './controllers/items-controller'\nimport ItemDirector from './controllers/item-director'\nimport Item from \"./items/item\";\nimport ItemSystem from \"./items/item-system\";\nimport Utils from './utils';\nimport ItemUserFavorites from \"./items/item-user-favorites\";\nimport {MessageBox, MessageBoxButtons} from 'ui.dialogs.messagebox';\nimport { BannerDispatcher } from 'ui.banner-dispatcher';\nimport { Analytics, AnalyticActions } from './analytics';\n\nexport default class Menu\n{\n\t//region containers\n\tmenuContainer;\n\tmenuHeader;\n\tmenuBody;\n\theader;\n\theaderBurger;\n\theaderSettings;\n\tmainTable;\n\tupButton;\n\tmenuMoreButton;\n\t//endregion\n\n\tcache = new Cache.MemoryCache();\n\n\tscrollModeThreshold = 20;//\n\tlastScrollOffset = 0;\n\tslidingModeTimeoutId = 0;\n\n\ttopMenuSelectedNode = null;//\n\ttopItemSelectedObj = null;\n\n\tisMenuMouseEnterBlocked = false;\n\tisMenuMouseLeaveBlocked = [];\n\tisCollapsedMode = false;\n\n\tworkgroupsCounterData = {};\n\n\tconstructor(params)\n\t{\n\t\t//TODO     html\n\t\tthis.menuContainer = document.getElementById(\"menu-items-block\");\n\t\tif (!this.menuContainer)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\t\tparams = typeof params === \"object\" ? params : {};\n\n\t\tOptions.isExtranet = params.isExtranet === 'Y';\n\t\tOptions.isMainPageEnabled = params.isMainPageEnabled === 'Y';\n\t\tOptions.isAdmin = params.isAdmin;\n\t\tOptions.isCustomPresetRestricted = params.isCustomPresetAvailable !== 'Y';\n\t\tOptions.availablePresetTools = params.availablePresetTools;\n\t\tOptions.settingsPath = params.settingsPath;\n\n\t\tthis.isCollapsedMode = params.isCollapsedMode;\n\t\tthis.workgroupsCounterData = params.workgroupsCounterData;\n\t\tthis.analytics = new Analytics(params.isAdmin);\n\n\t\tthis.initAndBindNodes();\n\t\tthis.bindEvents();\n\t\tthis.getItemsController();\n\t\t//Emulate document scroll because init() can be invoked after page load scroll (a hard reload with script at the bottom).\n\t\tthis.handleDocumentScroll();\n\t}\n\n\tinitAndBindNodes()\n\t{\n\t\tthis.menuContainer.addEventListener(\"dblclick\", this.handleMenuDoubleClick.bind(this));\n\t\tthis.menuContainer.addEventListener(\"mouseenter\", this.handleMenuMouseEnter.bind(this));\n\t\tthis.menuContainer.addEventListener(\"mouseleave\", this.handleMenuMouseLeave.bind(this));\n\t\tthis.menuContainer.addEventListener(\"transitionend\", this.handleSlidingTransitionEnd.bind(this));\n\n\t\tthis.menuHeader = this.menuContainer.querySelector(\".menu-items-header\");\n\t\tthis.menuBody = this.menuContainer.querySelector(\".menu-items-body\");\n\t\tthis.menuItemsBlock = this.menuContainer.querySelector(\".menu-items\");\n\n\t\tthis.header = document.querySelector(\"#header\");\n\t\tthis.headerBurger = this.header.querySelector(\".menu-switcher\");\n\n\t\tconst headerLogoBlock = this.header.querySelector(\".header-logo-block\");\n\t\tthis.headerSettings = this.header.querySelector(\".header-logo-block-settings\");\n\t\tif (this.headerSettings)\n\t\t{\n\t\t\theaderLogoBlock.addEventListener(\"mouseenter\", this.handleHeaderLogoMouserEnter.bind(this));\n\t\t\theaderLogoBlock.addEventListener(\"mouseleave\", this.handleHeaderLogoMouserLeave.bind(this));\n\t\t\tthis.menuHeader.addEventListener(\"mouseenter\", this.handleHeaderLogoMouserEnter.bind(this));\n\t\t\tthis.menuHeader.addEventListener(\"mouseleave\", this.handleHeaderLogoMouserLeave.bind(this));\n\t\t}\n\t\tdocument.addEventListener(\"scroll\", this.handleDocumentScroll.bind(this));\n\n\t\tthis.mainTable = document.querySelector(\".bx-layout-table\");\n\t\tthis.menuHeaderBurger = this.menuHeader.querySelector(\".menu-switcher\");\n\t\tthis.menuHeaderBurger\n\t\t\t.addEventListener('click', this.handleBurgerClick.bind(this));\n\t\tthis.menuHeader.querySelector(\".menu-items-header-title\")\n\t\t\t.addEventListener('click', this.handleBurgerClick.bind(this, true));\n\n\t\tthis.upButton = this.menuContainer.querySelector(\".menu-btn-arrow-up\");\n\t\tthis.upButton.addEventListener(\"click\", this.handleUpButtonClick.bind(this));\n\t\tthis.menuMoreButton = this.menuContainer.querySelector(\".menu-favorites-more-btn\");\n\t\tthis.menuMoreButton.addEventListener(\"click\", this.handleShowHiddenClick.bind(this));\n\n\t\tconst helperItem = this.menuContainer.querySelector(\".menu-help-btn\");\n\n\t\tif (helperItem)\n\t\t{\n\t\t\thelperItem.addEventListener('click', this.handleHelperClick.bind(this));\n\t\t}\n\n\t\tconst siteMapItem = this.menuContainer.querySelector(\".menu-sitemap-btn\");\n\t\tif (siteMapItem)\n\t\t{\n\t\t\tsiteMapItem.addEventListener('click', this.handleSiteMapClick.bind(this));\n\t\t}\n\n\t\tconst settingsSaveBtn = this.menuContainer.querySelector(\".menu-settings-save-btn\")\n\t\tif (settingsSaveBtn)\n\t\t{\n\t\t\tsettingsSaveBtn.addEventListener('click', this.handleViewMode.bind(this));\n\t\t}\n\t\tthis.menuContainer.querySelector(\".menu-settings-btn\").addEventListener('click', () => {\n\t\t\tthis.getSettingsController().show();\n\t\t})\n\t}\n\n\t// region Controllers\n\tgetItemsController(): ItemsController\n\t{\n\t\treturn this.cache.remember('itemsController', () => {\n\t\t\treturn new ItemsController(\n\t\t\t\tthis.menuContainer,\n\t\t\t\t{\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tEditMode: () => {\n\t\t\t\t\t\t\tthis.toggle(true);\n\t\t\t\t\t\t\tthis.menuContainer.classList.add('menu-items-edit-mode');\n\t\t\t\t\t\t\tthis.menuContainer.classList.remove('menu-items-view-mode');\n\t\t\t\t\t\t},\n\t\t\t\t\t\tViewMode: () => {\n\t\t\t\t\t\t\tthis.toggle(true);\n\t\t\t\t\t\t\tthis.menuContainer.classList.add('menu-items-view-mode');\n\t\t\t\t\t\t\tthis.menuContainer.classList.remove('menu-items-edit-mode');\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonDragModeOn: ({target}) => {\n\t\t\t\t\t\t\tthis.switchToSlidingMode(true);\n\t\t\t\t\t\t\tthis.isMenuMouseLeaveBlocked.push('drag');\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonDragModeOff: ({target}) => {\n\t\t\t\t\t\t\tthis.isMenuMouseLeaveBlocked.pop();\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonHiddenBlockIsVisible: this.onHiddenBlockIsVisible.bind(this),\n\t\t\t\t\t\tonHiddenBlockIsHidden: this.onHiddenBlockIsHidden.bind(this),\n\t\t\t\t\t\tonHiddenBlockIsEmpty: this.onHiddenBlockIsEmpty.bind(this),\n\t\t\t\t\t\tonHiddenBlockIsNotEmpty: this.onHiddenBlockIsNotEmpty.bind(this),\n\t\t\t\t\t\tonShow: () => { this.isMenuMouseLeaveBlocked.push('items'); },\n\t\t\t\t\t\tonClose: () => { this.isMenuMouseLeaveBlocked.pop(); },\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t);\n\t\t});\n\t}\n\n\tgetItemDirector(): ItemDirector\n\t{\n\t\treturn this.cache.remember('itemsCreator', () => {\n\t\t\treturn new ItemDirector(\n\t\t\t\tthis.menuContainer,\n\t\t\t\t{\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tonItemHasBeenAdded: ({data}) => {\n\t\t\t\t\t\t\tthis.getItemsController().addItem(data);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t);\n\t\t});\n\t}\n\n\tgetSettingsController(): SettingsController\n\t{\n\t\treturn this.cache.remember('presetController', () => {\n\t\t\treturn new SettingsController(\n\t\t\t\tthis.menuContainer.querySelector(\".menu-settings-btn\"),\n\t\t\t\t{\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tonGettingSettingMenuItems: this.onGettingSettingMenuItems.bind(this),\n\t\t\t\t\t\tonShow: () => { this.isMenuMouseLeaveBlocked.push('settings'); },\n\t\t\t\t\t\tonClose: () => { this.isMenuMouseLeaveBlocked.pop(); },\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t);\n\t\t});\n\t}\n\n\tgetCustomPresetController(): PresetCustomController\n\t{\n\t\treturn this.cache.remember('customPresetController', () => {\n\t\t\treturn new PresetCustomController(\n\t\t\t\tthis.menuContainer,\n\t\t\t\t{\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tonPresetIsSet: ({ data }) => {\n\t\t\t\t\t\t\tconst { saveSortItems, firstItemLink, customItems } = this.getItemsController().export();\n\n\t\t\t\t\t\t\tif (!data)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.analytics.sendSetCustomPreset();\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\treturn Backend.setCustomPreset(data, saveSortItems, customItems, firstItemLink)\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonShow: () => { this.isMenuMouseLeaveBlocked.push('presets'); },\n\t\t\t\t\t\tonClose: () => { this.isMenuMouseLeaveBlocked.pop(); },\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t);\n\t\t});\n\t}\n\n\tgetDefaultPresetController(): PresetDefaultController\n\t{\n\t\tlet shouldSendCloseEvent = true;\n\n\t\treturn this.cache.remember('defaultPresetController', () => {\n\t\t\tconst presetController = new PresetDefaultController(\n\t\t\t\tthis.menuContainer,\n\t\t\t\t{\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tonPresetIsSet: ({ data: { mode, presetId } }) => {\n\t\t\t\t\t\t\tthis.analytics.sendSetPreset(\n\t\t\t\t\t\t\t\tpresetId,\n\t\t\t\t\t\t\t\tmode === 'personal',\n\t\t\t\t\t\t\t\tAnalyticActions.CONFIRM,\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tshouldSendCloseEvent = false;\n\n\t\t\t\t\t\t\treturn Backend.setSystemPreset(mode, presetId);\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonPresetIsPostponed: ({ data: { mode } }) => {\n\t\t\t\t\t\t\tthis.analytics.sendSetPreset(\n\t\t\t\t\t\t\t\tpresetController.getSelectedPreset(),\n\t\t\t\t\t\t\t\tmode === 'personal',\n\t\t\t\t\t\t\t\tAnalyticActions.LATER,\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tshouldSendCloseEvent = false;\n\n\t\t\t\t\t\t\tconst result = Backend.postponeSystemPreset(mode);\n\t\t\t\t\t\t\tEventEmitter.emit(this, Options.eventName('onPresetIsPostponed'));\n\n\t\t\t\t\t\t\treturn result;\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonShow: () => {\n\t\t\t\t\t\t\tthis.analytics.sendClose();\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonClose: () => {\n\t\t\t\t\t\t\tif (shouldSendCloseEvent)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.analytics.sendSetPreset(\n\t\t\t\t\t\t\t\t\tpresetController.getSelectedPreset(),\n\t\t\t\t\t\t\t\t\tpresetController.getMode() === 'personal',\n\t\t\t\t\t\t\t\t\tAnalyticActions.CLOSE,\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n/*\n\t\t\t\t\t\tonShow: () => { this.isMenuMouseLeaveBlocked.push('presets-default'); },\n\t\t\t\t\t\tonClose: () => { this.isMenuMouseLeaveBlocked.pop(); },\n*/\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t);\n\n\t\t\treturn presetController;\n\t\t});\n\t}\n\t//endregion\n\n\tbindEvents()\n\t{\n\t\t//just to hold opened menu in collapsing mode when groups are shown\n\t\tBX.addCustomEvent(\"BX.Bitrix24.GroupPanel:onOpen\", this.handleGroupPanelOpen.bind(this));\n\t\tBX.addCustomEvent(\"BX.Bitrix24.GroupPanel:onClose\", this.handleGroupPanelClose.bind(this));\n\n\t\t//region Top menu integration\n\t\tBX.addCustomEvent('BX.Main.InterfaceButtons:onFirstItemChange', (firstPageLink, firstNode) => {\n\t\t\tif (!firstPageLink || !Type.isDomNode(firstNode))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst topMenuId = firstNode.getAttribute(\"data-top-menu-id\");\n\t\t\tconst leftMenuNode = this.menuBody.querySelector(`[data-top-menu-id=\"${topMenuId}\"]`);\n\t\t\tif (leftMenuNode)\n\t\t\t{\n\t\t\t\tleftMenuNode.setAttribute(\"data-link\", firstPageLink);\n\t\t\t\tconst leftMenuLink = leftMenuNode.querySelector('a.menu-item-link');\n\t\t\t\tif (leftMenuLink)\n\t\t\t\t{\n\t\t\t\t\tleftMenuLink.setAttribute(\"href\", firstPageLink);\n\t\t\t\t}\n\n\t\t\t\tif (leftMenuNode.previousElementSibling === this.menuContainer.querySelector('#left-menu-empty-item'))\n\t\t\t\t{\n\t\t\t\t\tBackend.setFirstPage(firstPageLink);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tBackend.clearCache();\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.showMessage(firstNode, Loc.getMessage('MENU_ITEM_MAIN_SECTION_PAGE'));\n\t\t});\n\t\tBX.addCustomEvent(\"BX.Main.InterfaceButtons:onHideLastVisibleItem\", (bindElement) => {\n\t\t\tthis.showMessage(bindElement, Loc.getMessage(\"MENU_TOP_ITEM_LAST_HIDDEN\"));\n\t\t});\n\t\t//when we edit top menu item\n\t\tBX.addCustomEvent(\"BX.Main.InterfaceButtons:onBeforeCreateEditMenu\", (contextMenu, dataItem, topMenu) => {\n\t\t\tlet item = this.#getLeftMenuItemByTopMenuItem(dataItem);\n\t\t\tif (!item && dataItem && Type.isStringFilled(dataItem.URL) && !dataItem.URL.match(/javascript:/))\n\t\t\t{\n\t\t\t\tcontextMenu.addMenuItem({\n\t\t\t\t\ttext: Loc.getMessage(\"MENU_ADD_TO_LEFT_MENU\"),\n\t\t\t\t\tonclick: (event, item) => {\n\t\t\t\t\t\tthis.getItemDirector()\n\t\t\t\t\t\t\t.saveStandardPage(dataItem)\n\t\t\t\t\t\t;\n\t\t\t\t\t\titem.getMenuWindow().close();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\telse if (item instanceof ItemUserFavorites)\n\t\t\t{\n\t\t\t\tcontextMenu.addMenuItem({\n\t\t\t\t\ttext: Loc.getMessage(\"MENU_DELETE_FROM_LEFT_MENU\"),\n\t\t\t\t\tonclick: (event, item) => {\n\t\t\t\t\t\tthis.getItemDirector()\n\t\t\t\t\t\t\t.deleteStandardPage(dataItem)\n\t\t\t\t\t\t;\n\t\t\t\t\t\titem.getMenuWindow().close();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t\t//endregion\n\t\t//service event for UI.Toolbar\n\t\ttop.BX.addCustomEvent('UI.Toolbar:onRequestMenuItemData', ({currentFullPath, context}) => {\n\t\t\tif (Type.isStringFilled(currentFullPath))\n\t\t\t{\n\t\t\t\tBX.onCustomEvent('BX.Bitrix24.LeftMenuClass:onSendMenuItemData', [{\n\t\t\t\t\tcurrentPageInMenu: this.menuContainer.querySelector(`.menu-item-block[data-link=\"${currentFullPath}\"]`),\n\t\t\t\t\tcontext: context,\n\t\t\t\t}]);\n\t\t\t}\n\t\t});\n\t\t//When clicked on a start Favorites like\n\t\tEventEmitter.subscribe('UI.Toolbar:onStarClick', ({compatData: [params]}) => {\n\t\t\tif (params.isActive)\n\t\t\t{\n\t\t\t\tthis.getItemDirector().deleteCurrentPage({\n\t\t\t\t\tcontext: params.context,\n\t\t\t\t\tpageLink: params.pageLink,\n\t\t\t\t}).then(({itemInfo}) => {\n\t\t\t\t\tBX.onCustomEvent(\"BX.Bitrix24.LeftMenuClass:onMenuItemDeleted\", [itemInfo, this]);\n\t\t\t\t\tBX.onCustomEvent('BX.Bitrix24.LeftMenuClass:onStandardItemChangedSuccess', [{\n\t\t\t\t\t\tisActive: false,\n\t\t\t\t\t\tcontext: params.context,\n\t\t\t\t\t}]);\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.getItemDirector()\n\t\t\t\t\t.saveCurrentPage({\n\t\t\t\t\tpageTitle: params.pageTitle,\n\t\t\t\t\tpageLink: params.pageLink,\n\t\t\t\t}).then(({itemInfo}) => {\n\t\t\t\t\tBX.onCustomEvent(\"BX.Bitrix24.LeftMenuClass:onMenuItemAdded\", [itemInfo, this]);\n\t\t\t\t\tBX.onCustomEvent('BX.Bitrix24.LeftMenuClass:onStandardItemChangedSuccess', [{\n\t\t\t\t\t\tisActive: true,\n\t\t\t\t\t\tcontext: params.context,\n\t\t\t\t\t}]);\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t\tEventEmitter.subscribe('BX.Main.InterfaceButtons:onBeforeResetMenu', ({compatData: [promises]}) => {\n\t\t\tpromises.push(() => {\n\t\t\t\tconst p = new BX.Promise();\n\t\t\t\tBackend\n\t\t\t\t\t.clearCache()\n\t\t\t\t\t.then(\n\t\t\t\t\t\t() => { p.fulfill();},\n\t\t\t\t\t\t(response) => { p.reject(\"Error: \" +  response.errors[0].message);}\n\t\t\t\t\t)\n\t\t\t\t;\n\t\t\t\treturn p;\n\t\t\t});\n\t\t});\n\t}\n\n\tisEditMode()\n\t{\n\t\treturn this.getItemsController().isEditMode;\n\t}\n\n\tisCollapsed()\n\t{\n\t\treturn this.isCollapsedMode;\n\t}\n\n\tshowMessage(bindElement, message, position)\n\t{\n\t\tvar popup = PopupManager.create(\n\t\t\t\"left-menu-message\",\n\t\t\tbindElement,\n\t\t\t{\n\t\t\t\tcontent: '<div class=\"left-menu-message-popup\">' + message + '</div>',\n\t\t\t\tdarkMode: true,\n\t\t\t\toffsetTop: position === \"right\" ? -45 : 2,\n\t\t\t\toffsetLeft: position === \"right\" ? 215 : 0,\n\t\t\t\tangle: position === \"right\" ? {position: \"left\"} : true,\n\t\t\t\tcacheable: false,\n\t\t\t\tautoHide: true,\n\t\t\t\tevents: {\n\t\t\t\t\tonDestroy: function () {\n\t\t\t\t\t\tpopup = null;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t})\n\t\t;\n\n\t\tpopup.show();\n\n\t\tsetTimeout(function ()\n\t\t{\n\t\t\tif (popup)\n\t\t\t{\n\t\t\t\tpopup.close();\n\t\t\t\tpopup = null;\n\t\t\t}\n\t\t}, 3000);\n\t}\n\n\tshowError(bindElement)\n\t{\n\t\tthis.showMessage(bindElement, Loc.getMessage('edit_error'));\n\t}\n\n\tshowGlobalPreset()\n\t{\n\t\tBannerDispatcher.high.toQueue((onDone) => {\n\t\t\tconst presetController = this.getDefaultPresetController();\n\t\t\tpresetController.show('global');\n\t\t\tpresetController.getPopup().subscribe('onAfterClose', (event) => {\n\t\t\t\tonDone();\n\t\t\t});\n\t\t});\n\t}\n\n\thandleShowHiddenClick()\n\t{\n\t\tthis.getItemsController().toggleHiddenContainer(true);\n\t}\n\n\tonHiddenBlockIsVisible()\n\t{\n\t\tDom.addClass(this.menuMoreButton, 'menu-favorites-more-btn-open');\n\t\tthis.menuMoreButton.querySelector(\"#menu-more-btn-text\").innerHTML = Loc.getMessage(\"more_items_hide\");\n\t}\n\n\tonHiddenBlockIsHidden()\n\t{\n\t\tDom.removeClass(this.menuMoreButton, 'menu-favorites-more-btn-open');\n\t\tthis.menuMoreButton.querySelector(\"#menu-more-btn-text\").innerHTML = Loc.getMessage(\"more_items_show\");\n\t}\n\n\tonHiddenBlockIsEmpty()\n\t{\n\t\tDom.addClass(this.menuMoreButton, 'menu-favorites-more-btn-hidden');\n\t}\n\n\tonHiddenBlockIsNotEmpty()\n\t{\n\t\tDom.removeClass(this.menuMoreButton, 'menu-favorites-more-btn-hidden');\n\t}\n\n\tsetDefaultMenu()\n\t{\n\t\tMessageBox.show({\n\t\t\tmessage: Loc.getMessage('MENU_SET_DEFAULT_CONFIRM'),\n\t\t\tonYes: (messageBox, button) => {\n\t\t\t\tbutton.setWaiting();\n\t\t\t\tBackend\n\t\t\t\t\t.setDefaultPreset()\n\t\t\t\t\t.then(() => {\n\t\t\t\t\t\tbutton.setWaiting(false);\n\t\t\t\t\t\tmessageBox.close();\n\t\t\t\t\t\tdocument.location.reload();\n\t\t\t\t\t})\n\t\t\t\t;\n\t\t\t},\n\t\t\tbuttons: MessageBoxButtons.YES_CANCEL\n\t\t});\n\t}\n\n\tclearCompositeCache()\n\t{\n\t\tajax.runAction('intranet.leftmenu.clearCache', {data: {}});\n\t}\n\n\t#getLeftMenuItemByTopMenuItem({DATA_ID, NODE}): ?Item\n\t{\n\t\tlet item = this.getItemsController().items.get(DATA_ID);\n\t\tif (!item)\n\t\t{\n\t\t\tconst topMenuId = NODE.getAttribute('data-top-menu-id');\n\t\t\tif (NODE === NODE.parentNode.querySelector('[data-top-menu-id]'))\n\t\t\t{\n\t\t\t\tconst leftMenuNode = this.menuItemsBlock.querySelector(`[data-top-menu-id=\"${topMenuId}\"]`);\n\t\t\t\tif (leftMenuNode)\n\t\t\t\t{\n\t\t\t\t\titem = this.getItemsController().items.get(leftMenuNode.getAttribute('data-id'));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn item ?? null;\n\t}\n\t// region Events servicing functions\n\tonGettingSettingMenuItems()\n\t{\n\t\tconst topPoint = ItemUserFavorites.getActiveTopMenuItem();\n\t\tlet menuItemWithAddingToFavorites = null;\n\t\tif (topPoint)\n\t\t{\n\t\t\tconst node = this.menuContainer.querySelector(`.menu-item-block[data-link=\"${topPoint['URL']}\"]`);\n\t\t\tif (!node)\n\t\t\t{\n\t\t\t\tmenuItemWithAddingToFavorites = {\n\t\t\t\t\ttext: Loc.getMessage(\"MENU_ADD_TO_LEFT_MENU\"),\n\t\t\t\t\tonclick: (event, item) => {\n\t\t\t\t\t\tthis.getItemDirector()\n\t\t\t\t\t\t\t.saveStandardPage(topPoint)\n\t\t\t\t\t\t;\n\t\t\t\t\t\titem.getMenuWindow().destroy();\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t}\n\t\t\telse if (node.getAttribute('data-type') === ItemUserFavorites.code)\n\t\t\t{\n\t\t\t\tmenuItemWithAddingToFavorites = {\n\t\t\t\t\ttext: Loc.getMessage(\"MENU_DELETE_FROM_LEFT_MENU\"),\n\t\t\t\t\tonclick: (event, item) => {\n\t\t\t\t\t\tthis.getItemDirector()\n\t\t\t\t\t\t\t.deleteStandardPage(topPoint)\n\t\t\t\t\t\t;\n\t\t\t\t\t\titem.getMenuWindow().destroy();\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tmenuItemWithAddingToFavorites = {\n\t\t\t\t\ttext: Loc.getMessage('MENU_DELETE_PAGE_FROM_LEFT_MENU'),\n\t\t\t\t\tclassName: 'menu-popup-disable-text',\n\t\t\t\t\tonclick: () => { }\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\n\n\t\tconst menuItems = [\n\t\t\t{\n\t\t\t\ttext: Loc.getMessage('SORT_ITEMS'),\n\t\t\t\tonclick: () => { this.getItemsController().switchToEditMode();}\n\t\t\t},\n\t\t\t{\n\t\t\t\ttext: this.isCollapsed() ? Loc.getMessage('MENU_EXPAND') : Loc.getMessage('MENU_COLLAPSE'),\n\t\t\t\tonclick: (event, item: MenuItem) => {\n\t\t\t\t\tthis.toggle();\n\t\t\t\t\titem.getMenuWindow().destroy();\n\t\t\t\t}\n\t\t\t},\n\t\t\tmenuItemWithAddingToFavorites,\n\t\t\t{\n\t\t\t\ttext: Loc.getMessage('MENU_ADD_SELF_PAGE'),\n\t\t\t\tonclick: (event, item: MenuItem) => {\n\t\t\t\t\tthis\n\t\t\t\t\t\t.getItemDirector()\n\t\t\t\t\t\t.showAddToSelf(\n\t\t\t\t\t\t\tthis.getSettingsController().getContainer()\n\t\t\t\t\t\t)\n\t\t\t\t\t;\n\t\t\t\t},\n\t\t\t},\n\t\t\tOptions.isExtranet ? null : {\n\t\t\t\ttext: Loc.getMessage('MENU_SET_DEFAULT2'),\n\t\t\t\tonclick: () => {\n\t\t\t\t\tthis.getDefaultPresetController().show('personal')\n\t\t\t\t}\n\t\t\t},\n\t\t\tOptions.isExtranet ? null : {\n\t\t\t\ttext: Loc.getMessage('MENU_SET_DEFAULT'),\n\t\t\t\tonclick: this.setDefaultMenu.bind(this)\n\t\t\t}\n\t\t];\n\t\t//custom preset\n\t\tif (Options.isAdmin)\n\t\t{\n\t\t\tlet itemText = Loc.getMessage('MENU_SAVE_CUSTOM_PRESET');\n\n\t\t\tif (Options.isCustomPresetRestricted)\n\t\t\t{\n\t\t\t\titemText+= \"<span class='menu-lock-icon'></span>\";\n\t\t\t}\n\n\t\t\tmenuItems.push({\n\t\t\t\thtml: itemText,\n\t\t\t\tclassName: (Options.isCustomPresetRestricted ? ' menu-popup-disable-text' : ''),\n\t\t\t\tonclick: (event, item) => {\n\t\t\t\t\tif (Options.isCustomPresetRestricted)\n\t\t\t\t\t{\n\t\t\t\t\t\tBX.UI.InfoHelper.show('limit_office_menu_to_all');\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.getCustomPresetController().show();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (Options.settingsPath)\n\t\t\t{\n\t\t\t\tmenuItems.push({\n\t\t\t\t\thtml: Loc.getMessage('MENU_EDIT_TOOLS'),\n\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\tBX.SidePanel.Instance.open(`${Options.settingsPath}?analyticContext=left_menu&page=tools`, {\n\t\t\t\t\t\t\tallowChangeHistory: false,\n\t\t\t\t\t\t\twidth: 1034,\n\t\t\t\t\t\t});\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\treturn menuItems.filter((value) => {return value !== null;})\n\t}\n\n\t// endregion\n\n\thandleSiteMapClick()\n\t{\n\t\tthis.switchToSlidingMode(false);\n\n\t\tBX.SidePanel.Instance.open(\n\t\t\t(Loc.getMessage('SITE_DIR') || '/') + 'sitemap/',\n\t\t\t{\n\t\t\t\tallowChangeHistory: false,\n\t\t\t\tcustomLeftBoundary: 0\n\t\t\t}\n\t\t);\n\t}\n\n\thandleHelperClick()\n\t{\n\t\tthis.switchToSlidingMode(false);\n\t\tBX.Helper.show();\n\t}\n\n\t// region Sliding functions\n\tblockSliding()\n\t{\n\t\tthis.stopSliding()\n\t\tthis.isMenuMouseEnterBlocked = true;\n\t}\n\n\treleaseSliding()\n\t{\n\t\tthis.isMenuMouseEnterBlocked = false;\n\t}\n\n\tstopSliding()\n\t{\n\t\tclearTimeout(this.slidingModeTimeoutId);\n\t\tthis.slidingModeTimeoutId = 0;\n\t}\n\n\tstartSliding()\n\t{\n\t\tthis.stopSliding();\n\t\tif (this.isMenuMouseEnterBlocked === true)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tthis.slidingModeTimeoutId = setTimeout(function() {\n\t\t\tthis.slidingModeTimeoutId = 0;\n\t\t\tthis.switchToSlidingMode(true);\n\t\t}.bind(this), 400);\n\t}\n\n\thandleBurgerClick(open)\n\t{\n\t\tthis.getItemsController().switchToViewMode();\n\n\t\tthis.menuHeaderBurger.classList.add(\"menu-switcher-hover\");\n\n\t\tthis.toggle(open, function() {\n\n\t\t\tthis.blockSliding();\n\n\t\t\tsetTimeout(function() {\n\t\t\t\tthis.menuHeaderBurger.classList.remove(\"menu-switcher-hover\");\n\n\t\t\t\tthis.releaseSliding();\n\n\t\t\t}.bind(this), 100);\n\n\t\t}.bind(this));\n\t}\n\n\thandleMenuMouseEnter(event)\n\t{\n\t\tif (!this.isCollapsed())\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tthis.startSliding();\n\t}\n\n\thandleMenuMouseLeave(event)\n\t{\n\t\tthis.stopSliding();\n\t\tif (this.isMenuMouseLeaveBlocked.length <= 0)\n\t\t{\n\t\t\tthis.switchToSlidingMode(false);\n\t\t}\n\t}\n\n\thandleMenuDoubleClick(event)\n\t{\n\t\tif (event.target === this.menuBody)\n\t\t{\n\t\t\tthis.toggle();\n\t\t}\n\t}\n\n\thandleHeaderLogoMouserEnter(event)\n\t{\n\t\tBX.addClass(this.headerSettings, \"header-logo-block-settings-show\");\n\t}\n\n\thandleHeaderLogoMouserLeave(event)\n\t{\n\t\tif (!this.headerSettings.hasAttribute(\"data-rename-portal\"))\n\t\t{\n\t\t\tBX.removeClass(this.headerSettings, \"header-logo-block-settings-show\");\n\t\t}\n\t}\n\n\thandleUpButtonClick()\n\t{\n\t\tthis.blockSliding();\n\n\t\tif (this.isUpButtonReversed())\n\t\t{\n\t\t\twindow.scrollTo(0, this.lastScrollOffset);\n\t\t\tthis.lastScrollOffset = 0;\n\t\t\tthis.unreverseUpButton();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.lastScrollOffset = window.pageYOffset;\n\t\t\twindow.scrollTo(0, 0);\n\t\t\tthis.reverseUpButton();\n\t\t}\n\n\t\tsetTimeout(this.releaseSliding.bind(this), 100);\n\t}\n\n\thandleUpButtonMouseLeave()\n\t{\n\t\tthis.releaseSliding();\n\t}\n\n\thandleDocumentScroll()\n\t{\n\t\tthis.#adjustAdminPanel();\n\t\tthis.applyScrollMode();\n\n\t\tif (window.pageYOffset > document.documentElement.clientHeight)\n\t\t{\n\t\t\tthis.showUpButton();\n\n\t\t\tif (this.isUpButtonReversed())\n\t\t\t{\n\t\t\t\tthis.unreverseUpButton();\n\t\t\t\tthis.lastScrollOffset = 0;\n\t\t\t}\n\t\t}\n\t\telse if (!this.isUpButtonReversed())\n\t\t{\n\t\t\tthis.hideUpButton();\n\t\t}\n\n\t\tif (window.pageXOffset > 0)\n\t\t{\n\t\t\tthis.menuContainer.style.left = -window.pageXOffset + \"px\";\n\t\t\tthis.upButton.style.left = -window.pageXOffset + (this.isCollapsed() ? 0 : 172) + \"px\";\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.menuContainer.style.removeProperty(\"left\");\n\t\t\tthis.upButton.style.removeProperty(\"left\");\n\t\t}\n\t}\n\n\tswitchToSlidingMode(enable, immediately)\n\t{\n\t\tif (enable === false)\n\t\t{\n\t\t\tthis.stopSliding();\n\n\t\t\tif (BX.hasClass(this.mainTable, \"menu-sliding-mode\"))\n\t\t\t{\n\t\t\t\tif (immediately !== true)\n\t\t\t\t{\n\t\t\t\t\tBX.addClass(this.mainTable, \"menu-sliding-closing-mode\");\n\t\t\t\t}\n\n\t\t\t\tBX.removeClass(this.mainTable, \"menu-sliding-mode menu-sliding-opening-mode\");\n\t\t\t}\n\t\t}\n\t\telse if (this.isCollapsedMode && !BX.hasClass(this.mainTable, \"menu-sliding-mode\"))\n\t\t{\n\t\t\tBX.removeClass(this.mainTable, \"menu-sliding-closing-mode\");\n\n\t\t\tif (immediately !== true)\n\t\t\t{\n\t\t\t\tBX.addClass(this.mainTable, \"menu-sliding-opening-mode\");\n\t\t\t}\n\n\t\t\tBX.addClass(this.mainTable, \"menu-sliding-mode\");\n\t\t}\n\t}\n\n\thandleSlidingTransitionEnd(event)\n\t{\n\t\tif (event.target === this.menuContainer)\n\t\t{\n\t\t\tBX.removeClass(this.mainTable, \"menu-sliding-opening-mode menu-sliding-closing-mode\");\n\t\t}\n\t}\n\n\tswitchToScrollMode(enable)\n\t{\n\t\tif (enable === false)\n\t\t{\n\t\t\tthis.mainTable.classList.remove('menu-scroll-mode');\n\t\t}\n\t\telse if (!this.mainTable.classList.contains('menu-scroll-mode'))\n\t\t{\n\t\t\tthis.mainTable.classList.add('menu-scroll-mode');\n\t\t}\n\t}\n\n\t//region logo\n\t#isLogoMaskNeeded(): boolean\n\t{\n\t\treturn this.cache.remember('isLogoMaskNeeded', () => {\n\t\t\tconst menuHeaderLogo = this.menuHeader.querySelector(\".logo\");\n\t\t\tlet result = false;\n\t\t\tif (menuHeaderLogo && !menuHeaderLogo.querySelector(\".logo-image-container\"))\n\t\t\t{\n\t\t\t\tlet widthMeasure = menuHeaderLogo.offsetWidth === 0 ?\n\t\t\t\t\t(this.header.querySelector(\".logo\") ?\n\t\t\t\t\t\tthis.header.querySelector(\".logo\").offsetWidth : 0)\n\t\t\t\t\t: menuHeaderLogo.offsetWidth\n\t\t\t\t;\n\n\t\t\t\tresult = widthMeasure > 200;\n\t\t\t}\n\t\t\treturn result;\n\t\t});\n\t}\n\n\tswitchToLogoMaskMode(enable)\n\t{\n\t\tif (!this.#isLogoMaskNeeded())\n\t\t{\n\t\t\treturn\n\t\t}\n\t\tif (enable === false)\n\t\t{\n\t\t\tthis.mainTable.classList.remove('menu-logo-mask-mode');\n\t\t}\n\t\telse if (!this.mainTable.classList.contains('menu-logo-mask-mode'))\n\t\t{\n\t\t\tthis.mainTable.classList.add('menu-logo-mask-mode');\n\t\t}\n\t}\n\t//endregion\n\n\ttoggle(flag, fn)\n\t{\n\t\tlet leftColumn = BX(\"layout-left-column\");\n\t\tif (!leftColumn)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst isOpen = !this.mainTable.classList.contains('menu-collapsed-mode');\n\n\t\tif (flag === isOpen || this.mainTable.classList.contains('menu-animation-mode'))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tBX.onCustomEvent(\"BX.Bitrix24.LeftMenuClass:onMenuToggle\", [flag, this]);\n\n\t\tvar logoImageContainer = this.menuHeader.querySelector(\".logo-image-container\");\n\t\tif (logoImageContainer)\n\t\t{\n\t\t\tvar logoWidth = this.header.querySelector(\".logo-image-container\").offsetWidth;\n\t\t\tif (logoWidth > 0)\n\t\t\t{\n\t\t\t\tlogoImageContainer.style.width = logoWidth + \"px\";\n\t\t\t}\n\t\t}\n\n\t\tthis.blockSliding();\n\t\tthis.switchToSlidingMode(false, true);\n\t\tthis.applyScrollMode();\n\n\t\tleftColumn.style.overflow = \"hidden\";\n\t\tthis.mainTable.classList.add(\"menu-animation-mode\", (isOpen ? \"menu-animation-closing-mode\" : \"menu-animation-opening-mode\"));\n\n\t\tvar menuLinks = [].slice.call(leftColumn.querySelectorAll('.menu-item-link'));\n\t\tvar menuMoreBtn = leftColumn.querySelector('.menu-collapsed-more-btn');\n\t\tvar menuMoreBtnDefault = leftColumn.querySelector('.menu-default-more-btn');\n\n\t\tvar menuSitemapIcon = leftColumn.querySelector('.menu-sitemap-icon-box');\n\t\tvar menuSitemapText = leftColumn.querySelector('.menu-sitemap-btn-text');\n\n\t\tvar menuEmployeesText = leftColumn.querySelector('.menu-invite-employees-text');\n\t\tvar menuEmployeesIcon = leftColumn.querySelector('.menu-invite-icon-box');\n\n\t\tvar licenseContainer = leftColumn.querySelector('.menu-license-all-container');\n\t\tvar licenseBtn = leftColumn.querySelector('.menu-license-all-default');\n\t\tvar licenseHeight = licenseBtn ? licenseBtn.offsetHeight : 0;\n\t\tvar licenseCollapsedBtn = leftColumn.querySelector('.menu-license-all-collapsed');\n\n\t\tconst settingsIconBox = this.menuContainer.querySelector(\".menu-settings-icon-box\");\n\t\tconst settingsBtnText = this.menuContainer.querySelector(\".menu-settings-btn-text\");\n\n\t\tconst helpIconBox = this.menuContainer.querySelector(\".menu-help-icon-box\");\n\t\tconst helpBtnText = this.menuContainer.querySelector(\".menu-help-btn-text\");\n\n\t\tvar menuTextDivider = leftColumn.querySelector('.menu-item-separator');\n\t\tvar menuMoreCounter = leftColumn.querySelector('.menu-item-index-more');\n\n\t\tvar pageHeader = this.mainTable.querySelector(\".page-header\");\n\t\tvar imBar = document.getElementById(\"bx-im-bar\");\n\t\tvar imBarWidth = imBar ? imBar.offsetWidth : 0;\n\n\t\t(new BX.easing({\n\t\t\tduration: 300,\n\t\t\tstart: {\n\t\t\t\ttranslateIcon: isOpen ? -100 : 0,\n\t\t\t\ttranslateText: isOpen ? 0 : -100,\n\t\t\t\ttranslateMoreBtn: isOpen ? 0 : -84,\n\t\t\t\ttranslateLicenseBtn: isOpen ? 0 : -100,\n\t\t\t\theightLicenseBtn: isOpen ? licenseHeight : 40,\n\t\t\t\tburgerMenuWidth: isOpen ? 33 : 66,\n\t\t\t\tsidebarWidth: isOpen ? 240 : 66, /* these values are duplicated in style.css as well */\n\t\t\t\topacity: isOpen ? 100 : 0,\n\t\t\t\topacityRevert: isOpen ? 0 : 100\n\t\t\t},\n\t\t\tfinish: {\n\t\t\t\ttranslateIcon: isOpen ? 0 : -100,\n\t\t\t\ttranslateText: isOpen ? -100 : -18,\n\t\t\t\ttranslateMoreBtn: isOpen ? -84 : 0,\n\t\t\t\ttranslateLicenseBtn: isOpen ? -100 : 0,\n\t\t\t\theightLicenseBtn: isOpen ? 40 : licenseHeight,\n\t\t\t\tburgerMenuWidth: isOpen ? 66 : 33,\n\t\t\t\tsidebarWidth: isOpen ? 66 : 240,\n\t\t\t\topacity: isOpen ? 0 : 100,\n\t\t\t\topacityRevert: isOpen ? 100 : 0\n\t\t\t},\n\t\t\ttransition: BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\tstep: function (state)\n\t\t\t{\n\t\t\t\tleftColumn.style.width = state.sidebarWidth + \"px\";\n\t\t\t\tthis.menuContainer.style.width = state.sidebarWidth + \"px\";\n\t\t\t\tthis.menuHeaderBurger.style.width = state.burgerMenuWidth + \"px\";\n\t\t\t\tthis.headerBurger.style.width = state.burgerMenuWidth + \"px\";\n\n\t\t\t\t//Change this formula in template_style.css as well\n\t\t\t\tif (pageHeader)\n\t\t\t\t{\n\t\t\t\t\tpageHeader.style.maxWidth = \"calc(100vw - \" + state.sidebarWidth + \"px - \" + imBarWidth + \"px)\";\n\t\t\t\t}\n\n\t\t\t\tif (isOpen)\n\t\t\t\t{\n\t\t\t\t\t//Closing Mode\n\t\t\t\t\tif (menuSitemapIcon)\n\t\t\t\t\t{\n\t\t\t\t\t\tmenuSitemapIcon.style.transform = \"translateX(\" + state.translateIcon + \"px)\";\n\t\t\t\t\t\tmenuSitemapIcon.style.opacity = state.opacityRevert / 100;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (menuSitemapText)\n\t\t\t\t\t{\n\t\t\t\t\t\tmenuSitemapText.style.transform = \"translateX(\" + state.translateText + \"px)\";\n\t\t\t\t\t\tmenuSitemapText.style.opacity = state.opacity / 100;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (menuEmployeesIcon)\n\t\t\t\t\t{\n\t\t\t\t\t\tmenuEmployeesIcon.style.transform = \"translateX(\" + state.translateIcon + \"px)\";\n\t\t\t\t\t\tmenuEmployeesIcon.style.opacity = state.opacityRevert / 100;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (menuEmployeesText)\n\t\t\t\t\t{\n\t\t\t\t\t\tmenuEmployeesText.style.transform = \"translateX(\" + state.translateText + \"px)\";\n\t\t\t\t\t\tmenuEmployeesText.style.opacity = state.opacity / 100;\n\t\t\t\t\t}\n\n\t\t\t\t\tsettingsIconBox.style.transform = \"translateX(\" + state.translateIcon + \"px)\";\n\t\t\t\t\tsettingsIconBox.style.opacity = state.opacityRevert / 100;\n\n\t\t\t\t\tsettingsBtnText.style.transform = \"translateX(\" + state.translateText + \"px)\";\n\t\t\t\t\tsettingsBtnText.style.opacity = state.opacity / 100;\n\n\t\t\t\t\thelpIconBox.style.transform = \"translateX(\" + state.translateIcon + \"px)\";\n\t\t\t\t\thelpIconBox.style.opacity = state.opacityRevert / 100;\n\n\t\t\t\t\thelpBtnText.style.transform = \"translateX(\" + state.translateText + \"px)\";\n\t\t\t\t\thelpBtnText.style.opacity = state.opacity / 100;\n\n\t\t\t\t\tmenuMoreBtn.style.transform = \"translateX(\" + state.translateIcon + \"px)\";\n\t\t\t\t\tmenuMoreBtn.style.opacity = state.opacityRevert / 100;\n\n\t\t\t\t\tmenuMoreBtnDefault.style.transform = \"translateX(\" + state.translateMoreBtn + \"px)\";\n\t\t\t\t\tmenuMoreBtnDefault.style.opacity = state.opacity / 100;\n\n\t\t\t\t\tif (menuMoreCounter)\n\t\t\t\t\t{\n\t\t\t\t\t\tmenuMoreCounter.style.transform = \"translateX(\" + state.translateIcon + \"px)\";\n\t\t\t\t\t\tmenuMoreCounter.style.opacity = state.opacityRevert / 100;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (licenseContainer)\n\t\t\t\t\t{\n\t\t\t\t\t\tlicenseBtn.style.transform = \"translateX(\" + state.translateLicenseBtn + \"px)\";\n\t\t\t\t\t\tlicenseBtn.style.opacity = state.opacity / 100;\n\t\t\t\t\t\tlicenseBtn.style.height = state.heightLicenseBtn + \"px\";\n\n\t\t\t\t\t\tlicenseCollapsedBtn.style.transform = \"translateX(\" + state.translateIcon + \"px)\";\n\t\t\t\t\t\tlicenseCollapsedBtn.style.opacity = state.opacityRevert / 100;\n\t\t\t\t\t}\n\n\t\t\t\t\tmenuLinks.forEach(function(item) {\n\t\t\t\t\t\tvar menuIcon = item.querySelector(\".menu-item-icon-box\");\n\t\t\t\t\t\tvar menuLinkText = item.querySelector(\".menu-item-link-text\");\n\t\t\t\t\t\tvar menuCounter = item.querySelector(\".menu-item-index\");\n\t\t\t\t\t\tvar menuArrow = item.querySelector('.menu-item-link-arrow');\n\n\t\t\t\t\t\tmenuLinkText.style.transform = \"translateX(\" + state.translateText + \"px)\";\n\t\t\t\t\t\tmenuLinkText.style.opacity = state.opacity / 100;\n\n\t\t\t\t\t\tmenuIcon.style.transform = \"translateX(\" + state.translateIcon + \"px)\";\n\t\t\t\t\t\tmenuIcon.style.opacity = state.opacityRevert / 100;\n\n\t\t\t\t\t\tif (menuArrow)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tmenuArrow.style.transform = \"translateX(\" + state.translateText + \"px)\";\n\t\t\t\t\t\t\tmenuArrow.style.opacity = state.opacity / 100;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (menuCounter)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tmenuCounter.style.transform = \"translateX(\" + state.translateIcon + \"px)\";\n\t\t\t\t\t\t\tmenuCounter.style.opacity = state.opacityRevert / 100;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\t//Opening Mode\n\t\t\t\t\tmenuTextDivider.style.opacity = 0;\n\n\t\t\t\t\tif (menuSitemapIcon)\n\t\t\t\t\t{\n\t\t\t\t\t\tmenuSitemapIcon.style.transform = \"translateX(\" + state.translateIcon + \"px)\";\n\t\t\t\t\t\tmenuSitemapIcon.style.opacity = state.opacityRevert / 100;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (menuSitemapText)\n\t\t\t\t\t{\n\t\t\t\t\t\tmenuSitemapText.style.transform = \"translateX(\" + state.translateText + \"px)\";\n\t\t\t\t\t\tmenuSitemapText.style.opacity = state.opacity / 100;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (menuEmployeesIcon)\n\t\t\t\t\t{\n\t\t\t\t\t\tmenuEmployeesIcon.style.transform = \"translateX(\" + state.translateIcon + \"px)\";\n\t\t\t\t\t\tmenuEmployeesIcon.style.opacity = state.opacityRevert / 100;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (menuEmployeesText)\n\t\t\t\t\t{\n\t\t\t\t\t\tmenuEmployeesText.style.transform = \"translateX(\" + state.translateText + \"px)\";\n\t\t\t\t\t\tmenuEmployeesText.style.opacity = state.opacity / 100;\n\t\t\t\t\t}\n\n\t\t\t\t\tsettingsIconBox.style.transform = \"translateX(\" + state.translateIcon + \"px)\";\n\t\t\t\t\tsettingsIconBox.style.opacity = state.opacityRevert / 100;\n\n\t\t\t\t\tsettingsBtnText.style.transform = \"translateX(\" + state.translateText + \"px)\";\n\t\t\t\t\tsettingsBtnText.style.opacity = state.opacity / 100;\n\n\t\t\t\t\thelpIconBox.style.transform = \"translateX(\" + state.translateIcon + \"px)\";\n\t\t\t\t\thelpIconBox.style.opacity = state.opacityRevert / 100;\n\n\t\t\t\t\thelpBtnText.style.transform = \"translateX(\" + state.translateText + \"px)\";\n\t\t\t\t\thelpBtnText.style.opacity = state.opacity / 100;\n\n\t\t\t\t\tmenuMoreBtn.style.transform = \"translateX(\" + state.translateIcon + \"px)\";\n\t\t\t\t\tmenuMoreBtn.style.opacity = state.opacityRevert / 100;\n\n\t\t\t\t\tmenuMoreBtnDefault.style.transform = \"translateX(\" + state.translateMoreBtn + \"px)\";\n\t\t\t\t\tmenuMoreBtnDefault.style.opacity = state.opacity / 100;\n\n\t\t\t\t\tif (menuMoreCounter)\n\t\t\t\t\t{\n\t\t\t\t\t\tmenuMoreCounter.style.transform = \"translateX(\" + state.translateText + \"px)\";\n\t\t\t\t\t}\n\n\t\t\t\t\tif (licenseContainer)\n\t\t\t\t\t{\n\t\t\t\t\t\tlicenseBtn.style.transform = \"translateX(\" + state.translateLicenseBtn + \"px)\";\n\t\t\t\t\t\tlicenseBtn.style.opacity = state.opacity / 100;\n\t\t\t\t\t\tlicenseBtn.style.height = state.heightLicenseBtn + \"px\";\n\n\t\t\t\t\t\tlicenseCollapsedBtn.style.transform = \"translateX(\" + state.translateIcon + \"px)\";\n\t\t\t\t\t\tlicenseCollapsedBtn.style.opacity = state.opacityRevert / 100;\n\t\t\t\t\t}\n\n\t\t\t\t\tmenuLinks.forEach(function(item) {\n\t\t\t\t\t\tvar menuIcon = item.querySelector(\".menu-item-icon-box\");\n\t\t\t\t\t\tvar menuLinkText = item.querySelector(\".menu-item-link-text\");\n\t\t\t\t\t\tvar menuCounter = item.querySelector(\".menu-item-index\");\n\t\t\t\t\t\tvar menuArrow = item.querySelector('.menu-item-link-arrow');\n\n\t\t\t\t\t\tmenuLinkText.style.transform = \"translateX(\" + state.translateText + \"px)\";\n\t\t\t\t\t\tmenuLinkText.style.opacity = state.opacity / 100;\n\t\t\t\t\t\tmenuLinkText.style.display = \"inline-block\";\n\n\t\t\t\t\t\tmenuIcon.style.transform = \"translateX(\" + state.translateIcon + \"px)\";\n\t\t\t\t\t\tmenuIcon.style.opacity = state.opacityRevert / 100;\n\n\t\t\t\t\t\tif (menuArrow)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tmenuArrow.style.transform = \"translateX(\" + state.translateText + \"px)\";\n\t\t\t\t\t\t\t// menuArrow.style.opacity = state.opacityRevert / 100;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (menuCounter)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tmenuCounter.style.transform = \"translateX(\" + state.translateText + \"px)\";\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tvar event = document.createEvent(\"Event\");\n\t\t\t\tevent.initEvent(\"resize\", true, true);\n\t\t\t\twindow.dispatchEvent(event);\n\n\t\t\t}.bind(this),\n\t\t\tcomplete: function ()\n\t\t\t{\n\t\t\t\tif (isOpen)\n\t\t\t\t{\n\t\t\t\t\tthis.isCollapsedMode = true;\n\t\t\t\t\tBX.addClass(this.mainTable, \"menu-collapsed-mode\");\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.isCollapsedMode = false;\n\t\t\t\t\tBX.removeClass(this.mainTable, \"menu-collapsed-mode\");\n\t\t\t\t}\n\n\t\t\t\tBX.removeClass(\n\t\t\t\t\tthis.mainTable,\n\t\t\t\t\t\"menu-animation-mode menu-animation-opening-mode menu-animation-closing-mode\"\n\t\t\t\t);\n\n\t\t\t\tvar containers = [\n\t\t\t\t\tleftColumn,\n\t\t\t\t\tmenuTextDivider,\n\t\t\t\t\tthis.menuHeaderBurger,\n\t\t\t\t\tthis.headerBurger,\n\t\t\t\t\tsettingsIconBox,\n\t\t\t\t\tsettingsBtnText,\n\t\t\t\t\thelpIconBox,\n\t\t\t\t\thelpBtnText,\n\t\t\t\t\tmenuMoreBtnDefault,\n\t\t\t\t\tmenuMoreBtn,\n\t\t\t\t\tlogoImageContainer,\n\t\t\t\t\tmenuSitemapIcon,\n\t\t\t\t\tmenuSitemapText,\n\t\t\t\t\tmenuEmployeesIcon,\n\t\t\t\t\tmenuEmployeesText,\n\t\t\t\t\tmenuMoreCounter,\n\t\t\t\t\tlicenseBtn,\n\t\t\t\t\tlicenseCollapsedBtn,\n\t\t\t\t\tthis.menuContainer,\n\t\t\t\t\tpageHeader\n\t\t\t\t];\n\n\t\t\t\tcontainers.forEach(function(container) {\n\t\t\t\t\tif (container)\n\t\t\t\t\t{\n\t\t\t\t\t\tcontainer.style.cssText = \"\";\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tmenuLinks.forEach(function(item) {\n\t\t\t\t\tvar menuIcon = item.querySelector(\".menu-item-icon-box\");\n\t\t\t\t\tvar menuLinkText = item.querySelector(\".menu-item-link-text\");\n\t\t\t\t\tvar menuCounter = item.querySelector(\".menu-item-index\");\n\t\t\t\t\tvar menuArrow = item.querySelector('.menu-item-link-arrow');\n\n\t\t\t\t\titem.style.cssText = \"\";\n\t\t\t\t\tmenuLinkText.style.cssText = \"\";\n\t\t\t\t\tmenuIcon.style.cssText = \"\";\n\n\t\t\t\t\tif (menuArrow)\n\t\t\t\t\t{\n\t\t\t\t\t\tmenuArrow.style.cssText = \"\";\n\t\t\t\t\t}\n\n\t\t\t\t\tif (menuCounter)\n\t\t\t\t\t{\n\t\t\t\t\t\tmenuCounter.style.cssText = \"\";\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tthis.releaseSliding();\n\t\t\t\tthis.#adjustAdminPanel();\n\n\t\t\t\tif (BX.type.isFunction(fn))\n\t\t\t\t{\n\t\t\t\t\tfn();\n\t\t\t\t}\n\n\t\t\t\tBackend.toggleMenu(isOpen);\n\n\t\t\t\tvar event = document.createEvent(\"Event\");\n\t\t\t\tevent.initEvent(\"resize\", true, true);\n\t\t\t\twindow.dispatchEvent(event);\n\n\t\t\t}.bind(this)\n\t\t})).animate();\n\t}\n\t//endregion\n\n\thandleViewMode()\n\t{\n\t\tthis.getItemsController().switchToViewMode();\n\t}\n\n\tapplyScrollMode()\n\t{\n\t\tthis.switchToLogoMaskMode(true);\n\t\tconst threshold = this.scrollModeThreshold + Utils.adminPanel.height;\n\t\tthis.switchToScrollMode(window.pageYOffset > threshold);\n\t}\n\n\thandleGroupPanelOpen()\n\t{\n\t\tthis.isMenuMouseLeaveBlocked.push('group');\n\t}\n\n\thandleGroupPanelClose()\n\t{\n\t\tthis.isMenuMouseLeaveBlocked.pop();\n\t}\n\n\tshowUpButton()\n\t{\n\t\tthis.menuContainer.classList.add(\"menu-up-button-active\");\n\t}\n\n\thideUpButton()\n\t{\n\t\tthis.menuContainer.classList.remove(\"menu-up-button-active\");\n\t}\n\n\treverseUpButton()\n\t{\n\t\tthis.menuContainer.classList.add(\"menu-up-button-reverse\");\n\t}\n\n\tunreverseUpButton()\n\t{\n\t\tthis.menuContainer.classList.remove(\"menu-up-button-reverse\");\n\t}\n\n\tisUpButtonReversed()\n\t{\n\t\treturn this.menuContainer.classList.contains(\"menu-up-button-reverse\");\n\t}\n\n\tisDefaultTheme()\n\t{\n\t\treturn document.body.classList.contains(\"bitrix24-default-theme\");\n\t}\n\n\tgetTopPadding()\n\t{\n\t\treturn this.isDefaultTheme() ? 0 : 9;\n\t}\n\n\t// region Public functions\n\tinitPagetitleStar(): boolean\n\t{\n\t\treturn ItemUserFavorites.isCurrentPageStandard(\n\t\t\tItemUserFavorites.getActiveTopMenuItem()\n\t\t);\n\t}\n\n\tgetStructureForHelper()\n\t{\n\t\tconst items = {menu: {}};\n\t\t[\"show\", \"hide\"].forEach((state) => {\n\t\t\tArray.from(this.menuContainer\n\t\t\t\t.querySelectorAll(`[data-status=\"${state}\"][data-type=\"${ItemSystem.code}\"]`)\n\t\t\t)\n\t\t\t.forEach((node) => {\n\t\t\t\titems[state] = items[state] || [];\n\t\t\t\titems[state].push(node.getAttribute(\"data-id\"))\n\t\t\t});\n\t\t});\n\t\treturn items;\n\t}\n\n\tshowItemWarning({itemId, title, events})\n\t{\n\t\tif (this.getItemsController().items.has(itemId))\n\t\t{\n\t\t\tthis.getItemsController().items.get(itemId).showWarning(title, events);\n\t\t}\n\t}\n\n\tremoveItemWarning(itemId)\n\t{\n\t\tif (this.getItemsController().items.has(itemId))\n\t\t{\n\t\t\tthis.getItemsController().items.get(itemId).removeWarning();\n\t\t}\n\t}\n\n\t#specialLiveFeedDecrement = 0;\n\tdecrementCounter(node, iDecrement)\n\t{\n\t\tif (!node || node.id !== 'menu-counter-live-feed')\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tthis.#specialLiveFeedDecrement += parseInt(iDecrement);\n\t\tthis.getItemsController().decrementCounter({\n\t\t\t'live-feed' : parseInt(iDecrement)\n\t\t});\n\t}\n\n\tupdateCounters(counters, send)\n\t{\n\t\tif (!counters)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tif (counters['**'] !== undefined)\n\t\t{\n\t\t\tcounters['live-feed'] = counters['**'];\n\t\t\tdelete counters['**'];\n\t\t}\n\n\t\tlet workgroupsCounterUpdated = false;\n\t\tif (!Type.isUndefined(counters['**SG0']))\n\t\t{\n\t\t\tthis.workgroupsCounterData['livefeed'] = counters['**SG0'];\n\t\t\tdelete counters['**SG0'];\n\t\t\tworkgroupsCounterUpdated = true;\n\t\t}\n\n\t\tif (!Type.isUndefined(counters[Loc.getMessage('COUNTER_PROJECTS_MAJOR')]))\n\t\t{\n\t\t\tthis.workgroupsCounterData[Loc.getMessage('COUNTER_PROJECTS_MAJOR')] = counters[Loc.getMessage('COUNTER_PROJECTS_MAJOR')];\n\t\t\tdelete counters[Loc.getMessage('COUNTER_PROJECTS_MAJOR')];\n\t\t\tworkgroupsCounterUpdated = true;\n\t\t}\n\n\t\tif (!Type.isUndefined(counters[Loc.getMessage('COUNTER_SCRUM_TOTAL_COMMENTS')]))\n\t\t{\n\t\t\tthis.workgroupsCounterData[Loc.getMessage('COUNTER_SCRUM_TOTAL_COMMENTS')] = counters[Loc.getMessage('COUNTER_SCRUM_TOTAL_COMMENTS')];\n\t\t\tdelete counters[Loc.getMessage('COUNTER_SCRUM_TOTAL_COMMENTS')];\n\t\t\tworkgroupsCounterUpdated = true;\n\t\t}\n\n\t\tif (workgroupsCounterUpdated)\n\t\t{\n\t\t\tcounters['workgroups'] = Object.entries(this.workgroupsCounterData).reduce((prevValue, [, curValue]) => {\n\t\t\t\treturn prevValue + Number(curValue);\n\t\t\t}, 0);\n\t\t}\n\n\t\tif (counters['live-feed'])\n\t\t{\n\t\t\tif (counters['live-feed'] <= 0)\n\t\t\t{\n\t\t\t\tthis.#specialLiveFeedDecrement = 0;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tcounters['live-feed'] -= this.#specialLiveFeedDecrement;\n\t\t\t}\n\t\t}\n\n\t\tthis.getItemsController().updateCounters(counters, send);\n\t}\n\t//endregion\n\n\t#adjustAdminPanel()\n\t{\n\t\tif (!this['menuAdjustAdminPanel'])\n\t\t{\n\t\t\tthis['menuAdjustAdminPanel'] = ({data}) => {\n\t\t\t\tthis.menuContainer.style.top = [data, 'px'].join('');\n\t\t\t}\n\t\t\tEventEmitter.subscribe(Utils.adminPanel,\n\t\t\t\tOptions.eventName('onPanelHasChanged'),\n\t\t\t\tthis['menuAdjustAdminPanel']\n\t\t\t);\n\t\t}\n\t\tthis.menuContainer.style.top = [Utils.adminPanel.top, 'px'].join('');\n\t}\n}\n"],"names":["Options","name","Type","isStringFilled","join","DefaultController","container","events","Array","from","Object","keys","forEach","key","EventEmitter","subscribe","eventName","createPopup","arguments","emit","show","close","PresetCustomController","form","Tag","render","Loc","getMessage","button","PopupManager","create","constructor","toString","overlay","contentColor","contentNoPaddings","lightShadow","draggable","restrict","closeByEsc","titleBar","offsetTop","offsetLeft","cacheable","closeIcon","content","buttons","SaveButton","onclick","isReady","setWaiting","elements","value","promise","then","hide","console","log","CancelButton","AdminPanel","BX","bindEvents","addCustomEvent","isCollapsed","top","bind","offsetHeight","adminPanelState","getClass","fixed","height","rect","getBoundingClientRect","bottom","Math","max","fixedHeight","Utils","_classStaticPrivateFieldSpecGet","_classStaticPrivateFieldSpecSet","document","location","pathname","search","Uri","href","response","UI","Notification","Center","notify","errors","message","position","category","autoHideDelay","url","String","trim","match","link","createElement","host","hash","getInstance","PresetDefaultController","_classPrivateFieldInitSpec","mode","querySelector","cloneNode","onFirstShow","querySelectorAll","node","addEventListener","otherNode","classList","CreateButton","text","isWaiting","currentPreset","getSelectedPreset","isAdmin","availablePresetTools","showUnavailableToolPopup","presetId","data","hasOwnProperty","reload","catchError","forms","checked","MessageBox","MessageBoxButtons","OK","SettingsController","menu","Menu","bindElement","items","getItems","angle","getPopupWindow","menuItems","html","className","push","assign","event","item","getMenuWindow","Backend","collapse","ajax","runAction","analyticsLabel","leftmenu","action","itemData","id","menuItemId","itemText","itemId","itemInfo","menu_item_id","firstItemLink","version","firstPageLink","firstPageUrl","forNewUsersOnly","itemsSort","customItems","userApply","preset","analyticsFirst","Item","parentContainer","init","onDeleteAsFavorites","setTimeout","GLOBAL_TARGET","incrementMaxListeners","destroy","showError","showMessage","dataset","code","textContent","links","hasAttribute","getAttribute","split","makeTextIcons","storage","openInNewPage","setAttribute","Text","encode","linkNode","isString","innerHTML","unsubscribe","decrementMaxListeners","currentUri","result","index","areUrlsEqual","priority","contains","icon","getShortName","parseInt","counterValue","oldValue","add","remove","warning","getId","style","display","newValue","error","title","removeWarning","Event","appendChild","parentNode","removeChild","showMessagePopup","darkMode","onClose","autoHide","TypeError","getName","getCode","animate","filter","v","counterId","topMenuId","Promise","resolve","reject","showForm","getEditFields","length","focus","refineUrl","popup","isEditMode","undefined","indexOf","checkForm","itemInfoToSave","backendSaveItem","checkedUri","checkedUrlBrief","getPath","replace","currentUrlBrief","getHost","shortName","words","substring","firstWord","secondWord","i","toUpperCase","ItemUserFavorites","deleteFavoritesItemMenu","context","getSimilarToUrl","getCurUri","window","onCustomEvent","isActive","contextMenuItems","showUpdate","update","itemLinkNode","addAdminSharedItemMenu","type","ItemAdminShared","updateFavoritesItemMenu","Main","interfaceButtonsManager","firstTopMenuInstance","values","getObjects","shift","topMenuItem","getActive","path","ID","NODE","URL","TEXT","DATA_ID","COUNTER_ID","COUNTER","SUB_LINK","topMenuPoint","currentFullPath","pageTitle","pageLink","getActiveTopMenuItem","startX","startY","isCurrentPageStandard","getCurPage","menuNodeCoord","left","isStandardItem","subLink","getElementById","innerText","titleCoord","addFavoritesItemMenu","createNode","animateFromPoint","topPoint","animateToPoint","pos","ItemUserSelf","deleteSelfITem","confirm","messageBox","saveSelfItemMenu","resolve1","reject2","deletePerm","deleteAdminSharedItemMenu","canDelete","codeToConvert","ItemAdminCustom","deleteCustomItem","actions","ItemMainPage","SidePanel","Instance","open","ItemSystem","ItemGroup","toggleAndSave","Dom","removeClass","groupContainer","updateCounter","preventDefault","stopPropagation","expandGroup","expand","collapseGroup","insertAfter","hideGroupContainer","stop","overflow","addClass","slideParams","easing","duration","start","opacity","finish","transition","makeEaseOut","transitions","quart","step","state","complete","checkAttribute","contentHeight","toNumber","removeAttribute","ItemGroupSystem","itemMappings","getItem","itemClassName","itemClass","detect","ItemActive","theMostOfTheLinks","linkUri","changeActiveItem","uri","actualParams","getQueryParams","maxCount","theMostOfTheLinkServiceData","params","mismatches","comparedLinkParams","unhighlight","highlight","parent","closest","ItemsController","Map","hiddenContainer","registerItem","toggleHiddenContainer","getActiveItem","set","checkAndSet","parentItem","markAsActive","deleteItem","convertItem","openItemMenu","target","has","checkAndUnset","unsubscribeAll","replaceChild","startTop","dragElement","attrs","insertBeforeElement","nextElementSibling","insertBefore","nextSibling","oldParent","emitEvent","counters","send","countersDynamic","entries","localStorage","hiddenCounterNode","Number","BXIM","res","getCounterValue","counterNode","visibleValue","DesktopApi","isDesktop","setBrowserIconBadge","itemGroup","updateCounters","Element","styleValue","styleDisplay","get","unregisterItem","openSettings","hideItem","contextMenuItem","showItem","isExtranet","isMainPageEnabled","setItemAsAMainPage","getDropDownActions","actionItem","switchToViewMode","switchToEditMode","call","onShow","scrollHeight","opening","hiddenBlock","maxHeight","linear","hiddenCounterValue","newParent","markAsInactive","saveSortItems","currentGroupId","chain","role","groupId","groupItem","pop","group_id","LINK","decode","NEW_PAGE","saveItemsSort","topMenuNode","body","finishY","paddingLeft","jsDD","Enable","onbxdragstart","onbxdrag","x","y","onbxdraghover","dest","onbxdragstop","registerObject","dnd","itemDomBlank","itemMoveBlank","draggableBlock","isHiddenContainerVisible","registerItems","registerDest","firstNode","unregisterDest","menuItemsBlockHeight","min","groupHolder","prepend","itemPlaceHolder","onHiddenBlockIsEmptyEmitted","checkAndCorrect","e","enableDest","refreshDestArea","ItemDirector","page","saveCurrentPage","topItem","saveStandardPage","deleteCurrentPage","deleteStandardPage","showAdd","Analytics","AnalyticUserRole","ADMIN","NOT_ADMIN","sendData","tool","AnalyticTool","AnalyticCategory","MENU","AnalyticEvent","SET","c_section","AnalyticSection","p1","isPersonal","CHANGE","SELECT","TOOL","POPUP","c_element","SHOW","PRESET","QUALIFICATION","SETTINGS","AnalyticActions","CONFIRM","LATER","CLOSE","SAVE","SKIP","_classPrivateMethodInitSpec","Cache","MemoryCache","menuContainer","isCustomPresetRestricted","isCustomPresetAvailable","settingsPath","isCollapsedMode","workgroupsCounterData","analytics","initAndBindNodes","getItemsController","handleDocumentScroll","handleMenuDoubleClick","handleMenuMouseEnter","handleMenuMouseLeave","handleSlidingTransitionEnd","menuHeader","menuBody","menuItemsBlock","header","headerBurger","headerLogoBlock","headerSettings","handleHeaderLogoMouserEnter","handleHeaderLogoMouserLeave","mainTable","menuHeaderBurger","handleBurgerClick","upButton","handleUpButtonClick","menuMoreButton","handleShowHiddenClick","helperItem","handleHelperClick","siteMapItem","handleSiteMapClick","settingsSaveBtn","handleViewMode","getSettingsController","cache","remember","EditMode","toggle","ViewMode","onDragModeOn","switchToSlidingMode","isMenuMouseLeaveBlocked","onDragModeOff","onHiddenBlockIsVisible","onHiddenBlockIsHidden","onHiddenBlockIsEmpty","onHiddenBlockIsNotEmpty","onItemHasBeenAdded","addItem","onGettingSettingMenuItems","onPresetIsSet","sendSetCustomPreset","setCustomPreset","shouldSendCloseEvent","presetController","sendSetPreset","setSystemPreset","onPresetIsPostponed","postponeSystemPreset","sendClose","getMode","handleGroupPanelOpen","handleGroupPanelClose","isDomNode","leftMenuNode","leftMenuLink","previousElementSibling","setFirstPage","clearCache","contextMenu","dataItem","topMenu","addMenuItem","getItemDirector","currentPageInMenu","compatData","promises","p","fulfill","onDestroy","BannerDispatcher","high","toQueue","onDone","getDefaultPresetController","getPopup","onYes","setDefaultPreset","YES_CANCEL","menuItemWithAddingToFavorites","showAddToSelf","getContainer","setDefaultMenu","InfoHelper","getCustomPresetController","allowChangeHistory","width","customLeftBoundary","Helper","stopSliding","isMenuMouseEnterBlocked","clearTimeout","slidingModeTimeoutId","blockSliding","releaseSliding","startSliding","isUpButtonReversed","scrollTo","lastScrollOffset","unreverseUpButton","pageYOffset","reverseUpButton","_classPrivateMethodGet","applyScrollMode","documentElement","clientHeight","showUpButton","hideUpButton","pageXOffset","removeProperty","enable","immediately","hasClass","flag","fn","leftColumn","isOpen","logoImageContainer","logoWidth","offsetWidth","menuLinks","slice","menuMoreBtn","menuMoreBtnDefault","menuSitemapIcon","menuSitemapText","menuEmployeesText","menuEmployeesIcon","licenseContainer","licenseBtn","licenseHeight","licenseCollapsedBtn","settingsIconBox","settingsBtnText","helpIconBox","helpBtnText","menuTextDivider","menuMoreCounter","pageHeader","imBar","imBarWidth","translateIcon","translateText","translateMoreBtn","translateLicenseBtn","heightLicenseBtn","burgerMenuWidth","sidebarWidth","opacityRevert","maxWidth","transform","menuIcon","menuLinkText","menuCounter","menuArrow","createEvent","initEvent","dispatchEvent","containers","cssText","isFunction","toggleMenu","switchToLogoMaskMode","threshold","scrollModeThreshold","adminPanel","switchToScrollMode","isDefaultTheme","showWarning","iDecrement","decrementCounter","workgroupsCounterUpdated","isUndefined","reduce","prevValue","curValue","menuHeaderLogo","widthMeasure"],"mappings":"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"}