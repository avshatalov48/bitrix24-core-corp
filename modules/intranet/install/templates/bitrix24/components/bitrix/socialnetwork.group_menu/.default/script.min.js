(function(){if(!!BX.BXSGM24){return}BX.BXSGM24={currentUserId:null,groupdId:null,groupType:null,userIsMember:null,userIsAutoMember:null,userRole:null,isProject:null,favoritesValue:null,canInitiate:null,canModify:null,editFeaturesAllowed:true,pageId:null};BX.BXSGM24.init=function(e){this.currentUserId=parseInt(e.currentUserId);this.groupId=parseInt(e.groupId);this.groupType=e.groupType;this.userIsMember=!!e.userIsMember;this.userIsAutoMember=!!e.userIsAutoMember;this.userRole=e.userRole;this.isProject=!!e.isProject;this.isOpened=!!e.isOpened;this.favoritesValue=!!e.favoritesValue;this.canInitiate=!!e.canInitiate;this.canModify=!!e.canModify;this.pageId=e.pageId;if(typeof e.urls!="undefined"){this.urls=e.urls}this.editFeaturesAllowed=typeof e.editFeaturesAllowed!="undefined"?!!e.editFeaturesAllowed:true;var t=BX.delegate(function(e){if(BX.type.isNotEmptyString(e.code)){if(BX.util.in_array(e.code,["afterJoinRequestSend","afterEdit"])){if(BX("bx-group-menu-join-cont")){BX("bx-group-menu-join-cont").style.display="none"}BX.SocialnetworkUICommon.reload()}else if(BX.util.in_array(e.code,["afterSetFavorites"])){var t=BX.SocialnetworkUICommon.SonetGroupMenu.getInstance();var s=t.favoritesValue;t.setItemTitle(!s);t.favoritesValue=!s}}},this);BX.addCustomEvent("SidePanel.Slider:onMessage",BX.delegate(function(e){if(e.getEventId()=="sonetGroupEvent"){var s=e.getData();t(s)}},this));BX.addCustomEvent("sonetGroupEvent",t);if(BX("bx-group-menu-join")){BX.bind(BX("bx-group-menu-join"),"click",BX.delegate(this.sendJoinRequest,this))}if(BX("bx-group-menu-settings")){var s=BX.SocialnetworkUICommon.SonetGroupMenu.getInstance();s.favoritesValue=this.favoritesValue;BX.bind(BX("bx-group-menu-settings"),"click",BX.delegate(function(e){BX.SocialnetworkUICommon.showGroupMenuPopup({bindElement:BX.getEventTarget(e),groupId:this.groupId,groupType:this.groupType,userIsMember:this.userIsMember,userIsAutoMember:this.userIsAutoMember,userRole:this.userRole,isProject:this.isProject,isOpened:this.isOpened,editFeaturesAllowed:this.editFeaturesAllowed,perms:{canInitiate:this.canInitiate,canProcessRequestsIn:this.canProcessRequestsIn,canModify:this.canModify},urls:{requestUser:BX.message("SGMPathToRequestUser"),edit:BX.message("SGMPathToEdit"),delete:BX.message("SGMPathToDelete"),features:BX.message("SGMPathToFeatures"),members:BX.message("SGMPathToMembers"),requests:BX.message("SGMPathToRequests"),requestsOut:BX.message("SGMPathToRequestsOut"),userRequestGroup:BX.message("SGMPathToUserRequestGroup"),userLeaveGroup:BX.message("SGMPathToUserLeaveGroup"),copy:BX.message("SGMPathToCopy")}});e.preventDefault()},this))}BX.addCustomEvent("SidePanel.Slider:onMessage",BX.delegate(function(e){if(e.getEventId()=="sonetGroupEvent"){var t=e.getData();if(BX.type.isNotEmptyString(t.code)&&typeof t.data!="undefined"&&BX.util.in_array(t.code,["afterDelete","afterLeave"])&&typeof t.data.groupId!="undefined"&&parseInt(t.data.groupId)==this.groupId){top.location.href=this.urls.groupsList}}},this));this.bindEvents()};BX.BXSGM24.bindEvents=function(){if(this.pageId!=="group_tasks"){return}try{var e=document.getElementsByClassName("tasks_role_link");if(e.length){for(var t=0;t<e.length;t++){BX.bind(e[t],"click",function(e){e.preventDefault();var t=e.target.className;var s=this.dataset.id=="view_all"?"":this.dataset.id;var n=this.dataset.url;if(t==="main-buttons-item-sublink "&&s===""||t==="main-buttons-item-edit-button"){return}BX.onCustomEvent("Tasks.TopMenu:onItem",[s,n]);var o=document.getElementsByClassName("tasks_role_link");if(o.length){for(var i=0;i<o.length;i++){BX.removeClass(o[i],"main-buttons-item-active")}}BX.addClass(this,"main-buttons-item-active")})}}}catch(e){}BX.addCustomEvent("BX.Main.Filter:apply",function(e,t,s){this.onFilterApply(e,t,s)}.bind(this))};BX.BXSGM24.onFilterApply=function(e,t,s){try{var n=s.getFilterFieldsValues().ROLEID;var o=document.querySelectorAll(".tasks_role_link");for(var i=0;i<o.length;i++){BX.removeClass(o[i],"main-buttons-item-active")}if(typeof n==="undefined"||!n){n="view_role_view_all"}BX.addClass(BX("group_panel_menu_"+this.groupId+"_"+n),"main-buttons-item-active");var r=BX.Tasks.Component.TasksToolbar.getInstance();if(r){r.rerender(n)}}catch(e){}};BX.BXSGM24.sendJoinRequest=function(e){var t=e.currentTarget;BX.SocialnetworkUICommon.showButtonWait(t);BX.ajax.runAction("socialnetwork.api.usertogroup.join",{data:{params:{groupId:this.groupId}}}).then(function(e){BX.SocialnetworkUICommon.hideButtonWait(t);if(e.data.success&&BX.type.isNotEmptyString(this.urls.group)){BX.onCustomEvent(window.top,"sonetGroupEvent",[{code:"afterJoinRequestSend",data:{groupId:this.groupId}}]);top.location.href=this.urls.group}}.bind(this),function(e){BX.SocialnetworkUICommon.hideButtonWait(t)})}})();
//# sourceMappingURL=script.map.js