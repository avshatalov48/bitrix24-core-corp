(function(){if(!!BX.BXSGM24){return}BX.BXSGM24={currentUserId:null,groupdId:null,groupType:null,userIsMember:null,userIsAutoMember:null,userRole:null,isProject:null,favoritesValue:null,canInitiate:null,canModify:null,canProcessRequestsIn:false,canPickTheme:false,editFeaturesAllowed:true,pageId:null,urls:{}};BX.BXSGM24.init=function(e){this.currentUserId=parseInt(e.currentUserId);this.groupId=parseInt(e.groupId);this.groupType=e.groupType;this.userIsMember=!!e.userIsMember;this.userIsAutoMember=!!e.userIsAutoMember;this.userRole=e.userRole;this.isProject=!!e.isProject;this.isOpened=!!e.isOpened;this.favoritesValue=!!e.favoritesValue;this.canInitiate=!!e.canInitiate;this.canModify=!!e.canModify;this.canProcessRequestsIn=!!e.cacanProcessRequestsInnModify;this.canPickTheme=!!e.canPickTheme;this.pageId=e.pageId;if(typeof e.urls!="undefined"){this.urls=e.urls}this.editFeaturesAllowed=typeof e.editFeaturesAllowed!="undefined"?!!e.editFeaturesAllowed:true;var t=BX.delegate(function(e){if(!BX.type.isNotEmptyString(e.code)){return}if(BX.util.in_array(e.code,["afterJoinRequestSend","afterEdit"])){if(BX("bx-group-menu-join-cont")){BX("bx-group-menu-join-cont").style.display="none"}BX.SocialnetworkUICommon.reload()}else if(BX.util.in_array(e.code,["afterSetFavorites"])){var t=BX.SocialnetworkUICommon.SonetGroupMenu.getInstance();var s=t.favoritesValue;t.setItemTitle(!s);t.favoritesValue=!s}else if(BX.util.in_array(e.code,["afterDelete","afterLeave"])&&BX.type.isNotEmptyObject(e.data)&&typeof e.data.groupId!="undefined"&&parseInt(e.data.groupId)===parseInt(this.groupId)){top.location.href=this.urls.GroupsList}},this);BX.addCustomEvent("SidePanel.Slider:onMessage",BX.delegate(function(e){if(e.getEventId()=="sonetGroupEvent"){var s=e.getData();t(s)}},this));BX.addCustomEvent("sonetGroupEvent",t);if(BX("bx-group-menu-join")){BX.bind(BX("bx-group-menu-join"),"click",BX.delegate(this.sendJoinRequest,this))}if(BX("bx-group-menu-settings")){var s=BX.SocialnetworkUICommon.SonetGroupMenu.getInstance();s.favoritesValue=this.favoritesValue}this.bindEvents();if(BX("bx-group-menu-join")){BX.bind(BX("bx-group-menu-join"),"click",BX.delegate(this.sendJoinRequest,this))}if(BX("bx-group-menu-settings")){BX.bind(BX("bx-group-menu-settings"),"click",BX.delegate(this.showMenu,this))}};BX.BXSGM24.bindEvents=function(){BX.addCustomEvent("onPullEvent-tasks",function(e,t){if(e==="user_counter"){this.onUserCounter(t)}}.bind(this));if(this.pageId!=="group_tasks"){return}try{var e=document.getElementsByClassName("tasks_role_link");if(e.length===0){return}for(var t=0;t<e.length;t++){BX.bind(e[t],"click",function(e){e.preventDefault();var t=this.dataset.id==="view_all"?"":this.dataset.id;var s=this.dataset.url;BX.onCustomEvent("Tasks.TopMenu:onItem",[t,s]);var i=document.getElementsByClassName("tasks_role_link");if(i.length){for(var n=0;n<i.length;n++){BX.removeClass(i[n],"main-buttons-item-active")}}BX.addClass(this,"main-buttons-item-active")})}}catch(e){}BX.addCustomEvent("BX.Main.Filter:apply",function(e,t,s){this.onFilterApply(e,t,s)}.bind(this))};BX.BXSGM24.onUserCounter=function(e){if(Number(this.currentUserId)!==Number(e.userId)||!Object.prototype.hasOwnProperty.call(e,this.groupId)){return}Object.keys(e[this.groupId]).forEach(function(t){var s=BX("group_panel_menu_"+(this.groupId?this.groupId+"_":"")+t);if(s){s.querySelector(".main-buttons-item-counter").innerText=this.getCounterValue(e[this.groupId][t].total)}}.bind(this))};BX.BXSGM24.getCounterValue=function(e){if(!e){return""}var t=99;return e>t?t+"+":e};BX.BXSGM24.onFilterApply=function(e,t,s){try{var i=s.getFilterFieldsValues().ROLEID;var n=document.querySelectorAll(".tasks_role_link");for(var r=0;r<n.length;r++){BX.removeClass(n[r],"main-buttons-item-active")}if(typeof i==="undefined"||!i){i="view_all"}BX.addClass(BX("group_panel_menu_"+this.groupId+"_"+i),"main-buttons-item-active")}catch(e){}};BX.BXSGM24.sendJoinRequest=function(e){var t=e.currentTarget;BX.SocialnetworkUICommon.showButtonWait(t);BX.ajax.runAction("socialnetwork.api.usertogroup.join",{data:{params:{groupId:this.groupId}}}).then(function(e){BX.SocialnetworkUICommon.hideButtonWait(t);if(e.data.success&&BX.type.isNotEmptyString(this.urls.group)){BX.onCustomEvent(window.top,"sonetGroupEvent",[{code:"afterJoinRequestSend",data:{groupId:this.groupId}}]);top.location.href=this.urls.group}}.bind(this),function(e){BX.SocialnetworkUICommon.hideButtonWait(t)})};BX.BXSGM24.showMenu=function(e){BX.SocialnetworkUICommon.showGroupMenuPopup({bindElement:BX.getEventTarget(e),groupId:this.groupId,groupType:this.groupType,userIsMember:this.userIsMember,userIsAutoMember:this.userIsAutoMember,userRole:this.userRole,isProject:this.isProject,isOpened:this.groupOpened,editFeaturesAllowed:this.editFeaturesAllowed,canPickTheme:this.canPickTheme,perms:{canInitiate:this.canInitiate,canProcessRequestsIn:this.canProcessRequestsIn,canModify:this.canModify},urls:{requestUser:BX.type.isNotEmptyString(this.urls.Invite)?this.urls.Invite:this.urls.Edit+(this.urls.Edit.indexOf("?")>=0?"&":"?")+"tab=invite",edit:this.urls.Edit+(this.urls.Edit.indexOf("?")>=0?"&":"?")+"tab=edit",delete:this.urls.Delete,features:this.urls.Features,members:this.urls.GroupUsers,requests:this.urls.GroupRequests,requestsOut:this.urls.GroupRequestsOut,userRequestGroup:this.urls.UserRequestGroup,userLeaveGroup:this.urls.UserLeaveGroup,copy:this.urls.Copy}});e.preventDefault()}})();
//# sourceMappingURL=script.map.js