(function(t,e,a){"use strict";var r=function(){function t(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};babelHelpers.classCallCheck(this,t);babelHelpers.defineProperty(this,"grid",null);babelHelpers.defineProperty(this,"totalWrapper",null);this.gridId=e.gridId;this.grid=BX.Main.gridManager.getInstanceById(this.gridId);this.signedParameters=e.signedParameters;this.totalWrapperId=e.totalWrapperId||null;this.inventoryManagementLink=e.inventoryManagementLink||null;if(this.totalWrapperId){this.totalWrapper=BX(this.totalWrapperId);this.refreshTotalWrapper()}this.subscribeEvents()}babelHelpers.createClass(t,[{key:"subscribeEvents",value:function t(){this.onGridUpdatedHandler=this.onGridUpdated.bind(this);a.EventEmitter.subscribe("Grid::updated",this.onGridUpdatedHandler)}},{key:"onGridUpdated",value:function t(e){var a=e.getCompatData(),r=babelHelpers.slicedToArray(a,2),n=r[0],i=r[1];if(!n||n.getId()!==this.getGridId()){return}this.refreshTotalWrapper()}},{key:"getGridId",value:function t(){return this.gridId}},{key:"reloadGrid",value:function t(){if(this.grid){this.grid.reload()}}},{key:"setTotalData",value:function t(e){for(var a in e){if(e.hasOwnProperty(a)){this.setTotalDataBySelector("#".concat(a),e[a])}}}},{key:"setTotalDataBySelector",value:function t(e,a){if(this.totalWrapper){var r=this.totalWrapper.querySelector(e);if(r){r.innerHTML=a;return true}}return false}},{key:"hideTotalData",value:function t(){BX.hide(this.totalWrapper)}},{key:"showTotalData",value:function t(){BX.show(this.totalWrapper)}},{key:"refreshTotalWrapper",value:function t(){var e=this;if(this.totalWrapper){BX.ajax.runComponentAction("bitrix:catalog.productcard.store.amount","getStoreAmountTotal",{mode:"ajax",data:{signedParameters:this.signedParameters}}).then(function(t){var a=t.data.AMOUNT||"";var r=t.data.QUANTITY||"";var n=t.data.QUANTITY_RESERVED||"";var i=t.data.QUANTITY_COMMON||"";if(a||r||i||n){var o={total_amount:a,total_quantity:r,total_quantity_common:i,total_quantity_reserved:n};e.setTotalData(o);if(BX.isNodeHidden(e.totalWrapper)){e.showTotalData()}}else{e.hideTotalData()}})}}},{key:"openInventoryManagementSlider",value:function t(){if(this.inventoryManagementLink){BX.SidePanel.Instance.open(this.inventoryManagementLink,{cacheable:false,data:{openGridOnDone:false},events:{onCloseComplete:function t(e){var a=e.getSlider();if(!a){return}if(a.getData().get("isInventoryManagementEnabled")){window.top.location.reload()}}}})}}}]);return t}();e.Reflection.namespace("BX.Catalog").ProductStoreGridManager=r})(this.window=this.window||{},BX,BX.Event);
//# sourceMappingURL=script.map.js