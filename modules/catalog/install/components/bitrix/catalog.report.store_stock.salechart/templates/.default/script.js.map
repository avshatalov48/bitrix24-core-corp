{"version":3,"file":"script.js","sources":["script.es6.js"],"sourcesContent":["import \"currency\";\nimport {Loc, Reflection} from 'main.core';\n\nclass StoreStockSaleChart {\n\n\t_chartId;\n\t_chart;\n\t_isOneColumn;\n\n\t_boardId;\n\t_widgetId;\n\t_hint;\n\n\t_sliderUrl;\n\t_chartCurrency;\n\n\t_categoryAxis;\n\t_valueAxis;\n\t\n\t_storeInfoPopupTemplate;\n\t_storeInfoPopup;\n\n\t_storesLabels;\n\t_legendIsPrepared = false;\n\n\t_series = [];\n\n\t_sumStoredColor = '#42659B';\n\t_sumSoldColor = '#6DA3E6';\n\n\tconstructor(params)\n\t{\n\t\tthis._chartId = params.chartId;\n\n\t\tthis._boardId = params.boardId;\n\t\tthis._widgetId = params.widgetId;\n\t\tthis._board = BX.VisualConstructor.BoardRepository.getBoard(this._boardId);\n\t\tthis._widget = this._board.dashboard.getWidget(this._widgetId);\n\n\t\tthis._storeInfoPopupTemplate = params.storeInfoPopupTemplate;\n\t\tthis._storeInfoPopup = null;\n\n\t\tthis._sliderUrl = params.chartData.sliderUrl;\n\n\t\tthis._enablePopup = Boolean(params.chartData.enablePopup);\n\n\t\tthis._currencySymbol = params.chartData.currencySymbol;\n\t\tthis._chartCurrency = params.chartData.currency;\n\n\t\tthis._isOneColumn = Boolean(params.chartData.isOneColumn);\n\n\t\tthis.createChart(params.chartData);\n\n\t\tthis.updateWidgetTitle();\n\t\tBX.addCustomEvent(this._widget, \"Dashboard.Board.Widget:onAfterRender\",\n\t\t\tthis.updateWidgetTitle.bind(this)\n\t\t)\n\t}\n\n\tcreateChart(chartData)\n\t{\n\t\twindow.am4core.useTheme(am4themes_animated);\n\n\t\tthis._chart = am4core.create(this._chartId, am4charts.XYChart);\n\n\t\tthis._chart.zoomOutButton.readerTitle = Loc.getMessage('STORE_STOCK_CHART_ZOOMOUT_TITLE');\n\n\t\tthis._chart.data = [];\n\n\t\tthis._chart.legend = new am4charts.Legend();\n\t\tthis._chart.legend.position = 'bottom';\n\n\t\tthis._chartLabel = chartData._chartLabel;\n\n\t\tthis.createAxes();\n\n\t\tthis.fillChartData(chartData.data);\n\t\tthis.fillSeries();\n\n\t\tif (chartData.isOneColumn)\n\t\t{\n\t\t\tthis._categoryAxis.renderer.labels.template.html = chartData.chartLabel;\n\t\t}\n\n\n\t\tthis._chart.events.on(\"inited\", () => {\n\t\t\tthis.onChartLoaded();\n\t\t}, this);\n\t}\n\n\tcreateAxes()\n\t{\n\t\tthis._categoryAxis = this._chart.xAxes.push(new am4charts.CategoryAxis());\n\t\tthis._categoryAxis.dataFields.category = 'ID';\n\t\tthis._categoryAxis.renderer.grid.template.opacity = 0;\n\n\t\tthis._valueAxis = this._chart.yAxes.push(new am4charts.ValueAxis());\n\t\tthis._valueAxis.min = 0;\n\t\tthis._valueAxis.renderer.grid.template.opacity = 0;\n\t\tthis._valueAxis.renderer.ticks.template.strokeOpacity = 0.5;\n\t\tthis._valueAxis.renderer.ticks.template.length = 10;\n\t\tthis._valueAxis.renderer.line.strokeOpacity = 0.5;\n\t\tthis._valueAxis.renderer.baseGrid.disabled = true;\n\t\tthis._valueAxis.renderer.minGridDistance = 40;\n\t\tthis._valueAxis.calculateTotals = true;\n\n\t\t// some space needed for the total label\n\t\tthis._categoryAxis.renderer.labels.template.marginRight = 40;\n\t}\n\n\tfillChartData(chartData)\n\t{\n\t\tthis._chart.data = chartData.map((columnData, index) => {\n\t\t\tcolumnData['ID'] = index;\n\t\t\treturn columnData;\n\t\t});\n\t}\n\n\tfillSeries()\n\t{\n\t\tlet emptySeries = this.createSeries(\"empty\", \"empty\");\n\t\temptySeries.hiddenInLegend = true;\n\t\temptySeries.maskBullets = false;\n\n\n\n\t\tlet sumStoredTitle = Loc.getMessage('STORE_STOCK_CHART_SUM_STORED_TITLE');\n\t\tlet sumStoredSeries = this.createSeries(\"SUM_STORED\", sumStoredTitle);\n\t\tsumStoredSeries.fill = am4core.color(this._sumStoredColor);\n\t\tsumStoredSeries.stroke = am4core.color(\"#FFFFFF\");\n\t\tthis._series.push(sumStoredSeries);\n\n\t\tlet sumSoldTitle = Loc.getMessage('STORE_STOCK_CHART_SUM_SOLD_TITLE');\n\t\tlet sumSoldSeries = this.createSeries(\"SUM_SOLD\", sumSoldTitle);\n\t\tsumSoldSeries.fill = am4core.color(this._sumSoldColor);\n\t\tsumSoldSeries.stroke = am4core.color(\"#FFFFFF\");\n\t\tthis._series.push(sumSoldSeries);\n\n\t\tsumStoredSeries.events.on(\"inited\", (eventObject) => {\n\t\t\tthis.onSeriesLoad(eventObject.target, 'SUM_STORED');\n\t\t}, this);\n\t\tsumSoldSeries.events.on(\"inited\", (eventObject) => {\n\t\t\tthis.onSeriesLoad(eventObject.target, 'SUM_SOLD');\n\t\t}, this);\n\t}\n\n\tonSeriesLoad(seriesObject, seriesTypeId)\n\t{\n\t\tif (this._chart.legend.labels.values.length === this._series.length)\n\t\t{\n\t\t\tthis.prepareChartLegend();\n\t\t}\n\n\t\tif (this._enablePopup)\n\t\t{\n\t\t\tthis.bindPopupEvents(seriesObject, seriesTypeId);\n\t\t}\n\t}\n\n\tbindPopupEvents(seriesObject, seriesTypeId)\n\t{\n\t\tfor (let i = 0; i < seriesObject.columns.length; i++)\n\t\t{\n\t\t\tlet column = {\n\t\t\t\tcolumnObject: seriesObject.columns.getIndex(i),\n\t\t\t\tcolumnTypeId: seriesTypeId,\n\t\t\t\tstoreData: this._chart.data[i],\n\t\t\t};\n\n\t\t\tBX.bind(column.columnObject.group.node, 'mouseover', this.handleColumnMouseOver.bind(this, column));\n\t\t\tBX.bind(column.columnObject.group.node, 'mouseout', this.handleColumnMouseOut.bind(this));\n\n\t\t\tif (this._sliderUrl)\n\t\t\t{\n\t\t\t\tcolumn.columnObject.group.node.style.cursor = 'pointer';\n\t\t\t\tBX.bind(column.columnObject.group.node, 'click', this.openStoreStockChartGridSlider.bind(this));\n\t\t\t}\n\t\t}\n\t}\n\n\tprepareChartLegend()\n\t{\n\t\tif (this._legendIsPrepared)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis._legendIsPrepared = true;\n\t\t}\n\n\t\tlet chartLegends = this._chart.legend.labels.values;\n\t\tlet currencyPostfix = ', ' + this._currencySymbol;\n\n\t\tfor (let i = 0; i < chartLegends.length; i++)\n\t\t{\n\t\t\tchartLegends[i].fill = am4core.color(\"#000000\");\n\t\t\tchartLegends[i].html = chartLegends[i].currentText + currencyPostfix;\n\t\t}\n\t}\n\n\thandleColumnMouseOver(column)\n\t{\n\t\tthis.openStoreInfoPopup(column);\n\t}\n\n\thandleColumnMouseOut()\n\t{\n\t\tif (this._storeInfoPopup !== null)\n\t\t{\n\t\t\tthis._storeInfoPopup.close();\n\t\t}\n\t}\n\n\topenStoreStockChartGridSlider()\n\t{\n\t\tBX.SidePanel.Instance.open(this._sliderUrl, {\n\t\t\tcacheable: false,\n\t\t\tallowChangeTitle: false,\n\t\t\tallowChangeHistory: false,\n\t\t});\n\t}\n\n\topenStoreInfoPopup(column)\n\t{\n\t\tif (this._storeInfoPopup !== null)\n\t\t{\n\t\t\tthis._storeInfoPopup.destroy();\n\t\t}\n\n\t\tlet popupData = {\n\t\t\ttypeId: column.columnTypeId,\n\t\t\tstoreData: column.storeData\n\t\t};\n\n\t\tthis._storeInfoPopup = new BX.PopupWindow('widget-store-stock-info-popup', column.columnObject.group.node, {\n\t\t\tbindOptions: {\n\t\t\t\tposition: \"top\"\n\t\t\t},\n\t\t\toffsetLeft: 30,\n\t\t\toffsetTop: -1,\n\t\t\tnoAllPaddings: true,\n\t\t\tautoHide: false,\n\t\t\tdraggable: {restrict: false},\n\t\t\tcacheable: false,\n\t\t\tcontent: this.getFormedStoreInfoPopupContent(popupData),\n\t\t});\n\t\tthis._storeInfoPopup.show();\n\t}\n\n\tgetFormedStoreInfoPopupContent(popupData) {\n\t\tlet popup = {\n\t\t\ttitle: this._storeInfoPopupTemplate.querySelector('#chart-popup-template-title'),\n\t\t\tsum: this._storeInfoPopupTemplate.querySelector('#chart-popup-template-sum'),\n\t\t\tsumProc: this._storeInfoPopupTemplate.querySelector('#chart-popup-template-sum-proc'),\n\t\t};\n\n\t\tswitch (popupData.typeId) {\n\t\t\tcase 'SUM_SOLD':\n\t\t\t\tpopup.title.innerText = Loc.getMessage('STORE_STOCK_CHART_POPUP_SOLD_TITLE');\n\t\t\t\tpopup.sum.innerHTML = this.sumCurrencyFormat(popupData.storeData['SUM_SOLD']);\n\t\t\t\tpopup.sumProc.innerText = this.formatPercentValue(popupData.storeData['SUM_SOLD_PERCENT']);\n\t\t\t\tthis._storeInfoPopupTemplate.style.borderColor = this._sumSoldColor;\n\t\t\t\tbreak;\n\t\t\tcase 'SUM_STORED':\n\t\t\t\tpopup.title.innerText = Loc.getMessage('STORE_STOCK_CHART_POPUP_STORED_TITLE');\n\t\t\t\tpopup.sum.innerHTML = this.sumCurrencyFormat(popupData.storeData['SUM_STORED']);\n\t\t\t\tpopup.sumProc.innerText = this.formatPercentValue(popupData.storeData['SUM_STORED_PERCENT']);\n\t\t\t\tthis._storeInfoPopupTemplate.style.borderColor = this._sumStoredColor;\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn this._storeInfoPopupTemplate;\n\t}\n\n\tsumCurrencyFormat(sum)\n\t{\n\t\tsum = parseFloat(sum);\n\t\treturn BX.Currency.currencyFormat(sum, this._chartCurrency, true);\n\t}\n\n\tformatPercentValue(percentValue)\n\t{\n\t\treturn parseFloat(percentValue).toFixed(2) + '%';\n\t}\n\n\tcreateSeries(field, name)\n\t{\n\t\tlet series = this._chart.series.push(new am4charts.ColumnSeries());\n\t\tseries.dataFields.valueY = field;\n\t\tseries.dataFields.categoryX = 'ID';\n\t\tseries.stacked = true;\n\t\tseries.name = name;\n\n\t\treturn series;\n\t}\n\n\tupdateWidgetTitle()\n\t{\n\t\tBX.clean(this._widget.layout.titleContainer);\n\t\tBX.adjust(this._widget.layout.titleContainer, {\n\t\t\tchildren: [\n\t\t\t\tBX.create(\"span\", {\n\t\t\t\t\ttext: this._widget.config.title\n\t\t\t\t}),\n\t\t\t\tthis._hint = BX.UI.Hint.createNode(Loc.getMessage('STORE_STOCK_CHART_HINT_TITLE')),\n\t\t\t]\n\t\t});\n\n\t\tBX.bind(this._hint, \"click\", function()\n\t\t{\n\t\t\tif (top.BX.Helper)\n\t\t\t{\n\t\t\t\ttop.BX.Helper.show(\"redirect=detail&code=15503856\");\n\t\t\t}\n\t\t});\n\t}\n\n\tonChartLoaded()\n\t{\n\t\tif (!this._isOneColumn)\n\t\t{\n\t\t\tthis.fillColumnsTitle();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis._categoryAxis.dataItemsByCategory.getKey('0').text = '';\n\t\t}\n\t}\n\n\tfillColumnsTitle()\n\t{\n\t\tthis._chart.data.forEach((columnData) => {\n\t\t\tthis._categoryAxis.dataItemsByCategory.getKey(columnData['ID']).text = columnData['STORE_NAME'];\n\t\t});\n\t}\n}\n\nReflection.namespace('BX.Catalog.Report.StoreStock').StoreStockSaleChart = StoreStockSaleChart;"],"names":["StoreStockSaleChart","params","_chartId","chartId","_boardId","boardId","_widgetId","widgetId","_board","BX","VisualConstructor","BoardRepository","getBoard","_widget","dashboard","getWidget","_storeInfoPopupTemplate","storeInfoPopupTemplate","_storeInfoPopup","_sliderUrl","chartData","sliderUrl","_enablePopup","Boolean","enablePopup","_currencySymbol","currencySymbol","_chartCurrency","currency","_isOneColumn","isOneColumn","createChart","updateWidgetTitle","addCustomEvent","bind","window","am4core","useTheme","am4themes_animated","_chart","create","am4charts","XYChart","zoomOutButton","readerTitle","Loc","getMessage","data","legend","Legend","position","_chartLabel","createAxes","fillChartData","fillSeries","_categoryAxis","renderer","labels","template","html","chartLabel","events","on","onChartLoaded","xAxes","push","CategoryAxis","dataFields","category","grid","opacity","_valueAxis","yAxes","ValueAxis","min","ticks","strokeOpacity","length","line","baseGrid","disabled","minGridDistance","calculateTotals","marginRight","map","columnData","index","emptySeries","createSeries","hiddenInLegend","maskBullets","sumStoredTitle","sumStoredSeries","fill","color","_sumStoredColor","stroke","_series","sumSoldTitle","sumSoldSeries","_sumSoldColor","eventObject","onSeriesLoad","target","seriesObject","seriesTypeId","values","prepareChartLegend","bindPopupEvents","i","columns","column","columnObject","getIndex","columnTypeId","storeData","group","node","handleColumnMouseOver","handleColumnMouseOut","style","cursor","openStoreStockChartGridSlider","_legendIsPrepared","chartLegends","currencyPostfix","currentText","openStoreInfoPopup","close","SidePanel","Instance","open","cacheable","allowChangeTitle","allowChangeHistory","destroy","popupData","typeId","PopupWindow","bindOptions","offsetLeft","offsetTop","noAllPaddings","autoHide","draggable","restrict","content","getFormedStoreInfoPopupContent","show","popup","title","querySelector","sum","sumProc","innerText","innerHTML","sumCurrencyFormat","formatPercentValue","borderColor","parseFloat","Currency","currencyFormat","percentValue","toFixed","field","name","series","ColumnSeries","valueY","categoryX","stacked","clean","layout","titleContainer","adjust","children","text","config","_hint","UI","Hint","createNode","top","Helper","fillColumnsTitle","dataItemsByCategory","getKey","forEach","Reflection","namespace"],"mappings":"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"}