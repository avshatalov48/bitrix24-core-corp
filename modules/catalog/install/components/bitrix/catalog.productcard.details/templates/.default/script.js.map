{"version":3,"file":"script.js","sources":["script.es6.js"],"sourcesContent":["import {Event, Loc, Reflection, Tag, Type} from 'main.core';\nimport {Popup} from 'main.popup';\nimport {EntityCard} from 'catalog.entity-card';\nimport {type BaseEvent, EventEmitter} from 'main.core.events';\n\nclass ProductCard extends EntityCard\n{\n\tconstructor(id, settings = {})\n\t{\n\t\tsuper(id, settings);\n\t\tthis.variationGridId = settings.variationGridId;\n\t\tthis.settingsButtonId = settings.settingsButtonId;\n\n\t\tthis.bindCardSettingsButton();\n\n\t\tEventEmitter.subscribe('SidePanel.Slider:onMessage', this.onSliderMessage.bind(this));\n\t\tEventEmitter.subscribe('Grid::updated', this.onGridUpdatedHandler.bind(this));\n\t\tEventEmitter.subscribe('BX.UI.EntityEditorSection:onLayout', this.onSectionLayout.bind(this));\n\t}\n\n\tgetEntityType()\n\t{\n\t\treturn 'Product';\n\t}\n\n\tonSectionLayout(event: BaseEvent)\n\t{\n\t\tconst [, eventData] = event.getCompatData();\n\n\t\tif (eventData.id === 'catalog_parameters')\n\t\t{\n\t\t\teventData.visible = this.isSimpleProduct && this.isCardSettingEnabled('CATALOG_PARAMETERS');\n\t\t}\n\t}\n\n\tonEditorAjaxSubmit(event: BaseEvent)\n\t{\n\t\tsuper.onEditorAjaxSubmit(event);\n\n\t\tconst [, response] = event.getCompatData();\n\n\t\tif (response.data)\n\t\t{\n\t\t\tif (response.data.NOTIFY_ABOUT_NEW_VARIATION)\n\t\t\t{\n\t\t\t\tthis.showNotification(Loc.getMessage('CPD_NEW_VARIATION_ADDED'));\n\t\t\t}\n\t\t}\n\t}\n\n\tonGridUpdatedHandler(event: BaseEvent)\n\t{\n\t\tconst [grid] = event.getCompatData();\n\n\t\tif (grid && grid.getId() === this.getVariationGridId())\n\t\t{\n\t\t\tthis.updateSettingsCheckboxState();\n\n\t\t\tif (grid.getRows().getCountDisplayed() <= 0)\n\t\t\t{\n\t\t\t\tdocument.location.reload();\n\t\t\t}\n\t\t}\n\t}\n\n\tupdateSettingsCheckboxState()\n\t{\n\t\tconst popupContainer = this.getCardSettingsPopup().getContentContainer();\n\n\t\tthis.cardSettings\n\t\t\t.filter(item => item.action === 'grid' && Type.isArray(item.columns))\n\t\t\t.forEach(item => {\n\t\t\t\tlet allColumnsExist = true;\n\n\t\t\t\titem.columns.forEach(columnName => {\n\t\t\t\t\tif (!this.getVariationGrid().getColumnHeaderCellByName(columnName))\n\t\t\t\t\t{\n\t\t\t\t\t\tallColumnsExist = false;\n\t\t\t\t\t}\n\t\t\t\t})\n\n\t\t\t\tlet checkbox = popupContainer.querySelector('input[data-setting-id=\"' + item.id + '\"]');\n\t\t\t\tif (Type.isDomNode(checkbox))\n\t\t\t\t{\n\t\t\t\t\tcheckbox.checked = allColumnsExist;\n\t\t\t\t}\n\t\t\t});\n\t}\n\n\tgetSettingsButton()\n\t{\n\t\treturn BX.UI.ButtonManager.getByUniqid(this.settingsButtonId);\n\t}\n\n\tbindCardSettingsButton()\n\t{\n\t\tconst settingsButton = this.getSettingsButton();\n\t\tif (settingsButton)\n\t\t{\n\t\t\tEvent.bind(settingsButton.getContainer(), 'click', this.showCardSettingsPopup.bind(this));\n\t\t}\n\t}\n\n\tgetCardSettingsPopup()\n\t{\n\t\tif (!this.settingsPopup)\n\t\t{\n\t\t\tthis.settingsPopup = new Popup(\n\t\t\t\tthis._id,\n\t\t\t\tthis.getSettingsButton().getContainer(),\n\t\t\t\t{\n\t\t\t\t\tautoHide: true,\n\t\t\t\t\tdraggable: false,\n\t\t\t\t\toffsetLeft: 0,\n\t\t\t\t\toffsetTop: 0,\n\t\t\t\t\tangle: {position: 'top', offset: 43},\n\t\t\t\t\tnoAllPaddings: true,\n\t\t\t\t\tbindOptions: {forceBindPosition: true},\n\t\t\t\t\tcloseByEsc: true,\n\t\t\t\t\tcontent: this.prepareCardSettingsContent()\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\treturn this.settingsPopup;\n\t}\n\n\tshowCardSettingsPopup()\n\t{\n\t\tconst okCallback = () => this.getCardSettingsPopup().show();\n\t\tconst variationGridInstance = Reflection.getClass('BX.Catalog.VariationGrid.Instance');\n\n\t\tif (variationGridInstance)\n\t\t{\n\t\t\tvariationGridInstance.askToLossGridData(okCallback);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tokCallback();\n\t\t}\n\t}\n\n\tprepareCardSettingsContent()\n\t{\n\t\tconst content = Tag.render`\n\t\t\t<div class='ui-entity-editor-popup-create-field-list'></div>\n\t\t`;\n\n\t\tthis.cardSettings.map(item => {\n\t\t\tcontent.append(this.getSettingItem(item));\n\t\t});\n\n\t\treturn content;\n\t}\n\n\tgetSettingItem(item)\n\t{\n\t\tconst input = Tag.render`\n\t\t\t<input type=\"checkbox\">\n\t\t`;\n\t\tinput.checked = item.checked;\n\t\tinput.dataset.settingId = item.id;\n\n\t\tconst setting = Tag.render`\n\t\t\t\t<label class=\"ui-ctl-block ui-entity-editor-popup-create-field-item ui-ctl-w100\">\n\t\t\t\t\t<div class=\"ui-ctl-w10\" style=\"text-align: center\">${input}</div>\n\t\t\t\t\t<div class=\"ui-ctl-w75\">\n\t\t\t\t\t\t<span class=\"ui-entity-editor-popup-create-field-item-title\">${item.title}</span>\n\t\t\t\t\t\t<span class=\"ui-entity-editor-popup-create-field-item-desc\">${item.desc}</span>\t\n\t\t\t\t\t</div>\t\t\t\t\t\n\t\t\t\t</label>\n\t\t\t`;\n\n\t\tEvent.bind(setting, 'change', this.setProductCardSetting.bind(this));\n\n\t\treturn setting;\n\t}\n\n\tsetProductCardSetting(event: BaseEvent)\n\t{\n\t\tconst settingItem = this.getCardSetting(event.target.dataset.settingId);\n\t\tif (!settingItem)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst settingEnabled = event.target.checked;\n\n\t\tif (settingItem.action === 'grid')\n\t\t{\n\t\t\tthis.requestGridSettings(settingItem, settingEnabled);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.requestCardSettings(settingItem, settingEnabled);\n\t\t}\n\t}\n\n\trequestGridSettings(setting, enabled)\n\t{\n\t\tif (!this.getVariationGrid())\n\t\t{\n\t\t\tnew Error('Cant find variation grid.');\n\t\t}\n\n\t\tconst headers = [];\n\t\tconst cells = this.getVariationGrid().getRows().getHeadFirstChild().getCells();\n\n\t\tArray.from(cells).forEach((header) => {\n\t\t\tif ('name' in header.dataset)\n\t\t\t{\n\t\t\t\theaders.push(header.dataset.name);\n\t\t\t}\n\t\t});\n\n\t\tBX.ajax.runComponentAction(\n\t\t\tthis.componentName,\n\t\t\t'setGridSetting',\n\t\t\t{\n\t\t\t\tmode: 'class',\n\t\t\t\tdata: {\n\t\t\t\t\tsignedParameters: this.componentSignedParams,\n\t\t\t\t\tsettingId: setting.id,\n\t\t\t\t\tselected: enabled,\n\t\t\t\t\tcurrentHeaders: headers\n\t\t\t\t}\n\t\t\t}\n\t\t).then(() => {\n\t\t\tsetting.checked = enabled;\n\t\t\tthis.reloadVariationGrid();\n\t\t\tthis.getCardSettingsPopup().close();\n\n\t\t\tlet message = enabled ? Loc.getMessage('CPD_SETTING_ENABLED') : Loc.getMessage('CPD_SETTING_DISABLED');\n\t\t\tthis.showNotification(message.replace('#NAME#', setting.title), {\n\t\t\t\tcategory: 'popup-settings'\n\t\t\t});\n\t\t});\n\t}\n\n\trequestCardSettings(setting, enabled)\n\t{\n\t\tBX.ajax.runComponentAction(\n\t\t\tthis.componentName,\n\t\t\t'setCardSetting',\n\t\t\t{\n\t\t\t\tmode: 'class',\n\t\t\t\tdata: {\n\t\t\t\t\tsignedParameters: this.componentSignedParams,\n\t\t\t\t\tsettingId: setting.id,\n\t\t\t\t\tselected: enabled\n\t\t\t\t}\n\t\t\t}\n\t\t).then(() => {\n\t\t\tsetting.checked = enabled;\n\n\t\t\tif (setting.id === 'CATALOG_PARAMETERS')\n\t\t\t{\n\t\t\t\tconst section = this.getEditorInstance().getControlByIdRecursive('catalog_parameters');\n\t\t\t\tif (section)\n\t\t\t\t{\n\t\t\t\t\tsection.refreshLayout();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.getCardSettingsPopup().close();\n\n\t\t\tlet message = enabled ? Loc.getMessage('CPD_SETTING_ENABLED') : Loc.getMessage('CPD_SETTING_DISABLED');\n\t\t\tthis.showNotification(message.replace('#NAME#', setting.title), {\n\t\t\t\tcategory: 'popup-settings'\n\t\t\t});\n\t\t});\n\t}\n\n\tonSliderMessage(event: BaseEvent)\n\t{\n\t\tconst [sliderEvent] = event.getCompatData();\n\n\t\tif (\n\t\t\tsliderEvent.getEventId() === 'Catalog.VariationCard::onCreate'\n\t\t\t|| sliderEvent.getEventId() === 'Catalog.VariationCard::onUpdate'\n\t\t)\n\t\t{\n\t\t\tthis.reloadVariationGrid();\n\t\t}\n\t}\n\n\t/**\n\t * @returns {BX.Catalog.VariationGrid|null}\n\t */\n\tgetVariationGridComponent()\n\t{\n\t\treturn Reflection.getClass('BX.Catalog.VariationGrid.Instance');\n\t}\n\n\treloadVariationGrid()\n\t{\n\t\tconst gridComponent = this.getVariationGridComponent();\n\t\tif (gridComponent)\n\t\t{\n\t\t\tgridComponent.reloadGrid();\n\t\t}\n\t}\n\n\tgetVariationGridId()\n\t{\n\t\treturn this.variationGridId;\n\t}\n\n\tgetVariationGrid()\n\t{\n\t\tif (!Reflection.getClass('BX.Main.gridManager.getInstanceById'))\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn BX.Main.gridManager.getInstanceById(this.getVariationGridId());\n\t}\n}\n\nReflection.namespace('BX.Catalog').ProductCard = ProductCard;"],"names":["ProductCard","id","settings","variationGridId","settingsButtonId","bindCardSettingsButton","EventEmitter","subscribe","onSliderMessage","bind","onGridUpdatedHandler","onSectionLayout","event","getCompatData","eventData","visible","isSimpleProduct","isCardSettingEnabled","response","data","NOTIFY_ABOUT_NEW_VARIATION","showNotification","Loc","getMessage","grid","getId","getVariationGridId","updateSettingsCheckboxState","getRows","getCountDisplayed","document","location","reload","popupContainer","getCardSettingsPopup","getContentContainer","cardSettings","filter","item","action","Type","isArray","columns","forEach","allColumnsExist","columnName","getVariationGrid","getColumnHeaderCellByName","checkbox","querySelector","isDomNode","checked","BX","UI","ButtonManager","getByUniqid","settingsButton","getSettingsButton","Event","getContainer","showCardSettingsPopup","settingsPopup","Popup","_id","autoHide","draggable","offsetLeft","offsetTop","angle","position","offset","noAllPaddings","bindOptions","forceBindPosition","closeByEsc","content","prepareCardSettingsContent","okCallback","show","variationGridInstance","Reflection","getClass","askToLossGridData","Tag","render","map","append","getSettingItem","input","dataset","settingId","setting","title","desc","setProductCardSetting","settingItem","getCardSetting","target","settingEnabled","requestGridSettings","requestCardSettings","enabled","headers","cells","getHeadFirstChild","getCells","Array","from","header","push","name","ajax","runComponentAction","componentName","mode","signedParameters","componentSignedParams","selected","currentHeaders","then","reloadVariationGrid","close","message","replace","category","section","getEditorInstance","getControlByIdRecursive","refreshLayout","sliderEvent","getEventId","gridComponent","getVariationGridComponent","reloadGrid","Main","gridManager","getInstanceById","EntityCard","namespace"],"mappings":"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"}