this.BX=this.BX||{};(function(e,t,a,s){"use strict";var r;function i(e,t){n(e,t);t.add(e)}function l(e,t,a){n(e,t);t.set(e,a)}function n(e,t){if(t.has(e)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}function o(e,t,a){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return a}var c=new WeakMap;var p=new WeakMap;var u=new WeakMap;var d=new WeakMap;var b=new WeakMap;var h=new WeakMap;var v=new WeakMap;var f=new WeakMap;var g=new WeakMap;var m=new WeakMap;var P=new WeakMap;var H=new WeakSet;var S=new WeakSet;var C=new WeakSet;var y=new WeakSet;var k=new WeakSet;var _=new WeakSet;var F=new WeakSet;var E=new WeakSet;var w=new WeakSet;var T=new WeakSet;var G=new WeakSet;var A=function(){function e(t){babelHelpers.classCallCheck(this,e);i(this,G);i(this,T);i(this,w);i(this,E);i(this,F);i(this,_);i(this,k);i(this,y);i(this,C);i(this,S);i(this,H);l(this,c,{writable:true,value:void 0});l(this,p,{writable:true,value:void 0});l(this,u,{writable:true,value:void 0});l(this,d,{writable:true,value:void 0});l(this,b,{writable:true,value:void 0});l(this,h,{writable:true,value:void 0});l(this,v,{writable:true,value:false});l(this,f,{writable:true,value:{categoryAxis:am4charts.CategoryAxis,valueAxis:am4charts.ValueAxis}});l(this,g,{writable:true,value:[]});l(this,m,{writable:true,value:0});l(this,P,{writable:true,value:void 0});babelHelpers.classPrivateFieldSet(this,P,t===null||t===void 0?void 0:t.isPopupEnabled);babelHelpers.classPrivateFieldSet(this,u,null);babelHelpers.classPrivateFieldSet(this,b,t.onChartClick);babelHelpers.classPrivateFieldSet(this,h,t===null||t===void 0?void 0:t.onSeriesLabelLoad);o(this,H,L).call(this,t.chartProps)}babelHelpers.createClass(e,null,[{key:"formPopupContent",value:function e(t,a,i){return s.Tag.render(r||(r=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div id="chart-popup-template" class="stacked-bar-chart-popup" style="border-color: ',';">\n\t\t\t\t<div class="stacked-bar-chart-popup-head">\n\t\t\t\t\t<div id="chart-popup-template-title" class="stacked-bar-chart-popup-title">','</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="stacked-bar-chart-popup-main">\n\t\t\t\t\t<div class="stacked-bar-chart-popup-info">\n\t\t\t\t\t\t',"\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t"])),t,a,i)}},{key:"createSeries",value:function e(t){var a=new am4charts.ColumnSeries;a.dataFields.valueY=t.id;a.dataFields.categoryX="id";a.stacked=true;a.name=t.title;a.fill=am4core.color(t.color);a.stroke=am4core.color("#ffffff");return a}}]);return e}();function L(e){var t=this;window.am4core.useTheme(am4themes_animated);babelHelpers.classPrivateFieldSet(this,c,e.id);babelHelpers.classPrivateFieldSet(this,p,am4core.create(babelHelpers.classPrivateFieldGet(this,c),am4charts.XYChart));babelHelpers.classPrivateFieldGet(this,p).data=[];babelHelpers.classPrivateFieldGet(this,p).zoomOutButton.readerTitle=s.Loc.getMessage("STORE_CHART_ZOOMOUT_TITLE");babelHelpers.classPrivateFieldGet(this,p).legend=new am4charts.Legend;babelHelpers.classPrivateFieldGet(this,p).legend.position="bottom";o(this,C,O).call(this);o(this,y,M).call(this,e.columns);o(this,k,x).call(this,e.seriesList);if(e.isCommonChart){babelHelpers.classPrivateFieldGet(this,f).categoryAxis.renderer.labels.template.html=e.label}babelHelpers.classPrivateFieldGet(this,p).events.on("inited",(function(){o(t,E,B).call(t)}))}function R(){var e=this;babelHelpers.classPrivateFieldGet(this,p).data.forEach((function(t){babelHelpers.classPrivateFieldGet(e,f).categoryAxis.dataItemsByCategory.getKey(t["id"]).text=t["name"]}))}function O(){babelHelpers.classPrivateFieldGet(this,f).categoryAxis=babelHelpers.classPrivateFieldGet(this,p).xAxes.push(new am4charts.CategoryAxis);babelHelpers.classPrivateFieldGet(this,f).categoryAxis.dataFields.category="id";babelHelpers.classPrivateFieldGet(this,f).categoryAxis.renderer.grid.template.opacity=0;babelHelpers.classPrivateFieldGet(this,f).valueAxis=babelHelpers.classPrivateFieldGet(this,p).yAxes.push(new am4charts.ValueAxis);babelHelpers.classPrivateFieldGet(this,f).valueAxis.min=0;babelHelpers.classPrivateFieldGet(this,f).valueAxis.renderer.grid.template.opacity=0;babelHelpers.classPrivateFieldGet(this,f).valueAxis.renderer.ticks.template.strokeOpacity=.5;babelHelpers.classPrivateFieldGet(this,f).valueAxis.renderer.ticks.template.length=10;babelHelpers.classPrivateFieldGet(this,f).valueAxis.renderer.line.strokeOpacity=.5;babelHelpers.classPrivateFieldGet(this,f).valueAxis.renderer.baseGrid.disabled=true;babelHelpers.classPrivateFieldGet(this,f).valueAxis.renderer.minGridDistance=40;babelHelpers.classPrivateFieldGet(this,f).valueAxis.calculateTotals=true;babelHelpers.classPrivateFieldGet(this,f).categoryAxis.renderer.labels.template.marginRight=40}function M(e){babelHelpers.classPrivateFieldGet(this,p).data=e.map((function(e){e.id=e.id?e.id:BX.util.getRandomString(4);return e}))}function x(e){var t=this;var a=A.createSeries({id:5,title:"empty",color:"#ffffff"});a.hiddenInLegend=true;a.maskBullets=false;babelHelpers.classPrivateFieldGet(this,p).series.push(a);e.sort((function(e,t){if(!e.weight){return-1}if(e.weight<t.weight){return 1}else if(e.weight>t.weight){return-1}return 0}));e.forEach((function(e){var a,s;var r=babelHelpers.classPrivateFieldGet(t,p).series.push(A.createSeries(e));babelHelpers.classPrivateFieldGet(t,g)[e.id]=[e,r];babelHelpers.classPrivateFieldSet(t,m,(a=babelHelpers.classPrivateFieldGet(t,m),s=a++,a)),s;r.events.on("inited",(function(a){o(t,_,I).call(t,a.target,e.id)}),t)}))}function I(e,t){if(babelHelpers.classPrivateFieldGet(this,p).legend.labels.values.length===babelHelpers.classPrivateFieldGet(this,m)){o(this,F,W).call(this)}if(babelHelpers.classPrivateFieldGet(this,P)){o(this,w,U).call(this,e,t)}}function W(){if(babelHelpers.classPrivateFieldGet(this,v)){return}else{babelHelpers.classPrivateFieldSet(this,v,true)}if(babelHelpers.classPrivateFieldGet(this,h)instanceof Function){babelHelpers.classPrivateFieldGet(this,h).call(this,babelHelpers.classPrivateFieldGet(this,p).legend.labels.values)}}function B(){if(!babelHelpers.classPrivateFieldGet(this,d)){o(this,S,R).call(this)}else{babelHelpers.classPrivateFieldGet(this,f).categoryAxis.dataItemsByCategory.getKey("0").text=""}}function U(e,t){var a=this;var r=function r(i){var l=babelHelpers.slicedToArray(babelHelpers.classPrivateFieldGet(a,g)[t],1),n=l[0];var c={columnObject:e.columns.getIndex(i),columnSeries:n,storedData:babelHelpers.classPrivateFieldGet(a,p).data[i]};s.Event.bind(c.columnObject.group.node,"mouseover",o(a,T,D).bind(a,c));s.Event.bind(c.columnObject.group.node,"mouseout",o(a,G,X).bind(a,c));if(babelHelpers.classPrivateFieldGet(a,b)){c.columnObject.group.node.style.cursor="pointer";s.Event.bind(c.columnObject.group.node,"click",(function(){return babelHelpers.classPrivateFieldGet(a,b).call(a,c.storedData,n)}))}};for(var i=0;i<e.columns.length;i++){r(i)}}function D(e){var a;var s=(a=e.columnSeries)===null||a===void 0?void 0:a.getPopupContent(e.storedData);if(s&&!babelHelpers.classPrivateFieldGet(this,u)){var r=e.columnSeries.title;if(babelHelpers["typeof"](s)==="object"){r=s.title?s.title:r;s=s.content}babelHelpers.classPrivateFieldSet(this,u,new t.Popup("stacked-bar-chart-popup-".concat(BX.util.getRandomString(4)),e.columnObject.group.node,{content:A.formPopupContent(e.columnSeries.color,r,s),bindOptions:{position:"top"},offsetLeft:30,offsetTop:-1,noAllPaddings:true,autoHide:false,draggable:{restrict:false},cacheable:false}));babelHelpers.classPrivateFieldGet(this,u).show()}}function X(e){if(babelHelpers.classPrivateFieldGet(this,u)){babelHelpers.classPrivateFieldGet(this,u).close();babelHelpers.classPrivateFieldGet(this,u).destroy();babelHelpers.classPrivateFieldSet(this,u,null)}}var j;function K(e,t,a){V(e,t);t.set(e,a)}function V(e,t){if(t.has(e)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}var z=new WeakMap;var N=new WeakMap;var Y=function(){function e(t){babelHelpers.classCallCheck(this,e);K(this,z,{writable:true,value:void 0});K(this,N,{writable:true,value:void 0});if((this instanceof e?this.constructor:void 0)===e){throw new Error("StoreStackedChart cannot be directly instantiated")}this.properties=t;this.loadCurrency();babelHelpers.classPrivateFieldSet(this,z,new A({chartProps:this.getFormedChartProps(),isPopupEnabled:this.properties.isPopupEnabled,onChartClick:this.properties.onChartClick,onSeriesLabelLoad:this.onChartLabelLoadHandler.bind(this)}))}babelHelpers.createClass(e,[{key:"loadCurrency",value:function e(){if(this.properties.currency){babelHelpers.classPrivateFieldSet(this,N,this.properties.currency)}else{var t=s.Extension.getSettings("catalog.store-chart");babelHelpers.classPrivateFieldSet(this,N,{id:t.get("currency"),symbol:t.get("currencySymbol"),format:t.get("currencyFormat")})}a.CurrencyCore.setCurrencyFormat(babelHelpers.classPrivateFieldGet(this,N).id,babelHelpers.classPrivateFieldGet(this,N).format)}},{key:"getCurrency",value:function e(){return babelHelpers.classPrivateFieldGet(this,N)}},{key:"formatByCurrency",value:function e(t){return a.CurrencyCore.currencyFormat(t,this.getCurrency().id,true)}},{key:"getFormedChartProps",value:function e(){return{id:this.properties.id,label:this.getChartLabel(),isCommonChart:this.isCommonChart(),seriesList:this.getChartSeries(),columns:this.getChartColumns(this.properties.stores)}}},{key:"getHelpdeskButton",value:function e(t){return s.Tag.render(j||(j=babelHelpers.taggedTemplateLiteral(["\n\t\t\t<div onclick='top.BX.Helper.show(\"redirect=detail&code=",'")\' class="how-it-works-guide-link">',"</div>\n\t\t"])),t,s.Loc.getMessage("STORE_CHART_HINT_TITLE"))}},{key:"getChartLabel",value:function e(){return this.properties.label}},{key:"isCommonChart",value:function e(){return this.properties.isCommonChart}},{key:"getChartSeries",value:function e(){return[]}},{key:"getChartColumns",value:function e(t){return[]}},{key:"onChartLabelLoadHandler",value:function e(t){var a=", "+babelHelpers.classPrivateFieldGet(this,N).symbol;for(var s=0;s<t.length;s++){t[s].fill=am4core.color("#000000");t[s].html=t[s].currentText+a}}},{key:"getChart",value:function e(){return babelHelpers.classPrivateFieldGet(this,z)}}]);return e}();var Z=function(e){babelHelpers.inherits(t,e);function t(){babelHelpers.classCallCheck(this,t);return babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).apply(this,arguments))}babelHelpers.createClass(t,[{key:"getChartLabel",value:function e(){return babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"getChartLabel",this).call(this)}},{key:"isCommonChart",value:function e(){return babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"isCommonChart",this).call(this)}},{key:"getChartSeries",value:function e(){var t=this;return[{id:"sum_stored",color:"#42659B",title:s.Loc.getMessage("STORE_STOCK_CHART_SUM_STORED_SERIES_TITLE"),getPopupContent:function e(a){return{title:s.Loc.getMessage("STORE_STOCK_CHART_SUM_STORED_SERIES_POPUP_TITLE"),content:'\n\t\t\t\t\t\t\t<div class="stacked-bar-chart-popup-info-item" style="display: block">\n\t\t\t\t\t\t\t\t<div class="stacked-bar-chart-popup-info-subtitle">'.concat(s.Loc.getMessage("STORE_STOCK_CHART_SUM_STORED_SERIES_POPUP_SUM"),'</div>\n\t\t\t\t\t\t\t\t<div class="stacked-bar-chart-popup-info-value-box">\n\t\t\t\t\t\t\t\t\t<div id="chart-popup-template-sum" class="stacked-bar-chart-popup-info-value">').concat(t.formatByCurrency(a.sum_stored),"</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t")}}}]}},{key:"getChartColumns",value:function e(t){var a=[];for(var s in t){a.push(t[s])}return a}}]);return t}(Y);var q=function(e){babelHelpers.inherits(t,e);function t(){babelHelpers.classCallCheck(this,t);return babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).apply(this,arguments))}babelHelpers.createClass(t,[{key:"getChartLabel",value:function e(){return babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"getChartLabel",this).call(this)}},{key:"isCommonChart",value:function e(){return babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"isCommonChart",this).call(this)}},{key:"getChartSeries",value:function e(){var t=this;return[{id:"sum_shipped",color:"#6DA3E6",title:s.Loc.getMessage("STORE_SALE_CHART_SUM_SHIPPED_SERIES_TITLE"),getPopupContent:function e(a){return{title:s.Loc.getMessage("STORE_SALE_CHART_SUM_SHIPPED_SERIES_POPUP_TITLE"),content:'\n\t\t\t\t\t\t<div class="stacked-bar-chart-popup-info-multiple">\n\t\t\t\t\t\t\t<div class="stacked-bar-chart-popup-info-item" style="display: block">\n\t\t\t\t\t\t\t\t<div class="stacked-bar-chart-popup-info-subtitle">'.concat(s.Loc.getMessage("STORE_SALE_CHART_SUM_SHIPPED_SERIES_POPUP_SUM"),'</div>\n\t\t\t\t\t\t\t\t<div class="stacked-bar-chart-popup-info-value-box">\n\t\t\t\t\t\t\t\t\t<div id="chart-popup-template-sum" class="stacked-bar-chart-popup-info-value">').concat(t.formatByCurrency(a.sum_shipped),'</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="stacked-bar-chart-popup-info-item">\n\t\t\t\t\t\t\t\t<div class="stacked-bar-chart-popup-info-subtitle">').concat(s.Loc.getMessage("STORE_SALE_CHART_SUM_SHIPPED_SERIES_POPUP_SOLD_PERCENT"),'</div>\n\t\t\t\t\t\t\t\t<div class="stacked-bar-chart-popup-info-value-box">\n\t\t\t\t\t\t\t\t<div class="stacked-bar-chart-popup-info-value">').concat(a.sold_percent,"%</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t")}}},{id:"sum_arrived",color:"#42659B",title:s.Loc.getMessage("STORE_SALE_CHART_SUM_ARRIVED_SERIES_TITLE"),getPopupContent:function e(a){return{title:s.Loc.getMessage("STORE_SALE_CHART_SUM_ARRIVED_SERIES_POPUP_TITLE"),content:'\n\t\t\t\t\t\t\t<div class="stacked-bar-chart-popup-info-item" style="display: block">\n\t\t\t\t\t\t\t\t<div class="stacked-bar-chart-popup-info-subtitle">'.concat(s.Loc.getMessage("STORE_SALE_CHART_SUM_ARRIVED_SERIES_POPUP_SUM"),'</div>\n\t\t\t\t\t\t\t\t<div class="stacked-bar-chart-popup-info-value-box">\n\t\t\t\t\t\t\t\t\t<div id="chart-popup-template-sum" class="stacked-bar-chart-popup-info-value">').concat(t.formatByCurrency(a.sum_arrived),"</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t")}}}]}},{key:"getChartColumns",value:function e(t){var a=[];for(var s in t){a.push(t[s])}return a}}]);return t}(Y);e.StoreStockChart=Z;e.StoreSaleChart=q;e.StackedBarChart=A})(this.BX.Catalog=this.BX.Catalog||{},BX.Main,BX.Currency,BX);
//# sourceMappingURL=store-chart.bundle.map.js