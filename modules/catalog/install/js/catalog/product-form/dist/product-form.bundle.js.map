{"version":3,"file":"product-form.bundle.js","sources":["../src/types/form-element-position.js","../src/models/product-list.js","../src/config.js","../src/types/form-input-code.js","../src/types/form-error-code.js","../src/types/form-mode.js","../src/templates/fields/quantity.js","../src/templates/fields/price.js","../src/templates/fields/discount.js","../src/templates/fields/tax.js","../src/templates/fields/inline-selector.js","../src/templates/fields/brand.js","../src/templates/fields/result-sum.js","../src/templates/row.js","../src/types/form-compilation-type.js","../src/types/form-helpdesk-code.js","../src/templates/elements/panel-compilation.js","../src/templates/elements/panel-buttons.js","../src/templates/form.js","../src/product-form.js"],"sourcesContent":["export class FormElementPosition\n{\n\tstatic TOP: string = 'TOP';\n\tstatic BOTTOM: string = 'BOTTOM';\n}","import {Vue} from 'ui.vue';\nimport {Text, Type} from 'main.core';\nimport {VuexBuilderModel} from 'ui.vue.vuex';\nimport {DiscountType} from \"catalog.product-calculator\";\nimport {FormElementPosition} from \"../types/form-element-position\";\nimport {CurrencyCore} from \"currency.currency-core\";\nimport type {FormScheme} from \"../types/form-scheme\";\nimport type {BasketItem} from \"../types/basket-item\";\n\nexport class ProductList extends VuexBuilderModel\n{\n\t/**\n\t * @inheritDoc\n\t */\n\tgetName(): string\n\t{\n\t\treturn 'productList';\n\t}\n\n\tgetState(): FormScheme\n\t{\n\t\treturn {\n\t\t\tcurrency: '',\n\t\t\ttaxIncluded: 'N',\n\t\t\tbasket: [],\n\t\t\ttotal: {\n\t\t\t\tsum: 0,\n\t\t\t\tdiscount: 0,\n\t\t\t\ttaxSum: 0,\n\t\t\t\tresult: 0,\n\t\t\t},\n\t\t}\n\t}\n\n\tstatic getBaseProduct(): BasketItem\n\t{\n\t\tconst random = Text.getRandom();\n\t\treturn {\n\t\t\tofferId: null,\n\t\t\tselectorId: random,\n\t\t\tfields: {\n\t\t\t\tinnerId: random,\n\t\t\t\tproductId: null,\n\t\t\t\tskuId: null,\n\t\t\t\tcode: null,\n\t\t\t\tmodule: null,\n\t\t\t\tsort: 0,\n\t\t\t\tprice: null,\n\t\t\t\tbasePrice: null,\n\t\t\t\tpriceExclusive: null,\n\t\t\t\tquantity: 1,\n\t\t\t\tname: '',\n\t\t\t\tdiscount: 0,\n\t\t\t\tdiscountRate: 0,\n\t\t\t\tdiscountInfos: [],\n\t\t\t\tdiscountType: DiscountType.PERCENTAGE,\n\t\t\t\ttax: 0,\n\t\t\t\ttaxSum: 0,\n\t\t\t\ttaxIncluded: 'N',\n\t\t\t\tmeasureCode: 0,\n\t\t\t\tmeasureName: '',\n\t\t\t\tmeasureRatio: 1,\n\t\t\t\tisCustomPrice: 'N',\n\t\t\t\tadditionalFields: [],\n\t\t\t\tproperties: [],\n\t\t\t\tbrands: [],\n\t\t\t},\n\t\t\tcalculatedFields: [],\n\t\t\tcatalogFields: {},\n\t\t\tshowDiscount: 'N',\n\t\t\tshowTax: 'N',\n\t\t\tskuTree: [],\n\t\t\timage: null,\n\t\t\tsum: 0,\n\t\t\tcatalogPrice: null,\n\t\t\tdiscountSum: 0,\n\t\t\tdetailUrl: '',\n\t\t\tencodedFields: null,\n\t\t\terrors: [],\n\t\t};\n\t}\n\n\tgetActions()\n\t{\n\t\treturn {\n\t\t\tresetBasket ({commit})\n\t\t\t{\n\t\t\t\tcommit('clearBasket');\n\t\t\t\tcommit('addItem', {});\n\t\t\t},\n\t\t\tremoveItem({dispatch, commit, state}, payload)\n\t\t\t{\n\t\t\t\tcommit('deleteItem', payload);\n\t\t\t\tif (state.basket.length === 0)\n\t\t\t\t{\n\t\t\t\t\tcommit('addItem', {});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tstate.basket.forEach((item, i) => {\n\t\t\t\t\t\tcommit('updateItem', {\n\t\t\t\t\t\t\tindex: i,\n\t\t\t\t\t\t\tfields: {sort: i}\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tdispatch('calculateTotal');\n\t\t\t},\n\t\t\tchangeItem: ({dispatch, commit}, payload) =>\n\t\t\t{\n\t\t\t\tcommit('updateItem', payload);\n\t\t\t\tdispatch('calculateTotal');\n\t\t\t},\n\t\t\tsetCurrency: ({commit}, payload) =>\n\t\t\t{\n\t\t\t\tconst currency = payload || '';\n\t\t\t\tcommit('setCurrency', currency);\n\t\t\t},\n\t\t\taddItem: ({dispatch, commit}, payload) =>\n\t\t\t{\n\t\t\t\tconst item = payload.item || {fields: {}};\n\t\t\t\tcommit('addItem', {\n\t\t\t\t\titem,\n\t\t\t\t\tposition: payload.position || FormElementPosition.TOP\n\t\t\t\t});\n\t\t\t\tdispatch('calculateTotal');\n\t\t\t},\n\t\t\tcalculateTotal: ({commit, state}) =>\n\t\t\t{\n\t\t\t\tconst total = {\n\t\t\t\t\tsum: 0,\n\t\t\t\t\ttaxSum: 0,\n\t\t\t\t\tdiscount: 0,\n\t\t\t\t\tresult: 0,\n\t\t\t\t};\n\n\t\t\t\tstate.basket.forEach((item) => {\n\t\t\t\t\tconst basePrice = Text.toNumber(item.fields.basePrice || 0);\n\t\t\t\t\tconst quantity = Text.toNumber(item.fields.quantity || 0);\n\t\t\t\t\tconst discount = Text.toNumber(item.fields.discount || 0);\n\t\t\t\t\tconst taxSum = Text.toNumber(item.fields.taxSum || 0);\n\t\t\t\t\ttotal.sum += basePrice * quantity;\n\t\t\t\t\ttotal.result += Text.toNumber(item.sum);\n\t\t\t\t\ttotal.discount += discount * quantity;\n\t\t\t\t\ttotal.taxSum += taxSum * quantity;\n\t\t\t\t});\n\n\t\t\t\ttotal.discount = (total.discount > total.sum) ? total.sum : total.discount;\n\n\t\t\t\tcommit('setTotal', total)\n\t\t\t}\n\t\t}\n\t}\n\n\tgetGetters()\n\t{\n\t\treturn {\n\t\t\tgetBasket: state => (): Array<BasketItem> =>\n\t\t\t{\n\t\t\t\treturn state.basket;\n\t\t\t},\n\t\t\tgetBaseProduct: () => (): BasketItem =>\n\t\t\t{\n\t\t\t\treturn ProductList.getBaseProduct();\n\t\t\t},\n\t\t}\n\t}\n\n\tgetMutations()\n\t{\n\t\treturn {\n\t\t\taddItem: (state, payload) =>\n\t\t\t{\n\t\t\t\tlet item = ProductList.getBaseProduct();\n\n\t\t\t\titem = Object.assign(item, payload.item);\n\t\t\t\tif (payload.position === FormElementPosition.BOTTOM)\n\t\t\t\t{\n\t\t\t\t\tstate.basket.push(item);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tstate.basket.unshift(item);\n\t\t\t\t}\n\n\t\t\t\tstate.basket.forEach((item, index) => {\n\t\t\t\t\titem.fields.sort = index;\n\t\t\t\t});\n\t\t\t},\n\t\t\tupdateItem: (state, payload) =>\n\t\t\t{\n\t\t\t\tif (Type.isNil(state.basket[payload.index]))\n\t\t\t\t{\n\t\t\t\t\tVue.set(state.basket, payload.index, ProductList.getBaseProduct());\n\t\t\t\t}\n\n\t\t\t\tstate.basket[payload.index] = Object.assign(\n\t\t\t\t\tstate.basket[payload.index],\n\t\t\t\t\tpayload.product\n\t\t\t\t);\n\t\t\t},\n\t\t\tclearBasket: (state) =>\n\t\t\t{\n\t\t\t\tstate.basket = [];\n\t\t\t},\n\t\t\tdeleteItem: (state, payload) =>\n\t\t\t{\n\t\t\t\tstate.basket.splice(payload.index, 1);\n\t\t\t\tstate.basket.forEach((item, index) => {\n\t\t\t\t\titem.fields.sort = index;\n\t\t\t\t});\n\t\t\t},\n\t\t\tsetErrors: (state, payload) =>\n\t\t\t{\n\t\t\t\tstate.errors = payload;\n\t\t\t},\n\t\t\tclearErrors: (state) =>\n\t\t\t{\n\t\t\t\tstate.errors = [];\n\t\t\t},\n\t\t\tsetCurrency: (state, payload) =>\n\t\t\t{\n\t\t\t\tstate.currency = payload;\n\t\t\t},\n\t\t\tsetTotal: (state, payload) =>\n\t\t\t{\n\t\t\t\tconst formattedTotal = payload;\n\t\t\t\tif (Type.isStringFilled(state.currency))\n\t\t\t\t{\n\t\t\t\t\tfor (const key in payload)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (payload.hasOwnProperty(key))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tformattedTotal[key] = CurrencyCore.currencyFormat(payload[key], state.currency)\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tstate.total = Object.assign(\n\t\t\t\t\tstate.total,\n\t\t\t\t\tformattedTotal\n\t\t\t\t);\n\t\t\t},\n\t\t}\n\t}\n}\n","export const config = Object.freeze({\n\tdatabaseConfig: {\n\t\tname: 'catalog.product-form',\n\t},\n\ttemplateName: 'bx-form',\n\ttemplatePanelButtons: 'bx-panel-buttons',\n\ttemplatePanelCompilation: 'bx-panel-compilation',\n\ttemplateRowName: 'bx-form-row',\n\ttemplateFieldInlineSelector: 'bx-field-inline-selector',\n\ttemplateFieldPrice: 'bx-field-price',\n\ttemplateFieldResultSum: 'bx-field-result-sum',\n\ttemplateFieldQuantity: 'bx-field-quantity',\n\ttemplateFieldDiscount: 'bx-field-discount',\n\ttemplateFieldTax: 'bx-field-tax',\n\ttemplateFieldBrand: 'bx-field-brand',\n\tmoduleId: 'catalog',\n});","export class FormInputCode\n{\n\tstatic PRODUCT_SELECTOR = 'product-selector';\n\tstatic IMAGE_EDITOR = 'image-editor';\n\tstatic QUANTITY = 'quantity';\n\tstatic PRICE = 'price';\n\tstatic RESULT = 'result';\n\tstatic DISCOUNT = 'discount';\n\tstatic TAX = 'tax';\n\tstatic BRAND = 'brand';\n\tstatic MEASURE = 'measure';\n}","export class FormErrorCode\n{\n\tstatic EMPTY_PRODUCT_SELECTOR = 0;\n\tstatic EMPTY_IMAGE = 1;\n\tstatic EMPTY_QUANTITY = 2;\n\tstatic EMPTY_PRICE = 3;\n\tstatic EMPTY_BRAND = 4;\n\tstatic IS_NULLABLE_PRICE = 5;\n}","export class FormMode\n{\n\tstatic REGULAR: string = 'REGULAR';\n\tstatic READ_ONLY: string = 'READ_ONLY';\n\tstatic COMPILATION: string = 'COMPILATION';\n\tstatic COMPILATION_READ_ONLY: string = 'COMPILATION_READ_ONLY';\n}","import {Menu, MenuItem} from 'main.popup';\nimport {Runtime, Type, Text} from 'main.core';\nimport {Vue} from \"ui.vue\";\nimport {config} from \"../../config\";\nimport type {BaseEvent} from \"main.core.events\";\n\nVue.component(config.templateFieldQuantity,\n{\n\t/**\n\t * @emits 'onChangeQuantity' {quantity: number}\n\t * @emits 'onSelectMeasure' {quantity: number, }\n\t */\n\n\tprops: {\n\t\tmeasureCode: Number,\n\t\tmeasureRatio: Number,\n\t\tmeasureName: String,\n\t\tquantity: Number,\n\t\teditable: Boolean,\n\t\tsaveableMeasure: Boolean,\n\t\thasError: Boolean,\n\t\toptions: Object,\n\t},\n\tcreated()\n\t{\n\t\tthis.onInputQuantityHandler = Runtime.debounce(this.onInputQuantity, 500, this);\n\t},\n\tmethods:\n\t{\n\t\tonInputQuantity(event: BaseEvent): void\n\t\t{\n\t\t\tif (!this.editable)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tevent.target.value = event.target.value.replace(/[^.\\d]/g,'.');\n\t\t\tconst newQuantity = Text.toNumber(event.target.value);\n\t\t\tconst lastSymbol = event.target.value.substr(-1);\n\n\t\t\tif (lastSymbol === '.')\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.changeQuantity(newQuantity);\n\t\t},\n\t\tcalculateCorrectionFactor(quantity, measureRatio)\n\t\t{\n\t\t\tlet factoredQuantity = quantity;\n\t\t\tlet factoredRatio = measureRatio;\n\t\t\tlet correctionFactor = 1;\n\n\t\t\twhile (!(Number.isInteger(factoredQuantity) && Number.isInteger(factoredRatio)))\n\t\t\t{\n\t\t\t\tcorrectionFactor *= 10;\n\t\t\t\tfactoredQuantity = quantity * correctionFactor;\n\t\t\t\tfactoredRatio = measureRatio * correctionFactor;\n\t\t\t}\n\n\t\t\treturn correctionFactor;\n\t\t},\n\t\tincrementValue()\n\t\t{\n\t\t\tif (!this.editable)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst correctionFactor = this.calculateCorrectionFactor(this.quantity, this.measureRatio);\n\t\t\tconst quantity = (this.quantity * correctionFactor + this.measureRatio * correctionFactor) / correctionFactor;\n\t\t\tthis.changeQuantity(quantity);\n\t\t},\n\t\tdecrementValue()\n\t\t{\n\t\t\tif (this.quantity > this.measureRatio && this.editable)\n\t\t\t{\n\t\t\t\tconst correctionFactor = this.calculateCorrectionFactor(this.quantity, this.measureRatio);\n\t\t\t\tconst quantity = (this.quantity * correctionFactor - this.measureRatio * correctionFactor) / correctionFactor;\n\t\t\t\tthis.changeQuantity(quantity);\n\t\t\t}\n\t\t},\n\t\tchangeQuantity(value: number)\n\t\t{\n\t\t\tthis.$emit('onChangeQuantity', value);\n\t\t},\n\t\tshowPopupMenu(target: HTMLElement)\n\t\t{\n\t\t\tif (!this.editable || !Type.isArray(this.options.measures))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst menuItems = [];\n\t\t\tthis.options.measures.forEach((item) => {\n\t\t\t\tmenuItems.push({\n\t\t\t\t\ttext: item.SYMBOL,\n\t\t\t\t\titem: item,\n\t\t\t\t\tonclick: this.selectMeasure,\n\t\t\t\t})\n\t\t\t});\n\n\n\t\t\tif (menuItems.length > 0)\n\t\t\t{\n\t\t\t\tthis.popupMenu = new Menu({\n\t\t\t\t\tbindElement: target,\n\t\t\t\t\titems: menuItems\n\t\t\t\t});\n\n\t\t\t\tthis.popupMenu.show();\n\t\t\t}\n\t\t},\n\t\tselectMeasure(event: BaseEvent, params: MenuItem)\n\t\t{\n\t\t\tthis.$emit('onSelectMeasure', {\n\t\t\t\tcode: params.options?.item.CODE,\n\t\t\t\tname: params.options?.item.SYMBOL,\n\t\t\t});\n\n\t\t\tif (this.popupMenu)\n\t\t\t{\n\t\t\t\tthis.popupMenu.close();\n\t\t\t}\n\t\t},\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"catalog-pf-product-input-wrapper\" v-bind:class=\"{ 'ui-ctl-danger': hasError }\">\n\t\t\t<input \t\n\t\t\t\ttype=\"text\" class=\"catalog-pf-product-input\"\n\t\t\t\tv-bind:class=\"{ 'catalog-pf-product-input--disabled': !editable }\"\n\t\t\t\t:value=\"quantity\"\n\t\t\t\t@input=\"onInputQuantityHandler\"\n\t\t\t\t:disabled=\"!editable\"\n\t\t\t>\n\t\t\t<div \n\t\t\t\tclass=\"catalog-pf-product-input-info catalog-pf-product-input-info--action\" \n\t\t\t\t@click=\"showPopupMenu($event.target)\"\n\t\t\t>\n\t\t\t\t<span>{{ measureName }}</span>\n\t\t\t</div>\n\t\t</div>\n\t`\n});","import {Runtime, Text} from 'main.core';\nimport {Vue} from \"ui.vue\";\nimport {config} from \"../../config\";\nimport type {BaseEvent} from \"main.core.events\";\n\nVue.component(config.templateFieldPrice,\n{\n\t/**\n\t * @emits 'onChangePrice' {price: number}\n\t * @emits 'saveCatalogField' {}\n\t */\n\n\tprops: {\n\t\tselectorId: String,\n\t\tprice: Number,\n\t\teditable: Boolean,\n\t\thasError: Boolean,\n\t\toptions: Object,\n\t},\n\tcreated()\n\t{\n\t\tthis.onInputPriceHandler = Runtime.debounce(this.onInputPrice, 500, this);\n\t},\n\tmethods:\n\t{\n\t\tonInputPrice(event: BaseEvent): void\n\t\t{\n\t\t\tif (!this.editable)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tevent.target.value = event.target.value.replace(/[^.,\\d]/g,'');\n\t\t\tif (event.target.value === '')\n\t\t\t{\n\t\t\t\tevent.target.value = 0;\n\t\t\t}\n\t\t\tconst lastSymbol = event.target.value.substr(-1);\n\t\t\tif (lastSymbol === ',')\n\t\t\t{\n\t\t\t\tevent.target.value = event.target.value.replace(',', \".\");\n\t\t\t}\n\n\t\t\tlet newPrice = Text.toNumber(event.target.value);\n\t\t\tif (lastSymbol === '.' || lastSymbol === ',')\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (newPrice < 0)\n\t\t\t{\n\t\t\t\tnewPrice *= -1;\n\t\t\t}\n\n\t\t\tthis.$emit('onChangePrice', newPrice);\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tlocalize()\n\t\t{\n\t\t\treturn Vue.getFilteredPhrases('CATALOG_');\n\t\t},\n\t\tcurrencySymbol()\n\t\t{\n\t\t\treturn this.options.currencySymbol || '';\n\t\t},\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"catalog-pf-product-input-wrapper\" v-bind:class=\"{ 'ui-ctl-danger': hasError }\">\n\t\t\t<input \ttype=\"text\" class=\"catalog-pf-product-input catalog-pf-product-input--align-right\"\n\t\t\t\t\tv-bind:class=\"{ 'catalog-pf-product-input--disabled': !editable }\"\n\t\t\t\t\tv-model.lazy=\"price\"\n\t\t\t\t\t@input=\"onInputPriceHandler\"\n\t\t\t\t\t:disabled=\"!editable\"\n\t\t\t>\n\t\t\t<div class=\"catalog-pf-product-input-info\" v-html=\"currencySymbol\"></div>\n\t\t</div>\n\t`\n});\n","import {Menu} from 'main.popup';\nimport { Runtime, Text, Type} from 'main.core';\nimport {Vue} from \"ui.vue\";\nimport {config} from \"../../config\";\nimport {DiscountType} from \"catalog.product-calculator\";\n\nVue.component(config.templateFieldDiscount,\n{\n\t/**\n\t * @emits 'changeDiscountType' {type: Y|N}\n\t * @emits 'changeDiscount' {discountValue: number}\n\t */\n\n\tprops: {\n\t\teditable: Boolean,\n\t\toptions: Object,\n\t\tdiscount: Number,\n\t\tdiscountType: Number,\n\t\tdiscountRate: Number,\n\t},\n\tcreated()\n\t{\n\t\tthis.onInputDiscount = Runtime.debounce(this.onChangeDiscount, 500, this);\n\t\tthis.currencySymbol = this.options.currencySymbol;\n\t},\n\tmethods:\n\t{\n\t\tonChangeType(event, params)\n\t\t{\n\t\t\tif (!this.editable)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst type = (Text.toNumber(params?.options?.type) === DiscountType.MONETARY) ?  DiscountType.MONETARY : DiscountType.PERCENTAGE;\n\t\t\tthis.$emit('changeDiscountType', type);\n\n\t\t\tif (this.popupMenu)\n\t\t\t{\n\t\t\t\tthis.popupMenu.close();\n\t\t\t}\n\t\t},\n\t\tonChangeDiscount(event)\n\t\t{\n\t\t\tconst discountValue = Text.toNumber(event.target.value) || 0;\n\t\t\tif (discountValue === Text.toNumber(this.discount) || !this.editable)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.$emit('changeDiscount', discountValue);\n\t\t},\n\t\tshowPopupMenu(target)\n\t\t{\n\t\t\tif (!this.editable || !Type.isArray(this.options.allowedDiscountTypes))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst menuItems = [];\n\t\t\tif (this.options.allowedDiscountTypes.includes(DiscountType.PERCENTAGE))\n\t\t\t{\n\t\t\t\tmenuItems.push({\n\t\t\t\t\ttext: '%',\n\t\t\t\t\tonclick: this.onChangeType,\n\t\t\t\t\ttype: DiscountType.PERCENTAGE,\n\t\t\t\t})\n\t\t\t}\n\n\t\t\tif (this.options.allowedDiscountTypes.includes(DiscountType.MONETARY))\n\t\t\t{\n\t\t\t\tmenuItems.push({\n\t\t\t\t\ttext: this.currencySymbol,\n\t\t\t\t\tonclick: this.onChangeType,\n\t\t\t\t\ttype: DiscountType.MONETARY,\n\t\t\t\t})\n\t\t\t}\n\n\t\t\tif (menuItems.length > 0)\n\t\t\t{\n\t\t\t\tthis.popupMenu = new Menu({\n\t\t\t\t\tbindElement: target,\n\t\t\t\t\titems: menuItems\n\t\t\t\t});\n\n\t\t\t\tthis.popupMenu.show();\n\t\t\t}\n\t\t},\n\t},\n\tcomputed: {\n\t\tgetDiscountInputValue()\n\t\t{\n\t\t\tif (Text.toNumber(this.discountType) === DiscountType.PERCENTAGE)\n\t\t\t{\n\t\t\t\treturn Text.toNumber(this.discountRate);\n\t\t\t}\n\t\t\treturn Text.toNumber(this.discount);\n\t\t},\n\t\tgetDiscountSymbol()\n\t\t{\n\t\t\treturn Text.toNumber(this.discountType) === DiscountType.PERCENTAGE ? '%' : this.currencySymbol;\n\t\t},\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"catalog-pf-product-input-wrapper catalog-pf-product-input-wrapper--left\">\n\t\t\t<input class=\"catalog-pf-product-input catalog-pf-product-input--align-right catalog-pf-product-input--right\"\n\t\t\t\t\tv-bind:class=\"{ 'catalog-pf-product-input--disabled': !editable }\"\n\t\t\t\t\tref=\"discountInput\" \n\t\t\t\t\t:value=\"getDiscountInputValue\"\n\t\t\t\t\t:v-model=\"discountRate\"\n\t\t\t\t\t@input=\"onInputDiscount\"\n\t\t\t\t\tplaceholder=\"0\"\n\t\t\t\t\t:disabled=\"!editable\">\n\t\t\t<div class=\"catalog-pf-product-input-info catalog-pf-product-input-info--action\" \n\t\t\t\t@click=\"showPopupMenu\">\n\t\t\t\t<span v-html=\"getDiscountSymbol\"></span>\n\t\t\t</div>\n\t\t</div>\n\t`\n});","import {Menu} from 'main.popup';\nimport {Text, Type} from 'main.core';\nimport {Vue} from \"ui.vue\";\nimport {config} from \"../../config\";\n\nVue.component(config.templateFieldTax,\n{\n\t/**\n\t * @emits 'changeTax' {taxValue: number}\n\t */\n\n\tprops: {\n\t\ttaxId: Number,\n\t\teditable: Boolean,\n\t\toptions: Object,\n\t},\n\tdata()\n\t{\n\t\treturn {\n\t\t\ttaxValue: this.getTaxList()[this.taxId] || 0\n\t\t};\n\t},\n\tmethods:\n\t{\n\t\tonChangeValue(event, params)\n\t\t{\n\t\t\tconst taxValue = Text.toNumber(params?.options?.item);\n\t\t\tif (taxValue === Text.toNumber(this.taxValue) || !this.editable)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.$emit('changeTax', {\n\t\t\t\ttaxValue,\n\t\t\t\ttaxId: params?.options?.id\n\t\t\t});\n\n\t\t\tif (this.popupMenu)\n\t\t\t{\n\t\t\t\tthis.popupMenu.close();\n\t\t\t}\n\t\t},\n\t\tgetTaxList()\n\t\t{\n\t\t\treturn Type.isArray(this.options.taxList) ? this.options.taxList : [];\n\t\t},\n\t\tshowPopupMenu(target)\n\t\t{\n\t\t\tif (!this.editable || !Type.isArray(this.options.taxList))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst menuItems = [];\n\t\t\tthis.options.taxList.forEach((item, id) => {\n\t\t\t\tmenuItems.push({\n\t\t\t\t\tid,\n\t\t\t\t\ttext: item + '%',\n\t\t\t\t\titem: item,\n\t\t\t\t\tonclick: this.onChangeValue,\n\t\t\t\t})\n\t\t\t});\n\n\n\t\t\tif (menuItems.length > 0)\n\t\t\t{\n\t\t\t\tthis.popupMenu = new Menu({\n\t\t\t\t\tbindElement: target,\n\t\t\t\t\titems: menuItems\n\t\t\t\t});\n\n\t\t\t\tthis.popupMenu.show();\n\t\t\t}\n\t\t},\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"catalog-pf-product-input-wrapper catalog-pf-product-input-wrapper--right\" @click=\"showPopupMenu\">\n\t\t\t<div class=\"catalog-pf-product-input\">{{this.taxValue}}%</div>\n\t\t\t<div class=\"catalog-pf-product-input-info catalog-pf-product-input-info--dropdown\"></div>\n\t\t</div>\n\t`\n});","import {Type} from 'main.core';\nimport {Vue} from \"ui.vue\";\nimport {config} from \"../../config\";\nimport {FormInputCode} from \"../../types/form-input-code\";\nimport {ProductSelector} from \"catalog.product-selector\";\nimport {EventEmitter} from \"main.core.events\";\nimport type {BaseEvent} from \"main.core.events\";\n\nVue.component(config.templateFieldInlineSelector,\n{\n\t/**\n\t * @emits 'onProductChange' {fields: object}\n\t */\n\n\tprops: {\n\t\teditable: Boolean,\n\t\tbasketLength: Number,\n\t\toptions: Object,\n\t\tbasketItem: Object,\n\t\tmodel: Object,\n\t},\n\tdata()\n\t{\n\t\treturn {\n\t\t\tcurrencySymbol: null,\n\t\t\tproductSelector: null,\n\t\t\timageControlId: null,\n\t\t\tselectorId: this.basketItem.selectorId,\n\t\t};\n\t},\n\tcreated()\n\t{\n\t\tEventEmitter.subscribe('BX.Catalog.ProductSelector:onProductSelect', this.onProductSelect.bind(this));\n\t\tEventEmitter.subscribe('BX.Catalog.ProductSelector:onChange', this.onProductChange.bind(this));\n\t\tEventEmitter.subscribe('BX.Catalog.ProductSelector:onClear', this.onProductClear.bind(this))\n\t\tEventEmitter.subscribe(this.$root.$app, 'onChangeCompilationMode', this.changeProductSelectorImageRequire.bind(this));\n\t},\n\tmounted()\n\t{\n\t\tthis.productSelector = new ProductSelector(this.selectorId, this.prepareSelectorParams());\n\t\tthis.productSelector.renderTo(this.$refs.selectorWrapper);\n\t},\n\tmethods:\n\t{\n\t\tchangeProductSelectorImageRequire(event: BaseEvent)\n\t\t{\n\t\t\tconst isCompilationMode = event.getData()?.isCompilationMode;\n\t\t\tconst isFacebookForm = event.getData()?.isFacebookForm;\n\n\t\t\tthis.productSelector.setConfig(\n\t\t\t\t'ENABLE_EMPTY_IMAGES_ERROR',\n\t\t\t\tisCompilationMode && isFacebookForm\n\t\t\t);\n\n\t\t\tthis.productSelector.checkEmptyImageError();\n\t\t\tthis.productSelector.layoutErrors();\n\t\t},\n\t\tprepareSelectorParams(): Object\n\t\t{\n\t\t\tconst fields = {\n\t\t\t\tNAME: this.getField('name') || '',\n\t\t\t};\n\n\t\t\tif (!Type.isNil(this.getField('basePrice')))\n\t\t\t{\n\t\t\t\tfields.PRICE = this.getField('basePrice');\n\t\t\t\tfields.CURRENCY = this.options.currency;\n\t\t\t}\n\n\t\t\tconst basketItemOfferId = this.basketItem.offerId;\n\t\t\tconst facebookFailProducts = this.options.facebookFailProducts;\n\t\t\tconst hasFacebookError =\n\t\t\t\tType.isObject(facebookFailProducts)\n\t\t\t\t&& facebookFailProducts.hasOwnProperty(basketItemOfferId)\n\t\t\t;\n\n\t\t\tconst selectorOptions = {\n\t\t\t\tiblockId: this.options.iblockId,\n\t\t\t\tbasePriceId: this.options.basePriceId,\n\t\t\t\tcurrency: this.options.currency,\n\t\t\t\tskuTree: this.getDefaultSkuTree(),\n\t\t\t\tfileInputId: '',\n\t\t\t\tmorePhotoValues: [],\n\t\t\t\tfileInput: '',\n\t\t\t\tmodel: this.model,\n\t\t\t\tconfig: {\n\t\t\t\t\tDETAIL_PATH: this.basketItem.detailUrl || '',\n\t\t\t\t\tENABLE_SEARCH: true,\n\t\t\t\t\tENABLE_INPUT_DETAIL_LINK: true,\n\t\t\t\t\tENABLE_IMAGE_CHANGE_SAVING: true,\n\t\t\t\t\tENABLE_EMPTY_PRODUCT_ERROR: this.options.enableEmptyProductError || this.isRequiredField(FormInputCode.PRODUCT_SELECTOR),\n\t\t\t\t\tENABLE_EMPTY_IMAGES_ERROR: this.isRequiredField(FormInputCode.IMAGE_EDITOR),\n\t\t\t\t\tROW_ID: this.selectorId,\n\t\t\t\t\tENABLE_SKU_SELECTION: this.editable,\n\t\t\t\t\tHIDE_UNSELECTED_ITEMS: this.options.hideUnselectedProperties,\n\t\t\t\t\tURL_BUILDER_CONTEXT: this.options.urlBuilderContext\n\t\t\t\t},\n\t\t\t\tfailedProduct: hasFacebookError,\n\t\t\t\tmode: this.editable ? ProductSelector.MODE_EDIT : ProductSelector.MODE_VIEW,\n\t\t\t\tfields,\n\t\t\t};\n\n\t\t\tconst formImage = this.basketItem.image;\n\t\t\tif (Type.isObject(formImage))\n\t\t\t{\n\t\t\t\tselectorOptions.fileView = formImage.preview;\n\t\t\t\tselectorOptions.fileInput = formImage.input;\n\t\t\t\tselectorOptions.fileInputId = formImage.id;\n\t\t\t\tselectorOptions.morePhotoValues = formImage.values;\n\t\t\t}\n\n\t\t\treturn selectorOptions;\n\t\t},\n\t\tisEnabledSaving(): boolean\n\t\t{\n\t\t\treturn this.options.enableCatalogSaving && this.basketItem.hasEditRights;\n\t\t},\n\t\tisRequiredField(code: string): boolean\n\t\t{\n\t\t\treturn Type.isArray(this.options.requiredFields) && this.options.requiredFields.includes(code);\n\t\t},\n\t\tgetDefaultSkuTree(): Object\n\t\t{\n\t\t\tlet skuTree = this.basketItem.skuTree || {};\n\t\t\tif (Type.isStringFilled(skuTree))\n\t\t\t{\n\t\t\t\tskuTree = JSON.parse(skuTree);\n\t\t\t}\n\n\t\t\treturn skuTree;\n\t\t},\n\t\tgetField(name, defaultValue = null): any\n\t\t{\n\t\t\treturn this.basketItem.fields[name] || defaultValue;\n\t\t},\n\t\tonProductSelect(event: BaseEvent)\n\t\t{\n\t\t\tconst data = event.getData();\n\t\t\tif (Type.isStringFilled(data.selectorId) && data.selectorId === this.productSelector.getId())\n\t\t\t{\n\t\t\t\tthis.$emit('onProductSelect');\n\t\t\t}\n\t\t},\n\t\tonProductChange(event: BaseEvent): void\n\t\t{\n\t\t\tconst data = event.getData();\n\t\t\tif (Type.isStringFilled(data.selectorId) && data.selectorId === this.productSelector.getId())\n\t\t\t{\n\t\t\t\tconst basePrice = data.fields.BASE_PRICE\n\n\t\t\t\tconst fields = {\n\t\t\t\t\tBASE_PRICE: basePrice,\n\t\t\t\t\tMODULE: 'catalog',\n\t\t\t\t\tNAME: data.fields.NAME,\n\t\t\t\t\tID: data.fields.ID,\n\t\t\t\t\tPRODUCT_ID: data.fields.PRODUCT_ID,\n\t\t\t\t\tSKU_ID: data.fields.SKU_ID,\n\t\t\t\t\tPROPERTIES: data.fields.PROPERTIES,\n\t\t\t\t\tURL_BUILDER_CONTEXT: this.options.urlBuilderContext,\n\t\t\t\t\tCUSTOMIZED: (Type.isNil(data.fields.PRICE) || data.fields.CUSTOMIZED === 'Y') ? 'Y' : 'N',\n\t\t\t\t\tMEASURE_CODE: data.fields.MEASURE_CODE,\n\t\t\t\t\tMEASURE_NAME: data.fields.MEASURE_NAME,\n\t\t\t\t\tMORE_PHOTO: data.morePhoto,\n\t\t\t\t\tBRANDS: data.fields.BRANDS,\n\t\t\t\t\tIS_NEW: data.isNew,\n\t\t\t\t};\n\n\t\t\t\tthis.$emit('onProductChange', fields);\n\t\t\t}\n\t\t},\n\t\tonProductClear(event: BaseEvent)\n\t\t{\n\t\t\tconst data = event.getData();\n\n\t\t\tif (Type.isStringFilled(data.selectorId) && data.selectorId === this.productSelector.getId())\n\t\t\t{\n\t\t\t\tthis.$emit('onProductClear');\n\t\t\t}\n\t\t},\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"catalog-pf-product-item-section\" :id=\"selectorId\" ref=\"selectorWrapper\"></div>\n\t`\n});\n","import {ajax, Cache, Dom, Loc, Tag, Text, Type} from 'main.core';\nimport {Vue} from \"ui.vue\";\nimport {config} from \"../../config\";\nimport type {BaseEvent} from \"main.core.events\";\nimport {EventEmitter} from 'main.core.events';\nimport {Dialog, TagSelector} from \"ui.entity-selector\";\n\nVue.component(config.templateFieldBrand,\n{\n\t/**\n\t * @emits 'changeBrand' {values: Array<any>}\n\t */\n\n\tprops: {\n\t\tbrands: [Array, String],\n\t\toptions: Object,\n\t\teditable: Boolean,\n\t\thasError: Boolean,\n\t\tselectorId: String,\n\t},\n\tdata()\n\t{\n\t\treturn {\n\t\t\tcache: new Cache.MemoryCache(),\n\t\t}\n\t},\n\tcreated()\n\t{\n\t\tif (this.editable)\n\t\t{\n\t\t\tthis.selector = new TagSelector({\n\t\t\t\tid: this.selectorId,\n\t\t\t\tdialogOptions: {\n\t\t\t\t\tid: this.selectorId,\n\t\t\t\t\tcontext: 'CATALOG_BRANDS',\n\t\t\t\t\t// enableSearch: true,\n\t\t\t\t\tpreselectedItems: this.getPreselectedBrands(),\n\t\t\t\t\tevents: {\n\t\t\t\t\t\t'Item:onSelect': this.onBrandChange.bind(this),\n\t\t\t\t\t\t'Item:onDeselect': this.onBrandChange.bind(this),\n\t\t\t\t\t\t'Search:onItemCreateAsync': this.createBrand.bind(this)\n\t\t\t\t\t},\n\t\t\t\t\tsearchTabOptions: {\n\t\t\t\t\t\tstub: true,\n\t\t\t\t\t\tstubOptions: {\n\t\t\t\t\t\t\ttitle: Tag.message`${'CATALOG_FORM_BRAND_SELECTOR_IS_EMPTY_TITLE'}`,\n\t\t\t\t\t\t\tsubtitle: Tag.message`${'CATALOG_FORM_BRAND_SELECTOR_IS_EMPTY_SUBTITLE'}`,\n\t\t\t\t\t\t\tarrow: true\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tsearchOptions: {\n\t\t\t\t\t\tallowCreateItem: true\n\t\t\t\t\t},\n\t\t\t\t\tentities: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tid: 'brand',\n\t\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\t\tiblockId: this.options.iblockId,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tdynamicSearch: true,\n\t\t\t\t\t\t\tdynamicLoad: true\n\t\t\t\t\t\t},\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t});\n\t\t\tthis.isSelectedByProductChange = false;\n\n\t\t\tthis.$parent.$on('onInlineSelectorProductChange', this.selectCurrentBrands.bind(this));\n\t\t}\n\t},\n\tmounted()\n\t{\n\t\tif (this.editable)\n\t\t{\n\t\t\tthis.selector.renderTo(this.$refs.brandSelectorWrapper);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.brands.forEach((brand, brandIndex, brands) => {\n\t\t\t\tconst separator = (brandIndex < brands.length - 1) ? ',&nbsp;' : '';\n\t\t\t\tthis.$refs.brandSelectorWrapper.appendChild(Tag.render`\n\t\t\t\t\t<span>\n\t\t\t\t\t\t<span\n\t\t\t\t\t\t\tclass=\"catalog-pf-product-input-brand-read-only-item\"\n\t\t\t\t\t\t\tstyle=\"background-image:url('${brand['IMAGE_SRC']}');\"\n\t\t\t\t\t\t></span>\n\t\t\t\t\t\t${brand['NAME'] + separator}\n\t\t\t\t\t</span>\n\t\t\t\t`);\n\t\t\t});\n\t\t}\n\t},\n\tmethods:\n\t{\n\t\tselectCurrentBrands(brands: Array)\n\t\t{\n\t\t\tthis.isSelectedByProductChange = true;\n\t\t\tthis.brands = brands;\n\t\t\tif (this.selector.getDialog().isLoaded())\n\t\t\t{\n\t\t\t\tthis.selector.getDialog().deselectAll();\n\t\t\t\tthis.selectDialogItems();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.selector.getDialog().load();\n\t\t\t\tEventEmitter.subscribe(this.selector.getDialog(), 'onLoad', this.selectDialogItems.bind(this));\n\t\t\t}\n\t\t},\n\t\tselectDialogItems()\n\t\t{\n\t\t\tthis.brands.forEach(brand => {\n\t\t\t\tconst item = this.selector.getDialog().getItem({id: brand['VALUE'], entityId: 'brand'});\n\t\t\t\titem.select();\n\t\t\t});\n\t\t\tthis.isSelectedByProductChange = false;\n\t\t},\n\t\tgetPreselectedBrands()\n\t\t{\n\t\t\tif (!Type.isArray(this.brands) || this.brands.length === 0)\n\t\t\t{\n\t\t\t\treturn [];\n\t\t\t}\n\n\t\t\treturn this.brands.map((item) => {\n\t\t\t\treturn ['brand', item['VALUE']]\n\t\t\t});\n\t\t},\n\t\tonBrandChange(event: BaseEvent)\n\t\t{\n\t\t\tconst items = event.getTarget().getSelectedItems();\n\t\t\tconst resultValues = [];\n\t\t\tif (Type.isArray(items))\n\t\t\t{\n\t\t\t\titems.forEach((item) => {\n\t\t\t\t\tresultValues.push({\n\t\t\t\t\t\t'VALUE': item.getId(),\n\t\t\t\t\t\t'NAME': item.getTitle(),\n\t\t\t\t\t\t'IMAGE_SRC': item.getAvatar(),\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tconst eventData = {\n\t\t\t\tresultValues: resultValues,\n\t\t\t\tisSelectedByProductChange: this.isSelectedByProductChange,\n\t\t\t};\n\n\t\t\tthis.$emit('changeBrand', eventData);\n\t\t},\n\t\tcreateBrand(event): Promise\n\t\t{\n\t\t\tconst {searchQuery} = event.getData();\n\t\t\tconst iblockId = this.options.iblockId;\n\n\t\t\treturn new Promise(\n\t\t\t\t(resolve, reject) => {\n\t\t\t\t\tconst dialog: Dialog = event.getTarget();\n\t\t\t\t\tconst fields = {\n\t\t\t\t\t\tname: searchQuery.getQuery(),\n\t\t\t\t\t\tiblockId,\n\t\t\t\t\t};\n\n\t\t\t\t\tdialog.showLoader();\n\t\t\t\t\tajax.runAction(\n\t\t\t\t\t\t'catalog.productForm.createBrand',\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\tfields\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t)\n\t\t\t\t\t\t.then(response => {\n\t\t\t\t\t\t\tdialog.hideLoader();\n\t\t\t\t\t\t\tconst item = dialog.addItem({\n\t\t\t\t\t\t\t\tid: response.data.id,\n\t\t\t\t\t\t\t\tentityId: 'brand',\n\t\t\t\t\t\t\t\ttitle: searchQuery.getQuery(),\n\t\t\t\t\t\t\t\ttabs: dialog.getRecentTab().getId(),\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\tif (item)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\titem.select();\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tdialog.hide();\n\t\t\t\t\t\t\tresolve();\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.catch(() => reject());\n\t\t\t\t});\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tlocalize()\n\t\t{\n\t\t\treturn Vue.getFilteredPhrases('CATALOG_');\n\t\t},\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"catalog-pf-product-control ui-ctl-w100\" v-bind:class=\"{ 'ui-ctl-danger': hasError }\">\n\t\t\t<div class=\"catalog-pf-product-input-wrapper\" ref=\"brandSelectorWrapper\" :id=\"selectorId\"></div>\n\t\t</div>\n\t`\n});\n","import {Runtime, Text} from 'main.core';\nimport {Vue} from \"ui.vue\";\nimport {config} from \"../../config\";\nimport type {BaseEvent} from \"main.core.events\";\n\nVue.component(config.templateFieldResultSum,\n{\n\t/**\n\t * @emits 'onChangeSum' {sum: number}\n\t */\n\n\tprops: {\n\t\tsum: Number,\n\t\teditable: Boolean,\n\t\toptions: Object,\n\t},\n\tcreated()\n\t{\n\t\tthis.onInputSumHandler = Runtime.debounce(this.onInputSum, 500, this);\n\t},\n\tmethods:\n\t{\n\t\tonInputSum(event: BaseEvent): void\n\t\t{\n\t\t\tif (!this.editable)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tevent.target.value = event.target.value.replace(/[^.,\\d]/g,'');\n\t\t\tif (event.target.value === '')\n\t\t\t{\n\t\t\t\tevent.target.value = 0;\n\t\t\t}\n\t\t\tlet lastSymbol = event.target.value.substr(-1);\n\t\t\tif (lastSymbol === ',')\n\t\t\t{\n\t\t\t\tevent.target.value = event.target.value.replace(',', \".\");\n\t\t\t}\n\t\t\tlet newSum = Text.toNumber(event.target.value);\n\t\t\tif (lastSymbol === '.' || lastSymbol === ',')\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (newSum < 0)\n\t\t\t{\n\t\t\t\tnewSum *= -1;\n\t\t\t}\n\n\t\t\tthis.$emit('onChangeSum', newSum);\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tlocalize()\n\t\t{\n\t\t\treturn Vue.getFilteredPhrases('CATALOG_');\n\t\t},\n\t\tcurrencySymbol()\n\t\t{\n\t\t\treturn this.options.currencySymbol || '';\n\t\t},\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"catalog-pf-product-input-wrapper\">\n\t\t\t<input \ttype=\"text\" \n\t\t\t\t\tclass=\"catalog-pf-product-input catalog-pf-product-input--align-right\"\n\t\t\t\t\t:class=\"{ 'catalog-pf-product-input--disabled': !editable }\"\n\t\t\t\t\t:value=\"sum\"\n\t\t\t\t\t@input=\"onInputSumHandler\"\n\t\t\t\t\t:disabled=\"!editable\"\n\t\t\t>\n\t\t\t<div class=\"catalog-pf-product-input-info\"\n\t\t\t\t :class=\"{ 'catalog-pf-product-input--disabled': !editable }\"\n\t\t\t\t v-html=\"currencySymbol\"\n\t\t\t></div>\n\t\t</div>\n\t`\n});","import {config} from \"../config\";\nimport {Vue} from \"ui.vue\";\nimport {Text, Type, Tag, Loc, Event} from \"main.core\";\nimport {EventEmitter} from \"main.core.events\";\n\nimport \"catalog.product-selector\";\nimport \"ui.common\";\nimport \"ui.alerts\";\nimport \"ui.notification\";\nimport {ProductCalculator, DiscountType} from \"catalog.product-calculator\";\nimport {FormInputCode} from \"../types/form-input-code\";\nimport {FormErrorCode} from \"../types/form-error-code\";\nimport {FormMode} from \"../types/form-mode\";\nimport \"./fields/quantity\";\nimport \"./fields/price\";\nimport \"./fields/discount\";\nimport \"./fields/tax\";\nimport \"./fields/inline-selector\";\nimport \"./fields/brand\";\nimport \"./fields/result-sum\";\nimport {ProductModel} from \"catalog.product-model\";\nimport type {FieldScheme} from \"catalog.product-calculator\";\n\n\nVue.component(config.templateRowName,\n\t{\n\t\t/**\n\t\t * @emits 'changeProduct' {index: number, fields: object}\n\t\t * @emits 'changeRowData' {index: number, fields: object}\n\t\t * @emits 'emitErrorsChange' {index: number, errors: object}\n\t\t * @emits 'refreshBasket'\n\t\t * @emits 'removeItem' {index: number}\n\t\t */\n\n\t\tprops: {\n\t\t\tbasketItem: Object,\n\t\t\tbasketItemIndex: Number,\n\t\t\tbasketLength: Number,\n\t\t\tcountItems: Number,\n\t\t\toptions: Object,\n\t\t\tmode: String,\n\t\t},\n\n\t\tdata()\n\t\t{\n\t\t\treturn {\n\t\t\t\tmodel: null,\n\t\t\t\tcurrencySymbol: null,\n\t\t\t\tproductSelector: null,\n\t\t\t\timageControlId: null,\n\t\t\t\tselectorId: this.basketItem.selectorId,\n\t\t\t\tdefaultMeasure: {\n\t\t\t\t\tname: '',\n\t\t\t\t\tid: null,\n\t\t\t\t},\n\t\t\t\tblocks: {\n\t\t\t\t\tproductSelector: FormInputCode.PRODUCT_SELECTOR,\n\t\t\t\t\tquantity: FormInputCode.QUANTITY,\n\t\t\t\t\tprice: FormInputCode.PRICE,\n\t\t\t\t\tresult: FormInputCode.RESULT,\n\t\t\t\t\tdiscount: FormInputCode.DISCOUNT,\n\t\t\t\t\ttax: FormInputCode.TAX,\n\t\t\t\t\tbrand: FormInputCode.BRAND,\n\t\t\t\t\tmeasure: FormInputCode.MEASURE,\n\t\t\t\t},\n\t\t\t\terrorCodes: {\n\t\t\t\t\temptyProductSelector: FormErrorCode.EMPTY_PRODUCT_SELECTOR,\n\t\t\t\t\temptyImage: FormErrorCode.EMPTY_IMAGE,\n\t\t\t\t\temptyQuantity: FormErrorCode.EMPTY_QUANTITY,\n\t\t\t\t\temptyPrice: FormErrorCode.EMPTY_PRICE,\n\t\t\t\t\temptyBrand: FormErrorCode.EMPTY_BRAND,\n\t\t\t\t}\n\t\t\t};\n\t\t},\n\t\tcreated()\n\t\t{\n\t\t\tthis.currencySymbol = this.options.currencySymbol;\n\n\t\t\tthis.model = this.initModel();\n\t\t\tif (Type.isArray(this.options.measures))\n\t\t\t{\n\t\t\t\tthis.options.measures.map((measure) => {\n\t\t\t\t\tif (measure['IS_DEFAULT'] === 'Y')\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.defaultMeasure.name = measure.SYMBOL;\n\t\t\t\t\t\tthis.defaultMeasure.code = measure.CODE;\n\n\t\t\t\t\t\tif (!this.basketItem.fields.measureName && !this.basketItem.fields.measureCode)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.changeProductFields({\n\t\t\t\t\t\t\t\tmeasureCode: this.defaultMeasure.code,\n\t\t\t\t\t\t\t\tmeasureName: this.defaultMeasure.name\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\tmethods:\n\t\t\t{\n\t\t\t\tprepareModelFields(): {}\n\t\t\t\t{\n\t\t\t\t\tconst defaultFields = this.basketItem.fields;\n\t\t\t\t\tconst defaultPrice = Text.toNumber(defaultFields.price);\n\t\t\t\t\tlet basePrice = defaultFields.basePrice ? defaultFields.basePrice : defaultFields.price;\n\t\t\t\t\tif (!Type.isNil(basePrice))\n\t\t\t\t\t{\n\t\t\t\t\t\tbasePrice = Text.toNumber(basePrice);\n\t\t\t\t\t}\n\t\t\t\t\treturn {\n\t\t\t\t\t\tNAME: this.basketItem.fields?.name || '',\n\t\t\t\t\t\tMODULE: this.basketItem.fields?.module || '',\n\t\t\t\t\t\tPROPERTIES: this.basketItem.fields?.properties || {},\n\t\t\t\t\t\tBRAND: this.basketItem.fields?.brand || {},\n\t\t\t\t\t\tPRODUCT_ID: this.basketItem.fields?.productId,\n\t\t\t\t\t\tID: this.basketItem.fields?.skuId || this.basketItem.fields?.productId,\n\t\t\t\t\t\tSKU_ID: this.basketItem.fields?.skuId,\n\t\t\t\t\t\tQUANTITY: Text.toNumber(defaultFields.quantity),\n\t\t\t\t\t\tBASE_PRICE: basePrice,\n\t\t\t\t\t\tPRICE: defaultPrice,\n\t\t\t\t\t\tPRICE_NETTO: basePrice,\n\t\t\t\t\t\tPRICE_BRUTTO: defaultPrice,\n\t\t\t\t\t\tPRICE_EXCLUSIVE: this.basketItem.fields.priceExclusive || defaultPrice,\n\t\t\t\t\t\tDISCOUNT_TYPE_ID: Text.toNumber(defaultFields.discountType) || DiscountType.PERCENTAGE,\n\t\t\t\t\t\tDISCOUNT_RATE: Text.toNumber(defaultFields.discountRate),\n\t\t\t\t\t\tDISCOUNT_SUM: Text.toNumber(defaultFields.discount),\n\t\t\t\t\t\tTAX_INCLUDED: defaultFields.taxIncluded || this.options.taxIncluded,\n\t\t\t\t\t\tTAX_RATE: defaultFields.tax || 0,\n\t\t\t\t\t\tCUSTOMIZED: defaultFields.isCustomPrice || 'N',\n\t\t\t\t\t\tMEASURE_CODE: defaultFields.measureCode || this.defaultMeasure.code,\n\t\t\t\t\t\tMEASURE_NAME: defaultFields.measureName || this.defaultMeasure.name,\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tinitModel(): ProductModel\n\t\t\t\t{\n\t\t\t\t\tconst productId = Text.toNumber(this.basketItem.fields?.productId);\n\t\t\t\t\tconst skuId = Text.toNumber(this.basketItem.fields?.skuId);\n\t\t\t\t\tconst model = new ProductModel(\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tiblockId: Text.toNumber(this.options.iblockId),\n\t\t\t\t\t\t\tbasePriceId: Text.toNumber(this.options.basePriceId),\n\t\t\t\t\t\t\tcurrency: this.options.currency,\n\t\t\t\t\t\t\tisSimpleModel: (\n\t\t\t\t\t\t\t\tType.isStringFilled(this.basketItem.fields?.name)\n\t\t\t\t\t\t\t\t&& productId <= 0\n\t\t\t\t\t\t\t\t&& skuId <= 0\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\tfields: this.prepareModelFields(),\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\n\t\t\t\t\tEventEmitter.subscribe(model, 'onErrorsChange', this.onErrorsChange);\n\n\t\t\t\t\treturn model;\n\t\t\t\t},\n\t\t\t\tonErrorsChange()\n\t\t\t\t{\n\t\t\t\t\tconst errors = Object.values(this.model.getErrorCollection().getErrors());\n\t\t\t\t\tthis.changeRowData({errors});\n\t\t\t\t\tthis.$emit('emitErrorsChange', {\n\t\t\t\t\t\tindex: this.basketItemIndex,\n\t\t\t\t\t\terrors,\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tsetCalculatedFields(fields: {}): void\n\t\t\t\t{\n\t\t\t\t\tthis.model.getCalculator().setFields(fields);\n\t\t\t\t\tconst map = {calculatedFields: fields};\n\t\t\t\t\tif (Text.toNumber(fields.SUM) >= 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tmap.sum = Text.toNumber(fields.SUM);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!Type.isNil(fields.ID))\n\t\t\t\t\t{\n\t\t\t\t\t\tmap.offerId = Text.toNumber(fields.ID);\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.changeRowData(map);\n\t\t\t\t},\n\t\t\t\tgetProductFieldsFromModel()\n\t\t\t\t{\n\t\t\t\t\tconst modelFields = this.model.getFields();\n\t\t\t\t\treturn {\n\t\t\t\t\t\tproductId: modelFields.PRODUCT_ID,\n\t\t\t\t\t\tskuId: modelFields.SKU_ID,\n\t\t\t\t\t\tname: modelFields.NAME,\n\t\t\t\t\t\tmodule: modelFields.MODULE,\n\t\t\t\t\t\tbasePrice: modelFields.BASE_PRICE,\n\t\t\t\t\t\tprice: modelFields.PRICE,\n\t\t\t\t\t\tpriceExclusive: modelFields.PRICE_EXCLUSIVE,\n\t\t\t\t\t\tquantity: modelFields.QUANTITY,\n\t\t\t\t\t\tdiscountRate: modelFields.DISCOUNT_RATE,\n\t\t\t\t\t\tdiscount: modelFields.DISCOUNT_SUM,\n\t\t\t\t\t\tdiscountType: modelFields.DISCOUNT_TYPE_ID,\n\t\t\t\t\t\tisCustomPrice: modelFields.CUSTOMIZED || 'N',\n\t\t\t\t\t\tmeasureCode: modelFields.MEASURE_CODE || '',\n\t\t\t\t\t\tmeasureName: modelFields.MEASURE_NAME || '',\n\t\t\t\t\t\tproperties: modelFields.PROPERTIES || {},\n\t\t\t\t\t\tbrands: modelFields.BRANDS || [],\n\t\t\t\t\t\ttaxId: modelFields.TAX_ID,\n\t\t\t\t\t\tmorePhoto: modelFields.MORE_PHOTO,\n\t\t\t\t\t};\n\t\t\t\t},\n\t\t\t\tchangeRowData(product: {}): void\n\t\t\t\t{\n\t\t\t\t\tthis.$emit('changeRowData', {\n\t\t\t\t\t\tindex: this.basketItemIndex,\n\t\t\t\t\t\tproduct\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tchangeProductFields(fields: {}): void\n\t\t\t\t{\n\t\t\t\t\tfields = Object.assign(this.basketItem.fields, fields);\n\t\t\t\t\tthis.$emit('changeProduct', {\n\t\t\t\t\t\tindex: this.basketItemIndex,\n\t\t\t\t\t\tproduct: {fields},\n\t\t\t\t\t\tskipFieldChecking: this.model.isSimple() && this.basketLength === 1,\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tsaveCatalogField(changedFields: []): ?Promise\n\t\t\t\t{\n\t\t\t\t\treturn this.model.save(changedFields);\n\t\t\t\t},\n\t\t\t\tonProductChange(fields: {})\n\t\t\t\t{\n\t\t\t\t\tfields = Object.assign(\n\t\t\t\t\t\tthis.model.getCalculator().calculateBasePrice(fields.BASE_PRICE),\n\t\t\t\t\t\tfields\n\t\t\t\t\t);\n\n\t\t\t\t\tthis.changeRowData(\n\t\t\t\t\t\t{catalogPrice: fields.BASE_PRICE}\n\t\t\t\t\t);\n\t\t\t\t\tthis.processFields(fields);\n\t\t\t\t\tthis.setCalculatedFields(fields);\n\t\t\t\t\tthis.$emit('onInlineSelectorProductChange', this.basketItem.fields.brands);\n\t\t\t\t},\n\t\t\t\tonProductSelect()\n\t\t\t\t{\n\t\t\t\t\tthis.changeProductFields({\n\t\t\t\t\t\tadditionalFields: {\n\t\t\t\t\t\t\toriginBasketId: '',\n\t\t\t\t\t\t\toriginProductId: '',\n\t\t\t\t\t\t},\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tonProductClear()\n\t\t\t\t{\n\t\t\t\t\tif (Type.isPlainObject(this.options.facebookFailProducts))\n\t\t\t\t\t{\n\t\t\t\t\t\tdelete this.options.facebookFailProducts[this.basketItem.offerId];\n\t\t\t\t\t}\n\t\t\t\t\t/*const fields = this.model.getCalculator().calculatePrice(0);\n\n\t\t\t\t\tfields.BASE_PRICE = 0;\n\t\t\t\t\tfields.NAME = '';\n\t\t\t\t\tfields.ID = 0;\n\t\t\t\t\tfields.PRODUCT_ID = 0;\n\t\t\t\t\tfields.SKU_ID = 0;\n\t\t\t\t\tfields.MODULE = '';\n\n\t\t\t\t\tthis.setCalculatedFields(fields);*/\n\t\t\t\t},\n\t\t\t\tonChangeSum(sum: number)\n\t\t\t\t{\n\t\t\t\t\tconst price = (sum / Text.toNumber(this.basketItem.fields.quantity)) + Text.toNumber(this.basketItem.fields.discount);\n\t\t\t\t\tthis.onChangePrice(price);\n\t\t\t\t},\n\t\t\t\tonChangePrice(newPrice)\n\t\t\t\t{\n\t\t\t\t\tif (!this.options.isCatalogPriceSaveEnabled)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.changeBasePrice(newPrice);\n\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.model.showSaveNotifier(\n\t\t\t\t\t\t'priceChanger_' + this.selectorId,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttitle: Loc.getMessage('CATALOG_PRODUCT_MODEL_SAVING_NOTIFICATION_PRICE_CHANGED_QUERY'),\n\t\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\t\tonCancel: () => {\n\t\t\t\t\t\t\t\t\tconst calculatorFields = this.changePrice(newPrice);\n\t\t\t\t\t\t\t\t\tif (calculatorFields.DISCOUNT_SUM > 0)\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tthis.toggleDiscount('Y');\n\t\t\t\t\t\t\t\t\t\tthis.$root.$app.changeFormOption('showDiscountBlock', 'Y');\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tonSave: () => {\n\t\t\t\t\t\t\t\t\tthis.changeBasePrice(newPrice);\n\t\t\t\t\t\t\t\t\tthis.saveCatalogField(['BASE_PRICE']).then(()=>{\n\t\t\t\t\t\t\t\t\t\tthis.changeRowData(\n\t\t\t\t\t\t\t\t\t\t\t{catalogPrice: newPrice}\n\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t},\n\t\t\t\tonSelectMeasure(measure: {})\n\t\t\t\t{\n\t\t\t\t\tthis.changeMeasure(measure);\n\t\t\t\t\tthis.model.showSaveNotifier(\n\t\t\t\t\t\t'measureChanger_' + this.selectorId,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttitle: Loc.getMessage('CATALOG_PRODUCT_MODEL_SAVING_NOTIFICATION_MEASURE_CHANGED_QUERY'),\n\t\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\t\tonSave: () => {\n\t\t\t\t\t\t\t\t\tthis.saveCatalogField(['MEASURE_CODE', 'MEASURE_NAME']);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t},\n\t\t\t\ttoggleDiscount(value: string): void\n\t\t\t\t{\n\t\t\t\t\tif (this.isReadOnly)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.changeRowData(\n\t\t\t\t\t\t{showDiscount: value}\n\t\t\t\t\t);\n\n\t\t\t\t\tif (value === 'Y')\n\t\t\t\t\t{\n\t\t\t\t\t\tsetTimeout(\n\t\t\t\t\t\t\t() => this.$refs?.discountWrapper?.$refs?.discountInput?.focus()\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\ttoggleTax(value: string): void\n\t\t\t\t{\n\t\t\t\t\tthis.changeRowData(\n\t\t\t\t\t\t{showTax: value}\n\t\t\t\t\t);\n\t\t\t\t},\n\t\t\t\tprocessFields(fields: {}): void\n\t\t\t\t{\n\t\t\t\t\tthis.model.getCalculator().setFields(fields);\n\t\t\t\t\tthis.model.setFields(fields);\n\t\t\t\t\tthis.changeProductFields({...this.basketItem.fields, ...this.getProductFieldsFromModel()});\n\n\t\t\t\t\tif (!Type.isNil(fields.SUM))\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.changeRowData({sum: fields.SUM});\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tchangeBrand(eventData): void\n\t\t\t\t{\n\t\t\t\t\tconst brands = Type.isArray(eventData.resultValues) ? eventData.resultValues : [];\n\t\t\t\t\tconst isSelectedByProductChange = eventData.isSelectedByProductChange;\n\t\t\t\t\tthis.processFields({ BRANDS: brands });\n\n\t\t\t\t\tif (!isSelectedByProductChange)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.saveCatalogField(['BRANDS']);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tonChangeQuantity(quantity: number): void\n\t\t\t\t{\n\t\t\t\t\tthis.model.getCalculator().setFields();\n\t\t\t\t\tthis.processFields(\n\t\t\t\t\t\tthis.model.getCalculator().calculateQuantity(quantity)\n\t\t\t\t\t);\n\t\t\t\t},\n\t\t\t\tchangeMeasure(measure: {}): void\n\t\t\t\t{\n\t\t\t\t\tconst productFields = this.basketItem.fields;\n\t\t\t\t\tproductFields['measureCode'] = measure.code;\n\t\t\t\t\tproductFields['measureName'] = measure.name;\n\t\t\t\t\tthis.processFields({\n\t\t\t\t\t\tMEASURE_CODE: measure.code,\n\t\t\t\t\t\tMEASURE_NAME: measure.name,\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tchangeBasePrice(price: number): void\n\t\t\t\t{\n\t\t\t\t\tthis.model.setField('BASE_PRICE', price);\n\t\t\t\t\tthis.processFields(\n\t\t\t\t\t\tthis.model.getCalculator().calculateBasePrice(price)\n\t\t\t\t\t);\n\t\t\t\t},\n\t\t\t\tchangePrice(price: number): FieldScheme\n\t\t\t\t{\n\t\t\t\t\tthis.model.getCalculator().setFields(\n\t\t\t\t\t\tthis.model.getCalculator().calculateBasePrice(this.basketItem.catalogPrice)\n\t\t\t\t\t);\n\t\t\t\t\tconst calculatedFields = this.model.getCalculator().calculatePrice(price);\n\t\t\t\t\tthis.processFields(calculatedFields);\n\t\t\t\t\treturn calculatedFields;\n\t\t\t\t},\n\t\t\t\tchangeDiscountType(discountType: string): FieldScheme\n\t\t\t\t{\n\t\t\t\t\tconst type = (Text.toNumber(discountType) === DiscountType.MONETARY) ?  DiscountType.MONETARY : DiscountType.PERCENTAGE;\n\t\t\t\t\tconst calculatedFields = this.model.getCalculator().calculateDiscountType(type);\n\t\t\t\t\tthis.processFields(calculatedFields);\n\t\t\t\t\treturn calculatedFields;\n\t\t\t\t},\n\t\t\t\tchangeDiscount(discount: number): FieldScheme\n\t\t\t\t{\n\t\t\t\t\tconst calculatedFields = this.model.getCalculator().calculateDiscount(discount);\n\t\t\t\t\tthis.processFields(calculatedFields);\n\t\t\t\t\treturn  calculatedFields;\n\t\t\t\t},\n\t\t\t\tchangeTax(fields)\n\t\t\t\t{\n\t\t\t\t\tconst calculatedFields = this.model.getCalculator().calculateTax(fields.taxValue);\n\t\t\t\t\tcalculatedFields.TAX_ID = fields.taxId;\n\t\t\t\t\tthis.processFields(calculatedFields)\n\t\t\t\t\treturn  calculatedFields;\n\t\t\t\t},\n\t\t\t\tchangeTaxIncluded(taxIncluded)\n\t\t\t\t{\n\t\t\t\t\tif (taxIncluded === this.basketItem.taxIncluded || !this.isEditableField(this.blocks.tax))\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst calculatedFields = this.model.getCalculator().calculateTaxIncluded(taxIncluded);\n\t\t\t\t\tthis.processFields(calculatedFields)\n\t\t\t\t\treturn  calculatedFields;\n\t\t\t\t},\n\t\t\t\tremoveItem()\n\t\t\t\t{\n\t\t\t\t\tif (Type.isPlainObject(this.options.facebookFailProducts))\n\t\t\t\t\t{\n\t\t\t\t\t\tdelete this.options.facebookFailProducts[this.basketItem.offerId];\n\t\t\t\t\t}\n\t\t\t\t\tthis.$emit('removeItem', {\n\t\t\t\t\t\tindex: this.basketItemIndex\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tisRequiredField(code: string): boolean\n\t\t\t\t{\n\t\t\t\t\treturn Type.isArray(this.options.requiredFields) && this.options.requiredFields.includes(code);\n\t\t\t\t},\n\t\t\t\tisVisibleBlock(code): boolean\n\t\t\t\t{\n\t\t\t\t\treturn Type.isArray(this.options.visibleBlocks) && this.options.visibleBlocks.includes(code)\n\t\t\t\t},\n\t\t\t\tgetPriceValue()\n\t\t\t\t{\n\t\t\t\t\treturn this.isEditableField(this.blocks.price)\n\t\t\t\t\t\t? this.basketItem.fields.basePrice\n\t\t\t\t\t\t: this.basketItem.catalogPrice\n\t\t\t\t\t;\n\t\t\t\t},\n\t\t\t\tgetQuantityValue()\n\t\t\t\t{\n\t\t\t\t\treturn this.isEditableField(this.blocks.quantity)\n\t\t\t\t\t\t? this.basketItem.fields.quantity\n\t\t\t\t\t\t: 1\n\t\t\t\t\t;\n\t\t\t\t},\n\t\t\t\tgetSumValue()\n\t\t\t\t{\n\t\t\t\t\treturn this.isEditableField(this.blocks.result)\n\t\t\t\t\t\t? this.basketItem.sum\n\t\t\t\t\t\t: this.basketItem.catalogPrice\n\t\t\t\t\t;\n\t\t\t\t},\n\t\t\t\tgetDiscountValue()\n\t\t\t\t{\n\t\t\t\t\treturn this.isEditableField(this.blocks.discount)\n\t\t\t\t\t\t? this.basketItem.fields.discount\n\t\t\t\t\t\t: 0\n\t\t\t\t\t;\n\t\t\t\t},\n\t\t\t\tgetDiscountRateValue()\n\t\t\t\t{\n\t\t\t\t\treturn this.isEditableField(this.blocks.discount)\n\t\t\t\t\t\t? this.basketItem.fields.discountRate\n\t\t\t\t\t\t: 0\n\t\t\t\t\t;\n\t\t\t\t},\n\t\t\t\thasError(code): boolean\n\t\t\t\t{\n\t\t\t\t\tif (this.basketItem.errors.length === 0 || (this.model.isEmpty() && !this.model.isChanged()))\n\t\t\t\t\t{\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst filteredErrors = this.basketItem.errors.filter((error) => {\n\t\t\t\t\t\treturn error.code === code\n\t\t\t\t\t});\n\n\t\t\t\t\treturn filteredErrors.length > 0;\n\t\t\t\t},\n\t\t\t\tisEditablePrice(): boolean\n\t\t\t\t{\n\t\t\t\t\treturn this.options?.editableFields.includes(FormInputCode.PRICE)\n\t\t\t\t\t\t&& (\n\t\t\t\t\t\t\tthis.model.isNew()\n\t\t\t\t\t\t\t|| !this.model.isCatalogExisted()\n\t\t\t\t\t\t\t|| this.options?.isCatalogPriceEditEnabled\n\t\t\t\t\t\t)\n\t\t\t\t\t;\n\t\t\t\t},\n\t\t\t\tisEditableField(code): boolean\n\t\t\t\t{\n\t\t\t\t\tif (code === FormInputCode.PRICE && !this.options?.isCatalogPriceEditEnabled)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn this.isEditablePrice();\n\t\t\t\t\t}\n\n\t\t\t\t\treturn this.options?.editableFields.includes(code);\n\t\t\t\t},\n\t\t\t\tgetHint(code): ?{}\n\t\t\t\t{\n\t\t\t\t\treturn this.options?.fieldHints[code];\n\t\t\t\t},\n\t\t\t\thasHint(code): boolean\n\t\t\t\t{\n\t\t\t\t\tif (code === FormInputCode.PRICE && !this.options?.isCatalogPriceEditEnabled)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn !this.isEditablePrice();\n\t\t\t\t\t}\n\n\t\t\t\t\treturn false;\n\t\t\t\t},\n\t\t\t\tshowPriceNotify()\n\t\t\t\t{\n\t\t\t\t\tconst hint = this.getHint(this.blocks.price);\n\t\t\t\t\tif (Text.toNumber(hint?.ARTICLE_CODE) > 0)\n\t\t\t\t\t{\n\t\t\t\t\t\ttop.BX.Helper.show(\"redirect=detail&code=\" + Text.toNumber(hint?.ARTICLE_CODE));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\twatch:\n\t\t\t{\n\t\t\t\ttaxIncluded(value, oldValue){\n\t\t\t\t\tif (value !== oldValue)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.changeTaxIncluded(value);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\tcomputed:\n\t\t\t{\n\t\t\t\tlocalize()\n\t\t\t\t{\n\t\t\t\t\treturn Vue.getFilteredPhrases('CATALOG_FORM_');\n\t\t\t\t},\n\t\t\t\tshowDiscount(): boolean\n\t\t\t\t{\n\t\t\t\t\treturn this.showDiscountBlock && this.basketItem.showDiscount === 'Y';\n\t\t\t\t},\n\t\t\t\tgetBrandsSelectorId(): string\n\t\t\t\t{\n\t\t\t\t\treturn this.basketItem.selectorId + '_brands';\n\t\t\t\t},\n\t\t\t\tgetPriceExclusive(): ?number\n\t\t\t\t{\n\t\t\t\t\treturn this.basketItem.fields.priceExclusive || this.basketItem.fields.price\n\t\t\t\t},\n\t\t\t\tshowDiscountBlock(): boolean\n\t\t\t\t{\n\t\t\t\t\treturn this.options.showDiscountBlock === 'Y'\n\t\t\t\t\t\t&& this.isVisibleBlock(this.blocks.discount)\n\t\t\t\t\t\t&& !this.isReadOnly\n\t\t\t\t\t;\n\t\t\t\t},\n\t\t\t\tshowTaxBlock(): boolean\n\t\t\t\t{\n\t\t\t\t\treturn this.options.showTaxBlock === 'Y'\n\t\t\t\t\t\t&& this.getTaxList.length > 0\n\t\t\t\t\t\t&& this.isVisibleBlock(this.blocks.tax)\n\t\t\t\t\t\t&& !this.isReadOnly\n\t\t\t\t\t;\n\t\t\t\t},\n\t\t\t\tshowRemoveIcon(): boolean\n\t\t\t\t{\n\t\t\t\t\tif (this.isReadOnly)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (this.countItems > 1)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn !Type.isNil(this.basketItem.offerId);\n\t\t\t\t},\n\t\t\t\tshowTaxSelector(): boolean\n\t\t\t\t{\n\t\t\t\t\treturn this.basketItem.showTax === 'Y';\n\t\t\t\t},\n\t\t\t\tshowBasePrice(): boolean\n\t\t\t\t{\n\t\t\t\t\treturn this.basketItem.fields.discount > 0\n\t\t\t\t\t\t|| (Text.toNumber(this.basketItem.fields.price) !== Text.toNumber(this.basketItem.fields.basePrice))\n\t\t\t\t\t;\n\t\t\t\t},\n\t\t\t\tgetMeasureName(): string\n\t\t\t\t{\n\t\t\t\t\treturn this.basketItem.fields.measureName || this.defaultMeasure.name;\n\t\t\t\t},\n\t\t\t\tgetMeasureCode(): string\n\t\t\t\t{\n\t\t\t\t\treturn this.basketItem.fields.measureCode || this.defaultMeasure.code;\n\t\t\t\t},\n\t\t\t\tgetTaxList(): []\n\t\t\t\t{\n\t\t\t\t\treturn Type.isArray(this.options.taxList) ? this.options.taxList : [];\n\t\t\t\t},\n\t\t\t\ttaxIncluded(): string\n\t\t\t\t{\n\t\t\t\t\treturn this.basketItem.fields.taxIncluded;\n\t\t\t\t},\n\t\t\t\tisTaxIncluded(): boolean\n\t\t\t\t{\n\t\t\t\t\treturn this.taxIncluded === 'Y';\n\t\t\t\t},\n\t\t\t\tisReadOnly(): boolean\n\t\t\t\t{\n\t\t\t\t\treturn this.mode === FormMode.READ_ONLY\n\t\t\t\t},\n\t\t\t\tgetErrorsText(): string\n\t\t\t\t{\n\t\t\t\t\tlet errorText = this.basketItem.errors.length !== 0 && !this.model.isEmpty() && this.model.isChanged()\n\t\t\t\t\t\t? Loc.getMessage('CATALOG_PRODUCT_MODEL_ERROR_NOTIFICATION')\n\t\t\t\t\t\t: ''\n\t\t\t\t\t;\n\t\t\t\t\tconst basketItemOfferId = this.basketItem.offerId;\n\t\t\t\t\tconst facebookFailProducts = this.options.facebookFailProducts;\n\t\t\t\t\tconst facebookFailProductErrorText = Type.isObject(facebookFailProducts)\n\t\t\t\t\t\t? facebookFailProducts[basketItemOfferId]\n\t\t\t\t\t\t: null\n\t\t\t\t\t;\n\n\t\t\t\t\tif (facebookFailProductErrorText)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (errorText)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\terrorText += '<br>';\n\t\t\t\t\t\t}\n\t\t\t\t\t\terrorText +=\n\t\t\t\t\t\t\tLoc.getMessage('CATALOG_FORM_FACEBOOK_ERROR')\n\t\t\t\t\t\t\t+ ':<br>'\n\t\t\t\t\t\t\t+ facebookFailProductErrorText\n\t\t\t\t\t\t;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn errorText;\n\t\t\t\t},\n\t\t\t\thasSku()\n\t\t\t\t{\n\t\t\t\t\treturn this.basketItem.skuTree !== '';\n\t\t\t\t},\n\t\t\t},\n\t\t// language=Vue\n\t\ttemplate: `\n\t\t<div>\n\t\t\t<div class=\"catalog-pf-product-item\" v-bind:class=\"{ 'catalog-pf-product-item--borderless': !isReadOnly && basketItemIndex === 0 }\">\n\t\t\t\t<div class=\"catalog-pf-product-item--remove\" @click=\"removeItem\" v-if=\"showRemoveIcon\"></div>\n\t\t\t\t<div class=\"catalog-pf-product-item--num\">\n\t\t\t\t\t<div class=\"catalog-pf-product-index\">{{basketItemIndex + 1}}</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"catalog-pf-product-item--left\">\n\t\t\t\t\t<div v-if=\"isVisibleBlock(blocks.productSelector)\">\n\t\t\t\t\t\t<div v-if=\"!this.isReadOnly\" class=\"catalog-pf-product-item-section\">\n\t\t\t\t\t\t\t<div class=\"catalog-pf-product-label\">{{localize.CATALOG_FORM_NAME}}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<${config.templateFieldInlineSelector}\n\t\t\t\t\t\t\t:basketItem=\"basketItem\"\n\t\t\t\t\t\t\t:basketLength=\"basketLength\"\n\t\t\t\t\t\t\t:options=\"options\"\n\t\t\t\t\t\t\t:model=\"model\"\n\t\t\t\t\t\t\t:editable=\"isEditableField(blocks.productSelector)\"\n\t\t\t\t\t\t\t@onProductChange=\"onProductChange\"\n\t\t\t\t\t\t\t@onProductSelect=\"onProductSelect\"\n\t\t\t\t\t\t\t@onProductClear=\"onProductClear\"\n\t\t\t\t\t\t\t@saveCatalogField=\"saveCatalogField\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div\n\t\t\t\t\t\tv-if=\"isVisibleBlock(blocks.brand)\"\n\t\t\t\t\t\tclass=\"catalog-pf-product-input-brand-wrapper\"\n\t\t\t\t\t\tv-bind:class=\"[\n\t\t\t\t\t\t\t{ 'catalog-pf-product-input-brand-wrapper-readonly': this.isReadOnly},\n\t\t\t\t\t\t\t{ 'catalog-pf-product-input-brand-wrapper-readonly-no-sku': this.isReadOnly && !this.hasSku}\n\t\t\t\t\t\t]\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<div class=\"catalog-pf-product-item-section\">\n\t\t\t\t\t\t\t<div class=\"catalog-pf-product-label\">{{localize.CATALOG_FORM_BRAND_TITLE}}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<${config.templateFieldBrand}\n\t\t\t\t\t\t\t:brands=\"basketItem.fields.brands\"\n\t\t\t\t\t\t\t:selectorId=\"getBrandsSelectorId\"\n\t\t\t\t\t\t\t:hasError=\"hasError(errorCodes.emptyBrand)\"\n\t\t\t\t\t\t\t:options=\"options\"\n\t\t\t\t\t\t\t:editable=\"isEditableField(blocks.brand)\"\n\t\t\t\t\t\t\t@changeBrand=\"changeBrand\"\n\t\t\t\t\t\t\t@saveCatalogField=\"saveCatalogField\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<div v-if=\"hasError(errorCodes.emptyBrand)\" class=\"catalog-pf-product-item-section\">\n\t\t\t\t\t\t\t<div class=\"catalog-product-error\">{{localize.CATALOG_FORM_ERROR_EMPTY_BRAND_1}}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\n\t\t\t\t</div>\n\t\t\t\t<div class=\"catalog-pf-product-item--right\">\n\t\t\t\t\t<div class=\"catalog-pf-product-item-section\">\n\t\t\t\t\t\t<div v-if=\"isVisibleBlock(blocks.price)\" class=\"catalog-pf-product-label\" style=\"width: 94px\">\n\t\t\t\t\t\t\t{{localize.CATALOG_FORM_PRICE}}\n\t\t\t\t\t\t\t<span v-if=\"hasHint(blocks.price)\" class=\"ui-hint-icon\" @click=\"showPriceNotify\"></span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div v-if=\"isVisibleBlock(blocks.quantity)\" class=\"catalog-pf-product-label\" style=\"width: 72px\">\n\t\t\t\t\t\t\t{{localize.CATALOG_FORM_QUANTITY}}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div v-if=\"isVisibleBlock(blocks.result)\" class=\"catalog-pf-product-label\" style=\"width: 94px\">\n\t\t\t\t\t\t\t{{localize.CATALOG_FORM_RESULT}}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"catalog-pf-product-item-section\">\n\t\n\t\t\t\t\t\t<div v-if=\"isVisibleBlock(blocks.price)\" class=\"catalog-pf-product-control\" style=\"width: 94px\">\n\t\t\t\t\t\t\t<${config.templateFieldPrice}\n\t\t\t\t\t\t\t\t:selectorId=\"basketItem.selectorId\"\n\t\t\t\t\t\t\t\t:price=\"getPriceValue()\"\n\t\t\t\t\t\t\t\t:options=\"options\"\n\t\t\t\t\t\t\t\t:editable=\"isEditableField(blocks.price)\"\n\t\t\t\t\t\t\t\t:hasError=\"hasError(errorCodes.emptyPrice)\"\n\t\t\t\t\t\t\t\t@onChangePrice=\"onChangePrice\"\n\t\t\t\t\t\t\t\t@saveCatalogField=\"saveCatalogField\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\n\t\t\t\t\t\t<div v-if=\"isVisibleBlock(blocks.quantity)\" class=\"catalog-pf-product-control\" style=\"width: 72px\">\n\t\t\t\t\t\t\t<${config.templateFieldQuantity}\n\t\t\t\t\t\t\t\t:quantity=\"getQuantityValue()\"\n\t\t\t\t\t\t\t\t:measureCode=\"getMeasureCode\"\n\t\t\t\t\t\t\t\t:measureRatio=\"basketItem.fields.measureRatio\"\n\t\t\t\t\t\t\t\t:measureName=\"getMeasureName\"\n\t\t\t\t\t\t\t\t:hasError=\"hasError(errorCodes.emptyQuantity)\"\n\t\t\t\t\t\t\t\t:options=\"options\"\n\t\t\t\t\t\t\t\t:editable=\"isEditableField(blocks.quantity)\"\n\t\t\t\t\t\t\t\t@onChangeQuantity=\"onChangeQuantity\"\n\t\t\t\t\t\t\t\t@onSelectMeasure=\"onSelectMeasure\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\n\t\t\t\t\t\t<div v-if=\"isVisibleBlock(blocks.result)\" class=\"catalog-pf-product-control\" style=\"width: 94px\">\n\t\t\t\t\t\t\t<${config.templateFieldResultSum}\n\t\t\t\t\t\t\t\t\t:sum=\"getSumValue()\"\n\t\t\t\t\t\t\t\t\t:options=\"options\"\n\t\t\t\t\t\t\t\t\t:editable=\"isEditableField(blocks.result)\"\n\t\t\t\t\t\t\t\t\t@onChangeSum=\"onChangeSum\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div v-if=\"hasError(errorCodes.emptyQuantity)\" class=\"catalog-pf-product-item-section\">\n\t\t\t\t\t\t<div class=\"catalog-product-error\">{{localize.CATALOG_FORM_ERROR_EMPTY_QUANTITY_1}}</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div v-if=\"hasError(errorCodes.emptyPrice)\" class=\"catalog-pf-product-item-section\">\n\t\t\t\t\t\t<div v-if=\"isEditableField(blocks.price)\" class=\"catalog-product-error\">{{localize.CATALOG_FORM_ERROR_EMPTY_PRICE_1}}</div>\n\t\t\t\t\t\t<div v-else class=\"catalog-product-error\">{{localize.CATALOG_FORM_ERROR_EMPTY_PRICE_FILL_IN_CARD}}</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div v-if=\"showDiscountBlock\" class=\"catalog-pf-product-item-section\">\n\t\t\t\t\t\t<div v-if=\"showDiscount\" class=\"catalog-pf-product-link-toggler catalog-pf-product-link-toggler--hide\" @click=\"toggleDiscount('N')\">{{localize.CATALOG_FORM_DISCOUNT_TITLE}}</div>\n\t\t\t\t\t\t<div v-else class=\"catalog-pf-product-link-toggler catalog-pf-product-link-toggler--show\" @click=\"toggleDiscount('Y')\">{{localize.CATALOG_FORM_DISCOUNT_TITLE}}</div>\n\t\t\t\t\t</div>\n\t\n\t\t\t\t\t<div v-if=\"showDiscount\" class=\"catalog-pf-product-item-section\">\n\t\t\t\t\t\t<${config.templateFieldDiscount}\n\t\t\t\t\t\t\t:discount=\"getDiscountValue()\"\n\t\t\t\t\t\t\t:discountType=\"basketItem.fields.discountType\"\n\t\t\t\t\t\t\t:discountRate=\"getDiscountRateValue()\"\n\t\t\t\t\t\t\t:options=\"options\"\n\t\t\t\t\t\t\t:editable=\"isEditableField(blocks.discount)\"\n\t\t\t\t\t\t\tref=\"discountWrapper\"\n\t\t\t\t\t\t\t@changeDiscount=\"changeDiscount\"\n\t\t\t\t\t\t\t@changeDiscountType=\"changeDiscountType\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\n\t\t\t\t\t<div v-if=\"showTaxBlock\" class=\"catalog-pf-product-item-section catalog-pf-product-item-section--dashed\">\n\t\t\t\t\t\t<div v-if=\"showTaxSelector\" class=\"catalog-pf-product-link-toggler catalog-pf-product-link-toggler--hide\" @click=\"toggleTax('N')\">{{localize.CATALOG_FORM_TAX_TITLE}}</div>\n\t\t\t\t\t\t<div v-else class=\"catalog-pf-product-link-toggler catalog-pf-product-link-toggler--show\" @click=\"toggleTax('Y')\">{{localize.CATALOG_FORM_TAX_TITLE}}</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div v-if=\"showTaxSelector && showTaxBlock\" class=\"catalog-pf-product-item-section\">\n\t\t\t\t\t\t<${config.templateFieldTax}\n\t\t\t\t\t\t\t:taxId=\"basketItem.fields.taxId\"\n\t\t\t\t\t\t\t:options=\"options\"\n\t\t\t\t\t\t\t:editable=\"isEditableField(blocks.tax)\"\n\t\t\t\t\t\t\t@changeProduct=\"changeProduct\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"catalog-pf-product-item-section catalog-pf-product-item-section--dashed\"></div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"catalog-pf-product-item\">\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div>\n\t\t\t\t<div class=\"catalog-product-error\" v-html=\"getErrorsText\"></div>\n\t\t\t</div>\n\t\t</div>\n\t`\n\t});\n","export class FormCompilationType\n{\n\tstatic REGULAR: string = 'REGULAR';\n\tstatic FACEBOOK: string = 'FACEBOOK';\n}","export class FormHelpdeskCode\n{\n\tstatic COMPILATION_FACEBOOK: number = 13856526;\n\tstatic COMMON_COMPILATION: number = 13841876;\n}","import {Vuex} from 'ui.vue.vuex';\nimport {Vue} from 'ui.vue';\nimport {config} from '../../config';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\nimport {Popup} from 'main.popup';\nimport {FormMode} from '../../types/form-mode';\nimport {FormCompilationType} from '../../types/form-compilation-type';\nimport {FormHelpdeskCode} from '../../types/form-helpdesk-code';\nimport {ajax, Event, Tag, Dom, Loc, Type} from 'main.core';\nimport {Loader} from 'main.loader';\nimport {Label, LabelColor} from 'ui.label';\nimport {MessageCard} from 'ui.messagecard';\nimport 'ui.vue.components.hint';\nimport 'ui.notification';\nimport 'ui.info-helper';\nimport 'main.qrcode';\nimport 'clipboard';\nimport 'helper';\n\nVue.component(config.templatePanelCompilation,\n{\n\tprops: {\n\t\tcompilationOptions: Object,\n\t\tmode: String,\n\t},\n\tcreated()\n\t{\n\t\tthis.newLabel = new Label({\n\t\t\ttext: this.localize.CATALOG_FORM_COMPILATION_PRODUCT_NEW_LABEL,\n\t\t\tcolor: LabelColor.PRIMARY,\n\t\t\tfill: true\n\t\t});\n\t\tthis.popup = null;\n\t\tthis.compilationLink = null;\n\n\t\tconst moreMessageButton = Tag.render`\n\t\t\t<a class=\"ui-btn ui-btn-primary\">${this.localize.CATALOG_FORM_COMPILATION_INFO_BUTTON_MORE}</a>\n\t\t`;\n\n\t\tEvent.bind(moreMessageButton, 'click', this.openHelpDesk);\n\n\t\tlet header = '';\n\t\tlet description = '';\n\t\tif (this.isFacebookForm())\n\t\t{\n\t\t\theader = this.localize.CATALOG_FORM_COMPILATION_INFO_MESSAGE_TITLE_FACEBOOK;\n\t\t\tdescription = Tag.render`\n\t\t\t\t<p>${this.localize.CATALOG_FORM_COMPILATION_INFO_MESSAGE_BODY_FACEBOOK_FIRST_BLOCK}</p>\n\t\t\t\t<p>${this.localize.CATALOG_FORM_COMPILATION_INFO_MESSAGE_BODY_FACEBOOK_SECOND_BLOCK}</p>\n\t\t\t`;\n\t\t}\n\t\telse\n\t\t{\n\t\t\theader = this.localize.CATALOG_FORM_COMPILATION_INFO_MESSAGE_TITLE;\n\t\t\tdescription = this.localize.CATALOG_FORM_COMPILATION_INFO_MESSAGE_BODY_MARKETING_2;\n\t\t}\n\n\t\tthis.message = new MessageCard({\n\t\t\tid: 'compilationInfo',\n\t\t\theader,\n\t\t\tdescription,\n\t\t\tangle: false,\n\t\t\thidden: true,\n\t\t\tactionElements: [moreMessageButton]\n\t\t});\n\n\t\tEventEmitter.subscribe(this.message, 'onClose', this.hideMessage);\n\t},\n\tmounted()\n\t{\n\t\tthis.$refs.label.appendChild(this.newLabel.render());\n\t\tthis.$refs.message.appendChild(this.message.getLayout());\n\t\tif (!this.compilationOptions.hiddenInfoMessage)\n\t\t{\n\t\t\tthis.showMessage();\n\t\t}\n\t},\n\tdata()\n\t{\n\t\treturn {\n\t\t\tcompilationLink: null,\n\t\t}\n\t},\n\tmethods:\n\t{\n\t\tisFacebookForm()\n\t\t{\n\t\t\treturn this.compilationOptions.type === FormCompilationType.FACEBOOK;\n\t\t},\n\t\topenHelpDesk()\n\t\t{\n\t\t\tthis.helpdeskCode =\n\t\t\t\tthis.isFacebookForm()\n\t\t\t\t\t? FormHelpdeskCode.COMPILATION_FACEBOOK\n\t\t\t\t\t: FormHelpdeskCode.COMMON_COMPILATION\n\t\t\t;\n\n\t\t\ttop.BX.Helper.show('redirect=detail&code=' + this.helpdeskCode);\n\t\t},\n\t\tshowPopup(event: BaseEvent): void\n\t\t{\n\t\t\tif (this.compilationOptions.disabledSwitcher)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.isFacebookForm())\n\t\t\t{\n\t\t\t\tthis.openHelpDesk();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.popup instanceof Popup)\n\t\t\t{\n\t\t\t\tthis.popup.setBindElement(this.$refs.qrLink);\n\t\t\t\tthis.popup.show();\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst basket = this.$store.getters['productList/getBasket']();\n\t\t\tconst productIds = basket.map((basketItem) => {\n\t\t\t\treturn basketItem?.fields?.skuId\n\t\t\t});\n\n\t\t\treturn new Promise(\n\t\t\t\t(resolve, reject) => {\n\t\t\t\t\tajax.runAction(\n\t\t\t\t\t\t'salescenter.compilation.createCompilation',\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\tproductIds,\n\t\t\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\t\t\townerId: this.$root.$app.options.ownerId,\n\t\t\t\t\t\t\t\t\townerTypeId: this.$root.$app.options.ownerTypeId,\n\t\t\t\t\t\t\t\t\tdialogId: this.$root.$app.options.dialogId,\n\t\t\t\t\t\t\t\t\tsessionId: this.$root.$app.options.sessionId,\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t)\n\t\t\t\t\t\t.then(response => {\n\t\t\t\t\t\t\tthis.compilationLink = response.data.link ?? null;\n\t\t\t\t\t\t\tEventEmitter.emit(\n\t\t\t\t\t\t\t\tthis.$root.$app,\n\t\t\t\t\t\t\t\t'ProductForm:onCompilationCreated',\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tcompilationId: response.data.compilationId ?? null,\n\t\t\t\t\t\t\t\t\townerId: response.data.ownerId ?? null,\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tthis.popup = new Popup({\n\t\t\t\t\t\t\t\tbindElement: event.target,\n\t\t\t\t\t\t\t\tcontent: this.getQRPopupContent(),\n\t\t\t\t\t\t\t\twidth: 375,\n\t\t\t\t\t\t\t\tcloseIcon: { top: '5px', right: '5px' },\n\t\t\t\t\t\t\t\tpadding: 0,\n\t\t\t\t\t\t\t\tcloseByEsc: true,\n\t\t\t\t\t\t\t\tautoHide: true,\n\t\t\t\t\t\t\t\tcacheable: true,\n\t\t\t\t\t\t\t\tanimation: 'fading-slide',\n\t\t\t\t\t\t\t\tangle: { offset: 30 }\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\tthis.popup.show();\n\t\t\t\t\t\t\tresolve();\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.catch(() => reject());\n\t\t\t\t});\n\t\t},\n\t\tgetQRPopupContent(): HTMLElement\n\t\t{\n\t\t\tif (!this.compilationLink)\n\t\t\t{\n\t\t\t\treturn '';\n\t\t\t}\n\n\t\t\tconst buttonCopy = Tag.render`\n\t\t\t\t<div class=\"catalog-pf-product-qr-popup-copy\">${this.localize.CATALOG_FORM_COMPILATION_QR_COPY}</div>\n\t\t\t`;\n\n\t\t\tEvent.bind(buttonCopy, 'click', () => {\n\t\t\t\tBX.clipboard.copy(this.compilationLink);\n\t\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\t\tcontent: this.localize.CATALOG_FORM_COMPILATION_QR_COPY_NOTIFY_MESSAGE,\n\t\t\t\t\tautoHideDelay: 2000,\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tconst qrWrapper = Tag.render`<div class=\"catalog-pf-product-qr-popup-image\"></div>`;\n\n\t\t\tconst content = Tag.render`\n\t\t\t\t\t<div class=\"catalog-pf-product-qr-popup\">\n\t\t\t\t\t\t<div class=\"catalog-pf-product-qr-popup-content\">\n\t\t\t\t\t\t\t<div class=\"catalog-pf-product-qr-popup-text\">${this.localize.CATALOG_FORM_COMPILATION_QR_POPUP_TITLE}</div>\n\t\t\t\t\t\t\t${qrWrapper}\n\t\t\t\t\t\t\t<div class=\"catalog-pf-product-qr-popup-buttons\">\n\t\t\t\t\t\t\t\t<a href=\"${this.compilationLink}\" target=\"_blank\" class=\"ui-btn ui-btn-light-border ui-btn-round\">${this.localize.CATALOG_FORM_COMPILATION_QR_POPUP_INPUT_TITLE}</a>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"catalog-pf-product-qr-popup-bottom\">\n\t\t\t\t\t\t\t<a href=\"${this.compilationLink}\" target=\"_blank\" class=\"catalog-pf-product-qr-popup--url\">${this.compilationLink}</a>\n\t\t\t\t\t\t\t${buttonCopy}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t`;\n\n\t\t\tnew QRCode(qrWrapper, {\n\t\t\t\ttext: this.compilationLink,\n\t\t\t\twidth: 250,\n\t\t\t\theight: 250\n\t\t\t});\n\n\t\t\treturn content;\n\t\t},\n\t\tsetSetting(event)\n\t\t{\n\t\t\tconst value = event.target.checked ? 'Y' : 'N';\n\t\t\tthis.$root.$app.changeFormOption('isCompilationMode', value);\n\t\t},\n\t\tgetOnBeforeCreationStorePopupContent()\n\t\t{\n\t\t\tconst loaderContent = Tag.render`\n\t\t\t\t<div class=\"catalog-product-form-popup--loader-block\"></div>\n\t\t\t`;\n\n\t\t\tconst node = Tag.render`\n\t\t\t\t<div class=\"catalog-product-form-popup--container\">\n\t\t\t\t\t<div class=\"catalog-product-form-popup--title\">${Loc.getMessage('CATALOG_FORM_POPUP_BEFORE_MARKET_CREATING1')}</div>\n\t\t\t\t\t${loaderContent}\n\t\t\t\t\t<div class=\"catalog-product-form-popup--text\">${Loc.getMessage('CATALOG_FORM_POPUP_BEFORE_MARKET_CREATING_INFO1')}</div>\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tconst loader = new Loader({\n\t\t\t\tcolor: \"#2fc6f6\",\n\t\t\t\ttarget: loaderContent,\n\t\t\t\tsize: 40,\n\t\t\t});\n\n\t\t\tloader.show();\n\n\t\t\treturn node;\n\t\t},\n\t\tgetOnAfterCreationStorePopupContent(creationStorePopup)\n\t\t{\n\t\t\tconst continueButton = Tag.render`\n\t\t\t\t<button class=\"ui-btn ui-btn-md ui-btn-primary\">\n\t\t\t\t\t${Loc.getMessage('CATALOG_FORM_POPUP_AFTER_MARKET_CREATING_CONTINUE')}\n\t\t\t\t</button>\n\t\t\t`;\n\t\t\tEvent.bind(continueButton, 'click', this.closeCreationStorePopup.bind(this, creationStorePopup));\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"catalog-product-form-popup--container\">\n\t\t\t\t\t<div class=\"catalog-product-form-popup--title\">${Loc.getMessage('CATALOG_FORM_POPUP_AFTER_MARKET_CREATING1')}</div>\n\t\t\t\t\t<div class=\"catalog-product-form-popup--loader-block catalog-product-form-popup--done\"></div>\n\t\t\t\t\t<div class=\"catalog-product-form-popup--text\">${Loc.getMessage('CATALOG_FORM_POPUP_AFTER_MARKET_CREATING_INFO1')}</div>\n\t\t\t\t\t<div class=\"catalog-product-form-popup--button-container\">${continueButton}</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t},\n\t\tcloseCreationStorePopup(creationStorePopup)\n\t\t{\n\t\t\tcreationStorePopup.close();\n\t\t},\n\t\tonLabelClick()\n\t\t{\n\t\t\tif (this.compilationOptions.isLimitedStore)\n\t\t\t{\n\t\t\t\tBX.UI.InfoHelper.show('limit_sites_number');\n\t\t\t}\n\t\t},\n\t\tonClickHint(event: BaseEvent)\n\t\t{\n\t\t\tevent.preventDefault();\n\t\t\tevent.stopImmediatePropagation();\n\t\t\tif (!this.message)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (this.message.isShown())\n\t\t\t{\n\t\t\t\tthis.hideMessage()\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.showMessage();\n\t\t\t}\n\t\t},\n\t\tshowMessage()\n\t\t{\n\t\t\tif (this.message)\n\t\t\t{\n\t\t\t\tDom.addClass(this.$refs.hintIcon, 'catalog-pf-product-panel-message-arrow-target');\n\t\t\t\tthis.message.show();\n\t\t\t}\n\t\t},\n\t\thideMessage()\n\t\t{\n\t\t\tif (this.message)\n\t\t\t{\n\t\t\t\tDom.removeClass(this.$refs.hintIcon, 'catalog-pf-product-panel-message-arrow-target');\n\t\t\t}\n\t\t\tthis.message.hide();\n\t\t\tthis.$root.$app.changeFormOption('hiddenCompilationInfoMessage', 'Y');\n\t\t}\n\t},\n\tcomputed:\n\t{\n\t\tlocalize()\n\t\t{\n\t\t\treturn Vue.getFilteredPhrases('CATALOG_');\n\t\t},\n\n\t\tshowQrLink()\n\t\t{\n\t\t\treturn this.mode === FormMode.COMPILATION;\n\t\t},\n\n\t\t...Vuex.mapState({\n\t\t\tproductList: state => state.productList,\n\t\t})\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div>\n\t\t\t<div class=\"catalog-pf-product-panel-compilation\">\n\t\t\t\t<div class=\"catalog-pf-product-panel-compilation-wrapper\">\n\t\t\t\t\t<label class=\"ui-ctl ui-ctl-checkbox catalog-pf-product-panel-compilation-checkbox-container\" @click=\"onLabelClick\">\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\ttype=\"checkbox\"\n\t\t\t\t\t\t\t:disabled=\"compilationOptions.disabledSwitcher\"\n\t\t\t\t\t\t\tclass=\"ui-ctl-element\"\n\t\t\t\t\t\t\t@change=\"setSetting\"\n\t\t\t\t\t\t\tdata-setting-id=\"isCompilationMode\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t<div class=\"ui-ctl-label-text\">{{localize.CATALOG_FORM_COMPILATION_PRODUCT_SWITCHER_2}}</div>\n\t\t\t\t\t\t<div ref=\"hintIcon\">\n\t\t\t\t\t\t\t<div data-hint-init=\"vue\" class=\"ui-hint\" @click=\"onClickHint\">\n\t\t\t\t\t\t\t\t<span class=\"ui-hint-icon\"></span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div ref=\"label\"></div>\n\t\t\t\t\t\t<div class=\"tariff-lock\" v-if=\"compilationOptions.isLimitedStore\"></div>\n\t\t\t\t\t</label>\n\t\t\t\t\t<div class=\"catalog-pf-product-panel-compilation-price-info\">{{localize.CATALOG_FORM_COMPILATION_PRICE_NOTIFICATION}}</div>\n\t\t\t\t</div>\n\t\t\t\t<div\n\t\t\t\t\tv-if=\"showQrLink\"\n\t\t\t\t\tclass=\"catalog-pf-product-panel-compilation-link --icon-qr\"\n\t\t\t\t\t@click=\"showPopup\"\n\t\t\t\t\tref=\"qrLink\"\n\t\t\t\t>\n\t\t\t\t\t{{localize.CATALOG_FORM_COMPILATION_QR_LINK}}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"catalog-pf-product-panel-compilation-message\" ref=\"message\"></div>\n\t\t</div>\n\t`\n});","import {Vuex} from 'ui.vue.vuex';\nimport {Popup} from 'main.popup';\nimport {ajax, Event, Loc, Tag, Text, Type} from 'main.core';\nimport {Vue} from \"ui.vue\";\nimport {config} from \"../../config\";\nimport \"./panel-compilation\";\nimport {DialogDisable, Slider, EventType} from 'catalog.store-use'\nimport {EventEmitter} from \"main.core.events\";\nimport 'ui.hint';\n\nVue.component(config.templatePanelButtons,\n{\n\t/**\n\t * @emits 'changeRowData' {index: number, fields: object}\n\t * @emits 'refreshBasket'\n\t * @emits 'addItem'\n\t */\n\n\tprops: {\n\t\toptions: Object,\n\t\tmode: String,\n\t},\n\tdata()\n\t{\n\t\treturn {\n\t\t\tsettings: []\n\t\t};\n\t},\n\tmethods:\n\t{\n\t\trefreshBasket()\n\t\t{\n\t\t\tthis.$emit('refreshBasket');\n\t\t},\n\t\tchangeBasketItem(item)\n\t\t{\n\t\t\tthis.$emit('changeRowData', item);\n\t\t},\n\t\taddBasketItemForm()\n\t\t{\n\t\t\tthis.$emit('addItem');\n\t\t},\n\t\tgetInternalIndexByProductId(skuId)\n\t\t{\n\t\t\tconst basket = this.$store.getters['productList/getBasket']();\n\t\t\treturn Object\n\t\t\t\t.keys(basket)\n\t\t\t\t.findIndex((inx) =>{\n\t\t\t\t\treturn parseInt(basket[inx].skuId) === parseInt(skuId)\n\t\t\t\t});\n\t\t},\n\t\thandleAddItem(id, params)\n\t\t{\n\t\t\tconst skuType = 4;\n\t\t\tif (Text.toNumber(params.type) === skuType)\n\t\t\t{\n\t\t\t\tajax.runAction(\n\t\t\t\t\t'catalog.productSelector.getSelectedSku',\n\t\t\t\t\t{\n\t\t\t\t\t\tjson: {\n\t\t\t\t\t\t\tvariationId: id,\n\t\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\t\tpriceId: this.options.basePriceId,\n\t\t\t\t\t\t\t\turlBuilder: this.options.urlBuilder,\n\t\t\t\t\t\t\t\tcurrency: this.options.currency,\n\t\t\t\t\t\t\t\tresetSku: true\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t).then(response => this.processResponse(response, params.isAddAnyway));\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tajax.runAction(\n\t\t\t\t\t'catalog.productSelector.getProduct',\n\t\t\t\t\t{\n\t\t\t\t\t\tjson: {\n\t\t\t\t\t\t\tproductId: id,\n\t\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\t\tpriceId: this.options.basePriceId,\n\t\t\t\t\t\t\t\turlBuilder: this.options.urlBuilder,\n\t\t\t\t\t\t\t\tcurrency: this.options.currency,\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t).then(response => this.processResponse(response, params.isAddAnyway));\n\t\t\t}\n\t\t},\n\t\tprocessResponse(response, isAddAnyway)\n\t\t{\n\t\t\tconst index = isAddAnyway ? -1 : this.getInternalIndexByProductId(response.data.skuId);\n\t\t\tif (index < 0)\n\t\t\t{\n\t\t\t\tconst productData = response.data;\n\t\t\t\tconst basePrice = Text.toNumber(productData.fields.BASE_PRICE);\n\t\t\t\tproductData.fields = productData.fields || {};\n\t\t\t\tlet newItem = this.$store.getters['productList/getBaseProduct']();\n\t\t\t\tnewItem.fields = Object.assign(newItem.fields, {\n\t\t\t\t\tprice: basePrice,\n\t\t\t\t\tpriceExclusive: basePrice,\n\t\t\t\t\tbasePrice,\n\t\t\t\t\tname: productData.fields.NAME || '',\n\t\t\t\t\tproductId: productData.productId,\n\t\t\t\t\tskuId: productData.skuId,\n\t\t\t\t\tmeasureCode: productData.fields.MEASURE_CODE,\n\t\t\t\t\tmeasureName: productData.fields.MEASURE_NAME,\n\t\t\t\t\tmeasureRatio: productData.fields.MEASURE_RATIO,\n\t\t\t\t\tproperties: productData.fields.PROPERTIES,\n\t\t\t\t\tofferId: productData.skuId > 0 ? productData.skuId : productData.productId,\n\t\t\t\t\tmodule: 'catalog',\n\t\t\t\t\tisCustomPrice: Type.isNil(productData.fields.PRICE) ? 'Y' : 'N',\n\t\t\t\t\tdiscountType: this.options.defaultDiscountType,\n\t\t\t\t});\n\n\t\t\t\tdelete(productData.fields);\n\t\t\t\tnewItem = Object.assign(newItem, productData);\n\t\t\t\tnewItem.sum = basePrice;\n\n\t\t\t\tthis.$root.$app.addProduct(newItem);\n\t\t\t}\n\t\t},\n\t\tonUpdateBasketItem(inx, item)\n\t\t{\n\t\t\tthis.$store.dispatch('productList/changeRowData', {\n\t\t\t\tindex : inx,\n\t\t\t\tfields : item\n\t\t\t});\n\t\t\tthis.$store.dispatch('productList/changeProduct', {\n\t\t\t\tindex : inx,\n\t\t\t\tfields : item.fields\n\t\t\t});\n\t\t},\n\t\t/*\n\t\t* By default, basket collection contains a fake|empty item,\n\t\t*  that is deleted when you select items from the catalog.\n\t\t* Also, products can be added to the form and become an empty string,\n\t\t*  while stay a item of basket collection\n\t\t* */\n\t\tremoveEmptyItems()\n\t\t{\n\t\t\tconst basket = this.$store.getters['productList/getBasket']();\n\t\t\tbasket.forEach((item, i)=>{\n\t\t\t\tif(\n\t\t\t\t\tbasket[i].name === ''\n\t\t\t\t\t&& basket[i].price < 1e-10\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tthis.$store.commit('productList/deleteItem', {\n\t\t\t\t\t\tindex: i\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tmodifyBasketItem(params)\n\t\t{\n\t\t\tconst skuId = parseInt(params.id);\n\t\t\tif(skuId > 0)\n\t\t\t{\n\t\t\t\tconst index = this.getInternalIndexByProductId(skuId);\n\t\t\t\tif(index >= 0)\n\t\t\t\t{\n\t\t\t\t\tthis.showDialogProductExists(params);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.removeEmptyItems();\n\t\t\t\t\tthis.handleAddItem(skuId, params);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tshowDialogProductExists(params)\n\t\t{\n\t\t\tthis.popup = new Popup(null, null, {\n\t\t\t\tevents: {\n\t\t\t\t\tonPopupClose: () => {this.popup.destroy()}\n\t\t\t\t},\n\t\t\t\tzIndex: 4000,\n\t\t\t\tautoHide: true,\n\t\t\t\tcloseByEsc: true,\n\t\t\t\tcloseIcon: true,\n\t\t\t\ttitleBar: Loc.getMessage('CATALOG_FORM_BLOCK_PROD_EXIST_DLG_TITLE'),\n\t\t\t\tdraggable: true,\n\t\t\t\tresizable: false,\n\t\t\t\tlightShadow: true,\n\t\t\t\tcacheable: false,\n\t\t\t\toverlay: true,\n\t\t\t\tcontent: Loc.getMessage('CATALOG_FORM_BLOCK_PROD_EXIST_DLG_TEXT_FOR_DOUBLE').replace('#NAME#', params.name),\n\t\t\t\tbuttons: this.getButtons(params),\n\t\t\t});\n\n\t\t\tthis.popup.show();\n\t\t},\n\t\tgetButtons(product)\n\t\t{\n\t\t\tconst buttons = [];\n\t\t\tconst params = product;\n\t\t\tbuttons.push(\n\t\t\t\tnew BX.UI.SaveButton(\n\t\t\t\t\t{\n\t\t\t\t\t\ttext : Loc.getMessage('CATALOG_FORM_BLOCK_PROD_EXIST_DLG_OK'),\n\t\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\t\tconst productId = parseInt(params.id);\n\t\t\t\t\t\t\tconst index = this.getInternalIndexByProductId(productId);\n\t\t\t\t\t\t\tif(index >= 0)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.handleAddItem(productId, {\n\t\t\t\t\t\t\t\t\t...params,\n\t\t\t\t\t\t\t\t\tisAddAnyway: true,\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tthis.popup.destroy();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t);\n\n\t\t\tbuttons.push(\n\t\t\t\tnew BX.UI.CancelButton(\n\t\t\t\t\t{\n\t\t\t\t\t\ttext : Loc.getMessage('CATALOG_FORM_BLOCK_PROD_EXIST_DLG_NO'),\n\t\t\t\t\t\tonclick: () => {this.popup.destroy()}\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t);\n\t\t\treturn buttons;\n\t\t},\n\t\tshowDialogProductSearch()\n\t\t{\n\t\t\tconst funcName = 'addBasketItemFromDialogProductSearch';\n\t\t\twindow[funcName] = params => this.modifyBasketItem(params);\n\n\t\t\tconst popup = new BX.CDialog({\n\t\t\t\tcontent_url: '/bitrix/tools/sale/product_search_dialog.php?'+\n\t\t\t\t\t//todo: 'lang='+this._settings.languageId+\n\t\t\t\t\t//todo: '&LID='+this._settings.siteId+\n\t\t\t\t\t'&caller=order_edit'+\n\t\t\t\t\t'&func_name='+funcName+\n\t\t\t\t\t'&STORE_FROM_ID=0'+\n\t\t\t\t\t'&public_mode=Y',\n\t\t\t\theight: Math.max(500, window.innerHeight-400),\n\t\t\t\twidth: Math.max(800, window.innerWidth-400),\n\t\t\t\tdraggable: true,\n\t\t\t\tresizable: true,\n\t\t\t\tmin_height: 500,\n\t\t\t\tmin_width: 800,\n\t\t\t\tzIndex: 3100\n\t\t\t});\n\n\t\t\tpopup.Show();\n\t\t},\n\t\tsetSetting(event)\n\t\t{\n\t\t\tif (event.target.dataset.settingId === 'taxIncludedOption')\n\t\t\t{\n\t\t\t\tconst value = event.target.checked ? 'Y' : 'N';\n\t\t\t\tthis.$root.$app.changeFormOption('taxIncluded', value);\n\t\t\t}\n\t\t\telse if (event.target.dataset.settingId === 'showDiscountInputOption')\n\t\t\t{\n\t\t\t\tconst value = event.target.checked ? 'Y' : 'N';\n\t\t\t\tthis.$root.$app.changeFormOption('showDiscountBlock', value);\n\t\t\t}\n\t\t\telse if (event.target.dataset.settingId === 'showTaxInputOption')\n\t\t\t{\n\t\t\t\tconst value = event.target.checked ? 'Y' : 'N';\n\t\t\t\tthis.$root.$app.changeFormOption('showTaxBlock', value);\n\t\t\t}\n\t\t\telse if (event.target.dataset.settingId === 'warehouseOption')\n\t\t\t{\n\t\t\t\tconst value = event.target.checked ? 'Y' : 'N';\n\n\t\t\t\tif(value === 'Y')\n\t\t\t\t{\n\t\t\t\t\tthis.popupMenu.close();\n\t\t\t\t\tnew Slider().open('/bitrix/components/bitrix/catalog.warehouse.master.clear/slider.php',{})\n\t\t\t\t\t.then(() => {\n\t\t\t\t\t\tajax.runAction(\n\t\t\t\t\t\t\t'catalog.config.isUsedInventoryManagement',\n\t\t\t\t\t\t\t{}\n\t\t\t\t\t\t).then(response => {\n\n\t\t\t\t\t\t\tconst index = this.getSettingItems().findIndex((item) =>\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\treturn item.id === event.target.dataset.settingId;\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\tthis.options.warehouseOption = response.data === true;\n\t\t\t\t\t\t\tthis.settings = this.getSettingItems();\n\t\t\t\t\t\t});\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tgetSettingItem(item): HTMLElement\n\t\t{\n\t\t\tconst input = Tag.render`\n\t\t\t\t\t<input type=\"checkbox\"  class=\"ui-ctl-element\">\n\t\t\t\t`;\n\t\t\tinput.checked = item.checked;\n\t\t\tinput.disabled = item.disabled ?? false;\n\t\t\tinput.dataset.settingId = item.id;\n\n\t\t\tconst hintNode = (\n\t\t\t\tType.isStringFilled(item.hint)\n\t\t\t\t\t? Tag.render`<span class=\"catalog-product-form-setting-hint\" data-hint=\"${item.hint}\"></span>`\n\t\t\t\t\t: ''\n\t\t\t);\n\n\t\t\tconst setting = Tag.render`\n\t\t\t\t<label class=\"ui-ctl ui-ctl-checkbox ui-ctl-w100\">\n\t\t\t\t\t${input}\n\t\t\t\t\t<div class=\"ui-ctl-label-text ${item.disabled ? 'catalog-product-form-disabled-setting' : ''}\">${item.title}${hintNode}</div>\n\t\t\t\t</label>\n\t\t\t`;\n\n\t\t\tBX.UI.Hint.init(setting);\n\n\t\t\tEvent.bind(setting, 'change', this.setSetting.bind(this));\n\n\t\t\treturn setting;\n\t\t},\n\t\tgetSettingItems()\n\t\t{\n\t\t\treturn [\n\t\t\t\t// {\n\t\t\t\t// \tid: 'taxIncludedOption',\n\t\t\t\t// \tchecked: (this.options.taxIncluded === 'Y'),\n\t\t\t\t// \ttitle: this.localize.CATALOG_FORM_ADD_TAX_INCLUDED,\n\t\t\t\t// },\n\t\t\t\t{\n\t\t\t\t\tid: 'showDiscountInputOption',\n\t\t\t\t\tchecked: (this.options.showDiscountBlock !== 'N'),\n\t\t\t\t\ttitle: this.localize.CATALOG_FORM_ADD_SHOW_DISCOUNTS_OPTION,\n\t\t\t\t},\n\t\t\t\t// {\n\t\t\t\t// \tid: 'showTaxInputOption',\n\t\t\t\t// \tchecked: (this.options.showTaxBlock !== 'N'),\n\t\t\t\t// \ttitle: this.localize.CATALOG_FORM_ADD_SHOW_TAXES_OPTION,\n\t\t\t\t// },\n\t\t\t\t{\n\t\t\t\t\tid: 'warehouseOption',\n\t\t\t\t\tchecked: (this.options.warehouseOption),\n\t\t\t\t\tdisabled: (this.options.warehouseOption),\n\t\t\t\t\ttitle: this.localize.CATALOG_FORM_ADD_SHOW_WAREHOUSE_OPTION,\n\t\t\t\t\thint: this.options.warehouseOption ? this.localize.CATALOG_FORM_ADD_SHOW_WAREHOUSE_HINT : '',\n\t\t\t\t},\n\t\t\t];\n\t\t},\n\n\t\tprepareSettingsContent(): HTMLElement\n\t\t{\n\t\t\tconst content = Tag.render`\n\t\t\t\t\t<div class='catalog-pf-product-config-popup'></div>\n\t\t\t\t`;\n\n\t\t\tthis.settings.forEach(item => {\n\t\t\t\tcontent.append(this.getSettingItem(item));\n\t\t\t});\n\n\t\t\treturn content;\n\t\t},\n\t\tshowConfigPopup(event)\n\t\t{\n\t\t\t// if (!this.popupMenu)\n\t\t\t// {\n\t\t\t\tthis.popupMenu = new Popup(null, event.target,\n\t\t\t\t\t{\n\t\t\t\t\t\tautoHide: true,\n\t\t\t\t\t\tdraggable: false,\n\t\t\t\t\t\toffsetLeft: 0,\n\t\t\t\t\t\toffsetTop: 0,\n\t\t\t\t\t\tnoAllPaddings: true,\n\t\t\t\t\t\tbindOptions: {forceBindPosition: true},\n\t\t\t\t\t\tcloseByEsc: true,\n\t\t\t\t\t\tcontent: this.prepareSettingsContent()\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t// }\n\n\t\t\tthis.popupMenu.show();\n\t\t},\n\t\topenSlider(url, options)\n\t\t{\n\t\t\tif(!Type.isPlainObject(options))\n\t\t\t{\n\t\t\t\toptions = {};\n\t\t\t}\n\t\t\toptions = {...{cacheable: false, allowChangeHistory: false, events: {}}, ...options};\n\t\t\treturn new Promise((resolve) =>\n\t\t\t\t{\n\t\t\t\t\tif(Type.isString(url) && url.length > 1)\n\t\t\t\t\t{\n\t\t\t\t\t\toptions.events.onClose = function(event)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tresolve(event.getSlider());\n\t\t\t\t\t};\n\t\t\t\t\tBX.SidePanel.Instance.open(url, options);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tresolve();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t},\n\tcomputed:\n\t{\n\t\tlocalize()\n\t\t{\n\t\t\treturn Vue.getFilteredPhrases('CATALOG_');\n\t\t},\n\t\tcountItems()\n\t\t{\n\t\t\treturn this.order.basket.length;\n\t\t},\n\t\t...Vuex.mapState({\n\t\t\tproductList: state => state.productList,\n\t\t})\n\t},\n\tmounted()\n\t{\n\t\tthis.settings = this.getSettingItems();\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div>\n\t\t\t<div class=\"catalog-pf-product-add\">\n\t\t\t\t<div class=\"catalog-pf-product-add-wrapper\">\n\t\t\t\t\t<span class=\"catalog-pf-product-add-link\" @click=\"addBasketItemForm\">{{localize.CATALOG_FORM_ADD_PRODUCT}}</span>\n\t\t\t\t\t<span class=\"catalog-pf-product-add-link catalog-pf-product-add-link--gray\" @click=\"showDialogProductSearch\">{{localize.CATALOG_FORM_ADD_PRODUCT_FROM_CATALOG}}</span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"catalog-pf-product-configure-link\" @click=\"showConfigPopup\">{{localize.CATALOG_FORM_DISCOUNT_EDIT_PAGE_URL_TITLE}}</div>\n\t\t\t</div>\n\t\t</div>\n\t`\n});","import {config} from '../config';\n\nimport {Vue} from 'ui.vue';\nimport {Vuex} from 'ui.vue.vuex';\nimport \"currency\";\nimport \"ui.layout-form\";\nimport \"ui.forms\";\nimport \"ui.buttons\";\n\nimport \"./row\";\nimport \"./elements/panel-buttons\";\nimport {FormElementPosition} from \"../types/form-element-position\";\nimport {FormMode} from \"../types/form-mode\";\n\nVue.component(config.templateName,\n{\n\tprops: {\n\t\toptions: Object,\n\t\tmode: String,\n\t},\n\tcreated()\n\t{\n\t\tBX.ajax.runAction(\n\t\t\t\"catalog.productSelector.getFileInput\",\n\t\t\t{ json: { iblockId: this.options.iblockId } }\n\t\t);\n\t},\n\tmethods:\n\t{\n\t\trefreshBasket()\n\t\t{\n\t\t\tthis.$store.dispatch('productList/refreshBasket');\n\t\t},\n\n\t\tchangeProduct(item)\n\t\t{\n\t\t\tthis.$root.$app.changeProduct(item);\n\t\t},\n\n\t\temitErrorsChange()\n\t\t{\n\t\t\tthis.$root.$app.emitErrorsChange();\n\t\t},\n\n\t\tchangeRowData(item)\n\t\t{\n\t\t\tdelete(item.product.fields);\n\t\t\tthis.$store.commit('productList/updateItem', item);\n\t\t},\n\n\t\tremoveItem(item)\n\t\t{\n\t\t\tthis.$root.$app.removeProduct(item);\n\t\t},\n\n\t\taddItem()\n\t\t{\n\t\t\tthis.$root.$app.addProduct();\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tlocalize()\n\t\t{\n\t\t\treturn Vue.getFilteredPhrases('CATALOG_');\n\t\t},\n\n\t\tshowTaxResult()\n\t\t{\n\t\t\treturn this.options.showTaxBlock !== 'N';\n\t\t},\n\n\t\tshowResults()\n\t\t{\n\t\t\treturn this.options.showResults !== false;\n\t\t},\n\n\t\tshowButtonsTop()\n\t\t{\n\t\t\treturn this.options.singleProductMode !== true\n\t\t\t\t&& this.mode !== FormMode.READ_ONLY\n\t\t\t\t&& this.mode !== FormMode.COMPILATION_READ_ONLY\n\t\t\t\t&& this.options.buttonsPosition !== FormElementPosition.BOTTOM\n\t\t\t;\n\t\t},\n\n\t\tshowButtonsBottom()\n\t\t{\n\t\t\treturn this.options.singleProductMode !== true\n\t\t\t\t&& this.mode !== FormMode.READ_ONLY\n\t\t\t\t&& this.mode !== FormMode.COMPILATION_READ_ONLY\n\t\t\t\t&& this.options.buttonsPosition === FormElementPosition.BOTTOM\n\t\t\t;\n\t\t},\n\n\t\tshowResultBlock()\n\t\t{\n\t\t\treturn this.showResults || this.enableAddButtons;\n\t\t},\n\n\t\tcountItems()\n\t\t{\n\t\t\treturn this.productList.basket.length;\n\t\t},\n\n\t\ttotalResultLabel()\n\t\t{\n\t\t\treturn this.options.hasOwnProperty('totalResultLabel') && this.options.totalResultLabel\n\t\t\t\t? this.options.totalResultLabel\n\t\t\t\t: this.localize.CATALOG_FORM_TOTAL_RESULT;\n\t\t},\n\n\t\t...Vuex.mapState({\n\t\t\tproductList: state => state.productList,\n\t\t})\n\t},\n\t// language=Vue\n\ttemplate: `\n\t<div class=\"catalog-product-form-container\">\n\t\t<${config.templatePanelButtons}\n\t\t\t:options=\"options\"\n\t\t\t:mode=\"mode\"\n\t\t\t@refreshBasket=\"refreshBasket\"\n\t\t\t@addItem=\"addItem\"\n\t\t\t@changeRowData=\"changeRowData\"\n\t\t\t@changeProduct=\"changeProduct\"\n\t\t\tv-if=\"showButtonsTop\"\n\t\t/>\n\t\t<div v-for=\"(item, index) in productList.basket\" :key=\"item.selectorId\">\n\t\t\t<${config.templateRowName}\n\t\t\t\t:basketItem=\"item\"\n\t\t\t\t:basketItemIndex=\"index\"\n\t\t\t\t:basketLength=\"productList.basket.length\"\n\t\t\t\t:countItems=\"countItems\"\n\t\t\t\t:options=\"options\"\n\t\t\t\t:mode=\"mode\"\n\t\t\t\t@changeProduct=\"changeProduct\"\n\t\t\t\t@changeRowData=\"changeRowData\"\n\t\t\t\t@removeItem=\"removeItem\"\n\t\t\t\t@refreshBasket=\"refreshBasket\"\n\t\t\t\t@emitErrorsChange=\"emitErrorsChange\"\n\t\t\t/>\n\t\t</div>\n\t\t<${config.templatePanelButtons}\n\t\t\t:options=\"options\"\n\t\t\t:mode=\"mode\"\n\t\t\t@refreshBasket=\"refreshBasket\"\n\t\t\t@addItem=\"addItem\"\n\t\t\t@changeRowData=\"changeRowData\"\n\t\t\t@changeProduct=\"changeProduct\"\n\t\t\tv-if=\"showButtonsBottom\"\n\t\t/>\n\t\t<${config.templatePanelCompilation}\n\t\t\tv-if=\"options.showCompilationModeSwitcher\"\n\t\t\t:compilationOptions=\"options.compilationFormOption\"\n\t\t\t:mode=\"mode\"\n\t\t/>\n\t\t<div class=\"catalog-pf-result-line\"></div>\n\t\t<div class=\"catalog-pf-result-wrapper\" v-if=\"showResultBlock\">\n\t\t\t<table class=\"catalog-pf-result\" v-if=\"showResultBlock\">\n\t\t\t\t<tr v-if=\"showResults\">\n\t\t\t\t\t<td>\n\t\t\t\t\t\t<span class=\"catalog-pf-text\">{{localize.CATALOG_FORM_PRODUCTS_PRICE}}:</span>\n\t\t\t\t\t</td>\n\t\t\t\t\t<td>\n\t\t\t\t\t\t<span v-html=\"productList.total.sum\"\n\t\t\t\t\t\t\t:class=\"productList.total.result !== productList.total.sum ? 'catalog-pf-text catalog-pf-text--line-through' : 'catalog-pf-text'\"\n\t\t\t\t\t\t></span>\n\t\t\t\t\t\t<span class=\"catalog-pf-symbol\" v-html=\"options.currencySymbol\"></span>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\t\t\t\t<tr v-if=\"showResults\">\n\t\t\t\t\t<td class=\"catalog-pf-result-padding-bottom\">\n\t\t\t\t\t\t<span class=\"catalog-pf-text catalog-pf-text--discount\">{{localize.CATALOG_FORM_TOTAL_DISCOUNT}}:</span>\n\t\t\t\t\t</td>\n\t\t\t\t\t<td class=\"catalog-pf-result-padding-bottom\">\n\t\t\t\t\t\t<span class=\"catalog-pf-text catalog-pf-text--discount\" v-html=\"productList.total.discount\"></span>\n\t\t\t\t\t\t<span class=\"catalog-pf-symbol\" v-html=\"options.currencySymbol\"></span>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\t\t\t\t<tr v-if=\"showResults && showTaxResult\">\n\t\t\t\t\t<td class=\"catalog-pf-tax\">\n\t\t\t\t\t\t<span class=\"catalog-pf-text catalog-pf-text--tax\">{{localize.CATALOG_FORM_TAX_TITLE}}:</span>\n\t\t\t\t\t</td>\n\t\t\t\t\t<td class=\"catalog-pf-tax\">\n\t\t\t\t\t\t<span class=\"catalog-pf-text catalog-pf-text--tax\" v-html=\"productList.total.taxSum\"></span>\n\t\t\t\t\t\t<span class=\"catalog-pf-symbol\" v-html=\"options.currencySymbol\"></span>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\t\t\t\t<tr v-if=\"showResults\">\n\t\t\t\t\t<td class=\"catalog-pf-result-padding\">\n\t\t\t\t\t\t<span class=\"catalog-pf-text catalog-pf-text--total catalog-pf-text--border\">{{totalResultLabel}}:</span>\n\t\t\t\t\t</td>\n\t\t\t\t\t<td class=\"catalog-pf-result-padding\">\n\t\t\t\t\t\t<span class=\"catalog-pf-text catalog-pf-text--total\" v-html=\"productList.total.result\"></span>\n\t\t\t\t\t\t<span class=\"catalog-pf-symbol catalog-pf-symbol--total\" v-html=\"options.currencySymbol\"></span>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\t\t\t</table>\n\t\t</div>\n\t</div>\n`,\n});\n","import {BitrixVue} from 'ui.vue';\nimport {VuexBuilder} from 'ui.vue.vuex';\nimport {Loc, Type, Text, Tag, ajax, Extension} from 'main.core';\nimport 'ui.notification';\nimport 'ui.design-tokens';\nimport 'ui.fonts.opensans';\nimport {ProductList} from './models/product-list';\nimport {config} from \"./config\";\nimport './templates/form';\nimport './component.css';\nimport {EventEmitter} from \"main.core.events\";\nimport {CurrencyCore} from \"currency.currency-core\";\nimport type {FormOption} from \"./types/form-option\";\nimport {FormElementPosition} from \"./types/form-element-position\";\nimport {DiscountType} from \"catalog.product-calculator\";\nimport {FormInputCode} from \"./types/form-input-code\";\nimport type {BasketItemScheme} from \"./types/basket-item-scheme\";\nimport {FormErrorCode} from \"./types/form-error-code\";\nimport {FormMode} from \"./types/form-mode\";\nimport {FormCompilationType} from \"./types/form-compilation-type\";\n\nclass ProductForm\n{\n\tconstructor(options: FormOption = {})\n\t{\n\t\tthis.options = this.prepareOptions(options);\n\t\tthis.defaultOptions = Object.assign({}, this.options);\n\n\t\tthis.editable = true;\n\t\tthis.#setMode(FormMode.REGULAR);\n\n\t\tthis.wrapper = Tag.render`<div class=\"\"></div>`;\n\n\t\tif (Text.toNumber(options.iblockId) <= 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tProductForm.initStore()\n\t\t\t.then((result) => this.initTemplate(result))\n\t\t\t.catch((error) => ProductForm.showError(error))\n\t\t;\n\t}\n\n\tstatic initStore(): VuexBuilder\n\t{\n\t\tconst builder = new VuexBuilder();\n\n\t\treturn builder\n\t\t\t.addModel(ProductList.create())\n\t\t\t.build();\n\t}\n\n\tprepareOptions(options: FormOption = {}): FormOption\n\t{\n\t\tconst settingsCollection = Extension.getSettings('catalog.product-form');\n\t\tconst defaultOptions: FormOption = {\n\t\t\tbasket: [],\n\t\t\tmeasures: [],\n\t\t\tiblockId: null,\n\t\t\tbasePriceId: settingsCollection.get('basePriceId'),\n\t\t\ttaxList: [],\n\t\t\tsingleProductMode: false,\n\t\t\tshowResults: true,\n\t\t\tshowCompilationModeSwitcher: false,\n\t\t\tenableEmptyProductError: true,\n\t\t\tpricePrecision: 2,\n\t\t\tcurrency: settingsCollection.get('currency'),\n\t\t\tcurrencySymbol: settingsCollection.get('currencySymbol'),\n\t\t\ttaxIncluded: settingsCollection.get('taxIncluded'),\n\t\t\twarehouseOption: settingsCollection.get('warehouseOption'),\n\t\t\tshowDiscountBlock: settingsCollection.get('showDiscountBlock'),\n\t\t\tshowTaxBlock: settingsCollection.get('showTaxBlock'),\n\t\t\tallowedDiscountTypes: [DiscountType.PERCENTAGE, DiscountType.MONETARY],\n\t\t\tvisibleBlocks: [\n\t\t\t\tFormInputCode.PRODUCT_SELECTOR, FormInputCode.IMAGE_EDITOR, FormInputCode.PRICE,\n\t\t\t\tFormInputCode.QUANTITY, FormInputCode.RESULT,\n\t\t\t\tFormInputCode.DISCOUNT,\n\t\t\t],\n\t\t\trequiredFields: [],\n\t\t\teditableFields: [],\n\t\t\tnewItemPosition: FormElementPosition.TOP,\n\t\t\tbuttonsPosition: FormElementPosition.TOP,\n\t\t\turlBuilderContext: 'SHOP',\n\t\t\thideUnselectedProperties: false,\n\t\t\tisCatalogPriceEditEnabled: settingsCollection.get('isCatalogPriceEditEnabled'),\n\t\t\tisCatalogPriceSaveEnabled: settingsCollection.get('isCatalogPriceSaveEnabled'),\n\t\t\tfieldHints: settingsCollection.get('fieldHints'),\n\t\t\tcompilationFormType: FormCompilationType.REGULAR,\n\t\t\tcompilationFormOption: {},\n\t\t\tfacebookFailProducts: null,\n\t\t\townerId: null,\n\t\t\townerTypeId: null,\n\t\t\tdialogId: null,\n\t\t\tsessionId: null,\n\t\t};\n\n\t\tif (options.visibleBlocks && !Type.isArray(options.visibleBlocks))\n\t\t{\n\t\t\tdelete(options.visibleBlocks);\n\t\t}\n\n\t\tif (options.requiredFields && !Type.isArray(options.requiredFields))\n\t\t{\n\t\t\tdelete(options.requiredFields);\n\t\t}\n\n\t\toptions = {...defaultOptions, ...options};\n\t\toptions.showTaxBlock = 'N';\n\n\t\tif (settingsCollection.get('isEnabledLanding'))\n\t\t{\n\t\t\toptions.compilationFormOption = {\n\t\t\t\ttype: options.compilationFormType,\n\t\t\t\thasStore: settingsCollection.get('hasLandingStore'),\n\t\t\t\tisLimitedStore: settingsCollection.get('isLimitedLandingStore'),\n\t\t\t\tdisabledSwitcher: settingsCollection.get('isLimitedLandingStore'),\n\t\t\t\thiddenInfoMessage: settingsCollection.get('hiddenCompilationInfoMessage'),\n\t\t\t};\n\t\t}\n\t\telse\n\t\t{\n\t\t\toptions.showCompilationModeSwitcher = false;\n\t\t}\n\n\t\toptions.defaultDiscountType = '';\n\t\tif (Type.isArray(options.allowedDiscountTypes))\n\t\t{\n\t\t\tif (options.allowedDiscountTypes.includes(DiscountType.PERCENTAGE))\n\t\t\t{\n\t\t\t\toptions.defaultDiscountType = DiscountType.PERCENTAGE;\n\t\t\t}\n\t\t\telse if (options.allowedDiscountTypes.includes(DiscountType.MONETARY))\n\t\t\t{\n\t\t\t\toptions.defaultDiscountType = DiscountType.MONETARY;\n\t\t\t}\n\t\t}\n\n\t\treturn options;\n\t}\n\n\tlayout(): HTMLElement\n\t{\n\t\treturn this.wrapper;\n\t}\n\n\tinitTemplate(result): Promise\n\t{\n\t\treturn new Promise((resolve) =>\n\t\t{\n\t\t\tconst context = this;\n\t\t\tthis.store = result.store;\n\n\t\t\tthis.templateEngine = BitrixVue.createApp({\n\t\t\t\tel: this.wrapper,\n\t\t\t\tstore: this.store,\n\t\t\t\tdata: {\n\t\t\t\t\toptions: this.options,\n\t\t\t\t\tmode: this.mode,\n\t\t\t\t},\n\t\t\t\tcreated()\n\t\t\t\t{\n\t\t\t\t\tthis.$app = context;\n\t\t\t\t},\n\t\t\t\tmounted()\n\t\t\t\t{\n\t\t\t\t\tresolve();\n\t\t\t\t},\n\t\t\t\ttemplate: `<${config.templateName} :options=\"options\" :mode=\"mode\"/>`,\n\t\t\t});\n\n\t\t\tif (Type.isStringFilled(this.options.currency))\n\t\t\t{\n\t\t\t\tthis.setData({\n\t\t\t\t\tcurrency: this.options.currency\n\t\t\t\t});\n\t\t\t\tCurrencyCore.loadCurrencyFormat(this.options.currency);\n\t\t\t}\n\n\t\t\tif (this.options.basket.length > 0)\n\t\t\t{\n\t\t\t\tthis.setData(\n\t\t\t\t\t{basket: this.options.basket,},\n\t\t\t\t\t{newItemPosition: FormElementPosition.BOTTOM}\n\t\t\t\t);\n\n\t\t\t\tif (Type.isObject(this.options.totals))\n\t\t\t\t{\n\t\t\t\t\tthis.store.commit('productList/setTotal', this.options.totals);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.store.dispatch('productList/calculateTotal');\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst newItem = this.store.getters['productList/getBaseProduct']();\n\t\t\t\tnewItem.fields.discountType = this.options.defaultDiscountType;\n\t\t\t\tthis.addProduct(newItem);\n\t\t\t}\n\n\t\t\tEventEmitter.emit(this, 'onAfterInit');\n\t\t});\n\t}\n\n\taddProduct(item = {}): void\n\t{\n\t\tthis.store.dispatch('productList/addItem', {\n\t\t\titem,\n\t\t\tposition: this.options.newItemPosition\n\t\t})\n\t\t\t.then(() => {\n\t\t\t\tthis.#onBasketChange();\n\t\t\t});\n\t}\n\n\t#onBasketChange(): void\n\t{\n\t\tEventEmitter.emit(this, 'ProductForm:onBasketChange', {\n\t\t\tbasket: this.store.getters['productList/getBasket']()\n\t\t});\n\t}\n\n\temitErrorsChange(): void\n\t{\n\t\tEventEmitter.emit(this, 'ProductForm:onErrorsChange');\n\t}\n\n\tchangeProduct(item): void\n\t{\n\t\tconst product = item.product;\n\t\tproduct.errors = [];\n\t\tif (item.skipFieldChecking !== true)\n\t\t{\n\t\t\tconst result = this.#checkRequiredFields(product);\n\t\t\tproduct.errors = result?.errors || [];\n\t\t}\n\n\t\tthis.store.dispatch('productList/changeItem', {\n\t\t\tindex: item.index,\n\t\t\tproduct\n\t\t}).then(() => {\n\t\t\tthis.#onBasketChange();\n\t\t});\n\t}\n\n\t#checkRequiredFields(product): {}\n\t{\n\t\tconst result = {};\n\t\tif (!Type.isArray(this.options.requiredFields) || this.options.requiredFields.length === 0)\n\t\t{\n\t\t\treturn result;\n\t\t}\n\n\t\tresult.errors = [];\n\t\tthis.options.requiredFields.forEach((code) => {\n\t\t\tswitch (code)\n\t\t\t{\n\t\t\t\tcase FormInputCode.PRICE:\n\t\t\t\t\tif (!this.options.isCatalogPriceSaveEnabled && product.catalogPrice <= 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tresult.errors.push({\n\t\t\t\t\t\t\tcode: FormErrorCode.EMPTY_PRICE,\n\t\t\t\t\t\t\tmessage: Loc.getMessage('CATALOG_FORM_ERROR_EMPTY_PRICE_FILL_IN_CARD'),\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\telse if (product.fields.basePrice <= 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tresult.errors.push({\n\t\t\t\t\t\t\tcode: FormErrorCode.EMPTY_PRICE,\n\t\t\t\t\t\t\tmessage: Loc.getMessage('CATALOG_FORM_ERROR_EMPTY_PRICE_1'),\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase FormInputCode.QUANTITY:\n\t\t\t\t\tif (product.fields.quantity <= 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tresult.errors.push({\n\t\t\t\t\t\t\tcode: FormErrorCode.EMPTY_QUANTITY,\n\t\t\t\t\t\t\tmessage: Loc.getMessage('CATALOG_FORM_ERROR_EMPTY_QUANTITY_1'),\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase FormInputCode.BRAND:\n\t\t\t\t\tif (!Type.isArray(product.fields.brands) || product.fields.brands.length === 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tresult.errors.push({\n\t\t\t\t\t\t\tcode: FormErrorCode.EMPTY_BRAND,\n\t\t\t\t\t\t\tmessage: Loc.getMessage('CATALOG_FORM_ERROR_EMPTY_BRAND_1'),\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase FormInputCode.IMAGE_EDITOR:\n\t\t\t\t\tif (!Type.isObject(product.fields.morePhoto) || Object.keys(product.fields.morePhoto).length === 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tresult.errors.push({\n\t\t\t\t\t\t\tcode: FormErrorCode.EMPTY_IMAGE,\n\t\t\t\t\t\t\tmessage: Loc.getMessage('CATALOG_FORM_ERROR_EMPTY_PICTURE_1'),\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t});\n\n\t\treturn result;\n\t}\n\n\tremoveProduct(product): void\n\t{\n\t\tthis.store.dispatch('productList/removeItem', {\n\t\t\tindex: product.index\n\t\t}).then(() => {\n\t\t\tthis.#onBasketChange();\n\t\t});\n\t}\n\n\tsetData(data, option = {}): void\n\t{\n\t\tif (Type.isObject(data.basket))\n\t\t{\n\t\t\tconst formBasket = this.store.getters['productList/getBasket']();\n\t\t\tdata.basket.forEach((fields) => {\n\t\t\t\tif (!Type.isObject(fields))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tconst itemPosition = option.newItemPosition || this.options.newItemPosition;\n\n\t\t\t\tconst innerId = fields.selectorId;\n\t\t\t\tif (Type.isNil(innerId))\n\t\t\t\t{\n\t\t\t\t\tthis.store.dispatch('productList/addItem', {\n\t\t\t\t\t\titem: fields,\n\t\t\t\t\t\tposition: itemPosition\n\t\t\t\t\t});\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst basketIndex = formBasket.findIndex(item => item.selectorId === innerId);\n\t\t\t\tif (basketIndex === -1)\n\t\t\t\t{\n\t\t\t\t\tthis.store.dispatch('productList/addItem', {\n\t\t\t\t\t\titem: fields,\n\t\t\t\t\t\tposition: itemPosition\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.store.dispatch('productList/changeItem', {basketIndex, fields});\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tif (Type.isStringFilled(data.currency))\n\t\t{\n\t\t\tthis.store.dispatch('productList/setCurrency', data.currency);\n\t\t}\n\n\t\tif (Type.isObject(data.total))\n\t\t{\n\t\t\tthis.store.commit('productList/setTotal', {\n\t\t\t\tsum: data.total.sum,\n\t\t\t\ttaxSum: data.total.taxSum,\n\t\t\t\tdiscount: data.total.discount,\n\t\t\t\tresult: data.total.result,\n\t\t\t})\n\t\t}\n\n\t\tif (Type.isObject(data.errors))\n\t\t{\n\t\t\tthis.store.commit('productList/setErrors', data.errors);\n\t\t}\n\t}\n\n\tchangeFormOption(optionName, value): void\n\t{\n\t\tvalue = (value === 'Y') ? 'Y' : 'N';\n\n\t\tif (optionName === 'isCompilationMode')\n\t\t{\n\t\t\tif (!this.options.showCompilationModeSwitcher)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tEventEmitter.emit(this, 'onChangeCompilationMode', {\n\t\t\t\tisCompilationMode: value === 'Y',\n\t\t\t\tisFacebookForm: this.options.compilationFormType === FormCompilationType.FACEBOOK,\n\t\t\t});\n\t\t\tconst mode = (value === 'Y') ? FormMode.COMPILATION : FormMode.REGULAR;\n\t\t\tthis.#changeCompilationModeSetting(mode);\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.options[optionName] = value;\n\t\tif (optionName !== 'hiddenCompilationInfoMessage')\n\t\t{\n\t\t\tconst basket = this.store.getters['productList/getBasket']();\n\t\t\tbasket.forEach((item, index) => {\n\t\t\t\tif (optionName === 'showDiscountBlock')\n\t\t\t\t{\n\t\t\t\t\titem.showDiscountBlock = value;\n\t\t\t\t}\n\t\t\t\telse if (optionName === 'showTaxBlock')\n\t\t\t\t{\n\t\t\t\t\titem.showTaxBlock = value;\n\t\t\t\t}\n\t\t\t\telse if (optionName === 'taxIncluded')\n\t\t\t\t{\n\t\t\t\t\titem.fields.taxIncluded = value;\n\t\t\t\t}\n\n\t\t\t\tthis.store.dispatch('productList/changeItem', {\n\t\t\t\t\tindex,\n\t\t\t\t\tfields: item\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t\tajax.runAction(\n\t\t\t'catalog.productForm.setConfig',\n\t\t\t{\n\t\t\t\tdata: {\n\t\t\t\t\tconfigName: optionName,\n\t\t\t\t\tvalue: value\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t}\n\n\t#changeCompilationModeSetting(mode: FormMode)\n\t{\n\t\tthis.#setMode(mode);\n\n\t\tconst basket = this.store.getters['productList/getBasket']();\n\n\t\tbasket.forEach((item, index) => this.changeProduct({\n\t\t\t\tindex,\n\t\t\t\tproduct: item\t,\n\t\t\t\tskipFieldChecking: (basket.length === 1 && index === 0 && item.offerId === null)\n\t\t\t})\n\t\t);\n\t}\n\n\tgetTotal(): void\n\t{\n\t\tthis.store.dispatch('productList/getTotal');\n\t}\n\n\tsetEditable(editable, isCompilationMode): void\n\t{\n\t\tthis.editable = editable;\n\t\tif (!editable && !isCompilationMode)\n\t\t{\n\t\t\tthis.#setMode(FormMode.READ_ONLY);\n\t\t}\n\t\telse if (!editable && isCompilationMode)\n\t\t{\n\t\t\tthis.#setMode(FormMode.COMPILATION_READ_ONLY);\n\t\t}\n\t\telse if (editable && isCompilationMode)\n\t\t{\n\t\t\tthis.#setMode(FormMode.COMPILATION);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.#setMode(FormMode.REGULAR);\n\t\t}\n\t}\n\n\t#setMode(mode: FormMode): void\n\t{\n\t\tthis.mode = mode;\n\t\tif (mode === FormMode.READ_ONLY)\n\t\t{\n\t\t\tthis.options.editableFields = [];\n\t\t}\n\t\telse if (mode === FormMode.COMPILATION_READ_ONLY)\n\t\t{\n\t\t\tthis.options.editableFields = [];\n\t\t\tthis.options.visibleBlocks = [\n\t\t\t\tFormInputCode.PRODUCT_SELECTOR,\n\t\t\t\tFormInputCode.IMAGE_EDITOR,\n\t\t\t\tFormInputCode.PRICE,\n\t\t\t\tFormInputCode.BRAND\n\t\t\t];\n\t\t\tthis.options.showResults = false;\n\t\t}\n\t\telse if (mode === FormMode.COMPILATION)\n\t\t{\n\t\t\tthis.options.editableFields = [\n\t\t\t\tFormInputCode.PRODUCT_SELECTOR, FormInputCode.BRAND,\n\t\t\t];\n\t\t\tif (this.options.isCatalogPriceSaveEnabled)\n\t\t\t{\n\t\t\t\tthis.options.editableFields.push(FormInputCode.PRICE);\n\t\t\t}\n\t\t\tthis.options.visibleBlocks = this.defaultOptions.visibleBlocks;\n\n\t\t\tif (this.options.compilationFormType === FormCompilationType.FACEBOOK)\n\t\t\t{\n\t\t\t\tthis.options.visibleBlocks = [\n\t\t\t\t\tFormInputCode.PRODUCT_SELECTOR,\n\t\t\t\t\tFormInputCode.IMAGE_EDITOR,\n\t\t\t\t\tFormInputCode.PRICE,\n\t\t\t\t\tFormInputCode.BRAND\n\t\t\t\t];\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.options.visibleBlocks = this.defaultOptions.visibleBlocks;\n\t\t\t}\n\n\t\t\tthis.options.showResults = false;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tmode = FormMode.REGULAR;\n\t\t\tthis.options.visibleBlocks = this.defaultOptions.visibleBlocks;\n\t\t\tthis.options.showResults = this.defaultOptions.showResults;\n\t\t\tthis.options.editableFields = this.defaultOptions.visibleBlocks;\n\t\t}\n\n\t\tif (this.templateEngine)\n\t\t{\n\t\t\tthis.templateEngine.mode = mode;\n\t\t}\n\n\t\tthis.options.requiredFields = [];\n\t\tif (mode === FormMode.COMPILATION)\n\t\t{\n\t\t\tlet compilationRequiredFields = [\n\t\t\t\tFormInputCode.PRODUCT_SELECTOR, FormInputCode.PRICE,\n\t\t\t];\n\t\t\tif (this.options.compilationFormType === FormCompilationType.FACEBOOK)\n\t\t\t{\n\t\t\t\tcompilationRequiredFields.push(FormInputCode.IMAGE_EDITOR);\n\t\t\t\tcompilationRequiredFields.push(FormInputCode.BRAND);\n\t\t\t}\n\t\t\tthis.options.requiredFields = this.options.visibleBlocks.filter(\n\t\t\t\titem => compilationRequiredFields.includes(item)\n\t\t\t);\n\t\t}\n\n\t\tEventEmitter.emit(this, 'ProductForm:onModeChange', { mode });\n\t}\n\n\thasErrors()\n\t{\n\t\tif (!this.store)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst basket = this.store.getters['productList/getBasket']();\n\t\tconst errorItems = basket.filter(\n\t\t\titem => item.errors.length > 0\n\t\t);\n\n\t\treturn errorItems.length > 0;\n\t}\n\n\tstatic showError(error): void\n\t{\n\t\tconsole.error(error);\n\t}\n}\n\nexport {ProductForm, FormMode}\n"],"names":["FormElementPosition","TOP","BOTTOM","ProductList","VuexBuilderModel","getName","getState","currency","taxIncluded","basket","total","sum","discount","taxSum","result","getBaseProduct","random","Text","getRandom","offerId","selectorId","fields","innerId","productId","skuId","code","module","sort","price","basePrice","priceExclusive","quantity","name","discountRate","discountInfos","discountType","DiscountType","PERCENTAGE","tax","measureCode","measureName","measureRatio","isCustomPrice","additionalFields","properties","brands","calculatedFields","catalogFields","showDiscount","showTax","skuTree","image","catalogPrice","discountSum","detailUrl","encodedFields","errors","getActions","resetBasket","commit","removeItem","dispatch","state","payload","length","forEach","item","i","index","changeItem","setCurrency","addItem","position","calculateTotal","toNumber","getGetters","getBasket","getMutations","Object","assign","push","unshift","updateItem","Type","isNil","Vue","set","product","clearBasket","deleteItem","splice","setErrors","clearErrors","setTotal","formattedTotal","isStringFilled","key","hasOwnProperty","CurrencyCore","currencyFormat","config","freeze","databaseConfig","templateName","templatePanelButtons","templatePanelCompilation","templateRowName","templateFieldInlineSelector","templateFieldPrice","templateFieldResultSum","templateFieldQuantity","templateFieldDiscount","templateFieldTax","templateFieldBrand","moduleId","FormInputCode","PRODUCT_SELECTOR","IMAGE_EDITOR","QUANTITY","PRICE","RESULT","DISCOUNT","TAX","BRAND","MEASURE","FormErrorCode","EMPTY_PRODUCT_SELECTOR","EMPTY_IMAGE","EMPTY_QUANTITY","EMPTY_PRICE","EMPTY_BRAND","IS_NULLABLE_PRICE","FormMode","REGULAR","READ_ONLY","COMPILATION","COMPILATION_READ_ONLY","component","props","Number","String","editable","Boolean","saveableMeasure","hasError","options","created","onInputQuantityHandler","Runtime","debounce","onInputQuantity","methods","event","target","value","replace","newQuantity","lastSymbol","substr","changeQuantity","calculateCorrectionFactor","factoredQuantity","factoredRatio","correctionFactor","isInteger","incrementValue","decrementValue","$emit","showPopupMenu","isArray","measures","menuItems","text","SYMBOL","onclick","selectMeasure","popupMenu","Menu","bindElement","items","show","params","CODE","close","template","onInputPriceHandler","onInputPrice","newPrice","computed","localize","getFilteredPhrases","currencySymbol","onInputDiscount","onChangeDiscount","onChangeType","type","MONETARY","discountValue","allowedDiscountTypes","includes","getDiscountInputValue","getDiscountSymbol","taxId","data","taxValue","getTaxList","onChangeValue","id","taxList","basketLength","basketItem","model","productSelector","imageControlId","EventEmitter","subscribe","onProductSelect","bind","onProductChange","onProductClear","$root","$app","changeProductSelectorImageRequire","mounted","ProductSelector","prepareSelectorParams","renderTo","$refs","selectorWrapper","isCompilationMode","getData","isFacebookForm","setConfig","checkEmptyImageError","layoutErrors","NAME","getField","CURRENCY","basketItemOfferId","facebookFailProducts","hasFacebookError","isObject","selectorOptions","iblockId","basePriceId","getDefaultSkuTree","fileInputId","morePhotoValues","fileInput","DETAIL_PATH","ENABLE_SEARCH","ENABLE_INPUT_DETAIL_LINK","ENABLE_IMAGE_CHANGE_SAVING","ENABLE_EMPTY_PRODUCT_ERROR","enableEmptyProductError","isRequiredField","ENABLE_EMPTY_IMAGES_ERROR","ROW_ID","ENABLE_SKU_SELECTION","HIDE_UNSELECTED_ITEMS","hideUnselectedProperties","URL_BUILDER_CONTEXT","urlBuilderContext","failedProduct","mode","MODE_EDIT","MODE_VIEW","formImage","fileView","preview","input","values","isEnabledSaving","enableCatalogSaving","hasEditRights","requiredFields","JSON","parse","defaultValue","getId","BASE_PRICE","MODULE","ID","PRODUCT_ID","SKU_ID","PROPERTIES","CUSTOMIZED","MEASURE_CODE","MEASURE_NAME","MORE_PHOTO","morePhoto","BRANDS","IS_NEW","isNew","Array","cache","Cache","MemoryCache","selector","TagSelector","dialogOptions","context","preselectedItems","getPreselectedBrands","events","onBrandChange","createBrand","searchTabOptions","stub","stubOptions","title","Tag","message","subtitle","arrow","searchOptions","allowCreateItem","entities","dynamicSearch","dynamicLoad","isSelectedByProductChange","$parent","$on","selectCurrentBrands","brandSelectorWrapper","brand","brandIndex","separator","appendChild","render","getDialog","isLoaded","deselectAll","selectDialogItems","load","getItem","entityId","select","map","getTarget","getSelectedItems","resultValues","getTitle","getAvatar","eventData","searchQuery","Promise","resolve","reject","dialog","getQuery","showLoader","ajax","runAction","then","response","hideLoader","tabs","getRecentTab","hide","catch","onInputSumHandler","onInputSum","newSum","basketItemIndex","countItems","defaultMeasure","blocks","measure","errorCodes","emptyProductSelector","emptyImage","emptyQuantity","emptyPrice","emptyBrand","initModel","changeProductFields","prepareModelFields","defaultFields","defaultPrice","PRICE_NETTO","PRICE_BRUTTO","PRICE_EXCLUSIVE","DISCOUNT_TYPE_ID","DISCOUNT_RATE","DISCOUNT_SUM","TAX_INCLUDED","TAX_RATE","ProductModel","isSimpleModel","onErrorsChange","getErrorCollection","getErrors","changeRowData","setCalculatedFields","getCalculator","setFields","SUM","getProductFieldsFromModel","modelFields","getFields","TAX_ID","skipFieldChecking","isSimple","saveCatalogField","changedFields","save","calculateBasePrice","processFields","originBasketId","originProductId","isPlainObject","onChangeSum","onChangePrice","isCatalogPriceSaveEnabled","changeBasePrice","showSaveNotifier","Loc","getMessage","onCancel","calculatorFields","changePrice","toggleDiscount","changeFormOption","onSave","onSelectMeasure","changeMeasure","isReadOnly","setTimeout","discountWrapper","discountInput","focus","toggleTax","changeBrand","onChangeQuantity","calculateQuantity","productFields","setField","calculatePrice","changeDiscountType","calculateDiscountType","changeDiscount","calculateDiscount","changeTax","calculateTax","changeTaxIncluded","isEditableField","calculateTaxIncluded","isVisibleBlock","visibleBlocks","getPriceValue","getQuantityValue","getSumValue","getDiscountValue","getDiscountRateValue","isEmpty","isChanged","filteredErrors","filter","error","isEditablePrice","editableFields","isCatalogExisted","isCatalogPriceEditEnabled","getHint","fieldHints","hasHint","showPriceNotify","hint","ARTICLE_CODE","top","BX","Helper","watch","oldValue","showDiscountBlock","getBrandsSelectorId","getPriceExclusive","showTaxBlock","showRemoveIcon","showTaxSelector","showBasePrice","getMeasureName","getMeasureCode","isTaxIncluded","getErrorsText","errorText","facebookFailProductErrorText","hasSku","FormCompilationType","FACEBOOK","FormHelpdeskCode","COMPILATION_FACEBOOK","COMMON_COMPILATION","compilationOptions","newLabel","Label","CATALOG_FORM_COMPILATION_PRODUCT_NEW_LABEL","color","LabelColor","PRIMARY","fill","popup","compilationLink","moreMessageButton","CATALOG_FORM_COMPILATION_INFO_BUTTON_MORE","Event","openHelpDesk","header","description","CATALOG_FORM_COMPILATION_INFO_MESSAGE_TITLE_FACEBOOK","CATALOG_FORM_COMPILATION_INFO_MESSAGE_BODY_FACEBOOK_FIRST_BLOCK","CATALOG_FORM_COMPILATION_INFO_MESSAGE_BODY_FACEBOOK_SECOND_BLOCK","CATALOG_FORM_COMPILATION_INFO_MESSAGE_TITLE","CATALOG_FORM_COMPILATION_INFO_MESSAGE_BODY_MARKETING_2","MessageCard","angle","hidden","actionElements","hideMessage","label","getLayout","hiddenInfoMessage","showMessage","helpdeskCode","showPopup","disabledSwitcher","Popup","setBindElement","qrLink","$store","getters","productIds","ownerId","ownerTypeId","dialogId","sessionId","link","emit","compilationId","content","getQRPopupContent","width","closeIcon","right","padding","closeByEsc","autoHide","cacheable","animation","offset","buttonCopy","CATALOG_FORM_COMPILATION_QR_COPY","clipboard","copy","UI","Notification","Center","notify","CATALOG_FORM_COMPILATION_QR_COPY_NOTIFY_MESSAGE","autoHideDelay","qrWrapper","CATALOG_FORM_COMPILATION_QR_POPUP_TITLE","CATALOG_FORM_COMPILATION_QR_POPUP_INPUT_TITLE","QRCode","height","setSetting","checked","getOnBeforeCreationStorePopupContent","loaderContent","node","loader","Loader","size","getOnAfterCreationStorePopupContent","creationStorePopup","continueButton","closeCreationStorePopup","onLabelClick","isLimitedStore","InfoHelper","onClickHint","preventDefault","stopImmediatePropagation","isShown","Dom","addClass","hintIcon","removeClass","showQrLink","Vuex","mapState","productList","settings","refreshBasket","changeBasketItem","addBasketItemForm","getInternalIndexByProductId","keys","findIndex","inx","parseInt","handleAddItem","skuType","json","variationId","priceId","urlBuilder","resetSku","processResponse","isAddAnyway","productData","newItem","MEASURE_RATIO","defaultDiscountType","addProduct","onUpdateBasketItem","removeEmptyItems","modifyBasketItem","showDialogProductExists","onPopupClose","destroy","zIndex","titleBar","draggable","resizable","lightShadow","overlay","buttons","getButtons","SaveButton","CancelButton","showDialogProductSearch","funcName","window","CDialog","content_url","Math","max","innerHeight","innerWidth","min_height","min_width","Show","dataset","settingId","Slider","open","getSettingItems","warehouseOption","getSettingItem","disabled","hintNode","setting","Hint","init","CATALOG_FORM_ADD_SHOW_DISCOUNTS_OPTION","CATALOG_FORM_ADD_SHOW_WAREHOUSE_OPTION","CATALOG_FORM_ADD_SHOW_WAREHOUSE_HINT","prepareSettingsContent","append","showConfigPopup","offsetLeft","offsetTop","noAllPaddings","bindOptions","forceBindPosition","openSlider","url","allowChangeHistory","isString","onClose","getSlider","SidePanel","Instance","order","changeProduct","emitErrorsChange","removeProduct","showTaxResult","showResults","showButtonsTop","singleProductMode","buttonsPosition","showButtonsBottom","showResultBlock","enableAddButtons","totalResultLabel","CATALOG_FORM_TOTAL_RESULT","ProductForm","constructor","prepareOptions","defaultOptions","wrapper","initStore","initTemplate","showError","builder","VuexBuilder","addModel","create","build","settingsCollection","Extension","getSettings","get","showCompilationModeSwitcher","pricePrecision","newItemPosition","compilationFormType","compilationFormOption","hasStore","layout","store","templateEngine","BitrixVue","createApp","el","setData","loadCurrencyFormat","totals","option","formBasket","itemPosition","basketIndex","optionName","configName","getTotal","setEditable","hasErrors","errorItems","console","compilationRequiredFields"],"mappings":";;;;CAAO,MAAMA,mBAAN,CACP;CADaA,oBAELC,MAAc;CAFTD,oBAGLE,SAAiB;;CCMlB,MAAMC,WAAN,SAA0BC,4BAA1B,CACP;CACC;CACD;CACA;CACCC,EAAAA,OAAO,GACP;CACC,WAAO,aAAP;CACA;;CAEDC,EAAAA,QAAQ,GACR;CACC,WAAO;CACNC,MAAAA,QAAQ,EAAE,EADJ;CAENC,MAAAA,WAAW,EAAE,GAFP;CAGNC,MAAAA,MAAM,EAAE,EAHF;CAINC,MAAAA,KAAK,EAAE;CACNC,QAAAA,GAAG,EAAE,CADC;CAENC,QAAAA,QAAQ,EAAE,CAFJ;CAGNC,QAAAA,MAAM,EAAE,CAHF;CAINC,QAAAA,MAAM,EAAE;CAJF;CAJD,KAAP;CAWA;;CAEoB,SAAdC,cAAc,GACrB;CACC,UAAMC,MAAM,GAAGC,cAAI,CAACC,SAAL,EAAf;CACA,WAAO;CACNC,MAAAA,OAAO,EAAE,IADH;CAENC,MAAAA,UAAU,EAAEJ,MAFN;CAGNK,MAAAA,MAAM,EAAE;CACPC,QAAAA,OAAO,EAAEN,MADF;CAEPO,QAAAA,SAAS,EAAE,IAFJ;CAGPC,QAAAA,KAAK,EAAE,IAHA;CAIPC,QAAAA,IAAI,EAAE,IAJC;CAKPC,QAAAA,MAAM,EAAE,IALD;CAMPC,QAAAA,IAAI,EAAE,CANC;CAOPC,QAAAA,KAAK,EAAE,IAPA;CAQPC,QAAAA,SAAS,EAAE,IARJ;CASPC,QAAAA,cAAc,EAAE,IATT;CAUPC,QAAAA,QAAQ,EAAE,CAVH;CAWPC,QAAAA,IAAI,EAAE,EAXC;CAYPpB,QAAAA,QAAQ,EAAE,CAZH;CAaPqB,QAAAA,YAAY,EAAE,CAbP;CAcPC,QAAAA,aAAa,EAAE,EAdR;CAePC,QAAAA,YAAY,EAAEC,sCAAY,CAACC,UAfpB;CAgBPC,QAAAA,GAAG,EAAE,CAhBE;CAiBPzB,QAAAA,MAAM,EAAE,CAjBD;CAkBPL,QAAAA,WAAW,EAAE,GAlBN;CAmBP+B,QAAAA,WAAW,EAAE,CAnBN;CAoBPC,QAAAA,WAAW,EAAE,EApBN;CAqBPC,QAAAA,YAAY,EAAE,CArBP;CAsBPC,QAAAA,aAAa,EAAE,GAtBR;CAuBPC,QAAAA,gBAAgB,EAAE,EAvBX;CAwBPC,QAAAA,UAAU,EAAE,EAxBL;CAyBPC,QAAAA,MAAM,EAAE;CAzBD,OAHF;CA8BNC,MAAAA,gBAAgB,EAAE,EA9BZ;CA+BNC,MAAAA,aAAa,EAAE,EA/BT;CAgCNC,MAAAA,YAAY,EAAE,GAhCR;CAiCNC,MAAAA,OAAO,EAAE,GAjCH;CAkCNC,MAAAA,OAAO,EAAE,EAlCH;CAmCNC,MAAAA,KAAK,EAAE,IAnCD;CAoCNxC,MAAAA,GAAG,EAAE,CApCC;CAqCNyC,MAAAA,YAAY,EAAE,IArCR;CAsCNC,MAAAA,WAAW,EAAE,CAtCP;CAuCNC,MAAAA,SAAS,EAAE,EAvCL;CAwCNC,MAAAA,aAAa,EAAE,IAxCT;CAyCNC,MAAAA,MAAM,EAAE;CAzCF,KAAP;CA2CA;;CAEDC,EAAAA,UAAU,GACV;CACC,WAAO;CACNC,MAAAA,WAAW,CAAE;CAACC,QAAAA;CAAD,OAAF,EACX;CACCA,QAAAA,MAAM,CAAC,aAAD,CAAN;CACAA,QAAAA,MAAM,CAAC,SAAD,EAAY,EAAZ,CAAN;CACA,OALK;;CAMNC,MAAAA,UAAU,CAAC;CAACC,QAAAA,QAAD;CAAWF,QAAAA,MAAX;CAAmBG,QAAAA;CAAnB,OAAD,EAA4BC,OAA5B,EACV;CACCJ,QAAAA,MAAM,CAAC,YAAD,EAAeI,OAAf,CAAN;;CACA,YAAID,KAAK,CAACrD,MAAN,CAAauD,MAAb,KAAwB,CAA5B,EACA;CACCL,UAAAA,MAAM,CAAC,SAAD,EAAY,EAAZ,CAAN;CACA,SAHD,MAKA;CACCG,UAAAA,KAAK,CAACrD,MAAN,CAAawD,OAAb,CAAqB,CAACC,IAAD,EAAOC,CAAP,KAAa;CACjCR,YAAAA,MAAM,CAAC,YAAD,EAAe;CACpBS,cAAAA,KAAK,EAAED,CADa;CAEpB9C,cAAAA,MAAM,EAAE;CAACM,gBAAAA,IAAI,EAAEwC;CAAP;CAFY,aAAf,CAAN;CAIA,WALD;CAMA;;CACDN,QAAAA,QAAQ,CAAC,gBAAD,CAAR;CACA,OAvBK;;CAwBNQ,MAAAA,UAAU,EAAE,CAAC;CAACR,QAAAA,QAAD;CAAWF,QAAAA;CAAX,OAAD,EAAqBI,OAArB,KACZ;CACCJ,QAAAA,MAAM,CAAC,YAAD,EAAeI,OAAf,CAAN;CACAF,QAAAA,QAAQ,CAAC,gBAAD,CAAR;CACA,OA5BK;CA6BNS,MAAAA,WAAW,EAAE,CAAC;CAACX,QAAAA;CAAD,OAAD,EAAWI,OAAX,KACb;CACC,cAAMxD,WAAQ,GAAGwD,OAAO,IAAI,EAA5B;CACAJ,QAAAA,MAAM,CAAC,aAAD,EAAgBpD,WAAhB,CAAN;CACA,OAjCK;CAkCNgE,MAAAA,OAAO,EAAE,CAAC;CAACV,QAAAA,QAAD;CAAWF,QAAAA;CAAX,OAAD,EAAqBI,OAArB,KACT;CACC,cAAMG,IAAI,GAAGH,OAAO,CAACG,IAAR,IAAgB;CAAC7C,UAAAA,MAAM,EAAE;CAAT,SAA7B;CACAsC,QAAAA,MAAM,CAAC,SAAD,EAAY;CACjBO,UAAAA,IADiB;CAEjBM,UAAAA,QAAQ,EAAET,OAAO,CAACS,QAAR,IAAoBxE,mBAAmB,CAACC;CAFjC,SAAZ,CAAN;CAIA4D,QAAAA,QAAQ,CAAC,gBAAD,CAAR;CACA,OA1CK;CA2CNY,MAAAA,cAAc,EAAE,CAAC;CAACd,QAAAA,MAAD;CAASG,QAAAA;CAAT,OAAD,KAChB;CACC,cAAMpD,KAAK,GAAG;CACbC,UAAAA,GAAG,EAAE,CADQ;CAEbE,UAAAA,MAAM,EAAE,CAFK;CAGbD,UAAAA,QAAQ,EAAE,CAHG;CAIbE,UAAAA,MAAM,EAAE;CAJK,SAAd;CAOAgD,QAAAA,KAAK,CAACrD,MAAN,CAAawD,OAAb,CAAsBC,IAAD,IAAU;CAC9B,gBAAMrC,SAAS,GAAGZ,cAAI,CAACyD,QAAL,CAAcR,IAAI,CAAC7C,MAAL,CAAYQ,SAAZ,IAAyB,CAAvC,CAAlB;CACA,gBAAME,QAAQ,GAAGd,cAAI,CAACyD,QAAL,CAAcR,IAAI,CAAC7C,MAAL,CAAYU,QAAZ,IAAwB,CAAtC,CAAjB;CACA,gBAAMnB,QAAQ,GAAGK,cAAI,CAACyD,QAAL,CAAcR,IAAI,CAAC7C,MAAL,CAAYT,QAAZ,IAAwB,CAAtC,CAAjB;CACA,gBAAMC,MAAM,GAAGI,cAAI,CAACyD,QAAL,CAAcR,IAAI,CAAC7C,MAAL,CAAYR,MAAZ,IAAsB,CAApC,CAAf;CACAH,UAAAA,KAAK,CAACC,GAAN,IAAakB,SAAS,GAAGE,QAAzB;CACArB,UAAAA,KAAK,CAACI,MAAN,IAAgBG,cAAI,CAACyD,QAAL,CAAcR,IAAI,CAACvD,GAAnB,CAAhB;CACAD,UAAAA,KAAK,CAACE,QAAN,IAAkBA,QAAQ,GAAGmB,QAA7B;CACArB,UAAAA,KAAK,CAACG,MAAN,IAAgBA,MAAM,GAAGkB,QAAzB;CACA,SATD;CAWArB,QAAAA,KAAK,CAACE,QAAN,GAAkBF,KAAK,CAACE,QAAN,GAAiBF,KAAK,CAACC,GAAxB,GAA+BD,KAAK,CAACC,GAArC,GAA2CD,KAAK,CAACE,QAAlE;CAEA+C,QAAAA,MAAM,CAAC,UAAD,EAAajD,KAAb,CAAN;CACA;CAlEK,KAAP;CAoEA;;CAEDiE,EAAAA,UAAU,GACV;CACC,WAAO;CACNC,MAAAA,SAAS,EAAEd,KAAK,IAAI,MACpB;CACC,eAAOA,KAAK,CAACrD,MAAb;CACA,OAJK;CAKNM,MAAAA,cAAc,EAAE,MAAM,MACtB;CACC,eAAOZ,WAAW,CAACY,cAAZ,EAAP;CACA;CARK,KAAP;CAUA;;CAED8D,EAAAA,YAAY,GACZ;CACC,WAAO;CACNN,MAAAA,OAAO,EAAE,CAACT,KAAD,EAAQC,OAAR,KACT;CACC,YAAIG,IAAI,GAAG/D,WAAW,CAACY,cAAZ,EAAX;CAEAmD,QAAAA,IAAI,GAAGY,MAAM,CAACC,MAAP,CAAcb,IAAd,EAAoBH,OAAO,CAACG,IAA5B,CAAP;;CACA,YAAIH,OAAO,CAACS,QAAR,KAAqBxE,mBAAmB,CAACE,MAA7C,EACA;CACC4D,UAAAA,KAAK,CAACrD,MAAN,CAAauE,IAAb,CAAkBd,IAAlB;CACA,SAHD,MAKA;CACCJ,UAAAA,KAAK,CAACrD,MAAN,CAAawE,OAAb,CAAqBf,IAArB;CACA;;CAEDJ,QAAAA,KAAK,CAACrD,MAAN,CAAawD,OAAb,CAAqB,CAACC,IAAD,EAAOE,KAAP,KAAiB;CACrCF,UAAAA,IAAI,CAAC7C,MAAL,CAAYM,IAAZ,GAAmByC,KAAnB;CACA,SAFD;CAGA,OAlBK;CAmBNc,MAAAA,UAAU,EAAE,CAACpB,KAAD,EAAQC,OAAR,KACZ;CACC,YAAIoB,cAAI,CAACC,KAAL,CAAWtB,KAAK,CAACrD,MAAN,CAAasD,OAAO,CAACK,KAArB,CAAX,CAAJ,EACA;CACCiB,UAAAA,UAAG,CAACC,GAAJ,CAAQxB,KAAK,CAACrD,MAAd,EAAsBsD,OAAO,CAACK,KAA9B,EAAqCjE,WAAW,CAACY,cAAZ,EAArC;CACA;;CAED+C,QAAAA,KAAK,CAACrD,MAAN,CAAasD,OAAO,CAACK,KAArB,IAA8BU,MAAM,CAACC,MAAP,CAC7BjB,KAAK,CAACrD,MAAN,CAAasD,OAAO,CAACK,KAArB,CAD6B,EAE7BL,OAAO,CAACwB,OAFqB,CAA9B;CAIA,OA9BK;CA+BNC,MAAAA,WAAW,EAAG1B,KAAD,IACb;CACCA,QAAAA,KAAK,CAACrD,MAAN,GAAe,EAAf;CACA,OAlCK;CAmCNgF,MAAAA,UAAU,EAAE,CAAC3B,KAAD,EAAQC,OAAR,KACZ;CACCD,QAAAA,KAAK,CAACrD,MAAN,CAAaiF,MAAb,CAAoB3B,OAAO,CAACK,KAA5B,EAAmC,CAAnC;CACAN,QAAAA,KAAK,CAACrD,MAAN,CAAawD,OAAb,CAAqB,CAACC,IAAD,EAAOE,KAAP,KAAiB;CACrCF,UAAAA,IAAI,CAAC7C,MAAL,CAAYM,IAAZ,GAAmByC,KAAnB;CACA,SAFD;CAGA,OAzCK;CA0CNuB,MAAAA,SAAS,EAAE,CAAC7B,KAAD,EAAQC,OAAR,KACX;CACCD,QAAAA,KAAK,CAACN,MAAN,GAAeO,OAAf;CACA,OA7CK;CA8CN6B,MAAAA,WAAW,EAAG9B,KAAD,IACb;CACCA,QAAAA,KAAK,CAACN,MAAN,GAAe,EAAf;CACA,OAjDK;CAkDNc,MAAAA,WAAW,EAAE,CAACR,KAAD,EAAQC,OAAR,KACb;CACCD,QAAAA,KAAK,CAACvD,QAAN,GAAiBwD,OAAjB;CACA,OArDK;CAsDN8B,MAAAA,QAAQ,EAAE,CAAC/B,KAAD,EAAQC,OAAR,KACV;CACC,cAAM+B,cAAc,GAAG/B,OAAvB;;CACA,YAAIoB,cAAI,CAACY,cAAL,CAAoBjC,KAAK,CAACvD,QAA1B,CAAJ,EACA;CACC,eAAK,MAAMyF,GAAX,IAAkBjC,OAAlB,EACA;CACC,gBAAIA,OAAO,CAACkC,cAAR,CAAuBD,GAAvB,CAAJ,EACA;CACCF,cAAAA,cAAc,CAACE,GAAD,CAAd,GAAsBE,kCAAY,CAACC,cAAb,CAA4BpC,OAAO,CAACiC,GAAD,CAAnC,EAA0ClC,KAAK,CAACvD,QAAhD,CAAtB;CACA;CACD;CACD;;CAEDuD,QAAAA,KAAK,CAACpD,KAAN,GAAcoE,MAAM,CAACC,MAAP,CACbjB,KAAK,CAACpD,KADO,EAEboF,cAFa,CAAd;CAIA;CAxEK,KAAP;CA0EA;;CA1OF;;CCVO,MAAMM,MAAM,GAAGtB,MAAM,CAACuB,MAAP,CAAc;CACnCC,EAAAA,cAAc,EAAE;CACftE,IAAAA,IAAI,EAAE;CADS,GADmB;CAInCuE,EAAAA,YAAY,EAAE,SAJqB;CAKnCC,EAAAA,oBAAoB,EAAE,kBALa;CAMnCC,EAAAA,wBAAwB,EAAE,sBANS;CAOnCC,EAAAA,eAAe,EAAE,aAPkB;CAQnCC,EAAAA,2BAA2B,EAAE,0BARM;CASnCC,EAAAA,kBAAkB,EAAE,gBATe;CAUnCC,EAAAA,sBAAsB,EAAE,qBAVW;CAWnCC,EAAAA,qBAAqB,EAAE,mBAXY;CAYnCC,EAAAA,qBAAqB,EAAE,mBAZY;CAanCC,EAAAA,gBAAgB,EAAE,cAbiB;CAcnCC,EAAAA,kBAAkB,EAAE,gBAde;CAenCC,EAAAA,QAAQ,EAAE;CAfyB,CAAd,CAAf;;CCAA,MAAMC,aAAN,CACP;CADaA,cAELC,mBAAmB;CAFdD,cAGLE,eAAe;CAHVF,cAILG,WAAW;CAJNH,cAKLI,QAAQ;CALHJ,cAMLK,SAAS;CANJL,cAOLM,WAAW;CAPNN,cAQLO,MAAM;CARDP,cASLQ,QAAQ;CATHR,cAULS,UAAU;;CCVX,MAAMC,aAAN,CACP;CADaA,cAELC,yBAAyB;CAFpBD,cAGLE,cAAc;CAHTF,cAILG,iBAAiB;CAJZH,cAKLI,cAAc;CALTJ,cAMLK,cAAc;CANTL,cAOLM,oBAAoB;;CCPrB,MAAMC,QAAN,CACP;CADaA,SAELC,UAAkB;CAFbD,SAGLE,YAAoB;CAHfF,SAILG,cAAsB;CAJjBH,SAKLI,wBAAgC;;ACCxCnD,WAAG,CAACoD,SAAJ,CAAcrC,MAAM,CAACU,qBAArB,EACA;CACC;CACD;CACA;CACA;CAEC4B,EAAAA,KAAK,EAAE;CACNnG,IAAAA,WAAW,EAAEoG,MADP;CAENlG,IAAAA,YAAY,EAAEkG,MAFR;CAGNnG,IAAAA,WAAW,EAAEoG,MAHP;CAIN7G,IAAAA,QAAQ,EAAE4G,MAJJ;CAKNE,IAAAA,QAAQ,EAAEC,OALJ;CAMNC,IAAAA,eAAe,EAAED,OANX;CAONE,IAAAA,QAAQ,EAAEF,OAPJ;CAQNG,IAAAA,OAAO,EAAEnE;CARH,GANR;;CAgBCoE,EAAAA,OAAO,GACP;CACC,SAAKC,sBAAL,GAA8BC,iBAAO,CAACC,QAAR,CAAiB,KAAKC,eAAtB,EAAuC,GAAvC,EAA4C,IAA5C,CAA9B;CACA,GAnBF;;CAoBCC,EAAAA,OAAO,EACP;CACCD,IAAAA,eAAe,CAACE,KAAD,EACf;CACC,UAAI,CAAC,KAAKX,QAAV,EACA;CACC;CACA;;CAEDW,MAAAA,KAAK,CAACC,MAAN,CAAaC,KAAb,GAAqBF,KAAK,CAACC,MAAN,CAAaC,KAAb,CAAmBC,OAAnB,CAA2B,SAA3B,EAAqC,GAArC,CAArB;CACA,YAAMC,WAAW,GAAG3I,cAAI,CAACyD,QAAL,CAAc8E,KAAK,CAACC,MAAN,CAAaC,KAA3B,CAApB;CACA,YAAMG,UAAU,GAAGL,KAAK,CAACC,MAAN,CAAaC,KAAb,CAAmBI,MAAnB,CAA0B,CAAC,CAA3B,CAAnB;;CAEA,UAAID,UAAU,KAAK,GAAnB,EACA;CACC;CACA;;CAED,WAAKE,cAAL,CAAoBH,WAApB;CACA,KAlBF;;CAmBCI,IAAAA,yBAAyB,CAACjI,QAAD,EAAWU,YAAX,EACzB;CACC,UAAIwH,gBAAgB,GAAGlI,QAAvB;CACA,UAAImI,aAAa,GAAGzH,YAApB;CACA,UAAI0H,gBAAgB,GAAG,CAAvB;;CAEA,aAAO,EAAExB,MAAM,CAACyB,SAAP,CAAiBH,gBAAjB,KAAsCtB,MAAM,CAACyB,SAAP,CAAiBF,aAAjB,CAAxC,CAAP,EACA;CACCC,QAAAA,gBAAgB,IAAI,EAApB;CACAF,QAAAA,gBAAgB,GAAGlI,QAAQ,GAAGoI,gBAA9B;CACAD,QAAAA,aAAa,GAAGzH,YAAY,GAAG0H,gBAA/B;CACA;;CAED,aAAOA,gBAAP;CACA,KAjCF;;CAkCCE,IAAAA,cAAc,GACd;CACC,UAAI,CAAC,KAAKxB,QAAV,EACA;CACC;CACA;;CAED,YAAMsB,gBAAgB,GAAG,KAAKH,yBAAL,CAA+B,KAAKjI,QAApC,EAA8C,KAAKU,YAAnD,CAAzB;CACA,YAAMV,QAAQ,GAAG,CAAC,KAAKA,QAAL,GAAgBoI,gBAAhB,GAAmC,KAAK1H,YAAL,GAAoB0H,gBAAxD,IAA4EA,gBAA7F;CACA,WAAKJ,cAAL,CAAoBhI,QAApB;CACA,KA5CF;;CA6CCuI,IAAAA,cAAc,GACd;CACC,UAAI,KAAKvI,QAAL,GAAgB,KAAKU,YAArB,IAAqC,KAAKoG,QAA9C,EACA;CACC,cAAMsB,gBAAgB,GAAG,KAAKH,yBAAL,CAA+B,KAAKjI,QAApC,EAA8C,KAAKU,YAAnD,CAAzB;CACA,cAAMV,QAAQ,GAAG,CAAC,KAAKA,QAAL,GAAgBoI,gBAAhB,GAAmC,KAAK1H,YAAL,GAAoB0H,gBAAxD,IAA4EA,gBAA7F;CACA,aAAKJ,cAAL,CAAoBhI,QAApB;CACA;CACD,KArDF;;CAsDCgI,IAAAA,cAAc,CAACL,KAAD,EACd;CACC,WAAKa,KAAL,CAAW,kBAAX,EAA+Bb,KAA/B;CACA,KAzDF;;CA0DCc,IAAAA,aAAa,CAACf,MAAD,EACb;CACC,UAAI,CAAC,KAAKZ,QAAN,IAAkB,CAAC1D,cAAI,CAACsF,OAAL,CAAa,KAAKxB,OAAL,CAAayB,QAA1B,CAAvB,EACA;CACC;CACA;;CAED,YAAMC,SAAS,GAAG,EAAlB;CACA,WAAK1B,OAAL,CAAayB,QAAb,CAAsBzG,OAAtB,CAA+BC,IAAD,IAAU;CACvCyG,QAAAA,SAAS,CAAC3F,IAAV,CAAe;CACd4F,UAAAA,IAAI,EAAE1G,IAAI,CAAC2G,MADG;CAEd3G,UAAAA,IAAI,EAAEA,IAFQ;CAGd4G,UAAAA,OAAO,EAAE,KAAKC;CAHA,SAAf;CAKA,OAND;;CASA,UAAIJ,SAAS,CAAC3G,MAAV,GAAmB,CAAvB,EACA;CACC,aAAKgH,SAAL,GAAiB,IAAIC,eAAJ,CAAS;CACzBC,UAAAA,WAAW,EAAEzB,MADY;CAEzB0B,UAAAA,KAAK,EAAER;CAFkB,SAAT,CAAjB;CAKA,aAAKK,SAAL,CAAeI,IAAf;CACA;CACD,KApFF;;CAqFCL,IAAAA,aAAa,CAACvB,KAAD,EAAmB6B,MAAnB,EACb;CAAA;;CACC,WAAKd,KAAL,CAAW,iBAAX,EAA8B;CAC7B9I,QAAAA,IAAI,qBAAE4J,MAAM,CAACpC,OAAT,qBAAE,gBAAgB/E,IAAhB,CAAqBoH,IADE;CAE7BtJ,QAAAA,IAAI,sBAAEqJ,MAAM,CAACpC,OAAT,qBAAE,iBAAgB/E,IAAhB,CAAqB2G;CAFE,OAA9B;;CAKA,UAAI,KAAKG,SAAT,EACA;CACC,aAAKA,SAAL,CAAeO,KAAf;CACA;CACD;;CAhGF,GArBD;CAuHC;CACAC,EAAAA,QAAQ,EAAG;;;;;;;;;;;;;;;;;CAxHZ,CADA;;ACDAnG,WAAG,CAACoD,SAAJ,CAAcrC,MAAM,CAACQ,kBAArB,EACA;CACC;CACD;CACA;CACA;CAEC8B,EAAAA,KAAK,EAAE;CACNtH,IAAAA,UAAU,EAAEwH,MADN;CAENhH,IAAAA,KAAK,EAAE+G,MAFD;CAGNE,IAAAA,QAAQ,EAAEC,OAHJ;CAINE,IAAAA,QAAQ,EAAEF,OAJJ;CAKNG,IAAAA,OAAO,EAAEnE;CALH,GANR;;CAaCoE,EAAAA,OAAO,GACP;CACC,SAAKuC,mBAAL,GAA2BrC,iBAAO,CAACC,QAAR,CAAiB,KAAKqC,YAAtB,EAAoC,GAApC,EAAyC,IAAzC,CAA3B;CACA,GAhBF;;CAiBCnC,EAAAA,OAAO,EACP;CACCmC,IAAAA,YAAY,CAAClC,KAAD,EACZ;CACC,UAAI,CAAC,KAAKX,QAAV,EACA;CACC;CACA;;CAEDW,MAAAA,KAAK,CAACC,MAAN,CAAaC,KAAb,GAAqBF,KAAK,CAACC,MAAN,CAAaC,KAAb,CAAmBC,OAAnB,CAA2B,UAA3B,EAAsC,EAAtC,CAArB;;CACA,UAAIH,KAAK,CAACC,MAAN,CAAaC,KAAb,KAAuB,EAA3B,EACA;CACCF,QAAAA,KAAK,CAACC,MAAN,CAAaC,KAAb,GAAqB,CAArB;CACA;;CACD,YAAMG,UAAU,GAAGL,KAAK,CAACC,MAAN,CAAaC,KAAb,CAAmBI,MAAnB,CAA0B,CAAC,CAA3B,CAAnB;;CACA,UAAID,UAAU,KAAK,GAAnB,EACA;CACCL,QAAAA,KAAK,CAACC,MAAN,CAAaC,KAAb,GAAqBF,KAAK,CAACC,MAAN,CAAaC,KAAb,CAAmBC,OAAnB,CAA2B,GAA3B,EAAgC,GAAhC,CAArB;CACA;;CAED,UAAIgC,QAAQ,GAAG1K,cAAI,CAACyD,QAAL,CAAc8E,KAAK,CAACC,MAAN,CAAaC,KAA3B,CAAf;;CACA,UAAIG,UAAU,KAAK,GAAf,IAAsBA,UAAU,KAAK,GAAzC,EACA;CACC;CACA;;CAED,UAAI8B,QAAQ,GAAG,CAAf,EACA;CACCA,QAAAA,QAAQ,IAAI,CAAC,CAAb;CACA;;CAED,WAAKpB,KAAL,CAAW,eAAX,EAA4BoB,QAA5B;CACA;;CA/BF,GAlBD;CAmDCC,EAAAA,QAAQ,EACR;CACCC,IAAAA,QAAQ,GACR;CACC,aAAOxG,UAAG,CAACyG,kBAAJ,CAAuB,UAAvB,CAAP;CACA,KAJF;;CAKCC,IAAAA,cAAc,GACd;CACC,aAAO,KAAK9C,OAAL,CAAa8C,cAAb,IAA+B,EAAtC;CACA;;CARF,GApDD;CA8DC;CACAP,EAAAA,QAAQ,EAAG;;;;;;;;;;;CA/DZ,CADA;;ACCAnG,WAAG,CAACoD,SAAJ,CAAcrC,MAAM,CAACW,qBAArB,EACA;CACC;CACD;CACA;CACA;CAEC2B,EAAAA,KAAK,EAAE;CACNG,IAAAA,QAAQ,EAAEC,OADJ;CAENG,IAAAA,OAAO,EAAEnE,MAFH;CAGNlE,IAAAA,QAAQ,EAAE+H,MAHJ;CAINxG,IAAAA,YAAY,EAAEwG,MAJR;CAKN1G,IAAAA,YAAY,EAAE0G;CALR,GANR;;CAaCO,EAAAA,OAAO,GACP;CACC,SAAK8C,eAAL,GAAuB5C,iBAAO,CAACC,QAAR,CAAiB,KAAK4C,gBAAtB,EAAwC,GAAxC,EAA6C,IAA7C,CAAvB;CACA,SAAKF,cAAL,GAAsB,KAAK9C,OAAL,CAAa8C,cAAnC;CACA,GAjBF;;CAkBCxC,EAAAA,OAAO,EACP;CACC2C,IAAAA,YAAY,CAAC1C,KAAD,EAAQ6B,MAAR,EACZ;CAAA;;CACC,UAAI,CAAC,KAAKxC,QAAV,EACA;CACC;CACA;;CAED,YAAMsD,IAAI,GAAIlL,cAAI,CAACyD,QAAL,CAAc2G,MAAd,uCAAcA,MAAM,CAAEpC,OAAtB,qBAAc,gBAAiBkD,IAA/B,MAAyC/J,sCAAY,CAACgK,QAAvD,GAAoEhK,sCAAY,CAACgK,QAAjF,GAA4FhK,sCAAY,CAACC,UAAtH;CACA,WAAKkI,KAAL,CAAW,oBAAX,EAAiC4B,IAAjC;;CAEA,UAAI,KAAKnB,SAAT,EACA;CACC,aAAKA,SAAL,CAAeO,KAAf;CACA;CACD,KAfF;;CAgBCU,IAAAA,gBAAgB,CAACzC,KAAD,EAChB;CACC,YAAM6C,aAAa,GAAGpL,cAAI,CAACyD,QAAL,CAAc8E,KAAK,CAACC,MAAN,CAAaC,KAA3B,KAAqC,CAA3D;;CACA,UAAI2C,aAAa,KAAKpL,cAAI,CAACyD,QAAL,CAAc,KAAK9D,QAAnB,CAAlB,IAAkD,CAAC,KAAKiI,QAA5D,EACA;CACC;CACA;;CAED,WAAK0B,KAAL,CAAW,gBAAX,EAA6B8B,aAA7B;CACA,KAzBF;;CA0BC7B,IAAAA,aAAa,CAACf,MAAD,EACb;CACC,UAAI,CAAC,KAAKZ,QAAN,IAAkB,CAAC1D,cAAI,CAACsF,OAAL,CAAa,KAAKxB,OAAL,CAAaqD,oBAA1B,CAAvB,EACA;CACC;CACA;;CAED,YAAM3B,SAAS,GAAG,EAAlB;;CACA,UAAI,KAAK1B,OAAL,CAAaqD,oBAAb,CAAkCC,QAAlC,CAA2CnK,sCAAY,CAACC,UAAxD,CAAJ,EACA;CACCsI,QAAAA,SAAS,CAAC3F,IAAV,CAAe;CACd4F,UAAAA,IAAI,EAAE,GADQ;CAEdE,UAAAA,OAAO,EAAE,KAAKoB,YAFA;CAGdC,UAAAA,IAAI,EAAE/J,sCAAY,CAACC;CAHL,SAAf;CAKA;;CAED,UAAI,KAAK4G,OAAL,CAAaqD,oBAAb,CAAkCC,QAAlC,CAA2CnK,sCAAY,CAACgK,QAAxD,CAAJ,EACA;CACCzB,QAAAA,SAAS,CAAC3F,IAAV,CAAe;CACd4F,UAAAA,IAAI,EAAE,KAAKmB,cADG;CAEdjB,UAAAA,OAAO,EAAE,KAAKoB,YAFA;CAGdC,UAAAA,IAAI,EAAE/J,sCAAY,CAACgK;CAHL,SAAf;CAKA;;CAED,UAAIzB,SAAS,CAAC3G,MAAV,GAAmB,CAAvB,EACA;CACC,aAAKgH,SAAL,GAAiB,IAAIC,eAAJ,CAAS;CACzBC,UAAAA,WAAW,EAAEzB,MADY;CAEzB0B,UAAAA,KAAK,EAAER;CAFkB,SAAT,CAAjB;CAKA,aAAKK,SAAL,CAAeI,IAAf;CACA;CACD;;CA7DF,GAnBD;CAkFCQ,EAAAA,QAAQ,EAAE;CACTY,IAAAA,qBAAqB,GACrB;CACC,UAAIvL,cAAI,CAACyD,QAAL,CAAc,KAAKvC,YAAnB,MAAqCC,sCAAY,CAACC,UAAtD,EACA;CACC,eAAOpB,cAAI,CAACyD,QAAL,CAAc,KAAKzC,YAAnB,CAAP;CACA;;CACD,aAAOhB,cAAI,CAACyD,QAAL,CAAc,KAAK9D,QAAnB,CAAP;CACA,KARQ;;CAST6L,IAAAA,iBAAiB,GACjB;CACC,aAAOxL,cAAI,CAACyD,QAAL,CAAc,KAAKvC,YAAnB,MAAqCC,sCAAY,CAACC,UAAlD,GAA+D,GAA/D,GAAqE,KAAK0J,cAAjF;CACA;;CAZQ,GAlFX;CAgGC;CACAP,EAAAA,QAAQ,EAAG;;;;;;;;;;;;;;;;CAjGZ,CADA;;ACDAnG,WAAG,CAACoD,SAAJ,CAAcrC,MAAM,CAACY,gBAArB,EACA;CACC;CACD;CACA;CAEC0B,EAAAA,KAAK,EAAE;CACNgE,IAAAA,KAAK,EAAE/D,MADD;CAENE,IAAAA,QAAQ,EAAEC,OAFJ;CAGNG,IAAAA,OAAO,EAAEnE;CAHH,GALR;;CAUC6H,EAAAA,IAAI,GACJ;CACC,WAAO;CACNC,MAAAA,QAAQ,EAAE,KAAKC,UAAL,GAAkB,KAAKH,KAAvB,KAAiC;CADrC,KAAP;CAGA,GAfF;;CAgBCnD,EAAAA,OAAO,EACP;CACCuD,IAAAA,aAAa,CAACtD,KAAD,EAAQ6B,MAAR,EACb;CAAA;;CACC,YAAMuB,QAAQ,GAAG3L,cAAI,CAACyD,QAAL,CAAc2G,MAAd,uCAAcA,MAAM,CAAEpC,OAAtB,qBAAc,gBAAiB/E,IAA/B,CAAjB;;CACA,UAAI0I,QAAQ,KAAK3L,cAAI,CAACyD,QAAL,CAAc,KAAKkI,QAAnB,CAAb,IAA6C,CAAC,KAAK/D,QAAvD,EACA;CACC;CACA;;CAED,WAAK0B,KAAL,CAAW,WAAX,EAAwB;CACvBqC,QAAAA,QADuB;CAEvBF,QAAAA,KAAK,EAAErB,MAAF,wCAAEA,MAAM,CAAEpC,OAAV,qBAAE,iBAAiB8D;CAFD,OAAxB;;CAKA,UAAI,KAAK/B,SAAT,EACA;CACC,aAAKA,SAAL,CAAeO,KAAf;CACA;CACD,KAlBF;;CAmBCsB,IAAAA,UAAU,GACV;CACC,aAAO1H,cAAI,CAACsF,OAAL,CAAa,KAAKxB,OAAL,CAAa+D,OAA1B,IAAqC,KAAK/D,OAAL,CAAa+D,OAAlD,GAA4D,EAAnE;CACA,KAtBF;;CAuBCxC,IAAAA,aAAa,CAACf,MAAD,EACb;CACC,UAAI,CAAC,KAAKZ,QAAN,IAAkB,CAAC1D,cAAI,CAACsF,OAAL,CAAa,KAAKxB,OAAL,CAAa+D,OAA1B,CAAvB,EACA;CACC;CACA;;CACD,YAAMrC,SAAS,GAAG,EAAlB;CACA,WAAK1B,OAAL,CAAa+D,OAAb,CAAqB/I,OAArB,CAA6B,CAACC,IAAD,EAAO6I,EAAP,KAAc;CAC1CpC,QAAAA,SAAS,CAAC3F,IAAV,CAAe;CACd+H,UAAAA,EADc;CAEdnC,UAAAA,IAAI,EAAE1G,IAAI,GAAG,GAFC;CAGdA,UAAAA,IAAI,EAAEA,IAHQ;CAId4G,UAAAA,OAAO,EAAE,KAAKgC;CAJA,SAAf;CAMA,OAPD;;CAUA,UAAInC,SAAS,CAAC3G,MAAV,GAAmB,CAAvB,EACA;CACC,aAAKgH,SAAL,GAAiB,IAAIC,eAAJ,CAAS;CACzBC,UAAAA,WAAW,EAAEzB,MADY;CAEzB0B,UAAAA,KAAK,EAAER;CAFkB,SAAT,CAAjB;CAKA,aAAKK,SAAL,CAAeI,IAAf;CACA;CACD;;CAjDF,GAjBD;CAoEC;CACAI,EAAAA,QAAQ,EAAG;;;;;;CArEZ,CADA;;ACGAnG,WAAG,CAACoD,SAAJ,CAAcrC,MAAM,CAACO,2BAArB,EACA;CACC;CACD;CACA;CAEC+B,EAAAA,KAAK,EAAE;CACNG,IAAAA,QAAQ,EAAEC,OADJ;CAENmE,IAAAA,YAAY,EAAEtE,MAFR;CAGNM,IAAAA,OAAO,EAAEnE,MAHH;CAINoI,IAAAA,UAAU,EAAEpI,MAJN;CAKNqI,IAAAA,KAAK,EAAErI;CALD,GALR;;CAYC6H,EAAAA,IAAI,GACJ;CACC,WAAO;CACNZ,MAAAA,cAAc,EAAE,IADV;CAENqB,MAAAA,eAAe,EAAE,IAFX;CAGNC,MAAAA,cAAc,EAAE,IAHV;CAINjM,MAAAA,UAAU,EAAE,KAAK8L,UAAL,CAAgB9L;CAJtB,KAAP;CAMA,GApBF;;CAqBC8H,EAAAA,OAAO,GACP;CACCoE,IAAAA,6BAAY,CAACC,SAAb,CAAuB,4CAAvB,EAAqE,KAAKC,eAAL,CAAqBC,IAArB,CAA0B,IAA1B,CAArE;CACAH,IAAAA,6BAAY,CAACC,SAAb,CAAuB,qCAAvB,EAA8D,KAAKG,eAAL,CAAqBD,IAArB,CAA0B,IAA1B,CAA9D;CACAH,IAAAA,6BAAY,CAACC,SAAb,CAAuB,oCAAvB,EAA6D,KAAKI,cAAL,CAAoBF,IAApB,CAAyB,IAAzB,CAA7D;CACAH,IAAAA,6BAAY,CAACC,SAAb,CAAuB,KAAKK,KAAL,CAAWC,IAAlC,EAAwC,yBAAxC,EAAmE,KAAKC,iCAAL,CAAuCL,IAAvC,CAA4C,IAA5C,CAAnE;CACA,GA3BF;;CA4BCM,EAAAA,OAAO,GACP;CACC,SAAKX,eAAL,GAAuB,IAAIY,uCAAJ,CAAoB,KAAK5M,UAAzB,EAAqC,KAAK6M,qBAAL,EAArC,CAAvB;CACA,SAAKb,eAAL,CAAqBc,QAArB,CAA8B,KAAKC,KAAL,CAAWC,eAAzC;CACA,GAhCF;;CAiCC7E,EAAAA,OAAO,EACP;CACCuE,IAAAA,iCAAiC,CAACtE,KAAD,EACjC;CAAA;;CACC,YAAM6E,iBAAiB,qBAAG7E,KAAK,CAAC8E,OAAN,EAAH,qBAAG,eAAiBD,iBAA3C;CACA,YAAME,cAAc,sBAAG/E,KAAK,CAAC8E,OAAN,EAAH,qBAAG,gBAAiBC,cAAxC;CAEA,WAAKnB,eAAL,CAAqBoB,SAArB,CACC,2BADD,EAECH,iBAAiB,IAAIE,cAFtB;CAKA,WAAKnB,eAAL,CAAqBqB,oBAArB;CACA,WAAKrB,eAAL,CAAqBsB,YAArB;CACA,KAbF;;CAcCT,IAAAA,qBAAqB,GACrB;CACC,YAAM5M,MAAM,GAAG;CACdsN,QAAAA,IAAI,EAAE,KAAKC,QAAL,CAAc,MAAd,KAAyB;CADjB,OAAf;;CAIA,UAAI,CAACzJ,cAAI,CAACC,KAAL,CAAW,KAAKwJ,QAAL,CAAc,WAAd,CAAX,CAAL,EACA;CACCvN,QAAAA,MAAM,CAACkG,KAAP,GAAe,KAAKqH,QAAL,CAAc,WAAd,CAAf;CACAvN,QAAAA,MAAM,CAACwN,QAAP,GAAkB,KAAK5F,OAAL,CAAa1I,QAA/B;CACA;;CAED,YAAMuO,iBAAiB,GAAG,KAAK5B,UAAL,CAAgB/L,OAA1C;CACA,YAAM4N,oBAAoB,GAAG,KAAK9F,OAAL,CAAa8F,oBAA1C;CACA,YAAMC,gBAAgB,GACrB7J,cAAI,CAAC8J,QAAL,CAAcF,oBAAd,KACGA,oBAAoB,CAAC9I,cAArB,CAAoC6I,iBAApC,CAFJ;CAKA,YAAMI,eAAe,GAAG;CACvBC,QAAAA,QAAQ,EAAE,KAAKlG,OAAL,CAAakG,QADA;CAEvBC,QAAAA,WAAW,EAAE,KAAKnG,OAAL,CAAamG,WAFH;CAGvB7O,QAAAA,QAAQ,EAAE,KAAK0I,OAAL,CAAa1I,QAHA;CAIvB2C,QAAAA,OAAO,EAAE,KAAKmM,iBAAL,EAJc;CAKvBC,QAAAA,WAAW,EAAE,EALU;CAMvBC,QAAAA,eAAe,EAAE,EANM;CAOvBC,QAAAA,SAAS,EAAE,EAPY;CAQvBrC,QAAAA,KAAK,EAAE,KAAKA,KARW;CASvB/G,QAAAA,MAAM,EAAE;CACPqJ,UAAAA,WAAW,EAAE,KAAKvC,UAAL,CAAgB5J,SAAhB,IAA6B,EADnC;CAEPoM,UAAAA,aAAa,EAAE,IAFR;CAGPC,UAAAA,wBAAwB,EAAE,IAHnB;CAIPC,UAAAA,0BAA0B,EAAE,IAJrB;CAKPC,UAAAA,0BAA0B,EAAE,KAAK5G,OAAL,CAAa6G,uBAAb,IAAwC,KAAKC,eAAL,CAAqB5I,aAAa,CAACC,gBAAnC,CAL7D;CAMP4I,UAAAA,yBAAyB,EAAE,KAAKD,eAAL,CAAqB5I,aAAa,CAACE,YAAnC,CANpB;CAOP4I,UAAAA,MAAM,EAAE,KAAK7O,UAPN;CAQP8O,UAAAA,oBAAoB,EAAE,KAAKrH,QARpB;CASPsH,UAAAA,qBAAqB,EAAE,KAAKlH,OAAL,CAAamH,wBAT7B;CAUPC,UAAAA,mBAAmB,EAAE,KAAKpH,OAAL,CAAaqH;CAV3B,SATe;CAqBvBC,QAAAA,aAAa,EAAEvB,gBArBQ;CAsBvBwB,QAAAA,IAAI,EAAE,KAAK3H,QAAL,GAAgBmF,uCAAe,CAACyC,SAAhC,GAA4CzC,uCAAe,CAAC0C,SAtB3C;CAuBvBrP,QAAAA;CAvBuB,OAAxB;CA0BA,YAAMsP,SAAS,GAAG,KAAKzD,UAAL,CAAgB/J,KAAlC;;CACA,UAAIgC,cAAI,CAAC8J,QAAL,CAAc0B,SAAd,CAAJ,EACA;CACCzB,QAAAA,eAAe,CAAC0B,QAAhB,GAA2BD,SAAS,CAACE,OAArC;CACA3B,QAAAA,eAAe,CAACM,SAAhB,GAA4BmB,SAAS,CAACG,KAAtC;CACA5B,QAAAA,eAAe,CAACI,WAAhB,GAA8BqB,SAAS,CAAC5D,EAAxC;CACAmC,QAAAA,eAAe,CAACK,eAAhB,GAAkCoB,SAAS,CAACI,MAA5C;CACA;;CAED,aAAO7B,eAAP;CACA,KArEF;;CAsEC8B,IAAAA,eAAe,GACf;CACC,aAAO,KAAK/H,OAAL,CAAagI,mBAAb,IAAoC,KAAK/D,UAAL,CAAgBgE,aAA3D;CACA,KAzEF;;CA0ECnB,IAAAA,eAAe,CAACtO,IAAD,EACf;CACC,aAAO0D,cAAI,CAACsF,OAAL,CAAa,KAAKxB,OAAL,CAAakI,cAA1B,KAA6C,KAAKlI,OAAL,CAAakI,cAAb,CAA4B5E,QAA5B,CAAqC9K,IAArC,CAApD;CACA,KA7EF;;CA8EC4N,IAAAA,iBAAiB,GACjB;CACC,UAAInM,OAAO,GAAG,KAAKgK,UAAL,CAAgBhK,OAAhB,IAA2B,EAAzC;;CACA,UAAIiC,cAAI,CAACY,cAAL,CAAoB7C,OAApB,CAAJ,EACA;CACCA,QAAAA,OAAO,GAAGkO,IAAI,CAACC,KAAL,CAAWnO,OAAX,CAAV;CACA;;CAED,aAAOA,OAAP;CACA,KAvFF;;CAwFC0L,IAAAA,QAAQ,CAAC5M,IAAD,EAAOsP,YAAY,GAAG,IAAtB,EACR;CACC,aAAO,KAAKpE,UAAL,CAAgB7L,MAAhB,CAAuBW,IAAvB,KAAgCsP,YAAvC;CACA,KA3FF;;CA4FC9D,IAAAA,eAAe,CAAChE,KAAD,EACf;CACC,YAAMmD,IAAI,GAAGnD,KAAK,CAAC8E,OAAN,EAAb;;CACA,UAAInJ,cAAI,CAACY,cAAL,CAAoB4G,IAAI,CAACvL,UAAzB,KAAwCuL,IAAI,CAACvL,UAAL,KAAoB,KAAKgM,eAAL,CAAqBmE,KAArB,EAAhE,EACA;CACC,aAAKhH,KAAL,CAAW,iBAAX;CACA;CACD,KAnGF;;CAoGCmD,IAAAA,eAAe,CAAClE,KAAD,EACf;CACC,YAAMmD,IAAI,GAAGnD,KAAK,CAAC8E,OAAN,EAAb;;CACA,UAAInJ,cAAI,CAACY,cAAL,CAAoB4G,IAAI,CAACvL,UAAzB,KAAwCuL,IAAI,CAACvL,UAAL,KAAoB,KAAKgM,eAAL,CAAqBmE,KAArB,EAAhE,EACA;CACC,cAAM1P,SAAS,GAAG8K,IAAI,CAACtL,MAAL,CAAYmQ,UAA9B;CAEA,cAAMnQ,MAAM,GAAG;CACdmQ,UAAAA,UAAU,EAAE3P,SADE;CAEd4P,UAAAA,MAAM,EAAE,SAFM;CAGd9C,UAAAA,IAAI,EAAEhC,IAAI,CAACtL,MAAL,CAAYsN,IAHJ;CAId+C,UAAAA,EAAE,EAAE/E,IAAI,CAACtL,MAAL,CAAYqQ,EAJF;CAKdC,UAAAA,UAAU,EAAEhF,IAAI,CAACtL,MAAL,CAAYsQ,UALV;CAMdC,UAAAA,MAAM,EAAEjF,IAAI,CAACtL,MAAL,CAAYuQ,MANN;CAOdC,UAAAA,UAAU,EAAElF,IAAI,CAACtL,MAAL,CAAYwQ,UAPV;CAQdxB,UAAAA,mBAAmB,EAAE,KAAKpH,OAAL,CAAaqH,iBARpB;CASdwB,UAAAA,UAAU,EAAG3M,cAAI,CAACC,KAAL,CAAWuH,IAAI,CAACtL,MAAL,CAAYkG,KAAvB,KAAiCoF,IAAI,CAACtL,MAAL,CAAYyQ,UAAZ,KAA2B,GAA7D,GAAoE,GAApE,GAA0E,GATxE;CAUdC,UAAAA,YAAY,EAAEpF,IAAI,CAACtL,MAAL,CAAY0Q,YAVZ;CAWdC,UAAAA,YAAY,EAAErF,IAAI,CAACtL,MAAL,CAAY2Q,YAXZ;CAYdC,UAAAA,UAAU,EAAEtF,IAAI,CAACuF,SAZH;CAadC,UAAAA,MAAM,EAAExF,IAAI,CAACtL,MAAL,CAAY8Q,MAbN;CAcdC,UAAAA,MAAM,EAAEzF,IAAI,CAAC0F;CAdC,SAAf;CAiBA,aAAK9H,KAAL,CAAW,iBAAX,EAA8BlJ,MAA9B;CACA;CACD,KA9HF;;CA+HCsM,IAAAA,cAAc,CAACnE,KAAD,EACd;CACC,YAAMmD,IAAI,GAAGnD,KAAK,CAAC8E,OAAN,EAAb;;CAEA,UAAInJ,cAAI,CAACY,cAAL,CAAoB4G,IAAI,CAACvL,UAAzB,KAAwCuL,IAAI,CAACvL,UAAL,KAAoB,KAAKgM,eAAL,CAAqBmE,KAArB,EAAhE,EACA;CACC,aAAKhH,KAAL,CAAW,gBAAX;CACA;CACD;;CAvIF,GAlCD;CA2KC;CACAiB,EAAAA,QAAQ,EAAG;;;CA5KZ,CADA;;;;;;ACDAnG,WAAG,CAACoD,SAAJ,CAAcrC,MAAM,CAACa,kBAArB,EACA;CACC;CACD;CACA;CAECyB,EAAAA,KAAK,EAAE;CACN7F,IAAAA,MAAM,EAAE,CAACyP,KAAD,EAAQ1J,MAAR,CADF;CAENK,IAAAA,OAAO,EAAEnE,MAFH;CAGN+D,IAAAA,QAAQ,EAAEC,OAHJ;CAINE,IAAAA,QAAQ,EAAEF,OAJJ;CAKN1H,IAAAA,UAAU,EAAEwH;CALN,GALR;;CAYC+D,EAAAA,IAAI,GACJ;CACC,WAAO;CACN4F,MAAAA,KAAK,EAAE,IAAIC,eAAK,CAACC,WAAV;CADD,KAAP;CAGA,GAjBF;;CAkBCvJ,EAAAA,OAAO,GACP;CACC,QAAI,KAAKL,QAAT,EACA;CACC,WAAK6J,QAAL,GAAgB,IAAIC,6BAAJ,CAAgB;CAC/B5F,QAAAA,EAAE,EAAE,KAAK3L,UADsB;CAE/BwR,QAAAA,aAAa,EAAE;CACd7F,UAAAA,EAAE,EAAE,KAAK3L,UADK;CAEdyR,UAAAA,OAAO,EAAE,gBAFK;CAGd;CACAC,UAAAA,gBAAgB,EAAE,KAAKC,oBAAL,EAJJ;CAKdC,UAAAA,MAAM,EAAE;CACP,6BAAiB,KAAKC,aAAL,CAAmBxF,IAAnB,CAAwB,IAAxB,CADV;CAEP,+BAAmB,KAAKwF,aAAL,CAAmBxF,IAAnB,CAAwB,IAAxB,CAFZ;CAGP,wCAA4B,KAAKyF,WAAL,CAAiBzF,IAAjB,CAAsB,IAAtB;CAHrB,WALM;CAUd0F,UAAAA,gBAAgB,EAAE;CACjBC,YAAAA,IAAI,EAAE,IADW;CAEjBC,YAAAA,WAAW,EAAE;CACZC,cAAAA,KAAK,EAAEC,aAAG,CAACC,OAAN,cAAc,GAAd,CAA6D,EAA7D,GAAgB,4CAAhB,CADO;CAEZC,cAAAA,QAAQ,EAAEF,aAAG,CAACC,OAAN,gBAAc,GAAd,CAAgE,EAAhE,GAAgB,+CAAhB,CAFI;CAGZE,cAAAA,KAAK,EAAE;CAHK;CAFI,WAVJ;CAkBdC,UAAAA,aAAa,EAAE;CACdC,YAAAA,eAAe,EAAE;CADH,WAlBD;CAqBdC,UAAAA,QAAQ,EAAE,CACT;CACC9G,YAAAA,EAAE,EAAE,OADL;CAEC9D,YAAAA,OAAO,EAAE;CACRkG,cAAAA,QAAQ,EAAE,KAAKlG,OAAL,CAAakG;CADf,aAFV;CAKC2E,YAAAA,aAAa,EAAE,IALhB;CAMCC,YAAAA,WAAW,EAAE;CANd,WADS;CArBI;CAFgB,OAAhB,CAAhB;CAmCA,WAAKC,yBAAL,GAAiC,KAAjC;CAEA,WAAKC,OAAL,CAAaC,GAAb,CAAiB,+BAAjB,EAAkD,KAAKC,mBAAL,CAAyB1G,IAAzB,CAA8B,IAA9B,CAAlD;CACA;CACD,GA7DF;;CA8DCM,EAAAA,OAAO,GACP;CACC,QAAI,KAAKlF,QAAT,EACA;CACC,WAAK6J,QAAL,CAAcxE,QAAd,CAAuB,KAAKC,KAAL,CAAWiG,oBAAlC;CACA,KAHD,MAKA;CACC,WAAKvR,MAAL,CAAYoB,OAAZ,CAAoB,CAACoQ,KAAD,EAAQC,UAAR,EAAoBzR,MAApB,KAA+B;CAClD,cAAM0R,SAAS,GAAID,UAAU,GAAGzR,MAAM,CAACmB,MAAP,GAAgB,CAA9B,GAAmC,SAAnC,GAA+C,EAAjE;CACA,aAAKmK,KAAL,CAAWiG,oBAAX,CAAgCI,WAAhC,CAA4CjB,aAAG,CAACkB,MAAhD,gBAAuD;;;;sCAAvD,CAIqD;;QAJrD,CAM8B;;KAN9B,GAIkCJ,KAAK,CAAC,WAAD,CAJvC,EAMIA,KAAK,CAAC,MAAD,CAAL,GAAgBE,SANpB;CASA,OAXD;CAYA;CACD,GAnFF;;CAoFChL,EAAAA,OAAO,EACP;CACC4K,IAAAA,mBAAmB,CAACtR,MAAD,EACnB;CACC,WAAKmR,yBAAL,GAAiC,IAAjC;CACA,WAAKnR,MAAL,GAAcA,MAAd;;CACA,UAAI,KAAK6P,QAAL,CAAcgC,SAAd,GAA0BC,QAA1B,EAAJ,EACA;CACC,aAAKjC,QAAL,CAAcgC,SAAd,GAA0BE,WAA1B;CACA,aAAKC,iBAAL;CACA,OAJD,MAMA;CACC,aAAKnC,QAAL,CAAcgC,SAAd,GAA0BI,IAA1B;CACAxH,QAAAA,6BAAY,CAACC,SAAb,CAAuB,KAAKmF,QAAL,CAAcgC,SAAd,EAAvB,EAAkD,QAAlD,EAA4D,KAAKG,iBAAL,CAAuBpH,IAAvB,CAA4B,IAA5B,CAA5D;CACA;CACD,KAfF;;CAgBCoH,IAAAA,iBAAiB,GACjB;CACC,WAAKhS,MAAL,CAAYoB,OAAZ,CAAoBoQ,KAAK,IAAI;CAC5B,cAAMnQ,IAAI,GAAG,KAAKwO,QAAL,CAAcgC,SAAd,GAA0BK,OAA1B,CAAkC;CAAChI,UAAAA,EAAE,EAAEsH,KAAK,CAAC,OAAD,CAAV;CAAqBW,UAAAA,QAAQ,EAAE;CAA/B,SAAlC,CAAb;CACA9Q,QAAAA,IAAI,CAAC+Q,MAAL;CACA,OAHD;CAIA,WAAKjB,yBAAL,GAAiC,KAAjC;CACA,KAvBF;;CAwBCjB,IAAAA,oBAAoB,GACpB;CACC,UAAI,CAAC5N,cAAI,CAACsF,OAAL,CAAa,KAAK5H,MAAlB,CAAD,IAA8B,KAAKA,MAAL,CAAYmB,MAAZ,KAAuB,CAAzD,EACA;CACC,eAAO,EAAP;CACA;;CAED,aAAO,KAAKnB,MAAL,CAAYqS,GAAZ,CAAiBhR,IAAD,IAAU;CAChC,eAAO,CAAC,OAAD,EAAUA,IAAI,CAAC,OAAD,CAAd,CAAP;CACA,OAFM,CAAP;CAGA,KAlCF;;CAmCC+O,IAAAA,aAAa,CAACzJ,KAAD,EACb;CACC,YAAM2B,KAAK,GAAG3B,KAAK,CAAC2L,SAAN,GAAkBC,gBAAlB,EAAd;CACA,YAAMC,YAAY,GAAG,EAArB;;CACA,UAAIlQ,cAAI,CAACsF,OAAL,CAAaU,KAAb,CAAJ,EACA;CACCA,QAAAA,KAAK,CAAClH,OAAN,CAAeC,IAAD,IAAU;CACvBmR,UAAAA,YAAY,CAACrQ,IAAb,CAAkB;CACjB,qBAASd,IAAI,CAACqN,KAAL,EADQ;CAEjB,oBAAQrN,IAAI,CAACoR,QAAL,EAFS;CAGjB,yBAAapR,IAAI,CAACqR,SAAL;CAHI,WAAlB;CAKA,SAND;CAOA;;CAED,YAAMC,SAAS,GAAG;CACjBH,QAAAA,YAAY,EAAEA,YADG;CAEjBrB,QAAAA,yBAAyB,EAAE,KAAKA;CAFf,OAAlB;CAKA,WAAKzJ,KAAL,CAAW,aAAX,EAA0BiL,SAA1B;CACA,KAxDF;;CAyDCtC,IAAAA,WAAW,CAAC1J,KAAD,EACX;CACC,YAAM;CAACiM,QAAAA;CAAD,UAAgBjM,KAAK,CAAC8E,OAAN,EAAtB;CACA,YAAMa,QAAQ,GAAG,KAAKlG,OAAL,CAAakG,QAA9B;CAEA,aAAO,IAAIuG,OAAJ,CACN,CAACC,OAAD,EAAUC,MAAV,KAAqB;CACpB,cAAMC,MAAc,GAAGrM,KAAK,CAAC2L,SAAN,EAAvB;CACA,cAAM9T,MAAM,GAAG;CACdW,UAAAA,IAAI,EAAEyT,WAAW,CAACK,QAAZ,EADQ;CAEd3G,UAAAA;CAFc,SAAf;CAKA0G,QAAAA,MAAM,CAACE,UAAP;CACAC,QAAAA,cAAI,CAACC,SAAL,CACC,iCADD,EAEC;CACCtJ,UAAAA,IAAI,EAAE;CACLtL,YAAAA;CADK;CADP,SAFD,EAQE6U,IARF,CAQOC,QAAQ,IAAI;CACjBN,UAAAA,MAAM,CAACO,UAAP;CACA,gBAAMlS,IAAI,GAAG2R,MAAM,CAACtR,OAAP,CAAe;CAC3BwI,YAAAA,EAAE,EAAEoJ,QAAQ,CAACxJ,IAAT,CAAcI,EADS;CAE3BiI,YAAAA,QAAQ,EAAE,OAFiB;CAG3B1B,YAAAA,KAAK,EAAEmC,WAAW,CAACK,QAAZ,EAHoB;CAI3BO,YAAAA,IAAI,EAAER,MAAM,CAACS,YAAP,GAAsB/E,KAAtB;CAJqB,WAAf,CAAb;;CAOA,cAAIrN,IAAJ,EACA;CACCA,YAAAA,IAAI,CAAC+Q,MAAL;CACA;;CAEDY,UAAAA,MAAM,CAACU,IAAP;CACAZ,UAAAA,OAAO;CACP,SAxBF,EAyBEa,KAzBF,CAyBQ,MAAMZ,MAAM,EAzBpB;CA0BA,OAnCK,CAAP;CAoCA;;CAlGF,GArFD;CAyLChK,EAAAA,QAAQ,EACR;CACCC,IAAAA,QAAQ,GACR;CACC,aAAOxG,UAAG,CAACyG,kBAAJ,CAAuB,UAAvB,CAAP;CACA;;CAJF,GA1LD;CAgMC;CACAN,EAAAA,QAAQ,EAAG;;;;;CAjMZ,CADA;;ACFAnG,WAAG,CAACoD,SAAJ,CAAcrC,MAAM,CAACS,sBAArB,EACA;CACC;CACD;CACA;CAEC6B,EAAAA,KAAK,EAAE;CACN/H,IAAAA,GAAG,EAAEgI,MADC;CAENE,IAAAA,QAAQ,EAAEC,OAFJ;CAGNG,IAAAA,OAAO,EAAEnE;CAHH,GALR;;CAUCoE,EAAAA,OAAO,GACP;CACC,SAAKuN,iBAAL,GAAyBrN,iBAAO,CAACC,QAAR,CAAiB,KAAKqN,UAAtB,EAAkC,GAAlC,EAAuC,IAAvC,CAAzB;CACA,GAbF;;CAcCnN,EAAAA,OAAO,EACP;CACCmN,IAAAA,UAAU,CAAClN,KAAD,EACV;CACC,UAAI,CAAC,KAAKX,QAAV,EACA;CACC;CACA;;CAEDW,MAAAA,KAAK,CAACC,MAAN,CAAaC,KAAb,GAAqBF,KAAK,CAACC,MAAN,CAAaC,KAAb,CAAmBC,OAAnB,CAA2B,UAA3B,EAAsC,EAAtC,CAArB;;CACA,UAAIH,KAAK,CAACC,MAAN,CAAaC,KAAb,KAAuB,EAA3B,EACA;CACCF,QAAAA,KAAK,CAACC,MAAN,CAAaC,KAAb,GAAqB,CAArB;CACA;;CACD,UAAIG,UAAU,GAAGL,KAAK,CAACC,MAAN,CAAaC,KAAb,CAAmBI,MAAnB,CAA0B,CAAC,CAA3B,CAAjB;;CACA,UAAID,UAAU,KAAK,GAAnB,EACA;CACCL,QAAAA,KAAK,CAACC,MAAN,CAAaC,KAAb,GAAqBF,KAAK,CAACC,MAAN,CAAaC,KAAb,CAAmBC,OAAnB,CAA2B,GAA3B,EAAgC,GAAhC,CAArB;CACA;;CACD,UAAIgN,MAAM,GAAG1V,cAAI,CAACyD,QAAL,CAAc8E,KAAK,CAACC,MAAN,CAAaC,KAA3B,CAAb;;CACA,UAAIG,UAAU,KAAK,GAAf,IAAsBA,UAAU,KAAK,GAAzC,EACA;CACC;CACA;;CAED,UAAI8M,MAAM,GAAG,CAAb,EACA;CACCA,QAAAA,MAAM,IAAI,CAAC,CAAX;CACA;;CAED,WAAKpM,KAAL,CAAW,aAAX,EAA0BoM,MAA1B;CACA;;CA9BF,GAfD;CA+CC/K,EAAAA,QAAQ,EACR;CACCC,IAAAA,QAAQ,GACR;CACC,aAAOxG,UAAG,CAACyG,kBAAJ,CAAuB,UAAvB,CAAP;CACA,KAJF;;CAKCC,IAAAA,cAAc,GACd;CACC,aAAO,KAAK9C,OAAL,CAAa8C,cAAb,IAA+B,EAAtC;CACA;;CARF,GAhDD;CA0DC;CACAP,EAAAA,QAAQ,EAAG;;;;;;;;;;;;;;;CA3DZ,CADA;;ACmBAnG,WAAG,CAACoD,SAAJ,CAAcrC,MAAM,CAACM,eAArB,EACC;CACC;CACF;CACA;CACA;CACA;CACA;CACA;CAEEgC,EAAAA,KAAK,EAAE;CACNwE,IAAAA,UAAU,EAAEpI,MADN;CAEN8R,IAAAA,eAAe,EAAEjO,MAFX;CAGNsE,IAAAA,YAAY,EAAEtE,MAHR;CAINkO,IAAAA,UAAU,EAAElO,MAJN;CAKNM,IAAAA,OAAO,EAAEnE,MALH;CAMN0L,IAAAA,IAAI,EAAE5H;CANA,GATR;;CAkBC+D,EAAAA,IAAI,GACJ;CACC,WAAO;CACNQ,MAAAA,KAAK,EAAE,IADD;CAENpB,MAAAA,cAAc,EAAE,IAFV;CAGNqB,MAAAA,eAAe,EAAE,IAHX;CAINC,MAAAA,cAAc,EAAE,IAJV;CAKNjM,MAAAA,UAAU,EAAE,KAAK8L,UAAL,CAAgB9L,UALtB;CAMN0V,MAAAA,cAAc,EAAE;CACf9U,QAAAA,IAAI,EAAE,EADS;CAEf+K,QAAAA,EAAE,EAAE;CAFW,OANV;CAUNgK,MAAAA,MAAM,EAAE;CACP3J,QAAAA,eAAe,EAAEjG,aAAa,CAACC,gBADxB;CAEPrF,QAAAA,QAAQ,EAAEoF,aAAa,CAACG,QAFjB;CAGP1F,QAAAA,KAAK,EAAEuF,aAAa,CAACI,KAHd;CAIPzG,QAAAA,MAAM,EAAEqG,aAAa,CAACK,MAJf;CAKP5G,QAAAA,QAAQ,EAAEuG,aAAa,CAACM,QALjB;CAMPnF,QAAAA,GAAG,EAAE6E,aAAa,CAACO,GANZ;CAOP2M,QAAAA,KAAK,EAAElN,aAAa,CAACQ,KAPd;CAQPqP,QAAAA,OAAO,EAAE7P,aAAa,CAACS;CARhB,OAVF;CAoBNqP,MAAAA,UAAU,EAAE;CACXC,QAAAA,oBAAoB,EAAErP,aAAa,CAACC,sBADzB;CAEXqP,QAAAA,UAAU,EAAEtP,aAAa,CAACE,WAFf;CAGXqP,QAAAA,aAAa,EAAEvP,aAAa,CAACG,cAHlB;CAIXqP,QAAAA,UAAU,EAAExP,aAAa,CAACI,WAJf;CAKXqP,QAAAA,UAAU,EAAEzP,aAAa,CAACK;CALf;CApBN,KAAP;CA4BA,GAhDF;;CAiDCgB,EAAAA,OAAO,GACP;CACC,SAAK6C,cAAL,GAAsB,KAAK9C,OAAL,CAAa8C,cAAnC;CAEA,SAAKoB,KAAL,GAAa,KAAKoK,SAAL,EAAb;;CACA,QAAIpS,cAAI,CAACsF,OAAL,CAAa,KAAKxB,OAAL,CAAayB,QAA1B,CAAJ,EACA;CACC,WAAKzB,OAAL,CAAayB,QAAb,CAAsBwK,GAAtB,CAA2B8B,OAAD,IAAa;CACtC,YAAIA,OAAO,CAAC,YAAD,CAAP,KAA0B,GAA9B,EACA;CACC,eAAKF,cAAL,CAAoB9U,IAApB,GAA2BgV,OAAO,CAACnM,MAAnC;CACA,eAAKiM,cAAL,CAAoBrV,IAApB,GAA2BuV,OAAO,CAAC1L,IAAnC;;CAEA,cAAI,CAAC,KAAK4B,UAAL,CAAgB7L,MAAhB,CAAuBmB,WAAxB,IAAuC,CAAC,KAAK0K,UAAL,CAAgB7L,MAAhB,CAAuBkB,WAAnE,EACA;CACC,iBAAKiV,mBAAL,CAAyB;CACxBjV,cAAAA,WAAW,EAAE,KAAKuU,cAAL,CAAoBrV,IADT;CAExBe,cAAAA,WAAW,EAAE,KAAKsU,cAAL,CAAoB9U;CAFT,aAAzB;CAIA;CACD;CACD,OAdD;CAeA;CACD,GAxEF;;CAyECuH,EAAAA,OAAO,EACN;CACCkO,IAAAA,kBAAkB,GAClB;CAAA;;CACC,YAAMC,aAAa,GAAG,KAAKxK,UAAL,CAAgB7L,MAAtC;CACA,YAAMsW,YAAY,GAAG1W,cAAI,CAACyD,QAAL,CAAcgT,aAAa,CAAC9V,KAA5B,CAArB;CACA,UAAIC,SAAS,GAAG6V,aAAa,CAAC7V,SAAd,GAA0B6V,aAAa,CAAC7V,SAAxC,GAAoD6V,aAAa,CAAC9V,KAAlF;;CACA,UAAI,CAACuD,cAAI,CAACC,KAAL,CAAWvD,SAAX,CAAL,EACA;CACCA,QAAAA,SAAS,GAAGZ,cAAI,CAACyD,QAAL,CAAc7C,SAAd,CAAZ;CACA;;CACD,aAAO;CACN8M,QAAAA,IAAI,EAAE,+BAAKzB,UAAL,CAAgB7L,MAAhB,2CAAwBW,IAAxB,KAAgC,EADhC;CAENyP,QAAAA,MAAM,EAAE,gCAAKvE,UAAL,CAAgB7L,MAAhB,4CAAwBK,MAAxB,KAAkC,EAFpC;CAGNmQ,QAAAA,UAAU,EAAE,gCAAK3E,UAAL,CAAgB7L,MAAhB,4CAAwBuB,UAAxB,KAAsC,EAH5C;CAIN+E,QAAAA,KAAK,EAAE,gCAAKuF,UAAL,CAAgB7L,MAAhB,4CAAwBgT,KAAxB,KAAiC,EAJlC;CAKN1C,QAAAA,UAAU,4BAAE,KAAKzE,UAAL,CAAgB7L,MAAlB,qBAAE,uBAAwBE,SAL9B;CAMNmQ,QAAAA,EAAE,EAAE,gCAAKxE,UAAL,CAAgB7L,MAAhB,4CAAwBG,KAAxB,gCAAiC,KAAK0L,UAAL,CAAgB7L,MAAjD,qBAAiC,uBAAwBE,SAAzD,CANE;CAONqQ,QAAAA,MAAM,4BAAE,KAAK1E,UAAL,CAAgB7L,MAAlB,qBAAE,uBAAwBG,KAP1B;CAQN8F,QAAAA,QAAQ,EAAErG,cAAI,CAACyD,QAAL,CAAcgT,aAAa,CAAC3V,QAA5B,CARJ;CASNyP,QAAAA,UAAU,EAAE3P,SATN;CAUN0F,QAAAA,KAAK,EAAEoQ,YAVD;CAWNC,QAAAA,WAAW,EAAE/V,SAXP;CAYNgW,QAAAA,YAAY,EAAEF,YAZR;CAaNG,QAAAA,eAAe,EAAE,KAAK5K,UAAL,CAAgB7L,MAAhB,CAAuBS,cAAvB,IAAyC6V,YAbpD;CAcNI,QAAAA,gBAAgB,EAAE9W,cAAI,CAACyD,QAAL,CAAcgT,aAAa,CAACvV,YAA5B,KAA6CC,sCAAY,CAACC,UAdtE;CAeN2V,QAAAA,aAAa,EAAE/W,cAAI,CAACyD,QAAL,CAAcgT,aAAa,CAACzV,YAA5B,CAfT;CAgBNgW,QAAAA,YAAY,EAAEhX,cAAI,CAACyD,QAAL,CAAcgT,aAAa,CAAC9W,QAA5B,CAhBR;CAiBNsX,QAAAA,YAAY,EAAER,aAAa,CAAClX,WAAd,IAA6B,KAAKyI,OAAL,CAAazI,WAjBlD;CAkBN2X,QAAAA,QAAQ,EAAET,aAAa,CAACpV,GAAd,IAAqB,CAlBzB;CAmBNwP,QAAAA,UAAU,EAAE4F,aAAa,CAAChV,aAAd,IAA+B,GAnBrC;CAoBNqP,QAAAA,YAAY,EAAE2F,aAAa,CAACnV,WAAd,IAA6B,KAAKuU,cAAL,CAAoBrV,IApBzD;CAqBNuQ,QAAAA,YAAY,EAAE0F,aAAa,CAAClV,WAAd,IAA6B,KAAKsU,cAAL,CAAoB9U;CArBzD,OAAP;CAuBA,KAjCF;;CAkCCuV,IAAAA,SAAS,GACT;CAAA;;CACC,YAAMhW,SAAS,GAAGN,cAAI,CAACyD,QAAL,2BAAc,KAAKwI,UAAL,CAAgB7L,MAA9B,qBAAc,uBAAwBE,SAAtC,CAAlB;CACA,YAAMC,KAAK,GAAGP,cAAI,CAACyD,QAAL,4BAAc,KAAKwI,UAAL,CAAgB7L,MAA9B,qBAAc,wBAAwBG,KAAtC,CAAd;CACA,YAAM2L,KAAK,GAAG,IAAIiL,iCAAJ,CACb;CACCjJ,QAAAA,QAAQ,EAAElO,cAAI,CAACyD,QAAL,CAAc,KAAKuE,OAAL,CAAakG,QAA3B,CADX;CAECC,QAAAA,WAAW,EAAEnO,cAAI,CAACyD,QAAL,CAAc,KAAKuE,OAAL,CAAamG,WAA3B,CAFd;CAGC7O,QAAAA,QAAQ,EAAE,KAAK0I,OAAL,CAAa1I,QAHxB;CAIC8X,QAAAA,aAAa,EACZlT,cAAI,CAACY,cAAL,4BAAoB,KAAKmH,UAAL,CAAgB7L,MAApC,qBAAoB,wBAAwBW,IAA5C,KACGT,SAAS,IAAI,CADhB,IAEGC,KAAK,IAAI,CAPd;CASCH,QAAAA,MAAM,EAAE,KAAKoW,kBAAL;CATT,OADa,CAAd;CAcAnK,MAAAA,6BAAY,CAACC,SAAb,CAAuBJ,KAAvB,EAA8B,gBAA9B,EAAgD,KAAKmL,cAArD;CAEA,aAAOnL,KAAP;CACA,KAvDF;;CAwDCmL,IAAAA,cAAc,GACd;CACC,YAAM9U,MAAM,GAAGsB,MAAM,CAACiM,MAAP,CAAc,KAAK5D,KAAL,CAAWoL,kBAAX,GAAgCC,SAAhC,EAAd,CAAf;CACA,WAAKC,aAAL,CAAmB;CAACjV,QAAAA;CAAD,OAAnB;CACA,WAAK+G,KAAL,CAAW,kBAAX,EAA+B;CAC9BnG,QAAAA,KAAK,EAAE,KAAKwS,eADkB;CAE9BpT,QAAAA;CAF8B,OAA/B;CAIA,KAhEF;;CAiECkV,IAAAA,mBAAmB,CAACrX,MAAD,EACnB;CACC,WAAK8L,KAAL,CAAWwL,aAAX,GAA2BC,SAA3B,CAAqCvX,MAArC;CACA,YAAM6T,GAAG,GAAG;CAACpS,QAAAA,gBAAgB,EAAEzB;CAAnB,OAAZ;;CACA,UAAIJ,cAAI,CAACyD,QAAL,CAAcrD,MAAM,CAACwX,GAArB,KAA6B,CAAjC,EACA;CACC3D,QAAAA,GAAG,CAACvU,GAAJ,GAAUM,cAAI,CAACyD,QAAL,CAAcrD,MAAM,CAACwX,GAArB,CAAV;CACA;;CAED,UAAI,CAAC1T,cAAI,CAACC,KAAL,CAAW/D,MAAM,CAACqQ,EAAlB,CAAL,EACA;CACCwD,QAAAA,GAAG,CAAC/T,OAAJ,GAAcF,cAAI,CAACyD,QAAL,CAAcrD,MAAM,CAACqQ,EAArB,CAAd;CACA;;CAED,WAAK+G,aAAL,CAAmBvD,GAAnB;CACA,KAhFF;;CAiFC4D,IAAAA,yBAAyB,GACzB;CACC,YAAMC,WAAW,GAAG,KAAK5L,KAAL,CAAW6L,SAAX,EAApB;CACA,aAAO;CACNzX,QAAAA,SAAS,EAAEwX,WAAW,CAACpH,UADjB;CAENnQ,QAAAA,KAAK,EAAEuX,WAAW,CAACnH,MAFb;CAGN5P,QAAAA,IAAI,EAAE+W,WAAW,CAACpK,IAHZ;CAINjN,QAAAA,MAAM,EAAEqX,WAAW,CAACtH,MAJd;CAKN5P,QAAAA,SAAS,EAAEkX,WAAW,CAACvH,UALjB;CAMN5P,QAAAA,KAAK,EAAEmX,WAAW,CAACxR,KANb;CAONzF,QAAAA,cAAc,EAAEiX,WAAW,CAACjB,eAPtB;CAQN/V,QAAAA,QAAQ,EAAEgX,WAAW,CAACzR,QARhB;CASNrF,QAAAA,YAAY,EAAE8W,WAAW,CAACf,aATpB;CAUNpX,QAAAA,QAAQ,EAAEmY,WAAW,CAACd,YAVhB;CAWN9V,QAAAA,YAAY,EAAE4W,WAAW,CAAChB,gBAXpB;CAYNrV,QAAAA,aAAa,EAAEqW,WAAW,CAACjH,UAAZ,IAA0B,GAZnC;CAaNvP,QAAAA,WAAW,EAAEwW,WAAW,CAAChH,YAAZ,IAA4B,EAbnC;CAcNvP,QAAAA,WAAW,EAAEuW,WAAW,CAAC/G,YAAZ,IAA4B,EAdnC;CAeNpP,QAAAA,UAAU,EAAEmW,WAAW,CAAClH,UAAZ,IAA0B,EAfhC;CAgBNhP,QAAAA,MAAM,EAAEkW,WAAW,CAAC5G,MAAZ,IAAsB,EAhBxB;CAiBNzF,QAAAA,KAAK,EAAEqM,WAAW,CAACE,MAjBb;CAkBN/G,QAAAA,SAAS,EAAE6G,WAAW,CAAC9G;CAlBjB,OAAP;CAoBA,KAxGF;;CAyGCwG,IAAAA,aAAa,CAAClT,OAAD,EACb;CACC,WAAKgF,KAAL,CAAW,eAAX,EAA4B;CAC3BnG,QAAAA,KAAK,EAAE,KAAKwS,eADe;CAE3BrR,QAAAA;CAF2B,OAA5B;CAIA,KA/GF;;CAgHCiS,IAAAA,mBAAmB,CAACnW,MAAD,EACnB;CACCA,MAAAA,MAAM,GAAGyD,MAAM,CAACC,MAAP,CAAc,KAAKmI,UAAL,CAAgB7L,MAA9B,EAAsCA,MAAtC,CAAT;CACA,WAAKkJ,KAAL,CAAW,eAAX,EAA4B;CAC3BnG,QAAAA,KAAK,EAAE,KAAKwS,eADe;CAE3BrR,QAAAA,OAAO,EAAE;CAAClE,UAAAA;CAAD,SAFkB;CAG3B6X,QAAAA,iBAAiB,EAAE,KAAK/L,KAAL,CAAWgM,QAAX,MAAyB,KAAKlM,YAAL,KAAsB;CAHvC,OAA5B;CAKA,KAxHF;;CAyHCmM,IAAAA,gBAAgB,CAACC,aAAD,EAChB;CACC,aAAO,KAAKlM,KAAL,CAAWmM,IAAX,CAAgBD,aAAhB,CAAP;CACA,KA5HF;;CA6HC3L,IAAAA,eAAe,CAACrM,MAAD,EACf;CACCA,MAAAA,MAAM,GAAGyD,MAAM,CAACC,MAAP,CACR,KAAKoI,KAAL,CAAWwL,aAAX,GAA2BY,kBAA3B,CAA8ClY,MAAM,CAACmQ,UAArD,CADQ,EAERnQ,MAFQ,CAAT;CAKA,WAAKoX,aAAL,CACC;CAACrV,QAAAA,YAAY,EAAE/B,MAAM,CAACmQ;CAAtB,OADD;CAGA,WAAKgI,aAAL,CAAmBnY,MAAnB;CACA,WAAKqX,mBAAL,CAAyBrX,MAAzB;CACA,WAAKkJ,KAAL,CAAW,+BAAX,EAA4C,KAAK2C,UAAL,CAAgB7L,MAAhB,CAAuBwB,MAAnE;CACA,KA1IF;;CA2IC2K,IAAAA,eAAe,GACf;CACC,WAAKgK,mBAAL,CAAyB;CACxB7U,QAAAA,gBAAgB,EAAE;CACjB8W,UAAAA,cAAc,EAAE,EADC;CAEjBC,UAAAA,eAAe,EAAE;CAFA;CADM,OAAzB;CAMA,KAnJF;;CAoJC/L,IAAAA,cAAc,GACd;CACC,UAAIxI,cAAI,CAACwU,aAAL,CAAmB,KAAK1Q,OAAL,CAAa8F,oBAAhC,CAAJ,EACA;CACC,eAAO,KAAK9F,OAAL,CAAa8F,oBAAb,CAAkC,KAAK7B,UAAL,CAAgB/L,OAAlD,CAAP;CACA;CACD;CACL;CACA;CACA;CACA;CACA;CACA;CACA;;CAGK,KApKF;;CAqKCyY,IAAAA,WAAW,CAACjZ,GAAD,EACX;CACC,YAAMiB,KAAK,GAAIjB,GAAG,GAAGM,cAAI,CAACyD,QAAL,CAAc,KAAKwI,UAAL,CAAgB7L,MAAhB,CAAuBU,QAArC,CAAP,GAAyDd,cAAI,CAACyD,QAAL,CAAc,KAAKwI,UAAL,CAAgB7L,MAAhB,CAAuBT,QAArC,CAAvE;CACA,WAAKiZ,aAAL,CAAmBjY,KAAnB;CACA,KAzKF;;CA0KCiY,IAAAA,aAAa,CAAClO,QAAD,EACb;CACC,UAAI,CAAC,KAAK1C,OAAL,CAAa6Q,yBAAlB,EACA;CACC,aAAKC,eAAL,CAAqBpO,QAArB;CAEA;CACA;;CAED,WAAKwB,KAAL,CAAW6M,gBAAX,CACC,kBAAkB,KAAK5Y,UADxB,EAEC;CACCkS,QAAAA,KAAK,EAAE2G,aAAG,CAACC,UAAJ,CAAe,+DAAf,CADR;CAEClH,QAAAA,MAAM,EAAE;CACPmH,UAAAA,QAAQ,EAAE,MAAM;CACf,kBAAMC,gBAAgB,GAAG,KAAKC,WAAL,CAAiB1O,QAAjB,CAAzB;;CACA,gBAAIyO,gBAAgB,CAACnC,YAAjB,GAAgC,CAApC,EACA;CACC,mBAAKqC,cAAL,CAAoB,GAApB;CACA,mBAAK1M,KAAL,CAAWC,IAAX,CAAgB0M,gBAAhB,CAAiC,mBAAjC,EAAsD,GAAtD;CACA;CACD,WARM;CASPC,UAAAA,MAAM,EAAE,MAAM;CACb,iBAAKT,eAAL,CAAqBpO,QAArB;CACA,iBAAKyN,gBAAL,CAAsB,CAAC,YAAD,CAAtB,EAAsClD,IAAtC,CAA2C,MAAI;CAC9C,mBAAKuC,aAAL,CACC;CAACrV,gBAAAA,YAAY,EAAEuI;CAAf,eADD;CAGA,aAJD;CAKA;CAhBM;CAFT,OAFD;CAwBA,KA3MF;;CA4MC8O,IAAAA,eAAe,CAACzD,OAAD,EACf;CACC,WAAK0D,aAAL,CAAmB1D,OAAnB;CACA,WAAK7J,KAAL,CAAW6M,gBAAX,CACC,oBAAoB,KAAK5Y,UAD1B,EAEC;CACCkS,QAAAA,KAAK,EAAE2G,aAAG,CAACC,UAAJ,CAAe,iEAAf,CADR;CAEClH,QAAAA,MAAM,EAAE;CACPwH,UAAAA,MAAM,EAAE,MAAM;CACb,iBAAKpB,gBAAL,CAAsB,CAAC,cAAD,EAAiB,cAAjB,CAAtB;CACA;CAHM;CAFT,OAFD;CAWA,KA1NF;;CA2NCkB,IAAAA,cAAc,CAAC5Q,KAAD,EACd;CACC,UAAI,KAAKiR,UAAT,EACA;CACC;CACA;;CAED,WAAKlC,aAAL,CACC;CAACzV,QAAAA,YAAY,EAAE0G;CAAf,OADD;;CAIA,UAAIA,KAAK,KAAK,GAAd,EACA;CACCkR,QAAAA,UAAU,CACT;CAAA;;CAAA,gCAAM,KAAKzM,KAAX,8CAAM,YAAY0M,eAAlB,+CAAM,sBAA6B1M,KAAnC,+CAAM,uBAAoC2M,aAA1C,qBAAM,uBAAmDC,KAAnD,EAAN;CAAA,SADS,CAAV;CAGA;CACD,KA5OF;;CA6OCC,IAAAA,SAAS,CAACtR,KAAD,EACT;CACC,WAAK+O,aAAL,CACC;CAACxV,QAAAA,OAAO,EAAEyG;CAAV,OADD;CAGA,KAlPF;;CAmPC8P,IAAAA,aAAa,CAACnY,MAAD,EACb;CACC,WAAK8L,KAAL,CAAWwL,aAAX,GAA2BC,SAA3B,CAAqCvX,MAArC;CACA,WAAK8L,KAAL,CAAWyL,SAAX,CAAqBvX,MAArB;CACA,WAAKmW,mBAAL,CAAyB,EAAC,GAAG,KAAKtK,UAAL,CAAgB7L,MAApB;CAA4B,WAAG,KAAKyX,yBAAL;CAA/B,OAAzB;;CAEA,UAAI,CAAC3T,cAAI,CAACC,KAAL,CAAW/D,MAAM,CAACwX,GAAlB,CAAL,EACA;CACC,aAAKJ,aAAL,CAAmB;CAAC9X,UAAAA,GAAG,EAAEU,MAAM,CAACwX;CAAb,SAAnB;CACA;CACD,KA7PF;;CA8PCoC,IAAAA,WAAW,CAACzF,SAAD,EACX;CACC,YAAM3S,MAAM,GAAGsC,cAAI,CAACsF,OAAL,CAAa+K,SAAS,CAACH,YAAvB,IAAuCG,SAAS,CAACH,YAAjD,GAAgE,EAA/E;CACA,YAAMrB,yBAAyB,GAAGwB,SAAS,CAACxB,yBAA5C;CACA,WAAKwF,aAAL,CAAmB;CAAErH,QAAAA,MAAM,EAAEtP;CAAV,OAAnB;;CAEA,UAAI,CAACmR,yBAAL,EACA;CACC,aAAKoF,gBAAL,CAAsB,CAAC,QAAD,CAAtB;CACA;CACD,KAxQF;;CAyQC8B,IAAAA,gBAAgB,CAACnZ,QAAD,EAChB;CACC,WAAKoL,KAAL,CAAWwL,aAAX,GAA2BC,SAA3B;CACA,WAAKY,aAAL,CACC,KAAKrM,KAAL,CAAWwL,aAAX,GAA2BwC,iBAA3B,CAA6CpZ,QAA7C,CADD;CAGA,KA/QF;;CAgRC2Y,IAAAA,aAAa,CAAC1D,OAAD,EACb;CACC,YAAMoE,aAAa,GAAG,KAAKlO,UAAL,CAAgB7L,MAAtC;CACA+Z,MAAAA,aAAa,CAAC,aAAD,CAAb,GAA+BpE,OAAO,CAACvV,IAAvC;CACA2Z,MAAAA,aAAa,CAAC,aAAD,CAAb,GAA+BpE,OAAO,CAAChV,IAAvC;CACA,WAAKwX,aAAL,CAAmB;CAClBzH,QAAAA,YAAY,EAAEiF,OAAO,CAACvV,IADJ;CAElBuQ,QAAAA,YAAY,EAAEgF,OAAO,CAAChV;CAFJ,OAAnB;CAIA,KAzRF;;CA0RC+X,IAAAA,eAAe,CAACnY,KAAD,EACf;CACC,WAAKuL,KAAL,CAAWkO,QAAX,CAAoB,YAApB,EAAkCzZ,KAAlC;CACA,WAAK4X,aAAL,CACC,KAAKrM,KAAL,CAAWwL,aAAX,GAA2BY,kBAA3B,CAA8C3X,KAA9C,CADD;CAGA,KAhSF;;CAiSCyY,IAAAA,WAAW,CAACzY,KAAD,EACX;CACC,WAAKuL,KAAL,CAAWwL,aAAX,GAA2BC,SAA3B,CACC,KAAKzL,KAAL,CAAWwL,aAAX,GAA2BY,kBAA3B,CAA8C,KAAKrM,UAAL,CAAgB9J,YAA9D,CADD;CAGA,YAAMN,gBAAgB,GAAG,KAAKqK,KAAL,CAAWwL,aAAX,GAA2B2C,cAA3B,CAA0C1Z,KAA1C,CAAzB;CACA,WAAK4X,aAAL,CAAmB1W,gBAAnB;CACA,aAAOA,gBAAP;CACA,KAzSF;;CA0SCyY,IAAAA,kBAAkB,CAACpZ,YAAD,EAClB;CACC,YAAMgK,IAAI,GAAIlL,cAAI,CAACyD,QAAL,CAAcvC,YAAd,MAAgCC,sCAAY,CAACgK,QAA9C,GAA2DhK,sCAAY,CAACgK,QAAxE,GAAmFhK,sCAAY,CAACC,UAA7G;CACA,YAAMS,gBAAgB,GAAG,KAAKqK,KAAL,CAAWwL,aAAX,GAA2B6C,qBAA3B,CAAiDrP,IAAjD,CAAzB;CACA,WAAKqN,aAAL,CAAmB1W,gBAAnB;CACA,aAAOA,gBAAP;CACA,KAhTF;;CAiTC2Y,IAAAA,cAAc,CAAC7a,QAAD,EACd;CACC,YAAMkC,gBAAgB,GAAG,KAAKqK,KAAL,CAAWwL,aAAX,GAA2B+C,iBAA3B,CAA6C9a,QAA7C,CAAzB;CACA,WAAK4Y,aAAL,CAAmB1W,gBAAnB;CACA,aAAQA,gBAAR;CACA,KAtTF;;CAuTC6Y,IAAAA,SAAS,CAACta,MAAD,EACT;CACC,YAAMyB,gBAAgB,GAAG,KAAKqK,KAAL,CAAWwL,aAAX,GAA2BiD,YAA3B,CAAwCva,MAAM,CAACuL,QAA/C,CAAzB;CACA9J,MAAAA,gBAAgB,CAACmW,MAAjB,GAA0B5X,MAAM,CAACqL,KAAjC;CACA,WAAK8M,aAAL,CAAmB1W,gBAAnB;CACA,aAAQA,gBAAR;CACA,KA7TF;;CA8TC+Y,IAAAA,iBAAiB,CAACrb,WAAD,EACjB;CACC,UAAIA,WAAW,KAAK,KAAK0M,UAAL,CAAgB1M,WAAhC,IAA+C,CAAC,KAAKsb,eAAL,CAAqB,KAAK/E,MAAL,CAAYzU,GAAjC,CAApD,EACA;CACC;CACA;;CAED,YAAMQ,gBAAgB,GAAG,KAAKqK,KAAL,CAAWwL,aAAX,GAA2BoD,oBAA3B,CAAgDvb,WAAhD,CAAzB;CACA,WAAKgZ,aAAL,CAAmB1W,gBAAnB;CACA,aAAQA,gBAAR;CACA,KAxUF;;CAyUCc,IAAAA,UAAU,GACV;CACC,UAAIuB,cAAI,CAACwU,aAAL,CAAmB,KAAK1Q,OAAL,CAAa8F,oBAAhC,CAAJ,EACA;CACC,eAAO,KAAK9F,OAAL,CAAa8F,oBAAb,CAAkC,KAAK7B,UAAL,CAAgB/L,OAAlD,CAAP;CACA;;CACD,WAAKoJ,KAAL,CAAW,YAAX,EAAyB;CACxBnG,QAAAA,KAAK,EAAE,KAAKwS;CADY,OAAzB;CAGA,KAlVF;;CAmVC7G,IAAAA,eAAe,CAACtO,IAAD,EACf;CACC,aAAO0D,cAAI,CAACsF,OAAL,CAAa,KAAKxB,OAAL,CAAakI,cAA1B,KAA6C,KAAKlI,OAAL,CAAakI,cAAb,CAA4B5E,QAA5B,CAAqC9K,IAArC,CAApD;CACA,KAtVF;;CAuVCua,IAAAA,cAAc,CAACva,IAAD,EACd;CACC,aAAO0D,cAAI,CAACsF,OAAL,CAAa,KAAKxB,OAAL,CAAagT,aAA1B,KAA4C,KAAKhT,OAAL,CAAagT,aAAb,CAA2B1P,QAA3B,CAAoC9K,IAApC,CAAnD;CACA,KA1VF;;CA2VCya,IAAAA,aAAa,GACb;CACC,aAAO,KAAKJ,eAAL,CAAqB,KAAK/E,MAAL,CAAYnV,KAAjC,IACJ,KAAKsL,UAAL,CAAgB7L,MAAhB,CAAuBQ,SADnB,GAEJ,KAAKqL,UAAL,CAAgB9J,YAFnB;CAIA,KAjWF;;CAkWC+Y,IAAAA,gBAAgB,GAChB;CACC,aAAO,KAAKL,eAAL,CAAqB,KAAK/E,MAAL,CAAYhV,QAAjC,IACJ,KAAKmL,UAAL,CAAgB7L,MAAhB,CAAuBU,QADnB,GAEJ,CAFH;CAIA,KAxWF;;CAyWCqa,IAAAA,WAAW,GACX;CACC,aAAO,KAAKN,eAAL,CAAqB,KAAK/E,MAAL,CAAYjW,MAAjC,IACJ,KAAKoM,UAAL,CAAgBvM,GADZ,GAEJ,KAAKuM,UAAL,CAAgB9J,YAFnB;CAIA,KA/WF;;CAgXCiZ,IAAAA,gBAAgB,GAChB;CACC,aAAO,KAAKP,eAAL,CAAqB,KAAK/E,MAAL,CAAYnW,QAAjC,IACJ,KAAKsM,UAAL,CAAgB7L,MAAhB,CAAuBT,QADnB,GAEJ,CAFH;CAIA,KAtXF;;CAuXC0b,IAAAA,oBAAoB,GACpB;CACC,aAAO,KAAKR,eAAL,CAAqB,KAAK/E,MAAL,CAAYnW,QAAjC,IACJ,KAAKsM,UAAL,CAAgB7L,MAAhB,CAAuBY,YADnB,GAEJ,CAFH;CAIA,KA7XF;;CA8XC+G,IAAAA,QAAQ,CAACvH,IAAD,EACR;CACC,UAAI,KAAKyL,UAAL,CAAgB1J,MAAhB,CAAuBQ,MAAvB,KAAkC,CAAlC,IAAwC,KAAKmJ,KAAL,CAAWoP,OAAX,MAAwB,CAAC,KAAKpP,KAAL,CAAWqP,SAAX,EAArE,EACA;CACC,eAAO,KAAP;CACA;;CAED,YAAMC,cAAc,GAAG,KAAKvP,UAAL,CAAgB1J,MAAhB,CAAuBkZ,MAAvB,CAA+BC,KAAD,IAAW;CAC/D,eAAOA,KAAK,CAAClb,IAAN,KAAeA,IAAtB;CACA,OAFsB,CAAvB;CAIA,aAAOgb,cAAc,CAACzY,MAAf,GAAwB,CAA/B;CACA,KA1YF;;CA2YC4Y,IAAAA,eAAe,GACf;CAAA;;CACC,aAAO,uBAAK3T,OAAL,mCAAc4T,cAAd,CAA6BtQ,QAA7B,CAAsCpF,aAAa,CAACI,KAApD,OAEL,KAAK4F,KAAL,CAAWkF,KAAX,MACG,CAAC,KAAKlF,KAAL,CAAW2P,gBAAX,EADJ,uBAEG,KAAK7T,OAFR,qBAEG,eAAc8T,yBAFjB,CAFK,CAAP;CAOA,KApZF;;CAqZCjB,IAAAA,eAAe,CAACra,IAAD,EACf;CAAA;;CACC,UAAIA,IAAI,KAAK0F,aAAa,CAACI,KAAvB,IAAgC,oBAAC,KAAK0B,OAAN,aAAC,eAAc8T,yBAAf,CAApC,EACA;CACC,eAAO,KAAKH,eAAL,EAAP;CACA;;CAED,+BAAO,KAAK3T,OAAZ,qBAAO,eAAc4T,cAAd,CAA6BtQ,QAA7B,CAAsC9K,IAAtC,CAAP;CACA,KA7ZF;;CA8ZCub,IAAAA,OAAO,CAACvb,IAAD,EACP;CAAA;;CACC,+BAAO,KAAKwH,OAAZ,qBAAO,eAAcgU,UAAd,CAAyBxb,IAAzB,CAAP;CACA,KAjaF;;CAkaCyb,IAAAA,OAAO,CAACzb,IAAD,EACP;CAAA;;CACC,UAAIA,IAAI,KAAK0F,aAAa,CAACI,KAAvB,IAAgC,oBAAC,KAAK0B,OAAN,aAAC,eAAc8T,yBAAf,CAApC,EACA;CACC,eAAO,CAAC,KAAKH,eAAL,EAAR;CACA;;CAED,aAAO,KAAP;CACA,KA1aF;;CA2aCO,IAAAA,eAAe,GACf;CACC,YAAMC,IAAI,GAAG,KAAKJ,OAAL,CAAa,KAAKjG,MAAL,CAAYnV,KAAzB,CAAb;;CACA,UAAIX,cAAI,CAACyD,QAAL,CAAc0Y,IAAd,oBAAcA,IAAI,CAAEC,YAApB,IAAoC,CAAxC,EACA;CACCC,QAAAA,GAAG,CAACC,EAAJ,CAAOC,MAAP,CAAcpS,IAAd,CAAmB,0BAA0BnK,cAAI,CAACyD,QAAL,CAAc0Y,IAAd,oBAAcA,IAAI,CAAEC,YAApB,CAA7C;CACA;CACD;;CAlbF,GA1EF;CA8fCI,EAAAA,KAAK,EACJ;CACCjd,IAAAA,WAAW,CAACkJ,KAAD,EAAQgU,QAAR,EAAiB;CAC3B,UAAIhU,KAAK,KAAKgU,QAAd,EACA;CACC,aAAK7B,iBAAL,CAAuBnS,KAAvB;CACA;CACD;;CANF,GA/fF;CAugBCkC,EAAAA,QAAQ,EACP;CACCC,IAAAA,QAAQ,GACR;CACC,aAAOxG,UAAG,CAACyG,kBAAJ,CAAuB,eAAvB,CAAP;CACA,KAJF;;CAKC9I,IAAAA,YAAY,GACZ;CACC,aAAO,KAAK2a,iBAAL,IAA0B,KAAKzQ,UAAL,CAAgBlK,YAAhB,KAAiC,GAAlE;CACA,KARF;;CASC4a,IAAAA,mBAAmB,GACnB;CACC,aAAO,KAAK1Q,UAAL,CAAgB9L,UAAhB,GAA6B,SAApC;CACA,KAZF;;CAaCyc,IAAAA,iBAAiB,GACjB;CACC,aAAO,KAAK3Q,UAAL,CAAgB7L,MAAhB,CAAuBS,cAAvB,IAAyC,KAAKoL,UAAL,CAAgB7L,MAAhB,CAAuBO,KAAvE;CACA,KAhBF;;CAiBC+b,IAAAA,iBAAiB,GACjB;CACC,aAAO,KAAK1U,OAAL,CAAa0U,iBAAb,KAAmC,GAAnC,IACH,KAAK3B,cAAL,CAAoB,KAAKjF,MAAL,CAAYnW,QAAhC,CADG,IAEH,CAAC,KAAK+Z,UAFV;CAIA,KAvBF;;CAwBCmD,IAAAA,YAAY,GACZ;CACC,aAAO,KAAK7U,OAAL,CAAa6U,YAAb,KAA8B,GAA9B,IACH,KAAKjR,UAAL,CAAgB7I,MAAhB,GAAyB,CADtB,IAEH,KAAKgY,cAAL,CAAoB,KAAKjF,MAAL,CAAYzU,GAAhC,CAFG,IAGH,CAAC,KAAKqY,UAHV;CAKA,KA/BF;;CAgCCoD,IAAAA,cAAc,GACd;CACC,UAAI,KAAKpD,UAAT,EACA;CACC,eAAO,KAAP;CACA;;CAED,UAAI,KAAK9D,UAAL,GAAkB,CAAtB,EACA;CACC,eAAO,IAAP;CACA;;CAED,aAAO,CAAC1R,cAAI,CAACC,KAAL,CAAW,KAAK8H,UAAL,CAAgB/L,OAA3B,CAAR;CACA,KA7CF;;CA8CC6c,IAAAA,eAAe,GACf;CACC,aAAO,KAAK9Q,UAAL,CAAgBjK,OAAhB,KAA4B,GAAnC;CACA,KAjDF;;CAkDCgb,IAAAA,aAAa,GACb;CACC,aAAO,KAAK/Q,UAAL,CAAgB7L,MAAhB,CAAuBT,QAAvB,GAAkC,CAAlC,IACFK,cAAI,CAACyD,QAAL,CAAc,KAAKwI,UAAL,CAAgB7L,MAAhB,CAAuBO,KAArC,MAAgDX,cAAI,CAACyD,QAAL,CAAc,KAAKwI,UAAL,CAAgB7L,MAAhB,CAAuBQ,SAArC,CADrD;CAGA,KAvDF;;CAwDCqc,IAAAA,cAAc,GACd;CACC,aAAO,KAAKhR,UAAL,CAAgB7L,MAAhB,CAAuBmB,WAAvB,IAAsC,KAAKsU,cAAL,CAAoB9U,IAAjE;CACA,KA3DF;;CA4DCmc,IAAAA,cAAc,GACd;CACC,aAAO,KAAKjR,UAAL,CAAgB7L,MAAhB,CAAuBkB,WAAvB,IAAsC,KAAKuU,cAAL,CAAoBrV,IAAjE;CACA,KA/DF;;CAgECoL,IAAAA,UAAU,GACV;CACC,aAAO1H,cAAI,CAACsF,OAAL,CAAa,KAAKxB,OAAL,CAAa+D,OAA1B,IAAqC,KAAK/D,OAAL,CAAa+D,OAAlD,GAA4D,EAAnE;CACA,KAnEF;;CAoECxM,IAAAA,WAAW,GACX;CACC,aAAO,KAAK0M,UAAL,CAAgB7L,MAAhB,CAAuBb,WAA9B;CACA,KAvEF;;CAwEC4d,IAAAA,aAAa,GACb;CACC,aAAO,KAAK5d,WAAL,KAAqB,GAA5B;CACA,KA3EF;;CA4ECma,IAAAA,UAAU,GACV;CACC,aAAO,KAAKnK,IAAL,KAAcpI,QAAQ,CAACE,SAA9B;CACA,KA/EF;;CAgFC+V,IAAAA,aAAa,GACb;CACC,UAAIC,SAAS,GAAG,KAAKpR,UAAL,CAAgB1J,MAAhB,CAAuBQ,MAAvB,KAAkC,CAAlC,IAAuC,CAAC,KAAKmJ,KAAL,CAAWoP,OAAX,EAAxC,IAAgE,KAAKpP,KAAL,CAAWqP,SAAX,EAAhE,GACbvC,aAAG,CAACC,UAAJ,CAAe,0CAAf,CADa,GAEb,EAFH;CAIA,YAAMpL,iBAAiB,GAAG,KAAK5B,UAAL,CAAgB/L,OAA1C;CACA,YAAM4N,oBAAoB,GAAG,KAAK9F,OAAL,CAAa8F,oBAA1C;CACA,YAAMwP,4BAA4B,GAAGpZ,cAAI,CAAC8J,QAAL,CAAcF,oBAAd,IAClCA,oBAAoB,CAACD,iBAAD,CADc,GAElC,IAFH;;CAKA,UAAIyP,4BAAJ,EACA;CACC,YAAID,SAAJ,EACA;CACCA,UAAAA,SAAS,IAAI,MAAb;CACA;;CACDA,QAAAA,SAAS,IACRrE,aAAG,CAACC,UAAJ,CAAe,6BAAf,IACE,OADF,GAEEqE,4BAHH;CAKA;;CAED,aAAOD,SAAP;CACA,KA3GF;;CA4GCE,IAAAA,MAAM,GACN;CACC,aAAO,KAAKtR,UAAL,CAAgBhK,OAAhB,KAA4B,EAAnC;CACA;;CA/GF,GAxgBF;CAynBC;CACAsI,EAAAA,QAAQ,EAAG;;;;;;;;;;;;SAYJpF,MAAM,CAACO,2BAA4B;;;;;;;;;;;;;;;;;;;;;;;SAuBnCP,MAAM,CAACa,kBAAmB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;UA+BzBb,MAAM,CAACQ,kBAAmB;;;;;;;;;;;;UAY1BR,MAAM,CAACU,qBAAsB;;;;;;;;;;;;;;UAc7BV,MAAM,CAACS,sBAAuB;;;;;;;;;;;;;;;;;;;;;SAqB/BT,MAAM,CAACW,qBAAsB;;;;;;;;;;;;;;;;;SAiB7BX,MAAM,CAACY,gBAAiB;;;;;;;;;;;;;;;;;CA5vBhC,CADD;;CCxBO,MAAMyX,mBAAN,CACP;CADaA,oBAELpW,UAAkB;CAFboW,oBAGLC,WAAmB;;CCHpB,MAAMC,gBAAN,CACP;CADaA,iBAELC,uBAA+B;CAF1BD,iBAGLE,qBAA6B;;;;;;;;;;;;ACgBrCxZ,WAAG,CAACoD,SAAJ,CAAcrC,MAAM,CAACK,wBAArB,EACA;CACCiC,EAAAA,KAAK,EAAE;CACNoW,IAAAA,kBAAkB,EAAEha,MADd;CAEN0L,IAAAA,IAAI,EAAE5H;CAFA,GADR;;CAKCM,EAAAA,OAAO,GACP;CACC,SAAK6V,QAAL,GAAgB,IAAIC,cAAJ,CAAU;CACzBpU,MAAAA,IAAI,EAAE,KAAKiB,QAAL,CAAcoT,0CADK;CAEzBC,MAAAA,KAAK,EAAEC,mBAAU,CAACC,OAFO;CAGzBC,MAAAA,IAAI,EAAE;CAHmB,KAAV,CAAhB;CAKA,SAAKC,KAAL,GAAa,IAAb;CACA,SAAKC,eAAL,GAAuB,IAAvB;CAEA,UAAMC,iBAAiB,GAAGjM,aAAG,CAACkB,MAAP,oBAAc;sCAAd,CACqE;GADrE,GACa,KAAK5I,QAAL,CAAc4T,yCAD3B,CAAvB;CAIAC,IAAAA,eAAK,CAACjS,IAAN,CAAW+R,iBAAX,EAA8B,OAA9B,EAAuC,KAAKG,YAA5C;CAEA,QAAIC,MAAM,GAAG,EAAb;CACA,QAAIC,WAAW,GAAG,EAAlB;;CACA,QAAI,KAAKtR,cAAL,EAAJ,EACA;CACCqR,MAAAA,MAAM,GAAG,KAAK/T,QAAL,CAAciU,oDAAvB;CACAD,MAAAA,WAAW,GAAGtM,aAAG,CAACkB,MAAP,sBAAc;SAAd,CACyE;SADzE,CAE0E;IAF1E,GACL,KAAK5I,QAAL,CAAckU,+DADT,EAEL,KAAKlU,QAAL,CAAcmU,gEAFT,CAAX;CAIA,KAPD,MASA;CACCJ,MAAAA,MAAM,GAAG,KAAK/T,QAAL,CAAcoU,2CAAvB;CACAJ,MAAAA,WAAW,GAAG,KAAKhU,QAAL,CAAcqU,sDAA5B;CACA;;CAED,SAAK1M,OAAL,GAAe,IAAI2M,0BAAJ,CAAgB;CAC9BpT,MAAAA,EAAE,EAAE,iBAD0B;CAE9B6S,MAAAA,MAF8B;CAG9BC,MAAAA,WAH8B;CAI9BO,MAAAA,KAAK,EAAE,KAJuB;CAK9BC,MAAAA,MAAM,EAAE,IALsB;CAM9BC,MAAAA,cAAc,EAAE,CAACd,iBAAD;CANc,KAAhB,CAAf;CASAlS,IAAAA,6BAAY,CAACC,SAAb,CAAuB,KAAKiG,OAA5B,EAAqC,SAArC,EAAgD,KAAK+M,WAArD;CACA,GA/CF;;CAgDCxS,EAAAA,OAAO,GACP;CACC,SAAKI,KAAL,CAAWqS,KAAX,CAAiBhM,WAAjB,CAA6B,KAAKuK,QAAL,CAActK,MAAd,EAA7B;CACA,SAAKtG,KAAL,CAAWqF,OAAX,CAAmBgB,WAAnB,CAA+B,KAAKhB,OAAL,CAAaiN,SAAb,EAA/B;;CACA,QAAI,CAAC,KAAK3B,kBAAL,CAAwB4B,iBAA7B,EACA;CACC,WAAKC,WAAL;CACA;CACD,GAxDF;;CAyDChU,EAAAA,IAAI,GACJ;CACC,WAAO;CACN4S,MAAAA,eAAe,EAAE;CADX,KAAP;CAGA,GA9DF;;CA+DChW,EAAAA,OAAO,EACP;CACCgF,IAAAA,cAAc,GACd;CACC,aAAO,KAAKuQ,kBAAL,CAAwB3S,IAAxB,KAAiCsS,mBAAmB,CAACC,QAA5D;CACA,KAJF;;CAKCiB,IAAAA,YAAY,GACZ;CACC,WAAKiB,YAAL,GACC,KAAKrS,cAAL,KACGoQ,gBAAgB,CAACC,oBADpB,GAEGD,gBAAgB,CAACE,kBAHrB;CAMAvB,MAAAA,GAAG,CAACC,EAAJ,CAAOC,MAAP,CAAcpS,IAAd,CAAmB,0BAA0B,KAAKwV,YAAlD;CACA,KAdF;;CAeCC,IAAAA,SAAS,CAACrX,KAAD,EACT;CACC,UAAI,KAAKsV,kBAAL,CAAwBgC,gBAA5B,EACA;CACC;CACA;;CAED,UAAI,KAAKvS,cAAL,EAAJ,EACA;CACC,aAAKoR,YAAL;CACA;CACA;;CAED,UAAI,KAAKL,KAAL,YAAsByB,gBAA1B,EACA;CACC,aAAKzB,KAAL,CAAW0B,cAAX,CAA0B,KAAK7S,KAAL,CAAW8S,MAArC;CACA,aAAK3B,KAAL,CAAWlU,IAAX;CACA;CACA;;CACD,YAAM3K,MAAM,GAAG,KAAKygB,MAAL,CAAYC,OAAZ,CAAoB,uBAApB,GAAf;CACA,YAAMC,UAAU,GAAG3gB,MAAM,CAACyU,GAAP,CAAYhI,UAAD,IAAgB;CAAA;;CAC7C,eAAOA,UAAP,0CAAOA,UAAU,CAAE7L,MAAnB,qBAAO,mBAAoBG,KAA3B;CACA,OAFkB,CAAnB;CAIA,aAAO,IAAIkU,OAAJ,CACN,CAACC,OAAD,EAAUC,MAAV,KAAqB;CACpBI,QAAAA,cAAI,CAACC,SAAL,CACC,2CADD,EAEC;CACCtJ,UAAAA,IAAI,EAAE;CACLyU,YAAAA,UADK;CAELnY,YAAAA,OAAO,EAAE;CACRoY,cAAAA,OAAO,EAAE,KAAKzT,KAAL,CAAWC,IAAX,CAAgB5E,OAAhB,CAAwBoY,OADzB;CAERC,cAAAA,WAAW,EAAE,KAAK1T,KAAL,CAAWC,IAAX,CAAgB5E,OAAhB,CAAwBqY,WAF7B;CAGRC,cAAAA,QAAQ,EAAE,KAAK3T,KAAL,CAAWC,IAAX,CAAgB5E,OAAhB,CAAwBsY,QAH1B;CAIRC,cAAAA,SAAS,EAAE,KAAK5T,KAAL,CAAWC,IAAX,CAAgB5E,OAAhB,CAAwBuY;CAJ3B;CAFJ;CADP,SAFD,EAcEtL,IAdF,CAcOC,QAAQ,IAAI;CAAA;;CACjB,eAAKoJ,eAAL,0BAAuBpJ,QAAQ,CAACxJ,IAAT,CAAc8U,IAArC,kCAA6C,IAA7C;CACAnU,UAAAA,6BAAY,CAACoU,IAAb,CACC,KAAK9T,KAAL,CAAWC,IADZ,EAEC,kCAFD,EAGC;CACC8T,YAAAA,aAAa,2BAAExL,QAAQ,CAACxJ,IAAT,CAAcgV,aAAhB,oCAAiC,IAD/C;CAECN,YAAAA,OAAO,2BAAElL,QAAQ,CAACxJ,IAAT,CAAc0U,OAAhB,oCAA2B;CAFnC,WAHD;CAQA,eAAK/B,KAAL,GAAa,IAAIyB,gBAAJ,CAAU;CACtB7V,YAAAA,WAAW,EAAE1B,KAAK,CAACC,MADG;CAEtBmY,YAAAA,OAAO,EAAE,KAAKC,iBAAL,EAFa;CAGtBC,YAAAA,KAAK,EAAE,GAHe;CAItBC,YAAAA,SAAS,EAAE;CAAEzE,cAAAA,GAAG,EAAE,KAAP;CAAc0E,cAAAA,KAAK,EAAE;CAArB,aAJW;CAKtBC,YAAAA,OAAO,EAAE,CALa;CAMtBC,YAAAA,UAAU,EAAE,IANU;CAOtBC,YAAAA,QAAQ,EAAE,IAPY;CAQtBC,YAAAA,SAAS,EAAE,IARW;CAStBC,YAAAA,SAAS,EAAE,cATW;CAUtBjC,YAAAA,KAAK,EAAE;CAAEkC,cAAAA,MAAM,EAAE;CAAV;CAVe,WAAV,CAAb;CAaA,eAAKhD,KAAL,CAAWlU,IAAX;CACAuK,UAAAA,OAAO;CACP,SAvCF,EAwCEa,KAxCF,CAwCQ,MAAMZ,MAAM,EAxCpB;CAyCA,OA3CK,CAAP;CA4CA,KAnFF;;CAoFCiM,IAAAA,iBAAiB,GACjB;CACC,UAAI,CAAC,KAAKtC,eAAV,EACA;CACC,eAAO,EAAP;CACA;;CAED,YAAMgD,UAAU,GAAGhP,aAAG,CAACkB,MAAP,sBAAc;oDAAd,CACgF;IADhF,GACiC,KAAK5I,QAAL,CAAc2W,gCAD/C,CAAhB;CAIA9C,MAAAA,eAAK,CAACjS,IAAN,CAAW8U,UAAX,EAAuB,OAAvB,EAAgC,MAAM;CACrChF,QAAAA,EAAE,CAACkF,SAAH,CAAaC,IAAb,CAAkB,KAAKnD,eAAvB;CACAhC,QAAAA,EAAE,CAACoF,EAAH,CAAMC,YAAN,CAAmBC,MAAnB,CAA0BC,MAA1B,CAAiC;CAChClB,UAAAA,OAAO,EAAE,KAAK/V,QAAL,CAAckX,+CADS;CAEhCC,UAAAA,aAAa,EAAE;CAFiB,SAAjC;CAIA,OAND;CAQA,YAAMC,SAAS,GAAG1P,aAAG,CAACkB,MAAP,kBAAc,uDAAd,EAAf;CAEA,YAAMmN,OAAO,GAAGrO,aAAG,CAACkB,MAAP,kBAAc;;;uDAAd,CAG6F;SAH7F,CAIG;;mBAJH,CAMwB,qEANxB,CAMwJ;;;;kBANxJ,CAUuB,8DAVvB,CAUyG;SAVzG,CAWI;;;KAXJ,GAGuC,KAAK5I,QAAL,CAAcqX,uCAHrD,EAIPD,SAJO,EAMG,KAAK1D,eANR,EAM4F,KAAK1T,QAAL,CAAcsX,6CAN1G,EAUE,KAAK5D,eAVP,EAUoF,KAAKA,eAVzF,EAWPgD,UAXO,CAAb;CAgBA,UAAIa,MAAJ,CAAWH,SAAX,EAAsB;CACrBrY,QAAAA,IAAI,EAAE,KAAK2U,eADU;CAErBuC,QAAAA,KAAK,EAAE,GAFc;CAGrBuB,QAAAA,MAAM,EAAE;CAHa,OAAtB;CAMA,aAAOzB,OAAP;CACA,KAhIF;;CAiIC0B,IAAAA,UAAU,CAAC9Z,KAAD,EACV;CACC,YAAME,KAAK,GAAGF,KAAK,CAACC,MAAN,CAAa8Z,OAAb,GAAuB,GAAvB,GAA6B,GAA3C;CACA,WAAK3V,KAAL,CAAWC,IAAX,CAAgB0M,gBAAhB,CAAiC,mBAAjC,EAAsD7Q,KAAtD;CACA,KArIF;;CAsIC8Z,IAAAA,oCAAoC,GACpC;CACC,YAAMC,aAAa,GAAGlQ,aAAG,CAACkB,MAAP,kBAAc;;IAAd,EAAnB;CAIA,YAAMiP,IAAI,GAAGnQ,aAAG,CAACkB,MAAP,kBAAc;;sDAAd,CAEsG;OAFtG,CAGQ;qDAHR,CAI0G;;IAJ1G,GAEyCwF,aAAG,CAACC,UAAJ,CAAe,4CAAf,CAFzC,EAGNuJ,aAHM,EAIwCxJ,aAAG,CAACC,UAAJ,CAAe,iDAAf,CAJxC,CAAV;CAQA,YAAMyJ,MAAM,GAAG,IAAIC,kBAAJ,CAAW;CACzB1E,QAAAA,KAAK,EAAE,SADkB;CAEzBzV,QAAAA,MAAM,EAAEga,aAFiB;CAGzBI,QAAAA,IAAI,EAAE;CAHmB,OAAX,CAAf;CAMAF,MAAAA,MAAM,CAACvY,IAAP;CAEA,aAAOsY,IAAP;CACA,KA7JF;;CA8JCI,IAAAA,mCAAmC,CAACC,kBAAD,EACnC;CACC,YAAMC,cAAc,GAAGzQ,aAAG,CAACkB,MAAP,kBAAc;;OAAd,CAEoD;;IAFpD,GAEhBwF,aAAG,CAACC,UAAJ,CAAe,mDAAf,CAFgB,CAApB;CAKAwF,MAAAA,eAAK,CAACjS,IAAN,CAAWuW,cAAX,EAA2B,OAA3B,EAAoC,KAAKC,uBAAL,CAA6BxW,IAA7B,CAAkC,IAAlC,EAAwCsW,kBAAxC,CAApC;CACA,aAAOxQ,aAAG,CAACkB,MAAX,kBAAkB;;sDAAlB,CAE+G;;qDAF/G,CAImH;iEAJnH,CAK6E;;IAL7E,GAEmDwF,aAAG,CAACC,UAAJ,CAAe,2CAAf,CAFnD,EAIkDD,aAAG,CAACC,UAAJ,CAAe,gDAAf,CAJlD,EAK8D8J,cAL9D;CAQA,KA9KF;;CA+KCC,IAAAA,uBAAuB,CAACF,kBAAD,EACvB;CACCA,MAAAA,kBAAkB,CAACxY,KAAnB;CACA,KAlLF;;CAmLC2Y,IAAAA,YAAY,GACZ;CACC,UAAI,KAAKpF,kBAAL,CAAwBqF,cAA5B,EACA;CACC5G,QAAAA,EAAE,CAACoF,EAAH,CAAMyB,UAAN,CAAiBhZ,IAAjB,CAAsB,oBAAtB;CACA;CACD,KAzLF;;CA0LCiZ,IAAAA,WAAW,CAAC7a,KAAD,EACX;CACCA,MAAAA,KAAK,CAAC8a,cAAN;CACA9a,MAAAA,KAAK,CAAC+a,wBAAN;;CACA,UAAI,CAAC,KAAK/Q,OAAV,EACA;CACC;CACA;;CACD,UAAI,KAAKA,OAAL,CAAagR,OAAb,EAAJ,EACA;CACC,aAAKjE,WAAL;CACA,OAHD,MAKA;CACC,aAAKI,WAAL;CACA;CACD,KA1MF;;CA2MCA,IAAAA,WAAW,GACX;CACC,UAAI,KAAKnN,OAAT,EACA;CACCiR,QAAAA,aAAG,CAACC,QAAJ,CAAa,KAAKvW,KAAL,CAAWwW,QAAxB,EAAkC,+CAAlC;CACA,aAAKnR,OAAL,CAAapI,IAAb;CACA;CACD,KAlNF;;CAmNCmV,IAAAA,WAAW,GACX;CACC,UAAI,KAAK/M,OAAT,EACA;CACCiR,QAAAA,aAAG,CAACG,WAAJ,CAAgB,KAAKzW,KAAL,CAAWwW,QAA3B,EAAqC,+CAArC;CACA;;CACD,WAAKnR,OAAL,CAAa+C,IAAb;CACA,WAAK3I,KAAL,CAAWC,IAAX,CAAgB0M,gBAAhB,CAAiC,8BAAjC,EAAiE,GAAjE;CACA;;CA3NF,GAhED;CA6RC3O,EAAAA,QAAQ,EACR;CACCC,IAAAA,QAAQ,GACR;CACC,aAAOxG,UAAG,CAACyG,kBAAJ,CAAuB,UAAvB,CAAP;CACA,KAJF;;CAMC+Y,IAAAA,UAAU,GACV;CACC,aAAO,KAAKrU,IAAL,KAAcpI,QAAQ,CAACG,WAA9B;CACA,KATF;;CAWC,OAAGuc,gBAAI,CAACC,QAAL,CAAc;CAChBC,MAAAA,WAAW,EAAElhB,KAAK,IAAIA,KAAK,CAACkhB;CADZ,KAAd;CAXJ,GA9RD;CA6SC;CACAxZ,EAAAA,QAAQ,EAAG;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;CA9SZ,CADA;;;;;;;ACTAnG,WAAG,CAACoD,SAAJ,CAAcrC,MAAM,CAACI,oBAArB,EACA;CACC;CACD;CACA;CACA;CACA;CAECkC,EAAAA,KAAK,EAAE;CACNO,IAAAA,OAAO,EAAEnE,MADH;CAEN0L,IAAAA,IAAI,EAAE5H;CAFA,GAPR;;CAWC+D,EAAAA,IAAI,GACJ;CACC,WAAO;CACNsY,MAAAA,QAAQ,EAAE;CADJ,KAAP;CAGA,GAhBF;;CAiBC1b,EAAAA,OAAO,EACP;CACC2b,IAAAA,aAAa,GACb;CACC,WAAK3a,KAAL,CAAW,eAAX;CACA,KAJF;;CAKC4a,IAAAA,gBAAgB,CAACjhB,IAAD,EAChB;CACC,WAAKqG,KAAL,CAAW,eAAX,EAA4BrG,IAA5B;CACA,KARF;;CASCkhB,IAAAA,iBAAiB,GACjB;CACC,WAAK7a,KAAL,CAAW,SAAX;CACA,KAZF;;CAaC8a,IAAAA,2BAA2B,CAAC7jB,KAAD,EAC3B;CACC,YAAMf,MAAM,GAAG,KAAKygB,MAAL,CAAYC,OAAZ,CAAoB,uBAApB,GAAf;CACA,aAAOrc,MAAM,CACXwgB,IADK,CACA7kB,MADA,EAEL8kB,SAFK,CAEMC,GAAD,IAAQ;CAClB,eAAOC,QAAQ,CAAChlB,MAAM,CAAC+kB,GAAD,CAAN,CAAYhkB,KAAb,CAAR,KAAgCikB,QAAQ,CAACjkB,KAAD,CAA/C;CACA,OAJK,CAAP;CAKA,KArBF;;CAsBCkkB,IAAAA,aAAa,CAAC3Y,EAAD,EAAK1B,MAAL,EACb;CACC,YAAMsa,OAAO,GAAG,CAAhB;;CACA,UAAI1kB,cAAI,CAACyD,QAAL,CAAc2G,MAAM,CAACc,IAArB,MAA+BwZ,OAAnC,EACA;CACC3P,QAAAA,cAAI,CAACC,SAAL,CACC,wCADD,EAEC;CACC2P,UAAAA,IAAI,EAAE;CACLC,YAAAA,WAAW,EAAE9Y,EADR;CAEL9D,YAAAA,OAAO,EAAE;CACR6c,cAAAA,OAAO,EAAE,KAAK7c,OAAL,CAAamG,WADd;CAER2W,cAAAA,UAAU,EAAE,KAAK9c,OAAL,CAAa8c,UAFjB;CAGRxlB,cAAAA,QAAQ,EAAE,KAAK0I,OAAL,CAAa1I,QAHf;CAIRylB,cAAAA,QAAQ,EAAE;CAJF;CAFJ;CADP,SAFD,EAaE9P,IAbF,CAaOC,QAAQ,IAAI,KAAK8P,eAAL,CAAqB9P,QAArB,EAA+B9K,MAAM,CAAC6a,WAAtC,CAbnB;CAcA,OAhBD,MAkBA;CACClQ,QAAAA,cAAI,CAACC,SAAL,CACC,oCADD,EAEC;CACC2P,UAAAA,IAAI,EAAE;CACLrkB,YAAAA,SAAS,EAAEwL,EADN;CAEL9D,YAAAA,OAAO,EAAE;CACR6c,cAAAA,OAAO,EAAE,KAAK7c,OAAL,CAAamG,WADd;CAER2W,cAAAA,UAAU,EAAE,KAAK9c,OAAL,CAAa8c,UAFjB;CAGRxlB,cAAAA,QAAQ,EAAE,KAAK0I,OAAL,CAAa1I;CAHf;CAFJ;CADP,SAFD,EAYE2V,IAZF,CAYOC,QAAQ,IAAI,KAAK8P,eAAL,CAAqB9P,QAArB,EAA+B9K,MAAM,CAAC6a,WAAtC,CAZnB;CAaA;CACD,KA1DF;;CA2DCD,IAAAA,eAAe,CAAC9P,QAAD,EAAW+P,WAAX,EACf;CACC,YAAM9hB,KAAK,GAAG8hB,WAAW,GAAG,CAAC,CAAJ,GAAQ,KAAKb,2BAAL,CAAiClP,QAAQ,CAACxJ,IAAT,CAAcnL,KAA/C,CAAjC;;CACA,UAAI4C,KAAK,GAAG,CAAZ,EACA;CACC,cAAM+hB,WAAW,GAAGhQ,QAAQ,CAACxJ,IAA7B;CACA,cAAM9K,SAAS,GAAGZ,cAAI,CAACyD,QAAL,CAAcyhB,WAAW,CAAC9kB,MAAZ,CAAmBmQ,UAAjC,CAAlB;CACA2U,QAAAA,WAAW,CAAC9kB,MAAZ,GAAqB8kB,WAAW,CAAC9kB,MAAZ,IAAsB,EAA3C;CACA,YAAI+kB,OAAO,GAAG,KAAKlF,MAAL,CAAYC,OAAZ,CAAoB,4BAApB,GAAd;CACAiF,QAAAA,OAAO,CAAC/kB,MAAR,GAAiByD,MAAM,CAACC,MAAP,CAAcqhB,OAAO,CAAC/kB,MAAtB,EAA8B;CAC9CO,UAAAA,KAAK,EAAEC,SADuC;CAE9CC,UAAAA,cAAc,EAAED,SAF8B;CAG9CA,UAAAA,SAH8C;CAI9CG,UAAAA,IAAI,EAAEmkB,WAAW,CAAC9kB,MAAZ,CAAmBsN,IAAnB,IAA2B,EAJa;CAK9CpN,UAAAA,SAAS,EAAE4kB,WAAW,CAAC5kB,SALuB;CAM9CC,UAAAA,KAAK,EAAE2kB,WAAW,CAAC3kB,KAN2B;CAO9Ce,UAAAA,WAAW,EAAE4jB,WAAW,CAAC9kB,MAAZ,CAAmB0Q,YAPc;CAQ9CvP,UAAAA,WAAW,EAAE2jB,WAAW,CAAC9kB,MAAZ,CAAmB2Q,YARc;CAS9CvP,UAAAA,YAAY,EAAE0jB,WAAW,CAAC9kB,MAAZ,CAAmBglB,aATa;CAU9CzjB,UAAAA,UAAU,EAAEujB,WAAW,CAAC9kB,MAAZ,CAAmBwQ,UAVe;CAW9C1Q,UAAAA,OAAO,EAAEglB,WAAW,CAAC3kB,KAAZ,GAAoB,CAApB,GAAwB2kB,WAAW,CAAC3kB,KAApC,GAA4C2kB,WAAW,CAAC5kB,SAXnB;CAY9CG,UAAAA,MAAM,EAAE,SAZsC;CAa9CgB,UAAAA,aAAa,EAAEyC,cAAI,CAACC,KAAL,CAAW+gB,WAAW,CAAC9kB,MAAZ,CAAmBkG,KAA9B,IAAuC,GAAvC,GAA6C,GAbd;CAc9CpF,UAAAA,YAAY,EAAE,KAAK8G,OAAL,CAAaqd;CAdmB,SAA9B,CAAjB;CAiBA,eAAOH,WAAW,CAAC9kB,MAAnB;CACA+kB,QAAAA,OAAO,GAAGthB,MAAM,CAACC,MAAP,CAAcqhB,OAAd,EAAuBD,WAAvB,CAAV;CACAC,QAAAA,OAAO,CAACzlB,GAAR,GAAckB,SAAd;CAEA,aAAK+L,KAAL,CAAWC,IAAX,CAAgB0Y,UAAhB,CAA2BH,OAA3B;CACA;CACD,KA3FF;;CA4FCI,IAAAA,kBAAkB,CAAChB,GAAD,EAAMthB,IAAN,EAClB;CACC,WAAKgd,MAAL,CAAYrd,QAAZ,CAAqB,2BAArB,EAAkD;CACjDO,QAAAA,KAAK,EAAGohB,GADyC;CAEjDnkB,QAAAA,MAAM,EAAG6C;CAFwC,OAAlD;CAIA,WAAKgd,MAAL,CAAYrd,QAAZ,CAAqB,2BAArB,EAAkD;CACjDO,QAAAA,KAAK,EAAGohB,GADyC;CAEjDnkB,QAAAA,MAAM,EAAG6C,IAAI,CAAC7C;CAFmC,OAAlD;CAIA,KAtGF;;CAuGC;CACF;CACA;CACA;CACA;CACA;CACEolB,IAAAA,gBAAgB,GAChB;CACC,YAAMhmB,MAAM,GAAG,KAAKygB,MAAL,CAAYC,OAAZ,CAAoB,uBAApB,GAAf;CACA1gB,MAAAA,MAAM,CAACwD,OAAP,CAAe,CAACC,IAAD,EAAOC,CAAP,KAAW;CACzB,YACC1D,MAAM,CAAC0D,CAAD,CAAN,CAAUnC,IAAV,KAAmB,EAAnB,IACGvB,MAAM,CAAC0D,CAAD,CAAN,CAAUvC,KAAV,GAAkB,KAFtB,EAIA;CACC,eAAKsf,MAAL,CAAYvd,MAAZ,CAAmB,wBAAnB,EAA6C;CAC5CS,YAAAA,KAAK,EAAED;CADqC,WAA7C;CAGA;CACD,OAVD;CAWA,KA3HF;;CA4HCuiB,IAAAA,gBAAgB,CAACrb,MAAD,EAChB;CACC,YAAM7J,KAAK,GAAGikB,QAAQ,CAACpa,MAAM,CAAC0B,EAAR,CAAtB;;CACA,UAAGvL,KAAK,GAAG,CAAX,EACA;CACC,cAAM4C,KAAK,GAAG,KAAKihB,2BAAL,CAAiC7jB,KAAjC,CAAd;;CACA,YAAG4C,KAAK,IAAI,CAAZ,EACA;CACC,eAAKuiB,uBAAL,CAA6Btb,MAA7B;CACA,SAHD,MAKA;CACC,eAAKob,gBAAL;CACA,eAAKf,aAAL,CAAmBlkB,KAAnB,EAA0B6J,MAA1B;CACA;CACD;CACD,KA5IF;;CA6ICsb,IAAAA,uBAAuB,CAACtb,MAAD,EACvB;CACC,WAAKiU,KAAL,GAAa,IAAIyB,gBAAJ,CAAU,IAAV,EAAgB,IAAhB,EAAsB;CAClC/N,QAAAA,MAAM,EAAE;CACP4T,UAAAA,YAAY,EAAE,MAAM;CAAC,iBAAKtH,KAAL,CAAWuH,OAAX;CAAqB;CADnC,SAD0B;CAIlCC,QAAAA,MAAM,EAAE,IAJ0B;CAKlC3E,QAAAA,QAAQ,EAAE,IALwB;CAMlCD,QAAAA,UAAU,EAAE,IANsB;CAOlCH,QAAAA,SAAS,EAAE,IAPuB;CAQlCgF,QAAAA,QAAQ,EAAE9M,aAAG,CAACC,UAAJ,CAAe,yCAAf,CARwB;CASlC8M,QAAAA,SAAS,EAAE,IATuB;CAUlCC,QAAAA,SAAS,EAAE,KAVuB;CAWlCC,QAAAA,WAAW,EAAE,IAXqB;CAYlC9E,QAAAA,SAAS,EAAE,KAZuB;CAalC+E,QAAAA,OAAO,EAAE,IAbyB;CAclCvF,QAAAA,OAAO,EAAE3H,aAAG,CAACC,UAAJ,CAAe,mDAAf,EAAoEvQ,OAApE,CAA4E,QAA5E,EAAsF0B,MAAM,CAACrJ,IAA7F,CAdyB;CAelColB,QAAAA,OAAO,EAAE,KAAKC,UAAL,CAAgBhc,MAAhB;CAfyB,OAAtB,CAAb;CAkBA,WAAKiU,KAAL,CAAWlU,IAAX;CACA,KAlKF;;CAmKCic,IAAAA,UAAU,CAAC9hB,OAAD,EACV;CACC,YAAM6hB,OAAO,GAAG,EAAhB;CACA,YAAM/b,MAAM,GAAG9F,OAAf;CACA6hB,MAAAA,OAAO,CAACpiB,IAAR,CACC,IAAIuY,EAAE,CAACoF,EAAH,CAAM2E,UAAV,CACC;CACC1c,QAAAA,IAAI,EAAGqP,aAAG,CAACC,UAAJ,CAAe,sCAAf,CADR;CAECpP,QAAAA,OAAO,EAAE,MAAM;CACd,gBAAMvJ,SAAS,GAAGkkB,QAAQ,CAACpa,MAAM,CAAC0B,EAAR,CAA1B;CACA,gBAAM3I,KAAK,GAAG,KAAKihB,2BAAL,CAAiC9jB,SAAjC,CAAd;;CACA,cAAG6C,KAAK,IAAI,CAAZ,EACA;CACC,iBAAKshB,aAAL,CAAmBnkB,SAAnB,EAA8B,EAC7B,GAAG8J,MAD0B;CAE7B6a,cAAAA,WAAW,EAAE;CAFgB,aAA9B;CAIA;;CACD,eAAK5G,KAAL,CAAWuH,OAAX;CACA;CAbF,OADD,CADD;CAoBAO,MAAAA,OAAO,CAACpiB,IAAR,CACC,IAAIuY,EAAE,CAACoF,EAAH,CAAM4E,YAAV,CACC;CACC3c,QAAAA,IAAI,EAAGqP,aAAG,CAACC,UAAJ,CAAe,sCAAf,CADR;CAECpP,QAAAA,OAAO,EAAE,MAAM;CAAC,eAAKwU,KAAL,CAAWuH,OAAX;CAAqB;CAFtC,OADD,CADD;CAQA,aAAOO,OAAP;CACA,KApMF;;CAqMCI,IAAAA,uBAAuB,GACvB;CACC,YAAMC,QAAQ,GAAG,sCAAjB;;CACAC,MAAAA,MAAM,CAACD,QAAD,CAAN,GAAmBpc,MAAM,IAAI,KAAKqb,gBAAL,CAAsBrb,MAAtB,CAA7B;;CAEA,YAAMiU,KAAK,GAAG,IAAI/B,EAAE,CAACoK,OAAP,CAAe;CAC5BC,QAAAA,WAAW,EAAE;CAEZ;CACA,4BAHY,GAIZ,aAJY,GAIEH,QAJF,GAKZ,kBALY,GAMZ,gBAP2B;CAQ5BpE,QAAAA,MAAM,EAAEwE,IAAI,CAACC,GAAL,CAAS,GAAT,EAAcJ,MAAM,CAACK,WAAP,GAAmB,GAAjC,CARoB;CAS5BjG,QAAAA,KAAK,EAAE+F,IAAI,CAACC,GAAL,CAAS,GAAT,EAAcJ,MAAM,CAACM,UAAP,GAAkB,GAAhC,CATqB;CAU5BhB,QAAAA,SAAS,EAAE,IAViB;CAW5BC,QAAAA,SAAS,EAAE,IAXiB;CAY5BgB,QAAAA,UAAU,EAAE,GAZgB;CAa5BC,QAAAA,SAAS,EAAE,GAbiB;CAc5BpB,QAAAA,MAAM,EAAE;CAdoB,OAAf,CAAd;CAiBAxH,MAAAA,KAAK,CAAC6I,IAAN;CACA,KA5NF;;CA6NC7E,IAAAA,UAAU,CAAC9Z,KAAD,EACV;CACC,UAAIA,KAAK,CAACC,MAAN,CAAa2e,OAAb,CAAqBC,SAArB,KAAmC,mBAAvC,EACA;CACC,cAAM3e,KAAK,GAAGF,KAAK,CAACC,MAAN,CAAa8Z,OAAb,GAAuB,GAAvB,GAA6B,GAA3C;CACA,aAAK3V,KAAL,CAAWC,IAAX,CAAgB0M,gBAAhB,CAAiC,aAAjC,EAAgD7Q,KAAhD;CACA,OAJD,MAKK,IAAIF,KAAK,CAACC,MAAN,CAAa2e,OAAb,CAAqBC,SAArB,KAAmC,yBAAvC,EACL;CACC,cAAM3e,KAAK,GAAGF,KAAK,CAACC,MAAN,CAAa8Z,OAAb,GAAuB,GAAvB,GAA6B,GAA3C;CACA,aAAK3V,KAAL,CAAWC,IAAX,CAAgB0M,gBAAhB,CAAiC,mBAAjC,EAAsD7Q,KAAtD;CACA,OAJI,MAKA,IAAIF,KAAK,CAACC,MAAN,CAAa2e,OAAb,CAAqBC,SAArB,KAAmC,oBAAvC,EACL;CACC,cAAM3e,KAAK,GAAGF,KAAK,CAACC,MAAN,CAAa8Z,OAAb,GAAuB,GAAvB,GAA6B,GAA3C;CACA,aAAK3V,KAAL,CAAWC,IAAX,CAAgB0M,gBAAhB,CAAiC,cAAjC,EAAiD7Q,KAAjD;CACA,OAJI,MAKA,IAAIF,KAAK,CAACC,MAAN,CAAa2e,OAAb,CAAqBC,SAArB,KAAmC,iBAAvC,EACL;CACC,cAAM3e,KAAK,GAAGF,KAAK,CAACC,MAAN,CAAa8Z,OAAb,GAAuB,GAAvB,GAA6B,GAA3C;;CAEA,YAAG7Z,KAAK,KAAK,GAAb,EACA;CACC,eAAKsB,SAAL,CAAeO,KAAf;CACA,cAAI+c,uBAAJ,GAAaC,IAAb,CAAkB,qEAAlB,EAAwF,EAAxF,EACCrS,IADD,CACM,MAAM;CACXF,YAAAA,cAAI,CAACC,SAAL,CACC,0CADD,EAEC,EAFD,EAGEC,IAHF,CAGOC,QAAQ,IAAI;CAElB,oBAAM/R,KAAK,GAAG,KAAKokB,eAAL,GAAuBjD,SAAvB,CAAkCrhB,IAAD,IAC/C;CACC,uBAAOA,IAAI,CAAC6I,EAAL,KAAYvD,KAAK,CAACC,MAAN,CAAa2e,OAAb,CAAqBC,SAAxC;CACA,eAHa,CAAd;CAKA,mBAAKpf,OAAL,CAAawf,eAAb,GAA+BtS,QAAQ,CAACxJ,IAAT,KAAkB,IAAjD;CACA,mBAAKsY,QAAL,GAAgB,KAAKuD,eAAL,EAAhB;CACA,aAZD;CAaA,WAfD;CAgBA;CACD;CACD,KAvQF;;CAwQCE,IAAAA,cAAc,CAACxkB,IAAD,EACd;CAAA;;CACC,YAAM4M,KAAK,GAAGyC,aAAG,CAACkB,MAAP,oBAAc;;KAAd,EAAX;CAGA3D,MAAAA,KAAK,CAACyS,OAAN,GAAgBrf,IAAI,CAACqf,OAArB;CACAzS,MAAAA,KAAK,CAAC6X,QAAN,qBAAiBzkB,IAAI,CAACykB,QAAtB,6BAAkC,KAAlC;CACA7X,MAAAA,KAAK,CAACsX,OAAN,CAAcC,SAAd,GAA0BnkB,IAAI,CAAC6I,EAA/B;CAEA,YAAM6b,QAAQ,GACbzjB,cAAI,CAACY,cAAL,CAAoB7B,IAAI,CAACkZ,IAAzB,IACG7J,aAAG,CAACkB,MADP,sBACc,8DADd,CACqF,WADrF,GAC2EvQ,IAAI,CAACkZ,IADhF,IAEG,EAHJ;CAMA,YAAMyL,OAAO,GAAGtV,aAAG,CAACkB,MAAP,sBAAc;;OAAd,CAEH;qCAFG,CAGkF,KAHlF,CAGiG,GAHjG,CAG4G;;IAH5G,GAET3D,KAFS,EAGqB5M,IAAI,CAACykB,QAAL,GAAgB,uCAAhB,GAA0D,EAH/E,EAGsFzkB,IAAI,CAACoP,KAH3F,EAGmGsV,QAHnG,CAAb;CAOArL,MAAAA,EAAE,CAACoF,EAAH,CAAMmG,IAAN,CAAWC,IAAX,CAAgBF,OAAhB;CAEAnJ,MAAAA,eAAK,CAACjS,IAAN,CAAWob,OAAX,EAAoB,QAApB,EAA8B,KAAKvF,UAAL,CAAgB7V,IAAhB,CAAqB,IAArB,CAA9B;CAEA,aAAOob,OAAP;CACA,KAnSF;;CAoSCL,IAAAA,eAAe,GACf;CACC,aAAO;CAEN;CACA;CACA;CACA;CACA;CACCzb,QAAAA,EAAE,EAAE,yBADL;CAECwW,QAAAA,OAAO,EAAG,KAAKta,OAAL,CAAa0U,iBAAb,KAAmC,GAF9C;CAGCrK,QAAAA,KAAK,EAAE,KAAKzH,QAAL,CAAcmd;CAHtB,OANM;CAYN;CACA;CACA;CACA;CACA;CACCjc,QAAAA,EAAE,EAAE,iBADL;CAECwW,QAAAA,OAAO,EAAG,KAAKta,OAAL,CAAawf,eAFxB;CAGCE,QAAAA,QAAQ,EAAG,KAAK1f,OAAL,CAAawf,eAHzB;CAICnV,QAAAA,KAAK,EAAE,KAAKzH,QAAL,CAAcod,sCAJtB;CAKC7L,QAAAA,IAAI,EAAE,KAAKnU,OAAL,CAAawf,eAAb,GAA+B,KAAK5c,QAAL,CAAcqd,oCAA7C,GAAoF;CAL3F,OAhBM,CAAP;CAwBA,KA9TF;;CAgUCC,IAAAA,sBAAsB,GACtB;CACC,YAAMvH,OAAO,GAAGrO,aAAG,CAACkB,MAAP,sBAAc;;KAAd,EAAb;CAIA,WAAKwQ,QAAL,CAAchhB,OAAd,CAAsBC,IAAI,IAAI;CAC7B0d,QAAAA,OAAO,CAACwH,MAAR,CAAe,KAAKV,cAAL,CAAoBxkB,IAApB,CAAf;CACA,OAFD;CAIA,aAAO0d,OAAP;CACA,KA3UF;;CA4UCyH,IAAAA,eAAe,CAAC7f,KAAD,EACf;CACC;CACA;CACC,WAAKwB,SAAL,GAAiB,IAAI+V,gBAAJ,CAAU,IAAV,EAAgBvX,KAAK,CAACC,MAAtB,EAChB;CACC0Y,QAAAA,QAAQ,EAAE,IADX;CAEC6E,QAAAA,SAAS,EAAE,KAFZ;CAGCsC,QAAAA,UAAU,EAAE,CAHb;CAICC,QAAAA,SAAS,EAAE,CAJZ;CAKCC,QAAAA,aAAa,EAAE,IALhB;CAMCC,QAAAA,WAAW,EAAE;CAACC,UAAAA,iBAAiB,EAAE;CAApB,SANd;CAOCxH,QAAAA,UAAU,EAAE,IAPb;CAQCN,QAAAA,OAAO,EAAE,KAAKuH,sBAAL;CARV,OADgB,CAAjB,CAHF;;CAiBC,WAAKne,SAAL,CAAeI,IAAf;CACA,KA/VF;;CAgWCue,IAAAA,UAAU,CAACC,GAAD,EAAM3gB,OAAN,EACV;CACC,UAAG,CAAC9D,cAAI,CAACwU,aAAL,CAAmB1Q,OAAnB,CAAJ,EACA;CACCA,QAAAA,OAAO,GAAG,EAAV;CACA;;CACDA,MAAAA,OAAO,GAAG,EAAC,GAAG;CAACmZ,UAAAA,SAAS,EAAE,KAAZ;CAAmByH,UAAAA,kBAAkB,EAAE,KAAvC;CAA8C7W,UAAAA,MAAM,EAAE;CAAtD,SAAJ;CAA+D,WAAG/J;CAAlE,OAAV;CACA,aAAO,IAAIyM,OAAJ,CAAaC,OAAD,IAClB;CACC,YAAGxQ,cAAI,CAAC2kB,QAAL,CAAcF,GAAd,KAAsBA,GAAG,CAAC5lB,MAAJ,GAAa,CAAtC,EACA;CACCiF,UAAAA,OAAO,CAAC+J,MAAR,CAAe+W,OAAf,GAAyB,UAASvgB,KAAT,EACxB;CACCmM,YAAAA,OAAO,CAACnM,KAAK,CAACwgB,SAAN,EAAD,CAAP;CACF,WAHA;;CAIDzM,UAAAA,EAAE,CAAC0M,SAAH,CAAaC,QAAb,CAAsB3B,IAAtB,CAA2BqB,GAA3B,EAAgC3gB,OAAhC;CACA,SAPA,MASD;CACC0M,UAAAA,OAAO;CACP;CACD,OAdM,CAAP;CAeA;;CAtXF,GAlBD;CA0YC/J,EAAAA,QAAQ,EACR;CACCC,IAAAA,QAAQ,GACR;CACC,aAAOxG,UAAG,CAACyG,kBAAJ,CAAuB,UAAvB,CAAP;CACA,KAJF;;CAKC+K,IAAAA,UAAU,GACV;CACC,aAAO,KAAKsT,KAAL,CAAW1pB,MAAX,CAAkBuD,MAAzB;CACA,KARF;;CASC,OAAG8gB,gBAAI,CAACC,QAAL,CAAc;CAChBC,MAAAA,WAAW,EAAElhB,KAAK,IAAIA,KAAK,CAACkhB;CADZ,KAAd;CATJ,GA3YD;;CAwZCjX,EAAAA,OAAO,GACP;CACC,SAAKkX,QAAL,GAAgB,KAAKuD,eAAL,EAAhB;CACA,GA3ZF;;CA4ZC;CACAhd,EAAAA,QAAQ,EAAG;;;;;;;;;;;CA7ZZ,CADA;;ACIAnG,WAAG,CAACoD,SAAJ,CAAcrC,MAAM,CAACG,YAArB,EACA;CACCmC,EAAAA,KAAK,EAAE;CACNO,IAAAA,OAAO,EAAEnE,MADH;CAEN0L,IAAAA,IAAI,EAAE5H;CAFA,GADR;;CAKCM,EAAAA,OAAO,GACP;CACCqU,IAAAA,EAAE,CAACvH,IAAH,CAAQC,SAAR,CACC,sCADD,EAEC;CAAE2P,MAAAA,IAAI,EAAE;CAAEzW,QAAAA,QAAQ,EAAE,KAAKlG,OAAL,CAAakG;CAAzB;CAAR,KAFD;CAIA,GAXF;;CAYC5F,EAAAA,OAAO,EACP;CACC2b,IAAAA,aAAa,GACb;CACC,WAAKhE,MAAL,CAAYrd,QAAZ,CAAqB,2BAArB;CACA,KAJF;;CAMCumB,IAAAA,aAAa,CAAClmB,IAAD,EACb;CACC,WAAK0J,KAAL,CAAWC,IAAX,CAAgBuc,aAAhB,CAA8BlmB,IAA9B;CACA,KATF;;CAWCmmB,IAAAA,gBAAgB,GAChB;CACC,WAAKzc,KAAL,CAAWC,IAAX,CAAgBwc,gBAAhB;CACA,KAdF;;CAgBC5R,IAAAA,aAAa,CAACvU,IAAD,EACb;CACC,aAAOA,IAAI,CAACqB,OAAL,CAAalE,MAApB;CACA,WAAK6f,MAAL,CAAYvd,MAAZ,CAAmB,wBAAnB,EAA6CO,IAA7C;CACA,KApBF;;CAsBCN,IAAAA,UAAU,CAACM,IAAD,EACV;CACC,WAAK0J,KAAL,CAAWC,IAAX,CAAgByc,aAAhB,CAA8BpmB,IAA9B;CACA,KAzBF;;CA2BCK,IAAAA,OAAO,GACP;CACC,WAAKqJ,KAAL,CAAWC,IAAX,CAAgB0Y,UAAhB;CACA;;CA9BF,GAbD;CA6CC3a,EAAAA,QAAQ,EACR;CACCC,IAAAA,QAAQ,GACR;CACC,aAAOxG,UAAG,CAACyG,kBAAJ,CAAuB,UAAvB,CAAP;CACA,KAJF;;CAMCye,IAAAA,aAAa,GACb;CACC,aAAO,KAAKthB,OAAL,CAAa6U,YAAb,KAA8B,GAArC;CACA,KATF;;CAWC0M,IAAAA,WAAW,GACX;CACC,aAAO,KAAKvhB,OAAL,CAAauhB,WAAb,KAA6B,KAApC;CACA,KAdF;;CAgBCC,IAAAA,cAAc,GACd;CACC,aAAO,KAAKxhB,OAAL,CAAayhB,iBAAb,KAAmC,IAAnC,IACH,KAAKla,IAAL,KAAcpI,QAAQ,CAACE,SADpB,IAEH,KAAKkI,IAAL,KAAcpI,QAAQ,CAACI,qBAFpB,IAGH,KAAKS,OAAL,CAAa0hB,eAAb,KAAiC3qB,mBAAmB,CAACE,MAHzD;CAKA,KAvBF;;CAyBC0qB,IAAAA,iBAAiB,GACjB;CACC,aAAO,KAAK3hB,OAAL,CAAayhB,iBAAb,KAAmC,IAAnC,IACH,KAAKla,IAAL,KAAcpI,QAAQ,CAACE,SADpB,IAEH,KAAKkI,IAAL,KAAcpI,QAAQ,CAACI,qBAFpB,IAGH,KAAKS,OAAL,CAAa0hB,eAAb,KAAiC3qB,mBAAmB,CAACE,MAHzD;CAKA,KAhCF;;CAkCC2qB,IAAAA,eAAe,GACf;CACC,aAAO,KAAKL,WAAL,IAAoB,KAAKM,gBAAhC;CACA,KArCF;;CAuCCjU,IAAAA,UAAU,GACV;CACC,aAAO,KAAKmO,WAAL,CAAiBvkB,MAAjB,CAAwBuD,MAA/B;CACA,KA1CF;;CA4CC+mB,IAAAA,gBAAgB,GAChB;CACC,aAAO,KAAK9hB,OAAL,CAAahD,cAAb,CAA4B,kBAA5B,KAAmD,KAAKgD,OAAL,CAAa8hB,gBAAhE,GACJ,KAAK9hB,OAAL,CAAa8hB,gBADT,GAEJ,KAAKlf,QAAL,CAAcmf,yBAFjB;CAGA,KAjDF;;CAmDC,OAAGlG,gBAAI,CAACC,QAAL,CAAc;CAChBC,MAAAA,WAAW,EAAElhB,KAAK,IAAIA,KAAK,CAACkhB;CADZ,KAAd;CAnDJ,GA9CD;CAqGC;CACAxZ,EAAAA,QAAQ,EAAG;;KAEPpF,MAAM,CAACI,oBAAqB;;;;;;;;;;MAU3BJ,MAAM,CAACM,eAAgB;;;;;;;;;;;;;;KAcxBN,MAAM,CAACI,oBAAqB;;;;;;;;;KAS5BJ,MAAM,CAACK,wBAAyB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiDrC;CA1LA,CADA;;;;;;;;;;;;;CCOA,MAAMwkB,WAAN,CACA;CACCC,EAAAA,WAAW,CAACjiB,OAAmB,GAAG,EAAvB,EACX;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CACC,SAAKA,OAAL,GAAe,KAAKkiB,cAAL,CAAoBliB,OAApB,CAAf;CACA,SAAKmiB,cAAL,GAAsBtmB,MAAM,CAACC,MAAP,CAAc,EAAd,EAAkB,KAAKkE,OAAvB,CAAtB;CAEA,SAAKJ,QAAL,GAAgB,IAAhB;;CACA,sEAAcT,QAAQ,CAACC,OAAvB;;CAEA,SAAKgjB,OAAL,GAAe9X,aAAG,CAACkB,MAAnB,oBAA0B,sBAA1B;;CAEA,QAAIxT,cAAI,CAACyD,QAAL,CAAcuE,OAAO,CAACkG,QAAtB,KAAmC,CAAvC,EACA;CACC;CACA;;CAED8b,IAAAA,WAAW,CAACK,SAAZ,GACEpV,IADF,CACQpV,MAAD,IAAY,KAAKyqB,YAAL,CAAkBzqB,MAAlB,CADnB,EAEE0V,KAFF,CAESmG,KAAD,IAAWsO,WAAW,CAACO,SAAZ,CAAsB7O,KAAtB,CAFnB;CAIA;;CAEe,SAAT2O,SAAS,GAChB;CACC,UAAMG,OAAO,GAAG,IAAIC,uBAAJ,EAAhB;CAEA,WAAOD,OAAO,CACZE,QADK,CACIxrB,WAAW,CAACyrB,MAAZ,EADJ,EAELC,KAFK,EAAP;CAGA;;CAEDV,EAAAA,cAAc,CAACliB,OAAmB,GAAG,EAAvB,EACd;CACC,UAAM6iB,kBAAkB,GAAGC,mBAAS,CAACC,WAAV,CAAsB,sBAAtB,CAA3B;CACA,UAAMZ,cAA0B,GAAG;CAClC3qB,MAAAA,MAAM,EAAE,EAD0B;CAElCiK,MAAAA,QAAQ,EAAE,EAFwB;CAGlCyE,MAAAA,QAAQ,EAAE,IAHwB;CAIlCC,MAAAA,WAAW,EAAE0c,kBAAkB,CAACG,GAAnB,CAAuB,aAAvB,CAJqB;CAKlCjf,MAAAA,OAAO,EAAE,EALyB;CAMlC0d,MAAAA,iBAAiB,EAAE,KANe;CAOlCF,MAAAA,WAAW,EAAE,IAPqB;CAQlC0B,MAAAA,2BAA2B,EAAE,KARK;CASlCpc,MAAAA,uBAAuB,EAAE,IATS;CAUlCqc,MAAAA,cAAc,EAAE,CAVkB;CAWlC5rB,MAAAA,QAAQ,EAAEurB,kBAAkB,CAACG,GAAnB,CAAuB,UAAvB,CAXwB;CAYlClgB,MAAAA,cAAc,EAAE+f,kBAAkB,CAACG,GAAnB,CAAuB,gBAAvB,CAZkB;CAalCzrB,MAAAA,WAAW,EAAEsrB,kBAAkB,CAACG,GAAnB,CAAuB,aAAvB,CAbqB;CAclCxD,MAAAA,eAAe,EAAEqD,kBAAkB,CAACG,GAAnB,CAAuB,iBAAvB,CAdiB;CAelCtO,MAAAA,iBAAiB,EAAEmO,kBAAkB,CAACG,GAAnB,CAAuB,mBAAvB,CAfe;CAgBlCnO,MAAAA,YAAY,EAAEgO,kBAAkB,CAACG,GAAnB,CAAuB,cAAvB,CAhBoB;CAiBlC3f,MAAAA,oBAAoB,EAAE,CAAClK,sCAAY,CAACC,UAAd,EAA0BD,sCAAY,CAACgK,QAAvC,CAjBY;CAkBlC6P,MAAAA,aAAa,EAAE,CACd9U,aAAa,CAACC,gBADA,EACkBD,aAAa,CAACE,YADhC,EAC8CF,aAAa,CAACI,KAD5D,EAEdJ,aAAa,CAACG,QAFA,EAEUH,aAAa,CAACK,MAFxB,EAGdL,aAAa,CAACM,QAHA,CAlBmB;CAuBlC0J,MAAAA,cAAc,EAAE,EAvBkB;CAwBlC0L,MAAAA,cAAc,EAAE,EAxBkB;CAyBlCuP,MAAAA,eAAe,EAAEpsB,mBAAmB,CAACC,GAzBH;CA0BlC0qB,MAAAA,eAAe,EAAE3qB,mBAAmB,CAACC,GA1BH;CA2BlCqQ,MAAAA,iBAAiB,EAAE,MA3Be;CA4BlCF,MAAAA,wBAAwB,EAAE,KA5BQ;CA6BlC2M,MAAAA,yBAAyB,EAAE+O,kBAAkB,CAACG,GAAnB,CAAuB,2BAAvB,CA7BO;CA8BlCnS,MAAAA,yBAAyB,EAAEgS,kBAAkB,CAACG,GAAnB,CAAuB,2BAAvB,CA9BO;CA+BlChP,MAAAA,UAAU,EAAE6O,kBAAkB,CAACG,GAAnB,CAAuB,YAAvB,CA/BsB;CAgClCI,MAAAA,mBAAmB,EAAE5N,mBAAmB,CAACpW,OAhCP;CAiClCikB,MAAAA,qBAAqB,EAAE,EAjCW;CAkClCvd,MAAAA,oBAAoB,EAAE,IAlCY;CAmClCsS,MAAAA,OAAO,EAAE,IAnCyB;CAoClCC,MAAAA,WAAW,EAAE,IApCqB;CAqClCC,MAAAA,QAAQ,EAAE,IArCwB;CAsClCC,MAAAA,SAAS,EAAE;CAtCuB,KAAnC;;CAyCA,QAAIvY,OAAO,CAACgT,aAAR,IAAyB,CAAC9W,cAAI,CAACsF,OAAL,CAAaxB,OAAO,CAACgT,aAArB,CAA9B,EACA;CACC,aAAOhT,OAAO,CAACgT,aAAf;CACA;;CAED,QAAIhT,OAAO,CAACkI,cAAR,IAA0B,CAAChM,cAAI,CAACsF,OAAL,CAAaxB,OAAO,CAACkI,cAArB,CAA/B,EACA;CACC,aAAOlI,OAAO,CAACkI,cAAf;CACA;;CAEDlI,IAAAA,OAAO,GAAG,EAAC,GAAGmiB,cAAJ;CAAoB,SAAGniB;CAAvB,KAAV;CACAA,IAAAA,OAAO,CAAC6U,YAAR,GAAuB,GAAvB;;CAEA,QAAIgO,kBAAkB,CAACG,GAAnB,CAAuB,kBAAvB,CAAJ,EACA;CACChjB,MAAAA,OAAO,CAACqjB,qBAAR,GAAgC;CAC/BngB,QAAAA,IAAI,EAAElD,OAAO,CAACojB,mBADiB;CAE/BE,QAAAA,QAAQ,EAAET,kBAAkB,CAACG,GAAnB,CAAuB,iBAAvB,CAFqB;CAG/B9H,QAAAA,cAAc,EAAE2H,kBAAkB,CAACG,GAAnB,CAAuB,uBAAvB,CAHe;CAI/BnL,QAAAA,gBAAgB,EAAEgL,kBAAkB,CAACG,GAAnB,CAAuB,uBAAvB,CAJa;CAK/BvL,QAAAA,iBAAiB,EAAEoL,kBAAkB,CAACG,GAAnB,CAAuB,8BAAvB;CALY,OAAhC;CAOA,KATD,MAWA;CACChjB,MAAAA,OAAO,CAACijB,2BAAR,GAAsC,KAAtC;CACA;;CAEDjjB,IAAAA,OAAO,CAACqd,mBAAR,GAA8B,EAA9B;;CACA,QAAInhB,cAAI,CAACsF,OAAL,CAAaxB,OAAO,CAACqD,oBAArB,CAAJ,EACA;CACC,UAAIrD,OAAO,CAACqD,oBAAR,CAA6BC,QAA7B,CAAsCnK,sCAAY,CAACC,UAAnD,CAAJ,EACA;CACC4G,QAAAA,OAAO,CAACqd,mBAAR,GAA8BlkB,sCAAY,CAACC,UAA3C;CACA,OAHD,MAIK,IAAI4G,OAAO,CAACqD,oBAAR,CAA6BC,QAA7B,CAAsCnK,sCAAY,CAACgK,QAAnD,CAAJ,EACL;CACCnD,QAAAA,OAAO,CAACqd,mBAAR,GAA8BlkB,sCAAY,CAACgK,QAA3C;CACA;CACD;;CAED,WAAOnD,OAAP;CACA;;CAEDujB,EAAAA,MAAM,GACN;CACC,WAAO,KAAKnB,OAAZ;CACA;;CAEDE,EAAAA,YAAY,CAACzqB,MAAD,EACZ;CACC,WAAO,IAAI4U,OAAJ,CAAaC,OAAD,IACnB;CACC,YAAM9C,OAAO,GAAG,IAAhB;CACA,WAAK4Z,KAAL,GAAa3rB,MAAM,CAAC2rB,KAApB;CAEA,WAAKC,cAAL,GAAsBC,gBAAS,CAACC,SAAV,CAAoB;CACzCC,QAAAA,EAAE,EAAE,KAAKxB,OADgC;CAEzCoB,QAAAA,KAAK,EAAE,KAAKA,KAF6B;CAGzC9f,QAAAA,IAAI,EAAE;CACL1D,UAAAA,OAAO,EAAE,KAAKA,OADT;CAELuH,UAAAA,IAAI,EAAE,KAAKA;CAFN,SAHmC;;CAOzCtH,QAAAA,OAAO,GACP;CACC,eAAK2E,IAAL,GAAYgF,OAAZ;CACA,SAVwC;;CAWzC9E,QAAAA,OAAO,GACP;CACC4H,UAAAA,OAAO;CACP,SAdwC;;CAezCnK,QAAAA,QAAQ,EAAG,IAAGpF,MAAM,CAACG,YAAa;CAfO,OAApB,CAAtB;;CAkBA,UAAIpB,cAAI,CAACY,cAAL,CAAoB,KAAKkD,OAAL,CAAa1I,QAAjC,CAAJ,EACA;CACC,aAAKusB,OAAL,CAAa;CACZvsB,UAAAA,QAAQ,EAAE,KAAK0I,OAAL,CAAa1I;CADX,SAAb;CAGA2F,QAAAA,kCAAY,CAAC6mB,kBAAb,CAAgC,KAAK9jB,OAAL,CAAa1I,QAA7C;CACA;;CAED,UAAI,KAAK0I,OAAL,CAAaxI,MAAb,CAAoBuD,MAApB,GAA6B,CAAjC,EACA;CACC,aAAK8oB,OAAL,CACC;CAACrsB,UAAAA,MAAM,EAAE,KAAKwI,OAAL,CAAaxI;CAAtB,SADD,EAEC;CAAC2rB,UAAAA,eAAe,EAAEpsB,mBAAmB,CAACE;CAAtC,SAFD;;CAKA,YAAIiF,cAAI,CAAC8J,QAAL,CAAc,KAAKhG,OAAL,CAAa+jB,MAA3B,CAAJ,EACA;CACC,eAAKP,KAAL,CAAW9oB,MAAX,CAAkB,sBAAlB,EAA0C,KAAKsF,OAAL,CAAa+jB,MAAvD;CACA,SAHD,MAKA;CACC,eAAKP,KAAL,CAAW5oB,QAAX,CAAoB,4BAApB;CACA;CACD,OAfD,MAiBA;CACC,cAAMuiB,OAAO,GAAG,KAAKqG,KAAL,CAAWtL,OAAX,CAAmB,4BAAnB,GAAhB;CACAiF,QAAAA,OAAO,CAAC/kB,MAAR,CAAec,YAAf,GAA8B,KAAK8G,OAAL,CAAaqd,mBAA3C;CACA,aAAKC,UAAL,CAAgBH,OAAhB;CACA;;CAED9Y,MAAAA,6BAAY,CAACoU,IAAb,CAAkB,IAAlB,EAAwB,aAAxB;CACA,KAvDM,CAAP;CAwDA;;CAED6E,EAAAA,UAAU,CAACriB,IAAI,GAAG,EAAR,EACV;CACC,SAAKuoB,KAAL,CAAW5oB,QAAX,CAAoB,qBAApB,EAA2C;CAC1CK,MAAAA,IAD0C;CAE1CM,MAAAA,QAAQ,EAAE,KAAKyE,OAAL,CAAamjB;CAFmB,KAA3C,EAIElW,IAJF,CAIO,MAAM;CACX;CACA,KANF;CAOA;;CASDmU,EAAAA,gBAAgB,GAChB;CACC/c,IAAAA,6BAAY,CAACoU,IAAb,CAAkB,IAAlB,EAAwB,4BAAxB;CACA;;CAED0I,EAAAA,aAAa,CAAClmB,IAAD,EACb;CACC,UAAMqB,OAAO,GAAGrB,IAAI,CAACqB,OAArB;CACAA,IAAAA,OAAO,CAAC/B,MAAR,GAAiB,EAAjB;;CACA,QAAIU,IAAI,CAACgV,iBAAL,KAA2B,IAA/B,EACA;CACC,YAAMpY,MAAM,2CAAG,IAAH,8CAA6ByE,OAA7B,CAAZ;;CACAA,MAAAA,OAAO,CAAC/B,MAAR,GAAiB,CAAA1C,MAAM,QAAN,YAAAA,MAAM,CAAE0C,MAAR,KAAkB,EAAnC;CACA;;CAED,SAAKipB,KAAL,CAAW5oB,QAAX,CAAoB,wBAApB,EAA8C;CAC7CO,MAAAA,KAAK,EAAEF,IAAI,CAACE,KADiC;CAE7CmB,MAAAA;CAF6C,KAA9C,EAGG2Q,IAHH,CAGQ,MAAM;CACb;CACA,KALD;CAMA;;CA+DDoU,EAAAA,aAAa,CAAC/kB,OAAD,EACb;CACC,SAAKknB,KAAL,CAAW5oB,QAAX,CAAoB,wBAApB,EAA8C;CAC7CO,MAAAA,KAAK,EAAEmB,OAAO,CAACnB;CAD8B,KAA9C,EAEG8R,IAFH,CAEQ,MAAM;CACb;CACA,KAJD;CAKA;;CAED4W,EAAAA,OAAO,CAACngB,IAAD,EAAOsgB,MAAM,GAAG,EAAhB,EACP;CACC,QAAI9nB,cAAI,CAAC8J,QAAL,CAActC,IAAI,CAAClM,MAAnB,CAAJ,EACA;CACC,YAAMysB,UAAU,GAAG,KAAKT,KAAL,CAAWtL,OAAX,CAAmB,uBAAnB,GAAnB;CACAxU,MAAAA,IAAI,CAAClM,MAAL,CAAYwD,OAAZ,CAAqB5C,MAAD,IAAY;CAC/B,YAAI,CAAC8D,cAAI,CAAC8J,QAAL,CAAc5N,MAAd,CAAL,EACA;CACC;CACA;;CACD,cAAM8rB,YAAY,GAAGF,MAAM,CAACb,eAAP,IAA0B,KAAKnjB,OAAL,CAAamjB,eAA5D;CAEA,cAAM9qB,OAAO,GAAGD,MAAM,CAACD,UAAvB;;CACA,YAAI+D,cAAI,CAACC,KAAL,CAAW9D,OAAX,CAAJ,EACA;CACC,eAAKmrB,KAAL,CAAW5oB,QAAX,CAAoB,qBAApB,EAA2C;CAC1CK,YAAAA,IAAI,EAAE7C,MADoC;CAE1CmD,YAAAA,QAAQ,EAAE2oB;CAFgC,WAA3C;CAKA;CACA;;CAED,cAAMC,WAAW,GAAGF,UAAU,CAAC3H,SAAX,CAAqBrhB,IAAI,IAAIA,IAAI,CAAC9C,UAAL,KAAoBE,OAAjD,CAApB;;CACA,YAAI8rB,WAAW,KAAK,CAAC,CAArB,EACA;CACC,eAAKX,KAAL,CAAW5oB,QAAX,CAAoB,qBAApB,EAA2C;CAC1CK,YAAAA,IAAI,EAAE7C,MADoC;CAE1CmD,YAAAA,QAAQ,EAAE2oB;CAFgC,WAA3C;CAIA,SAND,MAQA;CACC,eAAKV,KAAL,CAAW5oB,QAAX,CAAoB,wBAApB,EAA8C;CAACupB,YAAAA,WAAD;CAAc/rB,YAAAA;CAAd,WAA9C;CACA;CACD,OA9BD;CA+BA;;CAED,QAAI8D,cAAI,CAACY,cAAL,CAAoB4G,IAAI,CAACpM,QAAzB,CAAJ,EACA;CACC,WAAKksB,KAAL,CAAW5oB,QAAX,CAAoB,yBAApB,EAA+C8I,IAAI,CAACpM,QAApD;CACA;;CAED,QAAI4E,cAAI,CAAC8J,QAAL,CAActC,IAAI,CAACjM,KAAnB,CAAJ,EACA;CACC,WAAK+rB,KAAL,CAAW9oB,MAAX,CAAkB,sBAAlB,EAA0C;CACzChD,QAAAA,GAAG,EAAEgM,IAAI,CAACjM,KAAL,CAAWC,GADyB;CAEzCE,QAAAA,MAAM,EAAE8L,IAAI,CAACjM,KAAL,CAAWG,MAFsB;CAGzCD,QAAAA,QAAQ,EAAE+L,IAAI,CAACjM,KAAL,CAAWE,QAHoB;CAIzCE,QAAAA,MAAM,EAAE6L,IAAI,CAACjM,KAAL,CAAWI;CAJsB,OAA1C;CAMA;;CAED,QAAIqE,cAAI,CAAC8J,QAAL,CAActC,IAAI,CAACnJ,MAAnB,CAAJ,EACA;CACC,WAAKipB,KAAL,CAAW9oB,MAAX,CAAkB,uBAAlB,EAA2CgJ,IAAI,CAACnJ,MAAhD;CACA;CACD;;CAED+W,EAAAA,gBAAgB,CAAC8S,UAAD,EAAa3jB,KAAb,EAChB;CACCA,IAAAA,KAAK,GAAIA,KAAK,KAAK,GAAX,GAAkB,GAAlB,GAAwB,GAAhC;;CAEA,QAAI2jB,UAAU,KAAK,mBAAnB,EACA;CACC,UAAI,CAAC,KAAKpkB,OAAL,CAAaijB,2BAAlB,EACA;CACC;CACA;;CAED5e,MAAAA,6BAAY,CAACoU,IAAb,CAAkB,IAAlB,EAAwB,yBAAxB,EAAmD;CAClDrT,QAAAA,iBAAiB,EAAE3E,KAAK,KAAK,GADqB;CAElD6E,QAAAA,cAAc,EAAE,KAAKtF,OAAL,CAAaojB,mBAAb,KAAqC5N,mBAAmB,CAACC;CAFvB,OAAnD;CAIA,YAAMlO,IAAI,GAAI9G,KAAK,KAAK,GAAX,GAAkBtB,QAAQ,CAACG,WAA3B,GAAyCH,QAAQ,CAACC,OAA/D;;CACA,kHAAmCmI,IAAnC;;CAEA;CACA;;CAED,SAAKvH,OAAL,CAAaokB,UAAb,IAA2B3jB,KAA3B;;CACA,QAAI2jB,UAAU,KAAK,8BAAnB,EACA;CACC,YAAM5sB,MAAM,GAAG,KAAKgsB,KAAL,CAAWtL,OAAX,CAAmB,uBAAnB,GAAf;CACA1gB,MAAAA,MAAM,CAACwD,OAAP,CAAe,CAACC,IAAD,EAAOE,KAAP,KAAiB;CAC/B,YAAIipB,UAAU,KAAK,mBAAnB,EACA;CACCnpB,UAAAA,IAAI,CAACyZ,iBAAL,GAAyBjU,KAAzB;CACA,SAHD,MAIK,IAAI2jB,UAAU,KAAK,cAAnB,EACL;CACCnpB,UAAAA,IAAI,CAAC4Z,YAAL,GAAoBpU,KAApB;CACA,SAHI,MAIA,IAAI2jB,UAAU,KAAK,aAAnB,EACL;CACCnpB,UAAAA,IAAI,CAAC7C,MAAL,CAAYb,WAAZ,GAA0BkJ,KAA1B;CACA;;CAED,aAAK+iB,KAAL,CAAW5oB,QAAX,CAAoB,wBAApB,EAA8C;CAC7CO,UAAAA,KAD6C;CAE7C/C,UAAAA,MAAM,EAAE6C;CAFqC,SAA9C;CAIA,OAlBD;CAmBA;;CAED8R,IAAAA,cAAI,CAACC,SAAL,CACC,+BADD,EAEC;CACCtJ,MAAAA,IAAI,EAAE;CACL2gB,QAAAA,UAAU,EAAED,UADP;CAEL3jB,QAAAA,KAAK,EAAEA;CAFF;CADP,KAFD;CASA;;CAgBD6jB,EAAAA,QAAQ,GACR;CACC,SAAKd,KAAL,CAAW5oB,QAAX,CAAoB,sBAApB;CACA;;CAED2pB,EAAAA,WAAW,CAAC3kB,QAAD,EAAWwF,iBAAX,EACX;CACC,SAAKxF,QAAL,GAAgBA,QAAhB;;CACA,QAAI,CAACA,QAAD,IAAa,CAACwF,iBAAlB,EACA;CACC,wEAAcjG,QAAQ,CAACE,SAAvB;CACA,KAHD,MAIK,IAAI,CAACO,QAAD,IAAawF,iBAAjB,EACL;CACC,wEAAcjG,QAAQ,CAACI,qBAAvB;CACA,KAHI,MAIA,IAAIK,QAAQ,IAAIwF,iBAAhB,EACL;CACC,wEAAcjG,QAAQ,CAACG,WAAvB;CACA,KAHI,MAKL;CACC,wEAAcH,QAAQ,CAACC,OAAvB;CACA;CACD;;CA+EDolB,EAAAA,SAAS,GACT;CACC,QAAI,CAAC,KAAKhB,KAAV,EACA;CACC,aAAO,KAAP;CACA;;CAED,UAAMhsB,MAAM,GAAG,KAAKgsB,KAAL,CAAWtL,OAAX,CAAmB,uBAAnB,GAAf;CACA,UAAMuM,UAAU,GAAGjtB,MAAM,CAACic,MAAP,CAClBxY,IAAI,IAAIA,IAAI,CAACV,MAAL,CAAYQ,MAAZ,GAAqB,CADX,CAAnB;CAIA,WAAO0pB,UAAU,CAAC1pB,MAAX,GAAoB,CAA3B;CACA;;CAEe,SAATwnB,SAAS,CAAC7O,KAAD,EAChB;CACCgR,IAAAA,OAAO,CAAChR,KAAR,CAAcA,KAAd;CACA;;CAliBF;;6BAoMC;CACCrP,EAAAA,6BAAY,CAACoU,IAAb,CAAkB,IAAlB,EAAwB,4BAAxB,EAAsD;CACrDjhB,IAAAA,MAAM,EAAE,KAAKgsB,KAAL,CAAWtL,OAAX,CAAmB,uBAAnB;CAD6C,GAAtD;CAGA;;gCAyBoB5b,SACrB;CACC,QAAMzE,MAAM,GAAG,EAAf;;CACA,MAAI,CAACqE,cAAI,CAACsF,OAAL,CAAa,KAAKxB,OAAL,CAAakI,cAA1B,CAAD,IAA8C,KAAKlI,OAAL,CAAakI,cAAb,CAA4BnN,MAA5B,KAAuC,CAAzF,EACA;CACC,WAAOlD,MAAP;CACA;;CAEDA,EAAAA,MAAM,CAAC0C,MAAP,GAAgB,EAAhB;CACA,OAAKyF,OAAL,CAAakI,cAAb,CAA4BlN,OAA5B,CAAqCxC,IAAD,IAAU;CAC7C,YAAQA,IAAR;CAEC,WAAK0F,aAAa,CAACI,KAAnB;CACC,YAAI,CAAC,KAAK0B,OAAL,CAAa6Q,yBAAd,IAA2CvU,OAAO,CAACnC,YAAR,IAAwB,CAAvE,EACA;CACCtC,UAAAA,MAAM,CAAC0C,MAAP,CAAcwB,IAAd,CAAmB;CAClBvD,YAAAA,IAAI,EAAEoG,aAAa,CAACI,WADF;CAElBuL,YAAAA,OAAO,EAAEyG,aAAG,CAACC,UAAJ,CAAe,6CAAf;CAFS,WAAnB;CAIA,SAND,MAOK,IAAI3U,OAAO,CAAClE,MAAR,CAAeQ,SAAf,IAA4B,CAAhC,EACL;CACCf,UAAAA,MAAM,CAAC0C,MAAP,CAAcwB,IAAd,CAAmB;CAClBvD,YAAAA,IAAI,EAAEoG,aAAa,CAACI,WADF;CAElBuL,YAAAA,OAAO,EAAEyG,aAAG,CAACC,UAAJ,CAAe,kCAAf;CAFS,WAAnB;CAIA;;CACD;;CACD,WAAK/S,aAAa,CAACG,QAAnB;CACC,YAAI/B,OAAO,CAAClE,MAAR,CAAeU,QAAf,IAA2B,CAA/B,EACA;CACCjB,UAAAA,MAAM,CAAC0C,MAAP,CAAcwB,IAAd,CAAmB;CAClBvD,YAAAA,IAAI,EAAEoG,aAAa,CAACG,cADF;CAElBwL,YAAAA,OAAO,EAAEyG,aAAG,CAACC,UAAJ,CAAe,qCAAf;CAFS,WAAnB;CAIA;;CACD;;CACD,WAAK/S,aAAa,CAACQ,KAAnB;CACC,YAAI,CAACxC,cAAI,CAACsF,OAAL,CAAalF,OAAO,CAAClE,MAAR,CAAewB,MAA5B,CAAD,IAAwC0C,OAAO,CAAClE,MAAR,CAAewB,MAAf,CAAsBmB,MAAtB,KAAiC,CAA7E,EACA;CACClD,UAAAA,MAAM,CAAC0C,MAAP,CAAcwB,IAAd,CAAmB;CAClBvD,YAAAA,IAAI,EAAEoG,aAAa,CAACK,WADF;CAElBsL,YAAAA,OAAO,EAAEyG,aAAG,CAACC,UAAJ,CAAe,kCAAf;CAFS,WAAnB;CAIA;;CACD;;CACD,WAAK/S,aAAa,CAACE,YAAnB;CACC,YAAI,CAAClC,cAAI,CAAC8J,QAAL,CAAc1J,OAAO,CAAClE,MAAR,CAAe6Q,SAA7B,CAAD,IAA4CpN,MAAM,CAACwgB,IAAP,CAAY/f,OAAO,CAAClE,MAAR,CAAe6Q,SAA3B,EAAsClO,MAAtC,KAAiD,CAAjG,EACA;CACClD,UAAAA,MAAM,CAAC0C,MAAP,CAAcwB,IAAd,CAAmB;CAClBvD,YAAAA,IAAI,EAAEoG,aAAa,CAACE,WADF;CAElByL,YAAAA,OAAO,EAAEyG,aAAG,CAACC,UAAJ,CAAe,oCAAf;CAFS,WAAnB;CAIA;;CACD;CA5CF;CA8CA,GA/CD;CAiDA,SAAOpZ,MAAP;CACA;;yCA+H6B0P,MAC9B;CACC,oEAAcA,IAAd;;CAEA,QAAM/P,MAAM,GAAG,KAAKgsB,KAAL,CAAWtL,OAAX,CAAmB,uBAAnB,GAAf;CAEA1gB,EAAAA,MAAM,CAACwD,OAAP,CAAe,CAACC,IAAD,EAAOE,KAAP,KAAiB,KAAKgmB,aAAL,CAAmB;CACjDhmB,IAAAA,KADiD;CAEjDmB,IAAAA,OAAO,EAAErB,IAFwC;CAGjDgV,IAAAA,iBAAiB,EAAGzY,MAAM,CAACuD,MAAP,KAAkB,CAAlB,IAAuBI,KAAK,KAAK,CAAjC,IAAsCF,IAAI,CAAC/C,OAAL,KAAiB;CAH1B,GAAnB,CAAhC;CAMA;;oBA4BQqP,MACT;CACC,OAAKA,IAAL,GAAYA,IAAZ;;CACA,MAAIA,IAAI,KAAKpI,QAAQ,CAACE,SAAtB,EACA;CACC,SAAKW,OAAL,CAAa4T,cAAb,GAA8B,EAA9B;CACA,GAHD,MAIK,IAAIrM,IAAI,KAAKpI,QAAQ,CAACI,qBAAtB,EACL;CACC,SAAKS,OAAL,CAAa4T,cAAb,GAA8B,EAA9B;CACA,SAAK5T,OAAL,CAAagT,aAAb,GAA6B,CAC5B9U,aAAa,CAACC,gBADc,EAE5BD,aAAa,CAACE,YAFc,EAG5BF,aAAa,CAACI,KAHc,EAI5BJ,aAAa,CAACQ,KAJc,CAA7B;CAMA,SAAKsB,OAAL,CAAauhB,WAAb,GAA2B,KAA3B;CACA,GAVI,MAWA,IAAIha,IAAI,KAAKpI,QAAQ,CAACG,WAAtB,EACL;CACC,SAAKU,OAAL,CAAa4T,cAAb,GAA8B,CAC7B1V,aAAa,CAACC,gBADe,EACGD,aAAa,CAACQ,KADjB,CAA9B;;CAGA,QAAI,KAAKsB,OAAL,CAAa6Q,yBAAjB,EACA;CACC,WAAK7Q,OAAL,CAAa4T,cAAb,CAA4B7X,IAA5B,CAAiCmC,aAAa,CAACI,KAA/C;CACA;;CACD,SAAK0B,OAAL,CAAagT,aAAb,GAA6B,KAAKmP,cAAL,CAAoBnP,aAAjD;;CAEA,QAAI,KAAKhT,OAAL,CAAaojB,mBAAb,KAAqC5N,mBAAmB,CAACC,QAA7D,EACA;CACC,WAAKzV,OAAL,CAAagT,aAAb,GAA6B,CAC5B9U,aAAa,CAACC,gBADc,EAE5BD,aAAa,CAACE,YAFc,EAG5BF,aAAa,CAACI,KAHc,EAI5BJ,aAAa,CAACQ,KAJc,CAA7B;CAMA,KARD,MAUA;CACC,WAAKsB,OAAL,CAAagT,aAAb,GAA6B,KAAKmP,cAAL,CAAoBnP,aAAjD;CACA;;CAED,SAAKhT,OAAL,CAAauhB,WAAb,GAA2B,KAA3B;CACA,GA1BI,MA4BL;CACCha,IAAAA,IAAI,GAAGpI,QAAQ,CAACC,OAAhB;CACA,SAAKY,OAAL,CAAagT,aAAb,GAA6B,KAAKmP,cAAL,CAAoBnP,aAAjD;CACA,SAAKhT,OAAL,CAAauhB,WAAb,GAA2B,KAAKY,cAAL,CAAoBZ,WAA/C;CACA,SAAKvhB,OAAL,CAAa4T,cAAb,GAA8B,KAAKuO,cAAL,CAAoBnP,aAAlD;CACA;;CAED,MAAI,KAAKyQ,cAAT,EACA;CACC,SAAKA,cAAL,CAAoBlc,IAApB,GAA2BA,IAA3B;CACA;;CAED,OAAKvH,OAAL,CAAakI,cAAb,GAA8B,EAA9B;;CACA,MAAIX,IAAI,KAAKpI,QAAQ,CAACG,WAAtB,EACA;CACC,QAAIqlB,yBAAyB,GAAG,CAC/BzmB,aAAa,CAACC,gBADiB,EACCD,aAAa,CAACI,KADf,CAAhC;;CAGA,QAAI,KAAK0B,OAAL,CAAaojB,mBAAb,KAAqC5N,mBAAmB,CAACC,QAA7D,EACA;CACCkP,MAAAA,yBAAyB,CAAC5oB,IAA1B,CAA+BmC,aAAa,CAACE,YAA7C;CACAumB,MAAAA,yBAAyB,CAAC5oB,IAA1B,CAA+BmC,aAAa,CAACQ,KAA7C;CACA;;CACD,SAAKsB,OAAL,CAAakI,cAAb,GAA8B,KAAKlI,OAAL,CAAagT,aAAb,CAA2BS,MAA3B,CAC7BxY,IAAI,IAAI0pB,yBAAyB,CAACrhB,QAA1B,CAAmCrI,IAAnC,CADqB,CAA9B;CAGA;;CAEDoJ,EAAAA,6BAAY,CAACoU,IAAb,CAAkB,IAAlB,EAAwB,0BAAxB,EAAoD;CAAElR,IAAAA;CAAF,GAApD;CACA;;;;;;;;;"}