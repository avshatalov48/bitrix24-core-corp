{"version":3,"file":"product-form.bundle.js","sources":["../src/types/form-element-position.js","../src/models/product-list.js","../src/config.js","../src/templates/row.js","../src/templates/item-add.js","../src/templates/form.js","../src/product-form.js"],"sourcesContent":["export type FormElementPositions = FormElementPosition.TOP | FormElementPosition.BOTTOM;\n\nexport class FormElementPosition\n{\n\tstatic TOP: string = 'TOP';\n\tstatic BOTTOM: string = 'BOTTOM';\n}","import {Vue} from 'ui.vue';\nimport {Text, Type} from 'main.core';\nimport {VuexBuilderModel} from 'ui.vue.vuex';\nimport {DiscountType, FieldScheme} from \"catalog.product-calculator\";\nimport {FormElementPosition} from \"../types/form-element-position\";\nimport {CurrencyCore} from \"currency.currency-core\";\nimport type {FormScheme} from \"../types/form-scheme\";\nimport type {BasketItem} from \"../types/basket-item\";\n\nexport class ProductList extends VuexBuilderModel\n{\n\t/**\n\t * @inheritDoc\n\t */\n\tgetName(): string\n\t{\n\t\treturn 'productList';\n\t}\n\n\tgetState(): FormScheme\n\t{\n\t\treturn {\n\t\t\tcurrency: '',\n\t\t\ttaxIncluded: 'N',\n\t\t\tbasket: [],\n\t\t\ttotal: {\n\t\t\t\tsum: 0,\n\t\t\t\tdiscount: 0,\n\t\t\t\ttaxSum: 0,\n\t\t\t\tresult: 0,\n\t\t\t},\n\t\t}\n\t}\n\n\tstatic getBaseProduct(): BasketItem\n\t{\n\t\tconst random = Text.getRandom();\n\t\treturn {\n\t\t\tofferId: null,\n\t\t\tselectorId: random,\n\t\t\tfields: {\n\t\t\t\tinnerId: random,\n\t\t\t\tproductId: null,\n\t\t\t\tskuId: null,\n\t\t\t\tcode: null,\n\t\t\t\tmodule: null,\n\t\t\t\tsort: 0,\n\t\t\t\tprice: 0,\n\t\t\t\tbasePrice: 0,\n\t\t\t\tpriceExclusive: 0,\n\t\t\t\tquantity: 1,\n\t\t\t\tname: '',\n\t\t\t\tdiscount: 0,\n\t\t\t\tdiscountRate: 0,\n\t\t\t\tdiscountInfos: [],\n\t\t\t\tdiscountType: DiscountType.PERCENTAGE,\n\t\t\t\ttax: 0,\n\t\t\t\ttaxSum: 0,\n\t\t\t\ttaxIncluded: 'N',\n\t\t\t\tmeasureCode: 0,\n\t\t\t\tmeasureName: '',\n\t\t\t\tmeasureRatio: 1,\n\t\t\t\tisCustomPrice: 'N',\n\t\t\t\tadditionalFields: [],\n\t\t\t\tproperties: [],\n\t\t\t},\n\t\t\tcalculatedFields: [],\n\t\t\tshowDiscount: 'N',\n\t\t\tshowTax: 'N',\n\t\t\tskuTree: [],\n\t\t\timage: null,\n\t\t\tsum: 0,\n\t\t\tdiscountSum: 0,\n\t\t\tdetailUrl: '',\n\t\t\tencodedFields: null,\n\t\t\terrors: [],\n\t\t};\n\t}\n\n\tgetActions()\n\t{\n\t\treturn {\n\t\t\tresetBasket ({commit})\n\t\t\t{\n\t\t\t\tcommit('clearBasket');\n\t\t\t\tcommit('addItem', {});\n\t\t\t},\n\t\t\tremoveItem({dispatch, commit, state}, payload)\n\t\t\t{\n\t\t\t\tcommit('deleteItem', payload);\n\t\t\t\tif (state.basket.length === 0)\n\t\t\t\t{\n\t\t\t\t\tcommit('addItem', {});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tstate.basket.forEach((item, i) => {\n\t\t\t\t\t\tcommit('updateItem', {\n\t\t\t\t\t\t\tindex: i,\n\t\t\t\t\t\t\tfields: {sort: i}\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tdispatch('calculateTotal');\n\t\t\t},\n\t\t\tchangeItem: ({dispatch, commit}, payload) =>\n\t\t\t{\n\t\t\t\tcommit('updateItem', payload);\n\t\t\t\tdispatch('calculateTotal');\n\t\t\t},\n\t\t\tsetCurrency: ({commit}, payload) =>\n\t\t\t{\n\t\t\t\tconst currency = payload || '';\n\t\t\t\tcommit('setCurrency', currency);\n\t\t\t},\n\t\t\taddItem: ({dispatch, commit}, payload) =>\n\t\t\t{\n\t\t\t\tconst item = payload.item || {fields: {}};\n\t\t\t\tcommit('addItem', {\n\t\t\t\t\titem,\n\t\t\t\t\tposition: payload.position || FormElementPosition.TOP\n\t\t\t\t});\n\t\t\t\tdispatch('calculateTotal');\n\t\t\t},\n\t\t\tcalculateTotal: ({commit, state}) =>\n\t\t\t{\n\t\t\t\tconst total = {\n\t\t\t\t\tsum: 0,\n\t\t\t\t\ttaxSum: 0,\n\t\t\t\t\tdiscount: 0,\n\t\t\t\t\tresult: 0,\n\t\t\t\t};\n\n\t\t\t\tstate.basket.forEach((item) => {\n\t\t\t\t\tconst basePrice = Text.toNumber(item.fields.basePrice || 0);\n\t\t\t\t\tconst quantity = Text.toNumber(item.fields.quantity || 0);\n\t\t\t\t\tconst discount = Text.toNumber(item.fields.discount || 0);\n\t\t\t\t\tconst taxSum = Text.toNumber(item.fields.taxSum || 0);\n\t\t\t\t\ttotal.sum += basePrice * quantity;\n\t\t\t\t\ttotal.result += Text.toNumber(item.sum);\n\t\t\t\t\ttotal.discount += discount * quantity;\n\t\t\t\t\ttotal.taxSum += taxSum * quantity;\n\t\t\t\t});\n\n\t\t\t\ttotal.discount = (total.discount > total.sum) ? total.sum : total.discount;\n\n\t\t\t\tcommit('setTotal', total)\n\t\t\t}\n\t\t}\n\t}\n\n\tgetGetters()\n\t{\n\t\treturn {\n\t\t\tgetBasket: state => (): Array<BasketItem> =>\n\t\t\t{\n\t\t\t\treturn state.basket;\n\t\t\t},\n\t\t\tgetBaseProduct: () => (): BasketItem =>\n\t\t\t{\n\t\t\t\treturn ProductList.getBaseProduct();\n\t\t\t},\n\t\t}\n\t}\n\n\tgetMutations()\n\t{\n\t\treturn {\n\t\t\taddItem: (state, payload) =>\n\t\t\t{\n\t\t\t\tlet item = ProductList.getBaseProduct();\n\n\t\t\t\titem = Object.assign(item, payload.item);\n\t\t\t\tif (payload.position === FormElementPosition.BOTTOM)\n\t\t\t\t{\n\t\t\t\t\tstate.basket.push(item);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tstate.basket.unshift(item);\n\t\t\t\t}\n\n\t\t\t\tstate.basket.forEach((item, index) => {\n\t\t\t\t\titem.fields.sort = index;\n\t\t\t\t});\n\t\t\t},\n\t\t\tupdateItem: (state, payload) =>\n\t\t\t{\n\t\t\t\tif (typeof state.basket[payload.index] === 'undefined')\n\t\t\t\t{\n\t\t\t\t\tVue.set(state.basket, payload.index, ProductList.getBaseProduct());\n\t\t\t\t}\n\n\t\t\t\tstate.basket[payload.index] = Object.assign(\n\t\t\t\t\tstate.basket[payload.index],\n\t\t\t\t\tpayload.fields\n\t\t\t\t);\n\t\t\t},\n\t\t\tclearBasket: (state) =>\n\t\t\t{\n\t\t\t\tstate.basket = [];\n\t\t\t},\n\t\t\tdeleteItem: (state, payload) =>\n\t\t\t{\n\t\t\t\tstate.basket.splice(payload.index, 1);\n\t\t\t\tstate.basket.forEach((item, index) => {\n\t\t\t\t\titem.fields.sort = index;\n\t\t\t\t});\n\t\t\t},\n\t\t\tsetErrors: (state, payload) =>\n\t\t\t{\n\t\t\t\tstate.errors = payload;\n\t\t\t},\n\t\t\tclearErrors: (state) =>\n\t\t\t{\n\t\t\t\tstate.errors = [];\n\t\t\t},\n\t\t\tsetCurrency: (state, payload) =>\n\t\t\t{\n\t\t\t\tstate.currency = payload;\n\t\t\t},\n\t\t\tsetTotal: (state, payload) =>\n\t\t\t{\n\t\t\t\tconst formattedTotal = payload;\n\t\t\t\tif (Type.isStringFilled(state.currency))\n\t\t\t\t{\n\t\t\t\t\tfor (const key in payload)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (payload.hasOwnProperty(key))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tformattedTotal[key] = CurrencyCore.currencyFormat(payload[key], state.currency)\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tstate.total = Object.assign(\n\t\t\t\t\tstate.total,\n\t\t\t\t\tformattedTotal\n\t\t\t\t);\n\t\t\t},\n\t\t}\n\t}\n}","export const config = Object.freeze({\n\tdatabaseConfig: {\n\t\tname: 'catalog.product-form',\n\t},\n\ttemplateName: 'bx-product-form',\n\ttemplateProductAddName: 'bx-product-add',\n\ttemplateProductRowName: 'bx-product-form-row',\n\tmoduleId: 'catalog',\n});","import {config} from \"../config\";\nimport {Vue} from \"ui.vue\";\nimport {Text, Type, Runtime} from \"main.core\";\nimport {Menu} from 'main.popup';\nimport {Popup} from 'main.popup';\n\nimport \"catalog.product-selector\";\nimport \"ui.common\";\nimport \"ui.alerts\";\nimport {type BaseEvent, EventEmitter} from 'main.core.events';\nimport {ProductSelector} from \"catalog.product-selector\";\nimport {ProductCalculator, DiscountType, TaxForPriceStrategy} from \"catalog.product-calculator\";\n\nVue.component(config.templateProductRowName,\n\t{\n\t\t/**\n\t\t * @emits 'changeProduct' {index: number, fields: object}\n\t\t * @emits 'changeRowData' {index: number, fields: object}\n\t\t * @emits 'refreshBasket'\n\t\t * @emits 'removeItem' {index: number}\n\t\t */\n\n\t\tprops: ['basketItem', 'basketItemIndex', 'countItems', 'options', 'editable'],\n\t\tdata()\n\t\t{\n\t\t\treturn {\n\t\t\t\tcurrencySymbol: null,\n\t\t\t\tproductSelector: null,\n\t\t\t\timageControlId: null,\n\t\t\t\tselectorId: this.basketItem.selectorId,\n\t\t\t};\n\t\t},\n\t\tcreated()\n\t\t{\n\t\t\tconst defaultFields = this.basketItem.fields;\n\t\t\tconst defaultPrice = Text.toNumber(defaultFields.price);\n\t\t\tconst basePrice = this.basketItem.fields.basePrice || defaultPrice;\n\t\t\tconst calculatorFields = {\n\t\t\t\t'QUANTITY': Text.toNumber(defaultFields.quantity),\n\t\t\t\t'BASE_PRICE': basePrice,\n\t\t\t\t'PRICE': defaultPrice,\n\t\t\t\t'PRICE_NETTO': basePrice,\n\t\t\t\t'PRICE_BRUTTO': defaultPrice,\n\t\t\t\t'PRICE_EXCLUSIVE': this.basketItem.fields.priceExclusive || defaultPrice,\n\t\t\t\t'DISCOUNT_TYPE_ID': Text.toNumber(defaultFields.discountType) || DiscountType.PERCENTAGE,\n\t\t\t\t'DISCOUNT_RATE': Text.toNumber(defaultFields.discountRate),\n\t\t\t\t'DISCOUNT_SUM': Text.toNumber(defaultFields.discount),\n\t\t\t\t'TAX_INCLUDED': defaultFields.taxIncluded || this.options.taxIncluded,\n\t\t\t\t'TAX_RATE': defaultFields.tax || 0,\n\t\t\t\t'CUSTOMIZED': defaultFields.isCustomPrice || 'N',\n\t\t\t};\n\n\t\t\tconst pricePrecision = this.options.pricePrecision || 2;\n\t\t\tthis.calculator = new ProductCalculator(calculatorFields, {\n\t\t\t\tcurrencyId: this.options.currency,\n\t\t\t\tpricePrecision: pricePrecision,\n\t\t\t\tcommonPrecision: pricePrecision,\n\t\t\t});\n\n\t\t\tthis.calculator.setCalculationStrategy(new TaxForPriceStrategy(this.calculator));\n\n\t\t\tthis.currencySymbol = this.options.currencySymbol;\n\t\t\tthis.defaultMeasure = {\n\t\t\t\tname: '',\n\t\t\t\tid: null,\n\t\t\t};\n\n\t\t\tif (Type.isArray(this.options.measures))\n\t\t\t{\n\t\t\t\tthis.options.measures.map((measure) => {\n\t\t\t\t\tif (measure['IS_DEFAULT'] === 'Y')\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.defaultMeasure.name = measure.SYMBOL;\n\t\t\t\t\t\tthis.defaultMeasure.code = measure.CODE;\n\n\t\t\t\t\t\tif (!defaultFields.measureName && !defaultFields.measureCode)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.changeProduct({\n\t\t\t\t\t\t\t\tmeasureCode: this.defaultMeasure.code,\n\t\t\t\t\t\t\t\tmeasureName: this.defaultMeasure.name\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tEventEmitter.subscribe('BX.Catalog.ProductSelector:onChange', this.onProductChange.bind(this));\n\t\t\tEventEmitter.subscribe('BX.Catalog.ProductSelector:onClear', this.onProductClear.bind(this));\n\n\t\t\tthis.onInputPrice = Runtime.debounce(this.changePrice, 500, this);\n\t\t\tthis.onInputQuantity = Runtime.debounce(this.changeQuantity, 500, this);\n\t\t\tthis.onInputDiscount = Runtime.debounce(this.changeDiscount, 500, this);\n\t\t},\n\t\tmounted()\n\t\t{\n\t\t\tthis.productSelector = new ProductSelector(this.selectorId, this.prepareSelectorParams());\n\t\t\tthis.productSelector.renderTo(this.$refs.selectorWrapper);\n\t\t},\n\t\tupdated()\n\t\t{\n\t\t\tif (Type.isObject(this.basketItem.calculatedFields))\n\t\t\t{\n\t\t\t\tconst changedFields = this.basketItem.calculatedFields;\n\t\t\t\tchangedFields['PRICES'] = {};\n\t\t\t\tchangedFields['PRICES'][this.options.basePriceId] = {\n\t\t\t\t\tPRICE: changedFields.BASE_PRICE || changedFields.PRICE,\n\t\t\t\t\tCURRENCY: this.options.currency,\n\t\t\t\t};\n\n\t\t\t\tchangedFields['MEASURE_CODE'] = this.basketItem.fields.measureCode;\n\t\t\t\tEventEmitter.emit(this, 'ProductList::onChangeFields', {\n\t\t\t\t\trowId: this.selectorId,\n\t\t\t\t\tfields: changedFields\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\tmethods:\n\t\t\t{\n\t\t\t\tprepareSelectorParams(): Object\n\t\t\t\t{\n\t\t\t\t\tconst selectorOptions = {\n\t\t\t\t\t\tiblockId: this.options.iblockId,\n\t\t\t\t\t\tbasePriceId: this.options.basePriceId,\n\t\t\t\t\t\tproductId: this.getField('productId'),\n\t\t\t\t\t\tskuId: this.getField('skuId'),\n\t\t\t\t\t\tskuTree: this.getDefaultSkuTree(),\n\t\t\t\t\t\tfileInputId: '',\n\t\t\t\t\t\tmorePhotoValues: [],\n\t\t\t\t\t\tfileInput: '',\n\t\t\t\t\t\timageValues: [],\n\t\t\t\t\t\tconfig: {\n\t\t\t\t\t\t\tDETAIL_PATH: this.basketItem.detailUrl || '',\n\t\t\t\t\t\t\tENABLE_SEARCH: true,\n\t\t\t\t\t\t\tENABLE_INPUT_DETAIL_LINK: true,\n\t\t\t\t\t\t\tENABLE_IMAGE_CHANGE_SAVING: true,\n\t\t\t\t\t\t\tENABLE_EMPTY_PRODUCT_ERROR: this.options.enableEmptyProductError,\n\t\t\t\t\t\t\tROW_ID: this.selectorId,\n\t\t\t\t\t\t\tENABLE_SKU_SELECTION: this.editable,\n\t\t\t\t\t\t\tHIDE_UNSELECTED_ITEMS: this.options.hideUnselectedProperties,\n\t\t\t\t\t\t\tURL_BUILDER_CONTEXT: this.options.urlBuilderContext\n\t\t\t\t\t\t},\n\t\t\t\t\t\tmode: this.editable ? ProductSelector.MODE_EDIT : ProductSelector.MODE_VIEW,\n\t\t\t\t\t\tisSimpleModel:\n\t\t\t\t\t\t\tthis.getField('name', '') !== ''\n\t\t\t\t\t\t\t&& this.getField('productId') <= 0\n\t\t\t\t\t\t\t&& this.getField('skuId') <= 0\n\t\t\t\t\t\t,\n\t\t\t\t\t\tfields: {\n\t\t\t\t\t\t\tNAME: this.getField('name') || '',\n\t\t\t\t\t\t\tPRICE: this.getField('basePrice') || 0,\n\t\t\t\t\t\t\tCURRENCY: this.options.currency,\n\t\t\t\t\t\t},\n\t\t\t\t\t};\n\n\t\t\t\t\tconst formImage = this.basketItem.image;\n\t\t\t\t\tif (Type.isObject(formImage))\n\t\t\t\t\t{\n\t\t\t\t\t\tselectorOptions.fileView = formImage.preview;\n\t\t\t\t\t\tselectorOptions.fileInput = formImage.input;\n\t\t\t\t\t\tselectorOptions.fileInputId = formImage.id;\n\t\t\t\t\t\tselectorOptions.morePhotoValues = formImage.values;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn selectorOptions;\n\t\t\t\t},\n\t\t\t\tgetDefaultSkuTree(): Object\n\t\t\t\t{\n\t\t\t\t\tlet skuTree = this.basketItem.skuTree || {};\n\t\t\t\t\tif (Type.isStringFilled(skuTree))\n\t\t\t\t\t{\n\t\t\t\t\t\tskuTree = JSON.parse(skuTree);\n\t\t\t\t\t}\n\n\t\t\t\t\treturn skuTree;\n\t\t\t\t},\n\t\t\t\tgetField(name, defaultValue = null)\n\t\t\t\t{\n\t\t\t\t\treturn this.basketItem.fields[name] || defaultValue;\n\t\t\t\t},\n\t\t\t\tgetCalculator(): ProductCalculator\n\t\t\t\t{\n\t\t\t\t\treturn this.calculator;\n\t\t\t\t},\n\t\t\t\tsetCalculatedFields(fields: {}): void\n\t\t\t\t{\n\t\t\t\t\tconst map = {\n\t\t\t\t\t\tcalculatedFields: fields,\n\t\t\t\t\t};\n\t\t\t\t\tconst productFields = this.basketItem.fields;\n\n\t\t\t\t\tif (!Type.isNil(fields.ID))\n\t\t\t\t\t{\n\t\t\t\t\t\tmap.offerId = Text.toNumber(fields.ID);\n\t\t\t\t\t\tproductFields.productId = Text.toNumber(fields.PRODUCT_ID);\n\t\t\t\t\t\tproductFields.skuId = Text.toNumber(fields.SKU_ID);\n\t\t\t\t\t}\n\t\t\t\t\tif (!Type.isNil(fields.NAME))\n\t\t\t\t\t{\n\t\t\t\t\t\tproductFields.name = fields.NAME;\n\t\t\t\t\t}\n\t\t\t\t\tif (!Type.isNil(fields.MODULE))\n\t\t\t\t\t{\n\t\t\t\t\t\tproductFields.module = fields.MODULE;\n\t\t\t\t\t}\n\t\t\t\t\tif (Text.toNumber(fields.BASE_PRICE) >= 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tproductFields.basePrice = Text.toNumber(fields.BASE_PRICE);\n\t\t\t\t\t}\n\t\t\t\t\tif (Text.toNumber(fields.PRICE) >= 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tproductFields.price = Text.toNumber(fields.PRICE);\n\t\t\t\t\t\tproductFields.priceExclusive = Text.toNumber(fields.PRICE_EXCLUSIVE);\n\t\t\t\t\t}\n\t\t\t\t\tif (Text.toNumber(fields.PRICE_EXCLUSIVE) >= 0 && fields.TAX_INCLUDED === 'Y')\n\t\t\t\t\t{\n\t\t\t\t\t\tproductFields.priceExclusive = Text.toNumber(fields.PRICE);\n\t\t\t\t\t}\n\t\t\t\t\tif (Text.toNumber(fields.QUANTITY) > 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tproductFields.quantity = Text.toNumber(fields.QUANTITY);\n\t\t\t\t\t}\n\t\t\t\t\tif (!Type.isNil(fields.DISCOUNT_RATE))\n\t\t\t\t\t{\n\t\t\t\t\t\tproductFields.discountRate = Text.toNumber(fields.DISCOUNT_RATE);\n\t\t\t\t\t}\n\t\t\t\t\tif (!Type.isNil(fields.DISCOUNT_SUM))\n\t\t\t\t\t{\n\t\t\t\t\t\tproductFields.discount = Text.toNumber(fields.DISCOUNT_SUM);\n\t\t\t\t\t}\n\t\t\t\t\tif (!Type.isNil(fields.DISCOUNT_TYPE_ID))\n\t\t\t\t\t{\n\t\t\t\t\t\tproductFields.discountType = fields.DISCOUNT_TYPE_ID;\n\t\t\t\t\t}\n\t\t\t\t\tif (Text.toNumber(fields.SUM) >= 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tmap.sum = Text.toNumber(fields.SUM);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!Type.isNil(fields.CUSTOMIZED))\n\t\t\t\t\t{\n\t\t\t\t\t\tproductFields.isCustomPrice = fields.CUSTOMIZED;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!Type.isNil(fields.MEASURE_CODE))\n\t\t\t\t\t{\n\t\t\t\t\t\tproductFields.measureCode = fields.MEASURE_CODE;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!Type.isNil(fields.MEASURE_NAME))\n\t\t\t\t\t{\n\t\t\t\t\t\tproductFields.measureName = fields.MEASURE_NAME;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!Type.isNil(fields.PROPERTIES))\n\t\t\t\t\t{\n\t\t\t\t\t\tproductFields.properties = fields.PROPERTIES;\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.changeRowData(map);\n\t\t\t\t\tthis.changeProduct(productFields);\n\t\t\t\t},\n\t\t\t\tchangeRowData(fields: {}): void\n\t\t\t\t{\n\t\t\t\t\tthis.$emit('changeRowData', {\n\t\t\t\t\t\tindex: this.basketItemIndex,\n\t\t\t\t\t\tfields\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tchangeProduct(fields: {}): void\n\t\t\t\t{\n\t\t\t\t\tfields = Object.assign(this.basketItem.fields, fields);\n\t\t\t\t\tthis.$emit('changeProduct', {\n\t\t\t\t\t\tindex: this.basketItemIndex,\n\t\t\t\t\t\tfields\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tonProductChange(event: BaseEvent)\n\t\t\t\t{\n\t\t\t\t\tconst data = event.getData();\n\t\t\t\t\tif (Type.isStringFilled(data.selectorId) && data.selectorId === this.productSelector.getId())\n\t\t\t\t\t{\n\t\t\t\t\t\tconst basePrice = Text.toNumber(data.fields.PRICE);\n\n\t\t\t\t\t\tlet fields = {\n\t\t\t\t\t\t\tBASE_PRICE: basePrice,\n\t\t\t\t\t\t\tMODULE: 'catalog',\n\t\t\t\t\t\t\tNAME: data.fields.NAME,\n\t\t\t\t\t\t\tID: data.fields.ID,\n\t\t\t\t\t\t\tPRODUCT_ID: data.fields.PRODUCT_ID,\n\t\t\t\t\t\t\tSKU_ID: data.fields.SKU_ID,\n\t\t\t\t\t\t\tPROPERTIES: data.fields.PROPERTIES,\n\t\t\t\t\t\t\tURL_BUILDER_CONTEXT: this.options.urlBuilderContext,\n\t\t\t\t\t\t\tCUSTOMIZED: Type.isNil(data.fields.PRICE) ? 'Y' : 'N',\n\t\t\t\t\t\t\tMEASURE_CODE: data.fields.MEASURE_CODE,\n\t\t\t\t\t\t\tMEASURE_NAME: data.fields.MEASURE_NAME,\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\tfields = Object.assign(\n\t\t\t\t\t\t\tthis.getCalculator().calculatePrice(basePrice),\n\t\t\t\t\t\t\tfields\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\tthis.getCalculator().setFields(fields);\n\t\t\t\t\t\tthis.setCalculatedFields(fields);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tonProductClear(event: BaseEvent)\n\t\t\t\t{\n\t\t\t\t\tconst data = event.getData();\n\n\t\t\t\t\tif (Type.isStringFilled(data.selectorId) && data.selectorId === this.productSelector.getId())\n\t\t\t\t\t{\n\n\t\t\t\t\t\tconst fields = this.getCalculator().calculatePrice(0);\n\n\t\t\t\t\t\tfields.BASE_PRICE = 0;\n\t\t\t\t\t\tfields.NAME = '';\n\t\t\t\t\t\tfields.ID = 0;\n\t\t\t\t\t\tfields.PRODUCT_ID = 0;\n\t\t\t\t\t\tfields.SKU_ID = 0;\n\t\t\t\t\t\tfields.MODULE = '';\n\n\t\t\t\t\t\tthis.getCalculator().setFields(fields);\n\t\t\t\t\t\tthis.setCalculatedFields(fields);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\ttoggleDiscount(value: string): void\n\t\t\t\t{\n\t\t\t\t\tif (!this.editable)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.changeRowData(\n\t\t\t\t\t\t{showDiscount: value}\n\t\t\t\t\t);\n\n\t\t\t\t\tvalue === 'Y' ? setTimeout(() => this.$refs.discountInput.focus()) : null;\n\t\t\t\t},\n\t\t\t\ttoggleTax(value: string): void\n\t\t\t\t{\n\t\t\t\t\tthis.changeRowData(\n\t\t\t\t\t\t{showTax: value}\n\t\t\t\t\t);\n\t\t\t\t},\n\t\t\t\tchangeQuantity(event: BaseEvent): void\n\t\t\t\t{\n\t\t\t\t\tif (!this.editable)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tevent.target.value = event.target.value.replace(/[^.\\d]/g,'.');\n\t\t\t\t\tlet newQuantity = parseFloat(event.target.value);\n\t\t\t\t\tlet lastSymbol = event.target.value.substr(-1);\n\n\t\t\t\t\tif (!newQuantity || lastSymbol === '.')\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst calculatedFields = this.getCalculator().calculateQuantity(newQuantity);\n\t\t\t\t\tthis.setCalculatedFields(calculatedFields);\n\t\t\t\t\tthis.getCalculator().setFields(calculatedFields);\n\t\t\t\t},\n\t\t\t\tchangePrice(event: BaseEvent): void\n\t\t\t\t{\n\t\t\t\t\tif (!this.editable)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tevent.target.value = event.target.value.replace(/[^.,\\d]/g,'');\n\t\t\t\t\tif (event.target.value === '')\n\t\t\t\t\t{\n\t\t\t\t\t\tevent.target.value = 0;\n\t\t\t\t\t}\n\t\t\t\t\tlet lastSymbol = event.target.value.substr(-1);\n\t\t\t\t\tif (lastSymbol === ',')\n\t\t\t\t\t{\n\t\t\t\t\t\tevent.target.value = event.target.value.replace(',', \".\");\n\t\t\t\t\t}\n\t\t\t\t\tlet newPrice = parseFloat(event.target.value);\n\t\t\t\t\tif (newPrice < 0|| lastSymbol === '.' || lastSymbol === ',')\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst calculatedFields = this.getCalculator().calculatePrice(newPrice);\n\t\t\t\t\tcalculatedFields.BASE_PRICE = newPrice;\n\t\t\t\t\tthis.getCalculator().setFields(calculatedFields);\n\t\t\t\t\tthis.setCalculatedFields(calculatedFields);\n\t\t\t\t},\n\t\t\t\t/**\n\t\t\t\t *\n\t\t\t\t * @param discountType {string}\n\t\t\t\t */\n\t\t\t\tchangeDiscountType(discountType)\n\t\t\t\t{\n\t\t\t\t\tif (!this.editable)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tlet type = (Text.toNumber(discountType) === DiscountType.MONETARY) ?  DiscountType.MONETARY : DiscountType.PERCENTAGE;\n\t\t\t\t\tconst calculatedFields = this.getCalculator().calculateDiscountType(type);\n\t\t\t\t\tthis.getCalculator().setFields(calculatedFields);\n\t\t\t\t\tthis.setCalculatedFields(calculatedFields);\n\t\t\t\t},\n\t\t\t\tchangeDiscount(event)\n\t\t\t\t{\n\t\t\t\t\tlet discountValue = Text.toNumber(event.target.value) || 0;\n\t\t\t\t\tif (discountValue === Text.toNumber(this.basketItem.discount) || !this.editable)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst calculatedFields = this.getCalculator().calculateDiscount(discountValue);\n\t\t\t\t\tthis.getCalculator().setFields(calculatedFields);\n\t\t\t\t\tthis.setCalculatedFields(calculatedFields);\n\t\t\t\t},\n\t\t\t\tchangeTax(taxValue)\n\t\t\t\t{\n\t\t\t\t\tif (taxValue === Text.toNumber(this.basketItem.tax) || !this.editable)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst calculatedFields = this.getCalculator().calculateTax(taxValue);\n\t\t\t\t\tthis.getCalculator().setFields(calculatedFields);\n\t\t\t\t\tthis.setCalculatedFields(calculatedFields);\n\t\t\t\t},\n\t\t\t\tchangeTaxIncluded(taxIncluded)\n\t\t\t\t{\n\t\t\t\t\tif (taxIncluded === this.basketItem.taxIncluded || !this.editable)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst calculatedFields = this.getCalculator().calculateTaxIncluded(taxIncluded);\n\t\t\t\t\tthis.getCalculator().setFields(calculatedFields);\n\t\t\t\t\tthis.setCalculatedFields(calculatedFields);\n\t\t\t\t},\n\t\t\t\tremoveItem()\n\t\t\t\t{\n\t\t\t\t\tthis.$emit('removeItem', {\n\t\t\t\t\t\tindex: this.basketItemIndex\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\topenDiscountEditor(e, url)\n\t\t\t\t{\n\t\t\t\t\tif(!(window.top.BX.SidePanel && window.top.BX.SidePanel.Instance))\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\twindow.top.BX.SidePanel.Instance.open (\n\t\t\t\t\t\tBX.util.add_url_param( url, { \"IFRAME\": \"Y\", \"IFRAME_TYPE\": \"SIDE_SLIDER\", \"publicSidePanel\": \"Y\" } ),\n\t\t\t\t\t\t{ allowChangeHistory: false }\n\t\t\t\t\t);\n\n\t\t\t\t\te.preventDefault ? e.preventDefault() : (e.returnValue = false);\n\t\t\t\t},\n\t\t\t\tisEmptyProductName()\n\t\t\t\t{\n\t\t\t\t\treturn (this.basketItem.name.length === 0);\n\t\t\t\t},\n\t\t\t\tcalculateCorrectionFactor(quantity, measureRatio)\n\t\t\t\t{\n\t\t\t\t\tlet factoredQuantity = quantity;\n\t\t\t\t\tlet factoredRatio = measureRatio;\n\t\t\t\t\tlet correctionFactor = 1;\n\n\t\t\t\t\twhile (!(Number.isInteger(factoredQuantity) && Number.isInteger(factoredRatio)))\n\t\t\t\t\t{\n\t\t\t\t\t\tcorrectionFactor *= 10;\n\t\t\t\t\t\tfactoredQuantity = quantity * correctionFactor;\n\t\t\t\t\t\tfactoredRatio = measureRatio * correctionFactor;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn correctionFactor;\n\t\t\t\t},\n\t\t\t\tincrementQuantity()\n\t\t\t\t{\n\t\t\t\t\tif (!this.editable)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tlet correctionFactor = this.calculateCorrectionFactor(this.basketItem.quantity, this.basketItem.measureRatio);\n\t\t\t\t\tconst quantity = (this.basketItem.quantity * correctionFactor + this.basketItem.measureRatio * correctionFactor) / correctionFactor;\n\t\t\t\t\tthis.changeQuantity(quantity);\n\t\t\t\t},\n\t\t\t\tdecrementQuantity()\n\t\t\t\t{\n\t\t\t\t\tif (this.basketItem.quantity > this.basketItem.measureRatio && this.editable)\n\t\t\t\t\t{\n\t\t\t\t\t\tlet correctionFactor = this.calculateCorrectionFactor(this.basketItem.quantity, this.basketItem.measureRatio);\n\t\t\t\t\t\tconst quantity = (this.basketItem.quantity * correctionFactor - this.basketItem.measureRatio * correctionFactor) / correctionFactor;\n\t\t\t\t\t\tthis.changeQuantity(quantity);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tshowPopupMenu(target, array, type)\n\t\t\t\t{\n\t\t\t\t\tif (!this.editable)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst menuItems = [];\n\t\t\t\t\tconst setItem = (ev, param) => {\n\t\t\t\t\t\tif (type === 'tax')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.changeTax(Text.toNumber(param.options.item));\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (type === 'measures')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst productFields = this.basketItem.fields;\n\t\t\t\t\t\t\tproductFields['measureCode'] = param.options.item.CODE;\n\t\t\t\t\t\t\tproductFields['measureName'] = param.options.item.SYMBOL;\n\t\t\t\t\t\t\tthis.changeProduct(productFields);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttarget.innerHTML = ev.target.innerHTML;\n\n\t\t\t\t\t\t\tif(type === 'discount')\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.changeDiscountType(param.options.type);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis.popupMenu.close();\n\t\t\t\t\t};\n\n\t\t\t\t\tif(type === 'discount')\n\t\t\t\t\t{\n\t\t\t\t\t\tarray = [];\n\t\t\t\t\t\tif (Type.isArray(this.options.allowedDiscountTypes))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (this.options.allowedDiscountTypes.includes(DiscountType.PERCENTAGE))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tarray[DiscountType.PERCENTAGE] = '%';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (this.options.allowedDiscountTypes.includes(DiscountType.MONETARY))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tarray[DiscountType.MONETARY] = this.currencySymbol;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif(array)\n\t\t\t\t\t{\n\t\t\t\t\t\tfor(let item in array)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlet text = array[item];\n\n\t\t\t\t\t\t\tif (type === 'measures')\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttext = array[item].SYMBOL;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse if (type === 'tax')\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttext = text + '%';\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tmenuItems.push({\n\t\t\t\t\t\t\t\ttext: text,\n\t\t\t\t\t\t\t\titem: array[item],\n\t\t\t\t\t\t\t\tonclick: setItem.bind({ value: 'settswguy' }),\n\t\t\t\t\t\t\t\ttype: type === 'discount' ? item : null\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (menuItems.length > 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.popupMenu = new Menu({\n\t\t\t\t\t\t\tbindElement: target,\n\t\t\t\t\t\t\titems: menuItems\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tthis.popupMenu.show();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tshowProductTooltip(e)\n\t\t\t\t{\n\t\t\t\t\tif(!this.productTooltip)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.productTooltip = new Popup({\n\t\t\t\t\t\t\tbindElement: e.target,\n\t\t\t\t\t\t\tmaxWidth: 400,\n\t\t\t\t\t\t\tdarkMode: true,\n\t\t\t\t\t\t\tinnerHTML: e.target.value,\n\t\t\t\t\t\t\tanimation: 'fading-slide'\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.productTooltip.setContent(e.target.value);\n\t\t\t\t\te.target.value.length > 0 ? this.productTooltip.show() : null;\n\t\t\t\t},\n\t\t\t\thideProductTooltip()\n\t\t\t\t{\n\t\t\t\t\tthis.productTooltip ? this.productTooltip.close() : null;\n\t\t\t\t}\n\t\t\t},\n\t\twatch:\n\t\t\t{\n\t\t\t\ttaxIncluded(value, oldValue){\n\t\t\t\t\tif (value !== oldValue)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.changeTaxIncluded(value);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\tcomputed:\n\t\t\t{\n\t\t\t\tlocalize()\n\t\t\t\t{\n\t\t\t\t\treturn Vue.getFilteredPhrases('CATALOG_FORM_');\n\t\t\t\t},\n\t\t\t\tshowDiscount()\n\t\t\t\t{\n\t\t\t\t\treturn this.showDiscountBlock && this.basketItem.showDiscount === 'Y';\n\t\t\t\t},\n\t\t\t\tgetDiscountSymbol()\n\t\t\t\t{\n\t\t\t\t\treturn Text.toNumber(this.basketItem.fields.discountType) === DiscountType.PERCENTAGE ? '%' : this.currencySymbol;\n\t\t\t\t},\n\t\t\t\tgetDiscountInputValue()\n\t\t\t\t{\n\t\t\t\t\tif (Text.toNumber(this.basketItem.fields.discountType) === DiscountType.PERCENTAGE)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn Text.toNumber(this.basketItem.fields.discountRate);\n\t\t\t\t\t}\n\n\t\t\t\t\treturn Text.toNumber(this.basketItem.fields.discount);\n\t\t\t\t},\n\t\t\t\tgetPriceExclusive()\n\t\t\t\t{\n\t\t\t\t\treturn this.basketItem.fields.priceExclusive || this.basketItem.fields.price\n\t\t\t\t},\n\t\t\t\tshowDiscountBlock()\n\t\t\t\t{\n\t\t\t\t\treturn this.options.showDiscountBlock === 'Y'\n\t\t\t\t\t\t&& (\n\t\t\t\t\t\t\tthis.editable\n\t\t\t\t\t\t\t|| (!this.editable && this.basketItem.fields.discount > 0)\n\t\t\t\t\t\t);\n\t\t\t\t},\n\t\t\t\tshowTaxBlock()\n\t\t\t\t{\n\t\t\t\t\treturn this.options.showTaxBlock === 'Y'\n\t\t\t\t\t\t&& this.getTaxList.length > 0\n\t\t\t\t\t\t&& (\n\t\t\t\t\t\t\tthis.editable\n\t\t\t\t\t\t\t|| (!this.editable && this.showBasePrice)\n\t\t\t\t\t\t);\n\t\t\t\t},\n\t\t\t\tshowRemoveIcon()\n\t\t\t\t{\n\t\t\t\t\tif (!this.editable)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (this.countItems > 1)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn this.basketItem.offerId !== null;\n\t\t\t\t},\n\t\t\t\tshowTaxSelector()\n\t\t\t\t{\n\t\t\t\t\treturn this.basketItem.showTax === 'Y';\n\t\t\t\t},\n\t\t\t\tshowBasePrice()\n\t\t\t\t{\n\t\t\t\t\treturn this.basketItem.fields.discount > 0\n\t\t\t\t\t\t|| (Text.toNumber(this.basketItem.fields.price) !== Text.toNumber(this.basketItem.fields.basePrice))\n\t\t\t\t\t;\n\t\t\t\t},\n\t\t\t\tgetMeasureName()\n\t\t\t\t{\n\t\t\t\t\treturn this.basketItem.fields.measureName || this.defaultMeasure.name;\n\t\t\t\t},\n\t\t\t\tgetMeasureCode()\n\t\t\t\t{\n\t\t\t\t\treturn this.basketItem.fields.measureCode || this.defaultMeasure.code;\n\t\t\t\t},\n\t\t\t\tgetTaxList()\n\t\t\t\t{\n\t\t\t\t\treturn Type.isArray(this.options.taxList) ? this.options.taxList : [];\n\t\t\t\t},\n\t\t\t\ttaxIncluded()\n\t\t\t\t{\n\t\t\t\t\treturn this.basketItem.fields.taxIncluded;\n\t\t\t\t},\n\t\t\t\tisTaxIncluded()\n\t\t\t\t{\n\t\t\t\t\treturn this.taxIncluded === 'Y';\n\t\t\t\t},\n\t\t\t\tisNotEnoughQuantity()\n\t\t\t\t{\n\t\t\t\t\treturn this.basketItem.errors.includes('SALE_BASKET_AVAILABLE_QUANTITY');\n\t\t\t\t},\n\t\t\t\thasPriceError()\n\t\t\t\t{\n\t\t\t\t\treturn this.basketItem.errors.includes('SALE_BASKET_ITEM_WRONG_PRICE');\n\t\t\t\t}\n\t\t\t},\n\t\ttemplate: `\n\t\t<div class=\"catalog-pf-product-item\" v-bind:class=\"{ 'catalog-pf-product-item--borderless': !editable && basketItemIndex === 0 }\">\n\t\t\t<div class=\"catalog-pf-product-item--remove\" @click=\"removeItem\" v-if=\"showRemoveIcon\"></div>\n\t\t\t<div class=\"catalog-pf-product-item--num\">\n\t\t\t\t<div class=\"catalog-pf-product-index\">{{basketItemIndex + 1}}</div>\n\t\t\t</div>\n\t\t\t<div class=\"catalog-pf-product-item--left\">\n\t\t\t\t<div class=\"catalog-pf-product-item-section\">\n\t\t\t\t\t<div class=\"catalog-pf-product-label\">{{localize.CATALOG_FORM_NAME}}</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"catalog-pf-product-item-section\" :id=\"selectorId\" ref=\"selectorWrapper\"></div>\n\t\t\t</div>\n\t\t\t<div class=\"catalog-pf-product-item--right\">\n\t\t\t\t<div class=\"catalog-pf-product-item-section\">\n\t\t\t\t\t<div class=\"catalog-pf-product-label\" style=\"width: 94px\">{{localize.CATALOG_FORM_PRICE}}</div>\n\t\t\t\t\t<div class=\"catalog-pf-product-label\" style=\"width: 72px\">{{localize.CATALOG_FORM_QUANTITY}}</div>\n\t\t\t\t\t<div class=\"catalog-pf-product-label\" style=\"width: 94px\">{{localize.CATALOG_FORM_RESULT}}</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"catalog-pf-product-item-section\">\n\t\t\t\t\t<div class=\"catalog-pf-product-control\" style=\"width: 94px\">\n\t\t\t\t\t\t<div class=\"catalog-pf-product-input-wrapper\">\n\t\t\t\t\t\t\t<input \ttype=\"text\" class=\"catalog-pf-product-input catalog-pf-product-input--align-right\"\n\t\t\t\t\t\t\t\t\tv-bind:class=\"{ 'catalog-pf-product-input--disabled': !editable }\"\n\t\t\t\t\t\t\t\t\t:value=\"basketItem.fields.basePrice\"\n\t\t\t\t\t\t\t\t\t@input=\"onInputPrice\"\n\t\t\t\t\t\t\t\t\t:disabled=\"!editable\">\n\t\t\t\t\t\t\t<div class=\"catalog-pf-product-input-info\" v-html=\"currencySymbol\"></div>\n\t\t\t\t\t\t</div>\t\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"catalog-pf-product-control\" style=\"width: 72px\">\n\t\t\t\t\t\t<div class=\"catalog-pf-product-input-wrapper\">\n\t\t\t\t\t\t\t<input \ttype=\"text\" class=\"catalog-pf-product-input\"\n\t\t\t\t\t\t\t\t\tv-bind:class=\"{ 'catalog-pf-product-input--disabled': !editable }\"\n\t\t\t\t\t\t\t\t\t:value=\"basketItem.fields.quantity\"\n\t\t\t\t\t\t\t\t\t@input=\"onInputQuantity\"\n\t\t\t\t\t\t\t\t\t:disabled=\"!editable\">\n\t\t\t\t\t\t\t<div \tclass=\"catalog-pf-product-input-info catalog-pf-product-input-info--action\" \n\t\t\t\t\t\t\t\t\t@click=\"showPopupMenu($event.target, options.measures, 'measures')\"><span>{{ getMeasureName }}</span></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"catalog-pf-product-control\" style=\"width: 94px\">\n\t\t\t\t\t\t<div class=\"catalog-pf-product-input-wrapper\">\n\t\t\t\t\t\t\t<input disabled type=\"text\" class=\"catalog-pf-product-input catalog-pf-product-input--disabled catalog-pf-product-input--gray catalog-pf-product-input--align-right\" :value=\"basketItem.sum\">\n\t\t\t\t\t\t\t<div class=\"catalog-pf-product-input-info catalog-pf-product-input--disabled catalog-pf-product-input--gray\" v-html=\"currencySymbol\"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div v-if=\"showDiscountBlock\" class=\"catalog-pf-product-item-section\">\n\t\t\t\t\t<div v-if=\"showDiscount\" class=\"catalog-pf-product-link-toggler catalog-pf-product-link-toggler--hide\" @click=\"toggleDiscount('N')\">{{localize.CATALOG_FORM_DISCOUNT_TITLE}}</div>\n\t\t\t\t\t<div v-else class=\"catalog-pf-product-link-toggler catalog-pf-product-link-toggler--show\" @click=\"toggleDiscount('Y')\">{{localize.CATALOG_FORM_DISCOUNT_TITLE}}</div>\n\t\t\t\t</div>\n\t\t\t\t<div v-if=\"showDiscount\" class=\"catalog-pf-product-item-section\">\n\t\t\t\t\t<div class=\"catalog-pf-product-input-wrapper catalog-pf-product-input-wrapper--left\">\n\t\t\t\t\t\t<input class=\"catalog-pf-product-input catalog-pf-product-input--align-right catalog-pf-product-input--right\"\n\t\t\t\t\t\t\t\tv-bind:class=\"{ 'catalog-pf-product-input--disabled': !editable }\"\n\t\t\t\t\t\t\t\tref=\"discountInput\" \n\t\t\t\t\t\t\t\t:value=\"getDiscountInputValue\"\n\t\t\t\t\t\t\t\t@input=\"onInputDiscount\"\n\t\t\t\t\t\t\t\tplaceholder=\"0\"\n\t\t\t\t\t\t\t\t:disabled=\"!editable\">\n\t\t\t\t\t\t<div class=\"catalog-pf-product-input-info catalog-pf-product-input-info--action\" \n\t\t\t\t\t\t\t@click=\"showPopupMenu($event.target, null, 'discount')\">\n\t\t\t\t\t\t\t<span v-html=\"getDiscountSymbol\"></span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t\n\t\t\t\t<div v-if=\"showTaxBlock\" class=\"catalog-pf-product-item-section catalog-pf-product-item-section--dashed\">\n\t\t\t\t\t<div v-if=\"showTaxSelector\" class=\"catalog-pf-product-link-toggler catalog-pf-product-link-toggler--hide\" @click=\"toggleTax('N')\">{{localize.CATALOG_FORM_TAX_TITLE}}</div>\n\t\t\t\t\t<div v-else class=\"catalog-pf-product-link-toggler catalog-pf-product-link-toggler--show\" @click=\"toggleTax('Y')\">{{localize.CATALOG_FORM_TAX_TITLE}}</div>\n\t\t\t\t</div>\n\t\t\t\t<div v-if=\"showTaxSelector && showTaxBlock\" class=\"catalog-pf-product-item-section\">\n\t\t\t\t\t<div \n\t\t\t\t\t\tclass=\"catalog-pf-product-input-wrapper catalog-pf-product-input-wrapper--right\"\n\t\t\t\t\t\t@click=\"showPopupMenu($event.target, getTaxList, 'tax')\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<div class=\"catalog-pf-product-input\">{{basketItem.fields.tax}}%</div>\n\t\t\t\t\t\t<div class=\"catalog-pf-product-input-info catalog-pf-product-input-info--dropdown\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"catalog-pf-product-item-section catalog-pf-product-item-section--dashed\"></div>\n\t\t\t</div>\n\t\t</div>\n\t`\n\t});","import {Vuex} from 'ui.vue.vuex';\nimport {Menu, Popup} from 'main.popup';\nimport {ajax, Event, Loc, Tag, Text, Type} from 'main.core';\nimport {Vue} from \"ui.vue\";\nimport {config} from \"../config\";\n\nVue.component(config.templateProductAddName,\n{\n\t/**\n\t * @emits 'changeRowData' {index: number, fields: object}\n\t * @emits 'refreshBasket'\n\t * @emits 'addItem'\n\t */\n\n\tprops: ['options'],\n\tmethods:\n\t{\n\t\trefreshBasket()\n\t\t{\n\t\t\tthis.$emit('refreshBasket');\n\t\t},\n\t\tchangeBasketItem(item)\n\t\t{\n\t\t\tthis.$emit('changeRowData', item);\n\t\t},\n\t\taddBasketItemForm()\n\t\t{\n\t\t\tthis.$emit('addItem');\n\t\t},\n\t\tgetInternalIndexByProductId(skuId)\n\t\t{\n\t\t\tlet basket = this.$store.getters['productList/getBasket']();\n\t\t\treturn Object\n\t\t\t\t.keys(basket)\n\t\t\t\t.findIndex((inx) =>{\n\t\t\t\t\treturn parseInt(basket[inx].skuId) === parseInt(skuId)\n\t\t\t\t});\n\t\t},\n\t\thandleAddItem(id, params)\n\t\t{\n\t\t\tconst skuType = 4;\n\t\t\tif (Text.toNumber(params.type) === skuType)\n\t\t\t{\n\t\t\t\tajax.runAction(\n\t\t\t\t\t'catalog.productSelector.getSelectedSku',\n\t\t\t\t\t{\n\t\t\t\t\t\tjson: {\n\t\t\t\t\t\t\tvariationId: id,\n\t\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\t\tpriceId: this.options.basePriceId,\n\t\t\t\t\t\t\t\turlBuilder: this.options.urlBuilder,\n\t\t\t\t\t\t\t\tresetSku: true\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t).then(response => this.processResponse(response));\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tajax.runAction(\n\t\t\t\t\t'catalog.productSelector.getProduct',\n\t\t\t\t\t{\n\t\t\t\t\t\tjson: {\n\t\t\t\t\t\t\tproductId: id,\n\t\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\t\tpriceId: this.options.basePriceId,\n\t\t\t\t\t\t\t\turlBuilder: this.options.urlBuilder\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t).then(response => this.processResponse(response));\n\t\t\t}\n\t\t},\n\t\tprocessResponse(response)\n\t\t{\n\t\t\tconst index = this.getInternalIndexByProductId(response.data.skuId);\n\t\t\tif (index < 0)\n\t\t\t{\n\t\t\t\tconst productData = response.data;\n\t\t\t\tconst price = Text.toNumber(productData.fields.PRICE);\n\t\t\t\tproductData.fields = productData.fields || {};\n\t\t\t\tlet newItem = this.$store.getters['productList/getBaseProduct']();\n\t\t\t\tnewItem.fields = Object.assign(newItem.fields, {\n\t\t\t\t\tprice,\n\t\t\t\t\tpriceExclusive: price,\n\t\t\t\t\tbasePrice: price,\n\t\t\t\t\tname: productData.fields.NAME || '',\n\t\t\t\t\tproductId: productData.productId,\n\t\t\t\t\tskuId: productData.skuId,\n\t\t\t\t\tofferId: productData.skuId > 0 ? productData.skuId : productData.productId,\n\t\t\t\t\tmodule: 'catalog',\n\t\t\t\t\tisCustomPrice: Type.isNil(productData.fields.PRICE) ? 'Y' : 'N',\n\t\t\t\t\tdiscountType: this.options.defaultDiscountType,\n\t\t\t\t});\n\n\t\t\t\tdelete(productData.fields);\n\t\t\t\tnewItem = Object.assign(newItem, productData);\n\t\t\t\tnewItem.sum = price;\n\n\t\t\t\tthis.$root.$app.addProduct(newItem);\n\t\t\t}\n\t\t},\n\t\tonUpdateBasketItem(inx, item)\n\t\t{\n\t\t\tthis.$store.dispatch('productList/changeRowData', {\n\t\t\t\tindex : inx,\n\t\t\t\tfields : item\n\t\t\t});\n\t\t\tthis.$store.dispatch('productList/changeProduct', {\n\t\t\t\tindex : inx,\n\t\t\t\tfields : item.fields\n\t\t\t});\n\t\t},\n\t\t/*\n\t\t* By default, basket collection contains a fake|empty item,\n\t\t*  that is deleted when you select items from the catalog.\n\t\t* Also, products can be added to the form and become an empty string,\n\t\t*  while stay a item of basket collection\n\t\t* */\n\t\tremoveEmptyItems()\n\t\t{\n\t\t\tlet basket = this.$store.getters['productList/getBasket']();\n\t\t\tbasket.forEach((item, i)=>{\n\t\t\t\tif(\n\t\t\t\t\tbasket[i].name === ''\n\t\t\t\t\t&& basket[i].price < 1e-10\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tthis.$store.commit('productList/deleteItem', {\n\t\t\t\t\t\tindex: i\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tmodifyBasketItem(params)\n\t\t{\n\t\t\tconst skuId = parseInt(params.id);\n\t\t\tif(skuId > 0)\n\t\t\t{\n\t\t\t\tconst index = this.getInternalIndexByProductId(skuId);\n\t\t\t\tif(index >= 0)\n\t\t\t\t{\n\t\t\t\t\tthis.showDialogProductExists(params);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.removeEmptyItems();\n\t\t\t\t\tthis.handleAddItem(skuId, params);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tshowDialogProductExists(params)\n\t\t{\n\t\t\tthis.popup = new Popup(null, null, {\n\t\t\t\tevents: {\n\t\t\t\t\tonPopupClose: () => {this.popup.destroy()}\n\t\t\t\t},\n\t\t\t\tzIndex: 4000,\n\t\t\t\tautoHide: true,\n\t\t\t\tcloseByEsc: true,\n\t\t\t\tcloseIcon: true,\n\t\t\t\ttitleBar: Loc.getMessage('CATALOG_FORM_BLOCK_PROD_EXIST_DLG_TITLE'),\n\t\t\t\tdraggable: true,\n\t\t\t\tresizable: false,\n\t\t\t\tlightShadow: true,\n\t\t\t\tcacheable: false,\n\t\t\t\toverlay: true,\n\t\t\t\tcontent: Loc.getMessage('CATALOG_FORM_BLOCK_PROD_EXIST_DLG_TEXT').replace('#NAME#', params.name),\n\t\t\t\tbuttons: this.getButtons(params),\n\t\t\t});\n\n\t\t\tthis.popup.show();\n\t\t},\n\t\tgetButtons(product)\n\t\t{\n\t\t\tlet buttons = [];\n\t\t\tlet params = product;\n\t\t\tbuttons.push(\n\t\t\t\tnew BX.UI.SaveButton(\n\t\t\t\t\t{\n\t\t\t\t\t\ttext : Loc.getMessage('CATALOG_FORM_BLOCK_PROD_EXIST_DLG_OK'),\n\t\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\t\tlet productId = parseInt(params.id);\n\t\t\t\t\t\t\tlet inx = this.getInternalIndexByProductId(productId);\n\t\t\t\t\t\t\tif(inx >= 0)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tconst item = this.$store.getters['productList/getBasket']()[inx];\n\t\t\t\t\t\t\t\titem.fields.quantity++;\n\t\t\t\t\t\t\t\titem.calculatedFields.QUANTITY++;\n\t\t\t\t\t\t\t\tthis.onUpdateBasketItem(inx, item);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tthis.popup.destroy();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t);\n\n\t\t\tbuttons.push(\n\t\t\t\tnew BX.UI.CancelButton(\n\t\t\t\t\t{\n\t\t\t\t\t\ttext : Loc.getMessage('CATALOG_FORM_BLOCK_PROD_EXIST_DLG_NO'),\n\t\t\t\t\t\tonclick: () => {this.popup.destroy()}\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t);\n\t\t\treturn buttons;\n\t\t},\n\t\tshowDialogProductSearch()\n\t\t{\n\t\t\tlet funcName = 'addBasketItemFromDialogProductSearch';\n\t\t\twindow[funcName] = params => this.modifyBasketItem(params);\n\n\t\t\tlet popup = new BX.CDialog({\n\t\t\t\tcontent_url: '/bitrix/tools/sale/product_search_dialog.php?'+\n\t\t\t\t\t//todo: 'lang='+this._settings.languageId+\n\t\t\t\t\t//todo: '&LID='+this._settings.siteId+\n\t\t\t\t\t'&caller=order_edit'+\n\t\t\t\t\t'&func_name='+funcName+\n\t\t\t\t\t'&STORE_FROM_ID=0'+\n\t\t\t\t\t'&public_mode=Y',\n\t\t\t\theight: Math.max(500, window.innerHeight-400),\n\t\t\t\twidth: Math.max(800, window.innerWidth-400),\n\t\t\t\tdraggable: true,\n\t\t\t\tresizable: true,\n\t\t\t\tmin_height: 500,\n\t\t\t\tmin_width: 800,\n\t\t\t\tzIndex: 3100\n\t\t\t});\n\n\t\t\tpopup.Show();\n\t\t},\n\t\tsetSetting(event)\n\t\t{\n\t\t\tif (event.target.dataset.settingId === 'taxIncludedOption')\n\t\t\t{\n\t\t\t\tconst value = event.target.checked ? 'Y' : 'N';\n\t\t\t\tthis.$root.$app.changeFormOption('taxIncluded', value);\n\t\t\t}\n\t\t\telse if (event.target.dataset.settingId === 'showDiscountInputOption')\n\t\t\t{\n\t\t\t\tconst value = event.target.checked ? 'Y' : 'N';\n\t\t\t\tthis.$root.$app.changeFormOption('showDiscountBlock', value);\n\t\t\t}\n\t\t\telse if (event.target.dataset.settingId === 'showTaxInputOption')\n\t\t\t{\n\t\t\t\tconst value = event.target.checked ? 'Y' : 'N';\n\t\t\t\tthis.$root.$app.changeFormOption('showTaxBlock', value);\n\t\t\t}\n\t\t},\n\t\tgetSettingItem(item): HTMLElement\n\t\t{\n\t\t\tconst input = Tag.render`\n\t\t\t\t\t<input type=\"checkbox\"  class=\"ui-ctl-element\">\n\t\t\t\t`;\n\t\t\tinput.checked = item.checked;\n\t\t\tinput.dataset.settingId = item.id;\n\n\t\t\tconst setting = Tag.render`\n\t\t\t\t<label class=\"ui-ctl ui-ctl-checkbox ui-ctl-w100\">\n\t\t\t\t\t${input}\n\t\t\t\t\t<div class=\"ui-ctl-label-text\">${item.title}</div>\n\t\t\t\t</label>\n\t\t\t`;\n\n\t\t\tEvent.bind(setting, 'change', this.setSetting.bind(this));\n\n\t\t\treturn setting;\n\t\t},\n\t\tprepareSettingsContent(): HTMLElement\n\t\t{\n\t\t\tconst settings = [\n\t\t\t\t// {\n\t\t\t\t// \tid: 'taxIncludedOption',\n\t\t\t\t// \tchecked: (this.options.taxIncluded === 'Y'),\n\t\t\t\t// \ttitle: this.localize.CATALOG_FORM_ADD_TAX_INCLUDED,\n\t\t\t\t// },\n\t\t\t\t{\n\t\t\t\t\tid: 'showDiscountInputOption',\n\t\t\t\t\tchecked: (this.options.showDiscountBlock !== 'N'),\n\t\t\t\t\ttitle: this.localize.CATALOG_FORM_ADD_SHOW_DISCOUNTS_OPTION,\n\t\t\t\t},\n\t\t\t\t// {\n\t\t\t\t// \tid: 'showTaxInputOption',\n\t\t\t\t// \tchecked: (this.options.showTaxBlock !== 'N'),\n\t\t\t\t// \ttitle: this.localize.CATALOG_FORM_ADD_SHOW_TAXES_OPTION,\n\t\t\t\t// },\n\t\t\t];\n\n\t\t\tconst content = Tag.render`\n\t\t\t\t\t<div class='catalog-pf-product-config-popup'></div>\n\t\t\t\t`;\n\n\t\t\tsettings.forEach(item => {\n\t\t\t\tcontent.append(this.getSettingItem(item));\n\t\t\t});\n\n\t\t\treturn content;\n\t\t},\n\t\tshowConfigPopup(event)\n\t\t{\n\t\t\tif (!this.popupMenu)\n\t\t\t{\n\t\t\t\tthis.popupMenu = new Popup(null, event.target,\n\t\t\t\t\t{\n\t\t\t\t\t\tautoHide: true,\n\t\t\t\t\t\tdraggable: false,\n\t\t\t\t\t\toffsetLeft: 0,\n\t\t\t\t\t\toffsetTop: 0,\n\t\t\t\t\t\tnoAllPaddings: true,\n\t\t\t\t\t\tbindOptions: {forceBindPosition: true},\n\t\t\t\t\t\tcloseByEsc: true,\n\t\t\t\t\t\tcontent: this.prepareSettingsContent()\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tthis.popupMenu.show();\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tlocalize()\n\t\t{\n\t\t\treturn Vue.getFilteredPhrases('CATALOG_');\n\t\t},\n\t\tcountItems()\n\t\t{\n\t\t\treturn this.order.basket.length;\n\t\t},\n\t\t...Vuex.mapState({\n\t\t\tproductList: state => state.productList,\n\t\t})\n\t},\n\ttemplate: `\n\t\t<div class=\"catalog-pf-product-add\">\n\t\t\t<div class=\"catalog-pf-product-add-wrapper\">\n\t\t\t\t<span class=\"catalog-pf-product-add-link\" @click=\"addBasketItemForm\">{{localize.CATALOG_FORM_ADD_PRODUCT}}</span>\n\t\t\t\t<span class=\"catalog-pf-product-add-link catalog-pf-product-add-link--gray\" @click=\"showDialogProductSearch\">{{localize.CATALOG_FORM_ADD_PRODUCT_FROM_CATALOG}}</span>\n\t\t\t</div>\n\t\t\t<div class=\"catalog-pf-product-configure-link\" @click=\"showConfigPopup\">{{localize.CATALOG_FORM_DISCOUNT_EDIT_PAGE_URL_TITLE}}</div>\n\t\t</div>\n\t`\n});","import {config} from '../config';\n\nimport {Vue} from 'ui.vue';\nimport {Vuex} from 'ui.vue.vuex';\nimport \"currency\";\nimport \"ui.layout-form\";\nimport \"ui.forms\";\nimport \"ui.buttons\";\n\nimport \"./row\";\nimport \"./item-add\";\nimport {FormElementPosition} from \"../types/form-element-position\";\n\nVue.component(config.templateName,\n{\n\tprops: ['options'],\n\tcreated()\n\t{\n\t\tBX.ajax.runAction(\n\t\t\t\"catalog.productSelector.getFileInput\",\n\t\t\t{ json: { iblockId: this.options.iblockId } }\n\t\t);\n\t},\n\tmethods:\n\t{\n\t\trefreshBasket()\n\t\t{\n\t\t\tthis.$store.dispatch('productList/refreshBasket');\n\t\t},\n\t\tchangeProduct(item)\n\t\t{\n\t\t\tthis.$root.$app.changeProduct(item);\n\t\t},\n\t\tchangeRowData(item)\n\t\t{\n\t\t\tdelete(item.fields.fields);\n\t\t\tthis.$store.dispatch('productList/changeItem', item);\n\t\t},\n\t\tremoveItem(item)\n\t\t{\n\t\t\tthis.$root.$app.removeProduct(item);\n\t\t},\n\t\taddItem()\n\t\t{\n\t\t\tthis.$root.$app.addProduct();\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tlocalize()\n\t\t{\n\t\t\treturn Vue.getFilteredPhrases('CATALOG_');\n\t\t},\n\t\teditable()\n\t\t{\n\t\t\treturn this.$root.$app.editable;\n\t\t},\n\n\t\tshowTaxResult()\n\t\t{\n\t\t\treturn this.options.showTaxBlock !== 'N';\n\t\t},\n\n\t\tshowResults()\n\t\t{\n\t\t\treturn this.options.showResults !== false;\n\t\t},\n\n\t\tshowButtonsTop()\n\t\t{\n\t\t\treturn this.options.singleProductMode !== true\n\t\t\t\t&& this.editable\n\t\t\t\t&& this.options.buttonsPosition !== FormElementPosition.BOTTOM\n\t\t\t;\n\t\t},\n\n\t\tshowButtonsBottom()\n\t\t{\n\t\t\treturn this.options.singleProductMode !== true\n\t\t\t\t&& this.editable\n\t\t\t\t&& this.options.buttonsPosition === FormElementPosition.BOTTOM\n\t\t\t;\n\t\t},\n\n\t\tshowResultBlock()\n\t\t{\n\t\t\treturn this.showResults || this.enableAddButtons;\n\t\t},\n\n\t\tcountItems()\n\t\t{\n\t\t\treturn this.productList.basket.length;\n\t\t},\n\n\t\ttotalResultLabel()\n\t\t{\n\t\t\treturn this.options.hasOwnProperty('totalResultLabel') && this.options.totalResultLabel\n\t\t\t\t? this.options.totalResultLabel\n\t\t\t\t: this.localize.CATALOG_FORM_TOTAL_RESULT;\n\t\t},\n\n\t\t...Vuex.mapState({\n\t\t\tproductList: state => state.productList,\n\t\t})\n\t},\n\ttemplate: `\n\t<div class=\"catalog-product-form-container\">\n\t\t<${config.templateProductAddName}\n\t\t\t:options=\"options\" \n\t\t\t@refreshBasket=\"refreshBasket\" \n\t\t\t@addItem=\"addItem\"\n\t\t\t@changeRowData=\"changeRowData\"\n\t\t\t@changeProduct=\"changeProduct\" \n\t\t\tv-if=\"showButtonsTop\"\n\t\t/>\n\t\t<div v-for=\"(item, index) in productList.basket\" :key=\"item.selectorId\">\n\t\t\t<${config.templateProductRowName} \n\t\t\t\t:basketItem=\"item\" \n\t\t\t\t:basketItemIndex=\"index\"  \n\t\t\t\t:countItems=\"countItems\"\n\t\t\t\t:options=\"options\"\n\t\t\t\t:editable=\"editable\"\n\t\t\t\t@changeProduct=\"changeProduct\" \n\t\t\t\t@changeRowData=\"changeRowData\" \n\t\t\t\t@removeItem=\"removeItem\" \n\t\t\t\t@refreshBasket=\"refreshBasket\" \n\t\t\t/>\n\t\t</div>\n\t\t<${config.templateProductAddName}\n\t\t\t:options=\"options\" \n\t\t\t@refreshBasket=\"refreshBasket\" \n\t\t\t@addItem=\"addItem\"\n\t\t\t@changeRowData=\"changeRowData\"\n\t\t\t@changeProduct=\"changeProduct\" \n\t\t\tv-if=\"showButtonsBottom\"\n\t\t/>\n\t\t<div class=\"catalog-pf-result-line\"></div>\n\t\t<div class=\"catalog-pf-result-wrapper\" v-if=\"showResultBlock\">\n\t\t\t<table class=\"catalog-pf-result\" v-if=\"showResultBlock\">\n\t\t\t\t<tr v-if=\"showResults\">\n\t\t\t\t\t<td>\n\t\t\t\t\t\t<span class=\"catalog-pf-text\">{{localize.CATALOG_FORM_PRODUCTS_PRICE}}:</span>\n\t\t\t\t\t</td>\n\t\t\t\t\t<td>\n\t\t\t\t\t\t<span v-html=\"productList.total.sum\"\n\t\t\t\t\t\t\t:class=\"productList.total.result !== productList.total.sum ? 'catalog-pf-text catalog-pf-text--line-through' : 'catalog-pf-text'\"\n\t\t\t\t\t\t></span>\n\t\t\t\t\t\t<span class=\"catalog-pf-symbol\" v-html=\"options.currencySymbol\"></span>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\t\t\t\t<tr v-if=\"showResults\">\n\t\t\t\t\t<td class=\"catalog-pf-result-padding-bottom\">\n\t\t\t\t\t\t<span class=\"catalog-pf-text catalog-pf-text--discount\">{{localize.CATALOG_FORM_TOTAL_DISCOUNT}}:</span>\n\t\t\t\t\t</td>\n\t\t\t\t\t<td class=\"catalog-pf-result-padding-bottom\">\n\t\t\t\t\t\t<span class=\"catalog-pf-text catalog-pf-text--discount\" v-html=\"productList.total.discount\"></span>\n\t\t\t\t\t\t<span class=\"catalog-pf-symbol\" v-html=\"options.currencySymbol\"></span>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\t\t\t\t<tr v-if=\"showResults && showTaxResult\">\n\t\t\t\t\t<td class=\"catalog-pf-tax\">\n\t\t\t\t\t\t<span class=\"catalog-pf-text catalog-pf-text--tax\">{{localize.CATALOG_FORM_TAX_TITLE}}:</span>\n\t\t\t\t\t</td>\n\t\t\t\t\t<td class=\"catalog-pf-tax\">\n\t\t\t\t\t\t<span class=\"catalog-pf-text catalog-pf-text--tax\" v-html=\"productList.total.taxSum\"></span>\n\t\t\t\t\t\t<span class=\"catalog-pf-symbol\" v-html=\"options.currencySymbol\"></span>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\t\t\t\t<tr v-if=\"showResults\">\n\t\t\t\t\t<td class=\"catalog-pf-result-padding\">\n\t\t\t\t\t\t<span class=\"catalog-pf-text catalog-pf-text--total catalog-pf-text--border\">{{totalResultLabel}}:</span>\n\t\t\t\t\t</td>\n\t\t\t\t\t<td class=\"catalog-pf-result-padding\">\n\t\t\t\t\t\t<span class=\"catalog-pf-text catalog-pf-text--total\" v-html=\"productList.total.result\"></span>\n\t\t\t\t\t\t<span class=\"catalog-pf-symbol catalog-pf-symbol--total\" v-html=\"options.currencySymbol\"></span>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\t\t\t</table>\n\t\t</div>\n\t</div>\n`,\n});\n","import {Vue} from 'ui.vue';\nimport {VuexBuilder} from 'ui.vue.vuex';\nimport {Type, Text, Tag, ajax, Extension} from 'main.core';\nimport 'ui.notification';\n\nimport {ProductList} from './models/product-list';\nimport {config} from \"./config\";\nimport './templates/form';\nimport './component.css';\nimport {EventEmitter} from \"main.core.events\";\nimport {CurrencyCore} from \"currency.currency-core\";\nimport type {FormOption} from \"./types/form-option\";\nimport {FormElementPosition} from \"./types/form-element-position\";\nimport {DiscountType} from \"catalog.product-calculator\";\n\nexport class ProductForm\n{\n\tconstructor(options: FormOption = {})\n\t{\n\t\tthis.options = this.prepareOptions(options);\n\t\tthis.editable = true;\n\n\t\tthis.wrapper = Tag.render`<div class=\"\"></div>`;\n\n\t\tif (Text.toNumber(options.iblockId) <= 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tProductForm.initStore()\n\t\t\t.then((result) => this.initTemplate(result))\n\t\t\t.catch((error) => ProductForm.showError(error))\n\t\t;\n\t}\n\n\tstatic initStore(): VuexBuilder\n\t{\n\t\tconst builder = new VuexBuilder();\n\n\t\treturn builder\n\t\t\t.addModel(ProductList.create())\n\t\t\t.useNamespace(true)\n\t\t\t.build();\n\t}\n\n\tprepareOptions(options: FormOption = {}): FormOption\n\t{\n\t\tconst settingsCollection = Extension.getSettings('catalog.product-form');\n\t\tconst defaultOptions: FormOption = {\n\t\t\tbasket: [],\n\t\t\tmeasures: [],\n\t\t\tiblockId: null,\n\t\t\tbasePriceId: settingsCollection.get('basePriceId'),\n\t\t\ttaxList: [],\n\t\t\tsingleProductMode: false,\n\t\t\tshowResults: true,\n\t\t\tenableEmptyProductError: true,\n\t\t\tpricePrecision: 2,\n\t\t\tcurrency: settingsCollection.get('currency'),\n\t\t\tcurrencySymbol: settingsCollection.get('currencySymbol'),\n\t\t\ttaxIncluded: settingsCollection.get('taxIncluded'),\n\t\t\tshowDiscountBlock: settingsCollection.get('showDiscountBlock'),\n\t\t\tshowTaxBlock: settingsCollection.get('showTaxBlock'),\n\t\t\tallowedDiscountTypes: [DiscountType.PERCENTAGE, DiscountType.MONETARY],\n\t\t\tnewItemPosition: FormElementPosition.TOP,\n\t\t\tbuttonsPosition: FormElementPosition.TOP,\n\t\t\turlBuilderContext: 'SHOP',\n\t\t\thideUnselectedProperties: false,\n\t\t};\n\n\t\toptions = {...defaultOptions, ...options};\n\t\toptions.showTaxBlock = 'N';\n\n\t\toptions.defaultDiscountType = '';\n\t\tif (Type.isArray(options.allowedDiscountTypes))\n\t\t{\n\t\t\tif (options.allowedDiscountTypes.includes(DiscountType.PERCENTAGE))\n\t\t\t{\n\t\t\t\toptions.defaultDiscountType = DiscountType.PERCENTAGE;\n\t\t\t}\n\t\t\telse if (options.allowedDiscountTypes.includes(DiscountType.MONETARY))\n\t\t\t{\n\t\t\t\toptions.defaultDiscountType = DiscountType.MONETARY;\n\t\t\t}\n\t\t}\n\n\t\treturn options;\n\t}\n\n\tlayout(): HTMLElement\n\t{\n\t\treturn this.wrapper;\n\t}\n\n\tinitTemplate(result): Promise\n\t{\n\t\treturn new Promise((resolve) =>\n\t\t{\n\t\t\tconst context = this;\n\t\t\tthis.store = result.store;\n\n\t\t\tthis.templateEngine = Vue.create({\n\t\t\t\tel: this.wrapper,\n\t\t\t\tstore: this.store,\n\t\t\t\tdata: {\n\t\t\t\t\toptions: this.options\n\t\t\t\t},\n\t\t\t\tcreated()\n\t\t\t\t{\n\t\t\t\t\tthis.$app = context;\n\t\t\t\t},\n\t\t\t\tmounted()\n\t\t\t\t{\n\t\t\t\t\tresolve();\n\t\t\t\t},\n\t\t\t\ttemplate: `<${config.templateName} :options=\"options\"/>`,\n\t\t\t});\n\n\t\t\tif (Type.isStringFilled(this.options.currency))\n\t\t\t{\n\t\t\t\tthis.setData({\n\t\t\t\t\tcurrency: this.options.currency\n\t\t\t\t});\n\t\t\t\tCurrencyCore.loadCurrencyFormat(this.options.currency);\n\t\t\t}\n\n\t\t\tif (this.options.basket.length > 0)\n\t\t\t{\n\t\t\t\tthis.setData(\n\t\t\t\t\t{basket: this.options.basket,},\n\t\t\t\t\t{newItemPosition: FormElementPosition.BOTTOM}\n\t\t\t\t);\n\n\t\t\t\tif (Type.isObject(this.options.totals))\n\t\t\t\t{\n\t\t\t\t\tthis.store.commit('productList/setTotal', this.options.totals);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.store.dispatch('productList/calculateTotal');\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst newItem = this.store.getters['productList/getBaseProduct']();\n\t\t\t\tnewItem.fields.discountType = this.options.defaultDiscountType;\n\t\t\t\tthis.addProduct(newItem);\n\t\t\t}\n\t\t});\n\t}\n\n\taddProduct(item = {}): void\n\t{\n\t\tthis.store.dispatch('productList/addItem', {\n\t\t\titem,\n\t\t\tposition: this.options.newItemPosition\n\t\t})\n\t\t\t.then(() => {\n\t\t\t\tthis.#onBasketChange();\n\t\t\t});\n\t}\n\n\t#onBasketChange(): void\n\t{\n\t\tEventEmitter.emit(this, 'ProductForm:onBasketChange', {\n\t\t\tbasket: this.store.getters['productList/getBasket']()\n\t\t});\n\t}\n\n\tchangeProduct(product): void\n\t{\n\t\tthis.store.dispatch('productList/changeItem', {\n\t\t\tindex: product.index,\n\t\t\tfields: product.fields\n\t\t}).then(() => {\n\t\t\tthis.#onBasketChange();\n\t\t});\n\t}\n\n\tremoveProduct(product): void\n\t{\n\t\tthis.store.dispatch('productList/removeItem', {\n\t\t\tindex: product.index\n\t\t}).then(() => {\n\t\t\tthis.#onBasketChange();\n\t\t});\n\t}\n\n\tsetData(data, option = {}): void\n\t{\n\t\tif (Type.isObject(data.basket))\n\t\t{\n\t\t\tconst formBasket = this.store.getters['productList/getBasket']();\n\t\t\tdata.basket.forEach((fields) => {\n\t\t\t\tif (!Type.isObject(fields))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tconst itemPosition = option.newItemPosition || this.options.newItemPosition;\n\n\t\t\t\tconst innerId = fields.selectorId;\n\t\t\t\tif (Type.isNil(innerId))\n\t\t\t\t{\n\t\t\t\t\tthis.store.dispatch('productList/addItem', {\n\t\t\t\t\t\titem: fields,\n\t\t\t\t\t\tposition: itemPosition\n\t\t\t\t\t});\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst basketIndex = formBasket.findIndex(item => item.selectorId === innerId);\n\t\t\t\tif (basketIndex === -1)\n\t\t\t\t{\n\t\t\t\t\tthis.store.dispatch('productList/addItem', {\n\t\t\t\t\t\titem: fields,\n\t\t\t\t\t\tposition: itemPosition\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.store.dispatch('productList/changeItem', {basketIndex, fields});\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tif (Type.isStringFilled(data.currency))\n\t\t{\n\t\t\tthis.store.dispatch('productList/setCurrency', data.currency);\n\t\t}\n\t\t\n\t\tif (Type.isObject(data.total))\n\t\t{\n\t\t\tthis.store.commit('productList/setTotal', {\n\t\t\t\tsum: data.total.sum,\n\t\t\t\ttaxSum: data.total.taxSum,\n\t\t\t\tdiscount: data.total.discount,\n\t\t\t\tresult: data.total.result,\n\t\t\t})\n\t\t}\n\n\t\tif (Type.isObject(data.errors))\n\t\t{\n\t\t\tthis.store.commit('productList/setErrors', data.errors);\n\t\t}\n\t}\n\n\tchangeFormOption(optionName, value): void\n\t{\n\t\tvalue = (value === 'Y') ? 'Y' : 'N';\n\t\tthis.options[optionName] = value;\n\t\tconst basket = this.store.getters['productList/getBasket']();\n\t\tbasket.forEach((item, index) => {\n\t\t\tif (optionName === 'showDiscountBlock')\n\t\t\t{\n\t\t\t\titem.showDiscountBlock = value;\n\t\t\t}\n\t\t\telse if (optionName === 'showTaxBlock')\n\t\t\t{\n\t\t\t\titem.showTaxBlock = value;\n\t\t\t}\n\t\t\telse if (optionName === 'taxIncluded')\n\t\t\t{\n\t\t\t\titem.fields.taxIncluded = value;\n\t\t\t}\n\n\t\t\tthis.store.dispatch('productList/changeItem', {\n\t\t\t\tindex,\n\t\t\t\tfields: item\n\t\t\t});\n\t\t});\n\n\t\tajax.runAction(\n\t\t\t'catalog.productForm.setConfig',\n\t\t\t{\n\t\t\t\tdata: {\n\t\t\t\t\tconfigName: optionName,\n\t\t\t\t\tvalue: value\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t}\n\n\tgetTotal(): void\n\t{\n\t\tthis.store.dispatch('productList/getTotal');\n\t}\n\n\tsetEditable(value): void\n\t{\n\t\tthis.editable = value;\n\t}\n\n\tstatic showError(error): void\n\t{\n\t\tconsole.error(error);\n\t}\n}"],"names":["FormElementPosition","ProductList","currency","taxIncluded","basket","total","sum","discount","taxSum","result","resetBasket","commit","removeItem","payload","dispatch","state","length","forEach","item","i","index","fields","sort","changeItem","setCurrency","addItem","position","TOP","calculateTotal","basePrice","Text","toNumber","quantity","getBasket","getBaseProduct","Object","assign","BOTTOM","push","unshift","updateItem","Vue","set","clearBasket","deleteItem","splice","setErrors","errors","clearErrors","setTotal","formattedTotal","Type","isStringFilled","key","hasOwnProperty","CurrencyCore","currencyFormat","random","getRandom","offerId","selectorId","innerId","productId","skuId","code","module","price","priceExclusive","name","discountRate","discountInfos","discountType","DiscountType","PERCENTAGE","tax","measureCode","measureName","measureRatio","isCustomPrice","additionalFields","properties","calculatedFields","showDiscount","showTax","skuTree","image","discountSum","detailUrl","encodedFields","VuexBuilderModel","config","freeze","databaseConfig","templateName","templateProductAddName","templateProductRowName","moduleId","component","props","data","currencySymbol","productSelector","imageControlId","basketItem","created","defaultFields","defaultPrice","calculatorFields","options","pricePrecision","calculator","ProductCalculator","currencyId","commonPrecision","setCalculationStrategy","TaxForPriceStrategy","defaultMeasure","id","isArray","measures","map","measure","SYMBOL","CODE","changeProduct","EventEmitter","subscribe","onProductChange","bind","onProductClear","onInputPrice","Runtime","debounce","changePrice","onInputQuantity","changeQuantity","onInputDiscount","changeDiscount","mounted","ProductSelector","prepareSelectorParams","renderTo","$refs","selectorWrapper","updated","isObject","changedFields","basePriceId","PRICE","BASE_PRICE","CURRENCY","emit","rowId","methods","selectorOptions","iblockId","getField","getDefaultSkuTree","fileInputId","morePhotoValues","fileInput","imageValues","DETAIL_PATH","ENABLE_SEARCH","ENABLE_INPUT_DETAIL_LINK","ENABLE_IMAGE_CHANGE_SAVING","ENABLE_EMPTY_PRODUCT_ERROR","enableEmptyProductError","ROW_ID","ENABLE_SKU_SELECTION","editable","HIDE_UNSELECTED_ITEMS","hideUnselectedProperties","URL_BUILDER_CONTEXT","urlBuilderContext","mode","MODE_EDIT","MODE_VIEW","isSimpleModel","NAME","formImage","fileView","preview","input","values","JSON","parse","defaultValue","getCalculator","setCalculatedFields","productFields","isNil","ID","PRODUCT_ID","SKU_ID","MODULE","PRICE_EXCLUSIVE","TAX_INCLUDED","QUANTITY","DISCOUNT_RATE","DISCOUNT_SUM","DISCOUNT_TYPE_ID","SUM","CUSTOMIZED","MEASURE_CODE","MEASURE_NAME","PROPERTIES","changeRowData","$emit","basketItemIndex","event","getData","getId","calculatePrice","setFields","toggleDiscount","value","setTimeout","discountInput","focus","toggleTax","target","replace","newQuantity","parseFloat","lastSymbol","substr","calculateQuantity","newPrice","changeDiscountType","type","MONETARY","calculateDiscountType","discountValue","calculateDiscount","changeTax","taxValue","calculateTax","changeTaxIncluded","calculateTaxIncluded","openDiscountEditor","e","url","window","top","BX","SidePanel","Instance","open","util","add_url_param","allowChangeHistory","preventDefault","returnValue","isEmptyProductName","calculateCorrectionFactor","factoredQuantity","factoredRatio","correctionFactor","Number","isInteger","incrementQuantity","decrementQuantity","showPopupMenu","array","menuItems","setItem","ev","param","innerHTML","popupMenu","close","allowedDiscountTypes","includes","text","onclick","Menu","bindElement","items","show","showProductTooltip","productTooltip","Popup","maxWidth","darkMode","animation","setContent","hideProductTooltip","watch","oldValue","computed","localize","getFilteredPhrases","showDiscountBlock","getDiscountSymbol","getDiscountInputValue","getPriceExclusive","showTaxBlock","getTaxList","showBasePrice","showRemoveIcon","countItems","showTaxSelector","getMeasureName","getMeasureCode","taxList","isTaxIncluded","isNotEnoughQuantity","hasPriceError","template","refreshBasket","changeBasketItem","addBasketItemForm","getInternalIndexByProductId","$store","getters","keys","findIndex","inx","parseInt","handleAddItem","params","skuType","ajax","runAction","json","variationId","priceId","urlBuilder","resetSku","then","response","processResponse","productData","newItem","defaultDiscountType","$root","$app","addProduct","onUpdateBasketItem","removeEmptyItems","modifyBasketItem","showDialogProductExists","popup","events","onPopupClose","destroy","zIndex","autoHide","closeByEsc","closeIcon","titleBar","Loc","getMessage","draggable","resizable","lightShadow","cacheable","overlay","content","buttons","getButtons","product","UI","SaveButton","CancelButton","showDialogProductSearch","funcName","CDialog","content_url","height","Math","max","innerHeight","width","innerWidth","min_height","min_width","Show","setSetting","dataset","settingId","checked","changeFormOption","getSettingItem","Tag","render","setting","title","Event","prepareSettingsContent","settings","CATALOG_FORM_ADD_SHOW_DISCOUNTS_OPTION","append","showConfigPopup","offsetLeft","offsetTop","noAllPaddings","bindOptions","forceBindPosition","order","Vuex","mapState","productList","removeProduct","showTaxResult","showResults","showButtonsTop","singleProductMode","buttonsPosition","showButtonsBottom","showResultBlock","enableAddButtons","totalResultLabel","CATALOG_FORM_TOTAL_RESULT","ProductForm","prepareOptions","wrapper","initStore","initTemplate","catch","error","showError","settingsCollection","Extension","getSettings","defaultOptions","get","newItemPosition","Promise","resolve","context","store","templateEngine","create","el","setData","loadCurrencyFormat","totals","option","formBasket","itemPosition","basketIndex","optionName","configName","builder","VuexBuilder","addModel","useNamespace","build","console"],"mappings":"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"}