{"version":3,"file":"product-form.bundle.js","sources":["../src/types/form-element-position.js","../src/models/product-list.js","../src/config.js","../src/types/form-input-code.js","../src/types/form-error-code.js","../src/types/form-mode.js","../src/templates/fields/quantity.js","../src/templates/fields/price.js","../src/templates/fields/discount.js","../src/templates/fields/tax.js","../src/templates/fields/inline-selector.js","../src/templates/fields/brand.js","../src/types/form-compilation-type.js","../src/templates/row.js","../src/types/form-helpdesk-code.js","../src/templates/elements/panel-compilation.js","../src/templates/elements/panel-buttons.js","../src/templates/form.js","../src/product-form.js"],"sourcesContent":["export class FormElementPosition\n{\n\tstatic TOP: string = 'TOP';\n\tstatic BOTTOM: string = 'BOTTOM';\n}","import {Vue} from 'ui.vue';\nimport {Text, Type} from 'main.core';\nimport {VuexBuilderModel} from 'ui.vue.vuex';\nimport {DiscountType} from \"catalog.product-calculator\";\nimport {FormElementPosition} from \"../types/form-element-position\";\nimport {CurrencyCore} from \"currency.currency-core\";\nimport type {FormScheme} from \"../types/form-scheme\";\nimport type {BasketItem} from \"../types/basket-item\";\n\nexport class ProductList extends VuexBuilderModel\n{\n\t/**\n\t * @inheritDoc\n\t */\n\tgetName(): string\n\t{\n\t\treturn 'productList';\n\t}\n\n\tgetState(): FormScheme\n\t{\n\t\treturn {\n\t\t\tcurrency: '',\n\t\t\ttaxIncluded: 'N',\n\t\t\tbasket: [],\n\t\t\ttotal: {\n\t\t\t\tsum: 0,\n\t\t\t\tdiscount: 0,\n\t\t\t\ttaxSum: 0,\n\t\t\t\tresult: 0,\n\t\t\t},\n\t\t}\n\t}\n\n\tstatic getBaseProduct(): BasketItem\n\t{\n\t\tconst random = Text.getRandom();\n\t\treturn {\n\t\t\tofferId: null,\n\t\t\tselectorId: random,\n\t\t\tfields: {\n\t\t\t\tinnerId: random,\n\t\t\t\tproductId: null,\n\t\t\t\tskuId: null,\n\t\t\t\tcode: null,\n\t\t\t\tmodule: null,\n\t\t\t\tsort: 0,\n\t\t\t\tprice: 0,\n\t\t\t\tbasePrice: 0,\n\t\t\t\tpriceExclusive: 0,\n\t\t\t\tquantity: 1,\n\t\t\t\tname: '',\n\t\t\t\tdiscount: 0,\n\t\t\t\tdiscountRate: 0,\n\t\t\t\tdiscountInfos: [],\n\t\t\t\tdiscountType: DiscountType.PERCENTAGE,\n\t\t\t\ttax: 0,\n\t\t\t\ttaxSum: 0,\n\t\t\t\ttaxIncluded: 'N',\n\t\t\t\tmeasureCode: 0,\n\t\t\t\tmeasureName: '',\n\t\t\t\tmeasureRatio: 1,\n\t\t\t\tisCustomPrice: 'N',\n\t\t\t\tadditionalFields: [],\n\t\t\t\tproperties: [],\n\t\t\t\tbrands: [],\n\t\t\t},\n\t\t\tcalculatedFields: [],\n\t\t\tshowDiscount: 'N',\n\t\t\tshowTax: 'N',\n\t\t\tskuTree: [],\n\t\t\timage: null,\n\t\t\tsum: 0,\n\t\t\tdiscountSum: 0,\n\t\t\tdetailUrl: '',\n\t\t\tencodedFields: null,\n\t\t\terrors: [],\n\t\t};\n\t}\n\n\tgetActions()\n\t{\n\t\treturn {\n\t\t\tresetBasket ({commit})\n\t\t\t{\n\t\t\t\tcommit('clearBasket');\n\t\t\t\tcommit('addItem', {});\n\t\t\t},\n\t\t\tremoveItem({dispatch, commit, state}, payload)\n\t\t\t{\n\t\t\t\tcommit('deleteItem', payload);\n\t\t\t\tif (state.basket.length === 0)\n\t\t\t\t{\n\t\t\t\t\tcommit('addItem', {});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tstate.basket.forEach((item, i) => {\n\t\t\t\t\t\tcommit('updateItem', {\n\t\t\t\t\t\t\tindex: i,\n\t\t\t\t\t\t\tfields: {sort: i}\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tdispatch('calculateTotal');\n\t\t\t},\n\t\t\tchangeItem: ({dispatch, commit}, payload) =>\n\t\t\t{\n\t\t\t\tcommit('updateItem', payload);\n\t\t\t\tdispatch('calculateTotal');\n\t\t\t},\n\t\t\tsetCurrency: ({commit}, payload) =>\n\t\t\t{\n\t\t\t\tconst currency = payload || '';\n\t\t\t\tcommit('setCurrency', currency);\n\t\t\t},\n\t\t\taddItem: ({dispatch, commit}, payload) =>\n\t\t\t{\n\t\t\t\tconst item = payload.item || {fields: {}};\n\t\t\t\tcommit('addItem', {\n\t\t\t\t\titem,\n\t\t\t\t\tposition: payload.position || FormElementPosition.TOP\n\t\t\t\t});\n\t\t\t\tdispatch('calculateTotal');\n\t\t\t},\n\t\t\tcalculateTotal: ({commit, state}) =>\n\t\t\t{\n\t\t\t\tconst total = {\n\t\t\t\t\tsum: 0,\n\t\t\t\t\ttaxSum: 0,\n\t\t\t\t\tdiscount: 0,\n\t\t\t\t\tresult: 0,\n\t\t\t\t};\n\n\t\t\t\tstate.basket.forEach((item) => {\n\t\t\t\t\tconst basePrice = Text.toNumber(item.fields.basePrice || 0);\n\t\t\t\t\tconst quantity = Text.toNumber(item.fields.quantity || 0);\n\t\t\t\t\tconst discount = Text.toNumber(item.fields.discount || 0);\n\t\t\t\t\tconst taxSum = Text.toNumber(item.fields.taxSum || 0);\n\t\t\t\t\ttotal.sum += basePrice * quantity;\n\t\t\t\t\ttotal.result += Text.toNumber(item.sum);\n\t\t\t\t\ttotal.discount += discount * quantity;\n\t\t\t\t\ttotal.taxSum += taxSum * quantity;\n\t\t\t\t});\n\n\t\t\t\ttotal.discount = (total.discount > total.sum) ? total.sum : total.discount;\n\n\t\t\t\tcommit('setTotal', total)\n\t\t\t}\n\t\t}\n\t}\n\n\tgetGetters()\n\t{\n\t\treturn {\n\t\t\tgetBasket: state => (): Array<BasketItem> =>\n\t\t\t{\n\t\t\t\treturn state.basket;\n\t\t\t},\n\t\t\tgetBaseProduct: () => (): BasketItem =>\n\t\t\t{\n\t\t\t\treturn ProductList.getBaseProduct();\n\t\t\t},\n\t\t}\n\t}\n\n\tgetMutations()\n\t{\n\t\treturn {\n\t\t\taddItem: (state, payload) =>\n\t\t\t{\n\t\t\t\tlet item = ProductList.getBaseProduct();\n\n\t\t\t\titem = Object.assign(item, payload.item);\n\t\t\t\tif (payload.position === FormElementPosition.BOTTOM)\n\t\t\t\t{\n\t\t\t\t\tstate.basket.push(item);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tstate.basket.unshift(item);\n\t\t\t\t}\n\n\t\t\t\tstate.basket.forEach((item, index) => {\n\t\t\t\t\titem.fields.sort = index;\n\t\t\t\t});\n\t\t\t},\n\t\t\tupdateItem: (state, payload) =>\n\t\t\t{\n\t\t\t\tif (typeof state.basket[payload.index] === 'undefined')\n\t\t\t\t{\n\t\t\t\t\tVue.set(state.basket, payload.index, ProductList.getBaseProduct());\n\t\t\t\t}\n\n\t\t\t\tstate.basket[payload.index] = Object.assign(\n\t\t\t\t\tstate.basket[payload.index],\n\t\t\t\t\tpayload.fields\n\t\t\t\t);\n\t\t\t},\n\t\t\tclearBasket: (state) =>\n\t\t\t{\n\t\t\t\tstate.basket = [];\n\t\t\t},\n\t\t\tdeleteItem: (state, payload) =>\n\t\t\t{\n\t\t\t\tstate.basket.splice(payload.index, 1);\n\t\t\t\tstate.basket.forEach((item, index) => {\n\t\t\t\t\titem.fields.sort = index;\n\t\t\t\t});\n\t\t\t},\n\t\t\tsetErrors: (state, payload) =>\n\t\t\t{\n\t\t\t\tstate.errors = payload;\n\t\t\t},\n\t\t\tclearErrors: (state) =>\n\t\t\t{\n\t\t\t\tstate.errors = [];\n\t\t\t},\n\t\t\tsetCurrency: (state, payload) =>\n\t\t\t{\n\t\t\t\tstate.currency = payload;\n\t\t\t},\n\t\t\tsetTotal: (state, payload) =>\n\t\t\t{\n\t\t\t\tconst formattedTotal = payload;\n\t\t\t\tif (Type.isStringFilled(state.currency))\n\t\t\t\t{\n\t\t\t\t\tfor (const key in payload)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (payload.hasOwnProperty(key))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tformattedTotal[key] = CurrencyCore.currencyFormat(payload[key], state.currency)\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tstate.total = Object.assign(\n\t\t\t\t\tstate.total,\n\t\t\t\t\tformattedTotal\n\t\t\t\t);\n\t\t\t},\n\t\t}\n\t}\n}","export const config = Object.freeze({\n\tdatabaseConfig: {\n\t\tname: 'catalog.product-form',\n\t},\n\ttemplateName: 'bx-form',\n\ttemplatePanelButtons: 'bx-panel-buttons',\n\ttemplatePanelCompilation: 'bx-panel-compilation',\n\ttemplateRowName: 'bx-form-row',\n\ttemplateFieldInlineSelector: 'bx-field-inline-selector',\n\ttemplateFieldPrice: 'bx-field-price',\n\ttemplateFieldQuantity: 'bx-field-quantity',\n\ttemplateFieldDiscount: 'bx-field-discount',\n\ttemplateFieldTax: 'bx-field-tax',\n\ttemplateFieldBrand: 'bx-field-brand',\n\tmoduleId: 'catalog',\n});","export class FormInputCode\n{\n\tstatic PRODUCT_SELECTOR = 'product-selector';\n\tstatic IMAGE_EDITOR = 'image-editor';\n\tstatic QUANTITY = 'quantity';\n\tstatic PRICE = 'price';\n\tstatic RESULT = 'result';\n\tstatic DISCOUNT = 'discount';\n\tstatic TAX = 'tax';\n\tstatic BRAND = 'brand';\n}","export class FormErrorCode\n{\n\tstatic EMPTY_PRODUCT_SELECTOR = 0;\n\tstatic EMPTY_IMAGE = 1;\n\tstatic EMPTY_QUANTITY = 2;\n\tstatic EMPTY_PRICE = 3;\n\tstatic EMPTY_BRAND = 4;\n}","export class FormMode\n{\n\tstatic REGULAR: string = 'REGULAR';\n\tstatic READ_ONLY: string = 'READ_ONLY';\n\tstatic COMPILATION: string = 'COMPILATION';\n}","import {Menu, MenuItem} from 'main.popup';\nimport {Runtime, Type} from 'main.core';\nimport {Vue} from \"ui.vue\";\nimport {config} from \"../../config\";\nimport type {BaseEvent} from \"main.core.events\";\n\nVue.component(config.templateFieldQuantity,\n{\n\t/**\n\t * @emits 'changeQuantity' {quantity: number}\n\t * @emits 'changeMeasure' {quantity: number, }\n\t */\n\n\tprops: {\n\t\tmeasureCode: Number,\n\t\tmeasureRatio: Number,\n\t\tmeasureName: String,\n\t\tquantity: Number,\n\t\teditable: Boolean,\n\t\thasError: Boolean,\n\t\toptions: Object,\n\t},\n\tcreated()\n\t{\n\t\tthis.onInputQuantityHandler = Runtime.debounce(this.onInputQuantity, 500, this);\n\t},\n\tmethods:\n\t{\n\t\tonInputQuantity(event: BaseEvent): void\n\t\t{\n\t\t\tif (!this.editable)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tevent.target.value = event.target.value.replace(/[^.\\d]/g,'.');\n\t\t\tlet newQuantity = parseFloat(event.target.value);\n\t\t\tlet lastSymbol = event.target.value.substr(-1);\n\n\t\t\tif (lastSymbol === '.')\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.changeQuantity(newQuantity);\n\t\t},\n\t\tcalculateCorrectionFactor(quantity, measureRatio)\n\t\t{\n\t\t\tlet factoredQuantity = quantity;\n\t\t\tlet factoredRatio = measureRatio;\n\t\t\tlet correctionFactor = 1;\n\n\t\t\twhile (!(Number.isInteger(factoredQuantity) && Number.isInteger(factoredRatio)))\n\t\t\t{\n\t\t\t\tcorrectionFactor *= 10;\n\t\t\t\tfactoredQuantity = quantity * correctionFactor;\n\t\t\t\tfactoredRatio = measureRatio * correctionFactor;\n\t\t\t}\n\n\t\t\treturn correctionFactor;\n\t\t},\n\t\tincrementValue()\n\t\t{\n\t\t\tif (!this.editable)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tlet correctionFactor = this.calculateCorrectionFactor(this.quantity, this.measureRatio);\n\t\t\tconst quantity = (this.quantity * correctionFactor + this.measureRatio * correctionFactor) / correctionFactor;\n\t\t\tthis.changeQuantity(quantity);\n\t\t},\n\t\tdecrementValue()\n\t\t{\n\t\t\tif (this.quantity > this.measureRatio && this.editable)\n\t\t\t{\n\t\t\t\tlet correctionFactor = this.calculateCorrectionFactor(this.quantity, this.measureRatio);\n\t\t\t\tconst quantity = (this.quantity * correctionFactor - this.measureRatio * correctionFactor) / correctionFactor;\n\t\t\t\tthis.changeQuantity(quantity);\n\t\t\t}\n\t\t},\n\t\tchangeQuantity(value: number)\n\t\t{\n\t\t\tthis.$emit('changeQuantity', value);\n\t\t},\n\t\tshowPopupMenu(target: HTMLElement)\n\t\t{\n\t\t\tif (!this.editable || !Type.isArray(this.options.measures))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst menuItems = [];\n\t\t\tthis.options.measures.forEach((item) => {\n\t\t\t\tmenuItems.push({\n\t\t\t\t\ttext: item.SYMBOL,\n\t\t\t\t\titem: item,\n\t\t\t\t\tonclick: this.changeMeasure,\n\t\t\t\t})\n\t\t\t});\n\n\n\t\t\tif (menuItems.length > 0)\n\t\t\t{\n\t\t\t\tthis.popupMenu = new Menu({\n\t\t\t\t\tbindElement: target,\n\t\t\t\t\titems: menuItems\n\t\t\t\t});\n\n\t\t\t\tthis.popupMenu.show();\n\t\t\t}\n\t\t},\n\t\tchangeMeasure(event: BaseEvent, params: MenuItem)\n\t\t{\n\t\t\tthis.$emit('changeMeasure', {\n\t\t\t\tcode: param.options.item.CODE,\n\t\t\t\tname: param.options.item.SYMBOL,\n\t\t\t});\n\n\t\t\tif (this.popupMenu)\n\t\t\t{\n\t\t\t\tthis.popupMenu.close();\n\t\t\t}\n\t\t},\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"catalog-pf-product-input-wrapper\" v-bind:class=\"{ 'ui-ctl-danger': hasError }\">\n\t\t\t<input \t\n\t\t\t\ttype=\"text\" class=\"catalog-pf-product-input\"\n\t\t\t\tv-bind:class=\"{ 'catalog-pf-product-input--disabled': !editable }\"\n\t\t\t\t:value=\"quantity\"\n\t\t\t\t@input=\"onInputQuantity\"\n\t\t\t\t:disabled=\"!editable\"\n\t\t\t>\n\t\t\t<div \n\t\t\t\tclass=\"catalog-pf-product-input-info catalog-pf-product-input-info--action\" \n\t\t\t\t@click=\"showPopupMenu($event.target)\"\n\t\t\t>\n\t\t\t\t<span>{{ measureName }}</span>\n\t\t\t</div>\n\t\t</div>\n\t`\n});","import {Runtime} from 'main.core';\nimport {Vue} from \"ui.vue\";\nimport {config} from \"../../config\";\nimport type {BaseEvent} from \"main.core.events\";\n\nVue.component(config.templateFieldPrice,\n{\n\t/**\n\t * @emits 'changePrice' {price: number}\n\t */\n\n\tprops: {\n\t\tbasePrice: Number,\n\t\teditable: Boolean,\n\t\thasError: Boolean,\n\t\toptions: Object,\n\t},\n\tcreated()\n\t{\n\t\tthis.onInputPriceHandler = Runtime.debounce(this.onInputPrice, 500, this);\n\t},\n\tmethods:\n\t{\n\t\tonInputPrice(event: BaseEvent): void\n\t\t{\n\t\t\tif (!this.editable)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tevent.target.value = event.target.value.replace(/[^.,\\d]/g,'');\n\t\t\tif (event.target.value === '')\n\t\t\t{\n\t\t\t\tevent.target.value = 0;\n\t\t\t}\n\t\t\tlet lastSymbol = event.target.value.substr(-1);\n\t\t\tif (lastSymbol === ',')\n\t\t\t{\n\t\t\t\tevent.target.value = event.target.value.replace(',', \".\");\n\t\t\t}\n\t\t\tlet newPrice = parseFloat(event.target.value);\n\t\t\tif (newPrice < 0|| lastSymbol === '.' || lastSymbol === ',')\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.$emit('changePrice', newPrice);\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tlocalize()\n\t\t{\n\t\t\treturn Vue.getFilteredPhrases('CATALOG_');\n\t\t},\n\t\tcurrencySymbol()\n\t\t{\n\t\t\treturn this.options.currencySymbol || '';\n\t\t},\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"catalog-pf-product-input-wrapper\" v-bind:class=\"{ 'ui-ctl-danger': hasError }\">\n\t\t\t<input \ttype=\"text\" class=\"catalog-pf-product-input catalog-pf-product-input--align-right\"\n\t\t\t\t\tv-bind:class=\"{ 'catalog-pf-product-input--disabled': !editable }\"\n\t\t\t\t\t:value=\"basePrice\"\n\t\t\t\t\t@input=\"onInputPriceHandler\"\n\t\t\t\t\t:disabled=\"!editable\">\n\t\t\t<div class=\"catalog-pf-product-input-info\" v-html=\"currencySymbol\"></div>\n\t\t</div>\n\t`\n});","import {Menu} from 'main.popup';\nimport { Runtime, Text, Type} from 'main.core';\nimport {Vue} from \"ui.vue\";\nimport {config} from \"../../config\";\nimport {DiscountType} from \"catalog.product-calculator\";\n\nVue.component(config.templateFieldDiscount,\n{\n\t/**\n\t * @emits 'changeDiscountType' {type: Y|N}\n\t * @emits 'changeDiscount' {discountValue: number}\n\t */\n\n\tprops: {\n\t\teditable: Boolean,\n\t\toptions: Object,\n\t\tdiscount: Number,\n\t\tdiscountType: Number,\n\t\tdiscountRate: Number,\n\t},\n\tcreated()\n\t{\n\t\tthis.onInputDiscount = Runtime.debounce(this.onChangeDiscount, 500, this);\n\t\tthis.currencySymbol = this.options.currencySymbol;\n\t},\n\tmethods:\n\t{\n\t\tonChangeType(event, params)\n\t\t{\n\t\t\tif (!this.editable)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tlet type = (Text.toNumber(params?.options?.type) === DiscountType.MONETARY) ?  DiscountType.MONETARY : DiscountType.PERCENTAGE;\n\t\t\tthis.$emit('changeDiscountType', type);\n\n\t\t\tif (this.popupMenu)\n\t\t\t{\n\t\t\t\tthis.popupMenu.close();\n\t\t\t}\n\t\t},\n\t\tonChangeDiscount(event)\n\t\t{\n\t\t\tlet discountValue = Text.toNumber(event.target.value) || 0;\n\t\t\tif (discountValue === Text.toNumber(this.discount) || !this.editable)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.$emit('changeDiscount', discountValue);\n\t\t},\n\t\tshowPopupMenu(target)\n\t\t{\n\t\t\tif (!this.editable || !Type.isArray(this.options.allowedDiscountTypes))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst menuItems = [];\n\t\t\tif (this.options.allowedDiscountTypes.includes(DiscountType.PERCENTAGE))\n\t\t\t{\n\t\t\t\tmenuItems.push({\n\t\t\t\t\ttext: '%',\n\t\t\t\t\tonclick: this.onChangeType,\n\t\t\t\t\ttype: DiscountType.PERCENTAGE,\n\t\t\t\t})\n\t\t\t}\n\n\t\t\tif (this.options.allowedDiscountTypes.includes(DiscountType.MONETARY))\n\t\t\t{\n\t\t\t\tmenuItems.push({\n\t\t\t\t\ttext: this.currencySymbol,\n\t\t\t\t\tonclick: this.onChangeType,\n\t\t\t\t\ttype: DiscountType.MONETARY,\n\t\t\t\t})\n\t\t\t}\n\n\t\t\tif (menuItems.length > 0)\n\t\t\t{\n\t\t\t\tthis.popupMenu = new Menu({\n\t\t\t\t\tbindElement: target,\n\t\t\t\t\titems: menuItems\n\t\t\t\t});\n\n\t\t\t\tthis.popupMenu.show();\n\t\t\t}\n\t\t},\n\t},\n\tcomputed: {\n\t\tgetDiscountInputValue()\n\t\t{\n\t\t\tif (Text.toNumber(this.discountType) === DiscountType.PERCENTAGE)\n\t\t\t{\n\t\t\t\treturn Text.toNumber(this.discountRate);\n\t\t\t}\n\n\t\t\treturn Text.toNumber(this.discount);\n\t\t},\n\t\tgetDiscountSymbol()\n\t\t{\n\t\t\treturn Text.toNumber(this.discountType) === DiscountType.PERCENTAGE ? '%' : this.currencySymbol;\n\t\t},\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"catalog-pf-product-input-wrapper catalog-pf-product-input-wrapper--left\">\n\t\t\t<input class=\"catalog-pf-product-input catalog-pf-product-input--align-right catalog-pf-product-input--right\"\n\t\t\t\t\tv-bind:class=\"{ 'catalog-pf-product-input--disabled': !editable }\"\n\t\t\t\t\tref=\"discountInput\" \n\t\t\t\t\t:value=\"getDiscountInputValue\"\n\t\t\t\t\t@input=\"onInputDiscount\"\n\t\t\t\t\tplaceholder=\"0\"\n\t\t\t\t\t:disabled=\"!editable\">\n\t\t\t<div class=\"catalog-pf-product-input-info catalog-pf-product-input-info--action\" \n\t\t\t\t@click=\"showPopupMenu\">\n\t\t\t\t<span v-html=\"getDiscountSymbol\"></span>\n\t\t\t</div>\n\t\t</div>\n\t`\n});","import {Menu} from 'main.popup';\nimport {Text, Type} from 'main.core';\nimport {Vue} from \"ui.vue\";\nimport {config} from \"../../config\";\n\nVue.component(config.templateFieldTax,\n{\n\t/**\n\t * @emits 'changeTax' {taxValue: number}\n\t */\n\n\tprops: {\n\t\ttaxId: Number,\n\t\teditable: Boolean,\n\t\toptions: Object,\n\t},\n\tdata()\n\t{\n\t\treturn {\n\t\t\ttaxValue: this.getTaxList()[this.taxId] || 0\n\t\t};\n\t},\n\tmethods:\n\t{\n\t\tonChangeValue(event, params)\n\t\t{\n\t\t\tconst taxValue = Text.toNumber(params?.options?.item);\n\t\t\tif (taxValue === Text.toNumber(this.taxValue) || !this.editable)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.$emit('changeTax', {\n\t\t\t\ttaxValue,\n\t\t\t\ttaxId: params?.options?.id\n\t\t\t});\n\n\t\t\tif (this.popupMenu)\n\t\t\t{\n\t\t\t\tthis.popupMenu.close();\n\t\t\t}\n\t\t},\n\t\tgetTaxList()\n\t\t{\n\t\t\treturn Type.isArray(this.options.taxList) ? this.options.taxList : [];\n\t\t},\n\t\tshowPopupMenu(target)\n\t\t{\n\t\t\tif (!this.editable || !Type.isArray(this.options.taxList))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst menuItems = [];\n\t\t\tthis.options.taxList.forEach((item, id) => {\n\t\t\t\tmenuItems.push({\n\t\t\t\t\tid,\n\t\t\t\t\ttext: item + '%',\n\t\t\t\t\titem: item,\n\t\t\t\t\tonclick: this.onChangeValue,\n\t\t\t\t})\n\t\t\t});\n\n\n\t\t\tif (menuItems.length > 0)\n\t\t\t{\n\t\t\t\tthis.popupMenu = new Menu({\n\t\t\t\t\tbindElement: target,\n\t\t\t\t\titems: menuItems\n\t\t\t\t});\n\n\t\t\t\tthis.popupMenu.show();\n\t\t\t}\n\t\t},\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"catalog-pf-product-input-wrapper catalog-pf-product-input-wrapper--right\" @click=\"showPopupMenu\">\n\t\t\t<div class=\"catalog-pf-product-input\">{{this.taxValue}}%</div>\n\t\t\t<div class=\"catalog-pf-product-input-info catalog-pf-product-input-info--dropdown\"></div>\n\t\t</div>\n\t`\n});","import {Text, Type} from 'main.core';\nimport {Vue} from \"ui.vue\";\nimport {config} from \"../../config\";\nimport {FormInputCode} from \"../../types/form-input-code\";\nimport {ProductSelector} from \"catalog.product-selector\";\nimport {EventEmitter} from \"main.core.events\";\nimport type {BaseEvent} from \"main.core.events\";\n\nVue.component(config.templateFieldInlineSelector,\n{\n\t/**\n\t * @emits 'onProductChange' {fields: object}\n\t */\n\n\tprops: {\n\t\teditable: Boolean,\n\t\toptions: Object,\n\t\tbasketItem: Object,\n\t},\n\tdata()\n\t{\n\t\treturn {\n\t\t\tcurrencySymbol: null,\n\t\t\tproductSelector: null,\n\t\t\timageControlId: null,\n\t\t\tselectorId: this.basketItem.selectorId,\n\t\t};\n\t},\n\tcreated()\n\t{\n\t\tEventEmitter.subscribe('BX.Catalog.ProductSelector:onChange', this.onProductChange.bind(this));\n\t\tEventEmitter.subscribe('BX.Catalog.ProductSelector:onClear', this.onProductClear.bind(this))\n\t},\n\tmounted()\n\t{\n\t\tthis.productSelector = new ProductSelector(this.selectorId, this.prepareSelectorParams());\n\t\tthis.productSelector.renderTo(this.$refs.selectorWrapper);\n\t},\n\tmethods:\n\t{\n\t\tprepareSelectorParams(): Object\n\t\t{\n\t\t\tconst selectorOptions = {\n\t\t\t\tiblockId: this.options.iblockId,\n\t\t\t\tbasePriceId: this.options.basePriceId,\n\t\t\t\tproductId: this.getField('productId'),\n\t\t\t\tskuId: this.getField('skuId'),\n\t\t\t\tskuTree: this.getDefaultSkuTree(),\n\t\t\t\tfileInputId: '',\n\t\t\t\tmorePhotoValues: [],\n\t\t\t\tfileInput: '',\n\t\t\t\tconfig: {\n\t\t\t\t\tDETAIL_PATH: this.basketItem.detailUrl || '',\n\t\t\t\t\tENABLE_SEARCH: true,\n\t\t\t\t\tENABLE_INPUT_DETAIL_LINK: true,\n\t\t\t\t\tENABLE_IMAGE_CHANGE_SAVING: true,\n\t\t\t\t\tENABLE_EMPTY_PRODUCT_ERROR: this.options.enableEmptyProductError || this.isRequiredField(FormInputCode.PRODUCT_SELECTOR),\n\t\t\t\t\tENABLE_EMPTY_IMAGES_ERROR: this.isRequiredField(FormInputCode.IMAGE_EDITOR),\n\t\t\t\t\tROW_ID: this.selectorId,\n\t\t\t\t\tENABLE_SKU_SELECTION: this.editable,\n\t\t\t\t\tHIDE_UNSELECTED_ITEMS: this.options.hideUnselectedProperties,\n\t\t\t\t\tURL_BUILDER_CONTEXT: this.options.urlBuilderContext\n\t\t\t\t},\n\t\t\t\tmode: this.editable ? ProductSelector.MODE_EDIT : ProductSelector.MODE_VIEW,\n\t\t\t\tisSimpleModel:\n\t\t\t\t\tthis.getField('name', '') !== ''\n\t\t\t\t\t&& this.getField('productId') <= 0\n\t\t\t\t\t&& this.getField('skuId') <= 0\n\t\t\t\t,\n\t\t\t\tfields: {\n\t\t\t\t\tNAME: this.getField('name') || '',\n\t\t\t\t\tPRICE: this.getField('basePrice') || 0,\n\t\t\t\t\tCURRENCY: this.options.currency,\n\t\t\t\t},\n\t\t\t};\n\n\t\t\tconst formImage = this.basketItem.image;\n\t\t\tif (Type.isObject(formImage))\n\t\t\t{\n\t\t\t\tselectorOptions.fileView = formImage.preview;\n\t\t\t\tselectorOptions.fileInput = formImage.input;\n\t\t\t\tselectorOptions.fileInputId = formImage.id;\n\t\t\t\tselectorOptions.morePhotoValues = formImage.values;\n\t\t\t}\n\n\t\t\treturn selectorOptions;\n\t\t},\n\t\tisRequiredField(code: string): boolean\n\t\t{\n\t\t\treturn Type.isArray(this.options.requiredFields) && this.options.requiredFields.includes(code);\n\t\t},\n\t\tgetDefaultSkuTree(): Object\n\t\t{\n\t\t\tlet skuTree = this.basketItem.skuTree || {};\n\t\t\tif (Type.isStringFilled(skuTree))\n\t\t\t{\n\t\t\t\tskuTree = JSON.parse(skuTree);\n\t\t\t}\n\n\t\t\treturn skuTree;\n\t\t},\n\t\tgetField(name, defaultValue = null)\n\t\t{\n\t\t\treturn this.basketItem.fields[name] || defaultValue;\n\t\t},\n\t\tonProductChange(event: BaseEvent)\n\t\t{\n\t\t\tconst data = event.getData();\n\t\t\tif (Type.isStringFilled(data.selectorId) && data.selectorId === this.productSelector.getId())\n\t\t\t{\n\t\t\t\tconst basePrice = Text.toNumber(data.fields.PRICE);\n\n\t\t\t\tlet fields = {\n\t\t\t\t\tBASE_PRICE: basePrice,\n\t\t\t\t\tMODULE: 'catalog',\n\t\t\t\t\tNAME: data.fields.NAME,\n\t\t\t\t\tID: data.fields.ID,\n\t\t\t\t\tPRODUCT_ID: data.fields.PRODUCT_ID,\n\t\t\t\t\tSKU_ID: data.fields.SKU_ID,\n\t\t\t\t\tPROPERTIES: data.fields.PROPERTIES,\n\t\t\t\t\tURL_BUILDER_CONTEXT: this.options.urlBuilderContext,\n\t\t\t\t\tCUSTOMIZED: Type.isNil(data.fields.PRICE) ? 'Y' : 'N',\n\t\t\t\t\tMEASURE_CODE: data.fields.MEASURE_CODE,\n\t\t\t\t\tMEASURE_NAME: data.fields.MEASURE_NAME,\n\t\t\t\t};\n\n\t\t\t\tthis.$emit('onProductChange', fields);\n\t\t\t}\n\t\t},\n\t\tonProductClear(event: BaseEvent)\n\t\t{\n\t\t\tconst data = event.getData();\n\n\t\t\tif (Type.isStringFilled(data.selectorId) && data.selectorId === this.productSelector.getId())\n\t\t\t{\n\t\t\t\tthis.$emit('onProductClear');\n\t\t\t}\n\t\t},\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"catalog-pf-product-item-section\" :id=\"selectorId\" ref=\"selectorWrapper\"></div>\n\t`\n});","import {ajax, Cache, Tag, Type} from 'main.core';\nimport {Vue} from \"ui.vue\";\nimport {config} from \"../../config\";\nimport type {BaseEvent} from \"main.core.events\";\nimport {Dialog, TagSelector} from \"ui.entity-selector\";\n\nVue.component(config.templateFieldBrand,\n{\n\t/**\n\t * @emits 'changeBrand' {values: Array<any>}\n\t */\n\n\tprops: {\n\t\tbrands: [Array, String],\n\t\toptions: Object,\n\t\teditable: Boolean,\n\t\thasError: Boolean,\n\t\tselectorId: String,\n\t},\n\tdata()\n\t{\n\t\treturn {\n\t\t\tcache: new Cache.MemoryCache(),\n\t\t}\n\t},\n\tcreated()\n\t{\n\t\tthis.selector = new TagSelector({\n\t\t\tid: this.selectorId,\n\t\t\tdialogOptions: {\n\t\t\t\tid: this.selectorId,\n\t\t\t\tcontext: 'CATALOG_BRANDS',\n\t\t\t\t// enableSearch: true,\n\t\t\t\tpreselectedItems: this.getPreselectedBrands(),\n\t\t\t\tevents: {\n\t\t\t\t\t'Item:onSelect': this.onBrandChange.bind(this),\n\t\t\t\t\t'Item:onDeselect': this.onBrandChange.bind(this),\n\t\t\t\t\t'Search:onItemCreateAsync': this.createBrand.bind(this)\n\t\t\t\t},\n\t\t\t\tsearchTabOptions: {\n\t\t\t\t\tstub: true,\n\t\t\t\t\tstubOptions: {\n\t\t\t\t\t\ttitle: Tag.message`${'CATALOG_FORM_BRAND_SELECTOR_IS_EMPTY_TITLE'}`,\n\t\t\t\t\t\tsubtitle: Tag.message`${'CATALOG_FORM_BRAND_SELECTOR_IS_EMPTY_SUBTITLE'}`,\n\t\t\t\t\t\tarrow: true\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tsearchOptions: {\n\t\t\t\t\tallowCreateItem: true\n\t\t\t\t},\n\t\t\t\tentities: [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'brand',\n\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\tiblockId: this.options.iblockId,\n\t\t\t\t\t\t},\n\t\t\t\t\t\tdynamicSearch: true,\n\t\t\t\t\t\tdynamicLoad: true\n\t\t\t\t\t},\n\t\t\t\t]\n\t\t\t},\n\t\t});\n\t},\n\tmounted()\n\t{\n\t\tthis.selector.renderTo(this.$refs.brandSelectorWrapper);\n\t},\n\tmethods:\n\t{\n\t\tgetPreselectedBrands()\n\t\t{\n\t\t\tif (!Type.isArray(this.brands) || this.brands.length === 0)\n\t\t\t{\n\t\t\t\treturn [];\n\t\t\t}\n\n\t\t\treturn this.brands.map((item) => {\n\t\t\t\treturn ['brand', item]\n\t\t\t});\n\t\t},\n\t\tonBrandChange(event: BaseEvent)\n\t\t{\n\t\t\tconst items = event.getTarget().getSelectedItems();\n\t\t\tconst resultValues = [];\n\t\t\tif (Type.isArray(items))\n\t\t\t{\n\t\t\t\titems.forEach((item) => {\n\t\t\t\t\tresultValues.push(item.getId());\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis.$emit('changeBrand', resultValues);\n\t\t},\n\t\tcreateBrand(event): Promise\n\t\t{\n\t\t\tconst {searchQuery} = event.getData();\n\t\t\tconst iblockId = this.options.iblockId;\n\n\t\t\treturn new Promise(\n\t\t\t\t(resolve, reject) => {\n\t\t\t\t\tconst dialog: Dialog = event.getTarget();\n\t\t\t\t\tconst fields = {\n\t\t\t\t\t\tname: searchQuery.getQuery(),\n\t\t\t\t\t\tiblockId,\n\t\t\t\t\t};\n\n\t\t\t\t\tdialog.showLoader();\n\t\t\t\t\tajax.runAction(\n\t\t\t\t\t\t'catalog.productForm.createBrand',\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\tfields\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t)\n\t\t\t\t\t\t.then(response => {\n\t\t\t\t\t\t\tdialog.hideLoader();\n\t\t\t\t\t\t\tconst item = dialog.addItem({\n\t\t\t\t\t\t\t\tid: response.data.id,\n\t\t\t\t\t\t\t\tentityId: 'brand',\n\t\t\t\t\t\t\t\ttitle: searchQuery.getQuery(),\n\t\t\t\t\t\t\t\ttabs: dialog.getRecentTab().getId(),\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\tif (item)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\titem.select();\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tdialog.hide();\n\t\t\t\t\t\t\tresolve();\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.catch(() => reject());\n\t\t\t\t});\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tlocalize()\n\t\t{\n\t\t\treturn Vue.getFilteredPhrases('CATALOG_');\n\t\t},\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"catalog-pf-product-control ui-ctl-w100\" v-bind:class=\"{ 'ui-ctl-danger': hasError }\">\n\t\t\t<div class=\"catalog-pf-product-input-wrapper\" ref=\"brandSelectorWrapper\" :id=\"selectorId\"></div>\n\t\t</div>\n\t`\n});","export class FormCompilationType\n{\n\tstatic REGULAR: string = 'REGULAR';\n\tstatic FACEBOOK: string = 'FACEBOOK';\n}","import {config} from \"../config\";\nimport {Vue} from \"ui.vue\";\nimport {Text, Type, Runtime} from \"main.core\";\n\nimport \"catalog.product-selector\";\nimport \"ui.common\";\nimport \"ui.alerts\";\nimport {EventEmitter} from 'main.core.events';\nimport {ProductCalculator, DiscountType, TaxForPriceStrategy} from \"catalog.product-calculator\";\nimport {FormInputCode} from \"../types/form-input-code\";\nimport {FormErrorCode} from \"../types/form-error-code\";\nimport {FormMode} from \"../types/form-mode\";\nimport \"./fields/quantity\";\nimport \"./fields/price\";\nimport \"./fields/discount\";\nimport \"./fields/tax\";\nimport \"./fields/inline-selector\";\nimport \"./fields/brand\";\nimport type {BasketItemScheme} from \"../types/basket-item-scheme\";\nimport {FormOption} from \"../types/form-option\";\n\nVue.component(config.templateRowName,\n\t{\n\t\t/**\n\t\t * @emits 'changeProduct' {index: number, fields: object}\n\t\t * @emits 'changeRowData' {index: number, fields: object}\n\t\t * @emits 'refreshBasket'\n\t\t * @emits 'removeItem' {index: number}\n\t\t */\n\n\t\tprops: {\n\t\t\tbasketItem: Object,\n\t\t\tbasketItemIndex: Number,\n\t\t\tcountItems: Number,\n\t\t\toptions: Object,\n\t\t\tmode: String,\n\t\t},\n\t\tdata()\n\t\t{\n\t\t\treturn {\n\t\t\t\tcurrencySymbol: null,\n\t\t\t\tproductSelector: null,\n\t\t\t\timageControlId: null,\n\t\t\t\tselectorId: this.basketItem.selectorId,\n\t\t\t\tblocks: {\n\t\t\t\t\tproductSelector: FormInputCode.PRODUCT_SELECTOR,\n\t\t\t\t\tquantity: FormInputCode.QUANTITY,\n\t\t\t\t\tprice: FormInputCode.PRICE,\n\t\t\t\t\tresult: FormInputCode.RESULT,\n\t\t\t\t\tdiscount: FormInputCode.DISCOUNT,\n\t\t\t\t\ttax: FormInputCode.TAX,\n\t\t\t\t\tbrand: FormInputCode.BRAND,\n\t\t\t\t},\n\t\t\t\terrorCodes: {\n\t\t\t\t\temptyProductSelector: FormErrorCode.EMPTY_PRODUCT_SELECTOR,\n\t\t\t\t\temptyImage: FormErrorCode.EMPTY_IMAGE,\n\t\t\t\t\temptyQuantity: FormErrorCode.EMPTY_QUANTITY,\n\t\t\t\t\temptyPrice: FormErrorCode.EMPTY_PRICE,\n\t\t\t\t\temptyBrand: FormErrorCode.EMPTY_BRAND,\n\t\t\t\t}\n\t\t\t};\n\t\t},\n\t\tcreated()\n\t\t{\n\t\t\tconst defaultFields = this.basketItem.fields;\n\t\t\tconst defaultPrice = Text.toNumber(defaultFields.price);\n\t\t\tconst basePrice = defaultFields.basePrice || defaultPrice;\n\t\t\tconst calculatorFields = {\n\t\t\t\t'QUANTITY': Text.toNumber(defaultFields.quantity),\n\t\t\t\t'BASE_PRICE': basePrice,\n\t\t\t\t'PRICE': defaultPrice,\n\t\t\t\t'PRICE_NETTO': basePrice,\n\t\t\t\t'PRICE_BRUTTO': defaultPrice,\n\t\t\t\t'PRICE_EXCLUSIVE': this.basketItem.fields.priceExclusive || defaultPrice,\n\t\t\t\t'DISCOUNT_TYPE_ID': Text.toNumber(defaultFields.discountType) || DiscountType.PERCENTAGE,\n\t\t\t\t'DISCOUNT_RATE': Text.toNumber(defaultFields.discountRate),\n\t\t\t\t'DISCOUNT_SUM': Text.toNumber(defaultFields.discount),\n\t\t\t\t'TAX_INCLUDED': defaultFields.taxIncluded || this.options.taxIncluded,\n\t\t\t\t'TAX_RATE': defaultFields.tax || 0,\n\t\t\t\t'CUSTOMIZED': defaultFields.isCustomPrice || 'N',\n\t\t\t};\n\n\t\t\tconst pricePrecision = this.options.pricePrecision || 2;\n\t\t\tthis.calculator = new ProductCalculator(calculatorFields, {\n\t\t\t\tcurrencyId: this.options.currency,\n\t\t\t\tpricePrecision: pricePrecision,\n\t\t\t\tcommonPrecision: pricePrecision,\n\t\t\t});\n\n\t\t\tthis.calculator.setCalculationStrategy(new TaxForPriceStrategy(this.calculator));\n\n\t\t\tthis.currencySymbol = this.options.currencySymbol;\n\t\t\tthis.defaultMeasure = {\n\t\t\t\tname: '',\n\t\t\t\tid: null,\n\t\t\t};\n\n\t\t\tif (Type.isArray(this.options.measures))\n\t\t\t{\n\t\t\t\tthis.options.measures.map((measure) => {\n\t\t\t\t\tif (measure['IS_DEFAULT'] === 'Y')\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.defaultMeasure.name = measure.SYMBOL;\n\t\t\t\t\t\tthis.defaultMeasure.code = measure.CODE;\n\n\t\t\t\t\t\tif (!defaultFields.measureName && !defaultFields.measureCode)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.changeProduct({\n\t\t\t\t\t\t\t\tmeasureCode: this.defaultMeasure.code,\n\t\t\t\t\t\t\t\tmeasureName: this.defaultMeasure.name\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis.onInputDiscount = Runtime.debounce(this.changeDiscount, 500, this);\n\t\t},\n\t\tupdated()\n\t\t{\n\t\t\tif (Type.isObject(this.basketItem.calculatedFields))\n\t\t\t{\n\t\t\t\tconst changedFields = this.basketItem.calculatedFields;\n\t\t\t\tchangedFields['PRICES'] = {};\n\t\t\t\tchangedFields['PRICES'][this.options.basePriceId] = {\n\t\t\t\t\tPRICE: changedFields.BASE_PRICE || changedFields.PRICE,\n\t\t\t\t\tCURRENCY: this.options.currency,\n\t\t\t\t};\n\n\t\t\t\tchangedFields['MEASURE_CODE'] = this.basketItem.fields.measureCode;\n\t\t\t\tEventEmitter.emit(this, 'ProductList::onChangeFields', {\n\t\t\t\t\trowId: this.selectorId,\n\t\t\t\t\tfields: changedFields\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\tmethods:\n\t\t\t{\n\t\t\t\tgetField(name, defaultValue = null)\n\t\t\t\t{\n\t\t\t\t\treturn this.basketItem.fields[name] || defaultValue;\n\t\t\t\t},\n\t\t\t\tgetCalculator(): ProductCalculator\n\t\t\t\t{\n\t\t\t\t\treturn this.calculator;\n\t\t\t\t},\n\t\t\t\tsetCalculatedFields(fields: {}): void\n\t\t\t\t{\n\t\t\t\t\tconst map = {\n\t\t\t\t\t\tcalculatedFields: fields,\n\t\t\t\t\t};\n\t\t\t\t\tconst productFields = this.basketItem.fields;\n\n\t\t\t\t\tif (!Type.isNil(fields.ID))\n\t\t\t\t\t{\n\t\t\t\t\t\tmap.offerId = Text.toNumber(fields.ID);\n\t\t\t\t\t\tproductFields.productId = Text.toNumber(fields.PRODUCT_ID);\n\t\t\t\t\t\tproductFields.skuId = Text.toNumber(fields.SKU_ID);\n\t\t\t\t\t}\n\t\t\t\t\tif (!Type.isNil(fields.NAME))\n\t\t\t\t\t{\n\t\t\t\t\t\tproductFields.name = fields.NAME;\n\t\t\t\t\t}\n\t\t\t\t\tif (!Type.isNil(fields.MODULE))\n\t\t\t\t\t{\n\t\t\t\t\t\tproductFields.module = fields.MODULE;\n\t\t\t\t\t}\n\t\t\t\t\tif (Text.toNumber(fields.BASE_PRICE) >= 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tproductFields.basePrice = Text.toNumber(fields.BASE_PRICE);\n\t\t\t\t\t}\n\t\t\t\t\tif (Text.toNumber(fields.PRICE) >= 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tproductFields.price = Text.toNumber(fields.PRICE);\n\t\t\t\t\t\tproductFields.priceExclusive = Text.toNumber(fields.PRICE_EXCLUSIVE);\n\t\t\t\t\t}\n\t\t\t\t\tif (Text.toNumber(fields.PRICE_EXCLUSIVE) >= 0 && fields.TAX_INCLUDED === 'Y')\n\t\t\t\t\t{\n\t\t\t\t\t\tproductFields.priceExclusive = Text.toNumber(fields.PRICE);\n\t\t\t\t\t}\n\t\t\t\t\tif (Text.toNumber(fields.QUANTITY) >= 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tproductFields.quantity = Text.toNumber(fields.QUANTITY);\n\t\t\t\t\t}\n\t\t\t\t\tif (!Type.isNil(fields.DISCOUNT_RATE))\n\t\t\t\t\t{\n\t\t\t\t\t\tproductFields.discountRate = Text.toNumber(fields.DISCOUNT_RATE);\n\t\t\t\t\t}\n\t\t\t\t\tif (!Type.isNil(fields.DISCOUNT_SUM))\n\t\t\t\t\t{\n\t\t\t\t\t\tproductFields.discount = Text.toNumber(fields.DISCOUNT_SUM);\n\t\t\t\t\t}\n\t\t\t\t\tif (!Type.isNil(fields.DISCOUNT_TYPE_ID))\n\t\t\t\t\t{\n\t\t\t\t\t\tproductFields.discountType = fields.DISCOUNT_TYPE_ID;\n\t\t\t\t\t}\n\t\t\t\t\tif (Text.toNumber(fields.SUM) >= 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tmap.sum = Text.toNumber(fields.SUM);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!Type.isNil(fields.CUSTOMIZED))\n\t\t\t\t\t{\n\t\t\t\t\t\tproductFields.isCustomPrice = fields.CUSTOMIZED;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!Type.isNil(fields.MEASURE_CODE))\n\t\t\t\t\t{\n\t\t\t\t\t\tproductFields.measureCode = fields.MEASURE_CODE;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!Type.isNil(fields.MEASURE_NAME))\n\t\t\t\t\t{\n\t\t\t\t\t\tproductFields.measureName = fields.MEASURE_NAME;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!Type.isNil(fields.PROPERTIES))\n\t\t\t\t\t{\n\t\t\t\t\t\tproductFields.properties = fields.PROPERTIES;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!Type.isNil(fields.BRANDS))\n\t\t\t\t\t{\n\t\t\t\t\t\tproductFields.brands = fields.BRANDS;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!Type.isNil(fields.TAX_ID))\n\t\t\t\t\t{\n\t\t\t\t\t\tproductFields.taxId = fields.TAX_ID;\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.changeRowData(map);\n\t\t\t\t\tthis.changeProduct(productFields);\n\t\t\t\t},\n\t\t\t\tchangeRowData(fields: {}): void\n\t\t\t\t{\n\t\t\t\t\tthis.$emit('changeRowData', {\n\t\t\t\t\t\tindex: this.basketItemIndex,\n\t\t\t\t\t\tfields\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tchangeProduct(fields: {}): void\n\t\t\t\t{\n\t\t\t\t\tfields = Object.assign(this.basketItem.fields, fields);\n\t\t\t\t\tthis.$emit('changeProduct', {\n\t\t\t\t\t\tindex: this.basketItemIndex,\n\t\t\t\t\t\tfields\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tonProductChange(fields: {})\n\t\t\t\t{\n\t\t\t\t\tfields = Object.assign(\n\t\t\t\t\t\tthis.getCalculator().calculatePrice(fields.BASE_PRICE),\n\t\t\t\t\t\tfields\n\t\t\t\t\t);\n\n\t\t\t\t\tthis.getCalculator().setFields(fields);\n\t\t\t\t\tthis.setCalculatedFields(fields);\n\t\t\t\t},\n\t\t\t\tonProductClear()\n\t\t\t\t{\n\t\t\t\t\tconst fields = this.getCalculator().calculatePrice(0);\n\n\t\t\t\t\tfields.BASE_PRICE = 0;\n\t\t\t\t\tfields.NAME = '';\n\t\t\t\t\tfields.ID = 0;\n\t\t\t\t\tfields.PRODUCT_ID = 0;\n\t\t\t\t\tfields.SKU_ID = 0;\n\t\t\t\t\tfields.MODULE = '';\n\n\t\t\t\t\tthis.getCalculator().setFields(fields);\n\t\t\t\t\tthis.setCalculatedFields(fields);\n\t\t\t\t},\n\t\t\t\ttoggleDiscount(value: string): void\n\t\t\t\t{\n\t\t\t\t\tif (this.isReadOnly)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.changeRowData(\n\t\t\t\t\t\t{showDiscount: value}\n\t\t\t\t\t);\n\n\t\t\t\t\tif (value === 'Y')\n\t\t\t\t\t{\n\t\t\t\t\t\tsetTimeout(\n\t\t\t\t\t\t\t() => this.$refs?.discountWrapper?.$refs?.discountInput?.focus()\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\ttoggleTax(value: string): void\n\t\t\t\t{\n\t\t\t\t\tthis.changeRowData(\n\t\t\t\t\t\t{showTax: value}\n\t\t\t\t\t);\n\t\t\t\t},\n\t\t\t\tchangeBrand(values): void\n\t\t\t\t{\n\t\t\t\t\tconst fields = this.getCalculator().getFields();\n\t\t\t\t\tfields.BRANDS = Type.isArray(values) ? values : [];\n\t\t\t\t\tthis.setCalculatedFields(fields);\n\t\t\t\t},\n\t\t\t\tprocessFields(fields: {}): void\n\t\t\t\t{\n\t\t\t\t\tthis.setCalculatedFields(fields);\n\t\t\t\t\tthis.getCalculator().setFields(fields);\n\t\t\t\t},\n\t\t\t\tchangeQuantity(quantity: number): void\n\t\t\t\t{\n\t\t\t\t\tthis.processFields(\n\t\t\t\t\t\tthis.getCalculator().calculateQuantity(quantity)\n\t\t\t\t\t);\n\t\t\t\t},\n\t\t\t\tchangeMeasure(measure: {}): void\n\t\t\t\t{\n\t\t\t\t\tconst productFields = this.basketItem.fields;\n\t\t\t\t\tproductFields['measureCode'] = measure.code;\n\t\t\t\t\tproductFields['measureName'] = measure.name;\n\t\t\t\t\tthis.changeProduct(productFields);\n\t\t\t\t},\n\t\t\t\tchangePrice(price: number): void\n\t\t\t\t{\n\t\t\t\t\tconst calculatedFields = this.getCalculator().calculatePrice(price);\n\t\t\t\t\tcalculatedFields.BASE_PRICE = price;\n\t\t\t\t\tthis.processFields(calculatedFields);\n\t\t\t\t},\n\t\t\t\tchangeDiscountType(discountType: string)\n\t\t\t\t{\n\t\t\t\t\tconst type = (Text.toNumber(discountType) === DiscountType.MONETARY) ?  DiscountType.MONETARY : DiscountType.PERCENTAGE;\n\t\t\t\t\tthis.processFields(\n\t\t\t\t\t\tthis.getCalculator().calculateDiscountType(type)\n\t\t\t\t\t);\n\t\t\t\t},\n\t\t\t\tchangeDiscount(discount: number)\n\t\t\t\t{\n\t\t\t\t\tthis.processFields(\n\t\t\t\t\t\tthis.getCalculator().calculateDiscount(discount)\n\t\t\t\t\t);\n\t\t\t\t},\n\t\t\t\tchangeTax(fields)\n\t\t\t\t{\n\t\t\t\t\tconst calculatedFields = this.getCalculator().calculateTax(fields.taxValue);\n\t\t\t\t\tcalculatedFields.TAX_ID = fields.taxId;\n\t\t\t\t\tthis.processFields(calculatedFields)\n\t\t\t\t},\n\t\t\t\tchangeTaxIncluded(taxIncluded)\n\t\t\t\t{\n\t\t\t\t\tif (taxIncluded === this.basketItem.taxIncluded || !this.isEditableField(this.blocks.tax))\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst calculatedFields = this.getCalculator().calculateTaxIncluded(taxIncluded);\n\t\t\t\t\tthis.getCalculator().setFields(calculatedFields);\n\t\t\t\t\tthis.setCalculatedFields(calculatedFields);\n\t\t\t\t},\n\t\t\t\tremoveItem()\n\t\t\t\t{\n\t\t\t\t\tthis.$emit('removeItem', {\n\t\t\t\t\t\tindex: this.basketItemIndex\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tisRequiredField(code: string): boolean\n\t\t\t\t{\n\t\t\t\t\treturn Type.isArray(this.options.requiredFields) && this.options.requiredFields.includes(code);\n\t\t\t\t},\n\t\t\t\tisVisibleBlock(code): boolean\n\t\t\t\t{\n\t\t\t\t\treturn Type.isArray(this.options.visibleBlocks) && this.options.visibleBlocks.includes(code)\n\t\t\t\t},\n\t\t\t\thasError(code)\n\t\t\t\t{\n\t\t\t\t\tif (this.basketItem.errors.length === 0)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst filteredErrors = this.basketItem.errors.filter((error) => {\n\t\t\t\t\t\treturn error.code === code\n\t\t\t\t\t});\n\n\t\t\t\t\treturn filteredErrors.length > 0;\n\t\t\t\t},\n\t\t\t\tisEditableField(code)\n\t\t\t\t{\n\t\t\t\t\treturn this.options?.editableFields.includes(code);\n\t\t\t\t},\n\t\t\t},\n\t\twatch:\n\t\t\t{\n\t\t\t\ttaxIncluded(value, oldValue){\n\t\t\t\t\tif (value !== oldValue)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.changeTaxIncluded(value);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\tcomputed:\n\t\t\t{\n\t\t\t\tlocalize()\n\t\t\t\t{\n\t\t\t\t\treturn Vue.getFilteredPhrases('CATALOG_FORM_');\n\t\t\t\t},\n\t\t\t\tshowDiscount(): boolean\n\t\t\t\t{\n\t\t\t\t\treturn this.showDiscountBlock && this.basketItem.showDiscount === 'Y';\n\t\t\t\t},\n\t\t\t\tgetBrandsSelectorId(): string\n\t\t\t\t{\n\t\t\t\t\treturn this.basketItem.selectorId + '_brands';\n\t\t\t\t},\n\t\t\t\tgetPriceExclusive(): ?number\n\t\t\t\t{\n\t\t\t\t\treturn this.basketItem.fields.priceExclusive || this.basketItem.fields.price\n\t\t\t\t},\n\t\t\t\tshowDiscountBlock(): boolean\n\t\t\t\t{\n\t\t\t\t\treturn this.options.showDiscountBlock === 'Y'\n\t\t\t\t\t\t&& this.isVisibleBlock(this.blocks.discount)\n\t\t\t\t\t\t&& !this.isReadOnly\n\t\t\t\t\t;\n\t\t\t\t},\n\t\t\t\tshowTaxBlock(): boolean\n\t\t\t\t{\n\t\t\t\t\treturn this.options.showTaxBlock === 'Y'\n\t\t\t\t\t\t&& this.getTaxList.length > 0\n\t\t\t\t\t\t&& this.isVisibleBlock(this.blocks.tax)\n\t\t\t\t\t\t&& !this.isReadOnly\n\t\t\t\t\t;\n\t\t\t\t},\n\t\t\t\tshowRemoveIcon(): boolean\n\t\t\t\t{\n\t\t\t\t\tif (this.isReadOnly)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (this.countItems > 1)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn this.basketItem.offerId !== null;\n\t\t\t\t},\n\t\t\t\tshowTaxSelector(): boolean\n\t\t\t\t{\n\t\t\t\t\treturn this.basketItem.showTax === 'Y';\n\t\t\t\t},\n\t\t\t\tshowBasePrice(): boolean\n\t\t\t\t{\n\t\t\t\t\treturn this.basketItem.fields.discount > 0\n\t\t\t\t\t\t|| (Text.toNumber(this.basketItem.fields.price) !== Text.toNumber(this.basketItem.fields.basePrice))\n\t\t\t\t\t;\n\t\t\t\t},\n\t\t\t\tgetMeasureName(): string\n\t\t\t\t{\n\t\t\t\t\treturn this.basketItem.fields.measureName || this.defaultMeasure.name;\n\t\t\t\t},\n\t\t\t\tgetMeasureCode(): string\n\t\t\t\t{\n\t\t\t\t\treturn this.basketItem.fields.measureCode || this.defaultMeasure.code;\n\t\t\t\t},\n\t\t\t\tgetTaxList(): []\n\t\t\t\t{\n\t\t\t\t\treturn Type.isArray(this.options.taxList) ? this.options.taxList : [];\n\t\t\t\t},\n\t\t\t\ttaxIncluded(): string\n\t\t\t\t{\n\t\t\t\t\treturn this.basketItem.fields.taxIncluded;\n\t\t\t\t},\n\t\t\t\tisTaxIncluded(): boolean\n\t\t\t\t{\n\t\t\t\t\treturn this.taxIncluded === 'Y';\n\t\t\t\t},\n\t\t\t\tisReadOnly(): boolean\n\t\t\t\t{\n\t\t\t\t\treturn this.mode === FormMode.READ_ONLY\n\t\t\t\t},\n\t\t\t},\n\t\t// language=Vue\n\t\ttemplate: `\n\t\t<div class=\"catalog-pf-product-item\" v-bind:class=\"{ 'catalog-pf-product-item--borderless': !isReadOnly && basketItemIndex === 0 }\">\n\t\t\t<div class=\"catalog-pf-product-item--remove\" @click=\"removeItem\" v-if=\"showRemoveIcon\"></div>\n\t\t\t<div class=\"catalog-pf-product-item--num\">\n\t\t\t\t<div class=\"catalog-pf-product-index\">{{basketItemIndex + 1}}</div>\n\t\t\t</div>\n\t\t\t<div class=\"catalog-pf-product-item--left\">\n\t\t\t\t<div v-if=\"isVisibleBlock(blocks.productSelector)\">\n\t\t\t\t\t<div class=\"catalog-pf-product-item-section\">\n\t\t\t\t\t\t<div class=\"catalog-pf-product-label\">{{localize.CATALOG_FORM_NAME}}</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<${config.templateFieldInlineSelector} \n\t\t\t\t\t\t:basketItem=\"basketItem\" \n\t\t\t\t\t\t:options=\"options\"\n\t\t\t\t\t\t:editable=\"isEditableField(blocks.productSelector)\"\n\t\t\t\t\t\t@onProductChange=\"onProductChange\" \n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<div v-if=\"isVisibleBlock(blocks.brand)\" class=\"catalog-pf-product-input-brand-wrapper\">\n\t\t\t\t\t<div class=\"catalog-pf-product-item-section\">\n\t\t\t\t\t\t<div class=\"catalog-pf-product-label\">{{localize.CATALOG_FORM_BRAND_TITLE}}</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<${config.templateFieldBrand} \n\t\t\t\t\t\t:brands=\"basketItem.fields.brands\"\n\t\t\t\t\t\t:selectorId=\"getBrandsSelectorId\"\n\t\t\t\t\t\t:hasError=\"hasError(errorCodes.emptyBrand)\"\n\t\t\t\t\t\t:options=\"options\"\n\t\t\t\t\t\t:editable=\"isEditableField(blocks.brand)\"\n\t\t\t\t\t\t@changeBrand=\"changeBrand\" \n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t\n\t\t\t</div>\n\t\t\t<div class=\"catalog-pf-product-item--right\">\n\t\t\t\t<div class=\"catalog-pf-product-item-section\">\n\t\t\t\t\t<div v-if=\"isVisibleBlock(blocks.price)\" class=\"catalog-pf-product-label\" style=\"width: 94px\">\n\t\t\t\t\t\t{{localize.CATALOG_FORM_PRICE}}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div v-if=\"isVisibleBlock(blocks.quantity)\" class=\"catalog-pf-product-label\" style=\"width: 72px\">\n\t\t\t\t\t\t{{localize.CATALOG_FORM_QUANTITY}}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div v-if=\"isVisibleBlock(blocks.result)\" class=\"catalog-pf-product-label\" style=\"width: 94px\">\n\t\t\t\t\t\t{{localize.CATALOG_FORM_RESULT}}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"catalog-pf-product-item-section\">\n\t\t\t\t\n\t\t\t\t\t<div v-if=\"isVisibleBlock(blocks.price)\" class=\"catalog-pf-product-control\" style=\"width: 94px\">\n\t\t\t\t\t\t<${config.templateFieldPrice} \n\t\t\t\t\t\t\t:basePrice=\"basketItem.fields.basePrice\"\n\t\t\t\t\t\t\t:options=\"options\"\n\t\t\t\t\t\t\t:editable=\"isEditableField(blocks.price)\"\n\t\t\t\t\t\t\t:hasError=\"hasError(errorCodes.emptyPrice)\"\n\t\t\t\t\t\t\t@changePrice=\"changePrice\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t\t\n\t\t\t\t\t<div v-if=\"isVisibleBlock(blocks.quantity)\" class=\"catalog-pf-product-control\" style=\"width: 72px\">\n\t\t\t\t\t\t<${config.templateFieldQuantity} \n\t\t\t\t\t\t\t:quantity=\"basketItem.fields.quantity\"\n\t\t\t\t\t\t\t:measureCode=\"getMeasureCode\"\n\t\t\t\t\t\t\t:measureRatio=\"basketItem.fields.measureRatio\"\n\t\t\t\t\t\t\t:measureName=\"getMeasureName\"\n\t\t\t\t\t\t\t:hasError=\"hasError(errorCodes.emptyQuantity)\"\n\t\t\t\t\t\t\t:options=\"options\"\n\t\t\t\t\t\t\t:editable=\"isEditableField(blocks.quantity)\"\n\t\t\t\t\t\t\t@changeQuantity=\"changeQuantity\" \n\t\t\t\t\t\t\t@changeMeasure=\"changeMeasure\" \n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t\t\n\t\t\t\t\t<div v-if=\"isVisibleBlock(blocks.result)\" class=\"catalog-pf-product-control\" style=\"width: 94px\">\n\t\t\t\t\t\t<div class=\"catalog-pf-product-input-wrapper\">\n\t\t\t\t\t\t\t<input disabled type=\"text\" class=\"catalog-pf-product-input catalog-pf-product-input--disabled catalog-pf-product-input--gray catalog-pf-product-input--align-right\" :value=\"basketItem.sum\">\n\t\t\t\t\t\t\t<div class=\"catalog-pf-product-input-info catalog-pf-product-input--disabled catalog-pf-product-input--gray\" v-html=\"currencySymbol\"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div v-if=\"hasError(errorCodes.emptyQuantity)\" class=\"catalog-pf-product-item-section\">\n\t\t\t\t\t<div class=\"catalog-product-error\">{{localize.CATALOG_FORM_ERROR_EMPTY_QUANTITY}}</div>\n\t\t\t\t</div>\n\t\t\t\t<div v-if=\"hasError(errorCodes.emptyPrice)\" class=\"catalog-pf-product-item-section\">\n\t\t\t\t\t<div class=\"catalog-product-error\">{{localize.CATALOG_FORM_ERROR_EMPTY_PRICE}}</div>\n\t\t\t\t</div>\n\t\t\t\t<div v-if=\"showDiscountBlock\" class=\"catalog-pf-product-item-section\">\n\t\t\t\t\t<div v-if=\"showDiscount\" class=\"catalog-pf-product-link-toggler catalog-pf-product-link-toggler--hide\" @click=\"toggleDiscount('N')\">{{localize.CATALOG_FORM_DISCOUNT_TITLE}}</div>\n\t\t\t\t\t<div v-else class=\"catalog-pf-product-link-toggler catalog-pf-product-link-toggler--show\" @click=\"toggleDiscount('Y')\">{{localize.CATALOG_FORM_DISCOUNT_TITLE}}</div>\n\t\t\t\t</div>\n\t\t\t\t\n\t\t\t\t<div v-if=\"showDiscount\" class=\"catalog-pf-product-item-section\">\n\t\t\t\t\t<${config.templateFieldDiscount} \n\t\t\t\t\t\t:discount=\"basketItem.fields.discount\"\n\t\t\t\t\t\t:discountType=\"basketItem.fields.discountType\"\n\t\t\t\t\t\t:discountRate=\"basketItem.fields.discountRate\"\n\t\t\t\t\t\t:options=\"options\"\n\t\t\t\t\t\t:editable=\"isEditableField(blocks.discount)\"\n\t\t\t\t\t\tref=\"discountWrapper\"\n\t\t\t\t\t\t@changeDiscount=\"changeDiscount\" \n\t\t\t\t\t\t@changeDiscountType=\"changeDiscountType\" \n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t\n\t\t\t\t<div v-if=\"showTaxBlock\" class=\"catalog-pf-product-item-section catalog-pf-product-item-section--dashed\">\n\t\t\t\t\t<div v-if=\"showTaxSelector\" class=\"catalog-pf-product-link-toggler catalog-pf-product-link-toggler--hide\" @click=\"toggleTax('N')\">{{localize.CATALOG_FORM_TAX_TITLE}}</div>\n\t\t\t\t\t<div v-else class=\"catalog-pf-product-link-toggler catalog-pf-product-link-toggler--show\" @click=\"toggleTax('Y')\">{{localize.CATALOG_FORM_TAX_TITLE}}</div>\n\t\t\t\t</div>\n\t\t\t\t<div v-if=\"showTaxSelector && showTaxBlock\" class=\"catalog-pf-product-item-section\">\n\t\t\t\t\t<${config.templateFieldTax} \n\t\t\t\t\t\t:taxId=\"basketItem.fields.taxId\"\n\t\t\t\t\t\t:options=\"options\"\n\t\t\t\t\t\t:editable=\"isEditableField(blocks.tax)\"\n\t\t\t\t\t\t@changeProduct=\"changeProduct\" \n\t\t\t\t\t/>\n\t\t\t\t</div>\t\t\t\t\n\t\t\t\t<div class=\"catalog-pf-product-item-section catalog-pf-product-item-section--dashed\"></div>\n\t\t\t</div>\n\t\t</div>\n\t`\n\t});","export class FormHelpdeskCode\n{\n\tstatic COMPILATION_FACEBOOK: number = 13856526;\n\tstatic COMMON_COMPILATION: number = 13841876;\n}","import {Vuex} from 'ui.vue.vuex';\nimport {Vue} from 'ui.vue';\nimport {config} from '../../config';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\nimport {Popup} from 'main.popup';\nimport {FormMode} from '../../types/form-mode';\nimport {FormCompilationType} from '../../types/form-compilation-type';\nimport {FormHelpdeskCode} from '../../types/form-helpdesk-code';\nimport {ajax, Event, Tag, Dom, Loc, Type} from 'main.core';\nimport {Loader} from 'main.loader';\nimport {Label, LabelColor} from 'ui.label';\nimport {MessageCard} from 'ui.messagecard';\nimport 'ui.vue.components.hint';\nimport 'ui.notification';\nimport 'ui.info-helper';\nimport 'main.qrcode';\nimport 'clipboard';\nimport 'helper';\n\nVue.component(config.templatePanelCompilation,\n{\n\tprops: {\n\t\tcompilationOptions: Object,\n\t\tmode: String,\n\t},\n\tcreated()\n\t{\n\t\tEventEmitter.subscribe('BX.Catalog.ProductSelector:onChange', this.destroyPopup.bind(this));\n\t\tEventEmitter.subscribe('BX.Catalog.ProductSelector:onClear', this.destroyPopup.bind(this));\n\t\tthis.newLabel = new Label({\n\t\t\ttext: this.localize.CATALOG_FORM_COMPILATION_PRODUCT_NEW_LABEL,\n\t\t\tcolor: LabelColor.PRIMARY,\n\t\t\tfill: true\n\t\t});\n\n\t\tconst moreMessageButton = Tag.render`\n\t\t\t<a class=\"ui-btn ui-btn-primary\">${this.localize.CATALOG_FORM_COMPILATION_INFO_BUTTON_MORE}</a>\n\t\t`;\n\n\t\tEvent.bind(moreMessageButton, 'click', this.openHelpDesk);\n\n\t\tlet header = '';\n\t\tlet description = '';\n\t\tif (this.isFacebookForm())\n\t\t{\n\t\t\theader = this.localize.CATALOG_FORM_COMPILATION_INFO_MESSAGE_TITLE_FACEBOOK;\n\t\t\tdescription = Tag.render`\n\t\t\t\t<p>${this.localize.CATALOG_FORM_COMPILATION_INFO_MESSAGE_BODY_FACEBOOK_FIRST_BLOCK}</p>\n\t\t\t\t<p>${this.localize.CATALOG_FORM_COMPILATION_INFO_MESSAGE_BODY_FACEBOOK_SECOND_BLOCK}</p>\n\t\t\t`;\n\t\t}\n\t\telse\n\t\t{\n\t\t\theader = this.localize.CATALOG_FORM_COMPILATION_INFO_MESSAGE_TITLE;\n\t\t\tdescription = this.localize.CATALOG_FORM_COMPILATION_INFO_MESSAGE_BODY_MARKETING;\n\t\t}\n\n\t\tthis.message = new MessageCard({\n\t\t\tid: 'compilationInfo',\n\t\t\theader,\n\t\t\tdescription,\n\t\t\tangle: false,\n\t\t\thidden: true,\n\t\t\tactionElements: [moreMessageButton]\n\t\t});\n\n\t\tEventEmitter.subscribe(this.message, 'onClose', this.hideMessage);\n\t},\n\tmounted()\n\t{\n\t\tthis.$refs.label.appendChild(this.newLabel.render());\n\t\tthis.$refs.message.appendChild(this.message.getLayout());\n\t\tif (!this.compilationOptions.hiddenInfoMessage)\n\t\t{\n\t\t\tthis.showMessage();\n\t\t}\n\t},\n\tdata()\n\t{\n\t\treturn {\n\t\t\tcompilationLink: null,\n\t\t}\n\t},\n\tmethods:\n\t{\n\t\tisFacebookForm()\n\t\t{\n\t\t\treturn this.compilationOptions.type === FormCompilationType.FACEBOOK;\n\t\t},\n\t\topenHelpDesk()\n\t\t{\n\t\t\tthis.helpdeskCode =\n\t\t\t\tthis.isFacebookForm()\n\t\t\t\t\t? FormHelpdeskCode.COMPILATION_FACEBOOK\n\t\t\t\t\t: FormHelpdeskCode.COMMON_COMPILATION\n\t\t\t;\n\n\t\t\ttop.BX.Helper.show('redirect=detail&code=' + this.helpdeskCode);\n\t\t},\n\t\tshowPopup(event: BaseEvent): void\n\t\t{\n\t\t\tif (this.compilationOptions.disabledSwitcher)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.isFacebookForm())\n\t\t\t{\n\t\t\t\tthis.openHelpDesk();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.popup instanceof Popup)\n\t\t\t{\n\t\t\t\tthis.popup.setBindElement(this.$refs.qrLink);\n\t\t\t\tthis.popup.show();\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst basket = this.$store.getters['productList/getBasket']();\n\t\t\tconst productIds = basket.map((basketItem) => {\n\t\t\t\treturn basketItem?.fields?.skuId\n\t\t\t});\n\n\t\t\treturn new Promise(\n\t\t\t\t(resolve, reject) => {\n\t\t\t\t\tajax.runAction(\n\t\t\t\t\t\t'salescenter.api.store.getLinkToProductCollection',\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tjson: {\n\t\t\t\t\t\t\t\tproductIds\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t)\n\t\t\t\t\t\t.then(response => {\n\t\t\t\t\t\t\tthis.compilationLink = response.data.link\n\t\t\t\t\t\t\tthis.popup = new Popup({\n\t\t\t\t\t\t\t\tbindElement: event.target,\n\t\t\t\t\t\t\t\tcontent: this.getQRPopupContent(),\n\t\t\t\t\t\t\t\twidth: 375,\n\t\t\t\t\t\t\t\tcloseIcon: { top: '5px', right: '5px' },\n\t\t\t\t\t\t\t\tpadding: 0,\n\t\t\t\t\t\t\t\tcloseByEsc: true,\n\t\t\t\t\t\t\t\tautoHide: true,\n\t\t\t\t\t\t\t\tcacheable: true,\n\t\t\t\t\t\t\t\tanimation: 'fading-slide',\n\t\t\t\t\t\t\t\tangle: { offset: 30 }\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\tthis.popup.show();\n\t\t\t\t\t\t\tresolve();\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.catch(() => reject());\n\t\t\t\t});\n\t\t},\n\t\tdestroyPopup(): void\n\t\t{\n\t\t\tif (this.popup instanceof Popup)\n\t\t\t{\n\t\t\t\tthis.popup.destroy();\n\t\t\t\tthis.popup = null;\n\t\t\t}\n\t\t},\n\t\tgetQRPopupContent(): HTMLElement\n\t\t{\n\t\t\tif (!this.compilationLink)\n\t\t\t{\n\t\t\t\treturn '';\n\t\t\t}\n\n\t\t\tconst buttonCopy = Tag.render`\n\t\t\t\t<div class=\"catalog-pf-product-qr-popup-copy\">${this.localize.CATALOG_FORM_COMPILATION_QR_COPY}</div>\n\t\t\t`;\n\n\t\t\tEvent.bind(buttonCopy, 'click', () => {\n\t\t\t\tBX.clipboard.copy(this.compilationLink);\n\t\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\t\tcontent: this.localize.CATALOG_FORM_COMPILATION_QR_COPY_NOTIFY_MESSAGE,\n\t\t\t\t\tautoHideDelay: 2000,\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tconst qrWrapper = Tag.render`<div class=\"catalog-pf-product-qr-popup-image\"></div>`;\n\n\t\t\tconst content = Tag.render`\n\t\t\t\t\t<div class=\"catalog-pf-product-qr-popup\">\n\t\t\t\t\t\t<div class=\"catalog-pf-product-qr-popup-content\">\n\t\t\t\t\t\t\t<div class=\"catalog-pf-product-qr-popup-text\">${this.localize.CATALOG_FORM_COMPILATION_QR_POPUP_TITLE}</div>\n\t\t\t\t\t\t\t${qrWrapper}\n\t\t\t\t\t\t\t<div class=\"catalog-pf-product-qr-popup-buttons\">\n\t\t\t\t\t\t\t\t<a href=\"${this.compilationLink}\" target=\"_blank\" class=\"ui-btn ui-btn-light-border ui-btn-round\">${this.localize.CATALOG_FORM_COMPILATION_QR_POPUP_INPUT_TITLE}</a>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"catalog-pf-product-qr-popup-bottom\">\n\t\t\t\t\t\t\t<a href=\"${this.compilationLink}\" target=\"_blank\" class=\"catalog-pf-product-qr-popup--url\">${this.compilationLink}</a>\n\t\t\t\t\t\t\t${buttonCopy}\n\t\t\t\t\t\t</div>\t\t\t\t\t\n\t\t\t\t\t</div>\n\t\t\t\t`;\n\n\t\t\tnew QRCode(qrWrapper, {\n\t\t\t\ttext: this.compilationLink,\n\t\t\t\twidth: 250,\n\t\t\t\theight: 250\n\t\t\t});\n\n\t\t\treturn content;\n\t\t},\n\t\tsetSetting(event)\n\t\t{\n\t\t\tconst value = event.target.checked ? 'Y' : 'N';\n\t\t\tif (!this.compilationOptions.hasStore)\n\t\t\t{\n\t\t\t\tthis.compilationOptions.disabledSwitcher = true;\n\t\t\t\tconst creationStorePopup = new Popup({\n\t\t\t\t\tbindElement: event.target,\n\t\t\t\t\tclassName: 'catalog-product-form-popup--creating-shop',\n\t\t\t\t\tcontent: this.getOnBeforeCreationStorePopupContent(),\n\t\t\t\t\twidth: 310,\n\t\t\t\t\toverlay: true,\n\t\t\t\t\tpadding: 17,\n\t\t\t\t\tanimation: 'fading-slide',\n\t\t\t\t\tangle: false,\n\t\t\t\t});\n\n\t\t\t\tcreationStorePopup.show();\n\t\t\t\tajax.runAction('salescenter.api.store.getStoreInfo', {\n\t\t\t\t\tjson: {}}\n\t\t\t\t)\n\t\t\t\t\t.then((response) => {\n\t\t\t\t\t\tif (Type.isStringFilled(response.data?.deactivatedStore?.TITLE))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst title = Loc.getMessage(\n\t\t\t\t\t\t\t\t'CATALOG_FORM_COMPILATION_UNPUBLISHED_STORE',\n\t\t\t\t\t\t\t\t{'#STORE_TITLE#': Tag.safe`${response.data?.deactivatedStore?.TITLE}`}\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\t\t\t\t\tcontent: Tag.render`\n\t\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t\t<span>${title}</span>\n\t\t\t\t\t\t\t\t\t\t<a href=\"/shop/stores/\" target=\"_blank\">\n\t\t\t\t\t\t\t\t\t\t\t${Loc.getMessage('CATALOG_FORM_COMPILATION_UNPUBLISHED_STORE_LINK')}\n\t\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t`,\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcreationStorePopup.setContent(\n\t\t\t\t\t\t\tthis.getOnAfterCreationStorePopupContent()\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\tcreationStorePopup.setClosingByEsc(true);\n\t\t\t\t\t\tcreationStorePopup.setAutoHide(true);\n\n\t\t\t\t\t\tcreationStorePopup.show();\n\t\t\t\t\t\tthis.$root.$app.changeFormOption('isCompilationMode', value);\n\t\t\t\t\t\tthis.compilationOptions.disabledSwitcher = this.compilationOptions.isLimitedStore;\n\t\t\t\t\t\tthis.compilationOptions.hasStore = true;\n\t\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.$root.$app.changeFormOption('isCompilationMode', value);\n\t\t\t}\n\t\t},\n\t\tgetOnBeforeCreationStorePopupContent()\n\t\t{\n\t\t\tconst loaderContent = Tag.render`\n\t\t\t\t<div class=\"catalog-product-form-popup--loader-block\"></div>\n\t\t\t`;\n\n\t\t\tconst node = Tag.render`\n\t\t\t\t<div class=\"catalog-product-form-popup--container\">\n\t\t\t\t\t<div class=\"catalog-product-form-popup--title\">${Loc.getMessage('CATALOG_FORM_POPUP_BEFORE_MARKET_CREATING')}</div>\n\t\t\t\t\t${loaderContent}\n\t\t\t\t\t<div class=\"catalog-product-form-popup--text\">${Loc.getMessage('CATALOG_FORM_POPUP_BEFORE_MARKET_CREATING_INFO')}</div>\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tconst loader = new Loader({\n\t\t\t\tcolor: \"#2fc6f6\",\n\t\t\t\ttarget: loaderContent,\n\t\t\t\tsize: 40,\n\t\t\t});\n\n\t\t\tloader.show();\n\n\t\t\treturn node;\n\t\t},\n\t\tgetOnAfterCreationStorePopupContent()\n\t\t{\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"catalog-product-form-popup--container\">\n\t\t\t\t\t<div class=\"catalog-product-form-popup--title\">${Loc.getMessage('CATALOG_FORM_POPUP_AFTER_MARKET_CREATING')}</div>\n\t\t\t\t\t<div class=\"catalog-product-form-popup--loader-block catalog-product-form-popup--done\"></div>\n\t\t\t\t\t<div class=\"catalog-product-form-popup--text\">${Loc.getMessage('CATALOG_FORM_POPUP_AFTER_MARKET_CREATING_INFO')}</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t},\n\t\tonLabelClick()\n\t\t{\n\t\t\tif (this.compilationOptions.isLimitedStore)\n\t\t\t{\n\t\t\t\tBX.UI.InfoHelper.show('limit_sites_number');\n\t\t\t}\n\t\t},\n\t\tonClickHint(event: BaseEvent)\n\t\t{\n\t\t\tevent.preventDefault();\n\t\t\tevent.stopImmediatePropagation();\n\t\t\tif (!this.message)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (this.message.isShown())\n\t\t\t{\n\t\t\t\tthis.hideMessage()\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.showMessage();\n\t\t\t}\n\t\t},\n\t\tshowMessage()\n\t\t{\n\t\t\tif (this.message)\n\t\t\t{\n\t\t\t\tDom.addClass(this.$refs.hintIcon, 'catalog-pf-product-panel-message-arrow-target');\n\t\t\t\tthis.message.show();\n\t\t\t}\n\t\t},\n\t\thideMessage()\n\t\t{\n\t\t\tif (this.message)\n\t\t\t{\n\t\t\t\tDom.removeClass(this.$refs.hintIcon, 'catalog-pf-product-panel-message-arrow-target');\n\t\t\t}\n\t\t\tthis.message.hide();\n\t\t\tthis.$root.$app.changeFormOption('hiddenCompilationInfoMessage', 'Y');\n\t\t}\n\t},\n\tcomputed:\n\t{\n\t\tlocalize()\n\t\t{\n\t\t\treturn Vue.getFilteredPhrases('CATALOG_');\n\t\t},\n\n\t\tshowQrLink()\n\t\t{\n\t\t\treturn this.mode === FormMode.COMPILATION;\n\t\t},\n\n\t\t...Vuex.mapState({\n\t\t\tproductList: state => state.productList,\n\t\t})\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div>\n\t\t\t<div class=\"catalog-pf-product-panel-compilation\">\n\t\t\t\t<div class=\"catalog-pf-product-panel-compilation-wrapper\">\n\t\t\t\t\t<label class=\"ui-ctl ui-ctl-checkbox\" @click=\"onLabelClick\">\n\t\t\t\t\t\t<input \n\t\t\t\t\t\t\ttype=\"checkbox\" \n\t\t\t\t\t\t\t:disabled=\"compilationOptions.disabledSwitcher\"\n\t\t\t\t\t\t\tclass=\"ui-ctl-element\" \n\t\t\t\t\t\t\t@change=\"setSetting\" \n\t\t\t\t\t\t\tdata-setting-id=\"isCompilationMode\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t<div class=\"ui-ctl-label-text\">{{localize.CATALOG_FORM_COMPILATION_PRODUCT_SWITCHER}}</div>\n\t\t\t\t\t\t<div ref=\"hintIcon\">\n\t\t\t\t\t\t\t<div data-hint-init=\"vue\" class=\"ui-hint\" @click=\"onClickHint\">\n\t\t\t\t\t\t\t\t<span class=\"ui-hint-icon\"></span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div ref=\"label\"></div>\n\t\t\t\t\t\t<div class=\"tariff-lock\" v-if=\"compilationOptions.isLimitedStore\"></div>\n\t\t\t\t\t</label>\n\t\t\t\t</div>\n\t\t\t\t<div \t\t\t\t\n\t\t\t\t\tv-if=\"showQrLink\"\n\t\t\t\t\tclass=\"catalog-pf-product-panel-compilation-link --icon-qr\"\n\t\t\t\t\t@click=\"showPopup\"\n\t\t\t\t\tref=\"qrLink\"\n\t\t\t\t>\n\t\t\t\t\t{{localize.CATALOG_FORM_COMPILATION_QR_LINK}}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"catalog-pf-product-panel-compilation-message\" ref=\"message\"></div>\n\t\t</div>\n\t`\n});","import {Vuex} from 'ui.vue.vuex';\nimport {Popup} from 'main.popup';\nimport {ajax, Event, Loc, Tag, Text, Type} from 'main.core';\nimport {Vue} from \"ui.vue\";\nimport {config} from \"../../config\";\nimport \"./panel-compilation\";\n\nVue.component(config.templatePanelButtons,\n{\n\t/**\n\t * @emits 'changeRowData' {index: number, fields: object}\n\t * @emits 'refreshBasket'\n\t * @emits 'addItem'\n\t */\n\n\tprops: {\n\t\toptions: Object,\n\t\tmode: String,\n\t},\n\tmethods:\n\t{\n\t\trefreshBasket()\n\t\t{\n\t\t\tthis.$emit('refreshBasket');\n\t\t},\n\t\tchangeBasketItem(item)\n\t\t{\n\t\t\tthis.$emit('changeRowData', item);\n\t\t},\n\t\taddBasketItemForm()\n\t\t{\n\t\t\tthis.$emit('addItem');\n\t\t},\n\t\tgetInternalIndexByProductId(skuId)\n\t\t{\n\t\t\tlet basket = this.$store.getters['productList/getBasket']();\n\t\t\treturn Object\n\t\t\t\t.keys(basket)\n\t\t\t\t.findIndex((inx) =>{\n\t\t\t\t\treturn parseInt(basket[inx].skuId) === parseInt(skuId)\n\t\t\t\t});\n\t\t},\n\t\thandleAddItem(id, params)\n\t\t{\n\t\t\tconst skuType = 4;\n\t\t\tif (Text.toNumber(params.type) === skuType)\n\t\t\t{\n\t\t\t\tajax.runAction(\n\t\t\t\t\t'catalog.productSelector.getSelectedSku',\n\t\t\t\t\t{\n\t\t\t\t\t\tjson: {\n\t\t\t\t\t\t\tvariationId: id,\n\t\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\t\tpriceId: this.options.basePriceId,\n\t\t\t\t\t\t\t\turlBuilder: this.options.urlBuilder,\n\t\t\t\t\t\t\t\tresetSku: true\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t).then(response => this.processResponse(response));\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tajax.runAction(\n\t\t\t\t\t'catalog.productSelector.getProduct',\n\t\t\t\t\t{\n\t\t\t\t\t\tjson: {\n\t\t\t\t\t\t\tproductId: id,\n\t\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\t\tpriceId: this.options.basePriceId,\n\t\t\t\t\t\t\t\turlBuilder: this.options.urlBuilder\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t).then(response => this.processResponse(response));\n\t\t\t}\n\t\t},\n\t\tprocessResponse(response)\n\t\t{\n\t\t\tconst index = this.getInternalIndexByProductId(response.data.skuId);\n\t\t\tif (index < 0)\n\t\t\t{\n\t\t\t\tconst productData = response.data;\n\t\t\t\tconst price = Text.toNumber(productData.fields.PRICE);\n\t\t\t\tproductData.fields = productData.fields || {};\n\t\t\t\tlet newItem = this.$store.getters['productList/getBaseProduct']();\n\t\t\t\tnewItem.fields = Object.assign(newItem.fields, {\n\t\t\t\t\tprice,\n\t\t\t\t\tpriceExclusive: price,\n\t\t\t\t\tbasePrice: price,\n\t\t\t\t\tname: productData.fields.NAME || '',\n\t\t\t\t\tproductId: productData.productId,\n\t\t\t\t\tskuId: productData.skuId,\n\t\t\t\t\tofferId: productData.skuId > 0 ? productData.skuId : productData.productId,\n\t\t\t\t\tmodule: 'catalog',\n\t\t\t\t\tisCustomPrice: Type.isNil(productData.fields.PRICE) ? 'Y' : 'N',\n\t\t\t\t\tdiscountType: this.options.defaultDiscountType,\n\t\t\t\t});\n\n\t\t\t\tdelete(productData.fields);\n\t\t\t\tnewItem = Object.assign(newItem, productData);\n\t\t\t\tnewItem.sum = price;\n\n\t\t\t\tthis.$root.$app.addProduct(newItem);\n\t\t\t}\n\t\t},\n\t\tonUpdateBasketItem(inx, item)\n\t\t{\n\t\t\tthis.$store.dispatch('productList/changeRowData', {\n\t\t\t\tindex : inx,\n\t\t\t\tfields : item\n\t\t\t});\n\t\t\tthis.$store.dispatch('productList/changeProduct', {\n\t\t\t\tindex : inx,\n\t\t\t\tfields : item.fields\n\t\t\t});\n\t\t},\n\t\t/*\n\t\t* By default, basket collection contains a fake|empty item,\n\t\t*  that is deleted when you select items from the catalog.\n\t\t* Also, products can be added to the form and become an empty string,\n\t\t*  while stay a item of basket collection\n\t\t* */\n\t\tremoveEmptyItems()\n\t\t{\n\t\t\tlet basket = this.$store.getters['productList/getBasket']();\n\t\t\tbasket.forEach((item, i)=>{\n\t\t\t\tif(\n\t\t\t\t\tbasket[i].name === ''\n\t\t\t\t\t&& basket[i].price < 1e-10\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tthis.$store.commit('productList/deleteItem', {\n\t\t\t\t\t\tindex: i\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tmodifyBasketItem(params)\n\t\t{\n\t\t\tconst skuId = parseInt(params.id);\n\t\t\tif(skuId > 0)\n\t\t\t{\n\t\t\t\tconst index = this.getInternalIndexByProductId(skuId);\n\t\t\t\tif(index >= 0)\n\t\t\t\t{\n\t\t\t\t\tthis.showDialogProductExists(params);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.removeEmptyItems();\n\t\t\t\t\tthis.handleAddItem(skuId, params);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tshowDialogProductExists(params)\n\t\t{\n\t\t\tthis.popup = new Popup(null, null, {\n\t\t\t\tevents: {\n\t\t\t\t\tonPopupClose: () => {this.popup.destroy()}\n\t\t\t\t},\n\t\t\t\tzIndex: 4000,\n\t\t\t\tautoHide: true,\n\t\t\t\tcloseByEsc: true,\n\t\t\t\tcloseIcon: true,\n\t\t\t\ttitleBar: Loc.getMessage('CATALOG_FORM_BLOCK_PROD_EXIST_DLG_TITLE'),\n\t\t\t\tdraggable: true,\n\t\t\t\tresizable: false,\n\t\t\t\tlightShadow: true,\n\t\t\t\tcacheable: false,\n\t\t\t\toverlay: true,\n\t\t\t\tcontent: Loc.getMessage('CATALOG_FORM_BLOCK_PROD_EXIST_DLG_TEXT').replace('#NAME#', params.name),\n\t\t\t\tbuttons: this.getButtons(params),\n\t\t\t});\n\n\t\t\tthis.popup.show();\n\t\t},\n\t\tgetButtons(product)\n\t\t{\n\t\t\tlet buttons = [];\n\t\t\tlet params = product;\n\t\t\tbuttons.push(\n\t\t\t\tnew BX.UI.SaveButton(\n\t\t\t\t\t{\n\t\t\t\t\t\ttext : Loc.getMessage('CATALOG_FORM_BLOCK_PROD_EXIST_DLG_OK'),\n\t\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\t\tlet productId = parseInt(params.id);\n\t\t\t\t\t\t\tlet inx = this.getInternalIndexByProductId(productId);\n\t\t\t\t\t\t\tif(inx >= 0)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tconst item = this.$store.getters['productList/getBasket']()[inx];\n\t\t\t\t\t\t\t\titem.fields.quantity++;\n\t\t\t\t\t\t\t\titem.calculatedFields.QUANTITY++;\n\t\t\t\t\t\t\t\tthis.onUpdateBasketItem(inx, item);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tthis.popup.destroy();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t);\n\n\t\t\tbuttons.push(\n\t\t\t\tnew BX.UI.CancelButton(\n\t\t\t\t\t{\n\t\t\t\t\t\ttext : Loc.getMessage('CATALOG_FORM_BLOCK_PROD_EXIST_DLG_NO'),\n\t\t\t\t\t\tonclick: () => {this.popup.destroy()}\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t);\n\t\t\treturn buttons;\n\t\t},\n\t\tshowDialogProductSearch()\n\t\t{\n\t\t\tlet funcName = 'addBasketItemFromDialogProductSearch';\n\t\t\twindow[funcName] = params => this.modifyBasketItem(params);\n\n\t\t\tlet popup = new BX.CDialog({\n\t\t\t\tcontent_url: '/bitrix/tools/sale/product_search_dialog.php?'+\n\t\t\t\t\t//todo: 'lang='+this._settings.languageId+\n\t\t\t\t\t//todo: '&LID='+this._settings.siteId+\n\t\t\t\t\t'&caller=order_edit'+\n\t\t\t\t\t'&func_name='+funcName+\n\t\t\t\t\t'&STORE_FROM_ID=0'+\n\t\t\t\t\t'&public_mode=Y',\n\t\t\t\theight: Math.max(500, window.innerHeight-400),\n\t\t\t\twidth: Math.max(800, window.innerWidth-400),\n\t\t\t\tdraggable: true,\n\t\t\t\tresizable: true,\n\t\t\t\tmin_height: 500,\n\t\t\t\tmin_width: 800,\n\t\t\t\tzIndex: 3100\n\t\t\t});\n\n\t\t\tpopup.Show();\n\t\t},\n\t\tsetSetting(event)\n\t\t{\n\t\t\tif (event.target.dataset.settingId === 'taxIncludedOption')\n\t\t\t{\n\t\t\t\tconst value = event.target.checked ? 'Y' : 'N';\n\t\t\t\tthis.$root.$app.changeFormOption('taxIncluded', value);\n\t\t\t}\n\t\t\telse if (event.target.dataset.settingId === 'showDiscountInputOption')\n\t\t\t{\n\t\t\t\tconst value = event.target.checked ? 'Y' : 'N';\n\t\t\t\tthis.$root.$app.changeFormOption('showDiscountBlock', value);\n\t\t\t}\n\t\t\telse if (event.target.dataset.settingId === 'showTaxInputOption')\n\t\t\t{\n\t\t\t\tconst value = event.target.checked ? 'Y' : 'N';\n\t\t\t\tthis.$root.$app.changeFormOption('showTaxBlock', value);\n\t\t\t}\n\t\t},\n\t\tgetSettingItem(item): HTMLElement\n\t\t{\n\t\t\tconst input = Tag.render`\n\t\t\t\t\t<input type=\"checkbox\"  class=\"ui-ctl-element\">\n\t\t\t\t`;\n\t\t\tinput.checked = item.checked;\n\t\t\tinput.dataset.settingId = item.id;\n\n\t\t\tconst setting = Tag.render`\n\t\t\t\t<label class=\"ui-ctl ui-ctl-checkbox ui-ctl-w100\">\n\t\t\t\t\t${input}\n\t\t\t\t\t<div class=\"ui-ctl-label-text\">${item.title}</div>\n\t\t\t\t</label>\n\t\t\t`;\n\n\t\t\tEvent.bind(setting, 'change', this.setSetting.bind(this));\n\n\t\t\treturn setting;\n\t\t},\n\t\tprepareSettingsContent(): HTMLElement\n\t\t{\n\t\t\tconst settings = [\n\t\t\t\t// {\n\t\t\t\t// \tid: 'taxIncludedOption',\n\t\t\t\t// \tchecked: (this.options.taxIncluded === 'Y'),\n\t\t\t\t// \ttitle: this.localize.CATALOG_FORM_ADD_TAX_INCLUDED,\n\t\t\t\t// },\n\t\t\t\t{\n\t\t\t\t\tid: 'showDiscountInputOption',\n\t\t\t\t\tchecked: (this.options.showDiscountBlock !== 'N'),\n\t\t\t\t\ttitle: this.localize.CATALOG_FORM_ADD_SHOW_DISCOUNTS_OPTION,\n\t\t\t\t},\n\t\t\t\t// {\n\t\t\t\t// \tid: 'showTaxInputOption',\n\t\t\t\t// \tchecked: (this.options.showTaxBlock !== 'N'),\n\t\t\t\t// \ttitle: this.localize.CATALOG_FORM_ADD_SHOW_TAXES_OPTION,\n\t\t\t\t// },\n\t\t\t];\n\n\t\t\tconst content = Tag.render`\n\t\t\t\t\t<div class='catalog-pf-product-config-popup'></div>\n\t\t\t\t`;\n\n\t\t\tsettings.forEach(item => {\n\t\t\t\tcontent.append(this.getSettingItem(item));\n\t\t\t});\n\n\t\t\treturn content;\n\t\t},\n\t\tshowConfigPopup(event)\n\t\t{\n\t\t\tif (!this.popupMenu)\n\t\t\t{\n\t\t\t\tthis.popupMenu = new Popup(null, event.target,\n\t\t\t\t\t{\n\t\t\t\t\t\tautoHide: true,\n\t\t\t\t\t\tdraggable: false,\n\t\t\t\t\t\toffsetLeft: 0,\n\t\t\t\t\t\toffsetTop: 0,\n\t\t\t\t\t\tnoAllPaddings: true,\n\t\t\t\t\t\tbindOptions: {forceBindPosition: true},\n\t\t\t\t\t\tcloseByEsc: true,\n\t\t\t\t\t\tcontent: this.prepareSettingsContent()\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tthis.popupMenu.show();\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tlocalize()\n\t\t{\n\t\t\treturn Vue.getFilteredPhrases('CATALOG_');\n\t\t},\n\t\tcountItems()\n\t\t{\n\t\t\treturn this.order.basket.length;\n\t\t},\n\t\t...Vuex.mapState({\n\t\t\tproductList: state => state.productList,\n\t\t})\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div>\n\t\t\t<div class=\"catalog-pf-product-add\">\n\t\t\t\t<div class=\"catalog-pf-product-add-wrapper\">\n\t\t\t\t\t<span class=\"catalog-pf-product-add-link\" @click=\"addBasketItemForm\">{{localize.CATALOG_FORM_ADD_PRODUCT}}</span>\n\t\t\t\t\t<span class=\"catalog-pf-product-add-link catalog-pf-product-add-link--gray\" @click=\"showDialogProductSearch\">{{localize.CATALOG_FORM_ADD_PRODUCT_FROM_CATALOG}}</span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"catalog-pf-product-configure-link\" @click=\"showConfigPopup\">{{localize.CATALOG_FORM_DISCOUNT_EDIT_PAGE_URL_TITLE}}</div>\n\t\t\t</div>\n\t\t</div>\n\t`\n});","import {config} from '../config';\n\nimport {Vue} from 'ui.vue';\nimport {Vuex} from 'ui.vue.vuex';\nimport \"currency\";\nimport \"ui.layout-form\";\nimport \"ui.forms\";\nimport \"ui.buttons\";\n\nimport \"./row\";\nimport \"./elements/panel-buttons\";\nimport {FormElementPosition} from \"../types/form-element-position\";\nimport {FormMode} from \"../types/form-mode\";\n\nVue.component(config.templateName,\n{\n\tprops: {\n\t\toptions: Object,\n\t\tmode: String,\n\t},\n\tcreated()\n\t{\n\t\tBX.ajax.runAction(\n\t\t\t\"catalog.productSelector.getFileInput\",\n\t\t\t{ json: { iblockId: this.options.iblockId } }\n\t\t);\n\t},\n\tmethods:\n\t{\n\t\trefreshBasket()\n\t\t{\n\t\t\tthis.$store.dispatch('productList/refreshBasket');\n\t\t},\n\n\t\tchangeProduct(item)\n\t\t{\n\t\t\tthis.$root.$app.changeProduct(item);\n\t\t},\n\n\t\tchangeRowData(item)\n\t\t{\n\t\t\tdelete(item.fields.fields);\n\t\t\tthis.$store.dispatch('productList/changeItem', item);\n\t\t},\n\n\t\tremoveItem(item)\n\t\t{\n\t\t\tthis.$root.$app.removeProduct(item);\n\t\t},\n\n\t\taddItem()\n\t\t{\n\t\t\tthis.$root.$app.addProduct();\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tlocalize()\n\t\t{\n\t\t\treturn Vue.getFilteredPhrases('CATALOG_');\n\t\t},\n\n\t\tshowTaxResult()\n\t\t{\n\t\t\treturn this.options.showTaxBlock !== 'N';\n\t\t},\n\n\t\tshowResults()\n\t\t{\n\t\t\treturn this.options.showResults !== false;\n\t\t},\n\n\t\tshowButtonsTop()\n\t\t{\n\t\t\treturn this.options.singleProductMode !== true\n\t\t\t\t&& this.mode !== FormMode.READ_ONLY\n\t\t\t\t&& this.options.buttonsPosition !== FormElementPosition.BOTTOM\n\t\t\t;\n\t\t},\n\n\t\tshowButtonsBottom()\n\t\t{\n\t\t\treturn this.options.singleProductMode !== true\n\t\t\t\t&& this.mode !== FormMode.READ_ONLY\n\t\t\t\t&& this.options.buttonsPosition === FormElementPosition.BOTTOM\n\t\t\t;\n\t\t},\n\n\t\tshowResultBlock()\n\t\t{\n\t\t\treturn this.showResults || this.enableAddButtons;\n\t\t},\n\n\t\tcountItems()\n\t\t{\n\t\t\treturn this.productList.basket.length;\n\t\t},\n\n\t\ttotalResultLabel()\n\t\t{\n\t\t\treturn this.options.hasOwnProperty('totalResultLabel') && this.options.totalResultLabel\n\t\t\t\t? this.options.totalResultLabel\n\t\t\t\t: this.localize.CATALOG_FORM_TOTAL_RESULT;\n\t\t},\n\n\t\t...Vuex.mapState({\n\t\t\tproductList: state => state.productList,\n\t\t})\n\t},\n\t// language=Vue\n\ttemplate: `\n\t<div class=\"catalog-product-form-container\">\n\t\t<${config.templatePanelButtons}\n\t\t\t:options=\"options\" \n\t\t\t:mode=\"mode\" \n\t\t\t@refreshBasket=\"refreshBasket\" \n\t\t\t@addItem=\"addItem\"\n\t\t\t@changeRowData=\"changeRowData\"\n\t\t\t@changeProduct=\"changeProduct\" \n\t\t\tv-if=\"showButtonsTop\"\n\t\t/>\n\t\t<div v-for=\"(item, index) in productList.basket\" :key=\"item.selectorId\">\n\t\t\t<${config.templateRowName} \n\t\t\t\t:basketItem=\"item\" \n\t\t\t\t:basketItemIndex=\"index\"  \n\t\t\t\t:countItems=\"countItems\"\n\t\t\t\t:options=\"options\"\n\t\t\t\t:mode=\"mode\"\n\t\t\t\t@changeProduct=\"changeProduct\" \n\t\t\t\t@changeRowData=\"changeRowData\" \n\t\t\t\t@removeItem=\"removeItem\" \n\t\t\t\t@refreshBasket=\"refreshBasket\" \n\t\t\t/>\n\t\t</div>\n\t\t<${config.templatePanelButtons}\n\t\t\t:options=\"options\" \n\t\t\t:mode=\"mode\"\n\t\t\t@refreshBasket=\"refreshBasket\" \n\t\t\t@addItem=\"addItem\"\n\t\t\t@changeRowData=\"changeRowData\"\n\t\t\t@changeProduct=\"changeProduct\" \n\t\t\tv-if=\"showButtonsBottom\"\n\t\t/>\n\t\t<${config.templatePanelCompilation}  \n\t\t\tv-if=\"options.showCompilationModeSwitcher\"\n\t\t\t:compilationOptions=\"options.compilationFormOption\" \n\t\t\t:mode=\"mode\" \n\t\t/>\n\t\t<div class=\"catalog-pf-result-line\"></div>\n\t\t<div class=\"catalog-pf-result-wrapper\" v-if=\"showResultBlock\">\n\t\t\t<table class=\"catalog-pf-result\" v-if=\"showResultBlock\">\n\t\t\t\t<tr v-if=\"showResults\">\n\t\t\t\t\t<td>\n\t\t\t\t\t\t<span class=\"catalog-pf-text\">{{localize.CATALOG_FORM_PRODUCTS_PRICE}}:</span>\n\t\t\t\t\t</td>\n\t\t\t\t\t<td>\n\t\t\t\t\t\t<span v-html=\"productList.total.sum\"\n\t\t\t\t\t\t\t:class=\"productList.total.result !== productList.total.sum ? 'catalog-pf-text catalog-pf-text--line-through' : 'catalog-pf-text'\"\n\t\t\t\t\t\t></span>\n\t\t\t\t\t\t<span class=\"catalog-pf-symbol\" v-html=\"options.currencySymbol\"></span>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\t\t\t\t<tr v-if=\"showResults\">\n\t\t\t\t\t<td class=\"catalog-pf-result-padding-bottom\">\n\t\t\t\t\t\t<span class=\"catalog-pf-text catalog-pf-text--discount\">{{localize.CATALOG_FORM_TOTAL_DISCOUNT}}:</span>\n\t\t\t\t\t</td>\n\t\t\t\t\t<td class=\"catalog-pf-result-padding-bottom\">\n\t\t\t\t\t\t<span class=\"catalog-pf-text catalog-pf-text--discount\" v-html=\"productList.total.discount\"></span>\n\t\t\t\t\t\t<span class=\"catalog-pf-symbol\" v-html=\"options.currencySymbol\"></span>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\t\t\t\t<tr v-if=\"showResults && showTaxResult\">\n\t\t\t\t\t<td class=\"catalog-pf-tax\">\n\t\t\t\t\t\t<span class=\"catalog-pf-text catalog-pf-text--tax\">{{localize.CATALOG_FORM_TAX_TITLE}}:</span>\n\t\t\t\t\t</td>\n\t\t\t\t\t<td class=\"catalog-pf-tax\">\n\t\t\t\t\t\t<span class=\"catalog-pf-text catalog-pf-text--tax\" v-html=\"productList.total.taxSum\"></span>\n\t\t\t\t\t\t<span class=\"catalog-pf-symbol\" v-html=\"options.currencySymbol\"></span>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\t\t\t\t<tr v-if=\"showResults\">\n\t\t\t\t\t<td class=\"catalog-pf-result-padding\">\n\t\t\t\t\t\t<span class=\"catalog-pf-text catalog-pf-text--total catalog-pf-text--border\">{{totalResultLabel}}:</span>\n\t\t\t\t\t</td>\n\t\t\t\t\t<td class=\"catalog-pf-result-padding\">\n\t\t\t\t\t\t<span class=\"catalog-pf-text catalog-pf-text--total\" v-html=\"productList.total.result\"></span>\n\t\t\t\t\t\t<span class=\"catalog-pf-symbol catalog-pf-symbol--total\" v-html=\"options.currencySymbol\"></span>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\t\t\t</table>\n\t\t</div>\n\t</div>\n`,\n});\n","import {BitrixVue} from 'ui.vue';\nimport {VuexBuilder} from 'ui.vue.vuex';\nimport {Loc, Type, Text, Tag, ajax, Extension} from 'main.core';\nimport 'ui.notification';\nimport {ProductList} from './models/product-list';\nimport {config} from \"./config\";\nimport './templates/form';\nimport './component.css';\nimport {EventEmitter} from \"main.core.events\";\nimport {CurrencyCore} from \"currency.currency-core\";\nimport type {FormOption} from \"./types/form-option\";\nimport {FormElementPosition} from \"./types/form-element-position\";\nimport {DiscountType} from \"catalog.product-calculator\";\nimport {FormInputCode} from \"./types/form-input-code\";\nimport type {BasketItemScheme} from \"./types/basket-item-scheme\";\nimport {FormErrorCode} from \"./types/form-error-code\";\nimport {FormMode} from \"./types/form-mode\";\nimport {FormCompilationType} from \"./types/form-compilation-type\";\n\nexport class ProductForm\n{\n\tconstructor(options: FormOption = {})\n\t{\n\t\tthis.options = this.prepareOptions(options);\n\t\tthis.defaultOptions = Object.assign({}, this.options);\n\n\t\tthis.editable = true;\n\t\tthis.#setMode(FormMode.REGULAR);\n\n\t\tthis.wrapper = Tag.render`<div class=\"\"></div>`;\n\n\t\tif (Text.toNumber(options.iblockId) <= 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tProductForm.initStore()\n\t\t\t.then((result) => this.initTemplate(result))\n\t\t\t.catch((error) => ProductForm.showError(error))\n\t\t;\n\t}\n\n\tstatic initStore(): VuexBuilder\n\t{\n\t\tconst builder = new VuexBuilder();\n\n\t\treturn builder\n\t\t\t.addModel(ProductList.create())\n\t\t\t.build();\n\t}\n\n\tprepareOptions(options: FormOption = {}): FormOption\n\t{\n\t\tconst settingsCollection = Extension.getSettings('catalog.product-form');\n\t\tconst defaultOptions: FormOption = {\n\t\t\tbasket: [],\n\t\t\tmeasures: [],\n\t\t\tiblockId: null,\n\t\t\tbasePriceId: settingsCollection.get('basePriceId'),\n\t\t\ttaxList: [],\n\t\t\tsingleProductMode: false,\n\t\t\tshowResults: true,\n\t\t\tshowCompilationModeSwitcher: false,\n\t\t\tenableEmptyProductError: true,\n\t\t\tpricePrecision: 2,\n\t\t\tcurrency: settingsCollection.get('currency'),\n\t\t\tcurrencySymbol: settingsCollection.get('currencySymbol'),\n\t\t\ttaxIncluded: settingsCollection.get('taxIncluded'),\n\t\t\tshowDiscountBlock: settingsCollection.get('showDiscountBlock'),\n\t\t\tshowTaxBlock: settingsCollection.get('showTaxBlock'),\n\t\t\tallowedDiscountTypes: [DiscountType.PERCENTAGE, DiscountType.MONETARY],\n\t\t\tvisibleBlocks: [\n\t\t\t\tFormInputCode.PRODUCT_SELECTOR, FormInputCode.PRICE,\n\t\t\t\tFormInputCode.QUANTITY, FormInputCode.RESULT,\n\t\t\t\tFormInputCode.DISCOUNT,\n\t\t\t],\n\t\t\trequiredFields: [],\n\t\t\teditableFields: [],\n\t\t\tnewItemPosition: FormElementPosition.TOP,\n\t\t\tbuttonsPosition: FormElementPosition.TOP,\n\t\t\turlBuilderContext: 'SHOP',\n\t\t\thideUnselectedProperties: false,\n\t\t\tcompilationFormType: FormCompilationType.REGULAR,\n\t\t\tcompilationFormOption: {},\n\t\t};\n\n\t\tif (options.visibleBlocks && !Type.isArray(options.visibleBlocks))\n\t\t{\n\t\t\tdelete(options.visibleBlocks);\n\t\t}\n\n\t\tif (options.requiredFields && !Type.isArray(options.requiredFields))\n\t\t{\n\t\t\tdelete(options.requiredFields);\n\t\t}\n\n\t\toptions = {...defaultOptions, ...options};\n\t\toptions.showTaxBlock = 'N';\n\n\t\tif (settingsCollection.get('isEnabledLanding'))\n\t\t{\n\t\t\toptions.compilationFormOption = {\n\t\t\t\ttype: options.compilationFormType,\n\t\t\t\thasStore: settingsCollection.get('hasLandingStore'),\n\t\t\t\tisLimitedStore: settingsCollection.get('isLimitedLandingStore'),\n\t\t\t\tdisabledSwitcher: settingsCollection.get('isLimitedLandingStore'),\n\t\t\t\thiddenInfoMessage: settingsCollection.get('hiddenCompilationInfoMessage'),\n\t\t\t};\n\t\t}\n\t\telse\n\t\t{\n\t\t\toptions.showCompilationModeSwitcher = false;\n\t\t}\n\n\t\toptions.defaultDiscountType = '';\n\t\tif (Type.isArray(options.allowedDiscountTypes))\n\t\t{\n\t\t\tif (options.allowedDiscountTypes.includes(DiscountType.PERCENTAGE))\n\t\t\t{\n\t\t\t\toptions.defaultDiscountType = DiscountType.PERCENTAGE;\n\t\t\t}\n\t\t\telse if (options.allowedDiscountTypes.includes(DiscountType.MONETARY))\n\t\t\t{\n\t\t\t\toptions.defaultDiscountType = DiscountType.MONETARY;\n\t\t\t}\n\t\t}\n\n\t\treturn options;\n\t}\n\n\tlayout(): HTMLElement\n\t{\n\t\treturn this.wrapper;\n\t}\n\n\tinitTemplate(result): Promise\n\t{\n\t\treturn new Promise((resolve) =>\n\t\t{\n\t\t\tconst context = this;\n\t\t\tthis.store = result.store;\n\n\t\t\tthis.templateEngine = BitrixVue.createApp({\n\t\t\t\tel: this.wrapper,\n\t\t\t\tstore: this.store,\n\t\t\t\tdata: {\n\t\t\t\t\toptions: this.options,\n\t\t\t\t\tmode: this.mode,\n\t\t\t\t},\n\t\t\t\tcreated()\n\t\t\t\t{\n\t\t\t\t\tthis.$app = context;\n\t\t\t\t},\n\t\t\t\tmounted()\n\t\t\t\t{\n\t\t\t\t\tresolve();\n\t\t\t\t},\n\t\t\t\ttemplate: `<${config.templateName} :options=\"options\" :mode=\"mode\"/>`,\n\t\t\t});\n\n\t\t\tif (Type.isStringFilled(this.options.currency))\n\t\t\t{\n\t\t\t\tthis.setData({\n\t\t\t\t\tcurrency: this.options.currency\n\t\t\t\t});\n\t\t\t\tCurrencyCore.loadCurrencyFormat(this.options.currency);\n\t\t\t}\n\n\t\t\tif (this.options.basket.length > 0)\n\t\t\t{\n\t\t\t\tthis.setData(\n\t\t\t\t\t{basket: this.options.basket,},\n\t\t\t\t\t{newItemPosition: FormElementPosition.BOTTOM}\n\t\t\t\t);\n\n\t\t\t\tif (Type.isObject(this.options.totals))\n\t\t\t\t{\n\t\t\t\t\tthis.store.commit('productList/setTotal', this.options.totals);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.store.dispatch('productList/calculateTotal');\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst newItem = this.store.getters['productList/getBaseProduct']();\n\t\t\t\tnewItem.fields.discountType = this.options.defaultDiscountType;\n\t\t\t\tthis.addProduct(newItem);\n\t\t\t}\n\t\t});\n\t}\n\n\taddProduct(item = {}): void\n\t{\n\t\tthis.store.dispatch('productList/addItem', {\n\t\t\titem,\n\t\t\tposition: this.options.newItemPosition\n\t\t})\n\t\t\t.then(() => {\n\t\t\t\tthis.#onBasketChange();\n\t\t\t});\n\t}\n\n\t#onBasketChange(): void\n\t{\n\t\tEventEmitter.emit(this, 'ProductForm:onBasketChange', {\n\t\t\tbasket: this.store.getters['productList/getBasket']()\n\t\t});\n\t}\n\n\tchangeProduct(product): void\n\t{\n\t\tconst fields = product.fields;\n\t\tconst result = this.#checkRequiredFields(fields);\n\t\tfields.errors = result?.errors || [];\n\n\t\tthis.store.dispatch('productList/changeItem', {\n\t\t\tindex: product.index,\n\t\t\tfields\n\t\t}).then(() => {\n\t\t\tthis.#onBasketChange();\n\t\t});\n\t}\n\n\t#checkRequiredFields(fields: BasketItemScheme): {}\n\t{\n\t\tconst result = {};\n\t\tif (this.options.requiredFields.length === 0)\n\t\t{\n\t\t\treturn result;\n\t\t}\n\n\t\tresult.errors = [];\n\t\tthis.options.requiredFields.forEach((code) => {\n\t\t\tswitch (code)\n\t\t\t{\n\t\t\t\tcase FormInputCode.PRICE:\n\t\t\t\t\tif (fields.price <= 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tresult.errors.push({\n\t\t\t\t\t\t\tcode: FormErrorCode.EMPTY_PRICE,\n\t\t\t\t\t\t\tmessage: Loc.getMessage('CATALOG_FORM_ERROR_EMPTY_PRICE'),\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase FormInputCode.QUANTITY:\n\t\t\t\t\tif (fields.quantity <= 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tresult.errors.push({\n\t\t\t\t\t\t\tcode: FormErrorCode.EMPTY_QUANTITY,\n\t\t\t\t\t\t\tmessage: Loc.getMessage('CATALOG_FORM_ERROR_EMPTY_QUANTITY'),\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase FormInputCode.BRAND:\n\t\t\t\t\tif (!Type.isArray(fields.brands) || fields.brands.length === 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tresult.errors.push({\n\t\t\t\t\t\t\tcode: FormErrorCode.EMPTY_BRAND,\n\t\t\t\t\t\t\tmessage: Loc.getMessage('CATALOG_FORM_ERROR_EMPTY_BRAND'),\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t});\n\n\t\treturn result;\n\t}\n\n\tremoveProduct(product): void\n\t{\n\t\tthis.store.dispatch('productList/removeItem', {\n\t\t\tindex: product.index\n\t\t}).then(() => {\n\t\t\tthis.#onBasketChange();\n\t\t});\n\t}\n\n\tsetData(data, option = {}): void\n\t{\n\t\tif (Type.isObject(data.basket))\n\t\t{\n\t\t\tconst formBasket = this.store.getters['productList/getBasket']();\n\t\t\tdata.basket.forEach((fields) => {\n\t\t\t\tif (!Type.isObject(fields))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tconst itemPosition = option.newItemPosition || this.options.newItemPosition;\n\n\t\t\t\tconst innerId = fields.selectorId;\n\t\t\t\tif (Type.isNil(innerId))\n\t\t\t\t{\n\t\t\t\t\tthis.store.dispatch('productList/addItem', {\n\t\t\t\t\t\titem: fields,\n\t\t\t\t\t\tposition: itemPosition\n\t\t\t\t\t});\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst basketIndex = formBasket.findIndex(item => item.selectorId === innerId);\n\t\t\t\tif (basketIndex === -1)\n\t\t\t\t{\n\t\t\t\t\tthis.store.dispatch('productList/addItem', {\n\t\t\t\t\t\titem: fields,\n\t\t\t\t\t\tposition: itemPosition\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.store.dispatch('productList/changeItem', {basketIndex, fields});\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tif (Type.isStringFilled(data.currency))\n\t\t{\n\t\t\tthis.store.dispatch('productList/setCurrency', data.currency);\n\t\t}\n\t\t\n\t\tif (Type.isObject(data.total))\n\t\t{\n\t\t\tthis.store.commit('productList/setTotal', {\n\t\t\t\tsum: data.total.sum,\n\t\t\t\ttaxSum: data.total.taxSum,\n\t\t\t\tdiscount: data.total.discount,\n\t\t\t\tresult: data.total.result,\n\t\t\t})\n\t\t}\n\n\t\tif (Type.isObject(data.errors))\n\t\t{\n\t\t\tthis.store.commit('productList/setErrors', data.errors);\n\t\t}\n\t}\n\n\tchangeFormOption(optionName, value): void\n\t{\n\t\tvalue = (value === 'Y') ? 'Y' : 'N';\n\n\t\tif (optionName === 'isCompilationMode')\n\t\t{\n\t\t\tif (!this.options.showCompilationModeSwitcher)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst mode = (value === 'Y') ? FormMode.COMPILATION : FormMode.REGULAR;\n\t\t\tthis.#changeCompilationModeSetting(mode);\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.options[optionName] = value;\n\t\tif (optionName !== 'hiddenCompilationInfoMessage')\n\t\t{\n\t\t\tconst basket = this.store.getters['productList/getBasket']();\n\t\t\tbasket.forEach((item, index) => {\n\t\t\t\tif (optionName === 'showDiscountBlock')\n\t\t\t\t{\n\t\t\t\t\titem.showDiscountBlock = value;\n\t\t\t\t}\n\t\t\t\telse if (optionName === 'showTaxBlock')\n\t\t\t\t{\n\t\t\t\t\titem.showTaxBlock = value;\n\t\t\t\t}\n\t\t\t\telse if (optionName === 'taxIncluded')\n\t\t\t\t{\n\t\t\t\t\titem.fields.taxIncluded = value;\n\t\t\t\t}\n\n\t\t\t\tthis.store.dispatch('productList/changeItem', {\n\t\t\t\t\tindex,\n\t\t\t\t\tfields: item\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t\tajax.runAction(\n\t\t\t'catalog.productForm.setConfig',\n\t\t\t{\n\t\t\t\tdata: {\n\t\t\t\t\tconfigName: optionName,\n\t\t\t\t\tvalue: value\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t}\n\n\t#changeCompilationModeSetting(mode: FormMode)\n\t{\n\t\tthis.options.requiredFields = [];\n\t\tif (mode === FormMode.COMPILATION)\n\t\t{\n\t\t\tconst compilationRequiredFields = [\n\t\t\t\tFormInputCode.PRODUCT_SELECTOR, FormInputCode.PRICE, FormInputCode.BRAND,\n\t\t\t];\n\t\t\tthis.options.requiredFields = this.options.visibleBlocks.filter(\n\t\t\t\titem => compilationRequiredFields.includes(item)\n\t\t\t);\n\t\t}\n\n\t\tthis.#setMode(mode)\n\n\t\tconst basket = this.store.getters['productList/getBasket']();\n\n\t\tbasket.forEach((item, index) => this.changeProduct({\n\t\t\t\tindex,\n\t\t\t\tfields: item.fields\n\t\t\t})\n\t\t);\n\t}\n\n\tgetTotal(): void\n\t{\n\t\tthis.store.dispatch('productList/getTotal');\n\t}\n\n\tsetEditable(value): void\n\t{\n\t\tthis.editable = value;\n\t\tif (!value)\n\t\t{\n\t\t\tthis.#setMode(FormMode.READ_ONLY);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.#setMode(FormMode.REGULAR);\n\t\t}\n\t}\n\n\t#setMode(mode: FormMode): void\n\t{\n\t\tthis.mode = mode;\n\t\tif (mode === FormMode.READ_ONLY)\n\t\t{\n\t\t\tthis.options.editableFields = [];\n\t\t}\n\t\telse if (mode === FormMode.COMPILATION)\n\t\t{\n\t\t\tthis.options.editableFields = [\n\t\t\t\tFormInputCode.PRODUCT_SELECTOR, FormInputCode.PRICE, FormInputCode.BRAND,\n\t\t\t];\n\n\t\t\tthis.options.visibleBlocks = [\n\t\t\t\tFormInputCode.PRODUCT_SELECTOR, FormInputCode.PRICE,\n\t\t\t];\n\n\t\t\tif (this.options.compilationFormType === FormCompilationType.FACEBOOK)\n\t\t\t{\n\t\t\t\tthis.options.visibleBlocks.push(FormInputCode.BRAND);\n\t\t\t}\n\n\t\t\tthis.options.showResults = false;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tmode = FormMode.REGULAR;\n\t\t\tthis.options.visibleBlocks = this.defaultOptions.visibleBlocks;\n\t\t\tthis.options.showResults = this.defaultOptions.showResults;\n\n\t\t\tconst visibleBlocks = this.options.visibleBlocks.slice(0);\n\t\t\tif (visibleBlocks.includes(FormInputCode.RESULT))\n\t\t\t{\n\t\t\t\tvisibleBlocks.splice(visibleBlocks.indexOf(FormInputCode.RESULT), 1);\n\t\t\t}\n\t\t\tthis.options.editableFields = visibleBlocks;\n\t\t}\n\n\t\tif (this.templateEngine)\n\t\t{\n\t\t\tthis.templateEngine.mode = mode;\n\t\t}\n\n\t\tEventEmitter.emit(this, 'ProductForm:onModeChange', { mode });\n\t}\n\n\thasErrors()\n\t{\n\t\tif (!this.store)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst basket = this.store.getters['productList/getBasket']();\n\t\tconst errorItems = basket.filter(\n\t\t\titem => item.errors.length > 0\n\t\t);\n\n\t\treturn errorItems.length > 0;\n\t}\n\n\tstatic showError(error): void\n\t{\n\t\tconsole.error(error);\n\t}\n}"],"names":["FormElementPosition","ProductList","currency","taxIncluded","basket","total","sum","discount","taxSum","result","resetBasket","commit","removeItem","payload","dispatch","state","length","forEach","item","i","index","fields","sort","changeItem","setCurrency","addItem","position","TOP","calculateTotal","basePrice","Text","toNumber","quantity","getBasket","getBaseProduct","Object","assign","BOTTOM","push","unshift","updateItem","Vue","set","clearBasket","deleteItem","splice","setErrors","errors","clearErrors","setTotal","formattedTotal","Type","isStringFilled","key","hasOwnProperty","CurrencyCore","currencyFormat","random","getRandom","offerId","selectorId","innerId","productId","skuId","code","module","price","priceExclusive","name","discountRate","discountInfos","discountType","DiscountType","PERCENTAGE","tax","measureCode","measureName","measureRatio","isCustomPrice","additionalFields","properties","brands","calculatedFields","showDiscount","showTax","skuTree","image","discountSum","detailUrl","encodedFields","VuexBuilderModel","config","freeze","databaseConfig","templateName","templatePanelButtons","templatePanelCompilation","templateRowName","templateFieldInlineSelector","templateFieldPrice","templateFieldQuantity","templateFieldDiscount","templateFieldTax","templateFieldBrand","moduleId","FormInputCode","FormErrorCode","FormMode","component","props","Number","String","editable","Boolean","hasError","options","created","onInputQuantityHandler","Runtime","debounce","onInputQuantity","methods","event","target","value","replace","newQuantity","parseFloat","lastSymbol","substr","changeQuantity","calculateCorrectionFactor","factoredQuantity","factoredRatio","correctionFactor","isInteger","incrementValue","decrementValue","$emit","showPopupMenu","isArray","measures","menuItems","text","SYMBOL","onclick","changeMeasure","popupMenu","Menu","bindElement","items","show","params","param","CODE","close","template","onInputPriceHandler","onInputPrice","newPrice","computed","localize","getFilteredPhrases","currencySymbol","onInputDiscount","onChangeDiscount","onChangeType","type","MONETARY","discountValue","allowedDiscountTypes","includes","getDiscountInputValue","getDiscountSymbol","taxId","data","taxValue","getTaxList","onChangeValue","id","taxList","basketItem","productSelector","imageControlId","EventEmitter","subscribe","onProductChange","bind","onProductClear","mounted","ProductSelector","prepareSelectorParams","renderTo","$refs","selectorWrapper","selectorOptions","iblockId","basePriceId","getField","getDefaultSkuTree","fileInputId","morePhotoValues","fileInput","DETAIL_PATH","ENABLE_SEARCH","ENABLE_INPUT_DETAIL_LINK","ENABLE_IMAGE_CHANGE_SAVING","ENABLE_EMPTY_PRODUCT_ERROR","enableEmptyProductError","isRequiredField","PRODUCT_SELECTOR","ENABLE_EMPTY_IMAGES_ERROR","IMAGE_EDITOR","ROW_ID","ENABLE_SKU_SELECTION","HIDE_UNSELECTED_ITEMS","hideUnselectedProperties","URL_BUILDER_CONTEXT","urlBuilderContext","mode","MODE_EDIT","MODE_VIEW","isSimpleModel","NAME","PRICE","CURRENCY","formImage","isObject","fileView","preview","input","values","requiredFields","JSON","parse","defaultValue","getData","getId","BASE_PRICE","MODULE","ID","PRODUCT_ID","SKU_ID","PROPERTIES","CUSTOMIZED","isNil","MEASURE_CODE","MEASURE_NAME","Array","cache","Cache","MemoryCache","selector","TagSelector","dialogOptions","context","preselectedItems","getPreselectedBrands","events","onBrandChange","createBrand","searchTabOptions","stub","stubOptions","title","Tag","message","subtitle","arrow","searchOptions","allowCreateItem","entities","dynamicSearch","dynamicLoad","brandSelectorWrapper","map","getTarget","getSelectedItems","resultValues","searchQuery","Promise","resolve","reject","dialog","getQuery","showLoader","ajax","runAction","then","response","hideLoader","entityId","tabs","getRecentTab","select","hide","catch","FormCompilationType","basketItemIndex","countItems","blocks","QUANTITY","RESULT","DISCOUNT","TAX","brand","BRAND","errorCodes","emptyProductSelector","EMPTY_PRODUCT_SELECTOR","emptyImage","EMPTY_IMAGE","emptyQuantity","EMPTY_QUANTITY","emptyPrice","EMPTY_PRICE","emptyBrand","EMPTY_BRAND","defaultFields","defaultPrice","calculatorFields","pricePrecision","calculator","ProductCalculator","currencyId","commonPrecision","setCalculationStrategy","TaxForPriceStrategy","defaultMeasure","measure","changeProduct","changeDiscount","updated","changedFields","emit","rowId","getCalculator","setCalculatedFields","productFields","PRICE_EXCLUSIVE","TAX_INCLUDED","DISCOUNT_RATE","DISCOUNT_SUM","DISCOUNT_TYPE_ID","SUM","BRANDS","TAX_ID","changeRowData","calculatePrice","setFields","toggleDiscount","isReadOnly","setTimeout","discountWrapper","discountInput","focus","toggleTax","changeBrand","getFields","processFields","calculateQuantity","changePrice","changeDiscountType","calculateDiscountType","calculateDiscount","changeTax","calculateTax","changeTaxIncluded","isEditableField","calculateTaxIncluded","isVisibleBlock","visibleBlocks","filteredErrors","filter","error","editableFields","watch","oldValue","showDiscountBlock","getBrandsSelectorId","getPriceExclusive","showTaxBlock","showRemoveIcon","showTaxSelector","showBasePrice","getMeasureName","getMeasureCode","isTaxIncluded","READ_ONLY","FormHelpdeskCode","compilationOptions","destroyPopup","newLabel","Label","CATALOG_FORM_COMPILATION_PRODUCT_NEW_LABEL","color","LabelColor","PRIMARY","fill","moreMessageButton","render","CATALOG_FORM_COMPILATION_INFO_BUTTON_MORE","Event","openHelpDesk","header","description","isFacebookForm","CATALOG_FORM_COMPILATION_INFO_MESSAGE_TITLE_FACEBOOK","CATALOG_FORM_COMPILATION_INFO_MESSAGE_BODY_FACEBOOK_FIRST_BLOCK","CATALOG_FORM_COMPILATION_INFO_MESSAGE_BODY_FACEBOOK_SECOND_BLOCK","CATALOG_FORM_COMPILATION_INFO_MESSAGE_TITLE","CATALOG_FORM_COMPILATION_INFO_MESSAGE_BODY_MARKETING","MessageCard","angle","hidden","actionElements","hideMessage","label","appendChild","getLayout","hiddenInfoMessage","showMessage","compilationLink","FACEBOOK","helpdeskCode","COMPILATION_FACEBOOK","COMMON_COMPILATION","top","BX","Helper","showPopup","disabledSwitcher","popup","Popup","setBindElement","qrLink","$store","getters","productIds","json","link","content","getQRPopupContent","width","closeIcon","right","padding","closeByEsc","autoHide","cacheable","animation","offset","destroy","buttonCopy","CATALOG_FORM_COMPILATION_QR_COPY","clipboard","copy","UI","Notification","Center","notify","CATALOG_FORM_COMPILATION_QR_COPY_NOTIFY_MESSAGE","autoHideDelay","qrWrapper","CATALOG_FORM_COMPILATION_QR_POPUP_TITLE","CATALOG_FORM_COMPILATION_QR_POPUP_INPUT_TITLE","QRCode","height","setSetting","checked","hasStore","creationStorePopup","className","getOnBeforeCreationStorePopupContent","overlay","deactivatedStore","TITLE","Loc","getMessage","safe","setContent","getOnAfterCreationStorePopupContent","setClosingByEsc","setAutoHide","$root","$app","changeFormOption","isLimitedStore","loaderContent","node","loader","Loader","size","onLabelClick","InfoHelper","onClickHint","preventDefault","stopImmediatePropagation","isShown","Dom","addClass","hintIcon","removeClass","showQrLink","COMPILATION","Vuex","mapState","productList","refreshBasket","changeBasketItem","addBasketItemForm","getInternalIndexByProductId","keys","findIndex","inx","parseInt","handleAddItem","skuType","variationId","priceId","urlBuilder","resetSku","processResponse","productData","newItem","defaultDiscountType","addProduct","onUpdateBasketItem","removeEmptyItems","modifyBasketItem","showDialogProductExists","onPopupClose","zIndex","titleBar","draggable","resizable","lightShadow","buttons","getButtons","product","SaveButton","CancelButton","showDialogProductSearch","funcName","window","CDialog","content_url","Math","max","innerHeight","innerWidth","min_height","min_width","Show","dataset","settingId","getSettingItem","setting","prepareSettingsContent","settings","CATALOG_FORM_ADD_SHOW_DISCOUNTS_OPTION","append","showConfigPopup","offsetLeft","offsetTop","noAllPaddings","bindOptions","forceBindPosition","order","removeProduct","showTaxResult","showResults","showButtonsTop","singleProductMode","buttonsPosition","showButtonsBottom","showResultBlock","enableAddButtons","totalResultLabel","CATALOG_FORM_TOTAL_RESULT","ProductForm","prepareOptions","defaultOptions","REGULAR","wrapper","initStore","initTemplate","showError","settingsCollection","Extension","getSettings","get","showCompilationModeSwitcher","newItemPosition","compilationFormType","compilationFormOption","store","templateEngine","BitrixVue","createApp","el","setData","loadCurrencyFormat","totals","option","formBasket","itemPosition","basketIndex","optionName","configName","errorItems","builder","VuexBuilder","addModel","create","build","console","compilationRequiredFields","slice","indexOf"],"mappings":"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"}