{"version":3,"file":"product-form.bundle.js","sources":["../src/types/form-element-position.js","../src/models/product-list.js","../src/config.js","../src/types/form-input-code.js","../src/types/form-error-code.js","../src/types/form-mode.js","../src/templates/fields/quantity.js","../src/templates/fields/price.js","../src/templates/fields/discount.js","../src/templates/fields/tax.js","../src/templates/fields/inline-selector.js","../src/templates/fields/brand.js","../src/templates/fields/result-sum.js","../src/templates/row.js","../src/types/form-compilation-type.js","../src/types/form-helpdesk-code.js","../src/templates/elements/panel-compilation.js","../src/templates/elements/panel-buttons.js","../src/templates/elements/summary-total.js","../src/templates/form.js","../src/product-form.js"],"sourcesContent":["export class FormElementPosition\n{\n\tstatic TOP: string = 'TOP';\n\tstatic BOTTOM: string = 'BOTTOM';\n}","import {Vue} from 'ui.vue';\nimport {Text, Type} from 'main.core';\nimport {VuexBuilderModel} from 'ui.vue.vuex';\nimport {DiscountType} from \"catalog.product-calculator\";\nimport {FormElementPosition} from \"../types/form-element-position\";\nimport {CurrencyCore} from \"currency.currency-core\";\nimport type {FormScheme} from \"../types/form-scheme\";\nimport type {BasketItem} from \"../types/basket-item\";\n\nexport class ProductList extends VuexBuilderModel\n{\n\t/**\n\t * @inheritDoc\n\t */\n\tgetName(): string\n\t{\n\t\treturn 'productList';\n\t}\n\n\tgetState(): FormScheme\n\t{\n\t\treturn {\n\t\t\tcurrency: '',\n\t\t\ttaxIncluded: 'N',\n\t\t\tbasket: [],\n\t\t\ttotal: {\n\t\t\t\tsum: 0,\n\t\t\t\tdiscount: 0,\n\t\t\t\ttaxSum: 0,\n\t\t\t\tresult: 0,\n\t\t\t},\n\t\t}\n\t}\n\n\tstatic getBaseProduct(): BasketItem\n\t{\n\t\tconst random = Text.getRandom();\n\t\treturn {\n\t\t\tofferId: null,\n\t\t\tselectorId: random,\n\t\t\tfields: {\n\t\t\t\tinnerId: random,\n\t\t\t\tproductId: null,\n\t\t\t\tskuId: null,\n\t\t\t\tcode: null,\n\t\t\t\tmodule: null,\n\t\t\t\tsort: 0,\n\t\t\t\tprice: null,\n\t\t\t\tbasePrice: null,\n\t\t\t\tpriceExclusive: null,\n\t\t\t\tquantity: 1,\n\t\t\t\tname: '',\n\t\t\t\tdiscount: 0,\n\t\t\t\tdiscountRate: 0,\n\t\t\t\tdiscountInfos: [],\n\t\t\t\tdiscountType: DiscountType.PERCENTAGE,\n\t\t\t\ttax: 0,\n\t\t\t\ttaxSum: 0,\n\t\t\t\ttaxIncluded: 'N',\n\t\t\t\tmeasureCode: 0,\n\t\t\t\tmeasureName: '',\n\t\t\t\tmeasureRatio: 1,\n\t\t\t\tisCustomPrice: 'N',\n\t\t\t\tadditionalFields: [],\n\t\t\t\tproperties: [],\n\t\t\t\tbrands: [],\n\t\t\t\tweight: 0,\n\t\t\t\tdimensions: {},\n\t\t\t},\n\t\t\tcalculatedFields: [],\n\t\t\tcatalogFields: {},\n\t\t\tshowDiscount: 'N',\n\t\t\tshowTax: 'N',\n\t\t\tskuTree: [],\n\t\t\timage: null,\n\t\t\tsum: 0,\n\t\t\tcatalogPrice: null,\n\t\t\tdiscountSum: 0,\n\t\t\tdetailUrl: '',\n\t\t\tencodedFields: null,\n\t\t\terrors: [],\n\t\t};\n\t}\n\n\tgetActions()\n\t{\n\t\treturn {\n\t\t\tresetBasket ({commit})\n\t\t\t{\n\t\t\t\tcommit('clearBasket');\n\t\t\t\tcommit('addItem', {});\n\t\t\t},\n\t\t\tremoveItem({dispatch, commit, state}, payload)\n\t\t\t{\n\t\t\t\tcommit('deleteItem', payload);\n\t\t\t\tif (state.basket.length === 0)\n\t\t\t\t{\n\t\t\t\t\tcommit('addItem', {});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tstate.basket.forEach((item, i) => {\n\t\t\t\t\t\tcommit('updateItem', {\n\t\t\t\t\t\t\tindex: i,\n\t\t\t\t\t\t\tfields: {sort: i}\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tdispatch('calculateTotal');\n\t\t\t},\n\t\t\tchangeItem: ({dispatch, commit}, payload) =>\n\t\t\t{\n\t\t\t\tcommit('updateItem', payload);\n\t\t\t\tdispatch('calculateTotal');\n\t\t\t},\n\t\t\tsetCurrency: ({commit}, payload) =>\n\t\t\t{\n\t\t\t\tconst currency = payload || '';\n\t\t\t\tcommit('setCurrency', currency);\n\t\t\t},\n\t\t\taddItem: ({dispatch, commit}, payload) =>\n\t\t\t{\n\t\t\t\tconst item = payload.item || {fields: {}};\n\t\t\t\tcommit('addItem', {\n\t\t\t\t\titem,\n\t\t\t\t\tposition: payload.position || FormElementPosition.TOP\n\t\t\t\t});\n\t\t\t\tdispatch('calculateTotal');\n\t\t\t},\n\t\t\tcalculateTotal: ({commit, state}) =>\n\t\t\t{\n\t\t\t\tconst total = {\n\t\t\t\t\tsum: 0,\n\t\t\t\t\ttaxSum: 0,\n\t\t\t\t\tdiscount: 0,\n\t\t\t\t\tresult: 0,\n\t\t\t\t};\n\n\t\t\t\tstate.basket.forEach((item) => {\n\t\t\t\t\tconst basePrice = Text.toNumber(item.fields.basePrice || 0);\n\t\t\t\t\tconst quantity = Text.toNumber(item.fields.quantity || 0);\n\t\t\t\t\tconst discount = Text.toNumber(item.fields.discount || 0);\n\t\t\t\t\tconst taxSum = Text.toNumber(item.fields.taxSum || 0);\n\t\t\t\t\ttotal.sum += basePrice * quantity;\n\t\t\t\t\ttotal.result += Text.toNumber(item.sum);\n\t\t\t\t\ttotal.discount += discount * quantity;\n\t\t\t\t\ttotal.taxSum += taxSum * quantity;\n\t\t\t\t});\n\n\t\t\t\ttotal.discount = (total.discount > total.sum) ? total.sum : total.discount;\n\n\t\t\t\tcommit('setTotal', total)\n\t\t\t}\n\t\t}\n\t}\n\n\tgetGetters()\n\t{\n\t\treturn {\n\t\t\tgetBasket: state => (): Array<BasketItem> =>\n\t\t\t{\n\t\t\t\treturn state.basket;\n\t\t\t},\n\t\t\tgetBaseProduct: () => (): BasketItem =>\n\t\t\t{\n\t\t\t\treturn ProductList.getBaseProduct();\n\t\t\t},\n\t\t}\n\t}\n\n\tgetMutations()\n\t{\n\t\treturn {\n\t\t\taddItem: (state, payload) =>\n\t\t\t{\n\t\t\t\tlet item = ProductList.getBaseProduct();\n\n\t\t\t\titem = Object.assign(item, payload.item);\n\t\t\t\tif (payload.position === FormElementPosition.BOTTOM)\n\t\t\t\t{\n\t\t\t\t\tstate.basket.push(item);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tstate.basket.unshift(item);\n\t\t\t\t}\n\n\t\t\t\tstate.basket.forEach((item, index) => {\n\t\t\t\t\titem.fields.sort = index;\n\t\t\t\t});\n\t\t\t},\n\t\t\tupdateItem: (state, payload) =>\n\t\t\t{\n\t\t\t\tif (Type.isNil(state.basket[payload.index]))\n\t\t\t\t{\n\t\t\t\t\tVue.set(state.basket, payload.index, ProductList.getBaseProduct());\n\t\t\t\t}\n\n\t\t\t\tstate.basket[payload.index] = Object.assign(\n\t\t\t\t\tstate.basket[payload.index],\n\t\t\t\t\tpayload.product\n\t\t\t\t);\n\t\t\t},\n\t\t\tclearBasket: (state) =>\n\t\t\t{\n\t\t\t\tstate.basket = [];\n\t\t\t},\n\t\t\tdeleteItem: (state, payload) =>\n\t\t\t{\n\t\t\t\tstate.basket.splice(payload.index, 1);\n\t\t\t\tstate.basket.forEach((item, index) => {\n\t\t\t\t\titem.fields.sort = index;\n\t\t\t\t});\n\t\t\t},\n\t\t\tsetErrors: (state, payload) =>\n\t\t\t{\n\t\t\t\tstate.errors = payload;\n\t\t\t},\n\t\t\tclearErrors: (state) =>\n\t\t\t{\n\t\t\t\tstate.errors = [];\n\t\t\t},\n\t\t\tsetCurrency: (state, payload) =>\n\t\t\t{\n\t\t\t\tstate.currency = payload;\n\t\t\t},\n\t\t\tsetTotal: (state, payload) =>\n\t\t\t{\n\t\t\t\tconst formattedTotal = payload;\n\t\t\t\tif (Type.isStringFilled(state.currency))\n\t\t\t\t{\n\t\t\t\t\tfor (const key in payload)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (payload.hasOwnProperty(key))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tformattedTotal[key] = CurrencyCore.currencyFormat(payload[key], state.currency)\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tstate.total = Object.assign(\n\t\t\t\t\tstate.total,\n\t\t\t\t\tformattedTotal\n\t\t\t\t);\n\t\t\t},\n\t\t}\n\t}\n}\n","export const config = Object.freeze({\n\tdatabaseConfig: {\n\t\tname: 'catalog.product-form',\n\t},\n\ttemplateName: 'bx-form',\n\ttemplatePanelButtons: 'bx-panel-buttons',\n\ttemplatePanelCompilation: 'bx-panel-compilation',\n\ttemplateRowName: 'bx-form-row',\n\ttemplateFieldInlineSelector: 'bx-field-inline-selector',\n\ttemplateFieldPrice: 'bx-field-price',\n\ttemplateFieldResultSum: 'bx-field-result-sum',\n\ttemplateFieldQuantity: 'bx-field-quantity',\n\ttemplateFieldDiscount: 'bx-field-discount',\n\ttemplateFieldTax: 'bx-field-tax',\n\ttemplateFieldBrand: 'bx-field-brand',\n\ttemplateSummaryTotal: 'bx-summary-total',\n\tmoduleId: 'catalog',\n});\n","export class FormInputCode\n{\n\tstatic PRODUCT_SELECTOR = 'product-selector';\n\tstatic IMAGE_EDITOR = 'image-editor';\n\tstatic QUANTITY = 'quantity';\n\tstatic PRICE = 'price';\n\tstatic RESULT = 'result';\n\tstatic DISCOUNT = 'discount';\n\tstatic TAX = 'tax';\n\tstatic BRAND = 'brand';\n\tstatic MEASURE = 'measure';\n}","export class FormErrorCode\n{\n\tstatic EMPTY_PRODUCT_SELECTOR = 0;\n\tstatic EMPTY_IMAGE = 1;\n\tstatic EMPTY_QUANTITY = 2;\n\tstatic EMPTY_PRICE = 3;\n\tstatic EMPTY_BRAND = 4;\n\tstatic IS_NULLABLE_PRICE = 5;\n}","export class FormMode\n{\n\tstatic REGULAR: string = 'REGULAR';\n\tstatic READ_ONLY: string = 'READ_ONLY';\n\tstatic COMPILATION: string = 'COMPILATION';\n\tstatic COMPILATION_READ_ONLY: string = 'COMPILATION_READ_ONLY';\n}","import {Menu, MenuItem} from 'main.popup';\nimport {Runtime, Type, Text} from 'main.core';\nimport {Vue} from \"ui.vue\";\nimport {config} from \"../../config\";\nimport type {BaseEvent} from \"main.core.events\";\n\nVue.component(config.templateFieldQuantity,\n{\n\t/**\n\t * @emits 'onChangeQuantity' {quantity: number}\n\t * @emits 'onSelectMeasure' {quantity: number, }\n\t */\n\n\tprops: {\n\t\tmeasureCode: Number,\n\t\tmeasureRatio: Number,\n\t\tmeasureName: String,\n\t\tquantity: Number,\n\t\teditable: Boolean,\n\t\tsaveableMeasure: Boolean,\n\t\thasError: Boolean,\n\t\toptions: Object,\n\t},\n\tcreated()\n\t{\n\t\tthis.onInputQuantityHandler = Runtime.debounce(this.onInputQuantity, 500, this);\n\t},\n\tmethods:\n\t{\n\t\tonInputQuantity(event: BaseEvent): void\n\t\t{\n\t\t\tif (!this.editable)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tevent.target.value = event.target.value.replace(/[^.\\d]/g,'.');\n\t\t\tconst newQuantity = Text.toNumber(event.target.value);\n\t\t\tconst lastSymbol = event.target.value.substr(-1);\n\n\t\t\tif (lastSymbol === '.')\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.changeQuantity(newQuantity);\n\t\t},\n\t\tcalculateCorrectionFactor(quantity, measureRatio)\n\t\t{\n\t\t\tlet factoredQuantity = quantity;\n\t\t\tlet factoredRatio = measureRatio;\n\t\t\tlet correctionFactor = 1;\n\n\t\t\twhile (!(Number.isInteger(factoredQuantity) && Number.isInteger(factoredRatio)))\n\t\t\t{\n\t\t\t\tcorrectionFactor *= 10;\n\t\t\t\tfactoredQuantity = quantity * correctionFactor;\n\t\t\t\tfactoredRatio = measureRatio * correctionFactor;\n\t\t\t}\n\n\t\t\treturn correctionFactor;\n\t\t},\n\t\tincrementValue()\n\t\t{\n\t\t\tif (!this.editable)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst correctionFactor = this.calculateCorrectionFactor(this.quantity, this.measureRatio);\n\t\t\tconst quantity = (this.quantity * correctionFactor + this.measureRatio * correctionFactor) / correctionFactor;\n\t\t\tthis.changeQuantity(quantity);\n\t\t},\n\t\tdecrementValue()\n\t\t{\n\t\t\tif (this.quantity > this.measureRatio && this.editable)\n\t\t\t{\n\t\t\t\tconst correctionFactor = this.calculateCorrectionFactor(this.quantity, this.measureRatio);\n\t\t\t\tconst quantity = (this.quantity * correctionFactor - this.measureRatio * correctionFactor) / correctionFactor;\n\t\t\t\tthis.changeQuantity(quantity);\n\t\t\t}\n\t\t},\n\t\tchangeQuantity(value: number)\n\t\t{\n\t\t\tthis.$emit('onChangeQuantity', value);\n\t\t},\n\t\tshowPopupMenu(target: HTMLElement)\n\t\t{\n\t\t\tif (!this.editable || !Type.isArray(this.options.measures))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst menuItems = [];\n\t\t\tthis.options.measures.forEach((item) => {\n\t\t\t\tmenuItems.push({\n\t\t\t\t\ttext: item.SYMBOL,\n\t\t\t\t\titem: item,\n\t\t\t\t\tonclick: this.selectMeasure,\n\t\t\t\t})\n\t\t\t});\n\n\n\t\t\tif (menuItems.length > 0)\n\t\t\t{\n\t\t\t\tthis.popupMenu = new Menu({\n\t\t\t\t\tbindElement: target,\n\t\t\t\t\titems: menuItems\n\t\t\t\t});\n\n\t\t\t\tthis.popupMenu.show();\n\t\t\t}\n\t\t},\n\t\tselectMeasure(event: BaseEvent, params: MenuItem)\n\t\t{\n\t\t\tthis.$emit('onSelectMeasure', {\n\t\t\t\tcode: params.options?.item.CODE,\n\t\t\t\tname: params.options?.item.SYMBOL,\n\t\t\t});\n\n\t\t\tif (this.popupMenu)\n\t\t\t{\n\t\t\t\tthis.popupMenu.close();\n\t\t\t}\n\t\t},\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"catalog-pf-product-input-wrapper\" v-bind:class=\"{ 'ui-ctl-danger': hasError }\">\n\t\t\t<input \t\n\t\t\t\ttype=\"text\" class=\"catalog-pf-product-input\"\n\t\t\t\tv-bind:class=\"{ 'catalog-pf-product-input--disabled': !editable }\"\n\t\t\t\t:value=\"quantity\"\n\t\t\t\t@input=\"onInputQuantityHandler\"\n\t\t\t\t:disabled=\"!editable\"\n\t\t\t>\n\t\t\t<div \n\t\t\t\tclass=\"catalog-pf-product-input-info catalog-pf-product-input-info--action\" \n\t\t\t\t@click=\"showPopupMenu($event.target)\"\n\t\t\t>\n\t\t\t\t<span>{{ measureName }}</span>\n\t\t\t</div>\n\t\t</div>\n\t`\n});","import {Loc, Runtime, Text} from 'main.core';\nimport {Vue} from \"ui.vue\";\nimport {config} from \"../../config\";\nimport type {BaseEvent} from \"main.core.events\";\n\nVue.component(config.templateFieldPrice,\n{\n\t/**\n\t * @emits 'onChangePrice' {price: number}\n\t * @emits 'saveCatalogField' {}\n\t */\n\n\tprops: {\n\t\tselectorId: String,\n\t\tprice: Number,\n\t\teditable: Boolean,\n\t\thasError: Boolean,\n\t\toptions: Object,\n\t},\n\tcreated()\n\t{\n\t\tthis.onInputPriceHandler = Runtime.debounce(this.onInputPrice, 500, this);\n\t},\n\tmounted()\n\t{\n\t\tBX.UI.Hint.init();\n\t},\n\tmethods:\n\t{\n\t\tonInputPrice(event: BaseEvent): void\n\t\t{\n\t\t\tif (!this.editable)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tevent.target.value = event.target.value.replace(/[^.,\\d]/g,'');\n\t\t\tif (event.target.value === '')\n\t\t\t{\n\t\t\t\tevent.target.value = 0;\n\t\t\t}\n\t\t\tconst lastSymbol = event.target.value.substr(-1);\n\t\t\tif (lastSymbol === ',')\n\t\t\t{\n\t\t\t\tevent.target.value = event.target.value.replace(',', \".\");\n\t\t\t}\n\n\t\t\tlet newPrice = Text.toNumber(event.target.value);\n\t\t\tif (lastSymbol === '.' || lastSymbol === ',')\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (newPrice < 0)\n\t\t\t{\n\t\t\t\tnewPrice *= -1;\n\t\t\t}\n\n\t\t\tthis.$emit('onChangePrice', newPrice);\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tlocalize()\n\t\t{\n\t\t\treturn Vue.getFilteredPhrases('CATALOG_');\n\t\t},\n\t\tcurrencySymbol()\n\t\t{\n\t\t\treturn this.options.currencySymbol || '';\n\t\t},\n\t\thintText()\n\t\t{\n\t\t\tif (!this.editable && !this.options?.isCatalogPriceEditEnabled)\n\t\t\t{\n\t\t\t\treturn Loc.getMessage('CATALOG_FORM_PRICE_ACCESS_DENIED_HINT');\n\t\t\t}\n\n\t\t\treturn null;\n\t\t},\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div \n\t\t\tclass=\"catalog-pf-product-input-wrapper\" \n\t\t\t:class=\"{ 'ui-ctl-danger': hasError, '.catalog-pf-product-input-wrapper--disabled': !editable }\"\n\t\t\t:data-hint=\"hintText\"\n\t\t\tdata-hint-no-icon\n\t\t>\n\t\t\t<input \ttype=\"text\" class=\"catalog-pf-product-input catalog-pf-product-input--align-right\"\n\t\t\t\t\tv-bind:class=\"{ 'catalog-pf-product-input--disabled': !editable }\"\n\t\t\t\t\tv-model.lazy=\"price\"\n\t\t\t\t\t@input=\"onInputPriceHandler\"\n\t\t\t\t\t:disabled=\"!editable\"\n\t\t\t>\n\t\t\t<div class=\"catalog-pf-product-input-info\" v-html=\"currencySymbol\"></div>\n\t\t</div>\n\t`\n});\n","import {Menu} from 'main.popup';\nimport {Loc, Runtime, Text, Type} from 'main.core';\nimport {Vue} from \"ui.vue\";\nimport {config} from \"../../config\";\nimport {DiscountType} from \"catalog.product-calculator\";\n\nVue.component(config.templateFieldDiscount,\n{\n\t/**\n\t * @emits 'changeDiscountType' {type: Y|N}\n\t * @emits 'changeDiscount' {discountValue: number}\n\t */\n\n\tprops: {\n\t\teditable: Boolean,\n\t\toptions: Object,\n\t\tdiscount: Number,\n\t\tdiscountType: Number,\n\t\tdiscountRate: Number,\n\t},\n\tcreated()\n\t{\n\t\tthis.onInputDiscount = Runtime.debounce(this.onChangeDiscount, 500, this);\n\t\tthis.currencySymbol = this.options.currencySymbol;\n\t},\n\tmounted()\n\t{\n\t\tBX.UI.Hint.init();\n\t},\n\tmethods:\n\t{\n\t\tonChangeType(event, params)\n\t\t{\n\t\t\tif (!this.editable)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst type = (Text.toNumber(params?.options?.type) === DiscountType.MONETARY) ?  DiscountType.MONETARY : DiscountType.PERCENTAGE;\n\t\t\tthis.$emit('changeDiscountType', type);\n\n\t\t\tif (this.popupMenu)\n\t\t\t{\n\t\t\t\tthis.popupMenu.close();\n\t\t\t}\n\t\t},\n\t\tonChangeDiscount(event)\n\t\t{\n\t\t\tconst discountValue = Text.toNumber(event.target.value) || 0;\n\t\t\tif (discountValue === Text.toNumber(this.discount) || !this.editable)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.$emit('changeDiscount', discountValue);\n\t\t},\n\t\tshowPopupMenu(target)\n\t\t{\n\t\t\tif (!this.editable || !Type.isArray(this.options.allowedDiscountTypes))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst menuItems = [];\n\t\t\tif (this.options.allowedDiscountTypes.includes(DiscountType.PERCENTAGE))\n\t\t\t{\n\t\t\t\tmenuItems.push({\n\t\t\t\t\ttext: '%',\n\t\t\t\t\tonclick: this.onChangeType,\n\t\t\t\t\ttype: DiscountType.PERCENTAGE,\n\t\t\t\t})\n\t\t\t}\n\n\t\t\tif (this.options.allowedDiscountTypes.includes(DiscountType.MONETARY))\n\t\t\t{\n\t\t\t\tmenuItems.push({\n\t\t\t\t\ttext: this.currencySymbol,\n\t\t\t\t\tonclick: this.onChangeType,\n\t\t\t\t\ttype: DiscountType.MONETARY,\n\t\t\t\t})\n\t\t\t}\n\n\t\t\tif (menuItems.length > 0)\n\t\t\t{\n\t\t\t\tthis.popupMenu = new Menu({\n\t\t\t\t\tbindElement: target,\n\t\t\t\t\titems: menuItems\n\t\t\t\t});\n\n\t\t\t\tthis.popupMenu.show();\n\t\t\t}\n\t\t},\n\t},\n\tcomputed: {\n\t\tgetDiscountInputValue()\n\t\t{\n\t\t\tif (Text.toNumber(this.discountType) === DiscountType.PERCENTAGE)\n\t\t\t{\n\t\t\t\treturn Text.toNumber(this.discountRate);\n\t\t\t}\n\t\t\treturn Text.toNumber(this.discount);\n\t\t},\n\t\tgetDiscountSymbol()\n\t\t{\n\t\t\treturn Text.toNumber(this.discountType) === DiscountType.PERCENTAGE ? '%' : this.currencySymbol;\n\t\t},\n\t\twrapperClasses()\n\t\t{\n\t\t\treturn {\n\t\t\t\t'catalog-pf-product-input-wrapper--disabled': !this.editable,\n\t\t\t};\n\t\t},\n\t\thintText()\n\t\t{\n\t\t\tif (!this.editable && !this.options?.isCatalogDiscountSetEnabled)\n\t\t\t{\n\t\t\t\treturn Loc.getMessage('CATALOG_FORM_DISCOUNT_ACCESS_DENIED_HINT');\n\t\t\t}\n\n\t\t\treturn null;\n\t\t},\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div\n\t\t\tclass=\"catalog-pf-product-input-wrapper catalog-pf-product-input-wrapper--left\"\n\t\t\t:class=\"wrapperClasses\"\n\t\t\t:data-hint=\"hintText\"\n\t\t\tdata-hint-no-icon\n\t\t>\n\t\t\t<input class=\"catalog-pf-product-input catalog-pf-product-input--align-right catalog-pf-product-input--right\"\n\t\t\t\tref=\"discountInput\"\n\t\t\t\tv-bind:class=\"{ 'catalog-pf-product-input--disabled': !editable }\"\n\t\t\t\t:value=\"getDiscountInputValue\"\n\t\t\t\t:v-model=\"discountRate\"\n\t\t\t\t@input=\"onInputDiscount\"\n\t\t\t\tplaceholder=\"0\"\n\t\t\t\t:disabled=\"!editable\"\n\t\t\t/>\n\t\t\t<div class=\"catalog-pf-product-input-info catalog-pf-product-input-info--action\"\n\t\t\t\t@click=\"showPopupMenu\">\n\t\t\t\t<span v-html=\"getDiscountSymbol\"></span>\n\t\t\t</div>\n\t\t</div>\n\t`\n});\n","import {Menu} from 'main.popup';\nimport {Text, Type} from 'main.core';\nimport {Vue} from \"ui.vue\";\nimport {config} from \"../../config\";\n\nVue.component(config.templateFieldTax,\n{\n\t/**\n\t * @emits 'changeTax' {taxValue: number}\n\t */\n\n\tprops: {\n\t\ttaxId: Number,\n\t\teditable: Boolean,\n\t\toptions: Object,\n\t},\n\tdata()\n\t{\n\t\treturn {\n\t\t\ttaxValue: this.getTaxList()[this.taxId] || 0\n\t\t};\n\t},\n\tmethods:\n\t{\n\t\tonChangeValue(event, params)\n\t\t{\n\t\t\tconst taxValue = Text.toNumber(params?.options?.item);\n\t\t\tif (taxValue === Text.toNumber(this.taxValue) || !this.editable)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.$emit('changeTax', {\n\t\t\t\ttaxValue,\n\t\t\t\ttaxId: params?.options?.id\n\t\t\t});\n\n\t\t\tif (this.popupMenu)\n\t\t\t{\n\t\t\t\tthis.popupMenu.close();\n\t\t\t}\n\t\t},\n\t\tgetTaxList()\n\t\t{\n\t\t\treturn Type.isArray(this.options.taxList) ? this.options.taxList : [];\n\t\t},\n\t\tshowPopupMenu(target)\n\t\t{\n\t\t\tif (!this.editable || !Type.isArray(this.options.taxList))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst menuItems = [];\n\t\t\tthis.options.taxList.forEach((item, id) => {\n\t\t\t\tmenuItems.push({\n\t\t\t\t\tid,\n\t\t\t\t\ttext: item + '%',\n\t\t\t\t\titem: item,\n\t\t\t\t\tonclick: this.onChangeValue,\n\t\t\t\t})\n\t\t\t});\n\n\n\t\t\tif (menuItems.length > 0)\n\t\t\t{\n\t\t\t\tthis.popupMenu = new Menu({\n\t\t\t\t\tbindElement: target,\n\t\t\t\t\titems: menuItems\n\t\t\t\t});\n\n\t\t\t\tthis.popupMenu.show();\n\t\t\t}\n\t\t},\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"catalog-pf-product-input-wrapper catalog-pf-product-input-wrapper--right\" @click=\"showPopupMenu\">\n\t\t\t<div class=\"catalog-pf-product-input\">{{this.taxValue}}%</div>\n\t\t\t<div class=\"catalog-pf-product-input-info catalog-pf-product-input-info--dropdown\"></div>\n\t\t</div>\n\t`\n});","import {Type} from 'main.core';\nimport {Vue} from \"ui.vue\";\nimport {config} from \"../../config\";\nimport {FormInputCode} from \"../../types/form-input-code\";\nimport {ProductSelector} from \"catalog.product-selector\";\nimport {EventEmitter} from \"main.core.events\";\nimport type {BaseEvent} from \"main.core.events\";\n\nVue.component(config.templateFieldInlineSelector,\n{\n\t/**\n\t * @emits 'onProductChange' {fields: object}\n\t */\n\n\tprops: {\n\t\teditable: Boolean,\n\t\tbasketLength: Number,\n\t\toptions: Object,\n\t\tbasketItem: Object,\n\t\tmodel: Object,\n\t},\n\tdata()\n\t{\n\t\treturn {\n\t\t\tcurrencySymbol: null,\n\t\t\tproductSelector: null,\n\t\t\timageControlId: null,\n\t\t\tselectorId: this.basketItem.selectorId,\n\t\t};\n\t},\n\tcreated()\n\t{\n\t\tEventEmitter.subscribe('BX.Catalog.ProductSelector:onProductSelect', this.onProductSelect.bind(this));\n\t\tEventEmitter.subscribe('BX.Catalog.ProductSelector:onChange', this.onProductChange.bind(this));\n\t\tEventEmitter.subscribe('BX.Catalog.ProductSelector:onClear', this.onProductClear.bind(this))\n\t\tEventEmitter.subscribe(this.$root.$app, 'onChangeCompilationMode', this.changeProductSelectorImageRequire.bind(this));\n\t},\n\tmounted()\n\t{\n\t\tthis.productSelector = new ProductSelector(this.selectorId, this.prepareSelectorParams());\n\t\tthis.productSelector.renderTo(this.$refs.selectorWrapper);\n\t},\n\tmethods:\n\t{\n\t\tchangeProductSelectorImageRequire(event: BaseEvent)\n\t\t{\n\t\t\tconst isCompilationMode = event.getData()?.isCompilationMode;\n\t\t\tconst isFacebookForm = event.getData()?.isFacebookForm;\n\n\t\t\tthis.productSelector.setConfig(\n\t\t\t\t'ENABLE_EMPTY_IMAGES_ERROR',\n\t\t\t\tisCompilationMode && isFacebookForm\n\t\t\t);\n\n\t\t\tthis.productSelector.checkEmptyImageError();\n\t\t\tthis.productSelector.layoutErrors();\n\t\t},\n\t\tprepareSelectorParams(): Object\n\t\t{\n\t\t\tconst fields = {\n\t\t\t\tNAME: this.getField('name') || '',\n\t\t\t};\n\n\t\t\tif (!Type.isNil(this.getField('basePrice')))\n\t\t\t{\n\t\t\t\tfields.PRICE = this.getField('basePrice');\n\t\t\t\tfields.CURRENCY = this.options.currency;\n\t\t\t}\n\n\t\t\tconst basketItemOfferId = this.basketItem.offerId;\n\t\t\tconst facebookFailProducts = this.options.facebookFailProducts;\n\t\t\tconst hasFacebookError =\n\t\t\t\tType.isObject(facebookFailProducts)\n\t\t\t\t&& facebookFailProducts.hasOwnProperty(basketItemOfferId)\n\t\t\t;\n\n\t\t\tconst selectorOptions = {\n\t\t\t\tiblockId: this.options.iblockId,\n\t\t\t\tbasePriceId: this.options.basePriceId,\n\t\t\t\tcurrency: this.options.currency,\n\t\t\t\tskuTree: this.getDefaultSkuTree(),\n\t\t\t\tfileInputId: '',\n\t\t\t\tmorePhotoValues: [],\n\t\t\t\tfileInput: '',\n\t\t\t\tmodel: this.model,\n\t\t\t\tconfig: {\n\t\t\t\t\tDETAIL_PATH: this.basketItem.detailUrl || '',\n\t\t\t\t\tENABLE_SEARCH: true,\n\t\t\t\t\tENABLE_INPUT_DETAIL_LINK: true,\n\t\t\t\t\tENABLE_IMAGE_CHANGE_SAVING: true,\n\t\t\t\t\tENABLE_EMPTY_PRODUCT_ERROR: this.options.enableEmptyProductError || this.isRequiredField(FormInputCode.PRODUCT_SELECTOR),\n\t\t\t\t\tENABLE_EMPTY_IMAGES_ERROR: this.isRequiredField(FormInputCode.IMAGE_EDITOR),\n\t\t\t\t\tROW_ID: this.selectorId,\n\t\t\t\t\tENABLE_SKU_SELECTION: this.editable,\n\t\t\t\t\tHIDE_UNSELECTED_ITEMS: this.options.hideUnselectedProperties,\n\t\t\t\t\tURL_BUILDER_CONTEXT: this.options.urlBuilderContext\n\t\t\t\t},\n\t\t\t\tfailedProduct: hasFacebookError,\n\t\t\t\tmode: this.editable ? ProductSelector.MODE_EDIT : ProductSelector.MODE_VIEW,\n\t\t\t\tfields,\n\t\t\t};\n\n\t\t\tconst formImage = this.basketItem.image;\n\t\t\tif (Type.isObject(formImage))\n\t\t\t{\n\t\t\t\tselectorOptions.fileView = formImage.preview;\n\t\t\t\tselectorOptions.fileInput = formImage.input;\n\t\t\t\tselectorOptions.fileInputId = formImage.id;\n\t\t\t\tselectorOptions.morePhotoValues = formImage.values;\n\t\t\t}\n\n\t\t\treturn selectorOptions;\n\t\t},\n\t\tisEnabledSaving(): boolean\n\t\t{\n\t\t\treturn this.options.enableCatalogSaving && this.basketItem.hasEditRights;\n\t\t},\n\t\tisRequiredField(code: string): boolean\n\t\t{\n\t\t\treturn Type.isArray(this.options.requiredFields) && this.options.requiredFields.includes(code);\n\t\t},\n\t\tgetDefaultSkuTree(): Object\n\t\t{\n\t\t\tlet skuTree = this.basketItem.skuTree || {};\n\t\t\tif (Type.isStringFilled(skuTree))\n\t\t\t{\n\t\t\t\tskuTree = JSON.parse(skuTree);\n\t\t\t}\n\n\t\t\treturn skuTree;\n\t\t},\n\t\tgetField(name, defaultValue = null): any\n\t\t{\n\t\t\treturn this.basketItem.fields[name] || defaultValue;\n\t\t},\n\t\tonProductSelect(event: BaseEvent)\n\t\t{\n\t\t\tconst data = event.getData();\n\t\t\tif (Type.isStringFilled(data.selectorId) && data.selectorId === this.productSelector.getId())\n\t\t\t{\n\t\t\t\tthis.$emit('onProductSelect');\n\t\t\t}\n\t\t},\n\t\tonProductChange(event: BaseEvent): void\n\t\t{\n\t\t\tconst data = event.getData();\n\t\t\tif (Type.isStringFilled(data.selectorId) && data.selectorId === this.productSelector.getId())\n\t\t\t{\n\t\t\t\tconst basePrice = data.fields.BASE_PRICE\n\n\t\t\t\tconst fields = {\n\t\t\t\t\tBASE_PRICE: basePrice,\n\t\t\t\t\tMODULE: 'catalog',\n\t\t\t\t\tNAME: data.fields.NAME,\n\t\t\t\t\tID: data.fields.ID,\n\t\t\t\t\tPRODUCT_ID: data.fields.PRODUCT_ID,\n\t\t\t\t\tSKU_ID: data.fields.SKU_ID,\n\t\t\t\t\tPROPERTIES: data.fields.PROPERTIES,\n\t\t\t\t\tURL_BUILDER_CONTEXT: this.options.urlBuilderContext,\n\t\t\t\t\tCUSTOMIZED: (Type.isNil(data.fields.PRICE) || data.fields.CUSTOMIZED === 'Y') ? 'Y' : 'N',\n\t\t\t\t\tMEASURE_CODE: data.fields.MEASURE_CODE,\n\t\t\t\t\tMEASURE_NAME: data.fields.MEASURE_NAME,\n\t\t\t\t\tMORE_PHOTO: data.morePhoto,\n\t\t\t\t\tBRANDS: data.fields.BRANDS,\n\t\t\t\t\tIS_NEW: data.isNew,\n\t\t\t\t};\n\n\t\t\t\tthis.$emit('onProductChange', fields);\n\t\t\t}\n\t\t},\n\t\tonProductClear(event: BaseEvent)\n\t\t{\n\t\t\tconst data = event.getData();\n\n\t\t\tif (Type.isStringFilled(data.selectorId) && data.selectorId === this.productSelector.getId())\n\t\t\t{\n\t\t\t\tthis.$emit('onProductClear');\n\t\t\t}\n\t\t},\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"catalog-pf-product-item-section\" :id=\"selectorId\" ref=\"selectorWrapper\"></div>\n\t`\n});\n","import {ajax, Cache, Dom, Loc, Tag, Text, Type} from 'main.core';\nimport {Vue} from \"ui.vue\";\nimport {config} from \"../../config\";\nimport type {BaseEvent} from \"main.core.events\";\nimport {EventEmitter} from 'main.core.events';\nimport {Dialog, TagSelector} from \"ui.entity-selector\";\n\nVue.component(config.templateFieldBrand,\n{\n\t/**\n\t * @emits 'changeBrand' {values: Array<any>}\n\t */\n\n\tprops: {\n\t\tbrands: [Array, String],\n\t\toptions: Object,\n\t\teditable: Boolean,\n\t\thasError: Boolean,\n\t\tselectorId: String,\n\t},\n\tdata()\n\t{\n\t\treturn {\n\t\t\tcache: new Cache.MemoryCache(),\n\t\t}\n\t},\n\tcreated()\n\t{\n\t\tif (this.editable)\n\t\t{\n\t\t\tthis.selector = new TagSelector({\n\t\t\t\tid: this.selectorId,\n\t\t\t\tdialogOptions: {\n\t\t\t\t\tid: this.selectorId,\n\t\t\t\t\tcontext: 'CATALOG_BRANDS',\n\t\t\t\t\t// enableSearch: true,\n\t\t\t\t\tpreselectedItems: this.getPreselectedBrands(),\n\t\t\t\t\tevents: {\n\t\t\t\t\t\t'Item:onSelect': this.onBrandChange.bind(this),\n\t\t\t\t\t\t'Item:onDeselect': this.onBrandChange.bind(this),\n\t\t\t\t\t\t'Search:onItemCreateAsync': this.createBrand.bind(this)\n\t\t\t\t\t},\n\t\t\t\t\tsearchTabOptions: {\n\t\t\t\t\t\tstub: true,\n\t\t\t\t\t\tstubOptions: {\n\t\t\t\t\t\t\ttitle: Tag.message`${'CATALOG_FORM_BRAND_SELECTOR_IS_EMPTY_TITLE'}`,\n\t\t\t\t\t\t\tsubtitle: Tag.message`${'CATALOG_FORM_BRAND_SELECTOR_IS_EMPTY_SUBTITLE'}`,\n\t\t\t\t\t\t\tarrow: true\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tsearchOptions: {\n\t\t\t\t\t\tallowCreateItem: true\n\t\t\t\t\t},\n\t\t\t\t\tentities: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tid: 'brand',\n\t\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\t\tiblockId: this.options.iblockId,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tdynamicSearch: true,\n\t\t\t\t\t\t\tdynamicLoad: true\n\t\t\t\t\t\t},\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t});\n\t\t\tthis.isSelectedByProductChange = false;\n\n\t\t\tthis.$parent.$on('onInlineSelectorProductChange', this.selectCurrentBrands.bind(this));\n\t\t}\n\t},\n\tmounted()\n\t{\n\t\tif (this.editable)\n\t\t{\n\t\t\tthis.selector.renderTo(this.$refs.brandSelectorWrapper);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.brands.forEach((brand, brandIndex, brands) => {\n\t\t\t\tconst separator = (brandIndex < brands.length - 1) ? ',&nbsp;' : '';\n\t\t\t\tthis.$refs.brandSelectorWrapper.appendChild(Tag.render`\n\t\t\t\t\t<span>\n\t\t\t\t\t\t<span\n\t\t\t\t\t\t\tclass=\"catalog-pf-product-input-brand-read-only-item\"\n\t\t\t\t\t\t\tstyle=\"background-image:url('${brand['IMAGE_SRC']}');\"\n\t\t\t\t\t\t></span>\n\t\t\t\t\t\t${brand['NAME'] + separator}\n\t\t\t\t\t</span>\n\t\t\t\t`);\n\t\t\t});\n\t\t}\n\t},\n\tmethods:\n\t{\n\t\tselectCurrentBrands(brands: Array)\n\t\t{\n\t\t\tthis.isSelectedByProductChange = true;\n\t\t\tthis.brands = brands;\n\t\t\tif (this.selector.getDialog().isLoaded())\n\t\t\t{\n\t\t\t\tthis.selector.getDialog().deselectAll();\n\t\t\t\tthis.selectDialogItems();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.selector.getDialog().load();\n\t\t\t\tEventEmitter.subscribe(this.selector.getDialog(), 'onLoad', this.selectDialogItems.bind(this));\n\t\t\t}\n\t\t},\n\t\tselectDialogItems()\n\t\t{\n\t\t\tthis.brands.forEach(brand => {\n\t\t\t\tconst item = this.selector.getDialog().getItem({id: brand['VALUE'], entityId: 'brand'});\n\t\t\t\titem.select();\n\t\t\t});\n\t\t\tthis.isSelectedByProductChange = false;\n\t\t},\n\t\tgetPreselectedBrands()\n\t\t{\n\t\t\tif (!Type.isArray(this.brands) || this.brands.length === 0)\n\t\t\t{\n\t\t\t\treturn [];\n\t\t\t}\n\n\t\t\treturn this.brands.map((item) => {\n\t\t\t\treturn ['brand', item['VALUE']]\n\t\t\t});\n\t\t},\n\t\tonBrandChange(event: BaseEvent)\n\t\t{\n\t\t\tconst items = event.getTarget().getSelectedItems();\n\t\t\tconst resultValues = [];\n\t\t\tif (Type.isArray(items))\n\t\t\t{\n\t\t\t\titems.forEach((item) => {\n\t\t\t\t\tresultValues.push({\n\t\t\t\t\t\t'VALUE': item.getId(),\n\t\t\t\t\t\t'NAME': item.getTitle(),\n\t\t\t\t\t\t'IMAGE_SRC': item.getAvatar(),\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tconst eventData = {\n\t\t\t\tresultValues: resultValues,\n\t\t\t\tisSelectedByProductChange: this.isSelectedByProductChange,\n\t\t\t};\n\n\t\t\tthis.$emit('changeBrand', eventData);\n\t\t},\n\t\tcreateBrand(event): Promise\n\t\t{\n\t\t\tconst {searchQuery} = event.getData();\n\t\t\tconst iblockId = this.options.iblockId;\n\n\t\t\treturn new Promise(\n\t\t\t\t(resolve, reject) => {\n\t\t\t\t\tconst dialog: Dialog = event.getTarget();\n\t\t\t\t\tconst fields = {\n\t\t\t\t\t\tname: searchQuery.getQuery(),\n\t\t\t\t\t\tiblockId,\n\t\t\t\t\t};\n\n\t\t\t\t\tdialog.showLoader();\n\t\t\t\t\tajax.runAction(\n\t\t\t\t\t\t'catalog.productForm.createBrand',\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\tfields\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t)\n\t\t\t\t\t\t.then(response => {\n\t\t\t\t\t\t\tdialog.hideLoader();\n\t\t\t\t\t\t\tconst item = dialog.addItem({\n\t\t\t\t\t\t\t\tid: response.data.id,\n\t\t\t\t\t\t\t\tentityId: 'brand',\n\t\t\t\t\t\t\t\ttitle: searchQuery.getQuery(),\n\t\t\t\t\t\t\t\ttabs: dialog.getRecentTab().getId(),\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\tif (item)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\titem.select();\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tdialog.hide();\n\t\t\t\t\t\t\tresolve();\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.catch(() => reject());\n\t\t\t\t});\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tlocalize()\n\t\t{\n\t\t\treturn Vue.getFilteredPhrases('CATALOG_');\n\t\t},\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"catalog-pf-product-control ui-ctl-w100\" v-bind:class=\"{ 'ui-ctl-danger': hasError }\">\n\t\t\t<div class=\"catalog-pf-product-input-wrapper\" ref=\"brandSelectorWrapper\" :id=\"selectorId\"></div>\n\t\t</div>\n\t`\n});\n","import {Runtime, Text} from 'main.core';\nimport {Vue} from \"ui.vue\";\nimport {config} from \"../../config\";\nimport type {BaseEvent} from \"main.core.events\";\n\nVue.component(config.templateFieldResultSum,\n{\n\t/**\n\t * @emits 'onChangeSum' {sum: number}\n\t */\n\n\tprops: {\n\t\tsum: Number,\n\t\teditable: Boolean,\n\t\toptions: Object,\n\t},\n\tcreated()\n\t{\n\t\tthis.onInputSumHandler = Runtime.debounce(this.onInputSum, 500, this);\n\t},\n\tmethods:\n\t{\n\t\tonInputSum(event: BaseEvent): void\n\t\t{\n\t\t\tif (!this.editable)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tevent.target.value = event.target.value.replace(/[^.,\\d]/g,'');\n\t\t\tif (event.target.value === '')\n\t\t\t{\n\t\t\t\tevent.target.value = 0;\n\t\t\t}\n\t\t\tconst lastSymbol = event.target.value.substr(-1);\n\t\t\tif (lastSymbol === ',')\n\t\t\t{\n\t\t\t\tevent.target.value = event.target.value.replace(',', \".\");\n\t\t\t}\n\t\t\tlet newSum = Text.toNumber(event.target.value);\n\t\t\tif (lastSymbol === '.' || lastSymbol === ',')\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (newSum < 0)\n\t\t\t{\n\t\t\t\tnewSum *= -1;\n\t\t\t}\n\n\t\t\tthis.$emit('onChangeSum', newSum);\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tlocalize()\n\t\t{\n\t\t\treturn Vue.getFilteredPhrases('CATALOG_');\n\t\t},\n\t\tcurrencySymbol()\n\t\t{\n\t\t\treturn this.options.currencySymbol || '';\n\t\t},\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"catalog-pf-product-input-wrapper\">\n\t\t\t<input \ttype=\"text\" \n\t\t\t\t\tclass=\"catalog-pf-product-input catalog-pf-product-input--align-right\"\n\t\t\t\t\t:class=\"{ 'catalog-pf-product-input--disabled': !editable }\"\n\t\t\t\t\t:value=\"sum\"\n\t\t\t\t\t@input=\"onInputSumHandler\"\n\t\t\t\t\t:disabled=\"!editable\"\n\t\t\t>\n\t\t\t<div class=\"catalog-pf-product-input-info\"\n\t\t\t\t :class=\"{ 'catalog-pf-product-input--disabled': !editable }\"\n\t\t\t\t v-html=\"currencySymbol\"\n\t\t\t></div>\n\t\t</div>\n\t`\n});","import {config} from \"../config\";\nimport {Vue} from \"ui.vue\";\nimport {Text, Type, Tag, Loc, Event} from \"main.core\";\nimport {EventEmitter} from \"main.core.events\";\n\nimport \"catalog.product-selector\";\nimport \"ui.common\";\nimport \"ui.alerts\";\nimport \"ui.notification\";\nimport {ProductCalculator, DiscountType, FieldScheme} from \"catalog.product-calculator\";\nimport {FormInputCode} from \"../types/form-input-code\";\nimport {FormErrorCode} from \"../types/form-error-code\";\nimport {FormMode} from \"../types/form-mode\";\nimport \"./fields/quantity\";\nimport \"./fields/price\";\nimport \"./fields/discount\";\nimport \"./fields/tax\";\nimport \"./fields/inline-selector\";\nimport \"./fields/brand\";\nimport \"./fields/result-sum\";\nimport {ProductModel} from \"catalog.product-model\";\n\n\nVue.component(config.templateRowName,\n\t{\n\t\t/**\n\t\t * @emits 'changeProduct' {index: number, fields: object}\n\t\t * @emits 'changeRowData' {index: number, fields: object}\n\t\t * @emits 'emitErrorsChange' {index: number, errors: object}\n\t\t * @emits 'refreshBasket'\n\t\t * @emits 'removeItem' {index: number}\n\t\t */\n\n\t\tprops: {\n\t\t\tbasketItem: Object,\n\t\t\tbasketItemIndex: Number,\n\t\t\tbasketLength: Number,\n\t\t\tcountItems: Number,\n\t\t\toptions: Object,\n\t\t\tmode: String,\n\t\t},\n\n\t\tdata()\n\t\t{\n\t\t\treturn {\n\t\t\t\tmodel: null,\n\t\t\t\tcurrencySymbol: null,\n\t\t\t\tproductSelector: null,\n\t\t\t\timageControlId: null,\n\t\t\t\tselectorId: this.basketItem.selectorId,\n\t\t\t\tdefaultMeasure: {\n\t\t\t\t\tname: '',\n\t\t\t\t\tid: null,\n\t\t\t\t},\n\t\t\t\tblocks: {\n\t\t\t\t\tproductSelector: FormInputCode.PRODUCT_SELECTOR,\n\t\t\t\t\tquantity: FormInputCode.QUANTITY,\n\t\t\t\t\tprice: FormInputCode.PRICE,\n\t\t\t\t\tresult: FormInputCode.RESULT,\n\t\t\t\t\tdiscount: FormInputCode.DISCOUNT,\n\t\t\t\t\ttax: FormInputCode.TAX,\n\t\t\t\t\tbrand: FormInputCode.BRAND,\n\t\t\t\t\tmeasure: FormInputCode.MEASURE,\n\t\t\t\t},\n\t\t\t\terrorCodes: {\n\t\t\t\t\temptyProductSelector: FormErrorCode.EMPTY_PRODUCT_SELECTOR,\n\t\t\t\t\temptyImage: FormErrorCode.EMPTY_IMAGE,\n\t\t\t\t\temptyQuantity: FormErrorCode.EMPTY_QUANTITY,\n\t\t\t\t\temptyPrice: FormErrorCode.EMPTY_PRICE,\n\t\t\t\t\temptyBrand: FormErrorCode.EMPTY_BRAND,\n\t\t\t\t}\n\t\t\t};\n\t\t},\n\t\tcreated()\n\t\t{\n\t\t\tthis.currencySymbol = this.options.currencySymbol;\n\n\t\t\tthis.model = this.initModel();\n\t\t\tif (Type.isArray(this.options.measures))\n\t\t\t{\n\t\t\t\tthis.options.measures.map((measure) => {\n\t\t\t\t\tif (measure['IS_DEFAULT'] === 'Y')\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.defaultMeasure.name = measure.SYMBOL;\n\t\t\t\t\t\tthis.defaultMeasure.code = measure.CODE;\n\n\t\t\t\t\t\tif (!this.basketItem.fields.measureName && !this.basketItem.fields.measureCode)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.changeProductFields({\n\t\t\t\t\t\t\t\tmeasureCode: this.defaultMeasure.code,\n\t\t\t\t\t\t\t\tmeasureName: this.defaultMeasure.name\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\tmethods:\n\t\t\t{\n\t\t\t\tprepareModelFields(): {}\n\t\t\t\t{\n\t\t\t\t\tconst defaultFields = this.basketItem.fields;\n\t\t\t\t\tconst defaultPrice = Text.toNumber(defaultFields.price);\n\t\t\t\t\tlet basePrice = defaultFields.basePrice ? defaultFields.basePrice : defaultFields.price;\n\t\t\t\t\tif (!Type.isNil(basePrice))\n\t\t\t\t\t{\n\t\t\t\t\t\tbasePrice = Text.toNumber(basePrice);\n\t\t\t\t\t}\n\t\t\t\t\treturn {\n\t\t\t\t\t\tNAME: this.basketItem.fields?.name || '',\n\t\t\t\t\t\tMODULE: this.basketItem.fields?.module || '',\n\t\t\t\t\t\tPROPERTIES: this.basketItem.fields?.properties || {},\n\t\t\t\t\t\tBRAND: this.basketItem.fields?.brand || {},\n\t\t\t\t\t\tPRODUCT_ID: this.basketItem.fields?.productId,\n\t\t\t\t\t\tID: this.basketItem.fields?.skuId || this.basketItem.fields?.productId,\n\t\t\t\t\t\tSKU_ID: this.basketItem.fields?.skuId,\n\t\t\t\t\t\tQUANTITY: Text.toNumber(defaultFields.quantity),\n\t\t\t\t\t\tBASE_PRICE: basePrice,\n\t\t\t\t\t\tPRICE: defaultPrice,\n\t\t\t\t\t\tPRICE_NETTO: basePrice,\n\t\t\t\t\t\tPRICE_BRUTTO: defaultPrice,\n\t\t\t\t\t\tPRICE_EXCLUSIVE: this.basketItem.fields.priceExclusive || defaultPrice,\n\t\t\t\t\t\tDISCOUNT_TYPE_ID: Text.toNumber(defaultFields.discountType) || DiscountType.PERCENTAGE,\n\t\t\t\t\t\tDISCOUNT_RATE: Text.toNumber(defaultFields.discountRate),\n\t\t\t\t\t\tDISCOUNT_SUM: Text.toNumber(defaultFields.discount),\n\t\t\t\t\t\tTAX_INCLUDED: defaultFields.taxIncluded || this.options.taxIncluded,\n\t\t\t\t\t\tTAX_RATE: defaultFields.tax || 0,\n\t\t\t\t\t\tCUSTOMIZED: defaultFields.isCustomPrice || 'N',\n\t\t\t\t\t\tMEASURE_CODE: defaultFields.measureCode || this.defaultMeasure.code,\n\t\t\t\t\t\tMEASURE_NAME: defaultFields.measureName || this.defaultMeasure.name,\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tinitModel(): ProductModel\n\t\t\t\t{\n\t\t\t\t\tconst productId = Text.toNumber(this.basketItem.fields?.productId);\n\t\t\t\t\tconst skuId = Text.toNumber(this.basketItem.fields?.skuId);\n\t\t\t\t\tconst model = new ProductModel(\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tiblockId: Text.toNumber(this.options.iblockId),\n\t\t\t\t\t\t\tbasePriceId: Text.toNumber(this.options.basePriceId),\n\t\t\t\t\t\t\tcurrency: this.options.currency,\n\t\t\t\t\t\t\tisSimpleModel: (\n\t\t\t\t\t\t\t\tType.isStringFilled(this.basketItem.fields?.name)\n\t\t\t\t\t\t\t\t&& productId <= 0\n\t\t\t\t\t\t\t\t&& skuId <= 0\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\tfields: this.prepareModelFields(),\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\n\t\t\t\t\tEventEmitter.subscribe(model, 'onErrorsChange', this.onErrorsChange);\n\n\t\t\t\t\treturn model;\n\t\t\t\t},\n\t\t\t\tonErrorsChange()\n\t\t\t\t{\n\t\t\t\t\tconst errors = Object.values(this.model.getErrorCollection().getErrors());\n\t\t\t\t\tthis.changeRowData({errors});\n\t\t\t\t\tthis.$emit('emitErrorsChange', {\n\t\t\t\t\t\tindex: this.basketItemIndex,\n\t\t\t\t\t\terrors,\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tsetCalculatedFields(fields: {}): void\n\t\t\t\t{\n\t\t\t\t\tthis.model.getCalculator().setFields(fields);\n\t\t\t\t\tconst map = {calculatedFields: fields};\n\t\t\t\t\tif (Text.toNumber(fields.SUM) >= 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tmap.sum = Text.toNumber(fields.SUM);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!Type.isNil(fields.ID))\n\t\t\t\t\t{\n\t\t\t\t\t\tmap.offerId = Text.toNumber(fields.ID);\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.changeRowData(map);\n\t\t\t\t},\n\t\t\t\tgetProductFieldsFromModel()\n\t\t\t\t{\n\t\t\t\t\tconst modelFields = this.model.getFields();\n\t\t\t\t\treturn {\n\t\t\t\t\t\tproductId: modelFields.PRODUCT_ID,\n\t\t\t\t\t\tskuId: modelFields.SKU_ID,\n\t\t\t\t\t\tname: modelFields.NAME,\n\t\t\t\t\t\tmodule: modelFields.MODULE,\n\t\t\t\t\t\tbasePrice: modelFields.BASE_PRICE,\n\t\t\t\t\t\tprice: modelFields.PRICE,\n\t\t\t\t\t\tpriceExclusive: modelFields.PRICE_EXCLUSIVE,\n\t\t\t\t\t\tquantity: modelFields.QUANTITY,\n\t\t\t\t\t\tdiscountRate: modelFields.DISCOUNT_RATE,\n\t\t\t\t\t\tdiscount: modelFields.DISCOUNT_SUM,\n\t\t\t\t\t\tdiscountType: modelFields.DISCOUNT_TYPE_ID,\n\t\t\t\t\t\tisCustomPrice: modelFields.CUSTOMIZED || 'N',\n\t\t\t\t\t\tmeasureCode: modelFields.MEASURE_CODE || '',\n\t\t\t\t\t\tmeasureName: modelFields.MEASURE_NAME || '',\n\t\t\t\t\t\tproperties: modelFields.PROPERTIES || {},\n\t\t\t\t\t\tbrands: modelFields.BRANDS || [],\n\t\t\t\t\t\ttaxId: modelFields.TAX_ID,\n\t\t\t\t\t\tmorePhoto: modelFields.MORE_PHOTO,\n\t\t\t\t\t};\n\t\t\t\t},\n\t\t\t\tchangeRowData(product: {}): void\n\t\t\t\t{\n\t\t\t\t\tthis.$emit('changeRowData', {\n\t\t\t\t\t\tindex: this.basketItemIndex,\n\t\t\t\t\t\tproduct\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tchangeProductFields(fields: {}): void\n\t\t\t\t{\n\t\t\t\t\tfields = Object.assign(this.basketItem.fields, fields);\n\t\t\t\t\tthis.$emit('changeProduct', {\n\t\t\t\t\t\tindex: this.basketItemIndex,\n\t\t\t\t\t\tproduct: {fields},\n\t\t\t\t\t\tskipFieldChecking: this.model.isSimple() && this.basketLength === 1,\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tsaveCatalogField(changedFields: []): ?Promise\n\t\t\t\t{\n\t\t\t\t\treturn this.model.save(changedFields);\n\t\t\t\t},\n\t\t\t\tonProductChange(fields: {})\n\t\t\t\t{\n\t\t\t\t\tfields = Object.assign(\n\t\t\t\t\t\tthis.model.getCalculator().calculateBasePrice(fields.BASE_PRICE),\n\t\t\t\t\t\tfields\n\t\t\t\t\t);\n\n\t\t\t\t\tthis.changeRowData(\n\t\t\t\t\t\t{catalogPrice: fields.BASE_PRICE}\n\t\t\t\t\t);\n\t\t\t\t\tthis.processFields(fields);\n\t\t\t\t\tthis.setCalculatedFields(fields);\n\t\t\t\t\tthis.$emit('onInlineSelectorProductChange', this.basketItem.fields.brands);\n\t\t\t\t},\n\t\t\t\tonProductSelect()\n\t\t\t\t{\n\t\t\t\t\tthis.changeProductFields({\n\t\t\t\t\t\tadditionalFields: {\n\t\t\t\t\t\t\toriginBasketId: '',\n\t\t\t\t\t\t\toriginProductId: '',\n\t\t\t\t\t\t},\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tonProductClear()\n\t\t\t\t{\n\t\t\t\t\tif (Type.isPlainObject(this.options.facebookFailProducts))\n\t\t\t\t\t{\n\t\t\t\t\t\tdelete this.options.facebookFailProducts[this.basketItem.offerId];\n\t\t\t\t\t}\n\t\t\t\t\t/*const fields = this.model.getCalculator().calculatePrice(0);\n\n\t\t\t\t\tfields.BASE_PRICE = 0;\n\t\t\t\t\tfields.NAME = '';\n\t\t\t\t\tfields.ID = 0;\n\t\t\t\t\tfields.PRODUCT_ID = 0;\n\t\t\t\t\tfields.SKU_ID = 0;\n\t\t\t\t\tfields.MODULE = '';\n\n\t\t\t\t\tthis.setCalculatedFields(fields);*/\n\t\t\t\t},\n\t\t\t\tonChangeSum(sum: number)\n\t\t\t\t{\n\t\t\t\t\tconst priceItem = (sum / Text.toNumber(this.basketItem.fields.quantity));\n\t\t\t\t\tif (this.isEditablePrice())\n\t\t\t\t\t{\n\t\t\t\t\t\tconst price = priceItem + Text.toNumber(this.basketItem.fields.discount);\n\t\t\t\t\t\tthis.onChangePrice(price);\n\t\t\t\t\t}\n\t\t\t\t\telse if (this.isEditableDiscount())\n\t\t\t\t\t{\n\t\t\t\t\t\tconst discount = this.basketItem.fields.basePrice - priceItem;\n\t\t\t\t\t\tthis.toggleDiscount('Y');\n\t\t\t\t\t\tthis.changeDiscountType(DiscountType.MONETARY);\n\t\t\t\t\t\tthis.changeDiscount(discount);\n\t\t\t\t\t}\n\n\t\t\t\t},\n\t\t\t\tonChangePrice(newPrice)\n\t\t\t\t{\n\t\t\t\t\tthis.changeBasePrice(newPrice);\n\t\t\t\t\tif (this.isSaveablePrice())\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.saveCatalogField(['BASE_PRICE']).then(()=>{\n\t\t\t\t\t\t\tthis.changeRowData(\n\t\t\t\t\t\t\t\t{catalogPrice: newPrice}\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tonSelectMeasure(measure: {})\n\t\t\t\t{\n\t\t\t\t\tthis.changeMeasure(measure);\n\t\t\t\t\tthis.model.showSaveNotifier(\n\t\t\t\t\t\t'measureChanger_' + this.selectorId,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttitle: Loc.getMessage('CATALOG_PRODUCT_MODEL_SAVING_NOTIFICATION_MEASURE_CHANGED_QUERY'),\n\t\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\t\tonSave: () => {\n\t\t\t\t\t\t\t\t\tthis.saveCatalogField(['MEASURE_CODE', 'MEASURE_NAME']);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t},\n\t\t\t\ttoggleDiscount(value: string): void\n\t\t\t\t{\n\t\t\t\t\tif (this.isReadOnly)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.changeRowData(\n\t\t\t\t\t\t{showDiscount: value}\n\t\t\t\t\t);\n\n\t\t\t\t\tif (value === 'Y')\n\t\t\t\t\t{\n\t\t\t\t\t\tsetTimeout(\n\t\t\t\t\t\t\t() => this.$refs?.discountWrapper?.$refs?.discountInput?.focus()\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\ttoggleTax(value: string): void\n\t\t\t\t{\n\t\t\t\t\tthis.changeRowData(\n\t\t\t\t\t\t{showTax: value}\n\t\t\t\t\t);\n\t\t\t\t},\n\t\t\t\tprocessFields(fields: {}): void\n\t\t\t\t{\n\t\t\t\t\tthis.model.getCalculator().setFields(fields);\n\t\t\t\t\tthis.model.setFields(fields);\n\t\t\t\t\tthis.changeProductFields({...this.basketItem.fields, ...this.getProductFieldsFromModel()});\n\n\t\t\t\t\tif (!Type.isNil(fields.SUM))\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.changeRowData({sum: fields.SUM});\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tchangeBrand(eventData): void\n\t\t\t\t{\n\t\t\t\t\tconst brands = Type.isArray(eventData.resultValues) ? eventData.resultValues : [];\n\t\t\t\t\tconst isSelectedByProductChange = eventData.isSelectedByProductChange;\n\t\t\t\t\tthis.processFields({ BRANDS: brands });\n\n\t\t\t\t\tif (!isSelectedByProductChange)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.saveCatalogField(['BRANDS']);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tonChangeQuantity(quantity: number): void\n\t\t\t\t{\n\t\t\t\t\tthis.model.getCalculator().setFields();\n\t\t\t\t\tthis.processFields(\n\t\t\t\t\t\tthis.model.getCalculator().calculateQuantity(quantity)\n\t\t\t\t\t);\n\t\t\t\t},\n\t\t\t\tchangeMeasure(measure: {}): void\n\t\t\t\t{\n\t\t\t\t\tconst productFields = this.basketItem.fields;\n\t\t\t\t\tproductFields['measureCode'] = measure.code;\n\t\t\t\t\tproductFields['measureName'] = measure.name;\n\t\t\t\t\tthis.processFields({\n\t\t\t\t\t\tMEASURE_CODE: measure.code,\n\t\t\t\t\t\tMEASURE_NAME: measure.name,\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tchangeBasePrice(price: number): void\n\t\t\t\t{\n\t\t\t\t\tthis.model.setField('BASE_PRICE', price);\n\t\t\t\t\tthis.processFields(\n\t\t\t\t\t\tthis.model.getCalculator().calculateBasePrice(price)\n\t\t\t\t\t);\n\t\t\t\t},\n\t\t\t\tchangePrice(price: number): FieldScheme\n\t\t\t\t{\n\t\t\t\t\tthis.model.getCalculator().setFields(\n\t\t\t\t\t\tthis.model.getCalculator().calculateBasePrice(this.basketItem.catalogPrice)\n\t\t\t\t\t);\n\t\t\t\t\tconst calculatedFields = this.model.getCalculator().calculatePrice(price);\n\t\t\t\t\tthis.processFields(calculatedFields);\n\t\t\t\t\treturn calculatedFields;\n\t\t\t\t},\n\t\t\t\tchangeDiscountType(discountType: string): FieldScheme\n\t\t\t\t{\n\t\t\t\t\tconst type = (Text.toNumber(discountType) === DiscountType.MONETARY) ?  DiscountType.MONETARY : DiscountType.PERCENTAGE;\n\t\t\t\t\tconst calculatedFields = this.model.getCalculator().calculateDiscountType(type);\n\t\t\t\t\tthis.processFields(calculatedFields);\n\t\t\t\t\treturn calculatedFields;\n\t\t\t\t},\n\t\t\t\tchangeDiscount(discount: number): FieldScheme\n\t\t\t\t{\n\t\t\t\t\tconst calculatedFields = this.model.getCalculator().calculateDiscount(discount);\n\t\t\t\t\tthis.processFields(calculatedFields);\n\t\t\t\t\treturn  calculatedFields;\n\t\t\t\t},\n\t\t\t\tchangeTax(fields)\n\t\t\t\t{\n\t\t\t\t\tconst calculatedFields = this.model.getCalculator().calculateTax(fields.taxValue);\n\t\t\t\t\tcalculatedFields.TAX_ID = fields.taxId;\n\t\t\t\t\tthis.processFields(calculatedFields)\n\t\t\t\t\treturn  calculatedFields;\n\t\t\t\t},\n\t\t\t\tchangeTaxIncluded(taxIncluded)\n\t\t\t\t{\n\t\t\t\t\tif (taxIncluded === this.basketItem.taxIncluded || !this.isEditableField(this.blocks.tax))\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst calculatedFields = this.model.getCalculator().calculateTaxIncluded(taxIncluded);\n\t\t\t\t\tthis.processFields(calculatedFields)\n\t\t\t\t\treturn  calculatedFields;\n\t\t\t\t},\n\t\t\t\tremoveItem()\n\t\t\t\t{\n\t\t\t\t\tif (Type.isPlainObject(this.options.facebookFailProducts))\n\t\t\t\t\t{\n\t\t\t\t\t\tdelete this.options.facebookFailProducts[this.basketItem.offerId];\n\t\t\t\t\t}\n\t\t\t\t\tthis.$emit('removeItem', {\n\t\t\t\t\t\tindex: this.basketItemIndex\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tisRequiredField(code: string): boolean\n\t\t\t\t{\n\t\t\t\t\treturn Type.isArray(this.options.requiredFields) && this.options.requiredFields.includes(code);\n\t\t\t\t},\n\t\t\t\tisVisibleBlock(code): boolean\n\t\t\t\t{\n\t\t\t\t\treturn Type.isArray(this.options.visibleBlocks) && this.options.visibleBlocks.includes(code)\n\t\t\t\t},\n\t\t\t\tgetPriceValue()\n\t\t\t\t{\n\t\t\t\t\treturn this.isEditableField(this.blocks.price)\n\t\t\t\t\t\t? this.basketItem.fields.basePrice\n\t\t\t\t\t\t: this.basketItem.catalogPrice\n\t\t\t\t\t;\n\t\t\t\t},\n\t\t\t\tgetQuantityValue()\n\t\t\t\t{\n\t\t\t\t\treturn this.isEditableField(this.blocks.quantity)\n\t\t\t\t\t\t? this.basketItem.fields.quantity\n\t\t\t\t\t\t: 1\n\t\t\t\t\t;\n\t\t\t\t},\n\t\t\t\tgetSumValue()\n\t\t\t\t{\n\t\t\t\t\treturn this.isEditableField(this.blocks.result)\n\t\t\t\t\t\t? this.basketItem.sum\n\t\t\t\t\t\t: this.basketItem.catalogPrice\n\t\t\t\t\t;\n\t\t\t\t},\n\t\t\t\tgetDiscountValue()\n\t\t\t\t{\n\t\t\t\t\treturn this.isEditableField(this.blocks.discount)\n\t\t\t\t\t\t? this.basketItem.fields.discount\n\t\t\t\t\t\t: 0\n\t\t\t\t\t;\n\t\t\t\t},\n\t\t\t\tgetDiscountRateValue()\n\t\t\t\t{\n\t\t\t\t\treturn this.isEditableField(this.blocks.discount)\n\t\t\t\t\t\t? this.basketItem.fields.discountRate\n\t\t\t\t\t\t: 0\n\t\t\t\t\t;\n\t\t\t\t},\n\t\t\t\thasError(code): boolean\n\t\t\t\t{\n\t\t\t\t\tif (this.basketItem.errors.length === 0 || (this.model.isEmpty() && !this.model.isChanged()))\n\t\t\t\t\t{\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst filteredErrors = this.basketItem.errors.filter((error) => {\n\t\t\t\t\t\treturn error.code === code\n\t\t\t\t\t});\n\n\t\t\t\t\treturn filteredErrors.length > 0;\n\t\t\t\t},\n\t\t\t\tisEditablePrice(): boolean\n\t\t\t\t{\n\t\t\t\t\treturn this.options?.editableFields.includes(FormInputCode.PRICE)\n\t\t\t\t\t\t&& (\n\t\t\t\t\t\t\tthis.model.isNew()\n\t\t\t\t\t\t\t|| !this.model.isCatalogExisted()\n\t\t\t\t\t\t\t|| this.options?.isCatalogPriceEditEnabled\n\t\t\t\t\t\t)\n\t\t\t\t\t;\n\t\t\t\t},\n\t\t\t\tisEditableDiscount(): boolean\n\t\t\t\t{\n\t\t\t\t\treturn this.options?.isCatalogDiscountSetEnabled;\n\t\t\t\t},\n\t\t\t\tisSaveablePrice(): boolean\n\t\t\t\t{\n\t\t\t\t\treturn this.options.isCatalogPriceEditEnabled\n\t\t\t\t\t\t&& this.options.isCatalogPriceSaveEnabled\n\t\t\t\t\t\t&& this.model.isNew()\n\t\t\t\t\t;\n\t\t\t\t},\n\t\t\t\tisEditableField(code): boolean\n\t\t\t\t{\n\t\t\t\t\tif (code === FormInputCode.PRICE && !this.isEditablePrice())\n\t\t\t\t\t{\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t\telse if (code === FormInputCode.DISCOUNT && !this.isEditableDiscount())\n\t\t\t\t\t{\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t\telse if (\n\t\t\t\t\t\tcode === FormInputCode.RESULT\n\t\t\t\t\t\t&& !this.options?.isCatalogDiscountSetEnabled\n\t\t\t\t\t\t&& !this.isEditablePrice()\n\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn this.options?.editableFields.includes(code);\n\t\t\t\t},\n\t\t\t\tgetHint(code): ?{}\n\t\t\t\t{\n\t\t\t\t\treturn this.options?.fieldHints[code];\n\t\t\t\t},\n\t\t\t\thasHint(code): boolean\n\t\t\t\t{\n\t\t\t\t\tif (code === FormInputCode.PRICE && !this.options?.isCatalogPriceEditEnabled)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn !this.isEditablePrice();\n\t\t\t\t\t}\n\n\t\t\t\t\treturn false;\n\t\t\t\t},\n\t\t\t},\n\t\twatch:\n\t\t\t{\n\t\t\t\ttaxIncluded(value, oldValue){\n\t\t\t\t\tif (value !== oldValue)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.changeTaxIncluded(value);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\tcomputed:\n\t\t\t{\n\t\t\t\tlocalize()\n\t\t\t\t{\n\t\t\t\t\treturn Vue.getFilteredPhrases('CATALOG_FORM_');\n\t\t\t\t},\n\t\t\t\tshowDiscount(): boolean\n\t\t\t\t{\n\t\t\t\t\treturn this.showDiscountBlock && this.basketItem.showDiscount === 'Y';\n\t\t\t\t},\n\t\t\t\tgetBrandsSelectorId(): string\n\t\t\t\t{\n\t\t\t\t\treturn this.basketItem.selectorId + '_brands';\n\t\t\t\t},\n\t\t\t\tgetPriceExclusive(): ?number\n\t\t\t\t{\n\t\t\t\t\treturn this.basketItem.fields.priceExclusive || this.basketItem.fields.price\n\t\t\t\t},\n\t\t\t\tshowDiscountBlock(): boolean\n\t\t\t\t{\n\t\t\t\t\treturn this.options.showDiscountBlock === 'Y'\n\t\t\t\t\t\t&& this.isVisibleBlock(this.blocks.discount)\n\t\t\t\t\t\t&& !this.isReadOnly\n\t\t\t\t\t;\n\t\t\t\t},\n\t\t\t\tshowTaxBlock(): boolean\n\t\t\t\t{\n\t\t\t\t\treturn this.options.showTaxBlock === 'Y'\n\t\t\t\t\t\t&& this.getTaxList.length > 0\n\t\t\t\t\t\t&& this.isVisibleBlock(this.blocks.tax)\n\t\t\t\t\t\t&& !this.isReadOnly\n\t\t\t\t\t;\n\t\t\t\t},\n\t\t\t\tshowRemoveIcon(): boolean\n\t\t\t\t{\n\t\t\t\t\tif (this.isReadOnly)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (this.countItems > 1)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn !Type.isNil(this.basketItem.offerId);\n\t\t\t\t},\n\t\t\t\tshowTaxSelector(): boolean\n\t\t\t\t{\n\t\t\t\t\treturn this.basketItem.showTax === 'Y';\n\t\t\t\t},\n\t\t\t\tshowBasePrice(): boolean\n\t\t\t\t{\n\t\t\t\t\treturn this.basketItem.fields.discount > 0\n\t\t\t\t\t\t|| (Text.toNumber(this.basketItem.fields.price) !== Text.toNumber(this.basketItem.fields.basePrice))\n\t\t\t\t\t;\n\t\t\t\t},\n\t\t\t\tgetMeasureName(): string\n\t\t\t\t{\n\t\t\t\t\treturn this.basketItem.fields.measureName || this.defaultMeasure.name;\n\t\t\t\t},\n\t\t\t\tgetMeasureCode(): string\n\t\t\t\t{\n\t\t\t\t\treturn this.basketItem.fields.measureCode || this.defaultMeasure.code;\n\t\t\t\t},\n\t\t\t\tgetTaxList(): []\n\t\t\t\t{\n\t\t\t\t\treturn Type.isArray(this.options.taxList) ? this.options.taxList : [];\n\t\t\t\t},\n\t\t\t\ttaxIncluded(): string\n\t\t\t\t{\n\t\t\t\t\treturn this.basketItem.fields.taxIncluded;\n\t\t\t\t},\n\t\t\t\tisTaxIncluded(): boolean\n\t\t\t\t{\n\t\t\t\t\treturn this.taxIncluded === 'Y';\n\t\t\t\t},\n\t\t\t\tisReadOnly(): boolean\n\t\t\t\t{\n\t\t\t\t\treturn this.mode === FormMode.READ_ONLY || this.mode === FormMode.COMPILATION_READ_ONLY;\n\t\t\t\t},\n\t\t\t\tgetErrorsText(): string\n\t\t\t\t{\n\t\t\t\t\tlet errorText = this.basketItem.errors.length !== 0 && !this.model.isEmpty() && this.model.isChanged()\n\t\t\t\t\t\t? Loc.getMessage('CATALOG_PRODUCT_MODEL_ERROR_NOTIFICATION')\n\t\t\t\t\t\t: ''\n\t\t\t\t\t;\n\t\t\t\t\tconst basketItemOfferId = this.basketItem.offerId;\n\t\t\t\t\tconst facebookFailProducts = this.options.facebookFailProducts;\n\t\t\t\t\tconst facebookFailProductErrorText = Type.isObject(facebookFailProducts)\n\t\t\t\t\t\t? facebookFailProducts[basketItemOfferId]\n\t\t\t\t\t\t: null\n\t\t\t\t\t;\n\n\t\t\t\t\tif (facebookFailProductErrorText)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (errorText)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\terrorText += '<br>';\n\t\t\t\t\t\t}\n\t\t\t\t\t\terrorText +=\n\t\t\t\t\t\t\tLoc.getMessage('CATALOG_FORM_FACEBOOK_ERROR')\n\t\t\t\t\t\t\t+ ':<br>'\n\t\t\t\t\t\t\t+ facebookFailProductErrorText\n\t\t\t\t\t\t;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn errorText;\n\t\t\t\t},\n\t\t\t\thasSku()\n\t\t\t\t{\n\t\t\t\t\treturn this.basketItem.skuTree !== '';\n\t\t\t\t},\n\t\t\t},\n\t\t// language=Vue\n\t\ttemplate: `\n\t\t<div>\n\t\t\t<div class=\"catalog-pf-product-item\" v-bind:class=\"{ 'catalog-pf-product-item--borderless': !isReadOnly && basketItemIndex === 0 }\">\n\t\t\t\t<div class=\"catalog-pf-product-item--remove\" @click=\"removeItem\" v-if=\"showRemoveIcon\"></div>\n\t\t\t\t<div class=\"catalog-pf-product-item--num\">\n\t\t\t\t\t<div class=\"catalog-pf-product-index\">{{basketItemIndex + 1}}</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"catalog-pf-product-item--left\">\n\t\t\t\t\t<div v-if=\"isVisibleBlock(blocks.productSelector)\">\n\t\t\t\t\t\t<div v-if=\"!this.isReadOnly\" class=\"catalog-pf-product-item-section\">\n\t\t\t\t\t\t\t<div class=\"catalog-pf-product-label\">{{localize.CATALOG_FORM_NAME}}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<${config.templateFieldInlineSelector}\n\t\t\t\t\t\t\t:basketItem=\"basketItem\"\n\t\t\t\t\t\t\t:basketLength=\"basketLength\"\n\t\t\t\t\t\t\t:options=\"options\"\n\t\t\t\t\t\t\t:model=\"model\"\n\t\t\t\t\t\t\t:editable=\"isEditableField(blocks.productSelector)\"\n\t\t\t\t\t\t\t@onProductChange=\"onProductChange\"\n\t\t\t\t\t\t\t@onProductSelect=\"onProductSelect\"\n\t\t\t\t\t\t\t@onProductClear=\"onProductClear\"\n\t\t\t\t\t\t\t@saveCatalogField=\"saveCatalogField\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div\n\t\t\t\t\t\tv-if=\"isVisibleBlock(blocks.brand)\"\n\t\t\t\t\t\tclass=\"catalog-pf-product-input-brand-wrapper\"\n\t\t\t\t\t\tv-bind:class=\"[\n\t\t\t\t\t\t\t{ 'catalog-pf-product-input-brand-wrapper-readonly': this.isReadOnly},\n\t\t\t\t\t\t\t{ 'catalog-pf-product-input-brand-wrapper-readonly-no-sku': this.isReadOnly && !this.hasSku}\n\t\t\t\t\t\t]\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<div class=\"catalog-pf-product-item-section\">\n\t\t\t\t\t\t\t<div class=\"catalog-pf-product-label\">{{localize.CATALOG_FORM_BRAND_TITLE}}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<${config.templateFieldBrand}\n\t\t\t\t\t\t\t:brands=\"basketItem.fields.brands\"\n\t\t\t\t\t\t\t:selectorId=\"getBrandsSelectorId\"\n\t\t\t\t\t\t\t:hasError=\"hasError(errorCodes.emptyBrand)\"\n\t\t\t\t\t\t\t:options=\"options\"\n\t\t\t\t\t\t\t:editable=\"isEditableField(blocks.brand)\"\n\t\t\t\t\t\t\t@changeBrand=\"changeBrand\"\n\t\t\t\t\t\t\t@saveCatalogField=\"saveCatalogField\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<div v-if=\"hasError(errorCodes.emptyBrand)\" class=\"catalog-pf-product-item-section\">\n\t\t\t\t\t\t\t<div class=\"catalog-product-error\">{{localize.CATALOG_FORM_ERROR_EMPTY_BRAND_1}}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\n\t\t\t\t</div>\n\t\t\t\t<div class=\"catalog-pf-product-item--right\">\n\t\t\t\t\t<div class=\"catalog-pf-product-item-section\">\n\t\t\t\t\t\t<div v-if=\"isVisibleBlock(blocks.price)\" class=\"catalog-pf-product-label\" style=\"width: 94px\">\n\t\t\t\t\t\t\t{{localize.CATALOG_FORM_PRICE}}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div v-if=\"isVisibleBlock(blocks.quantity)\" class=\"catalog-pf-product-label\" style=\"width: 72px\">\n\t\t\t\t\t\t\t{{localize.CATALOG_FORM_QUANTITY}}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div v-if=\"isVisibleBlock(blocks.result)\" class=\"catalog-pf-product-label\" style=\"width: 94px\">\n\t\t\t\t\t\t\t{{localize.CATALOG_FORM_RESULT}}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"catalog-pf-product-item-section\">\n\t\n\t\t\t\t\t\t<div v-if=\"isVisibleBlock(blocks.price)\" class=\"catalog-pf-product-control\" style=\"width: 94px\">\n\t\t\t\t\t\t\t<${config.templateFieldPrice}\n\t\t\t\t\t\t\t\t:selectorId=\"basketItem.selectorId\"\n\t\t\t\t\t\t\t\t:price=\"getPriceValue()\"\n\t\t\t\t\t\t\t\t:options=\"options\"\n\t\t\t\t\t\t\t\t:editable=\"isEditableField(blocks.price)\"\n\t\t\t\t\t\t\t\t:hasError=\"hasError(errorCodes.emptyPrice)\"\n\t\t\t\t\t\t\t\t@onChangePrice=\"onChangePrice\"\n\t\t\t\t\t\t\t\t@saveCatalogField=\"saveCatalogField\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\n\t\t\t\t\t\t<div v-if=\"isVisibleBlock(blocks.quantity)\" class=\"catalog-pf-product-control\" style=\"width: 72px\">\n\t\t\t\t\t\t\t<${config.templateFieldQuantity}\n\t\t\t\t\t\t\t\t:quantity=\"getQuantityValue()\"\n\t\t\t\t\t\t\t\t:measureCode=\"getMeasureCode\"\n\t\t\t\t\t\t\t\t:measureRatio=\"basketItem.fields.measureRatio\"\n\t\t\t\t\t\t\t\t:measureName=\"getMeasureName\"\n\t\t\t\t\t\t\t\t:hasError=\"hasError(errorCodes.emptyQuantity)\"\n\t\t\t\t\t\t\t\t:options=\"options\"\n\t\t\t\t\t\t\t\t:editable=\"isEditableField(blocks.quantity)\"\n\t\t\t\t\t\t\t\t@onChangeQuantity=\"onChangeQuantity\"\n\t\t\t\t\t\t\t\t@onSelectMeasure=\"onSelectMeasure\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\n\t\t\t\t\t\t<div v-if=\"isVisibleBlock(blocks.result)\" class=\"catalog-pf-product-control\" style=\"width: 94px\">\n\t\t\t\t\t\t\t<${config.templateFieldResultSum}\n\t\t\t\t\t\t\t\t\t:sum=\"getSumValue()\"\n\t\t\t\t\t\t\t\t\t:options=\"options\"\n\t\t\t\t\t\t\t\t\t:editable=\"isEditableField(blocks.result)\"\n\t\t\t\t\t\t\t\t\t@onChangeSum=\"onChangeSum\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div v-if=\"hasError(errorCodes.emptyQuantity)\" class=\"catalog-pf-product-item-section\">\n\t\t\t\t\t\t<div class=\"catalog-product-error\">{{localize.CATALOG_FORM_ERROR_EMPTY_QUANTITY_1}}</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div v-if=\"hasError(errorCodes.emptyPrice)\" class=\"catalog-pf-product-item-section\">\n\t\t\t\t\t\t<div v-if=\"isEditableField(blocks.price)\" class=\"catalog-product-error\">{{localize.CATALOG_FORM_ERROR_EMPTY_PRICE_1}}</div>\n\t\t\t\t\t\t<div v-else class=\"catalog-product-error\">{{localize.CATALOG_FORM_ERROR_EMPTY_PRICE_FILL_IN_CARD}}</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div v-if=\"showDiscountBlock\" class=\"catalog-pf-product-item-section\">\n\t\t\t\t\t\t<div v-if=\"showDiscount\" class=\"catalog-pf-product-link-toggler catalog-pf-product-link-toggler--hide\" @click=\"toggleDiscount('N')\">{{localize.CATALOG_FORM_DISCOUNT_TITLE}}</div>\n\t\t\t\t\t\t<div v-else class=\"catalog-pf-product-link-toggler catalog-pf-product-link-toggler--show\" @click=\"toggleDiscount('Y')\">{{localize.CATALOG_FORM_DISCOUNT_TITLE}}</div>\n\t\t\t\t\t</div>\n\t\n\t\t\t\t\t<div v-if=\"showDiscount\" class=\"catalog-pf-product-item-section\">\n\t\t\t\t\t\t<${config.templateFieldDiscount}\n\t\t\t\t\t\t\t:discount=\"getDiscountValue()\"\n\t\t\t\t\t\t\t:discountType=\"basketItem.fields.discountType\"\n\t\t\t\t\t\t\t:discountRate=\"getDiscountRateValue()\"\n\t\t\t\t\t\t\t:options=\"options\"\n\t\t\t\t\t\t\t:editable=\"isEditableField(blocks.discount)\"\n\t\t\t\t\t\t\tref=\"discountWrapper\"\n\t\t\t\t\t\t\t@changeDiscount=\"changeDiscount\"\n\t\t\t\t\t\t\t@changeDiscountType=\"changeDiscountType\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\n\t\t\t\t\t<div v-if=\"showTaxBlock\" class=\"catalog-pf-product-item-section catalog-pf-product-item-section--dashed\">\n\t\t\t\t\t\t<div v-if=\"showTaxSelector\" class=\"catalog-pf-product-link-toggler catalog-pf-product-link-toggler--hide\" @click=\"toggleTax('N')\">{{localize.CATALOG_FORM_TAX_TITLE}}</div>\n\t\t\t\t\t\t<div v-else class=\"catalog-pf-product-link-toggler catalog-pf-product-link-toggler--show\" @click=\"toggleTax('Y')\">{{localize.CATALOG_FORM_TAX_TITLE}}</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div v-if=\"showTaxSelector && showTaxBlock\" class=\"catalog-pf-product-item-section\">\n\t\t\t\t\t\t<${config.templateFieldTax}\n\t\t\t\t\t\t\t:taxId=\"basketItem.fields.taxId\"\n\t\t\t\t\t\t\t:options=\"options\"\n\t\t\t\t\t\t\t:editable=\"isEditableField(blocks.tax)\"\n\t\t\t\t\t\t\t@changeProduct=\"changeProduct\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"catalog-pf-product-item-section catalog-pf-product-item-section--dashed\"></div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"catalog-pf-product-item\">\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div>\n\t\t\t\t<div class=\"catalog-product-error\" v-html=\"getErrorsText\"></div>\n\t\t\t</div>\n\t\t</div>\n\t`\n\t});\n","export class FormCompilationType\n{\n\tstatic REGULAR: string = 'REGULAR';\n\tstatic FACEBOOK: string = 'FACEBOOK';\n}","export class FormHelpdeskCode\n{\n\tstatic COMPILATION_FACEBOOK: number = 13856526;\n\tstatic COMMON_COMPILATION: number = 13841876;\n}","import {Vuex} from 'ui.vue.vuex';\nimport {Vue} from 'ui.vue';\nimport {config} from '../../config';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\nimport {Popup} from 'main.popup';\nimport {FormMode} from '../../types/form-mode';\nimport {FormCompilationType} from '../../types/form-compilation-type';\nimport {FormHelpdeskCode} from '../../types/form-helpdesk-code';\nimport {ajax, Event, Tag, Dom, Loc, Type} from 'main.core';\nimport {Loader} from 'main.loader';\nimport {Label, LabelColor} from 'ui.label';\nimport {MessageCard} from 'ui.messagecard';\nimport 'ui.vue.components.hint';\nimport 'ui.notification';\nimport 'ui.info-helper';\nimport 'main.qrcode';\nimport 'clipboard';\nimport 'helper';\n\nVue.component(config.templatePanelCompilation,\n{\n\tprops: {\n\t\tcompilationOptions: Object,\n\t\tmode: String,\n\t},\n\tcreated()\n\t{\n\t\tthis.newLabel = new Label({\n\t\t\ttext: this.localize.CATALOG_FORM_COMPILATION_PRODUCT_NEW_LABEL,\n\t\t\tcolor: LabelColor.PRIMARY,\n\t\t\tfill: true\n\t\t});\n\t\tthis.popup = null;\n\t\tthis.compilationLink = null;\n\n\t\tconst moreMessageButton = Tag.render`\n\t\t\t<a class=\"ui-btn ui-btn-primary\">${this.localize.CATALOG_FORM_COMPILATION_INFO_BUTTON_MORE}</a>\n\t\t`;\n\n\t\tEvent.bind(moreMessageButton, 'click', this.openHelpDesk);\n\n\t\tlet header = '';\n\t\tlet description = '';\n\t\tif (this.isFacebookForm())\n\t\t{\n\t\t\theader = this.localize.CATALOG_FORM_COMPILATION_INFO_MESSAGE_TITLE_FACEBOOK;\n\t\t\tdescription = Tag.render`\n\t\t\t\t<p>${this.localize.CATALOG_FORM_COMPILATION_INFO_MESSAGE_BODY_FACEBOOK_FIRST_BLOCK}</p>\n\t\t\t\t<p>${this.localize.CATALOG_FORM_COMPILATION_INFO_MESSAGE_BODY_FACEBOOK_SECOND_BLOCK}</p>\n\t\t\t`;\n\t\t}\n\t\telse\n\t\t{\n\t\t\theader = this.localize.CATALOG_FORM_COMPILATION_INFO_MESSAGE_TITLE;\n\t\t\tdescription = this.localize.CATALOG_FORM_COMPILATION_INFO_MESSAGE_BODY_MARKETING_2;\n\t\t}\n\n\t\tthis.message = new MessageCard({\n\t\t\tid: 'compilationInfo',\n\t\t\theader,\n\t\t\tdescription,\n\t\t\tangle: false,\n\t\t\thidden: true,\n\t\t\tactionElements: [moreMessageButton]\n\t\t});\n\n\t\tEventEmitter.subscribe(this.message, 'onClose', this.hideMessage);\n\t},\n\tmounted()\n\t{\n\t\tthis.$refs.label.appendChild(this.newLabel.render());\n\t\tthis.$refs.message.appendChild(this.message.getLayout());\n\t\tif (!this.compilationOptions.hiddenInfoMessage)\n\t\t{\n\t\t\tthis.showMessage();\n\t\t}\n\t},\n\tdata()\n\t{\n\t\treturn {\n\t\t\tcompilationLink: null,\n\t\t}\n\t},\n\tmethods:\n\t{\n\t\tisFacebookForm()\n\t\t{\n\t\t\treturn this.compilationOptions.type === FormCompilationType.FACEBOOK;\n\t\t},\n\t\topenHelpDesk()\n\t\t{\n\t\t\tthis.helpdeskCode =\n\t\t\t\tthis.isFacebookForm()\n\t\t\t\t\t? FormHelpdeskCode.COMPILATION_FACEBOOK\n\t\t\t\t\t: FormHelpdeskCode.COMMON_COMPILATION\n\t\t\t;\n\n\t\t\ttop.BX.Helper.show('redirect=detail&code=' + this.helpdeskCode);\n\t\t},\n\t\tshowPopup(event: BaseEvent): void\n\t\t{\n\t\t\tif (this.compilationOptions.disabledSwitcher)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.isFacebookForm())\n\t\t\t{\n\t\t\t\tthis.openHelpDesk();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.popup instanceof Popup)\n\t\t\t{\n\t\t\t\tthis.popup.setBindElement(this.$refs.qrLink);\n\t\t\t\tthis.popup.show();\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst basket = this.$store.getters['productList/getBasket']();\n\t\t\tconst productIds = basket.map((basketItem) => {\n\t\t\t\treturn basketItem?.fields?.skuId\n\t\t\t});\n\n\t\t\treturn new Promise(\n\t\t\t\t(resolve, reject) => {\n\t\t\t\t\tajax.runAction(\n\t\t\t\t\t\t'salescenter.compilation.createCompilation',\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\tproductIds,\n\t\t\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\t\t\townerId: this.$root.$app.options.ownerId,\n\t\t\t\t\t\t\t\t\townerTypeId: this.$root.$app.options.ownerTypeId,\n\t\t\t\t\t\t\t\t\tdialogId: this.$root.$app.options.dialogId,\n\t\t\t\t\t\t\t\t\tsessionId: this.$root.$app.options.sessionId,\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t)\n\t\t\t\t\t\t.then(response => {\n\t\t\t\t\t\t\tthis.compilationLink = response.data.link ?? null;\n\t\t\t\t\t\t\tEventEmitter.emit(\n\t\t\t\t\t\t\t\tthis.$root.$app,\n\t\t\t\t\t\t\t\t'ProductForm:onCompilationCreated',\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tcompilationId: response.data.compilationId ?? null,\n\t\t\t\t\t\t\t\t\townerId: response.data.ownerId ?? null,\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tthis.popup = new Popup({\n\t\t\t\t\t\t\t\tbindElement: event.target,\n\t\t\t\t\t\t\t\tcontent: this.getQRPopupContent(),\n\t\t\t\t\t\t\t\twidth: 375,\n\t\t\t\t\t\t\t\tcloseIcon: { top: '5px', right: '5px' },\n\t\t\t\t\t\t\t\tpadding: 0,\n\t\t\t\t\t\t\t\tcloseByEsc: true,\n\t\t\t\t\t\t\t\tautoHide: true,\n\t\t\t\t\t\t\t\tcacheable: true,\n\t\t\t\t\t\t\t\tanimation: 'fading-slide',\n\t\t\t\t\t\t\t\tangle: { offset: 30 }\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\tthis.popup.show();\n\t\t\t\t\t\t\tresolve();\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.catch(() => reject());\n\t\t\t\t});\n\t\t},\n\t\tgetQRPopupContent(): HTMLElement\n\t\t{\n\t\t\tif (!this.compilationLink)\n\t\t\t{\n\t\t\t\treturn '';\n\t\t\t}\n\n\t\t\tconst buttonCopy = Tag.render`\n\t\t\t\t<div class=\"catalog-pf-product-qr-popup-copy\">${this.localize.CATALOG_FORM_COMPILATION_QR_COPY}</div>\n\t\t\t`;\n\n\t\t\tEvent.bind(buttonCopy, 'click', () => {\n\t\t\t\tBX.clipboard.copy(this.compilationLink);\n\t\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\t\tcontent: this.localize.CATALOG_FORM_COMPILATION_QR_COPY_NOTIFY_MESSAGE,\n\t\t\t\t\tautoHideDelay: 2000,\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tconst qrWrapper = Tag.render`<div class=\"catalog-pf-product-qr-popup-image\"></div>`;\n\n\t\t\tconst content = Tag.render`\n\t\t\t\t\t<div class=\"catalog-pf-product-qr-popup\">\n\t\t\t\t\t\t<div class=\"catalog-pf-product-qr-popup-content\">\n\t\t\t\t\t\t\t<div class=\"catalog-pf-product-qr-popup-text\">${this.localize.CATALOG_FORM_COMPILATION_QR_POPUP_TITLE}</div>\n\t\t\t\t\t\t\t${qrWrapper}\n\t\t\t\t\t\t\t<div class=\"catalog-pf-product-qr-popup-buttons\">\n\t\t\t\t\t\t\t\t<a href=\"${this.compilationLink}\" target=\"_blank\" class=\"ui-btn ui-btn-light-border ui-btn-round\">${this.localize.CATALOG_FORM_COMPILATION_QR_POPUP_INPUT_TITLE}</a>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"catalog-pf-product-qr-popup-bottom\">\n\t\t\t\t\t\t\t<a href=\"${this.compilationLink}\" target=\"_blank\" class=\"catalog-pf-product-qr-popup--url\">${this.compilationLink}</a>\n\t\t\t\t\t\t\t${buttonCopy}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t`;\n\n\t\t\tnew QRCode(qrWrapper, {\n\t\t\t\ttext: this.compilationLink,\n\t\t\t\twidth: 250,\n\t\t\t\theight: 250\n\t\t\t});\n\n\t\t\treturn content;\n\t\t},\n\t\tsetSetting(event)\n\t\t{\n\t\t\tconst value = event.target.checked ? 'Y' : 'N';\n\t\t\tthis.$root.$app.changeFormOption('isCompilationMode', value);\n\t\t},\n\t\tgetOnBeforeCreationStorePopupContent()\n\t\t{\n\t\t\tconst loaderContent = Tag.render`\n\t\t\t\t<div class=\"catalog-product-form-popup--loader-block\"></div>\n\t\t\t`;\n\n\t\t\tconst node = Tag.render`\n\t\t\t\t<div class=\"catalog-product-form-popup--container\">\n\t\t\t\t\t<div class=\"catalog-product-form-popup--title\">${Loc.getMessage('CATALOG_FORM_POPUP_BEFORE_MARKET_CREATING1')}</div>\n\t\t\t\t\t${loaderContent}\n\t\t\t\t\t<div class=\"catalog-product-form-popup--text\">${Loc.getMessage('CATALOG_FORM_POPUP_BEFORE_MARKET_CREATING_INFO1')}</div>\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tconst loader = new Loader({\n\t\t\t\tcolor: \"#2fc6f6\",\n\t\t\t\ttarget: loaderContent,\n\t\t\t\tsize: 40,\n\t\t\t});\n\n\t\t\tloader.show();\n\n\t\t\treturn node;\n\t\t},\n\t\tgetOnAfterCreationStorePopupContent(creationStorePopup)\n\t\t{\n\t\t\tconst continueButton = Tag.render`\n\t\t\t\t<button class=\"ui-btn ui-btn-md ui-btn-primary\">\n\t\t\t\t\t${Loc.getMessage('CATALOG_FORM_POPUP_AFTER_MARKET_CREATING_CONTINUE')}\n\t\t\t\t</button>\n\t\t\t`;\n\t\t\tEvent.bind(continueButton, 'click', this.closeCreationStorePopup.bind(this, creationStorePopup));\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"catalog-product-form-popup--container\">\n\t\t\t\t\t<div class=\"catalog-product-form-popup--title\">${Loc.getMessage('CATALOG_FORM_POPUP_AFTER_MARKET_CREATING1')}</div>\n\t\t\t\t\t<div class=\"catalog-product-form-popup--loader-block catalog-product-form-popup--done\"></div>\n\t\t\t\t\t<div class=\"catalog-product-form-popup--text\">${Loc.getMessage('CATALOG_FORM_POPUP_AFTER_MARKET_CREATING_INFO1')}</div>\n\t\t\t\t\t<div class=\"catalog-product-form-popup--button-container\">${continueButton}</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t},\n\t\tcloseCreationStorePopup(creationStorePopup)\n\t\t{\n\t\t\tcreationStorePopup.close();\n\t\t},\n\t\tonLabelClick()\n\t\t{\n\t\t\tif (this.compilationOptions.isLimitedStore)\n\t\t\t{\n\t\t\t\tBX.UI.InfoHelper.show('limit_sites_number');\n\t\t\t}\n\t\t},\n\t\tonClickHint(event: BaseEvent)\n\t\t{\n\t\t\tevent.preventDefault();\n\t\t\tevent.stopImmediatePropagation();\n\t\t\tif (!this.message)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (this.message.isShown())\n\t\t\t{\n\t\t\t\tthis.hideMessage()\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.showMessage();\n\t\t\t}\n\t\t},\n\t\tshowMessage()\n\t\t{\n\t\t\tif (this.message)\n\t\t\t{\n\t\t\t\tDom.addClass(this.$refs.hintIcon, 'catalog-pf-product-panel-message-arrow-target');\n\t\t\t\tthis.message.show();\n\t\t\t}\n\t\t},\n\t\thideMessage()\n\t\t{\n\t\t\tif (this.message)\n\t\t\t{\n\t\t\t\tDom.removeClass(this.$refs.hintIcon, 'catalog-pf-product-panel-message-arrow-target');\n\t\t\t}\n\t\t\tthis.message.hide();\n\t\t\t\tthis.$root.$app.changeFormOption('hiddenCompilationInfoMessage', 'Y');\n\t\t}\n\t},\n\tcomputed:\n\t{\n\t\tlocalize()\n\t\t{\n\t\t\treturn Vue.getFilteredPhrases('CATALOG_');\n\t\t},\n\n\t\tshowQrLink()\n\t\t{\n\t\t\treturn this.mode === FormMode.COMPILATION;\n\t\t},\n\n\t\t...Vuex.mapState({\n\t\t\tproductList: state => state.productList,\n\t\t})\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div>\n\t\t\t<div class=\"catalog-pf-product-panel-compilation\">\n\t\t\t\t<div class=\"catalog-pf-product-panel-compilation-wrapper\">\n\t\t\t\t\t<label class=\"ui-ctl ui-ctl-checkbox catalog-pf-product-panel-compilation-checkbox-container\" @click=\"onLabelClick\">\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\ttype=\"checkbox\"\n\t\t\t\t\t\t\t:disabled=\"compilationOptions.disabledSwitcher\"\n\t\t\t\t\t\t\tclass=\"ui-ctl-element\"\n\t\t\t\t\t\t\t@change=\"setSetting\"\n\t\t\t\t\t\t\tdata-setting-id=\"isCompilationMode\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t<div class=\"ui-ctl-label-text\">{{localize.CATALOG_FORM_COMPILATION_PRODUCT_SWITCHER_2}}</div>\n\t\t\t\t\t\t<div ref=\"hintIcon\">\n\t\t\t\t\t\t\t<div data-hint-init=\"vue\" class=\"ui-hint\" @click=\"onClickHint\">\n\t\t\t\t\t\t\t\t<span class=\"ui-hint-icon\"></span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div ref=\"label\"></div>\n\t\t\t\t\t\t<div class=\"tariff-lock\" v-if=\"compilationOptions.isLimitedStore\"></div>\n\t\t\t\t\t</label>\n\t\t\t\t</div>\n\t\t\t\t<div\n\t\t\t\t\tv-if=\"showQrLink\"\n\t\t\t\t\tclass=\"catalog-pf-product-panel-compilation-link --icon-qr\"\n\t\t\t\t\t@click=\"showPopup\"\n\t\t\t\t\tref=\"qrLink\"\n\t\t\t\t>\n\t\t\t\t\t{{localize.CATALOG_FORM_COMPILATION_QR_LINK}}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"catalog-pf-product-panel-compilation-price-info\">{{localize.CATALOG_FORM_COMPILATION_PRICE_NOTIFICATION}}</div>\n\t\t\t<div class=\"catalog-pf-product-panel-compilation-message\" ref=\"message\"></div>\n\t\t</div>\n\t`\n});","import {Vuex} from 'ui.vue.vuex';\nimport {Popup} from 'main.popup';\nimport {ajax, Event, Loc, Tag, Text, Type} from 'main.core';\nimport {Vue} from \"ui.vue\";\nimport {config} from \"../../config\";\nimport \"./panel-compilation\";\nimport {DialogDisable, Slider, EventType} from 'catalog.store-use'\nimport {EventEmitter} from \"main.core.events\";\nimport 'ui.hint';\n\nVue.component(config.templatePanelButtons,\n{\n\t/**\n\t * @emits 'changeRowData' {index: number, fields: object}\n\t * @emits 'refreshBasket'\n\t * @emits 'addItem'\n\t */\n\n\tprops: {\n\t\toptions: Object,\n\t\tmode: String,\n\t},\n\tdata()\n\t{\n\t\treturn {\n\t\t\tsettings: []\n\t\t};\n\t},\n\tmethods:\n\t{\n\t\trefreshBasket()\n\t\t{\n\t\t\tthis.$emit('refreshBasket');\n\t\t},\n\t\tchangeBasketItem(item)\n\t\t{\n\t\t\tthis.$emit('changeRowData', item);\n\t\t},\n\t\taddBasketItemForm()\n\t\t{\n\t\t\tthis.$emit('addItem');\n\t\t},\n\t\tgetInternalIndexByProductId(skuId)\n\t\t{\n\t\t\tconst basket = this.$store.getters['productList/getBasket']();\n\t\t\treturn Object\n\t\t\t\t.keys(basket)\n\t\t\t\t.findIndex((inx) =>{\n\t\t\t\t\treturn parseInt(basket[inx].skuId) === parseInt(skuId)\n\t\t\t\t});\n\t\t},\n\t\thandleAddItem(id, params)\n\t\t{\n\t\t\tconst skuType = 4;\n\t\t\tif (Text.toNumber(params.type) === skuType)\n\t\t\t{\n\t\t\t\tajax.runAction(\n\t\t\t\t\t'catalog.productSelector.getSelectedSku',\n\t\t\t\t\t{\n\t\t\t\t\t\tjson: {\n\t\t\t\t\t\t\tvariationId: id,\n\t\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\t\tpriceId: this.options.basePriceId,\n\t\t\t\t\t\t\t\turlBuilder: this.options.urlBuilder,\n\t\t\t\t\t\t\t\tcurrency: this.options.currency,\n\t\t\t\t\t\t\t\tresetSku: true\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t).then(response => this.processResponse(response, params.isAddAnyway));\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tajax.runAction(\n\t\t\t\t\t'catalog.productSelector.getProduct',\n\t\t\t\t\t{\n\t\t\t\t\t\tjson: {\n\t\t\t\t\t\t\tproductId: id,\n\t\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\t\tpriceId: this.options.basePriceId,\n\t\t\t\t\t\t\t\turlBuilder: this.options.urlBuilder,\n\t\t\t\t\t\t\t\tcurrency: this.options.currency,\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t).then(response => this.processResponse(response, params.isAddAnyway));\n\t\t\t}\n\t\t},\n\t\tprocessResponse(response, isAddAnyway)\n\t\t{\n\t\t\tconst index = isAddAnyway ? -1 : this.getInternalIndexByProductId(response.data.skuId);\n\t\t\tif (index < 0)\n\t\t\t{\n\t\t\t\tconst productData = response.data;\n\t\t\t\tconst basePrice = Text.toNumber(productData.fields.BASE_PRICE);\n\t\t\t\tproductData.fields = productData.fields || {};\n\t\t\t\tlet newItem = this.$store.getters['productList/getBaseProduct']();\n\t\t\t\tnewItem.fields = Object.assign(newItem.fields, {\n\t\t\t\t\tprice: basePrice,\n\t\t\t\t\tpriceExclusive: basePrice,\n\t\t\t\t\tbasePrice,\n\t\t\t\t\tname: productData.fields.NAME || '',\n\t\t\t\t\tproductId: productData.productId,\n\t\t\t\t\tskuId: productData.skuId,\n\t\t\t\t\tmeasureCode: productData.fields.MEASURE_CODE,\n\t\t\t\t\tmeasureName: productData.fields.MEASURE_NAME,\n\t\t\t\t\tmeasureRatio: productData.fields.MEASURE_RATIO,\n\t\t\t\t\tproperties: productData.fields.PROPERTIES,\n\t\t\t\t\tofferId: productData.skuId > 0 ? productData.skuId : productData.productId,\n\t\t\t\t\tmodule: 'catalog',\n\t\t\t\t\tisCustomPrice: Type.isNil(productData.fields.PRICE) ? 'Y' : 'N',\n\t\t\t\t\tdiscountType: this.options.defaultDiscountType,\n\t\t\t\t});\n\n\t\t\t\tdelete(productData.fields);\n\t\t\t\tnewItem = Object.assign(newItem, productData);\n\t\t\t\tnewItem.sum = basePrice;\n\n\t\t\t\tthis.$root.$app.addProduct(newItem);\n\t\t\t}\n\t\t},\n\t\tonUpdateBasketItem(inx, item)\n\t\t{\n\t\t\tthis.$store.dispatch('productList/changeRowData', {\n\t\t\t\tindex : inx,\n\t\t\t\tfields : item\n\t\t\t});\n\t\t\tthis.$store.dispatch('productList/changeProduct', {\n\t\t\t\tindex : inx,\n\t\t\t\tfields : item.fields\n\t\t\t});\n\t\t},\n\t\t/*\n\t\t* By default, basket collection contains a fake|empty item,\n\t\t*  that is deleted when you select items from the catalog.\n\t\t* Also, products can be added to the form and become an empty string,\n\t\t*  while stay a item of basket collection\n\t\t* */\n\t\tremoveEmptyItems()\n\t\t{\n\t\t\tconst basket = this.$store.getters['productList/getBasket']();\n\t\t\tbasket.forEach((item, i)=>{\n\t\t\t\tif(\n\t\t\t\t\tbasket[i].name === ''\n\t\t\t\t\t&& basket[i].price < 1e-10\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tthis.$store.commit('productList/deleteItem', {\n\t\t\t\t\t\tindex: i\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tmodifyBasketItem(params)\n\t\t{\n\t\t\tconst skuId = parseInt(params.id);\n\t\t\tif(skuId > 0)\n\t\t\t{\n\t\t\t\tconst index = this.getInternalIndexByProductId(skuId);\n\t\t\t\tif(index >= 0)\n\t\t\t\t{\n\t\t\t\t\tthis.showDialogProductExists(params);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.removeEmptyItems();\n\t\t\t\t\tthis.handleAddItem(skuId, params);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tshowDialogProductExists(params)\n\t\t{\n\t\t\tthis.popup = new Popup(null, null, {\n\t\t\t\tevents: {\n\t\t\t\t\tonPopupClose: () => {this.popup.destroy()}\n\t\t\t\t},\n\t\t\t\tzIndex: 4000,\n\t\t\t\tautoHide: true,\n\t\t\t\tcloseByEsc: true,\n\t\t\t\tcloseIcon: true,\n\t\t\t\ttitleBar: Loc.getMessage('CATALOG_FORM_BLOCK_PROD_EXIST_DLG_TITLE'),\n\t\t\t\tdraggable: true,\n\t\t\t\tresizable: false,\n\t\t\t\tlightShadow: true,\n\t\t\t\tcacheable: false,\n\t\t\t\toverlay: true,\n\t\t\t\tcontent: Loc.getMessage('CATALOG_FORM_BLOCK_PROD_EXIST_DLG_TEXT_FOR_DOUBLE').replace('#NAME#', params.name),\n\t\t\t\tbuttons: this.getButtons(params),\n\t\t\t});\n\n\t\t\tthis.popup.show();\n\t\t},\n\t\tgetButtons(product)\n\t\t{\n\t\t\tconst buttons = [];\n\t\t\tconst params = product;\n\t\t\tbuttons.push(\n\t\t\t\tnew BX.UI.SaveButton(\n\t\t\t\t\t{\n\t\t\t\t\t\ttext : Loc.getMessage('CATALOG_FORM_BLOCK_PROD_EXIST_DLG_OK'),\n\t\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\t\tconst productId = parseInt(params.id);\n\t\t\t\t\t\t\tconst index = this.getInternalIndexByProductId(productId);\n\t\t\t\t\t\t\tif(index >= 0)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.handleAddItem(productId, {\n\t\t\t\t\t\t\t\t\t...params,\n\t\t\t\t\t\t\t\t\tisAddAnyway: true,\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tthis.popup.destroy();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t);\n\n\t\t\tbuttons.push(\n\t\t\t\tnew BX.UI.CancelButton(\n\t\t\t\t\t{\n\t\t\t\t\t\ttext : Loc.getMessage('CATALOG_FORM_BLOCK_PROD_EXIST_DLG_NO'),\n\t\t\t\t\t\tonclick: () => {this.popup.destroy()}\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t);\n\t\t\treturn buttons;\n\t\t},\n\t\tshowDialogProductSearch()\n\t\t{\n\t\t\tconst funcName = 'addBasketItemFromDialogProductSearch';\n\t\t\twindow[funcName] = params => this.modifyBasketItem(params);\n\n\t\t\tconst popup = new BX.CDialog({\n\t\t\t\tcontent_url: '/bitrix/tools/sale/product_search_dialog.php?'+\n\t\t\t\t\t//todo: 'lang='+this._settings.languageId+\n\t\t\t\t\t//todo: '&LID='+this._settings.siteId+\n\t\t\t\t\t'&caller=order_edit'+\n\t\t\t\t\t'&func_name='+funcName+\n\t\t\t\t\t'&STORE_FROM_ID=0'+\n\t\t\t\t\t'&public_mode=Y',\n\t\t\t\theight: Math.max(500, window.innerHeight-400),\n\t\t\t\twidth: Math.max(800, window.innerWidth-400),\n\t\t\t\tdraggable: true,\n\t\t\t\tresizable: true,\n\t\t\t\tmin_height: 500,\n\t\t\t\tmin_width: 800,\n\t\t\t\tzIndex: 3100\n\t\t\t});\n\n\t\t\tpopup.Show();\n\t\t},\n\t\tsetSetting(event)\n\t\t{\n\t\t\tif (event.target.dataset.settingId === 'taxIncludedOption')\n\t\t\t{\n\t\t\t\tconst value = event.target.checked ? 'Y' : 'N';\n\t\t\t\tthis.$root.$app.changeFormOption('taxIncluded', value);\n\t\t\t}\n\t\t\telse if (event.target.dataset.settingId === 'showDiscountInputOption')\n\t\t\t{\n\t\t\t\tconst value = event.target.checked ? 'Y' : 'N';\n\t\t\t\tthis.$root.$app.changeFormOption('showDiscountBlock', value);\n\t\t\t}\n\t\t\telse if (event.target.dataset.settingId === 'showTaxInputOption')\n\t\t\t{\n\t\t\t\tconst value = event.target.checked ? 'Y' : 'N';\n\t\t\t\tthis.$root.$app.changeFormOption('showTaxBlock', value);\n\t\t\t}\n\t\t\telse if (event.target.dataset.settingId === 'warehouseOption')\n\t\t\t{\n\t\t\t\tconst value = event.target.checked ? 'Y' : 'N';\n\n\t\t\t\tif(value === 'Y')\n\t\t\t\t{\n\t\t\t\t\tthis.popupMenu.close();\n\t\t\t\t\tnew Slider().open('/bitrix/components/bitrix/catalog.warehouse.master.clear/slider.php',{})\n\t\t\t\t\t.then(() => {\n\t\t\t\t\t\tajax.runAction(\n\t\t\t\t\t\t\t'catalog.config.isUsedInventoryManagement',\n\t\t\t\t\t\t\t{}\n\t\t\t\t\t\t).then(response => {\n\n\t\t\t\t\t\t\tconst index = this.getSettingItems().findIndex((item) =>\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\treturn item.id === event.target.dataset.settingId;\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\tthis.options.warehouseOption = response.data === true;\n\t\t\t\t\t\t\tthis.settings = this.getSettingItems();\n\t\t\t\t\t\t});\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tgetSettingItem(item): HTMLElement\n\t\t{\n\t\t\tconst input = Tag.render`\n\t\t\t\t\t<input type=\"checkbox\"  class=\"ui-ctl-element\">\n\t\t\t\t`;\n\t\t\tinput.checked = item.checked;\n\t\t\tinput.disabled = item.disabled ?? false;\n\t\t\tinput.dataset.settingId = item.id;\n\n\t\t\tconst hintNode = (\n\t\t\t\tType.isStringFilled(item.hint)\n\t\t\t\t\t? Tag.render`<span class=\"catalog-product-form-setting-hint\" data-hint=\"${item.hint}\"></span>`\n\t\t\t\t\t: ''\n\t\t\t);\n\n\t\t\tconst setting = Tag.render`\n\t\t\t\t<label class=\"ui-ctl ui-ctl-checkbox ui-ctl-w100\">\n\t\t\t\t\t${input}\n\t\t\t\t\t<div class=\"ui-ctl-label-text ${item.disabled ? 'catalog-product-form-disabled-setting' : ''}\">${item.title}${hintNode}</div>\n\t\t\t\t</label>\n\t\t\t`;\n\n\t\t\tBX.UI.Hint.init(setting);\n\n\t\t\tEvent.bind(setting, 'change', this.setSetting.bind(this));\n\n\t\t\treturn setting;\n\t\t},\n\t\tgetSettingItems()\n\t\t{\n\t\t\tconst items = [\n\t\t\t\t// {\n\t\t\t\t// \tid: 'taxIncludedOption',\n\t\t\t\t// \tchecked: (this.options.taxIncluded === 'Y'),\n\t\t\t\t// \ttitle: this.localize.CATALOG_FORM_ADD_TAX_INCLUDED,\n\t\t\t\t// },\n\t\t\t\t{\n\t\t\t\t\tid: 'showDiscountInputOption',\n\t\t\t\t\tchecked: (this.options.showDiscountBlock !== 'N'),\n\t\t\t\t\ttitle: this.localize.CATALOG_FORM_ADD_SHOW_DISCOUNTS_OPTION,\n\t\t\t\t},\n\t\t\t\t// {\n\t\t\t\t// \tid: 'showTaxInputOption',\n\t\t\t\t// \tchecked: (this.options.showTaxBlock !== 'N'),\n\t\t\t\t// \ttitle: this.localize.CATALOG_FORM_ADD_SHOW_TAXES_OPTION,\n\t\t\t\t// },\n\t\t\t];\n\n\t\t\tif (this.options.isCatalogSettingAccess)\n\t\t\t{\n\t\t\t\titems.push(\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'warehouseOption',\n\t\t\t\t\t\tchecked: (this.options.warehouseOption),\n\t\t\t\t\t\tdisabled: (this.options.warehouseOption),\n\t\t\t\t\t\ttitle: this.localize.CATALOG_FORM_ADD_SHOW_WAREHOUSE_OPTION,\n\t\t\t\t\t\thint: this.options.warehouseOption ? this.localize.CATALOG_FORM_ADD_SHOW_WAREHOUSE_HINT : '',\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\n\t\t\treturn items;\n\t\t},\n\n\t\tprepareSettingsContent(): HTMLElement\n\t\t{\n\t\t\tconst content = Tag.render`\n\t\t\t\t\t<div class='catalog-pf-product-config-popup'></div>\n\t\t\t\t`;\n\n\t\t\tthis.settings.forEach(item => {\n\t\t\t\tcontent.append(this.getSettingItem(item));\n\t\t\t});\n\n\t\t\treturn content;\n\t\t},\n\t\tshowConfigPopup(event)\n\t\t{\n\t\t\t// if (!this.popupMenu)\n\t\t\t// {\n\t\t\t\tthis.popupMenu = new Popup(null, event.target,\n\t\t\t\t\t{\n\t\t\t\t\t\tautoHide: true,\n\t\t\t\t\t\tdraggable: false,\n\t\t\t\t\t\toffsetLeft: 0,\n\t\t\t\t\t\toffsetTop: 0,\n\t\t\t\t\t\tnoAllPaddings: true,\n\t\t\t\t\t\tbindOptions: {forceBindPosition: true},\n\t\t\t\t\t\tcloseByEsc: true,\n\t\t\t\t\t\tcontent: this.prepareSettingsContent()\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t// }\n\n\t\t\tthis.popupMenu.show();\n\t\t},\n\t\topenSlider(url, options)\n\t\t{\n\t\t\tif(!Type.isPlainObject(options))\n\t\t\t{\n\t\t\t\toptions = {};\n\t\t\t}\n\t\t\toptions = {...{cacheable: false, allowChangeHistory: false, events: {}}, ...options};\n\t\t\treturn new Promise((resolve) =>\n\t\t\t\t{\n\t\t\t\t\tif(Type.isString(url) && url.length > 1)\n\t\t\t\t\t{\n\t\t\t\t\t\toptions.events.onClose = function(event)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tresolve(event.getSlider());\n\t\t\t\t\t};\n\t\t\t\t\tBX.SidePanel.Instance.open(url, options);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tresolve();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t},\n\tcomputed:\n\t{\n\t\thasAccessToCatalog()\n\t\t{\n\t\t\treturn this.options.isCatalogAccess;\n\t\t},\n\t\tlocalize()\n\t\t{\n\t\t\treturn Vue.getFilteredPhrases('CATALOG_');\n\t\t},\n\t\tcountItems()\n\t\t{\n\t\t\treturn this.order.basket.length;\n\t\t},\n\t\t...Vuex.mapState({\n\t\t\tproductList: state => state.productList,\n\t\t})\n\t},\n\tmounted()\n\t{\n\t\tthis.settings = this.getSettingItems();\n\n\t\tBX.UI.Hint.init();\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div>\n\t\t\t<div class=\"catalog-pf-product-add\">\n\t\t\t\t<div class=\"catalog-pf-product-add-wrapper\">\n\t\t\t\t\t<span class=\"catalog-pf-product-add-link\" @click=\"addBasketItemForm\">{{localize.CATALOG_FORM_ADD_PRODUCT}}</span>\n\t\t\t\t\t<span\n\t\t\t\t\t\tv-if=\"hasAccessToCatalog\"\n\t\t\t\t\t\tclass=\"catalog-pf-product-add-link catalog-pf-product-add-link--gray\"\n\t\t\t\t\t\t@click=\"showDialogProductSearch\"\n\t\t\t\t\t>{{localize.CATALOG_FORM_ADD_PRODUCT_FROM_CATALOG}}</span>\n\t\t\t\t\t<span\n\t\t\t\t\t\tv-else\n\t\t\t\t\t\tclass=\"catalog-pf-product-add-link catalog-pf-product-add-link--gray catalog-pf-product-add-link--disabled\"\n\t\t\t\t\t\t:data-hint=\"localize.CATALOG_FORM_ADD_PRODUCT_FROM_CATALOG_DENIED_HINT\"\n\t\t\t\t\t\tdata-hint-no-icon\n\t\t\t\t\t>{{localize.CATALOG_FORM_ADD_PRODUCT_FROM_CATALOG}}</span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"catalog-pf-product-configure-link\" @click=\"showConfigPopup\">{{localize.CATALOG_FORM_DISCOUNT_EDIT_PAGE_URL_TITLE}}</div>\n\t\t\t</div>\n\t\t</div>\n\t`\n});\n","import {Vue} from 'ui.vue';\nimport {config} from '../../config';\nimport {CurrencyCore} from 'currency.currency-core';\nimport {Tag} from 'main.core';\n\nVue.component(config.templateSummaryTotal,\n{\n\tprops:\n\t{\n\t\tcurrency:\n\t\t{\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tsum:\n\t\t{\n\t\t\trequired: true,\n\t\t},\n\t\tsumAdditionalClass: String,\n\t\tcurrencyAdditionalClass: String,\n\t},\n\tcomputed:\n\t{\n\t\tformattedSum()\n\t\t{\n\t\t\tconst element = Tag.render`<span class=\"catalog-pf-text ${this.sumAdditionalClass ?? ''}\">${this.sum}</span>`;\n\t\t\treturn CurrencyCore.getPriceControl(element, this.currency);\n\t\t},\n\t},\n\t// language=Vue\n\ttemplate: `\n\t<span class=\"catalog-pf-symbol\" :class=\"currencyAdditionalClass\" v-html=\"formattedSum\"></span>\n\t`\n});\n","import {config} from '../config';\n\nimport {Vue} from 'ui.vue';\nimport {Vuex} from 'ui.vue.vuex';\nimport \"currency\";\nimport \"ui.layout-form\";\nimport \"ui.forms\";\nimport \"ui.buttons\";\n\nimport \"./row\";\nimport \"./elements/panel-buttons\";\nimport \"./elements/summary-total\";\nimport {FormElementPosition} from \"../types/form-element-position\";\nimport {FormMode} from \"../types/form-mode\";\n\nVue.component(config.templateName,\n{\n\tprops: {\n\t\toptions: Object,\n\t\tmode: String,\n\t},\n\tcreated()\n\t{\n\t\tBX.ajax.runAction(\n\t\t\t\"catalog.productSelector.getFileInput\",\n\t\t\t{ json: { iblockId: this.options.iblockId } }\n\t\t);\n\t},\n\tmethods:\n\t{\n\t\trefreshBasket()\n\t\t{\n\t\t\tthis.$store.dispatch('productList/refreshBasket');\n\t\t},\n\n\t\tchangeProduct(item)\n\t\t{\n\t\t\tthis.$root.$app.changeProduct(item);\n\t\t},\n\n\t\temitErrorsChange()\n\t\t{\n\t\t\tthis.$root.$app.emitErrorsChange();\n\t\t},\n\n\t\tchangeRowData(item)\n\t\t{\n\t\t\tdelete(item.product.fields);\n\t\t\tthis.$store.commit('productList/updateItem', item);\n\t\t},\n\n\t\tremoveItem(item)\n\t\t{\n\t\t\tthis.$root.$app.removeProduct(item);\n\t\t},\n\n\t\taddItem()\n\t\t{\n\t\t\tthis.$root.$app.addProduct();\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tlocalize()\n\t\t{\n\t\t\treturn Vue.getFilteredPhrases('CATALOG_');\n\t\t},\n\n\t\tshowTaxResult()\n\t\t{\n\t\t\treturn this.options.showTaxBlock !== 'N';\n\t\t},\n\n\t\tshowResults()\n\t\t{\n\t\t\treturn this.options.showResults !== false;\n\t\t},\n\n\t\tshowButtonsTop()\n\t\t{\n\t\t\treturn this.options.singleProductMode !== true\n\t\t\t\t&& this.mode !== FormMode.READ_ONLY\n\t\t\t\t&& this.mode !== FormMode.COMPILATION_READ_ONLY\n\t\t\t\t&& this.options.buttonsPosition !== FormElementPosition.BOTTOM\n\t\t\t;\n\t\t},\n\n\t\tshowButtonsBottom()\n\t\t{\n\t\t\treturn this.options.singleProductMode !== true\n\t\t\t\t&& this.mode !== FormMode.READ_ONLY\n\t\t\t\t&& this.mode !== FormMode.COMPILATION_READ_ONLY\n\t\t\t\t&& this.options.buttonsPosition === FormElementPosition.BOTTOM\n\t\t\t;\n\t\t},\n\n\t\tshowResultBlock()\n\t\t{\n\t\t\treturn this.showResults || this.enableAddButtons;\n\t\t},\n\n\t\tcountItems()\n\t\t{\n\t\t\treturn this.productList.basket.length;\n\t\t},\n\n\t\ttotalResultLabel()\n\t\t{\n\t\t\treturn this.options.hasOwnProperty('totalResultLabel') && this.options.totalResultLabel\n\t\t\t\t? this.options.totalResultLabel\n\t\t\t\t: this.localize.CATALOG_FORM_TOTAL_RESULT;\n\t\t},\n\n\t\t...Vuex.mapState({\n\t\t\tproductList: state => state.productList,\n\t\t})\n\t},\n\t// language=Vue\n\ttemplate: `\n\t<div class=\"catalog-product-form-container\">\n\t\t<${config.templatePanelButtons}\n\t\t\t:options=\"options\"\n\t\t\t:mode=\"mode\"\n\t\t\t@refreshBasket=\"refreshBasket\"\n\t\t\t@addItem=\"addItem\"\n\t\t\t@changeRowData=\"changeRowData\"\n\t\t\t@changeProduct=\"changeProduct\"\n\t\t\tv-if=\"showButtonsTop\"\n\t\t/>\n\t\t<div v-for=\"(item, index) in productList.basket\" :key=\"item.selectorId\">\n\t\t\t<${config.templateRowName}\n\t\t\t\t:basketItem=\"item\"\n\t\t\t\t:basketItemIndex=\"index\"\n\t\t\t\t:basketLength=\"productList.basket.length\"\n\t\t\t\t:countItems=\"countItems\"\n\t\t\t\t:options=\"options\"\n\t\t\t\t:mode=\"mode\"\n\t\t\t\t@changeProduct=\"changeProduct\"\n\t\t\t\t@changeRowData=\"changeRowData\"\n\t\t\t\t@removeItem=\"removeItem\"\n\t\t\t\t@refreshBasket=\"refreshBasket\"\n\t\t\t\t@emitErrorsChange=\"emitErrorsChange\"\n\t\t\t/>\n\t\t</div>\n\t\t<${config.templatePanelButtons}\n\t\t\t:options=\"options\"\n\t\t\t:mode=\"mode\"\n\t\t\t@refreshBasket=\"refreshBasket\"\n\t\t\t@addItem=\"addItem\"\n\t\t\t@changeRowData=\"changeRowData\"\n\t\t\t@changeProduct=\"changeProduct\"\n\t\t\tv-if=\"showButtonsBottom\"\n\t\t/>\n\t\t<${config.templatePanelCompilation}\n\t\t\tv-if=\"options.showCompilationModeSwitcher\"\n\t\t\t:compilationOptions=\"options.compilationFormOption\"\n\t\t\t:mode=\"mode\"\n\t\t/>\n\t\t<div class=\"catalog-pf-result-line\"></div>\n\t\t<div class=\"catalog-pf-result-wrapper\" v-if=\"showResultBlock\">\n\t\t\t<table class=\"catalog-pf-result\">\n\t\t\t\t<tr>\n\t\t\t\t\t<td>\n\t\t\t\t\t\t<span class=\"catalog-pf-text\">{{localize.CATALOG_FORM_PRODUCTS_PRICE}}:</span>\n\t\t\t\t\t</td>\n\t\t\t\t\t<td>\n\t\t\t\t\t\t<${config.templateSummaryTotal}\n\t\t\t\t\t\t\t:sum=\"productList.total.sum\"\n\t\t\t\t\t\t\t:currency=\"options.currency\"\n\t\t\t\t\t\t\t:sumAdditionalClass=\"productList.total.result !== productList.total.sum ? 'catalog-pf-text--line-through' : ''\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\t\t\t\t<tr>\n\t\t\t\t\t<td class=\"catalog-pf-result-padding-bottom\">\n\t\t\t\t\t\t<span class=\"catalog-pf-text catalog-pf-text--discount\">{{localize.CATALOG_FORM_TOTAL_DISCOUNT}}:</span>\n\t\t\t\t\t</td>\n\t\t\t\t\t<td class=\"catalog-pf-result-padding-bottom\">\n\t\t\t\t\t\t<${config.templateSummaryTotal}\n\t\t\t\t\t\t\t:sum=\"productList.total.discount\"\n\t\t\t\t\t\t\t:currency=\"options.currency\"\n\t\t\t\t\t\t\t:sumAdditionalClass=\"'catalog-pf-text--discount'\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\t\t\t\t<tr v-if=\"showTaxResult\">\n\t\t\t\t\t<td class=\"catalog-pf-tax\">\n\t\t\t\t\t\t<span class=\"catalog-pf-text catalog-pf-text--tax\">{{localize.CATALOG_FORM_TAX_TITLE}}:</span>\n\t\t\t\t\t</td>\n\t\t\t\t\t<td class=\"catalog-pf-tax\">\n\t\t\t\t\t\t<${config.templateSummaryTotal}\n\t\t\t\t\t\t\t:sum=\"productList.total.taxSum\"\n\t\t\t\t\t\t\t:currency=\"options.currency\"\n\t\t\t\t\t\t\t:sumAdditionalClass=\"'catalog-pf-text--tax'\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\t\t\t\t<tr>\n\t\t\t\t\t<td class=\"catalog-pf-result-padding\">\n\t\t\t\t\t\t<span class=\"catalog-pf-text catalog-pf-text--total catalog-pf-text--border\">{{totalResultLabel}}:</span>\n\t\t\t\t\t</td>\n\t\t\t\t\t<td class=\"catalog-pf-result-padding\">\n\t\t\t\t\t\t<${config.templateSummaryTotal}\n\t\t\t\t\t\t\t:sum=\"productList.total.result\"\n\t\t\t\t\t\t\t:currency=\"options.currency\"\n\t\t\t\t\t\t\t:sumAdditionalClass=\"'catalog-pf-text--total'\"\n\t\t\t\t\t\t\t:currencyAdditionalClass=\"'catalog-pf-symbol--total'\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\t\t\t</table>\n\t\t</div>\n\t</div>\n`,\n});\n","import {BitrixVue} from 'ui.vue';\nimport {VuexBuilder} from 'ui.vue.vuex';\nimport {Loc, Type, Text, Tag, ajax, Extension} from 'main.core';\nimport 'ui.notification';\nimport 'ui.design-tokens';\nimport 'ui.fonts.opensans';\nimport {ProductList} from './models/product-list';\nimport {config} from \"./config\";\nimport './templates/form';\nimport './component.css';\nimport {EventEmitter} from \"main.core.events\";\nimport {CurrencyCore} from \"currency.currency-core\";\nimport type {FormOption} from \"./types/form-option\";\nimport {FormElementPosition} from \"./types/form-element-position\";\nimport {DiscountType} from \"catalog.product-calculator\";\nimport {FormInputCode} from \"./types/form-input-code\";\nimport type {BasketItemScheme} from \"./types/basket-item-scheme\";\nimport {FormErrorCode} from \"./types/form-error-code\";\nimport {FormMode} from \"./types/form-mode\";\nimport {FormCompilationType} from \"./types/form-compilation-type\";\n\nclass ProductForm\n{\n\tconstructor(options: FormOption = {})\n\t{\n\t\tthis.options = this.prepareOptions(options);\n\t\tthis.defaultOptions = Object.assign({}, this.options);\n\n\t\tthis.editable = true;\n\t\tthis.#setMode(FormMode.REGULAR);\n\n\t\tthis.wrapper = Tag.render`<div class=\"\"></div>`;\n\n\t\tif (Text.toNumber(options.iblockId) <= 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tProductForm.initStore()\n\t\t\t.then((result) => this.initTemplate(result))\n\t\t\t.catch((error) => ProductForm.showError(error))\n\t\t;\n\t}\n\n\tstatic initStore(): VuexBuilder\n\t{\n\t\tconst builder = new VuexBuilder();\n\n\t\treturn builder\n\t\t\t.addModel(ProductList.create())\n\t\t\t.build();\n\t}\n\n\tprepareOptions(options: FormOption = {}): FormOption\n\t{\n\t\tconst settingsCollection = Extension.getSettings('catalog.product-form');\n\t\tconst defaultOptions: FormOption = {\n\t\t\tbasket: [],\n\t\t\tmeasures: [],\n\t\t\tiblockId: null,\n\t\t\tbasePriceId: settingsCollection.get('basePriceId'),\n\t\t\ttaxList: [],\n\t\t\tsingleProductMode: false,\n\t\t\tshowResults: true,\n\t\t\tshowCompilationModeSwitcher: false,\n\t\t\tenableEmptyProductError: true,\n\t\t\tpricePrecision: 2,\n\t\t\tcurrency: settingsCollection.get('currency'),\n\t\t\tcurrencySymbol: settingsCollection.get('currencySymbol'),\n\t\t\ttaxIncluded: settingsCollection.get('taxIncluded'),\n\t\t\twarehouseOption: settingsCollection.get('warehouseOption'),\n\t\t\tshowDiscountBlock: settingsCollection.get('showDiscountBlock'),\n\t\t\tshowTaxBlock: settingsCollection.get('showTaxBlock'),\n\t\t\tallowedDiscountTypes: [DiscountType.PERCENTAGE, DiscountType.MONETARY],\n\t\t\tvisibleBlocks: [\n\t\t\t\tFormInputCode.PRODUCT_SELECTOR, FormInputCode.IMAGE_EDITOR, FormInputCode.PRICE,\n\t\t\t\tFormInputCode.QUANTITY, FormInputCode.RESULT,\n\t\t\t\tFormInputCode.DISCOUNT,\n\t\t\t],\n\t\t\trequiredFields: [],\n\t\t\teditableFields: [],\n\t\t\tnewItemPosition: FormElementPosition.TOP,\n\t\t\tbuttonsPosition: FormElementPosition.TOP,\n\t\t\turlBuilderContext: 'SHOP',\n\t\t\thideUnselectedProperties: false,\n\t\t\tisCatalogDiscountSetEnabled: settingsCollection.get('isCatalogDiscountSetEnabled'),\n\t\t\tisCatalogPriceEditEnabled: settingsCollection.get('isCatalogPriceEditEnabled'),\n\t\t\tisCatalogPriceSaveEnabled: settingsCollection.get('isCatalogPriceSaveEnabled'),\n\t\t\tisCatalogSettingAccess: settingsCollection.get('isCatalogSettingAccess'),\n\t\t\tisCatalogAccess: settingsCollection.get('isCatalogAccess'),\n\t\t\tfieldHints: settingsCollection.get('fieldHints'),\n\t\t\tcompilationFormType: FormCompilationType.REGULAR,\n\t\t\tcompilationFormOption: {},\n\t\t\tfacebookFailProducts: null,\n\t\t\townerId: null,\n\t\t\townerTypeId: null,\n\t\t\tdialogId: null,\n\t\t\tsessionId: null,\n\t\t};\n\n\t\tif (options.visibleBlocks && !Type.isArray(options.visibleBlocks))\n\t\t{\n\t\t\tdelete(options.visibleBlocks);\n\t\t}\n\n\t\tif (options.requiredFields && !Type.isArray(options.requiredFields))\n\t\t{\n\t\t\tdelete(options.requiredFields);\n\t\t}\n\n\t\toptions = {...defaultOptions, ...options};\n\t\toptions.showTaxBlock = 'N';\n\n\t\tif (settingsCollection.get('isEnabledLanding'))\n\t\t{\n\t\t\toptions.compilationFormOption = {\n\t\t\t\ttype: options.compilationFormType,\n\t\t\t\thasStore: settingsCollection.get('hasLandingStore'),\n\t\t\t\tisLimitedStore: settingsCollection.get('isLimitedLandingStore'),\n\t\t\t\tdisabledSwitcher: settingsCollection.get('isLimitedLandingStore'),\n\t\t\t\thiddenInfoMessage: settingsCollection.get('hiddenCompilationInfoMessage'),\n\t\t\t};\n\t\t}\n\t\telse\n\t\t{\n\t\t\toptions.showCompilationModeSwitcher = false;\n\t\t}\n\n\t\toptions.defaultDiscountType = '';\n\t\tif (Type.isArray(options.allowedDiscountTypes))\n\t\t{\n\t\t\tif (options.allowedDiscountTypes.includes(DiscountType.PERCENTAGE))\n\t\t\t{\n\t\t\t\toptions.defaultDiscountType = DiscountType.PERCENTAGE;\n\t\t\t}\n\t\t\telse if (options.allowedDiscountTypes.includes(DiscountType.MONETARY))\n\t\t\t{\n\t\t\t\toptions.defaultDiscountType = DiscountType.MONETARY;\n\t\t\t}\n\t\t}\n\n\t\treturn options;\n\t}\n\n\tlayout(): HTMLElement\n\t{\n\t\treturn this.wrapper;\n\t}\n\n\tinitTemplate(result): Promise\n\t{\n\t\treturn new Promise((resolve) =>\n\t\t{\n\t\t\tconst context = this;\n\t\t\tthis.store = result.store;\n\n\t\t\tthis.templateEngine = BitrixVue.createApp({\n\t\t\t\tel: this.wrapper,\n\t\t\t\tstore: this.store,\n\t\t\t\tdata: {\n\t\t\t\t\toptions: this.options,\n\t\t\t\t\tmode: this.mode,\n\t\t\t\t},\n\t\t\t\tcreated()\n\t\t\t\t{\n\t\t\t\t\tthis.$app = context;\n\t\t\t\t},\n\t\t\t\tmounted()\n\t\t\t\t{\n\t\t\t\t\tresolve();\n\t\t\t\t},\n\t\t\t\ttemplate: `<${config.templateName} :options=\"options\" :mode=\"mode\"/>`,\n\t\t\t});\n\n\t\t\tif (Type.isStringFilled(this.options.currency))\n\t\t\t{\n\t\t\t\tthis.setData({\n\t\t\t\t\tcurrency: this.options.currency\n\t\t\t\t});\n\t\t\t\tCurrencyCore.loadCurrencyFormat(this.options.currency);\n\t\t\t}\n\n\t\t\tif (this.options.basket.length > 0)\n\t\t\t{\n\t\t\t\tthis.setData(\n\t\t\t\t\t{basket: this.options.basket,},\n\t\t\t\t\t{newItemPosition: FormElementPosition.BOTTOM}\n\t\t\t\t);\n\n\t\t\t\tif (Type.isObject(this.options.totals))\n\t\t\t\t{\n\t\t\t\t\tthis.store.commit('productList/setTotal', this.options.totals);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.store.dispatch('productList/calculateTotal');\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst newItem = this.store.getters['productList/getBaseProduct']();\n\t\t\t\tnewItem.fields.discountType = this.options.defaultDiscountType;\n\t\t\t\tthis.addProduct(newItem);\n\t\t\t}\n\n\t\t\tEventEmitter.emit(this, 'onAfterInit');\n\t\t});\n\t}\n\n\taddProduct(item = {}): void\n\t{\n\t\tthis.store.dispatch('productList/addItem', {\n\t\t\titem,\n\t\t\tposition: this.options.newItemPosition\n\t\t})\n\t\t\t.then(() => {\n\t\t\t\tthis.#onBasketChange();\n\t\t\t});\n\t}\n\n\t#onBasketChange(): void\n\t{\n\t\tEventEmitter.emit(this, 'ProductForm:onBasketChange', {\n\t\t\tbasket: this.store.getters['productList/getBasket']()\n\t\t});\n\t}\n\n\temitErrorsChange(): void\n\t{\n\t\tEventEmitter.emit(this, 'ProductForm:onErrorsChange');\n\t}\n\n\tchangeProduct(item): void\n\t{\n\t\tconst product = item.product;\n\t\tproduct.errors = [];\n\t\tif (item.skipFieldChecking !== true)\n\t\t{\n\t\t\tconst result = this.#checkRequiredFields(product);\n\t\t\tproduct.errors = result?.errors || [];\n\t\t}\n\n\t\tthis.store.dispatch('productList/changeItem', {\n\t\t\tindex: item.index,\n\t\t\tproduct\n\t\t}).then(() => {\n\t\t\tthis.#onBasketChange();\n\t\t});\n\t}\n\n\t#checkRequiredFields(product): {}\n\t{\n\t\tconst result = {};\n\t\tif (!Type.isArray(this.options.requiredFields) || this.options.requiredFields.length === 0)\n\t\t{\n\t\t\treturn result;\n\t\t}\n\n\t\tresult.errors = [];\n\t\tthis.options.requiredFields.forEach((code) => {\n\t\t\tswitch (code)\n\t\t\t{\n\t\t\t\tcase FormInputCode.PRICE:\n\t\t\t\t\tif (!this.options.isCatalogPriceSaveEnabled && product.catalogPrice <= 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tresult.errors.push({\n\t\t\t\t\t\t\tcode: FormErrorCode.EMPTY_PRICE,\n\t\t\t\t\t\t\tmessage: Loc.getMessage('CATALOG_FORM_ERROR_EMPTY_PRICE_FILL_IN_CARD'),\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\telse if (product.fields.basePrice <= 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tresult.errors.push({\n\t\t\t\t\t\t\tcode: FormErrorCode.EMPTY_PRICE,\n\t\t\t\t\t\t\tmessage: Loc.getMessage('CATALOG_FORM_ERROR_EMPTY_PRICE_1'),\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase FormInputCode.QUANTITY:\n\t\t\t\t\tif (product.fields.quantity <= 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tresult.errors.push({\n\t\t\t\t\t\t\tcode: FormErrorCode.EMPTY_QUANTITY,\n\t\t\t\t\t\t\tmessage: Loc.getMessage('CATALOG_FORM_ERROR_EMPTY_QUANTITY_1'),\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase FormInputCode.BRAND:\n\t\t\t\t\tif (!Type.isArray(product.fields.brands) || product.fields.brands.length === 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tresult.errors.push({\n\t\t\t\t\t\t\tcode: FormErrorCode.EMPTY_BRAND,\n\t\t\t\t\t\t\tmessage: Loc.getMessage('CATALOG_FORM_ERROR_EMPTY_BRAND_1'),\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase FormInputCode.IMAGE_EDITOR:\n\t\t\t\t\tif (!Type.isObject(product.fields.morePhoto) || Object.keys(product.fields.morePhoto).length === 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tresult.errors.push({\n\t\t\t\t\t\t\tcode: FormErrorCode.EMPTY_IMAGE,\n\t\t\t\t\t\t\tmessage: Loc.getMessage('CATALOG_FORM_ERROR_EMPTY_PICTURE_1'),\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t});\n\n\t\treturn result;\n\t}\n\n\tremoveProduct(product): void\n\t{\n\t\tthis.store.dispatch('productList/removeItem', {\n\t\t\tindex: product.index\n\t\t}).then(() => {\n\t\t\tthis.#onBasketChange();\n\t\t});\n\t}\n\n\tsetData(data, option = {}): void\n\t{\n\t\tif (Type.isObject(data.basket))\n\t\t{\n\t\t\tconst formBasket = this.store.getters['productList/getBasket']();\n\t\t\tdata.basket.forEach((fields) => {\n\t\t\t\tif (!Type.isObject(fields))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tconst itemPosition = option.newItemPosition || this.options.newItemPosition;\n\n\t\t\t\tconst innerId = fields.selectorId;\n\t\t\t\tif (Type.isNil(innerId))\n\t\t\t\t{\n\t\t\t\t\tthis.store.dispatch('productList/addItem', {\n\t\t\t\t\t\titem: fields,\n\t\t\t\t\t\tposition: itemPosition\n\t\t\t\t\t});\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst basketIndex = formBasket.findIndex(item => item.selectorId === innerId);\n\t\t\t\tif (basketIndex === -1)\n\t\t\t\t{\n\t\t\t\t\tthis.store.dispatch('productList/addItem', {\n\t\t\t\t\t\titem: fields,\n\t\t\t\t\t\tposition: itemPosition\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.store.dispatch('productList/changeItem', {basketIndex, fields});\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tif (Type.isStringFilled(data.currency))\n\t\t{\n\t\t\tthis.store.dispatch('productList/setCurrency', data.currency);\n\t\t}\n\n\t\tif (Type.isObject(data.total))\n\t\t{\n\t\t\tthis.store.commit('productList/setTotal', {\n\t\t\t\tsum: data.total.sum,\n\t\t\t\ttaxSum: data.total.taxSum,\n\t\t\t\tdiscount: data.total.discount,\n\t\t\t\tresult: data.total.result,\n\t\t\t})\n\t\t}\n\n\t\tif (Type.isObject(data.errors))\n\t\t{\n\t\t\tthis.store.commit('productList/setErrors', data.errors);\n\t\t}\n\t}\n\n\tchangeFormOption(optionName, value): void\n\t{\n\t\tvalue = (value === 'Y') ? 'Y' : 'N';\n\n\t\tif (optionName === 'isCompilationMode')\n\t\t{\n\t\t\tif (!this.options.showCompilationModeSwitcher)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tEventEmitter.emit(this, 'onChangeCompilationMode', {\n\t\t\t\tisCompilationMode: value === 'Y',\n\t\t\t\tisFacebookForm: this.options.compilationFormType === FormCompilationType.FACEBOOK,\n\t\t\t});\n\t\t\tconst mode = (value === 'Y') ? FormMode.COMPILATION : FormMode.REGULAR;\n\t\t\tthis.#changeCompilationModeSetting(mode);\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.options[optionName] = value;\n\t\tif (optionName !== 'hiddenCompilationInfoMessage')\n\t\t{\n\t\t\tconst basket = this.store.getters['productList/getBasket']();\n\t\t\tbasket.forEach((item, index) => {\n\t\t\t\tif (optionName === 'showDiscountBlock')\n\t\t\t\t{\n\t\t\t\t\titem.showDiscountBlock = value;\n\t\t\t\t}\n\t\t\t\telse if (optionName === 'showTaxBlock')\n\t\t\t\t{\n\t\t\t\t\titem.showTaxBlock = value;\n\t\t\t\t}\n\t\t\t\telse if (optionName === 'taxIncluded')\n\t\t\t\t{\n\t\t\t\t\titem.fields.taxIncluded = value;\n\t\t\t\t}\n\n\t\t\t\tthis.store.dispatch('productList/changeItem', {\n\t\t\t\t\tindex,\n\t\t\t\t\tfields: item\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t\tajax.runAction(\n\t\t\t'catalog.productForm.setConfig',\n\t\t\t{\n\t\t\t\tdata: {\n\t\t\t\t\tconfigName: optionName,\n\t\t\t\t\tvalue: value\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t}\n\n\t#changeCompilationModeSetting(mode: FormMode)\n\t{\n\t\tthis.#setMode(mode);\n\n\t\tconst basket = this.store.getters['productList/getBasket']();\n\n\t\tbasket.forEach((item, index) => this.changeProduct({\n\t\t\t\tindex,\n\t\t\t\tproduct: item\t,\n\t\t\t\tskipFieldChecking: (basket.length === 1 && index === 0 && item.offerId === null)\n\t\t\t})\n\t\t);\n\t}\n\n\tgetTotal(): void\n\t{\n\t\tthis.store.dispatch('productList/getTotal');\n\t}\n\n\tsetEditable(editable, isCompilationMode): void\n\t{\n\t\tthis.editable = editable;\n\t\tif (!editable && !isCompilationMode)\n\t\t{\n\t\t\tthis.#setMode(FormMode.READ_ONLY);\n\t\t}\n\t\telse if (!editable && isCompilationMode)\n\t\t{\n\t\t\tthis.#setMode(FormMode.COMPILATION_READ_ONLY);\n\t\t}\n\t\telse if (editable && isCompilationMode)\n\t\t{\n\t\t\tthis.#setMode(FormMode.COMPILATION);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.#setMode(FormMode.REGULAR);\n\t\t}\n\t}\n\n\t#setMode(mode: FormMode): void\n\t{\n\t\tthis.mode = mode;\n\t\tif (mode === FormMode.READ_ONLY)\n\t\t{\n\t\t\tthis.options.editableFields = [];\n\t\t}\n\t\telse if (mode === FormMode.COMPILATION_READ_ONLY)\n\t\t{\n\t\t\tthis.options.editableFields = [];\n\t\t\tthis.options.visibleBlocks = [\n\t\t\t\tFormInputCode.PRODUCT_SELECTOR,\n\t\t\t\tFormInputCode.IMAGE_EDITOR,\n\t\t\t\tFormInputCode.PRICE,\n\t\t\t\tFormInputCode.BRAND\n\t\t\t];\n\t\t\tthis.options.showResults = false;\n\t\t}\n\t\telse if (mode === FormMode.COMPILATION)\n\t\t{\n\t\t\tthis.options.editableFields = [\n\t\t\t\tFormInputCode.PRODUCT_SELECTOR, FormInputCode.BRAND,\n\t\t\t];\n\t\t\tthis.options.visibleBlocks = this.defaultOptions.visibleBlocks;\n\n\t\t\tif (this.options.compilationFormType === FormCompilationType.FACEBOOK)\n\t\t\t{\n\t\t\t\tthis.options.visibleBlocks = [\n\t\t\t\t\tFormInputCode.PRODUCT_SELECTOR,\n\t\t\t\t\tFormInputCode.IMAGE_EDITOR,\n\t\t\t\t\tFormInputCode.PRICE,\n\t\t\t\t\tFormInputCode.BRAND\n\t\t\t\t];\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.options.visibleBlocks = this.defaultOptions.visibleBlocks;\n\t\t\t}\n\n\t\t\tthis.options.showResults = false;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tmode = FormMode.REGULAR;\n\t\t\tthis.options.visibleBlocks = this.defaultOptions.visibleBlocks;\n\t\t\tthis.options.showResults = this.defaultOptions.showResults;\n\t\t\tthis.options.editableFields = this.defaultOptions.visibleBlocks;\n\t\t}\n\n\t\tif (this.templateEngine)\n\t\t{\n\t\t\tthis.templateEngine.mode = mode;\n\t\t}\n\n\t\tthis.options.requiredFields = [];\n\t\tif (mode === FormMode.COMPILATION)\n\t\t{\n\t\t\tlet compilationRequiredFields = [\n\t\t\t\tFormInputCode.PRODUCT_SELECTOR, FormInputCode.PRICE,\n\t\t\t];\n\t\t\tif (this.options.compilationFormType === FormCompilationType.FACEBOOK)\n\t\t\t{\n\t\t\t\tcompilationRequiredFields.push(FormInputCode.IMAGE_EDITOR);\n\t\t\t\tcompilationRequiredFields.push(FormInputCode.BRAND);\n\t\t\t}\n\t\t\tthis.options.requiredFields = this.options.visibleBlocks.filter(\n\t\t\t\titem => compilationRequiredFields.includes(item)\n\t\t\t);\n\t\t}\n\n\t\tEventEmitter.emit(this, 'ProductForm:onModeChange', { mode });\n\t}\n\n\thasErrors()\n\t{\n\t\tif (!this.store)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst basket = this.store.getters['productList/getBasket']();\n\t\tconst errorItems = basket.filter(\n\t\t\titem => item.errors.length > 0\n\t\t);\n\n\t\treturn errorItems.length > 0;\n\t}\n\n\tstatic showError(error): void\n\t{\n\t\tconsole.error(error);\n\t}\n}\n\nexport {ProductForm, FormMode}\n"],"names":["FormElementPosition","TOP","BOTTOM","ProductList","VuexBuilderModel","getName","getState","currency","taxIncluded","basket","total","sum","discount","taxSum","result","getBaseProduct","random","Text","getRandom","offerId","selectorId","fields","innerId","productId","skuId","code","module","sort","price","basePrice","priceExclusive","quantity","name","discountRate","discountInfos","discountType","DiscountType","PERCENTAGE","tax","measureCode","measureName","measureRatio","isCustomPrice","additionalFields","properties","brands","weight","dimensions","calculatedFields","catalogFields","showDiscount","showTax","skuTree","image","catalogPrice","discountSum","detailUrl","encodedFields","errors","getActions","resetBasket","commit","removeItem","dispatch","state","payload","length","forEach","item","i","index","changeItem","setCurrency","addItem","position","calculateTotal","toNumber","getGetters","getBasket","getMutations","Object","assign","push","unshift","updateItem","Type","isNil","Vue","set","product","clearBasket","deleteItem","splice","setErrors","clearErrors","setTotal","formattedTotal","isStringFilled","key","hasOwnProperty","CurrencyCore","currencyFormat","config","freeze","databaseConfig","templateName","templatePanelButtons","templatePanelCompilation","templateRowName","templateFieldInlineSelector","templateFieldPrice","templateFieldResultSum","templateFieldQuantity","templateFieldDiscount","templateFieldTax","templateFieldBrand","templateSummaryTotal","moduleId","FormInputCode","PRODUCT_SELECTOR","IMAGE_EDITOR","QUANTITY","PRICE","RESULT","DISCOUNT","TAX","BRAND","MEASURE","FormErrorCode","EMPTY_PRODUCT_SELECTOR","EMPTY_IMAGE","EMPTY_QUANTITY","EMPTY_PRICE","EMPTY_BRAND","IS_NULLABLE_PRICE","FormMode","REGULAR","READ_ONLY","COMPILATION","COMPILATION_READ_ONLY","component","props","Number","String","editable","Boolean","saveableMeasure","hasError","options","created","onInputQuantityHandler","Runtime","debounce","onInputQuantity","methods","event","target","value","replace","newQuantity","lastSymbol","substr","changeQuantity","calculateCorrectionFactor","factoredQuantity","factoredRatio","correctionFactor","isInteger","incrementValue","decrementValue","$emit","showPopupMenu","isArray","measures","menuItems","text","SYMBOL","onclick","selectMeasure","popupMenu","Menu","bindElement","items","show","params","CODE","close","template","onInputPriceHandler","onInputPrice","mounted","BX","UI","Hint","init","newPrice","computed","localize","getFilteredPhrases","currencySymbol","hintText","isCatalogPriceEditEnabled","Loc","getMessage","onInputDiscount","onChangeDiscount","onChangeType","type","MONETARY","discountValue","allowedDiscountTypes","includes","getDiscountInputValue","getDiscountSymbol","wrapperClasses","isCatalogDiscountSetEnabled","taxId","data","taxValue","getTaxList","onChangeValue","id","taxList","basketLength","basketItem","model","productSelector","imageControlId","EventEmitter","subscribe","onProductSelect","bind","onProductChange","onProductClear","$root","$app","changeProductSelectorImageRequire","ProductSelector","prepareSelectorParams","renderTo","$refs","selectorWrapper","isCompilationMode","getData","isFacebookForm","setConfig","checkEmptyImageError","layoutErrors","NAME","getField","CURRENCY","basketItemOfferId","facebookFailProducts","hasFacebookError","isObject","selectorOptions","iblockId","basePriceId","getDefaultSkuTree","fileInputId","morePhotoValues","fileInput","DETAIL_PATH","ENABLE_SEARCH","ENABLE_INPUT_DETAIL_LINK","ENABLE_IMAGE_CHANGE_SAVING","ENABLE_EMPTY_PRODUCT_ERROR","enableEmptyProductError","isRequiredField","ENABLE_EMPTY_IMAGES_ERROR","ROW_ID","ENABLE_SKU_SELECTION","HIDE_UNSELECTED_ITEMS","hideUnselectedProperties","URL_BUILDER_CONTEXT","urlBuilderContext","failedProduct","mode","MODE_EDIT","MODE_VIEW","formImage","fileView","preview","input","values","isEnabledSaving","enableCatalogSaving","hasEditRights","requiredFields","JSON","parse","defaultValue","getId","BASE_PRICE","MODULE","ID","PRODUCT_ID","SKU_ID","PROPERTIES","CUSTOMIZED","MEASURE_CODE","MEASURE_NAME","MORE_PHOTO","morePhoto","BRANDS","IS_NEW","isNew","Array","cache","Cache","MemoryCache","selector","TagSelector","dialogOptions","context","preselectedItems","getPreselectedBrands","events","onBrandChange","createBrand","searchTabOptions","stub","stubOptions","title","Tag","message","subtitle","arrow","searchOptions","allowCreateItem","entities","dynamicSearch","dynamicLoad","isSelectedByProductChange","$parent","$on","selectCurrentBrands","brandSelectorWrapper","brand","brandIndex","separator","appendChild","render","getDialog","isLoaded","deselectAll","selectDialogItems","load","getItem","entityId","select","map","getTarget","getSelectedItems","resultValues","getTitle","getAvatar","eventData","searchQuery","Promise","resolve","reject","dialog","getQuery","showLoader","ajax","runAction","then","response","hideLoader","tabs","getRecentTab","hide","catch","onInputSumHandler","onInputSum","newSum","basketItemIndex","countItems","defaultMeasure","blocks","measure","errorCodes","emptyProductSelector","emptyImage","emptyQuantity","emptyPrice","emptyBrand","initModel","changeProductFields","prepareModelFields","defaultFields","defaultPrice","PRICE_NETTO","PRICE_BRUTTO","PRICE_EXCLUSIVE","DISCOUNT_TYPE_ID","DISCOUNT_RATE","DISCOUNT_SUM","TAX_INCLUDED","TAX_RATE","ProductModel","isSimpleModel","onErrorsChange","getErrorCollection","getErrors","changeRowData","setCalculatedFields","getCalculator","setFields","SUM","getProductFieldsFromModel","modelFields","getFields","TAX_ID","skipFieldChecking","isSimple","saveCatalogField","changedFields","save","calculateBasePrice","processFields","originBasketId","originProductId","isPlainObject","onChangeSum","priceItem","isEditablePrice","onChangePrice","isEditableDiscount","toggleDiscount","changeDiscountType","changeDiscount","changeBasePrice","isSaveablePrice","onSelectMeasure","changeMeasure","showSaveNotifier","onSave","isReadOnly","setTimeout","discountWrapper","discountInput","focus","toggleTax","changeBrand","onChangeQuantity","calculateQuantity","productFields","setField","changePrice","calculatePrice","calculateDiscountType","calculateDiscount","changeTax","calculateTax","changeTaxIncluded","isEditableField","calculateTaxIncluded","isVisibleBlock","visibleBlocks","getPriceValue","getQuantityValue","getSumValue","getDiscountValue","getDiscountRateValue","isEmpty","isChanged","filteredErrors","filter","error","editableFields","isCatalogExisted","isCatalogPriceSaveEnabled","getHint","fieldHints","hasHint","watch","oldValue","showDiscountBlock","getBrandsSelectorId","getPriceExclusive","showTaxBlock","showRemoveIcon","showTaxSelector","showBasePrice","getMeasureName","getMeasureCode","isTaxIncluded","getErrorsText","errorText","facebookFailProductErrorText","hasSku","FormCompilationType","FACEBOOK","FormHelpdeskCode","COMPILATION_FACEBOOK","COMMON_COMPILATION","compilationOptions","newLabel","Label","CATALOG_FORM_COMPILATION_PRODUCT_NEW_LABEL","color","LabelColor","PRIMARY","fill","popup","compilationLink","moreMessageButton","CATALOG_FORM_COMPILATION_INFO_BUTTON_MORE","Event","openHelpDesk","header","description","CATALOG_FORM_COMPILATION_INFO_MESSAGE_TITLE_FACEBOOK","CATALOG_FORM_COMPILATION_INFO_MESSAGE_BODY_FACEBOOK_FIRST_BLOCK","CATALOG_FORM_COMPILATION_INFO_MESSAGE_BODY_FACEBOOK_SECOND_BLOCK","CATALOG_FORM_COMPILATION_INFO_MESSAGE_TITLE","CATALOG_FORM_COMPILATION_INFO_MESSAGE_BODY_MARKETING_2","MessageCard","angle","hidden","actionElements","hideMessage","label","getLayout","hiddenInfoMessage","showMessage","helpdeskCode","top","Helper","showPopup","disabledSwitcher","Popup","setBindElement","qrLink","$store","getters","productIds","ownerId","ownerTypeId","dialogId","sessionId","link","emit","compilationId","content","getQRPopupContent","width","closeIcon","right","padding","closeByEsc","autoHide","cacheable","animation","offset","buttonCopy","CATALOG_FORM_COMPILATION_QR_COPY","clipboard","copy","Notification","Center","notify","CATALOG_FORM_COMPILATION_QR_COPY_NOTIFY_MESSAGE","autoHideDelay","qrWrapper","CATALOG_FORM_COMPILATION_QR_POPUP_TITLE","CATALOG_FORM_COMPILATION_QR_POPUP_INPUT_TITLE","QRCode","height","setSetting","checked","changeFormOption","getOnBeforeCreationStorePopupContent","loaderContent","node","loader","Loader","size","getOnAfterCreationStorePopupContent","creationStorePopup","continueButton","closeCreationStorePopup","onLabelClick","isLimitedStore","InfoHelper","onClickHint","preventDefault","stopImmediatePropagation","isShown","Dom","addClass","hintIcon","removeClass","showQrLink","Vuex","mapState","productList","settings","refreshBasket","changeBasketItem","addBasketItemForm","getInternalIndexByProductId","keys","findIndex","inx","parseInt","handleAddItem","skuType","json","variationId","priceId","urlBuilder","resetSku","processResponse","isAddAnyway","productData","newItem","MEASURE_RATIO","defaultDiscountType","addProduct","onUpdateBasketItem","removeEmptyItems","modifyBasketItem","showDialogProductExists","onPopupClose","destroy","zIndex","titleBar","draggable","resizable","lightShadow","overlay","buttons","getButtons","SaveButton","CancelButton","showDialogProductSearch","funcName","window","CDialog","content_url","Math","max","innerHeight","innerWidth","min_height","min_width","Show","dataset","settingId","Slider","open","getSettingItems","warehouseOption","getSettingItem","disabled","hintNode","hint","setting","CATALOG_FORM_ADD_SHOW_DISCOUNTS_OPTION","isCatalogSettingAccess","CATALOG_FORM_ADD_SHOW_WAREHOUSE_OPTION","CATALOG_FORM_ADD_SHOW_WAREHOUSE_HINT","prepareSettingsContent","append","showConfigPopup","offsetLeft","offsetTop","noAllPaddings","bindOptions","forceBindPosition","openSlider","url","allowChangeHistory","isString","onClose","getSlider","SidePanel","Instance","hasAccessToCatalog","isCatalogAccess","order","required","sumAdditionalClass","currencyAdditionalClass","formattedSum","element","getPriceControl","changeProduct","emitErrorsChange","removeProduct","showTaxResult","showResults","showButtonsTop","singleProductMode","buttonsPosition","showButtonsBottom","showResultBlock","enableAddButtons","totalResultLabel","CATALOG_FORM_TOTAL_RESULT","ProductForm","constructor","prepareOptions","defaultOptions","wrapper","initStore","initTemplate","showError","builder","VuexBuilder","addModel","create","build","settingsCollection","Extension","getSettings","get","showCompilationModeSwitcher","pricePrecision","newItemPosition","compilationFormType","compilationFormOption","hasStore","layout","store","templateEngine","BitrixVue","createApp","el","setData","loadCurrencyFormat","totals","option","formBasket","itemPosition","basketIndex","optionName","configName","getTotal","setEditable","hasErrors","errorItems","console","compilationRequiredFields"],"mappings":"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"}