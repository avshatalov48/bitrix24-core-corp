{"version":3,"file":"iblock-product-list.bundle.js","sources":["../src/iblock-product-list.js"],"sourcesContent":["import type {BaseEvent} from 'main.core.events';\nimport {EventEmitter} from 'main.core.events';\nimport {Dom, Tag, Text, Type, Uri} from 'main.core';\nimport './style.css';\n\nexport class IblockProductList\n{\n\t/**\n\t * @type {?BX.Main.grid}\n\t */\n\tgrid;\n\tvariations = new Map();\n\tvariationsEditData = new Map();\n\teditedVariations = new Map();\n\tmorePhotoChangedInputs = new Map();\n\n\tonSettingsWindowSaveHandler = this.handleOnSettingsWindowSave.bind(this);\n\tonChangeVariationHandler = this.handleOnChangeVariation.bind(this);\n\tonBeforeGridRequestHandler = this.handleOnBeforeGridRequest.bind(this);\n\tonFilterApplyHandler = this.handleOnFilterApply.bind(this);\n\tonSaveImageHandler = this.handleOnSaveImage.bind(this);\n\n\tconstructor(options = {})\n\t{\n\t\tthis.gridId = options.gridId;\n\t\tthis.rowIdMask = options.rowIdMask || '#ID#';\n\t\tthis.variationFieldNames = options.variationFieldNames || [];\n\t\tthis.productVariationMap = options.productVariationMap || {};\n\t\tthis.createNewProductHref = options.createNewProductHref || '';\n\t\tthis.showCatalogWithOffers = options.showCatalogWithOffers || false;\n\n\t\tthis.addCustomClassToGrid();\n\t\tthis.cacheSelectedVariation();\n\n\t\tEventEmitter.subscribe('BX.Grid.SettingsWindow:save', this.onSettingsWindowSaveHandler);\n\t\tEventEmitter.subscribe('SkuProperty::onChange', this.onChangeVariationHandler);\n\t\tEventEmitter.subscribe('Grid::beforeRequest', this.onBeforeGridRequestHandler);\n\t\tEventEmitter.subscribe('BX.Main.Filter:apply', this.onFilterApplyHandler);\n\t\tEventEmitter.subscribe('Catalog.ImageInput::save', this.onSaveImageHandler);\n\t}\n\n\taddCustomClassToGrid()\n\t{\n\t\tDom.addClass(this.getGrid().getContainer(), 'catalog-product-grid');\n\t}\n\n\tcacheSelectedVariation()\n\t{\n\t\tthis.getGrid().getRows().getBodyChild().forEach((row) => {\n\t\t\tlet rowId = row.getId();\n\t\t\tlet productId = this.getProductIdByRowId(rowId);\n\t\t\tlet variationId = this.getCurrentVariationIdByProduct(productId);\n\n\t\t\tif (variationId)\n\t\t\t{\n\t\t\t\tthis.variations.set(variationId, row.getNode().cloneNode(true));\n\t\t\t\tthis.variationsEditData.set(variationId, row.getEditData());\n\t\t\t}\n\t\t});\n\t}\n\n\tclearAllVariationCache()\n\t{\n\t\tthis.variations.clear();\n\t\tthis.variationsEditData.clear();\n\t\tthis.editedVariations.clear();\n\t\tthis.morePhotoChangedInputs.clear();\n\t}\n\n\tclearVariationCache(variationId)\n\t{\n\t\tthis.variations.delete(variationId);\n\t\tthis.variationsEditData.delete(variationId);\n\t\tthis.editedVariations.delete(variationId);\n\t}\n\n\t/**\n\t * @returns {?BX.Main.grid}\n\t */\n\tgetGrid()\n\t{\n\t\tif (!this.grid)\n\t\t{\n\t\t\tthis.grid = BX.Main.gridManager.getInstanceById(this.gridId);\n\t\t}\n\n\t\treturn this.grid;\n\t}\n\n\thandleOnSettingsWindowSave(event: BaseEvent)\n\t{\n\t\tconst [settingsWindow] = event.getCompatData();\n\t\tconst selectedColumns = settingsWindow.getSelectedColumns();\n\t\tthis.showCatalogWithOffers = selectedColumns.indexOf('CATALOG_PRODUCT') !== -1;\n\t}\n\n\thandleOnChangeVariation(event: BaseEvent)\n\t{\n\t\tconst [skuFields] = event.getData();\n\t\tconst productId = Text.toNumber(skuFields.PARENT_PRODUCT_ID);\n\t\tconst variationId = Text.toNumber(skuFields.ID);\n\n\t\tif (productId <= 0 || variationId <= 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst productRow = this.getProductRow(productId);\n\n\t\tif (productRow.isEdit())\n\t\t{\n\t\t\tconst values = this.getEditedVariationValues(productRow);\n\t\t\tconst currentVariationId = this.getCurrentVariationIdByProduct(productId);\n\t\t\tthis.editedVariations.set(currentVariationId, values);\n\t\t}\n\n\t\tif (productRow.isEdit() && this.editedVariations.has(variationId))\n\t\t{\n\t\t\tconst editData = Object.assign(productRow.getEditData(), this.editedVariations.get(variationId));\n\t\t\tproductRow.setEditData(editData);\n\t\t\tproductRow.editCancel();\n\t\t\tproductRow.edit();\n\t\t\tthis.productVariationMap[productId] = variationId;\n\t\t\treturn;\n\t\t}\n\n\t\tthis.getVariation(productId, variationId)\n\t\t\t.then((variationNode) => {\n\t\t\t\tthis.updateProductRow(productId, variationId, variationNode);\n\t\t\t\tthis.productVariationMap[productId] = variationId;\n\t\t\t});\n\t}\n\n\tgetEditedVariationValues(row: BX.Grid.Row)\n\t{\n\t\tconst currentEditorValues = row.getEditorValue();\n\t\tconst headRow = this.getHeadRow();\n\t\tconst values = {};\n\t\tlet morePhotoHtml = null;\n\t\t[...row.getCells()].forEach((cell, index) => {\n\t\t\tconst cellName = headRow.getCellNameByCellIndex(index);\n\t\t\tif (cellName !== 'MORE_PHOTO')\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst editorContainer = row.getEditorContainer(cell);\n\t\t\tif (editorContainer)\n\t\t\t{\n\t\t\t\tconst imageBlock = editorContainer.querySelector('.catalog-image-input-wrapper');\n\t\t\t\tconst id = imageBlock.id;\n\t\t\t\tif (this.morePhotoChangedInputs.has(id))\n\t\t\t\t{\n\t\t\t\t\tmorePhotoHtml = this.morePhotoChangedInputs.get(id);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tmorePhotoHtml = imageBlock.outerHTML;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tfor (let name in currentEditorValues)\n\t\t{\n\t\t\tif (!currentEditorValues.hasOwnProperty(name) || !this.variationFieldNames.includes(name))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (name === 'MORE_PHOTO' && !Type.isNil(morePhotoHtml))\n\t\t\t{\n\t\t\t\tvalues[name] = morePhotoHtml;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tvalues[name] = currentEditorValues[name];\n\t\t\t}\n\t\t}\n\n\t\treturn values;\n\t}\n\n\tgetVariation(productId, variationId)\n\t{\n\t\tif (this.getProductRow(productId).isEdit() && this.editedVariations.has(variationId))\n\t\t{\n\t\t\treturn Promise.resolve(this.editedVariations.get(variationId))\n\t\t}\n\n\t\tif (this.variations.has(variationId))\n\t\t{\n\t\t\treturn Promise.resolve(this.variations.get(variationId))\n\t\t}\n\n\t\treturn new Promise((resolve) => {\n\t\t\tthis.loadVariation(productId, variationId, resolve);\n\t\t})\n\t\t\t.then((variation) => {\n\t\t\t\tif (Type.isDomNode(variation))\n\t\t\t\t{\n\t\t\t\t\tthis.variations.set(variationId, variation);\n\t\t\t\t\treturn variation;\n\t\t\t\t}\n\n\t\t\t\treturn null;\n\t\t\t});\n\t}\n\n\tloadVariation(productId, variationId, resolve)\n\t{\n\t\tconst self = this;\n\t\tconst url = '';\n\t\tconst method = 'POST';\n\t\tconst data = {productId, variationId};\n\n\t\tthis.getProductRow(productId).stateLoad();\n\t\tthis.getGrid().getData().request(url, method, data, 'changeVariation', function() {\n\t\t\tconst row = self.getProductRow(productId);\n\t\t\tif (row)\n\t\t\t{\n\t\t\t\trow.stateUnload();\n\t\t\t\tresolve(this.getRowById(row.getId()));\n\t\t\t}\n\t\t});\n\t}\n\n\tgetProductIdByRowId(rowId)\n\t{\n\t\tconst mask = new RegExp(this.rowIdMask.replace('#ID#', '([0-9]+)'));\n\t\tconst matches = rowId.match(mask);\n\n\t\treturn Type.isArray(matches) ? Text.toNumber(matches[1]) : 0;\n\t}\n\n\tgetRowIdByProductId(id)\n\t{\n\t\treturn this.rowIdMask.replace('#ID#', id);\n\t}\n\n\t/**\n\t * @param id\n\t * @returns {?BX.Grid.Row}\n\t */\n\tgetProductRow(id)\n\t{\n\t\tconst rowId = this.getRowIdByProductId(id);\n\n\t\treturn this.getGrid().getRows().getById(rowId);\n\t}\n\n\t/**\n\t * @returns {?BX.Grid.Row}\n\t */\n\tgetHeadRow()\n\t{\n\t\treturn this.getGrid().getRows().getHeadFirstChild();\n\t}\n\n\tupdateProductRow(productId, variationId, variationNode)\n\t{\n\t\tif (!productId || !Type.isDomNode(variationNode))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst headRow = this.getHeadRow();\n\t\tconst productRow = this.getProductRow(productId);\n\t\tconst fields = {};\n\n\t\t[...variationNode.cells].forEach((cell, index) => {\n\t\t\tconst cellName = headRow.getCellNameByCellIndex(index);\n\n\t\t\tif (this.variationFieldNames.includes(cellName))\n\t\t\t{\n\t\t\t\tlet columnCell = productRow.getCellByIndex(index);\n\t\t\t\tif (columnCell)\n\t\t\t\t{\n\t\t\t\t\tlet cellHtml = productRow.getContentContainer(cell).innerHTML;\n\t\t\t\t\tproductRow.getContentContainer(columnCell).innerHTML = cellHtml;\n\t\t\t\t\tfields[cellName] = cellHtml;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tif (this.variationsEditData.has(variationId))\n\t\t{\n\t\t\tproductRow.setEditData(this.variationsEditData.get(variationId));\n\t\t}\n\t\telse\n\t\t{\n\t\t\tproductRow.resetEditData();\n\t\t\tthis.variationsEditData.set(variationId, productRow.getEditData());\n\t\t}\n\n\t\tif (productRow.isEdit())\n\t\t{\n\t\t\tproductRow.editCancel();\n\t\t\tproductRow.edit();\n\t\t}\n\t}\n\n\thandleOnBeforeGridRequest(event: BaseEvent)\n\t{\n\t\tconst [, gridData] = event.getData();\n\t\tconst submitData = BX.prop.get(gridData, 'data', {});\n\n\t\t// reload settings, columns or something else\n\t\tif (!submitData.productId && !submitData.FIELDS)\n\t\t{\n\t\t\tthis.clearAllVariationCache();\n\t\t}\n\n\t\tif (submitData.FIELDS)\n\t\t{\n\t\t\tthis.editedVariations.forEach((editFields, variationId) => {\n\t\t\t\tconst rowId = this.getRowIdByProductId(variationId);\n\t\t\t\tsubmitData.FIELDS[rowId] = submitData.FIELDS[rowId] || {};\n\t\t\t\tObject.keys(editFields).map((cellName) => {\n\t\t\t\t\tif (cellName.indexOf('CATALOG_GROUP_') >= 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tconst groupPriceId = cellName.replace('CATALOG_GROUP_', '');\n\t\t\t\t\t\tif (!Type.isNil(editFields[cellName]['PRICE']))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tsubmitData['CATALOG_PRICE'] = submitData['CATALOG_PRICE'] || {};\n\t\t\t\t\t\t\tsubmitData['CATALOG_PRICE'][variationId] = submitData['CATALOG_PRICE'][variationId] || {};\n\t\t\t\t\t\t\tsubmitData['CATALOG_PRICE'][variationId][groupPriceId] = editFields[cellName]['PRICE']['VALUE'];\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!Type.isNil(editFields[cellName]['CURRENCY']))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tsubmitData['CATALOG_CURRENCY'] = submitData['CATALOG_CURRENCY'] || {};\n\t\t\t\t\t\t\tsubmitData['CATALOG_CURRENCY'][variationId] = submitData['CATALOG_CURRENCY'][variationId] || {};\n\t\t\t\t\t\t\tsubmitData['CATALOG_CURRENCY'][variationId][groupPriceId] = editFields[cellName]['CURRENCY']['VALUE'];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse if (cellName !== 'MORE_PHOTO' && cellName !== 'MORE_PHOTO_custom')\n\t\t\t\t\t{\n\t\t\t\t\t\tsubmitData.FIELDS[rowId][cellName] = editFields[cellName];\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tthis.clearVariationCache(variationId);\n\t\t\t});\n\n\t\t\tfor (let rowId in submitData.FIELDS)\n\t\t\t{\n\t\t\t\tif (!submitData.FIELDS.hasOwnProperty(rowId))\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tconst productId = this.getProductIdByRowId(rowId);\n\t\t\t\tconst variationId = this.getCurrentVariationIdByProduct(productId);\n\t\t\t\tconst newFilesRegExp = new RegExp(/([0-9A-Za-z_]+?(_n\\d+)*)\\[([A-Za-z_]+)\\]/);\n\t\t\t\tconst rowFields = submitData.FIELDS[rowId];\n\t\t\t\tconst morePhotoValues = {};\n\t\t\t\tif (!Type.isNil(rowFields['MORE_PHOTO_custom']))\n\t\t\t\t{\n\t\t\t\t\tfor (let key in rowFields['MORE_PHOTO_custom'])\n\t\t\t\t\t{\n\t\t\t\t\t\tif (!rowFields['MORE_PHOTO_custom'].hasOwnProperty(key))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst inputValue = rowFields['MORE_PHOTO_custom'][key];\n\t\t\t\t\t\tif (newFilesRegExp.test(inputValue.name))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlet fileCounter, fileSetting;\n\t\t\t\t\t\t\t[, fileCounter, , fileSetting] = inputValue.name.match(newFilesRegExp);\n\t\t\t\t\t\t\tif (fileCounter && fileSetting)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tmorePhotoValues[fileCounter] = morePhotoValues[fileCounter] || {};\n\t\t\t\t\t\t\t\tmorePhotoValues[fileCounter][fileSetting] = inputValue.value;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tmorePhotoValues[inputValue.name] = inputValue.value;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\trowFields['MORE_PHOTO'] = morePhotoValues;\n\t\t\t\tif (variationId && this.showCatalogWithOffers)\n\t\t\t\t{\n\t\t\t\t\tconst variationRowId = this.getRowIdByProductId(variationId);\n\t\t\t\t\t// clear old cache\n\t\t\t\t\tthis.clearVariationCache(variationId);\n\n\t\t\t\t\tsubmitData.FIELDS[variationRowId] = {};\n\n\t\t\t\t\tfor (let fieldName of this.variationFieldNames)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (!rowFields.hasOwnProperty(fieldName))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tsubmitData.FIELDS[variationRowId][fieldName] = rowFields[fieldName];\n\t\t\t\t\t\tdelete submitData.FIELDS[rowId][fieldName];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.morePhotoChangedInputs.clear();\n\t\t}\n\t}\n\n\tgetCurrentVariationIdByProduct(productId)\n\t{\n\t\treturn productId in this.productVariationMap ? Text.toNumber(this.productVariationMap[productId]) : null;\n\t}\n\n\thandleOnFilterApply(event: BaseEvent)\n\t{\n\t\tconst data = event.getData();\n\t\tconst filterGridId = data[0];\n\t\tconst filter = data[2] instanceof BX.Main.Filter ? event.getData()[2] : null;\n\n\t\tif (filter && (filterGridId === this.gridId))\n\t\t{\n\t\t\tconst filterFields = this.getFilterFields(filter);\n\n\t\t\tlet sectionId = '0';\n\n\t\t\tif (Type.isArray(filterFields))\n\t\t\t{\n\t\t\t\tconst fieldSectionId = this.getFieldSectionId(filterFields);\n\n\t\t\t\tif (fieldSectionId)\n\t\t\t\t{\n\t\t\t\t\tconst value = fieldSectionId['VALUE'];\n\n\t\t\t\t\tif (Type.isObject(value))\n\t\t\t\t\t{\n\t\t\t\t\t\tsectionId = value['VALUE'];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.setNewProductButtonHrefSectionId(sectionId);\n\t\t}\n\t}\n\n\thandleOnSaveImage(event: BaseEvent)\n\t{\n\t\tconst [id, inputId, response] = event.getData();\n\t\tthis.morePhotoChangedInputs.set(id, response.data.input);\n\t}\n\n\tgetFilterFields(filter: BX.Main.Filter)\n\t{\n\t\tconst presets = filter.getParam('PRESETS');\n\n\t\tlet tmpFilterPreset = null;\n\n\t\tif (Type.isArray(presets))\n\t\t{\n\t\t\ttmpFilterPreset = presets.find((preset) => {\n\t\t\t\treturn preset['ID'] === 'tmp_filter';\n\t\t\t});\n\t\t}\n\n\t\tif (tmpFilterPreset)\n\t\t{\n\t\t\treturn tmpFilterPreset['FIELDS'] || null;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tgetFieldSectionId(fields: Array)\n\t{\n\t\treturn fields.find((field) => {\n\t\t\treturn field['ID'] === 'field_SECTION_ID'\n\t\t});\n\t}\n\n\tsetNewProductButtonHrefSectionId(sectionId: String)\n\t{\n\t\tconst uri = new Uri(this.createNewProductHref);\n\t\turi.setQueryParams({\n\t\t\tIBLOCK_SECTION_ID: sectionId,\n\t\t});\n\t\tconst button = document.getElementById('create_new_product_button_' + this.gridId);\n\n\t\tif (Type.isDomNode(button))\n\t\t{\n\t\t\tbutton.href = uri.getPath() + uri.getQuery();\n\t\t}\n\t}\n}"],"names":["IblockProductList","options","Map","handleOnSettingsWindowSave","bind","handleOnChangeVariation","handleOnBeforeGridRequest","handleOnFilterApply","handleOnSaveImage","gridId","rowIdMask","variationFieldNames","productVariationMap","createNewProductHref","showCatalogWithOffers","addCustomClassToGrid","cacheSelectedVariation","EventEmitter","subscribe","onSettingsWindowSaveHandler","onChangeVariationHandler","onBeforeGridRequestHandler","onFilterApplyHandler","onSaveImageHandler","Dom","addClass","getGrid","getContainer","getRows","getBodyChild","forEach","row","rowId","getId","productId","getProductIdByRowId","variationId","getCurrentVariationIdByProduct","variations","set","getNode","cloneNode","variationsEditData","getEditData","clear","editedVariations","morePhotoChangedInputs","delete","grid","BX","Main","gridManager","getInstanceById","event","getCompatData","settingsWindow","selectedColumns","getSelectedColumns","indexOf","getData","skuFields","Text","toNumber","PARENT_PRODUCT_ID","ID","productRow","getProductRow","isEdit","values","getEditedVariationValues","currentVariationId","has","editData","Object","assign","get","setEditData","editCancel","edit","getVariation","then","variationNode","updateProductRow","currentEditorValues","getEditorValue","headRow","getHeadRow","morePhotoHtml","getCells","cell","index","cellName","getCellNameByCellIndex","editorContainer","getEditorContainer","imageBlock","querySelector","id","outerHTML","name","hasOwnProperty","includes","Type","isNil","Promise","resolve","loadVariation","variation","isDomNode","self","url","method","data","stateLoad","request","stateUnload","getRowById","mask","RegExp","replace","matches","match","isArray","getRowIdByProductId","getById","getHeadFirstChild","cells","columnCell","getCellByIndex","cellHtml","getContentContainer","innerHTML","fields","resetEditData","gridData","submitData","prop","FIELDS","clearAllVariationCache","editFields","keys","map","groupPriceId","clearVariationCache","newFilesRegExp","rowFields","morePhotoValues","key","inputValue","test","fileCounter","fileSetting","value","variationRowId","fieldName","filterGridId","filter","Filter","filterFields","getFilterFields","sectionId","fieldSectionId","getFieldSectionId","isObject","setNewProductButtonHrefSectionId","inputId","response","input","presets","getParam","tmpFilterPreset","find","preset","field","uri","Uri","setQueryParams","IBLOCK_SECTION_ID","button","document","getElementById","href","getPath","getQuery"],"mappings":"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"}