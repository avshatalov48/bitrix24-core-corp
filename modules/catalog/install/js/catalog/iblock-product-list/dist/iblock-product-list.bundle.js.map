{"version":3,"file":"iblock-product-list.bundle.js","sources":["../src/iblock-product-list.js"],"sourcesContent":["import type {BaseEvent} from 'main.core.events';\nimport {EventEmitter} from 'main.core.events';\nimport {Dom, Tag, Text, Type, Uri} from 'main.core';\nimport './style.css';\n\nexport class IblockProductList\n{\n\t/**\n\t * @type {?BX.Main.grid}\n\t */\n\tgrid;\n\tvariations = new Map();\n\tvariationsEditData = new Map();\n\teditedVariations = new Map();\n\tmorePhotoChangedInputs = new Map();\n\n\tonSettingsWindowSaveHandler = this.handleOnSettingsWindowSave.bind(this);\n\tonChangeVariationHandler = this.handleOnChangeVariation.bind(this);\n\tonBeforeGridRequestHandler = this.handleOnBeforeGridRequest.bind(this);\n\tonFilterApplyHandler = this.handleOnFilterApply.bind(this);\n\tonSaveImageHandler = this.handleOnSaveImage.bind(this);\n\n\tconstructor(options = {})\n\t{\n\t\tthis.gridId = options.gridId;\n\t\tthis.rowIdMask = options.rowIdMask || '#ID#';\n\t\tthis.variationFieldNames = options.variationFieldNames || [];\n\t\tthis.productVariationMap = options.productVariationMap || {};\n\t\tthis.createNewProductHref = options.createNewProductHref || '';\n\t\tthis.showCatalogWithOffers = options.showCatalogWithOffers || false;\n\n\t\tthis.addCustomClassToGrid();\n\t\tthis.cacheSelectedVariation();\n\n\t\tEventEmitter.subscribe('BX.Grid.SettingsWindow:save', this.onSettingsWindowSaveHandler);\n\t\tEventEmitter.subscribe('SkuProperty::onChange', this.onChangeVariationHandler);\n\t\tEventEmitter.subscribe('Grid::beforeRequest', this.onBeforeGridRequestHandler);\n\t\tEventEmitter.subscribe('BX.Main.Filter:apply', this.onFilterApplyHandler);\n\t\tEventEmitter.subscribe('Catalog.ImageInput::save', this.onSaveImageHandler);\n\t}\n\n\taddCustomClassToGrid()\n\t{\n\t\tDom.addClass(this.getGrid().getContainer(), 'catalog-product-grid');\n\t}\n\n\tcacheSelectedVariation()\n\t{\n\t\tthis.getGrid().getRows().getBodyChild().forEach((row) => {\n\t\t\tlet rowId = row.getId();\n\t\t\tlet productId = this.getProductIdByRowId(rowId);\n\t\t\tlet variationId = this.getCurrentVariationIdByProduct(productId);\n\n\t\t\tif (variationId)\n\t\t\t{\n\t\t\t\tthis.variations.set(variationId, row.getNode().cloneNode(true));\n\t\t\t\tthis.variationsEditData.set(variationId, row.getEditData());\n\t\t\t}\n\t\t});\n\t}\n\n\tclearAllVariationCache()\n\t{\n\t\tthis.variations.clear();\n\t\tthis.variationsEditData.clear();\n\t\tthis.editedVariations.clear();\n\t\tthis.morePhotoChangedInputs.clear();\n\t}\n\n\tclearVariationCache(variationId)\n\t{\n\t\tthis.variations.delete(variationId);\n\t\tthis.variationsEditData.delete(variationId);\n\t\tthis.editedVariations.delete(variationId);\n\t}\n\n\t/**\n\t * @returns {?BX.Main.grid}\n\t */\n\tgetGrid()\n\t{\n\t\tif (!this.grid)\n\t\t{\n\t\t\tthis.grid = BX.Main.gridManager.getInstanceById(this.gridId);\n\t\t}\n\n\t\treturn this.grid;\n\t}\n\n\thandleOnSettingsWindowSave(event: BaseEvent)\n\t{\n\t\tconst [settingsWindow] = event.getCompatData();\n\t\tconst selectedColumns = settingsWindow.getSelectedColumns();\n\t\tthis.showCatalogWithOffers = selectedColumns.indexOf('CATALOG_PRODUCT') !== -1;\n\t}\n\n\thandleOnChangeVariation(event: BaseEvent)\n\t{\n\t\tconst [skuFields] = event.getData();\n\t\tconst productId = Text.toNumber(skuFields.PARENT_PRODUCT_ID);\n\t\tconst variationId = Text.toNumber(skuFields.ID);\n\n\t\tif (productId <= 0 || variationId <= 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst productRow = this.getProductRow(productId);\n\n\t\tif (productRow.isEdit())\n\t\t{\n\t\t\tconst values = this.getEditedVariationValues(productRow);\n\t\t\tconst currentVariationId = this.getCurrentVariationIdByProduct(productId);\n\t\t\tthis.editedVariations.set(currentVariationId, values);\n\t\t}\n\n\t\tif (productRow.isEdit() && this.editedVariations.has(variationId))\n\t\t{\n\t\t\tconst editData = Object.assign(productRow.getEditData(), this.editedVariations.get(variationId));\n\t\t\tproductRow.setEditData(editData);\n\t\t\tproductRow.editCancel();\n\t\t\tproductRow.edit();\n\t\t\tthis.productVariationMap[productId] = variationId;\n\t\t\treturn;\n\t\t}\n\n\t\tthis.getVariation(productId, variationId)\n\t\t\t.then((variationNode) => {\n\t\t\t\tthis.updateProductRow(productId, variationId, variationNode);\n\t\t\t\tthis.productVariationMap[productId] = variationId;\n\t\t\t});\n\t}\n\n\tgetEditedVariationValues(row: BX.Grid.Row)\n\t{\n\t\tconst currentEditorValues = row.getEditorValue();\n\t\tconst headRow = this.getHeadRow();\n\t\tconst values = {};\n\t\tlet morePhotoHtml = null;\n\t\t[...row.getCells()].forEach((cell, index) => {\n\t\t\tconst cellName = headRow.getCellNameByCellIndex(index);\n\t\t\tif (cellName !== 'MORE_PHOTO')\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst editorContainer = row.getEditorContainer(cell);\n\t\t\tif (editorContainer)\n\t\t\t{\n\t\t\t\tconst imageBlock = editorContainer.querySelector('.catalog-image-input-wrapper');\n\t\t\t\tconst id = imageBlock.id;\n\t\t\t\tif (this.morePhotoChangedInputs.has(id))\n\t\t\t\t{\n\t\t\t\t\tmorePhotoHtml = this.morePhotoChangedInputs.get(id);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tmorePhotoHtml = imageBlock.outerHTML;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tfor (let name in currentEditorValues)\n\t\t{\n\t\t\tif (!currentEditorValues.hasOwnProperty(name) || !this.variationFieldNames.includes(name))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (name === 'MORE_PHOTO' && !Type.isNil(morePhotoHtml))\n\t\t\t{\n\t\t\t\tvalues[name] = morePhotoHtml;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tvalues[name] = currentEditorValues[name];\n\t\t\t}\n\t\t}\n\n\t\treturn values;\n\t}\n\n\tgetVariation(productId, variationId)\n\t{\n\t\tif (this.getProductRow(productId).isEdit() && this.editedVariations.has(variationId))\n\t\t{\n\t\t\treturn Promise.resolve(this.editedVariations.get(variationId))\n\t\t}\n\n\t\tif (this.variations.has(variationId))\n\t\t{\n\t\t\treturn Promise.resolve(this.variations.get(variationId))\n\t\t}\n\n\t\treturn new Promise((resolve) => {\n\t\t\tthis.loadVariation(productId, variationId, resolve);\n\t\t})\n\t\t\t.then((variation) => {\n\t\t\t\tif (Type.isDomNode(variation))\n\t\t\t\t{\n\t\t\t\t\tthis.variations.set(variationId, variation);\n\t\t\t\t\treturn variation;\n\t\t\t\t}\n\n\t\t\t\treturn null;\n\t\t\t});\n\t}\n\n\tloadVariation(productId, variationId, resolve)\n\t{\n\t\tconst self = this;\n\t\tconst url = '';\n\t\tconst method = 'POST';\n\t\tconst data = {productId, variationId};\n\n\t\tthis.getProductRow(productId).stateLoad();\n\t\tthis.getGrid().getData().request(url, method, data, 'changeVariation', function() {\n\t\t\tconst row = self.getProductRow(productId);\n\t\t\tif (row)\n\t\t\t{\n\t\t\t\trow.stateUnload();\n\t\t\t\tresolve(this.getRowById(row.getId()));\n\t\t\t}\n\t\t});\n\t}\n\n\tgetProductIdByRowId(rowId)\n\t{\n\t\tconst mask = new RegExp(this.rowIdMask.replace('#ID#', '([0-9]+)'));\n\t\tconst matches = rowId.match(mask);\n\n\t\treturn Type.isArray(matches) ? Text.toNumber(matches[1]) : 0;\n\t}\n\n\tgetRowIdByProductId(id)\n\t{\n\t\treturn this.rowIdMask.replace('#ID#', id);\n\t}\n\n\t/**\n\t * @param id\n\t * @returns {?BX.Grid.Row}\n\t */\n\tgetProductRow(id)\n\t{\n\t\tconst rowId = this.getRowIdByProductId(id);\n\n\t\treturn this.getGrid().getRows().getById(rowId);\n\t}\n\n\t/**\n\t * @returns {?BX.Grid.Row}\n\t */\n\tgetHeadRow()\n\t{\n\t\treturn this.getGrid().getRows().getHeadFirstChild();\n\t}\n\n\tupdateProductRow(productId, variationId, variationNode)\n\t{\n\t\tif (!productId || !Type.isDomNode(variationNode))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst headRow = this.getHeadRow();\n\t\tconst productRow = this.getProductRow(productId);\n\t\tconst fields = {};\n\n\t\t[...variationNode.cells].forEach((cell, index) => {\n\t\t\tconst cellName = headRow.getCellNameByCellIndex(index);\n\n\t\t\tif (this.variationFieldNames.includes(cellName))\n\t\t\t{\n\t\t\t\tlet columnCell = productRow.getCellByIndex(index);\n\t\t\t\tif (columnCell)\n\t\t\t\t{\n\t\t\t\t\tlet cellHtml = productRow.getContentContainer(cell).innerHTML;\n\t\t\t\t\tproductRow.getContentContainer(columnCell).innerHTML = cellHtml;\n\t\t\t\t\tfields[cellName] = cellHtml;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tif (this.variationsEditData.has(variationId))\n\t\t{\n\t\t\tproductRow.setEditData(this.variationsEditData.get(variationId));\n\t\t}\n\t\telse\n\t\t{\n\t\t\tproductRow.resetEditData();\n\t\t\tthis.variationsEditData.set(variationId, productRow.getEditData());\n\t\t}\n\n\t\tif (productRow.isEdit())\n\t\t{\n\t\t\tproductRow.editCancel();\n\t\t\tproductRow.edit();\n\t\t}\n\t}\n\n\thandleOnBeforeGridRequest(event: BaseEvent)\n\t{\n\t\tconst [, gridData] = event.getData();\n\t\tconst submitData = BX.prop.get(gridData, 'data', {});\n\n\t\t// reload settings, columns or something else\n\t\tif (!submitData.productId && !submitData.FIELDS)\n\t\t{\n\t\t\tthis.clearAllVariationCache();\n\t\t}\n\n\t\tif (submitData.FIELDS)\n\t\t{\n\t\t\tthis.editedVariations.forEach((editFields, variationId) => {\n\t\t\t\tconst rowId = this.getRowIdByProductId(variationId);\n\t\t\t\tsubmitData.FIELDS[rowId] = submitData.FIELDS[rowId] || {};\n\t\t\t\tObject.keys(editFields).map((cellName) => {\n\t\t\t\t\tif (cellName.indexOf('CATALOG_GROUP_') >= 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tconst groupPriceId = cellName.replace('CATALOG_GROUP_', '');\n\t\t\t\t\t\tif (!Type.isNil(editFields[cellName]['PRICE']))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tsubmitData['CATALOG_PRICE'] = submitData['CATALOG_PRICE'] || {};\n\t\t\t\t\t\t\tsubmitData['CATALOG_PRICE'][variationId] = submitData['CATALOG_PRICE'][variationId] || {};\n\t\t\t\t\t\t\tsubmitData['CATALOG_PRICE'][variationId][groupPriceId] = editFields[cellName]['PRICE']['VALUE'];\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!Type.isNil(editFields[cellName]['CURRENCY']))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tsubmitData['CATALOG_CURRENCY'] = submitData['CATALOG_CURRENCY'] || {};\n\t\t\t\t\t\t\tsubmitData['CATALOG_CURRENCY'][variationId] = submitData['CATALOG_CURRENCY'][variationId] || {};\n\t\t\t\t\t\t\tsubmitData['CATALOG_CURRENCY'][variationId][groupPriceId] = editFields[cellName]['CURRENCY']['VALUE'];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse if (cellName !== 'MORE_PHOTO' && cellName !== 'MORE_PHOTO_custom')\n\t\t\t\t\t{\n\t\t\t\t\t\tsubmitData.FIELDS[rowId][cellName] = editFields[cellName];\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tthis.clearVariationCache(variationId);\n\t\t\t});\n\n\t\t\tfor (let rowId in submitData.FIELDS)\n\t\t\t{\n\t\t\t\tif (!submitData.FIELDS.hasOwnProperty(rowId))\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tconst productId = this.getProductIdByRowId(rowId);\n\t\t\t\tconst variationId = this.getCurrentVariationIdByProduct(productId);\n\t\t\t\tconst newFilesRegExp = new RegExp(/([0-9A-Za-z_]+?(_n\\d+)*)\\[([A-Za-z_]+)\\]/);\n\t\t\t\tconst rowFields = submitData.FIELDS[rowId];\n\t\t\t\tconst morePhotoValues = {};\n\t\t\t\tif (!Type.isNil(rowFields['MORE_PHOTO_custom']))\n\t\t\t\t{\n\t\t\t\t\tfor (let key in rowFields['MORE_PHOTO_custom'])\n\t\t\t\t\t{\n\t\t\t\t\t\tif (!rowFields['MORE_PHOTO_custom'].hasOwnProperty(key))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst inputValue = rowFields['MORE_PHOTO_custom'][key];\n\t\t\t\t\t\tif (newFilesRegExp.test(inputValue.name))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlet fileCounter, fileSetting;\n\t\t\t\t\t\t\t[, fileCounter, , fileSetting] = inputValue.name.match(newFilesRegExp);\n\t\t\t\t\t\t\tif (fileCounter && fileSetting)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tmorePhotoValues[fileCounter] = morePhotoValues[fileCounter] || {};\n\t\t\t\t\t\t\t\tmorePhotoValues[fileCounter][fileSetting] = inputValue.value;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tmorePhotoValues[inputValue.name] = inputValue.value;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\trowFields['MORE_PHOTO'] = morePhotoValues;\n\t\t\t\tif (variationId && this.showCatalogWithOffers)\n\t\t\t\t{\n\t\t\t\t\tconst variationRowId = this.getRowIdByProductId(variationId);\n\t\t\t\t\t// clear old cache\n\t\t\t\t\tthis.clearVariationCache(variationId);\n\n\t\t\t\t\tsubmitData.FIELDS[variationRowId] = {};\n\n\t\t\t\t\tfor (let fieldName of this.variationFieldNames)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (!rowFields.hasOwnProperty(fieldName))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tsubmitData.FIELDS[variationRowId][fieldName] = rowFields[fieldName];\n\t\t\t\t\t\tdelete submitData.FIELDS[rowId][fieldName];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.morePhotoChangedInputs.clear();\n\t\t}\n\t}\n\n\tgetCurrentVariationIdByProduct(productId)\n\t{\n\t\treturn productId in this.productVariationMap ? Text.toNumber(this.productVariationMap[productId]) : null;\n\t}\n\n\thandleOnFilterApply(event: BaseEvent)\n\t{\n\t\tconst data = event.getData();\n\t\tconst filterGridId = data[0];\n\t\tconst filter = data[2] instanceof BX.Main.Filter ? event.getData()[2] : null;\n\n\t\tif (filter && (filterGridId === this.gridId))\n\t\t{\n\t\t\tconst filterFields = this.getFilterFields(filter);\n\n\t\t\tlet sectionId = '0';\n\n\t\t\tif (Type.isArray(filterFields))\n\t\t\t{\n\t\t\t\tconst fieldSectionId = this.getFieldSectionId(filterFields);\n\n\t\t\t\tif (fieldSectionId)\n\t\t\t\t{\n\t\t\t\t\tconst value = fieldSectionId['VALUE'];\n\n\t\t\t\t\tif (Type.isObject(value))\n\t\t\t\t\t{\n\t\t\t\t\t\tsectionId = value['VALUE'];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.setNewProductButtonHrefSectionId(sectionId);\n\t\t}\n\t}\n\n\thandleOnSaveImage(event: BaseEvent)\n\t{\n\t\tconst [id, inputId, response] = event.getData();\n\t\tthis.morePhotoChangedInputs.set(id, response.data.input);\n\t}\n\n\tgetFilterFields(filter: BX.Main.Filter)\n\t{\n\t\tconst presets = filter.getParam('PRESETS');\n\n\t\tlet tmpFilterPreset = null;\n\n\t\tif (Type.isArray(presets))\n\t\t{\n\t\t\ttmpFilterPreset = presets.find((preset) => {\n\t\t\t\treturn preset['ID'] === 'tmp_filter';\n\t\t\t});\n\t\t}\n\n\t\tif (tmpFilterPreset)\n\t\t{\n\t\t\treturn tmpFilterPreset['FIELDS'] || null;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tgetFieldSectionId(fields: Array)\n\t{\n\t\treturn fields.find((field) => {\n\t\t\treturn field['ID'] === 'field_SECTION_ID'\n\t\t});\n\t}\n\n\tsetNewProductButtonHrefSectionId(sectionId: String)\n\t{\n\t\tconst uri = new Uri(this.createNewProductHref);\n\t\turi.setQueryParams({\n\t\t\tIBLOCK_SECTION_ID: sectionId,\n\t\t});\n\t\tconst button = document.getElementById('create_new_product_button_' + this.gridId);\n\n\t\tif (Type.isDomNode(button))\n\t\t{\n\t\t\tbutton.href = uri.getPath() + uri.getQuery();\n\t\t}\n\t}\n}"],"names":["IblockProductList","options","Map","handleOnSettingsWindowSave","bind","handleOnChangeVariation","handleOnBeforeGridRequest","handleOnFilterApply","handleOnSaveImage","gridId","rowIdMask","variationFieldNames","productVariationMap","createNewProductHref","showCatalogWithOffers","addCustomClassToGrid","cacheSelectedVariation","EventEmitter","subscribe","onSettingsWindowSaveHandler","onChangeVariationHandler","onBeforeGridRequestHandler","onFilterApplyHandler","onSaveImageHandler","Dom","addClass","getGrid","getContainer","getRows","getBodyChild","forEach","row","rowId","getId","productId","getProductIdByRowId","variationId","getCurrentVariationIdByProduct","variations","set","getNode","cloneNode","variationsEditData","getEditData","clear","editedVariations","morePhotoChangedInputs","grid","BX","Main","gridManager","getInstanceById","event","getCompatData","settingsWindow","selectedColumns","getSelectedColumns","indexOf","getData","skuFields","Text","toNumber","PARENT_PRODUCT_ID","ID","productRow","getProductRow","isEdit","values","getEditedVariationValues","currentVariationId","has","editData","Object","assign","get","setEditData","editCancel","edit","getVariation","then","variationNode","updateProductRow","currentEditorValues","getEditorValue","headRow","getHeadRow","morePhotoHtml","getCells","cell","index","cellName","getCellNameByCellIndex","editorContainer","getEditorContainer","imageBlock","querySelector","id","outerHTML","name","hasOwnProperty","includes","Type","isNil","Promise","resolve","loadVariation","variation","isDomNode","self","url","method","data","stateLoad","request","stateUnload","getRowById","mask","RegExp","replace","matches","match","isArray","getRowIdByProductId","getById","getHeadFirstChild","cells","columnCell","getCellByIndex","cellHtml","getContentContainer","innerHTML","resetEditData","gridData","submitData","prop","FIELDS","clearAllVariationCache","editFields","keys","map","groupPriceId","clearVariationCache","newFilesRegExp","rowFields","morePhotoValues","key","inputValue","test","fileCounter","fileSetting","value","variationRowId","fieldName","filterGridId","filter","Filter","filterFields","getFilterFields","sectionId","fieldSectionId","getFieldSectionId","isObject","setNewProductButtonHrefSectionId","inputId","response","input","presets","getParam","tmpFilterPreset","find","preset","fields","field","uri","Uri","setQueryParams","IBLOCK_SECTION_ID","button","document","getElementById","href","getPath","getQuery"],"mappings":"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"}