{"version":3,"file":"document-card.bundle.js","sources":["../src/product-list/controller.js","../src/card/controller.js","../src/controllers-factory.js","../src/model/model.js","../src/model/model-factory.js","../src/editor-fields/row-summary.js","../src/editor-fields/contractor.js","../src/editor-fields/fields-factory.js","../src/card/card.js"],"sourcesContent":["import {BaseEvent, EventEmitter} from 'main.core.events'\nimport DocumentCard from \"../card/card\";\n\nexport default class ProductListController extends BX.UI.EntityEditorController\n{\n\tconstructor(id, settings)\n\t{\n\t\tsuper();\n\t\tthis.initialize(id, settings);\n\t\tthis._setProductListHandler = this.handleSetProductList.bind(this);\n\t\tthis._tabShowHandler = this.onTabShow.bind(this);\n\n\t\tthis._editorControlChangeHandler = this.onEditorControlChange.bind(this);\n\n\t\tthis._currencyId = this._model.getField('CURRENCY', '');\n\n\t\tEventEmitter.subscribe(this._editor, 'onControlChanged', this.onEditorControlChange.bind(this));\n\t\tEventEmitter.subscribe('DocumentProductListController', this._setProductListHandler);\n\t\tEventEmitter.subscribe('onEntityDetailsTabShow', this._tabShowHandler);\n\t}\n\n\thandleSetProductList(event)\n\t{\n\t\tconst productList = event.getData()[0];\n\t\tthis.setProductList(productList);\n\t\tEventEmitter.unsubscribe('DocumentProductListController', this._setProductListHandler);\n\t}\n\n\treinitializeProductList()\n\t{\n\t\tif (this.productList)\n\t\t{\n\t\t\tthis.productList.reloadGrid(false);\n\t\t}\n\t}\n\n\tonTabShow(event: BaseEvent)\n\t{\n\t\tconst [tab] = event.getData();\n\t\tif (tab.id === 'tab_products' && this.productList)\n\t\t{\n\t\t\tthis.productList.handleOnTabShow();\n\t\t\tEventEmitter.unsubscribe('onEntityDetailsTabShow', this._tabShowHandler);\n\t\t\tEventEmitter.emit('onDocumentProductListTabShow', this);\n\t\t}\n\t}\n\n\tinnerCancel()\n\t{\n\t\tthis.rollback();\n\t\tif (this.productList)\n\t\t{\n\t\t\tthis.productList.onInnerCancel();\n\t\t}\n\n\t\tthis._currencyId = this._model.getField('CURRENCY');\n\n\t\tif (this.productList)\n\t\t{\n\t\t\tthis.productList.changeCurrencyId(this._currencyId);\n\t\t}\n\n\t\tthis._isChanged = false;\n\t}\n\n\tgetCurrencyId = function()\n\t{\n\t\treturn this._currencyId;\n\t}\n\n\tsetProductList(productList)\n\t{\n\t\tif (this.productList === productList)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.productList)\n\t\t{\n\t\t\tthis.productList.destroy();\n\t\t}\n\n\t\tthis.productList = productList;\n\n\t\tif (this.productList)\n\t\t{\n\t\t\tthis.productList.setController(this);\n\t\t\tthis.productList.setForm(this._editor.getFormElement());\n\n\t\t\tif (this.productList.getCurrencyId() !== this.getCurrencyId())\n\t\t\t{\n\t\t\t\tthis.productList.changeCurrencyId(this.getCurrencyId());\n\t\t\t}\n\n\t\t\tthis._prevProductCount = this._curProductCount = this.productList.getProductCount();\n\t\t}\n\t}\n\n\tonAfterSave()\n\t{\n\t\tsuper.onAfterSave();\n\t\tif (this.productList)\n\t\t{\n\t\t\tthis.productList.removeFormFields();\n\t\t}\n\n\t\tthis._editor._toolPanel.showViewModeButtons();\n\t}\n\n\tproductChange(disableSaveButton = false)\n\t{\n\t\tdisableSaveButton = disableSaveButton ?? false;\n\t\tthis.markAsChanged();\n\n\t\tif (disableSaveButton)\n\t\t{\n\t\t\tthis.disableSaveButton();\n\t\t}\n\n\t\tEventEmitter.emit('onDocumentProductChange', this.productList.getProductsFields());\n\t}\n\n\tonBeforeSubmit()\n\t{\n\t\tif (this.productList && (this.isChanged() || this._editor.isNew()))\n\t\t{\n\t\t\tthis.productList.compileProductData();\n\t\t}\n\t}\n\n\tenableSaveButton()\n\t{\n\t\tif (this._editor?._toolPanel)\n\t\t{\n\t\t\tthis._editor._toolPanel.enableSaveButton();\n\t\t}\n\t}\n\n\tdisableSaveButton()\n\t{\n\t\tif (this._editor?._toolPanel)\n\t\t{\n\t\t\tthis._editor._toolPanel.disableSaveButton();\n\t\t}\n\t}\n\n\tonEditorControlChange(event: BaseEvent)\n\t{\n\t\tconst [field, params] = event.getData();\n\t\tif (field instanceof BX.UI.EntityEditorMoney && params?.fieldName === 'CURRENCY')\n\t\t{\n\t\t\tthis._currencyId = params?.fieldValue;\n\n\t\t\tif (this.productList && this._currencyId)\n\t\t\t{\n\t\t\t\tthis.productList.changeCurrencyId(this._currencyId);\n\t\t\t\tthis.markAsChanged();\n\t\t\t}\n\t\t}\n\t}\n\n\tsetTotal(totalData)\n\t{\n\t\tthis._model.setField(\n\t\t\t'FORMATTED_TOTAL',\n\t\t\tBX.Currency.currencyFormat(totalData.totalCost, this.getCurrencyId(), false),\n\t\t);\n\n\t\tthis._model.setField(\n\t\t\t'FORMATTED_TOTAL_WITH_CURRENCY',\n\t\t\tBX.Currency.currencyFormat(totalData.totalCost, this.getCurrencyId(), true),\n\t\t);\n\n\t\tthis._model.setField(\n\t\t\t'TOTAL',\n\t\t\ttotalData.totalCost,\n\t\t);\n\n\t\tthis._editor.getControlById('TOTAL_WITH_CURRENCY').refreshLayout();\n\t}\n}\n","export default class DocumentCardController extends BX.UI.EntityEditorController\n{\n\tconstructor(id, settings)\n\t{\n\t\tsuper();\n\t\tthis.initialize(id, settings);\n\t\tthis._model.lockField('TOTAL');\n\t}\n\n\tonAfterSave()\n\t{\n\t\tsuper.onAfterSave();\n\t\twindow.top.BX.onCustomEvent('DocumentCard:onDocumentCardSave');\n\t\tlet sliders = BX.SidePanel.Instance.getOpenSliders();\n\t\tsliders.forEach((slider) => {\n\t\t\tif (slider.getWindow()?.BX.Catalog?.DocumentGridManager)\n\t\t\t{\n\t\t\t\tslider.getWindow().BX.onCustomEvent('DocumentCard:onDocumentCardSave');\n\t\t\t}\n\t\t});\n\t}\n}\n","import {type BaseEvent, EventEmitter} from 'main.core.events';\nimport ProductListController from \"./product-list/controller\";\nimport DocumentCardController from \"./card/controller\";\n\nexport default class ControllersFactory\n{\n\tconstructor()\n\t{\n\t\tEventEmitter.subscribe('BX.UI.EntityEditorControllerFactory:onInitialize', (event: BaseEvent) => {\n\t\t\tconst [, eventArgs] = event.getCompatData();\n\t\t\teventArgs.methods['entityCard'] = this.factory.bind(this);\n\t\t});\n\t}\n\n\tfactory(type, controlId, settings)\n\t{\n\t\tif (type === 'document_card')\n\t\t{\n\t\t\treturn new DocumentCardController(controlId, settings);\n\t\t}\n\n\t\tif (type === 'product_list')\n\t\t{\n\t\t\treturn new ProductListController(controlId, settings);\n\t\t}\n\n\t\treturn null;\n\t}\n}\n","export default class DocumentModel extends BX.UI.EntityModel\n{\n\tconstructor(id, settings) {\n\t\tsuper();\n\t\tthis.initialize(id, settings);\n\t}\n\n\tisCaptionEditable()\n\t{\n\t\treturn true;\n\t}\n\n\tgetCaption()\n\t{\n\t\tvar title = this.getField(\"TITLE\");\n\t\treturn BX.type.isString(title) ? title : \"\";\n\t}\n\n\tsetCaption(caption)\n\t{\n\t\tthis.setField(\"TITLE\", caption);\n\t}\n\n\tprepareCaptionData(data)\n\t{\n\t\tdata[\"TITLE\"] = this.getField(\"TITLE\", \"\");\n\t}\n}\n","import {type BaseEvent, EventEmitter} from 'main.core.events'\nimport DocumentModel from \"./model\";\n\nexport default class ModelFactory\n{\n\tconstructor()\n\t{\n\t\tEventEmitter.subscribe('BX.UI.EntityEditorModelFactory:onInitialize', (event: BaseEvent) => {\n\t\t\tconst [, eventArgs] = event.getCompatData();\n\t\t\teventArgs.methods['store_document'] = this.factory.bind(this);\n\t\t});\n\t}\n\n\tfactory(type, controlId, settings)\n\t{\n\t\tif (type === 'store_document')\n\t\t{\n\t\t\treturn new DocumentModel(controlId, settings);\n\t\t}\n\n\t\treturn null;\n\t}\n}\n","import {Loc} from 'main.core';\nimport {EventEmitter} from \"main.core.events\";\nimport {CurrencyCore} from \"currency.currency-core\";\n\nexport default class ProductRowSummary extends BX.UI.EntityEditorField\n{\n\tconstructor(id, settings)\n\t{\n\t\tsuper();\n\t\tthis.initialize(id, settings);\n\n\t\tthis._loader = null;\n\t\tthis._productsContainer = null;\n\t\tthis._previousData = [];\n\n\t\tthis._itemCount = 0;\n\t\tthis._totalCount = 0;\n\n\t\tthis._moreButton = null;\n\t\tthis._moreButtonRow = null;\n\t\tthis._totalsRow = null;\n\t\tthis._moreButtonClickHandler = BX.delegate(this._onMoreButtonClick, this);\n\n\t\tthis._visibleItemsLimit = 5;\n\t}\n\n\tlayout(options = {})\n\t{\n\t\tif(this._hasLayout)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tthis.ensureWrapperCreated({});\n\t\tthis.adjustWrapper();\n\n\t\tvar data = this.getValue();\n\n\t\tif(!BX.type.isPlainObject(data))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tvar title = this.getTitle();\n\t\tvar items = BX.prop.getArray(data, 'items', []);\n\n\t\tthis._totalCount = BX.prop.getInteger(data, 'count', 0);\n\n\t\tthis._itemCount = items.length;\n\t\tvar length = this._itemCount;\n\t\tvar maxLength = this._visibleItemsLimit;\n\t\tvar restLength = 0;\n\t\tif(\n\t\t\t(length > maxLength)\n\t\t)\n\t\t{\n\t\t\trestLength = (this._totalCount - maxLength);\n\t\t\tlength = maxLength;\n\t\t}\n\n\t\tif (this.isDragEnabled())\n\t\t{\n\t\t\tthis._wrapper.appendChild(this.createDragButton());\n\t\t}\n\n\t\tthis._wrapper.appendChild(this.createTitleNode(title));\n\t\tthis._productsContainer = BX.create(\n\t\t\t'div',\n\t\t\t{\n\t\t\t\tprops: {\n\t\t\t\t\tclassName: 'catalog-entity-widget-content-block-products-list'\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\n\t\tfor (var i = 0; i < length; i++)\n\t\t{\n\t\t\tthis.addProductRow(items[i]);\n\t\t}\n\n\t\tthis._moreButton = null;\n\t\tif (restLength > 0)\n\t\t{\n\t\t\tthis.addMoreButton(restLength);\n\t\t}\n\t\tthis.addTotalRow(data['total']);\n\n\t\tthis._wrapper.appendChild(\n\t\t\tBX.create(\n\t\t\t\t'div',\n\t\t\t\t{\n\t\t\t\t\tprops: {className: 'catalog-entity-widget-content-block-products'},\n\t\t\t\t\tchildren: [this._productsContainer]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tif (this.isContextMenuEnabled())\n\t\t{\n\t\t\tthis._wrapper.appendChild(this.createContextMenuButton());\n\t\t}\n\n\t\tif (this.isDragEnabled())\n\t\t{\n\t\t\tthis.initializeDragDropAbilities();\n\t\t}\n\n\t\tthis.registerLayout(options);\n\t\tthis._hasLayout = true;\n\t}\n\n\taddMoreButton(restLength)\n\t{\n\t\tvar row = BX.create('div', {\n\t\t\tprops: {\n\t\t\t\tclassName: 'catalog-entity-widget-content-block-products-item'\n\t\t\t}\n\t\t});\n\t\tthis._moreButtonRow = row;\n\t\tthis._productsContainer.appendChild(row);\n\n\t\tvar nameCell = BX.create(\"div\", {\n\t\t\tprops: {\n\t\t\t\tclassName: 'catalog-entity-widget-content-block-products-item-name'\n\t\t\t}\n\t\t});\n\t\trow.appendChild(nameCell);\n\n\t\tthis._moreButton = BX.create(\n\t\t\t'span',\n\t\t\t{\n\t\t\t\tattrs: {\n\t\t\t\t\tclassName: 'catalog-entity-widget-content-block-products-show-more'\n\t\t\t\t},\n\t\t\t\tevents: {\n\t\t\t\t\tclick: this._moreButtonClickHandler\n\t\t\t\t},\n\t\t\t\ttext: Loc.getMessage('DOCUMENT_PRODUCTS_NOT_SHOWN', {'#COUNT#': restLength.toString()}),\n\t\t\t}\n\t\t);\n\t\tnameCell.appendChild(this._moreButton);\n\n\t\trow.appendChild(\n\t\t\tBX.create('div', {\n\t\t\t\tprops: {\n\t\t\t\t\tclassName: 'catalog-entity-widget-content-block-products-price'\n\t\t\t\t}\n\t\t\t})\n\t\t);\n\t}\n\n\taddTotalRow(total)\n\t{\n\t\tvar row = BX.create('div', {\n\t\t\tprops: {\n\t\t\t\tclassName: 'catalog-entity-widget-content-block-products-item'\n\t\t\t}\n\t\t});\n\t\tthis._totalsRow = row;\n\t\tthis._productsContainer.appendChild(row);\n\t\tvar nameCell = BX.create('div', {\n\t\t\tprops: {\n\t\t\t\tclassName: 'catalog-entity-widget-content-block-products-item-name'\n\t\t\t},\n\t\t\thtml: Loc.getMessage('DOCUMENT_PRODUCTS_TOTAL'),\n\t\t});\n\t\trow.appendChild(nameCell);\n\n\t\tvar valueCell = BX.create('div', {\n\t\t\tprops: {\n\t\t\t\tclassName: 'catalog-entity-widget-content-block-products-price'\n\t\t\t},\n\t\t\thtml: CurrencyCore.currencyFormat(total.amount, total.currency, true),\n\t\t});\n\t\trow.appendChild(valueCell);\n\t}\n\n\taddAddProductButton()\n\t{\n\t\tlet addProductsLink = BX.create(\n\t\t\t'a',\n\t\t\t{\n\t\t\t\tprops: {href: '#'}\n\t\t\t}\n\t\t);\n\t\taddProductsLink.text = Loc.getMessage('DOCUMENT_PRODUCTS_ADD_PRODUCT');\n\t\taddProductsLink.onclick = () => {\n\t\t\tEventEmitter.emit('BX.Catalog.EntityCard.TabManager:onOpenTab', {tabId: 'tab_products'})\n\t\t};\n\t\tlet row = BX.create('div', {\n\t\t\tprops: {\n\t\t\t\tclassName: 'catalog-entity-widget-content-block-products-add-products',\n\t\t\t},\n\t\t\tchildren: [addProductsLink],\n\t\t});\n\t\tthis._productsContainer.appendChild(row);\n\t}\n\n\t_onMoreButtonClick(e)\n\t{\n\t\tEventEmitter.emit('BX.Catalog.EntityCard.TabManager:onOpenTab', {tabId: 'tab_products'});\n\t}\n\n\tdoClearLayout()\n\t{\n\t\tthis._productsContainer = null;\n\t\tthis._moreButton = null;\n\t\tthis._moreButtonRow = null;\n\t\tthis._totalsRow = null;\n\t}\n\n\taddProductRow(data)\n\t{\n\t\tvar row = BX.create('div', {\n\t\t\tprops: {\n\t\t\t\tclassName: 'catalog-entity-widget-content-block-products-item'\n\t\t\t}\n\t\t});\n\n\t\tthis._productsContainer.appendChild(row);\n\n\t\tvar nameCell = BX.create('div', {\n\t\t\tprops: {\n\t\t\t\tclassName: 'catalog-entity-widget-content-block-products-item-name'\n\t\t\t}\n\t\t});\n\t\tnameCell.innerHTML = BX.util.htmlspecialchars(data['PRODUCT_NAME']);\n\t\trow.appendChild(nameCell);\n\n\t\tvar valueCell = BX.create(\n\t\t\t'div',\n\t\t\t{\n\t\t\t\tprops: {\n\t\t\t\t\tclassName: 'catalog-entity-widget-content-block-products-price'\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t\trow.appendChild(valueCell);\n\n\t\tvalueCell.appendChild(\n\t\t\tBX.create(\n\t\t\t\t'div',\n\t\t\t\t{\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\tclassName: 'catalog-entity-widget-content-block-products-price-value'\n\t\t\t\t\t},\n\t\t\t\t\thtml: data['SUM']\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t}\n}\n","import {ajax, Loc, Tag} from \"main.core\";\nimport {Dialog, TagSelector} from 'ui.entity-selector';\n\nexport default class Contractor extends BX.UI.EntityEditorField {\n\tconstructor(id, settings)\n\t{\n\t\tsuper();\n\t\tthis.initialize(id, settings);\n\n\t\tthis._input = null;\n\t\tthis.innerWrapper = null;\n\t\tthis.currentContractorName = '';\n\t\tthis.viewModeDisplay = null;\n\t}\n\n\tgetContentWrapper()\n\t{\n\t\treturn this.innerWrapper;\n\t}\n\n\tlayout(options = {})\n\t{\n\t\tif(this._hasLayout)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tthis.ensureWrapperCreated({});\n\t\tthis.adjustWrapper();\n\n\t\tlet title = this.getTitle();\n\t\tif (this.isDragEnabled())\n\t\t{\n\t\t\tthis._wrapper.appendChild(this.createDragButton());\n\t\t}\n\n\t\tthis._wrapper.appendChild(this.createTitleNode(title));\n\n\t\tlet name = this.getName();\n\t\tlet value = this.getValue();\n\t\tlet data = this._schemeElement.getData();\n\t\tif (!this.currentContractorName)\n\t\t{\n\t\t\tthis.currentContractorName = this.getContractorNameFromModel();\n\t\t}\n\t\tthis._input = Tag.render`<input name=\"${name}\" type=\"hidden\" value=\"${value}\"/>`;\n\t\tthis._wrapper.appendChild(this._input);\n\n\t\tthis.innerWrapper = Tag.render`<div class=\"ui-entity-editor-content-block\"></div>`;\n\t\tthis._wrapper.appendChild(this.innerWrapper);\n\n\t\tif(this._mode === BX.UI.EntityEditorMode.edit)\n\t\t{\n\t\t\tlet currentSelectedItems = [];\n\t\t\tif (value)\n\t\t\t{\n\t\t\t\tcurrentSelectedItems.push({\n\t\t\t\t\tid: value,\n\t\t\t\t\tentityId: 'contractor',\n\t\t\t\t\ttitle: this.currentContractorName,\n\t\t\t\t})\n\t\t\t}\n\n\t\t\tlet contractorSelector = new TagSelector({\n\t\t\t\titems: currentSelectedItems,\n\t\t\t\tplaceholder: Loc.getMessage('DOCUMENT_CONTRACTOR_FIELD_PLACEHOLDER'),\n\t\t\t\ttextBoxWidth: '100%',\n\t\t\t\tmultiple: false,\n\t\t\t\tdialogOptions: {\n\t\t\t\t\tcontext: 'catalog_document_contractors',\n\t\t\t\t\tentities: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tid: 'contractor',\n\t\t\t\t\t\t\tdynamicLoad: true,\n\t\t\t\t\t\t\tdynamicSearch: true,\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t\tsearchOptions: {\n\t\t\t\t\t\tallowCreateItem: true,\n\t\t\t\t\t\tfooterOptions: {\n\t\t\t\t\t\t\tlabel: Loc.getMessage('DOCUMENT_ADD_CONTRACTOR'),\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tevents: {\n\t\t\t\t\t\t'Item:onSelect': (event) => {\n\t\t\t\t\t\t\tthis._input.value = event.data.item.getId();\n\t\t\t\t\t\t\tif (this.viewModeDisplay)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.currentContractorName = event.data.item.getTitle();\n\t\t\t\t\t\t\t\tthis.viewModeDisplay.innerHTML = BX.util.htmlspecialchars(this.currentContractorName);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tthis._changeHandler();\n\t\t\t\t\t\t},\n\t\t\t\t\t\t'Search:onItemCreateAsync': this.createContractor.bind(this),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t});\n\n\t\t\tcontractorSelector.renderTo(this.innerWrapper);\n\n\t\t\tif (BX.UI.EntityEditorModeOptions.check(this._modeOptions, BX.UI.EntityEditorModeOptions.individual))\n\t\t\t{\n\t\t\t\tcontractorSelector.getDialog().show();\n\t\t\t}\n\t\t}\n\t\telse // if(this._mode === BX.UI.EntityEditorMode.view)\n\t\t{\n\t\t\tif (this.hasContentToDisplay())\n\t\t\t{\n\t\t\t\tthis.viewModeDisplay = Tag.render`<div class=\"ui-entity-editor-content-block-text\">${BX.util.htmlspecialchars(this.currentContractorName)}</div>`;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.viewModeDisplay = Tag.render`<div class=\"ui-entity-editor-content-block-text\">${Loc.getMessage('DOCUMENT_CONTRACTOR_NOT_FILLED')}</div>`;\n\t\t\t}\n\n\t\t\tthis.innerWrapper.appendChild(this.viewModeDisplay);\n\t\t}\n\n\t\tif (this.isContextMenuEnabled())\n\t\t{\n\t\t\tthis._wrapper.appendChild(this.createContextMenuButton());\n\t\t}\n\n\t\tif (this.isDragEnabled())\n\t\t{\n\t\t\tthis.initializeDragDropAbilities();\n\t\t}\n\n\t\tthis.registerLayout(options);\n\t\tthis._hasLayout = true;\n\t}\n\n\tvalidate(result)\n\t{\n\t\tif(!(this._mode === BX.UI.EntityEditorMode.edit && this._input))\n\t\t{\n\t\t\tthrow \"BX.Catalog.DocumentCard.Contractor. Invalid validation context\";\n\t\t}\n\n\t\tthis.clearError();\n\n\t\tif(this.hasValidators())\n\t\t{\n\t\t\treturn this.executeValidators(result);\n\t\t}\n\n\t\tlet isValid = !(this.isRequired() || this.isRequiredByAttribute()) || BX.util.trim(this._input.value) !== \"\";\n\t\tif (!isValid)\n\t\t{\n\t\t\tresult.addError(BX.UI.EntityValidationError.create({ field: this }));\n\t\t\tthis.showRequiredFieldError(this._input);\n\t\t}\n\t\treturn isValid;\n\t}\n\n\thasValue()\n\t{\n\t\tif (this.getValue() === '0')\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\treturn super.hasValue();\n\t}\n\n\tgetModeSwitchType(mode)\n\t{\n\t\tlet result = BX.UI.EntityEditorModeSwitchType.common;\n\n\t\tif (mode === BX.UI.EntityEditorMode.edit)\n\t\t{\n\t\t\tresult |= BX.UI.EntityEditorModeSwitchType.button | BX.UI.EntityEditorModeSwitchType.content;\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tcreateContractor(event)\n\t{\n\t\tlet {searchQuery} = event.getData();\n\t\tlet companyName = searchQuery.getQuery();\n\n\t\treturn new Promise(\n\t\t\t(resolve, reject) => {\n\t\t\t\tconst dialog: Dialog = event.getTarget();\n\t\t\t\tconst fields = {\n\t\t\t\t\tcompanyName,\n\t\t\t\t};\n\n\t\t\t\tdialog.showLoader();\n\t\t\t\tajax.runAction(\n\t\t\t\t\t'catalog.contractor.createContractor',\n\t\t\t\t\t{\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\tfields\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t\t.then(response => {\n\t\t\t\t\tdialog.hideLoader();\n\t\t\t\t\tconst item = dialog.addItem({\n\t\t\t\t\t\tid: response.data.id,\n\t\t\t\t\t\tentityId: 'contractor',\n\t\t\t\t\t\ttitle: searchQuery.getQuery(),\n\t\t\t\t\t\ttabs: dialog.getRecentTab().getId(),\n\t\t\t\t\t});\n\n\t\t\t\t\tif (item)\n\t\t\t\t\t{\n\t\t\t\t\t\titem.select();\n\t\t\t\t\t}\n\n\t\t\t\t\tdialog.hide();\n\t\t\t\t\tresolve();\n\t\t\t\t})\n\t\t\t\t.catch(() => {\n\t\t\t\t\tdialog.hideLoader();\n\t\t\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\t\t\tcontent: Loc.getMessage('DOCUMENT_ADD_CONTRACTOR_ERROR'),\n\t\t\t\t\t});\n\t\t\t\t\tdialog.hide();\n\t\t\t\t\treject();\n\t\t\t\t});\n\t\t\t}\n\t\t);\n\t}\n\n\tgetContractorNameFromModel()\n\t{\n\t\treturn this._model.getSchemeField(this._schemeElement, 'contractorName', '');\n\t}\n\n\trollback()\n\t{\n\t\tthis.currentContractorName = this.getContractorNameFromModel();\n\t}\n}\n","import {type BaseEvent, EventEmitter} from 'main.core.events'\nimport ProductRowSummary from \"./row-summary\";\nimport Contractor from \"./contractor\";\n\nexport default class FieldsFactory\n{\n\tconstructor()\n\t{\n\t\tEventEmitter.subscribe('BX.UI.EntityEditorControlFactory:onInitialize', (event: BaseEvent) => {\n\t\t\tconst [, eventArgs] = event.getCompatData();\n\t\t\teventArgs.methods['documentCard'] = this.factory.bind(this);\n\t\t});\n\t}\n\n\tfactory(type, controlId, settings)\n\t{\n\t\tif (type === 'product_row_summary')\n\t\t{\n\t\t\treturn new ProductRowSummary(controlId, settings);\n\t\t}\n\t\tif (type === 'contractor')\n\t\t{\n\t\t\treturn new Contractor(controlId, settings);\n\t\t}\n\n\t\treturn null;\n\t}\n}","import {Loc, Reflection, Tag} from \"main.core\";\nimport {BaseCard} from \"catalog.entity-card\";\nimport {EventEmitter} from \"main.core.events\";\nimport {Dialog} from 'ui.entity-selector';\nimport ControllersFactory from \"../controllers-factory\";\nimport ModelFactory from \"../model/model-factory\";\nimport FieldsFactory from \"../editor-fields/fields-factory\";\nimport {MenuManager} from \"main.popup\";\nimport {Text} from \"main.core\";\nimport {Guide} from \"ui.tour\";\n\nclass DocumentCard extends BaseCard\n{\n\tstatic #instance;\n\n\tstatic #fieldFactory;\n\tstatic #modelFactory;\n\tstatic #controllersFactory;\n\n\tstatic initializeEntityEditorFactories()\n\t{\n\t\tDocumentCard.registerFieldFactory();\n\t\tDocumentCard.registerModelFactory();\n\t\tDocumentCard.registerDocumentControllersFactory();\n\t}\n\n\tconstructor(id, settings)\n\t{\n\t\tsuper(id, settings);\n\t\tthis.documentType = settings.documentType;\n\t\tthis.isDocumentConducted = settings.documentStatus === 'Y';\n\t\tthis.componentName = settings.componentName;\n\t\tthis.signedParameters = settings.signedParameters;\n\t\tthis.isConductLocked = settings.isConductLocked;\n\t\tthis.masterSliderUrl = settings.masterSliderUrl;\n\t\tthis.isFirstTime = settings.isFirstTime;\n\n\t\tthis.isTabAnalyticsSent = false;\n\n\t\tthis.setSliderText();\n\t\tthis.addCopyLinkPopup();\n\t\tthis.subscribeToEvents();\n\n\t\tif (settings.documentTypeSelector)\n\t\t{\n\t\t\tthis.initDocumentTypeSelector();\n\t\t}\n\n\t\tDocumentCard.#instance = this;\n\n\t\t// setting this to true so that we can decide\n\t\t// whether to close the slider or not on the fly on backend (closeOnSave=Y)\n\t\tBX.UI.SidePanel.Wrapper.setParam(\"closeAfterSave\", true);\n\t\tthis.showNotificationOnClose = false;\n\t}\n\n\tstatic getInstance()\n\t{\n\t\treturn DocumentCard.#instance;\n\t}\n\n\tinitDocumentTypeSelector()\n\t{\n\t\tlet documentTypeSelector = this.settings.documentTypeSelector;\n\t\tlet documentTypeSelectorTypes = this.settings.documentTypeSelectorTypes;\n\t\tif (!documentTypeSelector || !documentTypeSelectorTypes)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet menuItems = [];\n\t\tdocumentTypeSelectorTypes.forEach((type) => {\n\t\t\tmenuItems.push({\n\t\t\t\ttext: Loc.getMessage('DOC_TYPE_SHORT_' + type),\n\t\t\t\tonclick: (e) => {\n\t\t\t\t\tlet slider = BX.SidePanel.Instance.getTopSlider();\n\t\t\t\t\tif (slider)\n\t\t\t\t\t{\n\t\t\t\t\t\tslider.url = BX.Uri.addParam(slider.getUrl(), {DOCUMENT_TYPE: type});\n\t\t\t\t\t\tslider.url = BX.Uri.removeParam(slider.url, ['firstTime']);\n\t\t\t\t\t\tslider.setFrameSrc();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t});\n\t\t});\n\t\tlet popupMenu = MenuManager.create({\n\t\t\tid: 'document-type-selector',\n\t\t\tbindElement: documentTypeSelector,\n\t\t\titems: menuItems,\n\t\t});\n\n\t\tdocumentTypeSelector.addEventListener('click', e => {\n\t\t\te.preventDefault();\n\t\t\tpopupMenu.show();\n\t\t});\n\n\t\tif (this.isFirstTime)\n\t\t{\n\t\t\tlet guide = new Guide({\n\t\t\t\tsteps: [\n\t\t\t\t\t{\n\t\t\t\t\t\ttarget: documentTypeSelector.querySelector('.catalog-document-type-selector-text'),\n\t\t\t\t\t\ttitle: Loc.getMessage('DOCUMENT_FIRST_TIME_HINT_TITLE'),\n\t\t\t\t\t\ttext: Loc.getMessage('DOCUMENT_FIRST_TIME_HINT_TEXT'),\n\t\t\t\t\t\tlink: '#',\n\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\tonShow: () => {\n\t\t\t\t\t\t\t\tdocument.querySelector('.ui-tour-popup-link').onclick = (event) => {\n\t\t\t\t\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t\t\t\t\ttop.BX.Helper.show(\"redirect=detail&code=14566618\");\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tonClose: () => {\n\t\t\t\t\t\t\t\tBX.userOptions.save('catalog', 'document-card', 'isDocumentTypeGuideOver', true);\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\tonEvents: true,\n\t\t\t});\n\t\t\tguide.showNextStep();\n\t\t}\n\t}\n\n\topenMasterSlider()\n\t{\n\t\tlet card = this;\n\n\t\tBX.SidePanel.Instance.open(\n\t\t\tthis.masterSliderUrl,\n\t\t\t{\n\t\t\t\tcacheable: false,\n\t\t\t\tdata: {\n\t\t\t\t\topenGridOnDone: false,\n\t\t\t\t},\n\t\t\t\tevents: {\n\t\t\t\t\tonCloseComplete: function(event) {\n\t\t\t\t\t\tlet slider = event.getSlider();\n\t\t\t\t\t\tif (!slider)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (slider.getData().get('isInventoryManagementEnabled'))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcard.isConductLocked = false;\n\n\t\t\t\t\t\t\tlet sliders = BX.SidePanel.Instance.getOpenSliders();\n\t\t\t\t\t\t\tsliders.forEach((slider) => {\n\t\t\t\t\t\t\t\tif (slider.getWindow()?.BX.Catalog?.DocumentGridManager)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tslider.allowChangeHistory = false;\n\t\t\t\t\t\t\t\t\tslider.getWindow().location.reload();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t}\n\n\tadjustToolPanel()\n\t{\n\t\treturn;\n\t}\n\n\tstatic registerDocumentControllersFactory()\n\t{\n\t\tDocumentCard.#controllersFactory = new ControllersFactory();\n\t}\n\n\t// deprecated\n\tsetViewModeButtons(editor)\n\t{\n\t\teditor._toolPanel.showViewModeButtons();\n\t}\n\n\t// deprecated\n\tsetEditModeButtons(editor)\n\t{\n\t\teditor._toolPanel.showEditModeButtons();\n\t}\n\n\tgetEditorInstance()\n\t{\n\t\tif (Reflection.getClass('BX.UI.EntityEditor'))\n\t\t{\n\t\t\treturn BX.UI.EntityEditor.getDefault();\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tsubscribeToEvents()\n\t{\n\t\tthis.subscribeToUserSelectorEvent();\n\t\tthis.subscribeToValidationFailedEvent();\n\t\tthis.subscribeToOnSaveEvent();\n\t\tthis.subscribeToTabOpenEvent();\n\t\tthis.subscribeToDirectActionEvent();\n\t\tthis.subscribeToEntityCreateEvent();\n\t\tthis.subscribeToBeforeEntityRedirectEvent();\n\t}\n\n\tsubscribeToUserSelectorEvent()\n\t{\n\t\tEventEmitter.subscribe('BX.UI.EntityEditorUser:openSelector', (event) => {\n\t\t\tlet eventData = event.data[1];\n\t\t\tconst dialog = new Dialog({\n\t\t\t\ttargetNode: eventData.anchor,\n\t\t\t\tenableSearch: true,\n\t\t\t\tmultiple: false,\n\t\t\t\tcontext: 'CATALOG_DOCUMENT',\n\t\t\t\tentities: [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'user',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'department',\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\tevents: {\n\t\t\t\t\t'Item:onSelect': (onSelectEvent) => {\n\t\t\t\t\t\tlet fieldId = eventData.id;\n\t\t\t\t\t\tlet selectedItem = onSelectEvent.data.item;\n\t\t\t\t\t\tlet userData = {\n\t\t\t\t\t\t\tentityId: selectedItem.id,\n\t\t\t\t\t\t\tavatar: selectedItem.avatar,\n\t\t\t\t\t\t\tname: Text.encode(selectedItem.title.text),\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\tif (this.entityId > 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlet fields = {};\n\t\t\t\t\t\t\tfields[fieldId] = selectedItem.id;\n\t\t\t\t\t\t\tBX.ajax.runComponentAction(\n\t\t\t\t\t\t\t\tthis.componentName,\n\t\t\t\t\t\t\t\t'save',\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tmode: 'class',\n\t\t\t\t\t\t\t\t\tsignedParameters: this.signedParameters,\n\t\t\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\t\t\tfields: fields,\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t).then((result) => {\n\t\t\t\t\t\t\t\teventData.callback(dialog, userData);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\teventData.callback(dialog, userData);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t});\n\t\t\tdialog.show();\n\t\t});\n\t}\n\n\tsubscribeToValidationFailedEvent()\n\t{\n\t\tEventEmitter.subscribe('BX.UI.EntityEditor:onFailedValidation', (event) => {\n\t\t\tEventEmitter.emit('BX.Catalog.EntityCard.TabManager:onOpenTab', {tabId: 'main'});\n\t\t});\n\t}\n\n\tsubscribeToOnSaveEvent()\n\t{\n\t\tEventEmitter.subscribe('BX.UI.EntityEditor:onSave', (event) => {\n\t\t\tlet eventEditor = event.data[0];\n\t\t\tlet action = event.data[1]?.actionId;\n\t\t\tif (eventEditor && eventEditor._ajaxForm)\n\t\t\t{\n\t\t\t\tif (action === 'SAVE_AND_CONDUCT')\n\t\t\t\t{\n\t\t\t\t\tif (this.isConductLocked)\n\t\t\t\t\t{\n\t\t\t\t\t\tevent.data[1].cancel = true;\n\t\t\t\t\t\tevent.data[0]._toolPanel?.setLocked(false);\n\t\t\t\t\t\tthis.openMasterSlider();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tlet form = eventEditor._ajaxForms[action];\n\t\t\t\tif (form)\n\t\t\t\t{\n\t\t\t\t\tform.addUrlParams({\n\t\t\t\t\t\tdocumentType: this.documentType,\n\t\t\t\t\t\tisNewDocument: this.entityId <= 0 ? 'Y' : 'N',\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tsubscribeToTabOpenEvent()\n\t{\n\t\tEventEmitter.subscribe('BX.Catalog.EntityCard.TabManager:onSelectItem', (event) => {\n\t\t\tconst tabId = event.data.tabId;\n\t\t\tif (tabId === 'tab_products' && !this.isTabAnalyticsSent)\n\t\t\t{\n\t\t\t\tthis.sendAnalyticsData({\n\t\t\t\t\ttab: 'products',\n\t\t\t\t\tisNewDocument: this.entityId <= 0 ? 'Y' : 'N',\n\t\t\t\t\tdocumentType: this.documentType,\n\t\t\t\t});\n\t\t\t\tthis.isTabAnalyticsSent = true;\n\t\t\t}\n\t\t});\n\t}\n\n\tsubscribeToDirectActionEvent()\n\t{\n\t\tEventEmitter.subscribe('BX.UI.EntityEditor:onDirectAction', (event) => {\n\t\t\tif (event.data[1]?.actionId === 'CONDUCT')\n\t\t\t{\n\t\t\t\tif (this.isConductLocked)\n\t\t\t\t{\n\t\t\t\t\tevent.data[1].cancel = true;\n\t\t\t\t\tevent.data[0]._toolPanel?.setLocked(false);\n\t\t\t\t\tthis.openMasterSlider();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tevent.data[0]._ajaxForms['CONDUCT'].addUrlParams({\n\t\t\t\t\tdocumentType: this.documentType,\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\n\tsubscribeToEntityCreateEvent()\n\t{\n\t\tEventEmitter.subscribe('onEntityCreate', (event) => {\n\t\t\tlet editor = event?.data[0]?.sender;\n\t\t\tif (editor)\n\t\t\t{\n\t\t\t\teditor._toolPanel.disableSaveButton();\n\t\t\t\teditor.hideToolPanel();\n\t\t\t}\n\t\t});\n\t}\n\n\tsubscribeToBeforeEntityRedirectEvent()\n\t{\n\t\tEventEmitter.subscribe('beforeEntityRedirect', (event) => {\n\t\t\tlet editor = event?.data[0]?.sender;\n\t\t\tif (editor)\n\t\t\t{\n\t\t\t\teditor._toolPanel.disableSaveButton();\n\t\t\t\teditor.hideToolPanel();\n\n\t\t\t\tthis.showNotificationOnClose = event?.data[0]?.showNotificationOnClose === 'Y';\n\n\t\t\t\tif (this.showNotificationOnClose)\n\t\t\t\t{\n\t\t\t\t\tlet url = event.data[0].redirectUrl;\n\t\t\t\t\tif (!url)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\turl = BX.Uri.removeParam(url, 'closeOnSave');\n\n\t\t\t\t\twindow.top.BX.UI.Notification.Center.notify({\n\t\t\t\t\t\tcontent: Loc.getMessage('DOCUMENT_CONDUCT_SUCCESSFUL'),\n\t\t\t\t\t\tactions: [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttitle: Loc.getMessage('DOCUMENT_CONDUCT_SUCCESSFUL_VIEW'),\n\t\t\t\t\t\t\t\thref: url,\n\t\t\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\t\t\tclick: function(event, balloon, action) {\n\t\t\t\t\t\t\t\t\t\tballoon.close();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t],\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tsendAnalyticsData(data)\n\t{\n\t\tBX.ajax.runAction(\n\t\t\t'catalog.analytics.sendAnalyticsLabel',\n\t\t\t{\n\t\t\t\tanalyticsLabel: data,\n\t\t\t}\n\t\t);\n\t}\n\n\taddCopyLinkPopup()\n\t{\n\t\tlet copyLinkButton = document.getElementById(this.settings.copyLinkButtonId);\n\t\tif (!copyLinkButton)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tcopyLinkButton.onclick = () => {\n\t\t\tthis.copyDocumentLinkToClipboard();\n\t\t}\n\t}\n\n\tcopyDocumentLinkToClipboard()\n\t{\n\t\tlet url = BX.util.remove_url_param(window.location.href, [\"IFRAME\", \"IFRAME_TYPE\"]);\n\t\tif(!BX.clipboard.copy(url))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tvar popup = new BX.PopupWindow(\n\t\t\t'catalog_copy_document_url_to_clipboard',\n\t\t\tdocument.getElementById(this.settings.copyLinkButtonId),\n\t\t\t{\n\t\t\t\tcontent: Loc.getMessage('DOCUMENT_LINK_COPIED'),\n\t\t\t\tdarkMode: true,\n\t\t\t\tautoHide: true,\n\t\t\t\tzIndex: 1000,\n\t\t\t\tangle: true,\n\t\t\t\tbindOptions: { position: \"top\" }\n\t\t\t}\n\t\t);\n\t\tpopup.show();\n\n\t\tsetTimeout(function(){ popup.close(); }, 1500);\n\t}\n\n\tstatic registerFieldFactory()\n\t{\n\t\tDocumentCard.#fieldFactory = new FieldsFactory();\n\t}\n\n\tstatic registerModelFactory()\n\t{\n\t\tDocumentCard.#modelFactory = new ModelFactory();\n\t}\n\n\tsetSliderText()\n\t{\n\t\tlet slider = BX.SidePanel.Instance.getTopSlider();\n\t\tif (slider)\n\t\t{\n\t\t\tslider.getLabel().setText(Loc.getMessage('SLIDER_LABEL_' + this.documentType));\n\t\t}\n\t}\n\n\tdisableSaveAndConductButton()\n\t{\n\t\tif(!this.conductAndSaveButton)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.conductAndSaveButton.disabled = true;\n\t\tBX.addClass(this.conductAndSaveButton, 'ui-btn-disabled');\n\t}\n\n\tenableSaveAndConductButton()\n\t{\n\t\tif(!this.conductAndSaveButton)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.conductAndSaveButton.disabled = false;\n\t\tBX.removeClass(this.conductAndSaveButton, 'ui-btn-disabled');\n\t}\n}\n\nexport default DocumentCard;\n"],"names":["ProductListController","id","settings","_currencyId","initialize","_setProductListHandler","handleSetProductList","bind","_tabShowHandler","onTabShow","_editorControlChangeHandler","onEditorControlChange","_model","getField","EventEmitter","subscribe","_editor","event","productList","getData","setProductList","unsubscribe","reloadGrid","tab","handleOnTabShow","emit","rollback","onInnerCancel","changeCurrencyId","_isChanged","destroy","setController","setForm","getFormElement","getCurrencyId","_prevProductCount","_curProductCount","getProductCount","removeFormFields","_toolPanel","showViewModeButtons","disableSaveButton","markAsChanged","getProductsFields","isChanged","isNew","compileProductData","enableSaveButton","field","params","BX","UI","EntityEditorMoney","fieldName","fieldValue","totalData","setField","Currency","currencyFormat","totalCost","getControlById","refreshLayout","EntityEditorController","DocumentCardController","lockField","window","top","onCustomEvent","sliders","SidePanel","Instance","getOpenSliders","forEach","slider","getWindow","Catalog","DocumentGridManager","ControllersFactory","getCompatData","eventArgs","methods","factory","type","controlId","DocumentModel","title","isString","caption","data","EntityModel","ModelFactory","ProductRowSummary","_loader","_productsContainer","_previousData","_itemCount","_totalCount","_moreButton","_moreButtonRow","_totalsRow","_moreButtonClickHandler","delegate","_onMoreButtonClick","_visibleItemsLimit","options","_hasLayout","ensureWrapperCreated","adjustWrapper","getValue","isPlainObject","getTitle","items","prop","getArray","getInteger","length","maxLength","restLength","isDragEnabled","_wrapper","appendChild","createDragButton","createTitleNode","create","props","className","i","addProductRow","addMoreButton","addTotalRow","children","isContextMenuEnabled","createContextMenuButton","initializeDragDropAbilities","registerLayout","row","nameCell","attrs","events","click","text","Loc","getMessage","toString","total","html","valueCell","CurrencyCore","amount","currency","addProductsLink","href","onclick","tabId","e","innerHTML","util","htmlspecialchars","EntityEditorField","Contractor","_input","innerWrapper","currentContractorName","viewModeDisplay","name","getName","value","_schemeElement","getContractorNameFromModel","Tag","render","_mode","EntityEditorMode","edit","currentSelectedItems","push","entityId","contractorSelector","TagSelector","placeholder","textBoxWidth","multiple","dialogOptions","context","entities","dynamicLoad","dynamicSearch","searchOptions","allowCreateItem","footerOptions","label","item","getId","_changeHandler","createContractor","renderTo","EntityEditorModeOptions","check","_modeOptions","individual","getDialog","show","hasContentToDisplay","result","clearError","hasValidators","executeValidators","isValid","isRequired","isRequiredByAttribute","trim","addError","EntityValidationError","showRequiredFieldError","mode","EntityEditorModeSwitchType","common","button","content","searchQuery","companyName","getQuery","Promise","resolve","reject","dialog","getTarget","fields","showLoader","ajax","runAction","then","response","hideLoader","addItem","tabs","getRecentTab","select","hide","catch","Notification","Center","notify","getSchemeField","FieldsFactory","DocumentCard","registerFieldFactory","registerModelFactory","registerDocumentControllersFactory","documentType","isDocumentConducted","documentStatus","componentName","signedParameters","isConductLocked","masterSliderUrl","isFirstTime","isTabAnalyticsSent","setSliderText","addCopyLinkPopup","subscribeToEvents","documentTypeSelector","initDocumentTypeSelector","Wrapper","setParam","showNotificationOnClose","documentTypeSelectorTypes","menuItems","getTopSlider","url","Uri","addParam","getUrl","DOCUMENT_TYPE","removeParam","setFrameSrc","popupMenu","MenuManager","bindElement","addEventListener","preventDefault","guide","Guide","steps","target","querySelector","link","onShow","document","Helper","onClose","userOptions","save","onEvents","showNextStep","card","open","cacheable","openGridOnDone","onCloseComplete","getSlider","get","allowChangeHistory","location","reload","editor","showEditModeButtons","Reflection","getClass","EntityEditor","getDefault","subscribeToUserSelectorEvent","subscribeToValidationFailedEvent","subscribeToOnSaveEvent","subscribeToTabOpenEvent","subscribeToDirectActionEvent","subscribeToEntityCreateEvent","subscribeToBeforeEntityRedirectEvent","eventData","Dialog","targetNode","anchor","enableSearch","onSelectEvent","fieldId","selectedItem","userData","avatar","Text","encode","runComponentAction","callback","eventEditor","action","actionId","_ajaxForm","cancel","setLocked","openMasterSlider","form","_ajaxForms","addUrlParams","isNewDocument","sendAnalyticsData","sender","hideToolPanel","redirectUrl","actions","balloon","close","analyticsLabel","copyLinkButton","getElementById","copyLinkButtonId","copyDocumentLinkToClipboard","remove_url_param","clipboard","copy","popup","PopupWindow","darkMode","autoHide","zIndex","angle","bindOptions","position","setTimeout","getLabel","setText","conductAndSaveButton","disabled","addClass","removeClass","BaseCard"],"mappings":"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"}