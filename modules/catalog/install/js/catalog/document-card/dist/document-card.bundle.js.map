{"version":3,"file":"document-card.bundle.js","sources":["../src/product-list/controller.js","../src/card/controller.js","../src/controllers-factory.js","../src/model/model.js","../src/model/model-factory.js","../src/editor-fields/row-summary.js","../src/editor-fields/contractor.js","../src/editor-fields/fields-factory.js","../src/card/card.js","../src/feedback/button.js"],"sourcesContent":["import {Loc} from 'main.core';\nimport {BaseEvent, EventEmitter} from 'main.core.events'\nimport DocumentCard from \"../card/card\";\n\nexport default class ProductListController extends BX.UI.EntityEditorController\n{\n\tconstructor(id, settings)\n\t{\n\t\tsuper();\n\t\tthis.initialize(id, settings);\n\t\tthis._setProductListHandler = this.handleSetProductList.bind(this);\n\t\tthis._tabShowHandler = this.onTabShow.bind(this);\n\n\t\tthis._editorControlChangeHandler = this.onEditorControlChange.bind(this);\n\n\t\tthis._currencyId = this._model.getField('CURRENCY', '');\n\n\t\tEventEmitter.subscribe(this._editor, 'onControlChanged', this.onEditorControlChange.bind(this));\n\t\tEventEmitter.subscribe('DocumentProductListController', this._setProductListHandler);\n\t\tEventEmitter.subscribe('onEntityDetailsTabShow', this._tabShowHandler);\n\t}\n\n\thandleSetProductList(event)\n\t{\n\t\tconst productList = event.getData()[0];\n\t\tthis.setProductList(productList);\n\t\tEventEmitter.unsubscribe('DocumentProductListController', this._setProductListHandler);\n\t}\n\n\treinitializeProductList()\n\t{\n\t\tif (this.productList)\n\t\t{\n\t\t\tthis.productList.reloadGrid(false);\n\t\t}\n\t}\n\n\tonTabShow(event: BaseEvent)\n\t{\n\t\tconst [tab] = event.getData();\n\t\tif (tab.id === 'tab_products' && this.productList)\n\t\t{\n\t\t\tthis.productList.handleOnTabShow();\n\t\t\tEventEmitter.unsubscribe('onEntityDetailsTabShow', this._tabShowHandler);\n\t\t\tEventEmitter.emit('onDocumentProductListTabShow', this);\n\t\t}\n\t}\n\n\tinnerCancel()\n\t{\n\t\tthis.rollback();\n\t\tif (this.productList)\n\t\t{\n\t\t\tthis.productList.onInnerCancel();\n\t\t}\n\n\t\tthis._currencyId = this._model.getField('CURRENCY');\n\n\t\tif (this.productList)\n\t\t{\n\t\t\tthis.productList.changeCurrencyId(this._currencyId);\n\t\t}\n\n\t\tthis._isChanged = false;\n\t}\n\n\tgetCurrencyId = function()\n\t{\n\t\treturn this._currencyId;\n\t}\n\n\tsetProductList(productList)\n\t{\n\t\tif (this.productList === productList)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.productList)\n\t\t{\n\t\t\tthis.productList.destroy();\n\t\t}\n\n\t\tthis.productList = productList;\n\n\t\tif (this.productList)\n\t\t{\n\t\t\tthis.productList.setController(this);\n\t\t\tthis.productList.setForm(this._editor.getFormElement());\n\n\t\t\tif (this.productList.getCurrencyId() !== this.getCurrencyId())\n\t\t\t{\n\t\t\t\tthis.productList.changeCurrencyId(this.getCurrencyId());\n\t\t\t}\n\n\t\t\tthis._prevProductCount = this._curProductCount = this.productList.getProductCount();\n\t\t}\n\t}\n\n\tonAfterSave()\n\t{\n\t\tsuper.onAfterSave();\n\t\tif (this.productList)\n\t\t{\n\t\t\tthis.productList.removeFormFields();\n\t\t}\n\n\t\tthis._editor._toolPanel.showViewModeButtons();\n\t}\n\n\tproductChange(disableSaveButton = false)\n\t{\n\t\tdisableSaveButton = disableSaveButton ?? false;\n\t\tthis.markAsChanged();\n\n\t\tif (disableSaveButton)\n\t\t{\n\t\t\tthis.disableSaveButton();\n\t\t}\n\n\t\tEventEmitter.emit('onDocumentProductChange', this.productList.getProductsFields());\n\t}\n\n\tonBeforeSubmit()\n\t{\n\t\tif (this.productList && (this.isChanged() || this._editor.isNew()))\n\t\t{\n\t\t\tthis.productList.compileProductData();\n\t\t}\n\t}\n\n\tenableSaveButton()\n\t{\n\t\tif (this._editor?._toolPanel)\n\t\t{\n\t\t\tthis._editor._toolPanel.enableSaveButton();\n\t\t}\n\t}\n\n\tdisableSaveButton()\n\t{\n\t\tif (this._editor?._toolPanel)\n\t\t{\n\t\t\tthis._editor._toolPanel.disableSaveButton();\n\t\t}\n\t}\n\n\tonEditorControlChange(event: BaseEvent)\n\t{\n\t\tconst [field, params] = event.getData();\n\t\tif (field instanceof BX.UI.EntityEditorMoney && params?.fieldName === 'CURRENCY')\n\t\t{\n\t\t\tthis._currencyId = params?.fieldValue;\n\n\t\t\tif (this.productList && this._currencyId)\n\t\t\t{\n\t\t\t\tthis.productList.changeCurrencyId(this._currencyId);\n\t\t\t\tthis.markAsChanged();\n\t\t\t}\n\t\t}\n\t}\n\n\tsetTotal(totalData)\n\t{\n\t\tthis._model.setField(\n\t\t\t'FORMATTED_TOTAL',\n\t\t\tBX.Currency.currencyFormat(totalData.totalCost, this.getCurrencyId(), false),\n\t\t);\n\n\t\tthis._model.setField(\n\t\t\t'FORMATTED_TOTAL_WITH_CURRENCY',\n\t\t\tBX.Currency.currencyFormat(totalData.totalCost, this.getCurrencyId(), true),\n\t\t);\n\n\t\tthis._model.setField(\n\t\t\t'TOTAL',\n\t\t\ttotalData.totalCost,\n\t\t);\n\n\t\tthis._editor.getControlById('TOTAL_WITH_CURRENCY').refreshLayout();\n\t}\n\n\tvalidateProductList()\n\t{\n\t\tlet errorsArray = this.productList.validate();\n\t\tif (errorsArray.length > 0)\n\t\t{\n\t\t\tthis._editor._toolPanel.addError(errorsArray[0]);\n\t\t\tEventEmitter.emit('onProductsCheckFailed', errorsArray);\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t}\n}\n","export default class DocumentCardController extends BX.UI.EntityEditorController\n{\n\tconstructor(id, settings)\n\t{\n\t\tsuper();\n\t\tthis.initialize(id, settings);\n\t\tthis._model.lockField('TOTAL');\n\t}\n\n\tonAfterSave()\n\t{\n\t\tsuper.onAfterSave();\n\t\twindow.top.BX.onCustomEvent('DocumentCard:onDocumentCardSave');\n\t\tlet sliders = BX.SidePanel.Instance.getOpenSliders();\n\t\tsliders.forEach((slider) => {\n\t\t\tif (slider.getWindow()?.BX.Catalog?.DocumentGridManager)\n\t\t\t{\n\t\t\t\tslider.getWindow().BX.onCustomEvent('DocumentCard:onDocumentCardSave');\n\t\t\t}\n\t\t});\n\t}\n}\n","import {type BaseEvent, EventEmitter} from 'main.core.events';\nimport ProductListController from \"./product-list/controller\";\nimport DocumentCardController from \"./card/controller\";\n\nexport default class ControllersFactory\n{\n\tconstructor()\n\t{\n\t\tEventEmitter.subscribe('BX.UI.EntityEditorControllerFactory:onInitialize', (event: BaseEvent) => {\n\t\t\tconst [, eventArgs] = event.getCompatData();\n\t\t\teventArgs.methods['entityCard'] = this.factory.bind(this);\n\t\t});\n\t}\n\n\tfactory(type, controlId, settings)\n\t{\n\t\tif (type === 'document_card')\n\t\t{\n\t\t\treturn new DocumentCardController(controlId, settings);\n\t\t}\n\n\t\tif (type === 'product_list')\n\t\t{\n\t\t\treturn new ProductListController(controlId, settings);\n\t\t}\n\n\t\treturn null;\n\t}\n}\n","export default class DocumentModel extends BX.UI.EntityModel\n{\n\tconstructor(id, settings) {\n\t\tsuper();\n\t\tthis.initialize(id, settings);\n\t}\n\n\tisCaptionEditable()\n\t{\n\t\treturn true;\n\t}\n\n\tgetCaption()\n\t{\n\t\tvar title = this.getField(\"TITLE\");\n\t\treturn BX.type.isString(title) ? title : \"\";\n\t}\n\n\tsetCaption(caption)\n\t{\n\t\tthis.setField(\"TITLE\", caption);\n\t}\n\n\tprepareCaptionData(data)\n\t{\n\t\tdata[\"TITLE\"] = this.getField(\"TITLE\", \"\");\n\t}\n}\n","import {type BaseEvent, EventEmitter} from 'main.core.events'\nimport DocumentModel from \"./model\";\n\nexport default class ModelFactory\n{\n\tconstructor()\n\t{\n\t\tEventEmitter.subscribe('BX.UI.EntityEditorModelFactory:onInitialize', (event: BaseEvent) => {\n\t\t\tconst [, eventArgs] = event.getCompatData();\n\t\t\teventArgs.methods['store_document'] = this.factory.bind(this);\n\t\t});\n\t}\n\n\tfactory(type, controlId, settings)\n\t{\n\t\tif (type === 'store_document')\n\t\t{\n\t\t\treturn new DocumentModel(controlId, settings);\n\t\t}\n\n\t\treturn null;\n\t}\n}\n","import {Loc} from 'main.core';\nimport {EventEmitter} from \"main.core.events\";\nimport {CurrencyCore} from \"currency.currency-core\";\n\nexport default class ProductRowSummary extends BX.UI.EntityEditorField\n{\n\tconstructor(id, settings)\n\t{\n\t\tsuper();\n\t\tthis.initialize(id, settings);\n\n\t\tthis._loader = null;\n\t\tthis._productsContainer = null;\n\t\tthis._previousData = [];\n\n\t\tthis._itemCount = 0;\n\t\tthis._totalCount = 0;\n\n\t\tthis._moreButton = null;\n\t\tthis._moreButtonRow = null;\n\t\tthis._totalsRow = null;\n\t\tthis._moreButtonClickHandler = BX.delegate(this._onMoreButtonClick, this);\n\n\t\tthis._visibleItemsLimit = 5;\n\t}\n\n\tlayout(options = {})\n\t{\n\t\tif(this._hasLayout)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tthis.ensureWrapperCreated({});\n\t\tthis.adjustWrapper();\n\n\t\tvar data = this.getValue();\n\n\t\tif(!BX.type.isPlainObject(data))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tvar title = this.getTitle();\n\t\tvar items = BX.prop.getArray(data, 'items', []);\n\n\t\tthis._totalCount = BX.prop.getInteger(data, 'count', 0);\n\n\t\tthis._itemCount = items.length;\n\t\tvar length = this._itemCount;\n\t\tvar maxLength = this._visibleItemsLimit;\n\t\tvar restLength = 0;\n\t\tif(\n\t\t\t(length > maxLength)\n\t\t)\n\t\t{\n\t\t\trestLength = (this._totalCount - maxLength);\n\t\t\tlength = maxLength;\n\t\t}\n\n\t\tif (this.isDragEnabled())\n\t\t{\n\t\t\tthis._wrapper.appendChild(this.createDragButton());\n\t\t}\n\n\t\tthis._wrapper.appendChild(this.createTitleNode(title));\n\t\tthis._productsContainer = BX.create(\n\t\t\t'div',\n\t\t\t{\n\t\t\t\tprops: {\n\t\t\t\t\tclassName: 'catalog-entity-widget-content-block-products-list'\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\n\t\tfor (var i = 0; i < length; i++)\n\t\t{\n\t\t\tthis.addProductRow(items[i]);\n\t\t}\n\n\t\tthis._moreButton = null;\n\t\tif (restLength > 0)\n\t\t{\n\t\t\tthis.addMoreButton(restLength);\n\t\t}\n\t\tthis.addTotalRow(data['total']);\n\n\t\tthis._wrapper.appendChild(\n\t\t\tBX.create(\n\t\t\t\t'div',\n\t\t\t\t{\n\t\t\t\t\tprops: {className: 'catalog-entity-widget-content-block-products'},\n\t\t\t\t\tchildren: [this._productsContainer]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tif (this.isContextMenuEnabled())\n\t\t{\n\t\t\tthis._wrapper.appendChild(this.createContextMenuButton());\n\t\t}\n\n\t\tif (this.isDragEnabled())\n\t\t{\n\t\t\tthis.initializeDragDropAbilities();\n\t\t}\n\n\t\tthis.registerLayout(options);\n\t\tthis._hasLayout = true;\n\t}\n\n\taddMoreButton(restLength)\n\t{\n\t\tvar row = BX.create('div', {\n\t\t\tprops: {\n\t\t\t\tclassName: 'catalog-entity-widget-content-block-products-item'\n\t\t\t}\n\t\t});\n\t\tthis._moreButtonRow = row;\n\t\tthis._productsContainer.appendChild(row);\n\n\t\tvar nameCell = BX.create(\"div\", {\n\t\t\tprops: {\n\t\t\t\tclassName: 'catalog-entity-widget-content-block-products-item-name'\n\t\t\t}\n\t\t});\n\t\trow.appendChild(nameCell);\n\n\t\tthis._moreButton = BX.create(\n\t\t\t'span',\n\t\t\t{\n\t\t\t\tattrs: {\n\t\t\t\t\tclassName: 'catalog-entity-widget-content-block-products-show-more'\n\t\t\t\t},\n\t\t\t\tevents: {\n\t\t\t\t\tclick: this._moreButtonClickHandler\n\t\t\t\t},\n\t\t\t\ttext: Loc.getMessage('DOCUMENT_PRODUCTS_NOT_SHOWN', {'#COUNT#': restLength.toString()}),\n\t\t\t}\n\t\t);\n\t\tnameCell.appendChild(this._moreButton);\n\n\t\trow.appendChild(\n\t\t\tBX.create('div', {\n\t\t\t\tprops: {\n\t\t\t\t\tclassName: 'catalog-entity-widget-content-block-products-price'\n\t\t\t\t}\n\t\t\t})\n\t\t);\n\t}\n\n\taddTotalRow(total)\n\t{\n\t\tvar row = BX.create('div', {\n\t\t\tprops: {\n\t\t\t\tclassName: 'catalog-entity-widget-content-block-products-item'\n\t\t\t}\n\t\t});\n\t\tthis._totalsRow = row;\n\t\tthis._productsContainer.appendChild(row);\n\t\tvar nameCell = BX.create('div', {\n\t\t\tprops: {\n\t\t\t\tclassName: 'catalog-entity-widget-content-block-products-item-name'\n\t\t\t},\n\t\t\thtml: Loc.getMessage('DOCUMENT_PRODUCTS_TOTAL'),\n\t\t});\n\t\trow.appendChild(nameCell);\n\n\t\tvar valueCell = BX.create('div', {\n\t\t\tprops: {\n\t\t\t\tclassName: 'catalog-entity-widget-content-block-products-price'\n\t\t\t},\n\t\t\thtml: CurrencyCore.currencyFormat(total.amount, total.currency, true),\n\t\t});\n\t\trow.appendChild(valueCell);\n\t}\n\n\taddAddProductButton()\n\t{\n\t\tlet addProductsLink = BX.create(\n\t\t\t'a',\n\t\t\t{\n\t\t\t\tprops: {href: '#'}\n\t\t\t}\n\t\t);\n\t\taddProductsLink.text = Loc.getMessage('DOCUMENT_PRODUCTS_ADD_PRODUCT');\n\t\taddProductsLink.onclick = () => {\n\t\t\tEventEmitter.emit('BX.Catalog.EntityCard.TabManager:onOpenTab', {tabId: 'tab_products'})\n\t\t};\n\t\tlet row = BX.create('div', {\n\t\t\tprops: {\n\t\t\t\tclassName: 'catalog-entity-widget-content-block-products-add-products',\n\t\t\t},\n\t\t\tchildren: [addProductsLink],\n\t\t});\n\t\tthis._productsContainer.appendChild(row);\n\t}\n\n\t_onMoreButtonClick(e)\n\t{\n\t\tEventEmitter.emit('BX.Catalog.EntityCard.TabManager:onOpenTab', {tabId: 'tab_products'});\n\t}\n\n\tdoClearLayout()\n\t{\n\t\tthis._productsContainer = null;\n\t\tthis._moreButton = null;\n\t\tthis._moreButtonRow = null;\n\t\tthis._totalsRow = null;\n\t}\n\n\taddProductRow(data)\n\t{\n\t\tvar row = BX.create('div', {\n\t\t\tprops: {\n\t\t\t\tclassName: 'catalog-entity-widget-content-block-products-item'\n\t\t\t}\n\t\t});\n\n\t\tthis._productsContainer.appendChild(row);\n\n\t\tvar nameCell = BX.create('div', {\n\t\t\tprops: {\n\t\t\t\tclassName: 'catalog-entity-widget-content-block-products-item-name'\n\t\t\t}\n\t\t});\n\t\tnameCell.innerHTML = BX.util.htmlspecialchars(data['PRODUCT_NAME']);\n\t\trow.appendChild(nameCell);\n\n\t\tvar valueCell = BX.create(\n\t\t\t'div',\n\t\t\t{\n\t\t\t\tprops: {\n\t\t\t\t\tclassName: 'catalog-entity-widget-content-block-products-price'\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t\trow.appendChild(valueCell);\n\n\t\tvalueCell.appendChild(\n\t\t\tBX.create(\n\t\t\t\t'div',\n\t\t\t\t{\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\tclassName: 'catalog-entity-widget-content-block-products-price-value'\n\t\t\t\t\t},\n\t\t\t\t\thtml: data['SUM']\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t}\n}\n","import {ajax, Loc, Tag} from \"main.core\";\nimport {Dialog, TagSelector} from 'ui.entity-selector';\n\nexport default class Contractor extends BX.UI.EntityEditorField {\n\tconstructor(id, settings)\n\t{\n\t\tsuper();\n\t\tthis.initialize(id, settings);\n\n\t\tthis._input = null;\n\t\tthis.innerWrapper = null;\n\t\tthis.currentContractorName = '';\n\t\tthis.viewModeDisplay = null;\n\t}\n\n\tgetContentWrapper()\n\t{\n\t\treturn this.innerWrapper;\n\t}\n\n\tlayout(options = {})\n\t{\n\t\tif(this._hasLayout)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tthis.ensureWrapperCreated({});\n\t\tthis.adjustWrapper();\n\n\t\tlet title = this.getTitle();\n\t\tif (this.isDragEnabled())\n\t\t{\n\t\t\tthis._wrapper.appendChild(this.createDragButton());\n\t\t}\n\n\t\tthis._wrapper.appendChild(this.createTitleNode(title));\n\n\t\tlet name = this.getName();\n\t\tlet value = this.getValue();\n\t\tlet data = this._schemeElement.getData();\n\t\tif (!this.currentContractorName)\n\t\t{\n\t\t\tthis.currentContractorName = this.getContractorNameFromModel();\n\t\t}\n\t\tthis._input = Tag.render`<input name=\"${name}\" type=\"hidden\" value=\"${value}\"/>`;\n\t\tthis._wrapper.appendChild(this._input);\n\n\t\tthis.innerWrapper = Tag.render`<div class=\"ui-entity-editor-content-block\"></div>`;\n\t\tthis._wrapper.appendChild(this.innerWrapper);\n\n\t\tif(this._mode === BX.UI.EntityEditorMode.edit)\n\t\t{\n\t\t\tlet currentSelectedItems = [];\n\t\t\tif (value)\n\t\t\t{\n\t\t\t\tcurrentSelectedItems.push({\n\t\t\t\t\tid: value,\n\t\t\t\t\tentityId: 'contractor',\n\t\t\t\t\ttitle: this.currentContractorName,\n\t\t\t\t})\n\t\t\t}\n\n\t\t\tlet contractorSelector = new TagSelector({\n\t\t\t\titems: currentSelectedItems,\n\t\t\t\tplaceholder: Loc.getMessage('DOCUMENT_CONTRACTOR_FIELD_PLACEHOLDER'),\n\t\t\t\ttextBoxWidth: '100%',\n\t\t\t\tmultiple: false,\n\t\t\t\tdialogOptions: {\n\t\t\t\t\tcontext: 'catalog_document_contractors',\n\t\t\t\t\tentities: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tid: 'contractor',\n\t\t\t\t\t\t\tdynamicLoad: true,\n\t\t\t\t\t\t\tdynamicSearch: true,\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t\tsearchOptions: {\n\t\t\t\t\t\tallowCreateItem: true,\n\t\t\t\t\t\tfooterOptions: {\n\t\t\t\t\t\t\tlabel: Loc.getMessage('DOCUMENT_ADD_CONTRACTOR'),\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tevents: {\n\t\t\t\t\t\t'Item:onSelect': (event) => {\n\t\t\t\t\t\t\tthis._input.value = event.data.item.getId();\n\t\t\t\t\t\t\tif (this.viewModeDisplay)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.currentContractorName = event.data.item.getTitle();\n\t\t\t\t\t\t\t\tthis.viewModeDisplay.innerHTML = BX.util.htmlspecialchars(this.currentContractorName);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tthis._changeHandler();\n\t\t\t\t\t\t},\n\t\t\t\t\t\t'Search:onItemCreateAsync': this.createContractor.bind(this),\n\t\t\t\t\t\t'Item:onDeselect': (event) => {\n\t\t\t\t\t\t\tthis._input.value = '';\n\t\t\t\t\t\t\tthis._changeHandler();\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t});\n\n\t\t\tcontractorSelector.renderTo(this.innerWrapper);\n\n\t\t\tif (BX.UI.EntityEditorModeOptions.check(this._modeOptions, BX.UI.EntityEditorModeOptions.individual))\n\t\t\t{\n\t\t\t\tcontractorSelector.getDialog().show();\n\t\t\t}\n\t\t}\n\t\telse // if(this._mode === BX.UI.EntityEditorMode.view)\n\t\t{\n\t\t\tif (this.hasContentToDisplay())\n\t\t\t{\n\t\t\t\tthis.viewModeDisplay = Tag.render`<div class=\"ui-entity-editor-content-block-text\">${BX.util.htmlspecialchars(this.currentContractorName)}</div>`;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.viewModeDisplay = Tag.render`<div class=\"ui-entity-editor-content-block-text\">${Loc.getMessage('DOCUMENT_CONTRACTOR_NOT_FILLED')}</div>`;\n\t\t\t}\n\n\t\t\tthis.innerWrapper.appendChild(this.viewModeDisplay);\n\t\t}\n\n\t\tif (this.isContextMenuEnabled())\n\t\t{\n\t\t\tthis._wrapper.appendChild(this.createContextMenuButton());\n\t\t}\n\n\t\tif (this.isDragEnabled())\n\t\t{\n\t\t\tthis.initializeDragDropAbilities();\n\t\t}\n\n\t\tthis.registerLayout(options);\n\t\tthis._hasLayout = true;\n\t}\n\n\tvalidate(result)\n\t{\n\t\tif(!(this._mode === BX.UI.EntityEditorMode.edit && this._input))\n\t\t{\n\t\t\tthrow \"BX.Catalog.DocumentCard.Contractor. Invalid validation context\";\n\t\t}\n\n\t\tthis.clearError();\n\n\t\tif(this.hasValidators())\n\t\t{\n\t\t\treturn this.executeValidators(result);\n\t\t}\n\n\t\tlet isValid = !(this.isRequired() || this.isRequiredByAttribute()) || BX.util.trim(this._input.value) !== \"\";\n\t\tif (!isValid)\n\t\t{\n\t\t\tresult.addError(BX.UI.EntityValidationError.create({ field: this }));\n\t\t\tthis.showRequiredFieldError(this._input);\n\t\t}\n\t\treturn isValid;\n\t}\n\n\thasValue()\n\t{\n\t\tif (this.getValue() === '0')\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\treturn super.hasValue();\n\t}\n\n\tgetModeSwitchType(mode)\n\t{\n\t\tlet result = BX.UI.EntityEditorModeSwitchType.common;\n\n\t\tif (mode === BX.UI.EntityEditorMode.edit)\n\t\t{\n\t\t\tresult |= BX.UI.EntityEditorModeSwitchType.button | BX.UI.EntityEditorModeSwitchType.content;\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tcreateContractor(event)\n\t{\n\t\tlet {searchQuery} = event.getData();\n\t\tlet companyName = searchQuery.getQuery();\n\n\t\treturn new Promise(\n\t\t\t(resolve, reject) => {\n\t\t\t\tconst dialog: Dialog = event.getTarget();\n\t\t\t\tconst fields = {\n\t\t\t\t\tcompanyName,\n\t\t\t\t};\n\n\t\t\t\tdialog.showLoader();\n\t\t\t\tajax.runAction(\n\t\t\t\t\t'catalog.contractor.createContractor',\n\t\t\t\t\t{\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\tfields\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t\t.then(response => {\n\t\t\t\t\tdialog.hideLoader();\n\t\t\t\t\tconst item = dialog.addItem({\n\t\t\t\t\t\tid: response.data.id,\n\t\t\t\t\t\tentityId: 'contractor',\n\t\t\t\t\t\ttitle: searchQuery.getQuery(),\n\t\t\t\t\t\ttabs: dialog.getRecentTab().getId(),\n\t\t\t\t\t});\n\n\t\t\t\t\tif (item)\n\t\t\t\t\t{\n\t\t\t\t\t\titem.select();\n\t\t\t\t\t}\n\n\t\t\t\t\tdialog.hide();\n\t\t\t\t\tresolve();\n\t\t\t\t})\n\t\t\t\t.catch(() => {\n\t\t\t\t\tdialog.hideLoader();\n\t\t\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\t\t\tcontent: Loc.getMessage('DOCUMENT_ADD_CONTRACTOR_ERROR'),\n\t\t\t\t\t});\n\t\t\t\t\tdialog.hide();\n\t\t\t\t\treject();\n\t\t\t\t});\n\t\t\t}\n\t\t);\n\t}\n\n\tgetContractorNameFromModel()\n\t{\n\t\treturn this._model.getSchemeField(this._schemeElement, 'contractorName', '');\n\t}\n\n\trollback()\n\t{\n\t\tthis.currentContractorName = this.getContractorNameFromModel();\n\t}\n}\n","import {type BaseEvent, EventEmitter} from 'main.core.events'\nimport ProductRowSummary from \"./row-summary\";\nimport Contractor from \"./contractor\";\n\nexport default class FieldsFactory\n{\n\tconstructor()\n\t{\n\t\tEventEmitter.subscribe('BX.UI.EntityEditorControlFactory:onInitialize', (event: BaseEvent) => {\n\t\t\tconst [, eventArgs] = event.getCompatData();\n\t\t\teventArgs.methods['documentCard'] = this.factory.bind(this);\n\t\t});\n\t}\n\n\tfactory(type, controlId, settings)\n\t{\n\t\tif (type === 'product_row_summary')\n\t\t{\n\t\t\treturn new ProductRowSummary(controlId, settings);\n\t\t}\n\t\tif (type === 'contractor')\n\t\t{\n\t\t\treturn new Contractor(controlId, settings);\n\t\t}\n\n\t\treturn null;\n\t}\n}","import {Loc, Reflection, Type} from \"main.core\";\nimport {BaseCard} from \"catalog.entity-card\";\nimport {EventEmitter} from \"main.core.events\";\nimport {Dialog} from 'ui.entity-selector';\nimport ControllersFactory from \"../controllers-factory\";\nimport ModelFactory from \"../model/model-factory\";\nimport FieldsFactory from \"../editor-fields/fields-factory\";\nimport {MenuManager} from \"main.popup\";\nimport {Text} from \"main.core\";\nimport ProductListController from \"../product-list/controller\";\nimport {Slider} from 'catalog.store-use'\n\nclass DocumentCard extends BaseCard\n{\n\tstatic #instance;\n\n\tstatic #fieldFactory;\n\tstatic #modelFactory;\n\tstatic #controllersFactory;\n\n\tstatic initializeEntityEditorFactories()\n\t{\n\t\tDocumentCard.registerFieldFactory();\n\t\tDocumentCard.registerModelFactory();\n\t\tDocumentCard.registerDocumentControllersFactory();\n\t}\n\n\tconstructor(id, settings)\n\t{\n\t\tsuper(id, settings);\n\t\tthis.documentType = settings.documentType;\n\t\tthis.isDocumentConducted = settings.documentStatus === 'Y';\n\t\tthis.componentName = settings.componentName;\n\t\tthis.signedParameters = settings.signedParameters;\n\t\tthis.isConductLocked = settings.isConductLocked;\n\t\tthis.masterSliderUrl = settings.masterSliderUrl;\n\n\t\tthis.isTabAnalyticsSent = false;\n\n\t\tthis.setSliderText();\n\t\tthis.addCopyLinkPopup();\n\t\tthis.subscribeToEvents();\n\n\t\tif (settings.documentTypeSelector)\n\t\t{\n\t\t\tthis.initDocumentTypeSelector();\n\t\t}\n\n\t\tDocumentCard.#instance = this;\n\n\t\t// setting this to true so that we can decide\n\t\t// whether to close the slider or not on the fly on backend (closeOnSave=Y)\n\t\tBX.UI.SidePanel.Wrapper.setParam(\"closeAfterSave\", true);\n\t\tthis.showNotificationOnClose = false;\n\t}\n\n\tstatic getInstance()\n\t{\n\t\treturn DocumentCard.#instance;\n\t}\n\n\tinitDocumentTypeSelector()\n\t{\n\t\tlet documentTypeSelector = this.settings.documentTypeSelector;\n\t\tlet documentTypeSelectorTypes = this.settings.documentTypeSelectorTypes;\n\t\tif (!documentTypeSelector || !documentTypeSelectorTypes)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet menuItems = [];\n\t\tdocumentTypeSelectorTypes.forEach((type) => {\n\t\t\tmenuItems.push({\n\t\t\t\ttext: Loc.getMessage('DOC_TYPE_SHORT_' + type),\n\t\t\t\tonclick: (e) => {\n\t\t\t\t\tlet slider = BX.SidePanel.Instance.getTopSlider();\n\t\t\t\t\tif (slider)\n\t\t\t\t\t{\n\t\t\t\t\t\tslider.url = BX.Uri.addParam(slider.getUrl(), {DOCUMENT_TYPE: type});\n\t\t\t\t\t\tslider.url = BX.Uri.removeParam(slider.url, ['firstTime']);\n\n\t\t\t\t\t\tif (type === 'A' || type === 'S')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tslider.requestMethod = 'post';\n\t\t\t\t\t\t\tslider.requestParams = {\n\t\t\t\t\t\t\t\t'preloadedFields': {\n\t\t\t\t\t\t\t\t\t'DOCUMENT_FIELDS': this.getDocumentFieldsForTypeSwitching(),\n\t\t\t\t\t\t\t\t\t'PRODUCTS': this.getProductsForTypeSwitching(),\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tslider.setFrameSrc();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t});\n\t\t});\n\t\tlet popupMenu = MenuManager.create({\n\t\t\tid: 'document-type-selector',\n\t\t\tbindElement: documentTypeSelector,\n\t\t\titems: menuItems,\n\t\t});\n\n\t\tdocumentTypeSelector.addEventListener('click', e => {\n\t\t\te.preventDefault();\n\t\t\tpopupMenu.show();\n\t\t});\n\t}\n\n\tgetDocumentFieldsForTypeSwitching()\n\t{\n\t\tconst documentFields = {};\n\t\tconst editor = this.getEditorInstance();\n\t\tif (!editor)\n\t\t{\n\t\t\treturn documentFields;\n\t\t}\n\n\t\tconst form = editor.getFormElement();\n\t\tconst formData = new FormData(form);\n\t\tconst formProps = Object.fromEntries(formData);\n\n\t\tconst fieldsToTransfer = ['TITLE', 'CURRENCY', 'TOTAL'];\n\t\tfieldsToTransfer.forEach((field) => {\n\t\t\tdocumentFields[field] = formProps[field] ?? '';\n\t\t});\n\n\t\treturn documentFields;\n\t}\n\n\tgetProductsForTypeSwitching()\n\t{\n\t\tconst products = [];\n\t\tif (!Reflection.getClass('BX.Catalog.Store.ProductList.Instance'))\n\t\t{\n\t\t\treturn products;\n\t\t}\n\n\t\tconst productFields = ['ID', 'STORE_TO', {'ELEMENT_ID': 'SKU_ID'}, 'AMOUNT', 'PURCHASING_PRICE', 'BASE_PRICE', 'BASE_PRICE_EXTRA', 'BASE_PRICE_EXTRA_RATE'];\n\t\tBX.Catalog.Store.ProductList.Instance.getProductsFields().forEach((productRow) => {\n\t\t\tlet product = {};\n\t\t\tproductFields.forEach((field) => {\n\t\t\t\tif (Type.isObject(field))\n\t\t\t\t{\n\t\t\t\t\tconst destinationField = Object.keys(field)[0];\n\t\t\t\t\tconst sourceField = field[destinationField];\n\t\t\t\t\tproduct[destinationField] = productRow[sourceField] ?? '';\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tproduct[field] = productRow[field] ?? '';\n\t\t\t\t}\n\t\t\t});\n\t\t\tproducts.push(product);\n\t\t});\n\n\t\treturn products;\n\t}\n\n\topenMasterSlider()\n\t{\n\t\tlet card = this;\n\n\t\tnew Slider().open(\n\t\t\tthis.masterSliderUrl,\n\t\t\t{\n\t\t\t\tdata: {\n\t\t\t\t\topenGridOnDone: false,\n\t\t\t\t},\n\t\t\t\tevents: {\n\t\t\t\t\tonCloseComplete: function(event) {\n\t\t\t\t\t\tlet slider = event.getSlider();\n\t\t\t\t\t\tif (!slider)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (slider.getData().get('isInventoryManagementEnabled'))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcard.isConductLocked = false;\n\n\t\t\t\t\t\t\tBX.SidePanel.Instance.getOpenSliders().forEach((slider) => {\n\t\t\t\t\t\t\t\tif (slider.getWindow()?.BX.Catalog?.DocumentGridManager)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tslider.allowChangeHistory = false;\n\t\t\t\t\t\t\t\t\tslider.getWindow().location.reload();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t}\n\n\tadjustToolPanel()\n\t{\n\t\treturn;\n\t}\n\n\tstatic registerDocumentControllersFactory()\n\t{\n\t\tDocumentCard.#controllersFactory = new ControllersFactory();\n\t}\n\n\t// deprecated\n\tsetViewModeButtons(editor)\n\t{\n\t\teditor._toolPanel.showViewModeButtons();\n\t}\n\n\t// deprecated\n\tsetEditModeButtons(editor)\n\t{\n\t\teditor._toolPanel.showEditModeButtons();\n\t}\n\n\tgetEditorInstance()\n\t{\n\t\tif (Reflection.getClass('BX.UI.EntityEditor'))\n\t\t{\n\t\t\treturn BX.UI.EntityEditor.getDefault();\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tsubscribeToEvents()\n\t{\n\t\tthis.subscribeToUserSelectorEvent();\n\t\tthis.subscribeToValidationFailedEvent();\n\t\tthis.subscribeToOnSaveEvent();\n\t\tthis.subscribeToTabOpenEvent();\n\t\tthis.subscribeToDirectActionEvent();\n\t\tthis.subscribeToEntityCreateEvent();\n\t\tthis.subscribeToBeforeEntityRedirectEvent();\n\t}\n\n\tsubscribeToUserSelectorEvent()\n\t{\n\t\tEventEmitter.subscribe('BX.UI.EntityEditorUser:openSelector', (event) => {\n\t\t\tlet eventData = event.data[1];\n\t\t\tconst dialog = new Dialog({\n\t\t\t\ttargetNode: eventData.anchor,\n\t\t\t\tenableSearch: true,\n\t\t\t\tmultiple: false,\n\t\t\t\tcontext: 'CATALOG_DOCUMENT',\n\t\t\t\tentities: [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'user',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'department',\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\tevents: {\n\t\t\t\t\t'Item:onSelect': (onSelectEvent) => {\n\t\t\t\t\t\tlet fieldId = eventData.id;\n\t\t\t\t\t\tlet selectedItem = onSelectEvent.data.item;\n\t\t\t\t\t\tlet userData = {\n\t\t\t\t\t\t\tentityId: selectedItem.id,\n\t\t\t\t\t\t\tavatar: selectedItem.avatar,\n\t\t\t\t\t\t\tname: Text.encode(selectedItem.title.text),\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\tif (this.entityId > 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlet fields = {};\n\t\t\t\t\t\t\tfields[fieldId] = selectedItem.id;\n\t\t\t\t\t\t\tBX.ajax.runComponentAction(\n\t\t\t\t\t\t\t\tthis.componentName,\n\t\t\t\t\t\t\t\t'save',\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tmode: 'class',\n\t\t\t\t\t\t\t\t\tsignedParameters: this.signedParameters,\n\t\t\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\t\t\tfields: fields,\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t).then((result) => {\n\t\t\t\t\t\t\t\teventData.callback(dialog, userData);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\teventData.callback(dialog, userData);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t});\n\t\t\tdialog.show();\n\t\t});\n\t}\n\n\tsubscribeToValidationFailedEvent()\n\t{\n\t\tEventEmitter.subscribe('BX.UI.EntityEditor:onFailedValidation', (event) => {\n\t\t\tEventEmitter.emit('BX.Catalog.EntityCard.TabManager:onOpenTab', {tabId: 'main'});\n\t\t});\n\t\tEventEmitter.subscribe('onProductsCheckFailed', (event) => {\n\t\t\tEventEmitter.emit('BX.Catalog.EntityCard.TabManager:onOpenTab', {tabId: 'tab_products'});\n\t\t});\n\t}\n\n\tsubscribeToOnSaveEvent()\n\t{\n\t\tEventEmitter.subscribe('BX.UI.EntityEditor:onSave', (event) => {\n\t\t\tconst eventEditor = event.data[0];\n\t\t\tconst action = event.data[1]?.actionId;\n\t\t\tif (eventEditor && eventEditor._ajaxForm)\n\t\t\t{\n\t\t\t\teventEditor._toolPanel?.clearErrors();\n\n\t\t\t\tif (action === 'SAVE_AND_CONDUCT')\n\t\t\t\t{\n\t\t\t\t\tif (this.isConductLocked)\n\t\t\t\t\t{\n\t\t\t\t\t\tevent.data[1].cancel = true;\n\t\t\t\t\t\tevent.data[0]._toolPanel?.setLocked(false);\n\t\t\t\t\t\tthis.openMasterSlider();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!this.validateControllers(eventEditor.getControllers()))\n\t\t\t\t\t{\n\t\t\t\t\t\tevent.data[1].cancel = true;\n\t\t\t\t\t\teventEditor._toolPanel?.setLocked(false);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (event.data[1].cancel)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tlet form = eventEditor._ajaxForms[action];\n\t\t\t\tif (form)\n\t\t\t\t{\n\t\t\t\t\tform.addUrlParams({\n\t\t\t\t\t\tdocumentType: this.documentType,\n\t\t\t\t\t\tisNewDocument: this.entityId <= 0 ? 'Y' : 'N',\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tsubscribeToTabOpenEvent()\n\t{\n\t\tEventEmitter.subscribe('BX.Catalog.EntityCard.TabManager:onSelectItem', (event) => {\n\t\t\tconst tabId = event.data.tabId;\n\t\t\tif (tabId === 'tab_products' && !this.isTabAnalyticsSent)\n\t\t\t{\n\t\t\t\tthis.sendAnalyticsData({\n\t\t\t\t\ttab: 'products',\n\t\t\t\t\tisNewDocument: this.entityId <= 0 ? 'Y' : 'N',\n\t\t\t\t\tdocumentType: this.documentType,\n\t\t\t\t});\n\t\t\t\tthis.isTabAnalyticsSent = true;\n\t\t\t}\n\t\t});\n\t}\n\n\tsubscribeToDirectActionEvent()\n\t{\n\t\tEventEmitter.subscribe('BX.UI.EntityEditor:onDirectAction', (event) => {\n\n\t\t\tconst eventEditor = event.data[0];\n\n\t\t\tif (event.data[1]?.actionId === 'CONDUCT')\n\t\t\t{\n\t\t\t\teventEditor._toolPanel?.clearErrors();\n\n\t\t\t\tif (this.isConductLocked)\n\t\t\t\t{\n\t\t\t\t\tevent.data[1].cancel = true;\n\t\t\t\t\tevent.data[0]._toolPanel?.setLocked(false);\n\t\t\t\t\tthis.openMasterSlider();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!this.validateControllers(eventEditor.getControllers()))\n\t\t\t\t{\n\t\t\t\t\tevent.data[1].cancel = true;\n\t\t\t\t\teventEditor._toolPanel?.setLocked(false);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tevent.data[0]._ajaxForms['CONDUCT'].addUrlParams({\n\t\t\t\t\tdocumentType: this.documentType,\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (event.data[1]?.actionId === 'CANCEL_CONDUCT')\n\t\t\t{\n\t\t\t\tevent.data[0]._ajaxForms['CANCEL_CONDUCT'].addUrlParams({\n\t\t\t\t\tdocumentType: this.documentType,\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\n\tsubscribeToEntityCreateEvent()\n\t{\n\t\tEventEmitter.subscribe('onEntityCreate', (event) => {\n\t\t\twindow.top.BX.onCustomEvent('DocumentCard:onEntityCreate');\n\t\t\tBX.SidePanel.Instance.getOpenSliders().forEach((slider) => {\n\t\t\t\tif (slider.getWindow()?.BX.Catalog?.DocumentGridManager)\n\t\t\t\t{\n\t\t\t\t\tslider.getWindow().BX.onCustomEvent('DocumentCard:onEntityCreate');\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tlet editor = event?.data[0]?.sender;\n\t\t\tif (editor)\n\t\t\t{\n\t\t\t\teditor._toolPanel.disableSaveButton();\n\t\t\t\teditor.hideToolPanel();\n\t\t\t}\n\t\t});\n\t}\n\n\tsubscribeToBeforeEntityRedirectEvent()\n\t{\n\t\tEventEmitter.subscribe('beforeEntityRedirect', (event) => {\n\t\t\twindow.top.BX.onCustomEvent('DocumentCard:onBeforeEntityRedirect');\n\t\t\tBX.SidePanel.Instance.getOpenSliders().forEach((slider) => {\n\t\t\t\tslider.getWindow().BX.onCustomEvent('DocumentCard:onBeforeEntityRedirect');\n\t\t\t});\n\t\t\tlet editor = event?.data[0]?.sender;\n\t\t\tif (editor)\n\t\t\t{\n\t\t\t\teditor._toolPanel.disableSaveButton();\n\t\t\t\teditor.hideToolPanel();\n\n\t\t\t\tthis.showNotificationOnClose = event?.data[0]?.showNotificationOnClose === 'Y';\n\n\t\t\t\tif (this.showNotificationOnClose)\n\t\t\t\t{\n\t\t\t\t\tlet url = event.data[0].redirectUrl;\n\t\t\t\t\tif (!url)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\turl = BX.Uri.removeParam(url, 'closeOnSave');\n\n\t\t\t\t\twindow.top.BX.UI.Notification.Center.notify({\n\t\t\t\t\t\tcontent: Loc.getMessage('DOCUMENT_CONDUCT_SUCCESSFUL'),\n\t\t\t\t\t\tactions: [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttitle: Loc.getMessage('DOCUMENT_CONDUCT_SUCCESSFUL_VIEW'),\n\t\t\t\t\t\t\t\thref: url,\n\t\t\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\t\t\tclick: function(event, balloon, action) {\n\t\t\t\t\t\t\t\t\t\tballoon.close();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t],\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tvalidateControllers(controllers)\n\t{\n\t\tlet validateResult = true;\n\t\tif (controllers instanceof Array)\n\t\t{\n\t\t\tcontrollers.forEach((controller) => {\n\t\t\t\tif (controller instanceof ProductListController)\n\t\t\t\t{\n\t\t\t\t\tif (!controller.validateProductList())\n\t\t\t\t\t{\n\t\t\t\t\t\tvalidateResult = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tvalidateResult = false;\n\t\t}\n\n\t\treturn validateResult;\n\t}\n\n\tsendAnalyticsData(data)\n\t{\n\t\tBX.ajax.runAction(\n\t\t\t'catalog.analytics.sendAnalyticsLabel',\n\t\t\t{\n\t\t\t\tanalyticsLabel: data,\n\t\t\t}\n\t\t);\n\t}\n\n\taddCopyLinkPopup()\n\t{\n\t\tlet copyLinkButton = document.getElementById(this.settings.copyLinkButtonId);\n\t\tif (!copyLinkButton)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tcopyLinkButton.onclick = () => {\n\t\t\tthis.copyDocumentLinkToClipboard();\n\t\t}\n\t}\n\n\tcopyDocumentLinkToClipboard()\n\t{\n\t\tlet url = BX.util.remove_url_param(window.location.href, [\"IFRAME\", \"IFRAME_TYPE\"]);\n\t\tif(!BX.clipboard.copy(url))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tvar popup = new BX.PopupWindow(\n\t\t\t'catalog_copy_document_url_to_clipboard',\n\t\t\tdocument.getElementById(this.settings.copyLinkButtonId),\n\t\t\t{\n\t\t\t\tcontent: Loc.getMessage('DOCUMENT_LINK_COPIED'),\n\t\t\t\tdarkMode: true,\n\t\t\t\tautoHide: true,\n\t\t\t\tzIndex: 1000,\n\t\t\t\tangle: true,\n\t\t\t\tbindOptions: { position: \"top\" }\n\t\t\t}\n\t\t);\n\t\tpopup.show();\n\n\t\tsetTimeout(function(){ popup.close(); }, 1500);\n\t}\n\n\tstatic registerFieldFactory()\n\t{\n\t\tDocumentCard.#fieldFactory = new FieldsFactory();\n\t}\n\n\tstatic registerModelFactory()\n\t{\n\t\tDocumentCard.#modelFactory = new ModelFactory();\n\t}\n\n\tsetSliderText()\n\t{\n\t\tlet slider = BX.SidePanel.Instance.getTopSlider();\n\t\tif (slider)\n\t\t{\n\t\t\tslider.getLabel().setText(Loc.getMessage('SLIDER_LABEL_' + this.documentType));\n\t\t}\n\t}\n\n\tdisableSaveAndConductButton()\n\t{\n\t\tif(!this.conductAndSaveButton)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.conductAndSaveButton.disabled = true;\n\t\tBX.addClass(this.conductAndSaveButton, 'ui-btn-disabled');\n\t}\n\n\tenableSaveAndConductButton()\n\t{\n\t\tif(!this.conductAndSaveButton)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.conductAndSaveButton.disabled = false;\n\t\tBX.removeClass(this.conductAndSaveButton, 'ui-btn-disabled');\n\t}\n}\n\nexport default DocumentCard;\n","import {Loc, Tag} from 'main.core';\nimport 'ui.feedback.form';\n\nexport default class Button\n{\n\tstatic render(parentNode, highlight)\n\t{\n\t\tconst buttonTitle = Loc.getMessage('FEEDBACK_BUTTON_TITLE');\n\n\t\tconst button = Tag.render`\n\t\t\t<button class=\"ui-btn ui-btn-light-border ui-btn-themes\" title=\"${buttonTitle}\">\n\t\t\t\t<span class=\"ui-btn-text\">\n\t\t\t\t\t${buttonTitle}\n\t\t\t\t</span>\n\t\t\t</button>\n\t\t`;\n\t\tif (highlight)\n\t\t{\n\t\t\tbutton.style.zIndex = 140;\n\t\t\tbutton.style.backgroundColor = '#fff';\n\t\t}\n\n\t\tbutton.addEventListener('click', () => {\n\t\t\tBX.UI.Feedback.Form.open({\n\t\t\t\tid: 'catalog-store-document-card-feedback',\n\t\t\t\tforms: [\n\t\t\t\t\t{'id': 384, 'lang': 'ru', 'sec': '0pskpd', 'zones': ['ru', 'by', 'kz']},\n\t\t\t\t\t{'id': 392, 'lang': 'en', 'sec': 'siqjqa', 'zones': ['en', 'ua']},\n\t\t\t\t\t{'id': 388, 'lang': 'es', 'sec': '53t2bu', 'zones': ['es']},\n\t\t\t\t\t{'id': 390, 'lang': 'de', 'sec': 'mhglfc', 'zones': ['de']},\n\t\t\t\t\t{'id': 386, 'lang': 'com.br', 'sec': 't6tdpy', 'zones': ['com.br']},\n\t\t\t\t],\n\t\t\t});\n\t\t});\n\n\t\tparentNode.appendChild(button);\n\n\t\treturn button;\n\t}\n}\n"],"names":["ProductListController","id","settings","_currencyId","initialize","_setProductListHandler","handleSetProductList","bind","_tabShowHandler","onTabShow","_editorControlChangeHandler","onEditorControlChange","_model","getField","EventEmitter","subscribe","_editor","event","productList","getData","setProductList","unsubscribe","reloadGrid","tab","handleOnTabShow","emit","rollback","onInnerCancel","changeCurrencyId","_isChanged","destroy","setController","setForm","getFormElement","getCurrencyId","_prevProductCount","_curProductCount","getProductCount","removeFormFields","_toolPanel","showViewModeButtons","disableSaveButton","markAsChanged","getProductsFields","isChanged","isNew","compileProductData","enableSaveButton","field","params","BX","UI","EntityEditorMoney","fieldName","fieldValue","totalData","setField","Currency","currencyFormat","totalCost","getControlById","refreshLayout","errorsArray","validate","length","addError","EntityEditorController","DocumentCardController","lockField","window","top","onCustomEvent","sliders","SidePanel","Instance","getOpenSliders","forEach","slider","getWindow","Catalog","DocumentGridManager","ControllersFactory","getCompatData","eventArgs","methods","factory","type","controlId","DocumentModel","title","isString","caption","data","EntityModel","ModelFactory","ProductRowSummary","_loader","_productsContainer","_previousData","_itemCount","_totalCount","_moreButton","_moreButtonRow","_totalsRow","_moreButtonClickHandler","delegate","_onMoreButtonClick","_visibleItemsLimit","options","_hasLayout","ensureWrapperCreated","adjustWrapper","getValue","isPlainObject","getTitle","items","prop","getArray","getInteger","maxLength","restLength","isDragEnabled","_wrapper","appendChild","createDragButton","createTitleNode","create","props","className","i","addProductRow","addMoreButton","addTotalRow","children","isContextMenuEnabled","createContextMenuButton","initializeDragDropAbilities","registerLayout","row","nameCell","attrs","events","click","text","Loc","getMessage","toString","total","html","valueCell","CurrencyCore","amount","currency","addProductsLink","href","onclick","tabId","e","innerHTML","util","htmlspecialchars","EntityEditorField","Contractor","_input","innerWrapper","currentContractorName","viewModeDisplay","name","getName","value","_schemeElement","getContractorNameFromModel","Tag","render","_mode","EntityEditorMode","edit","currentSelectedItems","push","entityId","contractorSelector","TagSelector","placeholder","textBoxWidth","multiple","dialogOptions","context","entities","dynamicLoad","dynamicSearch","searchOptions","allowCreateItem","footerOptions","label","item","getId","_changeHandler","createContractor","renderTo","EntityEditorModeOptions","check","_modeOptions","individual","getDialog","show","hasContentToDisplay","result","clearError","hasValidators","executeValidators","isValid","isRequired","isRequiredByAttribute","trim","EntityValidationError","showRequiredFieldError","mode","EntityEditorModeSwitchType","common","button","content","searchQuery","companyName","getQuery","Promise","resolve","reject","dialog","getTarget","fields","showLoader","ajax","runAction","then","response","hideLoader","addItem","tabs","getRecentTab","select","hide","Notification","Center","notify","getSchemeField","FieldsFactory","DocumentCard","registerFieldFactory","registerModelFactory","registerDocumentControllersFactory","documentType","isDocumentConducted","documentStatus","componentName","signedParameters","isConductLocked","masterSliderUrl","isTabAnalyticsSent","setSliderText","addCopyLinkPopup","subscribeToEvents","documentTypeSelector","initDocumentTypeSelector","Wrapper","setParam","showNotificationOnClose","documentTypeSelectorTypes","menuItems","getTopSlider","url","Uri","addParam","getUrl","DOCUMENT_TYPE","removeParam","requestMethod","requestParams","getDocumentFieldsForTypeSwitching","getProductsForTypeSwitching","setFrameSrc","popupMenu","MenuManager","bindElement","addEventListener","preventDefault","documentFields","editor","getEditorInstance","form","formData","FormData","formProps","Object","fromEntries","fieldsToTransfer","products","Reflection","getClass","productFields","Store","ProductList","productRow","product","Type","isObject","destinationField","keys","sourceField","card","Slider","open","openGridOnDone","onCloseComplete","getSlider","get","allowChangeHistory","location","reload","showEditModeButtons","EntityEditor","getDefault","subscribeToUserSelectorEvent","subscribeToValidationFailedEvent","subscribeToOnSaveEvent","subscribeToTabOpenEvent","subscribeToDirectActionEvent","subscribeToEntityCreateEvent","subscribeToBeforeEntityRedirectEvent","eventData","Dialog","targetNode","anchor","enableSearch","onSelectEvent","fieldId","selectedItem","userData","avatar","Text","encode","runComponentAction","callback","eventEditor","action","actionId","_ajaxForm","clearErrors","cancel","setLocked","openMasterSlider","validateControllers","getControllers","_ajaxForms","addUrlParams","isNewDocument","sendAnalyticsData","sender","hideToolPanel","redirectUrl","actions","balloon","close","controllers","validateResult","Array","controller","validateProductList","analyticsLabel","copyLinkButton","document","getElementById","copyLinkButtonId","copyDocumentLinkToClipboard","remove_url_param","clipboard","copy","popup","PopupWindow","darkMode","autoHide","zIndex","angle","bindOptions","position","setTimeout","getLabel","setText","conductAndSaveButton","disabled","addClass","removeClass","BaseCard","Button","parentNode","highlight","buttonTitle","style","backgroundColor","Feedback","Form","forms"],"mappings":"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"}