function JCCatTblEdit(t){if(!t)return;this.intERROR=0;this.PREFIX=t.PREFIX;this.PREFIX_TR=this.PREFIX+"ROW_";this.PROP_COUNT_ID=t.PROP_COUNT_ID;this.TABLE_PROP_ID=t.TABLE_PROP_ID;this.CELLS=[];this.CELL_CENT=[];BX.ready(BX.proxy(this.Init,this))}JCCatTblEdit.prototype.Init=function(){this.PROP_TBL=BX(this.TABLE_PROP_ID);if(!this.PROP_TBL){this.intERROR=-1;return}this.PROP_COUNT=BX(this.PROP_COUNT_ID);if(!this.PROP_COUNT)this.intERROR=-1};JCCatTblEdit.prototype.SetCells=function(t,i){var e;if(0>this.intERROR)return;if(t)this.CELLS=BX.clone(t,true);for(e=0;e<this.CELLS.length;e++)this.CELLS[e]=this.CELLS[e].replace(/PREFIX/gi,this.PREFIX);if(i)this.CELL_CENT=BX.clone(i,true)};JCCatTblEdit.prototype.addRow=function(){if(0>this.intERROR)return;var t,i=parseInt(this.PROP_COUNT.value,10),e,s,h,n;e=this.PROP_TBL.insertRow(this.PROP_TBL.rows.length);e.id=this.PREFIX_TR+i;for(t=0;t<this.CELLS.length;t++){s=e.insertCell(-1);h=this.CELLS[t];s.innerHTML=h.replace(/tmp_xxx/gi,i)}for(t=0;t<this.CELL_CENT.length;t++){n=e.cells[this.CELL_CENT[t]-1];if(n)BX.adjust(n,{style:{textAlign:"center"}})}this.PROP_COUNT.value=i+1};function JCCatTblEditExt(t){var i;if(!t)return;this.arParams=t;this.intERROR=0;this.PREFIX=t.PREFIX;this.PREFIX_NAME=t.PREFIX_NAME;this.PREFIX_TR=this.PREFIX+"ROW_";this.PROP_COUNT_ID=t.PROP_COUNT_ID;this.TABLE_PROP_ID=t.TABLE_PROP_ID;this.BTN_ID=t.BTN_ID;this.CELLS=[];this.CELL_PARAMS=[];this.dialog=null;this.eventId="setItemSelect"+this.PREFIX;this.itemId="";if(!!t.CELLS){this.CELLS=BX.clone(t.CELLS,true);for(i=0;i<this.CELLS.length;i++)this.CELLS[i]=this.CELLS[i].replace(/PREFIX/gi,this.PREFIX)}if(!!t.CELL_PARAMS)this.CELL_PARAMS=BX.clone(t.CELL_PARAMS,true);BX.ready(BX.proxy(this.Init,this))}JCCatTblEditExt.prototype.Init=function(){var t,i;this.PROP_TBL=BX(this.TABLE_PROP_ID);if(!this.PROP_TBL){this.intERROR=-1;return}this.PROP_COUNT=BX(this.PROP_COUNT_ID);if(!this.PROP_COUNT){this.intERROR=-1}else{this.BTN=BX(this.BTN_ID);if(!!this.BTN)BX.bind(this.BTN,"click",BX.proxy(this.addRow,this))}t=BX.findChild(this.PROP_TBL,{tagName:"input",attribute:{type:"button"}},true,true);if(!!t&&t.length>0){for(i=0;i<t.length;i++)BX.bind(BX(t[i]),"click",BX.proxy(this.showDialog,this))}t=null};JCCatTblEditExt.prototype.SetCells=function(t,i){var e;if(0>this.intERROR)return;if(!!t)this.CELLS=BX.clone(t,true);for(e=0;e<this.CELLS.length;e++){this.CELLS[e]=this.CELLS[e].replace(/PREFIXNAME/gi,this.PREFIX_NAME);this.CELLS[e]=this.CELLS[e].replace(/PREFIX/gi,this.PREFIX)}if(!!i)this.CELL_PARAMS=BX.clone(i,true)};JCCatTblEditExt.prototype.addRow=function(){if(0>this.intERROR)return;var t,i=parseInt(this.PROP_COUNT.value,10),e,s,h,n;e=this.PROP_TBL.insertRow(this.PROP_TBL.rows.length);e.id=this.PREFIX_TR+i;for(t=0;t<this.CELLS.length;t++){s=e.insertCell(-1);if(typeof this.CELL_PARAMS[t]==="object"){BX.adjust(s,this.CELL_PARAMS[t])}h=this.CELLS[t];s.innerHTML=h.replace(/tmp_xxx/gi,i)}n=BX.findChild(e,{tagName:"input",attribute:{type:"button"}},true,true);if(!!n&&n.length>0){for(t=0;t<n.length;t++)BX.bind(BX(n[t]),"click",BX.proxy(this.showDialog,this))}n=null;if(!!BX.adminFormTools)BX.adminFormTools.modifyFormElements(e);this.PROP_COUNT.value=i+1};JCCatTblEditExt.prototype.showDialog=function(){if(0>this.intERROR)return;var t=BX.proxy_context;if(!t||!t.hasAttribute("data-row-id"))return;this.itemId=t.getAttribute("data-row-id");if(this.dialog!==null)this.dialog=null;BX.removeCustomEvent(this.eventId,BX.proxy(this.onSave,this));this.dialog=new BX.CAdminDialog({content_url:this.arParams.SEARCH_PAGE+"?lang="+BX.message("LANGUAGE_ID")+"&caller=sets&event="+this.eventId,height:Math.max(500,window.innerHeight-400),width:Math.max(800,window.innerWidth-400),draggable:true,resizable:true,min_height:500,min_width:800});if(!!this.dialog){BX.addCustomEvent(this.eventId,BX.proxy(this.onSave,this));this.dialog.Show()}};JCCatTblEditExt.prototype.onSave=function(t){if(0>this.intERROR)return;var i,e,s;BX.removeCustomEvent(this.eventId,BX.proxy(this.onSave,this));if(typeof t==="object"&&this.itemId!=""){i=BX(this.itemId+"_ITEM_ID");if(!!i)i.value=t.id;e=BX(this.itemId+"_ITEM_ID_link");if(!!e)e.innerHTML=BX.util.htmlspecialchars(t.name);s=BX(this.itemId+"_MEASURE");if(!!s&&typeof t.measureRatio!=="undefined"&&typeof t.measure!=="undefined"){s.innerHTML=BX.util.htmlspecialchars(" * "+t.measureRatio+" "+t.measure)}}if(!!this.dialog)this.dialog.Close();this.dialog=null;this.itemId=""};
//# sourceMappingURL=tbl_edit.map.js