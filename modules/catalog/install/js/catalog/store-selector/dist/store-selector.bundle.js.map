{"version":3,"file":"store-selector.bundle.js","sources":["../src/store-search-input.js","../src/store-selector.js"],"sourcesContent":["import {ajax, Browser, Cache, Dom, Event, Loc, Tag, Text, Type} from 'main.core';\nimport {Dialog} from 'ui.entity-selector';\nimport './component.css';\nimport {StoreSelector} from 'catalog.store-selector';\nimport 'ui.notification';\n\nexport class StoreSearchInput\n{\n\tselector: StoreSelector;\n\tcache = new Cache.MemoryCache();\n\n\tconstructor(id, options = {})\n\t{\n\t\tthis.id = id || Text.getRandom();\n\t\tthis.selector = options.selector;\n\t\tif (!(this.selector instanceof StoreSelector))\n\t\t{\n\t\t\tthrow new Error('Store selector instance not found.');\n\t\t}\n\n\t\tthis.isEnabledDetailLink = options.isEnabledDetailLink;\n\t\tthis.inputName = options.inputName || '';\n\t}\n\n\tgetId()\n\t{\n\t\treturn this.id;\n\t}\n\n\ttoggleIcon(icon, value)\n\t{\n\t\tif (Type.isDomNode(icon))\n\t\t{\n\t\t\tDom.style(icon, 'display', value);\n\t\t}\n\t}\n\n\tgetNameBlock(): HTMLElement\n\t{\n\t\treturn this.cache.remember('nameBlock', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-ctl ui-ctl-textbox ui-ctl-w100\">\n\t\t\t\t\t${this.getNameInput()}\n\t\t\t\t\t${this.getHiddenNameInput()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetNameInput(): HTMLInputElement\n\t{\n\t\treturn this.cache.remember('nameInput', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<input type=\"text\"\n\t\t\t\t\tclass=\"ui-ctl-element ui-ctl-textbox\"\n\t\t\t\t\tautocomplete=\"off\"\n\t\t\t\t\tvalue=\"${Text.encode(this.selector.getStoreTitle())}\"\n\t\t\t\t\tplaceholder=\"${Text.encode(this.getPlaceholder())}\"\n\t\t\t\t\ttitle=\"${Text.encode(this.selector.getStoreTitle())}\"\n\t\t\t\t\tonchange=\"${this.handleNameInputHiddenChange.bind(this)}\"\n\t\t\t\t>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetHiddenNameInput(): HTMLInputElement\n\t{\n\t\treturn this.cache.remember('hiddenNameInput', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<input\n\t\t\t\t \ttype=\"hidden\"\n\t\t\t\t\tname=\"${Text.encode(this.inputName)}\"\n\t\t\t\t\tvalue=\"${Text.encode(this.selector.getStoreTitle())}\"\n\t\t\t\t>\n\t\t\t`;\n\t\t});\n\t}\n\n\thandleNameInputHiddenChange(event: UIEvent)\n\t{\n\t\tthis.getHiddenNameInput().value = event.target.value;\n\t}\n\n\tgetClearIcon(): HTMLElement\n\t{\n\t\treturn this.cache.remember('closeIcon', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<button\n\t\t\t\t\tclass=\"ui-ctl-after ui-ctl-icon-clear\"\n\t\t\t\t\tonclick=\"${this.handleClearIconClick.bind(this)}\"\n\t\t\t\t></button>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetArrowIcon(): HTMLElement\n\t{\n\t\treturn this.cache.remember('arrowIcon', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<a\n\t\t\t\t\thref=\"${this.selector.getDetailPath()}\"\n\t\t\t\t\ttarget=\"_blank\"\n\t\t\t\t\tclass=\"ui-ctl-after ui-ctl-icon-forward\"\n\t\t\t\t></button>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetSearchIcon(): HTMLElement\n\t{\n\t\treturn this.cache.remember('searchIcon', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<button\n\t\t\t\t\tclass=\"ui-ctl-after ui-ctl-icon-search\"\n\t\t\t\t\tonclick=\"${this.handleSearchIconClick.bind(this)}\"\n\t\t\t\t></button>\n\t\t\t`;\n\t\t});\n\t}\n\n\tclearInputCache()\n\t{\n\t\tthis.cache.delete('dialog');\n\t\tthis.cache.delete('nameBlock');\n\t\tthis.cache.delete('nameInput');\n\t\tthis.cache.delete('hiddenNameInput');\n\t}\n\n\tclearDialogCache()\n\t{\n\t\tthis.cache.delete('dialog');\n\t}\n\n\tlayout(): HTMLElement\n\t{\n\t\tthis.clearInputCache();\n\t\tconst block = Tag.render`<div class=\"ui-ctl ui-ctl-w100 ui-ctl-after-icon\"></div>`;\n\n\t\tblock.appendChild(this.getSearchIcon());\n\t\tthis.toggleIcon(this.getSearchIcon(), 'none');\n\n\t\tblock.appendChild(this.getClearIcon());\n\t\tthis.toggleIcon(this.getClearIcon(), 'none');\n\n\t\tif (this.showDetailLink() && Type.isStringFilled(this.selector.getStoreTitle()))\n\t\t{\n\t\t\tthis.toggleIcon(this.getArrowIcon(), 'block');\n\t\t\tblock.appendChild(this.getArrowIcon());\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.toggleIcon(this.getSearchIcon(), 'block');\n\t\t}\n\n\t\tEvent.bind(this.getNameInput(), 'click', this.handleNameInputClick.bind(this));\n\t\tEvent.bind(this.getNameInput(), 'input', this.handleNameInput.bind(this));\n\t\tEvent.bind(this.getNameInput(), 'blur', this.handleNameInputBlur.bind(this));\n\t\tEvent.bind(this.getNameInput(), 'keydown', this.handleNameInputKeyDown.bind(this));\n\n\t\tblock.appendChild(this.getNameBlock());\n\t\treturn block;\n\t}\n\n\thandleNameInputClick(event: UIEvent)\n\t{\n\t\tthis.searchInDialog(event.target.value);\n\t\tthis.handleIconsSwitchingOnNameInput(event);\n\t}\n\n\thandleNameInput(event: UIEvent)\n\t{\n\t\tthis.searchInDialog(event.target.value);\n\t\tthis.handleIconsSwitchingOnNameInput(event);\n\t}\n\n\tshowDetailLink(): string\n\t{\n\t\treturn this.isEnabledDetailLink;\n\t}\n\n\tgetDialog(): ?Dialog\n\t{\n\t\treturn this.cache.remember('dialog', () => {\n\t\t\tconst params = {\n\t\t\t\tid: this.id + '_store',\n\t\t\t\theight: 300,\n\t\t\t\tcontext: 'catalog-store',\n\t\t\t\ttargetNode: this.getNameInput(),\n\t\t\t\tenableSearch: false,\n\t\t\t\tmultiple: false,\n\t\t\t\tdropdownMode: true,\n\t\t\t\tsearchTabOptions: {\n\t\t\t\t\tstub: true,\n\t\t\t\t\tstubOptions: {\n\t\t\t\t\t\ttitle: Tag.message`${'CATALOG_STORE_SELECTOR_IS_EMPTY_TITLE'}`,\n\t\t\t\t\t\tsubtitle: Tag.message`${'CATALOG_STORE_SELECTOR_IS_EMPTY_SUBTITLE'}`,\n\t\t\t\t\t\tarrow: true\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tevents: {\n\t\t\t\t\t'Item:onSelect': this.onStoreSelect.bind(this),\n\t\t\t\t\t'onSearch': this.onSearch.bind(this),\n\t\t\t\t\t'Search:onItemCreateAsync': this.createStore.bind(this),\n\t\t\t\t},\n\t\t\t\tentities: [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'store',\n\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\tproductId: this.selector.getProductId(),\n\t\t\t\t\t\t},\n\t\t\t\t\t\tsearchFields: [\n\t\t\t\t\t\t\t{ name: 'subtitle', type: 'string', system: true, searchable: false },\n\t\t\t\t\t\t],\n\t\t\t\t\t\tdynamicLoad: true,\n\t\t\t\t\t\tdynamicSearch: true,\n\t\t\t\t\t}\n\t\t\t\t],\n\t\t\t\tsearchOptions: {\n\t\t\t\t\tallowCreateItem: true\n\t\t\t\t},\n\t\t\t};\n\n\t\t\treturn new Dialog(params);\n\t\t});\n\t}\n\n\thandleNameInputKeyDown(event: KeyboardEvent): void\n\t{\n\t\tconst dialog = this.getDialog();\n\t\tif (event.key === 'Enter' && dialog.getActiveTab() === dialog.getSearchTab())\n\t\t{\n\t\t\t// prevent a form submit\n\t\t\tevent.preventDefault();\n\n\t\t\tif ((Browser.isMac() && event.metaKey) || event.ctrlKey)\n\t\t\t{\n\t\t\t\tdialog.getSearchTab().getFooter().createItem();\n\t\t\t}\n\t\t}\n\t}\n\n\thandleIconsSwitchingOnNameInput(event: UIEvent): void\n\t{\n\t\tthis.toggleIcon(this.getArrowIcon(), 'none');\n\n\t\tif (Type.isStringFilled(event.target.value))\n\t\t{\n\t\t\tthis.toggleIcon(this.getClearIcon(), 'block');\n\t\t\tthis.toggleIcon(this.getSearchIcon(), 'none');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.toggleIcon(this.getClearIcon(), 'none');\n\t\t\tthis.toggleIcon(this.getSearchIcon(), 'block');\n\t\t}\n\t}\n\n\thandleClearIconClick(event: UIEvent)\n\t{\n\t\tthis.selector.onClear();\n\n\t\tevent.stopPropagation();\n\t\tevent.preventDefault();\n\t}\n\n\tfocusName()\n\t{\n\t\trequestAnimationFrame(() => this.getNameInput().focus());\n\t}\n\n\tsearchInDialog(searchQuery: string = '')\n\t{\n\t\tconst dialog = this.getDialog();\n\t\tif (dialog)\n\t\t{\n\t\t\tdialog.show();\n\t\t\tdialog.search(searchQuery);\n\t\t}\n\t}\n\n\thandleShowSearchDialog(event: UIEvent)\n\t{\n\t\tthis.searchInDialog(event.target.value);\n\t}\n\n\thandleNameInputBlur(event: UIEvent)\n\t{\n\t\t// timeout to toggle clear icon handler while cursor is inside of name input\n\t\tsetTimeout(() => {\n\t\t\tthis.toggleIcon(this.getClearIcon(), 'none');\n\n\t\t\tif (this.showDetailLink() && Type.isStringFilled(this.selector.getStoreTitle()))\n\t\t\t{\n\t\t\t\tthis.toggleIcon(this.getSearchIcon(), 'none');\n\t\t\t\tthis.toggleIcon(this.getArrowIcon(), 'block');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.toggleIcon(this.getArrowIcon(), 'none');\n\t\t\t\tthis.toggleIcon(this.getSearchIcon(), 'block');\n\t\t\t}\n\t\t}, 200);\n\t}\n\n\thandleSearchIconClick(event: UIEvent)\n\t{\n\t\tthis.searchInDialog();\n\t\tthis.focusName();\n\n\t\tevent.stopPropagation();\n\t\tevent.preventDefault();\n\t}\n\n\tonSearch(event)\n\t{\n\t\tconst { query } = event.getData();\n\t\tif (query === '' || query === this.selector.getStoreTitle())\n\t\t{\n\t\t\tevent.target?.searchTab?.getFooter()?.hide();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tevent.target?.searchTab?.getFooter()?.show();\n\t\t}\n\t}\n\n\tonStoreSelect(event)\n\t{\n\t\tconst item = event.getData().item;\n\t\titem.getDialog().getTargetNode().value = item.getTitle();\n\n\t\tif (this.selector)\n\t\t{\n\t\t\tthis.selector.onStoreSelect(item.getId(), item.getTitle());\n\t\t}\n\t\tthis.toggleIcon(this.getSearchIcon(), 'none');\n\t\tthis.selector.clearLayout();\n\t\tthis.selector.layout();\n\n\t\tthis.cache.delete('dialog');\n\t}\n\n\tcreateStore(event): Promise\n\t{\n\t\tconst {searchQuery} = event.getData();\n\t\tconst name = searchQuery.getQuery();\n\n\t\treturn new Promise(\n\t\t\t(resolve, reject) => {\n\t\t\t\tif (!Type.isStringFilled(name))\n\t\t\t\t{\n\t\t\t\t\treject();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst dialog: Dialog = event.getTarget();\n\t\t\t\tdialog.showLoader();\n\t\t\t\tajax.runAction(\n\t\t\t\t\t\t'catalog.storeSelector.createStore',\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tjson: {name}\n\t\t\t\t\t\t}\n\t\t\t\t\t)\n\t\t\t\t\t.then(response => {\n\t\t\t\t\t\tdialog.hideLoader();\n\t\t\t\t\t\tconst id = Text.toInteger(response.data.id);\n\t\t\t\t\t\tconst item = dialog.addItem({\n\t\t\t\t\t\t\tid,\n\t\t\t\t\t\t\tentityId: 'store',\n\t\t\t\t\t\t\ttitle: name,\n\t\t\t\t\t\t\ttabs: dialog.getRecentTab().getId(),\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tif (item)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\titem.select();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tdialog.hide();\n\t\t\t\t\t\tresolve();\n\t\t\t\t\t})\n\t\t\t\t\t.catch(() => reject())\n\t\t\t\t;\n\t\t\t});\n\t}\n\n\tgetPlaceholder(): string\n\t{\n\t\treturn Loc.getMessage('CATALOG_STORE_SELECTOR_BEFORE_SEARCH_TITLE');\n\t}\n}\n","import {Cache, Dom, Event, Extension, Loc, Tag, Text, Type} from 'main.core';\nimport 'ui.forms';\nimport 'ui.notification';\nimport {EventEmitter} from 'main.core.events';\nimport {StoreSearchInput} from \"./store-search-input\";\nimport './component.css';\nimport {ProductModel} from \"catalog.product-model\";\n\nconst instances = new Map();\n\nexport class StoreSelector extends EventEmitter\n{\n\tstatic MODE_VIEW = 'view';\n\tstatic MODE_EDIT = 'edit';\n\tstatic INPUT_FIELD_TITLE = 'STORE_TITLE';\n\tstatic INPUT_FIELD_ID = 'STORE_ID';\n\n\tmode: StoreSelector.MODE_EDIT | StoreSelector.MODE_VIEW = StoreSelector.MODE_EDIT;\n\tproductId: number = null;\n\tcache = new Cache.MemoryCache();\n\tsearchInput: ?StoreSearchInput;\n\n\t#storeInfo: Map = new Map();\n\n\tstatic getById(id: string): ?StoreSelector\n\t{\n\t\treturn instances.get(id) || null;\n\t}\n\n\tconstructor(id, options = {})\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Catalog.StoreSelector');\n\n\t\tthis.id = id || Text.getRandom();\n\t\toptions.inputFieldTitle = options.inputFieldTitle || StoreSelector.INPUT_FIELD_TITLE;\n\t\toptions.inputFieldId = options.inputFieldId || StoreSelector.INPUT_FIELD_ID;\n\t\tthis.options = options || {};\n\n\t\tthis.setMode(options.mode);\n\n\t\tif (options.model instanceof ProductModel && options.model.getField(options.inputFieldId) > 0)\n\t\t{\n\t\t\tthis.#storeInfo.set('id', options.model.getField(options.inputFieldId));\n\t\t\tconst name =\n\t\t\t\tType.isStringFilled(options.model.getField(options.inputFieldTitle))\n\t\t\t\t\t? options.model.getField(options.inputFieldTitle)\n\t\t\t\t\t: ''\n\t\t\t;\n\n\t\t\tthis.setProductId(options.model.getSkuId());\n\t\t\tthis.#storeInfo.set('title', name);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst settingsCollection = Extension.getSettings('catalog.store-selector');\n\n\t\t\tthis.#storeInfo.set('id', settingsCollection.get('defaultStoreId'));\n\t\t\tthis.#storeInfo.set('title', settingsCollection.get('defaultStoreName'));\n\t\t}\n\n\t\tthis.searchInput = new StoreSearchInput(this.id, {\n\t\t\tselector: this,\n\t\t\tinputName: this.options.inputFieldTitle,\n\t\t});\n\n\t\t// this.setDetailPath(this.getConfig('DETAIL_PATH'));\n\t\tthis.layout();\n\n\t\tinstances.set(this.id, this);\n\t}\n\n\tsetMode(mode: StoreSelector.MODE_VIEW | StoreSelector.MODE_EDIT): void\n\t{\n\t\tif (!Type.isNil(mode))\n\t\t{\n\t\t\tthis.mode = mode === StoreSelector.MODE_VIEW ? StoreSelector.MODE_VIEW : StoreSelector.MODE_EDIT;\n\t\t}\n\t}\n\n\tsetProductId(productId: number): void\n\t{\n\t\tproductId = Text.toNumber(productId);\n\t\tif (productId > 0)\n\t\t{\n\t\t\tthis.productId = productId;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.productId = null;\n\t\t}\n\n\t\tthis.searchInput?.clearDialogCache();\n\t}\n\n\tisViewMode(): boolean\n\t{\n\t\treturn this.mode === StoreSelector.MODE_VIEW;\n\t}\n\n\tisSaveable(): boolean\n\t{\n\t\treturn !this.isViewMode() && this.isSaveable();\n\t}\n\n\tgetId(): string\n\t{\n\t\treturn this.id;\n\t}\n\n\tgetProductId(): ?number\n\t{\n\t\treturn this.productId;\n\t}\n\n\tgetConfig(name, defaultValue)\n\t{\n\t\treturn BX.prop.get(this.options.config, name, defaultValue);\n\t}\n\n\tgetDetailPath(): string\n\t{\n\t\treturn this.getConfig('detailPath', '');\n\t}\n\n\tgetWrapper(): HTMLElement\n\t{\n\t\tif (!this.wrapper)\n\t\t{\n\t\t\tthis.wrapper = document.getElementById(this.id);\n\t\t}\n\n\t\treturn this.wrapper;\n\t}\n\n\trenderTo(node)\n\t{\n\t\tthis.clearLayout();\n\t\tthis.wrapper = node;\n\t\tthis.layout();\n\t}\n\n\tlayout()\n\t{\n\t\tconst wrapper = this.getWrapper();\n\t\tif (!wrapper)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.defineWrapperClass(wrapper);\n\t\tconst block = Tag.render`<div class=\"catalog-store-field-inner\"></div>`;\n\t\twrapper.appendChild(block);\n\t\tblock.appendChild(this.layoutNameBlock());\n\t}\n\n\tfocusName(): this\n\t{\n\t\tif (this.searchInput)\n\t\t{\n\t\t\tthis.searchInput.focusName();\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tonClear()\n\t{\n\t\tthis.clearState();\n\t\tthis.clearLayout();\n\t\tthis.layout();\n\t\tthis.searchInput.searchInDialog();\n\t\tthis.focusName();\n\n\t\tthis.emit('onClear', {\n\t\t\tselectorId: this.getId(),\n\t\t\trowId: this.getRowId()\n\t\t});\n\t}\n\n\tclearState(): void\n\t{\n\t\tthis.#storeInfo.clear();\n\t}\n\n\tclearLayout(): void\n\t{\n\t\tconst wrapper = this.getWrapper();\n\t\tif (wrapper)\n\t\t{\n\t\t\twrapper.innerHTML = '';\n\t\t}\n\t}\n\n\tunsubscribeEvents()\n\t{\n\t}\n\n\tdefineWrapperClass(wrapper)\n\t{\n\t\tif (this.isViewMode())\n\t\t{\n\t\t\tDom.addClass(wrapper, 'catalog-store-view');\n\t\t\tDom.removeClass(wrapper, 'catalog-store-edit');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.addClass(wrapper, 'catalog-store-edit');\n\t\t\tDom.removeClass(wrapper, 'catalog-store-view');\n\t\t}\n\t}\n\n\tgetViewHtml(): HTMLElement\n\t{\n\t\tconst storeTitle = Text.encode(this.getStoreTitle());\n\t\tconst titlePlaceholder = Loc.getMessage('CATALOG_STORE_SELECTOR_VIEW_NAME_TITLE');\n\n\t\tif (this.getDetailPath())\n\t\t{\n\t\t\treturn Tag.render`\n\t\t\t\t<a href=\"${this.getDetailPath()}\" title=\"${titlePlaceholder}\">${storeTitle}</a>\n\t\t\t`;\n\t\t}\n\n\t\treturn Tag.render`<span title=\"${titlePlaceholder}\">${storeTitle}</span>`;\n\n\t}\n\n\tlayoutNameBlock(): HTMLElement\n\t{\n\t\tconst block = Tag.render`<div class=\"catalog-store-field-input\"></div>`;\n\n\t\tif (this.isViewMode())\n\t\t{\n\t\t\tblock.appendChild(this.getViewHtml());\n\t\t}\n\t\telse\n\t\t{\n\t\t\tblock.appendChild(this.searchInput.layout());\n\t\t}\n\n\t\treturn block;\n\t}\n\n\tgetStoreTitle()\n\t{\n\t\treturn this.#storeInfo.get('title') || '';\n\t}\n\n\tgetStoreId()\n\t{\n\t\treturn this.#storeInfo.get('id') || '';\n\t}\n\n\tonStoreSelect(storeId, storeTitle)\n\t{\n\t\tif (storeTitle === '')\n\t\t{\n\t\t\tstoreTitle = Loc.getMessage('CATALOG_STORE_SELECTOR_EMPTY_STORE_TITLE');\n\t\t}\n\t\tthis.#storeInfo.set('id', storeId);\n\t\tthis.#storeInfo.set('title', storeTitle);\n\t\tthis.clearLayout();\n\t\tthis.layout();\n\n\t\tthis.emit('onChange', {\n\t\t\tselectorId: this.id,\n\t\t\trowId: this.getRowId(),\n\t\t\tfields: [\n\t\t\t\t{\n\t\t\t\t\tNAME: this.options.inputFieldId,\n\t\t\t\t\tVALUE: storeId,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tNAME: this.options.inputFieldTitle,\n\t\t\t\t\tVALUE: storeTitle,\n\t\t\t\t},\n\t\t\t],\n\t\t});\n\t}\n\n\tgetRowId(): string\n\t{\n\t\treturn this.getConfig('ROW_ID');\n\t}\n}\n"],"names":["StoreSearchInput","id","options","Cache","MemoryCache","Text","getRandom","selector","StoreSelector","Error","isEnabledDetailLink","inputName","icon","value","Type","isDomNode","Dom","style","cache","remember","Tag","render","getNameInput","getHiddenNameInput","encode","getStoreTitle","getPlaceholder","handleNameInputHiddenChange","bind","event","target","handleClearIconClick","getDetailPath","handleSearchIconClick","clearInputCache","block","appendChild","getSearchIcon","toggleIcon","getClearIcon","showDetailLink","isStringFilled","getArrowIcon","Event","handleNameInputClick","handleNameInput","handleNameInputBlur","handleNameInputKeyDown","getNameBlock","searchInDialog","handleIconsSwitchingOnNameInput","params","height","context","targetNode","enableSearch","multiple","dropdownMode","searchTabOptions","stub","stubOptions","title","message","subtitle","arrow","events","onStoreSelect","onSearch","createStore","entities","productId","getProductId","searchFields","name","type","system","searchable","dynamicLoad","dynamicSearch","searchOptions","allowCreateItem","Dialog","dialog","getDialog","key","getActiveTab","getSearchTab","preventDefault","Browser","isMac","metaKey","ctrlKey","getFooter","createItem","onClear","stopPropagation","requestAnimationFrame","focus","searchQuery","show","search","setTimeout","focusName","getData","query","searchTab","hide","item","getTargetNode","getTitle","getId","clearLayout","layout","getQuery","Promise","resolve","reject","getTarget","showLoader","ajax","runAction","json","then","response","hideLoader","toInteger","data","addItem","entityId","tabs","getRecentTab","select","Loc","getMessage","instances","Map","get","MODE_EDIT","setEventNamespace","inputFieldTitle","INPUT_FIELD_TITLE","inputFieldId","INPUT_FIELD_ID","setMode","mode","model","ProductModel","getField","set","setProductId","getSkuId","settingsCollection","Extension","getSettings","searchInput","isNil","MODE_VIEW","toNumber","clearDialogCache","isViewMode","isSaveable","defaultValue","BX","prop","config","getConfig","wrapper","document","getElementById","node","getWrapper","defineWrapperClass","layoutNameBlock","clearState","emit","selectorId","rowId","getRowId","clear","innerHTML","addClass","removeClass","storeTitle","titlePlaceholder","getViewHtml","storeId","fields","NAME","VALUE","EventEmitter"],"mappings":"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"}