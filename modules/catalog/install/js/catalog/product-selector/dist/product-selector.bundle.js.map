{"version":3,"file":"product-selector.bundle.js","sources":["../src/product-search-selector-footer.js","../src/product-creation-limited-footer.js","../src/selector-error-code.js","../src/product-search-input.js","../src/product-image-input.js","../src/barcode-search-selector-footer.js","../src/barcode-search-input.js","../src/product-selector.js"],"sourcesContent":["import {DefaultFooter, Dialog} from 'ui.entity-selector';\nimport {Dom, Loc, Tag, Type} from 'main.core';\nimport {BaseEvent} from \"main.core.events\";\nimport {Loader} from \"main.loader\";\nimport {ProductSelector} from \"catalog.product-selector\";\n\nexport default class ProductSearchSelectorFooter extends DefaultFooter\n{\n\tloader: Loader = null;\n\n\tconstructor(dialog: Dialog, options: { [option: string]: any })\n\t{\n\t\tsuper(dialog, options);\n\n\t\tthis.errorAdminHint = options.errorAdminHint || '';\n\t\tthis.getDialog().subscribe('onSearch', this.handleOnSearch.bind(this));\n\t}\n\n\tgetContent(): HTMLElement\n\t{\n\t\tlet phrase = '';\n\n\t\tconst isViewCreateButton = this.options.allowCreateItem === true || this.options.allowEditItem === false;\n\n\t\tif (this.isViewEditButton() && isViewCreateButton)\n\t\t{\n\t\t\tphrase = Tag.render`\n\t\t\t\t<div>${Loc.getMessage('CATALOG_SELECTOR_SEARCH_POPUP_FOOTER_1')}</div>\n\t\t\t`;\n\n\t\t\tconst createButton = phrase.querySelector('create-button');\n\t\t\tDom.replace(createButton, this.getLabelContainer());\n\n\t\t\tconst changeButton = phrase.querySelector('change-button');\n\t\t\tDom.replace(changeButton, this.getSaveContainer());\n\t\t}\n\t\telse if (this.isViewEditButton())\n\t\t{\n\t\t\tphrase = this.getSaveContainer();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tphrase = this.getLabelContainer();\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"ui-selector-search-footer-box\">\n\t\t\t\t${phrase}\n\t\t\t\t${this.getHintContainer()}\n\t\t\t\t${this.getLoaderContainer()}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tisViewEditButton(): boolean\n\t{\n\t\treturn this.options.allowEditItem === true;\n\t}\n\n\tgetLoader(): Loader\n\t{\n\t\tif (Type.isNil(this.loader))\n\t\t{\n\t\t\tthis.loader = new Loader({\n\t\t\t\ttarget: this.getLoaderContainer(),\n\t\t\t\tsize: 17,\n\t\t\t\tcolor: 'rgba(82, 92, 105, 0.9)'\n\t\t\t});\n\t\t}\n\n\t\treturn this.loader;\n\t}\n\n\tshowLoader(): void\n\t{\n\t\tvoid this.getLoader().show();\n\t}\n\n\thideLoader(): void\n\t{\n\t\tvoid this.getLoader().hide();\n\t}\n\n\tsetLabel(label: string)\n\t{\n\t\tif (Type.isString(label))\n\t\t{\n\t\t\tthis.getLabelContainer().textContent = label;\n\t\t}\n\t}\n\n\tgetLabelContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('label', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<span>\n\t\t\t\t\t<span onclick=\"${this.handleClick.bind(this)}\" class=\"ui-selector-footer-link  ui-selector-footer-link-add\">\n\t\t\t\t\t\t${\n\t\t\t\t\t\t\tthis.getOption('creationLabel', Loc.getMessage('CATALOG_SELECTOR_SEARCH_POPUP_FOOTER_CREATE'))\n\t\t\t\t\t\t}\n\t\t\t\t\t</span>\n\t\t\t\t\t${this.getQueryContainer()}\n\t\t\t\t</span>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetQueryContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('name-container', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<span class=\"ui-selector-search-footer-query\"></span>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetSaveContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('save-container', () => {\n\t\t\tconst className = `ui-selector-footer-link`;\n\n\t\t\tconst messageId =\n\t\t\t\t(this.options.inputName === ProductSelector.INPUT_FIELD_BARCODE)\n\t\t\t\t\t? 'CATALOG_SELECTOR_SEARCH_POPUP_FOOTER_BARCODE_CHANGE'\n\t\t\t\t\t: 'CATALOG_SELECTOR_SEARCH_POPUP_FOOTER_CHANGE'\n\t\t\t;\n\n\t\t\treturn Tag.render`\n\t\t\t<span class=\"${className}\" onclick=\"${this.onClickSaveChanges.bind(this)}\">\n\t\t\t\t${Loc.getMessage(messageId)}\n\t\t\t</span>\n\t\t`;\n\t\t});\n\t}\n\n\tgetLoaderContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('loader', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-selector-search-footer-loader\"></div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetHintContainer(): ?HTMLElement\n\t{\n\t\treturn this.cache.remember('hint', () => {\n\t\t\tlet message = null;\n\t\t\tif (!this.options.allowEditItem && !this.options.allowCreateItem)\n\t\t\t{\n\t\t\t\tmessage = Loc.getMessage('CATALOG_SELECTOR_SEARCH_POPUP_DISABLED_FOOTER_ALL_HINT', {\n\t\t\t\t\t'#ADMIN_HINT#': this.errorAdminHint\n\t\t\t\t});\n\t\t\t}\n\t\t\telse if (!this.options.allowEditItem)\n\t\t\t{\n\t\t\t\tmessage = Loc.getMessage('CATALOG_SELECTOR_SEARCH_POPUP_DISABLED_FOOTER_EDIT_HINT', {\n\t\t\t\t\t'#ADMIN_HINT#': this.errorAdminHint\n\t\t\t\t});\n\t\t\t}\n\t\t\telse if (!this.options.allowCreateItem)\n\t\t\t{\n\t\t\t\tmessage = Loc.getMessage('CATALOG_SELECTOR_SEARCH_POPUP_DISABLED_FOOTER_ADD_HINT', {\n\t\t\t\t\t'#ADMIN_HINT#': this.errorAdminHint\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (!message)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tconst hintNode = Tag.render`<span class=\"ui-btn ui-btn-icon-lock ui-btn-link\"></span>`;\n\t\t\thintNode.dataset.hint = message;\n\t\t\thintNode.dataset.hintNoIcon = true;\n\n\t\t\tBX.UI.Hint.initNode(hintNode);\n\n\t\t\treturn Tag.render`<div class=\"product-search-selector-disabled-footer-hint\">${hintNode}</div>`;\n\t\t});\n\t}\n\n\tonClickSaveChanges()\n\t{\n\t\tif (!this.options.allowEditItem)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst lastQuery = this.getDialog().getActiveTab().getLastSearchQuery();\n\t\tthis.getDialog().emit('ChangeItem:onClick', { query: lastQuery.query });\n\t\tthis.getDialog().clearSearch();\n\t\tthis.getDialog().hide();\n\t}\n\n\tcreateItem(): void\n\t{\n\t\tif (!this.options.allowCreateItem)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst tagSelector = this.getDialog().getTagSelector();\n\t\tif (tagSelector && tagSelector.isLocked())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst finalize = () => {\n\t\t\tthis.hideLoader();\n\t\t\tif (this.getDialog().getTagSelector())\n\t\t\t{\n\t\t\t\tthis.getDialog().getTagSelector().unlock();\n\t\t\t\tthis.getDialog().focusSearch();\n\t\t\t}\n\t\t};\n\n\t\tevent.preventDefault();\n\t\tthis.showLoader();\n\n\t\tif (tagSelector)\n\t\t{\n\t\t\ttagSelector.lock();\n\t\t}\n\n\t\tthis.getDialog()\n\t\t\t.emitAsync('Search:onItemCreateAsync', {\n\t\t\t\tsearchQuery: this.getDialog().getActiveTab().getLastSearchQuery()\n\t\t\t})\n\t\t\t.then(() => {\n\t\t\t\tthis.getTab().clearResults();\n\t\t\t\tthis.getDialog().clearSearch();\n\t\t\t\tif (this.getDialog().getActiveTab() === this.getTab())\n\t\t\t\t{\n\t\t\t\t\tthis.getDialog().selectFirstTab();\n\t\t\t\t}\n\n\t\t\t\tfinalize();\n\t\t\t})\n\t\t\t.catch(() => {\n\t\t\t\tfinalize();\n\t\t\t})\n\t\t;\n\t}\n\n\thandleClick(): void\n\t{\n\t\tthis.createItem();\n\t}\n\n\thandleOnSearch(event: BaseEvent): void\n\t{\n\t\tconst { query } = event.getData();\n\n\t\tif (this.options.currentValue === query || query === '')\n\t\t{\n\t\t\tthis.hide();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.show();\n\t\t}\n\n\t\tthis.getQueryContainer().textContent = \" \" + query;\n\t}\n}\n","import {DefaultFooter} from 'ui.entity-selector';\nimport {Event, Loc, Tag} from 'main.core';\nimport 'ui.info-helper';\n\nexport default class ProductCreationLimitedFooter extends DefaultFooter\n{\n\tgetContent(): HTMLElement\n\t{\n\t\tconst phrase = Tag.render`\n\t\t\t<div>${Loc.getMessage('CATALOG_SELECTOR_LIMITED_PRODUCT_CREATION')}</div>\n\t\t`;\n\n\t\tconst infoButton = Tag.render`\n\t\t\t<a class=\"ui-btn ui-btn-sm ui-btn-primary ui-btn-hover ui-btn-round\">\n\t\t\t\t${Loc.getMessage('CATALOG_SELECTOR_LICENSE_EXPLODE')}\n\t\t\t</a>\n\t\t`;\n\n\t\tEvent.bind(infoButton, 'click', () => {\n\t\t\tBX.UI.InfoHelper.show('limit_shop_products');\n\t\t});\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"ui-selector-search-footer-box\">\n\t\t\t\t<div class=\"ui-selector-search-footer-box\">\n\t\t\t\t\t<div class=\"tariff-lock\"></div>\n\t\t\t\t\t${phrase}\n\t\t\t\t</div>\n\t\t\t\t<div>\n\t\t\t\t\t${infoButton}\n\t\t\t\t</div>\t\t\t\t\n\t\t\t</div>\n\t\t`;\n\t}\n}","export class SelectorErrorCode\n{\n\tstatic NOT_SELECTED_PRODUCT: string = 'NOT_SELECTED_PRODUCT';\n\tstatic FAILED_PRODUCT: string = 'FAILED_PRODUCT';\n\n\tstatic getCodes(): Array<string>\n\t{\n\t\treturn [\n\t\t\tSelectorErrorCode.NOT_SELECTED_PRODUCT,\n\t\t\tSelectorErrorCode.FAILED_PRODUCT,\n\t\t]\n\t}\n}","import {ajax, Browser, Cache, Dom, Event, Extension, Loc, Runtime, Tag, Text, Type} from 'main.core';\nimport {Dialog, Item} from 'ui.entity-selector';\nimport './component.css';\nimport {EventEmitter} from 'main.core.events';\nimport {ProductModel} from 'catalog.product-model';\nimport {ProductSelector} from 'catalog.product-selector';\nimport ProductSearchSelectorFooter from './product-search-selector-footer';\nimport ProductCreationLimitedFooter from './product-creation-limited-footer';\nimport {SelectorErrorCode} from './selector-error-code';\nimport 'ui.notification';\n\nclass DialogMode\n{\n\tstatic SEARCHING: string = 'SEARCHING';\n\tstatic SHOW_PRODUCT_ITEM: string = 'SHOW_PRODUCT_ITEM';\n\tstatic SHOW_RECENT: string = 'SHOW_RECENT';\n}\n\nexport class ProductSearchInput\n{\n\tstatic SEARCH_TYPE_ID = 'product';\n\n\tmodel: ProductModel;\n\tselector: ProductSelector;\n\tcache = new Cache.MemoryCache();\n\n\tconstructor(id, options = {})\n\t{\n\t\tthis.id = id || Text.getRandom();\n\t\tthis.selector = options.selector;\n\t\tif (!(this.selector instanceof ProductSelector))\n\t\t{\n\t\t\tthrow new Error('Product selector instance not found.');\n\t\t}\n\n\t\tthis.model = options.model || {};\n\t\tthis.isEnabledSearch = options.isSearchEnabled;\n\t\tthis.isEnabledDetailLink = options.isEnabledDetailLink;\n\t\tthis.inputName = options.inputName || ProductSelector.INPUT_FIELD_NAME;\n\t\tthis.immutableFieldNames = [ProductSelector.INPUT_FIELD_BARCODE, ProductSelector.INPUT_FIELD_NAME];\n\t\tif (!this.immutableFieldNames.includes(this.inputName))\n\t\t{\n\t\t\tthis.immutableFieldNames.push(this.inputName);\n\t\t}\n\t\tthis.ajaxInProcess = false;\n\t\tthis.loadedSelectedItem = null;\n\n\t\tthis.handleSearchInput = Runtime.debounce(this.searchInDialog, 500, this);\n\t}\n\n\tdestroy()\n\t{\n\n\t}\n\n\tgetId(): string\n\t{\n\t\treturn this.id;\n\t}\n\n\tgetSelectorType(): string\n\t{\n\t\treturn ProductSelector.INPUT_FIELD_NAME;\n\t}\n\n\tgetField(fieldName): string\n\t{\n\t\treturn this.model.getField(fieldName);\n\t}\n\n\tgetValue(): string\n\t{\n\t\treturn this.getField(this.inputName);\n\t}\n\n\tgetFilledValue(): string\n\t{\n\t\treturn this.getNameInput().value || '';\n\t}\n\n\tisSearchEnabled(): boolean\n\t{\n\t\treturn this.isEnabledSearch;\n\t}\n\n\ttoggleIcon(icon, value)\n\t{\n\t\tif (Type.isDomNode(icon))\n\t\t{\n\t\t\tDom.style(icon, 'display', value);\n\t\t}\n\t}\n\n\tgetNameBlock(): HTMLElement\n\t{\n\t\treturn this.cache.remember('nameBlock', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-ctl ui-ctl-textbox ui-ctl-w100\">\n\t\t\t\t\t${this.getNameTag()}\n\t\t\t\t\t${this.getNameInput()}\n\t\t\t\t\t${this.getHiddenNameInput()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetNameTag(): ?HTMLElement\n\t{\n\t\tif (!this.model.isNew())\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"ui-ctl-tag\">${Loc.getMessage('CATALOG_SELECTOR_NEW_TAG_TITLE')}</div>\n\t\t`;\n\t}\n\n\tgetNameInput(): HTMLInputElement\n\t{\n\t\treturn this.cache.remember('nameInput', () => {\n\t\t\tconst input = Tag.render`\n\t\t\t\t<input type=\"text\"\n\t\t\t\t\tclass=\"ui-ctl-element ui-ctl-textbox\"\n\t\t\t\t\tautocomplete=\"off\"\n\t\t\t\t\tdata-name=\"${Text.encode(this.inputName)}\"\n\t\t\t\t\tvalue=\"${Text.encode(this.getValue())}\"\n\t\t\t\t\tplaceholder=\"${Text.encode(this.getPlaceholder())}\"\n\t\t\t\t\ttitle=\"${Text.encode(this.getValue())}\"\n\t\t\t\t\tonchange=\"${this.handleNameInputHiddenChange.bind(this)}\"\n\t\t\t\t>\n\t\t\t`;\n\n\t\t\tif (this.selector.getConfig('SELECTOR_INPUT_DISABLED', false))\n\t\t\t{\n\t\t\t\tDom.addClass(input, 'ui-ctl-disabled');\n\t\t\t\tinput.setAttribute('disabled', true);\n\t\t\t}\n\n\t\t\treturn input;\n\t\t});\n\t}\n\n\tgetHiddenNameInput(): HTMLInputElement\n\t{\n\t\treturn this.cache.remember('hiddenNameInput', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<input\n\t\t\t\t \ttype=\"hidden\"\n\t\t\t\t\tname=\"${Text.encode(this.inputName)}\"\n\t\t\t\t\tvalue=\"${Text.encode(this.getValue())}\"\n\t\t\t\t>\n\t\t\t`;\n\t\t});\n\t}\n\n\thandleNameInputHiddenChange(event: UIEvent)\n\t{\n\t\tthis.getHiddenNameInput().value = event.target.value;\n\t}\n\n\tgetClearIcon(): HTMLElement\n\t{\n\t\treturn this.cache.remember('closeIcon', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<button\n\t\t\t\t\tclass=\"ui-ctl-after ui-ctl-icon-clear\"\n\t\t\t\t\tonclick=\"${this.handleClearIconClick.bind(this)}\"\n\t\t\t\t></button>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetArrowIcon(): HTMLElement\n\t{\n\t\treturn this.cache.remember('arrowIcon', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<a\n\t\t\t\t\thref=\"${Text.encode(this.model.getDetailPath())}\"\n\t\t\t\t\ttarget=\"_blank\"\n\t\t\t\t\tclass=\"ui-ctl-after ui-ctl-icon-forward\"\n\t\t\t\t>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetSearchIcon(): HTMLElement\n\t{\n\t\treturn this.cache.remember('searchIcon', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<button\n\t\t\t\t\tclass=\"ui-ctl-after ui-ctl-icon-search\"\n\t\t\t\t\tonclick=\"${this.handleSearchIconClick.bind(this)}\"\n\t\t\t\t></button>\n\t\t\t`;\n\t\t});\n\t}\n\n\tlayout(): HTMLElement\n\t{\n\t\tthis.clearInputCache();\n\t\tconst block = Tag.render`<div class=\"ui-ctl ui-ctl-w100 ui-ctl-after-icon\"></div>`;\n\n\t\tthis.toggleIcon(this.getClearIcon(), 'none');\n\t\tDom.append(this.getClearIcon(), block);\n\n\t\tif (this.isSearchEnabled())\n\t\t{\n\t\t\tif (this.selector.isProductSearchEnabled())\n\t\t\t{\n\t\t\t\tthis.initHasDialogItems();\n\t\t\t}\n\n\t\t\tthis.toggleIcon(\n\t\t\t\tthis.getSearchIcon(),\n\t\t\t\tType.isStringFilled(this.getFilledValue()) ? 'none' : 'block'\n\t\t\t);\n\t\t\tDom.append(this.getSearchIcon(), block);\n\n\t\t\tEvent.bind(this.getNameInput(), 'click', this.handleClickNameInput.bind(this));\n\t\t\tEvent.bind(this.getNameInput(), 'input', this.handleSearchInput);\n\t\t\tEvent.bind(this.getNameInput(), 'blur', this.handleNameInputBlur.bind(this));\n\t\t\tEvent.bind(this.getNameInput(), 'keydown', this.handleNameInputKeyDown.bind(this));\n\n\t\t\tthis.dialogMode =\n\t\t\t\tthis.model.isCatalogExisted()\n\t\t\t\t\t? DialogMode.SHOW_PRODUCT_ITEM\n\t\t\t\t\t: DialogMode.SHOW_RECENT\n\t\t\t;\n\t\t}\n\n\t\tif (this.showDetailLink() && Type.isStringFilled(this.getValue()))\n\t\t{\n\t\t\tthis.toggleIcon(this.getClearIcon(), 'none');\n\t\t\tthis.toggleIcon(this.getSearchIcon(), 'none');\n\t\t\tthis.toggleIcon(this.getArrowIcon(), 'block');\n\t\t\tDom.append(this.getArrowIcon(), block);\n\t\t}\n\n\t\tEvent.bind(this.getNameInput(), 'click', this.handleIconsSwitchingOnNameInput.bind(this));\n\t\tEvent.bind(this.getNameInput(), 'input', this.handleIconsSwitchingOnNameInput.bind(this));\n\t\tEvent.bind(this.getNameInput(), 'change', this.handleNameInputChange.bind(this));\n\n\t\tDom.append(this.getNameBlock(), block);\n\t\treturn block;\n\t}\n\n\tshowDetailLink(): boolean\n\t{\n\t\treturn this.isEnabledDetailLink;\n\t}\n\n\tgetDialog(): ?Dialog\n\t{\n\t\treturn this.cache.remember('dialog', () => {\n\t\t\tconst searchTypeId = ProductSearchInput.SEARCH_TYPE_ID ;\n\t\t\tconst entity = {\n\t\t\t\tid: searchTypeId,\n\t\t\t\toptions: {\n\t\t\t\t\tiblockId: this.model.getIblockId(),\n\t\t\t\t\tbasePriceId: this.model.getBasePriceId(),\n\t\t\t\t\tcurrency: this.model.getCurrency(),\n\t\t\t\t},\n\t\t\t\tdynamicLoad: true,\n\t\t\t\tdynamicSearch: true,\n\t\t\t};\n\t\t\tconst restrictedProductTypes = this.selector.getConfig('RESTRICTED_PRODUCT_TYPES', null);\n\t\t\tif (!Type.isNil(restrictedProductTypes))\n\t\t\t{\n\t\t\t\tentity.options.restrictedProductTypes = restrictedProductTypes;\n\t\t\t}\n\n\t\t\tconst params = {\n\t\t\t\tid: this.id + '_' + searchTypeId,\n\t\t\t\theight: 300,\n\t\t\t\twidth: Math.max(this.getNameInput()?.offsetWidth, 565),\n\t\t\t\tcontext: 'catalog-products',\n\t\t\t\ttargetNode: this.getNameInput(),\n\t\t\t\tenableSearch: false,\n\t\t\t\tmultiple: false,\n\t\t\t\tdropdownMode: true,\n\t\t\t\tsearchTabOptions: {\n\t\t\t\t\tstub: true,\n\t\t\t\t\tstubOptions: {\n\t\t\t\t\t\ttitle: Tag.message`${'CATALOG_SELECTOR_IS_EMPTY_TITLE'}`,\n\t\t\t\t\t\tsubtitle:\n\t\t\t\t\t\t\tthis.isAllowedCreateProduct()\n\t\t\t\t\t\t\t\t? Tag.message`${'CATALOG_SELECTOR_IS_EMPTY_SUBTITLE'}`\n\t\t\t\t\t\t\t\t: ''\n\t\t\t\t\t\t,\n\t\t\t\t\t\tarrow: true\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tevents: {\n\t\t\t\t\t'Item:onSelect': this.onProductSelect.bind(this),\n\t\t\t\t\t'Search:onItemCreateAsync': this.createProduct.bind(this),\n\t\t\t\t\t'ChangeItem:onClick': this.showChangeNotification.bind(this),\n\t\t\t\t},\n\t\t\t\tentities: [entity]\n\t\t\t};\n\n\t\t\tconst settingsCollection = Extension.getSettings('catalog.product-selector');\n\t\t\tif (Type.isObject(settingsCollection.get('limitInfo')))\n\t\t\t{\n\t\t\t\tparams.footer = ProductCreationLimitedFooter;\n\t\t\t}\n\t\t\telse if (this.model && this.model.isCatalogExisted())\n\t\t\t{\n\t\t\t\tparams.footer = ProductSearchSelectorFooter;\n\t\t\t\tparams.footerOptions = {\n\t\t\t\t\tinputName: this.inputName,\n\t\t\t\t\tallowEditItem: this.isAllowedEditProduct(),\n\t\t\t\t\tallowCreateItem: this.isAllowedCreateProduct(),\n\t\t\t\t\terrorAdminHint: settingsCollection.get('errorAdminHint'),\n\t\t\t\t\tcreationLabel: Loc.getMessage('CATALOG_SELECTOR_SEARCH_POPUP_FOOTER_CREATE'),\n\t\t\t\t\tcurrentValue: this.getValue(),\n\t\t\t\t};\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tparams.searchOptions = { allowCreateItem: this.isAllowedCreateProduct() };\n\t\t\t}\n\n\t\t\treturn new Dialog(params);\n\t\t});\n\t}\n\n\tinitHasDialogItems()\n\t{\n\t\tif (!Type.isNil(this.selector.getConfig('EXIST_DIALOG_ITEMS')))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this.selector.getModel().isEmpty())\n\t\t{\n\t\t\tthis.selector.setConfig('EXIST_DIALOG_ITEMS', true);\n\t\t\treturn;\n\t\t}\n\n\t\t// is null, that not send ajax\n\t\tthis.selector.setConfig('EXIST_DIALOG_ITEMS', false);\n\n\t\tconst dialog = this.getDialog();\n\t\tif (dialog.hasDynamicLoad())\n\t\t{\n\t\t\tthis.#loadPreselectedItems();\n\t\t\tdialog.subscribeOnce('onLoad', () => {\n\t\t\t\tif (dialog.getPreselectedItems().length > 1)\n\t\t\t\t{\n\t\t\t\t\tthis.selector.setConfig('EXIST_DIALOG_ITEMS', true);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.selector.setConfig('EXIST_DIALOG_ITEMS', true);\n\t\t}\n\t}\n\n\tisAllowedCreateProduct(): boolean\n\t{\n\t\treturn this.selector.getConfig('IS_ALLOWED_CREATION_PRODUCT', true) && this.selector.checkProductAddRights();\n\t}\n\n\tisAllowedEditProduct(): boolean\n\t{\n\t\treturn this.selector.checkProductEditRights();\n\t}\n\n\thandleNameInputKeyDown(event: KeyboardEvent): void\n\t{\n\t\tconst dialog = this.getDialog();\n\t\tif (event.key === 'Enter' && dialog.getActiveTab() === dialog.getSearchTab())\n\t\t{\n\t\t\t// prevent a form submit\n\t\t\tevent.stopPropagation();\n\t\t\tevent.preventDefault();\n\n\t\t\tif ((Browser.isMac() && event.metaKey) || event.ctrlKey)\n\t\t\t{\n\t\t\t\tdialog.getSearchTab().getFooter().createItem();\n\t\t\t}\n\t\t}\n\t}\n\n\thandleIconsSwitchingOnNameInput(event: UIEvent): void\n\t{\n\t\tthis.toggleIcon(this.getArrowIcon(), 'none');\n\n\t\tif (Type.isStringFilled(event.target.value))\n\t\t{\n\t\t\tthis.toggleIcon(this.getClearIcon(), 'block');\n\t\t\tthis.toggleIcon(this.getSearchIcon(), 'none');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.toggleIcon(this.getClearIcon(), 'none');\n\t\t\tif (this.isSearchEnabled())\n\t\t\t{\n\t\t\t\tthis.toggleIcon(this.getSearchIcon(), 'block');\n\t\t\t}\n\t\t}\n\t}\n\n\tclearInputCache()\n\t{\n\t\tthis.cache.delete('dialog');\n\t\tthis.cache.delete('nameBlock');\n\t\tthis.cache.delete('nameInput');\n\t\tthis.cache.delete('hiddenNameInput');\n\t}\n\n\thandleClearIconClick(event: UIEvent)\n\t{\n\t\tthis.selector.emit('onBeforeClear', {\n\t\t\tselectorId: this.selector.getId(),\n\t\t\trowId: this.selector.getRowId()\n\t\t});\n\n\t\tthis.loadedSelectedItem = null;\n\t\tif (this.selector.isProductSearchEnabled() && !this.model.isEmpty())\n\t\t{\n\t\t\tthis.selector.clearState();\n\t\t\tthis.selector.clearLayout();\n\t\t\tthis.selector.layout();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst newValue = '';\n\t\t\tthis.toggleIcon(this.getClearIcon(), 'none');\n\t\t\tthis.onChangeValue(newValue);\n\t\t}\n\n\t\tthis.selector.focusName();\n\n\t\tthis.selector.emit('onClear', {\n\t\t\tselectorId: this.selector.getId(),\n\t\t\trowId: this.selector.getRowId()\n\t\t});\n\n\t\tevent.stopPropagation();\n\t\tevent.preventDefault();\n\t}\n\n\thandleNameInputChange(event: UIEvent)\n\t{\n\t\tconst value = event.target.value;\n\t\tthis.onChangeValue(value);\n\t}\n\n\tonChangeValue(value: string)\n\t{\n\t\tconst fields = {};\n\t\tthis.getNameInput().title = value;\n\t\tthis.getNameInput().value = value;\n\t\tfields[this.inputName] = value;\n\t\tEventEmitter.emit('ProductSelector::onNameChange', {\n\t\t\trowId: this.selector.getRowId(),\n\t\t\tfields\n\t\t});\n\n\t\tif (!this.selector.isEnabledAutosave())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.selector.getModel().setFields(fields);\n\t\tthis.selector.getModel().save().then(() => {\n\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\tid: 'saving_field_notify_name',\n\t\t\t\tcloseButton: false,\n\t\t\t\tcontent: Tag.render`<div>${Loc.getMessage('CATALOG_SELECTOR_SAVING_NOTIFICATION_NAME')}</div>`,\n\t\t\t\tautoHide: true,\n\t\t\t});\n\t\t});\n\t}\n\n\tfocusName()\n\t{\n\t\trequestAnimationFrame(() => this.getNameInput().focus());\n\t}\n\n\tsearchInDialog(): void\n\t{\n\t\tconst searchQuery = this.getFilledValue().trim();\n\t\tif (searchQuery === '')\n\t\t{\n\t\t\tif (this.isHasDialogItems === false)\n\t\t\t{\n\t\t\t\tthis.getDialog().hide();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.loadedSelectedItem = null;\n\t\t\tthis.#showPreselectedItems()\n\t\t\treturn;\n\t\t}\n\n\t\tthis.dialogMode = DialogMode.SEARCHING;\n\t\tthis.#searchItem(searchQuery);\n\t\tthis.isSearchingInProcess = true;\n\t}\n\n\t#showSelectedItem()\n\t{\n\t\tif (!this.selector.isProductSearchEnabled())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst dialog = this.getDialog();\n\t\tdialog.removeItems();\n\n\t\tnew Promise((resolve) => {\n\t\t\tif (!Type.isNil(this.loadedSelectedItem))\n\t\t\t{\n\t\t\t\tresolve();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tdialog.showLoader();\n\t\t\tajax.runAction(\n\t\t\t\t'catalog.productSelector.getSkuSelectorItem',\n\t\t\t\t{\n\t\t\t\t\tjson: {\n\t\t\t\t\t\tid: this.selector.getModel().getSkuId(),\n\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\tiblockId: this.model.getIblockId(),\n\t\t\t\t\t\t\tbasePriceId: this.model.getBasePriceId(),\n\t\t\t\t\t\t\tcurrency: this.model.getCurrency(),\n\t\t\t\t\t\t},\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t)\n\t\t\t\t.then((response) => {\n\t\t\t\t\tdialog.hideLoader();\n\t\t\t\t\tthis.loadedSelectedItem = null;\n\t\t\t\t\tif (Type.isObject(response.data) && !dialog.isLoading())\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.loadedSelectedItem = dialog.addItem(response.data);\n\t\t\t\t\t}\n\t\t\t\t\tresolve();\n\t\t\t\t});\n\t\t})\n\t\t\t.then(() => {\n\t\t\t\tif (!Type.isNil(this.loadedSelectedItem))\n\t\t\t\t{\n\t\t\t\t\tdialog.setPreselectedItems([this.selector.getModel().getSkuId()]);\n\t\t\t\t\tdialog.getRecentTab().getRootNode().addItem(this.loadedSelectedItem);\n\t\t\t\t\tdialog.selectFirstTab();\n\t\t\t\t\tdialog.getFooter()?.hide();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.searchInDialog();\n\t\t\t\t}\n\t\t\t});\n\n\t\tdialog.getPopup().show();\n\t\tdialog.getFooter()?.hide();\n\t}\n\n\t#loadPreselectedItems()\n\t{\n\t\tconst dialog = this.getDialog();\n\t\tif (dialog.isLoading())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.loadedSelectedItem)\n\t\t{\n\t\t\tdialog.removeItems();\n\t\t\tdialog.loadState = 'UNSENT';\n\t\t\tthis.loadedSelectedItem = null;\n\t\t}\n\n\t\tdialog.load();\n\t}\n\n\t#showPreselectedItems()\n\t{\n\t\tif (!this.selector.isProductSearchEnabled())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.dialogMode = DialogMode.SHOW_RECENT;\n\t\tconst dialog = this.getDialog();\n\t\tthis.#loadPreselectedItems();\n\n\t\tdialog.selectFirstTab();\n\t\tdialog.getFooter()?.hide();\n\t\tdialog.show();\n\t}\n\n\t#searchItem(searchQuery: string = '')\n\t{\n\t\tif (!this.selector.isProductSearchEnabled())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst dialog = this.getDialog();\n\t\tdialog.getPopup().show();\n\t\tdialog.search(searchQuery);\n\t}\n\n\thandleClickNameInput(): void\n\t{\n\t\tconst dialog = this.getDialog();\n\n\t\tif (\n\t\t\tdialog.isOpen()\n\t\t\t|| (this.getFilledValue() === '' && this.isHasDialogItems === false)\n\t\t)\n\t\t{\n\t\t\tdialog.hide();\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.showItems();\n\t}\n\n\tshowItems()\n\t{\n\t\tif (this.getFilledValue() === '')\n\t\t{\n\t\t\tthis.#showPreselectedItems();\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this.model.isCatalogExisted() || this.dialogMode !== DialogMode.SHOW_PRODUCT_ITEM)\n\t\t{\n\t\t\tthis.searchInDialog();\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#showSelectedItem();\n\t}\n\n\thandleNameInputBlur(event: UIEvent)\n\t{\n\t\t// timeout to toggle clear icon handler while cursor is inside of name input\n\t\tsetTimeout(() => {\n\t\t\tthis.toggleIcon(this.getClearIcon(), 'none');\n\n\t\t\tif (this.showDetailLink() && Type.isStringFilled(this.getValue()))\n\t\t\t{\n\t\t\t\tif (this.isSearchEnabled())\n\t\t\t\t{\n\t\t\t\t\tthis.toggleIcon(this.getSearchIcon(), 'none');\n\t\t\t\t}\n\t\t\t\tthis.toggleIcon(this.getArrowIcon(), 'block');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.toggleIcon(this.getArrowIcon(), 'none');\n\t\t\t\tif (this.isSearchEnabled())\n\t\t\t\t{\n\t\t\t\t\tthis.toggleIcon(\n\t\t\t\t\t\tthis.getSearchIcon(),\n\t\t\t\t\t\tType.isStringFilled(this.getFilledValue()) ? 'none' : 'block'\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t}, 200);\n\n\t\tif (this.isSearchEnabled() && this.selector.isEnabledEmptyProductError())\n\t\t{\n\t\t\tsetTimeout(() => {\n\t\t\t\tif (\n\t\t\t\t\t!this.selector.inProcess()\n\t\t\t\t\t&& (\n\t\t\t\t\t\tthis.model.isEmpty()\n\t\t\t\t\t\t|| !Type.isStringFilled(this.getFilledValue())\n\t\t\t\t\t)\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tthis.model.getErrorCollection().setError(\n\t\t\t\t\t\tSelectorErrorCode.NOT_SELECTED_PRODUCT,\n\t\t\t\t\t\tthis.selector.getEmptySelectErrorMessage()\n\t\t\t\t\t);\n\n\t\t\t\t\tthis.selector.layoutErrors();\n\t\t\t\t}\n\t\t\t}, 200);\n\t\t}\n\t}\n\n\thandleSearchIconClick(event: UIEvent)\n\t{\n\t\tthis.searchInDialog();\n\t\tthis.focusName();\n\n\t\tevent.stopPropagation();\n\t\tevent.preventDefault();\n\t}\n\n\tgetImmutableFieldNames(): []\n\t{\n\t\treturn this.immutableFieldNames;\n\t}\n\n\tsetInputValueOnProductSelect(item: Item)\n\t{\n\t\titem.getDialog().getTargetNode().value = item.getTitle()\n\t}\n\n\tonProductSelect(event)\n\t{\n\t\tconst item = event.getData().item;\n\t\tthis.setInputValueOnProductSelect(item);\n\n\t\tthis.toggleIcon(this.getSearchIcon(), 'none');\n\t\tthis.clearErrors();\n\t\tif (this.selector)\n\t\t{\n\t\t\tconst isNew = item.getCustomData().get('isNew');\n\t\t\tconst immutableFields = [];\n\t\t\tthis.getImmutableFieldNames().forEach((key) => {\n\t\t\t\tif (!Type.isNil(item.getCustomData().get(key)))\n\t\t\t\t{\n\t\t\t\t\tthis.model.setField(key, item.getCustomData().get(key));\n\t\t\t\t\timmutableFields.push(key);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.selector.onProductSelect(\n\t\t\t\titem.getId(),\n\t\t\t\t\t{\n\t\t\t\t\t\tisNew,\n\t\t\t\t\t\timmutableFields,\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tthis.selector.clearLayout();\n\t\t\tthis.selector.layout();\n\t\t}\n\n\t\tthis.dialogMode = DialogMode.SHOW_PRODUCT_ITEM;\n\t\tthis.loadedSelectedItem = item;\n\t\tthis.cache.delete('dialog');\n\t}\n\n\tclearErrors()\n\t{\n\t\tconst errors = this.model.getErrorCollection().getErrors();\n\t\tfor (const code in errors)\n\t\t{\n\t\t\tif (ProductSelector.ErrorCodes.getCodes().includes(code))\n\t\t\t{\n\t\t\t\tthis.model.getErrorCollection().removeError(code);\n\t\t\t}\n\t\t}\n\t}\n\n\tcreateProductModelFromSearchQuery(searchQuery: string): ProductModel\n\t{\n\t\tconst fields = {...this.selector.getModel().getFields()};\n\t\tfields[this.inputName] = searchQuery;\n\n\t\treturn new ProductModel({\n\t\t\tisSimpleModel: true,\n\t\t\tisNew: true,\n\t\t\tcurrency: this.selector.options.currency,\n\t\t\tiblockId: this.selector.getModel().getIblockId(),\n\t\t\tbasePriceId: this.selector.getModel().getBasePriceId(),\n\t\t\tfields\n\t\t})\n\t}\n\n\tcreateProduct(event): ?Promise\n\t{\n\t\tif (this.ajaxInProcess)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.ajaxInProcess = true;\n\t\tconst dialog: Dialog = event.getTarget();\n\t\tconst {searchQuery} = event.getData();\n\t\tconst newProduct = this.createProductModelFromSearchQuery(searchQuery.getQuery());\n\n\t\tEventEmitter.emit(this.selector, 'onBeforeCreate', {model: newProduct});\n\n\t\treturn new Promise(\n\t\t\t(resolve, reject) => {\n\t\t\t\tif (!this.checkCreationModel(newProduct))\n\t\t\t\t{\n\t\t\t\t\tthis.ajaxInProcess = false;\n\t\t\t\t\tdialog.hide();\n\t\t\t\t\treject();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tdialog.showLoader();\n\t\t\t\tnewProduct.save()\n\t\t\t\t\t.then(response => {\n\t\t\t\t\t\tdialog.hideLoader();\n\t\t\t\t\t\tconst id = Text.toInteger(response.data.id);\n\t\t\t\t\t\tconst item = dialog.addItem({\n\t\t\t\t\t\t\tid,\n\t\t\t\t\t\t\tentityId: ProductSearchInput.SEARCH_TYPE_ID,\n\t\t\t\t\t\t\ttitle: searchQuery.getQuery(),\n\t\t\t\t\t\t\ttabs: dialog.getRecentTab().getId(),\n\t\t\t\t\t\t\tcustomData: {\n\t\t\t\t\t\t\t\tisNew: true,\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tthis.selector.getModel().setOption('isSimpleModel', false);\n\t\t\t\t\t\tthis.selector.getModel().setOption('isNew', true);\n\n\t\t\t\t\t\tthis.getImmutableFieldNames().forEach((name) => {\n\t\t\t\t\t\t\tthis.selector.getModel().setField(name, newProduct.getField(name));\n\t\t\t\t\t\t\tthis.selector.getModel().setOption(name, newProduct.getField(name));\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tif (item)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\titem.select();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tdialog.hide();\n\t\t\t\t\t\tthis.cache.delete('dialog');\n\t\t\t\t\t\tthis.ajaxInProcess = false;\n\t\t\t\t\t\tthis.isHasDialogItems = true;\n\t\t\t\t\t\tresolve();\n\t\t\t\t\t})\n\t\t\t\t\t.catch((errorResponse) => {\n\t\t\t\t\t\tdialog.hideLoader();\n\t\t\t\t\t\terrorResponse.errors.forEach((error) => {\n\t\t\t\t\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\t\t\t\t\tcloseButton: true,\n\t\t\t\t\t\t\t\tcontent: Tag.render`<div>${error.message}</div>`,\n\t\t\t\t\t\t\t\tautoHide: true,\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tthis.ajaxInProcess = false;\n\t\t\t\t\t\treject();\n\t\t\t\t\t});\n\t\t\t});\n\t}\n\n\tcheckCreationModel(creationModel: ProductModel): boolean\n\t{\n\t\treturn true;\n\t}\n\n\tshowChangeNotification(event): void\n\t{\n\t\tconst {query} = event.getData();\n\t\tconst options = {\n\t\t\ttitle: Loc.getMessage('CATALOG_SELECTOR_SAVING_NOTIFICATION_' + this.selector.getType()),\n\t\t\tevents: {\n\t\t\t\tonSave: () => {\n\t\t\t\t\tif (this.selector)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.selector.getModel().setField(this.inputName, query);\n\t\t\t\t\t\tthis.selector.getModel().save([this.inputName])\n\t\t\t\t\t\t\t.catch((errorResponse) => {\n\t\t\t\t\t\t\t\terrorResponse.errors.forEach((error) => {\n\t\t\t\t\t\t\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\t\t\t\t\t\t\tcloseButton: true,\n\t\t\t\t\t\t\t\t\t\tcontent: Tag.render`<div>${error.message}</div>`,\n\t\t\t\t\t\t\t\t\t\tautoHide: true,\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t};\n\n\t\tif (this.selector.getConfig('ROLLBACK_INPUT_AFTER_CANCEL', false))\n\t\t{\n\t\t\toptions.declineCancelTitle = Loc.getMessage('CATALOG_SELECTOR_SAVING_NOTIFICATION_CANCEL_TITLE');\n\t\t\toptions.events.onCancel = () => {\n\t\t\t\tthis.selector.clearLayout();\n\t\t\t\tthis.selector.layout();\n\t\t\t};\n\t\t}\n\n\t\tthis.selector.getModel().showSaveNotifier(\n\t\t\t'nameChanger_' + this.selector.getId(),\n\t\t\toptions\n\t\t);\n\t}\n\n\tgetPlaceholder(): string\n\t{\n\t\treturn (\n\t\t\tthis.isSearchEnabled() && this.model.isEmpty()\n\t\t\t\t? Loc.getMessage('CATALOG_SELECTOR_BEFORE_SEARCH_TITLE')\n\t\t\t\t: Loc.getMessage('CATALOG_SELECTOR_VIEW_NAME_TITLE')\n\t\t);\n\t}\n\n\tremoveSpotlight()\n\t{\n\t}\n\n\tremoveQrAuth()\n\t{\n\t}\n}\n","import {Runtime, Tag, Text, Type, Dom} from 'main.core';\nimport './component.css';\nimport {ProductSelector} from 'catalog.product-selector';\n\nexport class ProductImageInput\n{\n\tconstructor(id, options = {})\n\t{\n\t\tthis.id = id || Text.getRandom();\n\t\tthis.selector = options.selector || null;\n\t\tif (!(this.selector instanceof ProductSelector))\n\t\t{\n\t\t\tthrow new Error('Product selector instance not found.');\n\t\t}\n\n\t\tthis.config = options.config || {};\n\n\t\tif (!Type.isStringFilled(this.selector.getModel()?.getImageCollection().getEditInput()))\n\t\t{\n\t\t\tthis.restoreDefaultInputHtml();\n\t\t}\n\n\t\tthis.enableSaving = options.enableSaving;\n\n\t\tthis.uploaderFieldMap = {};\n\t}\n\n\tgetId()\n\t{\n\t\treturn this.id;\n\t}\n\n\tsetId(id)\n\t{\n\t\tthis.id = id;\n\t}\n\n\tsetView(html): void\n\t{\n\t\tthis.selector.getModel()?.getImageCollection().setPreview(html);\n\t}\n\n\tsetInputHtml(html): void\n\t{\n\t\tthis.selector.getModel()?.getImageCollection().setEditInput(html);\n\t}\n\n\trestoreDefaultInputHtml(): void\n\t{\n\t\tconst defaultInput = `\n\t\t\t<div class='ui-image-input-container ui-image-input-img--disabled'>\n\t\t\t\t<div class='adm-fileinput-wrapper '>\n\t\t\t\t\t<div class='adm-fileinput-area mode-pict adm-fileinput-drag-area'></div>\n\t\t\t\t</div>\n\t\t\t</div>\n`\t\t;\n\n\t\tthis.selector.getModel()?.getImageCollection().setEditInput(defaultInput);\n\t\tthis.selector.getModel()?.getImageCollection().setPreview(defaultInput);\n\t}\n\n\tisViewMode(): boolean\n\t{\n\t\treturn this.selector && (this.selector.isViewMode() || !this.selector.model.isSaveable());\n\t}\n\n\tisEnabledLiveSaving(): boolean\n\t{\n\t\treturn this.enableSaving;\n\t}\n\n\tlayout(): HTMLElement\n\t{\n\t\tconst imageContainer = Tag.render`<div></div>`;\n\t\tconst html =\n\t\t\tthis.isViewMode()\n\t\t\t\t? this.selector.getModel()?.getImageCollection()?.getPreview()\n\t\t\t\t: this.selector.getModel()?.getImageCollection()?.getEditInput()\n\t\t;\n\n\t\tRuntime.html(imageContainer, html);\n\n\t\treturn imageContainer;\n\t}\n}","import {Loc, Tag, Dom, Type} from 'main.core';\nimport {BaseEvent} from \"main.core.events\";\nimport ProductSearchSelectorFooter from \"./product-search-selector-footer\";\n\nexport class BarcodeSearchSelectorFooter extends ProductSearchSelectorFooter\n{\n\tconstructor(id, options = {})\n\t{\n\t\tsuper(id, options);\n\t\tthis.isEmptyBarcode = options.isEmptyBarcode;\n\t\tthis.getDialog().subscribe('SearchTab:onLoad', this.handleOnSearchLoad.bind(this));\n\t}\n\n\tgetContent(): HTMLElement\n\t{\n\t\tthis.barcodeContent = super.getContent();\n\t\tthis.scannerContent = this.getScannerContent();\n\t\tDom.style(this.barcodeContent, 'display', 'none');\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"catalog-footers-container\">\n\t\t\t\t${this.barcodeContent}\n\t\t\t\t${this.scannerContent}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tisViewEditButton(): boolean\n\t{\n\t\treturn !this.isEmptyBarcode && super.isViewEditButton();\n\t}\n\n\tgetScannerContent(): HTMLElement\n\t{\n\t\tconst phrase = Tag.render`\n\t\t\t<div>${Loc.getMessage('CATALOG_SELECTOR_SEARCH_POPUP_FOOTER_BARCODE')}</div>\n\t\t`;\n\n\t\tconst createButton = phrase.querySelector('create-button');\n\n\t\tDom.replace(createButton, this.getScannerLabelContainer());\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"ui-selector-search-footer-box\">\n\t\t\t\t${phrase}\n\t\t\t\t${this.getLoaderContainer()}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tgetScannerLabelContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('scannerLabel', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<span onclick=\"${this.handleScannerClick.bind(this)}\">\n\t\t\t\t\t<span class=\"ui-selector-footer-link ui-selector-footer-link-add footer-link--warehouse-barcode-icon\">\n\t\t\t\t\t\t${Loc.getMessage('CATALOG_SELECTOR_SEARCH_POPUP_FOOTER_BARCODE_START_SCAN_LABEL')}\n\t\t\t\t\t</span>\n\t\t\t\t\t${this.getScannerQueryContainer()}\n\t\t\t\t</span>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetScannerQueryContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('scanner_name-container', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<span class=\"ui-selector-search-footer-query\"></span>\n\t\t\t`;\n\t\t});\n\t}\n\n\thandleScannerClick(): void\n\t{\n\t\tconst inputEntity = this.options?.inputEntity;\n\t\tif (inputEntity)\n\t\t{\n\t\t\tinputEntity.startMobileScanner();\n\t\t}\n\t}\n\n\thandleOnSearch(event: BaseEvent): void\n\t{\n\t\tconst { query } = event.getData();\n\n\t\tif (!Type.isStringFilled(query))\n\t\t{\n\t\t\tthis.show();\n\t\t\tDom.style(this.scannerContent, 'display', '');\n\t\t\tDom.style(this.barcodeContent, 'display', 'none');\n\t\t}\n\t\telse if (this.options.currentValue === query)\n\t\t{\n\t\t\tthis.hide();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.show();\n\t\t\tDom.style(this.barcodeContent, 'display', '');\n\t\t\tDom.style(this.scannerContent, 'display', 'none');\n\t\t}\n\n\t\tthis.getQueryContainer().textContent = \" \" + query;\n\t\tthis.getScannerQueryContainer().textContent = \" \" + query;\n\t}\n\n\thandleOnSearchLoad(event: BaseEvent): void\n\t{\n\t\tconst {searchTab} = event.getData();\n\t\tthis.getDialog().getItems().forEach(item => {\n\t\t\tif (item.getCustomData().get('BARCODE') === searchTab.getLastSearchQuery().getQuery())\n\t\t\t{\n\t\t\t\tthis.hide();\n\t\t\t}\n\t\t});\n\t}\n}","import {Extension, Loc, Tag, Type, Text, Dom, Event, userOptions, ajax} from 'main.core';\nimport {Dialog, Item} from 'ui.entity-selector';\nimport './component.css';\nimport {EventEmitter} from 'main.core.events';\nimport {ProductModel} from 'catalog.product-model';\nimport ProductCreationLimitedFooter from './product-creation-limited-footer';\nimport {ProductSearchInput} from './product-search-input';\nimport {ProductSelector} from 'catalog.product-selector';\nimport {BarcodeScanner} from 'catalog.barcode-scanner';\nimport 'ui.notification';\nimport {BarcodeSearchSelectorFooter} from './barcode-search-selector-footer';\nimport {QrAuthorization} from 'ui.qrauthorization';\nimport {SelectorErrorCode} from './selector-error-code';\nimport 'spotlight';\nimport {Guide} from 'ui.tour';\n\nexport class BarcodeSearchInput extends ProductSearchInput\n{\n\tstatic SEARCH_TYPE_ID = 'barcode';\n\n\tonFocusHandler = this.handleFocusEvent.bind(this);\n\tonBlurHandler = this.handleBlurEvent.bind(this);\n\n\tconstructor(id, options = {})\n\t{\n\t\tsuper(id, options);\n\n\t\tthis.focused = false;\n\t\tthis.settingsCollection = Extension.getSettings('catalog.product-selector');\n\n\t\tthis.isInstalledMobileApp =\n\t\t\tthis.selector.getConfig('IS_INSTALLED_MOBILE_APP')\n\t\t\t|| this.settingsCollection.get('isInstallMobileApp')\n\t\t;\n\n\t\tif (\n\t\t\t!this.settingsCollection.get('isEnabledQrAuth')\n\t\t\t&& this.selector.getConfig('ENABLE_BARCODE_QR_AUTH', true)\n\t\t)\n\t\t{\n\t\t\tthis.qrAuth = new QrAuthorization();\n\t\t\tthis.qrAuth.createQrCodeImage();\n\t\t}\n\t}\n\n\tdestroy()\n\t{\n\t\tEvent.unbind(this.getNameInput(), 'focus', this.onFocusHandler);\n\t\tEvent.unbind(this.getNameInput(), 'blur', this.onBlurHandler);\n\t}\n\n\thandleFocusEvent()\n\t{\n\t\tthis.focused = true;\n\t}\n\n\thandleBlurEvent()\n\t{\n\t\tthis.focused = false;\n\t}\n\n\tisSearchEnabled(): boolean\n\t{\n\t\treturn true;\n\t}\n\n\tshowDetailLink(): boolean\n\t{\n\t\treturn false\n\t}\n\n\tgetNameBlock(): HTMLElement\n\t{\n\t\treturn this.cache.remember('nameBlock', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-ctl ui-ctl-textbox ui-ctl-w100\">\n\t\t\t\t\t${this.getNameInput()}\n\t\t\t\t\t${this.getHiddenNameInput()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetDialog(): ?Dialog\n\t{\n\t\treturn this.cache.remember('dialog', () => {\n\t\t\tconst entity = {\n\t\t\t\tid: BarcodeSearchInput.SEARCH_TYPE_ID,\n\t\t\t\toptions: {\n\t\t\t\t\tiblockId: this.model.getIblockId(),\n\t\t\t\t\tbasePriceId: this.model.getBasePriceId(),\n\t\t\t\t\tcurrency: this.model.getCurrency(),\n\t\t\t\t},\n\t\t\t\tdynamicLoad: true,\n\t\t\t\tdynamicSearch: true,\n\t\t\t\tsearchFields: [\n\t\t\t\t\t{ name: 'title', type: 'string', system: true, searchable: false },\n\t\t\t\t],\n\t\t\t};\n\n\t\t\tconst restrictedProductTypes = this.selector.getConfig('RESTRICTED_PRODUCT_TYPES', null);\n\t\t\tif (!Type.isNil(restrictedProductTypes))\n\t\t\t{\n\t\t\t\tentity.options.restrictedProductTypes = restrictedProductTypes;\n\t\t\t}\n\n\t\t\tconst params = {\n\t\t\t\tid: this.id + '_' + BarcodeSearchInput.SEARCH_TYPE_ID,\n\t\t\t\theight: 300,\n\t\t\t\twidth: Math.max(this.getNameInput()?.offsetWidth, 565),\n\t\t\t\tcontext: null,\n\t\t\t\ttargetNode: this.getNameInput(),\n\t\t\t\tenableSearch: false,\n\t\t\t\tmultiple: false,\n\t\t\t\tdropdownMode: true,\n\t\t\t\tsearchTabOptions: {\n\t\t\t\t\tstub: true,\n\t\t\t\t\tstubOptions: {\n\t\t\t\t\t\ttitle: Tag.message`${'CATALOG_SELECTOR_IS_EMPTY_TITLE'}`,\n\t\t\t\t\t\tsubtitle:\n\t\t\t\t\t\t\tthis.isAllowedCreateProduct()\n\t\t\t\t\t\t\t\t? Tag.message`${'CATALOG_SELECTOR_IS_EMPTY_SUBTITLE'}`\n\t\t\t\t\t\t\t\t: ''\n\t\t\t\t\t\t,\n\t\t\t\t\t\tarrow: true\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tevents: {\n\t\t\t\t\t'Item:onSelect': this.onProductSelect.bind(this),\n\t\t\t\t\t'Search:onItemCreateAsync': this.createProduct.bind(this),\n\t\t\t\t\t'ChangeItem:onClick': this.showChangeNotification.bind(this),\n\t\t\t\t},\n\t\t\t\tentities: [entity]\n\t\t\t};\n\n\t\t\tif (this.model.getSkuId() && !Type.isStringFilled(this.model.getField(this.inputName)))\n\t\t\t{\n\t\t\t\tparams.preselectedItems = [[BarcodeSearchInput.SEARCH_TYPE_ID, this.model.getSkuId()]];\n\t\t\t}\n\n\t\t\tif (Type.isObject(this.settingsCollection.get('limitInfo')))\n\t\t\t{\n\t\t\t\tparams.footer = ProductCreationLimitedFooter;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tparams.footer = BarcodeSearchSelectorFooter;\n\t\t\t\tparams.footerOptions = {\n\t\t\t\t\tinputEntity: this,\n\t\t\t\t\tisEmptyBarcode: !this.model || !this.model.isCatalogExisted(),\n\t\t\t\t\tinputName: this.inputName,\n\t\t\t\t\terrorAdminHint: this.settingsCollection.get('errorAdminHint'),\n\t\t\t\t\tallowEditItem: this.isAllowedEditProduct(),\n\t\t\t\t\tallowCreateItem: this.isAllowedCreateProduct(),\n\t\t\t\t\tcreationLabel: Loc.getMessage('CATALOG_SELECTOR_SEARCH_POPUP_FOOTER_CREATE_WITH_BARCODE'),\n\t\t\t\t\tcurrentValue: this.getValue(),\n\t\t\t\t\tsearchOptions: {\n\t\t\t\t\t\tallowCreateItem: this.isAllowedCreateProduct(),\n\t\t\t\t\t\tfooterOptions: {\n\t\t\t\t\t\t\tlabel: Loc.getMessage('CATALOG_SELECTOR_SEARCH_POPUP_FOOTER_CREATE_WITH_BARCODE')\n\t\t\t\t\t\t},\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t}\n\n\t\t\treturn new Dialog(params);\n\t\t});\n\t}\n\n\tlayoutMobileQrPopup(): HTMLElement\n\t{\n\t\treturn this.cache.remember('qrMobilePopup', () => {\n\n\t\t\tconst closeIcon = Tag.render`<span class=\"popup-window-close-icon\"></span>`;\n\t\t\tEvent.bind(closeIcon, 'click', this.closeMobilePopup.bind(this));\n\n\t\t\tlet sendButton = '';\n\t\t\tlet helpButton = '';\n\t\t\tif (top.BX.Helper)\n\t\t\t{\n\t\t\t\thelpButton = Tag.render`\n\t\t\t\t\t<a class=\"product-selector-mobile-popup-link ui-btn ui-btn-light-border ui-btn-round\">\n\t\t\t\t\t\t${Loc.getMessage('CATALOG_SELECTOR_MOBILE_POPUP_HELP_BUTTON')}\n\t\t\t\t\t</a>\n\t\t\t\t`;\n\t\t\t\tEvent.bind(helpButton, 'click', () => {\n\t\t\t\t\ttop.BX.Helper.show(\"redirect=detail&code=14956818\");\n\t\t\t\t});\n\n\t\t\t\tsendButton = Tag.render`\n\t\t\t\t\t<a class=\"product-selector-mobile-popup-link ui-btn ui-btn-link\">\n\t\t\t\t\t\t${Loc.getMessage('CATALOG_SELECTOR_MOBILE_POPUP_SEND_PUSH_BUTTON')}\n\t\t\t\t\t</a>\n\t\t\t\t`;\n\n\t\t\t\tEvent.bind(sendButton, 'click', () => {\n\t\t\t\t\ttop.BX.Helper.show(\"redirect=detail&code=15042444\");\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn Tag.render`\n\t\t\t\t<div data-role=\"mobile-popup\">\n\t\t\t\t\t<div class=\"product-selector-mobile-popup-overlay\"></div>\n\t\t\t\t\t<div class=\"product-selector-mobile-popup-content\">\n\t\t\t\t\t\t<div class=\"product-selector-mobile-popup-title\">${Loc.getMessage('CATALOG_SELECTOR_MOBILE_POPUP_TITLE')}</div>\n\t\t\t\t\t\t<div class=\"product-selector-mobile-popup-text\">${Loc.getMessage('CATALOG_SELECTOR_MOBILE_POPUP_INSTRUCTION')}</div>\n\t\t\t\t\t\t<div class=\"product-selector-mobile-popup-qr\">\n\t\t\t\t\t\t\t${this.qrAuth.getQrNode()}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"product-selector-mobile-popup-link-container\">\n\t\t\t\t\t\t\t${helpButton}\n\t\t\t\t\t\t\t${sendButton}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t${closeIcon}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tcloseMobilePopup()\n\t{\n\t\tthis.removeQrAuth();\n\n\t\tajax\n\t\t\t.runAction(\n\t\t\t\t'catalog.ProductSelector.isInstalledMobileApp',\n\t\t\t\t{\n\t\t\t\t\tjson: {}\n\t\t\t\t}\n\t\t\t)\n\t\t\t.then((result) => {\n\t\t\t\tthis.selector.emit('onBarcodeQrClose', {});\n\n\t\t\t\tif (result.data === true)\n\t\t\t\t{\n\t\t\t\t\tthis.selector.emit('onBarcodeScannerInstallChecked', {});\n\t\t\t\t\tthis.isInstalledMobileApp = true;\n\t\t\t\t}\n\t\t\t})\n\t\t;\n\n\t\tuserOptions.save('product-selector', 'barcodeQrAuth', 'showed', 'Y');\n\t}\n\n\thandleClickNameInput(event: UIEvent)\n\t{\n\t\tif (this.qrAuth && this.getDialog().getContainer())\n\t\t{\n\t\t\tif (!Dom.hasClass(this.getDialog().getContainer(), 'qr-barcode-info'))\n\t\t\t{\n\t\t\t\tDom.addClass(this.getDialog().getContainer(),'qr-barcode-info');\n\t\t\t}\n\n\t\t\tif (this.getDialog().getContainer())\n\t\t\t{\n\t\t\t\tDom.append(this.layoutMobileQrPopup(), this.getDialog().getContainer());\n\t\t\t}\n\t\t}\n\n\t\tsuper.handleClickNameInput(event);\n\t}\n\n\tshowItems()\n\t{\n\t\tthis.searchInDialog();\n\t}\n\n\tonChangeValue(value: string)\n\t{\n\t\tconst fields = {};\n\n\t\tthis.getNameInput().title = value;\n\t\tthis.getNameInput().value = value;\n\n\t\tfields[this.inputName] = value;\n\n\t\tEventEmitter.emit('ProductSelector::onBarcodeChange', {\n\t\t\trowId: this.selector.getRowId(),\n\t\t\tfields\n\t\t});\n\n\t\tthis.selector.emit('onBarcodeChange', {value});\n\n\t\tif (this.selector.isEnabledAutosave())\n\t\t{\n\t\t\tthis.selector.getModel().setField(this.inputName, value);\n\t\t\tthis.selector.getModel().showSaveNotifier(\n\t\t\t\t'barcodeChanger_' + this.selector.getId(),\n\t\t\t\t{\n\t\t\t\t\ttitle: Loc.getMessage('CATALOG_SELECTOR_SAVING_NOTIFICATION_BARCODE'),\n\t\t\t\t\tdisableCancel: true,\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tonSave: () => {\n\t\t\t\t\t\t\tif (this.selector)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.selector.getModel().save([this.inputName]);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t}\n\n\tsearchInDialog(): void\n\t{\n\t\tconst searchQuery = this.getFilledValue().trim();\n\t\tthis.searchByBarcode(searchQuery);\n\t}\n\n\tsearchByBarcode(searchQuery: string = ''): void\n\t{\n\t\tif (!this.selector.isProductSearchEnabled())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst dialog = this.getDialog();\n\t\tif (!dialog)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tdialog.removeItems();\n\t\tif (!Type.isStringFilled(searchQuery))\n\t\t{\n\t\t\tif (this.model && this.model.isCatalogExisted())\n\t\t\t{\n\t\t\t\tdialog.setPreselectedItems([[BarcodeSearchInput.SEARCH_TYPE_ID, this.model.getSkuId()]])\n\t\t\t\tdialog.loadState = 'UNSENT';\n\t\t\t\tdialog.load();\n\t\t\t}\n\t\t}\n\n\t\tdialog.show();\n\t\tdialog.search(searchQuery);\n\t}\n\n\thandleNameInputBlur(event: UIEvent)\n\t{\n\t\t// timeout to toggle clear icon handler while cursor is inside of name input\n\t\tsetTimeout(() => {\n\t\t\tthis.toggleIcon(this.getClearIcon(), 'none');\n\n\t\t\tif (this.showDetailLink() && Type.isStringFilled(this.getValue()))\n\t\t\t{\n\t\t\t\tthis.toggleIcon(this.getSearchIcon(), 'none');\n\t\t\t\tthis.toggleIcon(this.getArrowIcon(), 'block');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.toggleIcon(this.getArrowIcon(), 'none');\n\t\t\t\tthis.toggleIcon(\n\t\t\t\t\tthis.getSearchIcon(),\n\t\t\t\t\tType.isStringFilled(this.getFilledValue()) ? 'none' : 'block'\n\t\t\t\t);\n\t\t\t}\n\t\t}, 200);\n\t}\n\n\tsetInputValueOnProductSelect(item: Item)\n\t{\n\t\titem.getDialog().getTargetNode().value = item.getSubtitle()\n\t}\n\n\tgetCreationProduct(name)\n\t{\n\t\tconst fields = {...this.selector.getModel().getFields()};\n\t\tfields[ProductSelector.INPUT_FIELD_NAME] = name;\n\n\t\treturn new ProductModel({\n\t\t\tisSimpleModel: true,\n\t\t\tisNew: true,\n\t\t\tcurrency: this.selector.options.currency,\n\t\t\tiblockId: this.selector.getModel().getIblockId(),\n\t\t\tbasePriceId: this.selector.getModel().getBasePriceId(),\n\t\t\tfields\n\t\t})\n\t}\n\n\tcreateProductModelFromSearchQuery(searchQuery: string)\n\t{\n\t\tconst model = super.createProductModelFromSearchQuery(searchQuery);\n\t\tmodel.setField(ProductSelector.INPUT_FIELD_NAME, Loc.getMessage('CATALOG_SELECTOR_NEW_BARCODE_PRODUCT_NAME'));\n\t\tmodel.setField(this.inputName, searchQuery);\n\n\t\treturn model;\n\t}\n\n\tcheckCreationModel(creationModel: ProductModel): boolean\n\t{\n\t\tif (!Type.isStringFilled(creationModel.getField(ProductSelector.INPUT_FIELD_NAME)))\n\t\t{\n\t\t\tthis.model.getErrorCollection().setError(\n\t\t\t\tSelectorErrorCode.NOT_SELECTED_PRODUCT,\n\t\t\t\tLoc.getMessage('CATALOG_SELECTOR_EMPTY_TITLE')\n\t\t\t);\n\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tgetPlaceholder(): string\n\t{\n\t\treturn (\n\t\t\tthis.isSearchEnabled() && this.model.isEmpty()\n\t\t\t\t? Loc.getMessage('CATALOG_SELECTOR_BEFORE_SEARCH_BARCODE_TITLE')\n\t\t\t\t: Loc.getMessage('CATALOG_SELECTOR_VIEW_BARCODE_TITLE')\n\t\t);\n\t}\n\n\thandleClearIconClick(event: UIEvent)\n\t{\n\t\tthis.toggleIcon(this.getClearIcon(), 'none');\n\t\tthis.onChangeValue('');\n\n\t\tthis.selector.focusName();\n\n\t\tevent.stopPropagation();\n\t\tevent.preventDefault();\n\t}\n\n\tstartMobileScanner(event)\n\t{\n\t\tif (this.isInstalledMobileApp)\n\t\t{\n\t\t\tthis.sendMobilePush(event);\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this.qrAuth)\n\t\t{\n\t\t\tthis.qrAuth = new QrAuthorization();\n\t\t\tthis.qrAuth.createQrCodeImage();\n\t\t}\n\n\t\tif (this.getDialog().isOpen())\n\t\t{\n\t\t\tthis.getDialog().hide();\n\t\t\tthis.getDialog().subscribeOnce('onHide', this.handleClickNameInput.bind(this));\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.handleClickNameInput(event);\n\t\t}\n\t}\n\n\tsendMobilePush(event)\n\t{\n\t\tevent?.preventDefault();\n\t\tthis.getDialog().hide();\n\t\tthis.getNameInput().focus();\n\n\t\tif (!this.selector.isEnabledMobileScanning())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst token = this.selector.getMobileScannerToken();\n\t\tBarcodeScanner.open(token);\n\n\t\tconst repeatLink = Tag.render`<span class='ui-notification-balloon-action'>${Loc.getMessage('CATALOG_SELECTOR_SEND_PUSH_ON_SCANNER_NOTIFICATION_REPEAT')}</span>`;\n\t\tEvent.bind(repeatLink, 'click', this.sendMobilePush.bind(this));\n\n\t\tconst content = Tag.render`\n\t\t\t<div>\n\t\t\t\t<span>${Loc.getMessage('CATALOG_SELECTOR_SEND_PUSH_ON_SCANNER_NOTIFICATION')}</span>\n\t\t\t\t${repeatLink}\n\t\t\t</div>\n\t\t`;\n\n\t\tBX.UI.Notification.Center.notify({\n\t\t\tcontent,\n\t\t\tcategory: 'sending_push_barcode_scanner_notification',\n\t\t\tautoHideDelay: 5000,\n\t\t});\n\t}\n\n\tgetProductIdByBarcode(barcode)\n\t{\n\t\treturn ajax.runAction(\n\t\t\t'catalog.ProductSelector.getProductIdByBarcode',\n\t\t\t{\n\t\t\t\tjson: {\n\t\t\t\t\tbarcode: barcode,\n\t\t\t\t}\n\t\t\t}\n\t\t)\n\t}\n\n\tapplyScannerData(barcode)\n\t{\n\t\tthis.getProductIdByBarcode(barcode).then((response) => {\n\t\t\tconst productId = response?.data;\n\t\t\tif (productId)\n\t\t\t{\n\t\t\t\tthis.selectScannedBarcodeProduct(productId);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.searchByBarcode(barcode);\n\t\t\t}\n\t\t\tthis.getNameInput().value = Text.encode(barcode);\n\t\t});\n\t}\n\n\tselectScannedBarcodeProduct(productId)\n\t{\n\t\tthis.toggleIcon(this.getSearchIcon(), 'none');\n\t\tthis.clearErrors();\n\t\tif (this.selector)\n\t\t{\n\t\t\tthis.selector.onProductSelect(\n\t\t\t\tproductId,\n\t\t\t\t{\n\t\t\t\t\tisNew: false,\n\t\t\t\t\timmutableFields: [],\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tthis.selector.clearLayout();\n\t\t\tthis.selector.layout();\n\t\t}\n\n\t\tthis.cache.delete('dialog');\n\t}\n\n\tgetBarcodeIcon(): HTMLElement\n\t{\n\t\treturn this.cache.remember('barcodeIcon', () => {\n\t\t\tconst barcodeIcon = Tag.render`\n\t\t\t\t<button\tclass=\"ui-ctl-before warehouse-barcode-icon\" title=\"${Loc.getMessage('CATALOG_SELECTOR_BARCODE_ICON_TITLE')}\"></button>\n\t\t\t`;\n\n\t\t\tif (\n\t\t\t\t!this.settingsCollection.get('isShowedBarcodeSpotlightInfo')\n\t\t\t\t&& this.settingsCollection.get('isAllowedShowBarcodeSpotlightInfo')\n\t\t\t\t&& this.selector.getConfig('ENABLE_INFO_SPOTLIGHT', true)\n\t\t\t)\n\t\t\t{\n\t\t\t\tthis.spotlight = new BX.SpotLight(\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'selector_barcode_scanner_info',\n\t\t\t\t\t\ttargetElement: barcodeIcon,\n\t\t\t\t\t\tautoSave: true,\n\t\t\t\t\t\ttargetVertex: \"middle-center\",\n\t\t\t\t\t\tzIndex: 200\n\t\t\t\t\t}\n\t\t\t\t);\n\n\t\t\t\tthis.spotlight.show();\n\n\t\t\t\tEventEmitter.subscribe(this.spotlight, 'BX.SpotLight:onTargetEnter', () => {\n\t\t\t\t\tconst guide = new Guide({\n\t\t\t\t\t\tsteps: [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttarget: barcodeIcon,\n\t\t\t\t\t\t\t\ttitle: Loc.getMessage('CATALOG_SELECTOR_BARCODE_SCANNER_FIRST_TIME_HINT_TITLE'),\n\t\t\t\t\t\t\t\ttext: Loc.getMessage('CATALOG_SELECTOR_BARCODE_SCANNER_FIRST_TIME_HINT_TEXT'),\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t],\n\t\t\t\t\t\tonEvents: true,\n\t\t\t\t\t});\n\n\t\t\t\t\tguide.getPopup().setAutoHide(true);\n\t\t\t\t\tguide.showNextStep();\n\t\t\t\t\tthis.selector.setConfig('ENABLE_INFO_SPOTLIGHT', false);\n\t\t\t\t\tthis.selector.emit('onSpotlightClose', {});\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tEvent.bind(barcodeIcon, 'click', (event) => {\n\t\t\t\tevent.preventDefault();\n\t\t\t\tif (this.qrAuth)\n\t\t\t\t{\n\t\t\t\t\tthis.handleClickNameInput(event);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.startMobileScanner(event);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\treturn barcodeIcon;\n\t\t});\n\t}\n\n\tlayout(): HTMLElement\n\t{\n\t\tconst block = super.layout();\n\t\tDom.append(this.getBarcodeIcon(), block);\n\t\tthis.getNameInput().className += ' catalog-product-field-input-barcode';\n\t\tEvent.bind(this.getNameInput(), 'focus', this.onFocusHandler);\n\t\tEvent.bind(this.getNameInput(), 'blur', this.onBlurHandler);\n\n\t\treturn block;\n\t}\n\n\tremoveSpotlight()\n\t{\n\t\tif (this.spotlight)\n\t\t{\n\t\t\tthis.spotlight.close();\n\t\t}\n\t}\n\n\tremoveQrAuth()\n\t{\n\t\tconst mobilePopup = this.getDialog().getContainer()?.querySelector('[data-role=\"mobile-popup\"]');\n\t\tif (mobilePopup)\n\t\t{\n\t\t\tDom.remove(mobilePopup);\n\t\t\tif (Dom.hasClass(this.getDialog().getContainer(), 'qr-barcode-info'))\n\t\t\t{\n\t\t\t\tDom.removeClass(this.getDialog().getContainer(),'qr-barcode-info');\n\t\t\t}\n\t\t}\n\n\t\tthis.qrAuth = null;\n\t}\n}\n","import {ajax, Cache, Dom, Event, Extension, Loc, Reflection, Runtime, Tag, Text, Type} from 'main.core';\nimport 'ui.design-tokens';\nimport 'ui.forms';\nimport 'fileinput';\nimport 'ui.notification';\nimport {EventEmitter} from 'main.core.events';\nimport {SkuTree} from 'catalog.sku-tree';\nimport {ProductSearchInput} from \"./product-search-input\";\nimport {ProductImageInput} from \"./product-image-input\";\nimport {ProductModel, RightActionDictionary} from \"catalog.product-model\";\nimport './component.css';\nimport {BarcodeSearchInput} from \"./barcode-search-input\";\nimport {SelectorErrorCode} from \"./selector-error-code\";\n\nconst instances = new Map();\nconst iblockSkuTreeProperties = new Map();\n\nexport class ProductSelector extends EventEmitter\n{\n\tstatic MODE_VIEW = 'view';\n\tstatic MODE_EDIT = 'edit';\n\tstatic SHORT_VIEW_FORMAT = 'short';\n\tstatic FULL_VIEW_FORMAT = 'full';\n\tstatic INPUT_FIELD_NAME = 'NAME';\n\tstatic INPUT_FIELD_BARCODE = 'BARCODE';\n\n\tstatic ErrorCodes = SelectorErrorCode;\n\tstatic UIInputRequest = null;\n\t#inAjaxProcess = false;\n\tmode: ProductSelector.MODE_EDIT | ProductSelector.MODE_VIEW = ProductSelector.MODE_EDIT;\n\tcache = new Cache.MemoryCache();\n\ttype = ProductSelector.INPUT_FIELD_NAME;\n\tfileInput: ?ProductImageInput;\n\tsearchInput: ?ProductSearchInput;\n\tskuTreeInstance: ?SkuTree;\n\tmobileScannerToken = null;\n\n\tvariationChangeHandler = this.handleVariationChange.bind(this);\n\tonSaveImageHandler = this.onSaveImage.bind(this);\n\tonChangeFieldsHandler = Runtime.debounce(this.onChangeFields, 500, this);\n\tonUploaderIsInitedHandler = this.onUploaderIsInited.bind(this);\n\tonNameChangeFieldHandler = Runtime.debounce(this.onNameChange, 500, this);\n\n\tstatic getById(id: string): ?ProductSelector\n\t{\n\t\treturn instances.get(id) || null;\n\t}\n\n\tconstructor(id, options = {})\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Catalog.ProductSelector');\n\n\t\tthis.id = id || Text.getRandom();\n\t\toptions.inputFieldName = options.inputFieldName || ProductSelector.INPUT_FIELD_NAME;\n\t\tthis.options = options || {};\n\t\tthis.settings = Extension.getSettings('catalog.product-selector');\n\n\t\tthis.type = this.options.type || ProductSelector.INPUT_FIELD_NAME;\n\n\t\tthis.setMode(options.mode);\n\n\t\tif (options.model && (options.model instanceof ProductModel))\n\t\t{\n\t\t\tthis.model = options.model;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.model = ProductModel.getById(this.id);\n\t\t}\n\n\t\tif (!(this.model instanceof ProductModel))\n\t\t{\n\t\t\tthis.model = new ProductModel(\n\t\t\t\t{\n\t\t\t\t\tcurrency: options.currency,\n\t\t\t\t\tiblockId: Text.toNumber(options.iblockId),\n\t\t\t\t\tbasePriceId: Text.toNumber(options.basePriceId),\n\t\t\t\t\tfields: options.fields,\n\t\t\t\t\tskuTree: options.skuTree,\n\t\t\t\t\tstoreMap: options.storeMap,\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\tthis.model.getImageCollection().setMorePhotoValues(options.morePhotoValues);\n\t\tif (!Type.isNil(this.getConfig('DETAIL_PATH')))\n\t\t{\n\t\t\tthis.model.setDetailPath(this.getConfig('DETAIL_PATH'));\n\t\t}\n\n\t\tif (options.failedProduct)\n\t\t{\n\t\t\tthis.model.getErrorCollection().setError(\n\t\t\t\tSelectorErrorCode.FAILED_PRODUCT,\n\t\t\t\t''\n\t\t\t);\n\t\t}\n\n\t\tif (this.isShowableEmptyProductError())\n\t\t{\n\t\t\tthis.model.getErrorCollection().setError(\n\t\t\t\tSelectorErrorCode.NOT_SELECTED_PRODUCT,\n\t\t\t\tthis.getEmptySelectErrorMessage()\n\t\t\t);\n\t\t}\n\n\t\tif (options.fileView)\n\t\t{\n\t\t\tthis.model.getImageCollection().setPreview(options.fileView);\n\t\t}\n\t\tif (options.fileInput)\n\t\t{\n\t\t\tthis.model.getImageCollection().setEditInput(options.fileInput);\n\t\t}\n\n\t\tthis.layout();\n\n\t\tif (options.skuTree)\n\t\t{\n\t\t\tthis.updateSkuTree(options.skuTree);\n\t\t}\n\n\t\tif (options.scannerToken)\n\t\t{\n\t\t\tthis.setMobileScannerToken(options.scannerToken);\n\t\t}\n\n\t\tthis.subscribeEvents();\n\n\t\tinstances.set(this.id, this);\n\t}\n\n\tsetModel(model: ProductModel): void\n\t{\n\t\tthis.model = model;\n\t}\n\n\tgetModel(): ProductModel\n\t{\n\t\treturn this.model;\n\t}\n\n\tsetMode(mode: ProductSelector.MODE_VIEW | ProductSelector.MODE_EDIT ): void\n\t{\n\t\tif (!Type.isNil(mode))\n\t\t{\n\t\t\tthis.mode = mode === ProductSelector.MODE_VIEW ? ProductSelector.MODE_VIEW : ProductSelector.MODE_EDIT;\n\t\t}\n\t}\n\n\tisViewMode(): boolean\n\t{\n\t\treturn this.mode === ProductSelector.MODE_VIEW;\n\t}\n\n\tisShortViewFormat(): boolean\n\t{\n\t\treturn this.getConfig('VIEW_FORMAT', ProductSelector.FULL_VIEW_FORMAT) === ProductSelector.SHORT_VIEW_FORMAT;\n\t}\n\n\tisSaveable(): boolean\n\t{\n\t\treturn !this.isViewMode() && this.model.isSaveable();\n\t}\n\n\tisEnabledAutosave(): boolean\n\t{\n\t\treturn this.isSaveable() && this.getConfig('ENABLE_AUTO_SAVE', false);\n\t}\n\n\tisEnabledMobileScanning(): boolean\n\t{\n\t\treturn !this.isViewMode() && this.getConfig('ENABLE_MOBILE_SCANNING', true);\n\t}\n\n\tgetEmptySelectErrorMessage()\n\t{\n\t\treturn this.checkProductAddRights()\n\t\t\t? Loc.getMessage('CATALOG_SELECTOR_SELECTED_PRODUCT_TITLE')\n\t\t\t: Loc.getMessage('CATALOG_SELECTOR_SELECT_PRODUCT_TITLE')\n\t\t;\n\t}\n\n\n\tgetMobileScannerToken(): string\n\t{\n\t\treturn this.mobileScannerToken || Text.getRandom(16);\n\t}\n\n\tcheckProductViewRights(): boolean\n\t{\n\t\treturn this.model.checkAccess(RightActionDictionary.ACTION_PRODUCT_VIEW) ?? true;\n\t}\n\n\tcheckProductEditRights(): boolean\n\t{\n\t\treturn this.model.checkAccess(RightActionDictionary.ACTION_PRODUCT_EDIT) ?? false;\n\t}\n\n\tcheckProductAddRights(): boolean\n\t{\n\t\treturn this.model.checkAccess(RightActionDictionary.ACTION_PRODUCT_ADD) ?? false;\n\t}\n\n\tsetMobileScannerToken(token: string): void\n\t{\n\t\tthis.mobileScannerToken = token;\n\t}\n\n\tremoveMobileScannerToken(): void\n\t{\n\t\tthis.mobileScannerToken = null;\n\t}\n\n\tgetId(): string\n\t{\n\t\treturn this.id;\n\t}\n\n\tgetType(): string\n\t{\n\t\treturn this.type;\n\t}\n\n\tgetConfig(name, defaultValue)\n\t{\n\t\treturn BX.prop.get(this.options.config, name, defaultValue);\n\t}\n\n\tsetConfig(name, value): this\n\t{\n\t\tthis.options.config[name] = value;\n\n\t\treturn this;\n\t}\n\n\tgetRowId(): string\n\t{\n\t\treturn this.getConfig('ROW_ID');\n\t}\n\n\tgetFileInput(): ProductImageInput\n\t{\n\t\tif (!this.fileInput)\n\t\t{\n\t\t\tthis.fileInput = new ProductImageInput(\n\t\t\t\tthis.options.fileInputId,\n\t\t\t\t{\n\t\t\t\t\tselector: this,\n\t\t\t\t\tenableSaving: this.getConfig('ENABLE_IMAGE_CHANGE_SAVING', false)\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\treturn this.fileInput;\n\t}\n\n\tisProductSearchEnabled(): boolean\n\t{\n\t\treturn this.getConfig('ENABLE_SEARCH', false)\n\t\t\t&& this.model.getIblockId() > 0\n\t\t\t&& this.checkProductViewRights()\n\t\t;\n\t}\n\n\tisSkuTreeEnabled(): boolean\n\t{\n\t\treturn this.getConfig('ENABLE_SKU_TREE', true) !== false;\n\t}\n\n\tisImageFieldEnabled(): boolean\n\t{\n\t\treturn this.getConfig('ENABLE_IMAGE_INPUT', true) !== false;\n\t}\n\n\tisShowableEmptyProductError(): boolean\n\t{\n\t\treturn this.isEnabledEmptyProductError() &&\n\t\t\t(\n\t\t\t\tthis.model.isEmpty() && this.model.isChanged()\n\t\t\t\t|| this.model.isSimple()\n\t\t\t);\n\t}\n\n\tisShowableErrors(): boolean\n\t{\n\t\treturn this.isEnabledEmptyProductError() || this.isEnabledEmptyImagesError();\n\t}\n\n\tisEnabledEmptyProductError(): boolean\n\t{\n\t\treturn this.getConfig('ENABLE_EMPTY_PRODUCT_ERROR', false);\n\t}\n\n\tisEnabledEmptyImagesError(): boolean\n\t{\n\t\treturn this.getConfig('ENABLE_EMPTY_IMAGES_ERROR', false);\n\t}\n\n\tisEnabledChangesRendering(): boolean\n\t{\n\t\treturn this.getConfig('ENABLE_CHANGES_RENDERING', true);\n\t}\n\n\tisInputDetailLinkEnabled(): boolean\n\t{\n\t\treturn this.getConfig('ENABLE_INPUT_DETAIL_LINK', false)\n\t\t\t&& Type.isStringFilled(this.model.getDetailPath())\n\t\t\t&& this.checkProductViewRights()\n\t\t;\n\t}\n\n\tgetWrapper(): HTMLElement\n\t{\n\t\tif (!this.wrapper)\n\t\t{\n\t\t\tthis.wrapper = document.getElementById(this.id);\n\t\t}\n\n\t\treturn this.wrapper;\n\t}\n\n\trenderTo(node)\n\t{\n\t\tthis.clearLayout();\n\t\tthis.wrapper = node;\n\t\tthis.layout();\n\t}\n\n\tlayout()\n\t{\n\t\tconst wrapper = this.getWrapper();\n\t\tif (!wrapper)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.defineWrapperClass(wrapper);\n\t\twrapper.innerHTML = '';\n\n\t\tconst block = Tag.render`<div class=\"catalog-product-field-inner\"></div>`;\n\t\tDom.append(this.layoutNameBlock(), block);\n\n\t\tif (this.getSkuTreeInstance())\n\t\t{\n\t\t\tDom.append(this.getSkuTreeInstance().layout(), block);\n\t\t}\n\n\t\tDom.append(this.getErrorContainer(), block);\n\n\t\tif (!this.isViewMode())\n\t\t{\n\t\t\tDom.append(block, wrapper);\n\t\t}\n\n\t\tif (this.isImageFieldEnabled())\n\t\t{\n\t\t\tif (!Reflection.getClass('BX.UI.ImageInput'))\n\t\t\t{\n\t\t\t\tif (ProductSelector.UIInputRequest instanceof Promise)\n\t\t\t\t{\n\t\t\t\t\tProductSelector.UIInputRequest.then(() => {\n\t\t\t\t\t\tthis.layoutImage();\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tProductSelector.UIInputRequest = new Promise(resolve => {\n\t\t\t\t\t\tajax\n\t\t\t\t\t\t\t.runAction(\t'catalog.productSelector.getFileInput', {\n\t\t\t\t\t\t\t\tjson:{\n\t\t\t\t\t\t\t\t\tiblockId: this.getModel().getIblockId()\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t.then(() => {\n\t\t\t\t\t\t\t\tthis.layoutImage();\n\t\t\t\t\t\t\t\tProductSelector.UIInputRequest = null;\n\t\t\t\t\t\t\t\tresolve();\n\t\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.layoutImage();\n\t\t\t}\n\n\t\t\tDom.append(this.getImageContainer(), wrapper);\n\t\t}\n\n\t\tif (this.isViewMode())\n\t\t{\n\t\t\tDom.append(block, wrapper);\n\t\t}\n\n\t\tif (this.isViewMode())\n\t\t{\n\t\t\tDom.append(block, wrapper);\n\t\t}\n\n\t\tif (this.isShowableErrors)\n\t\t{\n\t\t\tthis.layoutErrors();\n\t\t}\n\n\t\tthis.subscribeToVariationChange();\n\t}\n\n\tfocusName(): this\n\t{\n\t\tif (this.searchInput)\n\t\t{\n\t\t\tthis.searchInput.focusName();\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tgetImageContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('imageContainer', () => (\n\t\t\tTag.render`<div class=\"catalog-product-img\"></div>`\n\t\t));\n\t}\n\n\tgetErrorContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('errorContainer', () => (\n\t\t\tTag.render`<div class=\"catalog-product-error\"></div>`\n\t\t));\n\t}\n\n\tlayoutErrors()\n\t{\n\t\tthis.getErrorContainer().innerHTML = '';\n\t\tthis.clearImageErrorBorder();\n\t\tif (!this.model.getErrorCollection().hasErrors())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst errors = this.model.getErrorCollection().getErrors();\n\t\tfor (const code in errors)\n\t\t{\n\t\t\tif (!ProductSelector.ErrorCodes.getCodes().includes(code))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (code === 'EMPTY_IMAGE')\n\t\t\t{\n\t\t\t\tthis.setImageErrorBorder();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tDom.append(\n\t\t\t\t\tTag.render`<div class=\"catalog-product-error-item\">${errors[code].text}</div>`,\n\t\t\t\t\tthis.getErrorContainer()\n\t\t\t\t);\n\n\t\t\t\tif (this.searchInput)\n\t\t\t\t{\n\t\t\t\t\tDom.addClass(this.searchInput.getNameBlock(), 'ui-ctl-danger');\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tsetImageErrorBorder()\n\t{\n\t\tDom.addClass(\n\t\t\tthis.getImageContainer().querySelector('.adm-fileinput-area'),\n\t\t\t'adm-fileinput-drag-area-error'\n\t\t);\n\t}\n\n\tclearImageErrorBorder()\n\t{\n\t\tDom.removeClass(\n\t\t\tthis.getImageContainer().querySelector('.adm-fileinput-area'),\n\t\t\t'adm-fileinput-drag-area-error'\n\t\t);\n\t}\n\n\tonUploaderIsInited()\n\t{\n\t\tif (this.isEnabledEmptyImagesError())\n\t\t{\n\t\t\trequestAnimationFrame(this.layoutErrors.bind(this));\n\t\t}\n\t}\n\n\tlayoutImage()\n\t{\n\t\tthis.getImageContainer().innerHTML = '';\n\t\tDom.append(this.getFileInput().layout(), this.getImageContainer());\n\t\tthis.refreshImageSelectorId = null;\n\t}\n\n\tclearState(): void\n\t{\n\t\tthis\n\t\t\t.getModel()\n\t\t\t.initFields({\n\t\t\t\tID: '',\n\t\t\t\tNAME: '',\n\t\t\t\tBARCODE: '',\n\t\t\t\tPRODUCT_ID: null,\n\t\t\t\tSKU_ID: null,\n\t\t\t})\n\t\t\t.setOption('isNew', false)\n\t\t;\n\n\t\tthis\n\t\t\t.getFileInput()\n\t\t\t.restoreDefaultInputHtml()\n\t\t;\n\n\t\tthis\n\t\t\t.getModel()\n\t\t\t.clearSkuTree()\n\t\t;\n\t\tthis.skuTreeInstance = null;\n\n\t\tthis\n\t\t\t.getModel()\n\t\t\t.getStoreCollection()\n\t\t\t.clear()\n\t\t;\n\t}\n\n\tclearLayout(): void\n\t{\n\t\tconst wrapper = this.getWrapper();\n\t\tif (wrapper)\n\t\t{\n\t\t\twrapper.innerHTML = '';\n\t\t}\n\n\t\tthis.unsubscribeToVariationChange();\n\t}\n\n\tsubscribeEvents()\n\t{\n\t\tEventEmitter.subscribe('ProductList::onChangeFields', this.onChangeFieldsHandler);\n\t\tEventEmitter.subscribe('ProductSelector::onNameChange', this.onNameChangeFieldHandler);\n\t\tEventEmitter.subscribe('Catalog.ImageInput::save', this.onSaveImageHandler);\n\t\tEventEmitter.subscribe('onUploaderIsInited', this.onUploaderIsInitedHandler);\n\t}\n\n\tunsubscribeEvents()\n\t{\n\t\tthis.unsubscribeToVariationChange();\n\n\t\tEventEmitter.unsubscribe('Catalog.ImageInput::save', this.onSaveImageHandler);\n\t\tEventEmitter.unsubscribe('ProductList::onChangeFields', this.onChangeFieldsHandler);\n\t\tEventEmitter.unsubscribe('onUploaderIsInited', this.onUploaderIsInitedHandler);\n\t\tEventEmitter.unsubscribe('onUploaderIsInited', this.onUploaderIsInitedHandler);\n\t\tEventEmitter.unsubscribe('ProductSelector::onNameChange', this.onNameChangeFieldHandler);\n\t}\n\n\tdefineWrapperClass(wrapper)\n\t{\n\t\tif (this.isViewMode())\n\t\t{\n\t\t\tDom.addClass(wrapper, 'catalog-product-view');\n\t\t\tDom.removeClass(wrapper, 'catalog-product-edit');\n\n\t\t\tif (this.isShortViewFormat())\n\t\t\t{\n\t\t\t\tDom.addClass(wrapper, '--short-format');\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.addClass(wrapper, 'catalog-product-edit');\n\t\t\tDom.removeClass(wrapper, 'catalog-product-view');\n\t\t}\n\n\t\tif (this.isImageFieldEnabled())\n\t\t{\n\t\t\tDom.addClass(wrapper, '--with-images');\n\t\t}\n\t}\n\n\tgetNameBlockView(): HTMLElement\n\t{\n\t\tconst productName = Text.encode(this.model.getField('NAME'));\n\t\tconst namePlaceholder = Loc.getMessage('CATALOG_SELECTOR_VIEW_NAME_TITLE');\n\n\t\tif (this.getModel().getDetailPath())\n\t\t{\n\t\t\treturn Tag.render`\n\t\t\t\t<a href=\"${this.getModel().getDetailPath()}\" title=\"${namePlaceholder}\">${productName}</a>\n\t\t\t`;\n\t\t}\n\n\t\treturn Tag.render`<span title=\"${namePlaceholder}\">${productName}</span>`;\n\n\t}\n\n\tgetNameInputFilledValue(): string\n\t{\n\t\tif (this.searchInput)\n\t\t{\n\t\t\treturn this.searchInput.getFilledValue();\n\t\t}\n\n\t\treturn '';\n\t}\n\n\tlayoutNameBlock(): HTMLElement\n\t{\n\t\tconst block = Tag.render`<div class=\"catalog-product-field-input\"></div>`;\n\n\t\tif (this.isViewMode())\n\t\t{\n\t\t\tDom.append(this.getNameBlockView(), block);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (this.getType() === ProductSelector.INPUT_FIELD_BARCODE)\n\t\t\t{\n\t\t\t\tif (!this.searchInput)\n\t\t\t\t{\n\t\t\t\t\tthis.searchInput = new BarcodeSearchInput(\n\t\t\t\t\t\tthis.id,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tselector: this,\n\t\t\t\t\t\t\tmodel: this.getModel(),\n\t\t\t\t\t\t\tinputName: this.options.inputFieldName,\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.searchInput = new ProductSearchInput(\n\t\t\t\t\tthis.id,\n\t\t\t\t\t{\n\t\t\t\t\t\tselector: this,\n\t\t\t\t\t\tmodel: this.getModel(),\n\t\t\t\t\t\tinputName: this.options.inputFieldName,\n\t\t\t\t\t\tisSearchEnabled: this.isProductSearchEnabled(),\n\t\t\t\t\t\tisEnabledEmptyProductError: this.isEnabledEmptyProductError(),\n\t\t\t\t\t\tisEnabledDetailLink: this.isInputDetailLinkEnabled()\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tDom.append(this.searchInput.layout(), block);\n\t\t}\n\n\t\treturn block;\n\t}\n\n\tsearchInDialog(): ProductSelector\n\t{\n\t\tthis.searchInput.searchInDialog();\n\n\t\treturn this;\n\t}\n\n\tupdateSkuTree(tree): ProductSelector\n\t{\n\t\tthis.getModel().setSkuTree(tree);\n\t\tthis.skuTreeInstance = null;\n\n\t\treturn this;\n\t}\n\n\tgetIblockSkuTreeProperties(): Promise\n\t{\n\t\treturn new Promise((resolve) => {\n\t\t\tif (iblockSkuTreeProperties.has(this.getModel().getIblockId()))\n\t\t\t{\n\t\t\t\tresolve(iblockSkuTreeProperties.get(this.getModel().getIblockId()));\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tajax.runAction(\n\t\t\t\t\t'catalog.productSelector.getSkuTreeProperties',\n\t\t\t\t\t{\n\t\t\t\t\t\tjson: {\n\t\t\t\t\t\t\tiblockId: this.getModel().getIblockId(),\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t\t\t.then(response => {\n\t\t\t\t\t\tiblockSkuTreeProperties.set(this.getModel().getIblockId(), response)\n\t\t\t\t\t\tresolve(response);\n\t\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\n\tgetSkuTreeInstance(): SkuTree\n\t{\n\t\tif (this.isSkuTreeEnabled() && this.getModel()?.getSkuTree() && !this.skuTreeInstance)\n\t\t{\n\t\t\tthis.skuTreeInstance = new SkuTree({\n\t\t\t\tskuTree: this.getModel().getSkuTree(),\n\t\t\t\tselectable: this.getConfig('ENABLE_SKU_SELECTION', true),\n\t\t\t\thideUnselected: this.getConfig('HIDE_UNSELECTED_ITEMS', false),\n\t\t\t\tisShortView: this.isViewMode() && this.isShortViewFormat(),\n\t\t\t});\n\t\t}\n\n\t\treturn this.skuTreeInstance;\n\t}\n\n\tsubscribeToVariationChange()\n\t{\n\t\tconst skuTree = this.getSkuTreeInstance();\n\t\tif (skuTree)\n\t\t{\n\t\t\tthis.unsubscribeToVariationChange();\n\t\t\tskuTree.subscribe('SkuProperty::onChange', this.variationChangeHandler);\n\t\t}\n\t}\n\n\tunsubscribeToVariationChange()\n\t{\n\t\tconst skuTree = this.getSkuTreeInstance();\n\t\tif (skuTree)\n\t\t{\n\t\t\tskuTree.unsubscribe('SkuProperty::onChange', this.variationChangeHandler);\n\t\t}\n\t}\n\n\thandleVariationChange(event)\n\t{\n\t\tconst [skuFields] = event.getData();\n\t\tconst productId = Text.toNumber(skuFields.PARENT_PRODUCT_ID);\n\t\tconst variationId = Text.toNumber(skuFields.ID);\n\n\t\tif (productId <= 0 || variationId <= 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.emit('onBeforeChange', {\n\t\t\tselectorId: this.getId(),\n\t\t\trowId: this.getRowId()\n\t\t});\n\n\t\tthis.#inAjaxProcess = true;\n\t\tajax.runAction(\n\t\t\t'catalog.productSelector.getSelectedSku',\n\t\t\t{\n\t\t\t\tjson: {\n\t\t\t\t\tvariationId,\n\t\t\t\t\toptions: {\n\t\t\t\t\t\tpriceId: this.basePriceId,\n\t\t\t\t\t\tcurrency: this.model.getCurrency(),\n\t\t\t\t\t\turlBuilder: this.getConfig('URL_BUILDER_CONTEXT')\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t)\n\t\t\t.then(response => this.processResponse(response, {...this.options.config}));\n\t}\n\n\tonChangeFields(event)\n\t{\n\t\tconst eventData = event.getData();\n\n\t\tif (eventData.rowId !== this.getRowId())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst fields = eventData.fields;\n\t\tthis.getModel().setFields(fields);\n\t}\n\n\treloadFileInput()\n\t{\n\t\tajax\n\t\t\t.runAction(\t'catalog.productSelector.getFileInput', {\n\t\t\t\tjson:{\n\t\t\t\t\tiblockId: this.getModel().getIblockId(),\n\t\t\t\t\tskuId: this.getModel()?.getSkuId()\n\t\t\t\t}\n\t\t\t})\n\t\t\t.then((event) => {\n\t\t\t\tthis.getModel().getImageCollection().setEditInput(event.data.html);\n\t\t\t\tif (this.isImageFieldEnabled())\n\t\t\t\t{\n\t\t\t\t\tthis.layoutImage();\n\t\t\t\t}\n\t\t\t});\n\t}\n\n\tonNameChange(event)\n\t{\n\t\tconst eventData = event.getData();\n\n\t\tif (eventData.rowId !== this.getRowId() || !this.isEnabledAutosave())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst fields = eventData.fields;\n\t\tthis.getModel().setFields(fields);\n\t\tthis.getModel().save().then(() => {\n\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\tid: 'saving_field_notify_name',\n\t\t\t\tcloseButton: false,\n\t\t\t\tcontent: Tag.render`<div>${Loc.getMessage('CATALOG_SELECTOR_SAVING_NOTIFICATION_NAME_CHANGED')}</div>`,\n\t\t\t\tautoHide: true,\n\t\t\t});\n\t\t});\n\t}\n\n\tonSaveImage(event)\n\t{\n\t\tconst [, inputId, response] = event.getData();\n\t\tif (inputId !== this.getFileInput().getId())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.getFileInput().setId(response.data.id);\n\t\tthis.getFileInput().setInputHtml(response.data.input);\n\t\tthis.getFileInput().setView(response.data.preview);\n\t\tthis.getModel().getImageCollection().setMorePhotoValues(response.data.values);\n\t\tif (this.isImageFieldEnabled())\n\t\t{\n\t\t\tthis.layoutImage();\n\t\t}\n\n\t\tthis.emit('onChange', {\n\t\t\tselectorId: this.id,\n\t\t\trowId: this.getRowId(),\n\t\t\tfields: this.getModel().getFields(),\n\t\t\tmorePhoto: this.getModel().getImageCollection().getMorePhotoValues(),\n\t\t});\n\t}\n\n\tinProcess()\n\t{\n\t\treturn this.#inAjaxProcess;\n\t}\n\n\tonProductSelect(productId, itemConfig)\n\t{\n\t\tthis.emit('onProductSelect', {\n\t\t\tselectorId: this.getId(),\n\t\t\trowId: this.getRowId()\n\t\t});\n\n\t\tthis.emit('onBeforeChange', {\n\t\t\tselectorId: this.getId(),\n\t\t\trowId: this.getRowId()\n\t\t});\n\n\t\tthis.productSelectAjaxAction(productId, itemConfig);\n\t}\n\n\tproductSelectAjaxAction(\n\t\tproductId,\n\t\titemConfig = {\n\t\t\tisNew: false,\n\t\t\timmutableFields: [],\n\t\t}\n\t)\n\t{\n\t\tthis.#inAjaxProcess = true\n\t\tajax\n\t\t\t.runAction(\n\t\t\t\t'catalog.productSelector.getProduct',\n\t\t\t\t{\n\t\t\t\t\tjson: {\n\t\t\t\t\t\tproductId,\n\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\tpriceId: this.basePriceId,\n\t\t\t\t\t\t\tcurrency: this.model.getCurrency(),\n\t\t\t\t\t\t\turlBuilder: this.getConfig('URL_BUILDER_CONTEXT')\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t)\n\t\t\t.then(response => this.processResponse(response, {...this.options.config, ...itemConfig}, true));\n\t}\n\n\tprocessResponse(response, config = {}, isProductAction = false)\n\t{\n\t\tconst data = response?.data || null;\n\t\tthis.#inAjaxProcess = false;\n\n\t\tconst fields = data?.fields || [];\n\t\tif (Type.isArray(config.immutableFields))\n\t\t{\n\t\t\tconfig.immutableFields.forEach((field) => {\n\t\t\t\tfields[field] = this.getModel().getField(field);\n\t\t\t});\n\n\t\t\tdata.fields = fields;\n\t\t}\n\n\t\tif (isProductAction)\n\t\t{\n\t\t\tthis.clearState();\n\t\t}\n\n\t\tif (data)\n\t\t{\n\t\t\tthis.changeSelectedElement(data, config);\n\t\t}\n\t\telse if (!isProductAction)\n\t\t{\n\t\t\tthis.productSelectAjaxAction(this.getModel().getProductId());\n\t\t}\n\n\t\tthis.unsubscribeToVariationChange();\n\n\t\tif (this.isEnabledChangesRendering())\n\t\t{\n\t\t\tthis.clearLayout();\n\t\t\tthis.layout();\n\t\t}\n\n\t\tthis.emit('onChange', {\n\t\t\tselectorId: this.id,\n\t\t\trowId: this.getRowId(),\n\t\t\tisNew: config.isNew || false,\n\t\t\tfields,\n\t\t\tmorePhoto: this.getModel().getImageCollection().getMorePhotoValues(),\n\t\t});\n\t}\n\n\tchangeSelectedElement(data, config)\n\t{\n\t\tconst productId = Text.toInteger(data.productId);\n\t\tconst productChanged = this.getModel().getProductId() !== productId;\n\n\t\tif (productChanged)\n\t\t{\n\t\t\tthis.getModel().setOption('productId', productId);\n\t\t\tthis.getModel().setOption('skuId', Text.toInteger(data.skuId));\n\t\t\tthis.getModel().setOption('isSimpleModel', false);\n\t\t\tthis.getModel().setOption('isNew', config.isNew);\n\t\t}\n\n\t\tthis.getModel().initFields(data.fields);\n\n\t\tconst imageField = {\n\t\t\tid: '',\n\t\t\tinput: '',\n\t\t\tpreview: '',\n\t\t\tvalues: []\n\t\t};\n\n\t\tif (Type.isObject(data.image))\n\t\t{\n\t\t\timageField.id = data.image.id;\n\t\t\timageField.input = data.image.input;\n\t\t\timageField.preview = data.image.preview;\n\t\t\timageField.values = data.image.values;\n\t\t}\n\n\t\tthis.getFileInput().setId(imageField.id);\n\t\tthis.getFileInput().setInputHtml(imageField.input);\n\t\tthis.getFileInput().setView(imageField.preview);\n\n\t\tthis.getModel().getImageCollection().setMorePhotoValues(imageField.values);\n\t\tthis.checkEmptyImageError();\n\n\t\tif (data.detailUrl)\n\t\t{\n\t\t\tthis.getModel().setDetailPath(data.detailUrl);\n\t\t}\n\n\t\tif (Type.isObject(data.skuTree))\n\t\t{\n\t\t\tthis.updateSkuTree(data.skuTree);\n\t\t}\n\t}\n\n\tcheckEmptyImageError()\n\t{\n\t\tif (\n\t\t\t!Type.isArrayFilled(this.getModel().getImageCollection().getMorePhotoValues())\n\t\t\t&& this.isEnabledEmptyImagesError()\n\t\t)\n\t\t{\n\t\t\tthis.getModel().getErrorCollection().setError(\n\t\t\t\t'EMPTY_IMAGE',\n\t\t\t\tLoc.getMessage('CATALOG_SELECTOR_EMPTY_IMAGE_ERROR'),\n\t\t\t);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.getModel().getErrorCollection().removeError('EMPTY_IMAGE');\n\t\t}\n\t}\n\n\tremoveSpotlight()\n\t{\n\t\tthis.searchInput?.removeSpotlight();\n\t\tthis.setConfig('ENABLE_INFO_SPOTLIGHT', false);\n\t}\n\n\tremoveQrAuth()\n\t{\n\t\tthis.searchInput?.removeQrAuth();\n\t\tthis.setConfig('ENABLE_BARCODE_QR_AUTH', false);\n\t}\n}\n"],"names":["ProductSearchSelectorFooter","DefaultFooter","constructor","dialog","options","loader","errorAdminHint","getDialog","subscribe","handleOnSearch","bind","getContent","phrase","isViewCreateButton","allowCreateItem","allowEditItem","isViewEditButton","Tag","render","_t","_","Loc","getMessage","createButton","querySelector","Dom","replace","getLabelContainer","changeButton","getSaveContainer","_t2","getHintContainer","getLoaderContainer","getLoader","Type","isNil","Loader","target","size","color","showLoader","show","hideLoader","hide","setLabel","label","isString","textContent","cache","remember","_t3","handleClick","getOption","getQueryContainer","_t4","className","messageId","inputName","ProductSelector","INPUT_FIELD_BARCODE","_t5","onClickSaveChanges","_t6","message","hintNode","_t7","dataset","hint","hintNoIcon","BX","UI","Hint","initNode","_t8","lastQuery","getActiveTab","getLastSearchQuery","emit","query","clearSearch","createItem","tagSelector","getTagSelector","isLocked","finalize","unlock","focusSearch","event","preventDefault","lock","emitAsync","searchQuery","then","getTab","clearResults","selectFirstTab","catch","getData","currentValue","ProductCreationLimitedFooter","infoButton","Event","InfoHelper","SelectorErrorCode","getCodes","NOT_SELECTED_PRODUCT","FAILED_PRODUCT","DialogMode","SEARCHING","SHOW_PRODUCT_ITEM","SHOW_RECENT","_showSelectedItem","babelHelpers","classPrivateFieldLooseKey","_loadPreselectedItems","_showPreselectedItems","_searchItem","ProductSearchInput","id","Object","defineProperty","value","_searchItem2","_showPreselectedItems2","_loadPreselectedItems2","_showSelectedItem2","Cache","MemoryCache","Text","getRandom","selector","Error","model","isEnabledSearch","isSearchEnabled","isEnabledDetailLink","INPUT_FIELD_NAME","immutableFieldNames","includes","push","ajaxInProcess","loadedSelectedItem","handleSearchInput","Runtime","debounce","searchInDialog","destroy","getId","getSelectorType","getField","fieldName","getValue","getFilledValue","getNameInput","toggleIcon","icon","isDomNode","style","getNameBlock","getNameTag","getHiddenNameInput","isNew","input","encode","getPlaceholder","handleNameInputHiddenChange","getConfig","addClass","setAttribute","getClearIcon","handleClearIconClick","getArrowIcon","getDetailPath","getSearchIcon","handleSearchIconClick","layout","clearInputCache","block","append","isProductSearchEnabled","initHasDialogItems","isStringFilled","handleClickNameInput","handleNameInputBlur","handleNameInputKeyDown","dialogMode","isCatalogExisted","showDetailLink","handleIconsSwitchingOnNameInput","handleNameInputChange","_this$getNameInput","searchTypeId","SEARCH_TYPE_ID","entity","iblockId","getIblockId","basePriceId","getBasePriceId","currency","getCurrency","dynamicLoad","dynamicSearch","restrictedProductTypes","params","height","width","Math","max","offsetWidth","context","targetNode","enableSearch","multiple","dropdownMode","searchTabOptions","stub","stubOptions","title","_t9","subtitle","isAllowedCreateProduct","_t10","arrow","events","onProductSelect","createProduct","showChangeNotification","entities","settingsCollection","Extension","getSettings","isObject","get","footer","footerOptions","isAllowedEditProduct","creationLabel","searchOptions","Dialog","getModel","isEmpty","setConfig","hasDynamicLoad","classPrivateFieldLooseBase","subscribeOnce","getPreselectedItems","length","checkProductAddRights","checkProductEditRights","key","getSearchTab","stopPropagation","Browser","isMac","metaKey","ctrlKey","getFooter","delete","selectorId","rowId","getRowId","clearState","clearLayout","newValue","onChangeValue","focusName","fields","EventEmitter","isEnabledAutosave","setFields","save","Notification","Center","notify","closeButton","content","_t11","autoHide","requestAnimationFrame","focus","trim","isHasDialogItems","isSearchingInProcess","isOpen","showItems","setTimeout","isEnabledEmptyProductError","inProcess","getErrorCollection","setError","getEmptySelectErrorMessage","layoutErrors","getImmutableFieldNames","setInputValueOnProductSelect","item","getTargetNode","getTitle","clearErrors","getCustomData","immutableFields","forEach","setField","errors","getErrors","code","ErrorCodes","removeError","createProductModelFromSearchQuery","getFields","ProductModel","isSimpleModel","getTarget","newProduct","getQuery","Promise","resolve","reject","checkCreationModel","response","toInteger","data","addItem","entityId","tabs","getRecentTab","customData","setOption","name","select","errorResponse","error","_t12","creationModel","getType","onSave","_t13","declineCancelTitle","onCancel","showSaveNotifier","removeSpotlight","removeQrAuth","_dialog$getFooter2","removeItems","ajax","runAction","json","getSkuId","isLoading","_dialog$getFooter","setPreselectedItems","getRootNode","getPopup","loadState","load","_dialog$getFooter3","search","ProductImageInput","_this$selector$getMod","config","getImageCollection","getEditInput","restoreDefaultInputHtml","enableSaving","uploaderFieldMap","setId","setView","html","_this$selector$getMod2","setPreview","setInputHtml","_this$selector$getMod3","setEditInput","_this$selector$getMod4","_this$selector$getMod5","defaultInput","isViewMode","isSaveable","isEnabledLiveSaving","_this$selector$getMod6","_this$selector$getMod7","_this$selector$getMod8","_this$selector$getMod9","imageContainer","getPreview","BarcodeSearchSelectorFooter","isEmptyBarcode","handleOnSearchLoad","barcodeContent","scannerContent","getScannerContent","getScannerLabelContainer","handleScannerClick","getScannerQueryContainer","_this$options","inputEntity","startMobileScanner","searchTab","getItems","BarcodeSearchInput","onFocusHandler","handleFocusEvent","onBlurHandler","handleBlurEvent","focused","isInstalledMobileApp","qrAuth","QrAuthorization","createQrCodeImage","unbind","searchFields","type","system","searchable","preselectedItems","layoutMobileQrPopup","closeIcon","closeMobilePopup","sendButton","helpButton","top","Helper","getQrNode","result","userOptions","getContainer","hasClass","disableCancel","searchByBarcode","getSubtitle","getCreationProduct","sendMobilePush","isEnabledMobileScanning","token","getMobileScannerToken","BarcodeScanner","open","repeatLink","category","autoHideDelay","getProductIdByBarcode","barcode","applyScannerData","productId","selectScannedBarcodeProduct","getBarcodeIcon","barcodeIcon","spotlight","SpotLight","targetElement","autoSave","targetVertex","zIndex","guide","Guide","steps","text","onEvents","setAutoHide","showNextStep","close","_this$getDialog$getCo","mobilePopup","remove","removeClass","instances","Map","iblockSkuTreeProperties","_inAjaxProcess","getById","writable","mode","MODE_EDIT","mobileScannerToken","variationChangeHandler","handleVariationChange","onSaveImageHandler","onSaveImage","onChangeFieldsHandler","onChangeFields","onUploaderIsInitedHandler","onUploaderIsInited","onNameChangeFieldHandler","onNameChange","setEventNamespace","inputFieldName","settings","setMode","toNumber","skuTree","storeMap","setMorePhotoValues","morePhotoValues","setDetailPath","failedProduct","isShowableEmptyProductError","fileView","fileInput","updateSkuTree","scannerToken","setMobileScannerToken","subscribeEvents","set","setModel","MODE_VIEW","isShortViewFormat","FULL_VIEW_FORMAT","SHORT_VIEW_FORMAT","checkProductViewRights","_this$model$checkAcce","checkAccess","RightActionDictionary","ACTION_PRODUCT_VIEW","_this$model$checkAcce2","ACTION_PRODUCT_EDIT","_this$model$checkAcce3","ACTION_PRODUCT_ADD","removeMobileScannerToken","defaultValue","prop","getFileInput","fileInputId","isSkuTreeEnabled","isImageFieldEnabled","isChanged","isSimple","isShowableErrors","isEnabledEmptyImagesError","isEnabledChangesRendering","isInputDetailLinkEnabled","getWrapper","wrapper","document","getElementById","renderTo","node","defineWrapperClass","innerHTML","layoutNameBlock","getSkuTreeInstance","getErrorContainer","Reflection","getClass","UIInputRequest","layoutImage","getImageContainer","subscribeToVariationChange","searchInput","clearImageErrorBorder","hasErrors","setImageErrorBorder","refreshImageSelectorId","initFields","ID","NAME","BARCODE","PRODUCT_ID","SKU_ID","clearSkuTree","skuTreeInstance","getStoreCollection","clear","unsubscribeToVariationChange","unsubscribeEvents","unsubscribe","getNameBlockView","productName","namePlaceholder","getNameInputFilledValue","tree","setSkuTree","getIblockSkuTreeProperties","has","_this$getModel","getSkuTree","SkuTree","selectable","hideUnselected","isShortView","skuFields","PARENT_PRODUCT_ID","variationId","priceId","urlBuilder","processResponse","eventData","reloadFileInput","_this$getModel2","skuId","inputId","preview","values","morePhoto","getMorePhotoValues","itemConfig","productSelectAjaxAction","isProductAction","isArray","field","changeSelectedElement","getProductId","productChanged","imageField","image","checkEmptyImageError","detailUrl","isArrayFilled","_this$searchInput","_this$searchInput2"],"mappings":"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"}