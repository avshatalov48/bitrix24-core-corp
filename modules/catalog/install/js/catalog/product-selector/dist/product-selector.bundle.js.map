{"version":3,"file":"product-selector.bundle.js","sources":["../src/models/base.js","../src/product-search-input.js","../src/product-image-input.js","../src/models/empty.js","../src/models/product.js","../src/models/sku.js","../src/product-selector.js"],"sourcesContent":["import {Text, Type} from 'main.core';\n\nexport class Base\n{\n\tTYPE = '';\n\n\tconstructor(id, config = {})\n\t{\n\t\tthis.id = id || Text.getRandom();\n\t\tthis.config = config || {};\n\t\tthis.setMorePhotoValues(config.morePhoto);\n\t\tthis.setFields(config.fields);\n\t}\n\n\tgetId()\n\t{\n\t\treturn this.id;\n\t}\n\n\tgetProductId()\n\t{\n\t\treturn this.id;\n\t}\n\n\tisSaveable(): boolean\n\t{\n\t\treturn false;\n\t}\n\n\tsetSaveable(value)\n\t{\n\t\tthis.config.saveProductFields = value;\n\t}\n\n\tisNew(): boolean\n\t{\n\t\treturn this.getConfig('isNew', false);\n\t}\n\n\tgetConfig(name, defaultValue)\n\t{\n\t\treturn BX.prop.get(this.config, name, defaultValue);\n\t}\n\n\tgetType(): string\n\t{\n\t\treturn this.TYPE;\n\t}\n\n\tgetFields()\n\t{\n\t\treturn this.fields;\n\t}\n\n\tgetField(fieldName)\n\t{\n\t\treturn BX.prop.get(this.fields, fieldName, '');\n\t}\n\n\tsetFields(fields)\n\t{\n\t\tthis.fields = Type.isObject(fields) ? fields : {};\n\t}\n\n\tisEnableFileSaving(): boolean\n\t{\n\t\treturn false;\n\t}\n\n\tgetMorePhotoValues()\n\t{\n\t\treturn this.morePhoto;\n\t}\n\n\tsetMorePhotoValues(values)\n\t{\n\t\tthis.morePhoto = Type.isPlainObject(values) ? values : {};\n\t}\n\n\tremoveMorePhotoItem(fileId): boolean\n\t{\n\t\treturn false;\n\t}\n\n\taddMorePhotoItem(fileId, value)\n\t{\n\t\tthis.morePhoto[fileId] = value;\n\t}\n\n\tgetFileType(): string\n\t{\n\t\treturn this.getType();\n\t}\n\n\tsetFileType(value): string\n\t{\n\t\tthis.config.fileType = value || '';\n\t}\n\n\tgetDetailPath(): string\n\t{\n\t\treturn '';\n\t}\n\n\tsetDetailPath(value): string\n\t{\n\t\tthis.config.DETAIL_PATH = value || '';\n\t}\n}","import {ajax, Browser, Cache, Dom, Event, Loc, Tag, Text, Type} from 'main.core';\nimport {Dialog} from 'ui.entity-selector';\nimport './component.css';\nimport {EventEmitter} from 'main.core.events';\nimport {Base} from './models/base';\nimport {ProductSelector} from 'catalog.product-selector';\n\nexport class ProductSearchInput\n{\n\tmodel: Base;\n\tselector: ProductSelector;\n\tcache = new Cache.MemoryCache();\n\n\tconstructor(id, options = {})\n\t{\n\t\tthis.id = id || Text.getRandom();\n\t\tthis.selector = options.selector;\n\t\tif (!(this.selector instanceof ProductSelector))\n\t\t{\n\t\t\tthrow new Error('Product selector instance not found.');\n\t\t}\n\n\t\tthis.model = options.model || {};\n\t\tthis.isEnabledSearch = options.isSearchEnabled || false;\n\t\tthis.isEnabledDetailLink = options.isEnabledDetailLink;\n\t\tthis.inputName = options.inputName || '';\n\t}\n\n\tgetId()\n\t{\n\t\treturn this.id;\n\t}\n\n\tgetField(fieldName): string\n\t{\n\t\treturn this.model.getField(fieldName);\n\t}\n\n\tgetValue()\n\t{\n\t\treturn this.getField(this.inputName);\n\t}\n\n\tisSearchEnabled(): boolean\n\t{\n\t\treturn this.isEnabledSearch;\n\t}\n\n\tisEmptyModel(): boolean\n\t{\n\t\treturn this.model.getType() === 'empty';\n\t}\n\n\ttoggleIcon(icon, value)\n\t{\n\t\tif (Type.isDomNode(icon))\n\t\t{\n\t\t\tDom.style(icon, 'display', value);\n\t\t}\n\t}\n\n\tgetNameBlock(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"ui-ctl ui-ctl-textbox ui-ctl-w100\">\n\t\t\t\t${this.getNameTag()}\n\t\t\t\t${this.getNameInput()}\n\t\t\t\t${this.getHiddenNameInput()}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tgetNameTag(): ?HTMLElement\n\t{\n\t\tif (!this.model.isNew())\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"ui-ctl-tag\">${Loc.getMessage('CATALOG_SELECTOR_NEW_TAG_TITLE')}</div>\n\t\t`;\n\t}\n\n\tgetNameInput(): HTMLInputElement\n\t{\n\t\treturn this.cache.remember('nameInput', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<input type=\"text\" \n\t\t\t\t\tclass=\"ui-ctl-element ui-ctl-textbox\" \n\t\t\t\t\tautocomplete=\"off\"\n\t\t\t\t\tvalue=\"${Text.encode(this.getValue())}\"\n\t\t\t\t\tplaceholder=\"${Text.encode(this.getPlaceholder())}\"\n\t\t\t\t\tonchange=\"${this.handleNameInputHiddenChange.bind(this)}\"\n\t\t\t\t>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetHiddenNameInput(): HTMLInputElement\n\t{\n\t\treturn this.cache.remember('hiddenNameInput', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<input\n\t\t\t\t \ttype=\"hidden\" \n\t\t\t\t\tname=\"${Text.encode(this.inputName)}\" \n\t\t\t\t\tvalue=\"${Text.encode(this.getValue())}\"\n\t\t\t\t>\n\t\t\t`;\n\t\t});\n\t}\n\n\thandleNameInputHiddenChange(event: UIEvent)\n\t{\n\t\tthis.getHiddenNameInput().value = event.target.value;\n\t}\n\n\tgetClearIcon(): HTMLElement\n\t{\n\t\treturn this.cache.remember('closeIcon', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<button\n\t\t\t\t\tclass=\"ui-ctl-after ui-ctl-icon-clear\" \n\t\t\t\t\tonclick=\"${this.handleClearIconClick.bind(this)}\"\n\t\t\t\t></button>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetArrowIcon(): HTMLElement\n\t{\n\t\treturn this.cache.remember('arrowIcon', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<a\n\t\t\t\t\thref=\"${this.model.getDetailPath()}\"\n\t\t\t\t\ttarget=\"_blank\"\n\t\t\t\t\tclass=\"ui-ctl-after ui-ctl-icon-forward\"\n\t\t\t\t></button>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetSearchIcon(): HTMLElement\n\t{\n\t\treturn this.cache.remember('searchIcon', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<button\n\t\t\t\t\tclass=\"ui-ctl-after ui-ctl-icon-search\"\n\t\t\t\t\tonclick=\"${this.handleSearchIconClick.bind(this)}\"\n\t\t\t\t></button>\n\t\t\t`;\n\t\t});\n\t}\n\n\tlayout(): HTMLElement\n\t{\n\t\tconst block = Tag.render`<div class=\"ui-ctl ui-ctl-w100 ui-ctl-after-icon\"></div>`;\n\n\t\tif (!Type.isStringFilled(this.getValue()))\n\t\t{\n\t\t\tthis.toggleIcon(this.getClearIcon(), 'none');\n\t\t}\n\n\t\tblock.appendChild(this.getClearIcon());\n\n\t\tif (this.showDetailLink() && Type.isStringFilled(this.getValue()))\n\t\t{\n\t\t\tthis.toggleIcon(this.getClearIcon(), 'none');\n\t\t\tthis.toggleIcon(this.getArrowIcon(), 'block');\n\t\t\tblock.appendChild(this.getArrowIcon());\n\t\t}\n\n\t\tif (this.isSearchEnabled())\n\t\t{\n\t\t\tconst iconValue = Type.isStringFilled(this.getValue()) ? 'none' : 'block';\n\t\t\tthis.toggleIcon(this.getSearchIcon(), iconValue);\n\t\t\tblock.appendChild(this.getSearchIcon());\n\n\t\t\tEvent.bind(this.getNameInput(), 'click', this.handleShowSearchDialog.bind(this));\n\t\t\tEvent.bind(this.getNameInput(), 'input', this.handleShowSearchDialog.bind(this));\n\t\t\tEvent.bind(this.getNameInput(), 'blur', this.handleNameInputBlur.bind(this));\n\t\t\tEvent.bind(this.getNameInput(), 'keydown', this.handleNameInputKeyDown.bind(this));\n\t\t}\n\n\t\tEvent.bind(this.getNameInput(), 'click', this.handleIconsSwitchingOnNameInput.bind(this));\n\t\tEvent.bind(this.getNameInput(), 'input', this.handleIconsSwitchingOnNameInput.bind(this));\n\n\t\tif (this.selector && this.selector.isSaveable())\n\t\t{\n\t\t\tEvent.bind(this.getNameInput(), 'change', this.handleNameInputChange.bind(this));\n\t\t}\n\n\t\tblock.appendChild(this.getNameBlock());\n\n\t\treturn block;\n\t}\n\n\tshowDetailLink(): string\n\t{\n\t\treturn this.isEnabledDetailLink;\n\t}\n\n\tgetDialog(): ?Dialog\n\t{\n\t\treturn this.cache.remember('dialog', () => {\n\t\t\treturn new Dialog({\n\t\t\t\tid: this.id,\n\t\t\t\theight: 300,\n\t\t\t\tcontext: 'catalog-products',\n\t\t\t\ttargetNode: this.getNameInput(),\n\t\t\t\tenableSearch: false,\n\t\t\t\tmultiple: false,\n\t\t\t\tdropdownMode: true,\n\t\t\t\tsearchTabOptions: {\n\t\t\t\t\tstub: true,\n\t\t\t\t\tstubOptions: {\n\t\t\t\t\t\ttitle: Tag.message`${'CATALOG_SELECTOR_IS_EMPTY_TITLE'}`,\n\t\t\t\t\t\tsubtitle: Tag.message`${'CATALOG_SELECTOR_IS_EMPTY_SUBTITLE'}`,\n\t\t\t\t\t\tarrow: true\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tsearchOptions: {\n\t\t\t\t\tallowCreateItem: true\n\t\t\t\t},\n\t\t\t\tevents: {\n\t\t\t\t\t'Item:onSelect': this.onProductSelect.bind(this),\n\t\t\t\t\t'Search:onItemCreateAsync': this.createProduct.bind(this)\n\t\t\t\t},\n\t\t\t\tentities: [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'product',\n\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\tiblockId: this.selector.getIblockId(),\n\t\t\t\t\t\t\tbasePriceId: this.selector.getBasePriceId()\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t});\n\t\t});\n\t}\n\n\thandleNameInputKeyDown(event: KeyboardEvent): void\n\t{\n\t\tconst dialog = this.getDialog();\n\t\tif (event.key === 'Enter' && dialog.getActiveTab() === dialog.getSearchTab())\n\t\t{\n\t\t\t// prevent a form submit\n\t\t\tevent.preventDefault();\n\n\t\t\tif ((Browser.isMac() && event.metaKey) || event.ctrlKey)\n\t\t\t{\n\t\t\t\tdialog.getSearchTab().getFooter().createItem();\n\t\t\t}\n\t\t}\n\t}\n\n\thandleIconsSwitchingOnNameInput(event: UIEvent): void\n\t{\n\t\tthis.toggleIcon(this.getArrowIcon(), 'none');\n\n\t\tif (Type.isStringFilled(event.target.value))\n\t\t{\n\t\t\tthis.toggleIcon(this.getClearIcon(), 'block');\n\t\t\tthis.toggleIcon(this.getSearchIcon(), 'none');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.toggleIcon(this.getClearIcon(), 'none');\n\t\t\tthis.toggleIcon(this.getSearchIcon(), 'block');\n\t\t}\n\t}\n\n\thandleClearIconClick(event: UIEvent)\n\t{\n\t\tif (this.selector.isProductSearchEnabled() && !this.isEmptyModel())\n\t\t{\n\t\t\tthis.selector.clearState();\n\t\t\tthis.selector.clearLayout();\n\t\t\tthis.selector.layout();\n\t\t\tthis.selector.searchInDialog();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.getNameInput().value = '';\n\t\t\tthis.toggleIcon(this.getClearIcon(), 'none');\n\t\t}\n\n\t\tthis.selector.focusName();\n\n\t\tthis.selector.emit('onClear', {\n\t\t\tselectorId: this.selector.getId(),\n\t\t\trowId: this.selector.getRowId()\n\t\t});\n\n\t\tevent.stopPropagation();\n\t\tevent.preventDefault();\n\t}\n\n\thandleNameInputChange(event: UIEvent)\n\t{\n\t\tconst value = event.target.value;\n\n\t\tEventEmitter.emit('ProductList::onChangeFields', {\n\t\t\trowId: this.selector.getRowId(),\n\t\t\tfields: {\n\t\t\t\t'NAME': value\n\t\t\t}\n\t\t});\n\t}\n\n\tfocusName()\n\t{\n\t\trequestAnimationFrame(() => this.getNameInput().focus());\n\t}\n\n\tsearchInDialog(searchQuery: string = '')\n\t{\n\t\tif (!this.selector.isProductSearchEnabled())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst dialog = this.getDialog();\n\t\tif (dialog)\n\t\t{\n\t\t\tdialog.show();\n\t\t\tdialog.search(searchQuery);\n\t\t}\n\t}\n\n\thandleShowSearchDialog(event: UIEvent)\n\t{\n\t\tif (this.isEmptyModel())\n\t\t{\n\t\t\tthis.selector.searchInDialog(event.target.value);\n\t\t}\n\t}\n\n\thandleNameInputBlur(event: UIEvent)\n\t{\n\t\t// timeout to toggle clear icon handler while cursor is inside of name input\n\t\tsetTimeout(() => {\n\t\t\tthis.toggleIcon(this.getClearIcon(), 'none');\n\n\t\t\tif (this.showDetailLink() && Type.isStringFilled(this.getValue()))\n\t\t\t{\n\t\t\t\tthis.toggleIcon(this.getSearchIcon(), 'none');\n\t\t\t\tthis.toggleIcon(this.getArrowIcon(), 'block');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.toggleIcon(this.getArrowIcon(), 'none');\n\t\t\t\tthis.toggleIcon(this.getSearchIcon(), 'block');\n\t\t\t}\n\t\t}, 200);\n\t}\n\n\thandleSearchIconClick(event: UIEvent)\n\t{\n\t\tthis.selector.searchInDialog();\n\t\tthis.selector.focusName();\n\n\t\tevent.stopPropagation();\n\t\tevent.preventDefault();\n\t}\n\n\tonProductSelect(event)\n\t{\n\t\tconst item = event.getData().item;\n\t\titem.getDialog().getTargetNode().value = item.getTitle();\n\t\tthis.toggleIcon(this.getSearchIcon(), 'none');\n\n\t\tif (this.selector)\n\t\t{\n\t\t\tthis.selector.onProductSelect(item.getId(), {\n\t\t\t\tsaveProductFields: item.getCustomData().get('saveProductFields'),\n\t\t\t\tisNew: item.getCustomData().get('isNew')\n\t\t\t});\n\t\t}\n\n\t\titem.getDialog().hide();\n\t}\n\n\tcreateProduct(event): Promise\n\t{\n\t\treturn new Promise(\n\t\t\t(resolve, reject) => {\n\t\t\t\tconst {searchQuery} = event.getData();\n\t\t\t\tconst dialog: Dialog = event.getTarget();\n\t\t\t\tconst fields = {\n\t\t\t\t\tNAME: searchQuery.getQuery(),\n\t\t\t\t\tIBLOCK_ID: this.selector.getIblockId()\n\t\t\t\t};\n\n\t\t\t\tdialog.showLoader();\n\t\t\t\tajax.runAction(\n\t\t\t\t\t'catalog.productSelector.createProduct',\n\t\t\t\t\t{\n\t\t\t\t\t\tjson: {\n\t\t\t\t\t\t\tfields\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t\t\t.then(response => {\n\t\t\t\t\t\tdialog.hideLoader();\n\t\t\t\t\t\tconst item = dialog.addItem({\n\t\t\t\t\t\t\tid: response.data.id,\n\t\t\t\t\t\t\tentityId: 'product',\n\t\t\t\t\t\t\ttitle: searchQuery.getQuery(),\n\t\t\t\t\t\t\ttabs: dialog.getRecentTab().getId(),\n\t\t\t\t\t\t\tcustomData: {\n\t\t\t\t\t\t\t\tsaveProductFields: true,\n\t\t\t\t\t\t\t\tisNew: true\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tif (item)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\titem.select();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tdialog.hide();\n\t\t\t\t\t\tresolve();\n\t\t\t\t\t})\n\t\t\t\t\t.catch(() => reject());\n\t\t\t});\n\t}\n\n\tgetPlaceholder(): string\n\t{\n\t\treturn (\n\t\t\tthis.isSearchEnabled() && this.isEmptyModel()\n\t\t\t\t? Loc.getMessage('CATALOG_SELECTOR_BEFORE_SEARCH_TITLE')\n\t\t\t\t: Loc.getMessage('CATALOG_SELECTOR_VIEW_NAME_TITLE')\n\t\t);\n\t}\n}\n","import {Runtime, Tag, Text, Type} from 'main.core';\nimport './component.css';\nimport {BaseEvent, EventEmitter} from \"main.core.events\";\nimport {ProductSelector} from 'catalog.product-selector';\n\nexport class ProductImageInput\n{\n\tconstructor(id, options = {})\n\t{\n\t\tthis.id = id || Text.getRandom();\n\t\tthis.selector = options.selector || null;\n\t\tif (!(this.selector instanceof ProductSelector))\n\t\t{\n\t\t\tthrow new Error('Product selector instance not found.');\n\t\t}\n\n\t\tthis.config = options.config || {};\n\t\tthis.setView(options.view);\n\n\t\tif (Type.isStringFilled(options.inputHtml))\n\t\t{\n\t\t\tthis.setInputHtml(options.inputHtml);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.restoreDefaultInputHtml();\n\t\t}\n\n\t\tthis.enableSaving = options.enableSaving;\n\n\t\tthis.uploaderFieldMap = {};\n\t\tif (this.isEnabledLiveSaving())\n\t\t{\n\t\t\tEventEmitter.subscribe('onUploaderIsInited', this.onUploaderIsInitedHandler.bind(this))\n\t\t}\n\t}\n\n\tonUploaderIsInitedHandler(event)\n\t{\n\t\tconst [id, uploader] = event.getCompatData();\n\t\tif (!this.isViewMode() && Type.isStringFilled(this.id) && this.id === id)\n\t\t{\n\t\t\tthis.uploaderFieldMap = {};\n\t\t\tEventEmitter.subscribe(uploader, 'onFileIsDeleted', this.onFileDelete.bind(this));\n\t\t\tEventEmitter.subscribe(uploader, 'onFileIsUploaded', this.onFileUpload.bind(this));\n\t\t\tEventEmitter.subscribe(uploader, 'onQueueIsChanged', this.onQueueIsChanged.bind(this));\n\t\t}\n\t}\n\n\tgetId()\n\t{\n\t\treturn this.id;\n\t}\n\n\tsetId(id)\n\t{\n\t\tthis.id = id;\n\t}\n\n\tsetView(html)\n\t{\n\t\tthis.view = Type.isStringFilled(html) ? html : '';\n\t}\n\n\tsetInputHtml(html)\n\t{\n\t\tthis.inputHtml = Type.isStringFilled(html) ? html : '';\n\t}\n\n\trestoreDefaultInputHtml()\n\t{\n\t\tthis.inputHtml = `\n\t\t\t<div class='ui-image-input-container ui-image-input-img--disabled'>\n\t\t\t\t<div class='adm-fileinput-wrapper '>\n\t\t\t\t\t<div class='adm-fileinput-area mode-pict adm-fileinput-drag-area'></div>\n\t\t\t\t</div>\n\t\t\t</div>\n`\t\t;\n\t}\n\n\tisViewMode(): boolean\n\t{\n\t\treturn this.selector && this.selector.isViewMode();\n\t}\n\n\tisEnabledLiveSaving(): boolean\n\t{\n\t\treturn this.enableSaving;\n\t}\n\n\tlayout()\n\t{\n\t\tconst imageContainer = Tag.render`<div></div>`;\n\n\t\tRuntime.html(imageContainer, this.isViewMode() ? this.view : this.inputHtml);\n\n\t\treturn imageContainer;\n\t}\n\n\tonFileDelete(event: BaseEvent)\n\t{\n\t\tconst [, , , file] = event.getCompatData();\n\t\tconst fileId = file.fileId;\n\n\t\tif (this.isViewMode() || !this.selector)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst deleteResult = this.selector.getModel().removeMorePhotoItem(fileId);\n\t\tif (deleteResult)\n\t\t{\n\t\t\tthis.save();\n\t\t}\n\t}\n\n\tonQueueIsChanged(event: BaseEvent)\n\t{\n\t\tconst [, type, itemId, uploaderItem] = event.getCompatData();\n\t\tconst image = uploaderItem.file;\n\n\t\tif (\n\t\t\ttype === 'add'\n\t\t\t&& 'input_name' in image\n\t\t\t&& Type.isNil(this.uploaderFieldMap[itemId])\n\t\t)\n\t\t{\n\t\t\tthis.uploaderFieldMap[itemId] = image['input_name'];\n\t\t}\n\t}\n\n\tonFileUpload(event: BaseEvent)\n\t{\n\t\tconst [itemId, , params] = event.getCompatData();\n\n\t\tif (!Type.isObject(params)\n\t\t\t|| !('file' in params)\n\t\t\t|| !('files' in params.file)\n\t\t\t|| !('default' in params.file.files)\n\t\t\t|| this.isViewMode()\n\t\t\t|| !this.selector\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst currentUploadedFile = params['file']['files']['default'];\n\t\tconst photoItem = {\n\t\t\tfileId: itemId,\n\t\t\tdata: {\n\t\t\t\tname: currentUploadedFile.name,\n\t\t\t\ttype: currentUploadedFile.type,\n\t\t\t\ttmp_name: currentUploadedFile.path,\n\t\t\t\tsize: currentUploadedFile.size,\n\t\t\t\terror: null\n\t\t\t}\n\t\t};\n\t\tconst fileFieldName = this.uploaderFieldMap[itemId] || itemId;\n\t\tthis.selector.getModel().addMorePhotoItem(fileFieldName, photoItem);\n\n\t\tthis.save(true);\n\t}\n\n\tsave(rebuild)\n\t{\n\t\tif (this.selector)\n\t\t{\n\t\t\tthis.selector.saveFiles(rebuild);\n\t\t}\n\t}\n}","import {Base} from \"./base\";\n\nexport class Empty extends Base\n{\n\tTYPE = 'empty';\n}","import {Text, Type} from \"main.core\";\nimport {Base} from './base';\n\nexport class Product extends Base\n{\n\tTYPE = 'product';\n\n\tisSaveable(): boolean\n\t{\n\t\treturn this.getConfig('saveProductFields', false);\n\t}\n\n\tgetType(): string\n\t{\n\t\treturn Product.TYPE;\n\t}\n\n\tisEnableFileSaving(): boolean\n\t{\n\t\treturn true;\n\t}\n\n\tgetDetailPath(): string\n\t{\n\t\treturn this.getConfig('DETAIL_PATH', '');\n\t}\n\n\tremoveMorePhotoItem(fileId): boolean\n\t{\n\t\tfor (const index in this.morePhoto)\n\t\t{\n\t\t\tlet value = this.morePhoto[index];\n\n\t\t\tif (!Type.isObject(value))\n\t\t\t{\n\t\t\t\tvalue = Text.toInteger(value);\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\t(Type.isNumber(value) && value === Text.toInteger(fileId))\n\t\t\t\t|| (Type.isObject(value) && value.fileId === fileId)\n\t\t\t)\n\t\t\t{\n\t\t\t\tdelete this.morePhoto[index];\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t}\n}","import {Product} from \"./product\";\n\nexport class Sku extends Product\n{\n\tTYPE = 'sku';\n\n\tgetFileType(): string\n\t{\n\t\treturn (this.config.fileType === Product.TYPE) ? Product.TYPE : Sku.TYPE;\n\t}\n\n\tgetProductId()\n\t{\n\t\treturn this.getConfig('productId');\n\t}\n}","import {ajax, Cache, Dom, Event, Loc, Runtime, Tag, Text, Type} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport {SkuTree} from 'catalog.sku-tree';\nimport {ProductSearchInput} from \"./product-search-input\";\nimport {ProductImageInput} from \"./product-image-input\";\nimport {Empty} from \"./models/empty\";\nimport {Sku} from \"./models/sku\";\nimport {Product} from \"./models/product\";\nimport {Base} from \"./models/base\";\nimport 'ui.forms';\nimport './component.css';\n\nconst instances = new Map();\n\nexport class ProductSelector extends EventEmitter\n{\n\tstatic MODE_VIEW = 'view';\n\tstatic MODE_EDIT = 'edit';\n\n\tstatic PRODUCT_TYPE = 'product';\n\tstatic SKU_TYPE = 'sku';\n\n\tmode: ProductSelector.MODE_EDIT | ProductSelector.MODE_VIEW = ProductSelector.MODE_EDIT;\n\tcache = new Cache.MemoryCache();\n\tfileInput: ?ProductImageInput;\n\tsearchInput: ?ProductSearchInput;\n\tskuTreeInstance: ?SkuTree;\n\n\tvariationChangeHandler = this.handleVariationChange.bind(this);\n\n\tstatic getById(id: string): ?ProductSelector\n\t{\n\t\treturn instances.get(id) || null;\n\t}\n\n\tconstructor(id, options = {})\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Catalog.ProductSelector');\n\n\t\tthis.id = id || Text.getRandom();\n\t\tthis.options = options || {};\n\n\t\tthis.iblockId = Text.toNumber(options.iblockId);\n\t\tthis.basePriceId = Text.toNumber(options.basePriceId);\n\n\t\tthis.setMode(options.mode);\n\n\t\tthis.model = this.createModel(options);\n\t\tthis.model.setFields(options.fields);\n\t\tthis.model.setMorePhotoValues(options.morePhotoValues);\n\t\tthis.model.setDetailPath(this.getConfig('DETAIL_PATH'));\n\n\t\tthis.skuTree = options.skuTree || null;\n\t\tthis.setFileType(options.fileType);\n\n\t\tthis.layout();\n\n\t\tEventEmitter.subscribe('ProductList::onChangeFields', Runtime.debounce(this.onChangeFields, 500, this));\n\n\t\tinstances.set(this.id, this);\n\t}\n\n\tcreateModel(options = {}): Base\n\t{\n\t\tconst productId = Text.toInteger(options.productId) || 0;\n\t\tif (productId <= 0)\n\t\t{\n\t\t\treturn new Empty();\n\t\t}\n\n\t\tconst modelConfig = options?.config?.MODEL_CONFIG || {};\n\t\tconst skuId = Text.toInteger(options.skuId) || 0;\n\t\tif (skuId > 0 && skuId !== productId)\n\t\t{\n\t\t\treturn new Sku(skuId, {...modelConfig, ...{productId}});\n\t\t}\n\n\t\treturn new Product(productId, modelConfig);\n\t}\n\n\tgetModel(): Base\n\t{\n\t\treturn this.model;\n\t}\n\n\tsetMode(mode): void\n\t{\n\t\tif (!Type.isNil(mode))\n\t\t{\n\t\t\tthis.mode = mode === ProductSelector.MODE_VIEW ? ProductSelector.MODE_VIEW : ProductSelector.MODE_EDIT;\n\t\t}\n\t}\n\n\tsetFileType(fileType): void\n\t{\n\t\tthis.fileType = fileType === ProductSelector.SKU_TYPE ? ProductSelector.SKU_TYPE : ProductSelector.PRODUCT_TYPE;\n\t}\n\n\tisViewMode(): boolean\n\t{\n\t\treturn this.mode === ProductSelector.MODE_VIEW;\n\t}\n\n\tisSaveable(): boolean\n\t{\n\t\treturn !this.isViewMode() && this.model.isSaveable();\n\t}\n\n\tgetId(): string\n\t{\n\t\treturn this.id;\n\t}\n\n\tgetIblockId(): number\n\t{\n\t\treturn this.iblockId;\n\t}\n\n\tgetBasePriceId(): number\n\t{\n\t\treturn this.basePriceId;\n\t}\n\n\tgetConfig(name, defaultValue)\n\t{\n\t\treturn BX.prop.get(this.options.config, name, defaultValue);\n\t}\n\n\tgetRowId(): string\n\t{\n\t\treturn this.getConfig('ROW_ID');\n\t}\n\n\tgetFileInput(): ProductImageInput\n\t{\n\t\tif (!this.fileInput)\n\t\t{\n\t\t\tthis.fileInput = new ProductImageInput(\n\t\t\t\tthis.options.fileInputId,\n\t\t\t\t{\n\t\t\t\t\tselector: this,\n\t\t\t\t\tview: this.options.fileView,\n\t\t\t\t\tinputHtml: this.options.fileInput,\n\t\t\t\t\tenableSaving: this.getConfig('ENABLE_IMAGE_CHANGE_SAVING', false)\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\treturn this.fileInput;\n\t}\n\n\tisProductFileType(): boolean\n\t{\n\t\treturn this.fileType === ProductSelector.PRODUCT_TYPE;\n\t}\n\n\tisProductSearchEnabled(): boolean\n\t{\n\t\treturn this.getConfig('ENABLE_SEARCH', false) && this.getIblockId() > 0;\n\t}\n\n\tisInputDetailLinkEnabled(): boolean\n\t{\n\t\treturn this.getConfig('ENABLE_INPUT_DETAIL_LINK', false) && Type.isStringFilled(this.model.getDetailPath());\n\t}\n\n\tgetWrapper(): HTMLElement\n\t{\n\t\tthis.wrapper = document.getElementById(this.id);\n\n\t\treturn this.wrapper;\n\t}\n\n\trenderTo(node)\n\t{\n\t\tthis.clearLayout();\n\t\tthis.wrapper = node;\n\t\tthis.layout();\n\t}\n\n\tlayout()\n\t{\n\t\tconst wrapper = this.getWrapper();\n\t\tif (!wrapper)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.defineWrapperClass(wrapper);\n\t\tthis.layoutImage();\n\n\t\tconst block = Tag.render`<div class=\"catalog-product-field-inner\"></div>`;\n\t\twrapper.appendChild(block);\n\t\tblock.appendChild(this.layoutNameBlock());\n\t\tblock.appendChild(this.getImageContainer());\n\n\t\tthis.layoutSkuTree();\n\t\tthis.subscribeToVariationChange();\n\t}\n\n\tfocusName(): this\n\t{\n\t\tif (this.searchInput)\n\t\t{\n\t\t\tthis.searchInput.focusName();\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tsearchInDialog(searchQuery: string = ''): this\n\t{\n\t\tif (this.searchInput)\n\t\t{\n\t\t\tthis.searchInput.searchInDialog(searchQuery);\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tgetImageContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('imageContainer', () => (\n\t\t\tTag.render`<div class=\"catalog-product-img\"></div>`\n\t\t));\n\t}\n\n\tlayoutImage()\n\t{\n\t\tthis.getImageContainer().innerHTML = '';\n\t\tthis.getImageContainer().appendChild(this.getFileInput().layout());\n\t\tthis.refreshImageSelectorId = null;\n\t}\n\n\tclearState(): void\n\t{\n\t\tthis.model = this.createModel();\n\t\tthis.fileInput.setInputHtml(this.options.fileInput || '');\n\t\tthis.skuTree = null;\n\t\tthis.skuTreeInstance = null;\n\t\tthis.refreshImageSelectorId = null;\n\t}\n\n\tclearLayout(): void\n\t{\n\t\tconst wrapper = this.getWrapper();\n\t\tif (wrapper)\n\t\t{\n\t\t\tEvent.unbindAll(wrapper);\n\t\t\twrapper.innerHTML = '';\n\t\t}\n\n\t\tthis.unsubscribeToVariationChange();\n\t}\n\n\tdefineWrapperClass(wrapper)\n\t{\n\t\tif (this.isViewMode())\n\t\t{\n\t\t\tDom.addClass(wrapper, 'catalog-product-view');\n\t\t\tDom.removeClass(wrapper, 'catalog-product-edit');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.addClass(wrapper, 'catalog-product-edit');\n\t\t\tDom.removeClass(wrapper, 'catalog-product-view');\n\t\t}\n\t}\n\n\tgetNameBlockView(): HTMLElement\n\t{\n\t\tconst productName = Text.encode(this.model.getField('NAME'));\n\t\tconst namePlaceholder = Loc.getMessage('CATALOG_SELECTOR_VIEW_NAME_TITLE');\n\n\t\tif (this.getModel().getDetailPath())\n\t\t{\n\t\t\treturn Tag.render`\n\t\t\t\t<a href=\"${this.getModel().getDetailPath()}\" title=\"${namePlaceholder}\">${productName}</a>\n\t\t\t`;\n\t\t}\n\n\t\treturn Tag.render`<span title=\"${namePlaceholder}\">${productName}</span>`;\n\n\t}\n\n\tlayoutNameBlock(): HTMLElement\n\t{\n\t\tconst block = Tag.render`<div class=\"catalog-product-field-input\"></div>`;\n\n\t\tif (this.isViewMode())\n\t\t{\n\t\t\tblock.appendChild(this.getNameBlockView());\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.searchInput = new ProductSearchInput(this.id, {\n\t\t\t\tselector: this,\n\t\t\t\tmodel: this.getModel(),\n\t\t\t\tinputName: 'NAME',\n\t\t\t\tisSearchEnabled: this.isProductSearchEnabled(),\n\t\t\t\tiblockId: this.getIblockId(),\n\t\t\t\tbasePriceId: this.getBasePriceId(),\n\t\t\t\tisEnabledDetailLink: this.isInputDetailLinkEnabled()\n\t\t\t});\n\t\t\tblock.appendChild(this.searchInput.layout());\n\t\t}\n\n\t\treturn block;\n\t}\n\n\tupdateSkuTree(tree): void\n\t{\n\t\tthis.skuTree = tree;\n\t\tthis.skuTreeInstance = null;\n\t}\n\n\tgetSkuTreeInstance(): SkuTree\n\t{\n\t\tif (this.skuTree && !this.skuTreeInstance)\n\t\t{\n\t\t\tthis.skuTreeInstance = new SkuTree({\n\t\t\t\tskuTree: this.skuTree,\n\t\t\t\tselectable: this.getConfig('ENABLE_SKU_SELECTION', true)\n\t\t\t});\n\t\t}\n\n\t\treturn this.skuTreeInstance;\n\t}\n\n\tlayoutSkuTree(): void\n\t{\n\t\tconst skuTree = this.getSkuTreeInstance();\n\t\tconst wrapper = this.getWrapper();\n\n\t\tif (skuTree && wrapper)\n\t\t{\n\t\t\twrapper.appendChild(skuTree.layout());\n\t\t}\n\t}\n\n\tsubscribeToVariationChange()\n\t{\n\t\tconst skuTree = this.getSkuTreeInstance();\n\t\tif (skuTree)\n\t\t{\n\t\t\tskuTree.subscribe('SkuProperty::onChange', this.variationChangeHandler);\n\t\t}\n\t}\n\n\tunsubscribeToVariationChange()\n\t{\n\t\tconst skuTree = this.getSkuTreeInstance();\n\t\tif (skuTree)\n\t\t{\n\t\t\tskuTree.unsubscribe('SkuProperty::onChange', this.variationChangeHandler);\n\t\t}\n\t}\n\n\thandleVariationChange(event)\n\t{\n\t\tconst [skuFields] = event.getData();\n\t\tconst productId = Text.toNumber(skuFields.PARENT_PRODUCT_ID);\n\t\tconst variationId = Text.toNumber(skuFields.ID);\n\n\t\tif (productId <= 0 || variationId <= 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.model.setSaveable(false);\n\t\tthis.emit('onBeforeChange', {\n\t\t\tselectorId: this.getId(),\n\t\t\trowId: this.getRowId()\n\t\t});\n\n\t\tajax.runAction(\n\t\t\t'catalog.productSelector.getSelectedSku',\n\t\t\t{\n\t\t\t\tjson: {\n\t\t\t\t\tvariationId,\n\t\t\t\t\toptions: {\n\t\t\t\t\t\tpriceId: this.basePriceId,\n\t\t\t\t\t\turlBuilder: this.getConfig('URL_BUILDER_CONTEXT')\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t)\n\t\t\t.then(response => this.processResponse(response, {...this.options.config}));\n\t}\n\n\tonChangeFields(event)\n\t{\n\t\tconst eventData = event.getData();\n\n\t\tif (!this.isSaveable() || eventData.rowId !== this.getRowId())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (!Type.isNil(eventData.productId) && eventData.productId !== this.getModel().getProductId())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst fields = eventData.fields;\n\t\tconst priceValue = Text.toNumber(fields.PRICE);\n\t\tif (priceValue > 0 && Type.isStringFilled(fields.CURRENCY))\n\t\t{\n\t\t\tfields.PRICES = {};\n\t\t\tfields.PRICES[this.getBasePriceId()] = {\n\t\t\t\tPRICE: priceValue,\n\t\t\t\tCURRENCY: fields.CURRENCY\n\t\t\t};\n\t\t}\n\n\t\tthis.updateProduct(fields);\n\t}\n\n\tupdateProduct(fields)\n\t{\n\t\tif (!Type.isPlainObject(fields))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.getModel().getId() <= 0 || this.getIblockId() <= 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tajax.runAction(\n\t\t\t'catalog.productSelector.updateProduct',\n\t\t\t{\n\t\t\t\tjson: {\n\t\t\t\t\tid: this.getModel().getId(),\n\t\t\t\t\tiblockId: this.getIblockId(),\n\t\t\t\t\tupdateFields: fields\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t}\n\n\tsaveFiles(rebuild)\n\t{\n\t\tconst imageValues = this.getModel().getMorePhotoValues();\n\t\tif (this.submitFileTimeOut)\n\t\t{\n\t\t\tclearTimeout(this.submitFileTimeOut);\n\t\t}\n\n\t\tconst requestId = Text.getRandom(20);\n\t\tthis.refreshImageSelectorId = requestId;\n\t\tthis.submitFileTimeOut = setTimeout(() => {\n\t\t\tajax.runAction(\n\t\t\t\t'catalog.productSelector.saveMorePhoto',\n\t\t\t\t{\n\t\t\t\t\tjson: {\n\t\t\t\t\t\tproductId: this.model.getProductId(),\n\t\t\t\t\t\tvariationId: this.model.getId(),\n\t\t\t\t\t\tiblockId: this.getIblockId(),\n\t\t\t\t\t\timageValues\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t).then((response) => {\n\t\t\t\tif (!rebuild && this.refreshImageSelectorId === requestId)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis.getFileInput().setId(response.data.id);\n\t\t\t\tthis.getFileInput().setInputHtml(response.data.input);\n\t\t\t\tthis.getFileInput().setView(response.data.preview);\n\t\t\t\tthis.getModel().setMorePhotoValues(response.data.values);\n\t\t\t\tthis.layoutImage();\n\t\t\t});\n\t\t}, 500);\n\t}\n\n\tonProductSelect(productId, itemConfig)\n\t{\n\t\tthis.emit('onBeforeChange', {\n\t\t\tselectorId: this.getId(),\n\t\t\trowId: this.getRowId()\n\t\t});\n\n\t\tthis.productSelectAjaxAction(productId, itemConfig);\n\t}\n\n\tproductSelectAjaxAction(\n\t\tproductId,\n\t\titemConfig = {\n\t\t\tsaveProductFields: false,\n\t\t\tisNew: false\n\t\t}\n\t)\n\t{\n\t\tajax\n\t\t\t.runAction(\n\t\t\t\t'catalog.productSelector.getProduct',\n\t\t\t\t{\n\t\t\t\t\tjson: {\n\t\t\t\t\t\tproductId,\n\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\tpriceId: this.basePriceId,\n\t\t\t\t\t\t\turlBuilder: this.getConfig('URL_BUILDER_CONTEXT')\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t)\n\t\t\t.then(response => this.processResponse(response, {...this.options.config, ...itemConfig}, true));\n\t}\n\n\tprocessResponse(response, config = {}, isProductAction = false)\n\t{\n\t\tconst data = response?.data || null;\n\n\t\tif (data)\n\t\t{\n\t\t\tthis.changeSelectedElement(data, config);\n\t\t}\n\t\telse if (isProductAction)\n\t\t{\n\t\t\tthis.clearState();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.productSelectAjaxAction(this.getModel().getProductId());\n\t\t}\n\n\t\tthis.unsubscribeToVariationChange();\n\n\t\tthis.clearLayout();\n\t\tthis.layout();\n\n\t\tconst fields = data?.fields || null;\n\n\t\tthis.emit('onChange', {\n\t\t\tselectorId: this.id,\n\t\t\trowId: this.getRowId(),\n\t\t\tisNew: config.isNew || false,\n\t\t\tfields\n\t\t});\n\t}\n\n\tchangeSelectedElement(data, config)\n\t{\n\t\tconst productId = Text.toInteger(data.productId);\n\t\tconst productChanged = this.getModel().getId() !== productId;\n\n\t\tif (productChanged)\n\t\t{\n\t\t\tconst skuId = Text.toInteger(data.skuId);\n\t\t\tif (skuId > 0 && skuId !== productId)\n\t\t\t{\n\t\t\t\tconfig.productId = productId;\n\t\t\t\tthis.model = new Sku(skuId, config);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.model = new Product(productId, config);\n\t\t\t}\n\t\t}\n\n\t\tthis.getModel().setFields(data.fields);\n\n\t\tconst imageField = {\n\t\t\tid: '',\n\t\t\tinput: '',\n\t\t\tpreview: '',\n\t\t\tvalues: []\n\t\t};\n\n\t\tif (Type.isObject(data.image))\n\t\t{\n\t\t\timageField.id = data.image.id;\n\t\t\timageField.input = data.image.input;\n\t\t\timageField.preview = data.image.preview;\n\t\t\timageField.values = data.image.values;\n\t\t\tthis.getModel().setFileType(data.fileType);\n\t\t}\n\n\t\tthis.getFileInput().setId(imageField.id);\n\t\tthis.getFileInput().setInputHtml(imageField.input);\n\t\tthis.getFileInput().setView(imageField.preview);\n\n\t\tthis.getModel().setMorePhotoValues(imageField.values);\n\n\t\tif (data.detailUrl)\n\t\t{\n\t\t\tthis.getModel().setDetailPath(data.detailUrl);\n\t\t}\n\n\t\tif (Type.isObject(data.skuTree))\n\t\t{\n\t\t\tthis.updateSkuTree(data.skuTree);\n\t\t}\n\t}\n}\n"],"names":["Base","id","config","Text","getRandom","setMorePhotoValues","morePhoto","setFields","fields","value","saveProductFields","getConfig","name","defaultValue","BX","prop","get","TYPE","fieldName","Type","isObject","values","isPlainObject","fileId","getType","fileType","DETAIL_PATH","ProductSearchInput","options","Cache","MemoryCache","selector","ProductSelector","Error","model","isEnabledSearch","isSearchEnabled","isEnabledDetailLink","inputName","getField","icon","isDomNode","Dom","style","Tag","render","getNameTag","getNameInput","getHiddenNameInput","isNew","Loc","getMessage","cache","remember","encode","getValue","getPlaceholder","handleNameInputHiddenChange","bind","event","target","handleClearIconClick","getDetailPath","handleSearchIconClick","block","isStringFilled","toggleIcon","getClearIcon","appendChild","showDetailLink","getArrowIcon","iconValue","getSearchIcon","Event","handleShowSearchDialog","handleNameInputBlur","handleNameInputKeyDown","handleIconsSwitchingOnNameInput","isSaveable","handleNameInputChange","getNameBlock","Dialog","height","context","targetNode","enableSearch","multiple","dropdownMode","searchTabOptions","stub","stubOptions","title","message","subtitle","arrow","searchOptions","allowCreateItem","events","onProductSelect","createProduct","entities","iblockId","getIblockId","basePriceId","getBasePriceId","dialog","getDialog","key","getActiveTab","getSearchTab","preventDefault","Browser","isMac","metaKey","ctrlKey","getFooter","createItem","isProductSearchEnabled","isEmptyModel","clearState","clearLayout","layout","searchInDialog","focusName","emit","selectorId","getId","rowId","getRowId","stopPropagation","EventEmitter","requestAnimationFrame","focus","searchQuery","show","search","setTimeout","item","getData","getTargetNode","getTitle","getCustomData","hide","Promise","resolve","reject","getTarget","NAME","getQuery","IBLOCK_ID","showLoader","ajax","runAction","json","then","response","hideLoader","addItem","data","entityId","tabs","getRecentTab","customData","select","catch","ProductImageInput","setView","view","inputHtml","setInputHtml","restoreDefaultInputHtml","enableSaving","uploaderFieldMap","isEnabledLiveSaving","subscribe","onUploaderIsInitedHandler","getCompatData","uploader","isViewMode","onFileDelete","onFileUpload","onQueueIsChanged","html","imageContainer","Runtime","file","deleteResult","getModel","removeMorePhotoItem","save","type","itemId","uploaderItem","image","isNil","params","files","currentUploadedFile","photoItem","tmp_name","path","size","error","fileFieldName","addMorePhotoItem","rebuild","saveFiles","Empty","Product","index","toInteger","isNumber","Sku","instances","Map","MODE_EDIT","handleVariationChange","setEventNamespace","toNumber","setMode","mode","createModel","morePhotoValues","setDetailPath","skuTree","setFileType","debounce","onChangeFields","set","productId","modelConfig","MODEL_CONFIG","skuId","MODE_VIEW","SKU_TYPE","PRODUCT_TYPE","fileInput","fileInputId","fileView","wrapper","document","getElementById","node","getWrapper","defineWrapperClass","layoutImage","layoutNameBlock","getImageContainer","layoutSkuTree","subscribeToVariationChange","searchInput","innerHTML","getFileInput","refreshImageSelectorId","skuTreeInstance","unbindAll","unsubscribeToVariationChange","addClass","removeClass","productName","namePlaceholder","getNameBlockView","isInputDetailLinkEnabled","tree","SkuTree","selectable","getSkuTreeInstance","variationChangeHandler","unsubscribe","skuFields","PARENT_PRODUCT_ID","variationId","ID","setSaveable","priceId","urlBuilder","processResponse","eventData","getProductId","priceValue","PRICE","CURRENCY","PRICES","updateProduct","updateFields","imageValues","getMorePhotoValues","submitFileTimeOut","clearTimeout","requestId","setId","input","preview","itemConfig","productSelectAjaxAction","isProductAction","changeSelectedElement","productChanged","imageField","detailUrl","updateSkuTree"],"mappings":"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"}