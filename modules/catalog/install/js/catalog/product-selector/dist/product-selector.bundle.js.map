{"version":3,"file":"product-selector.bundle.js","sources":["../src/product-search-selector-footer.js","../src/product-creation-limited-footer.js","../src/selector-error-code.js","../src/product-search-input.js","../src/product-image-input.js","../src/barcode-search-selector-footer.js","../src/barcode-search-input.js","../src/product-selector.js"],"sourcesContent":["import {DefaultFooter, Dialog} from 'ui.entity-selector';\nimport {Dom, Loc, Tag, Type} from 'main.core';\nimport {BaseEvent} from \"main.core.events\";\nimport {Loader} from \"main.loader\";\nimport {ProductSelector} from \"catalog.product-selector\";\n\nexport default class ProductSearchSelectorFooter extends DefaultFooter\n{\n\tloader: Loader = null;\n\n\tconstructor(dialog: Dialog, options: { [option: string]: any })\n\t{\n\t\tsuper(dialog, options);\n\n\t\tthis.errorAdminHint = options.errorAdminHint || '';\n\t\tthis.getDialog().subscribe('onSearch', this.handleOnSearch.bind(this));\n\t}\n\n\tgetContent(): HTMLElement\n\t{\n\t\tlet phrase = '';\n\n\t\tconst isViewCreateButton = this.options.allowCreateItem === true || this.options.allowEditItem === false;\n\n\t\tif (this.isViewEditButton() && isViewCreateButton)\n\t\t{\n\t\t\tphrase = Tag.render`\n\t\t\t\t<div>${Loc.getMessage('CATALOG_SELECTOR_SEARCH_POPUP_FOOTER_1')}</div>\n\t\t\t`;\n\n\t\t\tconst createButton = phrase.querySelector('create-button');\n\t\t\tDom.replace(createButton, this.getLabelContainer());\n\n\t\t\tconst changeButton = phrase.querySelector('change-button');\n\t\t\tDom.replace(changeButton, this.getSaveContainer());\n\t\t}\n\t\telse if (this.isViewEditButton())\n\t\t{\n\t\t\tphrase = this.getSaveContainer();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tphrase = this.getLabelContainer();\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"ui-selector-search-footer-box\">\n\t\t\t\t${phrase}\n\t\t\t\t${this.getHintContainer()}\n\t\t\t\t${this.getLoaderContainer()}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tisViewEditButton(): boolean\n\t{\n\t\treturn this.options.allowEditItem === true;\n\t}\n\n\tgetLoader(): Loader\n\t{\n\t\tif (Type.isNil(this.loader))\n\t\t{\n\t\t\tthis.loader = new Loader({\n\t\t\t\ttarget: this.getLoaderContainer(),\n\t\t\t\tsize: 17,\n\t\t\t\tcolor: 'rgba(82, 92, 105, 0.9)'\n\t\t\t});\n\t\t}\n\n\t\treturn this.loader;\n\t}\n\n\tshowLoader(): void\n\t{\n\t\tvoid this.getLoader().show();\n\t}\n\n\thideLoader(): void\n\t{\n\t\tvoid this.getLoader().hide();\n\t}\n\n\tsetLabel(label: string)\n\t{\n\t\tif (Type.isString(label))\n\t\t{\n\t\t\tthis.getLabelContainer().textContent = label;\n\t\t}\n\t}\n\n\tgetLabelContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('label', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<span>\n\t\t\t\t\t<span onclick=\"${this.handleClick.bind(this)}\" class=\"ui-selector-footer-link  ui-selector-footer-link-add\">\n\t\t\t\t\t\t${\n\t\t\t\t\t\t\tthis.getOption('creationLabel', Loc.getMessage('CATALOG_SELECTOR_SEARCH_POPUP_FOOTER_CREATE'))\n\t\t\t\t\t\t}\n\t\t\t\t\t</span>\n\t\t\t\t\t${this.getQueryContainer()}\n\t\t\t\t</span>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetQueryContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('name-container', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<span class=\"ui-selector-search-footer-query\"></span>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetSaveContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('save-container', () => {\n\t\t\tconst className = `ui-selector-footer-link`;\n\n\t\t\tconst messageId =\n\t\t\t\t(this.options.inputName === ProductSelector.INPUT_FIELD_BARCODE)\n\t\t\t\t\t? 'CATALOG_SELECTOR_SEARCH_POPUP_FOOTER_BARCODE_CHANGE'\n\t\t\t\t\t: 'CATALOG_SELECTOR_SEARCH_POPUP_FOOTER_CHANGE'\n\t\t\t;\n\n\t\t\treturn Tag.render`\n\t\t\t<span class=\"${className}\" onclick=\"${this.onClickSaveChanges.bind(this)}\">\n\t\t\t\t${Loc.getMessage(messageId)}\n\t\t\t</span>\n\t\t`;\n\t\t});\n\t}\n\n\tgetLoaderContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('loader', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-selector-search-footer-loader\"></div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetHintContainer(): ?HTMLElement\n\t{\n\t\treturn this.cache.remember('hint', () => {\n\t\t\tlet message = null;\n\t\t\tif (!this.options.allowEditItem && !this.options.allowCreateItem)\n\t\t\t{\n\t\t\t\tmessage = Loc.getMessage('CATALOG_SELECTOR_SEARCH_POPUP_DISABLED_FOOTER_ALL_HINT', {\n\t\t\t\t\t'#ADMIN_HINT#': this.errorAdminHint\n\t\t\t\t});\n\t\t\t}\n\t\t\telse if (!this.options.allowEditItem)\n\t\t\t{\n\t\t\t\tmessage = Loc.getMessage('CATALOG_SELECTOR_SEARCH_POPUP_DISABLED_FOOTER_EDIT_HINT', {\n\t\t\t\t\t'#ADMIN_HINT#': this.errorAdminHint\n\t\t\t\t});\n\t\t\t}\n\t\t\telse if (!this.options.allowCreateItem)\n\t\t\t{\n\t\t\t\tmessage = Loc.getMessage('CATALOG_SELECTOR_SEARCH_POPUP_DISABLED_FOOTER_ADD_HINT', {\n\t\t\t\t\t'#ADMIN_HINT#': this.errorAdminHint\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (!message)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tconst hintNode = Tag.render`<span class=\"ui-btn ui-btn-icon-lock ui-btn-link\"></span>`;\n\t\t\thintNode.dataset.hint = message;\n\t\t\thintNode.dataset.hintNoIcon = true;\n\n\t\t\tBX.UI.Hint.initNode(hintNode);\n\n\t\t\treturn Tag.render`<div class=\"product-search-selector-disabled-footer-hint\">${hintNode}</div>`;\n\t\t});\n\t}\n\n\tonClickSaveChanges()\n\t{\n\t\tif (!this.options.allowEditItem)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst lastQuery = this.getDialog().getActiveTab().getLastSearchQuery();\n\t\tthis.getDialog().emit('ChangeItem:onClick', { query: lastQuery.query });\n\t\tthis.getDialog().clearSearch();\n\t\tthis.getDialog().hide();\n\t}\n\n\tcreateItem(): void\n\t{\n\t\tif (!this.options.allowCreateItem)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst tagSelector = this.getDialog().getTagSelector();\n\t\tif (tagSelector && tagSelector.isLocked())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst finalize = () => {\n\t\t\tthis.hideLoader();\n\t\t\tif (this.getDialog().getTagSelector())\n\t\t\t{\n\t\t\t\tthis.getDialog().getTagSelector().unlock();\n\t\t\t\tthis.getDialog().focusSearch();\n\t\t\t}\n\t\t};\n\n\t\tevent.preventDefault();\n\t\tthis.showLoader();\n\n\t\tif (tagSelector)\n\t\t{\n\t\t\ttagSelector.lock();\n\t\t}\n\n\t\tthis.getDialog()\n\t\t\t.emitAsync('Search:onItemCreateAsync', {\n\t\t\t\tsearchQuery: this.getDialog().getActiveTab().getLastSearchQuery()\n\t\t\t})\n\t\t\t.then(() => {\n\t\t\t\tthis.getTab().clearResults();\n\t\t\t\tthis.getDialog().clearSearch();\n\t\t\t\tif (this.getDialog().getActiveTab() === this.getTab())\n\t\t\t\t{\n\t\t\t\t\tthis.getDialog().selectFirstTab();\n\t\t\t\t}\n\n\t\t\t\tfinalize();\n\t\t\t})\n\t\t\t.catch(() => {\n\t\t\t\tfinalize();\n\t\t\t})\n\t\t;\n\t}\n\n\thandleClick(): void\n\t{\n\t\tthis.createItem();\n\t}\n\n\thandleOnSearch(event: BaseEvent): void\n\t{\n\t\tconst { query } = event.getData();\n\n\t\tif (this.options.currentValue === query || query === '')\n\t\t{\n\t\t\tthis.hide();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.show();\n\t\t}\n\n\t\tthis.getQueryContainer().textContent = \" \" + query;\n\t}\n}\n","import {DefaultFooter} from 'ui.entity-selector';\nimport {Event, Loc, Tag} from 'main.core';\nimport 'ui.info-helper';\n\nexport default class ProductCreationLimitedFooter extends DefaultFooter\n{\n\tgetContent(): HTMLElement\n\t{\n\t\tconst phrase = Tag.render`\n\t\t\t<div>${Loc.getMessage('CATALOG_SELECTOR_LIMITED_PRODUCT_CREATION')}</div>\n\t\t`;\n\n\t\tconst infoButton = Tag.render`\n\t\t\t<a class=\"ui-btn ui-btn-sm ui-btn-primary ui-btn-hover ui-btn-round\">\n\t\t\t\t${Loc.getMessage('CATALOG_SELECTOR_LICENSE_EXPLODE')}\n\t\t\t</a>\n\t\t`;\n\n\t\tEvent.bind(infoButton, 'click', () => {\n\t\t\tBX.UI.InfoHelper.show('limit_shop_products');\n\t\t});\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"ui-selector-search-footer-box\">\n\t\t\t\t<div class=\"ui-selector-search-footer-box\">\n\t\t\t\t\t<div class=\"tariff-lock\"></div>\n\t\t\t\t\t${phrase}\n\t\t\t\t</div>\n\t\t\t\t<div>\n\t\t\t\t\t${infoButton}\n\t\t\t\t</div>\t\t\t\t\n\t\t\t</div>\n\t\t`;\n\t}\n}","export class SelectorErrorCode\n{\n\tstatic NOT_SELECTED_PRODUCT: string = 'NOT_SELECTED_PRODUCT';\n\tstatic FAILED_PRODUCT: string = 'FAILED_PRODUCT';\n}","import {ajax, Browser, Cache, Dom, Event, Extension, Loc, Runtime, Tag, Text, Type} from 'main.core';\nimport {Dialog, Item} from 'ui.entity-selector';\nimport './component.css';\nimport {EventEmitter} from 'main.core.events';\nimport {ProductModel} from 'catalog.product-model';\nimport {ProductSelector} from 'catalog.product-selector';\nimport ProductSearchSelectorFooter from './product-search-selector-footer';\nimport ProductCreationLimitedFooter from './product-creation-limited-footer';\nimport {SelectorErrorCode} from './selector-error-code';\nimport 'ui.notification';\n\nclass DialogMode\n{\n\tstatic SEARCHING: string = 'SEARCHING';\n\tstatic SHOW_PRODUCT_ITEM: string = 'SHOW_PRODUCT_ITEM';\n\tstatic SHOW_RECENT: string = 'SHOW_RECENT';\n}\n\nexport class ProductSearchInput\n{\n\tstatic SEARCH_TYPE_ID = 'product';\n\n\tmodel: ProductModel;\n\tselector: ProductSelector;\n\tcache = new Cache.MemoryCache();\n\n\tconstructor(id, options = {})\n\t{\n\t\tthis.id = id || Text.getRandom();\n\t\tthis.selector = options.selector;\n\t\tif (!(this.selector instanceof ProductSelector))\n\t\t{\n\t\t\tthrow new Error('Product selector instance not found.');\n\t\t}\n\n\t\tthis.model = options.model || {};\n\t\tthis.isEnabledSearch = options.isSearchEnabled;\n\t\tthis.isEnabledDetailLink = options.isEnabledDetailLink;\n\t\tthis.inputName = options.inputName || ProductSelector.INPUT_FIELD_NAME;\n\t\tthis.immutableFieldNames = [ProductSelector.INPUT_FIELD_BARCODE, ProductSelector.INPUT_FIELD_NAME];\n\t\tif (!this.immutableFieldNames.includes(this.inputName))\n\t\t{\n\t\t\tthis.immutableFieldNames.push(this.inputName);\n\t\t}\n\t\tthis.ajaxInProcess = false;\n\t\tthis.loadedSelectedItem = null;\n\n\t\tthis.handleSearchInput = Runtime.debounce(this.searchInDialog, 500, this);\n\t}\n\n\tdestroy()\n\t{\n\n\t}\n\n\tgetId(): string\n\t{\n\t\treturn this.id;\n\t}\n\n\tgetSelectorType(): string\n\t{\n\t\treturn ProductSelector.INPUT_FIELD_NAME;\n\t}\n\n\tgetField(fieldName): string\n\t{\n\t\treturn this.model.getField(fieldName);\n\t}\n\n\tgetValue(): string\n\t{\n\t\treturn this.getField(this.inputName);\n\t}\n\n\tgetFilledValue(): string\n\t{\n\t\treturn this.getNameInput().value || '';\n\t}\n\n\tisSearchEnabled(): boolean\n\t{\n\t\treturn this.isEnabledSearch;\n\t}\n\n\ttoggleIcon(icon, value)\n\t{\n\t\tif (Type.isDomNode(icon))\n\t\t{\n\t\t\tDom.style(icon, 'display', value);\n\t\t}\n\t}\n\n\tgetNameBlock(): HTMLElement\n\t{\n\t\treturn this.cache.remember('nameBlock', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-ctl ui-ctl-textbox ui-ctl-w100\">\n\t\t\t\t\t${this.getNameTag()}\n\t\t\t\t\t${this.getNameInput()}\n\t\t\t\t\t${this.getHiddenNameInput()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetNameTag(): ?HTMLElement\n\t{\n\t\tif (!this.model.isNew())\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"ui-ctl-tag\">${Loc.getMessage('CATALOG_SELECTOR_NEW_TAG_TITLE')}</div>\n\t\t`;\n\t}\n\n\tgetNameInput(): HTMLInputElement\n\t{\n\t\treturn this.cache.remember('nameInput', () => {\n\t\t\tconst input = Tag.render`\n\t\t\t\t<input type=\"text\"\n\t\t\t\t\tclass=\"ui-ctl-element ui-ctl-textbox\"\n\t\t\t\t\tautocomplete=\"off\"\n\t\t\t\t\tdata-name=\"${Text.encode(this.inputName)}\"\n\t\t\t\t\tvalue=\"${Text.encode(this.getValue())}\"\n\t\t\t\t\tplaceholder=\"${Text.encode(this.getPlaceholder())}\"\n\t\t\t\t\ttitle=\"${Text.encode(this.getValue())}\"\n\t\t\t\t\tonchange=\"${this.handleNameInputHiddenChange.bind(this)}\"\n\t\t\t\t>\n\t\t\t`;\n\n\t\t\tif (this.selector.getConfig('SELECTOR_INPUT_DISABLED', false))\n\t\t\t{\n\t\t\t\tDom.addClass(input, 'ui-ctl-disabled');\n\t\t\t\tinput.setAttribute('disabled', true);\n\t\t\t}\n\n\t\t\treturn input;\n\t\t});\n\t}\n\n\tgetHiddenNameInput(): HTMLInputElement\n\t{\n\t\treturn this.cache.remember('hiddenNameInput', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<input\n\t\t\t\t \ttype=\"hidden\"\n\t\t\t\t\tname=\"${Text.encode(this.inputName)}\"\n\t\t\t\t\tvalue=\"${Text.encode(this.getValue())}\"\n\t\t\t\t>\n\t\t\t`;\n\t\t});\n\t}\n\n\thandleNameInputHiddenChange(event: UIEvent)\n\t{\n\t\tthis.getHiddenNameInput().value = event.target.value;\n\t}\n\n\tgetClearIcon(): HTMLElement\n\t{\n\t\treturn this.cache.remember('closeIcon', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<button\n\t\t\t\t\tclass=\"ui-ctl-after ui-ctl-icon-clear\"\n\t\t\t\t\tonclick=\"${this.handleClearIconClick.bind(this)}\"\n\t\t\t\t></button>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetArrowIcon(): HTMLElement\n\t{\n\t\treturn this.cache.remember('arrowIcon', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<a\n\t\t\t\t\thref=\"${Text.encode(this.model.getDetailPath())}\"\n\t\t\t\t\ttarget=\"_blank\"\n\t\t\t\t\tclass=\"ui-ctl-after ui-ctl-icon-forward\"\n\t\t\t\t>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetSearchIcon(): HTMLElement\n\t{\n\t\treturn this.cache.remember('searchIcon', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<button\n\t\t\t\t\tclass=\"ui-ctl-after ui-ctl-icon-search\"\n\t\t\t\t\tonclick=\"${this.handleSearchIconClick.bind(this)}\"\n\t\t\t\t></button>\n\t\t\t`;\n\t\t});\n\t}\n\n\tlayout(): HTMLElement\n\t{\n\t\tthis.clearInputCache();\n\t\tconst block = Tag.render`<div class=\"ui-ctl ui-ctl-w100 ui-ctl-after-icon\"></div>`;\n\n\t\tthis.toggleIcon(this.getClearIcon(), 'none');\n\t\tDom.append(this.getClearIcon(), block);\n\n\t\tif (this.isSearchEnabled())\n\t\t{\n\t\t\tif (this.selector.isProductSearchEnabled())\n\t\t\t{\n\t\t\t\tthis.initHasDialogItems();\n\t\t\t}\n\n\t\t\tthis.toggleIcon(\n\t\t\t\tthis.getSearchIcon(),\n\t\t\t\tType.isStringFilled(this.getFilledValue()) ? 'none' : 'block'\n\t\t\t);\n\t\t\tDom.append(this.getSearchIcon(), block);\n\n\t\t\tEvent.bind(this.getNameInput(), 'click', this.handleClickNameInput.bind(this));\n\t\t\tEvent.bind(this.getNameInput(), 'input', this.handleSearchInput);\n\t\t\tEvent.bind(this.getNameInput(), 'blur', this.handleNameInputBlur.bind(this));\n\t\t\tEvent.bind(this.getNameInput(), 'keydown', this.handleNameInputKeyDown.bind(this));\n\n\t\t\tthis.dialogMode =\n\t\t\t\tthis.model.isCatalogExisted()\n\t\t\t\t\t? DialogMode.SHOW_PRODUCT_ITEM\n\t\t\t\t\t: DialogMode.SHOW_RECENT\n\t\t\t;\n\t\t}\n\n\t\tif (this.showDetailLink() && Type.isStringFilled(this.getValue()))\n\t\t{\n\t\t\tthis.toggleIcon(this.getClearIcon(), 'none');\n\t\t\tthis.toggleIcon(this.getSearchIcon(), 'none');\n\t\t\tthis.toggleIcon(this.getArrowIcon(), 'block');\n\t\t\tDom.append(this.getArrowIcon(), block);\n\t\t}\n\n\t\tEvent.bind(this.getNameInput(), 'click', this.handleIconsSwitchingOnNameInput.bind(this));\n\t\tEvent.bind(this.getNameInput(), 'input', this.handleIconsSwitchingOnNameInput.bind(this));\n\t\tEvent.bind(this.getNameInput(), 'change', this.handleNameInputChange.bind(this));\n\n\t\tDom.append(this.getNameBlock(), block);\n\t\treturn block;\n\t}\n\n\tshowDetailLink(): boolean\n\t{\n\t\treturn this.isEnabledDetailLink;\n\t}\n\n\tgetDialog(): ?Dialog\n\t{\n\t\treturn this.cache.remember('dialog', () => {\n\t\t\tconst searchTypeId = ProductSearchInput.SEARCH_TYPE_ID ;\n\t\t\tconst entity = {\n\t\t\t\tid: searchTypeId,\n\t\t\t\toptions: {\n\t\t\t\t\tiblockId: this.model.getIblockId(),\n\t\t\t\t\tbasePriceId: this.model.getBasePriceId(),\n\t\t\t\t\tcurrency: this.model.getCurrency(),\n\t\t\t\t},\n\t\t\t\tdynamicLoad: true,\n\t\t\t\tdynamicSearch: true,\n\t\t\t};\n\t\t\tconst restrictedProductTypes = this.selector.getConfig('RESTRICTED_PRODUCT_TYPES', null);\n\t\t\tif (!Type.isNil(restrictedProductTypes))\n\t\t\t{\n\t\t\t\tentity.options.restrictedProductTypes = restrictedProductTypes;\n\t\t\t}\n\n\t\t\tconst params = {\n\t\t\t\tid: this.id + '_' + searchTypeId,\n\t\t\t\theight: 300,\n\t\t\t\twidth: Math.max(this.getNameInput()?.offsetWidth, 565),\n\t\t\t\tcontext: 'catalog-products',\n\t\t\t\ttargetNode: this.getNameInput(),\n\t\t\t\tenableSearch: false,\n\t\t\t\tmultiple: false,\n\t\t\t\tdropdownMode: true,\n\t\t\t\tsearchTabOptions: {\n\t\t\t\t\tstub: true,\n\t\t\t\t\tstubOptions: {\n\t\t\t\t\t\ttitle: Tag.message`${'CATALOG_SELECTOR_IS_EMPTY_TITLE'}`,\n\t\t\t\t\t\tsubtitle:\n\t\t\t\t\t\t\tthis.isAllowedCreateProduct()\n\t\t\t\t\t\t\t\t? Tag.message`${'CATALOG_SELECTOR_IS_EMPTY_SUBTITLE'}`\n\t\t\t\t\t\t\t\t: ''\n\t\t\t\t\t\t,\n\t\t\t\t\t\tarrow: true\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tevents: {\n\t\t\t\t\t'Item:onSelect': this.onProductSelect.bind(this),\n\t\t\t\t\t'Search:onItemCreateAsync': this.createProduct.bind(this),\n\t\t\t\t\t'ChangeItem:onClick': this.showChangeNotification.bind(this),\n\t\t\t\t},\n\t\t\t\tentities: [entity]\n\t\t\t};\n\n\t\t\tconst settingsCollection = Extension.getSettings('catalog.product-selector');\n\t\t\tif (Type.isObject(settingsCollection.get('limitInfo')))\n\t\t\t{\n\t\t\t\tparams.footer = ProductCreationLimitedFooter;\n\t\t\t}\n\t\t\telse if (this.model && this.model.isCatalogExisted())\n\t\t\t{\n\t\t\t\tparams.footer = ProductSearchSelectorFooter;\n\t\t\t\tparams.footerOptions = {\n\t\t\t\t\tinputName: this.inputName,\n\t\t\t\t\tallowEditItem: this.isAllowedEditProduct(),\n\t\t\t\t\tallowCreateItem: this.isAllowedCreateProduct(),\n\t\t\t\t\terrorAdminHint: settingsCollection.get('errorAdminHint'),\n\t\t\t\t\tcreationLabel: Loc.getMessage('CATALOG_SELECTOR_SEARCH_POPUP_FOOTER_CREATE'),\n\t\t\t\t\tcurrentValue: this.getValue(),\n\t\t\t\t};\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tparams.searchOptions = { allowCreateItem: this.isAllowedCreateProduct() };\n\t\t\t}\n\n\t\t\treturn new Dialog(params);\n\t\t});\n\t}\n\n\tinitHasDialogItems()\n\t{\n\t\tif (!Type.isNil(this.selector.getConfig('EXIST_DIALOG_ITEMS')))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this.selector.getModel().isEmpty())\n\t\t{\n\t\t\tthis.selector.setConfig('EXIST_DIALOG_ITEMS', true);\n\t\t\treturn;\n\t\t}\n\n\t\t// is null, that not send ajax\n\t\tthis.selector.setConfig('EXIST_DIALOG_ITEMS', false);\n\n\t\tconst dialog = this.getDialog();\n\t\tif (dialog.hasDynamicLoad())\n\t\t{\n\t\t\tthis.#loadPreselectedItems();\n\t\t\tdialog.subscribeOnce('onLoad', () => {\n\t\t\t\tif (dialog.getPreselectedItems().length > 1)\n\t\t\t\t{\n\t\t\t\t\tthis.selector.setConfig('EXIST_DIALOG_ITEMS', true);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.selector.setConfig('EXIST_DIALOG_ITEMS', true);\n\t\t}\n\t}\n\n\tisAllowedCreateProduct(): boolean\n\t{\n\t\treturn this.selector.getConfig('IS_ALLOWED_CREATION_PRODUCT', true) && this.selector.checkProductAddRights();\n\t}\n\n\tisAllowedEditProduct(): boolean\n\t{\n\t\treturn this.selector.checkProductEditRights();\n\t}\n\n\thandleNameInputKeyDown(event: KeyboardEvent): void\n\t{\n\t\tconst dialog = this.getDialog();\n\t\tif (event.key === 'Enter' && dialog.getActiveTab() === dialog.getSearchTab())\n\t\t{\n\t\t\t// prevent a form submit\n\t\t\tevent.stopPropagation();\n\t\t\tevent.preventDefault();\n\n\t\t\tif ((Browser.isMac() && event.metaKey) || event.ctrlKey)\n\t\t\t{\n\t\t\t\tdialog.getSearchTab().getFooter().createItem();\n\t\t\t}\n\t\t}\n\t}\n\n\thandleIconsSwitchingOnNameInput(event: UIEvent): void\n\t{\n\t\tthis.toggleIcon(this.getArrowIcon(), 'none');\n\n\t\tif (Type.isStringFilled(event.target.value))\n\t\t{\n\t\t\tthis.toggleIcon(this.getClearIcon(), 'block');\n\t\t\tthis.toggleIcon(this.getSearchIcon(), 'none');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.toggleIcon(this.getClearIcon(), 'none');\n\t\t\tif (this.isSearchEnabled())\n\t\t\t{\n\t\t\t\tthis.toggleIcon(this.getSearchIcon(), 'block');\n\t\t\t}\n\t\t}\n\t}\n\n\tclearInputCache()\n\t{\n\t\tthis.cache.delete('dialog');\n\t\tthis.cache.delete('nameBlock');\n\t\tthis.cache.delete('nameInput');\n\t\tthis.cache.delete('hiddenNameInput');\n\t}\n\n\thandleClearIconClick(event: UIEvent)\n\t{\n\t\tthis.loadedSelectedItem = null;\n\t\tif (this.selector.isProductSearchEnabled() && !this.model.isEmpty())\n\t\t{\n\t\t\tthis.selector.clearState();\n\t\t\tthis.selector.clearLayout();\n\t\t\tthis.selector.layout();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst newValue = '';\n\t\t\tthis.toggleIcon(this.getClearIcon(), 'none');\n\t\t\tthis.onChangeValue(newValue);\n\t\t}\n\n\t\tthis.selector.focusName();\n\n\t\tthis.selector.emit('onClear', {\n\t\t\tselectorId: this.selector.getId(),\n\t\t\trowId: this.selector.getRowId()\n\t\t});\n\n\t\tevent.stopPropagation();\n\t\tevent.preventDefault();\n\t}\n\n\thandleNameInputChange(event: UIEvent)\n\t{\n\t\tconst value = event.target.value;\n\t\tthis.onChangeValue(value);\n\t}\n\n\tonChangeValue(value: string)\n\t{\n\t\tconst fields = {};\n\t\tthis.getNameInput().title = value;\n\t\tthis.getNameInput().value = value;\n\t\tfields[this.inputName] = value;\n\t\tEventEmitter.emit('ProductSelector::onNameChange', {\n\t\t\trowId: this.selector.getRowId(),\n\t\t\tfields\n\t\t});\n\n\t\tif (!this.selector.isEnabledAutosave())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.selector.getModel().setFields(fields);\n\t\tthis.selector.getModel().save().then(() => {\n\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\tid: 'saving_field_notify_name',\n\t\t\t\tcloseButton: false,\n\t\t\t\tcontent: Tag.render`<div>${Loc.getMessage('CATALOG_SELECTOR_SAVING_NOTIFICATION_NAME')}</div>`,\n\t\t\t\tautoHide: true,\n\t\t\t});\n\t\t});\n\t}\n\n\tfocusName()\n\t{\n\t\trequestAnimationFrame(() => this.getNameInput().focus());\n\t}\n\n\tsearchInDialog(): void\n\t{\n\t\tconst searchQuery = this.getFilledValue().trim();\n\t\tif (searchQuery === '')\n\t\t{\n\t\t\tif (this.isHasDialogItems === false)\n\t\t\t{\n\t\t\t\tthis.getDialog().hide();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.loadedSelectedItem = null;\n\t\t\tthis.#showPreselectedItems()\n\t\t\treturn;\n\t\t}\n\n\t\tthis.dialogMode = DialogMode.SEARCHING;\n\t\tthis.#searchItem(searchQuery);\n\t\tthis.isSearchingInProcess = true;\n\t}\n\n\t#showSelectedItem()\n\t{\n\t\tif (!this.selector.isProductSearchEnabled())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst dialog = this.getDialog();\n\t\tdialog.removeItems();\n\n\t\tnew Promise((resolve) => {\n\t\t\tif (!Type.isNil(this.loadedSelectedItem))\n\t\t\t{\n\t\t\t\tresolve();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tdialog.showLoader();\n\t\t\tajax.runAction(\n\t\t\t\t'catalog.productSelector.getSkuSelectorItem',\n\t\t\t\t{\n\t\t\t\t\tjson: {\n\t\t\t\t\t\tid: this.selector.getModel().getSkuId(),\n\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\tiblockId: this.model.getIblockId(),\n\t\t\t\t\t\t\tbasePriceId: this.model.getBasePriceId(),\n\t\t\t\t\t\t\tcurrency: this.model.getCurrency(),\n\t\t\t\t\t\t},\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t)\n\t\t\t\t.then((response) => {\n\t\t\t\t\tdialog.hideLoader();\n\t\t\t\t\tthis.loadedSelectedItem = null;\n\t\t\t\t\tif (Type.isObject(response.data) && !dialog.isLoading())\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.loadedSelectedItem = dialog.addItem(response.data);\n\t\t\t\t\t}\n\t\t\t\t\tresolve();\n\t\t\t\t});\n\t\t})\n\t\t\t.then(() => {\n\t\t\t\tif (!Type.isNil(this.loadedSelectedItem))\n\t\t\t\t{\n\t\t\t\t\tdialog.setPreselectedItems([this.selector.getModel().getSkuId()]);\n\t\t\t\t\tdialog.getRecentTab().getRootNode().addItem(this.loadedSelectedItem);\n\t\t\t\t\tdialog.selectFirstTab();\n\t\t\t\t\tdialog.getFooter()?.hide();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.searchInDialog();\n\t\t\t\t}\n\t\t\t});\n\n\t\tdialog.getPopup().show();\n\t\tdialog.getFooter()?.hide();\n\t}\n\n\t#loadPreselectedItems()\n\t{\n\t\tconst dialog = this.getDialog();\n\t\tif (dialog.isLoading())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.loadedSelectedItem)\n\t\t{\n\t\t\tdialog.removeItems();\n\t\t\tdialog.loadState = 'UNSENT';\n\t\t\tthis.loadedSelectedItem = null;\n\t\t}\n\n\t\tdialog.load();\n\t}\n\n\t#showPreselectedItems()\n\t{\n\t\tif (!this.selector.isProductSearchEnabled())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.dialogMode = DialogMode.SHOW_RECENT;\n\t\tconst dialog = this.getDialog();\n\t\tthis.#loadPreselectedItems();\n\n\t\tdialog.selectFirstTab();\n\t\tdialog.getFooter()?.hide();\n\t\tdialog.show();\n\t}\n\n\t#searchItem(searchQuery: string = '')\n\t{\n\t\tif (!this.selector.isProductSearchEnabled())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst dialog = this.getDialog();\n\t\tdialog.getPopup().show();\n\t\tdialog.search(searchQuery);\n\t}\n\n\thandleClickNameInput(): void\n\t{\n\t\tconst dialog = this.getDialog();\n\n\t\tif (\n\t\t\tdialog.isOpen()\n\t\t\t|| (this.getFilledValue() === '' && this.isHasDialogItems === false)\n\t\t)\n\t\t{\n\t\t\tdialog.hide();\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.showItems();\n\t}\n\n\tshowItems()\n\t{\n\t\tif (this.getFilledValue() === '')\n\t\t{\n\t\t\tthis.#showPreselectedItems();\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this.model.isCatalogExisted() || this.dialogMode !== DialogMode.SHOW_PRODUCT_ITEM)\n\t\t{\n\t\t\tthis.searchInDialog();\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#showSelectedItem();\n\t}\n\n\thandleNameInputBlur(event: UIEvent)\n\t{\n\t\t// timeout to toggle clear icon handler while cursor is inside of name input\n\t\tsetTimeout(() => {\n\t\t\tthis.toggleIcon(this.getClearIcon(), 'none');\n\n\t\t\tif (this.showDetailLink() && Type.isStringFilled(this.getValue()))\n\t\t\t{\n\t\t\t\tif (this.isSearchEnabled())\n\t\t\t\t{\n\t\t\t\t\tthis.toggleIcon(this.getSearchIcon(), 'none');\n\t\t\t\t}\n\t\t\t\tthis.toggleIcon(this.getArrowIcon(), 'block');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.toggleIcon(this.getArrowIcon(), 'none');\n\t\t\t\tif (this.isSearchEnabled())\n\t\t\t\t{\n\t\t\t\t\tthis.toggleIcon(\n\t\t\t\t\t\tthis.getSearchIcon(),\n\t\t\t\t\t\tType.isStringFilled(this.getFilledValue()) ? 'none' : 'block'\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t}, 200);\n\n\t\tif (this.isSearchEnabled() && this.selector.isEnabledEmptyProductError())\n\t\t{\n\t\t\tsetTimeout(() => {\n\t\t\t\tif (\n\t\t\t\t\t!this.selector.inProcess()\n\t\t\t\t\t&& (\n\t\t\t\t\t\tthis.model.isEmpty()\n\t\t\t\t\t\t|| !Type.isStringFilled(this.getFilledValue())\n\t\t\t\t\t)\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tthis.model.getErrorCollection().setError(\n\t\t\t\t\t\tSelectorErrorCode.NOT_SELECTED_PRODUCT,\n\t\t\t\t\t\tthis.selector.getEmptySelectErrorMessage()\n\t\t\t\t\t);\n\n\t\t\t\t\tthis.selector.layoutErrors();\n\t\t\t\t}\n\t\t\t}, 200);\n\t\t}\n\t}\n\n\thandleSearchIconClick(event: UIEvent)\n\t{\n\t\tthis.searchInDialog();\n\t\tthis.focusName();\n\n\t\tevent.stopPropagation();\n\t\tevent.preventDefault();\n\t}\n\n\tgetImmutableFieldNames(): []\n\t{\n\t\treturn this.immutableFieldNames;\n\t}\n\n\tsetInputValueOnProductSelect(item: Item)\n\t{\n\t\titem.getDialog().getTargetNode().value = item.getTitle()\n\t}\n\n\tonProductSelect(event)\n\t{\n\t\tconst item = event.getData().item;\n\t\tthis.setInputValueOnProductSelect(item);\n\n\t\tthis.toggleIcon(this.getSearchIcon(), 'none');\n\t\tthis.model.getErrorCollection().clearErrors();\n\t\tif (this.selector)\n\t\t{\n\t\t\tconst isNew = item.getCustomData().get('isNew');\n\t\t\tconst immutableFields = [];\n\t\t\tthis.getImmutableFieldNames().forEach((key) => {\n\t\t\t\tif (!Type.isNil(item.getCustomData().get(key)))\n\t\t\t\t{\n\t\t\t\t\tthis.model.setField(key, item.getCustomData().get(key));\n\t\t\t\t\timmutableFields.push(key);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.selector.onProductSelect(\n\t\t\t\titem.getId(),\n\t\t\t\t\t{\n\t\t\t\t\t\tisNew,\n\t\t\t\t\t\timmutableFields,\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tthis.selector.clearLayout();\n\t\t\tthis.selector.layout();\n\t\t}\n\n\t\tthis.dialogMode = DialogMode.SHOW_PRODUCT_ITEM;\n\t\tthis.loadedSelectedItem = item;\n\t\tthis.cache.delete('dialog');\n\t}\n\n\tcreateProductModelFromSearchQuery(searchQuery: string): ProductModel\n\t{\n\t\tconst fields = {...this.selector.getModel().getFields()};\n\t\tfields[this.inputName] = searchQuery;\n\n\t\treturn new ProductModel({\n\t\t\tisSimpleModel: true,\n\t\t\tisNew: true,\n\t\t\tcurrency: this.selector.options.currency,\n\t\t\tiblockId: this.selector.getModel().getIblockId(),\n\t\t\tbasePriceId: this.selector.getModel().getBasePriceId(),\n\t\t\tfields\n\t\t})\n\t}\n\n\tcreateProduct(event): ?Promise\n\t{\n\t\tif (this.ajaxInProcess)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.ajaxInProcess = true;\n\t\tconst dialog: Dialog = event.getTarget();\n\t\tconst {searchQuery} = event.getData();\n\t\tconst newProduct = this.createProductModelFromSearchQuery(searchQuery.getQuery());\n\n\t\tEventEmitter.emit(this.selector, 'onBeforeCreate', {model: newProduct});\n\n\t\treturn new Promise(\n\t\t\t(resolve, reject) => {\n\t\t\t\tif (!this.checkCreationModel(newProduct))\n\t\t\t\t{\n\t\t\t\t\tthis.ajaxInProcess = false;\n\t\t\t\t\tdialog.hide();\n\t\t\t\t\treject();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tdialog.showLoader();\n\t\t\t\tnewProduct.save()\n\t\t\t\t\t.then(response => {\n\t\t\t\t\t\tdialog.hideLoader();\n\t\t\t\t\t\tconst id = Text.toInteger(response.data.id);\n\t\t\t\t\t\tconst item = dialog.addItem({\n\t\t\t\t\t\t\tid,\n\t\t\t\t\t\t\tentityId: ProductSearchInput.SEARCH_TYPE_ID,\n\t\t\t\t\t\t\ttitle: searchQuery.getQuery(),\n\t\t\t\t\t\t\ttabs: dialog.getRecentTab().getId(),\n\t\t\t\t\t\t\tcustomData: {\n\t\t\t\t\t\t\t\tisNew: true,\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tthis.selector.getModel().setOption('isSimpleModel', false);\n\t\t\t\t\t\tthis.selector.getModel().setOption('isNew', true);\n\n\t\t\t\t\t\tthis.getImmutableFieldNames().forEach((name) => {\n\t\t\t\t\t\t\tthis.selector.getModel().setField(name, newProduct.getField(name));\n\t\t\t\t\t\t\tthis.selector.getModel().setOption(name, newProduct.getField(name));\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tif (item)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\titem.select();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tdialog.hide();\n\t\t\t\t\t\tthis.cache.delete('dialog');\n\t\t\t\t\t\tthis.ajaxInProcess = false;\n\t\t\t\t\t\tthis.isHasDialogItems = true;\n\t\t\t\t\t\tresolve();\n\t\t\t\t\t})\n\t\t\t\t\t.catch((errorResponse) => {\n\t\t\t\t\t\tdialog.hideLoader();\n\t\t\t\t\t\terrorResponse.errors.forEach((error) => {\n\t\t\t\t\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\t\t\t\t\tcloseButton: true,\n\t\t\t\t\t\t\t\tcontent: Tag.render`<div>${error.message}</div>`,\n\t\t\t\t\t\t\t\tautoHide: true,\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tthis.ajaxInProcess = false;\n\t\t\t\t\t\treject();\n\t\t\t\t\t});\n\t\t\t});\n\t}\n\n\tcheckCreationModel(creationModel: ProductModel): boolean\n\t{\n\t\treturn true;\n\t}\n\n\tshowChangeNotification(event): void\n\t{\n\t\tconst {query} = event.getData();\n\t\tconst options = {\n\t\t\ttitle: Loc.getMessage('CATALOG_SELECTOR_SAVING_NOTIFICATION_' + this.selector.getType()),\n\t\t\tevents: {\n\t\t\t\tonSave: () => {\n\t\t\t\t\tif (this.selector)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.selector.getModel().setField(this.inputName, query);\n\t\t\t\t\t\tthis.selector.getModel().save([this.inputName])\n\t\t\t\t\t\t\t.catch((errorResponse) => {\n\t\t\t\t\t\t\t\terrorResponse.errors.forEach((error) => {\n\t\t\t\t\t\t\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\t\t\t\t\t\t\tcloseButton: true,\n\t\t\t\t\t\t\t\t\t\tcontent: Tag.render`<div>${error.message}</div>`,\n\t\t\t\t\t\t\t\t\t\tautoHide: true,\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t};\n\n\t\tif (this.selector.getConfig('ROLLBACK_INPUT_AFTER_CANCEL', false))\n\t\t{\n\t\t\toptions.declineCancelTitle = Loc.getMessage('CATALOG_SELECTOR_SAVING_NOTIFICATION_CANCEL_TITLE');\n\t\t\toptions.events.onCancel = () => {\n\t\t\t\tthis.selector.clearLayout();\n\t\t\t\tthis.selector.layout();\n\t\t\t};\n\t\t}\n\n\t\tthis.selector.getModel().showSaveNotifier(\n\t\t\t'nameChanger_' + this.selector.getId(),\n\t\t\toptions\n\t\t);\n\t}\n\n\tgetPlaceholder(): string\n\t{\n\t\treturn (\n\t\t\tthis.isSearchEnabled() && this.model.isEmpty()\n\t\t\t\t? Loc.getMessage('CATALOG_SELECTOR_BEFORE_SEARCH_TITLE')\n\t\t\t\t: Loc.getMessage('CATALOG_SELECTOR_VIEW_NAME_TITLE')\n\t\t);\n\t}\n\n\tremoveSpotlight()\n\t{\n\t}\n\n\tremoveQrAuth()\n\t{\n\t}\n}\n","import {Runtime, Tag, Text, Type} from 'main.core';\nimport './component.css';\nimport {ProductSelector} from 'catalog.product-selector';\n\nexport class ProductImageInput\n{\n\tconstructor(id, options = {})\n\t{\n\t\tthis.id = id || Text.getRandom();\n\t\tthis.selector = options.selector || null;\n\t\tif (!(this.selector instanceof ProductSelector))\n\t\t{\n\t\t\tthrow new Error('Product selector instance not found.');\n\t\t}\n\n\t\tthis.config = options.config || {};\n\n\t\tif (!Type.isStringFilled(this.selector.getModel()?.getImageCollection().getEditInput()))\n\t\t{\n\t\t\tthis.restoreDefaultInputHtml();\n\t\t}\n\n\t\tthis.enableSaving = options.enableSaving;\n\n\t\tthis.uploaderFieldMap = {};\n\t}\n\n\tgetId()\n\t{\n\t\treturn this.id;\n\t}\n\n\tsetId(id)\n\t{\n\t\tthis.id = id;\n\t}\n\n\tsetView(html): void\n\t{\n\t\tthis.selector.getModel()?.getImageCollection().setPreview(html);\n\t}\n\n\tsetInputHtml(html): void\n\t{\n\t\tthis.selector.getModel()?.getImageCollection().setEditInput(html);\n\t}\n\n\trestoreDefaultInputHtml(): void\n\t{\n\t\tconst defaultInput = `\n\t\t\t<div class='ui-image-input-container ui-image-input-img--disabled'>\n\t\t\t\t<div class='adm-fileinput-wrapper '>\n\t\t\t\t\t<div class='adm-fileinput-area mode-pict adm-fileinput-drag-area'></div>\n\t\t\t\t</div>\n\t\t\t</div>\n`\t\t;\n\n\t\tthis.selector.getModel()?.getImageCollection().setEditInput(defaultInput);\n\t\tthis.selector.getModel()?.getImageCollection().setPreview(defaultInput);\n\t}\n\n\tisViewMode(): boolean\n\t{\n\t\treturn this.selector && (this.selector.isViewMode() || !this.selector.model.isSaveable());\n\t}\n\n\tisEnabledLiveSaving(): boolean\n\t{\n\t\treturn this.enableSaving;\n\t}\n\n\tlayout(): HTMLElement\n\t{\n\t\tconst imageContainer = Tag.render`<div></div>`;\n\t\tconst html =\n\t\t\tthis.isViewMode()\n\t\t\t\t? this.selector.getModel()?.getImageCollection()?.getPreview()\n\t\t\t\t: this.selector.getModel()?.getImageCollection()?.getEditInput()\n\t\t;\n\n\t\tRuntime.html(imageContainer, html);\n\n\t\treturn imageContainer;\n\t}\n}","import {Loc, Tag, Dom, Type} from 'main.core';\nimport {BaseEvent} from \"main.core.events\";\nimport ProductSearchSelectorFooter from \"./product-search-selector-footer\";\n\nexport class BarcodeSearchSelectorFooter extends ProductSearchSelectorFooter\n{\n\tconstructor(id, options = {})\n\t{\n\t\tsuper(id, options);\n\t\tthis.isEmptyBarcode = options.isEmptyBarcode;\n\t}\n\n\tgetContent(): HTMLElement\n\t{\n\t\tthis.barcodeContent = super.getContent();\n\t\tthis.scannerContent = this.getScannerContent();\n\t\tDom.style(this.barcodeContent, 'display', 'none');\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"catalog-footers-container\">\n\t\t\t\t${this.barcodeContent}\n\t\t\t\t${this.scannerContent}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tisViewEditButton(): boolean\n\t{\n\t\treturn !this.isEmptyBarcode && super.isViewEditButton();\n\t}\n\n\tgetScannerContent(): HTMLElement\n\t{\n\t\tconst phrase = Tag.render`\n\t\t\t<div>${Loc.getMessage('CATALOG_SELECTOR_SEARCH_POPUP_FOOTER_BARCODE')}</div>\n\t\t`;\n\n\t\tconst createButton = phrase.querySelector('create-button');\n\n\t\tDom.replace(createButton, this.getScannerLabelContainer());\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"ui-selector-search-footer-box\">\n\t\t\t\t${phrase}\n\t\t\t\t${this.getLoaderContainer()}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tgetScannerLabelContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('scannerLabel', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<span onclick=\"${this.handleScannerClick.bind(this)}\">\n\t\t\t\t\t<span class=\"ui-selector-footer-link ui-selector-footer-link-add footer-link--warehouse-barcode-icon\">\n\t\t\t\t\t\t${Loc.getMessage('CATALOG_SELECTOR_SEARCH_POPUP_FOOTER_BARCODE_START_SCAN_LABEL')}\n\t\t\t\t\t</span>\n\t\t\t\t\t${this.getScannerQueryContainer()}\n\t\t\t\t</span>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetScannerQueryContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('scanner_name-container', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<span class=\"ui-selector-search-footer-query\"></span>\n\t\t\t`;\n\t\t});\n\t}\n\n\thandleScannerClick(): void\n\t{\n\t\tconst inputEntity = this.options?.inputEntity;\n\t\tif (inputEntity)\n\t\t{\n\t\t\tinputEntity.startMobileScanner();\n\t\t}\n\t}\n\n\thandleOnSearch(event: BaseEvent): void\n\t{\n\t\tconst { query } = event.getData();\n\n\t\tif (!Type.isStringFilled(query))\n\t\t{\n\t\t\tthis.show();\n\t\t\tDom.style(this.scannerContent, 'display', '');\n\t\t\tDom.style(this.barcodeContent, 'display', 'none');\n\t\t}\n\t\telse if (this.options.currentValue === query)\n\t\t{\n\t\t\tthis.hide();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.show();\n\t\t\tDom.style(this.barcodeContent, 'display', '');\n\t\t\tDom.style(this.scannerContent, 'display', 'none');\n\t\t}\n\n\t\tthis.getQueryContainer().textContent = \" \" + query;\n\t\tthis.getScannerQueryContainer().textContent = \" \" + query;\n\t}\n}","import {Extension, Loc, Tag, Type, Text, Dom, Event, userOptions, ajax} from 'main.core';\nimport {Dialog, Item} from 'ui.entity-selector';\nimport './component.css';\nimport {EventEmitter} from 'main.core.events';\nimport {ProductModel} from 'catalog.product-model';\nimport ProductCreationLimitedFooter from './product-creation-limited-footer';\nimport {ProductSearchInput} from './product-search-input';\nimport {ProductSelector} from 'catalog.product-selector';\nimport {BarcodeScanner} from 'catalog.barcode-scanner';\nimport 'ui.notification';\nimport {BarcodeSearchSelectorFooter} from './barcode-search-selector-footer';\nimport {QrAuthorization} from 'ui.qrauthorization';\nimport {SelectorErrorCode} from './selector-error-code';\nimport 'spotlight';\nimport {Guide} from 'ui.tour';\n\nexport class BarcodeSearchInput extends ProductSearchInput\n{\n\tstatic SEARCH_TYPE_ID = 'barcode';\n\n\tonFocusHandler = this.handleFocusEvent.bind(this);\n\tonBlurHandler = this.handleBlurEvent.bind(this);\n\n\tconstructor(id, options = {})\n\t{\n\t\tsuper(id, options);\n\n\t\tthis.focused = false;\n\t\tthis.settingsCollection = Extension.getSettings('catalog.product-selector');\n\n\t\tthis.isInstalledMobileApp =\n\t\t\tthis.selector.getConfig('IS_INSTALLED_MOBILE_APP')\n\t\t\t|| this.settingsCollection.get('isInstallMobileApp')\n\t\t;\n\n\t\tif (\n\t\t\t!this.settingsCollection.get('isEnabledQrAuth')\n\t\t\t&& this.selector.getConfig('ENABLE_BARCODE_QR_AUTH', true)\n\t\t)\n\t\t{\n\t\t\tthis.qrAuth = new QrAuthorization();\n\t\t\tthis.qrAuth.createQrCodeImage();\n\t\t}\n\t}\n\n\tdestroy()\n\t{\n\t\tEvent.unbind(this.getNameInput(), 'focus', this.onFocusHandler);\n\t\tEvent.unbind(this.getNameInput(), 'blur', this.onBlurHandler);\n\t}\n\n\thandleFocusEvent()\n\t{\n\t\tthis.focused = true;\n\t}\n\n\thandleBlurEvent()\n\t{\n\t\tthis.focused = false;\n\t}\n\n\tisSearchEnabled(): boolean\n\t{\n\t\treturn true;\n\t}\n\n\tshowDetailLink(): boolean\n\t{\n\t\treturn false\n\t}\n\n\tgetNameBlock(): HTMLElement\n\t{\n\t\treturn this.cache.remember('nameBlock', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-ctl ui-ctl-textbox ui-ctl-w100\">\n\t\t\t\t\t${this.getNameInput()}\n\t\t\t\t\t${this.getHiddenNameInput()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetDialog(): ?Dialog\n\t{\n\t\treturn this.cache.remember('dialog', () => {\n\t\t\tconst entity = {\n\t\t\t\tid: BarcodeSearchInput.SEARCH_TYPE_ID,\n\t\t\t\toptions: {\n\t\t\t\t\tiblockId: this.model.getIblockId(),\n\t\t\t\t\tbasePriceId: this.model.getBasePriceId(),\n\t\t\t\t\tcurrency: this.model.getCurrency(),\n\t\t\t\t},\n\t\t\t\tdynamicLoad: true,\n\t\t\t\tdynamicSearch: true,\n\t\t\t\tsearchFields: [\n\t\t\t\t\t{ name: 'title', type: 'string', system: true, searchable: false },\n\t\t\t\t],\n\t\t\t};\n\n\t\t\tconst restrictedProductTypes = this.selector.getConfig('RESTRICTED_PRODUCT_TYPES', null);\n\t\t\tif (!Type.isNil(restrictedProductTypes))\n\t\t\t{\n\t\t\t\tentity.options.restrictedProductTypes = restrictedProductTypes;\n\t\t\t}\n\n\t\t\tconst params = {\n\t\t\t\tid: this.id + '_' + BarcodeSearchInput.SEARCH_TYPE_ID,\n\t\t\t\theight: 300,\n\t\t\t\twidth: Math.max(this.getNameInput()?.offsetWidth, 565),\n\t\t\t\tcontext: null,\n\t\t\t\ttargetNode: this.getNameInput(),\n\t\t\t\tenableSearch: false,\n\t\t\t\tmultiple: false,\n\t\t\t\tdropdownMode: true,\n\t\t\t\tsearchTabOptions: {\n\t\t\t\t\tstub: true,\n\t\t\t\t\tstubOptions: {\n\t\t\t\t\t\ttitle: Tag.message`${'CATALOG_SELECTOR_IS_EMPTY_TITLE'}`,\n\t\t\t\t\t\tsubtitle:\n\t\t\t\t\t\t\tthis.isAllowedCreateProduct()\n\t\t\t\t\t\t\t\t? Tag.message`${'CATALOG_SELECTOR_IS_EMPTY_SUBTITLE'}`\n\t\t\t\t\t\t\t\t: ''\n\t\t\t\t\t\t,\n\t\t\t\t\t\tarrow: true\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tevents: {\n\t\t\t\t\t'Item:onSelect': this.onProductSelect.bind(this),\n\t\t\t\t\t'Search:onItemCreateAsync': this.createProduct.bind(this),\n\t\t\t\t\t'ChangeItem:onClick': this.showChangeNotification.bind(this),\n\t\t\t\t},\n\t\t\t\tentities: [entity]\n\t\t\t};\n\n\t\t\tif (this.model.getSkuId() && !Type.isStringFilled(this.model.getField(this.inputName)))\n\t\t\t{\n\t\t\t\tparams.preselectedItems = [[BarcodeSearchInput.SEARCH_TYPE_ID, this.model.getSkuId()]];\n\t\t\t}\n\n\t\t\tif (Type.isObject(this.settingsCollection.get('limitInfo')))\n\t\t\t{\n\t\t\t\tparams.footer = ProductCreationLimitedFooter;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tparams.footer = BarcodeSearchSelectorFooter;\n\t\t\t\tparams.footerOptions = {\n\t\t\t\t\tinputEntity: this,\n\t\t\t\t\tisEmptyBarcode: !this.model || !this.model.isCatalogExisted(),\n\t\t\t\t\tinputName: this.inputName,\n\t\t\t\t\terrorAdminHint: this.settingsCollection.get('errorAdminHint'),\n\t\t\t\t\tallowEditItem: this.isAllowedEditProduct(),\n\t\t\t\t\tallowCreateItem: this.isAllowedCreateProduct(),\n\t\t\t\t\tcreationLabel: Loc.getMessage('CATALOG_SELECTOR_SEARCH_POPUP_FOOTER_CREATE_WITH_BARCODE'),\n\t\t\t\t\tcurrentValue: this.getValue(),\n\t\t\t\t\tsearchOptions: {\n\t\t\t\t\t\tallowCreateItem: this.isAllowedCreateProduct(),\n\t\t\t\t\t\tfooterOptions: {\n\t\t\t\t\t\t\tlabel: Loc.getMessage('CATALOG_SELECTOR_SEARCH_POPUP_FOOTER_CREATE_WITH_BARCODE')\n\t\t\t\t\t\t},\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t}\n\n\t\t\treturn new Dialog(params);\n\t\t});\n\t}\n\n\tlayoutMobileQrPopup(): HTMLElement\n\t{\n\t\treturn this.cache.remember('qrMobilePopup', () => {\n\n\t\t\tconst closeIcon = Tag.render`<span class=\"popup-window-close-icon\"></span>`;\n\t\t\tEvent.bind(closeIcon, 'click', this.closeMobilePopup.bind(this));\n\n\t\t\tlet sendButton = '';\n\t\t\tlet helpButton = '';\n\t\t\tif (top.BX.Helper)\n\t\t\t{\n\t\t\t\thelpButton = Tag.render`\n\t\t\t\t\t<a class=\"product-selector-mobile-popup-link ui-btn ui-btn-light-border ui-btn-round\">\n\t\t\t\t\t\t${Loc.getMessage('CATALOG_SELECTOR_MOBILE_POPUP_HELP_BUTTON')}\n\t\t\t\t\t</a>\n\t\t\t\t`;\n\t\t\t\tEvent.bind(helpButton, 'click', () => {\n\t\t\t\t\ttop.BX.Helper.show(\"redirect=detail&code=14956818\");\n\t\t\t\t});\n\n\t\t\t\tsendButton = Tag.render`\n\t\t\t\t\t<a class=\"product-selector-mobile-popup-link ui-btn ui-btn-link\">\n\t\t\t\t\t\t${Loc.getMessage('CATALOG_SELECTOR_MOBILE_POPUP_SEND_PUSH_BUTTON')}\n\t\t\t\t\t</a>\n\t\t\t\t`;\n\n\t\t\t\tEvent.bind(sendButton, 'click', () => {\n\t\t\t\t\ttop.BX.Helper.show(\"redirect=detail&code=15042444\");\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn Tag.render`\n\t\t\t\t<div data-role=\"mobile-popup\">\n\t\t\t\t\t<div class=\"product-selector-mobile-popup-overlay\"></div>\n\t\t\t\t\t<div class=\"product-selector-mobile-popup-content\">\n\t\t\t\t\t\t<div class=\"product-selector-mobile-popup-title\">${Loc.getMessage('CATALOG_SELECTOR_MOBILE_POPUP_TITLE')}</div>\n\t\t\t\t\t\t<div class=\"product-selector-mobile-popup-text\">${Loc.getMessage('CATALOG_SELECTOR_MOBILE_POPUP_INSTRUCTION')}</div>\n\t\t\t\t\t\t<div class=\"product-selector-mobile-popup-qr\">\n\t\t\t\t\t\t\t${this.qrAuth.getQrNode()}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"product-selector-mobile-popup-link-container\">\n\t\t\t\t\t\t\t${helpButton}\n\t\t\t\t\t\t\t${sendButton}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t${closeIcon}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tcloseMobilePopup()\n\t{\n\t\tthis.removeQrAuth();\n\n\t\tajax\n\t\t\t.runAction(\n\t\t\t\t'catalog.ProductSelector.isInstalledMobileApp',\n\t\t\t\t{\n\t\t\t\t\tjson: {}\n\t\t\t\t}\n\t\t\t)\n\t\t\t.then((result) => {\n\t\t\t\tthis.selector.emit('onBarcodeQrClose', {});\n\n\t\t\t\tif (result.data === true)\n\t\t\t\t{\n\t\t\t\t\tthis.selector.emit('onBarcodeScannerInstallChecked', {});\n\t\t\t\t\tthis.isInstalledMobileApp = true;\n\t\t\t\t}\n\t\t\t})\n\t\t;\n\n\t\tuserOptions.save('product-selector', 'barcodeQrAuth', 'showed', 'Y');\n\t}\n\n\thandleClickNameInput(event: UIEvent)\n\t{\n\t\tif (this.qrAuth && this.getDialog().getContainer())\n\t\t{\n\t\t\tif (!Dom.hasClass(this.getDialog().getContainer(), 'qr-barcode-info'))\n\t\t\t{\n\t\t\t\tDom.addClass(this.getDialog().getContainer(),'qr-barcode-info');\n\t\t\t}\n\n\t\t\tif (this.getDialog().getContainer())\n\t\t\t{\n\t\t\t\tDom.append(this.layoutMobileQrPopup(), this.getDialog().getContainer());\n\t\t\t}\n\t\t}\n\n\t\tsuper.handleClickNameInput(event);\n\t}\n\n\tshowItems()\n\t{\n\t\tthis.searchInDialog();\n\t}\n\n\tonChangeValue(value: string)\n\t{\n\t\tconst fields = {};\n\n\t\tthis.getNameInput().title = value;\n\t\tthis.getNameInput().value = value;\n\n\t\tfields[this.inputName] = value;\n\n\t\tEventEmitter.emit('ProductSelector::onBarcodeChange', {\n\t\t\trowId: this.selector.getRowId(),\n\t\t\tfields\n\t\t});\n\n\t\tthis.selector.emit('onBarcodeChange', {value});\n\n\t\tif (this.selector.isEnabledAutosave())\n\t\t{\n\t\t\tthis.selector.getModel().setField(this.inputName, value);\n\t\t\tthis.selector.getModel().showSaveNotifier(\n\t\t\t\t'barcodeChanger_' + this.selector.getId(),\n\t\t\t\t{\n\t\t\t\t\ttitle: Loc.getMessage('CATALOG_SELECTOR_SAVING_NOTIFICATION_BARCODE'),\n\t\t\t\t\tdisableCancel: true,\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tonSave: () => {\n\t\t\t\t\t\t\tif (this.selector)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.selector.getModel().save([this.inputName]);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t}\n\n\tsearchInDialog(): void\n\t{\n\t\tconst searchQuery = this.getFilledValue().trim();\n\t\tthis.searchByBarcode(searchQuery);\n\t}\n\n\tsearchByBarcode(searchQuery: string = ''): void\n\t{\n\t\tif (!this.selector.isProductSearchEnabled())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst dialog = this.getDialog();\n\t\tif (!dialog)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tdialog.removeItems();\n\t\tif (!Type.isStringFilled(searchQuery))\n\t\t{\n\t\t\tif (this.model && this.model.isCatalogExisted())\n\t\t\t{\n\t\t\t\tdialog.setPreselectedItems([[BarcodeSearchInput.SEARCH_TYPE_ID, this.model.getSkuId()]])\n\t\t\t\tdialog.loadState = 'UNSENT';\n\t\t\t\tdialog.load();\n\t\t\t}\n\t\t}\n\n\t\tdialog.show();\n\t\tdialog.search(searchQuery);\n\t}\n\n\thandleNameInputBlur(event: UIEvent)\n\t{\n\t\t// timeout to toggle clear icon handler while cursor is inside of name input\n\t\tsetTimeout(() => {\n\t\t\tthis.toggleIcon(this.getClearIcon(), 'none');\n\n\t\t\tif (this.showDetailLink() && Type.isStringFilled(this.getValue()))\n\t\t\t{\n\t\t\t\tthis.toggleIcon(this.getSearchIcon(), 'none');\n\t\t\t\tthis.toggleIcon(this.getArrowIcon(), 'block');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.toggleIcon(this.getArrowIcon(), 'none');\n\t\t\t\tthis.toggleIcon(\n\t\t\t\t\tthis.getSearchIcon(),\n\t\t\t\t\tType.isStringFilled(this.getFilledValue()) ? 'none' : 'block'\n\t\t\t\t);\n\t\t\t}\n\t\t}, 200);\n\t}\n\n\tsetInputValueOnProductSelect(item: Item)\n\t{\n\t\titem.getDialog().getTargetNode().value = item.getSubtitle()\n\t}\n\n\tgetCreationProduct(name)\n\t{\n\t\tconst fields = {...this.selector.getModel().getFields()};\n\t\tfields[ProductSelector.INPUT_FIELD_NAME] = name;\n\n\t\treturn new ProductModel({\n\t\t\tisSimpleModel: true,\n\t\t\tisNew: true,\n\t\t\tcurrency: this.selector.options.currency,\n\t\t\tiblockId: this.selector.getModel().getIblockId(),\n\t\t\tbasePriceId: this.selector.getModel().getBasePriceId(),\n\t\t\tfields\n\t\t})\n\t}\n\n\tcreateProductModelFromSearchQuery(searchQuery: string)\n\t{\n\t\tconst model = super.createProductModelFromSearchQuery(searchQuery);\n\t\tmodel.setField(ProductSelector.INPUT_FIELD_NAME, Loc.getMessage('CATALOG_SELECTOR_NEW_BARCODE_PRODUCT_NAME'));\n\t\tmodel.setField(this.inputName, searchQuery);\n\n\t\treturn model;\n\t}\n\n\tcheckCreationModel(creationModel: ProductModel): boolean\n\t{\n\t\tif (!Type.isStringFilled(creationModel.getField(ProductSelector.INPUT_FIELD_NAME)))\n\t\t{\n\t\t\tthis.model.getErrorCollection().setError(\n\t\t\t\tSelectorErrorCode.NOT_SELECTED_PRODUCT,\n\t\t\t\tLoc.getMessage('CATALOG_SELECTOR_EMPTY_TITLE')\n\t\t\t);\n\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tgetPlaceholder(): string\n\t{\n\t\treturn (\n\t\t\tthis.isSearchEnabled() && this.model.isEmpty()\n\t\t\t\t? Loc.getMessage('CATALOG_SELECTOR_BEFORE_SEARCH_BARCODE_TITLE')\n\t\t\t\t: Loc.getMessage('CATALOG_SELECTOR_VIEW_BARCODE_TITLE')\n\t\t);\n\t}\n\n\thandleClearIconClick(event: UIEvent)\n\t{\n\t\tthis.toggleIcon(this.getClearIcon(), 'none');\n\t\tthis.onChangeValue('');\n\n\t\tthis.selector.focusName();\n\n\t\tevent.stopPropagation();\n\t\tevent.preventDefault();\n\t}\n\n\tstartMobileScanner(event)\n\t{\n\t\tif (this.isInstalledMobileApp)\n\t\t{\n\t\t\tthis.sendMobilePush(event);\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this.qrAuth)\n\t\t{\n\t\t\tthis.qrAuth = new QrAuthorization();\n\t\t\tthis.qrAuth.createQrCodeImage();\n\t\t}\n\n\t\tif (this.getDialog().isOpen())\n\t\t{\n\t\t\tthis.getDialog().hide();\n\t\t\tthis.getDialog().subscribeOnce('onHide', this.handleClickNameInput.bind(this));\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.handleClickNameInput(event);\n\t\t}\n\t}\n\n\tsendMobilePush(event)\n\t{\n\t\tevent?.preventDefault();\n\t\tthis.getDialog().hide();\n\t\tthis.getNameInput().focus();\n\n\t\tif (!this.selector.isEnabledMobileScanning())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst token = this.selector.getMobileScannerToken();\n\t\tBarcodeScanner.open(token);\n\n\t\tconst repeatLink = Tag.render`<span class='ui-notification-balloon-action'>${Loc.getMessage('CATALOG_SELECTOR_SEND_PUSH_ON_SCANNER_NOTIFICATION_REPEAT')}</span>`;\n\t\tEvent.bind(repeatLink, 'click', this.sendMobilePush.bind(this));\n\n\t\tconst content = Tag.render`\n\t\t\t<div>\n\t\t\t\t<span>${Loc.getMessage('CATALOG_SELECTOR_SEND_PUSH_ON_SCANNER_NOTIFICATION')}</span>\n\t\t\t\t${repeatLink}\n\t\t\t</div>\n\t\t`;\n\n\t\tBX.UI.Notification.Center.notify({\n\t\t\tcontent,\n\t\t\tcategory: 'sending_push_barcode_scanner_notification',\n\t\t\tautoHideDelay: 5000,\n\t\t});\n\t}\n\n\tgetProductIdByBarcode(barcode)\n\t{\n\t\treturn ajax.runAction(\n\t\t\t'catalog.ProductSelector.getProductIdByBarcode',\n\t\t\t{\n\t\t\t\tjson: {\n\t\t\t\t\tbarcode: barcode,\n\t\t\t\t}\n\t\t\t}\n\t\t)\n\t}\n\n\tapplyScannerData(barcode)\n\t{\n\t\tthis.getProductIdByBarcode(barcode).then((response) => {\n\t\t\tconst productId = response?.data;\n\t\t\tif (productId)\n\t\t\t{\n\t\t\t\tthis.selectScannedBarcodeProduct(productId);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.searchByBarcode(barcode);\n\t\t\t}\n\t\t\tthis.getNameInput().value = Text.encode(barcode);\n\t\t});\n\t}\n\n\tselectScannedBarcodeProduct(productId)\n\t{\n\t\tthis.toggleIcon(this.getSearchIcon(), 'none');\n\t\tthis.model.getErrorCollection().clearErrors();\n\t\tif (this.selector)\n\t\t{\n\t\t\tthis.selector.onProductSelect(\n\t\t\t\tproductId,\n\t\t\t\t{\n\t\t\t\t\tisNew: false,\n\t\t\t\t\timmutableFields: [],\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tthis.selector.clearLayout();\n\t\t\tthis.selector.layout();\n\t\t}\n\n\t\tthis.cache.delete('dialog');\n\t}\n\n\tgetBarcodeIcon(): HTMLElement\n\t{\n\t\treturn this.cache.remember('barcodeIcon', () => {\n\t\t\tconst barcodeIcon = Tag.render`\n\t\t\t\t<button\tclass=\"ui-ctl-before warehouse-barcode-icon\" title=\"${Loc.getMessage('CATALOG_SELECTOR_BARCODE_ICON_TITLE')}\"></button>\n\t\t\t`;\n\n\t\t\tif (\n\t\t\t\t!this.settingsCollection.get('isShowedBarcodeSpotlightInfo')\n\t\t\t\t&& this.settingsCollection.get('isAllowedShowBarcodeSpotlightInfo')\n\t\t\t\t&& this.selector.getConfig('ENABLE_INFO_SPOTLIGHT', true)\n\t\t\t)\n\t\t\t{\n\t\t\t\tthis.spotlight = new BX.SpotLight(\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'selector_barcode_scanner_info',\n\t\t\t\t\t\ttargetElement: barcodeIcon,\n\t\t\t\t\t\tautoSave: true,\n\t\t\t\t\t\ttargetVertex: \"middle-center\",\n\t\t\t\t\t\tzIndex: 200\n\t\t\t\t\t}\n\t\t\t\t);\n\n\t\t\t\tthis.spotlight.show();\n\n\t\t\t\tEventEmitter.subscribe(this.spotlight, 'BX.SpotLight:onTargetEnter', () => {\n\t\t\t\t\tconst guide = new Guide({\n\t\t\t\t\t\tsteps: [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttarget: barcodeIcon,\n\t\t\t\t\t\t\t\ttitle: Loc.getMessage('CATALOG_SELECTOR_BARCODE_SCANNER_FIRST_TIME_HINT_TITLE'),\n\t\t\t\t\t\t\t\ttext: Loc.getMessage('CATALOG_SELECTOR_BARCODE_SCANNER_FIRST_TIME_HINT_TEXT'),\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t],\n\t\t\t\t\t\tonEvents: true,\n\t\t\t\t\t});\n\n\t\t\t\t\tguide.getPopup().setAutoHide(true);\n\t\t\t\t\tguide.showNextStep();\n\t\t\t\t\tthis.selector.setConfig('ENABLE_INFO_SPOTLIGHT', false);\n\t\t\t\t\tthis.selector.emit('onSpotlightClose', {});\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tEvent.bind(barcodeIcon, 'click', (event) => {\n\t\t\t\tevent.preventDefault();\n\t\t\t\tif (this.qrAuth)\n\t\t\t\t{\n\t\t\t\t\tthis.handleClickNameInput(event);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.startMobileScanner(event);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\treturn barcodeIcon;\n\t\t});\n\t}\n\n\tlayout(): HTMLElement\n\t{\n\t\tconst block = super.layout();\n\t\tDom.append(this.getBarcodeIcon(), block);\n\t\tthis.getNameInput().className += ' catalog-product-field-input-barcode';\n\t\tEvent.bind(this.getNameInput(), 'focus', this.onFocusHandler);\n\t\tEvent.bind(this.getNameInput(), 'blur', this.onBlurHandler);\n\n\t\treturn block;\n\t}\n\n\tremoveSpotlight()\n\t{\n\t\tif (this.spotlight)\n\t\t{\n\t\t\tthis.spotlight.close();\n\t\t}\n\t}\n\n\tremoveQrAuth()\n\t{\n\t\tconst mobilePopup = this.getDialog().getContainer()?.querySelector('[data-role=\"mobile-popup\"]');\n\t\tif (mobilePopup)\n\t\t{\n\t\t\tDom.remove(mobilePopup);\n\t\t\tif (Dom.hasClass(this.getDialog().getContainer(), 'qr-barcode-info'))\n\t\t\t{\n\t\t\t\tDom.removeClass(this.getDialog().getContainer(),'qr-barcode-info');\n\t\t\t}\n\t\t}\n\n\t\tthis.qrAuth = null;\n\t}\n}\n","import {ajax, Cache, Dom, Event, Extension, Loc, Reflection, Runtime, Tag, Text, Type} from 'main.core';\nimport 'ui.design-tokens';\nimport 'ui.forms';\nimport 'fileinput';\nimport 'ui.notification';\nimport {EventEmitter} from 'main.core.events';\nimport {SkuTree} from 'catalog.sku-tree';\nimport {ProductSearchInput} from \"./product-search-input\";\nimport {ProductImageInput} from \"./product-image-input\";\nimport {ProductModel, RightActionDictionary} from \"catalog.product-model\";\nimport './component.css';\nimport {BarcodeSearchInput} from \"./barcode-search-input\";\nimport {SelectorErrorCode} from \"./selector-error-code\";\n\nconst instances = new Map();\nconst iblockSkuTreeProperties = new Map();\n\nexport class ProductSelector extends EventEmitter\n{\n\tstatic MODE_VIEW = 'view';\n\tstatic MODE_EDIT = 'edit';\n\tstatic INPUT_FIELD_NAME = 'NAME';\n\tstatic INPUT_FIELD_BARCODE = 'BARCODE';\n\n\tstatic ErrorCodes = SelectorErrorCode;\n\t#inAjaxProcess = false;\n\tmode: ProductSelector.MODE_EDIT | ProductSelector.MODE_VIEW = ProductSelector.MODE_EDIT;\n\tcache = new Cache.MemoryCache();\n\ttype = ProductSelector.INPUT_FIELD_NAME;\n\tfileInput: ?ProductImageInput;\n\tsearchInput: ?ProductSearchInput;\n\tskuTreeInstance: ?SkuTree;\n\tmobileScannerToken = null;\n\n\tvariationChangeHandler = this.handleVariationChange.bind(this);\n\tonSaveImageHandler = this.onSaveImage.bind(this);\n\tonChangeFieldsHandler = Runtime.debounce(this.onChangeFields, 500, this);\n\tonUploaderIsInitedHandler = this.onUploaderIsInited.bind(this);\n\tonNameChangeFieldHandler = Runtime.debounce(this.onNameChange, 500, this);\n\n\tstatic getById(id: string): ?ProductSelector\n\t{\n\t\treturn instances.get(id) || null;\n\t}\n\n\tconstructor(id, options = {})\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Catalog.ProductSelector');\n\n\t\tthis.id = id || Text.getRandom();\n\t\toptions.inputFieldName = options.inputFieldName || ProductSelector.INPUT_FIELD_NAME;\n\t\tthis.options = options || {};\n\t\tthis.settings = Extension.getSettings('catalog.product-selector');\n\n\t\tthis.type = this.options.type || ProductSelector.INPUT_FIELD_NAME;\n\n\t\tthis.setMode(options.mode);\n\n\t\tif (options.model && (options.model instanceof ProductModel))\n\t\t{\n\t\t\tthis.model = options.model;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.model = ProductModel.getById(this.id);\n\t\t}\n\n\t\tif (!(this.model instanceof ProductModel))\n\t\t{\n\t\t\tthis.model = new ProductModel(\n\t\t\t\t{\n\t\t\t\t\tcurrency: options.currency,\n\t\t\t\t\tiblockId: Text.toNumber(options.iblockId),\n\t\t\t\t\tbasePriceId: Text.toNumber(options.basePriceId),\n\t\t\t\t\tfields: options.fields,\n\t\t\t\t\tskuTree: options.skuTree,\n\t\t\t\t\tstoreMap: options.storeMap,\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\tthis.model.getImageCollection().setMorePhotoValues(options.morePhotoValues);\n\t\tif (!Type.isNil(this.getConfig('DETAIL_PATH')))\n\t\t{\n\t\t\tthis.model.setDetailPath(this.getConfig('DETAIL_PATH'));\n\t\t}\n\n\t\tif (options.failedProduct)\n\t\t{\n\t\t\tthis.model.getErrorCollection().setError(\n\t\t\t\tSelectorErrorCode.FAILED_PRODUCT,\n\t\t\t\t''\n\t\t\t);\n\t\t}\n\n\t\tif (this.isShowableEmptyProductError())\n\t\t{\n\t\t\tthis.model.getErrorCollection().setError(\n\t\t\t\tSelectorErrorCode.NOT_SELECTED_PRODUCT,\n\t\t\t\tthis.getEmptySelectErrorMessage()\n\t\t\t);\n\t\t}\n\n\t\tif (options.fileView)\n\t\t{\n\t\t\tthis.model.getImageCollection().setPreview(options.fileView);\n\t\t}\n\t\tif (options.fileInput)\n\t\t{\n\t\t\tthis.model.getImageCollection().setEditInput(options.fileInput);\n\t\t}\n\n\t\tthis.layout();\n\n\t\tif (options.skuTree)\n\t\t{\n\t\t\tthis.updateSkuTree(options.skuTree);\n\t\t}\n\n\t\tif (options.scannerToken)\n\t\t{\n\t\t\tthis.setMobileScannerToken(options.scannerToken);\n\t\t}\n\n\t\tthis.subscribeEvents();\n\n\t\tinstances.set(this.id, this);\n\t}\n\n\tsetModel(model: ProductModel): void\n\t{\n\t\tthis.model = model;\n\t}\n\n\tgetModel(): ProductModel\n\t{\n\t\treturn this.model;\n\t}\n\n\tsetMode(mode: ProductSelector.MODE_VIEW | ProductSelector.MODE_EDIT ): void\n\t{\n\t\tif (!Type.isNil(mode))\n\t\t{\n\t\t\tthis.mode = mode === ProductSelector.MODE_VIEW ? ProductSelector.MODE_VIEW : ProductSelector.MODE_EDIT;\n\t\t}\n\t}\n\n\tisViewMode(): boolean\n\t{\n\t\treturn this.mode === ProductSelector.MODE_VIEW;\n\t}\n\n\tisSaveable(): boolean\n\t{\n\t\treturn !this.isViewMode() && this.model.isSaveable();\n\t}\n\n\tisEnabledAutosave(): boolean\n\t{\n\t\treturn this.isSaveable() && this.getConfig('ENABLE_AUTO_SAVE', false);\n\t}\n\n\tisEnabledMobileScanning(): boolean\n\t{\n\t\treturn !this.isViewMode() && this.getConfig('ENABLE_MOBILE_SCANNING', true);\n\t}\n\n\tgetEmptySelectErrorMessage()\n\t{\n\t\treturn this.checkProductAddRights()\n\t\t\t? Loc.getMessage('CATALOG_SELECTOR_SELECTED_PRODUCT_TITLE')\n\t\t\t: Loc.getMessage('CATALOG_SELECTOR_SELECT_PRODUCT_TITLE')\n\t\t;\n\t}\n\n\n\tgetMobileScannerToken(): string\n\t{\n\t\treturn this.mobileScannerToken || Text.getRandom(16);\n\t}\n\n\tcheckProductViewRights(): boolean\n\t{\n\t\treturn this.model.checkAccess(RightActionDictionary.ACTION_PRODUCT_VIEW) ?? true;\n\t}\n\n\tcheckProductEditRights(): boolean\n\t{\n\t\treturn this.model.checkAccess(RightActionDictionary.ACTION_PRODUCT_EDIT) ?? false;\n\t}\n\n\tcheckProductAddRights(): boolean\n\t{\n\t\treturn this.model.checkAccess(RightActionDictionary.ACTION_PRODUCT_ADD) ?? false;\n\t}\n\n\tsetMobileScannerToken(token: string): void\n\t{\n\t\tthis.mobileScannerToken = token;\n\t}\n\n\tremoveMobileScannerToken(): void\n\t{\n\t\tthis.mobileScannerToken = null;\n\t}\n\n\tgetId(): string\n\t{\n\t\treturn this.id;\n\t}\n\n\tgetType(): string\n\t{\n\t\treturn this.type;\n\t}\n\n\tgetConfig(name, defaultValue)\n\t{\n\t\treturn BX.prop.get(this.options.config, name, defaultValue);\n\t}\n\n\tsetConfig(name, value): this\n\t{\n\t\tthis.options.config[name] = value;\n\n\t\treturn this;\n\t}\n\n\tgetRowId(): string\n\t{\n\t\treturn this.getConfig('ROW_ID');\n\t}\n\n\tgetFileInput(): ProductImageInput\n\t{\n\t\tif (!this.fileInput)\n\t\t{\n\t\t\tthis.fileInput = new ProductImageInput(\n\t\t\t\tthis.options.fileInputId,\n\t\t\t\t{\n\t\t\t\t\tselector: this,\n\t\t\t\t\tenableSaving: this.getConfig('ENABLE_IMAGE_CHANGE_SAVING', false)\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\treturn this.fileInput;\n\t}\n\n\tisProductSearchEnabled(): boolean\n\t{\n\t\treturn this.getConfig('ENABLE_SEARCH', false)\n\t\t\t&& this.model.getIblockId() > 0\n\t\t\t&& this.checkProductViewRights()\n\t\t;\n\t}\n\n\tisSkuTreeEnabled(): boolean\n\t{\n\t\treturn this.getConfig('ENABLE_SKU_TREE', true) !== false;\n\t}\n\n\tisImageFieldEnabled(): boolean\n\t{\n\t\treturn this.getConfig('ENABLE_IMAGE_INPUT', true) !== false;\n\t}\n\n\tisShowableEmptyProductError(): boolean\n\t{\n\t\treturn this.isEnabledEmptyProductError() &&\n\t\t\t(\n\t\t\t\tthis.model.isEmpty() && this.model.isChanged()\n\t\t\t\t|| this.model.isSimple()\n\t\t\t);\n\t}\n\n\tisShowableErrors(): boolean\n\t{\n\t\treturn this.isEnabledEmptyProductError() || this.isEnabledEmptyImagesError();\n\t}\n\n\tisEnabledEmptyProductError(): boolean\n\t{\n\t\treturn this.getConfig('ENABLE_EMPTY_PRODUCT_ERROR', false);\n\t}\n\n\tisEnabledEmptyImagesError(): boolean\n\t{\n\t\treturn this.getConfig('ENABLE_EMPTY_IMAGES_ERROR', false);\n\t}\n\n\tisEnabledChangesRendering(): boolean\n\t{\n\t\treturn this.getConfig('ENABLE_CHANGES_RENDERING', true);\n\t}\n\n\tisInputDetailLinkEnabled(): boolean\n\t{\n\t\treturn this.getConfig('ENABLE_INPUT_DETAIL_LINK', false)\n\t\t\t&& Type.isStringFilled(this.model.getDetailPath())\n\t\t\t&& this.checkProductViewRights()\n\t\t;\n\t}\n\n\tgetWrapper(): HTMLElement\n\t{\n\t\tif (!this.wrapper)\n\t\t{\n\t\t\tthis.wrapper = document.getElementById(this.id);\n\t\t}\n\n\t\treturn this.wrapper;\n\t}\n\n\trenderTo(node)\n\t{\n\t\tthis.clearLayout();\n\t\tthis.wrapper = node;\n\t\tthis.layout();\n\t}\n\n\tlayout()\n\t{\n\t\tconst wrapper = this.getWrapper();\n\t\tif (!wrapper)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.defineWrapperClass(wrapper);\n\t\twrapper.innerHTML = '';\n\n\t\tconst block = Tag.render`<div class=\"catalog-product-field-inner\"></div>`;\n\t\tDom.append(this.layoutNameBlock(), block);\n\n\t\tif (this.getSkuTreeInstance())\n\t\t{\n\t\t\tDom.append(this.getSkuTreeInstance().layout(), block);\n\t\t}\n\n\t\tDom.append(this.getErrorContainer(), block);\n\n\t\tif (!this.isViewMode())\n\t\t{\n\t\t\tDom.append(block, wrapper);\n\t\t}\n\n\t\tif (this.isImageFieldEnabled())\n\t\t{\n\t\t\tif (!Reflection.getClass('BX.UI.ImageInput'))\n\t\t\t{\n\t\t\t\tajax\n\t\t\t\t\t.runAction(\t'catalog.productSelector.getFileInput', {\n\t\t\t\t\t\tjson:{\n\t\t\t\t\t\t\tiblockId: this.getModel().getIblockId()\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t\t.then(() => {\n\t\t\t\t\t\tthis.layoutImage();\n\t\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.layoutImage();\n\t\t\t}\n\n\t\t\tDom.append(this.getImageContainer(), wrapper);\n\t\t}\n\n\t\tif (this.isViewMode())\n\t\t{\n\t\t\tDom.append(block, wrapper);\n\t\t}\n\n\t\tif (this.isViewMode())\n\t\t{\n\t\t\tDom.append(block, wrapper);\n\t\t}\n\n\t\tif (this.isShowableErrors)\n\t\t{\n\t\t\tthis.layoutErrors();\n\t\t}\n\n\t\tthis.subscribeToVariationChange();\n\t}\n\n\tfocusName(): this\n\t{\n\t\tif (this.searchInput)\n\t\t{\n\t\t\tthis.searchInput.focusName();\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tgetImageContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('imageContainer', () => (\n\t\t\tTag.render`<div class=\"catalog-product-img\"></div>`\n\t\t));\n\t}\n\n\tgetErrorContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('errorContainer', () => (\n\t\t\tTag.render`<div class=\"catalog-product-error\"></div>`\n\t\t));\n\t}\n\n\tlayoutErrors()\n\t{\n\t\tthis.getErrorContainer().innerHTML = '';\n\t\tthis.clearImageErrorBorder();\n\t\tif (!this.model.getErrorCollection().hasErrors())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst errors = this.model.getErrorCollection().getErrors();\n\t\tfor (const code in errors)\n\t\t{\n\t\t\tif (code === 'EMPTY_IMAGE')\n\t\t\t{\n\t\t\t\tthis.setImageErrorBorder();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tDom.append(\n\t\t\t\t\tTag.render`<div class=\"catalog-product-error-item\">${errors[code].text}</div>`,\n\t\t\t\t\tthis.getErrorContainer()\n\t\t\t\t);\n\n\t\t\t\tif (this.searchInput)\n\t\t\t\t{\n\t\t\t\t\tDom.addClass(this.searchInput.getNameBlock(), 'ui-ctl-danger');\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tsetImageErrorBorder()\n\t{\n\t\tDom.addClass(\n\t\t\tthis.getImageContainer().querySelector('.adm-fileinput-area'),\n\t\t\t'adm-fileinput-drag-area-error'\n\t\t);\n\t}\n\n\tclearImageErrorBorder()\n\t{\n\t\tDom.removeClass(\n\t\t\tthis.getImageContainer().querySelector('.adm-fileinput-area'),\n\t\t\t'adm-fileinput-drag-area-error'\n\t\t);\n\t}\n\n\tonUploaderIsInited()\n\t{\n\t\tif (this.isEnabledEmptyImagesError())\n\t\t{\n\t\t\trequestAnimationFrame(this.layoutErrors.bind(this));\n\t\t}\n\t}\n\n\tlayoutImage()\n\t{\n\t\tthis.getImageContainer().innerHTML = '';\n\t\tDom.append(this.getFileInput().layout(), this.getImageContainer());\n\t\tthis.refreshImageSelectorId = null;\n\t}\n\n\tclearState(): void\n\t{\n\t\tthis\n\t\t\t.getModel()\n\t\t\t.initFields({\n\t\t\t\tID: '',\n\t\t\t\tNAME: '',\n\t\t\t\tBARCODE: '',\n\t\t\t\tPRODUCT_ID: null,\n\t\t\t\tSKU_ID: null,\n\t\t\t})\n\t\t\t.setOption('isNew', false)\n\t\t;\n\n\t\tthis\n\t\t\t.getFileInput()\n\t\t\t.restoreDefaultInputHtml()\n\t\t;\n\n\t\tthis\n\t\t\t.getModel()\n\t\t\t.clearSkuTree()\n\t\t;\n\t\tthis.skuTreeInstance = null;\n\n\t\tthis\n\t\t\t.getModel()\n\t\t\t.getStoreCollection()\n\t\t\t.clear()\n\t\t;\n\t}\n\n\tclearLayout(): void\n\t{\n\t\tconst wrapper = this.getWrapper();\n\t\tif (wrapper)\n\t\t{\n\t\t\twrapper.innerHTML = '';\n\t\t}\n\n\t\tthis.unsubscribeToVariationChange();\n\t}\n\n\tsubscribeEvents()\n\t{\n\t\tEventEmitter.subscribe('ProductList::onChangeFields', this.onChangeFieldsHandler);\n\t\tEventEmitter.subscribe('ProductSelector::onNameChange', this.onNameChangeFieldHandler);\n\t\tEventEmitter.subscribe('Catalog.ImageInput::save', this.onSaveImageHandler);\n\t\tEventEmitter.subscribe('onUploaderIsInited', this.onUploaderIsInitedHandler);\n\t}\n\n\tunsubscribeEvents()\n\t{\n\t\tthis.unsubscribeToVariationChange();\n\n\t\tEventEmitter.unsubscribe('Catalog.ImageInput::save', this.onSaveImageHandler);\n\t\tEventEmitter.unsubscribe('ProductList::onChangeFields', this.onChangeFieldsHandler);\n\t\tEventEmitter.unsubscribe('onUploaderIsInited', this.onUploaderIsInitedHandler);\n\t\tEventEmitter.unsubscribe('onUploaderIsInited', this.onUploaderIsInitedHandler);\n\t\tEventEmitter.unsubscribe('ProductSelector::onNameChange', this.onNameChangeFieldHandler);\n\t}\n\n\tdefineWrapperClass(wrapper)\n\t{\n\t\tif (this.isViewMode())\n\t\t{\n\t\t\tDom.addClass(wrapper, 'catalog-product-view');\n\t\t\tDom.removeClass(wrapper, 'catalog-product-edit');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.addClass(wrapper, 'catalog-product-edit');\n\t\t\tDom.removeClass(wrapper, 'catalog-product-view');\n\t\t}\n\t}\n\n\tgetNameBlockView(): HTMLElement\n\t{\n\t\tconst productName = Text.encode(this.model.getField('NAME'));\n\t\tconst namePlaceholder = Loc.getMessage('CATALOG_SELECTOR_VIEW_NAME_TITLE');\n\n\t\tif (this.getModel().getDetailPath())\n\t\t{\n\t\t\treturn Tag.render`\n\t\t\t\t<a href=\"${this.getModel().getDetailPath()}\" title=\"${namePlaceholder}\">${productName}</a>\n\t\t\t`;\n\t\t}\n\n\t\treturn Tag.render`<span title=\"${namePlaceholder}\">${productName}</span>`;\n\n\t}\n\n\tgetNameInputFilledValue(): string\n\t{\n\t\tif (this.searchInput)\n\t\t{\n\t\t\treturn this.searchInput.getFilledValue();\n\t\t}\n\n\t\treturn '';\n\t}\n\n\tlayoutNameBlock(): HTMLElement\n\t{\n\t\tconst block = Tag.render`<div class=\"catalog-product-field-input\"></div>`;\n\n\t\tif (this.isViewMode())\n\t\t{\n\t\t\tDom.append(this.getNameBlockView(), block);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (this.getType() === ProductSelector.INPUT_FIELD_BARCODE)\n\t\t\t{\n\t\t\t\tif (!this.searchInput)\n\t\t\t\t{\n\t\t\t\t\tthis.searchInput = new BarcodeSearchInput(\n\t\t\t\t\t\tthis.id,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tselector: this,\n\t\t\t\t\t\t\tmodel: this.getModel(),\n\t\t\t\t\t\t\tinputName: this.options.inputFieldName,\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.searchInput = new ProductSearchInput(\n\t\t\t\t\tthis.id,\n\t\t\t\t\t{\n\t\t\t\t\t\tselector: this,\n\t\t\t\t\t\tmodel: this.getModel(),\n\t\t\t\t\t\tinputName: this.options.inputFieldName,\n\t\t\t\t\t\tisSearchEnabled: this.isProductSearchEnabled(),\n\t\t\t\t\t\tisEnabledEmptyProductError: this.isEnabledEmptyProductError(),\n\t\t\t\t\t\tisEnabledDetailLink: this.isInputDetailLinkEnabled()\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tDom.append(this.searchInput.layout(), block);\n\t\t}\n\n\t\treturn block;\n\t}\n\n\tsearchInDialog(): ProductSelector\n\t{\n\t\tthis.searchInput.searchInDialog();\n\n\t\treturn this;\n\t}\n\n\tupdateSkuTree(tree): ProductSelector\n\t{\n\t\tthis.getModel().setSkuTree(tree);\n\t\tthis.skuTreeInstance = null;\n\n\t\treturn this;\n\t}\n\n\tgetIblockSkuTreeProperties(): Promise\n\t{\n\t\treturn new Promise((resolve) => {\n\t\t\tif (iblockSkuTreeProperties.has(this.getModel().getIblockId()))\n\t\t\t{\n\t\t\t\tresolve(iblockSkuTreeProperties.get(this.getModel().getIblockId()));\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tajax.runAction(\n\t\t\t\t\t'catalog.productSelector.getSkuTreeProperties',\n\t\t\t\t\t{\n\t\t\t\t\t\tjson: {\n\t\t\t\t\t\t\tiblockId: this.getModel().getIblockId(),\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t\t\t.then(response => {\n\t\t\t\t\t\tiblockSkuTreeProperties.set(this.getModel().getIblockId(), response)\n\t\t\t\t\t\tresolve(response);\n\t\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\n\tgetSkuTreeInstance(): SkuTree\n\t{\n\t\tif (this.isSkuTreeEnabled() && this.getModel()?.getSkuTree() && !this.skuTreeInstance)\n\t\t{\n\t\t\tthis.skuTreeInstance = new SkuTree({\n\t\t\t\tskuTree: this.getModel().getSkuTree(),\n\t\t\t\tselectable: this.getConfig('ENABLE_SKU_SELECTION', true),\n\t\t\t\thideUnselected: this.getConfig('HIDE_UNSELECTED_ITEMS', false),\n\t\t\t});\n\t\t}\n\n\t\treturn this.skuTreeInstance;\n\t}\n\n\tsubscribeToVariationChange()\n\t{\n\t\tconst skuTree = this.getSkuTreeInstance();\n\t\tif (skuTree)\n\t\t{\n\t\t\tthis.unsubscribeToVariationChange();\n\t\t\tskuTree.subscribe('SkuProperty::onChange', this.variationChangeHandler);\n\t\t}\n\t}\n\n\tunsubscribeToVariationChange()\n\t{\n\t\tconst skuTree = this.getSkuTreeInstance();\n\t\tif (skuTree)\n\t\t{\n\t\t\tskuTree.unsubscribe('SkuProperty::onChange', this.variationChangeHandler);\n\t\t}\n\t}\n\n\thandleVariationChange(event)\n\t{\n\t\tconst [skuFields] = event.getData();\n\t\tconst productId = Text.toNumber(skuFields.PARENT_PRODUCT_ID);\n\t\tconst variationId = Text.toNumber(skuFields.ID);\n\n\t\tif (productId <= 0 || variationId <= 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.emit('onBeforeChange', {\n\t\t\tselectorId: this.getId(),\n\t\t\trowId: this.getRowId()\n\t\t});\n\n\t\tthis.#inAjaxProcess = true;\n\t\tajax.runAction(\n\t\t\t'catalog.productSelector.getSelectedSku',\n\t\t\t{\n\t\t\t\tjson: {\n\t\t\t\t\tvariationId,\n\t\t\t\t\toptions: {\n\t\t\t\t\t\tpriceId: this.basePriceId,\n\t\t\t\t\t\tcurrency: this.model.getCurrency(),\n\t\t\t\t\t\turlBuilder: this.getConfig('URL_BUILDER_CONTEXT')\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t)\n\t\t\t.then(response => this.processResponse(response, {...this.options.config}));\n\t}\n\n\tonChangeFields(event)\n\t{\n\t\tconst eventData = event.getData();\n\n\t\tif (eventData.rowId !== this.getRowId())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst fields = eventData.fields;\n\t\tthis.getModel().setFields(fields);\n\t}\n\n\treloadFileInput()\n\t{\n\t\tajax\n\t\t\t.runAction(\t'catalog.productSelector.getFileInput', {\n\t\t\t\tjson:{\n\t\t\t\t\tiblockId: this.getModel().getIblockId(),\n\t\t\t\t\tskuId: this.getModel()?.getSkuId()\n\t\t\t\t}\n\t\t\t})\n\t\t\t.then((event) => {\n\t\t\t\tthis.getModel().getImageCollection().setEditInput(event.data.html);\n\t\t\t\tif (this.isImageFieldEnabled())\n\t\t\t\t{\n\t\t\t\t\tthis.layoutImage();\n\t\t\t\t}\n\t\t\t});\n\t}\n\n\tonNameChange(event)\n\t{\n\t\tconst eventData = event.getData();\n\n\t\tif (eventData.rowId !== this.getRowId() || !this.isEnabledAutosave())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst fields = eventData.fields;\n\t\tthis.getModel().setFields(fields);\n\t\tthis.getModel().save().then(() => {\n\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\tid: 'saving_field_notify_name',\n\t\t\t\tcloseButton: false,\n\t\t\t\tcontent: Tag.render`<div>${Loc.getMessage('CATALOG_SELECTOR_SAVING_NOTIFICATION_NAME_CHANGED')}</div>`,\n\t\t\t\tautoHide: true,\n\t\t\t});\n\t\t});\n\t}\n\n\tonSaveImage(event)\n\t{\n\t\tconst [, inputId, response] = event.getData();\n\t\tif (inputId !== this.getFileInput().getId())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.getFileInput().setId(response.data.id);\n\t\tthis.getFileInput().setInputHtml(response.data.input);\n\t\tthis.getFileInput().setView(response.data.preview);\n\t\tthis.getModel().getImageCollection().setMorePhotoValues(response.data.values);\n\t\tif (this.isImageFieldEnabled())\n\t\t{\n\t\t\tthis.layoutImage();\n\t\t}\n\n\t\tthis.emit('onChange', {\n\t\t\tselectorId: this.id,\n\t\t\trowId: this.getRowId(),\n\t\t\tfields: this.getModel().getFields(),\n\t\t\tmorePhoto: this.getModel().getImageCollection().getMorePhotoValues(),\n\t\t});\n\t}\n\n\tinProcess()\n\t{\n\t\treturn this.#inAjaxProcess;\n\t}\n\n\tonProductSelect(productId, itemConfig)\n\t{\n\t\tthis.emit('onProductSelect', {\n\t\t\tselectorId: this.getId(),\n\t\t\trowId: this.getRowId()\n\t\t});\n\n\t\tthis.emit('onBeforeChange', {\n\t\t\tselectorId: this.getId(),\n\t\t\trowId: this.getRowId()\n\t\t});\n\n\t\tthis.productSelectAjaxAction(productId, itemConfig);\n\t}\n\n\tproductSelectAjaxAction(\n\t\tproductId,\n\t\titemConfig = {\n\t\t\tisNew: false,\n\t\t\timmutableFields: [],\n\t\t}\n\t)\n\t{\n\t\tthis.#inAjaxProcess = true\n\t\tajax\n\t\t\t.runAction(\n\t\t\t\t'catalog.productSelector.getProduct',\n\t\t\t\t{\n\t\t\t\t\tjson: {\n\t\t\t\t\t\tproductId,\n\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\tpriceId: this.basePriceId,\n\t\t\t\t\t\t\tcurrency: this.model.getCurrency(),\n\t\t\t\t\t\t\turlBuilder: this.getConfig('URL_BUILDER_CONTEXT')\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t)\n\t\t\t.then(response => this.processResponse(response, {...this.options.config, ...itemConfig}, true));\n\t}\n\n\tprocessResponse(response, config = {}, isProductAction = false)\n\t{\n\t\tconst data = response?.data || null;\n\t\tthis.#inAjaxProcess = false;\n\n\t\tif (isProductAction)\n\t\t{\n\t\t\tthis.clearState();\n\t\t}\n\n\t\tif (data)\n\t\t{\n\t\t\tthis.changeSelectedElement(data, config);\n\t\t}\n\t\telse if (!isProductAction)\n\t\t{\n\t\t\tthis.productSelectAjaxAction(this.getModel().getProductId());\n\t\t}\n\n\t\tthis.unsubscribeToVariationChange();\n\n\t\tif (this.isEnabledChangesRendering())\n\t\t{\n\t\t\tthis.clearLayout();\n\t\t\tthis.layout();\n\t\t}\n\n\t\tconst fields = data?.fields || null;\n\t\tif (Type.isArray(config.immutableFields))\n\t\t{\n\t\t\tconfig.immutableFields.forEach((field) => {\n\t\t\t\tfields[field] = this.getModel().getField(field);\n\t\t\t});\n\t\t}\n\n\t\tthis.emit('onChange', {\n\t\t\tselectorId: this.id,\n\t\t\trowId: this.getRowId(),\n\t\t\tisNew: config.isNew || false,\n\t\t\tfields,\n\t\t\tmorePhoto: this.getModel().getImageCollection().getMorePhotoValues(),\n\t\t});\n\t}\n\n\tchangeSelectedElement(data, config)\n\t{\n\t\tconst productId = Text.toInteger(data.productId);\n\t\tconst productChanged = this.getModel().getProductId() !== productId;\n\n\t\tif (productChanged)\n\t\t{\n\t\t\tthis.getModel().setOption('productId', productId);\n\t\t\tthis.getModel().setOption('skuId', Text.toInteger(data.skuId));\n\t\t\tthis.getModel().setOption('isSimpleModel', false);\n\t\t\tthis.getModel().setOption('isNew', config.isNew);\n\t\t}\n\n\t\tif (Type.isArray(this.options.immutableFields))\n\t\t{\n\t\t\tthis.options.immutableFields.forEach((field) => {\n\t\t\t\tdata.fields[field] = this.getModel().getField(field);\n\t\t\t});\n\t\t}\n\n\t\tif (Type.isArray(config.immutableFields))\n\t\t{\n\t\t\tconfig.immutableFields.forEach((field) => {\n\t\t\t\tdata.fields[field] = this.getModel().getField(field);\n\t\t\t});\n\t\t}\n\n\t\tthis.getModel().initFields(data.fields);\n\n\t\tconst imageField = {\n\t\t\tid: '',\n\t\t\tinput: '',\n\t\t\tpreview: '',\n\t\t\tvalues: []\n\t\t};\n\n\t\tif (Type.isObject(data.image))\n\t\t{\n\t\t\timageField.id = data.image.id;\n\t\t\timageField.input = data.image.input;\n\t\t\timageField.preview = data.image.preview;\n\t\t\timageField.values = data.image.values;\n\t\t}\n\n\t\tthis.getFileInput().setId(imageField.id);\n\t\tthis.getFileInput().setInputHtml(imageField.input);\n\t\tthis.getFileInput().setView(imageField.preview);\n\n\t\tthis.getModel().getImageCollection().setMorePhotoValues(imageField.values);\n\t\tthis.checkEmptyImageError();\n\n\t\tif (data.detailUrl)\n\t\t{\n\t\t\tthis.getModel().setDetailPath(data.detailUrl);\n\t\t}\n\n\t\tif (Type.isObject(data.skuTree))\n\t\t{\n\t\t\tthis.updateSkuTree(data.skuTree);\n\t\t}\n\t}\n\n\tcheckEmptyImageError()\n\t{\n\t\tif (\n\t\t\t!Type.isArrayFilled(this.getModel().getImageCollection().getMorePhotoValues())\n\t\t\t&& this.isEnabledEmptyImagesError()\n\t\t)\n\t\t{\n\t\t\tthis.getModel().getErrorCollection().setError(\n\t\t\t\t'EMPTY_IMAGE',\n\t\t\t\tLoc.getMessage('CATALOG_SELECTOR_EMPTY_IMAGE_ERROR'),\n\t\t\t);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.getModel().getErrorCollection().removeError('EMPTY_IMAGE');\n\t\t}\n\t}\n\n\tremoveSpotlight()\n\t{\n\t\tthis.searchInput?.removeSpotlight();\n\t\tthis.setConfig('ENABLE_INFO_SPOTLIGHT', false);\n\t}\n\n\tremoveQrAuth()\n\t{\n\t\tthis.searchInput?.removeQrAuth();\n\t\tthis.setConfig('ENABLE_BARCODE_QR_AUTH', false);\n\t}\n}\n"],"names":["ProductSearchSelectorFooter","DefaultFooter","constructor","dialog","options","loader","errorAdminHint","getDialog","subscribe","handleOnSearch","bind","getContent","phrase","isViewCreateButton","allowCreateItem","allowEditItem","isViewEditButton","Tag","render","Loc","getMessage","createButton","querySelector","Dom","replace","getLabelContainer","changeButton","getSaveContainer","getHintContainer","getLoaderContainer","getLoader","Type","isNil","Loader","target","size","color","showLoader","show","hideLoader","hide","setLabel","label","isString","textContent","cache","remember","handleClick","getOption","getQueryContainer","className","messageId","inputName","ProductSelector","INPUT_FIELD_BARCODE","onClickSaveChanges","message","hintNode","dataset","hint","hintNoIcon","BX","UI","Hint","initNode","lastQuery","getActiveTab","getLastSearchQuery","emit","query","clearSearch","createItem","tagSelector","getTagSelector","isLocked","finalize","unlock","focusSearch","event","preventDefault","lock","emitAsync","searchQuery","then","getTab","clearResults","selectFirstTab","catch","getData","currentValue","ProductCreationLimitedFooter","infoButton","Event","InfoHelper","SelectorErrorCode","NOT_SELECTED_PRODUCT","FAILED_PRODUCT","DialogMode","SEARCHING","SHOW_PRODUCT_ITEM","SHOW_RECENT","ProductSearchInput","id","Cache","MemoryCache","Text","getRandom","selector","Error","model","isEnabledSearch","isSearchEnabled","isEnabledDetailLink","INPUT_FIELD_NAME","immutableFieldNames","includes","push","ajaxInProcess","loadedSelectedItem","handleSearchInput","Runtime","debounce","searchInDialog","destroy","getId","getSelectorType","getField","fieldName","getValue","getFilledValue","getNameInput","value","toggleIcon","icon","isDomNode","style","getNameBlock","getNameTag","getHiddenNameInput","isNew","input","encode","getPlaceholder","handleNameInputHiddenChange","getConfig","addClass","setAttribute","getClearIcon","handleClearIconClick","getArrowIcon","getDetailPath","getSearchIcon","handleSearchIconClick","layout","clearInputCache","block","append","isProductSearchEnabled","initHasDialogItems","isStringFilled","handleClickNameInput","handleNameInputBlur","handleNameInputKeyDown","dialogMode","isCatalogExisted","showDetailLink","handleIconsSwitchingOnNameInput","handleNameInputChange","searchTypeId","SEARCH_TYPE_ID","entity","iblockId","getIblockId","basePriceId","getBasePriceId","currency","getCurrency","dynamicLoad","dynamicSearch","restrictedProductTypes","params","height","width","Math","max","offsetWidth","context","targetNode","enableSearch","multiple","dropdownMode","searchTabOptions","stub","stubOptions","title","subtitle","isAllowedCreateProduct","arrow","events","onProductSelect","createProduct","showChangeNotification","entities","settingsCollection","Extension","getSettings","isObject","get","footer","footerOptions","isAllowedEditProduct","creationLabel","searchOptions","Dialog","getModel","isEmpty","setConfig","hasDynamicLoad","subscribeOnce","getPreselectedItems","length","checkProductAddRights","checkProductEditRights","key","getSearchTab","stopPropagation","Browser","isMac","metaKey","ctrlKey","getFooter","delete","clearState","clearLayout","newValue","onChangeValue","focusName","selectorId","rowId","getRowId","fields","EventEmitter","isEnabledAutosave","setFields","save","Notification","Center","notify","closeButton","content","autoHide","requestAnimationFrame","focus","trim","isHasDialogItems","isSearchingInProcess","isOpen","showItems","setTimeout","isEnabledEmptyProductError","inProcess","getErrorCollection","setError","getEmptySelectErrorMessage","layoutErrors","getImmutableFieldNames","setInputValueOnProductSelect","item","getTargetNode","getTitle","clearErrors","getCustomData","immutableFields","forEach","setField","createProductModelFromSearchQuery","getFields","ProductModel","isSimpleModel","getTarget","newProduct","getQuery","Promise","resolve","reject","checkCreationModel","response","toInteger","data","addItem","entityId","tabs","getRecentTab","customData","setOption","name","select","errorResponse","errors","error","creationModel","getType","onSave","declineCancelTitle","onCancel","showSaveNotifier","removeSpotlight","removeQrAuth","removeItems","ajax","runAction","json","getSkuId","isLoading","setPreselectedItems","getRootNode","getPopup","loadState","load","search","ProductImageInput","config","getImageCollection","getEditInput","restoreDefaultInputHtml","enableSaving","uploaderFieldMap","setId","setView","html","setPreview","setInputHtml","setEditInput","defaultInput","isViewMode","isSaveable","isEnabledLiveSaving","imageContainer","getPreview","BarcodeSearchSelectorFooter","isEmptyBarcode","barcodeContent","scannerContent","getScannerContent","getScannerLabelContainer","handleScannerClick","getScannerQueryContainer","inputEntity","startMobileScanner","BarcodeSearchInput","onFocusHandler","handleFocusEvent","onBlurHandler","handleBlurEvent","focused","isInstalledMobileApp","qrAuth","QrAuthorization","createQrCodeImage","unbind","searchFields","type","system","searchable","preselectedItems","layoutMobileQrPopup","closeIcon","closeMobilePopup","sendButton","helpButton","top","Helper","getQrNode","result","userOptions","getContainer","hasClass","disableCancel","searchByBarcode","getSubtitle","getCreationProduct","sendMobilePush","isEnabledMobileScanning","token","getMobileScannerToken","BarcodeScanner","open","repeatLink","category","autoHideDelay","getProductIdByBarcode","barcode","applyScannerData","productId","selectScannedBarcodeProduct","getBarcodeIcon","barcodeIcon","spotlight","SpotLight","targetElement","autoSave","targetVertex","zIndex","guide","Guide","steps","text","onEvents","setAutoHide","showNextStep","close","mobilePopup","remove","removeClass","instances","Map","iblockSkuTreeProperties","getById","mode","MODE_EDIT","mobileScannerToken","variationChangeHandler","handleVariationChange","onSaveImageHandler","onSaveImage","onChangeFieldsHandler","onChangeFields","onUploaderIsInitedHandler","onUploaderIsInited","onNameChangeFieldHandler","onNameChange","setEventNamespace","inputFieldName","settings","setMode","toNumber","skuTree","storeMap","setMorePhotoValues","morePhotoValues","setDetailPath","failedProduct","isShowableEmptyProductError","fileView","fileInput","updateSkuTree","scannerToken","setMobileScannerToken","subscribeEvents","set","setModel","MODE_VIEW","checkProductViewRights","checkAccess","RightActionDictionary","ACTION_PRODUCT_VIEW","ACTION_PRODUCT_EDIT","ACTION_PRODUCT_ADD","removeMobileScannerToken","defaultValue","prop","getFileInput","fileInputId","isSkuTreeEnabled","isImageFieldEnabled","isChanged","isSimple","isShowableErrors","isEnabledEmptyImagesError","isEnabledChangesRendering","isInputDetailLinkEnabled","getWrapper","wrapper","document","getElementById","renderTo","node","defineWrapperClass","innerHTML","layoutNameBlock","getSkuTreeInstance","getErrorContainer","Reflection","getClass","layoutImage","getImageContainer","subscribeToVariationChange","searchInput","clearImageErrorBorder","hasErrors","getErrors","code","setImageErrorBorder","refreshImageSelectorId","initFields","ID","NAME","BARCODE","PRODUCT_ID","SKU_ID","clearSkuTree","skuTreeInstance","getStoreCollection","clear","unsubscribeToVariationChange","unsubscribeEvents","unsubscribe","getNameBlockView","productName","namePlaceholder","getNameInputFilledValue","tree","setSkuTree","getIblockSkuTreeProperties","has","getSkuTree","SkuTree","selectable","hideUnselected","skuFields","PARENT_PRODUCT_ID","variationId","priceId","urlBuilder","processResponse","eventData","reloadFileInput","skuId","inputId","preview","values","morePhoto","getMorePhotoValues","itemConfig","productSelectAjaxAction","isProductAction","changeSelectedElement","getProductId","isArray","field","productChanged","imageField","image","checkEmptyImageError","detailUrl","isArrayFilled","removeError","ErrorCodes"],"mappings":"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"}