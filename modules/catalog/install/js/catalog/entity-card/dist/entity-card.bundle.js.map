{"version":3,"file":"entity-card.bundle.js","sources":["../src/iblock-section/field.js","../src/name-code/field.js","../src/fields-factory.js","../src/iblock-section/controller.js","../src/grid/grid-store.js","../src/variation-grid/controller.js","../src/variation-link/controller.js","../src/google-map/controller.js","../src/employee/controller.js","../src/user/controller.js","../src/iblock-element/controller.js","../src/binding-to-crm-element/controller.js","../src/field-configurator/controller.js","../src/product-service-grid/controller.js","../src/controllers-factory.js","../src/field-configurator/iblock-directory-field-item.js","../src/field-configurator/iblock-field-configurator.js","../src/field-configurator/iblock-field-configuration-manager.js","../src/field-configurator/grid-field-configurator.js","../src/field-configurator/grid-field-configuration-manager.js","../src/tab/lazy-loader.js","../src/tab/tab.js","../src/tab/manager.js","../src/base-card/base-card.js","../src/entity-card.js"],"sourcesContent":["import 'ui.design-tokens';\nimport './field.css'\nimport {ajax, Dom, Event, Loc, Runtime, Tag, Text, Type} from 'main.core'\nimport {type BaseEvent, EventEmitter} from 'main.core.events'\n\nexport default class IblockSectionField extends BX.UI.EntityEditorField\n{\n\tconstructor(id, settings)\n\t{\n\t\tsuper();\n\t\tthis.initialize(id, settings);\n\n\t\tthis.innerWrapper = null;\n\t}\n\n\tgetContentWrapper()\n\t{\n\t\treturn this.innerWrapper;\n\t}\n\n\tlayout(options = {})\n\t{\n\t\tif (this._hasLayout)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.ensureWrapperCreated({classNames: ['catalog-entity-editor-content-block-field-iblock-section']});\n\t\tthis.adjustWrapper();\n\n\t\tif (this.isNeedToDisplay())\n\t\t{\n\t\t\tthis._wrapper.appendChild(this.createTitleNode(this.getTitle()));\n\n\t\t\tif (this._mode === BX.UI.EntityEditorMode.edit)\n\t\t\t{\n\t\t\t\tthis.drawEditMode();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.drawViewMode();\n\t\t\t}\n\n\t\t\tif (this.isContextMenuEnabled())\n\t\t\t{\n\t\t\t\tthis._wrapper.appendChild(this.createContextMenuButton());\n\t\t\t}\n\t\t}\n\n\t\tthis.registerLayout(options);\n\t\tthis._hasLayout = true;\n\t}\n\n\tdrawEditMode()\n\t{\n\t\tthis.defaultInput = Tag.render`<input type=\"hidden\" name=\"${this.getName()}[]\" value=\"0\">`;\n\t\tthis._wrapper.appendChild(this.defaultInput);\n\n\t\tthis.innerWrapper = Tag.render`<div class=\"ui-entity-editor-content-block\"></div>`;\n\t\tthis._wrapper.appendChild(this.innerWrapper);\n\n\t\tajax.runComponentAction(\n\t\t\t'bitrix:catalog.productcard.iblocksectionfield',\n\t\t\t'lazyLoad',\n\t\t\t{\n\t\t\t\tmode: 'ajax',\n\t\t\t\tdata: {\n\t\t\t\t\tiblockId: this.getIblockId(),\n\t\t\t\t\tproductId: this.getProductId(),\n\t\t\t\t\tselectedSectionIds: this.getValue()\n\t\t\t\t}\n\t\t\t}\n\t\t)\n\t\t\t.then(this.renderFromResponse.bind(this))\n\t\t\t.catch(response => {\n\t\t\t\tthrow new Error(response.errors.join(\"\\n\"));\n\t\t\t})\n\t\t;\n\t}\n\n\trenderFromResponse(response)\n\t{\n\t\tif (!this._wrapper)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tRuntime.html(this.innerWrapper, response.data.html, {\n\t\t\tcallback: this.initEntitySelector.bind(this)\n\t\t});\n\t}\n\n\tinitEntitySelector()\n\t{\n\t\tEventEmitter.subscribe(EventEmitter.GLOBAL_TARGET, 'Item:onSelect', this.markAsChanged.bind(this));\n\t\tEventEmitter.subscribe(EventEmitter.GLOBAL_TARGET, 'Item:onDeselect', this.markAsChanged.bind(this));\n\t}\n\n\tchangeDisplay(node, isShow)\n\t{\n\t\tif (!node)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tnode.style.display = isShow ? '' : 'none';\n\t}\n\n\tmarkAsChanged(event: BaseEvent)\n\t{\n\t\tsuper.markAsChanged();\n\t\tEventEmitter.emit(this.getEditor(), 'IblockSectionField:onChange', [this, ...event.getData()]);\n\t}\n\n\tdrawViewMode()\n\t{\n\t\tif (this.hasNoSections())\n\t\t{\n\t\t\tthis.innerWrapper = Tag.render`\n\t\t\t\t<div class=\"ui-entity-editor-content-block\">\n\t\t\t\t\t${Loc.getMessage(\"CATALOG_ENTITY_CARD_EMPTY_SECTION\")}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t\tDom.addClass(this._wrapper, 'ui-entity-editor-content-block-click-empty');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst content = [];\n\t\t\tthis.getSections().forEach((section) => {\n\t\t\t\t// ui-tile-selector-item-%type%\n\t\t\t\tlet picture = '';\n\t\t\t\tif (Type.isStringFilled(section.PICTURE))\n\t\t\t\t{\n\t\t\t\t\tpicture = Tag.render`<span class=\"ui-tile-selector-item-picture\" style=\"background-image: url('${Text.encode(section.PICTURE)}');\"></span>`;\n\t\t\t\t}\n\t\t\t\tcontent.push(Tag.render`\n\t\t\t\t\t<span class=\"ui-tile-selector-item ui-tile-selector-item-readonly-yes\">\n\t\t\t\t\t\t${picture}\n\t\t\t\t\t\t<span data-role=\"tile-item-name\">${Text.encode(section.NAME)}</span>\n\t\t\t\t\t</span>\n\t\t\t\t`)\n\t\t\t});\n\t\t\tthis.innerWrapper = Tag.render`\n\t\t\t\t<div class=\"ui-entity-editor-content-block\">\n\t\t\t\t\t<span class=\"ui-tile-selector-selector-wrap readonly\">\n\t\t\t\t\t\t${content}\n\t\t\t\t\t</span>\n\t\t\t\t</div>`\n\t\t\t;\n\t\t}\n\n\t\tthis._wrapper.appendChild(this.innerWrapper);\n\t}\n\n\tgetSections()\n\t{\n\t\treturn this._model.getField('IBLOCK_SECTION_DATA', {});\n\t}\n\n\tgetIblockId()\n\t{\n\t\treturn this._model.getField('IBLOCK_ID', 0);\n\t}\n\n\tgetProductId()\n\t{\n\t\treturn this._model.getField('ID', 0);\n\t}\n\n\thasNoSections()\n\t{\n\t\tconst sectionIds = this.getValue();\n\n\t\treturn sectionIds.length === 0\n\t\t\t|| (\n\t\t\t\tsectionIds.length === 1\n\t\t\t\t&& (sectionIds.includes('0') || sectionIds.includes(0))\n\t\t\t);\n\t}\n\n\tdoClearLayout(options)\n\t{\n\t\tif (this.defaultInput)\n\t\t{\n\t\t\tDom.clean(this.defaultInput);\n\t\t\tthis.defaultInput = null;\n\t\t}\n\n\t\tif (this.innerWrapper)\n\t\t{\n\t\t\tDom.clean(this.innerWrapper);\n\t\t\tthis.innerWrapper = null;\n\t\t}\n\n\t\tthis._hasLayout = false;\n\t}\n\n\tgetModeSwitchType(mode)\n\t{\n\t\tlet result = BX.UI.EntityEditorModeSwitchType.common;\n\n\t\tif (mode === BX.UI.EntityEditorMode.edit)\n\t\t{\n\t\t\tresult |= BX.UI.EntityEditorModeSwitchType.button | BX.UI.EntityEditorModeSwitchType.content;\n\t\t}\n\n\t\treturn result;\n\t}\n}","import {Loc, Dom, Tag, Event} from 'main.core';\nimport 'translit';\nimport './field.css';\n\nexport default class NameCodeField extends BX.UI.EntityEditorMultiText\n{\n\tconstructor(id, settings)\n\t{\n\t\tsuper();\n\t\tthis.initialize(id, settings);\n\t\tthis.isShownSymbolicCode = this.getSchemeShowCodeState() === 'true';\n\t\tthis.allowToGenerateCode = this._editor.isNew();\n\t}\n\n\tgetSchemeShowCodeState()\n\t{\n\t\treturn BX.prop.get(this.getSchemeElement()._options, 'showCode');\n\t}\n\n\tsetSchemeShowCodeState(state)\n\t{\n\t\tthis.getSchemeElement()._options['showCode'] = state;\n\t}\n\n\tgetValue = function()\n\t{\n\t\treturn BX.UI.EntityEditorBoolean.superclass.getValue.apply(this);\n\t}\n\n\thasContentToDisplay = function()\n\t{\n\t\treturn true;\n\t}\n\n\tdoPrepareContextMenuItems = function(menuItems)\n\t{\n\t\tif (this.isShownSymbolicCode)\n\t\t{\n\t\t\tmenuItems.push(\n\t\t\t\t{\n\t\t\t\t\tvalue: 'hide_symbolic_code',\n\t\t\t\t\ttext: Loc.getMessage('CATALOG_ENTITY_CARD_HIDE_SYMBOLIC_CODE'),\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tmenuItems.push(\n\t\t\t\t{\n\t\t\t\t\tvalue: 'show_symbolic_code',\n\t\t\t\t\ttext: Loc.getMessage('CATALOG_ENTITY_CARD_SHOW_SYMBOLIC_CODE'),\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t}\n\n\tprocessContextMenuCommand(e, command)\n\t{\n\t\tsuper.processContextMenuCommand(e, command);\n\n\t\tconst codeContainerElement = document.getElementById('code_container');\n\t\tconst nameCodeMarkerElement = document.getElementById('name_code_marker');\n\n\t\tif (command === 'hide_symbolic_code')\n\t\t{\n\t\t\tthis.isShownSymbolicCode = false;\n\t\t\tthis.allowToGenerateCode = this._editor.isNew();\n\n\t\t\tif(this._mode === BX.UI.EntityEditorMode.edit)\n\t\t\t{\n\t\t\t\tconst codeTextElement = document.getElementById('code_text');\n\t\t\t\tconst codeStateButtonElement = document.getElementById('code_state_button');\n\t\t\t\tcodeTextElement.readOnly = this.allowToGenerateCode;\n\t\t\t\tif (this.allowToGenerateCode)\n\t\t\t\t{\n\t\t\t\t\tcodeTextElement.className = 'ui-ctl-element ui-ctl-element-symbol-code-input-disabled';\n\t\t\t\t\tcodeStateButtonElement.className = 'ui-ctl-before ui-ctl-icon-chain';\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tcodeTextElement.className = 'ui-ctl-element';\n\t\t\t\t\tcodeStateButtonElement.className = 'ui-ctl-before ui-ctl-icon-unchain';\n\t\t\t\t}\n\t\t\t\tcodeContainerElement.className = 'name-code-container name-code-container-hidden';\n\n\t\t\t\tDom.removeClass(this._innerWrapper, 'ui-entity-editor-content-block--code');\n\t\t\t\tDom.addClass(this._innerWrapper, 'ui-entity-editor-content-block--no-code');\n\t\t\t\tnameCodeMarkerElement.style.display = 'inline';\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.refreshLayout();\n\t\t\t}\n\t\t\tthis.setSchemeShowCodeState(false);\n\t\t\tthis._parent.processChildControlSchemeChange(this);\n\t\t}\n\t\telse if (command === 'show_symbolic_code')\n\t\t{\n\t\t\tthis.isShownSymbolicCode = true;\n\t\t\tif(this._mode === BX.UI.EntityEditorMode.edit)\n\t\t\t{\n\t\t\t\tcodeContainerElement.className = 'name-code-container';\n\t\t\t\tDom.removeClass(this._innerWrapper, 'ui-entity-editor-content-block--no-code');\n\t\t\t\tDom.addClass(this._innerWrapper, 'ui-entity-editor-content-block--code');\n\t\t\t\tnameCodeMarkerElement.style.display = 'none';\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.refreshLayout();\n\t\t\t}\n\t\t\tthis.setSchemeShowCodeState(true);\n\t\t\tthis._parent.processChildControlSchemeChange(this);\n\t\t}\n\t}\n\n\tcreateTitleMarker()\n\t{\n\t\tif(this._mode === BX.UI.EntityEditorMode.view)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst display = this.isShownSymbolicCode ? 'none' : 'inline';\n\n\t\tif(this._mode === BX.UI.EntityEditorMode.edit)\n\t\t{\n\t\t\treturn Tag.render`<span id=\"name_code_marker\" style=\"color: rgb(255, 0, 0); display: ${display};\">*</span>`;\n\t\t}\n\t}\n\n\tlayout(options)\n\t{\n\t\tif(this._hasLayout)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.ensureWrapperCreated({ classNames: [ 'ui-entity-editor-field-multitext' ] });\n\t\tthis.adjustWrapper();\n\n\t\tif(!this.isNeedToDisplay())\n\t\t{\n\t\t\tthis.registerLayout(options);\n\t\t\tthis._hasLayout = true;\n\t\t\treturn;\n\t\t}\n\n\t\tconst title = this.getTitle();\n\n\t\tconst values = this.getValue();\n\t\tthis._inputValue = values;\n\t\tthis._innerWrapper = null;\n\t\tif(this.isDragEnabled())\n\t\t{\n\t\t\tDom.append(this.createDragButton(), this._wrapper);\n\t\t}\n\n\t\tDom.append(this.createTitleNode(title), this._wrapper);\n\t\tif(this._mode === BX.UI.EntityEditorMode.edit)\n\t\t{\n\t\t\tthis._inputContainer = Tag.render`<div></div>`;\n\n\t\t\tfor (let valueKey in values)\n\t\t\t{\n\t\t\t\tDom.append(this.createSingleInput(values[valueKey], valueKey), this._inputContainer);\n\t\t\t}\n\n\t\t\tthis._innerWrapper = Tag.render`<div class=\"ui-entity-editor-content-block\">${this._inputContainer}</div>`;\n\t\t\tif (this.isShownSymbolicCode)\n\t\t\t{\n\t\t\t\tDom.addClass(this._innerWrapper, 'ui-entity-editor-content-block--code');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tDom.addClass(this._innerWrapper, 'ui-entity-editor-content-block--no-code');\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis._innerWrapper = Tag.render`\n\t\t\t\t<div class=\"ui-entity-editor-content-block\">${this.getViewInnerLayout()}</div>\n\t\t\t`;\n\t\t}\n\n\t\tDom.append(this._innerWrapper, this._wrapper);\n\n\t\tif(this.isContextMenuEnabled())\n\t\t{\n\t\t\tDom.append(this.createContextMenuButton() ,this._wrapper);\n\t\t}\n\n\t\tif(this.isDragEnabled())\n\t\t{\n\t\t\tthis.initializeDragDropAbilities();\n\t\t}\n\n\t\tthis.registerLayout(options);\n\t\tthis._hasLayout = true;\n\t}\n\n\tvalidate(result)\n\t{\n\t\tif(this._mode !== BX.UI.EntityEditorMode.edit)\n\t\t{\n\t\t\tthrow 'BX.UI.EntityEditorMultiText. Invalid validation context';\n\t\t}\n\n\t\tif(!this.isEditable())\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tthis.clearError();\n\n\t\tif(this.hasValidators())\n\t\t{\n\t\t\treturn this.executeValidators(result);\n\t\t}\n\n\t\tlet isEmptyField = false;\n\t\tif(this._inputContainer)\n\t\t{\n\t\t\tconst nameTextElement = document.getElementById('name_text');\n\n\t\t\tif (BX.util.trim(nameTextElement.value) === '')\n\t\t\t{\n\t\t\t\tisEmptyField = true;\n\t\t\t\tDom.addClass(nameTextElement.parentNode, \"ui-ctl-danger\");\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tDom.removeClass(nameTextElement.parentNode, \"ui-ctl-danger\");\n\t\t\t}\n\t\t}\n\n\t\tconst isValid = !this.isRequired() || !isEmptyField;\n\t\tif(!isValid)\n\t\t{\n\t\t\tresult.addError(BX.UI.EntityValidationError.create({ field: this }));\n\t\t\tthis.showRequiredFieldError(this._input);\n\t\t}\n\t\treturn isValid;\n\t}\n\n\tshowError(error, anchor)\n\t{\n\t\tif(!this._errorContainer)\n\t\t{\n\t\t\tthis._errorContainer = Tag.render`<div class=\"ui-entity-editor-field-error-text\"></div>`;\n\t\t}\n\n\t\tthis._errorContainer.innerHTML = BX.util.htmlspecialchars(error);\n\t\tif (this._wrapper)\n\t\t{\n\t\t\tDom.append(this._errorContainer, this._wrapper);\n\t\t}\n\t\tthis._hasError = true;\n\t}\n\n\tcreateSingleInput(value, name)\n\t{\n\t\tconst inputWrapper = Tag.render`\n\t\t\t<div id=\"${name.toLowerCase()}_container\"></div>\n\t\t`;\n\t\tconst inputContainer = Tag.render`\n\t\t\t<div class=\"ui-ctl ui-ctl-w100 ui-ctl-textbox\"></div>\n\t\t`;\n\n\t\tlet input;\n\t\tif (this.getLineCount() > 1)\n\t\t{\n\t\t\tinput = Tag.render`\n\t\t\t\t<textarea\n\t\t\t\t\tclass=\"ui-ctl-element ui-entity-editor-field-textarea\"\n\t\t\t\t\tname=\"${name}\"\n\t\t\t\t\tid=\"${name.toLowerCase() + '_text'}\"\n\t\t\t\t\trows=\"${this.getLineCount()}\">${BX.util.htmlspecialchars(value) || ''}</textarea>\n\t\t\t`;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tinput = Tag.render`\n\t\t\t\t<input\n\t\t\t\t\tclass=\"ui-ctl-element\"\n\t\t\t\t\tname=\"${name}\"\n\t\t\t\t\tid=\"${name.toLowerCase() + '_text'}\"\n\t\t\t\t\ttype=\"text\"\n\t\t\t\t\tvalue=\"${BX.util.htmlspecialchars(value) || ''}\"/>\n\t\t\t`;\n\t\t}\n\n\t\tEvent.bind(input, 'input', this.#onInputHandler.bind(this, name));\n\n\t\tif (name === 'CODE')\n\t\t{\n\t\t\tif (!this.isShownSymbolicCode)\n\t\t\t{\n\t\t\t\tDom.addClass(inputWrapper, 'name-code-container-hidden');\n\t\t\t}\n\n\t\t\tif (this.allowToGenerateCode === true)\n\t\t\t{\n\t\t\t\tDom.addClass(input, 'ui-ctl-element-symbol-code-input-disabled');\n\t\t\t\tDom.attr(input, 'readonly', this.allowToGenerateCode);\n\t\t\t}\n\n\t\t\tDom.addClass(inputContainer, 'ui-ctl-ext-before-icon');\n\t\t\tDom.addClass(inputWrapper, 'name-code-container');\n\n\t\t\tconst chainState = this.allowToGenerateCode ? 'chain' : 'unchain';\n\t\t\tconst button = Tag.render`\n\t\t\t\t<button name=\"${name}\" class=\"ui-ctl-before ui-ctl-icon-${chainState}\" id=\"code_state_button\"></button>\n\t\t\t`;\n\t\t\tEvent.bind(button, 'click', this.#onCodeStateButtonClick.bind(this));\n\t\t\tDom.append(button, inputContainer);\n\t\t}\n\n\t\tconst label = this.#creatLabelForEditMode(name);\n\n\t\tDom.append(label, inputWrapper);\n\t\tDom.append(input, inputContainer);\n\t\tDom.append(inputContainer, inputWrapper);\n\n\t\treturn inputWrapper;\n\t}\n\n\t#creatLabelForEditMode(name)\n\t{\n\t\tconst label = Tag.render`<label class=\"ui-entity-editor-block-title\"></label>`;\n\t\tlet labelText;\n\n\t\tif (name === 'CODE')\n\t\t{\n\t\t\tlabelText = Tag.render`<span>${Loc.getMessage('CATALOG_ENTITY_CARD_SYMBOLIC_CODE')}</span>`;\n\t\t\tDom.append(labelText, label);\n\t\t\tDom.append(this.#getHintNode(), label);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tlabelText = Tag.render`\n\t\t\t\t<span>\n\t\t\t\t\t${Loc.getMessage('CATALOG_ENTITY_CARD_NAME')}\n\t\t\t\t\t<span style=\"color: rgb(255, 0, 0);\">*</span>\n\t\t\t\t</span>\n\t\t\t`;\n\t\t\tDom.append(labelText, label);\n\t\t}\n\n\t\treturn label;\n\t}\n\n\t#onInputHandler(name)\n\t{\n\t\tthis._changeHandler();\n\t\tif (this.allowToGenerateCode && name === 'NAME')\n\t\t{\n\t\t\tconst codeTextElement = document.getElementById('code_text');\n\t\t\tconst nameTextElement = document.getElementById('name_text');\n\t\t\tcodeTextElement.value = BX.translit(nameTextElement.value, null);\n\t\t}\n\t}\n\n\t#getHintNode()\n\t{\n\t\treturn BX.UI.Hint.createNode(Loc.getMessage('CATALOG_ENTITY_CARD_SYMBOLIC_CODE_HINT'));\n\t}\n\n\t#onCodeStateButtonClick()\n\t{\n\t\tconst codeTextElement = document.getElementById('code_text');\n\t\tconst nameTextElement = document.getElementById('name_text');\n\t\tconst codeStateButtonElement = document.getElementById('code_state_button');\n\n\t\tthis.allowToGenerateCode = !this.allowToGenerateCode;\n\t\tcodeTextElement.readOnly = this.allowToGenerateCode;\n\n\t\tif (this.allowToGenerateCode)\n\t\t{\n\t\t\tcodeTextElement.className = 'ui-ctl-element ui-ctl-element-symbol-code-input-disabled';\n\t\t\tcodeStateButtonElement.className = 'ui-ctl-before ui-ctl-icon-chain';\n\t\t\tcodeTextElement.value = BX.translit(nameTextElement.value, null);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tcodeTextElement.className = 'ui-ctl-element';\n\t\t\tcodeStateButtonElement.className = 'ui-ctl-before ui-ctl-icon-unchain';\n\n\t\t\tconst nameTextElement = document.getElementById('name_text');\n\t\t\tconst newValue = BX.translit(nameTextElement.value, null);\n\n\t\t\tif (codeTextElement.value !== newValue)\n\t\t\t{\n\t\t\t\tthis.markAsChanged();\n\t\t\t}\n\t\t\tcodeTextElement.value = newValue;\n\t\t}\n\t}\n\n\tgetViewInnerLayout()\n\t{\n\t\tconst textValue = Tag.render`\n\t\t\t<div class=\"ui-entity-editor-content-block-text\"></div>\n\t\t`;\n\n\t\tconst values = this.getValue();\n\n\t\tif (!this.isShownSymbolicCode)\n\t\t{\n\t\t\tDom.append(Tag.render`<p>${BX.util.htmlspecialchars(values.NAME)}</p>`, textValue);\n\n\t\t\treturn textValue;\n\t\t}\n\n\t\tDom.append(Tag.render`\n\t\t\t<div class=\"ui-entity-editor-symbol-code-label\">\n\t\t\t\t${Loc.getMessage('CATALOG_ENTITY_CARD_NAME')}\n\t\t\t</div>\n\t\t`, textValue);\n\n\t\tDom.append(Tag.render`<p>${BX.util.htmlspecialchars(values.NAME)}</p>`, textValue);\n\n\t\tDom.addClass(textValue, 'ui-entity-editor-symbol-code');\n\t\tconst codeValue = values.CODE === '' ? Loc.getMessage('UI_ENTITY_EDITOR_FIELD_EMPTY') : values.CODE;\n\t\tconst chainClass = this.allowToGenerateCode\n\t\t\t? 'ui-entity-editor-symbol-code-value-chain'\n\t\t\t: 'ui-entity-editor-symbol-code-value-unchain'\n\t\t;\n\n\t\tDom.append(Tag.render`\n\t\t\t<div class=\"ui-entity-editor-symbol-code-box\">\n\t\t\t\t<div class=\"ui-entity-editor-symbol-code-label\">\n\t\t\t\t\t${Loc.getMessage('CATALOG_ENTITY_CARD_SYMBOLIC_CODE')}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"ui-entity-editor-symbol-code-value ${chainClass}\">\n\t\t\t\t\t${BX.util.htmlspecialchars(codeValue)}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`, textValue);\n\n\t\treturn textValue;\n\t}\n}","import IblockSectionField from './iblock-section/field';\nimport NameCodeField from './name-code/field';\nimport {type BaseEvent, EventEmitter} from 'main.core.events'\n\nexport default class FieldsFactory\n{\n\tconstructor()\n\t{\n\t\tEventEmitter.subscribe('BX.UI.EntityEditorControlFactory:onInitialize', (event: BaseEvent) => {\n\t\t\tconst [, eventArgs] = event.getCompatData();\n\t\t\teventArgs.methods['entityCard'] = this.factory.bind(this);\n\t\t});\n\t}\n\n\tfactory(type, controlId, settings)\n\t{\n\t\tif (type === 'iblock_section')\n\t\t{\n\t\t\treturn new IblockSectionField(controlId, settings);\n\t\t}\n\t\telse if (type === 'name-code')\n\t\t{\n\t\t\treturn new NameCodeField(controlId, settings);\n\t\t}\n\n\t\treturn null;\n\t}\n}","import {ajax} from 'main.core';\nimport {type BaseEvent, EventEmitter} from 'main.core.events'\n\nconst PROPERTY_PREFIX = 'PROPERTY_';\nconst PROPERTY_BLOCK_NAME = 'properties';\n\nexport default class IblockSectionController extends BX.UI.EntityEditorController\n{\n\tonChangeHandler = this.handleChange.bind(this);\n\n\tconstructor(id, settings = {})\n\t{\n\t\tsuper();\n\t\tthis.initialize(id, settings);\n\n\t\tthis.isRequesting = false;\n\t\tthis.clearServiceFields();\n\n\t\tEventEmitter.subscribe(this._editor, 'IblockSectionField:onChange', this.onChangeHandler);\n\t}\n\n\tclearServiceFields()\n\t{\n\t\tthis.lastDataHash = null;\n\t\tthis.initialElements = null;\n\t\tthis.deletedControls = {};\n\t\tthis.deletedAvailableSchemes = {};\n\t}\n\n\thandleChange(event: BaseEvent)\n\t{\n\t\tconst newData = event.getData();\n\t\tnewData.shift();\n\t\tconst newDataHash = JSON.stringify(newData);\n\n\t\tif (this.lastDataHash === null || this.lastDataHash !== newDataHash)\n\t\t{\n\t\t\tthis.lastDataHash = newDataHash;\n\n\t\t\tclearTimeout(this.timeout);\n\t\t\tthis.timeout = setTimeout(() => {\n\t\t\t\tthis.refreshLinkedProperties(newData)\n\t\t\t}, 50);\n\t\t}\n\t}\n\n\trefreshLinkedProperties(sectionIds)\n\t{\n\t\tif (this.isRequesting)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.isRequesting = true;\n\n\t\tajax.runComponentAction(\n\t\t\tthis._editor._settings.ajaxData.COMPONENT_NAME,\n\t\t\t'refreshLinkedProperties',\n\t\t\t{\n\t\t\t\tmode: 'class',\n\t\t\t\tsignedParameters: this._editor._settings.ajaxData.SIGNED_PARAMETERS,\n\t\t\t\tdata: {sectionIds}\n\t\t\t}\n\t\t)\n\t\t\t.then(response => {\n\t\t\t\tconst allCurrentProperties = this.getAllCurrentProperties();\n\n\t\t\t\tif (this.initialElements === null)\n\t\t\t\t{\n\t\t\t\t\tthis.initialElements = [...allCurrentProperties];\n\t\t\t\t}\n\n\t\t\t\tresponse.data.ENTITY_FIELDS.forEach(property => {\n\t\t\t\t\tif (!allCurrentProperties.includes(property.name))\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.addProperty(property, {\n\t\t\t\t\t\t\tlayout: {\n\t\t\t\t\t\t\t\tforceDisplay: true\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tmode: BX.UI.EntityEditorMode.edit\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tconst newProperties = response.data.ENTITY_FIELDS.map(el => el.name);\n\t\t\t\tallCurrentProperties.forEach(name => {\n\t\t\t\t\tif (!newProperties.includes(name))\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.removeProperty(name);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tthis._editor.commitSchemeChanges();\n\t\t\t\tthis.isRequesting = false;\n\t\t\t})\n\t\t\t.catch(response => {\n\t\t\t\tthis.isRequesting = false;\n\t\t\t})\n\t\t;\n\t}\n\n\tgetAllCurrentProperties()\n\t{\n\t\tconst activeProperties = this._editor.getAllControls()\n\t\t\t.filter(el => el.getName().indexOf(PROPERTY_PREFIX) === 0)\n\t\t\t.map(el => el.getName());\n\n\t\tconst hiddenProperties = this._editor.getAvailableSchemeElements()\n\t\t\t.filter(el => el.getName().indexOf(PROPERTY_PREFIX) === 0)\n\t\t\t.map(el => el.getName());\n\n\t\treturn [...activeProperties, ...hiddenProperties];\n\t}\n\n\taddProperty(property, options = {})\n\t{\n\t\tif (property.name in this.deletedControls)\n\t\t{\n\t\t\tthis.restoreDeletedProperty(this.deletedControls[property.name], options);\n\t\t}\n\t\telse if (property.name in this.deletedAvailableSchemes)\n\t\t{\n\t\t\tthis.restoreDeletedAvailableProperty(this.deletedAvailableSchemes[property.name], options);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.createProperty(property, options);\n\t\t}\n\t}\n\n\trestoreDeletedProperty(control, options = {})\n\t{\n\t\tconst mode = options.mode || control._mode;\n\t\tcontrol._mode = mode;\n\n\t\tcontrol.getParent().addChild(control, {\n\t\t\t...options,\n\t\t\tenableSaving: false\n\t\t});\n\n\t\tif (mode === BX.UI.EntityEditorMode.edit)\n\t\t{\n\t\t\tthis._editor.registerActiveControl(control);\n\t\t}\n\t\telse if (mode === BX.UI.EntityEditorMode.view)\n\t\t{\n\t\t\tthis._editor.unregisterActiveControl(control);\n\t\t}\n\t}\n\n\trestoreDeletedAvailableProperty(schemeElement, options = {})\n\t{\n\t\tthis._editor.addAvailableSchemeElement(schemeElement);\n\t}\n\n\tcreateProperty(property, options = {})\n\t{\n\t\tconst propertyBlockScheme = this._editor.getSchemeElementByName(PROPERTY_BLOCK_NAME);\n\t\tconst schemeElement = BX.UI.EntitySchemeElement.create(property);\n\t\tpropertyBlockScheme._elements.push(schemeElement);\n\n\t\tconst mode = options.mode || BX.UI.EntityEditorMode.edit;\n\t\tconst control = this._editor.createControl(\n\t\t\tschemeElement.getType(),\n\t\t\tschemeElement.getName(),\n\t\t\t{\n\t\t\t\tschemeElement: schemeElement,\n\t\t\t\tmodel: this._model,\n\t\t\t\tparent: this,\n\t\t\t\tmode: mode\n\t\t\t}\n\t\t);\n\n\t\tif (!control)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst propertyBlockControl = this._editor.getControlById(PROPERTY_BLOCK_NAME);\n\t\tpropertyBlockControl.addChild(control, {\n\t\t\t...options,\n\t\t\tenableSaving: false\n\t\t});\n\n\t\treturn control;\n\t}\n\n\tremoveProperty(name)\n\t{\n\t\tconst control = this._editor.getControlByIdRecursive(name);\n\n\t\tif (control)\n\t\t{\n\t\t\tthis.deletedControls[control.getName()] = control;\n\t\t\tcontrol.getParent().removeChild(control, {enableSaving: false});\n\t\t\tthis._editor.removeAvailableSchemeElement(control.getSchemeElement());\n\t\t\tthis._editor.unregisterActiveControl(control);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst schemeElement = this._editor.getAvailableSchemeElementByName(name);\n\n\t\t\tif (schemeElement)\n\t\t\t{\n\t\t\t\tthis.deletedAvailableSchemes[schemeElement.getName()] = schemeElement;\n\t\t\t\tthis._editor.removeAvailableSchemeElement(schemeElement);\n\t\t\t}\n\t\t}\n\t}\n\n\trollback()\n\t{\n\t\tsuper.rollback();\n\n\t\tif (this.initialElements === null)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst allCurrentProperties = this.getAllCurrentProperties();\n\n\t\tallCurrentProperties.forEach(element => {\n\t\t\tif (!this.initialElements.includes(element))\n\t\t\t{\n\t\t\t\tthis.removeProperty(element);\n\t\t\t}\n\t\t});\n\n\t\tthis.initialElements.forEach(element => {\n\t\t\tif (!allCurrentProperties.includes(element))\n\t\t\t{\n\t\t\t\tthis.addProperty({name: element}, {\n\t\t\t\t\tlayout: {\n\t\t\t\t\t\tforceDisplay: false\n\t\t\t\t\t},\n\t\t\t\t\tmode: BX.UI.EntityEditorMode.view\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\tthis._editor.commitSchemeChanges();\n\n\t\tthis.clearServiceFields()\n\t}\n}","import { Type, Loc } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport 'ui.notification';\n\nexport default class GridStore\n{\n\tgridId: String;\n\teditedRowsIndexes: Array = [];\n\n\tconstructor(gridId: String)\n\t{\n\t\tthis.gridId = gridId;\n\n\t\tEventEmitter.subscribe('onItemIsAdded', this.#onFileIsAddedHandler.bind(this));\n\t\tEventEmitter.subscribe('onFileIsDeleted', this.#onFileIsDeletedHandler.bind(this));\n\t}\n\n\tgetGrid(): BX.Main.Grid\n\t{\n\t\treturn BX.Main.gridManager.getInstanceById(this.gridId);\n\t}\n\n\t#onFileIsAddedHandler(event: BaseEvent)\n\t{\n\t\tconst file = event.getCompatData()[0];\n\t\tconst isFileUploaded = file instanceof File;\n\t\tconst uploader = event.getCompatData()[2];\n\n\t\tif (uploader && Type.isDomNode(uploader.fileInput) && isFileUploaded)\n\t\t{\n\t\t\tconst isFileUploaderInGrid = this.getGrid().getContainer().contains(uploader.fileInput)\n\t\t\tif (isFileUploaderInGrid)\n\t\t\t{\n\t\t\t\tthis.#showFileNotification();\n\t\t\t}\n\t\t}\n\t}\n\n\t#onFileIsDeletedHandler(event: BaseEvent)\n\t{\n\t\tconst uploader = event.getCompatData()[2];\n\n\t\tif (uploader && Type.isDomNode(uploader.fileInput))\n\t\t{\n\t\t\tconst isFileUploaderInGrid = this.getGrid().getContainer().contains(uploader.fileInput)\n\t\t\tif (isFileUploaderInGrid)\n\t\t\t{\n\t\t\t\tthis.#showFileNotification();\n\t\t\t}\n\t\t}\n\t}\n\n\t#showFileNotification()\n\t{\n\t\tBX.UI.Notification.Center.notify({\n\t\t\tid: 'fileCloseNotification',\n\t\t\tblinkOnUpdate: false,\n\t\t\tcontent: Loc.getMessage('CATALOG_ENTITY_CARD_FILE_CLOSE_NOTIFICATION_2'),\n\t\t\tposition: 'top-right',\n\t\t\twidth: 'auto',\n\t\t\tautoHideDelay: 5000\n\t\t});\n\t}\n\n\tsaveEditedRows(): void\n\t{\n\t\tthis.editedRowsIndexes = [];\n\n\t\tthis.getGrid().getRows().getBodyChild().forEach((row) => {\n\t\t\tif (row.isEdit())\n\t\t\t{\n\t\t\t\tthis.editedRowsIndexes.push(row.getNode().rowIndex);\n\t\t\t}\n\t\t});\n\t}\n\n\tloadEditedRows(): void\n\t{\n\t\tconst rows = this.getGrid().getRows();\n\n\t\tthis.editedRowsIndexes.forEach((index) => {\n\t\t\tconst row = rows.getByIndex(index);\n\t\t\tif (row)\n\t\t\t{\n\t\t\t\t//row.edit(); not used, because for child listeners need fire event\n\t\t\t\tBX.fireEvent(row.getNode(), 'click');\n\t\t\t}\n\t\t});\n\t}\n\n\t#getSupportedAjaxFields(): Array\n\t{\n\t\tconst params = this.getGrid().getParam('SUPPORTED_AJAX_FIELDS');\n\t\tif (Type.isArray(params))\n\t\t{\n\t\t\treturn params;\n\t\t}\n\n\t\treturn [];\n\t}\n\n\tgetEditedRowsFields(): Object\n\t{\n\t\tconst result = {};\n\n\t\tconst fillCellValue = function(result: Object, name: String, editData: Object, value)\n\t\t{\n\t\t\tif (Type.isPlainObject(editData) && editData.TYPE === 'MONEY')\n\t\t\t{\n\t\t\t\tif (Type.isArray(value))\n\t\t\t\t{\n\t\t\t\t\tvalue.forEach((item) => {\n\t\t\t\t\t\tif (item.RAW_NAME === undefined && item.NAME === name)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tresult[name] = item.VALUE;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tconsole.error('Error value type for `MONEY` column', value);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (Type.isPlainObject(value))\n\t\t\t{\n\t\t\t\tresult[name] = value.VALUE ?? '';\n\t\t\t}\n\t\t\telse if (Type.isArray(value))\n\t\t\t{\n\t\t\t\tresult[name] = [];\n\n\t\t\t\tvalue.forEach((item) => {\n\t\t\t\t\tif (Type.isPlainObject(item))\n\t\t\t\t\t{\n\t\t\t\t\t\tresult[name].push(item.VALUE);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tresult[name].push(item);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresult[name] = value;\n\t\t\t}\n\t\t};\n\n\t\tconst rows = this.getGrid().getRows();\n\t\tconst headRow = rows.getHeadFirstChild();\n\t\tconst supportedAjaxFields = this.#getSupportedAjaxFields();\n\n\t\trows.getBodyChild().filter((row) => row.isEdit()).forEach((row) => {\n\t\t\tconst values = {};\n\n\t\t\tArray.prototype.forEach.call(row.getCells(), (cell, index) => {\n\t\t\t\tconst cellName = headRow.getCellNameByCellIndex(index);\n\t\t\t\tif (!cellName)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (supportedAjaxFields.length > 0 && !supportedAjaxFields.includes(cellName))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst cellValues = row.getCellEditorValue(cell);\n\t\t\t\tconst cellEditData = headRow.getCellEditDataByCellIndex(index);\n\n\t\t\t\tfillCellValue(values, cellName, cellEditData, cellValues);\n\t\t\t});\n\n\t\t\tresult[row.getId()] = values;\n\t\t});\n\n\t\treturn result;\n\t}\n}\n","import {type BaseEvent, EventEmitter} from 'main.core.events';\nimport {Dom, Reflection, Type, Uri} from 'main.core';\nimport GridStore from '../grid/grid-store';\n\nexport default class VariationGridController extends BX.UI.EntityEditorController\n{\n\tareaHeight = null\n\tgridStore: GridStore;\n\n\tconstructor(id, settings)\n\t{\n\t\tsuper();\n\n\t\tthis.initialize(id, settings);\n\t}\n\n\tdoInitialize()\n\t{\n\t\tsuper.doInitialize();\n\n\t\tEventEmitter.subscribe('Grid::thereEditedRows', this.markAsChangedHandler.bind(this));\n\t\tEventEmitter.subscribe('Grid::noEditedRows', this.checkEditorToolbar.bind(this));\n\t\tEventEmitter.subscribe('Grid::updated', this.onGridUpdated.bind(this));\n\t\tEventEmitter.subscribe('Grid::beforeRequest', this.onBeforeGridRequest.bind(this));\n\n\t\tEventEmitter.subscribe('onAjaxSuccess', this.ajaxSuccessHandler.bind(this));\n\n\t\tEventEmitter.subscribe('BX.UI.EntityEditorIncludedArea:onBeforeLoad', this.onBeforeIncludedAreaLoaded.bind(this));\n\t\tEventEmitter.subscribe('BX.UI.EntityEditorIncludedArea:onAfterLoad', this.onAfterIncludedAreaLoaded.bind(this));\n\t\tEventEmitter.subscribe(\"BX.UI.EntityEditor:onNothingChanged\", this.onNothingChanged.bind(this));\n\n\t\tthis.subscribeToFormSubmit();\n\n\t\tthis.gridStore = new GridStore(this.getGridId());\n\t}\n\n\tonBeforeIncludedAreaLoaded(event: BaseEvent)\n\t{\n\t\tif (Type.isNumber(this.areaHeight))\n\t\t{\n\t\t\tDom.style(this.getVariationGridLoader(), 'height', this.areaHeight + 'px');\n\t\t}\n\t}\n\n\tonAfterIncludedAreaLoaded(event: BaseEvent)\n\t{\n\t\tDom.style(this.getVariationGridLoader(), 'height', '');\n\t\tthis.areaHeight = null;\n\t}\n\n\tonNothingChanged(event: BaseEvent)\n\t{\n\t\tthis.rollback();\n\t}\n\n\tgetVariationGridLoader()\n\t{\n\t\tconst control = this.getGridControl();\n\n\t\tif (control)\n\t\t{\n\t\t\tconst wrapper = control.getWrapper();\n\n\t\t\tif (wrapper)\n\t\t\t{\n\t\t\t\treturn wrapper.querySelector('.ui-entity-editor-included-area-container-loader');\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t}\n\n\trollback()\n\t{\n\t\tsuper.rollback();\n\t\tthis.checkEditorToolbar();\n\t\tthis.unsubscribeGridEvents();\n\t\tBX.Main.gridManager.destroy(this.getGridId());\n\t}\n\n\tonAfterSave()\n\t{\n\t\tif (this.isChanged() || this._editor.isChanged())\n\t\t{\n\t\t\tthis.setGridControlCache(null);\n\t\t\tEventEmitter.emit(\n\t\t\t\t'onAfterVariationGridSave',\n\t\t\t\t{\n\t\t\t\t\tgridId: this.getGridId(),\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\tBX.Main.gridManager.destroy(this.getGridId());\n\t\tthis.subscribeToFormSubmit();\n\t\tsuper.onAfterSave();\n\t}\n\n\tsetGridControlCache(html)\n\t{\n\t\tconst control = this.getGridControl();\n\n\t\tif (control)\n\t\t{\n\t\t\tcontrol._loadedHtml = html;\n\t\t}\n\t}\n\n\tonBeforeSubmit()\n\t{\n\t\tthis.unsubscribeGridEvents();\n\t}\n\n\t/**\n\t * @returns {BX.Catalog.VariationGrid|null}\n\t */\n\tgetVariationGridComponent()\n\t{\n\t\treturn Reflection.getClass('BX.Catalog.VariationGrid.Instance');\n\t}\n\n\tunsubscribeGridEvents()\n\t{\n\t\tconst gridComponent = this.getVariationGridComponent();\n\t\tif (gridComponent)\n\t\t{\n\t\t\tgridComponent.destroy();\n\t\t}\n\n\t\tconst popup = this.getGrid()?.getSettingsWindow()?.getPopup();\n\t\tif (popup)\n\t\t{\n\t\t\tEventEmitter.emit(this.getGrid().getSettingsWindow().getPopup(), 'onDestroy');\n\t\t}\n\n\t\tEventEmitter.unsubscribeAll('BX.Main.grid:paramsUpdated');\n\t}\n\n\tajaxSuccessHandler(event: BaseEvent)\n\t{\n\t\tconst [, xhrData] = event.getCompatData();\n\n\t\tif (xhrData.url.indexOf(this.getReloadUrl()) === 0)\n\t\t{\n\t\t\tthis.setGridControlCache(null);\n\t\t}\n\t}\n\n\t// ajax form initializes every \"save\" action\n\tsubscribeToFormSubmit()\n\t{\n\t\tEventEmitter.subscribe(this._editor._ajaxForm, 'onBeforeSubmit', this.onBeforeSubmitForm.bind(this));\n\t}\n\n\tmarkAsChangedHandler()\n\t{\n\t\tif (!this._editor.isNew())\n\t\t{\n\t\t\tthis.markAsChanged();\n\t\t}\n\t}\n\n\tcheckEditorToolbar()\n\t{\n\t\tthis._isChanged = false;\n\n\t\tif (this._editor.getActiveControlCount() > 0)\n\t\t{\n\t\t\tthis._editor.showToolPanel();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis._editor.hideToolPanel();\n\t\t}\n\n\t\tif (this._editor._toolPanel)\n\t\t{\n\t\t\tthis._editor._toolPanel.clearErrors();\n\t\t}\n\t}\n\n\tgetGridControl()\n\t{\n\t\treturn this._editor.getControlById('variation_grid');\n\t}\n\n\tonGridUpdated(event: BaseEvent)\n\t{\n\t\tconst [grid] = event.getCompatData();\n\n\t\tthis.checkEditorToolbar();\n\n\t\tif (grid.getId() === this.getGrid().getId())\n\t\t{\n\t\t\tsetTimeout(\n\t\t\t\t() => {\n\t\t\t\t\tthis.gridStore.loadEditedRows();\n\t\t\t\t},\n\t\t\t\t0 // delay for re-render grid\n\t\t\t);\n\t\t}\n\t}\n\n\tonBeforeGridRequest(event: BaseEvent)\n\t{\n\t\tconst [grid, eventArgs] = event.getCompatData();\n\n\t\tif (!grid || !grid.parent || grid.parent.getId() !== this.getGridId())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet url = eventArgs.url;\n\t\tif (url)\n\t\t{\n\t\t\tconst params = (new Uri(url)).getQueryParams();\n\t\t\turl = new Uri(this.getReloadUrl());\n\n\t\t\tif (params)\n\t\t\t{\n\t\t\t\tfor (const key in params) {\n\t\t\t\t\tif (Object.hasOwnProperty.call(params, key)) {\n\t\t\t\t\t\turl.setQueryParam(key, params[key])\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\turl = url.toString();\n\t\t}\n\t\telse\n\t\t{\n\t\t\turl = this.getReloadUrl();\n\t\t}\n\n\t\tthis.gridStore.saveEditedRows();\n\n\t\teventArgs.sessid = BX.bitrix_sessid();\n\t\teventArgs.method = 'POST';\n\t\teventArgs.url = url;\n\t\teventArgs.data = {\n\t\t\t...eventArgs.data,\n\t\t\trows: this.gridStore.getEditedRowsFields(),\n\t\t\tsignedParameters: this.getSignedParameters(),\n\t\t};\n\n\t\tthis.unsubscribeGridEvents();\n\t}\n\n\tgetReloadUrl()\n\t{\n\t\treturn this.getConfigStringParam('reloadUrl', '');\n\t}\n\n\tgetSignedParameters()\n\t{\n\t\treturn this.getConfigStringParam('signedParameters', '');\n\t}\n\n\tgetGridId()\n\t{\n\t\treturn this.getConfigStringParam('gridId', '');\n\t}\n\n\tgetGrid()\n\t{\n\t\tif (!Reflection.getClass('BX.Main.gridManager.getInstanceById'))\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn BX.Main.gridManager.getInstanceById(this.getGridId());\n\t}\n\n\tonBeforeSubmitForm(event: BaseEvent)\n\t{\n\t\tconst [, eventArgs] = event.getCompatData();\n\t\tconst grid = this.getGrid();\n\n\t\tif (!grid)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst skuGridName = this.getGridId();\n\t\tconst skuGridData = grid.getRows().getEditSelectedValues();\n\t\tconst copyItemsMap = grid.getParam('COPY_ITEMS_MAP', {});\n\n\t\t// replace sku custom properties edit data names with original names\n\t\tfor (let id in skuGridData)\n\t\t{\n\t\t\tif (!skuGridData.hasOwnProperty(id))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tfor (let name in skuGridData[id])\n\t\t\t{\n\t\t\t\tif (!skuGridData[id].hasOwnProperty(name))\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tif (name.includes('SKU_GRID_CATALOG_GROUP')\n\t\t\t\t\t|| name.includes('SKU_GRID_PURCHASING')\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tfor (let priceField in skuGridData[id][name])\n\t\t\t\t\t{\n\t\t\t\t\t\tif (skuGridData[id][name].hasOwnProperty(priceField))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tskuGridData[id][priceField] = skuGridData[id][name][priceField];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (name.includes('[EDIT_HTML]'))\n\t\t\t\t{\n\t\t\t\t\tlet newName = name.replace('[EDIT_HTML]', '');\n\n\t\t\t\t\t// lookup for a custom file fields\n\t\t\t\t\tif (newName.endsWith('_custom'))\n\t\t\t\t\t{\n\t\t\t\t\t\tif ('bxu_files[]' in skuGridData[id][name])\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tskuGridData[id][name].isFile = true;\n\t\t\t\t\t\t\tdelete skuGridData[id][name]['bxu_files[]'];\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (skuGridData[id][name].isFile)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tfor (let fieldName in skuGridData[id][name])\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tif (skuGridData[id][name].hasOwnProperty(fieldName))\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t// check for new files like \"MORE_PHOTO_n1[name]\"(multiple) or \"DETAIL_PICTURE[name]\"(single)\n\t\t\t\t\t\t\t\t\tlet newFilesRegExp = new RegExp(/([0-9A-Za-z_]+?(_n\\d+)*)\\[([A-Za-z_]+)\\]/);\n\n\t\t\t\t\t\t\t\t\tif (newFilesRegExp.test(fieldName))\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tlet fileCounter, fileSetting;\n\n\t\t\t\t\t\t\t\t\t\t[, fileCounter, , fileSetting] = fieldName.match(newFilesRegExp);\n\n\t\t\t\t\t\t\t\t\t\tif (fileCounter && fileSetting)\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\tskuGridData[id][name][fileCounter] = skuGridData[id][name][fileCounter] || {};\n\t\t\t\t\t\t\t\t\t\t\tskuGridData[id][name][fileCounter][fileSetting] = skuGridData[id][name][fieldName];\n\t\t\t\t\t\t\t\t\t\t\tdelete skuGridData[id][name][fieldName];\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tskuGridData[id][newName] = skuGridData[id][name];\n\t\t\t\t\tdelete skuGridData[id][name];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (!Type.isNil(copyItemsMap[id]))\n\t\t\t{\n\t\t\t\tskuGridData[id]['COPY_SKU_ID'] = copyItemsMap[id];\n\t\t\t}\n\t\t}\n\n\t\tif (!Type.isPlainObject(eventArgs.options))\n\t\t{\n\t\t\teventArgs.options = {};\n\t\t}\n\n\t\tif (!Type.isPlainObject(eventArgs.options.data))\n\t\t{\n\t\t\teventArgs.options.data = {};\n\t\t}\n\n\t\teventArgs.options.data[skuGridName] = skuGridData;\n\n\t\tthis.areaHeight = this.getGridControl().getWrapper().offsetHeight;\n\t}\n}\n","import {EventEmitter} from 'main.core.events'\n\n\nexport default class VariationLinkController extends BX.UI.EntityEditorController\n{\n\tconstructor(id, settings)\n\t{\n\t\tsuper();\n\t\tthis.initialize(id, settings);\n\t\tEventEmitter.subscribe('onChangeVariationLink', this.markAsChanged.bind(this));\n\t}\n\n\trollback()\n\t{\n\t\tsuper.rollback();\n\t\tif (this._isChanged)\n\t\t{\n\t\t\tthis._isChanged = false;\n\t\t}\n\t}\n}","import {EventEmitter} from 'main.core.events'\n\n\nexport default class GoogleMapController extends BX.UI.EntityEditorController\n{\n\tconstructor(id, settings)\n\t{\n\t\tsuper();\n\t\tthis.initialize(id, settings);\n\t\tEventEmitter.subscribe('onAddGoogleMapPoint', this.markAsChanged.bind(this));\n\t}\n\n\trollback()\n\t{\n\t\tsuper.rollback();\n\t\tif (this._isChanged)\n\t\t{\n\t\t\tthis._isChanged = false;\n\t\t}\n\t}\n}","import {EventEmitter} from 'main.core.events'\n\n\nexport default class EmployeeController extends BX.UI.EntityEditorController\n{\n\tconstructor(id, settings)\n\t{\n\t\tsuper();\n\t\tthis.initialize(id, settings);\n\t\tEventEmitter.subscribe('onChangeEmployee', this.markAsChanged.bind(this));\n\t}\n\n\trollback()\n\t{\n\t\tsuper.rollback();\n\t\tif (this._isChanged)\n\t\t{\n\t\t\tthis._isChanged = false;\n\t\t}\n\t}\n}","import {EventEmitter} from 'main.core.events'\n\n\nexport default class UserController extends BX.UI.EntityEditorController\n{\n\tconstructor(id, settings)\n\t{\n\t\tsuper();\n\t\tthis.initialize(id, settings);\n\t\tEventEmitter.subscribe('onChangeUser', this.markAsChanged.bind(this));\n\t}\n\n\trollback()\n\t{\n\t\tsuper.rollback();\n\t\tif (this._isChanged)\n\t\t{\n\t\t\tthis._isChanged = false;\n\t\t}\n\t}\n}","import {EventEmitter} from 'main.core.events'\n\n\nexport default class IblockElementController extends BX.UI.EntityEditorController\n{\n\tconstructor(id, settings)\n\t{\n\t\tsuper();\n\t\tthis.initialize(id, settings);\n\t\tEventEmitter.subscribe('onChangeIblockElement', this.markAsChanged.bind(this));\n\t}\n\n\trollback()\n\t{\n\t\tsuper.rollback();\n\t\tif (this._isChanged)\n\t\t{\n\t\t\tthis._isChanged = false;\n\t\t}\n\t}\n}","import {EventEmitter} from 'main.core.events'\n\nexport default class BindingToCrmElementController extends BX.UI.EntityEditorController\n{\n\tconstructor(id, settings)\n\t{\n\t\tsuper();\n\t\tthis.initialize(id, settings);\n\t}\n\n\trollback()\n\t{\n\t\tsuper.rollback();\n\t\tif (this._isChanged)\n\t\t{\n\t\t\tthis._isChanged = false;\n\t\t}\n\t\tEventEmitter.unsubscribeAll('BX.Main.User.SelectorController::open');\n\t}\n\n\tonBeforeSubmit()\n\t{\n\t\tsuper.onBeforeSubmit();\n\t\tEventEmitter.unsubscribeAll('BX.Main.User.SelectorController::open');\n\t}\n}","import {ajax} from 'main.core';\nimport {type BaseEvent, EventEmitter} from 'main.core.events'\n\nexport default class FieldConfiguratorController extends BX.UI.EntityEditorController\n{\n\tfieldAddHandler = this.handleFieldAdd.bind(this);\n\tfieldUpdateHandler = this.handleFieldUpdate.bind(this);\n\n\tconstructor(id, settings)\n\t{\n\t\tsuper();\n\t\tthis.initialize(id, settings);\n\n\t\tEventEmitter.subscribe(this._editor, 'BX.UI.EntityEditor:onFieldCreate', this.fieldAddHandler);\n\t\tEventEmitter.subscribe(this._editor, 'BX.UI.EntityEditor:onFieldModify', this.fieldUpdateHandler);\n\t}\n\n\thandleFieldAdd(event: BaseEvent)\n\t{\n\t\tconst [section, eventArgs] = event.getCompatData();\n\t\tconst fields = this.getFieldsForm(eventArgs);\n\n\t\tajax.runComponentAction(\n\t\t\tthis._editor._settings.ajaxData.COMPONENT_NAME,\n\t\t\t'addProperty',\n\t\t\t{\n\t\t\t\tmode: 'class',\n\t\t\t\tsignedParameters: this._editor._settings.ajaxData.SIGNED_PARAMETERS,\n\t\t\t\tdata: fields\n\t\t\t}\n\t\t)\n\t\t\t.then(response => {\n\t\t\t\tconst property = response.data.PROPERTY_FIELDS;\n\t\t\t\tif (!property)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst additionalValues = response.data.ADDITIONAL_VALUES;\n\t\t\t\tif (additionalValues)\n\t\t\t\t{\n\t\t\t\t\tconst model = this._editor._model;\n\t\t\t\t\tfor (let [key, value] of Object.entries(additionalValues))\n\t\t\t\t\t{\n\t\t\t\t\t\tmodel.setField(key, value);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tlet mode = BX.UI.EntityEditorMode.view;\n\t\t\t\tif (section instanceof BX.UI.EntityEditorSection)\n\t\t\t\t{\n\t\t\t\t\tmode = section.getMode()\n\t\t\t\t}\n\n\t\t\t\tconst control = this.createProperty(property, section.getName(), {\n\t\t\t\t\tlayout: {\n\t\t\t\t\t\tnotifyIfNotDisplayed: true,\n\t\t\t\t\t\tforceDisplay: eventArgs.showAlways\n\t\t\t\t\t},\n\t\t\t\t\tmode: mode\n\t\t\t\t});\n\n\t\t\t\tcontrol.toggleOptionFlag(eventArgs.showAlways);\n\n\t\t\t\tthis._editor.saveSchemeChanges();\n\n\t\t\t\tthis.isRequesting = false;\n\t\t\t})\n\t\t\t.catch(response => {\n\t\t\t\tthis.isRequesting = false;\n\t\t\t})\n\t\t;\n\t}\n\n\thandleFieldUpdate(event: BaseEvent)\n\t{\n\t\tconst [section, eventArgs] = event.getCompatData();\n\t\tif (!(eventArgs.field instanceof BX.UI.EntityEditorControl))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst currentField = eventArgs.field;\n\t\teventArgs.CODE = currentField.getId();\n\n\t\tconst fields = this.getFieldsForm(eventArgs);\n\t\tconst schemeElement = currentField.getSchemeElement();\n\t\tschemeElement._isRequired = eventArgs.mandatory;\n\n\t\tajax.runComponentAction(\n\t\t\tthis._editor._settings.ajaxData.COMPONENT_NAME,\n\t\t\t'updateProperty',\n\t\t\t{\n\t\t\t\tmode: 'class',\n\t\t\t\tsignedParameters: this._editor._settings.ajaxData.SIGNED_PARAMETERS,\n\t\t\t\tdata: fields\n\t\t\t}\n\t\t).then(response => {\n\t\t\tconst property = response?.data?.PROPERTY_FIELDS;\n\t\t\tif (currentField instanceof BX.UI.EntityEditorDatetime || currentField instanceof BX.UI.EntityEditorMultiDatetime)\n\t\t\t{\n\t\t\t\tconst schemeElementData = currentField.getSchemeElement().getData();\n\t\t\t\tconst propertyData = property?.data;\n\t\t\t\tif (propertyData)\n\t\t\t\t{\n\t\t\t\t\tschemeElementData.enableTime = propertyData.enableTime;\n\t\t\t\t\tschemeElementData.dateViewFormat = propertyData.dateViewFormat;\n\t\t\t\t\tcurrentField.refreshLayout();\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (currentField instanceof BX.UI.EntityEditorCustom)\n\t\t\t{\n\t\t\t\tcurrentField.refreshLayout();\n\t\t\t}\n\n\t\t\tlet newType = null;\n\t\t\tlet schemeElement = null;\n\t\t\tif (eventArgs.multiple === true)\n\t\t\t{\n\t\t\t\tif (currentField instanceof BX.UI.EntityEditorText)\n\t\t\t\t{\n\t\t\t\t\tnewType = 'multitext';\n\t\t\t\t}\n\t\t\t\telse if (currentField instanceof BX.UI.EntityEditorList)\n\t\t\t\t{\n\t\t\t\t\tnewType = 'multilist';\n\t\t\t\t}\n\t\t\t\telse if (currentField instanceof BX.UI.EntityEditorDatetime)\n\t\t\t\t{\n\t\t\t\t\tnewType = 'multidatetime';\n\t\t\t\t}\n\t\t\t\telse if (currentField instanceof BX.UI.EntityEditorNumber)\n\t\t\t\t{\n\t\t\t\t\tnewType = 'multinumber';\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (currentField instanceof BX.UI.EntityEditorMultiList)\n\t\t\t\t{\n\t\t\t\t\tnewType = 'list';\n\t\t\t\t}\n\t\t\t\telse if (currentField instanceof BX.UI.EntityEditorMultiDatetime)\n\t\t\t\t{\n\t\t\t\t\tnewType = 'datetime';\n\t\t\t\t}\n\t\t\t\telse if (currentField instanceof BX.UI.EntityEditorMultiNumber)\n\t\t\t\t{\n\t\t\t\t\tnewType = 'number';\n\t\t\t\t}\n\t\t\t\telse if (currentField instanceof BX.UI.EntityEditorMultiText)\n\t\t\t\t{\n\t\t\t\t\tnewType = 'text';\n\t\t\t\t}\n\t\t\t}\n\t\t\tschemeElement = currentField.getSchemeElement();\n\t\t\tif (\n\t\t\t\t((currentField instanceof BX.UI.EntityEditorList) || (currentField instanceof BX.UI.EntityEditorMultiList))\n\t\t\t\t&& property\n\t\t\t)\n\t\t\t{\n\t\t\t\tschemeElement = BX.UI.EntitySchemeElement.create(property);\n\t\t\t\tnewType = property.type;\n\t\t\t}\n\t\t\tif (newType)\n\t\t\t{\n\t\t\t\tconst index = section.getChildIndex(currentField);\n\t\t\t\tconst newControl = this._editor.createControl(\n\t\t\t\t\tnewType,\n\t\t\t\t\teventArgs.CODE,\n\t\t\t\t\t{\n\t\t\t\t\t\tschemeElement: schemeElement,\n\t\t\t\t\t\tmodel: section._model,\n\t\t\t\t\t\tparent: section,\n\t\t\t\t\t\tmode: section.getMode()\n\t\t\t\t\t}\n\t\t\t\t);\n\n\t\t\t\tsection.addChild(newControl, {\n\t\t\t\t\tindex,\n\t\t\t\t\tlayout: {\n\t\t\t\t\t\tforceDisplay: true\n\t\t\t\t\t},\n\t\t\t\t\tenableSaving: false\n\t\t\t\t});\n\n\t\t\t\tcurrentField._schemeElement = null;\n\t\t\t\tsection.removeChild(currentField, {\n\t\t\t\t\tenableSaving: false\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis.isRequesting = false;\n\t\t})\n\t\t\t.catch(response => {\n\t\t\t\tthis.isRequesting = false;\n\t\t\t});\n\t}\n\n\tgetFieldsForm(fields)\n\t{\n\t\tconst form = new FormData();\n\t\tconst formatted = {\n\t\t\tNAME: fields.label,\n\t\t\tMULTIPLE: fields.multiple ? 'Y' : 'N',\n\t\t\tIS_REQUIRED: fields.mandatory ? 'Y' : 'N',\n\t\t\tIS_PUBLIC: fields.isPublic ? 'Y' : 'N',\n\t\t\tPROPERTY_TYPE: 'S',\n\t\t\tCODE: fields.CODE || ''\n\t\t};\n\n\t\tswitch (fields.typeId)\n\t\t{\n\t\t\tcase 'integer':\n\t\t\tcase 'double':\n\t\t\t\tformatted.PROPERTY_TYPE = 'N';\n\t\t\t\tbreak;\n\t\t\tcase 'list':\n\t\t\tcase 'multilist':\n\t\t\t\tformatted.PROPERTY_TYPE = 'L';\n\t\t\t\t(fields.enumeration || []).forEach((enumItem, key) => {\n\t\t\t\t\tform.append(this.getFormFieldName('VALUES][' + key + '][SORT'), enumItem.SORT);\n\t\t\t\t\tform.append(this.getFormFieldName('VALUES][' + key + '][VALUE'), enumItem.VALUE);\n\t\t\t\t\tform.append(this.getFormFieldName('VALUES][' + key + '][ID'), enumItem.ID);\n\t\t\t\t});\n\t\t\t\tbreak;\n\t\t\tcase 'directory':\n\t\t\t\tformatted.USER_TYPE = 'directory';\n\t\t\t\t(fields.enumeration || []).forEach((enumItem, key) => {\n\t\t\t\t\tform.append(this.getFormFieldName('VALUES][' + key + '][SORT'), enumItem.SORT);\n\t\t\t\t\tform.append(this.getFormFieldName('VALUES][' + key + '][VALUE'), enumItem.VALUE.value);\n\t\t\t\t\tform.append(this.getFormFieldName('VALUES][' + key + '][XML_ID'), enumItem.XML_ID);\n\t\t\t\t\tform.append(this.getFormFieldName('VALUES][' + key + '][FILE_ID'), enumItem.FILE_ID);\n\t\t\t\t\tform.append('FILES[' + enumItem.SORT + ']', enumItem.VALUE.file);\n\t\t\t\t});\n\t\t\t\tbreak;\n\t\t\tcase 'boolean':\n\t\t\t\tformatted.PROPERTY_TYPE = 'L';\n\t\t\t\tform.append(this.getFormFieldName('VALUES][0][VALUE'), 'Y')\n\t\t\t\tformatted.LIST_TYPE = 'C';\n\t\t\t\tbreak;\n\t\t\tcase 'money':\n\t\t\t\tformatted.USER_TYPE = 'Money';\n\t\t\t\tbreak;\n\t\t\tcase 'address':\n\t\t\t\tformatted.USER_TYPE = 'map_google';\n\t\t\t\tbreak;\n\t\t\tcase 'datetime':\n\t\t\tcase 'multidatetime':\n\t\t\t\tformatted.USER_TYPE = (fields.enableTime === true) ? 'DateTime' : 'Date';\n\t\t\t\tbreak;\n\t\t\tcase 'file':\n\t\t\t\tformatted.USER_TYPE = 'DiskFile';\n\t\t\t\tbreak;\n\t\t\tcase 'custom':\n\t\t\t\tformatted.USER_TYPE = fields.userType;\n\t\t\t\tbreak;\n\t\t}\n\n\t\tfor (let [key, item] of Object.entries(formatted))\n\t\t{\n\t\t\tform.append(this.getFormFieldName(key), item);\n\t\t}\n\t\treturn form;\n\t}\n\n\tgetFormFieldName(name)\n\t{\n\t\treturn 'fields[' + name + ']';\n\t}\n\n\tcreateProperty(property, sectionName, options = {})\n\t{\n\t\tconst sectionSchemeElement = this._editor.getSchemeElementByName(sectionName);\n\t\tif (!sectionSchemeElement)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst schemeElement = BX.UI.EntitySchemeElement.create(property);\n\t\tsectionSchemeElement._elements.push(schemeElement);\n\n\t\tconst mode = options.mode || BX.UI.EntityEditorMode.edit;\n\t\tconst control = this._editor.createControl(\n\t\t\tschemeElement.getType(),\n\t\t\tschemeElement.getName(),\n\t\t\t{\n\t\t\t\tschemeElement: schemeElement,\n\t\t\t\tmodel: this._model,\n\t\t\t\tparent: this,\n\t\t\t\tmode: mode\n\t\t\t}\n\t\t);\n\n\t\tif (!control)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst sectionControl = this._editor.getControlById(sectionName);\n\t\tsectionControl.addChild(control, {\n\t\t\t...options,\n\t\t\tenableSaving: false\n\t\t});\n\n\t\treturn control;\n\t}\n}","import {type BaseEvent, EventEmitter} from 'main.core.events';\nimport {Dom, Reflection, Type} from 'main.core';\nimport GridStore from '../grid/grid-store';\n\nexport default class ProductServiceGridController extends BX.UI.EntityEditorController\n{\n\tareaHeight = null\n\tgridStore: GridStore;\n\n\tconstructor(id, settings)\n\t{\n\t\tsuper();\n\t\tthis.initialize(id, settings);\n\t}\n\n\tdoInitialize()\n\t{\n\t\tsuper.doInitialize();\n\n\t\tEventEmitter.subscribe('Grid::thereEditedRows', this.markAsChangedHandler.bind(this));\n\t\tEventEmitter.subscribe('Grid::noEditedRows', this.checkEditorToolbar.bind(this));\n\t\tEventEmitter.subscribe('Grid::updated', this.onGridUpdated.bind(this));\n\t\tEventEmitter.subscribe('Grid::beforeRequest', this.onBeforeGridRequest.bind(this));\n\n\t\tEventEmitter.subscribe('onAjaxSuccess', this.ajaxSuccessHandler.bind(this));\n\n\t\tEventEmitter.subscribe('BX.UI.EntityEditorIncludedArea:onBeforeLoad', this.onBeforeIncludedAreaLoaded.bind(this));\n\t\tEventEmitter.subscribe('BX.UI.EntityEditorIncludedArea:onAfterLoad', this.onAfterIncludedAreaLoaded.bind(this));\n\t\tEventEmitter.subscribe(\"BX.UI.EntityEditor:onNothingChanged\", this.onNothingChanged.bind(this));\n\n\t\tthis.subscribeToFormSubmit();\n\n\t\tthis.gridStore = new GridStore(this.getGridId());\n\t}\n\n\tonBeforeIncludedAreaLoaded(event: BaseEvent)\n\t{\n\t\tif (Type.isNumber(this.areaHeight))\n\t\t{\n\t\t\tDom.style(this.getProductServiceGridLoader(), 'height', this.areaHeight + 'px');\n\t\t}\n\t}\n\n\tonAfterIncludedAreaLoaded(event: BaseEvent)\n\t{\n\t\tDom.style(this.getProductServiceGridLoader(), 'height', '');\n\t\tthis.areaHeight = null;\n\t}\n\n\tonNothingChanged(event: BaseEvent)\n\t{\n\t\tthis.rollback();\n\t}\n\n\tgetProductServiceGridLoader()\n\t{\n\t\tconst control = this.getGridControl();\n\n\t\tif (control)\n\t\t{\n\t\t\tconst wrapper = control.getWrapper();\n\n\t\t\tif (wrapper)\n\t\t\t{\n\t\t\t\treturn wrapper.querySelector('.ui-entity-editor-included-area-container-loader');\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t}\n\n\trollback()\n\t{\n\t\tsuper.rollback();\n\t\tthis.checkEditorToolbar();\n\t\tthis.unsubscribeGridEvents();\n\n\t\tBX.Main.gridManager.destroy(this.getGridId());\n\t}\n\n\tonAfterSave()\n\t{\n\t\tif (this.isChanged() || this._editor.isChanged())\n\t\t{\n\t\t\tthis.setGridControlCache(null);\n\t\t\tEventEmitter.emit(\n\t\t\t\t'onAfterProducServiceGridSave',\n\t\t\t\t{\n\t\t\t\t\tgridId: this.getGridId(),\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\tBX.Main.gridManager.destroy(this.getGridId());\n\t\tthis.subscribeToFormSubmit();\n\t\tsuper.onAfterSave();\n\t}\n\n\tsetGridControlCache(html)\n\t{\n\t\tconst control = this.getGridControl();\n\n\t\tif (control)\n\t\t{\n\t\t\tcontrol._loadedHtml = html;\n\t\t}\n\t}\n\n\tonBeforeSubmit()\n\t{\n\t\tthis.unsubscribeGridEvents();\n\t}\n\n\t/**\n\t * @returns {BX.Catalog.ProductServiceGrid|null}\n\t */\n\tgetVariationGridComponent()\n\t{\n\t\treturn Reflection.getClass('BX.Catalog.ProductServiceGrid.Instance');\n\t}\n\n\tunsubscribeGridEvents()\n\t{\n\t\tconst gridComponent = this.getVariationGridComponent();\n\t\tif (gridComponent)\n\t\t{\n\t\t\tgridComponent.destroy();\n\t\t}\n\n\t\tconst popup = this.getGrid()?.getSettingsWindow()?.getPopup();\n\t\tif (popup)\n\t\t{\n\t\t\tEventEmitter.emit(this.getGrid().getSettingsWindow().getPopup(), 'onDestroy');\n\t\t}\n\n\t\tEventEmitter.unsubscribeAll('BX.Main.grid:paramsUpdated');\n\t}\n\n\tajaxSuccessHandler(event: BaseEvent)\n\t{\n\t\tconst [, xhrData] = event.getCompatData();\n\n\t\tif (xhrData.url.indexOf(this.getReloadUrl()) === 0)\n\t\t{\n\t\t\tthis.setGridControlCache(null);\n\t\t}\n\t}\n\n\t// ajax form initializes every \"save\" action\n\tsubscribeToFormSubmit()\n\t{\n\t\tEventEmitter.subscribe(this._editor._ajaxForm, 'onBeforeSubmit', this.onBeforeSubmitForm.bind(this));\n\t}\n\n\tmarkAsChangedHandler()\n\t{\n\t\tif (!this._editor.isNew())\n\t\t{\n\t\t\tthis.markAsChanged();\n\t\t}\n\t}\n\n\tcheckEditorToolbar()\n\t{\n\t\tthis._isChanged = false;\n\n\t\tif (this._editor.getActiveControlCount() > 0)\n\t\t{\n\t\t\tthis._editor.showToolPanel();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis._editor.hideToolPanel();\n\t\t}\n\n\t\tif (this._editor._toolPanel)\n\t\t{\n\t\t\tthis._editor._toolPanel.clearErrors();\n\t\t}\n\t}\n\n\tgetGridControl()\n\t{\n\t\treturn this._editor.getControlById('service_grid');\n\t}\n\n\tonGridUpdated(event: BaseEvent)\n\t{\n\t\tconst [grid] = event.getCompatData();\n\n\t\tthis.checkEditorToolbar();\n\n\t\tif (grid.getId() === this.getGrid().getId())\n\t\t{\n\t\t\tsetTimeout(\n\t\t\t\t() => {\n\t\t\t\t\tthis.gridStore.loadEditedRows();\n\t\t\t\t},\n\t\t\t\t0 // delay for re-render grid\n\t\t\t);\n\t\t}\n\t}\n\n\tonBeforeGridRequest(event: BaseEvent)\n\t{\n\t\tconst [grid, eventArgs] = event.getCompatData();\n\n\t\tif (!grid || !grid.parent || grid.parent.getId() !== this.getGridId())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.gridStore.saveEditedRows();\n\n\t\teventArgs.sessid = BX.bitrix_sessid();\n\t\teventArgs.method = 'POST';\n\t\teventArgs.url = this.getReloadUrl();\n\t\teventArgs.data = {\n\t\t\t...eventArgs.data,\n\t\t\trows: this.gridStore.getEditedRowsFields(),\n\t\t\tsignedParameters: this.getSignedParameters()\n\t\t};\n\n\t\tthis.unsubscribeGridEvents();\n\t}\n\n\tgetReloadUrl()\n\t{\n\t\treturn this.getConfigStringParam('reloadUrl', '');\n\t}\n\n\tgetSignedParameters()\n\t{\n\t\treturn this.getConfigStringParam('signedParameters', '');\n\t}\n\n\tgetGridId()\n\t{\n\t\treturn this.getConfigStringParam('gridId', '');\n\t}\n\n\tgetGrid()\n\t{\n\t\tif (!Reflection.getClass('BX.Main.gridManager.getInstanceById'))\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn BX.Main.gridManager.getInstanceById(this.getGridId());\n\t}\n\n\tonBeforeSubmitForm(event: BaseEvent)\n\t{\n\t\tconst [, eventArgs] = event.getCompatData();\n\t\tconst grid = this.getGrid();\n\n\t\tif (!grid)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst skuGridName = this.getGridId();\n\t\tconst skuGridData = grid.getRows().getEditSelectedValues();\n\t\tconst copyItemsMap = grid.getParam('COPY_ITEMS_MAP', {});\n\n\t\t// replace sku custom properties edit data names with original names\n\t\tfor (let id in skuGridData)\n\t\t{\n\t\t\tif (!skuGridData.hasOwnProperty(id))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tfor (let name in skuGridData[id])\n\t\t\t{\n\t\t\t\tif (!skuGridData[id].hasOwnProperty(name))\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tif (name.includes('SKU_GRID_CATALOG_GROUP')\n\t\t\t\t\t|| name.includes('SKU_GRID_PURCHASING')\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tfor (let priceField in skuGridData[id][name])\n\t\t\t\t\t{\n\t\t\t\t\t\tif (skuGridData[id][name].hasOwnProperty(priceField))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tskuGridData[id][priceField] = skuGridData[id][name][priceField];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (name.includes('[EDIT_HTML]'))\n\t\t\t\t{\n\t\t\t\t\tlet newName = name.replace('[EDIT_HTML]', '');\n\n\t\t\t\t\t// lookup for a custom file fields\n\t\t\t\t\tif (newName.endsWith('_custom'))\n\t\t\t\t\t{\n\t\t\t\t\t\tif ('bxu_files[]' in skuGridData[id][name])\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tskuGridData[id][name].isFile = true;\n\t\t\t\t\t\t\tdelete skuGridData[id][name]['bxu_files[]'];\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (skuGridData[id][name].isFile)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tfor (let fieldName in skuGridData[id][name])\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tif (skuGridData[id][name].hasOwnProperty(fieldName))\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t// check for new files like \"MORE_PHOTO_n1[name]\"(multiple) or \"DETAIL_PICTURE[name]\"(single)\n\t\t\t\t\t\t\t\t\tlet newFilesRegExp = new RegExp(/([0-9A-Za-z_]+?(_n\\d+)*)\\[([A-Za-z_]+)\\]/);\n\n\t\t\t\t\t\t\t\t\tif (newFilesRegExp.test(fieldName))\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tlet fileCounter, fileSetting;\n\n\t\t\t\t\t\t\t\t\t\t[, fileCounter, , fileSetting] = fieldName.match(newFilesRegExp);\n\n\t\t\t\t\t\t\t\t\t\tif (fileCounter && fileSetting)\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\tskuGridData[id][name][fileCounter] = skuGridData[id][name][fileCounter] || {};\n\t\t\t\t\t\t\t\t\t\t\tskuGridData[id][name][fileCounter][fileSetting] = skuGridData[id][name][fieldName];\n\t\t\t\t\t\t\t\t\t\t\tdelete skuGridData[id][name][fieldName];\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tskuGridData[id][newName] = skuGridData[id][name];\n\t\t\t\t\tdelete skuGridData[id][name];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (!Type.isNil(copyItemsMap[id]))\n\t\t\t{\n\t\t\t\tskuGridData[id]['COPY_SKU_ID'] = copyItemsMap[id];\n\t\t\t}\n\t\t}\n\n\t\tif (!Type.isPlainObject(eventArgs.options))\n\t\t{\n\t\t\teventArgs.options = {};\n\t\t}\n\n\t\tif (!Type.isPlainObject(eventArgs.options.data))\n\t\t{\n\t\t\teventArgs.options.data = {};\n\t\t}\n\n\t\teventArgs.options.data[skuGridName] = skuGridData;\n\n\t\tthis.areaHeight = this.getGridControl().getWrapper().offsetHeight;\n\t}\n}\n","import IblockSectionController from './iblock-section/controller';\nimport {type BaseEvent, EventEmitter} from 'main.core.events'\nimport VariationGridController from './variation-grid/controller';\nimport VariationLinkController from './variation-link/controller';\nimport GoogleMapController from './google-map/controller';\nimport EmployeeController from './employee/controller';\nimport UserController from './user/controller';\nimport IblockElementController from './iblock-element/controller';\nimport BindingToCrmElementController from './binding-to-crm-element/controller';\nimport FieldConfiguratorController from './field-configurator/controller';\nimport ProductServiceGridController from \"./product-service-grid/controller\"\n\nexport default class ControllersFactory\n{\n\tconstructor()\n\t{\n\t\tEventEmitter.subscribe('BX.UI.EntityEditorControllerFactory:onInitialize', (event: BaseEvent) => {\n\t\t\tconst [, eventArgs] = event.getCompatData();\n\t\t\teventArgs.methods['entityCard'] = this.factory.bind(this);\n\t\t});\n\t}\n\n\tfactory(type, controlId, settings)\n\t{\n\t\tif (type === 'field_configurator')\n\t\t{\n\t\t\treturn new FieldConfiguratorController(controlId, settings);\n\t\t}\n\n\t\tif (type === 'iblock_section')\n\t\t{\n\t\t\treturn new IblockSectionController(controlId, settings);\n\t\t}\n\n\t\tif (type === 'iblock_element')\n\t\t{\n\t\t\treturn new IblockElementController(controlId, settings);\n\t\t}\n\n\t\tif (type === 'variation_grid')\n\t\t{\n\t\t\treturn new VariationGridController(controlId, settings);\n\t\t}\n\n\t\tif (type === 'variation_link')\n\t\t{\n\t\t\treturn new VariationLinkController(controlId, settings);\n\t\t}\n\n\t\tif (type === 'google_map')\n\t\t{\n\t\t\treturn new GoogleMapController(controlId, settings);\n\t\t}\n\n\t\tif (type === 'employee')\n\t\t{\n\t\t\treturn new EmployeeController(controlId, settings);\n\t\t}\n\n\t\tif (type === 'user')\n\t\t{\n\t\t\treturn new UserController(controlId, settings);\n\t\t}\n\n\t\tif (type === 'binding_to_crm_element')\n\t\t{\n\t\t\treturn new BindingToCrmElementController(controlId, settings);\n\t\t}\n\n\t\tif (type === 'service_grid')\n\t\t{\n\t\t\treturn new ProductServiceGridController(controlId, settings);\n\t\t}\n\n\t\treturn null;\n\t}\n}","import {Event, Tag, Text} from \"main.core\";\n\nexport default class IblockDirectoryFieldItem extends BX.UI.EntityEditorUserFieldListItem\n{\n\tfileChanged = false;\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new this;\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n\n\tlayout()\n\t{\n\t\tif (this._hasLayout)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis._wrapper = Tag.render`\n\t\t\t\t<div class=\"ui-ctl ui-ctl-textbox ui-ctl-w100 ui-ctl-row\"></div>\n\t\t\t`;\n\n\t\tthis._fileInput = Tag.render`\n\t\t\t\t<input class=\"input-image-hidden\" value=\"${BX.prop.getString(this._data, 'FILE_ID', '')}\" type=\"file\" accept=\"image/*\">\n\t\t\t`;\n\t\tEvent.bind(this._fileInput, 'change', this.onFileLoaderChange.bind(this));\n\t\tconst link = BX.prop.getString(this._data, 'IMAGE_SRC', '');\n\t\tthis._wrapper.appendChild(\n\t\t\tTag.render`\n\t\t\t<label class=\"catalog-dictionary-item ${link === '' ? 'catalog-dictionary-item-empty' : ''}\">\n\t\t\t\t<img src=\"${link}\" alt=\"\">\n\t\t\t\t${this._fileInput}\n\t\t\t</label>\n\t\t\t`\n\t\t);\n\n\t\tconst labelText = Text.encode(BX.prop.getString(this._data, 'TEXT', ''));\n\t\tthis._labelInput = Tag.render`\n\t\t\t\t<input \n\t\t\t\t\tclass=\"ui-ctl-element\" \n\t\t\t\t\tvalue=\"${labelText}\"\n\t\t\t\t\tplaceholder=\"${BX.message('CATALOG_ENTITY_CARD_NEW_FIELD_ITEM_PLACEHOLDER')}\"\n\t\t\t\t>\n\t\t\t`;\n\t\tthis._wrapper.appendChild(this._labelInput);\n\n\t\tconst deleteButton = Tag.render`\n\t\t\t\t<div class=\"ui-entity-editor-content-remove-block\"></div>\n\t\t\t`;\n\n\t\tEvent.bind(deleteButton, 'click', this.onDeleteButtonClick.bind(this));\n\t\tthis._wrapper.appendChild(deleteButton);\n\n\t\tvar anchor = BX.prop.getElementNode(this._settings, 'anchor');\n\t\tif (anchor)\n\t\t{\n\t\t\tthis._container.insertBefore(this._wrapper, anchor);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis._container.appendChild(this._wrapper);\n\t\t}\n\n\t\tthis._hasLayout = true;\n\t}\n\n\tonFileLoaderChange(event)\n\t{\n\t\tconst input = event.target;\n\t\tif (input.files && input.files[0])\n\t\t{\n\t\t\tconst reader = new FileReader();\n\t\t\treader.onload = function(e) {\n\t\t\t\tinput.parentNode.querySelector('img').src = e.target.result;\n\t\t\t};\n\n\t\t\tthis.fileChanged = true;\n\t\t\treader.readAsDataURL(input.files[0]);\n\t\t\tinput.parentNode.classList.remove('catalog-dictionary-item-empty');\n\t\t}\n\t}\n\n\tisFileChanged()\n\t{\n\t\treturn this.fileChanged;\n\t}\n\n\tprepareData()\n\t{\n\t\tconst textValue = this._labelInput ? BX.util.trim(this._labelInput.value) : '';\n\t\tconst fileValue = (this._fileInput && this._fileInput.files && this._fileInput.files[0]) ? this._fileInput.files[0] : {};\n\n\t\tconst data = {\n\t\t\t'VALUE': {\n\t\t\t\tvalue: textValue,\n\t\t\t\tfile: fileValue\n\t\t\t},\n\t\t\t'XML_ID': '',\n\t\t\t'FILE_ID': ''\n\t\t};\n\t\tconst xmlId = BX.prop.getString(this._data, 'ID', '');\n\t\tif (BX.type.isNotEmptyString(xmlId))\n\t\t{\n\t\t\tdata['XML_ID'] = xmlId;\n\t\t\tdata['FILE_ID'] = BX.prop.getString(this._data, 'FILE_ID', '');\n\t\t}\n\n\t\treturn data;\n\t}\n}","import {Dom, Event, Reflection, Tag, Text, Type, Loc} from \"main.core\";\nimport IblockDirectoryFieldItem from \"./iblock-directory-field-item\";\n\nexport default class IblockFieldConfigurator extends BX.UI.EntityEditorFieldConfigurator\n{\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new this;\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._enumItems = [];\n\t}\n\tlayoutInternal()\n\t{\n\t\tDom.append(this.getInputContainer(), this._wrapper);\n\t\tif(this._typeId === \"list\" || this._typeId === \"multilist\" || this._typeId === \"directory\")\n\t\t{\n\t\t\tDom.append(Tag.render`<hr class=\"ui-entity-editor-line\">`, this._wrapper);\n\t\t\tif (BX.prop.get(this._field?.getSchemeElement().getData(), 'isConfigurable', null) !== false)\n\t\t\t{\n\t\t\t\tDom.append(this.getEnumerationContainer(), this._wrapper);\n\t\t\t}\n\t\t}\n\n\t\tDom.append(this.getOptionContainer(), this._wrapper);\n\t\tDom.append(this.getErrorContainer(), this._wrapper);\n\t\tDom.append(Tag.render`<hr class=\"ui-entity-editor-line\">`, this._wrapper);\n\t\tDom.append(this.getButtonContainer(), this._wrapper);\n\t}\n\tgetOptionContainer()\n\t{\n\t\tconst isNew = (this._field === null);\n\t\tthis._optionWrapper = Tag.render`\n\t\t\t<div class=\"ui-entity-editor-content-block\"></div>\n\t\t`;\n\n\t\tif (this._typeId === \"datetime\" || this._typeId === \"multidatetime\")\n\t\t{\n\t\t\tthis._isTimeEnabledCheckBox = this.getIsTimeEnabledCheckBox();\n\t\t}\n\n\t\tif (this._typeId !== \"boolean\" && this._enableMandatoryControl)\n\t\t{\n\t\t\tthis._isRequiredCheckBox = this.getIsRequiredCheckBox();\n\t\t}\n\n\t\tif (this.isAllowedMultipleCheckBox())\n\t\t{\n\t\t\tthis._isMultipleCheckBox = this.getMultipleCheckBox();\n\t\t}\n\n\t\tthis._isPublic = this.getIsPublicCheckBox();\n\n\t\t//region Show Always\n\t\tthis._showAlwaysCheckBox = this.createOption({\n\t\t\tcaption: Loc.getMessage('UI_ENTITY_EDITOR_SHOW_ALWAYS'),\n\t\t\thelpUrl: 'https://helpdesk.bitrix24.ru/open/7046149/',\n\t\t\thelpCode: '9627471'\n\t\t});\n\t\tthis._showAlwaysCheckBox.checked = (\n\t\t\tisNew\n\t\t\t\t? BX.prop.getBoolean(this._settings, 'showAlways', true)\n\t\t\t\t: this._field.checkOptionFlag(BX.UI.EntityEditorControlOptions.showAlways)\n\t\t);\n\n\t\tif (!this.isAllowedShowAlwaysCheckBox())\n\t\t{\n\t\t\tDom.style(this._showAlwaysCheckBox.closest('div.ui-ctl-checkbox'), 'display', 'none');\n\t\t}\n\t\t//endregion\n\n\t\treturn this._optionWrapper;\n\t}\n\n\tisAllowedMultipleCheckBox()\n\t{\n\t\tif (BX.prop.get(this?._field?.getSchemeElement()?._settings, 'allowedMultiple', true) === false)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\t\tif (this._typeId === 'boolean')\n\t\t{\n\t\t\treturn false;\n\t\t}\n\t\tconst isEnabledOfferTree = this?._field?.getSchemeElement()?._settings?.isEnabledOfferTree;\n\t\tconst isMultiple = this?._field?.getSchemeElement()?._settings?.multiple;\n\n\t\treturn !isEnabledOfferTree || isMultiple;\n\t}\n\n\tisAllowedShowAlwaysCheckBox()\n\t{\n\t\treturn true;\n\t}\n\n\tgetInputTitle()\n\t{\n\t\tconst manager = this._editor.getUserFieldManager();\n\t\treturn this._field ? this._field.getTitle() : manager.getDefaultFieldLabel(this._typeId);\n\t}\n\tgetErrorContainer()\n\t{\n\t\tthis._errorContainer = Tag.render`\n\t\t\t<div class=\"ui-entity-editor-content-block\"></div>\n\t\t`;\n\t\treturn this._errorContainer;\n\t}\n\n\tgetEnumerationContainer()\n\t{\n\t\tconst enumWrapper = Tag.render`\n\t\t\t<div class=\"ui-entity-editor-content-block\">\n\t\t\t\t<div class=\"ui-entity-editor-block-title\">\n\t\t\t\t\t<span class=\"ui-entity-editor-block-title-text\">${Loc.getMessage(\"UI_ENTITY_EDITOR_UF_ENUM_ITEMS\")}</span>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tthis._enumItemContainer = Tag.render`\n\t\t\t\t<div class=\"ui-entity-editor-content-block\"></div>\n\t\t\t`;\n\t\tDom.append(this._enumItemContainer, enumWrapper);\n\n\t\tconst addButton = Tag.render`\n\t\t\t\t<div class=\"ui-entity-card-content-add-field\">\n\t\t\t\t\t${Loc.getMessage(\"UI_ENTITY_EDITOR_ADD\")}\n\t\t\t\t</div>\n\t\t\t`;\n\t\tEvent.bind(addButton, \"click\", this.onEnumerationItemAddButtonClick.bind(this));\n\n\t\tDom.append(\n\t\t\tTag.render`\n\t\t\t\t<div class=\"ui-entity-editor-content-block-add-field\">\n\t\t\t\t\t${addButton}\n\t\t\t\t</div>\n\t\t\t`,\n\t\t\tenumWrapper\n\t\t);\n\n\t\tif (this._field)\n\t\t{\n\t\t\tthis._field.getItems().forEach(enumFields => {\n\t\t\t\tif (enumFields.VALUE !== '')\n\t\t\t\t{\n\t\t\t\t\tthis.createEnumerationItem({\n\t\t\t\t\t\tVALUE: enumFields.NAME,\n\t\t\t\t\t\tFILE_ID: enumFields.IMAGE || null,\n\t\t\t\t\t\tIMAGE_SRC: enumFields.IMAGE_SRC || '',\n\t\t\t\t\t\tTEXT: enumFields.TEXT || '',\n\t\t\t\t\t\tID: enumFields.VALUE\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tconst lastItem = this.createEnumerationItem();\n\n\t\tthis._draggable = new BX.UI.DragAndDrop.Draggable({\n\t\t\tcontainer: this._enumItemContainer,\n\t\t\tdraggable: '.ui-ctl-row',\n\t\t\tdragElement: '.ui-ctl-row-draggable',\n\t\t\ttype: BX.UI.DragAndDrop.Draggable.CLONE\n\t\t});\n\n\t\tlastItem.focus();\n\t\tthis.initItemClickHandlers();\n\t\treturn enumWrapper;\n\t}\n\n\tonEnumerationItemAddButtonClick()\n\t{\n\t\tthis.unbindItemClickHandlers();\n\t\tthis.createEnumerationItem().focus();\n\t\tthis.bindLastItemClickHandler();\n\t}\n\n\tonEnumerationItemClick()\n\t{\n\t\tthis.unbindItemClickHandlers();\n\t\tthis.createEnumerationItem();\n\t\tthis.bindLastItemClickHandler();\n\t}\n\n\tinitItemClickHandlers()\n\t{\n\t\tthis.unbindItemClickHandlers();\n\t\tthis.bindLastItemClickHandler();\n\t}\n\n\tunbindItemClickHandlers()\n\t{\n\t\tthis._enumItems.forEach(item => Event.unbindAll(item._labelInput, 'click'));\n\t}\n\n\tbindLastItemClickHandler()\n\t{\n\t\tconst lastItem = this._enumItems[this._enumItems.length - 1];\n\t\tif (lastItem)\n\t\t{\n\t\t\tEvent.bindOnce(lastItem._labelInput, 'click', this.onEnumerationItemClick.bind(this));\n\t\t}\n\t}\n\n\tcreateEnumerationItem(data)\n\t{\n\t\tlet item = null;\n\t\tif (this._typeId === 'directory')\n\t\t{\n\t\t\titem = IblockDirectoryFieldItem.create(\n\t\t\t\t\"\",\n\t\t\t\t{\n\t\t\t\t\tconfigurator: this,\n\t\t\t\t\tcontainer: this._enumItemContainer,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse\n\t\t{\n\t\t\titem = BX.UI.EntityEditorUserFieldListItem.create(\n\t\t\t\t\"\",\n\t\t\t\t{\n\t\t\t\t\tconfigurator: this,\n\t\t\t\t\tcontainer: this._enumItemContainer,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\tthis._enumItems.push(item);\n\t\titem.layout();\n\t\treturn item;\n\t}\n\n\tremoveEnumerationItem(item)\n\t{\n\t\tfor (let i = 0, length = this._enumItems.length; i < length; i++)\n\t\t{\n\t\t\tif (this._enumItems[i] === item)\n\t\t\t{\n\t\t\t\tthis._enumItems[i].clearLayout();\n\t\t\t\tthis._enumItems.splice(i, 1);\n\t\t\t\tthis.initItemClickHandlers();\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tprepareSaveParams(e)\n\t{\n\t\tconst params = super.prepareSaveParams(this, arguments);\n\t\tif (this._typeId === 'list' || this._typeId === 'multilist')\n\t\t{\n\t\t\tparams['enumeration'] = [];\n\t\t\tconst hashes = [];\n\t\t\tthis._enumItems.forEach(enumItem => {\n\t\t\t\tif (!(enumItem instanceof BX.UI.EntityEditorUserFieldListItem))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst enumData = enumItem.prepareData();\n\t\t\t\tif (!enumData)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst hash = BX.util.hashCode(enumData['VALUE']);\n\t\t\t\tif (BX.util.in_array(hash, hashes))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\thashes.push(hash);\n\n\t\t\t\tif (Type.isNil(enumData['ID']))\n\t\t\t\t{\n\t\t\t\t\tenumData['ID'] = Text.getRandom();\n\t\t\t\t}\n\n\t\t\t\tlet sortIndex = -1;\n\t\t\t\tif (this._draggable)\n\t\t\t\t{\n\t\t\t\t\tsortIndex = this._draggable.getElementIndex(enumItem.getDraggableContainer());\n\t\t\t\t}\n\n\t\t\t\tsortIndex = (sortIndex >= 0) ? sortIndex : params['enumeration'].length;\n\t\t\t\tenumData[\"SORT\"] = (Text.toNumber(sortIndex) + 1) * 100;\n\t\t\t\tparams['enumeration'].push(enumData);\n\t\t\t});\n\t\t}\n\t\tif (this._typeId === 'directory')\n\t\t{\n\t\t\tparams['enumeration'] = [];\n\t\t\tthis._enumItems.forEach(enumItem => {\n\t\t\t\tif (!(enumItem instanceof IblockDirectoryFieldItem))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst enumData = enumItem.prepareData();\n\t\t\t\tif (!enumData)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tenumData['SORT'] = (params['enumeration'].length + 1) * 100;\n\t\t\t\tparams['enumeration'].push(enumData);\n\t\t\t});\n\t\t}\n\t\telse if (this._typeId === 'datetime' || this._typeId === 'multidatetime')\n\t\t{\n\t\t\tparams['enableTime'] = this._isTimeEnabledCheckBox.checked;\n\t\t}\n\n\t\tif (this._field)\n\t\t{\n\t\t\tif (this._isMultipleCheckBox)\n\t\t\t{\n\t\t\t\tparams[\"multiple\"] = this._isMultipleCheckBox.checked;\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif(this._typeId === \"boolean\")\n\t\t\t{\n\t\t\t\tparams[\"multiple\"] = false;\n\t\t\t}\n\t\t\telse if(this._isMultipleCheckBox)\n\t\t\t{\n\t\t\t\tparams[\"multiple\"] = this._isMultipleCheckBox.checked;\n\t\t\t}\n\t\t}\n\n\t\tif (this._isPublic)\n\t\t{\n\t\t\tparams[\"isPublic\"] = this._isPublic.checked;\n\t\t}\n\n\t\tif (this._typeId === 'custom')\n\t\t{\n\t\t\tparams['userType'] = this._field?.getSchemeElement()?._settings?.settings['USER_TYPE'];\n\t\t}\n\n\t\treturn params;\n\t}\n\n\tgetMultipleCheckBox()\n\t{\n\t\tconst checkBox = this.createOption({caption: BX.message(\"UI_ENTITY_EDITOR_UF_MULTIPLE_FIELD\")});\n\t\tif (\n\t\t\tthis._field instanceof BX.UI.EntityEditorMultiText\n\t\t\t|| this._field instanceof BX.UI.EntityEditorMultiNumber\n\t\t\t|| this._field instanceof BX.UI.EntityEditorMultiList\n\t\t\t|| this._field instanceof BX.UI.EntityEditorMultiDatetime\n\t\t\t|| this._field instanceof BX.UI.EntityEditorMultiMoney\n\t\t\t|| (this._field instanceof BX.UI.EntityEditorCustom && this._field.getSchemeElement()._settings.multiple)\n\t\t)\n\t\t{\n\t\t\tcheckBox.checked = true;\n\t\t}\n\n\t\treturn checkBox;\n\t}\n\n\tonSaveButtonClick()\n\t{\n\t\tif(this._isLocked)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif(this._mandatoryConfigurator)\n\t\t{\n\t\t\tif(this._mandatoryConfigurator.isChanged())\n\t\t\t{\n\t\t\t\tthis._mandatoryConfigurator.acceptChanges();\n\t\t\t}\n\t\t\tthis._mandatoryConfigurator.close();\n\t\t}\n\n\t\tconst params = this.prepareSaveParams();\n\n\t\tif (this._field instanceof BX.UI.EntityEditorCustom)\n\t\t{\n\t\t\tthis._field.getSchemeElement().mergeSettings({multiple: params.multiple});\n\n\t\t\tconst modes = ['edit', 'view'];\n\t\t\tfor (let i = 0; i < modes.length; i++)\n\t\t\t{\n\t\t\t\tconst htmlListName = BX.prop.getString(this._field.getSchemeElement().getData(), modes[i] + 'List', null);\n\t\t\t\tconst htmlList = BX.prop.getObject(this._field.getModel().getData(), htmlListName, null);\n\n\t\t\t\tif (htmlList !== null)\n\t\t\t\t{\n\t\t\t\t\tconst newHtml = params.multiple ? htmlList.MULTIPLE : htmlList.SINGLE;\n\t\t\t\t\tconst htmlName = BX.prop.getString(this._field.getSchemeElement().getData(), modes[i], null);\n\n\t\t\t\t\tif (BX.prop.getString(this._field.getModel().getData(), htmlName, null) !== null)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis._field.getModel().setField(htmlName, newHtml);\n\t\t\t\t\t\tthis._field.getModel().setInitFieldValue(htmlName, newHtml);\n\t\t\t\t\t\tif (modes[i] === 'view')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (newHtml === '')\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tDom.clean(this._field.getContentWrapper());\n\t\t\t\t\t\t\t\tDom.append(\n\t\t\t\t\t\t\t\t\tTag.render`\n\t\t\t\t\t\t\t\t\t\t<div class=\"ui-entity-editor-content-block-text\">\n\t\t\t\t\t\t\t\t\t\t\t${Loc.getMessage(\"UI_ENTITY_EDITOR_FIELD_EMPTY\")}\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t`,\n\t\t\t\t\t\t\t\t\tthis._field.getContentWrapper()\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis._field.getContentWrapper().innerHTML = newHtml;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis._field?.getSchemeElement()?.setDataParam('isPublic', params['isPublic']);\n\n\t\tBX.onCustomEvent(this, \"onSave\", [ this, params]);\n\t}\n\n\tgetIsRequiredCheckBox()\n\t{\n\t\tlet checkBox;\n\t\tif (this._mandatoryConfigurator)\n\t\t{\n\t\t\tcheckBox = this.createOption(\n\t\t\t\t{\n\t\t\t\t\tcaption: this._mandatoryConfigurator.getTitle() + \":\",\n\t\t\t\t\tlabelSettings: {props: {className: \"ui-entity-new-field-addiction-label\"}},\n\t\t\t\t\tcontainerSettings: {style: {alignItems: \"center\"}},\n\t\t\t\t\telements: this._mandatoryConfigurator.getButton().prepareLayout()\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tcheckBox.checked = (this._field && this._field.isRequired())\n\t\t\t\t|| this._mandatoryConfigurator.isCustomized();\n\n\t\t\tthis._mandatoryConfigurator.setSwitchCheckBox(checkBox);\n\t\t\tthis._mandatoryConfigurator.setLabel(checkBox.nextSibling);\n\n\t\t\tthis._mandatoryConfigurator.setEnabled(checkBox.checked);\n\t\t\tthis._mandatoryConfigurator.adjust();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tcheckBox = this.createOption({caption: Loc.getMessage(\"UI_ENTITY_EDITOR_UF_REQUIRED_FIELD\")});\n\t\t\tcheckBox.checked = this._field && this._field.isRequired();\n\t\t}\n\t\treturn checkBox;\n\t}\n\n\tgetIsTimeEnabledCheckBox()\n\t{\n\t\tconst checkBox = this.createOption({caption:  Loc.getMessage(\"UI_ENTITY_EDITOR_UF_ENABLE_TIME\")});\n\t\tcheckBox.checked = this._field && this._field.isTimeEnabled();\n\t\treturn checkBox;\n\t}\n\n\tgetIsPublicCheckBox()\n\t{\n\t\tconst checkBox = this.createOption({caption: Loc.getMessage(\"CATALOG_ENTITY_EDITOR_IS_PUBLIC_PROPERTY\")});\n\t\tif (!this._field)\n\t\t{\n\t\t\tcheckBox.checked = true;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tcheckBox.checked = this._field.getSchemeElement() && BX.prop.get(this._field.getSchemeElement().getData(), \"isPublic\", true);\n\t\t}\n\t\treturn checkBox;\n\t}\n}\n\nReflection.namespace('BX.Catalog').IblockFieldConfigurator = IblockFieldConfigurator;","import IblockFieldConfigurator from './iblock-field-configurator'\n\nexport default class IblockFieldConfigurationManager extends BX.UI.EntityConfigurationManager\n{\n\tcreateFieldConfigurator(params, parent)\n\t{\n\t\tif (!BX.type.isPlainObject(params))\n\t\t{\n\t\t\tthrow \"IblockFieldConfigurationManager: The 'params' argument must be object.\";\n\t\t}\n\n\t\treturn this.getSimpleFieldConfigurator(params, parent);\n\t}\n\n\tgetSimpleFieldConfigurator(params, parent)\n\t{\n\t\tlet typeId = \"\";\n\t\tconst field = BX.prop.get(params, 'field', null);\n\t\tif (field)\n\t\t{\n\t\t\ttypeId = field.getType();\n\t\t\tfield.setVisible(false);\n\n\t\t\tif (!BX.prop.get(field.getSchemeElement().getData(), \"isProductProperty\", false))\n\t\t\t{\n\t\t\t\treturn this._fieldConfigurator = BX.UI.EntityEditorFieldConfigurator.create(\n\t\t\t\t\t\"\",\n\t\t\t\t\t{\n\t\t\t\t\t\teditor: this._editor,\n\t\t\t\t\t\tschemeElement: null,\n\t\t\t\t\t\tmodel: parent._model,\n\t\t\t\t\t\tmode: BX.UI.EntityEditorMode.edit,\n\t\t\t\t\t\tparent: parent,\n\t\t\t\t\t\ttypeId: typeId,\n\t\t\t\t\t\tfield: field,\n\t\t\t\t\t\tmandatoryConfigurator: null\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t\telse if (BX.prop.get(field.getSchemeElement().getData(), \"userType\", false))\n\t\t\t{\n\t\t\t\ttypeId = BX.prop.getString(field.getSchemeElement().getData(), \"userType\")\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\ttypeId = BX.prop.get(params, 'typeId', BX.UI.EntityUserFieldType.string);\n\t\t}\n\n\t\tthis._fieldConfigurator = IblockFieldConfigurator.create(\n\t\t\t'',\n\t\t\t{\n\t\t\t\teditor: this._editor,\n\t\t\t\tschemeElement: null,\n\t\t\t\tmodel: parent._model,\n\t\t\t\tmode: BX.UI.EntityEditorMode.edit,\n\t\t\t\tparent: parent,\n\t\t\t\ttypeId: typeId,\n\t\t\t\tfield: field,\n\t\t\t\tmandatoryConfigurator: null\n\t\t\t}\n\t\t);\n\n\t\treturn this._fieldConfigurator;\n\t}\n\n\tisCreationEnabled()\n\t{\n\t\treturn this._editor?.isSectionEditEnabled() && !this._editor?.isReadOnly();\n\t}\n\n\tgetCreationPageUrl(typeId)\n\t{\n\t\treturn this.creationPageUrl;\n\t}\n\n\topenCreationPageUrl(typeId)\n\t{\n\t\tBX.SidePanel.Instance.open(this.getCreationPageUrl(typeId), {\n\t\t\twidth: 900, // corresponds to the slider settings on `iblock/install/components/bitrix/iblock.property.grid/templates/.default/script.es6.js`\n\t\t\tallowChangeHistory: false,\n\t\t\tcacheable: false\n\t\t});\n\t}\n\n\tsetCreationPageUrl(url)\n\t{\n\t\treturn this.creationPageUrl = url;\n\t}\n\n\tgetTypeInfos()\n\t{\n\t\tvar items = [];\n\t\titems.push({\n\t\t\tname: \"string\",\n\t\t\ttitle: BX.message(\"UI_ENTITY_EDITOR_UF_STRING_TITLE\"),\n\t\t\tlegend: BX.message(\"UI_ENTITY_EDITOR_UF_STRING_LEGEND\")\n\t\t});\n\t\titems.push({\n\t\t\tname: \"list\",\n\t\t\ttitle: BX.message(\"UI_ENTITY_EDITOR_UF_ENUM_TITLE\"),\n\t\t\tlegend: BX.message(\"UI_ENTITY_EDITOR_UF_ENUM_LEGEND\")\n\t\t});\n\t\titems.push({\n\t\t\tname: \"datetime\",\n\t\t\ttitle: BX.message(\"UI_ENTITY_EDITOR_UF_DATETIME_TITLE\"),\n\t\t\tlegend: BX.message(\"UI_ENTITY_EDITOR_UF_DATETIME_LEGEND\")\n\t\t});\n\t\titems.push({\n\t\t\tname: \"address\",\n\t\t\ttitle: BX.message(\"UI_ENTITY_EDITOR_UF_ADDRESS_TITLE\"),\n\t\t\tlegend: BX.message(\"UI_ENTITY_EDITOR_UF_ADDRESS_LEGEND\")\n\t\t});\n\n\t\titems.push({\n\t\t\tname: \"money\",\n\t\t\ttitle: BX.message(\"UI_ENTITY_EDITOR_UF_MONEY_TITLE\"),\n\t\t\tlegend: BX.message(\"UI_ENTITY_EDITOR_UF_MONEY_LEGEND\")\n\t\t});\n\t\titems.push({\n\t\t\tname: \"boolean\",\n\t\t\ttitle: BX.message(\"UI_ENTITY_EDITOR_BOOLEAN_TITLE\"),\n\t\t\tlegend: BX.message(\"UI_ENTITY_EDITOR_UF_BOOLEAN_LEGEND\")\n\t\t});\n\t\titems.push({\n\t\t\tname: \"double\",\n\t\t\ttitle: BX.message(\"UI_ENTITY_EDITOR_UF_DOUBLE_TITLE\"),\n\t\t\tlegend: BX.message(\"UI_ENTITY_EDITOR_UF_DOUBLE_LEGEND\")\n\t\t});\n\t\titems.push({\n\t\t\tname: \"directory\",\n\t\t\ttitle: BX.message(\"CATALOG_ENTITY_CARD_DICTIONARY_TITLE\"),\n\t\t\tlegend: BX.message(\"CATALOG_ENTITY_CARD_DICTIONARY_LEGEND\")\n\t\t});\n\n\t\titems.push({\n\t\t\tname: \"custom\",\n\t\t\ttitle: BX.message(\"UI_ENTITY_EDITOR_UF_CUSTOM_TITLE\"),\n\t\t\tlegend: BX.message(\"UI_ENTITY_EDITOR_UF_CUSTOM_LEGEND\")\n\t\t});\n\n\t\treturn items;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new this;\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import {Dom, Event, Tag} from \"main.core\";\n\nexport default class GridFieldConfigurator extends BX.UI.EntityEditorFieldConfigurator\n{\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new this;\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n\n\t// ToDo remove unused methods\n\tappendEnumerationSettings()\n\t{\n\t\tif (this._typeId === \"list\" || this._typeId === \"multilist\")\n\t\t{\n\t\t\tDom.append(Tag.render`<hr class=\"ui-entity-editor-line\">`, this._wrapper);\n\n\t\t\tconst enumWrapper = Tag.render`\n\t\t\t\t<div class=\"ui-entity-editor-content-block\">\n\t\t\t\t\t<div class=\"ui-entity-editor-block-title\">\n\t\t\t\t\t\t<span class=\"ui-entity-editor-block-title-text\">${BX.message(\"UI_ENTITY_EDITOR_UF_ENUM_ITEMS\")}</span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tDom.append(enumWrapper, this._wrapper);\n\n\t\t\tthis._enumItemContainer = Tag.render`\n\t\t\t\t\t<div class=\"ui-entity-editor-content-block\"></div>\n\t\t\t\t`;\n\t\t\tDom.append(this._enumItemContainer, enumWrapper);\n\n\t\t\tconst addButton = Tag.render`\n\t\t\t\t\t<div class=\"ui-entity-card-content-add-field\">\n\t\t\t\t\t\t${BX.message(\"UI_ENTITY_EDITOR_ADD\")}\n\t\t\t\t\t</div>\n\t\t\t\t`;\n\t\t\tEvent.bind(addButton, \"click\", this.onEnumerationItemAddButtonClick.bind(this));\n\n\t\t\tDom.append(\n\t\t\t\tTag.render`\n\t\t\t\t\t<div class=\"ui-entity-editor-content-block-add-field\">\n\t\t\t\t\t\t${addButton}\n\t\t\t\t\t</div>\n\t\t\t\t`,\n\t\t\t\tenumWrapper\n\t\t\t);\n\n\t\t\tif (this._field)\n\t\t\t{\n\t\t\t\tthis._field.getItems().forEach(enumFields => {\n\t\t\t\t\tif (enumFields.VALUE !== '')\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.createEnumerationItem({\n\t\t\t\t\t\t\tVALUE: enumFields.NAME,\n\t\t\t\t\t\t\tID: enumFields.VALUE\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis.createEnumerationItem();\n\t\t\tthis.initItemFocusHandlers();\n\t\t}\n\t}\n\n\tonEnumerationItemAddButtonClick()\n\t{\n\t\tthis.unbindItemFocusHandlers();\n\t\tthis.createEnumerationItem().focus();\n\t\tthis.bindLastItemFocusHandler();\n\t}\n\n\tonEnumerationItemFocus()\n\t{\n\t\tthis.unbindItemFocusHandlers();\n\t\tthis.createEnumerationItem();\n\t\tthis.bindLastItemFocusHandler();\n\t}\n\n\tinitItemFocusHandlers()\n\t{\n\t\tthis.unbindItemFocusHandlers();\n\t\tthis.bindLastItemFocusHandler();\n\t}\n\n\tunbindItemFocusHandlers()\n\t{\n\t\tthis._enumItems.forEach(item => Event.unbindAll(item._labelInput, 'focus'));\n\t}\n\n\tbindLastItemFocusHandler()\n\t{\n\t\tconst lastItem = this._enumItems[this._enumItems.length - 1];\n\t\tif (lastItem)\n\t\t{\n\t\t\tEvent.bindOnce(lastItem._labelInput, 'focus', this.onEnumerationItemFocus.bind(this));\n\t\t}\n\t}\n\n\tcreateEnumerationItem(data)\n\t{\n\t\tvar item = BX.UI.EntityEditorUserFieldListItem.create(\n\t\t\t\"\",\n\t\t\t{\n\t\t\t\tconfigurator: this,\n\t\t\t\tcontainer: this._enumItemContainer,\n\t\t\t\tdata: data\n\t\t\t}\n\t\t);\n\n\t\tthis._enumItems.push(item);\n\t\titem.layout();\n\t\treturn item;\n\t}\n\n\tremoveEnumerationItem(item)\n\t{\n\t\tfor (var i = 0, length = this._enumItems.length; i < length; i++)\n\t\t{\n\t\t\tif (this._enumItems[i] === item)\n\t\t\t{\n\t\t\t\tthis._enumItems[i].clearLayout();\n\t\t\t\tthis._enumItems.splice(i, 1);\n\t\t\t\tthis.initItemFocusHandlers();\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tprepareSaveParams(e)\n\t{\n\t\tconst params = super.prepareSaveParams(this, arguments);\n\t\tif (this._typeId === 'list' || this._typeId === 'multilist')\n\t\t{\n\t\t\tparams['enumeration'] = [];\n\t\t\tconst hashes = [];\n\t\t\tthis._enumItems.forEach(enumItem => {\n\t\t\t\tif (!(enumItem instanceof BX.UI.EntityEditorUserFieldListItem))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst enumData = enumItem.prepareData();\n\t\t\t\tif (!enumData)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst hash = BX.util.hashCode(enumData['VALUE']);\n\t\t\t\tif (BX.util.in_array(hash, hashes))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\thashes.push(hash);\n\t\t\t\tenumData['SORT'] = (params['enumeration'].length + 1) * 100;\n\t\t\t\tparams['enumeration'].push(enumData);\n\t\t\t});\n\t\t}\n\t\telse if (this._typeId === 'datetime' || this._typeId === 'multidatetime')\n\t\t{\n\t\t\tparams['enableTime'] = this._isTimeEnabledCheckBox.checked;\n\t\t}\n\n\t\treturn params;\n\t}\n\n\tgetMultipleCheckBox()\n\t{\n\t\tvar checkBox = this.createOption({caption: BX.message(\"UI_ENTITY_EDITOR_UF_MULTIPLE_FIELD\")});\n\t\tif (\n\t\t\tthis._field instanceof BX.UI.EntityEditorMultiText\n\t\t\t|| this._field instanceof BX.UI.EntityEditorMultiNumber\n\t\t\t|| this._field instanceof BX.UI.EntityEditorMultiList\n\t\t\t|| this._field instanceof BX.UI.EntityEditorMultiDatetime\n\t\t)\n\t\t{\n\t\t\tcheckBox.checked = true;\n\t\t}\n\n\t\treturn checkBox;\n\t}\n\n\tgetIsRequiredCheckBox()\n\t{\n\t\tlet checkBox = null;\n\t\tif (this._typeId !== \"boolean\")\n\t\t{\n\t\t\tif (this._enableMandatoryControl)\n\t\t\t{\n\t\t\t\tif (this._mandatoryConfigurator)\n\t\t\t\t{\n\t\t\t\t\tcheckBox = this.createOption(\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcaption: this._mandatoryConfigurator.getTitle() + \":\",\n\t\t\t\t\t\t\tlabelSettings: {props: {className: \"ui-entity-new-field-addiction-label\"}},\n\t\t\t\t\t\t\tcontainerSettings: {style: {alignItems: \"center\"}},\n\t\t\t\t\t\t\telements: this._mandatoryConfigurator.getButton().prepareLayout()\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\n\t\t\t\t\tcheckBox.checked = (this._field && this._field.isRequired())\n\t\t\t\t\t\t|| this._mandatoryConfigurator.isCustomized();\n\n\t\t\t\t\tthis._mandatoryConfigurator.setSwitchCheckBox(checkBox);\n\t\t\t\t\tthis._mandatoryConfigurator.setLabel(checkBox.nextSibling);\n\n\t\t\t\t\tthis._mandatoryConfigurator.setEnabled(checkBox.checked);\n\t\t\t\t\tthis._mandatoryConfigurator.adjust();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tcheckBox = this.createOption({caption: BX.message(\"UI_ENTITY_EDITOR_UF_REQUIRED_FIELD\")});\n\t\t\t\t\tcheckBox.checked = this._field && this._field.isRequired();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn checkBox;\n\t}\n\n\tgetIsTimeEnabledCheckBox()\n\t{\n\t\tvar checkBox = null;\n\t\tif (this._typeId === \"datetime\" || this._typeId === \"multidatetime\")\n\t\t{\n\t\t\tcheckBox = this.createOption({caption: BX.message(\"UI_ENTITY_EDITOR_UF_ENABLE_TIME\")});\n\t\t\tcheckBox.checked = this._field && this._field.isTimeEnabled();\n\t\t}\n\t\treturn checkBox;\n\t}\n}","import GridFieldConfigurator from './grid-field-configurator'\nimport {Loc, Reflection, Type} from 'main.core';\n\nexport default class GridFieldConfigurationManager extends BX.UI.EntityConfigurationManager\n{\n\tcreateFieldConfigurator(params, parent)\n\t{\n\t\tif (!Type.isPlainObject(params))\n\t\t{\n\t\t\tthrow \"GridFieldConfigurationManager: The 'params' argument must be object.\";\n\t\t}\n\n\t\treturn this.getSimpleFieldConfigurator(params, parent);\n\t}\n\n\tgetSimpleFieldConfigurator(params, parent)\n\t{\n\t\tlet typeId = \"\";\n\t\tconst child = BX.prop.get(params, 'field', null);\n\t\tif (child)\n\t\t{\n\t\t\ttypeId = child.getType();\n\t\t\tchild.setVisible(false);\n\n\t\t\tif (!BX.prop.get(child.getSchemeElement().getData(), \"isProductProperty\", false))\n\t\t\t{\n\t\t\t\treturn this._fieldConfigurator = BX.UI.EntityEditorFieldConfigurator.create(\n\t\t\t\t\t\"\",\n\t\t\t\t\t{\n\t\t\t\t\t\teditor: this._editor,\n\t\t\t\t\t\tschemeElement: null,\n\t\t\t\t\t\tmodel: parent._model,\n\t\t\t\t\t\tmode: BX.UI.EntityEditorMode.edit,\n\t\t\t\t\t\tparent: parent,\n\t\t\t\t\t\ttypeId: typeId,\n\t\t\t\t\t\tfield: child,\n\t\t\t\t\t\tmandatoryConfigurator: null\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\ttypeId = BX.prop.get(params, 'typeId', BX.UI.EntityUserFieldType.string);\n\t\t}\n\n\t\tthis._fieldConfigurator = GridFieldConfigurator.create(\n\t\t\t'',\n\t\t\t{\n\t\t\t\teditor: this._editor,\n\t\t\t\tschemeElement: null,\n\t\t\t\tmodel: parent._model,\n\t\t\t\tmode: BX.UI.EntityEditorMode.edit,\n\t\t\t\tparent: parent,\n\t\t\t\ttypeId: typeId,\n\t\t\t\tfield: child,\n\t\t\t\tmandatoryConfigurator: null\n\t\t\t}\n\t\t);\n\n\t\treturn this._fieldConfigurator;\n\t}\n\n\tisSelectionEnabled()\n\t{\n\t\treturn false;\n\t}\n\n\tisCreationEnabled()\n\t{\n\t\treturn false;\n\t}\n\n\thasExternalForm(typeId)\n\t{\n\t\treturn true;\n\t}\n\n\tgetCreationPageUrl(typeId)\n\t{\n\t\tconst filtered = this.getTypeInfos().filter((item) => {\n\t\t\treturn item.name === typeId\n\t\t});\n\t\tif (filtered.length > 0)\n\t\t{\n\t\t\treturn this.creationPageUrl.replace('#PROPERTY_TYPE#', typeId);\n\t\t}\n\t}\n\n\topenCreationPageUrl(typeId)\n\t{\n\t\tthis.openCreationPageSlider(this.getCreationPageUrl(typeId));\n\t}\n\n\topenCreationPageSlider(url)\n\t{\n\t\tif (Type.isStringFilled(url))\n\t\t{\n\t\t\tBX.SidePanel.Instance.open(url, {\n\t\t\t\twidth: 550,\n\t\t\t\tallowChangeHistory: false,\n\t\t\t\tcacheable: false\n\t\t\t});\n\t\t}\n\t}\n\n\tsetCreationPageUrl(url)\n\t{\n\t\treturn this.creationPageUrl = url;\n\t}\n\n\tgetTypeInfos()\n\t{\n\t\treturn [\n\t\t\t{\n\t\t\t\tname: \"list\",\n\t\t\t\ttitle: BX.message(\"CATALOG_ENTITY_CARD_LIST_TITLE\"),\n\t\t\t\tlegend: BX.message(\"CATALOG_ENTITY_CARD_LIST_LEGEND\")\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"directory\",\n\t\t\t\ttitle: BX.message(\"CATALOG_ENTITY_CARD_DICTIONARY_TITLE\"),\n\t\t\t\tlegend: BX.message(\"CATALOG_ENTITY_CARD_DICTIONARY_LEGEND\")\n\t\t\t}\n\t\t];\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new this;\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import {Text, Type} from 'main.core';\n\nexport default class LazyLoader\n{\n\tconstructor(id, settings)\n\t{\n\t\tthis.id = Type.isStringFilled(id) ? id : Text.getRandom();\n\t\tthis.settings = Type.isObjectLike(settings) ? settings : {};\n\n\t\tthis.container = this.settings.container;\n\t\tif (!this.container)\n\t\t{\n\t\t\tthrow 'Error: Could not find container.';\n\t\t}\n\n\t\tthis.serviceUrl = this.settings.serviceUrl || '';\n\t\tif (!Type.isStringFilled(this.serviceUrl))\n\t\t{\n\t\t\tthrow 'Error. Could not find service url.';\n\t\t}\n\n\t\tthis.tabId = this.settings.tabId || '';\n\t\tif (!Type.isStringFilled(this.tabId))\n\t\t{\n\t\t\tthrow 'Error: Could not find tab id.';\n\t\t}\n\n\t\tthis.params = Type.isObjectLike(this.settings.componentData) ? this.settings.componentData : {};\n\n\t\tthis.isRequestRunning = false;\n\t\tthis.loaded = false;\n\t}\n\n\tisLoaded()\n\t{\n\t\treturn this.loaded;\n\t}\n\n\tload()\n\t{\n\t\tif (!this.isLoaded())\n\t\t{\n\t\t\tthis.startRequest({...this.params, ...{'TABID': this.tabId}});\n\t\t}\n\t}\n\n\tstartRequest(params)\n\t{\n\t\tif (this.isRequestRunning)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.isRequestRunning = true;\n\n\t\tBX.ajax({\n\t\t\turl: this.serviceUrl,\n\t\t\tmethod: 'POST',\n\t\t\tdataType: 'html',\n\t\t\tdata: {\n\t\t\t\t'LOADERID': this.id,\n\t\t\t\t'PARAMS': params\n\t\t\t},\n\t\t\tonsuccess: this.onRequestSuccess.bind(this),\n\t\t\tonfailure: this.onRequestFailure.bind(this)\n\t\t});\n\n\t\treturn true;\n\t}\n\n\tonRequestSuccess(data)\n\t{\n\t\tthis.isRequestRunning = false;\n\t\tthis.container.innerHTML = data;\n\t\tthis.loaded = true;\n\t}\n\n\tonRequestFailure()\n\t{\n\t\tthis.isRequestRunning = false;\n\t\tthis.loaded = true;\n\t}\n}","import {Dom, Event, Text, Type} from 'main.core';\nimport LazyLoader from './lazy-loader';\n\nexport default class Tab\n{\n\tconstructor(id, settings)\n\t{\n\t\tthis.id = Type.isStringFilled(id) ? id : Text.getRandom();\n\t\tthis.settings = Type.isObjectLike(settings) ? settings : {};\n\t\tthis.data = Type.isObjectLike(this.settings.data) ? this.settings.data : {};\n\n\t\tthis.manager = settings.manager || null;\n\n\t\tthis.container = this.settings.container;\n\t\tthis.menuContainer = this.settings.menuContainer;\n\n\t\tthis.active = Type.isBoolean(this.data.active) ? this.data.active : false;\n\t\tthis.enabled = Type.isBoolean(this.data.enabled) ? this.data.enabled : true;\n\n\t\tEvent.bind(\n\t\t\tthis.menuContainer.querySelector('a.catalog-entity-section-tab-link'),\n\t\t\t'click',\n\t\t\tthis.onMenuClick.bind(this)\n\t\t);\n\n\t\tthis.loader = null;\n\n\t\tif (Type.isObjectLike(this.data.loader))\n\t\t{\n\t\t\tthis.loader = new LazyLoader(this.id, {\n\t\t\t\t...this.data.loader,\n\t\t\t\t...{\n\t\t\t\t\ttabId: this.id,\n\t\t\t\t\tcontainer: this.container\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tisEnabled()\n\t{\n\t\treturn this.enabled;\n\t}\n\n\tisActive()\n\t{\n\t\treturn this.active;\n\t}\n\n\tsetActive(active)\n\t{\n\t\tactive = !!active;\n\n\t\tif (this.isActive() === active)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.active = active;\n\n\t\tif (this.isActive())\n\t\t{\n\t\t\tthis.showTab()\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.hideTab()\n\t\t}\n\t}\n\n\tshowTab()\n\t{\n\t\tDom.addClass(this.container, 'catalog-entity-section-tab-content-show');\n\t\tDom.removeClass(this.container, 'catalog-entity-section-tab-content-hide');\n\t\tDom.addClass(this.menuContainer, 'catalog-entity-section-tab-current');\n\n\t\tthis.container.style.display = '';\n\t\tthis.container.style.position = 'absolute';\n\t\tthis.container.style.top = 0;\n\t\tthis.container.style.left = 0;\n\t\tthis.container.style.width = '100%';\n\n\t\t(new BX.easing({\n\t\t\tduration: 350,\n\t\t\tstart: {opacity: 0, translateX: 100},\n\t\t\tfinish: {opacity: 100, translateX: 0},\n\t\t\ttransition: BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\tstep: (state) => {\n\t\t\t\tthis.container.style.opacity = state.opacity / 100;\n\t\t\t\tthis.container.style.transform = 'translateX(' + state.translateX + '%)';\n\t\t\t},\n\t\t\tcomplete: () => {\n\t\t\t\tDom.removeClass(this.container, 'catalog-entity-section-tab-content-show');\n\t\t\t\tthis.container.style.cssText = '';\n\n\t\t\t\tEvent.EventEmitter.emit(window, 'onEntityDetailsTabShow', [this]);\n\t\t\t}\n\t\t})).animate();\n\n\t}\n\n\thideTab()\n\t{\n\t\tDom.addClass(this.container, 'catalog-entity-section-tab-content-hide');\n\t\tDom.removeClass(this.container, 'catalog-entity-section-tab-content-show');\n\t\tDom.removeClass(this.menuContainer, 'catalog-entity-section-tab-current');\n\n\t\t(new BX.easing({\n\t\t\tduration: 350,\n\t\t\tstart: {opacity: 100},\n\t\t\tfinish: {opacity: 0},\n\t\t\ttransition: BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\tstep: (state) => {\n\t\t\t\tthis.container.style.opacity = state.opacity / 100;\n\t\t\t},\n\t\t\tcomplete: () => {\n\t\t\t\tthis.container.style.display = 'none';\n\t\t\t\tthis.container.style.transform = 'translateX(100%)';\n\t\t\t\tthis.container.style.opacity = 0;\n\t\t\t}\n\t\t})).animate();\n\t}\n\n\tonMenuClick(event)\n\t{\n\t\tif (this.isEnabled())\n\t\t{\n\t\t\tif (this.loader && !this.loader.isLoaded())\n\t\t\t{\n\t\t\t\tthis.loader.load();\n\t\t\t}\n\n\t\t\tthis.manager.selectItem(this);\n\t\t}\n\n\t\tevent.preventDefault()\n\t}\n}","import {Text, Type} from 'main.core';\nimport Tab from './tab';\nimport {EventEmitter} from \"main.core.events\";\n\nexport default class Manager\n{\n\tconstructor(id, settings)\n\t{\n\t\tthis.id = Type.isStringFilled(id) ? id : Text.getRandom();\n\t\tthis.settings = Type.isObjectLike(settings) ? settings : {};\n\n\t\tthis.container = this.settings.container;\n\t\tthis.menuContainer = this.settings.menuContainer;\n\n\t\tthis.items = [];\n\n\t\tif (Type.isArray(this.settings.data))\n\t\t{\n\t\t\tthis.settings.data.forEach(item => {\n\t\t\t\tthis.items.push(\n\t\t\t\t\tnew Tab(item.id, {\n\t\t\t\t\t\tmanager: this,\n\t\t\t\t\t\tdata: item,\n\t\t\t\t\t\tcontainer: this.container.querySelector('[data-tab-id=\"' + item.id + '\"]'),\n\t\t\t\t\t\tmenuContainer: this.menuContainer.querySelector('[data-tab-id=\"' + item.id + '\"]')\n\t\t\t\t\t})\n\t\t\t\t);\n\t\t\t});\n\t\t}\n\n\t\tEventEmitter.subscribe('BX.Catalog.EntityCard.TabManager:onOpenTab', (event) => {\n\t\t\tlet tabId = event.data.tabId;\n\t\t\tlet item = this.findItemById(tabId);\n\t\t\tif (item)\n\t\t\t{\n\t\t\t\tthis.selectItem(item);\n\t\t\t}\n\t\t});\n\t}\n\n\tfindItemById(id)\n\t{\n\t\treturn this.items.find(item => item.id === id) || null;\n\t}\n\n\tselectItem(item)\n\t{\n\t\tEventEmitter.emit('BX.Catalog.EntityCard.TabManager:onSelectItem', {tabId: item.id});\n\t\tthis.items.forEach(current => current.setActive(current === item));\n\t}\n}\n","import {Dom, Tag, Text, Type} from \"main.core\";\nimport TabManager from \"../tab/manager\";\n\nexport class BaseCard\n{\n\tconstructor(id, settings = {})\n\t{\n\t\tthis.id = Type.isStringFilled(id) ? id : Text.getRandom();\n\t\tthis.entityId = Text.toInteger(settings.entityId) || 0;\n\t\tthis.settings = settings;\n\t\tthis.container = document.getElementById(settings.containerId);\n\n\t\tthis.initializeTabManager();\n\t\tthis.checkFadeOverlay();\n\t}\n\n\tinitializeTabManager()\n\t{\n\t\treturn new TabManager(this.id, {\n\t\t\tcontainer: document.getElementById(this.settings.tabContainerId),\n\t\t\tmenuContainer: document.getElementById(this.settings.tabMenuContainerId),\n\t\t\tdata: this.settings.tabs || []\n\t\t});\n\t}\n\n\tcheckFadeOverlay()\n\t{\n\t\tif (this.entityId <= 0)\n\t\t{\n\t\t\tthis.overlay = Tag.render`<div class=\"catalog-entity-overlay\"></div>`;\n\t\t\tDom.append(this.overlay, this.container);\n\n\t\t\tif (window === window.top)\n\t\t\t{\n\t\t\t\tthis.overlay.style.position = 'absolute';\n\t\t\t\tthis.overlay.style.top = this.overlay.style.left = this.overlay.style.right = '-15px';\n\t\t\t}\n\t\t}\n\t}\n}\n","import {Dom, Event, Loc, Reflection, Tag, Type} from 'main.core';\nimport {type BaseEvent, EventEmitter} from 'main.core.events'\nimport './entity-card.css';\nimport 'ui.entity-editor';\nimport 'ui.notification';\nimport 'ui.feedback.form';\nimport 'ui.hint';\nimport 'ui.design-tokens';\nimport 'ui.fonts.opensans';\nimport FieldsFactory from './fields-factory'\nimport ControllersFactory from './controllers-factory'\nimport IblockFieldConfigurationManager from './field-configurator/iblock-field-configuration-manager'\nimport GridFieldConfigurationManager from './field-configurator/grid-field-configuration-manager';\nimport {Popup} from \"main.popup\";\nimport {BaseCard} from \"./base-card/base-card\";\nimport {Slider} from 'catalog.store-use'\n\nclass EntityCard extends BaseCard\n{\n\tstackWithOffset = null;\n\n\tconstructor(id, settings = {})\n\t{\n\t\tsuper(id, settings);\n\n\t\tthis.cardSettings = settings.cardSettings || [];\n\t\tthis.hiddenFields = settings.hiddenFields || [];\n\t\tthis.feedbackUrl = settings.feedbackUrl || '';\n\t\tthis.variationGridId = settings.variationGridId;\n\t\tthis.productStoreGridId = settings.productStoreGridId || null;\n\t\tthis.settingsButtonId = settings.settingsButtonId;\n\t\tthis.createDocumentButtonId = settings.createDocumentButtonId;\n\t\tthis.createDocumentButtonMenuPopupItems = settings.createDocumentButtonMenuPopupItems;\n\n\t\tthis.componentName = settings.componentName || null;\n\t\tthis.componentSignedParams = settings.componentSignedParams || null;\n\t\tthis.variationGridComponentName = (settings.variationGridComponentName || 'BX.Catalog.VariationGrid') + '.Instance';\n\n\t\tthis.isSimpleProduct = settings.isSimpleProduct || false;\n\t\tthis.isWithOrdersMode = settings.isWithOrdersMode || false;\n\t\tthis.isInventoryManagementUsed = settings.isInventoryManagementUsed || false;\n\n\t\tthis.registerFieldsFactory();\n\t\tthis.registerControllersFactory();\n\t\tthis.registerEvents();\n\t\tthis.bindCardSettingsButton();\n\t\tthis.bindCreateDocumentButtonMenu();\n\n\t\tEventEmitter.subscribe('SidePanel.Slider:onMessage', this.onSliderMessage.bind(this));\n\t\tEventEmitter.subscribe('BX.UI.EntityEditorSection:onLayout', this.onSectionLayout.bind(this));\n\t\tEventEmitter.subscribe('Grid::updated', this.onGridUpdatedHandler.bind(this));\n\t}\n\n\tgetEntityType()\n\t{\n\t\treturn 'Entity';\n\t}\n\n\tgetCardSetting(id: string)\n\t{\n\t\treturn this.cardSettings.filter(item => {\n\t\t\treturn item.id === id;\n\t\t})[0];\n\t}\n\n\tisCardSettingEnabled(id: string)\n\t{\n\t\tconst settingItem = this.getCardSetting(id);\n\n\t\treturn settingItem && settingItem.checked;\n\t}\n\n\tbindCardSettingsButton()\n\t{\n\t\tconst settingsButton = this.getSettingsButton();\n\t\tif (settingsButton)\n\t\t{\n\t\t\tEvent.bind(settingsButton.getContainer(), 'click', this.showCardSettingsPopup.bind(this));\n\t\t}\n\t}\n\n\tgetSettingsButton()\n\t{\n\t\treturn BX.UI.ButtonManager.getByUniqid(this.settingsButtonId);\n\t}\n\n\tregisterFieldsFactory()\n\t{\n\t\treturn new FieldsFactory();\n\t}\n\n\tonGridUpdatedHandler(event: BaseEvent)\n\t{\n\t\tconst [grid] = event.getCompatData();\n\n\t\tif (grid && grid.getId() === this.getVariationGridId())\n\t\t{\n\t\t\tthis.updateSettingsCheckboxState();\n\t\t}\n\t}\n\n\tonSectionLayout()\n\t{\n\n\t}\n\n\tgetProductStoreGridId()\n\t{\n\t\treturn this.productStoreGridId;\n\t}\n\n\tgetProductStoreGridComponent()\n\t{\n\t\treturn Reflection.getClass('BX.Catalog.ProductStoreGridManager.Instance');\n\t}\n\n\treloadProductStoreGrid()\n\t{\n\t\tconst gridComponent = this.getProductStoreGridComponent();\n\t\tif (gridComponent)\n\t\t{\n\t\t\tif (this.getProductStoreGridId() && this.getProductStoreGridId() === gridComponent.getGridId())\n\t\t\t{\n\t\t\t\tgridComponent.reloadGrid();\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * @returns {BX.Catalog.VariationGrid|BX.Catalog.ProductServiceGrid|null}\n\t */\n\tgetVariationGridComponent()\n\t{\n\t\t//return Reflection.getClass('BX.Catalog.VariationGrid.Instance');\n\t\treturn Reflection.getClass(this.variationGridComponentName);\n\t}\n\n\treloadVariationGrid()\n\t{\n\t\tconst gridComponent = this.getVariationGridComponent();\n\t\tif (gridComponent)\n\t\t{\n\t\t\tgridComponent.reloadGrid();\n\t\t}\n\t}\n\n\tgetVariationGridId()\n\t{\n\t\treturn this.variationGridId;\n\t}\n\n\tgetVariationGrid()\n\t{\n\t\tif (!Reflection.getClass('BX.Main.gridManager.getInstanceById'))\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn BX.Main.gridManager.getInstanceById(this.getVariationGridId());\n\t}\n\n\tregisterControllersFactory()\n\t{\n\t\treturn new ControllersFactory();\n\t}\n\n\tregisterEvents()\n\t{\n\t\tEventEmitter.subscribe('BX.UI.EntityConfigurationManager:onInitialize', this.onConfigurationManagerInit.bind(this));\n\t\tEventEmitter.subscribe('BX.UI.EntityEditor:onCancel', this.removeFileHiddenInputs.bind(this));\n\t\tEventEmitter.subscribe('BX.UI.EntityEditor:onInit', this.onEditorInitHandler.bind(this));\n\n\t\tEventEmitter.subscribe('BX.UI.EntityEditorAjax:onSubmit', this.onEditorAjaxSubmit.bind(this));\n\t\tEventEmitter.subscribe('onEntityCreate', this.onEntityCreateHandler.bind(this));\n\t\tEventEmitter.subscribe('onEntityUpdate', this.onEntityUpdateHandler.bind(this));\n\n\t\tEventEmitter.subscribe('onAttachFiles', this.onAttachFilesHandler.bind(this));\n\t\tEventEmitter.subscribe('BX.Main.Popup:onClose', this.onFileEditorCloseHandler.bind(this));\n\n\t\tEventEmitter.subscribe('onAfterVariationGridSave', this.onAfterVariationGridSave.bind(this));\n\t}\n\n\tonAfterVariationGridSave(event: BaseEvent)\n\t{\n\t\tconst data = event.getData();\n\n\t\tif (data.gridId === this.getVariationGridId())\n\t\t{\n\t\t\tthis.reloadProductStoreGrid();\n\t\t}\n\t}\n\n\tonAttachFilesHandler(event: BaseEvent)\n\t{\n\t\tconst editor = this.getEditorInstance();\n\t\tif (!editor)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst [, , uploader] = event.getCompatData();\n\t\tif (uploader && Type.isDomNode(uploader.fileInput))\n\t\t{\n\t\t\tconst parent = uploader.fileInput.closest('[data-cid]');\n\n\t\t\tif (Type.isDomNode(parent))\n\t\t\t{\n\t\t\t\tconst controlName = parent.getAttribute('data-cid');\n\t\t\t\tconst control = editor.getControlByIdRecursive(controlName);\n\n\t\t\t\tif (control)\n\t\t\t\t{\n\t\t\t\t\tcontrol.markAsChanged();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tonFileEditorCloseHandler(event: BaseEvent)\n\t{\n\t\tconst [popup] = event.getCompatData();\n\t\tif (popup && popup.getId() === 'popupFM' && popup.onApplyFlag)\n\t\t{\n\t\t\tthis.showNotification(Loc.getMessage('CATALOG_ENTITY_CARD_FILE_CLOSE_NOTIFICATION_2'), {\n\t\t\t\tid: 'fileCloseNotification',\n\t\t\t\tblinkOnUpdate: false,\n\t\t\t\tautoHideDelay: 5000\n\t\t\t});\n\t\t}\n\t}\n\n\tonEditorInitHandler(event: BaseEvent)\n\t{\n\t\tconst [editor, fields] = event.getCompatData();\n\n\t\tif (editor && !fields.entityId)\n\t\t{\n\t\t\tconst control = editor.getControlByIdRecursive('NAME');\n\n\t\t\tif (control)\n\t\t\t{\n\t\t\t\trequestAnimationFrame(() => {\n\t\t\t\t\tcontrol.focus()\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * @returns {BX.UI.EntityEditor|null}\n\t */\n\tgetEditorInstance()\n\t{\n\t\tif (Reflection.getClass('BX.UI.EntityEditor'))\n\t\t{\n\t\t\treturn BX.UI.EntityEditor.getDefault();\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tonEditorAjaxSubmit(event: BaseEvent)\n\t{\n\t\tconst [fields, response] = event.getCompatData();\n\n\t\tconst title = fields['NAME-CODE'].NAME || '';\n\t\tthis.changePageTitle(title);\n\n\t\tif (response.data)\n\t\t{\n\t\t\tif (Type.isBoolean(response.data.IS_SIMPLE_PRODUCT))\n\t\t\t{\n\t\t\t\tthis.isSimpleProduct = response.data.IS_SIMPLE_PRODUCT;\n\t\t\t}\n\t\t}\n\n\t\tif (response.status === 'success')\n\t\t{\n\t\t\tthis.removeFileHiddenInputs();\n\t\t}\n\t}\n\n\tonEntityCreateHandler(event: BaseEvent)\n\t{\n\t\tconst [data] = event.getCompatData();\n\t\tthis.postSliderMessage('onCreate', data)\n\t}\n\n\tonEntityUpdateHandler(event: BaseEvent)\n\t{\n\t\tconst [data] = event.getCompatData();\n\t\tthis.postSliderMessage('onUpdate', data)\n\t}\n\n\tpostSliderMessage(action, fields)\n\t{\n\t\tBX.SidePanel.Instance.postMessage(\n\t\t\twindow,\n\t\t\t`Catalog.${this.getEntityType()}Card::${action}`,\n\t\t\tfields\n\t\t);\n\t}\n\n\tchangePageTitle(title)\n\t{\n\t\tconst titleNode = document.getElementById('pagetitle');\n\n\t\tif (Type.isDomNode(titleNode))\n\t\t{\n\t\t\ttitleNode.innerText = title;\n\t\t}\n\n\t\tdocument.title = title;\n\n\t\tif (BX.getClass('BX.SidePanel.Instance.updateBrowserTitle'))\n\t\t{\n\t\t\tBX.SidePanel.Instance.updateBrowserTitle();\n\t\t}\n\t}\n\n\tremoveFileHiddenInputs()\n\t{\n\t\tdocument.querySelectorAll('form>input[type=\"hidden\"]')\n\t\t\t.forEach(input => {\n\t\t\t\tlet name = input.getAttribute('name');\n\t\t\t\tlet deleteInput = document.querySelector(`form>input[name=\"${name}_del\"]`);\n\n\t\t\t\tif (deleteInput)\n\t\t\t\t{\n\t\t\t\t\tDom.remove(input);\n\t\t\t\t\tDom.remove(deleteInput);\n\t\t\t\t}\n\t\t\t});\n\t}\n\n\tonConfigurationManagerInit(event: BaseEvent)\n\t{\n\t\tconst [, eventArgs] = event.getCompatData();\n\n\t\tif (!eventArgs.type || eventArgs.type === 'editor')\n\t\t{\n\t\t\teventArgs.configurationFieldManager = this.initializeIblockFieldConfigurationManager(eventArgs);\n\t\t}\n\n\t\tif (eventArgs.id === 'variation_grid')\n\t\t{\n\t\t\teventArgs.configurationFieldManager = this.initializeVariationPropertyConfigurationManager(eventArgs);\n\t\t}\n\n\t\tif (eventArgs.id === 'service_grid')\n\t\t{\n\t\t\teventArgs.configurationFieldManager = this.initializeServicePropertyConfigurationManager(eventArgs);\n\t\t}\n\t}\n\n\tinitializeIblockFieldConfigurationManager(eventArgs)\n\t{\n\t\tconst configurationManager = IblockFieldConfigurationManager.create(this.id, eventArgs);\n\t\tconfigurationManager.setCreationPageUrl(this.settings.creationPropertyUrl);\n\n\t\treturn configurationManager;\n\t}\n\n\tinitializeVariationPropertyConfigurationManager(eventArgs)\n\t{\n\t\tconst configurationManager = GridFieldConfigurationManager.create(this.id, eventArgs);\n\t\tconfigurationManager.setCreationPageUrl(this.settings.creationVariationPropertyUrl);\n\n\t\treturn configurationManager;\n\t}\n\n\tinitializeServicePropertyConfigurationManager(eventArgs)\n\t{\n\t\treturn GridFieldConfigurationManager.create(this.id, eventArgs);\n\t}\n\n\tshowNotification(content, options)\n\t{\n\t\toptions = options || {};\n\n\t\tif (BX.GetWindowScrollPos().scrollTop <= 10)\n\t\t{\n\t\t\toptions.stack = this.getStackWithOffset();\n\t\t}\n\n\t\tBX.UI.Notification.Center.notify({\n\t\t\tcontent: content,\n\t\t\tposition: 'top-right',\n\t\t\twidth: 'auto',\n\t\t\tautoHideDelay: 3000,\n\t\t\t...options\n\t\t});\n\t}\n\n\tgetStackWithOffset()\n\t{\n\t\tif (this.stackWithOffset === null)\n\t\t{\n\t\t\tthis.stackWithOffset = new BX.UI.Notification.Stack(BX.mergeEx(\n\t\t\t\t{},\n\t\t\t\tBX.UI.Notification.Center.getStackDefaults(),\n\t\t\t\t{\n\t\t\t\t\tid: 'top-right-with-offset',\n\t\t\t\t\tposition: 'top-right-with-offset',\n\t\t\t\t\toffsetY: 74\n\t\t\t\t}\n\t\t\t));\n\t\t}\n\n\t\treturn this.stackWithOffset;\n\t}\n\n\topenFeedbackPanel()\n\t{\n\t\tEntityCard.openFeedbackPanelStatic();\n\t}\n\n\tstatic openFeedbackPanelStatic()\n\t{\n\t\tBX.UI.Feedback.Form.open({\n\t\t\tid: 'catalog-product-card-feedback',\n\t\t\tforms: [\n\t\t\t\t{'id': 269, 'lang': 'ru', 'sec': 'mqerov', 'zones': ['ru', 'by', 'kz']},\n\t\t\t\t{'id': 347, 'lang': 'en', 'sec': 'lxfji8', 'zones': ['en']},\n\t\t\t\t{'id': 349, 'lang': 'es', 'sec': 'gdf9i1', 'zones': ['es']},\n\t\t\t\t{'id': 355, 'lang': 'de', 'sec': 'x8k56n', 'zones': ['de']},\n\t\t\t\t{'id': 357, 'lang': 'ua', 'sec': '2z19xl', 'zones': ['ua']},\n\t\t\t\t{'id': 353, 'lang': 'com.br', 'sec': '5cleqn', 'zones': ['com.br']},\n\t\t\t],\n\t\t});\n\t}\n\n\tbindCreateDocumentButtonMenu()\n\t{\n\t\tconst createDocumentButtonMenu = this.getCreateDocumentButtonMenu();\n\t\tif (createDocumentButtonMenu)\n\t\t{\n\t\t\tEvent.bind(createDocumentButtonMenu.getContainer(), 'click', this.showCreateDocumentPopup.bind(this));\n\t\t}\n\t}\n\n\tgetCreateDocumentButtonMenu()\n\t{\n\t\tconst createDocumentButton = BX.UI.ButtonManager.getByUniqid(this.createDocumentButtonId);\n\t\tif (createDocumentButton)\n\t\t{\n\t\t\treturn BX.UI.ButtonManager.getByUniqid(this.createDocumentButtonId).getMenuButton();\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tgetCreateDocumentPopup()\n\t{\n\t\tif (!this.createDocumentPopup)\n\t\t{\n\t\t\tthis.createDocumentPopup = new Popup(\n\t\t\t\tthis.id + '-create-document',\n\t\t\t\tthis.getCreateDocumentButtonMenu().getContainer(),\n\t\t\t\t{\n\t\t\t\t\tautoHide: true,\n\t\t\t\t\tdraggable: false,\n\t\t\t\t\toffsetLeft: 0,\n\t\t\t\t\toffsetTop: 0,\n\t\t\t\t\tangle: {position: 'top', offset: 43},\n\t\t\t\t\tnoAllPaddings: true,\n\t\t\t\t\tbindOptions: {forceBindPosition: true},\n\t\t\t\t\tcloseByEsc: true,\n\t\t\t\t\tcontent: this.getCreateDocumentMenuContent()\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\treturn this.createDocumentPopup;\n\t}\n\n\tshowCreateDocumentPopup()\n\t{\n\t\tthis.getCreateDocumentPopup().show();\n\t}\n\n\tgetCreateDocumentMenuContent()\n\t{\n\t\tconst popupWrapper = Tag.render`<div class=\"menu-popup\"></div>`;\n\t\tconst popupItemsContainer = Tag.render`<div class=\"menu-popup-items\"></div>`;\n\t\tpopupWrapper.appendChild(popupItemsContainer);\n\n\t\tthis.createDocumentButtonMenuPopupItems.forEach((item) => {\n\t\t\tpopupItemsContainer.appendChild(Tag.render`\n\t\t\t\t<a class=\"menu-popup-item menu-popup-item-no-icon\" href=\"${item.link}\">\n\t\t\t\t\t<span class=\"menu-popup-item-text\">${item.text}</span>\n\t\t\t\t</a>\n\t\t\t`);\n\t\t});\n\n\t\treturn popupWrapper;\n\t}\n\n\tgetCardSettingsPopup()\n\t{\n\t\tif (!this.settingsPopup)\n\t\t{\n\t\t\tthis.settingsPopup = new Popup(\n\t\t\t\tthis.id,\n\t\t\t\tthis.getSettingsButton().getContainer(),\n\t\t\t\t{\n\t\t\t\t\tautoHide: true,\n\t\t\t\t\tdraggable: false,\n\t\t\t\t\toffsetLeft: 0,\n\t\t\t\t\toffsetTop: 0,\n\t\t\t\t\tangle: {position: 'top', offset: 43},\n\t\t\t\t\tnoAllPaddings: true,\n\t\t\t\t\tbindOptions: {forceBindPosition: true},\n\t\t\t\t\tcloseByEsc: true,\n\t\t\t\t\tcontent: this.prepareCardSettingsContent()\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\treturn this.settingsPopup;\n\t}\n\n\tshowCardSettingsPopup()\n\t{\n\t\tthis.getCardSettingsPopup().show();\n\t}\n\n\tprepareCardSettingsContent()\n\t{\n\t\tconst content = Tag.render`\n\t\t\t<div class='ui-entity-editor-popup-create-field-list'></div>\n\t\t`;\n\n\t\tthis.cardSettings.map(item => {\n\t\t\tcontent.append(this.getSettingItem(item));\n\t\t});\n\n\t\treturn content;\n\t}\n\n\tgetSettingItem(item)\n\t{\n\t\tlet input = '';\n\t\tif (!item.disabledCheckbox)\n\t\t{\n\t\t\tinput = Tag.render`\n\t\t\t\t<input type=\"checkbox\">\n\t\t\t`;\n\n\t\t\tinput.checked = item.checked;\n\t\t\tinput.disabled = item.disabled ?? false;\n\t\t\tinput.dataset.settingId = item.id;\n\t\t}\n\n\t\tconst hintNode = (\n\t\t\tType.isStringFilled(item.hint)\n\t\t\t\t? Tag.render`<span class=\"catalog-entity-setting-hint\" data-hint=\"${item.hint}\"></span>`\n\t\t\t\t: ''\n\t\t);\n\n\t\tconst setting = Tag.render`\n\t\t\t\t<label class=\"ui-ctl-block ui-entity-editor-popup-create-field-item ui-ctl-w100\">\n\t\t\t\t\t<div class=\"ui-ctl-w10\" style=\"text-align: center\">${input}</div>\n\t\t\t\t\t<div class=\"ui-ctl-w75\">\n\t\t\t\t\t\t<span class=\"ui-entity-editor-popup-create-field-item-title ${item.disabled ? 'catalog-entity-disabled-setting' : ''}\">${item.title}${hintNode}</span>\n\t\t\t\t\t\t<span class=\"ui-entity-editor-popup-create-field-item-desc\">${item.desc}</span>\n\t\t\t\t\t</div>\n\t\t\t\t</label>\n\t\t\t`;\n\n\t\tBX.UI.Hint.init(setting);\n\n\t\tif(item.id === 'SLIDER')\n\t\t{\n\t\t\tEvent.bind(setting, 'change', (event) =>\n\t\t\t{\n\t\t\t\tnew Slider().open(item.url, {})\n\t\t\t\t.then(() => {\n\t\t\t\t\tthis.reloadGrid();\n\t\t\t\t\tthis.getCardSettingsPopup().close();\n\t\t\t\t});\n\t\t\t})\n\t\t}\n\t\telse if(item.id === 'SEO')\n\t\t{\n\t\t\tEvent.bind(setting, 'click', (event) =>\n\t\t\t{\n\t\t\t\tBX.SidePanel.Instance.open(item.url, {\n\t\t\t\t\tcacheable: false,\n\t\t\t\t\tallowChangeHistory: false,\n\t\t\t\t\tdata: {\n\t\t\t\t\t\t'ELEMENT_ID': this.entityId\n\t\t\t\t\t},\n\t\t\t\t\twidth: 1000\n\t\t\t\t});\n\t\t\t})\n\t\t}\n\t\telse\n\t\t{\n\t\t\tEvent.bind(setting, 'change', this.setProductCardSetting.bind(this));\n\t\t}\n\n\n\t\treturn setting;\n\t}\n\n\tsetProductCardSetting(event: BaseEvent)\n\t{\n\t\tconst settingItem = this.getCardSetting(event.target.dataset.settingId);\n\t\tif (!settingItem)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst settingEnabled = event.target.checked;\n\n\t\tif (settingItem.action === 'grid')\n\t\t{\n\t\t\tthis.requestGridSettings(settingItem, settingEnabled);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.requestCardSettings(settingItem, settingEnabled);\n\t\t}\n\t}\n\n\tonSliderMessage(event: BaseEvent)\n\t{\n\t\tconst [sliderEvent] = event.getCompatData();\n\n\t\tif (\n\t\t\tsliderEvent.getEventId() === 'Catalog.VariationCard::onCreate'\n\t\t\t|| sliderEvent.getEventId() === 'Catalog.VariationCard::onUpdate'\n\t\t)\n\t\t{\n\t\t\tthis.reloadVariationGrid();\n\t\t}\n\t}\n\n\treloadGrid()\n\t{\n\t\tdocument.location.reload();\n\t}\n\n\trequestGridSettings(setting, enabled)\n\t{\n\t\tif (!this.getVariationGrid())\n\t\t{\n\t\t\tnew Error('Cant find variation grid.');\n\t\t}\n\n\t\tconst headers = [];\n\t\tconst cells = this.getVariationGrid().getRows().getHeadFirstChild().getCells();\n\n\t\tArray.from(cells).forEach((header) => {\n\t\t\tif ('name' in header.dataset)\n\t\t\t{\n\t\t\t\theaders.push(header.dataset.name);\n\t\t\t}\n\t\t});\n\n\t\tBX.ajax.runComponentAction(\n\t\t\tthis.componentName,\n\t\t\t'setGridSetting',\n\t\t\t{\n\t\t\t\tmode: 'class',\n\t\t\t\tdata: {\n\t\t\t\t\tsignedParameters: this.componentSignedParams,\n\t\t\t\t\tsettingId: setting.id,\n\t\t\t\t\tselected: enabled,\n\t\t\t\t\tcurrentHeaders: headers\n\t\t\t\t}\n\t\t\t}\n\t\t).then(() => {\n\t\t\tlet message = null;\n\t\t\tsetting.checked = enabled;\n\t\t\tthis.reloadVariationGrid();\n\t\t\tthis.postSliderMessage('onUpdate', {});\n\t\t\tthis.getCardSettingsPopup().close();\n\n\t\t\tif(setting.id === 'WAREHOUSE')\n\t\t\t{\n\t\t\t\tthis.reloadGrid()\n\t\t\t\tmessage = enabled ? Loc.getMessage('CATALOG_ENTITY_CARD_WAREHOUSE_ENABLED') : Loc.getMessage('CATALOG_ENTITY_CARD_WAREHOUSE_DISABLED');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tmessage = enabled ? Loc.getMessage('CATALOG_ENTITY_CARD_SETTING_ENABLED') : Loc.getMessage('CATALOG_ENTITY_CARD_SETTING_DISABLED');\n\t\t\t\tmessage = message.replace('#NAME#', setting.title)\n\t\t\t}\n\n\t\t\tthis.showNotification(message, {\n\t\t\t\tcategory: 'popup-settings'\n\t\t\t});\n\t\t});\n\t}\n\n\trequestCardSettings(setting, enabled)\n\t{\n\t\tBX.ajax.runComponentAction(\n\t\t\tthis.componentName,\n\t\t\t'setCardSetting',\n\t\t\t{\n\t\t\t\tmode: 'class',\n\t\t\t\tdata: {\n\t\t\t\t\tsignedParameters: this.componentSignedParams,\n\t\t\t\t\tsettingId: setting.id,\n\t\t\t\t\tselected: enabled\n\t\t\t\t}\n\t\t\t}\n\t\t).then(() => {\n\t\t\tsetting.checked = enabled;\n\n\t\t\tif (setting.id === 'CATALOG_PARAMETERS')\n\t\t\t{\n\t\t\t\tconst section = this.getEditorInstance().getControlByIdRecursive('catalog_parameters');\n\t\t\t\tif (section)\n\t\t\t\t{\n\t\t\t\t\tsection.refreshLayout();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.getCardSettingsPopup().close();\n\n\t\t\tlet message = enabled ? Loc.getMessage('CATALOG_ENTITY_CARD_SETTING_ENABLED') : Loc.getMessage('CATALOG_ENTITY_CARD_SETTING_DISABLED');\n\t\t\tthis.showNotification(message.replace('#NAME#', setting.title), {\n\t\t\t\tcategory: 'popup-settings'\n\t\t\t});\n\t\t});\n\t}\n\n\tupdateSettingsCheckboxState()\n\t{\n\t\tconst popupContainer = this.getCardSettingsPopup().getContentContainer();\n\n\t\tthis.cardSettings\n\t\t\t.filter(item => item.action === 'grid' && Type.isArray(item.columns?.ITEMS))\n\t\t\t.forEach(item => {\n\n\t\t\t\tlet allColumnsExist = true;\n\t\t\t\titem.columns.ITEMS.forEach(columnName => {\n\t\t\t\t\tif (!this.getVariationGrid().getColumnHeaderCellByName(columnName))\n\t\t\t\t\t{\n\t\t\t\t\t\tallColumnsExist = false;\n\t\t\t\t\t}\n\t\t\t\t})\n\n\t\t\t\tconst checkbox = popupContainer.querySelector('input[data-setting-id=\"' + item.id + '\"]');\n\t\t\t\tif (Type.isDomNode(checkbox))\n\t\t\t\t{\n\t\t\t\t\tcheckbox.checked = allColumnsExist;\n\t\t\t\t}\n\t\t\t});\n\t}\n}\n\nexport {EntityCard, BaseCard};\n"],"names":["IblockSectionField","_BX$UI$EntityEditorFi","babelHelpers","inherits","id","settings","_this","classCallCheck","possibleConstructorReturn","getPrototypeOf","call","initialize","innerWrapper","createClass","key","value","getContentWrapper","layout","options","arguments","length","undefined","_hasLayout","ensureWrapperCreated","classNames","adjustWrapper","isNeedToDisplay","_wrapper","appendChild","createTitleNode","getTitle","_mode","BX","UI","EntityEditorMode","edit","drawEditMode","drawViewMode","isContextMenuEnabled","createContextMenuButton","registerLayout","defaultInput","Tag","render","_templateObject","taggedTemplateLiteral","getName","_templateObject2","ajax","runComponentAction","mode","data","iblockId","getIblockId","productId","getProductId","selectedSectionIds","getValue","then","renderFromResponse","bind","response","Error","errors","join","Runtime","html","callback","initEntitySelector","EventEmitter","subscribe","GLOBAL_TARGET","markAsChanged","changeDisplay","node","isShow","style","display","event","get","prototype","emit","getEditor","concat","toConsumableArray","getData","hasNoSections","_templateObject3","Loc","getMessage","Dom","addClass","content","getSections","forEach","section","picture","Type","isStringFilled","PICTURE","_templateObject4","Text","encode","push","_templateObject5","NAME","_templateObject6","_model","getField","sectionIds","includes","doClearLayout","clean","getModeSwitchType","result","EntityEditorModeSwitchType","common","button","EntityEditorField","_creatLabelForEditMode","WeakSet","_onInputHandler","_getHintNode","_onCodeStateButtonClick","NameCodeField","_BX$UI$EntityEditorMu","_classPrivateMethodInitSpec","assertThisInitialized","defineProperty","EntityEditorBoolean","superclass","apply","menuItems","isShownSymbolicCode","text","getSchemeShowCodeState","allowToGenerateCode","_editor","isNew","prop","getSchemeElement","_options","setSchemeShowCodeState","state","processContextMenuCommand","e","command","codeContainerElement","document","getElementById","nameCodeMarkerElement","codeTextElement","codeStateButtonElement","readOnly","className","removeClass","_innerWrapper","refreshLayout","_parent","processChildControlSchemeChange","createTitleMarker","view","title","values","_inputValue","isDragEnabled","append","createDragButton","_inputContainer","valueKey","createSingleInput","getViewInnerLayout","initializeDragDropAbilities","validate","isEditable","clearError","hasValidators","executeValidators","isEmptyField","nameTextElement","util","trim","parentNode","isValid","isRequired","addError","EntityValidationError","create","field","showRequiredFieldError","_input","showError","error","anchor","_errorContainer","innerHTML","htmlspecialchars","_hasError","name","inputWrapper","toLowerCase","inputContainer","_templateObject7","input","getLineCount","_templateObject8","_templateObject9","Event","_classPrivateMethodGet","_onInputHandler2","attr","chainState","_templateObject10","_onCodeStateButtonClick2","label","_creatLabelForEditMode2","textValue","_templateObject11","_templateObject12","_templateObject13","_templateObject14","codeValue","CODE","chainClass","_templateObject15","EntityEditorMultiText","_templateObject16","labelText","_templateObject17","_getHintNode2","_templateObject18","_changeHandler","translit","Hint","createNode","newValue","FieldsFactory","_event$getCompatData","getCompatData","_event$getCompatData2","slicedToArray","eventArgs","methods","factory","type","controlId","PROPERTY_PREFIX","PROPERTY_BLOCK_NAME","IblockSectionController","_BX$UI$EntityEditorCo","handleChange","isRequesting","clearServiceFields","onChangeHandler","lastDataHash","initialElements","deletedControls","deletedAvailableSchemes","_this2","newData","shift","newDataHash","JSON","stringify","clearTimeout","timeout","setTimeout","refreshLinkedProperties","_this3","_settings","ajaxData","COMPONENT_NAME","signedParameters","SIGNED_PARAMETERS","allCurrentProperties","getAllCurrentProperties","ENTITY_FIELDS","property","addProperty","forceDisplay","newProperties","map","el","removeProperty","commitSchemeChanges","activeProperties","getAllControls","filter","indexOf","hiddenProperties","getAvailableSchemeElements","restoreDeletedProperty","restoreDeletedAvailableProperty","createProperty","control","getParent","addChild","_objectSpread","enableSaving","registerActiveControl","unregisterActiveControl","schemeElement","addAvailableSchemeElement","propertyBlockScheme","getSchemeElementByName","EntitySchemeElement","_elements","createControl","getType","model","parent","propertyBlockControl","getControlById","getControlByIdRecursive","removeChild","removeAvailableSchemeElement","getAvailableSchemeElementByName","rollback","_this4","element","EntityEditorController","_onFileIsAddedHandler","_onFileIsDeletedHandler","_showFileNotification","_getSupportedAjaxFields","GridStore","gridId","_onFileIsAddedHandler2","_onFileIsDeletedHandler2","getGrid","Main","gridManager","getInstanceById","saveEditedRows","editedRowsIndexes","getRows","getBodyChild","row","isEdit","getNode","rowIndex","loadEditedRows","rows","index","getByIndex","fireEvent","getEditedRowsFields","fillCellValue","editData","isPlainObject","TYPE","isArray","item","RAW_NAME","VALUE","console","_value$VALUE","headRow","getHeadFirstChild","supportedAjaxFields","_getSupportedAjaxFields2","Array","getCells","cell","cellName","getCellNameByCellIndex","cellValues","getCellEditorValue","cellEditData","getCellEditDataByCellIndex","getId","file","isFileUploaded","File","uploader","isDomNode","fileInput","isFileUploaderInGrid","getContainer","contains","_showFileNotification2","Notification","Center","notify","blinkOnUpdate","position","width","autoHideDelay","params","getParam","VariationGridController","doInitialize","markAsChangedHandler","checkEditorToolbar","onGridUpdated","onBeforeGridRequest","ajaxSuccessHandler","onBeforeIncludedAreaLoaded","onAfterIncludedAreaLoaded","onNothingChanged","subscribeToFormSubmit","gridStore","getGridId","isNumber","areaHeight","getVariationGridLoader","getGridControl","wrapper","getWrapper","querySelector","unsubscribeGridEvents","destroy","onAfterSave","isChanged","setGridControlCache","_loadedHtml","onBeforeSubmit","getVariationGridComponent","Reflection","getClass","_this$getGrid","_this$getGrid$getSett","gridComponent","popup","getSettingsWindow","getPopup","unsubscribeAll","xhrData","url","getReloadUrl","_ajaxForm","onBeforeSubmitForm","_isChanged","getActiveControlCount","showToolPanel","hideToolPanel","_toolPanel","clearErrors","_event$getCompatData3","_event$getCompatData4","grid","_event$getCompatData5","_event$getCompatData6","Uri","getQueryParams","Object","hasOwnProperty","setQueryParam","toString","sessid","bitrix_sessid","method","getSignedParameters","getConfigStringParam","_event$getCompatData7","_event$getCompatData8","skuGridName","skuGridData","getEditSelectedValues","copyItemsMap","priceField","newName","replace","endsWith","isFile","fieldName","newFilesRegExp","RegExp","test","fileCounter","fileSetting","_fieldName$match","match","_fieldName$match2","isNil","offsetHeight","VariationLinkController","GoogleMapController","EmployeeController","UserController","IblockElementController","BindingToCrmElementController","FieldConfiguratorController","handleFieldAdd","handleFieldUpdate","fieldAddHandler","fieldUpdateHandler","fields","getFieldsForm","PROPERTY_FIELDS","additionalValues","ADDITIONAL_VALUES","_i","_Object$entries","entries","_Object$entries$_i","setField","EntityEditorSection","getMode","notifyIfNotDisplayed","showAlways","toggleOptionFlag","saveSchemeChanges","EntityEditorControl","currentField","_isRequired","mandatory","_response$data","EntityEditorDatetime","EntityEditorMultiDatetime","schemeElementData","propertyData","enableTime","dateViewFormat","EntityEditorCustom","newType","multiple","EntityEditorText","EntityEditorList","EntityEditorNumber","EntityEditorMultiList","EntityEditorMultiNumber","getChildIndex","newControl","_schemeElement","form","FormData","formatted","MULTIPLE","IS_REQUIRED","IS_PUBLIC","isPublic","PROPERTY_TYPE","typeId","enumeration","enumItem","getFormFieldName","SORT","ID","USER_TYPE","XML_ID","FILE_ID","LIST_TYPE","userType","_i2","_Object$entries2","_Object$entries2$_i","sectionName","sectionSchemeElement","sectionControl","ProductServiceGridController","getProductServiceGridLoader","ControllersFactory","IblockDirectoryFieldItem","_BX$UI$EntityEditorUs","_babelHelpers$getProt","_len","args","_key","_fileInput","getString","_data","onFileLoaderChange","link","_labelInput","message","deleteButton","onDeleteButtonClick","getElementNode","_container","insertBefore","target","files","reader","FileReader","onload","src","fileChanged","readAsDataURL","classList","remove","isFileChanged","prepareData","fileValue","xmlId","isNotEmptyString","self","EntityEditorUserFieldListItem","IblockFieldConfigurator","_enumItems","layoutInternal","getInputContainer","_typeId","_this$_field","_field","getEnumerationContainer","getOptionContainer","getErrorContainer","getButtonContainer","_optionWrapper","_isTimeEnabledCheckBox","getIsTimeEnabledCheckBox","_enableMandatoryControl","_isRequiredCheckBox","getIsRequiredCheckBox","isAllowedMultipleCheckBox","_isMultipleCheckBox","getMultipleCheckBox","_isPublic","getIsPublicCheckBox","_showAlwaysCheckBox","createOption","caption","helpUrl","helpCode","checked","getBoolean","checkOptionFlag","EntityEditorControlOptions","isAllowedShowAlwaysCheckBox","closest","_this$_field2","_this$_field2$getSche","_this$_field3","_this$_field3$getSche","_this$_field3$getSche2","_this$_field4","_this$_field4$getSche","_this$_field4$getSche2","isEnabledOfferTree","isMultiple","getInputTitle","manager","getUserFieldManager","getDefaultFieldLabel","enumWrapper","_enumItemContainer","addButton","onEnumerationItemAddButtonClick","getItems","enumFields","createEnumerationItem","IMAGE","IMAGE_SRC","TEXT","lastItem","_draggable","DragAndDrop","Draggable","container","draggable","dragElement","CLONE","focus","initItemClickHandlers","unbindItemClickHandlers","bindLastItemClickHandler","onEnumerationItemClick","unbindAll","bindOnce","configurator","removeEnumerationItem","i","clearLayout","splice","prepareSaveParams","hashes","enumData","hash","hashCode","in_array","getRandom","sortIndex","getElementIndex","getDraggableContainer","toNumber","_this$_field5","_this$_field5$getSche","_this$_field5$getSche2","checkBox","EntityEditorMultiMoney","onSaveButtonClick","_this$_field6","_this$_field6$getSche","_isLocked","_mandatoryConfigurator","acceptChanges","close","mergeSettings","modes","htmlListName","htmlList","getObject","getModel","newHtml","SINGLE","htmlName","setInitFieldValue","setDataParam","onCustomEvent","labelSettings","props","containerSettings","alignItems","elements","getButton","prepareLayout","isCustomized","setSwitchCheckBox","setLabel","nextSibling","setEnabled","adjust","isTimeEnabled","EntityEditorFieldConfigurator","namespace","IblockFieldConfigurationManager","_BX$UI$EntityConfigur","createFieldConfigurator","getSimpleFieldConfigurator","setVisible","_fieldConfigurator","editor","mandatoryConfigurator","EntityUserFieldType","string","isCreationEnabled","_this$_editor","_this$_editor2","isSectionEditEnabled","isReadOnly","getCreationPageUrl","creationPageUrl","openCreationPageUrl","SidePanel","Instance","open","allowChangeHistory","cacheable","setCreationPageUrl","getTypeInfos","items","legend","EntityConfigurationManager","GridFieldConfigurator","appendEnumerationSettings","initItemFocusHandlers","unbindItemFocusHandlers","bindLastItemFocusHandler","onEnumerationItemFocus","GridFieldConfigurationManager","child","isSelectionEnabled","hasExternalForm","filtered","openCreationPageSlider","LazyLoader","isObjectLike","serviceUrl","tabId","componentData","isRequestRunning","loaded","isLoaded","load","startRequest","dataType","onsuccess","onRequestSuccess","onfailure","onRequestFailure","Tab","menuContainer","active","isBoolean","enabled","onMenuClick","loader","isEnabled","isActive","setActive","showTab","hideTab","top","left","easing","duration","start","opacity","translateX","finish","transition","makeEaseOut","transitions","quart","step","transform","complete","cssText","window","animate","selectItem","preventDefault","Manager","findItemById","find","current","BaseCard","entityId","toInteger","containerId","initializeTabManager","checkFadeOverlay","TabManager","tabContainerId","tabMenuContainerId","tabs","overlay","right","EntityCard","_BaseCard","cardSettings","hiddenFields","feedbackUrl","variationGridId","productStoreGridId","settingsButtonId","createDocumentButtonId","createDocumentButtonMenuPopupItems","componentName","componentSignedParams","variationGridComponentName","isSimpleProduct","isWithOrdersMode","isInventoryManagementUsed","registerFieldsFactory","registerControllersFactory","registerEvents","bindCardSettingsButton","bindCreateDocumentButtonMenu","onSliderMessage","onSectionLayout","onGridUpdatedHandler","getEntityType","getCardSetting","isCardSettingEnabled","settingItem","settingsButton","getSettingsButton","showCardSettingsPopup","ButtonManager","getByUniqid","getVariationGridId","updateSettingsCheckboxState","getProductStoreGridId","getProductStoreGridComponent","reloadProductStoreGrid","reloadGrid","reloadVariationGrid","getVariationGrid","onConfigurationManagerInit","removeFileHiddenInputs","onEditorInitHandler","onEditorAjaxSubmit","onEntityCreateHandler","onEntityUpdateHandler","onAttachFilesHandler","onFileEditorCloseHandler","onAfterVariationGridSave","getEditorInstance","controlName","getAttribute","onApplyFlag","showNotification","requestAnimationFrame","EntityEditor","getDefault","_event$getCompatData9","_event$getCompatData10","changePageTitle","IS_SIMPLE_PRODUCT","status","_event$getCompatData11","_event$getCompatData12","postSliderMessage","_event$getCompatData13","_event$getCompatData14","action","postMessage","titleNode","innerText","updateBrowserTitle","querySelectorAll","deleteInput","_event$getCompatData15","_event$getCompatData16","configurationFieldManager","initializeIblockFieldConfigurationManager","initializeVariationPropertyConfigurationManager","initializeServicePropertyConfigurationManager","configurationManager","creationPropertyUrl","creationVariationPropertyUrl","GetWindowScrollPos","scrollTop","stack","getStackWithOffset","stackWithOffset","Stack","mergeEx","getStackDefaults","offsetY","openFeedbackPanel","openFeedbackPanelStatic","createDocumentButtonMenu","getCreateDocumentButtonMenu","showCreateDocumentPopup","createDocumentButton","getMenuButton","getCreateDocumentPopup","createDocumentPopup","Popup","autoHide","offsetLeft","offsetTop","angle","offset","noAllPaddings","bindOptions","forceBindPosition","closeByEsc","getCreateDocumentMenuContent","show","popupWrapper","popupItemsContainer","getCardSettingsPopup","settingsPopup","prepareCardSettingsContent","getSettingItem","disabledCheckbox","_item$disabled","disabled","dataset","settingId","hintNode","hint","setting","desc","init","Slider","setProductCardSetting","settingEnabled","requestGridSettings","requestCardSettings","_event$getCompatData17","_event$getCompatData18","sliderEvent","getEventId","location","reload","headers","cells","from","header","selected","currentHeaders","category","_this5","_this6","popupContainer","getContentContainer","_item$columns","columns","ITEMS","allColumnsExist","columnName","getColumnHeaderCellByName","checkbox","Feedback","Form","forms"],"mappings":"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"}