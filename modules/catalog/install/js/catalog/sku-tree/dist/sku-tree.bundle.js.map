{"version":3,"file":"sku-tree.bundle.js","sources":["../src/sku-property.js","../src/sku-tree.js"],"sourcesContent":["import {Dom, Tag, Text, Type} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport {SkuTree} from 'catalog.sku-tree';\n\nexport default class SkuProperty\n{\n\tparent: ?SkuTree;\n\n\tskuSelectHandler = this.handleSkuSelect.bind(this);\n\n\tconstructor(options)\n\t{\n\t\tthis.parent = options.parent || null;\n\t\tif (!this.parent)\n\t\t{\n\t\t\tthrow new Error('Parent is not defined.');\n\t\t}\n\n\t\tthis.property = options.property || {};\n\t\tthis.offers = options.offers || [];\n\t\tthis.existingValues = options.existingValues || [];\n\t\tthis.nodeDescriptions = [];\n\t\tthis.hideUnselected = options.hideUnselected;\n\t}\n\n\tgetId()\n\t{\n\t\treturn this.property.ID;\n\t}\n\n\tgetSelectedSkuId()\n\t{\n\t\treturn this.parent.getSelectedSku().ID;\n\t}\n\n\thasSkuValues()\n\t{\n\t\treturn this.property.VALUES.length;\n\t}\n\n\trenderPictureSku(propertyValue, uniqueId)\n\t{\n\t\tconst propertyName = Type.isStringFilled(propertyValue.NAME) ? Text.encode(propertyValue.NAME) : '';\n\n\t\tlet nameNode = '';\n\t\tif (Type.isStringFilled(propertyName))\n\t\t{\n\t\t\tnameNode = Tag.render`<span class=\"ui-ctl-label-text\">${propertyName}</span>`;\n\t\t}\n\n\t\tlet iconNode = '';\n\t\tif (propertyValue.PICT && propertyValue.PICT.SRC)\n\t\t{\n\t\t\tlet style = \"background-image: url('\" + propertyValue.PICT.SRC + \"');\";\n\t\t\ticonNode = Tag.render`<span class=\"ui-ctl-label-img\" style=\"${style}\"></span>`;\n\t\t}\n\t\telse if (nameNode)\n\t\t{\n\t\t\tnameNode.style.paddingLeft = '0';\n\t\t}\n\t\telse\n\t\t{\n\t\t\tnameNode = Tag.render`<span class=\"ui-ctl-label-text\">-</span>`;\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<label \tclass=\"ui-ctl ui-ctl-radio-selector\"\n\t\t\t\t\tonclick=\"${this.skuSelectHandler}\"\n\t\t\t\t\ttitle=\"${propertyName}\"\n\t\t\t\t\tdata-property-id=\"${this.getId()}\"\n\t\t\t\t\tdata-property-value=\"${propertyValue.ID}\">\n\t\t\t\t<input type=\"radio\"\n\t\t\t\t\tdisabled=\"${!this.parent.isSelectable()}\"\n\t\t\t\t\tname=\"property-${this.getSelectedSkuId()}-${this.getId()}-${uniqueId}\"\n\t\t\t\t\tclass=\"ui-ctl-element\">\n\t\t\t\t<span class=\"ui-ctl-inner\">\n\t\t\t\t\t${iconNode}\n\t\t\t\t\t${nameNode}\n\t\t\t\t</span>\n\t\t\t</label>\n\t\t`;\n\t}\n\n\trenderTextSku(propertyValue, uniqueId)\n\t{\n\t\tconst propertyName = Type.isStringFilled(propertyValue.NAME) ? Text.encode(propertyValue.NAME) : '-';\n\n\t\treturn Tag.render`\n\t\t\t<label \tclass=\"ui-ctl ui-ctl-radio-selector\"\n\t\t\t\t\tonclick=\"${this.skuSelectHandler}\"\n\t\t\t\t\ttitle=\"${propertyName}\"\n\t\t\t\t\tdata-property-id=\"${this.getId()}\"\n\t\t\t\t\tdata-property-value=\"${propertyValue.ID}\">\n\t\t\t\t<input type=\"radio\"\n\t\t\t\t\tdisabled=\"${!this.parent.isSelectable()}\"\n\t\t\t\t\tname=\"property-${this.getSelectedSkuId()}-${this.getId()}-${uniqueId}\"\n\t\t\t\t\tclass=\"ui-ctl-element\">\n\t\t\t\t<span class=\"ui-ctl-inner\">\n\t\t\t\t\t<span class=\"ui-ctl-label-text\">${propertyName}</span>\n\t\t\t\t</span>\n\t\t\t</label>\n\t\t`;\n\t}\n\n\tlayout()\n\t{\n\t\tif (!this.hasSkuValues())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.skuList = this.renderProperties();\n\t\tthis.toggleSkuPropertyValues();\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"product-item-detail-info-container\">\n\t\t\t\t<div class=\"product-item-detail-info-container-title\">${Text.encode(this.property.NAME)}</div>\n\t\t\t\t<div class=\"product-item-scu-container\">\n\t\t\t\t\t${this.skuList}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\trenderProperties()\n\t{\n\t\tconst skuList = Tag.render`<div class=\"product-item-scu-list ui-ctl-spacing-right\"></div>`;\n\n\t\tthis.property.VALUES.forEach((propertyValue) => {\n\t\t\tlet propertyValueId = propertyValue.ID;\n\t\t\tlet node;\n\t\t\tlet uniqueId = Text.getRandom();\n\n\t\t\tif (!propertyValueId || this.existingValues.includes(propertyValueId))\n\t\t\t{\n\t\t\t\tif (this.property.SHOW_MODE === 'PICT')\n\t\t\t\t{\n\t\t\t\t\tnode = this.renderPictureSku(propertyValue, uniqueId);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tnode = this.renderTextSku(propertyValue, uniqueId);\n\t\t\t\t}\n\n\t\t\t\tthis.nodeDescriptions.push({propertyValueId, node});\n\t\t\t\tskuList.appendChild(node);\n\t\t\t}\n\t\t});\n\n\t\treturn skuList;\n\t}\n\n\ttoggleSkuPropertyValues()\n\t{\n\t\tconst selectedSkuProperty = this.parent.getSelectedSkuProperty(this.getId());\n\t\tconst activeSkuProperties = this.parent.getActiveSkuProperties(this.getId());\n\n\t\tthis.nodeDescriptions.forEach((item) => {\n\t\t\tlet id = Text.toNumber(item.propertyValueId);\n\t\t\tlet input = item.node.querySelector('input[type=\"radio\"]');\n\n\t\t\tif (selectedSkuProperty === id)\n\t\t\t{\n\t\t\t\tinput.checked = true;\n\t\t\t\tDom.addClass(item.node, 'selected');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tinput.checked = false;\n\t\t\t\tDom.removeClass(item.node, 'selected');\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\t(this.hideUnselected && selectedSkuProperty !== id)\n\t\t\t\t|| !activeSkuProperties.includes(id)\n\t\t\t)\n\t\t\t{\n\t\t\t\tDom.style(item.node, {display: 'none'});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tDom.style(item.node, {display: null});\n\t\t\t}\n\t\t});\n\t}\n\n\thandleSkuSelect(event)\n\t{\n\t\tevent.stopPropagation();\n\n\t\tconst selectedSkuProperty = event.target.closest('[data-property-id]');\n\t\tif (!this.parent.isSelectable() || Dom.hasClass(selectedSkuProperty, 'selected'))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst propertyId = Text.toNumber(selectedSkuProperty.getAttribute('data-property-id'));\n\t\tconst propertyValue = Text.toNumber(selectedSkuProperty.getAttribute('data-property-value'));\n\n\t\tthis.parent.setSelectedProperty(propertyId, propertyValue);\n\t\tthis.parent.toggleSkuProperties();\n\n\t\tEventEmitter.emit('SkuProperty::onChange', [this.parent.getSelectedSku(), this.property]);\n\t\tif (this.parent)\n\t\t{\n\t\t\tthis.parent.emit('SkuProperty::onChange', [this.parent.getSelectedSku(), this.property]);\n\t\t}\n\t}\n}","import {Tag, Type} from 'main.core';\nimport SkuProperty from './sku-property';\nimport './sku-tree.css';\nimport {EventEmitter} from 'main.core.events';\n\nexport class SkuTree extends EventEmitter\n{\n\tselectedValues = {};\n\n\tconstructor(options)\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Catalog.SkuTree');\n\n\t\tthis.skuTree = options.skuTree || {};\n\t\tthis.selectable = (options.selectable !== false);\n\t\tthis.hideUnselected = (options.hideUnselected === true);\n\n\t\tif (this.hasSku())\n\t\t{\n\t\t\tthis.selectedValues = this.skuTree.SELECTED_VALUES || {...this.skuTree.OFFERS[0].TREE};\n\t\t}\n\t}\n\n\tisSelectable()\n\t{\n\t\treturn this.selectable;\n\t}\n\n\tgetSelectedValues()\n\t{\n\t\treturn this.selectedValues;\n\t}\n\n\tsetSelectedProperty(propertyId, propertyValue)\n\t{\n\t\tthis.selectedValues[propertyId] = propertyValue;\n\n\t\tconst remainingProperties = this.getRemainingProperties(propertyId);\n\t\tif (remainingProperties.length)\n\t\t{\n\t\t\tfor (let remainingPropertyId of remainingProperties)\n\t\t\t{\n\t\t\t\tlet filterProperties = this.getFilterProperties(remainingPropertyId);\n\t\t\t\tlet skuItems = this.filterSku(filterProperties);\n\n\t\t\t\tif (skuItems.length)\n\t\t\t\t{\n\t\t\t\t\tlet found = false;\n\t\t\t\t\tfor (let sku of skuItems)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (sku.TREE[remainingPropertyId] === this.selectedValues[remainingPropertyId])\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tfound = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!found)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.selectedValues[remainingPropertyId] = skuItems[0].TREE[remainingPropertyId];\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tgetRemainingProperties(propertyId)\n\t{\n\t\tconst filter = [];\n\t\tlet found = false;\n\n\t\tfor (let prop of Object.values(this.skuTree.OFFERS_PROP))\n\t\t{\n\t\t\tif (prop.ID === propertyId)\n\t\t\t{\n\t\t\t\tfound = true;\n\t\t\t}\n\t\t\telse if (found)\n\t\t\t{\n\t\t\t\tfilter.push(prop.ID);\n\t\t\t}\n\t\t}\n\n\t\treturn filter;\n\t}\n\n\thasSku()\n\t{\n\t\treturn Type.isArrayFilled(this.skuTree.OFFERS);\n\t}\n\n\thasSkuProps()\n\t{\n\t\treturn Type.isPlainObject(this.skuTree.OFFERS_PROP) && Object.keys(this.skuTree.OFFERS_PROP).length;\n\t}\n\n\tgetSelectedSku()\n\t{\n\t\tif (!this.hasSku())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn this.skuTree.OFFERS.filter(item => {\n\t\t\treturn JSON.stringify(item.TREE) === JSON.stringify(this.selectedValues);\n\t\t})[0];\n\t}\n\n\tgetActiveSkuProperties(propertyId)\n\t{\n\t\tconst activeSkuProperties = [];\n\t\tconst filterProperties = this.getFilterProperties(propertyId);\n\n\t\tthis.filterSku(filterProperties)\n\t\t\t.forEach(item => {\n\t\t\t\tif (!activeSkuProperties.includes(item.TREE[propertyId]))\n\t\t\t\t{\n\t\t\t\t\tactiveSkuProperties.push(item.TREE[propertyId]);\n\t\t\t\t}\n\t\t\t})\n\t\t;\n\n\t\treturn activeSkuProperties;\n\t}\n\n\tgetFilterProperties(propertyId)\n\t{\n\t\tconst filter = [];\n\n\t\tfor (let prop of Object.values(this.skuTree.OFFERS_PROP))\n\t\t{\n\t\t\tif (prop.ID === propertyId)\n\t\t\t{\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tfilter.push(prop.ID);\n\t\t}\n\n\t\treturn filter;\n\t}\n\n\tfilterSku(filter)\n\t{\n\t\tif (filter.length === 0)\n\t\t{\n\t\t\treturn this.skuTree.OFFERS;\n\t\t}\n\n\t\tconst selectedValues = this.getSelectedValues();\n\n\t\treturn this.skuTree.OFFERS.filter(sku => {\n\t\t\tfor (let prop of filter)\n\t\t\t{\n\t\t\t\tif (sku.TREE[prop] !== selectedValues[prop])\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn true;\n\t\t});\n\t}\n\n\tgetSelectedSkuProperty(propertyId)\n\t{\n\t\treturn this.getSelectedSku()['TREE'][propertyId];\n\t}\n\n\tlayout()\n\t{\n\t\tconst container = Tag.render`<div class=\"product-item-scu-wrapper\"></div>`;\n\n\t\tthis.skuProperties = [];\n\n\t\tif (this.hasSku() && this.hasSkuProps())\n\t\t{\n\t\t\tfor (let i in this.skuTree.OFFERS_PROP)\n\t\t\t{\n\t\t\t\tif (this.skuTree.OFFERS_PROP.hasOwnProperty(i))\n\t\t\t\t{\n\t\t\t\t\tlet skuProperty = new SkuProperty({\n\t\t\t\t\t\tparent: this,\n\t\t\t\t\t\tproperty: this.skuTree.OFFERS_PROP[i],\n\t\t\t\t\t\texistingValues: this.skuTree.EXISTING_VALUES[i],\n\t\t\t\t\t\toffers: this.skuTree.OFFERS,\n\t\t\t\t\t\thideUnselected: this.hideUnselected,\n\t\t\t\t\t});\n\t\t\t\t\tcontainer.appendChild(skuProperty.layout());\n\t\t\t\t\tthis.skuProperties.push(skuProperty);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn container;\n\t}\n\n\ttoggleSkuProperties()\n\t{\n\t\tthis.skuProperties.forEach(property => property.toggleSkuPropertyValues());\n\t}\n}"],"names":["SkuProperty","options","handleSkuSelect","bind","parent","Error","property","offers","existingValues","nodeDescriptions","hideUnselected","ID","getSelectedSku","VALUES","length","propertyValue","uniqueId","propertyName","Type","isStringFilled","NAME","Text","encode","nameNode","Tag","render","iconNode","PICT","SRC","style","paddingLeft","skuSelectHandler","getId","isSelectable","getSelectedSkuId","hasSkuValues","skuList","renderProperties","toggleSkuPropertyValues","forEach","propertyValueId","node","getRandom","includes","SHOW_MODE","renderPictureSku","renderTextSku","push","appendChild","selectedSkuProperty","getSelectedSkuProperty","activeSkuProperties","getActiveSkuProperties","item","id","toNumber","input","querySelector","checked","Dom","addClass","removeClass","display","event","stopPropagation","target","closest","hasClass","propertyId","getAttribute","setSelectedProperty","toggleSkuProperties","EventEmitter","emit","SkuTree","setEventNamespace","skuTree","selectable","hasSku","selectedValues","SELECTED_VALUES","OFFERS","TREE","remainingProperties","getRemainingProperties","remainingPropertyId","filterProperties","getFilterProperties","skuItems","filterSku","found","sku","filter","Object","values","OFFERS_PROP","prop","isArrayFilled","isPlainObject","keys","JSON","stringify","getSelectedValues","container","skuProperties","hasSkuProps","i","hasOwnProperty","skuProperty","EXISTING_VALUES","layout"],"mappings":"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"}