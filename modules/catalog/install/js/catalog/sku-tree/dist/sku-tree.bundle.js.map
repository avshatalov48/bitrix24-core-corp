{"version":3,"file":"sku-tree.bundle.js","sources":["../src/sku-property.js","../src/sku-tree.js"],"sourcesContent":["import {Dom, Tag, Text, Type} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport {SkuTree} from 'catalog.sku-tree';\n\nexport default class SkuProperty\n{\n\tparent: ?SkuTree;\n\n\tskuSelectHandler = this.handleSkuSelect.bind(this);\n\n\tconstructor(options)\n\t{\n\t\tthis.parent = options.parent || null;\n\t\tif (!this.parent)\n\t\t{\n\t\t\tthrow new Error('Parent is not defined.');\n\t\t}\n\n\t\tthis.property = options.property || {};\n\t\tthis.offers = options.offers || [];\n\t\tthis.existingValues = options.existingValues || [];\n\t\tthis.nodeDescriptions = [];\n\t\tthis.hideUnselected = options.hideUnselected;\n\t}\n\n\tgetId()\n\t{\n\t\treturn this.property.ID;\n\t}\n\n\tgetSelectedSkuId()\n\t{\n\t\treturn this.parent.getSelectedSkuId();\n\t}\n\n\thasSkuValues()\n\t{\n\t\treturn this.property.VALUES.length;\n\t}\n\n\trenderPictureSku(propertyValue, uniqueId)\n\t{\n\t\tconst propertyName = Type.isStringFilled(propertyValue.NAME) ? Text.encode(propertyValue.NAME) : '';\n\n\t\tlet nameNode = '';\n\t\tif (Type.isStringFilled(propertyName))\n\t\t{\n\t\t\tnameNode = Tag.render`<span class=\"ui-ctl-label-text\">${propertyName}</span>`;\n\t\t}\n\n\t\tlet iconNode = '';\n\t\tif (propertyValue.PICT && propertyValue.PICT.SRC)\n\t\t{\n\t\t\tconst style = \"background-image: url('\" + propertyValue.PICT.SRC + \"');\";\n\t\t\ticonNode = Tag.render`<span class=\"ui-ctl-label-img\" style=\"${style}\"></span>`;\n\t\t}\n\t\telse if (nameNode)\n\t\t{\n\t\t\tnameNode.style.paddingLeft = '0';\n\t\t}\n\t\telse\n\t\t{\n\t\t\tnameNode = Tag.render`<span class=\"ui-ctl-label-text\">-</span>`;\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<label \tclass=\"ui-ctl ui-ctl-radio-selector\"\n\t\t\t\t\tonclick=\"${this.skuSelectHandler}\"\n\t\t\t\t\ttitle=\"${propertyName}\"\n\t\t\t\t\tdata-property-id=\"${this.getId()}\"\n\t\t\t\t\tdata-property-value=\"${propertyValue.ID}\">\n\t\t\t\t<input type=\"radio\"\n\t\t\t\t\tdisabled=\"${!this.parent.isSelectable()}\"\n\t\t\t\t\tname=\"property-${this.getSelectedSkuId()}-${this.getId()}-${uniqueId}\"\n\t\t\t\t\tclass=\"ui-ctl-element\">\n\t\t\t\t<span class=\"ui-ctl-inner\">\n\t\t\t\t\t${iconNode}\n\t\t\t\t\t${nameNode}\n\t\t\t\t</span>\n\t\t\t</label>\n\t\t`;\n\t}\n\n\trenderTextSku(propertyValue, uniqueId)\n\t{\n\t\tconst propertyName = Type.isStringFilled(propertyValue.NAME) ? Text.encode(propertyValue.NAME) : '-';\n\n\t\treturn Tag.render`\n\t\t\t<label \tclass=\"ui-ctl ui-ctl-radio-selector\"\n\t\t\t\t\tonclick=\"${this.skuSelectHandler}\"\n\t\t\t\t\ttitle=\"${propertyName}\"\n\t\t\t\t\tdata-property-id=\"${this.getId()}\"\n\t\t\t\t\tdata-property-value=\"${propertyValue.ID}\">\n\t\t\t\t<input type=\"radio\"\n\t\t\t\t\tdisabled=\"${!this.parent.isSelectable()}\"\n\t\t\t\t\tname=\"property-${this.getSelectedSkuId()}-${this.getId()}-${uniqueId}\"\n\t\t\t\t\tclass=\"ui-ctl-element\">\n\t\t\t\t<span class=\"ui-ctl-inner\">\n\t\t\t\t\t<span class=\"ui-ctl-label-text\">${propertyName}</span>\n\t\t\t\t</span>\n\t\t\t</label>\n\t\t`;\n\t}\n\n\tlayout()\n\t{\n\t\tif (!this.hasSkuValues())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.skuList = this.renderProperties();\n\t\tthis.toggleSkuPropertyValues();\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"product-item-detail-info-container\">\n\t\t\t\t<div class=\"product-item-detail-info-container-title\">${Text.encode(this.property.NAME)}</div>\n\t\t\t\t<div class=\"product-item-scu-container\">\n\t\t\t\t\t${this.skuList}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\trenderProperties()\n\t{\n\t\tconst skuList = Tag.render`<div class=\"product-item-scu-list ui-ctl-spacing-right\"></div>`;\n\n\t\tthis.property.VALUES.forEach((propertyValue) => {\n\t\t\tlet propertyValueId = propertyValue.ID;\n\t\t\tlet node;\n\t\t\tlet uniqueId = Text.getRandom();\n\n\t\t\tif (!propertyValueId || this.existingValues.includes(propertyValueId))\n\t\t\t{\n\t\t\t\tif (this.property.SHOW_MODE === 'PICT')\n\t\t\t\t{\n\t\t\t\t\tDom.addClass(skuList, 'product-item-scu-list--pick-color');\n\t\t\t\t\tnode = this.renderPictureSku(propertyValue, uniqueId);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tDom.addClass(skuList, 'product-item-scu-list--pick-size');\n\t\t\t\t\tnode = this.renderTextSku(propertyValue, uniqueId);\n\t\t\t\t}\n\n\t\t\t\tthis.nodeDescriptions.push({propertyValueId, node});\n\t\t\t\tskuList.appendChild(node);\n\t\t\t}\n\t\t});\n\n\t\treturn skuList;\n\t}\n\n\ttoggleSkuPropertyValues()\n\t{\n\t\tconst selectedSkuProperty = this.parent.getSelectedSkuProperty(this.getId());\n\t\tconst activeSkuProperties = this.parent.getActiveSkuProperties(this.getId());\n\n\t\tthis.nodeDescriptions.forEach((item) => {\n\t\t\tlet id = Text.toNumber(item.propertyValueId);\n\t\t\tlet input = item.node.querySelector('input[type=\"radio\"]');\n\n\t\t\tif (selectedSkuProperty === id)\n\t\t\t{\n\t\t\t\tinput.checked = true;\n\t\t\t\tDom.addClass(item.node, 'selected');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tinput.checked = false;\n\t\t\t\tDom.removeClass(item.node, 'selected');\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\t(this.hideUnselected && selectedSkuProperty !== id)\n\t\t\t\t|| !activeSkuProperties.includes(item.propertyValueId)\n\t\t\t)\n\t\t\t{\n\t\t\t\tDom.style(item.node, {display: 'none'});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tDom.style(item.node, {display: null});\n\t\t\t}\n\t\t});\n\t}\n\n\thandleSkuSelect(event)\n\t{\n\t\tevent.stopPropagation();\n\n\t\tconst selectedSkuProperty = event.target.closest('[data-property-id]');\n\t\tif (!this.parent.isSelectable() || Dom.hasClass(selectedSkuProperty, 'selected'))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst propertyId = Text.toNumber(selectedSkuProperty.getAttribute('data-property-id'));\n\t\tconst propertyValue = Text.toNumber(selectedSkuProperty.getAttribute('data-property-value'));\n\t\tthis.parent.setSelectedProperty(propertyId, propertyValue);\n\n\t\tthis.parent.getSelectedSku().then((selectedSkuData) => {\n\t\t\tEventEmitter.emit('SkuProperty::onChange', [selectedSkuData, this.property]);\n\t\t\tif (this.parent)\n\t\t\t{\n\t\t\t\tthis.parent.emit('SkuProperty::onChange', [selectedSkuData, this.property]);\n\t\t\t}\n\t\t});\n\n\t\tthis.parent.toggleSkuProperties();\n\t}\n}\n","import {Tag, Type, Text, Dom, ajax} from 'main.core';\nimport 'ui.design-tokens';\nimport './sku-tree.css';\nimport SkuProperty from './sku-property';\nimport {EventEmitter} from 'main.core.events';\nimport 'ui.forms';\nimport 'ui.buttons';\n\nconst iblockSkuProperties = new Map();\nconst iblockSkuList = new Map();\nconst propertyPromises = new Map();\n\nexport class SkuTree extends EventEmitter\n{\n\tselectedValues = {};\n\n\tstatic DEFAULT_IBLOCK_ID = 0;\n\n\tconstructor(options)\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Catalog.SkuTree');\n\n\t\tthis.id = Text.getRandom();\n\t\tthis.skuTree = options.skuTree || {};\n\n\t\tthis.productId = this.skuTree?.PRODUCT_ID;\n\n\t\tthis.skuTreeOffers = this.skuTree.OFFERS || [];\n\n\t\tif (!Type.isNil(options.skuTree.OFFERS_JSON) && !Type.isArrayFilled(this.skuTreeOffers))\n\t\t{\n\t\t\tthis.skuTreeOffers = JSON.parse(this.skuTree.OFFERS_JSON);\n\t\t}\n\n\t\tthis.iblockId = this.skuTree.IBLOCK_ID || SkuTree.DEFAULT_IBLOCK_ID;\n\t\tif (!iblockSkuProperties.has(this.iblockId))\n\t\t{\n\t\t\tif (Type.isObject(this.skuTree.OFFERS_PROP))\n\t\t\t{\n\t\t\t\tiblockSkuProperties.set(this.iblockId, this.skuTree.OFFERS_PROP);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tiblockSkuProperties.set(this.iblockId, {});\n\t\t\t\tconst promise = new Promise((resolve) => {\n\t\t\t\t\tajax\n\t\t\t\t\t\t.runAction(\t'catalog.skuTree.getIblockProperties', {\n\t\t\t\t\t\t\tjson:{\n\t\t\t\t\t\t\t\tiblockId: this.iblockId\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.then((result) => {\n\t\t\t\t\t\t\tiblockSkuProperties.set(this.iblockId, result.data);\n\t\t\t\t\t\t\tresolve();\n\t\t\t\t\t\t\tpropertyPromises.delete(SkuTree.#getIblockPropertiesRequestName(this.iblockId));\n\t\t\t\t\t\t});\n\t\t\t\t});\n\n\t\t\t\tpropertyPromises.set(SkuTree.#getIblockPropertiesRequestName(this.iblockId), promise);\n\t\t\t}\n\t\t}\n\n\t\tthis.selectable = (options.selectable !== false);\n\t\tthis.hideUnselected = (options.hideUnselected === true);\n\n\t\tif (this.hasSku())\n\t\t{\n\t\t\tthis.selectedValues = this.skuTree.SELECTED_VALUES || {...this.skuTreeOffers[0].TREE};\n\t\t}\n\n\t\tthis.existingValues = this.skuTree.EXISTING_VALUES || {};\n\t\tif (!Type.isNil(options.skuTree.EXISTING_VALUES_JSON) && Type.isNil(options.skuTree.EXISTING_VALUES))\n\t\t{\n\t\t\tthis.existingValues = JSON.parse(options.skuTree.EXISTING_VALUES_JSON);\n\t\t}\n\n\t\tfor (const key in this.existingValues)\n\t\t{\n\t\t\tif (this.existingValues[key].length === 1 && this.existingValues[key][0] === 0)\n\t\t\t{\n\t\t\t\tdelete this.existingValues[key];\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic #getIblockPropertiesRequestName(iblockId: number): string\n\t{\n\t\treturn 'IblockPropertiesRequest_' + iblockId;\n\t}\n\n\tgetProperties(): {}\n\t{\n\t\treturn iblockSkuProperties.get(this.iblockId);\n\t}\n\n\tisSelectable(): boolean\n\t{\n\t\treturn this.selectable;\n\t}\n\n\tgetSelectedValues(): {}\n\t{\n\t\treturn this.selectedValues;\n\t}\n\n\tsetSelectedProperty(propertyId, propertyValue)\n\t{\n\t\tthis.selectedValues[propertyId] = Text.toNumber(propertyValue);\n\n\t\tconst remainingProperties = this.getRemainingProperties(propertyId);\n\t\tif (remainingProperties.length)\n\t\t{\n\t\t\tfor (const remainingPropertyId of remainingProperties)\n\t\t\t{\n\t\t\t\tconst filterProperties = this.getFilterProperties(remainingPropertyId);\n\t\t\t\tconst skuItems = this.filterSku(filterProperties);\n\n\t\t\t\tif (skuItems.length)\n\t\t\t\t{\n\t\t\t\t\tlet found = false;\n\t\t\t\t\tfor (const sku of skuItems)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (sku.TREE[remainingPropertyId] === this.selectedValues[remainingPropertyId])\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tfound = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!found)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.selectedValues[remainingPropertyId] = skuItems[0].TREE[remainingPropertyId];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tgetRemainingProperties(propertyId): []\n\t{\n\t\tconst filter = [];\n\t\tlet found = false;\n\n\t\tfor (const prop of Object.values(this.getProperties()))\n\t\t{\n\t\t\tif (prop.ID === propertyId)\n\t\t\t{\n\t\t\t\tfound = true;\n\t\t\t}\n\t\t\telse if (found)\n\t\t\t{\n\t\t\t\tfilter.push(prop.ID);\n\t\t\t}\n\t\t}\n\n\t\treturn filter;\n\t}\n\n\thasSku(): boolean\n\t{\n\t\treturn Type.isArrayFilled(this.skuTreeOffers);\n\t}\n\n\thasSkuProps(): boolean\n\t{\n\t\treturn Object.values(this.getProperties()).length > 0;\n\t}\n\n\tgetSelectedSkuId(): ?number\n\t{\n\t\tif (!this.hasSku())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst item = this.skuTreeOffers.filter(item => {\n\t\t\treturn JSON.stringify(item.TREE) === JSON.stringify(this.selectedValues);\n\t\t})[0]\n\n\t\treturn item?.ID;\n\t}\n\n\tgetSelectedSku(): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tconst skuId = this.getSelectedSkuId();\n\n\t\t\tif (skuId <= 0)\n\t\t\t{\n\t\t\t\treject();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (iblockSkuList.has(skuId))\n\t\t\t{\n\t\t\t\tconst skuData = iblockSkuList.get(skuId);\n\t\t\t\tresolve(skuData);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (propertyPromises.has(SkuTree.#getSkuRequestName(skuId)))\n\t\t\t\t{\n\t\t\t\t\tpropertyPromises\n\t\t\t\t\t\t.get(SkuTree.#getSkuRequestName(skuId))\n\t\t\t\t\t\t.then((skuFields) => {\n\t\t\t\t\t\t\tresolve(skuFields);\n\t\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tconst skuRequest = ajax\n\t\t\t\t\t\t.runAction(\t'catalog.skuTree.getSku', {\n\t\t\t\t\t\t\tjson: {\tskuId }\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.then((result) => {\n\t\t\t\t\t\t\tconst skuData = result.data;\n\t\t\t\t\t\t\tiblockSkuList.set(skuId, skuData);\n\t\t\t\t\t\t\tresolve(skuData);\n\n\t\t\t\t\t\t\tpropertyPromises.delete(SkuTree.#getSkuRequestName(skuId), skuRequest);\n\t\t\t\t\t\t});\n\n\t\t\t\t\tpropertyPromises.set(SkuTree.#getSkuRequestName(skuId), skuRequest)\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tstatic #getSkuRequestName(skuId: number): string\n\t{\n\t\treturn 'SkuFieldsRequest_' + skuId;\n\t}\n\n\tgetActiveSkuProperties(propertyId): {}\n\t{\n\t\tconst activeSkuProperties = [];\n\t\tconst filterProperties = this.getFilterProperties(propertyId);\n\n\t\tthis.filterSku(filterProperties)\n\t\t\t.forEach(item => {\n\t\t\t\tif (!activeSkuProperties.includes(item.TREE[propertyId]))\n\t\t\t\t{\n\t\t\t\t\tactiveSkuProperties.push(item.TREE[propertyId]);\n\t\t\t\t}\n\t\t\t})\n\t\t;\n\n\t\treturn activeSkuProperties;\n\t}\n\n\tgetFilterProperties(propertyId): []\n\t{\n\t\tconst filter = [];\n\n\t\tfor (const prop of Object.values(this.getProperties()))\n\t\t{\n\t\t\tif (prop.ID === propertyId)\n\t\t\t{\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tfilter.push(prop.ID);\n\t\t}\n\n\t\treturn filter;\n\t}\n\n\tfilterSku(filter): []\n\t{\n\t\tif (filter.length === 0)\n\t\t{\n\t\t\treturn this.skuTreeOffers;\n\t\t}\n\n\t\tconst selectedValues = this.getSelectedValues();\n\n\t\treturn this.skuTreeOffers.filter(sku => {\n\t\t\tfor (const propertyId of filter)\n\t\t\t{\n\t\t\t\tif (sku.TREE[propertyId] !== selectedValues[propertyId])\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn true;\n\t\t});\n\t}\n\n\tgetSelectedSkuProperty(propertyId)\n\t{\n\t\treturn Text.toNumber(this.selectedValues[propertyId]);\n\t}\n\n\tlayout(): HTMLElement\n\t{\n\t\tconst container = Tag.render`<div class=\"product-item-scu-wrapper\" id=\"${this.id}\"></div>`;\n\n\t\tthis.skuProperties = [];\n\t\tif (this.hasSku())\n\t\t{\n\t\t\tnew Promise(\n\t\t\t\t(resolve) => {\n\t\t\t\t\tif (propertyPromises.has(SkuTree.#getIblockPropertiesRequestName(this.iblockId)))\n\t\t\t\t\t{\n\t\t\t\t\t\tpropertyPromises\n\t\t\t\t\t\t\t.get(SkuTree.#getIblockPropertiesRequestName(this.iblockId))\n\t\t\t\t\t\t\t.then(resolve);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tresolve();\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.then(() => {\n\t\t\t\t\tif (!this.hasSkuProps())\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst skuProperties = this.getProperties();\n\t\t\t\t\tfor (const i in skuProperties)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (skuProperties.hasOwnProperty(i) && !Type.isNil(this.existingValues[i]))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst skuProperty = new SkuProperty({\n\t\t\t\t\t\t\t\tparent: this,\n\t\t\t\t\t\t\t\tproperty: skuProperties[i],\n\t\t\t\t\t\t\t\texistingValues:\n\t\t\t\t\t\t\t\t\tType.isArray(this.existingValues[i])\n\t\t\t\t\t\t\t\t\t\t? this.existingValues[i]\n\t\t\t\t\t\t\t\t\t\t:\tObject.values(this.existingValues[i])\n\t\t\t\t\t\t\t\t,\n\t\t\t\t\t\t\t\toffers: this.skuTreeOffers,\n\t\t\t\t\t\t\t\thideUnselected: this.hideUnselected,\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\tDom.append(skuProperty.layout(), container);\n\t\t\t\t\t\t\tthis.skuProperties.push(skuProperty);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t}\n\n\t\treturn container;\n\t}\n\n\ttoggleSkuProperties()\n\t{\n\t\tthis.skuProperties.forEach(property => property.toggleSkuPropertyValues());\n\t}\n}"],"names":["SkuProperty","options","handleSkuSelect","bind","parent","Error","property","offers","existingValues","nodeDescriptions","hideUnselected","ID","getSelectedSkuId","VALUES","length","propertyValue","uniqueId","propertyName","Type","isStringFilled","NAME","Text","encode","nameNode","Tag","render","iconNode","PICT","SRC","style","paddingLeft","skuSelectHandler","getId","isSelectable","hasSkuValues","skuList","renderProperties","toggleSkuPropertyValues","forEach","propertyValueId","node","getRandom","includes","SHOW_MODE","Dom","addClass","renderPictureSku","renderTextSku","push","appendChild","selectedSkuProperty","getSelectedSkuProperty","activeSkuProperties","getActiveSkuProperties","item","id","toNumber","input","querySelector","checked","removeClass","display","event","stopPropagation","target","closest","hasClass","propertyId","getAttribute","setSelectedProperty","getSelectedSku","then","selectedSkuData","EventEmitter","emit","toggleSkuProperties","iblockSkuProperties","Map","iblockSkuList","propertyPromises","SkuTree","setEventNamespace","skuTree","productId","PRODUCT_ID","skuTreeOffers","OFFERS","isNil","OFFERS_JSON","isArrayFilled","JSON","parse","iblockId","IBLOCK_ID","DEFAULT_IBLOCK_ID","has","isObject","OFFERS_PROP","set","promise","Promise","resolve","ajax","runAction","json","result","data","selectable","hasSku","selectedValues","SELECTED_VALUES","TREE","EXISTING_VALUES","EXISTING_VALUES_JSON","key","get","remainingProperties","getRemainingProperties","remainingPropertyId","filterProperties","getFilterProperties","skuItems","filterSku","found","sku","filter","Object","values","getProperties","prop","stringify","reject","skuId","skuData","skuFields","skuRequest","getSelectedValues","container","skuProperties","hasSkuProps","i","hasOwnProperty","skuProperty","isArray","append","layout"],"mappings":"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"}