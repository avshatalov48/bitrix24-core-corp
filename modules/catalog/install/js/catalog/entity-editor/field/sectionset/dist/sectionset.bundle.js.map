{"version":3,"file":"sectionset.bundle.js","sources":["../src/const.js","../src/sectionsetfield.js","../src/field-factory.js"],"sourcesContent":["export const Const = Object.freeze({\n\tTYPE: {\n\t\tSECTION: 'SECTION',\n\t},\n\tENTITY_ID: {\n\t\tSECTION: 'agent-contractor-section',\n\t},\n});\n","import { TagSelector } from 'ui.entity-selector';\nimport { BaseEvent } from 'main.core.events';\nimport { Const } from './const';\nimport { ProductSetField, Footer } from 'catalog.entity-editor.field.productset';\n\nexport class SectionSetField extends ProductSetField\n{\n\tconstructor(id, settings)\n\t{\n\t\tsuper(id, settings);\n\t\tthis.initialize(id, settings);\n\n\t\tthis._input = null;\n\t\tthis._inputWrapper = null;\n\t\tthis.innerWrapper = null;\n\t\tthis.entityList = null;\n\t\tthis.tagSelector = null;\n\t}\n\n\tgetProductSelector(value)\n\t{\n\t\tconst iblockId = this.getIBlockIdFromModel();\n\n\t\tif (!this.tagSelector)\n\t\t{\n\t\t\tthis.tagSelector = new TagSelector({\n\t\t\t\t// items: currentSelectedItems,\n\t\t\t\ttextBoxWidth: '100%',\n\t\t\t\tmultiple: true,\n\t\t\t\tdialogOptions: {\n\t\t\t\t\tcontext: 'catalog_document_sectionset',\n\t\t\t\t\tentities: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tid: Const.ENTITY_ID.SECTION,\n\t\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\t\tiblockId: iblockId,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t\tsearchOptions: {\n\t\t\t\t\t\tallowCreateItem: false,\n\t\t\t\t\t},\n\t\t\t\t\tevents: {\n\t\t\t\t\t\t'Item:onSelect': (event) => {\n\t\t\t\t\t\t\tthis.handleUserSelectorChanges(event);\n\t\t\t\t\t\t\tthis._changeHandler();\n\t\t\t\t\t\t},\n\t\t\t\t\t\t'Item:onDeselect': (event) => {\n\t\t\t\t\t\t\tthis.handleUserSelectorChanges(event);\n\t\t\t\t\t\t\tthis._changeHandler();\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\tfooter: Footer,\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\n\t\tif (this.tagSelector.getDialog() && value.length > 0)\n\t\t{\n\t\t\tconst dialog = this.tagSelector.getDialog();\n\n\t\t\tvalue.forEach((item) => {\n\t\t\t\tdialog.addItem({\n\t\t\t\t\tid: item.PRODUCT_ID,\n\t\t\t\t\ttitle: item.PRODUCT_NAME,\n\t\t\t\t\tavatar: item.IMAGE,\n\t\t\t\t\tselected: true,\n\t\t\t\t\tentityId: Const.ENTITY_ID.SECTION,\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t\treturn this.tagSelector;\n\t}\n\n\thandleUserSelectorChanges(event: BaseEvent)\n\t{\n\t\tthis.entityList = [];\n\t\tconst values = [];\n\n\t\tconst selectedItems = event.getTarget().getSelectedItems();\n\t\tselectedItems.forEach((item) => {\n\t\t\tvalues.push({\n\t\t\t\tPRODUCT_ID: item.getId(),\n\t\t\t\tPRODUCT_TYPE: Const.TYPE.SECTION,\n\t\t\t});\n\n\t\t\tthis.entityList.push({\n\t\t\t\tPRODUCT_ID: item.getId(),\n\t\t\t\tPRODUCT_TYPE: Const.TYPE.SECTION,\n\t\t\t\tPRODUCT_NAME: item.getTitle(),\n\t\t\t});\n\t\t});\n\n\t\tthis._input.value = JSON.stringify(values);\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new this(id, settings);\n\t\tself.initialize(id, settings);\n\n\t\treturn self;\n\t}\n}\n","import { EventEmitter } from 'main.core.events';\nimport type { BaseEvent } from 'main.core.events';\nimport { SectionSetField } from './sectionset';\n\nexport class SectionSetFieldFactory\n{\n\tconstructor(entityEditorControlFactory = 'BX.UI.EntityEditorControlFactory')\n\t{\n\t\tEventEmitter.subscribe(`${entityEditorControlFactory}:onInitialize`, (event: BaseEvent) => {\n\t\t\tconst [, eventArgs] = event.getCompatData();\n\t\t\teventArgs.methods.sectionSet = this.factory.bind(this);\n\t\t});\n\t}\n\n\tfactory(type, controlId, settings)\n\t{\n\t\tif (type === 'sectionSet')\n\t\t{\n\t\t\treturn SectionSetField.create(controlId, settings);\n\t\t}\n\n\t\treturn null;\n\t}\n}\n"],"names":["Const","Object","freeze","TYPE","SECTION","ENTITY_ID","SectionSetField","ProductSetField","constructor","id","settings","initialize","_input","_inputWrapper","innerWrapper","entityList","tagSelector","getProductSelector","value","iblockId","getIBlockIdFromModel","TagSelector","textBoxWidth","multiple","dialogOptions","context","entities","options","searchOptions","allowCreateItem","events","event","handleUserSelectorChanges","_changeHandler","footer","Footer","getDialog","length","dialog","forEach","item","addItem","PRODUCT_ID","title","PRODUCT_NAME","avatar","IMAGE","selected","entityId","values","selectedItems","getTarget","getSelectedItems","push","getId","PRODUCT_TYPE","getTitle","JSON","stringify","create","self","SectionSetFieldFactory","entityEditorControlFactory","EventEmitter","subscribe","eventArgs","getCompatData","methods","sectionSet","factory","bind","type","controlId"],"mappings":"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"}