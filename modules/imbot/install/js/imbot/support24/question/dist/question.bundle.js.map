{"version":3,"file":"question.bundle.js","sources":["../src/model/question.js","../src/component/question-list/search/search-event.js","../src/mixin/theme.js","../src/component/question-list/search/search.js","../src/component/question-list/button-ask/button-ask.js","../src/component/question-list/question/question.js","../src/lib/permissions.js","../src/component/question-list/question-list.js","../src/question.js"],"sourcesContent":["import { VuexBuilderModel } from 'ui.vue.vuex';\nimport { Type } from 'main.core';\n\nexport class QuestionModel extends VuexBuilderModel\n{\n\tgetName()\n\t{\n\t\treturn 'question';\n\t}\n\n\tgetState()\n\t{\n\t\treturn {\n\t\t\thistory: [],\n\t\t\tsearchResult: [],\n\t\t};\n\t}\n\n\tgetActions()\n\t{\n\t\treturn {\n\t\t\ttrimHistory: (store, count) =>\n\t\t\t{\n\t\t\t\tstore.commit('trimHistory', count);\n\t\t\t},\n\t\t\tsetHistory: (store, payload) =>\n\t\t\t{\n\t\t\t\tstore.commit('setHistory', this.validateQuestionList(payload));\n\t\t\t},\n\t\t\taddHistory: (store, payload) =>\n\t\t\t{\n\t\t\t\tstore.commit('addHistory', this.validateQuestionList(payload));\n\t\t\t},\n\t\t\tsetSearchResult: (store, payload) =>\n\t\t\t{\n\t\t\t\tstore.commit('setSearchResult', this.validateQuestionList(payload));\n\t\t\t},\n\t\t\taddSearchResult: (store, payload) =>\n\t\t\t{\n\t\t\t\tstore.commit('addSearchResult', this.validateQuestionList(payload));\n\t\t\t},\n\t\t\tsetQuestionTitleById: (store, payload) =>\n\t\t\t{\n\t\t\t\tstore.commit('setQuestionTitleById', payload);\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMutations()\n\t{\n\t\treturn {\n\t\t\ttrimHistory: (state, count) =>\n\t\t\t{\n\t\t\t\tstate.history = state.history.filter((question, questionIndex) => questionIndex < count);\n\n\t\t\t\tsuper.saveState(state);\n\t\t\t},\n\t\t\tsetHistory: (state, payload) =>\n\t\t\t{\n\t\t\t\tstate.history = payload;\n\n\t\t\t\tsuper.saveState(state);\n\t\t\t},\n\t\t\taddHistory: (state, payload) =>\n\t\t\t{\n\t\t\t\tstate.history = state.history.concat(payload);\n\n\t\t\t\tsuper.saveState(state);\n\t\t\t},\n\t\t\tsetSearchResult: (state, payload) =>\n\t\t\t{\n\t\t\t\tstate.searchResult = payload;\n\n\t\t\t\tsuper.saveState(state);\n\t\t\t},\n\t\t\taddSearchResult: (state, payload) =>\n\t\t\t{\n\t\t\t\tstate.searchResult = state.searchResult.concat(payload);\n\n\t\t\t\tsuper.saveState(state);\n\t\t\t},\n\t\t\tsetQuestionTitleById: (state, payload) =>\n\t\t\t{\n\t\t\t\tconst question = state.history.find(question => question.id === payload.id);\n\n\t\t\t\tquestion.title = payload.title;\n\n\t\t\t\tsuper.saveState(state);\n\t\t\t},\n\t\t};\n\t}\n\n\tvalidateQuestionList(questions)\n\t{\n\t\tif (!Type.isArrayFilled(questions))\n\t\t{\n\t\t\treturn [];\n\t\t}\n\n\t\treturn questions.filter(question => this.isQuestion(question));\n\t}\n\n\tisQuestion(question)\n\t{\n\t\treturn (\n\t\t\tObject.keys(question).length === 2\n\t\t\t&& Type.isInteger(question.id)\n\t\t\t&& Type.isString(question.title)\n\t\t);\n\t}\n}\n","import { BaseEvent } from 'main.core.events';\n\nexport class SearchEvent extends BaseEvent\n{\n\tdata: {\n\t\tsearchQuery: string,\n\t};\n}","export const Theme = {\n\tcomputed:\n\t{\n\t\tdarkTheme()\n\t\t{\n\t\t\treturn BX.MessengerTheme.isDark();\n\t\t}\n\t},\n\tmethods:\n\t{\n\t\tgetClassWithTheme(baseClass: string)\n\t\t{\n\t\t\tconst classWithTheme = {};\n\n\t\t\tclassWithTheme[baseClass] = true;\n\t\t\tclassWithTheme[baseClass + '-dark'] = this.darkTheme;\n\n\t\t\treturn classWithTheme;\n\t\t}\n\t}\n};","import { BitrixVue } from 'ui.vue';\nimport { Runtime } from 'main.core'\nimport { SearchEvent } from './search-event';\nimport { Theme } from '../../../mixin/theme';\nimport 'ui.forms';\n\nimport './search.css';\n\nexport const Search = BitrixVue.localComponent('imbot-support24-question-component-question-list-search',{\n\tdirectives:\n\t{\n\t\tfocus:\n\t\t{\n\t\t\tinserted(element, params)\n\t\t\t{\n\t\t\t\telement.focus();\n\t\t\t}\n\t\t}\n\t},\n\tmixins: [Theme],\n\tdata: function() {\n\t\treturn {\n\t\t\tsearchQuery: '',\n\t\t\tscheduleSearch: Runtime.debounce(this.search, 500, this),\n\t\t}\n\t},\n\tcomputed:\n\t{\n\t\tinputClass()\n\t\t{\n\t\t\treturn this.getClassWithTheme('bx-imbot-support24-question-list-search-input');\n\t\t}\n\t},\n\tmethods:\n\t{\n\t\tsearch()\n\t\t{\n\t\t\tthis.$emit('search', new SearchEvent({\n\t\t\t\tdata: {\n\t\t\t\t\tsearchQuery: this.searchQuery\n\t\t\t\t},\n\t\t\t}));\n\t\t}\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"bx-imbot-support24-question-list-search\">\n\t\t\t<div class=\"ui-ctl ui-ctl-textbox ui-ctl-block ui-ctl-w100 ui-ctl-sm bx-imbot-support24-question-list-search-hover\">\n\t\t\t\t<input\n\t\t\t\t\tclass=\"ui-ctl-element\"\n\t\t\t\t\t:class=\"inputClass\"\n\t\t\t\t\ttype=\"text\"\n\t\t\t\t\tv-model=\"searchQuery\"\n\t\t\t\t\tv-focus\n\t\t\t\t\t@input=\"scheduleSearch()\"\n\t\t\t\t\t:placeholder=\"$Bitrix.Loc.getMessage('IMBOT_SUPPORT24_QUESTION_LIST_SEARCH')\"\n\t\t\t\t>\n\t\t\t</div>\n\t\t</div>\n\t`\n});","import 'ui.design-tokens';\nimport 'ui.fonts.opensans';\nimport { BitrixVue } from 'ui.vue';\nimport 'ui.buttons';\n\nimport { Theme } from '../../../mixin/theme';\n\nimport './button-ask.css';\n\nexport const ButtonAskProps = Object.freeze({\n\tType: {\n\t\tSECONDARY: 'secondary',\n\t\tPRIMARY: 'primary'\n\t}\n});\n\nexport const ButtonAsk = BitrixVue.localComponent('imbot-support24-question-component-question-list-button-ask',{\n\tmixins: [Theme],\n\tprops: {\n\t\ttype: {\n\t\t\ttype: String,\n\t\t\tdefault: ButtonAskProps.Type.SECONDARY,\n\t\t},\n\t},\n\tdata: function() {\n\t\treturn {\n\t\t\tlastQuestionTime: null,\n\t\t}\n\t},\n\tcomputed:\n\t{\n\t\tButtonAskProps: () => ButtonAskProps,\n\t\tbuttonClass()\n\t\t{\n\t\t\tconst buttonClass = this.getClassWithTheme('bx-imbot-support24-question-list-button-ask-' + this.type);\n\n\t\t\tif (this.type === ButtonAskProps.Type.PRIMARY)\n\t\t\t{\n\t\t\t\tlet largeButtonColor = this.darkTheme ? 'ui-btn-primary-dark' : 'ui-btn-primary';\n\n\t\t\t\tbuttonClass[largeButtonColor] = true;\n\t\t\t}\n\n\t\t\treturn buttonClass;\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\taskQuestion()\n\t\t{\n\t\t\tconst tenSeconds = 5000;\n\n\t\t\tif (this.lastQuestionTime && (Date.now() - this.lastQuestionTime < tenSeconds))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.lastQuestionTime = Date.now();\n\n\t\t\tthis.$emit('askQuestion');\n\t\t},\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"bx-imbot-support24-question-list-button-ask\">\n\t\t\t<div\n\t\t\t\tv-if=\"type === ButtonAskProps.Type.SECONDARY\"\n\t\t\t\t:class=\"buttonClass\"\n\t\t\t\t@click=\"askQuestion\"\n\t\t\t>\n\t\t\t\t{{ $Bitrix.Loc.getMessage('IMBOT_SUPPORT24_QUESTION_BUTTON_ASK_NEW_TITLE') }}\n\t\t\t</div>\n\n\t\t\t<button\n\t\t\t\tv-if=\"type === ButtonAskProps.Type.PRIMARY\"\n\t\t\t\t:class=\"buttonClass\"\n\t\t\t\t@click=\"askQuestion\"\n\t\t\t\tclass=\"ui-btn ui-btn-sm ui-btn-round ui-btn-no-caps\"\n\t\t\t>\n\t\t\t\t{{ $Bitrix.Loc.getMessage('IMBOT_SUPPORT24_QUESTION_BUTTON_ASK_TITLE') }}\n\t\t\t</button>\n\t\t</div>\n\t`\n});","import 'ui.design-tokens';\nimport { BitrixVue } from 'ui.vue';\nimport { Text } from 'main.core';\nimport { Theme } from '../../../mixin/theme';\nimport 'ui.forms';\n\nimport './question.css';\n\nconst QuestionState = Object.freeze({\n\tDEFAULT: 'default',\n\tEDIT: 'edit',\n});\n\nexport const Question = BitrixVue.localComponent('imbot-support24-question-component-question-list-question',{\n\tdirectives:\n\t{\n\t\tfocus:\n\t\t{\n\t\t\tinserted(element, params)\n\t\t\t{\n\t\t\t\telement.focus();\n\t\t\t}\n\t\t}\n\t},\n\tmixins: [Theme],\n\tprops: {\n\t\tid: Number,\n\t\ttitle: String,\n\t},\n\tdata: function() {\n\t\treturn {\n\t\t\tstate: QuestionState.DEFAULT,\n\t\t\tnewTitle: this.title,\n\t\t}\n\t},\n\tcomputed: {\n\t\tQuestionState: () => QuestionState,\n\t\tquestionClass()\n\t\t{\n\t\t\treturn this.getClassWithTheme('bx-imbot-support24-question-list-question');\n\t\t},\n\t\ttitleClass()\n\t\t{\n\t\t\treturn this.getClassWithTheme('bx-imbot-support24-question-list-question-title');\n\t\t},\n\t\tinputClass()\n\t\t{\n\t\t\treturn this.getClassWithTheme('bx-imbot-support24-question-list-question-input');\n\t\t},\n\t},\n\tmethods: {\n\t\tcallMethod(method, params)\n\t\t{\n\t\t\treturn this.$Bitrix.RestClient.get().callMethod(method, params);\n\t\t},\n\t\tclick()\n\t\t{\n\t\t\tif (this.state === QuestionState.EDIT)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.$emit('click', this.id);\n\t\t},\n\t\tedit(event: Event)\n\t\t{\n\t\t\tevent.stopPropagation();\n\n\t\t\tthis.state = QuestionState.EDIT;\n\t\t},\n\t\trename()\n\t\t{\n\t\t\tif (this.title === this.newTitle || this.newTitle.trim() === '')\n\t\t\t{\n\t\t\t\tthis.state = QuestionState.DEFAULT;\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst oldTitle =  this.title;\n\n\t\t\tthis.setTitleById(this.id, this.newTitle).then(() => {\n\t\t\t\tthis.setRecentListTitleById(this.id, this.newTitle);\n\t\t\t\tthis.state = QuestionState.DEFAULT;\n\t\t\t});\n\n\t\t\tthis.callMethod('im.chat.updateTitle', {\n\t\t\t\tCHAT_ID: this.id,\n\t\t\t\tTITLE: this.newTitle,\n\t\t\t}).catch(() => {\n\t\t\t\tthis.setRecentListTitleById(this.id, oldTitle);\n\t\t\t\tthis.setTitleById(this.id, oldTitle);\n\t\t\t});\n\t\t},\n\t\tsetTitleById(id, title)\n\t\t{\n\t\t\treturn this.$store.dispatch('question/setQuestionTitleById', {\n\t\t\t\tid,\n\t\t\t\ttitle,\n\t\t\t});\n\t\t},\n\t\tsetRecentListTitleById(id, title)\n\t\t{\n\t\t\tif (BXIM && BXIM.messenger && BXIM.messenger.chat && BXIM.messenger.chat[id])\n\t\t\t{\n\t\t\t\tBXIM.messenger.chat[id].name = Text.encode(title);\n\t\t\t\tBX.MessengerCommon.recentListRedraw();\n\t\t\t}\n\t\t},\n\t\tinputClick(event: Event)\n\t\t{\n\t\t\tevent.stopPropagation();\n\t\t}\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div :class=\"questionClass\" @click=\"click\">\n\t\t\t<template v-if=\"state === QuestionState.DEFAULT\">\n\t\t\t\t<div \n\t\t\t\t\tclass=\"\n\t\t\t\t\t\tbx-imbot-support24-question-list-question-icon\n\t\t\t\t\t\tbx-imbot-support24-question-list-question-icon-chat\n\t\t\t\t\t\"/>\n\n\t\t\t\t<div :class=\"titleClass\">\n\t\t\t\t\t{{ title }}\n\t\t\t\t</div>\n\n\t\t\t\t<div\n\t\t\t\t\tclass=\"\n\t\t\t\t\t\tbx-imbot-support24-question-list-question-icon\n\t\t\t\t\t\tbx-imbot-support24-question-list-question-icon-edit\n\t\t\t\t\t\"\n\t\t\t\t\t@click=\"edit\"\n\t\t\t\t/>\n\t\t\t</template>\n\n\t\t\t<template v-else-if=\"state === QuestionState.EDIT\">\n\t\t\t\t<div \n\t\t\t\t\tclass=\"ui-ctl ui-ctl-textbox ui-ctl-block ui-ctl-w100 ui-ctl-sm\"\n\t\t\t\t\t:class=\"inputClass\"\n\t\t\t\t>\n\t\t\t\t\t<input\n\t\t\t\t\t\tclass=\"ui-ctl-element\"\n\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t:class=\"inputClass\"\n\t\t\t\t\t\tv-model=\"newTitle\"\n\t\t\t\t\t\tv-focus\n\t\t\t\t\t\t@keydown.enter=\"rename\"\n\t\t\t\t\t\t@blur=\"rename\"\n\t\t\t\t\t\t@click=\"inputClick\"\n\t\t\t\t\t>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t</div>\n\t`\n});","export class Permissions\n{\n\t#isAdmin;\n\t#canAskQuestion;\n\t#canImproveTariff;\n\n\tconstructor(options)\n\t{\n\t\tthis.#isAdmin = Boolean(options.isAdmin);\n\t\tthis.#canAskQuestion = Boolean(options.canAskQuestion);\n\t\tthis.#canImproveTariff = Boolean(options.canImproveTariff);\n\t}\n\n\tget isAdmin(): boolean\n\t{\n\t\treturn this.#isAdmin;\n\t}\n\n\tget canAskQuestion(): boolean\n\t{\n\t\treturn this.#canAskQuestion;\n\t}\n\n\tget canImproveTariff(): boolean\n\t{\n\t\treturn this.#canImproveTariff;\n\t}\n}","import 'ui.design-tokens';\nimport 'ui.fonts.opensans';\nimport { BitrixVue } from 'ui.vue';\nimport { UI } from 'ui.notification';\nimport 'main.loader';\nimport 'ui.info-helper';\n\nimport { Search } from './search/search';\nimport { SearchEvent } from './search/search-event';\nimport { ButtonAsk, ButtonAskProps } from './button-ask/button-ask';\nimport { Question } from './question/question';\nimport { Theme } from '../../mixin/theme';\nimport { Permissions } from '../../lib/permissions';\n\nimport './question-list.css';\n\nconst QuestionListState = Object.freeze({\n\tDEFAULT: 'default',\n\tSEARCH: 'search',\n});\n\nexport const QuestionList = BitrixVue.localComponent('imbot-support24-question-component-question-list',{\n\tcomponents:\n\t{\n\t\tSearch,\n\t\tButtonAsk,\n\t\tQuestion,\n\t},\n\tdirectives:\n\t{\n\t\t'bx-imbot-directive-question-list-observer':\n\t\t{\n\t\t\tinserted(element, bindings, vnode)\n\t\t\t{\n\t\t\t\tvnode.context.loaderObserver = vnode.context.getLoaderObserver();\n\t\t\t\tvnode.context.loaderObserver.observe(element);\n\n\t\t\t\treturn true;\n\t\t\t},\n\t\t\tunbind(element, bindings, vnode)\n\t\t\t{\n\t\t\t\tif (vnode.context.loaderObserver)\n\t\t\t\t{\n\t\t\t\t\tvnode.context.loaderObserver.unobserve(element);\n\t\t\t\t}\n\n\t\t\t\treturn true;\n\t\t\t}\n\t\t},\n\t},\n\tmixins: [Theme],\n\tdata: function() {\n\t\treturn {\n\t\t\tstate: QuestionListState.DEFAULT,\n\t\t\tpermissions: null,\n\t\t\titemsPerPage: 50,\n\t\t\thistoryPageNumber: 0,\n\t\t\tsearchResultPageNumber: 0,\n\t\t\thasHistoryToLoad: false,\n\t\t\thasSearchResultToLoad: false,\n\t\t\tsearchQuery: '',\n\t\t\tsearchRequestCount: 0,\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tQuestionListState: () => QuestionListState,\n\t\tButtonAskProps: () => ButtonAskProps,\n\t\titems()\n\t\t{\n\t\t\tif (this.state === QuestionListState.DEFAULT)\n\t\t\t{\n\t\t\t\treturn this.$store.state.question.history;\n\t\t\t}\n\n\t\t\tif (this.isSearchFromCache)\n\t\t\t{\n\t\t\t\treturn this.$store.state.question.history\n\t\t\t\t\t.filter(question => question.title.toLowerCase().includes(this.searchQuery))\n\t\t\t\t;\n\t\t\t}\n\n\t\t\treturn this.$store.state.question.searchResult;\n\t\t},\n\t\tisEmpty()\n\t\t{\n\t\t\treturn this.items.length === 0;\n\t\t},\n\t\tisSearchFromCache()\n\t\t{\n\t\t\treturn (\n\t\t\t\tthis.state === QuestionListState.SEARCH\n\t\t\t\t&& this.searchQuery !== ''\n\t\t\t\t&& this.searchQuery.length < 3\n\t\t\t);\n\t\t},\n\t\tisLoadingInProgress()\n\t\t{\n\t\t\treturn this.searchRequestCount > 0;\n\t\t},\n\t\thistoryNavigationParams()\n\t\t{\n\t\t\treturn {\n\t\t\t\tlimit: this.itemsPerPage,\n\t\t\t\toffset: this.itemsPerPage * this.historyPageNumber,\n\t\t\t};\n\t\t},\n\t\tsearchNavigationParams()\n\t\t{\n\t\t\treturn {\n\t\t\t\tlimit: this.itemsPerPage,\n\t\t\t\toffset: this.itemsPerPage * this.searchResultPageNumber,\n\t\t\t};\n\t\t},\n\t\tshowTariffLock()\n\t\t{\n\t\t\treturn this.permissions && (!this.permissions.isAdmin || !this.permissions.canAskQuestion);\n\t\t},\n\t\tshowLoader()\n\t\t{\n\t\t\tif (this.state === QuestionListState.DEFAULT)\n\t\t\t{\n\t\t\t\treturn this.hasHistoryToLoad;\n\t\t\t}\n\n\t\t\tif (this.isSearchFromCache)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn this.hasSearchResultToLoad;\n\t\t},\n\t\tsearchFieldBorderClass()\n\t\t{\n\t\t\treturn this.getClassWithTheme('bx-imbot-support24-question-list-search-field-border');\n\t\t},\n\t\tlistItemsClass()\n\t\t{\n\t\t\treturn this.getClassWithTheme('bx-imbot-support24-question-list-items');\n\t\t},\n\t\temptyTitleClass()\n\t\t{\n\t\t\treturn this.getClassWithTheme('bx-imbot-support24-question-list-empty-title');\n\t\t},\n\t\temptyDescriptionClass()\n\t\t{\n\t\t\treturn this.getClassWithTheme('bx-imbot-support24-question-list-empty-description');\n\t\t},\n\t\tplaceholderTextClass()\n\t\t{\n\t\t\treturn this.getClassWithTheme('bx-imbot-support24-question-list-placeholder-text');\n\t\t},\n\t\tnotFoundIconClass()\n\t\t{\n\t\t\treturn this.getClassWithTheme('bx-imbot-support24-question-list-not-found-icon');\n\t\t},\n\t\tquestionListLoaderClass()\n\t\t{\n\t\t\treturn this.getClassWithTheme('bx-imbot-support24-question-list-items-loader-svg-circle');\n\t\t},\n\t\tquestionListSearchLoaderClass()\n\t\t{\n\t\t\treturn this.getClassWithTheme('bx-imbot-support24-question-list-items-search-loader-svg-circle');\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tthis.$store.dispatch('question/trimHistory', this.itemsPerPage).then(() => {\n\t\t\tconst initRequests = {\n\t\t\t\tconfig: {\n\t\t\t\t\tmethod: 'imbot.support24.question.config.get',\n\t\t\t\t},\n\t\t\t\tquestions: {\n\t\t\t\t\tmethod: 'imbot.support24.question.list',\n\t\t\t\t\tparams: this.historyNavigationParams,\n\t\t\t\t},\n\t\t\t};\n\n\t\t\tconst initCallback = (response) => {\n\t\t\t\tthis.permissions = new Permissions(response.config.data());\n\n\t\t\t\tthis.afterHistoryPageLoaded(response.questions);\n\t\t\t};\n\n\t\t\tthis.getRestClient().callBatch(initRequests, initCallback);\n\t\t});\n\t},\n\tmethods:\n\t{\n\t\tgetRestClient()\n\t\t{\n\t\t\treturn this.$Bitrix.RestClient.get();\n\t\t},\n\t\tsearchQuestions(event: SearchEvent)\n\t\t{\n\t\t\tthis.searchQuery = event.getData().searchQuery.toLowerCase();\n\n\t\t\tconst truncatedSearchQuery = this.searchQuery.trim();\n\n\t\t\tif (truncatedSearchQuery === '')\n\t\t\t{\n\t\t\t\tthis.state = QuestionListState.DEFAULT;\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.state = QuestionListState.SEARCH;\n\n\t\t\tif (truncatedSearchQuery.length < 3)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.searchRequestCount++;\n\n\t\t\tconst searchParams = {\n\t\t\t\tsearchQuery: this.searchQuery,\n\t\t\t\tlimit: this.itemsPerPage,\n\t\t\t};\n\n\t\t\tthis.getRestClient().callMethod('imbot.support24.question.search', searchParams)\n\t\t\t\t.then(response => {\n\t\t\t\t\tconst questions = response.data();\n\n\t\t\t\t\tif (this.searchRequestCount === 1)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$store.dispatch('question/setSearchResult', questions).then(() => {\n\t\t\t\t\t\t\tthis.searchResultPageNumber = 1;\n\t\t\t\t\t\t\tthis.hasSearchResultToLoad = questions.length >= this.itemsPerPage;\n\n\t\t\t\t\t\t\tthis.searchRequestCount--;\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.searchRequestCount--;\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.catch(() => {\n\t\t\t\t\tthis.searchRequestCount--;\n\t\t\t\t})\n\t\t\t;\n\t\t},\n\t\tloadNextPage()\n\t\t{\n\t\t\tif (this.state === QuestionListState.DEFAULT)\n\t\t\t{\n\t\t\t\tthis.loadNextHistoryPage();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.loadNextSearchPage();\n\t\t},\n\t\tloadNextHistoryPage()\n\t\t{\n\t\t\tthis.getRestClient().callMethod('imbot.support24.question.list', this.historyNavigationParams)\n\t\t\t\t.then(response => this.afterHistoryPageLoaded(response))\n\t\t\t;\n\t\t},\n\t\tloadNextSearchPage()\n\t\t{\n\t\t\tif (this.searchQuery === '')\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst params = {\n\t\t\t\tsearchQuery: this.searchQuery,\n\t\t\t\t...this.searchNavigationParams,\n\t\t\t};\n\n\t\t\tthis.getRestClient().callMethod('imbot.support24.question.search', params)\n\t\t\t\t.then(response => this.afterSearchPageLoaded(response))\n\t\t\t;\n\t\t},\n\t\tafterHistoryPageLoaded(response)\n\t\t{\n\t\t\tconst questions = response.data();\n\n\t\t\tthis.hasHistoryToLoad = questions.length >= this.itemsPerPage;\n\n\t\t\tconst addMethod =\n\t\t\t\tthis.historyPageNumber === 0\n\t\t\t\t\t? 'question/setHistory'\n\t\t\t\t\t: 'question/addHistory'\n\t\t\t;\n\n\t\t\tthis.$store.dispatch(addMethod, questions).then(() => {\n\t\t\t\tthis.historyPageNumber++;\n\t\t\t});\n\t\t},\n\t\tafterSearchPageLoaded(response)\n\t\t{\n\t\t\tconst questions = response.data();\n\n\t\t\tthis.hasSearchResultToLoad = questions.length >= this.itemsPerPage;\n\n\t\t\tconst addMethod =\n\t\t\t\tthis.searchResultPageNumber === 0\n\t\t\t\t\t? 'question/setSearchResult'\n\t\t\t\t\t: 'question/addSearchResult'\n\t\t\t;\n\n\t\t\tthis.$store.dispatch(addMethod, questions).then(() => {\n\t\t\t\tthis.searchResultPageNumber++;\n\t\t\t});\n\t\t},\n\t\tonAskQuestion()\n\t\t{\n\t\t\tif (!this.permissions)\n\t\t\t{\n\t\t\t\t//Access rights are not yet known\n\t\t\t\tthis.addQuestion();\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!this.permissions.isAdmin)\n\t\t\t{\n\t\t\t\tthis.sendRestrictionNotification();\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!this.permissions.canAskQuestion && this.permissions.canImproveTariff)\n\t\t\t{\n\t\t\t\tthis.openTariffSlider();\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.addQuestion();\n\t\t},\n\t\taddQuestion()\n\t\t{\n\t\t\tthis.getRestClient().callMethod('imbot.support24.question.add')\n\t\t\t\t.then(response => {\n\t\t\t\t\tconst dialogId = response.data();\n\t\t\t\t\tthis.openDialog(dialogId);\n\t\t\t\t})\n\t\t\t\t.catch(response => {\n\t\t\t\t\tif (!response.answer || !response.answer.error)\n\t\t\t\t\t{\n\t\t\t\t\t\tconsole.error(response);\n\t\t\t\t\t}\n\n\t\t\t\t\tconst errorCode = response.answer.error;\n\t\t\t\t\tswitch (errorCode)\n\t\t\t\t\t{\n\t\t\t\t\t\tcase 'ACCESS_DENIED':\n\t\t\t\t\t\t\tthis.sendRestrictionNotification();\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase 'QUESTION_LIMIT_EXCEEDED':\n\t\t\t\t\t\t\tthis.openTariffSlider();\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t;\n\t\t},\n\t\tsendRestrictionNotification()\n\t\t{\n\t\t\tUI.Notification.Center.notify({\n\t\t\t\tid: 'imbot_support24_question_list_restriction_not_admin',\n\t\t\t\tcontent: this.$Bitrix.Loc.getMessage('IMBOT_SUPPORT24_QUESTION_LIST_RESTRICTION_NOT_ADMIN'),\n\t\t\t\tautoHideDelay: 5000,\n\t\t\t});\n\t\t},\n\t\topenTariffSlider()\n\t\t{\n\t\t\tBX.UI.InfoHelper.show('limit_admin_multidialogues');\n\t\t},\n\t\topenDialog(dialogId)\n\t\t{\n\t\t\tconst popupContext = this.$Bitrix.Data.get('popupContext');\n\t\t\tif (popupContext)\n\t\t\t{\n\t\t\t\tpopupContext.closePopup();\n\t\t\t}\n\n\t\t\tBXIM.openMessenger('chat' + dialogId);\n\t\t},\n\t\tgetLoaderObserver()\n\t\t{\n\t\t\tconst options = {\n\t\t\t\troot: document.querySelector('.bx-imbot-support24-question-list-items'),\n\t\t\t\tthreshold: 0.01,\n\t\t\t};\n\n\t\t\tconst callback = (entries, observer) => {\n\t\t\t\tentries.forEach(entry => {\n\t\t\t\t\tif (\n\t\t\t\t\t\tentry.isIntersecting\n\t\t\t\t\t\t&& entry.intersectionRatio > 0.01\n\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.loadNextPage();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t};\n\n\t\t\treturn new IntersectionObserver(callback, options);\n\t\t},\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"bx-imbot-support24-question-list\">\n\t\t\t<template v-if=\"isLoadingInProgress\">\n\t\t\t\t<div class=\"bx-imbot-support24-question-list-search-field\">\n\t\t\t\t\t<div class=\"bx-imbot-support24-question-list-search-container\">\n\t\t\t\t\t\t<Search\n\t\t\t\t\t\t\t@search=\"searchQuestions\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"bx-imbot-support24-question-list-ask-container\">\n\t\t\t\t\t\t<ButtonAsk\n\t\t\t\t\t\t\t:type=\"ButtonAskProps.Type.SECONDARY\"\n\t\t\t\t\t\t\t@askQuestion=\"onAskQuestion\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"bx-imbot-support24-question-list-placeholder\">\n\t\t\t\t\t<div class=\"bx-imbot-support24-question-list-loading-icon\">\n\t\t\t\t\t\t<div class=\"main-ui-loader main-ui-show\" style=\"width: 45px; height: 45px;\" data-is-shown=\"true\">\n\t\t\t\t\t\t\t<svg class=\"main-ui-loader-svg\" viewBox=\"25 25 50 50\">\n\t\t\t\t\t\t\t\t<circle\n\t\t\t\t\t\t\t\t\tclass=\"main-ui-loader-svg-circle\"\n\t\t\t\t\t\t\t\t\t:class=\"questionListSearchLoaderClass\"\n\t\t\t\t\t\t\t\t\tcx=\"50\"\n\t\t\t\t\t\t\t\t\tcy=\"50\"\n\t\t\t\t\t\t\t\t\tr=\"20\"\n\t\t\t\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\t\t\t\tstroke-miterlimit=\"10\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div :class=\"placeholderTextClass\">\n\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('IMBOT_SUPPORT24_QUESTION_LIST_SEARCHING') }}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</template>\n\n\t\t\t<template v-else-if=\"isEmpty && state === QuestionListState.SEARCH\">\n\t\t\t\t<div class=\"bx-imbot-support24-question-list-search-field\">\n\t\t\t\t\t<div class=\"bx-imbot-support24-question-list-search-container\">\n\t\t\t\t\t\t<Search\n\t\t\t\t\t\t\t@search=\"searchQuestions\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"bx-imbot-support24-question-list-ask-container\">\n\t\t\t\t\t\t<ButtonAsk\n\t\t\t\t\t\t\t:type=\"ButtonAskProps.Type.SECONDARY\"\n\t\t\t\t\t\t\t@askQuestion=\"onAskQuestion\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"bx-imbot-support24-question-list-placeholder\">\n\t\t\t\t\t<div :class=\"notFoundIconClass\">:(</div>\n\t\t\t\t\t<div :class=\"placeholderTextClass\">\n\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('IMBOT_SUPPORT24_QUESTION_LIST_SEARCH_NOT_FOUND') }}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</template>\n\n\t\t\t<template v-else-if=\"!isEmpty\">\n\t\t\t\t<div \n\t\t\t\t\tclass=\"bx-imbot-support24-question-list-search-field\"\n\t\t\t\t\t:class=\"searchFieldBorderClass\"\n\t\t\t\t>\n\t\t\t\t\t<div class=\"bx-imbot-support24-question-list-search-container\">\n\t\t\t\t\t\t<Search\n\t\t\t\t\t\t\t@search=\"searchQuestions\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t\t\n\t\t\t\t\t<div class=\"bx-imbot-support24-question-list-ask-container\">\n\t\t\t\t\t\t<ButtonAsk\n\t\t\t\t\t\t\t:type=\"ButtonAskProps.Type.SECONDARY\"\n\t\t\t\t\t\t\t@askQuestion=\"onAskQuestion\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div :class=\"listItemsClass\">\n\t\t\t\t\t<Question\n\t\t\t\t\t\tv-for=\"item of items\"\n\t\t\t\t\t\t:key=\"item.id\"\n\t\t\t\t\t\t:id=\"item.id\"\n\t\t\t\t\t\t:title=\"item.title\"\n\t\t\t\t\t\t@click=\"openDialog\"\n\t\t\t\t\t/>\n\t\t\t\t\t\n\t\t\t\t\t<div \n\t\t\t\t\t\tclass=\"bx-imbot-support24-question-list-items-loader\"\n\t\t\t\t\t\tv-if=\"showLoader\" \n\t\t\t\t\t\t:key=\"'question-list-items-loader'\" \n\t\t\t\t\t\tv-bx-imbot-directive-question-list-observer\n\t\t\t\t\t>\n\t\t\t\t\t\t<div class=\"main-ui-loader main-ui-show\" style=\"width: 23px; height: 23px;\" data-is-shown=\"true\">\n\t\t\t\t\t\t\t<svg class=\"main-ui-loader-svg\" viewBox=\"25 25 50 50\">\n\t\t\t\t\t\t\t\t<circle \n\t\t\t\t\t\t\t\t\tclass=\"main-ui-loader-svg-circle\"\n\t\t\t\t\t\t\t\t\t:class=\"questionListLoaderClass\"\n\t\t\t\t\t\t\t\t\tcx=\"50\"\n\t\t\t\t\t\t\t\t\tcy=\"50\"\n\t\t\t\t\t\t\t\t\tr=\"20\"\n\t\t\t\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\t\t\t\tstroke-miterlimit=\"10\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t\t\n\t\t\t<div\n\t\t\t\tclass=\"bx-imbot-support24-question-list-empty\"\n\t\t\t\tv-else-if=\"isEmpty && state === QuestionListState.DEFAULT\"\n\t\t\t>\n\t\t\t\t<div :class=\"emptyTitleClass\">\n\t\t\t\t\t{{ $Bitrix.Loc.getMessage('IMBOT_SUPPORT24_QUESTION_LIST_EMPTY_TITLE') }}\n\t\t\t\t</div>\n\t\t\t\t<div :class=\"emptyDescriptionClass\">\n\t\t\t\t\t{{ $Bitrix.Loc.getMessage('IMBOT_SUPPORT24_QUESTION_LIST_EMPTY_DESCRIPTION') }}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"bx-imbot-support24-question-list-button-ask-container\">\n\t\t\t\t\t<ButtonAsk\n\t\t\t\t\t\t:type=\"ButtonAskProps.Type.PRIMARY\"\n\t\t\t\t\t\t@askQuestion=\"onAskQuestion\"\n\t\t\t\t\t/>\n\t\t\t\t\t<span \n\t\t\t\t\t\tclass=\"bx-imbot-support24-question-list-tariff-lock\"\n\t\t\t\t\t\tv-if=\"showTariffLock\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`\n});","import { BitrixVue } from 'ui.vue';\nimport { VuexBuilder } from 'ui.vue.vuex';\nimport { Loc, Dom } from 'main.core';\n\nimport { QuestionModel } from './model/question';\nimport { QuestionList } from './component/question-list/question-list';\n\nexport type QuestionOptions = {\n\tnodeId: string,\n\tpopupContext?: any,\n};\n\nexport class Question\n{\n\t#viewModel;\n\n\tconstructor(options: QuestionOptions)\n\t{\n\t\tthis.rootNode = document.getElementById(options.nodeId);\n\t\tthis.popupContext = options.popupContext ? options.popupContext : null;\n\n\t\tthis.createStorage()\n\t\t\t.then(builder => {\n\t\t\t\tconst store = builder.store;\n\n\t\t\t\tthis.createApplication(store);\n\t\t\t});\n\t}\n\n\tcreateStorage(): Promise\n\t{\n\t\tconst model =\n\t\t\tQuestionModel\n\t\t\t\t.create()\n\t\t\t\t.useDatabase(true)\n\t\t;\n\n\t\tconst databaseConfig = {\n\t\t\tname: 'imbot-support24-question',\n\t\t\ttype: VuexBuilder.DatabaseType.indexedDb,\n\t\t\tsiteId: Loc.getMessage('SITE_ID'),\n\t\t\tuserId: Loc.getMessage('USER_ID'),\n\t\t};\n\n\t\treturn new VuexBuilder()\n\t\t\t.addModel(model)\n\t\t\t.setDatabaseConfig(databaseConfig)\n\t\t\t.build()\n\t\t;\n\t}\n\n\tcreateApplication(store)\n\t{\n\t\tDom.clean(this.rootNode);\n\t\tDom.append(Dom.create('div'), this.rootNode);\n\n\t\tconst applicationContext = this;\n\t\tconst popupContext = this.popupContext;\n\n\t\tthis.#viewModel = BitrixVue.createApp({\n\t\t\tstore,\n\t\t\tcomponents:\n\t\t\t{\n\t\t\t\tQuestionList,\n\t\t\t},\n\t\t\tbeforeCreate()\n\t\t\t{\n\t\t\t\tthis.$bitrix.Application.set(applicationContext);\n\t\t\t\tthis.$bitrix.Data.set('popupContext', popupContext);\n\t\t\t},\n\t\t\ttemplate: `\n\t\t\t\t<QuestionList/>\n\t\t\t`,\n\t\t}).mount(this.rootNode.firstChild);\n\t}\n}"],"names":["QuestionModel","history","searchResult","trimHistory","store","count","commit","setHistory","payload","validateQuestionList","addHistory","setSearchResult","addSearchResult","setQuestionTitleById","state","filter","question","questionIndex","concat","find","id","title","questions","Type","isArrayFilled","isQuestion","Object","keys","length","isInteger","isString","VuexBuilderModel","SearchEvent","BaseEvent","Theme","computed","darkTheme","BX","MessengerTheme","isDark","methods","getClassWithTheme","baseClass","classWithTheme","Search","BitrixVue","localComponent","directives","focus","inserted","element","params","mixins","data","searchQuery","scheduleSearch","Runtime","debounce","search","inputClass","$emit","template","ButtonAskProps","freeze","SECONDARY","PRIMARY","ButtonAsk","props","type","String","lastQuestionTime","buttonClass","largeButtonColor","askQuestion","tenSeconds","Date","now","QuestionState","DEFAULT","EDIT","Question","Number","newTitle","questionClass","titleClass","callMethod","method","$Bitrix","RestClient","get","click","edit","event","stopPropagation","rename","trim","oldTitle","setTitleById","then","setRecentListTitleById","CHAT_ID","TITLE","$store","dispatch","BXIM","messenger","chat","name","Text","encode","MessengerCommon","recentListRedraw","inputClick","Permissions","options","Boolean","isAdmin","canAskQuestion","canImproveTariff","QuestionListState","SEARCH","QuestionList","components","bindings","vnode","context","loaderObserver","getLoaderObserver","observe","unbind","unobserve","permissions","itemsPerPage","historyPageNumber","searchResultPageNumber","hasHistoryToLoad","hasSearchResultToLoad","searchRequestCount","items","isSearchFromCache","toLowerCase","includes","isEmpty","isLoadingInProgress","historyNavigationParams","limit","offset","searchNavigationParams","showTariffLock","showLoader","searchFieldBorderClass","listItemsClass","emptyTitleClass","emptyDescriptionClass","placeholderTextClass","notFoundIconClass","questionListLoaderClass","questionListSearchLoaderClass","created","initRequests","config","initCallback","response","afterHistoryPageLoaded","getRestClient","callBatch","searchQuestions","getData","truncatedSearchQuery","searchParams","loadNextPage","loadNextHistoryPage","loadNextSearchPage","afterSearchPageLoaded","addMethod","onAskQuestion","addQuestion","sendRestrictionNotification","openTariffSlider","dialogId","openDialog","answer","error","console","errorCode","UI","Notification","Center","notify","content","Loc","getMessage","autoHideDelay","InfoHelper","show","popupContext","Data","closePopup","openMessenger","root","document","querySelector","threshold","callback","entries","observer","forEach","entry","isIntersecting","intersectionRatio","IntersectionObserver","rootNode","getElementById","nodeId","createStorage","builder","createApplication","model","create","useDatabase","databaseConfig","VuexBuilder","DatabaseType","indexedDb","siteId","userId","addModel","setDatabaseConfig","build","Dom","clean","append","applicationContext","createApp","beforeCreate","$bitrix","Application","set","mount","firstChild"],"mappings":"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"}