{"version":3,"file":"registry.bundle.js","sources":["../src/application/settings.js","../src/application.js","../src/messages/pin.js","../src/messages/reactions.js","../src/messages.js","../src/dialogues.js","../src/users.js","../src/files.js","../src/recent/calls.js","../src/recent.js","../src/notifications.js","../src/sidebar/links.js","../src/sidebar/favorites.js","../src/sidebar/members.js","../src/sidebar/tasks.js","../src/sidebar/meeting.js","../src/sidebar/files.js","../src/sidebar.js","../src/market.js"],"sourcesContent":["import {Type} from 'main.core';\nimport {BuilderModel, GetterTree, ActionTree, MutationTree} from 'ui.vue3.vuex';\n\nimport {Settings} from 'im.v2.const';\n\ntype SettingsState = {[settingName: string]: any};\n\nexport class SettingsModel extends BuilderModel\n{\n\tgetState()\n\t{\n\t\treturn {\n\t\t\t[Settings.application.darkTheme]: false,\n\t\t\t[Settings.application.enableSound]: true,\n\n\t\t\t[Settings.dialog.bigSmiles]: true,\n\t\t\t[Settings.dialog.background]: 1,\n\n\t\t\t[Settings.recent.showBirthday]: true,\n\t\t\t[Settings.recent.showInvited]: true,\n\t\t\t[Settings.recent.showLastMessage]: true,\n\t\t};\n\t}\n\n\tgetGetters(): GetterTree\n\t{\n\t\treturn {\n\t\t\tget: (state: SettingsState) => (key: string): any =>\n\t\t\t{\n\t\t\t\treturn state[key];\n\t\t\t}\n\t\t};\n\t}\n\n\tgetActions(): ActionTree\n\t{\n\t\treturn {\n\t\t\tset: (store, payload: {[settingName: string]: any}) =>\n\t\t\t{\n\t\t\t\tstore.commit('set', this.validate(payload));\n\t\t\t}\n\t\t};\n\t}\n\n\tgetMutations(): MutationTree\n\t{\n\t\treturn {\n\t\t\tset: (state: SettingsState, payload: {[settingName: string]: any}) => {\n\t\t\t\tObject.entries(payload).forEach(([key, value]) => {\n\t\t\t\t\tstate[key] = value;\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\t}\n\n\tvalidate(fields): {[settingName: string]: any}\n\t{\n\t\tconst result = {};\n\n\t\tif (Type.isBoolean(fields[Settings.application.darkTheme]))\n\t\t{\n\t\t\tresult[Settings.application.darkTheme] = fields[Settings.application.darkTheme];\n\t\t}\n\n\t\tif (Type.isBoolean(fields[Settings.application.enableSound]))\n\t\t{\n\t\t\tresult[Settings.application.enableSound] = fields[Settings.application.enableSound];\n\t\t}\n\n\t\tif (Type.isBoolean(fields[Settings.dialog.bigSmiles]))\n\t\t{\n\t\t\tresult[Settings.dialog.bigSmiles] = fields[Settings.dialog.bigSmiles];\n\t\t}\n\n\t\tif (Type.isStringFilled(fields[Settings.dialog.background]))\n\t\t{\n\t\t\tfields[Settings.dialog.background] = Number.parseInt(fields[Settings.dialog.background], 10);\n\t\t}\n\t\tif (Type.isNumber(fields[Settings.dialog.background]))\n\t\t{\n\t\t\tresult[Settings.dialog.background] = fields[Settings.dialog.background];\n\t\t}\n\n\t\tif (Type.isBoolean(fields[Settings.recent.showBirthday]))\n\t\t{\n\t\t\tresult[Settings.recent.showBirthday] = fields[Settings.recent.showBirthday];\n\t\t}\n\n\t\tif (Type.isBoolean(fields[Settings.recent.showInvited]))\n\t\t{\n\t\t\tresult[Settings.recent.showInvited] = fields[Settings.recent.showInvited];\n\t\t}\n\n\t\tif (Type.isBoolean(fields[Settings.recent.showLastMessage]))\n\t\t{\n\t\t\tresult[Settings.recent.showLastMessage] = fields[Settings.recent.showLastMessage];\n\t\t}\n\n\t\treturn result;\n\t}\n}","import {Type} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport {BuilderModel} from 'ui.vue3.vuex';\n\nimport {Layout, EventType} from 'im.v2.const';\n\nimport {SettingsModel} from './application/settings';\n\nexport class ApplicationModel extends BuilderModel\n{\n\tgetName()\n\t{\n\t\treturn 'application';\n\t}\n\n\tgetNestedModules(): { [moduleName: string]: BuilderModel }\n\t{\n\t\treturn {settings: SettingsModel};\n\t}\n\n\tgetState()\n\t{\n\t\treturn {\n\t\t\tlayout:\n\t\t\t{\n\t\t\t\tname: Layout.chat.name,\n\t\t\t\tentityId: '',\n\t\t\t\tcontextId: 0\n\t\t\t}\n\t\t};\n\t}\n\n\tgetGetters()\n\t{\n\t\treturn {\n\t\t\tgetLayout: state =>\n\t\t\t{\n\t\t\t\treturn state.layout;\n\t\t\t},\n\t\t\tisChatOpen: state => (dialogId: string): boolean =>\n\t\t\t{\n\t\t\t\tif (!state.layout.name === Layout.chat.name)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn state.layout.entityId === dialogId.toString();\n\t\t\t},\n\t\t\tareNotificationsOpen: state =>\n\t\t\t{\n\t\t\t\treturn state.layout.name === Layout.notification.name;\n\t\t\t}\n\t\t};\n\t}\n\n\tgetActions()\n\t{\n\t\treturn {\n\t\t\tsetLayout: (store, payload: {layoutName: string, entityId?: string, contextId?: number}) =>\n\t\t\t{\n\t\t\t\tconst {layoutName, entityId = '', contextId = 0} = payload;\n\t\t\t\tif (!Type.isStringFilled(layoutName))\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst previousLayout = {...store.state.layout};\n\t\t\t\tconst newLayout = {\n\t\t\t\t\tname: this.validateLayout(layoutName),\n\t\t\t\t\tentityId: this.validateLayoutEntityId(layoutName, entityId),\n\t\t\t\t\tcontextId: contextId\n\t\t\t\t};\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tlayout: newLayout\n\t\t\t\t});\n\n\t\t\t\tEventEmitter.emit(EventType.layout.onLayoutChange, {\n\t\t\t\t\tfrom: previousLayout,\n\t\t\t\t\tto: newLayout\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\t}\n\n\tgetMutations()\n\t{\n\t\treturn {\n\t\t\tupdate: (state, payload) => {\n\t\t\t\tObject.keys(payload).forEach((group) => {\n\t\t\t\t\tObject.entries(payload[group]).forEach(([key, value]) => {\n\t\t\t\t\t\tstate[group][key] = value;\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\t}\n\n\tvalidateLayout(layoutName: string): string\n\t{\n\t\tif (!Layout[layoutName])\n\t\t{\n\t\t\treturn Layout.chat.name;\n\t\t}\n\n\t\treturn layoutName;\n\t}\n\n\tvalidateLayoutEntityId(layoutName: string, entityId: string): string\n\t{\n\t\tif (!Layout[layoutName])\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\t// TODO check `entityId` by layout name\n\n\t\treturn entityId;\n\t}\n}","import {BuilderModel} from 'ui.vue3.vuex';\n\nimport {Core} from 'im.v2.application.core';\nimport {Logger} from 'im.v2.lib.logger';\n\nimport type {ImModelMessage} from 'im.v2.model';\n\nexport class PinModel extends BuilderModel\n{\n\tgetState()\n\t{\n\t\treturn {\n\t\t\tcollection: {}\n\t\t};\n\t}\n\n\tgetGetters(): Object\n\t{\n\t\treturn {\n\t\t\tgetPinned: (state: PinState) => (chatId: number): ImModelMessage[] =>\n\t\t\t{\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\treturn [...state.collection[chatId]].map(pinnedMessageId => {\n\t\t\t\t\treturn Core.getStore().getters['messages/getById'](pinnedMessageId);\n\t\t\t\t});\n\t\t\t},\n\t\t\tisPinned: (state: PinState) => (payload: {chatId: number, messageId: number}): boolean =>\n\t\t\t{\n\t\t\t\tconst {chatId, messageId} = payload;\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[chatId].has(messageId);\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions(): Object\n\t{\n\t\treturn {\n\t\t\tsetPinned: (store, payload: {chatId: number, pinnedMessages: number[]}) =>\n\t\t\t{\n\t\t\t\tconst {chatId, pinnedMessages} = payload;\n\t\t\t\tif (pinnedMessages.length === 0)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setPinned', {\n\t\t\t\t\tchatId,\n\t\t\t\t\tpinnedMessageIds: pinnedMessages\n\t\t\t\t});\n\t\t\t},\n\t\t\tset: (store, payload: {chatId: number, messageId: number, action: boolean}) =>\n\t\t\t{\n\t\t\t\tstore.commit('set', payload);\n\t\t\t},\n\t\t\tadd: (store, payload: {chatId: number, messageId: number}) =>\n\t\t\t{\n\t\t\t\tstore.commit('add', payload);\n\t\t\t},\n\t\t\tdelete: (store, payload: {chatId: number, messageId: number}) =>\n\t\t\t{\n\t\t\t\tstore.commit('delete', payload);\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMutations(): Object\n\t{\n\t\treturn {\n\t\t\tsetPinned: (state: PinState, payload: {chatId: number, pinnedMessageIds: number[]}) =>\n\t\t\t{\n\t\t\t\tLogger.warn('Messages/pin model: setPinned mutation', payload);\n\t\t\t\tconst {chatId, pinnedMessageIds} = payload;\n\t\t\t\tstate.collection[chatId] = new Set(pinnedMessageIds.reverse());\n\t\t\t},\n\t\t\tadd: (state: PinState, payload: {chatId: number, messageId: number}) =>\n\t\t\t{\n\t\t\t\tLogger.warn('Messages/pin model: add pin mutation', payload);\n\t\t\t\tconst {chatId, messageId} = payload;\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\tstate.collection[chatId] = new Set();\n\t\t\t\t}\n\n\t\t\t\tstate.collection[chatId].add(messageId);\n\t\t\t},\n\t\t\tdelete: (state: PinState, payload: {chatId: number, messageId: number}) =>\n\t\t\t{\n\t\t\t\tLogger.warn('Messages/pin model: delete pin mutation', payload);\n\t\t\t\tconst {chatId, messageId} = payload;\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstate.collection[chatId].delete(messageId);\n\t\t\t}\n\t\t};\n\t}\n}\n\ntype PinState = {\n\tcollection: {\n\t\t[chatId: string]: Set\n\t}\n};","import {BuilderModel} from 'ui.vue3.vuex';\nimport {reactionType as Reaction} from 'ui.reactions-select';\n\nimport {Core} from 'im.v2.application.core';\n\nimport type {Store, GetterTree, ActionTree, MutationTree} from 'ui.vue3.vuex';\nimport type {ImModelReactions} from 'im.v2.model';\n\ntype ReactionType = $Values<typeof Reaction>;\n\ntype RawReactions = {\n\tmessageId: number,\n\treactionCounters: {[reactionType: string]: number},\n\treactionUsers: {[reactionType: string]: number[]},\n\townReactions: ReactionType[]\n};\ntype RawReactionsList = RawReactions[];\n\ntype ReactionsState = {\n\tcollection: {\n\t\t[messageId: string]: ImModelReactions\n\t}\n};\n\nconst USERS_TO_SHOW = 5;\n\nexport class ReactionsModel extends BuilderModel\n{\n\tgetState(): ReactionsState\n\t{\n\t\treturn {\n\t\t\tcollection: {}\n\t\t};\n\t}\n\n\tgetElementState()\n\t{\n\t\treturn {\n\t\t\treactionCounters: {},\n\t\t\treactionUsers: {},\n\t\t\townReactions: new Set()\n\t\t};\n\t}\n\n\tgetGetters(): GetterTree\n\t{\n\t\treturn {\n\t\t\tgetByMessageId: (state: ReactionsState) => (messageId: number): ?ImModelReactions =>\n\t\t\t{\n\t\t\t\treturn state.collection[messageId];\n\t\t\t}\n\t\t};\n\t}\n\n\tgetActions(): ActionTree\n\t{\n\t\treturn {\n\t\t\tset: (store: Store, payload: RawReactionsList) =>\n\t\t\t{\n\t\t\t\tstore.commit('set', this.prepareSetPayload(payload));\n\t\t\t},\n\t\t\tsetReaction: (\n\t\t\t\tstore: Store,\n\t\t\t\tpayload: {messageId: number, userId: number, reaction: ReactionType}\n\t\t\t) =>\n\t\t\t{\n\t\t\t\tif (!Reaction[payload.reaction])\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (!store.state.collection[payload.messageId])\n\t\t\t\t{\n\t\t\t\t\tstore.state.collection[payload.messageId] = this.getElementState();\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setReaction', payload);\n\t\t\t},\n\t\t\tremoveReaction: (\n\t\t\t\tstore: Store,\n\t\t\t\tpayload: {messageId: number, userId: number, reaction: ReactionType}\n\t\t\t) =>\n\t\t\t{\n\t\t\t\tif (!store.state.collection[payload.messageId] || !Reaction[payload.reaction])\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tstore.commit('removeReaction', payload);\n\t\t\t}\n\t\t};\n\t}\n\n\tgetMutations(): MutationTree\n\t{\n\t\treturn {\n\t\t\tset: (state: ReactionsState, payload: RawReactionsList) =>\n\t\t\t{\n\t\t\t\tpayload.forEach(item => {\n\t\t\t\t\tconst newItem = {\n\t\t\t\t\t\treactionCounters: item.reactionCounters,\n\t\t\t\t\t\treactionUsers: item.reactionUsers\n\t\t\t\t\t};\n\n\t\t\t\t\tconst currentItem = state.collection[item.messageId];\n\t\t\t\t\tconst newOwnReaction = !!item.ownReactions;\n\t\t\t\t\tif (newOwnReaction)\n\t\t\t\t\t{\n\t\t\t\t\t\tnewItem.ownReactions = item.ownReactions;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tnewItem.ownReactions = currentItem ? currentItem.ownReactions : new Set();\n\t\t\t\t\t}\n\n\t\t\t\t\tstate.collection[item.messageId] = newItem;\n\t\t\t\t});\n\t\t\t},\n\t\t\tsetReaction: (\n\t\t\t\tstate: ReactionsState,\n\t\t\t\tpayload: {messageId: number, userId: number, reaction: ReactionType}\n\t\t\t) =>\n\t\t\t{\n\t\t\t\tconst {messageId, userId, reaction} = payload;\n\t\t\t\tconst reactions = state.collection[messageId];\n\t\t\t\tif (Core.getUserId() === userId)\n\t\t\t\t{\n\t\t\t\t\tthis.removeAllCurrentUserReactions(reactions);\n\t\t\t\t\treactions.ownReactions.add(reaction);\n\t\t\t\t}\n\n\t\t\t\tif (!reactions.reactionCounters[reaction])\n\t\t\t\t{\n\t\t\t\t\treactions.reactionCounters[reaction] = 0;\n\t\t\t\t}\n\t\t\t\tconst currentCounter = reactions.reactionCounters[reaction];\n\t\t\t\tif (currentCounter + 1 <= USERS_TO_SHOW)\n\t\t\t\t{\n\t\t\t\t\tif (!reactions.reactionUsers[reaction])\n\t\t\t\t\t{\n\t\t\t\t\t\treactions.reactionUsers[reaction] = new Set();\n\t\t\t\t\t}\n\t\t\t\t\treactions.reactionUsers[reaction].add(userId);\n\t\t\t\t}\n\n\t\t\t\treactions.reactionCounters[reaction]++;\n\t\t\t},\n\t\t\tremoveReaction: (\n\t\t\t\tstate: ReactionsState,\n\t\t\t\tpayload: {messageId: number, userId: number, reaction: ReactionType}\n\t\t\t) =>\n\t\t\t{\n\t\t\t\tconst {messageId, userId, reaction} = payload;\n\t\t\t\tconst reactions = state.collection[messageId];\n\n\t\t\t\tif (Core.getUserId() === userId)\n\t\t\t\t{\n\t\t\t\t\treactions.ownReactions.delete(reaction);\n\t\t\t\t}\n\n\t\t\t\treactions.reactionUsers[reaction]?.delete(userId);\n\t\t\t\treactions.reactionCounters[reaction]--;\n\t\t\t\tif (reactions.reactionCounters[reaction] === 0)\n\t\t\t\t{\n\t\t\t\t\tdelete reactions.reactionCounters[reaction];\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t}\n\n\tremoveAllCurrentUserReactions(reactions: ImModelReactions)\n\t{\n\t\treactions.ownReactions.forEach(reaction => {\n\t\t\treactions.reactionUsers[reaction]?.delete(Core.getUserId());\n\t\t\treactions.reactionCounters[reaction]--;\n\t\t\tif (reactions.reactionCounters[reaction] === 0)\n\t\t\t{\n\t\t\t\tdelete reactions.reactionCounters[reaction];\n\t\t\t}\n\t\t});\n\n\t\treactions.ownReactions = new Set();\n\t}\n\n\tprepareSetPayload(payload: RawReactionsList)\n\t{\n\t\treturn payload.map(item => {\n\t\t\tconst reactionUsers = {};\n\t\t\tObject.entries(item.reactionUsers).forEach(([reaction, users]) => {\n\t\t\t\treactionUsers[reaction] = new Set(users);\n\t\t\t});\n\n\t\t\tconst reactionCounters = {};\n\t\t\tObject.entries(item.reactionCounters).forEach(([reaction, counter]) => {\n\t\t\t\treactionCounters[reaction] = counter;\n\t\t\t});\n\n\t\t\tconst result = {\n\t\t\t\tmessageId: item.messageId,\n\t\t\t\treactionCounters: reactionCounters,\n\t\t\t\treactionUsers: reactionUsers\n\t\t\t};\n\n\t\t\tif (item.ownReactions?.length > 0)\n\t\t\t{\n\t\t\t\tresult.ownReactions = new Set(item.ownReactions);\n\t\t\t}\n\n\t\t\treturn result;\n\t\t});\n\t}\n}","import {Type} from 'main.core';\nimport {BuilderModel} from 'ui.vue3.vuex';\n\nimport {Core} from 'im.v2.application.core';\nimport {Utils} from 'im.v2.lib.utils';\nimport {Logger} from 'im.v2.lib.logger';\nimport {MessageComponent, MessageType} from 'im.v2.const';\n\nimport {PinModel} from './messages/pin';\nimport {ReactionsModel} from './messages/reactions';\n\nimport type {ImModelMessage, ImModelFile} from 'im.v2.model';\nimport type {AttachConfig} from 'im.v2.const';\n\ntype MessagesState = {\n\tcollection: {\n\t\t[messageId: string]: ImModelMessage\n\t},\n\tchatCollection: {\n\t\t[chatId: string]: Set\n\t}\n};\n\ntype RawMessageParams = {\n\tCOMPONENT_ID?: string,\n\tFILE_ID?: number[],\n\tIS_EDITED?: 'Y' | 'N',\n\tIS_DELETED?: 'Y' | 'N',\n\tATTACH?: AttachConfig[]\n};\n\ntype PreparedMessageParams = {\n\tcomponentId: string,\n\tfiles: number[],\n\tisEdited: boolean,\n\tisDeleted: boolean,\n\tattach: AttachConfig[]\n};\n\nexport class MessagesModel extends BuilderModel\n{\n\tgetName()\n\t{\n\t\treturn 'messages';\n\t}\n\n\tgetNestedModules(): { [moduleName: string]: BuilderModel }\n\t{\n\t\treturn {\n\t\t\tpin: PinModel,\n\t\t\treactions: ReactionsModel\n\t\t};\n\t}\n\n\tgetState()\n\t{\n\t\treturn {\n\t\t\tcollection: {},\n\t\t\tchatCollection: {}\n\t\t};\n\t}\n\n\tgetElementState()\n\t{\n\t\treturn {\n\t\t\tid: 0,\n\t\t\tchatId: 0,\n\t\t\tauthorId: 0,\n\t\t\tdate: new Date(),\n\t\t\ttext: '',\n\t\t\treplaces: [],\n\t\t\tfiles: [],\n\t\t\tattach: [],\n\t\t\tunread: false,\n\t\t\tviewed: true,\n\t\t\tviewedByOthers: false,\n\t\t\tsending: false,\n\t\t\terror: false,\n\t\t\tretry: false,\n\t\t\tcomponentId: MessageComponent.base,\n\t\t\tisEdited: false,\n\t\t\tisDeleted: false,\n\t\t\tremoveLinks: false\n\t\t};\n\t}\n\n\tgetGetters()\n\t{\n\t\treturn {\n\t\t\tget: (state: MessagesState) => chatId =>\n\t\t\t{\n\t\t\t\tif (!state.chatCollection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\treturn [...state.chatCollection[chatId]].map(messageId => {\n\t\t\t\t\treturn state.collection[messageId];\n\t\t\t\t}).sort((a, b) => {\n\t\t\t\t\treturn a.id - b.id;\n\t\t\t\t});\n\t\t\t},\n\t\t\tgetById: (state: MessagesState) => (id: number): ?ImModelMessage =>\n\t\t\t{\n\t\t\t\treturn state.collection[id];\n\t\t\t},\n\t\t\tgetByIdList: (state: MessagesState) => (idList: number[]): ImModelMessage[] =>\n\t\t\t{\n\t\t\t\tconst result = [];\n\t\t\t\tidList.forEach(id => {\n\t\t\t\t\tif (state.collection[id])\n\t\t\t\t\t{\n\t\t\t\t\t\tresult.push(state.collection[id]);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\treturn result;\n\t\t\t},\n\t\t\thasMessage: (state: MessagesState) => ({chatId, messageId}) =>\n\t\t\t{\n\t\t\t\tif (!state.chatCollection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn state.chatCollection[chatId].has(messageId);\n\t\t\t},\n\t\t\tisInChatCollection: (state: MessagesState) => (payload: {messageId: number}): boolean =>\n\t\t\t{\n\t\t\t\tconst {messageId} = payload;\n\t\t\t\tconst message = state.collection[messageId];\n\t\t\t\tif (!message)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tconst {chatId} = message;\n\n\t\t\t\treturn state.chatCollection[chatId]?.has(messageId);\n\t\t\t},\n\t\t\tgetFirstId: (state: MessagesState) => chatId =>\n\t\t\t{\n\t\t\t\tif (!state.chatCollection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\treturn this.#findLowestMessageId(state, chatId);\n\t\t\t},\n\t\t\tgetLastId: (state: MessagesState) => chatId =>\n\t\t\t{\n\t\t\t\tif (!state.chatCollection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\treturn this.#findMaxMessageId(state, chatId);\n\t\t\t},\n\t\t\tgetLastOwnMessageId: (state: MessagesState) => (chatId): number =>\n\t\t\t{\n\t\t\t\tif (!state.chatCollection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn this.#findLastOwnMessageId(state, chatId);\n\t\t\t},\n\t\t\tgetFirstUnread: (state: MessagesState) => (chatId: number): number =>\n\t\t\t{\n\t\t\t\tif (!state.chatCollection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn this.#findFirstUnread(state, chatId);\n\t\t\t},\n\t\t\tgetChatUnreadMessages: (state: MessagesState) => (chatId: number): ImModelMessage[] =>\n\t\t\t{\n\t\t\t\tif (!state.chatCollection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\tconst messages = [...state.chatCollection[chatId]].map(messageId => {\n\t\t\t\t\treturn state.collection[messageId];\n\t\t\t\t});\n\n\t\t\t\treturn messages.filter((message: ImModelMessage) => {\n\t\t\t\t\treturn message.unread === true;\n\t\t\t\t});\n\t\t\t},\n\t\t\tgetMessageFiles: (state: MessagesState) => (payload: number): ImModelFile[] =>\n\t\t\t{\n\t\t\t\tconst messageId = payload;\n\t\t\t\tif (!state.collection[messageId])\n\t\t\t\t{\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[messageId].files.map(fileId => {\n\t\t\t\t\treturn this.store.getters['files/get'](fileId, true);\n\t\t\t\t});\n\t\t\t},\n\t\t\tgetMessageType: (state: MessagesState) => (payload: number): ?$Values<typeof MessageType> =>\n\t\t\t{\n\t\t\t\tconst message = state.collection[payload];\n\t\t\t\tif (!message)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst currentUserId = Core.getUserId();\n\t\t\t\tif (message.authorId === 0)\n\t\t\t\t{\n\t\t\t\t\treturn MessageType.system;\n\t\t\t\t}\n\t\t\t\telse if (message.authorId === currentUserId)\n\t\t\t\t{\n\t\t\t\t\treturn MessageType.self;\n\t\t\t\t}\n\n\t\t\t\treturn MessageType.opponent;\n\t\t\t}\n\t\t};\n\t}\n\n\tgetActions()\n\t{\n\t\treturn {\n\t\t\tsetChatCollection: (store, payload: {messages: Array, clearCollection: boolean}) =>\n\t\t\t{\n\t\t\t\tlet {messages, clearCollection} = payload;\n\t\t\t\tclearCollection = clearCollection ?? false;\n\t\t\t\tif (!Array.isArray(messages) && Type.isPlainObject(messages))\n\t\t\t\t{\n\t\t\t\t\tmessages = [messages];\n\t\t\t\t}\n\n\t\t\t\tmessages = messages.map(message => {\n\t\t\t\t\treturn {...this.getElementState(), ...this.validate(message)};\n\t\t\t\t});\n\n\t\t\t\tconst chatId = messages[0]?.chatId;\n\t\t\t\tif (chatId && clearCollection)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('clearCollection', {chatId});\n\t\t\t\t}\n\n\t\t\t\tstore.commit('store', {messages});\n\t\t\t\tstore.commit('setChatCollection', {messages});\n\t\t\t},\n\t\t\tstore: (store, payload: Object | Object[]) =>\n\t\t\t{\n\t\t\t\tif (!Array.isArray(payload) && Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\tpayload = [payload];\n\t\t\t\t}\n\n\t\t\t\tpayload = payload.map(message => {\n\t\t\t\t\treturn {...this.getElementState(), ...this.validate(message)};\n\t\t\t\t});\n\n\t\t\t\tif (payload.length === 0)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('store', {\n\t\t\t\t\tmessages: payload\n\t\t\t\t});\n\t\t\t},\n\t\t\tadd: (store, payload: Object) =>\n\t\t\t{\n\t\t\t\tconst message = {\n\t\t\t\t\t...this.getElementState(),\n\t\t\t\t\t...this.validate(payload),\n\t\t\t\t};\n\t\t\t\tstore.commit('store', {\n\t\t\t\t\tmessages: [message]\n\t\t\t\t});\n\t\t\t\tstore.commit('setChatCollection', {\n\t\t\t\t\tmessages: [message]\n\t\t\t\t});\n\n\t\t\t\treturn message.id;\n\t\t\t},\n\t\t\tupdateWithId: (store, payload: {id: string | number, fields: Object}) =>\n\t\t\t{\n\t\t\t\tconst {id, fields} = payload;\n\t\t\t\tif (!store.state.collection[id])\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('updateWithId', {\n\t\t\t\t\tid,\n\t\t\t\t\tfields: this.validate(fields)\n\t\t\t\t});\n\t\t\t},\n\t\t\tupdate: (store, payload: {id: string | number, fields: Object}) =>\n\t\t\t{\n\t\t\t\tconst {id, fields} = payload;\n\t\t\t\tconst currentMessage = store.state.collection[id];\n\t\t\t\tif (!currentMessage)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tid,\n\t\t\t\t\tfields: {...currentMessage, ...this.validate(fields)}\n\t\t\t\t});\n\t\t\t},\n\t\t\treadMessages: (store, payload: {chatId: number, messageIds: number[]}): number =>\n\t\t\t{\n\t\t\t\tconst {chatId, messageIds} = payload;\n\t\t\t\tif (!store.state.chatCollection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\tconst chatMessages = [...store.state.chatCollection[chatId]].map((messageId: number) => {\n\t\t\t\t\treturn store.state.collection[messageId];\n\t\t\t\t});\n\n\t\t\t\tlet messagesToReadCount = 0;\n\t\t\t\tconst maxMessageId = this.#getMaxMessageId(messageIds);\n\t\t\t\tconst messageIdsToView = messageIds;\n\t\t\t\tconst messageIdsToRead = [];\n\t\t\t\tchatMessages.forEach((chatMessage: ImModelMessage) => {\n\t\t\t\t\tif (!chatMessage.unread)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (chatMessage.id <= maxMessageId)\n\t\t\t\t\t{\n\t\t\t\t\t\tmessagesToReadCount++;\n\t\t\t\t\t\tmessageIdsToRead.push(chatMessage.id);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tstore.commit('readMessages', {\n\t\t\t\t\tmessageIdsToRead,\n\t\t\t\t\tmessageIdsToView\n\t\t\t\t});\n\n\t\t\t\treturn messagesToReadCount;\n\t\t\t},\n\t\t\tsetViewedByOthers: (store, payload: {ids: number[]}): number =>\n\t\t\t{\n\t\t\t\tconst {ids} = payload;\n\t\t\t\tstore.commit('setViewedByOthers', {\n\t\t\t\t\tids\n\t\t\t\t});\n\t\t\t},\n\t\t\tdelete: (store, payload: {id: string | number}) =>\n\t\t\t{\n\t\t\t\tconst {id} = payload;\n\t\t\t\tif (!store.state.collection[id])\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('delete', {id});\n\t\t\t},\n\t\t\tclearChatCollection: (store, payload: {chatId: number}) =>\n\t\t\t{\n\t\t\t\tconst {chatId} = payload;\n\t\t\t\tstore.commit('clearCollection', {chatId});\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMutations()\n\t{\n\t\treturn {\n\t\t\tsetChatCollection: (state: MessagesState, payload: {messages: ImModelMessage[]}) =>\n\t\t\t{\n\t\t\t\tLogger.warn('Messages model: setChatCollection mutation', payload);\n\t\t\t\tpayload.messages.forEach(message => {\n\t\t\t\t\tif (!state.chatCollection[message.chatId])\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.chatCollection[message.chatId] = new Set();\n\t\t\t\t\t}\n\t\t\t\t\tstate.chatCollection[message.chatId].add(message.id);\n\t\t\t\t});\n\t\t\t},\n\t\t\tstore: (state: MessagesState, payload: {messages: ImModelMessage[]}) =>\n\t\t\t{\n\t\t\t\tLogger.warn('Messages model: store mutation', payload);\n\t\t\t\tpayload.messages.forEach(message => {\n\t\t\t\t\tstate.collection[message.id] = message;\n\t\t\t\t});\n\t\t\t},\n\t\t\tupdateWithId: (state: MessagesState, payload: {id: number | string, fields: Object}) =>\n\t\t\t{\n\t\t\t\tLogger.warn('Messages model: updateWithId mutation', payload);\n\t\t\t\tconst {id, fields} = payload;\n\t\t\t\tconst currentMessage = {...state.collection[id]};\n\n\t\t\t\tdelete state.collection[id];\n\t\t\t\tstate.collection[fields.id] = {...currentMessage, ...fields, sending: false};\n\n\t\t\t\tif (state.chatCollection[currentMessage.chatId].has(id))\n\t\t\t\t{\n\t\t\t\t\tstate.chatCollection[currentMessage.chatId].delete(id);\n\t\t\t\t\tstate.chatCollection[currentMessage.chatId].add(fields.id);\n\t\t\t\t}\n\t\t\t},\n\t\t\tupdate: (state: MessagesState, payload: {id: number | string, fields: Object}) =>\n\t\t\t{\n\t\t\t\tLogger.warn('Messages model: update mutation', payload);\n\t\t\t\tconst {id, fields} = payload;\n\t\t\t\tstate.collection[id] = {...state.collection[id], ...fields};\n\t\t\t},\n\t\t\tdelete: (state: MessagesState, payload: {id: number | string}) =>\n\t\t\t{\n\t\t\t\tLogger.warn('Messages model: delete mutation', payload);\n\t\t\t\tconst {id} = payload;\n\t\t\t\tconst {chatId} = state.collection[id];\n\t\t\t\tstate.chatCollection[chatId].delete(id);\n\t\t\t\tdelete state.collection[id];\n\t\t\t},\n\t\t\tclearCollection: (state: MessagesState, payload: {chatId: number}) =>\n\t\t\t{\n\t\t\t\tLogger.warn('Messages model: clear collection mutation', payload.chatId);\n\t\t\t\tstate.chatCollection[payload.chatId] = new Set();\n\t\t\t},\n\t\t\treadMessages: (state: MessagesState, payload: {messageIdsToRead: number[], messageIdsToView: number[]}) =>\n\t\t\t{\n\t\t\t\tconst {messageIdsToRead, messageIdsToView} = payload;\n\t\t\t\tmessageIdsToRead.forEach(messageId => {\n\t\t\t\t\tconst message = state.collection[messageId];\n\t\t\t\t\tif (!message)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tmessage.unread = false;\n\t\t\t\t});\n\t\t\t\tmessageIdsToView.forEach(messageId => {\n\t\t\t\t\tconst message = state.collection[messageId];\n\t\t\t\t\tif (!message)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tmessage.viewed = true;\n\t\t\t\t});\n\t\t\t},\n\t\t\tsetViewedByOthers: (state: MessagesState, payload: {ids: number[]}) =>\n\t\t\t{\n\t\t\t\tconst {ids} = payload;\n\t\t\t\tids.forEach(id => {\n\t\t\t\t\tconst message = state.collection[id];\n\t\t\t\t\tif (!message)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tconst isOwnMessage = message.authorId === Core.getUserId();\n\t\t\t\t\tif (!isOwnMessage || message.viewedByOthers)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tmessage.viewedByOthers = true;\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\t}\n\n\tvalidate(fields: Object): Object\n\t{\n\t\tlet result = {};\n\n\t\tif (Type.isNumber(fields.id))\n\t\t{\n\t\t\tresult.id = fields.id;\n\t\t}\n\t\telse if (Utils.text.isUuidV4(fields.temporaryId))\n\t\t{\n\t\t\tresult.id = fields.temporaryId;\n\t\t}\n\n\t\tif (!Type.isUndefined(fields.chat_id))\n\t\t{\n\t\t\tfields.chatId = fields.chat_id;\n\t\t}\n\t\tif (Type.isNumber(fields.chatId) || Type.isStringFilled(fields.chatId))\n\t\t{\n\t\t\tresult.chatId = Number.parseInt(fields.chatId, 10);\n\t\t}\n\n\t\tif (Type.isStringFilled(fields.date))\n\t\t{\n\t\t\tresult.date = Utils.date.cast(fields.date);\n\t\t}\n\n\t\tif (Type.isNumber(fields.text) || Type.isString(fields.text))\n\t\t{\n\t\t\tresult.text = fields.text.toString();\n\t\t}\n\n\t\tif (Type.isStringFilled(fields.system))\n\t\t{\n\t\t\tfields.isSystem = fields.system === 'Y';\n\t\t}\n\n\t\tif (!Type.isUndefined(fields.senderId))\n\t\t{\n\t\t\tfields.authorId = fields.senderId;\n\t\t}\n\t\telse if (!Type.isUndefined(fields.author_id))\n\t\t{\n\t\t\tfields.authorId = fields.author_id;\n\t\t}\n\t\tif (Type.isNumber(fields.authorId) || Type.isStringFilled(fields.authorId))\n\t\t{\n\t\t\tresult.authorId = Number.parseInt(fields.authorId, 10);\n\t\t}\n\n\t\tif (fields.isSystem === true)\n\t\t{\n\t\t\tresult.authorId = 0;\n\t\t}\n\n\t\tif (Type.isArray(fields.replaces))\n\t\t{\n\t\t\tresult.replaces = fields.replaces;\n\t\t}\n\n\t\tif (Type.isBoolean(fields.sending))\n\t\t{\n\t\t\tresult.sending = fields.sending;\n\t\t}\n\n\t\tif (Type.isBoolean(fields.unread))\n\t\t{\n\t\t\tresult.unread = fields.unread;\n\t\t}\n\n\t\tif (Type.isBoolean(fields.viewed))\n\t\t{\n\t\t\tresult.viewed = fields.viewed;\n\t\t}\n\n\t\tif (Type.isBoolean(fields.viewedByOthers))\n\t\t{\n\t\t\tresult.viewedByOthers = fields.viewedByOthers;\n\t\t}\n\n\t\tif (Type.isBoolean(fields.error))\n\t\t{\n\t\t\tresult.error = fields.error;\n\t\t}\n\n\t\tif (Type.isBoolean(fields.retry))\n\t\t{\n\t\t\tresult.retry = fields.retry;\n\t\t}\n\n\t\tif (Type.isString(fields.componentId))\n\t\t{\n\t\t\tresult.componentId = fields.componentId;\n\t\t}\n\n\t\tif (Type.isArray(fields.files))\n\t\t{\n\t\t\tresult.files = fields.files;\n\t\t}\n\n\t\tif (Type.isArray(fields.attach))\n\t\t{\n\t\t\tresult.attach = fields.attach;\n\t\t}\n\n\t\tif (Type.isBoolean(fields.isEdited))\n\t\t{\n\t\t\tresult.isEdited = fields.isEdited;\n\t\t}\n\n\t\tif (Type.isBoolean(fields.isDeleted))\n\t\t{\n\t\t\tresult.isDeleted = fields.isDeleted;\n\t\t}\n\n\t\tif (Type.isBoolean(fields.removeLinks))\n\t\t{\n\t\t\tresult.removeLinks = fields.removeLinks;\n\t\t}\n\n\t\tif (Type.isPlainObject(fields.params))\n\t\t{\n\t\t\tconst preparedParams = this.prepareParams(fields.params);\n\t\t\tresult = {...result, ...preparedParams};\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tprepareParams(rawParams: RawMessageParams): PreparedMessageParams\n\t{\n\t\tconst result = {};\n\n\t\tObject.entries(rawParams).forEach(([key, value]) => {\n\t\t\tif (key === 'COMPONENT_ID' && Type.isStringFilled(value))\n\t\t\t{\n\t\t\t\tresult.componentId = value;\n\t\t\t}\n\t\t\telse if (key === 'FILE_ID' && Type.isArray(value))\n\t\t\t{\n\t\t\t\tresult.files = value;\n\t\t\t}\n\t\t\telse if (key === 'IS_EDITED' && Type.isStringFilled(value))\n\t\t\t{\n\t\t\t\tresult.isEdited = value === 'Y';\n\t\t\t}\n\t\t\telse if (key === 'IS_DELETED' && Type.isStringFilled(value))\n\t\t\t{\n\t\t\t\tresult.isDeleted = value === 'Y';\n\t\t\t}\n\t\t\telse if (key === 'ATTACH' && (Type.isArray(value) || Type.isBoolean(value) || Type.isString(value)))\n\t\t\t{\n\t\t\t\tresult.attach = value;\n\t\t\t}\n\t\t\telse if (key === 'LINK_ACTIVE' && Type.isArrayFilled(value))\n\t\t\t{\n\t\t\t\tresult.removeLinks = value.includes(Core.getUserId());\n\t\t\t}\n\t\t});\n\n\t\treturn result;\n\t}\n\n\t#getMaxMessageId(messageIds: number[]): number\n\t{\n\t\tlet maxMessageId = 0;\n\t\tmessageIds.forEach(messageId => {\n\t\t\tif (maxMessageId < messageId)\n\t\t\t{\n\t\t\t\tmaxMessageId = messageId;\n\t\t\t}\n\t\t});\n\n\t\treturn maxMessageId;\n\t}\n\n\t#findLowestMessageId(state: MessagesState, chatId: number): number\n\t{\n\t\tlet firstId = null;\n\t\tconst messages = [...state.chatCollection[chatId]];\n\t\tfor (const messageId of messages)\n\t\t{\n\t\t\tconst element = state.collection[messageId];\n\t\t\tif (!firstId)\n\t\t\t{\n\t\t\t\tfirstId = element.id;\n\t\t\t}\n\t\t\tif (Utils.text.isTempMessage(element.id))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (element.id < firstId)\n\t\t\t{\n\t\t\t\tfirstId = element.id;\n\t\t\t}\n\t\t}\n\n\t\treturn firstId;\n\t}\n\n\t#findMaxMessageId(state: MessagesState, chatId: number): number\n\t{\n\t\tlet lastId = 0;\n\t\tconst messages = [...state.chatCollection[chatId]];\n\t\tfor (const messageId of messages)\n\t\t{\n\t\t\tconst element = state.collection[messageId];\n\t\t\tif (Utils.text.isTempMessage(element.id))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (element.id > lastId)\n\t\t\t{\n\t\t\t\tlastId = element.id;\n\t\t\t}\n\t\t}\n\n\t\treturn lastId;\n\t}\n\n\t#findLastOwnMessageId(state: MessagesState, chatId: number): number\n\t{\n\t\tlet lastOwnMessageId = 0;\n\t\tconst messages = [...state.chatCollection[chatId]].sort((a, z) => z - a);\n\t\tfor (const messageId of messages)\n\t\t{\n\t\t\tconst element = state.collection[messageId];\n\t\t\tif (Utils.text.isTempMessage(element.id))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (element.authorId === Core.getUserId())\n\t\t\t{\n\t\t\t\tlastOwnMessageId = element.id;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\treturn lastOwnMessageId;\n\t}\n\n\t#findFirstUnread(state: MessagesState, chatId: number): number\n\t{\n\t\tlet resultId = 0;\n\t\tfor (const messageId of state.chatCollection[chatId])\n\t\t{\n\t\t\tconst message: ImModelMessage = state.collection[messageId];\n\t\t\tif (message.unread)\n\t\t\t{\n\t\t\t\tresultId = messageId;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\treturn resultId;\n\t}\n}","import {Text, Type} from 'main.core';\nimport {BuilderModel} from 'ui.vue3.vuex';\n\nimport {Core} from 'im.v2.application.core';\nimport {ChatOption, Color, DialogType} from 'im.v2.const';\nimport {Utils} from 'im.v2.lib.utils';\n\nimport type {Dialog as ImModelDialog} from './type/dialog';\n\nconst WRITING_STATUS_TIME = 35000;\n\ntype DialogState = {\n\tcollection: {[dialogId: string]: ImModelDialog},\n\twritingStatusTimers: {[timerId: string]: number},\n\tchatOptions: {[chatType: string]: {[option: string]: boolean}}\n};\n\nexport class DialoguesModel extends BuilderModel\n{\n\tgetName()\n\t{\n\t\treturn 'dialogues';\n\t}\n\n\tgetState()\n\t{\n\t\treturn {\n\t\t\tcollection: {},\n\t\t\twritingStatusTimers: {},\n\t\t\tchatOptions: {}\n\t\t};\n\t}\n\n\tgetElementState()\n\t{\n\t\treturn {\n\t\t\tdialogId: '0',\n\t\t\tchatId: 0,\n\t\t\ttype: DialogType.chat,\n\t\t\tname: '',\n\t\t\tdescription: '',\n\t\t\tavatar: '',\n\t\t\tcolor: Color.base,\n\t\t\textranet: false,\n\t\t\tcounter: 0,\n\t\t\tuserCounter: 0,\n\t\t\tlastReadId: 0,\n\t\t\tmarkedId: 0,\n\t\t\tlastMessageId: 0,\n\t\t\tlastMessageViews: {\n\t\t\t\tcountOfViewers: 0,\n\t\t\t\tfirstViewer: null,\n\t\t\t\tmessageId: 0\n\t\t\t},\n\t\t\tsavedPositionMessageId: 0,\n\t\t\tmanagerList: [],\n\t\t\twritingList: [],\n\t\t\tmuteList: [],\n\t\t\ttextareaMessage: '',\n\t\t\tquoteId: 0,\n\t\t\towner: 0,\n\t\t\tentityType: '',\n\t\t\tentityId: '',\n\t\t\tdateCreate: null,\n\t\t\tpublic: {\n\t\t\t\tcode: '',\n\t\t\t\tlink: ''\n\t\t\t},\n\t\t\tinited: false,\n\t\t\tloading: false,\n\t\t\thasPrevPage: false,\n\t\t\thasNextPage: false,\n\t\t\tdiskFolderId: 0,\n\t\t};\n\t}\n\n\tgetGetters()\n\t{\n\t\treturn {\n\t\t\tget: (state: DialogState) => (dialogId: string, getBlank: boolean = false) =>\n\t\t\t{\n\t\t\t\tif (!state.collection[dialogId] && getBlank)\n\t\t\t\t{\n\t\t\t\t\treturn this.getElementState();\n\t\t\t\t}\n\t\t\t\telse if (!state.collection[dialogId] && !getBlank)\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[dialogId];\n\t\t\t},\n\t\t\tgetByChatId: (state: DialogState) => (chatId: number | string) =>\n\t\t\t{\n\t\t\t\tchatId = Number.parseInt(chatId, 10);\n\t\t\t\treturn Object.values(state.collection).find(item => {\n\t\t\t\t\treturn item.chatId === chatId;\n\t\t\t\t});\n\t\t\t},\n\t\t\tgetBlank: () =>\n\t\t\t{\n\t\t\t\treturn this.getElementState();\n\t\t\t},\n\t\t\tgetChatOption: (state: DialogState) => (chatType: string, option: string) =>\n\t\t\t{\n\t\t\t\tif (!state.chatOptions[chatType])\n\t\t\t\t{\n\t\t\t\t\tchatType = 'default';\n\t\t\t\t}\n\n\t\t\t\treturn state.chatOptions[chatType][option];\n\t\t\t},\n\t\t\tgetQuoteId: (state: DialogState) => (dialogId: string) =>\n\t\t\t{\n\t\t\t\tif (!state.collection[dialogId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[dialogId].quoteId;\n\t\t\t},\n\t\t\tisUser: (state: DialogState) => (dialogId: string) =>\n\t\t\t{\n\t\t\t\tif (!state.collection[dialogId])\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[dialogId].type === DialogType.user;\n\t\t\t},\n\t\t\tcanLeave: (state: DialogState) => (dialogId: string) =>\n\t\t\t{\n\t\t\t\tif (!state.collection[dialogId])\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst dialog = state.collection[dialogId];\n\n\t\t\t\tconst isExternalTelephonyCall = dialog.type === DialogType.call;\n\t\t\t\tconst isUser = dialog.type === DialogType.user;\n\t\t\t\tif (isExternalTelephonyCall || isUser)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst currentUserId = Core.getUserId();\n\t\t\t\tconst optionToCheck = dialog.owner === currentUserId ? ChatOption.leaveOwner : ChatOption.leave;\n\n\t\t\t\treturn this.store.getters['dialogues/getChatOption'](dialog.type, optionToCheck);\n\t\t\t},\n\t\t\tcanMute: (state: DialogState) => (dialogId: string) =>\n\t\t\t{\n\t\t\t\tif (!state.collection[dialogId])\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst dialog = state.collection[dialogId];\n\n\t\t\t\tconst isUser = dialog.type === DialogType.user;\n\t\t\t\tconst isAnnouncement = dialog.type === DialogType.announcement;\n\t\t\t\tif (isUser || isAnnouncement)\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\treturn this.store.getters['dialogues/getChatOption'](dialog.type, ChatOption.mute);\n\t\t\t},\n\t\t\tgetLastReadId: (state: DialogState) => (dialogId: string): number =>\n\t\t\t{\n\t\t\t\tif (!state.collection[dialogId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\tconst {lastReadId, lastMessageId} = state.collection[dialogId];\n\n\t\t\t\treturn lastReadId === lastMessageId ? 0 : lastReadId;\n\t\t\t},\n\t\t\tgetInitialMessageId: (state: DialogState) => (dialogId: string): number =>\n\t\t\t{\n\t\t\t\tif (!state.collection[dialogId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\tconst {lastReadId, markedId} = state.collection[dialogId];\n\t\t\t\tif (markedId === 0)\n\t\t\t\t{\n\t\t\t\t\treturn lastReadId;\n\t\t\t\t}\n\n\t\t\t\treturn Math.min(lastReadId, markedId);\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions()\n\t{\n\t\treturn {\n\t\t\tset: (store, payload: Array | Object) =>\n\t\t\t{\n\t\t\t\tif (!Array.isArray(payload) && Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\tpayload = [payload];\n\t\t\t\t}\n\n\t\t\t\tpayload.map(element => {\n\t\t\t\t\treturn this.validate(element);\n\t\t\t\t}).forEach(element => {\n\t\t\t\t\tconst existingItem = store.state.collection[element.dialogId];\n\t\t\t\t\tif (existingItem)\n\t\t\t\t\t{\n\t\t\t\t\t\tstore.commit('update', {\n\t\t\t\t\t\t\tdialogId: element.dialogId,\n\t\t\t\t\t\t\tfields: element\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tstore.commit('add', {\n\t\t\t\t\t\t\tdialogId: element.dialogId,\n\t\t\t\t\t\t\tfields: {...this.getElementState(), ...element}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tadd: (store, payload: Array | Object) =>\n\t\t\t{\n\t\t\t\tif (!Array.isArray(payload) && Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\tpayload = [payload];\n\t\t\t\t}\n\n\t\t\t\tpayload.map(element => {\n\t\t\t\t\treturn this.validate(element);\n\t\t\t\t}).forEach(element => {\n\t\t\t\t\tconst existingItem = store.state.collection[element.dialogId];\n\t\t\t\t\tif (!existingItem)\n\t\t\t\t\t{\n\t\t\t\t\t\tstore.commit('add', {\n\t\t\t\t\t\t\tdialogId: element.dialogId,\n\t\t\t\t\t\t\tfields: {...this.getElementState(), ...element}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tupdate: (store, payload: {dialogId: string, fields: Object}) =>\n\t\t\t{\n\t\t\t\tconst existingItem = store.state.collection[payload.dialogId];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tdialogId: payload.dialogId,\n\t\t\t\t\tfields: this.validate(payload.fields)\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tdelete: (store, payload: {dialogId: string}) =>\n\t\t\t{\n\t\t\t\tconst existingItem = store.state.collection[payload.dialogId];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('delete', {dialogId: payload.dialogId});\n\t\t\t},\n\n\t\t\tstartWriting: (store, payload: {dialogId: string, userId: number, userName: string}) =>\n\t\t\t{\n\t\t\t\tconst existingItem = store.state.collection[payload.dialogId];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst timerId = `${payload.dialogId}|${payload.userId}`;\n\t\t\t\tconst alreadyWriting = existingItem.writingList.some(el => el.userId === payload.userId);\n\t\t\t\tif (alreadyWriting)\n\t\t\t\t{\n\t\t\t\t\tclearTimeout(store.state.writingStatusTimers[timerId]);\n\t\t\t\t\tstore.state.writingStatusTimers[timerId] = this.setWritingStatusTimeout(payload);\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\tconst newItem = {userId: payload.userId, userName: payload.userName};\n\t\t\t\tconst newWritingList = [newItem, ...existingItem.writingList];\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tactionName: 'startWriting',\n\t\t\t\t\tdialogId: payload.dialogId,\n\t\t\t\t\tfields: this.validate({writingList: newWritingList})\n\t\t\t\t});\n\n\t\t\t\tif (!store.state.writingStatusTimers[timerId])\n\t\t\t\t{\n\t\t\t\t\tstore.state.writingStatusTimers[timerId] = this.setWritingStatusTimeout(payload);\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tstopWriting: (store, payload: {dialogId: string, userId: number}) =>\n\t\t\t{\n\t\t\t\tconst existingItem = store.state.collection[payload.dialogId];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst alreadyWriting = existingItem.writingList.find(el => el.userId === payload.userId);\n\t\t\t\tif (!alreadyWriting)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst newWritingList = existingItem.writingList.filter(item => item.userId !== payload.userId);\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tactionName: 'stopWriting',\n\t\t\t\t\tdialogId: payload.dialogId,\n\t\t\t\t\tfields: this.validate({writingList: newWritingList})\n\t\t\t\t});\n\n\t\t\t\tconst timerId = `${payload.dialogId}|${payload.userId}`;\n\t\t\t\tclearTimeout(store.state.writingStatusTimers[timerId]);\n\t\t\t\tdelete store.state.writingStatusTimers[timerId];\n\t\t\t},\n\n\t\t\tincreaseCounter: (store, payload: {dialogId: string, count: number}) =>\n\t\t\t{\n\t\t\t\tconst existingItem = store.state.collection[payload.dialogId];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tif (existingItem.counter === 100)\n\t\t\t\t{\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\tlet increasedCounter = existingItem.counter + payload.count;\n\t\t\t\tif (increasedCounter > 100)\n\t\t\t\t{\n\t\t\t\t\tincreasedCounter = 100;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tactionName: 'increaseCounter',\n\t\t\t\t\tdialogId: payload.dialogId,\n\t\t\t\t\tfields: {\n\t\t\t\t\t\tcounter: increasedCounter,\n\t\t\t\t\t\tpreviousCounter: existingItem.counter\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tdecreaseCounter: (store, payload: {dialogId: string, count: number}) =>\n\t\t\t{\n\t\t\t\tconst existingItem = store.state.collection[payload.dialogId];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tif (existingItem.counter === 100)\n\t\t\t\t{\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\tlet decreasedCounter = existingItem.counter - payload.count;\n\t\t\t\tif (decreasedCounter < 0)\n\t\t\t\t{\n\t\t\t\t\tdecreasedCounter = 0;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tactionName: 'decreaseCounter',\n\t\t\t\t\tdialogId: payload.dialogId,\n\t\t\t\t\tfields: {\n\t\t\t\t\t\tcounter: decreasedCounter,\n\t\t\t\t\t\tpreviousCounter: existingItem.counter\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tclearCounters: (store) =>\n\t\t\t{\n\t\t\t\tstore.commit('clearCounters');\n\t\t\t},\n\n\t\t\tmute: (store, payload: {dialogId: string}) =>\n\t\t\t{\n\t\t\t\tconst existingItem = store.state.collection[payload.dialogId];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst currentUserId = Core.getUserId();\n\t\t\t\tif (existingItem.muteList.includes(currentUserId))\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tconst muteList = [...existingItem.muteList, currentUserId];\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tactionName: 'mute',\n\t\t\t\t\tdialogId: payload.dialogId,\n\t\t\t\t\tfields: this.validate({muteList})\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tunmute: (store, payload: {dialogId: string}) =>\n\t\t\t{\n\t\t\t\tconst existingItem = store.state.collection[payload.dialogId];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst currentUserId = Core.getUserId();\n\t\t\t\tconst muteList = existingItem.muteList.filter(item => item !== currentUserId);\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tactionName: 'unmute',\n\t\t\t\t\tdialogId: payload.dialogId,\n\t\t\t\t\tfields: this.validate({muteList})\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tsetChatOptions: (store, payload: Object) =>\n\t\t\t{\n\t\t\t\tstore.commit('setChatOptions', this.validateChatOptions(payload));\n\t\t\t},\n\n\t\t\tsetLastMessageViews: (store, payload: {\n\t\t\t\tdialogId: string,\n\t\t\t\tfields: {userId: number, userName: string, date: string, messageId: number}\n\t\t\t}) =>\n\t\t\t{\n\t\t\t\tconst {dialogId, fields: {userId, userName, date, messageId}} = payload;\n\t\t\t\tconst existingItem: ImModelDialog = store.state.collection[dialogId];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst newLastMessageViews = {\n\t\t\t\t\tcountOfViewers: 1,\n\t\t\t\t\tmessageId,\n\t\t\t\t\tfirstViewer: {\n\t\t\t\t\t\tuserId,\n\t\t\t\t\t\tuserName,\n\t\t\t\t\t\tdate: Utils.date.cast(date)\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tactionName: 'setLastMessageViews',\n\t\t\t\t\tdialogId: dialogId,\n\t\t\t\t\tfields: {\n\t\t\t\t\t\tlastMessageViews: newLastMessageViews\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tclearLastMessageViews: (store, payload: {dialogId: string}) =>\n\t\t\t{\n\t\t\t\tconst existingItem = store.state.collection[payload.dialogId];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst {lastMessageViews: defaultLastMessageViews} = this.getElementState();\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tactionName: 'clearLastMessageViews',\n\t\t\t\t\tdialogId: payload.dialogId,\n\t\t\t\t\tfields: {\n\t\t\t\t\t\tlastMessageViews: defaultLastMessageViews\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tincrementLastMessageViews: (store, payload: {dialogId: string}) =>\n\t\t\t{\n\t\t\t\tconst existingItem: ImModelDialog = store.state.collection[payload.dialogId];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst newCounter = existingItem.lastMessageViews.countOfViewers + 1;\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tactionName: 'incrementLastMessageViews',\n\t\t\t\t\tdialogId: payload.dialogId,\n\t\t\t\t\tfields: {\n\t\t\t\t\t\tlastMessageViews: {...existingItem.lastMessageViews, countOfViewers: newCounter}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\t}\n\n\tgetMutations()\n\t{\n\t\treturn {\n\t\t\tadd: (state: DialogState, payload) =>\n\t\t\t{\n\t\t\t\tstate.collection[payload.dialogId] = payload.fields;\n\t\t\t},\n\t\t\tupdate: (state: DialogState, payload) =>\n\t\t\t{\n\t\t\t\tstate.collection[payload.dialogId] = {...state.collection[payload.dialogId], ...payload.fields};\n\t\t\t},\n\t\t\tdelete: (state: DialogState, payload) =>\n\t\t\t{\n\t\t\t\tdelete state.collection[payload.dialogId];\n\t\t\t},\n\t\t\tsetChatOptions: (state: DialogState, payload) =>\n\t\t\t{\n\t\t\t\tstate.chatOptions = payload;\n\t\t\t},\n\t\t\tclearCounters: (state: DialogState) =>\n\t\t\t{\n\t\t\t\tObject.keys(state.collection).forEach(key => {\n\t\t\t\t\tstate.collection[key].counter = 0;\n\t\t\t\t\tstate.collection[key].markedId = 0;\n\t\t\t\t});\n\t\t\t},\n\t\t};\n\t}\n\n\tsetWritingStatusTimeout(payload: {dialogId: string, userId: number})\n\t{\n\t\treturn setTimeout(() => {\n\t\t\tthis.store.dispatch('dialogues/stopWriting', {\n\t\t\t\tdialogId: payload.dialogId,\n\t\t\t\tuserId: payload.userId\n\t\t\t});\n\t\t}, WRITING_STATUS_TIME);\n\t}\n\n\tvalidate(fields)\n\t{\n\t\tconst result = {};\n\n\t\tif (!Type.isUndefined(fields.dialog_id))\n\t\t{\n\t\t\tfields.dialogId = fields.dialog_id;\n\t\t}\n\t\tif (Type.isNumber(fields.dialogId) || Type.isStringFilled(fields.dialogId))\n\t\t{\n\t\t\tresult.dialogId = fields.dialogId.toString();\n\t\t}\n\n\t\tif (!Type.isUndefined(fields.chat_id))\n\t\t{\n\t\t\tfields.chatId = fields.chat_id;\n\t\t}\n\t\telse if (!Type.isUndefined(fields.id))\n\t\t{\n\t\t\tfields.chatId = fields.id;\n\t\t}\n\t\tif (Type.isNumber(fields.chatId) || Type.isStringFilled(fields.chatId))\n\t\t{\n\t\t\tresult.chatId = Number.parseInt(fields.chatId, 10);\n\t\t}\n\n\t\tif (Type.isStringFilled(fields.type))\n\t\t{\n\t\t\tresult.type = fields.type.toString();\n\t\t}\n\n\t\tif (Type.isNumber(fields.quoteId))\n\t\t{\n\t\t\tresult.quoteId = Number.parseInt(fields.quoteId, 10);\n\t\t}\n\n\t\tif (Type.isNumber(fields.counter) || Type.isStringFilled(fields.counter))\n\t\t{\n\t\t\tresult.counter = Number.parseInt(fields.counter, 10);\n\t\t}\n\n\t\tif (!Type.isUndefined(fields.user_counter))\n\t\t{\n\t\t\tresult.userCounter = fields.user_counter;\n\t\t}\n\t\tif (Type.isNumber(fields.userCounter) || Type.isStringFilled(fields.userCounter))\n\t\t{\n\t\t\tresult.userCounter = Number.parseInt(fields.userCounter, 10);\n\t\t}\n\n\t\tif (!Type.isUndefined(fields.last_id))\n\t\t{\n\t\t\tfields.lastId = fields.last_id;\n\t\t}\n\t\tif (Type.isNumber(fields.lastId))\n\t\t{\n\t\t\tresult.lastReadId = fields.lastId;\n\t\t}\n\n\t\tif (!Type.isUndefined(fields.marked_id))\n\t\t{\n\t\t\tfields.markedId = fields.marked_id;\n\t\t}\n\t\tif (Type.isNumber(fields.markedId))\n\t\t{\n\t\t\tresult.markedId = fields.markedId;\n\t\t}\n\n\t\tif (!Type.isUndefined(fields.last_message_id))\n\t\t{\n\t\t\tfields.lastMessageId = fields.last_message_id;\n\t\t}\n\t\tif (Type.isNumber(fields.lastMessageId) || Type.isStringFilled(fields.lastMessageId))\n\t\t{\n\t\t\tresult.lastMessageId = Number.parseInt(fields.lastMessageId, 10);\n\t\t}\n\n\t\tif (Type.isPlainObject(fields.last_message_views))\n\t\t{\n\t\t\tfields.lastMessageViews = fields.last_message_views;\n\t\t}\n\t\tif (Type.isPlainObject(fields.lastMessageViews))\n\t\t{\n\t\t\tresult.lastMessageViews = this.prepareLastMessageViews(fields.lastMessageViews);\n\t\t}\n\n\t\tif (Type.isBoolean(fields.hasPrevPage))\n\t\t{\n\t\t\tresult.hasPrevPage = fields.hasPrevPage;\n\t\t}\n\n\t\tif (Type.isBoolean(fields.hasNextPage))\n\t\t{\n\t\t\tresult.hasNextPage = fields.hasNextPage;\n\t\t}\n\n\t\tif (Type.isNumber(fields.savedPositionMessageId))\n\t\t{\n\t\t\tresult.savedPositionMessageId = fields.savedPositionMessageId;\n\t\t}\n\n\t\tif (!Type.isUndefined(fields.textareaMessage))\n\t\t{\n\t\t\tresult.textareaMessage = fields.textareaMessage.toString();\n\t\t}\n\n\t\tif (!Type.isUndefined(fields.title))\n\t\t{\n\t\t\tfields.name = fields.title;\n\t\t}\n\t\tif (Type.isNumber(fields.name) || Type.isStringFilled(fields.name))\n\t\t{\n\t\t\tresult.name = Text.decode(fields.name.toString());\n\t\t}\n\n\t\tif (!Type.isUndefined(fields.owner))\n\t\t{\n\t\t\tfields.ownerId = fields.owner;\n\t\t}\n\t\tif (Type.isNumber(fields.ownerId) || Type.isStringFilled(fields.ownerId))\n\t\t{\n\t\t\tresult.owner = Number.parseInt(fields.ownerId, 10);\n\t\t}\n\n\t\tif (Type.isString(fields.avatar))\n\t\t{\n\t\t\tresult.avatar = this.prepareAvatar(fields.avatar);\n\t\t}\n\n\t\tif (Type.isStringFilled(fields.color))\n\t\t{\n\t\t\tresult.color = fields.color;\n\t\t}\n\n\t\tif (Type.isBoolean(fields.extranet))\n\t\t{\n\t\t\tresult.extranet = fields.extranet;\n\t\t}\n\n\t\tif (!Type.isUndefined(fields.entity_type))\n\t\t{\n\t\t\tfields.entityType = fields.entity_type;\n\t\t}\n\t\tif (Type.isStringFilled(fields.entityType))\n\t\t{\n\t\t\tresult.entityType = fields.entityType;\n\t\t}\n\t\tif (!Type.isUndefined(fields.entity_id))\n\t\t{\n\t\t\tfields.entityId = fields.entity_id;\n\t\t}\n\t\tif (Type.isNumber(fields.entityId) || Type.isStringFilled(fields.entityId))\n\t\t{\n\t\t\tresult.entityId = fields.entityId.toString();\n\t\t}\n\n\t\tif (!Type.isUndefined(fields.date_create))\n\t\t{\n\t\t\tfields.dateCreate = fields.date_create;\n\t\t}\n\t\tif (!Type.isUndefined(fields.dateCreate))\n\t\t{\n\t\t\tresult.dateCreate = Utils.date.cast(fields.dateCreate);\n\t\t}\n\n\t\tif (Type.isPlainObject(fields.public))\n\t\t{\n\t\t\tresult.public = {};\n\n\t\t\tif (Type.isStringFilled(fields.public.code))\n\t\t\t{\n\t\t\t\tresult.public.code = fields.public.code;\n\t\t\t}\n\n\t\t\tif (Type.isStringFilled(fields.public.link))\n\t\t\t{\n\t\t\t\tresult.public.link = fields.public.link;\n\t\t\t}\n\t\t}\n\n\t\tif (!Type.isUndefined(fields.writing_list))\n\t\t{\n\t\t\tfields.writingList = fields.writing_list;\n\t\t}\n\t\tif (Type.isArray(fields.writingList))\n\t\t{\n\t\t\tresult.writingList = this.prepareWritingList(fields.writingList);\n\t\t}\n\n\t\tif (!Type.isUndefined(fields.manager_list))\n\t\t{\n\t\t\tfields.managerList = fields.manager_list;\n\t\t}\n\t\tif (Type.isArray(fields.managerList))\n\t\t{\n\t\t\tresult.managerList = [];\n\n\t\t\tfields.managerList.forEach(userId =>\n\t\t\t{\n\t\t\t\tuserId = Number.parseInt(userId, 10);\n\t\t\t\tif (userId > 0)\n\t\t\t\t{\n\t\t\t\t\tresult.managerList.push(userId);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tif (!Type.isUndefined(fields.mute_list))\n\t\t{\n\t\t\tfields.muteList = fields.mute_list;\n\t\t}\n\t\tif (Type.isArray(fields.muteList) || Type.isPlainObject(fields.muteList))\n\t\t{\n\t\t\tresult.muteList = this.prepareMuteList(fields.muteList);\n\t\t}\n\n\t\tif (Type.isBoolean(fields.inited))\n\t\t{\n\t\t\tresult.inited = fields.inited;\n\t\t}\n\n\t\tif (Type.isBoolean(fields.loading))\n\t\t{\n\t\t\tresult.loading = fields.loading;\n\t\t}\n\n\t\tif (Type.isString(fields.description))\n\t\t{\n\t\t\tresult.description = fields.description;\n\t\t}\n\n\t\tif (Type.isNumber(fields.disk_folder_id))\n\t\t{\n\t\t\tresult.diskFolderId = fields.disk_folder_id;\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tprepareAvatar(avatar: string): string\n\t{\n\t\tlet result = '';\n\n\t\tif (!avatar || avatar.endsWith('/js/im/images/blank.gif'))\n\t\t{\n\t\t\tresult = '';\n\t\t}\n\t\telse if (avatar.startsWith('http'))\n\t\t{\n\t\t\tresult = avatar;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tresult = Core.getHost() + avatar;\n\t\t}\n\n\t\tif (result)\n\t\t{\n\t\t\tresult = encodeURI(result);\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tprepareWritingList(writingList: Object[]): Array<{userId: number, userName: string}>\n\t{\n\t\tconst result = [];\n\n\t\twritingList.forEach(element =>\n\t\t{\n\t\t\tconst item = {};\n\n\t\t\tif (!element.userId)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\titem.userId = Number.parseInt(element.userId, 10);\n\t\t\titem.userName = Utils.text.htmlspecialcharsback(element.userName);\n\n\t\t\tresult.push(item);\n\t\t});\n\n\t\treturn result;\n\t}\n\n\tprepareMuteList(muteList: Object[] | Object): Object[]\n\t{\n\t\tconst result = [];\n\n\t\tif (Type.isArray(muteList))\n\t\t{\n\t\t\tmuteList.forEach(userId =>\n\t\t\t{\n\t\t\t\tuserId = Number.parseInt(userId, 10);\n\t\t\t\tif (userId > 0)\n\t\t\t\t{\n\t\t\t\t\tresult.push(userId);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\telse if (Type.isPlainObject(muteList))\n\t\t{\n\t\t\tObject.entries(muteList).forEach(([key, value]) => {\n\t\t\t\tif (!value)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tconst userId = Number.parseInt(key, 10);\n\t\t\t\tif (userId > 0)\n\t\t\t\t{\n\t\t\t\t\tresult.push(userId);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tprepareLastMessageViews(rawLastMessageViews): {countOfViewers: number, firstViewers: Object[], messageId: number}\n\t{\n\t\tconst {\n\t\t\tcount_of_viewers: countOfViewers,\n\t\t\tfirst_viewers: rawFirstViewers,\n\t\t\tmessage_id: messageId\n\t\t} = rawLastMessageViews;\n\n\t\tlet firstViewer;\n\t\trawFirstViewers.forEach(rawFirstViewer => {\n\t\t\tif (rawFirstViewer.user_id === Core.getUserId())\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tfirstViewer = {\n\t\t\t\tuserId: rawFirstViewer.user_id,\n\t\t\t\tuserName: rawFirstViewer.user_name,\n\t\t\t\tdate: Utils.date.cast(rawFirstViewer.date)\n\t\t\t};\n\t\t});\n\n\t\tif (countOfViewers > 0 && !firstViewer)\n\t\t{\n\t\t\tthrow new Error('Dialogues model: no first viewer for message');\n\t\t}\n\n\t\treturn {\n\t\t\tcountOfViewers,\n\t\t\tfirstViewer,\n\t\t\tmessageId\n\t\t};\n\t}\n\n\tvalidateChatOptions(options: Object): Object\n\t{\n\t\tconst result = {};\n\n\t\tObject.entries(options).forEach(([type, typeOptions]) => {\n\t\t\tconst newType = Utils.text.convertSnakeToCamelCase(type.toLowerCase());\n\t\t\tresult[newType] = {};\n\t\t\tObject.entries(typeOptions).forEach(([key, value]) => {\n\t\t\t\tconst newKey = Utils.text.convertSnakeToCamelCase(key.toLowerCase());\n\t\t\t\tresult[newType][newKey] = value;\n\t\t\t});\n\t\t});\n\n\t\treturn result;\n\t}\n}","import {Type, Loc} from 'main.core';\nimport {BuilderModel} from 'ui.vue3.vuex';\n\nimport {Core} from 'im.v2.application.core';\nimport {Utils} from 'im.v2.lib.utils';\nimport {UserStatus, BotType, Color} from 'im.v2.const';\n\nexport class UsersModel extends BuilderModel\n{\n\tgetName()\n\t{\n\t\treturn 'users';\n\t}\n\n\tgetState()\n\t{\n\t\treturn {\n\t\t\tcollection: {},\n\t\t\tonlineList: [],\n\t\t\tmobileOnlineList: [],\n\t\t\tabsentList: [],\n\t\t\tbotList: {}\n\t\t};\n\t}\n\n\tgetElementState(params = {})\n\t{\n\t\tconst {id = 0} = params;\n\n\t\treturn {\n\t\t\tid,\n\t\t\tname: '',\n\t\t\tfirstName: '',\n\t\t\tlastName: '',\n\t\t\tavatar: '',\n\t\t\tcolor: Color.base,\n\t\t\tworkPosition: '',\n\t\t\tgender: 'M',\n\t\t\textranet: false,\n\t\t\tnetwork: false,\n\t\t\tbot: false,\n\t\t\tconnector: false,\n\t\t\texternalAuthId: 'default',\n\t\t\tstatus: '',\n\t\t\tidle: false,\n\t\t\tlastActivityDate: false,\n\t\t\tmobileLastDate: false,\n\t\t\tisOnline: false,\n\t\t\tisMobileOnline: false,\n\t\t\tbirthday: false,\n\t\t\tisBirthday: false,\n\t\t\tabsent: false,\n\t\t\tisAbsent: false,\n\t\t\tdepartments: [],\n\t\t\tphones: {\n\t\t\t\tworkPhone: '',\n\t\t\t\tpersonalMobile: '',\n\t\t\t\tpersonalPhone: '',\n\t\t\t\tinnerPhone: '',\n\t\t\t}\n\t\t};\n\t}\n\n\tgetGetters()\n\t{\n\t\treturn {\n\t\t\tget: state => (userId, getTemporary = false) =>\n\t\t\t{\n\t\t\t\tuserId = Number.parseInt(userId, 10);\n\n\t\t\t\tif (userId <= 0)\n\t\t\t\t{\n\t\t\t\t\tif (getTemporary)\n\t\t\t\t\t{\n\t\t\t\t\t\tuserId = 0;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\treturn null;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tconst user = state.collection[userId];\n\n\t\t\t\tif (!getTemporary && !user)\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t\telse if (getTemporary && !user)\n\t\t\t\t{\n\t\t\t\t\treturn this.getElementState({id: userId});\n\t\t\t\t}\n\n\t\t\t\treturn user;\n\t\t\t},\n\t\t\tgetBlank: () => params =>\n\t\t\t{\n\t\t\t\treturn this.getElementState(params);\n\t\t\t},\n\t\t\tgetList: state => (userList) => {\n\t\t\t\tconst result = [];\n\n\t\t\t\tif (!Array.isArray(userList))\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\tuserList.forEach(id => {\n\t\t\t\t\tif (state.collection[id])\n\t\t\t\t\t{\n\t\t\t\t\t\tresult.push(state.collection[id]);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tresult.push(this.getElementState({id}));\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\treturn result;\n\t\t\t},\n\t\t\thasBirthday: state => userId => {\n\t\t\t\tuserId = Number.parseInt(userId, 10);\n\n\t\t\t\tconst user = state.collection[userId];\n\t\t\t\tif (userId <= 0 || !user)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn user.isBirthday;\n\t\t\t},\n\t\t\thasVacation: state => userId => {\n\t\t\t\tuserId = Number.parseInt(userId, 10);\n\n\t\t\t\tconst user = state.collection[userId];\n\t\t\t\tif (userId <= 0 || !user)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn user.isAbsent;\n\t\t\t},\n\t\t\tgetStatus: state => userId => {\n\t\t\t\tuserId = Number.parseInt(userId, 10);\n\n\t\t\t\tconst user = state.collection[userId];\n\t\t\t\tif (userId <= 0 || !user)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tif (!user.isOnline)\n\t\t\t\t{\n\t\t\t\t\treturn '';\n\t\t\t\t}\n\n\t\t\t\tif (user.isMobileOnline)\n\t\t\t\t{\n\t\t\t\t\treturn UserStatus.mobileOnline;\n\t\t\t\t}\n\t\t\t\telse if (user.idle)\n\t\t\t\t{\n\t\t\t\t\t// away by time\n\t\t\t\t\treturn UserStatus.idle;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\t// manually selected status (online, away, dnd, break)\n\t\t\t\t\treturn user.status;\n\t\t\t\t}\n\t\t\t},\n\t\t\tgetLastOnline: state => userId => {\n\t\t\t\tuserId = Number.parseInt(userId, 10);\n\n\t\t\t\tconst user = state.collection[userId];\n\t\t\t\tif (userId <= 0 || !user)\n\t\t\t\t{\n\t\t\t\t\treturn '';\n\t\t\t\t}\n\n\t\t\t\treturn Utils.user.getLastDateText(user);\n\t\t\t},\n\t\t\tgetPosition: state => userId => {\n\t\t\t\tuserId = Number.parseInt(userId, 10);\n\n\t\t\t\tconst user = state.collection[userId];\n\t\t\t\tif (userId <= 0 || !user)\n\t\t\t\t{\n\t\t\t\t\treturn '';\n\t\t\t\t}\n\n\t\t\t\tif (user.workPosition)\n\t\t\t\t{\n\t\t\t\t\treturn user.workPosition;\n\t\t\t\t}\n\n\t\t\t\treturn Loc.getMessage('IM_MODEL_USERS_DEFAULT_NAME');\n\t\t\t},\n\t\t\tgetBotType: state => userId => {\n\t\t\t\tuserId = Number.parseInt(userId, 10);\n\n\t\t\t\tconst user = state.collection[userId];\n\t\t\t\tif (userId <= 0 || !user || !user.bot || !state.botList[userId])\n\t\t\t\t{\n\t\t\t\t\treturn '';\n\t\t\t\t}\n\n\t\t\t\tconst botType = state.botList[userId].type;\n\n\t\t\t\tif (!BotType[botType])\n\t\t\t\t{\n\t\t\t\t\treturn BotType.bot;\n\t\t\t\t}\n\n\t\t\t\treturn botType;\n\t\t\t}\n\t\t};\n\t}\n\n\tgetActions()\n\t{\n\t\treturn {\n\t\t\tset: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (!Array.isArray(payload) && Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\tpayload = [payload];\n\t\t\t\t}\n\n\t\t\t\tpayload.map(user => {\n\t\t\t\t\treturn this.validate(user);\n\t\t\t\t}).forEach(user => {\n\t\t\t\t\tconst existingUser = store.state.collection[user.id];\n\t\t\t\t\tif (existingUser)\n\t\t\t\t\t{\n\t\t\t\t\t\tstore.commit('update', {\n\t\t\t\t\t\t\tid: user.id,\n\t\t\t\t\t\t\tfields: user\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tstore.commit('add', {\n\t\t\t\t\t\t\tid: user.id,\n\t\t\t\t\t\t\tfields: {...this.getElementState(), ...user}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\t\t\tadd: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (!Array.isArray(payload) && Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\tpayload = [payload];\n\t\t\t\t}\n\n\t\t\t\tpayload.map(user => {\n\t\t\t\t\treturn this.validate(user);\n\t\t\t\t}).forEach(user => {\n\t\t\t\t\tconst existingUser = store.state.collection[user.id];\n\t\t\t\t\tif (!existingUser)\n\t\t\t\t\t{\n\t\t\t\t\t\tstore.commit('add', {\n\t\t\t\t\t\t\tid: user.id,\n\t\t\t\t\t\t\tfields: {...this.getElementState(), ...user}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\t\t\tupdate: (store, payload) =>\n\t\t\t{\n\t\t\t\tpayload.id = Number.parseInt(payload.id, 10);\n\n\t\t\t\tconst user = store.state.collection[payload.id];\n\t\t\t\tif (!user)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tid: payload.id,\n\t\t\t\t\tfields: this.validate(payload.fields)\n\t\t\t\t});\n\t\t\t},\n\t\t\tdelete: (store, payload) =>\n\t\t\t{\n\t\t\t\tstore.commit('delete', payload.id);\n\t\t\t},\n\t\t\tsetBotList: (store, payload) =>\n\t\t\t{\n\t\t\t\tstore.commit('setBotList', payload);\n\t\t\t},\n\t\t\tsetStatus: (store, payload: {status: string}) =>\n\t\t\t{\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tid: Core.getUserId(),\n\t\t\t\t\tfields: this.validate(payload)\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\t}\n\n\tgetMutations()\n\t{\n\t\treturn {\n\t\t\tadd: (state, payload) =>\n\t\t\t{\n\t\t\t\tstate.collection[payload.id] = payload.fields;\n\t\t\t\tconst user = state.collection[payload.id];\n\n\t\t\t\tif (Utils.user.isOnline(user.lastActivityDate))\n\t\t\t\t{\n\t\t\t\t\tuser.isOnline = true;\n\t\t\t\t\tthis.addToOnlineList(user.id);\n\t\t\t\t}\n\n\t\t\t\tif (Utils.user.isMobileOnline(user.lastActivityDate, user.mobileLastDate))\n\t\t\t\t{\n\t\t\t\t\tuser.isMobileOnline = true;\n\t\t\t\t\tthis.addToMobileOnlineList(user.id);\n\t\t\t\t}\n\n\t\t\t\tif (user.birthday && Utils.user.isBirthdayToday(user.birthday))\n\t\t\t\t{\n\t\t\t\t\tuser.isBirthday = true;\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tuser.isBirthday = false;\n\t\t\t\t\t}, Utils.date.getTimeToNextMidnight());\n\t\t\t\t}\n\n\t\t\t\tif (user.absent)\n\t\t\t\t{\n\t\t\t\t\tuser.isAbsent = true;\n\t\t\t\t\tthis.addToAbsentList(user.id);\n\t\t\t\t}\n\n\t\t\t\tthis.startOnlineCheckInterval();\n\t\t\t\tthis.startAbsentCheckInterval();\n\t\t\t},\n\t\t\tupdate: (state, payload) =>\n\t\t\t{\n\t\t\t\tconst user = state.collection[payload.id];\n\t\t\t\tif (Utils.user.isOnline(payload.fields.lastActivityDate))\n\t\t\t\t{\n\t\t\t\t\tuser.isOnline = true;\n\t\t\t\t\tthis.addToOnlineList(payload.fields.id);\n\t\t\t\t}\n\n\t\t\t\tif (Utils.user.isMobileOnline(payload.fields.lastActivityDate, payload.fields.mobileLastDate))\n\t\t\t\t{\n\t\t\t\t\tuser.isMobileOnline = true;\n\t\t\t\t\tthis.addToMobileOnlineList(payload.fields.id);\n\t\t\t\t}\n\n\t\t\t\tif (payload.fields.absent === false)\n\t\t\t\t{\n\t\t\t\t\tstate.absentList = state.absentList.filter(element => {\n\t\t\t\t\t\treturn element !== payload.id;\n\t\t\t\t\t});\n\t\t\t\t\tstate.collection[payload.id].isAbsent = false;\n\t\t\t\t}\n\t\t\t\telse if (Type.isDate(payload.fields.absent))\n\t\t\t\t{\n\t\t\t\t\tstate.collection[payload.id].isAbsent = true;\n\t\t\t\t\tthis.addToAbsentList(payload.id);\n\t\t\t\t}\n\n\t\t\t\tstate.collection[payload.id] = {...state.collection[payload.id], ...payload.fields};\n\t\t\t},\n\t\t\tdelete: (state, payload) =>\n\t\t\t{\n\t\t\t\tdelete state.collection[payload.id];\n\t\t\t},\n\t\t\tsetBotList: (state, payload) =>\n\t\t\t{\n\t\t\t\tstate.botList = payload;\n\t\t\t}\n\t\t};\n\t}\n\n\tvalidate(fields)\n\t{\n\t\tconst result = {};\n\n\t\tif (Type.isNumber(fields.id) || Type.isString(fields.id))\n\t\t{\n\t\t\tresult.id = Number.parseInt(fields.id, 10);\n\t\t}\n\n\t\tif (Type.isStringFilled(fields.first_name))\n\t\t{\n\t\t\tfields.firstName = fields.first_name;\n\t\t}\n\t\tif (Type.isStringFilled(fields.last_name))\n\t\t{\n\t\t\tfields.lastName = fields.last_name;\n\t\t}\n\t\tif (Type.isStringFilled(fields.firstName))\n\t\t{\n\t\t\tresult.firstName = Utils.text.htmlspecialcharsback(fields.firstName);\n\t\t}\n\t\tif (Type.isStringFilled(fields.lastName))\n\t\t{\n\t\t\tresult.lastName = Utils.text.htmlspecialcharsback(fields.lastName);\n\t\t}\n\t\tif (Type.isStringFilled(fields.name))\n\t\t{\n\t\t\tfields.name = Utils.text.htmlspecialcharsback(fields.name);\n\t\t\tresult.name = fields.name;\n\t\t}\n\n\t\tif (Type.isStringFilled(fields.color))\n\t\t{\n\t\t\tresult.color = fields.color;\n\t\t}\n\n\t\tif (Type.isStringFilled(fields.avatar))\n\t\t{\n\t\t\tresult.avatar = this.prepareAvatar(fields.avatar);\n\t\t}\n\n\t\tif (Type.isStringFilled(fields.work_position))\n\t\t{\n\t\t\tfields.workPosition = fields.work_position;\n\t\t}\n\t\tif (Type.isStringFilled(fields.workPosition))\n\t\t{\n\t\t\tresult.workPosition = Utils.text.htmlspecialcharsback(fields.workPosition);\n\t\t}\n\n\t\tif (Type.isStringFilled(fields.gender))\n\t\t{\n\t\t\tresult.gender = fields.gender === 'F'? 'F': 'M';\n\t\t}\n\n\t\tif (Type.isStringFilled(fields.birthday))\n\t\t{\n\t\t\tresult.birthday = fields.birthday;\n\t\t}\n\n\t\tif (Type.isBoolean(fields.extranet))\n\t\t{\n\t\t\tresult.extranet = fields.extranet;\n\t\t}\n\n\t\tif (Type.isBoolean(fields.network))\n\t\t{\n\t\t\tresult.network = fields.network;\n\t\t}\n\n\t\tif (Type.isBoolean(fields.bot))\n\t\t{\n\t\t\tresult.bot = fields.bot;\n\t\t}\n\n\t\tif (Type.isBoolean(fields.connector))\n\t\t{\n\t\t\tresult.connector = fields.connector;\n\t\t}\n\n\t\tif (Type.isStringFilled(fields.external_auth_id))\n\t\t{\n\t\t\tfields.externalAuthId = fields.external_auth_id;\n\t\t}\n\t\tif (Type.isStringFilled(fields.externalAuthId))\n\t\t{\n\t\t\tresult.externalAuthId = fields.externalAuthId;\n\t\t}\n\n\t\tif (Type.isStringFilled(fields.status))\n\t\t{\n\t\t\tresult.status = fields.status;\n\t\t}\n\n\t\tif (!Type.isUndefined(fields.idle))\n\t\t{\n\t\t\tresult.idle = Utils.date.cast(fields.idle, false);\n\t\t}\n\t\tif (!Type.isUndefined(fields.last_activity_date))\n\t\t{\n\t\t\tfields.lastActivityDate = fields.last_activity_date;\n\t\t}\n\t\tif (!Type.isUndefined(fields.lastActivityDate))\n\t\t{\n\t\t\tresult.lastActivityDate = Utils.date.cast(fields.lastActivityDate, false);\n\t\t}\n\t\tif (!Type.isUndefined(fields.mobile_last_date))\n\t\t{\n\t\t\tfields.mobileLastDate = fields.mobile_last_date;\n\t\t}\n\t\tif (!Type.isUndefined(fields.mobileLastDate))\n\t\t{\n\t\t\tresult.mobileLastDate = Utils.date.cast(fields.mobileLastDate, false);\n\t\t}\n\n\t\tif (!Type.isUndefined(fields.absent))\n\t\t{\n\t\t\tresult.absent = Utils.date.cast(fields.absent, false);\n\t\t}\n\n\t\tif (Array.isArray(fields.departments))\n\t\t{\n\t\t\tresult.departments = [];\n\t\t\tfields.departments.forEach(departmentId =>\n\t\t\t{\n\t\t\t\tdepartmentId = Number.parseInt(departmentId, 10);\n\t\t\t\tif (departmentId > 0)\n\t\t\t\t{\n\t\t\t\t\tresult.departments.push(departmentId);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tif (Type.isPlainObject(fields.phones))\n\t\t{\n\t\t\tresult.phones = this.preparePhones(fields.phones);\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tprepareAvatar(avatar: string): string\n\t{\n\t\tlet result = '';\n\n\t\tif (!avatar || avatar.endsWith('/js/im/images/blank.gif'))\n\t\t{\n\t\t\tresult = '';\n\t\t}\n\t\telse if (avatar.startsWith('http'))\n\t\t{\n\t\t\tresult = avatar;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tresult = Core.getHost() + avatar;\n\t\t}\n\n\t\tif (result)\n\t\t{\n\t\t\tresult = encodeURI(result);\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tpreparePhones(phones): Object\n\t{\n\t\tconst result = {};\n\n\t\tif (!Type.isUndefined(phones.work_phone))\n\t\t{\n\t\t\tphones.workPhone = phones.work_phone;\n\t\t}\n\t\tif (Type.isStringFilled(phones.workPhone) || Type.isNumber(phones.workPhone))\n\t\t{\n\t\t\tresult.workPhone =phones.workPhone.toString();\n\t\t}\n\n\t\tif (!Type.isUndefined(phones.personal_mobile))\n\t\t{\n\t\t\tphones.personalMobile = phones.personal_mobile;\n\t\t}\n\t\tif (Type.isStringFilled(phones.personalMobile) || Type.isNumber(phones.personalMobile))\n\t\t{\n\t\t\tresult.personalMobile = phones.personalMobile.toString();\n\t\t}\n\n\t\tif (!Type.isUndefined(phones.personal_phone))\n\t\t{\n\t\t\tphones.personalPhone = phones.personal_phone;\n\t\t}\n\t\tif (Type.isStringFilled(phones.personalPhone) || Type.isNumber(phones.personalPhone))\n\t\t{\n\t\t\tresult.personalPhone = phones.personalPhone.toString();\n\t\t}\n\n\t\tif (!Type.isUndefined(phones.inner_phone))\n\t\t{\n\t\t\tphones.innerPhone = phones.inner_phone;\n\t\t}\n\t\tif (Type.isStringFilled(phones.innerPhone) || Type.isNumber(phones.innerPhone))\n\t\t{\n\t\t\tresult.innerPhone = phones.innerPhone.toString();\n\t\t}\n\n\t\treturn result;\n\t}\n\n\taddToOnlineList(id)\n\t{\n\t\tconst state = this.store.state.users;\n\t\tif (!state.onlineList.includes(id))\n\t\t{\n\t\t\tstate.onlineList.push(id);\n\t\t}\n\t}\n\n\taddToMobileOnlineList(id)\n\t{\n\t\tconst state = this.store.state.users;\n\t\tif (!state.mobileOnlineList.includes(id))\n\t\t{\n\t\t\tstate.mobileOnlineList.push(id);\n\t\t}\n\t}\n\n\taddToAbsentList(id)\n\t{\n\t\tconst state = this.store.state.users;\n\t\tif (!state.absentList.includes(id))\n\t\t{\n\t\t\tstate.absentList.push(id);\n\t\t}\n\t}\n\n\tstartAbsentCheckInterval()\n\t{\n\t\tif (this.absentCheckInterval)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tconst TIME_TO_NEXT_DAY = 1000*60*60*24;\n\t\tthis.absentCheckInterval = setTimeout(() => {\n\t\t\tsetInterval(() => {\n\t\t\t\tconst state = this.store.state.users;\n\t\t\t\tstate.absentList.forEach(userId => {\n\t\t\t\t\tconst user = state.collection[userId];\n\t\t\t\t\tif (!user)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tconst currentTime = Date.now();\n\t\t\t\t\tconst absentEnd = new Date(user.absent).getTime();\n\n\t\t\t\t\tif (absentEnd <= currentTime)\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.absentList = state.absentList.filter(element => {\n\t\t\t\t\t\t\treturn element !== userId;\n\t\t\t\t\t\t});\n\t\t\t\t\t\tuser.isAbsent = false;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}, TIME_TO_NEXT_DAY);\n\t\t}, Utils.date.getTimeToNextMidnight());\n\t}\n\n\tstartOnlineCheckInterval()\n\t{\n\t\tif (this.onlineCheckInterval)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tconst ONE_MINUTE = 60000;\n\t\tthis.onlineCheckInterval = setInterval(() => {\n\t\t\tconst state = this.store.state.users;\n\n\t\t\tstate.onlineList.forEach(userId => {\n\t\t\t\tconst user = state.collection[userId];\n\t\t\t\tif (!user)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (Utils.user.isOnline(user.lastActivityDate))\n\t\t\t\t{\n\t\t\t\t\tuser.isOnline = true;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tuser.isOnline = false;\n\t\t\t\t\tstate.onlineList = state.onlineList.filter(element => element !== userId);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tstate.mobileOnlineList.forEach(userId => {\n\t\t\t\tconst user = state.collection[userId];\n\t\t\t\tif (!user)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (Utils.user.isMobileOnline(user.lastActivityDate, user.mobileLastDate))\n\t\t\t\t{\n\t\t\t\t\tuser.isMobileOnline = true;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tuser.isMobileOnline = false;\n\t\t\t\t\tstate.mobileOnlineList = state.mobileOnlineList.filter(element => element !== userId);\n\t\t\t\t}\n\t\t\t});\n\t\t}, ONE_MINUTE);\n\t}\n}","import {Type} from 'main.core';\nimport {BuilderModel} from 'ui.vue3.vuex';\n\nimport {Core} from 'im.v2.application.core';\nimport {FileStatus} from 'im.v2.const';\nimport {Utils} from 'im.v2.lib.utils';\n\nimport type {ImModelFile} from 'im.v2.model';\n\ntype FilesState = {\n\tcollection: {\n\t\t[fileId: string]: ImModelFile\n\t}\n};\n\nexport class FilesModel extends BuilderModel\n{\n\tgetName(): string\n\t{\n\t\treturn 'files';\n\t}\n\n\tgetState(): Object\n\t{\n\t\treturn {\n\t\t\tcollection: {},\n\t\t};\n\t}\n\n\tgetElementState()\n\t{\n\t\treturn {\n\t\t\tid: 0,\n\t\t\tchatId: 0,\n\t\t\tname: 'File is deleted',\n\t\t\tdate: new Date(),\n\t\t\ttype: 'file',\n\t\t\textension: '',\n\t\t\ticon: 'empty',\n\t\t\tsize: 0,\n\t\t\timage: false,\n\t\t\tstatus: FileStatus.done,\n\t\t\tprogress: 100,\n\t\t\tauthorId: 0,\n\t\t\tauthorName: '',\n\t\t\turlPreview: '',\n\t\t\turlShow: '',\n\t\t\turlDownload: '',\n\t\t\tviewerAttrs: null\n\t\t};\n\t}\n\n\tgetGetters()\n\t{\n\t\treturn {\n\t\t\tget: (state: FilesState) => (fileId: number, getTemporary = false): ?ImModelFile =>\n\t\t\t{\n\t\t\t\tif (!fileId)\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\tif (!getTemporary && !state.collection[fileId])\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[fileId];\n\t\t\t},\n\t\t\tisInCollection: (state: FilesState) => (payload: {fileId: number | string}): boolean =>\n\t\t\t{\n\t\t\t\tconst {fileId} = payload;\n\n\t\t\t\treturn !!state.collection[fileId];\n\t\t\t}\n\t\t};\n\t}\n\n\tgetActions()\n\t{\n\t\treturn {\n\t\t\tadd: (store, payload: Object) =>\n\t\t\t{\n\t\t\t\tconst preparedFile = {...this.getElementState(), ...this.validate(payload)};\n\n\t\t\t\tstore.commit('add', {files: [preparedFile]});\n\t\t\t},\n\t\t\tset: (store, payload: Object[]) =>\n\t\t\t{\n\t\t\t\tif (!Array.isArray(payload) && Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\tpayload = [payload];\n\t\t\t\t}\n\n\t\t\t\tpayload = payload.map(file => {\n\t\t\t\t\treturn {...this.getElementState(), ...this.validate(file)};\n\t\t\t\t});\n\n\t\t\t\tstore.commit('add', {files: payload});\n\t\t\t},\n\t\t\tupdate: (store, payload) =>\n\t\t\t{\n\t\t\t\tconst {id, fields} = payload;\n\t\t\t\tconst existingItem = store.state.collection[id];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tid: id,\n\t\t\t\t\tfields: this.validate(fields)\n\t\t\t\t});\n\n\t\t\t\treturn true;\n\t\t\t},\n\t\t\tupdateWithId: (store, payload: {id: string | number, fields: Object}) =>\n\t\t\t{\n\t\t\t\tconst {id, fields} = payload;\n\t\t\t\tif (!store.state.collection[id])\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('updateWithId', {\n\t\t\t\t\tid,\n\t\t\t\t\tfields: this.validate(fields)\n\t\t\t\t});\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMutations()\n\t{\n\t\treturn {\n\t\t\tadd: (state: FilesState, payload: {files: ImModelFile[]}) =>\n\t\t\t{\n\t\t\t\tpayload.files.forEach(file => {\n\t\t\t\t\tstate.collection[file.id] = file;\n\t\t\t\t});\n\t\t\t},\n\t\t\tupdate: (state: FilesState, payload) =>\n\t\t\t{\n\t\t\t\tObject.entries(payload.fields).forEach(([key, value]) => {\n\t\t\t\t\tstate.collection[payload.id][key] = value;\n\t\t\t\t});\n\t\t\t},\n\t\t\tupdateWithId: (state: FilesState, payload: {id: number | string, fields: Object}) =>\n\t\t\t{\n\t\t\t\tconst {id, fields} = payload;\n\t\t\t\tconst currentFile = {...state.collection[id]};\n\n\t\t\t\tdelete state.collection[id];\n\t\t\t\tstate.collection[fields.id] = {...currentFile, ...fields};\n\t\t\t},\n\t\t};\n\t}\n\n\tvalidate(file: Object): ImModelFile\n\t{\n\t\tconst result = {};\n\n\t\tif (Type.isNumber(file.id) || Type.isStringFilled(file.id))\n\t\t{\n\t\t\tresult.id = file.id;\n\t\t}\n\n\t\tif (Type.isNumber(file.chatId) || Type.isString(file.chatId))\n\t\t{\n\t\t\tresult.chatId = Number.parseInt(file.chatId, 10);\n\t\t}\n\n\t\tif (!Type.isUndefined(file.date))\n\t\t{\n\t\t\tresult.date = Utils.date.cast(file.date);\n\t\t}\n\n\t\tif (Type.isString(file.type))\n\t\t{\n\t\t\tresult.type = file.type;\n\t\t}\n\n\t\tif (Type.isString(file.extension))\n\t\t{\n\t\t\tresult.extension = file.extension.toString();\n\n\t\t\tif (result.type === 'image')\n\t\t\t{\n\t\t\t\tresult.icon = 'img';\n\t\t\t}\n\t\t\telse if (result.type === 'video')\n\t\t\t{\n\t\t\t\tresult.icon = 'mov';\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresult.icon = Utils.file.getIconTypeByExtension(result.extension);\n\t\t\t}\n\t\t}\n\n\t\tif (Type.isString(file.name) || Type.isNumber(file.name))\n\t\t{\n\t\t\tresult.name = file.name.toString();\n\t\t}\n\n\t\tif (Type.isNumber(file.size) || Type.isString(file.size))\n\t\t{\n\t\t\tresult.size = Number.parseInt(file.size, 10);\n\t\t}\n\n\t\tif (Type.isBoolean(file.image))\n\t\t{\n\t\t\tresult.image = false;\n\t\t}\n\t\telse if (Type.isPlainObject(file.image))\n\t\t{\n\t\t\tresult.image = {\n\t\t\t\twidth: 0,\n\t\t\t\theight: 0,\n\t\t\t};\n\n\t\t\tif (Type.isString(file.image.width) || Type.isNumber(file.image.width))\n\t\t\t{\n\t\t\t\tresult.image.width = Number.parseInt(file.image.width, 10);\n\t\t\t}\n\t\t\tif (Type.isString(file.image.height) || Type.isNumber(file.image.height))\n\t\t\t{\n\t\t\t\tresult.image.height = Number.parseInt(file.image.height, 10);\n\t\t\t}\n\n\t\t\tif (result.image.width <= 0 || result.image.height <= 0)\n\t\t\t{\n\t\t\t\tresult.image = false;\n\t\t\t}\n\t\t}\n\n\t\tif (Type.isString(file.status) && !Type.isUndefined(FileStatus[file.status]))\n\t\t{\n\t\t\tresult.status = file.status;\n\t\t}\n\n\t\tif (Type.isNumber(file.progress) || Type.isString(file.progress))\n\t\t{\n\t\t\tresult.progress = Number.parseInt(file.progress, 10);\n\t\t}\n\n\t\tif (Type.isNumber(file.authorId) || Type.isString(file.authorId))\n\t\t{\n\t\t\tresult.authorId = Number.parseInt(file.authorId, 10);\n\t\t}\n\n\t\tif (Type.isString(file.authorName) || Type.isNumber(file.authorName))\n\t\t{\n\t\t\tresult.authorName = file.authorName.toString();\n\t\t}\n\n\t\tif (Type.isString(file.urlPreview))\n\t\t{\n\t\t\tif (\n\t\t\t\t!file.urlPreview\n\t\t\t\t|| file.urlPreview.startsWith('http')\n\t\t\t\t|| file.urlPreview.startsWith('bx')\n\t\t\t\t|| file.urlPreview.startsWith('file')\n\t\t\t\t|| file.urlPreview.startsWith('blob')\n\t\t\t)\n\t\t\t{\n\t\t\t\tresult.urlPreview = file.urlPreview;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresult.urlPreview = Core.getHost() + file.urlPreview;\n\t\t\t}\n\t\t}\n\n\t\tif (Type.isString(file.urlDownload))\n\t\t{\n\t\t\tif (\n\t\t\t\t!file.urlDownload\n\t\t\t\t|| file.urlDownload.startsWith('http')\n\t\t\t\t|| file.urlDownload.startsWith('bx')\n\t\t\t\t|| file.urlPreview.startsWith('file')\n\t\t\t)\n\t\t\t{\n\t\t\t\tresult.urlDownload = file.urlDownload;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresult.urlDownload = Core.getHost() + file.urlDownload;\n\t\t\t}\n\t\t}\n\n\t\tif (Type.isString(file.urlShow))\n\t\t{\n\t\t\tif (\n\t\t\t\t!file.urlShow\n\t\t\t\t|| file.urlShow.startsWith('http')\n\t\t\t\t|| file.urlShow.startsWith('bx')\n\t\t\t\t|| file.urlShow.startsWith('file')\n\t\t\t)\n\t\t\t{\n\t\t\t\tresult.urlShow = file.urlShow;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresult.urlShow = Core.getHost() + file.urlShow;\n\t\t\t}\n\t\t}\n\n\t\tif (Type.isPlainObject(file.viewerAttrs))\n\t\t{\n\t\t\tresult.viewerAttrs = this.validateViewerAttributes(file.viewerAttrs);\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tvalidateViewerAttributes(viewerAttrs)\n\t{\n\t\tconst result = {\n\t\t\tviewer: true,\n\t\t};\n\n\t\tif (Type.isString(viewerAttrs.actions))\n\t\t{\n\t\t\tresult.actions = viewerAttrs.actions;\n\t\t}\n\n\t\tif (Type.isString(viewerAttrs.objectId))\n\t\t{\n\t\t\tresult.objectId = viewerAttrs.objectId;\n\t\t}\n\n\t\tif (Type.isString(viewerAttrs.src))\n\t\t{\n\t\t\tresult.src = viewerAttrs.src;\n\t\t}\n\n\t\tif (Type.isString(viewerAttrs.title))\n\t\t{\n\t\t\tresult.title = viewerAttrs.title;\n\t\t}\n\n\t\tif (Type.isString(viewerAttrs.viewerGroupBy))\n\t\t{\n\t\t\tresult.viewerGroupBy = viewerAttrs.viewerGroupBy;\n\t\t}\n\n\t\tif (Type.isString(viewerAttrs.viewerType))\n\t\t{\n\t\t\tresult.viewerType = viewerAttrs.viewerType;\n\t\t}\n\n\t\tif (Type.isString(viewerAttrs.viewerTypeClass))\n\t\t{\n\t\t\tresult.viewerTypeClass = viewerAttrs.viewerTypeClass;\n\t\t}\n\n\t\tif (Type.isBoolean(viewerAttrs.viewerSeparateItem))\n\t\t{\n\t\t\tresult.viewerSeparateItem = viewerAttrs.viewerSeparateItem;\n\t\t}\n\n\t\tif (Type.isString(viewerAttrs.viewerExtension))\n\t\t{\n\t\t\tresult.viewerExtension = viewerAttrs.viewerExtension;\n\t\t}\n\n\t\tif (Type.isNumber(viewerAttrs.imChatId))\n\t\t{\n\t\t\tresult.imChatId = viewerAttrs.imChatId;\n\t\t}\n\n\t\treturn result;\n\t}\n}\n","import {Type} from 'main.core';\nimport {BuilderModel, GetterTree, ActionTree, MutationTree} from 'ui.vue3.vuex';\n\nimport {RecentCallStatus} from 'im.v2.const';\n\nimport type {ImModelCallItem} from 'im.v2.model';\n\ntype CallsState = {\n\tcollection: {\n\t\t[dialogId: string]: ImModelCallItem\n\t}\n};\n\nexport class CallsModel extends BuilderModel\n{\n\tgetState()\n\t{\n\t\treturn {\n\t\t\tcollection: {}\n\t\t};\n\t}\n\n\tgetElementState()\n\t{\n\t\treturn {\n\t\t\tdialogId: 0,\n\t\t\tname: '',\n\t\t\tcall: {},\n\t\t\tstate: RecentCallStatus.waiting\n\t\t};\n\t}\n\n\tgetGetters(): GetterTree\n\t{\n\t\treturn {\n\t\t\tget: (state: CallsState): ImModelCallItem[] =>\n\t\t\t{\n\t\t\t\treturn Object.values(state.collection);\n\t\t\t}\n\t\t};\n\t}\n\n\tgetActions(): ActionTree\n\t{\n\t\treturn {\n\t\t\taddActiveCall: (store, payload: ImModelCallItem) =>\n\t\t\t{\n\t\t\t\tconst existingCall = Object.values(store.state.collection).find((item: ImModelCallItem) => {\n\t\t\t\t\treturn item.dialogId === payload.dialogId || item.call.id === payload.call.id;\n\t\t\t\t});\n\n\t\t\t\tif (existingCall)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('updateActiveCall', {\n\t\t\t\t\t\tdialogId: existingCall.dialogId,\n\t\t\t\t\t\tfields: this.validateActiveCall(payload)\n\t\t\t\t\t});\n\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('addActiveCall', this.prepareActiveCall(payload));\n\t\t\t},\n\t\t\tupdateActiveCall: (store, payload) =>\n\t\t\t{\n\t\t\t\tconst existingCall = store.state.collection[payload.dialogId];\n\t\t\t\tif (!existingCall)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('updateActiveCall', {\n\t\t\t\t\tdialogId: existingCall.dialogId,\n\t\t\t\t\tfields: this.validateActiveCall(payload.fields)\n\t\t\t\t});\n\t\t\t},\n\t\t\tdeleteActiveCall: (store, payload) =>\n\t\t\t{\n\t\t\t\tconst existingCall = store.state.collection[payload.dialogId];\n\t\t\t\tif (!existingCall)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('deleteActiveCall', {\n\t\t\t\t\tdialogId: existingCall.dialogId\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\t}\n\n\tgetMutations(): MutationTree\n\t{\n\t\treturn {\n\t\t\taddActiveCall: (state: CallsState, payload: ImModelCallItem) => {\n\t\t\t\tstate.collection[payload.dialogId] = payload;\n\t\t\t},\n\t\t\tupdateActiveCall: (state: CallsState, payload) => {\n\t\t\t\tstate.collection[payload.dialogId] = {\n\t\t\t\t\t...state.collection[payload.dialogId],\n\t\t\t\t\t...payload.fields\n\t\t\t\t};\n\t\t\t},\n\t\t\tdeleteActiveCall: (state: CallsState, payload) => {\n\t\t\t\tdelete state.collection[payload.dialogId];\n\t\t\t},\n\t\t};\n\t}\n\n\tprepareActiveCall(call)\n\t{\n\t\treturn {...this.getElementState(), ...this.validateActiveCall(call)};\n\t}\n\n\tvalidateActiveCall(fields)\n\t{\n\t\tconst result = {};\n\n\t\tif (Type.isStringFilled(fields.dialogId) || Type.isNumber(fields.dialogId))\n\t\t{\n\t\t\tresult.dialogId = fields.dialogId;\n\t\t}\n\n\t\tif (Type.isStringFilled(fields.name))\n\t\t{\n\t\t\tresult.name = fields.name;\n\t\t}\n\n\t\tif (Type.isObjectLike(fields.call))\n\t\t{\n\t\t\tresult.call = fields.call;\n\n\t\t\tif (fields.call?.associatedEntity?.avatar === '/bitrix/js/im/images/blank.gif')\n\t\t\t{\n\t\t\t\tresult.call.associatedEntity.avatar = '';\n\t\t\t}\n\t\t}\n\n\t\tif (RecentCallStatus[fields.state])\n\t\t{\n\t\t\tresult.state = fields.state;\n\t\t}\n\n\t\treturn result;\n\t}\n}","import {Type} from 'main.core';\nimport {BuilderModel} from 'ui.vue3.vuex';\n\nimport {Core} from 'im.v2.application.core';\nimport {DialogType, MessageStatus, Settings} from 'im.v2.const';\nimport {Utils} from 'im.v2.lib.utils';\n\nimport {CallsModel} from './recent/calls';\n\nimport type {RecentItem as ImModelRecentItem} from './type/recent-item';\nimport type {Dialog as ImModelDialog} from './type/dialog';\n\ntype RecentState = {\n\tcollection: {[dialogId: string]: ImModelRecentItem},\n\trecentCollection: Set<string>,\n\tunreadCollection: Set<string>,\n\tmarkedCollection: Set<number>,\n\tunloadedChatCounters: {[chatId: string]: number}\n};\n\nexport class RecentModel extends BuilderModel\n{\n\tgetName()\n\t{\n\t\treturn 'recent';\n\t}\n\n\tgetNestedModules(): { [moduleName: string]: BuilderModel }\n\t{\n\t\treturn {calls: CallsModel};\n\t}\n\n\tgetState()\n\t{\n\t\treturn {\n\t\t\tcollection: {},\n\t\t\trecentCollection: new Set(),\n\t\t\tunreadCollection: new Set(),\n\t\t\tunloadedChatCounters: {}\n\t\t};\n\t}\n\n\tgetElementState()\n\t{\n\t\treturn {\n\t\t\tdialogId: '0',\n\t\t\tmessage: {\n\t\t\t\tid: 0,\n\t\t\t\tsenderId: 0,\n\t\t\t\tdate: new Date(),\n\t\t\t\tstatus: MessageStatus.received,\n\t\t\t\tsending: false,\n\t\t\t\ttext: '',\n\t\t\t\tparams: {\n\t\t\t\t\twithFile: false,\n\t\t\t\t\twithAttach: false,\n\t\t\t\t}\n\t\t\t},\n\t\t\tdraft: {\n\t\t\t\ttext: '',\n\t\t\t\tdate: null\n\t\t\t},\n\t\t\tunread: false,\n\t\t\tpinned: false,\n\t\t\tliked: false,\n\t\t\tinvitation: {\n\t\t\t\tisActive: false,\n\t\t\t\toriginator: 0,\n\t\t\t\tcanResend: false\n\t\t\t},\n\t\t\toptions: {}\n\t\t};\n\t}\n\n\tgetGetters()\n\t{\n\t\treturn {\n\t\t\tgetRecentCollection: (state: RecentState): ImModelRecentItem[] =>\n\t\t\t{\n\t\t\t\treturn [...state.recentCollection].map(id => {\n\t\t\t\t\treturn state.collection[id];\n\t\t\t\t});\n\t\t\t},\n\t\t\tgetUnreadCollection: (state: RecentState): ImModelRecentItem[] =>\n\t\t\t{\n\t\t\t\treturn [...state.unreadCollection].map(id => {\n\t\t\t\t\treturn state.collection[id];\n\t\t\t\t});\n\t\t\t},\n\t\t\tgetSortedCollection: (state: RecentState): ImModelRecentItem[] =>\n\t\t\t{\n\t\t\t\tconst collectionAsArray = Object.values(state.collection).filter(item => {\n\t\t\t\t\tconst isBirthdayPlaceholder = item.options.birthdayPlaceholder;\n\t\t\t\t\tconst isInvitedUser = item.options.defaultUserRecord;\n\n\t\t\t\t\treturn !isBirthdayPlaceholder && !isInvitedUser && item.message.id;\n\t\t\t\t});\n\n\t\t\t\treturn [...collectionAsArray].sort((a, b) => {\n\t\t\t\t\treturn b.message.date - a.message.date;\n\t\t\t\t});\n\t\t\t},\n\t\t\tget: (state: RecentState) => (dialogId: string): ImModelRecentItem | null =>\n\t\t\t{\n\t\t\t\tif (Type.isNumber(dialogId))\n\t\t\t\t{\n\t\t\t\t\tdialogId = dialogId.toString();\n\t\t\t\t}\n\n\t\t\t\tif (state.collection[dialogId])\n\t\t\t\t{\n\t\t\t\t\treturn state.collection[dialogId];\n\t\t\t\t}\n\n\t\t\t\treturn null;\n\t\t\t},\n\n\t\t\tneedsBirthdayPlaceholder: (state: RecentState) => (dialogId): boolean =>\n\t\t\t{\n\t\t\t\tconst currentItem = state.collection[dialogId];\n\t\t\t\tif (!currentItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst dialog = this.store.getters['dialogues/get'](dialogId);\n\t\t\t\tif (!dialog || dialog.type !== DialogType.user)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tconst hasBirthday = this.store.getters['users/hasBirthday'](dialogId);\n\t\t\t\tif (!hasBirthday)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst hasMessage = Utils.text.isTempMessage(currentItem.message.id) || currentItem.message.id > 0;\n\t\t\t\tconst hasTodayMessage = hasMessage && Utils.date.isToday(currentItem.message.date);\n\n\t\t\t\tconst showBirthday = this.store.getters['application/settings/get'](Settings.recent.showBirthday);\n\t\t\t\treturn showBirthday && !hasTodayMessage && dialog.counter === 0;\n\t\t\t},\n\n\t\t\tneedsVacationPlaceholder: (state: RecentState) => (dialogId): boolean =>\n\t\t\t{\n\t\t\t\tconst currentItem = state.collection[dialogId];\n\t\t\t\tif (!currentItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst dialog = this.store.getters['dialogues/get'](dialogId);\n\t\t\t\tif (!dialog || dialog.type !== DialogType.user)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tconst hasVacation = this.store.getters['users/hasVacation'](dialogId);\n\t\t\t\tif (!hasVacation)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst hasMessage = Utils.text.isTempMessage(currentItem.message.id) || currentItem.message.id > 0;\n\t\t\t\tconst hasTodayMessage = hasMessage && Utils.date.isToday(currentItem.message.date);\n\n\t\t\t\treturn !hasTodayMessage && dialog.counter === 0;\n\t\t\t},\n\n\t\t\tgetMessageDate: (state: RecentState) => (dialogId): Date | null =>\n\t\t\t{\n\t\t\t\tconst currentItem = state.collection[dialogId];\n\t\t\t\tif (!currentItem)\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\tif (Type.isDate(currentItem.draft.date) && currentItem.draft.date > currentItem.message.date)\n\t\t\t\t{\n\t\t\t\t\treturn currentItem.draft.date;\n\t\t\t\t}\n\n\t\t\t\tconst needsBirthdayPlaceholder = this.store.getters['recent/needsBirthdayPlaceholder'](currentItem.dialogId);\n\t\t\t\tif (needsBirthdayPlaceholder)\n\t\t\t\t{\n\t\t\t\t\treturn Utils.date.getStartOfTheDay();\n\t\t\t\t}\n\n\t\t\t\treturn currentItem.message.date;\n\t\t\t},\n\n\t\t\tgetTotalCounter: (state: RecentState): number =>\n\t\t\t{\n\t\t\t\tlet loadedChatsCounter = 0;\n\t\t\t\t[...state.recentCollection].forEach(dialogId => {\n\t\t\t\t\tconst dialog: ImModelDialog = this.store.getters['dialogues/get'](dialogId, true);\n\t\t\t\t\tconst recentItem: ImModelRecentItem = state.collection[dialogId];\n\n\t\t\t\t\tconst isMuted = dialog.muteList.includes(Core.getUserId());\n\t\t\t\t\tif (isMuted)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tconst isMarked = recentItem.unread;\n\t\t\t\t\tif (dialog.counter === 0 && isMarked)\n\t\t\t\t\t{\n\t\t\t\t\t\tloadedChatsCounter++;\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tloadedChatsCounter += dialog.counter;\n\t\t\t\t});\n\n\t\t\t\tlet unloadedChatsCounter = 0;\n\t\t\t\tObject.values(state.unloadedChatCounters).forEach(counter => {\n\t\t\t\t\tunloadedChatsCounter += counter;\n\t\t\t\t});\n\n\t\t\t\treturn loadedChatsCounter + unloadedChatsCounter;\n\t\t\t}\n\t\t};\n\t}\n\n\tgetActions()\n\t{\n\t\treturn {\n\t\t\tsetRecent: (store, payload: Array | Object) =>\n\t\t\t{\n\t\t\t\tthis.store.dispatch('recent/set', payload).then(itemIds => {\n\t\t\t\t\tstore.commit('setRecentCollection', itemIds);\n\t\t\t\t});\n\n\t\t\t\tif (!Array.isArray(payload) && Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\tpayload = [payload];\n\t\t\t\t}\n\t\t\t\tconst zeroedCountersForNewItems = {};\n\t\t\t\tpayload.forEach(item => {\n\t\t\t\t\tzeroedCountersForNewItems[item.chat_id] = 0;\n\t\t\t\t});\n\t\t\t\tthis.store.dispatch('recent/setUnloadedChatCounters', zeroedCountersForNewItems);\n\t\t\t},\n\t\t\tsetUnread: (store, payload: Array | Object) =>\n\t\t\t{\n\t\t\t\tthis.store.dispatch('recent/set', payload).then(itemIds => {\n\t\t\t\t\tstore.commit('setUnreadCollection', itemIds);\n\t\t\t\t});\n\t\t\t},\n\t\t\tset: (store, payload: Array | Object) =>\n\t\t\t{\n\t\t\t\tif (!Array.isArray(payload) && Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\tpayload = [payload];\n\t\t\t\t}\n\n\t\t\t\tconst itemsToUpdate = [];\n\t\t\t\tconst itemsToAdd = [];\n\t\t\t\tpayload.map(element => {\n\t\t\t\t\treturn this.validate(element);\n\t\t\t\t}).forEach(element => {\n\t\t\t\t\tconst existingItem = store.state.collection[element.dialogId];\n\t\t\t\t\tif (existingItem)\n\t\t\t\t\t{\n\t\t\t\t\t\titemsToUpdate.push({dialogId: existingItem.dialogId, fields: {...element}});\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\titemsToAdd.push({...this.getElementState(), ...element});\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tif (itemsToAdd.length > 0)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('add', itemsToAdd);\n\t\t\t\t}\n\t\t\t\tif (itemsToUpdate.length > 0)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('update', itemsToUpdate);\n\t\t\t\t}\n\n\t\t\t\treturn [...itemsToAdd, ...itemsToUpdate].map(item => item.dialogId);\n\t\t\t},\n\n\t\t\tupdate: (store, payload: {id: string | number, fields: Object}) =>\n\t\t\t{\n\t\t\t\tconst {id, fields} = payload;\n\t\t\t\tconst existingItem: ImModelRecentItem = store.state.collection[id];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tif (fields.message)\n\t\t\t\t{\n\t\t\t\t\tfields.message = {...existingItem.message, ...fields.message};\n\t\t\t\t}\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tdialogId: existingItem.dialogId,\n\t\t\t\t\tfields: this.validate(fields)\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tunread: (store, payload: {id: string | number, action: boolean}) =>\n\t\t\t{\n\t\t\t\tconst existingItem = store.state.collection[payload.id];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tdialogId: existingItem.dialogId,\n\t\t\t\t\tfields: {unread: payload.action}\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tpin: (store, payload: {id: string | number, action: boolean}) =>\n\t\t\t{\n\t\t\t\tconst existingItem = store.state.collection[payload.id];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tdialogId: existingItem.dialogId,\n\t\t\t\t\tfields: {pinned: payload.action}\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tlike: (store, payload: {id: string | number, messageId: number, liked: boolean}) =>\n\t\t\t{\n\t\t\t\tconst existingItem = store.state.collection[payload.id];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst isLastMessage = existingItem.message.id === Number.parseInt(payload.messageId, 10);\n\t\t\t\tconst isExactMessageLiked = !Type.isUndefined(payload.messageId) && payload.liked === true;\n\t\t\t\tif (isExactMessageLiked && !isLastMessage)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tdialogId: existingItem.dialogId,\n\t\t\t\t\tfields: {liked: payload.liked === true}\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tdraft: (store, payload: {id: string | number, text: string}) =>\n\t\t\t{\n\t\t\t\tconst dialog = this.store.getters['dialogues/get'](payload.id);\n\t\t\t\tif (!dialog)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tlet existingItem = store.state.collection[payload.id];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\tif (payload.text === '')\n\t\t\t\t\t{\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t\tconst newItem = {\n\t\t\t\t\t\tdialogId: payload.id.toString(),\n\t\t\t\t\t};\n\t\t\t\t\tstore.commit('add', {...this.getElementState(), ...newItem});\n\t\t\t\t\tstore.commit('setRecentCollection', [newItem.dialogId]);\n\t\t\t\t\texistingItem = store.state.collection[payload.id];\n\t\t\t\t}\n\n\t\t\t\tconst fields = this.validate({draft: {text: payload.text.toString()}});\n\t\t\t\tif (fields.draft.text === existingItem.draft.text)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tdialogId: existingItem.dialogId,\n\t\t\t\t\tfields\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tdelete: (store, payload: {id: string | number}) =>\n\t\t\t{\n\t\t\t\tconst existingItem = store.state.collection[payload.id];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('delete', {\n\t\t\t\t\tid: existingItem.dialogId\n\t\t\t\t});\n\t\t\t\tstore.commit('deleteFromRecentCollection', existingItem.dialogId);\n\t\t\t},\n\n\t\t\tclearUnread: (store) =>\n\t\t\t{\n\t\t\t\tstore.commit('clearUnread');\n\t\t\t},\n\n\t\t\tsetUnloadedChatCounters: (store, payload: {[chatId: string]: number}) =>\n\t\t\t{\n\t\t\t\tif (!Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setUnloadedChatCounters', payload);\n\t\t\t}\n\t\t};\n\t}\n\n\tgetMutations()\n\t{\n\t\treturn {\n\t\t\tsetRecentCollection: (state: RecentState, payload: string[]) => {\n\t\t\t\tpayload.forEach(dialogId => {\n\t\t\t\t\tstate.recentCollection.add(dialogId);\n\t\t\t\t});\n\t\t\t},\n\t\t\tdeleteFromRecentCollection: (state: RecentState, payload: string) => {\n\t\t\t\tstate.recentCollection.delete(payload);\n\t\t\t},\n\t\t\tsetUnreadCollection: (state: RecentState, payload: string[]) => {\n\t\t\t\tpayload.forEach(dialogId => {\n\t\t\t\t\tstate.unreadCollection.add(dialogId);\n\t\t\t\t});\n\t\t\t},\n\t\t\tadd: (state: RecentState, payload: Object[] | Object) => {\n\t\t\t\tif (!Array.isArray(payload) && Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\tpayload = [payload];\n\t\t\t\t}\n\t\t\t\tpayload.forEach(item => {\n\t\t\t\t\tstate.collection[item.dialogId] = item;\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tupdate: (state: RecentState, payload: Object[] | Object) => {\n\t\t\t\tif (!Array.isArray(payload) && Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\tpayload = [payload];\n\t\t\t\t}\n\t\t\t\tpayload.forEach(({dialogId, fields}) => {\n\t\t\t\t\t// if we already got chat - we should not update it with default user chat (unless it's an accepted invitation)\n\t\t\t\t\tconst defaultUserElement = fields.options && fields.options.defaultUserRecord && !fields.invitation;\n\t\t\t\t\tif (defaultUserElement)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst currentElement = state.collection[dialogId];\n\t\t\t\t\tfields.message = {...currentElement.message, ...fields.message};\n\t\t\t\t\tfields.options = {...currentElement.options, ...fields.options};\n\t\t\t\t\tstate.collection[dialogId] = {\n\t\t\t\t\t\t...currentElement,\n\t\t\t\t\t\t...fields\n\t\t\t\t\t};\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tdelete: (state: RecentState, payload: {id: string}) => {\n\t\t\t\tdelete state.collection[payload.id];\n\t\t\t},\n\n\t\t\tclearUnread: (state: RecentState) => {\n\t\t\t\tObject.keys(state.collection).forEach(key => {\n\t\t\t\t\tstate.collection[key].unread = false;\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tsetUnloadedChatCounters: (state: RecentState, payload: {[chatId: string]: number}) => {\n\t\t\t\tObject.entries(payload).forEach(([chatId, counter]) => {\n\t\t\t\t\tif (counter === 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tdelete state.unloadedChatCounters[chatId];\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tstate.unloadedChatCounters[chatId] = counter;\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\t}\n\n\tvalidate(fields: Object)\n\t{\n\t\tconst result = {\n\t\t\toptions: {}\n\t\t};\n\n\t\tif (Type.isNumber(fields.id))\n\t\t{\n\t\t\tresult.dialogId = fields.id.toString();\n\t\t}\n\t\tif (Type.isStringFilled(fields.id))\n\t\t{\n\t\t\tresult.dialogId = fields.id;\n\t\t}\n\n\t\tif (Type.isNumber(fields.dialogId))\n\t\t{\n\t\t\tresult.dialogId = fields.dialogId.toString();\n\t\t}\n\t\tif (Type.isStringFilled(fields.dialogId))\n\t\t{\n\t\t\tresult.dialogId = fields.dialogId;\n\t\t}\n\n\t\tif (Type.isPlainObject(fields.message))\n\t\t{\n\t\t\tresult.message = this.prepareMessage(fields);\n\t\t}\n\n\t\tif (Type.isPlainObject(fields.draft))\n\t\t{\n\t\t\tresult.draft = this.prepareDraft(fields);\n\t\t}\n\n\t\tif (Type.isBoolean(fields.unread))\n\t\t{\n\t\t\tresult.unread = fields.unread;\n\t\t}\n\n\t\tif (Type.isBoolean(fields.pinned))\n\t\t{\n\t\t\tresult.pinned = fields.pinned;\n\t\t}\n\n\t\tif (Type.isBoolean(fields.liked))\n\t\t{\n\t\t\tresult.liked = fields.liked;\n\t\t}\n\n\t\tif (Type.isPlainObject(fields.invited))\n\t\t{\n\t\t\tresult.invitation = {\n\t\t\t\tisActive: true,\n\t\t\t\toriginator: fields.invited.originator_id,\n\t\t\t\tcanResend: fields.invited.can_resend\n\t\t\t};\n\t\t\tresult.options.defaultUserRecord = true;\n\t\t}\n\t\telse if (fields.invited === false)\n\t\t{\n\t\t\tresult.invitation = {\n\t\t\t\tisActive: false,\n\t\t\t\toriginator: 0,\n\t\t\t\tcanResend: false\n\t\t\t};\n\t\t\tresult.options.defaultUserRecord = true;\n\t\t}\n\n\t\tif (Type.isPlainObject(fields.options))\n\t\t{\n\t\t\tif (!result.options)\n\t\t\t{\n\t\t\t\tresult.options = {};\n\t\t\t}\n\n\t\t\tif (Type.isBoolean(fields.options.default_user_record))\n\t\t\t{\n\t\t\t\tfields.options.defaultUserRecord = fields.options.default_user_record;\n\t\t\t}\n\n\t\t\tif (Type.isBoolean(fields.options.defaultUserRecord))\n\t\t\t{\n\t\t\t\tresult.options.defaultUserRecord = fields.options.defaultUserRecord;\n\t\t\t}\n\n\t\t\tif (Type.isBoolean(fields.options.birthdayPlaceholder))\n\t\t\t{\n\t\t\t\tresult.options.birthdayPlaceholder = fields.options.birthdayPlaceholder;\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tprepareMessage(fields: Object): Object\n\t{\n\t\tconst {message} = this.getElementState();\n\t\tif (Type.isNumber(fields.message.id) || Utils.text.isUuidV4(fields.message.id) || Type.isStringFilled(fields.message.id))\n\t\t{\n\t\t\tmessage.id = fields.message.id;\n\t\t}\n\t\tif (Type.isString(fields.message.text))\n\t\t{\n\t\t\tmessage.text = fields.message.text;\n\t\t}\n\n\t\tif (\n\t\t\tType.isStringFilled(fields.message.attach)\n\t\t\t|| Type.isBoolean(fields.message.attach)\n\t\t\t|| Type.isArray(fields.message.attach)\n\t\t)\n\t\t{\n\t\t\tmessage.params.withAttach = fields.message.attach;\n\t\t}\n\t\telse if (\n\t\t\tType.isStringFilled(fields.message.params?.withAttach)\n\t\t\t|| Type.isBoolean(fields.message.params?.withAttach)\n\t\t\t|| Type.isArray(fields.message.params?.withAttach)\n\t\t)\n\t\t{\n\t\t\tmessage.params.withAttach = fields.message.params.withAttach;\n\t\t}\n\n\t\tif (Type.isBoolean(fields.message.file) || Type.isPlainObject(fields.message.file))\n\t\t{\n\t\t\tmessage.params.withFile = fields.message.file;\n\t\t}\n\t\telse if (Type.isBoolean(fields.message.params?.withFile) || Type.isPlainObject(fields.message.params?.withFile))\n\t\t{\n\t\t\tmessage.params.withFile = fields.message.params.withFile;\n\t\t}\n\n\t\tif (Type.isDate(fields.message.date) || Type.isString(fields.message.date))\n\t\t{\n\t\t\tmessage.date = Utils.date.cast(fields.message.date);\n\t\t}\n\n\t\tif (Type.isNumber(fields.message.author_id))\n\t\t{\n\t\t\tmessage.senderId = fields.message.author_id;\n\t\t}\n\t\telse if (Type.isNumber(fields.message.authorId))\n\t\t{\n\t\t\tmessage.senderId = fields.message.authorId;\n\t\t}\n\t\telse if (Type.isNumber(fields.message.senderId))\n\t\t{\n\t\t\tmessage.senderId = fields.message.senderId;\n\t\t}\n\n\t\tif (Type.isStringFilled(fields.message.status))\n\t\t{\n\t\t\tmessage.status = fields.message.status;\n\t\t}\n\t\tif (Type.isBoolean(fields.message.sending))\n\t\t{\n\t\t\tmessage.sending = fields.message.sending;\n\t\t}\n\n\t\treturn message;\n\t}\n\n\tprepareDraft(fields: Object): Object\n\t{\n\t\tconst {draft} = this.getElementState();\n\n\t\tif (Type.isString(fields.draft.text))\n\t\t{\n\t\t\tdraft.text = fields.draft.text;\n\t\t}\n\n\t\tif (Type.isStringFilled(draft.text))\n\t\t{\n\t\t\tdraft.date = new Date();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tdraft.date = null;\n\t\t}\n\n\t\treturn draft;\n\t}\n}","import {BuilderModel} from 'ui.vue3.vuex';\nimport {Type, Text} from 'main.core';\n\nimport {Core} from 'im.v2.application.core';\nimport {Utils} from 'im.v2.lib.utils';\nimport {NotificationTypesCodes} from 'im.v2.const';\n\nexport class NotificationsModel extends BuilderModel\n{\n\tgetName(): string\n\t{\n\t\treturn 'notifications';\n\t}\n\n\tgetState(): Object\n\t{\n\t\treturn {\n\t\t\tcollection: new Map(),\n\t\t\tsearchCollection: new Map(),\n\t\t\tunreadCounter: 0,\n\t\t};\n\t}\n\n\tgetElementState(): Object\n\t{\n\t\treturn {\n\t\t\tid: 0,\n\t\t\tauthorId: 0,\n\t\t\tdate: new Date(),\n\t\t\ttitle: '',\n\t\t\ttext: '',\n\t\t\tparams: {},\n\t\t\treplaces: [],\n\t\t\tnotifyButtons: [],\n\t\t\tsectionCode: NotificationTypesCodes.simple,\n\t\t\tread: false,\n\t\t\tsettingName: 'im|default',\n\t\t};\n\t}\n\n\tgetGetters(): Object\n\t{\n\t\treturn {\n\t\t\tgetSortedCollection: state =>\n\t\t\t{\n\t\t\t\treturn [...state.collection.values()].sort(this.sortByType);\n\t\t\t},\n\t\t\tgetSearchResultCollection: state =>\n\t\t\t{\n\t\t\t\treturn [...state.searchCollection.values()].sort(this.sortByType);\n\t\t\t},\n\t\t\tgetConfirmsCount: state =>\n\t\t\t{\n\t\t\t\treturn [...state.collection.values()].filter(notification => {\n\t\t\t\t\treturn notification.sectionCode === NotificationTypesCodes.confirm;\n\t\t\t\t}).length;\n\t\t\t},\n\t\t\tgetById: state => (notificationId) =>\n\t\t\t{\n\t\t\t\tif (Type.isString(notificationId))\n\t\t\t\t{\n\t\t\t\t\tnotificationId = Number.parseInt(notificationId, 10);\n\t\t\t\t}\n\n\t\t\t\tconst existingItem = state.collection.get(notificationId);\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn existingItem;\n\t\t\t},\n\t\t\tgetCounter: (state): number =>\n\t\t\t{\n\t\t\t\treturn state.unreadCounter;\n\t\t\t}\n\t\t};\n\t}\n\n\tgetActions(): Object\n\t{\n\t\treturn {\n\t\t\tinitialSet: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (Type.isNumber(payload.total_unread_count))\n\t\t\t\t{\n\t\t\t\t\tstore.commit('setCounter', payload.total_unread_count);\n\t\t\t\t}\n\n\t\t\t\tif (!Type.isArrayFilled(payload.notifications))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst itemsToUpdate = [];\n\t\t\t\tconst itemsToAdd = [];\n\n\t\t\t\tconst currentUserId = Core.getUserId();\n\t\t\t\tpayload.notifications.map(element => {\n\t\t\t\t\treturn NotificationsModel.validate(element, currentUserId);\n\t\t\t\t}).forEach(element => {\n\t\t\t\t\tconst existingItem = store.state.collection.get(element.id);\n\t\t\t\t\tif (existingItem)\n\t\t\t\t\t{\n\t\t\t\t\t\titemsToUpdate.push({id: existingItem.id, fields: {...element}});\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\titemsToAdd.push({...this.getElementState(), ...element});\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tif (itemsToAdd.length > 0)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('add', itemsToAdd);\n\t\t\t\t}\n\t\t\t\tif (itemsToUpdate.length > 0)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('update', itemsToUpdate);\n\t\t\t\t}\n\t\t\t},\n\t\t\tset: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (!Array.isArray(payload) && Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\tpayload = [payload];\n\t\t\t\t}\n\n\t\t\t\tconst itemsToUpdate = [];\n\t\t\t\tconst itemsToAdd = [];\n\t\t\t\tconst currentUserId = Core.getUserId();\n\t\t\t\tpayload.map(element => {\n\t\t\t\t\treturn NotificationsModel.validate(element, currentUserId);\n\t\t\t\t}).forEach(element => {\n\t\t\t\t\tconst existingItem = store.state.collection.get(element.id);\n\t\t\t\t\tif (existingItem)\n\t\t\t\t\t\t{\n\t\t\t\t\t\titemsToUpdate.push({id: existingItem.id, fields: {...element}});\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\titemsToAdd.push({...this.getElementState(), ...element});\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tif (itemsToAdd.length > 0)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('add', itemsToAdd);\n\t\t\t\t\titemsToAdd.forEach(() => {\n\t\t\t\t\t\tstore.commit('increaseCounter');\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tif (itemsToUpdate.length > 0)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('update', itemsToUpdate);\n\t\t\t\t}\n\t\t\t},\n\t\t\tsetSearchResult: (store, payload) =>\n\t\t\t{\n\t\t\t\tconst itemsToUpdate = [];\n\t\t\t\tconst itemsToAdd = [];\n\n\t\t\t\tlet {notifications} = payload;\n\n\t\t\t\tconst skipValidation = !!payload.skipValidation;\n\t\t\t\tif (!skipValidation)\n\t\t\t\t{\n\t\t\t\t\tconst currentUserId = Core.getUserId();\n\t\t\t\t\tnotifications = notifications.map(element => {\n\t\t\t\t\t\treturn NotificationsModel.validate(element, currentUserId);\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tnotifications.forEach(element => {\n\t\t\t\t\tconst existingItem = store.state.searchCollection.get(element.id);\n\t\t\t\t\tif (existingItem)\n\t\t\t\t\t{\n\t\t\t\t\t\titemsToUpdate.push({id: existingItem.id, fields: {...element}});\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\titemsToAdd.push({...this.getElementState(), ...element});\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tif (itemsToAdd.length > 0)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('addSearchResult', itemsToAdd);\n\t\t\t\t}\n\t\t\t\tif (itemsToUpdate.length > 0)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('updateSearchResult', itemsToUpdate);\n\t\t\t\t}\n\t\t\t},\n\t\t\tread: (store, payload) =>\n\t\t\t{\n\t\t\t\tpayload.ids.forEach(notificationId => {\n\t\t\t\t\tconst existingItem = store.state.collection.get(notificationId);\n\t\t\t\t\tif (!existingItem || existingItem.read === payload.read)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (payload.read)\n\t\t\t\t\t{\n\t\t\t\t\t\tstore.commit('decreaseCounter');\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tstore.commit('increaseCounter');\n\t\t\t\t\t}\n\n\t\t\t\t\tstore.commit('read', {\n\t\t\t\t\t\tid: existingItem.id,\n\t\t\t\t\t\tread: payload.read,\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t},\n\t\t\treadAll: (store) =>\n\t\t\t{\n\t\t\t\tstore.commit('readAll');\n\t\t\t\tstore.commit('setCounter', 0);\n\t\t\t},\n\t\t\tdelete: (store, payload) =>\n\t\t\t{\n\t\t\t\tconst existingItem = store.state.collection.get(payload.id);\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (existingItem.read === false)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('decreaseCounter');\n\t\t\t\t}\n\n\t\t\t\tstore.commit('delete', {id: existingItem.id});\n\t\t\t},\n\t\t\tclearSearchResult: (store) =>\n\t\t\t{\n\t\t\t\tstore.commit('clearSearchResult');\n\t\t\t},\n\t\t\tsetCounter: (store, payload) =>\n\t\t\t{\n\t\t\t\tstore.commit('setCounter', payload);\n\t\t\t}\n\t\t};\n\t}\n\n\tgetMutations()\n\t{\n\t\treturn {\n\t\t\tadd: (state, payload) =>\n\t\t\t{\n\t\t\t\tpayload.forEach(item => {\n\t\t\t\t\tstate.collection.set(item.id, item);\n\t\t\t\t});\n\t\t\t},\n\t\t\taddSearchResult: (state, payload) =>\n\t\t\t{\n\t\t\t\tpayload.forEach(item => {\n\t\t\t\t\tstate.searchCollection.set(item.id, item);\n\t\t\t\t});\n\t\t\t},\n\t\t\tupdate: (state, payload) =>\n\t\t\t{\n\t\t\t\tpayload.forEach(item => {\n\t\t\t\t\tstate.collection.set(item.id, {\n\t\t\t\t\t\t...state.collection.get(item.id),\n\t\t\t\t\t\t...item.fields\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t},\n\t\t\tupdateSearchResult: (state, payload) =>\n\t\t\t{\n\t\t\t\tpayload.forEach(item => {\n\t\t\t\t\tstate.searchCollection.set(item.id, {\n\t\t\t\t\t\t...state.searchCollection.get(item.id),\n\t\t\t\t\t\t...item.fields\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t},\n\t\t\tdelete: (state, payload) =>\n\t\t\t{\n\t\t\t\tstate.collection.delete(payload.id);\n\t\t\t},\n\t\t\tread: (state, payload) =>\n\t\t\t{\n\t\t\t\tstate.collection.set(payload.id, {\n\t\t\t\t\t...state.collection.get(payload.id),\n\t\t\t\t\tread: payload.read\n\t\t\t\t});\n\t\t\t},\n\t\t\treadAll: (state) =>\n\t\t\t{\n\t\t\t\t[...state.collection.values()].forEach(item => {\n\t\t\t\t\tif (!item.read)\n\t\t\t\t\t{\n\t\t\t\t\t\titem.read = true;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\t\t\tsetCounter: (state, payload) =>\n\t\t\t{\n\t\t\t\tstate.unreadCounter = Number.parseInt(payload, 10);\n\t\t\t},\n\t\t\tdecreaseCounter: (state) =>\n\t\t\t{\n\t\t\t\tif (state.unreadCounter > 0)\n\t\t\t\t{\n\t\t\t\t\tstate.unreadCounter--;\n\t\t\t\t}\n\t\t\t},\n\t\t\tincreaseCounter: (state) =>\n\t\t\t{\n\t\t\t\tstate.unreadCounter++;\n\t\t\t},\n\t\t\tclearSearchResult: (state) =>\n\t\t\t{\n\t\t\t\tstate.searchCollection.clear();\n\t\t\t}\n\t\t};\n\t}\n\n\tstatic validate(fields: Object)\n\t{\n\t\tconst result = {};\n\n\t\tif (Type.isString(fields.id) || Type.isNumber(fields.id))\n\t\t{\n\t\t\tresult.id = fields.id;\n\t\t}\n\n\t\tif (Type.isNumber(fields.author_id))\n\t\t{\n\t\t\tresult.authorId = fields.author_id;\n\t\t}\n\t\telse if (Type.isNumber(fields.userId))\n\t\t{\n\t\t\tresult.authorId = fields.userId;\n\t\t}\n\n\t\tif (!Type.isNil(fields.date))\n\t\t{\n\t\t\tresult.date = Utils.date.cast(fields.date);\n\t\t}\n\n\t\tif (Type.isString(fields.notify_title))\n\t\t{\n\t\t\tresult.title = fields.notify_title;\n\t\t}\n\t\telse if (Type.isString(fields.title))\n\t\t{\n\t\t\tresult.title = fields.title;\n\t\t}\n\n\t\tif (Type.isString(fields.text) || Type.isNumber(fields.text))\n\t\t{\n\t\t\tresult.text = Text.decode(fields.text.toString());\n\t\t}\n\n\t\tif (Type.isObjectLike(fields.params))\n\t\t{\n\t\t\tresult.params = fields.params;\n\t\t}\n\n\t\tif (Type.isArray(fields.replaces))\n\t\t{\n\t\t\tresult.replaces = fields.replaces;\n\t\t}\n\n\t\tif (!Type.isNil(fields.notify_buttons))\n\t\t{\n\t\t\tresult.notifyButtons = JSON.parse(fields.notify_buttons);\n\t\t}\n\t\telse if (!Type.isNil(fields.buttons))\n\t\t{\n\t\t\tresult.notifyButtons = fields.buttons.map(button => {\n\t\t\t\treturn {\n\t\t\t\t\tCOMMAND: 'notifyConfirm',\n\t\t\t\t\tCOMMAND_PARAMS: `${result.id}|${button.VALUE}`,\n\t\t\t\t\tTEXT: `${button.TITLE}`,\n\t\t\t\t\tTYPE: 'BUTTON',\n\t\t\t\t\tDISPLAY: 'LINE',\n\t\t\t\t\tBG_COLOR: (button.VALUE === 'Y' ? '#8bc84b' : '#ef4b57'),\n\t\t\t\t\tTEXT_COLOR: '#fff',\n\t\t\t\t};\n\t\t\t});\n\t\t}\n\n\t\tif (fields.notify_type === NotificationTypesCodes.confirm || fields.type === NotificationTypesCodes.confirm)\n\t\t{\n\t\t\tresult.sectionCode = NotificationTypesCodes.confirm;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tresult.sectionCode = NotificationTypesCodes.simple;\n\t\t}\n\n\t\tif (!Type.isNil(fields.notify_read))\n\t\t{\n\t\t\tresult.read = fields.notify_read === 'Y';\n\t\t}\n\t\telse if (!Type.isNil(fields.read))\n\t\t{\n\t\t\tresult.read = fields.read === 'Y';\n\t\t}\n\n\t\tif (Type.isString(fields.setting_name))\n\t\t{\n\t\t\tresult.settingName = fields.setting_name;\n\t\t}\n\t\telse if (Type.isString(fields.settingName))\n\t\t{\n\t\t\tresult.settingName = fields.settingName;\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tsortByType(a, b)\n\t{\n\t\tif (a.sectionCode === NotificationTypesCodes.confirm && b.sectionCode !== NotificationTypesCodes.confirm)\n\t\t{\n\t\t\treturn -1;\n\t\t}\n\t\telse if (a.sectionCode !== NotificationTypesCodes.confirm && b.sectionCode === NotificationTypesCodes.confirm)\n\t\t{\n\t\t\treturn 1;\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn b.id - a.id;\n\t\t}\n\t}\n}\n","import {BuilderModel} from 'ui.vue3.vuex';\nimport {Type} from 'main.core';\n\nimport {Utils} from 'im.v2.lib.utils';\n\nimport type {ImModelSidebarLinkItem} from '../registry';\n\ntype LinksState = {\n\tcollection: {[chatId: number]: Map<number, ImModelSidebarLinkItem>},\n\tcounters: {[chatId: number]: number},\n};\n\nexport class LinksModel extends BuilderModel\n{\n\tgetState(): LinksState\n\t{\n\t\treturn {\n\t\t\tcollection: {},\n\t\t\tcounters: {}\n\t\t};\n\t}\n\n\tgetGetters()\n\t{\n\t\treturn {\n\t\t\tget: (state) => (chatId: number): ImModelSidebarLinkItem[] => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\treturn [...state.collection[chatId].values()].sort((a, b) => b.id - a.id);\n\t\t\t},\n\t\t\tgetSize: (state) => (chatId: number): number => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[chatId].size;\n\t\t\t},\n\t\t\tgetCounter: (state) => (chatId: number): number => {\n\t\t\t\tif (!state.counters[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn state.counters[chatId];\n\t\t\t}\n\t\t};\n\t}\n\n\tgetElementState(): ImModelSidebarLinkItem\n\t{\n\t\treturn {\n\t\t\tid: 0,\n\t\t\tmessageId: 0,\n\t\t\tchatId: 0,\n\t\t\tauthorId: 0,\n\t\t\tsource: '',\n\t\t\tdate: new Date(),\n\t\t\trichData: {\n\t\t\t\tid: null,\n\t\t\t\tdescription: null,\n\t\t\t\tlink: null,\n\t\t\t\tname: null,\n\t\t\t\tpreviewUrl: null,\n\t\t\t\ttype: null,\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions(): Object\n\t{\n\t\treturn {\n\t\t\tsetCounter: (store, payload) => {\n\t\t\t\tif (!Type.isNumber(payload.counter) || !Type.isNumber(payload.chatId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setCounter', payload);\n\t\t\t},\n\t\t\tset: (store, payload) => {\n\t\t\t\tconst {chatId, links} = payload;\n\t\t\t\tif (!Type.isArrayFilled(links) || !Type.isNumber(chatId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!store.state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\tstore.state.collection[chatId] = new Map();\n\t\t\t\t}\n\n\t\t\t\tlinks.forEach(link => {\n\t\t\t\t\tconst preparedLink = {...this.getElementState(), ...this.validate(link)};\n\t\t\t\t\tstore.commit('add', {chatId, link: preparedLink});\n\t\t\t\t});\n\t\t\t},\n\t\t\tdelete: (store, payload) => {\n\t\t\t\tconst {chatId, id} = payload;\n\t\t\t\tif (!Type.isNumber(id) || !Type.isNumber(chatId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!store.state.collection[chatId] || !store.state.collection[chatId].has(id))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('delete', {chatId, id});\n\t\t\t}\n\t\t};\n\t}\n\n\tgetMutations(): Object\n\t{\n\t\treturn {\n\t\t\tsetCounter: (state, payload) => {\n\t\t\t\tconst {chatId, counter} = payload;\n\t\t\t\tstate.counters[chatId] = counter;\n\t\t\t},\n\t\t\tadd: (state, payload: {chatId: number, link: ImModelSidebarLinkItem}) => {\n\t\t\t\tconst {chatId, link} = payload;\n\t\t\t\tstate.collection[chatId].set(link.id, link);\n\t\t\t},\n\t\t\tdelete: (state, payload: {chatId: number, id: number}) => {\n\t\t\t\tconst {chatId, id} = payload;\n\t\t\t\tstate.collection[chatId].delete(id);\n\t\t\t\tstate.counters[chatId]--;\n\t\t\t}\n\t\t};\n\t}\n\n\tvalidate(fields: Object): ImModelSidebarLinkItem\n\t{\n\t\tconst result = {\n\t\t\trichData: {}\n\t\t};\n\n\t\tif (Type.isNumber(fields.id))\n\t\t{\n\t\t\tresult.id = fields.id;\n\t\t}\n\n\t\tif (Type.isNumber(fields.messageId))\n\t\t{\n\t\t\tresult.messageId = fields.messageId;\n\t\t}\n\n\t\tif (Type.isNumber(fields.chatId))\n\t\t{\n\t\t\tresult.chatId = fields.chatId;\n\t\t}\n\n\t\tif (Type.isNumber(fields.authorId))\n\t\t{\n\t\t\tresult.authorId = fields.authorId;\n\t\t}\n\n\t\tif (Type.isString(fields.url.source))\n\t\t{\n\t\t\tresult.source = fields.url.source;\n\t\t}\n\n\t\tif (Type.isString(fields.dateCreate))\n\t\t{\n\t\t\tresult.date = Utils.date.cast(fields.dateCreate);\n\t\t}\n\n\t\tif (Type.isPlainObject(fields.url.richData))\n\t\t{\n\t\t\tresult.richData = this.validateRichData(fields.url.richData);\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tvalidateRichData(richData: Object): Object\n\t{\n\t\tconst result = {};\n\n\t\tif (Type.isNumber(richData.id))\n\t\t{\n\t\t\tresult.id = richData.id;\n\t\t}\n\n\t\tif (Type.isString(richData.description))\n\t\t{\n\t\t\tresult.description = richData.description;\n\t\t}\n\n\t\tif (Type.isString(richData.link))\n\t\t{\n\t\t\tresult.link = richData.link;\n\t\t}\n\n\t\tif (Type.isString(richData.name))\n\t\t{\n\t\t\tresult.name = richData.name;\n\t\t}\n\n\t\tif (Type.isString(richData.previewUrl))\n\t\t{\n\t\t\tresult.previewUrl = richData.previewUrl;\n\t\t}\n\n\t\tif (Type.isString(richData.type))\n\t\t{\n\t\t\tresult.type = richData.type;\n\t\t}\n\n\t\treturn result;\n\t}\n}","import {Type} from 'main.core';\nimport {BuilderModel} from 'ui.vue3.vuex';\n\nimport {Utils} from 'im.v2.lib.utils';\n\nimport type {ImModelSidebarFavoriteItem} from '../registry';\n\ntype FavoritesState = {\n\tcollection: {[chatId: number]: Map<number, ImModelSidebarFavoriteItem>},\n\tcounters: {[chatId: number]: number},\n};\n\nexport class FavoritesModel extends BuilderModel\n{\n\tgetState(): FavoritesState\n\t{\n\t\treturn {\n\t\t\tcollection: {},\n\t\t\tcounters: {},\n\t\t};\n\t}\n\n\tgetElementState(): ImModelSidebarFavoriteItem\n\t{\n\t\treturn {\n\t\t\tid: 0,\n\t\t\tmessageId: 0,\n\t\t\tchatId: 0,\n\t\t\tauthorId: 0,\n\t\t\tdate: new Date(),\n\t\t};\n\t}\n\n\tgetGetters(): Object\n\t{\n\t\treturn {\n\t\t\tget: (state) => (chatId: number): ImModelSidebarFavoriteItem[] => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\treturn [...state.collection[chatId].values()].sort((a, b) => b.id - a.id);\n\t\t\t},\n\t\t\tgetSize: (state) => (chatId: number): number => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[chatId].size;\n\t\t\t},\n\t\t\tgetCounter: (state) => (chatId: number): number => {\n\t\t\t\tif (state.counters[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn state.counters[chatId];\n\t\t\t\t}\n\n\t\t\t\treturn 0;\n\t\t\t},\n\t\t\tisFavoriteMessage: (state) => (chatId: number, messageId: number): boolean => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst chatFavorites = Object.fromEntries(state.collection[chatId]);\n\t\t\t\tconst targetMessage = Object.values(chatFavorites).find(element => element.messageId === messageId);\n\n\t\t\t\treturn !!targetMessage;\n\t\t\t}\n\t\t};\n\t}\n\n\tgetActions(): Object\n\t{\n\t\treturn {\n\t\t\tsetCounter: (store, payload) => {\n\t\t\t\tif (!Type.isNumber(payload.counter) || !Type.isNumber(payload.chatId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setCounter', payload);\n\t\t\t},\n\t\t\tset: (store, payload) => {\n\t\t\t\tif (Type.isNumber(payload.favorites))\n\t\t\t\t{\n\t\t\t\t\tpayload.favorites = [payload.favorites];\n\t\t\t\t}\n\t\t\t\tconst {chatId, favorites} = payload;\n\n\t\t\t\tif (!Type.isArrayFilled(favorites) || !Type.isNumber(chatId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!store.state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\tstore.state.collection[chatId] = new Map();\n\t\t\t\t}\n\n\t\t\t\tfavorites.forEach(favorite => {\n\t\t\t\t\tconst preparedFavoriteMessage = {...this.getElementState(), ...this.validate(favorite)};\n\t\t\t\t\tstore.commit('add', {chatId, favorite: preparedFavoriteMessage});\n\t\t\t\t});\n\t\t\t},\n\t\t\tdelete: (store, payload) => {\n\t\t\t\tconst {chatId, id} = payload;\n\t\t\t\tif (!Type.isNumber(id) || !Type.isNumber(chatId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!store.state.collection[chatId] || !store.state.collection[chatId].has(id))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('delete', {chatId, id});\n\t\t\t},\n\t\t\tdeleteByMessageId: (store, payload: {chatId: number, messageId: number}) => {\n\t\t\t\tconst {chatId, messageId} = payload;\n\t\t\t\tif (!store.state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst chatCollection = store.state.collection[chatId];\n\t\t\t\tlet targetLinkId = null;\n\t\t\t\tfor (const [linkId, linkObject] of chatCollection)\n\t\t\t\t{\n\t\t\t\t\tif (linkObject.messageId === messageId)\n\t\t\t\t\t{\n\t\t\t\t\t\ttargetLinkId = linkId;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (!targetLinkId)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('delete', {chatId, id: targetLinkId});\n\t\t\t}\n\t\t};\n\t}\n\n\tgetMutations(): Object\n\t{\n\t\treturn {\n\t\t\tsetCounter: (state, payload) => {\n\t\t\t\tconst {chatId, counter} = payload;\n\t\t\t\tstate.counters[chatId] = counter;\n\t\t\t},\n\t\t\tadd: (state, payload: {chatId: number, favorite: ImModelSidebarFavoriteItem}) => {\n\t\t\t\tconst {chatId, favorite} = payload;\n\t\t\t\tstate.collection[chatId].set(favorite.id, favorite);\n\t\t\t},\n\t\t\tdelete: (state, payload: {chatId: number, id: number}) => {\n\t\t\t\tconst {chatId, id} = payload;\n\t\t\t\tstate.collection[chatId].delete(id);\n\t\t\t\tstate.counters[chatId]--;\n\t\t\t}\n\t\t};\n\t}\n\n\tvalidate(fields: Object): ImModelSidebarFavoriteItem\n\t{\n\t\tconst result = {};\n\n\t\tif (Type.isNumber(fields.id))\n\t\t{\n\t\t\tresult.id = fields.id;\n\t\t}\n\n\t\tif (Type.isNumber(fields.messageId))\n\t\t{\n\t\t\tresult.messageId = fields.messageId;\n\t\t}\n\n\t\tif (Type.isNumber(fields.chatId))\n\t\t{\n\t\t\tresult.chatId = fields.chatId;\n\t\t}\n\n\t\tif (Type.isNumber(fields.authorId))\n\t\t{\n\t\t\tresult.authorId = fields.authorId;\n\t\t}\n\n\t\tif (Type.isString(fields.dateCreate))\n\t\t{\n\t\t\tresult.date = Utils.date.cast(fields.dateCreate);\n\t\t}\n\n\t\treturn result;\n\t}\n}\n","import {Type} from 'main.core';\nimport {BuilderModel} from 'ui.vue3.vuex';\n\ntype MembersState = {\n\tcollection: {[chatId: number]: Set<number>},\n};\n\nexport class MembersModel extends BuilderModel\n{\n\tgetState(): MembersState\n\t{\n\t\treturn {\n\t\t\tcollection: {},\n\t\t};\n\t}\n\n\tgetGetters()\n\t{\n\t\treturn {\n\t\t\tget: (state) => (chatId: number): Array =>\n\t\t\t{\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\treturn [...state.collection[chatId]];\n\t\t\t},\n\t\t\tgetSize: (state) => (chatId: number): number => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[chatId].size;\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions(): Object\n\t{\n\t\treturn {\n\t\t\tset: (store, payload) =>\n\t\t\t{\n\t\t\t\tconst {chatId, users} = payload;\n\t\t\t\tif (!Type.isArray(users) || !Type.isNumber(chatId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (users.length > 0)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('set', {chatId, users});\n\t\t\t\t}\n\t\t\t},\n\t\t\tdelete: (store, payload) => {\n\t\t\t\tconst {chatId, userId} = payload;\n\t\t\t\tif (!Type.isNumber(chatId) || !Type.isNumber(userId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!store.state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('delete', {userId, chatId});\n\t\t\t}\n\t\t};\n\t}\n\n\tgetMutations(): Object\n\t{\n\t\treturn {\n\t\t\tset: (state, payload) =>\n\t\t\t{\n\t\t\t\tif (!state.collection[payload.chatId])\n\t\t\t\t{\n\t\t\t\t\tstate.collection[payload.chatId] = new Set(payload.users);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tpayload.users.forEach(id => {\n\t\t\t\t\t\tstate.collection[payload.chatId].add(id);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t},\n\t\t\tdelete: (state, payload: {chatId: number, userId: number}) => {\n\t\t\t\tconst {chatId, userId} = payload;\n\t\t\t\tstate.collection[chatId].delete(userId);\n\t\t\t}\n\t\t};\n\t}\n}","import {BuilderModel} from 'ui.vue3.vuex';\nimport {Type} from 'main.core';\n\nimport {Utils} from 'im.v2.lib.utils';\n\nimport type {ImModelSidebarTaskItem} from '../registry';\n\ntype TasksState = {\n\tcollection: {[chatId: number]: Map<number, ImModelSidebarTaskItem>},\n};\n\nexport class TasksModel extends BuilderModel\n{\n\tgetState(): TasksState\n\t{\n\t\treturn {\n\t\t\tcollection: {},\n\t\t};\n\t}\n\n\tgetElementState(): ImModelSidebarTaskItem\n\t{\n\t\treturn {\n\t\t\tid: 0,\n\t\t\tmessageId: 0,\n\t\t\tchatId: 0,\n\t\t\tauthorId: 0,\n\t\t\tdate: new Date(),\n\t\t\ttask: {\n\t\t\t\tid: 0,\n\t\t\t\ttitle: '',\n\t\t\t\tcreatorId: 0,\n\t\t\t\tresponsibleId: 0,\n\t\t\t\tstatus: 0,\n\t\t\t\tstatusTitle: '',\n\t\t\t\tdeadline: new Date(),\n\t\t\t\tstate: '',\n\t\t\t\tcolor: '',\n\t\t\t\tsource: ''\n\t\t\t}\n\t\t};\n\t}\n\n\tgetGetters(): Object\n\t{\n\t\treturn {\n\t\t\tget: (state) => (chatId: number): ImModelSidebarTaskItem[] => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\treturn [...state.collection[chatId].values()].sort((a, b) => b.id - a.id);\n\t\t\t},\n\t\t\tgetSize: (state) => (chatId: number): number => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[chatId].size;\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions(): Object\n\t{\n\t\treturn {\n\t\t\tset: (store, payload) => {\n\t\t\t\tconst {chatId, tasks} = payload;\n\t\t\t\tif (!Type.isArrayFilled(tasks) || !Type.isNumber(chatId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!store.state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\tstore.state.collection[chatId] = new Map();\n\t\t\t\t}\n\n\t\t\t\ttasks.forEach(task => {\n\t\t\t\t\tconst preparedTask = {...this.getElementState(), ...this.validate(task)};\n\t\t\t\t\tstore.commit('add', {chatId, task: preparedTask});\n\t\t\t\t});\n\t\t\t},\n\t\t\tdelete: (store, payload) => {\n\t\t\t\tconst {chatId, id} = payload;\n\t\t\t\tif (!Type.isNumber(chatId) || !Type.isNumber(id))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!store.state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('delete', {id, chatId});\n\t\t\t}\n\t\t};\n\t}\n\n\tgetMutations(): Object\n\t{\n\t\treturn {\n\t\t\tadd: (state, payload: {chatId: number, task: ImModelSidebarTaskItem}) => {\n\t\t\t\tconst {chatId, task} = payload;\n\t\t\t\tstate.collection[chatId].set(task.id, task);\n\t\t\t},\n\t\t\tdelete: (state, payload: {id: number, chatId: number}) => {\n\t\t\t\tconst {id, chatId} = payload;\n\t\t\t\tstate.collection[chatId].delete(id);\n\t\t\t}\n\t\t};\n\t}\n\n\tvalidate(fields: Object): ImModelSidebarTaskItem\n\t{\n\t\tconst result = {\n\t\t\ttask: {}\n\t\t};\n\n\t\tif (Type.isNumber(fields.id))\n\t\t{\n\t\t\tresult.id = fields.id;\n\t\t}\n\n\t\tif (Type.isNumber(fields.messageId))\n\t\t{\n\t\t\tresult.messageId = fields.messageId;\n\t\t}\n\n\t\tif (Type.isNumber(fields.chatId))\n\t\t{\n\t\t\tresult.chatId = fields.chatId;\n\t\t}\n\n\t\tif (Type.isNumber(fields.authorId))\n\t\t{\n\t\t\tresult.authorId = fields.authorId;\n\t\t}\n\n\t\tif (Type.isString(fields.dateCreate))\n\t\t{\n\t\t\tresult.date = Utils.date.cast(fields.dateCreate);\n\t\t}\n\n\t\tif (Type.isPlainObject(fields.task))\n\t\t{\n\t\t\tresult.task = this.validateTask(fields.task);\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tvalidateTask(task)\n\t{\n\t\tconst result = {};\n\n\t\tif (Type.isNumber(task.id))\n\t\t{\n\t\t\tresult.id = task.id;\n\t\t}\n\n\t\tif (Type.isString(task.title))\n\t\t{\n\t\t\tresult.title = task.title;\n\t\t}\n\n\t\tif (Type.isNumber(task.creatorId))\n\t\t{\n\t\t\tresult.creatorId = task.creatorId;\n\t\t}\n\n\t\tif (Type.isNumber(task.responsibleId))\n\t\t{\n\t\t\tresult.responsibleId = task.responsibleId;\n\t\t}\n\n\t\tif (Type.isNumber(task.status))\n\t\t{\n\t\t\tresult.status = task.status;\n\t\t}\n\n\t\tif (Type.isString(task.statusTitle))\n\t\t{\n\t\t\tresult.statusTitle = task.statusTitle;\n\t\t}\n\n\t\tif (Type.isString(task.deadline))\n\t\t{\n\t\t\tresult.deadline = Utils.date.cast(task.deadline);\n\t\t}\n\n\t\tif (Type.isString(task.state))\n\t\t{\n\t\t\tresult.state = task.state;\n\t\t}\n\n\t\tif (Type.isString(task.color))\n\t\t{\n\t\t\tresult.color = task.color;\n\t\t}\n\n\t\tif (Type.isString(task.source))\n\t\t{\n\t\t\tresult.source = task.source;\n\t\t}\n\n\t\treturn result;\n\t}\n}\n","import {Type} from 'main.core';\nimport {BuilderModel} from 'ui.vue3.vuex';\n\nimport {Utils} from 'im.v2.lib.utils';\n\nimport type {ImModelSidebarMeetingItem} from '../registry';\n\ntype MeetingsState = {\n\tcollection: {[chatId: number]: Map<number, ImModelSidebarMeetingItem>},\n};\n\nexport class MeetingsModel extends BuilderModel\n{\n\tgetState(): MeetingsState\n\t{\n\t\treturn {\n\t\t\tcollection: {},\n\t\t};\n\t}\n\n\tgetElementState(): ImModelSidebarMeetingItem\n\t{\n\t\treturn {\n\t\t\tid: 0,\n\t\t\tmessageId: 0,\n\t\t\tchatId: 0,\n\t\t\tauthorId: 0,\n\t\t\tdate: new Date(),\n\t\t\tmeeting: {\n\t\t\t\tid: 0,\n\t\t\t\ttitle: '',\n\t\t\t\tdateFrom: new Date(),\n\t\t\t\tdateTo: new Date(),\n\t\t\t\tsource: ''\n\t\t\t}\n\t\t};\n\t}\n\n\tgetGetters(): Object\n\t{\n\t\treturn {\n\t\t\tget: (state) => (chatId: number): ImModelSidebarMeetingItem[] => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\treturn [...state.collection[chatId].values()].sort((a, b) => b.id - a.id);\n\t\t\t},\n\t\t\tgetSize: (state) => (chatId: string): number => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[chatId].size;\n\t\t\t}\n\t\t};\n\t}\n\n\tgetActions(): Object\n\t{\n\t\treturn {\n\t\t\tset: (store, payload) => {\n\t\t\t\tconst {chatId, meetings} = payload;\n\t\t\t\tif (!Type.isArrayFilled(meetings) || !Type.isNumber(chatId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!store.state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\tstore.state.collection[chatId] = new Map();\n\t\t\t\t}\n\n\t\t\t\tmeetings.forEach(meeting => {\n\t\t\t\t\tconst preparedMeeting = {...this.getElementState(), ...this.validate(meeting)};\n\t\t\t\t\tstore.commit('add', {chatId, meeting: preparedMeeting});\n\t\t\t\t});\n\t\t\t},\n\t\t\tdelete: (store, payload) => {\n\t\t\t\tconst {chatId, id} = payload;\n\t\t\t\tif (!Type.isNumber(chatId) || !Type.isNumber(id))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!store.state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('delete', {id, chatId});\n\t\t\t}\n\t\t};\n\t}\n\n\tgetMutations(): Object\n\t{\n\t\treturn {\n\t\t\tadd: (state, payload: {chatId: number, meeting: ImModelSidebarMeetingItem}) => {\n\t\t\t\tconst {chatId, meeting} = payload;\n\t\t\t\tstate.collection[chatId].set(meeting.id, meeting);\n\t\t\t},\n\t\t\tdelete: (state, payload: {id: number, chatId: number}) => {\n\t\t\t\tconst {id, chatId} = payload;\n\t\t\t\tstate.collection[chatId].delete(id);\n\t\t\t}\n\t\t};\n\t}\n\n\tvalidate(fields: Object): ImModelSidebarMeetingItem\n\t{\n\t\tconst result = {\n\t\t\tmeeting: {}\n\t\t};\n\n\t\tif (Type.isNumber(fields.id))\n\t\t{\n\t\t\tresult.id = fields.id;\n\t\t}\n\n\t\tif (Type.isNumber(fields.messageId))\n\t\t{\n\t\t\tresult.messageId = fields.messageId;\n\t\t}\n\n\t\tif (Type.isNumber(fields.chatId))\n\t\t{\n\t\t\tresult.chatId = fields.chatId;\n\t\t}\n\n\t\tif (Type.isNumber(fields.authorId))\n\t\t{\n\t\t\tresult.authorId = fields.authorId;\n\t\t}\n\n\t\tif (Type.isString(fields.dateCreate))\n\t\t{\n\t\t\tresult.date = Utils.date.cast(fields.dateCreate);\n\t\t}\n\n\t\tif (Type.isPlainObject(fields.calendar))\n\t\t{\n\t\t\tresult.meeting = this.validateMeeting(fields.calendar);\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tvalidateMeeting(meeting)\n\t{\n\t\tconst result = {};\n\n\t\tif (Type.isNumber(meeting.id))\n\t\t{\n\t\t\tresult.id = meeting.id;\n\t\t}\n\n\t\tif (Type.isString(meeting.title))\n\t\t{\n\t\t\tresult.title = meeting.title;\n\t\t}\n\n\t\tif (Type.isString(meeting.dateFrom))\n\t\t{\n\t\t\tresult.dateFrom = Utils.date.cast(meeting.dateFrom);\n\t\t}\n\n\t\tif (Type.isString(meeting.dateTo))\n\t\t{\n\t\t\tresult.dateTo = Utils.date.cast(meeting.dateTo);\n\t\t}\n\n\t\tif (Type.isString(meeting.source))\n\t\t{\n\t\t\tresult.source = meeting.source;\n\t\t}\n\n\t\treturn result;\n\t}\n}\n","import {Type} from 'main.core';\nimport {BuilderModel} from 'ui.vue3.vuex';\n\nimport {SidebarFileTypes} from 'im.v2.const';\nimport {Utils} from 'im.v2.lib.utils';\n\nimport type {ImModelSidebarFileItem} from '../registry';\n\ntype FilesState = {\n\tcollection: {\n\t\t[chatId: number]: {\n\t\t\t[SidebarFileTypes: string]: Map<number, ImModelSidebarFileItem>\n\t\t}\n\t},\n};\n\nexport class FilesModel extends BuilderModel\n{\n\tgetState(): FilesState\n\t{\n\t\treturn {\n\t\t\tcollection: {},\n\t\t};\n\t}\n\n\tgetElementState(): ImModelSidebarFileItem\n\t{\n\t\treturn {\n\t\t\tid: 0,\n\t\t\tmessageId: 0,\n\t\t\tchatId: 0,\n\t\t\tauthorId: 0,\n\t\t\tdate: new Date(),\n\t\t\tfileId: 0,\n\t\t};\n\t}\n\n\tgetGetters(): Object\n\t{\n\t\treturn {\n\t\t\tget: (state) => (chatId: number, subType: string): ImModelSidebarFileItem[] => {\n\t\t\t\tif (!state.collection[chatId] || !state.collection[chatId][subType])\n\t\t\t\t{\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\treturn [...state.collection[chatId][subType].values()].sort((a, b) => b.id - a.id);\n\t\t\t},\n\n\t\t\tgetLatest: (state, getters, rootState, rootGetters) => (chatId: number): ImModelSidebarFileItem[] => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\tlet media = [];\n\t\t\t\tlet audio = [];\n\t\t\t\tlet documents = [];\n\t\t\t\tlet other = [];\n\n\t\t\t\tif (state.collection[chatId][SidebarFileTypes.media])\n\t\t\t\t{\n\t\t\t\t\tmedia = [...state.collection[chatId][SidebarFileTypes.media].values()];\n\t\t\t\t}\n\t\t\t\tif (state.collection[chatId][SidebarFileTypes.audio])\n\t\t\t\t{\n\t\t\t\t\taudio = [...state.collection[chatId][SidebarFileTypes.audio].values()];\n\t\t\t\t}\n\t\t\t\tif (state.collection[chatId][SidebarFileTypes.document])\n\t\t\t\t{\n\t\t\t\t\tdocuments = [...state.collection[chatId][SidebarFileTypes.document].values()];\n\t\t\t\t}\n\t\t\t\tif (state.collection[chatId][SidebarFileTypes.other])\n\t\t\t\t{\n\t\t\t\t\tother = [...state.collection[chatId][SidebarFileTypes.other].values()];\n\t\t\t\t}\n\n\t\t\t\tconst sortedFlatCollection = [media, audio, documents, other]\n\t\t\t\t\t.flat()\n\t\t\t\t\t.sort((a, b) => b.id - a.id)\n\t\t\t\t;\n\n\t\t\t\treturn this.getTopThreeCompletedFiles(sortedFlatCollection, rootGetters);\n\t\t\t},\n\t\t\tgetLatestUnsorted: (state, getters, rootState, rootGetters) => (chatId: number): ImModelSidebarFileItem[] => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\tlet unsorted = [];\n\n\t\t\t\tif (state.collection[chatId][SidebarFileTypes.fileUnsorted])\n\t\t\t\t{\n\t\t\t\t\tunsorted = [...state.collection[chatId][SidebarFileTypes.fileUnsorted].values()];\n\t\t\t\t}\n\n\t\t\t\tconst sortedCollection = unsorted.sort((a, b) => b.id - a.id);\n\n\t\t\t\treturn this.getTopThreeCompletedFiles(sortedCollection, rootGetters);\n\t\t\t},\n\t\t\tgetSize: (state) => (chatId: string, subType: string): number => {\n\t\t\t\tif (!state.collection[chatId] || !state.collection[chatId][subType])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[chatId][subType].size;\n\t\t\t}\n\t\t};\n\t}\n\n\tgetActions(): Object\n\t{\n\t\treturn {\n\t\t\tset: (store, payload) => {\n\t\t\t\tconst {chatId, files} = payload;\n\t\t\t\tif (!Type.isArrayFilled(files) || !Type.isNumber(chatId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!store.state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\tstore.state.collection[chatId] = {};\n\t\t\t\t}\n\n\t\t\t\tfiles.forEach(file => {\n\t\t\t\t\tconst preparedFile = {...this.getElementState(), ...this.validate(file)};\n\t\t\t\t\tconst {subType} = file;\n\t\t\t\t\tstore.commit('add', {chatId, subType, file: preparedFile});\n\t\t\t\t});\n\t\t\t},\n\t\t\tdelete: (store, payload) => {\n\t\t\t\tconst {chatId, id} = payload;\n\t\t\t\tif (!Type.isNumber(id) || !Type.isNumber(chatId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!store.state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('delete', {chatId, id});\n\t\t\t}\n\t\t};\n\t}\n\n\tgetMutations(): Object\n\t{\n\t\treturn {\n\t\t\tadd: (state, payload: {chatId: number, subType: string, file: ImModelSidebarFileItem}) => {\n\t\t\t\tconst {chatId, file, subType} = payload;\n\t\t\t\tif (!state.collection[chatId][subType])\n\t\t\t\t{\n\t\t\t\t\tstate.collection[chatId][subType] = new Map();\n\t\t\t\t}\n\t\t\t\tstate.collection[chatId][subType].set(file.id, file);\n\t\t\t},\n\t\t\tdelete: (state, payload: {chatId: number, id: number}) => {\n\t\t\t\tconst {chatId, id} = payload;\n\n\t\t\t\tObject.values(SidebarFileTypes).forEach(subType => {\n\t\t\t\t\tif (state.collection[chatId][subType] && state.collection[chatId][subType].has(id))\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.collection[chatId][subType].delete(id);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\t}\n\n\tvalidate(fields: Object): ImModelSidebarFileItem\n\t{\n\t\tconst result = {};\n\n\t\tif (Type.isNumber(fields.id))\n\t\t{\n\t\t\tresult.id = fields.id;\n\t\t}\n\n\t\tif (Type.isNumber(fields.messageId))\n\t\t{\n\t\t\tresult.messageId = fields.messageId;\n\t\t}\n\n\t\tif (Type.isNumber(fields.chatId))\n\t\t{\n\t\t\tresult.chatId = fields.chatId;\n\t\t}\n\n\t\tif (Type.isNumber(fields.authorId))\n\t\t{\n\t\t\tresult.authorId = fields.authorId;\n\t\t}\n\n\t\tif (Type.isString(fields.dateCreate))\n\t\t{\n\t\t\tresult.date = Utils.date.cast(fields.dateCreate);\n\t\t}\n\t\telse if (Type.isString(fields.date))\n\t\t{\n\t\t\tresult.date = Utils.date.cast(fields.date);\n\t\t}\n\n\t\tresult.fileId = Type.isNumber(fields.fileId) ? fields.fileId : result.id;\n\n\t\treturn result;\n\t}\n\n\tgetTopThreeCompletedFiles(collection: ImModelSidebarFileItem[], rootGetters): ImModelSidebarFileItem[]\n\t{\n\t\treturn collection.filter((sidebarFile: ImModelSidebarFileItem) => {\n\t\t\tconst file = rootGetters['files/get'](sidebarFile.fileId, true);\n\n\t\t\treturn file.progress === 100;\n\t\t}).slice(0, 3);\n\t}\n}\n","import {BuilderModel} from 'ui.vue3.vuex';\nimport {Type} from 'main.core';\nimport {LinksModel} from './sidebar/links';\nimport {FavoritesModel} from './sidebar/favorites';\nimport {MembersModel} from './sidebar/members';\nimport {TasksModel} from './sidebar/tasks';\nimport {MeetingsModel} from './sidebar/meeting';\nimport {FilesModel} from './sidebar/files';\n\nexport class SidebarModel extends BuilderModel\n{\n\tgetName(): string\n\t{\n\t\treturn 'sidebar';\n\t}\n\n\tgetNestedModules(): { [moduleName: string]: BuilderModel }\n\t{\n\t\treturn {\n\t\t\tmembers: MembersModel,\n\t\t\tlinks: LinksModel,\n\t\t\tfavorites: FavoritesModel,\n\t\t\ttasks: TasksModel,\n\t\t\tmeetings: MeetingsModel,\n\t\t\tfiles: FilesModel,\n\t\t};\n\t}\n\n\tgetState()\n\t{\n\t\treturn {\n\t\t\tinitedList: new Set(),\n\t\t\tisFilesMigrated: false,\n\t\t\tisLinksMigrated: false\n\t\t};\n\t}\n\n\tgetGetters()\n\t{\n\t\treturn {\n\t\t\tisInited: (state) => (chatId: number): boolean =>\n\t\t\t{\n\t\t\t\treturn state.initedList.has(chatId);\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions()\n\t{\n\t\treturn {\n\t\t\tsetInited: (store, chatId) =>\n\t\t\t{\n\t\t\t\tif (!Type.isNumber(chatId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setInited', chatId);\n\t\t\t},\n\t\t\tsetFilesMigrated: (store, value: boolean) =>\n\t\t\t{\n\t\t\t\tif (!Type.isBoolean(value))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setFilesMigrated', value);\n\t\t\t},\n\t\t\tsetLinksMigrated: (store, value: boolean) =>\n\t\t\t{\n\t\t\t\tif (!Type.isBoolean(value))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setLinksMigrated', value);\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMutations()\n\t{\n\t\treturn {\n\t\t\tsetInited: (state, payload) =>\n\t\t\t{\n\t\t\t\tstate.initedList.add(payload);\n\t\t\t},\n\t\t\tsetFilesMigrated: (state, payload: boolean) =>\n\t\t\t{\n\t\t\t\tstate.isFilesMigrated = payload;\n\t\t\t},\n\t\t\tsetLinksMigrated: (state, payload: boolean) =>\n\t\t\t{\n\t\t\t\tstate.isLinksMigrated = payload;\n\t\t\t},\n\t\t};\n\t}\n}","import {Type} from 'main.core';\nimport {BuilderModel} from 'ui.vue3.vuex';\n\nimport {PlacementType} from 'im.v2.const';\n\nimport type {MarketApplication} from './type/market';\n\nexport class MarketModel extends BuilderModel\n{\n\tgetName(): string\n\t{\n\t\treturn 'market';\n\t}\n\n\tgetState()\n\t{\n\t\treturn {\n\t\t\tcollection: new Map(),\n\t\t\tplacementCollection: {\n\t\t\t\t[PlacementType.contextMenu]: new Set(),\n\t\t\t\t[PlacementType.navigation]: new Set(),\n\t\t\t\t[PlacementType.textarea]: new Set(),\n\t\t\t\t[PlacementType.sidebar]: new Set(),\n\t\t\t\t[PlacementType.smilesSelector]: new Set()\n\t\t\t},\n\t\t};\n\t}\n\n\tgetElementState(): MarketApplication\n\t{\n\t\treturn {\n\t\t\tid: 0,\n\t\t\ttitle: '',\n\t\t\toptions: {\n\t\t\t\trole: '',\n\t\t\t\textranet: '',\n\t\t\t\tcontext: null,\n\t\t\t\twidth: null,\n\t\t\t\theight: null,\n\t\t\t\tcolor: null,\n\t\t\t\ticonName: null\n\t\t\t},\n\t\t\tplacement: '',\n\t\t\torder: 0,\n\t\t\tloadConfiguration: {\n\t\t\t\tID: 0,\n\t\t\t\tPLACEMENT: '',\n\t\t\t\tPLACEMENT_ID: 0,\n\t\t\t},\n\t\t};\n\t}\n\n\tgetGetters()\n\t{\n\t\treturn {\n\t\t\tgetByPlacement: (state) => (placement: string): MarketApplication[] =>\n\t\t\t{\n\t\t\t\tconst appIds = [...state.placementCollection[placement].values()];\n\n\t\t\t\treturn appIds.map(id => {\n\t\t\t\t\treturn state.collection.get(id);\n\t\t\t\t});\n\t\t\t},\n\t\t\tgetById: (state) => (id: number): number =>\n\t\t\t{\n\t\t\t\treturn state.collection.get(id);\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions()\n\t{\n\t\treturn {\n\t\t\tset: (store, payload) =>\n\t\t\t{\n\t\t\t\tconst {items} = payload;\n\n\t\t\t\titems.forEach((item: MarketApplication) => {\n\t\t\t\t\tstore.commit('setPlacementCollection', {placement: item.placement, id: item.id});\n\t\t\t\t\tstore.commit('setCollection', item);\n\t\t\t\t});\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMutations()\n\t{\n\t\treturn {\n\t\t\tsetPlacementCollection: (state, payload: MarketApplication) =>\n\t\t\t{\n\t\t\t\tstate.placementCollection[payload.placement].add(payload.id);\n\t\t\t},\n\t\t\tsetCollection: (state, payload: MarketApplication) =>\n\t\t\t{\n\t\t\t\tstate.collection.set(payload.id, {...this.getElementState(), ...this.#validate(payload)});\n\t\t\t},\n\t\t};\n\t}\n\n\t#validate(app: Object): MarketApplication\n\t{\n\t\tconst result = {};\n\n\t\tif (Type.isNumber(app.id) || Type.isStringFilled(app.id))\n\t\t{\n\t\t\tresult.id = app.id.toString();\n\t\t}\n\n\t\tif (Type.isString(app.title))\n\t\t{\n\t\t\tresult.title = app.title;\n\t\t}\n\n\t\tresult.options = this.#validateOptions(app.options);\n\n\t\tif (Type.isString(app.placement))\n\t\t{\n\t\t\tresult.placement = app.placement;\n\t\t}\n\n\t\tif (Type.isNumber(app.order))\n\t\t{\n\t\t\tresult.order = app.order;\n\t\t}\n\n\t\tresult.loadConfiguration = this.#validateLoadConfiguration(app.loadConfiguration);\n\n\t\treturn result;\n\t}\n\n\t#validateOptions(options: Object)\n\t{\n\t\tconst result = {\n\t\t\tcontext: null,\n\t\t\twidth: null,\n\t\t\theight: null,\n\t\t\tcolor: null,\n\t\t\ticonName: null\n\t\t};\n\n\t\tif (!Type.isPlainObject(options))\n\t\t{\n\t\t\treturn result;\n\t\t}\n\n\t\tif (Type.isArrayFilled(options.context))\n\t\t{\n\t\t\tresult.context = options.context;\n\t\t}\n\t\tif (Type.isNumber(options.width))\n\t\t{\n\t\t\tresult.width = options.width;\n\t\t}\n\n\t\tif (Type.isNumber(options.height))\n\t\t{\n\t\t\tresult.height = options.height;\n\t\t}\n\n\t\tif (Type.isStringFilled(options.color))\n\t\t{\n\t\t\tresult.color = options.color;\n\t\t}\n\n\t\tif (Type.isStringFilled(options.iconName))\n\t\t{\n\t\t\tresult.iconName = options.iconName;\n\t\t}\n\n\t\treturn result;\n\t}\n\n\t#validateLoadConfiguration(configuration: Object)\n\t{\n\t\tconst result = {\n\t\t\tID: 0,\n\t\t\tPLACEMENT: '',\n\t\t\tPLACEMENT_ID: 0,\n\t\t};\n\n\t\tif (!Type.isPlainObject(configuration))\n\t\t{\n\t\t\treturn result;\n\t\t}\n\n\t\tif (Type.isNumber(configuration.ID))\n\t\t{\n\t\t\tresult.ID = configuration.ID;\n\t\t}\n\n\t\tif (Type.isStringFilled(configuration.PLACEMENT))\n\t\t{\n\t\t\tresult.PLACEMENT = configuration.PLACEMENT;\n\t\t}\n\n\t\tif (Type.isNumber(configuration.PLACEMENT_ID))\n\t\t{\n\t\t\tresult.PLACEMENT_ID = configuration.PLACEMENT_ID;\n\t\t}\n\n\t\treturn result;\n\t}\n}"],"names":["SettingsModel","BuilderModel","getState","Settings","application","darkTheme","enableSound","dialog","bigSmiles","background","recent","showBirthday","showInvited","showLastMessage","getGetters","get","state","key","getActions","set","store","payload","commit","validate","getMutations","Object","entries","forEach","value","fields","result","Type","isBoolean","isStringFilled","Number","parseInt","isNumber","ApplicationModel","getName","getNestedModules","settings","layout","name","Layout","chat","entityId","contextId","getLayout","isChatOpen","dialogId","toString","areNotificationsOpen","notification","setLayout","layoutName","previousLayout","newLayout","validateLayout","validateLayoutEntityId","EventEmitter","emit","EventType","onLayoutChange","from","to","update","keys","group","PinModel","collection","getPinned","chatId","map","pinnedMessageId","Core","getStore","getters","isPinned","messageId","has","setPinned","pinnedMessages","length","pinnedMessageIds","add","delete","Logger","warn","Set","reverse","USERS_TO_SHOW","ReactionsModel","getElementState","reactionCounters","reactionUsers","ownReactions","getByMessageId","prepareSetPayload","setReaction","Reaction","reaction","removeReaction","item","newItem","currentItem","newOwnReaction","userId","reactions","getUserId","removeAllCurrentUserReactions","currentCounter","users","counter","MessagesModel","pin","chatCollection","id","authorId","date","Date","text","replaces","files","attach","unread","viewed","viewedByOthers","sending","error","retry","componentId","MessageComponent","base","isEdited","isDeleted","removeLinks","sort","a","b","getById","getByIdList","idList","push","hasMessage","isInChatCollection","message","getFirstId","getLastId","getLastOwnMessageId","getFirstUnread","getChatUnreadMessages","messages","filter","getMessageFiles","fileId","getMessageType","currentUserId","MessageType","system","self","opponent","setChatCollection","clearCollection","Array","isArray","isPlainObject","updateWithId","currentMessage","readMessages","messageIds","chatMessages","messagesToReadCount","maxMessageId","messageIdsToView","messageIdsToRead","chatMessage","setViewedByOthers","ids","clearChatCollection","isOwnMessage","Utils","isUuidV4","temporaryId","isUndefined","chat_id","cast","isString","isSystem","senderId","author_id","params","preparedParams","prepareParams","rawParams","isArrayFilled","includes","firstId","element","isTempMessage","lastId","lastOwnMessageId","z","resultId","WRITING_STATUS_TIME","DialoguesModel","writingStatusTimers","chatOptions","type","DialogType","description","avatar","color","Color","extranet","userCounter","lastReadId","markedId","lastMessageId","lastMessageViews","countOfViewers","firstViewer","savedPositionMessageId","managerList","writingList","muteList","textareaMessage","quoteId","owner","entityType","dateCreate","public","code","link","inited","loading","hasPrevPage","hasNextPage","diskFolderId","getBlank","getByChatId","values","find","getChatOption","chatType","option","getQuoteId","isUser","user","canLeave","isExternalTelephonyCall","call","optionToCheck","ChatOption","leaveOwner","leave","canMute","isAnnouncement","announcement","mute","getLastReadId","getInitialMessageId","Math","min","existingItem","startWriting","timerId","alreadyWriting","some","el","clearTimeout","setWritingStatusTimeout","userName","newWritingList","actionName","stopWriting","increaseCounter","increasedCounter","count","previousCounter","decreaseCounter","decreasedCounter","clearCounters","unmute","setChatOptions","validateChatOptions","setLastMessageViews","newLastMessageViews","clearLastMessageViews","defaultLastMessageViews","incrementLastMessageViews","newCounter","setTimeout","dispatch","dialog_id","user_counter","last_id","marked_id","last_message_id","last_message_views","prepareLastMessageViews","title","Text","decode","ownerId","prepareAvatar","entity_type","entity_id","date_create","writing_list","prepareWritingList","manager_list","mute_list","prepareMuteList","disk_folder_id","endsWith","startsWith","getHost","encodeURI","htmlspecialcharsback","rawLastMessageViews","count_of_viewers","first_viewers","rawFirstViewers","message_id","rawFirstViewer","user_id","user_name","Error","options","typeOptions","newType","convertSnakeToCamelCase","toLowerCase","newKey","UsersModel","onlineList","mobileOnlineList","absentList","botList","firstName","lastName","workPosition","gender","network","bot","connector","externalAuthId","status","idle","lastActivityDate","mobileLastDate","isOnline","isMobileOnline","birthday","isBirthday","absent","isAbsent","departments","phones","workPhone","personalMobile","personalPhone","innerPhone","getTemporary","getList","userList","hasBirthday","hasVacation","getStatus","UserStatus","mobileOnline","getLastOnline","getLastDateText","getPosition","Loc","getMessage","getBotType","botType","BotType","existingUser","setBotList","setStatus","addToOnlineList","addToMobileOnlineList","isBirthdayToday","getTimeToNextMidnight","addToAbsentList","startOnlineCheckInterval","startAbsentCheckInterval","isDate","first_name","last_name","work_position","external_auth_id","last_activity_date","mobile_last_date","departmentId","preparePhones","work_phone","personal_mobile","personal_phone","inner_phone","absentCheckInterval","TIME_TO_NEXT_DAY","setInterval","currentTime","now","absentEnd","getTime","onlineCheckInterval","ONE_MINUTE","FilesModel","extension","icon","size","image","FileStatus","done","progress","authorName","urlPreview","urlShow","urlDownload","viewerAttrs","isInCollection","preparedFile","file","currentFile","getIconTypeByExtension","width","height","validateViewerAttributes","viewer","actions","objectId","src","viewerGroupBy","viewerType","viewerTypeClass","viewerSeparateItem","viewerExtension","imChatId","CallsModel","RecentCallStatus","waiting","addActiveCall","existingCall","validateActiveCall","prepareActiveCall","updateActiveCall","deleteActiveCall","isObjectLike","associatedEntity","RecentModel","calls","recentCollection","unreadCollection","unloadedChatCounters","MessageStatus","received","withFile","withAttach","draft","pinned","liked","invitation","isActive","originator","canResend","getRecentCollection","getUnreadCollection","getSortedCollection","collectionAsArray","isBirthdayPlaceholder","birthdayPlaceholder","isInvitedUser","defaultUserRecord","needsBirthdayPlaceholder","hasTodayMessage","isToday","needsVacationPlaceholder","getMessageDate","getStartOfTheDay","getTotalCounter","loadedChatsCounter","recentItem","isMuted","isMarked","unloadedChatsCounter","setRecent","then","itemIds","zeroedCountersForNewItems","setUnread","itemsToUpdate","itemsToAdd","action","like","isLastMessage","isExactMessageLiked","clearUnread","setUnloadedChatCounters","setRecentCollection","deleteFromRecentCollection","setUnreadCollection","defaultUserElement","currentElement","prepareMessage","prepareDraft","invited","originator_id","can_resend","default_user_record","NotificationsModel","Map","searchCollection","unreadCounter","notifyButtons","sectionCode","NotificationTypesCodes","simple","read","settingName","sortByType","getSearchResultCollection","getConfirmsCount","confirm","notificationId","getCounter","initialSet","total_unread_count","notifications","setSearchResult","skipValidation","readAll","clearSearchResult","setCounter","addSearchResult","updateSearchResult","clear","isNil","notify_title","notify_buttons","JSON","parse","buttons","button","COMMAND","COMMAND_PARAMS","VALUE","TEXT","TITLE","TYPE","DISPLAY","BG_COLOR","TEXT_COLOR","notify_type","notify_read","setting_name","LinksModel","counters","getSize","source","richData","previewUrl","links","preparedLink","url","validateRichData","FavoritesModel","isFavoriteMessage","chatFavorites","fromEntries","targetMessage","favorites","favorite","preparedFavoriteMessage","deleteByMessageId","targetLinkId","linkId","linkObject","MembersModel","TasksModel","task","creatorId","responsibleId","statusTitle","deadline","tasks","preparedTask","validateTask","MeetingsModel","meeting","dateFrom","dateTo","meetings","preparedMeeting","calendar","validateMeeting","subType","getLatest","rootState","rootGetters","media","audio","documents","other","SidebarFileTypes","document","sortedFlatCollection","flat","getTopThreeCompletedFiles","getLatestUnsorted","unsorted","fileUnsorted","sortedCollection","sidebarFile","slice","SidebarModel","members","initedList","isFilesMigrated","isLinksMigrated","isInited","setInited","setFilesMigrated","setLinksMigrated","MarketModel","placementCollection","PlacementType","contextMenu","navigation","textarea","sidebar","smilesSelector","role","context","iconName","placement","order","loadConfiguration","ID","PLACEMENT","PLACEMENT_ID","getByPlacement","appIds","items","setPlacementCollection","setCollection","app","configuration"],"mappings":"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"}