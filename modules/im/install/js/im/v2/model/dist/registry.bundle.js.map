{"version":3,"file":"registry.bundle.js","sources":["../src/application/settings.js","../src/application.js","../src/messages/pin.js","../src/messages/reactions.js","../src/messages.js","../src/dialogues.js","../src/users.js","../src/files.js","../src/recent/calls.js","../src/recent.js","../src/notifications.js","../src/sidebar/links.js","../src/sidebar/favorites.js","../src/sidebar/members.js","../src/sidebar/tasks.js","../src/sidebar/meeting.js","../src/sidebar/files.js","../src/sidebar.js","../src/market.js"],"sourcesContent":["import {Type} from 'main.core';\nimport {BuilderModel, GetterTree, ActionTree, MutationTree} from 'ui.vue3.vuex';\n\nimport {Settings} from 'im.v2.const';\n\ntype SettingsState = {[settingName: string]: any};\n\nexport class SettingsModel extends BuilderModel\n{\n\tgetState()\n\t{\n\t\treturn {\n\t\t\t[Settings.application.darkTheme]: false,\n\t\t\t[Settings.application.enableSound]: true,\n\n\t\t\t[Settings.dialog.bigSmiles]: true,\n\t\t\t[Settings.dialog.background]: 1,\n\n\t\t\t[Settings.recent.showBirthday]: true,\n\t\t\t[Settings.recent.showInvited]: true,\n\t\t\t[Settings.recent.showLastMessage]: true,\n\t\t};\n\t}\n\n\tgetGetters(): GetterTree\n\t{\n\t\treturn {\n\t\t\tget: (state: SettingsState) => (key: string): any =>\n\t\t\t{\n\t\t\t\treturn state[key];\n\t\t\t}\n\t\t};\n\t}\n\n\tgetActions(): ActionTree\n\t{\n\t\treturn {\n\t\t\tset: (store, payload: {[settingName: string]: any}) =>\n\t\t\t{\n\t\t\t\tstore.commit('set', this.validate(payload));\n\t\t\t}\n\t\t};\n\t}\n\n\tgetMutations(): MutationTree\n\t{\n\t\treturn {\n\t\t\tset: (state: SettingsState, payload: {[settingName: string]: any}) => {\n\t\t\t\tObject.entries(payload).forEach(([key, value]) => {\n\t\t\t\t\tstate[key] = value;\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\t}\n\n\tvalidate(fields): {[settingName: string]: any}\n\t{\n\t\tconst result = {};\n\n\t\tif (Type.isBoolean(fields[Settings.application.darkTheme]))\n\t\t{\n\t\t\tresult[Settings.application.darkTheme] = fields[Settings.application.darkTheme];\n\t\t}\n\n\t\tif (Type.isBoolean(fields[Settings.application.enableSound]))\n\t\t{\n\t\t\tresult[Settings.application.enableSound] = fields[Settings.application.enableSound];\n\t\t}\n\n\t\tif (Type.isBoolean(fields[Settings.dialog.bigSmiles]))\n\t\t{\n\t\t\tresult[Settings.dialog.bigSmiles] = fields[Settings.dialog.bigSmiles];\n\t\t}\n\n\t\tif (Type.isStringFilled(fields[Settings.dialog.background]))\n\t\t{\n\t\t\tfields[Settings.dialog.background] = Number.parseInt(fields[Settings.dialog.background], 10);\n\t\t}\n\t\tif (Type.isNumber(fields[Settings.dialog.background]))\n\t\t{\n\t\t\tresult[Settings.dialog.background] = fields[Settings.dialog.background];\n\t\t}\n\n\t\tif (Type.isBoolean(fields[Settings.recent.showBirthday]))\n\t\t{\n\t\t\tresult[Settings.recent.showBirthday] = fields[Settings.recent.showBirthday];\n\t\t}\n\n\t\tif (Type.isBoolean(fields[Settings.recent.showInvited]))\n\t\t{\n\t\t\tresult[Settings.recent.showInvited] = fields[Settings.recent.showInvited];\n\t\t}\n\n\t\tif (Type.isBoolean(fields[Settings.recent.showLastMessage]))\n\t\t{\n\t\t\tresult[Settings.recent.showLastMessage] = fields[Settings.recent.showLastMessage];\n\t\t}\n\n\t\treturn result;\n\t}\n}","import {Type} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport {BuilderModel} from 'ui.vue3.vuex';\n\nimport {Layout, EventType} from 'im.v2.const';\n\nimport {SettingsModel} from './application/settings';\n\nexport class ApplicationModel extends BuilderModel\n{\n\tgetName()\n\t{\n\t\treturn 'application';\n\t}\n\n\tgetNestedModules(): { [moduleName: string]: BuilderModel }\n\t{\n\t\treturn {settings: SettingsModel};\n\t}\n\n\tgetState()\n\t{\n\t\treturn {\n\t\t\tlayout:\n\t\t\t{\n\t\t\t\tname: Layout.chat.name,\n\t\t\t\tentityId: '',\n\t\t\t\tcontextId: 0\n\t\t\t}\n\t\t};\n\t}\n\n\tgetGetters()\n\t{\n\t\treturn {\n\t\t\tgetLayout: state =>\n\t\t\t{\n\t\t\t\treturn state.layout;\n\t\t\t},\n\t\t\tisChatOpen: state => (dialogId: string): boolean =>\n\t\t\t{\n\t\t\t\tif (!state.layout.name === Layout.chat.name)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn state.layout.entityId === dialogId.toString();\n\t\t\t},\n\t\t\tareNotificationsOpen: state =>\n\t\t\t{\n\t\t\t\treturn state.layout.name === Layout.notification.name;\n\t\t\t}\n\t\t};\n\t}\n\n\tgetActions()\n\t{\n\t\treturn {\n\t\t\tsetLayout: (store, payload: {layoutName: string, entityId?: string, contextId?: number}) =>\n\t\t\t{\n\t\t\t\tconst {layoutName, entityId = '', contextId = 0} = payload;\n\t\t\t\tif (!Type.isStringFilled(layoutName))\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst previousLayout = {...store.state.layout};\n\t\t\t\tconst newLayout = {\n\t\t\t\t\tname: this.validateLayout(layoutName),\n\t\t\t\t\tentityId: this.validateLayoutEntityId(layoutName, entityId),\n\t\t\t\t\tcontextId: contextId\n\t\t\t\t};\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tlayout: newLayout\n\t\t\t\t});\n\n\t\t\t\tEventEmitter.emit(EventType.layout.onLayoutChange, {\n\t\t\t\t\tfrom: previousLayout,\n\t\t\t\t\tto: newLayout\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\t}\n\n\tgetMutations()\n\t{\n\t\treturn {\n\t\t\tupdate: (state, payload) => {\n\t\t\t\tObject.keys(payload).forEach((group) => {\n\t\t\t\t\tObject.entries(payload[group]).forEach(([key, value]) => {\n\t\t\t\t\t\tstate[group][key] = value;\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\t}\n\n\tvalidateLayout(layoutName: string): string\n\t{\n\t\tif (!Layout[layoutName])\n\t\t{\n\t\t\treturn Layout.chat.name;\n\t\t}\n\n\t\treturn layoutName;\n\t}\n\n\tvalidateLayoutEntityId(layoutName: string, entityId: string): string\n\t{\n\t\tif (!Layout[layoutName])\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\t// TODO check `entityId` by layout name\n\n\t\treturn entityId;\n\t}\n}","import {BuilderModel} from 'ui.vue3.vuex';\n\nimport {Core} from 'im.v2.application.core';\nimport {Logger} from 'im.v2.lib.logger';\n\nimport type {ImModelMessage} from 'im.v2.model';\n\nexport class PinModel extends BuilderModel\n{\n\tgetState()\n\t{\n\t\treturn {\n\t\t\tcollection: {}\n\t\t};\n\t}\n\n\tgetGetters(): Object\n\t{\n\t\treturn {\n\t\t\tgetPinned: (state: PinState) => (chatId: number): ImModelMessage[] =>\n\t\t\t{\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\treturn [...state.collection[chatId]].map(pinnedMessageId => {\n\t\t\t\t\treturn Core.getStore().getters['messages/getById'](pinnedMessageId);\n\t\t\t\t});\n\t\t\t},\n\t\t\tisPinned: (state: PinState) => (payload: {chatId: number, messageId: number}): boolean =>\n\t\t\t{\n\t\t\t\tconst {chatId, messageId} = payload;\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[chatId].has(messageId);\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions(): Object\n\t{\n\t\treturn {\n\t\t\tsetPinned: (store, payload: {chatId: number, pinnedMessages: number[]}) =>\n\t\t\t{\n\t\t\t\tconst {chatId, pinnedMessages} = payload;\n\t\t\t\tif (pinnedMessages.length === 0)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setPinned', {\n\t\t\t\t\tchatId,\n\t\t\t\t\tpinnedMessageIds: pinnedMessages\n\t\t\t\t});\n\t\t\t},\n\t\t\tset: (store, payload: {chatId: number, messageId: number, action: boolean}) =>\n\t\t\t{\n\t\t\t\tstore.commit('set', payload);\n\t\t\t},\n\t\t\tadd: (store, payload: {chatId: number, messageId: number}) =>\n\t\t\t{\n\t\t\t\tstore.commit('add', payload);\n\t\t\t},\n\t\t\tdelete: (store, payload: {chatId: number, messageId: number}) =>\n\t\t\t{\n\t\t\t\tstore.commit('delete', payload);\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMutations(): Object\n\t{\n\t\treturn {\n\t\t\tsetPinned: (state: PinState, payload: {chatId: number, pinnedMessageIds: number[]}) =>\n\t\t\t{\n\t\t\t\tLogger.warn('Messages/pin model: setPinned mutation', payload);\n\t\t\t\tconst {chatId, pinnedMessageIds} = payload;\n\t\t\t\tstate.collection[chatId] = new Set(pinnedMessageIds.reverse());\n\t\t\t},\n\t\t\tadd: (state: PinState, payload: {chatId: number, messageId: number}) =>\n\t\t\t{\n\t\t\t\tLogger.warn('Messages/pin model: add pin mutation', payload);\n\t\t\t\tconst {chatId, messageId} = payload;\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\tstate.collection[chatId] = new Set();\n\t\t\t\t}\n\n\t\t\t\tstate.collection[chatId].add(messageId);\n\t\t\t},\n\t\t\tdelete: (state: PinState, payload: {chatId: number, messageId: number}) =>\n\t\t\t{\n\t\t\t\tLogger.warn('Messages/pin model: delete pin mutation', payload);\n\t\t\t\tconst {chatId, messageId} = payload;\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstate.collection[chatId].delete(messageId);\n\t\t\t}\n\t\t};\n\t}\n}\n\ntype PinState = {\n\tcollection: {\n\t\t[chatId: string]: Set\n\t}\n};","import {BuilderModel} from 'ui.vue3.vuex';\nimport {reactionType as Reaction} from 'ui.reactions-select';\n\nimport {Core} from 'im.v2.application.core';\n\nimport type {Store, GetterTree, ActionTree, MutationTree} from 'ui.vue3.vuex';\nimport type {ImModelReactions} from 'im.v2.model';\n\ntype ReactionType = $Values<typeof Reaction>;\n\ntype RawReactions = {\n\tmessageId: number,\n\treactionCounters: {[reactionType: string]: number},\n\treactionUsers: {[reactionType: string]: number[]},\n\townReactions: ReactionType[]\n};\ntype RawReactionsList = RawReactions[];\n\ntype ReactionsState = {\n\tcollection: {\n\t\t[messageId: string]: ImModelReactions\n\t}\n};\n\nconst USERS_TO_SHOW = 5;\n\nexport class ReactionsModel extends BuilderModel\n{\n\tgetState(): ReactionsState\n\t{\n\t\treturn {\n\t\t\tcollection: {}\n\t\t};\n\t}\n\n\tgetElementState()\n\t{\n\t\treturn {\n\t\t\treactionCounters: {},\n\t\t\treactionUsers: {},\n\t\t\townReactions: new Set()\n\t\t};\n\t}\n\n\tgetGetters(): GetterTree\n\t{\n\t\treturn {\n\t\t\tgetByMessageId: (state: ReactionsState) => (messageId: number): ?ImModelReactions =>\n\t\t\t{\n\t\t\t\treturn state.collection[messageId];\n\t\t\t}\n\t\t};\n\t}\n\n\tgetActions(): ActionTree\n\t{\n\t\treturn {\n\t\t\tset: (store: Store, payload: RawReactionsList) =>\n\t\t\t{\n\t\t\t\tstore.commit('set', this.prepareSetPayload(payload));\n\t\t\t},\n\t\t\tsetReaction: (\n\t\t\t\tstore: Store,\n\t\t\t\tpayload: {messageId: number, userId: number, reaction: ReactionType}\n\t\t\t) =>\n\t\t\t{\n\t\t\t\tif (!Reaction[payload.reaction])\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (!store.state.collection[payload.messageId])\n\t\t\t\t{\n\t\t\t\t\tstore.state.collection[payload.messageId] = this.getElementState();\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setReaction', payload);\n\t\t\t},\n\t\t\tremoveReaction: (\n\t\t\t\tstore: Store,\n\t\t\t\tpayload: {messageId: number, userId: number, reaction: ReactionType}\n\t\t\t) =>\n\t\t\t{\n\t\t\t\tif (!store.state.collection[payload.messageId] || !Reaction[payload.reaction])\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tstore.commit('removeReaction', payload);\n\t\t\t}\n\t\t};\n\t}\n\n\tgetMutations(): MutationTree\n\t{\n\t\treturn {\n\t\t\tset: (state: ReactionsState, payload: RawReactionsList) =>\n\t\t\t{\n\t\t\t\tpayload.forEach(item => {\n\t\t\t\t\tconst newItem = {\n\t\t\t\t\t\treactionCounters: item.reactionCounters,\n\t\t\t\t\t\treactionUsers: item.reactionUsers\n\t\t\t\t\t};\n\n\t\t\t\t\tconst currentItem = state.collection[item.messageId];\n\t\t\t\t\tconst newOwnReaction = !!item.ownReactions;\n\t\t\t\t\tif (newOwnReaction)\n\t\t\t\t\t{\n\t\t\t\t\t\tnewItem.ownReactions = item.ownReactions;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tnewItem.ownReactions = currentItem ? currentItem.ownReactions : new Set();\n\t\t\t\t\t}\n\n\t\t\t\t\tstate.collection[item.messageId] = newItem;\n\t\t\t\t});\n\t\t\t},\n\t\t\tsetReaction: (\n\t\t\t\tstate: ReactionsState,\n\t\t\t\tpayload: {messageId: number, userId: number, reaction: ReactionType}\n\t\t\t) =>\n\t\t\t{\n\t\t\t\tconst {messageId, userId, reaction} = payload;\n\t\t\t\tconst reactions = state.collection[messageId];\n\t\t\t\tif (Core.getUserId() === userId)\n\t\t\t\t{\n\t\t\t\t\tthis.removeAllCurrentUserReactions(reactions);\n\t\t\t\t\treactions.ownReactions.add(reaction);\n\t\t\t\t}\n\n\t\t\t\tif (!reactions.reactionCounters[reaction])\n\t\t\t\t{\n\t\t\t\t\treactions.reactionCounters[reaction] = 0;\n\t\t\t\t}\n\t\t\t\tconst currentCounter = reactions.reactionCounters[reaction];\n\t\t\t\tif (currentCounter + 1 <= USERS_TO_SHOW)\n\t\t\t\t{\n\t\t\t\t\tif (!reactions.reactionUsers[reaction])\n\t\t\t\t\t{\n\t\t\t\t\t\treactions.reactionUsers[reaction] = new Set();\n\t\t\t\t\t}\n\t\t\t\t\treactions.reactionUsers[reaction].add(userId);\n\t\t\t\t}\n\n\t\t\t\treactions.reactionCounters[reaction]++;\n\t\t\t},\n\t\t\tremoveReaction: (\n\t\t\t\tstate: ReactionsState,\n\t\t\t\tpayload: {messageId: number, userId: number, reaction: ReactionType}\n\t\t\t) =>\n\t\t\t{\n\t\t\t\tconst {messageId, userId, reaction} = payload;\n\t\t\t\tconst reactions = state.collection[messageId];\n\n\t\t\t\tif (Core.getUserId() === userId)\n\t\t\t\t{\n\t\t\t\t\treactions.ownReactions.delete(reaction);\n\t\t\t\t}\n\n\t\t\t\treactions.reactionUsers[reaction]?.delete(userId);\n\t\t\t\treactions.reactionCounters[reaction]--;\n\t\t\t\tif (reactions.reactionCounters[reaction] === 0)\n\t\t\t\t{\n\t\t\t\t\tdelete reactions.reactionCounters[reaction];\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t}\n\n\tremoveAllCurrentUserReactions(reactions: ImModelReactions)\n\t{\n\t\treactions.ownReactions.forEach(reaction => {\n\t\t\treactions.reactionUsers[reaction]?.delete(Core.getUserId());\n\t\t\treactions.reactionCounters[reaction]--;\n\t\t\tif (reactions.reactionCounters[reaction] === 0)\n\t\t\t{\n\t\t\t\tdelete reactions.reactionCounters[reaction];\n\t\t\t}\n\t\t});\n\n\t\treactions.ownReactions = new Set();\n\t}\n\n\tprepareSetPayload(payload: RawReactionsList)\n\t{\n\t\treturn payload.map(item => {\n\t\t\tconst reactionUsers = {};\n\t\t\tObject.entries(item.reactionUsers).forEach(([reaction, users]) => {\n\t\t\t\treactionUsers[reaction] = new Set(users);\n\t\t\t});\n\n\t\t\tconst reactionCounters = {};\n\t\t\tObject.entries(item.reactionCounters).forEach(([reaction, counter]) => {\n\t\t\t\treactionCounters[reaction] = counter;\n\t\t\t});\n\n\t\t\tconst result = {\n\t\t\t\tmessageId: item.messageId,\n\t\t\t\treactionCounters: reactionCounters,\n\t\t\t\treactionUsers: reactionUsers\n\t\t\t};\n\n\t\t\tif (item.ownReactions?.length > 0)\n\t\t\t{\n\t\t\t\tresult.ownReactions = new Set(item.ownReactions);\n\t\t\t}\n\n\t\t\treturn result;\n\t\t});\n\t}\n}","import { Type } from 'main.core';\nimport { BuilderModel } from 'ui.vue3.vuex';\n\nimport { Core } from 'im.v2.application.core';\nimport { Utils } from 'im.v2.lib.utils';\nimport { Logger } from 'im.v2.lib.logger';\nimport { MessageComponent, MessageExtension, MessageType } from 'im.v2.const';\n\nimport { PinModel } from './messages/pin';\nimport { ReactionsModel } from './messages/reactions';\n\nimport type { ImModelMessage, ImModelFile } from 'im.v2.model';\nimport type { RawMessage, RawMessageParams, PreparedMessageParams } from './type/message';\n\ntype MessagesState = {\n\tcollection: {\n\t\t[messageId: string]: ImModelMessage\n\t},\n\tchatCollection: {\n\t\t[chatId: string]: Set<string | number>\n\t}\n};\n\nexport class MessagesModel extends BuilderModel\n{\n\tgetName()\n\t{\n\t\treturn 'messages';\n\t}\n\n\tgetNestedModules(): { [moduleName: string]: BuilderModel }\n\t{\n\t\treturn {\n\t\t\tpin: PinModel,\n\t\t\treactions: ReactionsModel,\n\t\t};\n\t}\n\n\tgetState()\n\t{\n\t\treturn {\n\t\t\tcollection: {},\n\t\t\tchatCollection: {},\n\t\t};\n\t}\n\n\tgetElementState()\n\t{\n\t\treturn {\n\t\t\tid: 0,\n\t\t\tchatId: 0,\n\t\t\tauthorId: 0,\n\t\t\tdate: new Date(),\n\t\t\ttext: '',\n\t\t\treplaces: [],\n\t\t\tfiles: [],\n\t\t\tattach: [],\n\t\t\tunread: false,\n\t\t\tviewed: true,\n\t\t\tviewedByOthers: false,\n\t\t\tsending: false,\n\t\t\terror: false,\n\t\t\tretry: false,\n\t\t\tcomponentId: MessageComponent.base,\n\t\t\tcomponentParams: {},\n\t\t\textensionId: MessageExtension.text,\n\t\t\textensionParams: {},\n\t\t\tisEdited: false,\n\t\t\tisDeleted: false,\n\t\t\tremoveLinks: false,\n\t\t};\n\t}\n\n\tgetGetters()\n\t{\n\t\treturn {\n\t\t\t/** @function messages/get */\n\t\t\tget: (state: MessagesState) => (chatId: number) => {\n\t\t\t\tif (!state.chatCollection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\treturn [...state.chatCollection[chatId]].map((messageId: number | string) => {\n\t\t\t\t\treturn state.collection[messageId];\n\t\t\t\t}).sort((a, b) => {\n\t\t\t\t\treturn a.id - b.id;\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function messages/getById */\n\t\t\tgetById: (state: MessagesState) => (id: number): ?ImModelMessage => {\n\t\t\t\treturn state.collection[id];\n\t\t\t},\n\t\t\t/** @function messages/getByIdList */\n\t\t\tgetByIdList: (state: MessagesState) => (idList: number[]): ImModelMessage[] => {\n\t\t\t\tconst result = [];\n\t\t\t\tidList.forEach((id) => {\n\t\t\t\t\tif (state.collection[id])\n\t\t\t\t\t{\n\t\t\t\t\t\tresult.push(state.collection[id]);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\treturn result;\n\t\t\t},\n\t\t\t/** @function messages/hasMessage */\n\t\t\thasMessage: (state: MessagesState) => ({ chatId, messageId}) => {\n\t\t\t\tif (!state.chatCollection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn state.chatCollection[chatId].has(messageId);\n\t\t\t},\n\t\t\t/** @function messages/isInChatCollection */\n\t\t\tisInChatCollection: (state: MessagesState) => (payload: {messageId: number}): boolean => {\n\t\t\t\tconst { messageId } = payload;\n\t\t\t\tconst message = state.collection[messageId];\n\t\t\t\tif (!message)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tconst { chatId } = message;\n\n\t\t\t\treturn state.chatCollection[chatId]?.has(messageId);\n\t\t\t},\n\t\t\t/** @function messages/getFirstId */\n\t\t\tgetFirstId: (state: MessagesState) => (chatId: number): number => {\n\t\t\t\tif (!state.chatCollection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn this.#findLowestMessageId(state, chatId);\n\t\t\t},\n\t\t\t/** @function messages/getLastId */\n\t\t\tgetLastId: (state: MessagesState) => (chatId: number): number => {\n\t\t\t\tif (!state.chatCollection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn this.#findMaxMessageId(state, chatId);\n\t\t\t},\n\t\t\t/** @function messages/getLastOwnMessageId */\n\t\t\tgetLastOwnMessageId: (state: MessagesState) => (chatId: number): number => {\n\t\t\t\tif (!state.chatCollection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn this.#findLastOwnMessageId(state, chatId);\n\t\t\t},\n\t\t\t/** @function messages/getFirstUnread */\n\t\t\tgetFirstUnread: (state: MessagesState) => (chatId: number): number => {\n\t\t\t\tif (!state.chatCollection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn this.#findFirstUnread(state, chatId);\n\t\t\t},\n\t\t\t/** @function messages/getChatUnreadMessages */\n\t\t\tgetChatUnreadMessages: (state: MessagesState) => (chatId: number): ImModelMessage[] => {\n\t\t\t\tif (!state.chatCollection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\tconst messages = [...state.chatCollection[chatId]].map((messageId: number | string) => {\n\t\t\t\t\treturn state.collection[messageId];\n\t\t\t\t});\n\n\t\t\t\treturn messages.filter((message: ImModelMessage) => {\n\t\t\t\t\treturn message.unread === true;\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function messages/getMessageFiles */\n\t\t\tgetMessageFiles: (state: MessagesState) => (payload: number): ImModelFile[] => {\n\t\t\t\tconst messageId = payload;\n\t\t\t\tif (!state.collection[messageId])\n\t\t\t\t{\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[messageId].files.map((fileId) => {\n\t\t\t\t\treturn this.store.getters['files/get'](fileId, true);\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function messages/getMessageType */\n\t\t\tgetMessageType: (state: MessagesState) => (messageId: number): ?$Values<typeof MessageType> => {\n\t\t\t\tconst message = state.collection[messageId];\n\t\t\t\tif (!message)\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\tconst currentUserId = Core.getUserId();\n\t\t\t\tif (message.authorId === 0)\n\t\t\t\t{\n\t\t\t\t\treturn MessageType.system;\n\t\t\t\t}\n\n\t\t\t\tif (message.authorId === currentUserId)\n\t\t\t\t{\n\t\t\t\t\treturn MessageType.self;\n\t\t\t\t}\n\n\t\t\t\treturn MessageType.opponent;\n\t\t\t},\n\t\t\t/** @function messages/getPreviousMessage */\n\t\t\tgetPreviousMessage: (state: MessagesState) => (payload: {messageId: number, chatId: number}): ?ImModelMessage => {\n\t\t\t\tconst { messageId, chatId } = payload;\n\t\t\t\tconst message = state.collection[messageId];\n\t\t\t\tif (!message)\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\tconst chatCollection = [...state.chatCollection[chatId]];\n\t\t\t\tconst initialMessageIndex = chatCollection.indexOf(messageId);\n\t\t\t\tconst desiredMessageId = chatCollection[initialMessageIndex - 1];\n\t\t\t\tif (!desiredMessageId)\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[desiredMessageId];\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions()\n\t{\n\t\treturn {\n\t\t\t/** @function messages/setChatCollection */\n\t\t\tsetChatCollection: (store, payload: {messages: RawMessage | RawMessage[], clearCollection: boolean}) => {\n\t\t\t\tlet { messages, clearCollection } = payload;\n\t\t\t\tclearCollection = clearCollection ?? false;\n\t\t\t\tif (!Array.isArray(messages) && Type.isPlainObject(messages))\n\t\t\t\t{\n\t\t\t\t\tmessages = [messages];\n\t\t\t\t}\n\n\t\t\t\tmessages = messages.map((message: RawMessage) => {\n\t\t\t\t\treturn { ...this.getElementState(), ...this.validate(message) };\n\t\t\t\t});\n\n\t\t\t\tconst chatId = messages[0]?.chatId;\n\t\t\t\tif (chatId && clearCollection)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('clearCollection', { chatId });\n\t\t\t\t}\n\n\t\t\t\tstore.commit('store', { messages });\n\t\t\t\tstore.commit('setChatCollection', { messages });\n\t\t\t},\n\t\t\t/** @function messages/store */\n\t\t\tstore: (store, payload: RawMessage | RawMessage[]) => {\n\t\t\t\tlet preparedMessages = payload;\n\t\t\t\tif (Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\tpreparedMessages = [payload];\n\t\t\t\t}\n\n\t\t\t\tpreparedMessages = preparedMessages.map((message: RawMessage) => {\n\t\t\t\t\treturn { ...this.getElementState(), ...this.validate(message) };\n\t\t\t\t});\n\n\t\t\t\tif (preparedMessages.length === 0)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('store', {\n\t\t\t\t\tmessages: preparedMessages,\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function messages/add */\n\t\t\tadd: (store, payload: RawMessage) => {\n\t\t\t\tconst message = {\n\t\t\t\t\t...this.getElementState(),\n\t\t\t\t\t...this.validate(payload),\n\t\t\t\t};\n\t\t\t\tstore.commit('store', {\n\t\t\t\t\tmessages: [message],\n\t\t\t\t});\n\t\t\t\tstore.commit('setChatCollection', {\n\t\t\t\t\tmessages: [message],\n\t\t\t\t});\n\n\t\t\t\treturn message.id;\n\t\t\t},\n\t\t\t/** @function messages/updateWithId */\n\t\t\tupdateWithId: (store, payload: {id: string | number, fields: Object}) => {\n\t\t\t\tconst { id, fields } = payload;\n\t\t\t\tif (!store.state.collection[id])\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('updateWithId', {\n\t\t\t\t\tid,\n\t\t\t\t\tfields: this.validate(fields),\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function messages/update */\n\t\t\tupdate: (store, payload: {id: string | number, fields: Object}) => {\n\t\t\t\tconst { id, fields } = payload;\n\t\t\t\tconst currentMessage = store.state.collection[id];\n\t\t\t\tif (!currentMessage)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tid,\n\t\t\t\t\tfields: { ...currentMessage, ...this.validate(fields) }\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function messages/readMessages */\n\t\t\treadMessages: (store, payload: {chatId: number, messageIds: number[]}): number => {\n\t\t\t\tconst { chatId, messageIds } = payload;\n\t\t\t\tif (!store.state.chatCollection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\tconst chatMessages = [...store.state.chatCollection[chatId]].map((messageId: number) => {\n\t\t\t\t\treturn store.state.collection[messageId];\n\t\t\t\t});\n\n\t\t\t\tlet messagesToReadCount = 0;\n\t\t\t\tconst maxMessageId = this.#getMaxMessageId(messageIds);\n\t\t\t\tconst messageIdsToView = messageIds;\n\t\t\t\tconst messageIdsToRead = [];\n\t\t\t\tchatMessages.forEach((chatMessage: ImModelMessage) => {\n\t\t\t\t\tif (!chatMessage.unread)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (chatMessage.id <= maxMessageId)\n\t\t\t\t\t{\n\t\t\t\t\t\tmessagesToReadCount++;\n\t\t\t\t\t\tmessageIdsToRead.push(chatMessage.id);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tstore.commit('readMessages', {\n\t\t\t\t\tmessageIdsToRead,\n\t\t\t\t\tmessageIdsToView,\n\t\t\t\t});\n\n\t\t\t\treturn messagesToReadCount;\n\t\t\t},\n\t\t\t/** @function messages/setViewedByOthers */\n\t\t\tsetViewedByOthers: (store, payload: {ids: number[]}): number => {\n\t\t\t\tconst { ids } = payload;\n\t\t\t\tstore.commit('setViewedByOthers', {\n\t\t\t\t\tids,\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function messages/delete */\n\t\t\tdelete: (store, payload: {id: string | number}) => {\n\t\t\t\tconst { id } = payload;\n\t\t\t\tif (!store.state.collection[id])\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('delete', { id });\n\t\t\t},\n\t\t\t/** @function messages/clearChatCollection */\n\t\t\tclearChatCollection: (store, payload: {chatId: number}) => {\n\t\t\t\tconst { chatId } = payload;\n\t\t\t\tstore.commit('clearCollection', { chatId });\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMutations()\n\t{\n\t\treturn {\n\t\t\tsetChatCollection: (state: MessagesState, payload: {messages: ImModelMessage[]}) => {\n\t\t\t\tLogger.warn('Messages model: setChatCollection mutation', payload);\n\t\t\t\tpayload.messages.forEach((message) => {\n\t\t\t\t\tif (!state.chatCollection[message.chatId])\n\t\t\t\t\t{\n\t\t\t\t\t\t// eslint-disable-next-line no-param-reassign\n\t\t\t\t\t\tstate.chatCollection[message.chatId] = new Set();\n\t\t\t\t\t}\n\t\t\t\t\tstate.chatCollection[message.chatId].add(message.id);\n\t\t\t\t});\n\t\t\t},\n\t\t\tstore: (state: MessagesState, payload: {messages: ImModelMessage[]}) => {\n\t\t\t\tLogger.warn('Messages model: store mutation', payload);\n\t\t\t\tpayload.messages.forEach((message) => {\n\t\t\t\t\t// eslint-disable-next-line no-param-reassign\n\t\t\t\t\tstate.collection[message.id] = message;\n\t\t\t\t});\n\t\t\t},\n\t\t\tupdateWithId: (state: MessagesState, payload: {id: number | string, fields: Object}) => {\n\t\t\t\tLogger.warn('Messages model: updateWithId mutation', payload);\n\t\t\t\tconst { id, fields } = payload;\n\t\t\t\tconst currentMessage = { ...state.collection[id] };\n\n\t\t\t\t// eslint-disable-next-line no-param-reassign\n\t\t\t\tdelete state.collection[id];\n\t\t\t\t// eslint-disable-next-line no-param-reassign\n\t\t\t\tstate.collection[fields.id] = { ...currentMessage, ...fields, sending: false };\n\n\t\t\t\tif (state.chatCollection[currentMessage.chatId].has(id))\n\t\t\t\t{\n\t\t\t\t\tstate.chatCollection[currentMessage.chatId].delete(id);\n\t\t\t\t\tstate.chatCollection[currentMessage.chatId].add(fields.id);\n\t\t\t\t}\n\t\t\t},\n\t\t\tupdate: (state: MessagesState, payload: {id: number | string, fields: Object}) => {\n\t\t\t\tLogger.warn('Messages model: update mutation', payload);\n\t\t\t\tconst { id, fields } = payload;\n\t\t\t\t// eslint-disable-next-line no-param-reassign\n\t\t\t\tstate.collection[id] = { ...state.collection[id], ...fields };\n\t\t\t},\n\t\t\tdelete: (state: MessagesState, payload: {id: number | string}) => {\n\t\t\t\tLogger.warn('Messages model: delete mutation', payload);\n\t\t\t\tconst { id } = payload;\n\t\t\t\tconst { chatId } = state.collection[id];\n\t\t\t\tstate.chatCollection[chatId].delete(id);\n\t\t\t\t// eslint-disable-next-line no-param-reassign\n\t\t\t\tdelete state.collection[id];\n\t\t\t},\n\t\t\tclearCollection: (state: MessagesState, payload: {chatId: number}) => {\n\t\t\t\tLogger.warn('Messages model: clear collection mutation', payload.chatId);\n\t\t\t\t// eslint-disable-next-line no-param-reassign\n\t\t\t\tstate.chatCollection[payload.chatId] = new Set();\n\t\t\t},\n\t\t\treadMessages: (state: MessagesState, payload: {messageIdsToRead: number[], messageIdsToView: number[]}) => {\n\t\t\t\tconst { messageIdsToRead, messageIdsToView } = payload;\n\t\t\t\tmessageIdsToRead.forEach((messageId) => {\n\t\t\t\t\tconst message = state.collection[messageId];\n\t\t\t\t\tif (!message)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tmessage.unread = false;\n\t\t\t\t});\n\t\t\t\tmessageIdsToView.forEach((messageId) => {\n\t\t\t\t\tconst message = state.collection[messageId];\n\t\t\t\t\tif (!message)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tmessage.viewed = true;\n\t\t\t\t});\n\t\t\t},\n\t\t\tsetViewedByOthers: (state: MessagesState, payload: {ids: number[]}) => {\n\t\t\t\tconst { ids } = payload;\n\t\t\t\tids.forEach((id) => {\n\t\t\t\t\tconst message = state.collection[id];\n\t\t\t\t\tif (!message)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tconst isOwnMessage = message.authorId === Core.getUserId();\n\t\t\t\t\tif (!isOwnMessage || message.viewedByOthers)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tmessage.viewedByOthers = true;\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\t}\n\n\tvalidate(fields: Object): Object\n\t{\n\t\tlet result = {};\n\n\t\tif (Type.isNumber(fields.id))\n\t\t{\n\t\t\tresult.id = fields.id;\n\t\t}\n\t\telse if (Utils.text.isUuidV4(fields.temporaryId))\n\t\t{\n\t\t\tresult.id = fields.temporaryId;\n\t\t}\n\n\t\tif (!Type.isUndefined(fields.chat_id))\n\t\t{\n\t\t\tfields.chatId = fields.chat_id;\n\t\t}\n\t\tif (Type.isNumber(fields.chatId) || Type.isStringFilled(fields.chatId))\n\t\t{\n\t\t\tresult.chatId = Number.parseInt(fields.chatId, 10);\n\t\t}\n\n\t\tif (Type.isStringFilled(fields.date))\n\t\t{\n\t\t\tresult.date = Utils.date.cast(fields.date);\n\t\t}\n\n\t\tif (Type.isNumber(fields.text) || Type.isString(fields.text))\n\t\t{\n\t\t\tresult.text = fields.text.toString();\n\t\t}\n\n\t\tif (Type.isStringFilled(fields.system))\n\t\t{\n\t\t\tfields.isSystem = fields.system === 'Y';\n\t\t}\n\n\t\tif (!Type.isUndefined(fields.senderId))\n\t\t{\n\t\t\tfields.authorId = fields.senderId;\n\t\t}\n\t\telse if (!Type.isUndefined(fields.author_id))\n\t\t{\n\t\t\tfields.authorId = fields.author_id;\n\t\t}\n\t\tif (Type.isNumber(fields.authorId) || Type.isStringFilled(fields.authorId))\n\t\t{\n\t\t\tresult.authorId = Number.parseInt(fields.authorId, 10);\n\t\t}\n\n\t\tif (fields.isSystem === true)\n\t\t{\n\t\t\tresult.authorId = 0;\n\t\t}\n\n\t\tif (Type.isArray(fields.replaces))\n\t\t{\n\t\t\tresult.replaces = fields.replaces;\n\t\t}\n\n\t\tif (Type.isBoolean(fields.sending))\n\t\t{\n\t\t\tresult.sending = fields.sending;\n\t\t}\n\n\t\tif (Type.isBoolean(fields.unread))\n\t\t{\n\t\t\tresult.unread = fields.unread;\n\t\t}\n\n\t\tif (Type.isBoolean(fields.viewed))\n\t\t{\n\t\t\tresult.viewed = fields.viewed;\n\t\t}\n\n\t\tif (Type.isBoolean(fields.viewedByOthers))\n\t\t{\n\t\t\tresult.viewedByOthers = fields.viewedByOthers;\n\t\t}\n\n\t\tif (Type.isBoolean(fields.error))\n\t\t{\n\t\t\tresult.error = fields.error;\n\t\t}\n\n\t\tif (Type.isBoolean(fields.retry))\n\t\t{\n\t\t\tresult.retry = fields.retry;\n\t\t}\n\n\t\tif (Type.isString(fields.componentId))\n\t\t{\n\t\t\tresult.componentId = fields.componentId;\n\t\t}\n\n\t\tif (Type.isArray(fields.files))\n\t\t{\n\t\t\tresult.files = fields.files;\n\t\t}\n\n\t\tif (Type.isArray(fields.attach))\n\t\t{\n\t\t\tresult.attach = fields.attach;\n\t\t}\n\n\t\tif (Type.isBoolean(fields.isEdited))\n\t\t{\n\t\t\tresult.isEdited = fields.isEdited;\n\t\t}\n\n\t\tif (Type.isBoolean(fields.isDeleted))\n\t\t{\n\t\t\tresult.isDeleted = fields.isDeleted;\n\t\t}\n\n\t\tif (Type.isBoolean(fields.removeLinks))\n\t\t{\n\t\t\tresult.removeLinks = fields.removeLinks;\n\t\t}\n\n\t\tif (Type.isPlainObject(fields.params))\n\t\t{\n\t\t\tconst preparedParams = this.prepareParams(fields.params);\n\t\t\tresult = {...result, ...preparedParams};\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tprepareParams(rawParams: RawMessageParams): PreparedMessageParams\n\t{\n\t\tconst result = {};\n\n\t\tObject.entries(rawParams).forEach(([key, value]) => {\n\t\t\tif (key === 'COMPONENT_ID' && Type.isStringFilled(value))\n\t\t\t{\n\t\t\t\tif (Object.values(MessageComponent).includes(value))\n\t\t\t\t{\n\t\t\t\t\tresult.componentId = value;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (key === 'COMPONENT_PARAMS' && Type.isPlainObject(value))\n\t\t\t{\n\t\t\t\tresult.componentParams = value;\n\t\t\t}\n\t\t\telse if (key === 'EXTENSION_ID' && Type.isStringFilled(value))\n\t\t\t{\n\t\t\t\tif (Object.values(MessageExtension).includes(value))\n\t\t\t\t{\n\t\t\t\t\tresult.extensionId = value;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tresult.extensionId = MessageExtension.unsupported;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (key === 'EXTENSION_PARAMS' && Type.isPlainObject(value))\n\t\t\t{\n\t\t\t\tresult.extensionParams = value;\n\t\t\t}\n\t\t\telse if (key === 'FILE_ID' && Type.isArray(value))\n\t\t\t{\n\t\t\t\tresult.files = value;\n\t\t\t}\n\t\t\telse if (key === 'IS_EDITED' && Type.isStringFilled(value))\n\t\t\t{\n\t\t\t\tresult.isEdited = value === 'Y';\n\t\t\t}\n\t\t\telse if (key === 'IS_DELETED' && Type.isStringFilled(value))\n\t\t\t{\n\t\t\t\tresult.isDeleted = value === 'Y';\n\t\t\t}\n\t\t\telse if (key === 'ATTACH' && (Type.isArray(value) || Type.isBoolean(value) || Type.isString(value)))\n\t\t\t{\n\t\t\t\tresult.attach = value;\n\t\t\t}\n\t\t\telse if (key === 'LINK_ACTIVE' && Type.isArrayFilled(value))\n\t\t\t{\n\t\t\t\tresult.removeLinks = value.includes(Core.getUserId());\n\t\t\t}\n\t\t});\n\n\t\treturn result;\n\t}\n\n\t#getMaxMessageId(messageIds: number[]): number\n\t{\n\t\tlet maxMessageId = 0;\n\t\tmessageIds.forEach(messageId => {\n\t\t\tif (maxMessageId < messageId)\n\t\t\t{\n\t\t\t\tmaxMessageId = messageId;\n\t\t\t}\n\t\t});\n\n\t\treturn maxMessageId;\n\t}\n\n\t#findLowestMessageId(state: MessagesState, chatId: number): number\n\t{\n\t\tlet firstId = null;\n\t\tconst messages = [...state.chatCollection[chatId]];\n\t\tfor (const messageId of messages)\n\t\t{\n\t\t\tconst element = state.collection[messageId];\n\t\t\tif (!firstId)\n\t\t\t{\n\t\t\t\tfirstId = element.id;\n\t\t\t}\n\t\t\tif (Utils.text.isTempMessage(element.id))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (element.id < firstId)\n\t\t\t{\n\t\t\t\tfirstId = element.id;\n\t\t\t}\n\t\t}\n\n\t\treturn firstId;\n\t}\n\n\t#findMaxMessageId(state: MessagesState, chatId: number): number\n\t{\n\t\tlet lastId = 0;\n\t\tconst messages = [...state.chatCollection[chatId]];\n\t\tfor (const messageId of messages)\n\t\t{\n\t\t\tconst element = state.collection[messageId];\n\t\t\tif (Utils.text.isTempMessage(element.id))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (element.id > lastId)\n\t\t\t{\n\t\t\t\tlastId = element.id;\n\t\t\t}\n\t\t}\n\n\t\treturn lastId;\n\t}\n\n\t#findLastOwnMessageId(state: MessagesState, chatId: number): number\n\t{\n\t\tlet lastOwnMessageId = 0;\n\t\tconst messages = [...state.chatCollection[chatId]].sort((a, z) => z - a);\n\t\tfor (const messageId of messages)\n\t\t{\n\t\t\tconst element = state.collection[messageId];\n\t\t\tif (Utils.text.isTempMessage(element.id))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (element.authorId === Core.getUserId())\n\t\t\t{\n\t\t\t\tlastOwnMessageId = element.id;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\treturn lastOwnMessageId;\n\t}\n\n\t#findFirstUnread(state: MessagesState, chatId: number): number\n\t{\n\t\tlet resultId = 0;\n\t\tfor (const messageId of state.chatCollection[chatId])\n\t\t{\n\t\t\tconst message: ImModelMessage = state.collection[messageId];\n\t\t\tif (message.unread)\n\t\t\t{\n\t\t\t\tresultId = messageId;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\treturn resultId;\n\t}\n}","import {Text, Type} from 'main.core';\nimport {BuilderModel} from 'ui.vue3.vuex';\n\nimport {Core} from 'im.v2.application.core';\nimport {ChatOption, Color, DialogType} from 'im.v2.const';\nimport {Utils} from 'im.v2.lib.utils';\n\nimport type {Dialog as ImModelDialog} from './type/dialog';\n\nconst WRITING_STATUS_TIME = 35000;\n\ntype DialogState = {\n\tcollection: {[dialogId: string]: ImModelDialog},\n\twritingStatusTimers: {[timerId: string]: number},\n\tchatOptions: {[chatType: string]: {[option: string]: boolean}}\n};\n\nexport class DialoguesModel extends BuilderModel\n{\n\tgetName()\n\t{\n\t\treturn 'dialogues';\n\t}\n\n\tgetState()\n\t{\n\t\treturn {\n\t\t\tcollection: {},\n\t\t\twritingStatusTimers: {},\n\t\t\tchatOptions: {}\n\t\t};\n\t}\n\n\tgetElementState()\n\t{\n\t\treturn {\n\t\t\tdialogId: '0',\n\t\t\tchatId: 0,\n\t\t\ttype: DialogType.chat,\n\t\t\tname: '',\n\t\t\tdescription: '',\n\t\t\tavatar: '',\n\t\t\tcolor: Color.base,\n\t\t\textranet: false,\n\t\t\tcounter: 0,\n\t\t\tuserCounter: 0,\n\t\t\tlastReadId: 0,\n\t\t\tmarkedId: 0,\n\t\t\tlastMessageId: 0,\n\t\t\tlastMessageViews: {\n\t\t\t\tcountOfViewers: 0,\n\t\t\t\tfirstViewer: null,\n\t\t\t\tmessageId: 0\n\t\t\t},\n\t\t\tsavedPositionMessageId: 0,\n\t\t\tmanagerList: [],\n\t\t\twritingList: [],\n\t\t\tmuteList: [],\n\t\t\ttextareaMessage: '',\n\t\t\tquoteId: 0,\n\t\t\towner: 0,\n\t\t\tentityType: '',\n\t\t\tentityId: '',\n\t\t\tdateCreate: null,\n\t\t\tpublic: {\n\t\t\t\tcode: '',\n\t\t\t\tlink: ''\n\t\t\t},\n\t\t\tinited: false,\n\t\t\tloading: false,\n\t\t\thasPrevPage: false,\n\t\t\thasNextPage: false,\n\t\t\tdiskFolderId: 0,\n\t\t};\n\t}\n\n\tgetGetters()\n\t{\n\t\treturn {\n\t\t\tget: (state: DialogState) => (dialogId: string, getBlank: boolean = false) =>\n\t\t\t{\n\t\t\t\tif (!state.collection[dialogId] && getBlank)\n\t\t\t\t{\n\t\t\t\t\treturn this.getElementState();\n\t\t\t\t}\n\t\t\t\telse if (!state.collection[dialogId] && !getBlank)\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[dialogId];\n\t\t\t},\n\t\t\tgetByChatId: (state: DialogState) => (chatId: number | string) =>\n\t\t\t{\n\t\t\t\tchatId = Number.parseInt(chatId, 10);\n\t\t\t\treturn Object.values(state.collection).find(item => {\n\t\t\t\t\treturn item.chatId === chatId;\n\t\t\t\t});\n\t\t\t},\n\t\t\tgetBlank: () =>\n\t\t\t{\n\t\t\t\treturn this.getElementState();\n\t\t\t},\n\t\t\tgetChatOption: (state: DialogState) => (chatType: string, option: string) =>\n\t\t\t{\n\t\t\t\tif (!state.chatOptions[chatType])\n\t\t\t\t{\n\t\t\t\t\tchatType = 'default';\n\t\t\t\t}\n\n\t\t\t\treturn state.chatOptions[chatType][option];\n\t\t\t},\n\t\t\tgetQuoteId: (state: DialogState) => (dialogId: string) =>\n\t\t\t{\n\t\t\t\tif (!state.collection[dialogId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[dialogId].quoteId;\n\t\t\t},\n\t\t\tisUser: (state: DialogState) => (dialogId: string) =>\n\t\t\t{\n\t\t\t\tif (!state.collection[dialogId])\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[dialogId].type === DialogType.user;\n\t\t\t},\n\t\t\tcanLeave: (state: DialogState) => (dialogId: string) =>\n\t\t\t{\n\t\t\t\tif (!state.collection[dialogId])\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst dialog = state.collection[dialogId];\n\n\t\t\t\tconst isExternalTelephonyCall = dialog.type === DialogType.call;\n\t\t\t\tconst isUser = dialog.type === DialogType.user;\n\t\t\t\tif (isExternalTelephonyCall || isUser)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst currentUserId = Core.getUserId();\n\t\t\t\tconst optionToCheck = dialog.owner === currentUserId ? ChatOption.leaveOwner : ChatOption.leave;\n\n\t\t\t\treturn this.store.getters['dialogues/getChatOption'](dialog.type, optionToCheck);\n\t\t\t},\n\t\t\tcanMute: (state: DialogState) => (dialogId: string) =>\n\t\t\t{\n\t\t\t\tif (!state.collection[dialogId])\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst dialog = state.collection[dialogId];\n\n\t\t\t\tconst isUser = dialog.type === DialogType.user;\n\t\t\t\tconst isAnnouncement = dialog.type === DialogType.announcement;\n\t\t\t\tif (isUser || isAnnouncement)\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\treturn this.store.getters['dialogues/getChatOption'](dialog.type, ChatOption.mute);\n\t\t\t},\n\t\t\tgetLastReadId: (state: DialogState) => (dialogId: string): number =>\n\t\t\t{\n\t\t\t\tif (!state.collection[dialogId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\tconst {lastReadId, lastMessageId} = state.collection[dialogId];\n\n\t\t\t\treturn lastReadId === lastMessageId ? 0 : lastReadId;\n\t\t\t},\n\t\t\tgetInitialMessageId: (state: DialogState) => (dialogId: string): number =>\n\t\t\t{\n\t\t\t\tif (!state.collection[dialogId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\tconst {lastReadId, markedId} = state.collection[dialogId];\n\t\t\t\tif (markedId === 0)\n\t\t\t\t{\n\t\t\t\t\treturn lastReadId;\n\t\t\t\t}\n\n\t\t\t\treturn Math.min(lastReadId, markedId);\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions()\n\t{\n\t\treturn {\n\t\t\tset: (store, payload: Array | Object) =>\n\t\t\t{\n\t\t\t\tif (!Array.isArray(payload) && Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\tpayload = [payload];\n\t\t\t\t}\n\n\t\t\t\tpayload.map(element => {\n\t\t\t\t\treturn this.validate(element);\n\t\t\t\t}).forEach(element => {\n\t\t\t\t\tconst existingItem = store.state.collection[element.dialogId];\n\t\t\t\t\tif (existingItem)\n\t\t\t\t\t{\n\t\t\t\t\t\tstore.commit('update', {\n\t\t\t\t\t\t\tdialogId: element.dialogId,\n\t\t\t\t\t\t\tfields: element\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tstore.commit('add', {\n\t\t\t\t\t\t\tdialogId: element.dialogId,\n\t\t\t\t\t\t\tfields: {...this.getElementState(), ...element}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tadd: (store, payload: Array | Object) =>\n\t\t\t{\n\t\t\t\tif (!Array.isArray(payload) && Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\tpayload = [payload];\n\t\t\t\t}\n\n\t\t\t\tpayload.map(element => {\n\t\t\t\t\treturn this.validate(element);\n\t\t\t\t}).forEach(element => {\n\t\t\t\t\tconst existingItem = store.state.collection[element.dialogId];\n\t\t\t\t\tif (!existingItem)\n\t\t\t\t\t{\n\t\t\t\t\t\tstore.commit('add', {\n\t\t\t\t\t\t\tdialogId: element.dialogId,\n\t\t\t\t\t\t\tfields: {...this.getElementState(), ...element}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tupdate: (store, payload: {dialogId: string, fields: Object}) =>\n\t\t\t{\n\t\t\t\tconst existingItem = store.state.collection[payload.dialogId];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tdialogId: payload.dialogId,\n\t\t\t\t\tfields: this.validate(payload.fields)\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tdelete: (store, payload: {dialogId: string}) =>\n\t\t\t{\n\t\t\t\tconst existingItem = store.state.collection[payload.dialogId];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('delete', {dialogId: payload.dialogId});\n\t\t\t},\n\n\t\t\tstartWriting: (store, payload: {dialogId: string, userId: number, userName: string}) =>\n\t\t\t{\n\t\t\t\tconst existingItem = store.state.collection[payload.dialogId];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst timerId = `${payload.dialogId}|${payload.userId}`;\n\t\t\t\tconst alreadyWriting = existingItem.writingList.some(el => el.userId === payload.userId);\n\t\t\t\tif (alreadyWriting)\n\t\t\t\t{\n\t\t\t\t\tclearTimeout(store.state.writingStatusTimers[timerId]);\n\t\t\t\t\tstore.state.writingStatusTimers[timerId] = this.setWritingStatusTimeout(payload);\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\tconst newItem = {userId: payload.userId, userName: payload.userName};\n\t\t\t\tconst newWritingList = [newItem, ...existingItem.writingList];\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tactionName: 'startWriting',\n\t\t\t\t\tdialogId: payload.dialogId,\n\t\t\t\t\tfields: this.validate({writingList: newWritingList})\n\t\t\t\t});\n\n\t\t\t\tif (!store.state.writingStatusTimers[timerId])\n\t\t\t\t{\n\t\t\t\t\tstore.state.writingStatusTimers[timerId] = this.setWritingStatusTimeout(payload);\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tstopWriting: (store, payload: {dialogId: string, userId: number}) =>\n\t\t\t{\n\t\t\t\tconst existingItem = store.state.collection[payload.dialogId];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst alreadyWriting = existingItem.writingList.find(el => el.userId === payload.userId);\n\t\t\t\tif (!alreadyWriting)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst newWritingList = existingItem.writingList.filter(item => item.userId !== payload.userId);\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tactionName: 'stopWriting',\n\t\t\t\t\tdialogId: payload.dialogId,\n\t\t\t\t\tfields: this.validate({writingList: newWritingList})\n\t\t\t\t});\n\n\t\t\t\tconst timerId = `${payload.dialogId}|${payload.userId}`;\n\t\t\t\tclearTimeout(store.state.writingStatusTimers[timerId]);\n\t\t\t\tdelete store.state.writingStatusTimers[timerId];\n\t\t\t},\n\n\t\t\tincreaseCounter: (store, payload: {dialogId: string, count: number}) =>\n\t\t\t{\n\t\t\t\tconst existingItem = store.state.collection[payload.dialogId];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tif (existingItem.counter === 100)\n\t\t\t\t{\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\tlet increasedCounter = existingItem.counter + payload.count;\n\t\t\t\tif (increasedCounter > 100)\n\t\t\t\t{\n\t\t\t\t\tincreasedCounter = 100;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tactionName: 'increaseCounter',\n\t\t\t\t\tdialogId: payload.dialogId,\n\t\t\t\t\tfields: {\n\t\t\t\t\t\tcounter: increasedCounter,\n\t\t\t\t\t\tpreviousCounter: existingItem.counter\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tdecreaseCounter: (store, payload: {dialogId: string, count: number}) =>\n\t\t\t{\n\t\t\t\tconst existingItem = store.state.collection[payload.dialogId];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tif (existingItem.counter === 100)\n\t\t\t\t{\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\tlet decreasedCounter = existingItem.counter - payload.count;\n\t\t\t\tif (decreasedCounter < 0)\n\t\t\t\t{\n\t\t\t\t\tdecreasedCounter = 0;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tactionName: 'decreaseCounter',\n\t\t\t\t\tdialogId: payload.dialogId,\n\t\t\t\t\tfields: {\n\t\t\t\t\t\tcounter: decreasedCounter,\n\t\t\t\t\t\tpreviousCounter: existingItem.counter\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tclearCounters: (store) =>\n\t\t\t{\n\t\t\t\tstore.commit('clearCounters');\n\t\t\t},\n\n\t\t\tmute: (store, payload: {dialogId: string}) =>\n\t\t\t{\n\t\t\t\tconst existingItem = store.state.collection[payload.dialogId];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst currentUserId = Core.getUserId();\n\t\t\t\tif (existingItem.muteList.includes(currentUserId))\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tconst muteList = [...existingItem.muteList, currentUserId];\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tactionName: 'mute',\n\t\t\t\t\tdialogId: payload.dialogId,\n\t\t\t\t\tfields: this.validate({muteList})\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tunmute: (store, payload: {dialogId: string}) =>\n\t\t\t{\n\t\t\t\tconst existingItem = store.state.collection[payload.dialogId];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst currentUserId = Core.getUserId();\n\t\t\t\tconst muteList = existingItem.muteList.filter(item => item !== currentUserId);\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tactionName: 'unmute',\n\t\t\t\t\tdialogId: payload.dialogId,\n\t\t\t\t\tfields: this.validate({muteList})\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tsetChatOptions: (store, payload: Object) =>\n\t\t\t{\n\t\t\t\tstore.commit('setChatOptions', this.validateChatOptions(payload));\n\t\t\t},\n\n\t\t\tsetLastMessageViews: (store, payload: {\n\t\t\t\tdialogId: string,\n\t\t\t\tfields: {userId: number, userName: string, date: string, messageId: number}\n\t\t\t}) =>\n\t\t\t{\n\t\t\t\tconst {dialogId, fields: {userId, userName, date, messageId}} = payload;\n\t\t\t\tconst existingItem: ImModelDialog = store.state.collection[dialogId];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst newLastMessageViews = {\n\t\t\t\t\tcountOfViewers: 1,\n\t\t\t\t\tmessageId,\n\t\t\t\t\tfirstViewer: {\n\t\t\t\t\t\tuserId,\n\t\t\t\t\t\tuserName,\n\t\t\t\t\t\tdate: Utils.date.cast(date)\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tactionName: 'setLastMessageViews',\n\t\t\t\t\tdialogId: dialogId,\n\t\t\t\t\tfields: {\n\t\t\t\t\t\tlastMessageViews: newLastMessageViews\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tclearLastMessageViews: (store, payload: {dialogId: string}) =>\n\t\t\t{\n\t\t\t\tconst existingItem = store.state.collection[payload.dialogId];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst {lastMessageViews: defaultLastMessageViews} = this.getElementState();\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tactionName: 'clearLastMessageViews',\n\t\t\t\t\tdialogId: payload.dialogId,\n\t\t\t\t\tfields: {\n\t\t\t\t\t\tlastMessageViews: defaultLastMessageViews\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tincrementLastMessageViews: (store, payload: {dialogId: string}) =>\n\t\t\t{\n\t\t\t\tconst existingItem: ImModelDialog = store.state.collection[payload.dialogId];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst newCounter = existingItem.lastMessageViews.countOfViewers + 1;\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tactionName: 'incrementLastMessageViews',\n\t\t\t\t\tdialogId: payload.dialogId,\n\t\t\t\t\tfields: {\n\t\t\t\t\t\tlastMessageViews: {...existingItem.lastMessageViews, countOfViewers: newCounter}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\t}\n\n\tgetMutations()\n\t{\n\t\treturn {\n\t\t\tadd: (state: DialogState, payload) =>\n\t\t\t{\n\t\t\t\tstate.collection[payload.dialogId] = payload.fields;\n\t\t\t},\n\t\t\tupdate: (state: DialogState, payload) =>\n\t\t\t{\n\t\t\t\tstate.collection[payload.dialogId] = {...state.collection[payload.dialogId], ...payload.fields};\n\t\t\t},\n\t\t\tdelete: (state: DialogState, payload) =>\n\t\t\t{\n\t\t\t\tdelete state.collection[payload.dialogId];\n\t\t\t},\n\t\t\tsetChatOptions: (state: DialogState, payload) =>\n\t\t\t{\n\t\t\t\tstate.chatOptions = payload;\n\t\t\t},\n\t\t\tclearCounters: (state: DialogState) =>\n\t\t\t{\n\t\t\t\tObject.keys(state.collection).forEach(key => {\n\t\t\t\t\tstate.collection[key].counter = 0;\n\t\t\t\t\tstate.collection[key].markedId = 0;\n\t\t\t\t});\n\t\t\t},\n\t\t};\n\t}\n\n\tsetWritingStatusTimeout(payload: {dialogId: string, userId: number})\n\t{\n\t\treturn setTimeout(() => {\n\t\t\tthis.store.dispatch('dialogues/stopWriting', {\n\t\t\t\tdialogId: payload.dialogId,\n\t\t\t\tuserId: payload.userId\n\t\t\t});\n\t\t}, WRITING_STATUS_TIME);\n\t}\n\n\tvalidate(fields)\n\t{\n\t\tconst result = {};\n\n\t\tif (!Type.isUndefined(fields.dialog_id))\n\t\t{\n\t\t\tfields.dialogId = fields.dialog_id;\n\t\t}\n\t\tif (Type.isNumber(fields.dialogId) || Type.isStringFilled(fields.dialogId))\n\t\t{\n\t\t\tresult.dialogId = fields.dialogId.toString();\n\t\t}\n\n\t\tif (!Type.isUndefined(fields.chat_id))\n\t\t{\n\t\t\tfields.chatId = fields.chat_id;\n\t\t}\n\t\telse if (!Type.isUndefined(fields.id))\n\t\t{\n\t\t\tfields.chatId = fields.id;\n\t\t}\n\t\tif (Type.isNumber(fields.chatId) || Type.isStringFilled(fields.chatId))\n\t\t{\n\t\t\tresult.chatId = Number.parseInt(fields.chatId, 10);\n\t\t}\n\n\t\tif (Type.isStringFilled(fields.type))\n\t\t{\n\t\t\tresult.type = fields.type.toString();\n\t\t}\n\n\t\tif (Type.isNumber(fields.quoteId))\n\t\t{\n\t\t\tresult.quoteId = Number.parseInt(fields.quoteId, 10);\n\t\t}\n\n\t\tif (Type.isNumber(fields.counter) || Type.isStringFilled(fields.counter))\n\t\t{\n\t\t\tresult.counter = Number.parseInt(fields.counter, 10);\n\t\t}\n\n\t\tif (!Type.isUndefined(fields.user_counter))\n\t\t{\n\t\t\tresult.userCounter = fields.user_counter;\n\t\t}\n\t\tif (Type.isNumber(fields.userCounter) || Type.isStringFilled(fields.userCounter))\n\t\t{\n\t\t\tresult.userCounter = Number.parseInt(fields.userCounter, 10);\n\t\t}\n\n\t\tif (!Type.isUndefined(fields.last_id))\n\t\t{\n\t\t\tfields.lastId = fields.last_id;\n\t\t}\n\t\tif (Type.isNumber(fields.lastId))\n\t\t{\n\t\t\tresult.lastReadId = fields.lastId;\n\t\t}\n\n\t\tif (!Type.isUndefined(fields.marked_id))\n\t\t{\n\t\t\tfields.markedId = fields.marked_id;\n\t\t}\n\t\tif (Type.isNumber(fields.markedId))\n\t\t{\n\t\t\tresult.markedId = fields.markedId;\n\t\t}\n\n\t\tif (!Type.isUndefined(fields.last_message_id))\n\t\t{\n\t\t\tfields.lastMessageId = fields.last_message_id;\n\t\t}\n\t\tif (Type.isNumber(fields.lastMessageId) || Type.isStringFilled(fields.lastMessageId))\n\t\t{\n\t\t\tresult.lastMessageId = Number.parseInt(fields.lastMessageId, 10);\n\t\t}\n\n\t\tif (Type.isPlainObject(fields.last_message_views))\n\t\t{\n\t\t\tfields.lastMessageViews = fields.last_message_views;\n\t\t}\n\t\tif (Type.isPlainObject(fields.lastMessageViews))\n\t\t{\n\t\t\tresult.lastMessageViews = this.prepareLastMessageViews(fields.lastMessageViews);\n\t\t}\n\n\t\tif (Type.isBoolean(fields.hasPrevPage))\n\t\t{\n\t\t\tresult.hasPrevPage = fields.hasPrevPage;\n\t\t}\n\n\t\tif (Type.isBoolean(fields.hasNextPage))\n\t\t{\n\t\t\tresult.hasNextPage = fields.hasNextPage;\n\t\t}\n\n\t\tif (Type.isNumber(fields.savedPositionMessageId))\n\t\t{\n\t\t\tresult.savedPositionMessageId = fields.savedPositionMessageId;\n\t\t}\n\n\t\tif (!Type.isUndefined(fields.textareaMessage))\n\t\t{\n\t\t\tresult.textareaMessage = fields.textareaMessage.toString();\n\t\t}\n\n\t\tif (!Type.isUndefined(fields.title))\n\t\t{\n\t\t\tfields.name = fields.title;\n\t\t}\n\t\tif (Type.isNumber(fields.name) || Type.isStringFilled(fields.name))\n\t\t{\n\t\t\tresult.name = Text.decode(fields.name.toString());\n\t\t}\n\n\t\tif (!Type.isUndefined(fields.owner))\n\t\t{\n\t\t\tfields.ownerId = fields.owner;\n\t\t}\n\t\tif (Type.isNumber(fields.ownerId) || Type.isStringFilled(fields.ownerId))\n\t\t{\n\t\t\tresult.owner = Number.parseInt(fields.ownerId, 10);\n\t\t}\n\n\t\tif (Type.isString(fields.avatar))\n\t\t{\n\t\t\tresult.avatar = this.prepareAvatar(fields.avatar);\n\t\t}\n\n\t\tif (Type.isStringFilled(fields.color))\n\t\t{\n\t\t\tresult.color = fields.color;\n\t\t}\n\n\t\tif (Type.isBoolean(fields.extranet))\n\t\t{\n\t\t\tresult.extranet = fields.extranet;\n\t\t}\n\n\t\tif (!Type.isUndefined(fields.entity_type))\n\t\t{\n\t\t\tfields.entityType = fields.entity_type;\n\t\t}\n\t\tif (Type.isStringFilled(fields.entityType))\n\t\t{\n\t\t\tresult.entityType = fields.entityType;\n\t\t}\n\t\tif (!Type.isUndefined(fields.entity_id))\n\t\t{\n\t\t\tfields.entityId = fields.entity_id;\n\t\t}\n\t\tif (Type.isNumber(fields.entityId) || Type.isStringFilled(fields.entityId))\n\t\t{\n\t\t\tresult.entityId = fields.entityId.toString();\n\t\t}\n\n\t\tif (!Type.isUndefined(fields.date_create))\n\t\t{\n\t\t\tfields.dateCreate = fields.date_create;\n\t\t}\n\t\tif (!Type.isUndefined(fields.dateCreate))\n\t\t{\n\t\t\tresult.dateCreate = Utils.date.cast(fields.dateCreate);\n\t\t}\n\n\t\tif (Type.isPlainObject(fields.public))\n\t\t{\n\t\t\tresult.public = {};\n\n\t\t\tif (Type.isStringFilled(fields.public.code))\n\t\t\t{\n\t\t\t\tresult.public.code = fields.public.code;\n\t\t\t}\n\n\t\t\tif (Type.isStringFilled(fields.public.link))\n\t\t\t{\n\t\t\t\tresult.public.link = fields.public.link;\n\t\t\t}\n\t\t}\n\n\t\tif (!Type.isUndefined(fields.writing_list))\n\t\t{\n\t\t\tfields.writingList = fields.writing_list;\n\t\t}\n\t\tif (Type.isArray(fields.writingList))\n\t\t{\n\t\t\tresult.writingList = this.prepareWritingList(fields.writingList);\n\t\t}\n\n\t\tif (!Type.isUndefined(fields.manager_list))\n\t\t{\n\t\t\tfields.managerList = fields.manager_list;\n\t\t}\n\t\tif (Type.isArray(fields.managerList))\n\t\t{\n\t\t\tresult.managerList = [];\n\n\t\t\tfields.managerList.forEach(userId =>\n\t\t\t{\n\t\t\t\tuserId = Number.parseInt(userId, 10);\n\t\t\t\tif (userId > 0)\n\t\t\t\t{\n\t\t\t\t\tresult.managerList.push(userId);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tif (!Type.isUndefined(fields.mute_list))\n\t\t{\n\t\t\tfields.muteList = fields.mute_list;\n\t\t}\n\t\tif (Type.isArray(fields.muteList) || Type.isPlainObject(fields.muteList))\n\t\t{\n\t\t\tresult.muteList = this.prepareMuteList(fields.muteList);\n\t\t}\n\n\t\tif (Type.isBoolean(fields.inited))\n\t\t{\n\t\t\tresult.inited = fields.inited;\n\t\t}\n\n\t\tif (Type.isBoolean(fields.loading))\n\t\t{\n\t\t\tresult.loading = fields.loading;\n\t\t}\n\n\t\tif (Type.isString(fields.description))\n\t\t{\n\t\t\tresult.description = fields.description;\n\t\t}\n\n\t\tif (Type.isNumber(fields.disk_folder_id))\n\t\t{\n\t\t\tresult.diskFolderId = fields.disk_folder_id;\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tprepareAvatar(avatar: string): string\n\t{\n\t\tlet result = '';\n\n\t\tif (!avatar || avatar.endsWith('/js/im/images/blank.gif'))\n\t\t{\n\t\t\tresult = '';\n\t\t}\n\t\telse if (avatar.startsWith('http'))\n\t\t{\n\t\t\tresult = avatar;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tresult = Core.getHost() + avatar;\n\t\t}\n\n\t\tif (result)\n\t\t{\n\t\t\tresult = encodeURI(result);\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tprepareWritingList(writingList: Object[]): Array<{userId: number, userName: string}>\n\t{\n\t\tconst result = [];\n\n\t\twritingList.forEach(element =>\n\t\t{\n\t\t\tconst item = {};\n\n\t\t\tif (!element.userId)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\titem.userId = Number.parseInt(element.userId, 10);\n\t\t\titem.userName = Utils.text.htmlspecialcharsback(element.userName);\n\n\t\t\tresult.push(item);\n\t\t});\n\n\t\treturn result;\n\t}\n\n\tprepareMuteList(muteList: Object[] | Object): Object[]\n\t{\n\t\tconst result = [];\n\n\t\tif (Type.isArray(muteList))\n\t\t{\n\t\t\tmuteList.forEach(userId =>\n\t\t\t{\n\t\t\t\tuserId = Number.parseInt(userId, 10);\n\t\t\t\tif (userId > 0)\n\t\t\t\t{\n\t\t\t\t\tresult.push(userId);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\telse if (Type.isPlainObject(muteList))\n\t\t{\n\t\t\tObject.entries(muteList).forEach(([key, value]) => {\n\t\t\t\tif (!value)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tconst userId = Number.parseInt(key, 10);\n\t\t\t\tif (userId > 0)\n\t\t\t\t{\n\t\t\t\t\tresult.push(userId);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tprepareLastMessageViews(rawLastMessageViews): {countOfViewers: number, firstViewers: Object[], messageId: number}\n\t{\n\t\tconst {\n\t\t\tcountOfViewers,\n\t\t\tfirstViewers: rawFirstViewers,\n\t\t\tmessageId,\n\t\t} = rawLastMessageViews;\n\n\t\tlet firstViewer;\n\t\tfor (const rawFirstViewer of rawFirstViewers)\n\t\t{\n\t\t\tif (rawFirstViewer.userId === Core.getUserId())\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tfirstViewer = {\n\t\t\t\tuserId: rawFirstViewer.userId,\n\t\t\t\tuserName: rawFirstViewer.userName,\n\t\t\t\tdate: Utils.date.cast(rawFirstViewer.date),\n\t\t\t};\n\t\t\tbreak;\n\t\t}\n\n\t\tif (countOfViewers > 0 && !firstViewer)\n\t\t{\n\t\t\tthrow new Error('Dialogues model: no first viewer for message');\n\t\t}\n\n\t\treturn {\n\t\t\tcountOfViewers,\n\t\t\tfirstViewer,\n\t\t\tmessageId,\n\t\t};\n\t}\n\n\tvalidateChatOptions(options: Object): Object\n\t{\n\t\tconst result = {};\n\n\t\tObject.entries(options).forEach(([type, typeOptions]) => {\n\t\t\tconst newType = Utils.text.convertSnakeToCamelCase(type.toLowerCase());\n\t\t\tresult[newType] = {};\n\t\t\tObject.entries(typeOptions).forEach(([key, value]) => {\n\t\t\t\tconst newKey = Utils.text.convertSnakeToCamelCase(key.toLowerCase());\n\t\t\t\tresult[newType][newKey] = value;\n\t\t\t});\n\t\t});\n\n\t\treturn result;\n\t}\n}","import {Type, Loc} from 'main.core';\nimport {BuilderModel} from 'ui.vue3.vuex';\n\nimport {Core} from 'im.v2.application.core';\nimport {Utils} from 'im.v2.lib.utils';\nimport {UserStatus, BotType, Color} from 'im.v2.const';\n\nimport type {User as ImModelUser} from './type/user';\n\nexport class UsersModel extends BuilderModel\n{\n\tgetName()\n\t{\n\t\treturn 'users';\n\t}\n\n\tgetState()\n\t{\n\t\treturn {\n\t\t\tcollection: {},\n\t\t\tonlineList: [],\n\t\t\tmobileOnlineList: [],\n\t\t\tabsentList: [],\n\t\t\tbotList: {}\n\t\t};\n\t}\n\n\tgetElementState(params = {})\n\t{\n\t\tconst {id = 0} = params;\n\n\t\treturn {\n\t\t\tid,\n\t\t\tname: '',\n\t\t\tfirstName: '',\n\t\t\tlastName: '',\n\t\t\tavatar: '',\n\t\t\tcolor: Color.base,\n\t\t\tworkPosition: '',\n\t\t\tgender: 'M',\n\t\t\tisAdmin: false,\n\t\t\textranet: false,\n\t\t\tnetwork: false,\n\t\t\tbot: false,\n\t\t\tconnector: false,\n\t\t\texternalAuthId: 'default',\n\t\t\tstatus: '',\n\t\t\tidle: false,\n\t\t\tlastActivityDate: false,\n\t\t\tmobileLastDate: false,\n\t\t\tisOnline: false,\n\t\t\tisMobileOnline: false,\n\t\t\tbirthday: false,\n\t\t\tisBirthday: false,\n\t\t\tabsent: false,\n\t\t\tisAbsent: false,\n\t\t\tdepartments: [],\n\t\t\tphones: {\n\t\t\t\tworkPhone: '',\n\t\t\t\tpersonalMobile: '',\n\t\t\t\tpersonalPhone: '',\n\t\t\t\tinnerPhone: '',\n\t\t\t}\n\t\t};\n\t}\n\n\tgetGetters()\n\t{\n\t\treturn {\n\t\t\t/** @function users/get */\n\t\t\tget: state => (userId, getTemporary = false) =>\n\t\t\t{\n\t\t\t\tuserId = Number.parseInt(userId, 10);\n\n\t\t\t\tif (userId <= 0)\n\t\t\t\t{\n\t\t\t\t\tif (getTemporary)\n\t\t\t\t\t{\n\t\t\t\t\t\tuserId = 0;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\treturn null;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tconst user = state.collection[userId];\n\n\t\t\t\tif (!getTemporary && !user)\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t\telse if (getTemporary && !user)\n\t\t\t\t{\n\t\t\t\t\treturn this.getElementState({id: userId});\n\t\t\t\t}\n\n\t\t\t\treturn user;\n\t\t\t},\n\t\t\t/** @function users/getBlank */\n\t\t\tgetBlank: () => params =>\n\t\t\t{\n\t\t\t\treturn this.getElementState(params);\n\t\t\t},\n\t\t\t/** @function users/getList */\n\t\t\tgetList: state => (userList) => {\n\t\t\t\tconst result = [];\n\n\t\t\t\tif (!Array.isArray(userList))\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\tuserList.forEach(id => {\n\t\t\t\t\tif (state.collection[id])\n\t\t\t\t\t{\n\t\t\t\t\t\tresult.push(state.collection[id]);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tresult.push(this.getElementState({id}));\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\treturn result;\n\t\t\t},\n\t\t\t/** @function users/hasBirthday */\n\t\t\thasBirthday: state => userId => {\n\t\t\t\tuserId = Number.parseInt(userId, 10);\n\n\t\t\t\tconst user = state.collection[userId];\n\t\t\t\tif (userId <= 0 || !user)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn user.isBirthday;\n\t\t\t},\n\t\t\t/** @function users/hasVacation */\n\t\t\thasVacation: state => userId => {\n\t\t\t\tuserId = Number.parseInt(userId, 10);\n\n\t\t\t\tconst user = state.collection[userId];\n\t\t\t\tif (userId <= 0 || !user)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn user.isAbsent;\n\t\t\t},\n\t\t\t/** @function users/getStatus */\n\t\t\tgetStatus: state => userId => {\n\t\t\t\tuserId = Number.parseInt(userId, 10);\n\n\t\t\t\tconst user = state.collection[userId];\n\t\t\t\tif (userId <= 0 || !user)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tif (!user.isOnline)\n\t\t\t\t{\n\t\t\t\t\treturn '';\n\t\t\t\t}\n\n\t\t\t\tif (user.isMobileOnline)\n\t\t\t\t{\n\t\t\t\t\treturn UserStatus.mobileOnline;\n\t\t\t\t}\n\t\t\t\telse if (user.idle)\n\t\t\t\t{\n\t\t\t\t\t// away by time\n\t\t\t\t\treturn UserStatus.idle;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\t// manually selected status (online, away, dnd, break)\n\t\t\t\t\treturn user.status;\n\t\t\t\t}\n\t\t\t},\n\t\t\t/** @function users/getLastOnline */\n\t\t\tgetLastOnline: state => userId => {\n\t\t\t\tuserId = Number.parseInt(userId, 10);\n\n\t\t\t\tconst user = state.collection[userId];\n\t\t\t\tif (userId <= 0 || !user)\n\t\t\t\t{\n\t\t\t\t\treturn '';\n\t\t\t\t}\n\n\t\t\t\treturn Utils.user.getLastDateText(user);\n\t\t\t},\n\t\t\t/** @function users/getPosition */\n\t\t\tgetPosition: state => userId => {\n\t\t\t\tuserId = Number.parseInt(userId, 10);\n\n\t\t\t\tconst user = state.collection[userId];\n\t\t\t\tif (userId <= 0 || !user)\n\t\t\t\t{\n\t\t\t\t\treturn '';\n\t\t\t\t}\n\n\t\t\t\tif (user.workPosition)\n\t\t\t\t{\n\t\t\t\t\treturn user.workPosition;\n\t\t\t\t}\n\n\t\t\t\treturn Loc.getMessage('IM_MODEL_USERS_DEFAULT_NAME');\n\t\t\t},\n\t\t\t/** @function users/getBotType */\n\t\t\tgetBotType: state => userId => {\n\t\t\t\tuserId = Number.parseInt(userId, 10);\n\n\t\t\t\tconst user = state.collection[userId];\n\t\t\t\tif (userId <= 0 || !user || !user.bot || !state.botList[userId])\n\t\t\t\t{\n\t\t\t\t\treturn '';\n\t\t\t\t}\n\n\t\t\t\tconst botType = state.botList[userId].type;\n\n\t\t\t\tif (!BotType[botType])\n\t\t\t\t{\n\t\t\t\t\treturn BotType.bot;\n\t\t\t\t}\n\n\t\t\t\treturn botType;\n\t\t\t}\n\t\t};\n\t}\n\n\tgetActions()\n\t{\n\t\treturn {\n\t\t\t/** @function users/set */\n\t\t\tset: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (!Array.isArray(payload) && Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\tpayload = [payload];\n\t\t\t\t}\n\n\t\t\t\tpayload.map(user => {\n\t\t\t\t\treturn this.validate(user);\n\t\t\t\t}).forEach(user => {\n\t\t\t\t\tconst existingUser = store.state.collection[user.id];\n\t\t\t\t\tif (existingUser)\n\t\t\t\t\t{\n\t\t\t\t\t\tstore.commit('update', {\n\t\t\t\t\t\t\tid: user.id,\n\t\t\t\t\t\t\tfields: user\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tstore.commit('add', {\n\t\t\t\t\t\t\tid: user.id,\n\t\t\t\t\t\t\tfields: {...this.getElementState(), ...user}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function users/add */\n\t\t\tadd: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (!Array.isArray(payload) && Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\tpayload = [payload];\n\t\t\t\t}\n\n\t\t\t\tpayload.map(user => {\n\t\t\t\t\treturn this.validate(user);\n\t\t\t\t}).forEach(user => {\n\t\t\t\t\tconst existingUser = store.state.collection[user.id];\n\t\t\t\t\tif (!existingUser)\n\t\t\t\t\t{\n\t\t\t\t\t\tstore.commit('add', {\n\t\t\t\t\t\t\tid: user.id,\n\t\t\t\t\t\t\tfields: {...this.getElementState(), ...user}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function users/update */\n\t\t\tupdate: (store, payload) =>\n\t\t\t{\n\t\t\t\tpayload.id = Number.parseInt(payload.id, 10);\n\n\t\t\t\tconst user = store.state.collection[payload.id];\n\t\t\t\tif (!user)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tid: payload.id,\n\t\t\t\t\tfields: this.validate(payload.fields)\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function users/delete */\n\t\t\tdelete: (store, payload) =>\n\t\t\t{\n\t\t\t\tstore.commit('delete', payload.id);\n\t\t\t},\n\t\t\t/** @function users/setBotList */\n\t\t\tsetBotList: (store, payload) =>\n\t\t\t{\n\t\t\t\tstore.commit('setBotList', payload);\n\t\t\t},\n\t\t\t/** @function users/setStatus */\n\t\t\tsetStatus: (store, payload: {status: string}) =>\n\t\t\t{\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tid: Core.getUserId(),\n\t\t\t\t\tfields: this.validate(payload)\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\t}\n\n\tgetMutations()\n\t{\n\t\treturn {\n\t\t\tadd: (state, payload) => {\n\t\t\t\t// eslint-disable-next-line no-param-reassign\n\t\t\t\tstate.collection[payload.id] = payload.fields;\n\n\t\t\t\tthis.handleUserStatusFlags(state, payload.fields);\n\n\t\t\t\tthis.startOnlineCheckInterval();\n\t\t\t\tthis.startAbsentCheckInterval();\n\t\t\t},\n\t\t\tupdate: (state, payload) => {\n\t\t\t\t// eslint-disable-next-line no-param-reassign\n\t\t\t\tstate.collection[payload.id] = { ...state.collection[payload.id], ...payload.fields };\n\n\t\t\t\tthis.handleUserStatusFlags(state, payload.fields);\n\t\t\t},\n\t\t\tdelete: (state, payload) => {\n\t\t\t\t// eslint-disable-next-line no-param-reassign\n\t\t\t\tdelete state.collection[payload.id];\n\t\t\t},\n\t\t\tsetBotList: (state, payload) => {\n\t\t\t\t// eslint-disable-next-line no-param-reassign\n\t\t\t\tstate.botList = payload;\n\t\t\t},\n\t\t};\n\t}\n\n\tvalidate(fields)\n\t{\n\t\tconst result = {};\n\n\t\tif (Type.isNumber(fields.id) || Type.isString(fields.id))\n\t\t{\n\t\t\tresult.id = Number.parseInt(fields.id, 10);\n\t\t}\n\n\t\tif (Type.isStringFilled(fields.first_name))\n\t\t{\n\t\t\tfields.firstName = fields.first_name;\n\t\t}\n\t\tif (Type.isStringFilled(fields.last_name))\n\t\t{\n\t\t\tfields.lastName = fields.last_name;\n\t\t}\n\t\tif (Type.isStringFilled(fields.firstName))\n\t\t{\n\t\t\tresult.firstName = Utils.text.htmlspecialcharsback(fields.firstName);\n\t\t}\n\t\tif (Type.isStringFilled(fields.lastName))\n\t\t{\n\t\t\tresult.lastName = Utils.text.htmlspecialcharsback(fields.lastName);\n\t\t}\n\t\tif (Type.isStringFilled(fields.name))\n\t\t{\n\t\t\tfields.name = Utils.text.htmlspecialcharsback(fields.name);\n\t\t\tresult.name = fields.name;\n\t\t}\n\n\t\tif (Type.isStringFilled(fields.color))\n\t\t{\n\t\t\tresult.color = fields.color;\n\t\t}\n\n\t\tif (Type.isStringFilled(fields.avatar))\n\t\t{\n\t\t\tresult.avatar = this.prepareAvatar(fields.avatar);\n\t\t}\n\n\t\tif (Type.isStringFilled(fields.work_position))\n\t\t{\n\t\t\tfields.workPosition = fields.work_position;\n\t\t}\n\t\tif (Type.isStringFilled(fields.workPosition))\n\t\t{\n\t\t\tresult.workPosition = Utils.text.htmlspecialcharsback(fields.workPosition);\n\t\t}\n\n\t\tif (Type.isStringFilled(fields.gender))\n\t\t{\n\t\t\tresult.gender = fields.gender === 'F'? 'F': 'M';\n\t\t}\n\n\t\tif (Type.isStringFilled(fields.birthday))\n\t\t{\n\t\t\tresult.birthday = fields.birthday;\n\t\t}\n\n\t\tif (Type.isBoolean(fields.isAdmin))\n\t\t{\n\t\t\tresult.isAdmin = fields.isAdmin;\n\t\t}\n\n\t\tif (Type.isBoolean(fields.extranet))\n\t\t{\n\t\t\tresult.extranet = fields.extranet;\n\t\t}\n\n\t\tif (Type.isBoolean(fields.network))\n\t\t{\n\t\t\tresult.network = fields.network;\n\t\t}\n\n\t\tif (Type.isBoolean(fields.bot))\n\t\t{\n\t\t\tresult.bot = fields.bot;\n\t\t}\n\n\t\tif (Type.isBoolean(fields.connector))\n\t\t{\n\t\t\tresult.connector = fields.connector;\n\t\t}\n\n\t\tif (Type.isStringFilled(fields.external_auth_id))\n\t\t{\n\t\t\tfields.externalAuthId = fields.external_auth_id;\n\t\t}\n\t\tif (Type.isStringFilled(fields.externalAuthId))\n\t\t{\n\t\t\tresult.externalAuthId = fields.externalAuthId;\n\t\t}\n\n\t\tif (Type.isStringFilled(fields.status))\n\t\t{\n\t\t\tresult.status = fields.status;\n\t\t}\n\n\t\tif (!Type.isUndefined(fields.idle))\n\t\t{\n\t\t\tresult.idle = Utils.date.cast(fields.idle, false);\n\t\t}\n\t\tif (!Type.isUndefined(fields.last_activity_date))\n\t\t{\n\t\t\tfields.lastActivityDate = fields.last_activity_date;\n\t\t}\n\t\tif (!Type.isUndefined(fields.lastActivityDate))\n\t\t{\n\t\t\tresult.lastActivityDate = Utils.date.cast(fields.lastActivityDate, false);\n\t\t}\n\t\tif (!Type.isUndefined(fields.mobile_last_date))\n\t\t{\n\t\t\tfields.mobileLastDate = fields.mobile_last_date;\n\t\t}\n\t\tif (!Type.isUndefined(fields.mobileLastDate))\n\t\t{\n\t\t\tresult.mobileLastDate = Utils.date.cast(fields.mobileLastDate, false);\n\t\t}\n\n\t\tif (!Type.isUndefined(fields.absent))\n\t\t{\n\t\t\tresult.absent = Utils.date.cast(fields.absent, false);\n\t\t}\n\n\t\tif (Array.isArray(fields.departments))\n\t\t{\n\t\t\tresult.departments = [];\n\t\t\tfields.departments.forEach(departmentId =>\n\t\t\t{\n\t\t\t\tdepartmentId = Number.parseInt(departmentId, 10);\n\t\t\t\tif (departmentId > 0)\n\t\t\t\t{\n\t\t\t\t\tresult.departments.push(departmentId);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tif (Type.isPlainObject(fields.phones))\n\t\t{\n\t\t\tresult.phones = this.preparePhones(fields.phones);\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tprepareAvatar(avatar: string): string\n\t{\n\t\tlet result = '';\n\n\t\tif (!avatar || avatar.endsWith('/js/im/images/blank.gif'))\n\t\t{\n\t\t\tresult = '';\n\t\t}\n\t\telse if (avatar.startsWith('http'))\n\t\t{\n\t\t\tresult = avatar;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tresult = Core.getHost() + avatar;\n\t\t}\n\n\t\tif (result)\n\t\t{\n\t\t\tresult = encodeURI(result);\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tpreparePhones(phones): Object\n\t{\n\t\tconst result = {};\n\n\t\tif (!Type.isUndefined(phones.work_phone))\n\t\t{\n\t\t\tphones.workPhone = phones.work_phone;\n\t\t}\n\t\tif (Type.isStringFilled(phones.workPhone) || Type.isNumber(phones.workPhone))\n\t\t{\n\t\t\tresult.workPhone =phones.workPhone.toString();\n\t\t}\n\n\t\tif (!Type.isUndefined(phones.personal_mobile))\n\t\t{\n\t\t\tphones.personalMobile = phones.personal_mobile;\n\t\t}\n\t\tif (Type.isStringFilled(phones.personalMobile) || Type.isNumber(phones.personalMobile))\n\t\t{\n\t\t\tresult.personalMobile = phones.personalMobile.toString();\n\t\t}\n\n\t\tif (!Type.isUndefined(phones.personal_phone))\n\t\t{\n\t\t\tphones.personalPhone = phones.personal_phone;\n\t\t}\n\t\tif (Type.isStringFilled(phones.personalPhone) || Type.isNumber(phones.personalPhone))\n\t\t{\n\t\t\tresult.personalPhone = phones.personalPhone.toString();\n\t\t}\n\n\t\tif (!Type.isUndefined(phones.inner_phone))\n\t\t{\n\t\t\tphones.innerPhone = phones.inner_phone;\n\t\t}\n\t\tif (Type.isStringFilled(phones.innerPhone) || Type.isNumber(phones.innerPhone))\n\t\t{\n\t\t\tresult.innerPhone = phones.innerPhone.toString();\n\t\t}\n\n\t\treturn result;\n\t}\n\n\thandleUserStatusFlags(state, fields: ImModelUser)\n\t{\n\t\tconst user = state.collection[fields.id];\n\t\tif (Utils.user.isOnline(fields.lastActivityDate))\n\t\t{\n\t\t\tuser.isOnline = true;\n\t\t\tthis.addToOnlineList(fields.id);\n\t\t}\n\n\t\tif (Utils.user.isMobileOnline(fields.lastActivityDate, fields.mobileLastDate))\n\t\t{\n\t\t\tuser.isMobileOnline = true;\n\t\t\tthis.addToMobileOnlineList(fields.id);\n\t\t}\n\n\t\tif (fields.birthday && Utils.user.isBirthdayToday(fields.birthday))\n\t\t{\n\t\t\tuser.isBirthday = true;\n\t\t\tsetTimeout(() => {\n\t\t\t\tuser.isBirthday = false;\n\t\t\t}, Utils.date.getTimeToNextMidnight());\n\t\t}\n\n\t\tif (fields.absent === false)\n\t\t{\n\t\t\tuser.isAbsent = false;\n\t\t\t// eslint-disable-next-line no-param-reassign\n\t\t\tstate.absentList = state.absentList.filter((element) => {\n\t\t\t\treturn element !== fields.id;\n\t\t\t});\n\t\t}\n\t\telse if (Type.isDate(fields.absent))\n\t\t{\n\t\t\tuser.isAbsent = true;\n\t\t\tthis.addToAbsentList(fields.id);\n\t\t}\n\t}\n\n\taddToOnlineList(id)\n\t{\n\t\tconst state = this.store.state.users;\n\t\tif (!state.onlineList.includes(id))\n\t\t{\n\t\t\tstate.onlineList.push(id);\n\t\t}\n\t}\n\n\taddToMobileOnlineList(id)\n\t{\n\t\tconst state = this.store.state.users;\n\t\tif (!state.mobileOnlineList.includes(id))\n\t\t{\n\t\t\tstate.mobileOnlineList.push(id);\n\t\t}\n\t}\n\n\taddToAbsentList(id)\n\t{\n\t\tconst state = this.store.state.users;\n\t\tif (!state.absentList.includes(id))\n\t\t{\n\t\t\tstate.absentList.push(id);\n\t\t}\n\t}\n\n\tstartAbsentCheckInterval()\n\t{\n\t\tif (this.absentCheckInterval)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tconst TIME_TO_NEXT_DAY = 1000*60*60*24;\n\t\tthis.absentCheckInterval = setTimeout(() => {\n\t\t\tsetInterval(() => {\n\t\t\t\tconst state = this.store.state.users;\n\t\t\t\tstate.absentList.forEach(userId => {\n\t\t\t\t\tconst user = state.collection[userId];\n\t\t\t\t\tif (!user)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tconst currentTime = Date.now();\n\t\t\t\t\tconst absentEnd = new Date(user.absent).getTime();\n\n\t\t\t\t\tif (absentEnd <= currentTime)\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.absentList = state.absentList.filter(element => {\n\t\t\t\t\t\t\treturn element !== userId;\n\t\t\t\t\t\t});\n\t\t\t\t\t\tuser.isAbsent = false;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}, TIME_TO_NEXT_DAY);\n\t\t}, Utils.date.getTimeToNextMidnight());\n\t}\n\n\tstartOnlineCheckInterval()\n\t{\n\t\tif (this.onlineCheckInterval)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tconst ONE_MINUTE = 60000;\n\t\tthis.onlineCheckInterval = setInterval(() => {\n\t\t\tconst state = this.store.state.users;\n\n\t\t\tstate.onlineList.forEach(userId => {\n\t\t\t\tconst user = state.collection[userId];\n\t\t\t\tif (!user)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (Utils.user.isOnline(user.lastActivityDate))\n\t\t\t\t{\n\t\t\t\t\tuser.isOnline = true;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tuser.isOnline = false;\n\t\t\t\t\tstate.onlineList = state.onlineList.filter(element => element !== userId);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tstate.mobileOnlineList.forEach(userId => {\n\t\t\t\tconst user = state.collection[userId];\n\t\t\t\tif (!user)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (Utils.user.isMobileOnline(user.lastActivityDate, user.mobileLastDate))\n\t\t\t\t{\n\t\t\t\t\tuser.isMobileOnline = true;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tuser.isMobileOnline = false;\n\t\t\t\t\tstate.mobileOnlineList = state.mobileOnlineList.filter(element => element !== userId);\n\t\t\t\t}\n\t\t\t});\n\t\t}, ONE_MINUTE);\n\t}\n}","import {Type} from 'main.core';\nimport {BuilderModel} from 'ui.vue3.vuex';\n\nimport {Core} from 'im.v2.application.core';\nimport {FileStatus} from 'im.v2.const';\nimport {Utils} from 'im.v2.lib.utils';\n\nimport type {ImModelFile} from 'im.v2.model';\nimport {Logger} from 'im.v2.lib.logger';\n\ntype FilesState = {\n\tcollection: {\n\t\t[fileId: string]: ImModelFile\n\t}\n};\n\nexport class FilesModel extends BuilderModel\n{\n\tgetName(): string\n\t{\n\t\treturn 'files';\n\t}\n\n\tgetState(): Object\n\t{\n\t\treturn {\n\t\t\tcollection: {},\n\t\t};\n\t}\n\n\tgetElementState()\n\t{\n\t\treturn {\n\t\t\tid: 0,\n\t\t\tchatId: 0,\n\t\t\tname: 'File is deleted',\n\t\t\tdate: new Date(),\n\t\t\ttype: 'file',\n\t\t\textension: '',\n\t\t\ticon: 'empty',\n\t\t\tsize: 0,\n\t\t\timage: false,\n\t\t\tstatus: FileStatus.done,\n\t\t\tprogress: 100,\n\t\t\tauthorId: 0,\n\t\t\tauthorName: '',\n\t\t\turlPreview: '',\n\t\t\turlShow: '',\n\t\t\turlDownload: '',\n\t\t\tviewerAttrs: null\n\t\t};\n\t}\n\n\tgetGetters()\n\t{\n\t\treturn {\n\t\t\tget: (state: FilesState) => (fileId: number, getTemporary = false): ?ImModelFile =>\n\t\t\t{\n\t\t\t\tif (!fileId)\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\tif (!getTemporary && !state.collection[fileId])\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[fileId];\n\t\t\t},\n\t\t\tisInCollection: (state: FilesState) => (payload: {fileId: number | string}): boolean =>\n\t\t\t{\n\t\t\t\tconst {fileId} = payload;\n\n\t\t\t\treturn !!state.collection[fileId];\n\t\t\t}\n\t\t};\n\t}\n\n\tgetActions()\n\t{\n\t\treturn {\n\t\t\tadd: (store, payload: Object) =>\n\t\t\t{\n\t\t\t\tconst preparedFile = {...this.getElementState(), ...this.validate(payload)};\n\n\t\t\t\tstore.commit('add', {files: [preparedFile]});\n\t\t\t},\n\t\t\tset: (store, payload: Object[]) =>\n\t\t\t{\n\t\t\t\tif (!Array.isArray(payload) && Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\tpayload = [payload];\n\t\t\t\t}\n\n\t\t\t\tpayload = payload.map(file => {\n\t\t\t\t\treturn {...this.getElementState(), ...this.validate(file)};\n\t\t\t\t});\n\n\t\t\t\tstore.commit('add', {files: payload});\n\t\t\t},\n\t\t\tupdate: (store, payload) =>\n\t\t\t{\n\t\t\t\tconst {id, fields} = payload;\n\t\t\t\tconst existingItem = store.state.collection[id];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tid: id,\n\t\t\t\t\tfields: this.validate(fields)\n\t\t\t\t});\n\n\t\t\t\treturn true;\n\t\t\t},\n\t\t\tupdateWithId: (store, payload: {id: string | number, fields: Object}) =>\n\t\t\t{\n\t\t\t\tconst {id, fields} = payload;\n\t\t\t\tif (!store.state.collection[id])\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('updateWithId', {\n\t\t\t\t\tid,\n\t\t\t\t\tfields: this.validate(fields)\n\t\t\t\t});\n\t\t\t},\n\t\t\tdelete: (store, payload: {id: string | number}) =>\n\t\t\t{\n\t\t\t\tconst {id} = payload;\n\t\t\t\tif (!store.state.collection[id])\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('delete', {id});\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMutations()\n\t{\n\t\treturn {\n\t\t\tadd: (state: FilesState, payload: {files: ImModelFile[]}) =>\n\t\t\t{\n\t\t\t\tpayload.files.forEach(file => {\n\t\t\t\t\tstate.collection[file.id] = file;\n\t\t\t\t});\n\t\t\t},\n\t\t\tupdate: (state: FilesState, payload) =>\n\t\t\t{\n\t\t\t\tObject.entries(payload.fields).forEach(([key, value]) => {\n\t\t\t\t\tstate.collection[payload.id][key] = value;\n\t\t\t\t});\n\t\t\t},\n\t\t\tupdateWithId: (state: FilesState, payload: {id: number | string, fields: Object}) =>\n\t\t\t{\n\t\t\t\tconst {id, fields} = payload;\n\t\t\t\tconst currentFile = {...state.collection[id]};\n\n\t\t\t\tdelete state.collection[id];\n\t\t\t\tstate.collection[fields.id] = {...currentFile, ...fields};\n\t\t\t},\n\t\t\tdelete: (state: FilesState, payload: {id: number | string}) =>\n\t\t\t{\n\t\t\t\tLogger.warn('Files model: delete mutation', payload);\n\t\t\t\tconst {id} = payload;\n\t\t\t\tdelete state.collection[id];\n\t\t\t},\n\t\t};\n\t}\n\n\tvalidate(file: Object): ImModelFile\n\t{\n\t\tconst result = {};\n\n\t\tif (Type.isNumber(file.id) || Type.isStringFilled(file.id))\n\t\t{\n\t\t\tresult.id = file.id;\n\t\t}\n\n\t\tif (Type.isNumber(file.chatId) || Type.isString(file.chatId))\n\t\t{\n\t\t\tresult.chatId = Number.parseInt(file.chatId, 10);\n\t\t}\n\n\t\tif (!Type.isUndefined(file.date))\n\t\t{\n\t\t\tresult.date = Utils.date.cast(file.date);\n\t\t}\n\n\t\tif (Type.isString(file.type))\n\t\t{\n\t\t\tresult.type = file.type;\n\t\t}\n\n\t\tif (Type.isString(file.extension))\n\t\t{\n\t\t\tresult.extension = file.extension.toString();\n\n\t\t\tif (result.type === 'image')\n\t\t\t{\n\t\t\t\tresult.icon = 'img';\n\t\t\t}\n\t\t\telse if (result.type === 'video')\n\t\t\t{\n\t\t\t\tresult.icon = 'mov';\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresult.icon = Utils.file.getIconTypeByExtension(result.extension);\n\t\t\t}\n\t\t}\n\n\t\tif (Type.isString(file.name) || Type.isNumber(file.name))\n\t\t{\n\t\t\tresult.name = file.name.toString();\n\t\t}\n\n\t\tif (Type.isNumber(file.size) || Type.isString(file.size))\n\t\t{\n\t\t\tresult.size = Number.parseInt(file.size, 10);\n\t\t}\n\n\t\tif (Type.isBoolean(file.image))\n\t\t{\n\t\t\tresult.image = false;\n\t\t}\n\t\telse if (Type.isPlainObject(file.image))\n\t\t{\n\t\t\tresult.image = {\n\t\t\t\twidth: 0,\n\t\t\t\theight: 0,\n\t\t\t};\n\n\t\t\tif (Type.isString(file.image.width) || Type.isNumber(file.image.width))\n\t\t\t{\n\t\t\t\tresult.image.width = Number.parseInt(file.image.width, 10);\n\t\t\t}\n\t\t\tif (Type.isString(file.image.height) || Type.isNumber(file.image.height))\n\t\t\t{\n\t\t\t\tresult.image.height = Number.parseInt(file.image.height, 10);\n\t\t\t}\n\n\t\t\tif (result.image.width <= 0 || result.image.height <= 0)\n\t\t\t{\n\t\t\t\tresult.image = false;\n\t\t\t}\n\t\t}\n\n\t\tif (Type.isString(file.status) && !Type.isUndefined(FileStatus[file.status]))\n\t\t{\n\t\t\tresult.status = file.status;\n\t\t}\n\n\t\tif (Type.isNumber(file.progress) || Type.isString(file.progress))\n\t\t{\n\t\t\tresult.progress = Number.parseInt(file.progress, 10);\n\t\t}\n\n\t\tif (Type.isNumber(file.authorId) || Type.isString(file.authorId))\n\t\t{\n\t\t\tresult.authorId = Number.parseInt(file.authorId, 10);\n\t\t}\n\n\t\tif (Type.isString(file.authorName) || Type.isNumber(file.authorName))\n\t\t{\n\t\t\tresult.authorName = file.authorName.toString();\n\t\t}\n\n\t\tif (Type.isString(file.urlPreview))\n\t\t{\n\t\t\tif (\n\t\t\t\t!file.urlPreview\n\t\t\t\t|| file.urlPreview.startsWith('http')\n\t\t\t\t|| file.urlPreview.startsWith('bx')\n\t\t\t\t|| file.urlPreview.startsWith('file')\n\t\t\t\t|| file.urlPreview.startsWith('blob')\n\t\t\t)\n\t\t\t{\n\t\t\t\tresult.urlPreview = file.urlPreview;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresult.urlPreview = Core.getHost() + file.urlPreview;\n\t\t\t}\n\t\t}\n\n\t\tif (Type.isString(file.urlDownload))\n\t\t{\n\t\t\tif (\n\t\t\t\t!file.urlDownload\n\t\t\t\t|| file.urlDownload.startsWith('http')\n\t\t\t\t|| file.urlDownload.startsWith('bx')\n\t\t\t\t|| file.urlPreview.startsWith('file')\n\t\t\t)\n\t\t\t{\n\t\t\t\tresult.urlDownload = file.urlDownload;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresult.urlDownload = Core.getHost() + file.urlDownload;\n\t\t\t}\n\t\t}\n\n\t\tif (Type.isString(file.urlShow))\n\t\t{\n\t\t\tif (\n\t\t\t\t!file.urlShow\n\t\t\t\t|| file.urlShow.startsWith('http')\n\t\t\t\t|| file.urlShow.startsWith('bx')\n\t\t\t\t|| file.urlShow.startsWith('file')\n\t\t\t)\n\t\t\t{\n\t\t\t\tresult.urlShow = file.urlShow;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresult.urlShow = Core.getHost() + file.urlShow;\n\t\t\t}\n\t\t}\n\n\t\tif (Type.isPlainObject(file.viewerAttrs))\n\t\t{\n\t\t\tresult.viewerAttrs = this.validateViewerAttributes(file.viewerAttrs);\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tvalidateViewerAttributes(viewerAttrs)\n\t{\n\t\tconst result = {\n\t\t\tviewer: true,\n\t\t};\n\n\t\tif (Type.isString(viewerAttrs.actions))\n\t\t{\n\t\t\tresult.actions = viewerAttrs.actions;\n\t\t}\n\n\t\tif (Type.isString(viewerAttrs.objectId))\n\t\t{\n\t\t\tresult.objectId = viewerAttrs.objectId;\n\t\t}\n\n\t\tif (Type.isString(viewerAttrs.src))\n\t\t{\n\t\t\tresult.src = viewerAttrs.src;\n\t\t}\n\n\t\tif (Type.isString(viewerAttrs.title))\n\t\t{\n\t\t\tresult.title = viewerAttrs.title;\n\t\t}\n\n\t\tif (Type.isString(viewerAttrs.viewerGroupBy))\n\t\t{\n\t\t\tresult.viewerGroupBy = viewerAttrs.viewerGroupBy;\n\t\t}\n\n\t\tif (Type.isString(viewerAttrs.viewerType))\n\t\t{\n\t\t\tresult.viewerType = viewerAttrs.viewerType;\n\t\t}\n\n\t\tif (Type.isString(viewerAttrs.viewerTypeClass))\n\t\t{\n\t\t\tresult.viewerTypeClass = viewerAttrs.viewerTypeClass;\n\t\t}\n\n\t\tif (Type.isBoolean(viewerAttrs.viewerSeparateItem))\n\t\t{\n\t\t\tresult.viewerSeparateItem = viewerAttrs.viewerSeparateItem;\n\t\t}\n\n\t\tif (Type.isString(viewerAttrs.viewerExtension))\n\t\t{\n\t\t\tresult.viewerExtension = viewerAttrs.viewerExtension;\n\t\t}\n\n\t\tif (Type.isNumber(viewerAttrs.imChatId))\n\t\t{\n\t\t\tresult.imChatId = viewerAttrs.imChatId;\n\t\t}\n\n\t\treturn result;\n\t}\n}\n","import {Type} from 'main.core';\nimport {BuilderModel, GetterTree, ActionTree, MutationTree} from 'ui.vue3.vuex';\n\nimport {RecentCallStatus} from 'im.v2.const';\n\nimport type {ImModelCallItem} from 'im.v2.model';\n\ntype CallsState = {\n\tcollection: {\n\t\t[dialogId: string]: ImModelCallItem\n\t}\n};\n\nexport class CallsModel extends BuilderModel\n{\n\tgetState()\n\t{\n\t\treturn {\n\t\t\tcollection: {}\n\t\t};\n\t}\n\n\tgetElementState()\n\t{\n\t\treturn {\n\t\t\tdialogId: 0,\n\t\t\tname: '',\n\t\t\tcall: {},\n\t\t\tstate: RecentCallStatus.waiting\n\t\t};\n\t}\n\n\tgetGetters(): GetterTree\n\t{\n\t\treturn {\n\t\t\tget: (state: CallsState): ImModelCallItem[] =>\n\t\t\t{\n\t\t\t\treturn Object.values(state.collection);\n\t\t\t}\n\t\t};\n\t}\n\n\tgetActions(): ActionTree\n\t{\n\t\treturn {\n\t\t\taddActiveCall: (store, payload: ImModelCallItem) =>\n\t\t\t{\n\t\t\t\tconst existingCall = Object.values(store.state.collection).find((item: ImModelCallItem) => {\n\t\t\t\t\treturn item.dialogId === payload.dialogId || item.call.id === payload.call.id;\n\t\t\t\t});\n\n\t\t\t\tif (existingCall)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('updateActiveCall', {\n\t\t\t\t\t\tdialogId: existingCall.dialogId,\n\t\t\t\t\t\tfields: this.validateActiveCall(payload)\n\t\t\t\t\t});\n\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('addActiveCall', this.prepareActiveCall(payload));\n\t\t\t},\n\t\t\tupdateActiveCall: (store, payload) =>\n\t\t\t{\n\t\t\t\tconst existingCall = store.state.collection[payload.dialogId];\n\t\t\t\tif (!existingCall)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('updateActiveCall', {\n\t\t\t\t\tdialogId: existingCall.dialogId,\n\t\t\t\t\tfields: this.validateActiveCall(payload.fields)\n\t\t\t\t});\n\t\t\t},\n\t\t\tdeleteActiveCall: (store, payload) =>\n\t\t\t{\n\t\t\t\tconst existingCall = store.state.collection[payload.dialogId];\n\t\t\t\tif (!existingCall)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('deleteActiveCall', {\n\t\t\t\t\tdialogId: existingCall.dialogId\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\t}\n\n\tgetMutations(): MutationTree\n\t{\n\t\treturn {\n\t\t\taddActiveCall: (state: CallsState, payload: ImModelCallItem) => {\n\t\t\t\tstate.collection[payload.dialogId] = payload;\n\t\t\t},\n\t\t\tupdateActiveCall: (state: CallsState, payload) => {\n\t\t\t\tstate.collection[payload.dialogId] = {\n\t\t\t\t\t...state.collection[payload.dialogId],\n\t\t\t\t\t...payload.fields\n\t\t\t\t};\n\t\t\t},\n\t\t\tdeleteActiveCall: (state: CallsState, payload) => {\n\t\t\t\tdelete state.collection[payload.dialogId];\n\t\t\t},\n\t\t};\n\t}\n\n\tprepareActiveCall(call)\n\t{\n\t\treturn {...this.getElementState(), ...this.validateActiveCall(call)};\n\t}\n\n\tvalidateActiveCall(fields)\n\t{\n\t\tconst result = {};\n\n\t\tif (Type.isStringFilled(fields.dialogId) || Type.isNumber(fields.dialogId))\n\t\t{\n\t\t\tresult.dialogId = fields.dialogId;\n\t\t}\n\n\t\tif (Type.isStringFilled(fields.name))\n\t\t{\n\t\t\tresult.name = fields.name;\n\t\t}\n\n\t\tif (Type.isObjectLike(fields.call))\n\t\t{\n\t\t\tresult.call = fields.call;\n\n\t\t\tif (fields.call?.associatedEntity?.avatar === '/bitrix/js/im/images/blank.gif')\n\t\t\t{\n\t\t\t\tresult.call.associatedEntity.avatar = '';\n\t\t\t}\n\t\t}\n\n\t\tif (RecentCallStatus[fields.state])\n\t\t{\n\t\t\tresult.state = fields.state;\n\t\t}\n\n\t\treturn result;\n\t}\n}","import {Type} from 'main.core';\nimport {BuilderModel} from 'ui.vue3.vuex';\n\nimport {Core} from 'im.v2.application.core';\nimport {DialogType, MessageStatus, Settings} from 'im.v2.const';\nimport {Utils} from 'im.v2.lib.utils';\n\nimport {CallsModel} from './recent/calls';\n\nimport type {RecentItem as ImModelRecentItem} from './type/recent-item';\nimport type {Dialog as ImModelDialog} from './type/dialog';\n\ntype RecentState = {\n\tcollection: {[dialogId: string]: ImModelRecentItem},\n\trecentCollection: Set<string>,\n\tunreadCollection: Set<string>,\n\tmarkedCollection: Set<number>,\n\tunloadedChatCounters: {[chatId: string]: number}\n};\n\nexport class RecentModel extends BuilderModel\n{\n\tgetName()\n\t{\n\t\treturn 'recent';\n\t}\n\n\tgetNestedModules(): { [moduleName: string]: BuilderModel }\n\t{\n\t\treturn {calls: CallsModel};\n\t}\n\n\tgetState()\n\t{\n\t\treturn {\n\t\t\tcollection: {},\n\t\t\trecentCollection: new Set(),\n\t\t\tunreadCollection: new Set(),\n\t\t\tunloadedChatCounters: {}\n\t\t};\n\t}\n\n\tgetElementState()\n\t{\n\t\treturn {\n\t\t\tdialogId: '0',\n\t\t\tmessage: {\n\t\t\t\tid: 0,\n\t\t\t\tsenderId: 0,\n\t\t\t\tdate: new Date(),\n\t\t\t\tstatus: MessageStatus.received,\n\t\t\t\tsending: false,\n\t\t\t\ttext: '',\n\t\t\t\tparams: {\n\t\t\t\t\twithFile: false,\n\t\t\t\t\twithAttach: false,\n\t\t\t\t}\n\t\t\t},\n\t\t\tdraft: {\n\t\t\t\ttext: '',\n\t\t\t\tdate: null\n\t\t\t},\n\t\t\tunread: false,\n\t\t\tpinned: false,\n\t\t\tliked: false,\n\t\t\tinvitation: {\n\t\t\t\tisActive: false,\n\t\t\t\toriginator: 0,\n\t\t\t\tcanResend: false\n\t\t\t},\n\t\t\toptions: {}\n\t\t};\n\t}\n\n\tgetGetters()\n\t{\n\t\treturn {\n\t\t\tgetRecentCollection: (state: RecentState): ImModelRecentItem[] =>\n\t\t\t{\n\t\t\t\treturn [...state.recentCollection].map(id => {\n\t\t\t\t\treturn state.collection[id];\n\t\t\t\t});\n\t\t\t},\n\t\t\tgetUnreadCollection: (state: RecentState): ImModelRecentItem[] =>\n\t\t\t{\n\t\t\t\treturn [...state.unreadCollection].map(id => {\n\t\t\t\t\treturn state.collection[id];\n\t\t\t\t});\n\t\t\t},\n\t\t\tgetSortedCollection: (state: RecentState): ImModelRecentItem[] =>\n\t\t\t{\n\t\t\t\tconst collectionAsArray = Object.values(state.collection).filter(item => {\n\t\t\t\t\tconst isBirthdayPlaceholder = item.options.birthdayPlaceholder;\n\t\t\t\t\tconst isInvitedUser = item.options.defaultUserRecord;\n\n\t\t\t\t\treturn !isBirthdayPlaceholder && !isInvitedUser && item.message.id;\n\t\t\t\t});\n\n\t\t\t\treturn [...collectionAsArray].sort((a, b) => {\n\t\t\t\t\treturn b.message.date - a.message.date;\n\t\t\t\t});\n\t\t\t},\n\t\t\tget: (state: RecentState) => (dialogId: string): ImModelRecentItem | null =>\n\t\t\t{\n\t\t\t\tif (Type.isNumber(dialogId))\n\t\t\t\t{\n\t\t\t\t\tdialogId = dialogId.toString();\n\t\t\t\t}\n\n\t\t\t\tif (state.collection[dialogId])\n\t\t\t\t{\n\t\t\t\t\treturn state.collection[dialogId];\n\t\t\t\t}\n\n\t\t\t\treturn null;\n\t\t\t},\n\n\t\t\tneedsBirthdayPlaceholder: (state: RecentState) => (dialogId): boolean =>\n\t\t\t{\n\t\t\t\tconst currentItem = state.collection[dialogId];\n\t\t\t\tif (!currentItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst dialog = this.store.getters['dialogues/get'](dialogId);\n\t\t\t\tif (!dialog || dialog.type !== DialogType.user)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tconst hasBirthday = this.store.getters['users/hasBirthday'](dialogId);\n\t\t\t\tif (!hasBirthday)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst hasMessage = Utils.text.isTempMessage(currentItem.message.id) || currentItem.message.id > 0;\n\t\t\t\tconst hasTodayMessage = hasMessage && Utils.date.isToday(currentItem.message.date);\n\n\t\t\t\tconst showBirthday = this.store.getters['application/settings/get'](Settings.recent.showBirthday);\n\t\t\t\treturn showBirthday && !hasTodayMessage && dialog.counter === 0;\n\t\t\t},\n\n\t\t\tneedsVacationPlaceholder: (state: RecentState) => (dialogId): boolean =>\n\t\t\t{\n\t\t\t\tconst currentItem = state.collection[dialogId];\n\t\t\t\tif (!currentItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst dialog = this.store.getters['dialogues/get'](dialogId);\n\t\t\t\tif (!dialog || dialog.type !== DialogType.user)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tconst hasVacation = this.store.getters['users/hasVacation'](dialogId);\n\t\t\t\tif (!hasVacation)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst hasMessage = Utils.text.isTempMessage(currentItem.message.id) || currentItem.message.id > 0;\n\t\t\t\tconst hasTodayMessage = hasMessage && Utils.date.isToday(currentItem.message.date);\n\n\t\t\t\treturn !hasTodayMessage && dialog.counter === 0;\n\t\t\t},\n\n\t\t\tgetMessageDate: (state: RecentState) => (dialogId): Date | null =>\n\t\t\t{\n\t\t\t\tconst currentItem = state.collection[dialogId];\n\t\t\t\tif (!currentItem)\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\tif (Type.isDate(currentItem.draft.date) && currentItem.draft.date > currentItem.message.date)\n\t\t\t\t{\n\t\t\t\t\treturn currentItem.draft.date;\n\t\t\t\t}\n\n\t\t\t\tconst needsBirthdayPlaceholder = this.store.getters['recent/needsBirthdayPlaceholder'](currentItem.dialogId);\n\t\t\t\tif (needsBirthdayPlaceholder)\n\t\t\t\t{\n\t\t\t\t\treturn Utils.date.getStartOfTheDay();\n\t\t\t\t}\n\n\t\t\t\treturn currentItem.message.date;\n\t\t\t},\n\n\t\t\tgetTotalCounter: (state: RecentState): number =>\n\t\t\t{\n\t\t\t\tlet loadedChatsCounter = 0;\n\t\t\t\t[...state.recentCollection].forEach(dialogId => {\n\t\t\t\t\tconst dialog: ImModelDialog = this.store.getters['dialogues/get'](dialogId, true);\n\t\t\t\t\tconst recentItem: ImModelRecentItem = state.collection[dialogId];\n\n\t\t\t\t\tconst isMuted = dialog.muteList.includes(Core.getUserId());\n\t\t\t\t\tif (isMuted)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tconst isMarked = recentItem.unread;\n\t\t\t\t\tif (dialog.counter === 0 && isMarked)\n\t\t\t\t\t{\n\t\t\t\t\t\tloadedChatsCounter++;\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tloadedChatsCounter += dialog.counter;\n\t\t\t\t});\n\n\t\t\t\tlet unloadedChatsCounter = 0;\n\t\t\t\tObject.values(state.unloadedChatCounters).forEach(counter => {\n\t\t\t\t\tunloadedChatsCounter += counter;\n\t\t\t\t});\n\n\t\t\t\treturn loadedChatsCounter + unloadedChatsCounter;\n\t\t\t}\n\t\t};\n\t}\n\n\tgetActions()\n\t{\n\t\treturn {\n\t\t\tsetRecent: (store, payload: Array | Object) =>\n\t\t\t{\n\t\t\t\tthis.store.dispatch('recent/set', payload).then(itemIds => {\n\t\t\t\t\tstore.commit('setRecentCollection', itemIds);\n\t\t\t\t});\n\n\t\t\t\tif (!Array.isArray(payload) && Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\tpayload = [payload];\n\t\t\t\t}\n\t\t\t\tconst zeroedCountersForNewItems = {};\n\t\t\t\tpayload.forEach(item => {\n\t\t\t\t\tzeroedCountersForNewItems[item.chat_id] = 0;\n\t\t\t\t});\n\t\t\t\tthis.store.dispatch('recent/setUnloadedChatCounters', zeroedCountersForNewItems);\n\t\t\t},\n\t\t\tsetUnread: (store, payload: Array | Object) =>\n\t\t\t{\n\t\t\t\tthis.store.dispatch('recent/set', payload).then(itemIds => {\n\t\t\t\t\tstore.commit('setUnreadCollection', itemIds);\n\t\t\t\t});\n\t\t\t},\n\t\t\tset: (store, payload: Array | Object) =>\n\t\t\t{\n\t\t\t\tif (!Array.isArray(payload) && Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\tpayload = [payload];\n\t\t\t\t}\n\n\t\t\t\tconst itemsToUpdate = [];\n\t\t\t\tconst itemsToAdd = [];\n\t\t\t\tpayload.map((element) => {\n\t\t\t\t\treturn this.validate(element);\n\t\t\t\t}).forEach((element) => {\n\t\t\t\t\tconst preparedElement = { ...element };\n\t\t\t\t\tconst existingItem = store.state.collection[element.dialogId];\n\t\t\t\t\tif (existingItem)\n\t\t\t\t\t{\n\t\t\t\t\t\titemsToUpdate.push({ dialogId: existingItem.dialogId, fields: preparedElement });\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tconst { message: defaultMessage } = this.getElementState();\n\t\t\t\t\t\tpreparedElement.message = { ...defaultMessage, ...preparedElement.message };\n\t\t\t\t\t\titemsToAdd.push({ ...this.getElementState(), ...preparedElement });\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tif (itemsToAdd.length > 0)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('add', itemsToAdd);\n\t\t\t\t}\n\n\t\t\t\tif (itemsToUpdate.length > 0)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('update', itemsToUpdate);\n\t\t\t\t}\n\n\t\t\t\treturn [...itemsToAdd, ...itemsToUpdate].map(item => item.dialogId);\n\t\t\t},\n\n\t\t\tupdate: (store, payload: {id: string | number, fields: Object}) =>\n\t\t\t{\n\t\t\t\tconst {id, fields} = payload;\n\t\t\t\tconst existingItem: ImModelRecentItem = store.state.collection[id];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tdialogId: existingItem.dialogId,\n\t\t\t\t\tfields: this.validate(fields)\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tunread: (store, payload: {id: string | number, action: boolean}) =>\n\t\t\t{\n\t\t\t\tconst existingItem = store.state.collection[payload.id];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tdialogId: existingItem.dialogId,\n\t\t\t\t\tfields: {unread: payload.action}\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tpin: (store, payload: {id: string | number, action: boolean}) =>\n\t\t\t{\n\t\t\t\tconst existingItem = store.state.collection[payload.id];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tdialogId: existingItem.dialogId,\n\t\t\t\t\tfields: {pinned: payload.action}\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tlike: (store, payload: {id: string | number, messageId: number, liked: boolean}) =>\n\t\t\t{\n\t\t\t\tconst existingItem = store.state.collection[payload.id];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst isLastMessage = existingItem.message.id === Number.parseInt(payload.messageId, 10);\n\t\t\t\tconst isExactMessageLiked = !Type.isUndefined(payload.messageId) && payload.liked === true;\n\t\t\t\tif (isExactMessageLiked && !isLastMessage)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tdialogId: existingItem.dialogId,\n\t\t\t\t\tfields: {liked: payload.liked === true}\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tdraft: (store, payload: {id: string | number, text: string}) =>\n\t\t\t{\n\t\t\t\tconst dialog = this.store.getters['dialogues/get'](payload.id);\n\t\t\t\tif (!dialog)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tlet existingItem = store.state.collection[payload.id];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\tif (payload.text === '')\n\t\t\t\t\t{\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t\tconst newItem = {\n\t\t\t\t\t\tdialogId: payload.id.toString(),\n\t\t\t\t\t};\n\t\t\t\t\tstore.commit('add', {...this.getElementState(), ...newItem});\n\t\t\t\t\tstore.commit('setRecentCollection', [newItem.dialogId]);\n\t\t\t\t\texistingItem = store.state.collection[payload.id];\n\t\t\t\t}\n\n\t\t\t\tconst fields = this.validate({draft: {text: payload.text.toString()}});\n\t\t\t\tif (fields.draft.text === existingItem.draft.text)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tdialogId: existingItem.dialogId,\n\t\t\t\t\tfields\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tdelete: (store, payload: {id: string | number}) =>\n\t\t\t{\n\t\t\t\tconst existingItem = store.state.collection[payload.id];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('delete', {\n\t\t\t\t\tid: existingItem.dialogId\n\t\t\t\t});\n\t\t\t\tstore.commit('deleteFromRecentCollection', existingItem.dialogId);\n\t\t\t},\n\n\t\t\tclearUnread: (store) =>\n\t\t\t{\n\t\t\t\tstore.commit('clearUnread');\n\t\t\t},\n\n\t\t\tsetUnloadedChatCounters: (store, payload: {[chatId: string]: number}) =>\n\t\t\t{\n\t\t\t\tif (!Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setUnloadedChatCounters', payload);\n\t\t\t}\n\t\t};\n\t}\n\n\tgetMutations()\n\t{\n\t\treturn {\n\t\t\tsetRecentCollection: (state: RecentState, payload: string[]) => {\n\t\t\t\tpayload.forEach(dialogId => {\n\t\t\t\t\tstate.recentCollection.add(dialogId);\n\t\t\t\t});\n\t\t\t},\n\t\t\tdeleteFromRecentCollection: (state: RecentState, payload: string) => {\n\t\t\t\tstate.recentCollection.delete(payload);\n\t\t\t},\n\t\t\tsetUnreadCollection: (state: RecentState, payload: string[]) => {\n\t\t\t\tpayload.forEach(dialogId => {\n\t\t\t\t\tstate.unreadCollection.add(dialogId);\n\t\t\t\t});\n\t\t\t},\n\t\t\tadd: (state: RecentState, payload: Object[] | Object) => {\n\t\t\t\tif (!Array.isArray(payload) && Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\tpayload = [payload];\n\t\t\t\t}\n\t\t\t\tpayload.forEach(item => {\n\t\t\t\t\tstate.collection[item.dialogId] = item;\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tupdate: (state: RecentState, payload: Object[] | Object) => {\n\t\t\t\tif (!Array.isArray(payload) && Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\tpayload = [payload];\n\t\t\t\t}\n\t\t\t\tpayload.forEach(({dialogId, fields}) => {\n\t\t\t\t\t// if we already got chat - we should not update it with default user chat (unless it's an accepted invitation)\n\t\t\t\t\tconst defaultUserElement = fields.options && fields.options.defaultUserRecord && !fields.invitation;\n\t\t\t\t\tif (defaultUserElement)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst currentElement = state.collection[dialogId];\n\t\t\t\t\tfields.message = {...currentElement.message, ...fields.message};\n\t\t\t\t\tfields.options = {...currentElement.options, ...fields.options};\n\t\t\t\t\tstate.collection[dialogId] = {\n\t\t\t\t\t\t...currentElement,\n\t\t\t\t\t\t...fields\n\t\t\t\t\t};\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tdelete: (state: RecentState, payload: {id: string}) => {\n\t\t\t\tdelete state.collection[payload.id];\n\t\t\t},\n\n\t\t\tclearUnread: (state: RecentState) => {\n\t\t\t\tObject.keys(state.collection).forEach(key => {\n\t\t\t\t\tstate.collection[key].unread = false;\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tsetUnloadedChatCounters: (state: RecentState, payload: {[chatId: string]: number}) => {\n\t\t\t\tObject.entries(payload).forEach(([chatId, counter]) => {\n\t\t\t\t\tif (counter === 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tdelete state.unloadedChatCounters[chatId];\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tstate.unloadedChatCounters[chatId] = counter;\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\t}\n\n\tvalidate(fields: Object)\n\t{\n\t\tconst result = {\n\t\t\toptions: {}\n\t\t};\n\n\t\tif (Type.isNumber(fields.id))\n\t\t{\n\t\t\tresult.dialogId = fields.id.toString();\n\t\t}\n\t\tif (Type.isStringFilled(fields.id))\n\t\t{\n\t\t\tresult.dialogId = fields.id;\n\t\t}\n\n\t\tif (Type.isNumber(fields.dialogId))\n\t\t{\n\t\t\tresult.dialogId = fields.dialogId.toString();\n\t\t}\n\t\tif (Type.isStringFilled(fields.dialogId))\n\t\t{\n\t\t\tresult.dialogId = fields.dialogId;\n\t\t}\n\n\t\tif (Type.isPlainObject(fields.message))\n\t\t{\n\t\t\tresult.message = this.prepareMessage(fields);\n\t\t}\n\n\t\tif (Type.isPlainObject(fields.draft))\n\t\t{\n\t\t\tresult.draft = this.prepareDraft(fields);\n\t\t}\n\n\t\tif (Type.isBoolean(fields.unread))\n\t\t{\n\t\t\tresult.unread = fields.unread;\n\t\t}\n\n\t\tif (Type.isBoolean(fields.pinned))\n\t\t{\n\t\t\tresult.pinned = fields.pinned;\n\t\t}\n\n\t\tif (Type.isBoolean(fields.liked))\n\t\t{\n\t\t\tresult.liked = fields.liked;\n\t\t}\n\n\t\tif (Type.isPlainObject(fields.invited))\n\t\t{\n\t\t\tresult.invitation = {\n\t\t\t\tisActive: true,\n\t\t\t\toriginator: fields.invited.originator_id,\n\t\t\t\tcanResend: fields.invited.can_resend\n\t\t\t};\n\t\t\tresult.options.defaultUserRecord = true;\n\t\t}\n\t\telse if (fields.invited === false)\n\t\t{\n\t\t\tresult.invitation = {\n\t\t\t\tisActive: false,\n\t\t\t\toriginator: 0,\n\t\t\t\tcanResend: false\n\t\t\t};\n\t\t\tresult.options.defaultUserRecord = true;\n\t\t}\n\n\t\tif (Type.isPlainObject(fields.options))\n\t\t{\n\t\t\tif (!result.options)\n\t\t\t{\n\t\t\t\tresult.options = {};\n\t\t\t}\n\n\t\t\tif (Type.isBoolean(fields.options.default_user_record))\n\t\t\t{\n\t\t\t\tfields.options.defaultUserRecord = fields.options.default_user_record;\n\t\t\t}\n\n\t\t\tif (Type.isBoolean(fields.options.defaultUserRecord))\n\t\t\t{\n\t\t\t\tresult.options.defaultUserRecord = fields.options.defaultUserRecord;\n\t\t\t}\n\n\t\t\tif (Type.isBoolean(fields.options.birthdayPlaceholder))\n\t\t\t{\n\t\t\t\tresult.options.birthdayPlaceholder = fields.options.birthdayPlaceholder;\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tprepareMessage(fields: Object): Object\n\t{\n\t\tconst message = {};\n\t\tconst params = {};\n\n\t\tif (\n\t\t\tType.isNumber(fields.message.id)\n\t\t\t|| Type.isStringFilled(fields.message.id)\n\t\t\t|| Utils.text.isUuidV4(fields.message.id)\n\t\t)\n\t\t{\n\t\t\tmessage.id = fields.message.id;\n\t\t}\n\t\tif (Type.isString(fields.message.text))\n\t\t{\n\t\t\tmessage.text = fields.message.text;\n\t\t}\n\n\t\tif (\n\t\t\tType.isStringFilled(fields.message.attach)\n\t\t\t|| Type.isBoolean(fields.message.attach)\n\t\t\t|| Type.isArray(fields.message.attach)\n\t\t)\n\t\t{\n\t\t\tparams.withAttach = fields.message.attach;\n\t\t}\n\t\telse if (\n\t\t\tType.isStringFilled(fields.message.params?.withAttach)\n\t\t\t|| Type.isBoolean(fields.message.params?.withAttach)\n\t\t\t|| Type.isArray(fields.message.params?.withAttach)\n\t\t)\n\t\t{\n\t\t\tparams.withAttach = fields.message.params.withAttach;\n\t\t}\n\n\t\tif (Type.isBoolean(fields.message.file) || Type.isPlainObject(fields.message.file))\n\t\t{\n\t\t\tparams.withFile = fields.message.file;\n\t\t}\n\t\telse if (Type.isBoolean(fields.message.params?.withFile) || Type.isPlainObject(fields.message.params?.withFile))\n\t\t{\n\t\t\tparams.withFile = fields.message.params.withFile;\n\t\t}\n\n\t\tif (Type.isDate(fields.message.date) || Type.isString(fields.message.date))\n\t\t{\n\t\t\tmessage.date = Utils.date.cast(fields.message.date);\n\t\t}\n\n\t\tif (Type.isNumber(fields.message.author_id))\n\t\t{\n\t\t\tmessage.senderId = fields.message.author_id;\n\t\t}\n\t\telse if (Type.isNumber(fields.message.authorId))\n\t\t{\n\t\t\tmessage.senderId = fields.message.authorId;\n\t\t}\n\t\telse if (Type.isNumber(fields.message.senderId))\n\t\t{\n\t\t\tmessage.senderId = fields.message.senderId;\n\t\t}\n\n\t\tif (Type.isStringFilled(fields.message.status))\n\t\t{\n\t\t\tmessage.status = fields.message.status;\n\t\t}\n\t\tif (Type.isBoolean(fields.message.sending))\n\t\t{\n\t\t\tmessage.sending = fields.message.sending;\n\t\t}\n\n\t\tif (Object.keys(params).length > 0)\n\t\t{\n\t\t\tmessage.params = params;\n\t\t}\n\n\t\treturn message;\n\t}\n\n\tprepareDraft(fields: Object): Object\n\t{\n\t\tconst {draft} = this.getElementState();\n\n\t\tif (Type.isString(fields.draft.text))\n\t\t{\n\t\t\tdraft.text = fields.draft.text;\n\t\t}\n\n\t\tif (Type.isStringFilled(draft.text))\n\t\t{\n\t\t\tdraft.date = new Date();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tdraft.date = null;\n\t\t}\n\n\t\treturn draft;\n\t}\n}","import {BuilderModel} from 'ui.vue3.vuex';\nimport {Type, Text} from 'main.core';\n\nimport {Core} from 'im.v2.application.core';\nimport {Utils} from 'im.v2.lib.utils';\nimport {NotificationTypesCodes} from 'im.v2.const';\n\nexport class NotificationsModel extends BuilderModel\n{\n\tgetName(): string\n\t{\n\t\treturn 'notifications';\n\t}\n\n\tgetState(): Object\n\t{\n\t\treturn {\n\t\t\tcollection: new Map(),\n\t\t\tsearchCollection: new Map(),\n\t\t\tunreadCounter: 0,\n\t\t};\n\t}\n\n\tgetElementState(): Object\n\t{\n\t\treturn {\n\t\t\tid: 0,\n\t\t\tauthorId: 0,\n\t\t\tdate: new Date(),\n\t\t\ttitle: '',\n\t\t\ttext: '',\n\t\t\tparams: {},\n\t\t\treplaces: [],\n\t\t\tnotifyButtons: [],\n\t\t\tsectionCode: NotificationTypesCodes.simple,\n\t\t\tread: false,\n\t\t\tsettingName: 'im|default',\n\t\t};\n\t}\n\n\tgetGetters(): Object\n\t{\n\t\treturn {\n\t\t\tgetSortedCollection: state =>\n\t\t\t{\n\t\t\t\treturn [...state.collection.values()].sort(this.sortByType);\n\t\t\t},\n\t\t\tgetSearchResultCollection: state =>\n\t\t\t{\n\t\t\t\treturn [...state.searchCollection.values()].sort(this.sortByType);\n\t\t\t},\n\t\t\tgetConfirmsCount: state =>\n\t\t\t{\n\t\t\t\treturn [...state.collection.values()].filter(notification => {\n\t\t\t\t\treturn notification.sectionCode === NotificationTypesCodes.confirm;\n\t\t\t\t}).length;\n\t\t\t},\n\t\t\tgetById: state => (notificationId) =>\n\t\t\t{\n\t\t\t\tif (Type.isString(notificationId))\n\t\t\t\t{\n\t\t\t\t\tnotificationId = Number.parseInt(notificationId, 10);\n\t\t\t\t}\n\n\t\t\t\tconst existingItem = state.collection.get(notificationId);\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn existingItem;\n\t\t\t},\n\t\t\tgetCounter: (state): number =>\n\t\t\t{\n\t\t\t\treturn state.unreadCounter;\n\t\t\t}\n\t\t};\n\t}\n\n\tgetActions(): Object\n\t{\n\t\treturn {\n\t\t\tinitialSet: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (Type.isNumber(payload.total_unread_count))\n\t\t\t\t{\n\t\t\t\t\tstore.commit('setCounter', payload.total_unread_count);\n\t\t\t\t}\n\n\t\t\t\tif (!Type.isArrayFilled(payload.notifications))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst itemsToUpdate = [];\n\t\t\t\tconst itemsToAdd = [];\n\n\t\t\t\tconst currentUserId = Core.getUserId();\n\t\t\t\tpayload.notifications.map(element => {\n\t\t\t\t\treturn NotificationsModel.validate(element, currentUserId);\n\t\t\t\t}).forEach(element => {\n\t\t\t\t\tconst existingItem = store.state.collection.get(element.id);\n\t\t\t\t\tif (existingItem)\n\t\t\t\t\t{\n\t\t\t\t\t\titemsToUpdate.push({id: existingItem.id, fields: {...element}});\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\titemsToAdd.push({...this.getElementState(), ...element});\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tif (itemsToAdd.length > 0)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('add', itemsToAdd);\n\t\t\t\t}\n\t\t\t\tif (itemsToUpdate.length > 0)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('update', itemsToUpdate);\n\t\t\t\t}\n\t\t\t},\n\t\t\tset: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (!Array.isArray(payload) && Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\tpayload = [payload];\n\t\t\t\t}\n\n\t\t\t\tconst itemsToUpdate = [];\n\t\t\t\tconst itemsToAdd = [];\n\t\t\t\tconst currentUserId = Core.getUserId();\n\t\t\t\tpayload.map(element => {\n\t\t\t\t\treturn NotificationsModel.validate(element, currentUserId);\n\t\t\t\t}).forEach(element => {\n\t\t\t\t\tconst existingItem = store.state.collection.get(element.id);\n\t\t\t\t\tif (existingItem)\n\t\t\t\t\t\t{\n\t\t\t\t\t\titemsToUpdate.push({id: existingItem.id, fields: {...element}});\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\titemsToAdd.push({...this.getElementState(), ...element});\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tif (itemsToAdd.length > 0)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('add', itemsToAdd);\n\t\t\t\t\titemsToAdd.forEach(() => {\n\t\t\t\t\t\tstore.commit('increaseCounter');\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tif (itemsToUpdate.length > 0)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('update', itemsToUpdate);\n\t\t\t\t}\n\t\t\t},\n\t\t\tsetSearchResult: (store, payload) =>\n\t\t\t{\n\t\t\t\tconst itemsToUpdate = [];\n\t\t\t\tconst itemsToAdd = [];\n\n\t\t\t\tlet {notifications} = payload;\n\n\t\t\t\tconst skipValidation = !!payload.skipValidation;\n\t\t\t\tif (!skipValidation)\n\t\t\t\t{\n\t\t\t\t\tconst currentUserId = Core.getUserId();\n\t\t\t\t\tnotifications = notifications.map(element => {\n\t\t\t\t\t\treturn NotificationsModel.validate(element, currentUserId);\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tnotifications.forEach(element => {\n\t\t\t\t\tconst existingItem = store.state.searchCollection.get(element.id);\n\t\t\t\t\tif (existingItem)\n\t\t\t\t\t{\n\t\t\t\t\t\titemsToUpdate.push({id: existingItem.id, fields: {...element}});\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\titemsToAdd.push({...this.getElementState(), ...element});\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tif (itemsToAdd.length > 0)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('addSearchResult', itemsToAdd);\n\t\t\t\t}\n\t\t\t\tif (itemsToUpdate.length > 0)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('updateSearchResult', itemsToUpdate);\n\t\t\t\t}\n\t\t\t},\n\t\t\tread: (store, payload) =>\n\t\t\t{\n\t\t\t\tpayload.ids.forEach(notificationId => {\n\t\t\t\t\tconst existingItem = store.state.collection.get(notificationId);\n\t\t\t\t\tif (!existingItem || existingItem.read === payload.read)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (payload.read)\n\t\t\t\t\t{\n\t\t\t\t\t\tstore.commit('decreaseCounter');\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tstore.commit('increaseCounter');\n\t\t\t\t\t}\n\n\t\t\t\t\tstore.commit('read', {\n\t\t\t\t\t\tid: existingItem.id,\n\t\t\t\t\t\tread: payload.read,\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t},\n\t\t\treadAll: (store) =>\n\t\t\t{\n\t\t\t\tstore.commit('readAll');\n\t\t\t\tstore.commit('setCounter', 0);\n\t\t\t},\n\t\t\tdelete: (store, payload) =>\n\t\t\t{\n\t\t\t\tconst existingItem = store.state.collection.get(payload.id);\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (existingItem.read === false)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('decreaseCounter');\n\t\t\t\t}\n\n\t\t\t\tstore.commit('delete', {id: existingItem.id});\n\t\t\t},\n\t\t\tclearSearchResult: (store) =>\n\t\t\t{\n\t\t\t\tstore.commit('clearSearchResult');\n\t\t\t},\n\t\t\tsetCounter: (store, payload) =>\n\t\t\t{\n\t\t\t\tstore.commit('setCounter', payload);\n\t\t\t}\n\t\t};\n\t}\n\n\tgetMutations()\n\t{\n\t\treturn {\n\t\t\tadd: (state, payload) =>\n\t\t\t{\n\t\t\t\tpayload.forEach(item => {\n\t\t\t\t\tstate.collection.set(item.id, item);\n\t\t\t\t});\n\t\t\t},\n\t\t\taddSearchResult: (state, payload) =>\n\t\t\t{\n\t\t\t\tpayload.forEach(item => {\n\t\t\t\t\tstate.searchCollection.set(item.id, item);\n\t\t\t\t});\n\t\t\t},\n\t\t\tupdate: (state, payload) =>\n\t\t\t{\n\t\t\t\tpayload.forEach(item => {\n\t\t\t\t\tstate.collection.set(item.id, {\n\t\t\t\t\t\t...state.collection.get(item.id),\n\t\t\t\t\t\t...item.fields\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t},\n\t\t\tupdateSearchResult: (state, payload) =>\n\t\t\t{\n\t\t\t\tpayload.forEach(item => {\n\t\t\t\t\tstate.searchCollection.set(item.id, {\n\t\t\t\t\t\t...state.searchCollection.get(item.id),\n\t\t\t\t\t\t...item.fields\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t},\n\t\t\tdelete: (state, payload) =>\n\t\t\t{\n\t\t\t\tstate.collection.delete(payload.id);\n\t\t\t},\n\t\t\tread: (state, payload) =>\n\t\t\t{\n\t\t\t\tstate.collection.set(payload.id, {\n\t\t\t\t\t...state.collection.get(payload.id),\n\t\t\t\t\tread: payload.read\n\t\t\t\t});\n\t\t\t},\n\t\t\treadAll: (state) =>\n\t\t\t{\n\t\t\t\t[...state.collection.values()].forEach(item => {\n\t\t\t\t\tif (!item.read)\n\t\t\t\t\t{\n\t\t\t\t\t\titem.read = true;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\t\t\tsetCounter: (state, payload) =>\n\t\t\t{\n\t\t\t\tstate.unreadCounter = Number.parseInt(payload, 10);\n\t\t\t},\n\t\t\tdecreaseCounter: (state) =>\n\t\t\t{\n\t\t\t\tif (state.unreadCounter > 0)\n\t\t\t\t{\n\t\t\t\t\tstate.unreadCounter--;\n\t\t\t\t}\n\t\t\t},\n\t\t\tincreaseCounter: (state) =>\n\t\t\t{\n\t\t\t\tstate.unreadCounter++;\n\t\t\t},\n\t\t\tclearSearchResult: (state) =>\n\t\t\t{\n\t\t\t\tstate.searchCollection.clear();\n\t\t\t}\n\t\t};\n\t}\n\n\tstatic validate(fields: Object)\n\t{\n\t\tconst result = {};\n\n\t\tif (Type.isString(fields.id) || Type.isNumber(fields.id))\n\t\t{\n\t\t\tresult.id = fields.id;\n\t\t}\n\n\t\tif (Type.isNumber(fields.author_id))\n\t\t{\n\t\t\tresult.authorId = fields.author_id;\n\t\t}\n\t\telse if (Type.isNumber(fields.userId))\n\t\t{\n\t\t\tresult.authorId = fields.userId;\n\t\t}\n\n\t\tif (!Type.isNil(fields.date))\n\t\t{\n\t\t\tresult.date = Utils.date.cast(fields.date);\n\t\t}\n\n\t\tif (Type.isString(fields.notify_title))\n\t\t{\n\t\t\tresult.title = fields.notify_title;\n\t\t}\n\t\telse if (Type.isString(fields.title))\n\t\t{\n\t\t\tresult.title = fields.title;\n\t\t}\n\n\t\tif (Type.isString(fields.text) || Type.isNumber(fields.text))\n\t\t{\n\t\t\tresult.text = Text.decode(fields.text.toString());\n\t\t}\n\n\t\tif (Type.isObjectLike(fields.params))\n\t\t{\n\t\t\tresult.params = fields.params;\n\t\t}\n\n\t\tif (Type.isArray(fields.replaces))\n\t\t{\n\t\t\tresult.replaces = fields.replaces;\n\t\t}\n\n\t\tif (!Type.isNil(fields.notify_buttons))\n\t\t{\n\t\t\tresult.notifyButtons = JSON.parse(fields.notify_buttons);\n\t\t}\n\t\telse if (!Type.isNil(fields.buttons))\n\t\t{\n\t\t\tresult.notifyButtons = fields.buttons.map(button => {\n\t\t\t\treturn {\n\t\t\t\t\tCOMMAND: 'notifyConfirm',\n\t\t\t\t\tCOMMAND_PARAMS: `${result.id}|${button.VALUE}`,\n\t\t\t\t\tTEXT: `${button.TITLE}`,\n\t\t\t\t\tTYPE: 'BUTTON',\n\t\t\t\t\tDISPLAY: 'LINE',\n\t\t\t\t\tBG_COLOR: (button.VALUE === 'Y' ? '#8bc84b' : '#ef4b57'),\n\t\t\t\t\tTEXT_COLOR: '#fff',\n\t\t\t\t};\n\t\t\t});\n\t\t}\n\n\t\tif (fields.notify_type === NotificationTypesCodes.confirm || fields.type === NotificationTypesCodes.confirm)\n\t\t{\n\t\t\tresult.sectionCode = NotificationTypesCodes.confirm;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tresult.sectionCode = NotificationTypesCodes.simple;\n\t\t}\n\n\t\tif (!Type.isNil(fields.notify_read))\n\t\t{\n\t\t\tresult.read = fields.notify_read === 'Y';\n\t\t}\n\t\telse if (!Type.isNil(fields.read))\n\t\t{\n\t\t\tresult.read = fields.read === 'Y';\n\t\t}\n\n\t\tif (Type.isString(fields.setting_name))\n\t\t{\n\t\t\tresult.settingName = fields.setting_name;\n\t\t}\n\t\telse if (Type.isString(fields.settingName))\n\t\t{\n\t\t\tresult.settingName = fields.settingName;\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tsortByType(a, b)\n\t{\n\t\tif (a.sectionCode === NotificationTypesCodes.confirm && b.sectionCode !== NotificationTypesCodes.confirm)\n\t\t{\n\t\t\treturn -1;\n\t\t}\n\t\telse if (a.sectionCode !== NotificationTypesCodes.confirm && b.sectionCode === NotificationTypesCodes.confirm)\n\t\t{\n\t\t\treturn 1;\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn b.id - a.id;\n\t\t}\n\t}\n}\n","import {BuilderModel} from 'ui.vue3.vuex';\nimport {Type} from 'main.core';\n\nimport {Utils} from 'im.v2.lib.utils';\n\nimport type {ImModelSidebarLinkItem} from '../registry';\n\ntype LinksState = {\n\tcollection: {[chatId: number]: Map<number, ImModelSidebarLinkItem>},\n\tcounters: {[chatId: number]: number},\n};\n\nexport class LinksModel extends BuilderModel\n{\n\tgetState(): LinksState\n\t{\n\t\treturn {\n\t\t\tcollection: {},\n\t\t\tcounters: {}\n\t\t};\n\t}\n\n\tgetGetters()\n\t{\n\t\treturn {\n\t\t\tget: (state) => (chatId: number): ImModelSidebarLinkItem[] => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\treturn [...state.collection[chatId].values()].sort((a, b) => b.id - a.id);\n\t\t\t},\n\t\t\tgetSize: (state) => (chatId: number): number => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[chatId].size;\n\t\t\t},\n\t\t\tgetCounter: (state) => (chatId: number): number => {\n\t\t\t\tif (!state.counters[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn state.counters[chatId];\n\t\t\t}\n\t\t};\n\t}\n\n\tgetElementState(): ImModelSidebarLinkItem\n\t{\n\t\treturn {\n\t\t\tid: 0,\n\t\t\tmessageId: 0,\n\t\t\tchatId: 0,\n\t\t\tauthorId: 0,\n\t\t\tsource: '',\n\t\t\tdate: new Date(),\n\t\t\trichData: {\n\t\t\t\tid: null,\n\t\t\t\tdescription: null,\n\t\t\t\tlink: null,\n\t\t\t\tname: null,\n\t\t\t\tpreviewUrl: null,\n\t\t\t\ttype: null,\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions(): Object\n\t{\n\t\treturn {\n\t\t\tsetCounter: (store, payload) => {\n\t\t\t\tif (!Type.isNumber(payload.counter) || !Type.isNumber(payload.chatId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setCounter', payload);\n\t\t\t},\n\t\t\tset: (store, payload) => {\n\t\t\t\tconst {chatId, links} = payload;\n\t\t\t\tif (!Type.isArrayFilled(links) || !Type.isNumber(chatId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!store.state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\tstore.state.collection[chatId] = new Map();\n\t\t\t\t}\n\n\t\t\t\tlinks.forEach(link => {\n\t\t\t\t\tconst preparedLink = {...this.getElementState(), ...this.validate(link)};\n\t\t\t\t\tstore.commit('add', {chatId, link: preparedLink});\n\t\t\t\t});\n\t\t\t},\n\t\t\tdelete: (store, payload) => {\n\t\t\t\tconst {chatId, id} = payload;\n\t\t\t\tif (!Type.isNumber(id) || !Type.isNumber(chatId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!store.state.collection[chatId] || !store.state.collection[chatId].has(id))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('delete', {chatId, id});\n\t\t\t}\n\t\t};\n\t}\n\n\tgetMutations(): Object\n\t{\n\t\treturn {\n\t\t\tsetCounter: (state, payload) => {\n\t\t\t\tconst {chatId, counter} = payload;\n\t\t\t\tstate.counters[chatId] = counter;\n\t\t\t},\n\t\t\tadd: (state, payload: {chatId: number, link: ImModelSidebarLinkItem}) => {\n\t\t\t\tconst {chatId, link} = payload;\n\t\t\t\tstate.collection[chatId].set(link.id, link);\n\t\t\t},\n\t\t\tdelete: (state, payload: {chatId: number, id: number}) => {\n\t\t\t\tconst {chatId, id} = payload;\n\t\t\t\tstate.collection[chatId].delete(id);\n\t\t\t\tstate.counters[chatId]--;\n\t\t\t}\n\t\t};\n\t}\n\n\tvalidate(fields: Object): ImModelSidebarLinkItem\n\t{\n\t\tconst result = {\n\t\t\trichData: {}\n\t\t};\n\n\t\tif (Type.isNumber(fields.id))\n\t\t{\n\t\t\tresult.id = fields.id;\n\t\t}\n\n\t\tif (Type.isNumber(fields.messageId))\n\t\t{\n\t\t\tresult.messageId = fields.messageId;\n\t\t}\n\n\t\tif (Type.isNumber(fields.chatId))\n\t\t{\n\t\t\tresult.chatId = fields.chatId;\n\t\t}\n\n\t\tif (Type.isNumber(fields.authorId))\n\t\t{\n\t\t\tresult.authorId = fields.authorId;\n\t\t}\n\n\t\tif (Type.isString(fields.url.source))\n\t\t{\n\t\t\tresult.source = fields.url.source;\n\t\t}\n\n\t\tif (Type.isString(fields.dateCreate))\n\t\t{\n\t\t\tresult.date = Utils.date.cast(fields.dateCreate);\n\t\t}\n\n\t\tif (Type.isPlainObject(fields.url.richData))\n\t\t{\n\t\t\tresult.richData = this.validateRichData(fields.url.richData);\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tvalidateRichData(richData: Object): Object\n\t{\n\t\tconst result = {};\n\n\t\tif (Type.isNumber(richData.id))\n\t\t{\n\t\t\tresult.id = richData.id;\n\t\t}\n\n\t\tif (Type.isString(richData.description))\n\t\t{\n\t\t\tresult.description = richData.description;\n\t\t}\n\n\t\tif (Type.isString(richData.link))\n\t\t{\n\t\t\tresult.link = richData.link;\n\t\t}\n\n\t\tif (Type.isString(richData.name))\n\t\t{\n\t\t\tresult.name = richData.name;\n\t\t}\n\n\t\tif (Type.isString(richData.previewUrl))\n\t\t{\n\t\t\tresult.previewUrl = richData.previewUrl;\n\t\t}\n\n\t\tif (Type.isString(richData.type))\n\t\t{\n\t\t\tresult.type = richData.type;\n\t\t}\n\n\t\treturn result;\n\t}\n}","import {Type} from 'main.core';\nimport {BuilderModel} from 'ui.vue3.vuex';\n\nimport {Utils} from 'im.v2.lib.utils';\n\nimport type {ImModelSidebarFavoriteItem} from '../registry';\n\ntype FavoritesState = {\n\tcollection: {[chatId: number]: Map<number, ImModelSidebarFavoriteItem>},\n\tcounters: {[chatId: number]: number},\n};\n\nexport class FavoritesModel extends BuilderModel\n{\n\tgetState(): FavoritesState\n\t{\n\t\treturn {\n\t\t\tcollection: {},\n\t\t\tcounters: {},\n\t\t};\n\t}\n\n\tgetElementState(): ImModelSidebarFavoriteItem\n\t{\n\t\treturn {\n\t\t\tid: 0,\n\t\t\tmessageId: 0,\n\t\t\tchatId: 0,\n\t\t\tauthorId: 0,\n\t\t\tdate: new Date(),\n\t\t};\n\t}\n\n\tgetGetters(): Object\n\t{\n\t\treturn {\n\t\t\tget: (state) => (chatId: number): ImModelSidebarFavoriteItem[] => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\treturn [...state.collection[chatId].values()].sort((a, b) => b.id - a.id);\n\t\t\t},\n\t\t\tgetSize: (state) => (chatId: number): number => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[chatId].size;\n\t\t\t},\n\t\t\tgetCounter: (state) => (chatId: number): number => {\n\t\t\t\tif (state.counters[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn state.counters[chatId];\n\t\t\t\t}\n\n\t\t\t\treturn 0;\n\t\t\t},\n\t\t\tisFavoriteMessage: (state) => (chatId: number, messageId: number): boolean => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst chatFavorites = Object.fromEntries(state.collection[chatId]);\n\t\t\t\tconst targetMessage = Object.values(chatFavorites).find(element => element.messageId === messageId);\n\n\t\t\t\treturn !!targetMessage;\n\t\t\t}\n\t\t};\n\t}\n\n\tgetActions(): Object\n\t{\n\t\treturn {\n\t\t\tsetCounter: (store, payload) => {\n\t\t\t\tif (!Type.isNumber(payload.counter) || !Type.isNumber(payload.chatId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setCounter', payload);\n\t\t\t},\n\t\t\tset: (store, payload) => {\n\t\t\t\tif (Type.isNumber(payload.favorites))\n\t\t\t\t{\n\t\t\t\t\tpayload.favorites = [payload.favorites];\n\t\t\t\t}\n\t\t\t\tconst {chatId, favorites} = payload;\n\n\t\t\t\tif (!Type.isArrayFilled(favorites) || !Type.isNumber(chatId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!store.state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\tstore.state.collection[chatId] = new Map();\n\t\t\t\t}\n\n\t\t\t\tfavorites.forEach(favorite => {\n\t\t\t\t\tconst preparedFavoriteMessage = {...this.getElementState(), ...this.validate(favorite)};\n\t\t\t\t\tstore.commit('add', {chatId, favorite: preparedFavoriteMessage});\n\t\t\t\t});\n\t\t\t},\n\t\t\tdelete: (store, payload) => {\n\t\t\t\tconst {chatId, id} = payload;\n\t\t\t\tif (!Type.isNumber(id) || !Type.isNumber(chatId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!store.state.collection[chatId] || !store.state.collection[chatId].has(id))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('delete', {chatId, id});\n\t\t\t},\n\t\t\tdeleteByMessageId: (store, payload: {chatId: number, messageId: number}) => {\n\t\t\t\tconst {chatId, messageId} = payload;\n\t\t\t\tif (!store.state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst chatCollection = store.state.collection[chatId];\n\t\t\t\tlet targetLinkId = null;\n\t\t\t\tfor (const [linkId, linkObject] of chatCollection)\n\t\t\t\t{\n\t\t\t\t\tif (linkObject.messageId === messageId)\n\t\t\t\t\t{\n\t\t\t\t\t\ttargetLinkId = linkId;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (!targetLinkId)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('delete', {chatId, id: targetLinkId});\n\t\t\t}\n\t\t};\n\t}\n\n\tgetMutations(): Object\n\t{\n\t\treturn {\n\t\t\tsetCounter: (state, payload) => {\n\t\t\t\tconst {chatId, counter} = payload;\n\t\t\t\tstate.counters[chatId] = counter;\n\t\t\t},\n\t\t\tadd: (state, payload: {chatId: number, favorite: ImModelSidebarFavoriteItem}) => {\n\t\t\t\tconst {chatId, favorite} = payload;\n\t\t\t\tstate.collection[chatId].set(favorite.id, favorite);\n\t\t\t},\n\t\t\tdelete: (state, payload: {chatId: number, id: number}) => {\n\t\t\t\tconst {chatId, id} = payload;\n\t\t\t\tstate.collection[chatId].delete(id);\n\t\t\t\tstate.counters[chatId]--;\n\t\t\t}\n\t\t};\n\t}\n\n\tvalidate(fields: Object): ImModelSidebarFavoriteItem\n\t{\n\t\tconst result = {};\n\n\t\tif (Type.isNumber(fields.id))\n\t\t{\n\t\t\tresult.id = fields.id;\n\t\t}\n\n\t\tif (Type.isNumber(fields.messageId))\n\t\t{\n\t\t\tresult.messageId = fields.messageId;\n\t\t}\n\n\t\tif (Type.isNumber(fields.chatId))\n\t\t{\n\t\t\tresult.chatId = fields.chatId;\n\t\t}\n\n\t\tif (Type.isNumber(fields.authorId))\n\t\t{\n\t\t\tresult.authorId = fields.authorId;\n\t\t}\n\n\t\tif (Type.isString(fields.dateCreate))\n\t\t{\n\t\t\tresult.date = Utils.date.cast(fields.dateCreate);\n\t\t}\n\n\t\treturn result;\n\t}\n}\n","import {Type} from 'main.core';\nimport {BuilderModel} from 'ui.vue3.vuex';\n\ntype MembersState = {\n\tcollection: {[chatId: number]: Set<number>},\n};\n\nexport class MembersModel extends BuilderModel\n{\n\tgetState(): MembersState\n\t{\n\t\treturn {\n\t\t\tcollection: {},\n\t\t};\n\t}\n\n\tgetGetters()\n\t{\n\t\treturn {\n\t\t\tget: (state) => (chatId: number): Array =>\n\t\t\t{\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\treturn [...state.collection[chatId]];\n\t\t\t},\n\t\t\tgetSize: (state) => (chatId: number): number => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[chatId].size;\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions(): Object\n\t{\n\t\treturn {\n\t\t\tset: (store, payload) =>\n\t\t\t{\n\t\t\t\tconst {chatId, users} = payload;\n\t\t\t\tif (!Type.isArray(users) || !Type.isNumber(chatId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (users.length > 0)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('set', {chatId, users});\n\t\t\t\t}\n\t\t\t},\n\t\t\tdelete: (store, payload) => {\n\t\t\t\tconst {chatId, userId} = payload;\n\t\t\t\tif (!Type.isNumber(chatId) || !Type.isNumber(userId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!store.state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('delete', {userId, chatId});\n\t\t\t}\n\t\t};\n\t}\n\n\tgetMutations(): Object\n\t{\n\t\treturn {\n\t\t\tset: (state, payload) =>\n\t\t\t{\n\t\t\t\tif (!state.collection[payload.chatId])\n\t\t\t\t{\n\t\t\t\t\tstate.collection[payload.chatId] = new Set(payload.users);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tpayload.users.forEach(id => {\n\t\t\t\t\t\tstate.collection[payload.chatId].add(id);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t},\n\t\t\tdelete: (state, payload: {chatId: number, userId: number}) => {\n\t\t\t\tconst {chatId, userId} = payload;\n\t\t\t\tstate.collection[chatId].delete(userId);\n\t\t\t}\n\t\t};\n\t}\n}","import {BuilderModel} from 'ui.vue3.vuex';\nimport {Type} from 'main.core';\n\nimport {Utils} from 'im.v2.lib.utils';\n\nimport type {ImModelSidebarTaskItem} from '../registry';\n\ntype TasksState = {\n\tcollection: {[chatId: number]: Map<number, ImModelSidebarTaskItem>},\n};\n\nexport class TasksModel extends BuilderModel\n{\n\tgetState(): TasksState\n\t{\n\t\treturn {\n\t\t\tcollection: {},\n\t\t};\n\t}\n\n\tgetElementState(): ImModelSidebarTaskItem\n\t{\n\t\treturn {\n\t\t\tid: 0,\n\t\t\tmessageId: 0,\n\t\t\tchatId: 0,\n\t\t\tauthorId: 0,\n\t\t\tdate: new Date(),\n\t\t\ttask: {\n\t\t\t\tid: 0,\n\t\t\t\ttitle: '',\n\t\t\t\tcreatorId: 0,\n\t\t\t\tresponsibleId: 0,\n\t\t\t\tstatus: 0,\n\t\t\t\tstatusTitle: '',\n\t\t\t\tdeadline: new Date(),\n\t\t\t\tstate: '',\n\t\t\t\tcolor: '',\n\t\t\t\tsource: ''\n\t\t\t}\n\t\t};\n\t}\n\n\tgetGetters(): Object\n\t{\n\t\treturn {\n\t\t\tget: (state) => (chatId: number): ImModelSidebarTaskItem[] => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\treturn [...state.collection[chatId].values()].sort((a, b) => b.id - a.id);\n\t\t\t},\n\t\t\tgetSize: (state) => (chatId: number): number => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[chatId].size;\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions(): Object\n\t{\n\t\treturn {\n\t\t\tset: (store, payload) => {\n\t\t\t\tconst {chatId, tasks} = payload;\n\t\t\t\tif (!Type.isArrayFilled(tasks) || !Type.isNumber(chatId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!store.state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\tstore.state.collection[chatId] = new Map();\n\t\t\t\t}\n\n\t\t\t\ttasks.forEach(task => {\n\t\t\t\t\tconst preparedTask = {...this.getElementState(), ...this.validate(task)};\n\t\t\t\t\tstore.commit('add', {chatId, task: preparedTask});\n\t\t\t\t});\n\t\t\t},\n\t\t\tdelete: (store, payload) => {\n\t\t\t\tconst {chatId, id} = payload;\n\t\t\t\tif (!Type.isNumber(chatId) || !Type.isNumber(id))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!store.state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('delete', {id, chatId});\n\t\t\t}\n\t\t};\n\t}\n\n\tgetMutations(): Object\n\t{\n\t\treturn {\n\t\t\tadd: (state, payload: {chatId: number, task: ImModelSidebarTaskItem}) => {\n\t\t\t\tconst {chatId, task} = payload;\n\t\t\t\tstate.collection[chatId].set(task.id, task);\n\t\t\t},\n\t\t\tdelete: (state, payload: {id: number, chatId: number}) => {\n\t\t\t\tconst {id, chatId} = payload;\n\t\t\t\tstate.collection[chatId].delete(id);\n\t\t\t}\n\t\t};\n\t}\n\n\tvalidate(fields: Object): ImModelSidebarTaskItem\n\t{\n\t\tconst result = {\n\t\t\ttask: {}\n\t\t};\n\n\t\tif (Type.isNumber(fields.id))\n\t\t{\n\t\t\tresult.id = fields.id;\n\t\t}\n\n\t\tif (Type.isNumber(fields.messageId))\n\t\t{\n\t\t\tresult.messageId = fields.messageId;\n\t\t}\n\n\t\tif (Type.isNumber(fields.chatId))\n\t\t{\n\t\t\tresult.chatId = fields.chatId;\n\t\t}\n\n\t\tif (Type.isNumber(fields.authorId))\n\t\t{\n\t\t\tresult.authorId = fields.authorId;\n\t\t}\n\n\t\tif (Type.isString(fields.dateCreate))\n\t\t{\n\t\t\tresult.date = Utils.date.cast(fields.dateCreate);\n\t\t}\n\n\t\tif (Type.isPlainObject(fields.task))\n\t\t{\n\t\t\tresult.task = this.validateTask(fields.task);\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tvalidateTask(task)\n\t{\n\t\tconst result = {};\n\n\t\tif (Type.isNumber(task.id))\n\t\t{\n\t\t\tresult.id = task.id;\n\t\t}\n\n\t\tif (Type.isString(task.title))\n\t\t{\n\t\t\tresult.title = task.title;\n\t\t}\n\n\t\tif (Type.isNumber(task.creatorId))\n\t\t{\n\t\t\tresult.creatorId = task.creatorId;\n\t\t}\n\n\t\tif (Type.isNumber(task.responsibleId))\n\t\t{\n\t\t\tresult.responsibleId = task.responsibleId;\n\t\t}\n\n\t\tif (Type.isNumber(task.status))\n\t\t{\n\t\t\tresult.status = task.status;\n\t\t}\n\n\t\tif (Type.isString(task.statusTitle))\n\t\t{\n\t\t\tresult.statusTitle = task.statusTitle;\n\t\t}\n\n\t\tif (Type.isString(task.deadline))\n\t\t{\n\t\t\tresult.deadline = Utils.date.cast(task.deadline);\n\t\t}\n\n\t\tif (Type.isString(task.state))\n\t\t{\n\t\t\tresult.state = task.state;\n\t\t}\n\n\t\tif (Type.isString(task.color))\n\t\t{\n\t\t\tresult.color = task.color;\n\t\t}\n\n\t\tif (Type.isString(task.source))\n\t\t{\n\t\t\tresult.source = task.source;\n\t\t}\n\n\t\treturn result;\n\t}\n}\n","import {Type} from 'main.core';\nimport {BuilderModel} from 'ui.vue3.vuex';\n\nimport {Utils} from 'im.v2.lib.utils';\n\nimport type {ImModelSidebarMeetingItem} from '../registry';\n\ntype MeetingsState = {\n\tcollection: {[chatId: number]: Map<number, ImModelSidebarMeetingItem>},\n};\n\nexport class MeetingsModel extends BuilderModel\n{\n\tgetState(): MeetingsState\n\t{\n\t\treturn {\n\t\t\tcollection: {},\n\t\t};\n\t}\n\n\tgetElementState(): ImModelSidebarMeetingItem\n\t{\n\t\treturn {\n\t\t\tid: 0,\n\t\t\tmessageId: 0,\n\t\t\tchatId: 0,\n\t\t\tauthorId: 0,\n\t\t\tdate: new Date(),\n\t\t\tmeeting: {\n\t\t\t\tid: 0,\n\t\t\t\ttitle: '',\n\t\t\t\tdateFrom: new Date(),\n\t\t\t\tdateTo: new Date(),\n\t\t\t\tsource: ''\n\t\t\t}\n\t\t};\n\t}\n\n\tgetGetters(): Object\n\t{\n\t\treturn {\n\t\t\tget: (state) => (chatId: number): ImModelSidebarMeetingItem[] => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\treturn [...state.collection[chatId].values()].sort((a, b) => b.id - a.id);\n\t\t\t},\n\t\t\tgetSize: (state) => (chatId: string): number => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[chatId].size;\n\t\t\t}\n\t\t};\n\t}\n\n\tgetActions(): Object\n\t{\n\t\treturn {\n\t\t\tset: (store, payload) => {\n\t\t\t\tconst {chatId, meetings} = payload;\n\t\t\t\tif (!Type.isArrayFilled(meetings) || !Type.isNumber(chatId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!store.state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\tstore.state.collection[chatId] = new Map();\n\t\t\t\t}\n\n\t\t\t\tmeetings.forEach(meeting => {\n\t\t\t\t\tconst preparedMeeting = {...this.getElementState(), ...this.validate(meeting)};\n\t\t\t\t\tstore.commit('add', {chatId, meeting: preparedMeeting});\n\t\t\t\t});\n\t\t\t},\n\t\t\tdelete: (store, payload) => {\n\t\t\t\tconst {chatId, id} = payload;\n\t\t\t\tif (!Type.isNumber(chatId) || !Type.isNumber(id))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!store.state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('delete', {id, chatId});\n\t\t\t}\n\t\t};\n\t}\n\n\tgetMutations(): Object\n\t{\n\t\treturn {\n\t\t\tadd: (state, payload: {chatId: number, meeting: ImModelSidebarMeetingItem}) => {\n\t\t\t\tconst {chatId, meeting} = payload;\n\t\t\t\tstate.collection[chatId].set(meeting.id, meeting);\n\t\t\t},\n\t\t\tdelete: (state, payload: {id: number, chatId: number}) => {\n\t\t\t\tconst {id, chatId} = payload;\n\t\t\t\tstate.collection[chatId].delete(id);\n\t\t\t}\n\t\t};\n\t}\n\n\tvalidate(fields: Object): ImModelSidebarMeetingItem\n\t{\n\t\tconst result = {\n\t\t\tmeeting: {}\n\t\t};\n\n\t\tif (Type.isNumber(fields.id))\n\t\t{\n\t\t\tresult.id = fields.id;\n\t\t}\n\n\t\tif (Type.isNumber(fields.messageId))\n\t\t{\n\t\t\tresult.messageId = fields.messageId;\n\t\t}\n\n\t\tif (Type.isNumber(fields.chatId))\n\t\t{\n\t\t\tresult.chatId = fields.chatId;\n\t\t}\n\n\t\tif (Type.isNumber(fields.authorId))\n\t\t{\n\t\t\tresult.authorId = fields.authorId;\n\t\t}\n\n\t\tif (Type.isString(fields.dateCreate))\n\t\t{\n\t\t\tresult.date = Utils.date.cast(fields.dateCreate);\n\t\t}\n\n\t\tif (Type.isPlainObject(fields.calendar))\n\t\t{\n\t\t\tresult.meeting = this.validateMeeting(fields.calendar);\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tvalidateMeeting(meeting)\n\t{\n\t\tconst result = {};\n\n\t\tif (Type.isNumber(meeting.id))\n\t\t{\n\t\t\tresult.id = meeting.id;\n\t\t}\n\n\t\tif (Type.isString(meeting.title))\n\t\t{\n\t\t\tresult.title = meeting.title;\n\t\t}\n\n\t\tif (Type.isString(meeting.dateFrom))\n\t\t{\n\t\t\tresult.dateFrom = Utils.date.cast(meeting.dateFrom);\n\t\t}\n\n\t\tif (Type.isString(meeting.dateTo))\n\t\t{\n\t\t\tresult.dateTo = Utils.date.cast(meeting.dateTo);\n\t\t}\n\n\t\tif (Type.isString(meeting.source))\n\t\t{\n\t\t\tresult.source = meeting.source;\n\t\t}\n\n\t\treturn result;\n\t}\n}\n","import {Type} from 'main.core';\nimport {BuilderModel} from 'ui.vue3.vuex';\n\nimport {SidebarFileTypes} from 'im.v2.const';\nimport {Utils} from 'im.v2.lib.utils';\n\nimport type {ImModelSidebarFileItem} from '../registry';\n\ntype FilesState = {\n\tcollection: {\n\t\t[chatId: number]: {\n\t\t\t[SidebarFileTypes: string]: Map<number, ImModelSidebarFileItem>\n\t\t}\n\t},\n};\n\nexport class FilesModel extends BuilderModel\n{\n\tgetState(): FilesState\n\t{\n\t\treturn {\n\t\t\tcollection: {},\n\t\t};\n\t}\n\n\tgetElementState(): ImModelSidebarFileItem\n\t{\n\t\treturn {\n\t\t\tid: 0,\n\t\t\tmessageId: 0,\n\t\t\tchatId: 0,\n\t\t\tauthorId: 0,\n\t\t\tdate: new Date(),\n\t\t\tfileId: 0,\n\t\t};\n\t}\n\n\tgetGetters(): Object\n\t{\n\t\treturn {\n\t\t\tget: (state) => (chatId: number, subType: string): ImModelSidebarFileItem[] => {\n\t\t\t\tif (!state.collection[chatId] || !state.collection[chatId][subType])\n\t\t\t\t{\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\treturn [...state.collection[chatId][subType].values()].sort((a, b) => b.id - a.id);\n\t\t\t},\n\n\t\t\tgetLatest: (state, getters, rootState, rootGetters) => (chatId: number): ImModelSidebarFileItem[] => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\tlet media = [];\n\t\t\t\tlet audio = [];\n\t\t\t\tlet documents = [];\n\t\t\t\tlet other = [];\n\n\t\t\t\tif (state.collection[chatId][SidebarFileTypes.media])\n\t\t\t\t{\n\t\t\t\t\tmedia = [...state.collection[chatId][SidebarFileTypes.media].values()];\n\t\t\t\t}\n\t\t\t\tif (state.collection[chatId][SidebarFileTypes.audio])\n\t\t\t\t{\n\t\t\t\t\taudio = [...state.collection[chatId][SidebarFileTypes.audio].values()];\n\t\t\t\t}\n\t\t\t\tif (state.collection[chatId][SidebarFileTypes.document])\n\t\t\t\t{\n\t\t\t\t\tdocuments = [...state.collection[chatId][SidebarFileTypes.document].values()];\n\t\t\t\t}\n\t\t\t\tif (state.collection[chatId][SidebarFileTypes.other])\n\t\t\t\t{\n\t\t\t\t\tother = [...state.collection[chatId][SidebarFileTypes.other].values()];\n\t\t\t\t}\n\n\t\t\t\tconst sortedFlatCollection = [media, audio, documents, other]\n\t\t\t\t\t.flat()\n\t\t\t\t\t.sort((a, b) => b.id - a.id)\n\t\t\t\t;\n\n\t\t\t\treturn this.getTopThreeCompletedFiles(sortedFlatCollection, rootGetters);\n\t\t\t},\n\t\t\tgetLatestUnsorted: (state, getters, rootState, rootGetters) => (chatId: number): ImModelSidebarFileItem[] => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\tlet unsorted = [];\n\n\t\t\t\tif (state.collection[chatId][SidebarFileTypes.fileUnsorted])\n\t\t\t\t{\n\t\t\t\t\tunsorted = [...state.collection[chatId][SidebarFileTypes.fileUnsorted].values()];\n\t\t\t\t}\n\n\t\t\t\tconst sortedCollection = unsorted.sort((a, b) => b.id - a.id);\n\n\t\t\t\treturn this.getTopThreeCompletedFiles(sortedCollection, rootGetters);\n\t\t\t},\n\t\t\tgetSize: (state) => (chatId: string, subType: string): number => {\n\t\t\t\tif (!state.collection[chatId] || !state.collection[chatId][subType])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[chatId][subType].size;\n\t\t\t}\n\t\t};\n\t}\n\n\tgetActions(): Object\n\t{\n\t\treturn {\n\t\t\tset: (store, payload) => {\n\t\t\t\tconst {chatId, files} = payload;\n\t\t\t\tif (!Type.isArrayFilled(files) || !Type.isNumber(chatId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!store.state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\tstore.state.collection[chatId] = {};\n\t\t\t\t}\n\n\t\t\t\tfiles.forEach(file => {\n\t\t\t\t\tconst preparedFile = {...this.getElementState(), ...this.validate(file)};\n\t\t\t\t\tconst {subType} = file;\n\t\t\t\t\tstore.commit('add', {chatId, subType, file: preparedFile});\n\t\t\t\t});\n\t\t\t},\n\t\t\tdelete: (store, payload) => {\n\t\t\t\tconst {chatId, id} = payload;\n\t\t\t\tif (!Type.isNumber(id) || !Type.isNumber(chatId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!store.state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('delete', {chatId, id});\n\t\t\t}\n\t\t};\n\t}\n\n\tgetMutations(): Object\n\t{\n\t\treturn {\n\t\t\tadd: (state, payload: {chatId: number, subType: string, file: ImModelSidebarFileItem}) => {\n\t\t\t\tconst {chatId, file, subType} = payload;\n\t\t\t\tif (!state.collection[chatId][subType])\n\t\t\t\t{\n\t\t\t\t\tstate.collection[chatId][subType] = new Map();\n\t\t\t\t}\n\t\t\t\tstate.collection[chatId][subType].set(file.id, file);\n\t\t\t},\n\t\t\tdelete: (state, payload: {chatId: number, id: number}) => {\n\t\t\t\tconst {chatId, id} = payload;\n\n\t\t\t\tObject.values(SidebarFileTypes).forEach(subType => {\n\t\t\t\t\tif (state.collection[chatId][subType] && state.collection[chatId][subType].has(id))\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.collection[chatId][subType].delete(id);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\t}\n\n\tvalidate(fields: Object): ImModelSidebarFileItem\n\t{\n\t\tconst result = {};\n\n\t\tif (Type.isNumber(fields.id))\n\t\t{\n\t\t\tresult.id = fields.id;\n\t\t}\n\n\t\tif (Type.isNumber(fields.messageId))\n\t\t{\n\t\t\tresult.messageId = fields.messageId;\n\t\t}\n\n\t\tif (Type.isNumber(fields.chatId))\n\t\t{\n\t\t\tresult.chatId = fields.chatId;\n\t\t}\n\n\t\tif (Type.isNumber(fields.authorId))\n\t\t{\n\t\t\tresult.authorId = fields.authorId;\n\t\t}\n\n\t\tif (Type.isString(fields.dateCreate))\n\t\t{\n\t\t\tresult.date = Utils.date.cast(fields.dateCreate);\n\t\t}\n\t\telse if (Type.isString(fields.date))\n\t\t{\n\t\t\tresult.date = Utils.date.cast(fields.date);\n\t\t}\n\n\t\tresult.fileId = Type.isNumber(fields.fileId) ? fields.fileId : result.id;\n\n\t\treturn result;\n\t}\n\n\tgetTopThreeCompletedFiles(collection: ImModelSidebarFileItem[], rootGetters): ImModelSidebarFileItem[]\n\t{\n\t\treturn collection.filter((sidebarFile: ImModelSidebarFileItem) => {\n\t\t\tconst file = rootGetters['files/get'](sidebarFile.fileId, true);\n\n\t\t\treturn file.progress === 100;\n\t\t}).slice(0, 3);\n\t}\n}\n","import {BuilderModel} from 'ui.vue3.vuex';\nimport {Type} from 'main.core';\nimport {LinksModel} from './sidebar/links';\nimport {FavoritesModel} from './sidebar/favorites';\nimport {MembersModel} from './sidebar/members';\nimport {TasksModel} from './sidebar/tasks';\nimport {MeetingsModel} from './sidebar/meeting';\nimport {FilesModel} from './sidebar/files';\n\nexport class SidebarModel extends BuilderModel\n{\n\tgetName(): string\n\t{\n\t\treturn 'sidebar';\n\t}\n\n\tgetNestedModules(): { [moduleName: string]: BuilderModel }\n\t{\n\t\treturn {\n\t\t\tmembers: MembersModel,\n\t\t\tlinks: LinksModel,\n\t\t\tfavorites: FavoritesModel,\n\t\t\ttasks: TasksModel,\n\t\t\tmeetings: MeetingsModel,\n\t\t\tfiles: FilesModel,\n\t\t};\n\t}\n\n\tgetState()\n\t{\n\t\treturn {\n\t\t\tinitedList: new Set(),\n\t\t\tisFilesMigrated: false,\n\t\t\tisLinksMigrated: false\n\t\t};\n\t}\n\n\tgetGetters()\n\t{\n\t\treturn {\n\t\t\tisInited: (state) => (chatId: number): boolean =>\n\t\t\t{\n\t\t\t\treturn state.initedList.has(chatId);\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions()\n\t{\n\t\treturn {\n\t\t\tsetInited: (store, chatId) =>\n\t\t\t{\n\t\t\t\tif (!Type.isNumber(chatId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setInited', chatId);\n\t\t\t},\n\t\t\tsetFilesMigrated: (store, value: boolean) =>\n\t\t\t{\n\t\t\t\tif (!Type.isBoolean(value))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setFilesMigrated', value);\n\t\t\t},\n\t\t\tsetLinksMigrated: (store, value: boolean) =>\n\t\t\t{\n\t\t\t\tif (!Type.isBoolean(value))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setLinksMigrated', value);\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMutations()\n\t{\n\t\treturn {\n\t\t\tsetInited: (state, payload) =>\n\t\t\t{\n\t\t\t\tstate.initedList.add(payload);\n\t\t\t},\n\t\t\tsetFilesMigrated: (state, payload: boolean) =>\n\t\t\t{\n\t\t\t\tstate.isFilesMigrated = payload;\n\t\t\t},\n\t\t\tsetLinksMigrated: (state, payload: boolean) =>\n\t\t\t{\n\t\t\t\tstate.isLinksMigrated = payload;\n\t\t\t},\n\t\t};\n\t}\n}","import {Type} from 'main.core';\nimport {BuilderModel} from 'ui.vue3.vuex';\n\nimport {PlacementType} from 'im.v2.const';\n\nimport type {MarketApplication} from './type/market';\n\nexport class MarketModel extends BuilderModel\n{\n\tgetName(): string\n\t{\n\t\treturn 'market';\n\t}\n\n\tgetState()\n\t{\n\t\treturn {\n\t\t\tcollection: new Map(),\n\t\t\tplacementCollection: {\n\t\t\t\t[PlacementType.contextMenu]: new Set(),\n\t\t\t\t[PlacementType.navigation]: new Set(),\n\t\t\t\t[PlacementType.textarea]: new Set(),\n\t\t\t\t[PlacementType.sidebar]: new Set(),\n\t\t\t\t[PlacementType.smilesSelector]: new Set()\n\t\t\t},\n\t\t};\n\t}\n\n\tgetElementState(): MarketApplication\n\t{\n\t\treturn {\n\t\t\tid: 0,\n\t\t\ttitle: '',\n\t\t\toptions: {\n\t\t\t\trole: '',\n\t\t\t\textranet: '',\n\t\t\t\tcontext: null,\n\t\t\t\twidth: null,\n\t\t\t\theight: null,\n\t\t\t\tcolor: null,\n\t\t\t\ticonName: null\n\t\t\t},\n\t\t\tplacement: '',\n\t\t\torder: 0,\n\t\t\tloadConfiguration: {\n\t\t\t\tID: 0,\n\t\t\t\tPLACEMENT: '',\n\t\t\t\tPLACEMENT_ID: 0,\n\t\t\t},\n\t\t};\n\t}\n\n\tgetGetters()\n\t{\n\t\treturn {\n\t\t\tgetByPlacement: (state) => (placement: string): MarketApplication[] =>\n\t\t\t{\n\t\t\t\tconst appIds = [...state.placementCollection[placement].values()];\n\n\t\t\t\treturn appIds.map(id => {\n\t\t\t\t\treturn state.collection.get(id);\n\t\t\t\t});\n\t\t\t},\n\t\t\tgetById: (state) => (id: number): number =>\n\t\t\t{\n\t\t\t\treturn state.collection.get(id);\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions()\n\t{\n\t\treturn {\n\t\t\tset: (store, payload) =>\n\t\t\t{\n\t\t\t\tconst {items} = payload;\n\n\t\t\t\titems.forEach((item: MarketApplication) => {\n\t\t\t\t\tstore.commit('setPlacementCollection', {placement: item.placement, id: item.id});\n\t\t\t\t\tstore.commit('setCollection', item);\n\t\t\t\t});\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMutations()\n\t{\n\t\treturn {\n\t\t\tsetPlacementCollection: (state, payload: MarketApplication) =>\n\t\t\t{\n\t\t\t\tstate.placementCollection[payload.placement].add(payload.id);\n\t\t\t},\n\t\t\tsetCollection: (state, payload: MarketApplication) =>\n\t\t\t{\n\t\t\t\tstate.collection.set(payload.id, {...this.getElementState(), ...this.#validate(payload)});\n\t\t\t},\n\t\t};\n\t}\n\n\t#validate(app: Object): MarketApplication\n\t{\n\t\tconst result = {};\n\n\t\tif (Type.isNumber(app.id) || Type.isStringFilled(app.id))\n\t\t{\n\t\t\tresult.id = app.id.toString();\n\t\t}\n\n\t\tif (Type.isString(app.title))\n\t\t{\n\t\t\tresult.title = app.title;\n\t\t}\n\n\t\tresult.options = this.#validateOptions(app.options);\n\n\t\tif (Type.isString(app.placement))\n\t\t{\n\t\t\tresult.placement = app.placement;\n\t\t}\n\n\t\tif (Type.isNumber(app.order))\n\t\t{\n\t\t\tresult.order = app.order;\n\t\t}\n\n\t\tresult.loadConfiguration = this.#validateLoadConfiguration(app.loadConfiguration);\n\n\t\treturn result;\n\t}\n\n\t#validateOptions(options: Object)\n\t{\n\t\tconst result = {\n\t\t\tcontext: null,\n\t\t\twidth: null,\n\t\t\theight: null,\n\t\t\tcolor: null,\n\t\t\ticonName: null\n\t\t};\n\n\t\tif (!Type.isPlainObject(options))\n\t\t{\n\t\t\treturn result;\n\t\t}\n\n\t\tif (Type.isArrayFilled(options.context))\n\t\t{\n\t\t\tresult.context = options.context;\n\t\t}\n\t\tif (Type.isNumber(options.width))\n\t\t{\n\t\t\tresult.width = options.width;\n\t\t}\n\n\t\tif (Type.isNumber(options.height))\n\t\t{\n\t\t\tresult.height = options.height;\n\t\t}\n\n\t\tif (Type.isStringFilled(options.color))\n\t\t{\n\t\t\tresult.color = options.color;\n\t\t}\n\n\t\tif (Type.isStringFilled(options.iconName))\n\t\t{\n\t\t\tresult.iconName = options.iconName;\n\t\t}\n\n\t\treturn result;\n\t}\n\n\t#validateLoadConfiguration(configuration: Object)\n\t{\n\t\tconst result = {\n\t\t\tID: 0,\n\t\t\tPLACEMENT: '',\n\t\t\tPLACEMENT_ID: 0,\n\t\t};\n\n\t\tif (!Type.isPlainObject(configuration))\n\t\t{\n\t\t\treturn result;\n\t\t}\n\n\t\tif (Type.isNumber(configuration.ID))\n\t\t{\n\t\t\tresult.ID = configuration.ID;\n\t\t}\n\n\t\tif (Type.isStringFilled(configuration.PLACEMENT))\n\t\t{\n\t\t\tresult.PLACEMENT = configuration.PLACEMENT;\n\t\t}\n\n\t\tif (Type.isNumber(configuration.PLACEMENT_ID))\n\t\t{\n\t\t\tresult.PLACEMENT_ID = configuration.PLACEMENT_ID;\n\t\t}\n\n\t\treturn result;\n\t}\n}"],"names":["SettingsModel","BuilderModel","getState","Settings","application","darkTheme","enableSound","dialog","bigSmiles","background","recent","showBirthday","showInvited","showLastMessage","getGetters","get","state","key","getActions","set","store","payload","commit","validate","getMutations","Object","entries","forEach","value","fields","result","Type","isBoolean","isStringFilled","Number","parseInt","isNumber","ApplicationModel","getName","getNestedModules","settings","layout","name","Layout","chat","entityId","contextId","getLayout","isChatOpen","dialogId","toString","areNotificationsOpen","notification","setLayout","layoutName","previousLayout","newLayout","validateLayout","validateLayoutEntityId","EventEmitter","emit","EventType","onLayoutChange","from","to","update","keys","group","PinModel","collection","getPinned","chatId","map","pinnedMessageId","Core","getStore","getters","isPinned","messageId","has","setPinned","pinnedMessages","length","pinnedMessageIds","add","delete","Logger","warn","Set","reverse","USERS_TO_SHOW","ReactionsModel","getElementState","reactionCounters","reactionUsers","ownReactions","getByMessageId","prepareSetPayload","setReaction","Reaction","reaction","removeReaction","item","newItem","currentItem","newOwnReaction","userId","reactions","getUserId","removeAllCurrentUserReactions","currentCounter","users","counter","MessagesModel","pin","chatCollection","id","authorId","date","Date","text","replaces","files","attach","unread","viewed","viewedByOthers","sending","error","retry","componentId","MessageComponent","base","componentParams","extensionId","MessageExtension","extensionParams","isEdited","isDeleted","removeLinks","sort","a","b","getById","getByIdList","idList","push","hasMessage","isInChatCollection","message","getFirstId","getLastId","getLastOwnMessageId","getFirstUnread","getChatUnreadMessages","messages","filter","getMessageFiles","fileId","getMessageType","currentUserId","MessageType","system","self","opponent","getPreviousMessage","initialMessageIndex","indexOf","desiredMessageId","setChatCollection","clearCollection","Array","isArray","isPlainObject","preparedMessages","updateWithId","currentMessage","readMessages","messageIds","chatMessages","messagesToReadCount","maxMessageId","messageIdsToView","messageIdsToRead","chatMessage","setViewedByOthers","ids","clearChatCollection","isOwnMessage","Utils","isUuidV4","temporaryId","isUndefined","chat_id","cast","isString","isSystem","senderId","author_id","params","preparedParams","prepareParams","rawParams","values","includes","unsupported","isArrayFilled","firstId","element","isTempMessage","lastId","lastOwnMessageId","z","resultId","WRITING_STATUS_TIME","DialoguesModel","writingStatusTimers","chatOptions","type","DialogType","description","avatar","color","Color","extranet","userCounter","lastReadId","markedId","lastMessageId","lastMessageViews","countOfViewers","firstViewer","savedPositionMessageId","managerList","writingList","muteList","textareaMessage","quoteId","owner","entityType","dateCreate","public","code","link","inited","loading","hasPrevPage","hasNextPage","diskFolderId","getBlank","getByChatId","find","getChatOption","chatType","option","getQuoteId","isUser","user","canLeave","isExternalTelephonyCall","call","optionToCheck","ChatOption","leaveOwner","leave","canMute","isAnnouncement","announcement","mute","getLastReadId","getInitialMessageId","Math","min","existingItem","startWriting","timerId","alreadyWriting","some","el","clearTimeout","setWritingStatusTimeout","userName","newWritingList","actionName","stopWriting","increaseCounter","increasedCounter","count","previousCounter","decreaseCounter","decreasedCounter","clearCounters","unmute","setChatOptions","validateChatOptions","setLastMessageViews","newLastMessageViews","clearLastMessageViews","defaultLastMessageViews","incrementLastMessageViews","newCounter","setTimeout","dispatch","dialog_id","user_counter","last_id","marked_id","last_message_id","last_message_views","prepareLastMessageViews","title","Text","decode","ownerId","prepareAvatar","entity_type","entity_id","date_create","writing_list","prepareWritingList","manager_list","mute_list","prepareMuteList","disk_folder_id","endsWith","startsWith","getHost","encodeURI","htmlspecialcharsback","rawLastMessageViews","firstViewers","rawFirstViewers","rawFirstViewer","Error","options","typeOptions","newType","convertSnakeToCamelCase","toLowerCase","newKey","UsersModel","onlineList","mobileOnlineList","absentList","botList","firstName","lastName","workPosition","gender","isAdmin","network","bot","connector","externalAuthId","status","idle","lastActivityDate","mobileLastDate","isOnline","isMobileOnline","birthday","isBirthday","absent","isAbsent","departments","phones","workPhone","personalMobile","personalPhone","innerPhone","getTemporary","getList","userList","hasBirthday","hasVacation","getStatus","UserStatus","mobileOnline","getLastOnline","getLastDateText","getPosition","Loc","getMessage","getBotType","botType","BotType","existingUser","setBotList","setStatus","handleUserStatusFlags","startOnlineCheckInterval","startAbsentCheckInterval","first_name","last_name","work_position","external_auth_id","last_activity_date","mobile_last_date","departmentId","preparePhones","work_phone","personal_mobile","personal_phone","inner_phone","addToOnlineList","addToMobileOnlineList","isBirthdayToday","getTimeToNextMidnight","isDate","addToAbsentList","absentCheckInterval","TIME_TO_NEXT_DAY","setInterval","currentTime","now","absentEnd","getTime","onlineCheckInterval","ONE_MINUTE","FilesModel","extension","icon","size","image","FileStatus","done","progress","authorName","urlPreview","urlShow","urlDownload","viewerAttrs","isInCollection","preparedFile","file","currentFile","getIconTypeByExtension","width","height","validateViewerAttributes","viewer","actions","objectId","src","viewerGroupBy","viewerType","viewerTypeClass","viewerSeparateItem","viewerExtension","imChatId","CallsModel","RecentCallStatus","waiting","addActiveCall","existingCall","validateActiveCall","prepareActiveCall","updateActiveCall","deleteActiveCall","isObjectLike","associatedEntity","RecentModel","calls","recentCollection","unreadCollection","unloadedChatCounters","MessageStatus","received","withFile","withAttach","draft","pinned","liked","invitation","isActive","originator","canResend","getRecentCollection","getUnreadCollection","getSortedCollection","collectionAsArray","isBirthdayPlaceholder","birthdayPlaceholder","isInvitedUser","defaultUserRecord","needsBirthdayPlaceholder","hasTodayMessage","isToday","needsVacationPlaceholder","getMessageDate","getStartOfTheDay","getTotalCounter","loadedChatsCounter","recentItem","isMuted","isMarked","unloadedChatsCounter","setRecent","then","itemIds","zeroedCountersForNewItems","setUnread","itemsToUpdate","itemsToAdd","preparedElement","defaultMessage","action","like","isLastMessage","isExactMessageLiked","clearUnread","setUnloadedChatCounters","setRecentCollection","deleteFromRecentCollection","setUnreadCollection","defaultUserElement","currentElement","prepareMessage","prepareDraft","invited","originator_id","can_resend","default_user_record","NotificationsModel","Map","searchCollection","unreadCounter","notifyButtons","sectionCode","NotificationTypesCodes","simple","read","settingName","sortByType","getSearchResultCollection","getConfirmsCount","confirm","notificationId","getCounter","initialSet","total_unread_count","notifications","setSearchResult","skipValidation","readAll","clearSearchResult","setCounter","addSearchResult","updateSearchResult","clear","isNil","notify_title","notify_buttons","JSON","parse","buttons","button","COMMAND","COMMAND_PARAMS","VALUE","TEXT","TITLE","TYPE","DISPLAY","BG_COLOR","TEXT_COLOR","notify_type","notify_read","setting_name","LinksModel","counters","getSize","source","richData","previewUrl","links","preparedLink","url","validateRichData","FavoritesModel","isFavoriteMessage","chatFavorites","fromEntries","targetMessage","favorites","favorite","preparedFavoriteMessage","deleteByMessageId","targetLinkId","linkId","linkObject","MembersModel","TasksModel","task","creatorId","responsibleId","statusTitle","deadline","tasks","preparedTask","validateTask","MeetingsModel","meeting","dateFrom","dateTo","meetings","preparedMeeting","calendar","validateMeeting","subType","getLatest","rootState","rootGetters","media","audio","documents","other","SidebarFileTypes","document","sortedFlatCollection","flat","getTopThreeCompletedFiles","getLatestUnsorted","unsorted","fileUnsorted","sortedCollection","sidebarFile","slice","SidebarModel","members","initedList","isFilesMigrated","isLinksMigrated","isInited","setInited","setFilesMigrated","setLinksMigrated","MarketModel","placementCollection","PlacementType","contextMenu","navigation","textarea","sidebar","smilesSelector","role","context","iconName","placement","order","loadConfiguration","ID","PLACEMENT","PLACEMENT_ID","getByPlacement","appIds","items","setPlacementCollection","setCollection","app","configuration"],"mappings":";;;;;;;CAOO,MAAMA,aAAa,SAASC,yBAAY,CAC/C;GACCC,QAAQ,GACR;KACC,OAAO;OACN,CAACC,oBAAQ,CAACC,WAAW,CAACC,SAAS,GAAG,KAAK;OACvC,CAACF,oBAAQ,CAACC,WAAW,CAACE,WAAW,GAAG,IAAI;OAExC,CAACH,oBAAQ,CAACI,MAAM,CAACC,SAAS,GAAG,IAAI;OACjC,CAACL,oBAAQ,CAACI,MAAM,CAACE,UAAU,GAAG,CAAC;OAE/B,CAACN,oBAAQ,CAACO,MAAM,CAACC,YAAY,GAAG,IAAI;OACpC,CAACR,oBAAQ,CAACO,MAAM,CAACE,WAAW,GAAG,IAAI;OACnC,CAACT,oBAAQ,CAACO,MAAM,CAACG,eAAe,GAAG;MACnC;;GAGFC,UAAU,GACV;KACC,OAAO;OACNC,GAAG,EAAGC,KAAoB,IAAMC,GAAW,IAC3C;SACC,OAAOD,KAAK,CAACC,GAAG,CAAC;;MAElB;;GAGFC,UAAU,GACV;KACC,OAAO;OACNC,GAAG,EAAE,CAACC,KAAK,EAAEC,OAAqC,KAClD;SACCD,KAAK,CAACE,MAAM,CAAC,KAAK,EAAE,IAAI,CAACC,QAAQ,CAACF,OAAO,CAAC,CAAC;;MAE5C;;GAGFG,YAAY,GACZ;KACC,OAAO;OACNL,GAAG,EAAE,CAACH,KAAoB,EAAEK,OAAqC,KAAK;SACrEI,MAAM,CAACC,OAAO,CAACL,OAAO,CAAC,CAACM,OAAO,CAAC,CAAC,CAACV,GAAG,EAAEW,KAAK,CAAC,KAAK;WACjDZ,KAAK,CAACC,GAAG,CAAC,GAAGW,KAAK;UAClB,CAAC;;MAEH;;GAGFL,QAAQ,CAACM,MAAM,EACf;KACC,MAAMC,MAAM,GAAG,EAAE;KAEjB,IAAIC,cAAI,CAACC,SAAS,CAACH,MAAM,CAAC1B,oBAAQ,CAACC,WAAW,CAACC,SAAS,CAAC,CAAC,EAC1D;OACCyB,MAAM,CAAC3B,oBAAQ,CAACC,WAAW,CAACC,SAAS,CAAC,GAAGwB,MAAM,CAAC1B,oBAAQ,CAACC,WAAW,CAACC,SAAS,CAAC;;KAGhF,IAAI0B,cAAI,CAACC,SAAS,CAACH,MAAM,CAAC1B,oBAAQ,CAACC,WAAW,CAACE,WAAW,CAAC,CAAC,EAC5D;OACCwB,MAAM,CAAC3B,oBAAQ,CAACC,WAAW,CAACE,WAAW,CAAC,GAAGuB,MAAM,CAAC1B,oBAAQ,CAACC,WAAW,CAACE,WAAW,CAAC;;KAGpF,IAAIyB,cAAI,CAACC,SAAS,CAACH,MAAM,CAAC1B,oBAAQ,CAACI,MAAM,CAACC,SAAS,CAAC,CAAC,EACrD;OACCsB,MAAM,CAAC3B,oBAAQ,CAACI,MAAM,CAACC,SAAS,CAAC,GAAGqB,MAAM,CAAC1B,oBAAQ,CAACI,MAAM,CAACC,SAAS,CAAC;;KAGtE,IAAIuB,cAAI,CAACE,cAAc,CAACJ,MAAM,CAAC1B,oBAAQ,CAACI,MAAM,CAACE,UAAU,CAAC,CAAC,EAC3D;OACCoB,MAAM,CAAC1B,oBAAQ,CAACI,MAAM,CAACE,UAAU,CAAC,GAAGyB,MAAM,CAACC,QAAQ,CAACN,MAAM,CAAC1B,oBAAQ,CAACI,MAAM,CAACE,UAAU,CAAC,EAAE,EAAE,CAAC;;KAE7F,IAAIsB,cAAI,CAACK,QAAQ,CAACP,MAAM,CAAC1B,oBAAQ,CAACI,MAAM,CAACE,UAAU,CAAC,CAAC,EACrD;OACCqB,MAAM,CAAC3B,oBAAQ,CAACI,MAAM,CAACE,UAAU,CAAC,GAAGoB,MAAM,CAAC1B,oBAAQ,CAACI,MAAM,CAACE,UAAU,CAAC;;KAGxE,IAAIsB,cAAI,CAACC,SAAS,CAACH,MAAM,CAAC1B,oBAAQ,CAACO,MAAM,CAACC,YAAY,CAAC,CAAC,EACxD;OACCmB,MAAM,CAAC3B,oBAAQ,CAACO,MAAM,CAACC,YAAY,CAAC,GAAGkB,MAAM,CAAC1B,oBAAQ,CAACO,MAAM,CAACC,YAAY,CAAC;;KAG5E,IAAIoB,cAAI,CAACC,SAAS,CAACH,MAAM,CAAC1B,oBAAQ,CAACO,MAAM,CAACE,WAAW,CAAC,CAAC,EACvD;OACCkB,MAAM,CAAC3B,oBAAQ,CAACO,MAAM,CAACE,WAAW,CAAC,GAAGiB,MAAM,CAAC1B,oBAAQ,CAACO,MAAM,CAACE,WAAW,CAAC;;KAG1E,IAAImB,cAAI,CAACC,SAAS,CAACH,MAAM,CAAC1B,oBAAQ,CAACO,MAAM,CAACG,eAAe,CAAC,CAAC,EAC3D;OACCiB,MAAM,CAAC3B,oBAAQ,CAACO,MAAM,CAACG,eAAe,CAAC,GAAGgB,MAAM,CAAC1B,oBAAQ,CAACO,MAAM,CAACG,eAAe,CAAC;;KAGlF,OAAOiB,MAAM;;CAEf;;CC5FO,MAAMO,gBAAgB,SAASpC,yBAAY,CAClD;GACCqC,OAAO,GACP;KACC,OAAO,aAAa;;GAGrBC,gBAAgB,GAChB;KACC,OAAO;OAACC,QAAQ,EAAExC;MAAc;;GAGjCE,QAAQ,GACR;KACC,OAAO;OACNuC,MAAM,EACN;SACCC,IAAI,EAAEC,kBAAM,CAACC,IAAI,CAACF,IAAI;SACtBG,QAAQ,EAAE,EAAE;SACZC,SAAS,EAAE;;MAEZ;;GAGFhC,UAAU,GACV;KACC,OAAO;OACNiC,SAAS,EAAE/B,KAAK,IAChB;SACC,OAAOA,KAAK,CAACyB,MAAM;QACnB;OACDO,UAAU,EAAEhC,KAAK,IAAKiC,QAAgB,IACtC;SACC,IAAI,CAACjC,KAAK,CAACyB,MAAM,CAACC,IAAI,KAAKC,kBAAM,CAACC,IAAI,CAACF,IAAI,EAC3C;WACC,OAAO,KAAK;;SAGb,OAAO1B,KAAK,CAACyB,MAAM,CAACI,QAAQ,KAAKI,QAAQ,CAACC,QAAQ,EAAE;QACpD;OACDC,oBAAoB,EAAEnC,KAAK,IAC3B;SACC,OAAOA,KAAK,CAACyB,MAAM,CAACC,IAAI,KAAKC,kBAAM,CAACS,YAAY,CAACV,IAAI;;MAEtD;;GAGFxB,UAAU,GACV;KACC,OAAO;OACNmC,SAAS,EAAE,CAACjC,KAAK,EAAEC,OAAoE,KACvF;SACC,MAAM;WAACiC,UAAU;WAAET,QAAQ,GAAG,EAAE;WAAEC,SAAS,GAAG;UAAE,GAAGzB,OAAO;SAC1D,IAAI,CAACU,cAAI,CAACE,cAAc,CAACqB,UAAU,CAAC,EACpC;WACC,OAAO,KAAK;;SAGb,MAAMC,cAAc,GAAG;WAAC,GAAGnC,KAAK,CAACJ,KAAK,CAACyB;UAAO;SAC9C,MAAMe,SAAS,GAAG;WACjBd,IAAI,EAAE,IAAI,CAACe,cAAc,CAACH,UAAU,CAAC;WACrCT,QAAQ,EAAE,IAAI,CAACa,sBAAsB,CAACJ,UAAU,EAAET,QAAQ,CAAC;WAC3DC,SAAS,EAAEA;UACX;SACD1B,KAAK,CAACE,MAAM,CAAC,QAAQ,EAAE;WACtBmB,MAAM,EAAEe;UACR,CAAC;SAEFG,6BAAY,CAACC,IAAI,CAACC,qBAAS,CAACpB,MAAM,CAACqB,cAAc,EAAE;WAClDC,IAAI,EAAER,cAAc;WACpBS,EAAE,EAAER;UACJ,CAAC;;MAEH;;GAGFhC,YAAY,GACZ;KACC,OAAO;OACNyC,MAAM,EAAE,CAACjD,KAAK,EAAEK,OAAO,KAAK;SAC3BI,MAAM,CAACyC,IAAI,CAAC7C,OAAO,CAAC,CAACM,OAAO,CAAEwC,KAAK,IAAK;WACvC1C,MAAM,CAACC,OAAO,CAACL,OAAO,CAAC8C,KAAK,CAAC,CAAC,CAACxC,OAAO,CAAC,CAAC,CAACV,GAAG,EAAEW,KAAK,CAAC,KAAK;aACxDZ,KAAK,CAACmD,KAAK,CAAC,CAAClD,GAAG,CAAC,GAAGW,KAAK;YACzB,CAAC;UACF,CAAC;;MAEH;;GAGF6B,cAAc,CAACH,UAAkB,EACjC;KACC,IAAI,CAACX,kBAAM,CAACW,UAAU,CAAC,EACvB;OACC,OAAOX,kBAAM,CAACC,IAAI,CAACF,IAAI;;KAGxB,OAAOY,UAAU;;GAGlBI,sBAAsB,CAACJ,UAAkB,EAAET,QAAgB,EAC3D;KACC,IAAI,CAACF,kBAAM,CAACW,UAAU,CAAC,EACvB;OACC,OAAO,EAAE;;;;;KAKV,OAAOT,QAAQ;;CAEjB;;CC/GO,MAAMuB,QAAQ,SAASnE,yBAAY,CAC1C;GACCC,QAAQ,GACR;KACC,OAAO;OACNmE,UAAU,EAAE;MACZ;;GAGFvD,UAAU,GACV;KACC,OAAO;OACNwD,SAAS,EAAGtD,KAAe,IAAMuD,MAAc,IAC/C;SACC,IAAI,CAACvD,KAAK,CAACqD,UAAU,CAACE,MAAM,CAAC,EAC7B;WACC,OAAO,EAAE;;SAGV,OAAO,CAAC,GAAGvD,KAAK,CAACqD,UAAU,CAACE,MAAM,CAAC,CAAC,CAACC,GAAG,CAACC,eAAe,IAAI;WAC3D,OAAOC,2BAAI,CAACC,QAAQ,EAAE,CAACC,OAAO,CAAC,kBAAkB,CAAC,CAACH,eAAe,CAAC;UACnE,CAAC;QACF;OACDI,QAAQ,EAAG7D,KAAe,IAAMK,OAA4C,IAC5E;SACC,MAAM;WAACkD,MAAM;WAAEO;UAAU,GAAGzD,OAAO;SACnC,IAAI,CAACL,KAAK,CAACqD,UAAU,CAACE,MAAM,CAAC,EAC7B;WACC,OAAO,KAAK;;SAGb,OAAOvD,KAAK,CAACqD,UAAU,CAACE,MAAM,CAAC,CAACQ,GAAG,CAACD,SAAS,CAAC;;MAE/C;;GAGF5D,UAAU,GACV;KACC,OAAO;OACN8D,SAAS,EAAE,CAAC5D,KAAK,EAAEC,OAAmD,KACtE;SACC,MAAM;WAACkD,MAAM;WAAEU;UAAe,GAAG5D,OAAO;SACxC,IAAI4D,cAAc,CAACC,MAAM,KAAK,CAAC,EAC/B;WACC;;SAGD9D,KAAK,CAACE,MAAM,CAAC,WAAW,EAAE;WACzBiD,MAAM;WACNY,gBAAgB,EAAEF;UAClB,CAAC;QACF;OACD9D,GAAG,EAAE,CAACC,KAAK,EAAEC,OAA6D,KAC1E;SACCD,KAAK,CAACE,MAAM,CAAC,KAAK,EAAED,OAAO,CAAC;QAC5B;OACD+D,GAAG,EAAE,CAAChE,KAAK,EAAEC,OAA4C,KACzD;SACCD,KAAK,CAACE,MAAM,CAAC,KAAK,EAAED,OAAO,CAAC;QAC5B;OACDgE,MAAM,EAAE,CAACjE,KAAK,EAAEC,OAA4C,KAC5D;SACCD,KAAK,CAACE,MAAM,CAAC,QAAQ,EAAED,OAAO,CAAC;;MAEhC;;GAGFG,YAAY,GACZ;KACC,OAAO;OACNwD,SAAS,EAAE,CAAChE,KAAe,EAAEK,OAAqD,KAClF;SACCiE,uBAAM,CAACC,IAAI,CAAC,wCAAwC,EAAElE,OAAO,CAAC;SAC9D,MAAM;WAACkD,MAAM;WAAEY;UAAiB,GAAG9D,OAAO;SAC1CL,KAAK,CAACqD,UAAU,CAACE,MAAM,CAAC,GAAG,IAAIiB,GAAG,CAACL,gBAAgB,CAACM,OAAO,EAAE,CAAC;QAC9D;OACDL,GAAG,EAAE,CAACpE,KAAe,EAAEK,OAA4C,KACnE;SACCiE,uBAAM,CAACC,IAAI,CAAC,sCAAsC,EAAElE,OAAO,CAAC;SAC5D,MAAM;WAACkD,MAAM;WAAEO;UAAU,GAAGzD,OAAO;SACnC,IAAI,CAACL,KAAK,CAACqD,UAAU,CAACE,MAAM,CAAC,EAC7B;WACCvD,KAAK,CAACqD,UAAU,CAACE,MAAM,CAAC,GAAG,IAAIiB,GAAG,EAAE;;SAGrCxE,KAAK,CAACqD,UAAU,CAACE,MAAM,CAAC,CAACa,GAAG,CAACN,SAAS,CAAC;QACvC;OACDO,MAAM,EAAE,CAACrE,KAAe,EAAEK,OAA4C,KACtE;SACCiE,uBAAM,CAACC,IAAI,CAAC,yCAAyC,EAAElE,OAAO,CAAC;SAC/D,MAAM;WAACkD,MAAM;WAAEO;UAAU,GAAGzD,OAAO;SACnC,IAAI,CAACL,KAAK,CAACqD,UAAU,CAACE,MAAM,CAAC,EAC7B;WACC;;SAGDvD,KAAK,CAACqD,UAAU,CAACE,MAAM,CAAC,CAACc,MAAM,CAACP,SAAS,CAAC;;MAE3C;;CAEH;;CCnFA,MAAMY,aAAa,GAAG,CAAC;AAEvB,CAAO,MAAMC,cAAc,SAAS1F,yBAAY,CAChD;GACCC,QAAQ,GACR;KACC,OAAO;OACNmE,UAAU,EAAE;MACZ;;GAGFuB,eAAe,GACf;KACC,OAAO;OACNC,gBAAgB,EAAE,EAAE;OACpBC,aAAa,EAAE,EAAE;OACjBC,YAAY,EAAE,IAAIP,GAAG;MACrB;;GAGF1E,UAAU,GACV;KACC,OAAO;OACNkF,cAAc,EAAGhF,KAAqB,IAAM8D,SAAiB,IAC7D;SACC,OAAO9D,KAAK,CAACqD,UAAU,CAACS,SAAS,CAAC;;MAEnC;;GAGF5D,UAAU,GACV;KACC,OAAO;OACNC,GAAG,EAAE,CAACC,KAAY,EAAEC,OAAyB,KAC7C;SACCD,KAAK,CAACE,MAAM,CAAC,KAAK,EAAE,IAAI,CAAC2E,iBAAiB,CAAC5E,OAAO,CAAC,CAAC;QACpD;OACD6E,WAAW,EAAE,CACZ9E,KAAY,EACZC,OAAoE,KAErE;SACC,IAAI,CAAC8E,+BAAQ,CAAC9E,OAAO,CAAC+E,QAAQ,CAAC,EAC/B;WACC;;SAED,IAAI,CAAChF,KAAK,CAACJ,KAAK,CAACqD,UAAU,CAAChD,OAAO,CAACyD,SAAS,CAAC,EAC9C;WACC1D,KAAK,CAACJ,KAAK,CAACqD,UAAU,CAAChD,OAAO,CAACyD,SAAS,CAAC,GAAG,IAAI,CAACc,eAAe,EAAE;;SAGnExE,KAAK,CAACE,MAAM,CAAC,aAAa,EAAED,OAAO,CAAC;QACpC;OACDgF,cAAc,EAAE,CACfjF,KAAY,EACZC,OAAoE,KAErE;SACC,IAAI,CAACD,KAAK,CAACJ,KAAK,CAACqD,UAAU,CAAChD,OAAO,CAACyD,SAAS,CAAC,IAAI,CAACqB,+BAAQ,CAAC9E,OAAO,CAAC+E,QAAQ,CAAC,EAC7E;WACC;;SAEDhF,KAAK,CAACE,MAAM,CAAC,gBAAgB,EAAED,OAAO,CAAC;;MAExC;;GAGFG,YAAY,GACZ;KACC,OAAO;OACNL,GAAG,EAAE,CAACH,KAAqB,EAAEK,OAAyB,KACtD;SACCA,OAAO,CAACM,OAAO,CAAC2E,IAAI,IAAI;WACvB,MAAMC,OAAO,GAAG;aACfV,gBAAgB,EAAES,IAAI,CAACT,gBAAgB;aACvCC,aAAa,EAAEQ,IAAI,CAACR;YACpB;WAED,MAAMU,WAAW,GAAGxF,KAAK,CAACqD,UAAU,CAACiC,IAAI,CAACxB,SAAS,CAAC;WACpD,MAAM2B,cAAc,GAAG,CAAC,CAACH,IAAI,CAACP,YAAY;WAC1C,IAAIU,cAAc,EAClB;aACCF,OAAO,CAACR,YAAY,GAAGO,IAAI,CAACP,YAAY;YACxC,MAED;aACCQ,OAAO,CAACR,YAAY,GAAGS,WAAW,GAAGA,WAAW,CAACT,YAAY,GAAG,IAAIP,GAAG,EAAE;;WAG1ExE,KAAK,CAACqD,UAAU,CAACiC,IAAI,CAACxB,SAAS,CAAC,GAAGyB,OAAO;UAC1C,CAAC;QACF;OACDL,WAAW,EAAE,CACZlF,KAAqB,EACrBK,OAAoE,KAErE;SACC,MAAM;WAACyD,SAAS;WAAE4B,MAAM;WAAEN;UAAS,GAAG/E,OAAO;SAC7C,MAAMsF,SAAS,GAAG3F,KAAK,CAACqD,UAAU,CAACS,SAAS,CAAC;SAC7C,IAAIJ,2BAAI,CAACkC,SAAS,EAAE,KAAKF,MAAM,EAC/B;WACC,IAAI,CAACG,6BAA6B,CAACF,SAAS,CAAC;WAC7CA,SAAS,CAACZ,YAAY,CAACX,GAAG,CAACgB,QAAQ,CAAC;;SAGrC,IAAI,CAACO,SAAS,CAACd,gBAAgB,CAACO,QAAQ,CAAC,EACzC;WACCO,SAAS,CAACd,gBAAgB,CAACO,QAAQ,CAAC,GAAG,CAAC;;SAEzC,MAAMU,cAAc,GAAGH,SAAS,CAACd,gBAAgB,CAACO,QAAQ,CAAC;SAC3D,IAAIU,cAAc,GAAG,CAAC,IAAIpB,aAAa,EACvC;WACC,IAAI,CAACiB,SAAS,CAACb,aAAa,CAACM,QAAQ,CAAC,EACtC;aACCO,SAAS,CAACb,aAAa,CAACM,QAAQ,CAAC,GAAG,IAAIZ,GAAG,EAAE;;WAE9CmB,SAAS,CAACb,aAAa,CAACM,QAAQ,CAAC,CAAChB,GAAG,CAACsB,MAAM,CAAC;;SAG9CC,SAAS,CAACd,gBAAgB,CAACO,QAAQ,CAAC,EAAE;QACtC;OACDC,cAAc,EAAE,CACfrF,KAAqB,EACrBK,OAAoE,KAErE;SAAA;SACC,MAAM;WAACyD,SAAS;WAAE4B,MAAM;WAAEN;UAAS,GAAG/E,OAAO;SAC7C,MAAMsF,SAAS,GAAG3F,KAAK,CAACqD,UAAU,CAACS,SAAS,CAAC;SAE7C,IAAIJ,2BAAI,CAACkC,SAAS,EAAE,KAAKF,MAAM,EAC/B;WACCC,SAAS,CAACZ,YAAY,CAACV,MAAM,CAACe,QAAQ,CAAC;;SAGxC,yBAAAO,SAAS,CAACb,aAAa,CAACM,QAAQ,CAAC,qBAAjC,sBAAmCf,MAAM,CAACqB,MAAM,CAAC;SACjDC,SAAS,CAACd,gBAAgB,CAACO,QAAQ,CAAC,EAAE;SACtC,IAAIO,SAAS,CAACd,gBAAgB,CAACO,QAAQ,CAAC,KAAK,CAAC,EAC9C;WACC,OAAOO,SAAS,CAACd,gBAAgB,CAACO,QAAQ,CAAC;;;MAG7C;;GAGFS,6BAA6B,CAACF,SAA2B,EACzD;KACCA,SAAS,CAACZ,YAAY,CAACpE,OAAO,CAACyE,QAAQ,IAAI;OAAA;OAC1C,0BAAAO,SAAS,CAACb,aAAa,CAACM,QAAQ,CAAC,qBAAjC,uBAAmCf,MAAM,CAACX,2BAAI,CAACkC,SAAS,EAAE,CAAC;OAC3DD,SAAS,CAACd,gBAAgB,CAACO,QAAQ,CAAC,EAAE;OACtC,IAAIO,SAAS,CAACd,gBAAgB,CAACO,QAAQ,CAAC,KAAK,CAAC,EAC9C;SACC,OAAOO,SAAS,CAACd,gBAAgB,CAACO,QAAQ,CAAC;;MAE5C,CAAC;KAEFO,SAAS,CAACZ,YAAY,GAAG,IAAIP,GAAG,EAAE;;GAGnCS,iBAAiB,CAAC5E,OAAyB,EAC3C;KACC,OAAOA,OAAO,CAACmD,GAAG,CAAC8B,IAAI,IAAI;OAAA;OAC1B,MAAMR,aAAa,GAAG,EAAE;OACxBrE,MAAM,CAACC,OAAO,CAAC4E,IAAI,CAACR,aAAa,CAAC,CAACnE,OAAO,CAAC,CAAC,CAACyE,QAAQ,EAAEW,KAAK,CAAC,KAAK;SACjEjB,aAAa,CAACM,QAAQ,CAAC,GAAG,IAAIZ,GAAG,CAACuB,KAAK,CAAC;QACxC,CAAC;OAEF,MAAMlB,gBAAgB,GAAG,EAAE;OAC3BpE,MAAM,CAACC,OAAO,CAAC4E,IAAI,CAACT,gBAAgB,CAAC,CAAClE,OAAO,CAAC,CAAC,CAACyE,QAAQ,EAAEY,OAAO,CAAC,KAAK;SACtEnB,gBAAgB,CAACO,QAAQ,CAAC,GAAGY,OAAO;QACpC,CAAC;OAEF,MAAMlF,MAAM,GAAG;SACdgD,SAAS,EAAEwB,IAAI,CAACxB,SAAS;SACzBe,gBAAgB,EAAEA,gBAAgB;SAClCC,aAAa,EAAEA;QACf;OAED,IAAI,uBAAAQ,IAAI,CAACP,YAAY,qBAAjB,mBAAmBb,MAAM,IAAG,CAAC,EACjC;SACCpD,MAAM,CAACiE,YAAY,GAAG,IAAIP,GAAG,CAACc,IAAI,CAACP,YAAY,CAAC;;OAGjD,OAAOjE,MAAM;MACb,CAAC;;CAEJ;;CCxMsD;CAAA;CAAA;CAAA;CAAA;AActD,CAAO,MAAMmF,aAAa,SAAShH,yBAAY,CAC/C;GAAA;KAAA;KAAA;OAAA;;KAAA;OAAA;;KAAA;OAAA;;KAAA;OAAA;;KAAA;OAAA;;;GACCqC,OAAO,GACP;KACC,OAAO,UAAU;;GAGlBC,gBAAgB,GAChB;KACC,OAAO;OACN2E,GAAG,EAAE9C,QAAQ;OACbuC,SAAS,EAAEhB;MACX;;GAGFzF,QAAQ,GACR;KACC,OAAO;OACNmE,UAAU,EAAE,EAAE;OACd8C,cAAc,EAAE;MAChB;;GAGFvB,eAAe,GACf;KACC,OAAO;OACNwB,EAAE,EAAE,CAAC;OACL7C,MAAM,EAAE,CAAC;OACT8C,QAAQ,EAAE,CAAC;OACXC,IAAI,EAAE,IAAIC,IAAI,EAAE;OAChBC,IAAI,EAAE,EAAE;OACRC,QAAQ,EAAE,EAAE;OACZC,KAAK,EAAE,EAAE;OACTC,MAAM,EAAE,EAAE;OACVC,MAAM,EAAE,KAAK;OACbC,MAAM,EAAE,IAAI;OACZC,cAAc,EAAE,KAAK;OACrBC,OAAO,EAAE,KAAK;OACdC,KAAK,EAAE,KAAK;OACZC,KAAK,EAAE,KAAK;OACZC,WAAW,EAAEC,4BAAgB,CAACC,IAAI;OAClCC,eAAe,EAAE,EAAE;OACnBC,WAAW,EAAEC,4BAAgB,CAACf,IAAI;OAClCgB,eAAe,EAAE,EAAE;OACnBC,QAAQ,EAAE,KAAK;OACfC,SAAS,EAAE,KAAK;OAChBC,WAAW,EAAE;MACb;;GAGF7H,UAAU,GACV;KACC,OAAO;;OAENC,GAAG,EAAGC,KAAoB,IAAMuD,MAAc,IAAK;SAClD,IAAI,CAACvD,KAAK,CAACmG,cAAc,CAAC5C,MAAM,CAAC,EACjC;WACC,OAAO,EAAE;;SAGV,OAAO,CAAC,GAAGvD,KAAK,CAACmG,cAAc,CAAC5C,MAAM,CAAC,CAAC,CAACC,GAAG,CAAEM,SAA0B,IAAK;WAC5E,OAAO9D,KAAK,CAACqD,UAAU,CAACS,SAAS,CAAC;UAClC,CAAC,CAAC8D,IAAI,CAAC,CAACC,CAAC,EAAEC,CAAC,KAAK;WACjB,OAAOD,CAAC,CAACzB,EAAE,GAAG0B,CAAC,CAAC1B,EAAE;UAClB,CAAC;QACF;;OAED2B,OAAO,EAAG/H,KAAoB,IAAMoG,EAAU,IAAsB;SACnE,OAAOpG,KAAK,CAACqD,UAAU,CAAC+C,EAAE,CAAC;QAC3B;;OAED4B,WAAW,EAAGhI,KAAoB,IAAMiI,MAAgB,IAAuB;SAC9E,MAAMnH,MAAM,GAAG,EAAE;SACjBmH,MAAM,CAACtH,OAAO,CAAEyF,EAAE,IAAK;WACtB,IAAIpG,KAAK,CAACqD,UAAU,CAAC+C,EAAE,CAAC,EACxB;aACCtF,MAAM,CAACoH,IAAI,CAAClI,KAAK,CAACqD,UAAU,CAAC+C,EAAE,CAAC,CAAC;;UAElC,CAAC;SAEF,OAAOtF,MAAM;QACb;;OAEDqH,UAAU,EAAGnI,KAAoB,IAAK,CAAC;SAAEuD,MAAM;SAAEO;QAAU,KAAK;SAC/D,IAAI,CAAC9D,KAAK,CAACmG,cAAc,CAAC5C,MAAM,CAAC,EACjC;WACC,OAAO,KAAK;;SAGb,OAAOvD,KAAK,CAACmG,cAAc,CAAC5C,MAAM,CAAC,CAACQ,GAAG,CAACD,SAAS,CAAC;QAClD;;OAEDsE,kBAAkB,EAAGpI,KAAoB,IAAMK,OAA4B,IAAc;SAAA;SACxF,MAAM;WAAEyD;UAAW,GAAGzD,OAAO;SAC7B,MAAMgI,OAAO,GAAGrI,KAAK,CAACqD,UAAU,CAACS,SAAS,CAAC;SAC3C,IAAI,CAACuE,OAAO,EACZ;WACC,OAAO,KAAK;;SAEb,MAAM;WAAE9E;UAAQ,GAAG8E,OAAO;SAE1B,gCAAOrI,KAAK,CAACmG,cAAc,CAAC5C,MAAM,CAAC,qBAA5B,sBAA8BQ,GAAG,CAACD,SAAS,CAAC;QACnD;;OAEDwE,UAAU,EAAGtI,KAAoB,IAAMuD,MAAc,IAAa;SACjE,IAAI,CAACvD,KAAK,CAACmG,cAAc,CAAC5C,MAAM,CAAC,EACjC;WACC,OAAO,CAAC;;SAGT,+CAAO,IAAI,8CAAsBvD,KAAK,EAAEuD,MAAM;QAC9C;;OAEDgF,SAAS,EAAGvI,KAAoB,IAAMuD,MAAc,IAAa;SAChE,IAAI,CAACvD,KAAK,CAACmG,cAAc,CAAC5C,MAAM,CAAC,EACjC;WACC,OAAO,CAAC;;SAGT,+CAAO,IAAI,wCAAmBvD,KAAK,EAAEuD,MAAM;QAC3C;;OAEDiF,mBAAmB,EAAGxI,KAAoB,IAAMuD,MAAc,IAAa;SAC1E,IAAI,CAACvD,KAAK,CAACmG,cAAc,CAAC5C,MAAM,CAAC,EACjC;WACC,OAAO,CAAC;;SAGT,+CAAO,IAAI,gDAAuBvD,KAAK,EAAEuD,MAAM;QAC/C;;OAEDkF,cAAc,EAAGzI,KAAoB,IAAMuD,MAAc,IAAa;SACrE,IAAI,CAACvD,KAAK,CAACmG,cAAc,CAAC5C,MAAM,CAAC,EACjC;WACC,OAAO,CAAC;;SAGT,+CAAO,IAAI,sCAAkBvD,KAAK,EAAEuD,MAAM;QAC1C;;OAEDmF,qBAAqB,EAAG1I,KAAoB,IAAMuD,MAAc,IAAuB;SACtF,IAAI,CAACvD,KAAK,CAACmG,cAAc,CAAC5C,MAAM,CAAC,EACjC;WACC,OAAO,EAAE;;SAGV,MAAMoF,QAAQ,GAAG,CAAC,GAAG3I,KAAK,CAACmG,cAAc,CAAC5C,MAAM,CAAC,CAAC,CAACC,GAAG,CAAEM,SAA0B,IAAK;WACtF,OAAO9D,KAAK,CAACqD,UAAU,CAACS,SAAS,CAAC;UAClC,CAAC;SAEF,OAAO6E,QAAQ,CAACC,MAAM,CAAEP,OAAuB,IAAK;WACnD,OAAOA,OAAO,CAACzB,MAAM,KAAK,IAAI;UAC9B,CAAC;QACF;;OAEDiC,eAAe,EAAG7I,KAAoB,IAAMK,OAAe,IAAoB;SAC9E,MAAMyD,SAAS,GAAGzD,OAAO;SACzB,IAAI,CAACL,KAAK,CAACqD,UAAU,CAACS,SAAS,CAAC,EAChC;WACC,OAAO,EAAE;;SAGV,OAAO9D,KAAK,CAACqD,UAAU,CAACS,SAAS,CAAC,CAAC4C,KAAK,CAAClD,GAAG,CAAEsF,MAAM,IAAK;WACxD,OAAO,IAAI,CAAC1I,KAAK,CAACwD,OAAO,CAAC,WAAW,CAAC,CAACkF,MAAM,EAAE,IAAI,CAAC;UACpD,CAAC;QACF;;OAEDC,cAAc,EAAG/I,KAAoB,IAAM8D,SAAiB,IAAmC;SAC9F,MAAMuE,OAAO,GAAGrI,KAAK,CAACqD,UAAU,CAACS,SAAS,CAAC;SAC3C,IAAI,CAACuE,OAAO,EACZ;WACC,OAAO,IAAI;;SAGZ,MAAMW,aAAa,GAAGtF,2BAAI,CAACkC,SAAS,EAAE;SACtC,IAAIyC,OAAO,CAAChC,QAAQ,KAAK,CAAC,EAC1B;WACC,OAAO4C,uBAAW,CAACC,MAAM;;SAG1B,IAAIb,OAAO,CAAChC,QAAQ,KAAK2C,aAAa,EACtC;WACC,OAAOC,uBAAW,CAACE,IAAI;;SAGxB,OAAOF,uBAAW,CAACG,QAAQ;QAC3B;;OAEDC,kBAAkB,EAAGrJ,KAAoB,IAAMK,OAA4C,IAAsB;SAChH,MAAM;WAAEyD,SAAS;WAAEP;UAAQ,GAAGlD,OAAO;SACrC,MAAMgI,OAAO,GAAGrI,KAAK,CAACqD,UAAU,CAACS,SAAS,CAAC;SAC3C,IAAI,CAACuE,OAAO,EACZ;WACC,OAAO,IAAI;;SAGZ,MAAMlC,cAAc,GAAG,CAAC,GAAGnG,KAAK,CAACmG,cAAc,CAAC5C,MAAM,CAAC,CAAC;SACxD,MAAM+F,mBAAmB,GAAGnD,cAAc,CAACoD,OAAO,CAACzF,SAAS,CAAC;SAC7D,MAAM0F,gBAAgB,GAAGrD,cAAc,CAACmD,mBAAmB,GAAG,CAAC,CAAC;SAChE,IAAI,CAACE,gBAAgB,EACrB;WACC,OAAO,IAAI;;SAGZ,OAAOxJ,KAAK,CAACqD,UAAU,CAACmG,gBAAgB,CAAC;;MAE1C;;GAGFtJ,UAAU,GACV;KACC,OAAO;;OAENuJ,iBAAiB,EAAE,CAACrJ,KAAK,EAAEC,OAAwE,KAAK;SAAA;SACvG,IAAI;WAAEsI,QAAQ;WAAEe;UAAiB,GAAGrJ,OAAO;SAC3CqJ,eAAe,uBAAGA,eAAe,+BAAI,KAAK;SAC1C,IAAI,CAACC,KAAK,CAACC,OAAO,CAACjB,QAAQ,CAAC,IAAI5H,cAAI,CAAC8I,aAAa,CAAClB,QAAQ,CAAC,EAC5D;WACCA,QAAQ,GAAG,CAACA,QAAQ,CAAC;;SAGtBA,QAAQ,GAAGA,QAAQ,CAACnF,GAAG,CAAE6E,OAAmB,IAAK;WAChD,OAAO;aAAE,GAAG,IAAI,CAACzD,eAAe,EAAE;aAAE,GAAG,IAAI,CAACrE,QAAQ,CAAC8H,OAAO;YAAG;UAC/D,CAAC;SAEF,MAAM9E,MAAM,iBAAGoF,QAAQ,CAAC,CAAC,CAAC,qBAAX,WAAapF,MAAM;SAClC,IAAIA,MAAM,IAAImG,eAAe,EAC7B;WACCtJ,KAAK,CAACE,MAAM,CAAC,iBAAiB,EAAE;aAAEiD;YAAQ,CAAC;;SAG5CnD,KAAK,CAACE,MAAM,CAAC,OAAO,EAAE;WAAEqI;UAAU,CAAC;SACnCvI,KAAK,CAACE,MAAM,CAAC,mBAAmB,EAAE;WAAEqI;UAAU,CAAC;QAC/C;;OAEDvI,KAAK,EAAE,CAACA,KAAK,EAAEC,OAAkC,KAAK;SACrD,IAAIyJ,gBAAgB,GAAGzJ,OAAO;SAC9B,IAAIU,cAAI,CAAC8I,aAAa,CAACxJ,OAAO,CAAC,EAC/B;WACCyJ,gBAAgB,GAAG,CAACzJ,OAAO,CAAC;;SAG7ByJ,gBAAgB,GAAGA,gBAAgB,CAACtG,GAAG,CAAE6E,OAAmB,IAAK;WAChE,OAAO;aAAE,GAAG,IAAI,CAACzD,eAAe,EAAE;aAAE,GAAG,IAAI,CAACrE,QAAQ,CAAC8H,OAAO;YAAG;UAC/D,CAAC;SAEF,IAAIyB,gBAAgB,CAAC5F,MAAM,KAAK,CAAC,EACjC;WACC;;SAGD9D,KAAK,CAACE,MAAM,CAAC,OAAO,EAAE;WACrBqI,QAAQ,EAAEmB;UACV,CAAC;QACF;;OAED1F,GAAG,EAAE,CAAChE,KAAK,EAAEC,OAAmB,KAAK;SACpC,MAAMgI,OAAO,GAAG;WACf,GAAG,IAAI,CAACzD,eAAe,EAAE;WACzB,GAAG,IAAI,CAACrE,QAAQ,CAACF,OAAO;UACxB;SACDD,KAAK,CAACE,MAAM,CAAC,OAAO,EAAE;WACrBqI,QAAQ,EAAE,CAACN,OAAO;UAClB,CAAC;SACFjI,KAAK,CAACE,MAAM,CAAC,mBAAmB,EAAE;WACjCqI,QAAQ,EAAE,CAACN,OAAO;UAClB,CAAC;SAEF,OAAOA,OAAO,CAACjC,EAAE;QACjB;;OAED2D,YAAY,EAAE,CAAC3J,KAAK,EAAEC,OAA8C,KAAK;SACxE,MAAM;WAAE+F,EAAE;WAAEvF;UAAQ,GAAGR,OAAO;SAC9B,IAAI,CAACD,KAAK,CAACJ,KAAK,CAACqD,UAAU,CAAC+C,EAAE,CAAC,EAC/B;WACC;;SAGDhG,KAAK,CAACE,MAAM,CAAC,cAAc,EAAE;WAC5B8F,EAAE;WACFvF,MAAM,EAAE,IAAI,CAACN,QAAQ,CAACM,MAAM;UAC5B,CAAC;QACF;;OAEDoC,MAAM,EAAE,CAAC7C,KAAK,EAAEC,OAA8C,KAAK;SAClE,MAAM;WAAE+F,EAAE;WAAEvF;UAAQ,GAAGR,OAAO;SAC9B,MAAM2J,cAAc,GAAG5J,KAAK,CAACJ,KAAK,CAACqD,UAAU,CAAC+C,EAAE,CAAC;SACjD,IAAI,CAAC4D,cAAc,EACnB;WACC;;SAGD5J,KAAK,CAACE,MAAM,CAAC,QAAQ,EAAE;WACtB8F,EAAE;WACFvF,MAAM,EAAE;aAAE,GAAGmJ,cAAc;aAAE,GAAG,IAAI,CAACzJ,QAAQ,CAACM,MAAM;;UACpD,CAAC;QACF;;OAEDoJ,YAAY,EAAE,CAAC7J,KAAK,EAAEC,OAA+C,KAAa;SACjF,MAAM;WAAEkD,MAAM;WAAE2G;UAAY,GAAG7J,OAAO;SACtC,IAAI,CAACD,KAAK,CAACJ,KAAK,CAACmG,cAAc,CAAC5C,MAAM,CAAC,EACvC;WACC,OAAO,CAAC;;SAGT,MAAM4G,YAAY,GAAG,CAAC,GAAG/J,KAAK,CAACJ,KAAK,CAACmG,cAAc,CAAC5C,MAAM,CAAC,CAAC,CAACC,GAAG,CAAEM,SAAiB,IAAK;WACvF,OAAO1D,KAAK,CAACJ,KAAK,CAACqD,UAAU,CAACS,SAAS,CAAC;UACxC,CAAC;SAEF,IAAIsG,mBAAmB,GAAG,CAAC;SAC3B,MAAMC,YAAY,2CAAG,IAAI,sCAAkBH,UAAU,CAAC;SACtD,MAAMI,gBAAgB,GAAGJ,UAAU;SACnC,MAAMK,gBAAgB,GAAG,EAAE;SAC3BJ,YAAY,CAACxJ,OAAO,CAAE6J,WAA2B,IAAK;WACrD,IAAI,CAACA,WAAW,CAAC5D,MAAM,EACvB;aACC;;WAGD,IAAI4D,WAAW,CAACpE,EAAE,IAAIiE,YAAY,EAClC;aACCD,mBAAmB,EAAE;aACrBG,gBAAgB,CAACrC,IAAI,CAACsC,WAAW,CAACpE,EAAE,CAAC;;UAEtC,CAAC;SAEFhG,KAAK,CAACE,MAAM,CAAC,cAAc,EAAE;WAC5BiK,gBAAgB;WAChBD;UACA,CAAC;SAEF,OAAOF,mBAAmB;QAC1B;;OAEDK,iBAAiB,EAAE,CAACrK,KAAK,EAAEC,OAAwB,KAAa;SAC/D,MAAM;WAAEqK;UAAK,GAAGrK,OAAO;SACvBD,KAAK,CAACE,MAAM,CAAC,mBAAmB,EAAE;WACjCoK;UACA,CAAC;QACF;;OAEDrG,MAAM,EAAE,CAACjE,KAAK,EAAEC,OAA8B,KAAK;SAClD,MAAM;WAAE+F;UAAI,GAAG/F,OAAO;SACtB,IAAI,CAACD,KAAK,CAACJ,KAAK,CAACqD,UAAU,CAAC+C,EAAE,CAAC,EAC/B;WACC;;SAGDhG,KAAK,CAACE,MAAM,CAAC,QAAQ,EAAE;WAAE8F;UAAI,CAAC;QAC9B;;OAEDuE,mBAAmB,EAAE,CAACvK,KAAK,EAAEC,OAAyB,KAAK;SAC1D,MAAM;WAAEkD;UAAQ,GAAGlD,OAAO;SAC1BD,KAAK,CAACE,MAAM,CAAC,iBAAiB,EAAE;WAAEiD;UAAQ,CAAC;;MAE5C;;GAGF/C,YAAY,GACZ;KACC,OAAO;OACNiJ,iBAAiB,EAAE,CAACzJ,KAAoB,EAAEK,OAAqC,KAAK;SACnFiE,uBAAM,CAACC,IAAI,CAAC,4CAA4C,EAAElE,OAAO,CAAC;SAClEA,OAAO,CAACsI,QAAQ,CAAChI,OAAO,CAAE0H,OAAO,IAAK;WACrC,IAAI,CAACrI,KAAK,CAACmG,cAAc,CAACkC,OAAO,CAAC9E,MAAM,CAAC,EACzC;;aAECvD,KAAK,CAACmG,cAAc,CAACkC,OAAO,CAAC9E,MAAM,CAAC,GAAG,IAAIiB,GAAG,EAAE;;WAEjDxE,KAAK,CAACmG,cAAc,CAACkC,OAAO,CAAC9E,MAAM,CAAC,CAACa,GAAG,CAACiE,OAAO,CAACjC,EAAE,CAAC;UACpD,CAAC;QACF;OACDhG,KAAK,EAAE,CAACJ,KAAoB,EAAEK,OAAqC,KAAK;SACvEiE,uBAAM,CAACC,IAAI,CAAC,gCAAgC,EAAElE,OAAO,CAAC;SACtDA,OAAO,CAACsI,QAAQ,CAAChI,OAAO,CAAE0H,OAAO,IAAK;;WAErCrI,KAAK,CAACqD,UAAU,CAACgF,OAAO,CAACjC,EAAE,CAAC,GAAGiC,OAAO;UACtC,CAAC;QACF;OACD0B,YAAY,EAAE,CAAC/J,KAAoB,EAAEK,OAA8C,KAAK;SACvFiE,uBAAM,CAACC,IAAI,CAAC,uCAAuC,EAAElE,OAAO,CAAC;SAC7D,MAAM;WAAE+F,EAAE;WAAEvF;UAAQ,GAAGR,OAAO;SAC9B,MAAM2J,cAAc,GAAG;WAAE,GAAGhK,KAAK,CAACqD,UAAU,CAAC+C,EAAE;UAAG;;;SAGlD,OAAOpG,KAAK,CAACqD,UAAU,CAAC+C,EAAE,CAAC;;SAE3BpG,KAAK,CAACqD,UAAU,CAACxC,MAAM,CAACuF,EAAE,CAAC,GAAG;WAAE,GAAG4D,cAAc;WAAE,GAAGnJ,MAAM;WAAEkG,OAAO,EAAE;UAAO;SAE9E,IAAI/G,KAAK,CAACmG,cAAc,CAAC6D,cAAc,CAACzG,MAAM,CAAC,CAACQ,GAAG,CAACqC,EAAE,CAAC,EACvD;WACCpG,KAAK,CAACmG,cAAc,CAAC6D,cAAc,CAACzG,MAAM,CAAC,CAACc,MAAM,CAAC+B,EAAE,CAAC;WACtDpG,KAAK,CAACmG,cAAc,CAAC6D,cAAc,CAACzG,MAAM,CAAC,CAACa,GAAG,CAACvD,MAAM,CAACuF,EAAE,CAAC;;QAE3D;OACDnD,MAAM,EAAE,CAACjD,KAAoB,EAAEK,OAA8C,KAAK;SACjFiE,uBAAM,CAACC,IAAI,CAAC,iCAAiC,EAAElE,OAAO,CAAC;SACvD,MAAM;WAAE+F,EAAE;WAAEvF;UAAQ,GAAGR,OAAO;;SAE9BL,KAAK,CAACqD,UAAU,CAAC+C,EAAE,CAAC,GAAG;WAAE,GAAGpG,KAAK,CAACqD,UAAU,CAAC+C,EAAE,CAAC;WAAE,GAAGvF;UAAQ;QAC7D;OACDwD,MAAM,EAAE,CAACrE,KAAoB,EAAEK,OAA8B,KAAK;SACjEiE,uBAAM,CAACC,IAAI,CAAC,iCAAiC,EAAElE,OAAO,CAAC;SACvD,MAAM;WAAE+F;UAAI,GAAG/F,OAAO;SACtB,MAAM;WAAEkD;UAAQ,GAAGvD,KAAK,CAACqD,UAAU,CAAC+C,EAAE,CAAC;SACvCpG,KAAK,CAACmG,cAAc,CAAC5C,MAAM,CAAC,CAACc,MAAM,CAAC+B,EAAE,CAAC;;SAEvC,OAAOpG,KAAK,CAACqD,UAAU,CAAC+C,EAAE,CAAC;QAC3B;OACDsD,eAAe,EAAE,CAAC1J,KAAoB,EAAEK,OAAyB,KAAK;SACrEiE,uBAAM,CAACC,IAAI,CAAC,2CAA2C,EAAElE,OAAO,CAACkD,MAAM,CAAC;;SAExEvD,KAAK,CAACmG,cAAc,CAAC9F,OAAO,CAACkD,MAAM,CAAC,GAAG,IAAIiB,GAAG,EAAE;QAChD;OACDyF,YAAY,EAAE,CAACjK,KAAoB,EAAEK,OAAiE,KAAK;SAC1G,MAAM;WAAEkK,gBAAgB;WAAED;UAAkB,GAAGjK,OAAO;SACtDkK,gBAAgB,CAAC5J,OAAO,CAAEmD,SAAS,IAAK;WACvC,MAAMuE,OAAO,GAAGrI,KAAK,CAACqD,UAAU,CAACS,SAAS,CAAC;WAC3C,IAAI,CAACuE,OAAO,EACZ;aACC;;WAGDA,OAAO,CAACzB,MAAM,GAAG,KAAK;UACtB,CAAC;SACF0D,gBAAgB,CAAC3J,OAAO,CAAEmD,SAAS,IAAK;WACvC,MAAMuE,OAAO,GAAGrI,KAAK,CAACqD,UAAU,CAACS,SAAS,CAAC;WAC3C,IAAI,CAACuE,OAAO,EACZ;aACC;;WAGDA,OAAO,CAACxB,MAAM,GAAG,IAAI;UACrB,CAAC;QACF;OACD4D,iBAAiB,EAAE,CAACzK,KAAoB,EAAEK,OAAwB,KAAK;SACtE,MAAM;WAAEqK;UAAK,GAAGrK,OAAO;SACvBqK,GAAG,CAAC/J,OAAO,CAAEyF,EAAE,IAAK;WACnB,MAAMiC,OAAO,GAAGrI,KAAK,CAACqD,UAAU,CAAC+C,EAAE,CAAC;WACpC,IAAI,CAACiC,OAAO,EACZ;aACC;;WAED,MAAMuC,YAAY,GAAGvC,OAAO,CAAChC,QAAQ,KAAK3C,2BAAI,CAACkC,SAAS,EAAE;WAC1D,IAAI,CAACgF,YAAY,IAAIvC,OAAO,CAACvB,cAAc,EAC3C;aACC;;WAGDuB,OAAO,CAACvB,cAAc,GAAG,IAAI;UAC7B,CAAC;;MAEH;;GAGFvG,QAAQ,CAACM,MAAc,EACvB;KACC,IAAIC,MAAM,GAAG,EAAE;KAEf,IAAIC,cAAI,CAACK,QAAQ,CAACP,MAAM,CAACuF,EAAE,CAAC,EAC5B;OACCtF,MAAM,CAACsF,EAAE,GAAGvF,MAAM,CAACuF,EAAE;MACrB,MACI,IAAIyE,qBAAK,CAACrE,IAAI,CAACsE,QAAQ,CAACjK,MAAM,CAACkK,WAAW,CAAC,EAChD;OACCjK,MAAM,CAACsF,EAAE,GAAGvF,MAAM,CAACkK,WAAW;;KAG/B,IAAI,CAAChK,cAAI,CAACiK,WAAW,CAACnK,MAAM,CAACoK,OAAO,CAAC,EACrC;OACCpK,MAAM,CAAC0C,MAAM,GAAG1C,MAAM,CAACoK,OAAO;;KAE/B,IAAIlK,cAAI,CAACK,QAAQ,CAACP,MAAM,CAAC0C,MAAM,CAAC,IAAIxC,cAAI,CAACE,cAAc,CAACJ,MAAM,CAAC0C,MAAM,CAAC,EACtE;OACCzC,MAAM,CAACyC,MAAM,GAAGrC,MAAM,CAACC,QAAQ,CAACN,MAAM,CAAC0C,MAAM,EAAE,EAAE,CAAC;;KAGnD,IAAIxC,cAAI,CAACE,cAAc,CAACJ,MAAM,CAACyF,IAAI,CAAC,EACpC;OACCxF,MAAM,CAACwF,IAAI,GAAGuE,qBAAK,CAACvE,IAAI,CAAC4E,IAAI,CAACrK,MAAM,CAACyF,IAAI,CAAC;;KAG3C,IAAIvF,cAAI,CAACK,QAAQ,CAACP,MAAM,CAAC2F,IAAI,CAAC,IAAIzF,cAAI,CAACoK,QAAQ,CAACtK,MAAM,CAAC2F,IAAI,CAAC,EAC5D;OACC1F,MAAM,CAAC0F,IAAI,GAAG3F,MAAM,CAAC2F,IAAI,CAACtE,QAAQ,EAAE;;KAGrC,IAAInB,cAAI,CAACE,cAAc,CAACJ,MAAM,CAACqI,MAAM,CAAC,EACtC;OACCrI,MAAM,CAACuK,QAAQ,GAAGvK,MAAM,CAACqI,MAAM,KAAK,GAAG;;KAGxC,IAAI,CAACnI,cAAI,CAACiK,WAAW,CAACnK,MAAM,CAACwK,QAAQ,CAAC,EACtC;OACCxK,MAAM,CAACwF,QAAQ,GAAGxF,MAAM,CAACwK,QAAQ;MACjC,MACI,IAAI,CAACtK,cAAI,CAACiK,WAAW,CAACnK,MAAM,CAACyK,SAAS,CAAC,EAC5C;OACCzK,MAAM,CAACwF,QAAQ,GAAGxF,MAAM,CAACyK,SAAS;;KAEnC,IAAIvK,cAAI,CAACK,QAAQ,CAACP,MAAM,CAACwF,QAAQ,CAAC,IAAItF,cAAI,CAACE,cAAc,CAACJ,MAAM,CAACwF,QAAQ,CAAC,EAC1E;OACCvF,MAAM,CAACuF,QAAQ,GAAGnF,MAAM,CAACC,QAAQ,CAACN,MAAM,CAACwF,QAAQ,EAAE,EAAE,CAAC;;KAGvD,IAAIxF,MAAM,CAACuK,QAAQ,KAAK,IAAI,EAC5B;OACCtK,MAAM,CAACuF,QAAQ,GAAG,CAAC;;KAGpB,IAAItF,cAAI,CAAC6I,OAAO,CAAC/I,MAAM,CAAC4F,QAAQ,CAAC,EACjC;OACC3F,MAAM,CAAC2F,QAAQ,GAAG5F,MAAM,CAAC4F,QAAQ;;KAGlC,IAAI1F,cAAI,CAACC,SAAS,CAACH,MAAM,CAACkG,OAAO,CAAC,EAClC;OACCjG,MAAM,CAACiG,OAAO,GAAGlG,MAAM,CAACkG,OAAO;;KAGhC,IAAIhG,cAAI,CAACC,SAAS,CAACH,MAAM,CAAC+F,MAAM,CAAC,EACjC;OACC9F,MAAM,CAAC8F,MAAM,GAAG/F,MAAM,CAAC+F,MAAM;;KAG9B,IAAI7F,cAAI,CAACC,SAAS,CAACH,MAAM,CAACgG,MAAM,CAAC,EACjC;OACC/F,MAAM,CAAC+F,MAAM,GAAGhG,MAAM,CAACgG,MAAM;;KAG9B,IAAI9F,cAAI,CAACC,SAAS,CAACH,MAAM,CAACiG,cAAc,CAAC,EACzC;OACChG,MAAM,CAACgG,cAAc,GAAGjG,MAAM,CAACiG,cAAc;;KAG9C,IAAI/F,cAAI,CAACC,SAAS,CAACH,MAAM,CAACmG,KAAK,CAAC,EAChC;OACClG,MAAM,CAACkG,KAAK,GAAGnG,MAAM,CAACmG,KAAK;;KAG5B,IAAIjG,cAAI,CAACC,SAAS,CAACH,MAAM,CAACoG,KAAK,CAAC,EAChC;OACCnG,MAAM,CAACmG,KAAK,GAAGpG,MAAM,CAACoG,KAAK;;KAG5B,IAAIlG,cAAI,CAACoK,QAAQ,CAACtK,MAAM,CAACqG,WAAW,CAAC,EACrC;OACCpG,MAAM,CAACoG,WAAW,GAAGrG,MAAM,CAACqG,WAAW;;KAGxC,IAAInG,cAAI,CAAC6I,OAAO,CAAC/I,MAAM,CAAC6F,KAAK,CAAC,EAC9B;OACC5F,MAAM,CAAC4F,KAAK,GAAG7F,MAAM,CAAC6F,KAAK;;KAG5B,IAAI3F,cAAI,CAAC6I,OAAO,CAAC/I,MAAM,CAAC8F,MAAM,CAAC,EAC/B;OACC7F,MAAM,CAAC6F,MAAM,GAAG9F,MAAM,CAAC8F,MAAM;;KAG9B,IAAI5F,cAAI,CAACC,SAAS,CAACH,MAAM,CAAC4G,QAAQ,CAAC,EACnC;OACC3G,MAAM,CAAC2G,QAAQ,GAAG5G,MAAM,CAAC4G,QAAQ;;KAGlC,IAAI1G,cAAI,CAACC,SAAS,CAACH,MAAM,CAAC6G,SAAS,CAAC,EACpC;OACC5G,MAAM,CAAC4G,SAAS,GAAG7G,MAAM,CAAC6G,SAAS;;KAGpC,IAAI3G,cAAI,CAACC,SAAS,CAACH,MAAM,CAAC8G,WAAW,CAAC,EACtC;OACC7G,MAAM,CAAC6G,WAAW,GAAG9G,MAAM,CAAC8G,WAAW;;KAGxC,IAAI5G,cAAI,CAAC8I,aAAa,CAAChJ,MAAM,CAAC0K,MAAM,CAAC,EACrC;OACC,MAAMC,cAAc,GAAG,IAAI,CAACC,aAAa,CAAC5K,MAAM,CAAC0K,MAAM,CAAC;OACxDzK,MAAM,GAAG;SAAC,GAAGA,MAAM;SAAE,GAAG0K;QAAe;;KAGxC,OAAO1K,MAAM;;GAGd2K,aAAa,CAACC,SAA2B,EACzC;KACC,MAAM5K,MAAM,GAAG,EAAE;KAEjBL,MAAM,CAACC,OAAO,CAACgL,SAAS,CAAC,CAAC/K,OAAO,CAAC,CAAC,CAACV,GAAG,EAAEW,KAAK,CAAC,KAAK;OACnD,IAAIX,GAAG,KAAK,cAAc,IAAIc,cAAI,CAACE,cAAc,CAACL,KAAK,CAAC,EACxD;SACC,IAAIH,MAAM,CAACkL,MAAM,CAACxE,4BAAgB,CAAC,CAACyE,QAAQ,CAAChL,KAAK,CAAC,EACnD;WACCE,MAAM,CAACoG,WAAW,GAAGtG,KAAK;;QAE3B,MACI,IAAIX,GAAG,KAAK,kBAAkB,IAAIc,cAAI,CAAC8I,aAAa,CAACjJ,KAAK,CAAC,EAChE;SACCE,MAAM,CAACuG,eAAe,GAAGzG,KAAK;QAC9B,MACI,IAAIX,GAAG,KAAK,cAAc,IAAIc,cAAI,CAACE,cAAc,CAACL,KAAK,CAAC,EAC7D;SACC,IAAIH,MAAM,CAACkL,MAAM,CAACpE,4BAAgB,CAAC,CAACqE,QAAQ,CAAChL,KAAK,CAAC,EACnD;WACCE,MAAM,CAACwG,WAAW,GAAG1G,KAAK;UAC1B,MAED;WACCE,MAAM,CAACwG,WAAW,GAAGC,4BAAgB,CAACsE,WAAW;;QAElD,MACI,IAAI5L,GAAG,KAAK,kBAAkB,IAAIc,cAAI,CAAC8I,aAAa,CAACjJ,KAAK,CAAC,EAChE;SACCE,MAAM,CAAC0G,eAAe,GAAG5G,KAAK;QAC9B,MACI,IAAIX,GAAG,KAAK,SAAS,IAAIc,cAAI,CAAC6I,OAAO,CAAChJ,KAAK,CAAC,EACjD;SACCE,MAAM,CAAC4F,KAAK,GAAG9F,KAAK;QACpB,MACI,IAAIX,GAAG,KAAK,WAAW,IAAIc,cAAI,CAACE,cAAc,CAACL,KAAK,CAAC,EAC1D;SACCE,MAAM,CAAC2G,QAAQ,GAAG7G,KAAK,KAAK,GAAG;QAC/B,MACI,IAAIX,GAAG,KAAK,YAAY,IAAIc,cAAI,CAACE,cAAc,CAACL,KAAK,CAAC,EAC3D;SACCE,MAAM,CAAC4G,SAAS,GAAG9G,KAAK,KAAK,GAAG;QAChC,MACI,IAAIX,GAAG,KAAK,QAAQ,KAAKc,cAAI,CAAC6I,OAAO,CAAChJ,KAAK,CAAC,IAAIG,cAAI,CAACC,SAAS,CAACJ,KAAK,CAAC,IAAIG,cAAI,CAACoK,QAAQ,CAACvK,KAAK,CAAC,CAAC,EACnG;SACCE,MAAM,CAAC6F,MAAM,GAAG/F,KAAK;QACrB,MACI,IAAIX,GAAG,KAAK,aAAa,IAAIc,cAAI,CAAC+K,aAAa,CAAClL,KAAK,CAAC,EAC3D;SACCE,MAAM,CAAC6G,WAAW,GAAG/G,KAAK,CAACgL,QAAQ,CAAClI,2BAAI,CAACkC,SAAS,EAAE,CAAC;;MAEtD,CAAC;KAEF,OAAO9E,MAAM;;CAmGf;CAAC,2BAhGiBoJ,UAAoB,EACrC;GACC,IAAIG,YAAY,GAAG,CAAC;GACpBH,UAAU,CAACvJ,OAAO,CAACmD,SAAS,IAAI;KAC/B,IAAIuG,YAAY,GAAGvG,SAAS,EAC5B;OACCuG,YAAY,GAAGvG,SAAS;;IAEzB,CAAC;GAEF,OAAOuG,YAAY;CACpB;CAAC,+BAEoBrK,KAAoB,EAAEuD,MAAc,EACzD;GACC,IAAIwI,OAAO,GAAG,IAAI;GAClB,MAAMpD,QAAQ,GAAG,CAAC,GAAG3I,KAAK,CAACmG,cAAc,CAAC5C,MAAM,CAAC,CAAC;GAClD,KAAK,MAAMO,SAAS,IAAI6E,QAAQ,EAChC;KACC,MAAMqD,OAAO,GAAGhM,KAAK,CAACqD,UAAU,CAACS,SAAS,CAAC;KAC3C,IAAI,CAACiI,OAAO,EACZ;OACCA,OAAO,GAAGC,OAAO,CAAC5F,EAAE;;KAErB,IAAIyE,qBAAK,CAACrE,IAAI,CAACyF,aAAa,CAACD,OAAO,CAAC5F,EAAE,CAAC,EACxC;OACC;;KAGD,IAAI4F,OAAO,CAAC5F,EAAE,GAAG2F,OAAO,EACxB;OACCA,OAAO,GAAGC,OAAO,CAAC5F,EAAE;;;GAItB,OAAO2F,OAAO;CACf;CAAC,4BAEiB/L,KAAoB,EAAEuD,MAAc,EACtD;GACC,IAAI2I,MAAM,GAAG,CAAC;GACd,MAAMvD,QAAQ,GAAG,CAAC,GAAG3I,KAAK,CAACmG,cAAc,CAAC5C,MAAM,CAAC,CAAC;GAClD,KAAK,MAAMO,SAAS,IAAI6E,QAAQ,EAChC;KACC,MAAMqD,OAAO,GAAGhM,KAAK,CAACqD,UAAU,CAACS,SAAS,CAAC;KAC3C,IAAI+G,qBAAK,CAACrE,IAAI,CAACyF,aAAa,CAACD,OAAO,CAAC5F,EAAE,CAAC,EACxC;OACC;;KAGD,IAAI4F,OAAO,CAAC5F,EAAE,GAAG8F,MAAM,EACvB;OACCA,MAAM,GAAGF,OAAO,CAAC5F,EAAE;;;GAIrB,OAAO8F,MAAM;CACd;CAAC,gCAEqBlM,KAAoB,EAAEuD,MAAc,EAC1D;GACC,IAAI4I,gBAAgB,GAAG,CAAC;GACxB,MAAMxD,QAAQ,GAAG,CAAC,GAAG3I,KAAK,CAACmG,cAAc,CAAC5C,MAAM,CAAC,CAAC,CAACqE,IAAI,CAAC,CAACC,CAAC,EAAEuE,CAAC,KAAKA,CAAC,GAAGvE,CAAC,CAAC;GACxE,KAAK,MAAM/D,SAAS,IAAI6E,QAAQ,EAChC;KACC,MAAMqD,OAAO,GAAGhM,KAAK,CAACqD,UAAU,CAACS,SAAS,CAAC;KAC3C,IAAI+G,qBAAK,CAACrE,IAAI,CAACyF,aAAa,CAACD,OAAO,CAAC5F,EAAE,CAAC,EACxC;OACC;;KAGD,IAAI4F,OAAO,CAAC3F,QAAQ,KAAK3C,2BAAI,CAACkC,SAAS,EAAE,EACzC;OACCuG,gBAAgB,GAAGH,OAAO,CAAC5F,EAAE;OAC7B;;;GAIF,OAAO+F,gBAAgB;CACxB;CAAC,2BAEgBnM,KAAoB,EAAEuD,MAAc,EACrD;GACC,IAAI8I,QAAQ,GAAG,CAAC;GAChB,KAAK,MAAMvI,SAAS,IAAI9D,KAAK,CAACmG,cAAc,CAAC5C,MAAM,CAAC,EACpD;KACC,MAAM8E,OAAuB,GAAGrI,KAAK,CAACqD,UAAU,CAACS,SAAS,CAAC;KAC3D,IAAIuE,OAAO,CAACzB,MAAM,EAClB;OACCyF,QAAQ,GAAGvI,SAAS;OACpB;;;GAIF,OAAOuI,QAAQ;CAChB;;CC7uBD,MAAMC,mBAAmB,GAAG,KAAK;AAQjC,CAAO,MAAMC,cAAc,SAAStN,yBAAY,CAChD;GACCqC,OAAO,GACP;KACC,OAAO,WAAW;;GAGnBpC,QAAQ,GACR;KACC,OAAO;OACNmE,UAAU,EAAE,EAAE;OACdmJ,mBAAmB,EAAE,EAAE;OACvBC,WAAW,EAAE;MACb;;GAGF7H,eAAe,GACf;KACC,OAAO;OACN3C,QAAQ,EAAE,GAAG;OACbsB,MAAM,EAAE,CAAC;OACTmJ,IAAI,EAAEC,sBAAU,CAAC/K,IAAI;OACrBF,IAAI,EAAE,EAAE;OACRkL,WAAW,EAAE,EAAE;OACfC,MAAM,EAAE,EAAE;OACVC,KAAK,EAAEC,iBAAK,CAAC3F,IAAI;OACjB4F,QAAQ,EAAE,KAAK;OACfhH,OAAO,EAAE,CAAC;OACViH,WAAW,EAAE,CAAC;OACdC,UAAU,EAAE,CAAC;OACbC,QAAQ,EAAE,CAAC;OACXC,aAAa,EAAE,CAAC;OAChBC,gBAAgB,EAAE;SACjBC,cAAc,EAAE,CAAC;SACjBC,WAAW,EAAE,IAAI;SACjBzJ,SAAS,EAAE;QACX;OACD0J,sBAAsB,EAAE,CAAC;OACzBC,WAAW,EAAE,EAAE;OACfC,WAAW,EAAE,EAAE;OACfC,QAAQ,EAAE,EAAE;OACZC,eAAe,EAAE,EAAE;OACnBC,OAAO,EAAE,CAAC;OACVC,KAAK,EAAE,CAAC;OACRC,UAAU,EAAE,EAAE;OACdlM,QAAQ,EAAE,EAAE;OACZmM,UAAU,EAAE,IAAI;OAChBC,MAAM,EAAE;SACPC,IAAI,EAAE,EAAE;SACRC,IAAI,EAAE;QACN;OACDC,MAAM,EAAE,KAAK;OACbC,OAAO,EAAE,KAAK;OACdC,WAAW,EAAE,KAAK;OAClBC,WAAW,EAAE,KAAK;OAClBC,YAAY,EAAE;MACd;;GAGF1O,UAAU,GACV;KACC,OAAO;OACNC,GAAG,EAAGC,KAAkB,IAAK,CAACiC,QAAgB,EAAEwM,QAAiB,GAAG,KAAK,KACzE;SACC,IAAI,CAACzO,KAAK,CAACqD,UAAU,CAACpB,QAAQ,CAAC,IAAIwM,QAAQ,EAC3C;WACC,OAAO,IAAI,CAAC7J,eAAe,EAAE;UAC7B,MACI,IAAI,CAAC5E,KAAK,CAACqD,UAAU,CAACpB,QAAQ,CAAC,IAAI,CAACwM,QAAQ,EACjD;WACC,OAAO,IAAI;;SAGZ,OAAOzO,KAAK,CAACqD,UAAU,CAACpB,QAAQ,CAAC;QACjC;OACDyM,WAAW,EAAG1O,KAAkB,IAAMuD,MAAuB,IAC7D;SACCA,MAAM,GAAGrC,MAAM,CAACC,QAAQ,CAACoC,MAAM,EAAE,EAAE,CAAC;SACpC,OAAO9C,MAAM,CAACkL,MAAM,CAAC3L,KAAK,CAACqD,UAAU,CAAC,CAACsL,IAAI,CAACrJ,IAAI,IAAI;WACnD,OAAOA,IAAI,CAAC/B,MAAM,KAAKA,MAAM;UAC7B,CAAC;QACF;OACDkL,QAAQ,EAAE,MACV;SACC,OAAO,IAAI,CAAC7J,eAAe,EAAE;QAC7B;OACDgK,aAAa,EAAG5O,KAAkB,IAAK,CAAC6O,QAAgB,EAAEC,MAAc,KACxE;SACC,IAAI,CAAC9O,KAAK,CAACyM,WAAW,CAACoC,QAAQ,CAAC,EAChC;WACCA,QAAQ,GAAG,SAAS;;SAGrB,OAAO7O,KAAK,CAACyM,WAAW,CAACoC,QAAQ,CAAC,CAACC,MAAM,CAAC;QAC1C;OACDC,UAAU,EAAG/O,KAAkB,IAAMiC,QAAgB,IACrD;SACC,IAAI,CAACjC,KAAK,CAACqD,UAAU,CAACpB,QAAQ,CAAC,EAC/B;WACC,OAAO,CAAC;;SAGT,OAAOjC,KAAK,CAACqD,UAAU,CAACpB,QAAQ,CAAC,CAAC4L,OAAO;QACzC;OACDmB,MAAM,EAAGhP,KAAkB,IAAMiC,QAAgB,IACjD;SACC,IAAI,CAACjC,KAAK,CAACqD,UAAU,CAACpB,QAAQ,CAAC,EAC/B;WACC,OAAO,KAAK;;SAGb,OAAOjC,KAAK,CAACqD,UAAU,CAACpB,QAAQ,CAAC,CAACyK,IAAI,KAAKC,sBAAU,CAACsC,IAAI;QAC1D;OACDC,QAAQ,EAAGlP,KAAkB,IAAMiC,QAAgB,IACnD;SACC,IAAI,CAACjC,KAAK,CAACqD,UAAU,CAACpB,QAAQ,CAAC,EAC/B;WACC,OAAO,KAAK;;SAGb,MAAM1C,MAAM,GAAGS,KAAK,CAACqD,UAAU,CAACpB,QAAQ,CAAC;SAEzC,MAAMkN,uBAAuB,GAAG5P,MAAM,CAACmN,IAAI,KAAKC,sBAAU,CAACyC,IAAI;SAC/D,MAAMJ,MAAM,GAAGzP,MAAM,CAACmN,IAAI,KAAKC,sBAAU,CAACsC,IAAI;SAC9C,IAAIE,uBAAuB,IAAIH,MAAM,EACrC;WACC,OAAO,KAAK;;SAGb,MAAMhG,aAAa,GAAGtF,2BAAI,CAACkC,SAAS,EAAE;SACtC,MAAMyJ,aAAa,GAAG9P,MAAM,CAACuO,KAAK,KAAK9E,aAAa,GAAGsG,sBAAU,CAACC,UAAU,GAAGD,sBAAU,CAACE,KAAK;SAE/F,OAAO,IAAI,CAACpP,KAAK,CAACwD,OAAO,CAAC,yBAAyB,CAAC,CAACrE,MAAM,CAACmN,IAAI,EAAE2C,aAAa,CAAC;QAChF;OACDI,OAAO,EAAGzP,KAAkB,IAAMiC,QAAgB,IAClD;SACC,IAAI,CAACjC,KAAK,CAACqD,UAAU,CAACpB,QAAQ,CAAC,EAC/B;WACC,OAAO,KAAK;;SAGb,MAAM1C,MAAM,GAAGS,KAAK,CAACqD,UAAU,CAACpB,QAAQ,CAAC;SAEzC,MAAM+M,MAAM,GAAGzP,MAAM,CAACmN,IAAI,KAAKC,sBAAU,CAACsC,IAAI;SAC9C,MAAMS,cAAc,GAAGnQ,MAAM,CAACmN,IAAI,KAAKC,sBAAU,CAACgD,YAAY;SAC9D,IAAIX,MAAM,IAAIU,cAAc,EAC5B;WACC,OAAO,IAAI;;SAGZ,OAAO,IAAI,CAACtP,KAAK,CAACwD,OAAO,CAAC,yBAAyB,CAAC,CAACrE,MAAM,CAACmN,IAAI,EAAE4C,sBAAU,CAACM,IAAI,CAAC;QAClF;OACDC,aAAa,EAAG7P,KAAkB,IAAMiC,QAAgB,IACxD;SACC,IAAI,CAACjC,KAAK,CAACqD,UAAU,CAACpB,QAAQ,CAAC,EAC/B;WACC,OAAO,CAAC;;SAGT,MAAM;WAACiL,UAAU;WAAEE;UAAc,GAAGpN,KAAK,CAACqD,UAAU,CAACpB,QAAQ,CAAC;SAE9D,OAAOiL,UAAU,KAAKE,aAAa,GAAG,CAAC,GAAGF,UAAU;QACpD;OACD4C,mBAAmB,EAAG9P,KAAkB,IAAMiC,QAAgB,IAC9D;SACC,IAAI,CAACjC,KAAK,CAACqD,UAAU,CAACpB,QAAQ,CAAC,EAC/B;WACC,OAAO,CAAC;;SAGT,MAAM;WAACiL,UAAU;WAAEC;UAAS,GAAGnN,KAAK,CAACqD,UAAU,CAACpB,QAAQ,CAAC;SACzD,IAAIkL,QAAQ,KAAK,CAAC,EAClB;WACC,OAAOD,UAAU;;SAGlB,OAAO6C,IAAI,CAACC,GAAG,CAAC9C,UAAU,EAAEC,QAAQ,CAAC;;MAEtC;;GAGFjN,UAAU,GACV;KACC,OAAO;OACNC,GAAG,EAAE,CAACC,KAAK,EAAEC,OAAuB,KACpC;SACC,IAAI,CAACsJ,KAAK,CAACC,OAAO,CAACvJ,OAAO,CAAC,IAAIU,cAAI,CAAC8I,aAAa,CAACxJ,OAAO,CAAC,EAC1D;WACCA,OAAO,GAAG,CAACA,OAAO,CAAC;;SAGpBA,OAAO,CAACmD,GAAG,CAACwI,OAAO,IAAI;WACtB,OAAO,IAAI,CAACzL,QAAQ,CAACyL,OAAO,CAAC;UAC7B,CAAC,CAACrL,OAAO,CAACqL,OAAO,IAAI;WACrB,MAAMiE,YAAY,GAAG7P,KAAK,CAACJ,KAAK,CAACqD,UAAU,CAAC2I,OAAO,CAAC/J,QAAQ,CAAC;WAC7D,IAAIgO,YAAY,EAChB;aACC7P,KAAK,CAACE,MAAM,CAAC,QAAQ,EAAE;eACtB2B,QAAQ,EAAE+J,OAAO,CAAC/J,QAAQ;eAC1BpB,MAAM,EAAEmL;cACR,CAAC;YACF,MAED;aACC5L,KAAK,CAACE,MAAM,CAAC,KAAK,EAAE;eACnB2B,QAAQ,EAAE+J,OAAO,CAAC/J,QAAQ;eAC1BpB,MAAM,EAAE;iBAAC,GAAG,IAAI,CAAC+D,eAAe,EAAE;iBAAE,GAAGoH;;cACvC,CAAC;;UAEH,CAAC;QACF;OAED5H,GAAG,EAAE,CAAChE,KAAK,EAAEC,OAAuB,KACpC;SACC,IAAI,CAACsJ,KAAK,CAACC,OAAO,CAACvJ,OAAO,CAAC,IAAIU,cAAI,CAAC8I,aAAa,CAACxJ,OAAO,CAAC,EAC1D;WACCA,OAAO,GAAG,CAACA,OAAO,CAAC;;SAGpBA,OAAO,CAACmD,GAAG,CAACwI,OAAO,IAAI;WACtB,OAAO,IAAI,CAACzL,QAAQ,CAACyL,OAAO,CAAC;UAC7B,CAAC,CAACrL,OAAO,CAACqL,OAAO,IAAI;WACrB,MAAMiE,YAAY,GAAG7P,KAAK,CAACJ,KAAK,CAACqD,UAAU,CAAC2I,OAAO,CAAC/J,QAAQ,CAAC;WAC7D,IAAI,CAACgO,YAAY,EACjB;aACC7P,KAAK,CAACE,MAAM,CAAC,KAAK,EAAE;eACnB2B,QAAQ,EAAE+J,OAAO,CAAC/J,QAAQ;eAC1BpB,MAAM,EAAE;iBAAC,GAAG,IAAI,CAAC+D,eAAe,EAAE;iBAAE,GAAGoH;;cACvC,CAAC;;UAEH,CAAC;QACF;OAED/I,MAAM,EAAE,CAAC7C,KAAK,EAAEC,OAA2C,KAC3D;SACC,MAAM4P,YAAY,GAAG7P,KAAK,CAACJ,KAAK,CAACqD,UAAU,CAAChD,OAAO,CAAC4B,QAAQ,CAAC;SAC7D,IAAI,CAACgO,YAAY,EACjB;WACC,OAAO,KAAK;;SAGb7P,KAAK,CAACE,MAAM,CAAC,QAAQ,EAAE;WACtB2B,QAAQ,EAAE5B,OAAO,CAAC4B,QAAQ;WAC1BpB,MAAM,EAAE,IAAI,CAACN,QAAQ,CAACF,OAAO,CAACQ,MAAM;UACpC,CAAC;QACF;OAEDwD,MAAM,EAAE,CAACjE,KAAK,EAAEC,OAA2B,KAC3C;SACC,MAAM4P,YAAY,GAAG7P,KAAK,CAACJ,KAAK,CAACqD,UAAU,CAAChD,OAAO,CAAC4B,QAAQ,CAAC;SAC7D,IAAI,CAACgO,YAAY,EACjB;WACC,OAAO,KAAK;;SAGb7P,KAAK,CAACE,MAAM,CAAC,QAAQ,EAAE;WAAC2B,QAAQ,EAAE5B,OAAO,CAAC4B;UAAS,CAAC;QACpD;OAEDiO,YAAY,EAAE,CAAC9P,KAAK,EAAEC,OAA6D,KACnF;SACC,MAAM4P,YAAY,GAAG7P,KAAK,CAACJ,KAAK,CAACqD,UAAU,CAAChD,OAAO,CAAC4B,QAAQ,CAAC;SAC7D,IAAI,CAACgO,YAAY,EACjB;WACC,OAAO,KAAK;;SAGb,MAAME,OAAO,GAAI,GAAE9P,OAAO,CAAC4B,QAAS,IAAG5B,OAAO,CAACqF,MAAO,EAAC;SACvD,MAAM0K,cAAc,GAAGH,YAAY,CAACvC,WAAW,CAAC2C,IAAI,CAACC,EAAE,IAAIA,EAAE,CAAC5K,MAAM,KAAKrF,OAAO,CAACqF,MAAM,CAAC;SACxF,IAAI0K,cAAc,EAClB;WACCG,YAAY,CAACnQ,KAAK,CAACJ,KAAK,CAACwM,mBAAmB,CAAC2D,OAAO,CAAC,CAAC;WACtD/P,KAAK,CAACJ,KAAK,CAACwM,mBAAmB,CAAC2D,OAAO,CAAC,GAAG,IAAI,CAACK,uBAAuB,CAACnQ,OAAO,CAAC;WAChF,OAAO,IAAI;;SAGZ,MAAMkF,OAAO,GAAG;WAACG,MAAM,EAAErF,OAAO,CAACqF,MAAM;WAAE+K,QAAQ,EAAEpQ,OAAO,CAACoQ;UAAS;SACpE,MAAMC,cAAc,GAAG,CAACnL,OAAO,EAAE,GAAG0K,YAAY,CAACvC,WAAW,CAAC;SAC7DtN,KAAK,CAACE,MAAM,CAAC,QAAQ,EAAE;WACtBqQ,UAAU,EAAE,cAAc;WAC1B1O,QAAQ,EAAE5B,OAAO,CAAC4B,QAAQ;WAC1BpB,MAAM,EAAE,IAAI,CAACN,QAAQ,CAAC;aAACmN,WAAW,EAAEgD;YAAe;UACnD,CAAC;SAEF,IAAI,CAACtQ,KAAK,CAACJ,KAAK,CAACwM,mBAAmB,CAAC2D,OAAO,CAAC,EAC7C;WACC/P,KAAK,CAACJ,KAAK,CAACwM,mBAAmB,CAAC2D,OAAO,CAAC,GAAG,IAAI,CAACK,uBAAuB,CAACnQ,OAAO,CAAC;;QAEjF;OAEDuQ,WAAW,EAAE,CAACxQ,KAAK,EAAEC,OAA2C,KAChE;SACC,MAAM4P,YAAY,GAAG7P,KAAK,CAACJ,KAAK,CAACqD,UAAU,CAAChD,OAAO,CAAC4B,QAAQ,CAAC;SAC7D,IAAI,CAACgO,YAAY,EACjB;WACC,OAAO,KAAK;;SAGb,MAAMG,cAAc,GAAGH,YAAY,CAACvC,WAAW,CAACiB,IAAI,CAAC2B,EAAE,IAAIA,EAAE,CAAC5K,MAAM,KAAKrF,OAAO,CAACqF,MAAM,CAAC;SACxF,IAAI,CAAC0K,cAAc,EACnB;WACC,OAAO,KAAK;;SAGb,MAAMM,cAAc,GAAGT,YAAY,CAACvC,WAAW,CAAC9E,MAAM,CAACtD,IAAI,IAAIA,IAAI,CAACI,MAAM,KAAKrF,OAAO,CAACqF,MAAM,CAAC;SAC9FtF,KAAK,CAACE,MAAM,CAAC,QAAQ,EAAE;WACtBqQ,UAAU,EAAE,aAAa;WACzB1O,QAAQ,EAAE5B,OAAO,CAAC4B,QAAQ;WAC1BpB,MAAM,EAAE,IAAI,CAACN,QAAQ,CAAC;aAACmN,WAAW,EAAEgD;YAAe;UACnD,CAAC;SAEF,MAAMP,OAAO,GAAI,GAAE9P,OAAO,CAAC4B,QAAS,IAAG5B,OAAO,CAACqF,MAAO,EAAC;SACvD6K,YAAY,CAACnQ,KAAK,CAACJ,KAAK,CAACwM,mBAAmB,CAAC2D,OAAO,CAAC,CAAC;SACtD,OAAO/P,KAAK,CAACJ,KAAK,CAACwM,mBAAmB,CAAC2D,OAAO,CAAC;QAC/C;OAEDU,eAAe,EAAE,CAACzQ,KAAK,EAAEC,OAA0C,KACnE;SACC,MAAM4P,YAAY,GAAG7P,KAAK,CAACJ,KAAK,CAACqD,UAAU,CAAChD,OAAO,CAAC4B,QAAQ,CAAC;SAC7D,IAAI,CAACgO,YAAY,EACjB;WACC,OAAO,KAAK;;SAGb,IAAIA,YAAY,CAACjK,OAAO,KAAK,GAAG,EAChC;WACC,OAAO,IAAI;;SAGZ,IAAI8K,gBAAgB,GAAGb,YAAY,CAACjK,OAAO,GAAG3F,OAAO,CAAC0Q,KAAK;SAC3D,IAAID,gBAAgB,GAAG,GAAG,EAC1B;WACCA,gBAAgB,GAAG,GAAG;;SAGvB1Q,KAAK,CAACE,MAAM,CAAC,QAAQ,EAAE;WACtBqQ,UAAU,EAAE,iBAAiB;WAC7B1O,QAAQ,EAAE5B,OAAO,CAAC4B,QAAQ;WAC1BpB,MAAM,EAAE;aACPmF,OAAO,EAAE8K,gBAAgB;aACzBE,eAAe,EAAEf,YAAY,CAACjK;;UAE/B,CAAC;QACF;OAEDiL,eAAe,EAAE,CAAC7Q,KAAK,EAAEC,OAA0C,KACnE;SACC,MAAM4P,YAAY,GAAG7P,KAAK,CAACJ,KAAK,CAACqD,UAAU,CAAChD,OAAO,CAAC4B,QAAQ,CAAC;SAC7D,IAAI,CAACgO,YAAY,EACjB;WACC,OAAO,KAAK;;SAGb,IAAIA,YAAY,CAACjK,OAAO,KAAK,GAAG,EAChC;WACC,OAAO,IAAI;;SAGZ,IAAIkL,gBAAgB,GAAGjB,YAAY,CAACjK,OAAO,GAAG3F,OAAO,CAAC0Q,KAAK;SAC3D,IAAIG,gBAAgB,GAAG,CAAC,EACxB;WACCA,gBAAgB,GAAG,CAAC;;SAGrB9Q,KAAK,CAACE,MAAM,CAAC,QAAQ,EAAE;WACtBqQ,UAAU,EAAE,iBAAiB;WAC7B1O,QAAQ,EAAE5B,OAAO,CAAC4B,QAAQ;WAC1BpB,MAAM,EAAE;aACPmF,OAAO,EAAEkL,gBAAgB;aACzBF,eAAe,EAAEf,YAAY,CAACjK;;UAE/B,CAAC;QACF;OAEDmL,aAAa,EAAG/Q,KAAK,IACrB;SACCA,KAAK,CAACE,MAAM,CAAC,eAAe,CAAC;QAC7B;OAEDsP,IAAI,EAAE,CAACxP,KAAK,EAAEC,OAA2B,KACzC;SACC,MAAM4P,YAAY,GAAG7P,KAAK,CAACJ,KAAK,CAACqD,UAAU,CAAChD,OAAO,CAAC4B,QAAQ,CAAC;SAC7D,IAAI,CAACgO,YAAY,EACjB;WACC,OAAO,KAAK;;SAGb,MAAMjH,aAAa,GAAGtF,2BAAI,CAACkC,SAAS,EAAE;SACtC,IAAIqK,YAAY,CAACtC,QAAQ,CAAC/B,QAAQ,CAAC5C,aAAa,CAAC,EACjD;WACC,OAAO,KAAK;;SAEb,MAAM2E,QAAQ,GAAG,CAAC,GAAGsC,YAAY,CAACtC,QAAQ,EAAE3E,aAAa,CAAC;SAE1D5I,KAAK,CAACE,MAAM,CAAC,QAAQ,EAAE;WACtBqQ,UAAU,EAAE,MAAM;WAClB1O,QAAQ,EAAE5B,OAAO,CAAC4B,QAAQ;WAC1BpB,MAAM,EAAE,IAAI,CAACN,QAAQ,CAAC;aAACoN;YAAS;UAChC,CAAC;QACF;OAEDyD,MAAM,EAAE,CAAChR,KAAK,EAAEC,OAA2B,KAC3C;SACC,MAAM4P,YAAY,GAAG7P,KAAK,CAACJ,KAAK,CAACqD,UAAU,CAAChD,OAAO,CAAC4B,QAAQ,CAAC;SAC7D,IAAI,CAACgO,YAAY,EACjB;WACC,OAAO,KAAK;;SAGb,MAAMjH,aAAa,GAAGtF,2BAAI,CAACkC,SAAS,EAAE;SACtC,MAAM+H,QAAQ,GAAGsC,YAAY,CAACtC,QAAQ,CAAC/E,MAAM,CAACtD,IAAI,IAAIA,IAAI,KAAK0D,aAAa,CAAC;SAE7E5I,KAAK,CAACE,MAAM,CAAC,QAAQ,EAAE;WACtBqQ,UAAU,EAAE,QAAQ;WACpB1O,QAAQ,EAAE5B,OAAO,CAAC4B,QAAQ;WAC1BpB,MAAM,EAAE,IAAI,CAACN,QAAQ,CAAC;aAACoN;YAAS;UAChC,CAAC;QACF;OAED0D,cAAc,EAAE,CAACjR,KAAK,EAAEC,OAAe,KACvC;SACCD,KAAK,CAACE,MAAM,CAAC,gBAAgB,EAAE,IAAI,CAACgR,mBAAmB,CAACjR,OAAO,CAAC,CAAC;QACjE;OAEDkR,mBAAmB,EAAE,CAACnR,KAAK,EAAEC,OAG5B,KACD;SACC,MAAM;WAAC4B,QAAQ;WAAEpB,MAAM,EAAE;aAAC6E,MAAM;aAAE+K,QAAQ;aAAEnK,IAAI;aAAExC;;UAAW,GAAGzD,OAAO;SACvE,MAAM4P,YAA2B,GAAG7P,KAAK,CAACJ,KAAK,CAACqD,UAAU,CAACpB,QAAQ,CAAC;SACpE,IAAI,CAACgO,YAAY,EACjB;WACC,OAAO,KAAK;;SAGb,MAAMuB,mBAAmB,GAAG;WAC3BlE,cAAc,EAAE,CAAC;WACjBxJ,SAAS;WACTyJ,WAAW,EAAE;aACZ7H,MAAM;aACN+K,QAAQ;aACRnK,IAAI,EAAEuE,qBAAK,CAACvE,IAAI,CAAC4E,IAAI,CAAC5E,IAAI;;UAE3B;SACDlG,KAAK,CAACE,MAAM,CAAC,QAAQ,EAAE;WACtBqQ,UAAU,EAAE,qBAAqB;WACjC1O,QAAQ,EAAEA,QAAQ;WAClBpB,MAAM,EAAE;aACPwM,gBAAgB,EAAEmE;;UAEnB,CAAC;QACF;OAEDC,qBAAqB,EAAE,CAACrR,KAAK,EAAEC,OAA2B,KAC1D;SACC,MAAM4P,YAAY,GAAG7P,KAAK,CAACJ,KAAK,CAACqD,UAAU,CAAChD,OAAO,CAAC4B,QAAQ,CAAC;SAC7D,IAAI,CAACgO,YAAY,EACjB;WACC,OAAO,KAAK;;SAGb,MAAM;WAAC5C,gBAAgB,EAAEqE;UAAwB,GAAG,IAAI,CAAC9M,eAAe,EAAE;SAC1ExE,KAAK,CAACE,MAAM,CAAC,QAAQ,EAAE;WACtBqQ,UAAU,EAAE,uBAAuB;WACnC1O,QAAQ,EAAE5B,OAAO,CAAC4B,QAAQ;WAC1BpB,MAAM,EAAE;aACPwM,gBAAgB,EAAEqE;;UAEnB,CAAC;QACF;OAEDC,yBAAyB,EAAE,CAACvR,KAAK,EAAEC,OAA2B,KAC9D;SACC,MAAM4P,YAA2B,GAAG7P,KAAK,CAACJ,KAAK,CAACqD,UAAU,CAAChD,OAAO,CAAC4B,QAAQ,CAAC;SAC5E,IAAI,CAACgO,YAAY,EACjB;WACC,OAAO,KAAK;;SAGb,MAAM2B,UAAU,GAAG3B,YAAY,CAAC5C,gBAAgB,CAACC,cAAc,GAAG,CAAC;SACnElN,KAAK,CAACE,MAAM,CAAC,QAAQ,EAAE;WACtBqQ,UAAU,EAAE,2BAA2B;WACvC1O,QAAQ,EAAE5B,OAAO,CAAC4B,QAAQ;WAC1BpB,MAAM,EAAE;aACPwM,gBAAgB,EAAE;eAAC,GAAG4C,YAAY,CAAC5C,gBAAgB;eAAEC,cAAc,EAAEsE;;;UAEtE,CAAC;;MAEH;;GAGFpR,YAAY,GACZ;KACC,OAAO;OACN4D,GAAG,EAAE,CAACpE,KAAkB,EAAEK,OAAO,KACjC;SACCL,KAAK,CAACqD,UAAU,CAAChD,OAAO,CAAC4B,QAAQ,CAAC,GAAG5B,OAAO,CAACQ,MAAM;QACnD;OACDoC,MAAM,EAAE,CAACjD,KAAkB,EAAEK,OAAO,KACpC;SACCL,KAAK,CAACqD,UAAU,CAAChD,OAAO,CAAC4B,QAAQ,CAAC,GAAG;WAAC,GAAGjC,KAAK,CAACqD,UAAU,CAAChD,OAAO,CAAC4B,QAAQ,CAAC;WAAE,GAAG5B,OAAO,CAACQ;UAAO;QAC/F;OACDwD,MAAM,EAAE,CAACrE,KAAkB,EAAEK,OAAO,KACpC;SACC,OAAOL,KAAK,CAACqD,UAAU,CAAChD,OAAO,CAAC4B,QAAQ,CAAC;QACzC;OACDoP,cAAc,EAAE,CAACrR,KAAkB,EAAEK,OAAO,KAC5C;SACCL,KAAK,CAACyM,WAAW,GAAGpM,OAAO;QAC3B;OACD8Q,aAAa,EAAGnR,KAAkB,IAClC;SACCS,MAAM,CAACyC,IAAI,CAAClD,KAAK,CAACqD,UAAU,CAAC,CAAC1C,OAAO,CAACV,GAAG,IAAI;WAC5CD,KAAK,CAACqD,UAAU,CAACpD,GAAG,CAAC,CAAC+F,OAAO,GAAG,CAAC;WACjChG,KAAK,CAACqD,UAAU,CAACpD,GAAG,CAAC,CAACkN,QAAQ,GAAG,CAAC;UAClC,CAAC;;MAEH;;GAGFqD,uBAAuB,CAACnQ,OAA2C,EACnE;KACC,OAAOwR,UAAU,CAAC,MAAM;OACvB,IAAI,CAACzR,KAAK,CAAC0R,QAAQ,CAAC,uBAAuB,EAAE;SAC5C7P,QAAQ,EAAE5B,OAAO,CAAC4B,QAAQ;SAC1ByD,MAAM,EAAErF,OAAO,CAACqF;QAChB,CAAC;MACF,EAAE4G,mBAAmB,CAAC;;GAGxB/L,QAAQ,CAACM,MAAM,EACf;KACC,MAAMC,MAAM,GAAG,EAAE;KAEjB,IAAI,CAACC,cAAI,CAACiK,WAAW,CAACnK,MAAM,CAACkR,SAAS,CAAC,EACvC;OACClR,MAAM,CAACoB,QAAQ,GAAGpB,MAAM,CAACkR,SAAS;;KAEnC,IAAIhR,cAAI,CAACK,QAAQ,CAACP,MAAM,CAACoB,QAAQ,CAAC,IAAIlB,cAAI,CAACE,cAAc,CAACJ,MAAM,CAACoB,QAAQ,CAAC,EAC1E;OACCnB,MAAM,CAACmB,QAAQ,GAAGpB,MAAM,CAACoB,QAAQ,CAACC,QAAQ,EAAE;;KAG7C,IAAI,CAACnB,cAAI,CAACiK,WAAW,CAACnK,MAAM,CAACoK,OAAO,CAAC,EACrC;OACCpK,MAAM,CAAC0C,MAAM,GAAG1C,MAAM,CAACoK,OAAO;MAC9B,MACI,IAAI,CAAClK,cAAI,CAACiK,WAAW,CAACnK,MAAM,CAACuF,EAAE,CAAC,EACrC;OACCvF,MAAM,CAAC0C,MAAM,GAAG1C,MAAM,CAACuF,EAAE;;KAE1B,IAAIrF,cAAI,CAACK,QAAQ,CAACP,MAAM,CAAC0C,MAAM,CAAC,IAAIxC,cAAI,CAACE,cAAc,CAACJ,MAAM,CAAC0C,MAAM,CAAC,EACtE;OACCzC,MAAM,CAACyC,MAAM,GAAGrC,MAAM,CAACC,QAAQ,CAACN,MAAM,CAAC0C,MAAM,EAAE,EAAE,CAAC;;KAGnD,IAAIxC,cAAI,CAACE,cAAc,CAACJ,MAAM,CAAC6L,IAAI,CAAC,EACpC;OACC5L,MAAM,CAAC4L,IAAI,GAAG7L,MAAM,CAAC6L,IAAI,CAACxK,QAAQ,EAAE;;KAGrC,IAAInB,cAAI,CAACK,QAAQ,CAACP,MAAM,CAACgN,OAAO,CAAC,EACjC;OACC/M,MAAM,CAAC+M,OAAO,GAAG3M,MAAM,CAACC,QAAQ,CAACN,MAAM,CAACgN,OAAO,EAAE,EAAE,CAAC;;KAGrD,IAAI9M,cAAI,CAACK,QAAQ,CAACP,MAAM,CAACmF,OAAO,CAAC,IAAIjF,cAAI,CAACE,cAAc,CAACJ,MAAM,CAACmF,OAAO,CAAC,EACxE;OACClF,MAAM,CAACkF,OAAO,GAAG9E,MAAM,CAACC,QAAQ,CAACN,MAAM,CAACmF,OAAO,EAAE,EAAE,CAAC;;KAGrD,IAAI,CAACjF,cAAI,CAACiK,WAAW,CAACnK,MAAM,CAACmR,YAAY,CAAC,EAC1C;OACClR,MAAM,CAACmM,WAAW,GAAGpM,MAAM,CAACmR,YAAY;;KAEzC,IAAIjR,cAAI,CAACK,QAAQ,CAACP,MAAM,CAACoM,WAAW,CAAC,IAAIlM,cAAI,CAACE,cAAc,CAACJ,MAAM,CAACoM,WAAW,CAAC,EAChF;OACCnM,MAAM,CAACmM,WAAW,GAAG/L,MAAM,CAACC,QAAQ,CAACN,MAAM,CAACoM,WAAW,EAAE,EAAE,CAAC;;KAG7D,IAAI,CAAClM,cAAI,CAACiK,WAAW,CAACnK,MAAM,CAACoR,OAAO,CAAC,EACrC;OACCpR,MAAM,CAACqL,MAAM,GAAGrL,MAAM,CAACoR,OAAO;;KAE/B,IAAIlR,cAAI,CAACK,QAAQ,CAACP,MAAM,CAACqL,MAAM,CAAC,EAChC;OACCpL,MAAM,CAACoM,UAAU,GAAGrM,MAAM,CAACqL,MAAM;;KAGlC,IAAI,CAACnL,cAAI,CAACiK,WAAW,CAACnK,MAAM,CAACqR,SAAS,CAAC,EACvC;OACCrR,MAAM,CAACsM,QAAQ,GAAGtM,MAAM,CAACqR,SAAS;;KAEnC,IAAInR,cAAI,CAACK,QAAQ,CAACP,MAAM,CAACsM,QAAQ,CAAC,EAClC;OACCrM,MAAM,CAACqM,QAAQ,GAAGtM,MAAM,CAACsM,QAAQ;;KAGlC,IAAI,CAACpM,cAAI,CAACiK,WAAW,CAACnK,MAAM,CAACsR,eAAe,CAAC,EAC7C;OACCtR,MAAM,CAACuM,aAAa,GAAGvM,MAAM,CAACsR,eAAe;;KAE9C,IAAIpR,cAAI,CAACK,QAAQ,CAACP,MAAM,CAACuM,aAAa,CAAC,IAAIrM,cAAI,CAACE,cAAc,CAACJ,MAAM,CAACuM,aAAa,CAAC,EACpF;OACCtM,MAAM,CAACsM,aAAa,GAAGlM,MAAM,CAACC,QAAQ,CAACN,MAAM,CAACuM,aAAa,EAAE,EAAE,CAAC;;KAGjE,IAAIrM,cAAI,CAAC8I,aAAa,CAAChJ,MAAM,CAACuR,kBAAkB,CAAC,EACjD;OACCvR,MAAM,CAACwM,gBAAgB,GAAGxM,MAAM,CAACuR,kBAAkB;;KAEpD,IAAIrR,cAAI,CAAC8I,aAAa,CAAChJ,MAAM,CAACwM,gBAAgB,CAAC,EAC/C;OACCvM,MAAM,CAACuM,gBAAgB,GAAG,IAAI,CAACgF,uBAAuB,CAACxR,MAAM,CAACwM,gBAAgB,CAAC;;KAGhF,IAAItM,cAAI,CAACC,SAAS,CAACH,MAAM,CAACyN,WAAW,CAAC,EACtC;OACCxN,MAAM,CAACwN,WAAW,GAAGzN,MAAM,CAACyN,WAAW;;KAGxC,IAAIvN,cAAI,CAACC,SAAS,CAACH,MAAM,CAAC0N,WAAW,CAAC,EACtC;OACCzN,MAAM,CAACyN,WAAW,GAAG1N,MAAM,CAAC0N,WAAW;;KAGxC,IAAIxN,cAAI,CAACK,QAAQ,CAACP,MAAM,CAAC2M,sBAAsB,CAAC,EAChD;OACC1M,MAAM,CAAC0M,sBAAsB,GAAG3M,MAAM,CAAC2M,sBAAsB;;KAG9D,IAAI,CAACzM,cAAI,CAACiK,WAAW,CAACnK,MAAM,CAAC+M,eAAe,CAAC,EAC7C;OACC9M,MAAM,CAAC8M,eAAe,GAAG/M,MAAM,CAAC+M,eAAe,CAAC1L,QAAQ,EAAE;;KAG3D,IAAI,CAACnB,cAAI,CAACiK,WAAW,CAACnK,MAAM,CAACyR,KAAK,CAAC,EACnC;OACCzR,MAAM,CAACa,IAAI,GAAGb,MAAM,CAACyR,KAAK;;KAE3B,IAAIvR,cAAI,CAACK,QAAQ,CAACP,MAAM,CAACa,IAAI,CAAC,IAAIX,cAAI,CAACE,cAAc,CAACJ,MAAM,CAACa,IAAI,CAAC,EAClE;OACCZ,MAAM,CAACY,IAAI,GAAG6Q,cAAI,CAACC,MAAM,CAAC3R,MAAM,CAACa,IAAI,CAACQ,QAAQ,EAAE,CAAC;;KAGlD,IAAI,CAACnB,cAAI,CAACiK,WAAW,CAACnK,MAAM,CAACiN,KAAK,CAAC,EACnC;OACCjN,MAAM,CAAC4R,OAAO,GAAG5R,MAAM,CAACiN,KAAK;;KAE9B,IAAI/M,cAAI,CAACK,QAAQ,CAACP,MAAM,CAAC4R,OAAO,CAAC,IAAI1R,cAAI,CAACE,cAAc,CAACJ,MAAM,CAAC4R,OAAO,CAAC,EACxE;OACC3R,MAAM,CAACgN,KAAK,GAAG5M,MAAM,CAACC,QAAQ,CAACN,MAAM,CAAC4R,OAAO,EAAE,EAAE,CAAC;;KAGnD,IAAI1R,cAAI,CAACoK,QAAQ,CAACtK,MAAM,CAACgM,MAAM,CAAC,EAChC;OACC/L,MAAM,CAAC+L,MAAM,GAAG,IAAI,CAAC6F,aAAa,CAAC7R,MAAM,CAACgM,MAAM,CAAC;;KAGlD,IAAI9L,cAAI,CAACE,cAAc,CAACJ,MAAM,CAACiM,KAAK,CAAC,EACrC;OACChM,MAAM,CAACgM,KAAK,GAAGjM,MAAM,CAACiM,KAAK;;KAG5B,IAAI/L,cAAI,CAACC,SAAS,CAACH,MAAM,CAACmM,QAAQ,CAAC,EACnC;OACClM,MAAM,CAACkM,QAAQ,GAAGnM,MAAM,CAACmM,QAAQ;;KAGlC,IAAI,CAACjM,cAAI,CAACiK,WAAW,CAACnK,MAAM,CAAC8R,WAAW,CAAC,EACzC;OACC9R,MAAM,CAACkN,UAAU,GAAGlN,MAAM,CAAC8R,WAAW;;KAEvC,IAAI5R,cAAI,CAACE,cAAc,CAACJ,MAAM,CAACkN,UAAU,CAAC,EAC1C;OACCjN,MAAM,CAACiN,UAAU,GAAGlN,MAAM,CAACkN,UAAU;;KAEtC,IAAI,CAAChN,cAAI,CAACiK,WAAW,CAACnK,MAAM,CAAC+R,SAAS,CAAC,EACvC;OACC/R,MAAM,CAACgB,QAAQ,GAAGhB,MAAM,CAAC+R,SAAS;;KAEnC,IAAI7R,cAAI,CAACK,QAAQ,CAACP,MAAM,CAACgB,QAAQ,CAAC,IAAId,cAAI,CAACE,cAAc,CAACJ,MAAM,CAACgB,QAAQ,CAAC,EAC1E;OACCf,MAAM,CAACe,QAAQ,GAAGhB,MAAM,CAACgB,QAAQ,CAACK,QAAQ,EAAE;;KAG7C,IAAI,CAACnB,cAAI,CAACiK,WAAW,CAACnK,MAAM,CAACgS,WAAW,CAAC,EACzC;OACChS,MAAM,CAACmN,UAAU,GAAGnN,MAAM,CAACgS,WAAW;;KAEvC,IAAI,CAAC9R,cAAI,CAACiK,WAAW,CAACnK,MAAM,CAACmN,UAAU,CAAC,EACxC;OACClN,MAAM,CAACkN,UAAU,GAAGnD,qBAAK,CAACvE,IAAI,CAAC4E,IAAI,CAACrK,MAAM,CAACmN,UAAU,CAAC;;KAGvD,IAAIjN,cAAI,CAAC8I,aAAa,CAAChJ,MAAM,CAACoN,MAAM,CAAC,EACrC;OACCnN,MAAM,CAACmN,MAAM,GAAG,EAAE;OAElB,IAAIlN,cAAI,CAACE,cAAc,CAACJ,MAAM,CAACoN,MAAM,CAACC,IAAI,CAAC,EAC3C;SACCpN,MAAM,CAACmN,MAAM,CAACC,IAAI,GAAGrN,MAAM,CAACoN,MAAM,CAACC,IAAI;;OAGxC,IAAInN,cAAI,CAACE,cAAc,CAACJ,MAAM,CAACoN,MAAM,CAACE,IAAI,CAAC,EAC3C;SACCrN,MAAM,CAACmN,MAAM,CAACE,IAAI,GAAGtN,MAAM,CAACoN,MAAM,CAACE,IAAI;;;KAIzC,IAAI,CAACpN,cAAI,CAACiK,WAAW,CAACnK,MAAM,CAACiS,YAAY,CAAC,EAC1C;OACCjS,MAAM,CAAC6M,WAAW,GAAG7M,MAAM,CAACiS,YAAY;;KAEzC,IAAI/R,cAAI,CAAC6I,OAAO,CAAC/I,MAAM,CAAC6M,WAAW,CAAC,EACpC;OACC5M,MAAM,CAAC4M,WAAW,GAAG,IAAI,CAACqF,kBAAkB,CAAClS,MAAM,CAAC6M,WAAW,CAAC;;KAGjE,IAAI,CAAC3M,cAAI,CAACiK,WAAW,CAACnK,MAAM,CAACmS,YAAY,CAAC,EAC1C;OACCnS,MAAM,CAAC4M,WAAW,GAAG5M,MAAM,CAACmS,YAAY;;KAEzC,IAAIjS,cAAI,CAAC6I,OAAO,CAAC/I,MAAM,CAAC4M,WAAW,CAAC,EACpC;OACC3M,MAAM,CAAC2M,WAAW,GAAG,EAAE;OAEvB5M,MAAM,CAAC4M,WAAW,CAAC9M,OAAO,CAAC+E,MAAM,IACjC;SACCA,MAAM,GAAGxE,MAAM,CAACC,QAAQ,CAACuE,MAAM,EAAE,EAAE,CAAC;SACpC,IAAIA,MAAM,GAAG,CAAC,EACd;WACC5E,MAAM,CAAC2M,WAAW,CAACvF,IAAI,CAACxC,MAAM,CAAC;;QAEhC,CAAC;;KAGH,IAAI,CAAC3E,cAAI,CAACiK,WAAW,CAACnK,MAAM,CAACoS,SAAS,CAAC,EACvC;OACCpS,MAAM,CAAC8M,QAAQ,GAAG9M,MAAM,CAACoS,SAAS;;KAEnC,IAAIlS,cAAI,CAAC6I,OAAO,CAAC/I,MAAM,CAAC8M,QAAQ,CAAC,IAAI5M,cAAI,CAAC8I,aAAa,CAAChJ,MAAM,CAAC8M,QAAQ,CAAC,EACxE;OACC7M,MAAM,CAAC6M,QAAQ,GAAG,IAAI,CAACuF,eAAe,CAACrS,MAAM,CAAC8M,QAAQ,CAAC;;KAGxD,IAAI5M,cAAI,CAACC,SAAS,CAACH,MAAM,CAACuN,MAAM,CAAC,EACjC;OACCtN,MAAM,CAACsN,MAAM,GAAGvN,MAAM,CAACuN,MAAM;;KAG9B,IAAIrN,cAAI,CAACC,SAAS,CAACH,MAAM,CAACwN,OAAO,CAAC,EAClC;OACCvN,MAAM,CAACuN,OAAO,GAAGxN,MAAM,CAACwN,OAAO;;KAGhC,IAAItN,cAAI,CAACoK,QAAQ,CAACtK,MAAM,CAAC+L,WAAW,CAAC,EACrC;OACC9L,MAAM,CAAC8L,WAAW,GAAG/L,MAAM,CAAC+L,WAAW;;KAGxC,IAAI7L,cAAI,CAACK,QAAQ,CAACP,MAAM,CAACsS,cAAc,CAAC,EACxC;OACCrS,MAAM,CAAC0N,YAAY,GAAG3N,MAAM,CAACsS,cAAc;;KAG5C,OAAOrS,MAAM;;GAGd4R,aAAa,CAAC7F,MAAc,EAC5B;KACC,IAAI/L,MAAM,GAAG,EAAE;KAEf,IAAI,CAAC+L,MAAM,IAAIA,MAAM,CAACuG,QAAQ,CAAC,yBAAyB,CAAC,EACzD;OACCtS,MAAM,GAAG,EAAE;MACX,MACI,IAAI+L,MAAM,CAACwG,UAAU,CAAC,MAAM,CAAC,EAClC;OACCvS,MAAM,GAAG+L,MAAM;MACf,MAED;OACC/L,MAAM,GAAG4C,2BAAI,CAAC4P,OAAO,EAAE,GAAGzG,MAAM;;KAGjC,IAAI/L,MAAM,EACV;OACCA,MAAM,GAAGyS,SAAS,CAACzS,MAAM,CAAC;;KAG3B,OAAOA,MAAM;;GAGdiS,kBAAkB,CAACrF,WAAqB,EACxC;KACC,MAAM5M,MAAM,GAAG,EAAE;KAEjB4M,WAAW,CAAC/M,OAAO,CAACqL,OAAO,IAC3B;OACC,MAAM1G,IAAI,GAAG,EAAE;OAEf,IAAI,CAAC0G,OAAO,CAACtG,MAAM,EACnB;SACC,OAAO,KAAK;;OAGbJ,IAAI,CAACI,MAAM,GAAGxE,MAAM,CAACC,QAAQ,CAAC6K,OAAO,CAACtG,MAAM,EAAE,EAAE,CAAC;OACjDJ,IAAI,CAACmL,QAAQ,GAAG5F,qBAAK,CAACrE,IAAI,CAACgN,oBAAoB,CAACxH,OAAO,CAACyE,QAAQ,CAAC;OAEjE3P,MAAM,CAACoH,IAAI,CAAC5C,IAAI,CAAC;MACjB,CAAC;KAEF,OAAOxE,MAAM;;GAGdoS,eAAe,CAACvF,QAA2B,EAC3C;KACC,MAAM7M,MAAM,GAAG,EAAE;KAEjB,IAAIC,cAAI,CAAC6I,OAAO,CAAC+D,QAAQ,CAAC,EAC1B;OACCA,QAAQ,CAAChN,OAAO,CAAC+E,MAAM,IACvB;SACCA,MAAM,GAAGxE,MAAM,CAACC,QAAQ,CAACuE,MAAM,EAAE,EAAE,CAAC;SACpC,IAAIA,MAAM,GAAG,CAAC,EACd;WACC5E,MAAM,CAACoH,IAAI,CAACxC,MAAM,CAAC;;QAEpB,CAAC;MACF,MACI,IAAI3E,cAAI,CAAC8I,aAAa,CAAC8D,QAAQ,CAAC,EACrC;OACClN,MAAM,CAACC,OAAO,CAACiN,QAAQ,CAAC,CAAChN,OAAO,CAAC,CAAC,CAACV,GAAG,EAAEW,KAAK,CAAC,KAAK;SAClD,IAAI,CAACA,KAAK,EACV;WACC;;SAED,MAAM8E,MAAM,GAAGxE,MAAM,CAACC,QAAQ,CAAClB,GAAG,EAAE,EAAE,CAAC;SACvC,IAAIyF,MAAM,GAAG,CAAC,EACd;WACC5E,MAAM,CAACoH,IAAI,CAACxC,MAAM,CAAC;;QAEpB,CAAC;;KAGH,OAAO5E,MAAM;;GAGduR,uBAAuB,CAACoB,mBAAmB,EAC3C;KACC,MAAM;OACLnG,cAAc;OACdoG,YAAY,EAAEC,eAAe;OAC7B7P;MACA,GAAG2P,mBAAmB;KAEvB,IAAIlG,WAAW;KACf,KAAK,MAAMqG,cAAc,IAAID,eAAe,EAC5C;OACC,IAAIC,cAAc,CAAClO,MAAM,KAAKhC,2BAAI,CAACkC,SAAS,EAAE,EAC9C;SACC;;OAGD2H,WAAW,GAAG;SACb7H,MAAM,EAAEkO,cAAc,CAAClO,MAAM;SAC7B+K,QAAQ,EAAEmD,cAAc,CAACnD,QAAQ;SACjCnK,IAAI,EAAEuE,qBAAK,CAACvE,IAAI,CAAC4E,IAAI,CAAC0I,cAAc,CAACtN,IAAI;QACzC;OACD;;KAGD,IAAIgH,cAAc,GAAG,CAAC,IAAI,CAACC,WAAW,EACtC;OACC,MAAM,IAAIsG,KAAK,CAAC,8CAA8C,CAAC;;KAGhE,OAAO;OACNvG,cAAc;OACdC,WAAW;OACXzJ;MACA;;GAGFwN,mBAAmB,CAACwC,OAAe,EACnC;KACC,MAAMhT,MAAM,GAAG,EAAE;KAEjBL,MAAM,CAACC,OAAO,CAACoT,OAAO,CAAC,CAACnT,OAAO,CAAC,CAAC,CAAC+L,IAAI,EAAEqH,WAAW,CAAC,KAAK;OACxD,MAAMC,OAAO,GAAGnJ,qBAAK,CAACrE,IAAI,CAACyN,uBAAuB,CAACvH,IAAI,CAACwH,WAAW,EAAE,CAAC;OACtEpT,MAAM,CAACkT,OAAO,CAAC,GAAG,EAAE;OACpBvT,MAAM,CAACC,OAAO,CAACqT,WAAW,CAAC,CAACpT,OAAO,CAAC,CAAC,CAACV,GAAG,EAAEW,KAAK,CAAC,KAAK;SACrD,MAAMuT,MAAM,GAAGtJ,qBAAK,CAACrE,IAAI,CAACyN,uBAAuB,CAAChU,GAAG,CAACiU,WAAW,EAAE,CAAC;SACpEpT,MAAM,CAACkT,OAAO,CAAC,CAACG,MAAM,CAAC,GAAGvT,KAAK;QAC/B,CAAC;MACF,CAAC;KAEF,OAAOE,MAAM;;CAEf;;CC54BO,MAAMsT,UAAU,SAASnV,yBAAY,CAC5C;GACCqC,OAAO,GACP;KACC,OAAO,OAAO;;GAGfpC,QAAQ,GACR;KACC,OAAO;OACNmE,UAAU,EAAE,EAAE;OACdgR,UAAU,EAAE,EAAE;OACdC,gBAAgB,EAAE,EAAE;OACpBC,UAAU,EAAE,EAAE;OACdC,OAAO,EAAE;MACT;;GAGF5P,eAAe,CAAC2G,MAAM,GAAG,EAAE,EAC3B;KACC,MAAM;OAACnF,EAAE,GAAG;MAAE,GAAGmF,MAAM;KAEvB,OAAO;OACNnF,EAAE;OACF1E,IAAI,EAAE,EAAE;OACR+S,SAAS,EAAE,EAAE;OACbC,QAAQ,EAAE,EAAE;OACZ7H,MAAM,EAAE,EAAE;OACVC,KAAK,EAAEC,iBAAK,CAAC3F,IAAI;OACjBuN,YAAY,EAAE,EAAE;OAChBC,MAAM,EAAE,GAAG;OACXC,OAAO,EAAE,KAAK;OACd7H,QAAQ,EAAE,KAAK;OACf8H,OAAO,EAAE,KAAK;OACdC,GAAG,EAAE,KAAK;OACVC,SAAS,EAAE,KAAK;OAChBC,cAAc,EAAE,SAAS;OACzBC,MAAM,EAAE,EAAE;OACVC,IAAI,EAAE,KAAK;OACXC,gBAAgB,EAAE,KAAK;OACvBC,cAAc,EAAE,KAAK;OACrBC,QAAQ,EAAE,KAAK;OACfC,cAAc,EAAE,KAAK;OACrBC,QAAQ,EAAE,KAAK;OACfC,UAAU,EAAE,KAAK;OACjBC,MAAM,EAAE,KAAK;OACbC,QAAQ,EAAE,KAAK;OACfC,WAAW,EAAE,EAAE;OACfC,MAAM,EAAE;SACPC,SAAS,EAAE,EAAE;SACbC,cAAc,EAAE,EAAE;SAClBC,aAAa,EAAE,EAAE;SACjBC,UAAU,EAAE;;MAEb;;GAGFnW,UAAU,GACV;KACC,OAAO;;OAENC,GAAG,EAAEC,KAAK,IAAI,CAAC0F,MAAM,EAAEwQ,YAAY,GAAG,KAAK,KAC3C;SACCxQ,MAAM,GAAGxE,MAAM,CAACC,QAAQ,CAACuE,MAAM,EAAE,EAAE,CAAC;SAEpC,IAAIA,MAAM,IAAI,CAAC,EACf;WACC,IAAIwQ,YAAY,EAChB;aACCxQ,MAAM,GAAG,CAAC;YACV,MAED;aACC,OAAO,IAAI;;;SAIb,MAAMuJ,IAAI,GAAGjP,KAAK,CAACqD,UAAU,CAACqC,MAAM,CAAC;SAErC,IAAI,CAACwQ,YAAY,IAAI,CAACjH,IAAI,EAC1B;WACC,OAAO,IAAI;UACX,MACI,IAAIiH,YAAY,IAAI,CAACjH,IAAI,EAC9B;WACC,OAAO,IAAI,CAACrK,eAAe,CAAC;aAACwB,EAAE,EAAEV;YAAO,CAAC;;SAG1C,OAAOuJ,IAAI;QACX;;OAEDR,QAAQ,EAAE,MAAMlD,MAAM,IACtB;SACC,OAAO,IAAI,CAAC3G,eAAe,CAAC2G,MAAM,CAAC;QACnC;;OAED4K,OAAO,EAAEnW,KAAK,IAAKoW,QAAQ,IAAK;SAC/B,MAAMtV,MAAM,GAAG,EAAE;SAEjB,IAAI,CAAC6I,KAAK,CAACC,OAAO,CAACwM,QAAQ,CAAC,EAC5B;WACC,OAAO,IAAI;;SAGZA,QAAQ,CAACzV,OAAO,CAACyF,EAAE,IAAI;WACtB,IAAIpG,KAAK,CAACqD,UAAU,CAAC+C,EAAE,CAAC,EACxB;aACCtF,MAAM,CAACoH,IAAI,CAAClI,KAAK,CAACqD,UAAU,CAAC+C,EAAE,CAAC,CAAC;YACjC,MAED;aACCtF,MAAM,CAACoH,IAAI,CAAC,IAAI,CAACtD,eAAe,CAAC;eAACwB;cAAG,CAAC,CAAC;;UAExC,CAAC;SAEF,OAAOtF,MAAM;QACb;;OAEDuV,WAAW,EAAErW,KAAK,IAAI0F,MAAM,IAAI;SAC/BA,MAAM,GAAGxE,MAAM,CAACC,QAAQ,CAACuE,MAAM,EAAE,EAAE,CAAC;SAEpC,MAAMuJ,IAAI,GAAGjP,KAAK,CAACqD,UAAU,CAACqC,MAAM,CAAC;SACrC,IAAIA,MAAM,IAAI,CAAC,IAAI,CAACuJ,IAAI,EACxB;WACC,OAAO,KAAK;;SAGb,OAAOA,IAAI,CAACwG,UAAU;QACtB;;OAEDa,WAAW,EAAEtW,KAAK,IAAI0F,MAAM,IAAI;SAC/BA,MAAM,GAAGxE,MAAM,CAACC,QAAQ,CAACuE,MAAM,EAAE,EAAE,CAAC;SAEpC,MAAMuJ,IAAI,GAAGjP,KAAK,CAACqD,UAAU,CAACqC,MAAM,CAAC;SACrC,IAAIA,MAAM,IAAI,CAAC,IAAI,CAACuJ,IAAI,EACxB;WACC,OAAO,KAAK;;SAGb,OAAOA,IAAI,CAAC0G,QAAQ;QACpB;;OAEDY,SAAS,EAAEvW,KAAK,IAAI0F,MAAM,IAAI;SAC7BA,MAAM,GAAGxE,MAAM,CAACC,QAAQ,CAACuE,MAAM,EAAE,EAAE,CAAC;SAEpC,MAAMuJ,IAAI,GAAGjP,KAAK,CAACqD,UAAU,CAACqC,MAAM,CAAC;SACrC,IAAIA,MAAM,IAAI,CAAC,IAAI,CAACuJ,IAAI,EACxB;WACC,OAAO,KAAK;;SAGb,IAAI,CAACA,IAAI,CAACqG,QAAQ,EAClB;WACC,OAAO,EAAE;;SAGV,IAAIrG,IAAI,CAACsG,cAAc,EACvB;WACC,OAAOiB,sBAAU,CAACC,YAAY;UAC9B,MACI,IAAIxH,IAAI,CAACkG,IAAI,EAClB;;WAEC,OAAOqB,sBAAU,CAACrB,IAAI;UACtB,MAED;;WAEC,OAAOlG,IAAI,CAACiG,MAAM;;QAEnB;;OAEDwB,aAAa,EAAE1W,KAAK,IAAI0F,MAAM,IAAI;SACjCA,MAAM,GAAGxE,MAAM,CAACC,QAAQ,CAACuE,MAAM,EAAE,EAAE,CAAC;SAEpC,MAAMuJ,IAAI,GAAGjP,KAAK,CAACqD,UAAU,CAACqC,MAAM,CAAC;SACrC,IAAIA,MAAM,IAAI,CAAC,IAAI,CAACuJ,IAAI,EACxB;WACC,OAAO,EAAE;;SAGV,OAAOpE,qBAAK,CAACoE,IAAI,CAAC0H,eAAe,CAAC1H,IAAI,CAAC;QACvC;;OAED2H,WAAW,EAAE5W,KAAK,IAAI0F,MAAM,IAAI;SAC/BA,MAAM,GAAGxE,MAAM,CAACC,QAAQ,CAACuE,MAAM,EAAE,EAAE,CAAC;SAEpC,MAAMuJ,IAAI,GAAGjP,KAAK,CAACqD,UAAU,CAACqC,MAAM,CAAC;SACrC,IAAIA,MAAM,IAAI,CAAC,IAAI,CAACuJ,IAAI,EACxB;WACC,OAAO,EAAE;;SAGV,IAAIA,IAAI,CAAC0F,YAAY,EACrB;WACC,OAAO1F,IAAI,CAAC0F,YAAY;;SAGzB,OAAOkC,aAAG,CAACC,UAAU,CAAC,6BAA6B,CAAC;QACpD;;OAEDC,UAAU,EAAE/W,KAAK,IAAI0F,MAAM,IAAI;SAC9BA,MAAM,GAAGxE,MAAM,CAACC,QAAQ,CAACuE,MAAM,EAAE,EAAE,CAAC;SAEpC,MAAMuJ,IAAI,GAAGjP,KAAK,CAACqD,UAAU,CAACqC,MAAM,CAAC;SACrC,IAAIA,MAAM,IAAI,CAAC,IAAI,CAACuJ,IAAI,IAAI,CAACA,IAAI,CAAC8F,GAAG,IAAI,CAAC/U,KAAK,CAACwU,OAAO,CAAC9O,MAAM,CAAC,EAC/D;WACC,OAAO,EAAE;;SAGV,MAAMsR,OAAO,GAAGhX,KAAK,CAACwU,OAAO,CAAC9O,MAAM,CAAC,CAACgH,IAAI;SAE1C,IAAI,CAACuK,mBAAO,CAACD,OAAO,CAAC,EACrB;WACC,OAAOC,mBAAO,CAAClC,GAAG;;SAGnB,OAAOiC,OAAO;;MAEf;;GAGF9W,UAAU,GACV;KACC,OAAO;;OAENC,GAAG,EAAE,CAACC,KAAK,EAAEC,OAAO,KACpB;SACC,IAAI,CAACsJ,KAAK,CAACC,OAAO,CAACvJ,OAAO,CAAC,IAAIU,cAAI,CAAC8I,aAAa,CAACxJ,OAAO,CAAC,EAC1D;WACCA,OAAO,GAAG,CAACA,OAAO,CAAC;;SAGpBA,OAAO,CAACmD,GAAG,CAACyL,IAAI,IAAI;WACnB,OAAO,IAAI,CAAC1O,QAAQ,CAAC0O,IAAI,CAAC;UAC1B,CAAC,CAACtO,OAAO,CAACsO,IAAI,IAAI;WAClB,MAAMiI,YAAY,GAAG9W,KAAK,CAACJ,KAAK,CAACqD,UAAU,CAAC4L,IAAI,CAAC7I,EAAE,CAAC;WACpD,IAAI8Q,YAAY,EAChB;aACC9W,KAAK,CAACE,MAAM,CAAC,QAAQ,EAAE;eACtB8F,EAAE,EAAE6I,IAAI,CAAC7I,EAAE;eACXvF,MAAM,EAAEoO;cACR,CAAC;YACF,MAED;aACC7O,KAAK,CAACE,MAAM,CAAC,KAAK,EAAE;eACnB8F,EAAE,EAAE6I,IAAI,CAAC7I,EAAE;eACXvF,MAAM,EAAE;iBAAC,GAAG,IAAI,CAAC+D,eAAe,EAAE;iBAAE,GAAGqK;;cACvC,CAAC;;UAEH,CAAC;QACF;;OAED7K,GAAG,EAAE,CAAChE,KAAK,EAAEC,OAAO,KACpB;SACC,IAAI,CAACsJ,KAAK,CAACC,OAAO,CAACvJ,OAAO,CAAC,IAAIU,cAAI,CAAC8I,aAAa,CAACxJ,OAAO,CAAC,EAC1D;WACCA,OAAO,GAAG,CAACA,OAAO,CAAC;;SAGpBA,OAAO,CAACmD,GAAG,CAACyL,IAAI,IAAI;WACnB,OAAO,IAAI,CAAC1O,QAAQ,CAAC0O,IAAI,CAAC;UAC1B,CAAC,CAACtO,OAAO,CAACsO,IAAI,IAAI;WAClB,MAAMiI,YAAY,GAAG9W,KAAK,CAACJ,KAAK,CAACqD,UAAU,CAAC4L,IAAI,CAAC7I,EAAE,CAAC;WACpD,IAAI,CAAC8Q,YAAY,EACjB;aACC9W,KAAK,CAACE,MAAM,CAAC,KAAK,EAAE;eACnB8F,EAAE,EAAE6I,IAAI,CAAC7I,EAAE;eACXvF,MAAM,EAAE;iBAAC,GAAG,IAAI,CAAC+D,eAAe,EAAE;iBAAE,GAAGqK;;cACvC,CAAC;;UAEH,CAAC;QACF;;OAEDhM,MAAM,EAAE,CAAC7C,KAAK,EAAEC,OAAO,KACvB;SACCA,OAAO,CAAC+F,EAAE,GAAGlF,MAAM,CAACC,QAAQ,CAACd,OAAO,CAAC+F,EAAE,EAAE,EAAE,CAAC;SAE5C,MAAM6I,IAAI,GAAG7O,KAAK,CAACJ,KAAK,CAACqD,UAAU,CAAChD,OAAO,CAAC+F,EAAE,CAAC;SAC/C,IAAI,CAAC6I,IAAI,EACT;WACC,OAAO,KAAK;;SAGb7O,KAAK,CAACE,MAAM,CAAC,QAAQ,EAAE;WACtB8F,EAAE,EAAE/F,OAAO,CAAC+F,EAAE;WACdvF,MAAM,EAAE,IAAI,CAACN,QAAQ,CAACF,OAAO,CAACQ,MAAM;UACpC,CAAC;QACF;;OAEDwD,MAAM,EAAE,CAACjE,KAAK,EAAEC,OAAO,KACvB;SACCD,KAAK,CAACE,MAAM,CAAC,QAAQ,EAAED,OAAO,CAAC+F,EAAE,CAAC;QAClC;;OAED+Q,UAAU,EAAE,CAAC/W,KAAK,EAAEC,OAAO,KAC3B;SACCD,KAAK,CAACE,MAAM,CAAC,YAAY,EAAED,OAAO,CAAC;QACnC;;OAED+W,SAAS,EAAE,CAAChX,KAAK,EAAEC,OAAyB,KAC5C;SACCD,KAAK,CAACE,MAAM,CAAC,QAAQ,EAAE;WACtB8F,EAAE,EAAE1C,2BAAI,CAACkC,SAAS,EAAE;WACpB/E,MAAM,EAAE,IAAI,CAACN,QAAQ,CAACF,OAAO;UAC7B,CAAC;;MAEH;;GAGFG,YAAY,GACZ;KACC,OAAO;OACN4D,GAAG,EAAE,CAACpE,KAAK,EAAEK,OAAO,KAAK;;SAExBL,KAAK,CAACqD,UAAU,CAAChD,OAAO,CAAC+F,EAAE,CAAC,GAAG/F,OAAO,CAACQ,MAAM;SAE7C,IAAI,CAACwW,qBAAqB,CAACrX,KAAK,EAAEK,OAAO,CAACQ,MAAM,CAAC;SAEjD,IAAI,CAACyW,wBAAwB,EAAE;SAC/B,IAAI,CAACC,wBAAwB,EAAE;QAC/B;OACDtU,MAAM,EAAE,CAACjD,KAAK,EAAEK,OAAO,KAAK;;SAE3BL,KAAK,CAACqD,UAAU,CAAChD,OAAO,CAAC+F,EAAE,CAAC,GAAG;WAAE,GAAGpG,KAAK,CAACqD,UAAU,CAAChD,OAAO,CAAC+F,EAAE,CAAC;WAAE,GAAG/F,OAAO,CAACQ;UAAQ;SAErF,IAAI,CAACwW,qBAAqB,CAACrX,KAAK,EAAEK,OAAO,CAACQ,MAAM,CAAC;QACjD;OACDwD,MAAM,EAAE,CAACrE,KAAK,EAAEK,OAAO,KAAK;;SAE3B,OAAOL,KAAK,CAACqD,UAAU,CAAChD,OAAO,CAAC+F,EAAE,CAAC;QACnC;OACD+Q,UAAU,EAAE,CAACnX,KAAK,EAAEK,OAAO,KAAK;;SAE/BL,KAAK,CAACwU,OAAO,GAAGnU,OAAO;;MAExB;;GAGFE,QAAQ,CAACM,MAAM,EACf;KACC,MAAMC,MAAM,GAAG,EAAE;KAEjB,IAAIC,cAAI,CAACK,QAAQ,CAACP,MAAM,CAACuF,EAAE,CAAC,IAAIrF,cAAI,CAACoK,QAAQ,CAACtK,MAAM,CAACuF,EAAE,CAAC,EACxD;OACCtF,MAAM,CAACsF,EAAE,GAAGlF,MAAM,CAACC,QAAQ,CAACN,MAAM,CAACuF,EAAE,EAAE,EAAE,CAAC;;KAG3C,IAAIrF,cAAI,CAACE,cAAc,CAACJ,MAAM,CAAC2W,UAAU,CAAC,EAC1C;OACC3W,MAAM,CAAC4T,SAAS,GAAG5T,MAAM,CAAC2W,UAAU;;KAErC,IAAIzW,cAAI,CAACE,cAAc,CAACJ,MAAM,CAAC4W,SAAS,CAAC,EACzC;OACC5W,MAAM,CAAC6T,QAAQ,GAAG7T,MAAM,CAAC4W,SAAS;;KAEnC,IAAI1W,cAAI,CAACE,cAAc,CAACJ,MAAM,CAAC4T,SAAS,CAAC,EACzC;OACC3T,MAAM,CAAC2T,SAAS,GAAG5J,qBAAK,CAACrE,IAAI,CAACgN,oBAAoB,CAAC3S,MAAM,CAAC4T,SAAS,CAAC;;KAErE,IAAI1T,cAAI,CAACE,cAAc,CAACJ,MAAM,CAAC6T,QAAQ,CAAC,EACxC;OACC5T,MAAM,CAAC4T,QAAQ,GAAG7J,qBAAK,CAACrE,IAAI,CAACgN,oBAAoB,CAAC3S,MAAM,CAAC6T,QAAQ,CAAC;;KAEnE,IAAI3T,cAAI,CAACE,cAAc,CAACJ,MAAM,CAACa,IAAI,CAAC,EACpC;OACCb,MAAM,CAACa,IAAI,GAAGmJ,qBAAK,CAACrE,IAAI,CAACgN,oBAAoB,CAAC3S,MAAM,CAACa,IAAI,CAAC;OAC1DZ,MAAM,CAACY,IAAI,GAAGb,MAAM,CAACa,IAAI;;KAG1B,IAAIX,cAAI,CAACE,cAAc,CAACJ,MAAM,CAACiM,KAAK,CAAC,EACrC;OACChM,MAAM,CAACgM,KAAK,GAAGjM,MAAM,CAACiM,KAAK;;KAG5B,IAAI/L,cAAI,CAACE,cAAc,CAACJ,MAAM,CAACgM,MAAM,CAAC,EACtC;OACC/L,MAAM,CAAC+L,MAAM,GAAG,IAAI,CAAC6F,aAAa,CAAC7R,MAAM,CAACgM,MAAM,CAAC;;KAGlD,IAAI9L,cAAI,CAACE,cAAc,CAACJ,MAAM,CAAC6W,aAAa,CAAC,EAC7C;OACC7W,MAAM,CAAC8T,YAAY,GAAG9T,MAAM,CAAC6W,aAAa;;KAE3C,IAAI3W,cAAI,CAACE,cAAc,CAACJ,MAAM,CAAC8T,YAAY,CAAC,EAC5C;OACC7T,MAAM,CAAC6T,YAAY,GAAG9J,qBAAK,CAACrE,IAAI,CAACgN,oBAAoB,CAAC3S,MAAM,CAAC8T,YAAY,CAAC;;KAG3E,IAAI5T,cAAI,CAACE,cAAc,CAACJ,MAAM,CAAC+T,MAAM,CAAC,EACtC;OACC9T,MAAM,CAAC8T,MAAM,GAAG/T,MAAM,CAAC+T,MAAM,KAAK,GAAG,GAAE,GAAG,GAAE,GAAG;;KAGhD,IAAI7T,cAAI,CAACE,cAAc,CAACJ,MAAM,CAAC2U,QAAQ,CAAC,EACxC;OACC1U,MAAM,CAAC0U,QAAQ,GAAG3U,MAAM,CAAC2U,QAAQ;;KAGlC,IAAIzU,cAAI,CAACC,SAAS,CAACH,MAAM,CAACgU,OAAO,CAAC,EAClC;OACC/T,MAAM,CAAC+T,OAAO,GAAGhU,MAAM,CAACgU,OAAO;;KAGhC,IAAI9T,cAAI,CAACC,SAAS,CAACH,MAAM,CAACmM,QAAQ,CAAC,EACnC;OACClM,MAAM,CAACkM,QAAQ,GAAGnM,MAAM,CAACmM,QAAQ;;KAGlC,IAAIjM,cAAI,CAACC,SAAS,CAACH,MAAM,CAACiU,OAAO,CAAC,EAClC;OACChU,MAAM,CAACgU,OAAO,GAAGjU,MAAM,CAACiU,OAAO;;KAGhC,IAAI/T,cAAI,CAACC,SAAS,CAACH,MAAM,CAACkU,GAAG,CAAC,EAC9B;OACCjU,MAAM,CAACiU,GAAG,GAAGlU,MAAM,CAACkU,GAAG;;KAGxB,IAAIhU,cAAI,CAACC,SAAS,CAACH,MAAM,CAACmU,SAAS,CAAC,EACpC;OACClU,MAAM,CAACkU,SAAS,GAAGnU,MAAM,CAACmU,SAAS;;KAGpC,IAAIjU,cAAI,CAACE,cAAc,CAACJ,MAAM,CAAC8W,gBAAgB,CAAC,EAChD;OACC9W,MAAM,CAACoU,cAAc,GAAGpU,MAAM,CAAC8W,gBAAgB;;KAEhD,IAAI5W,cAAI,CAACE,cAAc,CAACJ,MAAM,CAACoU,cAAc,CAAC,EAC9C;OACCnU,MAAM,CAACmU,cAAc,GAAGpU,MAAM,CAACoU,cAAc;;KAG9C,IAAIlU,cAAI,CAACE,cAAc,CAACJ,MAAM,CAACqU,MAAM,CAAC,EACtC;OACCpU,MAAM,CAACoU,MAAM,GAAGrU,MAAM,CAACqU,MAAM;;KAG9B,IAAI,CAACnU,cAAI,CAACiK,WAAW,CAACnK,MAAM,CAACsU,IAAI,CAAC,EAClC;OACCrU,MAAM,CAACqU,IAAI,GAAGtK,qBAAK,CAACvE,IAAI,CAAC4E,IAAI,CAACrK,MAAM,CAACsU,IAAI,EAAE,KAAK,CAAC;;KAElD,IAAI,CAACpU,cAAI,CAACiK,WAAW,CAACnK,MAAM,CAAC+W,kBAAkB,CAAC,EAChD;OACC/W,MAAM,CAACuU,gBAAgB,GAAGvU,MAAM,CAAC+W,kBAAkB;;KAEpD,IAAI,CAAC7W,cAAI,CAACiK,WAAW,CAACnK,MAAM,CAACuU,gBAAgB,CAAC,EAC9C;OACCtU,MAAM,CAACsU,gBAAgB,GAAGvK,qBAAK,CAACvE,IAAI,CAAC4E,IAAI,CAACrK,MAAM,CAACuU,gBAAgB,EAAE,KAAK,CAAC;;KAE1E,IAAI,CAACrU,cAAI,CAACiK,WAAW,CAACnK,MAAM,CAACgX,gBAAgB,CAAC,EAC9C;OACChX,MAAM,CAACwU,cAAc,GAAGxU,MAAM,CAACgX,gBAAgB;;KAEhD,IAAI,CAAC9W,cAAI,CAACiK,WAAW,CAACnK,MAAM,CAACwU,cAAc,CAAC,EAC5C;OACCvU,MAAM,CAACuU,cAAc,GAAGxK,qBAAK,CAACvE,IAAI,CAAC4E,IAAI,CAACrK,MAAM,CAACwU,cAAc,EAAE,KAAK,CAAC;;KAGtE,IAAI,CAACtU,cAAI,CAACiK,WAAW,CAACnK,MAAM,CAAC6U,MAAM,CAAC,EACpC;OACC5U,MAAM,CAAC4U,MAAM,GAAG7K,qBAAK,CAACvE,IAAI,CAAC4E,IAAI,CAACrK,MAAM,CAAC6U,MAAM,EAAE,KAAK,CAAC;;KAGtD,IAAI/L,KAAK,CAACC,OAAO,CAAC/I,MAAM,CAAC+U,WAAW,CAAC,EACrC;OACC9U,MAAM,CAAC8U,WAAW,GAAG,EAAE;OACvB/U,MAAM,CAAC+U,WAAW,CAACjV,OAAO,CAACmX,YAAY,IACvC;SACCA,YAAY,GAAG5W,MAAM,CAACC,QAAQ,CAAC2W,YAAY,EAAE,EAAE,CAAC;SAChD,IAAIA,YAAY,GAAG,CAAC,EACpB;WACChX,MAAM,CAAC8U,WAAW,CAAC1N,IAAI,CAAC4P,YAAY,CAAC;;QAEtC,CAAC;;KAGH,IAAI/W,cAAI,CAAC8I,aAAa,CAAChJ,MAAM,CAACgV,MAAM,CAAC,EACrC;OACC/U,MAAM,CAAC+U,MAAM,GAAG,IAAI,CAACkC,aAAa,CAAClX,MAAM,CAACgV,MAAM,CAAC;;KAGlD,OAAO/U,MAAM;;GAGd4R,aAAa,CAAC7F,MAAc,EAC5B;KACC,IAAI/L,MAAM,GAAG,EAAE;KAEf,IAAI,CAAC+L,MAAM,IAAIA,MAAM,CAACuG,QAAQ,CAAC,yBAAyB,CAAC,EACzD;OACCtS,MAAM,GAAG,EAAE;MACX,MACI,IAAI+L,MAAM,CAACwG,UAAU,CAAC,MAAM,CAAC,EAClC;OACCvS,MAAM,GAAG+L,MAAM;MACf,MAED;OACC/L,MAAM,GAAG4C,2BAAI,CAAC4P,OAAO,EAAE,GAAGzG,MAAM;;KAGjC,IAAI/L,MAAM,EACV;OACCA,MAAM,GAAGyS,SAAS,CAACzS,MAAM,CAAC;;KAG3B,OAAOA,MAAM;;GAGdiX,aAAa,CAAClC,MAAM,EACpB;KACC,MAAM/U,MAAM,GAAG,EAAE;KAEjB,IAAI,CAACC,cAAI,CAACiK,WAAW,CAAC6K,MAAM,CAACmC,UAAU,CAAC,EACxC;OACCnC,MAAM,CAACC,SAAS,GAAGD,MAAM,CAACmC,UAAU;;KAErC,IAAIjX,cAAI,CAACE,cAAc,CAAC4U,MAAM,CAACC,SAAS,CAAC,IAAI/U,cAAI,CAACK,QAAQ,CAACyU,MAAM,CAACC,SAAS,CAAC,EAC5E;OACChV,MAAM,CAACgV,SAAS,GAAED,MAAM,CAACC,SAAS,CAAC5T,QAAQ,EAAE;;KAG9C,IAAI,CAACnB,cAAI,CAACiK,WAAW,CAAC6K,MAAM,CAACoC,eAAe,CAAC,EAC7C;OACCpC,MAAM,CAACE,cAAc,GAAGF,MAAM,CAACoC,eAAe;;KAE/C,IAAIlX,cAAI,CAACE,cAAc,CAAC4U,MAAM,CAACE,cAAc,CAAC,IAAIhV,cAAI,CAACK,QAAQ,CAACyU,MAAM,CAACE,cAAc,CAAC,EACtF;OACCjV,MAAM,CAACiV,cAAc,GAAGF,MAAM,CAACE,cAAc,CAAC7T,QAAQ,EAAE;;KAGzD,IAAI,CAACnB,cAAI,CAACiK,WAAW,CAAC6K,MAAM,CAACqC,cAAc,CAAC,EAC5C;OACCrC,MAAM,CAACG,aAAa,GAAGH,MAAM,CAACqC,cAAc;;KAE7C,IAAInX,cAAI,CAACE,cAAc,CAAC4U,MAAM,CAACG,aAAa,CAAC,IAAIjV,cAAI,CAACK,QAAQ,CAACyU,MAAM,CAACG,aAAa,CAAC,EACpF;OACClV,MAAM,CAACkV,aAAa,GAAGH,MAAM,CAACG,aAAa,CAAC9T,QAAQ,EAAE;;KAGvD,IAAI,CAACnB,cAAI,CAACiK,WAAW,CAAC6K,MAAM,CAACsC,WAAW,CAAC,EACzC;OACCtC,MAAM,CAACI,UAAU,GAAGJ,MAAM,CAACsC,WAAW;;KAEvC,IAAIpX,cAAI,CAACE,cAAc,CAAC4U,MAAM,CAACI,UAAU,CAAC,IAAIlV,cAAI,CAACK,QAAQ,CAACyU,MAAM,CAACI,UAAU,CAAC,EAC9E;OACCnV,MAAM,CAACmV,UAAU,GAAGJ,MAAM,CAACI,UAAU,CAAC/T,QAAQ,EAAE;;KAGjD,OAAOpB,MAAM;;GAGduW,qBAAqB,CAACrX,KAAK,EAAEa,MAAmB,EAChD;KACC,MAAMoO,IAAI,GAAGjP,KAAK,CAACqD,UAAU,CAACxC,MAAM,CAACuF,EAAE,CAAC;KACxC,IAAIyE,qBAAK,CAACoE,IAAI,CAACqG,QAAQ,CAACzU,MAAM,CAACuU,gBAAgB,CAAC,EAChD;OACCnG,IAAI,CAACqG,QAAQ,GAAG,IAAI;OACpB,IAAI,CAAC8C,eAAe,CAACvX,MAAM,CAACuF,EAAE,CAAC;;KAGhC,IAAIyE,qBAAK,CAACoE,IAAI,CAACsG,cAAc,CAAC1U,MAAM,CAACuU,gBAAgB,EAAEvU,MAAM,CAACwU,cAAc,CAAC,EAC7E;OACCpG,IAAI,CAACsG,cAAc,GAAG,IAAI;OAC1B,IAAI,CAAC8C,qBAAqB,CAACxX,MAAM,CAACuF,EAAE,CAAC;;KAGtC,IAAIvF,MAAM,CAAC2U,QAAQ,IAAI3K,qBAAK,CAACoE,IAAI,CAACqJ,eAAe,CAACzX,MAAM,CAAC2U,QAAQ,CAAC,EAClE;OACCvG,IAAI,CAACwG,UAAU,GAAG,IAAI;OACtB5D,UAAU,CAAC,MAAM;SAChB5C,IAAI,CAACwG,UAAU,GAAG,KAAK;QACvB,EAAE5K,qBAAK,CAACvE,IAAI,CAACiS,qBAAqB,EAAE,CAAC;;KAGvC,IAAI1X,MAAM,CAAC6U,MAAM,KAAK,KAAK,EAC3B;OACCzG,IAAI,CAAC0G,QAAQ,GAAG,KAAK;;OAErB3V,KAAK,CAACuU,UAAU,GAAGvU,KAAK,CAACuU,UAAU,CAAC3L,MAAM,CAAEoD,OAAO,IAAK;SACvD,OAAOA,OAAO,KAAKnL,MAAM,CAACuF,EAAE;QAC5B,CAAC;MACF,MACI,IAAIrF,cAAI,CAACyX,MAAM,CAAC3X,MAAM,CAAC6U,MAAM,CAAC,EACnC;OACCzG,IAAI,CAAC0G,QAAQ,GAAG,IAAI;OACpB,IAAI,CAAC8C,eAAe,CAAC5X,MAAM,CAACuF,EAAE,CAAC;;;GAIjCgS,eAAe,CAAChS,EAAE,EAClB;KACC,MAAMpG,KAAK,GAAG,IAAI,CAACI,KAAK,CAACJ,KAAK,CAAC+F,KAAK;KACpC,IAAI,CAAC/F,KAAK,CAACqU,UAAU,CAACzI,QAAQ,CAACxF,EAAE,CAAC,EAClC;OACCpG,KAAK,CAACqU,UAAU,CAACnM,IAAI,CAAC9B,EAAE,CAAC;;;GAI3BiS,qBAAqB,CAACjS,EAAE,EACxB;KACC,MAAMpG,KAAK,GAAG,IAAI,CAACI,KAAK,CAACJ,KAAK,CAAC+F,KAAK;KACpC,IAAI,CAAC/F,KAAK,CAACsU,gBAAgB,CAAC1I,QAAQ,CAACxF,EAAE,CAAC,EACxC;OACCpG,KAAK,CAACsU,gBAAgB,CAACpM,IAAI,CAAC9B,EAAE,CAAC;;;GAIjCqS,eAAe,CAACrS,EAAE,EAClB;KACC,MAAMpG,KAAK,GAAG,IAAI,CAACI,KAAK,CAACJ,KAAK,CAAC+F,KAAK;KACpC,IAAI,CAAC/F,KAAK,CAACuU,UAAU,CAAC3I,QAAQ,CAACxF,EAAE,CAAC,EAClC;OACCpG,KAAK,CAACuU,UAAU,CAACrM,IAAI,CAAC9B,EAAE,CAAC;;;GAI3BmR,wBAAwB,GACxB;KACC,IAAI,IAAI,CAACmB,mBAAmB,EAC5B;OACC,OAAO,IAAI;;KAGZ,MAAMC,gBAAgB,GAAG,IAAI,GAAC,EAAE,GAAC,EAAE,GAAC,EAAE;KACtC,IAAI,CAACD,mBAAmB,GAAG7G,UAAU,CAAC,MAAM;OAC3C+G,WAAW,CAAC,MAAM;SACjB,MAAM5Y,KAAK,GAAG,IAAI,CAACI,KAAK,CAACJ,KAAK,CAAC+F,KAAK;SACpC/F,KAAK,CAACuU,UAAU,CAAC5T,OAAO,CAAC+E,MAAM,IAAI;WAClC,MAAMuJ,IAAI,GAAGjP,KAAK,CAACqD,UAAU,CAACqC,MAAM,CAAC;WACrC,IAAI,CAACuJ,IAAI,EACT;aACC;;WAED,MAAM4J,WAAW,GAAGtS,IAAI,CAACuS,GAAG,EAAE;WAC9B,MAAMC,SAAS,GAAG,IAAIxS,IAAI,CAAC0I,IAAI,CAACyG,MAAM,CAAC,CAACsD,OAAO,EAAE;WAEjD,IAAID,SAAS,IAAIF,WAAW,EAC5B;aACC7Y,KAAK,CAACuU,UAAU,GAAGvU,KAAK,CAACuU,UAAU,CAAC3L,MAAM,CAACoD,OAAO,IAAI;eACrD,OAAOA,OAAO,KAAKtG,MAAM;cACzB,CAAC;aACFuJ,IAAI,CAAC0G,QAAQ,GAAG,KAAK;;UAEtB,CAAC;QACF,EAAEgD,gBAAgB,CAAC;MACpB,EAAE9N,qBAAK,CAACvE,IAAI,CAACiS,qBAAqB,EAAE,CAAC;;GAGvCjB,wBAAwB,GACxB;KACC,IAAI,IAAI,CAAC2B,mBAAmB,EAC5B;OACC,OAAO,IAAI;;KAGZ,MAAMC,UAAU,GAAG,KAAK;KACxB,IAAI,CAACD,mBAAmB,GAAGL,WAAW,CAAC,MAAM;OAC5C,MAAM5Y,KAAK,GAAG,IAAI,CAACI,KAAK,CAACJ,KAAK,CAAC+F,KAAK;OAEpC/F,KAAK,CAACqU,UAAU,CAAC1T,OAAO,CAAC+E,MAAM,IAAI;SAClC,MAAMuJ,IAAI,GAAGjP,KAAK,CAACqD,UAAU,CAACqC,MAAM,CAAC;SACrC,IAAI,CAACuJ,IAAI,EACT;WACC;;SAGD,IAAIpE,qBAAK,CAACoE,IAAI,CAACqG,QAAQ,CAACrG,IAAI,CAACmG,gBAAgB,CAAC,EAC9C;WACCnG,IAAI,CAACqG,QAAQ,GAAG,IAAI;UACpB,MAED;WACCrG,IAAI,CAACqG,QAAQ,GAAG,KAAK;WACrBtV,KAAK,CAACqU,UAAU,GAAGrU,KAAK,CAACqU,UAAU,CAACzL,MAAM,CAACoD,OAAO,IAAIA,OAAO,KAAKtG,MAAM,CAAC;;QAE1E,CAAC;OAEF1F,KAAK,CAACsU,gBAAgB,CAAC3T,OAAO,CAAC+E,MAAM,IAAI;SACxC,MAAMuJ,IAAI,GAAGjP,KAAK,CAACqD,UAAU,CAACqC,MAAM,CAAC;SACrC,IAAI,CAACuJ,IAAI,EACT;WACC;;SAGD,IAAIpE,qBAAK,CAACoE,IAAI,CAACsG,cAAc,CAACtG,IAAI,CAACmG,gBAAgB,EAAEnG,IAAI,CAACoG,cAAc,CAAC,EACzE;WACCpG,IAAI,CAACsG,cAAc,GAAG,IAAI;UAC1B,MAED;WACCtG,IAAI,CAACsG,cAAc,GAAG,KAAK;WAC3BvV,KAAK,CAACsU,gBAAgB,GAAGtU,KAAK,CAACsU,gBAAgB,CAAC1L,MAAM,CAACoD,OAAO,IAAIA,OAAO,KAAKtG,MAAM,CAAC;;QAEtF,CAAC;MACF,EAAEwT,UAAU,CAAC;;CAEhB;;CCprBO,MAAMC,UAAU,SAASla,yBAAY,CAC5C;GACCqC,OAAO,GACP;KACC,OAAO,OAAO;;GAGfpC,QAAQ,GACR;KACC,OAAO;OACNmE,UAAU,EAAE;MACZ;;GAGFuB,eAAe,GACf;KACC,OAAO;OACNwB,EAAE,EAAE,CAAC;OACL7C,MAAM,EAAE,CAAC;OACT7B,IAAI,EAAE,iBAAiB;OACvB4E,IAAI,EAAE,IAAIC,IAAI,EAAE;OAChBmG,IAAI,EAAE,MAAM;OACZ0M,SAAS,EAAE,EAAE;OACbC,IAAI,EAAE,OAAO;OACbC,IAAI,EAAE,CAAC;OACPC,KAAK,EAAE,KAAK;OACZrE,MAAM,EAAEsE,sBAAU,CAACC,IAAI;OACvBC,QAAQ,EAAE,GAAG;OACbrT,QAAQ,EAAE,CAAC;OACXsT,UAAU,EAAE,EAAE;OACdC,UAAU,EAAE,EAAE;OACdC,OAAO,EAAE,EAAE;OACXC,WAAW,EAAE,EAAE;OACfC,WAAW,EAAE;MACb;;GAGFja,UAAU,GACV;KACC,OAAO;OACNC,GAAG,EAAGC,KAAiB,IAAK,CAAC8I,MAAc,EAAEoN,YAAY,GAAG,KAAK,KACjE;SACC,IAAI,CAACpN,MAAM,EACX;WACC,OAAO,IAAI;;SAGZ,IAAI,CAACoN,YAAY,IAAI,CAAClW,KAAK,CAACqD,UAAU,CAACyF,MAAM,CAAC,EAC9C;WACC,OAAO,IAAI;;SAGZ,OAAO9I,KAAK,CAACqD,UAAU,CAACyF,MAAM,CAAC;QAC/B;OACDkR,cAAc,EAAGha,KAAiB,IAAMK,OAAkC,IAC1E;SACC,MAAM;WAACyI;UAAO,GAAGzI,OAAO;SAExB,OAAO,CAAC,CAACL,KAAK,CAACqD,UAAU,CAACyF,MAAM,CAAC;;MAElC;;GAGF5I,UAAU,GACV;KACC,OAAO;OACNkE,GAAG,EAAE,CAAChE,KAAK,EAAEC,OAAe,KAC5B;SACC,MAAM4Z,YAAY,GAAG;WAAC,GAAG,IAAI,CAACrV,eAAe,EAAE;WAAE,GAAG,IAAI,CAACrE,QAAQ,CAACF,OAAO;UAAE;SAE3ED,KAAK,CAACE,MAAM,CAAC,KAAK,EAAE;WAACoG,KAAK,EAAE,CAACuT,YAAY;UAAE,CAAC;QAC5C;OACD9Z,GAAG,EAAE,CAACC,KAAK,EAAEC,OAAiB,KAC9B;SACC,IAAI,CAACsJ,KAAK,CAACC,OAAO,CAACvJ,OAAO,CAAC,IAAIU,cAAI,CAAC8I,aAAa,CAACxJ,OAAO,CAAC,EAC1D;WACCA,OAAO,GAAG,CAACA,OAAO,CAAC;;SAGpBA,OAAO,GAAGA,OAAO,CAACmD,GAAG,CAAC0W,IAAI,IAAI;WAC7B,OAAO;aAAC,GAAG,IAAI,CAACtV,eAAe,EAAE;aAAE,GAAG,IAAI,CAACrE,QAAQ,CAAC2Z,IAAI;YAAE;UAC1D,CAAC;SAEF9Z,KAAK,CAACE,MAAM,CAAC,KAAK,EAAE;WAACoG,KAAK,EAAErG;UAAQ,CAAC;QACrC;OACD4C,MAAM,EAAE,CAAC7C,KAAK,EAAEC,OAAO,KACvB;SACC,MAAM;WAAC+F,EAAE;WAAEvF;UAAO,GAAGR,OAAO;SAC5B,MAAM4P,YAAY,GAAG7P,KAAK,CAACJ,KAAK,CAACqD,UAAU,CAAC+C,EAAE,CAAC;SAC/C,IAAI,CAAC6J,YAAY,EACjB;WACC,OAAO,KAAK;;SAGb7P,KAAK,CAACE,MAAM,CAAC,QAAQ,EAAE;WACtB8F,EAAE,EAAEA,EAAE;WACNvF,MAAM,EAAE,IAAI,CAACN,QAAQ,CAACM,MAAM;UAC5B,CAAC;SAEF,OAAO,IAAI;QACX;OACDkJ,YAAY,EAAE,CAAC3J,KAAK,EAAEC,OAA8C,KACpE;SACC,MAAM;WAAC+F,EAAE;WAAEvF;UAAO,GAAGR,OAAO;SAC5B,IAAI,CAACD,KAAK,CAACJ,KAAK,CAACqD,UAAU,CAAC+C,EAAE,CAAC,EAC/B;WACC;;SAGDhG,KAAK,CAACE,MAAM,CAAC,cAAc,EAAE;WAC5B8F,EAAE;WACFvF,MAAM,EAAE,IAAI,CAACN,QAAQ,CAACM,MAAM;UAC5B,CAAC;QACF;OACDwD,MAAM,EAAE,CAACjE,KAAK,EAAEC,OAA8B,KAC9C;SACC,MAAM;WAAC+F;UAAG,GAAG/F,OAAO;SACpB,IAAI,CAACD,KAAK,CAACJ,KAAK,CAACqD,UAAU,CAAC+C,EAAE,CAAC,EAC/B;WACC;;SAGDhG,KAAK,CAACE,MAAM,CAAC,QAAQ,EAAE;WAAC8F;UAAG,CAAC;;MAE7B;;GAGF5F,YAAY,GACZ;KACC,OAAO;OACN4D,GAAG,EAAE,CAACpE,KAAiB,EAAEK,OAA+B,KACxD;SACCA,OAAO,CAACqG,KAAK,CAAC/F,OAAO,CAACuZ,IAAI,IAAI;WAC7Bla,KAAK,CAACqD,UAAU,CAAC6W,IAAI,CAAC9T,EAAE,CAAC,GAAG8T,IAAI;UAChC,CAAC;QACF;OACDjX,MAAM,EAAE,CAACjD,KAAiB,EAAEK,OAAO,KACnC;SACCI,MAAM,CAACC,OAAO,CAACL,OAAO,CAACQ,MAAM,CAAC,CAACF,OAAO,CAAC,CAAC,CAACV,GAAG,EAAEW,KAAK,CAAC,KAAK;WACxDZ,KAAK,CAACqD,UAAU,CAAChD,OAAO,CAAC+F,EAAE,CAAC,CAACnG,GAAG,CAAC,GAAGW,KAAK;UACzC,CAAC;QACF;OACDmJ,YAAY,EAAE,CAAC/J,KAAiB,EAAEK,OAA8C,KAChF;SACC,MAAM;WAAC+F,EAAE;WAAEvF;UAAO,GAAGR,OAAO;SAC5B,MAAM8Z,WAAW,GAAG;WAAC,GAAGna,KAAK,CAACqD,UAAU,CAAC+C,EAAE;UAAE;SAE7C,OAAOpG,KAAK,CAACqD,UAAU,CAAC+C,EAAE,CAAC;SAC3BpG,KAAK,CAACqD,UAAU,CAACxC,MAAM,CAACuF,EAAE,CAAC,GAAG;WAAC,GAAG+T,WAAW;WAAE,GAAGtZ;UAAO;QACzD;OACDwD,MAAM,EAAE,CAACrE,KAAiB,EAAEK,OAA8B,KAC1D;SACCiE,uBAAM,CAACC,IAAI,CAAC,8BAA8B,EAAElE,OAAO,CAAC;SACpD,MAAM;WAAC+F;UAAG,GAAG/F,OAAO;SACpB,OAAOL,KAAK,CAACqD,UAAU,CAAC+C,EAAE,CAAC;;MAE5B;;GAGF7F,QAAQ,CAAC2Z,IAAY,EACrB;KACC,MAAMpZ,MAAM,GAAG,EAAE;KAEjB,IAAIC,cAAI,CAACK,QAAQ,CAAC8Y,IAAI,CAAC9T,EAAE,CAAC,IAAIrF,cAAI,CAACE,cAAc,CAACiZ,IAAI,CAAC9T,EAAE,CAAC,EAC1D;OACCtF,MAAM,CAACsF,EAAE,GAAG8T,IAAI,CAAC9T,EAAE;;KAGpB,IAAIrF,cAAI,CAACK,QAAQ,CAAC8Y,IAAI,CAAC3W,MAAM,CAAC,IAAIxC,cAAI,CAACoK,QAAQ,CAAC+O,IAAI,CAAC3W,MAAM,CAAC,EAC5D;OACCzC,MAAM,CAACyC,MAAM,GAAGrC,MAAM,CAACC,QAAQ,CAAC+Y,IAAI,CAAC3W,MAAM,EAAE,EAAE,CAAC;;KAGjD,IAAI,CAACxC,cAAI,CAACiK,WAAW,CAACkP,IAAI,CAAC5T,IAAI,CAAC,EAChC;OACCxF,MAAM,CAACwF,IAAI,GAAGuE,qBAAK,CAACvE,IAAI,CAAC4E,IAAI,CAACgP,IAAI,CAAC5T,IAAI,CAAC;;KAGzC,IAAIvF,cAAI,CAACoK,QAAQ,CAAC+O,IAAI,CAACxN,IAAI,CAAC,EAC5B;OACC5L,MAAM,CAAC4L,IAAI,GAAGwN,IAAI,CAACxN,IAAI;;KAGxB,IAAI3L,cAAI,CAACoK,QAAQ,CAAC+O,IAAI,CAACd,SAAS,CAAC,EACjC;OACCtY,MAAM,CAACsY,SAAS,GAAGc,IAAI,CAACd,SAAS,CAAClX,QAAQ,EAAE;OAE5C,IAAIpB,MAAM,CAAC4L,IAAI,KAAK,OAAO,EAC3B;SACC5L,MAAM,CAACuY,IAAI,GAAG,KAAK;QACnB,MACI,IAAIvY,MAAM,CAAC4L,IAAI,KAAK,OAAO,EAChC;SACC5L,MAAM,CAACuY,IAAI,GAAG,KAAK;QACnB,MAED;SACCvY,MAAM,CAACuY,IAAI,GAAGxO,qBAAK,CAACqP,IAAI,CAACE,sBAAsB,CAACtZ,MAAM,CAACsY,SAAS,CAAC;;;KAInE,IAAIrY,cAAI,CAACoK,QAAQ,CAAC+O,IAAI,CAACxY,IAAI,CAAC,IAAIX,cAAI,CAACK,QAAQ,CAAC8Y,IAAI,CAACxY,IAAI,CAAC,EACxD;OACCZ,MAAM,CAACY,IAAI,GAAGwY,IAAI,CAACxY,IAAI,CAACQ,QAAQ,EAAE;;KAGnC,IAAInB,cAAI,CAACK,QAAQ,CAAC8Y,IAAI,CAACZ,IAAI,CAAC,IAAIvY,cAAI,CAACoK,QAAQ,CAAC+O,IAAI,CAACZ,IAAI,CAAC,EACxD;OACCxY,MAAM,CAACwY,IAAI,GAAGpY,MAAM,CAACC,QAAQ,CAAC+Y,IAAI,CAACZ,IAAI,EAAE,EAAE,CAAC;;KAG7C,IAAIvY,cAAI,CAACC,SAAS,CAACkZ,IAAI,CAACX,KAAK,CAAC,EAC9B;OACCzY,MAAM,CAACyY,KAAK,GAAG,KAAK;MACpB,MACI,IAAIxY,cAAI,CAAC8I,aAAa,CAACqQ,IAAI,CAACX,KAAK,CAAC,EACvC;OACCzY,MAAM,CAACyY,KAAK,GAAG;SACdc,KAAK,EAAE,CAAC;SACRC,MAAM,EAAE;QACR;OAED,IAAIvZ,cAAI,CAACoK,QAAQ,CAAC+O,IAAI,CAACX,KAAK,CAACc,KAAK,CAAC,IAAItZ,cAAI,CAACK,QAAQ,CAAC8Y,IAAI,CAACX,KAAK,CAACc,KAAK,CAAC,EACtE;SACCvZ,MAAM,CAACyY,KAAK,CAACc,KAAK,GAAGnZ,MAAM,CAACC,QAAQ,CAAC+Y,IAAI,CAACX,KAAK,CAACc,KAAK,EAAE,EAAE,CAAC;;OAE3D,IAAItZ,cAAI,CAACoK,QAAQ,CAAC+O,IAAI,CAACX,KAAK,CAACe,MAAM,CAAC,IAAIvZ,cAAI,CAACK,QAAQ,CAAC8Y,IAAI,CAACX,KAAK,CAACe,MAAM,CAAC,EACxE;SACCxZ,MAAM,CAACyY,KAAK,CAACe,MAAM,GAAGpZ,MAAM,CAACC,QAAQ,CAAC+Y,IAAI,CAACX,KAAK,CAACe,MAAM,EAAE,EAAE,CAAC;;OAG7D,IAAIxZ,MAAM,CAACyY,KAAK,CAACc,KAAK,IAAI,CAAC,IAAIvZ,MAAM,CAACyY,KAAK,CAACe,MAAM,IAAI,CAAC,EACvD;SACCxZ,MAAM,CAACyY,KAAK,GAAG,KAAK;;;KAItB,IAAIxY,cAAI,CAACoK,QAAQ,CAAC+O,IAAI,CAAChF,MAAM,CAAC,IAAI,CAACnU,cAAI,CAACiK,WAAW,CAACwO,sBAAU,CAACU,IAAI,CAAChF,MAAM,CAAC,CAAC,EAC5E;OACCpU,MAAM,CAACoU,MAAM,GAAGgF,IAAI,CAAChF,MAAM;;KAG5B,IAAInU,cAAI,CAACK,QAAQ,CAAC8Y,IAAI,CAACR,QAAQ,CAAC,IAAI3Y,cAAI,CAACoK,QAAQ,CAAC+O,IAAI,CAACR,QAAQ,CAAC,EAChE;OACC5Y,MAAM,CAAC4Y,QAAQ,GAAGxY,MAAM,CAACC,QAAQ,CAAC+Y,IAAI,CAACR,QAAQ,EAAE,EAAE,CAAC;;KAGrD,IAAI3Y,cAAI,CAACK,QAAQ,CAAC8Y,IAAI,CAAC7T,QAAQ,CAAC,IAAItF,cAAI,CAACoK,QAAQ,CAAC+O,IAAI,CAAC7T,QAAQ,CAAC,EAChE;OACCvF,MAAM,CAACuF,QAAQ,GAAGnF,MAAM,CAACC,QAAQ,CAAC+Y,IAAI,CAAC7T,QAAQ,EAAE,EAAE,CAAC;;KAGrD,IAAItF,cAAI,CAACoK,QAAQ,CAAC+O,IAAI,CAACP,UAAU,CAAC,IAAI5Y,cAAI,CAACK,QAAQ,CAAC8Y,IAAI,CAACP,UAAU,CAAC,EACpE;OACC7Y,MAAM,CAAC6Y,UAAU,GAAGO,IAAI,CAACP,UAAU,CAACzX,QAAQ,EAAE;;KAG/C,IAAInB,cAAI,CAACoK,QAAQ,CAAC+O,IAAI,CAACN,UAAU,CAAC,EAClC;OACC,IACC,CAACM,IAAI,CAACN,UAAU,IACbM,IAAI,CAACN,UAAU,CAACvG,UAAU,CAAC,MAAM,CAAC,IAClC6G,IAAI,CAACN,UAAU,CAACvG,UAAU,CAAC,IAAI,CAAC,IAChC6G,IAAI,CAACN,UAAU,CAACvG,UAAU,CAAC,MAAM,CAAC,IAClC6G,IAAI,CAACN,UAAU,CAACvG,UAAU,CAAC,MAAM,CAAC,EAEtC;SACCvS,MAAM,CAAC8Y,UAAU,GAAGM,IAAI,CAACN,UAAU;QACnC,MAED;SACC9Y,MAAM,CAAC8Y,UAAU,GAAGlW,2BAAI,CAAC4P,OAAO,EAAE,GAAG4G,IAAI,CAACN,UAAU;;;KAItD,IAAI7Y,cAAI,CAACoK,QAAQ,CAAC+O,IAAI,CAACJ,WAAW,CAAC,EACnC;OACC,IACC,CAACI,IAAI,CAACJ,WAAW,IACdI,IAAI,CAACJ,WAAW,CAACzG,UAAU,CAAC,MAAM,CAAC,IACnC6G,IAAI,CAACJ,WAAW,CAACzG,UAAU,CAAC,IAAI,CAAC,IACjC6G,IAAI,CAACN,UAAU,CAACvG,UAAU,CAAC,MAAM,CAAC,EAEtC;SACCvS,MAAM,CAACgZ,WAAW,GAAGI,IAAI,CAACJ,WAAW;QACrC,MAED;SACChZ,MAAM,CAACgZ,WAAW,GAAGpW,2BAAI,CAAC4P,OAAO,EAAE,GAAG4G,IAAI,CAACJ,WAAW;;;KAIxD,IAAI/Y,cAAI,CAACoK,QAAQ,CAAC+O,IAAI,CAACL,OAAO,CAAC,EAC/B;OACC,IACC,CAACK,IAAI,CAACL,OAAO,IACVK,IAAI,CAACL,OAAO,CAACxG,UAAU,CAAC,MAAM,CAAC,IAC/B6G,IAAI,CAACL,OAAO,CAACxG,UAAU,CAAC,IAAI,CAAC,IAC7B6G,IAAI,CAACL,OAAO,CAACxG,UAAU,CAAC,MAAM,CAAC,EAEnC;SACCvS,MAAM,CAAC+Y,OAAO,GAAGK,IAAI,CAACL,OAAO;QAC7B,MAED;SACC/Y,MAAM,CAAC+Y,OAAO,GAAGnW,2BAAI,CAAC4P,OAAO,EAAE,GAAG4G,IAAI,CAACL,OAAO;;;KAIhD,IAAI9Y,cAAI,CAAC8I,aAAa,CAACqQ,IAAI,CAACH,WAAW,CAAC,EACxC;OACCjZ,MAAM,CAACiZ,WAAW,GAAG,IAAI,CAACQ,wBAAwB,CAACL,IAAI,CAACH,WAAW,CAAC;;KAGrE,OAAOjZ,MAAM;;GAGdyZ,wBAAwB,CAACR,WAAW,EACpC;KACC,MAAMjZ,MAAM,GAAG;OACd0Z,MAAM,EAAE;MACR;KAED,IAAIzZ,cAAI,CAACoK,QAAQ,CAAC4O,WAAW,CAACU,OAAO,CAAC,EACtC;OACC3Z,MAAM,CAAC2Z,OAAO,GAAGV,WAAW,CAACU,OAAO;;KAGrC,IAAI1Z,cAAI,CAACoK,QAAQ,CAAC4O,WAAW,CAACW,QAAQ,CAAC,EACvC;OACC5Z,MAAM,CAAC4Z,QAAQ,GAAGX,WAAW,CAACW,QAAQ;;KAGvC,IAAI3Z,cAAI,CAACoK,QAAQ,CAAC4O,WAAW,CAACY,GAAG,CAAC,EAClC;OACC7Z,MAAM,CAAC6Z,GAAG,GAAGZ,WAAW,CAACY,GAAG;;KAG7B,IAAI5Z,cAAI,CAACoK,QAAQ,CAAC4O,WAAW,CAACzH,KAAK,CAAC,EACpC;OACCxR,MAAM,CAACwR,KAAK,GAAGyH,WAAW,CAACzH,KAAK;;KAGjC,IAAIvR,cAAI,CAACoK,QAAQ,CAAC4O,WAAW,CAACa,aAAa,CAAC,EAC5C;OACC9Z,MAAM,CAAC8Z,aAAa,GAAGb,WAAW,CAACa,aAAa;;KAGjD,IAAI7Z,cAAI,CAACoK,QAAQ,CAAC4O,WAAW,CAACc,UAAU,CAAC,EACzC;OACC/Z,MAAM,CAAC+Z,UAAU,GAAGd,WAAW,CAACc,UAAU;;KAG3C,IAAI9Z,cAAI,CAACoK,QAAQ,CAAC4O,WAAW,CAACe,eAAe,CAAC,EAC9C;OACCha,MAAM,CAACga,eAAe,GAAGf,WAAW,CAACe,eAAe;;KAGrD,IAAI/Z,cAAI,CAACC,SAAS,CAAC+Y,WAAW,CAACgB,kBAAkB,CAAC,EAClD;OACCja,MAAM,CAACia,kBAAkB,GAAGhB,WAAW,CAACgB,kBAAkB;;KAG3D,IAAIha,cAAI,CAACoK,QAAQ,CAAC4O,WAAW,CAACiB,eAAe,CAAC,EAC9C;OACCla,MAAM,CAACka,eAAe,GAAGjB,WAAW,CAACiB,eAAe;;KAGrD,IAAIja,cAAI,CAACK,QAAQ,CAAC2Y,WAAW,CAACkB,QAAQ,CAAC,EACvC;OACCna,MAAM,CAACma,QAAQ,GAAGlB,WAAW,CAACkB,QAAQ;;KAGvC,OAAOna,MAAM;;CAEf;;CC1XO,MAAMoa,UAAU,SAASjc,yBAAY,CAC5C;GACCC,QAAQ,GACR;KACC,OAAO;OACNmE,UAAU,EAAE;MACZ;;GAGFuB,eAAe,GACf;KACC,OAAO;OACN3C,QAAQ,EAAE,CAAC;OACXP,IAAI,EAAE,EAAE;OACR0N,IAAI,EAAE,EAAE;OACRpP,KAAK,EAAEmb,4BAAgB,CAACC;MACxB;;GAGFtb,UAAU,GACV;KACC,OAAO;OACNC,GAAG,EAAGC,KAAiB,IACvB;SACC,OAAOS,MAAM,CAACkL,MAAM,CAAC3L,KAAK,CAACqD,UAAU,CAAC;;MAEvC;;GAGFnD,UAAU,GACV;KACC,OAAO;OACNmb,aAAa,EAAE,CAACjb,KAAK,EAAEC,OAAwB,KAC/C;SACC,MAAMib,YAAY,GAAG7a,MAAM,CAACkL,MAAM,CAACvL,KAAK,CAACJ,KAAK,CAACqD,UAAU,CAAC,CAACsL,IAAI,CAAErJ,IAAqB,IAAK;WAC1F,OAAOA,IAAI,CAACrD,QAAQ,KAAK5B,OAAO,CAAC4B,QAAQ,IAAIqD,IAAI,CAAC8J,IAAI,CAAChJ,EAAE,KAAK/F,OAAO,CAAC+O,IAAI,CAAChJ,EAAE;UAC7E,CAAC;SAEF,IAAIkV,YAAY,EAChB;WACClb,KAAK,CAACE,MAAM,CAAC,kBAAkB,EAAE;aAChC2B,QAAQ,EAAEqZ,YAAY,CAACrZ,QAAQ;aAC/BpB,MAAM,EAAE,IAAI,CAAC0a,kBAAkB,CAAClb,OAAO;YACvC,CAAC;WAEF,OAAO,IAAI;;SAGZD,KAAK,CAACE,MAAM,CAAC,eAAe,EAAE,IAAI,CAACkb,iBAAiB,CAACnb,OAAO,CAAC,CAAC;QAC9D;OACDob,gBAAgB,EAAE,CAACrb,KAAK,EAAEC,OAAO,KACjC;SACC,MAAMib,YAAY,GAAGlb,KAAK,CAACJ,KAAK,CAACqD,UAAU,CAAChD,OAAO,CAAC4B,QAAQ,CAAC;SAC7D,IAAI,CAACqZ,YAAY,EACjB;WACC;;SAGDlb,KAAK,CAACE,MAAM,CAAC,kBAAkB,EAAE;WAChC2B,QAAQ,EAAEqZ,YAAY,CAACrZ,QAAQ;WAC/BpB,MAAM,EAAE,IAAI,CAAC0a,kBAAkB,CAAClb,OAAO,CAACQ,MAAM;UAC9C,CAAC;QACF;OACD6a,gBAAgB,EAAE,CAACtb,KAAK,EAAEC,OAAO,KACjC;SACC,MAAMib,YAAY,GAAGlb,KAAK,CAACJ,KAAK,CAACqD,UAAU,CAAChD,OAAO,CAAC4B,QAAQ,CAAC;SAC7D,IAAI,CAACqZ,YAAY,EACjB;WACC;;SAGDlb,KAAK,CAACE,MAAM,CAAC,kBAAkB,EAAE;WAChC2B,QAAQ,EAAEqZ,YAAY,CAACrZ;UACvB,CAAC;;MAEH;;GAGFzB,YAAY,GACZ;KACC,OAAO;OACN6a,aAAa,EAAE,CAACrb,KAAiB,EAAEK,OAAwB,KAAK;SAC/DL,KAAK,CAACqD,UAAU,CAAChD,OAAO,CAAC4B,QAAQ,CAAC,GAAG5B,OAAO;QAC5C;OACDob,gBAAgB,EAAE,CAACzb,KAAiB,EAAEK,OAAO,KAAK;SACjDL,KAAK,CAACqD,UAAU,CAAChD,OAAO,CAAC4B,QAAQ,CAAC,GAAG;WACpC,GAAGjC,KAAK,CAACqD,UAAU,CAAChD,OAAO,CAAC4B,QAAQ,CAAC;WACrC,GAAG5B,OAAO,CAACQ;UACX;QACD;OACD6a,gBAAgB,EAAE,CAAC1b,KAAiB,EAAEK,OAAO,KAAK;SACjD,OAAOL,KAAK,CAACqD,UAAU,CAAChD,OAAO,CAAC4B,QAAQ,CAAC;;MAE1C;;GAGFuZ,iBAAiB,CAACpM,IAAI,EACtB;KACC,OAAO;OAAC,GAAG,IAAI,CAACxK,eAAe,EAAE;OAAE,GAAG,IAAI,CAAC2W,kBAAkB,CAACnM,IAAI;MAAE;;GAGrEmM,kBAAkB,CAAC1a,MAAM,EACzB;KACC,MAAMC,MAAM,GAAG,EAAE;KAEjB,IAAIC,cAAI,CAACE,cAAc,CAACJ,MAAM,CAACoB,QAAQ,CAAC,IAAIlB,cAAI,CAACK,QAAQ,CAACP,MAAM,CAACoB,QAAQ,CAAC,EAC1E;OACCnB,MAAM,CAACmB,QAAQ,GAAGpB,MAAM,CAACoB,QAAQ;;KAGlC,IAAIlB,cAAI,CAACE,cAAc,CAACJ,MAAM,CAACa,IAAI,CAAC,EACpC;OACCZ,MAAM,CAACY,IAAI,GAAGb,MAAM,CAACa,IAAI;;KAG1B,IAAIX,cAAI,CAAC4a,YAAY,CAAC9a,MAAM,CAACuO,IAAI,CAAC,EAClC;OAAA;OACCtO,MAAM,CAACsO,IAAI,GAAGvO,MAAM,CAACuO,IAAI;OAEzB,IAAI,iBAAAvO,MAAM,CAACuO,IAAI,8CAAX,aAAawM,gBAAgB,qBAA7B,sBAA+B/O,MAAM,MAAK,gCAAgC,EAC9E;SACC/L,MAAM,CAACsO,IAAI,CAACwM,gBAAgB,CAAC/O,MAAM,GAAG,EAAE;;;KAI1C,IAAIsO,4BAAgB,CAACta,MAAM,CAACb,KAAK,CAAC,EAClC;OACCc,MAAM,CAACd,KAAK,GAAGa,MAAM,CAACb,KAAK;;KAG5B,OAAOc,MAAM;;CAEf;;CC7HO,MAAM+a,WAAW,SAAS5c,yBAAY,CAC7C;GACCqC,OAAO,GACP;KACC,OAAO,QAAQ;;GAGhBC,gBAAgB,GAChB;KACC,OAAO;OAACua,KAAK,EAAEZ;MAAW;;GAG3Bhc,QAAQ,GACR;KACC,OAAO;OACNmE,UAAU,EAAE,EAAE;OACd0Y,gBAAgB,EAAE,IAAIvX,GAAG,EAAE;OAC3BwX,gBAAgB,EAAE,IAAIxX,GAAG,EAAE;OAC3ByX,oBAAoB,EAAE;MACtB;;GAGFrX,eAAe,GACf;KACC,OAAO;OACN3C,QAAQ,EAAE,GAAG;OACboG,OAAO,EAAE;SACRjC,EAAE,EAAE,CAAC;SACLiF,QAAQ,EAAE,CAAC;SACX/E,IAAI,EAAE,IAAIC,IAAI,EAAE;SAChB2O,MAAM,EAAEgH,yBAAa,CAACC,QAAQ;SAC9BpV,OAAO,EAAE,KAAK;SACdP,IAAI,EAAE,EAAE;SACR+E,MAAM,EAAE;WACP6Q,QAAQ,EAAE,KAAK;WACfC,UAAU,EAAE;;QAEb;OACDC,KAAK,EAAE;SACN9V,IAAI,EAAE,EAAE;SACRF,IAAI,EAAE;QACN;OACDM,MAAM,EAAE,KAAK;OACb2V,MAAM,EAAE,KAAK;OACbC,KAAK,EAAE,KAAK;OACZC,UAAU,EAAE;SACXC,QAAQ,EAAE,KAAK;SACfC,UAAU,EAAE,CAAC;SACbC,SAAS,EAAE;QACX;OACD9I,OAAO,EAAE;MACT;;GAGFhU,UAAU,GACV;KACC,OAAO;OACN+c,mBAAmB,EAAG7c,KAAkB,IACxC;SACC,OAAO,CAAC,GAAGA,KAAK,CAAC+b,gBAAgB,CAAC,CAACvY,GAAG,CAAC4C,EAAE,IAAI;WAC5C,OAAOpG,KAAK,CAACqD,UAAU,CAAC+C,EAAE,CAAC;UAC3B,CAAC;QACF;OACD0W,mBAAmB,EAAG9c,KAAkB,IACxC;SACC,OAAO,CAAC,GAAGA,KAAK,CAACgc,gBAAgB,CAAC,CAACxY,GAAG,CAAC4C,EAAE,IAAI;WAC5C,OAAOpG,KAAK,CAACqD,UAAU,CAAC+C,EAAE,CAAC;UAC3B,CAAC;QACF;OACD2W,mBAAmB,EAAG/c,KAAkB,IACxC;SACC,MAAMgd,iBAAiB,GAAGvc,MAAM,CAACkL,MAAM,CAAC3L,KAAK,CAACqD,UAAU,CAAC,CAACuF,MAAM,CAACtD,IAAI,IAAI;WACxE,MAAM2X,qBAAqB,GAAG3X,IAAI,CAACwO,OAAO,CAACoJ,mBAAmB;WAC9D,MAAMC,aAAa,GAAG7X,IAAI,CAACwO,OAAO,CAACsJ,iBAAiB;WAEpD,OAAO,CAACH,qBAAqB,IAAI,CAACE,aAAa,IAAI7X,IAAI,CAAC+C,OAAO,CAACjC,EAAE;UAClE,CAAC;SAEF,OAAO,CAAC,GAAG4W,iBAAiB,CAAC,CAACpV,IAAI,CAAC,CAACC,CAAC,EAAEC,CAAC,KAAK;WAC5C,OAAOA,CAAC,CAACO,OAAO,CAAC/B,IAAI,GAAGuB,CAAC,CAACQ,OAAO,CAAC/B,IAAI;UACtC,CAAC;QACF;OACDvG,GAAG,EAAGC,KAAkB,IAAMiC,QAAgB,IAC9C;SACC,IAAIlB,cAAI,CAACK,QAAQ,CAACa,QAAQ,CAAC,EAC3B;WACCA,QAAQ,GAAGA,QAAQ,CAACC,QAAQ,EAAE;;SAG/B,IAAIlC,KAAK,CAACqD,UAAU,CAACpB,QAAQ,CAAC,EAC9B;WACC,OAAOjC,KAAK,CAACqD,UAAU,CAACpB,QAAQ,CAAC;;SAGlC,OAAO,IAAI;QACX;OAEDob,wBAAwB,EAAGrd,KAAkB,IAAMiC,QAAQ,IAC3D;SACC,MAAMuD,WAAW,GAAGxF,KAAK,CAACqD,UAAU,CAACpB,QAAQ,CAAC;SAC9C,IAAI,CAACuD,WAAW,EAChB;WACC,OAAO,KAAK;;SAGb,MAAMjG,MAAM,GAAG,IAAI,CAACa,KAAK,CAACwD,OAAO,CAAC,eAAe,CAAC,CAAC3B,QAAQ,CAAC;SAC5D,IAAI,CAAC1C,MAAM,IAAIA,MAAM,CAACmN,IAAI,KAAKC,sBAAU,CAACsC,IAAI,EAC9C;WACC,OAAO,KAAK;;SAEb,MAAMoH,WAAW,GAAG,IAAI,CAACjW,KAAK,CAACwD,OAAO,CAAC,mBAAmB,CAAC,CAAC3B,QAAQ,CAAC;SACrE,IAAI,CAACoU,WAAW,EAChB;WACC,OAAO,KAAK;;SAGb,MAAMlO,UAAU,GAAG0C,qBAAK,CAACrE,IAAI,CAACyF,aAAa,CAACzG,WAAW,CAAC6C,OAAO,CAACjC,EAAE,CAAC,IAAIZ,WAAW,CAAC6C,OAAO,CAACjC,EAAE,GAAG,CAAC;SACjG,MAAMkX,eAAe,GAAGnV,UAAU,IAAI0C,qBAAK,CAACvE,IAAI,CAACiX,OAAO,CAAC/X,WAAW,CAAC6C,OAAO,CAAC/B,IAAI,CAAC;SAElF,MAAM3G,YAAY,GAAG,IAAI,CAACS,KAAK,CAACwD,OAAO,CAAC,0BAA0B,CAAC,CAACzE,oBAAQ,CAACO,MAAM,CAACC,YAAY,CAAC;SACjG,OAAOA,YAAY,IAAI,CAAC2d,eAAe,IAAI/d,MAAM,CAACyG,OAAO,KAAK,CAAC;QAC/D;OAEDwX,wBAAwB,EAAGxd,KAAkB,IAAMiC,QAAQ,IAC3D;SACC,MAAMuD,WAAW,GAAGxF,KAAK,CAACqD,UAAU,CAACpB,QAAQ,CAAC;SAC9C,IAAI,CAACuD,WAAW,EAChB;WACC,OAAO,KAAK;;SAGb,MAAMjG,MAAM,GAAG,IAAI,CAACa,KAAK,CAACwD,OAAO,CAAC,eAAe,CAAC,CAAC3B,QAAQ,CAAC;SAC5D,IAAI,CAAC1C,MAAM,IAAIA,MAAM,CAACmN,IAAI,KAAKC,sBAAU,CAACsC,IAAI,EAC9C;WACC,OAAO,KAAK;;SAEb,MAAMqH,WAAW,GAAG,IAAI,CAAClW,KAAK,CAACwD,OAAO,CAAC,mBAAmB,CAAC,CAAC3B,QAAQ,CAAC;SACrE,IAAI,CAACqU,WAAW,EAChB;WACC,OAAO,KAAK;;SAGb,MAAMnO,UAAU,GAAG0C,qBAAK,CAACrE,IAAI,CAACyF,aAAa,CAACzG,WAAW,CAAC6C,OAAO,CAACjC,EAAE,CAAC,IAAIZ,WAAW,CAAC6C,OAAO,CAACjC,EAAE,GAAG,CAAC;SACjG,MAAMkX,eAAe,GAAGnV,UAAU,IAAI0C,qBAAK,CAACvE,IAAI,CAACiX,OAAO,CAAC/X,WAAW,CAAC6C,OAAO,CAAC/B,IAAI,CAAC;SAElF,OAAO,CAACgX,eAAe,IAAI/d,MAAM,CAACyG,OAAO,KAAK,CAAC;QAC/C;OAEDyX,cAAc,EAAGzd,KAAkB,IAAMiC,QAAQ,IACjD;SACC,MAAMuD,WAAW,GAAGxF,KAAK,CAACqD,UAAU,CAACpB,QAAQ,CAAC;SAC9C,IAAI,CAACuD,WAAW,EAChB;WACC,OAAO,IAAI;;SAGZ,IAAIzE,cAAI,CAACyX,MAAM,CAAChT,WAAW,CAAC8W,KAAK,CAAChW,IAAI,CAAC,IAAId,WAAW,CAAC8W,KAAK,CAAChW,IAAI,GAAGd,WAAW,CAAC6C,OAAO,CAAC/B,IAAI,EAC5F;WACC,OAAOd,WAAW,CAAC8W,KAAK,CAAChW,IAAI;;SAG9B,MAAM+W,wBAAwB,GAAG,IAAI,CAACjd,KAAK,CAACwD,OAAO,CAAC,iCAAiC,CAAC,CAAC4B,WAAW,CAACvD,QAAQ,CAAC;SAC5G,IAAIob,wBAAwB,EAC5B;WACC,OAAOxS,qBAAK,CAACvE,IAAI,CAACoX,gBAAgB,EAAE;;SAGrC,OAAOlY,WAAW,CAAC6C,OAAO,CAAC/B,IAAI;QAC/B;OAEDqX,eAAe,EAAG3d,KAAkB,IACpC;SACC,IAAI4d,kBAAkB,GAAG,CAAC;SAC1B,CAAC,GAAG5d,KAAK,CAAC+b,gBAAgB,CAAC,CAACpb,OAAO,CAACsB,QAAQ,IAAI;WAC/C,MAAM1C,MAAqB,GAAG,IAAI,CAACa,KAAK,CAACwD,OAAO,CAAC,eAAe,CAAC,CAAC3B,QAAQ,EAAE,IAAI,CAAC;WACjF,MAAM4b,UAA6B,GAAG7d,KAAK,CAACqD,UAAU,CAACpB,QAAQ,CAAC;WAEhE,MAAM6b,OAAO,GAAGve,MAAM,CAACoO,QAAQ,CAAC/B,QAAQ,CAAClI,2BAAI,CAACkC,SAAS,EAAE,CAAC;WAC1D,IAAIkY,OAAO,EACX;aACC;;WAED,MAAMC,QAAQ,GAAGF,UAAU,CAACjX,MAAM;WAClC,IAAIrH,MAAM,CAACyG,OAAO,KAAK,CAAC,IAAI+X,QAAQ,EACpC;aACCH,kBAAkB,EAAE;aACpB;;WAEDA,kBAAkB,IAAIre,MAAM,CAACyG,OAAO;UACpC,CAAC;SAEF,IAAIgY,oBAAoB,GAAG,CAAC;SAC5Bvd,MAAM,CAACkL,MAAM,CAAC3L,KAAK,CAACic,oBAAoB,CAAC,CAACtb,OAAO,CAACqF,OAAO,IAAI;WAC5DgY,oBAAoB,IAAIhY,OAAO;UAC/B,CAAC;SAEF,OAAO4X,kBAAkB,GAAGI,oBAAoB;;MAEjD;;GAGF9d,UAAU,GACV;KACC,OAAO;OACN+d,SAAS,EAAE,CAAC7d,KAAK,EAAEC,OAAuB,KAC1C;SACC,IAAI,CAACD,KAAK,CAAC0R,QAAQ,CAAC,YAAY,EAAEzR,OAAO,CAAC,CAAC6d,IAAI,CAACC,OAAO,IAAI;WAC1D/d,KAAK,CAACE,MAAM,CAAC,qBAAqB,EAAE6d,OAAO,CAAC;UAC5C,CAAC;SAEF,IAAI,CAACxU,KAAK,CAACC,OAAO,CAACvJ,OAAO,CAAC,IAAIU,cAAI,CAAC8I,aAAa,CAACxJ,OAAO,CAAC,EAC1D;WACCA,OAAO,GAAG,CAACA,OAAO,CAAC;;SAEpB,MAAM+d,yBAAyB,GAAG,EAAE;SACpC/d,OAAO,CAACM,OAAO,CAAC2E,IAAI,IAAI;WACvB8Y,yBAAyB,CAAC9Y,IAAI,CAAC2F,OAAO,CAAC,GAAG,CAAC;UAC3C,CAAC;SACF,IAAI,CAAC7K,KAAK,CAAC0R,QAAQ,CAAC,gCAAgC,EAAEsM,yBAAyB,CAAC;QAChF;OACDC,SAAS,EAAE,CAACje,KAAK,EAAEC,OAAuB,KAC1C;SACC,IAAI,CAACD,KAAK,CAAC0R,QAAQ,CAAC,YAAY,EAAEzR,OAAO,CAAC,CAAC6d,IAAI,CAACC,OAAO,IAAI;WAC1D/d,KAAK,CAACE,MAAM,CAAC,qBAAqB,EAAE6d,OAAO,CAAC;UAC5C,CAAC;QACF;OACDhe,GAAG,EAAE,CAACC,KAAK,EAAEC,OAAuB,KACpC;SACC,IAAI,CAACsJ,KAAK,CAACC,OAAO,CAACvJ,OAAO,CAAC,IAAIU,cAAI,CAAC8I,aAAa,CAACxJ,OAAO,CAAC,EAC1D;WACCA,OAAO,GAAG,CAACA,OAAO,CAAC;;SAGpB,MAAMie,aAAa,GAAG,EAAE;SACxB,MAAMC,UAAU,GAAG,EAAE;SACrBle,OAAO,CAACmD,GAAG,CAAEwI,OAAO,IAAK;WACxB,OAAO,IAAI,CAACzL,QAAQ,CAACyL,OAAO,CAAC;UAC7B,CAAC,CAACrL,OAAO,CAAEqL,OAAO,IAAK;WACvB,MAAMwS,eAAe,GAAG;aAAE,GAAGxS;YAAS;WACtC,MAAMiE,YAAY,GAAG7P,KAAK,CAACJ,KAAK,CAACqD,UAAU,CAAC2I,OAAO,CAAC/J,QAAQ,CAAC;WAC7D,IAAIgO,YAAY,EAChB;aACCqO,aAAa,CAACpW,IAAI,CAAC;eAAEjG,QAAQ,EAAEgO,YAAY,CAAChO,QAAQ;eAAEpB,MAAM,EAAE2d;cAAiB,CAAC;YAChF,MAED;aACC,MAAM;eAAEnW,OAAO,EAAEoW;cAAgB,GAAG,IAAI,CAAC7Z,eAAe,EAAE;aAC1D4Z,eAAe,CAACnW,OAAO,GAAG;eAAE,GAAGoW,cAAc;eAAE,GAAGD,eAAe,CAACnW;cAAS;aAC3EkW,UAAU,CAACrW,IAAI,CAAC;eAAE,GAAG,IAAI,CAACtD,eAAe,EAAE;eAAE,GAAG4Z;cAAiB,CAAC;;UAEnE,CAAC;SAEF,IAAID,UAAU,CAACra,MAAM,GAAG,CAAC,EACzB;WACC9D,KAAK,CAACE,MAAM,CAAC,KAAK,EAAEie,UAAU,CAAC;;SAGhC,IAAID,aAAa,CAACpa,MAAM,GAAG,CAAC,EAC5B;WACC9D,KAAK,CAACE,MAAM,CAAC,QAAQ,EAAEge,aAAa,CAAC;;SAGtC,OAAO,CAAC,GAAGC,UAAU,EAAE,GAAGD,aAAa,CAAC,CAAC9a,GAAG,CAAC8B,IAAI,IAAIA,IAAI,CAACrD,QAAQ,CAAC;QACnE;OAEDgB,MAAM,EAAE,CAAC7C,KAAK,EAAEC,OAA8C,KAC9D;SACC,MAAM;WAAC+F,EAAE;WAAEvF;UAAO,GAAGR,OAAO;SAC5B,MAAM4P,YAA+B,GAAG7P,KAAK,CAACJ,KAAK,CAACqD,UAAU,CAAC+C,EAAE,CAAC;SAClE,IAAI,CAAC6J,YAAY,EACjB;WACC,OAAO,KAAK;;SAGb7P,KAAK,CAACE,MAAM,CAAC,QAAQ,EAAE;WACtB2B,QAAQ,EAAEgO,YAAY,CAAChO,QAAQ;WAC/BpB,MAAM,EAAE,IAAI,CAACN,QAAQ,CAACM,MAAM;UAC5B,CAAC;QACF;OAED+F,MAAM,EAAE,CAACxG,KAAK,EAAEC,OAA+C,KAC/D;SACC,MAAM4P,YAAY,GAAG7P,KAAK,CAACJ,KAAK,CAACqD,UAAU,CAAChD,OAAO,CAAC+F,EAAE,CAAC;SACvD,IAAI,CAAC6J,YAAY,EACjB;WACC,OAAO,KAAK;;SAGb7P,KAAK,CAACE,MAAM,CAAC,QAAQ,EAAE;WACtB2B,QAAQ,EAAEgO,YAAY,CAAChO,QAAQ;WAC/BpB,MAAM,EAAE;aAAC+F,MAAM,EAAEvG,OAAO,CAACqe;;UACzB,CAAC;QACF;OAEDxY,GAAG,EAAE,CAAC9F,KAAK,EAAEC,OAA+C,KAC5D;SACC,MAAM4P,YAAY,GAAG7P,KAAK,CAACJ,KAAK,CAACqD,UAAU,CAAChD,OAAO,CAAC+F,EAAE,CAAC;SACvD,IAAI,CAAC6J,YAAY,EACjB;WACC,OAAO,KAAK;;SAGb7P,KAAK,CAACE,MAAM,CAAC,QAAQ,EAAE;WACtB2B,QAAQ,EAAEgO,YAAY,CAAChO,QAAQ;WAC/BpB,MAAM,EAAE;aAAC0b,MAAM,EAAElc,OAAO,CAACqe;;UACzB,CAAC;QACF;OAEDC,IAAI,EAAE,CAACve,KAAK,EAAEC,OAAiE,KAC/E;SACC,MAAM4P,YAAY,GAAG7P,KAAK,CAACJ,KAAK,CAACqD,UAAU,CAAChD,OAAO,CAAC+F,EAAE,CAAC;SACvD,IAAI,CAAC6J,YAAY,EACjB;WACC,OAAO,KAAK;;SAGb,MAAM2O,aAAa,GAAG3O,YAAY,CAAC5H,OAAO,CAACjC,EAAE,KAAKlF,MAAM,CAACC,QAAQ,CAACd,OAAO,CAACyD,SAAS,EAAE,EAAE,CAAC;SACxF,MAAM+a,mBAAmB,GAAG,CAAC9d,cAAI,CAACiK,WAAW,CAAC3K,OAAO,CAACyD,SAAS,CAAC,IAAIzD,OAAO,CAACmc,KAAK,KAAK,IAAI;SAC1F,IAAIqC,mBAAmB,IAAI,CAACD,aAAa,EACzC;WACC,OAAO,KAAK;;SAGbxe,KAAK,CAACE,MAAM,CAAC,QAAQ,EAAE;WACtB2B,QAAQ,EAAEgO,YAAY,CAAChO,QAAQ;WAC/BpB,MAAM,EAAE;aAAC2b,KAAK,EAAEnc,OAAO,CAACmc,KAAK,KAAK;;UAClC,CAAC;QACF;OAEDF,KAAK,EAAE,CAAClc,KAAK,EAAEC,OAA4C,KAC3D;SACC,MAAMd,MAAM,GAAG,IAAI,CAACa,KAAK,CAACwD,OAAO,CAAC,eAAe,CAAC,CAACvD,OAAO,CAAC+F,EAAE,CAAC;SAC9D,IAAI,CAAC7G,MAAM,EACX;WACC,OAAO,KAAK;;SAGb,IAAI0Q,YAAY,GAAG7P,KAAK,CAACJ,KAAK,CAACqD,UAAU,CAAChD,OAAO,CAAC+F,EAAE,CAAC;SACrD,IAAI,CAAC6J,YAAY,EACjB;WACC,IAAI5P,OAAO,CAACmG,IAAI,KAAK,EAAE,EACvB;aACC,OAAO,KAAK;;WAEb,MAAMjB,OAAO,GAAG;aACftD,QAAQ,EAAE5B,OAAO,CAAC+F,EAAE,CAAClE,QAAQ;YAC7B;WACD9B,KAAK,CAACE,MAAM,CAAC,KAAK,EAAE;aAAC,GAAG,IAAI,CAACsE,eAAe,EAAE;aAAE,GAAGW;YAAQ,CAAC;WAC5DnF,KAAK,CAACE,MAAM,CAAC,qBAAqB,EAAE,CAACiF,OAAO,CAACtD,QAAQ,CAAC,CAAC;WACvDgO,YAAY,GAAG7P,KAAK,CAACJ,KAAK,CAACqD,UAAU,CAAChD,OAAO,CAAC+F,EAAE,CAAC;;SAGlD,MAAMvF,MAAM,GAAG,IAAI,CAACN,QAAQ,CAAC;WAAC+b,KAAK,EAAE;aAAC9V,IAAI,EAAEnG,OAAO,CAACmG,IAAI,CAACtE,QAAQ;;UAAI,CAAC;SACtE,IAAIrB,MAAM,CAACyb,KAAK,CAAC9V,IAAI,KAAKyJ,YAAY,CAACqM,KAAK,CAAC9V,IAAI,EACjD;WACC,OAAO,KAAK;;SAGbpG,KAAK,CAACE,MAAM,CAAC,QAAQ,EAAE;WACtB2B,QAAQ,EAAEgO,YAAY,CAAChO,QAAQ;WAC/BpB;UACA,CAAC;QACF;OAEDwD,MAAM,EAAE,CAACjE,KAAK,EAAEC,OAA8B,KAC9C;SACC,MAAM4P,YAAY,GAAG7P,KAAK,CAACJ,KAAK,CAACqD,UAAU,CAAChD,OAAO,CAAC+F,EAAE,CAAC;SACvD,IAAI,CAAC6J,YAAY,EACjB;WACC,OAAO,KAAK;;SAGb7P,KAAK,CAACE,MAAM,CAAC,QAAQ,EAAE;WACtB8F,EAAE,EAAE6J,YAAY,CAAChO;UACjB,CAAC;SACF7B,KAAK,CAACE,MAAM,CAAC,4BAA4B,EAAE2P,YAAY,CAAChO,QAAQ,CAAC;QACjE;OAED6c,WAAW,EAAG1e,KAAK,IACnB;SACCA,KAAK,CAACE,MAAM,CAAC,aAAa,CAAC;QAC3B;OAEDye,uBAAuB,EAAE,CAAC3e,KAAK,EAAEC,OAAmC,KACpE;SACC,IAAI,CAACU,cAAI,CAAC8I,aAAa,CAACxJ,OAAO,CAAC,EAChC;WACC;;SAGDD,KAAK,CAACE,MAAM,CAAC,yBAAyB,EAAED,OAAO,CAAC;;MAEjD;;GAGFG,YAAY,GACZ;KACC,OAAO;OACNwe,mBAAmB,EAAE,CAAChf,KAAkB,EAAEK,OAAiB,KAAK;SAC/DA,OAAO,CAACM,OAAO,CAACsB,QAAQ,IAAI;WAC3BjC,KAAK,CAAC+b,gBAAgB,CAAC3X,GAAG,CAACnC,QAAQ,CAAC;UACpC,CAAC;QACF;OACDgd,0BAA0B,EAAE,CAACjf,KAAkB,EAAEK,OAAe,KAAK;SACpEL,KAAK,CAAC+b,gBAAgB,CAAC1X,MAAM,CAAChE,OAAO,CAAC;QACtC;OACD6e,mBAAmB,EAAE,CAAClf,KAAkB,EAAEK,OAAiB,KAAK;SAC/DA,OAAO,CAACM,OAAO,CAACsB,QAAQ,IAAI;WAC3BjC,KAAK,CAACgc,gBAAgB,CAAC5X,GAAG,CAACnC,QAAQ,CAAC;UACpC,CAAC;QACF;OACDmC,GAAG,EAAE,CAACpE,KAAkB,EAAEK,OAA0B,KAAK;SACxD,IAAI,CAACsJ,KAAK,CAACC,OAAO,CAACvJ,OAAO,CAAC,IAAIU,cAAI,CAAC8I,aAAa,CAACxJ,OAAO,CAAC,EAC1D;WACCA,OAAO,GAAG,CAACA,OAAO,CAAC;;SAEpBA,OAAO,CAACM,OAAO,CAAC2E,IAAI,IAAI;WACvBtF,KAAK,CAACqD,UAAU,CAACiC,IAAI,CAACrD,QAAQ,CAAC,GAAGqD,IAAI;UACtC,CAAC;QACF;OAEDrC,MAAM,EAAE,CAACjD,KAAkB,EAAEK,OAA0B,KAAK;SAC3D,IAAI,CAACsJ,KAAK,CAACC,OAAO,CAACvJ,OAAO,CAAC,IAAIU,cAAI,CAAC8I,aAAa,CAACxJ,OAAO,CAAC,EAC1D;WACCA,OAAO,GAAG,CAACA,OAAO,CAAC;;SAEpBA,OAAO,CAACM,OAAO,CAAC,CAAC;WAACsB,QAAQ;WAAEpB;UAAO,KAAK;;WAEvC,MAAMse,kBAAkB,GAAGte,MAAM,CAACiT,OAAO,IAAIjT,MAAM,CAACiT,OAAO,CAACsJ,iBAAiB,IAAI,CAACvc,MAAM,CAAC4b,UAAU;WACnG,IAAI0C,kBAAkB,EACtB;aACC,OAAO,KAAK;;WAGb,MAAMC,cAAc,GAAGpf,KAAK,CAACqD,UAAU,CAACpB,QAAQ,CAAC;WACjDpB,MAAM,CAACwH,OAAO,GAAG;aAAC,GAAG+W,cAAc,CAAC/W,OAAO;aAAE,GAAGxH,MAAM,CAACwH;YAAQ;WAC/DxH,MAAM,CAACiT,OAAO,GAAG;aAAC,GAAGsL,cAAc,CAACtL,OAAO;aAAE,GAAGjT,MAAM,CAACiT;YAAQ;WAC/D9T,KAAK,CAACqD,UAAU,CAACpB,QAAQ,CAAC,GAAG;aAC5B,GAAGmd,cAAc;aACjB,GAAGve;YACH;UACD,CAAC;QACF;OAEDwD,MAAM,EAAE,CAACrE,KAAkB,EAAEK,OAAqB,KAAK;SACtD,OAAOL,KAAK,CAACqD,UAAU,CAAChD,OAAO,CAAC+F,EAAE,CAAC;QACnC;OAED0Y,WAAW,EAAG9e,KAAkB,IAAK;SACpCS,MAAM,CAACyC,IAAI,CAAClD,KAAK,CAACqD,UAAU,CAAC,CAAC1C,OAAO,CAACV,GAAG,IAAI;WAC5CD,KAAK,CAACqD,UAAU,CAACpD,GAAG,CAAC,CAAC2G,MAAM,GAAG,KAAK;UACpC,CAAC;QACF;OAEDmY,uBAAuB,EAAE,CAAC/e,KAAkB,EAAEK,OAAmC,KAAK;SACrFI,MAAM,CAACC,OAAO,CAACL,OAAO,CAAC,CAACM,OAAO,CAAC,CAAC,CAAC4C,MAAM,EAAEyC,OAAO,CAAC,KAAK;WACtD,IAAIA,OAAO,KAAK,CAAC,EACjB;aACC,OAAOhG,KAAK,CAACic,oBAAoB,CAAC1Y,MAAM,CAAC;aACzC;;WAEDvD,KAAK,CAACic,oBAAoB,CAAC1Y,MAAM,CAAC,GAAGyC,OAAO;UAC5C,CAAC;;MAEH;;GAGFzF,QAAQ,CAACM,MAAc,EACvB;KACC,MAAMC,MAAM,GAAG;OACdgT,OAAO,EAAE;MACT;KAED,IAAI/S,cAAI,CAACK,QAAQ,CAACP,MAAM,CAACuF,EAAE,CAAC,EAC5B;OACCtF,MAAM,CAACmB,QAAQ,GAAGpB,MAAM,CAACuF,EAAE,CAAClE,QAAQ,EAAE;;KAEvC,IAAInB,cAAI,CAACE,cAAc,CAACJ,MAAM,CAACuF,EAAE,CAAC,EAClC;OACCtF,MAAM,CAACmB,QAAQ,GAAGpB,MAAM,CAACuF,EAAE;;KAG5B,IAAIrF,cAAI,CAACK,QAAQ,CAACP,MAAM,CAACoB,QAAQ,CAAC,EAClC;OACCnB,MAAM,CAACmB,QAAQ,GAAGpB,MAAM,CAACoB,QAAQ,CAACC,QAAQ,EAAE;;KAE7C,IAAInB,cAAI,CAACE,cAAc,CAACJ,MAAM,CAACoB,QAAQ,CAAC,EACxC;OACCnB,MAAM,CAACmB,QAAQ,GAAGpB,MAAM,CAACoB,QAAQ;;KAGlC,IAAIlB,cAAI,CAAC8I,aAAa,CAAChJ,MAAM,CAACwH,OAAO,CAAC,EACtC;OACCvH,MAAM,CAACuH,OAAO,GAAG,IAAI,CAACgX,cAAc,CAACxe,MAAM,CAAC;;KAG7C,IAAIE,cAAI,CAAC8I,aAAa,CAAChJ,MAAM,CAACyb,KAAK,CAAC,EACpC;OACCxb,MAAM,CAACwb,KAAK,GAAG,IAAI,CAACgD,YAAY,CAACze,MAAM,CAAC;;KAGzC,IAAIE,cAAI,CAACC,SAAS,CAACH,MAAM,CAAC+F,MAAM,CAAC,EACjC;OACC9F,MAAM,CAAC8F,MAAM,GAAG/F,MAAM,CAAC+F,MAAM;;KAG9B,IAAI7F,cAAI,CAACC,SAAS,CAACH,MAAM,CAAC0b,MAAM,CAAC,EACjC;OACCzb,MAAM,CAACyb,MAAM,GAAG1b,MAAM,CAAC0b,MAAM;;KAG9B,IAAIxb,cAAI,CAACC,SAAS,CAACH,MAAM,CAAC2b,KAAK,CAAC,EAChC;OACC1b,MAAM,CAAC0b,KAAK,GAAG3b,MAAM,CAAC2b,KAAK;;KAG5B,IAAIzb,cAAI,CAAC8I,aAAa,CAAChJ,MAAM,CAAC0e,OAAO,CAAC,EACtC;OACCze,MAAM,CAAC2b,UAAU,GAAG;SACnBC,QAAQ,EAAE,IAAI;SACdC,UAAU,EAAE9b,MAAM,CAAC0e,OAAO,CAACC,aAAa;SACxC5C,SAAS,EAAE/b,MAAM,CAAC0e,OAAO,CAACE;QAC1B;OACD3e,MAAM,CAACgT,OAAO,CAACsJ,iBAAiB,GAAG,IAAI;MACvC,MACI,IAAIvc,MAAM,CAAC0e,OAAO,KAAK,KAAK,EACjC;OACCze,MAAM,CAAC2b,UAAU,GAAG;SACnBC,QAAQ,EAAE,KAAK;SACfC,UAAU,EAAE,CAAC;SACbC,SAAS,EAAE;QACX;OACD9b,MAAM,CAACgT,OAAO,CAACsJ,iBAAiB,GAAG,IAAI;;KAGxC,IAAIrc,cAAI,CAAC8I,aAAa,CAAChJ,MAAM,CAACiT,OAAO,CAAC,EACtC;OACC,IAAI,CAAChT,MAAM,CAACgT,OAAO,EACnB;SACChT,MAAM,CAACgT,OAAO,GAAG,EAAE;;OAGpB,IAAI/S,cAAI,CAACC,SAAS,CAACH,MAAM,CAACiT,OAAO,CAAC4L,mBAAmB,CAAC,EACtD;SACC7e,MAAM,CAACiT,OAAO,CAACsJ,iBAAiB,GAAGvc,MAAM,CAACiT,OAAO,CAAC4L,mBAAmB;;OAGtE,IAAI3e,cAAI,CAACC,SAAS,CAACH,MAAM,CAACiT,OAAO,CAACsJ,iBAAiB,CAAC,EACpD;SACCtc,MAAM,CAACgT,OAAO,CAACsJ,iBAAiB,GAAGvc,MAAM,CAACiT,OAAO,CAACsJ,iBAAiB;;OAGpE,IAAIrc,cAAI,CAACC,SAAS,CAACH,MAAM,CAACiT,OAAO,CAACoJ,mBAAmB,CAAC,EACtD;SACCpc,MAAM,CAACgT,OAAO,CAACoJ,mBAAmB,GAAGrc,MAAM,CAACiT,OAAO,CAACoJ,mBAAmB;;;KAIzE,OAAOpc,MAAM;;GAGdue,cAAc,CAACxe,MAAc,EAC7B;KAAA;KACC,MAAMwH,OAAO,GAAG,EAAE;KAClB,MAAMkD,MAAM,GAAG,EAAE;KAEjB,IACCxK,cAAI,CAACK,QAAQ,CAACP,MAAM,CAACwH,OAAO,CAACjC,EAAE,CAAC,IAC7BrF,cAAI,CAACE,cAAc,CAACJ,MAAM,CAACwH,OAAO,CAACjC,EAAE,CAAC,IACtCyE,qBAAK,CAACrE,IAAI,CAACsE,QAAQ,CAACjK,MAAM,CAACwH,OAAO,CAACjC,EAAE,CAAC,EAE1C;OACCiC,OAAO,CAACjC,EAAE,GAAGvF,MAAM,CAACwH,OAAO,CAACjC,EAAE;;KAE/B,IAAIrF,cAAI,CAACoK,QAAQ,CAACtK,MAAM,CAACwH,OAAO,CAAC7B,IAAI,CAAC,EACtC;OACC6B,OAAO,CAAC7B,IAAI,GAAG3F,MAAM,CAACwH,OAAO,CAAC7B,IAAI;;KAGnC,IACCzF,cAAI,CAACE,cAAc,CAACJ,MAAM,CAACwH,OAAO,CAAC1B,MAAM,CAAC,IACvC5F,cAAI,CAACC,SAAS,CAACH,MAAM,CAACwH,OAAO,CAAC1B,MAAM,CAAC,IACrC5F,cAAI,CAAC6I,OAAO,CAAC/I,MAAM,CAACwH,OAAO,CAAC1B,MAAM,CAAC,EAEvC;OACC4E,MAAM,CAAC8Q,UAAU,GAAGxb,MAAM,CAACwH,OAAO,CAAC1B,MAAM;MACzC,MACI,IACJ5F,cAAI,CAACE,cAAc,0BAACJ,MAAM,CAACwH,OAAO,CAACkD,MAAM,qBAArB,sBAAuB8Q,UAAU,CAAC,IACnDtb,cAAI,CAACC,SAAS,2BAACH,MAAM,CAACwH,OAAO,CAACkD,MAAM,qBAArB,uBAAuB8Q,UAAU,CAAC,IACjDtb,cAAI,CAAC6I,OAAO,2BAAC/I,MAAM,CAACwH,OAAO,CAACkD,MAAM,qBAArB,uBAAuB8Q,UAAU,CAAC,EAEnD;OACC9Q,MAAM,CAAC8Q,UAAU,GAAGxb,MAAM,CAACwH,OAAO,CAACkD,MAAM,CAAC8Q,UAAU;;KAGrD,IAAItb,cAAI,CAACC,SAAS,CAACH,MAAM,CAACwH,OAAO,CAAC6R,IAAI,CAAC,IAAInZ,cAAI,CAAC8I,aAAa,CAAChJ,MAAM,CAACwH,OAAO,CAAC6R,IAAI,CAAC,EAClF;OACC3O,MAAM,CAAC6Q,QAAQ,GAAGvb,MAAM,CAACwH,OAAO,CAAC6R,IAAI;MACrC,MACI,IAAInZ,cAAI,CAACC,SAAS,2BAACH,MAAM,CAACwH,OAAO,CAACkD,MAAM,qBAArB,uBAAuB6Q,QAAQ,CAAC,IAAIrb,cAAI,CAAC8I,aAAa,2BAAChJ,MAAM,CAACwH,OAAO,CAACkD,MAAM,qBAArB,uBAAuB6Q,QAAQ,CAAC,EAC/G;OACC7Q,MAAM,CAAC6Q,QAAQ,GAAGvb,MAAM,CAACwH,OAAO,CAACkD,MAAM,CAAC6Q,QAAQ;;KAGjD,IAAIrb,cAAI,CAACyX,MAAM,CAAC3X,MAAM,CAACwH,OAAO,CAAC/B,IAAI,CAAC,IAAIvF,cAAI,CAACoK,QAAQ,CAACtK,MAAM,CAACwH,OAAO,CAAC/B,IAAI,CAAC,EAC1E;OACC+B,OAAO,CAAC/B,IAAI,GAAGuE,qBAAK,CAACvE,IAAI,CAAC4E,IAAI,CAACrK,MAAM,CAACwH,OAAO,CAAC/B,IAAI,CAAC;;KAGpD,IAAIvF,cAAI,CAACK,QAAQ,CAACP,MAAM,CAACwH,OAAO,CAACiD,SAAS,CAAC,EAC3C;OACCjD,OAAO,CAACgD,QAAQ,GAAGxK,MAAM,CAACwH,OAAO,CAACiD,SAAS;MAC3C,MACI,IAAIvK,cAAI,CAACK,QAAQ,CAACP,MAAM,CAACwH,OAAO,CAAChC,QAAQ,CAAC,EAC/C;OACCgC,OAAO,CAACgD,QAAQ,GAAGxK,MAAM,CAACwH,OAAO,CAAChC,QAAQ;MAC1C,MACI,IAAItF,cAAI,CAACK,QAAQ,CAACP,MAAM,CAACwH,OAAO,CAACgD,QAAQ,CAAC,EAC/C;OACChD,OAAO,CAACgD,QAAQ,GAAGxK,MAAM,CAACwH,OAAO,CAACgD,QAAQ;;KAG3C,IAAItK,cAAI,CAACE,cAAc,CAACJ,MAAM,CAACwH,OAAO,CAAC6M,MAAM,CAAC,EAC9C;OACC7M,OAAO,CAAC6M,MAAM,GAAGrU,MAAM,CAACwH,OAAO,CAAC6M,MAAM;;KAEvC,IAAInU,cAAI,CAACC,SAAS,CAACH,MAAM,CAACwH,OAAO,CAACtB,OAAO,CAAC,EAC1C;OACCsB,OAAO,CAACtB,OAAO,GAAGlG,MAAM,CAACwH,OAAO,CAACtB,OAAO;;KAGzC,IAAItG,MAAM,CAACyC,IAAI,CAACqI,MAAM,CAAC,CAACrH,MAAM,GAAG,CAAC,EAClC;OACCmE,OAAO,CAACkD,MAAM,GAAGA,MAAM;;KAGxB,OAAOlD,OAAO;;GAGfiX,YAAY,CAACze,MAAc,EAC3B;KACC,MAAM;OAACyb;MAAM,GAAG,IAAI,CAAC1X,eAAe,EAAE;KAEtC,IAAI7D,cAAI,CAACoK,QAAQ,CAACtK,MAAM,CAACyb,KAAK,CAAC9V,IAAI,CAAC,EACpC;OACC8V,KAAK,CAAC9V,IAAI,GAAG3F,MAAM,CAACyb,KAAK,CAAC9V,IAAI;;KAG/B,IAAIzF,cAAI,CAACE,cAAc,CAACqb,KAAK,CAAC9V,IAAI,CAAC,EACnC;OACC8V,KAAK,CAAChW,IAAI,GAAG,IAAIC,IAAI,EAAE;MACvB,MAED;OACC+V,KAAK,CAAChW,IAAI,GAAG,IAAI;;KAGlB,OAAOgW,KAAK;;CAEd;;CCjqBO,MAAMqD,kBAAkB,SAAS1gB,yBAAY,CACpD;GACCqC,OAAO,GACP;KACC,OAAO,eAAe;;GAGvBpC,QAAQ,GACR;KACC,OAAO;OACNmE,UAAU,EAAE,IAAIuc,GAAG,EAAE;OACrBC,gBAAgB,EAAE,IAAID,GAAG,EAAE;OAC3BE,aAAa,EAAE;MACf;;GAGFlb,eAAe,GACf;KACC,OAAO;OACNwB,EAAE,EAAE,CAAC;OACLC,QAAQ,EAAE,CAAC;OACXC,IAAI,EAAE,IAAIC,IAAI,EAAE;OAChB+L,KAAK,EAAE,EAAE;OACT9L,IAAI,EAAE,EAAE;OACR+E,MAAM,EAAE,EAAE;OACV9E,QAAQ,EAAE,EAAE;OACZsZ,aAAa,EAAE,EAAE;OACjBC,WAAW,EAAEC,kCAAsB,CAACC,MAAM;OAC1CC,IAAI,EAAE,KAAK;OACXC,WAAW,EAAE;MACb;;GAGFtgB,UAAU,GACV;KACC,OAAO;OACNid,mBAAmB,EAAE/c,KAAK,IAC1B;SACC,OAAO,CAAC,GAAGA,KAAK,CAACqD,UAAU,CAACsI,MAAM,EAAE,CAAC,CAAC/D,IAAI,CAAC,IAAI,CAACyY,UAAU,CAAC;QAC3D;OACDC,yBAAyB,EAAEtgB,KAAK,IAChC;SACC,OAAO,CAAC,GAAGA,KAAK,CAAC6f,gBAAgB,CAAClU,MAAM,EAAE,CAAC,CAAC/D,IAAI,CAAC,IAAI,CAACyY,UAAU,CAAC;QACjE;OACDE,gBAAgB,EAAEvgB,KAAK,IACvB;SACC,OAAO,CAAC,GAAGA,KAAK,CAACqD,UAAU,CAACsI,MAAM,EAAE,CAAC,CAAC/C,MAAM,CAACxG,YAAY,IAAI;WAC5D,OAAOA,YAAY,CAAC4d,WAAW,KAAKC,kCAAsB,CAACO,OAAO;UAClE,CAAC,CAACtc,MAAM;QACT;OACD6D,OAAO,EAAE/H,KAAK,IAAKygB,cAAc,IACjC;SACC,IAAI1f,cAAI,CAACoK,QAAQ,CAACsV,cAAc,CAAC,EACjC;WACCA,cAAc,GAAGvf,MAAM,CAACC,QAAQ,CAACsf,cAAc,EAAE,EAAE,CAAC;;SAGrD,MAAMxQ,YAAY,GAAGjQ,KAAK,CAACqD,UAAU,CAACtD,GAAG,CAAC0gB,cAAc,CAAC;SACzD,IAAI,CAACxQ,YAAY,EACjB;WACC,OAAO,KAAK;;SAGb,OAAOA,YAAY;QACnB;OACDyQ,UAAU,EAAG1gB,KAAK,IAClB;SACC,OAAOA,KAAK,CAAC8f,aAAa;;MAE3B;;GAGF5f,UAAU,GACV;KACC,OAAO;OACNygB,UAAU,EAAE,CAACvgB,KAAK,EAAEC,OAAO,KAC3B;SACC,IAAIU,cAAI,CAACK,QAAQ,CAACf,OAAO,CAACugB,kBAAkB,CAAC,EAC7C;WACCxgB,KAAK,CAACE,MAAM,CAAC,YAAY,EAAED,OAAO,CAACugB,kBAAkB,CAAC;;SAGvD,IAAI,CAAC7f,cAAI,CAAC+K,aAAa,CAACzL,OAAO,CAACwgB,aAAa,CAAC,EAC9C;WACC;;SAGD,MAAMvC,aAAa,GAAG,EAAE;SACxB,MAAMC,UAAU,GAAG,EAAE;SAErB,MAAMvV,aAAa,GAAGtF,2BAAI,CAACkC,SAAS,EAAE;SACtCvF,OAAO,CAACwgB,aAAa,CAACrd,GAAG,CAACwI,OAAO,IAAI;WACpC,OAAO2T,kBAAkB,CAACpf,QAAQ,CAACyL,OAAO,EAAEhD,aAAa,CAAC;UAC1D,CAAC,CAACrI,OAAO,CAACqL,OAAO,IAAI;WACrB,MAAMiE,YAAY,GAAG7P,KAAK,CAACJ,KAAK,CAACqD,UAAU,CAACtD,GAAG,CAACiM,OAAO,CAAC5F,EAAE,CAAC;WAC3D,IAAI6J,YAAY,EAChB;aACCqO,aAAa,CAACpW,IAAI,CAAC;eAAC9B,EAAE,EAAE6J,YAAY,CAAC7J,EAAE;eAAEvF,MAAM,EAAE;iBAAC,GAAGmL;;cAAS,CAAC;YAC/D,MAED;aACCuS,UAAU,CAACrW,IAAI,CAAC;eAAC,GAAG,IAAI,CAACtD,eAAe,EAAE;eAAE,GAAGoH;cAAQ,CAAC;;UAEzD,CAAC;SAEF,IAAIuS,UAAU,CAACra,MAAM,GAAG,CAAC,EACzB;WACC9D,KAAK,CAACE,MAAM,CAAC,KAAK,EAAEie,UAAU,CAAC;;SAEhC,IAAID,aAAa,CAACpa,MAAM,GAAG,CAAC,EAC5B;WACC9D,KAAK,CAACE,MAAM,CAAC,QAAQ,EAAEge,aAAa,CAAC;;QAEtC;OACDne,GAAG,EAAE,CAACC,KAAK,EAAEC,OAAO,KACpB;SACC,IAAI,CAACsJ,KAAK,CAACC,OAAO,CAACvJ,OAAO,CAAC,IAAIU,cAAI,CAAC8I,aAAa,CAACxJ,OAAO,CAAC,EAC1D;WACCA,OAAO,GAAG,CAACA,OAAO,CAAC;;SAGpB,MAAMie,aAAa,GAAG,EAAE;SACxB,MAAMC,UAAU,GAAG,EAAE;SACrB,MAAMvV,aAAa,GAAGtF,2BAAI,CAACkC,SAAS,EAAE;SACtCvF,OAAO,CAACmD,GAAG,CAACwI,OAAO,IAAI;WACtB,OAAO2T,kBAAkB,CAACpf,QAAQ,CAACyL,OAAO,EAAEhD,aAAa,CAAC;UAC1D,CAAC,CAACrI,OAAO,CAACqL,OAAO,IAAI;WACrB,MAAMiE,YAAY,GAAG7P,KAAK,CAACJ,KAAK,CAACqD,UAAU,CAACtD,GAAG,CAACiM,OAAO,CAAC5F,EAAE,CAAC;WAC3D,IAAI6J,YAAY,EACf;aACAqO,aAAa,CAACpW,IAAI,CAAC;eAAC9B,EAAE,EAAE6J,YAAY,CAAC7J,EAAE;eAAEvF,MAAM,EAAE;iBAAC,GAAGmL;;cAAS,CAAC;YAC/D,MAED;aACCuS,UAAU,CAACrW,IAAI,CAAC;eAAC,GAAG,IAAI,CAACtD,eAAe,EAAE;eAAE,GAAGoH;cAAQ,CAAC;;UAEzD,CAAC;SAEF,IAAIuS,UAAU,CAACra,MAAM,GAAG,CAAC,EACzB;WACC9D,KAAK,CAACE,MAAM,CAAC,KAAK,EAAEie,UAAU,CAAC;WAC/BA,UAAU,CAAC5d,OAAO,CAAC,MAAM;aACxBP,KAAK,CAACE,MAAM,CAAC,iBAAiB,CAAC;YAC/B,CAAC;;SAEH,IAAIge,aAAa,CAACpa,MAAM,GAAG,CAAC,EAC5B;WACC9D,KAAK,CAACE,MAAM,CAAC,QAAQ,EAAEge,aAAa,CAAC;;QAEtC;OACDwC,eAAe,EAAE,CAAC1gB,KAAK,EAAEC,OAAO,KAChC;SACC,MAAMie,aAAa,GAAG,EAAE;SACxB,MAAMC,UAAU,GAAG,EAAE;SAErB,IAAI;WAACsC;UAAc,GAAGxgB,OAAO;SAE7B,MAAM0gB,cAAc,GAAG,CAAC,CAAC1gB,OAAO,CAAC0gB,cAAc;SAC/C,IAAI,CAACA,cAAc,EACnB;WACC,MAAM/X,aAAa,GAAGtF,2BAAI,CAACkC,SAAS,EAAE;WACtCib,aAAa,GAAGA,aAAa,CAACrd,GAAG,CAACwI,OAAO,IAAI;aAC5C,OAAO2T,kBAAkB,CAACpf,QAAQ,CAACyL,OAAO,EAAEhD,aAAa,CAAC;YAC1D,CAAC;;SAGH6X,aAAa,CAAClgB,OAAO,CAACqL,OAAO,IAAI;WAChC,MAAMiE,YAAY,GAAG7P,KAAK,CAACJ,KAAK,CAAC6f,gBAAgB,CAAC9f,GAAG,CAACiM,OAAO,CAAC5F,EAAE,CAAC;WACjE,IAAI6J,YAAY,EAChB;aACCqO,aAAa,CAACpW,IAAI,CAAC;eAAC9B,EAAE,EAAE6J,YAAY,CAAC7J,EAAE;eAAEvF,MAAM,EAAE;iBAAC,GAAGmL;;cAAS,CAAC;YAC/D,MAED;aACCuS,UAAU,CAACrW,IAAI,CAAC;eAAC,GAAG,IAAI,CAACtD,eAAe,EAAE;eAAE,GAAGoH;cAAQ,CAAC;;UAEzD,CAAC;SAEF,IAAIuS,UAAU,CAACra,MAAM,GAAG,CAAC,EACzB;WACC9D,KAAK,CAACE,MAAM,CAAC,iBAAiB,EAAEie,UAAU,CAAC;;SAE5C,IAAID,aAAa,CAACpa,MAAM,GAAG,CAAC,EAC5B;WACC9D,KAAK,CAACE,MAAM,CAAC,oBAAoB,EAAEge,aAAa,CAAC;;QAElD;OACD6B,IAAI,EAAE,CAAC/f,KAAK,EAAEC,OAAO,KACrB;SACCA,OAAO,CAACqK,GAAG,CAAC/J,OAAO,CAAC8f,cAAc,IAAI;WACrC,MAAMxQ,YAAY,GAAG7P,KAAK,CAACJ,KAAK,CAACqD,UAAU,CAACtD,GAAG,CAAC0gB,cAAc,CAAC;WAC/D,IAAI,CAACxQ,YAAY,IAAIA,YAAY,CAACkQ,IAAI,KAAK9f,OAAO,CAAC8f,IAAI,EACvD;aACC,OAAO,KAAK;;WAGb,IAAI9f,OAAO,CAAC8f,IAAI,EAChB;aACC/f,KAAK,CAACE,MAAM,CAAC,iBAAiB,CAAC;YAC/B,MAED;aACCF,KAAK,CAACE,MAAM,CAAC,iBAAiB,CAAC;;WAGhCF,KAAK,CAACE,MAAM,CAAC,MAAM,EAAE;aACpB8F,EAAE,EAAE6J,YAAY,CAAC7J,EAAE;aACnB+Z,IAAI,EAAE9f,OAAO,CAAC8f;YACd,CAAC;UACF,CAAC;QACF;OACDa,OAAO,EAAG5gB,KAAK,IACf;SACCA,KAAK,CAACE,MAAM,CAAC,SAAS,CAAC;SACvBF,KAAK,CAACE,MAAM,CAAC,YAAY,EAAE,CAAC,CAAC;QAC7B;OACD+D,MAAM,EAAE,CAACjE,KAAK,EAAEC,OAAO,KACvB;SACC,MAAM4P,YAAY,GAAG7P,KAAK,CAACJ,KAAK,CAACqD,UAAU,CAACtD,GAAG,CAACM,OAAO,CAAC+F,EAAE,CAAC;SAC3D,IAAI,CAAC6J,YAAY,EACjB;WACC;;SAGD,IAAIA,YAAY,CAACkQ,IAAI,KAAK,KAAK,EAC/B;WACC/f,KAAK,CAACE,MAAM,CAAC,iBAAiB,CAAC;;SAGhCF,KAAK,CAACE,MAAM,CAAC,QAAQ,EAAE;WAAC8F,EAAE,EAAE6J,YAAY,CAAC7J;UAAG,CAAC;QAC7C;OACD6a,iBAAiB,EAAG7gB,KAAK,IACzB;SACCA,KAAK,CAACE,MAAM,CAAC,mBAAmB,CAAC;QACjC;OACD4gB,UAAU,EAAE,CAAC9gB,KAAK,EAAEC,OAAO,KAC3B;SACCD,KAAK,CAACE,MAAM,CAAC,YAAY,EAAED,OAAO,CAAC;;MAEpC;;GAGFG,YAAY,GACZ;KACC,OAAO;OACN4D,GAAG,EAAE,CAACpE,KAAK,EAAEK,OAAO,KACpB;SACCA,OAAO,CAACM,OAAO,CAAC2E,IAAI,IAAI;WACvBtF,KAAK,CAACqD,UAAU,CAAClD,GAAG,CAACmF,IAAI,CAACc,EAAE,EAAEd,IAAI,CAAC;UACnC,CAAC;QACF;OACD6b,eAAe,EAAE,CAACnhB,KAAK,EAAEK,OAAO,KAChC;SACCA,OAAO,CAACM,OAAO,CAAC2E,IAAI,IAAI;WACvBtF,KAAK,CAAC6f,gBAAgB,CAAC1f,GAAG,CAACmF,IAAI,CAACc,EAAE,EAAEd,IAAI,CAAC;UACzC,CAAC;QACF;OACDrC,MAAM,EAAE,CAACjD,KAAK,EAAEK,OAAO,KACvB;SACCA,OAAO,CAACM,OAAO,CAAC2E,IAAI,IAAI;WACvBtF,KAAK,CAACqD,UAAU,CAAClD,GAAG,CAACmF,IAAI,CAACc,EAAE,EAAE;aAC7B,GAAGpG,KAAK,CAACqD,UAAU,CAACtD,GAAG,CAACuF,IAAI,CAACc,EAAE,CAAC;aAChC,GAAGd,IAAI,CAACzE;YACR,CAAC;UACF,CAAC;QACF;OACDugB,kBAAkB,EAAE,CAACphB,KAAK,EAAEK,OAAO,KACnC;SACCA,OAAO,CAACM,OAAO,CAAC2E,IAAI,IAAI;WACvBtF,KAAK,CAAC6f,gBAAgB,CAAC1f,GAAG,CAACmF,IAAI,CAACc,EAAE,EAAE;aACnC,GAAGpG,KAAK,CAAC6f,gBAAgB,CAAC9f,GAAG,CAACuF,IAAI,CAACc,EAAE,CAAC;aACtC,GAAGd,IAAI,CAACzE;YACR,CAAC;UACF,CAAC;QACF;OACDwD,MAAM,EAAE,CAACrE,KAAK,EAAEK,OAAO,KACvB;SACCL,KAAK,CAACqD,UAAU,CAACgB,MAAM,CAAChE,OAAO,CAAC+F,EAAE,CAAC;QACnC;OACD+Z,IAAI,EAAE,CAACngB,KAAK,EAAEK,OAAO,KACrB;SACCL,KAAK,CAACqD,UAAU,CAAClD,GAAG,CAACE,OAAO,CAAC+F,EAAE,EAAE;WAChC,GAAGpG,KAAK,CAACqD,UAAU,CAACtD,GAAG,CAACM,OAAO,CAAC+F,EAAE,CAAC;WACnC+Z,IAAI,EAAE9f,OAAO,CAAC8f;UACd,CAAC;QACF;OACDa,OAAO,EAAGhhB,KAAK,IACf;SACC,CAAC,GAAGA,KAAK,CAACqD,UAAU,CAACsI,MAAM,EAAE,CAAC,CAAChL,OAAO,CAAC2E,IAAI,IAAI;WAC9C,IAAI,CAACA,IAAI,CAAC6a,IAAI,EACd;aACC7a,IAAI,CAAC6a,IAAI,GAAG,IAAI;;UAEjB,CAAC;QACF;OACDe,UAAU,EAAE,CAAClhB,KAAK,EAAEK,OAAO,KAC3B;SACCL,KAAK,CAAC8f,aAAa,GAAG5e,MAAM,CAACC,QAAQ,CAACd,OAAO,EAAE,EAAE,CAAC;QAClD;OACD4Q,eAAe,EAAGjR,KAAK,IACvB;SACC,IAAIA,KAAK,CAAC8f,aAAa,GAAG,CAAC,EAC3B;WACC9f,KAAK,CAAC8f,aAAa,EAAE;;QAEtB;OACDjP,eAAe,EAAG7Q,KAAK,IACvB;SACCA,KAAK,CAAC8f,aAAa,EAAE;QACrB;OACDmB,iBAAiB,EAAGjhB,KAAK,IACzB;SACCA,KAAK,CAAC6f,gBAAgB,CAACwB,KAAK,EAAE;;MAE/B;;GAGF,OAAO9gB,QAAQ,CAACM,MAAc,EAC9B;KACC,MAAMC,MAAM,GAAG,EAAE;KAEjB,IAAIC,cAAI,CAACoK,QAAQ,CAACtK,MAAM,CAACuF,EAAE,CAAC,IAAIrF,cAAI,CAACK,QAAQ,CAACP,MAAM,CAACuF,EAAE,CAAC,EACxD;OACCtF,MAAM,CAACsF,EAAE,GAAGvF,MAAM,CAACuF,EAAE;;KAGtB,IAAIrF,cAAI,CAACK,QAAQ,CAACP,MAAM,CAACyK,SAAS,CAAC,EACnC;OACCxK,MAAM,CAACuF,QAAQ,GAAGxF,MAAM,CAACyK,SAAS;MAClC,MACI,IAAIvK,cAAI,CAACK,QAAQ,CAACP,MAAM,CAAC6E,MAAM,CAAC,EACrC;OACC5E,MAAM,CAACuF,QAAQ,GAAGxF,MAAM,CAAC6E,MAAM;;KAGhC,IAAI,CAAC3E,cAAI,CAACugB,KAAK,CAACzgB,MAAM,CAACyF,IAAI,CAAC,EAC5B;OACCxF,MAAM,CAACwF,IAAI,GAAGuE,qBAAK,CAACvE,IAAI,CAAC4E,IAAI,CAACrK,MAAM,CAACyF,IAAI,CAAC;;KAG3C,IAAIvF,cAAI,CAACoK,QAAQ,CAACtK,MAAM,CAAC0gB,YAAY,CAAC,EACtC;OACCzgB,MAAM,CAACwR,KAAK,GAAGzR,MAAM,CAAC0gB,YAAY;MAClC,MACI,IAAIxgB,cAAI,CAACoK,QAAQ,CAACtK,MAAM,CAACyR,KAAK,CAAC,EACpC;OACCxR,MAAM,CAACwR,KAAK,GAAGzR,MAAM,CAACyR,KAAK;;KAG5B,IAAIvR,cAAI,CAACoK,QAAQ,CAACtK,MAAM,CAAC2F,IAAI,CAAC,IAAIzF,cAAI,CAACK,QAAQ,CAACP,MAAM,CAAC2F,IAAI,CAAC,EAC5D;OACC1F,MAAM,CAAC0F,IAAI,GAAG+L,cAAI,CAACC,MAAM,CAAC3R,MAAM,CAAC2F,IAAI,CAACtE,QAAQ,EAAE,CAAC;;KAGlD,IAAInB,cAAI,CAAC4a,YAAY,CAAC9a,MAAM,CAAC0K,MAAM,CAAC,EACpC;OACCzK,MAAM,CAACyK,MAAM,GAAG1K,MAAM,CAAC0K,MAAM;;KAG9B,IAAIxK,cAAI,CAAC6I,OAAO,CAAC/I,MAAM,CAAC4F,QAAQ,CAAC,EACjC;OACC3F,MAAM,CAAC2F,QAAQ,GAAG5F,MAAM,CAAC4F,QAAQ;;KAGlC,IAAI,CAAC1F,cAAI,CAACugB,KAAK,CAACzgB,MAAM,CAAC2gB,cAAc,CAAC,EACtC;OACC1gB,MAAM,CAACif,aAAa,GAAG0B,IAAI,CAACC,KAAK,CAAC7gB,MAAM,CAAC2gB,cAAc,CAAC;MACxD,MACI,IAAI,CAACzgB,cAAI,CAACugB,KAAK,CAACzgB,MAAM,CAAC8gB,OAAO,CAAC,EACpC;OACC7gB,MAAM,CAACif,aAAa,GAAGlf,MAAM,CAAC8gB,OAAO,CAACne,GAAG,CAACoe,MAAM,IAAI;SACnD,OAAO;WACNC,OAAO,EAAE,eAAe;WACxBC,cAAc,EAAG,GAAEhhB,MAAM,CAACsF,EAAG,IAAGwb,MAAM,CAACG,KAAM,EAAC;WAC9CC,IAAI,EAAG,GAAEJ,MAAM,CAACK,KAAM,EAAC;WACvBC,IAAI,EAAE,QAAQ;WACdC,OAAO,EAAE,MAAM;WACfC,QAAQ,EAAGR,MAAM,CAACG,KAAK,KAAK,GAAG,GAAG,SAAS,GAAG,SAAU;WACxDM,UAAU,EAAE;UACZ;QACD,CAAC;;KAGH,IAAIxhB,MAAM,CAACyhB,WAAW,KAAKrC,kCAAsB,CAACO,OAAO,IAAI3f,MAAM,CAAC6L,IAAI,KAAKuT,kCAAsB,CAACO,OAAO,EAC3G;OACC1f,MAAM,CAACkf,WAAW,GAAGC,kCAAsB,CAACO,OAAO;MACnD,MAED;OACC1f,MAAM,CAACkf,WAAW,GAAGC,kCAAsB,CAACC,MAAM;;KAGnD,IAAI,CAACnf,cAAI,CAACugB,KAAK,CAACzgB,MAAM,CAAC0hB,WAAW,CAAC,EACnC;OACCzhB,MAAM,CAACqf,IAAI,GAAGtf,MAAM,CAAC0hB,WAAW,KAAK,GAAG;MACxC,MACI,IAAI,CAACxhB,cAAI,CAACugB,KAAK,CAACzgB,MAAM,CAACsf,IAAI,CAAC,EACjC;OACCrf,MAAM,CAACqf,IAAI,GAAGtf,MAAM,CAACsf,IAAI,KAAK,GAAG;;KAGlC,IAAIpf,cAAI,CAACoK,QAAQ,CAACtK,MAAM,CAAC2hB,YAAY,CAAC,EACtC;OACC1hB,MAAM,CAACsf,WAAW,GAAGvf,MAAM,CAAC2hB,YAAY;MACxC,MACI,IAAIzhB,cAAI,CAACoK,QAAQ,CAACtK,MAAM,CAACuf,WAAW,CAAC,EAC1C;OACCtf,MAAM,CAACsf,WAAW,GAAGvf,MAAM,CAACuf,WAAW;;KAGxC,OAAOtf,MAAM;;GAGduf,UAAU,CAACxY,CAAC,EAAEC,CAAC,EACf;KACC,IAAID,CAAC,CAACmY,WAAW,KAAKC,kCAAsB,CAACO,OAAO,IAAI1Y,CAAC,CAACkY,WAAW,KAAKC,kCAAsB,CAACO,OAAO,EACxG;OACC,OAAO,CAAC,CAAC;MACT,MACI,IAAI3Y,CAAC,CAACmY,WAAW,KAAKC,kCAAsB,CAACO,OAAO,IAAI1Y,CAAC,CAACkY,WAAW,KAAKC,kCAAsB,CAACO,OAAO,EAC7G;OACC,OAAO,CAAC;MACR,MAED;OACC,OAAO1Y,CAAC,CAAC1B,EAAE,GAAGyB,CAAC,CAACzB,EAAE;;;CAGrB;;CCvaO,MAAMqc,UAAU,SAASxjB,yBAAY,CAC5C;GACCC,QAAQ,GACR;KACC,OAAO;OACNmE,UAAU,EAAE,EAAE;OACdqf,QAAQ,EAAE;MACV;;GAGF5iB,UAAU,GACV;KACC,OAAO;OACNC,GAAG,EAAGC,KAAK,IAAMuD,MAAc,IAA+B;SAC7D,IAAI,CAACvD,KAAK,CAACqD,UAAU,CAACE,MAAM,CAAC,EAC7B;WACC,OAAO,EAAE;;SAGV,OAAO,CAAC,GAAGvD,KAAK,CAACqD,UAAU,CAACE,MAAM,CAAC,CAACoI,MAAM,EAAE,CAAC,CAAC/D,IAAI,CAAC,CAACC,CAAC,EAAEC,CAAC,KAAKA,CAAC,CAAC1B,EAAE,GAAGyB,CAAC,CAACzB,EAAE,CAAC;QACzE;OACDuc,OAAO,EAAG3iB,KAAK,IAAMuD,MAAc,IAAa;SAC/C,IAAI,CAACvD,KAAK,CAACqD,UAAU,CAACE,MAAM,CAAC,EAC7B;WACC,OAAO,CAAC;;SAGT,OAAOvD,KAAK,CAACqD,UAAU,CAACE,MAAM,CAAC,CAAC+V,IAAI;QACpC;OACDoH,UAAU,EAAG1gB,KAAK,IAAMuD,MAAc,IAAa;SAClD,IAAI,CAACvD,KAAK,CAAC0iB,QAAQ,CAACnf,MAAM,CAAC,EAC3B;WACC,OAAO,CAAC;;SAGT,OAAOvD,KAAK,CAAC0iB,QAAQ,CAACnf,MAAM,CAAC;;MAE9B;;GAGFqB,eAAe,GACf;KACC,OAAO;OACNwB,EAAE,EAAE,CAAC;OACLtC,SAAS,EAAE,CAAC;OACZP,MAAM,EAAE,CAAC;OACT8C,QAAQ,EAAE,CAAC;OACXuc,MAAM,EAAE,EAAE;OACVtc,IAAI,EAAE,IAAIC,IAAI,EAAE;OAChBsc,QAAQ,EAAE;SACTzc,EAAE,EAAE,IAAI;SACRwG,WAAW,EAAE,IAAI;SACjBuB,IAAI,EAAE,IAAI;SACVzM,IAAI,EAAE,IAAI;SACVohB,UAAU,EAAE,IAAI;SAChBpW,IAAI,EAAE;;MAEP;;GAGFxM,UAAU,GACV;KACC,OAAO;OACNghB,UAAU,EAAE,CAAC9gB,KAAK,EAAEC,OAAO,KAAK;SAC/B,IAAI,CAACU,cAAI,CAACK,QAAQ,CAACf,OAAO,CAAC2F,OAAO,CAAC,IAAI,CAACjF,cAAI,CAACK,QAAQ,CAACf,OAAO,CAACkD,MAAM,CAAC,EACrE;WACC;;SAGDnD,KAAK,CAACE,MAAM,CAAC,YAAY,EAAED,OAAO,CAAC;QACnC;OACDF,GAAG,EAAE,CAACC,KAAK,EAAEC,OAAO,KAAK;SACxB,MAAM;WAACkD,MAAM;WAAEwf;UAAM,GAAG1iB,OAAO;SAC/B,IAAI,CAACU,cAAI,CAAC+K,aAAa,CAACiX,KAAK,CAAC,IAAI,CAAChiB,cAAI,CAACK,QAAQ,CAACmC,MAAM,CAAC,EACxD;WACC;;SAGD,IAAI,CAACnD,KAAK,CAACJ,KAAK,CAACqD,UAAU,CAACE,MAAM,CAAC,EACnC;WACCnD,KAAK,CAACJ,KAAK,CAACqD,UAAU,CAACE,MAAM,CAAC,GAAG,IAAIqc,GAAG,EAAE;;SAG3CmD,KAAK,CAACpiB,OAAO,CAACwN,IAAI,IAAI;WACrB,MAAM6U,YAAY,GAAG;aAAC,GAAG,IAAI,CAACpe,eAAe,EAAE;aAAE,GAAG,IAAI,CAACrE,QAAQ,CAAC4N,IAAI;YAAE;WACxE/N,KAAK,CAACE,MAAM,CAAC,KAAK,EAAE;aAACiD,MAAM;aAAE4K,IAAI,EAAE6U;YAAa,CAAC;UACjD,CAAC;QACF;OACD3e,MAAM,EAAE,CAACjE,KAAK,EAAEC,OAAO,KAAK;SAC3B,MAAM;WAACkD,MAAM;WAAE6C;UAAG,GAAG/F,OAAO;SAC5B,IAAI,CAACU,cAAI,CAACK,QAAQ,CAACgF,EAAE,CAAC,IAAI,CAACrF,cAAI,CAACK,QAAQ,CAACmC,MAAM,CAAC,EAChD;WACC;;SAGD,IAAI,CAACnD,KAAK,CAACJ,KAAK,CAACqD,UAAU,CAACE,MAAM,CAAC,IAAI,CAACnD,KAAK,CAACJ,KAAK,CAACqD,UAAU,CAACE,MAAM,CAAC,CAACQ,GAAG,CAACqC,EAAE,CAAC,EAC9E;WACC;;SAGDhG,KAAK,CAACE,MAAM,CAAC,QAAQ,EAAE;WAACiD,MAAM;WAAE6C;UAAG,CAAC;;MAErC;;GAGF5F,YAAY,GACZ;KACC,OAAO;OACN0gB,UAAU,EAAE,CAAClhB,KAAK,EAAEK,OAAO,KAAK;SAC/B,MAAM;WAACkD,MAAM;WAAEyC;UAAQ,GAAG3F,OAAO;SACjCL,KAAK,CAAC0iB,QAAQ,CAACnf,MAAM,CAAC,GAAGyC,OAAO;QAChC;OACD5B,GAAG,EAAE,CAACpE,KAAK,EAAEK,OAAuD,KAAK;SACxE,MAAM;WAACkD,MAAM;WAAE4K;UAAK,GAAG9N,OAAO;SAC9BL,KAAK,CAACqD,UAAU,CAACE,MAAM,CAAC,CAACpD,GAAG,CAACgO,IAAI,CAAC/H,EAAE,EAAE+H,IAAI,CAAC;QAC3C;OACD9J,MAAM,EAAE,CAACrE,KAAK,EAAEK,OAAqC,KAAK;SACzD,MAAM;WAACkD,MAAM;WAAE6C;UAAG,GAAG/F,OAAO;SAC5BL,KAAK,CAACqD,UAAU,CAACE,MAAM,CAAC,CAACc,MAAM,CAAC+B,EAAE,CAAC;SACnCpG,KAAK,CAAC0iB,QAAQ,CAACnf,MAAM,CAAC,EAAE;;MAEzB;;GAGFhD,QAAQ,CAACM,MAAc,EACvB;KACC,MAAMC,MAAM,GAAG;OACd+hB,QAAQ,EAAE;MACV;KAED,IAAI9hB,cAAI,CAACK,QAAQ,CAACP,MAAM,CAACuF,EAAE,CAAC,EAC5B;OACCtF,MAAM,CAACsF,EAAE,GAAGvF,MAAM,CAACuF,EAAE;;KAGtB,IAAIrF,cAAI,CAACK,QAAQ,CAACP,MAAM,CAACiD,SAAS,CAAC,EACnC;OACChD,MAAM,CAACgD,SAAS,GAAGjD,MAAM,CAACiD,SAAS;;KAGpC,IAAI/C,cAAI,CAACK,QAAQ,CAACP,MAAM,CAAC0C,MAAM,CAAC,EAChC;OACCzC,MAAM,CAACyC,MAAM,GAAG1C,MAAM,CAAC0C,MAAM;;KAG9B,IAAIxC,cAAI,CAACK,QAAQ,CAACP,MAAM,CAACwF,QAAQ,CAAC,EAClC;OACCvF,MAAM,CAACuF,QAAQ,GAAGxF,MAAM,CAACwF,QAAQ;;KAGlC,IAAItF,cAAI,CAACoK,QAAQ,CAACtK,MAAM,CAACoiB,GAAG,CAACL,MAAM,CAAC,EACpC;OACC9hB,MAAM,CAAC8hB,MAAM,GAAG/hB,MAAM,CAACoiB,GAAG,CAACL,MAAM;;KAGlC,IAAI7hB,cAAI,CAACoK,QAAQ,CAACtK,MAAM,CAACmN,UAAU,CAAC,EACpC;OACClN,MAAM,CAACwF,IAAI,GAAGuE,qBAAK,CAACvE,IAAI,CAAC4E,IAAI,CAACrK,MAAM,CAACmN,UAAU,CAAC;;KAGjD,IAAIjN,cAAI,CAAC8I,aAAa,CAAChJ,MAAM,CAACoiB,GAAG,CAACJ,QAAQ,CAAC,EAC3C;OACC/hB,MAAM,CAAC+hB,QAAQ,GAAG,IAAI,CAACK,gBAAgB,CAACriB,MAAM,CAACoiB,GAAG,CAACJ,QAAQ,CAAC;;KAG7D,OAAO/hB,MAAM;;GAGdoiB,gBAAgB,CAACL,QAAgB,EACjC;KACC,MAAM/hB,MAAM,GAAG,EAAE;KAEjB,IAAIC,cAAI,CAACK,QAAQ,CAACyhB,QAAQ,CAACzc,EAAE,CAAC,EAC9B;OACCtF,MAAM,CAACsF,EAAE,GAAGyc,QAAQ,CAACzc,EAAE;;KAGxB,IAAIrF,cAAI,CAACoK,QAAQ,CAAC0X,QAAQ,CAACjW,WAAW,CAAC,EACvC;OACC9L,MAAM,CAAC8L,WAAW,GAAGiW,QAAQ,CAACjW,WAAW;;KAG1C,IAAI7L,cAAI,CAACoK,QAAQ,CAAC0X,QAAQ,CAAC1U,IAAI,CAAC,EAChC;OACCrN,MAAM,CAACqN,IAAI,GAAG0U,QAAQ,CAAC1U,IAAI;;KAG5B,IAAIpN,cAAI,CAACoK,QAAQ,CAAC0X,QAAQ,CAACnhB,IAAI,CAAC,EAChC;OACCZ,MAAM,CAACY,IAAI,GAAGmhB,QAAQ,CAACnhB,IAAI;;KAG5B,IAAIX,cAAI,CAACoK,QAAQ,CAAC0X,QAAQ,CAACC,UAAU,CAAC,EACtC;OACChiB,MAAM,CAACgiB,UAAU,GAAGD,QAAQ,CAACC,UAAU;;KAGxC,IAAI/hB,cAAI,CAACoK,QAAQ,CAAC0X,QAAQ,CAACnW,IAAI,CAAC,EAChC;OACC5L,MAAM,CAAC4L,IAAI,GAAGmW,QAAQ,CAACnW,IAAI;;KAG5B,OAAO5L,MAAM;;CAEf;;CC5MO,MAAMqiB,cAAc,SAASlkB,yBAAY,CAChD;GACCC,QAAQ,GACR;KACC,OAAO;OACNmE,UAAU,EAAE,EAAE;OACdqf,QAAQ,EAAE;MACV;;GAGF9d,eAAe,GACf;KACC,OAAO;OACNwB,EAAE,EAAE,CAAC;OACLtC,SAAS,EAAE,CAAC;OACZP,MAAM,EAAE,CAAC;OACT8C,QAAQ,EAAE,CAAC;OACXC,IAAI,EAAE,IAAIC,IAAI;MACd;;GAGFzG,UAAU,GACV;KACC,OAAO;OACNC,GAAG,EAAGC,KAAK,IAAMuD,MAAc,IAAmC;SACjE,IAAI,CAACvD,KAAK,CAACqD,UAAU,CAACE,MAAM,CAAC,EAC7B;WACC,OAAO,EAAE;;SAGV,OAAO,CAAC,GAAGvD,KAAK,CAACqD,UAAU,CAACE,MAAM,CAAC,CAACoI,MAAM,EAAE,CAAC,CAAC/D,IAAI,CAAC,CAACC,CAAC,EAAEC,CAAC,KAAKA,CAAC,CAAC1B,EAAE,GAAGyB,CAAC,CAACzB,EAAE,CAAC;QACzE;OACDuc,OAAO,EAAG3iB,KAAK,IAAMuD,MAAc,IAAa;SAC/C,IAAI,CAACvD,KAAK,CAACqD,UAAU,CAACE,MAAM,CAAC,EAC7B;WACC,OAAO,CAAC;;SAGT,OAAOvD,KAAK,CAACqD,UAAU,CAACE,MAAM,CAAC,CAAC+V,IAAI;QACpC;OACDoH,UAAU,EAAG1gB,KAAK,IAAMuD,MAAc,IAAa;SAClD,IAAIvD,KAAK,CAAC0iB,QAAQ,CAACnf,MAAM,CAAC,EAC1B;WACC,OAAOvD,KAAK,CAAC0iB,QAAQ,CAACnf,MAAM,CAAC;;SAG9B,OAAO,CAAC;QACR;OACD6f,iBAAiB,EAAGpjB,KAAK,IAAK,CAACuD,MAAc,EAAEO,SAAiB,KAAc;SAC7E,IAAI,CAAC9D,KAAK,CAACqD,UAAU,CAACE,MAAM,CAAC,EAC7B;WACC,OAAO,KAAK;;SAGb,MAAM8f,aAAa,GAAG5iB,MAAM,CAAC6iB,WAAW,CAACtjB,KAAK,CAACqD,UAAU,CAACE,MAAM,CAAC,CAAC;SAClE,MAAMggB,aAAa,GAAG9iB,MAAM,CAACkL,MAAM,CAAC0X,aAAa,CAAC,CAAC1U,IAAI,CAAC3C,OAAO,IAAIA,OAAO,CAAClI,SAAS,KAAKA,SAAS,CAAC;SAEnG,OAAO,CAAC,CAACyf,aAAa;;MAEvB;;GAGFrjB,UAAU,GACV;KACC,OAAO;OACNghB,UAAU,EAAE,CAAC9gB,KAAK,EAAEC,OAAO,KAAK;SAC/B,IAAI,CAACU,cAAI,CAACK,QAAQ,CAACf,OAAO,CAAC2F,OAAO,CAAC,IAAI,CAACjF,cAAI,CAACK,QAAQ,CAACf,OAAO,CAACkD,MAAM,CAAC,EACrE;WACC;;SAGDnD,KAAK,CAACE,MAAM,CAAC,YAAY,EAAED,OAAO,CAAC;QACnC;OACDF,GAAG,EAAE,CAACC,KAAK,EAAEC,OAAO,KAAK;SACxB,IAAIU,cAAI,CAACK,QAAQ,CAACf,OAAO,CAACmjB,SAAS,CAAC,EACpC;WACCnjB,OAAO,CAACmjB,SAAS,GAAG,CAACnjB,OAAO,CAACmjB,SAAS,CAAC;;SAExC,MAAM;WAACjgB,MAAM;WAAEigB;UAAU,GAAGnjB,OAAO;SAEnC,IAAI,CAACU,cAAI,CAAC+K,aAAa,CAAC0X,SAAS,CAAC,IAAI,CAACziB,cAAI,CAACK,QAAQ,CAACmC,MAAM,CAAC,EAC5D;WACC;;SAGD,IAAI,CAACnD,KAAK,CAACJ,KAAK,CAACqD,UAAU,CAACE,MAAM,CAAC,EACnC;WACCnD,KAAK,CAACJ,KAAK,CAACqD,UAAU,CAACE,MAAM,CAAC,GAAG,IAAIqc,GAAG,EAAE;;SAG3C4D,SAAS,CAAC7iB,OAAO,CAAC8iB,QAAQ,IAAI;WAC7B,MAAMC,uBAAuB,GAAG;aAAC,GAAG,IAAI,CAAC9e,eAAe,EAAE;aAAE,GAAG,IAAI,CAACrE,QAAQ,CAACkjB,QAAQ;YAAE;WACvFrjB,KAAK,CAACE,MAAM,CAAC,KAAK,EAAE;aAACiD,MAAM;aAAEkgB,QAAQ,EAAEC;YAAwB,CAAC;UAChE,CAAC;QACF;OACDrf,MAAM,EAAE,CAACjE,KAAK,EAAEC,OAAO,KAAK;SAC3B,MAAM;WAACkD,MAAM;WAAE6C;UAAG,GAAG/F,OAAO;SAC5B,IAAI,CAACU,cAAI,CAACK,QAAQ,CAACgF,EAAE,CAAC,IAAI,CAACrF,cAAI,CAACK,QAAQ,CAACmC,MAAM,CAAC,EAChD;WACC;;SAGD,IAAI,CAACnD,KAAK,CAACJ,KAAK,CAACqD,UAAU,CAACE,MAAM,CAAC,IAAI,CAACnD,KAAK,CAACJ,KAAK,CAACqD,UAAU,CAACE,MAAM,CAAC,CAACQ,GAAG,CAACqC,EAAE,CAAC,EAC9E;WACC;;SAGDhG,KAAK,CAACE,MAAM,CAAC,QAAQ,EAAE;WAACiD,MAAM;WAAE6C;UAAG,CAAC;QACpC;OACDud,iBAAiB,EAAE,CAACvjB,KAAK,EAAEC,OAA4C,KAAK;SAC3E,MAAM;WAACkD,MAAM;WAAEO;UAAU,GAAGzD,OAAO;SACnC,IAAI,CAACD,KAAK,CAACJ,KAAK,CAACqD,UAAU,CAACE,MAAM,CAAC,EACnC;WACC;;SAGD,MAAM4C,cAAc,GAAG/F,KAAK,CAACJ,KAAK,CAACqD,UAAU,CAACE,MAAM,CAAC;SACrD,IAAIqgB,YAAY,GAAG,IAAI;SACvB,KAAK,MAAM,CAACC,MAAM,EAAEC,UAAU,CAAC,IAAI3d,cAAc,EACjD;WACC,IAAI2d,UAAU,CAAChgB,SAAS,KAAKA,SAAS,EACtC;aACC8f,YAAY,GAAGC,MAAM;aACrB;;;SAIF,IAAI,CAACD,YAAY,EACjB;WACC;;SAGDxjB,KAAK,CAACE,MAAM,CAAC,QAAQ,EAAE;WAACiD,MAAM;WAAE6C,EAAE,EAAEwd;UAAa,CAAC;;MAEnD;;GAGFpjB,YAAY,GACZ;KACC,OAAO;OACN0gB,UAAU,EAAE,CAAClhB,KAAK,EAAEK,OAAO,KAAK;SAC/B,MAAM;WAACkD,MAAM;WAAEyC;UAAQ,GAAG3F,OAAO;SACjCL,KAAK,CAAC0iB,QAAQ,CAACnf,MAAM,CAAC,GAAGyC,OAAO;QAChC;OACD5B,GAAG,EAAE,CAACpE,KAAK,EAAEK,OAA+D,KAAK;SAChF,MAAM;WAACkD,MAAM;WAAEkgB;UAAS,GAAGpjB,OAAO;SAClCL,KAAK,CAACqD,UAAU,CAACE,MAAM,CAAC,CAACpD,GAAG,CAACsjB,QAAQ,CAACrd,EAAE,EAAEqd,QAAQ,CAAC;QACnD;OACDpf,MAAM,EAAE,CAACrE,KAAK,EAAEK,OAAqC,KAAK;SACzD,MAAM;WAACkD,MAAM;WAAE6C;UAAG,GAAG/F,OAAO;SAC5BL,KAAK,CAACqD,UAAU,CAACE,MAAM,CAAC,CAACc,MAAM,CAAC+B,EAAE,CAAC;SACnCpG,KAAK,CAAC0iB,QAAQ,CAACnf,MAAM,CAAC,EAAE;;MAEzB;;GAGFhD,QAAQ,CAACM,MAAc,EACvB;KACC,MAAMC,MAAM,GAAG,EAAE;KAEjB,IAAIC,cAAI,CAACK,QAAQ,CAACP,MAAM,CAACuF,EAAE,CAAC,EAC5B;OACCtF,MAAM,CAACsF,EAAE,GAAGvF,MAAM,CAACuF,EAAE;;KAGtB,IAAIrF,cAAI,CAACK,QAAQ,CAACP,MAAM,CAACiD,SAAS,CAAC,EACnC;OACChD,MAAM,CAACgD,SAAS,GAAGjD,MAAM,CAACiD,SAAS;;KAGpC,IAAI/C,cAAI,CAACK,QAAQ,CAACP,MAAM,CAAC0C,MAAM,CAAC,EAChC;OACCzC,MAAM,CAACyC,MAAM,GAAG1C,MAAM,CAAC0C,MAAM;;KAG9B,IAAIxC,cAAI,CAACK,QAAQ,CAACP,MAAM,CAACwF,QAAQ,CAAC,EAClC;OACCvF,MAAM,CAACuF,QAAQ,GAAGxF,MAAM,CAACwF,QAAQ;;KAGlC,IAAItF,cAAI,CAACoK,QAAQ,CAACtK,MAAM,CAACmN,UAAU,CAAC,EACpC;OACClN,MAAM,CAACwF,IAAI,GAAGuE,qBAAK,CAACvE,IAAI,CAAC4E,IAAI,CAACrK,MAAM,CAACmN,UAAU,CAAC;;KAGjD,OAAOlN,MAAM;;CAEf;;CChMO,MAAMijB,YAAY,SAAS9kB,yBAAY,CAC9C;GACCC,QAAQ,GACR;KACC,OAAO;OACNmE,UAAU,EAAE;MACZ;;GAGFvD,UAAU,GACV;KACC,OAAO;OACNC,GAAG,EAAGC,KAAK,IAAMuD,MAAc,IAC/B;SACC,IAAI,CAACvD,KAAK,CAACqD,UAAU,CAACE,MAAM,CAAC,EAC7B;WACC,OAAO,EAAE;;SAGV,OAAO,CAAC,GAAGvD,KAAK,CAACqD,UAAU,CAACE,MAAM,CAAC,CAAC;QACpC;OACDof,OAAO,EAAG3iB,KAAK,IAAMuD,MAAc,IAAa;SAC/C,IAAI,CAACvD,KAAK,CAACqD,UAAU,CAACE,MAAM,CAAC,EAC7B;WACC,OAAO,CAAC;;SAGT,OAAOvD,KAAK,CAACqD,UAAU,CAACE,MAAM,CAAC,CAAC+V,IAAI;;MAErC;;GAGFpZ,UAAU,GACV;KACC,OAAO;OACNC,GAAG,EAAE,CAACC,KAAK,EAAEC,OAAO,KACpB;SACC,MAAM;WAACkD,MAAM;WAAEwC;UAAM,GAAG1F,OAAO;SAC/B,IAAI,CAACU,cAAI,CAAC6I,OAAO,CAAC7D,KAAK,CAAC,IAAI,CAAChF,cAAI,CAACK,QAAQ,CAACmC,MAAM,CAAC,EAClD;WACC;;SAGD,IAAIwC,KAAK,CAAC7B,MAAM,GAAG,CAAC,EACpB;WACC9D,KAAK,CAACE,MAAM,CAAC,KAAK,EAAE;aAACiD,MAAM;aAAEwC;YAAM,CAAC;;QAErC;OACD1B,MAAM,EAAE,CAACjE,KAAK,EAAEC,OAAO,KAAK;SAC3B,MAAM;WAACkD,MAAM;WAAEmC;UAAO,GAAGrF,OAAO;SAChC,IAAI,CAACU,cAAI,CAACK,QAAQ,CAACmC,MAAM,CAAC,IAAI,CAACxC,cAAI,CAACK,QAAQ,CAACsE,MAAM,CAAC,EACpD;WACC;;SAGD,IAAI,CAACtF,KAAK,CAACJ,KAAK,CAACqD,UAAU,CAACE,MAAM,CAAC,EACnC;WACC;;SAGDnD,KAAK,CAACE,MAAM,CAAC,QAAQ,EAAE;WAACoF,MAAM;WAAEnC;UAAO,CAAC;;MAEzC;;GAGF/C,YAAY,GACZ;KACC,OAAO;OACNL,GAAG,EAAE,CAACH,KAAK,EAAEK,OAAO,KACpB;SACC,IAAI,CAACL,KAAK,CAACqD,UAAU,CAAChD,OAAO,CAACkD,MAAM,CAAC,EACrC;WACCvD,KAAK,CAACqD,UAAU,CAAChD,OAAO,CAACkD,MAAM,CAAC,GAAG,IAAIiB,GAAG,CAACnE,OAAO,CAAC0F,KAAK,CAAC;UACzD,MAED;WACC1F,OAAO,CAAC0F,KAAK,CAACpF,OAAO,CAACyF,EAAE,IAAI;aAC3BpG,KAAK,CAACqD,UAAU,CAAChD,OAAO,CAACkD,MAAM,CAAC,CAACa,GAAG,CAACgC,EAAE,CAAC;YACxC,CAAC;;QAEH;OACD/B,MAAM,EAAE,CAACrE,KAAK,EAAEK,OAAyC,KAAK;SAC7D,MAAM;WAACkD,MAAM;WAAEmC;UAAO,GAAGrF,OAAO;SAChCL,KAAK,CAACqD,UAAU,CAACE,MAAM,CAAC,CAACc,MAAM,CAACqB,MAAM,CAAC;;MAExC;;CAEH;;CCnFO,MAAMse,UAAU,SAAS/kB,yBAAY,CAC5C;GACCC,QAAQ,GACR;KACC,OAAO;OACNmE,UAAU,EAAE;MACZ;;GAGFuB,eAAe,GACf;KACC,OAAO;OACNwB,EAAE,EAAE,CAAC;OACLtC,SAAS,EAAE,CAAC;OACZP,MAAM,EAAE,CAAC;OACT8C,QAAQ,EAAE,CAAC;OACXC,IAAI,EAAE,IAAIC,IAAI,EAAE;OAChB0d,IAAI,EAAE;SACL7d,EAAE,EAAE,CAAC;SACLkM,KAAK,EAAE,EAAE;SACT4R,SAAS,EAAE,CAAC;SACZC,aAAa,EAAE,CAAC;SAChBjP,MAAM,EAAE,CAAC;SACTkP,WAAW,EAAE,EAAE;SACfC,QAAQ,EAAE,IAAI9d,IAAI,EAAE;SACpBvG,KAAK,EAAE,EAAE;SACT8M,KAAK,EAAE,EAAE;SACT8V,MAAM,EAAE;;MAET;;GAGF9iB,UAAU,GACV;KACC,OAAO;OACNC,GAAG,EAAGC,KAAK,IAAMuD,MAAc,IAA+B;SAC7D,IAAI,CAACvD,KAAK,CAACqD,UAAU,CAACE,MAAM,CAAC,EAC7B;WACC,OAAO,EAAE;;SAGV,OAAO,CAAC,GAAGvD,KAAK,CAACqD,UAAU,CAACE,MAAM,CAAC,CAACoI,MAAM,EAAE,CAAC,CAAC/D,IAAI,CAAC,CAACC,CAAC,EAAEC,CAAC,KAAKA,CAAC,CAAC1B,EAAE,GAAGyB,CAAC,CAACzB,EAAE,CAAC;QACzE;OACDuc,OAAO,EAAG3iB,KAAK,IAAMuD,MAAc,IAAa;SAC/C,IAAI,CAACvD,KAAK,CAACqD,UAAU,CAACE,MAAM,CAAC,EAC7B;WACC,OAAO,CAAC;;SAGT,OAAOvD,KAAK,CAACqD,UAAU,CAACE,MAAM,CAAC,CAAC+V,IAAI;;MAErC;;GAGFpZ,UAAU,GACV;KACC,OAAO;OACNC,GAAG,EAAE,CAACC,KAAK,EAAEC,OAAO,KAAK;SACxB,MAAM;WAACkD,MAAM;WAAE+gB;UAAM,GAAGjkB,OAAO;SAC/B,IAAI,CAACU,cAAI,CAAC+K,aAAa,CAACwY,KAAK,CAAC,IAAI,CAACvjB,cAAI,CAACK,QAAQ,CAACmC,MAAM,CAAC,EACxD;WACC;;SAGD,IAAI,CAACnD,KAAK,CAACJ,KAAK,CAACqD,UAAU,CAACE,MAAM,CAAC,EACnC;WACCnD,KAAK,CAACJ,KAAK,CAACqD,UAAU,CAACE,MAAM,CAAC,GAAG,IAAIqc,GAAG,EAAE;;SAG3C0E,KAAK,CAAC3jB,OAAO,CAACsjB,IAAI,IAAI;WACrB,MAAMM,YAAY,GAAG;aAAC,GAAG,IAAI,CAAC3f,eAAe,EAAE;aAAE,GAAG,IAAI,CAACrE,QAAQ,CAAC0jB,IAAI;YAAE;WACxE7jB,KAAK,CAACE,MAAM,CAAC,KAAK,EAAE;aAACiD,MAAM;aAAE0gB,IAAI,EAAEM;YAAa,CAAC;UACjD,CAAC;QACF;OACDlgB,MAAM,EAAE,CAACjE,KAAK,EAAEC,OAAO,KAAK;SAC3B,MAAM;WAACkD,MAAM;WAAE6C;UAAG,GAAG/F,OAAO;SAC5B,IAAI,CAACU,cAAI,CAACK,QAAQ,CAACmC,MAAM,CAAC,IAAI,CAACxC,cAAI,CAACK,QAAQ,CAACgF,EAAE,CAAC,EAChD;WACC;;SAGD,IAAI,CAAChG,KAAK,CAACJ,KAAK,CAACqD,UAAU,CAACE,MAAM,CAAC,EACnC;WACC;;SAGDnD,KAAK,CAACE,MAAM,CAAC,QAAQ,EAAE;WAAC8F,EAAE;WAAE7C;UAAO,CAAC;;MAErC;;GAGF/C,YAAY,GACZ;KACC,OAAO;OACN4D,GAAG,EAAE,CAACpE,KAAK,EAAEK,OAAuD,KAAK;SACxE,MAAM;WAACkD,MAAM;WAAE0gB;UAAK,GAAG5jB,OAAO;SAC9BL,KAAK,CAACqD,UAAU,CAACE,MAAM,CAAC,CAACpD,GAAG,CAAC8jB,IAAI,CAAC7d,EAAE,EAAE6d,IAAI,CAAC;QAC3C;OACD5f,MAAM,EAAE,CAACrE,KAAK,EAAEK,OAAqC,KAAK;SACzD,MAAM;WAAC+F,EAAE;WAAE7C;UAAO,GAAGlD,OAAO;SAC5BL,KAAK,CAACqD,UAAU,CAACE,MAAM,CAAC,CAACc,MAAM,CAAC+B,EAAE,CAAC;;MAEpC;;GAGF7F,QAAQ,CAACM,MAAc,EACvB;KACC,MAAMC,MAAM,GAAG;OACdmjB,IAAI,EAAE;MACN;KAED,IAAIljB,cAAI,CAACK,QAAQ,CAACP,MAAM,CAACuF,EAAE,CAAC,EAC5B;OACCtF,MAAM,CAACsF,EAAE,GAAGvF,MAAM,CAACuF,EAAE;;KAGtB,IAAIrF,cAAI,CAACK,QAAQ,CAACP,MAAM,CAACiD,SAAS,CAAC,EACnC;OACChD,MAAM,CAACgD,SAAS,GAAGjD,MAAM,CAACiD,SAAS;;KAGpC,IAAI/C,cAAI,CAACK,QAAQ,CAACP,MAAM,CAAC0C,MAAM,CAAC,EAChC;OACCzC,MAAM,CAACyC,MAAM,GAAG1C,MAAM,CAAC0C,MAAM;;KAG9B,IAAIxC,cAAI,CAACK,QAAQ,CAACP,MAAM,CAACwF,QAAQ,CAAC,EAClC;OACCvF,MAAM,CAACuF,QAAQ,GAAGxF,MAAM,CAACwF,QAAQ;;KAGlC,IAAItF,cAAI,CAACoK,QAAQ,CAACtK,MAAM,CAACmN,UAAU,CAAC,EACpC;OACClN,MAAM,CAACwF,IAAI,GAAGuE,qBAAK,CAACvE,IAAI,CAAC4E,IAAI,CAACrK,MAAM,CAACmN,UAAU,CAAC;;KAGjD,IAAIjN,cAAI,CAAC8I,aAAa,CAAChJ,MAAM,CAACojB,IAAI,CAAC,EACnC;OACCnjB,MAAM,CAACmjB,IAAI,GAAG,IAAI,CAACO,YAAY,CAAC3jB,MAAM,CAACojB,IAAI,CAAC;;KAG7C,OAAOnjB,MAAM;;GAGd0jB,YAAY,CAACP,IAAI,EACjB;KACC,MAAMnjB,MAAM,GAAG,EAAE;KAEjB,IAAIC,cAAI,CAACK,QAAQ,CAAC6iB,IAAI,CAAC7d,EAAE,CAAC,EAC1B;OACCtF,MAAM,CAACsF,EAAE,GAAG6d,IAAI,CAAC7d,EAAE;;KAGpB,IAAIrF,cAAI,CAACoK,QAAQ,CAAC8Y,IAAI,CAAC3R,KAAK,CAAC,EAC7B;OACCxR,MAAM,CAACwR,KAAK,GAAG2R,IAAI,CAAC3R,KAAK;;KAG1B,IAAIvR,cAAI,CAACK,QAAQ,CAAC6iB,IAAI,CAACC,SAAS,CAAC,EACjC;OACCpjB,MAAM,CAACojB,SAAS,GAAGD,IAAI,CAACC,SAAS;;KAGlC,IAAInjB,cAAI,CAACK,QAAQ,CAAC6iB,IAAI,CAACE,aAAa,CAAC,EACrC;OACCrjB,MAAM,CAACqjB,aAAa,GAAGF,IAAI,CAACE,aAAa;;KAG1C,IAAIpjB,cAAI,CAACK,QAAQ,CAAC6iB,IAAI,CAAC/O,MAAM,CAAC,EAC9B;OACCpU,MAAM,CAACoU,MAAM,GAAG+O,IAAI,CAAC/O,MAAM;;KAG5B,IAAInU,cAAI,CAACoK,QAAQ,CAAC8Y,IAAI,CAACG,WAAW,CAAC,EACnC;OACCtjB,MAAM,CAACsjB,WAAW,GAAGH,IAAI,CAACG,WAAW;;KAGtC,IAAIrjB,cAAI,CAACoK,QAAQ,CAAC8Y,IAAI,CAACI,QAAQ,CAAC,EAChC;OACCvjB,MAAM,CAACujB,QAAQ,GAAGxZ,qBAAK,CAACvE,IAAI,CAAC4E,IAAI,CAAC+Y,IAAI,CAACI,QAAQ,CAAC;;KAGjD,IAAItjB,cAAI,CAACoK,QAAQ,CAAC8Y,IAAI,CAACjkB,KAAK,CAAC,EAC7B;OACCc,MAAM,CAACd,KAAK,GAAGikB,IAAI,CAACjkB,KAAK;;KAG1B,IAAIe,cAAI,CAACoK,QAAQ,CAAC8Y,IAAI,CAACnX,KAAK,CAAC,EAC7B;OACChM,MAAM,CAACgM,KAAK,GAAGmX,IAAI,CAACnX,KAAK;;KAG1B,IAAI/L,cAAI,CAACoK,QAAQ,CAAC8Y,IAAI,CAACrB,MAAM,CAAC,EAC9B;OACC9hB,MAAM,CAAC8hB,MAAM,GAAGqB,IAAI,CAACrB,MAAM;;KAG5B,OAAO9hB,MAAM;;CAEf;;CCxMO,MAAM2jB,aAAa,SAASxlB,yBAAY,CAC/C;GACCC,QAAQ,GACR;KACC,OAAO;OACNmE,UAAU,EAAE;MACZ;;GAGFuB,eAAe,GACf;KACC,OAAO;OACNwB,EAAE,EAAE,CAAC;OACLtC,SAAS,EAAE,CAAC;OACZP,MAAM,EAAE,CAAC;OACT8C,QAAQ,EAAE,CAAC;OACXC,IAAI,EAAE,IAAIC,IAAI,EAAE;OAChBme,OAAO,EAAE;SACRte,EAAE,EAAE,CAAC;SACLkM,KAAK,EAAE,EAAE;SACTqS,QAAQ,EAAE,IAAIpe,IAAI,EAAE;SACpBqe,MAAM,EAAE,IAAIre,IAAI,EAAE;SAClBqc,MAAM,EAAE;;MAET;;GAGF9iB,UAAU,GACV;KACC,OAAO;OACNC,GAAG,EAAGC,KAAK,IAAMuD,MAAc,IAAkC;SAChE,IAAI,CAACvD,KAAK,CAACqD,UAAU,CAACE,MAAM,CAAC,EAC7B;WACC,OAAO,EAAE;;SAGV,OAAO,CAAC,GAAGvD,KAAK,CAACqD,UAAU,CAACE,MAAM,CAAC,CAACoI,MAAM,EAAE,CAAC,CAAC/D,IAAI,CAAC,CAACC,CAAC,EAAEC,CAAC,KAAKA,CAAC,CAAC1B,EAAE,GAAGyB,CAAC,CAACzB,EAAE,CAAC;QACzE;OACDuc,OAAO,EAAG3iB,KAAK,IAAMuD,MAAc,IAAa;SAC/C,IAAI,CAACvD,KAAK,CAACqD,UAAU,CAACE,MAAM,CAAC,EAC7B;WACC,OAAO,CAAC;;SAGT,OAAOvD,KAAK,CAACqD,UAAU,CAACE,MAAM,CAAC,CAAC+V,IAAI;;MAErC;;GAGFpZ,UAAU,GACV;KACC,OAAO;OACNC,GAAG,EAAE,CAACC,KAAK,EAAEC,OAAO,KAAK;SACxB,MAAM;WAACkD,MAAM;WAAEshB;UAAS,GAAGxkB,OAAO;SAClC,IAAI,CAACU,cAAI,CAAC+K,aAAa,CAAC+Y,QAAQ,CAAC,IAAI,CAAC9jB,cAAI,CAACK,QAAQ,CAACmC,MAAM,CAAC,EAC3D;WACC;;SAGD,IAAI,CAACnD,KAAK,CAACJ,KAAK,CAACqD,UAAU,CAACE,MAAM,CAAC,EACnC;WACCnD,KAAK,CAACJ,KAAK,CAACqD,UAAU,CAACE,MAAM,CAAC,GAAG,IAAIqc,GAAG,EAAE;;SAG3CiF,QAAQ,CAAClkB,OAAO,CAAC+jB,OAAO,IAAI;WAC3B,MAAMI,eAAe,GAAG;aAAC,GAAG,IAAI,CAAClgB,eAAe,EAAE;aAAE,GAAG,IAAI,CAACrE,QAAQ,CAACmkB,OAAO;YAAE;WAC9EtkB,KAAK,CAACE,MAAM,CAAC,KAAK,EAAE;aAACiD,MAAM;aAAEmhB,OAAO,EAAEI;YAAgB,CAAC;UACvD,CAAC;QACF;OACDzgB,MAAM,EAAE,CAACjE,KAAK,EAAEC,OAAO,KAAK;SAC3B,MAAM;WAACkD,MAAM;WAAE6C;UAAG,GAAG/F,OAAO;SAC5B,IAAI,CAACU,cAAI,CAACK,QAAQ,CAACmC,MAAM,CAAC,IAAI,CAACxC,cAAI,CAACK,QAAQ,CAACgF,EAAE,CAAC,EAChD;WACC;;SAGD,IAAI,CAAChG,KAAK,CAACJ,KAAK,CAACqD,UAAU,CAACE,MAAM,CAAC,EACnC;WACC;;SAGDnD,KAAK,CAACE,MAAM,CAAC,QAAQ,EAAE;WAAC8F,EAAE;WAAE7C;UAAO,CAAC;;MAErC;;GAGF/C,YAAY,GACZ;KACC,OAAO;OACN4D,GAAG,EAAE,CAACpE,KAAK,EAAEK,OAA6D,KAAK;SAC9E,MAAM;WAACkD,MAAM;WAAEmhB;UAAQ,GAAGrkB,OAAO;SACjCL,KAAK,CAACqD,UAAU,CAACE,MAAM,CAAC,CAACpD,GAAG,CAACukB,OAAO,CAACte,EAAE,EAAEse,OAAO,CAAC;QACjD;OACDrgB,MAAM,EAAE,CAACrE,KAAK,EAAEK,OAAqC,KAAK;SACzD,MAAM;WAAC+F,EAAE;WAAE7C;UAAO,GAAGlD,OAAO;SAC5BL,KAAK,CAACqD,UAAU,CAACE,MAAM,CAAC,CAACc,MAAM,CAAC+B,EAAE,CAAC;;MAEpC;;GAGF7F,QAAQ,CAACM,MAAc,EACvB;KACC,MAAMC,MAAM,GAAG;OACd4jB,OAAO,EAAE;MACT;KAED,IAAI3jB,cAAI,CAACK,QAAQ,CAACP,MAAM,CAACuF,EAAE,CAAC,EAC5B;OACCtF,MAAM,CAACsF,EAAE,GAAGvF,MAAM,CAACuF,EAAE;;KAGtB,IAAIrF,cAAI,CAACK,QAAQ,CAACP,MAAM,CAACiD,SAAS,CAAC,EACnC;OACChD,MAAM,CAACgD,SAAS,GAAGjD,MAAM,CAACiD,SAAS;;KAGpC,IAAI/C,cAAI,CAACK,QAAQ,CAACP,MAAM,CAAC0C,MAAM,CAAC,EAChC;OACCzC,MAAM,CAACyC,MAAM,GAAG1C,MAAM,CAAC0C,MAAM;;KAG9B,IAAIxC,cAAI,CAACK,QAAQ,CAACP,MAAM,CAACwF,QAAQ,CAAC,EAClC;OACCvF,MAAM,CAACuF,QAAQ,GAAGxF,MAAM,CAACwF,QAAQ;;KAGlC,IAAItF,cAAI,CAACoK,QAAQ,CAACtK,MAAM,CAACmN,UAAU,CAAC,EACpC;OACClN,MAAM,CAACwF,IAAI,GAAGuE,qBAAK,CAACvE,IAAI,CAAC4E,IAAI,CAACrK,MAAM,CAACmN,UAAU,CAAC;;KAGjD,IAAIjN,cAAI,CAAC8I,aAAa,CAAChJ,MAAM,CAACkkB,QAAQ,CAAC,EACvC;OACCjkB,MAAM,CAAC4jB,OAAO,GAAG,IAAI,CAACM,eAAe,CAACnkB,MAAM,CAACkkB,QAAQ,CAAC;;KAGvD,OAAOjkB,MAAM;;GAGdkkB,eAAe,CAACN,OAAO,EACvB;KACC,MAAM5jB,MAAM,GAAG,EAAE;KAEjB,IAAIC,cAAI,CAACK,QAAQ,CAACsjB,OAAO,CAACte,EAAE,CAAC,EAC7B;OACCtF,MAAM,CAACsF,EAAE,GAAGse,OAAO,CAACte,EAAE;;KAGvB,IAAIrF,cAAI,CAACoK,QAAQ,CAACuZ,OAAO,CAACpS,KAAK,CAAC,EAChC;OACCxR,MAAM,CAACwR,KAAK,GAAGoS,OAAO,CAACpS,KAAK;;KAG7B,IAAIvR,cAAI,CAACoK,QAAQ,CAACuZ,OAAO,CAACC,QAAQ,CAAC,EACnC;OACC7jB,MAAM,CAAC6jB,QAAQ,GAAG9Z,qBAAK,CAACvE,IAAI,CAAC4E,IAAI,CAACwZ,OAAO,CAACC,QAAQ,CAAC;;KAGpD,IAAI5jB,cAAI,CAACoK,QAAQ,CAACuZ,OAAO,CAACE,MAAM,CAAC,EACjC;OACC9jB,MAAM,CAAC8jB,MAAM,GAAG/Z,qBAAK,CAACvE,IAAI,CAAC4E,IAAI,CAACwZ,OAAO,CAACE,MAAM,CAAC;;KAGhD,IAAI7jB,cAAI,CAACoK,QAAQ,CAACuZ,OAAO,CAAC9B,MAAM,CAAC,EACjC;OACC9hB,MAAM,CAAC8hB,MAAM,GAAG8B,OAAO,CAAC9B,MAAM;;KAG/B,OAAO9hB,MAAM;;CAEf;;CCrKO,MAAMqY,YAAU,SAASla,yBAAY,CAC5C;GACCC,QAAQ,GACR;KACC,OAAO;OACNmE,UAAU,EAAE;MACZ;;GAGFuB,eAAe,GACf;KACC,OAAO;OACNwB,EAAE,EAAE,CAAC;OACLtC,SAAS,EAAE,CAAC;OACZP,MAAM,EAAE,CAAC;OACT8C,QAAQ,EAAE,CAAC;OACXC,IAAI,EAAE,IAAIC,IAAI,EAAE;OAChBuC,MAAM,EAAE;MACR;;GAGFhJ,UAAU,GACV;KACC,OAAO;OACNC,GAAG,EAAGC,KAAK,IAAK,CAACuD,MAAc,EAAE0hB,OAAe,KAA+B;SAC9E,IAAI,CAACjlB,KAAK,CAACqD,UAAU,CAACE,MAAM,CAAC,IAAI,CAACvD,KAAK,CAACqD,UAAU,CAACE,MAAM,CAAC,CAAC0hB,OAAO,CAAC,EACnE;WACC,OAAO,EAAE;;SAGV,OAAO,CAAC,GAAGjlB,KAAK,CAACqD,UAAU,CAACE,MAAM,CAAC,CAAC0hB,OAAO,CAAC,CAACtZ,MAAM,EAAE,CAAC,CAAC/D,IAAI,CAAC,CAACC,CAAC,EAAEC,CAAC,KAAKA,CAAC,CAAC1B,EAAE,GAAGyB,CAAC,CAACzB,EAAE,CAAC;QAClF;OAED8e,SAAS,EAAE,CAACllB,KAAK,EAAE4D,OAAO,EAAEuhB,SAAS,EAAEC,WAAW,KAAM7hB,MAAc,IAA+B;SACpG,IAAI,CAACvD,KAAK,CAACqD,UAAU,CAACE,MAAM,CAAC,EAC7B;WACC,OAAO,EAAE;;SAGV,IAAI8hB,KAAK,GAAG,EAAE;SACd,IAAIC,KAAK,GAAG,EAAE;SACd,IAAIC,SAAS,GAAG,EAAE;SAClB,IAAIC,KAAK,GAAG,EAAE;SAEd,IAAIxlB,KAAK,CAACqD,UAAU,CAACE,MAAM,CAAC,CAACkiB,4BAAgB,CAACJ,KAAK,CAAC,EACpD;WACCA,KAAK,GAAG,CAAC,GAAGrlB,KAAK,CAACqD,UAAU,CAACE,MAAM,CAAC,CAACkiB,4BAAgB,CAACJ,KAAK,CAAC,CAAC1Z,MAAM,EAAE,CAAC;;SAEvE,IAAI3L,KAAK,CAACqD,UAAU,CAACE,MAAM,CAAC,CAACkiB,4BAAgB,CAACH,KAAK,CAAC,EACpD;WACCA,KAAK,GAAG,CAAC,GAAGtlB,KAAK,CAACqD,UAAU,CAACE,MAAM,CAAC,CAACkiB,4BAAgB,CAACH,KAAK,CAAC,CAAC3Z,MAAM,EAAE,CAAC;;SAEvE,IAAI3L,KAAK,CAACqD,UAAU,CAACE,MAAM,CAAC,CAACkiB,4BAAgB,CAACC,QAAQ,CAAC,EACvD;WACCH,SAAS,GAAG,CAAC,GAAGvlB,KAAK,CAACqD,UAAU,CAACE,MAAM,CAAC,CAACkiB,4BAAgB,CAACC,QAAQ,CAAC,CAAC/Z,MAAM,EAAE,CAAC;;SAE9E,IAAI3L,KAAK,CAACqD,UAAU,CAACE,MAAM,CAAC,CAACkiB,4BAAgB,CAACD,KAAK,CAAC,EACpD;WACCA,KAAK,GAAG,CAAC,GAAGxlB,KAAK,CAACqD,UAAU,CAACE,MAAM,CAAC,CAACkiB,4BAAgB,CAACD,KAAK,CAAC,CAAC7Z,MAAM,EAAE,CAAC;;SAGvE,MAAMga,oBAAoB,GAAG,CAACN,KAAK,EAAEC,KAAK,EAAEC,SAAS,EAAEC,KAAK,CAAC,CAC3DI,IAAI,EAAE,CACNhe,IAAI,CAAC,CAACC,CAAC,EAAEC,CAAC,KAAKA,CAAC,CAAC1B,EAAE,GAAGyB,CAAC,CAACzB,EAAE,CAAC;SAG7B,OAAO,IAAI,CAACyf,yBAAyB,CAACF,oBAAoB,EAAEP,WAAW,CAAC;QACxE;OACDU,iBAAiB,EAAE,CAAC9lB,KAAK,EAAE4D,OAAO,EAAEuhB,SAAS,EAAEC,WAAW,KAAM7hB,MAAc,IAA+B;SAC5G,IAAI,CAACvD,KAAK,CAACqD,UAAU,CAACE,MAAM,CAAC,EAC7B;WACC,OAAO,EAAE;;SAGV,IAAIwiB,QAAQ,GAAG,EAAE;SAEjB,IAAI/lB,KAAK,CAACqD,UAAU,CAACE,MAAM,CAAC,CAACkiB,4BAAgB,CAACO,YAAY,CAAC,EAC3D;WACCD,QAAQ,GAAG,CAAC,GAAG/lB,KAAK,CAACqD,UAAU,CAACE,MAAM,CAAC,CAACkiB,4BAAgB,CAACO,YAAY,CAAC,CAACra,MAAM,EAAE,CAAC;;SAGjF,MAAMsa,gBAAgB,GAAGF,QAAQ,CAACne,IAAI,CAAC,CAACC,CAAC,EAAEC,CAAC,KAAKA,CAAC,CAAC1B,EAAE,GAAGyB,CAAC,CAACzB,EAAE,CAAC;SAE7D,OAAO,IAAI,CAACyf,yBAAyB,CAACI,gBAAgB,EAAEb,WAAW,CAAC;QACpE;OACDzC,OAAO,EAAG3iB,KAAK,IAAK,CAACuD,MAAc,EAAE0hB,OAAe,KAAa;SAChE,IAAI,CAACjlB,KAAK,CAACqD,UAAU,CAACE,MAAM,CAAC,IAAI,CAACvD,KAAK,CAACqD,UAAU,CAACE,MAAM,CAAC,CAAC0hB,OAAO,CAAC,EACnE;WACC,OAAO,CAAC;;SAGT,OAAOjlB,KAAK,CAACqD,UAAU,CAACE,MAAM,CAAC,CAAC0hB,OAAO,CAAC,CAAC3L,IAAI;;MAE9C;;GAGFpZ,UAAU,GACV;KACC,OAAO;OACNC,GAAG,EAAE,CAACC,KAAK,EAAEC,OAAO,KAAK;SACxB,MAAM;WAACkD,MAAM;WAAEmD;UAAM,GAAGrG,OAAO;SAC/B,IAAI,CAACU,cAAI,CAAC+K,aAAa,CAACpF,KAAK,CAAC,IAAI,CAAC3F,cAAI,CAACK,QAAQ,CAACmC,MAAM,CAAC,EACxD;WACC;;SAGD,IAAI,CAACnD,KAAK,CAACJ,KAAK,CAACqD,UAAU,CAACE,MAAM,CAAC,EACnC;WACCnD,KAAK,CAACJ,KAAK,CAACqD,UAAU,CAACE,MAAM,CAAC,GAAG,EAAE;;SAGpCmD,KAAK,CAAC/F,OAAO,CAACuZ,IAAI,IAAI;WACrB,MAAMD,YAAY,GAAG;aAAC,GAAG,IAAI,CAACrV,eAAe,EAAE;aAAE,GAAG,IAAI,CAACrE,QAAQ,CAAC2Z,IAAI;YAAE;WACxE,MAAM;aAAC+K;YAAQ,GAAG/K,IAAI;WACtB9Z,KAAK,CAACE,MAAM,CAAC,KAAK,EAAE;aAACiD,MAAM;aAAE0hB,OAAO;aAAE/K,IAAI,EAAED;YAAa,CAAC;UAC1D,CAAC;QACF;OACD5V,MAAM,EAAE,CAACjE,KAAK,EAAEC,OAAO,KAAK;SAC3B,MAAM;WAACkD,MAAM;WAAE6C;UAAG,GAAG/F,OAAO;SAC5B,IAAI,CAACU,cAAI,CAACK,QAAQ,CAACgF,EAAE,CAAC,IAAI,CAACrF,cAAI,CAACK,QAAQ,CAACmC,MAAM,CAAC,EAChD;WACC;;SAGD,IAAI,CAACnD,KAAK,CAACJ,KAAK,CAACqD,UAAU,CAACE,MAAM,CAAC,EACnC;WACC;;SAGDnD,KAAK,CAACE,MAAM,CAAC,QAAQ,EAAE;WAACiD,MAAM;WAAE6C;UAAG,CAAC;;MAErC;;GAGF5F,YAAY,GACZ;KACC,OAAO;OACN4D,GAAG,EAAE,CAACpE,KAAK,EAAEK,OAAwE,KAAK;SACzF,MAAM;WAACkD,MAAM;WAAE2W,IAAI;WAAE+K;UAAQ,GAAG5kB,OAAO;SACvC,IAAI,CAACL,KAAK,CAACqD,UAAU,CAACE,MAAM,CAAC,CAAC0hB,OAAO,CAAC,EACtC;WACCjlB,KAAK,CAACqD,UAAU,CAACE,MAAM,CAAC,CAAC0hB,OAAO,CAAC,GAAG,IAAIrF,GAAG,EAAE;;SAE9C5f,KAAK,CAACqD,UAAU,CAACE,MAAM,CAAC,CAAC0hB,OAAO,CAAC,CAAC9kB,GAAG,CAAC+Z,IAAI,CAAC9T,EAAE,EAAE8T,IAAI,CAAC;QACpD;OACD7V,MAAM,EAAE,CAACrE,KAAK,EAAEK,OAAqC,KAAK;SACzD,MAAM;WAACkD,MAAM;WAAE6C;UAAG,GAAG/F,OAAO;SAE5BI,MAAM,CAACkL,MAAM,CAAC8Z,4BAAgB,CAAC,CAAC9kB,OAAO,CAACskB,OAAO,IAAI;WAClD,IAAIjlB,KAAK,CAACqD,UAAU,CAACE,MAAM,CAAC,CAAC0hB,OAAO,CAAC,IAAIjlB,KAAK,CAACqD,UAAU,CAACE,MAAM,CAAC,CAAC0hB,OAAO,CAAC,CAAClhB,GAAG,CAACqC,EAAE,CAAC,EAClF;aACCpG,KAAK,CAACqD,UAAU,CAACE,MAAM,CAAC,CAAC0hB,OAAO,CAAC,CAAC5gB,MAAM,CAAC+B,EAAE,CAAC;;UAE7C,CAAC;;MAEH;;GAGF7F,QAAQ,CAACM,MAAc,EACvB;KACC,MAAMC,MAAM,GAAG,EAAE;KAEjB,IAAIC,cAAI,CAACK,QAAQ,CAACP,MAAM,CAACuF,EAAE,CAAC,EAC5B;OACCtF,MAAM,CAACsF,EAAE,GAAGvF,MAAM,CAACuF,EAAE;;KAGtB,IAAIrF,cAAI,CAACK,QAAQ,CAACP,MAAM,CAACiD,SAAS,CAAC,EACnC;OACChD,MAAM,CAACgD,SAAS,GAAGjD,MAAM,CAACiD,SAAS;;KAGpC,IAAI/C,cAAI,CAACK,QAAQ,CAACP,MAAM,CAAC0C,MAAM,CAAC,EAChC;OACCzC,MAAM,CAACyC,MAAM,GAAG1C,MAAM,CAAC0C,MAAM;;KAG9B,IAAIxC,cAAI,CAACK,QAAQ,CAACP,MAAM,CAACwF,QAAQ,CAAC,EAClC;OACCvF,MAAM,CAACuF,QAAQ,GAAGxF,MAAM,CAACwF,QAAQ;;KAGlC,IAAItF,cAAI,CAACoK,QAAQ,CAACtK,MAAM,CAACmN,UAAU,CAAC,EACpC;OACClN,MAAM,CAACwF,IAAI,GAAGuE,qBAAK,CAACvE,IAAI,CAAC4E,IAAI,CAACrK,MAAM,CAACmN,UAAU,CAAC;MAChD,MACI,IAAIjN,cAAI,CAACoK,QAAQ,CAACtK,MAAM,CAACyF,IAAI,CAAC,EACnC;OACCxF,MAAM,CAACwF,IAAI,GAAGuE,qBAAK,CAACvE,IAAI,CAAC4E,IAAI,CAACrK,MAAM,CAACyF,IAAI,CAAC;;KAG3CxF,MAAM,CAACgI,MAAM,GAAG/H,cAAI,CAACK,QAAQ,CAACP,MAAM,CAACiI,MAAM,CAAC,GAAGjI,MAAM,CAACiI,MAAM,GAAGhI,MAAM,CAACsF,EAAE;KAExE,OAAOtF,MAAM;;GAGd+kB,yBAAyB,CAACxiB,UAAoC,EAAE+hB,WAAW,EAC3E;KACC,OAAO/hB,UAAU,CAACuF,MAAM,CAAEsd,WAAmC,IAAK;OACjE,MAAMhM,IAAI,GAAGkL,WAAW,CAAC,WAAW,CAAC,CAACc,WAAW,CAACpd,MAAM,EAAE,IAAI,CAAC;OAE/D,OAAOoR,IAAI,CAACR,QAAQ,KAAK,GAAG;MAC5B,CAAC,CAACyM,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC;;CAEhB;;CCnNO,MAAMC,YAAY,SAASnnB,yBAAY,CAC9C;GACCqC,OAAO,GACP;KACC,OAAO,SAAS;;GAGjBC,gBAAgB,GAChB;KACC,OAAO;OACN8kB,OAAO,EAAEtC,YAAY;OACrBhB,KAAK,EAAEN,UAAU;OACjBe,SAAS,EAAEL,cAAc;OACzBmB,KAAK,EAAEN,UAAU;OACjBa,QAAQ,EAAEJ,aAAa;OACvB/d,KAAK,EAAEyS;MACP;;GAGFja,QAAQ,GACR;KACC,OAAO;OACNonB,UAAU,EAAE,IAAI9hB,GAAG,EAAE;OACrB+hB,eAAe,EAAE,KAAK;OACtBC,eAAe,EAAE;MACjB;;GAGF1mB,UAAU,GACV;KACC,OAAO;OACN2mB,QAAQ,EAAGzmB,KAAK,IAAMuD,MAAc,IACpC;SACC,OAAOvD,KAAK,CAACsmB,UAAU,CAACviB,GAAG,CAACR,MAAM,CAAC;;MAEpC;;GAGFrD,UAAU,GACV;KACC,OAAO;OACNwmB,SAAS,EAAE,CAACtmB,KAAK,EAAEmD,MAAM,KACzB;SACC,IAAI,CAACxC,cAAI,CAACK,QAAQ,CAACmC,MAAM,CAAC,EAC1B;WACC;;SAGDnD,KAAK,CAACE,MAAM,CAAC,WAAW,EAAEiD,MAAM,CAAC;QACjC;OACDojB,gBAAgB,EAAE,CAACvmB,KAAK,EAAEQ,KAAc,KACxC;SACC,IAAI,CAACG,cAAI,CAACC,SAAS,CAACJ,KAAK,CAAC,EAC1B;WACC;;SAGDR,KAAK,CAACE,MAAM,CAAC,kBAAkB,EAAEM,KAAK,CAAC;QACvC;OACDgmB,gBAAgB,EAAE,CAACxmB,KAAK,EAAEQ,KAAc,KACxC;SACC,IAAI,CAACG,cAAI,CAACC,SAAS,CAACJ,KAAK,CAAC,EAC1B;WACC;;SAGDR,KAAK,CAACE,MAAM,CAAC,kBAAkB,EAAEM,KAAK,CAAC;;MAExC;;GAGFJ,YAAY,GACZ;KACC,OAAO;OACNkmB,SAAS,EAAE,CAAC1mB,KAAK,EAAEK,OAAO,KAC1B;SACCL,KAAK,CAACsmB,UAAU,CAACliB,GAAG,CAAC/D,OAAO,CAAC;QAC7B;OACDsmB,gBAAgB,EAAE,CAAC3mB,KAAK,EAAEK,OAAgB,KAC1C;SACCL,KAAK,CAACumB,eAAe,GAAGlmB,OAAO;QAC/B;OACDumB,gBAAgB,EAAE,CAAC5mB,KAAK,EAAEK,OAAgB,KAC1C;SACCL,KAAK,CAACwmB,eAAe,GAAGnmB,OAAO;;MAEhC;;CAEH;;CC9F0C;CAAA;CAAA;AAI1C,CAAO,MAAMwmB,WAAW,SAAS5nB,yBAAY,CAC7C;GAAA;KAAA;KAAA;OAAA;;KAAA;OAAA;;KAAA;OAAA;;;GACCqC,OAAO,GACP;KACC,OAAO,QAAQ;;GAGhBpC,QAAQ,GACR;KACC,OAAO;OACNmE,UAAU,EAAE,IAAIuc,GAAG,EAAE;OACrBkH,mBAAmB,EAAE;SACpB,CAACC,yBAAa,CAACC,WAAW,GAAG,IAAIxiB,GAAG,EAAE;SACtC,CAACuiB,yBAAa,CAACE,UAAU,GAAG,IAAIziB,GAAG,EAAE;SACrC,CAACuiB,yBAAa,CAACG,QAAQ,GAAG,IAAI1iB,GAAG,EAAE;SACnC,CAACuiB,yBAAa,CAACI,OAAO,GAAG,IAAI3iB,GAAG,EAAE;SAClC,CAACuiB,yBAAa,CAACK,cAAc,GAAG,IAAI5iB,GAAG;;MAExC;;GAGFI,eAAe,GACf;KACC,OAAO;OACNwB,EAAE,EAAE,CAAC;OACLkM,KAAK,EAAE,EAAE;OACTwB,OAAO,EAAE;SACRuT,IAAI,EAAE,EAAE;SACRra,QAAQ,EAAE,EAAE;SACZsa,OAAO,EAAE,IAAI;SACbjN,KAAK,EAAE,IAAI;SACXC,MAAM,EAAE,IAAI;SACZxN,KAAK,EAAE,IAAI;SACXya,QAAQ,EAAE;QACV;OACDC,SAAS,EAAE,EAAE;OACbC,KAAK,EAAE,CAAC;OACRC,iBAAiB,EAAE;SAClBC,EAAE,EAAE,CAAC;SACLC,SAAS,EAAE,EAAE;SACbC,YAAY,EAAE;;MAEf;;GAGF/nB,UAAU,GACV;KACC,OAAO;OACNgoB,cAAc,EAAG9nB,KAAK,IAAMwnB,SAAiB,IAC7C;SACC,MAAMO,MAAM,GAAG,CAAC,GAAG/nB,KAAK,CAAC8mB,mBAAmB,CAACU,SAAS,CAAC,CAAC7b,MAAM,EAAE,CAAC;SAEjE,OAAOoc,MAAM,CAACvkB,GAAG,CAAC4C,EAAE,IAAI;WACvB,OAAOpG,KAAK,CAACqD,UAAU,CAACtD,GAAG,CAACqG,EAAE,CAAC;UAC/B,CAAC;QACF;OACD2B,OAAO,EAAG/H,KAAK,IAAMoG,EAAU,IAC/B;SACC,OAAOpG,KAAK,CAACqD,UAAU,CAACtD,GAAG,CAACqG,EAAE,CAAC;;MAEhC;;GAGFlG,UAAU,GACV;KACC,OAAO;OACNC,GAAG,EAAE,CAACC,KAAK,EAAEC,OAAO,KACpB;SACC,MAAM;WAAC2nB;UAAM,GAAG3nB,OAAO;SAEvB2nB,KAAK,CAACrnB,OAAO,CAAE2E,IAAuB,IAAK;WAC1ClF,KAAK,CAACE,MAAM,CAAC,wBAAwB,EAAE;aAACknB,SAAS,EAAEliB,IAAI,CAACkiB,SAAS;aAAEphB,EAAE,EAAEd,IAAI,CAACc;YAAG,CAAC;WAChFhG,KAAK,CAACE,MAAM,CAAC,eAAe,EAAEgF,IAAI,CAAC;UACnC,CAAC;;MAEH;;GAGF9E,YAAY,GACZ;KACC,OAAO;OACNynB,sBAAsB,EAAE,CAACjoB,KAAK,EAAEK,OAA0B,KAC1D;SACCL,KAAK,CAAC8mB,mBAAmB,CAACzmB,OAAO,CAACmnB,SAAS,CAAC,CAACpjB,GAAG,CAAC/D,OAAO,CAAC+F,EAAE,CAAC;QAC5D;OACD8hB,aAAa,EAAE,CAACloB,KAAK,EAAEK,OAA0B,KACjD;SACCL,KAAK,CAACqD,UAAU,CAAClD,GAAG,CAACE,OAAO,CAAC+F,EAAE,EAAE;WAAC,GAAG,IAAI,CAACxB,eAAe,EAAE;WAAE,2CAAG,IAAI,wBAAWvE,OAAO;UAAE,CAAC;;MAE1F;;CA0GH;CAAC,oBAvGU8nB,GAAW,EACrB;GACC,MAAMrnB,MAAM,GAAG,EAAE;GAEjB,IAAIC,cAAI,CAACK,QAAQ,CAAC+mB,GAAG,CAAC/hB,EAAE,CAAC,IAAIrF,cAAI,CAACE,cAAc,CAACknB,GAAG,CAAC/hB,EAAE,CAAC,EACxD;KACCtF,MAAM,CAACsF,EAAE,GAAG+hB,GAAG,CAAC/hB,EAAE,CAAClE,QAAQ,EAAE;;GAG9B,IAAInB,cAAI,CAACoK,QAAQ,CAACgd,GAAG,CAAC7V,KAAK,CAAC,EAC5B;KACCxR,MAAM,CAACwR,KAAK,GAAG6V,GAAG,CAAC7V,KAAK;;GAGzBxR,MAAM,CAACgT,OAAO,2CAAG,IAAI,sCAAkBqU,GAAG,CAACrU,OAAO,CAAC;GAEnD,IAAI/S,cAAI,CAACoK,QAAQ,CAACgd,GAAG,CAACX,SAAS,CAAC,EAChC;KACC1mB,MAAM,CAAC0mB,SAAS,GAAGW,GAAG,CAACX,SAAS;;GAGjC,IAAIzmB,cAAI,CAACK,QAAQ,CAAC+mB,GAAG,CAACV,KAAK,CAAC,EAC5B;KACC3mB,MAAM,CAAC2mB,KAAK,GAAGU,GAAG,CAACV,KAAK;;GAGzB3mB,MAAM,CAAC4mB,iBAAiB,2CAAG,IAAI,0DAA4BS,GAAG,CAACT,iBAAiB,CAAC;GAEjF,OAAO5mB,MAAM;CACd;CAAC,2BAEgBgT,OAAe,EAChC;GACC,MAAMhT,MAAM,GAAG;KACdwmB,OAAO,EAAE,IAAI;KACbjN,KAAK,EAAE,IAAI;KACXC,MAAM,EAAE,IAAI;KACZxN,KAAK,EAAE,IAAI;KACXya,QAAQ,EAAE;IACV;GAED,IAAI,CAACxmB,cAAI,CAAC8I,aAAa,CAACiK,OAAO,CAAC,EAChC;KACC,OAAOhT,MAAM;;GAGd,IAAIC,cAAI,CAAC+K,aAAa,CAACgI,OAAO,CAACwT,OAAO,CAAC,EACvC;KACCxmB,MAAM,CAACwmB,OAAO,GAAGxT,OAAO,CAACwT,OAAO;;GAEjC,IAAIvmB,cAAI,CAACK,QAAQ,CAAC0S,OAAO,CAACuG,KAAK,CAAC,EAChC;KACCvZ,MAAM,CAACuZ,KAAK,GAAGvG,OAAO,CAACuG,KAAK;;GAG7B,IAAItZ,cAAI,CAACK,QAAQ,CAAC0S,OAAO,CAACwG,MAAM,CAAC,EACjC;KACCxZ,MAAM,CAACwZ,MAAM,GAAGxG,OAAO,CAACwG,MAAM;;GAG/B,IAAIvZ,cAAI,CAACE,cAAc,CAAC6S,OAAO,CAAChH,KAAK,CAAC,EACtC;KACChM,MAAM,CAACgM,KAAK,GAAGgH,OAAO,CAAChH,KAAK;;GAG7B,IAAI/L,cAAI,CAACE,cAAc,CAAC6S,OAAO,CAACyT,QAAQ,CAAC,EACzC;KACCzmB,MAAM,CAACymB,QAAQ,GAAGzT,OAAO,CAACyT,QAAQ;;GAGnC,OAAOzmB,MAAM;CACd;CAAC,qCAE0BsnB,aAAqB,EAChD;GACC,MAAMtnB,MAAM,GAAG;KACd6mB,EAAE,EAAE,CAAC;KACLC,SAAS,EAAE,EAAE;KACbC,YAAY,EAAE;IACd;GAED,IAAI,CAAC9mB,cAAI,CAAC8I,aAAa,CAACue,aAAa,CAAC,EACtC;KACC,OAAOtnB,MAAM;;GAGd,IAAIC,cAAI,CAACK,QAAQ,CAACgnB,aAAa,CAACT,EAAE,CAAC,EACnC;KACC7mB,MAAM,CAAC6mB,EAAE,GAAGS,aAAa,CAACT,EAAE;;GAG7B,IAAI5mB,cAAI,CAACE,cAAc,CAACmnB,aAAa,CAACR,SAAS,CAAC,EAChD;KACC9mB,MAAM,CAAC8mB,SAAS,GAAGQ,aAAa,CAACR,SAAS;;GAG3C,IAAI7mB,cAAI,CAACK,QAAQ,CAACgnB,aAAa,CAACP,YAAY,CAAC,EAC7C;KACC/mB,MAAM,CAAC+mB,YAAY,GAAGO,aAAa,CAACP,YAAY;;GAGjD,OAAO/mB,MAAM;CACd;;;;;;;;;;;;;;;;"}