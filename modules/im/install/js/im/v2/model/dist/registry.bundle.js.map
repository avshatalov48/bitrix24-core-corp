{"version":3,"file":"registry.bundle.js","sources":["../src/application.js","../src/messages.js","../src/dialogues.js","../src/users.js","../src/files.js","../src/recent.js"],"sourcesContent":["import {DeviceType, DeviceOrientation, Settings} from 'im.v2.const';\nimport {BuilderModel} from 'ui.vue3.vuex';\nimport {Type} from 'main.core';\n\nexport class ApplicationModel extends BuilderModel\n{\n\tgetName()\n\t{\n\t\treturn 'application';\n\t}\n\n\tgetState()\n\t{\n\t\treturn {\n\t\t\tcommon:\n\t\t\t{\n\t\t\t\thost: this.getVariable('common.host', location.protocol+'//'+location.host),\n\t\t\t\tsiteId: this.getVariable('common.siteId', 'default'),\n\t\t\t\tuserId: this.getVariable('common.userId', 0),\n\t\t\t\tlanguageId: this.getVariable('common.languageId', 'en'),\n\t\t\t},\n\t\t\tdialog:\n\t\t\t{\n\t\t\t\tdialogId: this.getVariable('dialog.dialogId', '0'),\n\t\t\t\tchatId: this.getVariable('dialog.chatId', 0),\n\t\t\t\tdiskFolderId: this.getVariable('dialog.diskFolderId', 0),\n\t\t\t\tmessageLimit: this.getVariable('dialog.messageLimit', 20),\n\t\t\t\tenableReadMessages: this.getVariable('dialog.enableReadMessages', true),\n\t\t\t\tmessageExtraCount: 0,\n\t\t\t},\n\t\t\tdisk:\n\t\t\t{\n\t\t\t\tenabled: false,\n\t\t\t\tmaxFileSize: 5242880,\n\t\t\t},\n\t\t\tcall:\n\t\t\t{\n\t\t\t\tserverEnabled: false,\n\t\t\t\tmaxParticipants: 24,\n\t\t\t},\n\t\t\tmobile:\n\t\t\t{\n\t\t\t\tkeyboardShow: false,\n\t\t\t},\n\t\t\tdevice:\n\t\t\t{\n\t\t\t\ttype: this.getVariable('device.type', DeviceType.desktop),\n\t\t\t\torientation: this.getVariable('device.orientation', DeviceOrientation.portrait),\n\t\t\t},\n\t\t\toptions:\n\t\t\t{\n\t\t\t\tquoteEnable: this.getVariable('options.quoteEnable', true),\n\t\t\t\tquoteFromRight: this.getVariable('options.quoteFromRight', true),\n\t\t\t\tautoplayVideo: this.getVariable('options.autoplayVideo', true),\n\t\t\t\tdarkTheme: this.getVariable('options.darkTheme', false),\n\t\t\t\tshowSmiles: false\n\t\t\t},\n\t\t\terror:\n\t\t\t{\n\t\t\t\tactive: false,\n\t\t\t\tcode: '',\n\t\t\t\tdescription: '',\n\t\t\t},\n\t\t};\n\t}\n\n\tgetStateSaveException()\n\t{\n\t\treturn Object.assign({\n\t\t\tcommon: this.getVariable('saveException.common', null),\n\t\t\tdialog: this.getVariable('saveException.dialog', null),\n\t\t\tmobile: this.getVariable('saveException.mobile', null),\n\t\t\tdevice: this.getVariable('saveException.device', null),\n\t\t\terror: this.getVariable('saveException.error', null)\n\t\t});\n\t}\n\n\tgetGetters()\n\t{\n\t\treturn {\n\t\t\tgetOption: state => (optionName: string) =>\n\t\t\t{\n\t\t\t\tif (!Settings[optionName])\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn state.options[optionName];\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions()\n\t{\n\t\treturn {\n\t\t\tset: (store, payload) =>\n\t\t\t{\n\t\t\t\tstore.commit('set', this.validate(payload));\n\t\t\t},\n\t\t\tshowSmiles: (store, payload) =>\n\t\t\t{\n\t\t\t\tstore.commit('showSmiles')\n\t\t\t},\n\t\t\thideSmiles: (store, payload) =>\n\t\t\t{\n\t\t\t\tstore.commit('hideSmiles');\n\t\t\t},\n\t\t\tsetOptions: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (!Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tpayload = this.validateOptions(payload);\n\t\t\t\tObject.entries(payload).forEach(([option, value]) => {\n\t\t\t\t\tstore.commit('setOptions', {\n\t\t\t\t\t\toption,\n\t\t\t\t\t\tvalue\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\t}\n\n\tgetMutations()\n\t{\n\t\treturn {\n\t\t\tset: (state, payload) =>\n\t\t\t{\n\t\t\t\tlet hasChange = false;\n\t\t\t\tfor (let group in payload)\n\t\t\t\t{\n\t\t\t\t\tif (!payload.hasOwnProperty(group))\n\t\t\t\t\t{\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\tfor (let field in payload[group])\n\t\t\t\t\t{\n\t\t\t\t\t\tif (!payload[group].hasOwnProperty(field))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tstate[group][field] = payload[group][field];\n\t\t\t\t\t\thasChange = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (hasChange && this.isSaveNeeded(payload))\n\t\t\t\t{\n\t\t\t\t\tthis.saveState(state);\n\t\t\t\t}\n\t\t\t},\n\t\t\tincreaseDialogExtraCount(state, payload = {})\n\t\t\t{\n\t\t\t\tlet {count = 1} = payload;\n\n\t\t\t\tstate.dialog.messageExtraCount += count;\n\t\t\t},\n\t\t\tdecreaseDialogExtraCount(state, payload = {})\n\t\t\t{\n\t\t\t\tlet {count = 1} = payload;\n\n\t\t\t\tlet newCounter = state.dialog.messageExtraCount - count;\n\t\t\t\tif (newCounter <= 0)\n\t\t\t\t{\n\t\t\t\t\tnewCounter = 0;\n\t\t\t\t}\n\n\t\t\t\tstate.dialog.messageExtraCount = newCounter;\n\t\t\t},\n\t\t\tclearDialogExtraCount(state)\n\t\t\t{\n\t\t\t\tstate.dialog.messageExtraCount = 0;\n\t\t\t},\n\t\t\tshowSmiles(state)\n\t\t\t{\n\t\t\t\tstate.options.showSmiles = true;\n\t\t\t},\n\t\t\thideSmiles(state)\n\t\t\t{\n\t\t\t\tstate.options.showSmiles = false;\n\t\t\t},\n\t\t\tsetOptions: (state, payload) => {\n\t\t\t\tstate.options[payload.option] = payload.value;\n\t\t\t}\n\t\t};\n\t}\n\n\tvalidate(fields)\n\t{\n\t\tconst result = {};\n\n\t\tif (typeof fields.common === 'object' && fields.common)\n\t\t{\n\t\t\tresult.common = {};\n\n\t\t\tif (typeof fields.common.userId === 'number')\n\t\t\t{\n\t\t\t\tresult.common.userId = fields.common.userId;\n\t\t\t}\n\n\t\t\tif (typeof fields.common.languageId === 'string')\n\t\t\t{\n\t\t\t\tresult.common.languageId = fields.common.languageId;\n\t\t\t}\n\t\t}\n\n\t\tif (typeof fields.dialog === 'object' && fields.dialog)\n\t\t{\n\t\t\tresult.dialog = {};\n\n\t\t\tif (typeof fields.dialog.dialogId === 'number')\n\t\t\t{\n\t\t\t\tresult.dialog.dialogId = fields.dialog.dialogId.toString();\n\t\t\t\tresult.dialog.chatId = 0;\n\t\t\t}\n\t\t\telse if (typeof fields.dialog.dialogId === 'string')\n\t\t\t{\n\t\t\t\tresult.dialog.dialogId = fields.dialog.dialogId;\n\n\t\t\t\tif (typeof fields.dialog.chatId !== 'number')\n\t\t\t\t{\n\t\t\t\t\tlet chatId = fields.dialog.dialogId;\n\t\t\t\t\tif (chatId.startsWith('chat'))\n\t\t\t\t\t{\n\t\t\t\t\t\tchatId = fields.dialog.dialogId.substr(4);\n\t\t\t\t\t}\n\n\t\t\t\t\tchatId = parseInt(chatId);\n\n\t\t\t\t\tresult.dialog.chatId = !isNaN(chatId)? chatId: 0;\n\t\t\t\t\tfields.dialog.chatId = result.dialog.chatId;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (typeof fields.dialog.chatId === 'number')\n\t\t\t{\n\t\t\t\tresult.dialog.chatId = fields.dialog.chatId;\n\t\t\t}\n\n\t\t\tif (typeof fields.dialog.diskFolderId === 'number')\n\t\t\t{\n\t\t\t\tresult.dialog.diskFolderId = fields.dialog.diskFolderId;\n\t\t\t}\n\n\t\t\tif (typeof fields.dialog.messageLimit === 'number')\n\t\t\t{\n\t\t\t\tresult.dialog.messageLimit = fields.dialog.messageLimit;\n\t\t\t}\n\n\t\t\tif (typeof fields.dialog.messageExtraCount === 'number')\n\t\t\t{\n\t\t\t\tresult.dialog.messageExtraCount = fields.dialog.messageExtraCount;\n\t\t\t}\n\n\t\t\tif (typeof fields.dialog.enableReadMessages === 'boolean')\n\t\t\t{\n\t\t\t\tresult.dialog.enableReadMessages = fields.dialog.enableReadMessages;\n\t\t\t}\n\t\t}\n\n\t\tif (typeof fields.disk === 'object' && fields.disk)\n\t\t{\n\t\t\tresult.disk = {};\n\n\t\t\tif (typeof fields.disk.enabled === 'boolean')\n\t\t\t{\n\t\t\t\tresult.disk.enabled = fields.disk.enabled;\n\t\t\t}\n\n\t\t\tif (typeof fields.disk.maxFileSize === 'number')\n\t\t\t{\n\t\t\t\tresult.disk.maxFileSize = fields.disk.maxFileSize;\n\t\t\t}\n\t\t}\n\n\t\tif (typeof fields.call === 'object' && fields.call)\n\t\t{\n\t\t\tresult.call = {};\n\n\t\t\tif (typeof fields.call.serverEnabled === 'boolean')\n\t\t\t{\n\t\t\t\tresult.call.serverEnabled = fields.call.serverEnabled;\n\t\t\t}\n\n\t\t\tif (typeof fields.call.maxParticipants === 'number')\n\t\t\t{\n\t\t\t\tresult.call.maxParticipants = fields.call.maxParticipants;\n\t\t\t}\n\t\t}\n\n\t\tif (typeof fields.mobile === 'object' && fields.mobile)\n\t\t{\n\t\t\tresult.mobile = {};\n\n\t\t\tif (typeof fields.mobile.keyboardShow === 'boolean')\n\t\t\t{\n\t\t\t\tresult.mobile.keyboardShow = fields.mobile.keyboardShow;\n\t\t\t}\n\t\t}\n\n\t\tif (typeof fields.device === 'object' && fields.device)\n\t\t{\n\t\t\tresult.device = {};\n\n\t\t\tif (typeof fields.device.type === 'string' && typeof DeviceType[fields.device.type] !== 'undefined')\n\t\t\t{\n\t\t\t\tresult.device.type = fields.device.type;\n\t\t\t}\n\n\t\t\tif (typeof fields.device.orientation === 'string' && typeof DeviceOrientation[fields.device.orientation] !== 'undefined')\n\t\t\t{\n\t\t\t\tresult.device.orientation = fields.device.orientation;\n\t\t\t}\n\t\t}\n\n\t\tif (typeof fields.error === 'object' && fields.error)\n\t\t{\n\t\t\tif (typeof fields.error.active === 'boolean')\n\t\t\t{\n\t\t\t\tresult.error = {\n\t\t\t\t\tactive: fields.error.active,\n\t\t\t\t\tcode: fields.error.code.toString() || '',\n\t\t\t\t\tdescription: fields.error.description.toString() || '',\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tvalidateOptions(fields)\n\t{\n\t\tconst result = {};\n\n\t\tif (!Type.isUndefined(fields.darkTheme) && Type.isStringFilled(fields.darkTheme))\n\t\t{\n\t\t\tif (fields.darkTheme === 'auto' && BX.MessengerProxy)\n\t\t\t{\n\t\t\t\tresult.darkTheme = BX.MessengerProxy.isDarkTheme();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresult.darkTheme = fields.darkTheme === 'dark';\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t}\n}","import {nextTick} from 'ui.vue3';\nimport {BuilderModel} from 'ui.vue3.vuex';\nimport {MutationType, StorageLimit, EventType} from 'im.v2.const';\nimport {Utils} from 'im.v2.lib.utils';\nimport {Logger} from 'im.v2.lib.logger';\n\nimport {EventEmitter} from 'main.core.events';\n\nconst IntersectionType = {\n\tempty: 'empty',\n\tequal: 'equal',\n\tnone: 'none',\n\tfound: 'found',\n\tfoundReverse: 'foundReverse',\n};\n\nexport class MessagesModel extends BuilderModel\n{\n\tgetName()\n\t{\n\t\treturn 'messages';\n\t}\n\n\tgetState()\n\t{\n\t\treturn {\n\t\t\tcreated: 0,\n\t\t\tcollection: {},\n\t\t\tmutationType: {},\n\t\t\tsaveMessageList: {},\n\t\t\tsaveFileList: {},\n\t\t\tsaveUserList: {},\n\t\t};\n\t}\n\n\tgetElementState()\n\t{\n\t\treturn {\n\t\t\ttemplateId: 0,\n\t\t\ttemplateType: 'message',\n\t\t\tplaceholderType: 0,\n\n\t\t\tid: 0,\n\t\t\tchatId: 0,\n\t\t\tauthorId: 0,\n\t\t\tdate: new Date(),\n\t\t\ttext: '',\n\t\t\ttextConverted: '',\n\t\t\tparams: {\n\t\t\t\tTYPE: 'default',\n\t\t\t\tCOMPONENT_ID: 'bx-im-view-message',\n\t\t\t},\n\n\t\t\tpush: false,\n\t\t\tunread: false,\n\t\t\tsending: false,\n\t\t\terror: false,\n\t\t\tretry: false,\n\t\t\tblink: false,\n\t\t};\n\t}\n\n\tgetGetters()\n\t{\n\t\treturn {\n\n\t\t\tgetMutationType: state => chatId =>\n\t\t\t{\n\t\t\t\tif (!state.mutationType[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn {initialType: MutationType.none, appliedType: MutationType.none};\n\t\t\t\t}\n\n\t\t\t\treturn state.mutationType[chatId];\n\t\t\t},\n\t\t\tgetLastId: state => chatId =>\n\t\t\t{\n\t\t\t\tif (!state.collection[chatId] || state.collection[chatId].length <= 0)\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\tlet lastId = 0;\n\n\t\t\t\tfor (let i = 0; i < state.collection[chatId].length; i++)\n\t\t\t\t{\n\t\t\t\t\tlet element = state.collection[chatId][i];\n\t\t\t\t\tif (\n\t\t\t\t\t\telement.push\n\t\t\t\t\t\t|| element.sending\n\t\t\t\t\t\t|| element.id.toString().startsWith('temporary')\n\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (lastId < element.id)\n\t\t\t\t\t{\n\t\t\t\t\t\tlastId = element.id;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn lastId? lastId: null;\n\t\t\t},\n\t\t\tgetMessage: state => (chatId, messageId) =>\n\t\t\t{\n\t\t\t\tif (!state.collection[chatId] || state.collection[chatId].length <= 0)\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\tfor (let index = state.collection[chatId].length-1; index >= 0; index--)\n\t\t\t\t{\n\t\t\t\t\tif (state.collection[chatId][index].id === messageId)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn state.collection[chatId][index];\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn null;\n\t\t\t},\n\t\t\tget: state => chatId =>\n\t\t\t{\n\t\t\t\tif (!state.collection[chatId] || state.collection[chatId].length <= 0)\n\t\t\t\t{\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[chatId];\n\t\t\t},\n\t\t\tgetBlank: state => params =>\n\t\t\t{\n\t\t\t\treturn this.getElementState();\n\t\t\t},\n\t\t\tgetSaveFileList: state => params =>\n\t\t\t{\n\t\t\t\treturn state.saveFileList;\n\t\t\t},\n\t\t\tgetSaveUserList: state => params =>\n\t\t\t{\n\t\t\t\treturn state.saveUserList;\n\t\t\t},\n\t\t}\n\t}\n\n\tgetActions()\n\t{\n\t\treturn {\n\t\t\tadd: (store, payload) =>\n\t\t\t{\n\t\t\t\tlet result = this.validate(Object.assign({}, payload));\n\t\t\t\tresult.params = Object.assign({}, this.getElementState().params, result.params);\n\t\t\t\tif (payload.id)\n\t\t\t\t{\n\t\t\t\t\tif (store.state.collection[payload.chatId])\n\t\t\t\t\t{\n\t\t\t\t\t\tconst countMessages = store.state.collection[payload.chatId].length-1;\n\t\t\t\t\t\tfor (let index = countMessages; index >= 0; index--)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst message = store.state.collection[payload.chatId][index];\n\t\t\t\t\t\t\tif (message.templateId === payload.id)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tresult.id = payload.id;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tresult.id = 'temporary' + (new Date).getTime() + store.state.created;\n\t\t\t\t}\n\t\t\t\tresult.templateId = result.id;\n\t\t\t\tresult.unread = false;\n\n\t\t\t\tstore.commit('add', Object.assign({}, this.getElementState(), result));\n\n\t\t\t\tif (payload.sending !== false)\n\t\t\t\t{\n\t\t\t\t\tstore.dispatch('actionStart', {\n\t\t\t\t\t\tid: result.id,\n\t\t\t\t\t\tchatId: result.chatId,\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\treturn result.id;\n\t\t\t},\n\t\t\tactionStart: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (/^\\d+$/.test(payload.id))\n\t\t\t\t{\n\t\t\t\t\tpayload.id = parseInt(payload.id);\n\t\t\t\t}\n\n\t\t\t\tpayload.chatId = parseInt(payload.chatId);\n\n\t\t\t\tnextTick(() => {\n\t\t\t\t\tstore.commit('update', {\n\t\t\t\t\t\tid : payload.id ,\n\t\t\t\t\t\tchatId : payload.chatId,\n\t\t\t\t\t\tfields : {sending: true}\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t},\n\t\t\tactionError: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (/^\\d+$/.test(payload.id))\n\t\t\t\t{\n\t\t\t\t\tpayload.id = parseInt(payload.id);\n\t\t\t\t}\n\t\t\t\tpayload.chatId = parseInt(payload.chatId);\n\n\t\t\t\tnextTick(() => {\n\t\t\t\t\tstore.commit('update', {\n\t\t\t\t\t\tid : payload.id ,\n\t\t\t\t\t\tchatId : payload.chatId,\n\t\t\t\t\t\tfields : {sending: false, error: true, retry: payload.retry !== false}\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t},\n\t\t\tactionFinish: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (/^\\d+$/.test(payload.id))\n\t\t\t\t{\n\t\t\t\t\tpayload.id = parseInt(payload.id);\n\t\t\t\t}\n\t\t\t\tpayload.chatId = parseInt(payload.chatId);\n\n\t\t\t\tnextTick(() => {\n\t\t\t\t\tstore.commit('update', {\n\t\t\t\t\t\tid : payload.id ,\n\t\t\t\t\t\tchatId : payload.chatId,\n\t\t\t\t\t\tfields : {sending: false, error: false, retry: false}\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t},\n\t\t\tset: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (payload instanceof Array)\n\t\t\t\t{\n\t\t\t\t\tpayload = payload.map(message => this.prepareMessage(message));\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tlet result = this.prepareMessage(payload);\n\t\t\t\t\t(payload = []).push(result);\n\t\t\t\t}\n\n\t\t\t\tstore.commit('set', {\n\t\t\t\t\tinsertType : MutationType.set,\n\t\t\t\t\tdata : payload\n\t\t\t\t});\n\n\t\t\t\treturn 'set is done';\n\t\t\t},\n\t\t\taddPlaceholders: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (payload.placeholders instanceof Array)\n\t\t\t\t{\n\t\t\t\t\tpayload.placeholders = payload.placeholders.map(message => this.prepareMessage(message));\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst insertType = payload.requestMode === 'history'? MutationType.setBefore : MutationType.setAfter;\n\t\t\t\tif (insertType === MutationType.setBefore)\n\t\t\t\t{\n\t\t\t\t\tpayload.placeholders = payload.placeholders.reverse();\n\t\t\t\t}\n\n\t\t\t\tstore.commit('set', {\n\t\t\t\t\tinsertType,\n\t\t\t\t\tdata : payload.placeholders\n\t\t\t\t});\n\n\t\t\t\treturn payload.placeholders[0].id;\n\t\t\t},\n\t\t\tclearPlaceholders: (store, payload) =>\n\t\t\t{\n\t\t\t\tstore.commit('clearPlaceholders', payload);\n\t\t\t},\n\t\t\tupdatePlaceholders: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (payload.data instanceof Array)\n\t\t\t\t{\n\t\t\t\t\tpayload.data = payload.data.map(message => this.prepareMessage(message));\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('updatePlaceholders', payload);\n\n\t\t\t\treturn true;\n\t\t\t},\n\t\t\tsetAfter: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (payload instanceof Array)\n\t\t\t\t{\n\t\t\t\t\tpayload = payload.map(message => this.prepareMessage(message));\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tlet result = this.prepareMessage(payload);\n\t\t\t\t\t(payload = []).push(result);\n\t\t\t\t}\n\n\t\t\t\tstore.commit('set', {\n\t\t\t\t\tinsertType : MutationType.setAfter,\n\t\t\t\t\tdata : payload\n\t\t\t\t});\n\t\t\t},\n\t\t\tsetBefore: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (payload instanceof Array)\n\t\t\t\t{\n\t\t\t\t\tpayload = payload.map(message => this.prepareMessage(message));\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tlet result = this.prepareMessage(payload);\n\t\t\t\t\t(payload = []).push(result);\n\t\t\t\t}\n\n\t\t\t\tstore.commit('set', {\n\t\t\t\t\tinsertType : MutationType.setBefore,\n\t\t\t\t\tdata : payload\n\t\t\t\t});\n\t\t\t},\n\t\t\tupdate: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (/^\\d+$/.test(payload.id))\n\t\t\t\t{\n\t\t\t\t\tpayload.id = parseInt(payload.id);\n\t\t\t\t}\n\t\t\t\tif (/^\\d+$/.test(payload.chatId))\n\t\t\t\t{\n\t\t\t\t\tpayload.chatId = parseInt(payload.chatId);\n\t\t\t\t}\n\n\t\t\t\tstore.commit('initCollection', {chatId: payload.chatId});\n\n\t\t\t\tif (!store.state.collection[payload.chatId])\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tlet index = store.state.collection[payload.chatId].findIndex(el => el.id === payload.id);\n\t\t\t\tif (index < 0)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tlet result = this.validate(Object.assign({}, payload.fields));\n\n\t\t\t\tif (result.params)\n\t\t\t\t{\n\t\t\t\t\tresult.params = Object.assign(\n\t\t\t\t\t\t{},\n\t\t\t\t\t\tthis.getElementState().params,\n\t\t\t\t\t\tstore.state.collection[payload.chatId][index].params,\n\t\t\t\t\t\tresult.params\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tid : payload.id,\n\t\t\t\t\tchatId : payload.chatId,\n\t\t\t\t\tindex : index,\n\t\t\t\t\tfields : result\n\t\t\t\t});\n\n\t\t\t\tif (payload.fields.blink)\n\t\t\t\t{\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tstore.commit('update', {\n\t\t\t\t\t\t\tid : payload.id ,\n\t\t\t\t\t\t\tchatId : payload.chatId,\n\t\t\t\t\t\t\tfields : {blink: false}\n\t\t\t\t\t\t});\n\t\t\t\t\t}, 1000);\n\t\t\t\t}\n\n\t\t\t\treturn true;\n\t\t\t},\n\t\t\tdelete: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (!(payload.id instanceof Array))\n\t\t\t\t{\n\t\t\t\t\tpayload.id = [payload.id];\n\t\t\t\t}\n\n\t\t\t\tpayload.id = payload.id.map(id => {\n\t\t\t\t\tif (/^\\d+$/.test(id))\n\t\t\t\t\t{\n\t\t\t\t\t\tid = parseInt(id);\n\t\t\t\t\t}\n\t\t\t\t\treturn id;\n\t\t\t\t});\n\n\t\t\t\tstore.commit('delete', {\n\t\t\t\t\tchatId : payload.chatId,\n\t\t\t\t\telements : payload.id,\n\t\t\t\t});\n\n\t\t\t\treturn true;\n\t\t\t},\n\t\t\tclear: (store, payload) =>\n\t\t\t{\n\t\t\t\tpayload.chatId = parseInt(payload.chatId);\n\n\t\t\t\tif (payload.keepPlaceholders)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('clearMessages', {\n\t\t\t\t\t\tchatId : payload.chatId\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tstore.commit('clear', {\n\t\t\t\t\t\tchatId : payload.chatId\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\treturn true;\n\t\t\t},\n\t\t\tapplyMutationType: (store, payload) =>\n\t\t\t{\n\t\t\t\tpayload.chatId = parseInt(payload.chatId);\n\n\t\t\t\tstore.commit('applyMutationType', {\n\t\t\t\t\tchatId : payload.chatId\n\t\t\t\t});\n\n\t\t\t\treturn true;\n\t\t\t},\n\t\t\treadMessages: (store, payload) =>\n\t\t\t{\n\t\t\t\tpayload.readId = parseInt(payload.readId) || 0;\n\t\t\t\tpayload.chatId = parseInt(payload.chatId);\n\n\t\t\t\tif (typeof store.state.collection[payload.chatId] === 'undefined')\n\t\t\t\t{\n\t\t\t\t\treturn {count: 0}\n\t\t\t\t}\n\n\t\t\t\tlet count = 0;\n\t\t\t\tfor (let index = store.state.collection[payload.chatId].length-1; index >= 0; index--)\n\t\t\t\t{\n\t\t\t\t\tlet element = store.state.collection[payload.chatId][index];\n\t\t\t\t\tif (!element.unread)\n\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\tif (payload.readId === 0 || element.id <= payload.readId)\n\t\t\t\t\t{\n\t\t\t\t\t\tcount++;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tstore.commit('readMessages', {\n\t\t\t\t\tchatId: payload.chatId,\n\t\t\t\t\treadId: payload.readId,\n\t\t\t\t});\n\n\t\t\t\treturn {count};\n\t\t\t},\n\t\t\tunreadMessages: (store, payload) =>\n\t\t\t{\n\t\t\t\tpayload.unreadId = parseInt(payload.unreadId) || 0;\n\t\t\t\tpayload.chatId = parseInt(payload.chatId);\n\n\t\t\t\tif (typeof store.state.collection[payload.chatId] === 'undefined' || !payload.unreadId)\n\t\t\t\t{\n\t\t\t\t\treturn {count: 0}\n\t\t\t\t}\n\n\t\t\t\tlet count = 0;\n\t\t\t\tfor (let index = store.state.collection[payload.chatId].length-1; index >= 0; index--)\n\t\t\t\t{\n\t\t\t\t\tlet element = store.state.collection[payload.chatId][index];\n\t\t\t\t\tif (element.unread)\n\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\tif (element.id >= payload.unreadId)\n\t\t\t\t\t{\n\t\t\t\t\t\tcount++;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tstore.commit('unreadMessages', {\n\t\t\t\t\tchatId: payload.chatId,\n\t\t\t\t\tunreadId: payload.unreadId,\n\t\t\t\t});\n\n\t\t\t\treturn {count};\n\t\t\t},\n\t\t}\n\t}\n\n\tgetMutations()\n\t{\n\t\treturn {\n\t\t\tinitCollection: (state, payload) =>\n\t\t\t{\n\t\t\t\treturn this.initCollection(state, payload);\n\t\t\t},\n\t\t\tadd: (state, payload) =>\n\t\t\t{\n\t\t\t\tthis.initCollection(state, {chatId: payload.chatId});\n\n\t\t\t\tstate.collection[payload.chatId].push(payload);\n\t\t\t\tstate.saveMessageList[payload.chatId].push(payload.id);\n\n\t\t\t\tstate.created += 1;\n\n\t\t\t\tstate.collection[payload.chatId].sort((a, b) => a.id - b.id);\n\t\t\t\tthis.saveState(state, payload.chatId);\n\t\t\t\tLogger.warn('Messages model: saving state after add');\n\t\t\t},\n\t\t\tclearPlaceholders: (state, payload) =>\n\t\t\t{\n\t\t\t\tif (!state.collection[payload.chatId])\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tstate.collection[payload.chatId] = state.collection[payload.chatId].filter(element => {\n\t\t\t\t\treturn !element.id.toString().startsWith('placeholder');\n\t\t\t\t});\n\t\t\t},\n\t\t\tupdatePlaceholders: (state, payload) =>\n\t\t\t{\n\t\t\t\tconst firstPlaceholderId = `placeholder${payload.firstMessage}`;\n\t\t\t\tconst firstPlaceholderIndex = state.collection[payload.chatId].findIndex((message) => {\n\t\t\t\t\treturn message.id === firstPlaceholderId;\n\t\t\t\t});\n\t\t\t\t// Logger.warn('firstPlaceholderIndex', firstPlaceholderIndex);\n\t\t\t\tif (firstPlaceholderIndex >= 0)\n\t\t\t\t{\n\t\t\t\t\t// Logger.warn('before delete', state.collection[payload.chatId].length, [...state.collection[payload.chatId]]);\n\t\t\t\t\tstate.collection[payload.chatId].splice(firstPlaceholderIndex, payload.amount);\n\t\t\t\t\t// Logger.warn('after delete', state.collection[payload.chatId].length, [...state.collection[payload.chatId]]);\n\t\t\t\t\tstate.collection[payload.chatId].splice(firstPlaceholderIndex, 0, ...payload.data);\n\t\t\t\t\t// Logger.warn('after add', state.collection[payload.chatId].length, [...state.collection[payload.chatId]]);\n\t\t\t\t}\n\n\t\t\t\tstate.collection[payload.chatId].sort((a, b) => a.id - b.id);\n\t\t\t\tLogger.warn('Messages model: saving state after updating placeholders');\n\t\t\t\tthis.saveState(state, payload.chatId);\n\t\t\t},\n\t\t\tset: (state, payload) =>\n\t\t\t{\n\t\t\t\tLogger.warn('Messages model: set mutation', payload);\n\t\t\t\tlet chats = [];\n\t\t\t\tlet chatsSave = [];\n\t\t\t\tlet isPush = false;\n\n\t\t\t\tpayload.data = MessagesModel.getPayloadWithTempMessages(state, payload);\n\n\t\t\t\tconst initialType = payload.insertType;\n\n\t\t\t\tif (payload.insertType === MutationType.set)\n\t\t\t\t{\n\t\t\t\t\tpayload.insertType = MutationType.setAfter;\n\n\t\t\t\t\tlet elements = {};\n\t\t\t\t\tpayload.data.forEach(element => {\n\t\t\t\t\t\tif (!elements[element.chatId])\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\telements[element.chatId] = [];\n\t\t\t\t\t\t}\n\t\t\t\t\t\telements[element.chatId].push(element.id);\n\t\t\t\t\t});\n\n\t\t\t\t\tfor (let chatId in elements)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (!elements.hasOwnProperty(chatId))\n\t\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\t\tthis.initCollection(state, {chatId});\n\t\t\t\t\t\tLogger.warn('Messages model: messages before adding from request - ', state.collection[chatId].length);\n\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\tstate.saveMessageList[chatId].length > elements[chatId].length\n\t\t\t\t\t\t\t|| elements[chatId].length < StorageLimit.messages\n\t\t\t\t\t\t)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tstate.collection[chatId] = state.collection[chatId].filter(element => elements[chatId].includes(element.id));\n\t\t\t\t\t\t\tstate.saveMessageList[chatId] = state.saveMessageList[chatId].filter(id => elements[chatId].includes(id));\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tLogger.warn('Messages model: cache length', state.saveMessageList[chatId].length);\n\t\t\t\t\t\tlet intersection = this.manageCacheBeforeSet(\n\t\t\t\t\t\t\t[...state.saveMessageList[chatId].reverse()],\n\t\t\t\t\t\t\telements[chatId]\n\t\t\t\t\t\t);\n\t\t\t\t\t\tLogger.warn('Messages model: set intersection with cache', intersection);\n\n\t\t\t\t\t\tif (intersection.type === IntersectionType.none)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (intersection.foundElements.length > 0)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tstate.collection[chatId] = state.collection[chatId].filter(element => !intersection.foundElements.includes(element.id));\n\t\t\t\t\t\t\t\tstate.saveMessageList[chatId] = state.saveMessageList[chatId].filter(id => !intersection.foundElements.includes(id));\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tLogger.warn('Messages model: no intersection - removing cache');\n\t\t\t\t\t\t\tthis.removeIntersectionCacheElements = state.collection[chatId].map(element => element.id);\n\n\t\t\t\t\t\t\tstate.collection[chatId] = state.collection[chatId].filter(element => !this.removeIntersectionCacheElements.includes(element.id));\n\t\t\t\t\t\t\tstate.saveMessageList[chatId] = state.saveMessageList[chatId].filter(id => !this.removeIntersectionCacheElements.includes(id));\n\t\t\t\t\t\t\tthis.removeIntersectionCacheElements = [];\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (intersection.type === IntersectionType.foundReverse)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tLogger.warn('Messages model: found reverse intersection');\n\t\t\t\t\t\t\tpayload.insertType = MutationType.setBefore;\n\t\t\t\t\t\t\tpayload.data = payload.data.reverse();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tLogger.warn('Messages model: adding messages to model', payload.data);\n\t\t\t\tfor (let element of payload.data)\n\t\t\t\t{\n\t\t\t\t\tthis.initCollection(state, {chatId: element.chatId});\n\n\t\t\t\t\tlet index = state.collection[element.chatId].findIndex(localMessage => {\n\t\t\t\t\t\tif (MessagesModel.isTemporaryMessage(localMessage))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn localMessage.templateId === element.templateId;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn localMessage.id === element.id;\n\t\t\t\t\t});\n\t\t\t\t\tif (index > -1)\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.collection[element.chatId][index] = Object.assign(\n\t\t\t\t\t\t\tstate.collection[element.chatId][index],\n\t\t\t\t\t\t\telement\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t\telse if (payload.insertType === MutationType.setBefore)\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.collection[element.chatId].unshift(element);\n\t\t\t\t\t}\n\t\t\t\t\telse if (payload.insertType === MutationType.setAfter)\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.collection[element.chatId].push(element);\n\t\t\t\t\t}\n\n\t\t\t\t\tchats.push(element.chatId);\n\n\t\t\t\t\tif (this.store.getters['dialogues/canSaveChat'] && this.store.getters['dialogues/canSaveChat'](element.chatId))\n\t\t\t\t\t{\n\t\t\t\t\t\tchatsSave.push(element.chatId);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tchats = [...new Set(chats)];\n\t\t\t\tchatsSave = [...new Set(chatsSave)];\n\n\t\t\t\tisPush = payload.data.every(element => element.push === true);\n\t\t\t\tLogger.warn('Is it fake push message?', isPush);\n\t\t\t\tchats.forEach(chatId => {\n\t\t\t\t\tstate.collection[chatId].sort((a, b) => a.id - b.id);\n\n\t\t\t\t\tif (!isPush)\n\t\t\t\t\t{\n\t\t\t\t\t\t//send event that messages are ready and we can start reading etc\n\t\t\t\t\t\tLogger.warn('setting messagesSet = true for chatId = ', chatId);\n\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\tEventEmitter.emit(EventType.dialog.messagesSet, {chatId});\n\t\t\t\t\t\t\tEventEmitter.emit(EventType.dialog.readVisibleMessages, {chatId});\n\t\t\t\t\t\t}, 100);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tif (initialType !== MutationType.setBefore)\n\t\t\t\t{\n\t\t\t\t\tchatsSave.forEach(chatId => {\n\t\t\t\t\t\tLogger.warn('Messages model: saving state after set');\n\t\t\t\t\t\tthis.saveState(state, chatId);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t},\n\t\t\tupdate: (state, payload) =>\n\t\t\t{\n\t\t\t\tthis.initCollection(state, {chatId: payload.chatId});\n\n\t\t\t\tlet index = -1;\n\t\t\t\tif (typeof payload.index !== 'undefined' && state.collection[payload.chatId][payload.index])\n\t\t\t\t{\n\t\t\t\t\tindex = payload.index;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tindex = state.collection[payload.chatId].findIndex(el => el.id === payload.id);\n\t\t\t\t}\n\n\t\t\t\tif (index >= 0)\n\t\t\t\t{\n\t\t\t\t\tlet isSaveState = (\n\t\t\t\t\t\tstate.saveMessageList[payload.chatId].includes(state.collection[payload.chatId][index].id)\n\t\t\t\t\t\t|| payload.fields.id && !payload.fields.id.toString().startsWith('temporary') && state.collection[payload.chatId][index].id.toString().startsWith('temporary')\n\t\t\t\t\t);\n\n\t\t\t\t\tstate.collection[payload.chatId][index] = Object.assign(\n\t\t\t\t\t\tstate.collection[payload.chatId][index],\n\t\t\t\t\t\tpayload.fields\n\t\t\t\t\t);\n\n\t\t\t\t\tif (isSaveState)\n\t\t\t\t\t{\n\t\t\t\t\t\tLogger.warn('Messages model: saving state after update');\n\t\t\t\t\t\tthis.saveState(state, payload.chatId);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tdelete: (state, payload) =>\n\t\t\t{\n\t\t\t\tthis.initCollection(state, {chatId: payload.chatId});\n\n\t\t\t\tstate.collection[payload.chatId] = state.collection[payload.chatId].filter(element => !payload.elements.includes(element.id));\n\n\t\t\t\tif (state.saveMessageList[payload.chatId].length > 0)\n\t\t\t\t{\n\t\t\t\t\tfor (let id of payload.elements)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (state.saveMessageList[payload.chatId].includes(id))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tLogger.warn('Messages model: saving state after delete');\n\t\t\t\t\t\t\tthis.saveState(state, payload.chatId);\n\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tclear: (state, payload) =>\n\t\t\t{\n\t\t\t\tthis.initCollection(state, {chatId: payload.chatId});\n\n\t\t\t\tstate.collection[payload.chatId] = [];\n\t\t\t\tstate.saveMessageList[payload.chatId] = [];\n\t\t\t},\n\t\t\tclearMessages: (state, payload) =>\n\t\t\t{\n\t\t\t\tthis.initCollection(state, {chatId: payload.chatId});\n\n\t\t\t\tstate.collection[payload.chatId] = state.collection[payload.chatId].filter(element => {\n\t\t\t\t\treturn element.id.toString().startsWith('placeholder');\n\t\t\t\t});\n\t\t\t\tstate.saveMessageList[payload.chatId] = [];\n\t\t\t},\n\t\t\tapplyMutationType: (state, payload) =>\n\t\t\t{\n\t\t\t\tif (typeof state.mutationType[payload.chatId] === 'undefined')\n\t\t\t\t{\n\t\t\t\t\tstate.mutationType[payload.chatId] = {applied: false, initialType: MutationType.none, appliedType: MutationType.none, scrollStickToTop: 0, scrollMessageId: 0};\n\t\t\t\t}\n\n\t\t\t\tstate.mutationType[payload.chatId].applied = true;\n\t\t\t},\n\t\t\treadMessages: (state, payload) =>\n\t\t\t{\n\t\t\t\tthis.initCollection(state, {chatId: payload.chatId});\n\n\t\t\t\tlet saveNeeded = false;\n\t\t\t\tfor (let index = state.collection[payload.chatId].length-1; index >= 0; index--)\n\t\t\t\t{\n\t\t\t\t\tlet element = state.collection[payload.chatId][index];\n\t\t\t\t\tif (!element.unread)\n\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\tif (payload.readId === 0 || element.id <= payload.readId)\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.collection[payload.chatId][index] = Object.assign(\n\t\t\t\t\t\t\tstate.collection[payload.chatId][index],\n\t\t\t\t\t\t\t{unread: false}\n\t\t\t\t\t\t);\n\t\t\t\t\t\tsaveNeeded = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (saveNeeded)\n\t\t\t\t{\n\t\t\t\t\tLogger.warn('Messages model: saving state after reading');\n\t\t\t\t\tthis.saveState(state, payload.chatId);\n\t\t\t\t}\n\t\t\t},\n\t\t\tunreadMessages: (state, payload) =>\n\t\t\t{\n\t\t\t\tthis.initCollection(state, {chatId: payload.chatId});\n\n\t\t\t\tlet saveNeeded = false;\n\t\t\t\tfor (let index = state.collection[payload.chatId].length-1; index >= 0; index--)\n\t\t\t\t{\n\t\t\t\t\tlet element = state.collection[payload.chatId][index];\n\t\t\t\t\tif (element.unread)\n\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\tif (element.id >= payload.unreadId)\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.collection[payload.chatId][index] = Object.assign(\n\t\t\t\t\t\t\tstate.collection[payload.chatId][index],\n\t\t\t\t\t\t\t{unread: true}\n\t\t\t\t\t\t);\n\t\t\t\t\t\tsaveNeeded = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (saveNeeded)\n\t\t\t\t{\n\t\t\t\t\tLogger.warn('Messages model: saving state after unreading');\n\t\t\t\t\tthis.saveState(state, payload.chatId);\n\t\t\t\t\tthis.updateSubordinateStates();\n\t\t\t\t}\n\t\t\t},\n\t\t};\n\t}\n\n\tinitCollection(state, payload)\n\t{\n\t\tif (typeof payload.chatId === 'undefined')\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tif (\n\t\t\ttypeof payload.chatId === 'undefined'\n\t\t\t|| typeof state.collection[payload.chatId] !== 'undefined'\n\t\t)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tstate.collection[payload.chatId] = payload.messages? [...payload.messages]: [];\n\t\tstate.saveMessageList[payload.chatId] = [];\n\t\tstate.saveFileList[payload.chatId] = [];\n\t\tstate.saveUserList[payload.chatId] = [];\n\n\t\treturn true;\n\t}\n\n\tprepareMessage(message, options = {})\n\t{\n\t\tlet result = this.validate(Object.assign({}, message), options);\n\n\t\tresult.params = Object.assign({}, this.getElementState().params, result.params);\n\t\tif (!result.templateId)\n\t\t{\n\t\t\tresult.templateId = result.id;\n\t\t}\n\n\t\treturn Object.assign({}, this.getElementState(), result);\n\t}\n\n\tmanageCacheBeforeSet(cache, elements, recursive = false)\n\t{\n\t\tLogger.warn('manageCacheBeforeSet', cache, elements);\n\t\tlet result = {\n\t\t\ttype: IntersectionType.empty,\n\t\t\tfoundElements: [],\n\t\t\tnoneElements: []\n\t\t};\n\n\t\tif (!cache || cache.length <= 0)\n\t\t{\n\t\t\treturn result;\n\t\t}\n\n\t\tfor (let id of elements)\n\t\t{\n\t\t\tif (cache.includes(id))\n\t\t\t{\n\t\t\t\tif (result.type === IntersectionType.empty)\n\t\t\t\t{\n\t\t\t\t\tresult.type = IntersectionType.found;\n\t\t\t\t}\n\t\t\t\tresult.foundElements.push(id);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (result.type === IntersectionType.empty)\n\t\t\t\t{\n\t\t\t\t\tresult.type = IntersectionType.none;\n\t\t\t\t}\n\t\t\t\tresult.noneElements.push(id);\n\t\t\t}\n\t\t}\n\n\t\tif (\n\t\t\tresult.type === IntersectionType.found\n\t\t\t&& cache.length === elements.length\n\t\t\t&& result.foundElements.length === elements.length\n\t\t)\n\t\t{\n\t\t\tresult.type = IntersectionType.equal;\n\t\t}\n\t\telse if (\n\t\t\tresult.type === IntersectionType.none\n\t\t\t&& !recursive\n\t\t\t&& result.foundElements.length > 0\n\t\t)\n\t\t{\n\t\t\tlet reverseResult = this.manageCacheBeforeSet(cache.reverse(), elements.reverse(), true);\n\t\t\tif (reverseResult.type === IntersectionType.found)\n\t\t\t{\n\t\t\t\treverseResult.type = IntersectionType.foundReverse;\n\t\t\t\treturn reverseResult;\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tupdateSaveLists(state, chatId)\n\t{\n\t\tif (!this.isSaveAvailable())\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tif (\n\t\t\t!chatId\n\t\t\t|| !this.store.getters['dialogues/canSaveChat']\n\t\t\t|| !this.store.getters['dialogues/canSaveChat'](chatId)\n\t\t)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.initCollection(state, {chatId: chatId});\n\n\t\tlet count = 0;\n\t\tlet saveMessageList = [];\n\t\tlet saveFileList = [];\n\t\tlet saveUserList = [];\n\n\t\tlet dialog = this.store.getters['dialogues/getByChatId'](chatId);\n\t\tif (dialog && dialog.type === 'private')\n\t\t{\n\t\t\tsaveUserList.push(parseInt(dialog.dialogId));\n\t\t}\n\n\t\tlet readCounter = 0;\n\t\tfor (let index = state.collection[chatId].length-1; index >= 0; index--)\n\t\t{\n\t\t\tif (state.collection[chatId][index].id.toString().startsWith('temporary'))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (!state.collection[chatId][index].unread)\n\t\t\t{\n\t\t\t\treadCounter++;\n\t\t\t}\n\n\t\t\tif (count >= StorageLimit.messages && readCounter >= 50)\n\t\t\t{\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tsaveMessageList.unshift(state.collection[chatId][index].id);\n\n\t\t\tcount++;\n\t\t}\n\n\t\tsaveMessageList = saveMessageList.slice(0, StorageLimit.messages);\n\n\t\tstate.collection[chatId].filter(element => saveMessageList.includes(element.id)).forEach(element =>\n\t\t{\n\t\t\tif (element.authorId > 0)\n\t\t\t{\n\t\t\t\tsaveUserList.push(element.authorId);\n\t\t\t}\n\n\t\t\tif (element.params.FILE_ID instanceof Array)\n\t\t\t{\n\t\t\t\tsaveFileList = element.params.FILE_ID.concat(saveFileList);\n\t\t\t}\n\t\t});\n\n\t\tstate.saveMessageList[chatId] = saveMessageList;\n\t\tstate.saveFileList[chatId] = [...new Set(saveFileList)];\n\t\tstate.saveUserList[chatId] = [...new Set(saveUserList)];\n\n\t\treturn true;\n\t}\n\n\tgetSaveTimeout()\n\t{\n\t\treturn 150;\n\t}\n\n\tsaveState(state, chatId)\n\t{\n\t\tif (!this.updateSaveLists(state, chatId))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tsuper.saveState(() =>\n\t\t{\n\t\t\tlet storedState = {\n\t\t\t\tcollection: {},\n\t\t\t\tsaveMessageList: {},\n\t\t\t\tsaveUserList: {},\n\t\t\t\tsaveFileList: {},\n\t\t\t};\n\n\t\t\tfor (let chatId in state.saveMessageList)\n\t\t\t{\n\t\t\t\tif (!state.saveMessageList.hasOwnProperty(chatId))\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tif (!storedState.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\tstoredState.collection[chatId] = [];\n\t\t\t\t}\n\n\t\t\t\tstate.collection[chatId]\n\t\t\t\t\t.filter(element => state.saveMessageList[chatId].includes(element.id))\n\t\t\t\t\t.forEach(element => {\n\t\t\t\t\t\tif (element.templateType !== 'placeholder')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tstoredState.collection[chatId].push(element);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\tLogger.warn('Cache after updating', storedState.collection[chatId]);\n\n\t\t\t\tstoredState.saveMessageList[chatId] = state.saveMessageList[chatId];\n\t\t\t\tstoredState.saveFileList[chatId] = state.saveFileList[chatId];\n\t\t\t\tstoredState.saveUserList[chatId] = state.saveUserList[chatId];\n\t\t\t}\n\n\t\t\treturn storedState;\n\t\t});\n\t}\n\n\tupdateSubordinateStates()\n\t{\n\t\tthis.store.dispatch('users/saveState');\n\t\tthis.store.dispatch('files/saveState');\n\t}\n\n\tvalidate(fields, options)\n\t{\n\t\tconst result = {};\n\n\t\tif (typeof fields.id === \"number\")\n\t\t{\n\t\t\tresult.id = fields.id;\n\t\t}\n\t\telse if (typeof fields.id === \"string\")\n\t\t{\n\t\t\tif (fields.id.startsWith('temporary') || fields.id.startsWith('placeholder') || Utils.text.isUuidV4(fields.id))\n\t\t\t{\n\t\t\t\tresult.id = fields.id;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresult.id = parseInt(fields.id);\n\t\t\t}\n\t\t}\n\n\t\tif (typeof fields.uuid === \"string\")\n\t\t{\n\t\t\tresult.templateId = fields.uuid;\n\t\t}\n\t\telse if (typeof fields.templateId === \"number\")\n\t\t{\n\t\t\tresult.templateId = fields.templateId;\n\t\t}\n\t\telse if (typeof fields.templateId === \"string\")\n\t\t{\n\t\t\tif (fields.templateId.startsWith('temporary') || Utils.text.isUuidV4(fields.templateId))\n\t\t\t{\n\t\t\t\tresult.templateId = fields.templateId;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresult.templateId = parseInt(fields.templateId);\n\t\t\t}\n\t\t}\n\n\t\tif (typeof fields.templateType === \"string\")\n\t\t{\n\t\t\tresult.templateType = fields.templateType;\n\t\t}\n\n\t\tif (typeof fields.placeholderType === \"number\")\n\t\t{\n\t\t\tresult.placeholderType = fields.placeholderType;\n\t\t}\n\n\t\tif (typeof fields.chat_id !== 'undefined')\n\t\t{\n\t\t\tfields.chatId = fields.chat_id;\n\t\t}\n\t\tif (typeof fields.chatId === \"number\" || typeof fields.chatId === \"string\")\n\t\t{\n\t\t\tresult.chatId = parseInt(fields.chatId);\n\t\t}\n\t\tif (typeof fields.date !== \"undefined\")\n\t\t{\n\t\t\tresult.date = Utils.date.cast(fields.date);\n\t\t}\n\n\t\t// previous P&P format\n\t\tif (typeof fields.textOriginal === \"string\" || typeof fields.textOriginal === \"number\")\n\t\t{\n\t\t\tresult.text = fields.textOriginal.toString();\n\n\t\t\tif (typeof fields.text === \"string\" || typeof fields.text === \"number\")\n\t\t\t{\n\t\t\t\tresult.textConverted = this.convertToHtml({\n\t\t\t\t\ttext: fields.text.toString(),\n\t\t\t\t\tisConverted: true\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\telse // modern format\n\t\t{\n\t\t\tif (typeof fields.text_converted !== 'undefined')\n\t\t\t{\n\t\t\t\tfields.textConverted = fields.text_converted;\n\t\t\t}\n\t\t\tif (typeof fields.textConverted === \"string\" || typeof fields.textConverted === \"number\")\n\t\t\t{\n\t\t\t\tresult.textConverted = fields.textConverted.toString();\n\t\t\t}\n\t\t\tif (typeof fields.text === \"string\" || typeof fields.text === \"number\")\n\t\t\t{\n\t\t\t\tresult.text = fields.text.toString();\n\n\t\t\t\tlet isConverted = typeof result.textConverted !== 'undefined';\n\n\t\t\t\tresult.textConverted = this.convertToHtml({\n\t\t\t\t\ttext: isConverted? result.textConverted: result.text,\n\t\t\t\t\tisConverted\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tif (typeof fields.senderId !== 'undefined')\n\t\t{\n\t\t\tfields.authorId = fields.senderId;\n\t\t}\n\t\telse if (typeof fields.author_id !== 'undefined')\n\t\t{\n\t\t\tfields.authorId = fields.author_id;\n\t\t}\n\t\tif (typeof fields.authorId === \"number\" || typeof fields.authorId === \"string\")\n\t\t{\n\t\t\tif (fields.system === true || fields.system === 'Y')\n\t\t\t{\n\t\t\t\tresult.authorId = 0;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresult.authorId = parseInt(fields.authorId);\n\t\t\t}\n\t\t}\n\n\t\tif (typeof fields.params === \"object\" && fields.params !== null)\n\t\t{\n\t\t\tconst params = this.validateParams(fields.params, options);\n\t\t\tif (params)\n\t\t\t{\n\t\t\t\tresult.params = params;\n\t\t\t}\n\t\t}\n\n\t\tif (typeof fields.push === \"boolean\")\n\t\t{\n\t\t\tresult.push = fields.push;\n\t\t}\n\n\t\tif (typeof fields.sending === \"boolean\")\n\t\t{\n\t\t\tresult.sending = fields.sending;\n\t\t}\n\n\t\tif (typeof fields.unread === \"boolean\")\n\t\t{\n\t\t\tresult.unread = fields.unread;\n\t\t}\n\n\t\tif (typeof fields.blink === \"boolean\")\n\t\t{\n\t\t\tresult.blink = fields.blink;\n\t\t}\n\n\t\tif (typeof fields.error === \"boolean\" || typeof fields.error === \"string\")\n\t\t{\n\t\t\tresult.error = fields.error;\n\t\t}\n\n\t\tif (typeof fields.retry === \"boolean\")\n\t\t{\n\t\t\tresult.retry = fields.retry;\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tvalidateParams(params, options)\n\t{\n\t\tconst result = {};\n\t\ttry\n\t\t{\n\t\t\tfor (let field in params)\n\t\t\t{\n\t\t\t\tif (!params.hasOwnProperty(field))\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tif (field === 'COMPONENT_ID')\n\t\t\t\t{\n\t\t\t\t\tif (typeof params[field] === \"string\" && BX.Vue.isComponent(params[field]))\n\t\t\t\t\t{\n\t\t\t\t\t\tresult[field] = params[field];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (field === 'LIKE')\n\t\t\t\t{\n\t\t\t\t\tif (params[field] instanceof Array)\n\t\t\t\t\t{\n\t\t\t\t\t\tresult['REACTION'] = {like: params[field].map(element => parseInt(element))};\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (field === 'CHAT_LAST_DATE')\n\t\t\t\t{\n\t\t\t\t\tresult[field] = Utils.date.cast(params[field]);\n\t\t\t\t}\n\t\t\t\telse if (field === 'AVATAR')\n\t\t\t\t{\n\t\t\t\t\tif (params[field])\n\t\t\t\t\t{\n\t\t\t\t\t\tresult[field] = params[field].startsWith('http') ? params[field] : options.host + params[field];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (field === 'NAME')\n\t\t\t\t{\n\t\t\t\t\tif (params[field])\n\t\t\t\t\t{\n\t\t\t\t\t\tresult[field] = params[field];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (field === 'LINK_ACTIVE')\n\t\t\t\t{\n\t\t\t\t\tif (params[field])\n\t\t\t\t\t{\n\t\t\t\t\t\tresult[field] = params[field].map(function(userId) {\n\t\t\t\t\t\t\treturn parseInt(userId)\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (field === 'ATTACH')\n\t\t\t\t{\n\t\t\t\t\tresult[field] = this.decodeAttach(params[field]);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tresult[field] = params[field];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcatch (e) {}\n\n\t\tlet hasResultElements = false;\n\t\tfor (let field in result)\n\t\t{\n\t\t\tif (!result.hasOwnProperty(field))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\thasResultElements = true;\n\t\t\tbreak\n\t\t}\n\n\t\treturn hasResultElements? result: null;\n\t}\n\n\tconvertToHtml(params = {})\n\t{\n\t\tlet {\n\t\t\tquote = true,\n\t\t\timage = true,\n\t\t\ttext = '',\n\t\t\tisConverted = false,\n\t\t\tenableBigSmile = true\n\t\t} = params;\n\n\t\ttext = text.trim();\n\n\t\tif (!isConverted)\n\t\t{\n\t\t\ttext = text.replace(/&/g, '&amp;').replace(/\"/g, '&quot;').replace(/</g, '&lt;').replace(/>/g, '&gt;');\n\t\t}\n\n\t\tif (text.startsWith('/me'))\n\t\t{\n\t\t\ttext = `<i>${text.substr(4)}</i>`;\n\t\t}\n\t\telse if (text.startsWith('/loud'))\n\t\t{\n\t\t\ttext = `<b>${text.substr(6)}</b>`;\n\t\t}\n\n\t\tconst quoteSign = \"&gt;&gt;\";\n\t\tif (quote && text.indexOf(quoteSign) >= 0)\n\t\t{\n\t\t\tlet textPrepareFlag = false;\n\t\t\tlet textPrepare = text.split(isConverted? \"<br />\": \"\\n\");\n\t\t\tfor (let i = 0; i < textPrepare.length; i++)\n\t\t\t{\n\t\t\t\tif (textPrepare[i].startsWith(quoteSign))\n\t\t\t\t{\n\t\t\t\t\ttextPrepare[i] = textPrepare[i].replace(quoteSign, '<div class=\"bx-im-message-content-quote\"><div class=\"bx-im-message-content-quote-wrap\">');\n\t\t\t\t\twhile (++i < textPrepare.length && textPrepare[i].startsWith(quoteSign))\n\t\t\t\t\t{\n\t\t\t\t\t\ttextPrepare[i] = textPrepare[i].replace(quoteSign, '');\n\t\t\t\t\t}\n\t\t\t\t\ttextPrepare[i - 1] += '</div></div><br>';\n\t\t\t\t\ttextPrepareFlag = true;\n\t\t\t\t}\n\t\t\t}\n\t\t\ttext = textPrepare.join(\"<br />\");\n\t\t}\n\n\t\ttext = text.replace(/\\n/gi, '<br />');\n\n\t\ttext = text.replace(/\\t/gi, '&nbsp;&nbsp;&nbsp;&nbsp;');\n\n\t\ttext = this.decodeBbCode(text, false, enableBigSmile);\n\n\t\tif (quote)\n\t\t{\n\t\t\ttext = text.replace(/------------------------------------------------------<br \\/>(.*?)\\[(.*?)\\]<br \\/>(.*?)------------------------------------------------------(<br \\/>)?/g, function (whole, p1, p2, p3, p4, offset) {\n\t\t\t\treturn (offset > 0? '<br>': '') + \"<div class=\\\"bx-im-message-content-quote\\\"><div class=\\\"bx-im-message-content-quote-wrap\\\"><div class=\\\"bx-im-message-content-quote-name\\\"><span class=\\\"bx-im-message-content-quote-name-text\\\">\" + p1 + \"</span><span class=\\\"bx-im-message-content-quote-name-time\\\">\" + p2 + \"</span></div>\" + p3 + \"</div></div><br />\";\n\t\t\t});\n\t\t\ttext = text.replace(/------------------------------------------------------<br \\/>(.*?)------------------------------------------------------(<br \\/>)?/g, function (whole, p1, p2, p3, offset) {\n\t\t\t\treturn (offset > 0? '<br>': '') + \"<div class=\\\"bx-im-message-content-quote\\\"><div class=\\\"bx-im-message-content-quote-wrap\\\">\" + p1 + \"</div></div><br />\";\n\t\t\t});\n\t\t}\n\n\t\tif (image)\n\t\t{\n\t\t\tlet changed = false;\n\t\t\ttext = text.replace(/<a(.*?)>(http[s]{0,1}:\\/\\/.*?)<\\/a>/ig, function(whole, aInner, text, offset)\n\t\t\t{\n\t\t\t\tif(!text.match(/(\\.(jpg|jpeg|png|gif|webp)\\?|\\.(jpg|jpeg|png|gif|webp)$)/i) || text.indexOf(\"/docs/pub/\") > 0 || text.indexOf(\"logout=yes\") > 0)\n\t\t\t\t{\n\t\t\t\t\treturn whole;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tchanged = true;\n\t\t\t\t\treturn (offset > 0? '<br />':'')+'<a' +aInner+ ' target=\"_blank\" class=\"bx-im-element-file-image\"><img src=\"'+text+'\" class=\"bx-im-element-file-image-source-text\" onerror=\"BX.Messenger.Model.MessagesModel.hideErrorImage(this)\"></a></span>';\n\t\t\t\t}\n\t\t\t});\n\t\t\tif (changed)\n\t\t\t{\n\t\t\t\ttext = text.replace(/<\\/span>(\\n?)<br(\\s\\/?)>/ig, '</span>').replace(/<br(\\s\\/?)>(\\n?)<br(\\s\\/?)>(\\n?)<span/ig, '<br /><span');\n\t\t\t}\n\t\t}\n\n\t\tif (enableBigSmile)\n\t\t{\n\t\t\ttext = text.replace(\n\t\t\t\t/^(\\s*<img\\s+src=[^>]+?data-code=[^>]+?data-definition=\"UHD\"[^>]+?style=\"width:)(\\d+)(px[^>]+?height:)(\\d+)(px[^>]+?class=\"bx-smile\"\\s*\\/?>\\s*)$/,\n\t\t\t\tfunction doubleSmileSize(match, start, width, middle, height, end) {\n\t\t\t\t\treturn start + (parseInt(width, 10) * 1.7) + middle + (parseInt(height, 10) * 1.7) + end;\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\tif (text.substr(-6) == '<br />')\n\t\t{\n\t\t\ttext = text.substr(0, text.length - 6);\n\t\t}\n\t\ttext = text.replace(/<br><br \\/>/ig, '<br />');\n\t\ttext = text.replace(/<br \\/><br>/ig, '<br />');\n\n\t\treturn text;\n\t};\n\n\tdecodeBbCode(text, textOnly = false, enableBigSmile = true)\n\t{\n\t\treturn MessagesModel.decodeBbCode({text, textOnly, enableBigSmile})\n\t}\n\n\tdecodeAttach(item)\n\t{\n\t\tif (Array.isArray(item))\n\t\t{\n\t\t\titem.forEach(arrayElement => {\n\t\t\t\tarrayElement = this.decodeAttach(arrayElement);\n\t\t\t});\n\t\t}\n\t\telse if (typeof item === 'object' && item !== null)\n\t\t{\n\t\t\tfor (const prop in item)\n\t\t\t{\n\t\t\t\tif (item.hasOwnProperty(prop))\n\t\t\t\t{\n\t\t\t\t\titem[prop] = this.decodeAttach(item[prop]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (typeof item === 'string')\n\t\t\t{\n\t\t\t\titem = Utils.text.htmlspecialcharsback(item);\n\t\t\t}\n\t\t}\n\n\t\treturn item;\n\t}\n\n\tstatic decodeBbCode(params = {})\n\t{\n\t\tlet {text, textOnly = false, enableBigSmile = true} = params;\n\n\t\tlet putReplacement = [];\n\t\ttext = text.replace(/\\[PUT(?:=(.+?))?\\](.+?)?\\[\\/PUT\\]/ig, function(whole)\n\t\t{\n\t\t\tvar id = putReplacement.length;\n\t\t\tputReplacement.push(whole);\n\t\t\treturn '####REPLACEMENT_PUT_'+id+'####';\n\t\t});\n\n\t\tlet sendReplacement = [];\n\t\ttext = text.replace(/\\[SEND(?:=(.+?))?\\](.+?)?\\[\\/SEND\\]/ig, function(whole)\n\t\t{\n\t\t\tvar id = sendReplacement.length;\n\t\t\tsendReplacement.push(whole);\n\t\t\treturn '####REPLACEMENT_SEND_'+id+'####';\n\t\t});\n\n\t\tlet codeReplacement = [];\n\t\ttext = text.replace(/\\[CODE\\]\\n?(.*?)\\[\\/CODE\\]/sig, function(whole, text) {\n\t\t\tlet id = codeReplacement.length;\n\t\t\tcodeReplacement.push(text);\n\t\t\treturn '####REPLACEMENT_CODE_'+id+'####';\n\t\t});\n\n\t\ttext = text.replace(/\\[url=([^\\]]+)\\](.*?)\\[\\/url\\]/ig, function(whole, link, text)\n\t\t{\n\t\t\tlet tag = document.createElement('a');\n\t\t\ttag.href = Utils.text.htmlspecialcharsback(link);\n\t\t\ttag.target = '_blank';\n\t\t\ttag.text = Utils.text.htmlspecialcharsback(text);\n\n\t\t\tlet allowList = [\n\t\t\t\t\"http:\",\n\t\t\t\t\"https:\",\n\t\t\t\t\"ftp:\",\n\t\t\t\t\"file:\",\n\t\t\t\t\"tel:\",\n\t\t\t\t\"callto:\",\n\t\t\t\t\"mailto:\",\n\t\t\t\t\"skype:\",\n\t\t\t\t\"viber:\",\n\t\t\t];\n\t\t\tif (allowList.indexOf(tag.protocol) <= -1)\n\t\t\t{\n\t\t\t\treturn whole;\n\t\t\t}\n\n\t\t\treturn tag.outerHTML;\n\t\t});\n\n\t\ttext = text.replace(/\\[url\\]([^\\]]+)\\[\\/url\\]/ig, function(whole, link)\n\t\t{\n\t\t\tlink = Utils.text.htmlspecialcharsback(link);\n\n\t\t\tlet tag = document.createElement('a');\n\t\t\ttag.href = link;\n\t\t\ttag.target = '_blank';\n\t\t\ttag.text = link;\n\n\t\t\tlet allowList = [\n\t\t\t\t\"http:\",\n\t\t\t\t\"https:\",\n\t\t\t\t\"ftp:\",\n\t\t\t\t\"file:\",\n\t\t\t\t\"tel:\",\n\t\t\t\t\"callto:\",\n\t\t\t\t\"mailto:\",\n\t\t\t\t\"skype:\",\n\t\t\t\t\"viber:\",\n\t\t\t];\n\t\t\tif (allowList.indexOf(tag.protocol) <= -1)\n\t\t\t{\n\t\t\t\treturn whole;\n\t\t\t}\n\n\t\t\treturn tag.outerHTML;\n\t\t});\n\n\t\ttext = text.replace(/\\[LIKE\\]/ig, '<span class=\"bx-smile bx-im-smile-like\"></span>');\n\t\ttext = text.replace(/\\[DISLIKE\\]/ig, '<span class=\"bx-smile bx-im-smile-dislike\"></span>');\n\n\t\ttext = text.replace(/\\[BR\\]/ig, '<br/>');\n\t\ttext = text.replace(/\\[([buis])\\](.*?)\\[(\\/[buis])\\]/ig, (whole, open, inner, close) => '<'+open+'>'+inner+'<'+close+'>'); // TODO tag USER\n\n\t\t// this code needs to be ported to im/install/js/im/view/message/body/src/body.js:229\n\t\ttext = text.replace(/\\[CHAT=(imol\\|)?([0-9]{1,})\\](.*?)\\[\\/CHAT\\]/ig, (whole, openlines, chatId, inner) => openlines? inner: '<span class=\"bx-im-mention\" data-type=\"CHAT\" data-value=\"chat'+chatId+'\">'+inner+'</span>'); // TODO tag CHAT\n\n\t\tif (false && Utils.device.isMobile())\n\t\t{\n\t\t\tlet replacements = [];\n\t\t\ttext = text.replace(/\\[CALL(?:=(.+?))?\\](.+?)?\\[\\/CALL\\]/ig, (whole, number, text) => {\n\t\t\t\tlet index = replacements.length;\n\t\t\t\treplacements.push({number, text});\n\t\t\t\treturn `####REPLACEMENT_MARK_${index}####`;\n\t\t\t});\n\n\t\t\ttext = text.replace(/[+]{0,1}(?:[-\\/. ()\\[\\]~;#,]*[0-9]){10,}[^\\n\\r<][-\\/. ()\\[\\]~;#,0-9^]*/g, (number) => {\n\t\t\t\tlet pureNumber = number.replace(/\\D/g, '');\n\t\t\t\treturn `[CALL=${pureNumber}]${number}[/CALL]`;\n\t\t\t});\n\n\t\t\treplacements.forEach((item, index) => {\n\t\t\t\ttext = text.replace(`####REPLACEMENT_MARK_${index}####`, `[CALL=${item.number}]${item.text}[/CALL]`)\n\t\t\t});\n\t\t}\n\n\t\ttext = text.replace(/\\[CALL(?:=(.+?))?\\](.+?)?\\[\\/CALL\\]/ig, (whole, number, text) => '<span class=\"bx-im-mention\" data-type=\"CALL\" data-value=\"'+Utils.text.htmlspecialchars(number)+'\">'+text+'</span>'); // TODO tag CHAT\n\n\t\ttext = text.replace(/\\[PCH=([0-9]{1,})\\](.*?)\\[\\/PCH\\]/ig, (whole, historyId, text) => text); // TODO tag PCH\n\n\t\tlet textElementSize = 0;\n\t\tif (enableBigSmile)\n\t\t{\n\t\t\ttextElementSize = text.replace(/\\[icon\\=([^\\]]*)\\]/ig, '').trim().length;\n\t\t}\n\n\t\ttext = text.replace(/\\[icon\\=([^\\]]*)\\]/ig, (whole) =>\n\t\t{\n\t\t\tlet url = whole.match(/icon\\=(\\S+[^\\s.,> )\\];\\'\\\"!?])/i);\n\t\t\tif (url && url[1])\n\t\t\t{\n\t\t\t\turl = url[1];\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\treturn '';\n\t\t\t}\n\n\t\t\tlet attrs = {'src': url, 'border': 0};\n\n\t\t\tlet size = whole.match(/size\\=(\\d+)/i);\n\t\t\tif (size && size[1])\n\t\t\t{\n\t\t\t\tattrs['width'] = size[1];\n\t\t\t\tattrs['height'] = size[1];\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tlet width = whole.match(/width\\=(\\d+)/i);\n\t\t\t\tif (width && width[1])\n\t\t\t\t{\n\t\t\t\t\tattrs['width'] = width[1];\n\t\t\t\t}\n\n\t\t\t\tlet height = whole.match(/height\\=(\\d+)/i);\n\t\t\t\tif (height && height[1])\n\t\t\t\t{\n\t\t\t\t\tattrs['height'] = height[1];\n\t\t\t\t}\n\n\t\t\t\tif (attrs['width'] && !attrs['height'])\n\t\t\t\t{\n\t\t\t\t\tattrs['height'] = attrs['width'];\n\t\t\t\t}\n\t\t\t\telse if (attrs['height'] && !attrs['width'])\n\t\t\t\t{\n\t\t\t\t\tattrs['width'] = attrs['height'];\n\t\t\t\t}\n\t\t\t\telse if (attrs['height'] && attrs['width'])\n\t\t\t\t{}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tattrs['width'] = 20;\n\t\t\t\t\tattrs['height'] = 20;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tattrs['width'] = attrs['width']>100? 100: attrs['width'];\n\t\t\tattrs['height'] = attrs['height']>100? 100: attrs['height'];\n\n\t\t\tif (enableBigSmile && textElementSize === 0 && attrs['width'] === attrs['height'] && attrs['width'] === 20)\n\t\t\t{\n\t\t\t\tattrs['width'] = 40;\n\t\t\t\tattrs['height'] = 40;\n\t\t\t}\n\n\t\t\tlet title = whole.match(/title\\=(.*[^\\s\\]])/i);\n\t\t\tif (title && title[1])\n\t\t\t{\n\t\t\t\ttitle = title[1];\n\t\t\t\tif (title.indexOf('width=') > -1)\n\t\t\t\t{\n\t\t\t\t\ttitle = title.substr(0, title.indexOf('width='))\n\t\t\t\t}\n\t\t\t\tif (title.indexOf('height=') > -1)\n\t\t\t\t{\n\t\t\t\t\ttitle = title.substr(0, title.indexOf('height='))\n\t\t\t\t}\n\t\t\t\tif (title.indexOf('size=') > -1)\n\t\t\t\t{\n\t\t\t\t\ttitle = title.substr(0, title.indexOf('size='))\n\t\t\t\t}\n\t\t\t\tif (title)\n\t\t\t\t{\n\t\t\t\t\tattrs['title'] = Utils.text.htmlspecialchars(title).trim();\n\t\t\t\t\tattrs['alt'] = attrs['title'];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tlet attributes = '';\n\t\t\tfor (let name in attrs)\n\t\t\t{\n\t\t\t\tif (attrs.hasOwnProperty(name))\n\t\t\t\t{\n\t\t\t\t\tattributes += name+'=\"'+attrs[name]+'\" ';\n\t\t\t\t}\n\t\t\t}\n\n\n\t\t\treturn '<img class=\"bx-smile bx-icon\" '+attributes+'>';\n\t\t});\n\n\t\tsendReplacement.forEach((value, index) => {\n\t\t\ttext = text.replace('####REPLACEMENT_SEND_'+index+'####', value);\n\t\t});\n\n\t\ttext = text.replace(/\\[SEND(?:=(?:.+?))?\\](?:.+?)?\\[\\/SEND]/ig, (match) =>\n\t\t{\n\t\t\treturn match.replace(/\\[SEND(?:=(.+))?\\](.+?)?\\[\\/SEND]/ig, (whole, command, text) =>\n\t\t\t{\n\t\t\t\tlet html = '';\n\n\t\t\t\ttext = text? text: command;\n\t\t\t\tcommand = (command? command: text).replace('<br />', '\\n');\n\n\t\t\t\tif (!textOnly && text)\n\t\t\t\t{\n\t\t\t\t\ttext = text.replace(/<([\\w]+)[^>]*>(.*?)<\\\\1>/i, \"$2\", text);\n\t\t\t\t\ttext = text.replace(/\\[([\\w]+)[^\\]]*\\](.*?)\\[\\/\\1\\]/i, \"$2\", text);\n\n\t\t\t\t\tcommand = command.split('####REPLACEMENT_PUT_').join('####REPLACEMENT_SP_');\n\n\t\t\t\t\thtml = '<!--IM_COMMAND_START-->' +\n\t\t\t\t\t\t'<span class=\"bx-im-message-command-wrap\">'+\n\t\t\t\t\t\t\t'<span class=\"bx-im-message-command\" data-entity=\"send\">'+text+'</span>'+\n\t\t\t\t\t\t\t'<span class=\"bx-im-message-command-data\">'+command+'</span>'+\n\t\t\t\t\t\t'</span>'+\n\t\t\t\t\t'<!--IM_COMMAND_END-->';\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\thtml = text;\n\t\t\t\t}\n\n\t\t\t\treturn html;\n\t\t\t});\n\t\t});\n\n\t\tputReplacement.forEach((value, index) => {\n\t\t\ttext = text.replace('####REPLACEMENT_PUT_'+index+'####', value);\n\t\t});\n\n\t\ttext = text.replace(/\\[PUT(?:=(?:.+?))?\\](?:.+?)?\\[\\/PUT]/ig, (match) =>\n\t\t{\n\t\t\treturn match.replace(/\\[PUT(?:=(.+))?\\](.+?)?\\[\\/PUT]/ig, (whole, command, text) =>\n\t\t\t{\n\t\t\t\tlet html = '';\n\n\t\t\t\ttext = text? text: command;\n\t\t\t\tcommand = (command? command: text).replace('<br />', '\\n');\n\n\t\t\t\tif (!textOnly && text)\n\t\t\t\t{\n\t\t\t\t\ttext = text.replace(/<([\\w]+)[^>]*>(.*?)<\\/\\1>/i, \"$2\", text);\n\t\t\t\t\ttext = text.replace(/\\[([\\w]+)[^\\]]*\\](.*?)\\[\\/\\1\\]/i, \"$2\", text);\n\n\t\t\t\t\thtml = '<!--IM_COMMAND_START-->' +\n\t\t\t\t\t\t'<span class=\"bx-im-message-command-wrap\">'+\n\t\t\t\t\t\t\t'<span class=\"bx-im-message-command\" data-entity=\"put\">'+text+'</span>'+\n\t\t\t\t\t\t\t'<span class=\"bx-im-message-command-data\">'+command+'</span>'+\n\t\t\t\t\t\t'</span>'+\n\t\t\t\t\t'<!--IM_COMMAND_END-->';\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\thtml = text;\n\t\t\t\t}\n\n\t\t\t\treturn html;\n\t\t\t});\n\t\t});\n\n\t\tcodeReplacement.forEach((code, index) => {\n\t\t\ttext = text.replace('####REPLACEMENT_CODE_'+index+'####',\n\t\t\t\t!textOnly? '<div class=\"bx-im-message-content-code\">'+code+'</div>': code\n\t\t\t)\n\t\t});\n\n\t\tif (sendReplacement.length > 0)\n\t\t{\n\t\t\tdo\n\t\t\t{\n\t\t\t\tsendReplacement.forEach((value, index) => {\n\t\t\t\t\ttext = text.replace('####REPLACEMENT_SEND_'+index+'####', value);\n\t\t\t\t});\n\t\t\t}\n\t\t\twhile (text.includes('####REPLACEMENT_SEND_'));\n\t\t}\n\n\t\ttext = text.split('####REPLACEMENT_SP_').join('####REPLACEMENT_PUT_');\n\n\t\tif (putReplacement.length > 0)\n\t\t{\n\t\t\tdo\n\t\t\t{\n\t\t\t\tputReplacement.forEach((value, index) => {\n\t\t\t\t\ttext = text.replace('####REPLACEMENT_PUT_'+index+'####', value);\n\t\t\t\t});\n\t\t\t}\n\t\t\twhile (text.includes('####REPLACEMENT_PUT_'));\n\t\t}\n\n\t\treturn text;\n\t}\n\n\tstatic hideErrorImage(element)\n\t{\n\t\tif (element.parentNode && element.parentNode)\n\t\t{\n\t\t\telement.parentNode.innerHTML = '<a href=\"'+element.src+'\" target=\"_blank\">'+element.src+'</a>';\n\t\t}\n\t\treturn true;\n\t};\n\n\tstatic isTemporaryMessage(element)\n\t{\n\t\treturn element.id\n\t\t\t&& (Utils.text.isUuidV4(element.id) || element.id.toString().startsWith('temporary'));\n\t}\n\n\tstatic getPayloadWithTempMessages(state, payload)\n\t{\n\t\tconst payloadData = [...payload.data];\n\n\t\tif (!Utils.platform.isBitrixMobile())\n\t\t{\n\t\t\treturn payloadData;\n\t\t}\n\n\t\tif (!payload.data || payload.data.length <= 0)\n\t\t{\n\t\t\treturn payloadData;\n\t\t}\n\n\t\t// consider that in the payload we have messages only for one chat, so we get the value from the first message.\n\t\tconst payloadChatId = payload.data[0].chatId;\n\t\tif (!state.collection[payloadChatId])\n\t\t{\n\t\t\treturn payloadData;\n\t\t}\n\n\t\tstate.collection[payloadChatId].forEach(message => {\n\t\t\tif (\n\t\t\t\tMessagesModel.isTemporaryMessage(message)\n\t\t\t\t&& !MessagesModel.existsInPayload(payload, message.templateId)\n\t\t\t\t&& MessagesModel.doesTaskExist(message)\n\t\t\t)\n\t\t\t{\n\t\t\t\tpayloadData.push(message);\n\t\t\t}\n\t\t});\n\n\t\treturn payloadData;\n\t}\n\n\tstatic existsInPayload(payload, templateId)\n\t{\n\t\treturn payload.data.find(payloadMessage => payloadMessage.templateId === templateId);\n\t}\n\n\tstatic doesTaskExist(message)\n\t{\n\t\tif (Array.isArray(message.params.FILE_ID))\n\t\t{\n\t\t\tlet foundUploadTasks = false;\n\t\t\tmessage.params.FILE_ID.forEach(fileId => {\n\t\t\t\tif (!foundUploadTasks)\n\t\t\t\t{\n\t\t\t\t\tfoundUploadTasks = window.imDialogUploadTasks.find(task => task.taskId.split('|')[1] === fileId);\n\t\t\t\t}\n\t\t\t})\n\n\t\t\treturn !!foundUploadTasks;\n\t\t}\n\n\t\tif (message.templateId)\n\t\t{\n\t\t\tconst foundMessageTask = window.imDialogMessagesTasks.find(task => task.taskId.split('|')[1] === message.templateId);\n\n\t\t\treturn !!foundMessageTask;\n\t\t}\n\n\t\treturn false;\n\t}\n}","import {Type} from 'main.core';\nimport {BuilderModel} from 'ui.vue3.vuex';\nimport {ChatTypes} from 'im.v2.const';\nimport {Utils} from 'im.v2.lib.utils';\n\nconst WRITING_STATUS_TIME = 35000;\n\nexport class DialoguesModel extends BuilderModel\n{\n\tgetName()\n\t{\n\t\treturn 'dialogues';\n\t}\n\n\tgetState()\n\t{\n\t\treturn {\n\t\t\tcollection: {},\n\t\t\twritingStatusTimers: {},\n\t\t\tchatOptions: {}\n\t\t};\n\t}\n\n\tgetElementState()\n\t{\n\t\treturn {\n\t\t\tdialogId: '0',\n\t\t\tchatId: 0,\n\t\t\ttype: ChatTypes.chat,\n\t\t\tname: '',\n\t\t\tavatar: '',\n\t\t\tcolor: '#17A3EA',\n\t\t\textranet: false,\n\t\t\tcounter: 0,\n\t\t\tuserCounter: 0,\n\t\t\tmessageCounter: 0,\n\t\t\tunreadId: 0,\n\t\t\tlastMessageId: 0,\n\t\t\tmanagerList: [],\n\t\t\treadList: [],\n\t\t\twritingList: [],\n\t\t\tmuteList: [],\n\t\t\ttextareaMessage: '',\n\t\t\tquoteId: 0,\n\t\t\teditId: 0,\n\t\t\towner: 0,\n\t\t\tentityType: '',\n\t\t\tentityId: '',\n\t\t\tdateCreate: null,\n\t\t\tpublic: {\n\t\t\t\tcode: '',\n\t\t\t\tlink: ''\n\t\t\t}\n\t\t};\n\t}\n\n\tgetGetters()\n\t{\n\t\treturn {\n\t\t\tget: state => (dialogId, getBlank = false) =>\n\t\t\t{\n\t\t\t\tif (!state.collection[dialogId] && getBlank)\n\t\t\t\t{\n\t\t\t\t\treturn this.getElementState();\n\t\t\t\t}\n\t\t\t\telse if (!state.collection[dialogId] && !getBlank)\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[dialogId];\n\t\t\t},\n\t\t\tgetByChatId: state => chatId =>\n\t\t\t{\n\t\t\t\tchatId = Number.parseInt(chatId, 10);\n\t\t\t\treturn Object.values(state.collection).find(item => {\n\t\t\t\t\treturn item.chatId === chatId;\n\t\t\t\t});\n\t\t\t},\n\t\t\tgetBlank: () =>\n\t\t\t{\n\t\t\t\treturn this.getElementState();\n\t\t\t},\n\t\t\tgetChatOption: state => (chatType, option) =>\n\t\t\t{\n\t\t\t\tif (!state.chatOptions[chatType])\n\t\t\t\t{\n\t\t\t\t\tchatType = 'default';\n\t\t\t\t}\n\n\t\t\t\treturn state.chatOptions[chatType][option];\n\t\t\t},\n\t\t\tgetQuoteId: state => dialogId =>\n\t\t\t{\n\t\t\t\tif (!state.collection[dialogId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[dialogId].quoteId;\n\t\t\t},\n\t\t\tgetEditId: state => dialogId =>\n\t\t\t{\n\t\t\t\tif (!state.collection[dialogId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[dialogId].editId;\n\t\t\t},\n\t\t\tareUnreadMessagesLoaded: state => dialogId =>\n\t\t\t{\n\t\t\t\tconst dialog = state.collection[dialogId];\n\t\t\t\tif (!dialog || dialog.lastMessageId === 0)\n\t\t\t\t{\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\tconst messagesCollection = this.store.getters['messages/get'](dialog.chatId);\n\t\t\t\tif (messagesCollection.length === 0)\n\t\t\t\t{\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\tlet lastElementId = 0;\n\t\t\t\tfor (let index = messagesCollection.length - 1; index >= 0; index--)\n\t\t\t\t{\n\t\t\t\t\tconst lastElement = messagesCollection[index];\n\t\t\t\t\tif (Type.isNumber(lastElement.id))\n\t\t\t\t\t{\n\t\t\t\t\t\tlastElementId = lastElement.id;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn lastElementId >= dialog.lastMessageId;\n\t\t\t}\n\t\t};\n\t}\n\n\tgetActions()\n\t{\n\t\treturn {\n\t\t\tset: (store, payload: Array | Object) =>\n\t\t\t{\n\t\t\t\tif (!Array.isArray(payload) && Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\tpayload = [payload];\n\t\t\t\t}\n\n\t\t\t\tpayload.map(element => {\n\t\t\t\t\treturn this.validate(element);\n\t\t\t\t}).forEach(element => {\n\t\t\t\t\tconst existingItem = store.state.collection[element.dialogId];\n\t\t\t\t\tif (existingItem)\n\t\t\t\t\t{\n\t\t\t\t\t\tstore.commit('update', {\n\t\t\t\t\t\t\tdialogId: element.dialogId,\n\t\t\t\t\t\t\tfields: element\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tstore.commit('add', {\n\t\t\t\t\t\t\tdialogId: element.dialogId,\n\t\t\t\t\t\t\tfields: {...this.getElementState(), ...element}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tadd: (store, payload: Array | Object) =>\n\t\t\t{\n\t\t\t\tif (!Array.isArray(payload) && Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\tpayload = [payload];\n\t\t\t\t}\n\n\t\t\t\tpayload.map(element => {\n\t\t\t\t\treturn this.validate(element);\n\t\t\t\t}).forEach(element => {\n\t\t\t\t\tconst existingItem = store.state.collection[element.dialogId];\n\t\t\t\t\tif (!existingItem)\n\t\t\t\t\t{\n\t\t\t\t\t\tstore.commit('add', {\n\t\t\t\t\t\t\tdialogId: element.dialogId,\n\t\t\t\t\t\t\tfields: {...this.getElementState(), ...element}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tupdate: (store, payload: {dialogId: string, fields: Object}) =>\n\t\t\t{\n\t\t\t\tconst existingItem = store.state.collection[payload.dialogId];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tdialogId: payload.dialogId,\n\t\t\t\t\tfields: this.validate(payload.fields)\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tdelete: (store, payload: {dialogId: string}) =>\n\t\t\t{\n\t\t\t\tconst existingItem = store.state.collection[payload.dialogId];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('delete', payload.dialogId);\n\t\t\t},\n\n\t\t\tstartWriting: (store, payload: {dialogId: string, userId: number, userName: string}) =>\n\t\t\t{\n\t\t\t\tconst existingItem = store.state.collection[payload.dialogId];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst timerId = `${payload.dialogId}|${payload.userId}`;\n\t\t\t\tconst alreadyWriting = existingItem.writingList.some(el => el.userId === payload.userId);\n\t\t\t\tif (alreadyWriting)\n\t\t\t\t{\n\t\t\t\t\tclearTimeout(store.state.writingStatusTimers[timerId]);\n\t\t\t\t\tstore.state.writingStatusTimers[timerId] = this.setWritingStatusTimeout(payload);\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\tconst newItem = {userId: payload.userId, userName: payload.userName};\n\t\t\t\tconst newWritingList = [newItem, ...existingItem.writingList];\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tactionName: 'startWriting',\n\t\t\t\t\tdialogId: payload.dialogId,\n\t\t\t\t\tfields: this.validate({writingList: newWritingList})\n\t\t\t\t});\n\n\t\t\t\tif (!store.state.writingStatusTimers[timerId])\n\t\t\t\t{\n\t\t\t\t\tstore.state.writingStatusTimers[timerId] = this.setWritingStatusTimeout(payload);\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tstopWriting: (store, payload: {dialogId: string, userId: number}) =>\n\t\t\t{\n\t\t\t\tconst existingItem = store.state.collection[payload.dialogId];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst alreadyWriting = existingItem.writingList.find(el => el.userId === payload.userId);\n\t\t\t\tif (!alreadyWriting)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst newWritingList = existingItem.writingList.filter(item => item.userId !== payload.userId);\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tactionName: 'stopWriting',\n\t\t\t\t\tdialogId: payload.dialogId,\n\t\t\t\t\tfields: this.validate({writingList: newWritingList})\n\t\t\t\t});\n\n\t\t\t\tconst timerId = `${payload.dialogId}|${payload.userId}`;\n\t\t\t\tclearTimeout(store.state.writingStatusTimers[timerId]);\n\t\t\t\tdelete store.state.writingStatusTimers[timerId];\n\t\t\t},\n\n\t\t\taddToReadList: (store, payload: {\n\t\t\t\tdialogId: string,\n\t\t\t\tuserId: number,\n\t\t\t\tuserName: string,\n\t\t\t\tmessageId: number,\n\t\t\t\tdate: string\n\t\t\t}) =>\n\t\t\t{\n\t\t\t\tconst existingItem = store.state.collection[payload.dialogId];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst readList = existingItem.readList.filter(el => el.userId !== payload.userId);\n\n\t\t\t\treadList.push({\n\t\t\t\t\tuserId: payload.userId,\n\t\t\t\t\tuserName: payload.userName || '',\n\t\t\t\t\tmessageId: payload.messageId,\n\t\t\t\t\tdate: payload.date || (new Date()),\n\t\t\t\t});\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tactionName: 'addToReadList',\n\t\t\t\t\tdialogId: payload.dialogId,\n\t\t\t\t\tfields: this.validate({readList})\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tremoveFromReadList: (store, payload: {\n\t\t\t\tdialogId: string,\n\t\t\t\tuserId: number\n\t\t\t}) =>\n\t\t\t{\n\t\t\t\tconst existingItem = store.state.collection[payload.dialogId];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst readList = existingItem.readList.filter(el => el.userId !== payload.userId);\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tactionName: 'removeFromReadList',\n\t\t\t\t\tdialogId: payload.dialogId,\n\t\t\t\t\tfields: this.validate({readList})\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tincreaseCounter: (store, payload: {dialogId: string, count: number}) =>\n\t\t\t{\n\t\t\t\tconst existingItem = store.state.collection[payload.dialogId];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tif (existingItem.counter === 100)\n\t\t\t\t{\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\tlet increasedCounter = existingItem.counter + payload.count;\n\t\t\t\tif (increasedCounter > 100)\n\t\t\t\t{\n\t\t\t\t\tincreasedCounter = 100;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tactionName: 'increaseCounter',\n\t\t\t\t\tdialogId: payload.dialogId,\n\t\t\t\t\tfields: {\n\t\t\t\t\t\tcounter: increasedCounter,\n\t\t\t\t\t\tpreviousCounter: existingItem.counter\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tdecreaseCounter: (store, payload: {dialogId: string, count: number}) =>\n\t\t\t{\n\t\t\t\tconst existingItem = store.state.collection[payload.dialogId];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tif (existingItem.counter === 100)\n\t\t\t\t{\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\tlet decreasedCounter = existingItem.counter - payload.count;\n\t\t\t\tif (decreasedCounter < 0)\n\t\t\t\t{\n\t\t\t\t\tdecreasedCounter = 0;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tactionName: 'decreaseCounter',\n\t\t\t\t\tdialogId: payload.dialogId,\n\t\t\t\t\tfields: {\n\t\t\t\t\t\tcounter: decreasedCounter,\n\t\t\t\t\t\tpreviousCounter: existingItem.counter\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tincreaseMessageCounter: (store, payload: {dialogId: string, count: number}) =>\n\t\t\t{\n\t\t\t\tconst existingItem = store.state.collection[payload.dialogId];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tactionName: 'increaseMessageCount',\n\t\t\t\t\tdialogId: payload.dialogId,\n\t\t\t\t\tfields: {\n\t\t\t\t\t\tmessageCounter: existingItem.messageCounter + payload.count,\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tmute: (store, payload: {dialogId: string}) =>\n\t\t\t{\n\t\t\t\tconst existingItem = store.state.collection[payload.dialogId];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst currentUserId = this.store.state.application.common.userId;\n\t\t\t\tif (existingItem.muteList.includes(currentUserId))\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tconst muteList = [...existingItem.muteList, currentUserId];\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tactionName: 'mute',\n\t\t\t\t\tdialogId: payload.dialogId,\n\t\t\t\t\tfields: this.validate({muteList})\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tunmute: (store, payload: {dialogId: string}) =>\n\t\t\t{\n\t\t\t\tconst existingItem = store.state.collection[payload.dialogId];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst currentUserId = this.store.state.application.common.userId;\n\t\t\t\tconst muteList = existingItem.muteList.filter(item => item !== currentUserId);\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tactionName: 'unmute',\n\t\t\t\t\tdialogId: payload.dialogId,\n\t\t\t\t\tfields: this.validate({muteList})\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tsetChatOptions: (store, payload: Object) =>\n\t\t\t{\n\t\t\t\tstore.commit('setChatOptions', this.validateChatOptions(payload));\n\t\t\t}\n\t\t};\n\t}\n\n\tgetMutations()\n\t{\n\t\treturn {\n\t\t\tadd: (state, payload) =>\n\t\t\t{\n\t\t\t\tstate.collection[payload.dialogId] = payload.fields;\n\t\t\t},\n\t\t\tupdate: (state, payload) =>\n\t\t\t{\n\t\t\t\tstate.collection[payload.dialogId] = {...state.collection[payload.dialogId], ...payload.fields};\n\t\t\t},\n\t\t\tdelete: (state, payload) =>\n\t\t\t{\n\t\t\t\tdelete state.collection[payload.dialogId];\n\t\t\t},\n\t\t\tsetChatOptions: (state, payload) =>\n\t\t\t{\n\t\t\t\tstate.chatOptions = payload;\n\t\t\t}\n\t\t};\n\t}\n\n\tsetWritingStatusTimeout(payload: {dialogId: string, userId: number})\n\t{\n\t\treturn setTimeout(() => {\n\t\t\tthis.store.dispatch('dialogues/stopWriting', {\n\t\t\t\tdialogId: payload.dialogId,\n\t\t\t\tuserId: payload.userId\n\t\t\t});\n\t\t}, WRITING_STATUS_TIME);\n\t}\n\n\tvalidate(fields)\n\t{\n\t\tconst result = {};\n\n\t\tif (!Type.isUndefined(fields.dialog_id))\n\t\t{\n\t\t\tfields.dialogId = fields.dialog_id;\n\t\t}\n\t\tif (Type.isNumber(fields.dialogId) || Type.isStringFilled(fields.dialogId))\n\t\t{\n\t\t\tresult.dialogId = fields.dialogId.toString();\n\t\t}\n\n\t\tif (!Type.isUndefined(fields.chat_id))\n\t\t{\n\t\t\tfields.chatId = fields.chat_id;\n\t\t}\n\t\telse if (!Type.isUndefined(fields.id))\n\t\t{\n\t\t\tfields.chatId = fields.id;\n\t\t}\n\t\tif (Type.isNumber(fields.chatId) || Type.isStringFilled(fields.chatId))\n\t\t{\n\t\t\tresult.chatId = Number.parseInt(fields.chatId, 10);\n\t\t}\n\n\t\tif (Type.isStringFilled(fields.type))\n\t\t{\n\t\t\tresult.type = fields.type.toString();\n\t\t}\n\n\t\tif (Type.isNumber(fields.quoteId))\n\t\t{\n\t\t\tresult.quoteId = Number.parseInt(fields.quoteId, 10);\n\t\t}\n\t\tif (Type.isNumber(fields.editId))\n\t\t{\n\t\t\tresult.editId = Number.parseInt(fields.editId, 10);\n\t\t}\n\n\t\tif (Type.isNumber(fields.counter) || Type.isStringFilled(fields.counter))\n\t\t{\n\t\t\tresult.counter = Number.parseInt(fields.counter, 10);\n\t\t}\n\n\t\tif (!Type.isUndefined(fields.user_counter))\n\t\t{\n\t\t\tresult.userCounter = fields.user_counter;\n\t\t}\n\t\tif (Type.isNumber(fields.userCounter) || Type.isStringFilled(fields.userCounter))\n\t\t{\n\t\t\tresult.userCounter = Number.parseInt(fields.userCounter, 10);\n\t\t}\n\n\t\tif (!Type.isUndefined(fields.message_count))\n\t\t{\n\t\t\tresult.messageCounter = fields.message_count;\n\t\t}\n\t\tif (Type.isNumber(fields.messageCounter) || Type.isStringFilled(fields.messageCounter))\n\t\t{\n\t\t\tresult.messageCounter = Number.parseInt(fields.messageCounter, 10);\n\t\t}\n\n\t\tif (!Type.isUndefined(fields.unread_id))\n\t\t{\n\t\t\tfields.unreadId = fields.unread_id;\n\t\t}\n\t\tif (Type.isNumber(fields.unreadId) || Type.isStringFilled(fields.unreadId))\n\t\t{\n\t\t\tresult.unreadId = Number.parseInt(fields.unreadId, 10);\n\t\t}\n\n\t\tif (!Type.isUndefined(fields.last_message_id))\n\t\t{\n\t\t\tfields.lastMessageId = fields.last_message_id;\n\t\t}\n\t\tif (Type.isNumber(fields.lastMessageId) || Type.isStringFilled(fields.lastMessageId))\n\t\t{\n\t\t\tresult.lastMessageId = Number.parseInt(fields.lastMessageId, 10);\n\t\t}\n\n\t\tif (!Type.isUndefined(fields.textareaMessage))\n\t\t{\n\t\t\tresult.textareaMessage = fields.textareaMessage.toString();\n\t\t}\n\n\t\tif (!Type.isUndefined(fields.title))\n\t\t{\n\t\t\tfields.name = fields.title;\n\t\t}\n\t\tif (Type.isNumber(fields.name) || Type.isStringFilled(fields.name))\n\t\t{\n\t\t\tresult.name = Utils.text.htmlspecialcharsback(fields.name.toString());\n\t\t}\n\n\t\tif (!Type.isUndefined(fields.owner))\n\t\t{\n\t\t\tfields.ownerId = fields.owner;\n\t\t}\n\t\tif (Type.isNumber(fields.ownerId) || Type.isStringFilled(fields.ownerId))\n\t\t{\n\t\t\tresult.owner = Number.parseInt(fields.ownerId, 10);\n\t\t}\n\n\t\tif (Type.isString(fields.avatar))\n\t\t{\n\t\t\tresult.avatar = this.prepareAvatar(fields.avatar);\n\t\t}\n\n\t\tif (Type.isStringFilled(fields.color))\n\t\t{\n\t\t\tresult.color = fields.color;\n\t\t}\n\n\t\tif (Type.isBoolean(fields.extranet))\n\t\t{\n\t\t\tresult.extranet = fields.extranet;\n\t\t}\n\n\t\tif (!Type.isUndefined(fields.entity_type))\n\t\t{\n\t\t\tfields.entityType = fields.entity_type;\n\t\t}\n\t\tif (Type.isStringFilled(fields.entityType))\n\t\t{\n\t\t\tresult.entityType = fields.entityType;\n\t\t}\n\t\tif (!Type.isUndefined(fields.entity_id))\n\t\t{\n\t\t\tfields.entityId = fields.entity_id;\n\t\t}\n\t\tif (Type.isNumber(fields.entityId) || Type.isStringFilled(fields.entityId))\n\t\t{\n\t\t\tresult.entityId = fields.entityId.toString();\n\t\t}\n\n\t\tif (!Type.isUndefined(fields.date_create))\n\t\t{\n\t\t\tfields.dateCreate = fields.date_create;\n\t\t}\n\t\tif (!Type.isUndefined(fields.dateCreate))\n\t\t{\n\t\t\tresult.dateCreate = Utils.date.cast(fields.dateCreate);\n\t\t}\n\n\t\tif (Type.isPlainObject(fields.public))\n\t\t{\n\t\t\tresult.public = {};\n\n\t\t\tif (Type.isStringFilled(fields.public.code))\n\t\t\t{\n\t\t\t\tresult.public.code = fields.public.code;\n\t\t\t}\n\n\t\t\tif (Type.isStringFilled(fields.public.link))\n\t\t\t{\n\t\t\t\tresult.public.link = fields.public.link;\n\t\t\t}\n\t\t}\n\n\t\tif (!Type.isUndefined(fields.readed_list))\n\t\t{\n\t\t\tfields.readList = fields.readed_list;\n\t\t}\n\t\tif (Type.isArray(fields.readList))\n\t\t{\n\t\t\tresult.readList = this.prepareReadList(fields.readList);\n\t\t}\n\n\t\tif (!Type.isUndefined(fields.writing_list))\n\t\t{\n\t\t\tfields.writingList = fields.writing_list;\n\t\t}\n\t\tif (Type.isArray(fields.writingList))\n\t\t{\n\t\t\tresult.writingList = this.prepareWritingList(fields.writingList);\n\t\t}\n\n\t\tif (!Type.isUndefined(fields.manager_list))\n\t\t{\n\t\t\tfields.managerList = fields.manager_list;\n\t\t}\n\t\tif (Type.isArray(fields.managerList))\n\t\t{\n\t\t\tresult.managerList = [];\n\n\t\t\tfields.managerList.forEach(userId =>\n\t\t\t{\n\t\t\t\tuserId = Number.parseInt(userId, 10);\n\t\t\t\tif (userId > 0)\n\t\t\t\t{\n\t\t\t\t\tresult.managerList.push(userId);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tif (!Type.isUndefined(fields.mute_list))\n\t\t{\n\t\t\tfields.muteList = fields.mute_list;\n\t\t}\n\t\tif (Type.isArray(fields.muteList) || Type.isPlainObject(fields.muteList))\n\t\t{\n\t\t\tresult.muteList = this.prepareMuteList(fields.muteList);\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tprepareAvatar(avatar: string): string\n\t{\n\t\tlet result = '';\n\n\t\tif (!avatar || avatar.endsWith('/js/im/images/blank.gif'))\n\t\t{\n\t\t\tresult = '';\n\t\t}\n\t\telse if (avatar.startsWith('http'))\n\t\t{\n\t\t\tresult = avatar;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tresult = this.store.state.application.common.host + avatar;\n\t\t}\n\n\t\tif (result)\n\t\t{\n\t\t\tresult = encodeURI(result);\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tprepareReadList(readList: Object[]): Object[]\n\t{\n\t\tconst result = [];\n\n\t\treadList.forEach(element =>\n\t\t{\n\t\t\tconst item = {};\n\t\t\tif (!Type.isUndefined(element.user_id))\n\t\t\t{\n\t\t\t\telement.userId = element.user_id;\n\t\t\t}\n\t\t\tif (!Type.isUndefined(element.user_name))\n\t\t\t{\n\t\t\t\telement.userName = element.user_name;\n\t\t\t}\n\t\t\tif (!Type.isUndefined(element.message_id))\n\t\t\t{\n\t\t\t\telement.messageId = element.message_id;\n\t\t\t}\n\n\t\t\tif (!element.userId || !element.userName || !element.messageId)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\titem.userId = Number.parseInt(element.userId, 10);\n\t\t\titem.userName = element.userName.toString();\n\t\t\titem.messageId = Number.parseInt(element.messageId, 10);\n\n\t\t\titem.date = Utils.date.cast(element.date);\n\n\t\t\tresult.push(item);\n\t\t});\n\n\t\treturn result;\n\t}\n\n\tprepareWritingList(writingList: Object[]): Object[]\n\t{\n\t\tconst result = [];\n\n\t\twritingList.forEach(element =>\n\t\t{\n\t\t\tconst item = {};\n\n\t\t\tif (!element.userId)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\titem.userId = Number.parseInt(element.userId, 10);\n\t\t\titem.userName = Utils.text.htmlspecialcharsback(element.userName);\n\n\t\t\tresult.push(item);\n\t\t});\n\n\t\treturn result;\n\t}\n\n\tprepareMuteList(muteList: Object[] | Object): Object[]\n\t{\n\t\tconst result = [];\n\n\t\tif (Type.isArray(muteList))\n\t\t{\n\t\t\tmuteList.forEach(userId =>\n\t\t\t{\n\t\t\t\tuserId = Number.parseInt(userId, 10);\n\t\t\t\tif (userId > 0)\n\t\t\t\t{\n\t\t\t\t\tresult.push(userId);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\telse if (Type.isPlainObject(muteList))\n\t\t{\n\t\t\tObject.entries(muteList).forEach(([key, value]) => {\n\t\t\t\tif (!value)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tconst userId = Number.parseInt(key, 10);\n\t\t\t\tif (userId > 0)\n\t\t\t\t{\n\t\t\t\t\tresult.push(userId);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tvalidateChatOptions(options: Object): Object\n\t{\n\t\tconst result = {};\n\n\t\tObject.entries(options).forEach(([type, typeOptions]) => {\n\t\t\tconst newType = Utils.text.convertSnakeToCamelCase(type.toLowerCase());\n\t\t\tresult[newType] = {};\n\t\t\tObject.entries(typeOptions).forEach(([key, value]) => {\n\t\t\t\tconst newKey = Utils.text.convertSnakeToCamelCase(key.toLowerCase());\n\t\t\t\tresult[newType][newKey] = value;\n\t\t\t});\n\t\t});\n\n\t\treturn result;\n\t}\n}","import {Type, Loc} from 'main.core';\nimport {BuilderModel} from 'ui.vue3.vuex';\nimport {Utils} from 'im.v2.lib.utils';\nimport {UserStatus, BotType} from 'im.v2.const';\n\nexport class UsersModel extends BuilderModel\n{\n\tgetName()\n\t{\n\t\treturn 'users';\n\t}\n\n\tgetState()\n\t{\n\t\treturn {\n\t\t\tcollection: {},\n\t\t\tonlineList: [],\n\t\t\tmobileOnlineList: [],\n\t\t\tabsentList: [],\n\t\t\tbotList: {}\n\t\t};\n\t}\n\n\tgetElementState(params = {})\n\t{\n\t\tconst {id = 0} = params;\n\n\t\treturn {\n\t\t\tid,\n\t\t\tname: '',\n\t\t\tfirstName: '',\n\t\t\tlastName: '',\n\t\t\tworkPosition: '',\n\t\t\tgender: 'M',\n\t\t\textranet: false,\n\t\t\tnetwork: false,\n\t\t\tbot: false,\n\t\t\tconnector: false,\n\t\t\texternalAuthId: 'default',\n\t\t\tstatus: '',\n\t\t\tidle: false,\n\t\t\tlastActivityDate: false,\n\t\t\tmobileLastDate: false,\n\t\t\tisOnline: false,\n\t\t\tisMobileOnline: false,\n\t\t\tbirthday: false,\n\t\t\tisBirthday: false,\n\t\t\tabsent: false,\n\t\t\tisAbsent: false,\n\t\t\tdepartments: [],\n\t\t\tphones: {\n\t\t\t\tworkPhone: '',\n\t\t\t\tpersonalMobile: '',\n\t\t\t\tpersonalPhone: '',\n\t\t\t\tinnerPhone: '',\n\t\t\t}\n\t\t};\n\t}\n\n\tgetGetters()\n\t{\n\t\treturn {\n\t\t\tget: state => (userId, getTemporary = false) =>\n\t\t\t{\n\t\t\t\tuserId = Number.parseInt(userId, 10);\n\n\t\t\t\tif (userId <= 0)\n\t\t\t\t{\n\t\t\t\t\tif (getTemporary)\n\t\t\t\t\t{\n\t\t\t\t\t\tuserId = 0;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\treturn null;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tconst user = state.collection[userId];\n\n\t\t\t\tif (!getTemporary && !user)\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t\telse if (getTemporary && !user)\n\t\t\t\t{\n\t\t\t\t\treturn this.getElementState({id: userId});\n\t\t\t\t}\n\n\t\t\t\treturn user;\n\t\t\t},\n\t\t\tgetBlank: () => params =>\n\t\t\t{\n\t\t\t\treturn this.getElementState(params);\n\t\t\t},\n\t\t\tgetList: state => (userList) => {\n\t\t\t\tconst result = [];\n\n\t\t\t\tif (!Array.isArray(userList))\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\tuserList.forEach(id => {\n\t\t\t\t\tif (state.collection[id])\n\t\t\t\t\t{\n\t\t\t\t\t\tresult.push(state.collection[id]);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tresult.push(this.getElementState({id}));\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\treturn result;\n\t\t\t},\n\t\t\thasBirthday: state => userId => {\n\t\t\t\tuserId = Number.parseInt(userId, 10);\n\n\t\t\t\tconst user = state.collection[userId];\n\t\t\t\tif (userId <= 0 || !user)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn user.isBirthday;\n\t\t\t},\n\t\t\tgetStatus: state => userId => {\n\t\t\t\tuserId = Number.parseInt(userId, 10);\n\n\t\t\t\tconst user = state.collection[userId];\n\t\t\t\tif (userId <= 0 || !user)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tif (!user.isOnline)\n\t\t\t\t{\n\t\t\t\t\treturn '';\n\t\t\t\t}\n\n\t\t\t\tif (user.isMobileOnline)\n\t\t\t\t{\n\t\t\t\t\treturn UserStatus.mobileOnline;\n\t\t\t\t}\n\t\t\t\telse if (user.idle)\n\t\t\t\t{\n\t\t\t\t\t// away by time\n\t\t\t\t\treturn UserStatus.idle;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\t// manually selected status (online, away, dnd, break)\n\t\t\t\t\treturn user.status;\n\t\t\t\t}\n\t\t\t},\n\t\t\tgetLastOnline: state => userId => {\n\t\t\t\tuserId = Number.parseInt(userId, 10);\n\n\t\t\t\tconst user = state.collection[userId];\n\t\t\t\tif (userId <= 0 || !user)\n\t\t\t\t{\n\t\t\t\t\treturn '';\n\t\t\t\t}\n\n\t\t\t\treturn Utils.user.getLastDateText(user);\n\t\t\t},\n\t\t\tgetPosition: state => userId => {\n\t\t\t\tuserId = Number.parseInt(userId, 10);\n\n\t\t\t\tconst user = state.collection[userId];\n\t\t\t\tif (userId <= 0 || !user)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tif (user.workPosition)\n\t\t\t\t{\n\t\t\t\t\treturn user.workPosition;\n\t\t\t\t}\n\n\t\t\t\treturn Loc.getMessage('IM_MODEL_USERS_DEFAULT_NAME');\n\t\t\t},\n\t\t\tgetBotType: state => userId => {\n\t\t\t\tuserId = Number.parseInt(userId, 10);\n\n\t\t\t\tconst user = state.collection[userId];\n\t\t\t\tif (userId <= 0 || !user || !user.bot || !state.botList[userId])\n\t\t\t\t{\n\t\t\t\t\treturn '';\n\t\t\t\t}\n\n\t\t\t\tconst botType = state.botList[userId].type;\n\n\t\t\t\tif (!BotType[botType])\n\t\t\t\t{\n\t\t\t\t\treturn BotType.bot;\n\t\t\t\t}\n\n\t\t\t\treturn botType;\n\t\t\t}\n\t\t};\n\t}\n\n\tgetActions()\n\t{\n\t\treturn {\n\t\t\tset: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (!Array.isArray(payload) && Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\tpayload = [payload];\n\t\t\t\t}\n\n\t\t\t\tpayload.map(user => {\n\t\t\t\t\treturn this.validate(user);\n\t\t\t\t}).forEach(user => {\n\t\t\t\t\tconst existingUser = store.state.collection[user.id];\n\t\t\t\t\tif (existingUser)\n\t\t\t\t\t{\n\t\t\t\t\t\tstore.commit('update', {\n\t\t\t\t\t\t\tid: user.id,\n\t\t\t\t\t\t\tfields: user\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tstore.commit('add', {\n\t\t\t\t\t\t\tid: user.id,\n\t\t\t\t\t\t\tfields: {...this.getElementState(), ...user}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\t\t\tadd: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (!Array.isArray(payload) && Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\tpayload = [payload];\n\t\t\t\t}\n\n\t\t\t\tpayload.map(user => {\n\t\t\t\t\treturn this.validate(user);\n\t\t\t\t}).forEach(user => {\n\t\t\t\t\tconst existingUser = store.state.collection[user.id];\n\t\t\t\t\tif (!existingUser)\n\t\t\t\t\t{\n\t\t\t\t\t\tstore.commit('add', {\n\t\t\t\t\t\t\tid: user.id,\n\t\t\t\t\t\t\tfields: {...this.getElementState(), ...user}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\t\t\tupdate: (store, payload) =>\n\t\t\t{\n\t\t\t\tpayload.id = Number.parseInt(payload.id, 10);\n\n\t\t\t\tconst user = store.state.collection[payload.id];\n\t\t\t\tif (!user)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tid: payload.id,\n\t\t\t\t\tfields: this.validate(payload.fields)\n\t\t\t\t});\n\t\t\t},\n\t\t\tdelete: (store, payload) =>\n\t\t\t{\n\t\t\t\tstore.commit('delete', payload.id);\n\t\t\t},\n\t\t\tsetBotList: (store, payload) =>\n\t\t\t{\n\t\t\t\tstore.commit('setBotList', payload);\n\t\t\t}\n\t\t};\n\t}\n\n\tgetMutations()\n\t{\n\t\treturn {\n\t\t\tadd: (state, payload) =>\n\t\t\t{\n\t\t\t\tstate.collection[payload.id] = payload.fields;\n\t\t\t\tconst user = state.collection[payload.id];\n\n\t\t\t\tif (Utils.user.isOnline(user.lastActivityDate))\n\t\t\t\t{\n\t\t\t\t\tuser.isOnline = true;\n\t\t\t\t\tthis.addToOnlineList(user.id);\n\t\t\t\t}\n\n\t\t\t\tif (Utils.user.isMobileOnline(user.lastActivityDate, user.mobileLastDate))\n\t\t\t\t{\n\t\t\t\t\tuser.isMobileOnline = true;\n\t\t\t\t\tthis.addToMobileOnlineList(user.id);\n\t\t\t\t}\n\n\t\t\t\tif (user.birthday && Utils.user.isBirthdayToday(user.birthday))\n\t\t\t\t{\n\t\t\t\t\tuser.isBirthday = true;\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tuser.isBirthday = false;\n\t\t\t\t\t}, Utils.date.getTimeToNextMidnight());\n\t\t\t\t}\n\n\t\t\t\tif (user.absent)\n\t\t\t\t{\n\t\t\t\t\tuser.isAbsent = true;\n\t\t\t\t\tthis.addToAbsentList(user.id);\n\t\t\t\t}\n\n\t\t\t\tthis.startOnlineCheckInterval();\n\t\t\t\tthis.startAbsentCheckInterval();\n\t\t\t},\n\t\t\tupdate: (state, payload) =>\n\t\t\t{\n\t\t\t\tconst user = state.collection[payload.id];\n\t\t\t\tif (Utils.user.isOnline(payload.fields.lastActivityDate))\n\t\t\t\t{\n\t\t\t\t\tuser.isOnline = true;\n\t\t\t\t\tthis.addToOnlineList(payload.fields.id);\n\t\t\t\t}\n\n\t\t\t\tif (Utils.user.isMobileOnline(payload.fields.lastActivityDate, payload.fields.mobileLastDate))\n\t\t\t\t{\n\t\t\t\t\tuser.isMobileOnline = true;\n\t\t\t\t\tthis.addToMobileOnlineList(payload.fields.id);\n\t\t\t\t}\n\n\t\t\t\tif (payload.fields.absent === false)\n\t\t\t\t{\n\t\t\t\t\tstate.absentList = state.absentList.filter(element => {\n\t\t\t\t\t\treturn element !== payload.id;\n\t\t\t\t\t});\n\t\t\t\t\tstate.collection[payload.id].isAbsent = false;\n\t\t\t\t}\n\t\t\t\telse if (Type.isDate(payload.fields.absent))\n\t\t\t\t{\n\t\t\t\t\tstate.collection[payload.id].isAbsent = true;\n\t\t\t\t\tthis.addToAbsentList(payload.id);\n\t\t\t\t}\n\n\t\t\t\tstate.collection[payload.id] = {...state.collection[payload.id], ...payload.fields};\n\t\t\t},\n\t\t\tdelete: (state, payload) =>\n\t\t\t{\n\t\t\t\tdelete state.collection[payload.id];\n\t\t\t},\n\t\t\tsetBotList: (state, payload) =>\n\t\t\t{\n\t\t\t\tstate.botList = payload;\n\t\t\t}\n\t\t};\n\t}\n\n\tvalidate(fields)\n\t{\n\t\tconst result = {};\n\n\t\tif (Type.isNumber(fields.id) || Type.isString(fields.id))\n\t\t{\n\t\t\tresult.id = Number.parseInt(fields.id, 10);\n\t\t}\n\n\t\tif (Type.isStringFilled(fields.first_name))\n\t\t{\n\t\t\tfields.firstName = fields.first_name;\n\t\t}\n\t\tif (Type.isStringFilled(fields.last_name))\n\t\t{\n\t\t\tfields.lastName = fields.last_name;\n\t\t}\n\t\tif (Type.isStringFilled(fields.firstName))\n\t\t{\n\t\t\tresult.firstName = Utils.text.htmlspecialcharsback(fields.firstName);\n\t\t}\n\t\tif (Type.isStringFilled(fields.lastName))\n\t\t{\n\t\t\tresult.lastName = Utils.text.htmlspecialcharsback(fields.lastName);\n\t\t}\n\t\tif (Type.isStringFilled(fields.name))\n\t\t{\n\t\t\tfields.name = Utils.text.htmlspecialcharsback(fields.name);\n\t\t\tresult.name = fields.name;\n\t\t}\n\n\t\tif (Type.isStringFilled(fields.work_position))\n\t\t{\n\t\t\tfields.workPosition = fields.work_position;\n\t\t}\n\t\tif (Type.isStringFilled(fields.workPosition))\n\t\t{\n\t\t\tresult.workPosition = Utils.text.htmlspecialcharsback(fields.workPosition);\n\t\t}\n\n\t\tif (Type.isStringFilled(fields.gender))\n\t\t{\n\t\t\tresult.gender = fields.gender === 'F'? 'F': 'M';\n\t\t}\n\n\t\tif (Type.isStringFilled(fields.birthday))\n\t\t{\n\t\t\tresult.birthday = fields.birthday;\n\t\t}\n\n\t\tif (Type.isBoolean(fields.extranet))\n\t\t{\n\t\t\tresult.extranet = fields.extranet;\n\t\t}\n\n\t\tif (Type.isBoolean(fields.network))\n\t\t{\n\t\t\tresult.network = fields.network;\n\t\t}\n\n\t\tif (Type.isBoolean(fields.bot))\n\t\t{\n\t\t\tresult.bot = fields.bot;\n\t\t}\n\n\t\tif (Type.isBoolean(fields.connector))\n\t\t{\n\t\t\tresult.connector = fields.connector;\n\t\t}\n\n\t\tif (Type.isStringFilled(fields.external_auth_id))\n\t\t{\n\t\t\tfields.externalAuthId = fields.external_auth_id;\n\t\t}\n\t\tif (Type.isStringFilled(fields.externalAuthId))\n\t\t{\n\t\t\tresult.externalAuthId = fields.externalAuthId;\n\t\t}\n\n\t\tif (Type.isStringFilled(fields.status))\n\t\t{\n\t\t\tresult.status = fields.status;\n\t\t}\n\n\t\tif (!Type.isUndefined(fields.idle))\n\t\t{\n\t\t\tresult.idle = Utils.date.cast(fields.idle, false);\n\t\t}\n\t\tif (!Type.isUndefined(fields.last_activity_date))\n\t\t{\n\t\t\tfields.lastActivityDate = fields.last_activity_date;\n\t\t}\n\t\tif (!Type.isUndefined(fields.lastActivityDate))\n\t\t{\n\t\t\tresult.lastActivityDate = Utils.date.cast(fields.lastActivityDate, false);\n\t\t}\n\t\tif (!Type.isUndefined(fields.mobile_last_date))\n\t\t{\n\t\t\tfields.mobileLastDate = fields.mobile_last_date;\n\t\t}\n\t\tif (!Type.isUndefined(fields.mobileLastDate))\n\t\t{\n\t\t\tresult.mobileLastDate = Utils.date.cast(fields.mobileLastDate, false);\n\t\t}\n\n\t\tif (!Type.isUndefined(fields.absent))\n\t\t{\n\t\t\tresult.absent = Utils.date.cast(fields.absent, false);\n\t\t}\n\n\t\tif (Array.isArray(fields.departments))\n\t\t{\n\t\t\tresult.departments = [];\n\t\t\tfields.departments.forEach(departmentId =>\n\t\t\t{\n\t\t\t\tdepartmentId = Number.parseInt(departmentId, 10);\n\t\t\t\tif (departmentId > 0)\n\t\t\t\t{\n\t\t\t\t\tresult.departments.push(departmentId);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tif (Type.isPlainObject(fields.phones))\n\t\t{\n\t\t\tresult.phones = this.preparePhones(fields.phones);\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tpreparePhones(phones): Object\n\t{\n\t\tconst result = {};\n\n\t\tif (!Type.isUndefined(phones.work_phone))\n\t\t{\n\t\t\tphones.workPhone = phones.work_phone;\n\t\t}\n\t\tif (Type.isStringFilled(phones.workPhone) || Type.isNumber(phones.workPhone))\n\t\t{\n\t\t\tresult.workPhone =phones.workPhone.toString();\n\t\t}\n\n\t\tif (!Type.isUndefined(phones.personal_mobile))\n\t\t{\n\t\t\tphones.personalMobile = phones.personal_mobile;\n\t\t}\n\t\tif (Type.isStringFilled(phones.personalMobile) || Type.isNumber(phones.personalMobile))\n\t\t{\n\t\t\tresult.personalMobile = phones.personalMobile.toString();\n\t\t}\n\n\t\tif (!Type.isUndefined(phones.personal_phone))\n\t\t{\n\t\t\tphones.personalPhone = phones.personal_phone;\n\t\t}\n\t\tif (Type.isStringFilled(phones.personalPhone) || Type.isNumber(phones.personalPhone))\n\t\t{\n\t\t\tresult.personalPhone = phones.personalPhone.toString();\n\t\t}\n\n\t\tif (!Type.isUndefined(phones.inner_phone))\n\t\t{\n\t\t\tphones.innerPhone = phones.inner_phone;\n\t\t}\n\t\tif (Type.isStringFilled(phones.innerPhone) || Type.isNumber(phones.innerPhone))\n\t\t{\n\t\t\tresult.innerPhone = phones.innerPhone.toString();\n\t\t}\n\n\t\treturn result;\n\t}\n\n\taddToOnlineList(id)\n\t{\n\t\tconst state = this.store.state.users;\n\t\tif (!state.onlineList.includes(id))\n\t\t{\n\t\t\tstate.onlineList.push(id);\n\t\t}\n\t}\n\n\taddToMobileOnlineList(id)\n\t{\n\t\tconst state = this.store.state.users;\n\t\tif (!state.mobileOnlineList.includes(id))\n\t\t{\n\t\t\tstate.mobileOnlineList.push(id);\n\t\t}\n\t}\n\n\taddToAbsentList(id)\n\t{\n\t\tconst state = this.store.state.users;\n\t\tif (!state.absentList.includes(id))\n\t\t{\n\t\t\tstate.absentList.push(id);\n\t\t}\n\t}\n\n\tstartAbsentCheckInterval()\n\t{\n\t\tif (this.absentCheckInterval)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tconst TIME_TO_NEXT_DAY = 1000*60*60*24;\n\t\tthis.absentCheckInterval = setTimeout(() => {\n\t\t\tsetInterval(() => {\n\t\t\t\tconst state = this.store.state.users;\n\t\t\t\tstate.absentList.forEach(userId => {\n\t\t\t\t\tconst user = state.collection[userId];\n\t\t\t\t\tif (!user)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tconst currentTime = Date.now();\n\t\t\t\t\tconst absentEnd = new Date(user.absent).getTime();\n\n\t\t\t\t\tif (absentEnd <= currentTime)\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.absentList = state.absentList.filter(element => {\n\t\t\t\t\t\t\treturn element !== userId;\n\t\t\t\t\t\t});\n\t\t\t\t\t\tuser.isAbsent = false;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}, TIME_TO_NEXT_DAY);\n\t\t}, Utils.date.getTimeToNextMidnight());\n\t}\n\n\tstartOnlineCheckInterval()\n\t{\n\t\tif (this.onlineCheckInterval)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tconst ONE_MINUTE = 60000;\n\t\tthis.onlineCheckInterval = setInterval(() => {\n\t\t\tconst state = this.store.state.users;\n\n\t\t\tstate.onlineList.forEach(userId => {\n\t\t\t\tconst user = state.collection[userId];\n\t\t\t\tif (!user)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (Utils.user.isOnline(user.lastActivityDate))\n\t\t\t\t{\n\t\t\t\t\tuser.isOnline = true;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tuser.isOnline = false;\n\t\t\t\t\tstate.onlineList = state.onlineList.filter(element => element !== userId);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tstate.mobileOnlineList.forEach(userId => {\n\t\t\t\tconst user = state.collection[userId];\n\t\t\t\tif (!user)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (Utils.user.isMobileOnline(user.lastActivityDate, user.mobileLastDate))\n\t\t\t\t{\n\t\t\t\t\tuser.isMobileOnline = true;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tuser.isMobileOnline = false;\n\t\t\t\t\tstate.mobileOnlineList = state.mobileOnlineList.filter(element => element !== userId);\n\t\t\t\t}\n\t\t\t});\n\t\t}, ONE_MINUTE);\n\t}\n}","import {BuilderModel} from 'ui.vue3.vuex';\nimport {FileStatus, FileType, MutationType} from 'im.v2.const';\nimport {Utils} from 'im.v2.lib.utils';\n\nexport class FilesModel extends BuilderModel\n{\n\tstatic maxDiskFileSize = 5242880;\n\n\tgetName()\n\t{\n\t\treturn 'files';\n\t}\n\n\tgetState()\n\t{\n\t\treturn {\n\t\t\tcreated: 0,\n\t\t\tcollection: {},\n\t\t\tindex: {},\n\t\t};\n\t}\n\n\tgetElementState(params = {})\n\t{\n\t\tconst {\n\t\t\tid = 0,\n\t\t\tchatId = 0,\n\t\t\tname = 'File is deleted',\n\t\t} = params;\n\n\t\treturn {\n\t\t\tid,\n\t\t\tchatId,\n\t\t\tname,\n\t\t\ttemplateId: id,\n\t\t\tdate: new Date(),\n\t\t\ttype: 'file',\n\t\t\textension: \"\",\n\t\t\ticon: \"empty\",\n\t\t\tsize: 0,\n\t\t\timage: false,\n\t\t\tstatus: FileStatus.done,\n\t\t\tprogress: 100,\n\t\t\tauthorId: 0,\n\t\t\tauthorName: \"\",\n\t\t\turlPreview: \"\",\n\t\t\turlShow: \"\",\n\t\t\turlDownload: \"\",\n\t\t\tinit: false,\n\t\t\tviewerAttrs: {}\n\t\t};\n\t}\n\n\tgetGetters()\n\t{\n\t\treturn {\n\t\t\tget: state => (chatId, fileId, getTemporary = false) =>\n\t\t\t{\n\t\t\t\tif (!chatId || !fileId)\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\tif (!state.index[chatId] || !state.index[chatId][fileId])\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\tif (!getTemporary && !state.index[chatId][fileId].init)\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\treturn state.index[chatId][fileId];\n\t\t\t},\n\t\t\tgetList: state => chatId =>\n\t\t\t{\n\t\t\t\tif (!state.index[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\treturn state.index[chatId];\n\t\t\t},\n\t\t\tgetBlank: state => params =>\n\t\t\t{\n\t\t\t\treturn this.getElementState(params);\n\t\t\t}\n\t\t}\n\t}\n\n\tgetActions()\n\t{\n\t\treturn {\n\t\t\tadd: (store, payload) =>\n\t\t\t{\n\t\t\t\tlet result = this.validate(Object.assign({}, payload));\n\t\t\t\tif (payload.id)\n\t\t\t\t{\n\t\t\t\t\tresult.id = payload.id;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tresult.id = 'temporary' + (new Date).getTime() + store.state.created;\n\t\t\t\t}\n\t\t\t\tresult.templateId = result.id;\n\t\t\t\tresult.init = true;\n\n\t\t\t\tstore.commit('add', Object.assign({}, this.getElementState(), result));\n\n\t\t\t\treturn result.id;\n\t\t\t},\n\t\t\tset: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (payload instanceof Array)\n\t\t\t\t{\n\t\t\t\t\tpayload = payload.map(file => {\n\t\t\t\t\t\tlet result = this.validate(Object.assign({}, file));\n\t\t\t\t\t\tresult.templateId = result.id;\n\t\t\t\t\t\treturn Object.assign({}, this.getElementState(), result, {init: true});\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tlet result = this.validate(Object.assign({}, payload));\n\t\t\t\t\tresult.templateId = result.id;\n\t\t\t\t\tpayload = [];\n\t\t\t\t\tpayload.push(\n\t\t\t\t\t\tObject.assign({}, this.getElementState(), result, {init: true})\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\tstore.commit('set', {\n\t\t\t\t\tinsertType : MutationType.setAfter,\n\t\t\t\t\tdata : payload\n\t\t\t\t});\n\t\t\t},\n\t\t\tsetBefore: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (payload instanceof Array)\n\t\t\t\t{\n\t\t\t\t\tpayload = payload.map(file => {\n\t\t\t\t\t\tlet result = this.validate(Object.assign({}, file));\n\t\t\t\t\t\tresult.templateId = result.id;\n\t\t\t\t\t\treturn Object.assign({}, this.getElementState(), result, {init: true});\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tlet result = this.validate(Object.assign({}, payload));\n\t\t\t\t\tresult.templateId = result.id;\n\t\t\t\t\tpayload = [];\n\t\t\t\t\tpayload.push(\n\t\t\t\t\t\tObject.assign({}, this.getElementState(), result, {init: true})\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\tstore.commit('set', {\n\t\t\t\t\tactionName: 'setBefore',\n\t\t\t\t\tinsertType : MutationType.setBefore,\n\t\t\t\t\tdata : payload\n\t\t\t\t});\n\t\t\t},\n\t\t\tupdate: (store, payload) =>\n\t\t\t{\n\t\t\t\tlet result = this.validate(Object.assign({}, payload.fields));\n\n\t\t\t\tstore.commit('initCollection', {chatId: payload.chatId});\n\n\t\t\t\tlet index = store.state.collection[payload.chatId].findIndex(el => el.id === payload.id);\n\t\t\t\tif (index < 0)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tid : payload.id,\n\t\t\t\t\tchatId : payload.chatId,\n\t\t\t\t\tindex : index,\n\t\t\t\t\tfields : result\n\t\t\t\t});\n\n\t\t\t\tif (payload.fields.blink)\n\t\t\t\t{\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tstore.commit('update', {\n\t\t\t\t\t\t\tid : payload.id ,\n\t\t\t\t\t\t\tchatId : payload.chatId,\n\t\t\t\t\t\t\tfields : {blink: false}\n\t\t\t\t\t\t});\n\t\t\t\t\t}, 1000);\n\t\t\t\t}\n\n\t\t\t\treturn true;\n\t\t\t},\n\t\t\tdelete: (store, payload) =>\n\t\t\t{\n\t\t\t\tstore.commit('delete', {\n\t\t\t\t\tid : payload.id,\n\t\t\t\t\tchatId : payload.chatId\n\t\t\t\t});\n\t\t\t\treturn true;\n\t\t\t},\n\t\t\tsaveState: (store, payload) =>\n\t\t\t{\n\t\t\t\tstore.commit('saveState', {});\n\t\t\t\treturn true;\n\t\t\t},\n\t\t}\n\t}\n\n\tgetMutations()\n\t{\n\t\treturn {\n\t\t\tinitCollection: (state, payload) =>\n\t\t\t{\n\t\t\t\tthis.initCollection(state, payload);\n\t\t\t},\n\t\t\tadd: (state, payload) =>\n\t\t\t{\n\t\t\t\tthis.initCollection(state, payload);\n\n\t\t\t\tstate.collection[payload.chatId].push(payload);\n\t\t\t\tstate.index[payload.chatId][payload.id] = payload;\n\n\t\t\t\tstate.created += 1;\n\n\t\t\t\tthis.saveState(state);\n\t\t\t},\n\t\t\tset: (state, payload) =>\n\t\t\t{\n\t\t\t\tfor (let element of payload.data)\n\t\t\t\t{\n\t\t\t\t\tthis.initCollection(state, {chatId: element.chatId});\n\n\t\t\t\t\tlet index = state.collection[element.chatId].findIndex(el => el.id === element.id);\n\t\t\t\t\tif (index > -1)\n\t\t\t\t\t{\n\t\t\t\t\t\tdelete element.templateId;\n\t\t\t\t\t\tstate.collection[element.chatId][index] = Object.assign(state.collection[element.chatId][index], element);\n\t\t\t\t\t}\n\t\t\t\t\telse if (payload.insertType === MutationType.setBefore)\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.collection[element.chatId].unshift(element);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.collection[element.chatId].push(element);\n\t\t\t\t\t}\n\n\t\t\t\t\tstate.index[element.chatId][element.id] = element;\n\n\t\t\t\t\tthis.saveState(state);\n\t\t\t\t}\n\t\t\t},\n\t\t\tupdate: (state, payload) =>\n\t\t\t{\n\t\t\t\tthis.initCollection(state, payload);\n\n\t\t\t\tlet index = -1;\n\t\t\t\tif (typeof payload.index !== 'undefined' && state.collection[payload.chatId][payload.index])\n\t\t\t\t{\n\t\t\t\t\tindex = payload.index;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tindex = state.collection[payload.chatId].findIndex(el => el.id === payload.id);\n\t\t\t\t}\n\n\t\t\t\tif (index >= 0)\n\t\t\t\t{\n\t\t\t\t\tdelete payload.fields.templateId;\n\t\t\t\t\tlet element = Object.assign(\n\t\t\t\t\t\tstate.collection[payload.chatId][index],\n\t\t\t\t\t\tpayload.fields\n\t\t\t\t\t);\n\t\t\t\t\tstate.collection[payload.chatId][index] = element;\n\t\t\t\t\tstate.index[payload.chatId][element.id] = element;\n\n\t\t\t\t\tthis.saveState(state);\n\t\t\t\t}\n\t\t\t},\n\t\t\tdelete: (state, payload) =>\n\t\t\t{\n\t\t\t\tthis.initCollection(state, payload);\n\n\t\t\t\tstate.collection[payload.chatId] = state.collection[payload.chatId].filter(element => element.id !== payload.id);\n\t\t\t\tdelete state.index[payload.chatId][payload.id];\n\n\t\t\t\tthis.saveState(state);\n\t\t\t},\n\t\t\tsaveState: (state, payload) =>\n\t\t\t{\n\t\t\t\tthis.saveState(state);\n\t\t\t},\n\t\t}\n\t}\n\n\tinitCollection(state, payload)\n\t{\n\t\tif (typeof state.collection[payload.chatId] !== 'undefined')\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tstate.collection[payload.chatId] = [];\n\t\tstate.index[payload.chatId] = [];\n\n\t\treturn true;\n\t}\n\n\tgetLoadedState(state)\n\t{\n\t\tif (!state || typeof state !== 'object')\n\t\t{\n\t\t\treturn state;\n\t\t}\n\n\t\tif (typeof state.collection !== 'object')\n\t\t{\n\t\t\treturn state;\n\t\t}\n\n\t\tstate.index = {};\n\n\t\tfor (let chatId in state.collection)\n\t\t{\n\t\t\tif (!state.collection.hasOwnProperty(chatId))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tstate.index[chatId] = {};\n\n\t\t\tstate.collection[chatId]\n\t\t\t\t.filter(file => file != null)\n\t\t\t\t.forEach(file => {\n\t\t\t\t\tstate.index[chatId][file.id] = file;\n\t\t\t});\n\t\t}\n\n\t\treturn state;\n\t}\n\n\tgetSaveFileList()\n\t{\n\t\tif (!this.db)\n\t\t{\n\t\t\treturn [];\n\t\t}\n\n\t\tif (!this.store.getters['messages/getSaveFileList'])\n\t\t{\n\t\t\treturn [];\n\t\t}\n\n\t\tlet list = this.store.getters['messages/getSaveFileList']();\n\t\tif (!list)\n\t\t{\n\t\t\treturn [];\n\t\t}\n\n\t\treturn list;\n\t}\n\n\tgetSaveTimeout()\n\t{\n\t\treturn 250;\n\t}\n\n\tsaveState(state)\n\t{\n\t\tif (!this.isSaveAvailable())\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tsuper.saveState(() =>\n\t\t{\n\t\t\tlet list = this.getSaveFileList();\n\t\t\tif (!list)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tlet storedState = {\n\t\t\t\tcollection: {},\n\t\t\t};\n\n\t\t\tfor (let chatId in list)\n\t\t\t{\n\t\t\t\tif (!list.hasOwnProperty(chatId))\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tlist[chatId].forEach(fileId =>\n\t\t\t\t{\n\t\t\t\t\tif (!state.index[chatId])\n\t\t\t\t\t{\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!state.index[chatId][fileId])\n\t\t\t\t\t{\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!storedState.collection[chatId])\n\t\t\t\t\t{\n\t\t\t\t\t\tstoredState.collection[chatId] = [];\n\t\t\t\t\t}\n\n\t\t\t\t\tstoredState.collection[chatId].push(\n\t\t\t\t\t\tstate.index[chatId][fileId]\n\t\t\t\t\t);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn storedState;\n\t\t});\n\t}\n\n\tvalidate(fields, options = {})\n\t{\n\t\tconst result = {};\n\n\t\tif (typeof fields.id === \"number\")\n\t\t{\n\t\t\tresult.id = fields.id;\n\t\t}\n\t\telse if (typeof fields.id === \"string\")\n\t\t{\n\t\t\tif (fields.id.startsWith('temporary'))\n\t\t\t{\n\t\t\t\tresult.id = fields.id;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresult.id = parseInt(fields.id);\n\t\t\t}\n\t\t}\n\n\t\tif (typeof fields.templateId === \"number\")\n\t\t{\n\t\t\tresult.templateId = fields.templateId;\n\t\t}\n\t\telse if (typeof fields.templateId === \"string\")\n\t\t{\n\t\t\tif (fields.templateId.startsWith('temporary'))\n\t\t\t{\n\t\t\t\tresult.templateId = fields.templateId;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresult.templateId = parseInt(fields.templateId);\n\t\t\t}\n\t\t}\n\n\t\tif (typeof fields.chatId === \"number\" || typeof fields.chatId === \"string\")\n\t\t{\n\t\t\tresult.chatId = parseInt(fields.chatId);\n\t\t}\n\n\t\tif (typeof fields.date !== \"undefined\")\n\t\t{\n\t\t\tresult.date = Utils.date.cast(fields.date);\n\t\t}\n\n\t\tif (typeof fields.type === \"string\")\n\t\t{\n\t\t\tresult.type = fields.type;\n\t\t}\n\n\t\tif (typeof fields.extension === \"string\")\n\t\t{\n\t\t\tresult.extension = fields.extension.toString();\n\n\t\t\tif (result.type === 'image')\n\t\t\t{\n\t\t\t\tresult.icon = 'img';\n\t\t\t}\n\t\t\telse if (result.type === 'video')\n\t\t\t{\n\t\t\t\tresult.icon = 'mov';\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresult.icon = FilesModel.getIconType(result.extension);\n\t\t\t}\n\t\t}\n\n\t\tif (typeof fields.name === \"string\" || typeof fields.name === \"number\")\n\t\t{\n\t\t\tresult.name = fields.name.toString();\n\t\t}\n\n\n\t\tif (typeof fields.size === \"number\" || typeof fields.size === \"string\")\n\t\t{\n\t\t\tresult.size = parseInt(fields.size);\n\t\t}\n\n\t\tif (typeof fields.image === 'boolean')\n\t\t{\n\t\t\tresult.image = false;\n\t\t}\n\t\telse if (typeof fields.image === 'object' && fields.image)\n\t\t{\n\t\t\tresult.image = {\n\t\t\t\twidth: 0,\n\t\t\t\theight: 0,\n\t\t\t};\n\n\t\t\tif (typeof fields.image.width === \"string\" || typeof fields.image.width === \"number\")\n\t\t\t{\n\t\t\t\tresult.image.width = parseInt(fields.image.width);\n\t\t\t}\n\t\t\tif (typeof fields.image.height === \"string\" || typeof fields.image.height === \"number\")\n\t\t\t{\n\t\t\t\tresult.image.height = parseInt(fields.image.height);\n\t\t\t}\n\n\t\t\tif (result.image.width <= 0 || result.image.height <= 0)\n\t\t\t{\n\t\t\t\tresult.image = false;\n\t\t\t}\n\t\t}\n\n\t\tif (typeof fields.status === \"string\" && typeof FileStatus[fields.status] !== 'undefined')\n\t\t{\n\t\t\tresult.status = fields.status;\n\t\t}\n\n\t\tif (typeof fields.progress === \"number\" || typeof fields.progress === \"string\")\n\t\t{\n\t\t\tresult.progress = parseInt(fields.progress);\n\t\t}\n\n\t\tif (typeof fields.authorId === \"number\" || typeof fields.authorId === \"string\")\n\t\t{\n\t\t\tresult.authorId = parseInt(fields.authorId);\n\t\t}\n\n\t\tif (typeof fields.authorName === \"string\" || typeof fields.authorName === \"number\")\n\t\t{\n\t\t\tresult.authorName = fields.authorName.toString();\n\t\t}\n\n\t\tif (typeof fields.urlPreview === 'string')\n\t\t{\n\t\t\tif (\n\t\t\t\t!fields.urlPreview\n\t\t\t\t|| fields.urlPreview.startsWith('http')\n\t\t\t\t|| fields.urlPreview.startsWith('bx')\n\t\t\t\t|| fields.urlPreview.startsWith('file')\n\t\t\t\t|| fields.urlPreview.startsWith('blob')\n\t\t\t)\n\t\t\t{\n\t\t\t\tresult.urlPreview = fields.urlPreview;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresult.urlPreview = this.store.state.application.common.host + fields.urlPreview;\n\t\t\t}\n\t\t}\n\n\t\tif (typeof fields.urlDownload === 'string')\n\t\t{\n\t\t\tif (\n\t\t\t\t!fields.urlDownload\n\t\t\t\t|| fields.urlDownload.startsWith('http')\n\t\t\t\t|| fields.urlDownload.startsWith('bx')\n\t\t\t\t|| fields.urlPreview.startsWith('file')\n\t\t\t)\n\t\t\t{\n\t\t\t\tresult.urlDownload = fields.urlDownload;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresult.urlDownload = this.store.state.application.common.host + fields.urlDownload;\n\t\t\t}\n\t\t}\n\n\t\tif (typeof fields.urlShow === 'string')\n\t\t{\n\t\t\tif (\n\t\t\t\t!fields.urlShow\n\t\t\t\t|| fields.urlShow.startsWith('http')\n\t\t\t\t|| fields.urlShow.startsWith('bx')\n\t\t\t\t|| fields.urlShow.startsWith('file')\n\t\t\t)\n\t\t\t{\n\t\t\t\tresult.urlShow = fields.urlShow;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresult.urlShow = this.store.state.application.common.host + fields.urlShow;\n\t\t\t}\n\t\t}\n\n\t\tif (typeof fields.viewerAttrs === 'object')\n\t\t{\n\t\t\tif (result.type === 'image' && !Utils.platform.isBitrixMobile())\n\t\t\t{\n\t\t\t\tresult.viewerAttrs = fields.viewerAttrs;\n\t\t\t}\n\n\t\t\tif (result.type === 'video' && !Utils.platform.isBitrixMobile() && result.size > FilesModel.maxDiskFileSize)\n\t\t\t{\n\t\t\t\tresult.viewerAttrs = fields.viewerAttrs;\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tstatic getType(type)\n\t{\n\t\ttype = type.toString().toLowerCase().split('.').splice(-1)[0];\n\n\t\tswitch(type)\n\t\t{\n\t\t\tcase 'png':\n\t\t\tcase 'jpe':\n\t\t\tcase 'jpg':\n\t\t\tcase 'jpeg':\n\t\t\tcase 'gif':\n\t\t\tcase 'heic':\n\t\t\tcase 'bmp':\n\t\t\tcase 'webp':\n\t\t\t\treturn FileType.image;\n\n\t\t\tcase 'mp4':\n\t\t\tcase 'mkv':\n\t\t\tcase 'webm':\n\t\t\tcase 'mpeg':\n\t\t\tcase 'hevc':\n\t\t\tcase 'avi':\n\t\t\tcase '3gp':\n\t\t\tcase 'flv':\n\t\t\tcase 'm4v':\n\t\t\tcase 'ogg':\n\t\t\tcase 'wmv':\n\t\t\tcase 'mov':\n\t\t\t\treturn FileType.video;\n\n\t\t\tcase 'mp3':\n\t\t\t\treturn FileType.audio;\n\t\t}\n\n\t\treturn FileType.file\n\t}\n\n\tstatic getIconType(extension)\n\t{\n\t\tlet icon = 'empty';\n\n\t\tswitch(extension.toString())\n\t\t{\n\t\t\tcase 'png':\n\t\t\tcase 'jpe':\n\t\t\tcase 'jpg':\n\t\t\tcase 'jpeg':\n\t\t\tcase 'gif':\n\t\t\tcase 'heic':\n\t\t\tcase 'bmp':\n\t\t\tcase 'webp':\n\t\t\t\ticon = 'img';\n\t\t\t\tbreak;\n\n\t\t\tcase 'mp4':\n\t\t\tcase 'mkv':\n\t\t\tcase 'webm':\n\t\t\tcase 'mpeg':\n\t\t\tcase 'hevc':\n\t\t\tcase 'avi':\n\t\t\tcase '3gp':\n\t\t\tcase 'flv':\n\t\t\tcase 'm4v':\n\t\t\tcase 'ogg':\n\t\t\tcase 'wmv':\n\t\t\tcase 'mov':\n\t\t\t\ticon = 'mov';\n\t\t\t\tbreak;\n\n\t\t\tcase 'txt':\n\t\t\t\ticon = 'txt';\n\t\t\t\tbreak;\n\n\t\t\tcase 'doc':\n\t\t\tcase 'docx':\n\t\t\t\ticon = 'doc';\n\t\t\t\tbreak;\n\n\t\t\tcase 'xls':\n\t\t\tcase 'xlsx':\n\t\t\t\ticon = 'xls';\n\t\t\t\tbreak;\n\n\t\t\tcase 'php':\n\t\t\t\ticon = 'php';\n\t\t\t\tbreak;\n\n\t\t\tcase 'pdf':\n\t\t\t\ticon = 'pdf';\n\t\t\t\tbreak;\n\n\t\t\tcase 'ppt':\n\t\t\tcase 'pptx':\n\t\t\t\ticon = 'ppt';\n\t\t\t\tbreak;\n\n\t\t\tcase 'rar':\n\t\t\t\ticon = 'rar';\n\t\t\t\tbreak;\n\n\t\t\tcase 'zip':\n\t\t\tcase '7z':\n\t\t\tcase 'tar':\n\t\t\tcase 'gz':\n\t\t\tcase 'gzip':\n\t\t\t\ticon = 'zip';\n\t\t\t\tbreak;\n\n\t\t\tcase 'set':\n\t\t\t\ticon = 'set';\n\t\t\t\tbreak;\n\n\t\t\tcase 'conf':\n\t\t\tcase 'ini':\n\t\t\tcase 'plist':\n\t\t\t\ticon = 'set';\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn icon;\n\t}\n}","import {Type, Loc} from 'main.core';\nimport {BuilderModel} from 'ui.vue3.vuex';\nimport {ChatTypes, MessageStatus, RecentCallStatus, RecentSettings} from 'im.v2.const';\nimport {Utils} from 'im.v2.lib.utils';\n\nexport class RecentModel extends BuilderModel\n{\n\tgetName()\n\t{\n\t\treturn 'recent';\n\t}\n\n\tgetState()\n\t{\n\t\treturn {\n\t\t\tcollection: {},\n\t\t\tactiveCalls: [],\n\t\t\toptions: {\n\t\t\t\tshowBirthday: true,\n\t\t\t\tshowInvited: true,\n\t\t\t\tshowLastMessage: true\n\t\t\t}\n\t\t};\n\t}\n\n\tgetElementState()\n\t{\n\t\treturn {\n\t\t\tdialogId: '0',\n\t\t\tmessage: {\n\t\t\t\tid: 0,\n\t\t\t\ttext: '',\n\t\t\t\tdate: new Date(),\n\t\t\t\tsenderId: 0,\n\t\t\t\tstatus: MessageStatus.received\n\t\t\t},\n\t\t\tdraft: {\n\t\t\t\ttext: '',\n\t\t\t\tdate: null\n\t\t\t},\n\t\t\tunread: false,\n\t\t\tpinned: false,\n\t\t\tliked: false,\n\t\t\tinvitation: {\n\t\t\t\tisActive: false,\n\t\t\t\toriginator: 0,\n\t\t\t\tcanResend: false\n\t\t\t},\n\t\t\toptions: {}\n\t\t};\n\t}\n\n\tgetActiveCallDefaultState()\n\t{\n\t\treturn {\n\t\t\tdialogId: 0,\n\t\t\tname: '',\n\t\t\tcall: {},\n\t\t\tstate: RecentCallStatus.waiting\n\t\t};\n\t}\n\n\tgetGetters()\n\t{\n\t\treturn {\n\t\t\tgetCollection: (state): Object[] =>\n\t\t\t{\n\t\t\t\treturn Object.values(state.collection);\n\t\t\t},\n\t\t\tgetSortedCollection: (state): Object[] =>\n\t\t\t{\n\t\t\t\tconst collectionAsArray = Object.values(state.collection).filter(item => {\n\t\t\t\t\tconst isBirthdayPlaceholder = item.options.birthdayPlaceholder;\n\t\t\t\t\tconst isInvitedUser = item.options.defaultUserRecord;\n\n\t\t\t\t\treturn !isBirthdayPlaceholder && !isInvitedUser && item.message.id;\n\t\t\t\t});\n\n\t\t\t\treturn [...collectionAsArray].sort((a, b) => {\n\t\t\t\t\treturn b.message.date - a.message.date;\n\t\t\t\t});\n\t\t\t},\n\t\t\tget: (state) => (dialogId: string): Object | null =>\n\t\t\t{\n\t\t\t\tif (Type.isNumber(dialogId))\n\t\t\t\t{\n\t\t\t\t\tdialogId = dialogId.toString();\n\t\t\t\t}\n\n\t\t\t\tif (state.collection[dialogId])\n\t\t\t\t{\n\t\t\t\t\treturn state.collection[dialogId];\n\t\t\t\t}\n\n\t\t\t\treturn null;\n\t\t\t},\n\n\t\t\tgetItemText: (state) => (dialogId): string =>\n\t\t\t{\n\t\t\t\tconst currentItem = state.collection[dialogId];\n\t\t\t\tif (!currentItem)\n\t\t\t\t{\n\t\t\t\t\treturn '';\n\t\t\t\t}\n\n\t\t\t\tlet result = currentItem.message.text;\n\t\t\t\t// system mention (get current name from model, otherwise - from code)\n\t\t\t\tresult = result.replace(/\\[user=(\\d+) replace](.*?)\\[\\/user]/gi, (match, userId, userName) => {\n\t\t\t\t\tconst user = this.store.getters['users/get'](userId);\n\t\t\t\t\treturn user ? user.name : userName;\n\t\t\t\t});\n\n\t\t\t\tresult = result.replace(/\\[user=(\\d+)]\\[\\/user]/gi, (match, userId) => {\n\t\t\t\t\tconst user = this.store.getters['users/get'](userId);\n\t\t\t\t\treturn user ? user.name : match;\n\t\t\t\t});\n\n\t\t\t\t// custom mention (keep name as it is)\n\t\t\t\treturn result.replace(/\\[user=(\\d+)](.+?)\\[\\/user]/gi, '$2');\n\t\t\t},\n\n\t\t\tneedsBirthdayPlaceholder: (state) => (dialogId): boolean =>\n\t\t\t{\n\t\t\t\tconst currentItem = state.collection[dialogId];\n\t\t\t\tif (!currentItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst dialog = this.store.getters['dialogues/get'](dialogId);\n\t\t\t\tif (!dialog || dialog.type !== ChatTypes.user)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tconst hasBirthday = this.store.getters['users/hasBirthday'](dialogId);\n\t\t\t\tif (!hasBirthday)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst hasTodayMessage = currentItem.message.id > 0 && Utils.date.isToday(currentItem.message.date);\n\n\t\t\t\treturn state.options.showBirthday && !hasTodayMessage && dialog.counter === 0;\n\t\t\t},\n\n\t\t\tgetMessageDate: (state) => (dialogId): Date | null =>\n\t\t\t{\n\t\t\t\tconst currentItem = state.collection[dialogId];\n\t\t\t\tif (!currentItem)\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\tif (Type.isDate(currentItem.draft.date) && currentItem.draft.date > currentItem.message.date)\n\t\t\t\t{\n\t\t\t\t\treturn currentItem.draft.date;\n\t\t\t\t}\n\n\t\t\t\tconst needsBirthdayPlaceholder = this.store.getters['recent/needsBirthdayPlaceholder'](currentItem.dialogId);\n\t\t\t\tif (needsBirthdayPlaceholder)\n\t\t\t\t{\n\t\t\t\t\treturn Utils.date.getStartOfTheDay();\n\t\t\t\t}\n\n\t\t\t\treturn currentItem.message.date;\n\t\t\t},\n\n\t\t\thasActiveCall: (state): boolean =>\n\t\t\t{\n\t\t\t\treturn state.activeCalls.some(item => item.state === RecentCallStatus.joined);\n\t\t\t},\n\n\t\t\tgetOption: (state) => (optionName: string): boolean =>\n\t\t\t{\n\t\t\t\tif (!RecentSettings[optionName])\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn state.options[optionName];\n\t\t\t}\n\t\t};\n\t}\n\n\tgetActions()\n\t{\n\t\treturn {\n\t\t\tset: (store, payload: Array | Object) =>\n\t\t\t{\n\t\t\t\tif (!Array.isArray(payload) && Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\tpayload = [payload];\n\t\t\t\t}\n\n\t\t\t\tconst itemsToUpdate = [];\n\t\t\t\tconst itemsToAdd = [];\n\t\t\t\tpayload.map(element => {\n\t\t\t\t\treturn this.validate(element);\n\t\t\t\t}).forEach(element => {\n\t\t\t\t\tconst existingItem = store.state.collection[element.dialogId];\n\t\t\t\t\tif (existingItem)\n\t\t\t\t\t{\n\t\t\t\t\t\titemsToUpdate.push({id: existingItem.dialogId, fields: {...element}});\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\titemsToAdd.push({...this.getElementState(), ...element});\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tif (itemsToAdd.length > 0)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('add', itemsToAdd);\n\t\t\t\t}\n\t\t\t\tif (itemsToUpdate.length > 0)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('update', itemsToUpdate);\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tupdate: (store, payload: {id: string | number, fields: Object}) =>\n\t\t\t{\n\t\t\t\tconst existingItem = store.state.collection[payload.id];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tid: existingItem.dialogId,\n\t\t\t\t\tfields: this.validate(payload.fields)\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tunread: (store, payload: {id: string | number, action: boolean}) =>\n\t\t\t{\n\t\t\t\tconst existingItem = store.state.collection[payload.id];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tid: existingItem.dialogId,\n\t\t\t\t\tfields: {unread: payload.action}\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tpin: (store, payload: {id: string | number, action: boolean}) =>\n\t\t\t{\n\t\t\t\tconst existingItem = store.state.collection[payload.id];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tid: existingItem.dialogId,\n\t\t\t\t\tfields: {pinned: payload.action}\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tlike: (store, payload: {id: string | number, messageId: number, liked: boolean}) =>\n\t\t\t{\n\t\t\t\tconst existingItem = store.state.collection[payload.id];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst isLastMessage = existingItem.message.id === Number.parseInt(payload.messageId, 10);\n\t\t\t\tconst isExactMessageLiked = !Type.isUndefined(payload.messageId) && payload.liked === true;\n\t\t\t\tif (isExactMessageLiked && !isLastMessage)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tid: existingItem.dialogId,\n\t\t\t\t\tfields: {liked: payload.liked === true}\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tdraft: (store, payload: {id: string | number, text: string}) =>\n\t\t\t{\n\t\t\t\tconst dialog = this.store.getters['dialogues/get'](payload.id);\n\t\t\t\tif (!dialog)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tlet existingItem = store.state.collection[payload.id];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\tif (payload.text === '')\n\t\t\t\t\t{\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t\tconst newItem = {\n\t\t\t\t\t\tdialogId: payload.id.toString(),\n\t\t\t\t\t};\n\t\t\t\t\tstore.commit('add', {...this.getElementState(), ...newItem});\n\t\t\t\t\texistingItem = store.state.collection[payload.id];\n\t\t\t\t}\n\n\t\t\t\tconst fields = this.validate({draft: {text: payload.text.toString()}});\n\t\t\t\tif (fields.draft.text === existingItem.draft.text)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tid: existingItem.dialogId,\n\t\t\t\t\tfields\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tdelete: (store, payload: {id: string | number}) =>\n\t\t\t{\n\t\t\t\tconst existingItem = store.state.collection[payload.id];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('delete', {\n\t\t\t\t\tid: existingItem.dialogId\n\t\t\t\t});\n\t\t\t},\n\n\t\t\taddActiveCall: (store, payload) =>\n\t\t\t{\n\t\t\t\tconst existingIndex = store.state.activeCalls.findIndex(item => {\n\t\t\t\t\treturn item.dialogId === payload.dialogId || item.call.id === payload.call.id;\n\t\t\t\t});\n\n\t\t\t\tif (existingIndex > -1)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('updateActiveCall', {\n\t\t\t\t\t\tindex: existingIndex,\n\t\t\t\t\t\tfields: this.validateActiveCall(payload)\n\t\t\t\t\t});\n\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('addActiveCall', this.prepareActiveCall(payload));\n\t\t\t},\n\n\t\t\tupdateActiveCall: (store, payload) =>\n\t\t\t{\n\t\t\t\tconst existingIndex = store.state.activeCalls.findIndex(item => {\n\t\t\t\t\treturn item.dialogId === payload.dialogId;\n\t\t\t\t});\n\n\t\t\t\tstore.commit('updateActiveCall', {\n\t\t\t\t\tindex: existingIndex,\n\t\t\t\t\tfields: this.validateActiveCall(payload.fields)\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tdeleteActiveCall: (store, payload) =>\n\t\t\t{\n\t\t\t\tconst existingIndex = store.state.activeCalls.findIndex(item => {\n\t\t\t\t\treturn item.dialogId === payload.dialogId;\n\t\t\t\t});\n\n\t\t\t\tif (existingIndex === -1)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('deleteActiveCall', {\n\t\t\t\t\tindex: existingIndex\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tsetOptions: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (!Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tpayload = this.validateOptions(payload);\n\t\t\t\tObject.entries(payload).forEach(([option, value]) => {\n\t\t\t\t\tstore.commit('setOptions', {\n\t\t\t\t\t\toption,\n\t\t\t\t\t\tvalue\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\t}\n\n\tgetMutations()\n\t{\n\t\treturn {\n\t\t\tadd: (state, payload: Object[] | Object) => {\n\t\t\t\tif (!Array.isArray(payload) && Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\tpayload = [payload];\n\t\t\t\t}\n\t\t\t\tpayload.forEach(item => {\n\t\t\t\t\tstate.collection[item.dialogId] = item;\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tupdate: (state, payload: Object[] | Object) => {\n\t\t\t\tif (!Array.isArray(payload) && Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\tpayload = [payload];\n\t\t\t\t}\n\t\t\t\tpayload.forEach(({id, fields}) => {\n\t\t\t\t\t// if we already got chat - we should not update it with default user chat (unless it's an accepted invitation)\n\t\t\t\t\tconst defaultUserElement = fields.options && fields.options.defaultUserRecord && !fields.invitation;\n\t\t\t\t\tif (defaultUserElement)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst currentElement = state.collection[id];\n\t\t\t\t\tfields.message = {...currentElement.message, ...fields.message};\n\t\t\t\t\tfields.options = {...currentElement.options, ...fields.options};\n\t\t\t\t\tstate.collection[id] = {\n\t\t\t\t\t\t...currentElement,\n\t\t\t\t\t\t...fields\n\t\t\t\t\t};\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tdelete: (state, payload: {id: string}) => {\n\t\t\t\tdelete state.collection[payload.id];\n\t\t\t},\n\n\t\t\taddActiveCall: (state, payload) => {\n\t\t\t\tstate.activeCalls.push(payload);\n\t\t\t},\n\n\t\t\tupdateActiveCall: (state, payload) => {\n\t\t\t\tstate.activeCalls[payload.index] = {\n\t\t\t\t\t...state.activeCalls[payload.index],\n\t\t\t\t\t...payload.fields\n\t\t\t\t};\n\t\t\t},\n\n\t\t\tdeleteActiveCall: (state, payload) => {\n\t\t\t\tstate.activeCalls.splice(payload.index, 1);\n\t\t\t},\n\n\t\t\tsetOptions: (state, payload) => {\n\t\t\t\tstate.options[payload.option] = payload.value;\n\t\t\t}\n\t\t};\n\t}\n\n\tvalidate(fields: Object)\n\t{\n\t\tconst result = {\n\t\t\toptions: {}\n\t\t};\n\n\t\tif (Type.isNumber(fields.id))\n\t\t{\n\t\t\tresult.dialogId = fields.id.toString();\n\t\t}\n\t\tif (Type.isStringFilled(fields.id))\n\t\t{\n\t\t\tresult.dialogId = fields.id;\n\t\t}\n\n\t\tif (Type.isNumber(fields.dialogId))\n\t\t{\n\t\t\tresult.dialogId = fields.dialogId.toString();\n\t\t}\n\t\tif (Type.isStringFilled(fields.dialogId))\n\t\t{\n\t\t\tresult.dialogId = fields.dialogId;\n\t\t}\n\n\t\tif (Type.isPlainObject(fields.message))\n\t\t{\n\t\t\tresult.message = this.prepareMessage(fields);\n\t\t}\n\n\t\tif (Type.isPlainObject(fields.draft))\n\t\t{\n\t\t\tresult.draft = this.prepareDraft(fields);\n\t\t}\n\n\t\tif (Type.isBoolean(fields.unread))\n\t\t{\n\t\t\tresult.unread = fields.unread;\n\t\t}\n\n\t\tif (Type.isBoolean(fields.pinned))\n\t\t{\n\t\t\tresult.pinned = fields.pinned;\n\t\t}\n\n\t\tif (Type.isBoolean(fields.liked))\n\t\t{\n\t\t\tresult.liked = fields.liked;\n\t\t}\n\n\t\tif (Type.isPlainObject(fields.invited))\n\t\t{\n\t\t\tresult.invitation = {\n\t\t\t\tisActive: true,\n\t\t\t\toriginator: fields.invited.originator_id,\n\t\t\t\tcanResend: fields.invited.can_resend\n\t\t\t};\n\t\t\tresult.options.defaultUserRecord = true;\n\t\t}\n\t\telse if (fields.invited === false)\n\t\t{\n\t\t\tresult.invitation = {\n\t\t\t\tisActive: false,\n\t\t\t\toriginator: 0,\n\t\t\t\tcanResend: false\n\t\t\t};\n\t\t\tresult.options.defaultUserRecord = true;\n\t\t}\n\n\t\tif (Type.isPlainObject(fields.options))\n\t\t{\n\t\t\tif (!result.options)\n\t\t\t{\n\t\t\t\tresult.options = {};\n\t\t\t}\n\n\t\t\tif (Type.isBoolean(fields.options.default_user_record))\n\t\t\t{\n\t\t\t\tfields.options.defaultUserRecord = fields.options.default_user_record;\n\t\t\t}\n\n\t\t\tif (Type.isBoolean(fields.options.defaultUserRecord))\n\t\t\t{\n\t\t\t\tresult.options.defaultUserRecord = fields.options.defaultUserRecord;\n\t\t\t}\n\n\t\t\tif (Type.isBoolean(fields.options.birthdayPlaceholder))\n\t\t\t{\n\t\t\t\tresult.options.birthdayPlaceholder = fields.options.birthdayPlaceholder;\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tprepareChatType(fields: Object): string\n\t{\n\t\tif (fields.type === ChatTypes.user)\n\t\t{\n\t\t\treturn ChatTypes.user;\n\t\t}\n\n\t\tif (fields.chat)\n\t\t{\n\t\t\treturn fields.chat.type;\n\t\t}\n\n\t\treturn fields.type;\n\t}\n\n\tprepareMessage(fields: Object): Object\n\t{\n\t\tconst {message} = this.getElementState();\n\t\tif (Type.isNumber(fields.message.id))\n\t\t{\n\t\t\tmessage.id = fields.message.id;\n\t\t}\n\t\tif (Type.isString(fields.message.text))\n\t\t{\n\t\t\tconst textOptions = {};\n\t\t\tif (fields.message.withAttach || fields.message.attach)\n\t\t\t{\n\t\t\t\ttextOptions.WITH_ATTACH = true;\n\t\t\t}\n\t\t\telse if (fields.message.withFile || fields.message.file)\n\t\t\t{\n\t\t\t\ttextOptions.WITH_FILE = true;\n\t\t\t}\n\t\t\tmessage.text = this.prepareText(fields.message.text, textOptions);\n\t\t}\n\n\t\tif (Type.isDate(fields.message.date) || Type.isString(fields.message.date))\n\t\t{\n\t\t\tmessage.date = Utils.date.cast(fields.message.date);\n\t\t}\n\n\t\tif (Type.isNumber(fields.message.author_id))\n\t\t{\n\t\t\tmessage.senderId = fields.message.author_id;\n\t\t}\n\t\tif (Type.isNumber(fields.message.senderId))\n\t\t{\n\t\t\tmessage.senderId = fields.message.senderId;\n\t\t}\n\t\tif (Type.isStringFilled(fields.message.status))\n\t\t{\n\t\t\tmessage.status = fields.message.status;\n\t\t}\n\n\t\treturn message;\n\t}\n\n\tprepareDraft(fields: Object): Object\n\t{\n\t\tconst {draft} = this.getElementState();\n\n\t\tif (Type.isString(fields.draft.text))\n\t\t{\n\t\t\tdraft.text = this.prepareText(fields.draft.text, {});\n\t\t}\n\n\t\tif (Type.isStringFilled(draft.text))\n\t\t{\n\t\t\tdraft.date = new Date();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tdraft.date = null;\n\t\t}\n\n\t\treturn draft;\n\t}\n\n\tprepareText(text: string, options: Object): string\n\t{\n\t\tlet result = text.trim();\n\n\t\tif (result.startsWith('/me'))\n\t\t{\n\t\t\tresult = result.slice(4);\n\t\t}\n\t\telse if (result.startsWith('/loud'))\n\t\t{\n\t\t\tresult = result.slice(6);\n\t\t}\n\n\t\tresult = result.replace(/<br><br \\/>/gi, '<br />');\n\t\tresult = result.replace(/<br \\/><br>/gi, '<br />');\n\n\t\tconst codeReplacement = [];\n\t\tresult = result.replace(/\\[code]\\n?([\\0-\\uFFFF]*?)\\[\\/code]/gi, (whole, group) => {\n\t\t\tconst id = codeReplacement.length;\n\t\t\tcodeReplacement.push(group);\n\t\t\treturn `####REPLACEMENT_CODE_${id}####`;\n\t\t});\n\n\t\tresult = result.replace(/\\[put(?:=.+?)?](?:.+?)?\\[\\/put]/gi, (match) => {\n\t\t\treturn match.replace(/\\[put(?:=(.+))?](.+?)?\\[\\/put]/gi, (whole, command, textToPut) => {\n\t\t\t\treturn textToPut || command;\n\t\t\t});\n\t\t});\n\n\t\tresult = result.replace(/\\[send(?:=.+?)?](?:.+?)?\\[\\/send]/gi, (match) => {\n\t\t\treturn match.replace(/\\[send(?:=(.+))?](.+?)?\\[\\/send]/gi, (whole, command, textToSend) => {\n\t\t\t\treturn textToSend || command;\n\t\t\t});\n\t\t});\n\n\t\tresult = result.replace(/\\[[bisu]](.*?)\\[\\/[bisu]]/gi, '$1');\n\t\tresult = result.replace(/\\[url](.*?)\\[\\/url]/gi, '$1');\n\t\tresult = result.replace(/\\[url=(.*?)](.*?)\\[\\/url]/gi, '$2');\n\t\tresult = result.replace(/\\[rating=([1-5])]/gi, () => `[${Loc.getMessage('IM_UTILS_TEXT_RATING')}] `);\n\t\tresult = result.replace(/\\[attach=(\\d+)]/gi, () => `[${Loc.getMessage('IM_UTILS_TEXT_ATTACH')}] `);\n\t\tresult = result.replace(/\\[chat=(\\d+)](.*?)\\[\\/chat]/gi, '$2');\n\t\tresult = result.replace(/\\[send(?:=.+?)?](.+?)?\\[\\/send]/gi, '$1');\n\t\tresult = result.replace(/\\[put(?:=.+?)?](.+?)?\\[\\/put]/gi, '$1');\n\t\tresult = result.replace(/\\[call(?:=.+?)?](.*?)\\[\\/call]/gi, '$1');\n\t\tresult = result.replace(/\\[pch=(\\d+)](.*?)\\[\\/pch]/gi, '$2');\n\t\tresult = result.replace(/<img.*?data-code=\"([^\"]*)\".*?>/gi, '$1');\n\t\tresult = result.replace(/<span.*?title=\"([^\"]*)\".*?>.*?<\\/span>/gi, '($1)');\n\t\tresult = result.replace(/<img.*?title=\"([^\"]*)\".*?>/gi, '($1)');\n\t\tresult = result.replace(/<s>([^\"]*)<\\/s>/gi, ' ');\n\t\tresult = result.replace(/\\[s]([^\"]*)\\[\\/s]/gi, ' ');\n\t\tresult = result.replace(/\\[icon=([^\\]]*)]/gi, this.prepareIconCode);\n\n\t\tcodeReplacement.forEach((element, index) => {\n\t\t\tresult = result.replace(`####REPLACEMENT_CODE_${index}####`, element);\n\t\t});\n\n\t\tresult = result.replace(/-{54}(.*?)-{54}/gims, `[${Loc.getMessage('IM_UTILS_TEXT_QUOTE')}] `);\n\t\tresult = result.replace(/^(>>(.*)(\\n)?)/gim, `[${Loc.getMessage('IM_UTILS_TEXT_QUOTE')}] `);\n\n\t\tif (options.WITH_ATTACH && result.length === 0)\n\t\t{\n\t\t\tresult = `[${Loc.getMessage('IM_UTILS_TEXT_ATTACH')}] ${result}`;\n\t\t}\n\t\telse if (options.WITH_FILE && result.length === 0)\n\t\t{\n\t\t\tresult = `[${Loc.getMessage('IM_UTILS_TEXT_FILE')}] ${result}`;\n\t\t}\n\n\t\tresult = result.replace(/\\n/gi, ' ').trim();\n\n\t\tconst SPLIT_INDEX = 24;\n\t\tconst UNSEEN_SPACE = '\\u200B';\n\n\t\tif (result.length > SPLIT_INDEX)\n\t\t{\n\t\t\tlet firstPart = result.slice(0, SPLIT_INDEX + 1);\n\t\t\tconst secondPart = result.slice(SPLIT_INDEX + 1);\n\t\t\tconst hasWhitespace = /\\s/.test(firstPart);\n\t\t\tconst hasUserCode = /\\[user=(\\d+)](.*?)\\[\\/user]/i.test(result);\n\t\t\tif (firstPart.length === SPLIT_INDEX + 1 && !hasWhitespace && !hasUserCode)\n\t\t\t{\n\t\t\t\tfirstPart += UNSEEN_SPACE;\n\t\t\t}\n\t\t\tresult = firstPart + secondPart;\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tprepareIconCode(wholeMatch: string): string\n\t{\n\t\tlet title = wholeMatch.match(/title=(.*[^\\s\\]])/i);\n\t\tif (title && title[1])\n\t\t{\n\t\t\t// eslint-disable-next-line prefer-destructuring\n\t\t\ttitle = title[1];\n\t\t\tif (title.includes('width='))\n\t\t\t{\n\t\t\t\ttitle = title.slice(0, Math.max(0, title.indexOf('width=')));\n\t\t\t}\n\t\t\tif (title.includes('height='))\n\t\t\t{\n\t\t\t\ttitle = title.slice(0, Math.max(0, title.indexOf('height=')));\n\t\t\t}\n\t\t\tif (title.includes('size='))\n\t\t\t{\n\t\t\t\ttitle = title.slice(0, Math.max(0, title.indexOf('size=')));\n\t\t\t}\n\t\t\tif (title)\n\t\t\t{\n\t\t\t\ttitle = `(${title.trim()})`;\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\ttitle = `(${Loc.getMessage('IM_UTILS_TEXT_ICON')})`;\n\t\t}\n\t\treturn title;\n\t}\n\n\tprepareActiveCall(call)\n\t{\n\t\treturn {...this.getActiveCallDefaultState(), ...this.validateActiveCall(call)};\n\t}\n\n\tvalidateActiveCall(fields)\n\t{\n\t\tconst result = {};\n\n\t\tif (Type.isStringFilled(fields.dialogId) || Type.isNumber(fields.dialogId))\n\t\t{\n\t\t\tresult.dialogId = fields.dialogId;\n\t\t}\n\n\t\tif (Type.isStringFilled(fields.name))\n\t\t{\n\t\t\tresult.name = fields.name;\n\t\t}\n\n\t\tif (Type.isObjectLike(fields.call))\n\t\t{\n\t\t\tresult.call = fields.call;\n\n\t\t\tif (fields.call?.associatedEntity?.avatar === '/bitrix/js/im/images/blank.gif')\n\t\t\t{\n\t\t\t\tresult.call.associatedEntity.avatar = '';\n\t\t\t}\n\t\t}\n\n\t\tif (RecentCallStatus[fields.state])\n\t\t{\n\t\t\tresult.state = fields.state;\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tvalidateOptions(fields)\n\t{\n\t\tconst result = {};\n\n\t\tif (Type.isBoolean(fields.showBirthday))\n\t\t{\n\t\t\tresult.showBirthday = fields.showBirthday;\n\t\t}\n\n\t\tif (Type.isBoolean(fields.showInvited))\n\t\t{\n\t\t\tresult.showInvited = fields.showInvited;\n\t\t}\n\n\t\tif (Type.isBoolean(fields.showLastMessage))\n\t\t{\n\t\t\tresult.showLastMessage = fields.showLastMessage;\n\t\t}\n\n\t\treturn result;\n\t}\n}"],"names":["ApplicationModel","BuilderModel","getName","getState","common","host","getVariable","location","protocol","siteId","userId","languageId","dialog","dialogId","chatId","diskFolderId","messageLimit","enableReadMessages","messageExtraCount","disk","enabled","maxFileSize","call","serverEnabled","maxParticipants","mobile","keyboardShow","device","type","DeviceType","desktop","orientation","DeviceOrientation","portrait","options","quoteEnable","quoteFromRight","autoplayVideo","darkTheme","showSmiles","error","active","code","description","getStateSaveException","Object","assign","getGetters","getOption","state","optionName","Settings","getActions","set","store","payload","commit","validate","hideSmiles","setOptions","Type","isPlainObject","validateOptions","entries","forEach","option","value","getMutations","hasChange","group","hasOwnProperty","field","isSaveNeeded","saveState","increaseDialogExtraCount","count","decreaseDialogExtraCount","newCounter","clearDialogExtraCount","fields","result","toString","startsWith","substr","parseInt","isNaN","isUndefined","isStringFilled","BX","MessengerProxy","isDarkTheme","IntersectionType","empty","equal","none","found","foundReverse","MessagesModel","created","collection","mutationType","saveMessageList","saveFileList","saveUserList","getElementState","templateId","templateType","placeholderType","id","authorId","date","Date","text","textConverted","params","TYPE","COMPONENT_ID","push","unread","sending","retry","blink","getMutationType","initialType","MutationType","appliedType","getLastId","length","lastId","i","element","getMessage","messageId","index","get","getBlank","getSaveFileList","getSaveUserList","add","countMessages","message","getTime","dispatch","actionStart","test","nextTick","actionError","actionFinish","Array","map","prepareMessage","insertType","data","addPlaceholders","placeholders","requestMode","setBefore","setAfter","reverse","clearPlaceholders","updatePlaceholders","update","findIndex","el","setTimeout","delete","elements","clear","keepPlaceholders","applyMutationType","readMessages","readId","unreadMessages","unreadId","initCollection","sort","a","b","Logger","warn","filter","firstPlaceholderId","firstMessage","firstPlaceholderIndex","splice","amount","chats","chatsSave","isPush","getPayloadWithTempMessages","StorageLimit","messages","includes","intersection","manageCacheBeforeSet","foundElements","removeIntersectionCacheElements","localMessage","isTemporaryMessage","unshift","getters","Set","every","EventEmitter","emit","EventType","messagesSet","readVisibleMessages","isSaveState","clearMessages","applied","scrollStickToTop","scrollMessageId","saveNeeded","updateSubordinateStates","cache","recursive","noneElements","reverseResult","updateSaveLists","isSaveAvailable","readCounter","slice","FILE_ID","concat","getSaveTimeout","storedState","Utils","isUuidV4","uuid","chat_id","cast","textOriginal","convertToHtml","isConverted","text_converted","senderId","author_id","system","validateParams","Vue","isComponent","like","decodeAttach","e","hasResultElements","quote","image","enableBigSmile","trim","replace","quoteSign","indexOf","textPrepare","split","textPrepareFlag","join","decodeBbCode","whole","p1","p2","p3","p4","offset","changed","aInner","match","doubleSmileSize","start","width","middle","height","end","textOnly","item","isArray","arrayElement","prop","htmlspecialcharsback","putReplacement","sendReplacement","codeReplacement","link","tag","document","createElement","href","target","allowList","outerHTML","open","inner","close","openlines","number","htmlspecialchars","historyId","textElementSize","url","attrs","size","title","attributes","name","command","html","hideErrorImage","parentNode","innerHTML","src","payloadData","platform","isBitrixMobile","payloadChatId","existsInPayload","doesTaskExist","find","payloadMessage","foundUploadTasks","fileId","window","imDialogUploadTasks","task","taskId","foundMessageTask","imDialogMessagesTasks","WRITING_STATUS_TIME","DialoguesModel","writingStatusTimers","chatOptions","ChatTypes","chat","avatar","color","extranet","counter","userCounter","messageCounter","lastMessageId","managerList","readList","writingList","muteList","textareaMessage","quoteId","editId","owner","entityType","entityId","dateCreate","public","getByChatId","Number","values","getChatOption","chatType","getQuoteId","getEditId","areUnreadMessagesLoaded","messagesCollection","lastElementId","lastElement","isNumber","existingItem","startWriting","timerId","alreadyWriting","some","clearTimeout","setWritingStatusTimeout","newItem","userName","newWritingList","actionName","stopWriting","addToReadList","removeFromReadList","increaseCounter","increasedCounter","previousCounter","decreaseCounter","decreasedCounter","increaseMessageCounter","mute","currentUserId","application","unmute","setChatOptions","validateChatOptions","dialog_id","user_counter","message_count","unread_id","last_message_id","ownerId","isString","prepareAvatar","isBoolean","entity_type","entity_id","date_create","readed_list","prepareReadList","writing_list","prepareWritingList","manager_list","mute_list","prepareMuteList","endsWith","encodeURI","user_id","user_name","message_id","key","typeOptions","newType","convertSnakeToCamelCase","toLowerCase","newKey","UsersModel","onlineList","mobileOnlineList","absentList","botList","firstName","lastName","workPosition","gender","network","bot","connector","externalAuthId","status","idle","lastActivityDate","mobileLastDate","isOnline","isMobileOnline","birthday","isBirthday","absent","isAbsent","departments","phones","workPhone","personalMobile","personalPhone","innerPhone","getTemporary","user","getList","userList","hasBirthday","getStatus","UserStatus","mobileOnline","getLastOnline","getLastDateText","getPosition","Loc","getBotType","botType","BotType","existingUser","setBotList","addToOnlineList","addToMobileOnlineList","isBirthdayToday","getTimeToNextMidnight","addToAbsentList","startOnlineCheckInterval","startAbsentCheckInterval","isDate","first_name","last_name","work_position","external_auth_id","last_activity_date","mobile_last_date","departmentId","preparePhones","work_phone","personal_mobile","personal_phone","inner_phone","users","absentCheckInterval","TIME_TO_NEXT_DAY","setInterval","currentTime","now","absentEnd","onlineCheckInterval","ONE_MINUTE","FilesModel","extension","icon","FileStatus","done","progress","authorName","urlPreview","urlShow","urlDownload","init","viewerAttrs","file","getLoadedState","db","list","getIconType","maxDiskFileSize","getType","FileType","video","audio","RecentModel","activeCalls","showBirthday","showInvited","showLastMessage","MessageStatus","received","draft","pinned","liked","invitation","isActive","originator","canResend","getActiveCallDefaultState","RecentCallStatus","waiting","getCollection","getSortedCollection","collectionAsArray","isBirthdayPlaceholder","birthdayPlaceholder","isInvitedUser","defaultUserRecord","getItemText","currentItem","needsBirthdayPlaceholder","hasTodayMessage","isToday","getMessageDate","getStartOfTheDay","hasActiveCall","joined","RecentSettings","itemsToUpdate","itemsToAdd","action","pin","isLastMessage","isExactMessageLiked","addActiveCall","existingIndex","validateActiveCall","prepareActiveCall","updateActiveCall","deleteActiveCall","defaultUserElement","currentElement","prepareDraft","invited","originator_id","can_resend","default_user_record","prepareChatType","textOptions","withAttach","attach","WITH_ATTACH","withFile","WITH_FILE","prepareText","textToPut","textToSend","prepareIconCode","SPLIT_INDEX","UNSEEN_SPACE","firstPart","secondPart","hasWhitespace","hasUserCode","wholeMatch","Math","max","isObjectLike","associatedEntity"],"mappings":"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"}