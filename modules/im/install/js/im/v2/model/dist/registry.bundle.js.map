{"version":3,"file":"registry.bundle.js","sources":["../src/application/settings.js","../src/application.js","../src/messages/pin.js","../src/messages/reactions.js","../src/messages.js","../src/dialogues.js","../src/users.js","../src/files.js","../src/recent/calls.js","../src/recent/search.js","../src/recent.js","../src/notifications.js","../src/sidebar/links.js","../src/sidebar/favorites.js","../src/sidebar/members.js","../src/sidebar/tasks.js","../src/sidebar/meeting.js","../src/sidebar/files.js","../src/sidebar.js","../src/market.js"],"sourcesContent":["import { Type } from 'main.core';\nimport { BuilderModel, GetterTree, ActionTree, MutationTree } from 'ui.vue3.vuex';\n\nimport { Settings, DialogAlignment } from 'im.v2.const';\n\ntype SettingsState = {[settingName: string]: any};\n\n/* eslint-disable no-param-reassign */\nexport class SettingsModel extends BuilderModel\n{\n\tgetState()\n\t{\n\t\treturn {\n\t\t\t[Settings.appearance.background]: 1,\n\t\t\t[Settings.appearance.alignment]: DialogAlignment.left,\n\n\t\t\t[Settings.notification.enableSound]: true,\n\n\t\t\t[Settings.message.bigSmiles]: true,\n\n\t\t\t[Settings.recent.showBirthday]: true,\n\t\t\t[Settings.recent.showInvited]: true,\n\t\t\t[Settings.recent.showLastMessage]: true,\n\n\t\t\t[Settings.desktop.enableRedirect]: true,\n\t\t};\n\t}\n\n\tgetGetters(): GetterTree\n\t{\n\t\treturn {\n\t\t\t/** @function application/settings/get */\n\t\t\tget: (state: SettingsState) => (key: string): any => {\n\t\t\t\treturn state[key];\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions(): ActionTree\n\t{\n\t\treturn {\n\t\t\t/** @function application/settings/set */\n\t\t\tset: (store, payload: {[settingName: string]: any}) => {\n\t\t\t\tstore.commit('set', this.validate(payload));\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMutations(): MutationTree\n\t{\n\t\treturn {\n\t\t\tset: (state: SettingsState, payload: {[settingName: string]: any}) => {\n\t\t\t\tObject.entries(payload).forEach(([key, value]) => {\n\t\t\t\t\tstate[key] = value;\n\t\t\t\t});\n\t\t\t},\n\t\t};\n\t}\n\n\tvalidate(fields): {[settingName: string]: any}\n\t{\n\t\tconst result = {};\n\n\t\tif (Type.isBoolean(fields[Settings.notification.enableSound]))\n\t\t{\n\t\t\tresult[Settings.notification.enableSound] = fields[Settings.notification.enableSound];\n\t\t}\n\n\t\tif (Type.isBoolean(fields[Settings.message.bigSmiles]))\n\t\t{\n\t\t\tresult[Settings.message.bigSmiles] = fields[Settings.message.bigSmiles];\n\t\t}\n\n\t\tif (\n\t\t\tType.isStringFilled(fields[Settings.appearance.background])\n\t\t\t|| Type.isNumber(fields[Settings.appearance.background])\n\t\t)\n\t\t{\n\t\t\tresult[Settings.appearance.background] = Number.parseInt(fields[Settings.appearance.background], 10);\n\t\t}\n\n\t\tif (Type.isString(fields[Settings.appearance.alignment]))\n\t\t{\n\t\t\tresult[Settings.appearance.alignment] = fields[Settings.appearance.alignment];\n\t\t}\n\n\t\tif (Type.isBoolean(fields[Settings.recent.showBirthday]))\n\t\t{\n\t\t\tresult[Settings.recent.showBirthday] = fields[Settings.recent.showBirthday];\n\t\t}\n\n\t\tif (Type.isBoolean(fields[Settings.recent.showInvited]))\n\t\t{\n\t\t\tresult[Settings.recent.showInvited] = fields[Settings.recent.showInvited];\n\t\t}\n\n\t\tif (Type.isBoolean(fields[Settings.recent.showLastMessage]))\n\t\t{\n\t\t\tresult[Settings.recent.showLastMessage] = fields[Settings.recent.showLastMessage];\n\t\t}\n\n\t\tif (Type.isStringFilled(fields[Settings.hotkey.sendByEnter]))\n\t\t{\n\t\t\tresult[Settings.hotkey.sendByEnter] = fields[Settings.hotkey.sendByEnter] === 'Y' || fields[Settings.hotkey.sendByEnter] === '1';\n\t\t}\n\n\t\tif (Type.isBoolean(fields[Settings.hotkey.sendByEnter]))\n\t\t{\n\t\t\tresult[Settings.hotkey.sendByEnter] = fields[Settings.hotkey.sendByEnter];\n\t\t}\n\n\t\tif (Type.isBoolean(fields[Settings.desktop.enableRedirect]))\n\t\t{\n\t\t\tresult[Settings.desktop.enableRedirect] = fields[Settings.desktop.enableRedirect];\n\t\t}\n\n\t\treturn result;\n\t}\n}\n","import { Type } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { BuilderModel } from 'ui.vue3.vuex';\n\nimport { Layout, EventType } from 'im.v2.const';\n\nimport { SettingsModel } from './application/settings';\n\nimport type { ActionTree, GetterTree, MutationTree } from 'ui.vue3.vuex';\n\nexport class ApplicationModel extends BuilderModel\n{\n\tgetName(): string\n\t{\n\t\treturn 'application';\n\t}\n\n\tgetNestedModules(): { [moduleName: string]: BuilderModel }\n\t{\n\t\treturn { settings: SettingsModel };\n\t}\n\n\tgetState()\n\t{\n\t\treturn {\n\t\t\tlayout:\n\t\t\t{\n\t\t\t\tname: Layout.chat.name,\n\t\t\t\tentityId: '',\n\t\t\t\tcontextId: 0,\n\t\t\t},\n\t\t};\n\t}\n\n\tgetGetters(): GetterTree\n\t{\n\t\treturn {\n\t\t\t/** @function application/getLayout */\n\t\t\tgetLayout: (state) => {\n\t\t\t\treturn state.layout;\n\t\t\t},\n\t\t\t/** @function application/isChatOpen */\n\t\t\tisChatOpen: (state) => (dialogId: string): boolean => {\n\t\t\t\tif (state.layout.name !== Layout.chat.name)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn state.layout.entityId === dialogId.toString();\n\t\t\t},\n\t\t\tisLinesChatOpen: (state) => (dialogId: string): boolean => {\n\t\t\t\tif (state.layout.name !== Layout.openlines.name)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn state.layout.entityId === dialogId.toString();\n\t\t\t},\n\t\t\t/** @function application/areNotificationsOpen */\n\t\t\tareNotificationsOpen: (state) => {\n\t\t\t\treturn state.layout.name === Layout.notification.name;\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions(): ActionTree\n\t{\n\t\treturn {\n\t\t\t/** @function application/setLayout */\n\t\t\tsetLayout: (store, payload: {layoutName: string, entityId?: string, contextId?: number}) => {\n\t\t\t\tconst { layoutName, entityId = '', contextId = 0 } = payload;\n\t\t\t\tif (!Type.isStringFilled(layoutName))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst previousLayout = { ...store.state.layout };\n\t\t\t\tconst newLayout = {\n\t\t\t\t\tname: this.validateLayout(layoutName),\n\t\t\t\t\tentityId: this.validateLayoutEntityId(layoutName, entityId),\n\t\t\t\t\tcontextId,\n\t\t\t\t};\n\t\t\t\tstore.commit('updateLayout', {\n\t\t\t\t\tlayout: newLayout,\n\t\t\t\t});\n\n\t\t\t\tEventEmitter.emit(EventType.layout.onLayoutChange, {\n\t\t\t\t\tfrom: previousLayout,\n\t\t\t\t\tto: newLayout,\n\t\t\t\t});\n\t\t\t},\n\t\t};\n\t}\n\n\t/* eslint-disable no-param-reassign */\n\tgetMutations(): MutationTree\n\t{\n\t\treturn {\n\t\t\tupdateLayout: (state, payload) => {\n\t\t\t\tstate.layout = { ...state.layout, ...payload.layout };\n\t\t\t},\n\t\t};\n\t}\n\n\tvalidateLayout(layoutName: string): string\n\t{\n\t\tif (!Layout[layoutName])\n\t\t{\n\t\t\treturn Layout.chat.name;\n\t\t}\n\n\t\treturn layoutName;\n\t}\n\n\tvalidateLayoutEntityId(layoutName: string, entityId: string): string\n\t{\n\t\tif (!Layout[layoutName])\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\t// TODO check `entityId` by layout name\n\n\t\treturn entityId;\n\t}\n}\n","import {BuilderModel} from 'ui.vue3.vuex';\n\nimport {Core} from 'im.v2.application.core';\nimport {Logger} from 'im.v2.lib.logger';\n\nimport type {ImModelMessage} from 'im.v2.model';\n\nexport class PinModel extends BuilderModel\n{\n\tgetState()\n\t{\n\t\treturn {\n\t\t\tcollection: {}\n\t\t};\n\t}\n\n\tgetGetters(): Object\n\t{\n\t\treturn {\n\t\t\tgetPinned: (state: PinState) => (chatId: number): ImModelMessage[] =>\n\t\t\t{\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\treturn [...state.collection[chatId]].map(pinnedMessageId => {\n\t\t\t\t\treturn Core.getStore().getters['messages/getById'](pinnedMessageId);\n\t\t\t\t});\n\t\t\t},\n\t\t\tisPinned: (state: PinState) => (payload: {chatId: number, messageId: number}): boolean =>\n\t\t\t{\n\t\t\t\tconst {chatId, messageId} = payload;\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[chatId].has(messageId);\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions(): Object\n\t{\n\t\treturn {\n\t\t\tsetPinned: (store, payload: {chatId: number, pinnedMessages: number[]}) =>\n\t\t\t{\n\t\t\t\tconst {chatId, pinnedMessages} = payload;\n\t\t\t\tif (pinnedMessages.length === 0)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setPinned', {\n\t\t\t\t\tchatId,\n\t\t\t\t\tpinnedMessageIds: pinnedMessages\n\t\t\t\t});\n\t\t\t},\n\t\t\tset: (store, payload: {chatId: number, messageId: number, action: boolean}) =>\n\t\t\t{\n\t\t\t\tstore.commit('set', payload);\n\t\t\t},\n\t\t\tadd: (store, payload: {chatId: number, messageId: number}) =>\n\t\t\t{\n\t\t\t\tstore.commit('add', payload);\n\t\t\t},\n\t\t\tdelete: (store, payload: {chatId: number, messageId: number}) =>\n\t\t\t{\n\t\t\t\tstore.commit('delete', payload);\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMutations(): Object\n\t{\n\t\treturn {\n\t\t\tsetPinned: (state: PinState, payload: {chatId: number, pinnedMessageIds: number[]}) =>\n\t\t\t{\n\t\t\t\tLogger.warn('Messages/pin model: setPinned mutation', payload);\n\t\t\t\tconst {chatId, pinnedMessageIds} = payload;\n\t\t\t\tstate.collection[chatId] = new Set(pinnedMessageIds.reverse());\n\t\t\t},\n\t\t\tadd: (state: PinState, payload: {chatId: number, messageId: number}) =>\n\t\t\t{\n\t\t\t\tLogger.warn('Messages/pin model: add pin mutation', payload);\n\t\t\t\tconst {chatId, messageId} = payload;\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\tstate.collection[chatId] = new Set();\n\t\t\t\t}\n\n\t\t\t\tstate.collection[chatId].add(messageId);\n\t\t\t},\n\t\t\tdelete: (state: PinState, payload: {chatId: number, messageId: number}) =>\n\t\t\t{\n\t\t\t\tLogger.warn('Messages/pin model: delete pin mutation', payload);\n\t\t\t\tconst {chatId, messageId} = payload;\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstate.collection[chatId].delete(messageId);\n\t\t\t}\n\t\t};\n\t}\n}\n\ntype PinState = {\n\tcollection: {\n\t\t[chatId: string]: Set\n\t}\n};","import {BuilderModel} from 'ui.vue3.vuex';\nimport {reactionType as Reaction} from 'ui.reactions-select';\n\nimport {Core} from 'im.v2.application.core';\n\nimport type {Store, GetterTree, ActionTree, MutationTree} from 'ui.vue3.vuex';\nimport type {ImModelReactions} from 'im.v2.model';\n\ntype ReactionType = $Values<typeof Reaction>;\n\ntype RawReactions = {\n\tmessageId: number,\n\treactionCounters: {[reactionType: string]: number},\n\treactionUsers: {[reactionType: string]: number[]},\n\townReactions: ReactionType[]\n};\ntype RawReactionsList = RawReactions[];\n\ntype ReactionsState = {\n\tcollection: {\n\t\t[messageId: string]: ImModelReactions\n\t}\n};\n\nconst USERS_TO_SHOW = 5;\n\nexport class ReactionsModel extends BuilderModel\n{\n\tgetState(): ReactionsState\n\t{\n\t\treturn {\n\t\t\tcollection: {}\n\t\t};\n\t}\n\n\tgetElementState()\n\t{\n\t\treturn {\n\t\t\treactionCounters: {},\n\t\t\treactionUsers: {},\n\t\t\townReactions: new Set()\n\t\t};\n\t}\n\n\tgetGetters(): GetterTree\n\t{\n\t\treturn {\n\t\t\tgetByMessageId: (state: ReactionsState) => (messageId: number): ?ImModelReactions =>\n\t\t\t{\n\t\t\t\treturn state.collection[messageId];\n\t\t\t}\n\t\t};\n\t}\n\n\tgetActions(): ActionTree\n\t{\n\t\treturn {\n\t\t\tset: (store: Store, payload: RawReactionsList) =>\n\t\t\t{\n\t\t\t\tstore.commit('set', this.prepareSetPayload(payload));\n\t\t\t},\n\t\t\tsetReaction: (\n\t\t\t\tstore: Store,\n\t\t\t\tpayload: {messageId: number, userId: number, reaction: ReactionType}\n\t\t\t) =>\n\t\t\t{\n\t\t\t\tif (!Reaction[payload.reaction])\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (!store.state.collection[payload.messageId])\n\t\t\t\t{\n\t\t\t\t\tstore.state.collection[payload.messageId] = this.getElementState();\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setReaction', payload);\n\t\t\t},\n\t\t\tremoveReaction: (\n\t\t\t\tstore: Store,\n\t\t\t\tpayload: {messageId: number, userId: number, reaction: ReactionType}\n\t\t\t) =>\n\t\t\t{\n\t\t\t\tif (!store.state.collection[payload.messageId] || !Reaction[payload.reaction])\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tstore.commit('removeReaction', payload);\n\t\t\t}\n\t\t};\n\t}\n\n\tgetMutations(): MutationTree\n\t{\n\t\treturn {\n\t\t\tset: (state: ReactionsState, payload: RawReactionsList) =>\n\t\t\t{\n\t\t\t\tpayload.forEach(item => {\n\t\t\t\t\tconst newItem = {\n\t\t\t\t\t\treactionCounters: item.reactionCounters,\n\t\t\t\t\t\treactionUsers: item.reactionUsers\n\t\t\t\t\t};\n\n\t\t\t\t\tconst currentItem = state.collection[item.messageId];\n\t\t\t\t\tconst newOwnReaction = !!item.ownReactions;\n\t\t\t\t\tif (newOwnReaction)\n\t\t\t\t\t{\n\t\t\t\t\t\tnewItem.ownReactions = item.ownReactions;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tnewItem.ownReactions = currentItem ? currentItem.ownReactions : new Set();\n\t\t\t\t\t}\n\n\t\t\t\t\tstate.collection[item.messageId] = newItem;\n\t\t\t\t});\n\t\t\t},\n\t\t\tsetReaction: (\n\t\t\t\tstate: ReactionsState,\n\t\t\t\tpayload: {messageId: number, userId: number, reaction: ReactionType}\n\t\t\t) =>\n\t\t\t{\n\t\t\t\tconst {messageId, userId, reaction} = payload;\n\t\t\t\tconst reactions = state.collection[messageId];\n\t\t\t\tif (Core.getUserId() === userId)\n\t\t\t\t{\n\t\t\t\t\tthis.removeAllCurrentUserReactions(reactions);\n\t\t\t\t\treactions.ownReactions.add(reaction);\n\t\t\t\t}\n\n\t\t\t\tif (!reactions.reactionCounters[reaction])\n\t\t\t\t{\n\t\t\t\t\treactions.reactionCounters[reaction] = 0;\n\t\t\t\t}\n\t\t\t\tconst currentCounter = reactions.reactionCounters[reaction];\n\t\t\t\tif (currentCounter + 1 <= USERS_TO_SHOW)\n\t\t\t\t{\n\t\t\t\t\tif (!reactions.reactionUsers[reaction])\n\t\t\t\t\t{\n\t\t\t\t\t\treactions.reactionUsers[reaction] = new Set();\n\t\t\t\t\t}\n\t\t\t\t\treactions.reactionUsers[reaction].add(userId);\n\t\t\t\t}\n\n\t\t\t\treactions.reactionCounters[reaction]++;\n\t\t\t},\n\t\t\tremoveReaction: (\n\t\t\t\tstate: ReactionsState,\n\t\t\t\tpayload: {messageId: number, userId: number, reaction: ReactionType}\n\t\t\t) =>\n\t\t\t{\n\t\t\t\tconst {messageId, userId, reaction} = payload;\n\t\t\t\tconst reactions = state.collection[messageId];\n\n\t\t\t\tif (Core.getUserId() === userId)\n\t\t\t\t{\n\t\t\t\t\treactions.ownReactions.delete(reaction);\n\t\t\t\t}\n\n\t\t\t\treactions.reactionUsers[reaction]?.delete(userId);\n\t\t\t\treactions.reactionCounters[reaction]--;\n\t\t\t\tif (reactions.reactionCounters[reaction] === 0)\n\t\t\t\t{\n\t\t\t\t\tdelete reactions.reactionCounters[reaction];\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t}\n\n\tremoveAllCurrentUserReactions(reactions: ImModelReactions)\n\t{\n\t\treactions.ownReactions.forEach(reaction => {\n\t\t\treactions.reactionUsers[reaction]?.delete(Core.getUserId());\n\t\t\treactions.reactionCounters[reaction]--;\n\t\t\tif (reactions.reactionCounters[reaction] === 0)\n\t\t\t{\n\t\t\t\tdelete reactions.reactionCounters[reaction];\n\t\t\t}\n\t\t});\n\n\t\treactions.ownReactions = new Set();\n\t}\n\n\tprepareSetPayload(payload: RawReactionsList)\n\t{\n\t\treturn payload.map(item => {\n\t\t\tconst reactionUsers = {};\n\t\t\tObject.entries(item.reactionUsers).forEach(([reaction, users]) => {\n\t\t\t\treactionUsers[reaction] = new Set(users);\n\t\t\t});\n\n\t\t\tconst reactionCounters = {};\n\t\t\tObject.entries(item.reactionCounters).forEach(([reaction, counter]) => {\n\t\t\t\treactionCounters[reaction] = counter;\n\t\t\t});\n\n\t\t\tconst result = {\n\t\t\t\tmessageId: item.messageId,\n\t\t\t\treactionCounters: reactionCounters,\n\t\t\t\treactionUsers: reactionUsers\n\t\t\t};\n\n\t\t\tif (item.ownReactions?.length > 0)\n\t\t\t{\n\t\t\t\tresult.ownReactions = new Set(item.ownReactions);\n\t\t\t}\n\n\t\t\treturn result;\n\t\t});\n\t}\n}","import { Type } from 'main.core';\nimport { BuilderModel } from 'ui.vue3.vuex';\n\nimport { Core } from 'im.v2.application.core';\nimport { Utils } from 'im.v2.lib.utils';\nimport { Logger } from 'im.v2.lib.logger';\nimport { MessageComponent, MessageType } from 'im.v2.const';\n\nimport { PinModel } from './messages/pin';\nimport { ReactionsModel } from './messages/reactions';\n\nimport type { GetterTree, ActionTree, MutationTree } from 'ui.vue3.vuex';\nimport type { ImModelMessage, ImModelFile } from 'im.v2.model';\nimport type { RawMessage, RawMessageParams, PreparedMessageParams } from './type/message';\nimport type { AttachConfig } from 'im.v2.const';\n\ntype MessagesState = {\n\tcollection: {\n\t\t[messageId: string]: ImModelMessage\n\t},\n\tchatCollection: {\n\t\t[chatId: string]: Set<string | number>\n\t}\n};\n\nexport class MessagesModel extends BuilderModel\n{\n\tgetName(): string\n\t{\n\t\treturn 'messages';\n\t}\n\n\tgetNestedModules(): { [moduleName: string]: BuilderModel }\n\t{\n\t\treturn {\n\t\t\tpin: PinModel,\n\t\t\treactions: ReactionsModel,\n\t\t};\n\t}\n\n\tgetState(): MessagesState\n\t{\n\t\treturn {\n\t\t\tcollection: {},\n\t\t\tchatCollection: {},\n\t\t};\n\t}\n\n\tgetElementState(): ImModelMessage\n\t{\n\t\treturn {\n\t\t\tid: 0,\n\t\t\tchatId: 0,\n\t\t\tauthorId: 0,\n\t\t\treplyId: 0,\n\t\t\tdate: new Date(),\n\t\t\ttext: '',\n\t\t\treplaces: [],\n\t\t\tfiles: [],\n\t\t\tattach: [],\n\t\t\tunread: false,\n\t\t\tviewed: true,\n\t\t\tviewedByOthers: false,\n\t\t\tsending: false,\n\t\t\terror: false,\n\t\t\tretry: false,\n\t\t\tcomponentId: MessageComponent.base,\n\t\t\tcomponentParams: {},\n\t\t\tisEdited: false,\n\t\t\tisDeleted: false,\n\t\t\tremoveLinks: false,\n\t\t};\n\t}\n\n\t// eslint-disable-next-line max-lines-per-function\n\tgetGetters(): GetterTree\n\t{\n\t\treturn {\n\t\t\t/** @function messages/get */\n\t\t\tget: (state: MessagesState) => (chatId: number) => {\n\t\t\t\tif (!state.chatCollection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\treturn [...state.chatCollection[chatId]].map((messageId: number | string) => {\n\t\t\t\t\treturn state.collection[messageId];\n\t\t\t\t}).sort((a, b) => {\n\t\t\t\t\treturn a.id - b.id;\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function messages/getById */\n\t\t\tgetById: (state: MessagesState) => (id: number): ?ImModelMessage => {\n\t\t\t\treturn state.collection[id];\n\t\t\t},\n\t\t\t/** @function messages/getByIdList */\n\t\t\tgetByIdList: (state: MessagesState) => (idList: number[]): ImModelMessage[] => {\n\t\t\t\tconst result = [];\n\t\t\t\tidList.forEach((id) => {\n\t\t\t\t\tif (state.collection[id])\n\t\t\t\t\t{\n\t\t\t\t\t\tresult.push(state.collection[id]);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\treturn result;\n\t\t\t},\n\t\t\t/** @function messages/hasMessage */\n\t\t\thasMessage: (state: MessagesState) => ({ chatId, messageId}) => {\n\t\t\t\tif (!state.chatCollection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn state.chatCollection[chatId].has(messageId);\n\t\t\t},\n\t\t\t/** @function messages/isInChatCollection */\n\t\t\tisInChatCollection: (state: MessagesState) => (payload: {messageId: number}): boolean => {\n\t\t\t\tconst { messageId } = payload;\n\t\t\t\tconst message = state.collection[messageId];\n\t\t\t\tif (!message)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tconst { chatId } = message;\n\n\t\t\t\treturn state.chatCollection[chatId]?.has(messageId);\n\t\t\t},\n\t\t\t/** @function messages/getFirstId */\n\t\t\tgetFirstId: (state: MessagesState) => (chatId: number): number => {\n\t\t\t\tif (!state.chatCollection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn this.#findLowestMessageId(state, chatId);\n\t\t\t},\n\t\t\t/** @function messages/getLastId */\n\t\t\tgetLastId: (state: MessagesState) => (chatId: number): number => {\n\t\t\t\tif (!state.chatCollection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn this.#findMaxMessageId(state, chatId);\n\t\t\t},\n\t\t\t/** @function messages/getLastOwnMessageId */\n\t\t\tgetLastOwnMessageId: (state: MessagesState) => (chatId: number): number => {\n\t\t\t\tif (!state.chatCollection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn this.#findLastOwnMessageId(state, chatId);\n\t\t\t},\n\t\t\t/** @function messages/getFirstUnread */\n\t\t\tgetFirstUnread: (state: MessagesState) => (chatId: number): number => {\n\t\t\t\tif (!state.chatCollection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn this.#findFirstUnread(state, chatId);\n\t\t\t},\n\t\t\t/** @function messages/getChatUnreadMessages */\n\t\t\tgetChatUnreadMessages: (state: MessagesState) => (chatId: number): ImModelMessage[] => {\n\t\t\t\tif (!state.chatCollection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\tconst messages = [...state.chatCollection[chatId]].map((messageId: number | string) => {\n\t\t\t\t\treturn state.collection[messageId];\n\t\t\t\t});\n\n\t\t\t\treturn messages.filter((message: ImModelMessage) => {\n\t\t\t\t\treturn message.unread === true;\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function messages/getMessageFiles */\n\t\t\tgetMessageFiles: (state: MessagesState) => (payload: number): ImModelFile[] => {\n\t\t\t\tconst messageId = payload;\n\t\t\t\tif (!state.collection[messageId])\n\t\t\t\t{\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[messageId].files.map((fileId) => {\n\t\t\t\t\treturn this.store.getters['files/get'](fileId, true);\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function messages/getMessageType */\n\t\t\tgetMessageType: (state: MessagesState) => (messageId: number): ?$Values<typeof MessageType> => {\n\t\t\t\tconst message = state.collection[messageId];\n\t\t\t\tif (!message)\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\tconst currentUserId = Core.getUserId();\n\t\t\t\tif (message.authorId === 0)\n\t\t\t\t{\n\t\t\t\t\treturn MessageType.system;\n\t\t\t\t}\n\n\t\t\t\tif (message.authorId === currentUserId)\n\t\t\t\t{\n\t\t\t\t\treturn MessageType.self;\n\t\t\t\t}\n\n\t\t\t\treturn MessageType.opponent;\n\t\t\t},\n\t\t\t/** @function messages/getPreviousMessage */\n\t\t\tgetPreviousMessage: (state: MessagesState) => (payload: {messageId: number, chatId: number}): ?ImModelMessage => {\n\t\t\t\tconst { messageId, chatId } = payload;\n\t\t\t\tconst message = state.collection[messageId];\n\t\t\t\tif (!message)\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\tconst chatCollection = [...state.chatCollection[chatId]];\n\t\t\t\tconst initialMessageIndex = chatCollection.indexOf(messageId);\n\t\t\t\tconst desiredMessageId = chatCollection[initialMessageIndex - 1];\n\t\t\t\tif (!desiredMessageId)\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[desiredMessageId];\n\t\t\t},\n\t\t};\n\t}\n\n\t// eslint-disable-next-line max-lines-per-function\n\tgetActions(): ActionTree\n\t{\n\t\treturn {\n\t\t\t/** @function messages/setChatCollection */\n\t\t\tsetChatCollection: (store, payload: {messages: RawMessage | RawMessage[], clearCollection: boolean}) => {\n\t\t\t\tlet { messages, clearCollection } = payload;\n\t\t\t\tclearCollection = clearCollection ?? false;\n\t\t\t\tif (!Array.isArray(messages) && Type.isPlainObject(messages))\n\t\t\t\t{\n\t\t\t\t\tmessages = [messages];\n\t\t\t\t}\n\n\t\t\t\tmessages = messages.map((message: RawMessage) => {\n\t\t\t\t\treturn { ...this.getElementState(), ...this.validate(message) };\n\t\t\t\t});\n\n\t\t\t\tconst chatId = messages[0]?.chatId;\n\t\t\t\tif (chatId && clearCollection)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('clearCollection', { chatId });\n\t\t\t\t}\n\n\t\t\t\tstore.commit('store', { messages });\n\t\t\t\tstore.commit('setChatCollection', { messages });\n\t\t\t},\n\t\t\t/** @function messages/store */\n\t\t\tstore: (store, payload: RawMessage | RawMessage[]) => {\n\t\t\t\tlet preparedMessages = payload;\n\t\t\t\tif (Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\tpreparedMessages = [payload];\n\t\t\t\t}\n\n\t\t\t\tpreparedMessages = preparedMessages.map((message: RawMessage) => {\n\t\t\t\t\treturn { ...this.getElementState(), ...this.validate(message) };\n\t\t\t\t});\n\n\t\t\t\tif (preparedMessages.length === 0)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('store', {\n\t\t\t\t\tmessages: preparedMessages,\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function messages/add */\n\t\t\tadd: (store, payload: RawMessage) => {\n\t\t\t\tconst message = {\n\t\t\t\t\t...this.getElementState(),\n\t\t\t\t\t...this.validate(payload),\n\t\t\t\t};\n\t\t\t\tstore.commit('store', {\n\t\t\t\t\tmessages: [message],\n\t\t\t\t});\n\t\t\t\tstore.commit('setChatCollection', {\n\t\t\t\t\tmessages: [message],\n\t\t\t\t});\n\n\t\t\t\treturn message.id;\n\t\t\t},\n\t\t\t/** @function messages/updateWithId */\n\t\t\tupdateWithId: (store, payload: {id: string | number, fields: Object}) => {\n\t\t\t\tconst { id, fields } = payload;\n\t\t\t\tif (!store.state.collection[id])\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('updateWithId', {\n\t\t\t\t\tid,\n\t\t\t\t\tfields: this.validate(fields),\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function messages/update */\n\t\t\tupdate: (store, payload: {id: string | number, fields: Object}) => {\n\t\t\t\tconst { id, fields } = payload;\n\t\t\t\tconst currentMessage = store.state.collection[id];\n\t\t\t\tif (!currentMessage)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tid,\n\t\t\t\t\tfields: { ...currentMessage, ...this.validate(fields) }\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function messages/readMessages */\n\t\t\treadMessages: (store, payload: {chatId: number, messageIds: number[]}): number => {\n\t\t\t\tconst { chatId, messageIds } = payload;\n\t\t\t\tif (!store.state.chatCollection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\tconst chatMessages = [...store.state.chatCollection[chatId]].map((messageId: number) => {\n\t\t\t\t\treturn store.state.collection[messageId];\n\t\t\t\t});\n\n\t\t\t\tlet messagesToReadCount = 0;\n\t\t\t\tconst maxMessageId = this.#getMaxMessageId(messageIds);\n\t\t\t\tconst messageIdsToView = messageIds;\n\t\t\t\tconst messageIdsToRead = [];\n\t\t\t\tchatMessages.forEach((chatMessage: ImModelMessage) => {\n\t\t\t\t\tif (!chatMessage.unread)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (chatMessage.id <= maxMessageId)\n\t\t\t\t\t{\n\t\t\t\t\t\tmessagesToReadCount++;\n\t\t\t\t\t\tmessageIdsToRead.push(chatMessage.id);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tstore.commit('readMessages', {\n\t\t\t\t\tmessageIdsToRead,\n\t\t\t\t\tmessageIdsToView,\n\t\t\t\t});\n\n\t\t\t\treturn messagesToReadCount;\n\t\t\t},\n\t\t\t/** @function messages/setViewedByOthers */\n\t\t\tsetViewedByOthers: (store, payload: {ids: number[]}): number => {\n\t\t\t\tconst { ids } = payload;\n\t\t\t\tstore.commit('setViewedByOthers', {\n\t\t\t\t\tids,\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function messages/delete */\n\t\t\tdelete: (store, payload: {id: string | number}) => {\n\t\t\t\tconst { id } = payload;\n\t\t\t\tif (!store.state.collection[id])\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('delete', { id });\n\t\t\t},\n\t\t\t/** @function messages/clearChatCollection */\n\t\t\tclearChatCollection: (store, payload: {chatId: number}) => {\n\t\t\t\tconst { chatId } = payload;\n\t\t\t\tstore.commit('clearCollection', { chatId });\n\t\t\t},\n\t\t\t/** @function messages/deleteAttach */\n\t\t\tdeleteAttach: (store, payload: {messageId: number, attachId: string }) => {\n\t\t\t\tconst { messageId, attachId } = payload;\n\t\t\t\tconst message: ImModelMessage = store.state.collection[messageId];\n\t\t\t\tif (!message || !Type.isArray(message.attach))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst attach = message.attach.filter((attachItem: AttachConfig) => {\n\t\t\t\t\treturn attachId !== attachItem.ID;\n\t\t\t\t});\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tid: messageId,\n\t\t\t\t\tfields: { ...message, ...this.validate({ attach }) },\n\t\t\t\t});\n\t\t\t},\n\t\t};\n\t}\n\n\t/* eslint-disable no-param-reassign */\n\tgetMutations(): MutationTree\n\t{\n\t\treturn {\n\t\t\tsetChatCollection: (state: MessagesState, payload: {messages: ImModelMessage[]}) => {\n\t\t\t\tLogger.warn('Messages model: setChatCollection mutation', payload);\n\t\t\t\tpayload.messages.forEach((message) => {\n\t\t\t\t\tif (!state.chatCollection[message.chatId])\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.chatCollection[message.chatId] = new Set();\n\t\t\t\t\t}\n\t\t\t\t\tstate.chatCollection[message.chatId].add(message.id);\n\t\t\t\t});\n\t\t\t},\n\t\t\tstore: (state: MessagesState, payload: {messages: ImModelMessage[]}) => {\n\t\t\t\tLogger.warn('Messages model: store mutation', payload);\n\t\t\t\tpayload.messages.forEach((message) => {\n\t\t\t\t\tstate.collection[message.id] = message;\n\t\t\t\t});\n\t\t\t},\n\t\t\tupdateWithId: (state: MessagesState, payload: {id: number | string, fields: Object}) => {\n\t\t\t\tLogger.warn('Messages model: updateWithId mutation', payload);\n\t\t\t\tconst { id, fields } = payload;\n\t\t\t\tconst currentMessage = { ...state.collection[id] };\n\n\t\t\t\tdelete state.collection[id];\n\t\t\t\tstate.collection[fields.id] = { ...currentMessage, ...fields, sending: false };\n\n\t\t\t\tif (state.chatCollection[currentMessage.chatId].has(id))\n\t\t\t\t{\n\t\t\t\t\tstate.chatCollection[currentMessage.chatId].delete(id);\n\t\t\t\t\tstate.chatCollection[currentMessage.chatId].add(fields.id);\n\t\t\t\t}\n\t\t\t},\n\t\t\tupdate: (state: MessagesState, payload: {id: number | string, fields: Object}) => {\n\t\t\t\tLogger.warn('Messages model: update mutation', payload);\n\t\t\t\tconst { id, fields } = payload;\n\t\t\t\tstate.collection[id] = { ...state.collection[id], ...fields };\n\t\t\t},\n\t\t\tdelete: (state: MessagesState, payload: {id: number | string}) => {\n\t\t\t\tLogger.warn('Messages model: delete mutation', payload);\n\t\t\t\tconst { id } = payload;\n\t\t\t\tconst { chatId } = state.collection[id];\n\t\t\t\tstate.chatCollection[chatId].delete(id);\n\t\t\t\tdelete state.collection[id];\n\t\t\t},\n\t\t\tclearCollection: (state: MessagesState, payload: {chatId: number}) => {\n\t\t\t\tLogger.warn('Messages model: clear collection mutation', payload.chatId);\n\t\t\t\tstate.chatCollection[payload.chatId] = new Set();\n\t\t\t},\n\t\t\treadMessages: (state: MessagesState, payload: {messageIdsToRead: number[], messageIdsToView: number[]}) => {\n\t\t\t\tconst { messageIdsToRead, messageIdsToView } = payload;\n\t\t\t\tmessageIdsToRead.forEach((messageId) => {\n\t\t\t\t\tconst message = state.collection[messageId];\n\t\t\t\t\tif (!message)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tmessage.unread = false;\n\t\t\t\t});\n\t\t\t\tmessageIdsToView.forEach((messageId) => {\n\t\t\t\t\tconst message = state.collection[messageId];\n\t\t\t\t\tif (!message)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tmessage.viewed = true;\n\t\t\t\t});\n\t\t\t},\n\t\t\tsetViewedByOthers: (state: MessagesState, payload: {ids: number[]}) => {\n\t\t\t\tconst { ids } = payload;\n\t\t\t\tids.forEach((id) => {\n\t\t\t\t\tconst message = state.collection[id];\n\t\t\t\t\tif (!message)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tconst isOwnMessage = message.authorId === Core.getUserId();\n\t\t\t\t\tif (!isOwnMessage || message.viewedByOthers)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tmessage.viewedByOthers = true;\n\t\t\t\t});\n\t\t\t},\n\t\t};\n\t}\n\n\tvalidate(fields: Object): Object\n\t{\n\t\tlet result = {};\n\n\t\tif (Type.isNumber(fields.id))\n\t\t{\n\t\t\tresult.id = fields.id;\n\t\t}\n\t\telse if (Utils.text.isUuidV4(fields.temporaryId))\n\t\t{\n\t\t\tresult.id = fields.temporaryId;\n\t\t}\n\n\t\tif (!Type.isUndefined(fields.chat_id))\n\t\t{\n\t\t\tfields.chatId = fields.chat_id;\n\t\t}\n\t\tif (Type.isNumber(fields.chatId) || Type.isStringFilled(fields.chatId))\n\t\t{\n\t\t\tresult.chatId = Number.parseInt(fields.chatId, 10);\n\t\t}\n\n\t\tif (Type.isStringFilled(fields.date))\n\t\t{\n\t\t\tresult.date = Utils.date.cast(fields.date);\n\t\t}\n\n\t\tif (Type.isNumber(fields.text) || Type.isString(fields.text))\n\t\t{\n\t\t\tresult.text = fields.text.toString();\n\t\t}\n\n\t\tif (Type.isStringFilled(fields.system))\n\t\t{\n\t\t\tfields.isSystem = fields.system === 'Y';\n\t\t}\n\n\t\tif (!Type.isUndefined(fields.senderId))\n\t\t{\n\t\t\tfields.authorId = fields.senderId;\n\t\t}\n\t\telse if (!Type.isUndefined(fields.author_id))\n\t\t{\n\t\t\tfields.authorId = fields.author_id;\n\t\t}\n\t\tif (Type.isNumber(fields.authorId) || Type.isStringFilled(fields.authorId))\n\t\t{\n\t\t\tresult.authorId = Number.parseInt(fields.authorId, 10);\n\t\t}\n\n\t\tif (fields.isSystem === true)\n\t\t{\n\t\t\tresult.authorId = 0;\n\t\t}\n\n\t\tif (Type.isArray(fields.replaces))\n\t\t{\n\t\t\tresult.replaces = fields.replaces;\n\t\t}\n\n\t\tif (Type.isBoolean(fields.sending))\n\t\t{\n\t\t\tresult.sending = fields.sending;\n\t\t}\n\n\t\tif (Type.isBoolean(fields.unread))\n\t\t{\n\t\t\tresult.unread = fields.unread;\n\t\t}\n\n\t\tif (Type.isBoolean(fields.viewed))\n\t\t{\n\t\t\tresult.viewed = fields.viewed;\n\t\t}\n\n\t\tif (Type.isBoolean(fields.viewedByOthers))\n\t\t{\n\t\t\tresult.viewedByOthers = fields.viewedByOthers;\n\t\t}\n\n\t\tif (Type.isBoolean(fields.error))\n\t\t{\n\t\t\tresult.error = fields.error;\n\t\t}\n\n\t\tif (Type.isBoolean(fields.retry))\n\t\t{\n\t\t\tresult.retry = fields.retry;\n\t\t}\n\n\t\tif (Type.isString(fields.componentId))\n\t\t{\n\t\t\tresult.componentId = fields.componentId;\n\t\t}\n\n\t\tif (Type.isArray(fields.files))\n\t\t{\n\t\t\tresult.files = fields.files;\n\t\t}\n\n\t\tif (Type.isArray(fields.attach))\n\t\t{\n\t\t\tresult.attach = fields.attach;\n\t\t}\n\n\t\tif (Type.isBoolean(fields.isEdited))\n\t\t{\n\t\t\tresult.isEdited = fields.isEdited;\n\t\t}\n\n\t\tif (Type.isBoolean(fields.isDeleted))\n\t\t{\n\t\t\tresult.isDeleted = fields.isDeleted;\n\t\t}\n\n\t\tif (Type.isBoolean(fields.removeLinks))\n\t\t{\n\t\t\tresult.removeLinks = fields.removeLinks;\n\t\t}\n\n\t\tif (Type.isNumber(fields.replyId))\n\t\t{\n\t\t\tresult.replyId = fields.replyId;\n\t\t}\n\n\t\tif (Type.isPlainObject(fields.params))\n\t\t{\n\t\t\tconst preparedParams = this.prepareParams(fields.params);\n\t\t\tresult = {...result, ...preparedParams};\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tprepareParams(rawParams: RawMessageParams): PreparedMessageParams\n\t{\n\t\tconst result = {};\n\n\t\tObject.entries(rawParams).forEach(([key, value]) => {\n\t\t\tif (key === 'COMPONENT_ID' && Type.isStringFilled(value))\n\t\t\t{\n\t\t\t\tif (Object.values(MessageComponent).includes(value))\n\t\t\t\t{\n\t\t\t\t\tresult.componentId = value;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tresult.componentId = MessageComponent.unsupported;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (key === 'COMPONENT_PARAMS' && Type.isPlainObject(value))\n\t\t\t{\n\t\t\t\tresult.componentParams = value;\n\t\t\t}\n\t\t\telse if (key === 'FILE_ID' && Type.isArray(value))\n\t\t\t{\n\t\t\t\tresult.files = value;\n\t\t\t}\n\t\t\telse if (key === 'IS_EDITED' && Type.isStringFilled(value))\n\t\t\t{\n\t\t\t\tresult.isEdited = value === 'Y';\n\t\t\t}\n\t\t\telse if (key === 'REPLY_ID' && (Type.isStringFilled(value) || Type.isNumber(value)))\n\t\t\t{\n\t\t\t\tresult.replyId = Number(value);\n\t\t\t}\n\t\t\telse if (key === 'IS_DELETED' && Type.isStringFilled(value))\n\t\t\t{\n\t\t\t\tresult.isDeleted = value === 'Y';\n\t\t\t}\n\t\t\telse if (key === 'ATTACH' && (Type.isArray(value) || Type.isBoolean(value) || Type.isString(value)))\n\t\t\t{\n\t\t\t\tresult.attach = value;\n\t\t\t}\n\t\t\telse if (key === 'LINK_ACTIVE' && Type.isArrayFilled(value))\n\t\t\t{\n\t\t\t\tresult.removeLinks = value.includes(Core.getUserId());\n\t\t\t}\n\t\t});\n\n\t\treturn result;\n\t}\n\n\t#getMaxMessageId(messageIds: number[]): number\n\t{\n\t\tlet maxMessageId = 0;\n\t\tmessageIds.forEach(messageId => {\n\t\t\tif (maxMessageId < messageId)\n\t\t\t{\n\t\t\t\tmaxMessageId = messageId;\n\t\t\t}\n\t\t});\n\n\t\treturn maxMessageId;\n\t}\n\n\t#findLowestMessageId(state: MessagesState, chatId: number): number\n\t{\n\t\tlet firstId = null;\n\t\tconst messages = [...state.chatCollection[chatId]];\n\t\tfor (const messageId of messages)\n\t\t{\n\t\t\tconst element = state.collection[messageId];\n\t\t\tif (!firstId)\n\t\t\t{\n\t\t\t\tfirstId = element.id;\n\t\t\t}\n\t\t\tif (Utils.text.isTempMessage(element.id))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (element.id < firstId)\n\t\t\t{\n\t\t\t\tfirstId = element.id;\n\t\t\t}\n\t\t}\n\n\t\treturn firstId;\n\t}\n\n\t#findMaxMessageId(state: MessagesState, chatId: number): number\n\t{\n\t\tlet lastId = 0;\n\t\tconst messages = [...state.chatCollection[chatId]];\n\t\tfor (const messageId of messages)\n\t\t{\n\t\t\tconst element = state.collection[messageId];\n\t\t\tif (Utils.text.isTempMessage(element.id))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (element.id > lastId)\n\t\t\t{\n\t\t\t\tlastId = element.id;\n\t\t\t}\n\t\t}\n\n\t\treturn lastId;\n\t}\n\n\t#findLastOwnMessageId(state: MessagesState, chatId: number): number\n\t{\n\t\tlet lastOwnMessageId = 0;\n\t\tconst messages = [...state.chatCollection[chatId]].sort((a, z) => z - a);\n\t\tfor (const messageId of messages)\n\t\t{\n\t\t\tconst element = state.collection[messageId];\n\t\t\tif (Utils.text.isTempMessage(element.id))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (element.authorId === Core.getUserId())\n\t\t\t{\n\t\t\t\tlastOwnMessageId = element.id;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\treturn lastOwnMessageId;\n\t}\n\n\t#findFirstUnread(state: MessagesState, chatId: number): number\n\t{\n\t\tlet resultId = 0;\n\t\tfor (const messageId of state.chatCollection[chatId])\n\t\t{\n\t\t\tconst message: ImModelMessage = state.collection[messageId];\n\t\t\tif (message.unread)\n\t\t\t{\n\t\t\t\tresultId = messageId;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\treturn resultId;\n\t}\n}","import { Text, Type } from 'main.core';\nimport { BuilderModel } from 'ui.vue3.vuex';\n\nimport { Core } from 'im.v2.application.core';\nimport { Color, DialogType, UserRole } from 'im.v2.const';\nimport { Utils } from 'im.v2.lib.utils';\n\nimport type { GetterTree, ActionTree, MutationTree } from 'ui.vue3.vuex';\nimport type { Dialog as ImModelDialog } from './type/dialog';\n\nconst WRITING_STATUS_TIME = 35000;\n\ntype DialogState = {\n\tcollection: {[dialogId: string]: ImModelDialog},\n\twritingStatusTimers: {[timerId: string]: number},\n};\n\n/* eslint-disable no-param-reassign */\nexport class DialoguesModel extends BuilderModel\n{\n\tgetName(): string\n\t{\n\t\treturn 'dialogues';\n\t}\n\n\tgetState(): DialogState\n\t{\n\t\treturn {\n\t\t\tcollection: {},\n\t\t\twritingStatusTimers: {},\n\t\t};\n\t}\n\n\tgetElementState(): ImModelDialog\n\t{\n\t\treturn {\n\t\t\tdialogId: '0',\n\t\t\tchatId: 0,\n\t\t\ttype: DialogType.chat,\n\t\t\tname: '',\n\t\t\tdescription: '',\n\t\t\tavatar: '',\n\t\t\tcolor: Color.base,\n\t\t\textranet: false,\n\t\t\tcounter: 0,\n\t\t\tuserCounter: 0,\n\t\t\tlastReadId: 0,\n\t\t\tmarkedId: 0,\n\t\t\tlastMessageId: 0,\n\t\t\tlastMessageViews: {\n\t\t\t\tcountOfViewers: 0,\n\t\t\t\tfirstViewer: null,\n\t\t\t\tmessageId: 0,\n\t\t\t},\n\t\t\tsavedPositionMessageId: 0,\n\t\t\tmanagerList: [],\n\t\t\twritingList: [],\n\t\t\tmuteList: [],\n\t\t\ttextareaMessage: '',\n\t\t\tquoteId: 0,\n\t\t\towner: 0,\n\t\t\tentityType: '',\n\t\t\tentityId: '',\n\t\t\tdateCreate: null,\n\t\t\tpublic: {\n\t\t\t\tcode: '',\n\t\t\t\tlink: '',\n\t\t\t},\n\t\t\tinited: false,\n\t\t\tloading: false,\n\t\t\thasPrevPage: false,\n\t\t\thasNextPage: false,\n\t\t\tdiskFolderId: 0,\n\t\t\trole: UserRole.guest,\n\t\t\tpermissions: {\n\t\t\t\tmanageUsers: UserRole.none,\n\t\t\t\tmanageUi: UserRole.none,\n\t\t\t\tmanageSettings: UserRole.none,\n\t\t\t\tcanPost: UserRole.none,\n\t\t\t},\n\t\t};\n\t}\n\n\t// eslint-disable-next-line max-lines-per-function\n\tgetGetters(): GetterTree\n\t{\n\t\treturn {\n\t\t\t/** @function dialogues/get */\n\t\t\tget: (state: DialogState) => (dialogId: string, getBlank: boolean = false) => {\n\t\t\t\tif (!state.collection[dialogId] && getBlank)\n\t\t\t\t{\n\t\t\t\t\treturn this.getElementState();\n\t\t\t\t}\n\n\t\t\t\tif (!state.collection[dialogId] && !getBlank)\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[dialogId];\n\t\t\t},\n\t\t\t/** @function dialogues/getByChatId */\n\t\t\tgetByChatId: (state: DialogState) => (chatId: number | string) => {\n\t\t\t\tconst preparedChatId = Number.parseInt(chatId, 10);\n\n\t\t\t\treturn Object.values(state.collection).find((item) => {\n\t\t\t\t\treturn item.chatId === preparedChatId;\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function dialogues/getQuoteId */\n\t\t\tgetQuoteId: (state: DialogState) => (dialogId: string) => {\n\t\t\t\tif (!state.collection[dialogId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[dialogId].quoteId;\n\t\t\t},\n\t\t\t/** @function dialogues/isUser */\n\t\t\tisUser: (state: DialogState) => (dialogId: string) => {\n\t\t\t\tif (!state.collection[dialogId])\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[dialogId].type === DialogType.user;\n\t\t\t},\n\t\t\t/** @function dialogues/getLastReadId */\n\t\t\tgetLastReadId: (state: DialogState) => (dialogId: string): number => {\n\t\t\t\tif (!state.collection[dialogId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\tconst { lastReadId, lastMessageId } = state.collection[dialogId];\n\n\t\t\t\treturn lastReadId === lastMessageId ? 0 : lastReadId;\n\t\t\t},\n\t\t\t/** @function dialogues/getInitialMessageId */\n\t\t\tgetInitialMessageId: (state: DialogState) => (dialogId: string): number => {\n\t\t\t\tif (!state.collection[dialogId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\tconst { lastReadId, markedId } = state.collection[dialogId];\n\t\t\t\tif (markedId === 0)\n\t\t\t\t{\n\t\t\t\t\treturn lastReadId;\n\t\t\t\t}\n\n\t\t\t\treturn Math.min(lastReadId, markedId);\n\t\t\t},\n\t\t};\n\t}\n\n\t// eslint-disable-next-line max-lines-per-function\n\tgetActions(): ActionTree\n\t{\n\t\treturn {\n\t\t\t/** @function dialogues/set */\n\t\t\tset: (store, rawPayload: Array | Object) => {\n\t\t\t\tlet payload = rawPayload;\n\t\t\t\tif (!Array.isArray(payload) && Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\tpayload = [payload];\n\t\t\t\t}\n\n\t\t\t\tpayload.map((element) => {\n\t\t\t\t\treturn this.validate(element);\n\t\t\t\t}).forEach((element) => {\n\t\t\t\t\tconst existingItem = store.state.collection[element.dialogId];\n\t\t\t\t\tif (existingItem)\n\t\t\t\t\t{\n\t\t\t\t\t\tstore.commit('update', {\n\t\t\t\t\t\t\tdialogId: element.dialogId,\n\t\t\t\t\t\t\tfields: element,\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tstore.commit('add', {\n\t\t\t\t\t\t\tdialogId: element.dialogId,\n\t\t\t\t\t\t\tfields: { ...this.getElementState(), ...element },\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function dialogues/add */\n\t\t\tadd: (store, rawPayload: Array | Object) => {\n\t\t\t\tlet payload = rawPayload;\n\t\t\t\tif (!Array.isArray(payload) && Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\tpayload = [payload];\n\t\t\t\t}\n\n\t\t\t\tpayload.map((element) => {\n\t\t\t\t\treturn this.validate(element);\n\t\t\t\t}).forEach((element) => {\n\t\t\t\t\tconst existingItem = store.state.collection[element.dialogId];\n\t\t\t\t\tif (!existingItem)\n\t\t\t\t\t{\n\t\t\t\t\t\tstore.commit('add', {\n\t\t\t\t\t\t\tdialogId: element.dialogId,\n\t\t\t\t\t\t\tfields: { ...this.getElementState(), ...element },\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function dialogues/update */\n\t\t\tupdate: (store, payload: {dialogId: string, fields: Object}) => {\n\t\t\t\tconst existingItem = store.state.collection[payload.dialogId];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tdialogId: payload.dialogId,\n\t\t\t\t\tfields: this.validate(payload.fields),\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function dialogues/delete */\n\t\t\tdelete: (store, payload: {dialogId: string}) => {\n\t\t\t\tconst existingItem = store.state.collection[payload.dialogId];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('delete', { dialogId: payload.dialogId });\n\t\t\t},\n\t\t\t/** @function dialogues/startWriting */\n\t\t\tstartWriting: (store, payload: {dialogId: string, userId: number, userName: string}) => {\n\t\t\t\tconst existingItem = store.state.collection[payload.dialogId];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst timerId = `${payload.dialogId}|${payload.userId}`;\n\t\t\t\tconst alreadyWriting = existingItem.writingList.some((el) => el.userId === payload.userId);\n\t\t\t\tif (alreadyWriting)\n\t\t\t\t{\n\t\t\t\t\tclearTimeout(store.state.writingStatusTimers[timerId]);\n\t\t\t\t\tstore.state.writingStatusTimers[timerId] = this.setWritingStatusTimeout(payload);\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst newItem = { userId: payload.userId, userName: payload.userName };\n\t\t\t\tconst newWritingList = [newItem, ...existingItem.writingList];\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tactionName: 'startWriting',\n\t\t\t\t\tdialogId: payload.dialogId,\n\t\t\t\t\tfields: this.validate({ writingList: newWritingList }),\n\t\t\t\t});\n\n\t\t\t\tif (!store.state.writingStatusTimers[timerId])\n\t\t\t\t{\n\t\t\t\t\tstore.state.writingStatusTimers[timerId] = this.setWritingStatusTimeout(payload);\n\t\t\t\t}\n\t\t\t},\n\t\t\t/** @function dialogues/stopWriting */\n\t\t\tstopWriting: (store, payload: {dialogId: string, userId: number}) => {\n\t\t\t\tconst existingItem = store.state.collection[payload.dialogId];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst alreadyWriting = existingItem.writingList.find((el) => el.userId === payload.userId);\n\t\t\t\tif (!alreadyWriting)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst newWritingList = existingItem.writingList.filter((item) => item.userId !== payload.userId);\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tactionName: 'stopWriting',\n\t\t\t\t\tdialogId: payload.dialogId,\n\t\t\t\t\tfields: this.validate({ writingList: newWritingList }),\n\t\t\t\t});\n\n\t\t\t\tconst timerId = `${payload.dialogId}|${payload.userId}`;\n\t\t\t\tclearTimeout(store.state.writingStatusTimers[timerId]);\n\t\t\t\tdelete store.state.writingStatusTimers[timerId];\n\t\t\t},\n\t\t\t/** @function dialogues/increaseCounter */\n\t\t\tincreaseCounter: (store, payload: {dialogId: string, count: number}) => {\n\t\t\t\tconst existingItem = store.state.collection[payload.dialogId];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (existingItem.counter === 100)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tlet increasedCounter = existingItem.counter + payload.count;\n\t\t\t\tif (increasedCounter > 100)\n\t\t\t\t{\n\t\t\t\t\tincreasedCounter = 100;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tactionName: 'increaseCounter',\n\t\t\t\t\tdialogId: payload.dialogId,\n\t\t\t\t\tfields: {\n\t\t\t\t\t\tcounter: increasedCounter,\n\t\t\t\t\t\tpreviousCounter: existingItem.counter\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function dialogues/decreaseCounter */\n\t\t\tdecreaseCounter: (store, payload: {dialogId: string, count: number}) => {\n\t\t\t\tconst existingItem = store.state.collection[payload.dialogId];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (existingItem.counter === 100)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tlet decreasedCounter = existingItem.counter - payload.count;\n\t\t\t\tif (decreasedCounter < 0)\n\t\t\t\t{\n\t\t\t\t\tdecreasedCounter = 0;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tactionName: 'decreaseCounter',\n\t\t\t\t\tdialogId: payload.dialogId,\n\t\t\t\t\tfields: {\n\t\t\t\t\t\tcounter: decreasedCounter,\n\t\t\t\t\t\tpreviousCounter: existingItem.counter,\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function dialogues/clearCounters */\n\t\t\tclearCounters: (store) => {\n\t\t\t\tstore.commit('clearCounters');\n\t\t\t},\n\t\t\t/** @function dialogues/mute */\n\t\t\tmute: (store, payload: {dialogId: string}) => {\n\t\t\t\tconst existingItem = store.state.collection[payload.dialogId];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst currentUserId = Core.getUserId();\n\t\t\t\tif (existingItem.muteList.includes(currentUserId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tconst muteList = [...existingItem.muteList, currentUserId];\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tactionName: 'mute',\n\t\t\t\t\tdialogId: payload.dialogId,\n\t\t\t\t\tfields: this.validate({ muteList }),\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function dialogues/unmute */\n\t\t\tunmute: (store, payload: {dialogId: string}) => {\n\t\t\t\tconst existingItem = store.state.collection[payload.dialogId];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst currentUserId = Core.getUserId();\n\t\t\t\tconst muteList = existingItem.muteList.filter((item) => item !== currentUserId);\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tactionName: 'unmute',\n\t\t\t\t\tdialogId: payload.dialogId,\n\t\t\t\t\tfields: this.validate({ muteList }),\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function dialogues/setLastMessageViews */\n\t\t\tsetLastMessageViews: (store, payload: {\n\t\t\t\tdialogId: string,\n\t\t\t\tfields: {userId: number, userName: string, date: string, messageId: number}\n\t\t\t}) => {\n\t\t\t\tconst { dialogId, fields: { userId, userName, date, messageId } } = payload;\n\t\t\t\tconst existingItem: ImModelDialog = store.state.collection[dialogId];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst newLastMessageViews = {\n\t\t\t\t\tcountOfViewers: 1,\n\t\t\t\t\tmessageId,\n\t\t\t\t\tfirstViewer: {\n\t\t\t\t\t\tuserId,\n\t\t\t\t\t\tuserName,\n\t\t\t\t\t\tdate: Utils.date.cast(date),\n\t\t\t\t\t},\n\t\t\t\t};\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tactionName: 'setLastMessageViews',\n\t\t\t\t\tdialogId,\n\t\t\t\t\tfields: {\n\t\t\t\t\t\tlastMessageViews: newLastMessageViews,\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function dialogues/clearLastMessageViews */\n\t\t\tclearLastMessageViews: (store, payload: {dialogId: string}) => {\n\t\t\t\tconst existingItem = store.state.collection[payload.dialogId];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst { lastMessageViews: defaultLastMessageViews } = this.getElementState();\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tactionName: 'clearLastMessageViews',\n\t\t\t\t\tdialogId: payload.dialogId,\n\t\t\t\t\tfields: {\n\t\t\t\t\t\tlastMessageViews: defaultLastMessageViews,\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function dialogues/incrementLastMessageViews */\n\t\t\tincrementLastMessageViews: (store, payload: {dialogId: string}) => {\n\t\t\t\tconst existingItem: ImModelDialog = store.state.collection[payload.dialogId];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst newCounter = existingItem.lastMessageViews.countOfViewers + 1;\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tactionName: 'incrementLastMessageViews',\n\t\t\t\t\tdialogId: payload.dialogId,\n\t\t\t\t\tfields: {\n\t\t\t\t\t\tlastMessageViews: { ...existingItem.lastMessageViews, countOfViewers: newCounter },\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMutations(): MutationTree\n\t{\n\t\treturn {\n\t\t\tadd: (state: DialogState, payload) => {\n\t\t\t\tstate.collection[payload.dialogId] = payload.fields;\n\t\t\t},\n\t\t\tupdate: (state: DialogState, payload) => {\n\t\t\t\tstate.collection[payload.dialogId] = { ...state.collection[payload.dialogId], ...payload.fields };\n\t\t\t},\n\t\t\tdelete: (state: DialogState, payload) => {\n\t\t\t\tdelete state.collection[payload.dialogId];\n\t\t\t},\n\t\t\tclearCounters: (state: DialogState) => {\n\t\t\t\tObject.keys(state.collection).forEach((key) => {\n\t\t\t\t\tstate.collection[key].counter = 0;\n\t\t\t\t\tstate.collection[key].markedId = 0;\n\t\t\t\t});\n\t\t\t},\n\t\t};\n\t}\n\n\tsetWritingStatusTimeout(payload: {dialogId: string, userId: number})\n\t{\n\t\treturn setTimeout(() => {\n\t\t\tthis.store.dispatch('dialogues/stopWriting', {\n\t\t\t\tdialogId: payload.dialogId,\n\t\t\t\tuserId: payload.userId,\n\t\t\t});\n\t\t}, WRITING_STATUS_TIME);\n\t}\n\n\tvalidate(fields)\n\t{\n\t\tconst result = {};\n\n\t\tif (!Type.isUndefined(fields.dialog_id))\n\t\t{\n\t\t\tfields.dialogId = fields.dialog_id;\n\t\t}\n\t\tif (Type.isNumber(fields.dialogId) || Type.isStringFilled(fields.dialogId))\n\t\t{\n\t\t\tresult.dialogId = fields.dialogId.toString();\n\t\t}\n\n\t\tif (!Type.isUndefined(fields.chat_id))\n\t\t{\n\t\t\tfields.chatId = fields.chat_id;\n\t\t}\n\t\telse if (!Type.isUndefined(fields.id))\n\t\t{\n\t\t\tfields.chatId = fields.id;\n\t\t}\n\t\tif (Type.isNumber(fields.chatId) || Type.isStringFilled(fields.chatId))\n\t\t{\n\t\t\tresult.chatId = Number.parseInt(fields.chatId, 10);\n\t\t}\n\n\t\tif (Type.isStringFilled(fields.type))\n\t\t{\n\t\t\tresult.type = fields.type.toString();\n\t\t}\n\n\t\tif (Type.isNumber(fields.quoteId))\n\t\t{\n\t\t\tresult.quoteId = Number.parseInt(fields.quoteId, 10);\n\t\t}\n\n\t\tif (Type.isNumber(fields.counter) || Type.isStringFilled(fields.counter))\n\t\t{\n\t\t\tresult.counter = Number.parseInt(fields.counter, 10);\n\t\t}\n\n\t\tif (!Type.isUndefined(fields.user_counter))\n\t\t{\n\t\t\tresult.userCounter = fields.user_counter;\n\t\t}\n\t\tif (Type.isNumber(fields.userCounter) || Type.isStringFilled(fields.userCounter))\n\t\t{\n\t\t\tresult.userCounter = Number.parseInt(fields.userCounter, 10);\n\t\t}\n\n\t\tif (!Type.isUndefined(fields.last_id))\n\t\t{\n\t\t\tfields.lastId = fields.last_id;\n\t\t}\n\t\tif (Type.isNumber(fields.lastId))\n\t\t{\n\t\t\tresult.lastReadId = fields.lastId;\n\t\t}\n\n\t\tif (!Type.isUndefined(fields.marked_id))\n\t\t{\n\t\t\tfields.markedId = fields.marked_id;\n\t\t}\n\t\tif (Type.isNumber(fields.markedId))\n\t\t{\n\t\t\tresult.markedId = fields.markedId;\n\t\t}\n\n\t\tif (!Type.isUndefined(fields.last_message_id))\n\t\t{\n\t\t\tfields.lastMessageId = fields.last_message_id;\n\t\t}\n\t\tif (Type.isNumber(fields.lastMessageId) || Type.isStringFilled(fields.lastMessageId))\n\t\t{\n\t\t\tresult.lastMessageId = Number.parseInt(fields.lastMessageId, 10);\n\t\t}\n\n\t\tif (Type.isPlainObject(fields.last_message_views))\n\t\t{\n\t\t\tfields.lastMessageViews = fields.last_message_views;\n\t\t}\n\t\tif (Type.isPlainObject(fields.lastMessageViews))\n\t\t{\n\t\t\tresult.lastMessageViews = this.prepareLastMessageViews(fields.lastMessageViews);\n\t\t}\n\n\t\tif (Type.isBoolean(fields.hasPrevPage))\n\t\t{\n\t\t\tresult.hasPrevPage = fields.hasPrevPage;\n\t\t}\n\n\t\tif (Type.isBoolean(fields.hasNextPage))\n\t\t{\n\t\t\tresult.hasNextPage = fields.hasNextPage;\n\t\t}\n\n\t\tif (Type.isNumber(fields.savedPositionMessageId))\n\t\t{\n\t\t\tresult.savedPositionMessageId = fields.savedPositionMessageId;\n\t\t}\n\n\t\tif (!Type.isUndefined(fields.textareaMessage))\n\t\t{\n\t\t\tresult.textareaMessage = fields.textareaMessage.toString();\n\t\t}\n\n\t\tif (!Type.isUndefined(fields.title))\n\t\t{\n\t\t\tfields.name = fields.title;\n\t\t}\n\t\tif (Type.isNumber(fields.name) || Type.isStringFilled(fields.name))\n\t\t{\n\t\t\tresult.name = Text.decode(fields.name.toString());\n\t\t}\n\n\t\tif (!Type.isUndefined(fields.owner))\n\t\t{\n\t\t\tfields.ownerId = fields.owner;\n\t\t}\n\t\tif (Type.isNumber(fields.ownerId) || Type.isStringFilled(fields.ownerId))\n\t\t{\n\t\t\tresult.owner = Number.parseInt(fields.ownerId, 10);\n\t\t}\n\n\t\tif (Type.isString(fields.avatar))\n\t\t{\n\t\t\tresult.avatar = this.prepareAvatar(fields.avatar);\n\t\t}\n\n\t\tif (Type.isStringFilled(fields.color))\n\t\t{\n\t\t\tresult.color = fields.color;\n\t\t}\n\n\t\tif (Type.isBoolean(fields.extranet))\n\t\t{\n\t\t\tresult.extranet = fields.extranet;\n\t\t}\n\n\t\tif (!Type.isUndefined(fields.entity_type))\n\t\t{\n\t\t\tfields.entityType = fields.entity_type;\n\t\t}\n\t\tif (Type.isStringFilled(fields.entityType))\n\t\t{\n\t\t\tresult.entityType = fields.entityType;\n\t\t}\n\t\tif (!Type.isUndefined(fields.entity_id))\n\t\t{\n\t\t\tfields.entityId = fields.entity_id;\n\t\t}\n\t\tif (Type.isNumber(fields.entityId) || Type.isStringFilled(fields.entityId))\n\t\t{\n\t\t\tresult.entityId = fields.entityId.toString();\n\t\t}\n\n\t\tif (!Type.isUndefined(fields.date_create))\n\t\t{\n\t\t\tfields.dateCreate = fields.date_create;\n\t\t}\n\t\tif (!Type.isUndefined(fields.dateCreate))\n\t\t{\n\t\t\tresult.dateCreate = Utils.date.cast(fields.dateCreate);\n\t\t}\n\n\t\tif (Type.isPlainObject(fields.public))\n\t\t{\n\t\t\tresult.public = {};\n\n\t\t\tif (Type.isStringFilled(fields.public.code))\n\t\t\t{\n\t\t\t\tresult.public.code = fields.public.code;\n\t\t\t}\n\n\t\t\tif (Type.isStringFilled(fields.public.link))\n\t\t\t{\n\t\t\t\tresult.public.link = fields.public.link;\n\t\t\t}\n\t\t}\n\n\t\tif (!Type.isUndefined(fields.writing_list))\n\t\t{\n\t\t\tfields.writingList = fields.writing_list;\n\t\t}\n\t\tif (Type.isArray(fields.writingList))\n\t\t{\n\t\t\tresult.writingList = this.prepareWritingList(fields.writingList);\n\t\t}\n\n\t\tif (!Type.isUndefined(fields.manager_list))\n\t\t{\n\t\t\tfields.managerList = fields.manager_list;\n\t\t}\n\t\tif (Type.isArray(fields.managerList))\n\t\t{\n\t\t\tresult.managerList = [];\n\n\t\t\tfields.managerList.forEach(userId =>\n\t\t\t{\n\t\t\t\tuserId = Number.parseInt(userId, 10);\n\t\t\t\tif (userId > 0)\n\t\t\t\t{\n\t\t\t\t\tresult.managerList.push(userId);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tif (!Type.isUndefined(fields.mute_list))\n\t\t{\n\t\t\tfields.muteList = fields.mute_list;\n\t\t}\n\t\tif (Type.isArray(fields.muteList) || Type.isPlainObject(fields.muteList))\n\t\t{\n\t\t\tresult.muteList = this.prepareMuteList(fields.muteList);\n\t\t}\n\n\t\tif (Type.isBoolean(fields.inited))\n\t\t{\n\t\t\tresult.inited = fields.inited;\n\t\t}\n\n\t\tif (Type.isBoolean(fields.loading))\n\t\t{\n\t\t\tresult.loading = fields.loading;\n\t\t}\n\n\t\tif (Type.isString(fields.description))\n\t\t{\n\t\t\tresult.description = fields.description;\n\t\t}\n\n\t\tif (Type.isNumber(fields.disk_folder_id))\n\t\t{\n\t\t\tresult.diskFolderId = fields.disk_folder_id;\n\t\t}\n\n\t\tfields.role = fields.role?.toString().toLowerCase();\n\t\tif (UserRole[fields.role])\n\t\t{\n\t\t\tresult.role = fields.role;\n\t\t}\n\n\t\tconst preparedPermissions = this.preparePermissions(fields);\n\t\tif (Object.values(preparedPermissions).length > 0)\n\t\t{\n\t\t\tresult.permissions = preparedPermissions;\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tpreparePermissions(fields: Object<string, any>): {manageUi?: string, manageUsers?: string, manageSettings?: string}\n\t{\n\t\tconst result = {};\n\n\t\tif (Type.isStringFilled(fields.manage_settings))\n\t\t{\n\t\t\tfields.manageSettings = fields.manage_settings;\n\t\t}\n\n\t\tif (Type.isStringFilled(fields.manage_ui))\n\t\t{\n\t\t\tfields.manageUi = fields.manage_ui;\n\t\t}\n\n\t\tif (Type.isStringFilled(fields.manage_users))\n\t\t{\n\t\t\tfields.manageUsers = fields.manage_users;\n\t\t}\n\n\t\tif (Type.isStringFilled(fields.can_post))\n\t\t{\n\t\t\tfields.canPost = fields.can_post;\n\t\t}\n\n\t\tfields.manageSettings = fields.manageSettings?.toString().toLowerCase();\n\t\tif (fields.manageSettings === 'all')\n\t\t{\n\t\t\tfields.manageSettings = UserRole.member;\n\t\t}\n\n\t\tif (UserRole[fields.manageSettings])\n\t\t{\n\t\t\tresult.manageSettings = fields.manageSettings;\n\t\t}\n\n\t\tfields.manageUsers = fields.manageUsers?.toString().toLowerCase();\n\t\tif (fields.manageUsers === 'all')\n\t\t{\n\t\t\tfields.manageUsers = UserRole.member;\n\t\t}\n\n\t\tif (UserRole[fields.manageUsers])\n\t\t{\n\t\t\tresult.manageUsers = fields.manageUsers;\n\t\t}\n\n\t\tfields.manageUi = fields.manageUi?.toString().toLowerCase();\n\t\tif (fields.manageUi === 'all')\n\t\t{\n\t\t\tfields.manageUi = UserRole.member;\n\t\t}\n\n\t\tif (UserRole[fields.manageUi])\n\t\t{\n\t\t\tresult.manageUi = fields.manageUi;\n\t\t}\n\n\t\tfields.canPost = fields.canPost?.toString().toLowerCase();\n\t\tif (fields.canPost === 'all')\n\t\t{\n\t\t\tfields.canPost = UserRole.member;\n\t\t}\n\n\t\tif (UserRole[fields.canPost])\n\t\t{\n\t\t\tresult.canPost = fields.canPost;\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tprepareAvatar(avatar: string): string\n\t{\n\t\tlet result = '';\n\n\t\tif (!avatar || avatar.endsWith('/js/im/images/blank.gif'))\n\t\t{\n\t\t\tresult = '';\n\t\t}\n\t\telse if (avatar.startsWith('http'))\n\t\t{\n\t\t\tresult = avatar;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tresult = Core.getHost() + avatar;\n\t\t}\n\n\t\tif (result)\n\t\t{\n\t\t\tresult = encodeURI(result);\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tprepareWritingList(writingList: Object[]): Array<{userId: number, userName: string}>\n\t{\n\t\tconst result = [];\n\n\t\twritingList.forEach(element =>\n\t\t{\n\t\t\tconst item = {};\n\n\t\t\tif (!element.userId)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\titem.userId = Number.parseInt(element.userId, 10);\n\t\t\titem.userName = Utils.text.htmlspecialcharsback(element.userName);\n\n\t\t\tresult.push(item);\n\t\t});\n\n\t\treturn result;\n\t}\n\n\tprepareMuteList(muteList: Object[] | Object): Object[]\n\t{\n\t\tconst result = [];\n\n\t\tif (Type.isArray(muteList))\n\t\t{\n\t\t\tmuteList.forEach(userId =>\n\t\t\t{\n\t\t\t\tuserId = Number.parseInt(userId, 10);\n\t\t\t\tif (userId > 0)\n\t\t\t\t{\n\t\t\t\t\tresult.push(userId);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\telse if (Type.isPlainObject(muteList))\n\t\t{\n\t\t\tObject.entries(muteList).forEach(([key, value]) => {\n\t\t\t\tif (!value)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tconst userId = Number.parseInt(key, 10);\n\t\t\t\tif (userId > 0)\n\t\t\t\t{\n\t\t\t\t\tresult.push(userId);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tprepareLastMessageViews(rawLastMessageViews): {countOfViewers: number, firstViewers: Object[], messageId: number}\n\t{\n\t\tconst {\n\t\t\tcountOfViewers,\n\t\t\tfirstViewers: rawFirstViewers,\n\t\t\tmessageId,\n\t\t} = rawLastMessageViews;\n\n\t\tlet firstViewer;\n\t\tfor (const rawFirstViewer of rawFirstViewers)\n\t\t{\n\t\t\tif (rawFirstViewer.userId === Core.getUserId())\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tfirstViewer = {\n\t\t\t\tuserId: rawFirstViewer.userId,\n\t\t\t\tuserName: rawFirstViewer.userName,\n\t\t\t\tdate: Utils.date.cast(rawFirstViewer.date),\n\t\t\t};\n\t\t\tbreak;\n\t\t}\n\n\t\tif (countOfViewers > 0 && !firstViewer)\n\t\t{\n\t\t\tthrow new Error('Dialogues model: no first viewer for message');\n\t\t}\n\n\t\treturn {\n\t\t\tcountOfViewers,\n\t\t\tfirstViewer,\n\t\t\tmessageId,\n\t\t};\n\t}\n}\n","import {Type, Loc} from 'main.core';\nimport {BuilderModel} from 'ui.vue3.vuex';\n\nimport {Core} from 'im.v2.application.core';\nimport {Utils} from 'im.v2.lib.utils';\nimport {UserStatus, BotType, Color} from 'im.v2.const';\n\nimport type {User as ImModelUser} from './type/user';\n\nexport class UsersModel extends BuilderModel\n{\n\tgetName()\n\t{\n\t\treturn 'users';\n\t}\n\n\tgetState()\n\t{\n\t\treturn {\n\t\t\tcollection: {},\n\t\t\tonlineList: [],\n\t\t\tmobileOnlineList: [],\n\t\t\tabsentList: [],\n\t\t\tbotList: {}\n\t\t};\n\t}\n\n\tgetElementState(params = {})\n\t{\n\t\tconst {id = 0} = params;\n\n\t\treturn {\n\t\t\tid,\n\t\t\tname: '',\n\t\t\tfirstName: '',\n\t\t\tlastName: '',\n\t\t\tavatar: '',\n\t\t\tcolor: Color.base,\n\t\t\tworkPosition: '',\n\t\t\tgender: 'M',\n\t\t\tisAdmin: false,\n\t\t\textranet: false,\n\t\t\tnetwork: false,\n\t\t\tbot: false,\n\t\t\tconnector: false,\n\t\t\texternalAuthId: 'default',\n\t\t\tstatus: '',\n\t\t\tidle: false,\n\t\t\tlastActivityDate: false,\n\t\t\tmobileLastDate: false,\n\t\t\tisOnline: false,\n\t\t\tisMobileOnline: false,\n\t\t\tbirthday: false,\n\t\t\tisBirthday: false,\n\t\t\tabsent: false,\n\t\t\tisAbsent: false,\n\t\t\tdepartments: [],\n\t\t\tphones: {\n\t\t\t\tworkPhone: '',\n\t\t\t\tpersonalMobile: '',\n\t\t\t\tpersonalPhone: '',\n\t\t\t\tinnerPhone: '',\n\t\t\t}\n\t\t};\n\t}\n\n\tgetGetters()\n\t{\n\t\treturn {\n\t\t\t/** @function users/get */\n\t\t\tget: state => (userId, getTemporary = false) =>\n\t\t\t{\n\t\t\t\tuserId = Number.parseInt(userId, 10);\n\n\t\t\t\tif (!Type.isNumber(userId))\n\t\t\t\t{\n\t\t\t\t\tif (getTemporary)\n\t\t\t\t\t{\n\t\t\t\t\t\tuserId = 0;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\treturn null;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tconst user = state.collection[userId];\n\n\t\t\t\tif (!getTemporary && !user)\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t\telse if (getTemporary && !user)\n\t\t\t\t{\n\t\t\t\t\treturn this.getElementState({id: userId});\n\t\t\t\t}\n\n\t\t\t\treturn user;\n\t\t\t},\n\t\t\t/** @function users/getBlank */\n\t\t\tgetBlank: () => params =>\n\t\t\t{\n\t\t\t\treturn this.getElementState(params);\n\t\t\t},\n\t\t\t/** @function users/getList */\n\t\t\tgetList: state => (userList) => {\n\t\t\t\tconst result = [];\n\n\t\t\t\tif (!Array.isArray(userList))\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\tuserList.forEach(id => {\n\t\t\t\t\tif (state.collection[id])\n\t\t\t\t\t{\n\t\t\t\t\t\tresult.push(state.collection[id]);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tresult.push(this.getElementState({id}));\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\treturn result;\n\t\t\t},\n\t\t\t/** @function users/hasBirthday */\n\t\t\thasBirthday: state => userId => {\n\t\t\t\tuserId = Number.parseInt(userId, 10);\n\n\t\t\t\tconst user = state.collection[userId];\n\t\t\t\tif (userId <= 0 || !user)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn user.isBirthday;\n\t\t\t},\n\t\t\t/** @function users/hasVacation */\n\t\t\thasVacation: state => userId => {\n\t\t\t\tuserId = Number.parseInt(userId, 10);\n\n\t\t\t\tconst user = state.collection[userId];\n\t\t\t\tif (userId <= 0 || !user)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn user.isAbsent;\n\t\t\t},\n\t\t\t/** @function users/getStatus */\n\t\t\tgetStatus: state => userId => {\n\t\t\t\tuserId = Number.parseInt(userId, 10);\n\n\t\t\t\tconst user = state.collection[userId];\n\t\t\t\tif (userId <= 0 || !user)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tif (!user.isOnline)\n\t\t\t\t{\n\t\t\t\t\treturn '';\n\t\t\t\t}\n\n\t\t\t\tif (user.isMobileOnline)\n\t\t\t\t{\n\t\t\t\t\treturn UserStatus.mobileOnline;\n\t\t\t\t}\n\t\t\t\telse if (user.idle)\n\t\t\t\t{\n\t\t\t\t\t// away by time\n\t\t\t\t\treturn UserStatus.idle;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\t// manually selected status (online, away, dnd, break)\n\t\t\t\t\treturn user.status;\n\t\t\t\t}\n\t\t\t},\n\t\t\t/** @function users/getLastOnline */\n\t\t\tgetLastOnline: state => userId => {\n\t\t\t\tuserId = Number.parseInt(userId, 10);\n\n\t\t\t\tconst user = state.collection[userId];\n\t\t\t\tif (userId <= 0 || !user)\n\t\t\t\t{\n\t\t\t\t\treturn '';\n\t\t\t\t}\n\n\t\t\t\treturn Utils.user.getLastDateText(user);\n\t\t\t},\n\t\t\t/** @function users/getPosition */\n\t\t\tgetPosition: state => userId => {\n\t\t\t\tuserId = Number.parseInt(userId, 10);\n\n\t\t\t\tconst user = state.collection[userId];\n\t\t\t\tif (userId <= 0 || !user)\n\t\t\t\t{\n\t\t\t\t\treturn '';\n\t\t\t\t}\n\n\t\t\t\tif (user.workPosition)\n\t\t\t\t{\n\t\t\t\t\treturn user.workPosition;\n\t\t\t\t}\n\n\t\t\t\treturn Loc.getMessage('IM_MODEL_USERS_DEFAULT_NAME');\n\t\t\t},\n\t\t\t/** @function users/getBotType */\n\t\t\tgetBotType: state => userId => {\n\t\t\t\tuserId = Number.parseInt(userId, 10);\n\n\t\t\t\tconst user = state.collection[userId];\n\t\t\t\tif (userId <= 0 || !user || !user.bot || !state.botList[userId])\n\t\t\t\t{\n\t\t\t\t\treturn '';\n\t\t\t\t}\n\n\t\t\t\tconst botType = state.botList[userId].type;\n\n\t\t\t\tif (!BotType[botType])\n\t\t\t\t{\n\t\t\t\t\treturn BotType.bot;\n\t\t\t\t}\n\n\t\t\t\treturn botType;\n\t\t\t}\n\t\t};\n\t}\n\n\tgetActions()\n\t{\n\t\treturn {\n\t\t\t/** @function users/set */\n\t\t\tset: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (!Array.isArray(payload) && Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\tpayload = [payload];\n\t\t\t\t}\n\n\t\t\t\tpayload.map(user => {\n\t\t\t\t\treturn this.validate(user);\n\t\t\t\t}).forEach(user => {\n\t\t\t\t\tconst existingUser = store.state.collection[user.id];\n\t\t\t\t\tif (existingUser)\n\t\t\t\t\t{\n\t\t\t\t\t\tstore.commit('update', {\n\t\t\t\t\t\t\tid: user.id,\n\t\t\t\t\t\t\tfields: user\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tstore.commit('add', {\n\t\t\t\t\t\t\tid: user.id,\n\t\t\t\t\t\t\tfields: {...this.getElementState(), ...user}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function users/add */\n\t\t\tadd: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (!Array.isArray(payload) && Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\tpayload = [payload];\n\t\t\t\t}\n\n\t\t\t\tpayload.map(user => {\n\t\t\t\t\treturn this.validate(user);\n\t\t\t\t}).forEach(user => {\n\t\t\t\t\tconst existingUser = store.state.collection[user.id];\n\t\t\t\t\tif (!existingUser)\n\t\t\t\t\t{\n\t\t\t\t\t\tstore.commit('add', {\n\t\t\t\t\t\t\tid: user.id,\n\t\t\t\t\t\t\tfields: {...this.getElementState(), ...user}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function users/update */\n\t\t\tupdate: (store, payload) =>\n\t\t\t{\n\t\t\t\tpayload.id = Number.parseInt(payload.id, 10);\n\n\t\t\t\tconst user = store.state.collection[payload.id];\n\t\t\t\tif (!user)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tid: payload.id,\n\t\t\t\t\tfields: this.validate(payload.fields)\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function users/delete */\n\t\t\tdelete: (store, payload) =>\n\t\t\t{\n\t\t\t\tstore.commit('delete', payload.id);\n\t\t\t},\n\t\t\t/** @function users/setBotList */\n\t\t\tsetBotList: (store, payload) =>\n\t\t\t{\n\t\t\t\tstore.commit('setBotList', payload);\n\t\t\t},\n\t\t\t/** @function users/setStatus */\n\t\t\tsetStatus: (store, payload: {status: string}) =>\n\t\t\t{\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tid: Core.getUserId(),\n\t\t\t\t\tfields: this.validate(payload)\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\t}\n\n\tgetMutations()\n\t{\n\t\treturn {\n\t\t\tadd: (state, payload) => {\n\t\t\t\t// eslint-disable-next-line no-param-reassign\n\t\t\t\tstate.collection[payload.id] = payload.fields;\n\n\t\t\t\tthis.handleUserStatusFlags(state, payload.fields);\n\n\t\t\t\tthis.startOnlineCheckInterval();\n\t\t\t\tthis.startAbsentCheckInterval();\n\t\t\t},\n\t\t\tupdate: (state, payload) => {\n\t\t\t\t// eslint-disable-next-line no-param-reassign\n\t\t\t\tstate.collection[payload.id] = { ...state.collection[payload.id], ...payload.fields };\n\n\t\t\t\tthis.handleUserStatusFlags(state, payload.fields);\n\t\t\t},\n\t\t\tdelete: (state, payload) => {\n\t\t\t\t// eslint-disable-next-line no-param-reassign\n\t\t\t\tdelete state.collection[payload.id];\n\t\t\t},\n\t\t\tsetBotList: (state, payload) => {\n\t\t\t\t// eslint-disable-next-line no-param-reassign\n\t\t\t\tstate.botList = payload;\n\t\t\t},\n\t\t};\n\t}\n\n\tvalidate(fields)\n\t{\n\t\tconst result = {};\n\n\t\tif (Type.isNumber(fields.id) || Type.isString(fields.id))\n\t\t{\n\t\t\tresult.id = Number.parseInt(fields.id, 10);\n\t\t}\n\n\t\tif (Type.isStringFilled(fields.first_name))\n\t\t{\n\t\t\tfields.firstName = fields.first_name;\n\t\t}\n\t\tif (Type.isStringFilled(fields.last_name))\n\t\t{\n\t\t\tfields.lastName = fields.last_name;\n\t\t}\n\t\tif (Type.isStringFilled(fields.firstName))\n\t\t{\n\t\t\tresult.firstName = Utils.text.htmlspecialcharsback(fields.firstName);\n\t\t}\n\t\tif (Type.isStringFilled(fields.lastName))\n\t\t{\n\t\t\tresult.lastName = Utils.text.htmlspecialcharsback(fields.lastName);\n\t\t}\n\t\tif (Type.isStringFilled(fields.name))\n\t\t{\n\t\t\tfields.name = Utils.text.htmlspecialcharsback(fields.name);\n\t\t\tresult.name = fields.name;\n\t\t}\n\n\t\tif (Type.isStringFilled(fields.color))\n\t\t{\n\t\t\tresult.color = fields.color;\n\t\t}\n\n\t\tif (Type.isStringFilled(fields.avatar))\n\t\t{\n\t\t\tresult.avatar = this.prepareAvatar(fields.avatar);\n\t\t}\n\n\t\tif (Type.isStringFilled(fields.work_position))\n\t\t{\n\t\t\tfields.workPosition = fields.work_position;\n\t\t}\n\t\tif (Type.isStringFilled(fields.workPosition))\n\t\t{\n\t\t\tresult.workPosition = Utils.text.htmlspecialcharsback(fields.workPosition);\n\t\t}\n\n\t\tif (Type.isStringFilled(fields.gender))\n\t\t{\n\t\t\tresult.gender = fields.gender === 'F'? 'F': 'M';\n\t\t}\n\n\t\tif (Type.isStringFilled(fields.birthday))\n\t\t{\n\t\t\tresult.birthday = fields.birthday;\n\t\t}\n\n\t\tif (Type.isBoolean(fields.isAdmin))\n\t\t{\n\t\t\tresult.isAdmin = fields.isAdmin;\n\t\t}\n\n\t\tif (Type.isBoolean(fields.extranet))\n\t\t{\n\t\t\tresult.extranet = fields.extranet;\n\t\t}\n\n\t\tif (Type.isBoolean(fields.network))\n\t\t{\n\t\t\tresult.network = fields.network;\n\t\t}\n\n\t\tif (Type.isBoolean(fields.bot))\n\t\t{\n\t\t\tresult.bot = fields.bot;\n\t\t}\n\n\t\tif (Type.isBoolean(fields.connector))\n\t\t{\n\t\t\tresult.connector = fields.connector;\n\t\t}\n\n\t\tif (Type.isStringFilled(fields.external_auth_id))\n\t\t{\n\t\t\tfields.externalAuthId = fields.external_auth_id;\n\t\t}\n\t\tif (Type.isStringFilled(fields.externalAuthId))\n\t\t{\n\t\t\tresult.externalAuthId = fields.externalAuthId;\n\t\t}\n\n\t\tif (Type.isStringFilled(fields.status))\n\t\t{\n\t\t\tresult.status = fields.status;\n\t\t}\n\n\t\tif (!Type.isUndefined(fields.idle))\n\t\t{\n\t\t\tresult.idle = Utils.date.cast(fields.idle, false);\n\t\t}\n\t\tif (!Type.isUndefined(fields.last_activity_date))\n\t\t{\n\t\t\tfields.lastActivityDate = fields.last_activity_date;\n\t\t}\n\t\tif (!Type.isUndefined(fields.lastActivityDate))\n\t\t{\n\t\t\tresult.lastActivityDate = Utils.date.cast(fields.lastActivityDate, false);\n\t\t}\n\t\tif (!Type.isUndefined(fields.mobile_last_date))\n\t\t{\n\t\t\tfields.mobileLastDate = fields.mobile_last_date;\n\t\t}\n\t\tif (!Type.isUndefined(fields.mobileLastDate))\n\t\t{\n\t\t\tresult.mobileLastDate = Utils.date.cast(fields.mobileLastDate, false);\n\t\t}\n\n\t\tif (!Type.isUndefined(fields.absent))\n\t\t{\n\t\t\tresult.absent = Utils.date.cast(fields.absent, false);\n\t\t}\n\n\t\tif (Array.isArray(fields.departments))\n\t\t{\n\t\t\tresult.departments = [];\n\t\t\tfields.departments.forEach(departmentId =>\n\t\t\t{\n\t\t\t\tdepartmentId = Number.parseInt(departmentId, 10);\n\t\t\t\tif (departmentId > 0)\n\t\t\t\t{\n\t\t\t\t\tresult.departments.push(departmentId);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tif (Type.isPlainObject(fields.phones))\n\t\t{\n\t\t\tresult.phones = this.preparePhones(fields.phones);\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tprepareAvatar(avatar: string): string\n\t{\n\t\tlet result = '';\n\n\t\tif (!avatar || avatar.endsWith('/js/im/images/blank.gif'))\n\t\t{\n\t\t\tresult = '';\n\t\t}\n\t\telse if (avatar.startsWith('http'))\n\t\t{\n\t\t\tresult = avatar;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tresult = Core.getHost() + avatar;\n\t\t}\n\n\t\tif (result)\n\t\t{\n\t\t\tresult = encodeURI(result);\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tpreparePhones(phones): Object\n\t{\n\t\tconst result = {};\n\n\t\tif (!Type.isUndefined(phones.work_phone))\n\t\t{\n\t\t\tphones.workPhone = phones.work_phone;\n\t\t}\n\t\tif (Type.isStringFilled(phones.workPhone) || Type.isNumber(phones.workPhone))\n\t\t{\n\t\t\tresult.workPhone =phones.workPhone.toString();\n\t\t}\n\n\t\tif (!Type.isUndefined(phones.personal_mobile))\n\t\t{\n\t\t\tphones.personalMobile = phones.personal_mobile;\n\t\t}\n\t\tif (Type.isStringFilled(phones.personalMobile) || Type.isNumber(phones.personalMobile))\n\t\t{\n\t\t\tresult.personalMobile = phones.personalMobile.toString();\n\t\t}\n\n\t\tif (!Type.isUndefined(phones.personal_phone))\n\t\t{\n\t\t\tphones.personalPhone = phones.personal_phone;\n\t\t}\n\t\tif (Type.isStringFilled(phones.personalPhone) || Type.isNumber(phones.personalPhone))\n\t\t{\n\t\t\tresult.personalPhone = phones.personalPhone.toString();\n\t\t}\n\n\t\tif (!Type.isUndefined(phones.inner_phone))\n\t\t{\n\t\t\tphones.innerPhone = phones.inner_phone;\n\t\t}\n\t\tif (Type.isStringFilled(phones.innerPhone) || Type.isNumber(phones.innerPhone))\n\t\t{\n\t\t\tresult.innerPhone = phones.innerPhone.toString();\n\t\t}\n\n\t\treturn result;\n\t}\n\n\thandleUserStatusFlags(state, fields: ImModelUser)\n\t{\n\t\tconst user = state.collection[fields.id];\n\t\tif (Utils.user.isOnline(fields.lastActivityDate))\n\t\t{\n\t\t\tuser.isOnline = true;\n\t\t\tthis.addToOnlineList(fields.id);\n\t\t}\n\n\t\tif (Utils.user.isMobileOnline(fields.lastActivityDate, fields.mobileLastDate))\n\t\t{\n\t\t\tuser.isMobileOnline = true;\n\t\t\tthis.addToMobileOnlineList(fields.id);\n\t\t}\n\n\t\tif (fields.birthday && Utils.user.isBirthdayToday(fields.birthday))\n\t\t{\n\t\t\tuser.isBirthday = true;\n\t\t\tsetTimeout(() => {\n\t\t\t\tuser.isBirthday = false;\n\t\t\t}, Utils.date.getTimeToNextMidnight());\n\t\t}\n\n\t\tif (fields.absent === false)\n\t\t{\n\t\t\tuser.isAbsent = false;\n\t\t\t// eslint-disable-next-line no-param-reassign\n\t\t\tstate.absentList = state.absentList.filter((element) => {\n\t\t\t\treturn element !== fields.id;\n\t\t\t});\n\t\t}\n\t\telse if (Type.isDate(fields.absent))\n\t\t{\n\t\t\tuser.isAbsent = true;\n\t\t\tthis.addToAbsentList(fields.id);\n\t\t}\n\t}\n\n\taddToOnlineList(id)\n\t{\n\t\tconst state = this.store.state.users;\n\t\tif (!state.onlineList.includes(id))\n\t\t{\n\t\t\tstate.onlineList.push(id);\n\t\t}\n\t}\n\n\taddToMobileOnlineList(id)\n\t{\n\t\tconst state = this.store.state.users;\n\t\tif (!state.mobileOnlineList.includes(id))\n\t\t{\n\t\t\tstate.mobileOnlineList.push(id);\n\t\t}\n\t}\n\n\taddToAbsentList(id)\n\t{\n\t\tconst state = this.store.state.users;\n\t\tif (!state.absentList.includes(id))\n\t\t{\n\t\t\tstate.absentList.push(id);\n\t\t}\n\t}\n\n\tstartAbsentCheckInterval()\n\t{\n\t\tif (this.absentCheckInterval)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tconst TIME_TO_NEXT_DAY = 1000*60*60*24;\n\t\tthis.absentCheckInterval = setTimeout(() => {\n\t\t\tsetInterval(() => {\n\t\t\t\tconst state = this.store.state.users;\n\t\t\t\tstate.absentList.forEach(userId => {\n\t\t\t\t\tconst user = state.collection[userId];\n\t\t\t\t\tif (!user)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tconst currentTime = Date.now();\n\t\t\t\t\tconst absentEnd = new Date(user.absent).getTime();\n\n\t\t\t\t\tif (absentEnd <= currentTime)\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.absentList = state.absentList.filter(element => {\n\t\t\t\t\t\t\treturn element !== userId;\n\t\t\t\t\t\t});\n\t\t\t\t\t\tuser.isAbsent = false;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}, TIME_TO_NEXT_DAY);\n\t\t}, Utils.date.getTimeToNextMidnight());\n\t}\n\n\tstartOnlineCheckInterval()\n\t{\n\t\tif (this.onlineCheckInterval)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tconst ONE_MINUTE = 60000;\n\t\tthis.onlineCheckInterval = setInterval(() => {\n\t\t\tconst state = this.store.state.users;\n\n\t\t\tstate.onlineList.forEach(userId => {\n\t\t\t\tconst user = state.collection[userId];\n\t\t\t\tif (!user)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (Utils.user.isOnline(user.lastActivityDate))\n\t\t\t\t{\n\t\t\t\t\tuser.isOnline = true;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tuser.isOnline = false;\n\t\t\t\t\tstate.onlineList = state.onlineList.filter(element => element !== userId);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tstate.mobileOnlineList.forEach(userId => {\n\t\t\t\tconst user = state.collection[userId];\n\t\t\t\tif (!user)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (Utils.user.isMobileOnline(user.lastActivityDate, user.mobileLastDate))\n\t\t\t\t{\n\t\t\t\t\tuser.isMobileOnline = true;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tuser.isMobileOnline = false;\n\t\t\t\t\tstate.mobileOnlineList = state.mobileOnlineList.filter(element => element !== userId);\n\t\t\t\t}\n\t\t\t});\n\t\t}, ONE_MINUTE);\n\t}\n}","import {Type} from 'main.core';\nimport {BuilderModel} from 'ui.vue3.vuex';\n\nimport {Core} from 'im.v2.application.core';\nimport {FileStatus} from 'im.v2.const';\nimport {Utils} from 'im.v2.lib.utils';\n\nimport type {ImModelFile} from 'im.v2.model';\nimport {Logger} from 'im.v2.lib.logger';\n\ntype FilesState = {\n\tcollection: {\n\t\t[fileId: string]: ImModelFile\n\t}\n};\n\nexport class FilesModel extends BuilderModel\n{\n\tgetName(): string\n\t{\n\t\treturn 'files';\n\t}\n\n\tgetState(): Object\n\t{\n\t\treturn {\n\t\t\tcollection: {},\n\t\t};\n\t}\n\n\tgetElementState()\n\t{\n\t\treturn {\n\t\t\tid: 0,\n\t\t\tchatId: 0,\n\t\t\tname: 'File is deleted',\n\t\t\tdate: new Date(),\n\t\t\ttype: 'file',\n\t\t\textension: '',\n\t\t\ticon: 'empty',\n\t\t\tsize: 0,\n\t\t\timage: false,\n\t\t\tstatus: FileStatus.done,\n\t\t\tprogress: 100,\n\t\t\tauthorId: 0,\n\t\t\tauthorName: '',\n\t\t\turlPreview: '',\n\t\t\turlShow: '',\n\t\t\turlDownload: '',\n\t\t\tviewerAttrs: null\n\t\t};\n\t}\n\n\tgetGetters()\n\t{\n\t\treturn {\n\t\t\t/** @function files/get */\n\t\t\tget: (state: FilesState) => (fileId: number, getTemporary = false): ?ImModelFile =>\n\t\t\t{\n\t\t\t\tif (!fileId)\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\tif (!getTemporary && !state.collection[fileId])\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[fileId];\n\t\t\t},\n\t\t\t/** @function files/isInCollection */\n\t\t\tisInCollection: (state: FilesState) => (payload: {fileId: number | string}): boolean =>\n\t\t\t{\n\t\t\t\tconst {fileId} = payload;\n\n\t\t\t\treturn !!state.collection[fileId];\n\t\t\t}\n\t\t};\n\t}\n\n\tgetActions()\n\t{\n\t\treturn {\n\t\t\t/** @function files/add */\n\t\t\tadd: (store, payload: Object) =>\n\t\t\t{\n\t\t\t\tconst preparedFile = {...this.getElementState(), ...this.validate(payload)};\n\n\t\t\t\tstore.commit('add', {files: [preparedFile]});\n\t\t\t},\n\t\t\t/** @function files/set */\n\t\t\tset: (store, payload: Object[]) =>\n\t\t\t{\n\t\t\t\tif (!Array.isArray(payload) && Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\tpayload = [payload];\n\t\t\t\t}\n\n\t\t\t\tpayload = payload.map(file => {\n\t\t\t\t\treturn {...this.getElementState(), ...this.validate(file)};\n\t\t\t\t});\n\n\t\t\t\tstore.commit('add', {files: payload});\n\t\t\t},\n\t\t\t/** @function files/update */\n\t\t\tupdate: (store, payload) =>\n\t\t\t{\n\t\t\t\tconst {id, fields} = payload;\n\t\t\t\tconst existingItem = store.state.collection[id];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tid: id,\n\t\t\t\t\tfields: this.validate(fields)\n\t\t\t\t});\n\n\t\t\t\treturn true;\n\t\t\t},\n\t\t\t/** @function files/updateWithId */\n\t\t\tupdateWithId: (store, payload: {id: string | number, fields: Object}) =>\n\t\t\t{\n\t\t\t\tconst {id, fields} = payload;\n\t\t\t\tif (!store.state.collection[id])\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('updateWithId', {\n\t\t\t\t\tid,\n\t\t\t\t\tfields: this.validate(fields)\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function files/delete */\n\t\t\tdelete: (store, payload: {id: string | number}) =>\n\t\t\t{\n\t\t\t\tconst {id} = payload;\n\t\t\t\tif (!store.state.collection[id])\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('delete', {id});\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMutations()\n\t{\n\t\treturn {\n\t\t\tadd: (state: FilesState, payload: {files: ImModelFile[]}) =>\n\t\t\t{\n\t\t\t\tpayload.files.forEach(file => {\n\t\t\t\t\tstate.collection[file.id] = file;\n\t\t\t\t});\n\t\t\t},\n\t\t\tupdate: (state: FilesState, payload) =>\n\t\t\t{\n\t\t\t\tObject.entries(payload.fields).forEach(([key, value]) => {\n\t\t\t\t\tstate.collection[payload.id][key] = value;\n\t\t\t\t});\n\t\t\t},\n\t\t\tupdateWithId: (state: FilesState, payload: {id: number | string, fields: Object}) =>\n\t\t\t{\n\t\t\t\tconst {id, fields} = payload;\n\t\t\t\tconst currentFile = {...state.collection[id]};\n\n\t\t\t\tdelete state.collection[id];\n\t\t\t\tstate.collection[fields.id] = {...currentFile, ...fields};\n\t\t\t},\n\t\t\tdelete: (state: FilesState, payload: {id: number | string}) =>\n\t\t\t{\n\t\t\t\tLogger.warn('Files model: delete mutation', payload);\n\t\t\t\tconst {id} = payload;\n\t\t\t\tdelete state.collection[id];\n\t\t\t},\n\t\t};\n\t}\n\n\tvalidate(file: Object): ImModelFile\n\t{\n\t\tconst result = {};\n\n\t\tif (Type.isNumber(file.id) || Type.isStringFilled(file.id))\n\t\t{\n\t\t\tresult.id = file.id;\n\t\t}\n\n\t\tif (Type.isNumber(file.chatId) || Type.isString(file.chatId))\n\t\t{\n\t\t\tresult.chatId = Number.parseInt(file.chatId, 10);\n\t\t}\n\n\t\tif (!Type.isUndefined(file.date))\n\t\t{\n\t\t\tresult.date = Utils.date.cast(file.date);\n\t\t}\n\n\t\tif (Type.isString(file.type))\n\t\t{\n\t\t\tresult.type = file.type;\n\t\t}\n\n\t\tif (Type.isString(file.extension))\n\t\t{\n\t\t\tresult.extension = file.extension.toString();\n\n\t\t\tif (result.type === 'image')\n\t\t\t{\n\t\t\t\tresult.icon = 'img';\n\t\t\t}\n\t\t\telse if (result.type === 'video')\n\t\t\t{\n\t\t\t\tresult.icon = 'mov';\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresult.icon = Utils.file.getIconTypeByExtension(result.extension);\n\t\t\t}\n\t\t}\n\n\t\tif (Type.isString(file.name) || Type.isNumber(file.name))\n\t\t{\n\t\t\tresult.name = file.name.toString();\n\t\t}\n\n\t\tif (Type.isNumber(file.size) || Type.isString(file.size))\n\t\t{\n\t\t\tresult.size = Number.parseInt(file.size, 10);\n\t\t}\n\n\t\tif (Type.isBoolean(file.image))\n\t\t{\n\t\t\tresult.image = false;\n\t\t}\n\t\telse if (Type.isPlainObject(file.image))\n\t\t{\n\t\t\tresult.image = {\n\t\t\t\twidth: 0,\n\t\t\t\theight: 0,\n\t\t\t};\n\n\t\t\tif (Type.isString(file.image.width) || Type.isNumber(file.image.width))\n\t\t\t{\n\t\t\t\tresult.image.width = Number.parseInt(file.image.width, 10);\n\t\t\t}\n\t\t\tif (Type.isString(file.image.height) || Type.isNumber(file.image.height))\n\t\t\t{\n\t\t\t\tresult.image.height = Number.parseInt(file.image.height, 10);\n\t\t\t}\n\n\t\t\tif (result.image.width <= 0 || result.image.height <= 0)\n\t\t\t{\n\t\t\t\tresult.image = false;\n\t\t\t}\n\t\t}\n\n\t\tif (Type.isString(file.status) && !Type.isUndefined(FileStatus[file.status]))\n\t\t{\n\t\t\tresult.status = file.status;\n\t\t}\n\n\t\tif (Type.isNumber(file.progress) || Type.isString(file.progress))\n\t\t{\n\t\t\tresult.progress = Number.parseInt(file.progress, 10);\n\t\t}\n\n\t\tif (Type.isNumber(file.authorId) || Type.isString(file.authorId))\n\t\t{\n\t\t\tresult.authorId = Number.parseInt(file.authorId, 10);\n\t\t}\n\n\t\tif (Type.isString(file.authorName) || Type.isNumber(file.authorName))\n\t\t{\n\t\t\tresult.authorName = file.authorName.toString();\n\t\t}\n\n\t\tif (Type.isString(file.urlPreview))\n\t\t{\n\t\t\tif (\n\t\t\t\t!file.urlPreview\n\t\t\t\t|| file.urlPreview.startsWith('http')\n\t\t\t\t|| file.urlPreview.startsWith('bx')\n\t\t\t\t|| file.urlPreview.startsWith('file')\n\t\t\t\t|| file.urlPreview.startsWith('blob')\n\t\t\t)\n\t\t\t{\n\t\t\t\tresult.urlPreview = file.urlPreview;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresult.urlPreview = Core.getHost() + file.urlPreview;\n\t\t\t}\n\t\t}\n\n\t\tif (Type.isString(file.urlDownload))\n\t\t{\n\t\t\tif (\n\t\t\t\t!file.urlDownload\n\t\t\t\t|| file.urlDownload.startsWith('http')\n\t\t\t\t|| file.urlDownload.startsWith('bx')\n\t\t\t\t|| file.urlPreview.startsWith('file')\n\t\t\t)\n\t\t\t{\n\t\t\t\tresult.urlDownload = file.urlDownload;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresult.urlDownload = Core.getHost() + file.urlDownload;\n\t\t\t}\n\t\t}\n\n\t\tif (Type.isString(file.urlShow))\n\t\t{\n\t\t\tif (\n\t\t\t\t!file.urlShow\n\t\t\t\t|| file.urlShow.startsWith('http')\n\t\t\t\t|| file.urlShow.startsWith('bx')\n\t\t\t\t|| file.urlShow.startsWith('file')\n\t\t\t\t|| file.urlShow.startsWith('blob')\n\t\t\t)\n\t\t\t{\n\t\t\t\tresult.urlShow = file.urlShow;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresult.urlShow = Core.getHost() + file.urlShow;\n\t\t\t}\n\t\t}\n\n\t\tif (Type.isPlainObject(file.viewerAttrs))\n\t\t{\n\t\t\tresult.viewerAttrs = this.validateViewerAttributes(file.viewerAttrs);\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tvalidateViewerAttributes(viewerAttrs)\n\t{\n\t\tconst result = {\n\t\t\tviewer: true,\n\t\t};\n\n\t\tif (Type.isString(viewerAttrs.actions))\n\t\t{\n\t\t\tresult.actions = viewerAttrs.actions;\n\t\t}\n\n\t\tif (Type.isString(viewerAttrs.objectId))\n\t\t{\n\t\t\tresult.objectId = viewerAttrs.objectId;\n\t\t}\n\n\t\tif (Type.isString(viewerAttrs.src))\n\t\t{\n\t\t\tresult.src = viewerAttrs.src;\n\t\t}\n\n\t\tif (Type.isString(viewerAttrs.title))\n\t\t{\n\t\t\tresult.title = viewerAttrs.title;\n\t\t}\n\n\t\tif (Type.isString(viewerAttrs.viewerGroupBy))\n\t\t{\n\t\t\tresult.viewerGroupBy = viewerAttrs.viewerGroupBy;\n\t\t}\n\n\t\tif (Type.isString(viewerAttrs.viewerType))\n\t\t{\n\t\t\tresult.viewerType = viewerAttrs.viewerType;\n\t\t}\n\n\t\tif (Type.isString(viewerAttrs.viewerTypeClass))\n\t\t{\n\t\t\tresult.viewerTypeClass = viewerAttrs.viewerTypeClass;\n\t\t}\n\n\t\tif (Type.isBoolean(viewerAttrs.viewerSeparateItem))\n\t\t{\n\t\t\tresult.viewerSeparateItem = viewerAttrs.viewerSeparateItem;\n\t\t}\n\n\t\tif (Type.isString(viewerAttrs.viewerExtension))\n\t\t{\n\t\t\tresult.viewerExtension = viewerAttrs.viewerExtension;\n\t\t}\n\n\t\tif (Type.isNumber(viewerAttrs.imChatId))\n\t\t{\n\t\t\tresult.imChatId = viewerAttrs.imChatId;\n\t\t}\n\n\t\treturn result;\n\t}\n}\n","import {Type} from 'main.core';\nimport {BuilderModel, GetterTree, ActionTree, MutationTree} from 'ui.vue3.vuex';\n\nimport {RecentCallStatus} from 'im.v2.const';\n\nimport type {ImModelCallItem} from 'im.v2.model';\n\ntype CallsState = {\n\tcollection: {\n\t\t[dialogId: string]: ImModelCallItem\n\t}\n};\n\nexport class CallsModel extends BuilderModel\n{\n\tgetState()\n\t{\n\t\treturn {\n\t\t\tcollection: {}\n\t\t};\n\t}\n\n\tgetElementState()\n\t{\n\t\treturn {\n\t\t\tdialogId: 0,\n\t\t\tname: '',\n\t\t\tcall: {},\n\t\t\tstate: RecentCallStatus.waiting\n\t\t};\n\t}\n\n\tgetGetters(): GetterTree\n\t{\n\t\treturn {\n\t\t\tget: (state: CallsState): ImModelCallItem[] =>\n\t\t\t{\n\t\t\t\treturn Object.values(state.collection);\n\t\t\t}\n\t\t};\n\t}\n\n\tgetActions(): ActionTree\n\t{\n\t\treturn {\n\t\t\taddActiveCall: (store, payload: ImModelCallItem) =>\n\t\t\t{\n\t\t\t\tconst existingCall = Object.values(store.state.collection).find((item: ImModelCallItem) => {\n\t\t\t\t\treturn item.dialogId === payload.dialogId || item.call.id === payload.call.id;\n\t\t\t\t});\n\n\t\t\t\tif (existingCall)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('updateActiveCall', {\n\t\t\t\t\t\tdialogId: existingCall.dialogId,\n\t\t\t\t\t\tfields: this.validateActiveCall(payload)\n\t\t\t\t\t});\n\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('addActiveCall', this.prepareActiveCall(payload));\n\t\t\t},\n\t\t\tupdateActiveCall: (store, payload) =>\n\t\t\t{\n\t\t\t\tconst existingCall = store.state.collection[payload.dialogId];\n\t\t\t\tif (!existingCall)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('updateActiveCall', {\n\t\t\t\t\tdialogId: existingCall.dialogId,\n\t\t\t\t\tfields: this.validateActiveCall(payload.fields)\n\t\t\t\t});\n\t\t\t},\n\t\t\tdeleteActiveCall: (store, payload) =>\n\t\t\t{\n\t\t\t\tconst existingCall = store.state.collection[payload.dialogId];\n\t\t\t\tif (!existingCall)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('deleteActiveCall', {\n\t\t\t\t\tdialogId: existingCall.dialogId\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\t}\n\n\tgetMutations(): MutationTree\n\t{\n\t\treturn {\n\t\t\taddActiveCall: (state: CallsState, payload: ImModelCallItem) => {\n\t\t\t\tstate.collection[payload.dialogId] = payload;\n\t\t\t},\n\t\t\tupdateActiveCall: (state: CallsState, payload) => {\n\t\t\t\tstate.collection[payload.dialogId] = {\n\t\t\t\t\t...state.collection[payload.dialogId],\n\t\t\t\t\t...payload.fields\n\t\t\t\t};\n\t\t\t},\n\t\t\tdeleteActiveCall: (state: CallsState, payload) => {\n\t\t\t\tdelete state.collection[payload.dialogId];\n\t\t\t},\n\t\t};\n\t}\n\n\tprepareActiveCall(call)\n\t{\n\t\treturn {...this.getElementState(), ...this.validateActiveCall(call)};\n\t}\n\n\tvalidateActiveCall(fields)\n\t{\n\t\tconst result = {};\n\n\t\tif (Type.isStringFilled(fields.dialogId) || Type.isNumber(fields.dialogId))\n\t\t{\n\t\t\tresult.dialogId = fields.dialogId;\n\t\t}\n\n\t\tif (Type.isStringFilled(fields.name))\n\t\t{\n\t\t\tresult.name = fields.name;\n\t\t}\n\n\t\tif (Type.isObjectLike(fields.call))\n\t\t{\n\t\t\tresult.call = fields.call;\n\n\t\t\tif (fields.call?.associatedEntity?.avatar === '/bitrix/js/im/images/blank.gif')\n\t\t\t{\n\t\t\t\tresult.call.associatedEntity.avatar = '';\n\t\t\t}\n\t\t}\n\n\t\tif (RecentCallStatus[fields.state])\n\t\t{\n\t\t\tresult.state = fields.state;\n\t\t}\n\n\t\treturn result;\n\t}\n}","/* eslint-disable no-param-reassign */\nimport { BuilderModel, GetterTree, ActionTree, MutationTree } from 'ui.vue3.vuex';\nimport { Type } from 'main.core';\n\nimport { Utils } from 'im.v2.lib.utils';\n\ntype SearchRecentItem = {\n\tdialogId: string,\n\tdateUpdate: ?Date,\n}\n\ntype SearchState = {\n\tcollection: {\n\t\t[dialogId: string]: SearchRecentItem\n\t}\n};\n\nexport class RecentSearchModel extends BuilderModel\n{\n\tgetState(): SearchState\n\t{\n\t\treturn {\n\t\t\tcollection: {},\n\t\t};\n\t}\n\n\tgetElementState(): SearchRecentItem\n\t{\n\t\treturn {\n\t\t\tdialogId: '0',\n\t\t\tdateUpdate: null,\n\t\t};\n\t}\n\n\tgetGetters(): GetterTree\n\t{\n\t\treturn {\n\t\t\tgetCollection: (state: SearchState): SearchRecentItem[] => {\n\t\t\t\treturn Object.values(state.collection);\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions(): ActionTree\n\t{\n\t\treturn {\n\t\t\tset: (store, payload) => {\n\t\t\t\tpayload.forEach((item) => {\n\t\t\t\t\tconst recentElement = this.validate(item);\n\n\t\t\t\t\tstore.commit('set', {\n\t\t\t\t\t\tdialogId: recentElement.dialogId,\n\t\t\t\t\t\tdateUpdate: recentElement.dateUpdate,\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t},\n\t\t\tclear: (store, payload) => {\n\t\t\t\tstore.commit('clear');\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMutations(): MutationTree\n\t{\n\t\treturn {\n\t\t\tset: (state: SearchState, payload: SearchRecentItem) => {\n\t\t\t\tstate.collection[payload.dialogId] = payload;\n\t\t\t},\n\t\t\tclear: (state: SearchState) => {\n\t\t\t\tstate.collection = {};\n\t\t\t},\n\t\t};\n\t}\n\n\tvalidate(fields: Object, options): SearchRecentItem\n\t{\n\t\tconst result = {};\n\n\t\tif (Type.isStringFilled(fields.dialogId))\n\t\t{\n\t\t\tresult.dialogId = fields.dialogId;\n\t\t}\n\n\t\tif (Type.isStringFilled(fields.date_update))\n\t\t{\n\t\t\tresult.dateUpdate = Utils.date.cast(fields.date_update);\n\t\t}\n\n\t\treturn result;\n\t}\n}\n","import { Type } from 'main.core';\nimport { BuilderModel } from 'ui.vue3.vuex';\n\nimport { Core } from 'im.v2.application.core';\nimport { DialogType, MessageStatus, Settings } from 'im.v2.const';\nimport { Utils } from 'im.v2.lib.utils';\n\nimport { CallsModel } from './recent/calls';\nimport { RecentSearchModel } from './recent/search';\n\nimport type { GetterTree, ActionTree, MutationTree } from 'ui.vue3.vuex';\n\nimport type { RecentItem as ImModelRecentItem } from './type/recent-item';\nimport type { Dialog as ImModelDialog } from './type/dialog';\n\ntype RecentState = {\n\tcollection: {[dialogId: string]: ImModelRecentItem},\n\trecentCollection: Set<string>,\n\tunreadCollection: Set<string>,\n\tunloadedChatCounters: {[chatId: string]: number},\n\tunloadedLinesCounters: {[chatId: string]: number}\n};\n\nexport class RecentModel extends BuilderModel\n{\n\tgetName(): string\n\t{\n\t\treturn 'recent';\n\t}\n\n\tgetNestedModules(): { [moduleName: string]: BuilderModel }\n\t{\n\t\treturn {\n\t\t\tcalls: CallsModel,\n\t\t\tsearch: RecentSearchModel,\n\t\t};\n\t}\n\n\tgetState(): RecentState\n\t{\n\t\treturn {\n\t\t\tcollection: {},\n\t\t\trecentCollection: new Set(),\n\t\t\tunreadCollection: new Set(),\n\t\t\tunloadedChatCounters: {},\n\t\t\tunloadedLinesCounters: {},\n\t\t};\n\t}\n\n\tgetElementState(): ImModelRecentItem\n\t{\n\t\treturn {\n\t\t\tdialogId: '0',\n\t\t\tmessage: {\n\t\t\t\tid: 0,\n\t\t\t\tsenderId: 0,\n\t\t\t\tdate: new Date(),\n\t\t\t\tstatus: MessageStatus.received,\n\t\t\t\tsending: false,\n\t\t\t\ttext: '',\n\t\t\t\tparams: {\n\t\t\t\t\twithFile: false,\n\t\t\t\t\twithAttach: false,\n\t\t\t\t},\n\t\t\t},\n\t\t\tdraft: {\n\t\t\t\ttext: '',\n\t\t\t\tdate: null,\n\t\t\t},\n\t\t\tunread: false,\n\t\t\tpinned: false,\n\t\t\tliked: false,\n\t\t\tdateUpdate: null,\n\t\t\tinvitation: {\n\t\t\t\tisActive: false,\n\t\t\t\toriginator: 0,\n\t\t\t\tcanResend: false,\n\t\t\t},\n\t\t\toptions: {},\n\t\t};\n\t}\n\n\t// eslint-disable-next-line max-lines-per-function\n\tgetGetters(): GetterTree\n\t{\n\t\treturn {\n\t\t\t/** @function recent/getRecentCollection */\n\t\t\tgetRecentCollection: (state: RecentState): ImModelRecentItem[] => {\n\t\t\t\treturn [...state.recentCollection].filter((dialogId) => {\n\t\t\t\t\tconst dialog = this.store.getters['dialogues/get'](dialogId);\n\n\t\t\t\t\treturn Boolean(dialog);\n\t\t\t\t}).map((id) => {\n\t\t\t\t\treturn state.collection[id];\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function recent/getUnreadCollection */\n\t\t\tgetUnreadCollection: (state: RecentState): ImModelRecentItem[] => {\n\t\t\t\treturn [...state.unreadCollection].map((id) => {\n\t\t\t\t\treturn state.collection[id];\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function recent/getSortedCollection */\n\t\t\tgetSortedCollection: (state: RecentState): ImModelRecentItem[] => {\n\t\t\t\tconst collectionAsArray = Object.values(state.collection).filter((item) => {\n\t\t\t\t\tconst isBirthdayPlaceholder = item.options.birthdayPlaceholder;\n\t\t\t\t\tconst isInvitedUser = item.options.defaultUserRecord;\n\n\t\t\t\t\treturn !isBirthdayPlaceholder && !isInvitedUser && item.message.id;\n\t\t\t\t});\n\n\t\t\t\treturn [...collectionAsArray].sort((a, b) => {\n\t\t\t\t\treturn b.message.date - a.message.date;\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function recent/get */\n\t\t\tget: (state: RecentState) => (rawDialogId: string): ImModelRecentItem | null => {\n\t\t\t\tlet dialogId = rawDialogId;\n\t\t\t\tif (Type.isNumber(dialogId))\n\t\t\t\t{\n\t\t\t\t\tdialogId = dialogId.toString();\n\t\t\t\t}\n\n\t\t\t\tif (state.collection[dialogId])\n\t\t\t\t{\n\t\t\t\t\treturn state.collection[dialogId];\n\t\t\t\t}\n\n\t\t\t\treturn null;\n\t\t\t},\n\t\t\t/** @function recent/needsBirthdayPlaceholder */\n\t\t\tneedsBirthdayPlaceholder: (state: RecentState) => (dialogId): boolean => {\n\t\t\t\tconst currentItem = state.collection[dialogId];\n\t\t\t\tif (!currentItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst dialog = this.store.getters['dialogues/get'](dialogId);\n\t\t\t\tif (!dialog || dialog.type !== DialogType.user)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tconst hasBirthday = this.store.getters['users/hasBirthday'](dialogId);\n\t\t\t\tif (!hasBirthday)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst hasMessage = Utils.text.isTempMessage(currentItem.message.id) || currentItem.message.id > 0;\n\t\t\t\tconst hasTodayMessage = hasMessage && Utils.date.isToday(currentItem.message.date);\n\n\t\t\t\tconst showBirthday = this.store.getters['application/settings/get'](Settings.recent.showBirthday);\n\n\t\t\t\treturn showBirthday && !hasTodayMessage && dialog.counter === 0;\n\t\t\t},\n\t\t\t/** @function recent/needsVacationPlaceholder */\n\t\t\tneedsVacationPlaceholder: (state: RecentState) => (dialogId): boolean => {\n\t\t\t\tconst currentItem = state.collection[dialogId];\n\t\t\t\tif (!currentItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst dialog = this.store.getters['dialogues/get'](dialogId);\n\t\t\t\tif (!dialog || dialog.type !== DialogType.user)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tconst hasVacation = this.store.getters['users/hasVacation'](dialogId);\n\t\t\t\tif (!hasVacation)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst hasMessage = Utils.text.isTempMessage(currentItem.message.id) || currentItem.message.id > 0;\n\t\t\t\tconst hasTodayMessage = hasMessage && Utils.date.isToday(currentItem.message.date);\n\n\t\t\t\treturn !hasTodayMessage && dialog.counter === 0;\n\t\t\t},\n\t\t\t/** @function recent/getMessageDate */\n\t\t\tgetMessageDate: (state: RecentState) => (dialogId): Date | null => {\n\t\t\t\tconst currentItem = state.collection[dialogId];\n\t\t\t\tif (!currentItem)\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\tif (Type.isDate(currentItem.draft.date) && currentItem.draft.date > currentItem.message.date)\n\t\t\t\t{\n\t\t\t\t\treturn currentItem.draft.date;\n\t\t\t\t}\n\n\t\t\t\tconst needsBirthdayPlaceholder = this.store.getters['recent/needsBirthdayPlaceholder'](currentItem.dialogId);\n\t\t\t\tif (needsBirthdayPlaceholder)\n\t\t\t\t{\n\t\t\t\t\treturn Utils.date.getStartOfTheDay();\n\t\t\t\t}\n\n\t\t\t\treturn currentItem.message.date;\n\t\t\t},\n\t\t\t/** @function recent/getTotalChatCounter */\n\t\t\tgetTotalChatCounter: (state: RecentState): number => {\n\t\t\t\tlet loadedChatsCounter = 0;\n\t\t\t\t[...state.recentCollection].forEach((dialogId) => {\n\t\t\t\t\tconst dialog: ImModelDialog = this.store.getters['dialogues/get'](dialogId, true);\n\t\t\t\t\tconst recentItem: ImModelRecentItem = state.collection[dialogId];\n\n\t\t\t\t\tconst isMuted = dialog.muteList.includes(Core.getUserId());\n\t\t\t\t\tif (isMuted)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tconst isMarked = recentItem.unread;\n\t\t\t\t\tif (dialog.counter === 0 && isMarked)\n\t\t\t\t\t{\n\t\t\t\t\t\tloadedChatsCounter++;\n\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tloadedChatsCounter += dialog.counter;\n\t\t\t\t});\n\n\t\t\t\tlet unloadedChatsCounter = 0;\n\t\t\t\tObject.values(state.unloadedChatCounters).forEach((counter) => {\n\t\t\t\t\tunloadedChatsCounter += counter;\n\t\t\t\t});\n\n\t\t\t\treturn loadedChatsCounter + unloadedChatsCounter;\n\t\t\t},\n\t\t\t/** @function recent/getTotalLinesCounter */\n\t\t\tgetTotalLinesCounter: (state: RecentState): number => {\n\t\t\t\tlet unloadedLinesCounter = 0;\n\t\t\t\tObject.values(state.unloadedLinesCounters).forEach((counter) => {\n\t\t\t\t\tunloadedLinesCounter += counter;\n\t\t\t\t});\n\n\t\t\t\treturn unloadedLinesCounter;\n\t\t\t},\n\t\t\t/** @function recent/getSpecificLinesCounter */\n\t\t\tgetSpecificLinesCounter: (state: RecentState) => (chatId: number): number => {\n\t\t\t\tif (!state.unloadedLinesCounters[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn state.unloadedLinesCounters[chatId];\n\t\t\t},\n\t\t};\n\t}\n\n\t/* eslint-disable no-param-reassign */\n\t/* eslint-disable-next-line max-lines-per-function */\n\tgetActions(): ActionTree\n\t{\n\t\treturn {\n\t\t\t/** @function recent/setRecent */\n\t\t\tsetRecent: async (store, payload: Array | Object) => {\n\t\t\t\tconst itemIds = await this.store.dispatch('recent/store', payload);\n\t\t\t\tstore.commit('setRecentCollection', itemIds);\n\n\t\t\t\tif (!Array.isArray(payload) && Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\tpayload = [payload];\n\t\t\t\t}\n\t\t\t\tconst zeroedCountersForNewItems = {};\n\t\t\t\tpayload.forEach((item) => {\n\t\t\t\t\tzeroedCountersForNewItems[item.chat_id] = 0;\n\t\t\t\t});\n\t\t\t\tthis.store.dispatch('recent/setUnloadedChatCounters', zeroedCountersForNewItems);\n\t\t\t},\n\t\t\t/** @function recent/setUnread */\n\t\t\tsetUnread: async (store, payload: Array | Object) => {\n\t\t\t\tconst itemIds = await this.store.dispatch('recent/store', payload);\n\t\t\t\tstore.commit('setUnreadCollection', itemIds);\n\t\t\t},\n\t\t\t/** @function recent/store */\n\t\t\tstore: (store, payload: Array | Object) => {\n\t\t\t\tif (!Array.isArray(payload) && Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\tpayload = [payload];\n\t\t\t\t}\n\n\t\t\t\tconst itemsToUpdate = [];\n\t\t\t\tconst itemsToAdd = [];\n\t\t\t\tpayload.map((element) => {\n\t\t\t\t\treturn this.validate(element);\n\t\t\t\t}).forEach((element) => {\n\t\t\t\t\tconst preparedElement = { ...element };\n\t\t\t\t\tconst existingItem = store.state.collection[element.dialogId];\n\t\t\t\t\tif (existingItem)\n\t\t\t\t\t{\n\t\t\t\t\t\titemsToUpdate.push({ dialogId: existingItem.dialogId, fields: preparedElement });\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tconst { message: defaultMessage } = this.getElementState();\n\t\t\t\t\t\tpreparedElement.message = { ...defaultMessage, ...preparedElement.message };\n\t\t\t\t\t\titemsToAdd.push({ ...this.getElementState(), ...preparedElement });\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tif (itemsToAdd.length > 0)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('add', itemsToAdd);\n\t\t\t\t}\n\n\t\t\t\tif (itemsToUpdate.length > 0)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('update', itemsToUpdate);\n\t\t\t\t}\n\n\t\t\t\treturn [...itemsToAdd, ...itemsToUpdate].map((item) => item.dialogId);\n\t\t\t},\n\t\t\t/** @function recent/update */\n\t\t\tupdate: (store, payload: {id: string | number, fields: Object}) => {\n\t\t\t\tconst { id, fields } = payload;\n\t\t\t\tconst existingItem: ImModelRecentItem = store.state.collection[id];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tdialogId: existingItem.dialogId,\n\t\t\t\t\tfields: this.validate(fields),\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function recent/unread */\n\t\t\tunread: (store, payload: {id: string | number, action: boolean, dateUpdate: Date}) => {\n\t\t\t\tconst existingItem = store.state.collection[payload.id];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tdialogId: existingItem.dialogId,\n\t\t\t\t\tfields: {\n\t\t\t\t\t\tunread: payload.action,\n\t\t\t\t\t\tdateUpdate: payload.dateUpdate,\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function recent/pin */\n\t\t\tpin: (store, payload: {id: string | number, action: boolean, dateUpdate: Date}) => {\n\t\t\t\tconst existingItem = store.state.collection[payload.id];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tdialogId: existingItem.dialogId,\n\t\t\t\t\tfields: {\n\t\t\t\t\t\tpinned: payload.action,\n\t\t\t\t\t\tdateUpdate: payload.dateUpdate,\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function recent/like */\n\t\t\tlike: (store, payload: {id: string | number, messageId: number, liked: boolean}) => {\n\t\t\t\tconst existingItem = store.state.collection[payload.id];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst isLastMessage = existingItem.message.id === Number.parseInt(payload.messageId, 10);\n\t\t\t\tconst isExactMessageLiked = !Type.isUndefined(payload.messageId) && payload.liked === true;\n\t\t\t\tif (isExactMessageLiked && !isLastMessage)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tdialogId: existingItem.dialogId,\n\t\t\t\t\tfields: { liked: payload.liked === true },\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function recent/draft */\n\t\t\tdraft: (store, payload: {id: string | number, text: string}) => {\n\t\t\t\tlet existingItem = store.state.collection[payload.id];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\tif (payload.text === '')\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tconst newItem = {\n\t\t\t\t\t\tdialogId: payload.id.toString(),\n\t\t\t\t\t};\n\t\t\t\t\tstore.commit('add', { ...this.getElementState(), ...newItem });\n\t\t\t\t\texistingItem = store.state.collection[payload.id];\n\t\t\t\t}\n\n\t\t\t\tconst existingRecentCollectionItem = store.state.recentCollection.has(payload.id);\n\t\t\t\tif (!existingRecentCollectionItem)\n\t\t\t\t{\n\t\t\t\t\tif (payload.text === '')\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tstore.commit('setRecentCollection', [payload.id.toString()]);\n\t\t\t\t}\n\n\t\t\t\tconst fields = this.validate({ draft: { text: payload.text.toString() } });\n\t\t\t\tif (fields.draft.text === existingItem.draft.text)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tdialogId: existingItem.dialogId,\n\t\t\t\t\tfields,\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function recent/delete */\n\t\t\tdelete: (store, payload: {id: string | number}) => {\n\t\t\t\tconst existingItem = store.state.collection[payload.id];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('delete', {\n\t\t\t\t\tid: existingItem.dialogId,\n\t\t\t\t});\n\t\t\t\tstore.commit('deleteFromRecentCollection', existingItem.dialogId);\n\t\t\t},\n\t\t\t/** @function recent/clearUnread */\n\t\t\tclearUnread: (store) => {\n\t\t\t\tstore.commit('clearUnread');\n\t\t\t},\n\t\t\t/** @function recent/setUnloadedChatCounters */\n\t\t\tsetUnloadedChatCounters: (store, payload: {[chatId: string]: number}) => {\n\t\t\t\tif (!Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setUnloadedChatCounters', payload);\n\t\t\t},\n\t\t\t/** @function recent/setUnloadedLinesCounters */\n\t\t\tsetUnloadedLinesCounters: (store, payload: {[chatId: string]: number}) => {\n\t\t\t\tif (!Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setUnloadedLinesCounters', payload);\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMutations(): MutationTree\n\t{\n\t\treturn {\n\t\t\tsetRecentCollection: (state: RecentState, payload: string[]) => {\n\t\t\t\tpayload.forEach((dialogId) => {\n\t\t\t\t\tstate.recentCollection.add(dialogId);\n\t\t\t\t});\n\t\t\t},\n\t\t\tdeleteFromRecentCollection: (state: RecentState, payload: string) => {\n\t\t\t\tstate.recentCollection.delete(payload);\n\t\t\t},\n\t\t\tsetUnreadCollection: (state: RecentState, payload: string[]) => {\n\t\t\t\tpayload.forEach((dialogId) => {\n\t\t\t\t\tstate.unreadCollection.add(dialogId);\n\t\t\t\t});\n\t\t\t},\n\t\t\tadd: (state: RecentState, payload: Object[] | Object) => {\n\t\t\t\tif (!Array.isArray(payload) && Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\tpayload = [payload];\n\t\t\t\t}\n\t\t\t\tpayload.forEach((item) => {\n\t\t\t\t\tstate.collection[item.dialogId] = item;\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tupdate: (state: RecentState, payload: Object[] | Object) => {\n\t\t\t\tif (!Array.isArray(payload) && Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\tpayload = [payload];\n\t\t\t\t}\n\t\t\t\tpayload.forEach(({ dialogId, fields }) => {\n\t\t\t\t\t// if we already got chat - we should not update it with default user chat\n\t\t\t\t\t// (unless it's an accepted invitation)\n\t\t\t\t\tconst elementIsInRecent = state.recentCollection.has(dialogId);\n\t\t\t\t\tconst defaultUserElement = fields.options?.defaultUserRecord && !fields.invitation;\n\t\t\t\t\tif (defaultUserElement && elementIsInRecent)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst currentElement = state.collection[dialogId];\n\t\t\t\t\tfields.message = { ...currentElement.message, ...fields.message };\n\t\t\t\t\tfields.options = { ...currentElement.options, ...fields.options };\n\t\t\t\t\tstate.collection[dialogId] = {\n\t\t\t\t\t\t...currentElement,\n\t\t\t\t\t\t...fields,\n\t\t\t\t\t};\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tdelete: (state: RecentState, payload: {id: string}) => {\n\t\t\t\tdelete state.collection[payload.id];\n\t\t\t},\n\n\t\t\tclearUnread: (state: RecentState) => {\n\t\t\t\tObject.keys(state.collection).forEach((key) => {\n\t\t\t\t\tstate.collection[key].unread = false;\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tsetUnloadedChatCounters: (state: RecentState, payload: {[chatId: string]: number}) => {\n\t\t\t\tObject.entries(payload).forEach(([chatId, counter]) => {\n\t\t\t\t\tif (counter === 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tdelete state.unloadedChatCounters[chatId];\n\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tstate.unloadedChatCounters[chatId] = counter;\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tsetUnloadedLinesCounters: (state: RecentState, payload: {[chatId: string]: number}) => {\n\t\t\t\tObject.entries(payload).forEach(([chatId, counter]) => {\n\t\t\t\t\tif (counter === 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tdelete state.unloadedLinesCounters[chatId];\n\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tstate.unloadedLinesCounters[chatId] = counter;\n\t\t\t\t});\n\t\t\t},\n\t\t};\n\t}\n\n\tvalidate(fields: Object)\n\t{\n\t\tconst result = {\n\t\t\toptions: {},\n\t\t};\n\n\t\tif (Type.isNumber(fields.id))\n\t\t{\n\t\t\tresult.dialogId = fields.id.toString();\n\t\t}\n\n\t\tif (Type.isStringFilled(fields.id))\n\t\t{\n\t\t\tresult.dialogId = fields.id;\n\t\t}\n\n\t\tif (Type.isNumber(fields.dialogId))\n\t\t{\n\t\t\tresult.dialogId = fields.dialogId.toString();\n\t\t}\n\n\t\tif (Type.isStringFilled(fields.dialogId))\n\t\t{\n\t\t\tresult.dialogId = fields.dialogId;\n\t\t}\n\n\t\tif (Type.isPlainObject(fields.message))\n\t\t{\n\t\t\tresult.message = this.prepareMessage(fields);\n\t\t}\n\n\t\tif (Type.isPlainObject(fields.draft))\n\t\t{\n\t\t\tresult.draft = this.prepareDraft(fields);\n\t\t}\n\n\t\tif (Type.isBoolean(fields.unread))\n\t\t{\n\t\t\tresult.unread = fields.unread;\n\t\t}\n\n\t\tif (Type.isBoolean(fields.pinned))\n\t\t{\n\t\t\tresult.pinned = fields.pinned;\n\t\t}\n\n\t\tif (Type.isBoolean(fields.liked))\n\t\t{\n\t\t\tresult.liked = fields.liked;\n\t\t}\n\n\t\tif (Type.isStringFilled(fields.date_update) || Type.isStringFilled(fields.dateUpdate))\n\t\t{\n\t\t\tconst date = fields.date_update || fields.dateUpdate;\n\t\t\tresult.dateUpdate = Utils.date.cast(date);\n\t\t}\n\t\telse if (Type.isDate(fields.dateUpdate))\n\t\t{\n\t\t\tresult.dateUpdate = fields.dateUpdate;\n\t\t}\n\n\t\tif (Type.isPlainObject(fields.invited))\n\t\t{\n\t\t\tresult.invitation = {\n\t\t\t\tisActive: true,\n\t\t\t\toriginator: fields.invited.originator_id,\n\t\t\t\tcanResend: fields.invited.can_resend,\n\t\t\t};\n\t\t\tresult.options.defaultUserRecord = true;\n\t\t}\n\t\telse if (fields.invited === false)\n\t\t{\n\t\t\tresult.invitation = {\n\t\t\t\tisActive: false,\n\t\t\t\toriginator: 0,\n\t\t\t\tcanResend: false,\n\t\t\t};\n\t\t\tresult.options.defaultUserRecord = true;\n\t\t}\n\n\t\tif (Type.isPlainObject(fields.options))\n\t\t{\n\t\t\tif (!result.options)\n\t\t\t{\n\t\t\t\tresult.options = {};\n\t\t\t}\n\n\t\t\tif (Type.isBoolean(fields.options.default_user_record))\n\t\t\t{\n\t\t\t\tfields.options.defaultUserRecord = fields.options.default_user_record;\n\t\t\t}\n\n\t\t\tif (Type.isBoolean(fields.options.defaultUserRecord))\n\t\t\t{\n\t\t\t\tresult.options.defaultUserRecord = fields.options.defaultUserRecord;\n\t\t\t}\n\n\t\t\tif (Type.isBoolean(fields.options.birthdayPlaceholder))\n\t\t\t{\n\t\t\t\tresult.options.birthdayPlaceholder = fields.options.birthdayPlaceholder;\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tprepareMessage(fields: Object): Object\n\t{\n\t\tconst message = {};\n\t\tconst params = {};\n\n\t\tif (\n\t\t\tType.isNumber(fields.message.id)\n\t\t\t|| Type.isStringFilled(fields.message.id)\n\t\t\t|| Utils.text.isUuidV4(fields.message.id)\n\t\t)\n\t\t{\n\t\t\tmessage.id = fields.message.id;\n\t\t}\n\n\t\tif (Type.isString(fields.message.text))\n\t\t{\n\t\t\tmessage.text = fields.message.text;\n\t\t}\n\n\t\tif (\n\t\t\tType.isStringFilled(fields.message.attach)\n\t\t\t|| Type.isBoolean(fields.message.attach)\n\t\t\t|| Type.isArray(fields.message.attach)\n\t\t)\n\t\t{\n\t\t\tparams.withAttach = fields.message.attach;\n\t\t}\n\t\telse if (\n\t\t\tType.isStringFilled(fields.message.params?.withAttach)\n\t\t\t|| Type.isBoolean(fields.message.params?.withAttach)\n\t\t\t|| Type.isArray(fields.message.params?.withAttach)\n\t\t)\n\t\t{\n\t\t\tparams.withAttach = fields.message.params.withAttach;\n\t\t}\n\n\t\tif (Type.isBoolean(fields.message.file) || Type.isPlainObject(fields.message.file))\n\t\t{\n\t\t\tparams.withFile = fields.message.file;\n\t\t}\n\t\telse if (Type.isBoolean(fields.message.params?.withFile) || Type.isPlainObject(fields.message.params?.withFile))\n\t\t{\n\t\t\tparams.withFile = fields.message.params.withFile;\n\t\t}\n\n\t\tif (Type.isDate(fields.message.date) || Type.isString(fields.message.date))\n\t\t{\n\t\t\tmessage.date = Utils.date.cast(fields.message.date);\n\t\t}\n\n\t\tif (Type.isNumber(fields.message.author_id))\n\t\t{\n\t\t\tmessage.senderId = fields.message.author_id;\n\t\t}\n\t\telse if (Type.isNumber(fields.message.authorId))\n\t\t{\n\t\t\tmessage.senderId = fields.message.authorId;\n\t\t}\n\t\telse if (Type.isNumber(fields.message.senderId))\n\t\t{\n\t\t\tmessage.senderId = fields.message.senderId;\n\t\t}\n\n\t\tif (Type.isStringFilled(fields.message.status))\n\t\t{\n\t\t\tmessage.status = fields.message.status;\n\t\t}\n\n\t\tif (Type.isBoolean(fields.message.sending))\n\t\t{\n\t\t\tmessage.sending = fields.message.sending;\n\t\t}\n\n\t\tif (Object.keys(params).length > 0)\n\t\t{\n\t\t\tmessage.params = params;\n\t\t}\n\n\t\treturn message;\n\t}\n\n\tprepareDraft(fields: Object): Object\n\t{\n\t\tconst { draft } = this.getElementState();\n\n\t\tif (Type.isString(fields.draft.text))\n\t\t{\n\t\t\tdraft.text = fields.draft.text;\n\t\t}\n\n\t\tif (Type.isStringFilled(draft.text))\n\t\t{\n\t\t\tdraft.date = new Date();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tdraft.date = null;\n\t\t}\n\n\t\treturn draft;\n\t}\n}\n","import {BuilderModel} from 'ui.vue3.vuex';\nimport {Type, Text} from 'main.core';\n\nimport {Core} from 'im.v2.application.core';\nimport {Utils} from 'im.v2.lib.utils';\nimport {NotificationTypesCodes} from 'im.v2.const';\n\nexport class NotificationsModel extends BuilderModel\n{\n\tgetName(): string\n\t{\n\t\treturn 'notifications';\n\t}\n\n\tgetState(): Object\n\t{\n\t\treturn {\n\t\t\tcollection: new Map(),\n\t\t\tsearchCollection: new Map(),\n\t\t\tunreadCounter: 0,\n\t\t};\n\t}\n\n\tgetElementState(): Object\n\t{\n\t\treturn {\n\t\t\tid: 0,\n\t\t\tauthorId: 0,\n\t\t\tdate: new Date(),\n\t\t\ttitle: '',\n\t\t\ttext: '',\n\t\t\tparams: {},\n\t\t\treplaces: [],\n\t\t\tnotifyButtons: [],\n\t\t\tsectionCode: NotificationTypesCodes.simple,\n\t\t\tread: false,\n\t\t\tsettingName: 'im|default',\n\t\t};\n\t}\n\n\tgetGetters(): Object\n\t{\n\t\treturn {\n\t\t\tgetSortedCollection: state =>\n\t\t\t{\n\t\t\t\treturn [...state.collection.values()].sort(this.sortByType);\n\t\t\t},\n\t\t\tgetSearchResultCollection: state =>\n\t\t\t{\n\t\t\t\treturn [...state.searchCollection.values()].sort(this.sortByType);\n\t\t\t},\n\t\t\tgetConfirmsCount: state =>\n\t\t\t{\n\t\t\t\treturn [...state.collection.values()].filter(notification => {\n\t\t\t\t\treturn notification.sectionCode === NotificationTypesCodes.confirm;\n\t\t\t\t}).length;\n\t\t\t},\n\t\t\tgetById: state => (notificationId) =>\n\t\t\t{\n\t\t\t\tif (Type.isString(notificationId))\n\t\t\t\t{\n\t\t\t\t\tnotificationId = Number.parseInt(notificationId, 10);\n\t\t\t\t}\n\n\t\t\t\tconst existingItem = state.collection.get(notificationId);\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn existingItem;\n\t\t\t},\n\t\t\tgetCounter: (state): number =>\n\t\t\t{\n\t\t\t\treturn state.unreadCounter;\n\t\t\t}\n\t\t};\n\t}\n\n\tgetActions(): Object\n\t{\n\t\treturn {\n\t\t\tinitialSet: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (Type.isNumber(payload.total_unread_count))\n\t\t\t\t{\n\t\t\t\t\tstore.commit('setCounter', payload.total_unread_count);\n\t\t\t\t}\n\n\t\t\t\tif (!Type.isArrayFilled(payload.notifications))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst itemsToUpdate = [];\n\t\t\t\tconst itemsToAdd = [];\n\n\t\t\t\tconst currentUserId = Core.getUserId();\n\t\t\t\tpayload.notifications.map(element => {\n\t\t\t\t\treturn NotificationsModel.validate(element, currentUserId);\n\t\t\t\t}).forEach(element => {\n\t\t\t\t\tconst existingItem = store.state.collection.get(element.id);\n\t\t\t\t\tif (existingItem)\n\t\t\t\t\t{\n\t\t\t\t\t\titemsToUpdate.push({id: existingItem.id, fields: {...element}});\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\titemsToAdd.push({...this.getElementState(), ...element});\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tif (itemsToAdd.length > 0)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('add', itemsToAdd);\n\t\t\t\t}\n\t\t\t\tif (itemsToUpdate.length > 0)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('update', itemsToUpdate);\n\t\t\t\t}\n\t\t\t},\n\t\t\tset: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (!Array.isArray(payload) && Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\tpayload = [payload];\n\t\t\t\t}\n\n\t\t\t\tconst itemsToUpdate = [];\n\t\t\t\tconst itemsToAdd = [];\n\t\t\t\tconst currentUserId = Core.getUserId();\n\t\t\t\tpayload.map(element => {\n\t\t\t\t\treturn NotificationsModel.validate(element, currentUserId);\n\t\t\t\t}).forEach(element => {\n\t\t\t\t\tconst existingItem = store.state.collection.get(element.id);\n\t\t\t\t\tif (existingItem)\n\t\t\t\t\t\t{\n\t\t\t\t\t\titemsToUpdate.push({id: existingItem.id, fields: {...element}});\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\titemsToAdd.push({...this.getElementState(), ...element});\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tif (itemsToAdd.length > 0)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('add', itemsToAdd);\n\t\t\t\t\titemsToAdd.forEach(() => {\n\t\t\t\t\t\tstore.commit('increaseCounter');\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tif (itemsToUpdate.length > 0)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('update', itemsToUpdate);\n\t\t\t\t}\n\t\t\t},\n\t\t\tsetSearchResult: (store, payload) =>\n\t\t\t{\n\t\t\t\tconst itemsToUpdate = [];\n\t\t\t\tconst itemsToAdd = [];\n\n\t\t\t\tlet {notifications} = payload;\n\n\t\t\t\tconst skipValidation = !!payload.skipValidation;\n\t\t\t\tif (!skipValidation)\n\t\t\t\t{\n\t\t\t\t\tconst currentUserId = Core.getUserId();\n\t\t\t\t\tnotifications = notifications.map(element => {\n\t\t\t\t\t\treturn NotificationsModel.validate(element, currentUserId);\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tnotifications.forEach(element => {\n\t\t\t\t\tconst existingItem = store.state.searchCollection.get(element.id);\n\t\t\t\t\tif (existingItem)\n\t\t\t\t\t{\n\t\t\t\t\t\titemsToUpdate.push({id: existingItem.id, fields: {...element}});\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\titemsToAdd.push({...this.getElementState(), ...element});\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tif (itemsToAdd.length > 0)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('addSearchResult', itemsToAdd);\n\t\t\t\t}\n\t\t\t\tif (itemsToUpdate.length > 0)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('updateSearchResult', itemsToUpdate);\n\t\t\t\t}\n\t\t\t},\n\t\t\tread: (store, payload) =>\n\t\t\t{\n\t\t\t\tpayload.ids.forEach(notificationId => {\n\t\t\t\t\tconst existingItem = store.state.collection.get(notificationId);\n\t\t\t\t\tif (!existingItem || existingItem.read === payload.read)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (payload.read)\n\t\t\t\t\t{\n\t\t\t\t\t\tstore.commit('decreaseCounter');\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tstore.commit('increaseCounter');\n\t\t\t\t\t}\n\n\t\t\t\t\tstore.commit('read', {\n\t\t\t\t\t\tid: existingItem.id,\n\t\t\t\t\t\tread: payload.read,\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t},\n\t\t\treadAll: (store) =>\n\t\t\t{\n\t\t\t\tstore.commit('readAll');\n\t\t\t\tstore.commit('setCounter', 0);\n\t\t\t},\n\t\t\tdelete: (store, payload) =>\n\t\t\t{\n\t\t\t\tconst existingItem = store.state.collection.get(payload.id);\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (existingItem.read === false)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('decreaseCounter');\n\t\t\t\t}\n\n\t\t\t\tstore.commit('delete', {id: existingItem.id});\n\t\t\t},\n\t\t\tclearSearchResult: (store) =>\n\t\t\t{\n\t\t\t\tstore.commit('clearSearchResult');\n\t\t\t},\n\t\t\tsetCounter: (store, payload) =>\n\t\t\t{\n\t\t\t\tstore.commit('setCounter', payload);\n\t\t\t}\n\t\t};\n\t}\n\n\tgetMutations()\n\t{\n\t\treturn {\n\t\t\tadd: (state, payload) =>\n\t\t\t{\n\t\t\t\tpayload.forEach(item => {\n\t\t\t\t\tstate.collection.set(item.id, item);\n\t\t\t\t});\n\t\t\t},\n\t\t\taddSearchResult: (state, payload) =>\n\t\t\t{\n\t\t\t\tpayload.forEach(item => {\n\t\t\t\t\tstate.searchCollection.set(item.id, item);\n\t\t\t\t});\n\t\t\t},\n\t\t\tupdate: (state, payload) =>\n\t\t\t{\n\t\t\t\tpayload.forEach(item => {\n\t\t\t\t\tstate.collection.set(item.id, {\n\t\t\t\t\t\t...state.collection.get(item.id),\n\t\t\t\t\t\t...item.fields\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t},\n\t\t\tupdateSearchResult: (state, payload) =>\n\t\t\t{\n\t\t\t\tpayload.forEach(item => {\n\t\t\t\t\tstate.searchCollection.set(item.id, {\n\t\t\t\t\t\t...state.searchCollection.get(item.id),\n\t\t\t\t\t\t...item.fields\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t},\n\t\t\tdelete: (state, payload) =>\n\t\t\t{\n\t\t\t\tstate.collection.delete(payload.id);\n\t\t\t},\n\t\t\tread: (state, payload) =>\n\t\t\t{\n\t\t\t\tstate.collection.set(payload.id, {\n\t\t\t\t\t...state.collection.get(payload.id),\n\t\t\t\t\tread: payload.read\n\t\t\t\t});\n\t\t\t},\n\t\t\treadAll: (state) =>\n\t\t\t{\n\t\t\t\t[...state.collection.values()].forEach(item => {\n\t\t\t\t\tif (!item.read)\n\t\t\t\t\t{\n\t\t\t\t\t\titem.read = true;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\t\t\tsetCounter: (state, payload) =>\n\t\t\t{\n\t\t\t\tstate.unreadCounter = Number.parseInt(payload, 10);\n\t\t\t},\n\t\t\tdecreaseCounter: (state) =>\n\t\t\t{\n\t\t\t\tif (state.unreadCounter > 0)\n\t\t\t\t{\n\t\t\t\t\tstate.unreadCounter--;\n\t\t\t\t}\n\t\t\t},\n\t\t\tincreaseCounter: (state) =>\n\t\t\t{\n\t\t\t\tstate.unreadCounter++;\n\t\t\t},\n\t\t\tclearSearchResult: (state) =>\n\t\t\t{\n\t\t\t\tstate.searchCollection.clear();\n\t\t\t}\n\t\t};\n\t}\n\n\tstatic validate(fields: Object)\n\t{\n\t\tconst result = {};\n\n\t\tif (Type.isString(fields.id) || Type.isNumber(fields.id))\n\t\t{\n\t\t\tresult.id = fields.id;\n\t\t}\n\n\t\tif (Type.isNumber(fields.author_id))\n\t\t{\n\t\t\tresult.authorId = fields.author_id;\n\t\t}\n\t\telse if (Type.isNumber(fields.userId))\n\t\t{\n\t\t\tresult.authorId = fields.userId;\n\t\t}\n\n\t\tif (!Type.isNil(fields.date))\n\t\t{\n\t\t\tresult.date = Utils.date.cast(fields.date);\n\t\t}\n\n\t\tif (Type.isString(fields.notify_title))\n\t\t{\n\t\t\tresult.title = fields.notify_title;\n\t\t}\n\t\telse if (Type.isString(fields.title))\n\t\t{\n\t\t\tresult.title = fields.title;\n\t\t}\n\n\t\tif (Type.isString(fields.text) || Type.isNumber(fields.text))\n\t\t{\n\t\t\tresult.text = Text.decode(fields.text.toString());\n\t\t}\n\n\t\tif (Type.isObjectLike(fields.params))\n\t\t{\n\t\t\tresult.params = fields.params;\n\t\t}\n\n\t\tif (Type.isArray(fields.replaces))\n\t\t{\n\t\t\tresult.replaces = fields.replaces;\n\t\t}\n\n\t\tif (!Type.isNil(fields.notify_buttons))\n\t\t{\n\t\t\tresult.notifyButtons = JSON.parse(fields.notify_buttons);\n\t\t}\n\t\telse if (!Type.isNil(fields.buttons))\n\t\t{\n\t\t\tresult.notifyButtons = fields.buttons.map(button => {\n\t\t\t\treturn {\n\t\t\t\t\tCOMMAND: 'notifyConfirm',\n\t\t\t\t\tCOMMAND_PARAMS: `${result.id}|${button.VALUE}`,\n\t\t\t\t\tTEXT: `${button.TITLE}`,\n\t\t\t\t\tTYPE: 'BUTTON',\n\t\t\t\t\tDISPLAY: 'LINE',\n\t\t\t\t\tBG_COLOR: (button.VALUE === 'Y' ? '#8bc84b' : '#ef4b57'),\n\t\t\t\t\tTEXT_COLOR: '#fff',\n\t\t\t\t};\n\t\t\t});\n\t\t}\n\n\t\tif (fields.notify_type === NotificationTypesCodes.confirm || fields.type === NotificationTypesCodes.confirm)\n\t\t{\n\t\t\tresult.sectionCode = NotificationTypesCodes.confirm;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tresult.sectionCode = NotificationTypesCodes.simple;\n\t\t}\n\n\t\tif (!Type.isNil(fields.notify_read))\n\t\t{\n\t\t\tresult.read = fields.notify_read === 'Y';\n\t\t}\n\t\telse if (!Type.isNil(fields.read))\n\t\t{\n\t\t\tresult.read = fields.read === 'Y';\n\t\t}\n\n\t\tif (Type.isString(fields.setting_name))\n\t\t{\n\t\t\tresult.settingName = fields.setting_name;\n\t\t}\n\t\telse if (Type.isString(fields.settingName))\n\t\t{\n\t\t\tresult.settingName = fields.settingName;\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tsortByType(a, b)\n\t{\n\t\tif (a.sectionCode === NotificationTypesCodes.confirm && b.sectionCode !== NotificationTypesCodes.confirm)\n\t\t{\n\t\t\treturn -1;\n\t\t}\n\t\telse if (a.sectionCode !== NotificationTypesCodes.confirm && b.sectionCode === NotificationTypesCodes.confirm)\n\t\t{\n\t\t\treturn 1;\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn b.id - a.id;\n\t\t}\n\t}\n}\n","import {BuilderModel} from 'ui.vue3.vuex';\nimport {Type} from 'main.core';\n\nimport {Utils} from 'im.v2.lib.utils';\n\nimport type {ImModelSidebarLinkItem} from '../registry';\n\ntype LinksState = {\n\tcollection: {[chatId: number]: Map<number, ImModelSidebarLinkItem>},\n\tcounters: {[chatId: number]: number},\n};\n\nexport class LinksModel extends BuilderModel\n{\n\tgetState(): LinksState\n\t{\n\t\treturn {\n\t\t\tcollection: {},\n\t\t\tcounters: {}\n\t\t};\n\t}\n\n\tgetGetters()\n\t{\n\t\treturn {\n\t\t\tget: (state) => (chatId: number): ImModelSidebarLinkItem[] => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\treturn [...state.collection[chatId].values()].sort((a, b) => b.id - a.id);\n\t\t\t},\n\t\t\tgetSize: (state) => (chatId: number): number => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[chatId].size;\n\t\t\t},\n\t\t\tgetCounter: (state) => (chatId: number): number => {\n\t\t\t\tif (!state.counters[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn state.counters[chatId];\n\t\t\t}\n\t\t};\n\t}\n\n\tgetElementState(): ImModelSidebarLinkItem\n\t{\n\t\treturn {\n\t\t\tid: 0,\n\t\t\tmessageId: 0,\n\t\t\tchatId: 0,\n\t\t\tauthorId: 0,\n\t\t\tsource: '',\n\t\t\tdate: new Date(),\n\t\t\trichData: {\n\t\t\t\tid: null,\n\t\t\t\tdescription: null,\n\t\t\t\tlink: null,\n\t\t\t\tname: null,\n\t\t\t\tpreviewUrl: null,\n\t\t\t\ttype: null,\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions(): Object\n\t{\n\t\treturn {\n\t\t\tsetCounter: (store, payload) => {\n\t\t\t\tif (!Type.isNumber(payload.counter) || !Type.isNumber(payload.chatId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setCounter', payload);\n\t\t\t},\n\t\t\tset: (store, payload) => {\n\t\t\t\tconst {chatId, links} = payload;\n\t\t\t\tif (!Type.isArrayFilled(links) || !Type.isNumber(chatId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!store.state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\tstore.state.collection[chatId] = new Map();\n\t\t\t\t}\n\n\t\t\t\tlinks.forEach(link => {\n\t\t\t\t\tconst preparedLink = {...this.getElementState(), ...this.validate(link)};\n\t\t\t\t\tstore.commit('add', {chatId, link: preparedLink});\n\t\t\t\t});\n\t\t\t},\n\t\t\tdelete: (store, payload) => {\n\t\t\t\tconst {chatId, id} = payload;\n\t\t\t\tif (!Type.isNumber(id) || !Type.isNumber(chatId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!store.state.collection[chatId] || !store.state.collection[chatId].has(id))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('delete', {chatId, id});\n\t\t\t}\n\t\t};\n\t}\n\n\tgetMutations(): Object\n\t{\n\t\treturn {\n\t\t\tsetCounter: (state, payload) => {\n\t\t\t\tconst {chatId, counter} = payload;\n\t\t\t\tstate.counters[chatId] = counter;\n\t\t\t},\n\t\t\tadd: (state, payload: {chatId: number, link: ImModelSidebarLinkItem}) => {\n\t\t\t\tconst {chatId, link} = payload;\n\t\t\t\tstate.collection[chatId].set(link.id, link);\n\t\t\t},\n\t\t\tdelete: (state, payload: {chatId: number, id: number}) => {\n\t\t\t\tconst {chatId, id} = payload;\n\t\t\t\tstate.collection[chatId].delete(id);\n\t\t\t\tstate.counters[chatId]--;\n\t\t\t}\n\t\t};\n\t}\n\n\tvalidate(fields: Object): ImModelSidebarLinkItem\n\t{\n\t\tconst result = {\n\t\t\trichData: {}\n\t\t};\n\n\t\tif (Type.isNumber(fields.id))\n\t\t{\n\t\t\tresult.id = fields.id;\n\t\t}\n\n\t\tif (Type.isNumber(fields.messageId))\n\t\t{\n\t\t\tresult.messageId = fields.messageId;\n\t\t}\n\n\t\tif (Type.isNumber(fields.chatId))\n\t\t{\n\t\t\tresult.chatId = fields.chatId;\n\t\t}\n\n\t\tif (Type.isNumber(fields.authorId))\n\t\t{\n\t\t\tresult.authorId = fields.authorId;\n\t\t}\n\n\t\tif (Type.isString(fields.url.source))\n\t\t{\n\t\t\tresult.source = fields.url.source;\n\t\t}\n\n\t\tif (Type.isString(fields.dateCreate))\n\t\t{\n\t\t\tresult.date = Utils.date.cast(fields.dateCreate);\n\t\t}\n\n\t\tif (Type.isPlainObject(fields.url.richData))\n\t\t{\n\t\t\tresult.richData = this.validateRichData(fields.url.richData);\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tvalidateRichData(richData: Object): Object\n\t{\n\t\tconst result = {};\n\n\t\tif (Type.isNumber(richData.id))\n\t\t{\n\t\t\tresult.id = richData.id;\n\t\t}\n\n\t\tif (Type.isString(richData.description))\n\t\t{\n\t\t\tresult.description = richData.description;\n\t\t}\n\n\t\tif (Type.isString(richData.link))\n\t\t{\n\t\t\tresult.link = richData.link;\n\t\t}\n\n\t\tif (Type.isString(richData.name))\n\t\t{\n\t\t\tresult.name = richData.name;\n\t\t}\n\n\t\tif (Type.isString(richData.previewUrl))\n\t\t{\n\t\t\tresult.previewUrl = richData.previewUrl;\n\t\t}\n\n\t\tif (Type.isString(richData.type))\n\t\t{\n\t\t\tresult.type = richData.type;\n\t\t}\n\n\t\treturn result;\n\t}\n}","import {Type} from 'main.core';\nimport {BuilderModel} from 'ui.vue3.vuex';\n\nimport {Utils} from 'im.v2.lib.utils';\n\nimport type {ImModelSidebarFavoriteItem} from '../registry';\n\ntype FavoritesState = {\n\tcollection: {[chatId: number]: Map<number, ImModelSidebarFavoriteItem>},\n\tcounters: {[chatId: number]: number},\n};\n\nexport class FavoritesModel extends BuilderModel\n{\n\tgetState(): FavoritesState\n\t{\n\t\treturn {\n\t\t\tcollection: {},\n\t\t\tcounters: {},\n\t\t};\n\t}\n\n\tgetElementState(): ImModelSidebarFavoriteItem\n\t{\n\t\treturn {\n\t\t\tid: 0,\n\t\t\tmessageId: 0,\n\t\t\tchatId: 0,\n\t\t\tauthorId: 0,\n\t\t\tdate: new Date(),\n\t\t};\n\t}\n\n\tgetGetters(): Object\n\t{\n\t\treturn {\n\t\t\tget: (state) => (chatId: number): ImModelSidebarFavoriteItem[] => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\treturn [...state.collection[chatId].values()].sort((a, b) => b.id - a.id);\n\t\t\t},\n\t\t\tgetSize: (state) => (chatId: number): number => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[chatId].size;\n\t\t\t},\n\t\t\tgetCounter: (state) => (chatId: number): number => {\n\t\t\t\tif (state.counters[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn state.counters[chatId];\n\t\t\t\t}\n\n\t\t\t\treturn 0;\n\t\t\t},\n\t\t\tisFavoriteMessage: (state) => (chatId: number, messageId: number): boolean => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst chatFavorites = Object.fromEntries(state.collection[chatId]);\n\t\t\t\tconst targetMessage = Object.values(chatFavorites).find(element => element.messageId === messageId);\n\n\t\t\t\treturn !!targetMessage;\n\t\t\t}\n\t\t};\n\t}\n\n\tgetActions(): Object\n\t{\n\t\treturn {\n\t\t\tsetCounter: (store, payload) => {\n\t\t\t\tif (!Type.isNumber(payload.counter) || !Type.isNumber(payload.chatId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setCounter', payload);\n\t\t\t},\n\t\t\tset: (store, payload) => {\n\t\t\t\tif (Type.isNumber(payload.favorites))\n\t\t\t\t{\n\t\t\t\t\tpayload.favorites = [payload.favorites];\n\t\t\t\t}\n\t\t\t\tconst {chatId, favorites} = payload;\n\n\t\t\t\tif (!Type.isArrayFilled(favorites) || !Type.isNumber(chatId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!store.state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\tstore.state.collection[chatId] = new Map();\n\t\t\t\t}\n\n\t\t\t\tfavorites.forEach(favorite => {\n\t\t\t\t\tconst preparedFavoriteMessage = {...this.getElementState(), ...this.validate(favorite)};\n\t\t\t\t\tstore.commit('add', {chatId, favorite: preparedFavoriteMessage});\n\t\t\t\t});\n\t\t\t},\n\t\t\tdelete: (store, payload) => {\n\t\t\t\tconst {chatId, id} = payload;\n\t\t\t\tif (!Type.isNumber(id) || !Type.isNumber(chatId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!store.state.collection[chatId] || !store.state.collection[chatId].has(id))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('delete', {chatId, id});\n\t\t\t},\n\t\t\tdeleteByMessageId: (store, payload: {chatId: number, messageId: number}) => {\n\t\t\t\tconst {chatId, messageId} = payload;\n\t\t\t\tif (!store.state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst chatCollection = store.state.collection[chatId];\n\t\t\t\tlet targetLinkId = null;\n\t\t\t\tfor (const [linkId, linkObject] of chatCollection)\n\t\t\t\t{\n\t\t\t\t\tif (linkObject.messageId === messageId)\n\t\t\t\t\t{\n\t\t\t\t\t\ttargetLinkId = linkId;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (!targetLinkId)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('delete', {chatId, id: targetLinkId});\n\t\t\t}\n\t\t};\n\t}\n\n\tgetMutations(): Object\n\t{\n\t\treturn {\n\t\t\tsetCounter: (state, payload) => {\n\t\t\t\tconst {chatId, counter} = payload;\n\t\t\t\tstate.counters[chatId] = counter;\n\t\t\t},\n\t\t\tadd: (state, payload: {chatId: number, favorite: ImModelSidebarFavoriteItem}) => {\n\t\t\t\tconst {chatId, favorite} = payload;\n\t\t\t\tstate.collection[chatId].set(favorite.id, favorite);\n\t\t\t},\n\t\t\tdelete: (state, payload: {chatId: number, id: number}) => {\n\t\t\t\tconst {chatId, id} = payload;\n\t\t\t\tstate.collection[chatId].delete(id);\n\t\t\t\tstate.counters[chatId]--;\n\t\t\t}\n\t\t};\n\t}\n\n\tvalidate(fields: Object): ImModelSidebarFavoriteItem\n\t{\n\t\tconst result = {};\n\n\t\tif (Type.isNumber(fields.id))\n\t\t{\n\t\t\tresult.id = fields.id;\n\t\t}\n\n\t\tif (Type.isNumber(fields.messageId))\n\t\t{\n\t\t\tresult.messageId = fields.messageId;\n\t\t}\n\n\t\tif (Type.isNumber(fields.chatId))\n\t\t{\n\t\t\tresult.chatId = fields.chatId;\n\t\t}\n\n\t\tif (Type.isNumber(fields.authorId))\n\t\t{\n\t\t\tresult.authorId = fields.authorId;\n\t\t}\n\n\t\tif (Type.isString(fields.dateCreate))\n\t\t{\n\t\t\tresult.date = Utils.date.cast(fields.dateCreate);\n\t\t}\n\n\t\treturn result;\n\t}\n}\n","import {Type} from 'main.core';\nimport {BuilderModel} from 'ui.vue3.vuex';\n\ntype MembersState = {\n\tcollection: {[chatId: number]: Set<number>},\n};\n\nexport class MembersModel extends BuilderModel\n{\n\tgetState(): MembersState\n\t{\n\t\treturn {\n\t\t\tcollection: {},\n\t\t};\n\t}\n\n\tgetGetters()\n\t{\n\t\treturn {\n\t\t\tget: (state) => (chatId: number): Array =>\n\t\t\t{\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\treturn [...state.collection[chatId]];\n\t\t\t},\n\t\t\tgetSize: (state) => (chatId: number): number => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[chatId].size;\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions(): Object\n\t{\n\t\treturn {\n\t\t\tset: (store, payload) =>\n\t\t\t{\n\t\t\t\tconst {chatId, users} = payload;\n\t\t\t\tif (!Type.isArray(users) || !Type.isNumber(chatId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (users.length > 0)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('set', {chatId, users});\n\t\t\t\t}\n\t\t\t},\n\t\t\tdelete: (store, payload) => {\n\t\t\t\tconst {chatId, userId} = payload;\n\t\t\t\tif (!Type.isNumber(chatId) || !Type.isNumber(userId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!store.state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('delete', {userId, chatId});\n\t\t\t}\n\t\t};\n\t}\n\n\tgetMutations(): Object\n\t{\n\t\treturn {\n\t\t\tset: (state, payload) =>\n\t\t\t{\n\t\t\t\tif (!state.collection[payload.chatId])\n\t\t\t\t{\n\t\t\t\t\tstate.collection[payload.chatId] = new Set(payload.users);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tpayload.users.forEach(id => {\n\t\t\t\t\t\tstate.collection[payload.chatId].add(id);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t},\n\t\t\tdelete: (state, payload: {chatId: number, userId: number}) => {\n\t\t\t\tconst {chatId, userId} = payload;\n\t\t\t\tstate.collection[chatId].delete(userId);\n\t\t\t}\n\t\t};\n\t}\n}","import {BuilderModel} from 'ui.vue3.vuex';\nimport {Type} from 'main.core';\n\nimport {Utils} from 'im.v2.lib.utils';\n\nimport type {ImModelSidebarTaskItem} from '../registry';\n\ntype TasksState = {\n\tcollection: {[chatId: number]: Map<number, ImModelSidebarTaskItem>},\n};\n\nexport class TasksModel extends BuilderModel\n{\n\tgetState(): TasksState\n\t{\n\t\treturn {\n\t\t\tcollection: {},\n\t\t};\n\t}\n\n\tgetElementState(): ImModelSidebarTaskItem\n\t{\n\t\treturn {\n\t\t\tid: 0,\n\t\t\tmessageId: 0,\n\t\t\tchatId: 0,\n\t\t\tauthorId: 0,\n\t\t\tdate: new Date(),\n\t\t\ttask: {\n\t\t\t\tid: 0,\n\t\t\t\ttitle: '',\n\t\t\t\tcreatorId: 0,\n\t\t\t\tresponsibleId: 0,\n\t\t\t\tstatus: 0,\n\t\t\t\tstatusTitle: '',\n\t\t\t\tdeadline: new Date(),\n\t\t\t\tstate: '',\n\t\t\t\tcolor: '',\n\t\t\t\tsource: ''\n\t\t\t}\n\t\t};\n\t}\n\n\tgetGetters(): Object\n\t{\n\t\treturn {\n\t\t\tget: (state) => (chatId: number): ImModelSidebarTaskItem[] => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\treturn [...state.collection[chatId].values()].sort((a, b) => b.id - a.id);\n\t\t\t},\n\t\t\tgetSize: (state) => (chatId: number): number => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[chatId].size;\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions(): Object\n\t{\n\t\treturn {\n\t\t\tset: (store, payload) => {\n\t\t\t\tconst {chatId, tasks} = payload;\n\t\t\t\tif (!Type.isArrayFilled(tasks) || !Type.isNumber(chatId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!store.state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\tstore.state.collection[chatId] = new Map();\n\t\t\t\t}\n\n\t\t\t\ttasks.forEach(task => {\n\t\t\t\t\tconst preparedTask = {...this.getElementState(), ...this.validate(task)};\n\t\t\t\t\tstore.commit('add', {chatId, task: preparedTask});\n\t\t\t\t});\n\t\t\t},\n\t\t\tdelete: (store, payload) => {\n\t\t\t\tconst {chatId, id} = payload;\n\t\t\t\tif (!Type.isNumber(chatId) || !Type.isNumber(id))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!store.state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('delete', {id, chatId});\n\t\t\t}\n\t\t};\n\t}\n\n\tgetMutations(): Object\n\t{\n\t\treturn {\n\t\t\tadd: (state, payload: {chatId: number, task: ImModelSidebarTaskItem}) => {\n\t\t\t\tconst {chatId, task} = payload;\n\t\t\t\tstate.collection[chatId].set(task.id, task);\n\t\t\t},\n\t\t\tdelete: (state, payload: {id: number, chatId: number}) => {\n\t\t\t\tconst {id, chatId} = payload;\n\t\t\t\tstate.collection[chatId].delete(id);\n\t\t\t}\n\t\t};\n\t}\n\n\tvalidate(fields: Object): ImModelSidebarTaskItem\n\t{\n\t\tconst result = {\n\t\t\ttask: {}\n\t\t};\n\n\t\tif (Type.isNumber(fields.id))\n\t\t{\n\t\t\tresult.id = fields.id;\n\t\t}\n\n\t\tif (Type.isNumber(fields.messageId))\n\t\t{\n\t\t\tresult.messageId = fields.messageId;\n\t\t}\n\n\t\tif (Type.isNumber(fields.chatId))\n\t\t{\n\t\t\tresult.chatId = fields.chatId;\n\t\t}\n\n\t\tif (Type.isNumber(fields.authorId))\n\t\t{\n\t\t\tresult.authorId = fields.authorId;\n\t\t}\n\n\t\tif (Type.isString(fields.dateCreate))\n\t\t{\n\t\t\tresult.date = Utils.date.cast(fields.dateCreate);\n\t\t}\n\n\t\tif (Type.isPlainObject(fields.task))\n\t\t{\n\t\t\tresult.task = this.validateTask(fields.task);\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tvalidateTask(task)\n\t{\n\t\tconst result = {};\n\n\t\tif (Type.isNumber(task.id))\n\t\t{\n\t\t\tresult.id = task.id;\n\t\t}\n\n\t\tif (Type.isString(task.title))\n\t\t{\n\t\t\tresult.title = task.title;\n\t\t}\n\n\t\tif (Type.isNumber(task.creatorId))\n\t\t{\n\t\t\tresult.creatorId = task.creatorId;\n\t\t}\n\n\t\tif (Type.isNumber(task.responsibleId))\n\t\t{\n\t\t\tresult.responsibleId = task.responsibleId;\n\t\t}\n\n\t\tif (Type.isNumber(task.status))\n\t\t{\n\t\t\tresult.status = task.status;\n\t\t}\n\n\t\tif (Type.isString(task.statusTitle))\n\t\t{\n\t\t\tresult.statusTitle = task.statusTitle;\n\t\t}\n\n\t\tif (Type.isString(task.deadline))\n\t\t{\n\t\t\tresult.deadline = Utils.date.cast(task.deadline);\n\t\t}\n\n\t\tif (Type.isString(task.state))\n\t\t{\n\t\t\tresult.state = task.state;\n\t\t}\n\n\t\tif (Type.isString(task.color))\n\t\t{\n\t\t\tresult.color = task.color;\n\t\t}\n\n\t\tif (Type.isString(task.source))\n\t\t{\n\t\t\tresult.source = task.source;\n\t\t}\n\n\t\treturn result;\n\t}\n}\n","import {Type} from 'main.core';\nimport {BuilderModel} from 'ui.vue3.vuex';\n\nimport {Utils} from 'im.v2.lib.utils';\n\nimport type {ImModelSidebarMeetingItem} from '../registry';\n\ntype MeetingsState = {\n\tcollection: {[chatId: number]: Map<number, ImModelSidebarMeetingItem>},\n};\n\nexport class MeetingsModel extends BuilderModel\n{\n\tgetState(): MeetingsState\n\t{\n\t\treturn {\n\t\t\tcollection: {},\n\t\t};\n\t}\n\n\tgetElementState(): ImModelSidebarMeetingItem\n\t{\n\t\treturn {\n\t\t\tid: 0,\n\t\t\tmessageId: 0,\n\t\t\tchatId: 0,\n\t\t\tauthorId: 0,\n\t\t\tdate: new Date(),\n\t\t\tmeeting: {\n\t\t\t\tid: 0,\n\t\t\t\ttitle: '',\n\t\t\t\tdateFrom: new Date(),\n\t\t\t\tdateTo: new Date(),\n\t\t\t\tsource: ''\n\t\t\t}\n\t\t};\n\t}\n\n\tgetGetters(): Object\n\t{\n\t\treturn {\n\t\t\tget: (state) => (chatId: number): ImModelSidebarMeetingItem[] => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\treturn [...state.collection[chatId].values()].sort((a, b) => b.id - a.id);\n\t\t\t},\n\t\t\tgetSize: (state) => (chatId: string): number => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[chatId].size;\n\t\t\t}\n\t\t};\n\t}\n\n\tgetActions(): Object\n\t{\n\t\treturn {\n\t\t\tset: (store, payload) => {\n\t\t\t\tconst {chatId, meetings} = payload;\n\t\t\t\tif (!Type.isArrayFilled(meetings) || !Type.isNumber(chatId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!store.state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\tstore.state.collection[chatId] = new Map();\n\t\t\t\t}\n\n\t\t\t\tmeetings.forEach(meeting => {\n\t\t\t\t\tconst preparedMeeting = {...this.getElementState(), ...this.validate(meeting)};\n\t\t\t\t\tstore.commit('add', {chatId, meeting: preparedMeeting});\n\t\t\t\t});\n\t\t\t},\n\t\t\tdelete: (store, payload) => {\n\t\t\t\tconst {chatId, id} = payload;\n\t\t\t\tif (!Type.isNumber(chatId) || !Type.isNumber(id))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!store.state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('delete', {id, chatId});\n\t\t\t}\n\t\t};\n\t}\n\n\tgetMutations(): Object\n\t{\n\t\treturn {\n\t\t\tadd: (state, payload: {chatId: number, meeting: ImModelSidebarMeetingItem}) => {\n\t\t\t\tconst {chatId, meeting} = payload;\n\t\t\t\tstate.collection[chatId].set(meeting.id, meeting);\n\t\t\t},\n\t\t\tdelete: (state, payload: {id: number, chatId: number}) => {\n\t\t\t\tconst {id, chatId} = payload;\n\t\t\t\tstate.collection[chatId].delete(id);\n\t\t\t}\n\t\t};\n\t}\n\n\tvalidate(fields: Object): ImModelSidebarMeetingItem\n\t{\n\t\tconst result = {\n\t\t\tmeeting: {}\n\t\t};\n\n\t\tif (Type.isNumber(fields.id))\n\t\t{\n\t\t\tresult.id = fields.id;\n\t\t}\n\n\t\tif (Type.isNumber(fields.messageId))\n\t\t{\n\t\t\tresult.messageId = fields.messageId;\n\t\t}\n\n\t\tif (Type.isNumber(fields.chatId))\n\t\t{\n\t\t\tresult.chatId = fields.chatId;\n\t\t}\n\n\t\tif (Type.isNumber(fields.authorId))\n\t\t{\n\t\t\tresult.authorId = fields.authorId;\n\t\t}\n\n\t\tif (Type.isString(fields.dateCreate))\n\t\t{\n\t\t\tresult.date = Utils.date.cast(fields.dateCreate);\n\t\t}\n\n\t\tif (Type.isPlainObject(fields.calendar))\n\t\t{\n\t\t\tresult.meeting = this.validateMeeting(fields.calendar);\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tvalidateMeeting(meeting)\n\t{\n\t\tconst result = {};\n\n\t\tif (Type.isNumber(meeting.id))\n\t\t{\n\t\t\tresult.id = meeting.id;\n\t\t}\n\n\t\tif (Type.isString(meeting.title))\n\t\t{\n\t\t\tresult.title = meeting.title;\n\t\t}\n\n\t\tif (Type.isString(meeting.dateFrom))\n\t\t{\n\t\t\tresult.dateFrom = Utils.date.cast(meeting.dateFrom);\n\t\t}\n\n\t\tif (Type.isString(meeting.dateTo))\n\t\t{\n\t\t\tresult.dateTo = Utils.date.cast(meeting.dateTo);\n\t\t}\n\n\t\tif (Type.isString(meeting.source))\n\t\t{\n\t\t\tresult.source = meeting.source;\n\t\t}\n\n\t\treturn result;\n\t}\n}\n","import {Type} from 'main.core';\nimport {BuilderModel} from 'ui.vue3.vuex';\n\nimport {SidebarFileTypes} from 'im.v2.const';\nimport {Utils} from 'im.v2.lib.utils';\n\nimport type {ImModelSidebarFileItem} from '../registry';\n\ntype FilesState = {\n\tcollection: {\n\t\t[chatId: number]: {\n\t\t\t[SidebarFileTypes: string]: Map<number, ImModelSidebarFileItem>\n\t\t}\n\t},\n};\n\nexport class FilesModel extends BuilderModel\n{\n\tgetState(): FilesState\n\t{\n\t\treturn {\n\t\t\tcollection: {},\n\t\t};\n\t}\n\n\tgetElementState(): ImModelSidebarFileItem\n\t{\n\t\treturn {\n\t\t\tid: 0,\n\t\t\tmessageId: 0,\n\t\t\tchatId: 0,\n\t\t\tauthorId: 0,\n\t\t\tdate: new Date(),\n\t\t\tfileId: 0,\n\t\t};\n\t}\n\n\tgetGetters(): Object\n\t{\n\t\treturn {\n\t\t\tget: (state) => (chatId: number, subType: string): ImModelSidebarFileItem[] => {\n\t\t\t\tif (!state.collection[chatId] || !state.collection[chatId][subType])\n\t\t\t\t{\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\treturn [...state.collection[chatId][subType].values()].sort((a, b) => b.id - a.id);\n\t\t\t},\n\n\t\t\tgetLatest: (state, getters, rootState, rootGetters) => (chatId: number): ImModelSidebarFileItem[] => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\tlet media = [];\n\t\t\t\tlet audio = [];\n\t\t\t\tlet documents = [];\n\t\t\t\tlet other = [];\n\n\t\t\t\tif (state.collection[chatId][SidebarFileTypes.media])\n\t\t\t\t{\n\t\t\t\t\tmedia = [...state.collection[chatId][SidebarFileTypes.media].values()];\n\t\t\t\t}\n\t\t\t\tif (state.collection[chatId][SidebarFileTypes.audio])\n\t\t\t\t{\n\t\t\t\t\taudio = [...state.collection[chatId][SidebarFileTypes.audio].values()];\n\t\t\t\t}\n\t\t\t\tif (state.collection[chatId][SidebarFileTypes.document])\n\t\t\t\t{\n\t\t\t\t\tdocuments = [...state.collection[chatId][SidebarFileTypes.document].values()];\n\t\t\t\t}\n\t\t\t\tif (state.collection[chatId][SidebarFileTypes.other])\n\t\t\t\t{\n\t\t\t\t\tother = [...state.collection[chatId][SidebarFileTypes.other].values()];\n\t\t\t\t}\n\n\t\t\t\tconst sortedFlatCollection = [media, audio, documents, other]\n\t\t\t\t\t.flat()\n\t\t\t\t\t.sort((a, b) => b.id - a.id)\n\t\t\t\t;\n\n\t\t\t\treturn this.getTopThreeCompletedFiles(sortedFlatCollection, rootGetters);\n\t\t\t},\n\t\t\tgetLatestUnsorted: (state, getters, rootState, rootGetters) => (chatId: number): ImModelSidebarFileItem[] => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\tlet unsorted = [];\n\n\t\t\t\tif (state.collection[chatId][SidebarFileTypes.fileUnsorted])\n\t\t\t\t{\n\t\t\t\t\tunsorted = [...state.collection[chatId][SidebarFileTypes.fileUnsorted].values()];\n\t\t\t\t}\n\n\t\t\t\tconst sortedCollection = unsorted.sort((a, b) => b.id - a.id);\n\n\t\t\t\treturn this.getTopThreeCompletedFiles(sortedCollection, rootGetters);\n\t\t\t},\n\t\t\tgetSize: (state) => (chatId: string, subType: string): number => {\n\t\t\t\tif (!state.collection[chatId] || !state.collection[chatId][subType])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[chatId][subType].size;\n\t\t\t}\n\t\t};\n\t}\n\n\tgetActions(): Object\n\t{\n\t\treturn {\n\t\t\tset: (store, payload) => {\n\t\t\t\tconst {chatId, files} = payload;\n\t\t\t\tif (!Type.isArrayFilled(files) || !Type.isNumber(chatId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!store.state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\tstore.state.collection[chatId] = {};\n\t\t\t\t}\n\n\t\t\t\tfiles.forEach(file => {\n\t\t\t\t\tconst preparedFile = {...this.getElementState(), ...this.validate(file)};\n\t\t\t\t\tconst {subType} = file;\n\t\t\t\t\tstore.commit('add', {chatId, subType, file: preparedFile});\n\t\t\t\t});\n\t\t\t},\n\t\t\tdelete: (store, payload) => {\n\t\t\t\tconst {chatId, id} = payload;\n\t\t\t\tif (!Type.isNumber(id) || !Type.isNumber(chatId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!store.state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('delete', {chatId, id});\n\t\t\t}\n\t\t};\n\t}\n\n\tgetMutations(): Object\n\t{\n\t\treturn {\n\t\t\tadd: (state, payload: {chatId: number, subType: string, file: ImModelSidebarFileItem}) => {\n\t\t\t\tconst {chatId, file, subType} = payload;\n\t\t\t\tif (!state.collection[chatId][subType])\n\t\t\t\t{\n\t\t\t\t\tstate.collection[chatId][subType] = new Map();\n\t\t\t\t}\n\t\t\t\tstate.collection[chatId][subType].set(file.id, file);\n\t\t\t},\n\t\t\tdelete: (state, payload: {chatId: number, id: number}) => {\n\t\t\t\tconst {chatId, id} = payload;\n\n\t\t\t\tObject.values(SidebarFileTypes).forEach(subType => {\n\t\t\t\t\tif (state.collection[chatId][subType] && state.collection[chatId][subType].has(id))\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.collection[chatId][subType].delete(id);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\t}\n\n\tvalidate(fields: Object): ImModelSidebarFileItem\n\t{\n\t\tconst result = {};\n\n\t\tif (Type.isNumber(fields.id))\n\t\t{\n\t\t\tresult.id = fields.id;\n\t\t}\n\n\t\tif (Type.isNumber(fields.messageId))\n\t\t{\n\t\t\tresult.messageId = fields.messageId;\n\t\t}\n\n\t\tif (Type.isNumber(fields.chatId))\n\t\t{\n\t\t\tresult.chatId = fields.chatId;\n\t\t}\n\n\t\tif (Type.isNumber(fields.authorId))\n\t\t{\n\t\t\tresult.authorId = fields.authorId;\n\t\t}\n\n\t\tif (Type.isString(fields.dateCreate))\n\t\t{\n\t\t\tresult.date = Utils.date.cast(fields.dateCreate);\n\t\t}\n\t\telse if (Type.isString(fields.date))\n\t\t{\n\t\t\tresult.date = Utils.date.cast(fields.date);\n\t\t}\n\n\t\tresult.fileId = Type.isNumber(fields.fileId) ? fields.fileId : result.id;\n\n\t\treturn result;\n\t}\n\n\tgetTopThreeCompletedFiles(collection: ImModelSidebarFileItem[], rootGetters): ImModelSidebarFileItem[]\n\t{\n\t\treturn collection.filter((sidebarFile: ImModelSidebarFileItem) => {\n\t\t\tconst file = rootGetters['files/get'](sidebarFile.fileId, true);\n\n\t\t\treturn file.progress === 100;\n\t\t}).slice(0, 3);\n\t}\n}\n","import {BuilderModel} from 'ui.vue3.vuex';\nimport {Type} from 'main.core';\nimport {LinksModel} from './sidebar/links';\nimport {FavoritesModel} from './sidebar/favorites';\nimport {MembersModel} from './sidebar/members';\nimport {TasksModel} from './sidebar/tasks';\nimport {MeetingsModel} from './sidebar/meeting';\nimport {FilesModel} from './sidebar/files';\n\nexport class SidebarModel extends BuilderModel\n{\n\tgetName(): string\n\t{\n\t\treturn 'sidebar';\n\t}\n\n\tgetNestedModules(): { [moduleName: string]: BuilderModel }\n\t{\n\t\treturn {\n\t\t\tmembers: MembersModel,\n\t\t\tlinks: LinksModel,\n\t\t\tfavorites: FavoritesModel,\n\t\t\ttasks: TasksModel,\n\t\t\tmeetings: MeetingsModel,\n\t\t\tfiles: FilesModel,\n\t\t};\n\t}\n\n\tgetState()\n\t{\n\t\treturn {\n\t\t\tinitedList: new Set(),\n\t\t\tisFilesMigrated: false,\n\t\t\tisLinksMigrated: false\n\t\t};\n\t}\n\n\tgetGetters()\n\t{\n\t\treturn {\n\t\t\tisInited: (state) => (chatId: number): boolean =>\n\t\t\t{\n\t\t\t\treturn state.initedList.has(chatId);\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions()\n\t{\n\t\treturn {\n\t\t\tsetInited: (store, chatId) =>\n\t\t\t{\n\t\t\t\tif (!Type.isNumber(chatId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setInited', chatId);\n\t\t\t},\n\t\t\tsetFilesMigrated: (store, value: boolean) =>\n\t\t\t{\n\t\t\t\tif (!Type.isBoolean(value))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setFilesMigrated', value);\n\t\t\t},\n\t\t\tsetLinksMigrated: (store, value: boolean) =>\n\t\t\t{\n\t\t\t\tif (!Type.isBoolean(value))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setLinksMigrated', value);\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMutations()\n\t{\n\t\treturn {\n\t\t\tsetInited: (state, payload) =>\n\t\t\t{\n\t\t\t\tstate.initedList.add(payload);\n\t\t\t},\n\t\t\tsetFilesMigrated: (state, payload: boolean) =>\n\t\t\t{\n\t\t\t\tstate.isFilesMigrated = payload;\n\t\t\t},\n\t\t\tsetLinksMigrated: (state, payload: boolean) =>\n\t\t\t{\n\t\t\t\tstate.isLinksMigrated = payload;\n\t\t\t},\n\t\t};\n\t}\n}","import {Type} from 'main.core';\nimport {BuilderModel} from 'ui.vue3.vuex';\n\nimport {PlacementType} from 'im.v2.const';\n\nimport type {MarketApplication} from './type/market';\n\nexport class MarketModel extends BuilderModel\n{\n\tgetName(): string\n\t{\n\t\treturn 'market';\n\t}\n\n\tgetState()\n\t{\n\t\treturn {\n\t\t\tcollection: new Map(),\n\t\t\tplacementCollection: {\n\t\t\t\t[PlacementType.contextMenu]: new Set(),\n\t\t\t\t[PlacementType.navigation]: new Set(),\n\t\t\t\t[PlacementType.textarea]: new Set(),\n\t\t\t\t[PlacementType.sidebar]: new Set(),\n\t\t\t\t[PlacementType.smilesSelector]: new Set()\n\t\t\t},\n\t\t};\n\t}\n\n\tgetElementState(): MarketApplication\n\t{\n\t\treturn {\n\t\t\tid: 0,\n\t\t\ttitle: '',\n\t\t\toptions: {\n\t\t\t\trole: '',\n\t\t\t\textranet: '',\n\t\t\t\tcontext: null,\n\t\t\t\twidth: null,\n\t\t\t\theight: null,\n\t\t\t\tcolor: null,\n\t\t\t\ticonName: null\n\t\t\t},\n\t\t\tplacement: '',\n\t\t\torder: 0,\n\t\t\tloadConfiguration: {\n\t\t\t\tID: 0,\n\t\t\t\tPLACEMENT: '',\n\t\t\t\tPLACEMENT_ID: 0,\n\t\t\t},\n\t\t};\n\t}\n\n\tgetGetters()\n\t{\n\t\treturn {\n\t\t\tgetByPlacement: (state) => (placement: string): MarketApplication[] =>\n\t\t\t{\n\t\t\t\tconst appIds = [...state.placementCollection[placement].values()];\n\n\t\t\t\treturn appIds.map(id => {\n\t\t\t\t\treturn state.collection.get(id);\n\t\t\t\t});\n\t\t\t},\n\t\t\tgetById: (state) => (id: number): number =>\n\t\t\t{\n\t\t\t\treturn state.collection.get(id);\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions()\n\t{\n\t\treturn {\n\t\t\tset: (store, payload) =>\n\t\t\t{\n\t\t\t\tconst {items} = payload;\n\n\t\t\t\titems.forEach((item: MarketApplication) => {\n\t\t\t\t\tstore.commit('setPlacementCollection', {placement: item.placement, id: item.id});\n\t\t\t\t\tstore.commit('setCollection', item);\n\t\t\t\t});\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMutations()\n\t{\n\t\treturn {\n\t\t\tsetPlacementCollection: (state, payload: MarketApplication) =>\n\t\t\t{\n\t\t\t\tstate.placementCollection[payload.placement].add(payload.id);\n\t\t\t},\n\t\t\tsetCollection: (state, payload: MarketApplication) =>\n\t\t\t{\n\t\t\t\tstate.collection.set(payload.id, {...this.getElementState(), ...this.#validate(payload)});\n\t\t\t},\n\t\t};\n\t}\n\n\t#validate(app: Object): MarketApplication\n\t{\n\t\tconst result = {};\n\n\t\tif (Type.isNumber(app.id) || Type.isStringFilled(app.id))\n\t\t{\n\t\t\tresult.id = app.id.toString();\n\t\t}\n\n\t\tif (Type.isString(app.title))\n\t\t{\n\t\t\tresult.title = app.title;\n\t\t}\n\n\t\tresult.options = this.#validateOptions(app.options);\n\n\t\tif (Type.isString(app.placement))\n\t\t{\n\t\t\tresult.placement = app.placement;\n\t\t}\n\n\t\tif (Type.isNumber(app.order))\n\t\t{\n\t\t\tresult.order = app.order;\n\t\t}\n\n\t\tresult.loadConfiguration = this.#validateLoadConfiguration(app.loadConfiguration);\n\n\t\treturn result;\n\t}\n\n\t#validateOptions(options: Object)\n\t{\n\t\tconst result = {\n\t\t\tcontext: null,\n\t\t\twidth: null,\n\t\t\theight: null,\n\t\t\tcolor: null,\n\t\t\ticonName: null\n\t\t};\n\n\t\tif (!Type.isPlainObject(options))\n\t\t{\n\t\t\treturn result;\n\t\t}\n\n\t\tif (Type.isArrayFilled(options.context))\n\t\t{\n\t\t\tresult.context = options.context;\n\t\t}\n\t\tif (Type.isNumber(options.width))\n\t\t{\n\t\t\tresult.width = options.width;\n\t\t}\n\n\t\tif (Type.isNumber(options.height))\n\t\t{\n\t\t\tresult.height = options.height;\n\t\t}\n\n\t\tif (Type.isStringFilled(options.color))\n\t\t{\n\t\t\tresult.color = options.color;\n\t\t}\n\n\t\tif (Type.isStringFilled(options.iconName))\n\t\t{\n\t\t\tresult.iconName = options.iconName;\n\t\t}\n\n\t\treturn result;\n\t}\n\n\t#validateLoadConfiguration(configuration: Object)\n\t{\n\t\tconst result = {\n\t\t\tID: 0,\n\t\t\tPLACEMENT: '',\n\t\t\tPLACEMENT_ID: 0,\n\t\t};\n\n\t\tif (!Type.isPlainObject(configuration))\n\t\t{\n\t\t\treturn result;\n\t\t}\n\n\t\tif (Type.isNumber(configuration.ID))\n\t\t{\n\t\t\tresult.ID = configuration.ID;\n\t\t}\n\n\t\tif (Type.isStringFilled(configuration.PLACEMENT))\n\t\t{\n\t\t\tresult.PLACEMENT = configuration.PLACEMENT;\n\t\t}\n\n\t\tif (Type.isNumber(configuration.PLACEMENT_ID))\n\t\t{\n\t\t\tresult.PLACEMENT_ID = configuration.PLACEMENT_ID;\n\t\t}\n\n\t\treturn result;\n\t}\n}"],"names":["SettingsModel","BuilderModel","getState","Settings","appearance","background","alignment","DialogAlignment","left","notification","enableSound","message","bigSmiles","recent","showBirthday","showInvited","showLastMessage","desktop","enableRedirect","getGetters","get","state","key","getActions","set","store","payload","commit","validate","getMutations","Object","entries","forEach","value","fields","result","Type","isBoolean","isStringFilled","isNumber","Number","parseInt","isString","hotkey","sendByEnter","ApplicationModel","getName","getNestedModules","settings","layout","name","Layout","chat","entityId","contextId","getLayout","isChatOpen","dialogId","toString","isLinesChatOpen","openlines","areNotificationsOpen","setLayout","layoutName","previousLayout","newLayout","validateLayout","validateLayoutEntityId","EventEmitter","emit","EventType","onLayoutChange","from","to","updateLayout","PinModel","collection","getPinned","chatId","map","pinnedMessageId","Core","getStore","getters","isPinned","messageId","has","setPinned","pinnedMessages","length","pinnedMessageIds","add","delete","Logger","warn","Set","reverse","USERS_TO_SHOW","ReactionsModel","getElementState","reactionCounters","reactionUsers","ownReactions","getByMessageId","prepareSetPayload","setReaction","Reaction","reaction","removeReaction","item","newItem","currentItem","newOwnReaction","userId","reactions","getUserId","removeAllCurrentUserReactions","currentCounter","users","counter","MessagesModel","pin","chatCollection","id","authorId","replyId","date","Date","text","replaces","files","attach","unread","viewed","viewedByOthers","sending","error","retry","componentId","MessageComponent","base","componentParams","isEdited","isDeleted","removeLinks","sort","a","b","getById","getByIdList","idList","push","hasMessage","isInChatCollection","getFirstId","getLastId","getLastOwnMessageId","getFirstUnread","getChatUnreadMessages","messages","filter","getMessageFiles","fileId","getMessageType","currentUserId","MessageType","system","self","opponent","getPreviousMessage","initialMessageIndex","indexOf","desiredMessageId","setChatCollection","clearCollection","Array","isArray","isPlainObject","preparedMessages","updateWithId","update","currentMessage","readMessages","messageIds","chatMessages","messagesToReadCount","maxMessageId","messageIdsToView","messageIdsToRead","chatMessage","setViewedByOthers","ids","clearChatCollection","deleteAttach","attachId","attachItem","ID","isOwnMessage","Utils","isUuidV4","temporaryId","isUndefined","chat_id","cast","isSystem","senderId","author_id","params","preparedParams","prepareParams","rawParams","values","includes","unsupported","isArrayFilled","firstId","element","isTempMessage","lastId","lastOwnMessageId","z","resultId","WRITING_STATUS_TIME","DialoguesModel","writingStatusTimers","type","DialogType","description","avatar","color","Color","extranet","userCounter","lastReadId","markedId","lastMessageId","lastMessageViews","countOfViewers","firstViewer","savedPositionMessageId","managerList","writingList","muteList","textareaMessage","quoteId","owner","entityType","dateCreate","public","code","link","inited","loading","hasPrevPage","hasNextPage","diskFolderId","role","UserRole","guest","permissions","manageUsers","none","manageUi","manageSettings","canPost","getBlank","getByChatId","preparedChatId","find","getQuoteId","isUser","user","getLastReadId","getInitialMessageId","Math","min","rawPayload","existingItem","startWriting","timerId","alreadyWriting","some","el","clearTimeout","setWritingStatusTimeout","userName","newWritingList","actionName","stopWriting","increaseCounter","increasedCounter","count","previousCounter","decreaseCounter","decreasedCounter","clearCounters","mute","unmute","setLastMessageViews","newLastMessageViews","clearLastMessageViews","defaultLastMessageViews","incrementLastMessageViews","newCounter","keys","setTimeout","dispatch","dialog_id","user_counter","last_id","marked_id","last_message_id","last_message_views","prepareLastMessageViews","title","Text","decode","ownerId","prepareAvatar","entity_type","entity_id","date_create","writing_list","prepareWritingList","manager_list","mute_list","prepareMuteList","disk_folder_id","toLowerCase","preparedPermissions","preparePermissions","manage_settings","manage_ui","manage_users","can_post","member","endsWith","startsWith","getHost","encodeURI","htmlspecialcharsback","rawLastMessageViews","firstViewers","rawFirstViewers","rawFirstViewer","Error","UsersModel","onlineList","mobileOnlineList","absentList","botList","firstName","lastName","workPosition","gender","isAdmin","network","bot","connector","externalAuthId","status","idle","lastActivityDate","mobileLastDate","isOnline","isMobileOnline","birthday","isBirthday","absent","isAbsent","departments","phones","workPhone","personalMobile","personalPhone","innerPhone","getTemporary","getList","userList","hasBirthday","hasVacation","getStatus","UserStatus","mobileOnline","getLastOnline","getLastDateText","getPosition","Loc","getMessage","getBotType","botType","BotType","existingUser","setBotList","setStatus","handleUserStatusFlags","startOnlineCheckInterval","startAbsentCheckInterval","first_name","last_name","work_position","external_auth_id","last_activity_date","mobile_last_date","departmentId","preparePhones","work_phone","personal_mobile","personal_phone","inner_phone","addToOnlineList","addToMobileOnlineList","isBirthdayToday","getTimeToNextMidnight","isDate","addToAbsentList","absentCheckInterval","TIME_TO_NEXT_DAY","setInterval","currentTime","now","absentEnd","getTime","onlineCheckInterval","ONE_MINUTE","FilesModel","extension","icon","size","image","FileStatus","done","progress","authorName","urlPreview","urlShow","urlDownload","viewerAttrs","isInCollection","preparedFile","file","currentFile","getIconTypeByExtension","width","height","validateViewerAttributes","viewer","actions","objectId","src","viewerGroupBy","viewerType","viewerTypeClass","viewerSeparateItem","viewerExtension","imChatId","CallsModel","call","RecentCallStatus","waiting","addActiveCall","existingCall","validateActiveCall","prepareActiveCall","updateActiveCall","deleteActiveCall","isObjectLike","associatedEntity","RecentSearchModel","dateUpdate","getCollection","recentElement","clear","options","date_update","RecentModel","calls","search","recentCollection","unreadCollection","unloadedChatCounters","unloadedLinesCounters","MessageStatus","received","withFile","withAttach","draft","pinned","liked","invitation","isActive","originator","canResend","getRecentCollection","dialog","Boolean","getUnreadCollection","getSortedCollection","collectionAsArray","isBirthdayPlaceholder","birthdayPlaceholder","isInvitedUser","defaultUserRecord","rawDialogId","needsBirthdayPlaceholder","hasTodayMessage","isToday","needsVacationPlaceholder","getMessageDate","getStartOfTheDay","getTotalChatCounter","loadedChatsCounter","recentItem","isMuted","isMarked","unloadedChatsCounter","getTotalLinesCounter","unloadedLinesCounter","getSpecificLinesCounter","setRecent","itemIds","zeroedCountersForNewItems","setUnread","itemsToUpdate","itemsToAdd","preparedElement","defaultMessage","action","like","isLastMessage","isExactMessageLiked","existingRecentCollectionItem","clearUnread","setUnloadedChatCounters","setUnloadedLinesCounters","setRecentCollection","deleteFromRecentCollection","setUnreadCollection","elementIsInRecent","defaultUserElement","currentElement","prepareMessage","prepareDraft","invited","originator_id","can_resend","default_user_record","NotificationsModel","Map","searchCollection","unreadCounter","notifyButtons","sectionCode","NotificationTypesCodes","simple","read","settingName","sortByType","getSearchResultCollection","getConfirmsCount","confirm","notificationId","getCounter","initialSet","total_unread_count","notifications","setSearchResult","skipValidation","readAll","clearSearchResult","setCounter","addSearchResult","updateSearchResult","isNil","notify_title","notify_buttons","JSON","parse","buttons","button","COMMAND","COMMAND_PARAMS","VALUE","TEXT","TITLE","TYPE","DISPLAY","BG_COLOR","TEXT_COLOR","notify_type","notify_read","setting_name","LinksModel","counters","getSize","source","richData","previewUrl","links","preparedLink","url","validateRichData","FavoritesModel","isFavoriteMessage","chatFavorites","fromEntries","targetMessage","favorites","favorite","preparedFavoriteMessage","deleteByMessageId","targetLinkId","linkId","linkObject","MembersModel","TasksModel","task","creatorId","responsibleId","statusTitle","deadline","tasks","preparedTask","validateTask","MeetingsModel","meeting","dateFrom","dateTo","meetings","preparedMeeting","calendar","validateMeeting","subType","getLatest","rootState","rootGetters","media","audio","documents","other","SidebarFileTypes","document","sortedFlatCollection","flat","getTopThreeCompletedFiles","getLatestUnsorted","unsorted","fileUnsorted","sortedCollection","sidebarFile","slice","SidebarModel","members","initedList","isFilesMigrated","isLinksMigrated","isInited","setInited","setFilesMigrated","setLinksMigrated","MarketModel","placementCollection","PlacementType","contextMenu","navigation","textarea","sidebar","smilesSelector","context","iconName","placement","order","loadConfiguration","PLACEMENT","PLACEMENT_ID","getByPlacement","appIds","items","setPlacementCollection","setCollection","app","configuration"],"mappings":"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"}