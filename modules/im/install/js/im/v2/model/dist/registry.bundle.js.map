{"version":3,"file":"registry.bundle.js","sources":["../src/utils/format.js","../src/application/nested-modules/format/format-functions.js","../src/application/nested-modules/format/field-config.js","../src/utils/validate.js","../src/application/nested-modules/settings.js","../src/application/application.js","../src/messages/format/format-functions.js","../src/messages/format/field-config.js","../src/messages/nested-modules/pin.js","../src/messages/nested-modules/reactions.js","../src/messages/messages.js","../src/chats/format/format-functions.js","../src/chats/format/field-config.js","../src/chats/chats.js","../src/users/nested-modules/bots.js","../src/users/format/format-functions.js","../src/users/format/field-config.js","../src/users/users.js","../src/files/files.js","../src/recent/nested-modules/calls.js","../src/recent/nested-modules/search.js","../src/recent/recent.js","../src/notifications/notifications.js","../src/sidebar/nested-modules/links.js","../src/sidebar/nested-modules/favorites.js","../src/sidebar/nested-modules/members.js","../src/sidebar/nested-modules/tasks.js","../src/sidebar/nested-modules/meeting.js","../src/sidebar/nested-modules/files.js","../src/sidebar/sidebar.js","../src/market/market.js","../src/counters/counters.js"],"sourcesContent":["import { Type, Text } from 'main.core';\nimport { Utils } from 'im.v2.lib.utils';\n\nimport type { JsonObject, JsonValue } from 'main.core';\n\nexport const isNumberOrString = (target: JsonValue): boolean => {\n\treturn Type.isNumber(target) || Type.isString(target);\n};\n\nexport const convertToString = (target: JsonValue): string => {\n\treturn target.toString();\n};\n\nexport const convertToNumber = (target: string | number): number => {\n\treturn Number.parseInt(target, 10);\n};\n\nexport const convertToDate = (target: string) => {\n\treturn Utils.date.cast(target, false);\n};\n\nconst SNAKE_CASE_REGEXP = /(_[\\da-z])/gi;\nexport const convertObjectKeysToCamelCase = (targetObject: JsonObject): JsonObject => {\n\tconst resultObject = {};\n\tObject.entries(targetObject).forEach(([key, value]) => {\n\t\tconst newKey = prepareKey(key);\n\t\tif (Type.isPlainObject(value))\n\t\t{\n\t\t\tresultObject[newKey] = convertObjectKeysToCamelCase(value);\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (Type.isArray(value))\n\t\t{\n\t\t\tresultObject[newKey] = convertArrayItemsKeysToCamelCase(value);\n\n\t\t\treturn;\n\t\t}\n\t\tresultObject[newKey] = value;\n\t});\n\n\treturn resultObject;\n};\n\nconst prepareKey = (rawKey: string): string => {\n\tlet key = rawKey;\n\tif (key.search(SNAKE_CASE_REGEXP) !== -1)\n\t{\n\t\tkey = key.toLowerCase();\n\t}\n\n\treturn Text.toCamelCase(key);\n};\n\nconst convertArrayItemsKeysToCamelCase = (targetArray: JsonValue[]): JsonValue[] => {\n\treturn targetArray.map((arrayItem) => {\n\t\tif (!Type.isPlainObject(arrayItem))\n\t\t{\n\t\t\treturn arrayItem;\n\t\t}\n\n\t\treturn convertObjectKeysToCamelCase(arrayItem);\n\t});\n};\n","import { NotificationSettingsBlock } from 'im.v2.const';\nimport type { RawNotificationSettingsBlock, NotificationSettingsItem } from 'im.v2.const';\n\ntype PreparedNotificationSettings = {\n\t[block: string]: NotificationSettingsBlock,\n};\n\nconst SortWeight = {\n\tim: 10,\n};\n\nexport const prepareNotificationSettings = (target: RawNotificationSettingsBlock[]): PreparedNotificationSettings => {\n\tconst result = {};\n\n\tconst sortedTarget = sortNotificationSettingsBlock(target);\n\tsortedTarget.forEach((block: RawNotificationSettingsBlock) => {\n\t\tconst preparedItems = {};\n\t\tblock.notices.forEach((item: NotificationSettingsItem) => {\n\t\t\tpreparedItems[item.id] = item;\n\t\t});\n\t\tresult[block.id] = {\n\t\t\tid: block.id,\n\t\t\tlabel: block.label,\n\t\t\titems: preparedItems,\n\t\t};\n\t});\n\n\treturn result;\n};\n\nconst sortNotificationSettingsBlock = (target: RawNotificationSettingsBlock[]): RawNotificationSettingsBlock[] => {\n\treturn [...target].sort((a, b) => {\n\t\tconst weightA = SortWeight[a.id] ?? 0;\n\t\tconst weightB = SortWeight[b.id] ?? 0;\n\n\t\treturn weightB - weightA;\n\t});\n};\n","import { Type } from 'main.core';\n\nimport { Settings } from 'im.v2.const';\n\nimport { convertToNumber, isNumberOrString } from '../../../utils/format';\nimport { prepareNotificationSettings } from './format-functions';\n\nimport type { FieldsConfig } from '../../../utils/validate';\n\nexport const settingsFieldsConfig: FieldsConfig = [\n\t{\n\t\tfieldName: Settings.notification.enableSound,\n\t\ttargetFieldName: Settings.notification.enableSound,\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: Settings.notification.enableAutoRead,\n\t\ttargetFieldName: Settings.notification.enableAutoRead,\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: Settings.notification.mode,\n\t\ttargetFieldName: Settings.notification.mode,\n\t\tcheckFunction: Type.isString,\n\t},\n\t{\n\t\tfieldName: Settings.notification.enableWeb,\n\t\ttargetFieldName: Settings.notification.enableWeb,\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: Settings.notification.enableMail,\n\t\ttargetFieldName: Settings.notification.enableMail,\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: Settings.notification.enablePush,\n\t\ttargetFieldName: Settings.notification.enablePush,\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: 'notifications',\n\t\ttargetFieldName: 'notifications',\n\t\tcheckFunction: Type.isArray,\n\t\tformatFunction: prepareNotificationSettings,\n\t},\n\t{\n\t\tfieldName: Settings.message.bigSmiles,\n\t\ttargetFieldName: Settings.message.bigSmiles,\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: Settings.appearance.background,\n\t\ttargetFieldName: Settings.appearance.background,\n\t\tcheckFunction: isNumberOrString,\n\t\tformatFunction: convertToNumber,\n\t},\n\t{\n\t\tfieldName: Settings.appearance.alignment,\n\t\ttargetFieldName: Settings.appearance.alignment,\n\t\tcheckFunction: Type.isString,\n\t},\n\t{\n\t\tfieldName: Settings.recent.showBirthday,\n\t\ttargetFieldName: Settings.recent.showBirthday,\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: Settings.recent.showInvited,\n\t\ttargetFieldName: Settings.recent.showInvited,\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: Settings.recent.showLastMessage,\n\t\ttargetFieldName: Settings.recent.showLastMessage,\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: Settings.hotkey.sendByEnter,\n\t\ttargetFieldName: Settings.hotkey.sendByEnter,\n\t\tcheckFunction: Type.isString,\n\t\tformatFunction: (target) => {\n\t\t\treturn target === '1';\n\t\t},\n\t},\n\t{\n\t\tfieldName: Settings.hotkey.sendByEnter,\n\t\ttargetFieldName: Settings.hotkey.sendByEnter,\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: Settings.desktop.enableRedirect,\n\t\ttargetFieldName: Settings.desktop.enableRedirect,\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: Settings.user.status,\n\t\ttargetFieldName: Settings.user.status,\n\t\tcheckFunction: Type.isString,\n\t},\n];\n","import { Type } from 'main.core';\n\nimport { convertObjectKeysToCamelCase } from './format';\n\nimport type { JsonObject, JsonValue } from 'main.core';\n\nexport type FieldsConfig = FieldsConfigItem[];\ntype FieldsConfigItem = {\n\tfieldName: string | Array<string>,\n\ttargetFieldName: string,\n\tcheckFunction?: CheckFunction | Array<CheckFunction>, // OR logic\n\tformatFunction?: FormatFunction,\n};\ntype CheckFunction = (target: JsonValue) => boolean;\ntype FormatFunction = (target: JsonValue, currentResult: JsonObject, rawFields: JsonObject) => JsonValue;\n\nexport const formatFieldsWithConfig = (fields: JsonObject, config: FieldsConfig): JsonObject => {\n\tconst resultObject = {};\n\tconst rawFields = convertObjectKeysToCamelCase(fields);\n\n\tconfig.forEach((fieldConfig: FieldsConfigItem) => {\n\t\tconst { fieldName, targetFieldName, checkFunction, formatFunction } = fieldConfig;\n\n\t\t// check if field exists\n\t\tconst foundFieldName = getValidFieldName(rawFields, fieldName);\n\t\tif (!foundFieldName)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\t// validate value\n\t\tif (!isFieldValueValid(rawFields[foundFieldName], checkFunction))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\t// format value\n\t\tresultObject[targetFieldName] = formatFieldValue({\n\t\t\tfieldValue: rawFields[foundFieldName],\n\t\t\tformatFunction,\n\t\t\tcurrentResult: resultObject,\n\t\t\trawFields: fields,\n\t\t});\n\t});\n\n\treturn resultObject;\n};\n\nconst getValidFieldName = (fields: JsonObject, fieldName: string | string[]): string | null => {\n\tlet fieldNameList = fieldName;\n\tif (Type.isStringFilled(fieldNameList))\n\t{\n\t\tfieldNameList = [fieldNameList];\n\t}\n\n\tfor (const singleField of fieldNameList)\n\t{\n\t\tif (!Type.isUndefined(fields[singleField]))\n\t\t{\n\t\t\treturn singleField;\n\t\t}\n\t}\n\n\treturn null;\n};\n\nconst isFieldValueValid = (field: JsonValue, checkFunction: CheckFunction | Array<CheckFunction>): boolean => {\n\tlet checkFunctionList = checkFunction;\n\tif (Type.isUndefined(checkFunctionList))\n\t{\n\t\treturn true;\n\t}\n\n\tif (Type.isFunction(checkFunctionList))\n\t{\n\t\tcheckFunctionList = [checkFunctionList];\n\t}\n\n\treturn checkFunctionList.some((singleFunction) => singleFunction(field));\n};\n\ntype FormatFieldValueParams = {\n\tfieldValue: JsonValue,\n\tformatFunction: FormatFunction,\n\tcurrentResult: JsonObject,\n\trawFields: JsonObject\n};\nconst formatFieldValue = (params: FormatFieldValueParams) => {\n\tconst { fieldValue, formatFunction, currentResult, rawFields } = params;\n\tif (Type.isUndefined(formatFunction))\n\t{\n\t\treturn fieldValue;\n\t}\n\n\treturn formatFunction(fieldValue, currentResult, rawFields);\n};\n","import { BuilderModel, GetterTree, ActionTree, MutationTree } from 'ui.vue3.vuex';\n\nimport { Settings, DialogAlignment, NotificationSettingsMode, NotificationSettingsType, NotificationSettingsBlock } from 'im.v2.const';\nimport { settingsFieldsConfig } from './format/field-config';\nimport { formatFieldsWithConfig } from '../../utils/validate';\n\nimport type { JsonObject } from 'main.core';\n\ntype SettingsState = {\n\t[settingName: string]: any,\n\tnotifications: {\n\t\t[moduleId: string]: NotificationSettingsBlock\n\t}\n};\ntype NotificationOptionPayload = {\n\tmoduleId: string,\n\toptionName: string,\n\ttype: $Values<typeof NotificationSettingsType>,\n\tvalue: boolean\n};\n\n/* eslint-disable no-param-reassign */\nexport class SettingsModel extends BuilderModel\n{\n\tgetState(): SettingsState\n\t{\n\t\treturn {\n\t\t\t[Settings.appearance.background]: 1,\n\t\t\t[Settings.appearance.alignment]: DialogAlignment.left,\n\n\t\t\t[Settings.notification.enableSound]: true,\n\t\t\t[Settings.notification.enableAutoRead]: true,\n\t\t\t[Settings.notification.mode]: NotificationSettingsMode.simple,\n\t\t\t[Settings.notification.enableWeb]: true,\n\t\t\t[Settings.notification.enableMail]: true,\n\t\t\t[Settings.notification.enablePush]: true,\n\t\t\tnotifications: {},\n\n\t\t\t[Settings.message.bigSmiles]: true,\n\n\t\t\t[Settings.recent.showBirthday]: true,\n\t\t\t[Settings.recent.showInvited]: true,\n\t\t\t[Settings.recent.showLastMessage]: true,\n\n\t\t\t[Settings.desktop.enableRedirect]: true,\n\t\t};\n\t}\n\n\tgetGetters(): GetterTree\n\t{\n\t\treturn {\n\t\t\t/** @function application/settings/get */\n\t\t\tget: (state: SettingsState) => (key: string): any => {\n\t\t\t\treturn state[key];\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions(): ActionTree\n\t{\n\t\treturn {\n\t\t\t/** @function application/settings/set */\n\t\t\tset: (store, payload: {[settingName: string]: any}) => {\n\t\t\t\tstore.commit('set', this.formatFields(payload));\n\t\t\t},\n\t\t\t/** @function application/settings/setNotificationOption */\n\t\t\tsetNotificationOption: (store, payload: NotificationOptionPayload) => {\n\t\t\t\tstore.commit('setNotificationOption', payload);\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMutations(): MutationTree\n\t{\n\t\treturn {\n\t\t\tset: (state: SettingsState, payload: {[settingName: string]: any}) => {\n\t\t\t\tObject.entries(payload).forEach(([key, value]) => {\n\t\t\t\t\tstate[key] = value;\n\t\t\t\t});\n\t\t\t},\n\t\t\tsetNotificationOption: (state: SettingsState, payload: NotificationOptionPayload) => {\n\t\t\t\tconst { moduleId, optionName, type, value } = payload;\n\t\t\t\tconst moduleOptions = state.notifications[moduleId];\n\t\t\t\tif (!moduleOptions?.items?.[optionName])\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tmoduleOptions.items[optionName][type] = value;\n\t\t\t},\n\t\t};\n\t}\n\n\tformatFields(fields: JsonObject): JsonObject\n\t{\n\t\treturn formatFieldsWithConfig(fields, settingsFieldsConfig);\n\t}\n}\n","import { Type } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { BuilderModel } from 'ui.vue3.vuex';\n\nimport { Layout, EventType } from 'im.v2.const';\n\nimport { SettingsModel } from './nested-modules/settings';\n\nimport type { ActionTree, GetterTree, MutationTree } from 'ui.vue3.vuex';\n\ntype ApplicationState = {\n\tlayout: {\n\t\tname: string,\n\t\tentityId: string,\n\t\tcontextId: number,\n\t}\n};\n\nexport class ApplicationModel extends BuilderModel\n{\n\tgetName(): string\n\t{\n\t\treturn 'application';\n\t}\n\n\tgetNestedModules(): { [moduleName: string]: BuilderModel }\n\t{\n\t\treturn {\n\t\t\tsettings: SettingsModel,\n\t\t};\n\t}\n\n\tgetState(): ApplicationState\n\t{\n\t\treturn {\n\t\t\tlayout:\n\t\t\t{\n\t\t\t\tname: Layout.chat.name,\n\t\t\t\tentityId: '',\n\t\t\t\tcontextId: 0,\n\t\t\t},\n\t\t};\n\t}\n\n\tgetGetters(): GetterTree\n\t{\n\t\treturn {\n\t\t\t/** @function application/getLayout */\n\t\t\tgetLayout: (state) => {\n\t\t\t\treturn state.layout;\n\t\t\t},\n\t\t\t/** @function application/isChatOpen */\n\t\t\tisChatOpen: (state) => (dialogId: string): boolean => {\n\t\t\t\tconst allowedLayouts = [Layout.chat.name, Layout.copilot.name];\n\t\t\t\tif (!allowedLayouts.includes(state.layout.name))\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn state.layout.entityId === dialogId.toString();\n\t\t\t},\n\t\t\tisLinesChatOpen: (state) => (dialogId: string): boolean => {\n\t\t\t\tif (state.layout.name !== Layout.openlines.name)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn state.layout.entityId === dialogId.toString();\n\t\t\t},\n\t\t\t/** @function application/areNotificationsOpen */\n\t\t\tareNotificationsOpen: (state) => {\n\t\t\t\treturn state.layout.name === Layout.notification.name;\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions(): ActionTree\n\t{\n\t\treturn {\n\t\t\t/** @function application/setLayout */\n\t\t\tsetLayout: (store, payload: {name: string, entityId?: string, contextId?: number}) => {\n\t\t\t\tconst { name, entityId = '', contextId = 0 } = payload;\n\t\t\t\tif (!Type.isStringFilled(name))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst previousLayout = { ...store.state.layout };\n\t\t\t\tconst newLayout = {\n\t\t\t\t\tname: this.validateLayout(name),\n\t\t\t\t\tentityId: this.validateLayoutEntityId(name, entityId),\n\t\t\t\t\tcontextId,\n\t\t\t\t};\n\t\t\t\tstore.commit('updateLayout', {\n\t\t\t\t\tlayout: newLayout,\n\t\t\t\t});\n\n\t\t\t\tEventEmitter.emit(EventType.layout.onLayoutChange, {\n\t\t\t\t\tfrom: previousLayout,\n\t\t\t\t\tto: newLayout,\n\t\t\t\t});\n\t\t\t},\n\t\t};\n\t}\n\n\t/* eslint-disable no-param-reassign */\n\tgetMutations(): MutationTree\n\t{\n\t\treturn {\n\t\t\tupdateLayout: (state, payload) => {\n\t\t\t\tstate.layout = { ...state.layout, ...payload.layout };\n\t\t\t},\n\t\t};\n\t}\n\n\tvalidateLayout(name: string): string\n\t{\n\t\tif (!Layout[name])\n\t\t{\n\t\t\treturn Layout.chat.name;\n\t\t}\n\n\t\treturn name;\n\t}\n\n\tvalidateLayoutEntityId(name: string, entityId: string): string\n\t{\n\t\tif (!Layout[name])\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\t// TODO check `entityId` by layout name\n\n\t\treturn entityId;\n\t}\n}\n","import { Type, type JsonObject } from 'main.core';\nimport { MessageComponent, type KeyboardButtonConfig } from 'im.v2.const';\n\nimport { convertToNumber } from '../../utils/format';\n\nexport const prepareComponentId = (componentId: string) => {\n\tconst supportedComponents = Object.values(MessageComponent);\n\tif (!supportedComponents.includes(componentId))\n\t{\n\t\treturn MessageComponent.unsupported;\n\t}\n\n\treturn componentId;\n};\n\nexport const prepareAuthorId = (target: number | string, currentResult: JsonObject, rawFields: JsonObject): number => {\n\tif (Type.isString(rawFields.system) && rawFields.system === 'Y')\n\t{\n\t\treturn 0;\n\t}\n\n\tif (Type.isBoolean(rawFields.isSystem) && rawFields.isSystem === true)\n\t{\n\t\treturn 0;\n\t}\n\n\treturn convertToNumber(target);\n};\n\nexport const prepareKeyboard = (rawKeyboardButtons: KeyboardButtonConfig[]): KeyboardButtonConfig[] => {\n\treturn rawKeyboardButtons.map((rawButton) => {\n\t\treturn {\n\t\t\t...rawButton,\n\t\t\tblock: rawButton.block === 'Y',\n\t\t\tdisabled: rawButton.disabled === 'Y',\n\t\t\tvote: rawButton.vote === 'Y',\n\t\t\twait: rawButton.wait === 'Y',\n\t\t};\n\t});\n};\n","import { Type } from 'main.core';\n\nimport { Utils } from 'im.v2.lib.utils';\n\nimport { convertToNumber, convertToString, isNumberOrString, convertObjectKeysToCamelCase } from '../../utils/format';\nimport { prepareComponentId, prepareAuthorId, prepareKeyboard } from './format-functions';\n\nimport type { FieldsConfig } from '../../utils/validate';\n\nexport const messageFieldsConfig: FieldsConfig = [\n\t{\n\t\tfieldName: 'temporaryId',\n\t\ttargetFieldName: 'id',\n\t\tcheckFunction: Utils.text.isUuidV4,\n\t},\n\t{\n\t\tfieldName: 'id',\n\t\ttargetFieldName: 'id',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: 'chatId',\n\t\ttargetFieldName: 'chatId',\n\t\tcheckFunction: isNumberOrString,\n\t\tformatFunction: convertToNumber,\n\t},\n\t{\n\t\tfieldName: 'date',\n\t\ttargetFieldName: 'date',\n\t\tcheckFunction: Type.isString,\n\t\tformatFunction: Utils.date.cast,\n\t},\n\t{\n\t\tfieldName: 'text',\n\t\ttargetFieldName: 'text',\n\t\tcheckFunction: isNumberOrString,\n\t\tformatFunction: convertToString,\n\t},\n\t{\n\t\tfieldName: ['senderId', 'authorId'],\n\t\ttargetFieldName: 'authorId',\n\t\tcheckFunction: isNumberOrString,\n\t\tformatFunction: prepareAuthorId,\n\t},\n\t{\n\t\tfieldName: 'sending',\n\t\ttargetFieldName: 'sending',\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: 'unread',\n\t\ttargetFieldName: 'unread',\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: 'viewed',\n\t\ttargetFieldName: 'viewed',\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: 'viewedByOthers',\n\t\ttargetFieldName: 'viewedByOthers',\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: 'error',\n\t\ttargetFieldName: 'error',\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: 'componentId',\n\t\ttargetFieldName: 'componentId',\n\t\tcheckFunction: (target): boolean => {\n\t\t\treturn Type.isString(target) && target !== '';\n\t\t},\n\t\tformatFunction: prepareComponentId,\n\t},\n\t{\n\t\tfieldName: 'componentParams',\n\t\ttargetFieldName: 'componentParams',\n\t\tcheckFunction: Type.isPlainObject,\n\t\tformatFunction: convertObjectKeysToCamelCase,\n\t},\n\t{\n\t\tfieldName: ['files', 'fileId'],\n\t\ttargetFieldName: 'files',\n\t\tcheckFunction: Type.isArray,\n\t},\n\t{\n\t\tfieldName: 'attach',\n\t\ttargetFieldName: 'attach',\n\t\tcheckFunction: [Type.isArray, Type.isBoolean, Type.isString],\n\t},\n\t{\n\t\tfieldName: 'keyboard',\n\t\ttargetFieldName: 'keyboard',\n\t\tcheckFunction: Type.isArray,\n\t\tformatFunction: prepareKeyboard,\n\t},\n\t{\n\t\tfieldName: 'keyboard',\n\t\ttargetFieldName: 'keyboard',\n\t\tcheckFunction: (target): boolean => target === 'N',\n\t\tformatFunction: (): [] => [],\n\t},\n\t{\n\t\tfieldName: 'isEdited',\n\t\ttargetFieldName: 'isEdited',\n\t\tcheckFunction: Type.isString,\n\t\tformatFunction: (target): boolean => target === 'Y',\n\t},\n\t{\n\t\tfieldName: 'isEdited',\n\t\ttargetFieldName: 'isEdited',\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: 'isDeleted',\n\t\ttargetFieldName: 'isDeleted',\n\t\tcheckFunction: Type.isString,\n\t\tformatFunction: (target): boolean => target === 'Y',\n\t},\n\t{\n\t\tfieldName: 'isDeleted',\n\t\ttargetFieldName: 'isDeleted',\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: 'replyId',\n\t\ttargetFieldName: 'replyId',\n\t\tcheckFunction: isNumberOrString,\n\t\tformatFunction: convertToNumber,\n\t},\n\t{\n\t\tfieldName: 'forward',\n\t\ttargetFieldName: 'forward',\n\t\tcheckFunction: Type.isPlainObject,\n\t\tformatFunction: convertObjectKeysToCamelCase,\n\t},\n];\n","import {BuilderModel} from 'ui.vue3.vuex';\n\nimport {Core} from 'im.v2.application.core';\nimport {Logger} from 'im.v2.lib.logger';\n\nimport type {ImModelMessage} from 'im.v2.model';\n\nexport class PinModel extends BuilderModel\n{\n\tgetState()\n\t{\n\t\treturn {\n\t\t\tcollection: {}\n\t\t};\n\t}\n\n\tgetGetters(): Object\n\t{\n\t\treturn {\n\t\t\tgetPinned: (state: PinState) => (chatId: number): ImModelMessage[] =>\n\t\t\t{\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\treturn [...state.collection[chatId]].map(pinnedMessageId => {\n\t\t\t\t\treturn Core.getStore().getters['messages/getById'](pinnedMessageId);\n\t\t\t\t});\n\t\t\t},\n\t\t\tisPinned: (state: PinState) => (payload: {chatId: number, messageId: number}): boolean =>\n\t\t\t{\n\t\t\t\tconst {chatId, messageId} = payload;\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[chatId].has(messageId);\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions(): Object\n\t{\n\t\treturn {\n\t\t\tsetPinned: (store, payload: {chatId: number, pinnedMessages: number[]}) =>\n\t\t\t{\n\t\t\t\tconst {chatId, pinnedMessages} = payload;\n\t\t\t\tif (pinnedMessages.length === 0)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setPinned', {\n\t\t\t\t\tchatId,\n\t\t\t\t\tpinnedMessageIds: pinnedMessages\n\t\t\t\t});\n\t\t\t},\n\t\t\tset: (store, payload: {chatId: number, messageId: number, action: boolean}) =>\n\t\t\t{\n\t\t\t\tstore.commit('set', payload);\n\t\t\t},\n\t\t\tadd: (store, payload: {chatId: number, messageId: number}) =>\n\t\t\t{\n\t\t\t\tstore.commit('add', payload);\n\t\t\t},\n\t\t\tdelete: (store, payload: {chatId: number, messageId: number}) =>\n\t\t\t{\n\t\t\t\tstore.commit('delete', payload);\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMutations(): Object\n\t{\n\t\treturn {\n\t\t\tsetPinned: (state: PinState, payload: {chatId: number, pinnedMessageIds: number[]}) =>\n\t\t\t{\n\t\t\t\tLogger.warn('Messages/pin model: setPinned mutation', payload);\n\t\t\t\tconst {chatId, pinnedMessageIds} = payload;\n\t\t\t\tstate.collection[chatId] = new Set(pinnedMessageIds.reverse());\n\t\t\t},\n\t\t\tadd: (state: PinState, payload: {chatId: number, messageId: number}) =>\n\t\t\t{\n\t\t\t\tLogger.warn('Messages/pin model: add pin mutation', payload);\n\t\t\t\tconst {chatId, messageId} = payload;\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\tstate.collection[chatId] = new Set();\n\t\t\t\t}\n\n\t\t\t\tstate.collection[chatId].add(messageId);\n\t\t\t},\n\t\t\tdelete: (state: PinState, payload: {chatId: number, messageId: number}) =>\n\t\t\t{\n\t\t\t\tLogger.warn('Messages/pin model: delete pin mutation', payload);\n\t\t\t\tconst {chatId, messageId} = payload;\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstate.collection[chatId].delete(messageId);\n\t\t\t}\n\t\t};\n\t}\n}\n\ntype PinState = {\n\tcollection: {\n\t\t[chatId: string]: Set\n\t}\n};","import {BuilderModel} from 'ui.vue3.vuex';\n\nimport {Core} from 'im.v2.application.core';\n\nimport type {Store, GetterTree, ActionTree, MutationTree} from 'ui.vue3.vuex';\nimport type {ImModelReactions} from 'im.v2.model';\n\nexport const Reaction = Object.freeze({\n\tlike: 'like',\n\tkiss: 'kiss',\n\tlaugh: 'laugh',\n\twonder: 'wonder',\n\tcry: 'cry',\n\tangry: 'angry',\n\tfacepalm: 'facepalm',\n});\n\ntype ReactionType = $Values<typeof Reaction>;\n\ntype RawReactions = {\n\tmessageId: number,\n\treactionCounters: {[reactionType: string]: number},\n\treactionUsers: {[reactionType: string]: number[]},\n\townReactions: ReactionType[]\n};\ntype RawReactionsList = RawReactions[];\n\ntype ReactionsState = {\n\tcollection: {\n\t\t[messageId: string]: ImModelReactions\n\t}\n};\n\nconst USERS_TO_SHOW = 5;\n\nexport class ReactionsModel extends BuilderModel\n{\n\tgetState(): ReactionsState\n\t{\n\t\treturn {\n\t\t\tcollection: {}\n\t\t};\n\t}\n\n\tgetElementState()\n\t{\n\t\treturn {\n\t\t\treactionCounters: {},\n\t\t\treactionUsers: {},\n\t\t\townReactions: new Set()\n\t\t};\n\t}\n\n\tgetGetters(): GetterTree\n\t{\n\t\treturn {\n\t\t\tgetByMessageId: (state: ReactionsState) => (messageId: number): ?ImModelReactions =>\n\t\t\t{\n\t\t\t\treturn state.collection[messageId];\n\t\t\t}\n\t\t};\n\t}\n\n\tgetActions(): ActionTree\n\t{\n\t\treturn {\n\t\t\tset: (store: Store, payload: RawReactionsList) =>\n\t\t\t{\n\t\t\t\tstore.commit('set', this.prepareSetPayload(payload));\n\t\t\t},\n\t\t\tsetReaction: (\n\t\t\t\tstore: Store,\n\t\t\t\tpayload: {messageId: number, userId: number, reaction: ReactionType}\n\t\t\t) =>\n\t\t\t{\n\t\t\t\tif (!Reaction[payload.reaction])\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (!store.state.collection[payload.messageId])\n\t\t\t\t{\n\t\t\t\t\tstore.state.collection[payload.messageId] = this.getElementState();\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setReaction', payload);\n\t\t\t},\n\t\t\tremoveReaction: (\n\t\t\t\tstore: Store,\n\t\t\t\tpayload: {messageId: number, userId: number, reaction: ReactionType}\n\t\t\t) =>\n\t\t\t{\n\t\t\t\tif (!store.state.collection[payload.messageId] || !Reaction[payload.reaction])\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tstore.commit('removeReaction', payload);\n\t\t\t}\n\t\t};\n\t}\n\n\tgetMutations(): MutationTree\n\t{\n\t\treturn {\n\t\t\tset: (state: ReactionsState, payload: RawReactionsList) =>\n\t\t\t{\n\t\t\t\tpayload.forEach(item => {\n\t\t\t\t\tconst newItem = {\n\t\t\t\t\t\treactionCounters: item.reactionCounters,\n\t\t\t\t\t\treactionUsers: item.reactionUsers\n\t\t\t\t\t};\n\n\t\t\t\t\tconst currentItem = state.collection[item.messageId];\n\t\t\t\t\tconst newOwnReaction = !!item.ownReactions;\n\t\t\t\t\tif (newOwnReaction)\n\t\t\t\t\t{\n\t\t\t\t\t\tnewItem.ownReactions = item.ownReactions;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tnewItem.ownReactions = currentItem ? currentItem.ownReactions : new Set();\n\t\t\t\t\t}\n\n\t\t\t\t\tstate.collection[item.messageId] = newItem;\n\t\t\t\t});\n\t\t\t},\n\t\t\tsetReaction: (\n\t\t\t\tstate: ReactionsState,\n\t\t\t\tpayload: {messageId: number, userId: number, reaction: ReactionType}\n\t\t\t) =>\n\t\t\t{\n\t\t\t\tconst {messageId, userId, reaction} = payload;\n\t\t\t\tconst reactions = state.collection[messageId];\n\t\t\t\tif (Core.getUserId() === userId)\n\t\t\t\t{\n\t\t\t\t\tthis.removeAllCurrentUserReactions(reactions);\n\t\t\t\t\treactions.ownReactions.add(reaction);\n\t\t\t\t}\n\n\t\t\t\tif (!reactions.reactionCounters[reaction])\n\t\t\t\t{\n\t\t\t\t\treactions.reactionCounters[reaction] = 0;\n\t\t\t\t}\n\t\t\t\tconst currentCounter = reactions.reactionCounters[reaction];\n\t\t\t\tif (currentCounter + 1 <= USERS_TO_SHOW)\n\t\t\t\t{\n\t\t\t\t\tif (!reactions.reactionUsers[reaction])\n\t\t\t\t\t{\n\t\t\t\t\t\treactions.reactionUsers[reaction] = new Set();\n\t\t\t\t\t}\n\t\t\t\t\treactions.reactionUsers[reaction].add(userId);\n\t\t\t\t}\n\n\t\t\t\treactions.reactionCounters[reaction]++;\n\t\t\t},\n\t\t\tremoveReaction: (\n\t\t\t\tstate: ReactionsState,\n\t\t\t\tpayload: {messageId: number, userId: number, reaction: ReactionType}\n\t\t\t) =>\n\t\t\t{\n\t\t\t\tconst {messageId, userId, reaction} = payload;\n\t\t\t\tconst reactions = state.collection[messageId];\n\n\t\t\t\tif (Core.getUserId() === userId)\n\t\t\t\t{\n\t\t\t\t\treactions.ownReactions.delete(reaction);\n\t\t\t\t}\n\n\t\t\t\treactions.reactionUsers[reaction]?.delete(userId);\n\t\t\t\treactions.reactionCounters[reaction]--;\n\t\t\t\tif (reactions.reactionCounters[reaction] === 0)\n\t\t\t\t{\n\t\t\t\t\tdelete reactions.reactionCounters[reaction];\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t}\n\n\tremoveAllCurrentUserReactions(reactions: ImModelReactions)\n\t{\n\t\treactions.ownReactions.forEach(reaction => {\n\t\t\treactions.reactionUsers[reaction]?.delete(Core.getUserId());\n\t\t\treactions.reactionCounters[reaction]--;\n\t\t\tif (reactions.reactionCounters[reaction] === 0)\n\t\t\t{\n\t\t\t\tdelete reactions.reactionCounters[reaction];\n\t\t\t}\n\t\t});\n\n\t\treactions.ownReactions = new Set();\n\t}\n\n\tprepareSetPayload(payload: RawReactionsList)\n\t{\n\t\treturn payload.map(item => {\n\t\t\tconst reactionUsers = {};\n\t\t\tObject.entries(item.reactionUsers).forEach(([reaction, users]) => {\n\t\t\t\treactionUsers[reaction] = new Set(users);\n\t\t\t});\n\n\t\t\tconst reactionCounters = {};\n\t\t\tObject.entries(item.reactionCounters).forEach(([reaction, counter]) => {\n\t\t\t\treactionCounters[reaction] = counter;\n\t\t\t});\n\n\t\t\tconst result = {\n\t\t\t\tmessageId: item.messageId,\n\t\t\t\treactionCounters: reactionCounters,\n\t\t\t\treactionUsers: reactionUsers\n\t\t\t};\n\n\t\t\tif (item.ownReactions?.length > 0)\n\t\t\t{\n\t\t\t\tresult.ownReactions = new Set(item.ownReactions);\n\t\t\t}\n\n\t\t\treturn result;\n\t\t});\n\t}\n}","import type { JsonObject } from 'main.core';\nimport { Type } from 'main.core';\nimport { BuilderModel } from 'ui.vue3.vuex';\n\nimport { Core } from 'im.v2.application.core';\nimport { Utils } from 'im.v2.lib.utils';\nimport { Logger } from 'im.v2.lib.logger';\nimport { MessageComponent, MessageType, UserIdNetworkPrefix } from 'im.v2.const';\nimport { UserManager } from 'im.v2.lib.user';\n\nimport { convertToNumber } from '../utils/format';\nimport { messageFieldsConfig } from './format/field-config';\nimport { formatFieldsWithConfig } from '../utils/validate';\nimport { PinModel } from './nested-modules/pin';\nimport { ReactionsModel } from './nested-modules/reactions';\n\nimport type { GetterTree, ActionTree, MutationTree } from 'ui.vue3.vuex';\nimport type { ImModelMessage, ImModelFile } from 'im.v2.model';\nimport type { RawMessage } from '../type/message';\nimport type { AttachConfig } from 'im.v2.const';\n\ntype MessagesState = {\n\tcollection: {\n\t\t[messageId: string]: ImModelMessage\n\t},\n\tchatCollection: {\n\t\t[chatId: string]: Set<string | number>\n\t}\n};\n\nexport class MessagesModel extends BuilderModel\n{\n\tgetName(): string\n\t{\n\t\treturn 'messages';\n\t}\n\n\tgetNestedModules(): { [moduleName: string]: BuilderModel }\n\t{\n\t\treturn {\n\t\t\tpin: PinModel,\n\t\t\treactions: ReactionsModel,\n\t\t};\n\t}\n\n\tgetState(): MessagesState\n\t{\n\t\treturn {\n\t\t\tcollection: {},\n\t\t\tchatCollection: {},\n\t\t};\n\t}\n\n\tgetElementState(): ImModelMessage\n\t{\n\t\treturn {\n\t\t\tid: 0,\n\t\t\tchatId: 0,\n\t\t\tauthorId: 0,\n\t\t\treplyId: 0,\n\t\t\tdate: new Date(),\n\t\t\ttext: '',\n\t\t\tfiles: [],\n\t\t\tattach: [],\n\t\t\tkeyboard: [],\n\t\t\tunread: false,\n\t\t\tviewed: true,\n\t\t\tviewedByOthers: false,\n\t\t\tsending: false,\n\t\t\terror: false,\n\t\t\tcomponentId: MessageComponent.default,\n\t\t\tcomponentParams: {},\n\t\t\tforward: {\n\t\t\t\tid: '',\n\t\t\t\tuserId: 0,\n\t\t\t},\n\t\t\tisEdited: false,\n\t\t\tisDeleted: false,\n\t\t};\n\t}\n\n\t// eslint-disable-next-line max-lines-per-function\n\tgetGetters(): GetterTree\n\t{\n\t\treturn {\n\t\t\t/** @function messages/get */\n\t\t\tget: (state: MessagesState) => (chatId: number) => {\n\t\t\t\tif (!state.chatCollection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\treturn [...state.chatCollection[chatId]].map((messageId: number | string) => {\n\t\t\t\t\treturn state.collection[messageId];\n\t\t\t\t}).sort(this.#sortCollection);\n\t\t\t},\n\t\t\t/** @function messages/getById */\n\t\t\tgetById: (state: MessagesState) => (id: number | string): ?ImModelMessage => {\n\t\t\t\treturn state.collection[id];\n\t\t\t},\n\t\t\t/** @function messages/getByIdList */\n\t\t\tgetByIdList: (state: MessagesState) => (idList: number[]): ImModelMessage[] => {\n\t\t\t\tconst result = [];\n\t\t\t\tidList.forEach((id) => {\n\t\t\t\t\tif (state.collection[id])\n\t\t\t\t\t{\n\t\t\t\t\t\tresult.push(state.collection[id]);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\treturn result;\n\t\t\t},\n\t\t\t/** @function messages/hasMessage */\n\t\t\thasMessage: (state: MessagesState) => ({ chatId, messageId }) => {\n\t\t\t\tif (!state.chatCollection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn state.chatCollection[chatId].has(messageId);\n\t\t\t},\n\t\t\t/** @function messages/isForward */\n\t\t\tisForward: (state: MessagesState) => (id: number | string) => {\n\t\t\t\tconst message = state.collection[id];\n\t\t\t\tif (!message)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn Type.isStringFilled(message.forward.id);\n\t\t\t},\n\t\t\t/** @function messages/isInChatCollection */\n\t\t\tisInChatCollection: (state: MessagesState) => (payload: {messageId: number}): boolean => {\n\t\t\t\tconst { messageId } = payload;\n\t\t\t\tconst message = state.collection[messageId];\n\t\t\t\tif (!message)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tconst { chatId } = message;\n\n\t\t\t\treturn state.chatCollection[chatId]?.has(messageId);\n\t\t\t},\n\t\t\t/** @function messages/getFirstId */\n\t\t\tgetFirstId: (state: MessagesState) => (chatId: number): number => {\n\t\t\t\tif (!state.chatCollection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn this.#findLowestMessageId(state, chatId);\n\t\t\t},\n\t\t\t/** @function messages/getLastId */\n\t\t\tgetLastId: (state: MessagesState) => (chatId: number): number => {\n\t\t\t\tif (!state.chatCollection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn this.#findMaxMessageId(state, chatId);\n\t\t\t},\n\t\t\t/** @function messages/getLastOwnMessageId */\n\t\t\tgetLastOwnMessageId: (state: MessagesState) => (chatId: number): number => {\n\t\t\t\tif (!state.chatCollection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn this.#findLastOwnMessageId(state, chatId);\n\t\t\t},\n\t\t\t/** @function messages/getFirstUnread */\n\t\t\tgetFirstUnread: (state: MessagesState) => (chatId: number): number => {\n\t\t\t\tif (!state.chatCollection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn this.#findFirstUnread(state, chatId);\n\t\t\t},\n\t\t\t/** @function messages/getChatUnreadMessages */\n\t\t\tgetChatUnreadMessages: (state: MessagesState) => (chatId: number): ImModelMessage[] => {\n\t\t\t\tif (!state.chatCollection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\tconst messages = [...state.chatCollection[chatId]].map((messageId: number | string) => {\n\t\t\t\t\treturn state.collection[messageId];\n\t\t\t\t});\n\n\t\t\t\treturn messages.filter((message: ImModelMessage) => {\n\t\t\t\t\treturn message.unread === true;\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function messages/getMessageFiles */\n\t\t\tgetMessageFiles: (state: MessagesState) => (payload: number): ImModelFile[] => {\n\t\t\t\tconst messageId = payload;\n\t\t\t\tif (!state.collection[messageId])\n\t\t\t\t{\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[messageId].files.map((fileId) => {\n\t\t\t\t\treturn this.store.getters['files/get'](fileId, true);\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function messages/getMessageType */\n\t\t\tgetMessageType: (state: MessagesState) => (messageId: number): ?$Values<typeof MessageType> => {\n\t\t\t\tconst message = state.collection[messageId];\n\t\t\t\tif (!message)\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\tconst currentUserId = Core.getUserId();\n\t\t\t\tif (message.authorId === 0)\n\t\t\t\t{\n\t\t\t\t\treturn MessageType.system;\n\t\t\t\t}\n\n\t\t\t\tif (message.authorId === currentUserId)\n\t\t\t\t{\n\t\t\t\t\treturn MessageType.self;\n\t\t\t\t}\n\n\t\t\t\treturn MessageType.opponent;\n\t\t\t},\n\t\t\t/** @function messages/getPreviousMessage */\n\t\t\tgetPreviousMessage: (state: MessagesState) => (payload: {messageId: number, chatId: number}): ?ImModelMessage => {\n\t\t\t\tconst { messageId, chatId } = payload;\n\t\t\t\tconst message = state.collection[messageId];\n\t\t\t\tif (!message)\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\tconst chatCollection = [...state.chatCollection[chatId]];\n\t\t\t\tconst initialMessageIndex = chatCollection.indexOf(messageId);\n\t\t\t\tconst desiredMessageId = chatCollection[initialMessageIndex - 1];\n\t\t\t\tif (!desiredMessageId)\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[desiredMessageId];\n\t\t\t},\n\t\t};\n\t}\n\n\t// eslint-disable-next-line max-lines-per-function\n\tgetActions(): ActionTree\n\t{\n\t\treturn {\n\t\t\t/** @function messages/setChatCollection */\n\t\t\tsetChatCollection: (store, payload: {messages: RawMessage | RawMessage[], clearCollection: boolean}) => {\n\t\t\t\tlet { messages, clearCollection } = payload;\n\t\t\t\tclearCollection = clearCollection ?? false;\n\t\t\t\tif (!Array.isArray(messages) && Type.isPlainObject(messages))\n\t\t\t\t{\n\t\t\t\t\tmessages = [messages];\n\t\t\t\t}\n\n\t\t\t\tmessages = messages.map((message: RawMessage) => {\n\t\t\t\t\treturn { ...this.getElementState(), ...this.#formatFields(message) };\n\t\t\t\t});\n\t\t\t\tconst chatId = messages[0]?.chatId;\n\t\t\t\tif (chatId && clearCollection)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('clearCollection', { chatId });\n\t\t\t\t}\n\n\t\t\t\tstore.commit('store', { messages });\n\t\t\t\tstore.commit('setChatCollection', { messages });\n\t\t\t},\n\t\t\t/** @function messages/store */\n\t\t\tstore: (store, payload: RawMessage | RawMessage[]) => {\n\t\t\t\tlet preparedMessages = payload;\n\t\t\t\tif (Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\tpreparedMessages = [payload];\n\t\t\t\t}\n\n\t\t\t\tpreparedMessages = preparedMessages.map((message: RawMessage) => {\n\t\t\t\t\treturn { ...this.getElementState(), ...this.#formatFields(message) };\n\t\t\t\t});\n\n\t\t\t\tif (preparedMessages.length === 0)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('store', {\n\t\t\t\t\tmessages: preparedMessages,\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function messages/add */\n\t\t\tadd: (store, payload: RawMessage) => {\n\t\t\t\tconst message = {\n\t\t\t\t\t...this.getElementState(),\n\t\t\t\t\t...this.#formatFields(payload),\n\t\t\t\t};\n\t\t\t\tstore.commit('store', {\n\t\t\t\t\tmessages: [message],\n\t\t\t\t});\n\t\t\t\tstore.commit('setChatCollection', {\n\t\t\t\t\tmessages: [message],\n\t\t\t\t});\n\n\t\t\t\treturn message.id;\n\t\t\t},\n\t\t\t/** @function messages/updateWithId */\n\t\t\tupdateWithId: (store, payload: {id: string | number, fields: Object}) => {\n\t\t\t\tconst { id, fields } = payload;\n\t\t\t\tif (!store.state.collection[id])\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('updateWithId', {\n\t\t\t\t\tid,\n\t\t\t\t\tfields: this.#formatFields(fields),\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function messages/update */\n\t\t\tupdate: (store, payload: {id: string | number, fields: Object}) => {\n\t\t\t\tconst { id, fields } = payload;\n\t\t\t\tconst currentMessage = store.state.collection[id];\n\t\t\t\tif (!currentMessage)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tid,\n\t\t\t\t\tfields: { ...currentMessage, ...this.#formatFields(fields) },\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function messages/readMessages */\n\t\t\treadMessages: (store, payload: {chatId: number, messageIds: number[]}): number => {\n\t\t\t\tconst { chatId, messageIds } = payload;\n\t\t\t\tif (!store.state.chatCollection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\tconst chatMessages = [...store.state.chatCollection[chatId]].map((messageId: number) => {\n\t\t\t\t\treturn store.state.collection[messageId];\n\t\t\t\t});\n\n\t\t\t\tlet messagesToReadCount = 0;\n\t\t\t\tconst maxMessageId = this.#getMaxMessageId(messageIds);\n\t\t\t\tconst messageIdsToView = messageIds;\n\t\t\t\tconst messageIdsToRead = [];\n\t\t\t\tchatMessages.forEach((chatMessage: ImModelMessage) => {\n\t\t\t\t\tif (!chatMessage.unread)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (chatMessage.id <= maxMessageId)\n\t\t\t\t\t{\n\t\t\t\t\t\tmessagesToReadCount++;\n\t\t\t\t\t\tmessageIdsToRead.push(chatMessage.id);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tstore.commit('readMessages', {\n\t\t\t\t\tmessageIdsToRead,\n\t\t\t\t\tmessageIdsToView,\n\t\t\t\t});\n\n\t\t\t\treturn messagesToReadCount;\n\t\t\t},\n\t\t\t/** @function messages/setViewedByOthers */\n\t\t\tsetViewedByOthers: (store, payload: {ids: number[]}): number => {\n\t\t\t\tconst { ids } = payload;\n\t\t\t\tstore.commit('setViewedByOthers', {\n\t\t\t\t\tids,\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function messages/delete */\n\t\t\tdelete: (store, payload: {id: string | number}) => {\n\t\t\t\tconst { id } = payload;\n\t\t\t\tif (!store.state.collection[id])\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('delete', { id });\n\t\t\t},\n\t\t\t/** @function messages/clearChatCollection */\n\t\t\tclearChatCollection: (store, payload: {chatId: number}) => {\n\t\t\t\tconst { chatId } = payload;\n\t\t\t\tstore.commit('clearCollection', { chatId });\n\t\t\t},\n\t\t\t/** @function messages/deleteAttach */\n\t\t\tdeleteAttach: (store, payload: {messageId: number, attachId: string }) => {\n\t\t\t\tconst { messageId, attachId } = payload;\n\t\t\t\tconst message: ImModelMessage = store.state.collection[messageId];\n\t\t\t\tif (!message || !Type.isArray(message.attach))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst attach = message.attach.filter((attachItem: AttachConfig) => {\n\t\t\t\t\treturn attachId !== attachItem.id;\n\t\t\t\t});\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tid: messageId,\n\t\t\t\t\tfields: { ...message, ...this.#formatFields({ attach }) },\n\t\t\t\t});\n\t\t\t},\n\t\t};\n\t}\n\n\t/* eslint-disable no-param-reassign */\n\tgetMutations(): MutationTree\n\t{\n\t\treturn {\n\t\t\tsetChatCollection: (state: MessagesState, payload: {messages: ImModelMessage[]}) => {\n\t\t\t\tLogger.warn('Messages model: setChatCollection mutation', payload);\n\t\t\t\tpayload.messages.forEach((message) => {\n\t\t\t\t\tif (!state.chatCollection[message.chatId])\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.chatCollection[message.chatId] = new Set();\n\t\t\t\t\t}\n\t\t\t\t\tstate.chatCollection[message.chatId].add(message.id);\n\t\t\t\t});\n\t\t\t},\n\t\t\tstore: (state: MessagesState, payload: {messages: ImModelMessage[]}) => {\n\t\t\t\tLogger.warn('Messages model: store mutation', payload);\n\t\t\t\tpayload.messages.forEach((message) => {\n\t\t\t\t\tstate.collection[message.id] = message;\n\t\t\t\t});\n\t\t\t},\n\t\t\tupdateWithId: (state: MessagesState, payload: {id: number | string, fields: Object}) => {\n\t\t\t\tLogger.warn('Messages model: updateWithId mutation', payload);\n\t\t\t\tconst { id, fields } = payload;\n\t\t\t\tconst currentMessage = { ...state.collection[id] };\n\n\t\t\t\tdelete state.collection[id];\n\t\t\t\tstate.collection[fields.id] = { ...currentMessage, ...fields, sending: false };\n\n\t\t\t\tif (state.chatCollection[currentMessage.chatId].has(id))\n\t\t\t\t{\n\t\t\t\t\tstate.chatCollection[currentMessage.chatId].delete(id);\n\t\t\t\t\tstate.chatCollection[currentMessage.chatId].add(fields.id);\n\t\t\t\t}\n\t\t\t},\n\t\t\tupdate: (state: MessagesState, payload: {id: number | string, fields: Object}) => {\n\t\t\t\tLogger.warn('Messages model: update mutation', payload);\n\t\t\t\tconst { id, fields } = payload;\n\t\t\t\tstate.collection[id] = { ...state.collection[id], ...fields };\n\t\t\t},\n\t\t\tdelete: (state: MessagesState, payload: {id: number | string}) => {\n\t\t\t\tLogger.warn('Messages model: delete mutation', payload);\n\t\t\t\tconst { id } = payload;\n\t\t\t\tconst { chatId } = state.collection[id];\n\t\t\t\tstate.chatCollection[chatId].delete(id);\n\t\t\t\tdelete state.collection[id];\n\t\t\t},\n\t\t\tclearCollection: (state: MessagesState, payload: {chatId: number}) => {\n\t\t\t\tLogger.warn('Messages model: clear collection mutation', payload.chatId);\n\t\t\t\tstate.chatCollection[payload.chatId] = new Set();\n\t\t\t},\n\t\t\treadMessages: (state: MessagesState, payload: {messageIdsToRead: number[], messageIdsToView: number[]}) => {\n\t\t\t\tconst { messageIdsToRead, messageIdsToView } = payload;\n\t\t\t\tmessageIdsToRead.forEach((messageId) => {\n\t\t\t\t\tconst message = state.collection[messageId];\n\t\t\t\t\tif (!message)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tmessage.unread = false;\n\t\t\t\t});\n\t\t\t\tmessageIdsToView.forEach((messageId) => {\n\t\t\t\t\tconst message = state.collection[messageId];\n\t\t\t\t\tif (!message)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tmessage.viewed = true;\n\t\t\t\t});\n\t\t\t},\n\t\t\tsetViewedByOthers: (state: MessagesState, payload: {ids: number[]}) => {\n\t\t\t\tconst { ids } = payload;\n\t\t\t\tids.forEach((id) => {\n\t\t\t\t\tconst message = state.collection[id];\n\t\t\t\t\tif (!message)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tconst isOwnMessage = message.authorId === Core.getUserId();\n\t\t\t\t\tif (!isOwnMessage || message.viewedByOthers)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tmessage.viewedByOthers = true;\n\t\t\t\t});\n\t\t\t},\n\t\t};\n\t}\n\n\t#formatFields(rawFields: JsonObject): JsonObject\n\t{\n\t\tconst messageParams = Type.isPlainObject(rawFields.params) ? rawFields.params : {};\n\t\tconst fields = { ...rawFields, ...messageParams };\n\n\t\tconst formattedFields: ImModelMessage = formatFieldsWithConfig(fields, messageFieldsConfig);\n\t\tif (this.#needToSwapAuthorId(formattedFields, messageParams))\n\t\t{\n\t\t\tformattedFields.authorId = this.#prepareSwapAuthorId(formattedFields, messageParams);\n\t\t}\n\n\t\treturn formattedFields;\n\t}\n\n\t#needToSwapAuthorId(formattedFields: ImModelMessage, messageParams: JsonObject): boolean\n\t{\n\t\tconst { NAME: name, USER_ID: userId } = messageParams;\n\n\t\treturn Boolean(name && userId && formattedFields.authorId);\n\t}\n\n\t#prepareSwapAuthorId(formattedFields: ImModelMessage, messageParams: JsonObject): string\n\t{\n\t\tconst { NAME: authorName, USER_ID: userId, AVATAR: avatar } = messageParams;\n\t\tconst originalAuthorId = formattedFields.authorId;\n\t\tconst fakeAuthorId = convertToNumber(userId);\n\t\tconst userManager = new UserManager();\n\t\tconst networkId = `${UserIdNetworkPrefix}-${originalAuthorId}-${fakeAuthorId}`;\n\t\tuserManager.setUsersToModel({\n\t\t\tnetworkId,\n\t\t\tname: authorName,\n\t\t\tavatar: avatar ?? '',\n\t\t});\n\n\t\treturn networkId;\n\t}\n\n\t#getMaxMessageId(messageIds: number[]): number\n\t{\n\t\tlet maxMessageId = 0;\n\t\tmessageIds.forEach((messageId) => {\n\t\t\tif (maxMessageId < messageId)\n\t\t\t{\n\t\t\t\tmaxMessageId = messageId;\n\t\t\t}\n\t\t});\n\n\t\treturn maxMessageId;\n\t}\n\n\t#findLowestMessageId(state: MessagesState, chatId: number): number\n\t{\n\t\tlet firstId = null;\n\t\tconst messages = [...state.chatCollection[chatId]];\n\t\tfor (const messageId of messages)\n\t\t{\n\t\t\tconst element = state.collection[messageId];\n\t\t\tif (!firstId)\n\t\t\t{\n\t\t\t\tfirstId = element.id;\n\t\t\t}\n\n\t\t\tif (Utils.text.isTempMessage(element.id))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (element.id < firstId)\n\t\t\t{\n\t\t\t\tfirstId = element.id;\n\t\t\t}\n\t\t}\n\n\t\treturn firstId;\n\t}\n\n\t#findMaxMessageId(state: MessagesState, chatId: number): number\n\t{\n\t\tlet lastId = 0;\n\t\tconst messages = [...state.chatCollection[chatId]];\n\t\tfor (const messageId of messages)\n\t\t{\n\t\t\tconst element = state.collection[messageId];\n\t\t\tif (Utils.text.isTempMessage(element.id))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (element.id > lastId)\n\t\t\t{\n\t\t\t\tlastId = element.id;\n\t\t\t}\n\t\t}\n\n\t\treturn lastId;\n\t}\n\n\t#findLastOwnMessageId(state: MessagesState, chatId: number): number\n\t{\n\t\tlet lastOwnMessageId = 0;\n\t\tconst messages = [...state.chatCollection[chatId]].sort((a, z) => z - a);\n\t\tfor (const messageId of messages)\n\t\t{\n\t\t\tconst element = state.collection[messageId];\n\t\t\tif (Utils.text.isTempMessage(element.id))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (element.authorId === Core.getUserId())\n\t\t\t{\n\t\t\t\tlastOwnMessageId = element.id;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\treturn lastOwnMessageId;\n\t}\n\n\t#findFirstUnread(state: MessagesState, chatId: number): number\n\t{\n\t\tlet resultId = 0;\n\t\tfor (const messageId of state.chatCollection[chatId])\n\t\t{\n\t\t\tconst message: ImModelMessage = state.collection[messageId];\n\t\t\tif (message.unread)\n\t\t\t{\n\t\t\t\tresultId = messageId;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\treturn resultId;\n\t}\n\n\t#sortCollection(a: ImModelMessage, b: ImModelMessage): number\n\t{\n\t\tif (Utils.text.isUuidV4(a.id) && !Utils.text.isUuidV4(b.id))\n\t\t{\n\t\t\treturn 1;\n\t\t}\n\n\t\tif (!Utils.text.isUuidV4(a.id) && Utils.text.isUuidV4(b.id))\n\t\t{\n\t\t\treturn -1;\n\t\t}\n\n\t\tif (Utils.text.isUuidV4(a.id) && Utils.text.isUuidV4(b.id))\n\t\t{\n\t\t\treturn a.date.getTime() - b.date.getTime();\n\t\t}\n\n\t\treturn a.id - b.id;\n\t}\n}\n","import { Core } from 'im.v2.application.core';\nimport { Utils } from 'im.v2.lib.utils';\nimport { Text, Type, type JsonObject } from 'main.core';\n\nexport const prepareManagerList = (managerList: number[] | string[]): number[] => {\n\tconst result = [];\n\n\tmanagerList.forEach((rawUserId) => {\n\t\tconst userId = Number.parseInt(rawUserId, 10);\n\t\tif (userId > 0)\n\t\t{\n\t\t\tresult.push(userId);\n\t\t}\n\t});\n\n\treturn result;\n};\n\nexport const prepareChatName = (chatName: string | number): string => {\n\treturn Text.decode(chatName.toString());\n};\n\nexport const prepareAvatar = (avatar: string): string => {\n\tlet result = '';\n\n\tif (!avatar || avatar.endsWith('/js/im/images/blank.gif'))\n\t{\n\t\tresult = '';\n\t}\n\telse if (avatar.startsWith('http'))\n\t{\n\t\tresult = avatar;\n\t}\n\telse\n\t{\n\t\tresult = Core.getHost() + avatar;\n\t}\n\n\tif (result)\n\t{\n\t\tresult = encodeURI(result);\n\t}\n\n\treturn result;\n};\n\nexport const prepareWritingList = (writingList: Object[]): Array<{userId: number, userName: string}> => {\n\tconst result = [];\n\n\twritingList.forEach((element) => {\n\t\tconst item = {};\n\n\t\tif (!element.userId)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\titem.userId = Number.parseInt(element.userId, 10);\n\t\titem.userName = Text.decode(element.userName);\n\n\t\tresult.push(item);\n\t});\n\n\treturn result;\n};\n\nexport const prepareMuteList = (muteList: Object[] | Object): Object[] => {\n\tconst result = [];\n\n\tif (Type.isArray(muteList))\n\t{\n\t\tmuteList.forEach((rawUserId) => {\n\t\t\tconst userId = Number.parseInt(rawUserId, 10);\n\t\t\tif (userId > 0)\n\t\t\t{\n\t\t\t\tresult.push(userId);\n\t\t\t}\n\t\t});\n\t}\n\telse if (Type.isPlainObject(muteList))\n\t{\n\t\tObject.entries(muteList).forEach(([key, value]) => {\n\t\t\tif (!value)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst userId = Number.parseInt(key, 10);\n\t\t\tif (userId > 0)\n\t\t\t{\n\t\t\t\tresult.push(userId);\n\t\t\t}\n\t\t});\n\t}\n\n\treturn result;\n};\n\ntype LastMessageViews = { countOfViewers: number, firstViewers: Object[], messageId: number };\nexport const prepareLastMessageViews = (rawLastMessageViews: JsonObject): LastMessageViews => {\n\tconst {\n\t\tcountOfViewers,\n\t\tfirstViewers: rawFirstViewers,\n\t\tmessageId,\n\t} = rawLastMessageViews;\n\n\tlet firstViewer = null;\n\tfor (const rawFirstViewer of rawFirstViewers)\n\t{\n\t\tif (rawFirstViewer.userId === Core.getUserId())\n\t\t{\n\t\t\tcontinue;\n\t\t}\n\n\t\tfirstViewer = {\n\t\t\tuserId: rawFirstViewer.userId,\n\t\t\tuserName: rawFirstViewer.userName,\n\t\t\tdate: Utils.date.cast(rawFirstViewer.date),\n\t\t};\n\t\tbreak;\n\t}\n\n\tif (countOfViewers > 0 && !firstViewer)\n\t{\n\t\tthrow new Error('Chats model: no first viewer for message');\n\t}\n\n\treturn {\n\t\tcountOfViewers,\n\t\tfirstViewer,\n\t\tmessageId,\n\t};\n};\n","import { Utils } from 'im.v2.lib.utils';\nimport { Type } from 'main.core';\nimport { convertToNumber, convertToString, isNumberOrString } from '../../utils/format';\nimport { formatFieldsWithConfig } from '../../utils/validate';\nimport { prepareAvatar, prepareChatName, prepareLastMessageViews, prepareWritingList, prepareManagerList, prepareMuteList } from './format-functions';\n\nimport type { FieldsConfig } from '../../utils/validate';\n\nexport const chatFieldsConfig: FieldsConfig = [\n\t{\n\t\tfieldName: 'dialogId',\n\t\ttargetFieldName: 'dialogId',\n\t\tcheckFunction: isNumberOrString,\n\t\tformatFunction: convertToString,\n\t},\n\t{\n\t\tfieldName: ['id', 'chatId'],\n\t\ttargetFieldName: 'chatId',\n\t\tcheckFunction: isNumberOrString,\n\t\tformatFunction: convertToNumber,\n\t},\n\t{\n\t\tfieldName: 'type',\n\t\ttargetFieldName: 'type',\n\t\tcheckFunction: Type.isString,\n\t},\n\t{\n\t\tfieldName: 'quoteId',\n\t\ttargetFieldName: 'quoteId',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: 'counter',\n\t\ttargetFieldName: 'counter',\n\t\tcheckFunction: isNumberOrString,\n\t\tformatFunction: convertToNumber,\n\t},\n\t{\n\t\tfieldName: 'userCounter',\n\t\ttargetFieldName: 'userCounter',\n\t\tcheckFunction: isNumberOrString,\n\t\tformatFunction: convertToNumber,\n\t},\n\t{\n\t\tfieldName: 'lastId',\n\t\ttargetFieldName: 'lastReadId',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: 'markedId',\n\t\ttargetFieldName: 'markedId',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: 'lastMessageId',\n\t\ttargetFieldName: 'lastMessageId',\n\t\tcheckFunction: isNumberOrString,\n\t\tformatFunction: convertToNumber,\n\t},\n\t{\n\t\tfieldName: 'lastMessageViews',\n\t\ttargetFieldName: 'lastMessageViews',\n\t\tcheckFunction: Type.isPlainObject,\n\t\tformatFunction: prepareLastMessageViews,\n\t},\n\t{\n\t\tfieldName: 'hasPrevPage',\n\t\ttargetFieldName: 'hasPrevPage',\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: 'hasNextPage',\n\t\ttargetFieldName: 'hasNextPage',\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: 'savedPositionMessageId',\n\t\ttargetFieldName: 'savedPositionMessageId',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: ['title', 'name'],\n\t\ttargetFieldName: 'name',\n\t\tcheckFunction: isNumberOrString,\n\t\tformatFunction: prepareChatName,\n\t},\n\t{\n\t\tfieldName: ['owner', 'ownerId'],\n\t\ttargetFieldName: 'ownerId',\n\t\tcheckFunction: isNumberOrString,\n\t\tformatFunction: convertToNumber,\n\t},\n\t{\n\t\tfieldName: 'avatar',\n\t\ttargetFieldName: 'avatar',\n\t\tcheckFunction: Type.isString,\n\t\tformatFunction: prepareAvatar,\n\t},\n\t{\n\t\tfieldName: 'color',\n\t\ttargetFieldName: 'color',\n\t\tcheckFunction: Type.isString,\n\t},\n\t{\n\t\tfieldName: 'extranet',\n\t\ttargetFieldName: 'extranet',\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: 'entityLink',\n\t\ttargetFieldName: 'entityLink',\n\t\tcheckFunction: Type.isPlainObject,\n\t\tformatFunction: (target) => {\n\t\t\treturn formatFieldsWithConfig(target, chatEntityFieldsConfig);\n\t\t},\n\t},\n\t{\n\t\tfieldName: 'dateCreate',\n\t\ttargetFieldName: 'dateCreate',\n\t\tformatFunction: Utils.date.cast,\n\t},\n\t{\n\t\tfieldName: 'public',\n\t\ttargetFieldName: 'public',\n\t\tcheckFunction: Type.isPlainObject,\n\t},\n\t{\n\t\tfieldName: 'writingList',\n\t\ttargetFieldName: 'writingList',\n\t\tcheckFunction: Type.isArray,\n\t\tformatFunction: prepareWritingList,\n\t},\n\t{\n\t\tfieldName: 'managerList',\n\t\ttargetFieldName: 'managerList',\n\t\tcheckFunction: Type.isArray,\n\t\tformatFunction: prepareManagerList,\n\t},\n\t{\n\t\tfieldName: 'muteList',\n\t\ttargetFieldName: 'muteList',\n\t\tcheckFunction: [Type.isArray, Type.isPlainObject],\n\t\tformatFunction: prepareMuteList,\n\t},\n\t{\n\t\tfieldName: 'inited',\n\t\ttargetFieldName: 'inited',\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: 'loading',\n\t\ttargetFieldName: 'loading',\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: 'description',\n\t\ttargetFieldName: 'description',\n\t\tcheckFunction: Type.isString,\n\t},\n\t{\n\t\tfieldName: 'diskFolderId',\n\t\ttargetFieldName: 'diskFolderId',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: 'role',\n\t\ttargetFieldName: 'role',\n\t\tcheckFunction: Type.isString,\n\t\tformatFunction: (target: string) => target.toLowerCase(),\n\t},\n\t{\n\t\tfieldName: 'permissions',\n\t\ttargetFieldName: 'permissions',\n\t\tcheckFunction: Type.isPlainObject,\n\t},\n];\n\nexport const chatEntityFieldsConfig = [\n\t{\n\t\tfieldName: 'id',\n\t\ttargetFieldName: 'id',\n\t\tcheckFunction: isNumberOrString,\n\t\tformatFunction: convertToString,\n\t},\n\t{\n\t\tfieldName: 'type',\n\t\ttargetFieldName: 'type',\n\t\tcheckFunction: Type.isString,\n\t},\n\t{\n\t\tfieldName: 'url',\n\t\ttargetFieldName: 'url',\n\t\tcheckFunction: Type.isString,\n\t},\n];\n","import { Type, type JsonObject } from 'main.core';\nimport { BuilderModel } from 'ui.vue3.vuex';\n\nimport { Core } from 'im.v2.application.core';\nimport { Color, ChatType, UserRole } from 'im.v2.const';\nimport { Utils } from 'im.v2.lib.utils';\n\nimport { formatFieldsWithConfig } from '../utils/validate';\nimport { chatFieldsConfig } from './format/field-config';\n\nimport type { GetterTree, ActionTree, MutationTree } from 'ui.vue3.vuex';\nimport type { Chat as ImModelChat } from '../type/chat';\n\ntype ChatState = {\n\tcollection: {[dialogId: string]: ImModelChat},\n};\n\n/* eslint-disable no-param-reassign */\nexport class ChatsModel extends BuilderModel\n{\n\tgetName(): string\n\t{\n\t\treturn 'chats';\n\t}\n\n\tgetState(): ChatState\n\t{\n\t\treturn {\n\t\t\tcollection: {},\n\t\t};\n\t}\n\n\tgetElementState(): ImModelChat\n\t{\n\t\treturn {\n\t\t\tdialogId: '0',\n\t\t\tchatId: 0,\n\t\t\ttype: ChatType.chat,\n\t\t\tname: '',\n\t\t\tdescription: '',\n\t\t\tavatar: '',\n\t\t\tcolor: Color.base,\n\t\t\textranet: false,\n\t\t\tcounter: 0,\n\t\t\tuserCounter: 0,\n\t\t\tlastReadId: 0,\n\t\t\tmarkedId: 0,\n\t\t\tlastMessageId: 0,\n\t\t\tlastMessageViews: {\n\t\t\t\tcountOfViewers: 0,\n\t\t\t\tfirstViewer: null,\n\t\t\t\tmessageId: 0,\n\t\t\t},\n\t\t\tsavedPositionMessageId: 0,\n\t\t\tmanagerList: [],\n\t\t\twritingList: [],\n\t\t\tmuteList: [],\n\t\t\tquoteId: 0,\n\t\t\towner: 0,\n\t\t\tentityLink: {},\n\t\t\tdateCreate: null,\n\t\t\tpublic: {\n\t\t\t\tcode: '',\n\t\t\t\tlink: '',\n\t\t\t},\n\t\t\tinited: false,\n\t\t\tloading: false,\n\t\t\thasPrevPage: false,\n\t\t\thasNextPage: false,\n\t\t\tdiskFolderId: 0,\n\t\t\trole: UserRole.guest,\n\t\t\tpermissions: {\n\t\t\t\tmanageUi: UserRole.none,\n\t\t\t\tmanageSettings: UserRole.none,\n\t\t\t\tmanageUsersAdd: UserRole.none,\n\t\t\t\tmanageUsersDelete: UserRole.none,\n\t\t\t\tcanPost: UserRole.none,\n\t\t\t},\n\t\t};\n\t}\n\n\t// eslint-disable-next-line max-lines-per-function\n\tgetGetters(): GetterTree\n\t{\n\t\treturn {\n\t\t\t/** @function chats/get */\n\t\t\tget: (state: ChatState) => (dialogId: string, getBlank: boolean = false) => {\n\t\t\t\tif (!state.collection[dialogId] && getBlank)\n\t\t\t\t{\n\t\t\t\t\treturn this.getElementState();\n\t\t\t\t}\n\n\t\t\t\tif (!state.collection[dialogId] && !getBlank)\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[dialogId];\n\t\t\t},\n\t\t\t/** @function chats/getByChatId */\n\t\t\tgetByChatId: (state: ChatState) => (chatId: number | string) => {\n\t\t\t\tconst preparedChatId = Number.parseInt(chatId, 10);\n\n\t\t\t\treturn Object.values(state.collection).find((item) => {\n\t\t\t\t\treturn item.chatId === preparedChatId;\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function chats/getQuoteId */\n\t\t\tgetQuoteId: (state: ChatState) => (dialogId: string) => {\n\t\t\t\tif (!state.collection[dialogId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[dialogId].quoteId;\n\t\t\t},\n\t\t\t/** @function chats/isUser */\n\t\t\tisUser: (state: ChatState) => (dialogId: string) => {\n\t\t\t\tif (!state.collection[dialogId])\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[dialogId].type === ChatType.user;\n\t\t\t},\n\t\t\t/** @function chats/getLastReadId */\n\t\t\tgetLastReadId: (state: ChatState) => (dialogId: string): number => {\n\t\t\t\tif (!state.collection[dialogId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\tconst { lastReadId, lastMessageId } = state.collection[dialogId];\n\n\t\t\t\treturn lastReadId === lastMessageId ? 0 : lastReadId;\n\t\t\t},\n\t\t\t/** @function chats/getInitialMessageId */\n\t\t\tgetInitialMessageId: (state: ChatState) => (dialogId: string): number => {\n\t\t\t\tif (!state.collection[dialogId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\tconst { lastReadId, markedId } = state.collection[dialogId];\n\t\t\t\tif (markedId === 0)\n\t\t\t\t{\n\t\t\t\t\treturn lastReadId;\n\t\t\t\t}\n\n\t\t\t\treturn Math.min(lastReadId, markedId);\n\t\t\t},\n\t\t};\n\t}\n\n\t// eslint-disable-next-line max-lines-per-function\n\tgetActions(): ActionTree\n\t{\n\t\treturn {\n\t\t\t/** @function chats/set */\n\t\t\tset: (store, rawPayload: Array | Object) => {\n\t\t\t\tlet payload = rawPayload;\n\t\t\t\tif (!Array.isArray(payload) && Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\tpayload = [payload];\n\t\t\t\t}\n\n\t\t\t\tpayload.map((element) => {\n\t\t\t\t\treturn this.formatFields(element);\n\t\t\t\t}).forEach((element) => {\n\t\t\t\t\tconst existingItem = store.state.collection[element.dialogId];\n\t\t\t\t\tif (existingItem)\n\t\t\t\t\t{\n\t\t\t\t\t\tstore.commit('update', {\n\t\t\t\t\t\t\tdialogId: element.dialogId,\n\t\t\t\t\t\t\tfields: element,\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tstore.commit('add', {\n\t\t\t\t\t\t\tdialogId: element.dialogId,\n\t\t\t\t\t\t\tfields: { ...this.getElementState(), ...element },\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function chats/add */\n\t\t\tadd: (store, rawPayload: Array | Object) => {\n\t\t\t\tlet payload = rawPayload;\n\t\t\t\tif (!Array.isArray(payload) && Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\tpayload = [payload];\n\t\t\t\t}\n\n\t\t\t\tpayload.map((element) => {\n\t\t\t\t\treturn this.formatFields(element);\n\t\t\t\t}).forEach((element) => {\n\t\t\t\t\tconst existingItem = store.state.collection[element.dialogId];\n\t\t\t\t\tif (!existingItem)\n\t\t\t\t\t{\n\t\t\t\t\t\tstore.commit('add', {\n\t\t\t\t\t\t\tdialogId: element.dialogId,\n\t\t\t\t\t\t\tfields: { ...this.getElementState(), ...element },\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function chats/update */\n\t\t\tupdate: (store, payload: {dialogId: string, fields: Object}) => {\n\t\t\t\tconst existingItem = store.state.collection[payload.dialogId];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tdialogId: payload.dialogId,\n\t\t\t\t\tfields: this.formatFields(payload.fields),\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function chats/delete */\n\t\t\tdelete: (store, payload: {dialogId: string}) => {\n\t\t\t\tconst existingItem = store.state.collection[payload.dialogId];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('delete', { dialogId: payload.dialogId });\n\t\t\t},\n\t\t\t/** @function chats/clearCounters */\n\t\t\tclearCounters: (store) => {\n\t\t\t\tstore.commit('clearCounters');\n\t\t\t},\n\t\t\t/** @function chats/mute */\n\t\t\tmute: (store, payload: {dialogId: string}) => {\n\t\t\t\tconst existingItem = store.state.collection[payload.dialogId];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst currentUserId = Core.getUserId();\n\t\t\t\tif (existingItem.muteList.includes(currentUserId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tconst muteList = [...existingItem.muteList, currentUserId];\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tactionName: 'mute',\n\t\t\t\t\tdialogId: payload.dialogId,\n\t\t\t\t\tfields: this.formatFields({ muteList }),\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function chats/unmute */\n\t\t\tunmute: (store, payload: {dialogId: string}) => {\n\t\t\t\tconst existingItem = store.state.collection[payload.dialogId];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst currentUserId = Core.getUserId();\n\t\t\t\tconst muteList = existingItem.muteList.filter((item) => item !== currentUserId);\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tactionName: 'unmute',\n\t\t\t\t\tdialogId: payload.dialogId,\n\t\t\t\t\tfields: this.formatFields({ muteList }),\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function chats/setLastMessageViews */\n\t\t\tsetLastMessageViews: (store, payload: {\n\t\t\t\tdialogId: string,\n\t\t\t\tfields: {userId: number, userName: string, date: string, messageId: number}\n\t\t\t}) => {\n\t\t\t\tconst { dialogId, fields: { userId, userName, date, messageId } } = payload;\n\t\t\t\tconst existingItem: ImModelChat = store.state.collection[dialogId];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst newLastMessageViews = {\n\t\t\t\t\tcountOfViewers: 1,\n\t\t\t\t\tmessageId,\n\t\t\t\t\tfirstViewer: {\n\t\t\t\t\t\tuserId,\n\t\t\t\t\t\tuserName,\n\t\t\t\t\t\tdate: Utils.date.cast(date),\n\t\t\t\t\t},\n\t\t\t\t};\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tactionName: 'setLastMessageViews',\n\t\t\t\t\tdialogId,\n\t\t\t\t\tfields: {\n\t\t\t\t\t\tlastMessageViews: newLastMessageViews,\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function chats/clearLastMessageViews */\n\t\t\tclearLastMessageViews: (store, payload: {dialogId: string}) => {\n\t\t\t\tconst existingItem = store.state.collection[payload.dialogId];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst { lastMessageViews: defaultLastMessageViews } = this.getElementState();\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tactionName: 'clearLastMessageViews',\n\t\t\t\t\tdialogId: payload.dialogId,\n\t\t\t\t\tfields: {\n\t\t\t\t\t\tlastMessageViews: defaultLastMessageViews,\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function chats/incrementLastMessageViews */\n\t\t\tincrementLastMessageViews: (store, payload: {dialogId: string}) => {\n\t\t\t\tconst existingItem: ImModelChat = store.state.collection[payload.dialogId];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst newCounter = existingItem.lastMessageViews.countOfViewers + 1;\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tactionName: 'incrementLastMessageViews',\n\t\t\t\t\tdialogId: payload.dialogId,\n\t\t\t\t\tfields: {\n\t\t\t\t\t\tlastMessageViews: { ...existingItem.lastMessageViews, countOfViewers: newCounter },\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMutations(): MutationTree\n\t{\n\t\treturn {\n\t\t\tadd: (state: ChatState, payload) => {\n\t\t\t\tstate.collection[payload.dialogId] = payload.fields;\n\t\t\t},\n\t\t\tupdate: (state: ChatState, payload) => {\n\t\t\t\tstate.collection[payload.dialogId] = { ...state.collection[payload.dialogId], ...payload.fields };\n\t\t\t},\n\t\t\tdelete: (state: ChatState, payload) => {\n\t\t\t\tdelete state.collection[payload.dialogId];\n\t\t\t},\n\t\t\tclearCounters: (state: ChatState) => {\n\t\t\t\tObject.keys(state.collection).forEach((key) => {\n\t\t\t\t\tstate.collection[key].counter = 0;\n\t\t\t\t\tstate.collection[key].markedId = 0;\n\t\t\t\t});\n\t\t\t},\n\t\t};\n\t}\n\n\tformatFields(fields: JsonObject): JsonObject\n\t{\n\t\treturn formatFieldsWithConfig(fields, chatFieldsConfig);\n\t}\n}\n","import { BotType, RawBotType } from 'im.v2.const';\nimport { BuilderModel, type GetterTree, type ActionTree, type MutationTree } from 'ui.vue3.vuex';\n\nimport { convertObjectKeysToCamelCase } from '../../utils/format';\n\nimport type { JsonObject } from 'main.core';\nimport type { ImModelBot } from 'im.v2.model';\n\ntype BotsState = {\n\tcollection: {[dialogId: string]: ImModelBot},\n};\n\ntype BotPayload = {\n\tuserId: string | number,\n\tbotData: ImModelBot,\n};\n\nexport class BotsModel extends BuilderModel\n{\n\tgetState(): BotsState\n\t{\n\t\treturn {\n\t\t\tcollection: {},\n\t\t};\n\t}\n\n\tgetElementState(): ImModelBot\n\t{\n\t\treturn {\n\t\t\tcode: '',\n\t\t\ttype: BotType.bot,\n\t\t\tappId: '',\n\t\t\tisHidden: false,\n\t\t\tisSupportOpenline: false,\n\t\t\tisHuman: false,\n\t\t};\n\t}\n\n\tgetGetters(): GetterTree\n\t{\n\t\treturn {\n\t\t\t/** @function users/bots/getByUserId */\n\t\t\tgetByUserId: (state: BotsState) => (userId: string | number): ?ImModelBot => {\n\t\t\t\treturn state.collection[userId];\n\t\t\t},\n\t\t\t/** @function users/bots/isNetwork */\n\t\t\tisNetwork: (state: BotsState) => (userId: string | number): boolean => {\n\t\t\t\treturn state.collection[userId]?.type === BotType.network;\n\t\t\t},\n\t\t\t/** @function users/bots/isSupport */\n\t\t\tisSupport: (state: BotsState) => (userId: string | number): boolean => {\n\t\t\t\treturn state.collection[userId]?.type === BotType.support24;\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions(): ActionTree\n\t{\n\t\treturn {\n\t\t\t/** @function users/bots/set */\n\t\t\tset: (store, payload: BotPayload) => {\n\t\t\t\tconst { userId, botData } = payload;\n\t\t\t\tif (!botData)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tstore.commit('set', {\n\t\t\t\t\tuserId,\n\t\t\t\t\tbotData: { ...this.getElementState(), ...this.formatFields(botData) },\n\t\t\t\t});\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMutations(): MutationTree\n\t{\n\t\treturn {\n\t\t\tset: (state: BotsState, payload: BotPayload) => {\n\t\t\t\tconst { userId, botData } = payload;\n\t\t\t\t// eslint-disable-next-line no-param-reassign\n\t\t\t\tstate.collection[userId] = botData;\n\t\t\t},\n\t\t};\n\t}\n\n\tformatFields(fields: JsonObject): ImModelBot\n\t{\n\t\tconst result: ImModelBot = convertObjectKeysToCamelCase(fields);\n\t\tif (result.type === RawBotType.human)\n\t\t{\n\t\t\tresult.type = BotType.bot;\n\t\t\tresult.isHuman = true;\n\t\t}\n\n\t\tconst TYPES_MAPPED_TO_DEFAULT_BOT = [RawBotType.openline, RawBotType.supervisor];\n\t\tif (TYPES_MAPPED_TO_DEFAULT_BOT.includes(result.type))\n\t\t{\n\t\t\tresult.type = BotType.bot;\n\t\t}\n\n\t\treturn result;\n\t}\n}\n","import { Core } from 'im.v2.application.core';\nimport { Type } from 'main.core';\n\nexport const prepareAvatar = (avatar: string): string => {\n\tlet result = '';\n\n\tif (!avatar || avatar.endsWith('/js/im/images/blank.gif'))\n\t{\n\t\tresult = '';\n\t}\n\telse if (avatar.startsWith('http'))\n\t{\n\t\tresult = avatar;\n\t}\n\telse\n\t{\n\t\tresult = Core.getHost() + avatar;\n\t}\n\n\tif (result)\n\t{\n\t\tresult = encodeURI(result);\n\t}\n\n\treturn result;\n};\n\nexport const prepareDepartments = (departments: Array<number | string>): number[] => {\n\tconst result = [];\n\tdepartments.forEach((rawDepartmentId) => {\n\t\tconst departmentId = Number.parseInt(rawDepartmentId, 10);\n\t\tif (departmentId > 0)\n\t\t{\n\t\t\tresult.push(departmentId);\n\t\t}\n\t});\n\n\treturn result;\n};\n\nexport const preparePhones = (phones): Object => {\n\tconst result = {};\n\n\tif (Type.isStringFilled(phones.workPhone) || Type.isNumber(phones.workPhone))\n\t{\n\t\tresult.workPhone = phones.workPhone.toString();\n\t}\n\n\tif (Type.isStringFilled(phones.personalMobile) || Type.isNumber(phones.personalMobile))\n\t{\n\t\tresult.personalMobile = phones.personalMobile.toString();\n\t}\n\n\tif (Type.isStringFilled(phones.personalPhone) || Type.isNumber(phones.personalPhone))\n\t{\n\t\tresult.personalPhone = phones.personalPhone.toString();\n\t}\n\n\tif (Type.isStringFilled(phones.innerPhone) || Type.isNumber(phones.innerPhone))\n\t{\n\t\tresult.innerPhone = phones.innerPhone.toString();\n\t}\n\n\treturn result;\n};\n","import { Type, Text } from 'main.core';\n\nimport { Utils } from 'im.v2.lib.utils';\nimport {\n\tconvertToNumber,\n\tconvertToDate,\n\tisNumberOrString,\n} from '../../utils/format';\nimport { prepareAvatar, prepareDepartments, preparePhones } from './format-functions';\n\nimport type { FieldsConfig } from '../../utils/validate';\n\nexport const userFieldsConfig: FieldsConfig = [\n\t{\n\t\tfieldName: 'id',\n\t\ttargetFieldName: 'id',\n\t\tcheckFunction: isNumberOrString,\n\t\tformatFunction: convertToNumber,\n\t},\n\t{\n\t\tfieldName: 'networkId',\n\t\ttargetFieldName: 'id',\n\t\tcheckFunction: Utils.user.isNetworkUserId,\n\t},\n\t{\n\t\tfieldName: 'firstName',\n\t\ttargetFieldName: 'firstName',\n\t\tcheckFunction: Type.isString,\n\t\tformatFunction: Text.decode,\n\t},\n\t{\n\t\tfieldName: 'lastName',\n\t\ttargetFieldName: 'lastName',\n\t\tcheckFunction: Type.isString,\n\t\tformatFunction: Text.decode,\n\t},\n\t{\n\t\tfieldName: 'name',\n\t\ttargetFieldName: 'name',\n\t\tcheckFunction: Type.isString,\n\t\tformatFunction: Text.decode,\n\t},\n\t{\n\t\tfieldName: 'color',\n\t\ttargetFieldName: 'color',\n\t\tcheckFunction: Type.isString,\n\t},\n\t{\n\t\tfieldName: 'avatar',\n\t\ttargetFieldName: 'avatar',\n\t\tcheckFunction: Type.isString,\n\t\tformatFunction: prepareAvatar,\n\t},\n\t{\n\t\tfieldName: 'workPosition',\n\t\ttargetFieldName: 'workPosition',\n\t\tcheckFunction: Type.isString,\n\t\tformatFunction: Text.decode,\n\t},\n\t{\n\t\tfieldName: 'gender',\n\t\ttargetFieldName: 'gender',\n\t\tcheckFunction: Type.isString,\n\t},\n\t{\n\t\tfieldName: 'birthday',\n\t\ttargetFieldName: 'birthday',\n\t\tcheckFunction: Type.isString,\n\t},\n\t{\n\t\tfieldName: 'isAdmin',\n\t\ttargetFieldName: 'isAdmin',\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: 'extranet',\n\t\ttargetFieldName: 'extranet',\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: 'network',\n\t\ttargetFieldName: 'network',\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: 'bot',\n\t\ttargetFieldName: 'bot',\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: 'connector',\n\t\ttargetFieldName: 'connector',\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: 'externalAuthId',\n\t\ttargetFieldName: 'externalAuthId',\n\t\tcheckFunction: Type.isString,\n\t},\n\t{\n\t\tfieldName: 'status',\n\t\ttargetFieldName: 'status',\n\t\tcheckFunction: Type.isString,\n\t},\n\t{\n\t\tfieldName: 'idle',\n\t\ttargetFieldName: 'idle',\n\t\tformatFunction: convertToDate,\n\t},\n\t{\n\t\tfieldName: 'lastActivityDate',\n\t\ttargetFieldName: 'lastActivityDate',\n\t\tformatFunction: convertToDate,\n\t},\n\t{\n\t\tfieldName: 'mobileLastDate',\n\t\ttargetFieldName: 'mobileLastDate',\n\t\tformatFunction: convertToDate,\n\t},\n\t{\n\t\tfieldName: 'absent',\n\t\ttargetFieldName: 'absent',\n\t\tformatFunction: convertToDate,\n\t},\n\t{\n\t\tfieldName: 'departments',\n\t\ttargetFieldName: 'departments',\n\t\tcheckFunction: Type.isArray,\n\t\tformatFunction: prepareDepartments,\n\t},\n\t{\n\t\tfieldName: 'phones',\n\t\ttargetFieldName: 'phones',\n\t\tcheckFunction: Type.isPlainObject,\n\t\tformatFunction: preparePhones,\n\t},\n];\n","import { Type, Loc, type JsonObject } from 'main.core';\nimport { BuilderModel, type ActionTree, type GetterTree, type MutationTree } from 'ui.vue3.vuex';\n\nimport { Core } from 'im.v2.application.core';\nimport { Utils } from 'im.v2.lib.utils';\nimport { UserStatus, Color } from 'im.v2.const';\n\nimport { BotsModel } from './nested-modules/bots';\nimport { formatFieldsWithConfig } from '../utils/validate';\nimport { userFieldsConfig } from './format/field-config';\n\nimport type { User as ImModelUser } from '../type/user';\n\ntype UsersState = {\n\tcollection: {[userId: string]: ImModelUser},\n\tonlineList: string[],\n\tmobileOnlineList: string[],\n\tabsentList: string[],\n};\n\nexport class UsersModel extends BuilderModel\n{\n\tgetName(): string\n\t{\n\t\treturn 'users';\n\t}\n\n\tgetNestedModules(): { [moduleName: string]: BuilderModel }\n\t{\n\t\treturn {\n\t\t\tbots: BotsModel,\n\t\t};\n\t}\n\n\tgetState(): UsersState\n\t{\n\t\treturn {\n\t\t\tcollection: {},\n\t\t\tonlineList: [],\n\t\t\tmobileOnlineList: [],\n\t\t\tabsentList: [],\n\t\t};\n\t}\n\n\tgetElementState(params = {}): ImModelUser\n\t{\n\t\tconst { id = 0 } = params;\n\n\t\treturn {\n\t\t\tid,\n\t\t\tname: '',\n\t\t\tfirstName: '',\n\t\t\tlastName: '',\n\t\t\tavatar: '',\n\t\t\tcolor: Color.base,\n\t\t\tworkPosition: '',\n\t\t\tgender: 'M',\n\t\t\tisAdmin: false,\n\t\t\textranet: false,\n\t\t\tnetwork: false,\n\t\t\tbot: false,\n\t\t\tconnector: false,\n\t\t\texternalAuthId: 'default',\n\t\t\tstatus: '',\n\t\t\tidle: false,\n\t\t\tlastActivityDate: false,\n\t\t\tmobileLastDate: false,\n\t\t\tisOnline: false,\n\t\t\tisMobileOnline: false,\n\t\t\tbirthday: false,\n\t\t\tisBirthday: false,\n\t\t\tabsent: false,\n\t\t\tisAbsent: false,\n\t\t\tdepartments: [],\n\t\t\tphones: {\n\t\t\t\tworkPhone: '',\n\t\t\t\tpersonalMobile: '',\n\t\t\t\tpersonalPhone: '',\n\t\t\t\tinnerPhone: '',\n\t\t\t},\n\t\t};\n\t}\n\n\t// eslint-disable-next-line max-lines-per-function\n\tgetGetters(): GetterTree\n\t{\n\t\treturn {\n\t\t\t/** @function users/get */\n\t\t\tget: (state) => (userId, getTemporary = false) => {\n\t\t\t\tconst user = state.collection[userId];\n\n\t\t\t\tif (!getTemporary && !user)\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\tif (getTemporary && !user)\n\t\t\t\t{\n\t\t\t\t\treturn this.getElementState({ id: userId });\n\t\t\t\t}\n\n\t\t\t\treturn user;\n\t\t\t},\n\t\t\t/** @function users/getBlank */\n\t\t\tgetBlank: () => (params) => {\n\t\t\t\treturn this.getElementState(params);\n\t\t\t},\n\t\t\t/** @function users/getList */\n\t\t\tgetList: (state) => (userList) => {\n\t\t\t\tconst result = [];\n\n\t\t\t\tif (!Array.isArray(userList))\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\tuserList.forEach((id) => {\n\t\t\t\t\tif (state.collection[id])\n\t\t\t\t\t{\n\t\t\t\t\t\tresult.push(state.collection[id]);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tresult.push(this.getElementState({ id }));\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\treturn result;\n\t\t\t},\n\t\t\t/** @function users/hasBirthday */\n\t\t\thasBirthday: (state) => (rawUserId) => {\n\t\t\t\tconst userId = Number.parseInt(rawUserId, 10);\n\n\t\t\t\tconst user = state.collection[userId];\n\t\t\t\tif (userId <= 0 || !user)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn user.isBirthday;\n\t\t\t},\n\t\t\t/** @function users/hasVacation */\n\t\t\thasVacation: (state) => (rawUserId) => {\n\t\t\t\tconst userId = Number.parseInt(rawUserId, 10);\n\n\t\t\t\tconst user = state.collection[userId];\n\t\t\t\tif (userId <= 0 || !user)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn user.isAbsent;\n\t\t\t},\n\t\t\t/** @function users/getStatus */\n\t\t\tgetStatus: (state) => (rawUserId) => {\n\t\t\t\tconst userId = Number.parseInt(rawUserId, 10);\n\n\t\t\t\tconst user = state.collection[userId];\n\t\t\t\tif (userId <= 0 || !user)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tif (!user.isOnline)\n\t\t\t\t{\n\t\t\t\t\treturn '';\n\t\t\t\t}\n\n\t\t\t\tif (user.isMobileOnline)\n\t\t\t\t{\n\t\t\t\t\treturn UserStatus.mobileOnline;\n\t\t\t\t}\n\n\t\t\t\tif (user.idle)\n\t\t\t\t{\n\t\t\t\t\t// away by time\n\t\t\t\t\treturn UserStatus.idle;\n\t\t\t\t}\n\n\t\t\t\t// manually selected status (online, away, dnd, break)\n\t\t\t\treturn user.status;\n\t\t\t},\n\t\t\t/** @function users/getLastOnline */\n\t\t\tgetLastOnline: (state) => (rawUserId) => {\n\t\t\t\tconst userId = Number.parseInt(rawUserId, 10);\n\n\t\t\t\tconst user = state.collection[userId];\n\t\t\t\tif (userId <= 0 || !user)\n\t\t\t\t{\n\t\t\t\t\treturn '';\n\t\t\t\t}\n\n\t\t\t\treturn Utils.user.getLastDateText(user);\n\t\t\t},\n\t\t\t/** @function users/getPosition */\n\t\t\tgetPosition: (state) => (rawUserId) => {\n\t\t\t\tconst userId = Number.parseInt(rawUserId, 10);\n\n\t\t\t\tconst user: ImModelUser = state.collection[userId];\n\t\t\t\tif (userId <= 0 || !user)\n\t\t\t\t{\n\t\t\t\t\treturn '';\n\t\t\t\t}\n\n\t\t\t\tif (user.workPosition)\n\t\t\t\t{\n\t\t\t\t\treturn user.workPosition;\n\t\t\t\t}\n\n\t\t\t\tif (user.bot === true)\n\t\t\t\t{\n\t\t\t\t\treturn Loc.getMessage('IM_MODEL_USERS_CHAT_BOT');\n\t\t\t\t}\n\n\t\t\t\treturn Loc.getMessage('IM_MODEL_USERS_DEFAULT_NAME');\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions(): ActionTree\n\t{\n\t\treturn {\n\t\t\t/** @function users/set */\n\t\t\tset: (store, rawPayload) => {\n\t\t\t\tlet payload = rawPayload;\n\t\t\t\tif (!Array.isArray(payload) && Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\tpayload = [payload];\n\t\t\t\t}\n\n\t\t\t\tpayload.map((user) => {\n\t\t\t\t\treturn this.formatFields(user);\n\t\t\t\t}).forEach((user) => {\n\t\t\t\t\tconst existingUser = store.state.collection[user.id];\n\t\t\t\t\tif (existingUser)\n\t\t\t\t\t{\n\t\t\t\t\t\tstore.commit('update', {\n\t\t\t\t\t\t\tid: user.id,\n\t\t\t\t\t\t\tfields: user,\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tstore.commit('add', {\n\t\t\t\t\t\t\tid: user.id,\n\t\t\t\t\t\t\tfields: { ...this.getElementState(), ...user },\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function users/add */\n\t\t\tadd: (store, rawPayload) => {\n\t\t\t\tlet payload = rawPayload;\n\t\t\t\tif (!Array.isArray(payload) && Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\tpayload = [payload];\n\t\t\t\t}\n\n\t\t\t\tpayload.map((user) => {\n\t\t\t\t\treturn this.formatFields(user);\n\t\t\t\t}).forEach((user) => {\n\t\t\t\t\tconst existingUser = store.state.collection[user.id];\n\t\t\t\t\tif (!existingUser)\n\t\t\t\t\t{\n\t\t\t\t\t\tstore.commit('add', {\n\t\t\t\t\t\t\tid: user.id,\n\t\t\t\t\t\t\tfields: { ...this.getElementState(), ...user },\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function users/update */\n\t\t\tupdate: (store, rawPayload) => {\n\t\t\t\tconst payload = rawPayload;\n\t\t\t\tpayload.id = Number.parseInt(payload.id, 10);\n\n\t\t\t\tconst user = store.state.collection[payload.id];\n\t\t\t\tif (!user)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst fields = { ...payload.fields, id: payload.id };\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tid: payload.id,\n\t\t\t\t\tfields: this.formatFields(fields),\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function users/delete */\n\t\t\tdelete: (store, payload) => {\n\t\t\t\tstore.commit('delete', payload.id);\n\t\t\t},\n\t\t\t/** @function users/setStatus */\n\t\t\tsetStatus: (store, payload: {status: string}) => {\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tid: Core.getUserId(),\n\t\t\t\t\tfields: this.formatFields(payload),\n\t\t\t\t});\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMutations(): MutationTree\n\t{\n\t\treturn {\n\t\t\tadd: (state, payload) => {\n\t\t\t\t// eslint-disable-next-line no-param-reassign\n\t\t\t\tstate.collection[payload.id] = payload.fields;\n\n\t\t\t\tthis.handleUserStatusFlags(state, payload.fields);\n\n\t\t\t\tthis.startOnlineCheckInterval();\n\t\t\t\tthis.startAbsentCheckInterval();\n\t\t\t},\n\t\t\tupdate: (state, payload) => {\n\t\t\t\t// eslint-disable-next-line no-param-reassign\n\t\t\t\tstate.collection[payload.id] = { ...state.collection[payload.id], ...payload.fields };\n\n\t\t\t\tthis.handleUserStatusFlags(state, payload.fields);\n\t\t\t},\n\t\t\tdelete: (state, payload) => {\n\t\t\t\t// eslint-disable-next-line no-param-reassign\n\t\t\t\tdelete state.collection[payload.id];\n\t\t\t},\n\t\t};\n\t}\n\n\tformatFields(fields: JsonObject): JsonObject\n\t{\n\t\tconst preparedFields: ImModelUser = formatFieldsWithConfig(fields, userFieldsConfig);\n\t\tconst isBot = preparedFields.bot === true;\n\t\tif (isBot)\n\t\t{\n\t\t\tCore.getStore().dispatch('users/bots/set', {\n\t\t\t\tuserId: preparedFields.id,\n\t\t\t\tbotData: fields.botData || fields.bot_data,\n\t\t\t});\n\t\t}\n\n\t\treturn preparedFields;\n\t}\n\n\thandleUserStatusFlags(state, fields: ImModelUser)\n\t{\n\t\tconst user = state.collection[fields.id];\n\t\tif (Utils.user.isOnline(fields.lastActivityDate))\n\t\t{\n\t\t\tuser.isOnline = true;\n\t\t\tthis.addToOnlineList(fields.id);\n\t\t}\n\n\t\tif (Utils.user.isMobileOnline(fields.lastActivityDate, fields.mobileLastDate))\n\t\t{\n\t\t\tuser.isMobileOnline = true;\n\t\t\tthis.addToMobileOnlineList(fields.id);\n\t\t}\n\n\t\tif (fields.birthday && Utils.user.isBirthdayToday(fields.birthday))\n\t\t{\n\t\t\tuser.isBirthday = true;\n\t\t\tsetTimeout(() => {\n\t\t\t\tuser.isBirthday = false;\n\t\t\t}, Utils.date.getTimeToNextMidnight());\n\t\t}\n\n\t\tif (fields.absent === false)\n\t\t{\n\t\t\tuser.isAbsent = false;\n\t\t\t// eslint-disable-next-line no-param-reassign\n\t\t\tstate.absentList = state.absentList.filter((element) => {\n\t\t\t\treturn element !== fields.id;\n\t\t\t});\n\t\t}\n\t\telse if (Type.isDate(fields.absent))\n\t\t{\n\t\t\tuser.isAbsent = true;\n\t\t\tthis.addToAbsentList(fields.id);\n\t\t}\n\t}\n\n\taddToOnlineList(id)\n\t{\n\t\tconst state = this.store.state.users;\n\t\tif (!state.onlineList.includes(id))\n\t\t{\n\t\t\tstate.onlineList.push(id);\n\t\t}\n\t}\n\n\taddToMobileOnlineList(id)\n\t{\n\t\tconst state = this.store.state.users;\n\t\tif (!state.mobileOnlineList.includes(id))\n\t\t{\n\t\t\tstate.mobileOnlineList.push(id);\n\t\t}\n\t}\n\n\taddToAbsentList(id)\n\t{\n\t\tconst state = this.store.state.users;\n\t\tif (!state.absentList.includes(id))\n\t\t{\n\t\t\tstate.absentList.push(id);\n\t\t}\n\t}\n\n\tstartAbsentCheckInterval()\n\t{\n\t\tif (this.absentCheckInterval)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst TIME_TO_NEXT_DAY = 1000 * 60 * 60 * 24;\n\t\tthis.absentCheckInterval = setTimeout(() => {\n\t\t\tsetInterval(() => {\n\t\t\t\tconst state = this.store.state.users;\n\t\t\t\tstate.absentList.forEach((userId) => {\n\t\t\t\t\tconst user = state.collection[userId];\n\t\t\t\t\tif (!user)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tconst currentTime = Date.now();\n\t\t\t\t\tconst absentEnd = new Date(user.absent).getTime();\n\n\t\t\t\t\tif (absentEnd <= currentTime)\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.absentList = state.absentList.filter((element) => {\n\t\t\t\t\t\t\treturn element !== userId;\n\t\t\t\t\t\t});\n\t\t\t\t\t\tuser.isAbsent = false;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}, TIME_TO_NEXT_DAY);\n\t\t}, Utils.date.getTimeToNextMidnight());\n\t}\n\n\tstartOnlineCheckInterval()\n\t{\n\t\tif (this.onlineCheckInterval)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst ONE_MINUTE = 60000;\n\t\tthis.onlineCheckInterval = setInterval(() => {\n\t\t\tconst state = this.store.state.users;\n\n\t\t\tstate.onlineList.forEach((userId) => {\n\t\t\t\tconst user = state.collection[userId];\n\t\t\t\tif (!user)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (Utils.user.isOnline(user.lastActivityDate))\n\t\t\t\t{\n\t\t\t\t\tuser.isOnline = true;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tuser.isOnline = false;\n\t\t\t\t\tstate.onlineList = state.onlineList.filter((element) => element !== userId);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tstate.mobileOnlineList.forEach((userId) => {\n\t\t\t\tconst user = state.collection[userId];\n\t\t\t\tif (!user)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (Utils.user.isMobileOnline(user.lastActivityDate, user.mobileLastDate))\n\t\t\t\t{\n\t\t\t\t\tuser.isMobileOnline = true;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tuser.isMobileOnline = false;\n\t\t\t\t\tstate.mobileOnlineList = state.mobileOnlineList.filter((element) => element !== userId);\n\t\t\t\t}\n\t\t\t});\n\t\t}, ONE_MINUTE);\n\t}\n}\n","import {Type} from 'main.core';\nimport {BuilderModel} from 'ui.vue3.vuex';\n\nimport {Core} from 'im.v2.application.core';\nimport {FileStatus} from 'im.v2.const';\nimport {Utils} from 'im.v2.lib.utils';\n\nimport type {ImModelFile} from 'im.v2.model';\nimport {Logger} from 'im.v2.lib.logger';\n\ntype FilesState = {\n\tcollection: {\n\t\t[fileId: string]: ImModelFile\n\t}\n};\n\nexport class FilesModel extends BuilderModel\n{\n\tgetName(): string\n\t{\n\t\treturn 'files';\n\t}\n\n\tgetState(): Object\n\t{\n\t\treturn {\n\t\t\tcollection: {},\n\t\t};\n\t}\n\n\tgetElementState()\n\t{\n\t\treturn {\n\t\t\tid: 0,\n\t\t\tchatId: 0,\n\t\t\tname: 'File is deleted',\n\t\t\tdate: new Date(),\n\t\t\ttype: 'file',\n\t\t\textension: '',\n\t\t\ticon: 'empty',\n\t\t\tsize: 0,\n\t\t\timage: false,\n\t\t\tstatus: FileStatus.done,\n\t\t\tprogress: 100,\n\t\t\tauthorId: 0,\n\t\t\tauthorName: '',\n\t\t\turlPreview: '',\n\t\t\turlShow: '',\n\t\t\turlDownload: '',\n\t\t\tviewerAttrs: null\n\t\t};\n\t}\n\n\tgetGetters()\n\t{\n\t\treturn {\n\t\t\t/** @function files/get */\n\t\t\tget: (state: FilesState) => (fileId: number, getTemporary = false): ?ImModelFile =>\n\t\t\t{\n\t\t\t\tif (!fileId)\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\tif (!getTemporary && !state.collection[fileId])\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[fileId];\n\t\t\t},\n\t\t\t/** @function files/isInCollection */\n\t\t\tisInCollection: (state: FilesState) => (payload: {fileId: number | string}): boolean =>\n\t\t\t{\n\t\t\t\tconst {fileId} = payload;\n\n\t\t\t\treturn !!state.collection[fileId];\n\t\t\t}\n\t\t};\n\t}\n\n\tgetActions()\n\t{\n\t\treturn {\n\t\t\t/** @function files/add */\n\t\t\tadd: (store, payload: Object) =>\n\t\t\t{\n\t\t\t\tconst preparedFile = {...this.getElementState(), ...this.validate(payload)};\n\n\t\t\t\tstore.commit('add', {files: [preparedFile]});\n\t\t\t},\n\t\t\t/** @function files/set */\n\t\t\tset: (store, payload: Object[]) =>\n\t\t\t{\n\t\t\t\tif (!Array.isArray(payload) && Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\tpayload = [payload];\n\t\t\t\t}\n\n\t\t\t\tpayload = payload.map(file => {\n\t\t\t\t\treturn {...this.getElementState(), ...this.validate(file)};\n\t\t\t\t});\n\n\t\t\t\tstore.commit('add', {files: payload});\n\t\t\t},\n\t\t\t/** @function files/update */\n\t\t\tupdate: (store, payload) =>\n\t\t\t{\n\t\t\t\tconst {id, fields} = payload;\n\t\t\t\tconst existingItem = store.state.collection[id];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tid: id,\n\t\t\t\t\tfields: this.validate(fields)\n\t\t\t\t});\n\n\t\t\t\treturn true;\n\t\t\t},\n\t\t\t/** @function files/updateWithId */\n\t\t\tupdateWithId: (store, payload: {id: string | number, fields: Object}) =>\n\t\t\t{\n\t\t\t\tconst {id, fields} = payload;\n\t\t\t\tif (!store.state.collection[id])\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('updateWithId', {\n\t\t\t\t\tid,\n\t\t\t\t\tfields: this.validate(fields)\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function files/delete */\n\t\t\tdelete: (store, payload: {id: string | number}) =>\n\t\t\t{\n\t\t\t\tconst {id} = payload;\n\t\t\t\tif (!store.state.collection[id])\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('delete', {id});\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMutations()\n\t{\n\t\treturn {\n\t\t\tadd: (state: FilesState, payload: {files: ImModelFile[]}) =>\n\t\t\t{\n\t\t\t\tpayload.files.forEach(file => {\n\t\t\t\t\tstate.collection[file.id] = file;\n\t\t\t\t});\n\t\t\t},\n\t\t\tupdate: (state: FilesState, payload) =>\n\t\t\t{\n\t\t\t\tObject.entries(payload.fields).forEach(([key, value]) => {\n\t\t\t\t\tstate.collection[payload.id][key] = value;\n\t\t\t\t});\n\t\t\t},\n\t\t\tupdateWithId: (state: FilesState, payload: {id: number | string, fields: Object}) =>\n\t\t\t{\n\t\t\t\tconst {id, fields} = payload;\n\t\t\t\tconst currentFile = {...state.collection[id]};\n\n\t\t\t\tdelete state.collection[id];\n\t\t\t\tstate.collection[fields.id] = {...currentFile, ...fields};\n\t\t\t},\n\t\t\tdelete: (state: FilesState, payload: {id: number | string}) =>\n\t\t\t{\n\t\t\t\tLogger.warn('Files model: delete mutation', payload);\n\t\t\t\tconst {id} = payload;\n\t\t\t\tdelete state.collection[id];\n\t\t\t},\n\t\t};\n\t}\n\n\tvalidate(file: Object): ImModelFile\n\t{\n\t\tconst result = {};\n\n\t\tif (Type.isNumber(file.id) || Type.isStringFilled(file.id))\n\t\t{\n\t\t\tresult.id = file.id;\n\t\t}\n\n\t\tif (Type.isNumber(file.chatId) || Type.isString(file.chatId))\n\t\t{\n\t\t\tresult.chatId = Number.parseInt(file.chatId, 10);\n\t\t}\n\n\t\tif (!Type.isUndefined(file.date))\n\t\t{\n\t\t\tresult.date = Utils.date.cast(file.date);\n\t\t}\n\n\t\tif (Type.isString(file.type))\n\t\t{\n\t\t\tresult.type = file.type;\n\t\t}\n\n\t\tif (Type.isString(file.extension))\n\t\t{\n\t\t\tresult.extension = file.extension.toString();\n\n\t\t\tif (result.type === 'image')\n\t\t\t{\n\t\t\t\tresult.icon = 'img';\n\t\t\t}\n\t\t\telse if (result.type === 'video')\n\t\t\t{\n\t\t\t\tresult.icon = 'mov';\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresult.icon = Utils.file.getIconTypeByExtension(result.extension);\n\t\t\t}\n\t\t}\n\n\t\tif (Type.isString(file.name) || Type.isNumber(file.name))\n\t\t{\n\t\t\tresult.name = file.name.toString();\n\t\t}\n\n\t\tif (Type.isNumber(file.size) || Type.isString(file.size))\n\t\t{\n\t\t\tresult.size = Number.parseInt(file.size, 10);\n\t\t}\n\n\t\tif (Type.isBoolean(file.image))\n\t\t{\n\t\t\tresult.image = false;\n\t\t}\n\t\telse if (Type.isPlainObject(file.image))\n\t\t{\n\t\t\tresult.image = {\n\t\t\t\twidth: 0,\n\t\t\t\theight: 0,\n\t\t\t};\n\n\t\t\tif (Type.isString(file.image.width) || Type.isNumber(file.image.width))\n\t\t\t{\n\t\t\t\tresult.image.width = Number.parseInt(file.image.width, 10);\n\t\t\t}\n\t\t\tif (Type.isString(file.image.height) || Type.isNumber(file.image.height))\n\t\t\t{\n\t\t\t\tresult.image.height = Number.parseInt(file.image.height, 10);\n\t\t\t}\n\n\t\t\tif (result.image.width <= 0 || result.image.height <= 0)\n\t\t\t{\n\t\t\t\tresult.image = false;\n\t\t\t}\n\t\t}\n\n\t\tif (Type.isString(file.status) && !Type.isUndefined(FileStatus[file.status]))\n\t\t{\n\t\t\tresult.status = file.status;\n\t\t}\n\n\t\tif (Type.isNumber(file.progress) || Type.isString(file.progress))\n\t\t{\n\t\t\tresult.progress = Number.parseInt(file.progress, 10);\n\t\t}\n\n\t\tif (Type.isNumber(file.authorId) || Type.isString(file.authorId))\n\t\t{\n\t\t\tresult.authorId = Number.parseInt(file.authorId, 10);\n\t\t}\n\n\t\tif (Type.isString(file.authorName) || Type.isNumber(file.authorName))\n\t\t{\n\t\t\tresult.authorName = file.authorName.toString();\n\t\t}\n\n\t\tif (Type.isString(file.urlPreview))\n\t\t{\n\t\t\tif (\n\t\t\t\t!file.urlPreview\n\t\t\t\t|| file.urlPreview.startsWith('http')\n\t\t\t\t|| file.urlPreview.startsWith('bx')\n\t\t\t\t|| file.urlPreview.startsWith('file')\n\t\t\t\t|| file.urlPreview.startsWith('blob')\n\t\t\t)\n\t\t\t{\n\t\t\t\tresult.urlPreview = file.urlPreview;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresult.urlPreview = Core.getHost() + file.urlPreview;\n\t\t\t}\n\t\t}\n\n\t\tif (Type.isString(file.urlDownload))\n\t\t{\n\t\t\tif (\n\t\t\t\t!file.urlDownload\n\t\t\t\t|| file.urlDownload.startsWith('http')\n\t\t\t\t|| file.urlDownload.startsWith('bx')\n\t\t\t\t|| file.urlPreview.startsWith('file')\n\t\t\t)\n\t\t\t{\n\t\t\t\tresult.urlDownload = file.urlDownload;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresult.urlDownload = Core.getHost() + file.urlDownload;\n\t\t\t}\n\t\t}\n\n\t\tif (Type.isString(file.urlShow))\n\t\t{\n\t\t\tif (\n\t\t\t\t!file.urlShow\n\t\t\t\t|| file.urlShow.startsWith('http')\n\t\t\t\t|| file.urlShow.startsWith('bx')\n\t\t\t\t|| file.urlShow.startsWith('file')\n\t\t\t\t|| file.urlShow.startsWith('blob')\n\t\t\t)\n\t\t\t{\n\t\t\t\tresult.urlShow = file.urlShow;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresult.urlShow = Core.getHost() + file.urlShow;\n\t\t\t}\n\t\t}\n\n\t\tif (Type.isPlainObject(file.viewerAttrs))\n\t\t{\n\t\t\tresult.viewerAttrs = this.validateViewerAttributes(file.viewerAttrs);\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tvalidateViewerAttributes(viewerAttrs)\n\t{\n\t\tconst result = {\n\t\t\tviewer: true,\n\t\t};\n\n\t\tif (Type.isString(viewerAttrs.actions))\n\t\t{\n\t\t\tresult.actions = viewerAttrs.actions;\n\t\t}\n\n\t\tif (Type.isString(viewerAttrs.objectId))\n\t\t{\n\t\t\tresult.objectId = viewerAttrs.objectId;\n\t\t}\n\n\t\tif (Type.isString(viewerAttrs.src))\n\t\t{\n\t\t\tresult.src = viewerAttrs.src;\n\t\t}\n\n\t\tif (Type.isString(viewerAttrs.title))\n\t\t{\n\t\t\tresult.title = viewerAttrs.title;\n\t\t}\n\n\t\tif (Type.isString(viewerAttrs.viewerGroupBy))\n\t\t{\n\t\t\tresult.viewerGroupBy = viewerAttrs.viewerGroupBy;\n\t\t}\n\n\t\tif (Type.isString(viewerAttrs.viewerType))\n\t\t{\n\t\t\tresult.viewerType = viewerAttrs.viewerType;\n\t\t}\n\n\t\tif (Type.isString(viewerAttrs.viewerTypeClass))\n\t\t{\n\t\t\tresult.viewerTypeClass = viewerAttrs.viewerTypeClass;\n\t\t}\n\n\t\tif (Type.isBoolean(viewerAttrs.viewerSeparateItem))\n\t\t{\n\t\t\tresult.viewerSeparateItem = viewerAttrs.viewerSeparateItem;\n\t\t}\n\n\t\tif (Type.isString(viewerAttrs.viewerExtension))\n\t\t{\n\t\t\tresult.viewerExtension = viewerAttrs.viewerExtension;\n\t\t}\n\n\t\tif (Type.isNumber(viewerAttrs.imChatId))\n\t\t{\n\t\t\tresult.imChatId = viewerAttrs.imChatId;\n\t\t}\n\n\t\treturn result;\n\t}\n}\n","import { Type } from 'main.core';\nimport { BuilderModel, GetterTree, ActionTree, MutationTree } from 'ui.vue3.vuex';\n\nimport { RecentCallStatus } from 'im.v2.const';\n\nimport type { ImModelCallItem } from 'im.v2.model';\n\ntype CallsState = {\n\tcollection: {\n\t\t[dialogId: string]: ImModelCallItem\n\t}\n};\n\nexport class CallsModel extends BuilderModel\n{\n\tgetState()\n\t{\n\t\treturn {\n\t\t\tcollection: {}\n\t\t};\n\t}\n\n\tgetElementState()\n\t{\n\t\treturn {\n\t\t\tdialogId: 0,\n\t\t\tname: '',\n\t\t\tcall: {},\n\t\t\tstate: RecentCallStatus.waiting\n\t\t};\n\t}\n\n\tgetGetters(): GetterTree\n\t{\n\t\treturn {\n\t\t\tget: (state: CallsState): ImModelCallItem[] => {\n\t\t\t\treturn Object.values(state.collection);\n\t\t\t},\n\n\t\t\thasActiveCall: (state: CallsState) => (dialogId): boolean => {\n\t\t\t\tif (Type.isUndefined(dialogId))\n\t\t\t\t{\n\t\t\t\t\tconst activeCall = Object.values(state.collection).find((item: ImModelCallItem) => {\n\t\t\t\t\t\treturn item.state === RecentCallStatus.joined;\n\t\t\t\t\t});\n\n\t\t\t\t\treturn Boolean(activeCall);\n\t\t\t\t}\n\n\t\t\t\tconst existingCall = Object.values(state.collection).find((item: ImModelCallItem) => {\n\t\t\t\t\treturn item.dialogId === dialogId;\n\t\t\t\t});\n\n\t\t\t\tif (!existingCall)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn existingCall.state === RecentCallStatus.joined;\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions(): ActionTree\n\t{\n\t\treturn {\n\t\t\taddActiveCall: (store, payload: ImModelCallItem) =>\n\t\t\t{\n\t\t\t\tconst existingCall = Object.values(store.state.collection).find((item: ImModelCallItem) => {\n\t\t\t\t\treturn item.dialogId === payload.dialogId || item.call.id === payload.call.id;\n\t\t\t\t});\n\n\t\t\t\tif (existingCall)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('updateActiveCall', {\n\t\t\t\t\t\tdialogId: existingCall.dialogId,\n\t\t\t\t\t\tfields: this.validateActiveCall(payload)\n\t\t\t\t\t});\n\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('addActiveCall', this.prepareActiveCall(payload));\n\t\t\t},\n\t\t\tupdateActiveCall: (store, payload) =>\n\t\t\t{\n\t\t\t\tconst existingCall = store.state.collection[payload.dialogId];\n\t\t\t\tif (!existingCall)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('updateActiveCall', {\n\t\t\t\t\tdialogId: existingCall.dialogId,\n\t\t\t\t\tfields: this.validateActiveCall(payload.fields)\n\t\t\t\t});\n\t\t\t},\n\t\t\tdeleteActiveCall: (store, payload) =>\n\t\t\t{\n\t\t\t\tconst existingCall = store.state.collection[payload.dialogId];\n\t\t\t\tif (!existingCall)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('deleteActiveCall', {\n\t\t\t\t\tdialogId: existingCall.dialogId\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\t}\n\n\tgetMutations(): MutationTree\n\t{\n\t\treturn {\n\t\t\taddActiveCall: (state: CallsState, payload: ImModelCallItem) => {\n\t\t\t\tstate.collection[payload.dialogId] = payload;\n\t\t\t},\n\t\t\tupdateActiveCall: (state: CallsState, payload) => {\n\t\t\t\tstate.collection[payload.dialogId] = {\n\t\t\t\t\t...state.collection[payload.dialogId],\n\t\t\t\t\t...payload.fields\n\t\t\t\t};\n\t\t\t},\n\t\t\tdeleteActiveCall: (state: CallsState, payload) => {\n\t\t\t\tdelete state.collection[payload.dialogId];\n\t\t\t},\n\t\t};\n\t}\n\n\tprepareActiveCall(call)\n\t{\n\t\treturn {...this.getElementState(), ...this.validateActiveCall(call)};\n\t}\n\n\tvalidateActiveCall(fields)\n\t{\n\t\tconst result = {};\n\n\t\tif (Type.isStringFilled(fields.dialogId) || Type.isNumber(fields.dialogId))\n\t\t{\n\t\t\tresult.dialogId = fields.dialogId;\n\t\t}\n\n\t\tif (Type.isStringFilled(fields.name))\n\t\t{\n\t\t\tresult.name = fields.name;\n\t\t}\n\n\t\tif (Type.isObjectLike(fields.call))\n\t\t{\n\t\t\tresult.call = fields.call;\n\n\t\t\tif (fields.call?.associatedEntity?.avatar === '/bitrix/js/im/images/blank.gif')\n\t\t\t{\n\t\t\t\tresult.call.associatedEntity.avatar = '';\n\t\t\t}\n\t\t}\n\n\t\tif (RecentCallStatus[fields.state])\n\t\t{\n\t\t\tresult.state = fields.state;\n\t\t}\n\n\t\treturn result;\n\t}\n}","/* eslint-disable no-param-reassign */\nimport { BuilderModel, GetterTree, ActionTree, MutationTree } from 'ui.vue3.vuex';\nimport { Type } from 'main.core';\n\ntype SearchRecentItem = {\n\tdialogId: string,\n\tfoundByUser: boolean,\n}\n\ntype SearchState = {\n\tcollection: {\n\t\t[dialogId: string]: SearchRecentItem\n\t}\n};\n\nexport class RecentSearchModel extends BuilderModel\n{\n\tgetState(): SearchState\n\t{\n\t\treturn {\n\t\t\tcollection: {},\n\t\t};\n\t}\n\n\tgetElementState(): SearchRecentItem\n\t{\n\t\treturn {\n\t\t\tdialogId: '0',\n\t\t\tfoundByUser: false,\n\t\t};\n\t}\n\n\tgetGetters(): GetterTree\n\t{\n\t\treturn {\n\t\t\t/** @function recent/search/getDialogIds */\n\t\t\tgetDialogIds: (state: SearchState): string[] => {\n\t\t\t\treturn Object.values(state.collection).map((item) => item.dialogId);\n\t\t\t},\n\t\t\t/** @function recent/search/get */\n\t\t\tget: (state: SearchState) => (rawDialogId: string): SearchRecentItem | null => {\n\t\t\t\tlet dialogId = rawDialogId;\n\t\t\t\tif (Type.isNumber(dialogId))\n\t\t\t\t{\n\t\t\t\t\tdialogId = dialogId.toString();\n\t\t\t\t}\n\n\t\t\t\tif (state.collection[dialogId])\n\t\t\t\t{\n\t\t\t\t\treturn state.collection[dialogId];\n\t\t\t\t}\n\n\t\t\t\treturn null;\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions(): ActionTree\n\t{\n\t\treturn {\n\t\t\t/** @function recent/search/set */\n\t\t\tset: (store, payload) => {\n\t\t\t\tpayload.forEach((item) => {\n\t\t\t\t\tconst recentElement = this.validate(item);\n\n\t\t\t\t\tstore.commit('set', {\n\t\t\t\t\t\tdialogId: recentElement.dialogId,\n\t\t\t\t\t\tfoundByUser: recentElement.foundByUser,\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function recent/search/clear */\n\t\t\tclear: (store, payload) => {\n\t\t\t\tstore.commit('clear');\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMutations(): MutationTree\n\t{\n\t\treturn {\n\t\t\tset: (state: SearchState, payload: SearchRecentItem) => {\n\t\t\t\tstate.collection[payload.dialogId] = payload;\n\t\t\t},\n\t\t\tclear: (state: SearchState) => {\n\t\t\t\tstate.collection = {};\n\t\t\t},\n\t\t};\n\t}\n\n\tvalidate(fields: Object, options): SearchRecentItem\n\t{\n\t\tconst element = this.getElementState();\n\n\t\tif (Type.isStringFilled(fields.dialogId))\n\t\t{\n\t\t\telement.dialogId = fields.dialogId;\n\t\t}\n\n\t\tif (Type.isBoolean(fields.byUser))\n\t\t{\n\t\t\telement.foundByUser = fields.byUser;\n\t\t}\n\n\t\treturn element;\n\t}\n}\n","import { Type } from 'main.core';\nimport { BuilderModel } from 'ui.vue3.vuex';\n\nimport { Core } from 'im.v2.application.core';\nimport { ChatType, MessageStatus, Settings } from 'im.v2.const';\nimport { Utils } from 'im.v2.lib.utils';\n\nimport { CallsModel } from './nested-modules/calls';\nimport { RecentSearchModel } from './nested-modules/search';\n\nimport type { GetterTree, ActionTree, MutationTree } from 'ui.vue3.vuex';\n\nimport type { RecentItem as ImModelRecentItem } from '../type/recent-item';\n\ntype RecentState = {\n\tcollection: {[dialogId: string]: ImModelRecentItem},\n\trecentCollection: Set<string>,\n\tunreadCollection: Set<string>,\n\tcopilotCollection: Set<string>,\n};\n\nexport class RecentModel extends BuilderModel\n{\n\tgetName(): string\n\t{\n\t\treturn 'recent';\n\t}\n\n\tgetNestedModules(): { [moduleName: string]: BuilderModel }\n\t{\n\t\treturn {\n\t\t\tcalls: CallsModel,\n\t\t\tsearch: RecentSearchModel,\n\t\t};\n\t}\n\n\tgetState(): RecentState\n\t{\n\t\treturn {\n\t\t\tcollection: {},\n\t\t\trecentCollection: new Set(),\n\t\t\tunreadCollection: new Set(),\n\t\t\tcopilotCollection: new Set(),\n\t\t};\n\t}\n\n\tgetElementState(): ImModelRecentItem\n\t{\n\t\treturn {\n\t\t\tdialogId: '0',\n\t\t\tmessage: {\n\t\t\t\tid: 0,\n\t\t\t\tsenderId: 0,\n\t\t\t\tdate: null,\n\t\t\t\tstatus: MessageStatus.received,\n\t\t\t\tsending: false,\n\t\t\t\ttext: '',\n\t\t\t\tparams: {\n\t\t\t\t\twithFile: false,\n\t\t\t\t\twithAttach: false,\n\t\t\t\t},\n\t\t\t},\n\t\t\tdraft: {\n\t\t\t\ttext: '',\n\t\t\t\tdate: null,\n\t\t\t},\n\t\t\tunread: false,\n\t\t\tpinned: false,\n\t\t\tliked: false,\n\t\t\tdateUpdate: null,\n\t\t\tinvitation: {\n\t\t\t\tisActive: false,\n\t\t\t\toriginator: 0,\n\t\t\t\tcanResend: false,\n\t\t\t},\n\t\t\toptions: {},\n\t\t};\n\t}\n\n\t// eslint-disable-next-line max-lines-per-function\n\tgetGetters(): GetterTree\n\t{\n\t\treturn {\n\t\t\t/** @function recent/getRecentCollection */\n\t\t\tgetRecentCollection: (state: RecentState): ImModelRecentItem[] => {\n\t\t\t\treturn [...state.recentCollection].filter((dialogId) => {\n\t\t\t\t\tconst dialog = this.store.getters['chats/get'](dialogId);\n\n\t\t\t\t\treturn Boolean(dialog);\n\t\t\t\t}).map((id) => {\n\t\t\t\t\treturn state.collection[id];\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function recent/getUnreadCollection */\n\t\t\tgetUnreadCollection: (state: RecentState): ImModelRecentItem[] => {\n\t\t\t\treturn [...state.unreadCollection].map((id) => {\n\t\t\t\t\treturn state.collection[id];\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function recent/getCopilotCollection */\n\t\t\tgetCopilotCollection: (state: RecentState): ImModelRecentItem[] => {\n\t\t\t\treturn [...state.copilotCollection].filter((dialogId) => {\n\t\t\t\t\tconst dialog = this.store.getters['chats/get'](dialogId);\n\n\t\t\t\t\treturn Boolean(dialog);\n\t\t\t\t}).map((id) => {\n\t\t\t\t\treturn state.collection[id];\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function recent/getSortedCollection */\n\t\t\tgetSortedCollection: (state: RecentState): ImModelRecentItem[] => {\n\t\t\t\tconst recentCollectionAsArray = [...state.recentCollection].map((dialogId) => {\n\t\t\t\t\treturn state.collection[dialogId];\n\t\t\t\t});\n\n\t\t\t\tconst filteredCollection = recentCollectionAsArray.filter((item) => {\n\t\t\t\t\tconst isBirthdayPlaceholder = item.options.birthdayPlaceholder;\n\t\t\t\t\tconst isInvitedUser = item.options.defaultUserRecord;\n\n\t\t\t\t\treturn !isBirthdayPlaceholder && !isInvitedUser && item.message.id;\n\t\t\t\t});\n\n\t\t\t\treturn [...filteredCollection].sort((a, b) => {\n\t\t\t\t\treturn b.message.date - a.message.date;\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function recent/get */\n\t\t\tget: (state: RecentState) => (rawDialogId: string): ImModelRecentItem | null => {\n\t\t\t\tlet dialogId = rawDialogId;\n\t\t\t\tif (Type.isNumber(dialogId))\n\t\t\t\t{\n\t\t\t\t\tdialogId = dialogId.toString();\n\t\t\t\t}\n\n\t\t\t\tif (state.collection[dialogId])\n\t\t\t\t{\n\t\t\t\t\treturn state.collection[dialogId];\n\t\t\t\t}\n\n\t\t\t\treturn null;\n\t\t\t},\n\t\t\t/** @function recent/needsBirthdayPlaceholder */\n\t\t\tneedsBirthdayPlaceholder: (state: RecentState) => (dialogId): boolean => {\n\t\t\t\tconst currentItem = state.collection[dialogId];\n\t\t\t\tif (!currentItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst dialog = this.store.getters['chats/get'](dialogId);\n\t\t\t\tif (!dialog || dialog.type !== ChatType.user)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tconst hasBirthday = this.store.getters['users/hasBirthday'](dialogId);\n\t\t\t\tif (!hasBirthday)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst hasMessage = Utils.text.isTempMessage(currentItem.message.id) || currentItem.message.id > 0;\n\t\t\t\tconst hasTodayMessage = hasMessage && Utils.date.isToday(currentItem.message.date);\n\n\t\t\t\tconst showBirthday = this.store.getters['application/settings/get'](Settings.recent.showBirthday);\n\n\t\t\t\treturn showBirthday && !hasTodayMessage && dialog.counter === 0;\n\t\t\t},\n\t\t\t/** @function recent/needsVacationPlaceholder */\n\t\t\tneedsVacationPlaceholder: (state: RecentState) => (dialogId): boolean => {\n\t\t\t\tconst currentItem = state.collection[dialogId];\n\t\t\t\tif (!currentItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst dialog = this.store.getters['chats/get'](dialogId);\n\t\t\t\tif (!dialog || dialog.type !== ChatType.user)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tconst hasVacation = this.store.getters['users/hasVacation'](dialogId);\n\t\t\t\tif (!hasVacation)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst hasMessage = Utils.text.isTempMessage(currentItem.message.id) || currentItem.message.id > 0;\n\t\t\t\tconst hasTodayMessage = hasMessage && Utils.date.isToday(currentItem.message.date);\n\n\t\t\t\treturn !hasTodayMessage && dialog.counter === 0;\n\t\t\t},\n\t\t\t/** @function recent/getMessageDate */\n\t\t\tgetMessageDate: (state: RecentState) => (dialogId): Date | null => {\n\t\t\t\tconst currentItem = state.collection[dialogId];\n\t\t\t\tif (!currentItem)\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\tif (Type.isDate(currentItem.draft.date) && currentItem.draft.date > currentItem.message.date)\n\t\t\t\t{\n\t\t\t\t\treturn currentItem.draft.date;\n\t\t\t\t}\n\n\t\t\t\tconst needsBirthdayPlaceholder = this.store.getters['recent/needsBirthdayPlaceholder'](currentItem.dialogId);\n\t\t\t\tif (needsBirthdayPlaceholder)\n\t\t\t\t{\n\t\t\t\t\treturn Utils.date.getStartOfTheDay();\n\t\t\t\t}\n\n\t\t\t\treturn currentItem.message.date;\n\t\t\t},\n\t\t};\n\t}\n\n\t/* eslint-disable no-param-reassign */\n\t/* eslint-disable-next-line max-lines-per-function */\n\tgetActions(): ActionTree\n\t{\n\t\treturn {\n\t\t\t/** @function recent/setRecent */\n\t\t\tsetRecent: async (store, payload: Array | Object) => {\n\t\t\t\tconst itemIds = await Core.getStore().dispatch('recent/store', payload);\n\t\t\t\tstore.commit('setRecentCollection', itemIds);\n\n\t\t\t\tthis.updateUnloadedRecentCounters(payload);\n\t\t\t},\n\t\t\t/** @function recent/setUnread */\n\t\t\tsetUnread: async (store, payload: Array | Object) => {\n\t\t\t\tconst itemIds = await this.store.dispatch('recent/store', payload);\n\t\t\t\tstore.commit('setUnreadCollection', itemIds);\n\t\t\t},\n\t\t\t/** @function recent/setCopilot */\n\t\t\tsetCopilot: async (store, payload: Array | Object) => {\n\t\t\t\tconst itemIds = await this.store.dispatch('recent/store', payload);\n\t\t\t\tstore.commit('setCopilotCollection', itemIds);\n\n\t\t\t\tthis.updateUnloadedCopilotCounters(payload);\n\t\t\t},\n\t\t\t/** @function recent/store */\n\t\t\tstore: (store, payload: Array | Object) => {\n\t\t\t\tif (!Array.isArray(payload) && Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\tpayload = [payload];\n\t\t\t\t}\n\n\t\t\t\tconst itemsToUpdate = [];\n\t\t\t\tconst itemsToAdd = [];\n\t\t\t\tpayload.map((element) => {\n\t\t\t\t\treturn this.validate(element);\n\t\t\t\t}).forEach((element) => {\n\t\t\t\t\tconst preparedElement = { ...element };\n\t\t\t\t\tconst existingItem = store.state.collection[element.dialogId];\n\t\t\t\t\tif (existingItem)\n\t\t\t\t\t{\n\t\t\t\t\t\titemsToUpdate.push({ dialogId: existingItem.dialogId, fields: preparedElement });\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tconst { message: defaultMessage } = this.getElementState();\n\t\t\t\t\t\tpreparedElement.message = { ...defaultMessage, ...preparedElement.message };\n\t\t\t\t\t\titemsToAdd.push({ ...this.getElementState(), ...preparedElement });\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tif (itemsToAdd.length > 0)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('add', itemsToAdd);\n\t\t\t\t}\n\n\t\t\t\tif (itemsToUpdate.length > 0)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('update', itemsToUpdate);\n\t\t\t\t}\n\n\t\t\t\treturn [...itemsToAdd, ...itemsToUpdate].map((item) => item.dialogId);\n\t\t\t},\n\t\t\t/** @function recent/update */\n\t\t\tupdate: (store, payload: {id: string | number, fields: Object}) => {\n\t\t\t\tconst { id, fields } = payload;\n\t\t\t\tconst existingItem: ImModelRecentItem = store.state.collection[id];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tdialogId: existingItem.dialogId,\n\t\t\t\t\tfields: this.validate(fields),\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function recent/unread */\n\t\t\tunread: (store, payload: {id: string | number, action: boolean, dateUpdate: Date}) => {\n\t\t\t\tconst existingItem = store.state.collection[payload.id];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tdialogId: existingItem.dialogId,\n\t\t\t\t\tfields: {\n\t\t\t\t\t\tunread: payload.action,\n\t\t\t\t\t\tdateUpdate: payload.dateUpdate,\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function recent/pin */\n\t\t\tpin: (store, payload: {id: string | number, action: boolean, dateUpdate: Date}) => {\n\t\t\t\tconst existingItem = store.state.collection[payload.id];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tdialogId: existingItem.dialogId,\n\t\t\t\t\tfields: {\n\t\t\t\t\t\tpinned: payload.action,\n\t\t\t\t\t\tdateUpdate: payload.dateUpdate,\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function recent/like */\n\t\t\tlike: (store, payload: {id: string | number, messageId: number, liked: boolean}) => {\n\t\t\t\tconst existingItem = store.state.collection[payload.id];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst isLastMessage = existingItem.message.id === Number.parseInt(payload.messageId, 10);\n\t\t\t\tconst isExactMessageLiked = !Type.isUndefined(payload.messageId) && payload.liked === true;\n\t\t\t\tif (isExactMessageLiked && !isLastMessage)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tdialogId: existingItem.dialogId,\n\t\t\t\t\tfields: { liked: payload.liked === true },\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function recent/setRecentDraft */\n\t\t\tsetRecentDraft: (store, payload: {id: string | number, text: string}) => {\n\t\t\t\tCore.getStore().dispatch('recent/setDraft', {\n\t\t\t\t\tid: payload.id,\n\t\t\t\t\ttext: payload.text,\n\t\t\t\t\tcollectionName: 'recentCollection',\n\t\t\t\t\taddMethodName: 'setRecentCollection',\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function recent/setCopilotDraft */\n\t\t\tsetCopilotDraft: (store, payload: {id: string | number, text: string}) => {\n\t\t\t\tCore.getStore().dispatch('recent/setDraft', {\n\t\t\t\t\tid: payload.id,\n\t\t\t\t\ttext: payload.text,\n\t\t\t\t\tcollectionName: 'copilotCollection',\n\t\t\t\t\taddMethodName: 'setCopilotCollection',\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function recent/setDraft */\n\t\t\tsetDraft: (store, payload: {\n\t\t\t\tid: string | number, text: string, collectionName: string, addMethodName: string\n\t\t\t}) => {\n\t\t\t\tlet existingItem = store.state.collection[payload.id];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\tif (payload.text === '')\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tconst newItem = {\n\t\t\t\t\t\tdialogId: payload.id.toString(),\n\t\t\t\t\t};\n\t\t\t\t\tstore.commit('add', { ...this.getElementState(), ...newItem });\n\t\t\t\t\texistingItem = store.state.collection[payload.id];\n\t\t\t\t}\n\n\t\t\t\tconst existingCollectionItem = store.state[payload.collectionName].has(payload.id);\n\t\t\t\tif (!existingCollectionItem)\n\t\t\t\t{\n\t\t\t\t\tif (payload.text === '')\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tstore.commit(payload.addMethodName, [payload.id.toString()]);\n\t\t\t\t}\n\n\t\t\t\tconst fields = this.validate({ draft: { text: payload.text.toString() } });\n\t\t\t\tif (fields.draft.text === existingItem.draft.text)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tdialogId: existingItem.dialogId,\n\t\t\t\t\tfields,\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function recent/delete */\n\t\t\tdelete: (store, payload: {id: string | number}) => {\n\t\t\t\tconst existingItem = store.state.collection[payload.id];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('delete', {\n\t\t\t\t\tid: existingItem.dialogId,\n\t\t\t\t});\n\t\t\t\tstore.commit('deleteFromRecentCollection', existingItem.dialogId);\n\t\t\t\tstore.commit('deleteFromCopilotCollection', existingItem.dialogId);\n\t\t\t},\n\t\t\t/** @function recent/clearUnread */\n\t\t\tclearUnread: (store) => {\n\t\t\t\tstore.commit('clearUnread');\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMutations(): MutationTree\n\t{\n\t\treturn {\n\t\t\tsetRecentCollection: (state: RecentState, payload: string[]) => {\n\t\t\t\tpayload.forEach((dialogId) => {\n\t\t\t\t\tstate.recentCollection.add(dialogId);\n\t\t\t\t});\n\t\t\t},\n\t\t\tdeleteFromRecentCollection: (state: RecentState, payload: string) => {\n\t\t\t\tstate.recentCollection.delete(payload);\n\t\t\t},\n\t\t\tsetUnreadCollection: (state: RecentState, payload: string[]) => {\n\t\t\t\tpayload.forEach((dialogId) => {\n\t\t\t\t\tstate.unreadCollection.add(dialogId);\n\t\t\t\t});\n\t\t\t},\n\t\t\tsetCopilotCollection: (state: RecentState, payload: string[]) => {\n\t\t\t\tpayload.forEach((dialogId) => {\n\t\t\t\t\tstate.copilotCollection.add(dialogId);\n\t\t\t\t});\n\t\t\t},\n\t\t\tdeleteFromCopilotCollection: (state: RecentState, payload: string) => {\n\t\t\t\tstate.copilotCollection.delete(payload);\n\t\t\t},\n\t\t\tadd: (state: RecentState, payload: Object[] | Object) => {\n\t\t\t\tif (!Array.isArray(payload) && Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\tpayload = [payload];\n\t\t\t\t}\n\t\t\t\tpayload.forEach((item) => {\n\t\t\t\t\tstate.collection[item.dialogId] = item;\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tupdate: (state: RecentState, payload: Object[] | Object) => {\n\t\t\t\tif (!Array.isArray(payload) && Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\tpayload = [payload];\n\t\t\t\t}\n\t\t\t\tpayload.forEach(({ dialogId, fields }) => {\n\t\t\t\t\t// if we already got chat - we should not update it with default user chat\n\t\t\t\t\t// (unless it's an accepted invitation)\n\t\t\t\t\tconst elementIsInRecent = state.recentCollection.has(dialogId);\n\t\t\t\t\tconst defaultUserElement = fields.options?.defaultUserRecord && !fields.invitation;\n\t\t\t\t\tif (defaultUserElement && elementIsInRecent)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst currentElement = state.collection[dialogId];\n\t\t\t\t\tfields.message = { ...currentElement.message, ...fields.message };\n\t\t\t\t\tfields.options = { ...currentElement.options, ...fields.options };\n\t\t\t\t\tstate.collection[dialogId] = {\n\t\t\t\t\t\t...currentElement,\n\t\t\t\t\t\t...fields,\n\t\t\t\t\t};\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tdelete: (state: RecentState, payload: {id: string}) => {\n\t\t\t\tdelete state.collection[payload.id];\n\t\t\t},\n\n\t\t\tclearUnread: (state: RecentState) => {\n\t\t\t\tObject.keys(state.collection).forEach((key) => {\n\t\t\t\t\tstate.collection[key].unread = false;\n\t\t\t\t});\n\t\t\t},\n\t\t};\n\t}\n\n\tvalidate(fields: Object)\n\t{\n\t\tconst result = {\n\t\t\toptions: {},\n\t\t};\n\n\t\tif (Type.isNumber(fields.id))\n\t\t{\n\t\t\tresult.dialogId = fields.id.toString();\n\t\t}\n\n\t\tif (Type.isStringFilled(fields.id))\n\t\t{\n\t\t\tresult.dialogId = fields.id;\n\t\t}\n\n\t\tif (Type.isNumber(fields.dialogId))\n\t\t{\n\t\t\tresult.dialogId = fields.dialogId.toString();\n\t\t}\n\n\t\tif (Type.isStringFilled(fields.dialogId))\n\t\t{\n\t\t\tresult.dialogId = fields.dialogId;\n\t\t}\n\n\t\tif (Type.isPlainObject(fields.message))\n\t\t{\n\t\t\tresult.message = this.prepareMessage(fields);\n\t\t}\n\n\t\tif (Type.isPlainObject(fields.draft))\n\t\t{\n\t\t\tresult.draft = this.prepareDraft(fields);\n\t\t}\n\n\t\tif (Type.isBoolean(fields.unread))\n\t\t{\n\t\t\tresult.unread = fields.unread;\n\t\t}\n\n\t\tif (Type.isBoolean(fields.pinned))\n\t\t{\n\t\t\tresult.pinned = fields.pinned;\n\t\t}\n\n\t\tif (Type.isBoolean(fields.liked))\n\t\t{\n\t\t\tresult.liked = fields.liked;\n\t\t}\n\n\t\tif (Type.isStringFilled(fields.date_update) || Type.isStringFilled(fields.dateUpdate))\n\t\t{\n\t\t\tconst date = fields.date_update || fields.dateUpdate;\n\t\t\tresult.dateUpdate = Utils.date.cast(date);\n\t\t}\n\t\telse if (Type.isDate(fields.dateUpdate))\n\t\t{\n\t\t\tresult.dateUpdate = fields.dateUpdate;\n\t\t}\n\n\t\tif (Type.isPlainObject(fields.invited))\n\t\t{\n\t\t\tresult.invitation = {\n\t\t\t\tisActive: true,\n\t\t\t\toriginator: fields.invited.originator_id,\n\t\t\t\tcanResend: fields.invited.can_resend,\n\t\t\t};\n\t\t\tresult.options.defaultUserRecord = true;\n\t\t}\n\t\telse if (fields.invited === false)\n\t\t{\n\t\t\tresult.invitation = {\n\t\t\t\tisActive: false,\n\t\t\t\toriginator: 0,\n\t\t\t\tcanResend: false,\n\t\t\t};\n\t\t\tresult.options.defaultUserRecord = true;\n\t\t}\n\n\t\tif (Type.isPlainObject(fields.options))\n\t\t{\n\t\t\tif (!result.options)\n\t\t\t{\n\t\t\t\tresult.options = {};\n\t\t\t}\n\n\t\t\tif (Type.isBoolean(fields.options.default_user_record))\n\t\t\t{\n\t\t\t\tfields.options.defaultUserRecord = fields.options.default_user_record;\n\t\t\t}\n\n\t\t\tif (Type.isBoolean(fields.options.defaultUserRecord))\n\t\t\t{\n\t\t\t\tresult.options.defaultUserRecord = fields.options.defaultUserRecord;\n\t\t\t}\n\n\t\t\tif (Type.isBoolean(fields.options.birthdayPlaceholder))\n\t\t\t{\n\t\t\t\tresult.options.birthdayPlaceholder = fields.options.birthdayPlaceholder;\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tprepareMessage(fields: Object): Object\n\t{\n\t\tconst message = {};\n\t\tconst params = {};\n\n\t\tif (\n\t\t\tType.isNumber(fields.message.id)\n\t\t\t|| Type.isStringFilled(fields.message.id)\n\t\t\t|| Utils.text.isUuidV4(fields.message.id)\n\t\t)\n\t\t{\n\t\t\tmessage.id = fields.message.id;\n\t\t}\n\n\t\tif (Type.isString(fields.message.text))\n\t\t{\n\t\t\tmessage.text = fields.message.text;\n\t\t}\n\n\t\tif (\n\t\t\tType.isStringFilled(fields.message.attach)\n\t\t\t|| Type.isBoolean(fields.message.attach)\n\t\t\t|| Type.isArray(fields.message.attach)\n\t\t)\n\t\t{\n\t\t\tparams.withAttach = fields.message.attach;\n\t\t}\n\t\telse if (\n\t\t\tType.isStringFilled(fields.message.params?.withAttach)\n\t\t\t|| Type.isBoolean(fields.message.params?.withAttach)\n\t\t\t|| Type.isArray(fields.message.params?.withAttach)\n\t\t)\n\t\t{\n\t\t\tparams.withAttach = fields.message.params.withAttach;\n\t\t}\n\n\t\tif (Type.isBoolean(fields.message.file) || Type.isPlainObject(fields.message.file))\n\t\t{\n\t\t\tparams.withFile = fields.message.file;\n\t\t}\n\t\telse if (Type.isBoolean(fields.message.params?.withFile) || Type.isPlainObject(fields.message.params?.withFile))\n\t\t{\n\t\t\tparams.withFile = fields.message.params.withFile;\n\t\t}\n\n\t\tif (Type.isDate(fields.message.date) || Type.isString(fields.message.date))\n\t\t{\n\t\t\tmessage.date = Utils.date.cast(fields.message.date);\n\t\t}\n\n\t\tif (Type.isNumber(fields.message.author_id))\n\t\t{\n\t\t\tmessage.senderId = fields.message.author_id;\n\t\t}\n\t\telse if (Type.isNumber(fields.message.authorId))\n\t\t{\n\t\t\tmessage.senderId = fields.message.authorId;\n\t\t}\n\t\telse if (Type.isNumber(fields.message.senderId))\n\t\t{\n\t\t\tmessage.senderId = fields.message.senderId;\n\t\t}\n\n\t\tif (Type.isStringFilled(fields.message.status))\n\t\t{\n\t\t\tmessage.status = fields.message.status;\n\t\t}\n\n\t\tif (Type.isBoolean(fields.message.sending))\n\t\t{\n\t\t\tmessage.sending = fields.message.sending;\n\t\t}\n\n\t\tif (Object.keys(params).length > 0)\n\t\t{\n\t\t\tmessage.params = params;\n\t\t}\n\n\t\treturn message;\n\t}\n\n\tprepareDraft(fields: Object): Object\n\t{\n\t\tconst { draft } = this.getElementState();\n\n\t\tif (Type.isString(fields.draft.text))\n\t\t{\n\t\t\tdraft.text = fields.draft.text;\n\t\t}\n\n\t\tif (Type.isStringFilled(draft.text))\n\t\t{\n\t\t\tdraft.date = new Date();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tdraft.date = null;\n\t\t}\n\n\t\treturn draft;\n\t}\n\n\tupdateUnloadedRecentCounters(payload: Array | Object)\n\t{\n\t\tthis.updateUnloadedCounters(payload, 'counters/setUnloadedChatCounters');\n\t}\n\n\tupdateUnloadedCopilotCounters(payload: Array | Object)\n\t{\n\t\tthis.updateUnloadedCounters(payload, 'counters/setUnloadedCopilotCounters');\n\t}\n\n\tupdateUnloadedCounters(payload: Array | Object, updateMethod: string)\n\t{\n\t\tif (!Array.isArray(payload) && Type.isPlainObject(payload))\n\t\t{\n\t\t\tpayload = [payload];\n\t\t}\n\t\tconst zeroedCountersForNewItems = {};\n\t\tpayload.forEach((item) => {\n\t\t\tzeroedCountersForNewItems[item.chat_id] = 0;\n\t\t});\n\t\tvoid Core.getStore().dispatch(updateMethod, zeroedCountersForNewItems);\n\t}\n}\n","import {BuilderModel} from 'ui.vue3.vuex';\nimport {Type, Text} from 'main.core';\n\nimport {Core} from 'im.v2.application.core';\nimport {Utils} from 'im.v2.lib.utils';\nimport {NotificationTypesCodes} from 'im.v2.const';\n\nimport { convertObjectKeysToCamelCase } from '../utils/format';\n\nexport class NotificationsModel extends BuilderModel\n{\n\tgetName(): string\n\t{\n\t\treturn 'notifications';\n\t}\n\n\tgetState(): Object\n\t{\n\t\treturn {\n\t\t\tcollection: new Map(),\n\t\t\tsearchCollection: new Map(),\n\t\t\tunreadCounter: 0,\n\t\t};\n\t}\n\n\tgetElementState(): Object\n\t{\n\t\treturn {\n\t\t\tid: 0,\n\t\t\tauthorId: 0,\n\t\t\tdate: new Date(),\n\t\t\ttitle: '',\n\t\t\ttext: '',\n\t\t\tparams: {},\n\t\t\treplaces: [],\n\t\t\tnotifyButtons: [],\n\t\t\tsectionCode: NotificationTypesCodes.simple,\n\t\t\tread: false,\n\t\t\tsettingName: 'im|default',\n\t\t};\n\t}\n\n\tgetGetters(): Object\n\t{\n\t\treturn {\n\t\t\tgetSortedCollection: state =>\n\t\t\t{\n\t\t\t\treturn [...state.collection.values()].sort(this.sortByType);\n\t\t\t},\n\t\t\tgetSearchResultCollection: state =>\n\t\t\t{\n\t\t\t\treturn [...state.searchCollection.values()].sort(this.sortByType);\n\t\t\t},\n\t\t\tgetConfirmsCount: state =>\n\t\t\t{\n\t\t\t\treturn [...state.collection.values()].filter(notification => {\n\t\t\t\t\treturn notification.sectionCode === NotificationTypesCodes.confirm;\n\t\t\t\t}).length;\n\t\t\t},\n\t\t\tgetById: state => (notificationId) =>\n\t\t\t{\n\t\t\t\tif (Type.isString(notificationId))\n\t\t\t\t{\n\t\t\t\t\tnotificationId = Number.parseInt(notificationId, 10);\n\t\t\t\t}\n\n\t\t\t\tconst existingItem = state.collection.get(notificationId);\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn existingItem;\n\t\t\t},\n\t\t\tgetCounter: (state): number =>\n\t\t\t{\n\t\t\t\treturn state.unreadCounter;\n\t\t\t}\n\t\t};\n\t}\n\n\tgetActions(): Object\n\t{\n\t\treturn {\n\t\t\tinitialSet: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (Type.isNumber(payload.total_unread_count))\n\t\t\t\t{\n\t\t\t\t\tstore.commit('setCounter', payload.total_unread_count);\n\t\t\t\t}\n\n\t\t\t\tif (!Type.isArrayFilled(payload.notifications))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst itemsToUpdate = [];\n\t\t\t\tconst itemsToAdd = [];\n\n\t\t\t\tconst currentUserId = Core.getUserId();\n\t\t\t\tpayload.notifications.map(element => {\n\t\t\t\t\treturn NotificationsModel.validate(element, currentUserId);\n\t\t\t\t}).forEach(element => {\n\t\t\t\t\tconst existingItem = store.state.collection.get(element.id);\n\t\t\t\t\tif (existingItem)\n\t\t\t\t\t{\n\t\t\t\t\t\titemsToUpdate.push({id: existingItem.id, fields: {...element}});\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\titemsToAdd.push({...this.getElementState(), ...element});\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tif (itemsToAdd.length > 0)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('add', itemsToAdd);\n\t\t\t\t}\n\t\t\t\tif (itemsToUpdate.length > 0)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('update', itemsToUpdate);\n\t\t\t\t}\n\t\t\t},\n\t\t\tset: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (!Array.isArray(payload) && Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\tpayload = [payload];\n\t\t\t\t}\n\n\t\t\t\tconst itemsToUpdate = [];\n\t\t\t\tconst itemsToAdd = [];\n\t\t\t\tconst currentUserId = Core.getUserId();\n\t\t\t\tpayload.map(element => {\n\t\t\t\t\treturn NotificationsModel.validate(element, currentUserId);\n\t\t\t\t}).forEach(element => {\n\t\t\t\t\tconst existingItem = store.state.collection.get(element.id);\n\t\t\t\t\tif (existingItem)\n\t\t\t\t\t\t{\n\t\t\t\t\t\titemsToUpdate.push({id: existingItem.id, fields: {...element}});\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\titemsToAdd.push({...this.getElementState(), ...element});\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tif (itemsToAdd.length > 0)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('add', itemsToAdd);\n\t\t\t\t\titemsToAdd.forEach(() => {\n\t\t\t\t\t\tstore.commit('increaseCounter');\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tif (itemsToUpdate.length > 0)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('update', itemsToUpdate);\n\t\t\t\t}\n\t\t\t},\n\t\t\tsetSearchResult: (store, payload) =>\n\t\t\t{\n\t\t\t\tconst itemsToUpdate = [];\n\t\t\t\tconst itemsToAdd = [];\n\n\t\t\t\tlet {notifications} = payload;\n\n\t\t\t\tconst skipValidation = !!payload.skipValidation;\n\t\t\t\tif (!skipValidation)\n\t\t\t\t{\n\t\t\t\t\tconst currentUserId = Core.getUserId();\n\t\t\t\t\tnotifications = notifications.map(element => {\n\t\t\t\t\t\treturn NotificationsModel.validate(element, currentUserId);\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tnotifications.forEach(element => {\n\t\t\t\t\tconst existingItem = store.state.searchCollection.get(element.id);\n\t\t\t\t\tif (existingItem)\n\t\t\t\t\t{\n\t\t\t\t\t\titemsToUpdate.push({id: existingItem.id, fields: {...element}});\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\titemsToAdd.push({...this.getElementState(), ...element});\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tif (itemsToAdd.length > 0)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('addSearchResult', itemsToAdd);\n\t\t\t\t}\n\t\t\t\tif (itemsToUpdate.length > 0)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('updateSearchResult', itemsToUpdate);\n\t\t\t\t}\n\t\t\t},\n\t\t\tread: (store, payload) =>\n\t\t\t{\n\t\t\t\tpayload.ids.forEach(notificationId => {\n\t\t\t\t\tconst existingItem = store.state.collection.get(notificationId);\n\t\t\t\t\tif (!existingItem || existingItem.read === payload.read)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (payload.read)\n\t\t\t\t\t{\n\t\t\t\t\t\tstore.commit('decreaseCounter');\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tstore.commit('increaseCounter');\n\t\t\t\t\t}\n\n\t\t\t\t\tstore.commit('read', {\n\t\t\t\t\t\tid: existingItem.id,\n\t\t\t\t\t\tread: payload.read,\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t},\n\t\t\treadAll: (store) =>\n\t\t\t{\n\t\t\t\tstore.commit('readAll');\n\t\t\t\tstore.commit('setCounter', 0);\n\t\t\t},\n\t\t\tdelete: (store, payload) =>\n\t\t\t{\n\t\t\t\tconst existingItem = store.state.collection.get(payload.id);\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (existingItem.read === false)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('decreaseCounter');\n\t\t\t\t}\n\n\t\t\t\tstore.commit('delete', {id: existingItem.id});\n\t\t\t},\n\t\t\tdeleteFromSearch: (store, payload) => {\n\t\t\t\tconst existingItem = store.state.searchCollection.get(payload.id);\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('delete', { id: existingItem.id });\n\t\t\t},\n\t\t\tclearSearchResult: (store) =>\n\t\t\t{\n\t\t\t\tstore.commit('clearSearchResult');\n\t\t\t},\n\t\t\tsetCounter: (store, payload) =>\n\t\t\t{\n\t\t\t\tstore.commit('setCounter', payload);\n\t\t\t}\n\t\t};\n\t}\n\n\tgetMutations()\n\t{\n\t\treturn {\n\t\t\tadd: (state, payload) =>\n\t\t\t{\n\t\t\t\tpayload.forEach(item => {\n\t\t\t\t\tstate.collection.set(item.id, item);\n\t\t\t\t});\n\t\t\t},\n\t\t\taddSearchResult: (state, payload) =>\n\t\t\t{\n\t\t\t\tpayload.forEach(item => {\n\t\t\t\t\tstate.searchCollection.set(item.id, item);\n\t\t\t\t});\n\t\t\t},\n\t\t\tupdate: (state, payload) =>\n\t\t\t{\n\t\t\t\tpayload.forEach(item => {\n\t\t\t\t\tstate.collection.set(item.id, {\n\t\t\t\t\t\t...state.collection.get(item.id),\n\t\t\t\t\t\t...item.fields\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t},\n\t\t\tupdateSearchResult: (state, payload) =>\n\t\t\t{\n\t\t\t\tpayload.forEach(item => {\n\t\t\t\t\tstate.searchCollection.set(item.id, {\n\t\t\t\t\t\t...state.searchCollection.get(item.id),\n\t\t\t\t\t\t...item.fields\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t},\n\t\t\tdelete: (state, payload) =>\n\t\t\t{\n\t\t\t\tstate.collection.delete(payload.id);\n\t\t\t\tstate.searchCollection.delete(payload.id);\n\t\t\t},\n\t\t\tread: (state, payload) =>\n\t\t\t{\n\t\t\t\tstate.collection.set(payload.id, {\n\t\t\t\t\t...state.collection.get(payload.id),\n\t\t\t\t\tread: payload.read\n\t\t\t\t});\n\t\t\t},\n\t\t\treadAll: (state) =>\n\t\t\t{\n\t\t\t\t[...state.collection.values()].forEach(item => {\n\t\t\t\t\tif (!item.read)\n\t\t\t\t\t{\n\t\t\t\t\t\titem.read = true;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\t\t\tsetCounter: (state, payload) =>\n\t\t\t{\n\t\t\t\tstate.unreadCounter = Number.parseInt(payload, 10);\n\t\t\t},\n\t\t\tdecreaseCounter: (state) =>\n\t\t\t{\n\t\t\t\tif (state.unreadCounter > 0)\n\t\t\t\t{\n\t\t\t\t\tstate.unreadCounter--;\n\t\t\t\t}\n\t\t\t},\n\t\t\tincreaseCounter: (state) =>\n\t\t\t{\n\t\t\t\tstate.unreadCounter++;\n\t\t\t},\n\t\t\tclearSearchResult: (state) =>\n\t\t\t{\n\t\t\t\tstate.searchCollection.clear();\n\t\t\t}\n\t\t};\n\t}\n\n\tstatic validate(fields: Object)\n\t{\n\t\tconst result = {};\n\n\t\tif (Type.isString(fields.id) || Type.isNumber(fields.id))\n\t\t{\n\t\t\tresult.id = fields.id;\n\t\t}\n\n\t\tif (Type.isNumber(fields.author_id))\n\t\t{\n\t\t\tresult.authorId = fields.author_id;\n\t\t}\n\t\telse if (Type.isNumber(fields.userId))\n\t\t{\n\t\t\tresult.authorId = fields.userId;\n\t\t}\n\n\t\tif (!Type.isNil(fields.date))\n\t\t{\n\t\t\tresult.date = Utils.date.cast(fields.date);\n\t\t}\n\n\t\tif (Type.isString(fields.notify_title))\n\t\t{\n\t\t\tresult.title = fields.notify_title;\n\t\t}\n\t\telse if (Type.isString(fields.title))\n\t\t{\n\t\t\tresult.title = fields.title;\n\t\t}\n\n\t\tif (Type.isString(fields.text) || Type.isNumber(fields.text))\n\t\t{\n\t\t\tresult.text = Text.decode(fields.text.toString());\n\t\t}\n\n\t\tif (Type.isObjectLike(fields.params))\n\t\t{\n\t\t\tresult.params = convertObjectKeysToCamelCase(fields.params);\n\t\t}\n\n\t\tif (Type.isArray(fields.replaces))\n\t\t{\n\t\t\tresult.replaces = fields.replaces;\n\t\t}\n\n\t\tif (!Type.isNil(fields.notify_buttons))\n\t\t{\n\t\t\tresult.notifyButtons = JSON.parse(fields.notify_buttons);\n\t\t}\n\t\telse if (!Type.isNil(fields.buttons))\n\t\t{\n\t\t\tresult.notifyButtons = fields.buttons.map(button => {\n\t\t\t\treturn {\n\t\t\t\t\tCOMMAND: 'notifyConfirm',\n\t\t\t\t\tCOMMAND_PARAMS: `${result.id}|${button.VALUE}`,\n\t\t\t\t\tTEXT: `${button.TITLE}`,\n\t\t\t\t\tTYPE: 'BUTTON',\n\t\t\t\t\tDISPLAY: 'LINE',\n\t\t\t\t\tBG_COLOR: (button.VALUE === 'Y' ? '#8bc84b' : '#ef4b57'),\n\t\t\t\t\tTEXT_COLOR: '#fff',\n\t\t\t\t};\n\t\t\t});\n\t\t}\n\n\t\tif (fields.notify_type === NotificationTypesCodes.confirm || fields.type === NotificationTypesCodes.confirm)\n\t\t{\n\t\t\tresult.sectionCode = NotificationTypesCodes.confirm;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tresult.sectionCode = NotificationTypesCodes.simple;\n\t\t}\n\n\t\tif (!Type.isNil(fields.notify_read))\n\t\t{\n\t\t\tresult.read = fields.notify_read === 'Y';\n\t\t}\n\t\telse if (!Type.isNil(fields.read))\n\t\t{\n\t\t\tresult.read = fields.read === 'Y';\n\t\t}\n\n\t\tif (Type.isString(fields.setting_name))\n\t\t{\n\t\t\tresult.settingName = fields.setting_name;\n\t\t}\n\t\telse if (Type.isString(fields.settingName))\n\t\t{\n\t\t\tresult.settingName = fields.settingName;\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tsortByType(a, b)\n\t{\n\t\tif (a.sectionCode === NotificationTypesCodes.confirm && b.sectionCode !== NotificationTypesCodes.confirm)\n\t\t{\n\t\t\treturn -1;\n\t\t}\n\t\telse if (a.sectionCode !== NotificationTypesCodes.confirm && b.sectionCode === NotificationTypesCodes.confirm)\n\t\t{\n\t\t\treturn 1;\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn b.id - a.id;\n\t\t}\n\t}\n}\n","import {BuilderModel} from 'ui.vue3.vuex';\nimport {Type} from 'main.core';\n\nimport {Utils} from 'im.v2.lib.utils';\n\nimport type {ImModelSidebarLinkItem} from '../../registry';\n\ntype LinksState = {\n\tcollection: {[chatId: number]: Map<number, ImModelSidebarLinkItem>},\n\tcounters: {[chatId: number]: number},\n};\n\nexport class LinksModel extends BuilderModel\n{\n\tgetState(): LinksState\n\t{\n\t\treturn {\n\t\t\tcollection: {},\n\t\t\tcounters: {}\n\t\t};\n\t}\n\n\tgetGetters()\n\t{\n\t\treturn {\n\t\t\tget: (state) => (chatId: number): ImModelSidebarLinkItem[] => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\treturn [...state.collection[chatId].values()].sort((a, b) => b.id - a.id);\n\t\t\t},\n\t\t\tgetSize: (state) => (chatId: number): number => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[chatId].size;\n\t\t\t},\n\t\t\tgetCounter: (state) => (chatId: number): number => {\n\t\t\t\tif (!state.counters[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn state.counters[chatId];\n\t\t\t}\n\t\t};\n\t}\n\n\tgetElementState(): ImModelSidebarLinkItem\n\t{\n\t\treturn {\n\t\t\tid: 0,\n\t\t\tmessageId: 0,\n\t\t\tchatId: 0,\n\t\t\tauthorId: 0,\n\t\t\tsource: '',\n\t\t\tdate: new Date(),\n\t\t\trichData: {\n\t\t\t\tid: null,\n\t\t\t\tdescription: null,\n\t\t\t\tlink: null,\n\t\t\t\tname: null,\n\t\t\t\tpreviewUrl: null,\n\t\t\t\ttype: null,\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions(): Object\n\t{\n\t\treturn {\n\t\t\tsetCounter: (store, payload) => {\n\t\t\t\tif (!Type.isNumber(payload.counter) || !Type.isNumber(payload.chatId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setCounter', payload);\n\t\t\t},\n\t\t\tset: (store, payload) => {\n\t\t\t\tconst {chatId, links} = payload;\n\t\t\t\tif (!Type.isArrayFilled(links) || !Type.isNumber(chatId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!store.state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\tstore.state.collection[chatId] = new Map();\n\t\t\t\t}\n\n\t\t\t\tlinks.forEach(link => {\n\t\t\t\t\tconst preparedLink = {...this.getElementState(), ...this.validate(link)};\n\t\t\t\t\tstore.commit('add', {chatId, link: preparedLink});\n\t\t\t\t});\n\t\t\t},\n\t\t\tdelete: (store, payload) => {\n\t\t\t\tconst {chatId, id} = payload;\n\t\t\t\tif (!Type.isNumber(id) || !Type.isNumber(chatId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!store.state.collection[chatId] || !store.state.collection[chatId].has(id))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('delete', {chatId, id});\n\t\t\t}\n\t\t};\n\t}\n\n\tgetMutations(): Object\n\t{\n\t\treturn {\n\t\t\tsetCounter: (state, payload) => {\n\t\t\t\tconst {chatId, counter} = payload;\n\t\t\t\tstate.counters[chatId] = counter;\n\t\t\t},\n\t\t\tadd: (state, payload: {chatId: number, link: ImModelSidebarLinkItem}) => {\n\t\t\t\tconst {chatId, link} = payload;\n\t\t\t\tstate.collection[chatId].set(link.id, link);\n\t\t\t},\n\t\t\tdelete: (state, payload: {chatId: number, id: number}) => {\n\t\t\t\tconst {chatId, id} = payload;\n\t\t\t\tstate.collection[chatId].delete(id);\n\t\t\t\tstate.counters[chatId]--;\n\t\t\t}\n\t\t};\n\t}\n\n\tvalidate(fields: Object): ImModelSidebarLinkItem\n\t{\n\t\tconst result = {\n\t\t\trichData: {}\n\t\t};\n\n\t\tif (Type.isNumber(fields.id))\n\t\t{\n\t\t\tresult.id = fields.id;\n\t\t}\n\n\t\tif (Type.isNumber(fields.messageId))\n\t\t{\n\t\t\tresult.messageId = fields.messageId;\n\t\t}\n\n\t\tif (Type.isNumber(fields.chatId))\n\t\t{\n\t\t\tresult.chatId = fields.chatId;\n\t\t}\n\n\t\tif (Type.isNumber(fields.authorId))\n\t\t{\n\t\t\tresult.authorId = fields.authorId;\n\t\t}\n\n\t\tif (Type.isString(fields.url.source))\n\t\t{\n\t\t\tresult.source = fields.url.source;\n\t\t}\n\n\t\tif (Type.isString(fields.dateCreate))\n\t\t{\n\t\t\tresult.date = Utils.date.cast(fields.dateCreate);\n\t\t}\n\n\t\tif (Type.isPlainObject(fields.url.richData))\n\t\t{\n\t\t\tresult.richData = this.validateRichData(fields.url.richData);\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tvalidateRichData(richData: Object): Object\n\t{\n\t\tconst result = {};\n\n\t\tif (Type.isNumber(richData.id))\n\t\t{\n\t\t\tresult.id = richData.id;\n\t\t}\n\n\t\tif (Type.isString(richData.description))\n\t\t{\n\t\t\tresult.description = richData.description;\n\t\t}\n\n\t\tif (Type.isString(richData.link))\n\t\t{\n\t\t\tresult.link = richData.link;\n\t\t}\n\n\t\tif (Type.isString(richData.name))\n\t\t{\n\t\t\tresult.name = richData.name;\n\t\t}\n\n\t\tif (Type.isString(richData.previewUrl))\n\t\t{\n\t\t\tresult.previewUrl = richData.previewUrl;\n\t\t}\n\n\t\tif (Type.isString(richData.type))\n\t\t{\n\t\t\tresult.type = richData.type;\n\t\t}\n\n\t\treturn result;\n\t}\n}","import {Type} from 'main.core';\nimport {BuilderModel} from 'ui.vue3.vuex';\n\nimport {Utils} from 'im.v2.lib.utils';\n\nimport type {ImModelSidebarFavoriteItem} from '../../registry';\n\ntype FavoritesState = {\n\tcollection: {[chatId: number]: Map<number, ImModelSidebarFavoriteItem>},\n\tcounters: {[chatId: number]: number},\n};\n\nexport class FavoritesModel extends BuilderModel\n{\n\tgetState(): FavoritesState\n\t{\n\t\treturn {\n\t\t\tcollection: {},\n\t\t\tcounters: {},\n\t\t};\n\t}\n\n\tgetElementState(): ImModelSidebarFavoriteItem\n\t{\n\t\treturn {\n\t\t\tid: 0,\n\t\t\tmessageId: 0,\n\t\t\tchatId: 0,\n\t\t\tauthorId: 0,\n\t\t\tdate: new Date(),\n\t\t};\n\t}\n\n\tgetGetters(): Object\n\t{\n\t\treturn {\n\t\t\tget: (state) => (chatId: number): ImModelSidebarFavoriteItem[] => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\treturn [...state.collection[chatId].values()].sort((a, b) => b.id - a.id);\n\t\t\t},\n\t\t\tgetSize: (state) => (chatId: number): number => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[chatId].size;\n\t\t\t},\n\t\t\tgetCounter: (state) => (chatId: number): number => {\n\t\t\t\tif (state.counters[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn state.counters[chatId];\n\t\t\t\t}\n\n\t\t\t\treturn 0;\n\t\t\t},\n\t\t\tisFavoriteMessage: (state) => (chatId: number, messageId: number): boolean => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst chatFavorites = Object.fromEntries(state.collection[chatId]);\n\t\t\t\tconst targetMessage = Object.values(chatFavorites).find(element => element.messageId === messageId);\n\n\t\t\t\treturn !!targetMessage;\n\t\t\t}\n\t\t};\n\t}\n\n\tgetActions(): Object\n\t{\n\t\treturn {\n\t\t\tsetCounter: (store, payload) => {\n\t\t\t\tif (!Type.isNumber(payload.counter) || !Type.isNumber(payload.chatId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setCounter', payload);\n\t\t\t},\n\t\t\tset: (store, payload) => {\n\t\t\t\tif (Type.isNumber(payload.favorites))\n\t\t\t\t{\n\t\t\t\t\tpayload.favorites = [payload.favorites];\n\t\t\t\t}\n\t\t\t\tconst {chatId, favorites} = payload;\n\n\t\t\t\tif (!Type.isArrayFilled(favorites) || !Type.isNumber(chatId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!store.state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\tstore.state.collection[chatId] = new Map();\n\t\t\t\t}\n\n\t\t\t\tfavorites.forEach(favorite => {\n\t\t\t\t\tconst preparedFavoriteMessage = {...this.getElementState(), ...this.validate(favorite)};\n\t\t\t\t\tstore.commit('add', {chatId, favorite: preparedFavoriteMessage});\n\t\t\t\t});\n\t\t\t},\n\t\t\tdelete: (store, payload) => {\n\t\t\t\tconst {chatId, id} = payload;\n\t\t\t\tif (!Type.isNumber(id) || !Type.isNumber(chatId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!store.state.collection[chatId] || !store.state.collection[chatId].has(id))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('delete', {chatId, id});\n\t\t\t},\n\t\t\tdeleteByMessageId: (store, payload: {chatId: number, messageId: number}) => {\n\t\t\t\tconst {chatId, messageId} = payload;\n\t\t\t\tif (!store.state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst chatCollection = store.state.collection[chatId];\n\t\t\t\tlet targetLinkId = null;\n\t\t\t\tfor (const [linkId, linkObject] of chatCollection)\n\t\t\t\t{\n\t\t\t\t\tif (linkObject.messageId === messageId)\n\t\t\t\t\t{\n\t\t\t\t\t\ttargetLinkId = linkId;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (!targetLinkId)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('delete', {chatId, id: targetLinkId});\n\t\t\t}\n\t\t};\n\t}\n\n\tgetMutations(): Object\n\t{\n\t\treturn {\n\t\t\tsetCounter: (state, payload) => {\n\t\t\t\tconst {chatId, counter} = payload;\n\t\t\t\tstate.counters[chatId] = counter;\n\t\t\t},\n\t\t\tadd: (state, payload: {chatId: number, favorite: ImModelSidebarFavoriteItem}) => {\n\t\t\t\tconst {chatId, favorite} = payload;\n\t\t\t\tstate.collection[chatId].set(favorite.id, favorite);\n\t\t\t},\n\t\t\tdelete: (state, payload: {chatId: number, id: number}) => {\n\t\t\t\tconst {chatId, id} = payload;\n\t\t\t\tstate.collection[chatId].delete(id);\n\t\t\t\tstate.counters[chatId]--;\n\t\t\t}\n\t\t};\n\t}\n\n\tvalidate(fields: Object): ImModelSidebarFavoriteItem\n\t{\n\t\tconst result = {};\n\n\t\tif (Type.isNumber(fields.id))\n\t\t{\n\t\t\tresult.id = fields.id;\n\t\t}\n\n\t\tif (Type.isNumber(fields.messageId))\n\t\t{\n\t\t\tresult.messageId = fields.messageId;\n\t\t}\n\n\t\tif (Type.isNumber(fields.chatId))\n\t\t{\n\t\t\tresult.chatId = fields.chatId;\n\t\t}\n\n\t\tif (Type.isNumber(fields.authorId))\n\t\t{\n\t\t\tresult.authorId = fields.authorId;\n\t\t}\n\n\t\tif (Type.isString(fields.dateCreate))\n\t\t{\n\t\t\tresult.date = Utils.date.cast(fields.dateCreate);\n\t\t}\n\n\t\treturn result;\n\t}\n}\n","import {Type} from 'main.core';\nimport {BuilderModel} from 'ui.vue3.vuex';\n\ntype MembersState = {\n\tcollection: {[chatId: number]: Set<number>},\n};\n\nexport class MembersModel extends BuilderModel\n{\n\tgetState(): MembersState\n\t{\n\t\treturn {\n\t\t\tcollection: {},\n\t\t};\n\t}\n\n\tgetGetters()\n\t{\n\t\treturn {\n\t\t\tget: (state) => (chatId: number): Array =>\n\t\t\t{\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\treturn [...state.collection[chatId]];\n\t\t\t},\n\t\t\tgetSize: (state) => (chatId: number): number => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[chatId].size;\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions(): Object\n\t{\n\t\treturn {\n\t\t\tset: (store, payload) =>\n\t\t\t{\n\t\t\t\tconst {chatId, users} = payload;\n\t\t\t\tif (!Type.isArray(users) || !Type.isNumber(chatId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (users.length > 0)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('set', {chatId, users});\n\t\t\t\t}\n\t\t\t},\n\t\t\tdelete: (store, payload) => {\n\t\t\t\tconst {chatId, userId} = payload;\n\t\t\t\tif (!Type.isNumber(chatId) || !Type.isNumber(userId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!store.state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('delete', {userId, chatId});\n\t\t\t}\n\t\t};\n\t}\n\n\tgetMutations(): Object\n\t{\n\t\treturn {\n\t\t\tset: (state, payload) =>\n\t\t\t{\n\t\t\t\tif (!state.collection[payload.chatId])\n\t\t\t\t{\n\t\t\t\t\tstate.collection[payload.chatId] = new Set(payload.users);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tpayload.users.forEach(id => {\n\t\t\t\t\t\tstate.collection[payload.chatId].add(id);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t},\n\t\t\tdelete: (state, payload: {chatId: number, userId: number}) => {\n\t\t\t\tconst {chatId, userId} = payload;\n\t\t\t\tstate.collection[chatId].delete(userId);\n\t\t\t}\n\t\t};\n\t}\n}","import {BuilderModel} from 'ui.vue3.vuex';\nimport {Type} from 'main.core';\n\nimport {Utils} from 'im.v2.lib.utils';\n\nimport type {ImModelSidebarTaskItem} from '../../registry';\n\ntype TasksState = {\n\tcollection: {[chatId: number]: Map<number, ImModelSidebarTaskItem>},\n};\n\nexport class TasksModel extends BuilderModel\n{\n\tgetState(): TasksState\n\t{\n\t\treturn {\n\t\t\tcollection: {},\n\t\t};\n\t}\n\n\tgetElementState(): ImModelSidebarTaskItem\n\t{\n\t\treturn {\n\t\t\tid: 0,\n\t\t\tmessageId: 0,\n\t\t\tchatId: 0,\n\t\t\tauthorId: 0,\n\t\t\tdate: new Date(),\n\t\t\ttask: {\n\t\t\t\tid: 0,\n\t\t\t\ttitle: '',\n\t\t\t\tcreatorId: 0,\n\t\t\t\tresponsibleId: 0,\n\t\t\t\tstatus: 0,\n\t\t\t\tstatusTitle: '',\n\t\t\t\tdeadline: new Date(),\n\t\t\t\tstate: '',\n\t\t\t\tcolor: '',\n\t\t\t\tsource: ''\n\t\t\t}\n\t\t};\n\t}\n\n\tgetGetters(): Object\n\t{\n\t\treturn {\n\t\t\tget: (state) => (chatId: number): ImModelSidebarTaskItem[] => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\treturn [...state.collection[chatId].values()].sort((a, b) => b.id - a.id);\n\t\t\t},\n\t\t\tgetSize: (state) => (chatId: number): number => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[chatId].size;\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions(): Object\n\t{\n\t\treturn {\n\t\t\tset: (store, payload) => {\n\t\t\t\tconst {chatId, tasks} = payload;\n\t\t\t\tif (!Type.isArrayFilled(tasks) || !Type.isNumber(chatId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!store.state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\tstore.state.collection[chatId] = new Map();\n\t\t\t\t}\n\n\t\t\t\ttasks.forEach(task => {\n\t\t\t\t\tconst preparedTask = {...this.getElementState(), ...this.validate(task)};\n\t\t\t\t\tstore.commit('add', {chatId, task: preparedTask});\n\t\t\t\t});\n\t\t\t},\n\t\t\tdelete: (store, payload) => {\n\t\t\t\tconst {chatId, id} = payload;\n\t\t\t\tif (!Type.isNumber(chatId) || !Type.isNumber(id))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!store.state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('delete', {id, chatId});\n\t\t\t}\n\t\t};\n\t}\n\n\tgetMutations(): Object\n\t{\n\t\treturn {\n\t\t\tadd: (state, payload: {chatId: number, task: ImModelSidebarTaskItem}) => {\n\t\t\t\tconst {chatId, task} = payload;\n\t\t\t\tstate.collection[chatId].set(task.id, task);\n\t\t\t},\n\t\t\tdelete: (state, payload: {id: number, chatId: number}) => {\n\t\t\t\tconst {id, chatId} = payload;\n\t\t\t\tstate.collection[chatId].delete(id);\n\t\t\t}\n\t\t};\n\t}\n\n\tvalidate(fields: Object): ImModelSidebarTaskItem\n\t{\n\t\tconst result = {\n\t\t\ttask: {}\n\t\t};\n\n\t\tif (Type.isNumber(fields.id))\n\t\t{\n\t\t\tresult.id = fields.id;\n\t\t}\n\n\t\tif (Type.isNumber(fields.messageId))\n\t\t{\n\t\t\tresult.messageId = fields.messageId;\n\t\t}\n\n\t\tif (Type.isNumber(fields.chatId))\n\t\t{\n\t\t\tresult.chatId = fields.chatId;\n\t\t}\n\n\t\tif (Type.isNumber(fields.authorId))\n\t\t{\n\t\t\tresult.authorId = fields.authorId;\n\t\t}\n\n\t\tif (Type.isString(fields.dateCreate))\n\t\t{\n\t\t\tresult.date = Utils.date.cast(fields.dateCreate);\n\t\t}\n\n\t\tif (Type.isPlainObject(fields.task))\n\t\t{\n\t\t\tresult.task = this.validateTask(fields.task);\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tvalidateTask(task)\n\t{\n\t\tconst result = {};\n\n\t\tif (Type.isNumber(task.id))\n\t\t{\n\t\t\tresult.id = task.id;\n\t\t}\n\n\t\tif (Type.isString(task.title))\n\t\t{\n\t\t\tresult.title = task.title;\n\t\t}\n\n\t\tif (Type.isNumber(task.creatorId))\n\t\t{\n\t\t\tresult.creatorId = task.creatorId;\n\t\t}\n\n\t\tif (Type.isNumber(task.responsibleId))\n\t\t{\n\t\t\tresult.responsibleId = task.responsibleId;\n\t\t}\n\n\t\tif (Type.isNumber(task.status))\n\t\t{\n\t\t\tresult.status = task.status;\n\t\t}\n\n\t\tif (Type.isString(task.statusTitle))\n\t\t{\n\t\t\tresult.statusTitle = task.statusTitle;\n\t\t}\n\n\t\tif (Type.isString(task.deadline))\n\t\t{\n\t\t\tresult.deadline = Utils.date.cast(task.deadline);\n\t\t}\n\n\t\tif (Type.isString(task.state))\n\t\t{\n\t\t\tresult.state = task.state;\n\t\t}\n\n\t\tif (Type.isString(task.color))\n\t\t{\n\t\t\tresult.color = task.color;\n\t\t}\n\n\t\tif (Type.isString(task.source))\n\t\t{\n\t\t\tresult.source = task.source;\n\t\t}\n\n\t\treturn result;\n\t}\n}\n","import {Type} from 'main.core';\nimport {BuilderModel} from 'ui.vue3.vuex';\n\nimport {Utils} from 'im.v2.lib.utils';\n\nimport type {ImModelSidebarMeetingItem} from '../../registry';\n\ntype MeetingsState = {\n\tcollection: {[chatId: number]: Map<number, ImModelSidebarMeetingItem>},\n};\n\nexport class MeetingsModel extends BuilderModel\n{\n\tgetState(): MeetingsState\n\t{\n\t\treturn {\n\t\t\tcollection: {},\n\t\t};\n\t}\n\n\tgetElementState(): ImModelSidebarMeetingItem\n\t{\n\t\treturn {\n\t\t\tid: 0,\n\t\t\tmessageId: 0,\n\t\t\tchatId: 0,\n\t\t\tauthorId: 0,\n\t\t\tdate: new Date(),\n\t\t\tmeeting: {\n\t\t\t\tid: 0,\n\t\t\t\ttitle: '',\n\t\t\t\tdateFrom: new Date(),\n\t\t\t\tdateTo: new Date(),\n\t\t\t\tsource: ''\n\t\t\t}\n\t\t};\n\t}\n\n\tgetGetters(): Object\n\t{\n\t\treturn {\n\t\t\tget: (state) => (chatId: number): ImModelSidebarMeetingItem[] => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\treturn [...state.collection[chatId].values()].sort((a, b) => b.id - a.id);\n\t\t\t},\n\t\t\tgetSize: (state) => (chatId: string): number => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[chatId].size;\n\t\t\t}\n\t\t};\n\t}\n\n\tgetActions(): Object\n\t{\n\t\treturn {\n\t\t\tset: (store, payload) => {\n\t\t\t\tconst {chatId, meetings} = payload;\n\t\t\t\tif (!Type.isArrayFilled(meetings) || !Type.isNumber(chatId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!store.state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\tstore.state.collection[chatId] = new Map();\n\t\t\t\t}\n\n\t\t\t\tmeetings.forEach(meeting => {\n\t\t\t\t\tconst preparedMeeting = {...this.getElementState(), ...this.validate(meeting)};\n\t\t\t\t\tstore.commit('add', {chatId, meeting: preparedMeeting});\n\t\t\t\t});\n\t\t\t},\n\t\t\tdelete: (store, payload) => {\n\t\t\t\tconst {chatId, id} = payload;\n\t\t\t\tif (!Type.isNumber(chatId) || !Type.isNumber(id))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!store.state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('delete', {id, chatId});\n\t\t\t}\n\t\t};\n\t}\n\n\tgetMutations(): Object\n\t{\n\t\treturn {\n\t\t\tadd: (state, payload: {chatId: number, meeting: ImModelSidebarMeetingItem}) => {\n\t\t\t\tconst {chatId, meeting} = payload;\n\t\t\t\tstate.collection[chatId].set(meeting.id, meeting);\n\t\t\t},\n\t\t\tdelete: (state, payload: {id: number, chatId: number}) => {\n\t\t\t\tconst {id, chatId} = payload;\n\t\t\t\tstate.collection[chatId].delete(id);\n\t\t\t}\n\t\t};\n\t}\n\n\tvalidate(fields: Object): ImModelSidebarMeetingItem\n\t{\n\t\tconst result = {\n\t\t\tmeeting: {}\n\t\t};\n\n\t\tif (Type.isNumber(fields.id))\n\t\t{\n\t\t\tresult.id = fields.id;\n\t\t}\n\n\t\tif (Type.isNumber(fields.messageId))\n\t\t{\n\t\t\tresult.messageId = fields.messageId;\n\t\t}\n\n\t\tif (Type.isNumber(fields.chatId))\n\t\t{\n\t\t\tresult.chatId = fields.chatId;\n\t\t}\n\n\t\tif (Type.isNumber(fields.authorId))\n\t\t{\n\t\t\tresult.authorId = fields.authorId;\n\t\t}\n\n\t\tif (Type.isString(fields.dateCreate))\n\t\t{\n\t\t\tresult.date = Utils.date.cast(fields.dateCreate);\n\t\t}\n\n\t\tif (Type.isPlainObject(fields.calendar))\n\t\t{\n\t\t\tresult.meeting = this.validateMeeting(fields.calendar);\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tvalidateMeeting(meeting)\n\t{\n\t\tconst result = {};\n\n\t\tif (Type.isNumber(meeting.id))\n\t\t{\n\t\t\tresult.id = meeting.id;\n\t\t}\n\n\t\tif (Type.isString(meeting.title))\n\t\t{\n\t\t\tresult.title = meeting.title;\n\t\t}\n\n\t\tif (Type.isString(meeting.dateFrom))\n\t\t{\n\t\t\tresult.dateFrom = Utils.date.cast(meeting.dateFrom);\n\t\t}\n\n\t\tif (Type.isString(meeting.dateTo))\n\t\t{\n\t\t\tresult.dateTo = Utils.date.cast(meeting.dateTo);\n\t\t}\n\n\t\tif (Type.isString(meeting.source))\n\t\t{\n\t\t\tresult.source = meeting.source;\n\t\t}\n\n\t\treturn result;\n\t}\n}\n","import {Type} from 'main.core';\nimport {BuilderModel} from 'ui.vue3.vuex';\n\nimport {SidebarFileTypes} from 'im.v2.const';\nimport {Utils} from 'im.v2.lib.utils';\n\nimport type {ImModelSidebarFileItem} from '../../registry';\n\ntype FilesState = {\n\tcollection: {\n\t\t[chatId: number]: {\n\t\t\t[SidebarFileTypes: string]: Map<number, ImModelSidebarFileItem>\n\t\t}\n\t},\n};\n\nexport class FilesModel extends BuilderModel\n{\n\tgetState(): FilesState\n\t{\n\t\treturn {\n\t\t\tcollection: {},\n\t\t};\n\t}\n\n\tgetElementState(): ImModelSidebarFileItem\n\t{\n\t\treturn {\n\t\t\tid: 0,\n\t\t\tmessageId: 0,\n\t\t\tchatId: 0,\n\t\t\tauthorId: 0,\n\t\t\tdate: new Date(),\n\t\t\tfileId: 0,\n\t\t};\n\t}\n\n\tgetGetters(): Object\n\t{\n\t\treturn {\n\t\t\tget: (state) => (chatId: number, subType: string): ImModelSidebarFileItem[] => {\n\t\t\t\tif (!state.collection[chatId] || !state.collection[chatId][subType])\n\t\t\t\t{\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\treturn [...state.collection[chatId][subType].values()].sort((a, b) => b.id - a.id);\n\t\t\t},\n\n\t\t\tgetLatest: (state, getters, rootState, rootGetters) => (chatId: number): ImModelSidebarFileItem[] => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\tlet media = [];\n\t\t\t\tlet audio = [];\n\t\t\t\tlet documents = [];\n\t\t\t\tlet other = [];\n\n\t\t\t\tif (state.collection[chatId][SidebarFileTypes.media])\n\t\t\t\t{\n\t\t\t\t\tmedia = [...state.collection[chatId][SidebarFileTypes.media].values()];\n\t\t\t\t}\n\t\t\t\tif (state.collection[chatId][SidebarFileTypes.audio])\n\t\t\t\t{\n\t\t\t\t\taudio = [...state.collection[chatId][SidebarFileTypes.audio].values()];\n\t\t\t\t}\n\t\t\t\tif (state.collection[chatId][SidebarFileTypes.document])\n\t\t\t\t{\n\t\t\t\t\tdocuments = [...state.collection[chatId][SidebarFileTypes.document].values()];\n\t\t\t\t}\n\t\t\t\tif (state.collection[chatId][SidebarFileTypes.other])\n\t\t\t\t{\n\t\t\t\t\tother = [...state.collection[chatId][SidebarFileTypes.other].values()];\n\t\t\t\t}\n\n\t\t\t\tconst sortedFlatCollection = [media, audio, documents, other]\n\t\t\t\t\t.flat()\n\t\t\t\t\t.sort((a, b) => b.id - a.id)\n\t\t\t\t;\n\n\t\t\t\treturn this.getTopThreeCompletedFiles(sortedFlatCollection, rootGetters);\n\t\t\t},\n\t\t\tgetLatestUnsorted: (state, getters, rootState, rootGetters) => (chatId: number): ImModelSidebarFileItem[] => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\tlet unsorted = [];\n\n\t\t\t\tif (state.collection[chatId][SidebarFileTypes.fileUnsorted])\n\t\t\t\t{\n\t\t\t\t\tunsorted = [...state.collection[chatId][SidebarFileTypes.fileUnsorted].values()];\n\t\t\t\t}\n\n\t\t\t\tconst sortedCollection = unsorted.sort((a, b) => b.id - a.id);\n\n\t\t\t\treturn this.getTopThreeCompletedFiles(sortedCollection, rootGetters);\n\t\t\t},\n\t\t\tgetSize: (state) => (chatId: string, subType: string): number => {\n\t\t\t\tif (!state.collection[chatId] || !state.collection[chatId][subType])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[chatId][subType].size;\n\t\t\t}\n\t\t};\n\t}\n\n\tgetActions(): Object\n\t{\n\t\treturn {\n\t\t\tset: (store, payload) => {\n\t\t\t\tconst {chatId, files} = payload;\n\t\t\t\tif (!Type.isArrayFilled(files) || !Type.isNumber(chatId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!store.state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\tstore.state.collection[chatId] = {};\n\t\t\t\t}\n\n\t\t\t\tfiles.forEach(file => {\n\t\t\t\t\tconst preparedFile = {...this.getElementState(), ...this.validate(file)};\n\t\t\t\t\tconst {subType} = file;\n\t\t\t\t\tstore.commit('add', {chatId, subType, file: preparedFile});\n\t\t\t\t});\n\t\t\t},\n\t\t\tdelete: (store, payload) => {\n\t\t\t\tconst {chatId, id} = payload;\n\t\t\t\tif (!Type.isNumber(id) || !Type.isNumber(chatId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!store.state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('delete', {chatId, id});\n\t\t\t}\n\t\t};\n\t}\n\n\tgetMutations(): Object\n\t{\n\t\treturn {\n\t\t\tadd: (state, payload: {chatId: number, subType: string, file: ImModelSidebarFileItem}) => {\n\t\t\t\tconst {chatId, file, subType} = payload;\n\t\t\t\tif (!state.collection[chatId][subType])\n\t\t\t\t{\n\t\t\t\t\tstate.collection[chatId][subType] = new Map();\n\t\t\t\t}\n\t\t\t\tstate.collection[chatId][subType].set(file.id, file);\n\t\t\t},\n\t\t\tdelete: (state, payload: {chatId: number, id: number}) => {\n\t\t\t\tconst {chatId, id} = payload;\n\n\t\t\t\tObject.values(SidebarFileTypes).forEach(subType => {\n\t\t\t\t\tif (state.collection[chatId][subType] && state.collection[chatId][subType].has(id))\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.collection[chatId][subType].delete(id);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\t}\n\n\tvalidate(fields: Object): ImModelSidebarFileItem\n\t{\n\t\tconst result = {};\n\n\t\tif (Type.isNumber(fields.id))\n\t\t{\n\t\t\tresult.id = fields.id;\n\t\t}\n\n\t\tif (Type.isNumber(fields.messageId))\n\t\t{\n\t\t\tresult.messageId = fields.messageId;\n\t\t}\n\n\t\tif (Type.isNumber(fields.chatId))\n\t\t{\n\t\t\tresult.chatId = fields.chatId;\n\t\t}\n\n\t\tif (Type.isNumber(fields.authorId))\n\t\t{\n\t\t\tresult.authorId = fields.authorId;\n\t\t}\n\n\t\tif (Type.isString(fields.dateCreate))\n\t\t{\n\t\t\tresult.date = Utils.date.cast(fields.dateCreate);\n\t\t}\n\t\telse if (Type.isString(fields.date))\n\t\t{\n\t\t\tresult.date = Utils.date.cast(fields.date);\n\t\t}\n\n\t\tresult.fileId = Type.isNumber(fields.fileId) ? fields.fileId : result.id;\n\n\t\treturn result;\n\t}\n\n\tgetTopThreeCompletedFiles(collection: ImModelSidebarFileItem[], rootGetters): ImModelSidebarFileItem[]\n\t{\n\t\treturn collection.filter((sidebarFile: ImModelSidebarFileItem) => {\n\t\t\tconst file = rootGetters['files/get'](sidebarFile.fileId, true);\n\n\t\t\treturn file.progress === 100;\n\t\t}).slice(0, 3);\n\t}\n}\n","import {BuilderModel} from 'ui.vue3.vuex';\nimport {Type} from 'main.core';\nimport {LinksModel} from './nested-modules/links';\nimport {FavoritesModel} from './nested-modules/favorites';\nimport {MembersModel} from './nested-modules/members';\nimport {TasksModel} from './nested-modules/tasks';\nimport {MeetingsModel} from './nested-modules/meeting';\nimport {FilesModel} from './nested-modules/files';\n\nexport class SidebarModel extends BuilderModel\n{\n\tgetName(): string\n\t{\n\t\treturn 'sidebar';\n\t}\n\n\tgetNestedModules(): { [moduleName: string]: BuilderModel }\n\t{\n\t\treturn {\n\t\t\tmembers: MembersModel,\n\t\t\tlinks: LinksModel,\n\t\t\tfavorites: FavoritesModel,\n\t\t\ttasks: TasksModel,\n\t\t\tmeetings: MeetingsModel,\n\t\t\tfiles: FilesModel,\n\t\t};\n\t}\n\n\tgetState()\n\t{\n\t\treturn {\n\t\t\tinitedList: new Set(),\n\t\t\tisFilesMigrated: false,\n\t\t\tisLinksMigrated: false\n\t\t};\n\t}\n\n\tgetGetters()\n\t{\n\t\treturn {\n\t\t\tisInited: (state) => (chatId: number): boolean =>\n\t\t\t{\n\t\t\t\treturn state.initedList.has(chatId);\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions()\n\t{\n\t\treturn {\n\t\t\tsetInited: (store, chatId) =>\n\t\t\t{\n\t\t\t\tif (!Type.isNumber(chatId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setInited', chatId);\n\t\t\t},\n\t\t\tsetFilesMigrated: (store, value: boolean) =>\n\t\t\t{\n\t\t\t\tif (!Type.isBoolean(value))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setFilesMigrated', value);\n\t\t\t},\n\t\t\tsetLinksMigrated: (store, value: boolean) =>\n\t\t\t{\n\t\t\t\tif (!Type.isBoolean(value))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setLinksMigrated', value);\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMutations()\n\t{\n\t\treturn {\n\t\t\tsetInited: (state, payload) =>\n\t\t\t{\n\t\t\t\tstate.initedList.add(payload);\n\t\t\t},\n\t\t\tsetFilesMigrated: (state, payload: boolean) =>\n\t\t\t{\n\t\t\t\tstate.isFilesMigrated = payload;\n\t\t\t},\n\t\t\tsetLinksMigrated: (state, payload: boolean) =>\n\t\t\t{\n\t\t\t\tstate.isLinksMigrated = payload;\n\t\t\t},\n\t\t};\n\t}\n}","import {Type} from 'main.core';\nimport {BuilderModel} from 'ui.vue3.vuex';\n\nimport {PlacementType} from 'im.v2.const';\n\nimport type {MarketApplication} from '../type/market';\n\nexport class MarketModel extends BuilderModel\n{\n\tgetName(): string\n\t{\n\t\treturn 'market';\n\t}\n\n\tgetState()\n\t{\n\t\treturn {\n\t\t\tcollection: new Map(),\n\t\t\tplacementCollection: {\n\t\t\t\t[PlacementType.contextMenu]: new Set(),\n\t\t\t\t[PlacementType.navigation]: new Set(),\n\t\t\t\t[PlacementType.textarea]: new Set(),\n\t\t\t\t[PlacementType.sidebar]: new Set(),\n\t\t\t\t[PlacementType.smilesSelector]: new Set()\n\t\t\t},\n\t\t};\n\t}\n\n\tgetElementState(): MarketApplication\n\t{\n\t\treturn {\n\t\t\tid: 0,\n\t\t\ttitle: '',\n\t\t\toptions: {\n\t\t\t\trole: '',\n\t\t\t\textranet: '',\n\t\t\t\tcontext: null,\n\t\t\t\twidth: null,\n\t\t\t\theight: null,\n\t\t\t\tcolor: null,\n\t\t\t\ticonName: null\n\t\t\t},\n\t\t\tplacement: '',\n\t\t\torder: 0,\n\t\t\tloadConfiguration: {\n\t\t\t\tID: 0,\n\t\t\t\tPLACEMENT: '',\n\t\t\t\tPLACEMENT_ID: 0,\n\t\t\t},\n\t\t};\n\t}\n\n\tgetGetters()\n\t{\n\t\treturn {\n\t\t\tgetByPlacement: (state) => (placement: string): MarketApplication[] =>\n\t\t\t{\n\t\t\t\tconst appIds = [...state.placementCollection[placement].values()];\n\n\t\t\t\treturn appIds.map(id => {\n\t\t\t\t\treturn state.collection.get(id);\n\t\t\t\t});\n\t\t\t},\n\t\t\tgetById: (state) => (id: number): number =>\n\t\t\t{\n\t\t\t\treturn state.collection.get(id);\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions()\n\t{\n\t\treturn {\n\t\t\tset: (store, payload) =>\n\t\t\t{\n\t\t\t\tconst {items} = payload;\n\n\t\t\t\titems.forEach((item: MarketApplication) => {\n\t\t\t\t\tstore.commit('setPlacementCollection', {placement: item.placement, id: item.id});\n\t\t\t\t\tstore.commit('setCollection', item);\n\t\t\t\t});\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMutations()\n\t{\n\t\treturn {\n\t\t\tsetPlacementCollection: (state, payload: MarketApplication) =>\n\t\t\t{\n\t\t\t\tstate.placementCollection[payload.placement].add(payload.id);\n\t\t\t},\n\t\t\tsetCollection: (state, payload: MarketApplication) =>\n\t\t\t{\n\t\t\t\tstate.collection.set(payload.id, {...this.getElementState(), ...this.#validate(payload)});\n\t\t\t},\n\t\t};\n\t}\n\n\t#validate(app: Object): MarketApplication\n\t{\n\t\tconst result = {};\n\n\t\tif (Type.isNumber(app.id) || Type.isStringFilled(app.id))\n\t\t{\n\t\t\tresult.id = app.id.toString();\n\t\t}\n\n\t\tif (Type.isString(app.title))\n\t\t{\n\t\t\tresult.title = app.title;\n\t\t}\n\n\t\tresult.options = this.#validateOptions(app.options);\n\n\t\tif (Type.isString(app.placement))\n\t\t{\n\t\t\tresult.placement = app.placement;\n\t\t}\n\n\t\tif (Type.isNumber(app.order))\n\t\t{\n\t\t\tresult.order = app.order;\n\t\t}\n\n\t\tresult.loadConfiguration = this.#validateLoadConfiguration(app.loadConfiguration);\n\n\t\treturn result;\n\t}\n\n\t#validateOptions(options: Object)\n\t{\n\t\tconst result = {\n\t\t\tcontext: null,\n\t\t\twidth: null,\n\t\t\theight: null,\n\t\t\tcolor: null,\n\t\t\ticonName: null\n\t\t};\n\n\t\tif (!Type.isPlainObject(options))\n\t\t{\n\t\t\treturn result;\n\t\t}\n\n\t\tif (Type.isArrayFilled(options.context))\n\t\t{\n\t\t\tresult.context = options.context;\n\t\t}\n\t\tif (Type.isNumber(options.width))\n\t\t{\n\t\t\tresult.width = options.width;\n\t\t}\n\n\t\tif (Type.isNumber(options.height))\n\t\t{\n\t\t\tresult.height = options.height;\n\t\t}\n\n\t\tif (Type.isStringFilled(options.color))\n\t\t{\n\t\t\tresult.color = options.color;\n\t\t}\n\n\t\tif (Type.isStringFilled(options.iconName))\n\t\t{\n\t\t\tresult.iconName = options.iconName;\n\t\t}\n\n\t\treturn result;\n\t}\n\n\t#validateLoadConfiguration(configuration: Object)\n\t{\n\t\tconst result = {\n\t\t\tID: 0,\n\t\t\tPLACEMENT: '',\n\t\t\tPLACEMENT_ID: 0,\n\t\t};\n\n\t\tif (!Type.isPlainObject(configuration))\n\t\t{\n\t\t\treturn result;\n\t\t}\n\n\t\tif (Type.isNumber(configuration.ID))\n\t\t{\n\t\t\tresult.ID = configuration.ID;\n\t\t}\n\n\t\tif (Type.isStringFilled(configuration.PLACEMENT))\n\t\t{\n\t\t\tresult.PLACEMENT = configuration.PLACEMENT;\n\t\t}\n\n\t\tif (Type.isNumber(configuration.PLACEMENT_ID))\n\t\t{\n\t\t\tresult.PLACEMENT_ID = configuration.PLACEMENT_ID;\n\t\t}\n\n\t\treturn result;\n\t}\n}","import { Type } from 'main.core';\nimport { BuilderModel } from 'ui.vue3.vuex';\n\nimport { Core } from 'im.v2.application.core';\n\nimport type { GetterTree, ActionTree, MutationTree } from 'ui.vue3.vuex';\n\nimport type { RecentItem as ImModelRecentItem } from '../type/recent-item';\nimport type { Chat as ImModelChat } from '../type/chat';\n\ntype CountersState = {\n\tunloadedChatCounters: {[chatId: string]: number},\n\tunloadedLinesCounters: {[chatId: string]: number},\n\tunloadedCopilotCounters: {[chatId: string]: number},\n};\n\nexport class CountersModel extends BuilderModel\n{\n\tgetName(): string\n\t{\n\t\treturn 'counters';\n\t}\n\n\tgetState(): CountersState\n\t{\n\t\treturn {\n\t\t\tunloadedChatCounters: {},\n\t\t\tunloadedLinesCounters: {},\n\t\t\tunloadedCopilotCounters: {},\n\t\t};\n\t}\n\n\t// eslint-disable-next-line max-lines-per-function\n\tgetGetters(): GetterTree\n\t{\n\t\treturn {\n\t\t\t/** @function counters/getTotalChatCounter */\n\t\t\tgetTotalChatCounter: (state: CountersState): number => {\n\t\t\t\tlet loadedChatsCounter = 0;\n\t\t\t\tconst recentCollection = Core.getStore().getters['recent/getRecentCollection'];\n\t\t\t\trecentCollection.forEach((recentItem: ImModelRecentItem) => {\n\t\t\t\t\tconst dialog: ImModelChat = this.store.getters['chats/get'](recentItem.dialogId, true);\n\t\t\t\t\tconst isMuted = dialog.muteList.includes(Core.getUserId());\n\t\t\t\t\tif (isMuted)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tconst isMarked = recentItem.unread;\n\t\t\t\t\tif (dialog.counter === 0 && isMarked)\n\t\t\t\t\t{\n\t\t\t\t\t\tloadedChatsCounter++;\n\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tloadedChatsCounter += dialog.counter;\n\t\t\t\t});\n\n\t\t\t\tlet unloadedChatsCounter = 0;\n\t\t\t\tObject.values(state.unloadedChatCounters).forEach((counter) => {\n\t\t\t\t\tunloadedChatsCounter += counter;\n\t\t\t\t});\n\n\t\t\t\treturn loadedChatsCounter + unloadedChatsCounter;\n\t\t\t},\n\t\t\t/** @function counters/getTotalCopilotCounter */\n\t\t\tgetTotalCopilotCounter: (state: CountersState): number => {\n\t\t\t\tlet loadedChatsCounter = 0;\n\t\t\t\tconst recentCollection = Core.getStore().getters['recent/getCopilotCollection'];\n\t\t\t\trecentCollection.forEach((recentItem: ImModelRecentItem) => {\n\t\t\t\t\tconst dialog: ImModelChat = this.store.getters['chats/get'](recentItem.dialogId, true);\n\t\t\t\t\tconst isMuted = dialog.muteList.includes(Core.getUserId());\n\t\t\t\t\tif (isMuted)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tloadedChatsCounter += dialog.counter;\n\t\t\t\t});\n\n\t\t\t\tlet unloadedChatsCounter = 0;\n\t\t\t\tObject.values(state.unloadedCopilotCounters).forEach((counter) => {\n\t\t\t\t\tunloadedChatsCounter += counter;\n\t\t\t\t});\n\n\t\t\t\treturn loadedChatsCounter + unloadedChatsCounter;\n\t\t\t},\n\t\t\t/** @function counters/getTotalLinesCounter */\n\t\t\tgetTotalLinesCounter: (state: CountersState): number => {\n\t\t\t\tlet unloadedLinesCounter = 0;\n\t\t\t\tObject.values(state.unloadedLinesCounters).forEach((counter) => {\n\t\t\t\t\tunloadedLinesCounter += counter;\n\t\t\t\t});\n\n\t\t\t\treturn unloadedLinesCounter;\n\t\t\t},\n\t\t\t/** @function counters/getSpecificLinesCounter */\n\t\t\tgetSpecificLinesCounter: (state: CountersState) => (chatId: number): number => {\n\t\t\t\tif (!state.unloadedLinesCounters[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn state.unloadedLinesCounters[chatId];\n\t\t\t},\n\n\t\t};\n\t}\n\n\t/* eslint-disable no-param-reassign */\n\t/* eslint-disable-next-line max-lines-per-function */\n\tgetActions(): ActionTree\n\t{\n\t\treturn {\n\t\t\t/** @function counters/setUnloadedChatCounters */\n\t\t\tsetUnloadedChatCounters: (store, payload: {[chatId: string]: number}) => {\n\t\t\t\tif (!Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setUnloadedChatCounters', payload);\n\t\t\t},\n\t\t\t/** @function counters/setUnloadedLinesCounters */\n\t\t\tsetUnloadedLinesCounters: (store, payload: {[chatId: string]: number}) => {\n\t\t\t\tif (!Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setUnloadedLinesCounters', payload);\n\t\t\t},\n\t\t\t/** @function counters/setUnloadedCopilotCounters */\n\t\t\tsetUnloadedCopilotCounters: (store, payload: {[chatId: string]: number}) => {\n\t\t\t\tif (!Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setUnloadedCopilotCounters', payload);\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMutations(): MutationTree\n\t{\n\t\treturn {\n\t\t\tsetUnloadedChatCounters: (state: CountersState, payload: {[chatId: string]: number}) => {\n\t\t\t\tObject.entries(payload).forEach(([chatId, counter]) => {\n\t\t\t\t\tif (counter === 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tdelete state.unloadedChatCounters[chatId];\n\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tstate.unloadedChatCounters[chatId] = counter;\n\t\t\t\t});\n\t\t\t},\n\t\t\tsetUnloadedLinesCounters: (state: CountersState, payload: {[chatId: string]: number}) => {\n\t\t\t\tObject.entries(payload).forEach(([chatId, counter]) => {\n\t\t\t\t\tif (counter === 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tdelete state.unloadedLinesCounters[chatId];\n\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tstate.unloadedLinesCounters[chatId] = counter;\n\t\t\t\t});\n\t\t\t},\n\t\t\tsetUnloadedCopilotCounters: (state: CountersState, payload: {[chatId: string]: number}) => {\n\t\t\t\tObject.entries(payload).forEach(([chatId, counter]) => {\n\t\t\t\t\tif (counter === 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tdelete state.unloadedCopilotCounters[chatId];\n\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tstate.unloadedCopilotCounters[chatId] = counter;\n\t\t\t\t});\n\t\t\t},\n\t\t};\n\t}\n}\n"],"names":["isNumberOrString","target","Type","isNumber","isString","convertToString","toString","convertToNumber","Number","parseInt","convertToDate","Utils","date","cast","SNAKE_CASE_REGEXP","convertObjectKeysToCamelCase","targetObject","resultObject","Object","entries","forEach","key","value","newKey","prepareKey","isPlainObject","isArray","convertArrayItemsKeysToCamelCase","rawKey","search","toLowerCase","Text","toCamelCase","targetArray","map","arrayItem","SortWeight","im","prepareNotificationSettings","result","sortedTarget","sortNotificationSettingsBlock","block","preparedItems","notices","item","id","label","items","sort","a","b","weightA","weightB","settingsFieldsConfig","fieldName","Settings","notification","enableSound","targetFieldName","checkFunction","isBoolean","enableAutoRead","mode","enableWeb","enableMail","enablePush","formatFunction","message","bigSmiles","appearance","background","alignment","recent","showBirthday","showInvited","showLastMessage","hotkey","sendByEnter","desktop","enableRedirect","user","status","formatFieldsWithConfig","fields","config","rawFields","fieldConfig","foundFieldName","getValidFieldName","isFieldValueValid","formatFieldValue","fieldValue","currentResult","fieldNameList","isStringFilled","singleField","isUndefined","field","checkFunctionList","isFunction","some","singleFunction","params","SettingsModel","BuilderModel","getState","DialogAlignment","left","NotificationSettingsMode","simple","notifications","getGetters","get","state","getActions","set","store","payload","commit","formatFields","setNotificationOption","getMutations","moduleId","optionName","type","moduleOptions","ApplicationModel","getName","getNestedModules","settings","layout","name","Layout","chat","entityId","contextId","getLayout","isChatOpen","dialogId","allowedLayouts","copilot","includes","isLinesChatOpen","openlines","areNotificationsOpen","setLayout","previousLayout","newLayout","validateLayout","validateLayoutEntityId","EventEmitter","emit","EventType","onLayoutChange","from","to","updateLayout","prepareComponentId","componentId","supportedComponents","values","MessageComponent","unsupported","prepareAuthorId","system","isSystem","prepareKeyboard","rawKeyboardButtons","rawButton","disabled","vote","wait","messageFieldsConfig","text","isUuidV4","PinModel","collection","getPinned","chatId","pinnedMessageId","Core","getStore","getters","isPinned","messageId","has","setPinned","pinnedMessages","length","pinnedMessageIds","add","delete","Logger","warn","Set","reverse","Reaction","freeze","like","kiss","laugh","wonder","cry","angry","facepalm","USERS_TO_SHOW","ReactionsModel","getElementState","reactionCounters","reactionUsers","ownReactions","getByMessageId","prepareSetPayload","setReaction","reaction","removeReaction","newItem","currentItem","newOwnReaction","userId","reactions","getUserId","removeAllCurrentUserReactions","currentCounter","users","counter","MessagesModel","pin","chatCollection","authorId","replyId","Date","files","attach","keyboard","unread","viewed","viewedByOthers","sending","error","default","componentParams","forward","isEdited","isDeleted","getById","getByIdList","idList","push","hasMessage","isForward","isInChatCollection","getFirstId","getLastId","getLastOwnMessageId","getFirstUnread","getChatUnreadMessages","messages","filter","getMessageFiles","fileId","getMessageType","currentUserId","MessageType","self","opponent","getPreviousMessage","initialMessageIndex","indexOf","desiredMessageId","setChatCollection","clearCollection","Array","preparedMessages","updateWithId","update","currentMessage","readMessages","messageIds","chatMessages","messagesToReadCount","maxMessageId","messageIdsToView","messageIdsToRead","chatMessage","setViewedByOthers","ids","clearChatCollection","deleteAttach","attachId","attachItem","isOwnMessage","messageParams","formattedFields","NAME","USER_ID","Boolean","authorName","AVATAR","avatar","originalAuthorId","fakeAuthorId","userManager","UserManager","networkId","UserIdNetworkPrefix","setUsersToModel","firstId","element","isTempMessage","lastId","lastOwnMessageId","z","resultId","getTime","prepareManagerList","managerList","rawUserId","prepareChatName","chatName","decode","prepareAvatar","endsWith","startsWith","getHost","encodeURI","prepareWritingList","writingList","userName","prepareMuteList","muteList","prepareLastMessageViews","rawLastMessageViews","countOfViewers","firstViewers","rawFirstViewers","firstViewer","rawFirstViewer","Error","chatFieldsConfig","chatEntityFieldsConfig","ChatsModel","ChatType","description","color","Color","base","extranet","userCounter","lastReadId","markedId","lastMessageId","lastMessageViews","savedPositionMessageId","quoteId","owner","entityLink","dateCreate","public","code","link","inited","loading","hasPrevPage","hasNextPage","diskFolderId","role","UserRole","guest","permissions","manageUi","none","manageSettings","manageUsersAdd","manageUsersDelete","canPost","getBlank","getByChatId","preparedChatId","find","getQuoteId","isUser","getLastReadId","getInitialMessageId","Math","min","rawPayload","existingItem","clearCounters","mute","actionName","unmute","setLastMessageViews","newLastMessageViews","clearLastMessageViews","defaultLastMessageViews","incrementLastMessageViews","newCounter","keys","BotsModel","BotType","bot","appId","isHidden","isSupportOpenline","isHuman","getByUserId","isNetwork","network","isSupport","support24","botData","RawBotType","human","TYPES_MAPPED_TO_DEFAULT_BOT","openline","supervisor","prepareDepartments","departments","rawDepartmentId","departmentId","preparePhones","phones","workPhone","personalMobile","personalPhone","innerPhone","userFieldsConfig","isNetworkUserId","UsersModel","bots","onlineList","mobileOnlineList","absentList","firstName","lastName","workPosition","gender","isAdmin","connector","externalAuthId","idle","lastActivityDate","mobileLastDate","isOnline","isMobileOnline","birthday","isBirthday","absent","isAbsent","getTemporary","getList","userList","hasBirthday","hasVacation","getStatus","UserStatus","mobileOnline","getLastOnline","getLastDateText","getPosition","Loc","getMessage","existingUser","setStatus","handleUserStatusFlags","startOnlineCheckInterval","startAbsentCheckInterval","preparedFields","isBot","dispatch","bot_data","addToOnlineList","addToMobileOnlineList","isBirthdayToday","setTimeout","getTimeToNextMidnight","isDate","addToAbsentList","absentCheckInterval","TIME_TO_NEXT_DAY","setInterval","currentTime","now","absentEnd","onlineCheckInterval","ONE_MINUTE","FilesModel","extension","icon","size","image","FileStatus","done","progress","urlPreview","urlShow","urlDownload","viewerAttrs","isInCollection","preparedFile","validate","file","currentFile","getIconTypeByExtension","width","height","validateViewerAttributes","viewer","actions","objectId","src","title","viewerGroupBy","viewerType","viewerTypeClass","viewerSeparateItem","viewerExtension","imChatId","CallsModel","call","RecentCallStatus","waiting","hasActiveCall","activeCall","joined","existingCall","addActiveCall","validateActiveCall","prepareActiveCall","updateActiveCall","deleteActiveCall","isObjectLike","associatedEntity","RecentSearchModel","foundByUser","getDialogIds","rawDialogId","recentElement","clear","options","byUser","RecentModel","calls","recentCollection","unreadCollection","copilotCollection","senderId","MessageStatus","received","withFile","withAttach","draft","pinned","liked","dateUpdate","invitation","isActive","originator","canResend","getRecentCollection","dialog","getUnreadCollection","getCopilotCollection","getSortedCollection","recentCollectionAsArray","filteredCollection","isBirthdayPlaceholder","birthdayPlaceholder","isInvitedUser","defaultUserRecord","needsBirthdayPlaceholder","hasTodayMessage","isToday","needsVacationPlaceholder","getMessageDate","getStartOfTheDay","setRecent","itemIds","updateUnloadedRecentCounters","setUnread","setCopilot","updateUnloadedCopilotCounters","itemsToUpdate","itemsToAdd","preparedElement","defaultMessage","action","isLastMessage","isExactMessageLiked","setRecentDraft","collectionName","addMethodName","setCopilotDraft","setDraft","existingCollectionItem","clearUnread","setRecentCollection","deleteFromRecentCollection","setUnreadCollection","setCopilotCollection","deleteFromCopilotCollection","elementIsInRecent","defaultUserElement","currentElement","prepareMessage","prepareDraft","date_update","invited","originator_id","can_resend","default_user_record","author_id","updateUnloadedCounters","updateMethod","zeroedCountersForNewItems","chat_id","NotificationsModel","Map","searchCollection","unreadCounter","replaces","notifyButtons","sectionCode","NotificationTypesCodes","read","settingName","sortByType","getSearchResultCollection","getConfirmsCount","confirm","notificationId","getCounter","initialSet","total_unread_count","isArrayFilled","setSearchResult","skipValidation","readAll","deleteFromSearch","clearSearchResult","setCounter","addSearchResult","updateSearchResult","decreaseCounter","increaseCounter","isNil","notify_title","notify_buttons","JSON","parse","buttons","button","COMMAND","COMMAND_PARAMS","VALUE","TEXT","TITLE","TYPE","DISPLAY","BG_COLOR","TEXT_COLOR","notify_type","notify_read","setting_name","LinksModel","counters","getSize","source","richData","previewUrl","links","preparedLink","url","validateRichData","FavoritesModel","isFavoriteMessage","chatFavorites","fromEntries","targetMessage","favorites","favorite","preparedFavoriteMessage","deleteByMessageId","targetLinkId","linkId","linkObject","MembersModel","TasksModel","task","creatorId","responsibleId","statusTitle","deadline","tasks","preparedTask","validateTask","MeetingsModel","meeting","dateFrom","dateTo","meetings","preparedMeeting","calendar","validateMeeting","subType","getLatest","rootState","rootGetters","media","audio","documents","other","SidebarFileTypes","document","sortedFlatCollection","flat","getTopThreeCompletedFiles","getLatestUnsorted","unsorted","fileUnsorted","sortedCollection","sidebarFile","slice","SidebarModel","members","initedList","isFilesMigrated","isLinksMigrated","isInited","setInited","setFilesMigrated","setLinksMigrated","MarketModel","placementCollection","PlacementType","contextMenu","navigation","textarea","sidebar","smilesSelector","context","iconName","placement","order","loadConfiguration","ID","PLACEMENT","PLACEMENT_ID","getByPlacement","appIds","setPlacementCollection","setCollection","app","configuration","CountersModel","unloadedChatCounters","unloadedLinesCounters","unloadedCopilotCounters","getTotalChatCounter","loadedChatsCounter","recentItem","isMuted","isMarked","unloadedChatsCounter","getTotalCopilotCounter","getTotalLinesCounter","unloadedLinesCounter","getSpecificLinesCounter","setUnloadedChatCounters","setUnloadedLinesCounters","setUnloadedCopilotCounters"],"mappings":"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"}