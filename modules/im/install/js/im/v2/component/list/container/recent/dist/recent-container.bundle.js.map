{"version":3,"file":"recent-container.bundle.js","sources":["../src/components/header-menu.js","../src/components/create-chat-menu/create-chat-help.js","../src/components/create-chat-menu/create-chat-menu.js","../src/recent-container.js"],"sourcesContent":["import {ChatService} from 'im.v2.provider.service';\nimport {MessengerMenu, MenuItem} from 'im.v2.component.elements';\n\nimport type {PopupOptions} from 'main.popup';\n\n// @vue/component\nexport const HeaderMenu = {\n\tcomponents: {MessengerMenu, MenuItem},\n\temits: ['showUnread'],\n\tdata() {\n\t\treturn {\n\t\t\tshowPopup: false,\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tmenuConfig(): PopupOptions\n\t\t{\n\t\t\treturn {\n\t\t\t\tid: 'im-recent-header-menu',\n\t\t\t\twidth: 284,\n\t\t\t\tbindElement: this.$refs['icon'] || {},\n\t\t\t\toffsetTop: 4,\n\t\t\t\tpadding: 0,\n\t\t\t};\n\t\t},\n\t\tunreadCounter(): number\n\t\t{\n\t\t\treturn this.$store.getters['recent/getTotalCounter'];\n\t\t}\n\t},\n\tmethods:\n\t{\n\t\tonIconClick()\n\t\t{\n\t\t\tthis.showPopup = true;\n\t\t},\n\t\tonReadAllClick()\n\t\t{\n\t\t\tnew ChatService().readAll();\n\t\t\tthis.showPopup = false;\n\t\t},\n\t\tloc(phraseCode: string): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode);\n\t\t}\n\t},\n\ttemplate: `\n\t\t<div @click=\"onIconClick\" class=\"bx-im-list-container-recent__header-menu_icon\" :class=\"{'--active': showPopup}\" ref=\"icon\"></div>\n\t\t<MessengerMenu v-if=\"showPopup\" :config=\"menuConfig\" @close=\"showPopup = false\">\n\t\t\t<MenuItem\n\t\t\t\t:title=\"loc('IM_RECENT_HEADER_MENU_READ_ALL')\"\n\t\t\t\t@click=\"onReadAllClick\"\n\t\t\t/>\n\t\t\t<MenuItem\n\t\t\t\t:title=\"loc('IM_RECENT_HEADER_MENU_SHOW_UNREAD_ONLY')\"\n\t\t\t\t:counter=\"unreadCounter\"\n\t\t\t\t:disabled=\"true\"\n\t\t\t/>\n\t\t\t<MenuItem\n\t\t\t\t:title=\"loc('IM_RECENT_HEADER_MENU_CHAT_GROUPS_TITLE')\"\n\t\t\t\t:subtitle=\"loc('IM_RECENT_HEADER_MENU_CHAT_GROUPS_SUBTITLE')\"\n\t\t\t\t:disabled=\"true\"\n\t\t\t/>\n\t\t</MessengerMenu>\n\t`\n};","import '../../css/create-chat-help.css';\n\n// @vue/component\nexport const CreateChatHelp = {\n\temits: ['articleOpen'],\n\tdata()\n\t{\n\t\treturn {};\n\t},\n\tmethods:\n\t{\n\t\topenHelpArticle()\n\t\t{\n\t\t\tconst ARTICLE_CODE = 17412872;\n\t\t\tBX.Helper?.show(`redirect=detail&code=${ARTICLE_CODE}`);\n\t\t\tthis.$emit('articleOpen');\n\t\t},\n\t\tloc(phraseCode: string): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode);\n\t\t}\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-create-chat-help__container\">\n\t\t\t<div @click=\"openHelpArticle\" class=\"bx-im-create-chat-help__content\">\n\t\t\t\t<div class=\"bx-im-create-chat-help__icon\"></div>\n\t\t\t\t<div class=\"bx-im-create-chat-help__text\">{{ loc('IM_RECENT_CREATE_CHAT_WHAT_TO_CHOOSE') }}</div>\t\n\t\t\t</div>\n\t\t</div>\n\t`\n};","import {MessengerMenu, MenuItem, MenuItemIcon} from 'im.v2.component.elements';\nimport {Layout} from 'im.v2.const';\n\nimport {CreateChatHelp} from './create-chat-help';\n\n// @vue/component\nexport const CreateChatMenu = {\n\tcomponents: {MessengerMenu, MenuItem, CreateChatHelp},\n\tdata() {\n\t\treturn {\n\t\t\tshowPopup: false,\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tMenuItemIcon: () => MenuItemIcon,\n\t\tmenuConfig()\n\t\t{\n\t\t\treturn {\n\t\t\t\tid: 'im-create-chat-menu',\n\t\t\t\twidth: 255,\n\t\t\t\tbindElement: this.$refs['icon'] || {},\n\t\t\t\toffsetTop: 4,\n\t\t\t\tpadding: 0,\n\t\t\t};\n\t\t}\n\t},\n\tmethods:\n\t{\n\t\tonGroupChatCreate()\n\t\t{\n\t\t\tthis.$store.dispatch('application/setLayout', {layoutName: Layout.createChat.name});\n\t\t\tthis.showPopup = false;\n\t\t},\n\t\tloc(phraseCode: string): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode);\n\t\t}\n\t},\n\ttemplate: `\n\t\t<div @click=\"showPopup = true\" class=\"bx-im-list-container-recent__create-chat_icon\" :class=\"{'--active': showPopup}\" ref=\"icon\"></div>\n\t\t<MessengerMenu v-if=\"showPopup\" :config=\"menuConfig\" @close=\"showPopup = false\">\n\t\t\t<MenuItem\n\t\t\t\t:icon=\"MenuItemIcon.chat\"\n\t\t\t\t:title=\"loc('IM_RECENT_CREATE_GROUP_CHAT_TITLE_V2')\"\n\t\t\t\t:subtitle=\"loc('IM_RECENT_CREATE_GROUP_CHAT_SUBTITLE')\"\n\t\t\t\t@click=\"onGroupChatCreate\"\n\t\t\t/>\n\t\t\t<MenuItem\n\t\t\t\t:icon=\"MenuItemIcon.channel\"\n\t\t\t\t:title=\"loc('IM_RECENT_CREATE_CHANNEL_TITLE_V2')\"\n\t\t\t\t:subtitle=\"loc('IM_RECENT_CREATE_CHANNEL_SUBTITLE_V2')\"\n\t\t\t\t:disabled=\"true\"\n\t\t\t/>\n\t\t\t<MenuItem\n\t\t\t\t:icon=\"MenuItemIcon.conference\"\n\t\t\t\t:title=\"loc('IM_RECENT_CREATE_CONFERENCE_TITLE')\"\n\t\t\t\t:subtitle=\"loc('IM_RECENT_CREATE_CONFERENCE_SUBTITLE')\"\n\t\t\t\t:disabled=\"true\"\n\t\t\t/>\n\t\t\t<template #footer>\n\t\t\t\t<CreateChatHelp @articleOpen=\"showPopup = false\" />\n\t\t\t</template>\n\t\t</MessengerMenu>\n\t`\n};","import {EventEmitter} from 'main.core.events';\nimport {Event} from 'main.core';\n\nimport {RecentList} from 'im.v2.component.list.element-list.recent';\nimport {SearchInput} from 'im.v2.component.search.search-input';\nimport {SearchResult} from 'im.v2.component.search.search-result';\nimport {Layout, EventType} from 'im.v2.const';\nimport {Logger} from 'im.v2.lib.logger';\nimport {UnreadRecentService} from 'im.v2.provider.service';\n\nimport {HeaderMenu} from './components/header-menu';\nimport {CreateChatMenu} from './components/create-chat-menu/create-chat-menu';\n\nimport './css/recent-container.css';\n\n// @vue/component\nexport const RecentListContainer = {\n\tname: 'RecentListContainer',\n\tcomponents: {HeaderMenu, CreateChatMenu, SearchInput, SearchResult, RecentList},\n\temits: ['selectEntity'],\n\tdata()\n\t{\n\t\treturn {\n\t\t\tsearchMode: false,\n\t\t\tunreadOnlyMode: false,\n\t\t\tsearchQuery: ''\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tUnreadRecentService: () => UnreadRecentService,\n\t},\n\tcreated()\n\t{\n\t\tLogger.warn('List: Recent container created');\n\n\t\tEventEmitter.subscribe(EventType.recent.openSearch, this.onOpenSearch);\n\t\tEvent.bind(document, 'mousedown', this.onDocumentClick);\n\t},\n\tbeforeUnmount()\n\t{\n\t\tEventEmitter.unsubscribe(EventType.recent.openSearch, this.onOpenSearch);\n\t\tEvent.unbind(document, 'mousedown', this.onDocumentClick);\n\t},\n\tmethods:\n\t{\n\t\tonChatClick(dialogId)\n\t\t{\n\t\t\tthis.$emit('selectEntity', {layoutName: Layout.chat.name, entityId: dialogId});\n\t\t},\n\t\tonOpenSearch()\n\t\t{\n\t\t\tthis.searchMode = true;\n\t\t},\n\t\tonCloseSearch()\n\t\t{\n\t\t\tthis.searchMode = false;\n\t\t\tthis.searchQuery = '';\n\t\t},\n\t\tonUpdateSearch(query)\n\t\t{\n\t\t\tthis.searchMode = true;\n\t\t\tthis.searchQuery = query;\n\t\t},\n\t\tonDocumentClick(event: Event)\n\t\t{\n\t\t\tconst clickOnRecentContainer = event.composedPath().includes(this.$refs['recent-container']);\n\t\t\tif (!clickOnRecentContainer)\n\t\t\t{\n\t\t\t\tEventEmitter.emit(EventType.search.close);\n\t\t\t}\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-list-container-recent__scope bx-im-list-container-recent__container\" ref=\"recent-container\">\n\t\t\t<div class=\"bx-im-list-container-recent__header_container\">\n\t\t\t\t<HeaderMenu @showUnread=\"unreadOnlyMode = true\" />\n\t\t\t\t<div class=\"bx-im-list-container-recent__search-input_container\">\n\t\t\t\t\t<SearchInput \n\t\t\t\t\t\t:searchMode=\"searchMode\" \n\t\t\t\t\t\t@openSearch=\"onOpenSearch\"\n\t\t\t\t\t\t@closeSearch=\"onCloseSearch\"\n\t\t\t\t\t\t@updateSearch=\"onUpdateSearch\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<CreateChatMenu />\n\t\t\t</div>\n\t\t\t<div class=\"bx-im-list-container-recent__elements_container\">\n\t\t\t\t<div class=\"bx-im-list-container-recent__elements\">\n\t\t\t\t\t<SearchResult \n\t\t\t\t\t\tv-show=\"searchMode\" \n\t\t\t\t\t\t:searchMode=\"searchMode\" \n\t\t\t\t\t\t:searchQuery=\"searchQuery\" \n\t\t\t\t\t\t:searchConfig=\"{}\"\n\t\t\t\t\t/>\n\t\t\t\t\t<RecentList v-show=\"!searchMode && !unreadOnlyMode\" @chatClick=\"onChatClick\" key=\"recent\" />\n<!--\t\t\t\t\t<RecentList-->\n<!--\t\t\t\t\t\tv-if=\"!searchMode && unreadOnlyMode\"-->\n<!--\t\t\t\t\t\t:recentService=\"UnreadRecentService.getInstance()\"-->\n<!--\t\t\t\t\t\t@chatClick=\"onChatClick\"-->\n<!--\t\t\t\t\t\tkey=\"unread\"-->\n<!--\t\t\t\t\t/>-->\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`\n};"],"names":["HeaderMenu","components","MessengerMenu","MenuItem","emits","data","showPopup","computed","menuConfig","id","width","bindElement","$refs","offsetTop","padding","unreadCounter","$store","getters","methods","onIconClick","onReadAllClick","ChatService","readAll","loc","phraseCode","$Bitrix","Loc","getMessage","template","CreateChatHelp","openHelpArticle","ARTICLE_CODE","BX","Helper","show","$emit","CreateChatMenu","MenuItemIcon","onGroupChatCreate","dispatch","layoutName","Layout","createChat","name","RecentListContainer","SearchInput","SearchResult","RecentList","searchMode","unreadOnlyMode","searchQuery","UnreadRecentService","created","Logger","warn","EventEmitter","subscribe","EventType","recent","openSearch","onOpenSearch","Event","bind","document","onDocumentClick","beforeUnmount","unsubscribe","unbind","onChatClick","dialogId","chat","entityId","onCloseSearch","onUpdateSearch","query","event","clickOnRecentContainer","composedPath","includes","emit","search","close"],"mappings":"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"}