{"version":3,"file":"sidebar.bundle.js","sources":["../src/classes/blocks/base.js","../src/classes/blocks/base-file.js","../src/classes/blocks/media.js","../src/classes/blocks/audio.js","../src/classes/blocks/document.js","../src/classes/blocks/other.js","../src/classes/blocks/favorite.js","../src/classes/blocks/link.js","../src/classes/blocks/task.js","../src/classes/blocks/main.js","../src/classes/blocks/brief.js","../src/classes/blocks/meeting.js","../src/classes/blocks/file-unsorted.js","../src/classes/settings-manager.js","../src/classes/availability-manager.js","../src/classes/sidebar-service.js","../src/components/main/detail-user.js","../src/components/detail.js","../src/classes/context-menu/sidebar-base-menu.js","../src/classes/context-menu/main/members-menu.js","../src/components/main/detail.js","../src/components/main/settings.js","../src/components/main/preview-personal-chat.js","../src/components/main/preview-group-chat.js","../src/components/main/preview.js","../src/components/info/preview.js","../src/classes/sidebar-collection-formatter.js","../src/classes/context-menu/link/link-manager.js","../src/classes/context-menu/link/link-menu.js","../src/components/info/link-item.js","../src/components/date-group.js","../src/components/detail-empty-state.js","../src/components/info/link-detail.js","../src/classes/context-menu/favorite/favorite-menu.js","../src/components/info/favorite-item.js","../src/components/info/favorite-detail.js","../src/classes/context-menu/file/file-manager.js","../src/classes/context-menu/file/file-menu.js","../src/components/file/item/media-detail-item.js","../src/components/file/media-detail.js","../src/components/file/item/audioplayer.js","../src/components/file/item/audio-detail-item.js","../src/components/file/audio-detail.js","../src/components/file/item/document-detail-item.js","../src/components/file/document-detail.js","../src/components/file/other-detail.js","../src/components/file/item/file-preview-item.js","../src/components/file/preview.js","../src/components/file-unsorted/detail.js","../src/classes/context-menu/task/task-manager.js","../src/classes/context-menu/task/task-menu.js","../src/components/task/task-item.js","../src/components/task/preview.js","../src/components/task/detail.js","../src/components/brief/brief-item.js","../src/components/brief/detail.js","../src/components/brief/preview.js","../src/classes/context-menu/meeting/meeting-manager.js","../src/classes/context-menu/meeting/meeting-menu.js","../src/components/meeting/meeting-item.js","../src/components/meeting/preview.js","../src/components/meeting/detail.js","../src/components/sign/preview.js","../src/components/sign/detail.js","../src/components/market/market-preview-item.js","../src/components/market/preview.js","../src/components/market/detail.js","../src/classes/context-menu/main/main-menu.js","../src/components/header.js","../src/components/detail-header.js","../src/components/detail-tabs.js","../src/sidebar.js"],"sourcesContent":["import {Type} from 'main.core';\n\nimport {Core} from 'im.v2.application.core';\nimport {UserManager} from 'im.v2.lib.user';\n\nconst NOT_IMPLEMENTED_ERROR = 'Not implemented';\n\nexport class Base\n{\n\tstore: Object = null;\n\tdialogId: string = '';\n\tchatId: number = 0;\n\tuserManager: UserManager = null;\n\n\tconstructor(chatId: number, dialogId: string)\n\t{\n\t\tthis.store = Core.getStore();\n\t\tthis.restClient = Core.getRestClient();\n\t\tthis.chatId = chatId;\n\t\tthis.dialogId = dialogId;\n\t\tthis.userManager = new UserManager();\n\t}\n\n\tloadFirstPage(): Promise\n\t{\n\t\tthrow new Error(NOT_IMPLEMENTED_ERROR);\n\t}\n\n\tloadNextPage(): Promise\n\t{\n\t\tthrow new Error(NOT_IMPLEMENTED_ERROR);\n\t}\n\n\tgetInitialRequest()\n\t{\n\t\tthrow new Error(NOT_IMPLEMENTED_ERROR);\n\t}\n\n\tgetResponseHandler()\n\t{\n\t\tthrow new Error(NOT_IMPLEMENTED_ERROR);\n\t}\n\n\tgetCurrentUserId(): number\n\t{\n\t\treturn Core.getUserId();\n\t}\n\n\tgetLastElementId(collection): ?number\n\t{\n\t\tconst lastId = collection[collection.length - 1]?.id;\n\n\t\tif (Type.isNumber(lastId))\n\t\t{\n\t\t\treturn lastId;\n\t\t}\n\n\t\treturn null;\n\t}\n}\n","import {RestMethod} from 'im.v2.const';\nimport {Base} from './base';\n\nconst REQUEST_ITEMS_LIMIT = 50;\n\nexport class BaseFile extends Base\n{\n\thasMoreItemsToLoad: boolean = true;\n\tlastId: number = 0;\n\n\tgetInitialRequest()\n\t{\n\t\treturn {\n\t\t\t[RestMethod.imChatFileCollectionGet]: [RestMethod.imChatFileCollectionGet, {chat_id: this.chatId, limit: REQUEST_ITEMS_LIMIT}]\n\t\t};\n\t}\n\n\tgetResponseHandler()\n\t{\n\t\treturn (response) => {\n\t\t\tif (!response)\n\t\t\t{\n\t\t\t\treturn Promise.reject(new Error('SidebarInfo service error: no response'));\n\t\t\t}\n\n\t\t\tconst requestError = this.extractLoadFileError(response);\n\t\t\tif (requestError)\n\t\t\t{\n\t\t\t\treturn Promise.reject(new Error(requestError));\n\t\t\t}\n\n\t\t\tconst fileResult = response[RestMethod.imChatFileCollectionGet].data();\n\n\t\t\treturn this.updateModels(fileResult);\n\t\t};\n\t}\n\n\textractLoadFileError(response): ?string\n\t{\n\t\tconst fileGetResponse = response[RestMethod.imChatFileCollectionGet];\n\t\tif (fileGetResponse?.error())\n\t\t{\n\t\t\treturn `Sidebar service error: ${RestMethod.imChatFileCollectionGet}: ${fileGetResponse?.error()}`;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\thandleResponse(response): Promise\n\t{\n\t\tconst fileResult = response.data();\n\t\tif (fileResult.list.length < REQUEST_ITEMS_LIMIT)\n\t\t{\n\t\t\tthis.hasMoreItemsToLoad = false;\n\t\t}\n\n\t\tthis.lastId = this.getLastElementId(fileResult.list);\n\n\t\treturn this.updateModels(fileResult);\n\t}\n\n\tupdateModels(resultData): Promise\n\t{\n\t\tconst {list, users, files} = resultData;\n\n\t\tconst addUsersPromise = this.userManager.setUsersToModel(users);\n\t\tconst setFilesPromise = this.store.dispatch('files/set', files);\n\t\tconst setSidebarFilesPromise = this.store.dispatch('sidebar/files/set', {\n\t\t\tchatId: this.chatId,\n\t\t\tfiles: list\n\t\t});\n\n\t\treturn Promise.all([\n\t\t\tsetFilesPromise, setSidebarFilesPromise, addUsersPromise\n\t\t]);\n\t}\n\n\tloadFirstPageBySubType(subType: string): Promise\n\t{\n\t\tconst filesCount = this.getFilesCountFromModel(subType);\n\t\tif (filesCount > REQUEST_ITEMS_LIMIT)\n\t\t{\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\tconst queryParams = this.getQueryParams(subType);\n\n\t\treturn this.requestPage(queryParams);\n\t}\n\n\tloadNextPageBySubType(subType: string): Promise\n\t{\n\t\tconst queryParams = this.getQueryParams(subType);\n\n\t\treturn this.requestPage(queryParams);\n\t}\n\n\tgetQueryParams(subType: string): Object\n\t{\n\t\tconst queryParams = {\n\t\t\t'CHAT_ID': this.chatId,\n\t\t\t'SUBTYPE': subType,\n\t\t\t'LIMIT': REQUEST_ITEMS_LIMIT,\n\t\t};\n\n\t\tif (this.lastId > 0)\n\t\t{\n\t\t\tqueryParams['LAST_ID'] = this.lastId;\n\t\t}\n\n\t\treturn queryParams;\n\t}\n\n\trequestPage(queryParams): Promise\n\t{\n\t\treturn this.restClient.callMethod(RestMethod.imChatFileGet, queryParams).then(response => {\n\t\t\treturn this.handleResponse(response);\n\t\t}).catch(error => {\n\t\t\tconsole.error('SidebarInfo: imChatFileGet: page request error', error);\n\t\t});\n\t}\n\n\tgetFilesCountFromModel(subType): number\n\t{\n\t\treturn this.store.getters['sidebar/files/getSize'](this.chatId, subType);\n\t}\n}","import {SidebarFileTabTypes} from 'im.v2.const';\nimport {BaseFile} from './base-file';\n\nexport class Media extends BaseFile\n{\n\tloadFirstPage(): Promise\n\t{\n\t\treturn this.loadFirstPageBySubType(SidebarFileTabTypes.media);\n\t}\n\n\tloadNextPage(): Promise\n\t{\n\t\treturn this.loadNextPageBySubType(SidebarFileTabTypes.media);\n\t}\n}","import {SidebarFileTabTypes} from 'im.v2.const';\nimport {BaseFile} from './base-file';\n\nexport class Audio extends BaseFile\n{\n\tloadFirstPage(): Promise\n\t{\n\t\treturn this.loadFirstPageBySubType(SidebarFileTabTypes.audio);\n\t}\n\n\tloadNextPage(): Promise\n\t{\n\t\treturn this.loadNextPageBySubType(SidebarFileTabTypes.audio);\n\t}\n}","import {SidebarFileTabTypes} from 'im.v2.const';\nimport {BaseFile} from './base-file';\n\nexport class Document extends BaseFile\n{\n\tloadFirstPage(): Promise\n\t{\n\t\treturn this.loadFirstPageBySubType(SidebarFileTabTypes.document);\n\t}\n\n\tloadNextPage(): Promise\n\t{\n\t\treturn this.loadNextPageBySubType(SidebarFileTabTypes.document);\n\t}\n}","import {SidebarFileTabTypes} from 'im.v2.const';\nimport {BaseFile} from './base-file';\n\nexport class Other extends BaseFile\n{\n\tloadFirstPage(): Promise\n\t{\n\t\treturn this.loadFirstPageBySubType(SidebarFileTabTypes.other);\n\t}\n\n\tloadNextPage(): Promise\n\t{\n\t\treturn this.loadNextPageBySubType(SidebarFileTabTypes.other);\n\t}\n}","import {RestMethod} from 'im.v2.const';\nimport {Base} from './base';\n\nconst REQUEST_ITEMS_LIMIT = 50;\nexport class Favorite extends Base\n{\n\thasMoreItemsToLoad: boolean = true;\n\tlastId: number = 0;\n\n\tgetInitialRequest()\n\t{\n\t\treturn {\n\t\t\t[RestMethod.imChatFavoriteCounterGet]: [RestMethod.imChatFavoriteCounterGet, {chat_id: this.chatId}],\n\t\t\t[RestMethod.imChatFavoriteGet]: [RestMethod.imChatFavoriteGet, {chat_id: this.chatId, limit: REQUEST_ITEMS_LIMIT}]\n\t\t};\n\t}\n\n\tgetResponseHandler()\n\t{\n\t\treturn (response) => {\n\t\t\tif (!response)\n\t\t\t{\n\t\t\t\treturn Promise.reject(new Error('SidebarInfo service error: no response'));\n\t\t\t}\n\n\t\t\tconst requestError = this.extractLoadCountersError(response);\n\t\t\tif (requestError)\n\t\t\t{\n\t\t\t\treturn Promise.reject(new Error(requestError));\n\t\t\t}\n\n\t\t\tconst favoriteCounterGetResponse = response[RestMethod.imChatFavoriteCounterGet].data();\n\t\t\tconst setCounterResult = this.store.dispatch('sidebar/favorites/setCounter', {\n\t\t\t\tchatId: this.chatId,\n\t\t\t\tcounter: favoriteCounterGetResponse.counter\n\t\t\t});\n\n\t\t\tconst setFavoriteResult = this.handleResponse(response[RestMethod.imChatFavoriteGet]);\n\n\t\t\treturn Promise.all([setCounterResult, setFavoriteResult]);\n\t\t};\n\t}\n\n\textractLoadCountersError(response): ?string\n\t{\n\t\tconst favoriteCounterGetResult = response[RestMethod.imChatFavoriteCounterGet];\n\t\tif (favoriteCounterGetResult?.error())\n\t\t{\n\t\t\treturn `SidebarInfo service error: ${RestMethod.imChatFavoriteCounterGet}: ${favoriteCounterGetResult?.error()}`;\n\t\t}\n\n\t\tconst favoriteGetResult = response[RestMethod.imChatFavoriteGet];\n\t\tif (favoriteGetResult?.error())\n\t\t{\n\t\t\treturn `SidebarInfo service error: ${RestMethod.imChatFavoriteGet}: ${favoriteGetResult?.error()}`;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tloadFirstPage(): Promise\n\t{\n\t\tconst favoritesCount = this.getFavoritesCountFromModel();\n\t\tif (favoritesCount > REQUEST_ITEMS_LIMIT)\n\t\t{\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\tconst queryParams = this.getQueryParams();\n\n\t\treturn this.requestPage(queryParams);\n\t}\n\n\tloadNextPage(): Promise\n\t{\n\t\tconst queryParams = this.getQueryParams();\n\n\t\treturn this.requestPage(queryParams);\n\t}\n\n\tgetQueryParams(): Object\n\t{\n\t\tconst queryParams = {\n\t\t\t'CHAT_ID': this.chatId,\n\t\t\t'LIMIT': REQUEST_ITEMS_LIMIT,\n\t\t};\n\n\t\tif (this.lastId > 0)\n\t\t{\n\t\t\tqueryParams.LAST_ID = this.lastId;\n\t\t}\n\n\t\treturn queryParams;\n\t}\n\n\trequestPage(queryParams): Promise\n\t{\n\t\treturn this.restClient.callMethod(RestMethod.imChatFavoriteGet, queryParams).then(response => {\n\t\t\treturn this.handleResponse(response);\n\t\t}).catch(error => {\n\t\t\tconsole.error('SidebarInfo: Im.imChatFavoriteGet: page request error', error);\n\t\t});\n\t}\n\n\thandleResponse(response): Promise\n\t{\n\t\tconst favoriteMessagesResult = response.data();\n\n\t\tif (favoriteMessagesResult.list.length < REQUEST_ITEMS_LIMIT)\n\t\t{\n\t\t\tthis.hasMoreItemsToLoad = false;\n\t\t}\n\n\t\tconst lastId = this.getLastElementId(favoriteMessagesResult.list);\n\t\tif (lastId)\n\t\t{\n\t\t\tthis.lastId = lastId;\n\t\t}\n\n\t\treturn this.updateModels(favoriteMessagesResult);\n\t}\n\n\tupdateModels(resultData: {list: [], users: [], files: []}): Promise\n\t{\n\t\tconst {list = [], users = [], files = []} = resultData;\n\t\tconst addUsersPromise = this.userManager.setUsersToModel(users);\n\n\t\tconst rawMessages = list.map(favorite => favorite.message);\n\n\t\tconst setFilesPromise = this.store.dispatch('files/set', files);\n\t\tconst storeMessagesPromise = this.store.dispatch('messages/store', rawMessages);\n\t\tconst setFavoritesPromise = this.store.dispatch('sidebar/favorites/set', {\n\t\t\tchatId: this.chatId,\n\t\t\tfavorites: list\n\t\t});\n\n\t\treturn Promise.all([\n\t\t\tsetFilesPromise, storeMessagesPromise, setFavoritesPromise, addUsersPromise\n\t\t]);\n\t}\n\n\tgetFavoritesCountFromModel(): number\n\t{\n\t\treturn this.store.getters['sidebar/favorites/getSize'](this.chatId);\n\t}\n}\n","import {RestMethod} from 'im.v2.const';\nimport {Base} from './base';\nimport {Type} from 'main.core';\n\nconst REQUEST_ITEMS_LIMIT = 50;\nexport class Link extends Base\n{\n\thasMoreItemsToLoad: boolean = true;\n\n\tgetInitialRequest()\n\t{\n\t\treturn {\n\t\t\t[RestMethod.imChatUrlCounterGet]: [RestMethod.imChatUrlCounterGet, {chat_id: this.chatId}],\n\t\t\t[RestMethod.imChatUrlGet]: [RestMethod.imChatUrlGet, {chat_id: this.chatId, limit: REQUEST_ITEMS_LIMIT}],\n\t\t};\n\t}\n\n\tgetResponseHandler()\n\t{\n\t\treturn (response) => {\n\t\t\tif (!response)\n\t\t\t{\n\t\t\t\treturn Promise.reject(new Error('SidebarInfo service error: no response'));\n\t\t\t}\n\n\t\t\tconst requestError = this.extractLoadCountersError(response);\n\t\t\tif (requestError)\n\t\t\t{\n\t\t\t\treturn Promise.reject(new Error(requestError));\n\t\t\t}\n\n\t\t\tconst linkCounterGetResponse = response[RestMethod.imChatUrlCounterGet].data();\n\t\t\tconst setCounterResult = this.store.dispatch('sidebar/links/setCounter', {\n\t\t\t\tchatId: this.chatId,\n\t\t\t\tcounter: linkCounterGetResponse.counter\n\t\t\t});\n\n\t\t\tconst setLinksResult = this.handleResponse(response[RestMethod.imChatUrlGet]);\n\n\t\t\treturn Promise.all([setCounterResult, setLinksResult]);\n\t\t};\n\t}\n\n\textractLoadCountersError(response): string\n\t{\n\t\tconst linkCounterGetResult = response[RestMethod.imChatUrlCounterGet];\n\t\tif (linkCounterGetResult?.error())\n\t\t{\n\t\t\treturn `SidebarInfo service error: ${RestMethod.imChatUrlCounterGet}: ${linkCounterGetResult?.error()}`;\n\t\t}\n\n\t\tconst linkGetResult = response[RestMethod.imChatUrlGet];\n\t\tif (linkGetResult?.error())\n\t\t{\n\t\t\treturn `SidebarInfo service error: ${RestMethod.imChatUrlGet}: ${linkGetResult?.error()}`;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tloadFirstPage(): Promise\n\t{\n\t\tconst linksCount = this.getLinksCountFromModel();\n\t\tif (linksCount > REQUEST_ITEMS_LIMIT)\n\t\t{\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\tconst queryParams = this.getQueryParams(linksCount);\n\n\t\treturn this.requestPage(queryParams);\n\t}\n\n\tloadNextPage(): Promise\n\t{\n\t\tconst linksCount = this.getLinksCountFromModel();\n\t\tconst queryParams = this.getQueryParams(linksCount);\n\n\t\treturn this.requestPage(queryParams);\n\t}\n\n\tgetQueryParams(offset: number = 0): Object\n\t{\n\t\tconst queryParams = {\n\t\t\t'CHAT_ID': this.chatId,\n\t\t\t'LIMIT': REQUEST_ITEMS_LIMIT,\n\t\t};\n\n\t\tif (Type.isNumber(offset) && offset > 0)\n\t\t{\n\t\t\tqueryParams.OFFSET = offset;\n\t\t}\n\n\t\treturn queryParams;\n\t}\n\n\trequestPage(queryParams): Promise\n\t{\n\t\treturn this.restClient.callMethod(RestMethod.imChatUrlGet, queryParams).then(response => {\n\t\t\treturn this.handleResponse(response);\n\t\t}).catch(error => {\n\t\t\tconsole.error('SidebarInfo: Im.chatUrlList: page request error', error);\n\t\t});\n\t}\n\n\thandleResponse(response): Promise\n\t{\n\t\tconst resultData = response.data();\n\t\tif (resultData.list.length < REQUEST_ITEMS_LIMIT)\n\t\t{\n\t\t\tthis.hasMoreItemsToLoad = false;\n\t\t}\n\n\t\treturn this.updateModels(resultData);\n\t}\n\n\tupdateModels(resultData): Promise\n\t{\n\t\tconst {list, users} = resultData;\n\n\t\tconst addUsersPromise = this.userManager.setUsersToModel(users);\n\t\tconst setLinksPromise = this.store.dispatch('sidebar/links/set', {\n\t\t\tchatId: this.chatId,\n\t\t\tlinks: list\n\t\t});\n\n\t\treturn Promise.all([setLinksPromise, addUsersPromise]);\n\t}\n\n\tgetLinksCountFromModel(): number\n\t{\n\t\treturn this.store.getters['sidebar/links/getSize'](this.chatId);\n\t}\n}\n","import {RestMethod} from 'im.v2.const';\nimport {Base} from './base';\n\nconst REQUEST_ITEMS_LIMIT = 50;\n\nexport class Task extends Base\n{\n\thasMoreItemsToLoad: boolean = true;\n\tlastId: number = 0;\n\n\tgetInitialRequest()\n\t{\n\t\treturn {\n\t\t\t[RestMethod.imChatTaskGet]: [RestMethod.imChatTaskGet, {chat_id: this.chatId, limit: REQUEST_ITEMS_LIMIT}]\n\t\t};\n\t}\n\n\tgetResponseHandler()\n\t{\n\t\treturn (response) => {\n\t\t\tif (!response)\n\t\t\t{\n\t\t\t\treturn Promise.reject(new Error('SidebarInfo service error: no response'));\n\t\t\t}\n\n\t\t\tconst requestError = this.extractLoadTaskError(response);\n\t\t\tif (requestError)\n\t\t\t{\n\t\t\t\treturn Promise.reject(new Error(requestError));\n\t\t\t}\n\n\t\t\treturn this.handleResponse(response[RestMethod.imChatTaskGet]);\n\t\t};\n\t}\n\n\textractLoadTaskError(response): ?string\n\t{\n\t\tconst taskGetResponse = response[RestMethod.imChatTaskGet];\n\t\tif (taskGetResponse?.error())\n\t\t{\n\t\t\treturn `Sidebar service error: ${RestMethod.imChatTaskGet}: ${taskGetResponse?.error()}`;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tloadFirstPage(): Promise\n\t{\n\t\tconst tasksCount = this.getTasksCountFromModel();\n\t\tif (tasksCount > REQUEST_ITEMS_LIMIT)\n\t\t{\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\tconst queryParams = this.getQueryParams();\n\n\t\treturn this.requestPage(queryParams);\n\t}\n\n\tloadNextPage(): Promise\n\t{\n\t\tconst queryParams = this.getQueryParams();\n\n\t\treturn this.requestPage(queryParams);\n\t}\n\n\tgetQueryParams(): Object\n\t{\n\t\tconst queryParams = {\n\t\t\t'CHAT_ID': this.chatId,\n\t\t\t'LIMIT': REQUEST_ITEMS_LIMIT,\n\t\t};\n\n\t\tif (this.lastId > 0)\n\t\t{\n\t\t\tqueryParams['LAST_ID'] = this.lastId;\n\t\t}\n\n\t\treturn queryParams;\n\t}\n\n\trequestPage(queryParams): Promise\n\t{\n\t\treturn this.restClient.callMethod(RestMethod.imChatTaskGet, queryParams).then(response => {\n\t\t\treturn this.handleResponse(response);\n\t\t}).catch(error => {\n\t\t\tconsole.error('SidebarInfo: Im.imChatFavoriteGet: page request error', error);\n\t\t});\n\t}\n\n\thandleResponse(response): Promise\n\t{\n\t\tconst tasksResult = response.data();\n\t\tif (tasksResult.list.length < REQUEST_ITEMS_LIMIT)\n\t\t{\n\t\t\tthis.hasMoreItemsToLoad = false;\n\t\t}\n\n\t\tthis.firstPageReceived = true;\n\t\tthis.lastId = this.getLastElementId(tasksResult.list);\n\n\t\treturn this.updateModels(tasksResult);\n\t}\n\n\tupdateModels(resultData): Promise\n\t{\n\t\tconst {list, users} = resultData;\n\n\t\tconst addUsersPromise = this.userManager.setUsersToModel(users);\n\t\tconst setTasksPromise = this.store.dispatch('sidebar/tasks/set', {\n\t\t\tchatId: this.chatId,\n\t\t\ttasks: list\n\t\t});\n\n\t\treturn Promise.all([setTasksPromise, addUsersPromise]);\n\t}\n\n\tgetTasksCountFromModel(): number\n\t{\n\t\treturn this.store.getters['sidebar/tasks/getSize'](this.chatId);\n\t}\n}","import {RestMethod} from 'im.v2.const';\nimport {Base} from './base';\n\nconst REQUEST_ITEMS_LIMIT = 50;\n\nexport class Main extends Base\n{\n\thasMoreItemsToLoad: boolean = true;\n\tlastId: number = 0;\n\n\tgetInitialRequest()\n\t{\n\t\treturn {\n\t\t\t[RestMethod.imDialogUsersList]: [RestMethod.imDialogUsersList, {\n\t\t\t\tdialog_id: this.dialogId,\n\t\t\t\tlimit: REQUEST_ITEMS_LIMIT\n\t\t\t}]\n\t\t};\n\t}\n\n\tloadFirstPage(): Promise\n\t{\n\t\tconst membersCount = this.getMembersCountFromModel();\n\t\tif (membersCount > REQUEST_ITEMS_LIMIT)\n\t\t{\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\tconst queryParams = this.getQueryParams();\n\n\t\treturn this.requestPage(queryParams);\n\t}\n\n\tloadNextPage(): Promise\n\t{\n\t\tconst queryParams = this.getQueryParams();\n\n\t\treturn this.requestPage(queryParams);\n\t}\n\n\tgetQueryParams(): Object\n\t{\n\t\treturn {\n\t\t\t'DIALOG_ID': this.dialogId,\n\t\t\t'LIMIT': REQUEST_ITEMS_LIMIT,\n\t\t\t'LAST_ID': this.lastId,\n\t\t};\n\t}\n\n\trequestPage(queryParams): Promise\n\t{\n\t\treturn this.restClient.callMethod(RestMethod.imDialogUsersList, queryParams).then(response => {\n\t\t\treturn this.handleResponse(response);\n\t\t}).catch(error => {\n\t\t\tconsole.error('SidebarMain: Im.DialogUsersList: page request error', error);\n\t\t});\n\t}\n\n\tgetResponseHandler(): Function\n\t{\n\t\treturn (response) => {\n\t\t\treturn this.handleResponse(response[RestMethod.imDialogUsersList]);\n\t\t};\n\t}\n\n\tupdateModels(users: Array): Promise\n\t{\n\t\tconst userIds = [];\n\t\tconst addUsersPromise = this.userManager.setUsersToModel(users);\n\t\tusers.forEach(user => {\n\t\t\tuserIds.push(user.id);\n\t\t});\n\n\t\tconst setMembersPromise = this.store.dispatch('sidebar/members/set', {\n\t\t\tchatId: this.chatId,\n\t\t\tusers: userIds\n\t\t});\n\n\t\treturn Promise.all([addUsersPromise, setMembersPromise]);\n\t}\n\n\tgetMembersCountFromModel(): number\n\t{\n\t\treturn this.store.getters['sidebar/members/getSize'](this.chatId);\n\t}\n\n\thandleResponse(response): Promise\n\t{\n\t\tconst users = response.data();\n\t\tif (users.length < REQUEST_ITEMS_LIMIT)\n\t\t{\n\t\t\tthis.hasMoreItemsToLoad = false;\n\t\t}\n\n\t\tconst lastId = this.getLastElementId(users);\n\t\tif (lastId)\n\t\t{\n\t\t\tthis.lastId = lastId;\n\t\t}\n\n\t\treturn this.updateModels(users);\n\t}\n}\n","import {SidebarFileTypes} from 'im.v2.const';\nimport {BaseFile} from './base-file';\n\nexport class Brief extends BaseFile\n{\n\tloadFirstPage(): Promise\n\t{\n\t\treturn this.loadFirstPageBySubType(SidebarFileTypes.brief);\n\t}\n\n\tloadNextPage(): Promise\n\t{\n\t\treturn this.loadNextPageBySubType(SidebarFileTypes.brief);\n\t}\n}","import {RestMethod} from 'im.v2.const';\nimport {Base} from './base';\n\nconst REQUEST_ITEMS_LIMIT = 50;\n\nexport class Meeting extends Base\n{\n\tgetInitialRequest()\n\t{\n\t\treturn {\n\t\t\t[RestMethod.imChatCalendarGet]: [RestMethod.imChatCalendarGet, {\n\t\t\t\tchat_id: this.chatId,\n\t\t\t\tlimit: REQUEST_ITEMS_LIMIT\n\t\t\t}]\n\t\t};\n\t}\n\n\tgetResponseHandler()\n\t{\n\t\treturn (response) => {\n\t\t\tif (!response)\n\t\t\t{\n\t\t\t\treturn Promise.reject(new Error('SidebarInfo service error: no response'));\n\t\t\t}\n\n\t\t\tconst requestError = this.extractLoadTaskError(response);\n\t\t\tif (requestError)\n\t\t\t{\n\t\t\t\treturn Promise.reject(new Error(requestError));\n\t\t\t}\n\n\t\t\treturn this.handleResponse(response[RestMethod.imChatCalendarGet]);\n\t\t};\n\t}\n\n\textractLoadTaskError(response): ?string\n\t{\n\t\tconst calendarGetResponse = response[RestMethod.imChatCalendarGet];\n\t\tif (calendarGetResponse?.error())\n\t\t{\n\t\t\treturn `Sidebar service error: ${RestMethod.imChatCalendarGet}: ${calendarGetResponse?.error()}`;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tloadFirstPage(): Promise\n\t{\n\t\tconst meetingsCount = this.getMeetingsCountFromState();\n\t\tif (meetingsCount > REQUEST_ITEMS_LIMIT)\n\t\t{\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\tconst queryParams = this.getQueryParams();\n\n\t\treturn this.requestPage(queryParams);\n\t}\n\n\tloadNextPage(): Promise\n\t{\n\t\tconst queryParams = this.getQueryParams();\n\n\t\treturn this.requestPage(queryParams);\n\t}\n\n\tgetQueryParams(): Object\n\t{\n\t\tconst queryParams = {\n\t\t\t'CHAT_ID': this.chatId,\n\t\t\t'LIMIT': REQUEST_ITEMS_LIMIT,\n\t\t};\n\n\t\tif (this.lastId > 0)\n\t\t{\n\t\t\tqueryParams['LAST_ID'] = this.lastId;\n\t\t}\n\n\t\treturn queryParams;\n\t}\n\n\trequestPage(queryParams): Promise\n\t{\n\t\treturn this.restClient.callMethod(RestMethod.imChatCalendarGet, queryParams).then(response => {\n\t\t\treturn this.handleResponse(response);\n\t\t}).catch(error => {\n\t\t\tconsole.error('SidebarInfo: Im.imChatCalendarGet: page request error', error);\n\t\t});\n\t}\n\n\tupdateModels(resultData): Promise\n\t{\n\t\tconst {list, users} = resultData;\n\n\t\tconst addUsersPromise = this.userManager.setUsersToModel(users);\n\t\tconst setMeetingsPromise = this.store.dispatch('sidebar/meetings/set', {\n\t\t\tchatId: this.chatId,\n\t\t\tmeetings: list\n\t\t});\n\n\t\treturn Promise.all([setMeetingsPromise, addUsersPromise]);\n\t}\n\n\thandleResponse(response): Promise\n\t{\n\t\tconst meetingsResult = response.data();\n\t\tif (meetingsResult.list.length < REQUEST_ITEMS_LIMIT)\n\t\t{\n\t\t\tthis.hasMoreItemsToLoad = false;\n\t\t}\n\n\t\tthis.lastId = this.getLastElementId(meetingsResult.list);\n\n\t\treturn this.updateModels(meetingsResult);\n\t}\n\n\tgetMeetingsCountFromState(): number\n\t{\n\t\treturn this.store.getters['sidebar/meetings/getSize'](this.chatId);\n\t}\n}","import {RestMethod, SidebarDetailBlock} from 'im.v2.const';\nimport {Base} from './base';\n\nconst REQUEST_ITEMS_LIMIT = 50; // temporary value. Should be 50\n\nexport class FileUnsorted extends Base\n{\n\thasMoreItemsToLoad: boolean = true;\n\tlastId: number = 0;\n\n\tgetInitialRequest()\n\t{\n\t\treturn {\n\t\t\t[RestMethod.imDiskFolderListGet]: [RestMethod.imDiskFolderListGet, {chat_id: this.chatId, limit: REQUEST_ITEMS_LIMIT}],\n\t\t};\n\t}\n\n\tgetResponseHandler()\n\t{\n\t\treturn (response) => {\n\t\t\tif (!response)\n\t\t\t{\n\t\t\t\treturn Promise.reject(new Error('SidebarInfo service error: no response'));\n\t\t\t}\n\n\t\t\tconst requestError = this.extractLoadFileError(response);\n\t\t\tif (requestError)\n\t\t\t{\n\t\t\t\treturn Promise.reject(new Error(requestError));\n\t\t\t}\n\n\t\t\tconst fileResult = response[RestMethod.imDiskFolderListGet].data();\n\n\t\t\treturn this.updateModels(fileResult);\n\t\t};\n\t}\n\n\textractLoadFileError(response): ?string\n\t{\n\t\tconst diskFolderListGetResult = response[RestMethod.imDiskFolderListGet];\n\t\tif (diskFolderListGetResult?.error())\n\t\t{\n\t\t\treturn `SidebarInfo service error: ${RestMethod.imDiskFolderListGet}: ${diskFolderListGetResult?.error()}`;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tloadFirstPage(): Promise\n\t{\n\t\tconst filesCount = this.getFilesCountFromModel(SidebarDetailBlock.fileUnsorted);\n\t\tif (filesCount > REQUEST_ITEMS_LIMIT)\n\t\t{\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\tconst queryParams = this.getQueryParams();\n\n\t\treturn this.requestPage(queryParams);\n\t}\n\n\tloadNextPage(): Promise\n\t{\n\t\tconst queryParams = this.getQueryParams();\n\n\t\treturn this.requestPage(queryParams);\n\t}\n\n\tgetQueryParams(): Object\n\t{\n\t\tconst queryParams = {\n\t\t\t'CHAT_ID': this.chatId,\n\t\t\t'LIMIT': REQUEST_ITEMS_LIMIT,\n\t\t};\n\n\t\tif (this.lastId > 0)\n\t\t{\n\t\t\tqueryParams.LAST_ID = this.lastId;\n\t\t}\n\n\t\treturn queryParams;\n\t}\n\n\trequestPage(queryParams): Promise\n\t{\n\t\treturn this.restClient.callMethod(RestMethod.imDiskFolderListGet, queryParams).then(response => {\n\t\t\treturn this.handleResponse(response);\n\t\t}).catch(error => {\n\t\t\tconsole.error('SidebarInfo: Im.imDiskFolderListGet: page request error', error);\n\t\t});\n\t}\n\n\thandleResponse(response): Promise\n\t{\n\t\tconst diskFolderListGetResult = response.data();\n\t\tif (diskFolderListGetResult.files.length < REQUEST_ITEMS_LIMIT)\n\t\t{\n\t\t\tthis.hasMoreItemsToLoad = false;\n\t\t}\n\n\t\tconst lastId = this.getLastElementId(diskFolderListGetResult.files);\n\t\tif (lastId)\n\t\t{\n\t\t\tthis.lastId = lastId;\n\t\t}\n\n\t\treturn this.updateModels(diskFolderListGetResult);\n\t}\n\n\tupdateModels(resultData): Promise\n\t{\n\t\tconst {users, files} = resultData;\n\n\t\tconst preparedFiles = files.map(file => {\n\t\t\treturn {...file, subType: SidebarDetailBlock.fileUnsorted};\n\t\t});\n\n\t\tconst addUsersPromise = this.userManager.setUsersToModel(users);\n\t\tconst setFilesPromise = this.store.dispatch('files/set', preparedFiles);\n\t\tconst setSidebarFilesPromise = this.store.dispatch('sidebar/files/set', {\n\t\t\tchatId: this.chatId,\n\t\t\tfiles: preparedFiles\n\t\t});\n\n\t\treturn Promise.all([\n\t\t\tsetFilesPromise, setSidebarFilesPromise, addUsersPromise\n\t\t]);\n\t}\n\n\tgetFilesCountFromModel(subType): number\n\t{\n\t\treturn this.store.getters['sidebar/files/getSize'](this.chatId, subType);\n\t}\n}","import {Extension} from 'main.core';\n\nimport {Core} from 'im.v2.application.core';\n\nexport class SettingsManager\n{\n\tstore: Object = null;\n\tsettings: Object = null;\n\n\tconstructor()\n\t{\n\t\tthis.store = Core.getStore();\n\t\tthis.settings = Extension.getSettings('im.v2.component.sidebar');\n\t\tthis.saveSettings();\n\t}\n\n\tsaveSettings()\n\t{\n\t\tthis.store.dispatch('sidebar/setFilesMigrated', this.settings.get('filesMigrated', false));\n\t\tthis.store.dispatch('sidebar/setLinksMigrated', this.settings.get('linksAvailable', false));\n\t}\n\n\tgetBlocks(): string[]\n\t{\n\t\treturn this.settings.get('blocks', []);\n\t}\n\n\tisLinksMigrationFinished(): boolean\n\t{\n\t\treturn this.store.state.sidebar.isLinksMigrated;\n\t}\n\n\tcanShowBriefs(): boolean\n\t{\n\t\treturn this.settings.get('canShowBriefs', false);\n\t}\n\n\tisFileMigrationFinished(): boolean\n\t{\n\t\treturn this.store.state.sidebar.isFilesMigrated;\n\t}\n}","import {Store} from 'ui.vue3.vuex';\n\nimport {Core} from 'im.v2.application.core';\nimport {PlacementType, SidebarBlock} from 'im.v2.const';\nimport {MarketManager} from 'im.v2.lib.market';\n\nimport {SettingsManager} from './settings-manager';\n\nconst BLOCKS_ORDER = {\n\t[SidebarBlock.main]: 10,\n\t[SidebarBlock.info]: 20,\n\t[SidebarBlock.file]: 30,\n\t[SidebarBlock.brief]: 40,\n\t[SidebarBlock.sign]: 50,\n\t[SidebarBlock.task]: 60,\n\t[SidebarBlock.meeting]: 70,\n};\n\nexport class AvailabilityManager\n{\n\t#settingsManager: SettingsManager = null;\n\t#store: Store;\n\t#dialogId: string;\n\n\tconstructor(settingsManager: SettingsManager, dialogId: string)\n\t{\n\t\tthis.#settingsManager = settingsManager;\n\t\tthis.#store = Core.getStore();\n\t\tthis.#dialogId = dialogId;\n\t}\n\n\tgetBlocks(): string[]\n\t{\n\t\tconst blocksFromSetting = this.#settingsManager.getBlocks();\n\t\tconst availableBlocks = this.#filterUnavailableBlocks(blocksFromSetting);\n\n\t\treturn this.#sortBlocks(availableBlocks);\n\t}\n\n\t#filterUnavailableBlocks(blocks: string[]): string[]\n\t{\n\t\tconst blocksSet = new Set(blocks);\n\n\t\tif (this.#isFileMigrationFinished())\n\t\t{\n\t\t\tblocksSet.delete(SidebarBlock.fileUnsorted);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tblocksSet.delete(SidebarBlock.brief);\n\t\t\tblocksSet.delete(SidebarBlock.file);\n\t\t}\n\n\t\tif (!this.#canShowBriefs())\n\t\t{\n\t\t\tblocksSet.delete(SidebarBlock.brief);\n\t\t}\n\n\t\tif (!this.#hasMarketApps())\n\t\t{\n\t\t\tblocksSet.delete(SidebarBlock.market);\n\t\t}\n\n\t\treturn [...blocksSet];\n\t}\n\n\t#isFileMigrationFinished(): boolean\n\t{\n\t\treturn this.#settingsManager.isFileMigrationFinished();\n\t}\n\n\t#canShowBriefs(): boolean\n\t{\n\t\treturn this.#settingsManager.canShowBriefs();\n\t}\n\n\t#hasMarketApps(): boolean\n\t{\n\t\treturn MarketManager.getInstance().getAvailablePlacementsByType(PlacementType.sidebar, this.#dialogId).length > 0;\n\t}\n\n\t#sortBlocks(availableBlocks: string[]): string[]\n\t{\n\t\treturn [...availableBlocks].sort((block1, block2) => {\n\t\t\treturn BLOCKS_ORDER[block1] - BLOCKS_ORDER[block2];\n\t\t});\n\t}\n}","import {Text, Type} from 'main.core';\n\nimport {Core} from 'im.v2.application.core';\nimport {SidebarDetailBlock, SidebarBlock} from 'im.v2.const';\n\nimport {Media} from './blocks/media';\nimport {Audio} from './blocks/audio';\nimport {Document} from './blocks/document';\nimport {Other} from './blocks/other';\nimport {Favorite} from './blocks/favorite';\nimport {Link} from './blocks/link';\nimport {Task} from './blocks/task';\nimport {Main} from './blocks/main';\nimport {Brief} from './blocks/brief';\nimport {Meeting} from './blocks/meeting';\nimport {FileUnsorted} from './blocks/file-unsorted';\nimport {AvailabilityManager} from './availability-manager';\n\n\nconst BlockClasses = {\n\tMain, Favorite, Link, Task, Media, Audio, Document, Other, Brief, Meeting, FileUnsorted\n};\n\nconst BlockToServices = Object.freeze({\n\t[SidebarBlock.main]: [SidebarDetailBlock.main],\n\t[SidebarBlock.info]: [SidebarDetailBlock.favorite, SidebarDetailBlock.link],\n\t[SidebarBlock.task]: [SidebarDetailBlock.task],\n\t[SidebarBlock.meeting]: [SidebarDetailBlock.meeting],\n\t[SidebarBlock.brief]: [SidebarDetailBlock.brief],\n\t[SidebarBlock.file]: [SidebarDetailBlock.media, SidebarDetailBlock.audio, SidebarDetailBlock.document, SidebarDetailBlock.other],\n\t[SidebarBlock.fileUnsorted]: [SidebarDetailBlock.fileUnsorted],\n});\n\ntype BlockService = {\n\ttype: string;\n\tblockManager: Object;\n\tinitialRequest: Object;\n\tresponseHandler: Function;\n};\n\nexport class SidebarService\n{\n\tblockServices: BlockService[] = [];\n\tdialogId: string = '';\n\tchatId: number = 0;\n\tstore: Object = null;\n\trestClient: Object = null;\n\tavailabilityManager: AvailabilityManager = null;\n\n\tconstructor(availabilityManager: AvailabilityManager)\n\t{\n\t\tthis.store = Core.getStore();\n\t\tthis.restClient = Core.getRestClient();\n\t\tthis.availabilityManager = availabilityManager;\n\t}\n\n\t//region public methods\n\trequestInitialData(): Promise\n\t{\n\t\tif (!Type.isArrayFilled(this.blockServices))\n\t\t{\n\t\t\tthis.buildBlocks();\n\t\t}\n\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.restClient.callBatch(\n\t\t\t\tthis.getInitialRequestQuery(),\n\t\t\t\t(result) => resolve(this.handleBatchRequestResult(result)),\n\t\t\t\t(error) => reject(error)\n\t\t\t);\n\t\t});\n\t}\n\n\tgetBlockInstance(blockName: string)\n\t{\n\t\tif (!Type.isArrayFilled(this.blockServices))\n\t\t{\n\t\t\tthis.buildBlocks();\n\t\t}\n\n\t\treturn this.blockServices.find((block: BlockService) => block.type === blockName.toLowerCase())?.blockManager;\n\t}\n\n\tsetChatId(chatId: number)\n\t{\n\t\tthis.chatId = chatId;\n\t}\n\n\tsetDialogId(dialogId: string)\n\t{\n\t\tthis.dialogId = dialogId;\n\t}\n\t//endregion\n\n\tbuildBlocks(): void\n\t{\n\t\tconst classNames = this.getServiceClassesForBlocks();\n\n\t\tthis.blockServices = classNames.map((className: string): BlockService => {\n\t\t\tconst blockManager = new BlockClasses[className](this.chatId, this.dialogId);\n\n\t\t\treturn {\n\t\t\t\ttype: className.toLowerCase(),\n\t\t\t\tblockManager: blockManager,\n\t\t\t\tinitialRequest: blockManager.getInitialRequest(),\n\t\t\t\tresponseHandler: blockManager.getResponseHandler(),\n\t\t\t};\n\t\t});\n\t}\n\n\tgetServiceClassesForBlocks(): string[]\n\t{\n\t\tconst services = [];\n\n\t\tconst blockList = this.availabilityManager.getBlocks();\n\t\tblockList.forEach((block: string) => {\n\t\t\tconst blockServices = BlockToServices[block];\n\t\t\tif (blockServices)\n\t\t\t{\n\t\t\t\tservices.push(...blockServices);\n\t\t\t}\n\t\t});\n\n\t\treturn services.map(service => Text.capitalize(service));\n\t}\n\n\tgetInitialRequestQuery(): Object\n\t{\n\t\tlet query = {};\n\t\tthis.blockServices.forEach(block => {\n\t\t\tquery = Object.assign(query, block.initialRequest);\n\t\t});\n\n\t\treturn query;\n\t}\n\n\thandleBatchRequestResult(response): Promise\n\t{\n\t\tconst responseHandlersResult = [];\n\t\tthis.blockServices.forEach(block => {\n\t\t\tresponseHandlersResult.push(block.responseHandler(response));\n\t\t});\n\n\t\treturn Promise.all(responseHandlersResult).then(() => {\n\t\t\treturn this.setInited();\n\t\t}).catch(error => console.error(error));\n\t}\n\n\tsetInited(): Promise\n\t{\n\t\treturn this.store.dispatch('sidebar/setInited', this.chatId);\n\t}\n}","import {Avatar, AvatarSize, ChatTitle} from 'im.v2.component.elements';\nimport type {ImModelUser} from 'im.v2.model';\n\n// @vue/component\nexport const DetailUser = {\n\tname: 'DetailUser',\n\tcomponents: {Avatar, ChatTitle},\n\tprops: {\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true\n\t\t},\n\t\tisModerator: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false\n\t\t}\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tshowContextButton: false,\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tAvatarSize: () => AvatarSize,\n\t\tposition(): string\n\t\t{\n\t\t\treturn this.$store.getters['users/getPosition'](this.dialogId);\n\t\t},\n\t\tuser(): ImModelUser\n\t\t{\n\t\t\treturn this.$store.getters['users/get'](this.dialogId, true);\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tonClickContextMenu(event)\n\t\t{\n\t\t\tthis.$emit('contextMenuClick', {\n\t\t\t\tuserDialogId: this.dialogId,\n\t\t\t\ttarget: event.currentTarget,\n\t\t\t});\n\t\t}\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tclass=\"bx-im-sidebar-main-detail__user\"\n\t\t\t@mouseover=\"showContextButton = true\"\n\t\t\t@mouseleave=\"showContextButton = false\"\n\t\t>\n\t\t\t<div class=\"bx-im-sidebar-main-detail__avatar-container\">\n\t\t\t\t<Avatar :size=\"AvatarSize.L\" :dialogId=\"dialogId\" />\n\t\t\t\t<span v-if=\"isModerator\" class=\"bx-im-sidebar-main-detail__avatar-moderator-icon\"></span>\n\t\t\t</div>\n\t\t\t<div class=\"bx-im-sidebar-main-detail__user-info-container\">\n\t\t\t\t<div class=\"bx-im-sidebar-main-detail__user-title-container\">\n\t\t\t\t\t<ChatTitle :dialogId=\"dialogId\" class=\"bx-im-sidebar-main-detail__user-title-text\" />\n\t\t\t\t\t<div\n\t\t\t\t\t\tv-if=\"showContextButton\"\n\t\t\t\t\t\tclass=\"bx-im-sidebar-main-detail__context-menu-icon bx-im-messenger__context-menu-icon\"\n\t\t\t\t\t\t@click=\"onClickContextMenu\"\n\t\t\t\t\t></div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"bx-im-sidebar-main-detail__position-text\" :title=\"position\">\n\t\t\t\t\t{{ position }}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\t\n\t`\n};","import {Loader} from 'im.v2.component.elements';\nimport '../css/detail.css';\n\n// @vue/component\nexport const SidebarDetail = {\n\tname: 'SidebarDetail',\n\tcomponents: {Loader},\n\tprops: {\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true\n\t\t},\n\t\tchatId: {\n\t\t\ttype: Number,\n\t\t\trequired: true\n\t\t},\n\t\tservice: {\n\t\t\ttype: Object,\n\t\t\trequired: true\n\t\t}\n\t},\n\temits: ['onScroll'],\n\tdata() {\n\t\treturn {\n\t\t\tisLoading: false\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\thasInitialData(): boolean\n\t\t{\n\t\t\treturn this.$store.getters['sidebar/isInited'](this.chatId);\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tthis.loadFirstPage();\n\t},\n\tmethods:\n\t{\n\t\tloadFirstPage()\n\t\t{\n\t\t\tif (this.hasInitialData)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.isLoading = true;\n\t\t\tthis.service.loadFirstPage().then(() => {\n\t\t\t\tthis.isLoading = false;\n\t\t\t});\n\t\t},\n\t\tneedToLoadNextPage(event)\n\t\t{\n\t\t\treturn event.target.scrollTop + event.target.clientHeight >= event.target.scrollHeight - event.target.clientHeight;\n\t\t},\n\t\tonScroll(event)\n\t\t{\n\t\t\tthis.$emit('onScroll');\n\n\t\t\tif (this.isLoading)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!this.needToLoadNextPage(event) || !this.service.hasMoreItemsToLoad)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.isLoading = true;\n\t\t\tthis.service.loadNextPage().then(() => {\n\t\t\t\tthis.isLoading = false;\n\t\t\t});\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-sidebar-detail__container bx-im-sidebar-detail__scope\" @scroll=\"onScroll\">\n\t\t\t<slot :isLoading=\"isLoading\" :chatId=\"chatId\" :dialogId=\"dialogId\"></slot>\n\t\t\t<Loader v-if=\"isLoading\" class=\"bx-im-sidebar-detail__loader-container\" />\n\t\t</div>\n\t`\n};","import {Loc} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport {BaseMenu} from 'im.v2.lib.menu';\nimport {EventType} from 'im.v2.const';\nimport type {MenuItem} from 'im.v2.lib.menu';\n\nexport class SidebarMenu extends BaseMenu\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis.id = 'im-sidebar-context-menu';\n\t}\n\n\tgetMenuOptions(): Object\n\t{\n\t\treturn {\n\t\t\t...super.getMenuOptions(),\n\t\t\tclassName: this.getMenuClassName(),\n\t\t};\n\t}\n\n\tgetOpenContextMessageItem(): ?MenuItem\n\t{\n\t\tif (!this.context.messageId || this.context.messageId === 0)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\ttext: Loc.getMessage('IM_SIDEBAR_MENU_GO_TO_CONTEXT_MESSAGE'),\n\t\t\tonclick: () => {\n\t\t\t\tEventEmitter.emit(EventType.dialog.goToMessageContext, {\n\t\t\t\t\tmessageId: this.context.messageId,\n\t\t\t\t\tdialogId: this.context.dialogId,\n\t\t\t\t});\n\n\t\t\t\tthis.menuInstance.close();\n\t\t\t}\n\t\t};\n\t}\n\n\tgetCopyLinkItem(title: string): ?MenuItem\n\t{\n\t\tif (!BX.clipboard.isCopySupported())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\ttext: title,\n\t\t\tonclick: () => {\n\t\t\t\tif (BX.clipboard.copy(this.context.source))\n\t\t\t\t{\n\t\t\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\t\t\tcontent: Loc.getMessage('IM_SIDEBAR_COPIED_SUCCESS')\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tthis.menuInstance.close();\n\t\t\t}\n\t\t};\n\t}\n}","import {Loc} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\n\nimport {Utils} from 'im.v2.lib.utils';\nimport {CallManager} from 'im.v2.lib.call';\nimport {EventType} from 'im.v2.const';\nimport {ChatService} from 'im.v2.provider.service';\nimport {Messenger} from 'im.public';\n\nimport {SidebarMenu} from '../sidebar-base-menu';\n\nimport type {ImModelUser} from 'im.v2.model';\nimport type {MenuItem} from 'im.v2.lib.menu';\n\ntype MembersMenuContext = {\n\tdialogId: string,\n\tcontextDialogId: string,\n\tcontextChatId: string,\n};\n\nexport class MembersMenu extends SidebarMenu\n{\n\tcontext: MembersMenuContext;\n\tchatService: ChatService;\n\tcallManager: CallManager;\n\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis.chatService = new ChatService();\n\t\tthis.callManager = CallManager.getInstance();\n\t}\n\n\tgetMenuItems(): MenuItem[]\n\t{\n\t\treturn [\n\t\t\tthis.getInsertNameItem(),\n\t\t\tthis.getSendMessageItem(),\n\t\t\tthis.getCallItem(),\n\t\t\tthis.getOpenProfileItem(),\n\t\t\tthis.getOpenUserCalendarItem(),\n\t\t\tthis.getKickItem(),\n\t\t\tthis.getLeaveItem(),\n\t\t];\n\t}\n\n\tgetInsertNameItem(): MenuItem\n\t{\n\t\tconst user: ImModelUser = this.store.getters['users/get'](this.context.dialogId, true);\n\n\t\treturn {\n\t\t\ttext: Loc.getMessage('IM_SIDEBAR_MENU_INSERT_NAME'),\n\t\t\tonclick: () => {\n\t\t\t\tEventEmitter.emit(EventType.textarea.insertMention, {\n\t\t\t\t\tmentionText: user.name,\n\t\t\t\t\tmentionReplacement: Utils.user.getMentionBbCode(this.context.dialogId, user.name)\n\t\t\t\t});\n\t\t\t\tthis.menuInstance.close();\n\t\t\t}\n\t\t};\n\t}\n\n\tgetSendMessageItem(): MenuItem\n\t{\n\t\treturn {\n\t\t\ttext: Loc.getMessage('IM_LIB_MENU_WRITE'),\n\t\t\tonclick: () => {\n\t\t\t\tMessenger.openChat(this.context.dialogId);\n\t\t\t\tthis.menuInstance.close();\n\t\t\t}\n\t\t};\n\t}\n\n\tgetCallItem(): ?MenuItem\n\t{\n\t\tif (!this.callManager.chatCanBeCalled(this.context.dialogId))\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\ttext: Loc.getMessage('IM_LIB_MENU_CALL'),\n\t\t\tonclick: () => {\n\t\t\t\tEventEmitter.emit(EventType.dialog.call, this.context);\n\t\t\t\tthis.menuInstance.close();\n\t\t\t}\n\t\t};\n\t}\n\n\tgetOpenProfileItem(): ?MenuItem\n\t{\n\t\tconst isUser = this.store.getters['dialogues/isUser'](this.context.dialogId);\n\t\tif (!isUser)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst profileUri = Utils.user.getProfileLink(this.context.dialogId);\n\n\t\treturn {\n\t\t\ttext: Loc.getMessage('IM_LIB_MENU_OPEN_PROFILE'),\n\t\t\thref: profileUri,\n\t\t\tonclick: () => {\n\t\t\t\tthis.menuInstance.close();\n\t\t\t}\n\t\t};\n\t}\n\n\tgetOpenUserCalendarItem(): ?MenuItem\n\t{\n\t\tconst isUser = this.store.getters['dialogues/isUser'](this.context.dialogId);\n\t\tif (!isUser)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\t\tconst user = this.store.getters['users/get'](this.context.dialogId, true);\n\t\tif (user.bot)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst profileUri = Utils.user.getCalendarLink(this.context.dialogId);\n\n\t\treturn {\n\t\t\ttext: Loc.getMessage('IM_LIB_MENU_OPEN_CALENDAR'),\n\t\t\tonclick: () => {\n\t\t\t\tBX.SidePanel.Instance.open(profileUri);\n\t\t\t\tthis.menuInstance.close();\n\t\t\t}\n\t\t};\n\t}\n\n\tgetKickItem(): ?MenuItem\n\t{\n\t\tconst userIdToKick = Number.parseInt(this.context.dialogId, 10);\n\t\tconst isSelfKick = userIdToKick === this.getCurrentUserId();\n\t\tconst canLeaveChat = this.store.getters['dialogues/canLeave'](this.context.contextDialogId);\n\t\tif (\n\t\t\tisSelfKick\n\t\t\t|| !this.isCurrentUserManager(this.context.contextDialogId)\n\t\t\t|| !canLeaveChat\n\t\t)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\ttext: Loc.getMessage('IM_SIDEBAR_MENU_KICK_FROM_CHAT'),\n\t\t\tonclick: () => {\n\t\t\t\tthis.chatService.kickUserFromChat(this.context.contextDialogId, this.context.dialogId);\n\t\t\t\tthis.menuInstance.close();\n\t\t\t}\n\t\t};\n\t}\n\n\tgetLeaveItem(): ?MenuItem\n\t{\n\t\tconst userIdToKick = Number.parseInt(this.context.dialogId, 10);\n\t\tconst isSelfKick = userIdToKick === this.getCurrentUserId();\n\t\tconst canLeaveChat = this.store.getters['dialogues/canLeave'](this.context.contextDialogId);\n\t\tif (!isSelfKick || !canLeaveChat)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\ttext: Loc.getMessage('IM_LIB_MENU_LEAVE'),\n\t\t\tonclick: () => {\n\t\t\t\tthis.chatService.leaveChat(this.context.contextDialogId);\n\t\t\t\tthis.menuInstance.close();\n\t\t\t}\n\t\t};\n\t}\n\n\tisCurrentUserManager(dialogId: string): boolean\n\t{\n\t\tconst dialog = this.store.getters['dialogues/get'](dialogId);\n\t\tif (!dialog)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\treturn dialog.managerList.includes(this.getCurrentUserId());\n\t}\n}","import {Core} from 'im.v2.application.core';\nimport {ImModelDialog} from 'im.v2.model';\nimport {Button, ButtonColor, ButtonSize} from 'im.v2.component.elements';\n\nimport {DetailUser} from './detail-user';\nimport {SidebarDetail} from '../detail';\nimport {MembersMenu} from '../../classes/context-menu/main/members-menu';\n\nimport '../../css/main/detail.css';\n\n// @vue/component\nexport const MainDetail = {\n\tname: 'MainDetail',\n\tcomponents: {DetailUser, SidebarDetail, Button},\n\tprops: {\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true\n\t\t},\n\t\tchatId: {\n\t\t\ttype: Number,\n\t\t\trequired: true\n\t\t},\n\t\tservice: {\n\t\t\ttype: Object,\n\t\t\trequired: true\n\t\t}\n\t},\n\tcomputed:\n\t{\n\t\tButtonSize: () => ButtonSize,\n\t\tButtonColor: () => ButtonColor,\n\t\tdialog(): ImModelDialog\n\t\t{\n\t\t\treturn this.$store.getters['dialogues/get'](this.dialogId, true);\n\t\t},\n\t\tdialogManagers(): number[]\n\t\t{\n\t\t\treturn this.dialog.managerList;\n\t\t},\n\t\tdialogIds(): string[]\n\t\t{\n\t\t\tconst users = this.$store.getters['sidebar/members/get'](this.chatId);\n\n\t\t\treturn users.map(userId => userId.toString());\n\t\t},\n\t\tshowCopyInviteButton(): boolean\n\t\t{\n\t\t\t// todo\n\t\t\treturn true;\n\t\t},\n\t\tchatLink(): string\n\t\t{\n\t\t\treturn `${Core.getHost()}/online/?IM_DIALOG=${this.dialogId}`;\n\t\t}\n\t},\n\tcreated()\n\t{\n\t\tthis.contextMenu = new MembersMenu();\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.contextMenu.destroy();\n\t},\n\tmethods:\n\t{\n\t\tisModerator(userDialogId: string): boolean\n\t\t{\n\t\t\tconst userId = Number.parseInt(userDialogId, 10);\n\n\t\t\treturn this.dialogManagers.includes(userId);\n\t\t},\n\t\tonContextMenuClick(event)\n\t\t{\n\t\t\tconst item = {\n\t\t\t\tdialogId: event.userDialogId,\n\t\t\t\tcontextDialogId: this.dialogId,\n\t\t\t\tcontextChatId: this.chatId,\n\t\t\t};\n\n\t\t\tthis.contextMenu.openMenu(item, event.target);\n\t\t},\n\t\tonScroll()\n\t\t{\n\t\t\tthis.contextMenu.destroy();\n\t\t},\n\t\tonCopyInviteClick()\n\t\t{\n\t\t\tif (BX.clipboard.copy(this.chatLink))\n\t\t\t{\n\t\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\t\tcontent: this.$Bitrix.Loc.getMessage('IM_SIDEBAR_COPIED_SUCCESS')\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t},\n\ttemplate: `\n\t\t<SidebarDetail\n\t\t\t:dialogId=\"dialogId\"\n\t\t\t:chatId=\"chatId\"\n\t\t\t:service=\"service\"\n\t\t\t@scroll=\"onScroll\"\n\t\t\tv-slot=\"slotProps\"\n\t\t\tclass=\"bx-im-sidebar-main-detail__scope\"\n\t\t>\n\t\t\t<div class=\"bx-im-sidebar-main-detail__invitation-button-container\">\n\t\t\t\t<Button\n\t\t\t\t\tv-if=\"showCopyInviteButton\"\n\t\t\t\t\t:text=\"$Bitrix.Loc.getMessage('IM_SIDEBAR_COPY_INVITE_LINK')\"\n\t\t\t\t\t:size=\"ButtonSize.M\"\n\t\t\t\t\t:color=\"ButtonColor.PrimaryBorder\"\n\t\t\t\t\t:isRounded=\"true\"\n\t\t\t\t\t:isUppercase=\"false\"\n\t\t\t\t\ticon=\"link\"\n\t\t\t\t\t@click=\"onCopyInviteClick\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<DetailUser \n\t\t\t\tv-for=\"dialogId in dialogIds\" \n\t\t\t\t:dialogId=\"dialogId\" \n\t\t\t\t:isModerator=\"isModerator(dialogId)\"\n\t\t\t\t@contextMenuClick=\"onContextMenuClick\"\n\t\t\t/>\n\t\t</SidebarDetail>\n\t`\n};","import {hint} from 'ui.vue3.directives.hint';\n\nimport {Core} from 'im.v2.application.core';\nimport {Toggle, ToggleSize} from 'im.v2.component.elements';\nimport {ImModelDialog} from 'im.v2.model';\nimport {ChatService} from 'im.v2.provider.service';\n\nimport '../../css/main/settings.css';\n\n// @vue/component\nexport const Settings = {\n\tname: 'MainPreviewSettings',\n\tdirectives: {hint},\n\tcomponents: {Toggle},\n\tprops:\n\t{\n\t\tisLoading: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false\n\t\t},\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true\n\t\t},\n\t\tisModerator: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false\n\t\t}\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tautoDeleteEnabled: false,\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tToggleSize: () => ToggleSize,\n\t\tdialog(): ImModelDialog\n\t\t{\n\t\t\treturn this.$store.getters['dialogues/get'](this.dialogId, true);\n\t\t},\n\t\tisGroupChat(): boolean\n\t\t{\n\t\t\treturn this.dialogId.startsWith('chat');\n\t\t},\n\t\tcanBeMuted(): boolean\n\t\t{\n\t\t\treturn this.$store.getters['dialogues/canMute'](this.dialogId);\n\t\t},\n\t\tisChatMuted(): boolean\n\t\t{\n\t\t\tconst isMuted = this.dialog.muteList.find(element => {\n\t\t\t\treturn element === Core.getUserId();\n\t\t\t});\n\n\t\t\treturn !!isMuted;\n\t\t},\n\t\thintMuteNotAvailable(): ?Object\n\t\t{\n\t\t\tif (this.canBeMuted)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\ttext: this.$Bitrix.Loc.getMessage('IM_SIDEBAR_MUTE_NOT_AVAILABLE'),\n\t\t\t\tpopupOptions: {\n\t\t\t\t\tangle: true,\n\t\t\t\t\ttargetContainer: document.body,\n\t\t\t\t\toffsetLeft: 141,\n\t\t\t\t\toffsetTop: -10,\n\t\t\t\t\tbindOptions: {\n\t\t\t\t\t\tposition: 'top'\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t},\n\t\thintAutoDeleteNotAvailable()\n\t\t{\n\t\t\treturn {\n\t\t\t\ttext: this.$Bitrix.Loc.getMessage('IM_MESSENGER_NOT_AVAILABLE'),\n\t\t\t\tpopupOptions: {\n\t\t\t\t\tbindOptions: {\n\t\t\t\t\t\tposition: 'top'\n\t\t\t\t\t},\n\t\t\t\t\tangle: true,\n\t\t\t\t\ttargetContainer: document.body,\n\t\t\t\t\toffsetLeft: 125,\n\t\t\t\t\toffsetTop: -10\n\t\t\t\t}\n\t\t\t};\n\t\t},\n\t\tchatTypeClass(): string\n\t\t{\n\t\t\treturn this.isGroupChat ? '--group-chat' : '--personal';\n\t\t}\n\t},\n\tmethods:\n\t{\n\t\tgetChatService(): ChatService\n\t\t{\n\t\t\tif (!this.chatService)\n\t\t\t{\n\t\t\t\tthis.chatService = new ChatService();\n\t\t\t}\n\n\t\t\treturn this.chatService;\n\t\t},\n\t\tmuteActionHandler()\n\t\t{\n\t\t\tif (!this.canBeMuted)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.isChatMuted)\n\t\t\t{\n\t\t\t\tthis.getChatService().unmuteChat(this.dialogId);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.getChatService().muteChat(this.dialogId);\n\t\t\t}\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div v-if=\"isLoading\" class=\"bx-im-sidebar-main-settings__skeleton\" :class=\"chatTypeClass\"></div>\n\t\t<div v-else class=\"bx-im-sidebar-main-settings__container bx-im-sidebar-main-settings__scope\" :class=\"chatTypeClass\">\n\t\t\t<div\n\t\t\t\tv-if=\"isGroupChat\"\n\t\t\t\tclass=\"bx-im-sidebar-main-settings__notification-container\"\n\t\t\t\t:class=\"[canBeMuted ? '' : '--not-active']\"\n\t\t\t\tv-hint=\"hintMuteNotAvailable\"\n\t\t\t>\n\t\t\t\t<div class=\"bx-im-sidebar-main-settings__notification-title\">\n\t\t\t\t\t<div class=\"bx-im-sidebar-main-settings__title-text bx-im-sidebar-main-settings__title-icon --notification\">\n\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('IM_SIDEBAR_ENABLE_NOTIFICATION_TITLE') }}\n\t\t\t\t\t</div>\n\t\t\t\t\t<Toggle :size=\"ToggleSize.M\" :isEnabled=\"!isChatMuted\" @change=\"muteActionHandler\" />\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"bx-im-sidebar-main-settings__autodelete-container --not-active\" v-hint=\"hintAutoDeleteNotAvailable\">\n\t\t\t\t<div class=\"bx-im-sidebar-main-settings__autodelete-title\">\n\t\t\t\t\t<div class=\"bx-im-sidebar-main-settings__title-text bx-im-sidebar-main-settings__title-icon --autodelete\">\n\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('IM_SIDEBAR_ENABLE_AUTODELETE_TITLE') }}\n\t\t\t\t\t</div>\n\t\t\t\t\t<Toggle :size=\"ToggleSize.M\" :isEnabled=\"autoDeleteEnabled\" />\n\t\t\t\t</div>\n\t\t\t\t<div class=\"bx-im-sidebar-main-settings__autodelete-status\">\n\t\t\t\t\t{{ $Bitrix.Loc.getMessage('IM_SIDEBAR_AUTODELETE_STATUS_OFF') }}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`\n};","import { hint } from 'ui.vue3.directives.hint';\n\nimport { Avatar, AvatarSize, ChatTitle, Button as MessengerButton, ButtonColor, ButtonSize } from 'im.v2.component.elements';\nimport { ChatOption } from 'im.v2.const';\nimport { ImModelDialog } from 'im.v2.model';\nimport { Utils } from 'im.v2.lib.utils';\nimport { AddToChat } from 'im.v2.component.entity-selector';\n\nimport { Settings } from './settings';\n\nimport '../../css/main/preview-personal-chat.css';\n\n// @vue/component\nexport const PersonalChatPreview = {\n\tname: 'PersonalChatPreview',\n\tdirectives: { hint },\n\tcomponents: { Avatar, ChatTitle, MessengerButton, AddToChat, Settings },\n\tprops: {\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tisLoading: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tshowAddToChatPopup: false,\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tAvatarSize: () => AvatarSize,\n\t\tButtonSize: () => ButtonSize,\n\t\tButtonColor: () => ButtonColor,\n\t\tuserPosition(): string\n\t\t{\n\t\t\treturn this.$store.getters['users/getPosition'](this.dialogId);\n\t\t},\n\t\tdialog(): ImModelDialog\n\t\t{\n\t\t\treturn this.$store.getters['dialogues/get'](this.dialogId, true);\n\t\t},\n\t\tchatId(): number\n\t\t{\n\t\t\treturn this.dialog.chatId;\n\t\t},\n\t\tcanInviteMembers(): boolean\n\t\t{\n\t\t\treturn this.$store.getters['dialogues/getChatOption'](this.dialog.type, ChatOption.extend);\n\t\t},\n\t\tuserLink(): string\n\t\t{\n\t\t\treturn Utils.user.getProfileLink(this.dialogId);\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tonAddClick()\n\t\t{\n\t\t\tthis.showAddToChatPopup = true;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-sidebar-main-preview__scope\">\n\t\t\t<div v-if=\"isLoading\" class=\"bx-im-sidebar-main-preview-personal-chat__avatar-skeleton\"></div>\n\t\t\t<div v-else class=\"bx-im-sidebar-main-preview-personal-chat__avatar-container\">\n\t\t\t\t<Avatar\n\t\t\t\t\t:size=\"AvatarSize.XXXL\"\n\t\t\t\t\t:withStatus=\"false\"\n\t\t\t\t\t:dialogId=\"dialogId\"\n\t\t\t\t\tclass=\"bx-im-sidebar-main-preview-personal-chat__avatar\"\n\t\t\t\t/>\n\t\t\t\t<a :href=\"userLink\" target=\"_blank\">\n\t\t\t\t\t<ChatTitle :dialogId=\"dialogId\" class=\"bx-im-sidebar-main-preview-personal-chat__user-name\" />\n\t\t\t\t</a>\n\t\t\t\t<div class=\"bx-im-sidebar-main-preview-personal-chat__user-position\" :title=\"userPosition\">\n\t\t\t\t\t{{ userPosition }}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div v-if=\"isLoading\" class=\"bx-im-sidebar-main-preview-personal-chat__invite-button-skeleton\"></div>\n\t\t\t<div v-else class=\"bx-im-sidebar-main-preview-personal-chat__invite-button-container\" ref=\"add-members\">\n\t\t\t\t<MessengerButton\n\t\t\t\t\tv-if=\"canInviteMembers\"\n\t\t\t\t\t:text=\"$Bitrix.Loc.getMessage('IM_SIDEBAR_INVITE_BUTTON_TEXT')\"\n\t\t\t\t\t:size=\"ButtonSize.S\"\n\t\t\t\t\t:color=\"ButtonColor.PrimaryLight\"\n\t\t\t\t\t:isRounded=\"true\"\n\t\t\t\t\t:isUppercase=\"false\"\n\t\t\t\t\ticon=\"plus\"\n\t\t\t\t\t@click=\"onAddClick\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<Settings :isLoading=\"isLoading\" :dialogId=\"dialogId\" />\n\t\t\t<AddToChat\n\t\t\t\t:bindElement=\"$refs['add-members'] || {}\"\n\t\t\t\t:chatId=\"chatId\"\n\t\t\t\t:dialogId=\"dialogId\"\n\t\t\t\t:showPopup=\"showAddToChatPopup\"\n\t\t\t\t:popupConfig=\"{offsetTop: -220, offsetLeft: -320}\"\n\t\t\t\t@close=\"showAddToChatPopup = false\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","import { ImModelDialog } from 'im.v2.model';\nimport { ChatOption } from 'im.v2.const';\nimport { AddToChat } from 'im.v2.component.entity-selector';\nimport { Avatar, AvatarSize, ChatTitle, Button as MessengerButton, ButtonSize, ButtonColor } from 'im.v2.component.elements';\n\nimport { Settings } from './settings';\n\nimport '../../css/main/preview-group-chat.css';\n\n// @vue/component\nexport const GroupChatPreview = {\n\tname: 'GroupChatPreview',\n\tcomponents: { Avatar, ChatTitle, MessengerButton, AddToChat, Settings },\n\tprops: {\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tisLoading: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\temits: ['openDetail'],\n\tdata() {\n\t\treturn {\n\t\t\tshowAddToChatPopup: false,\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tAvatarSize: () => AvatarSize,\n\t\tButtonSize: () => ButtonSize,\n\t\tButtonColor: () => ButtonColor,\n\t\tdialog(): ImModelDialog\n\t\t{\n\t\t\treturn this.$store.getters['dialogues/get'](this.dialogId, true);\n\t\t},\n\t\tchatId(): number\n\t\t{\n\t\t\treturn this.dialog.chatId;\n\t\t},\n\t\tdialogIds(): string[]\n\t\t{\n\t\t\tconst PREVIEW_USERS_COUNT = 4;\n\t\t\tconst userIds = this.$store.getters['sidebar/members/get'](this.chatId);\n\n\t\t\treturn userIds.map((id) => id.toString()).slice(0, PREVIEW_USERS_COUNT);\n\t\t},\n\t\tusersInChatCount(): number\n\t\t{\n\t\t\treturn this.dialog.userCounter;\n\t\t},\n\t\tmoreUsersCount(): number\n\t\t{\n\t\t\treturn Math.max(this.usersInChatCount - this.dialogIds.length, 0);\n\t\t},\n\t\tcanSeeMembers(): boolean\n\t\t{\n\t\t\treturn this.$store.getters['dialogues/getChatOption'](this.dialog.type, ChatOption.userList);\n\t\t},\n\t\tcanInviteMembers(): boolean\n\t\t{\n\t\t\treturn this.$store.getters['dialogues/getChatOption'](this.dialog.type, ChatOption.extend);\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tonOpenUsers()\n\t\t{\n\t\t\tthis.$emit('openDetail');\n\t\t},\n\t\tonOpenInvitePopup()\n\t\t{\n\t\t\tthis.showAddToChatPopup = true;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-sidebar-main-preview__scope\">\n\t\t\t<div v-if=\"isLoading\" class=\"bx-im-sidebar-main-preview-group-chat__avatar-skeleton\"></div>\n\t\t\t<div v-else class=\"bx-im-sidebar-main-preview-group-chat__avatar-container\">\n\t\t\t\t<div class=\"bx-im-sidebar-main-preview-group-chat__avatar\">\n\t\t\t\t\t<Avatar :size=\"AvatarSize.XXXL\" :withStatus=\"false\" :dialogId=\"dialogId\" />\n\t\t\t\t</div>\n\t\t\t\t<ChatTitle :dialogId=\"dialogId\" :twoLine=\"true\" class=\"bx-im-sidebar-main-preview-group-chat__title\" />\n\t\t\t</div>\n\t\t\t<div v-if=\"isLoading\" class=\"bx-im-sidebar-main-preview-group-chat__members-skeleton\"></div>\n\t\t\t<div v-else class=\"bx-im-sidebar-main-preview-group-chat__members-container\">\n\t\t\t\t<div v-if=\"canSeeMembers\" class=\"bx-im-sidebar-main-preview-group-chat__members\" @click=\"onOpenUsers\">\n\t\t\t\t\t<div class=\"bx-im-sidebar-main-preview-group-chat__members-avatars\" >\n\t\t\t\t\t\t<Avatar\n\t\t\t\t\t\t\tclass=\"bx-im-sidebar-main-preview-group-chat__chat-user-avatar\"\n\t\t\t\t\t\t\tv-for=\"id in dialogIds\"\n\t\t\t\t\t\t\t:size=\"AvatarSize.S\"\n\t\t\t\t\t\t\t:withStatus=\"false\"\n\t\t\t\t\t\t\t:dialogId=\"id\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div v-if=\"moreUsersCount > 0\" class=\"bx-im-sidebar-main-preview-group-chat__more-users-count-text\">\n\t\t\t\t\t\t+{{ moreUsersCount }}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div ref=\"add-members\">\n\t\t\t\t\t<MessengerButton\n\t\t\t\t\t\tv-if=\"canInviteMembers\"\n\t\t\t\t\t\t:text=\"$Bitrix.Loc.getMessage('IM_SIDEBAR_INVITE_BUTTON_TEXT')\"\n\t\t\t\t\t\t:size=\"ButtonSize.S\"\n\t\t\t\t\t\t:color=\"ButtonColor.PrimaryLight\"\n\t\t\t\t\t\t:isRounded=\"true\"\n\t\t\t\t\t\t:isUppercase=\"false\"\n\t\t\t\t\t\ticon=\"plus\"\n\t\t\t\t\t\t@click=\"onOpenInvitePopup\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<Settings :isLoading=\"isLoading\" :dialogId=\"dialogId\" />\n\t\t\t<AddToChat\n\t\t\t\t:bindElement=\"$refs['add-members'] || {}\"\n\t\t\t\t:chatId=\"chatId\"\n\t\t\t\t:dialogId=\"dialogId\"\n\t\t\t\t:showPopup=\"showAddToChatPopup\"\n\t\t\t\t:popupConfig=\"{offsetTop: -220, offsetLeft: -420}\"\n\t\t\t\t@close=\"showAddToChatPopup = false\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","import {SidebarBlock, SidebarDetailBlock} from 'im.v2.const';\nimport {PersonalChatPreview} from './preview-personal-chat';\nimport {GroupChatPreview} from './preview-group-chat';\n\n// @vue/component\nexport const MainPreview = {\n\tname: 'MainPreview',\n\tcomponents: {GroupChatPreview, PersonalChatPreview},\n\tinheritAttrs: false,\n\tprops: {\n\t\tisLoading: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false\n\t\t},\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true\n\t\t}\n\t},\n\tcomputed:\n\t{\n\t\tisGroupChat(): boolean\n\t\t{\n\t\t\treturn this.dialogId.startsWith('chat');\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tonOpenDetail()\n\t\t{\n\t\t\tthis.$emit('openDetail', {block: SidebarBlock.main, detailBlock: SidebarDetailBlock.main});\n\t\t}\n\t},\n\ttemplate: `\n\t\t<GroupChatPreview \n\t\t\tv-if=\"isGroupChat\" \n\t\t\t:dialogId=\"dialogId\"\n\t\t\t:isLoading=\"isLoading\" \n\t\t\t@openDetail=\"onOpenDetail\"\n\t\t\tclass=\"bx-im-sidebar__box\"\n\t\t/>\n\t\t<PersonalChatPreview \n\t\t\tv-else \n\t\t\t:dialogId=\"dialogId\"\n\t\t\t:isLoading=\"isLoading\"\n\t\t\tclass=\"bx-im-sidebar__box\"\n\t\t/>\n\t`\n};","import {ImModelDialog} from 'im.v2.model';\nimport {DialogType, SidebarBlock, SidebarDetailBlock} from 'im.v2.const';\nimport {Parser} from 'im.v2.lib.parser';\nimport {hint} from 'ui.vue3.directives.hint';\nimport '../../css/info/preview.css';\n\nconst MAX_DESCRIPTION_SYMBOLS = 25;\n\n// @vue/component\nexport const InfoPreview = {\n\tname: 'InfoPreview',\n\tdirectives: {hint},\n\tprops: {\n\t\tisLoading: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false\n\t\t},\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true\n\t\t}\n\t},\n\temits: ['openDetail'],\n\tdata() {\n\t\treturn {\n\t\t\texpanded: false,\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tdialog(): ImModelDialog\n\t\t{\n\t\t\treturn this.$store.getters['dialogues/get'](this.dialogId, true);\n\t\t},\n\t\tisUser(): boolean\n\t\t{\n\t\t\treturn this.dialog.type === DialogType.user;\n\t\t},\n\t\tpreviewDescription(): string\n\t\t{\n\t\t\tif (this.dialog.description.length === 0)\n\t\t\t{\n\t\t\t\treturn this.chatTypeText;\n\t\t\t}\n\n\t\t\tif (this.dialog.description.length > MAX_DESCRIPTION_SYMBOLS)\n\t\t\t{\n\t\t\t\treturn `${this.dialog.description.slice(0, MAX_DESCRIPTION_SYMBOLS)}...`;\n\t\t\t}\n\n\t\t\treturn this.dialog.description;\n\t\t},\n\t\tdescriptionToShow(): string\n\t\t{\n\t\t\tconst rawText = this.expanded ? this.dialog.description : this.previewDescription;\n\n\t\t\treturn Parser.purifyText(rawText);\n\t\t},\n\t\tchatTypeText(): string\n\t\t{\n\t\t\tif (this.isUser)\n\t\t\t{\n\t\t\t\treturn this.$Bitrix.Loc.getMessage('IM_SIDEBAR_CHAT_TYPE_USER');\n\t\t\t}\n\n\t\t\treturn this.$Bitrix.Loc.getMessage('IM_SIDEBAR_CHAT_TYPE_GROUP_V2');\n\t\t},\n\t\tshowExpandButton(): boolean\n\t\t{\n\t\t\tif (this.expanded)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn this.dialog.description.length >= MAX_DESCRIPTION_SYMBOLS;\n\t\t},\n\t\tfavoriteCounter(): string\n\t\t{\n\t\t\tconst counter = this.$store.getters['sidebar/favorites/getCounter'](this.chatId);\n\n\t\t\treturn this.getCounterString(counter);\n\t\t},\n\t\turlCounter(): string\n\t\t{\n\t\t\tconst counter = this.$store.getters['sidebar/links/getCounter'](this.chatId);\n\n\t\t\treturn this.getCounterString(counter);\n\t\t},\n\t\tisLinksAvailable(): boolean\n\t\t{\n\t\t\treturn this.$store.state.sidebar.isLinksMigrated;\n\t\t},\n\t\thintDirectiveContent(): Object\n\t\t{\n\t\t\treturn {\n\t\t\t\ttext: this.$Bitrix.Loc.getMessage('IM_SIDEBAR_LINKS_NOT_AVAILABLE'),\n\t\t\t\tpopupOptions: {\n\t\t\t\t\tangle: true,\n\t\t\t\t\ttargetContainer: document.body,\n\t\t\t\t\toffsetLeft: 141,\n\t\t\t\t\toffsetTop: -10,\n\t\t\t\t\tbindOptions: {\n\t\t\t\t\t\tposition: 'top'\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t},\n\t\tchatId(): number\n\t\t{\n\t\t\treturn this.dialog.chatId;\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tgetCounterString(counter: number): string\n\t\t{\n\t\t\tconst MAX_COUNTER = 100;\n\t\t\tif (counter >= MAX_COUNTER)\n\t\t\t{\n\t\t\t\treturn '99+';\n\t\t\t}\n\n\t\t\treturn counter.toString();\n\t\t},\n\t\tonFavouriteClick()\n\t\t{\n\t\t\tthis.$emit('openDetail', {block: SidebarBlock.info, detailBlock: SidebarDetailBlock.favorite});\n\t\t},\n\t\tonLinkClick()\n\t\t{\n\t\t\tif (!this.isLinksAvailable)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.$emit('openDetail', {block: SidebarBlock.info, detailBlock: SidebarDetailBlock.link});\n\t\t}\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-sidebar-info-preview__scope\">\n\t\t\t<div v-if=\"isLoading\" class=\"bx-im-sidebar-info-preview__skeleton\"></div>\n\t\t\t<div v-else class=\"bx-im-sidebar-info-preview__container\" :class=\"[expanded ? '--expanded' : '']\">\n\t\t\t\t<div class=\"bx-im-sidebar-info-preview__description-container\">\n\t\t\t\t\t<div class=\"bx-im-sidebar-info-preview__description-text-container\" :class=\"[expanded ? '--expanded' : '']\">\n\t\t\t\t\t\t<div class=\"bx-im-sidebar-info-preview__description-icon bx-im-sidebar-info-preview__item-icon\"></div>\n\t\t\t\t\t\t<div class=\"bx-im-sidebar-info-preview__description-text\">\n\t\t\t\t\t\t\t{{descriptionToShow}}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<button\n\t\t\t\t\t\tv-if=\"showExpandButton\"\n\t\t\t\t\t\tclass=\"bx-im-sidebar-info-preview__show-description-button\"\n\t\t\t\t\t\t@click=\"expanded = !expanded\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('IM_SIDEBAR_CHAT_DESCRIPTION_SHOW') }}\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"bx-im-sidebar-info-preview__items-container\">\n\t\t\t\t\t<div class=\"bx-im-sidebar-info-preview__item-container\" @click=\"onFavouriteClick\">\n\t\t\t\t\t\t<div class=\"bx-im-sidebar-info-preview__title-container\">\n\t\t\t\t\t\t\t<div class=\"bx-im-sidebar-info-preview__favorite-icon bx-im-sidebar-info-preview__item-icon\"></div>\n\t\t\t\t\t\t\t<div class=\"bx-im-sidebar-info-preview__title-text\">\n\t\t\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('IM_SIDEBAR_FAVORITE_DETAIL_TITLE') }}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"bx-im-sidebar-info-preview__counter-container\">\n\t\t\t\t\t\t\t<span class=\"bx-im-sidebar-info-preview__counter\">{{favoriteCounter}}</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div \n\t\t\t\t\t\tclass=\"bx-im-sidebar-info-preview__item-container\" \n\t\t\t\t\t\t:class=\"[isLinksAvailable ? '' : '--links-not-active']\"\n\t\t\t\t\t\t@click=\"onLinkClick\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<div \n\t\t\t\t\t\t\tv-if=\"!isLinksAvailable\" \n\t\t\t\t\t\t\tclass=\"bx-im-sidebar-info-preview__hint-not-active\" \n\t\t\t\t\t\t\tv-hint=\"hintDirectiveContent\"\n\t\t\t\t\t\t></div>\n\t\t\t\t\t\t<div class=\"bx-im-sidebar-info-preview__title-container\">\n\t\t\t\t\t\t\t<div class=\"bx-im-sidebar-info-preview__link-icon bx-im-sidebar-info-preview__item-icon\"></div>\n\t\t\t\t\t\t\t<div class=\"bx-im-sidebar-info-preview__title-text\">\n\t\t\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('IM_SIDEBAR_LINK_DETAIL_TITLE') }}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"bx-im-sidebar-info-preview__counter-container\">\n\t\t\t\t\t\t\t<span class=\"bx-im-sidebar-info-preview__counter\">{{urlCounter}}</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`\n};","import {DateFormatter, DateTemplate} from 'im.v2.lib.date-formatter';\n\ntype FormattableCollection = {\n\tdate: Date,\n};\n\ntype DateGroup = {\n\tid: number,\n\ttitle: string\n};\n\nexport class SidebarCollectionFormatter\n{\n\tcachedDateGroups: Object = {};\n\n\tformat(collection: FormattableCollection[]): Object[]\n\t{\n\t\tconst dateGroups = {};\n\n\t\tcollection.forEach(item => {\n\t\t\tconst dateGroup = this.getDateGroup(item.date);\n\t\t\tif (!dateGroups[dateGroup.title])\n\t\t\t{\n\t\t\t\tdateGroups[dateGroup.title] = {\n\t\t\t\t\tdateGroupTitle: dateGroup.title,\n\t\t\t\t\titems: []\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tdateGroups[dateGroup.title].items.push(item);\n\t\t});\n\n\t\treturn Object.values(dateGroups);\n\t}\n\n\tgetDateGroup(date: Date): DateGroup\n\t{\n\t\tconst INDEX_BETWEEN_DATE_AND_TIME = 10;\n\t\t// 2022-10-25T14:58:44.000Z => 2022-10-25\n\t\tconst shortDate = date.toJSON().slice(0, INDEX_BETWEEN_DATE_AND_TIME);\n\t\tif (this.cachedDateGroups[shortDate])\n\t\t{\n\t\t\treturn this.cachedDateGroups[shortDate];\n\t\t}\n\n\t\tthis.cachedDateGroups[shortDate] = {\n\t\t\tid: shortDate,\n\t\t\ttitle: DateFormatter.formatByTemplate(date, DateTemplate.dateGroup)\n\t\t};\n\n\t\treturn this.cachedDateGroups[shortDate];\n\t}\n\n\tdestroy()\n\t{\n\t\tthis.cachedDateGroups = {};\n\t}\n}","import {RestClient} from 'rest.client';\nimport {Store} from 'ui.vue3.vuex';\n\nimport {Core} from 'im.v2.application.core';\nimport {RestMethod} from 'im.v2.const';\n\nexport class LinkManager\n{\n\tstore: Store;\n\trestClient: RestClient;\n\n\tconstructor()\n\t{\n\t\tthis.store = Core.getStore();\n\t\tthis.restClient = Core.getRestClient();\n\t}\n\n\tdelete(link: Object)\n\t{\n\t\tthis.store.dispatch('sidebar/links/delete', {\n\t\t\tchatId: link.chatId,\n\t\t\tid: link.id\n\t\t});\n\n\t\tconst queryParams = {'LINK_ID': link.id};\n\t\tthis.restClient.callMethod(RestMethod.imChatUrlDelete, queryParams).catch(error => {\n\t\t\tconsole.error('Im.Sidebar: error deleting link', error);\n\t\t});\n\t}\n}","import {Loc} from 'main.core';\nimport {SidebarMenu} from '../sidebar-base-menu';\nimport {LinkManager} from './link-manager';\nimport 'ui.notification';\nimport type {MenuItem} from 'im.v2.lib.menu';\n\nexport class LinkMenu extends SidebarMenu\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis.linkManager = new LinkManager();\n\t}\n\n\tgetMenuItems(): MenuItem[]\n\t{\n\t\treturn [\n\t\t\tthis.getOpenContextMessageItem(),\n\t\t\tthis.getCopyLinkItem(Loc.getMessage('IM_SIDEBAR_MENU_COPY_LINK')),\n\t\t\tthis.getDeleteLinkItem(),\n\t\t];\n\t}\n\n\tgetDeleteLinkItem(): ?MenuItem\n\t{\n\t\treturn {\n\t\t\ttext: Loc.getMessage('IM_SIDEBAR_MENU_DELETE_FROM_LINKS'),\n\t\t\tonclick: function() {\n\t\t\t\tthis.linkManager.delete(this.context);\n\t\t\t\tthis.menuInstance.close();\n\t\t\t}.bind(this)\n\t\t};\n\t}\n}","import {Avatar, AvatarSize, ChatTitle} from 'im.v2.component.elements';\nimport {Utils} from 'im.v2.lib.utils';\nimport type {ImModelSidebarLinkItem} from 'im.v2.model';\nimport '../../css/info/link-item.css';\n\n// @vue/component\nexport const LinkItem = {\n\tname: 'LinkItem',\n\tcomponents: {Avatar, ChatTitle},\n\tprops:\n\t{\n\t\tlink: {\n\t\t\ttype: Object,\n\t\t\trequired: true\n\t\t},\n\t},\n\temits: ['contextMenuClick'],\n\tdata() {\n\t\treturn {\n\t\t\tshowContextButton: false,\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tAvatarSize: () => AvatarSize,\n\t\tlinkItem(): ImModelSidebarLinkItem\n\t\t{\n\t\t\treturn this.link;\n\t\t},\n\t\tsource(): string\n\t\t{\n\t\t\treturn this.linkItem.source;\n\t\t},\n\t\tshortDescription(): string\n\t\t{\n\t\t\tlet hostName = '';\n\t\t\ttry {\n\t\t\t\thostName = new URL(this.source).hostname;\n\t\t\t}\n\t\t\tcatch (error)\n\t\t\t{\n\t\t\t\thostName = this.source;\n\t\t\t\tconsole.error(error);\n\t\t\t}\n\n\t\t\treturn hostName;\n\t\t},\n\t\tdescription(): string\n\t\t{\n\t\t\tconst {name, description} = this.linkItem.richData;\n\t\t\tconst descriptionToShow = description || name || this.source;\n\n\t\t\treturn Utils.text.convertHtmlEntities(descriptionToShow);\n\t\t},\n\t\tauthorDialogId(): string\n\t\t{\n\t\t\treturn this.linkItem.authorId.toString();\n\t\t},\n\t\thasPreview(): boolean\n\t\t{\n\t\t\treturn !!this.linkItem.richData?.previewUrl;\n\t\t},\n\t\tpreviewStyles(): Object\n\t\t{\n\t\t\treturn {\n\t\t\t\tbackgroundImage: `url('${this.linkItem.richData?.previewUrl}')`,\n\t\t\t\tbackgroundSize: 'cover',\n\t\t\t\tbackgroundRepeat: 'no-repeat',\n\t\t\t};\n\t\t},\n\t\ticonTypeClass(): string\n\t\t{\n\t\t\tswitch (this.linkItem.richData?.type)\n\t\t\t{\n\t\t\t\tcase 'TASKS':\n\t\t\t\t\treturn '--task';\n\t\t\t\tcase 'LANDING':\n\t\t\t\t\treturn '--landing';\n\t\t\t\tcase 'POST':\n\t\t\t\t\treturn '--post';\n\t\t\t\tcase 'CALENDAR':\n\t\t\t\t\treturn '--calendar';\n\t\t\t\tdefault:\n\t\t\t\t\treturn '--common';\n\t\t\t}\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tonContextMenuClick(event)\n\t\t{\n\t\t\tthis.$emit('contextMenuClick', {\n\t\t\t\tid: this.linkItem.id,\n\t\t\t\tmessageId: this.linkItem.messageId,\n\t\t\t\tsource: this.source,\n\t\t\t\ttarget: event.currentTarget\n\t\t\t});\n\t\t}\n\t},\n\ttemplate: `\n\t\t<div \n\t\t\tclass=\"bx-im-link-item__container bx-im-link-item__scope\"\n\t\t\t@mouseover=\"showContextButton = true\"\n\t\t\t@mouseleave=\"showContextButton = false\"\n\t\t>\n\t\t\t<template v-if=\"hasPreview\">\n\t\t\t\t<div class=\"bx-im-link-item__icon-container\" :style=\"previewStyles\"></div>\n\t\t\t</template>\n\t\t\t<template v-else>\n\t\t\t\t<div class=\"bx-im-link-item__icon-container\" :class=\"iconTypeClass\">\n\t\t\t\t\t<div class=\"bx-im-link-item__icon\" :class=\"iconTypeClass\" ></div>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t\t<div class=\"bx-im-link-item__content\">\n\t\t\t\t<div class=\"bx-im-link-item__short-description-text\">{{ shortDescription }}</div>\n\t\t\t\t<a :href=\"source\" :title=\"description\" target=\"_blank\" class=\"bx-im-link-item__description-text\">\n\t\t\t\t\t{{ description }}\n\t\t\t\t</a>\n\t\t\t\t<div class=\"bx-im-link-item__author-container\">\n\t\t\t\t\t<Avatar \n\t\t\t\t\t\t:size=\"AvatarSize.XS\" \n\t\t\t\t\t\t:withStatus=\"false\" \n\t\t\t\t\t\t:dialogId=\"authorDialogId\" \n\t\t\t\t\t\tclass=\"bx-im-link-item__author-avatar\" \n\t\t\t\t\t/>\n\t\t\t\t\t<ChatTitle :dialogId=\"authorDialogId\" :showItsYou=\"false\" class=\"bx-im-link-item__author-text\" />\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div v-if=\"showContextButton\" class=\"bx-im-link-item__context-menu\">\n\t\t\t\t<button class=\"bx-im-messenger__context-menu-icon\" @click=\"onContextMenuClick\"></button>\n\t\t\t</div>\n\t\t</div>\n\t`\n};","import '../css/date-group.css';\n\n// @vue/component\nexport const DateGroup = {\n\tname: 'DateGroup',\n\tprops: {\n\t\tdateText: {\n\t\t\ttype: String,\n\t\t\trequired: true\n\t\t}\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-sidebar-date-group__container bx-im-sidebar-date-group__scope\">\n\t\t\t<div class=\"bx-im-sidebar-date-group__text\">\n\t\t\t\t{{ dateText }}\n\t\t\t</div>\n\t\t</div>\n\t`\n};","import '../css/detail-empty-state.css';\n\n// @vue/component\nexport const DetailEmptyState = {\n\tname: 'DetailEmptyState',\n\tprops: {\n\t\ttitle: {\n\t\t\ttype: String,\n\t\t\trequired: true\n\t\t},\n\t\ticonType: {\n\t\t\ttype: String,\n\t\t\trequired: true\n\t\t}\n\t},\n\tcomputed:\n\t{\n\t\ticonClass(): string\n\t\t{\n\t\t\treturn `--${this.iconType}`;\n\t\t}\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-sidebar-detail-empty-state__container bx-im-sidebar-detail-empty-state__scope\">\n\t\t\t<span class=\"bx-im-sidebar-detail-empty-state__icon\" :class=\"[iconClass]\"></span>\n\t\t\t<span class=\"bx-im-sidebar-detail-empty-state__text\">{{ title }}</span>\n\t\t</div>\n\t`\n};","import type {ImModelSidebarLinkItem} from 'im.v2.model';\nimport {SidebarDetailBlock} from 'im.v2.const';\nimport {SidebarCollectionFormatter} from '../../classes/sidebar-collection-formatter';\nimport {LinkMenu} from '../../classes/context-menu/link/link-menu';\nimport {SidebarDetail} from '../detail';\nimport {LinkItem} from './link-item';\nimport {DateGroup} from '../date-group';\nimport {DetailEmptyState} from '../detail-empty-state';\nimport '../../css/info/link-detail.css';\n\n// @vue/component\nexport const LinkDetail = {\n\tname: 'LinkDetail',\n\tcomponents: {LinkItem, SidebarDetail, DateGroup, DetailEmptyState},\n\tprops: {\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true\n\t\t},\n\t\tchatId: {\n\t\t\ttype: Number,\n\t\t\trequired: true\n\t\t},\n\t\tservice: {\n\t\t\ttype: Object,\n\t\t\trequired: true\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tSidebarDetailBlock: () => SidebarDetailBlock,\n\t\tlinks(): ImModelSidebarLinkItem[]\n\t\t{\n\t\t\treturn this.$store.getters['sidebar/links/get'](this.chatId);\n\t\t},\n\t\tformattedCollection(): Array\n\t\t{\n\t\t\treturn this.collectionFormatter.format(this.links);\n\t\t},\n\t\tisEmptyState()\n\t\t{\n\t\t\treturn this.formattedCollection.length === 0;\n\t\t}\n\t},\n\tcreated()\n\t{\n\t\tthis.collectionFormatter = new SidebarCollectionFormatter();\n\t\tthis.contextMenu = new LinkMenu();\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.contextMenu.destroy();\n\t\tthis.collectionFormatter.destroy();\n\t},\n\tmethods:\n\t{\n\t\tonContextMenuClick(event)\n\t\t{\n\t\t\tconst item = {\n\t\t\t\tid: event.id,\n\t\t\t\tmessageId: event.messageId,\n\t\t\t\tdialogId: this.dialogId,\n\t\t\t\tchatId: this.chatId,\n\t\t\t\tsource: event.source,\n\t\t\t};\n\n\t\t\tthis.contextMenu.openMenu(item, event.target);\n\t\t},\n\t\tonScroll()\n\t\t{\n\t\t\tthis.contextMenu.destroy();\n\t\t},\n\t},\n\ttemplate: `\n\t\t<SidebarDetail\n\t\t\t:dialogId=\"dialogId\"\n\t\t\t:chatId=\"chatId\"\n\t\t\t:service=\"service\"\n\t\t\t@scroll=\"onScroll\"\n\t\t\tv-slot=\"slotProps\"\n\t\t\tclass=\"bx-im-sidebar-link-detail__scope\"\n\t\t>\n\t\t\t<template v-for=\"dateGroup in formattedCollection\">\n\t\t\t\t<DateGroup :dateText=\"dateGroup.dateGroupTitle\" />\n\t\t\t\t<template v-for=\"link in dateGroup.items\">\n\t\t\t\t\t<LinkItem :link=\"link\" @contextMenuClick=\"onContextMenuClick\" />\n\t\t\t\t</template>\n\t\t\t</template>\n\t\t\t<DetailEmptyState\n\t\t\t\tv-if=\"!slotProps.isLoading && isEmptyState\"\n\t\t\t\t:title=\"$Bitrix.Loc.getMessage('IM_SIDEBAR_LINKS_EMPTY')\"\n\t\t\t\t:iconType=\"SidebarDetailBlock.link\"\n\t\t\t/>\n\t\t</SidebarDetail>\n\t`\n};","import {Loc} from 'main.core';\n\nimport {SidebarMenu} from '../sidebar-base-menu';\n\nimport type {MenuItem} from 'im.v2.lib.menu';\nimport {MessageService} from 'im.v2.provider.service';\n\nexport class FavoriteMenu extends SidebarMenu\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis.id = 'im-sidebar-context-menu';\n\t}\n\n\tgetMenuItems(): MenuItem[]\n\t{\n\t\treturn [\n\t\t\tthis.getOpenContextMessageItem(),\n\t\t\tthis.getDeleteFromFavoriteItem(),\n\t\t];\n\t}\n\n\tgetDeleteFromFavoriteItem(): MenuItem\n\t{\n\t\treturn {\n\t\t\ttext: Loc.getMessage('IM_SIDEBAR_MENU_REMOVE_FROM_SAVED_V2'),\n\t\t\tonclick: function() {\n\t\t\t\tconst messageService = new MessageService({chatId: this.context.chatId});\n\t\t\t\tmessageService.removeMessageFromFavorite(this.context.messageId);\n\t\t\t\tthis.menuInstance.close();\n\t\t\t}.bind(this)\n\t\t};\n\t}\n}","import {Avatar, AvatarSize, ChatTitle} from 'im.v2.component.elements';\nimport type {ImModelSidebarFavoriteItem, ImModelMessage} from 'im.v2.model';\nimport {Parser} from 'im.v2.lib.parser';\nimport '../../css/info/favorite-item.css';\nimport {EventEmitter} from 'main.core.events';\nimport {EventType} from 'im.v2.const';\n\n// @vue/component\nexport const FavoriteItem = {\n\tname: 'FavoriteItem',\n\tcomponents: {Avatar, ChatTitle},\n\tprops:\n\t{\n\t\tfavorite: {\n\t\t\ttype: Object,\n\t\t\trequired: true\n\t\t},\n\t\tchatId: {\n\t\t\ttype: Number,\n\t\t\trequired: true\n\t\t},\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true\n\t\t},\n\t},\n\temits: ['contextMenuClick'],\n\tdata() {\n\t\treturn {\n\t\t\tshowContextButton: false,\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tAvatarSize: () => AvatarSize,\n\t\tfavoriteItem(): ImModelSidebarFavoriteItem\n\t\t{\n\t\t\treturn this.favorite;\n\t\t},\n\t\tfavoriteMessage(): ImModelMessage\n\t\t{\n\t\t\treturn this.$store.getters['messages/getById'](this.favoriteItem.messageId);\n\t\t},\n\t\tauthorDialogId(): string\n\t\t{\n\t\t\treturn this.favoriteMessage.authorId.toString();\n\t\t},\n\t\tmessageText(): string\n\t\t{\n\t\t\treturn Parser.purifyMessage(this.favoriteMessage);\n\t\t}\n\t},\n\tmethods:\n\t{\n\t\tonContextMenuClick(event)\n\t\t{\n\t\t\tthis.$emit('contextMenuClick', {\n\t\t\t\tid: this.favoriteItem.id,\n\t\t\t\tmessageId: this.favorite.messageId,\n\t\t\t\ttarget: event.currentTarget\n\t\t\t});\n\t\t},\n\t\tonItemClick()\n\t\t{\n\t\t\tEventEmitter.emit(EventType.dialog.goToMessageContext, {\n\t\t\t\tmessageId: this.favorite.messageId,\n\t\t\t\tdialogId: this.dialogId,\n\t\t\t});\n\t\t},\n\t\tonMessageBodyClick(event)\n\t\t{\n\t\t\tif (event.target.tagName === 'A')\n\t\t\t{\n\t\t\t\tevent.stopPropagation();\n\t\t\t}\n\t\t}\n\t},\n\ttemplate: `\n\t\t<div \n\t\t\tclass=\"bx-im-favorite-item__container bx-im-favorite-item__scope\" \n\t\t\t@click.stop=\"onItemClick\"\n\t\t\t@mouseover=\"showContextButton = true\"\n\t\t\t@mouseleave=\"showContextButton = false\"\n\t\t>\n\t\t\t<div class=\"bx-im-favorite-item__header-container\">\n\t\t\t\t<div class=\"bx-im-favorite-item__author-container\">\n\t\t\t\t\t<Avatar\n\t\t\t\t\t\t:size=\"AvatarSize.XS\"\n\t\t\t\t\t\t:withStatus=\"false\"\n\t\t\t\t\t\t:dialogId=\"authorDialogId\"\n\t\t\t\t\t\tclass=\"bx-im-favorite-item__author-avatar\"\n\t\t\t\t\t/>\n\t\t\t\t\t<ChatTitle :dialogId=\"authorDialogId\" :showItsYou=\"false\" class=\"bx-im-favorite-item__author-text\" />\n\t\t\t\t</div>\n\t\t\t\t<button \n\t\t\t\t\tv-if=\"showContextButton\"\n\t\t\t\t\tclass=\"bx-im-messenger__context-menu-icon\"\n\t\t\t\t\t@click.stop=\"onContextMenuClick\"\n\t\t\t\t></button>\n\t\t\t</div>\n\t\t\t<div class=\"bx-im-favorite-item__message-text\" v-html=\"messageText\" @click=\"onMessageBodyClick\"></div>\n\t\t</div>\n\t`\n};","import type {ImModelSidebarFavoriteItem} from 'im.v2.model';\nimport {SidebarDetailBlock} from 'im.v2.const';\nimport {FavoriteMenu} from '../../classes/context-menu/favorite/favorite-menu';\nimport {SidebarCollectionFormatter} from '../../classes/sidebar-collection-formatter';\nimport {SidebarDetail} from '../detail';\nimport {FavoriteItem} from './favorite-item';\nimport {DateGroup} from '../date-group';\nimport {DetailEmptyState} from '../detail-empty-state';\nimport '../../css/info/favorite-detail.css';\n\n// @vue/component\nexport const FavoriteDetail = {\n\tname: 'FavoriteDetail',\n\tcomponents: {FavoriteItem, DateGroup, DetailEmptyState, SidebarDetail},\n\tprops: {\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true\n\t\t},\n\t\tchatId: {\n\t\t\ttype: Number,\n\t\t\trequired: true\n\t\t},\n\t\tservice: {\n\t\t\ttype: Object,\n\t\t\trequired: true\n\t\t}\n\t},\n\tcomputed:\n\t{\n\t\tSidebarDetailBlock: () => SidebarDetailBlock,\n\t\tfavorites(): ImModelSidebarFavoriteItem[]\n\t\t{\n\t\t\treturn this.$store.getters['sidebar/favorites/get'](this.chatId);\n\t\t},\n\t\tformattedCollection(): Array\n\t\t{\n\t\t\treturn this.collectionFormatter.format(this.favorites);\n\t\t},\n\t\tisEmptyState()\n\t\t{\n\t\t\treturn this.formattedCollection.length === 0;\n\t\t}\n\t},\n\tcreated()\n\t{\n\t\tthis.collectionFormatter = new SidebarCollectionFormatter();\n\t\tthis.contextMenu = new FavoriteMenu();\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.contextMenu.destroy();\n\t\tthis.collectionFormatter.destroy();\n\t},\n\tmethods:\n\t{\n\t\tonContextMenuClick(event)\n\t\t{\n\t\t\tconst item = {\n\t\t\t\tid: event.id,\n\t\t\t\tmessageId: event.messageId,\n\t\t\t\tdialogId: this.dialogId,\n\t\t\t\tchatId: this.chatId,\n\t\t\t};\n\n\t\t\tthis.contextMenu.openMenu(item, event.target);\n\t\t},\n\t\tonScroll()\n\t\t{\n\t\t\tthis.contextMenu.destroy();\n\t\t}\n\t},\n\ttemplate: `\n\t\t<SidebarDetail\n\t\t\t:dialogId=\"dialogId\"\n\t\t\t:chatId=\"chatId\"\n\t\t\t:service=\"service\"\n\t\t\t@scroll=\"onScroll\"\n\t\t\tv-slot=\"slotProps\"\n\t\t\tclass=\"bx-im-sidebar-favorite-detail__scope bx-im-sidebar-favorite-detail__container\"\n\t\t>\n\t\t\t<template v-for=\"dateGroup in formattedCollection\">\n\t\t\t\t<DateGroup :dateText=\"dateGroup.dateGroupTitle\" />\n\t\t\t\t<FavoriteItem \n\t\t\t\t\tv-for=\"favorite in dateGroup.items\" \n\t\t\t\t\t:favorite=\"favorite\"\n\t\t\t\t\t:chatId=\"chatId\"\n\t\t\t\t\t:dialogId=\"dialogId\"\n\t\t\t\t\t@contextMenuClick=\"onContextMenuClick\" \n\t\t\t\t/>\n\t\t\t</template>\n\t\t\t<DetailEmptyState\n\t\t\t\tv-if=\"!slotProps.isLoading && isEmptyState\"\n\t\t\t\t:title=\"$Bitrix.Loc.getMessage('IM_SIDEBAR_FAVORITES_EMPTY')\"\n\t\t\t\t:iconType=\"SidebarDetailBlock.favorite\"\n\t\t\t/>\n\t\t</SidebarDetail>\n\t`\n};","import {Store} from 'ui.vue3.vuex';\n\nimport {Core} from 'im.v2.application.core';\nimport {DiskService} from 'im.v2.provider.service';\n\nimport type {ImModelSidebarFileItem} from 'im.v2.model';\n\nexport class FileManager\n{\n\tstore: Store;\n\n\tconstructor()\n\t{\n\t\tthis.store = Core.getStore();\n\t\tthis.diskService = new DiskService();\n\t}\n\n\tdelete(sidebarFile: ImModelSidebarFileItem)\n\t{\n\t\tthis.store.dispatch('sidebar/files/delete', {\n\t\t\tchatId: sidebarFile.chatId,\n\t\t\tid: sidebarFile.id\n\t\t});\n\n\t\tthis.diskService.delete({chatId: sidebarFile.chatId, fileId: sidebarFile.fileId});\n\t}\n\n\tsaveOnDisk(fileId: number): Promise\n\t{\n\t\treturn this.diskService.save(fileId);\n\t}\n}","import 'ui.viewer';\nimport 'ui.notification';\nimport {Loc, Dom} from 'main.core';\nimport type {MenuItem} from 'im.v2.lib.menu';\nimport {Utils} from 'im.v2.lib.utils';\nimport {SidebarMenu} from '../sidebar-base-menu';\nimport {FileManager} from './file-manager';\nimport type {ImModelFile, ImModelSidebarFileItem} from 'im.v2.model';\n\ntype MediaMenuContext = {\n\tsidebarFile: ImModelSidebarFileItem,\n\tfile: ImModelFile,\n\tmessageId: number,\n\tdialogId: string,\n}\n\nexport class FileMenu extends SidebarMenu\n{\n\tcontext: MediaMenuContext;\n\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis.id = 'im-sidebar-context-menu';\n\t\tthis.mediaManager = new FileManager();\n\t}\n\n\tgetMenuItems(): MenuItem[]\n\t{\n\t\treturn [\n\t\t\tthis.getOpenContextMessageItem(),\n\t\t\tthis.getDownloadFileItem(),\n\t\t\tthis.getSaveFileOnDiskItem(),\n\t\t\tthis.getDeleteFileItem(),\n\t\t];\n\t}\n\n\tgetViewFileItem(): ?MenuItem\n\t{\n\t\tconst viewerAttributes = Utils.file.getViewerDataAttributes(this.context.file.viewerAttrs);\n\t\tif (!viewerAttributes || this.context.file.type === 'audio')\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\thtml: this.getViewHtml(viewerAttributes),\n\t\t\tonclick: function() {\n\t\t\t\tthis.menuInstance.close();\n\t\t\t}.bind(this)\n\t\t};\n\t}\n\n\tgetDownloadFileItem(): ?MenuItem\n\t{\n\t\tif (!this.context.file.urlDownload)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\thtml: this.getDownloadHtml(this.context.file.urlDownload, this.context.file.name),\n\t\t\tonclick: function() {\n\t\t\t\tthis.menuInstance.close();\n\t\t\t}.bind(this)\n\t\t};\n\t}\n\n\tgetSaveFileOnDiskItem(): ?MenuItem\n\t{\n\t\tif (!this.context.sidebarFile.fileId)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\ttext: Loc.getMessage('IM_SIDEBAR_MENU_SAVE_FILE_ON_DISK'),\n\t\t\tonclick: function() {\n\t\t\t\tthis.mediaManager.saveOnDisk(this.context.sidebarFile.fileId).then(() => {\n\t\t\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\t\t\tcontent: Loc.getMessage('IM_SIDEBAR_FILE_SAVE_ON_DISK_SUCCESS')\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t\tthis.menuInstance.close();\n\t\t\t}.bind(this)\n\t\t};\n\t}\n\n\tgetDeleteFileItem(): MenuItem\n\t{\n\t\tif (this.getCurrentUserId() !== this.context.sidebarFile.authorId)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\ttext: Loc.getMessage('IM_SIDEBAR_MENU_DELETE_FILE'),\n\t\t\tonclick: function() {\n\t\t\t\tthis.mediaManager.delete(this.context.sidebarFile);\n\t\t\t\tthis.menuInstance.close();\n\t\t\t}.bind(this)\n\t\t};\n\t}\n\n\tgetViewHtml(viewerAttributes: { [key: string]: string }): HTMLDivElement\n\t{\n\t\tconst div = Dom.create('div', {\n\t\t\ttext: Loc.getMessage('IM_SIDEBAR_MENU_VIEW_FILE')\n\t\t});\n\n\t\tObject.entries(viewerAttributes).forEach(attribute => {\n\t\t\tconst [attributeName, attributeValue] = attribute;\n\t\t\tdiv.setAttribute(attributeName, attributeValue);\n\t\t});\n\n\t\treturn div;\n\t}\n\n\tgetDownloadHtml(urlDownload: string, fileName: string): HTMLAnchorElement\n\t{\n\t\tconst a = Dom.create('a', {\n\t\t\ttext: Loc.getMessage('IM_SIDEBAR_MENU_DOWNLOAD_FILE')\n\t\t});\n\n\t\tDom.style(a, 'display', 'block');\n\t\tDom.style(a, 'color', 'inherit');\n\t\tDom.style(a, 'text-decoration', 'inherit');\n\n\t\ta.setAttribute('href', urlDownload);\n\t\ta.setAttribute('download', fileName);\n\n\t\treturn a;\n\t}\n}","import {ImModelSidebarFileItem, ImModelFile} from 'im.v2.model';\nimport {Avatar, AvatarSize} from 'im.v2.component.elements';\nimport {SocialVideo} from 'ui.vue3.components.socialvideo';\nimport {Utils} from 'im.v2.lib.utils';\nimport 'ui.viewer';\nimport '../../../css/file/media-detail-item.css';\n\n// @vue/component\nexport const MediaDetailItem = {\n\tname: 'MediaDetailItem',\n\tcomponents: {SocialVideo, Avatar},\n\tprops: {\n\t\tfileItem: {\n\t\t\ttype: Object,\n\t\t\trequired: true\n\t\t}\n\t},\n\temits: ['contextMenuClick'],\n\tdata() {\n\t\treturn {\n\t\t\tshowContextButton: false,\n\t\t\tvideoDuration: 0,\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tAvatarSize: () => AvatarSize,\n\t\tsidebarFileItem(): ImModelSidebarFileItem\n\t\t{\n\t\t\treturn this.fileItem;\n\t\t},\n\t\tfile(): ImModelFile\n\t\t{\n\t\t\treturn this.$store.getters['files/get'](this.sidebarFileItem.fileId, true);\n\t\t},\n\t\tpreviewPicture(): Object\n\t\t{\n\t\t\tif (!this.hasPreview)\n\t\t\t{\n\t\t\t\treturn {};\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tbackgroundImage: `url('${this.file.urlPreview}')`,\n\t\t\t};\n\t\t},\n\t\thasPreview(): boolean\n\t\t{\n\t\t\treturn this.file.urlPreview !== '';\n\t\t},\n\t\tisImage(): boolean\n\t\t{\n\t\t\treturn this.file.type === 'image';\n\t\t},\n\t\tisVideo(): boolean\n\t\t{\n\t\t\treturn this.file.type === 'video';\n\t\t},\n\t\tviewerAttributes(): Object\n\t\t{\n\t\t\treturn Utils.file.getViewerDataAttributes(this.file.viewerAttrs);\n\t\t},\n\t\tvideoDurationText(): string\n\t\t{\n\t\t\tif (this.videoDuration === 0)\n\t\t\t{\n\t\t\t\treturn '--:--';\n\t\t\t}\n\n\t\t\treturn this.formatTime(this.videoDuration);\n\t\t}\n\t},\n\tmethods:\n\t{\n\t\tformatTime(rawSeconds: number): string\n\t\t{\n\t\t\trawSeconds = Math.floor(rawSeconds);\n\t\t\tconst durationHours = Math.floor(rawSeconds/60/60);\n\t\t\tif (durationHours > 0)\n\t\t\t{\n\t\t\t\trawSeconds -= durationHours*60*60;\n\t\t\t}\n\n\t\t\tconst durationMinutes = Math.floor(rawSeconds/60);\n\t\t\tif (durationMinutes > 0)\n\t\t\t{\n\t\t\t\trawSeconds -= durationMinutes*60;\n\t\t\t}\n\n\t\t\tconst hours = durationHours > 0 ? `${durationHours}:`: '';\n\t\t\tconst minutes = hours > 0 ? `${durationMinutes.toString().padStart(2, '0')}:`: `${durationMinutes}:`;\n\t\t\tconst seconds = rawSeconds.toString().padStart(2, '0');\n\n\t\t\treturn hours + minutes + seconds;\n\t\t},\n\t\thandleVideoEvent()\n\t\t{\n\t\t\tif (!this.$refs['video'])\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.videoDuration = this.$refs['video'].duration;\n\t\t},\n\t\tonContextMenuClick(event)\n\t\t{\n\t\t\tthis.$emit('contextMenuClick', {\n\t\t\t\tsidebarFile: this.sidebarFileItem,\n\t\t\t\tfile: this.file,\n\t\t\t\tmessageId: this.sidebarFileItem.messageId,\n\t\t\t}, event.currentTarget);\n\t\t}\n\t},\n\ttemplate: `\n\t\t<div \n\t\t\tclass=\"bx-im-sidebar-file-media-detail-item__container bx-im-sidebar-file-media-detail-item__scope\"\n\t\t\t@mouseover=\"showContextButton = true\"\n\t\t\t@mouseleave=\"showContextButton = false\"\n\t\t>\n\t\t\t<div class=\"bx-im-sidebar-file-media-detail-item__header-container\">\n\t\t\t\t<div class=\"bx-im-sidebar-file-media-detail-item__avatar-container\">\n\t\t\t\t\t<Avatar :dialogId=\"sidebarFileItem.authorId\" :withStatus=\"false\" :size=\"AvatarSize.S\"></Avatar>\n\t\t\t\t</div>\n\t\t\t\t<button\n\t\t\t\t\tv-if=\"showContextButton\"\n\t\t\t\t\tclass=\"bx-im-sidebar-file-media-detail-item__context-menu bx-im-messenger__context-menu-icon\"\n\t\t\t\t\t@click=\"onContextMenuClick\"\n\t\t\t\t></button>\n\t\t\t</div>\n\t\t\t<div \n\t\t\t\tv-if=\"isImage\"\n\t\t\t\tclass=\"bx-im-sidebar-file-media-detail-item__content --image\" \n\t\t\t\t:style=\"previewPicture\"\n\t\t\t\tv-bind=\"viewerAttributes\"\n\t\t\t>\n\t\t\t</div>\n\t\t\t<div\n\t\t\t\tv-if=\"isVideo\"\n\t\t\t\tclass=\"bx-im-sidebar-file-media-detail-item__content --video\"\n\t\t\t\t:style=\"previewPicture\"\n\t\t\t\tv-bind=\"viewerAttributes\"\n\t\t\t>\n\t\t\t\t<video \n\t\t\t\t\tv-show=\"!hasPreview\"\n\t\t\t\t\tref=\"video\"\n\t\t\t\t\tclass=\"bx-im-sidebar-file-media-detail-item__video\" \n\t\t\t\t\tpreload=\"metadata\" :src=\"file.urlDownload\"\n\t\t\t\t\t@durationchange=\"handleVideoEvent\"\n\t\t\t\t\t@loadeddata=\"handleVideoEvent\"\n\t\t\t\t\t@loadedmetadata=\"handleVideoEvent\"\n\t\t\t\t></video>\n\t\t\t</div>\n\t\t\t<div v-if=\"isVideo\" class=\"bx-im-sidebar-file-media-detail-item__video-controls\">\n\t\t\t\t<span class=\"bx-im-sidebar-file-media-detail-item__video-controls-icon\"></span>\n\t\t\t\t<span class=\"bx-im-sidebar-file-media-detail-item__video-controls-time\">{{ videoDurationText }}</span>\n\t\t\t</div>\n\t\t</div>\n\t`\n};","import {SidebarDetailBlock, SidebarFileTypes} from 'im.v2.const';\nimport {SidebarCollectionFormatter} from '../../classes/sidebar-collection-formatter';\nimport {FileMenu} from '../../classes/context-menu/file/file-menu';\nimport {DateGroup} from '../date-group';\nimport {DetailEmptyState} from '../detail-empty-state';\nimport {MediaDetailItem} from './item/media-detail-item';\nimport {SidebarDetail} from '../detail';\nimport '../../css/file/media-detail.css';\n\nimport type {ImModelSidebarFileItem} from 'im.v2.model';\n\n// @vue/component\nexport const MediaDetail = {\n\tname: 'MediaDetail',\n\tcomponents: {DateGroup, MediaDetailItem, DetailEmptyState, SidebarDetail},\n\tprops: {\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true\n\t\t},\n\t\tchatId: {\n\t\t\ttype: Number,\n\t\t\trequired: true\n\t\t},\n\t\tservice: {\n\t\t\ttype: Object,\n\t\t\trequired: true\n\t\t}\n\t},\n\tcomputed:\n\t{\n\t\tSidebarDetailBlock: () => SidebarDetailBlock,\n\t\tfiles(): ImModelSidebarFileItem[]\n\t\t{\n\t\t\treturn this.$store.getters['sidebar/files/get'](this.chatId, SidebarFileTypes.media);\n\t\t},\n\t\tformattedCollection(): Array\n\t\t{\n\t\t\treturn this.collectionFormatter.format(this.files);\n\t\t},\n\t\tisEmptyState(): boolean\n\t\t{\n\t\t\treturn this.formattedCollection.length === 0;\n\t\t}\n\t},\n\tcreated()\n\t{\n\t\tthis.collectionFormatter = new SidebarCollectionFormatter();\n\t\tthis.contextMenu = new FileMenu();\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.collectionFormatter.destroy();\n\t\tthis.contextMenu.destroy();\n\t},\n\tmethods:\n\t{\n\t\tonScroll()\n\t\t{\n\t\t\tthis.contextMenu.destroy();\n\t\t},\n\t\tonContextMenuClick(event, target)\n\t\t{\n\t\t\tconst item = {\n\t\t\t\t...event,\n\t\t\t\tdialogId: this.dialogId\n\t\t\t};\n\n\t\t\tthis.contextMenu.openMenu(item, target);\n\t\t}\n\t},\n\ttemplate: `\n\t\t<SidebarDetail\n\t\t\t:dialogId=\"dialogId\"\n\t\t\t:chatId=\"chatId\"\n\t\t\t:service=\"service\"\n\t\t\t@scroll=\"onScroll\"\n\t\t\tv-slot=\"slotProps\"\n\t\t\tclass=\"bx-im-sidebar-file-media-detail__scope\"\n\t\t>\n\t\t\t<template v-for=\"dateGroup in formattedCollection\">\n\t\t\t\t<DateGroup :dateText=\"dateGroup.dateGroupTitle\" />\n\t\t\t\t<div class=\"bx-im-sidebar-file-media-detail__items-group\">\n\t\t\t\t\t<MediaDetailItem\n\t\t\t\t\t\tv-for=\"file in dateGroup.items\"\n\t\t\t\t\t\t:fileItem=\"file\"\n\t\t\t\t\t\t@contextMenuClick=\"onContextMenuClick\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t\t<DetailEmptyState\n\t\t\t\tv-if=\"!slotProps.isLoading && isEmptyState\"\n\t\t\t\t:title=\"$Bitrix.Loc.getMessage('IM_SIDEBAR_FILES_EMPTY')\"\n\t\t\t\t:iconType=\"SidebarDetailBlock.media\"\n\t\t\t/>\n\t\t</SidebarDetail>\n\t`\n};","import {BitrixVue} from 'ui.vue3';\nimport {AudioPlayer, AudioPlayerState} from 'ui.vue3.components.audioplayer';\nimport {Utils} from 'im.v2.lib.utils';\nimport {Avatar, AvatarSize} from 'im.v2.component.elements';\nimport '../../../css/file/audioplayer.css';\n\n// @vue/component\nexport const SidebarAudioPlayer = BitrixVue.cloneComponent(AudioPlayer, {\n\tname: 'SidebarAudioPlayer',\n\tcomponents: {Avatar},\n\tprops: {\n\t\tfile: {\n\t\t\ttype: Object,\n\t\t\trequired: true\n\t\t},\n\t\tauthorId: {\n\t\t\ttype: Number,\n\t\t\trequired: true\n\t\t},\n\t\ttimelineType: {\n\t\t\ttype: Number,\n\t\t\trequired: true\n\t\t},\n\t},\n\tdata() {\n\t\treturn {\n\t\t\t...this.parentData(),\n\t\t\tshowContextButton: false,\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tAvatarSize: () => AvatarSize,\n\t\tfileSize(): string\n\t\t{\n\t\t\treturn Utils.file.formatFileSize(this.file.size);\n\t\t},\n\t\tfileAuthorDialogId(): string\n\t\t{\n\t\t\treturn this.authorId.toString();\n\t\t},\n\t\tprogressPosition()\n\t\t{\n\t\t\tif (!this.loaded || this.state === AudioPlayerState.none)\n\t\t\t{\n\t\t\t\treturn {width: '100%'};\n\t\t\t}\n\n\t\t\treturn {width: `${this.progressInPixel}px`};\n\t\t},\n\t\tactiveTimelineStyles()\n\t\t{\n\t\t\tconst TIMELINE_VERTICAL_SHIFT = 44;\n\t\t\tconst ACTIVE_TIMELINE_VERTICAL_SHIFT = 19;\n\n\t\t\tconst shift = this.timelineType * TIMELINE_VERTICAL_SHIFT + ACTIVE_TIMELINE_VERTICAL_SHIFT;\n\n\t\t\treturn {\n\t\t\t\t...this.progressPosition,\n\t\t\t\t'background-position-y': `-${shift}px`\n\t\t\t};\n\t\t},\n\t\ttimelineStyles()\n\t\t{\n\t\t\tconst TIMELINE_VERTICAL_SHIFT = 44;\n\n\t\t\tconst shift = this.timelineType * TIMELINE_VERTICAL_SHIFT;\n\n\t\t\treturn {\n\t\t\t\t'background-position-y': `-${shift}px`\n\t\t\t};\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div \n\t\t\tclass=\"bx-im-sidebar-audio-player__container bx-im-sidebar-audio-player__scope\" \n\t\t\tref=\"body\"\n\t\t\t@mouseover=\"showContextButton = true\"\n\t\t\t@mouseleave=\"showContextButton = false\"\n\t\t>\n\t\t\t<div class=\"bx-im-sidebar-audio-player__control-container\">\n\t\t\t\t<button :class=\"['bx-im-sidebar-audio-player__control-button', {\n\t\t\t\t\t'bx-im-sidebar-audio-player__control-loader': loading,\n\t\t\t\t\t'bx-im-sidebar-audio-player__control-play': !loading && state !== State.play,\n\t\t\t\t\t'bx-im-sidebar-audio-player__control-pause': !loading && state === State.play,\n\t\t\t\t}]\" @click=\"clickToButton\"></button>\n\t\t\t\t<div class=\"bx-im-sidebar-audio-player__author-avatar-container\">\n\t\t\t\t\t<Avatar :dialogId=\"fileAuthorDialogId\" :withStatus=\"false\" :size=\"AvatarSize.XS\"></Avatar>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"bx-im-sidebar-audio-player__timeline-container\">\n\t\t\t\t<div class=\"bx-im-sidebar-audio-player__track-container\" @click=\"setPosition\" ref=\"track\">\n\t\t\t\t\t<div class=\"bx-im-sidebar-audio-player__track-mask\" :style=\"timelineStyles\"></div>\n\t\t\t\t\t<div class=\"bx-im-sidebar-audio-player__track-mask --active\" :style=\"activeTimelineStyles\"></div>\n\t\t\t\t\t<div class=\"bx-im-sidebar-audio-player__track-seek\" :style=\"seekPosition\"></div>\n\t\t\t\t\t<div class=\"bx-im-sidebar-audio-player__track-event\" @mousemove=\"seeking\"></div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"bx-im-sidebar-audio-player__timer-container\">\n\t\t\t\t\t{{fileSize}}, {{labelTime}}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<button\n\t\t\t\tv-if=\"showContextButton\"\n\t\t\t\tclass=\"bx-im-messenger__context-menu-icon bx-im-sidebar-audio-player__context-menu-button\"\n\t\t\t\t@click=\"$emit('contextMenuClick', $event)\"\n\t\t\t></button>\n\t\t\t<audio \n\t\t\t\tv-if=\"src\" \n\t\t\t\t:src=\"src\" \n\t\t\t\tclass=\"bx-im-sidebar-audio-player__audio-source\" \n\t\t\t\tref=\"source\" \n\t\t\t\t:preload=\"preload\"\n\t\t\t\t@abort=\"audioEventRouter('abort', $event)\"\n\t\t\t\t@error=\"audioEventRouter('error', $event)\"\n\t\t\t\t@suspend=\"audioEventRouter('suspend', $event)\"\n\t\t\t\t@canplay=\"audioEventRouter('canplay', $event)\"\n\t\t\t\t@canplaythrough=\"audioEventRouter('canplaythrough', $event)\"\n\t\t\t\t@durationchange=\"audioEventRouter('durationchange', $event)\"\n\t\t\t\t@loadeddata=\"audioEventRouter('loadeddata', $event)\"\n\t\t\t\t@loadedmetadata=\"audioEventRouter('loadedmetadata', $event)\"\n\t\t\t\t@timeupdate=\"audioEventRouter('timeupdate', $event)\"\n\t\t\t\t@play=\"audioEventRouter('play', $event)\"\n\t\t\t\t@playing=\"audioEventRouter('playing', $event)\"\n\t\t\t\t@pause=\"audioEventRouter('pause', $event)\"\n\t\t\t></audio>\n\t\t</div>\n\t`\n});","import {ImModelSidebarFileItem, ImModelFile} from 'im.v2.model';\nimport {Avatar, AvatarSize} from 'im.v2.component.elements';\nimport {SidebarAudioPlayer} from './audioplayer';\nimport '../../../css/file/audio-detail-item.css';\n\n// @vue/component\nexport const AudioDetailItem = {\n\tname: 'AudioDetailItem',\n\tcomponents: {SidebarAudioPlayer, Avatar},\n\tprops: {\n\t\tid: {\n\t\t\ttype: Number,\n\t\t\trequired: true\n\t\t},\n\t\tfileItem: {\n\t\t\ttype: Object,\n\t\t\trequired: true\n\t\t}\n\t},\n\temits: ['contextMenuClick'],\n\tdata() {\n\t\treturn {\n\t\t\ttimelineType: 0\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tAvatarSize: () => AvatarSize,\n\t\tsidebarFileItem(): ImModelSidebarFileItem\n\t\t{\n\t\t\treturn this.fileItem;\n\t\t},\n\t\tfile(): ImModelFile\n\t\t{\n\t\t\treturn this.$store.getters['files/get'](this.sidebarFileItem.fileId, true);\n\t\t},\n\t\taudioUrl(): string\n\t\t{\n\t\t\treturn this.file.urlDownload;\n\t\t}\n\t},\n\tcreated()\n\t{\n\t\tthis.timelineType = Math.floor(Math.random() * 5);\n\t},\n\tmethods:\n\t{\n\t\tonContextMenuClick(event)\n\t\t{\n\t\t\tthis.$emit('contextMenuClick', {\n\t\t\t\tsidebarFile: this.sidebarFileItem,\n\t\t\t\tfile: this.file,\n\t\t\t\tmessageId: this.sidebarFileItem.messageId,\n\t\t\t}, event.currentTarget);\n\t\t}\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-sidebar-file-audio-detail-item__container bx-im-sidebar-file-audio-detail-item__scope\">\n\t\t\t<SidebarAudioPlayer \n\t\t\t\t:id=\"id\"\n\t\t\t\t:src=\"audioUrl\" \n\t\t\t\t:file=\"file\" \n\t\t\t\t:timelineType=\"timelineType\" \n\t\t\t\t:authorId=\"sidebarFileItem.authorId\" \n\t\t\t\t@contextMenuClick=\"onContextMenuClick\"\n\t\t\t/>\n\t\t</div>\n\t`\n};","import {SidebarDetailBlock, SidebarFileTypes} from 'im.v2.const';\nimport {SidebarCollectionFormatter} from '../../classes/sidebar-collection-formatter';\nimport {FileMenu} from '../../classes/context-menu/file/file-menu';\nimport {SidebarDetail} from '../detail';\nimport {DateGroup} from '../date-group';\nimport {DetailEmptyState} from '../detail-empty-state';\nimport {AudioDetailItem} from './item/audio-detail-item';\nimport '../../css/file/audio-detail.css';\n\nimport type {ImModelSidebarFileItem} from 'im.v2.model';\n\n// @vue/component\nexport const AudioDetail = {\n\tname: 'AudioDetail',\n\tcomponents: {DetailEmptyState, AudioDetailItem, DateGroup, SidebarDetail},\n\tprops: {\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true\n\t\t},\n\t\tchatId: {\n\t\t\ttype: Number,\n\t\t\trequired: true\n\t\t},\n\t\tservice: {\n\t\t\ttype: Object,\n\t\t\trequired: true\n\t\t}\n\t},\n\tcomputed:\n\t{\n\t\tSidebarDetailBlock: () => SidebarDetailBlock,\n\t\tfiles(): ImModelSidebarFileItem[]\n\t\t{\n\t\t\treturn this.$store.getters['sidebar/files/get'](this.chatId, SidebarFileTypes.audio);\n\t\t},\n\t\tformattedCollection(): Array\n\t\t{\n\t\t\treturn this.collectionFormatter.format(this.files);\n\t\t},\n\t\tisEmptyState(): boolean\n\t\t{\n\t\t\treturn this.formattedCollection.length === 0;\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tthis.collectionFormatter = new SidebarCollectionFormatter();\n\t\tthis.contextMenu = new FileMenu();\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.collectionFormatter.destroy();\n\t\tthis.contextMenu.destroy();\n\t},\n\tmethods:\n\t{\n\t\tonScroll()\n\t\t{\n\t\t\tthis.contextMenu.destroy();\n\t\t},\n\t\tonContextMenuClick(event, target)\n\t\t{\n\t\t\tconst item = {\n\t\t\t\t...event,\n\t\t\t\tdialogId: this.dialogId\n\t\t\t};\n\n\t\t\tthis.contextMenu.openMenu(item, target);\n\t\t}\n\t},\n\ttemplate: `\n\t\t<SidebarDetail\n\t\t\t:dialogId=\"dialogId\"\n\t\t\t:chatId=\"chatId\"\n\t\t\t:service=\"service\"\n\t\t\t@scroll=\"onScroll\"\n\t\t\tv-slot=\"slotProps\"\n\t\t\tclass=\"bx-im-sidebar-file-audio-detail__scope\"\n\t\t>\n\t\t\t<template v-for=\"dateGroup in formattedCollection\">\n\t\t\t\t<DateGroup :dateText=\"dateGroup.dateGroupTitle\" />\n\t\t\t\t<AudioDetailItem\n\t\t\t\t\tv-for=\"file in dateGroup.items\"\n\t\t\t\t\t:id=\"file.id\"\n\t\t\t\t\t:fileItem=\"file\"\n\t\t\t\t\t@contextMenuClick=\"onContextMenuClick\"\n\t\t\t\t/>\n\t\t\t</template>\n\t\t\t<DetailEmptyState\n\t\t\t\tv-if=\"!slotProps.isLoading && isEmptyState\"\n\t\t\t\t:title=\"$Bitrix.Loc.getMessage('IM_SIDEBAR_FILES_EMPTY')\"\n\t\t\t\t:iconType=\"SidebarDetailBlock.audio\"\n\t\t\t/>\n\t\t</SidebarDetail>\n\t`\n};","import {ImModelSidebarFileItem, ImModelFile} from 'im.v2.model';\nimport {Utils} from 'im.v2.lib.utils';\nimport {Avatar, AvatarSize, ChatTitle} from 'im.v2.component.elements';\nimport '../../../css/file/document-detail-item.css';\nimport 'ui.icons';\n\n// @vue/component\nexport const DocumentDetailItem = {\n\tname: 'DocumentDetailItem',\n\tcomponents: {Avatar, ChatTitle},\n\tprops: {\n\t\tfileItem: {\n\t\t\ttype: Object,\n\t\t\trequired: true\n\t\t}\n\t},\n\temits: ['contextMenuClick'],\n\tdata() {\n\t\treturn {\n\t\t\tshowContextButton: false,\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tAvatarSize: () => AvatarSize,\n\t\tsidebarFileItem(): ImModelSidebarFileItem\n\t\t{\n\t\t\treturn this.fileItem;\n\t\t},\n\t\tfile(): ImModelFile\n\t\t{\n\t\t\treturn this.$store.getters['files/get'](this.sidebarFileItem.fileId, true);\n\t\t},\n\t\tfileIconClass(): string\n\t\t{\n\t\t\treturn `ui-icon ui-icon-file-${this.file.icon}`;\n\t\t},\n\t\tfileShortName(): string\n\t\t{\n\t\t\tconst NAME_MAX_LENGTH = 21;\n\n\t\t\treturn Utils.file.getShortFileName(this.file.name, NAME_MAX_LENGTH);\n\t\t},\n\t\tfileSize(): string\n\t\t{\n\t\t\treturn Utils.file.formatFileSize(this.file.size);\n\t\t},\n\t\tviewerAttributes(): Object\n\t\t{\n\t\t\treturn Utils.file.getViewerDataAttributes(this.file.viewerAttrs);\n\t\t},\n\t\tisViewerAvailable(): boolean\n\t\t{\n\t\t\treturn Object.keys(this.viewerAttributes).length > 0;\n\t\t},\n\t\tauthorId(): number\n\t\t{\n\t\t\treturn this.sidebarFileItem.authorId;\n\t\t}\n\t},\n\tmethods:\n\t{\n\t\tdownload()\n\t\t{\n\t\t\tif (this.isViewerAvailable)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst urlToOpen = this.file.urlShow ? this.file.urlShow : this.file.urlDownload;\n\t\t\twindow.open(urlToOpen, '_blank');\n\t\t},\n\t\tonContextMenuClick(event)\n\t\t{\n\t\t\tthis.$emit('contextMenuClick', {\n\t\t\t\tsidebarFile: this.sidebarFileItem,\n\t\t\t\tfile: this.file,\n\t\t\t\tmessageId: this.sidebarFileItem.messageId,\n\t\t\t}, event.currentTarget);\n\t\t}\n\t},\n\ttemplate: `\n\t\t<div \n\t\t\tclass=\"bx-im-sidebar-file-document-detail-item__container bx-im-sidebar-file-document-detail-item__scope\"\n\t\t\t@mouseover=\"showContextButton = true\"\n\t\t\t@mouseleave=\"showContextButton = false\"\t\t\n\t\t>\n\t\t\t<div class=\"bx-im-sidebar-file-document-detail-item__icon-container\">\n\t\t\t\t<div :class=\"fileIconClass\"><i></i></div>\n\t\t\t</div>\n\t\t\t<div class=\"bx-im-sidebar-file-document-detail-item__content-container\" v-bind=\"viewerAttributes\">\n\t\t\t\t<div class=\"bx-im-sidebar-file-document-detail-item__content\">\n\t\t\t\t\t<div class=\"bx-im-sidebar-file-document-detail-item__document-title\" @click=\"download\">\n\t\t\t\t\t\t<span class=\"bx-im-sidebar-file-document-detail-item__document-title-text\">{{fileShortName}}</span>\n\t\t\t\t\t\t<span class=\"bx-im-sidebar-file-document-detail-item__document-size\">{{fileSize}}</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"bx-im-sidebar-file-document-detail-item__author-container\">\n\t\t\t\t\t\t<template v-if=\"authorId > 0\">\n\t\t\t\t\t\t\t<Avatar\n\t\t\t\t\t\t\t\t:dialogId=\"authorId\"\n\t\t\t\t\t\t\t\t:size=\"AvatarSize.XS\"\n\t\t\t\t\t\t\t\t:withStatus=\"false\"\n\t\t\t\t\t\t\t\tclass=\"bx-im-sidebar-file-document-detail-item__author-avatar\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<ChatTitle :dialogId=\"authorId\" :showItsYou=\"false\" />\n\t\t\t\t\t\t</template>\n\t\t\t\t\t\t<span v-else class=\"bx-im-sidebar-file-document-detail-item__system-author-text\">\n\t\t\t\t\t\t\t{{$Bitrix.Loc.getMessage('IM_SIDEBAR_SYSTEM_USER')}}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<button\n\t\t\t\tv-if=\"showContextButton\"\n\t\t\t\tclass=\"bx-im-messenger__context-menu-icon\" \n\t\t\t\t@click=\"onContextMenuClick\"\n\t\t\t></button>\n\t\t</div>\n\t`\n};","import {SidebarDetailBlock, SidebarFileTypes} from 'im.v2.const';\nimport {SidebarCollectionFormatter} from '../../classes/sidebar-collection-formatter';\nimport {FileMenu} from '../../classes/context-menu/file/file-menu';\nimport {SidebarDetail} from '../detail';\nimport {DateGroup} from '../date-group';\nimport {DetailEmptyState} from '../detail-empty-state';\nimport {DocumentDetailItem} from './item/document-detail-item';\nimport '../../css/file/document-detail.css';\n\nimport type {ImModelSidebarFileItem} from 'im.v2.model';\n\n// @vue/component\nexport const DocumentDetail = {\n\tname: 'DocumentDetail',\n\tcomponents: {DateGroup, DocumentDetailItem, DetailEmptyState, SidebarDetail},\n\tprops: {\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true\n\t\t},\n\t\tchatId: {\n\t\t\ttype: Number,\n\t\t\trequired: true\n\t\t},\n\t\tservice: {\n\t\t\ttype: Object,\n\t\t\trequired: true\n\t\t}\n\t},\n\tcomputed:\n\t{\n\t\tSidebarDetailBlock: () => SidebarDetailBlock,\n\t\tfiles(): ImModelSidebarFileItem[]\n\t\t{\n\t\t\treturn this.$store.getters['sidebar/files/get'](this.chatId, SidebarFileTypes.document);\n\t\t},\n\t\tformattedCollection(): Array\n\t\t{\n\t\t\treturn this.collectionFormatter.format(this.files);\n\t\t},\n\t\tisEmptyState(): boolean\n\t\t{\n\t\t\treturn this.formattedCollection.length === 0;\n\t\t}\n\t},\n\tcreated()\n\t{\n\t\tthis.collectionFormatter = new SidebarCollectionFormatter();\n\t\tthis.contextMenu = new FileMenu();\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.collectionFormatter.destroy();\n\t\tthis.contextMenu.destroy();\n\t},\n\tmethods:\n\t{\n\t\tonScroll()\n\t\t{\n\t\t\tthis.contextMenu.destroy();\n\t\t},\n\t\tonContextMenuClick(event, target)\n\t\t{\n\t\t\tconst item = {\n\t\t\t\t...event,\n\t\t\t\tdialogId: this.dialogId\n\t\t\t};\n\n\t\t\tthis.contextMenu.openMenu(item, target);\n\t\t}\n\t},\n\ttemplate: `\n\t\t<SidebarDetail\n\t\t\t:dialogId=\"dialogId\"\n\t\t\t:chatId=\"chatId\"\n\t\t\t:service=\"service\"\n\t\t\t@scroll=\"onScroll\"\n\t\t\tv-slot=\"slotProps\"\n\t\t\tclass=\"bx-im-sidebar-file-document-detail__scope\"\n\t\t>\n\t\t\t<template v-for=\"dateGroup in formattedCollection\">\n\t\t\t\t<DateGroup :dateText=\"dateGroup.dateGroupTitle\" />\n\t\t\t\t<DocumentDetailItem\n\t\t\t\t\tv-for=\"file in dateGroup.items\"\n\t\t\t\t\t:fileItem=\"file\"\n\t\t\t\t\t@contextMenuClick=\"onContextMenuClick\"\n\t\t\t\t/>\n\t\t\t</template>\n\t\t\t<DetailEmptyState\n\t\t\t\tv-if=\"!slotProps.isLoading && isEmptyState\"\n\t\t\t\t:title=\"$Bitrix.Loc.getMessage('IM_SIDEBAR_FILES_EMPTY')\"\n\t\t\t\t:iconType=\"SidebarDetailBlock.document\"\n\t\t\t/>\n\t\t</SidebarDetail>\n\t`\n};","import {SidebarDetailBlock, SidebarFileTypes} from 'im.v2.const';\nimport {SidebarCollectionFormatter} from '../../classes/sidebar-collection-formatter';\nimport {FileMenu} from '../../classes/context-menu/file/file-menu';\nimport {DateGroup} from '../date-group';\nimport {SidebarDetail} from '../detail';\nimport {DetailEmptyState} from '../detail-empty-state';\nimport {DocumentDetailItem} from './item/document-detail-item';\nimport '../../css/file/other-detail.css';\n\nimport type {ImModelSidebarFileItem} from 'im.v2.model';\n\n// @vue/component\nexport const OtherDetail = {\n\tname: 'OtherDetail',\n\tcomponents: {DateGroup, DocumentDetailItem, DetailEmptyState, SidebarDetail},\n\tprops: {\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true\n\t\t},\n\t\tchatId: {\n\t\t\ttype: Number,\n\t\t\trequired: true\n\t\t},\n\t\tservice: {\n\t\t\ttype: Object,\n\t\t\trequired: true\n\t\t}\n\t},\n\tcomputed:\n\t{\n\t\tSidebarDetailBlock: () => SidebarDetailBlock,\n\t\tfiles(): ImModelSidebarFileItem[]\n\t\t{\n\t\t\treturn this.$store.getters['sidebar/files/get'](this.chatId, SidebarFileTypes.other);\n\t\t},\n\t\tformattedCollection(): Array\n\t\t{\n\t\t\treturn this.collectionFormatter.format(this.files);\n\t\t},\n\t\tisEmptyState(): boolean\n\t\t{\n\t\t\treturn this.formattedCollection.length === 0;\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tthis.collectionFormatter = new SidebarCollectionFormatter();\n\t\tthis.contextMenu = new FileMenu();\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.collectionFormatter.destroy();\n\t\tthis.contextMenu.destroy();\n\t},\n\tmethods:\n\t{\n\t\tonScroll()\n\t\t{\n\t\t\tthis.contextMenu.destroy();\n\t\t},\n\t\tonContextMenuClick(event, target)\n\t\t{\n\t\t\tconst item = {\n\t\t\t\t...event,\n\t\t\t\tdialogId: this.dialogId\n\t\t\t};\n\n\t\t\tthis.contextMenu.openMenu(item, target);\n\t\t}\n\t},\n\ttemplate: `\n\t\t<SidebarDetail\n\t\t\t:dialogId=\"dialogId\"\n\t\t\t:chatId=\"chatId\"\n\t\t\t:service=\"service\"\n\t\t\t@scroll=\"onScroll\"\n\t\t\tv-slot=\"slotProps\"\n\t\t\tclass=\"bx-im-sidebar-file-other-detail__scope\"\n\t\t>\n\t\t\t<template v-for=\"dateGroup in formattedCollection\">\n\t\t\t\t<DateGroup :dateText=\"dateGroup.dateGroupTitle\" />\n\t\t\t\t<DocumentDetailItem\n\t\t\t\t\tv-for=\"file in dateGroup.items\"\n\t\t\t\t\t:fileItem=\"file\"\n\t\t\t\t\t@contextMenuClick=\"onContextMenuClick\"\n\t\t\t\t/>\n\t\t\t</template>\n\t\t\t<DetailEmptyState\n\t\t\t\tv-if=\"!slotProps.isLoading && isEmptyState\"\n\t\t\t\t:title=\"$Bitrix.Loc.getMessage('IM_SIDEBAR_FILES_EMPTY')\"\n\t\t\t\t:iconType=\"SidebarDetailBlock.other\"\n\t\t\t/>\n\t\t</SidebarDetail>\n\t`\n};","import {ImModelFile, ImModelSidebarFileItem} from 'im.v2.model';\nimport {Utils} from 'im.v2.lib.utils';\nimport 'ui.icons';\nimport 'ui.viewer';\nimport '../../../css/file/file-preview-item.css';\n\n// @vue/component\nexport const FilePreviewItem = {\n\tname: 'FilePreviewItem',\n\tprops: {\n\t\tfileItem: {\n\t\t\ttype: Object,\n\t\t\trequired: true\n\t\t}\n\t},\n\tcomputed:\n\t{\n\t\tsidebarFileItem(): ImModelSidebarFileItem\n\t\t{\n\t\t\treturn this.fileItem;\n\t\t},\n\t\tfile(): ImModelFile\n\t\t{\n\t\t\treturn this.$store.getters['files/get'](this.sidebarFileItem.fileId, true);\n\t\t},\n\t\tpreviewImageStyles(): Object\n\t\t{\n\t\t\tif (!this.hasPreview)\n\t\t\t{\n\t\t\t\treturn {};\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tbackgroundImage: `url('${this.file.urlPreview}')`,\n\t\t\t};\n\t\t},\n\t\thasPreview(): boolean\n\t\t{\n\t\t\treturn this.file.urlPreview !== '';\n\t\t},\n\t\tfileShortName(): string\n\t\t{\n\t\t\tconst NAME_MAX_LENGTH = 25;\n\n\t\t\treturn Utils.file.getShortFileName(this.file.name, NAME_MAX_LENGTH);\n\t\t},\n\t\tviewerAttributes(): Object\n\t\t{\n\t\t\treturn Utils.file.getViewerDataAttributes(this.file.viewerAttrs);\n\t\t},\n\t\tisImage(): boolean\n\t\t{\n\t\t\treturn this.file.type === 'image';\n\t\t},\n\t\tisVideo(): boolean\n\t\t{\n\t\t\treturn this.file.type === 'video';\n\t\t},\n\t\tisAudio(): boolean\n\t\t{\n\t\t\treturn this.file.type === 'audio';\n\t\t},\n\t\tfileIconClass(): string\n\t\t{\n\t\t\treturn `ui-icon ui-icon-file-${this.file.icon}`;\n\t\t},\n\t\tisViewerAvailable(): boolean\n\t\t{\n\t\t\treturn Object.keys(this.viewerAttributes).length > 0;\n\t\t}\n\t},\n\tmethods:\n\t{\n\t\tdownload()\n\t\t{\n\t\t\tif (this.isViewerAvailable)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst urlToOpen = this.file.urlShow ? this.file.urlShow : this.file.urlDownload;\n\t\t\twindow.open(urlToOpen, '_blank');\n\t\t}\n\t},\n\ttemplate: `\n\t\t<div \n\t\t\tclass=\"bx-im-sidebar-file-preview-item__container bx-im-sidebar-file-preview-item__scope\" \n\t\t\tv-bind=\"viewerAttributes\" \n\t\t\t@click=\"download\" \n\t\t\t:title=\"file.name\"\n\t\t>\n\t\t\t<div v-if=\"isImage\" class=\"bx-im-sidebar-file-preview-item__preview-box\" :style=\"previewImageStyles\"></div>\n\t\t\t<div \n\t\t\t\tv-else-if=\"isVideo\" \n\t\t\t\tclass=\"bx-im-sidebar-file-preview-item__preview-box bx-im-sidebar-file-preview-item__preview-video-box\"\n\t\t\t\t:style=\"previewImageStyles\"\n\t\t\t>\n\t\t\t\t<video v-if=\"!hasPreview\" class=\"bx-im-sidebar-file-preview-item__preview-video\" preload=\"metadata\" :src=\"file.urlDownload\"></video>\n\t\t\t\t<div class=\"bx-im-sidebar-file-preview-item__preview-video-play-button\"></div>\n\t\t\t\t<div class=\"bx-im-sidebar-file-preview-item__preview-video-play-icon\"></div>\n\t\t\t</div>\n\t\t\t<div v-else-if=\"isAudio\" class=\"bx-im-sidebar-file-preview-item__preview-box\">\n\t\t\t\t<div class=\"bx-im-sidebar-file-preview-item__preview-audio-play-button\"></div>\n\t\t\t</div>\n\t\t\t<div v-else class=\"bx-im-sidebar-file-preview-item__preview-box\">\n\t\t\t\t<div :class=\"fileIconClass\"><i></i></div>\n\t\t\t</div>\n\t\t\t<div class=\"bx-im-sidebar-file-preview-item__text\">{{ fileShortName }}</div>\n\t\t</div>\n\t`\n};","import {SidebarBlock, SidebarDetailBlock} from 'im.v2.const';\nimport {FilePreviewItem} from './item/file-preview-item';\nimport {DetailEmptyState} from '../detail-empty-state';\nimport '../../css/file/preview.css';\n\nimport type {ImModelDialog, ImModelSidebarFileItem} from 'im.v2.model';\n\n// @vue/component\nexport const FilePreview = {\n\tname: 'FilePreview',\n\tcomponents: {DetailEmptyState, FilePreviewItem},\n\tprops: {\n\t\tisLoading: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false\n\t\t},\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true\n\t\t}\n\t},\n\tcomputed:\n\t{\n\t\tSidebarDetailBlock: () => SidebarDetailBlock,\n\t\tfiles(): ImModelSidebarFileItem[]\n\t\t{\n\t\t\tif (this.isMigrationFinished)\n\t\t\t{\n\t\t\t\treturn this.$store.getters['sidebar/files/getLatest'](this.chatId);\n\t\t\t}\n\n\t\t\treturn this.$store.getters['sidebar/files/getLatestUnsorted'](this.chatId);\n\t\t},\n\t\thasFiles(): boolean\n\t\t{\n\t\t\treturn this.files.length > 0;\n\t\t},\n\t\tisMigrationFinished(): boolean\n\t\t{\n\t\t\treturn this.$store.state.sidebar.isFilesMigrated;\n\t\t},\n\t\tdialog(): ImModelDialog\n\t\t{\n\t\t\treturn this.$store.getters['dialogues/get'](this.dialogId, true);\n\t\t},\n\t\tchatId(): number\n\t\t{\n\t\t\treturn this.dialog.chatId;\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tonOpenDetail()\n\t\t{\n\t\t\tif (!this.hasFiles)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst block = this.isMigrationFinished ? SidebarBlock.file : SidebarBlock.fileUnsorted;\n\t\t\tconst detailBlock = this.isMigrationFinished ? SidebarDetailBlock.media : SidebarDetailBlock.fileUnsorted;\n\n\t\t\tthis.$emit('openDetail', {block, detailBlock});\n\t\t}\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-sidebar-file-preview__scope\">\n\t\t\t<div v-if=\"isLoading\" class=\"bx-im-sidebar-file-preview__skeleton\"></div>\n\t\t\t<div v-else class=\"bx-im-sidebar-file-preview__container\">\n\t\t\t\t<div \n\t\t\t\t\tclass=\"bx-im-sidebar-file-preview__header_container\" \n\t\t\t\t\t:class=\"[hasFiles ? '--active': '']\" \n\t\t\t\t\t@click=\"onOpenDetail\"\n\t\t\t\t>\n\t\t\t\t\t<span class=\"bx-im-sidebar-file-preview__title-text\">\n\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('IM_SIDEBAR_MEDIA_DETAIL_TITLE') }}\n\t\t\t\t\t</span>\n\t\t\t\t\t<div v-if=\"hasFiles\" class=\"bx-im-sidebar__forward-icon\"></div>\n\t\t\t\t</div>\n\t\t\t\t<div v-if=\"hasFiles\" class=\"bx-im-sidebar-file-preview__files-container\">\n\t\t\t\t\t<FilePreviewItem v-for=\"file in files\" :fileItem=\"file\" />\n\t\t\t\t</div>\n\t\t\t\t<DetailEmptyState\n\t\t\t\t\tv-else\n\t\t\t\t\t:title=\"$Bitrix.Loc.getMessage('IM_SIDEBAR_MEDIA_AND_FILES_EMPTY')\"\n\t\t\t\t\t:iconType=\"SidebarDetailBlock.media\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</div>\n\t`\n};","import {SidebarDetailBlock, SidebarFileTypes} from 'im.v2.const';\nimport type {ImModelSidebarFileItem} from 'im.v2.model';\nimport {SidebarCollectionFormatter} from '../../classes/sidebar-collection-formatter';\nimport {FileMenu} from '../../classes/context-menu/file/file-menu';\nimport {SidebarDetail} from '../detail';\nimport {DateGroup} from '../date-group';\nimport {DetailEmptyState} from '../detail-empty-state';\nimport {DocumentDetailItem} from '../file/item/document-detail-item';\nimport '../../css/file-unsorted/detail.css';\n\n// @vue/component\nexport const FileUnsortedDetail = {\n\tname: 'FileUnsortedDetail',\n\tcomponents: {DateGroup, DocumentDetailItem, DetailEmptyState, SidebarDetail},\n\tprops: {\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true\n\t\t},\n\t\tchatId: {\n\t\t\ttype: Number,\n\t\t\trequired: true\n\t\t},\n\t\tservice: {\n\t\t\ttype: Object,\n\t\t\trequired: true\n\t\t}\n\t},\n\tcomputed:\n\t{\n\t\tSidebarDetailBlock: () => SidebarDetailBlock,\n\t\tfiles(): ImModelSidebarFileItem[]\n\t\t{\n\t\t\treturn this.$store.getters['sidebar/files/get'](this.chatId, SidebarFileTypes.fileUnsorted);\n\t\t},\n\t\tformattedCollection(): Array\n\t\t{\n\t\t\treturn this.collectionFormatter.format(this.files);\n\t\t},\n\t\tisEmptyState(): boolean\n\t\t{\n\t\t\treturn this.formattedCollection.length === 0;\n\t\t}\n\t},\n\tcreated()\n\t{\n\t\tthis.collectionFormatter = new SidebarCollectionFormatter();\n\t\tthis.contextMenu = new FileMenu();\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.collectionFormatter.destroy();\n\t\tthis.contextMenu.destroy();\n\t},\n\tmethods:\n\t{\n\t\tonScroll()\n\t\t{\n\t\t\tthis.contextMenu.destroy();\n\t\t},\n\t\tonContextMenuClick(event, target)\n\t\t{\n\t\t\tconst item = {\n\t\t\t\t...event,\n\t\t\t\tdialogId: this.dialogId\n\t\t\t};\n\n\t\t\tthis.contextMenu.openMenu(item, target);\n\t\t}\n\t},\n\ttemplate: `\n\t\t<SidebarDetail\n\t\t\t:dialogId=\"dialogId\"\n\t\t\t:chatId=\"chatId\"\n\t\t\t:service=\"service\"\n\t\t\t@scroll=\"onScroll\"\n\t\t\tv-slot=\"slotProps\"\n\t\t\tclass=\"bx-im-sidebar-file-unsorted-detail__container bx-im-sidebar-file-unsorted-detail__scope\"\n\t\t>\n\t\t\t<template v-for=\"dateGroup in formattedCollection\">\n\t\t\t\t<DateGroup :dateText=\"dateGroup.dateGroupTitle\" />\n\t\t\t\t<DocumentDetailItem\n\t\t\t\t\tv-for=\"file in dateGroup.items\"\n\t\t\t\t\t:fileItem=\"file\"\n\t\t\t\t\t@contextMenuClick=\"onContextMenuClick\"\n\t\t\t\t/>\n\t\t\t</template>\n\t\t\t<DetailEmptyState\n\t\t\t\tv-if=\"!slotProps.isLoading && isEmptyState\"\n\t\t\t\t:title=\"$Bitrix.Loc.getMessage('IM_SIDEBAR_FILES_EMPTY')\"\n\t\t\t\t:iconType=\"SidebarDetailBlock.document\"\n\t\t\t/>\n\t\t</SidebarDetail>\n\t`\n};","import {RestClient} from 'rest.client';\nimport {Store} from 'ui.vue3.vuex';\n\nimport {Core} from 'im.v2.application.core';\nimport {RestMethod} from 'im.v2.const';\n\nexport class TaskManager\n{\n\tstore: Store;\n\trestClient: RestClient;\n\n\tconstructor()\n\t{\n\t\tthis.store = Core.getStore();\n\t\tthis.restClient = Core.getRestClient();\n\t}\n\n\tdelete({id, chatId})\n\t{\n\t\tthis.store.dispatch('sidebar/tasks/delete', {\n\t\t\tchatId: chatId,\n\t\t\tid: id\n\t\t});\n\n\t\tconst queryParams = {'LINK_ID': id};\n\t\tthis.restClient.callMethod(RestMethod.imChatTaskDelete, queryParams).catch(error => {\n\t\t\tconsole.error('Im.Sidebar: error deleting task', error);\n\t\t});\n\t}\n}","import 'ui.notification';\nimport type {MenuItem} from 'im.v2.lib.menu';\nimport {SidebarMenu} from '../sidebar-base-menu';\nimport {TaskManager} from './task-manager';\nimport type {ImModelSidebarTaskItem} from 'im.v2.model';\nimport {Loc} from 'main.core';\n\ntype TaskMenuContext = {\n\ttask: ImModelSidebarTaskItem,\n\tmessageId: number,\n\tdialogId: string,\n\tsource: string,\n}\n\nexport class TaskMenu extends SidebarMenu\n{\n\tcontext: TaskMenuContext;\n\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis.id = 'im-sidebar-context-menu';\n\t\tthis.taskManager = new TaskManager();\n\t}\n\n\tgetMenuItems(): MenuItem[]\n\t{\n\t\treturn [\n\t\t\tthis.getOpenContextMessageItem(),\n\t\t\tthis.getCopyLinkItem(Loc.getMessage('IM_SIDEBAR_MENU_COPY_TASK_LINK')),\n\t\t\tthis.getDeleteItem(),\n\t\t];\n\t}\n\n\tgetDeleteItem(): MenuItem\n\t{\n\t\treturn {\n\t\t\ttext: Loc.getMessage('IM_SIDEBAR_MENU_DELETE_TASK_CONNECTION'),\n\t\t\tonclick: function() {\n\t\t\t\tthis.taskManager.delete(this.context.task);\n\t\t\t\tthis.menuInstance.close();\n\t\t\t}.bind(this)\n\t\t};\n\t}\n}","import { ImModelSidebarTaskItem } from 'im.v2.model';\nimport { Avatar, AvatarSize } from 'im.v2.component.elements';\nimport { Type } from 'main.core';\nimport { LabelColor } from 'ui.label';\nimport '../../css/task/task-item.css';\nimport { Utils } from 'im.v2.lib.utils';\n\n// @vue/component\nexport const TaskItem = {\n\tname: 'TaskItem',\n\tcomponents: { Avatar, AvatarSize },\n\tprops: {\n\t\ttask: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['contextMenuClick'],\n\tdata() {\n\t\treturn {\n\t\t\tshowContextButton: false,\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tAvatarSize: () => AvatarSize,\n\t\ttaskItem(): ImModelSidebarTaskItem\n\t\t{\n\t\t\treturn this.task;\n\t\t},\n\t\ttaskTitle(): string\n\t\t{\n\t\t\treturn this.taskItem.task.title;\n\t\t},\n\t\ttaskAuthorDialogId(): string\n\t\t{\n\t\t\treturn this.taskItem.task.creatorId.toString();\n\t\t},\n\t\ttaskResponsibleDialogId(): string\n\t\t{\n\t\t\treturn this.taskItem.task.responsibleId.toString();\n\t\t},\n\t\ttaskDeadlineText(): string\n\t\t{\n\t\t\tconst statusToShow = Type.isStringFilled(this.taskItem.task.state)\n\t\t\t\t? this.taskItem.task.state\n\t\t\t\t: this.taskItem.task.statusTitle\n\t\t\t;\n\n\t\t\treturn Utils.text.convertHtmlEntities(statusToShow);\n\t\t},\n\t\ttaskBackgroundColorClass(): string\n\t\t{\n\t\t\tif (this.taskItem.task.status === 5)\n\t\t\t{\n\t\t\t\treturn '--completed';\n\t\t\t}\n\n\t\t\treturn '';\n\t\t},\n\t\tstatusColorClass(): string\n\t\t{\n\t\t\tif (!this.taskItem.task.color || !LabelColor[this.taskItem.task.color.toUpperCase()])\n\t\t\t{\n\t\t\t\treturn '';\n\t\t\t}\n\n\t\t\treturn `ui-label-${this.taskItem.task.color.toLowerCase()}`;\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tonTaskClick()\n\t\t{\n\t\t\tBX.SidePanel.Instance.open(this.taskItem.task.source, { cacheable: false });\n\t\t},\n\t\tonContextMenuClick(event)\n\t\t{\n\t\t\tthis.$emit('contextMenuClick', {\n\t\t\t\ttask: this.taskItem,\n\t\t\t\tsource: this.taskItem.task.source,\n\t\t\t\tmessageId: this.taskItem.messageId,\n\t\t\t}, event.currentTarget);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div \n\t\t\tclass=\"bx-im-sidebar-task-item__container bx-im-sidebar-task-item__scope\" \n\t\t\t:class=\"taskBackgroundColorClass\"\n\t\t\t@mouseover=\"showContextButton = true\"\n\t\t\t@mouseleave=\"showContextButton = false\"\n\t\t>\n\t\t\t<div class=\"bx-im-sidebar-task-item__content\" @click=\"onTaskClick\">\n\t\t\t\t<div class=\"bx-im-sidebar-task-item__header-text\" :title=\"taskTitle\">\n\t\t\t\t\t{{ taskTitle }}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"bx-im-sidebar-task-item__detail-container\">\n\t\t\t\t\t<Avatar :size=\"AvatarSize.XS\" :dialogId=\"taskAuthorDialogId\" />\n\t\t\t\t\t<div class=\"bx-im-sidebar-task-item__forward-small-icon bx-im-sidebar__forward-small-icon\"></div>\n\t\t\t\t\t<Avatar :size=\"AvatarSize.XS\" :dialogId=\"taskResponsibleDialogId\" />\n\t\t\t\t\t<div class=\"bx-im-sidebar-task-item__status-text\" :class=\"statusColorClass\">\n\t\t\t\t\t\t{{taskDeadlineText}}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<button \n\t\t\t\tv-if=\"showContextButton\"\n\t\t\t\tclass=\"bx-im-messenger__context-menu-icon\" \n\t\t\t\t@click=\"onContextMenuClick\"\n\t\t\t></button>\n\t\t</div>\n\t`,\n};\n","import {ImModelSidebarTaskItem, ImModelDialog} from 'im.v2.model';\nimport {EntityCreator} from 'im.v2.lib.entity-creator';\nimport {Button, ButtonColor, ButtonSize} from 'im.v2.component.elements';\nimport {SidebarBlock, SidebarDetailBlock} from 'im.v2.const';\nimport {TaskMenu} from '../../classes/context-menu/task/task-menu';\nimport {DetailEmptyState} from '../detail-empty-state';\nimport {TaskItem} from './task-item';\nimport '../../css/task/preview.css';\n\n// @vue/component\nexport const TaskPreview = {\n\tname: 'TaskPreview',\n\tcomponents: {DetailEmptyState, TaskItem, Button},\n\tprops: {\n\t\tisLoading: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false\n\t\t},\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true\n\t\t}\n\t},\n\temits: ['openDetail'],\n\tdata() {\n\t\treturn {\n\t\t\tshowAddButton: false\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tSidebarDetailBlock: () => SidebarDetailBlock,\n\t\tButtonSize: () => ButtonSize,\n\t\tButtonColor: () => ButtonColor,\n\t\tfirstTask(): ?ImModelSidebarTaskItem\n\t\t{\n\t\t\treturn this.$store.getters['sidebar/tasks/get'](this.chatId)[0];\n\t\t},\n\t\tdialog(): ImModelDialog\n\t\t{\n\t\t\treturn this.$store.getters['dialogues/get'](this.dialogId, true);\n\t\t},\n\t\tchatId(): number\n\t\t{\n\t\t\treturn this.dialog.chatId;\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tthis.contextMenu = new TaskMenu();\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.contextMenu.destroy();\n\t},\n\tmethods:\n\t{\n\t\tgetEntityCreator(): EntityCreator\n\t\t{\n\t\t\tif (!this.entityCreator)\n\t\t\t{\n\t\t\t\tthis.entityCreator = new EntityCreator(this.chatId);\n\t\t\t}\n\n\t\t\treturn this.entityCreator;\n\t\t},\n\t\tonAddClick()\n\t\t{\n\t\t\tthis.getEntityCreator().createTaskForChat();\n\t\t},\n\t\tonOpenDetail()\n\t\t{\n\t\t\tif (!this.firstTask)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.$emit('openDetail', {block: SidebarBlock.task, detailBlock: SidebarDetailBlock.task});\n\t\t},\n\t\tonContextMenuClick(event, target)\n\t\t{\n\t\t\tconst item = {\n\t\t\t\t...event,\n\t\t\t\tdialogId: this.dialogId\n\t\t\t};\n\n\t\t\tthis.contextMenu.openMenu(item, target);\n\t\t}\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-sidebar-task-preview__scope\">\n\t\t\t<div v-if=\"isLoading\" class=\"bx-im-sidebar-task-preview__skeleton\"></div>\n\t\t\t<div v-else class=\"bx-im-sidebar-task-preview__container\">\n\t\t\t\t<div \n\t\t\t\t\tclass=\"bx-im-sidebar-task-preview__header_container\"\n\t\t\t\t\t@mouseover=\"showAddButton = true\"\n\t\t\t\t\t@mouseleave=\"showAddButton = false\"\n\t\t\t\t\t:class=\"[firstTask ? '--active': '']\"\n\t\t\t\t\t@click=\"onOpenDetail\"\n\t\t\t\t>\n\t\t\t\t\t<div class=\"bx-im-sidebar-task-preview__title\">\n\t\t\t\t\t\t<span class=\"bx-im-sidebar-task-preview__title-text\">\n\t\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('IM_SIDEBAR_TASK_DETAIL_TITLE') }}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<div v-if=\"firstTask\" class=\"bx-im-sidebar__forward-icon\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<transition name=\"add-button\">\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tv-if=\"showAddButton\"\n\t\t\t\t\t\t\t:text=\"$Bitrix.Loc.getMessage('IM_SIDEBAR_ADD_BUTTON_TEXT')\"\n\t\t\t\t\t\t\t:size=\"ButtonSize.S\"\n\t\t\t\t\t\t\t:color=\"ButtonColor.PrimaryLight\"\n\t\t\t\t\t\t\t:isRounded=\"true\"\n\t\t\t\t\t\t\t:isUppercase=\"false\"\n\t\t\t\t\t\t\ticon=\"plus\"\n\t\t\t\t\t\t\t@click=\"onAddClick\"\n\t\t\t\t\t\t\tclass=\"bx-im-sidebar-task-preview__title-button\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</transition>\n\t\t\t\t</div>\n\t\t\t\t<TaskItem v-if=\"firstTask\" :task=\"firstTask\" @contextMenuClick=\"onContextMenuClick\"/>\n\t\t\t\t<DetailEmptyState \n\t\t\t\t\tv-else \n\t\t\t\t\t:title=\"$Bitrix.Loc.getMessage('IM_SIDEBAR_TASKS_EMPTY')\"\n\t\t\t\t\t:iconType=\"SidebarDetailBlock.task\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</div>\n\t`\n};","import type {ImModelSidebarTaskItem} from 'im.v2.model';\nimport {SidebarDetailBlock} from 'im.v2.const';\nimport {SidebarCollectionFormatter} from '../../classes/sidebar-collection-formatter';\nimport {TaskMenu} from '../../classes/context-menu/task/task-menu';\nimport {SidebarDetail} from '../detail';\nimport {DetailEmptyState} from '../detail-empty-state';\nimport {DateGroup} from '../date-group';\nimport {TaskItem} from './task-item';\nimport '../../css/task/detail.css';\n\n// @vue/component\nexport const TaskDetail = {\n\tname: 'TaskDetail',\n\tcomponents: {TaskItem, DateGroup, SidebarDetail, DetailEmptyState},\n\tprops: {\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true\n\t\t},\n\t\tchatId: {\n\t\t\ttype: Number,\n\t\t\trequired: true\n\t\t},\n\t\tservice: {\n\t\t\ttype: Object,\n\t\t\trequired: true\n\t\t}\n\t},\n\tcomputed:\n\t{\n\t\tSidebarDetailBlock: () => SidebarDetailBlock,\n\t\ttasks(): ImModelSidebarTaskItem[]\n\t\t{\n\t\t\treturn this.$store.getters['sidebar/tasks/get'](this.chatId);\n\t\t},\n\t\tformattedCollection(): Array\n\t\t{\n\t\t\treturn this.collectionFormatter.format(this.tasks);\n\t\t},\n\t\tisEmptyState(): boolean\n\t\t{\n\t\t\treturn this.formattedCollection.length === 0;\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tthis.collectionFormatter = new SidebarCollectionFormatter();\n\t\tthis.contextMenu = new TaskMenu();\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.collectionFormatter.destroy();\n\t\tthis.contextMenu.destroy();\n\t},\n\tmethods:\n\t{\n\t\tonScroll()\n\t\t{\n\t\t\tthis.contextMenu.destroy();\n\t\t},\n\t\tonContextMenuClick(event, target)\n\t\t{\n\t\t\tconst item = {\n\t\t\t\t...event,\n\t\t\t\tdialogId: this.dialogId\n\t\t\t};\n\n\t\t\tthis.contextMenu.openMenu(item, target);\n\t\t}\n\t},\n\ttemplate: `\n\t\t<SidebarDetail\n\t\t\t:dialogId=\"dialogId\"\n\t\t\t:chatId=\"chatId\"\n\t\t\t:service=\"service\"\n\t\t\t@scroll=\"onScroll\"\n\t\t\tv-slot=\"slotProps\"\n\t\t\tclass=\"bx-im-sidebar-task-detail__scope\"\n\t\t>\n\t\t\t<template v-for=\"dateGroup in formattedCollection\">\n\t\t\t\t<DateGroup :dateText=\"dateGroup.dateGroupTitle\" />\n\t\t\t\t<TaskItem\n\t\t\t\t\tv-for=\"task in dateGroup.items\"\n\t\t\t\t\t:task=\"task\"\n\t\t\t\t\t@contextMenuClick=\"onContextMenuClick\"\n\t\t\t\t/>\n\t\t\t</template>\n\t\t\t<DetailEmptyState\n\t\t\t\tv-if=\"!slotProps.isLoading && isEmptyState\"\n\t\t\t\t:title=\"$Bitrix.Loc.getMessage('IM_SIDEBAR_TASKS_EMPTY')\"\n\t\t\t\t:iconType=\"SidebarDetailBlock.task\"\n\t\t\t/>\n\t\t</SidebarDetail>\n\t`\n};","import {ImModelSidebarFileItem, ImModelFile} from 'im.v2.model';\nimport {Utils} from 'im.v2.lib.utils';\nimport {Avatar, AvatarSize, ChatTitle} from 'im.v2.component.elements';\nimport '../../css/brief/brief-item.css';\nimport 'ui.icons';\n\n// @vue/component\nexport const BriefItem = {\n\tname: 'BriefItem',\n\tcomponents: {Avatar, ChatTitle},\n\tprops: {\n\t\tbrief: {\n\t\t\ttype: Object,\n\t\t\trequired: true\n\t\t}\n\t},\n\temits: ['contextMenuClick'],\n\tdata() {\n\t\treturn {\n\t\t\tshowContextButton: false,\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tAvatarSize: () => AvatarSize,\n\t\tsidebarFileItem(): ImModelSidebarFileItem\n\t\t{\n\t\t\treturn this.brief;\n\t\t},\n\t\tfile(): ImModelFile\n\t\t{\n\t\t\treturn this.$store.getters['files/get'](this.sidebarFileItem.fileId, true);\n\t\t},\n\t\tfileShortName(): string\n\t\t{\n\t\t\tconst NAME_MAX_LENGTH = 21;\n\n\t\t\treturn Utils.file.getShortFileName(this.file.name, NAME_MAX_LENGTH);\n\t\t},\n\t\tfileSize(): string\n\t\t{\n\t\t\treturn Utils.file.formatFileSize(this.file.size);\n\t\t},\n\t\tviewerAttributes(): Object\n\t\t{\n\t\t\treturn Utils.file.getViewerDataAttributes(this.file.viewerAttrs);\n\t\t},\n\t\tisViewerAvailable(): boolean\n\t\t{\n\t\t\treturn Object.keys(this.viewerAttributes).length > 0;\n\t\t}\n\t},\n\tmethods:\n\t{\n\t\tdownload()\n\t\t{\n\t\t\tif (this.isViewerAvailable)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst urlToOpen = this.file.urlShow ? this.file.urlShow : this.file.urlDownload;\n\t\t\twindow.open(urlToOpen, '_blank');\n\t\t},\n\t\tonContextMenuClick(event)\n\t\t{\n\t\t\tthis.$emit('contextMenuClick', {\n\t\t\t\tsidebarFile: this.sidebarFileItem,\n\t\t\t\tfile: this.file,\n\t\t\t\tmessageId: this.sidebarFileItem.messageId,\n\t\t\t}, event.currentTarget);\n\t\t}\n\t},\n\ttemplate: `\n\t\t<div \n\t\t\tclass=\"bx-im-sidebar-brief-item__container bx-im-sidebar-brief-item__scope\"\n\t\t\t@mouseover=\"showContextButton = true\"\n\t\t\t@mouseleave=\"showContextButton = false\"\n\t\t>\n\t\t\t<div class=\"bx-im-sidebar-brief-item__icon-container\"></div>\n\t\t\t<div class=\"bx-im-sidebar-brief-item__content-container\">\n\t\t\t\t<div class=\"bx-im-sidebar-brief-item__content\">\n\t\t\t\t\t<div class=\"bx-im-sidebar-brief-item__title\" @click=\"download\" v-bind=\"viewerAttributes\">\n\t\t\t\t\t\t<span class=\"bx-im-sidebar-brief-item__title-text\" :title=\"file.name\">{{fileShortName}}</span>\n\t\t\t\t\t\t<span class=\"bx-im-sidebar-brief-item__size-text\">{{fileSize}}</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"bx-im-sidebar-brief-item__author-container\">\n\t\t\t\t\t\t<Avatar \n\t\t\t\t\t\t\t:dialogId=\"sidebarFileItem.authorId\" \n\t\t\t\t\t\t\t:size=\"AvatarSize.XS\" \n\t\t\t\t\t\t\t:withStatus=\"false\" \n\t\t\t\t\t\t\tclass=\"bx-im-sidebar-brief-item__author-avatar\" \n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<ChatTitle :dialogId=\"sidebarFileItem.authorId\" :showItsYou=\"false\" />\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<button\n\t\t\t\tv-if=\"showContextButton\"\n\t\t\t\tclass=\"bx-im-messenger__context-menu-icon bx-im-sidebar-brief-item__context-menu-button\"\n\t\t\t\t@click=\"onContextMenuClick\"\n\t\t\t></button>\n\t\t</div>\n\t`\n};","import {SidebarFileTypes, SidebarDetailBlock} from 'im.v2.const';\nimport type {ImModelSidebarFileItem} from 'im.v2.model';\nimport {SidebarCollectionFormatter} from '../../classes/sidebar-collection-formatter';\nimport {FileMenu} from '../../classes/context-menu/file/file-menu';\nimport {DateGroup} from '../date-group';\nimport {BriefItem} from './brief-item';\nimport {SidebarDetail} from '../detail';\nimport {DetailEmptyState} from '../detail-empty-state';\nimport '../../css/brief/detail.css';\n\n// @vue/component\nexport const BriefDetail = {\n\tname: 'BriefDetail',\n\tcomponents: {DateGroup, BriefItem, SidebarDetail, DetailEmptyState},\n\tprops: {\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true\n\t\t},\n\t\tchatId: {\n\t\t\ttype: Number,\n\t\t\trequired: true\n\t\t},\n\t\tservice: {\n\t\t\ttype: Object,\n\t\t\trequired: true\n\t\t}\n\t},\n\tcomputed:\n\t{\n\t\tSidebarDetailBlock: () => SidebarDetailBlock,\n\t\tfiles(): ImModelSidebarFileItem[]\n\t\t{\n\t\t\treturn this.$store.getters['sidebar/files/get'](this.chatId, SidebarFileTypes.brief);\n\t\t},\n\t\tformattedCollection(): Array\n\t\t{\n\t\t\treturn this.collectionFormatter.format(this.files);\n\t\t},\n\t\tisEmptyState(): boolean\n\t\t{\n\t\t\treturn this.formattedCollection.length === 0;\n\t\t}\n\t},\n\tcreated()\n\t{\n\t\tthis.collectionFormatter = new SidebarCollectionFormatter();\n\t\tthis.contextMenu = new FileMenu();\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.collectionFormatter.destroy();\n\t\tthis.contextMenu.destroy();\n\t},\n\tmethods:\n\t{\n\t\tonScroll()\n\t\t{\n\t\t\tthis.contextMenu.destroy();\n\t\t},\n\t\tonContextMenuClick(event, target)\n\t\t{\n\t\t\tconst item = {\n\t\t\t\t...event,\n\t\t\t\tdialogId: this.dialogId\n\t\t\t};\n\n\t\t\tthis.contextMenu.openMenu(item, target);\n\t\t}\n\t},\n\ttemplate: `\n\t\t<SidebarDetail\n\t\t\t:dialogId=\"dialogId\"\n\t\t\t:chatId=\"chatId\"\n\t\t\t:service=\"service\"\n\t\t\t@scroll=\"onScroll\"\n\t\t\tv-slot=\"slotProps\"\n\t\t\tclass=\"bx-im-sidebar-brief-detail__scope\"\n\t\t>\n\t\t\t<template v-for=\"dateGroup in formattedCollection\">\n\t\t\t\t<DateGroup :dateText=\"dateGroup.dateGroupTitle\"/>\n\t\t\t\t<BriefItem\n\t\t\t\t\tv-for=\"file in dateGroup.items\"\n\t\t\t\t\t:brief=\"file\"\n\t\t\t\t\t@contextMenuClick=\"onContextMenuClick\"\n\t\t\t\t/>\n\t\t\t</template>\n\t\t\t<DetailEmptyState\n\t\t\t\tv-if=\"!slotProps.isLoading && isEmptyState\"\n\t\t\t\t:title=\"$Bitrix.Loc.getMessage('IM_SIDEBAR_BRIEFS_EMPTY')\"\n\t\t\t\t:iconType=\"SidebarDetailBlock.brief\"\n\t\t\t/>\n\t\t</SidebarDetail>\n\t`\n};","import {SidebarBlock, SidebarDetailBlock, SidebarFileTypes} from 'im.v2.const';\nimport {FileMenu} from '../../classes/context-menu/file/file-menu';\nimport {DetailEmptyState} from '../detail-empty-state';\nimport {BriefItem} from './brief-item';\nimport '../../css/brief/preview.css';\n\nimport type {ImModelDialog, ImModelSidebarFileItem} from 'im.v2.model';\n\n// @vue/component\nexport const BriefPreview = {\n\tname: 'BriefPreview',\n\tcomponents: {DetailEmptyState, BriefItem},\n\tprops: {\n\t\tisLoading: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false\n\t\t},\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true\n\t\t}\n\t},\n\temits: ['openDetail'],\n\tdata() {\n\t\treturn {\n\t\t\tshowAddButton: false\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tSidebarDetailBlock: () => SidebarDetailBlock,\n\t\tdialog(): ImModelDialog\n\t\t{\n\t\t\treturn this.$store.getters['dialogues/get'](this.dialogId, true);\n\t\t},\n\t\tchatId(): number\n\t\t{\n\t\t\treturn this.dialog.chatId;\n\t\t},\n\t\tfirstBrief(): ?ImModelSidebarFileItem\n\t\t{\n\t\t\treturn this.$store.getters['sidebar/files/get'](this.chatId, SidebarFileTypes.brief)[0];\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tthis.contextMenu = new FileMenu();\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.contextMenu.destroy();\n\t},\n\tmethods:\n\t{\n\t\tonOpenDetail()\n\t\t{\n\t\t\tif (!this.firstBrief)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.$emit('openDetail', {block: SidebarBlock.brief, detailBlock: SidebarDetailBlock.brief});\n\t\t},\n\t\tonContextMenuClick(event, target)\n\t\t{\n\t\t\tconst item = {\n\t\t\t\t...event,\n\t\t\t\tdialogId: this.dialogId\n\t\t\t};\n\n\t\t\tthis.contextMenu.openMenu(item, target);\n\t\t}\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-sidebar-brief-preview__scope\">\n\t\t\t<div v-if=\"isLoading\" class=\"bx-im-sidebar-brief-preview__skeleton\"></div>\n\t\t\t<div v-else class=\"bx-im-sidebar-brief-preview__container\">\n\t\t\t\t<div \n\t\t\t\t\tclass=\"bx-im-sidebar-brief-preview__header_container\" \n\t\t\t\t\t:class=\"[firstBrief ? '--active': '']\" \n\t\t\t\t\t@click=\"onOpenDetail\"\n\t\t\t\t>\n\t\t\t\t\t<span class=\"bx-im-sidebar-brief-preview__title-text\">\n\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('IM_SIDEBAR_BRIEF_DETAIL_TITLE') }}\n\t\t\t\t\t</span>\n\t\t\t\t\t<div v-if=\"firstBrief\" class=\"bx-im-sidebar__forward-icon\"></div>\n\t\t\t\t</div>\n\t\t\t\t<BriefItem \n\t\t\t\t\tv-if=\"firstBrief\" \n\t\t\t\t\t:brief=\"firstBrief\"\n\t\t\t\t\t@contextMenuClick=\"onContextMenuClick\"\n\t\t\t\t/>\n\t\t\t\t<DetailEmptyState \n\t\t\t\t\tv-else \n\t\t\t\t\t:title=\"$Bitrix.Loc.getMessage('IM_SIDEBAR_BRIEFS_EMPTY')\"\n\t\t\t\t\t:iconType=\"SidebarDetailBlock.brief\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</div>\n\t`\n};","import {RestClient} from 'rest.client';\nimport {Store} from 'ui.vue3.vuex';\n\nimport {Core} from 'im.v2.application.core';\nimport {RestMethod} from 'im.v2.const';\n\nexport class MeetingManager\n{\n\tstore: Store;\n\trestClient: RestClient;\n\n\tconstructor()\n\t{\n\t\tthis.store = Core.getStore();\n\t\tthis.restClient = Core.getRestClient();\n\t}\n\n\tdelete({id, chatId})\n\t{\n\t\tthis.store.dispatch('sidebar/meetings/delete', {\n\t\t\tchatId: chatId,\n\t\t\tid: id\n\t\t});\n\n\t\tconst queryParams = {'LINK_ID': id};\n\t\tthis.restClient.callMethod(RestMethod.imChatCalendarDelete, queryParams).catch(error => {\n\t\t\tconsole.error('Im.Sidebar: error deleting meeting', error);\n\t\t});\n\t}\n}","import 'ui.notification';\nimport type {MenuItem} from 'im.v2.lib.menu';\nimport {SidebarMenu} from '../sidebar-base-menu';\nimport {MeetingManager} from './meeting-manager';\nimport type {ImModelSidebarMeetingItem} from 'im.v2.model';\nimport {Loc} from 'main.core';\n\ntype MeetingMenuContext = {\n\tmeeting: ImModelSidebarMeetingItem,\n\tmessageId: number,\n\tdialogId: string,\n\tsource: string,\n}\n\nexport class MeetingMenu extends SidebarMenu\n{\n\tcontext: MeetingMenuContext;\n\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis.id = 'im-sidebar-context-menu';\n\t\tthis.meetingManager = new MeetingManager();\n\t}\n\n\tgetMenuItems(): MenuItem[]\n\t{\n\t\treturn [\n\t\t\tthis.getOpenContextMessageItem(),\n\t\t\tthis.getCopyLinkItem(Loc.getMessage('IM_SIDEBAR_MENU_COPY_MEETING_LINK')),\n\t\t\tthis.getDeleteItem(),\n\t\t];\n\t}\n\n\tgetDeleteItem(): MenuItem\n\t{\n\t\treturn {\n\t\t\ttext: Loc.getMessage('IM_SIDEBAR_MENU_DELETE_MEETING_CONNECTION'),\n\t\t\tonclick: function() {\n\t\t\t\tthis.meetingManager.delete(this.context.meeting);\n\t\t\t\tthis.menuInstance.close();\n\t\t\t}.bind(this)\n\t\t};\n\t}\n}","import { DateTimeFormat } from 'main.date';\n\nimport { DateFormatter, DateTemplate } from 'im.v2.lib.date-formatter';\n\nimport '../../css/meeting/meeting-item.css';\n\nimport type { ImModelSidebarMeetingItem } from 'im.v2.model';\n\n// @vue/component\nexport const MeetingItem = {\n\tname: 'MeetingItem',\n\tprops: {\n\t\tmeeting: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['contextMenuClick'],\n\tdata() {\n\t\treturn {\n\t\t\tshowContextButton: false,\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tmeetingItem(): ImModelSidebarMeetingItem\n\t\t{\n\t\t\treturn this.meeting;\n\t\t},\n\t\ttitle(): string\n\t\t{\n\t\t\treturn this.meetingItem.meeting.title;\n\t\t},\n\t\tdate(): string\n\t\t{\n\t\t\tconst meetingDate = this.meetingItem.meeting.dateFrom;\n\n\t\t\treturn DateFormatter.formatByTemplate(meetingDate, DateTemplate.meeting);\n\t\t},\n\t\tday(): string\n\t\t{\n\t\t\treturn this.meetingItem.meeting.dateFrom.getDate().toString();\n\t\t},\n\t\tmonthShort(): string\n\t\t{\n\t\t\treturn DateTimeFormat.format('M', this.meetingItem.meeting.dateFrom);\n\t\t},\n\t\tisActive(): boolean\n\t\t{\n\t\t\treturn this.meetingItem.meeting.dateFrom.getTime() > Date.now();\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tonMeetingClick()\n\t\t{\n\t\t\t// todo replace this call to something\n\t\t\tnew (window.top.BX || window.BX).Calendar.SliderLoader(this.meetingItem.meeting.id).show();\n\t\t},\n\t\tonContextMenuClick(event)\n\t\t{\n\t\t\tthis.$emit('contextMenuClick', {\n\t\t\t\tmeeting: this.meetingItem,\n\t\t\t\tsource: this.meetingItem.meeting.source,\n\t\t\t\tmessageId: this.meetingItem.messageId,\n\t\t\t}, event.currentTarget);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div \n\t\t\tclass=\"bx-im-sidebar-meeting-item__container bx-im-sidebar-meeting-item__scope\"\n\t\t\t@mouseover=\"showContextButton = true\"\n\t\t\t@mouseleave=\"showContextButton = false\"\n\t\t>\n\t\t\t<div \n\t\t\t\tclass=\"bx-im-sidebar-meeting-item__icon-container\"\n\t\t\t\t:class=\"[isActive ? '--active' : '--inactive']\"\n\t\t\t>\n\t\t\t\t<div class=\"bx-im-sidebar-meeting-item__day-text\">{{ day }}</div>\n\t\t\t\t<div class=\"bx-im-sidebar-meeting-item__month-text\">{{ monthShort }}</div>\n\t\t\t</div>\n\t\t\t<div class=\"bx-im-sidebar-meeting-item__content-container\" @click=\"onMeetingClick\">\n\t\t\t\t<div class=\"bx-im-sidebar-meeting-item__content\">\n\t\t\t\t\t<div class=\"bx-im-sidebar-meeting-item__title\" :title=\"title\">{{ title }}</div>\n\t\t\t\t\t<div class=\"bx-im-sidebar-meeting-item__date\">{{ date }}</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<button \n\t\t\t\tv-if=\"showContextButton\"\n\t\t\t\tclass=\"bx-im-messenger__context-menu-icon\" \n\t\t\t\t@click=\"onContextMenuClick\"\n\t\t\t></button>\n\t\t</div>\n\t`,\n};\n","import {ImModelSidebarMeetingItem, ImModelDialog} from 'im.v2.model';\nimport {Button, ButtonColor, ButtonSize} from 'im.v2.component.elements';\nimport {SidebarBlock, SidebarDetailBlock} from 'im.v2.const';\nimport {EntityCreator} from 'im.v2.lib.entity-creator';\nimport {MeetingMenu} from '../../classes/context-menu/meeting/meeting-menu';\nimport {DetailEmptyState} from '../detail-empty-state';\nimport {MeetingItem} from './meeting-item';\nimport '../../css/meeting/preview.css';\n\n// @vue/component\nexport const MeetingPreview = {\n\tname: 'MeetingPreview',\n\tcomponents: {MeetingItem, DetailEmptyState, Button},\n\tprops: {\n\t\tisLoading: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false\n\t\t},\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true\n\t\t}\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tshowAddButton: false,\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tSidebarDetailBlock: () => SidebarDetailBlock,\n\t\tButtonSize: () => ButtonSize,\n\t\tButtonColor: () => ButtonColor,\n\t\tfirstMeeting(): ?ImModelSidebarMeetingItem\n\t\t{\n\t\t\treturn this.$store.getters['sidebar/meetings/get'](this.chatId)[0];\n\t\t},\n\t\tdialog(): ImModelDialog\n\t\t{\n\t\t\treturn this.$store.getters['dialogues/get'](this.dialogId, true);\n\t\t},\n\t\tchatId(): number\n\t\t{\n\t\t\treturn this.dialog.chatId;\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tthis.contextMenu = new MeetingMenu();\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.contextMenu.destroy();\n\t},\n\tmethods:\n\t{\n\t\tgetEntityCreator(): EntityCreator\n\t\t{\n\t\t\tif (!this.entityCreator)\n\t\t\t{\n\t\t\t\tthis.entityCreator = new EntityCreator(this.chatId);\n\t\t\t}\n\n\t\t\treturn this.entityCreator;\n\t\t},\n\t\tonAddClick()\n\t\t{\n\t\t\tthis.getEntityCreator().createMeetingForChat();\n\t\t},\n\t\tonOpenDetail()\n\t\t{\n\t\t\tif (!this.firstMeeting)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.$emit('openDetail', {block: SidebarBlock.meeting, detailBlock: SidebarDetailBlock.meeting});\n\t\t},\n\t\tonContextMenuClick(event, target)\n\t\t{\n\t\t\tconst item = {\n\t\t\t\t...event,\n\t\t\t\tdialogId: this.dialogId\n\t\t\t};\n\n\t\t\tthis.contextMenu.openMenu(item, target);\n\t\t}\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-sidebar-meeting-preview__scope\">\n\t\t\t<div v-if=\"isLoading\" class=\"bx-im-sidebar-meeting-preview__skeleton\"></div>\n\t\t\t<div v-else class=\"bx-im-sidebar-meeting-preview__container\">\n\t\t\t\t<div\n\t\t\t\t\tclass=\"bx-im-sidebar-meeting-preview__header_container\"\n\t\t\t\t\t@mouseover=\"showAddButton = true\"\n\t\t\t\t\t@mouseleave=\"showAddButton = false\"\n\t\t\t\t\t:class=\"[firstMeeting ? '--active': '']\"\n\t\t\t\t\t@click=\"onOpenDetail\"\n\t\t\t\t>\n\t\t\t\t\t<div class=\"bx-im-sidebar-meeting-preview__title\">\n\t\t\t\t\t\t<span class=\"bx-im-sidebar-meeting-preview__title-text\">\n\t\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('IM_SIDEBAR_MEETING_DETAIL_TITLE') }}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<div v-if=\"firstMeeting\" class=\"bx-im-sidebar__forward-icon\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<transition name=\"add-button\">\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tv-if=\"showAddButton\"\n\t\t\t\t\t\t\t:text=\"$Bitrix.Loc.getMessage('IM_SIDEBAR_ADD_BUTTON_TEXT')\"\n\t\t\t\t\t\t\t:size=\"ButtonSize.S\"\n\t\t\t\t\t\t\t:color=\"ButtonColor.PrimaryLight\"\n\t\t\t\t\t\t\t:isRounded=\"true\"\n\t\t\t\t\t\t\t:isUppercase=\"false\"\n\t\t\t\t\t\t\ticon=\"plus\"\n\t\t\t\t\t\t\t@click=\"onAddClick\"\n\t\t\t\t\t\t\tclass=\"bx-im-sidebar-meeting-preview__title-button\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</transition>\n\t\t\t\t</div>\n\t\t\t\t<MeetingItem v-if=\"firstMeeting\" :meeting=\"firstMeeting\" @contextMenuClick=\"onContextMenuClick\"/>\n\t\t\t\t<DetailEmptyState\n\t\t\t\t\tv-else\n\t\t\t\t\t:title=\"$Bitrix.Loc.getMessage('IM_SIDEBAR_MEETINGS_EMPTY')\"\n\t\t\t\t\t:iconType=\"SidebarDetailBlock.meeting\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</div>\n\t`\n};","import type {ImModelSidebarTaskItem} from 'im.v2.model';\nimport {SidebarDetailBlock} from 'im.v2.const';\nimport {SidebarCollectionFormatter} from '../../classes/sidebar-collection-formatter';\nimport {MeetingMenu} from '../../classes/context-menu/meeting/meeting-menu';\nimport {SidebarDetail} from '../detail';\nimport {DateGroup} from '../date-group';\nimport {MeetingItem} from './meeting-item';\nimport {DetailEmptyState} from '../detail-empty-state';\nimport '../../css/meeting/detail.css';\n\n// @vue/component\nexport const MeetingDetail = {\n\tname: 'MeetingDetail',\n\tcomponents: {MeetingItem, DateGroup, SidebarDetail, DetailEmptyState},\n\tprops: {\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true\n\t\t},\n\t\tchatId: {\n\t\t\ttype: Number,\n\t\t\trequired: true\n\t\t},\n\t\tservice: {\n\t\t\ttype: Object,\n\t\t\trequired: true\n\t\t}\n\t},\n\tcomputed:\n\t{\n\t\tSidebarDetailBlock: () => SidebarDetailBlock,\n\t\tmeetings(): ImModelSidebarTaskItem[]\n\t\t{\n\t\t\treturn this.$store.getters['sidebar/meetings/get'](this.chatId);\n\t\t},\n\t\tformattedCollection(): Array\n\t\t{\n\t\t\treturn this.collectionFormatter.format(this.meetings);\n\t\t},\n\t\tisEmptyState(): boolean\n\t\t{\n\t\t\treturn this.formattedCollection.length === 0;\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tthis.collectionFormatter = new SidebarCollectionFormatter();\n\t\tthis.contextMenu = new MeetingMenu();\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.collectionFormatter.destroy();\n\t\tthis.contextMenu.destroy();\n\t},\n\tmethods:\n\t{\n\t\tonScroll()\n\t\t{\n\t\t\tthis.contextMenu.destroy();\n\t\t},\n\t\tonContextMenuClick(event, target)\n\t\t{\n\t\t\tconst item = {\n\t\t\t\t...event,\n\t\t\t\tdialogId: this.dialogId\n\t\t\t};\n\n\t\t\tthis.contextMenu.openMenu(item, target);\n\t\t}\n\t},\n\ttemplate: `\n\t\t<SidebarDetail\n\t\t\t:dialogId=\"dialogId\"\n\t\t\t:chatId=\"chatId\"\n\t\t\t:service=\"service\"\n\t\t\t@scroll=\"onScroll\"\n\t\t\tv-slot=\"slotProps\"\n\t\t\tclass=\"bx-im-sidebar-meeting-detail__scope\"\n\t\t>\n\t\t\t<template v-for=\"dateGroup in formattedCollection\">\n\t\t\t\t<DateGroup :dateText=\"dateGroup.dateGroupTitle\" />\n\t\t\t\t<MeetingItem\n\t\t\t\t\tv-for=\"meeting in dateGroup.items\"\n\t\t\t\t\t:meeting=\"meeting\"\n\t\t\t\t\t@contextMenuClick=\"onContextMenuClick\"\n\t\t\t\t/>\n\t\t\t</template>\n\t\t\t<DetailEmptyState\n\t\t\t\tv-if=\"!slotProps.isLoading && isEmptyState\"\n\t\t\t\t:title=\"$Bitrix.Loc.getMessage('IM_SIDEBAR_MEETINGS_EMPTY')\"\n\t\t\t\t:iconType=\"SidebarDetailBlock.meeting\"\n\t\t\t/>\n\t\t</SidebarDetail>\n\t`\n};","import '../../css/sign/preview.css';\n\n// @vue/component\nexport const SignPreview = {\n\tprops: {\n\t\tisLoading: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false\n\t\t}\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-sidebar-sign-preview__scope\">\n\t\t\t<div v-if=\"isLoading\" class=\"bx-im-sidebar-sign-preview__skeleton\"></div>\n\t\t\t<div v-else class=\"bx-im-sidebar-sign-preview__container\" >\n\t\t\t\tSigned documents. Work in progress\n\t\t\t</div>\n\t\t</div>\n\t`\n};","// @vue/component\nexport const SignDetail = {\n\temits: ['back'],\n\tdata() {\n\t\treturn {};\n\t},\n\ttemplate: `\n\t\t<div>\n\t\t<div @click=\"$emit('back')\" style=\"margin-bottom: 20px; cursor: pointer\">&lt;- Back</div>\n\t\t\t<div v-for=\"i in 50\">Sign {{ i }}</div>\n\t\t</div>\n\t`\n};","import '../../css/market/market-preview-item.css';\n\nimport type {ImModelMarketApplication} from 'im.v2.model';\n\n// @vue/component\nexport const MarketPreviewItem = {\n\tname: 'MarketPreviewItem',\n\tprops: {\n\t\titem: {\n\t\t\ttype: Object,\n\t\t\trequired: true\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tmarketItem(): ImModelMarketApplication\n\t\t{\n\t\t\treturn this.item;\n\t\t},\n\t\ticonClass(): string\n\t\t{\n\t\t\treturn `fa ${this.marketItem.options.iconName}`;\n\t\t},\n\t\ticonColor(): string\n\t\t{\n\t\t\treturn this.marketItem.options.color;\n\t\t}\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-sidebar-market-preview-item__container bx-im-sidebar-market-preview-item__scope\">\n\t\t\t<div class=\"bx-im-sidebar-market-preview-item__icon-container\" :style=\"{backgroundColor: iconColor}\">\n\t\t\t\t<i :class=\"iconClass\" aria-hidden=\"true\"></i>\n\t\t\t</div>\n\t\t\t<div class=\"bx-im-sidebar-market-preview-item__title-container\" :title=\"marketItem.title\">\n\t\t\t\t{{ marketItem.title }}\n\t\t\t</div>\n\t\t</div>\n\t`\n};","import {PlacementType, SidebarBlock, SidebarDetailBlock} from 'im.v2.const';\n\nimport {MarketPreviewItem} from './market-preview-item';\n\nimport '../../css/market/market-preview.css';\n\nimport type {ImModelMarketApplication} from 'im.v2.model';\nimport {MarketManager} from 'im.v2.lib.market';\n\n// @vue/component\nexport const MarketPreview = {\n\tname: 'MarketPreview',\n\tcomponents: {MarketPreviewItem},\n\tprops: {\n\t\tisLoading: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false\n\t\t},\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true\n\t\t}\n\t},\n\temits: ['openDetail'],\n\tcomputed:\n\t{\n\t\tmarketMenuItems(): ImModelMarketApplication[]\n\t\t{\n\t\t\treturn MarketManager.getInstance().getAvailablePlacementsByType(PlacementType.sidebar, this.dialogId);\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tonMarketItemClick(entityId)\n\t\t{\n\t\t\tthis.$emit('openDetail', {\n\t\t\t\tblock: SidebarBlock.meeting,\n\t\t\t\tdetailBlock: SidebarDetailBlock.market,\n\t\t\t\tentityId: entityId,\n\t\t\t});\n\t\t}\n\t},\n\ttemplate: `\n\t\t<div v-if=\"!isLoading\" class=\"bx-im-sidebar-market-preview__scope bx-im-sidebar-market-preview__container\">\n\t\t\t<div class=\"bx-im-sidebar-market-preview__header_container\">\n\t\t\t\t<div class=\"bx-im-sidebar-market-preview__title\">\n\t\t\t\t\t<span class=\"bx-im-sidebar-market-preview__title-text\">\n\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('IM_SIDEBAR_MARKET_DETAIL_TITLE') }}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<MarketPreviewItem \n\t\t\t\tv-for=\"item in marketMenuItems\" \n\t\t\t\t:key=\"item.id\"\n\t\t\t\t:item=\"item\"\n\t\t\t\t@click=\"onMarketItemClick(item.id)\"\n\t\t\t/>\n\t\t</div>\n\t`\n};","import {Runtime} from 'main.core';\n\nimport {MarketManager} from 'im.v2.lib.market';\nimport {Spinner, SpinnerSize} from 'im.v2.component.elements';\n\nimport '../../css/market/detail.css';\n\n// @vue/component\nexport const MarketDetail = {\n\tname: 'MarketDetail',\n\tcomponents: {Spinner},\n\tprops: {\n\t\tdetailBlockEntityId: {\n\t\t\ttype: String,\n\t\t\trequired: true\n\t\t},\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true\n\t\t}\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tisLoading: true\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tSpinnerSize: () => SpinnerSize\n\t},\n\tcreated()\n\t{\n\t\tthis.marketManager = MarketManager.getInstance();\n\t},\n\tmounted()\n\t{\n\t\tconst context = {dialogId: this.dialogId};\n\t\tthis.marketManager.loadPlacement(this.detailBlockEntityId, context).then(response => {\n\t\t\tthis.isLoading = false;\n\t\t\tRuntime.html(this.$refs['im-messenger-sidebar-placement'], response);\n\t\t});\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-sidebar-market-detail__container\">\n\t\t\t<div v-if=\"isLoading\" class=\"bx-im-sidebar-market-detail__loader-container\">\n\t\t\t\t<Spinner :size=\"SpinnerSize.S\" />\n\t\t\t</div>\n\t\t\t<div ref=\"im-messenger-sidebar-placement\"></div>\n\t\t</div>\n\t\t\n\t`\n};","import {Loc} from 'main.core';\nimport {RecentMenu} from 'im.v2.lib.menu';\nimport {Utils} from 'im.v2.lib.utils';\nimport {ChatOption, DialogType} from 'im.v2.const';\n\nimport type {MenuItem} from 'im.v2.lib.menu';\nimport type {ImModelRecentItem} from 'im.v2.model';\n\nexport class MainMenu extends RecentMenu\n{\n\tstatic events = {\n\t\tonAddToChatShow: 'onAddToChatShow',\n\t};\n\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis.id = 'im-sidebar-context-menu';\n\t}\n\n\tgetMenuOptions(): Object\n\t{\n\t\treturn {\n\t\t\t...super.getMenuOptions(),\n\t\t\tclassName: this.getMenuClassName(),\n\t\t\tangle: false,\n\t\t};\n\t}\n\n\tgetMenuItems(): MenuItem[]\n\t{\n\t\treturn [\n\t\t\tthis.getUnreadMessageItem(),\n\t\t\tthis.getPinMessageItem(),\n\t\t\tthis.getCallItem(),\n\t\t\tthis.getOpenProfileItem(),\n\t\t\tthis.getOpenUserCalendarItem(),\n\t\t\tthis.getAddMembersToChatItem(),\n\t\t\tthis.getHideItem(),\n\t\t\tthis.getLeaveItem(),\n\t\t];\n\t}\n\n\tgetOpenUserCalendarItem(): ?MenuItem\n\t{\n\t\tconst isUser = this.store.getters['dialogues/isUser'](this.context.dialogId);\n\t\tif (!isUser)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\t\tconst user = this.store.getters['users/get'](this.context.dialogId, true);\n\t\tif (user.bot)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst profileUri = Utils.user.getCalendarLink(this.context.dialogId);\n\n\t\treturn {\n\t\t\ttext: Loc.getMessage('IM_LIB_MENU_OPEN_CALENDAR'),\n\t\t\tonclick: () => {\n\t\t\t\tBX.SidePanel.Instance.open(profileUri);\n\t\t\t\tthis.menuInstance.close();\n\t\t\t}\n\t\t};\n\t}\n\n\tgetAddMembersToChatItem(): MenuItem\n\t{\n\t\tconst dialog = this.store.getters['dialogues/get'](this.context.dialogId, true);\n\t\tconst canInviteMembers = this.store.getters['dialogues/getChatOption'](dialog.type, ChatOption.extend);\n\t\tif (!canInviteMembers)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\ttext: Loc.getMessage('IM_SIDEBAR_MENU_INVITE_MEMBERS'),\n\t\t\tonclick: () => {\n\t\t\t\tthis.emit(MainMenu.events.onAddToChatShow);\n\t\t\t\tthis.menuInstance.close();\n\t\t\t}\n\t\t};\n\t}\n\n\tgetJoinChatItem(): ?MenuItem\n\t{\n\t\tconst dialog = this.store.getters['dialogues/get'](this.context.dialogId);\n\t\tconst isUser = dialog.type === DialogType.user;\n\t\tif (isUser)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\t//todo: check if user is in chat already\n\n\t\treturn {\n\t\t\ttext: Loc.getMessage('IM_SIDEBAR_MENU_JOIN_CHAT'),\n\t\t\tonclick: () => {\n\t\t\t\tconsole.warn('sidebar menu: join chat is not implemented');\n\t\t\t\tthis.menuInstance.close();\n\t\t\t}\n\t\t};\n\t}\n\n\tcanShowFullMenu(dialogId: string): boolean\n\t{\n\t\tconst recentItem: ImModelRecentItem = this.store.getters['recent/get'](dialogId);\n\n\t\treturn Boolean(recentItem);\n\t}\n}","import {EventEmitter} from 'main.core.events';\nimport {EventType} from 'im.v2.const';\nimport {AddToChat} from 'im.v2.component.entity-selector';\nimport {MainMenu} from '../classes/context-menu/main/main-menu';\nimport '../css/header.css';\n\nimport type {ImModelRecentItem} from 'im.v2.model';\n\n// @vue/component\nexport const SidebarHeader = {\n\tname: 'SidebarHeader',\n\tcomponents: {AddToChat},\n\tprops: {\n\t\tisLoading: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false\n\t\t},\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true\n\t\t},\n\t\tchatId: {\n\t\t\ttype: Number,\n\t\t\trequired: true\n\t\t}\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tshowAddToChatPopup: false\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\trecentItem(): ImModelRecentItem\n\t\t{\n\t\t\treturn this.$store.getters['recent/get'](this.dialogId, true);\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tthis.contextMenu = new MainMenu();\n\t\tthis.contextMenu.subscribe(MainMenu.events.onAddToChatShow, this.onAddChatShow);\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.contextMenu.destroy();\n\t\tthis.contextMenu.unsubscribe(MainMenu.events.onAddToChatShow, this.onAddChatShow);\n\t},\n\tmethods:\n\t{\n\t\tonAddChatShow()\n\t\t{\n\t\t\tthis.showAddToChatPopup = true;\n\t\t},\n\t\tonContextMenuClick(event)\n\t\t{\n\t\t\tconst item = {\n\t\t\t\tdialogId: this.dialogId,\n\t\t\t\t...this.recentItem\n\t\t\t};\n\n\t\t\tthis.contextMenu.openMenu(item, event.target);\n\t\t},\n\t\tonSidebarCloseClick()\n\t\t{\n\t\t\tEventEmitter.emit(EventType.sidebar.close);\n\t\t}\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-sidebar-header__container bx-im-sidebar-header__scope\">\n\t\t\t<div class=\"bx-im-sidebar-header__title-container\">\n\t\t\t\t<button \n\t\t\t\t\tclass=\"bx-im-sidebar-header__cross-icon bx-im-messenger__cross-icon\" \n\t\t\t\t\t@click=\"onSidebarCloseClick\"\n\t\t\t\t></button>\n\t\t\t\t<div class=\"bx-im-sidebar-header__title\">{{ $Bitrix.Loc.getMessage('IM_SIDEBAR_HEADER_TITLE') }}</div>\n\t\t\t</div>\n\t\t\t<button\n\t\t\t\tclass=\"bx-im-sidebar-header__context-menu-icon bx-im-messenger__context-menu-icon\"\n\t\t\t\t@click=\"onContextMenuClick\"\n\t\t\t\tref=\"context-menu\"\n\t\t\t></button>\n\t\t\t<AddToChat\n\t\t\t\t:bindElement=\"$refs['context-menu'] || {}\"\n\t\t\t\t:chatId=\"chatId\"\n\t\t\t\t:dialogId=\"dialogId\"\n\t\t\t\t:showPopup=\"showAddToChatPopup\"\n\t\t\t\t:popupConfig=\"{offsetTop: 0, offsetLeft: -420}\"\n\t\t\t\t@close=\"showAddToChatPopup = false\"\n\t\t\t/>\n\t\t</div>\n\t`\n};","import {Button as ChatButton, ButtonSize, ButtonColor} from 'im.v2.component.elements';\nimport {SidebarDetailBlock, SidebarFileTabTypes, ChatOption} from 'im.v2.const';\nimport {EntityCreator} from 'im.v2.lib.entity-creator';\nimport '../css/detail-header.css';\nimport type {ImModelDialog} from 'im.v2.model';\nimport {AddToChat} from 'im.v2.component.entity-selector';\n\n// @vue/component\nexport const DetailHeader = {\n\tname: 'DetailHeader',\n\tcomponents: {ChatButton, AddToChat},\n\tprops: {\n\t\tdetailBlock: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true\n\t\t},\n\t\tchatId: {\n\t\t\ttype: Number,\n\t\t\trequired: true\n\t\t},\n\t},\n\temits: ['back'],\n\tdata() {\n\t\treturn {\n\t\t\tshowAddToChatPopup: false\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tButtonSize: () => ButtonSize,\n\t\tButtonColor: () => ButtonColor,\n\t\tneedAddButton(): boolean\n\t\t{\n\t\t\tconst detailsWithAddButton = [\n\t\t\t\tSidebarDetailBlock.main,\n\t\t\t\tSidebarDetailBlock.task,\n\t\t\t\tSidebarDetailBlock.meeting\n\t\t\t];\n\n\t\t\tif (this.detailBlock === SidebarDetailBlock.main)\n\t\t\t{\n\t\t\t\treturn this.$store.getters['dialogues/getChatOption'](this.dialog.type, ChatOption.extend);\n\t\t\t}\n\n\t\t\treturn detailsWithAddButton.includes(this.detailBlock);\n\t\t},\n\t\tdialog(): ImModelDialog\n\t\t{\n\t\t\treturn this.$store.getters['dialogues/get'](this.dialogId, true);\n\t\t},\n\t\ttitle(): string\n\t\t{\n\t\t\tif (this.detailBlock === SidebarDetailBlock.main)\n\t\t\t{\n\t\t\t\tlet usersInChatCount = this.dialog.userCounter;\n\t\t\t\tif (usersInChatCount >= 1000)\n\t\t\t\t{\n\t\t\t\t\tusersInChatCount = `${Math.floor(usersInChatCount / 1000)}k`;\n\t\t\t\t}\n\n\t\t\t\treturn this.$Bitrix.Loc.getMessage('IM_SIDEBAR_MAIN_DETAIL_TITLE').replace('#NUMBER#', usersInChatCount);\n\t\t\t}\n\n\t\t\tif (Object.values(SidebarFileTabTypes).includes(this.detailBlock))\n\t\t\t{\n\t\t\t\treturn this.$Bitrix.Loc.getMessage('IM_SIDEBAR_MEDIA_DETAIL_TITLE');\n\t\t\t}\n\n\t\t\tconst phrase = `IM_SIDEBAR_${this.detailBlock.toUpperCase()}_DETAIL_TITLE`;\n\n\t\t\treturn this.$Bitrix.Loc.getMessage(phrase);\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tthis.entityCreator = new EntityCreator(this.chatId);\n\t},\n\tmethods:\n\t{\n\t\tonSearchClick()\n\t\t{\n\t\t\tconsole.warn('onSearchClick');\n\t\t},\n\t\tonAddClick()\n\t\t{\n\t\t\tif (!this.needAddButton)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tswitch (this.detailBlock)\n\t\t\t{\n\t\t\t\tcase SidebarDetailBlock.meeting:\n\t\t\t\t{\n\t\t\t\t\tthis.entityCreator.createMeetingForChat();\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tcase SidebarDetailBlock.task:\n\t\t\t\t{\n\t\t\t\t\tthis.entityCreator.createTaskForChat();\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tcase SidebarDetailBlock.main:\n\t\t\t\t{\n\t\t\t\t\tthis.showAddToChatPopup = true;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tdefault:\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-sidebar-detail-header__container bx-im-sidebar-detail-header__scope\">\n\t\t\t<div class=\"bx-im-sidebar-detail-header__title-container\">\n\t\t\t\t<button class=\"bx-im-sidebar__back-icon\" @click=\"$emit('back')\"></button>\n\t\t\t\t<div class=\"bx-im-sidebar-detail-header__title-text\">{{ title }}</div>\n\t\t\t\t<div class=\"bx-im-sidebar-detail-header__add-button\" ref=\"add-members\">\n\t\t\t\t\t<ChatButton\n\t\t\t\t\t\tv-if=\"needAddButton\"\n\t\t\t\t\t\t:text=\"$Bitrix.Loc.getMessage('IM_SIDEBAR_ADD_BUTTON_TEXT')\"\n\t\t\t\t\t\t:size=\"ButtonSize.S\"\n\t\t\t\t\t\t:color=\"ButtonColor.PrimaryLight\"\n\t\t\t\t\t\t:isRounded=\"true\"\n\t\t\t\t\t\t:isUppercase=\"false\"\n\t\t\t\t\t\ticon=\"plus\"\n\t\t\t\t\t\t@click=\"onAddClick\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t\n\t\t\t</div>\n<!--\t\t\t<button-->\n<!--\t\t\t\tclass=\"bx-im-sidebar-detail-header__search-button bx-im-sidebar__search-icon\"-->\n<!--\t\t\t\t@click=\"onSearchClick\"-->\n<!--\t\t\t>-->\n<!--\t\t\t</button>-->\n\t\t\t<AddToChat\n\t\t\t\t:bindElement=\"$refs['add-members'] || {}\"\n\t\t\t\t:chatId=\"chatId\"\n\t\t\t\t:dialogId=\"dialogId\"\n\t\t\t\t:showPopup=\"showAddToChatPopup\"\n\t\t\t\t:popupConfig=\"{offsetTop: 15, offsetLeft: -300}\"\n\t\t\t\t@close=\"showAddToChatPopup = false\"\n\t\t\t/>\n\t\t</div>\n\t`\n};","import {Dom} from 'main.core';\nimport '../css/detail-tabs.css';\n\nconst ARROW_CONTROL_SIZE = 50;\n\n// @vue/component\nexport const DetailTabs = {\n\tname: 'DetailTabs',\n\tprops: {\n\t\ttabs: {\n\t\t\ttype: Array,\n\t\t\tdefault: () => []\n\t\t},\n\t},\n\tdata() {\n\t\treturn {\n\t\t\thasLeftControl: false,\n\t\t\thasRightControl: false,\n\t\t\tcurrentElementIndex: 0,\n\t\t\thighlightOffsetLeft: 0,\n\t\t\thighlightWidth: 0,\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\thighlightStyle()\n\t\t{\n\t\t\treturn {\n\t\t\t\tleft: `${this.highlightOffsetLeft}px`,\n\t\t\t\twidth: `${this.highlightWidth}px`\n\t\t\t};\n\t\t},\n\n\t},\n\twatch:\n\t{\n\t\tcurrentElementIndex(newIndex: number)\n\t\t{\n\t\t\tthis.updateHighlightPosition(newIndex);\n\t\t\tthis.$emit('tabSelect', this.tabs[newIndex]);\n\t\t\tthis.scrollToElement(newIndex);\n\t\t}\n\t},\n\tmounted()\n\t{\n\t\tif (this.$refs.tabs.scrollWidth > this.$refs.tabs.offsetWidth)\n\t\t{\n\t\t\tthis.hasRightControl = true;\n\t\t}\n\n\t\tthis.updateHighlightPosition(this.currentElementIndex);\n\t},\n\tmethods:\n\t{\n\t\tgetElementNodeByIndex(index: number): HTMLElement\n\t\t{\n\t\t\treturn [...this.$refs.tabs.children].filter(node => !Dom.hasClass(node, 'bx-sidebar-tabs-highlight'))[index];\n\t\t},\n\t\tupdateHighlightPosition(index: number)\n\t\t{\n\t\t\tconst element = this.getElementNodeByIndex(index);\n\t\t\tthis.highlightOffsetLeft = element.offsetLeft;\n\t\t\tthis.highlightWidth = element.offsetWidth;\n\t\t},\n\t\tscrollToElement(elementIndex: number)\n\t\t{\n\t\t\tconst element = this.getElementNodeByIndex(elementIndex);\n\t\t\tthis.$refs.tabs.scroll({left: element.offsetLeft - ARROW_CONTROL_SIZE, behavior: 'smooth'});\n\t\t},\n\t\tonTabClick(event)\n\t\t{\n\t\t\tthis.currentElementIndex = event.index;\n\t\t},\n\t\tgetTabTitle(tab: string): string\n\t\t{\n\t\t\tconst langPhraseCode = `IM_SIDEBAR_FILES_${tab.toUpperCase()}_TAB`;\n\n\t\t\treturn this.$Bitrix.Loc.getMessage(langPhraseCode);\n\t\t},\n\t\tisSelectedTab(index: number): boolean\n\t\t{\n\t\t\treturn index === this.currentElementIndex;\n\t\t},\n\t\tonLeftClick()\n\t\t{\n\t\t\tif (this.currentElementIndex <= 0)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.currentElementIndex--;\n\t\t},\n\t\tonRightClick()\n\t\t{\n\t\t\tif (this.currentElementIndex >= this.tabs.length - 1)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.currentElementIndex++;\n\t\t},\n\t\tupdateControlsVisibility()\n\t\t{\n\t\t\tthis.hasRightControl = this.$refs.tabs.scrollWidth > this.$refs.tabs.scrollLeft + this.$refs.tabs.clientWidth;\n\t\t\tthis.hasLeftControl = this.$refs.tabs.scrollLeft > 0;\n\t\t}\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-sidebar-detail-tabs__container bx-im-sidebar-detail-tabs__scope\">\n\t\t\t<div v-if=\"hasLeftControl\" @click.stop=\"onLeftClick\" class=\"bx-im-sidebar-ears__control --left\">\n\t\t\t\t<div class=\"bx-im-sidebar__forward-icon\"></div>\n\t\t\t</div>\n\t\t\t<div v-if=\"hasRightControl\" @click.stop=\"onRightClick\" class=\"bx-im-sidebar-ears__control --right\">\n\t\t\t\t<div class=\"bx-im-sidebar__forward-icon\"></div>\n\t\t\t</div>\n\t\t\t<div class=\"bx-im-sidebar-ears__elements\" ref=\"tabs\" @scroll.passive=\"updateControlsVisibility\">\n\t\t\t\t<div class=\"bx-sidebar-tabs-highlight\" :style=\"highlightStyle\"></div>\n\t\t\t\t<div\n\t\t\t\t\tv-for=\"(tab, index) in tabs\"\n\t\t\t\t\t:key=\"tab\"\n\t\t\t\t\tclass=\"bx-im-sidebar-detail-tabs__item\"\n\t\t\t\t\t:class=\"[isSelectedTab(index) ? '--selected' : '']\"\n\t\t\t\t\t@click=\"onTabClick({index: index})\"\n\t\t\t\t>\n\t\t\t\t\t<div class=\"bx-im-sidebar-detail-tabs__item-title\">{{ getTabTitle(tab) }}</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`\n};","import { Logger } from 'im.v2.lib.logger';\nimport { ImModelDialog } from 'im.v2.model';\nimport { SidebarFileTabTypes } from 'im.v2.const';\nimport { SidebarService } from './classes/sidebar-service';\nimport { MainDetail } from './components/main/detail';\nimport { MainPreview } from './components/main/preview';\nimport { InfoPreview } from './components/info/preview';\nimport { LinkDetail } from './components/info/link-detail';\nimport { FavoriteDetail } from './components/info/favorite-detail';\nimport { MediaDetail } from './components/file/media-detail';\nimport { AudioDetail } from './components/file/audio-detail';\nimport { DocumentDetail } from './components/file/document-detail';\nimport { OtherDetail } from './components/file/other-detail';\nimport { FileUnsortedPreview } from './components/file-unsorted/preview';\nimport { FileUnsortedDetail } from './components/file-unsorted/detail';\nimport { FilePreview } from './components/file/preview';\nimport { TaskPreview } from './components/task/preview';\nimport { TaskDetail } from './components/task/detail';\nimport { BriefDetail } from './components/brief/detail';\nimport { BriefPreview } from './components/brief/preview';\nimport { MeetingPreview } from './components/meeting/preview';\nimport { MeetingDetail } from './components/meeting/detail';\nimport { SignPreview } from './components/sign/preview';\nimport { SignDetail } from './components/sign/detail';\nimport { MarketPreview } from './components/market/preview';\nimport { MarketDetail } from './components/market/detail';\nimport { SidebarHeader } from './components/header';\nimport { DetailHeader } from './components/detail-header';\nimport { DetailTabs } from './components/detail-tabs';\nimport { AvailabilityManager } from './classes/availability-manager';\nimport { SettingsManager } from './classes/settings-manager';\nimport './css/sidebar.css';\nimport './css/icons.css';\n\n// @vue/component\nexport const ChatSidebar = {\n\tname: 'ChatSidebar',\n\tcomponents: {\n\t\tDetailHeader,\n\t\tDetailTabs,\n\t\tSidebarHeader,\n\t\tMainDetail,\n\t\tMainPreview,\n\t\tInfoPreview,\n\t\tLinkDetail,\n\t\tFavoriteDetail,\n\t\tMediaDetail,\n\t\tAudioDetail,\n\t\tDocumentDetail,\n\t\tOtherDetail,\n\t\tFilePreview,\n\t\tTaskPreview,\n\t\tTaskDetail,\n\t\tBriefDetail,\n\t\tBriefPreview,\n\t\tMeetingPreview,\n\t\tMeetingDetail,\n\t\tSignPreview,\n\t\tSignDetail,\n\t\tFileUnsortedDetail,\n\t\tFileUnsortedPreview,\n\t\tMarketPreview,\n\t\tMarketDetail,\n\t},\n\tprops:\n\t{\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tsidebarDetailBlock: {\n\t\t\ttype: String,\n\t\t\tdefault: null,\n\t\t},\n\t},\n\temits: ['back'],\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tisLoading: false,\n\t\t\tdetailBlock: null,\n\t\t\tdetailBlockEntityId: null,\n\t\t\tdetailTransition: 'right-panel-detail-transition',\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tblocks(): string[]\n\t\t{\n\t\t\treturn this.availabilityManager.getBlocks();\n\t\t},\n\t\thasInitialData()\n\t\t{\n\t\t\treturn this.$store.getters['sidebar/isInited'](this.chatId);\n\t\t},\n\t\tdetailComponent(): ?string\n\t\t{\n\t\t\tif (!this.detailBlock)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn `${this.detailBlock}Detail`;\n\t\t},\n\t\tgetBlockServiceInstance()\n\t\t{\n\t\t\treturn this.sidebarService.getBlockInstance(this.detailBlock);\n\t\t},\n\t\tdialog(): ImModelDialog\n\t\t{\n\t\t\treturn this.$store.getters['dialogues/get'](this.dialogId, true);\n\t\t},\n\t\tchatId(): number\n\t\t{\n\t\t\treturn this.dialog.chatId;\n\t\t},\n\t\tdialogInited(): boolean\n\t\t{\n\t\t\treturn this.dialog.inited;\n\t\t},\n\t\ttabs(): string[]\n\t\t{\n\t\t\tif (SidebarFileTabTypes[this.detailBlock])\n\t\t\t{\n\t\t\t\treturn Object.values(SidebarFileTabTypes);\n\t\t\t}\n\n\t\t\treturn [];\n\t\t},\n\t},\n\twatch:\n\t{\n\t\tsidebarDetailBlock(newValue: string, oldValue: string)\n\t\t{\n\t\t\tif (!oldValue && newValue)\n\t\t\t{\n\t\t\t\tthis.detailBlock = newValue;\n\t\t\t}\n\t\t},\n\t\tdialogInited(newValue: boolean, oldValue: boolean)\n\t\t{\n\t\t\tif (newValue === true && oldValue === false)\n\t\t\t{\n\t\t\t\tthis.initializeSidebar();\n\t\t\t}\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tLogger.warn('Sidebar: Chat Sidebar created');\n\t\tthis.settingsManager = new SettingsManager();\n\t\tthis.availabilityManager = new AvailabilityManager(this.settingsManager, this.dialogId);\n\t\tthis.sidebarService = new SidebarService(this.availabilityManager);\n\t\tthis.initializeSidebar();\n\t},\n\tmounted()\n\t{\n\t\tif (this.sidebarDetailBlock)\n\t\t{\n\t\t\tthis.detailBlock = this.sidebarDetailBlock;\n\t\t\tthis.detailTransition = '';\n\t\t}\n\t},\n\tmethods:\n\t{\n\t\tinitializeSidebar()\n\t\t{\n\t\t\tif (this.hasInitialData)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.isLoading = true;\n\t\t\tif (!this.dialogInited)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.sidebarService.setChatId(this.chatId);\n\t\t\tthis.sidebarService.setDialogId(this.dialogId);\n\n\t\t\tthis.sidebarService.requestInitialData().then(() => {\n\t\t\t\tthis.isLoading = false;\n\t\t\t});\n\t\t},\n\t\tonOpenDetail(data: Object)\n\t\t{\n\t\t\tconst { detailBlock, entityId = '' } = data;\n\t\t\tthis.detailBlock = detailBlock;\n\t\t\tthis.detailBlockEntityId = entityId.toString();\n\t\t},\n\t\tgetPreviewComponentName(block: string): string\n\t\t{\n\t\t\treturn `${block}Preview`;\n\t\t},\n\t\tonClickBack()\n\t\t{\n\t\t\tthis.detailBlock = null;\n\t\t\tthis.detailTransition = 'right-panel-detail-transition';\n\t\t\tthis.$emit('back');\n\t\t},\n\t\tonTabSelect(tab: string)\n\t\t{\n\t\t\tthis.detailBlock = tab;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<SidebarHeader :isLoading=\"isLoading\" :dialogId=\"dialogId\" :chatId=\"chatId\" />\n\t\t<div class=\"bx-im-sidebar__container bx-im-sidebar__scope\">\n\t\t\t<component\n\t\t\t\tv-for=\"block in blocks\"\n\t\t\t\t:key=\"block\"\n\t\t\t\tclass=\"bx-im-sidebar__box\"\n\t\t\t\t:is=\"getPreviewComponentName(block)\"\n\t\t\t\t:isLoading=\"isLoading\"\n\t\t\t\t:dialogId=\"dialogId\"\n\t\t\t\t@openDetail=\"onOpenDetail\"\n\t\t\t/>\n\t\t</div>\n\t\t<transition :name=\"detailTransition\">\n\t\t\t<div v-if=\"detailComponent && dialogInited\" class=\"bx-im-sidebar__detail_container bx-im-sidebar__scope\">\n\t\t\t\t<DetailHeader :detailBlock=\"detailBlock\" :dialogId=\"dialogId\" :chatId=\"chatId\" @back=\"onClickBack\"/>\n\t\t\t\t<DetailTabs v-if=\"tabs.length > 0\" :tabs=\"tabs\" @tabSelect=\"onTabSelect\" />\n\t\t\t\t<component\n\t\t\t\t\t:is=\"detailComponent\"\n\t\t\t\t\t:dialogId=\"dialogId\"\n\t\t\t\t\t:chatId=\"chatId\"\n\t\t\t\t\t:detailBlock=\"detailBlock\"\n\t\t\t\t\t:detailBlockEntityId=\"detailBlockEntityId\"\n\t\t\t\t\t:service=\"getBlockServiceInstance\"\n\t\t\t\t\t@back=\"onClickBack\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</transition> \n\t`,\n};\n"],"names":["NOT_IMPLEMENTED_ERROR","Base","constructor","chatId","dialogId","store","userManager","Core","getStore","restClient","getRestClient","UserManager","loadFirstPage","Error","loadNextPage","getInitialRequest","getResponseHandler","getCurrentUserId","getUserId","getLastElementId","collection","lastId","length","id","Type","isNumber","REQUEST_ITEMS_LIMIT","BaseFile","hasMoreItemsToLoad","RestMethod","imChatFileCollectionGet","chat_id","limit","response","Promise","reject","requestError","extractLoadFileError","fileResult","data","updateModels","fileGetResponse","error","handleResponse","list","resultData","users","files","addUsersPromise","setUsersToModel","setFilesPromise","dispatch","setSidebarFilesPromise","all","loadFirstPageBySubType","subType","filesCount","getFilesCountFromModel","resolve","queryParams","getQueryParams","requestPage","loadNextPageBySubType","callMethod","imChatFileGet","then","catch","console","getters","Media","SidebarFileTabTypes","media","Audio","audio","Document","document","Other","other","Favorite","imChatFavoriteCounterGet","imChatFavoriteGet","extractLoadCountersError","favoriteCounterGetResponse","setCounterResult","counter","setFavoriteResult","favoriteCounterGetResult","favoriteGetResult","favoritesCount","getFavoritesCountFromModel","LAST_ID","favoriteMessagesResult","rawMessages","map","favorite","message","storeMessagesPromise","setFavoritesPromise","favorites","Link","imChatUrlCounterGet","imChatUrlGet","linkCounterGetResponse","setLinksResult","linkCounterGetResult","linkGetResult","linksCount","getLinksCountFromModel","offset","OFFSET","setLinksPromise","links","Task","imChatTaskGet","extractLoadTaskError","taskGetResponse","tasksCount","getTasksCountFromModel","tasksResult","firstPageReceived","setTasksPromise","tasks","Main","imDialogUsersList","dialog_id","membersCount","getMembersCountFromModel","userIds","forEach","user","push","setMembersPromise","Brief","SidebarFileTypes","brief","Meeting","imChatCalendarGet","calendarGetResponse","meetingsCount","getMeetingsCountFromState","setMeetingsPromise","meetings","meetingsResult","FileUnsorted","imDiskFolderListGet","diskFolderListGetResult","SidebarDetailBlock","fileUnsorted","preparedFiles","file","SettingsManager","settings","Extension","getSettings","saveSettings","get","getBlocks","isLinksMigrationFinished","state","sidebar","isLinksMigrated","canShowBriefs","isFileMigrationFinished","isFilesMigrated","BLOCKS_ORDER","SidebarBlock","main","info","sign","task","meeting","AvailabilityManager","settingsManager","blocksFromSetting","availableBlocks","blocks","blocksSet","Set","delete","market","MarketManager","getInstance","getAvailablePlacementsByType","PlacementType","sort","block1","block2","BlockClasses","BlockToServices","Object","freeze","link","SidebarService","availabilityManager","blockServices","requestInitialData","isArrayFilled","buildBlocks","callBatch","getInitialRequestQuery","result","handleBatchRequestResult","getBlockInstance","blockName","find","block","type","toLowerCase","blockManager","setChatId","setDialogId","classNames","getServiceClassesForBlocks","className","initialRequest","responseHandler","services","blockList","service","Text","capitalize","query","assign","responseHandlersResult","setInited","DetailUser","name","components","Avatar","ChatTitle","props","String","required","isModerator","Boolean","default","showContextButton","computed","AvatarSize","position","$store","methods","onClickContextMenu","event","$emit","userDialogId","target","currentTarget","template","SidebarDetail","Loader","Number","emits","isLoading","hasInitialData","created","needToLoadNextPage","scrollTop","clientHeight","scrollHeight","onScroll","SidebarMenu","BaseMenu","getMenuOptions","getMenuClassName","getOpenContextMessageItem","context","messageId","text","Loc","getMessage","onclick","EventEmitter","emit","EventType","dialog","goToMessageContext","menuInstance","close","getCopyLinkItem","title","BX","clipboard","isCopySupported","copy","source","UI","Notification","Center","notify","content","MembersMenu","chatService","ChatService","callManager","CallManager","getMenuItems","getInsertNameItem","getSendMessageItem","getCallItem","getOpenProfileItem","getOpenUserCalendarItem","getKickItem","getLeaveItem","textarea","insertMention","mentionText","mentionReplacement","Utils","getMentionBbCode","Messenger","openChat","chatCanBeCalled","call","isUser","profileUri","getProfileLink","href","bot","getCalendarLink","SidePanel","Instance","open","userIdToKick","parseInt","isSelfKick","canLeaveChat","contextDialogId","isCurrentUserManager","kickUserFromChat","leaveChat","managerList","includes","MainDetail","Button","ButtonSize","ButtonColor","dialogManagers","dialogIds","userId","toString","showCopyInviteButton","chatLink","getHost","contextMenu","beforeUnmount","destroy","onContextMenuClick","item","contextChatId","openMenu","onCopyInviteClick","$Bitrix","Settings","directives","hint","Toggle","autoDeleteEnabled","ToggleSize","isGroupChat","startsWith","canBeMuted","isChatMuted","isMuted","muteList","element","hintMuteNotAvailable","popupOptions","angle","targetContainer","body","offsetLeft","offsetTop","bindOptions","hintAutoDeleteNotAvailable","chatTypeClass","getChatService","muteActionHandler","unmuteChat","muteChat","PersonalChatPreview","MessengerButton","AddToChat","showAddToChatPopup","userPosition","canInviteMembers","ChatOption","extend","userLink","onAddClick","GroupChatPreview","PREVIEW_USERS_COUNT","slice","usersInChatCount","userCounter","moreUsersCount","Math","max","canSeeMembers","userList","onOpenUsers","onOpenInvitePopup","MainPreview","inheritAttrs","onOpenDetail","detailBlock","MAX_DESCRIPTION_SYMBOLS","InfoPreview","expanded","DialogType","previewDescription","description","chatTypeText","descriptionToShow","rawText","Parser","purifyText","showExpandButton","favoriteCounter","getCounterString","urlCounter","isLinksAvailable","hintDirectiveContent","MAX_COUNTER","onFavouriteClick","onLinkClick","SidebarCollectionFormatter","cachedDateGroups","format","dateGroups","dateGroup","getDateGroup","date","dateGroupTitle","items","values","INDEX_BETWEEN_DATE_AND_TIME","shortDate","toJSON","DateFormatter","formatByTemplate","DateTemplate","LinkManager","imChatUrlDelete","LinkMenu","linkManager","getDeleteLinkItem","bind","LinkItem","linkItem","shortDescription","hostName","URL","hostname","richData","convertHtmlEntities","authorDialogId","authorId","hasPreview","previewUrl","previewStyles","backgroundImage","backgroundSize","backgroundRepeat","iconTypeClass","DateGroup","dateText","DetailEmptyState","iconType","iconClass","LinkDetail","formattedCollection","collectionFormatter","isEmptyState","FavoriteMenu","getDeleteFromFavoriteItem","messageService","MessageService","removeMessageFromFavorite","FavoriteItem","favoriteItem","favoriteMessage","messageText","purifyMessage","onItemClick","onMessageBodyClick","tagName","stopPropagation","FavoriteDetail","FileManager","diskService","DiskService","sidebarFile","fileId","saveOnDisk","save","FileMenu","mediaManager","getDownloadFileItem","getSaveFileOnDiskItem","getDeleteFileItem","getViewFileItem","viewerAttributes","getViewerDataAttributes","viewerAttrs","html","getViewHtml","urlDownload","getDownloadHtml","div","Dom","create","entries","attribute","attributeName","attributeValue","setAttribute","fileName","a","style","MediaDetailItem","SocialVideo","fileItem","videoDuration","sidebarFileItem","previewPicture","urlPreview","isImage","isVideo","videoDurationText","formatTime","rawSeconds","floor","durationHours","durationMinutes","hours","minutes","padStart","seconds","handleVideoEvent","$refs","duration","MediaDetail","SidebarAudioPlayer","BitrixVue","cloneComponent","AudioPlayer","timelineType","parentData","fileSize","formatFileSize","size","fileAuthorDialogId","progressPosition","loaded","AudioPlayerState","none","width","progressInPixel","activeTimelineStyles","TIMELINE_VERTICAL_SHIFT","ACTIVE_TIMELINE_VERTICAL_SHIFT","shift","timelineStyles","AudioDetailItem","audioUrl","random","AudioDetail","DocumentDetailItem","fileIconClass","icon","fileShortName","NAME_MAX_LENGTH","getShortFileName","isViewerAvailable","keys","download","urlToOpen","urlShow","window","DocumentDetail","OtherDetail","FilePreviewItem","previewImageStyles","isAudio","FilePreview","isMigrationFinished","hasFiles","FileUnsortedDetail","TaskManager","imChatTaskDelete","TaskMenu","taskManager","getDeleteItem","TaskItem","taskItem","taskTitle","taskAuthorDialogId","creatorId","taskResponsibleDialogId","responsibleId","taskDeadlineText","statusToShow","isStringFilled","statusTitle","taskBackgroundColorClass","status","statusColorClass","color","LabelColor","toUpperCase","onTaskClick","cacheable","TaskPreview","showAddButton","firstTask","getEntityCreator","entityCreator","EntityCreator","createTaskForChat","TaskDetail","BriefItem","BriefDetail","BriefPreview","firstBrief","MeetingManager","imChatCalendarDelete","MeetingMenu","meetingManager","MeetingItem","meetingItem","meetingDate","dateFrom","day","getDate","monthShort","DateTimeFormat","isActive","getTime","Date","now","onMeetingClick","top","Calendar","SliderLoader","show","MeetingPreview","firstMeeting","createMeetingForChat","MeetingDetail","SignPreview","SignDetail","MarketPreviewItem","marketItem","options","iconName","iconColor","MarketPreview","marketMenuItems","onMarketItemClick","entityId","MarketDetail","Spinner","detailBlockEntityId","SpinnerSize","marketManager","mounted","loadPlacement","Runtime","MainMenu","RecentMenu","getUnreadMessageItem","getPinMessageItem","getAddMembersToChatItem","getHideItem","events","onAddToChatShow","getJoinChatItem","warn","canShowFullMenu","recentItem","SidebarHeader","subscribe","onAddChatShow","unsubscribe","onSidebarCloseClick","DetailHeader","ChatButton","needAddButton","detailsWithAddButton","replace","phrase","onSearchClick","ARROW_CONTROL_SIZE","DetailTabs","tabs","Array","hasLeftControl","hasRightControl","currentElementIndex","highlightOffsetLeft","highlightWidth","highlightStyle","left","watch","newIndex","updateHighlightPosition","scrollToElement","scrollWidth","offsetWidth","getElementNodeByIndex","index","children","filter","node","hasClass","elementIndex","scroll","behavior","onTabClick","getTabTitle","tab","langPhraseCode","isSelectedTab","onLeftClick","onRightClick","updateControlsVisibility","scrollLeft","clientWidth","ChatSidebar","FileUnsortedPreview","sidebarDetailBlock","detailTransition","detailComponent","getBlockServiceInstance","sidebarService","dialogInited","inited","newValue","oldValue","initializeSidebar","Logger","getPreviewComponentName","onClickBack","onTabSelect"],"mappings":"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"}